# StackOverflow 问答 11529000-11529999

# java - 使用 ant 和 Java 1.7 编译问题

> ID：11529000
> 
> 赞同：4
> 
> 时间：2012-07-17T18:54:11.467
> 
> 标签：java, ant, compiler-errors, javac, java-7

我正在尝试使用 ant 和 javac 1.7 编译器编译代码库。目前，代码库使用 1.6 编译器编译，但是当我切换到 1.7 编译器时，我得到以下两个奇怪的地方。

1）我收到警告：“警告：x 是内部专有 API，可能会在未来的版本中删除”其中 x 是内部专有 API 的一部分，但它引用的代码中的行没有引用 x（也没有引用x 给定文件中的任何位置）。这发生在几个地方，它引用的行位于注释块中。

2）编译以以下方式终止：

> ```
> [javac] The system is out of resources.
> [javac] Consult the following stack trace for details.
> [javac] java.lang.StackOverflowError
> [javac]     at com.sun.tools.javac.comp.Attr.attribTree(Attr.java:418)
> [javac]     at com.sun.tools.javac.comp.Attr.attribExpr(Attr.java:460)
> [javac]     at com.sun.tools.javac.comp.Attr.visitBinary(Attr.java:2053)
> [javac]     at com.sun.tools.javac.tree.JCTree$JCBinary.accept(JCTree.java:1565) 
> ```

我的 javac ant 脚本中的相关参数是：

> ```
>  source="1.6" 
>         target="1.6" 
>         debug="on" 
>         debuglevel="lines,vars,source" 
>         nowarn="on" 
>         fork="yes" 
>         executable="C:\Program Files\Java\jdk1.7.0_04\bin\javac"
>         memorymaximumsize="1500m" 
> ```

我尝试更改源和目​​标版本。我还尝试调整内存大小。它似乎没有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T16:25:12.510

（只需将我的评论复制到答案中，以防它被证明是答案。）

这很可能是一个 Java 7 编译器错误。但是，您可以通过`javac`使用诸如`-Xss16M`. 这使得线程堆栈大小为 16MB，而默认值为 1MB。这可能是一个可行的解决方法。

关于内部 API 的消息是不相关的，可以忽略。

# actionscript-3 - Flex 资源管理器在一个文件中完美运行，而在另一个文件中则完全没有

> ID：11529002
> 
> 赞同：0
> 
> 时间：2012-07-17T18:54:27.483
> 
> 标签：actionscript-3, apache-flex, localization, resourcemanager

我正在尝试在 Flex 中使用 resourceManager 进行一些本地化。我遇到了一个奇怪的问题，它在我尝试过的第一个文件中运行良好，但在第二个文件中它甚至无法编译。

两个文件都有

```
import mx.resources.ResourceBundle; 
```

在顶部和

```
[ResourceBundle("Hurley")] 
```

在类定义之上。第一个编译得很好，并在运行时正确地从资源中提取文本。

第二个文件（在同一个项目但不同的文件夹中）将无法编译，并且每次提到 resourceManager 都会给出错误“1120：未定义属性资源管理器的访问”。

对于两种不同的用途：

在有效的文件中：

```
public function SeasonsComboBox() {
    this.labelFunction = function(obj:Object):String {
        return resourceManager.getString('Hurley','Season_word') + " " + obj.number;
    };
} 
```

以及不起作用的文件：

```
public function getCarousels(seriesId:String, callback:Function):void {
    [...]
    ExternalInterface.addCallback("getCarouselsFailure", function():void {
            Alert.show(resourceManager.getString('Hurley','CarouselsFailure_text'), "Error", Alert.OK);
        });
    [...]
    } 
```

我想不出我在这两个文件中所做的任何不同。

**编辑，解决：**

resourceManager 在所有 UIComponent 子类中定义。有效的文件导入了 ComboBox。没有的文件。在这些文件中，我可以通过调用使其工作：

```
ResourceManager.getInstance() 
```

更多信息在这里：[http ://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/resources/IResourceManager.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/resources/IResourceManager.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T23:03:35.900

您无法访问 reourceManager 属性的原因是它可能未定义。

它在 UIComponent 中定义，因此任何扩展 UIComponent 的类都会定义它。但是，否则你必须自己定义它。

您可以使用以下方法执行此操作：

```
public var resourceManager:ResourceManager = ResourceManager.getInstance(); 
```

# c++ - 现代编译器能否展开使用开始和结束迭代器表示的“for”循环

> ID：11529006
> 
> 赞同：12
> 
> 时间：2012-07-17T18:54:49.677
> 
> 标签：c++, stl, loop-unrolling

考虑以下代码

```
 vector<double> v;
 // fill v
 const vector<double>::iterator end =v.end();
 for(vector<double>::iterator i = v.bgin(); i != end; ++i) {
   // do stuff
 } 
```

像 g++、clang++、icc 这样的编译器是否能够展开这样的循环。不幸的是，我不知道程序集能够从输出中验证循环是否展开。（而且我只能访问 g++。）

对我来说，这似乎代表编译器需要比平常更多的智能，首先推断迭代器是随机访问迭代器，然后计算循环执行的次数。启用优化后编译器可以这样做吗？

感谢您的回复，在你们中的一些人开始讲授过早优化之前，这是一个好奇的练习。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-17T19:19:49.053

我建议编译器是否可以使用现代流水线架构和缓存展开循环，除非你的“做的东西”是微不足道的，否则这样做几乎没有什么好处，而且在许多情况下这样做会导致性能下降一个福音。如果您的“做事”不重要，展开循环将创建此重要代码的多个副本，这将需要额外的时间来加载到缓存中，从而显着减慢展开循环的第一次迭代。同时，它会从缓存中驱逐更多代码，如果它进行任何函数调用，这可能是执行“do stuff”所必需的，然后需要再次将其重新加载到缓存中。在无缓存流水线非分支预测架构之前，展开循环的目的很有意义，目标是减少与循环逻辑相关的开销。现在使用基于缓存的流水线分支预测硬件，您的 cpu 将很好地流水线进入下一个循环迭代，推测性地再次执行循环代码，当您检测到 i==end 退出条件时，处理器将抛出出最终投机执行的结果集。在这样的架构中，循环展开几乎没有意义。它会进一步膨胀代码而几乎没有任何好处。此时，处理器将抛出最终的推测性执行结果集。在这样的架构中，循环展开几乎没有意义。它会进一步膨胀代码而几乎没有任何好处。此时，处理器将抛出最终的推测性执行结果集。在这样的架构中，循环展开几乎没有意义。它会进一步膨胀代码而几乎没有任何好处。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-17T19:30:52.023

> 对我来说，这似乎代表编译器需要比平常更多的智能，首先推断迭代器是随机访问迭代器，然后计算循环执行的次数。

STL 完全由模板组成，包含所有代码`inline`。因此，当编译器开始应用优化时，随机访问迭代器已经减少为指针。创建 STL 的原因之一是为了减少程序员智取编译器的需要。您应该依靠 STL 来做正确的事情，直到证明并非如此。

当然，您仍然可以从 STL 中选择合适的工具来使用...

**编辑：**有关于是否`g++`有任何循环展开的讨论。在我使用的版本中，循环展开不是, 或的一部分`-O`，并且我使用以下代码获得后两个级别的相同程序集：`-O2``-O3`

```
void foo (std::vector<int> &v) {
    volatile int c = 0;
    const std::vector<int>::const_iterator end = v.end();
    for (std::vector<int>::iterator i = v.begin(); i != end; ++i) {
        *i = c++;
    }
} 
```

搭配相应的组装`-O2`组装：

```
_Z3fooRSt6vectorIiSaIiEE:
.LFB435:
        movq    8(%rdi), %rcx
        movq    (%rdi), %rax
        movl    $0, -4(%rsp)
        cmpq    %rax, %rcx
        je      .L4
        .p2align 4,,10
        .p2align 3
.L3:
        movl    -4(%rsp), %edx
        movl    %edx, (%rax)
        addq    $4, %rax
        addl    $1, %edx
        cmpq    %rax, %rcx
        movl    %edx, -4(%rsp)
        jne     .L3
.L4:
        rep
        ret 
```

添加选项后，该`-funroll-loops`功能扩展为更大的东西。但是，文档警告了这个选项：

> 展开循环，其迭代次数可以在编译时或进入循环时确定。-funroll-loops 意味着 -frerun-cse-after-loop。它还开启了完全循环剥离（即用少量恒定迭代次数完全去除循环）。**此选项使代码更大，并且可能会或可能不会使其运行得更快。**

作为阻止您自己展开循环的进一步论据，我将通过将[Duff 的设备](http://en.wikipedia.org/wiki/Duff's_device)应用于上述`foo`函数的说明来完成这个答案：

```
void foo_duff (std::vector<int> &v) {
    volatile int c = 0;
    const std::vector<int>::const_iterator end = v.end();
    std::vector<int>::iterator i = v.begin();
    switch ((end - i) % 4) do {
    case 0: *i++ = c++;
    case 3: *i++ = c++;
    case 2: *i++ = c++;
    case 1: *i++ = c++;
    } while (i != end);
} 
```

* * *

GCC 有另一个循环优化标志：

> `-ftree-loop-optimize`
> 在树上执行循环优化。默认情况下，此标志在`-O`及更高版本中启用。

因此，该`-O`选项可以对最内层的循环进行简单的循环优化，包括对具有固定迭代次数的循环进行完整的循环展开（剥离）。（感谢医生向我指出这一点。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T18:58:44.820

简短的回答是肯定的。它会尽可能多地展开。在您的情况下，这取决于您如何定义`end`（我假设您的示例是通用的）。大多数现代编译器不仅会展开，而且还会进行矢量化并进行其他优化，这些优化通常会使您自己的解决方案彻底失败。

所以我要说的是**不要过早优化**！只是在开玩笑 ：）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-11-30T09:31:57.383

**简单的回答**：一般**不！**至少在完成循环展开时。

让我们在这个简单的脏编码（用于测试目的）结构上展开测试循环。

```
struct Test
{
    Test(): begin(arr), end(arr + 4) {}

    double * begin;
    double * end;
    double arr[4];
}; 
```

* * *

首先让我们进行**计数循环**并在没有任何优化的情况下对其进行编译。

```
double counted(double param, Test & d)
{
    for (int i = 0; i < 4; i++)
        param += d.arr[i];
    return param;
} 
```

这是 gcc 4.9 产生的。

```
counted(double, Test&):
    pushq   %rbp
    movq    %rsp, %rbp
    movsd   %xmm0, -24(%rbp)
    movq    %rdi, -32(%rbp)
    movl    $0, -4(%rbp)
    jmp .L2
.L3:
    movq    -32(%rbp), %rax
    movl    -4(%rbp), %edx
    movslq  %edx, %rdx
    addq    $2, %rdx
    movsd   (%rax,%rdx,8), %xmm0
    movsd   -24(%rbp), %xmm1
    addsd   %xmm0, %xmm1
    movq    %xmm1, %rax
    movq    %rax, -24(%rbp)
    addl    $1, -4(%rbp)
.L2:
    cmpl    $3, -4(%rbp)
    jle .L3
    movq    -24(%rbp), %rax
    movq    %rax, -40(%rbp)
    movsd   -40(%rbp), %xmm0
    popq    %rbp
    ret 
```

正如预期的那样，循环还没有展开，并且由于没有执行优化，代码通常非常冗长。现在让我们打开`-O3`标志。生产拆解：

```
counted(double, Test&):
    addsd   16(%rdi), %xmm0
    addsd   24(%rdi), %xmm0
    addsd   32(%rdi), %xmm0
    addsd   40(%rdi), %xmm0
    ret 
```

瞧，这次循环已经展开。

* * *

现在让我们看一下**迭代循环**。包含循环的函数将如下所示。

```
double iterated(double param, Test & d)
{
  for (double * it = d.begin; it != d.end; ++it)
    param += *it;
  return param;
} 
```

还是用`-O3`flag，我们来看看反汇编。

```
iterated(double, Test&):
    movq    (%rdi), %rax
    movq    8(%rdi), %rdx
    cmpq    %rdx, %rax
    je  .L3
.L4:
    addsd   (%rax), %xmm0
    addq    $8, %rax
    cmpq    %rdx, %rax
    jne .L4
.L3:
    rep ret 
```

代码看起来比第一种情况更好，因为执行了优化，但这次循环还没有展开！

`funroll-loops`和`funroll-all-loops`旗帜呢？他们将产生与此类似的结果

```
iterated(double, Test&):
    movq    (%rdi), %rsi
    movq    8(%rdi), %rcx
    cmpq    %rcx, %rsi
    je  .L3
    movq    %rcx, %rdx
    leaq    8(%rsi), %rax
    addsd   (%rsi), %xmm0
    subq    %rsi, %rdx
    subq    $8, %rdx
    shrq    $3, %rdx
    andl    $7, %edx
    cmpq    %rcx, %rax
    je  .L43
    testq   %rdx, %rdx
    je  .L4
    cmpq    $1, %rdx
    je  .L29
    cmpq    $2, %rdx
    je  .L30
    cmpq    $3, %rdx
    je  .L31
    cmpq    $4, %rdx
    je  .L32
    cmpq    $5, %rdx
    je  .L33
    cmpq    $6, %rdx
    je  .L34
    addsd   (%rax), %xmm0
    leaq    16(%rsi), %rax
.L34:
    addsd   (%rax), %xmm0
    addq    $8, %rax
.L33:
    addsd   (%rax), %xmm0
    addq    $8, %rax
.L32:
    addsd   (%rax), %xmm0
    addq    $8, %rax
.L31:
    addsd   (%rax), %xmm0
    addq    $8, %rax
.L30:
    addsd   (%rax), %xmm0
    addq    $8, %rax
.L29:
    addsd   (%rax), %xmm0
    addq    $8, %rax
    cmpq    %rcx, %rax
    je  .L44
.L4:
    addsd   (%rax), %xmm0
    addq    $64, %rax
    addsd   -56(%rax), %xmm0
    addsd   -48(%rax), %xmm0
    addsd   -40(%rax), %xmm0
    addsd   -32(%rax), %xmm0
    addsd   -24(%rax), %xmm0
    addsd   -16(%rax), %xmm0
    addsd   -8(%rax), %xmm0
    cmpq    %rcx, %rax
    jne .L4
.L3:
    rep ret
.L44:
    rep ret
.L43:
    rep ret 
```

将结果与展开循环进行比较以获取计数循环。显然不一样。我们在这里看到的是 gcc 将循环分成 8 个元素块。在某些情况下，这可以提高性能，因为每 8 次正常循环迭代检查一次循环退出条件。还可以执行附加标志矢量化。但它不是完整的循环展开。

`Test`但是，如果object 不是函数参数，则将展开迭代循环。

```
double iteratedLocal(double param)
{
  Test d;
  for (double * it = d.begin; it != d.end; ++it)
    param += *it;
  return param;
} 
```

`-O3`仅使用标志生成的反汇编：

```
iteratedLocal(double):
    addsd   -40(%rsp), %xmm0
    addsd   -32(%rsp), %xmm0
    addsd   -24(%rsp), %xmm0
    addsd   -16(%rsp), %xmm0
    ret 
```

如您所见，循环已展开。这是因为编译器现在可以安全地假设它`end`具有固定值，而它无法预测函数参数。

`Test`然而，结构是静态分配的。动态分配的结构（如`std::vector`. 从我对修改后的`Test`结构的观察来看，它类似于动态分配的容器，看起来 gcc 尽力展开循环，但在大多数情况下生成的代码并不像上面那样简单。

* * *

当您询问其他编译器时，这里是 clang 3.4.1 ( `-O3`flag)的输出

```
counted(double, Test&):                      # @counted(double, Test&)
    addsd   16(%rdi), %xmm0
    addsd   24(%rdi), %xmm0
    addsd   32(%rdi), %xmm0
    addsd   40(%rdi), %xmm0
    ret

iterated(double, Test&):                     # @iterated(double, Test&)
    movq    (%rdi), %rax
    movq    8(%rdi), %rcx
    cmpq    %rcx, %rax
    je  .LBB1_2
.LBB1_1:                                # %.lr.ph
    addsd   (%rax), %xmm0
    addq    $8, %rax
    cmpq    %rax, %rcx
    jne .LBB1_1
.LBB1_2:                                # %._crit_edge
    ret

iteratedLocal(double):                     # @iteratedLocal(double)
    leaq    -32(%rsp), %rax
    movq    %rax, -48(%rsp)
    leaq    (%rsp), %rax
    movq    %rax, -40(%rsp)
    xorl    %eax, %eax
    jmp .LBB2_1
.LBB2_2:                                # %._crit_edge4
    movsd   -24(%rsp,%rax), %xmm1
    addq    $8, %rax
.LBB2_1:                                # =>This Inner Loop Header: Depth=1
    movaps  %xmm0, %xmm2
    cmpq    $24, %rax
    movaps  %xmm1, %xmm0
    addsd   %xmm2, %xmm0
    jne .LBB2_2
    ret 
```

英特尔的 icc 13.01（`-O3`标志）

```
counted(double, Test&):
        addsd     16(%rdi), %xmm0                               #24.5
        addsd     24(%rdi), %xmm0                               #24.5
        addsd     32(%rdi), %xmm0                               #24.5
        addsd     40(%rdi), %xmm0                               #24.5
        ret                                                     #25.10
iterated(double, Test&):
        movq      (%rdi), %rdx                                  #30.26
        movq      8(%rdi), %rcx                                 #30.41
        cmpq      %rcx, %rdx                                    #30.41
        je        ..B3.25       # Prob 50%                      #30.41
        subq      %rdx, %rcx                                    #30.7
        movb      $0, %r8b                                      #30.7
        lea       7(%rcx), %rax                                 #30.7
        sarq      $2, %rax                                      #30.7
        shrq      $61, %rax                                     #30.7
        lea       7(%rax,%rcx), %rcx                            #30.7
        sarq      $3, %rcx                                      #30.7
        cmpq      $16, %rcx                                     #30.7
        jl        ..B3.26       # Prob 10%                      #30.7
        movq      %rdx, %rdi                                    #30.7
        andq      $15, %rdi                                     #30.7
        je        ..B3.6        # Prob 50%                      #30.7
        testq     $7, %rdi                                      #30.7
        jne       ..B3.26       # Prob 10%                      #30.7
        movl      $1, %edi                                      #30.7
..B3.6:                         # Preds ..B3.5 ..B3.3
        lea       16(%rdi), %rax                                #30.7
        cmpq      %rax, %rcx                                    #30.7
        jl        ..B3.26       # Prob 10%                      #30.7
        movq      %rcx, %rax                                    #30.7
        xorl      %esi, %esi                                    #30.7
        subq      %rdi, %rax                                    #30.7
        andq      $15, %rax                                     #30.7
        negq      %rax                                          #30.7
        addq      %rcx, %rax                                    #30.7
        testq     %rdi, %rdi                                    #30.7
        jbe       ..B3.11       # Prob 2%                       #30.7
..B3.9:                         # Preds ..B3.7 ..B3.9
        addsd     (%rdx,%rsi,8), %xmm0                          #31.9
        incq      %rsi                                          #30.7
        cmpq      %rdi, %rsi                                    #30.7
        jb        ..B3.9        # Prob 82%                      #30.7
..B3.11:                        # Preds ..B3.9 ..B3.7
        pxor      %xmm6, %xmm6                                  #28.12
        movaps    %xmm6, %xmm7                                  #28.12
        movaps    %xmm6, %xmm5                                  #28.12
        movsd     %xmm0, %xmm7                                  #28.12
        movaps    %xmm6, %xmm4                                  #28.12
        movaps    %xmm6, %xmm3                                  #28.12
        movaps    %xmm6, %xmm2                                  #28.12
        movaps    %xmm6, %xmm1                                  #28.12
        movaps    %xmm6, %xmm0                                  #28.12
..B3.12:                        # Preds ..B3.12 ..B3.11
        addpd     (%rdx,%rdi,8), %xmm7                          #31.9
        addpd     16(%rdx,%rdi,8), %xmm6                        #31.9
        addpd     32(%rdx,%rdi,8), %xmm5                        #31.9
        addpd     48(%rdx,%rdi,8), %xmm4                        #31.9
        addpd     64(%rdx,%rdi,8), %xmm3                        #31.9
        addpd     80(%rdx,%rdi,8), %xmm2                        #31.9
        addpd     96(%rdx,%rdi,8), %xmm1                        #31.9
        addpd     112(%rdx,%rdi,8), %xmm0                       #31.9
        addq      $16, %rdi                                     #30.7
        cmpq      %rax, %rdi                                    #30.7
        jb        ..B3.12       # Prob 82%                      #30.7
        addpd     %xmm6, %xmm7                                  #28.12
        addpd     %xmm4, %xmm5                                  #28.12
        addpd     %xmm2, %xmm3                                  #28.12
        addpd     %xmm0, %xmm1                                  #28.12
        addpd     %xmm5, %xmm7                                  #28.12
        addpd     %xmm1, %xmm3                                  #28.12
        addpd     %xmm3, %xmm7                                  #28.12
        movaps    %xmm7, %xmm0                                  #28.12
        unpckhpd  %xmm7, %xmm0                                  #28.12
        addsd     %xmm0, %xmm7                                  #28.12
        movaps    %xmm7, %xmm0                                  #28.12
..B3.14:                        # Preds ..B3.13 ..B3.26
        lea       1(%rax), %rsi                                 #30.7
        cmpq      %rsi, %rcx                                    #30.7
        jb        ..B3.25       # Prob 50%                      #30.7
        subq      %rax, %rcx                                    #30.7
        cmpb      $1, %r8b                                      #30.7
        jne       ..B3.17       # Prob 50%                      #30.7
..B3.16:                        # Preds ..B3.17 ..B3.15
        xorl      %r8d, %r8d                                    #30.7
        jmp       ..B3.21       # Prob 100%                     #30.7
..B3.17:                        # Preds ..B3.15
        cmpq      $2, %rcx                                      #30.7
        jl        ..B3.16       # Prob 10%                      #30.7
        movq      %rcx, %r8                                     #30.7
        xorl      %edi, %edi                                    #30.7
        pxor      %xmm1, %xmm1                                  #28.12
        lea       (%rdx,%rax,8), %rsi                           #31.19
        andq      $-2, %r8                                      #30.7
        movsd     %xmm0, %xmm1                                  #28.12
..B3.19:                        # Preds ..B3.19 ..B3.18
        addpd     (%rsi,%rdi,8), %xmm1                          #31.9
        addq      $2, %rdi                                      #30.7
        cmpq      %r8, %rdi                                     #30.7
        jb        ..B3.19       # Prob 82%                      #30.7
        movaps    %xmm1, %xmm0                                  #28.12
        unpckhpd  %xmm1, %xmm0                                  #28.12
        addsd     %xmm0, %xmm1                                  #28.12
        movaps    %xmm1, %xmm0                                  #28.12
..B3.21:                        # Preds ..B3.20 ..B3.16
        cmpq      %rcx, %r8                                     #30.7
        jae       ..B3.25       # Prob 2%                       #30.7
        lea       (%rdx,%rax,8), %rax                           #31.19
..B3.23:                        # Preds ..B3.23 ..B3.22
        addsd     (%rax,%r8,8), %xmm0                           #31.9
        incq      %r8                                           #30.7
        cmpq      %rcx, %r8                                     #30.7
        jb        ..B3.23       # Prob 82%                      #30.7
..B3.25:                        # Preds ..B3.23 ..B3.21 ..B3.14 ..B3.1
        ret                                                     #32.14
..B3.26:                        # Preds ..B3.2 ..B3.6 ..B3.4    # Infreq
        movb      $1, %r8b                                      #30.7
        xorl      %eax, %eax                                    #30.7
        jmp       ..B3.14       # Prob 100%                     #30.7
iteratedLocal(double):
        lea       -8(%rsp), %rax                                #8.13
        lea       -40(%rsp), %rdx                               #7.11
        cmpq      %rax, %rdx                                    #33.41
        je        ..B4.15       # Prob 50%                      #33.41
        movq      %rax, -48(%rsp)                               #32.12
        movq      %rdx, -56(%rsp)                               #32.12
        xorl      %eax, %eax                                    #33.7
..B4.13:                        # Preds ..B4.11 ..B4.13
        addsd     -40(%rsp,%rax,8), %xmm0                       #34.9
        incq      %rax                                          #33.7
        cmpq      $4, %rax                                      #33.7
        jb        ..B4.13       # Prob 82%                      #33.7
..B4.15:                        # Preds ..B4.13 ..B4.1
        ret                                                     #35.14 
```

* * *

以免产生误会。如果计数循环条件将依赖于像这样的外部参数。

```
double countedDep(double param, Test & d)
{
    for (int i = 0; i < d.size; i++)
        param += d.arr[i];
    return param;
} 
```

这样的循环也不会展开。

# jquery - 悲伤的番茄（jQuery 中的 Image .load 函数）

> ID：11529011
> 
> 赞同：1
> 
> 时间：2012-07-17T18:55:23.900
> 
> 标签：jquery, image, load, thumbnails

我有一个非常伤心的番茄，因为它没有调整大小，可怜的东西。如果我不放“加载”功能，那么我的一些拇指将不会调整大小，如果我这样做，那么其他拇指将不会调整大小。

```
startDiv.find('img').each(function(p) {
    $(this).parent().css({ height: thumbs_size, width:thumbs_size });
    $(this).css({ height: thumbs_size, width: thumbs_size }); //temporary
    $(this).load(function() {
        if ($(this).height() > $(this).width()) {
            var w = thumbs_size;
            var h = Math.ceil($(this).height() / $(this).width() * thumbs_size);
        } else {
            var h = thumbs_size;
            var w = Math.ceil($(this).width() / $(this).height() * thumbs_size);
        }
        $(this).css({ height: h, width: w });
    });
}); 
```

谁能拯救我的番茄？谢谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:01:11.687

这是因为您调用时可能已经加载了一些 `$(this).load(`。执行以下操作或类似操作

```
startDiv.find('img').each(function(p) {
    $(this).parent().css({ height: thumbs_size, width:thumbs_size });
    $(this).css({ height: thumbs_size, width: thumbs_size }); //temporary

    var $this = $(this);
    function onLoad() {
        var height = $this.height(), width = $this.width();
        var isPortrait = height > width;
        var w = isPortrait ? thumbs_size : Math.ceil(width / height * thumbs_size);
        var h = isPortrait ? Math.ceil( height / width * thumbs_size) : thumbs_size;
        $this.css({ height: h, width: w });
    }
    // Set it on the load event handler in case it's not loaded
    // If it has a width, it's already loaded
    if ($(this).width() > 0) {
        onLoad();
    } else {
       $this.load(onLoad);
    }
}); 
```

或者您可以只在 onload 处理程序中使用它，以保证 DOM 中的所有图像都已加载（也包括所有脚本）

```
$(window).load(function(){
    startDiv.find('img').each(function(p) {
        $(this).parent().css({ height: thumbs_size, width:thumbs_size });
        var height = $this.height(), width = $this.width();
        var isPortrait = height > width;
        $this.css({ 
            height: isPortrait ? Math.ceil( height / width * thumbs_size) : thumbs_size,
            width: isPortrait ? thumbs_size : Math.ceil(width / height * thumbs_size) 
        });
    });    
}); 
```

您可能希望使用 CSS 为图像提供默认宽度和高度

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T00:08:51.890

更新：虽然上面的解决方案适用于任何独立的 html 页面，但 Wordpress 并没有以相同的方式处理所有内容，所以对于 Wordpress，我使用了这个：

-- 在functions.php中加入这个javascript： [https ://github.com/alexanderdickson/waitForImages](https://github.com/alexanderdickson/waitForImages)

-- 定义你的 startDiv，例如：startDiv = $(".myThumbnailDiv");。

-- 在你的 ready 函数中，添加如下内容：

```
//Thumbnail parent container size, so they load within a thumbsize box
startDiv.find('img').each(function(p) {
    $(this).parent().css({ height: thumbs_size, width:thumbs_size });
});

//Call the function in waitingforimages.js 

startDiv.waitForImages(function() {
   //alert('All images have loaded.');
}, function(loaded, count, success) {

        var height = $(this).height(), width = $(this).width();
        var isPortrait = height > width;
        $(this).css({
            height: isPortrait ? Math.ceil( height / width * thumbs_size) : thumbs_size,
            width: isPortrait ? thumbs_size : Math.ceil(width / height * thumbs_size)
        });
}); 
```

# php - 通过 Codeigniter 中的构造方法向视图传递数据

> ID：11529013
> 
> 赞同：0
> 
> 时间：2012-07-17T18:55:41.500
> 
> 标签：php, codeigniter

我目前正在使用 codeigniter tank_auth，在每个控制器方法开始时我必须执行以下操作：

```
$data['profile'] = $this->tank_auth->get_profile(); 
```

我这样做的主要原因是显示当前登录的用户名，并获取他们的权限级别。

我正在检查尝试遵循 DRY 原则的代码，并将大量重复的代码移至 _constructor 方法（例如检查用户是否已登录）。我只是想知道是否有办法将此代码从每个方法的开头移动到构造函数。

我当前的构造函数方法如下所示：

```
public function __construct()
{
    parent::__construct();

    // If the user isn't logged in redirect to login page.
    if (!$this->tank_auth->is_logged_in())
        redirect('auth/login');

  } 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:59:40.887

将变量添加`$data`到控制器并将其用于所有视图数据。例如：

```
public function __construct()
{
    parent::__construct();
    $this->data['profile'] = $this->tank_auth->get_profile();
} 
```

调用视图时记得这样调用它：

```
$this->load->view('my_view', $this->data); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T06:41:49.870

您还可以使用 MY_Controller 扩展 CI_Controller 并将登录检查放在 MY_Controller 的构造函数中。只需从 MY_Controller 而不是 CI_Controller 扩展所有需要此检查的控制器。

# c# - 使用 JIRA SOAP API 添加修复版本

> ID：11529014
> 
> 赞同：0
> 
> 时间：2012-07-17T18:55:41.847
> 
> 标签：c#, api, soap, jira

我正在尝试使用 JIRA SOAP API 为问题添加修复版本。我知道以前有人问过类似的问题，但我仍然无法让它发挥作用。这是最相关问题的链接，以防有人可以比我更好地利用那里的信息：

[jirasoapservice 和修复版本](https://stackoverflow.com/questions/9226013/jirasoapservice-and-fix-version)

我觉得我做的一切都是正确的，但从未添加过修复版本。正如上述问题的答案所说，我没有设置 ID，并且通过查看项目的 getVersions 数组来确保名称正确。

我正在使用 C#。感谢您的任何建议。C# 中的工作代码片段将非常有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T22:55:28.057

事实证明，您可以像更新任何其他字段一样更新此字段：

```
RemoteFieldValue v = new RemoteFieldValue
{
     id = "fixVersions",
     values = new String[] { wi.Fields[29].Value.ToString() }
};
List<RemoteFieldValue> actionParams = new List<RemoteFieldValue>();
actionParams.Add(v);
jiraSoapServiceService.updateIssue(token, key, actionParams.ToArray()); 
```

# git - 将分支折叠到一个提交

> ID：11529017
> 
> 赞同：3
> 
> 时间：2012-07-17T18:56:13.230
> 
> 标签：git, github

基本上我一直在开发一个功能，但是当我将该功能推回主仓库进行代码审查时，他们喜欢将整个功能作为一个提交推送。我通常使用`git rebase -i`它并设置除了第一次提交到壁球和第一次编辑之外的所有内容。然后，每次发生冲突时，我都会粘贴最新的文件。

我宁愿不必在冲突期间粘贴各种文件。我希望能够保留最新的文件，并基本上以更简单的命令删除它们的历史。

编辑：

我正在寻找与此 bash 脚本等效的 Git 命令：

```
for file in `git diff --name-only master foo`
git checkout foo $file 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-17T19:20:56.173

### 使用压扁的合并

你想要的是一个压扁的合并。这会将您的所有更改合并到工作树中，但实际提交取决于您。例如：

```
git checkout foo
git rebase -i master
git checkout master
git merge --squash foo
git commit -m 'Squashed commit.' 
```

您从重新定位的分支中所做的所有更改都将作为单个提交进行，并带有单个提交消息。只要您解决了与*foo*分支中的 rebase 的任何冲突，当您合并到 master 时，合并应该不会产生冲突。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-19T01:06:06.893

如果你`git rebase -i '@{upstream}'`（如描述的挤压）你可能有真正的冲突，需要真正的解决方案。如果您只是复制粘贴更改，那么您可能正在撤消自您开始功能开发回归功能以来发生的远程更改。

如果您知道这对单个文件是安全的，那么在变基期间您总是`git checkout --theirs $file`可以避免复制粘贴，尽管这将替换整个文件，这可以替换自动合并的大块；在这种情况下，“他们的”是正在应用的更改集，即您的更改。

如果您确定始终如此，则可以设置合并策略，例如`git rebase -m -s merge-recursive -X theirs -i '@{upstream}'`.

**注意**：这只适用于最新版本的 Git 中的交互式变基。

在我看来，一个更简单的方法是做`git rebase -i`\ `git merge-base HEAD '@{upstream}'\`（如所描述的挤压）有效地将分支重新定位到自身上。结果将不会在此步骤中解决合并冲突，因为更改是按照它们在相同代码上创建的相同顺序应用的。然后`git rebase '@{upstream}'`，您将以正常方式解决与上游的冲突。

更容易，假设您可以很好地管理文件，将是`git reset`\ `git merge-base HEAD '@{upstream}'\`。此时，您只需将更改的文件添加到阶段并进行新的提交，该提交可以重新设置，如上一段所述。

# java - 《java反编译器》JD-Core 0.6.0/JD-GUI 0.3.3反编译代码含义

> ID：11529021
> 
> 赞同：1
> 
> 时间：2012-07-17T18:56:29.710
> 
> 标签：java, decompiler

```
 MohrAboutBox.1 local1 = new ActionListener() { 
```

我用 JD GUI 0.3.3 反编译了一个 jar 文件，我得到了这行，这对我来说毫无意义。“.1”（点一），它指的是什么？我尝试重新编译，但 javac 编译器出现错误，它说这不是该行的语句。我该怎么办 ？我想我必须删除“.1”或改用“this”，或者一些变量、类或方法，我不知道为什么 JD 不能完成这项工作。

```
class MohrAboutBox extends JDialog
{
  public MohrAboutBox(MohrControls paramMohrControls)
  {

    MohrAboutBox.1 local1 = new ActionListener() {
      public void actionPerformed(ActionEvent paramActionEvent) {
        MohrAboutBox.this.exit_dlg();
      }
    }; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T19:02:05.257

它指的是 this 是 内的封闭（匿名）类（实现 `ActionListener`）的一个实例`MohrAboutBox`，例如`MohrAboutBox $1`，将其更改为：

```
ActionListener listener = new ActionListener() {
    public void actionPerformed(ActionEvent paramActionEvent) {
        MohrAboutBox.this.exit_dlg();
    }
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T19:02:19.640

它是原始源代码中的*匿名内部类*；没有有效 Java 名称的类。Java 编译器将生成的类文件命名`ClassName$1`为`ClassName$2`. 目前还不清楚为什么反编译器不能自己解决这个问题。您需要提供扩展内部类的真实类的名称——即，`ActionListener`在本例中为 ——然后代码应该可以正常编译。

# prolog - 从谓词创建列表

> ID：11529022
> 
> 赞同：0
> 
> 时间：2012-07-17T18:56:31.427
> 
> 标签：prolog

我有一个谓词：

```
delta(q1,a,q2).
delta(q1,b,q3).
delta(q2,a,q4).
delta(q2,a,q3).
delta(q3,a,q1). 
```

我想将它们转换为这样的列表：
`nfatodfa([(q1,a,q2),(q1,b,q3),(q2,a,q4),(q2,a,q3),(q3,a,q1)],L)`

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:22:56.097

我认为您可能想要使用**findall/3**来构建此列表：

```
?- findall(d(X,Y,Z), delta(X,Y,Z), L).

L = [d(q1,a,q2),d(q1,b,q3),d(q2,a,q4),d(q2,a,q3),d(q3,a,q1)] 
```

请注意，这会列出使用函子`d`来保存事物的复合术语，这与您概述的有点不同。然而，只有括号，例如。`(q1,a,q2)`, 使用起来可能有点棘手。如果您只想要裸三胞胎，请执行以下操作：

```
?- findall((X,Y,Z), delta(X,Y,Z), L).

L = [(q1,a,q2), (q1,b,q3), (q2,a,q4), (q2,a,q3), (q3,a,q1)] 
```

# wpf - MC3074 - “clr-命名空间...”中不存在类型

> ID：11529023
> 
> 赞同：8
> 
> 时间：2012-07-17T18:56:38.117
> 
> 标签：wpf, data-binding, reference

我无法从其他程序集中引用 xaml 中的类。

在同一个解决方案中，我有两个项目。一种称为 Controls（保存用户控件），另一种称为 DataBinding（保存转换器/验证规则）。在控件中，我尝试在 xaml 中引用验证规则：

```
<Binding.ValidationRules>
   <databind:Validators.FileExistsRule />
</Binding.ValidationRules> 
```

我的项目引用了包含我的类的项目。我在我的 Control.xaml 的顶部添加了这个声明：

```
xmlns:databind="clr-namespace:GuiParts.DataBinding;assembly=DataBinding" 
```

但是，当我编译时，我得到一个错误：

```
The tag 'Validators.FileExistsRule' does not exist in XML namespace 'clr-namespace:GuiParts.DataBinding;assembly=DataBinding'. 
```

该类肯定存在，我可以在后面的代码中毫无问题地调用它，但不能通过 xaml。如果我将班级转移到同一个项目，我再次没有问题。我在这里看到了其他问题，并尝试了以下方法：

1.  清理和重建所有相关项目
2.  确保所有项目都针对相同版本的 .Net（4.0，完整配置文件）
3.  从命名空间定义的末尾删除“程序集”定义。

以上都没有奏效。关于我哪里出错的任何建议？

编辑

我的 FileExists 验证器：

```
namespace GuiParts.DataBinding.Validators
{
   /// <summary>
   /// Validates that the file with the specified name exists
   /// </summary>
   public class FileExistsRule : ValidationRule
   {
      public override ValidationResult Validate(object value, CultureInfo cultureInfo)
      {
         ValidationResult res = null;
         res = ( ! File.Exists((string)value))
                  ? new ValidationResult(false, "File does not exist")
                  : new ValidationResult(true, null);
         return res;
      }
   }
} 
```

我可以在后面的代码中调用以下代码而不会出现任何错误：

```
new GuiParts.DataBinding.Validators.FileExistsRule(); 
```

所以我得到了我的命名空间等正确的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T19:32:12.100

尝试这个：

```
xmlns:databind="clr-namespace:GuiParts.DataBinding.Validators;assembly=DataBinding"

<Binding.ValidationRules>    
    <databind:FileExistsRule />    
</Binding.ValidationRules> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-17T19:55:40.767

虽然我不确定您遇到的问题是什么，但您也可以为您的程序集和 CLR 命名空间创建一个更友好的命名空间定义。事实上，我使用这种技术将各种名称空间组合到一个 XML 名称空间中……您可以使用 the[`XmlnsPrefixAttribute`](http://msdn.microsoft.com/en-us/library/system.windows.markup.xmlnsprefixattribute)和[`XmlnsDefinitionAttribute`](http://msdn.microsoft.com/en-us/library/system.windows.markup.xmlnsdefinitionattribute.aspx)s 来实现这一点。

例如：

```
[assembly: XmlnsPrefix("http://my.xml.namespace.com/", "databind")]
[assembly: XmlnsDefinition("http://my.xml.namespace.com/",
    "GuiParts.DataBinding")]
[assembly: XmlnsDefinition("http://my.xml.namespace.com/",
    "GuiParts.DataBinding.Validators")] 
```

然后，当您想在 xaml 中引用 xmlnamespace 时，您只需执行以下操作：

```
xmlns:databind="http://my.xml.namespace.com/" 
```

* * *

请注意，我使用 ReSharper，但我确信这在 Visual Studio 中也很自然。如果您不输入 xmlns 导入并尝试使用命名空间中的对象，那么当您解析它时，它将自动使用具有指定前缀的更友好的命名命名空间。此外，它非常好，可以帮助您避免 xml 命名空间和 clr 命名空间之间存在 1:1 的关系，因为您可以将多个 clr 命名空间映射到单个 xml 命名空间。

同样，我不确定您遇到的具体问题是什么，但这可能会解决它并且比使用 clr-namespaces 和程序集信息更好。只要确保想出一些独特的东西，这样您就不会遇到 xmlns 冲突，否则您将不得不回到 clr/程序集命名空间。

* * *

哦，还有最后一件事……如果您希望在您的 xml 命名空间命名方案中使用版本控制（您应该这样做），不必担心为了向后兼容而锁定自己。如果您更新外部程序集以映射到较新的 xml 名称空间，您始终可以使用[`XmlnsCompatibleWithAttribute`](http://msdn.microsoft.com/en-us/library/system.windows.markup.xmlnscompatiblewithattribute)确保使用旧的友好名称空间的代码不会中断。

例如，如果您最初将程序集指向 2012 命名空间，然后将其切换到 2013 命名空间，因为您更新了程序集......

```
// Previous Assembly version
//[assembly: XmlnsDefinition("http://schemas.xyzcorp.com/wpf/2012",
//    "Xyz.Databinding")]

[assembly: XmlnsCompatibleWith("http://schemas.xyzcorp.com/wpf/2012",
    "http://schemas.xyzcorp.com/wpf/2013")]
[assembly: XmlnsDefinition("http://schemas.xyzcorp.com/wpf/2013",
     "Xyz.Databinding")] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-17T19:17:36.777

1.  您的目标程序集中的班级是公开的吗？
2.  验证器中的字段是公开的吗？
3.  您的命名空间 GuiParts.DataBinding 是否正确？

# php - 数组未填充第一条记录

> ID：11529025
> 
> 赞同：0
> 
> 时间：2012-07-17T18:56:38.867
> 
> 标签：php, mysql, arrays

我有这个从 mysql 填充的数组。但它并没有向我展示第一张唱片。我无法弄清楚问题是什么。应该很简单。这是代码。

```
$result=mysql_query("SELECT user_instance.instance_name, user_instance.host_name FROM       
dba_account, user_instance WHERE dba_account.account_id = user_instance.account_id AND 
dba_account.account_id = '1'");
echo mysql_error();
$nume = mysql_fetch_row($result);
while($note = mysql_fetch_array($result))
{
    echo "<tr>";
    echo "<td><input type='text' name='instance_name' class='instance_name'
    disabled='disabled' value='$note[instance_name]' size='25' /></td>";
    echo "<td><input type='text' name='host_name' class='host_name' disabled='disabled' 
    value='$note[host_name]' size='25' /></td>";
    echo "</tr>";
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-17T18:58:29.680

您正在获取 $nume = mysql_fetch_row 中的第一行。这创造了第一条记录。然后，您将遍历 while 循环中的其余记录。删除第一行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-17T18:58:41.120

第一次调用时`mysql_fetch_row()`，它会将结果资源指针前进到第二个结果。不要那样做。特别是考虑到您没有`$nume`以任何方式在循环中使用变量，这对您的逻辑是不必要且有害的。

```
// Don't do this!
//$nume = mysql_fetch_row($result);

// Instead just fetch the loop
while($note = mysql_fetch_array($result)) {
   // etc...
} 
```

# c# - 为 asp.net MVC 静态资产设置合成路由

> ID：11529026
> 
> 赞同：2
> 
> 时间：2012-07-17T18:56:42.150
> 
> 标签：c#, asp.net, asp.net-mvc, asp.net-mvc-routing, asp.net-mvc-4

**我不知道如何为静态文件启用自定义路由。**

我想设置我的 asp.net mvc 应用程序以将合成 URL 用于版本化资产。这允许我将静态资产的过期时间设置为最大值，并在我进行构建时增加版本。

在编写我的 cshtml 模板时，我想将该版本放入我的静态资产的路径中。最后，我需要设置路由以忽略 URL 的版本组件，只提供静态资产。

例如：`/js/1.2.3.4/libs/require.js`->`/js/libs/require.js`

我已经完成了前两个部分，但我不知道如何让静态文件忽略 URL 的一部分。

**布局.cshtml**

```
...
<script data-main="/js/@(((myApplication)(HttpContext.Current.ApplicationInstance)).Version)/config"
    src="/js/@(((myApplication)(HttpContext.Current.ApplicationInstance)).Version)/libs/require.js"></script>
... 
```

**我的应用程序.cs**

```
public class myApplication : HttpApplication {

...

    public string Version { 
        get {
            var baseVersion = Assembly.GetExecutingAssembly().GetName().Version.ToString();
#if DEBUG
            var span = (DateTime.UtcNow - new DateTime(1970, 1, 1, 0, 0, 0, 0).ToLocalTime());
            baseVersion += "_" + span.TotalMilliseconds;
#endif
            return baseVersion;
        }
    }
} 
```

**编辑：**

我设法在应用程序中使用 OnBeginRequest 处理程序制定了一个[可行的解决方案](https://stackoverflow.com/a/3952250/560565)（由[sheikhomar](https://stackoverflow.com/users/478374/sheikhomar)提供），以便在它与正则表达式匹配时重写 URL，但是在每个请求上都这样做似乎太过分了：

```
private readonly Regex jsPattern = new Regex("^/js/[0-9._]*/(.*)$", RegexOptions.IgnoreCase);

protected void OnBeginRequest(Object sender, EventArgs e) {
    var match = jsPattern.Match(Request.Url.AbsolutePath);
    if (match.Success) {
        var fileName = match.Groups[1].Value;
        Context.RewritePath(string.Format("/js/{0}", fileName));
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T22:51:05.673

我建议让 MVC 处理路由。在正常的 MVC 路由处理之外进行 URL 重写是我不建议的，除非你有一个非常好的理由。ASP.NET MVC 的目的是消除执行这些低级操作的需要。

无论如何，在 MVC 中，映射您的路线类似于：

```
routes.MapRoute("staticJs", "js/{version}/{*fileName}", new { controller = "Static", action = "Js" }); 
```

然后在`StaticController`

```
public ActionResult Js(string version, string fileName) {
  var basePath = @"c:\path\to\js";
  var realPath = Path.Combine(basePath, fileName);
  return File(realPath, "application/javascript");
} 
```

这只会将文件流式传输回客户端（假设这`c:\path\to\js`是磁盘上 javascript 文件的路径）。

您可以查阅[此答案](https://stackoverflow.com/a/1375719/242489)以获取有关 s 的更多信息`FileResult`。

# c++ - 使用 C++ 进行音频处理 (Android NDK)

> ID：11529037
> 
> 赞同：3
> 
> 时间：2012-07-17T18:57:29.110
> 
> 标签：c++, audio, mp3, wav, mixing

我一直在开发一个音乐编辑 Android 应用程序。到目前为止，我已经编写了大量的代码。但是，由于在 Android 平台上遇到了音频延迟问题，我现在意识到有必要使用 C/C++ (Android NDK) 优化我的代码，以便操作音频文件（Wav 和 MP3），因此，希望能够提升应用程序性能。不幸的是，我无法找到处理该主题的简明资源。

任何人都可以发布有关如何解码 wav/mp3 文件并使用 C++ 混合它们的代码示例吗？任何资源将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T21:05:59.227

[这是一个使用 C/C++ 加载波形文件的简单示例](http://www.gamedev.net/page/resources/_/technical/game-programming/loading-a-wave-file-r709)。它将帮助您获得想法:)

至于玩它..你可能最好使用在 android 上的 NDK 支持的[OpenSLES 。](http://www.khronos.org/registry/sles/)

# php - PHP json_encode 数组的编程建议

> ID：11529038
> 
> 赞同：0
> 
> 时间：2012-07-17T18:57:48.333
> 
> 标签：php, arrays, json

我需要使用 PHP5 输出类似于以下内容的 JSON 响应：

```
{"success": true, "years": [{"yearnumber": 2012},{"yearnumber": 2013},...]} 
```

我已经做到了：

```
$rt = array();
$rt["success"] = true;
$rt["years"] = array();
for ($i=date('Y') ; $i < (date('Y')+21) ; $i++) {
     $rt['years'][]= 'yearnumber:'.$i;
}
echo json_encode($rt); 
```

当然，这不是实现我的目标的正确方法——而且它显然不会产生预期的结果。

我对 PHP 编程相当陌生，可以在这里稍微推动一下。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T19:03:01.460

要得到这个（我认为你想要的最接近的有效 JSON）：

```
{"success":true, "years":[2012,2013,...]} 
```

您可以使用：

```
$rt = array();
$rt["success"] = true;
$rt["years"] = array();
for ($i=intval(date('Y')) ; $i < (date('Y')+21) ; $i++) {
     $rt['years'][]= $i;
}
echo json_encode($rt);
//{"success":true,"years":[2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024,2025,2026,2027,2028,2029,2030,2031,2032]} 
```

为了`"years": [{"yearnumber": 2012}, {"yearnumber": 2013}]`

您可以使用：

```
$rt = array();
$rt["success"] = true;
$rt["years"] = array();
for ($i=intval(date('Y')) ; $i < (date('Y')+21) ; $i++) {
     $rt['years'][]= array("yearnumber" => $i);
}
echo json_encode($rt);
//{"success":true,"years":[{"yearnumber":2012},{"yearnumber":2013},{"yearnumber":2014},{"yearnumber":2015},{"yearnumber":2016},{"yearnumber":2017},{"yearnumber":2018},{"yearnumber":2019},{"yearnumber":2020},{"yearnumber":2021},{"yearnumber":2022},{"yearnumber":2023},{"yearnumber":2024},{"yearnumber":2025},{"yearnumber":2026},{"yearnumber":2027},{"yearnumber":2028},{"yearnumber":2029},{"yearnumber":2030},{"yearnumber":2031},{"yearnumber":2032}]} 
```

虽然在我看来是多余的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T19:08:31.277

这个

```
{"success":true, "years":["yearnumber":2012,"yearnumber":2013,...]} 
```

不是有效的 JSON。数组 ( `[]`) 中不能有键，只有值。最好的解决方案（在这种情况下）是剪掉他们的钥匙，因为无论如何它们都是一样的（见 Esailija 的回答）

另一种方法是创建一个像这样的对象数组

```
{"success":true, "years":[{"yearnumber":2012},{"yearnumber":2013},...]} 
```

要从 PHP 实现这一点：

```
$rt = array();
$rt["success"] = true;
$rt["years"] = array();
for ($i=intval(date('Y')) ; $i < (date('Y')+21) ; $i++) {
     $rt['years'][] = array('yearnumber' => $i);
}
echo json_encode($rt); 
```

# html - Rails：多选框语法

> ID：11529039
> 
> 赞同：1
> 
> 时间：2012-07-17T18:57:49.797
> 
> 标签：html, ruby-on-rails, ruby-on-rails-3, forms

基本上我有这个表格：

```
<%= builder.select(:song_id, options_for_select(@selections.sort!), {}, {multiple: true, size: 7}) %> 
```

在 html 中呈现如下内容：

```
<input name="allocation[song_id][]" type="hidden" value="" />
<select id="allocation_song_id" multiple="multiple" name="allocation[song_id][]" size="7"> 
```

基本上我很好奇第二组数组括号`(allocation[song_id]**[]**)`的来源，因为我认为它影响了我的参数传递方式（歌曲ID在表单提交时一直默认为第一首歌曲）。任何指针将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:11:15.703

多选框就像复选框。如果你可以选择多个选项，那么它应该是数组（括号是数组）。隐藏输入是当没有人被选中时。

# sql-server - 从同一列中减去数据

> ID：11529040
> 
> 赞同：0
> 
> 时间：2012-07-17T18:58:05.100
> 
> 标签：sql-server

我很难从同一列中减去数据。我的数据结构如下所示：

```
TimeStamp  ID  state  Gallons
1/01/2012   1    NY     100
1/05/2012   1    NY      90
1/10/2012   1    NY      70
1/15/2012   1    NY      40 
```

所以我想得到 (100-40) = 60 加仑用于该时间段的结果。我尝试使用以下查询：

```
SELECT T1.Gallons, T1.Gallons -T1.Gallons AS 'Gallons used'
FROM Table 1 AS T1 
where Date = '2012-07-01'
ORDER BY Gallons 
```

这似乎是一种简单的方法。但是，我找不到包含时间戳作为检索正确值的一种有效方法（例如 2012 年 1 月 1 日的加仑值 - 2012 年 1 月 30 日的加仑值）。

附言。“加仑”的价值总是会减少

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T19:04:11.077

```
select max(gallons) - min(gallons)
from table1 
group by Date
having Date = '2012-07-01' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T19:01:50.110

尝试

```
select max(gallons) - min(gallons)
from table1 t1
where date between '2012-01-01' and '2012-01-31' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T19:27:11.853

你会一直比较最大和最小数量吗？如果没有，也许以下内容就足够了（通用示例）？第一次运行脚本时会出现错误，但您可以忽略它。

```
drop table TableName
create table TableName (id int, value int)

insert into TableName values (3, 20)
insert into TableName values (4, 17)
insert into TableName values (5, 16)
insert into TableName values (6, 12)
insert into TableName values (7, 10)

select t1.value - t2.value
from TableName as t1 inner join TableName as t2 
  on t1.id = 5 and t2.id = 6 
```

你要的东西是最后一行。在我们将表内部连接到自身之后，我们只需请求将两行与某些 id 匹配。或者，就像你的情况一样，不同的日期。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T19:05:25.430

```
SELECT MAX(gallons) - MIN(gallons) AS 'GallonsUsed'
FROM table; 
```

在这种情况下会起作用，如果您正在做月度报告，这可能会起作用。加仑的价值如何永远不会增加？当你用完时会发生什么？

# objective-c - 通过 iPhone 应用发送 Facebook 好友请求？

> ID：11529041
> 
> 赞同：0
> 
> 时间：2012-07-17T18:58:06.963
> 
> 标签：objective-c, ios, facebook, fbconnect

我正在尝试向我的一个应用程序添加好友请求功能。我做了很多研究，我发现我不能通过图形 api 做到这一点。我还研究了对话框，FBConnect 不支持。

所以我现在唯一的选择是弹出一个 UIWebView 并执行它并像这样格式化 url `http://www.facebook.com/dialog/friends/?id=FRIEND_ID&app_id=APP_ID&redirect_uri=REDIRECT_URI`：。这不是问题，但如果用户没有在移动 safari 上使用 Facebook 登录，他们将不得不登录，这会很烦人。

有没有其他人处理过这个问题？有什么好的变通方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:38:22.110

好友请求始终需要从请求发送方进行身份验证，因此如果用户尚未登录，则在使用好友请求对话框时必须登录。

# python - Axes3d 与 axes3d matplotlib

> ID：11529043
> 
> 赞同：10
> 
> 时间：2012-07-17T18:58:14.950
> 
> 标签：python, numpy, matplotlib, scipy

我刚刚在 OSX Lion 上完成了可怕的 scipy、numpy 和 matplotlib 安装。出于某种原因，我不能这样做：

```
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3d 
```

错误输出为：

```
Traceback (most recent call last):
  File "3dPlot.py", line 2, in <module>
    from mpl_toolkits.mplot3d import Axes3d
ImportError: cannot import name Axes3d 
```

但我可以这样做：

```
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import axes3d 
```

Axes3d 和 axes3d 之间有什么不同，或者我的文件出于某种原因只是用小写的“a”命名？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-17T19:04:27.100

以下两件事对我有用（注意你的大小写）：

```
from mpl_toolkits.mplot3d import Axes3D
from mpl_toolkits.mplot3d import axes3d 
```

但是对于您写的内容，我得到了同样的错误（3d 中的 d 小写）。请注意，两个有效的导入是不等价的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-03-15T11:58:24.133

```
from mpl_toolkits.mplot3d import Axes3D 
```

请使用上述命令为对象使用 3D 图像

# android - 设置频率属性 RRULE 以运行一次事件

> ID：11529058
> 
> 赞同：4
> 
> 时间：2012-07-17T18:59:19.203
> 
> 标签：android, android-calendar, android-event

我有

```
Intent intent = new Intent(Intent.ACTION_EDIT);
intent.setType("vnd.android.cursor.item/event");
intent.putExtra("beginTime", dateStart.getTime());
intent.putExtra("allDay", false);
intent.putExtra("rrule", "FREQ=DAILY");
intent.putExtra("endTime", dateEnd.getTime());
startActivity(intent); 
```

编译一个事件，我想运行一次事件。

设置频率的线是

```
intent.putExtra("rrule", "FREQ=DAILY"); 
```

另外，如果我删除此行，默认情况下，如果我不手动更改，android 日历将设置为 DAILY。

我一直在寻找所有受支持属性的列表，并且找到了 MONTLY、YEARLY 等，但我找不到*“one time”的正确支持语法*

你可以帮帮我吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-17T19:22:19.330

[根据文档](http://developer.android.com/guide/topics/providers/calendar-provider.html)中链接[的规范](https://www.rfc-editor.org/rfc/rfc5545#section-3.8.5.3)，设置一次性事件的正确方法是不指定 RRULE。您确定该事件会再次发生，而不是仅显示频率为每天并且仍然只触发一次吗？如果是这样，以下应该可以工作，尽管它有点小技巧：

```
intent.putExtra("rrule", "FREQ=DAILY;COUNT=1"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-05T08:06:11.177

对于一次性事件，您也可以不设置任何内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-19T11:23:48.813

/ 游走球，

奇怪的错误。你应该删除这行代码

```
intent.putExtra("rrule", "FREQ=DAILY"); 
```

它应该完美地作为“单一事件”工作。如果您使用*rrule*选项，您会告诉应用程序“重复”该事件。

所以......只需删除那行代码，它应该可以工作。

# c++ - osx/c++/glut，添加经过时间

> ID：11529060
> 
> 赞同：0
> 
> 时间：2012-07-17T18:59:33.007
> 
> 标签：c++, macos, glut

我以为我跳过了一个水坑，结果却掉进了大海：/

我正在尝试实现一个 5 秒计时器（不需要超过毫秒）。

我的目标：

```
// I start the program in gamestate 0...
{
    if (button_has_been_pressed == 1)
    {
        gamestate = 1;
    }

}

if (gamestate==1)
{
    //wait for 5 seconds and go to gamestate2
    gamestate = 2;

} 
```

我尝试了以下方法：

1.  GLUT_TIME_ELAPSED 从我的程序开始测量时间。进入 gamestate1 后，我无法“重置”GLUT_TIME_ELAPSED。否则，它会很好地工作。

2.  gettimeofday 给了我比我需要的更多的分辨率。最多可以应用毫秒。

不管我的分辨率需求如何，我都尝试过宋浩的方法：

```
gamestate1_elapsedTime = (t2.tv_sec - t1.tv_sec) * 1000.0;      // sec to ms
gamestate1_elapsedTime += (t2.tv_usec - t1.tv_usec) / 1000.0;   // us to ms

// add that elapsed time together, and keep track of its total

//r_gamestate1_elapsedTime_total = gamestate1_elapsedTime;
//if (r_gamestate1_elapsedTime_total > 5 seconds) ... 
```

然而，gamestate1_elapsedTime 似乎有一些可变性。因为输出很少是一致的。我想这是 b/c gettimeofday 使用 CPU 时间（？），我用我的 fps 夹人为地夹住它。

1.  我也尝试过 clock() ，但这似乎也是 CPU 时间 - 而不是挂墙时间。

如上所述，GLUT_ELAPSED_TIME 效果很好，除了我无法在程序中途重置它，而且我的 5 秒不再依赖于我最初的按钮单击。

如果您能提供一些建议，我将非常感激即使是朝着正确的方向轻推。非常感谢您提前。

-克罗普克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:35:42.107

您不需要“重置”GLUT_ELAPSED_TIME，只需将其复制到可以用作偏移量的地方。例如：

```
int timeAtReset = glutGet(GLUT_ELAPSED_TIME);

// I start the program in gamestate 0...
{
    if (button_has_been_pressed == 1)
    {
        gamestate = 1;
        timeAtReset = glutGet(GLUT_ELAPSED_TIME);
    }

}

if (gamestate==1)
{
    int timeSinceReset = glutGet(GLUT_ELAPSED_TIME) - timeAtReset;
    // use timeSinceReset, instead of glutGet(GLUT_ELAPSED_TIME), to
    // wait for 5 seconds and go to gamestate2
    gamestate = 2;

} 
```

# android - Android / Eclipse - 查找未使用的文件 (Java/XML)

> ID：11529065
> 
> 赞同：6
> 
> 时间：2012-07-17T18:59:43.930
> 
> 标签：android, eclipse

我们有一个大型（有点笨拙）的项目，其中肯定包含不再使用的文件，包括 Java 类和 XML 文件（可能还有图像）。是否有工具或方法可以找出项目中未引用哪些文件？

我看到了这个问题，但它不是特定于 Android 的：[在 Java Eclipse 项目中查找未使用的类](https://stackoverflow.com/questions/665563/find-unused-classes-in-a-java-eclipse-project)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-12T07:07:56.940

在eclipse中，其实可以使用Android Lint工具。单击窗口，然后单击“运行 Lint 工具”。它会发现它认为应该纠正的代码中的所有问题。它发现的问题之一是“资源 R.id.xxx 似乎未使用”，并将突出显示它认为未在您的项目中使用的所有文件作为警告。到目前为止，我发现它非常准确。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-17T19:07:08.563

我使用，并且喜欢 Classpath Helper：

[http://classpathhelper.sourceforge.net/](http://classpathhelper.sourceforge.net/)

这适用于 Eclipse 中的 Android 项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-21T06:23:03.970

下面的链接是最好的方法，享受它！

[android-未使用的资源](http://code.google.com/p/android-unused-resources/)

# java - 在Android中，如何通过Java清除设置中的WI-FI网络列表？

> ID：11529066
> 
> 赞同：1
> 
> 时间：2012-07-17T18:59:53.983
> 
> 标签：java, android, android-wifi

在Android中，如何通过Java清除设置中的WI-FI网络列表？我目前已成功使用此代码将它们全部删除，但是当我进入手机时，它们仍然出现在列表中。手动方式是单击“忘记此网络”。但我认为这就是我在下面的代码中实现的目标：

```
List<WifiConfiguration> list = wifiManager.getConfiguredNetworks();

for( WifiConfiguration i : list ) {

    wifiManager.removeNetwork(i.networkId);
    wifiManager.saveConfiguration(); 
```

....ETC

# string - 用于 ant 构建文件的 StringUtils？

> ID：11529067
> 
> 赞同：0
> 
> 时间：2012-07-17T19:00:01.713
> 
> 标签：string, ant

我正在寻找一些用于字符串操作的实用方法。例如。将一个版本拆分成它的 major.minor.bugfix 部分：

```
1.0.2

major=1
minor=0
bugfix=2 
```

我看过：

[http://www.docjar.com/docs/api/org/apache/tools/ant/util/StringUtils.html](http://www.docjar.com/docs/api/org/apache/tools/ant/util/StringUtils.html)

它位于我的 C:\apache-ant-1.8.2\lib\ant.jar

但我如何使用例如。我的 build.xml 文件中的 plit 方法？

这里使用 groovy 完成：

[http://www.coderanch.com/t/431213/tools/Ant-Split-string-assign-property](http://www.coderanch.com/t/431213/tools/Ant-Split-string-assign-property)

但是是否没有“官方”的 ant jar/扩展包含可以在我的 build.xml 文件中调用的这种基本类型的字符串操作任务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T19:12:46.397

请参阅[**Ant Addon Flaka**](http://code.google.com/p/flaka/)，它提供了一些字符串操作的功能，
[**这里有一些示例**](http://code.google.com/p/flaka/wiki/FlakaExamples)。
您的问题的答案是示例：
问题：Given 是一个 ant 属性，其值类型为 1.0.0.123 如何提取最后一个点之后的值，在本例中为 '123' ？
解决方案：使用带有索引的split函数
或者使用[**Groovy的Ant**](http://groovy.codehaus.org/The+groovy+Ant+Task)任务或者带有groovy/jruby/beanshell的脚本任务。

# javascript - 滚动到视口中心

> ID：11529070
> 
> 赞同：16
> 
> 时间：2012-07-17T19:00:08.017
> 
> 标签：javascript, jquery, scroll, center, scrollto

我想`div`通过单击使其居中。因此，如果我单击 a`div`我希望它滚动到浏览器视口的中心。我不想使用我见过的指南和示例之类的锚点。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-07-17T21:39:42.077

在某种程度上，您必须识别可点击元素。我构建了一个示例，它为此使用了`class`-attribute。

### 步骤1

这是脚本，它可以完成工作：

```
$('html,body').animate({
    scrollTop: $(this).offset().top - ( $(window).height() - $(this).outerHeight(true) ) / 2
}, 200); 
```

您尝试的是将容器滚动到页面顶部。您还必须计算并减去容器高度和视口高度之间的差值。将其除以二（因为您希望顶部和底部具有相同的空间，并且您准备好了。

### 第2步

然后将点击处理程序添加到所有元素：

```
$(document).ready(function () {
    $('.image').click( function() {
        $('html,body').animate({ scrollTop: $(this).offset().top - ( $(window).height() - $(this).outerHeight(true) ) / 2  }, 200);
    });
}); 
```

### 第 3 步

设置一些 HTML/CSS：

```
<style>

    div.image {

        border:     1px solid red;
        height:     500px;
        width:      500px;
    }

</style>

<div class="image">1</div>
<div class="image">2</div>
<div class="image">3</div>
<div class="image">4</div>
<div class="image">5</div> 
```

你完成了。

### 查看演示

自己试试[http://jsfiddle.net/insertusernamehere/3T9Py/](http://jsfiddle.net/insertusernamehere/3T9Py/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-12-23T07:46:07.710

```
HTMLElement.prototype.scrollToCenter = function(){
    window.scrollBy(0, this.getBoundingClientRect().top - (window.innerHeight>>1));
} 
```

使用纯 JavaScript 实现垂直方向滚动到中心。在水平方向上也是类似的。我没有考虑元素的高度，因为它们可能大于屏幕的高度。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-07-24T16:17:26.413

我知道这个问题很老，但现在，你可以使用[scrollIntoView](https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollIntoView)：

例如：

```
document.body.scrollIntoView({ behavior: 'smooth', inline: 'center', block: 'center' }); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-24T00:51:47.063

我有一个小小的修改要提供。
如果“调整因子”`( $(window).height() - $(this).outerHeight(true) ) / 2` 是`< 0`这样，您可能会得到不希望的结果，即您使用滚动超出视口中的该元素。

我添加了一个`max(0,adjustment factor)`来纠正：

```
 function scrollIntoView(el) {

        var offsetTop = $j(el).offset().top;
        var adjustment = Math.max(0,( $j(window).height() - $j(el).outerHeight(true) ) / 2);
        var scrollTop = offsetTop - adjustment;

        $j('html,body').animate({
            scrollTop: scrollTop
        }, 200);
    } 
```

# java - 请解释这个 Java 正则表达式

> ID：11529071
> 
> 赞同：3
> 
> 时间：2012-07-17T19:00:11.453
> 
> 标签：java, regex

我没有编写以下正则表达式，我正在尝试弄清楚它的作用。我知道它必须以 policy-map 开头，并且必须在 policy-map 和接下来的内容之间至少有一个空格。但我一直试图弄清楚括号内的东西是什么意思。我知道无论它是什么，它都必须排在最后。

```
^policy-map\\s+([\\x21-\\x7e]{1,40})$ 
```

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-17T19:02:25.510

从十六进制 21 到十六进制 7e（基本上可打印，非空白 ascii）范围内的字符 1 到 40 次。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-17T19:03:22.147

`^`字符串开头

`policy-map`持续的

`\s+`空间

`([\x21-\x7e]{1,40})`从 \x21 到 \x7e 的 1-40 个符号（即所有可打印的非空白 ASCII 字符，包括标点符号、大小写字母和数字）

`$`字符串结尾

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-07-17T19:06:12.870

```
^              Start of string
policy-map     "policy-map"
\\s+           One or more whitespace characters
(              Start of capture group 1
[\\x21-\\x7e]  From 1 to 40 characters in the range '\x21' to '\7E'
)              End of capture group 1
$              End of string 
```

# ruby - 在 IRB 中使用 ice_cube Ruby gem

> ID：11529073
> 
> 赞同：6
> 
> 时间：2012-07-17T19:00:16.783
> 
> 标签：ruby, gem, irb, ice-cube

我正在尝试在 IRB 中使用名为[ice_cube](http://seejohnrun.github.com/ice_cube/)的 Ruby gem ，但它不起作用：

```
[~]$ rvm gemset create ice
'ice' gemset created (/home/joe/.rvm/gems/ruby-1.9.2-p320@ice).

[~]$ rvm gemset use ice
Using ruby-1.9.2-p320 with gemset ice

[~]$ gem install ice_cube
Fetching: ice_cube-0.8.0.gem (100%)
Successfully installed ice_cube-0.8.0
1 gem installed
Installing ri documentation for ice_cube-0.8.0...
Installing RDoc documentation for ice_cube-0.8.0...

[~]$ irb --simple-prompt
>> require 'ice_cube'
=> true

>> schedule = Schedule.new(Time.now)
NameError: uninitialized constant Object::Schedule
    from (irb):2
    from /home/joe/.rvm/rubies/ruby-1.9.2-p320/bin/irb:16:in `<main>' 
```

我究竟做错了什么？（我是一名初学者 Ruby 程序员。）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-17T19:14:12.897

它应该是：

```
schedule = IceCube::Schedule.new(Time.now) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-04T04:24:16.763

```
include IceCube
schedule = Schedule.new(Time.now) 
```

或者您可以先将模块包含到全局命名空间中，然后您可以使用该模块中的任何内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-23T06:43:51.093

有类似的问题，请尝试重新启动您的 Rails 应用程序。

# ruby - 红宝石猫壳类似

> ID：11529076
> 
> 赞同：1
> 
> 时间：2012-07-17T19:00:28.067
> 
> 标签：ruby

我是红宝石的新手。我过去使用过shell。我正在将一个 shell 程序转换为 ruby​​。我有以下命令

```
cmd="cat -n " + infile + " | grep '127.0.0.1 '" + site
f = %x[#{cmd}] 
```

shell cat 命令返回我要查找的行和行号。我希望能够在不使用 shell 的情况下在 ruby​​ 中做类似的事情。可能需要将此程序移植到 Windows。我可以在 ruby​​ 中使用 grep 函数，但是如何返回行号而不必遍历文件中的一百万行。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T19:16:00.377

这是一个小红宝石函数，可以满足您的要求。您确实必须遍历每一行，但`grep`也这样做了-您不必自己做。幸运的是，ruby 使循环变得容易：

```
def mygrep(filename, regex)
    result = []
    File.open(filename) do |f|
        f.each_with_index do |l, i|
            result << [i, l] if regex =~ l
        end
    end
    return result
end 
```

干杯!

# cuda - Cuda::Entry 函数使用过多的本地数据

> ID：11529082
> 
> 赞同：1
> 
> 时间：2012-07-17T19:00:50.157
> 
> 标签：cuda, tesla

我正在尝试为 Tesla C2075 上的多边形交集运行一种算法。但是当我尝试编译此算法时，编译器给了我错误：`"Entry Function 'Polygon_Intersection'uses too much local data(0x40e8 bytes,0x4000)`。

我的算法有点复杂，它利用了内核中的大量局部变量。所以我的问题是，有没有办法解决这个问题，比如我可以使用全局内存为每个内核声明局部变量还是以某种方式使用共享内存？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T01:27:40.323

编译`-arch=sm_20`以启用设备端`malloc`，以便您可以将堆内存用于线程本地数据。

# javascript - Chrome 扩展：提交时修改 facebook-chat 中的消息文本

> ID：11529083
> 
> 赞同：3
> 
> 时间：2012-07-17T19:00:50.357
> 
> 标签：javascript, google-chrome-extension, request, facebook-chat

我正在尝试创建一个 Chrome 扩展程序，当用户在聊天框中按下回车键时，它会修改提交的消息。文本区域的 HTML 代码：

```
<textarea class="uiTextareaAutogrow input" onkeydown="Bootloader.loadComponents([&quot;control-textarea&quot;], function() { TextAreaControl.getInstance(this) }.bind(this)); "></textarea> 
```

我尝试对 onkeydown-event 使用类似的东西。当他按 Enter 并提交文本时，我想用文本“测试”替换用户消息

```
if (event.keyCode == 13) {this.value='test';} 
```

但当然这不起作用，因为 facebooks javascript 使用 Eventlisteners 和 .bind，所以 textarea 中的值在处理和提交文本后发生变化，但我需要在处理之前对其进行修改。有人知道我该如何解决这个问题吗？

# c++ - 传递对象的地址会导致调用父类构造函数

> ID：11529086
> 
> 赞同：-1
> 
> 时间：2012-07-17T19:00:58.937
> 
> 标签：c++

主.cpp：

```
options my_options;
tree my_trees;
CODON_alphabet my_alphabet(1);
likelihood_engine my_likelihood(&my_options, &my_trees, &my_sites);
CODON_M0 m0(&my_trees, &my_alphabet, &my_likelihood); 
```

CODON_alphabet 类具有作为父类的字母表。当我创建 CODON_M0 对象时，由于某种原因，alphabet 和 CODON_alphabet 类的构造函数都被调用了两次。这发生在 CODON_M0 构造函数的第一行被命中之前。谁能指出我正确的方向来弄清楚为什么会这样？如果我遗漏了任何重要信息，请告诉我。谢谢。

编辑：对不起，我以为这里的每个人都能读懂我的想法。下面是一些我已经简化为尽可能少做的代码，但仍然调用了不需要的构造函数。

```
class CODON_M0: public CODON_model
{
   public: 
   CODON_M0(tree* tree_ptr, CODON_alphabet* alpha_ptr, likelihood_engine* like_ptr)
}

class CODON_model: public model
{
    public:
    CODON_alphabet* my_alphabet;
    CODON_model(tree* tree_ptr, CODON_alphabet* alpha_ptr, likelihood_engine* like_ptr)
}

class model
{
   public:
   model() {}
}

class CODON_alphabet: public alphabet
{
    public:
    CODON_alphabet()
    {
        cout << "\n\n\n *** CODON_alphabet constructor called. *** \n\n\n";
    }
}

class alphabet
{
    public:
    alphabet()
    {
        cout << "\n\n\n *** alphabet constuctor called. *** \n\n\n";
    }
} 
```

我正在单步执行 gdb 中的代码，当我点击创建 CODON_M0 对象并进入构造函数的行时，我看到字母和 CODON_alphabet 构造函数已被调用两次的消息。为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:02:50.750

如果`CODON_M0`有两个类型的数据成员`CODON_alphabet`，它们将在构造函数进入之前被初始化，因此构造函数被调用。

# jsp - 将我的战争文件上传到服务器后显示内部服务器错误

> ID：11529090
> 
> 赞同：0
> 
> 时间：2012-07-17T19:01:10.143
> 
> 标签：jsp, javabeans

服务器遇到内部错误或配置错误，无法完成您的请求。

请联系服务器管理员以告知错误发生的时间以及您可能所做的任何可能导致错误的事情。

服务器错误日志中可能提供有关此错误的更多信息。

但它在本地主机上工作正常，请告诉我我错在哪里。

我的 JSP

```
<jsp:useBean id="db" scope="request" class="logbean.LoginBean"> 
  <jsp:setProperty name="db" property="userName" value='<%=request.getParameter("userName")%>' /> 
  <jsp:setProperty name="db" property="password" value='<%=request.getParameter("password")%>' />  
</jsp:useBean> 

<jsp:forward page="login/login"> 
  <jsp:param name="username" value="<%=db.getUserName()%>" /> 
  <jsp:param name="password" value="<%=db.getPassword()%>" /> 
</jsp:forward> 
```

网址：[www.btlcargo.com/login/](http://www.btlcargo.com/login/)

用户名和密码分别为 admin,admin

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T07:32:23.453

检查您的服务器日志。如果您在 Tomcat 上部署了 Web 应用程序，请检查`tomcat/logs/localhost.2012-07-17.log`.

每天应该有日志文件，例如`localhost.2012-07-17.log`

# iphone - 更新到 fmdb 2.0？

> ID：11529092
> 
> 赞同：1
> 
> 时间：2012-07-17T19:01:17.443
> 
> 标签：iphone, git

我们使用 fmdb，我看到 fmdb 2.0 支持多线程调用。更新到2.0的好方法是什么？在我开始这个项目之前，Fmdb 已添加到项目中，我不想破坏任何东西。如果这也有帮助，我们正在使用 Git。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T08:20:19.257

这取决于“Fmdb 是如何添加到项目中的”。

如果它是一个[子模块](http://git-scm.com/book/ch6-6.html)，您可以简单地创建一个分支，其中：

*   您将进入该子模块，然后 git pull [fmdb 2.0 标签](https://github.com/ccgus/fmdb/tags)（即[此提交](https://github.com/ccgus/fmdb/commit/b2047f93ad16bb81226be34b2ae66448698dd2a2)：警告，这将导致[分离的 HEAD](https://stackoverflow.com/questions/10666085/how-do-i-get-git-clone-recursive-to-recreate-submodules-remotes-and-branche/11451714#11451714)）
*   回到父仓库
*   提交（为了记录在`.gitmodules`fmdb 的新参考中）

然后，您可以独立于项目的主分支进行开发，而 fmdb2.0 仅在该新分支中可见。

# c++ - 包含 boost 库时出错

> ID：11529093
> 
> 赞同：1
> 
> 时间：2012-07-17T19:01:19.420
> 
> 标签：c++, multithreading, boost

所以这是我第一次在 C++ 中完成任何多线程。现在我的代码正在抛出某种我无法识别的错误，但它似乎表明它发生在我包含 boost/thread.hpp 时。

错误看起来像这样。

```
 In file included 

             from /usr/include/boost/mem_fn.hpp:22:0,
             from /usr/include/boost/bind/bind.hpp:26,
             from /usr/include/boost/bind.hpp:22,
             from /usr/include/boost/thread/detail/thread.hpp:22,
             from /usr/include/boost/thread/thread.hpp:22,
             from /usr/include/boost/thread.hpp:13,
             from processes/Video_process.h:8,
             from processes/Video_process.cpp:7:

             /usr/include/boost/bind/mem_fn.hpp: In member function ‘R& boost::_mfi::dm<R, T>::operator()(T*) const [with R = void*(void*), T = Video_process]’:
             /usr/include/boost/bind/bind.hpp:243:60:   instantiated from ‘R boost::_bi::list1<A1>::operator()(boost::_bi::type<R>, F&, A&, long int) [with R = void* (&)(void*), F = boost::_mfi::dm<void*(void*), Video_process>, A = boost::_bi::list0, A1 = boost::_bi::value<Video_process*>]’

             /usr/include/boost/bind/bind_template.hpp:20:59:   instantiated from ‘boost::_bi::bind_t<R, F, L>::result_type boost::_bi::bind_t<R, F, L>::operator()() [with R = void* (&)(void*), F = boost::_mfi::dm<void*(void*), Video_process>, L = boost::_bi::list1<boost::_bi::value<Video_process*> >, boost::_bi::bind_t<R, F, L>::result_type = void* (&)(void*)]’
             /usr/include/boost/thread/detail/thread.hpp:61:17:   instantiated from ‘void boost::detail::thread_data<F>::run() [with F = boost::_bi::bind_t<void* (&)(void*), boost::_mfi::dm<void*(void*), Video_process>, boost::_bi::list1<boost::_bi::value<Video_process*> > >]’
             processes/Video_process.cpp:240:1:   instantiated from here
             /usr/include/boost/bind/mem_fn.hpp:342:23: error: invalid use of non-static member function 
```

我的代码有点长，所以我不知道哪些位会有用，但无论如何这里有一些......

1.

```
 boost::unique_lock<boost::mutex> lock(mx); 
  lock.lock();
    (...) //stuff
  is_data_ready = 1;
  lock.unlock(); 
```

2.

```
stserver = boost::shared_ptr<boost::thread>
 (new boost::thread(boost::bind(&Video_process::streamServer, this))); 
```

这是在标头中声明 streamServer 的方式

```
void* streamServer(void* arg); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T19:52:42.177

中显示的错误`boost::bind`基本上表明您的成员函数`void* Video_process::streamServer(void* arg)`需要两个参数`this`和`void*`. 您的代码仅绑定第一个参数。

如果您想将它与`boost::thread`它一起使用，则不需要第二个`void*`参数或将其绑定到常量。此外，`boost::thread`丢弃函子的返回值，因此您可能喜欢使用`void`，即：

```
struct Video_process {
    void streamServer();
};

boost::thread(boost::bind(&Video_process::streamServer, this));
// or simply
boost::thread(&Video_process::streamServer, this); 
```

关于：

```
boost::unique_lock<boost::mutex> lock(mx); 
lock.lock(); 
```

第一行在构造函数中锁定了互斥体，因此第二行显式锁定是不必要的。

# python - 调试/分析 python 扩展

> ID：11529094
> 
> 赞同：3
> 
> 时间：2012-07-17T19:01:27.733
> 
> 标签：python, fortran, f2py

我使用出色的 f2py 工具将我的大部分代码编写为 Python 的 Fortran 扩展。然而，有时很难捕捉到内存泄漏，并分析程序（花费最多时间的地方）。

问题是：是否有一些简单的方法可以为 Python 调试和/或配置文件扩展（尤其是 f2py 生成的）？使用 valgrind 似乎很复杂（我使用 MacOsX，并且不想重新编译解释器）。我现在唯一的选择是打印-调试+打印-配置文件，这很耗时。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-02-13T18:18:01.753

如果任何其他人在 Linux 平台上遇到同样的问题（抱歉，不支持 OS/X，所以我知道这不是你的“答案”） - Allinea 工具可以分析和调试在 Python 中调用的 Fortran 扩展，并且查看任何内存泄漏。

与 callgrind/kcachegrind 相比，分析器运行得更快（通常最大减慢 5%），并且由于它理解矢量化和实时运行意味着 I/O 分析是准确的，因此代码运行速度慢的原因要深得多。

有一个探索[f2py 扩展调试和分析](http://www.allinea.com/blog/201502/how-to-debug-and-profile-mixed-python-and-fortran-codes)的博客介绍了它。

# php - 从 query_posts() wordpress 中排除帖子

> ID：11529100
> 
> 赞同：-1
> 
> 时间：2012-07-17T19:01:40.423
> 
> 标签：php, wordpress

我正在尝试从循环中排除帖子，例如：

```
query_posts("posts_per_page=5&cat=1, -15&post__not_in = 1"); 
```

但是，`post__not_in`不起作用。我的命令全错了吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-17T19:10:49.833

它不工作的原因是因为`post__not_in`需要一个可以在使用[WP_Query](http://codex.wordpress.org/Class_Reference/WP_Query)类时使用的数组。

尝试`WP_Query`改用：

```
$args = array('posts_per_page' => 5,
              'cat'            => '1,-15',
              'post__not_in'   => array(1),
);

$posts = new WP_Query( $args );

while ($posts->have_posts()) {
    $posts->the_post();
    echo the_title() . '<br />';
} 
```

# android - 启动电子邮件意图后，Android 键盘仍然可见

> ID：11529109
> 
> 赞同：5
> 
> 时间：2012-07-17T19:02:07.477
> 
> 标签：android, android-intent

**编辑**：*解决。答案在下面单独发布*

我正在启动内置的 Intent.ACTION_SEND “选择器”，以便用户可以选择如何从我的应用程序发送消息。它工作正常，但如果我在启动的电子邮件程序中点击“放弃”，它会返回到我的应用程序，屏幕键盘仍然可见。我尝试用各种 imm.hideSoftInputFromWindow (...) 咒语关闭它，但无济于事。任何想法如何解决这一问题？

这就是我启动“选择器”并尝试在 onActivityResult() 中关闭键盘的方式。请注意，tabHost 是我的主应用程序 (MainApp) 中的一个静态成员，它包含用于创建 tabSpecs 的 tabHost 对象。

```
public class L_Secondary extends ListActivity implements myConst
{   
    @Override
   protected void onCreate (Bundle savedInstanceState)
   {
     super.onCreate (savedInstanceState);
     setContentView(R.layout.l_people_secondary);

     // instantiate the custom array adapter class and pass it some info to build a ListView with. 
     ListView lv = getListView ();
     lv.setOnItemClickListener (oicl);
     A_secondary da = new A_secondary (this, android.R.layout.simple_list_item_single_choice, mPiecesArray, mPartsArray);

     setListAdapter (da);
   }

   ...  

   // after launching the email client, the keyboard stays visible 
   // over the Listview. Currently the keyboard gets forced to close 
   // in getView() of the ArrayAdapter class da, in onCreate() above                
   public void launchEmail () 
   {
    try
    {
     // use the builtin chooser for users mail app
     Intent sendIntent = new Intent(Intent.ACTION_SEND, Uri.fromParts ("mailto", "root@localhost", null));
     sendIntent.setType("text/plain");    

     sendIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, "msg_subject");
     sendIntent.putExtra(android.content.Intent.EXTRA_TEXT, "msg_body");

     startActivityForResult (Intent.createChooser(sendIntent, "Send via which Application?"), 0);
    }
    catch (Exception e) 
    {
     Toast.makeText (this, "No activity was found to handle this action",Toast.LENGTH_SHORT).show();
    }
  }

 ...

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-05-11T09:09:31.153

通过将它添加到我的 onResume() 中，我发现这对我有用

```
protected void onResume()
{
  Handler h = new Handler();
  h.postDelayed(new Runnable() {
     @Override
     public void run() {
        InputMethodManager keyboard = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE);
        keyboard.hideSoftInputFromWindow(findViewById(android.R.id.content).getWindowToken(), 0);
     }
  }, 500);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:16:36.850

在调用 MAIL 的意图之前使用此代码 //ed 是 EditText

```
InputMethodManager imm = (InputMethodManager)this.getSystemService(Service.INPUT_METHOD_SERVICE); 
```

用于隐藏键盘

```
imm.hideSoftInputFromWindow(ed.getWindowToken(), 0); 
```

用于显示键盘

```
imm.showSoftInput(ed, 0); 
```

在 onRestart() 方法上试试这个代码

或者

你也可以试试这个

```
<activity android:name=".YourActivity"
          android:windowSoftInputMode="stateHidden"></activity> 
```

谢谢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T19:21:02.023

我相信您可以在 onResume() 中调用 hideSoftInputFromWindow 方法

```
protected void onResume()
{
    InputMethodManager keyboard = (InputMethodManager)
    getSystemService(Context.INPUT_METHOD_SERVICE);
    keyboard.hideSoftInputFromWindow(userInput.getWindowToken(), 0);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T14:22:38.103

我最终在我的 ArrayAdapter 类中使用了传递给 getView() 的上下文，该类在 L_Secondary 类中实例化。这不是执行此操作的最佳位置，因为每次滚动、触摸或移动列表时，它都会检查键盘是否可见，如果是则关闭它。尽管如此，这是一个开始。从这里我可以尝试找到一个更有效的地方来放置它。

```
@Override
 public View getView (int position, View convertView, ViewGroup parent)
 {
     View row = convertView;
     Context ctx = parent.getContext ();

     if (row == null)
     {
         LayoutInflater inflater = ((Activity) ctx).getLayoutInflater ();
         row = inflater.inflate (R.layout.li_secondary, parent, false);
     }

     // hide the keyboard when coming back from Email client Intent
     InputMethodManager imm = (InputMethodManager) ctx.getSystemService(Context.INPUT_METHOD_SERVICE);
     if (imm.isActive () == true)
         imm.hideSoftInputFromWindow (MainApp.tabHost.getCurrentTabView ().getApplicationWindowToken (),imm.HIDE_NOT_ALWAYS);
     ...
} 
```

# xslt - 如何让结果在新标签页中打开

> ID：11529111
> 
> 赞同：0
> 
> 时间：2012-07-17T19:02:09.970
> 
> 标签：xslt, google-search-appliance

链接： [http ://www.spe.org/search?q=oil&client=onepetro&proxystylesheet=spe&site=SPEsite](http://www.spe.org/search?q=oil&client=onepetro&proxystylesheet=spe&site=SPEsite)

我们使用 GSA 作为我们的搜索引擎。GSA 使用 XSLT。当我获得结果列表并单击标题时，我希望它在新选项卡中打开页面。我不知道该怎么做，也不知道我会为此包含什么代码片段。我希望有人以前用 GSA 做过这个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T18:22:24.713

如果您拥有最新版本的 GSA (6.14)，则搜索到的代码段位于 DEFAULT NON-TOUCHED XSLT 文件的第 4904-4909 行：

默认：

```
<xsl:text disable-output-escaping='yes'>&lt;a 
      ctype="c"
</xsl:text>
      rank=&quot;<xsl:value-of select="position()"/>&quot;
<xsl:text disable-output-escaping='yes'>
      href="</xsl:text> 
```

目标空白（在新窗口中打开）：

```
<xsl:text disable-output-escaping='yes'>&lt;a 
      ctype="c"
</xsl:text>
      rank=&quot;<xsl:value-of select="position()"/>&quot; target=&quot;_blank&quot;
<xsl:text disable-output-escaping='yes'>
      href="</xsl:text> 
```

我希望这会有所帮助。您必须使用提供结果的每种前端语言来执行此操作。

# c# - 当我的应用程序崩溃而不是我的崩溃报告时，JIT 调试器总是出现

> ID：11529117
> 
> 赞同：3
> 
> 时间：2012-07-17T19:02:45.663
> 
> 标签：c#, .net-4.0, exception-handling, crash-reports

我尝试过使用[Exception Reporter](http://exceptionreporter.codeplex.com/)以及其他方法，例如[https://stackoverflow.com/a/338030/342740](https://stackoverflow.com/a/338030/342740)，但无论我使用什么，Windows 崩溃错误/JIT 总是出现而不是我自己的崩溃报告。

一个简单的例子是使用 nCalc 从 try and catch 块中评估失败的表达式。

```
string formula = "10,1 * 231,2";
Expression exp = new Expression(formula);
exp.Evaluate(); 
```

基本上我不知道它为什么会失败以及我能做些什么来解决它。

我正在使用的测试 VM 是安装了 .Net4 的 Windows XP SP3，没有 Visual Studio 或其他任何东西都是干净的 WINXPSP3 安装。

示例图片：

![在此处输入图像描述](../Images/376d20019df76febb4154657a0df340e.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T22:38:22.773

正如评论中所说，您所看到的与 JIT 无关。它是 Windows 窗体默认[`ThreadException`](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.threadexception.aspx)处理程序（它不会出现在 WPF 应用程序中）。默认情况下，此对话框仅在您未附加到调试器时出现。

在您的`Main`方法中，添加以下行：

```
Application.SetUnhandledExceptionMode(UnhandledExceptionMode.CatchException); 
```

这将强制异常通过`ThreadException`处理程序，允许您处理它们并显示您自己的异常对话框。[有关MSDN](http://msdn.microsoft.com/en-us/library/ms157905.aspx)的更多信息。

# android - 使用预建的静态库

> ID：11529120
> 
> 赞同：1
> 
> 时间：2012-07-17T19:02:59.603
> 
> 标签：android, android-ndk

我查看了 SO 和 google 上的每个问题，但仍然没有运气。

我已经获得了一个预构建的静态库 libdroid.a，我需要在我的应用程序中使用它。

我试过把它放在带有 Android.mk 的 jni 文件夹中

```
LOCAL_PATH := $(call my-dir)
include $(CLEAR_VARS)
LOCAL_MODULE := libdroid
LOCAL_LDLIBS := libdroid.a
include $(PREBUILT_STATIC_LIBRARY) 
```

并在java中调用它

```
static {
        System.loadLibrary("droid");
    }

     public static native int droidCall(int num1, int num2); 
```

但是当我运行应用程序时，我得到

```
java.lang.UnsatisfiedLinkError: Couldn't load droid: findLibrary returned null 
```

我在想这是因为它不应该放在 JNI 文件夹中吗？但我也在 obj 和 libs 文件夹中尝试过。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T19:25:01.193

您需要创建自己的共享库 ( `*.so`)，它将从该预构建的静态库中调用您需要的函数。然后你加载这个`.so`库`System.loadLibrary`并使用它的原生函数

# ruby-on-rails-3 - Rails 3 设计确认路由错误

> ID：11529122
> 
> 赞同：0
> 
> 时间：2012-07-17T19:03:00.983
> 
> 标签：ruby-on-rails-3, devise, rails-routing, devise-confirmable

我在使用 Devise 时遇到了一个奇怪的路由问题。最近我通过 Devise 为我的 Rails 应用程序添加了电子邮件确认，我试图设置确认/新操作，以便用户可以在注册后重新发送他们的电子邮件确认。

因此，这是我的 Devise 用户身份验证的当前路由设置：

```
devise_for :users do    
    match 'users/logout' => 'devise/sessions#destroy'
end 
```

在运行 rake 路由之后，这就是我想要的相关新确认路径得到的：

```
new_user_confirmation GET    /users/confirmation/new(.:format)     {:action=>"new", :controller=>"devise/confirmations"} 
```

我的新确认电子邮件操作的链接如下：

```
<%= link_to "Didn't receive unlock instructions?", new_user_confirmation %> 
```

单击此链接会将我重定向到 url `/users/confirmation/new.user`，但我收到路由错误：

> **路由错误**
> 
> 没有路线匹配 {:controller=>"devise/tournaments", :action=>"results"}

这对我来说很奇怪，因为 Devise 与我的比赛控制器无关，我的比赛控制器也从未在任何与设计相关的功能中引用。

我正在使用 Rails 3.1 和 Devise 2.1.2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:34:13.013

这个问题实际上源于我所有地方的应用程序布局。到目前为止，我必须处理的唯一设计视图是注册视图和注册视图，默认情况下它们都不会呈现布局。自然地，我假设这个页面也不会，所以我不知道要留意它。

在我的应用程序布局中，我有一个链接到上面的路由，`:controller=>"devise/tournaments", :action=>"results"`只需将其更改为命名路由即可`tournament_results_path`解决我的问题。

# c# - 在 C# 中从网络获取目录

> ID：11529128
> 
> 赞同：2
> 
> 时间：2012-07-17T19:03:16.003
> 
> 标签：c#, networking, directory

我正在尝试在系统上创建文件夹列表（实际上我正在尝试制作自定义“资源管理器”）。

我需要能够列出网络驱动器，但我不知道如何。

我唯一知道该怎么做的是：

```
string[] localDrives = Directory.GetLogicalDrives(); 
```

如果我什至尝试

```
string[] initDrives = Directory.GetDirectories(initialDirectory); 
```

任何东西在哪里`initialDirectory`，从

```
initialDirectory = Directory.GetCurrentDirectory(); 
```

到网络驱动器（我想在最坏的情况下，我可以用 硬编码路径`\\`），`string[]`剩下的`null`.

如何获取所有可用路径的列表，或者给定可能在网络上的路径的目录和子目录？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T19:06:25.967

这篇 codeproject 文章可能会对您有所帮助[http://www.codeproject.com/Articles/20547/How-to-Browse-Network-Folders-using-Folder-Dialog](http://www.codeproject.com/Articles/20547/How-to-Browse-Network-Folders-using-Folder-Dialog)

# sharepoint - 使用对象模型配置共享点站点订阅用户帐户目录路径

> ID：11529130
> 
> 赞同：7
> 
> 时间：2012-07-17T19:03:23.113
> 
> 标签：sharepoint, sharepoint-2010, sharepoint-object-model

我正在 sharepoint 中进行多租户配置，我无法确定是否可以使用 sharepoint 对象模型为站点订阅设置用户帐户目录路径。我知道这可以通过 powershell 使用以下 cmdlet 来完成。

```
 $sub = New-SPSiteSubscription 
    $sub | Set-SPSiteSubscriptionConfig -UserAccountDirectoryPath "OU=AlpineBikeStore,OU=Hosting,DC=contoso,DC=com" -FeaturePack "50976ac2-83bb-4110-946d-95b4b6e90d42" -Confirm:$false 
```

到目前为止，我已经获得了以下代码，它将创建一个具有默认站点和功能包的站点订阅。但是，我不知道如何在活动目录中设置用户 OU 的路径。

```
 //Create a default admin site for this tenant
    var site = new SPSite("https://contoso.com/", userToken);

    //Create the subscription and assign the default admin site to it.
    var sub = SPSiteSubscription.Create();
    sub.Add(site);

    //Get the feature pack and assign it to the subscription
    var featurePacks = SPSiteSubscriptionSettingsManager.Local.GetAllFeaturePacks();
    var pack = featurePacks.SingleOrDefault(x => x.Id == Guid.Parse("50976ac2-83bb-4110-946d-95b4b6e90d42"));
    SPSiteSubscriptionSettingsManager.Local.AssignFeaturePackToSiteSubscription(pack, sub); 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T08:11:50.163

正如 Rikard 建议的那样，我为您使用了反射。

`Set-SPSiteSubscriptionConfig`执行以下操作：

```
 if (this.m_UserAccountDirectoryPathSpecified)
    {
        SPSiteSubscriptionPropertyCollection adminProperties = this.m_SettingsManager.GetAdminProperties(this.m_ResolvedIdentity);
        if (!string.IsNullOrEmpty(this.UserAccountDirectoryPath))
        {
            adminProperties.SetValue("UserAccountDirectoryPath", this.UserAccountDirectoryPath);
        }
        else
        {
            adminProperties.Remove("UserAccountDirectoryPath");
        }
        adminProperties.Update();
    } 
```

如您所见，它使用[`GetAdminProperties`](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spsitesubscriptionsettingsmanager.getadminproperties.aspx)方法来获取[`SPSiteSubscriptionManager`](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spsitesubscriptionsettingsmanager.getadminproperties.aspx). 然后它继续并`SPSiteSubscriptionProperty`使用 value 更新 adminProperties 集合内部`"UserAccountDirectoryPath"`。

你现在需要做的就是设置它，你就完成了。您可以使用[ILSpy](http://ilspy.net)等程序来查看 SharePoint Powershell 命令行开关的代码。在这种情况下，您可以在 `Microsoft.SharePoint.PowerShell.SPCmdletSetSiteSubscriptionConfig`.

# scala - 当我所拥有的只是父级的 ActorRef 时，如何创建一个子 Akka2 演员？

> ID：11529132
> 
> 赞同：1
> 
> 时间：2012-07-17T19:03:32.910
> 
> 标签：scala, akka

需要创建一个 Akka2 演员（派生自 UntypedActor）作为现有演员（也派生自 UntypedActor）的子级。我对父actor的唯一引用是ActorRef。有没有办法做到这一点？我想调用父级的 UntypedActorContext.actorOf() 方法，但不知道如何使用 Akka API 获取对它的引用。有没有更好的方法来实现我的目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T22:31:54.520

你不能强迫某人违背他们的意愿怀孕。你的actor需要接收一条消息，它通过创建一个新actor来响应它，并将ref发送给那个actor。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T19:23:42.393

你能改变父演员的代码吗？例如`Props`，您可以为父级中的消息类型添加处理程序并在那里创建子级。无法在 actor 类之外获取上下文。

# java - 如何在扩展 HttpServlet 的类中实例化对象？

> ID：11529134
> 
> 赞同：0
> 
> 时间：2012-07-17T19:03:42.170
> 
> 标签：java, http, session, servlets

我有一个扩展 HttpServlet 类的类。我知道 Java 它是多线程的，不同的线程（阅读：HTTP 请求）可以使用同一个实例。我想在第一个请求上实例化一个对象并使用它直到会话结束。

我应该如何进行？

例如：我想在第一个请求时打开一个文件并在会话结束时关闭它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T19:07:47.050

您可以自己在 servlet 的`doXxx()`方法之一中实例化它，具体取决于它在会话中的存在

```
SomeObject someObject = (SomeObject) request.getSession().getAttribute("someObject");

if (someObject == null) {
    someObject = new SomeObject();
    request.getSession().setAttribute("someObject", someObject);
}

// Use someObject. 
```

或者你可以自己实例化它[`HttpSessionListener`](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpSessionListener.html)

```
@WebListener
public class SomeObjectInitializer implements HttpSessionListener {

    @Override
    public void sessionCreated(HttpSessionEvent event) {
        event.getSession().setAttribute("someObject", new SomeObject());
    }

    @Override
    public void sessionDestroyed(HttpSessionEvent event) {
        // NOOP.
    }

} 
```

无论哪种方式，它`SomeObject`本身都可以实现[`HttpSessionBindingListener`](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpSessionBindingListener.html)，以便您可以在绑定和取消绑定到会话期间执行一些逻辑。

```
public class SomeObject implements HttpSessionBindingListener {

    @Override
    public void valueBound(HttpSessionBindingEvent event) {
        // Perform job during adding to the session.
    }

    @Override
    public void valueUnbound(HttpSessionBindingEvent event) {
        // Perform job during removal from the session.
    }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T19:06:02.840

> 我想在第一个请求上实例化一个对象并使用它直到会话结束。

好吧，这表明您应该将它放在会话中，而不是放在 servlet 中。

有关使用 Java servlet 中的会话的一些详细信息，请参阅[本教程](http://www.apl.jhu.edu/~hall/java/Servlet-Tutorial/Servlet-Tutorial-Session-Tracking.html)。请注意，如果您想扩展到多台服务器，则需要仔细考虑这会如何影响 sessoins。（您可以将会话信息保存在数据库中，或者尝试将负载均衡器配置为将同一会话的所有请求发送到同一台机器等）

# web-services - WebServiceException：方法参数： 不能为空。这是违反 BP 1.1 R2211

> ID：11529137
> 
> 赞同：3
> 
> 时间：2012-07-17T19:03:56.523
> 
> 标签：web-services, parameters, null, glassfish, webmethod

最近我将我的应用程序从 jboss5.1 迁移到 Glassfish 3.1.2。尽管我发现了其他问题，但现在我不能再将空参数传递给我的 web 方法。在 Jboss 中这不是问题。我应该怎么办？是否有一个标志允许通过我的 web melhod 使用 null 参数。（我的应用程序使用 icefaces3.0.1 和 JSF 2.0；WS 是一个 EJB 项目，目前也在同一个服务器中）tks

错误：

```
javax.xml.ws.WebServiceException: Method Parameter: toDate cannot be null. This is BP 1.1 R2211 violation. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-16T15:37:20.097

整件事在这里得到了讨论：[https ://java.net/jira/browse/JAX_WS-128](https://java.net/jira/browse/JAX_WS-128)

> JAX-WS 2.0 强制执行严格的 Basic Profile 1.1 合规性。以下是 .NET 框架不强制执行严格的 BP 1.1 语义的已知情况，它们的使用可能会导致互操作性问题。

同样在甲骨文：[http ://docs.oracle.com/cd/E17802_01/webservices/webservices/reference/tutorials/wsit/doc/DataBinding7.html](http://docs.oracle.com/cd/E17802_01/webservices/webservices/reference/tutorials/wsit/doc/DataBinding7.html)

不太确定什么时候，但我认为从 Tomcat 5 迁移到 6 时我遇到了同样的问题

# php - mod_rewrite 和 php 404

> ID：11529140
> 
> 赞同：0
> 
> 时间：2012-07-17T19:04:21.513
> 
> 标签：php, apache, http-status-code-404

我的 .htaccess 和 header("HTTP/1.0 404 Not Found"); 中有 RewriteRule /somefile.php index.php [L]；在我的 index.php 中。但是 404 不起作用，我得到空白页。为什么？

header("HTTP/1.0 404 Not Found"); 无需 htaccess 文件即可工作。

不要问我为什么要这样做。:D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:09:15.690

可能你的 php 是一个 fastcgi，那么你需要这样做`header("Status: 404 Not Found")`。或者您的标头已经发送，在这种情况下您可能需要为 php.ini 设置输出缓冲。并检查您的日志；-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T12:14:03.573

在 phpinfo 我有服务器 API CGI/FastCGI。我发现标头（“状态：404 未找到”）仅在 IE 中工作。在 Chrome/Firefox 中，我只看到空白页。如果不超过 256 或 512 个字符，某些浏览器还会显示自定义错误消息

# ruby-on-rails-3 - rails 3 基于布尔值验证存在

> ID：11529143
> 
> 赞同：3
> 
> 时间：2012-07-17T19:04:27.153
> 
> 标签：ruby-on-rails-3, if-statement, model, validation

我有一个名为布尔值的模型`draft`

我只想在`draft == false`.

我的模型

```
if self.draft == false
  validates :name, :presence => true, :length => { :maximum => 45 }
  validates :description, :presence => true
  validates :blurb, :presence => true, :length => { :maximum => 175 }
  validates :category_id, :presence => true
  validates :location_id, :presence => true
  validates :goal, :presence => true
else
end 
```

在我的控制器中

```
def new
  @item.new(:draft => false) || @item.new(:draft => true)

def create
  if params[:commit] == "Create Item"
    @cause = Item.new(params[:item], :draft => false)
  elsif params[:commit] == "Save Changes"
    @cause = Item.new(params[:item], :draft => true)
  end 
```

它完全忽略了我的 if 语句，并在单击时验证它是否为真`Save Changes`。

建议将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-17T19:09:36.987

条件验证如下所示

```
validates :name, :presence => true, :length => { :maximum => 45 }, :if => :draft_is_false?

private
def draft_is_false?
   draft == false
end 
```

同样，您可以对其他字段执行条件验证，并且这些字段也可以分组。浏览Ruby on Rails 指南中的[条件验证部分。](http://guides.rubyonrails.org/active_record_validations.html#conditional-validation)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-21T08:09:44.280

这是较新的 rails 语法中的一个衬里：

```
validates :name, presence: true, length: { maximum: 45 }, if: -> (item) { item.draft? } 
```

请注意，草稿属性后面有一个问号。Rails 自动为模型上的所有属性创建方法`draft?`，基本上是`attr.present?`. 当与布尔属性一起使用时，它表明开发人员的意图是检查真/假。

# scala - 如何将 java.util.concurrent.Future 包装在 Akka Future 中？

> ID：11529145
> 
> 赞同：14
> 
> 时间：2012-07-17T19:04:33.887
> 
> 标签：scala, playframework-2.0, akka, future

在 Play Framework 2.0.1 (Scala) 应用程序中，我们使用了`java.util.concurrent.Future`作为响应返回的 Web 服务客户端库。

`get()`我们不想在调用时阻止 Play 应用程序，而是将 包装`j.u.c.Future`在一个 中`akka.dispatch.Future`，以便我们可以轻松地使用播放框架的`AsyncResult`处理。

有没有人这样做过，或者有一个库或示例代码？

* * *

**更新**：我们发现最接近的是这个谷歌群组讨论：[https ://groups.google.com/forum/#!topic/play-framework/c4DOOtGF50c](https://groups.google.com/forum/#!topic/play-framework/c4DOOtGF50c)

> ...如果您所拥有的只是一个普通的 jucFuture，那么创建非阻塞解决方案的最佳方法是获取 jucFuture 和 Promise，并将它们提供给运行轮询循环的某个线程，该循环将完成 Promise，其结果为完成后的未来。

有没有人有这个的示例实现？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-18T21:17:07.460

@Viktor Klang：我们知道这`j.u.c.Future`是可憎的。但这就是我们从一个我们必须暂时接受的软件中得到的东西。

到目前为止，这是我们一起破解的：

```
def wrapJavaFutureInAkkaFuture[T](javaFuture: java.util.concurrent.Future[T], maybeTimeout: Option[Duration] = None)(implicit system: ActorSystem): akka.dispatch.Future[T] = {
  val promise = new akka.dispatch.DefaultPromise[T]
  pollJavaFutureUntilDoneOrCancelled(javaFuture, promise, maybeTimeout.map(_.fromNow))
  promise
} 
```

换句话说，创建`Promise`一个`Future`与`j.u.c.Future``pollJavaFutureUntilDoneOrCancelled`

那么我们如何根据 jucFuture 的状态“轮询”来更新 Akka Promise？

```
def pollJavaFutureUntilDoneOrCancelled[T](javaFuture: java.util.concurrent.Future[T], promise: akka.dispatch.Promise[T], maybeDeadline: Option[Deadline] = None)(implicit system: ActorSystem) {
  if (maybeDeadline.exists(_.isOverdue)) javaFuture.cancel(true);

  if (javaFuture.isDone || javaFuture.isCancelled) {
    promise.complete(allCatch either { javaFuture.get })
  } else {
    Play.maybeApplication.foreach { implicit app =>
      system.scheduler.scheduleOnce(50 milliseconds) {
        pollJavaFutureUntilDoneOrCancelled(javaFuture, promise, maybeDeadline)
      }
    }
  }
} 
```

这是对我在问题中引用的 google 群组讨论中暗示的内容的尝试。它使用 Akka 调度程序每 50 毫秒回调一次，以检查 jucFuture 是完成还是取消。每当发生这种情况时，它都会将 Akka Promise 更新为完成状态。

@Victor Klang 等人：

这是最佳实践吗？你知道更好的方法吗？我们是否错过了我们应该知道的缺点？

感谢您提供更多帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-26T12:26:53.903

您应该使用`akka.dispatch.Futures.future()`with `java.util.concurrent.Callable`：

```
val akkaFuture: akka.dispatch.Future[String] = akka.dispatch.Futures.future(
  new java.util.concurrent.Callable[String] {
    def call: String = {
      return "scala->" + javaFuture.get
    }
}, executionContext) 
```

[完整示例的要点](https://gist.github.com/huljas/07eb777f6e6d3c6e7d1f)

# r - R 直方图显示在每个 bin 中花费的时间

> ID：11529146
> 
> 赞同：2
> 
> 时间：2012-07-17T19:04:36.193
> 
> 标签：r, plot, histogram

我正在尝试创建一个类似于[这里](http://www.joefrielsblog.com/2012/07/bike-cadence-and-triathlon-race-distance.html)的情节：

![节奏分布](../Images/656fbeb9499f6eac0b2a4a210bb74691.png)

基本上我想要一个直方图，其中每个 bin 显示在该节奏范围内花费了多长时间（例如 0-20rpm 1 小时，21-40rpm 3 小时等）

```
library("rjson") # 3rd party library, so: install.packages("rjson")

# Load data from Strava API.
# Ride used for example is http://app.strava.com/rides/13542320
url <- "http://app.strava.com/api/v1/streams/13542320?streams[]=cadence,time"
d <- fromJSON(paste(readLines(url))) 
```

(rpm) 中的每个值都与（从开始的秒数）`d$cadence`中的相同索引配对。`d$time`

这些值不一定是统一的（如果您与 比较可以`plot(x=d$time, y=d$cadence, type='l')`看出`plot(d$cadence, type='l')`）

如果我做最简单的事情：

```
hist(d$cadence) 
```

..这会产生非常接近的结果，但是 Y 值是“频率”而不是时间，并且忽略了每个数据点之间的时间（因此特别是 0rpm 段的代表性不足）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T20:18:22.060

您需要创建一个新列来说明样本之间的时间。

对于这类事情，我更喜欢 data.frames 列表，所以：

```
d <- as.data.frame(fromJSON(paste(readLines(url))))
d$sample.time <- 0
d$sample.time[2:nrow(d)] <- d$time[2:nrow(d)]-d$time[1:(nrow(d)-1)] 
```

现在您已经有了采样时间，您可以简单地对采样时间大于 1 的任何内容“重复”节奏测量，并绘制其直方图

```
hist(rep(x=d$cadence, times=d$sample.time),
     main="Histogram of Cadence", xlab="Cadence (RPM)",
     ylab="Time (presumably seconds)") 
```

肯定会有一个更优雅的解决方案，它不会因非整数采样时间而崩溃，但这适用于您的示例数据。

编辑：re：更优雅，更通用的解决方案，您可以使用类似的东西处理非整数采样时间`new.d <- aggregate(sample.time~cadence, data=d, FUN=sum)`，但是问题变成为看起来像频率表但具有非整数频率的东西绘制直方图。经过一番摸索，我得出的结论是，您必须通过将数据进一步聚合到箱中来滚动您自己的直方图，然后用条形图显示它们。

# silverlight - 是否存在使用 NavigationService.GoBack() 时不调用 OnNavigatedTo() 函数的情况？

> ID：11529152
> 
> 赞同：0
> 
> 时间：2012-07-17T19:05:02.997
> 
> 标签：silverlight, windows-phone-7, navigationservice

我正在开发一个 Windows Phone 7 Silverlight 应用程序。我想知道是否存在使用 NavigationService.GoBack() 时不调用 OnNavigatedTo() 函数的情况？

我正在处理两个页面，一个可以将项目添加到数据库，另一个可以编辑数据库中的项目。主页将用户发送到每个页面

```
 NavigationService.Navigate(new Uri(string.Format("/views/Add.xaml?parameter={0}", parameter), UriKind.Relative));
    NavigationService.Navigate(new Uri(string.Format("/views/Edit.xaml?parameter1={0}&parameter2={1}", param1, param2), UriKind.Relative)); 
```

这两个选项都将用户带到一个新页面，并且都通过

```
 NavigationService.GoBack() 
```

我在 MainPage 中声明了 OnNavigatedTo() 函数，但是只有 Add 页面会导致该函数执行，而 Edit 页面似乎在返回时跳过它。OnNavigatedTo() 函数重新填充 ObservableCollection 以反映用户所做的更改。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T05:51:32.163

不，`OnNavigatedTo()`肯定会被调用。`breakpoints`您可以使用while来验证`debugging`。我认为问题可能出在您更新收藏的方式上。更多代码可能会有所帮助。

# objective-c - 查找未使用的图像或覆盖 +imageNamed: 以记录未找到的图像

> ID：11529154
> 
> 赞同：1
> 
> 时间：2012-07-17T19:05:10.953
> 
> 标签：objective-c, ios, xcode

我正在开发一个包含许多图像的 iOS 应用程序。因为我每时每刻都在我身边有一位设计师，我正在使用许多我不再需要的图像。

所以此刻，为了清理这个烂摊子，我在想：如果我使用一个类别，`UIImage`我可以重写`+imageNamed:`来记录图像的名称，也许是调用它的方法？

像这样的东西：

```
@implementation UIImage (FindImage)

+ (UIImage *)imageNamed:(NSString *)name {
  UIImage *img = [self imageNamed:name];

  if (img) {
    return img;
  } else {
    NSLog(@"\n\nImage not found: %@\n\n", name);
    return nil;
  }
}

@end 
```

我想覆盖 imageNamed 因为：

1.  我在许多不同的课程中使用它
2.  我相信当 xib 加载图像时，它会调用此方法

在简历上，我的问题是：`Can i log all images that could not be found on bundle?`

**编辑**

细化我的问题：

我看到我的问题有点复杂，所以我将尝试阐明它。

我想找到我的应用程序尝试使用的所有图像，但在我的项目中找不到这些图像。我可以删除所有图像，我可以创建一个子类，我可以创建类别，我真的不在乎。也许Xcode上有一个标志来抱怨丢失的图像......

我想要的只是找到我使用图像的所有地方，并且在捆绑包中找不到该图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-17T10:34:53.027

您可以使用[https://github.com/steipete/Aspects](https://github.com/steipete/Aspects)将日志记录指令注入到 +imageNamed 的末尾：

# ruby-on-rails - rails 多个模型的用户通知

> ID：11529155
> 
> 赞同：0
> 
> 时间：2012-07-17T19:05:13.480
> 
> 标签：ruby-on-rails, ruby-on-rails-3, observer-pattern

我仍在学习 Rails，但想确保我正朝着正确的方向前进。例如，对于我的几个模型，我想让用户列表知道在创建新记录时已经进行了更新。我想将此绑定到电子邮件和应用内通知（不需要是 AJAX），下一页刷新很好。

我一直在阅读一些观察者，我认为这就是我想要的，但根据我读过的博客，他们似乎有些争议。像 Pusher 这样的服务似乎对我的需求有点过分了。

对于这种情况，这会是一个很好的解决方案吗？另外，谁能指出我可以模仿的一些示例代码？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T23:04:33.707

如果您想学习，请查看[Rails Cast 。](http://railscasts.com/)我见过的最好的免费代码库。还可以查看这本书，这是另一个很棒的学习工具。[使用 Rails 进行敏捷 Web 开发（第 2 版）](http://pragprog.com/book/rails2/agile-web-development-with-rails)。可能有一些较新的，但我没有检查。

# android - 将RingerMode设置为正常不起作用

> ID：11529157
> 
> 赞同：0
> 
> 时间：2012-07-17T19:05:18.830
> 
> 标签：android, android-audiomanager

我已经看到很多关于振铃模式的问题。似乎没有什么可以让我知道我面临的问题。对于在前台启动的服务，我已将振铃模式设置为正常 RING 模式。不幸的是，如果它首先处于静音或振动状态，这似乎不会改变手机的铃声模式。但是，如果将同一段代码放在一个活动的按钮后面，那么它就可以工作。

上述情况仅发生在 Android 4.0.4 (ICS) 而不是 FR 2.2。关于如何解决这个问题的任何线索？这是我的代码：

```
AudioManager audioManager = (AudioManager) ctx.getSystemService(Context.AUDIO_SERVICE);
audioManager.setRingerMode(AudioManager.RINGER_MODE_NORMAL); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T18:37:14.733

我已经弄清楚为什么它在我的手机上不起作用。我还有一个名为 Flip Silent 的应用程序，它干扰了我的应用程序的工作。每次我将音频管理器设置为振铃模式后，它的服务将其设置回现有模式，导致我认为它不起作用。

调试起来很困难，因为日志没有将我引向任何方向。但是我的主屏幕上的闪烁让我发现了这一点。我卸载了翻转静音应用程序，一切正常！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-02T21:06:10.927

我也面临同样的问题，所以我喜欢这样。

```
int getMediaValue = audioManager.getStreamVolume(audioManager.STREAM_RING);
int setVolume = getMediaValue - 1;
// This was work for ring volume
audioManager.setStreamVolume(audioManager.STREAM_RING, setVolume, AudioManager.FLAG_SHOW_UI ); 
```

所以你可以试试这种方式:)

# javascript - 如何断言使用茉莉花点击事件调用间谍？

> ID：11529158
> 
> 赞同：13
> 
> 时间：2012-07-17T19:05:19.700
> 
> 标签：javascript, jasmine, dom-events, jasmine-jquery

我正在编写一个简单的点击处理程序并且需要传入的事件（像这样）

```
Thing = function($){

    var MyObject = function(opts){
        this.opts = opts;
    };

    MyObject.prototype.createSomething = function(){
        var that = this;
        $('#some_dom_element').live('click', function(e) {
            that.doStuff(e);
        });
    };

    MyObject.prototype.doStuff = function(e) {
        //do some javascript stuff ...
        e.preventDefault();
    };

    return MyObject;

}(jQuery); 
```

目前在我的茉莉花规范中，我有一些东西可以监视我期望被调用的函数（但是因为它是用 e 调用的 - 而不是没有 args - 我的断言失败了）

```
 it ("live click handler added to the dom element", function(){
        var doSpy = spyOn(sut, 'doStuff');
        sut.createSomething();
        $("#some_dom_element").trigger('click');
        expect(doSpy).toHaveBeenCalledWith();
    }); 
```

如何更正此“toHaveBeenCalledWith”以按预期工作？

* * *

**更新**

我无法按原样获得公认的答案，但我能够稍微改变它，以下是我的 100% 工作示例

```
 it ("should prevent default on click", function(){
        var event = {
            type: 'click',
            preventDefault: function () {}
        };
        var preventDefaultSpy = spyOn(event, 'preventDefault');
        sut.createSomething();
        $("#some_dom_element").trigger(event);
        expect(preventDefaultSpy).toHaveBeenCalledWith();
    }); 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-18T19:07:27.510

您必须触发自己的事件，为该`stopPropagation`方法传递一个间谍，因为您想测试事件是否已停止。

```
var event = {
    type: 'click',
    stopPropagation: function(){}
}
var spy = spyOn(event, 'stopPropagation');
$('#some_dom_element').trigger(event);
expect(spy).toHaveBeenCalled(); 
```

注意：当您监视要测试的对象时，会有代码气味，因为您开始测试类的内部行为。把你的功能想象成一个黑盒子，只测试你放入和取出的东西。在您的情况下，重命名函数会破坏测试，而代码仍然有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-11-08T13:18:18.843

如果你不能使用 jQuery，你可以使用`dispatchEvent`并检查它的返回值（基于[这个答案](https://stackoverflow.com/a/347532/9907939)）。

```
const domElem = document.getElementById('some_dom_element');
const clickEvent = new MouseEvent('click', {
  view: window,
  bubbles: true,
  cancelable: true
});

const cancelled = !domElem.dispatchEvent(clickEvent);
expect(cancelled).toBeTruthy(); 
```

# asp.net-mvc-3 - Azure 网站上的 RavenDb - 拒绝访问

> ID：11529159
> 
> 赞同：6
> 
> 时间：2012-07-17T19:05:24.300
> 
> 标签：asp.net-mvc-3, azure, ravendb, azure-web-app-service

我正在使用 Azure 上的新网站功能，并尝试让 MVC 站点在嵌入式模式下使用 RavenDB 运行。在本地一切正常，但在 azure 中运行部署的站点时出现此错误：

System.Net.NetworkInformation.NetworkInformationException：访问被拒绝

当我在 global.asax 中创建数据库实例时会发生这种情况：

```
Store = EmbeddableDocumentStore { ConnectionStringName = "RavenDb" }; 
```

我的连接字符串是：

```
<add name="RavenDb" connectionString="DataDir=~\App_Data\Raven" /> 
```

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-17T22:17:32.633

当没有为 RavenDb 指定端口时，它会出去并尝试找到它自己的，它通过调用*IPGlobalProperties.GetActiveTcpListeners()*来做到这一点。

[乌鸦数据库 | PortUtil.cs](https://github.com/ravendb/ravendb/blob/master/Raven.Database/Util/PortUtil.cs)

```
var activeTcpListeners = IPGlobalProperties
                         .GetIPGlobalProperties()
                         .GetActiveTcpListeners(); 
```

调用[GetActiveTcpListeners()](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.ipglobalproperties.getactivetcplisteners.aspx)实习生调用 Win32 函数**GetTcpTable()**尝试枚举主机上所有可能的端口组合。出于显而易见的原因，允许人们在 Windows Azure 网站中进行端口扫描并不是一个好的方案。这意味着**GetTcpTable**操作失败，当开发世界中的某些事情失败时，我们会抛出异常。

在这种特殊情况下，异常是[NetworkInformationException](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.networkinformationexception.aspx)引发的安全权限忽略对**GetTcpTable**的调用。这就是导致访问被拒绝消息的原因。

**tl;博士**

将默认端口添加到您的 web.config appsettings 部分：

```
 <appSettings> 
    <add key="Raven/Port" value="*"/> <!-- Add real tcp port # -->
    <add key="Raven/DataDir" value="~\Data"/> 
    <add key="Raven/AnonymousAccess" value="Get" /> 
 </appSettings> 
```

# objective-c - CGBitmapContextCreate() 有大小限制吗？

> ID：11529162
> 
> 赞同：1
> 
> 时间：2012-07-17T19:05:30.467
> 
> 标签：objective-c, macos, core-graphics

我想制作一个非常大的位图（每边 250,000 像素，最终写成 BigTIFF）。我在文档中的任何地方都没有看到内存大小或尺寸限制，Core Graphics 可以处理它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:47:40.230

CG 不是为这种工作负载而设计的。

（坦率地说，如果您找到任何通用图形框架，我会感到惊讶。如果您要推送那么大的图像，您将不得不编写自己的代码才能在合理的时间内完成任何事情.)

根据我的经验，一旦尺寸超过 32767 左右，图像就会开始失败。不是以任何有组织的方式，只是崩溃和难以重现的故障；API 的某些部分会起作用，而其他部分则不会。64 位的情况可能会更好，但我不会指望它。

# c# - 如何在 SpeechSynthesizer 中使用词典？

> ID：11529164
> 
> 赞同：15
> 
> 时间：2012-07-17T19:05:36.787
> 
> 标签：c#, text-to-speech

我正在执行一些文本到语音转换，我想在词典文件中指定一些特殊的发音。我已经逐字运行了[MSDN 的 AddLexicon 示例](http://msdn.microsoft.com/en-us/library/microsoft.speech.synthesis.speechsynthesizer.addlexicon.aspx)，它说出了这个句子，但它*没有*使用给定的词典，似乎有些东西被破坏了。

这是提供的示例：

```
using System;
using Microsoft.Speech.Synthesis;

namespace SampleSynthesis
{
  class Program
  {
    static void Main(string[] args)
    {

      // Initialize a new instance of the SpeechSynthesizer.
      using (SpeechSynthesizer synth = new SpeechSynthesizer())
      {

        // Configure the audio output. 
        synth.SetOutputToDefaultAudioDevice();

        PromptBuilder builder = new PromptBuilder();
        builder.AppendText("Gimme the whatchamacallit.");

        // Append the lexicon file.
        synth.AddLexicon(new Uri("c:\\test\\whatchamacallit.pls"), "application/pls+xml");

        // Speak the prompt and play back the output file.
        synth.Speak(builder);
      }

      Console.WriteLine();
      Console.WriteLine("Press any key to exit...");
      Console.ReadKey();
    }
  }
} 
```

和词典文件：

```
<lexicon version="1.0" 
      xmlns="http://www.w3.org/2005/01/pronunciation-lexicon"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
      xsi:schemaLocation="http://www.w3.org/2005/01/pronunciation-lexicon 
        http://www.w3.org/TR/2007/CR-pronunciation-lexicon-20071212/pls.xsd"
      alphabet="x-microsoft-ups" xml:lang="en-US">

  <lexeme>
    <grapheme> whatchamacallit </grapheme>
    <phoneme> W S1 AX T CH AX M AX K S2 AA L IH T </phoneme>
  </lexeme>

</lexicon> 
```

控制台打开，说出文本，但不使用新的发音。我当然已经将文件保存到`c:\test\whatchamacallit.pls`指定的位置。

我尝试了 Uri 和文件位置（例如`@"C:\Temp\whatchamacallit.pls"`, `@"file:///c:\test\whatchamacallit.pls"`）、绝对路径和相对路径、将其复制到构建文件夹等的变体。

我运行了[Process Monitor](http://live.sysinternals.com/processmonitor.exe)并且**没有访问**该文件。如果是目录/文件权限问题（不是），我仍然会看到拒绝访问消息，但是除了偶尔来自我的文本编辑器的参考之外，我根本没有记录任何参考。我在尝试时确实看到了访问的文件`File.OpenRead`。

不幸的是，使用垃圾 Uri 时没有错误消息。

经过进一步调查，我意识到这个例子来自[Microsoft.Speech.Synthesis](http://msdn.microsoft.com/en-us/library/microsoft.speech.synthesis.speechsynthesizer.addlexicon.aspx)，而我在这里使用[System.Speech.Synthesis](http://msdn.microsoft.com/en-us/library/system.speech.synthesis.speechsynthesizer.addlexicon.aspx)。但是据我所知，除了一些额外的信息和示例之外，它们是相同的，并且都指向相同的规范。这仍然是问题吗？

我确认该项目已设置为使用正确的 .NET Framework 4。

我将 MSDN 中的[示例与引用规范](http://www.w3.org/TR/pronunciation-lexicon/#S5)中的示例进行了比较，并直接尝试了这些示例，但没有帮助。考虑到该文件似乎没有被访问，我并不感到惊讶。

（我可以`PromptBuilder.AppendTextWithPronunciation`很好地使用，但对于我的用例来说这是一个糟糕的选择。）

**MSDN上的例子坏了吗？如何在 SpeechSynthesizer 中使用词典？**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-22T00:21:28.020

经过大量的研究和陷阱，我可以向你保证，你的假设是完全错误的。出于某种原因`System.Speech.Synthesis.SpeechSynthesizer.AddLexicon()`，将词典添加到内部列表中，但根本不使用它。似乎以前没有人尝试过使用它并且这个错误没有被注意到。

`Microsoft.Speech.Synthesis.SpeechSynthesizer.AddLexicon()`另一方面（属于 Microsoft Speech SDK）按预期工作（它将词典传递给 COM 对象，COM 对象将其解释为广告）。

有关如何安装 SDK，请参阅本指南：http: [//msdn.microsoft.com/en-us/library/hh362873%28v=office.14%29.aspx](http://msdn.microsoft.com/en-us/library/hh362873%28v=office.14%29.aspx)

笔记：

*   人们报告了 64 位版本导致 COM 异常（因为库没有正确安装），我在 64 位 Windows 7 机器上确认了这一点
    *   使用x86版本规避问题
*   务必在 SDK 之前安装运行时
*   确保还安装运行时语言（如链接页面上的建议），因为 SDK 不使用默认系统语音引擎

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-11-25T15:58:47.347

您可以使用`System.Speech.Synthesis.SpeechSynthesizer.SpeakSsml()`而不是词典。

此代码将“blue”的发音改为“yellow”，将“dog”的发音改为“fish”。

```
SpeechSynthesizer synth = new SpeechSynthesizer();
string text = "This is a blue dog";
Dictionary<string, string> phonemeDictionary = new Dictionary<string, string> { { "blue", "jelow" }, { "dog", "fyʃ" } };
foreach (var element in phonemeDictionary)
{
   text = text.Replace(element.Key, "<phoneme ph=\"" + element.Value + "\">" + element.Key + "</phoneme>");
}
text = "<speak version=\"1.0\" xmlns=\"http://www.w3.org/2001/10/synthesis\" xml:lang=\"en-US\">" + text + "</speak>";
synth.SpeakSsml(text);
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-03-25T04:50:48.840

我最近在 Windows 10 上一直在研究这个问题。

我发现了两件事`System.Speech.Synthesis`。

您使用的任何语音都必须与 Lexicon 文件中的语言相匹配。在词典中，您有以下语言：

```
<lexicon version="1.0"
      xmlns="http://www.w3.org/2005/01/pronunciation-lexicon"
      alphabet="x-microsoft-ups" xml:lang="en-US">
```

我发现我可以将我的词典命名为“blue.en-US.pls”并使用“blue.en-GB.pls”进行复制。里面会有 xml:lang="en-GB"

在您将使用的代码中：

```
string langFile = Path.Combine(_appPath, $"blue.{synth.Voice.Culture.IetfLanguageTag}.pls");
synth.AddLexicon(new Uri(langFile), "application/pls+xml");
```

我发现的另一件事是，它根本不适用于“Microsoft Zira Desktop - 英语（美国）”。我不知道为什么。这似乎是 Windows 10 上的默认语音。

在此处访问和更改您的默认语音：%windir%\system32\speech\SpeechUX\SAPI.cpl

否则你应该可以通过代码设置它：

```
var voices = synth.GetInstalledVoices();
// US: David, Zira. UK: Hazel.
var voice = voices.First(v => v.VoiceInfo.Name.Contains("David"));
synth.SelectVoice(voice.VoiceInfo.Name);
```

我有 David（美国）和 Hazel（英国），它们中的任何一个都可以正常工作。这似乎与注册表中的语音令牌是否具有`SpLexicon`键值直接相关。Microsoft Zira Desktop 语音没有此注册表值。虽然 Microsoft David Desktop 语音具有以下特性： `Computer\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Speech\Voices\Tokens\TTS_MS_EN-US_DAVID_11.0\Attributes\SpLexicon`=`{0655E396-25D0-11D3-9C26-00C04F8EF87C}`

# amazon-ec2 - 在 Amazon Elastic Block Storage (EBS) 中创建目录结构并从 Java Servlet 保存文件？

> ID：11529167
> 
> 赞同：2
> 
> 时间：2012-07-17T19:05:43.020
> 
> 标签：amazon-ec2, amazon-web-services, amazon-ebs

我对此很陌生，并且第一次尝试这样做。我了解到，`Amazon Elastic Block Storage(EBS)`当安装在 Amazon EC2 上时，它可以以与硬盘类似的方式使用。现在我想在 EBS 中创建一个目录结构并将 Java Servlet 中的文件保存在 EBS 中？

我还了解到开发机器中 servlet 使用的代码也可用于在 EBS 中创建目录结构访问文件

```
@MultipartConfig( location          = "d:\\tmp", 
                  fileSizeThreshold = 1024 * 1024, 
                  maxFileSize       = 1024 * 1024 * 5,
                  maxRequestSize    = 1024 * 1024 * 5 * 5  ) 
```

我在我的 Amazon EC2 上安装了 Amazon Linux，任何指针都会有很大帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T21:59:01.217

EBS*与*硬盘不同，从应用程序的角度来看，它的行为与硬盘*完全相同*（除了它比桌面硬盘慢，除非您将多个 EBS 卷条带化到软件 RAID 配置中）。

挂载 EBS 卷后，您可以像使用任何其他存储一样使用 EBS 存储。

可以在此处找到有关如何为 Linux 安装卷的说明：

[http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/ebs-using-volumes.html](http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/ebs-using-volumes.html)

按照这些步骤，您最终会得到一个目录

> /mnt/数据存储

对应于 EBS 卷。如果您不喜欢该名称`data-store`，可以将其更改为其他名称。

我确实注意到您的示例代码指的`"d:\\tmp"`是 Windows 路径规范，但您声明您的实例正在运行 Linux。确保调整任何指向 的路径`/mnt/data-store`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-28T06:38:14.450

开始使用 EBS 卷的最简单方法是启动 EBS 支持的 EC2 实例。那些预先连接到 EBS 卷（它是引导卷）。

# opencart - Opencart 如何关联产品中的 2 个选项

> ID：11529169
> 
> 赞同：0
> 
> 时间：2012-07-17T19:06:04.537
> 
> 标签：opencart, opencart2.x

你好我有以下问题。

我的产品有两种不同的选择，尺寸和颜色。但是当有人购买产品时，我不知道如何关联这些选项。例如。我的库存中有 4 件 T 恤 2 蓝色 T 恤尺寸 S 1 绿色 T 恤尺寸 L 1 黄色 T 恤尺寸 XL

我使用这些要求选项（尺寸和颜色）配置了产品，但例如客户可以购买 XL 码蓝色 T 恤，这是错误的，因为我无法将颜色与尺寸相关联。任何想法，插件或建议？？？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T20:45:12.120

在扩展商店中查看相关选项。这似乎是你所追求的

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-12-16T08:39:26.423

有一个为此[OpenCart 相关选项设计的扩展](http://liveopencart.com/related-options/)

# python - askdirectory() 将焦点更改为不同的窗口

> ID：11529170
> 
> 赞同：0
> 
> 时间：2012-07-17T19:06:07.217
> 
> 标签：python, focus, tkinter

我正在使用 Tkinter 构建两个窗口。一个主要的，按下一个按钮会导致第二个窗口的创建。

第二个窗口在创建时不会立即获得焦点。我可以通过调用 .focus_force() 来修复。但是，当我从 tkFileDialog 调用 askdirectory() 函数时，焦点会变回第一个窗口。

我怎样才能防止发生焦点切换，而不是简单地到处调用 focus_force() ？

复制问题：

```
from Tkinter import *
from tkFileDialog import *

class app:
    def __init__(self, master):
        Button(master, command = make_new).grid()
    def make_new(self):
        root = Tk()
        new = new_win(root)
        root.mainloop() #here the focus is on the first window
class new_win:
    def __init__(self, master):
        f = askdirectory() #even after placing focus on second window,
                           #focus goes back to first window here 
```

我正在使用 Python 2.7.3。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T02:56:14.837

很少记录的 wm_attributes 方法可能会有所帮助：

```
from Tkinter import *
import tkFileDialog

root = Tk()

top = Toplevel()
top.wm_attributes('-topmost', 1)
top.withdraw()
top.protocol('WM_DELETE_WINDOW', top.withdraw)

def do_dialog():
    oldFoc = top.focus_get()
    print tkFileDialog.askdirectory()    
    if oldFoc: oldFoc.focus_set()

b0 = Button(top, text='choose dir', command=do_dialog)
b0.pack(padx=100, pady=100)

def popup():
    top.deiconify()
    b0.focus_set()

b1 = Button(root, text='popup', command=popup)
b1.pack(padx=100, pady=100)
root.mainloop() 
```

# javascript - jQuery动画超时

> ID：11529171
> 
> 赞同：0
> 
> 时间：2012-07-17T19:06:07.143
> 
> 标签：javascript, jquery

我有一个用 jQuery 实现的动画脚本。问题是它在返回父函数之前没有完成动画。澄清一下：js改变背景颜色，js函数调用animate函数，动画函数开始，在它完成之前它已经返回到父级并继续下一行js。

```
function step5(){
/*code*/    
currentNode.obj.style.backgroundColor="white";
movePacket(currentNode, objects[currentNode.switchName]);
objects[currentNode.switchName].obj.style.backgroundColor="#ADEBFF";    
    /*code*/    
}

function movePacket(obj1, obj2){
var x = obj2.x - obj1.x;
var y = obj2.y - obj1.y;
$("#packet").animate({"left": "+="+x+"px", "top": "+="+y+"px"}, 3000);
} 
```

我需要代码等待动画完成然后继续。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:08:58.640

您应该将其作为回调函数传递给该`animate`方法：

```
function step5() {
    currentNode.obj.style.backgroundColor = "white";

    movePacket(currentNode, objects[currentNode.switchName], function() {
        objects[currentNode.switchName].obj.style.backgroundColor = "#ADEBFF"; 
    });
}

function movePacket(obj1, obj2, callback) {
    var x = obj2.x - obj1.x;
    var y = obj2.y - obj1.y;

    $("#packet").animate({
        left: "+=" + x + "px",
        top:  "+=" + y + "px"
    }, 3000, callback);
} 
```

# c# - 我可以避免在派生自 iPhoneOSGameView 的视图中导出 LayerClass 吗？

> ID：11529173
> 
> 赞同：1
> 
> 时间：2012-07-17T19:06:14.720
> 
> 标签：c#, ios, xamarin.ios, opentk

给定一个类：

```
public class BaseGameView : OpenTK.Platform.iPhoneOS.iPhoneOSGameView { 
```

在运行时构造`BaseGameView`会抛出**System.Exception: Failed to find selector layerClass** ... 这很容易通过在类定义中添加以下内容来解决：

```
 [Export ("layerClass")]
    public static new Class GetLayerClass()
    {
        return iPhoneOSGameView.GetLayerClass();
    } 
```

在我按如下方式派生另一个类之前，这并不是那么不可取：

```
public class DerivedGameView : BaseGameView { 
```

`DerivedGameView`除非我也从该类中导出（“layerClass”），否则构造也会引发相同的异常。

我怎样才能把它[弄干](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)？我有一些这些派生视图，它们都必须有相同的代码片段来导出图层类......我不想重复它。

一个相关的问题是：
为什么对于简单派生的类来说这不是必需的`UIView`？

干杯!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T10:27:55.883

This is currently a limitation inside MonoTouch - static methods from base classes aren't exported.

I have filed a bug report for this: [https://bugzilla.xamarin.com/show_bug.cgi?id=6170](https://bugzilla.xamarin.com/show_bug.cgi?id=6170) - you can CC yourself on this bug to get notified when it's fixed.

# mongodb - AWS MongoDB EC2 实例作为具有 EC2 应用程序实例的 localhost

> ID：11529175
> 
> 赞同：3
> 
> 时间：2012-07-17T19:06:17.460
> 
> 标签：mongodb, amazon-ec2, amazon-web-services, localhost

我实际上是 AWS 的新手。我配置了 2 个 EC2 实例。

一个用于我的 MongoDB 数据库，另一个用于我的应用程序。

我正在使用 pymongo 进行连接。但是如果每次都通过实例发送数据，会花费太多时间。我想知道是否可以将 mongoDB 实例作为应用程序的本地主机，使用组或我不知道，以获得更好的性能。

或者如果将数据库与我的应用程序放在同一个实例上并获得更多 EBS 会更好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T19:13:01.983

确保你知道你的性能瓶颈在哪里。

如果两个实例都在同一个可用区，网络延迟不应该是最大的性能问题。实际上，如果您的实例至少*很大*……由于更好的 NIC……网络延迟应该不是问题。

要确定，请使用监控工具测量您的网络利用率。

如果您的任何工作集（以任何频率使用的 MongoDB 文档）无法放入实例的 RAM，则意味着您正在接触 EBS。与 MongoDB 所需的相比，EBS*非常非常慢。*[我最近使用iozone](http://iozone.org/)测量了单个 EBS 卷，发现 EBS 卷的速度是笔记本电脑旋转硬盘驱动器的一半。

[您可以通过将多个 EBS 卷条带化](http://dodizzle.com/setting-up-software-raid-zero-over-8-volumes)到软件 RAID 配置中 来显着提高 EBS 性能。

在 AWS 上运行 MongoDB 时的底线是您需要足够的 RAM 来保存您会以任何频率接触的 MongoDB 文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:17:06.387

我有一个生产应用程序，它在与 Web 服务器相同的机器上使用 mongodb 实例。对我来说很好，但我现在不需要可扩展性。一个实例就足够了。

因此，要回答您的问题，请确保您可以将其作为 localhost 运行。

但是，如果您的应用程序启动并且您需要多个实例或分片等，那么您也必须将实例部署在其他机器上。

# asp.net - 在 IIS 7.5 Express 中使用 ASP.Net Preloader

> ID：11529177
> 
> 赞同：3
> 
> 时间：2012-07-17T19:06:28.500
> 
> 标签：asp.net, .net-4.0, iis-7.5, asp.net-4.0, iis-express

### 设想

我正在尝试在我的 ASP.Net 应用程序中自动启动/保持活动/预加载信息。说明简单明了：[ASP.Net + IIS 7.5 - Preloading & Auto Starting](http://www.asp.net/whitepapers/aspnet4#0.2__Toc253429241)，但我在 IIS 7.5 Express 中这样做时遇到问题。我收到有关某些配置元素的 500.19 错误。以下是上下文和问题：

### 应用程序主机配置

```
<!-- Inside the ApplicationPools element we tell the appropriate app pool 
     to auto start and always run. -->
<add name="Clr4IntegratedAppPool" managedRuntimeVersion="v4.0" managedPipelineMode="Integrated" CLRConfigFile="%IIS_USER_HOME%\config\aspnet.config" autoStart="true" startMode="AlwaysRunning" />

<!-- In the Sites element we first ensure our application is using the correct 
     app pool. Then we tell it to use the pools auto start functionality, and 
     point it towards a provider to use. -->
<site name="ED.Web" id="11">
    <application path="/" applicationPool="Clr4IntegratedAppPool" serviceAutoStartEnabled="true" serviceAutoStartProvider="Preload-UserReconciliation">
    <!-- everything is properly closed -->

<!-- Just before closing the Sites element we declare a provider; it identifies 
     the class within a particular assembly that should be used for preloading -->
    <serviceautostartproviders>
        <add name="Preload-UserReconciliation" type="ED.Web.ApplicationPreload, ED.Web" />
</serviceautostartproviders>
</sites> 
```

### 错误 1

错误 500.19，无法识别的元素“serviceautostartproviders”

```
239:    <serviceautostartproviders>
240:        <add name="Preload-UserReconciliation" type="ED.Web.ApplicationPreload, ED.Web" /> 
```

### 错误 2 [编辑]

完全关闭 IIS Express 并再次从 VS 启动应用程序后，我得到一个 Visual Studio 弹出窗口：`"Unable to launch the IIS Express Web server."`

### 问题

如何正确设置 IIS Express 7.5 以启动池，并使用我的`ApplicationPreload : IProcessHostPreloadClient`类预加载应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:39:37.627

尴尬...

[http://www.iis.net/download/ApplicationInitialization](http://www.iis.net/download/ApplicationInitialization)

我完全错过了这是 IIS 7.5 的带外模块，而不是基本功能。

它包含在从 IIS 8.0 开始的基本功能中。

我在上面找到的带有此信息的原始帖子并没有指出这一点，当我使用有问题的链接时，我完全轻而易举地看到了仅查看代码的亮黄色框。

# javascript - 如何将此javascript转换为jquery？

> ID：11529182
> 
> 赞同：0
> 
> 时间：2012-07-17T19:06:41.780
> 
> 标签：javascript, jquery

我有这段代码，但我不确定如何将其转换为 jquery，因为`check`我使用该变量来查看`if`语句中的内容是否至少发生过一次。`gph_img_list`是许多单选按钮的名称标签。

```
 var check = false;
    for (var i=0; i < gph_img_list.length; i++) { 
        if (gph_img_list[i].value == var_gph_img.innerHTML) { 
            gph_img_list[i].checked = true;
            check = true;               
            break;
        }
    }
    if (!check) {
        var_gph_img.innerHTML = "";
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:13:09.410

我不确定通过将其转换为 jQuery 可以获得什么，但根据您所展示的内容，这应该在可行的情况下使用 jQuery 完成相同的任务：

```
var text = $(var_gph_img).html();
var check = false;
$(gph_img_list).each(function() {
    if (this.value == text) {
        check = true;
        $(this).prop("checked", true);
        return(false);  // stop the .each() loop
    }
});
if (!check) {
    $(var_gph_img).html("");
} 
```

如果您想更有效地执行此操作，则必须向我们展示您的 HTML，以便我们可以设计 jQuery 选择器来完成大部分工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:20:44.313

使用**[过滤](http://api.jquery.com/filter/)**功能...

```
​var check = $(gph_img_list).filter(function (index, element) {
    return element.value === var_gph_img.innerHTML;
}).first().attr("checked", true).length > 0;

if (!check) { var_gph_img.innerHTML = ""; } 
```

这是一个**[小提琴](http://jsfiddle.net/36qcC/1/)****，因为文本不**匹配，所以没有选中复选框。（将 div 中的 'a' 更改为 x、y 或 z 以查看差异）

这是一个**[小提琴](http://jsfiddle.net/36qcC/2/)**，因为文本匹配，**所以选中了一个复选框。**

# r - 当行包含相同字符时删除列

> ID：11529190
> 
> 赞同：2
> 
> 时间：2012-07-17T19:07:14.357
> 
> 标签：r

我有一个字符/数字组合矩阵，我需要删除那些列的两行中都出现相同字符的列。对于一个简化的例子：

```
> chars <- c("A1","A2","B1","B2")
> charsmat <- combn(chars, 2)
> charsmat
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,] "A1" "A1" "A1" "A2" "A2" "B1"
[2,] "A2" "B1" "B2" "B1" "B2" "B2" 
```

当单列的两行包含相同的字符（在本例中为第 1 列和第 6 列）时，我需要删除该列。我觉得我已经掌握了这些部分：使用`gsub()`或`str_extract()`隔离字符，并测试行之间是否存在匹配，但我不知道如何制定它。提前感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T19:21:54.800

首先，创建一个仅提取字母部分的新矩阵：

```
> (charsmat.alpha <- substr(charsmat, 0, 1))
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,] "A"  "A"  "A"  "A"  "A"  "B" 
[2,] "A"  "B"  "B"  "B"  "B"  "B" 
```

然后，获取`charsmat`其中两行`charsmat.alpha`不相同的列子集：

```
> charsmat[,(charsmat.alpha[1,] != charsmat.alpha[2,])]
     [,1] [,2] [,3] [,4]
[1,] "A1" "A1" "A2" "A2"
[2,] "B1" "B2" "B1" "B2" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T19:33:54.817

这是一个更通用的解决方案，它将删除第 1 行条目中的任何*字母与第 2 行条目中的**任何字母* 匹配的列：

```
## Your data
chars <- c("A1","A2","B1","B2")
charsmat <- combn(chars, 2)

vetMatrix <- function(mat) {
    ## Remove non-alpha characters from matrix entries
    mm <- gsub("[^[:alpha:]]", "", mat)    
    ## Construct character class regex patterns from first row
    patterns <- paste0("[", mm[1,], "]")
    xs <- mm[2,]    
    ## Extract columns in which no character in first row is found in second
    mat[,!mapply("grepl", patterns, xs), drop=FALSE]
}

## Try it with your matrix ...
vetMatrix(charsmat)
#      [,1] [,2] [,3] [,4]
# [1,] "A1" "A1" "A2" "A2"
# [2,] "B1" "B2" "B1" "B2"

## ... and with a different matrix
mat <- matrix(c("AB1", "B1", "AA11", "BB22", "this", "that"), ncol=3) 
mat
#      [,1]  [,2]   [,3]  
# [1,] "AB1" "AA11" "this"
# [2,] "B1"  "BB22" "that"
vetMatrix(mat)
#     [,1]  
# [1,] "AA11"
# [2,] "BB22" 
```

# jquery - jquery选择器所有可能的属性列表

> ID：11529191
> 
> 赞同：0
> 
> 时间：2012-07-17T19:07:23.943
> 
> 标签：jquery, attributes, components, loops

我想列出一个 html 控件（无论是按钮、文本、单选还是复选框）具有的所有可能属性。借助此代码：

```
var attrs = $("#mybutton").attributes;
$.each(attrs, function(i, attrib)
{
  var name = attrib.name;
  var value = attrib.value;
}); 
```

我可以获得有值的属性列表。但我想要的不止这些，我需要能够列出所有可能的属性，而不仅仅是那些具有值的属性。谢谢你。

* * *

拥有一个包含一些动态创建的控件的页面，我想列出控件可以具有的所有属性（标准 + 可选）：

```
$("#dropableDiv").delegate('.ui-draggable','click',function() 
{
    listAttributes(this.attributes);
}); 
```

但是，使用此 listAttributes 方法仅显示几个标准属性（在动态创建控件时指定的属性）：

```
function listAttributes(attrs)
{
     $("#at").append("list of attributes:</br>");
     $("#at").append("<table>");

     $.each(attrs, function(i, attrib)
     {
     $("#at").append("<tr>");
         var name = attrib.name;
         var value = attrib.value;
         $("#at").append("<td>");
         $("#at").append(name);     
             $("#at").append("</td>");
         $("#at").append("<td>");
         $("#at").append('<input type="text" id="prop' + name + '" value="' + value + '" /></br>'); 
             $("#at").append("</td>");
     $("#at").append("</tr>");      
     });
     $("#at").append("</table>");

} 
```

例如：在输入类型按钮的情况下，列出这些属性：类型、值、id、样式、类。在输入类型文本的情况下，列出这些属性：类型、大小、id、样式、类

其他可选属性（尚无值）未列出。例如：大小、alingn、alt、只读、名称、已检查...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:21:51.700

这是一个简短的代码和[演示](http://jsfiddle.net/Xn9ky/21/)

```
var attrs = $('div').get(0).attributes;
console.log($(attrs));
$(attrs).each(function(i,item)
              {
                   console.log(item.nodeName);
                  console.log(item.nodeValue);                  
              }); 
```

# facebook - 您可以使用 Graph API 复制用户共享以使帖子聚合起作用吗？

> ID：11529192
> 
> 赞同：3
> 
> 时间：2012-07-17T19:07:24.203
> 
> 标签：facebook, facebook-graph-api

我希望能够使用 Graph API 来实现与用户共享时发生的情况类似的效果，即您在共享上获得聚合，这样如果多个用户或页面共享同一个帖子，您就不会看到多个帖子新闻提要中的时间。

我看不出该怎么做。您可以创建一个新帖子并将其发布到 /feed，但这不会触发聚合，也不是我想要的。我已经尝试发布指向原始链接的链接，即 /page_id/posts/post_id，但这并没有做到。

我见过几个这样的问题，但没有明确的答案。有没有人设法做到这一点？

# java - java中的自定义键盘快捷键

> ID：11529195
> 
> 赞同：3
> 
> 时间：2012-07-17T19:08:04.740
> 
> 标签：java, swing, keyboard-shortcuts, key-bindings, acceleratorkey

我正在开发一个 java swing 应用程序。我想添加一个键盘快捷键说`CTRL   `+ `H`。这应该执行 jButton1 在单击时执行的相同操作。

即使 jButton1 没有获得焦点，此快捷方式的行为也应相同。

我尝试使用 KeyEventDispatcher，但它似乎对我不起作用。还有其他方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T02:25:13.757

好的 - 首先我认为没有办法在 Java Swing 中设置应用程序范围的快捷方式（请参阅此[问题](https://stackoverflow.com/questions/458756/java-system-wide-keyboard-shortcut)）。但对于一个组件，这是可能的。

您必须`Action`为`KeyStroke`. 但是对于 Windows，我发现这个库非常[有用](http://code.google.com/p/jintellitype/)。

```
 {
        KeyStroke cancelKeyStroke = KeyStroke
                .getKeyStroke((char) KeyEvent.VK_ESCAPE);
        Keymap map = JTextComponent.getKeymap(JTextComponent.DEFAULT_KEYMAP);
        map.addActionForKeyStroke(cancelKeyStroke, cancelKeyAction);
    }
    private static Action cancelKeyAction = new AbstractAction() {
        public void actionPerformed(ActionEvent ae) {
            Component comp = (Component) ae.getSource();
            Window window = SwingUtilities.windowForComponent(comp);
            if (window instanceof Dialog) {
                window.dispose();
            } else if (comp instanceof JTextComponent
                    && !(comp instanceof JFormattedTextField)) {
                JTextComponent tc = (JTextComponent) comp;
                int end = tc.getSelectionEnd();
                if (tc.getSelectionStart() != end) {
                    tc.setCaretPosition(end);
                }
            }
        }
    }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T19:10:17.797

我认为您的问题的答案可以在这里找到[http://docs.oracle.com/javase/6/docs/api/javax/swing/JComponent.html#registerKeyboardAction%28java.awt.event.ActionListener,%20java。 lang.String,%20javax.swing.KeyStroke,%20int%29](http://docs.oracle.com/javase/6/docs/api/javax/swing/JComponent.html#registerKeyboardAction%28java.awt.event.ActionListener,%20java.lang.String,%20javax.swing.KeyStroke,%20int%29)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T19:17:54.673

您应该查看[Key Bindings](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)，使用类[`KeyStroke`](http://docs.oracle.com/javase/7/docs/api/javax/swing/KeyStroke.html)和[`InputMap`](http://docs.oracle.com/javase/7/docs/api/javax/swing/InputMap.html). 来自 Oracle [`TextComponentDemo`](http://docs.oracle.com/javase/tutorial/displayCode.html?code=http://docs.oracle.com/javase/tutorial/uiswing/examples/components/TextComponentDemoProject/src/components/TextComponentDemo.java)（稍作修改，但仍使用[DefaultEditorKit](http://docs.oracle.com/javase/7/docs/api/javax/swing/text/DefaultEditorKit.html#backwardAction)作为示例）：

```
// CTRL + H
KeyStroke key = KeyStroke.getKeyStroke(KeyEvent.VK_H, Event.CTRL_MASK);
// bind the keystroke to an object
inputMap.put(key, DefaultEditorKit.backwardAction); 
```

如果您希望即使组件没有焦点也能触发事件，请在[Key Listeners](http://docs.oracle.com/javase/tutorial/uiswing/events/keylistener.html)上使用它们：

> [如果要在组件没有焦点时激活键绑定，则键侦听器也很困难。](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-18T01:58:48.197

与其`Control`显式使用键作为修饰符，不如使用`MASK`返回的 by`getMenuShortcutKeyMask()`以获得更好的跨平台用户体验。`ImageApp`就是一个[例子](https://stackoverflow.com/a/5129757/230513)。

# php - 检查网站是否存在

> ID：11529196
> 
> 赞同：0
> 
> 时间：2012-07-17T19:08:19.710
> 
> 标签：php, curl

> **可能重复：**
> [如何使用 PHP 检查远程文件是否存在？](https://stackoverflow.com/questions/981954/how-can-one-check-to-see-if-a-remote-file-exists-using-php)

我想以编程方式检查网站是否存在。我知道我可以通过使用“cURL”或“fopen”打开 url 来做到这一点，但这需要很多时间，因为它需要获取整个页面。

此外，此方法不可靠，因为可能存在其他原因，例如不支持的协议能够打开网站。

有没有别的办法？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T19:12:22.547

您可以简单地使用 HEAD 请求来仅获取页面的标题而不是整个页面。尽管如此，该网站仍会生成完整页面，但至少您不会下载所有内容。

为此，您可以使用许多方法，只需检查如何更改请求的标头，而不是执行 GET，您可以执行 HEAD。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T19:12:03.037

`fopen()`并且`fread()`不要阅读整个网页（不一定）。您可以使用它并仅读取几个字节来确定网站是否存在（200 OK）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T19:11:26.447

您可以只发送一个标头请求并检查 http 响应代码吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T19:12:28.980

```
$file = 'http://www.test.com/idontexist.jpg';
$file_headers = @get_headers($file);
if($file_headers[0] == 'HTTP/1.1 404 Not Found') {
    $exists = false;
}
else {
    $exists = true;
} 
```

# gdb - gdb 钩子设置中断

> ID：11529197
> 
> 赞同：2
> 
> 时间：2012-07-17T19:08:19.970
> 
> 标签：gdb

使用gdb调试不熟悉的程序时，程序执行后经常会意外退出`next`。发生这种情况时，我通常会设置一个断点，重新运行程序并执行`step`，而不是`next`跟踪正在发生的事情。但是，有时很难知道在哪里设置断点。有没有一种技术可以自动设置休息时间？就像是：

```
define hook-next
break
end

define hookpost-next
# delete the previous break if the program is still running
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-24T17:31:16.647

我认为您可以结合使用 hook-next、便利变量和退出时的断点来实现。就像是：

```
define hook-next
set $saved_pc = $pc
end

break exit
commands
break *$saved_pc
end 
```

您可能更喜欢那里的“tbreak”。

# libcurl - Libcurl：强制 ipv4 或 ipv6

> ID：11529202
> 
> 赞同：9
> 
> 时间：2012-07-17T19:08:34.203
> 
> 标签：libcurl, ipv6

如何强制 libcurl 通过 ipv4 或 ipv6 访问以双栈模式运行的服务器？使用 IP 地址应该不难，但我正在寻找适用于 DNS 的东西......

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-17T19:16:35.160

你打赌。可以设置为或的[配置](http://curl.haxx.se/libcurl/c/curl_easy_setopt.html) 。`CURLOPT_IPRESOLVE``CURL_IPRESOLVE_V4``CURL_IPRESOLVE_V6`

如果您无论如何都可以控制 DNS，一个更强大的解决方案是`A`为 v4 地址创建一个记录，并`AAAA`为 v6 地址创建一个单独的记录。这将使您可以选择要轮询该系统的网络，而不管 DNS 解析如何。但是 CURL 可以做你想做的，就好了。

# mpi - MPI_Isend /Irecv：是否可以同时访问未使用内存位置上的发送缓冲区

> ID：11529205
> 
> 赞同：1
> 
> 时间：2012-07-17T19:08:54.600
> 
> 标签：mpi, memory-access

我想使用异步通信来加速我的 MPI 程序。但使用时间保持不变。工作流程如下。

```
before:
1\.  MPI_send/ MPI_recv Halo           (ca. 10 Seconds) 
2\.  process the whole Array           (ca. 12 Seconds)

after:
1\. MPI_Isend/ MPI_Irecv Halo         (ca. 0,1 Seconds)
2\. process the Array (without Halo)  (ca. 10 Seconds)
3\. MPI_Wait                          (ca. 10 Seconds)  (should be ca. 0 Seconds)
4\. process the Halo only             (ca. 2 Seconds) 
```

测量结果表明，对于常见的工作负载，Array-core 的通信和处理时间几乎相同。所以异步应该几乎隐藏了通信时间。但事实并非如此。

一个事实——我认为这可能是问题所在——是 sendbuffer 也是进行计算的数组。尽管通信仅访问 Halo（使用派生数据类型）并且计算仅访问数组的核心（仅读取），但 MPI 是否有可能序列化内存访问？

有人知道这是否肯定是原因吗？

是否可能依赖于实现（我正在使用 OpenMPI）？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T21:55:56.730

MPI 不会序列化用户代码中的内存访问（通常，这超出了库的能力），并且确实发生的事情是特定于实现的。

但实际上，MPI 库并没有像您希望的那样在“后台”进行尽可能多的通信，尤其是在使用 tcp + ethernet 等传输和网络时，没有有意义的方式将通信传递给另一套硬件。

只有在运行 MPI 库代码时，例如在 MPI 函数调用中，您才能确定 MPI 库确实在做某事。通常，对多个 MPI 调用中的任何一个的调用都会推动实现“进度引擎”，该引擎会跟踪正在进行的消息并引导它们。因此，例如，您可以快速做的一件事是在计算循环内的请求上调用 MPI_Test()，以确保事情在 MPI_Wait() 之前开始发生。这当然有开销，但这是很容易尝试衡量的。

当然，您可以想象 MPI 库会使用其他一些机制在幕后运行。MPICH2 和 OpenMPI 都使用了单独的“进度线程”，这些线程与用户代码分开执行，并在后台引导；但是要让它运行良好，并且在您尝试运行计算时不占用处理器，这是一个真正困难的问题。OpenMPI 的进度线程实现长期以来一直是实验性的，实际上暂时不在当前 (1.6.x) 版本中，尽管工作仍在继续。我不确定 MPICH2 的支持。

如果您使用的是 infiniband，其中网络硬件具有很多智能，那么前景会明亮一些。如果您愿意保留内存固定（对于 openfabrics），和/或您可以使用特定于供应商的模块（对于 Mellanox 的 mxm，对于 Qlogic 的 psm），那么事情会进展得更快一些。如果您使用共享内存，那么[knem 内核模块](http://runtime.bordeaux.inria.fr/knem/)也可以帮助进行节点内传输。

如果内存不是大问题，您可以采取的另一种特定于实现的方法是尝试使用[急切协议](https://computing.llnl.gov/tutorials/mpi_performance/#Protocols)直接发送数据，或者为每个块发送更多数据，从而减少对进度引擎的微调。急切协议在这里的意思是数据在发送时自动发送，而不是仅仅启动一组最终将导致消息发送的握手。坏消息是，这通常需要为库提供额外的缓冲内存，但如果这不是问题并且您知道传入消息的数量是有限的（例如，受您拥有的光环邻居的数量），这将有很大帮助. 如何为（例如）openmpi 的共享内存传输执行此操作[在 OpenMPI 页面上进行了描述，用于调整共享内存](http://www.open-mpi.org/faq/?category=sm#more-sm)，但其他传输也存在类似的参数，并且通常用于其他实现。[IntelMPI](http://software.intel.com/en-us/articles/intel-mpi-library/)拥有的一个不错的工具是“mpitune”工具，它可以自动运行许多此类参数以获得最佳性能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:20:37.007

[MPI 规范](http://www.mpi-forum.org/docs/mpi-2.2/mpi22-report.pdf)规定：

> 非阻塞发送调用表明系统可能开始从发送缓冲区复制数据。在调用非阻塞发送操作后，发送方不应修改发送缓冲区的任何部分，直到发送完成。

所以是的，您应该首先将数据复制到专用的发送缓冲区。

# wordpress - 在 PODS Wordpress 框架中使用 TinyMCE 将图像插入帖子时出错

> ID：11529208
> 
> 赞同：0
> 
> 时间：2012-07-17T19:09:08.477
> 
> 标签：wordpress, tinymce, podscms

我在使用 tinymce 助手在 Wordpress 中安装 PODS 框架时遇到问题。

当我尝试上传新图像（通过使用媒体上传按钮）时，它工作正常，但是当我尝试插入图像以发布时，我收到一个 javascript 错误，提示 QTags 上缺少 insertContent 方法。

我看到 Pods-tinymce 有自己的这个 js 类的版本，我没有看到这个文件中的 insertContent 函数？

任何想法我现在应该检查什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T07:33:47.030

您可以使用`mceInsertContent`execCommand 添加内容：

```
tinyMCE.execCommand('mceInsertContent', false, '<img src="..." href="..."/>'); 
```

# php - 给定大写名称转换为正确大小写，处理“O'Hara”、“McDonald”、“van der Sloot”等

> ID：11529213
> 
> 赞同：5
> 
> 时间：2012-07-17T19:09:57.867
> 
> 标签：php, regex, text, text-processing, text-parsing

我提供了一个大写的名字列表。出于在电子邮件中问候的目的，我希望他们使用正确的大小写。

[使用 PHP 的ucwords](http://php.net/manual/en/function.ucwords.php)很容易做到。但我觉得我需要一些正则表达式函数来处理常见的异常，例如：

> “奥哈拉”、“麦当劳”、“范德斯洛特”等

与其说我需要帮助构建一个正则表达式语句来处理上面的三个示例（那样会很好），不如说我不知道​​所有常见的异常可能是什么。

肯定有人以前遇到过这个问题，任何指向已发布解决方案的指针或您可以分享的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T23:45:25.323

在提供的简短列表中使用正则表达式可能很容易，但如果您必须处理数百或数千条记录，则很难做到防弹。

我宁愿使用不会影响别人的东西。你怎么知道“麦克唐纳”先生是否更喜欢“麦克唐纳”？

你在纠正别人的错误。如果源无法更正，您可以使用以下内容：

```
<?php

$provided_names = array(
  "SMITH",
  "O'HARA",
  "MCDONALD",
  "JONES",
  "VAN DER SLOOT",
  "MACDONALD"
);

$corrected_names = array(
  "O'HARA"        => "O'Hara",
  "MCDONALD"      => "McDonald",
  "VAN DER SLOOT" => "van der Sloot"
);

$email_text = array();

foreach ($provided_names as $provided_name)
{
  $provided_name = !array_key_exists($provided_name, $corrected_names) 
    ? ucwords(strtolower($provided_name)) 
    : $corrected_names[$provided_name];
  $email_text[]  = "{$provided_name}, your message text.";
}

print_r($email_text);

/* output:
Array
(
  [0] => Smith, your message text.
  [1] => O'Hara, your message text.
  [2] => McDonald, your message text.
  [3] => Jones, your message text.
  [4] => van der Sloot, your message text.
  [5] => Macdonald, your message text.
)
*/
?> 
```

我希望它有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-27T00:18:33.560

我今天写这个是为了在我正在开发的应用程序中实现。我认为这段代码很容易用注释来解释。它并非在所有情况下都 100% 准确，但它可以轻松处理您的大多数西方名字。

例子：

`mary-jane => Mary-Jane`

`o'brien => O'Brien`

`Joël VON WINTEREGG => Joël von Winteregg`

`jose de la acosta => Jose de la Acosta`

该代码是可扩展的，因为您可以将任何字符串值添加到顶部的数组中以满足您的需要。请研究它并添加任何可能需要的特殊功能。

```
function name_title_case($str)
{
  // name parts that should be lowercase in most cases
  $ok_to_be_lower = array('av','af','da','dal','de','del','der','di','la','le','van','der','den','vel','von');
  // name parts that should be lower even if at the beginning of a name
  $always_lower   = array('van', 'der');

  // Create an array from the parts of the string passed in
  $parts = explode(" ", mb_strtolower($str));

  foreach ($parts as $part)
  {
    (in_array($part, $ok_to_be_lower)) ? $rules[$part] = 'nocaps' : $rules[$part] = 'caps';
  }

  // Determine the first part in the string
  reset($rules);
  $first_part = key($rules);

  // Loop through and cap-or-dont-cap
  foreach ($rules as $part => $rule)
  {
    if ($rule == 'caps')
    {
      // ucfirst() words and also takes into account apostrophes and hyphens like this:
      // O'brien -> O'Brien || mary-kaye -> Mary-Kaye
      $part = str_replace('- ','-',ucwords(str_replace('-','- ', $part)));
      $c13n[] = str_replace('\' ', '\'', ucwords(str_replace('\'', '\' ', $part)));
    }
    else if ($part == $first_part && !in_array($part, $always_lower))
    {
      // If the first part of the string is ok_to_be_lower, cap it anyway
      $c13n[] = ucfirst($part);
    }
    else
    {
      $c13n[] = $part;
    }
  }

  $titleized = implode(' ', $c13n);

  return trim($titleized);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-03-22T11:09:14.323

我为此写了一个小库：[https://github.com/tamtamchik/namecase](https://github.com/tamtamchik/namecase) 您可以使用[Composer](https://getcomposer.org)安装它。

对于您的输入，它会使用以下代码准确生成您需要的内容：

```
<?php

require_once 'vendor/autoload.php'; // Composer autoload

$arr = ["O'HARA", "MCDONALD", "VAN DER SLOOT"];

foreach ($arr as $name) {
    echo $name . ' => ' . str_name_case($name) . PHP_EOL;
} 
```

调用`str_name_case`任何名称字符串上的库附带的函数，它将转换为正确的大小写。对于您的示例输出将变为：

> O'HARA => O'Hara
> MCDONALD => McDonald
> VAN DER SLOOT => van der Sloot

# coldfusion - recaptcha 不显示在 FF 或 chrome 上，IE 在允许被阻止的内容后显示

> ID：11529214
> 
> 赞同：2
> 
> 时间：2012-07-17T19:09:59.087
> 
> 标签：coldfusion, captcha

托管代码的服务器正在运行 Coldfusion 4.5。有问题的页面是一个框架集，所以我不能直接链接到它。

就是这个页面： http: [//www.palosverdes.com/calendar/](http://www.palosverdes.com/calendar/)，然后是右边“Admin”下的注册链接。

在允许被阻止的内容后，现在那里的代码可以按预期在 IE 上运行。这是代码：

```
<cfscript>
CHALLENGE_URL = "http://api.recaptcha.net";
SSL_CHALLENGE_URL = "https://api-secure.recaptcha.net";
VERIFY_URL = "http://api-verify.recaptcha.net/verify";
</cfscript>

<cfif isDefined("form.recaptcha_challenge_field") and isDefined("form.recaptcha_response_field")>

<cftry>
    <cfhttp url="#VERIFY_URL#" method="post" throwonerror="true">
        <cfhttpparam type="formfield" name="privatekey" value="6LfwVs0SAAAAAIlIJpLDvIay_d5G0RncS0VSrnV0">
        <cfhttpparam type="formfield" name="remoteip" value="#cgi.REMOTE_ADDR#">
        <cfhttpparam type="formfield" name="challenge" value="#form.recaptcha_challenge_field#">
        <cfhttpparam type="formfield" name="response" value="#form.recaptcha_response_field#">
    </cfhttp>
<cfcatch>
    <cfthrow  type="RECAPTCHA_NO_SERVICE"
        message="recaptcha: unable to contact recaptcha verification service on url '#VERIFY_URL#'">
</cfcatch>
</cftry>

<cfset aResponse = listToArray(cfhttp.fileContent, chr(10))>
<cfset form.recaptcha = aResponse[1]>
<cfset structDelete(form, "recaptcha_challenge_field")>
<cfset structDelete(form, "recaptcha_response_field")>

<cfif aResponse[1] eq "false" and aResponse[2] neq "incorrect-captcha-sol">
    <cfthrow type="RECAPTCHA_VERIFICATION_FAILURE"
        message="recaptcha: the verification service responded with error '#aResponse[2]#'. See http://recaptcha.net/apidocs/captcha/ for error meanings.">

</cfif>

<cfelse>

<cfset form.recaptcha = false>

</cfif>

<cfif isdefined("form.recaptcha") and form.recaptcha neq "false">
<cfinclude template="addorgresults.cfm">
<cfelse> 
```

我已经使用此页面[http://www.palosverdes.com/sandbox/captchatest.cfm](http://www.palosverdes.com/sandbox/captchatest.cfm)来确定验证码本身是否正常工作，所以我的猜测是它与将验证码放入框架集中有关。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T20:05:35.470

它在 Firefox 中不起作用的原因：

> api-secure.recaptcha.net 使用了无效的安全证书。
> 
> 该证书仅对 www.google.com 有效
> 
> （错误代码：ssl_error_bad_cert_domain）

您似乎使用两组不同的代码进行测试，一组（有效）和一组无效。

坏掉的那个：

```
<script type="text/javascript"
   src="https://api-secure.recaptcha.net/challenge?k=6LfwVs0SAAAAAClnUJ5XD7O19d9ZdlGBFgAn8Gws">
</script>

<noscript>
   <iframe src="https://api-secure.recaptcha.net/noscript?k=6LfwVs0SAAAAAClnUJ5XD7O19d9ZdlGBFgAn8Gws"
       height="300" width="500" frameborder="0"></iframe><br>
   <textarea name="recaptcha_challenge_field" rows="3" cols="40">
   </textarea>
   <input type="hidden" name="recaptcha_response_field"
       value="manual_challenge">
</noscript> 
```

一个有效的：

```
<script type="text/javascript"
 src="http://www.google.com/recaptcha/api/challenge?k=6LfwVs0SAAAAAClnUJ5XD7O19d9ZdlGBFgAn8Gws">

</script>
<noscript>
 <iframe src="http://www.google.com/recaptcha/api/noscript?k=6LfwVs0SAAAAAClnUJ5XD7O19d9ZdlGBFgAn8Gws"
     height="300" width="500" frameborder="0"></iframe><br>
 <textarea name="recaptcha_challenge_field" rows="3" cols="40">
 </textarea>
 <input type="hidden" name="recaptcha_response_field"
     value="manual_challenge">
</noscript> 
```

我认为您需要将第一个 URL 的 URL 从`api-secure.recaptcha.net`更改为`google.com/recaptcha/api`

# django - Django 多文件字段

> ID：11529216
> 
> 赞同：23
> 
> 时间：2012-07-17T19:10:02.913
> 
> 标签：django, file-upload, django-models

是否有可以为 django 处理多个文件或多个图像的模型字段？还是将 ManyToManyField 制作为包含图像或文件的单独模型更好？

我需要一个在 django-admin 中带有上传界面的解决方案。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2017-07-17T11:06:16.797

对于 2017 年及以后的人，[Django 文档中有一个特殊部分](https://docs.djangoproject.com/en/1.11/topics/http/file-uploads/#uploading-multiple-files)。我的个人解决方案是这样的（在管理员中成功运行）：

```
class ProductImageForm(forms.ModelForm):
    # this will return only first saved image on save()
    image = forms.ImageField(widget=forms.FileInput(attrs={'multiple': True}), required=True)

    class Meta:
        model = ProductImage
        fields = ['image', 'position']

    def save(self, *args, **kwargs):
        # multiple file upload
        # NB: does not respect 'commit' kwarg
        file_list = natsorted(self.files.getlist('{}-image'.format(self.prefix)), key=lambda file: file.name)

        self.instance.image = file_list[0]
        for file in file_list[1:]:
            ProductImage.objects.create(
                product=self.cleaned_data['product'],
                image=file,
                position=self.cleaned_data['position'],
            )

        return super().save(*args, **kwargs) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-17T19:25:26.503

不，没有一个字段知道如何存储 Django 附带的多个图像。上传的文件在模型中存储为文件路径字符串，因此本质上是一个`CharField`知道如何转换为python的文件。

典型的多图像关系构建为一个单独的 Image 模型，其中 FK 指向其相关模型，例如`ProductImage -> Product`.

这种设置使得添加到 django admin 中变得非常容易`Inline`。

如果您确实是从 1 个或多个对象`GalleryImages`引用的多对多关系，则 M2M 字段将是有意义的。`Gallery`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-17T19:37:08.963

我不得不从现有系统中的单个文件更改为多个文件，经过一番研究后最终使用了这个：[https ://github.com/bartTC/django-attachments](https://github.com/bartTC/django-attachments)

如果您想要自定义方法，应该很容易对模型进行子类化。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-08-27T06:35:08.943

**FilerFileField 和 FilerImageField 在一个模型中：**

它们是 django.db.models.ForeignKey 的子类，因此适用相同的规则。唯一的区别是，不需要声明我们引用的模型（对于 FilerFileField 始终是 filer.models.File，对于 FilerImageField 始终是 filer.models.Image）。

**简单示例models.py：**

```
from django.db import models
from filer.fields.image import FilerImageField
from filer.fields.file import FilerFileField

class Company(models.Model):
    name = models.CharField(max_length=255)
    logo = FilerImageField(null=True, blank=True)
    disclaimer = FilerFileField(null=True, blank=True) 
```

**models.py 中同一模型上的多个图像文件字段：**

*注意：related_name 属性是必需的，就像定义外键关系一样。*

```
from django.db import models
from filer.fields.image import FilerImageField

class Book(models.Model):
    title = models.CharField(max_length=255)
    cover = FilerImageField(related_name="book_covers")
    back = FilerImageField(related_name="book_backs") 
```

此答案代码取自[django-filer 文档](http://django-filer.readthedocs.org/en/latest/usage.html#filerfilefield-and-filerimagefield "Django Filer - FilerFileField 和 FilerImageField")

# ruby-on-rails - 哈希中的哈希 ruby on rails

> ID：11529218
> 
> 赞同：0
> 
> 时间：2012-07-17T19:10:06.700
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我通过参数将以下信息从视图传递到控制器

```
parameters:{"Something"=>{"a" => "1", "b" => "0", "c" => "1", "d" => "0" #and so on}} 
```

我想访问所有以“1”为值的字符并连接到字符串中。

我试过

```
Something.each do |key, value|
if(value == "1")
string = string + key
end 
end 
```

它抛出错误，说它无法执行 nil.each 并且我可能期待一个数组。在我看来，Something 是一个散列，而其中又包含一些散列。所以我初始化了一些东西

```
Something = Hash.new { |Something, k| Something[k] = Hash.new } 
```

但我仍然得到同样的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:15:44.797

只需使用`params`哈希即可。这应该做你需要的：

```
params["Something"].select {|k, v| v == "1"}.keys.reduce(:+) 
```

*   `select`将参数过滤为仅具有值的参数`"1"`
*   `keys`返回一个包含哈希中所有键的数组
*   `reduce`使用 concat 操作 (+) 连接所有元素

**编辑**

连接并添加“额外”字：

*   对于每个参数：

    ```
    params["Something"].select {|k, v| v == "1"}.keys.inject("") {|result, p| result += "Extra #{p}"} 
    ```

*   仅针对额外参数，而不针对第一个参数：

    ```
    params["Something"].select {|k, v| v == "1"}.keys.inject {|result, p| result += "Extra #{p}"} 
    ```

`inject` [在此处](http://apidock.com/ruby/Enumerable/inject)查看更多信息。

# c# - 树节点的处置

> ID：11529219
> 
> 赞同：1
> 
> 时间：2012-07-17T19:10:07.790
> 
> 标签：c#, winforms

我派生了一个自定义`TreeNode`类型，`TreeNodeEx`. 在 my`TreeNodeEx`中，我订阅了`NameChanged`分配给它的某个 Value 对象的事件。这个 Value 的生命周期比树节点的生命周期长。

我的想法是，当树节点被删除时，Value 仍然通过事件处理程序委托对树节点进行引用。所以这将保持对树节点的悬空引用。

`TreeNode`is not `IDisposable`，并且没有事件或方法可以覆盖`TreeNode`以知道它何时被删除，因此，我何时应该从事件中解脱。那么，我怎么知道什么时候脱钩呢？

```
class TreeNodeEx : TreeNode {
    private Foo m_value;
    public Foo Value {
        get { return m_value; }
        set {
            if (m_value != null) {
                m_value.NameChanged -= ValueNameChanged;
            }

            m_value = value;

            if (m_value != null) {
                m_value.NameChanged += ValueNameChanged;
            }
        }
    }

    private void ValueNameChanged(object sender, EventArgs e) {
        // ...
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T19:55:07.730

用户无法自行删除节点，因此您在代码中调用的任何位置`treeView1.Nodes.Remove(...)`都是您应该处理处置职责的时间。

# jquery - URL中的ID不隐藏其他div

> ID：11529223
> 
> 赞同：1
> 
> 时间：2012-07-17T19:10:15.080
> 
> 标签：jquery, html

所以我构建了一个脚本，它将根据 url 中的 ID 隐藏 div。这是我到目前为止所拥有的：

```
<script>
$(function(){ 
if (document.location.href.indexOf('#aberdeen') > 0) 
$("#centralia, #chewelah, #everett, #harbour-pointe").hide();

if (document.location.href.indexOf('#centralia') > 0) 
$("#aberdeen, #chewelah, #everett, #harbour-pointe").hide();

if (document.location.href.indexOf('#chewelah') > 0) 
$("#aberdeen, #centralia, #everett, #harbour-pointe").hide();

if (document.location.href.indexOf('#everett') > 0) 
$("#aberdeen, #chewelah, #centralia, #harbour-pointe").hide();

if (document.location.href.indexOf('#harbour-pointe') > 0) 
$("#aberdeen, #chewelah, #everett, #centralia").hide();

if (document.location.href.indexOf('#') < 0)
    $(".directory").show();
});
</script> 
```

但是，即使在 URL 中附加了一个 id，它仍然会显示所有这些。有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-17T19:14:16.530

这称为“哈希”，而不是“ID”。它位于`document.location.hash`，而不是`document.location.href`。

```
if (document.location.hash === '#aberdeen') {
    $("#centralia, #chewelah, #everett, #harbour-pointe").hide();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T19:14:20.590

试试这个，你可以为项目添加一个类并使用`document.location.hash`：

```
$(function(){ 
   var id = document.location.hash;
   $('.all').not(id).hide() // hide them expect the element that has an id of hash
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T19:13:53.810

尝试 ：

```
if (document.location.hash.indexOf('#aberdeen') != -1) {
    $("#centralia, #chewelah, #everett, #harbour-pointe").hide();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T19:25:29.243

作为上面给出的 Javascript 解决方案的替代方案，您可以在 CSS 中执行此操作（仅限现代浏览器）：

如果你给所有的 div 例如一个`hashdisplay`类，你可以有以下样式：

```
.hashdisplay { display: none; }
.hashdisplay:target { display: block; } 
```

[http://jsfiddle.net/9qCYU/](http://jsfiddle.net/9qCYU/)

警告！！仅适用于支持`:target`伪类的浏览器！

[http://reference.sitepoint.com/css/pseudoclass-target](http://reference.sitepoint.com/css/pseudoclass-target)

# zend-framework - Doctrine_Table 与从 BaseClass 扩展的类

> ID：11529224
> 
> 赞同：0
> 
> 时间：2012-07-17T19:10:15.620
> 
> 标签：zend-framework, model, doctrine

我对这个 Doctrine 模型概念有点困惑，假设我们一个名为**“文章”**的表格 Doctrine 将生成名为我正在使用 Zend 框架和 Doctrine 1.2 的类

1.  模型/生成/BaseArticle.php
2.  模型/ArticleTable.php
3.  模型/Article.php

这样在控制器中调用**ArticleTable**是真的吗

```
$tableArticle = Doctrine::getTable('Article'); 
```

然后像这样将它保存在文章对象中

```
 $article = new Article();
 $fArticles = $tableArticle->getFeaturedArticles();
 foreach ($fArticles as $fArticle) {
         $article->fromArray($fArticle);
         echo $article->title
        } 
```

**或者**我必须让 **Article.php**调用 **ArticleTable**？然后在控制器中启动一个**Article.php**对象？

```
class Article extends BaseArticle
{

      public function getFArticles()
      {
           $tableArticle = Doctrine::getTable('Article');
           $obj =  $tableArticle->getFeaturedArticles();
          return $obj;
      } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T07:23:34.200

Article.php 不应该调用 ArticleTable.php，除非真的**非常**需要。在表类中，您将只保存由控制器调用的查询，例如：

```
$featuredArticles = ArticleTable::getInstance()->getFeatured() ; 
```

上面的代码更简单，你可以在任何 IDE 中自动完成。

不在 Article.php 中调用查询的原因是有一天你会更容易过渡到 Doctrine2。

对于表调用 tbl_article 或只是文章，学说将生成 Article.php 和 BaseArticle.php。不得手动更改基类。

文章类是您的逻辑所在。例如，您获取数据库中所有文章的列表。当你显示它们时，你希望专题文章有一个星号（只是一个例子）：

控制器：

```
$allArticles = ArticleTable::getInstance()->findAll() ; 
```

模板（此处为 Smarty 版本）：

```
{foreach $allArticles as $article}

  {if $article->isFeatured()}  <img src=.. some image ..>{/if}

  <h5>{$article->title}

{/foreach} 
```

和模型类

```
class Article extends BaseArticle 
{
    const STATUS_FEATURED = 1 ;

    public function isFeatured()
    {
        return $this->status == self::STATUS_FEATURED ;
    }
} 
```

所有这些只是一些例子，在现实生活中它更有用。

你实际上想用这个 fromArray($fArticle) 做什么？我看不到该代码的任何意义。

# c# - Datagridview需要隐藏Scrollbar，但是应该可以通过代码实现滚动

> ID：11529228
> 
> 赞同：4
> 
> 时间：2012-07-17T19:10:46.900
> 
> 标签：c#, datagridview, scroll

我有 2 个具有相同列数的数据网格

`Datagrid1`仅显示标题， `Datagrid2`就在它下方显示所有数据。本质上，需要同步 2 个网格才能显示为 1 个网格。

我的问题是我需要隐藏 的水平滚动条`datagrid1`，但只显示`datagrid2`. 当用户滚动时`datagrid2`，我需要以编程方式同步上的标题`datagrid1`。

任何人都可以建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-12-24T12:41:11.887

尝试这个..

```
dataGridViews1.ScrollBars = ScrollBars.None;

 private void dataGridViews2_Scroll(object sender, ScrollEventArgs e)
    {
       int offSetValue = dataGridViews1.HorizontalScrollingOffset;

      try 
          { 
            dataGridViews1.HorizontalScrollingOffset = offSetValue; 
          }
      catch { }

           dataGridViews1.Invalidate();
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-17T19:19:18.197

您可以设置 DataGridViews ScrollBasr 属性来隐藏垂直滚动条

例如

```
dataGridViews1.ScrollBars = ScrollBars.None; 
```

[或在链接http://msdn.microsoft.com/en-us/library/system.windows.forms.scrollbars](http://msdn.microsoft.com/en-us/library/system.windows.forms.scrollbars)查看其他枚举值

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-07T12:25:43.297

我和你有同样的概念..我已经按照以下方式解决了它：它可以帮助你。

```
private void dgvHeader_ColumnWidthChanged(object sender, DataGridViewColumnEventArgs e)
    {
        //When Header Grid Width Changes automatically Below Grid's COLUMN width will be changes
        dgvData.Columns[e.Column.Index].Width = e.Column.Width;
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-18T06:53:29.010

您可以设置 VerticalScrollingOffset 值以将滚动条定位在所需的索引处。处理第二个 DGV 中的 Scroll 事件并为第一个 DGv 设置此 VerticalScrollingOffset。这应该会有所帮助。

# php - php目录读取问题

> ID：11529230
> 
> 赞同：0
> 
> 时间：2012-07-17T19:10:50.127
> 
> 标签：php, directory, traversal

我编写了这个简单的脚本，将目录中的所有文件显示为一组按钮。

此代码从上传目录中读取并显示表单中提交按钮内的所有文件。

```
$handle = opendir("upload");
echo '<form name="form" method="post" action="download.php">';
while($name = readdir($handle)) {
  echo '<input type="submit" name="file" value='.$name.' />';
}
echo '</form>'; 
```

现在这里的问题是；每次我运行脚本时，我都会在开头找到两个按钮，其中包含内容`.`和`..`

我一直无法弄清楚导致此问题的原因。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T19:13:11.977

您遇到的是文件系统使用的两个特殊文件。

*   `.`代表你所在的当前目录^(。1)

*   `..`表示当前目录的父目录。²

^(**脚注：**)^(^(1.)) ^(路径如)^(*"/my_dir/././././././file"*)^(等价于)^(*"/my_dir/file"*)^。^(^(2.))^(诸如)^(*“/my_dir/../my_dir/../my_dir/file”*)^(之类的路径等价于)^(*“/my_dir/file”*)^(，因为)^(它将使您“向上”移动一级。)
^(    **^(    ^(**`..`**))**)

 **** * *

要解决向用户显示这两个的问题，请使用以下内容过滤返回的内容`readdir`：

```
while  ($name = readdir ($handle)) {
  if ($name == '.' || $name == '..')
    continue; /* don't echo anything, skip to next read */

   echo '<input type="submit" name="file" value='.$name.' />';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:14:59.270

目录列表包括 . 对于当前目录和 .. 对于父目录。

我通常使用从 PHP 手册 (http://php.net/manual/en/function.readdir.php) 获得的这个

```
if ($handle = opendir('.')) {
    while (false !== ($entry = readdir($handle))) {
        if ($entry != "." && $entry != "..") {
            echo "$entry\n";
        }
    }
    closedir($handle);
} 
```

所以你需要做的是排除 . 和..来自输出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T19:16:02.780

另一种解决方案是使用这样的 FilesystemIterator：

```
foreach(new FilesystemIterator('upload') as $file){
    echo $file;
} 
```

它会自动跳过。和 .. 文件系统中的条目。***

# iphone - 使用 CSS 禁用 iOS 设备的链接

> ID：11529233
> 
> 赞同：3
> 
> 时间：2012-07-17T19:11:05.247
> 
> 标签：iphone, css, ios, touch

我有一个图片库，图片足够大，可以填满 iPhone 屏幕。

图像也是链接，因此您可以想象，在 iPhone 上滚动变得非常令人沮丧，因为您经常不小心点击链接。

有没有办法单独使用css来防止这种情况？

如果不是，那么解决这个问题最简单的方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:28:46.907

我建议使用Javascript。但是，我找到了一种只使用 CSS 的方法。第一步，您需要识别客户端浏览器，只需在 HTML 文件中的 HEAD 会话中添加以下代码：

```
<link rel="stylesheet" media="only screen and (max-device-width: 480px)" href="../iphone.css" type="text/css" /> 
```

只有当客户端在 iphone 中使用浏览器时，才会加载“iphone.css”的内容。

在此文件“iphone.css”中，您需要创建一个类来禁用链接：

```
.disableLink {
   pointer-events: none;
   cursor: default;
} 
```

在您的画廊 HTML 代码中，在您的链接中添加参考：

```
<a href="link.html" class="disableLink"> IMAGE </a> 
```

这些步骤仅适用于 iPhone/iPod touch，但如果您查看我的第二个参考资料，您将看到适应 iPhone 4/iPod touch 4G 的方法：

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:18:26.043

我不认为有基于 CSS 的解决方案（CSS 并不是真正旨在改变 HTML 元素的行为）。

您可以在页面加载时使用 JavaScript 检查浏览器视口的宽度，然后在视口为手机大小时查找并禁用/删除链接。

请参阅[PPK 的“A Tale of Two Viewports”文章](http://www.quirksmode.org/mobile/viewports2.html)，了解在您的情况下要检查哪些 JavaScript 属性来确定宽度（我还没有做足够的移动开发来记住我的头脑）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T20:01:55.307

我喜欢 的想法`pointer-events: none;`，但我不会使用它，因为[它没有得到很好的支持](http://caniuse.com/#feat=pointer-events)。

如果我们将移动设备定义为只有特定的屏幕尺寸，我会这样做：

```
$(function () {
    var mobile = ($(window).width() < 481);
    $('#image-gallery').find('a').click(function (e) {
        if (mobile)
            e.preventDefault();
    });
}); 
```

但是，我会尝试将“移动”定义为其他东西，*例如*，支持触摸事件的浏览器。

# hibernate - 休眠。实体更改\修订历史

> ID：11529237
> 
> 赞同：2
> 
> 时间：2012-07-17T19:11:15.083
> 
> 标签：hibernate, audit-logging

框架：带有 Hibernate 3 的 Spring 3。

数据库：甲骨文 11

要求：我们的应用程序将具有事件对象。这些 Event 对象中的每一个都是一组 Entity 属性（表列）的封装。因此，无论何时在我们的系统中更新任何实体时，我们都需要确保对实体所做的更改是否属于任何事件对象，如果是，我们需要将此信息与记录的副本一起存储在数据库中实际变化。

解决方案（据我所知）：

1.  使用像 Hibernate Envers 这样成熟的审计框架，并围绕审计表查询功能编写一个小包装器，以完成我需要的。一个问题是，hibernate Envers 是否有一种简单的方法来提供两个版本之间的变化。

2.  使用自定义注释将属性标记为属于事件并使用 AOP 监视对这些属性的更改作为保存操作的一部分并调用自定义写入操作。

我更喜欢第二个想法。

请就完成此任务的最佳方法分享您的意见\想法。是否有针对此类问题的现有解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T08:57:48.137

我在项目中有类似的要求，我想在保存之前拍摄复杂对象图的快照。

我应用的解决方案是 1) 开发了具有某些属性的自定义注释 @Archivable，如 nullify、ignore、orignal、setArchiveFlag

2) 编写了 hiberante 深度克隆实用程序，它创建对象的副本并插入到同一个表中。深度克隆器适用于简单的技巧 searlize 然后反序列化对象，这将创建新实例，然后将 id 和 version 设置为 null。

3）在实体拦截器中使用克隆器实用程序来决定天气是否存档。

下面是其中的一些代码。

```
@Retention(RetentionPolicy.RUNTIME)
@Target( { ElementType.TYPE })
public @interface Archivable {

    /** This will mark property as null in clone */
    public String[] nullify() default {};

    /**
     * If property is archivable but not from enclosing entity then specify as
     * ignore.
     */
    public String[] ignore() default {};

    /**
     * sets original reference to clone for back refer data. This annotation is
     * applicable to only root entity from where archiving started.
     * 
     * @return
     */
    public String original() default "";

    /**
     * if marks cloned entity to archived, assumes flag to be "isArchived". 
     * @return
     */
    public boolean setArchiveFlag() default false;
}

@Component
public class ClonerUtils {

    private static final String IS_ARCHIVED = "isArchived";
    @Autowired
    private SessionFactory sessionFactory;

    public Object copyAndSave(Serializable obj) throws Exception {
        List<BaseEntity> entities = new ArrayList<BaseEntity>();
        Object clone=this.copy(obj,entities);
        this.save(clone, entities);
        return clone;
    }

    public Object copy(Serializable obj,List<BaseEntity> entities) throws Exception{
        recursiveInitliaze(obj);
        Object clone = SerializationHelper.clone(obj);
        prepareHibernateObject(clone, entities);
        if(!getOriginal(obj).equals("")){
            PropertyUtils.setSimpleProperty(clone, getOriginal(obj), obj);
        }
        return clone;
    }

    private void save(Object obj,List<BaseEntity> entities){
        for (BaseEntity baseEntity : entities) {
            sessionFactory.getCurrentSession().save(baseEntity);
        }
    }

    @SuppressWarnings("unchecked")
    public void recursiveInitliaze(Object obj) throws Exception {
        if (!isArchivable(obj)) {
            return;
        }
        if(!Hibernate.isInitialized(obj))
            Hibernate.initialize(obj);
        PropertyDescriptor[] properties = PropertyUtils.getPropertyDescriptors(obj);
        for (PropertyDescriptor propertyDescriptor : properties) {
            Object origProp = PropertyUtils.getProperty(obj, propertyDescriptor.getName());
            if (origProp != null && isArchivable(origProp) && !isIgnore(propertyDescriptor, obj)) {
                this.recursiveInitliaze(origProp);
            }
            if (origProp instanceof Collection && origProp != null) {               
                for (Object item : (Collection) origProp) {
                    this.recursiveInitliaze(item);
                }
            }
        }
    }

    @SuppressWarnings("unchecked")
    private void prepareHibernateObject(Object obj, List entities) throws Exception {
        if (!isArchivable(obj)) {
            return;
        }
        if (obj instanceof BaseEntity) {
            ((BaseEntity) obj).setId(null);
            ((BaseEntity) obj).setVersion(null);
            if(hasArchiveFlag(obj)){
                PropertyUtils.setSimpleProperty(obj, IS_ARCHIVED, true);
            }
            entities.add(obj);
        }
        String[] nullifyList = getNullifyList(obj);
        for (String prop : nullifyList) {
            PropertyUtils.setProperty(obj, prop, null);
        }
        PropertyDescriptor[] properties = PropertyUtils.getPropertyDescriptors(obj);
        for (PropertyDescriptor propertyDescriptor : properties) {
            if (isIgnore(propertyDescriptor, obj)) {
                continue;
            }
            Object origProp = PropertyUtils.getProperty(obj, propertyDescriptor.getName());         
            if (origProp != null && isArchivable(origProp)) {
                this.prepareHibernateObject(origProp, entities);
            }   
            /**  This code is for element collection */
            if(origProp instanceof PersistentBag){
                Collection elemColl=createNewCollection(origProp);
                PersistentBag pColl=(PersistentBag) origProp;
                elemColl.addAll(pColl.subList(0, pColl.size()));
                PropertyUtils.setSimpleProperty(obj, propertyDescriptor.getName(), elemColl);
                continue;
            }
            if (origProp instanceof Collection && origProp != null) {
                Collection newCollection  = createNewCollection(origProp);
                PropertyUtils.setSimpleProperty(obj, propertyDescriptor.getName(), newCollection);
                for (Object item : (Collection) origProp) {
                    this.prepareHibernateObject(item, entities);
                }
            }
        }
    }

    @SuppressWarnings("unchecked")
    private Collection createNewCollection(Object origProp) {
        try {
            if(List.class.isAssignableFrom(origProp.getClass()))
                return new ArrayList((Collection)origProp);
            else if(Set.class.isAssignableFrom(origProp.getClass()))
                    return new HashSet((Collection)origProp);
            else{
                Collection tempColl=(Collection) BeanUtils.cloneBean(origProp);
                tempColl.clear();
                return tempColl;
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
        return new ArrayList();     
    }

    private boolean isIgnore(PropertyDescriptor propertyDescriptor,Object obj){
        String propertyName=propertyDescriptor.getName();
        String[] ignores=getIgnoreValue(obj);
        return ArrayUtils.contains(ignores, propertyName);
    }

    private String[] getIgnoreValue(Object obj) {
        String[] ignore=obj.getClass().getAnnotation(Archivable.class).ignore();
        return ignore==null?new String[]{}:ignore;
    }

    private String[] getNullifyList(Object obj) {
        String[] nullify=obj.getClass().getAnnotation(Archivable.class).nullify();
        return nullify==null?new String[]{}:nullify;
    }

    public boolean isArchivable(Object obj) {
        return obj.getClass().isAnnotationPresent(Archivable.class);
    }

    private String getOriginal(Object obj) {
        String original=obj.getClass().getAnnotation(Archivable.class).original();
        return original==null?"":original;
    }

    private boolean hasArchiveFlag(Object obj) {        
        return obj.getClass().getAnnotation(Archivable.class).setArchiveFlag();
    }

    @SuppressWarnings({ "unchecked", "unused" })
    private Collection getElemColl(Object obj, Object origProp) {
        Collection elemColl=createNewCollection(origProp);
        for (Object object : (Collection)origProp) {
            elemColl.add(object);
        }
        return elemColl;
    }

    @SuppressWarnings("unused")
    private boolean isElementCollection(Object obj, String name) {
        try {
            Annotation[] annotations=obj.getClass().getDeclaredField(name).getAnnotations();
            for (Annotation annotation : annotations) {
                if(annotation.annotationType() == ElementCollection.class)
                    return true;
            }
        } catch (Exception e) {
            e.printStackTrace();            
        }
        return false;
    }
    } 
```

# tfs - 数据库中的 TFS 全局列表

> ID：11529240
> 
> 赞同：1
> 
> 时间：2012-07-17T19:11:26.860
> 
> 标签：tfs

我有 TFS2010，我想知道在哪里可以找到 TFS 数据库中的全局列表值。我正在尝试找到正确的表名和包含这些值的数据库。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T15:50:20.067

我们不支持使用操作数据存储，而是使用我们提供给您的 API。要开始使用全局列表 API，请参阅[http://blogs.microsoft.co.il/blogs/shair/archive/2010/03/08/tfs-api-part-23-create-global-list-xml-way .aspx](http://blogs.microsoft.co.il/blogs/shair/archive/2010/03/08/tfs-api-part-23-create-global-list-xml-way.aspx)

# c# - 应用程序关闭时将信息存储到文件的正确方法

> ID：11529241
> 
> 赞同：6
> 
> 时间：2012-07-17T19:11:27.790
> 
> 标签：c#

我的一个班级在应用程序执行期间收集统计信息，我想在应用程序完成时将此统计信息存储到磁盘。我从来没有在我的程序中销毁这个类，所以我试图将日志存储到这样的文件中：

```
 ~Strategy()
    {
        foreach(var item in statisticItems)
        {
            log.WriteLine(item.Text);    // log is AutoFlush
        }
    } 
```

但是，我没有看到我希望看到的日志，也无法在调用析构函数的调试器时刻“捕捉”。

问题：

*   为什么在调试器中我无法捕捉到调用析构函数的时刻？程序完成时不是必须为每个对象调用析构函数吗？
*   我应该用什么来记录我的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:38:06.127

析构函数（或终结器）不是放置这样的代码的地方。它旨在释放非托管资源。析构函数被称为非确定性的，因此您不能依赖任何在析构函数中有效的对象。而且您无法在调试器中捕获它，因为它是在非常特殊的情况下在单独的线程上调用的。简而言之，不要使用析构函数，除非你知道你需要。

记录应用程序关闭的理想方法是将记录代码简单地放在方法的末尾`Main`。您应该确保捕获并记录任何抛出的异常，如果是这种情况，您可以在`Main`.

由于堆栈溢出等错误，将有一些边缘情况您将无法记录关闭。在这些情况下，您将需要依赖错误发生之前发生的事情的日志。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-17T19:24:03.677

不要依赖析构函数。我建议使用这样的东西：

```
[STAThread]
static void Main()
{
    using(new Strategy())
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        Application.Run(new Form1());
    }
}

public class Strategy : IDisposable
{
    public void Dispose()
    {
        WriteLogs()
    }
    ...
} 
```

这样您就可以确定您的日志将被写入。

静态 void Main 是从创建 Windows 窗体应用程序时创建的默认 program.cs 复制的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-17T19:32:48.170

这**不是一个完整的答案**（还），但请查看：

> 程序员无法控制何时调用析构函数，因为这是由垃圾收集器决定的。垃圾收集器检查应用程序不再使用的对象。如果它认为一个对象符合销毁条件，它会调用析构函数（如果有）并回收用于存储该对象的内存。程序退出时也会调用析构函数。

资料来源：[MSDN](http://msdn.microsoft.com/en-us/library/66x5fx1b.aspx)

如果它是一个控制台应用程序，你能试着打电话`Environment.Exit(0);`看看会发生什么吗？

让我们保持更新这个答案，因为这是一个有趣的问题。任何人都可以随意编辑。

问候

# c# - C# 安全令牌错误 3242

> ID：11529243
> 
> 赞同：2
> 
> 时间：2012-07-17T19:11:40.053
> 
> 标签：c#, active-directory, adfs2.0

我有一个程序，其中用户群保存在 Active Directory 中。它使用 ADFS 作为 AD 和我的程序的中间人。一旦有人尝试登录，我就会使用 C# 安全令牌从 ADFS 获取有效令牌。

如果登录尝试因任何原因失败，我会收到错误 3242。

{"ID3242: 无法对安全令牌进行身份验证或授权。"}

当我输入错误的用户名、错误的密码或 Active Directory 中的密码已过期时，就会发生这种情况。

如果用户无法登录，我希望能够向他们提供更好的错误消息，说明他们为什么无法登录。最好告诉他们他们的密码已过期（如果已过期），并可能提供有关如何重置密码等的说明。

所以我对你们所有人的问题是：在使用 C# SecurityToken 对象时，如何在登录失败时为用户提供更好的错误消息？

我对这些概念很陌生，所以我提前为粗略的细节道歉。这篇文章是我的试探，看看是否有人能指出我一个好的方向。提前感谢您的时间和回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:23:47.127

您不能让错误消息行为本身有任何不同。但是，如果用户存在、帐户是否已禁用以及帐户已过期，您可以捕获异常并查询 AD 来确定，然后将原始异常包装在一个新异常中，该异常提供额外的详细信息并抛出该异常。但是，提供有关是否是错误的用户名或密码等信息通常也不是一个好主意，因为攻击者可以使用它来获取有关您的系统的有用信息。正是由于这个原因，错误消息首先不会返回此类信息。当用户报告问题时，管理员可以随时检查帐户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T00:50:29.790

您的问题询问“过期密码”，而您的评论涉及“过期帐户”。他们是非常不同的野兽！

密码过期 - [ms-DS-User-Account-Control-Computed 属性](http://msdn.microsoft.com/en-us/library/windows/desktop/ms677840%28v=vs.85%29.aspx)

过期账号：

```
principalContext = GetPrincipalContext(ldapOU);
userPrincipal = new UserPrincipal(principalContext);
DateTime date = userPrincipal.AccountExpirationDate; 
```

会给你日期，然后简单地比较。

# android - 在 HTML5 中，如何保持 Android 设备的屏幕处于开启状态？

> ID：11529247
> 
> 赞同：17
> 
> 时间：2012-07-17T19:11:47.587
> 
> 标签：android, html

我们正在使用 jQuery 开发一个 HTML5 应用程序。

有没有一种方法/方法，在 JavaScript 或其他技术中，保持屏幕“打开”？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2015-04-22T11:26:22.183

我认为还有另一种方法可以在没有任何 java 代码的情况下做到这一点。您可以添加 1 秒的无限重复和隐藏视频，它会成功。我在某个地方读过它，但我不记得在哪里。

也许您可以使用以下空白视频之一：

1.  [https://github.com/esc0rtd3w/blank-intro-videos](https://github.com/esc0rtd3w/blank-intro-videos)
2.  [https://github.com/kud/blank-video](https://github.com/kud/blank-video)

**有用！**

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-09-22T11:21:10.113

谷歌的[WebVR polyfill 可以](https://github.com/googlevr/webvr-polyfill)在Chrome[上做到这一点。](https://github.com/googlevr/webvr-polyfill/blob/master/src/wakelock.js)它基本上创建了一个小视频（带有数据 URL，因此不需要额外的下载）并循环播放。

这似乎是一个 hack，所以如果它在未来不可靠，我不会感到惊讶。

他们的代码也可以通过触发位置更新在 iOS 上实现相同的功能。

这是Android的相关代码：

```
var Util={};
Util.base64 = function(mimeType, base64) {
  return 'data:' + mimeType + ';base64,' + base64;
};

var video = document.createElement('video');
  video.setAttribute('loop', '');

  function addSourceToVideo(element, type, dataURI) {
    var source = document.createElement('source');
    source.src = dataURI;
    source.type = 'video/' + type;
    element.appendChild(source);
  }

  addSourceToVideo(video,'webm', Util.base64('video/webm', 'GkXfo0AgQoaBAUL3gQFC8oEEQvOBCEKCQAR3ZWJtQoeBAkKFgQIYU4BnQI0VSalmQCgq17FAAw9CQE2AQAZ3aGFtbXlXQUAGd2hhbW15RIlACECPQAAAAAAAFlSua0AxrkAu14EBY8WBAZyBACK1nEADdW5khkAFVl9WUDglhohAA1ZQOIOBAeBABrCBCLqBCB9DtnVAIueBAKNAHIEAAIAwAQCdASoIAAgAAUAmJaQAA3AA/vz0AAA='));
  addSourceToVideo(video, 'mp4', Util.base64('video/mp4', 'AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAAG21kYXQAAAGzABAHAAABthADAowdbb9/AAAC6W1vb3YAAABsbXZoZAAAAAB8JbCAfCWwgAAAA+gAAAAAAAEAAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIVdHJhawAAAFx0a2hkAAAAD3wlsIB8JbCAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAIAAAACAAAAAABsW1kaWEAAAAgbWRoZAAAAAB8JbCAfCWwgAAAA+gAAAAAVcQAAAAAAC1oZGxyAAAAAAAAAAB2aWRlAAAAAAAAAAAAAAAAVmlkZW9IYW5kbGVyAAAAAVxtaW5mAAAAFHZtaGQAAAABAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAAEcc3RibAAAALhzdHNkAAAAAAAAAAEAAACobXA0dgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAIAAgASAAAAEgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABj//wAAAFJlc2RzAAAAAANEAAEABDwgEQAAAAADDUAAAAAABS0AAAGwAQAAAbWJEwAAAQAAAAEgAMSNiB9FAEQBFGMAAAGyTGF2YzUyLjg3LjQGAQIAAAAYc3R0cwAAAAAAAAABAAAAAQAAAAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAEAAAABAAAAFHN0c3oAAAAAAAAAEwAAAAEAAAAUc3RjbwAAAAAAAAABAAAALAAAAGB1ZHRhAAAAWG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAK2lsc3QAAAAjqXRvbwAAABtkYXRhAAAAAQAAAABMYXZmNTIuNzguMw=='));

video.play();
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2021-03-16T09:13:22.623

未来的答案 - 因为它现在是实验性的 - 是使用名为：[Screen Wake Lock API 的新 API](https://developer.mozilla.org/en-US/docs/Web/API/Screen_Wake_Lock_API)

我认为您可以将其与以前的解决方法答案混合使用

```
// Create a reference for the Wake Lock.
let wakeLock = null;

// create an async function to request a wake lock
try {
  wakeLock = await navigator.wakeLock.request('screen');
  statusElem.textContent = 'Wake Lock is active!';
} catch (err) {
  // try other solutions here ...
}
```

[您可以在此处](https://caniuse.com/wake-lock)关注此功能的支持

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-17T20:11:55.343

如果不编写至少一点 Java 代码，就没有办法只编写 JavaScript 或其他 Web 代码来保持屏幕开启。

为了解释为什么我如此确定，如果您通过 html5 开发 Web 应用程序，您必须使用 WebView 作为应用程序的主“屏幕”来托管您的 html、javascript 代码。因此，您的“网络代码”不会直接在应用程序中运行，而是使用视图作为其持有者。正如您可以猜到的，您不能只锁定一些甚至没有在本机部分运行的代码的屏幕。

如果您不是 android 编程专家，我可以提供一种非常简单的方法来保持屏幕打开。在第一个活动中，我猜它使用了 WebView，在`onCreate`之后添加`super`：

`getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-12-13T23:13:20.720

最简单的方法是转到设置，开发人员选项，然后选择“充电时保持清醒”。无需编写任何代码！

这假设OP希望在*连接外部电源时*保持屏幕亮起，这是合理的，否则没有聪明的编码可以防止内部电池耗尽时屏幕很快熄灭。

外部电源可以像便携式 USB 电池一样简单。当它最终变空时，设备将像往常一样进入睡眠状态，但将在其内部电池上保持功能。

我在这里找到了这个解决方案： [发布关于保持屏幕开启的信息](http://www.greenbot.com/article/2463970/how-to-keep-your-android-phones-screen-on-longer.html "这里")

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-01-02T13:54:52.597

保持设备开机不依赖于操作系统，而是依赖于浏览器。Chrome 正在实施 Wake Lock API，但仍处于试验阶段。

在完全可用之前，有一种方法可以通过在后台播放 base64 视频来模拟 api。这会锁定所有浏览器的睡眠模式。

你可以在这里找到一个 webcomponent 实现[https://github.com/madeInLagny/mil-no-sleep](https://github.com/madeInLagny/mil-no-sleep)

# svn - svn mkdir 与 svn 中的 mkdir

> ID：11529248
> 
> 赞同：1
> 
> 时间：2012-07-17T19:11:51.730
> 
> 标签：svn

我已经运行了一个命令`svn mkdir file:///home/abc/workspace/svn/proj/trunk`，问题是运行命令时无法导航主干目录`cd`。但是，当我运行时`svn checkout file:///home/abc/workspace/svn/`，它会给出以下内容：

```
A    svn/proj
A    svn/proj/trunk
Checked out revision 
```

我怎么理解这个，它`svn mkdir`与 UNIX`mkdir`命令不同吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T19:21:33.080

他们有区别。

运行会在**存储库**`svn mkdir`中的项目中创建目录。当您签出项目时，将新目录放入您的工作副本中。**`svn`**

 **如果您`mkdir`单独运行，则需要将新目录提交到存储库。

供参考：[http ://svnbook.red-bean.com/en/1.7/svn.ref.svn.c.mkdir.html](http://svnbook.red-bean.com/en/1.7/svn.ref.svn.c.mkdir.html)**

# actionscript-3 - 使用 GetDefinitionByName 时引用错误 #1065（应用程序域）

> ID：11529255
> 
> 赞同：0
> 
> 时间：2012-07-17T19:12:30.223
> 
> 标签：actionscript-3, dns

我有一个使用以下代码的 .swf 文件：

```
private function onClick(e:MouseEvent):void {
var popUpClass:Class = getDefinitionByName(e.currentTarget.popUp) as Class;
popUpContent = new popUpClass();
} 
```

但是，当我将该 swf 加载到另一个“容器”swf 中时，我收到了参考错误 #1065。我一直在阅读有关堆栈溢出的几篇文章（例如，[this one](https://stackoverflow.com/questions/10480997/as3-getdefinitionbyname-error-1065-variable-class-name-is-not-defined)和[this one](https://stackoverflow.com/questions/1752549/preloader-in-actionscript-3-reference-error-on-getdefinition)），但我仍然对该怎么做感到困惑。

例如，我是否要更改“已加载 swf”中的代码以引用它自己的应用程序域（不是容器 swf 的域？），如果是，我该怎么做？

或者我是否加载 swf 文件并在容器的代码中为其分配自己的应用程序域？（不是加载的 swf 的代码？）

另外，我的“e.currentTarget.popUp”只有一个短名称“PopUpWhateverName”，我应该给它一个完整的包名，比如“com.MyLoadedSwf.Assets.PopUpWhateverName”吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:50:22.380

是的，完整的包名：getDefinitionByName("com.MyLoadedSwf.Assets.PopUpWhateverName")

但您也可以尝试：

```
var popUpClass:Class = e.currentTarget.popUp.constructor;
popUpContent = new popUpClass(); 
```

# sql - 为什么这个 SELECT 语句没有 FROM？

> ID：11529256
> 
> 赞同：4
> 
> 时间：2012-07-17T19:12:33.953
> 
> 标签：sql, tsql, coldfusion

```
<CFIF ListLen(SESSION.WHSurveyStruct.reasonString, ";") gt 0>
    <CFQUERY name="insertReasons" datasource="#REQUEST.dsn#">
        INSERT INTO TWelcomeHome_Reason
        (ReasonID, SubReasonID, SurveyID)
        SELECT #sanitize(ListFirst(SESSION.WHSurveyStruct.reasonString, ";"))#, #sanitize(getLatestSurveyID.SurveyID)# 
        <CFLOOP list="#sanitize(ListRest(SESSION.WHSurveyStruct.reasonString, ';'))#" index="thisReason" delimiters=";">
            UNION ALL
            SELECT #sanitize(thisReason)#, #sanitize(getLatestSurveyID.SurveyID)#
        </CFLOOP>

    </CFQUERY> 
```

我试图理解这是做什么的。我对循环感到困惑，为什么 select 语句没有`FROM`? 好的，它们只是标量。

如何在循环外部有一个 select 语句，而在内部有一个 select 语句呢？我有点不明白这一点`union all`。为什么指定了 3 列（ReasonID、SubReasonID、SurveyID），但每列`select`都给出了 2 个值？

倾倒：

> 结构
> 
> 缓存：错误执行时间：0 记录计数：8 SQL：插入到 TWelcomeHome_Reason（ReasonID、SubReasonID、SurveyID）选择 6、18、245 UNION ALL SELECT 6、21、245
> UNION ALL SELECT 6、24、245 UNION ALL SELECT 3、5、 245 联合全部 选择 3、6、245 联合全部 选择 3、8、245 联合全部 选择 3、11、245 联合全部 选择 3、7、245
> 
> * * *

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-17T19:18:08.570

看起来它只是`SELECT`标量值，而不是任何表中的记录。所以

```
INSERT INTO myTable
SELECT 'foo'
UNION ALL
SELECT 'bar' 
```

将在 myTable 中插入两条记录，`foo`并且`bar`.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-17T19:18:34.207

简短的回答是它不是从表格中选择的。所以没有桌子可供选择`FROM`。

如果你执行：

```
INSERT INTO TableSomething (ColumnA)
SELECT 'A'
UNION ALL
SELECT 'B' 
```

它将A和B插入ColumnA。

ColdFusion 正在创建要插入的数据，而不是从表中提取数据。

# extjs - ExtJS Ext.data.JsonStore loadData

> ID：11529260
> 
> 赞同：2
> 
> 时间：2012-07-17T19:12:55.620
> 
> 标签：extjs, jsonstore, loaddata

作为 Ext.data.JsonStore 的一部分，你能帮我解决我在 loadData 函数中遇到的问题吗？我创建了一个我遇到的问题的基本示例：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <title>Ext JSON example</title>
     <script type="text/javascript" src="lib/ext-base.js"></script>
    <script type="text/javascript" src="lib/ext-all.js"></script>
<script>
    function example() {
        var exampleData = "{'exampleJSON' : {'exampleArray':[{'exampleID':1,'name':'Fred','description':'a guy'},{'exampleID':2,'name':'sue','description':'a girl'}]}}";

        var exampleStore = new Ext.data.JsonStore({
            data: new Ext.data.MemoryProxy(exampleData),
            autoLoad: false,
            root: 'exampleJSON.exampleArray',
    fields: [
          {mapping: "exampleID", name: 'exampleID'},
          {mapping: "name", name: 'name'},
          {mapping: "description", name: 'description'}
    ],
            listener: {
                 load: function (oStore, ayRecords, oOptions ) 
         {
            alert('loaded successfully');
         }
            }
        });

        exampleStore.loadData(exampleData);  
    }

</script>
</head>
<body>
<center><button onclick="example();">Click for Example</button></center>
</body>
</html> 
```

我遇到的问题是我收到了 Firebug 报告的这个错误： **obj.exampleJSON 未定义** 这可能是我将根设置为“exampleJSON.exampleArray”时引起的。有人可以帮助指出我做错了什么吗？

（使用 ExtJs 4.1.0）

多谢你们。

编辑：要设置它，请将 ext-all.js 和 ext-base.js 放在 lib 文件夹中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T21:37:01.600

您的代码在很多地方都有错误：

```
Ext.define('MyModel', {
    extend: 'Ext.data.Model',
    fields: ['exampleID', 'name', 'description']
});

function example() {
    var exampleData = [{
        exampleID: 1,
        name: 'Fred',
        description: 'a guy'
    }, {
        exampleID: 2,
        name: 'sue',
        description: 'a girl'
    }];

    var exampleStore = new Ext.data.Store({
        model: 'MyModel',
        data: exampleData
    });
} 
```

此外，Ext 4 没有 ext-base 文件，所以它是一个多余的包含。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T23:34:36.513

感谢您的回复，它们有助于让我走上正确的道路。通过删除“数据”字段，我能够使我的原始示例正常工作。我猜当我尝试调用 loadData 时它会引起冲突。下面列出的解决方案

```
 function example() {
        var exampleData = {'exampleJSON' : {'exampleArray':[{'exampleID':1,'name':'Fred','description':'a guy'},{'exampleID':2,'name':'sue','description':'a girl'}]}};

        var exampleStore = new Ext.data.JsonStore({
            autoLoad: false,
            root: "exampleJSON.exampleArray",
    fields: [
          {mapping: "exampleID", name:"exampleID"},
          {mapping: "name", name:"name"},
          {mapping: "description", name:"description"}
    ],
            listeners: {
                 load: function (oStore, ayRecords, oOptions ) 
         {
             alert('loaded successfully: ' + ayRecords.length);
         }
            }
        });

        exampleStore.loadData(exampleData);  
    } 
```

# ruby-on-rails - Rails：确定对象源自哪个模型

> ID：11529267
> 
> 赞同：0
> 
> 时间：2012-07-17T19:13:12.163
> 
> 标签：ruby-on-rails

我有一个包含来自两个模型的对象的数组：

```
 @search_results = User.find(:all, :conditions => ['name LIKE ?', "%#{params[:query]}%"])
  @search_results += Book.find(:all, :conditions => ['title LIKE ?', "%#{params[:query]}%"]) 
```

然后我尝试像这样解析它们：

```
<% @search_results.each do |result| %>
  <% if result.title %>
    <%= link_to result.title, result %>
  <% else %>
    <%= link_to result.name, result %>
  <% end %>
<% end %> 
```

我曾希望 if 语句会解析来自用户（没有）的书籍（有标题）。不幸的是，if 语句本身会抛出错误“Undefined method `title' for #”。我还能做些什么来确定对象所属的模型？

PS。我想将两个模型保留在同一个数组中，以便可以通过共享属性 page_views 对结果进行排名。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T19:22:56.923

你要

```
result.class.name 
```

参考：[如何获取 Ruby 类的名称？](https://stackoverflow.com/questions/826210/how-do-i-get-the-name-of-a-ruby-class)

# ruby-on-rails - Jruby-Rack - 找不到 Rails 引擎根路径

> ID：11529268
> 
> 赞同：3
> 
> 时间：2012-07-17T19:13:17.883
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rubygems, rack, rails-engines

这是我在部署 Ruby on Rails Web 应用程序（使用 Jetty）时遇到的错误：

```
2012-07-17 13:11:25,595,INFO,service.nav.server - An exception happened during JRuby-Rack startup
Could not find root path for #<Usermanagement::Engine:0x302abefe>

--- Backtrace
RuntimeError: Could not find root path for #<Usermanagement::Engine:0x302abefe>
find_root_with_flag at file:/tmp/Jetty_0_0_0_0_2525_ui.0.0.1.SNAPSHOT.war____d9z055/webapp/WEB-INF/lib/gems.jar!/gems/railties-3.1.3/lib/rails/engine.rb:599
config at file:/tmp/Jetty_0_0_0_0_2525_ui.0.0.1.SNAPSHOT.war____d9z055/webapp/WEB-INF/lib/gems.jar!/gems/railties-3.1.3/lib/rails/engine.rb:479
railties at file:/tmp/Jetty_0_0_0_0_2525_ui.0.0.1.SNAPSHOT.war____d9z055/webapp/WEB-INF/lib/gems.jar!/gems/railties-3.1.3/lib/rails/engine.rb:423
initializers at file:/tmp/Jetty_0_0_0_0_2525_ui.0.0.1.SNAPSHOT.war____d9z055/webapp/WEB-INF/lib/gems.jar!/gems/railties-3.1.3/lib/rails/engine.rb:473
.... 
```

用户管理是以 Rails 引擎的形式本地构建的 gem。它是一个独立的可挂载引擎——用户管理是独立的命名空间。gem 是用 Rails 3.1.3 构建的

检查`gems.jar`构建的 WAR 中的文件，并且用户管理 gem 在那里，以及`config`目录和`lib`目录等必需的东西。

我很难找到导致此中断的特定提交。看起来更像是环境问题。

欢迎任何建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T15:27:40.530

显然，这个错误实际上是由 Usermanagement gem 中包含 .class 文件引起的。

由于我们构建服务器的权限要求，我们在构建过程中将 gems 安装到本地文件夹 - 即`project-name/gems/gems`

这一切都很好，但是，然后使用 Warbler 构建 war 文件，并且 Warbler 从`.rb`它在项目目录中找到的所有文件创建类文件 -**在**创建 gems.jar 文件之前。因此，我们最终得到`.class`了`gems.jar`存档中的文件。

对于为什么拥有类文件会破坏一切，我仍然有些不知所措-但是，没有它们确实可以解决所有问题:)

**解决方案**

告诉 Warbler 不要`gems`在 webapp 中包含该目录：（在 warbler.rb 中）

```
config.dirs = %w(app config lib log tmp) 
```

# c# - 在执行后端代码asp.net时旋转轮子

> ID：11529269
> 
> 赞同：2
> 
> 时间：2012-07-17T19:13:18.873
> 
> 标签：c#, asp.net, ajax

我正在尝试在页面上放置一个旋转轮弹出窗口，同时我正在执行后端代码以从数据库中获取新数据。这是我尝试过的，但到目前为止它不想工作，什么都没有显示。我想在单击复选框（CheckedChanged）时显示一些东西，这就是从 db 获取某些东西的时候。

这是我的ajax代码：

```
 <asp:UpdatePanel ID="UpdatePanel1" runat="server">

                    <Triggers>
                       <asp:AsyncPostBackTrigger controlid="cbAll" eventname="CheckedChanged" />
                    </Triggers>

                    <ContentTemplate>
                    </ContentTemplate>

                 </asp:UpdatePanel>

<asp:updateprogress associatedupdatepanelid="UpdatePanel1"
    id="updateProgress" runat="server">
    <progresstemplate>
        <div id="progressBackgroundFilter"></div>
        <div id="processMessage"> Loading...<br /><br />
             <img alt="Loading" src="../images/ajax-loader.gif" />
        </div>
    </progresstemplate>
</asp:updateprogress> 
```

这是复选框控件：

```
 <asp:CheckBox ID="cbAll" runat="server" Checked="true" Text="Show me everything" ForeColor="White"
        Visible="false" AutoPostBack="True" 
        oncheckedchanged="cbAll_CheckedChanged" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:32:57.513

稍微修改一下你的代码。

您不需要触发器，该事件具有 AutoPostBack 复选框。

```
<asp:UpdatePanel ID="UpdatePanel1" runat="server" UpdateMode="Conditional">
        <%--<Triggers>
            <asp:AsyncPostBackTrigger ControlID="cbAll" EventName="CheckedChanged" />
        </Triggers>--%>
        <ContentTemplate>
            <asp:CheckBox ID="cbAll" runat="server" Checked="true" Text="Show me everything"
                ForeColor="White" Visible="false" AutoPostBack="True" OnCheckedChanged="cbAll_CheckedChanged" />
        </ContentTemplate>
    </asp:UpdatePanel>
    <asp:UpdateProgress AssociatedUpdatePanelID="UpdatePanel1" ID="updateProgress" runat="server">
        <ProgressTemplate>
            <div id="progressBackgroundFilter">
            </div>
            <div id="processMessage">
                Loading...<br />
                <br />
                <img alt="Loading" src="../images/ajax-loader.gif" />
            </div>
        </ProgressTemplate>
    </asp:UpdateProgress> 
```

我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:40:12.630

我过去做过类似的事情，跳过更新进度控制，而是处理`PageRequestManager`beginRequest 和 endRequest 事件。就我而言，我还想阻止页面的 ui，所以我使用了[jQuery blockUI](http://jquery.malsup.com/block/)插件。

将以下 div 放在页面根目录的某个位置：

```
<div id="processMessage">
    Loading...
    <br />
    <br />
    <img src="/images/ajax-loader.gif" alt="Loading" />
</div> 
```

并使用以下 css 对其进行样式设置：

```
#updatingDiv
{
    width: 75px;
    height: 75px;
    margin-left: auto;
    margin-right: auto;
    text-align: center;
    padding: 10px;
    display: none;
    background-color: #EEEEEE;
    border: solid 1px #AAAAEE;
} 
```

添加以下 JavaScript：

```
$(function() {
    Sys.WebForms.PageRequestManager.getInstance().add_beginRequest(function() {
        $.blockUI({ message: $('#updatingDiv'), css: { border: 'none', background: 'transparent'} });
    });
    Sys.WebForms.PageRequestManager.getInstance().add_endRequest(function() {
        $.unblockUI();
    });
}); 
```

您需要确保包含我之前提到的[jQuery库和 blockUI 插件。](http://jquery.com)

当然，您可以修改 css/html 以满足您的需要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T20:22:08.030

试试这个，别忘了脚本管理器博客。

```
<asp:UpdatePanel ID="UpdatePanel1" runat="server">

    <Triggers>
       <asp:AsyncPostBackTrigger controlid="cbAll" eventname="CheckedChanged" />
    </Triggers>

    <ContentTemplate>
        <asp:updateprogress associatedupdatepanelid="UpdatePanel1" id="updateProgress" runat="server">
            <progresstemplate>
            <div id="progressBackgroundFilter"></div>
            <div id="processMessage"> Loading...<br /><br />
             <img alt="Loading" src="../images/ajax-loader.gif" />
            </div>
            </progresstemplate>
        </asp:updateprogress> 
    </ContentTemplate>
 </asp:UpdatePanel> 
```

[来源](http://msdn.microsoft.com/en-us/library/bb386421.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-03T10:52:22.290

`

.divWaiting { 位置：绝对；溢出：隐藏；文本对齐：居中；顶部：0；左：0；高度：100%；宽度：100%；填充顶部：40%；

```
}

.divWaiting #div1
{
  position: relative;
  top: 0;
  left: 0;
  background-color: White;
  width: 180px;
  left: 460px;
  border: 2px solid #870307;
  border-radius: 6px;
  text-align: center;

} 
```

下载旋转轮的 .gif 图像

# c - pread 在不应该返回 0 时返回？

> ID：11529270
> 
> 赞同：1
> 
> 时间：2012-07-17T19:13:19.433
> 
> 标签：c, file-transfer, chunking

我正在编写一个文件传输程序。但是由于某种原因，尽管不在文件末尾，但仍在`pread`返回。`0`任何人都可以看看我的代码并看到问题吗？它与`fread`.

```
 int file;
        unsigned int size = selfp->intdata;
        file=open(str, O_RDONLY); 
        char buf[1024];

        printf("filename = %s \n", str);//prints file name requested
        printf("buffer = %s \n", buf);//prints nothing currently
        printf("offset = %d \n",atoi(chunkIndex)*CHUNK);//prints 0 for first chunk
        printf("CHUNK = %d \n", CHUNK);//prints 1024
        int myoffset = atoi(chunkIndex)*CHUNK; 
        int dataSize=pread(file, buf, sizeof buf, myoffset);
        printf("%d\n", dataSize);//returns 0

        close(file); 
```

谢谢！

# java - 未调用自定义 BeanUtils 转换器

> ID：11529271
> 
> 赞同：0
> 
> 时间：2012-07-17T19:13:22.827
> 
> 标签：java, apache-commons-beanutils

我正在尝试编写自己的 bean utils 转换器，以便可以将对象导出到纯文本文件

我有主课

```
 public class BeanUtilsTest {
    public static void main(String[] args) {
        try{
        MyObject myObject = new MyObject();
        myObject.setId(3l);
        myObject.setName("My Name");

        ConvertUtilsBean cub = new ConvertUtilsBean();
        cub.deregister(String.class);
        cub.register(new MyStringConverter(), String.class);
        cub.deregister(Long.class);
        cub.register(new MyLongConverter(), Long.class);

        System.out.println(cub.lookup(String.class));
        System.out.println(cub.lookup(Long.class));

        BeanUtilsBean bub = new BeanUtilsBean(cub, new PropertyUtilsBean());

        String name = bub.getProperty(myObject, "name");
        System.out.println(name);
        String id = bub.getProperty(myObject, "id");
        System.out.println(id);
        }catch(Exception ex){
            ex.printStackTrace();
        }
    }
} 
```

长转换器

```
public class MyLongConverter implements Converter{

    @Override
    public Object convert(Class clazz, Object value) {
        System.out.println("Long convert");
        return value.toString()+"l";
    }

} 
```

字符串转换器

```
public class MyStringConverter implements Converter{

    @Override
    public Object convert(Class clazz, Object value) {
        System.out.println("String convert");
        return value.toString()+":";
    }
} 
```

最后我的对象

```
public class MyObject {
    Long id; 
    String name;
    public Long getId() {
        return id;
    }
    public void setId(Long id) {
        this.id = id;
    }
    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
} 
```

输出

```
String convert
My Name:
String convert
3: 
```

我期待 id 将通过 MyLongConverter，但它似乎仍在通过 String 之一。为什么以及如何解决这个问题？

请指教 谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T20:24:11.007

```
String id = bub.getProperty(myObject, "id"); 
```

类中的上述`getProperty`函数`BeanUtilBean`必须返回`String`您请求的属性的表示形式，无论该属性是什么格式定义的。因此，它将始终使用`String`转换器 ( `MyStringConverter`)。

由于这里的目标类型是 always `String`，`MyLongConverter`将永远不会使用。

相反，`MyStringConverter`应该检查 value 参数的类型并相应地将其转换为`String`.

# python - 如何在 Python 中将 if/else 压缩为一行？

> ID：11529273
> 
> 赞同：196
> 
> 时间：2012-07-17T19:13:35.863
> 
> 标签：python

> **可能重复：**
> [Python 三元运算符](https://stackoverflow.com/questions/394809/python-ternary-operator)
> [将一个简单的 if-then 语句放在一行上](https://stackoverflow.com/questions/2802726/putting-a-simple-if-then-statement-on-one-line)

有没有办法将`if`/`else`语句压缩到 Python 中的一行？
我经常看到各种捷径，并怀疑它也可以在这里应用。

* * *

## 回答 #1

> 赞同：328
> 
> 时间：2012-07-17T19:15:52.180

Python 执行“三元”表达式的示例：

```
i = 5 if a > 7 else 0 
```

翻译成

```
if a > 7:
   i = 5
else:
   i = 0 
```

在使用列表推导时，或者有时在返回语句中，这实际上会派上用场，否则我不确定它对创建可读代码有多大帮助。

[在这个最近的 SO question 中，比在 python 中使用 if-else 语句更好的方式](https://stackoverflow.com/questions/11491944/better-way-than-using-if-else-statement-in-python)详细讨论了可读性问题。

它还包含完成相同任务的各种其他**巧妙**（并且有些*模糊）的方法。*仅基于这些帖子就值得一读。

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2012-07-17T19:15:16.787

Python`if`可以用作[三元运算符](http://docs.python.org/release/2.5.2/ref/Booleans.html)：

```
>>> 'true' if True else 'false'
'true'
>>> 'true' if False else 'false'
'false' 
```

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2012-07-17T19:14:57.460

仅用作值：

```
x = 3 if a==2 else 0 
```

或者

```
return 3 if a==2 else 0 
```

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2012-07-17T19:16:21.357

有条件表达式：

```
a if cond else b 
```

但这是一个表达，而不是一个陈述。

在 if 语句中，`if`(or`elif`或`else`) 可以写在与块主体相同的行上，如果块是这样的：

```
if something: somefunc()
else: otherfunc() 
```

但这不鼓励作为格式样式的问题。

# c++-cli - 列表而不是数组

> ID：11529274
> 
> 赞同：0
> 
> 时间：2012-07-17T19:13:41.243
> 
> 标签：c++-cli

我目前有一个输出 myResult 字节数组字典的函数。我想将其转换为字节列表字典，因为对于每个条目，我可能存储超过 1 个字节数组。用列表替换数组的格式是什么以及如何将每个数组添加到列表中。当前格式如下：

```
int img_sz = img0->width * img0->height * img0->nChannels;

array <Byte>^ hh = gcnew array<Byte> (img_sz);

Marshal::Copy( (IntPtr)img->imageData, hh, 0, img_sz );

Dictionary<String^,array< Byte >^>^ myResult = gcnew Dictionary<String^,array< Byte >^>(); 

myResult["OVERVIEW"]=hh; 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:25:25.797

我不完全确定您要选择哪一个，所以我会同时回答它们。

## `Dictionary<String^, List<Byte>^>^`

如果您想以 结尾`Dictionary<String^, List<Byte>^>^`，只需调用带有 的`List<T>` [构造函数](http://msdn.microsoft.com/en-us/library/fkbw11z0)，`IEnumerable<T>`然后像现在一样将其添加到字典中。

```
Dictionary<String^,List<Byte>^>^ myResult = gcnew Dictionary<String^,List<Byte>^>(); 

myResult["OVERVIEW"] = gcnew List<Byte>(hh); 
```

## `Dictionary<String^, List<array<Byte>^>^>^`

如果您想以 结尾`Dictionary<String^, List<array<Byte>^>^>^`，您需要检查字典以查看它是否作为该键的列表，如果不是，则添加列表，然后将新数组添加到列表中。使用要存储每个数组的各种数组和列表的名称调用此方法。

```
void AddToResults(Dictionary<String^, List<array<Byte>^>^>^ myResult, 
                  String^ key, 
                  array<Byte>^ hh)
{
    List<array<Byte>^>^ thisList;

    if(!myResult->TryGetValue(key, thisList))
    {
        thisList = gcnew List<array<Byte>^>();
        myResult->Add(key, thisList);
    }

    thisList->Add(hh);
} 
```

# php - 如何在php数组中找到对象并删除它？

> ID：11529280
> 
> 赞同：12
> 
> 时间：2012-07-17T19:14:15.530
> 
> 标签：php, arrays

这是我的数组的 print_r 输出：

```
Array
(
[0] => stdClass Object
    (
        [itemId] => 560639000019
        [name] => Item no1
        [code] => 00001
        [qty] => 5
        [id] => 2
    )

[1] => stdClass Object
    (
        [itemId] => 470639763471
        [name] => Second item
        [code] => 76347
        [qty] => 9
        [id] => 4
    )

[2] => stdClass Object
    (
        [itemId] => 56939399632
        [name] => Item no 3
        [code] => 39963
        [qty] => 6
        [id] => 7
    )

) 
```

如何找到具有 [id] => 4 的对象索引以便将其从数组中删除？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-17T19:20:56.460

```
$found = false;  
foreach($values as $key => $value) {
    if ($value->id == 4) {
        $found = true;
        break;
    }
}

if ($found) unset($values[$key]); 
```

这被认为比任何其他解决方案都更快，因为我们只迭代`array`到直到找到我们想要删除的对象。

**注意：**您不应该在迭代时删除数组的元素，所以我们稍后再做。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-17T19:16:25.377

```
foreach($parentObj AS $key=>$element){
  if ($element->id == THE_ID_YOU_ARE_LOOKING_FOR){
    echo "Gottcha! The index is - ". $key;
  }
} 
```

`$parentObj`显然是您的根数组 - 包含所有其他数组的数组。

我们使用`foreach`循环遍历每个项目，然后`id`根据您想要的值测试​​它的属性。一旦我们有了它 -`$key`我们所在的就是您正在寻找的索引。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-17T19:26:16.853

使用**[array_search](http://php.net/manual/en/function.array-search.php)**：

```
$a = new stdClass;
$b = new stdClass;
$a->id = 1;
$b->id = 2;

$arr = array($a, $b);
$index = array_search($b, $arr);

echo $index;
// prints out 1 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-17T19:22:57.113

尝试这个

```
foreach($array AS $key=>$object){
   if($object['id'] == 4){
       $key_in_array = $key;
   }
}

// chop it from the original array
array_slice($array, $key_in_array, 1); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-17T19:24:50.250

实现结果的另一种方法是使用[array_filter](http://php.net/manual/en/function.array-filter.php)。

```
$array = array(
    (object)array('id' => 5),
    (object)array('id' => 4),
    (object)array('id' => 3)
);
$array = array_filter($array, function($item) {
    return $item->id != 4;
});
print_r($array); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-17T19:47:20.757

一个有趣的选择

```
$getIdUnset = function($id) use ($myArray)
{
    foreach($myArray as $key => $obj) {
        if ($obj->id == $id) {
            return $key;
        }
    }

    return false;
};

if ($unset = $getIdUnset(4)) {
    unset($myArray[$unset]);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-17T19:36:44.737

这是我的解决方案。鉴于，它有点hackish，但它会完成工作。

## 搜索（数组$items，混合$id[，&$key]）；

返回由 找到的项目`$id`。如果您添加变量`$key`，它将为您提供找到的项目的键。

```
function search($items, $id, &$key = null) {
  foreach( $items as $item ) {
    if( $item->id == $id ) {
      $key = key($item);
      return $item;
      break;
    }
  }

  return null;
} 
```

用法

```
$item = search($items, 4, $key);
unset($items[$key]); 
```

**注意：**这可以修改为允许自定义键并返回共享相同值的多个项目。

[我创建了一个示例，以便您可以看到它的实际效果](http://codepad.org/BxpathBq)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-06-17T08:21:23.403

我知道，经过这么多年，这可能是一个无用的答案，但为什么不呢？

这是我个人`index_of`使用与其他答案相同的代码的可能实现，但让程序员选择何时以及如何进行检查，也支持复杂的检查。

```
if (!function_exists('index_of'))
{
    /**
     * @param iterable $haystack
     * @param callable $callback
     * @param mixed|null &$item
     * @return false|int|string
     */
    function index_of($haystack, $callback, &$item = null)
    {
        foreach($haystack as $_key => $_item) {
            if ($callback($_item, $_key) === true) {
                $item = $_item;
                return $_key;
            }
        }
        return false;
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-11-05T04:38:06.117

目前 php 还没有任何支持的功能。

所以参考 Java 的 Vector，或者 jQuery 的 $.inArray()，它就是：

```
public function indexOf($object, array $elementData) {
    $elementCount = count($elementData);
    for ($i = 0 ; $i < $elementCount ; $i++){
        if ($object == $elementData[$i]) {
            return $i;   
        }
    }
    return -1;
} 
```

您可以将此功能保存为核心功能以供以后使用。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-08-02T14:03:17.710

就我而言，这是我的数组，因为`$array`
我对我的项目的这个问题感到困惑，但这里的一些答案帮助了我。

```
array(3) { 
           [0]=> float(-0.12459619130796) 
           [1]=> float(-0.64018439966448) 
           [2]=> float(0)
         } 
```

然后使用`if condition`停止循环

```
foreach($array as $key => $val){
           if($key == 0){ //the key is 0
               echo $key; //find the key
               echo $val; //get the value
           }
        } 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2012-07-17T19:23:52.120

```
foreach( $arr as $k=>&$a) {
    if( $a['id'] == 4 )
        unset($arr[$k]);
} 
```

# django - nginx django 502 网关错误

> ID：11529288
> 
> 赞同：6
> 
> 时间：2012-07-17T19:15:00.730
> 
> 标签：django, nginx, uwsgi

我正在使用 uWSGI 和 Nginx 为我的 Django 网站（1.4 版本）提供服务器。我的文件结构是 django_mysite/django_mysite/ 其中有一个 wsgi.py 文件。
我不断收到 502 Bad gateway 错误。我有其他运行 nginx 的服务器，它们工作正常。

我的 nginx 配置：

```
server {
  listen      80;
  server_name beta.example.com;

  keepalive_timeout 70;

  root /path/to/django_mysite/django_mysite;

  location root {
        root   html;
        uwsgi_pass   localhost:9000;
        uwsgi_param UWSGI_SCRIPT django_wsgi;
        include        uwsgi_params;
    }

  location / {
        uwsgi_pass   localhost:9000;
        include        uwsgi_params;
        uwsgi_param SCRIPT_NAME /django;
        uwsgi_param UWSGI_SCRIPT django_wsgi;
        uwsgi_modifier1 30;
    }
} 
```

我的 wsgi.py 文件：import sys import os

```
sys.path.append('/path/to/django_mysite/')
 os.environ.setdefault("DJANGO_SETTINGS_MODULE", "django_mysite.settings")

import django.core.handlers.wsgi
application = django.core.handlers.wsgi.WSGIHandler() 
```

日志中的错误是：

```
*3 recv() failed (104: Connection reset by peer) while reading response header from upstream 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T20:25:43.830

我找到的解决方案是：我为创建 uwsgi 工作人员创建的 uwsgi.ini 文件没有指定套接字。所以我制作了另一个 .ini 文件并为它制作了一个套接字。我放置在 uwsgi_pass 下的 nginx conf 文件中的同一个套接字。这是 django 用于配置 uwsgi 的网页的链接。

[https://docs.djangoproject.com/en/dev/howto/deployment/wsgi/uwsgi/](https://docs.djangoproject.com/en/dev/howto/deployment/wsgi/uwsgi/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-22T10:50:20.987

我遇到了同样的问题，但我通过以下方式解决了这个问题。

如果您的项目中包含第三方应用程序，那么它应该安装在您的服务器上，就像南方是第三方应用程序一样。考虑 south 包含在您的 settings.py 文件中，那么 south 也应该安装在您的服务器上。如果该模块在这里考虑南方，已经安装在服务器上，然后尝试升级它。因为您可能在本地机器上使用升级版本的模块，而旧版本安装在服务器中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-23T13:05:31.457

就我而言，问题出在 uwsgi 配置上。我在我的应用程序的 uwsgi conf 中添加了 buffer-size = 65535 并且错误 502 的问题在服务器上得到了解决

# matlab - 扩展具有重复值的数组，直到另一个数组值与 MATLAB 匹配

> ID：11529291
> 
> 赞同：2
> 
> 时间：2012-07-17T19:15:14.077
> 
> 标签：matlab

```
a=[2 3 4 7 9 12 15 18 22]
b=[2 7 15] 
```

结果应该是这样的

```
c=[2 2 2  7 7 7 15 15 15]; 
```

这些值应该重复，直到另一个矩阵值匹配。Matlab 如何为我提供与此相关的所有问题的解决方案？请帮助..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T20:02:08.057

假设`a`和`b`已排序，你可以试试这个

```
c = b(sum(bsxfun(@(x,y) x >= y, a, b(:)))); 
```

这导致

```
c =
     2     2     2     7     7     7    15    15    15 
```

请注意，这仅在`b(1) == a(1)`. 如果`b(1) < a(1)`,`b(1)`将重复，尽管它不匹配`a(1)`，并且如果`b(1) > a(1)`由于下标索引小于 1 而引发错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T19:43:06.580

假设前两个数字始终相同（否则结果的第一个数字应该是什么？）：

```
prevj = b(1);
last = 1;
c = a;
for j = b(2:end)
    ind = find(c == j);
    c(last:ind-1) = prevj;
    last = ind;
    prevj = j;
end
c(last:end) = prevj; 
```

对混乱的代码感到抱歉，但它似乎得到了你想要的结果（有一些假设）。

# maven - 如何在不使用进程调用的情况下从插件中以编程方式调用 Maven？

> ID：11529295
> 
> 赞同：0
> 
> 时间：2012-07-17T19:15:33.097
> 
> 标签：maven, maven-plugin, maven-3

我想从插件中调用 Maven 目标，并且不愿意接受将进程分叉作为初始化的成本。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:15:33.097

我怀疑这是一种受支持的方法，但它对我有用。

```
/**
 * @parameter expression="${session}"
 * @required
 * @readonly
 */
 private MavenSession session;

/**
 * @component
 * @readonly
 */
 private Maven maven;
/**
 * @parameter default-value="${project.remoteArtifactRepositories}"
 * @readonly
 **/
protected List<ArtifactRepository> remoteArtifactRepositories;
/**
 * The project's remote repositories to use for the resolution of plugins
 * and their dependencies.
 * 
 * @parameter default-value="${project.pluginArtifactRepositories}"
 * @readonly
 */
private List<ArtifactRepository> pluginArtifactRepositories;
/**
 * @parameter default-value="${localRepository}"
 * @readonly
 * */
private ArtifactRepository localRepository; 
```

...

```
List<String> goals = ...
File pomFile = ...
MavenExecutionRequest req = new DefaultMavenExecutionRequest();
req.setPom(pomFile);
req.setBaseDirectory(pomFile.getParentFile());
req.setGoals(goals);
req.setProxies(session.getSettings().getProxies());
req.setMirrors(session.getSettings().getMirrors());
req.setLocalRepository(localRepository);
req.setRemoteRepositories(remoteArtifactRepositories);
req.setPluginArtifactRepositories(pluginArtifactRepositories);
MavenExecutionResult result = session.execute(req); 
```

要内省处理，您可以继承 AbstractExecutionListener 并使用 req.setExecutionListener() 来应用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T14:10:14.160

我想念的是：

[http://timmoore.github.com/mojo-executor/](http://timmoore.github.com/mojo-executor/)

# r - 如何清除 posix 值的 NA 标志？

> ID：11529297
> 
> 赞同：5
> 
> 时间：2012-07-17T19:15:41.050
> 
> 标签：r

`csv`格式的样本数据。保存在文件中`broken_posix.csv`

```
Date
3/10/2012 23:00
3/11/2012 0:00
3/11/2012 1:00
3/11/2012 2:00
3/11/2012 3:00
3/11/2012 4:00
3/11/2012 5:00
3/11/2012 6:00
3/11/2012 7:00
3/11/2012 8:00
3/11/2012 9:00
3/11/2012 10:00
3/11/2012 11:00
3/11/2012 12:00
3/11/2012 13:00
3/11/2012 14:00
3/11/2012 15:00
3/11/2012 16:00
3/11/2012 17:00
3/11/2012 18:00
3/11/2012 19:00
3/11/2012 20:00
3/11/2012 21:00
3/11/2012 22:00
3/11/2012 23:00
3/12/2012 0:00
3/12/2012 1:00
3/12/2012 2:00
3/12/2012 3:00
3/12/2012 4:00
3/12/2012 5:00
3/12/2012 6:00
3/12/2012 7:00
3/12/2012 8:00
3/12/2012 9:00
3/12/2012 10:00
3/12/2012 11:00 
```

所以我有这个文件`broken_posix.csv`。我可以很好地阅读文件

```
a_var <- read.csv("broken_posix.csv") 
```

然后我可以将其转换为`posix`使用

```
a_var_posixct = as.POSIXct(strptime( as.character( a_var$Date) , '%m/%d/%Y %H:%M')) 
```

或与

```
a_var_posixlt = strptime(as.character( a_var$Date) , '%m/%d/%Y %H:%M') 
```

但是现在出现了问题，因为当我使用 posixct 时，我每年都会在我的字符串中获得 4 个 NA 值。当我使用时，`posixlt`我得到一个`NA`值`March 11,2012 at 2 (daylight savings time)`

当你跑的时候你会明白我的意思

```
which(is.na(a_var_posixct))
which(is.na(a_var_posixlt))

a_var_posixct[4]
a_var_posixlt[4] 
```

每当您应用操作时，第四个值始终是一个`NA`值，即使它显然是 posixlt 的日期值。

我尝试省略该值只是为了弄乱 posix 字符串的其余部分。我尝试将 posix 字符串设置为自身，试图清除 NA 标志，但没有效果。我什至尝试将其设置为字符值，只是为了丢失小时和分钟格式。

我认为这种情况发生是因为夏令时。处理起来非常令人沮丧，因为当我尝试在日期运行其他函数时，我必须尽量避免 NA 值，因为我无法更改它们。我可以按天聚合数据，或者只使用日期对象，但这似乎不是正确的方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T20:02:17.447

使用没有夏令时的时区为我解决了这类问题。

```
a_var_posixlt = strptime(as.character( a_var$Date) , '%m/%d/%Y %H:%M',tz="GMT") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T20:08:21.300

从`?as.POSIXct`

字符输入首先由 strptime 转换为类“POSIXlt”：数字输入首先转换为“POSIXct”。任何需要在两个日期时间类之间进行的转换都需要一个时区：从“POSIXlt”到“POSIXct”的转换将验证所选时区的时间。一个问题是在往返 DST 的过渡时会发生什么，例如在英国

```
as.POSIXct(strptime('2011-03-27 01:30:00', '%Y-%m-%d %H:%M:%S'))
as.POSIXct(strptime('2010-10-31 01:30:00', '%Y-%m-%d %H:%M:%S')) 
```

分别是无效的（时钟在格林威治标准时间 1:00 前进到英国夏令时 2:00）和不明确（时钟在格林威治标准时间 2:00 回到格林威治标准时间 1:00）。在这种情况下发生的情况是 **特定于操作系统的**：人们应该期望第一个是 NA，但第二个可以解释为 BST 或 GMT（并且常见的操作系统给出了这两个可能的值）。还要注意（参见 strftime），操作系统工具可能无法正确格式化无效时间。

您的 4 NA 可能会在时钟每年更改两次的时间点上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T19:57:39.767

我无法重现该问题，但您可以尝试以下方法。

首先要检查的是您的数据是否正确。复制并粘贴此问题的数据集，然后在您的计算机上再次运行它。你仍然得到错误吗？如果没有，您的数据集中可能有错字。也试试大卫罗宾逊建议的路线。

```
as.POSIXlt(strptime("3/11/2012 2:00", '%m/%d/%Y %H:%M')) 
```

这会回来`NA`吗？

另一个奇怪的与日期相关`NA`的 s 来源是语言环境。检查你正在使用什么

```
Sys.getlocale("LC_TIME") 
```

然后将其更改为不同的。可用的语言环境因您的操作系统而异（这很混乱），但请查看`example(Sys.setlocale)`.

# xml - 在 XML 文档中合并行集

> ID：11529303
> 
> 赞同：-1
> 
> 时间：2012-07-17T19:15:57.787
> 
> 标签：xml, xslt

我和我一起使用了 XML，其中包含多个 Rowset。我想将所有 Rowset 合并为一个。所以你能帮助我如何使用 XSLT 或任何其他方法来做到这一点吗？

当前的 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<Rowsets DateCreated="2012-07-17T11:57:07" EndDate="2012-07-17T11:57:07" StartDate="2012-07-17T10:57:07" Version="12.0.12 Build(9)">
<Rowset>
    <Columns>
        <Column Description="Name" MaxRange="1" MinRange="0" Name="Name" SQLDataType="12" SourceColumn="Name"/>
        <Column Description="City" MaxRange="1" MinRange="0" Name="City" SQLDataType="4" SourceColumn="City"/>
        <Column Description="Phone" MaxRange="1" MinRange="0" Name="Phone" SQLDataType="12" SourceColumn="Phone"/>

    </Columns>
    <Row>
        <Name>Philip</Name>
        <City>London</City>
        <Phone>123</Phone>

    </Row>
    <Row>
        <Name>Derek</Name>
        <City>Seattle</City>
        <Phone>500</Phone>

    </Row>
    <Row>
        <Name>Bruke</Name>
        <City>LosAngeles</City>
        <Phone>600</Phone>

    </Row>

    <Rowset>
        <Columns>
            <Column Description="Name" MaxRange="1" MinRange="0" Name="Name" SQLDataType="12" SourceColumn="Name"/>
            <Column Description="City" MaxRange="1" MinRange="0" Name="City" SQLDataType="4" SourceColumn="City"/>
            <Column Description="Phone" MaxRange="1" MinRange="0" Name="Phone" SQLDataType="12" SourceColumn="Phone"/>

        </Columns>
        <Row>
        <Name>Yang</Name>
        <City>SFO</City>
        <Phone>1233</Phone>

    </Row>
    <Row>
        <Name>Cristina</Name>
        <City>SanJose</City>
        <Phone>890</Phone>

    </Row>

    </Rowset>
    <Rowset>
        <Columns>
            <Column Description="Name" MaxRange="1" MinRange="0" Name="Name" SQLDataType="12" SourceColumn="Name"/>
            <Column Description="City" MaxRange="1" MinRange="0" Name="City" SQLDataType="4" SourceColumn="City"/>
            <Column Description="Phone" MaxRange="1" MinRange="0" Name="Phone" SQLDataType="12" SourceColumn="Phone"/>

        </Columns>
        <Row>
        <Name>Meredith</Name>
        <City>Sunnyvale</City>
        <Phone>788</Phone>

    </Row>
    <Row>
        <Name>Grey</Name>
        <City>MountainView</City>
        <Phone>456</Phone>

    </Row>
    <Row>
        <Name>Torrence</Name>
        <City>SAntaClara</City>
        <Phone>432</Phone>

    </Row>

    </Rowset>
</Rowset>
</Rowsets> 
```

需要的输出 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<Rowsets DateCreated="2012-07-17T11:57:07" EndDate="2012-07-17T11:57:07" StartDate="2012-07-17T10:57:07" Version="12.0.12 Build(9)">
    <Rowset>
        <Row>
            <Name>Philip</Name>
            <City>London</City>
            <Phone>123</Phone>
        </Row>
        <Row>
            <Name>Derek</Name>
            <City>Seattle</City>
            <Phone>500</Phone>
        </Row>
        <Row>
            <Name>Bruke</Name>
            <City>LosAngeles</City>
            <Phone>600</Phone>
        </Row>
        <Row>
            <Name>Yang</Name>
            <City>SFO</City>
            <Phone>1233</Phone>
        </Row>
        <Row>
            <Name>Cristina</Name>
            <City>SanJose</City>
            <Phone>890</Phone>
        </Row>
        <Row>
            <Name>Meredith</Name>
            <City>Sunnyvale</City>
            <Phone>788</Phone>
        </Row>
        <Row>
            <Name>Grey</Name>
            <City>MountainView</City>
            <Phone>456</Phone>
        </Row>
        <Row>
            <Name>Torrence</Name>
            <City>SAntaClara</City>
            <Phone>432</Phone>
        </Row>
    </Rowset>
</Rowsets> 
```

那么你们能帮我解决这个问题吗？

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T05:29:20.197

我能够根据 Tim 的回答编写简化的 XSLT：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:template match="/">
    <Rowsets DateCreated="{Rowsets/@DateCreated}" Version="{Rowsets/@Version}" StartDate="{Rowsets/@StartDate}" EndDate="{Rowsets/@EndDate}">
        <Rowset>
            <xsl:for-each select="Rowsets/Rowset">
                <xsl:variable name="RowsetNo">
                               <xsl:value-of select="position()"/>
                </xsl:variable>
                <xsl:if test="$RowsetNo = 1">
                    <xsl:copy-of select="Columns"/>
                </xsl:if>
                <xsl:copy-of select="Row"/>
            </xsl:for-each>
        </Rowset>
    </Rowsets>
</xsl:template> 
```

我希望它有所帮助。

索汉姆

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T06:35:47.463

您可以通过使用标准 XSLT 标识转换来实现这一点，但不是匹配和复制所有节点，而是仅复制**Row**元素

```
<xsl:template match="@*|Row|Row/*">
   <xsl:copy>
      <xsl:apply-templates select="@*|node()"/>
   </xsl:copy>
</xsl:template> 
```

对于其他元素，您将匹配它们，但继续处理它们的子元素而不复制它们

```
<xsl:template match="*">
   <xsl:apply-templates select="node()"/>
</xsl:template> 
```

您还需要一个模板来匹配根元素。

这是完整的 XSLT

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="xml" indent="yes"/>

   <xsl:template match="/Rowsets">
      <Rowsets>
         <xsl:apply-templates select="@*"/>
         <Rowset>
            <xsl:apply-templates select="node()"/>
         </Rowset>
      </Rowsets>
   </xsl:template>

   <xsl:template match="@*|Row|Row/*">
      <xsl:copy>
         <xsl:apply-templates select="@*|node()"/>
      </xsl:copy>
   </xsl:template>

   <xsl:template match="*">
      <xsl:apply-templates select="node()"/>
   </xsl:template>
</xsl:stylesheet> 
```

当应用于您的输入样本时，输出如下

```
<Rowsets DateCreated="2012-07-17T11:57:07" EndDate="2012-07-17T11:57:07" StartDate="2012-07-17T10:57:07" Version="12.0.12 Build(9)">
   <Rowset>
      <Row>
         <Name>Philip</Name>
         <City>London</City>
         <Phone>123</Phone>
      </Row>
      <Row>
         <Name>Derek</Name>
         <City>Seattle</City>
         <Phone>500</Phone>
      </Row>
      <Row>
         <Name>Bruke</Name>
         <City>LosAngeles</City>
         <Phone>600</Phone>
      </Row>
      <Row>
         <Name>Yang</Name>
         <City>SFO</City>
         <Phone>1233</Phone>
      </Row>
      <Row>
         <Name>Cristina</Name>
         <City>SanJose</City>
         <Phone>890</Phone>
      </Row>
      <Row>
         <Name>Meredith</Name>
         <City>Sunnyvale</City>
         <Phone>788</Phone>
      </Row>
      <Row>
         <Name>Grey</Name>
         <City>MountainView</City>
         <Phone>456</Phone>
      </Row>
      <Row>
         <Name>Torrence</Name>
         <City>SAntaClara</City>
         <Phone>432</Phone>
      </Row>
   </Rowset>
</Rowsets> 
```

# php - Magento 特色产品含税

> ID：11529309
> 
> 赞同：1
> 
> 时间：2012-07-17T19:16:17.063
> 
> 标签：php, magento, e-commerce

在我的商店主页上，我目前有一个特色产品区。问题是它显示了包括税率在内的价格，在整个网站上，我将其设置为不带税显示，然后将税添加到购物车中。

我将以下代码用于我的特色产品定价。

```
<p class="price">&pound;<?php echo Mage::helper('tax')->getPrice($_product, $_product->getFinalPrice(), 2);?>(+VAT)</p> 
```

有没有一种简单的方法来强制结果不包括税，因为它似乎忽略了我的一般设置？

它似乎也忽略了小数位的一般规则。如果我需要发布完整的代码，请说。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T20:58:26.867

Mage::helper('tax')->getPrice() 函数的第三个参数表示价格是否必须显示含税或不含税。因此，要么将其设置为，要么将其`null`删除。

对于舍入问题，请尝试 Mage::helper('core')->currency() 而不是 Mage::helper('tax')->getPrice()。所以你的最终代码应该是这样的：

```
echo Mage::helper('core')->currency($_product->getFinalPrice()); 
```

# android - 如何将 sharedPreference 中的数据加载到 ListView 行中？

> ID：11529313
> 
> 赞同：0
> 
> 时间：2012-07-17T19:16:27.807
> 
> 标签：android, android-listview, sharedpreferences

我遇到了两个问题。

1) 如何让我的 row.xml 显示在我的 listview.xml 中？

在我的 java 类中，我扩展 ListActivity 并使用代码：

```
ListView listView = (ListView)findViewById(R.id.list);
ArrayAdapter<?> arrayAdapter = new ArrayAdapter<?>(this, R.layout.row 
```

我不知道如何完成这个。

2) 如何将我保存在 sharedPReference 上的数据加载到我的行中，这是两个字符串值？

我保存两个字符串值的代码是：

```
String product = "Health Vitamins";
String category = "Nutrition";
savePreference("NAME", product);
savePreference("NUTRITION", category); 
```

然后我在 savePreference 方法中使用 putString(key, value) 和 commit()。当我想加载数据时，我只需使用 loadPreference() ，它将使用 getString("NAME", "") 和 getString("NUTRITION", "") 并检索数据。

问题是我如何将检索到的数据实际放入我的 listview row.xml 中？例如，一旦调用 loadPreference() 方法，假设检索两个字符串值并将其放在行中？有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:31:32.007

```
String[] data = //load the array here.  

adapter = new ArrayAdapter<String>(this,
            android.R.layout.simple_list_item_1, android.R.id.text1, data); 
```

无论您想放入阵列中的什么。它可能是您的共享偏好值。但是你为什么要使用共享首选项，因为它使用键值对。而且您不能将键加倍，这意味着您的列表将始终包含 1 个或最多 2 个条目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-23T09:38:38.970

**您可以使用 Intent 从 SharedPreferences 将数据传递给 ListView**

公共类 MainActivity 扩展 AppCompatActivity 实现 View.OnClickListener {

```
private EditText nameEditText, rollEditText, deptEditText, semesterEditText;
private Button submittButton;
private TextView textView;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    nameEditText = findViewById(R.id.nameEditTextID);
    rollEditText = findViewById(R.id.rollEditTextID);
    deptEditText = findViewById(R.id.deptEditTextID);
    semesterEditText = findViewById(R.id.semesterEditTextID);
    submittButton = findViewById(R.id.submitButtonID);
    textView = findViewById(R.id.textViewID);

    submittButton.setOnClickListener(this);

}

@Override
public void onClick(View v) {

    if (v.getId() == R.id.submitButtonID) {

        String userName = nameEditText.getText().toString();
        String userRoll = rollEditText.getText().toString();
        String userDept = deptEditText.getText().toString();
        String userSemester = semesterEditText.getText().toString();

        if (userName.equals("") && userRoll.equals("") && userDept.equals("") && userSemester.equals("")) {

            Toast.makeText(getApplicationContext(), "Please enter data", Toast.LENGTH_SHORT).show();

        } else {

            SharedPreferences sharedPreferences = getSharedPreferences("Details", 0);
            //SharedPreferences sharedPreferences = PreferenceManager.getDefaultSharedPreferences(this);

            SharedPreferences.Editor editor = sharedPreferences.edit();

            editor.putString("userNameKey", userName);
            editor.putString("userRollKey", userRoll);
            editor.putString("userDeptKey", userDept);
            editor.putString("userSemesterKey", userSemester);
            editor.apply();
            nameEditText.setText("");
            rollEditText.setText("");
            deptEditText.setText("");
            semesterEditText.setText("");

            Toast.makeText(getApplicationContext(), "Saved successfully", Toast.LENGTH_SHORT).show();

            if (sharedPreferences.contains("userNameKey") && sharedPreferences.contains("userRollKey") && sharedPreferences.contains("userDeptKey")
                    && sharedPreferences.contains("userSemesterKey")) {

                Intent intent = new Intent(MainActivity.this, ListDataActivity.class);
                startActivity(intent);
            }

            /*if (sharedPreferences.contains("userNameKey") && sharedPreferences.contains("userRollKey") && sharedPreferences.contains("userDeptKey")
                    && sharedPreferences.contains("userSemesterKey")) {

                String name = sharedPreferences.getString("userNameKey", "Data not found");
                String roll = sharedPreferences.getString("userRollKey", "Data not found");
                String department = sharedPreferences.getString("userDeptKey", "Data not found");
                String semester = sharedPreferences.getString("userSemesterKey", "Data not found");

                Toast.makeText(getApplicationContext(), "Loaded successfully", Toast.LENGTH_SHORT).show();

                textView.setText(name + "\n" + roll + "\n" + department + "\n" + semester);
            }*/

        }

    }

} 
```

公共类 ListDataActivity 扩展 AppCompatActivity {

```
private ListView listView;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_list_data);

    listView = findViewById(R.id.listViewID);

    SharedPreferences sharedPreferences = getSharedPreferences("Details", 0);
    String name = sharedPreferences.getString("userNameKey", "Data not found");
    String roll = sharedPreferences.getString("userRollKey", "Data not found");
    String department = sharedPreferences.getString("userDeptKey", "Data not found");
    String semester = sharedPreferences.getString("userSemesterKey", "Data not found");

   Toast.makeText(this, "Roll is:" + roll, Toast.LENGTH_SHORT).show();

    ArrayList<String> arrayList = new ArrayList<>();
    arrayList.add(name);
    arrayList.add(roll);
    arrayList.add(department);
    arrayList.add(semester);
    ArrayAdapter<String>arrayAdapter = new ArrayAdapter<String>(this,R.layout.list_item,R.id.sampleTextViewID,arrayList);
    listView.setAdapter(arrayAdapter);

} 
```

}

# .net - 为什么 ApplyChanges() 添加一条新记录？

> ID：11529314
> 
> 赞同：0
> 
> 时间：2012-07-17T19:16:29.610
> 
> 标签：.net, entity-framework

我尝试使用以下代码更新一行，但它添加了一个新行，我找不到我的错误在哪里。

这是我的代码：

```
public int SaveTerm(Term term)
{
    using (AshyanehDataContext dc = this.conn.GetContext())
    {
        if (term.TermID > 0)
        {
            dc.Terms.Attach(dc.Terms.Single(t => t.TermID == term.TermID));
            dc.Terms.ApplyChanges(term);

        }
        else
        {
            term.AddedDate = FarsiLibrary.Utils.PersianDateConverter.ToPersianDate(DateTime.Now).ToString("D");
            dc.Terms.AddObject(term);
        }
        dc.SaveChanges();
    }
    return term.TermID;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T21:19:41.623

我改变这部分

```
if (term.TermID > 0)
{
    dc.Terms.Attach(dc.Terms.Single(t => t.TermID == term.TermID));
    dc.Terms.ApplyChanges(term);

} 
```

到

```
if (term.TermID > 0)
{
    Term _term = dc.Terms.First(t => t.TermID == term.TermID);
    _term.Terms = term.Terms;
} 
```

它有效

# json - ajax请求中的post数组缺少json

> ID：11529319
> 
> 赞同：0
> 
> 时间：2012-07-17T19:16:47.430
> 
> 标签：json, codeigniter, jquery

我正在尝试制作一个动态文档预览器。用户可以输入某些文档标题选项，并根据他们的帐户信息生成具有动态标题的文档。我最终想预览一个完整的 pdf，但我现在只处理标题。

我想要做的是制作一个用户可以填写的表单页面，然后按一个按钮来预览标题。

```
$.ajaxSetup({
type:       'POST',
timeout:    10000
});

$("#preview_header").click(function(){
    var full_url = //appropriate URL 

    var preview_data = {    
        "wsid":             "default",
        "page":             "default",
        "banner_area1":     "default",
        "banner_area2":     "default",
        "banner_area3":     "default",
        "uid":              "default",
        "fid":              "default",
        "cid":              "default",
        "assignment_type":  "default"
    };

    preview_data.wsid               = $("#worksheet_picker").val();
    preview_data.page               = $("#page_picker").val();
    preview_data.banner_area1       = $("#banner_area1").val();
    preview_data.banner_area2       = $("#banner_area2").val();
    preview_data.banner_area3       = $("#banner_area3").val();
    preview_data.uid                = $("#member_uid").val();
    preview_data.fid                = $("#family_id").val();
    preview_data.assignment_type    = 'family';
    preview_data.cid                = $("#class_id").val();

    var JSONText = JSON.stringify( preview_data );
    alert('Full JSON - ' + JSONText);

    $.ajax({
        async: true,
        url: full_url,
        data: { previewInfo : JSONText }, //Passes necessary form information
        dataType: 'json',
        success: function(output){
            var reply = output;
            if ( reply.status == "success" ){
                $("#preview").attr("src", reply.image );
            } else {
                alert('Failed to create image preview of the assignment.');
            } 
        } 
    });
}); 
```

据我所知，上述方法运行良好。它点击了正确的 Codeigniter 页面，当 ajax 方法设置为返回硬编码图像时，它工作得很好。AJAX 的格式似乎很好，但以防万一当我用相应的值填写表单时它会输出：

```
Full JSON - {"wsid":"4","page":"1","banner_area1":"link1",
"banner_area2":"link2","banner_area3":"link3",
"uid":"1","fid":"1","assignment_type":"family"} 
```

所以首先，让我们从 ajax 回复的相应控制器方法中的工作开始：

```
$data = array(
'status'    => 'success',
'image'     => //static image link
);

$this->output->set_content_type('text/javascript;charset=UTF-8');
echo json_encode($data); 
```

但是每当我尝试像这样修改它时：

```
$preview_data = json_decode($this->input->post('previewInfo'));

//Got this one
mail('me@gmail.com', 'Start Email', 'Some email' ); 
//Empty email
mail('me@gmail.com', 'Dump Post', var_dump($_POST)); 
//Empty email
mail('me@gmail.com', 'Post data', var_dump($preview_data) );
//returns an email with 1 for body
mail('me@gmail.com', 'Post data', print_r($this->input->post()) ); 
//returns an email with 1 for body
mail('me@gmail.com', 'Post data', 
     print_r($this->input->post('previewInfo')) ); 
//returns an email with 1 for body
mail('me@gmail.com', 'Post data', print_r($preview_data) );

$data = array(
'status'    => 'success',
'image'     => //static image link
);

$this->output->set_content_type('text/javascript;charset=UTF-8');
echo json_encode($data); 
```

修改后的也不返回静态数据。所以看起来 post 数组没有被正确初始化。有人看到这个错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:21:52.190

如果您想使用 post 方法发送您的 Ajax 请求，您需要在您的选项中设置`type`为。`POST``$.ajax`

此外，`async`默认情况下为 true，因此无需设置。此外，您应该考虑使用`.done`and`.fail`而不是`success`and `fail`，因为它们很快就会被弃用。

像这样：

```
$.ajax({
    type: "POST",
    url: full_url,
    data: { previewInfo : JSONText }, //Passes necessary form information
    dataType: 'json'
}).done(function (output, textStatus, jqXHR) {
    var reply = output;
    if ( reply.status == "success" ){
        $("#preview").attr("src", reply.image );
    } else {
        alert('Failed to create image preview of the assignment.');
    } 
}).fail(function (jqXHR, textStatus, errorThrown) {
    // now you have the XHR, text status, and error to debug with
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T07:29:26.177

有两个问题导致了这个问题的解决：

1)

正如 Austin 和 Gavin 所说： var_dump 和 print_r 不应该输出到浏览器。解决方案是使用 Firefox 扩展/chrome 进行调试。

2)

```
$preview_data = json_decode($this->input->post('previewInfo')); 
```

改为

```
$preview_data = json_decode($this->input->post('previewInfo'), true); 
```

json_decode 的第二个可选参数是告诉该方法您期望的是关联对象还是事物列表。碰巧，我正在阅读并想要一个关联数组。

# objective-c - 我应该如何将归档对象链接到核心数据托管对象？

> ID：11529320
> 
> 赞同：0
> 
> 时间：2012-07-17T19:16:47.913
> 
> 标签：objective-c, core-data, archiving

我需要最多保留大约 100 个复杂对象（称为对象 A）。我说复杂是因为每个对象都由其他嵌套的层次对象组成。

我决定不将它们存储在核心数据中，因为它们具有复杂的对象图，因此我正在考虑使用归档来持久化这些对象。

但是，我需要在这些对象和核心数据中的其他托管对象之间建立关系（称为对象 B）。基数是一个对象 A（存档）到多个对象 B（核心数据）。

我的问题是，这样做的最佳方法是什么？我想为每个归档对象 A 使用 UUID，并将对这些 UUID 的引用作为字符串属性存储在对象 B 的核心数据中。

但我知道这样做可能会带来性能和存储方面的损失。对象 A 是否有另一种类型的对象 ID 可能我可以使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T20:58:25.153

似乎您将在 CoreData 和存档对象之间进行映射的所有努力，通过 CoreData 进行映射会更容易。如果你在这个对象中有“复杂”的属性，这使得使用 CoreData 变得不可取，不要忘记 CoreData 有一个可转换的属性。这可能是您需要的。

# php - 仅允许从特定类型的 URL 访问我网站上的某些页面 .htaccess

> ID：11529321
> 
> 赞同：0
> 
> 时间：2012-07-17T19:16:56.113
> 
> 标签：php, mysql, .htaccess

我经营一个视频网站，我有很多视频。我的用户请求了“Youtube 未列出”功能。所以当我要尝试创建它时，我几乎完成了。

**这是我到目前为止所做的。**

1）创建了一个我定义为的密钥`secret_key = md5(uniqid($VID)).$VID;`

`secret_key`2) 允许用户更新MySQL 字段。

我希望实现的是在`.htaccess`设置为私有的所有视频中添加一些说明。这将只允许从特定链接访问私人视频的用户能够观看该视频。

所以链接是形式的`$baseurl.$secret_key`。此链接永远不会冲突，因为每个视频的 VID 都不同。

**我可以在我的文件中添加**哪些说明****`.htaccess`**以仅允许设置为私有的视频**只能通过特定链接访问。****

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:29:36.670

您可以使用 URL 重写来破解某些内容，如果密钥不匹配，则将用户重定向到错误页面。但是，.htaccess 文件不是为这样的动态更新而设计的。

最简单的解决方案是更改文件的名称以合并密钥，并在其密钥更改时重命名文件。

首选的解决方案是使用已经在使用的任何服务器端脚本语言来阻止基于数据库查找结果的请求。**

# coldfusion - 是否可以从 ColdFusion 编写 PSD 文件

> ID：11529325
> 
> 赞同：0
> 
> 时间：2012-07-17T19:17:09.957
> 
> 标签：coldfusion, psd

我希望能够获取许多单独的图像文件，主要是 JPG 和 PNG，并以编程方式将它们写入 ColdFusion 中的 PSD 文件。我的想法是我可以创建一个在线工具，我可以使用它从我的数字婚礼照片中创建婚礼相册。考虑到预期用途，图像质量和色彩再现必须尽可能接近原始图像。我对此的想法是将每个文件导入单独的图层，然后通过像素坐标设置导入图像的位置。

我遇到了[这个](https://stackoverflow.com/questions/1168614/how-to-create-a-layered-psd-file-from-command-line)，这似乎是唯一提到这种事情的 SO（我能找到）。但是，我宁愿不要在 CFExecute 中全部写出来。添加另一种语言似乎是不必要的复杂，每个未来的开发人员都需要熟悉，而且如果出现问题，CFExecute 并没有提供太多的监控或调试方式。但如果需要，我会这样做。

服务器当前在 Windows 2000 Advanced Server 上运行 ColdFusion 9。当它投入生产时，我们可能会在 Windows 2008（或更高版本）上升级到 ColdFusion 10，但是能够在我当前的环境中对其进行测试将是一个真正的优势。

# c# - 删除 Request.Url 的最后一段

> ID：11529326
> 
> 赞同：17
> 
> 时间：2012-07-17T19:17:18.537
> 
> 标签：c#

我想删除 的最后一段`Request.Url`，例如...

```
http://www.example.com/admin/users.aspx/deleteUser 
```

会变成

```
http://www.example.com/admin/users.aspx 
```

我更喜欢 linq，但接受任何有效的解决方案。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-17T19:19:51.180

使用[`Uri`](http://msdn.microsoft.com/en-us/library/system.uri.aspx)该类来解析 URI - 您可以使用该`Segments`属性访问所有段并在没有最后一个段的情况下重建 URI。

```
var uri = new Uri(myString);

var noLastSegment = string.Format("{0}://{1}", uri.Scheme, uri.Authority);

for(int i = 0; i < uri.Segments.Length - 1; i++)
{
   noLastSegment += uri.Segments[i];
}

noLastSegment = noLastSegment.Trim("/".ToCharArray()); // remove trailing `/` 
```

作为获取方案和主机名的替代方法，正如 Dour High Arch 在他的评论中所建议的那样：

```
var noLastSegment = uri.GetComponents(UriComponents.SchemeAndServer, 
                                      UriFormat.SafeUnescaped); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-07-17T19:36:19.010

与@Oded 的答案大致相同，但使用 UriBuilder 代替：

```
var uri = new Uri("http://www.example.com/admin/users.aspx/deleteUser");
var newSegments = uri.Segments.Take(uri.Segments.Length - 1).ToArray();
newSegments[newSegments.Length-1] = 
    newSegments[newSegments.Length-1].TrimEnd('/');
var ub=new UriBuilder(uri);
ub.Path=string.Concat(newSegments);
//ub.Query=string.Empty;  //maybe?
var newUri=ub.Uri; 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-07-15T08:31:45.673

要删除 Request.Url 的最后一段，从绝对 uri 中减去最后一段的长度就足够了。

```
string uriWithoutLastSegment = Request.Url.AbsoluteUri.Remove(
  Request.Url.AbsoluteUri.Length - Request.Url.Segments.Last().Length ); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-03-06T08:26:02.323

我发现操纵 Uri 相当烦人，并且由于其他答案非常冗长，这是我的两分钱以扩展方法的形式。

作为奖励，您还可以获得替换最后分段方法。这两种方法都会使查询字符串和 url 的其他部分保持不变。

```
public static class UriExtensions
{
    private static readonly Regex LastSegmentPattern = 
        new Regex(@"([^:]+://[^?]+)(/[^/?#]+)(.*$)", RegexOptions.Compiled | RegexOptions.IgnoreCase);        

    public static Uri ReplaceLastSegement(this Uri me, string replacement)
        => me != null ? new Uri(LastSegmentPattern.Replace(me.AbsoluteUri, $"$1/{replacement}$3")) : null;

    public static Uri RemoveLastSegement(this Uri me)
        => me != null ? new Uri(LastSegmentPattern.Replace(me.AbsoluteUri, "$1$3")) : null;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-17T19:25:43.193

那么简单的解决方案是从字符串的末尾到字符串的开头逐个字符地迭代，并搜索第一个'/'来（我想这也进入了你的脑海）。

试试这个：

```
string url = "http://www.example.com/admin/users.aspx/deleteUser";

for (int i = url.Length - 1; i >= 0; i--) {

    if (url[i] == '/') return url.Substring(0, i - 1);
} 
```

# iphone - 应用程序测试是否应该在应用程序包中

> ID：11529330
> 
> 赞同：0
> 
> 时间：2012-07-17T19:17:37.437
> 
> 标签：iphone

提交到应用商店时是否应将应用程序测试包含在应用程序包中，或者仅用于测试目的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:25:30.310

不，是。通常您的测试驻留在另一个目标中。对于给定的文件，您可以告诉它应该在哪些目标中。您的测试对最终用户没有任何用处，因此我不会将它们放入您的最终应用程序中。

# javascript - 在 html 文档的开头声明变量

> ID：11529334
> 
> 赞同：2
> 
> 时间：2012-07-17T19:17:55.657
> 
> 标签：javascript, variables

在 PHP 中，我们可以这样在文档的开头声明变量：

```
<?php
$title="Title of the webpage";
?> 
```

在 html 代码中，此标题将替换`echo $title`网页 html 代码中的 。是否可以使用 html 和 Javascript 来实现，我的意思是不使用 PHP？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T19:19:33.007

```
<script>
var someVariable="someValue";
document.title = someVariable;
</script> 
```

# asp.net - 在 ASP.NET 中处理自定义 MembershipProvider 类中的密码

> ID：11529342
> 
> 赞同：0
> 
> 时间：2012-07-17T19:18:30.240
> 
> 标签：asp.net, asp.net-membership

我正在实现一个使用我的富域模型的自定义 MembershipProvider 类。我很犹豫，因为我想确保我正确处理密码。我想对数据库中的密码进行哈希处理，但我似乎找不到任何我相信在 ASP.NET 中执行此操作的最佳实践或示例代码。是否可以编写自定义 MembershipProvider 类但以某种方式利用基类来处理密码详细信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:25:02.410

您最好的选择可能是继承`SqlMembershipProvider`并覆盖除 之外的大多数方法`EncryptPassword`，这将使用默认的 ASP.NET 行为。

```
public class CustomMembershipProvider : SqlMembershipProvider
{
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:35:00.213

不要害怕自己散列密码。只是需要注意的几件事。

1）使用不被破坏的哈希算法（MD5是，sha256/sha512不是现在）

2) 永远记得用你的散列密码存储唯一的散列，这样你就有`hash = hashfunction( password + salt)`. 这是为了防止有人在数据库被盗时使用预先计算的哈希轻松获取您的密码。

3）（可选）散列几次，几百次或几千次，并用您的散列密码存储圆形计数器。这将进一步减缓任何试图从被盗数据库中获取明文密码的人的速度。

# typo3 - tt_news 单个视图中的默认图像

> ID：11529346
> 
> 赞同：0
> 
> 时间：2012-07-17T19:18:39.927
> 
> 标签：typo3, tt-news

在 tt_news 中，当没有与新闻关联的图像时，如何显示默认图像？我试过了

```
plugin.tt_news.displaySingle.image.noImage_stdWrap.cObject = IMAGE
plugin.tt_news.displaySingle.image.noImage_stdWrap.cObject {
  wrap =
  file = fileadmin/images/image.jpg
} 
```

但它不显示图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-03T17:41:22.937

它应该与这个一起工作：

```
plugin.tt_news.displaySingle.image.noImage_stdWrap {
    cObject = IMAGE
    cObject {
        file = fileadmin/news-image-default.jpg
        wrap =
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T07:15:26.697

我猜“displaySingle”和“image”之间有一个点不见了？

```
plugin.tt_news.displaySingle.image.noImage_stdWrap.cObject = IMAGE
plugin.tt_news.displaySingle.image.noImage_stdWrap.cObject {
  file = fileadmin/images/image.jpg
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-16T14:32:03.757

这段代码对我有用。文件路径必须正确且图像文件必须存在，否则 Typo 不会显示任何内容。

```
plugin.tt_news.displaySingle.image.noImage_stdWrap {
    cObject = IMAGE
    cObject {
        file = fileadmin/tt_news/default_image.jpg
        wrap = |
    }
} 
```

# php - php查询不返回结果

> ID：11529348
> 
> 赞同：1
> 
> 时间：2012-07-17T19:18:42.257
> 
> 标签：php, mysql

我正在尝试执行没有结果的 php 查询。我一直试图让它工作几个小时，并认为另一双眼睛会有所帮助。这是我的脚本：

```
if(!empty($cLvl))
{
    $result = $conn->query("SELECT lvl" . $cLvl . " 
    FROM buyers WHERE buyer_id = $buyer");

    $comRate = $result->fetch_assoc();
}
print_r($comRate); die; 
```

`$buyer`被发现：

```
$result = $conn->query("select source_id from inventory where sku = {$data[$n]['sku']}");
if($result) {$buyer = $result->fetch_assoc();} 
```

并`$cLvl`通过以下方式找到：

```
if($data[$n]['cost'] == 0 || $bookType3['book_type_3'] == "DMG")
{
    $cLvl = null;
}
elseif($bookType['book_code'] == "IE" || $bookType['book_code'] == "AIE")
{
    $cLvl = 3;
}
elseif($cId['condition_id'] == 1 || $cId['condition_id'] == 2 || $cId['condition_id'] == 3 || $cId['condition_id'] == 4 || $follett['class_code'] == "D" || strpos($follett['notes'],"(T)") == true)
{
    $cLvl = 2;
}
elseif($cId['condition_id'] == 5)
{
    $cLvl = 1;
} 
```

在我的测试`$buyer = 263`和`$cLvl = 3`. 但是，当我尝试查找时`$comRate`，它什么也不返回。如果我在信息中硬编码我会得到一个结果，但这将运行大约 250 条记录，我不能对每条记录都进行硬编码。

我哪里错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:22:13.620

这段代码有很多问题，但是您要求的可能是您`$buyer`的 assoc 数组，您想`{$buyer['source_id']}`改用它。

# html - 单击菜单链接时WordPress滚动主题向左移动

> ID：11529349
> 
> 赞同：1
> 
> 时间：2012-07-17T19:18:43.820
> 
> 标签：html, css, wordpress

我有一个我认为是 CSS 的问题，但我似乎找不到解决方法。我正在使用 WordPress 主题（可以在此处查看该站点：http: [//sencb.com](http://sencb.com)）。一切都按预期运行，除非屏幕尺寸小于 1050 像素宽。我知道大多数现代显示器都比这宽得多，但这仍然是我想找到的解决方法。问题是，当屏幕/浏览器窗口的宽度较小时，通常在 1050 像素左右，整个滚动内容侧（右侧）会在固定区域和导航菜单上向左移动。我已经尝试了几乎所有我能想到的东西，所以我希望这里有人能找到解决方法。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T02:21:30.190

问题是侧边栏使用的是固定位置。无论浏览器的宽度/高度和滚动坐标如何，侧边栏都将始终位于窗口中的相同位置。另一方面，内容区域自然移动并且能够出现在浏览器窗口空间的任何位置。有时它恰好与侧边栏重叠。

尝试添加`z-index: 300`并`#main-leftarea`查看是否适合您。

# cuda - 在 Cuda 中检查位数组的最佳方法是什么？

> ID：11529351
> 
> 赞同：-2
> 
> 时间：2012-07-17T19:18:57.407
> 
> 标签：cuda, bit-manipulation, bit

我需要启动 N 个线程（在一个块中）

这是代码，'e' 是 1024b 上的一个大数字。我需要将它复制到gpu上并一点一点地读取它。

主机代码：

```
unsigned char *__e;
BIGNUM *e = BN_new();
unsigned char exp[128];

//      e
i = cudaMalloc( (void**)&__e, 128* sizeof(unsigned char) );
if(i != cudaSuccess)
    printf("cudaMalloc __e FAIL! Code: %d\n", i);

BN_bn2bin128B(e, exp);   // copy data in exp

for(i=0; i<128; i++)
    exp[i] = reverse(exp[i]);

i = cudaMemcpy( __e, exp, 128* sizeof(unsigned char), cudaMemcpyHostToDevice);
if(i != cudaSuccess)
    printf("cudaMemcpy __e FAIL! Code: %d\n", i);

unsigned char reverse(unsigned char b) {
 b = (b & 0xF0) >> 4 | (b & 0x0F) << 4;
 b = (b & 0xCC) >> 2 | (b & 0x33) << 2;
 b = (b & 0xAA) >> 1 | (b & 0x55) << 1;
 return b;
} 
```

设备代码：

```
for(int i=0; i<1024; i++)
    if(ISBITSET(__e, i) == 1)
        //do something 
```

标题：

```
#define ISBITSET(x,i) ((x[i>>3] & (1<<(i&7)))!=0) 
```

不幸的是，ISBITSET 不接受与 __e 不同的任何内容，因此我无法检查 __e 本身的其他值

我该如何解决？或者，还有更好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T23:37:35.587

GPU 是 32 位机器，因此您需要一次处理 32 位的 1024 位，而不是 8 位。因此，您应该替换所有`unsigned char`并`unsigned int`相应地调整值。

GPU 有一个快速 PTX 指令，用于一次反转 32 位，因此您可能希望在 GPU 上实现它。该指令称为`brev`. 要使用它，您需要添加内联 PTX，如下所示（未经测试）：

```
asm("brev.b32 %0, %1;" : "=r"(dst_var) : "r"(src_var)); 
```

有关详细信息，请参阅 NVIDIA 的文档“在 CUDA 中使用内联 PTX 组件”。

```
for(int i=0; i<1024; i++)
    if(ISBITSET(__e, i) == 1)
        //do something 
```

此代码可能存在性能问题。假设有 50% 的机会打开一个位，您只能获得 50% 的可能性能，因为一半的线程将不得不等待而另一半执行`//do something`. 我想不出解决方法。您可能还想启动线程而不是循环。

> 不幸的是，ISBITSET 不接受与 __e 不同的任何内容，因此我无法检查 __e 本身的其他值

你能详细说明一下吗？`ISBITSET`宏对我来说看起来不错，看起来它可以处理任何无符号字符数组，就是这样`__e`。

# objective-c - 复选标记代码错误

> ID：11529358
> 
> 赞同：0
> 
> 时间：2012-07-17T19:19:36.243
> 
> 标签：objective-c, ios, uitableview, uikit

在我的`cellForRow`代码中，我有以下内容，并且收到一条错误消息，说明没有返回任何内容。我做错了什么？谢谢。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell* cell = [tableView cellForRowAtIndexPath:indexPath];
    if([self.checkedIndexPath isEqual:indexPath]) 
    { 
        cell.accessoryType = UITableViewCellAccessoryCheckmark;
    } 
    else
    { 
        cell.accessoryType = UITableViewCellAccessoryNone;
    } 
    return cell;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T19:30:26.103

这是一个无限循环：`UITableViewCell* cell = [tableView cellForRowAtIndexPath:indexPath];`

这应该是：

```
static NSString *reuseIdentifier = @"some_identifier";
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:reuseIdentifier];
if(cell == nil) {
    cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:reuseIdentifier] autorelease]
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T05:41:17.550

您`cellForRowAtIndexPath`将看起来像这样（对于最基本的表格视图）

```
- (UITableViewCell *) tableView :(UITableView *) tableView cellForRowAtIndexPath :(NSIndexPath *) indexPath
{
    static NSString *SimpleTableIdentifier = @"SimpleTableIdentifier ";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:SimpleTableIdentifier];
    if (cell == nil) {
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault 
                                       reuseIdentifier:SimpleTableIdentifier] autorelease];
    }

    NSUInteger row = [indexPath row];
    cell.textLabel.text = [listData objectAtIndex :row];
    cell.textLabel.font = [UIFont boldSystemFontOfSize:50];

    return cell;
} 
```

# dynamics-crm - 锁定上下文返回的记录？或者也许改变我的方法

> ID：11529360
> 
> 赞同：3
> 
> 时间：2012-07-17T19:19:46.120
> 
> 标签：dynamics-crm, dynamics-crm-2011

我不确定是否需要一种方法来锁定上下文返回的记录，或者只是需要一种新方法。

这是故事。我们目前有少量与我们的 CRM 集成的应用程序。其中一些打开 XrmServiceContext 并返回几千条记录以执行更新。这些脚本一直在调用 SaveChanges，但在上下文返回它们几分钟后，仍然会有接近结尾的帐户被保存。如果用户在此期间更新记录，他们的更改将被脚本覆盖。

有没有办法在上下文保存更新之前锁定记录，或者我应该采取更好的方法？

成套工具

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T20:58:31.750

在我看来，这类数据库事务问题是CRM目前最缺乏的。没有办法确保其他人不会胡乱使用您的数据，这在 CRM 中始终是最后一个赢家的世界。

话虽如此，我的建议是只更新您关心的属性。如果您要返回一个实体的所有列，那么当您更新该实体时，您可能会更新该实体的所有属性，即使您只更新了其中一个属性。

如果您正在处理的系统不能容忍最后一个获胜的心态，那么您最好不要使用 CRM。

**更新 1**

CRM 2015 SP1 及更高版本支持乐观更新。这允许使用版本号来确保自您检索记录以来没有人更新记录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T20:30:21.030

你有几个选择，这取决于你想做什么。首先，如果您可以将其中一些自动化流程转移到非工作时间，那么这是最好的选择。

另一种选择是逐个检索每条记录，而不是逐个检索 1000+。

如果您只更新检索到的记录的百分比，那么您最好在保存之前检查是否发生了更新（比较修改日期）。如果修改日期发生了变化，那么您需要进行一次检索然后保存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T19:30:47.013

起初，我会创建一个指示待处理操作的字段或状态，然后在表单 OnLoad 事件中使用 JScript 来警告/锁定表单。处理完成后，它可以清除标志。

# c# - 在 C# 中迭代 字典

> ID：11529367
> 
> 赞同：13
> 
> 时间：2012-07-17T19:20:11.343
> 
> 标签：c#, dictionary, iteration

```
var dict = new Dictionary<int, string>();
for (int i = 0; i < 200000; i++)
    dict[i] = "test " + i; 
```

我使用下面的代码迭代了这个字典：

```
foreach (var pair in dict)
    Console.WriteLine(pair.Value); 
```

然后，我用这个迭代它：

```
foreach (var key in dict.Keys)
    Console.WriteLine(dict[key]); 
```

第二次迭代减少了约 3 秒。我可以通过这两种方法获取键和值。我想知道的是第二种方法是否有缺点。由于我能找到[的最受好评的问题](https://stackoverflow.com/questions/141088/what-is-the-best-way-to-iterate-over-a-dictionary-in-c?rq=1 "遍历字典的最佳方法是什么？")不包括这种迭代字典的方式，我想知道为什么没有人使用它以及它如何更快地工作。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-17T19:30:25.697

您的时间测试有一些基本缺陷：

*   Console.Writeline 是一种 I/O 操作，它所花费的时间比内存访问和 CPU 计算多几个数量级。迭代时间的任何差异可能与此操作的成本相比相形见绌。这就像在铸铁炉子里测量硬币的重量。
*   你没有提到整个操作花了多长时间，所以说一个比另一个少花 3 秒是没有意义的。如果第一次运行需要 300 秒，第二次运行需要 303 秒，那么您就是在进行微优化。
*   你没有提到你是如何测量运行时间的。运行时间是否包括加载和引导程序集的时间？
*   您没有提到可重复性：您是否多次运行这些操作？几百次？在不同的订单？

这是我的测试。请注意我如何尽我最大的努力确保迭代方法是唯一改变的东西，并且我包括一个控件来查看纯粹因为`for`循环和分配而占用了多少时间：

```
void Main()
{
    // Insert code here to set up your test: anything that you don't want to include as
    // part of the timed tests.
    var dict = new Dictionary<int, string>();
    for (int i = 0; i < 2000; i++)
        dict[i] = "test " + i;
    string s = null;
    var actions = new[]
    {
        new TimedAction("control", () => 
        {
    for (int i = 0; i < 2000; i++)
            s = "hi";
        }),
        new TimedAction("first", () => 
        {
            foreach (var pair in dict)
            s = pair.Value;
        }),
        new TimedAction("second", () => 
        {
            foreach (var key in dict.Keys)
            s = dict[key];
        })
    };
    TimeActions(100, // change this number as desired.
        actions);
}

#region timer helper methods
// Define other methods and classes here
public void TimeActions(int iterations, params TimedAction[] actions)
{
    Stopwatch s = new Stopwatch();
    foreach(var action in actions)
    {
        var milliseconds = s.Time(action.Action, iterations);
        Console.WriteLine("{0}: {1}ms ", action.Message, milliseconds);
    }

}

public class TimedAction
{
    public TimedAction(string message, Action action)
    {
        Message = message;
        Action = action;
    }
    public string Message {get;private set;}
    public Action Action {get;private set;}
}

public static class StopwatchExtensions
{
    public static double Time(this Stopwatch sw, Action action, int iterations)
    {
        sw.Restart(); 
        for (int i = 0; i < iterations; i++)
        {
            action();
        }
        sw.Stop();

        return sw.Elapsed.TotalMilliseconds;
    }
}
#endregion 
```

### 结果

> 控制：1.2173ms
> 第一：9.0233ms
> 第二：18.1301ms

所以在这些测试中，使用索引器所花费的时间大约是迭代键值对的两倍，这是我所期望的*。如果我将条目数和重复次数增加一个数量级，这将保持大致成比例，如果我以相反的顺序运行这两个测试，我会得到相同的结果。

* 为什么我会期待这个结果？Dictionary 类可能在内部将其条目表示为 KeyValuePairs，因此当您直接迭代它时，它真正要做的就是遍历其数据结构一次，将每个条目交给调用者。如果您*只迭代 Keys*，它仍然必须找到每个 KeyValuePair，并为您提供`Key`财产，因此仅此一步将花费与首先迭代它大致相同的金额。然后你必须调用索引器，它必须计算提供的键的哈希值，跳转到正确的哈希表存储桶，并对在那里找到的任何 KeyValuePairs 的键进行相等性检查。这些操作并不是非常昂贵，但是一旦你做了 N 次，它的成本大致与你再次迭代内部哈希表结构一样昂贵。

# ios - 使用 requestWithGraphPath 制作的 Facebook 帖子中指向本机应用程序的链接无效

> ID：11529368
> 
> 赞同：0
> 
> 时间：2012-07-17T19:20:33.060
> 
> 标签：ios, facebook, facebook-graph-api, hyperlink, facebook-timeline

我有一个本机 iOS 应用程序，它使用以下方式在用户时间轴上发布帖子：

```
[facebook requestWithGraphPath:@"me/feed" andParams:params andHttpMethod:@"POST" andDelegate:self]; 
```

当帖子在 Facebook 上显示时，它的帖子信息是“XYZ 分钟前通过 MY_APP_NAME_HERE”，其中 MY_APP_NAME_HERE 是一个链接。当我单击该链接时，我会被定向到一个页面[http://www.facebook.com/apps/application.php?id=my_app_id](http://www.facebook.com/apps/application.php?id=my_app_id)，上面写着“页面未找到”。

我已向 Facebook 应用中心提交了一个应用详细信息页面，但该页面位于[http://www.facebook.com/appcenter/my_app_namespace?preview=1&locale=en_US](http://www.facebook.com/appcenter/my_app_namespace?preview=1&locale=en_US)。

如何让这个`MY_APP_NAME_HERE`链接在我的 Facebook 墙贴上工作？我是否可以在 Xcode 中控制它（我猜没有）？这个链接应该去哪里...到我在 Facebook 应用中心的应用详细信息页面？我没有看到它是因为我的详细信息页面尚未获得 Facebook 批准吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T16:46:10.410

如果您希望将链接引导回您的 iOS 应用程序，您可以在 Facebook 应用程序仪表板中进行控制：

转到：[https](https://developers.facebook.com/apps/) ://developers.facebook.com/apps/ 然后你的应用程序，编辑设置并打开： - 为 iOS SSO 配置 - iOS 本机深度链接

有关链接选项的更多信息，请参阅： [https ://developers.facebook.com/blog/post/2012/02/21/improving-app-distribution-on-ios/](https://developers.facebook.com/blog/post/2012/02/21/improving-app-distribution-on-ios/)

# java - 进入不在调试模式下工作的 Eclipse

> ID：11529370
> 
> 赞同：1
> 
> 时间：2012-07-17T19:20:37.707
> 
> 标签：java, eclipse, debugging

我正在做一个java项目。我在调试模式下打开了项目，并通过了程序。我陷入困境的一件事是，如果我进入一个特定的功能，它就不会进入它。相反，如果我在该函数中放置一个断点，那么程序就会执行该点。我正在使用 Eclipse 3.7.2。我不知道为什么 eclipse 会表现出这样的行为。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T19:30:52.660

dystroy 已经在评论中说我打算在这个答案中说什么：我遇到这种情况的最常见原因是实际运行时类实例是动态代理，通常来自休眠、Spring 或模拟对象框架（测试时），例如 Mockito。在这些情况下，您通常必须完全按照您所做的操作，并在要进入的方法中放置一个断点。

# string - 在 AS3 中分隔字符串

> ID：11529371
> 
> 赞同：2
> 
> 时间：2012-07-17T19:20:41.400
> 
> 标签：string, actionscript-3, flash, actionscript

如果我有一个字符串，例如“Tiger”，我能写出什么来返回 T + i + g + e + r？如果我可以将每个字母放在一个数组中，那就太好了。

我需要这个，因为我正在编写一个程序来分析输入的字符串并确定重复字母出现的次数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T19:22:24.177

尝试使用空分隔符的[**String.split()方法：**](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/String.html#split%28%29)

```
var str:String = "Tiger";
var letters:Array = str.split('');
//result->  ["T","i","g","e","r"] 
```

# c# - 链接 c++ 和 c#

> ID：11529379
> 
> 赞同：2
> 
> 时间：2012-07-17T19:21:10.153
> 
> 标签：c#, c++

我正在尝试链接 C++ 定义的库，以便在 C# 中使用它们。我有一个`CString PastUsed`在 C++ 中保存一个变量，我试图在 C# 中访问它。

`PastUsed`在 C++ 中，我将“.odl”文件中 的变量值存储为`BSTR PastUsed`. 我`DISP_PROPERTY_EX`用作调度地图。

```
DISP_PROPERTY_EX(Cpctr, "PastUsed", GetPastUsed, SetPastUsed, VT_BSTR). 
```

我从 中返回 String 变量的值`GetPastUsed`。但是，我不认为这个值被保存在`PastUsed`（如.odl 中定义的那样）中。我假设正在发生这种情况，因为当我尝试`PastUsed`在 C# 中访问这个变量（来自 .odl）时，我得到了一个 com 异常。

我在 c# 中检索 C++ 定义变量的代码是：

```
private void GetPastUsedDes_Click(Object eventSender, EventArgs eventArgs) 
{
    if (CheckInvalidButtonClick())
    { 
        return;
    } 
    PrintLine("Dumping past Used"); 
    AxPBSPRINTLib.AxPBSprint sPrint = mPBSPrintCtrl; 
    String str = mPBSPrintCtrl.PastUsed;
    String str = Print.PastUsed;
} 
```

（这里是c#中的`PastUsed`一个）是相同的字符串，它应该包含`Pastused`c++中保存的变量（如我的第一篇文章中所述）。一旦它在 c# 中遇到 String str 的断点，我就会得到异常：

```
Print.PastUsed = 'Print.PastUsed' threw an exception of type 'System.Runtime.InteropServices.COMException' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T19:27:13.630

对我来说，它看起来像 COM 代码。

您将使用 COM 互操作（通过引用类型库并为 COM 接口使用生成的互操作类）。

看

*   [COM 互操作第 1 部分：C# 客户端教程 (C#)](http://msdn.microsoft.com/en-us/library/aa645736%28v=vs.71%29.aspx)
*   [COM 互操作在 C# 4.0 中变得更好](http://www.devx.com/dotnet/Article/42590)

# haskell - `data`声明中的`!`是什么意思

> ID：11529381
> 
> 赞同：1
> 
> 时间：2012-07-17T19:21:24.143
> 
> 标签：haskell

> **可能重复：**
> [Haskell 声明中的感叹号是什么意思？](https://stackoverflow.com/questions/993112/what-does-the-exclamation-mark-mean-in-a-haskell-declaration)

和有什么区别

```
data Tree a = Leaf | Bin a !(Tree a) !(Tree a) 
```

和

```
data Tree a = Leaf | Bin a (Tree a) (Tree a) 
```

# javascript - d3 - 将数据附加到轴以重新缩放

> ID：11529389
> 
> 赞同：2
> 
> 时间：2012-07-17T19:21:57.490
> 
> 标签：javascript, d3.js

我想在显示实际值和百分比之间切换。目前数据是从 csv 文件导入的，我处理 csv 以找到数据的域并很好地显示图表。我可以切换到显示百分比，因为轴域变为 0 到 100，但我希望能够切换回实际数据域而无需重新处理 csv 文件。

是否可以将数据附加到轴上以便我可以检索它？像这样的东西：

```
 vis.append("g")
                .data([calculated_y_domain, [0, 100]])
                .attr("class", "axis yaxis")
                .attr("transform", "translate("+padding+",0)")
                .call(yAxis); 
```

还是有更好的方法？

这里有一个示例[http://bl.ocks.org/3131368](http://bl.ocks.org/3131368) 我正在整理中，但我这样做的方式将取决于切换轴域的最佳方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T21:05:45.273

您可以创建两个轴组件，它们利用您的两个比例（百分比和值），并在转换数据时在两个轴之间转换。

```
var xAxisValue = d3.svg.axis()
    .scale(valueScale)
    .orient("bottom");
var xAxisPercentage = d3.svg.axis()
    .scale(percentageScale)
    .orient("bottom");

d3.select("svg").append("g")
    .attr("class", "x-axis")
    .call(xAxisValue);

/* More code... */

// At the point you want to switch...
var dur = 1500;
d3.select(".x-axis").transition().duration(dur).call(xAxisPercentage); 
```

# cross-domain - socket.io 和跨域连接

> ID：11529394
> 
> 赞同：1
> 
> 时间：2012-07-17T19:22:23.737
> 
> 标签：cross-domain, xss, socket.io, same-origin-policy

正如[他们的常见问题解答](http://socket.io/#faq)所述，socket.io 在每个浏览器上都支持跨域连接。有人可以告诉我，如果跨域通信使用特定的传输机制，如长轮询，或者它是否适用于所有支持的机制。另一件事是`var socket = io.connect('http://localhost');`。这用于客户端连接到 socket.io 服务器。由于这通过 WebSockets、longpolling 等建立连接。上述连接方法本身使用常规的 http 请求。至少这个请求不会违反同源政策吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T03:48:34.743

我刚刚测试了它`IE 8`并且`FireFox 14`：

跨域适用于

*   jsonp
*   xhr-轮询
*   网络套接字
*   闪光灯插座

跨域不适用

*   html文件

`htmlfile`顺便说一句，一般只适用于 IE，`websocket`而不适用于 IE（<10）。`flashsocket`在支持的浏览器中不起作用`websocket`，这就是为什么我只在 IE8 中测试了那个。

# php - 即使没有协议，也将 url 从文本转换为链接

> ID：11529396
> 
> 赞同：6
> 
> 时间：2012-07-17T19:22:30.980
> 
> 标签：php, url, preg-replace

假设 $content 是 textarea 的内容

```
/*Convert the http/https to link */
     $content = preg_replace('!((https://|http://)+[a-z0-9_./?=&-]+)!i', '<a target="_blank" href="$1">$1</a> ', nl2br($_POST['helpcontent'])." ");
/*Convert the www. to link prepending http://*/
     $content = preg_replace('!((www\.)+[a-z0-9_./?=&-]+)!i', '<a target="_blank" href="http://$1">$1</a> ', $content." "); 
```

这适用于链接，但意识到当图像在文本中时它会破坏标记......

我现在正在尝试这样：

```
$content = preg_replace('!\s((https?://|http://)+[a-z0-9_./?=&-]+)!i', ' <a href="$1">$1</a> ', nl2br($_POST['content'])." ");
$content = preg_replace('!((www\.)+[a-z0-9_./?=&-]+)!i', '<a target="_blank" href="http://$1">$1</a> ', $content." "); 
```

像图像一样受到尊重，但问题是带有 http:// 或 https:// 格式的 url 现在不会被转换..：

> google.com -> 未转换（如预期）
> 
> www.google.com -> 转换良好
> 
> [http://google.com](http://google.com) -> 未转换（意外）
> 
> [https://google.com](https://google.com) -> 未转换（意外）

我错过了什么？

-编辑-

当前几乎可行的解决方案：

```
$content = preg_replace('!(\s|^)((https?://)+[a-z0-9_./?=&-]+)!i', ' <a href="$2" target="_blank">$2</a> ', nl2br($_POST['content'])." ");
$content = preg_replace('!(\s|^)((www\.)+[a-z0-9_./?=&-]+)!i', '<a target="_blank" href="http://$2"  target="_blank">$2</a> ', $content." "); 
```

这里的问题是，如果这是输入：

> www.funcook.com [http://www.funcook.com](http://www.funcook.com) https://www.funcook.com funcook.com [http://funcook.com](http://funcook.com) https://funcook.com

我想要的所有 url（所有，除了 name.domain）都按预期转换，但这是输出

> www.funcook.com [http://www.funcook.com](http://www.funcook.com) https://www.funcook.com ；funcook.com [http://funcook.com](http://funcook.com) https://funcook.com

注意 ; 已插入，知道为什么吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-17T19:32:00.167

尝试这个：

```
preg_replace('!(\s|^)((https?://|www\.)+[a-z0-9_./?=&-]+)!i', ' <a href="$2">$2</a> ',$text); 
```

它将获取以 http:// 或 www 开头的链接。

[例子](http://codepad.org/6Dgk0yuC "例子")

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T19:30:20.587

你不能100%。因为可能有诸如`stackoverflow.com`没有的链接`www.`。

如果您只针对这些链接：

```
!(www\.\S+)!i 
```

应该对你足够好。

* * *

编辑：至于您的最新问题，至于为什么 http 链接没有被转换但 https 可以，您的第一个模式只搜索`https://`，或者`http://.`不是这种情况。通过替换来简化它：

```
(https://|http://\.) 
```

和

```
(https?://) 
```

这将使`s`可选。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T04:12:50.333

我有类似的问题。这是帮助我的功能。也许它会满足您的需求：

```
function clHost($Address) { 
   $parseUrl = parse_url(trim($Address)); 
   return  str_replace ("www.","",trim(trim($parseUrl[host] ? $parseUrl[host].$parseUrl[path] :  $parseUrl[path]),'/'));
} 
```

此函数将返回没有协议和“www”的域，因此您可以稍后自己添加它们。

例如：

```
$url = "http://www.". clHost($link); 
```

我是这样做的，因为我找不到好的正则表达式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-17T19:38:57.013

添加超链接的另一种方法是，您可以获取要为链接解析的文本，并将其分解为一个数组。然后使用 foreach （非常快速的函数 - [http://www.phpbench.com/](http://www.phpbench.com/)）循环并更改以 http://、https:// 或 www. 开头或以 .com/ 结尾的任何内容。 org/etc 到一个链接。

我在想也许是这样的：

```
$userTextArray = explode(" ",$userText);
foreach( $userTextArray as &$word){
    //if statements to test if if it starts with www. or ends with .com or whatever else
    //change $word so that it is a link
} 
```

您的更改将反映在数组中，因为您在 foreach 语句中的 $userText 之前有“&”。现在只需将数组内爆回字符串即可。

这在我的脑海中是有道理的......但我不能 100% 确定这就是你要找的东西

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-30T13:37:10.763

`\s((https?://|www.)+[a-z0-9_./?=&-]+)`

问题是您的起始 \s 强制匹配以空格开头，因此，如果您没有该起始空格，则匹配失败。reg exp 很好（没有 \s），但为避免替换图像，您需要添加一些内容以避免匹配它们。

如果图像是纯 html 使用这个： `(?<!src=")((https?://|www.)+[a-z0-9_./?=&-]+)`

这将在 url 之前查找 src=" 以忽略它。

如果您使用其他标记，请告诉我，我会尝试找到另一种方法来避免图像。

# internet-explorer - Jquery .live() 事件在 Firefox 和 IE 上不起作用

> ID：11529397
> 
> 赞同：1
> 
> 时间：2012-07-17T19:22:41.537
> 
> 标签：internet-explorer, firefox, jquery

我有现场活动提交并点击：

```
<form class='myform'>
    <input type='text' name='fruit'>
</form>
<a href='#' class='formSubmit'>Submit</a> 
```

我有 jquery 调用表单通过 Enter 或单击标签提交

```
$('a.formSubmit').live('click', function(){
    $('form.myform').submit();

    return false;
});

$('form.myform').live('submit', function(){
    //conditional statements here
}); 
```

所以问题是，我的 jquery 脚本在除 IE 和 FireFox 之外的所有浏览器上都能正常工作。似乎 .live() 方法是原因。因为当我删除 live() 方法并执行它时，只需 click() 方法它就会起作用。现在我需要在 live() 方法上执行此操作，因为我将具有新附加元素和表单的功能。有没有办法让它在 Firefox 和 IE 上运行？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:25:16.933

[http://api.jquery.com/on/](http://api.jquery.com/on/)

```
$('#not_dynamically_generated_parent').on('click','a.formSubmit', function(){
    $('form.myform').submit();

    return false;
});

$('#not_dynamically_generated_parent').on('submit','form.myform', function(){
    //conditional statements here
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T20:03:51.547

哈，我找到了解决方案。我的嫌疑人完全错了。jquery live() 方法工作正常，唯一使脚本无法工作的是，`event.preventDefault();`如果你在事件方法中有类似的东西，它不会在 firefox 上工作，即......感谢贡献的人。

# ruby-on-rails - 未知属性：user_id

> ID：11529405
> 
> 赞同：14
> 
> 时间：2012-07-17T19:23:03.603
> 
> 标签：ruby-on-rails, ruby, activerecord

我收到错误未知属性：执行 current_user.stories.build 期间的 user_id

```
class User < ActiveRecord::Base
  has_many :stories, class_name: 'Story', foreign_key: 'user_id', dependent: :destroy
  ...

class Story < ActiveRecord::Base
  belongs_to :user, class_name: 'User', foreign_key: 'user_id'
  ... 
```

架构.rb

```
create_table "stories", :force => true do |t|
    t.string   "responsible"
    t.string   "descr"
    t.string   "state"
    t.datetime "created_at",  :null => false
    t.datetime "updated_at",  :null => false
  end

  create_table "users", :force => true do |t|
    t.string   "email"
    t.string   "password_digest"
    t.datetime "created_at",      :null => false
    t.datetime "updated_at",      :null => false
    t.string   "name"
  end 
```

它不包含“user_id”字段。有任何想法吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-07-17T19:34:51.937

Kulbir 是正确的，您需要`user_id`在表中定义一列`stories`，但没有解释这样做的方法。

进行该更改的正确方法是创建新的迁移。按照惯例，它应该`add_user_id_to_stories`按如下方式调用和创建（假设您使用的是 Rails 3+）：

```
rails generate migration add_user_id_to_stories 
```

如果你运行它，它实际上应该生成一个已经包含你需要做的改变的迁移，它应该是这样的：

```
add_column :stories, :user_id, :integer 
```

顺便说一句，当您遵循有关关联命名的 Rails 约定时，您实际上可以跳过很多额外的规范。在`User`模型中，您可以指定 just`has_many :stories`并在`Story`模型中指定`belongs_to :user`。Rails 将假定您指定的类名和外键相同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T19:28:20.057

您的表中应该有一个如下所示的`user_id`字段`stories`来定义模型中的关联。

 ~~~~```
create_table "stories", :force => true do |t|
    t.integer  "user_id"
    t.string   "responsible"
    t.string   "descr"
    t.string   "state"
    t.datetime "created_at",  :null => false
    t.datetime "updated_at",  :null => false
  end
  ...
end 
```~~  ~~**编辑**

查看艾米丽的答案以获取详细说明。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-16T23:30:51.330

您应该使用新语法并将字段类型作为符号传递

```
add_column :stories, :user_id, :integer 
```~~~~

# iphone - iphone 电子邮件发布表单数据

> ID：11529414
> 
> 赞同：1
> 
> 时间：2012-07-17T19:23:48.237
> 
> 标签：iphone, forms, email, post

我在电子邮件中有一个 html 表单（我知道这不是最佳做法）。我可以让表单通过 gmail 中的 POST 传输数据，但是，在 iphone 邮件中，它的 POST 数组是空的。有没有人对此有任何见解，可能是安全设置等？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T20:34:38.757

许多电子邮件客户端阻止从电子邮件中发送 POST 请求。允许 POST 请求在很多方面都是危险的。它可以使网络钓鱼和 XSS 电子邮件更加恶意。如果您希望您的电子邮件在每个电子邮件客户端中都能正常运行（这很难），您应该省略 POST 请求。如果可能，请改为通过将查询字符串附加到 URL 来执行 GET。那将有 100% 的支持，所以希望你能完成你想做的事情。

# ruby - 当同时使用类继承和模块包含时，如何在初始化方法中调用 super？

> ID：11529415
> 
> 赞同：0
> 
> 时间：2012-07-17T19:23:49.913
> 
> 标签：ruby, inheritance, superclass

如果我有一个与类继承一起包含的模块，那么外观路径如何决定在哪里调用“super”。我的预感是默认情况下它将使用模块中的初始化方法。它是否正确？如果是这样，我如何明确告诉代码使用继承类中的初始化方法？

下面贴出一个例子：

我希望 Employee 类从 Other 而不是 Subject 继承初始化。

```
 module Subject
    def initialize
      @observers = []
    end
  end

  class Other
    def initialize
      @other_stuff = []
    end
  end

  class Employee < Other
    include Subject 

    attr_reader :name

    def initialize(name)
     super()
    end
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T02:16:47.500

> 我的预感是默认情况下它将使用模块中的初始化方法。

正确的。如果一个类包含一个模块，那么该模块的方法将替换继承的同名方法。

> 如果是这样，我如何明确告诉代码使用继承类中的初始化方法？

您可能最好进行重构，以免遇到此问题。

但是，有几种方法可以让**Other**的 initialize 方法被调用而不是**Subject**的。

像这样的东西怎么样：

```
module Subject
  def initialize
    puts "subject initialize"
    @observers = []
  end
end

class Other
  def initialize
    puts "other initialize"
    @other_stuff = []
  end
end

class Employee < Other

  alias_method :other_initialize, :initialize

  include Subject

  attr_reader :name

  def initialize(name)
    other_initialize
  end
end

Employee.new('test') 
```

如果你运行它，你会看到**Other**的初始化方法被调用了。然而，编写这样的代码并不是一个好主意。

# c# - 在 C# 中动态更新 asp.net 中的表控件

> ID：11529417
> 
> 赞同：1
> 
> 时间：2012-07-17T19:23:52.893
> 
> 标签：c#, asp.net

我有一个项目，我需要`Table`根据`button_click`事件动态更新控件。

每次`Button`单击 时，`Table`都会根据不同的输入自行重置。输入来自客户端上传的文件。（我使用文件`Uploader`控件执行此操作）。客户端基本上可以每次上传不同的文件，然后根据文件的输入 单击`Button`以重置。`Table`

```
try
{    
    Upload1003.PostedFile.SaveAs(@"path" + filename);
    parseAnswer = parse.parse(@"path", filename);
    Span1.InnerHtml = "File Upload Sucessful";     
}

catch (Exception)
{
    Span1.InnerHtml = "File Upload Error";
};

int col = 3;
int row = parseAnswer.getTotalItem();
Create1003Table(col, row, parseAnswer); 
```

`Table`唯一适用于第一次点击。第二次点击给我一个错误：

`Operation is not valid due to the current state of the object`

我刚开始学习`C# and ASP.Net`。所以我不确定是什么导致了这个错误。

# xna - XNA 3 到 XNA 4 的内容管理差异

> ID：11529420
> 
> 赞同：0
> 
> 时间：2012-07-17T19:24:02.260
> 
> 标签：xna, xna-4.0, xna-3.0

在 XNA 4 中，Content 结构似乎与 3 中的不同（默认情况下，新的 Content 项目与我创建的项目一起出现）。我基本上只是想了解结构变化的目的是什么。我是否需要将我的所有内容都放在“内容项目”中？它只是应该帮助我更整洁吗？这就是人们谈论“内容管道”时的意思吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:33:10.820

XNA 4 内容项目是将存储游戏中所有资产（纹理、声音等）的项目

[正如MSDN](http://msdn.microsoft.com/en-us/library/bb447745.aspx)所描述的，内容管道是`"A set of processes applied when a game that includes art assets is built. The process starts with an art asset in its original form as a file, and continues to its transformation as data that can be retrieved and used within an XNA Game Studio game through the XNA Framework Class Library. "`

可以使用 ContentManager 加载内容。[在这里](http://www.xnadevelopment.com/tutorials/addinganimagetothegameproject/AddingAnImageToTheGameProject.shtml)您可以找到使用它的基础知识。

# flash - 柔性 项目渲染指数

> ID：11529423
> 
> 赞同：0
> 
> 时间：2012-07-17T19:24:08.977
> 
> 标签：flash, apache-flex, indexing, adobe, itemrenderer

Flex (4.6) 中的项目渲染器中是否有一种方法可以在`<s:List>`项目渲染器本身内识别列表中特定项目的索引？

我尝试使用`itemIndex`类的属性，但它总是返回零。另外，[这个关于 SO 的例子](https://stackoverflow.com/questions/5263253/flex-how-to-show-the-item-index-in-my-item-renderer)给了我几个运行时错误。

感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:53:05.733

主要应用：

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application
    width="100%"
    height="100%"
    xmlns:fx="http://ns.adobe.com/mxml/2009" 
    xmlns:s="library://ns.adobe.com/flex/spark" 
    xmlns:mx="library://ns.adobe.com/flex/mx">
    <s:List itemRenderer="IndexedItemRenderer">
        <s:dataProvider>
            <s:ArrayList>
                <fx:String>Item A</fx:String>
                <fx:String>Item B</fx:String>
                <fx:String>Item C</fx:String>
                <fx:String>Item D</fx:String>
                <fx:String>Item E</fx:String>
            </s:ArrayList>
        </s:dataProvider>
    </s:List>
</s:Application> 
```

IndexedItemRenderer 项目渲染器：

```
<?xml version="1.0" encoding="utf-8"?>
<s:ItemRenderer
    xmlns:fx="http://ns.adobe.com/mxml/2009" 
    xmlns:s="library://ns.adobe.com/flex/spark" 
    xmlns:mx="library://ns.adobe.com/flex/mx" 
    autoDrawBackground="true">
    <s:Label text="{itemIndex + 1}. {data}"/>
</s:ItemRenderer> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T19:57:21.753

我只是注意到这`itemIndex`不起作用，因为它的值尚未在列表创建的生命周期中设置。

在项目渲染器中，我正在侦听一个`addedToStage`事件并`itemIndex`在其处理程序中使用。一旦我将`addedToStage`事件更改为`creationComplete`，`itemIndex`则具有适当的值。

希望对某人有所帮助。

# python - 用 nltk 实现 idf

> ID：11529424
> 
> 赞同：1
> 
> 时间：2012-07-17T19:24:11.427
> 
> 标签：python, nlp, nltk, tf-idf

给定句子：“the quick brown fox jumped over the lazy dog”，我想得到一个 nltk 语料库中每个单词的频率得分（哪个语料库是最通用/最全面的）

编辑：

这个问题与这个问题有关：[python nltk keyword extract from sentence](https://stackoverflow.com/questions/11406657/python-nltk-keyword-extraction-from-sentence) where @adi92 建议使用 idf 的技术来计算单词的“稀有度”。我想看看这在实践中会是什么样子。这里更广泛的问题是，你如何计算一个单词在英语中的稀有度。我很欣赏这是一个很难解决的问题，但是 nltk idf （使用诸如 brown 或 reuters 语料库之类的东西？？）可能会让我们成为其中的一部分？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T20:49:17.583

如果你想知道词频，你需要一个词频表。单词根据文本类型具有不同的频率，因此最佳频率表*可能*基于特定领域的语料库。

如果你只是在胡闹，很容易随机选择一个语料库并计算单词——使用`<corpus>.words()`和 nltk's `FreqDist`，和/或查看 NLTK 书了解详细信息。

但是如果要认真使用，请不要自己计算单词：如果您对特定领域不感兴趣，请获取一个大词频表。那里有数以万计的（显然这是语料库创建者首先想到的），其中最大的可能是 google 编译的“1-gram”表。[您可以在http://books.google.com/ngrams/datasets](http://books.google.com/ngrams/datasets)下载它们

# android - 安卓加载圈

> ID：11529426
> 
> 赞同：1
> 
> 时间：2012-07-17T19:24:30.460
> 
> 标签：android, progress-bar

**我需要在当前布局上方**的半透明背景上显示标准加载圆圈（带有背景和按钮等）。我找到了 ProgressBar 以及它是如何工作的，但我需要在现有布局上渲染它，这就是问题所在。更清楚一点 - 想象一下带有一些图像和按钮的登录屏幕，也就是“注册”。单击时，我需要显示部分可见的黑色背景和一个加载圆圈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:29:06.190

使用 a `RelativeLayout`，它将允许您有重叠`View`的 s，查看此链接：

[http://developer.android.com/reference/android/widget/RelativeLayout.html](http://developer.android.com/reference/android/widget/RelativeLayout.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T19:29:08.770

我认为您正在寻找带有加载动画的模态对话框之类的东西...

看看这个... [http://developer.android.com/guide/topics/ui/dialogs.html#ProgressDialog](http://developer.android.com/guide/topics/ui/dialogs.html#ProgressDialog)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T19:32:11.087

试试看这是否有效（将其用作内部类）

```
 private class executeHospitalNameGet extends AsyncTask<String, Void, Void> {  
        private ProgressDialog Dialog = new ProgressDialog(SettingsActivity.this); 

        private Context mContext;

        public executeHospitalNameGet(Context context) {
            mContext = context;
        }

        protected void onPreExecute() {  
            Dialog.setMessage("Getting Hospitals...");  

            Dialog.setTitle("Requesting Hospital Name");
            Dialog.show();  
        }  

        protected Void doInBackground(String... urls) {  
        //DO WORK HERE
            return null;
        }  

        protected void onPostExecute(Void unused) {  
                Dialog.dismiss();
        }  

    } 
```

你会用这个来称呼它

```
new executeHospitalNameGet(getApplicationContext()).execute(); 
```

# python - 为什么 Python 说这个 Netscape cookie 文件无效？

> ID：11529428
> 
> 赞同：8
> 
> 时间：2012-07-17T19:24:32.450
> 
> 标签：python, cookies

我正在编写一个[Google Scholar](https://en.wikipedia.org/wiki/Google_Scholar)解析器，基于[这个答案](https://stackoverflow.com/a/11485040/869912)，我在获取 HTML 之前设置了 cookie。这是我的`cookies.txt`文件的内容：

```
# Netscape HTTP Cookie File
# http://curlm.haxx.se/rfc/cookie_spec.html
# This file was generated by libcurl! Edit at your own risk.

.scholar.google.com     TRUE    /       FALSE   2147483647      GSP     ID=353e8f974d766dcd:CF=2
.google.com     TRUE    /       FALSE   1317124758      PREF    ID=353e8f974d766dcd:TM=1254052758:LM=1254052758:S=_biVh02e4scrJT1H
.scholar.google.co.uk   TRUE    /       FALSE   2147483647      GSP     ID=f3f18b3b5a7c2647:CF=2
.google.co.uk   TRUE    /       FALSE   1317125123      PREF    ID=f3f18b3b5a7c2647:TM=1254053123:LM=1254053123:S=UqjRcTObh7_sARkN 
```

这是我用来获取 HTML 的代码：

```
import http.cookiejar
import urllib.request, urllib.parse, urllib.error

def get_page(url, headers="", params=""):
    filename = "cookies.txt"
    request = urllib.request.Request(url, None, headers, params)
    cookies = http.cookiejar.MozillaCookieJar(filename, None, None)
    cookies.load()
    cookie_handler = urllib.request.HTTPCookieProcessor(cookies)
    redirect_handler = urllib.request.HTTPRedirectHandler()
    opener = urllib.request.build_opener(redirect_handler,cookie_handler)
    response = opener.open(request)
    return response

start = 0
search = "Ricardo Altamirano"
results_per_fetch = 20
host = "http://scholar.google.com"
base_url = "/scholar"
headers = {'User-Agent': 'Mozilla/5.0 (Windows NT 6.1; U; ru; rv:5.0.1.6) Gecko/20110501 Firefox/5.0.1 Firefox/5.0.1'}
params = urllib.parse.urlencode({'start' : start,
                                 'q': '"' + search + '"',
                                 'btnG' : "",
                                 'hl' : 'en',
                                 'num': results_per_fetch,
                                 'as_sdt' : '1,14'})

url = base_url + "?" + params
resp = get_page(host + url, headers, params) 
```

完整的追溯是：

```
Traceback (most recent call last):
  File "C:/Users/ricardo/Desktop/Google-Scholar/BibTex/test.py", line 29, in <module>
    resp = get_page(host + url, headers, params)
  File "C:/Users/ricardo/Desktop/Google-Scholar/BibTex/test.py", line 8, in get_page
    cookies.load()
  File "C:\Python32\lib\http\cookiejar.py", line 1767, in load
    self._really_load(f, filename, ignore_discard, ignore_expires)
  File "C:\Python32\lib\http\cookiejar.py", line 1997, in _really_load
    filename)
http.cookiejar.LoadError: 'cookies.txt' does not look like a Netscape format cookies file 
```

我四处寻找有关 Netscape cookie 文件格式的文档，但找不到任何能说明问题的东西。是否需要包含换行符？为了以防万一，我将行尾更改为 Unix 样式，但这并没有解决问题。我能找到的最接近的规范是[this](http://xiix.wordpress.com/2006/03/23/mozillafirefox-cookie-format/)，它并不表明我缺少任何东西。最后四行中每一行的字段由制表符分隔，而不是空格，其他所有内容对我来说都是正确的。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-18T07:47:31.590

我在您的示例代码或 cookies.txt 文件的副本中看不到任何明显错误的内容。

我检查了[`MozillaCookieJar._really_load`方法](http://hg.python.org/cpython/file/5470dc81caf9/Lib/http/cookiejar.py#l1989)的源代码，它抛出了你看到的异常。

这个方法做的第一件事是读取你指定的文件的第一行（使用`f.readline()`）并使用它[`re.search`](http://docs.python.org/py3k/library/re.html#re.search)来查找正则表达式模式`"#( Netscape)? HTTP Cookie File"`。这就是您的文件失败的原因。

*看起来*您肯定`cookies.txt`会匹配该格式，因此您看到的错误非常令人惊讶。

请注意，您的文件是通过之前的简单[`open(filename)`调用](http://docs.python.org/py3k/library/functions.html#open)打开的，因此它将以文本模式打开并支持通用行结束，这意味着您在 Windows 上运行它并不重要。`\n`无论文件本身使用什么换行约定，代码都会看到换行符终止的字符串。

在这种情况下，我要做的是*三次检查*文件的第一行是否正确。它需要包含“#HTTP Cookie File”或“#Netscape HTTP Cookie File”（只有空格，没有制表符，单词之间，大小写匹配）。使用 python 提示进行测试：

```
>>> f = open('cookies.txt')
>>> line = f.readline()
>>> line
'# Netscape HTTP Cookie File\n'
>>> import re
>>> re.search("#( Netscape)? HTTP Cookie File", line)
<_sre.SRE_Match object at 0x10fecfdc8> 
```

当我在提示符下键入时，Python 将行表示回显给我`line`，包括`\n`换行符。任何诸如制表符或 unicode 零宽度空格之类的意外都会显示为转义码。我还验证了`cookiejar`代码使用的正则表达式是否匹配。

您还可以使用[`pdb`python 调试器](http://docs.python.org/py3k/library/pdb.html)来验证`http.cookiejar`模块的实际作用：

```
>>> import pdb
>>> import http.cookiejar
>>> jar = http.cookiejar.MozillaCookieJar('cookies.txt')
>>> pdb.run('jar.load()')
> <string>(1)<module>()
(Pdb) s
--Call--
> /opt/local/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/http/cookiejar.py(1759)load()
-> def load(self, filename=None, ignore_discard=False, ignore_expires=False):
(Pdb) s
> /opt/local/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/http/cookiejar.py(1761)load()
-> if filename is None:
(Pdb) s
> /opt/local/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/http/cookiejar.py(1762)load()
-> if self.filename is not None: filename = self.filename
(Pdb) s
> /opt/local/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/http/cookiejar.py(1765)load()
-> f = open(filename)
(Pdb) n
> /opt/local/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/http/cookiejar.py(1766)load()
-> try:
(Pdb) 
> /opt/local/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/http/cookiejar.py(1767)load()
-> self._really_load(f, filename, ignore_discard, ignore_expires)
(Pdb) s
--Call--
> /opt/local/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/http/cookiejar.py(1989)_really_load()
-> def _really_load(self, f, filename, ignore_discard, ignore_expires):
(Pdb) s
> /opt/local/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/http/cookiejar.py(1990)_really_load()
-> now = time.time()
(Pdb) n
> /opt/local/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/http/cookiejar.py(1992)_really_load()
-> magic = f.readline()
(Pdb) 
> /opt/local/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/http/cookiejar.py(1993)_really_load()
-> if not self.magic_re.search(magic):
(Pdb) 
> /opt/local/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/http/cookiejar.py(1999)_really_load()
-> try: 
```

在上面的示例 pdb 会话中，我使用了`step`和`next`命令的组合来验证正则表达式 test ( `self.magic_re.search(magic)`) 是否确实通过了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2020-04-19T19:57:15.233

请在你的开发控制台中

```
copy('# Netscape HTTP Cookie File\n' + document.cookie.split(/; /g).map(e => e.replace('=', '\t')).map(e => window.location.hostname.replace('www.', '.') + '\tTRUE\t/\tFALSE\t-1\t' + e).join('\n')) 
```

Netscape 格式的 cookie 将在您系统的剪贴板中 :)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-04-19T06:32:10.953

在我的场景中，需要对 (/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/) 下的 MozillaCookieJar 进行两项修改

1.  魔术头

    您可以删除检查逻辑或添加我喜欢的魔术头

    > # 网景 HTTP Cookie 文件

2.  新的文件格式似乎允许您省略过期

    ```
    vals = line.split("\t")
    if len(vals) == 7 :
        domain, domain_specified, path, secure, expires, name, value = vals
    if len(vals) == 6 :
        domain, domain_specified, path, secure, name, value = vals
        expires = None 
    ```

最后，我真的希望实施可以更新到新的变化。

# php - 使用 facebook 的 php SDK 检索电子邮件

> ID：11529439
> 
> 赞同：0
> 
> 时间：2012-07-17T19:25:18.393
> 
> 标签：php, facebook, facebook-graph-api, facebook-access-token

到目前为止，我已将其设置为检索基本用户信息，没有任何扩展。我也尝试获取用户电子邮件，但没有成功。这是我得到的：

```
 $facebook = new Facebook(array(
            'appId' => APP_ID,
            'secret' => APP_SECRET,
            'cookie' => true,

        ));

$session = $facebook->getSession();

if (!empty($session)) {
    try {
    $params = array(
      'scope' => 'email',
      'redirect_uri' => 'https://www.dormduels/splash_test'
    );

    $loginUrl = $facebook->getLoginUrl($params);
        $uid = $facebook->getUser();

         $access_token = $facebook->getAccessToken();

        echo $access_token;
        $user = $facebook->api('me?fields=name,first_name,last_name,username,email&access_token='.$access_token);
        echo "<pre>";
        print_r($user);
        exit(); 
```

问题是。它显示的 getAccessToken 在 facebooks 图形浏览器中测试时，不显示扩展数据，如电子邮件，仅显示基本数据。如何请求启用更多权限的访问令牌？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:44:41.353

您需要通过以下方式之一请求[扩展权限](http://developers.facebook.com/docs/authentication/permissions/)，即此处的“电子邮件”：

1.  **php SDK**

    使用 sdk 对象的[getLoginUrl()](http://developers.facebook.com/docs/reference/php/facebook-getLoginUrl/)方法，并在“范围”中指定您需要的扩展权限，并将用户重定向到其返回值，您还需要在[Facebook 应用程序的管理页面](https://developers.facebook.com/apps/)中添加域和站点 url . 这是一个例子：

    ```
    define('APP_ID', 'TODO FILL IT WITH YOURS');
    define('APP_SECRET', 'TODO FILL IT WITH YOURS');

    require_once 'facebook.php';

    function redirect_to_login($fb){
        $login_url = $fb->getLoginUrl(array(
            'scope' => 'email',
        ));
        header('Location: '.$login_url);
        exit;
    }

    $fb = new Facebook(array(
        'appId' => APP_ID,
        'secret' => APP_SECRET,
        'cookie' => true,
    ));

    $uid = $fb->getUser();
    if (!$uid || !check_perms($fb, $uid, array('email'))) { // see check_perms below
        // send users to login/auth page if they are not logged in, 
        // or not installed the app, 
        // or don't have all the perms we need
        redirect_to_login($fb);
    }

    try {
        $me = $fb->api('/me');
        var_dump($me);
    } catch (Exception $e) {
        redirect_to_login($fb);
    } 
    ```

2.  **js SDK**

    使用[FB.login()](http://developers.facebook.com/docs/reference/javascript/FB.login/)函数在第二个参数中请求您需要的扩展权限。

有关整个身份验证过程的详细信息，请参阅[此页面](https://developers.facebook.com/docs/opengraph/authentication/)。

如果你想检查当前用户是否拥有你想要的所有权限，你可以像这样使用[FQL](http://developers.facebook.com/docs/reference/fql/)：

```
function check_perms($facebook, $uid, $perms = array()) {

    $perms_str = join(' = 1 and ', $perms).' = 1';
    $query = "select uid from permissions where uid = '".$uid."' and ".$perms_str;

    try {
        $row = $facebook->api(array(
            'method' => 'fql.query',
            'query'  => $query,
        ));
        return $row && $row[0]['uid'] == $uid;
    } catch (Exception $e) {
        return false;
    }
} 
```

*注意：* 您的[php sdk](https://github.com/facebook/facebook-php-sdk)版本可能已经过时，getSession() 方法已被弃用，取而代之的是 getUser() / getAccessToken()

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T19:46:55.307

在我这边，我这样做：

```
// Create our Application instance (replace this with your appId and secret).
$facebook = new Facebook(array(
  'appId'  => FB_API_KEY,
  'secret' => FB_API_SECRET,
));

// Get User ID
$fb_user = $facebook->getUser();

// We may or may not have this data based on whether the user is logged in.
//
// If we have a $fb_user id here, it means we know the user is logged into
// Facebook, but we don't know if the access token is valid. An access
// token is invalid if the user logged out of Facebook.
if ($fb_user) {
  try {
    // Proceed knowing you have a logged in user who's authenticated.
    $fb_user_profile = $facebook->api('/me');
  } catch (FacebookApiException $e) {
    error_log($e);
    $fb_user = null;
  }
}

// Login or logout url will be needed depending on current user state.
if ($fb_user) {
    $fb_loggedin = true;
} else {
    $fb_loggedin = false;
    $fb_loginUrl = $facebook->getLoginUrl(array(
        'scope' => 'email,user_location',
        'redirect_uri' => 'http://'.$_SERVER['HTTP_HOST'].'/debut_'.($lang == 'fr' ? 'fr' : 'eng').'.php'
    ));
} 
```

getLoginUrl 中的 SCOPE 是您要查看的内容，您可以在开发人员网站上看到所有不同的权限：

[https://developers.facebook.com/docs/authentication/permissions/](https://developers.facebook.com/docs/authentication/permissions/)

祝你好运

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-18T07:33:22.920

```
Try following:
$facebook = new Facebook(array(
    'appId' => APP_ID,
    'secret' => APP_SECRET,
    'cookie' => true,
));

 public function login() {
        $loginUrl= $facebook->getLoginUrl(array('scope' => 'email',
                    'redirect_uri' => 'your redirectUri',
                    'display' => 'popup'
                ));
       header("Location:$loginUrl");
    }
public function fUserInfo() {
        $access_token = $facebook->getAccessToken();
        //check permissions list
        $permissions_list = $facebook->api('/me/permissions', 'GET', array('access_token' => $access_token));
        $permissions_needed = array('email');
        foreach ($permissions_needed as $perm) {
            if (!isset($permissions_list['data'][0][$perm]) || $permissions_list['data'][0][$perm] != 1) {
                login();
            }
        }
        $user = $facebook->getUser();
        if ($user) {
            try {
                $userInfo = $facebook->api("/$user");
            } catch (FacebookApiException $e) {
                Config::getLogger()->debug($e->getMessage());
            }
        }
        print_r($userInfo);
    } 
```

# python - 变形验证中的“请求”

> ID：11529444
> 
> 赞同：0
> 
> 时间：2012-07-17T19:25:39.040
> 
> 标签：python, pyramid, deform

我需要这个自定义验证在变形工作的“请求”：

```
def d_validator(node, value):
    if not value:
        raise Invalid(node, 'Enter a Password')
    if len(value) < 5:
        raise Invalid(node, 'Invalid Length')
    userid = authenticated_userid(userrequest)
    dbsession = DBSession()
    userInfo = dbsession.query(User).filter(_and(User.id==userid, User.password == value)).first()
    if not userInfo:
        raise Invalid(node, 'Invalid password') 
```

所以我尝试了这个：

```
class Form(field.Field):
    def __init__(self, schema, **kw):
        self.saved_user = kw.pop('userrequest')
        log.info(self.saved_user)
        super(Form, self).__init__(schema, **kw) 
```

进而：

```
Form(schema, buttons=('Actualizar',), 'userrequest'=request) 
```

但我得到 SyntaxError: 关键字不能是表达式

我知道这可能与python有关，请多多包涵，在此先感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:27:24.783

关键字确实不是表达式，`'userrequest'=request` *而是*. 删除引号：

```
Form(schema, buttons=('Actualizar',), userrequest=request) 
```

另外，为什么你的自定义`Form`类基于`field.Field`？我自己还没有使用过变形，但快速浏览一下[文档](http://docs.pylonsproject.org/projects/deform/en/latest/)*强烈*建议你应该继承自`deform.Form`。

最后但并非最不重要的一点是，您*可以*改用[金字塔线程本地请求](http://docs.pylonsproject.org/projects/pyramid/en/latest/api/threadlocal.html#pyramid.threadlocal.get_current_request)：

```
def d_validator(node, value):
    if not value:
        raise Invalid(node, 'Enter a Password')
    if len(value) < 5:
        raise Invalid(node, 'Invalid Length')
    userid = authenticated_userid(get_current_request())
    dbsession = DBSession()
    userInfo = dbsession.query(User).filter(_and(User.id==userid, User.password == value)).first()
    if not userInfo:
        raise Invalid(node, 'Invalid password') 
```

是的，这通常不受欢迎，但在您的情况下可能更容易处理。

# javascript - 为什么这个闭包返回函数？

> ID：11529448
> 
> 赞同：0
> 
> 时间：2012-07-17T19:25:47.373
> 
> 标签：javascript, closures

在观看Learning to Love JavaScript 时，我对为什么第二个版本不起作用感到困惑。它只是返回“功能”。是否不允许闭包直接分配变量？

```
function getCtr() {
    var i = 0;
    return function() {
        console.log(++i);
    }
}
var ctr = getCtr();
ctr();
ctr();
ctr();
/* console
1
2
3
*/
/*--------------------------------------
 *   This doesn't work
 */
var ctr = function() {
    var i = 0;
    return function() {
        console.log(++i);
    }
}
ctr();
ctr();
ctr();
/*   console
 *   => [Function]
 */ 
```

视频链接[http://youtu.be/seX7jYI96GE?t=11m12s](http://youtu.be/seX7jYI96GE?t=11m12s)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T19:26:38.827

它打印出来是因为该函数**确实**返回了一个函数。

尝试

```
ctr()(); 
```

您使用的两种形式的函数声明具有几乎完全相同的效果。两者都简单地创建一个函数并将其绑定到一个符号。您在第二个版本中真正改变的只是所涉及的名称（“ctr”而不是“getCtr”）。

也就是说，如果您的测试与第一个设置类似：

```
var actualCtr = ctr();

actualCtr();
actualCtr();
actualCtr(); 
```

你会发现它真的是一样的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T19:31:12.843

在您的第一个版本中，您定义了一个函数 getCtr。然后调用 getCtr，将结果保持为 ctr。然后你反复调用 ctr 。您正在调用调用函数的结果。

在第二个版本中，您将 ctr 定义为您的第一个函数，然后重复调用它。您没有调用调用函数的结果。

这是您的第二个代码的有效版本：

```
var ctr = (function() {
        var i = 0;
        return function() {
            console.log(++i);
        }
    })();
ctr();
ctr();
ctr(); 
```

# hibernate - Hibernate 寻找一个不存在的列

> ID：11529449
> 
> 赞同：0
> 
> 时间：2012-07-17T19:25:55.840
> 
> 标签：hibernate

我绝不是冬眠专业人士，但我确实了解正在发生的一些事情。这是我的问题。由于某种原因，上周我们的构建引入了一个错误，hibernate 正在寻找一个我们在一个多月前从数据库和代码中删除的列。我完全不知道为什么它要寻找这个并且堆栈痕迹比公牛上的山雀更没用。有没有人见过这样的问题？如果是这样，您是如何解决的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T22:05:19.357

我怀疑您使用的是 jar 的旧副本。如果您的功能测试针对服务器运行，则删除服务器的临时文件夹。尝试在这个 jar 的新副本上运行单元测试。只为这个类尝试一个简单的单元测试。反编译jar，看看你是否使用了refresh copy。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T00:21:55.747

有时，Hibernate 会寻找默认的列名，即使您没有明确地将列名放在注释中。

也许您可以在 hibernate.properties 文件中打开这些选项：

```
hibernate.hbm2ddl.auto=create 
hibernate.show_sql=true 
```

...并在生成的 DDL 中查找您的故障列。然后你会得到一个关于哪个实体/实体关系给你带来麻烦的提示。

# python - Selenium 卡住了带有基本身份验证的加载框架

> ID：11529450
> 
> 赞同：0
> 
> 时间：2012-07-17T19:25:57.953
> 
> 标签：python, selenium, webdriver, frame, basic-authentication

我在 python 中使用 selenium 来检查在一个框架上使用基本身份验证的网站的页面。我正在检查我输入的密码是否正确，因此基本身份验证经常因为密码错误而卡住。通常我使用 sel.set_page_load_timeout(8) 然后捕获页面耗时过长时抛出的异常，但是由于页面加载除了一帧之外，该函数没有抛出异常，并且页面卡住了。我怎样才能跳出页面？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T17:38:10.507

解决方法：去框架本身的url，在那个页面上设置页面加载超时

# c - 服务器打印到标准输出而不是套接字

> ID：11529451
> 
> 赞同：3
> 
> 时间：2012-07-17T19:26:07.650
> 
> 标签：c, sockets, network-programming, client-server

我正在研究 UNIX 网络编程中的示例，并且我已将“daytimeclientserv.c”改编为此处的代码。服务器按预期将日期/时间字符串发送给客户端，除了它在启动时收到的第一个请求。当我第一次运行服务器程序（在 LAN 中的另一台计算机上）时，它会创建侦听套接字，绑定它，然后等待连接。在收到第一个请求后，它将日期/时间字符串打印到自己的标准输出（终端）而不是套接字，并且客户端程序永远挂起等待。但是，所有后续请求都会正确发送到客户端。使用 gdb，我注意到 connfd 始终设置为零。它在第一个请求以及所有未来请求中设置为零。

我还有一些与此相关的其他问题：

*   如果服务器监听一个套接字（listenfd），然后用connect（）重新连接另一个（connfd），客户端如何处理套接字的变化？据我了解，套接字由四个部分唯一标识：servIPaddr、servPort、clientIPaddr、clientPort

*   我如何在没有root用户的情况下运行服务器（在Linux上）

*   我怎样才能干净地关闭监听套接字，以便我可以再次使用它。如果我使用 SIGINT (Ctrl-C) 退出服务器程序，我会收到绑定错误。到目前为止，我一直在使用 gdb，并使用“call close(listenfd)”来手动调用该函数。但是，如果我不使用 gdb（即仅调试客户端应用程序），有没有办法做到这一点。

任何帮助是极大的赞赏。

```
#include <stdio.h>
#include <string.h>
#include <errno.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include <time.h>

#define BUFFER 80
int main(int argc, char **argv) {
  int listenfd, connfd;
  char buf[BUFFER];
  struct sockaddr_in servaddr;
  time_t ticks;
  struct sockaddr *ptr;
  char *ret;

  if ( (listenfd = socket(AF_INET, SOCK_STREAM, 0)) < 0) {
    perror("socket error");
    return 1;
  }

  memset(&servaddr, 0, sizeof(servaddr));
  memset(buf, 0, BUFFER);
  servaddr.sin_family = AF_INET;
  servaddr.sin_port = htons(13);
  servaddr.sin_addr.s_addr = htonl(INADDR_ANY);

  ptr = (struct sockaddr*) &servaddr;
  if ( bind(listenfd, ptr ,sizeof(servaddr)) < 0) {
    perror("bind error");
    return 2;
  }

  if ( listen(listenfd, 128) < 0) {
    perror("listen error");
    return 3;
  }

  ptr = NULL;
  while ( 1 ) {
    if ( connfd = accept(listenfd, ptr, NULL) < 0) {
      perror("accept error");
      return 4;
    } else {
      ticks = time(NULL);
      ret = ctime(&ticks);
      sprintf(buf, "%.24s\n", ret);
      if ( write(connfd, buf, strlen(buf)) < 0) {
        perror("write error");
        close(connfd);
    }
  }

  return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T19:32:57.780

这是我的预感：在终端（tty）上，stdout 和 stdin 是同一个*物理设备*。因此，写入*文件描述符*0（stdin）实际上可能会起作用并导致终端输出。

你需要括号

```
 if ( connfd = accept(listenfd, ptr, NULL) < 0) { 
```

像这样

```
 if ( (connfd = accept(listenfd, ptr, NULL)) < 0) { 
```

或`connfd`将被分配“0”

**更新**刚刚测试了这个，这确实是罪魁祸首。下一次，***编译时编译`gcc -Wall`***器会告诉你这一点（以及其他几个良好形式/风格的问题）。这样，您就不必依靠*直觉*来查找错误。

固定版本：

```
#include <stdio.h>
#include <unistd.h>
#include <string.h>
#include <errno.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include <time.h>

#define BUFFER 80
int main(int argc, char **argv) {
    int listenfd, connfd;
    char buf[BUFFER];
    struct sockaddr_in servaddr;
    time_t ticks;
    struct sockaddr *ptr;
    char *ret;

    listenfd = socket(AF_INET, SOCK_STREAM, 0);
    if ( listenfd < 0 ) {
        perror("socket error");
        return 1;
    }

    memset(&servaddr, 0, sizeof(servaddr));
    memset(buf, 0, BUFFER);
    servaddr.sin_family = AF_INET;
    servaddr.sin_port = htons(13);
    servaddr.sin_addr.s_addr = htonl(INADDR_ANY);

    ptr = (struct sockaddr*) &servaddr;
    if ( bind(listenfd, ptr ,sizeof(servaddr) ) < 0) {
        perror("bind error");
        return 2;
    }

    if ( listen(listenfd, 128) < 0 ) {
        perror("listen error");
        return 3;
    }

    ptr = NULL;
    while ( 1 ) {
        connfd = accept(listenfd, ptr, NULL);
        if ( connfd < 0 ) {
            perror("accept error");
            return 4;
        } else {
            ticks = time(NULL);
            ret = ctime(&ticks);
            sprintf(buf, "%.24s\n", ret);
            if ( write(connfd, buf, strlen(buf)) < 0) {
                perror("write error");
                close(connfd);
            }
        }
    }

    return 0;
} 
```

# xml - 为 xml 模式中实际复杂类型的每个子项声明属性

> ID：11529453
> 
> 赞同：0
> 
> 时间：2012-07-17T19:26:13.337
> 
> 标签：xml, xsd

是否可以在复杂类型上声明一个属性，该属性将从该复杂类型中声明的每个元素继承？

我有一个用例，我需要注释 xml 中的每个元素，无论它是否已更改（@mutated={true|false}）。我看到的唯一解决方案是将此属性添加到每个元素，这非常令人毛骨悚然。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T13:52:42.400

好的，您不可能需要使用此属性扩展每种类型并创建一个新类型。

这是我对简单类型和复杂类型的定义：

**扩展简单类型：**

```
<xs:complexType name="areaMutatedType">
    <xs:simpleContent>
        <xs:extension base="register-ws:areaType">
            <xs:attribute ref="register-ws:mutated" />
        </xs:extension>
    </xs:simpleContent>
</xs:complexType> 
```

**扩展复杂类型：**

```
<xs:complexType name="relationMutatedType">
    <xs:sequence>
        <xs:element name="id" type="xs:string" minOccurs="0" maxOccurs="unbounded" />
    </xs:sequence>
    <xs:attribute ref="register-ws:mutated" use="optional"/>
</xs:complexType> 
```

这里有一些很好的资源：

*   [http://www.ibm.com/developerworks/library/x-flexschema/](http://www.ibm.com/developerworks/library/x-flexschema/)
*   [http://www.learn-xml-schema-tutorial.com/Attributes.cfm](http://www.learn-xml-schema-tutorial.com/Attributes.cfm)

# android - android中的代码断言

> ID：11529454
> 
> 赞同：1
> 
> 时间：2012-07-17T19:26:15.957
> 
> 标签：android, assertions

代码断言是否真的在 Android 中运行以用于发布版本？我的代码没有报告断言失败。它会导致崩溃。有没有办法为发布模式打开断言？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:29:55.470

即使在 Java 上，断言也仅用于调试目的，不能保证在发布时有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:31:04.363

我认为使用`junit.framework.Assert`而不是 Java`assert`关键字（被 Dalvik 剥离）应该可以解决问题。

如果你坚持使用`assert`关键字，有各种[变通方法](https://stackoverflow.com/questions/2364910/can-i-use-assert-on-android-devices/5563637#5563637)。

# c# - 模拟用户代理

> ID：11529457
> 
> 赞同：1
> 
> 时间：2012-07-17T19:26:28.780
> 
> 标签：c#, browser, moq, httpcontext

我正在编写单元测试，其中我需要一个假的 HttpContext。我使用了 Phil Haack 的 HttpSimulator (http://haacked.com/archive/2007/06/19/unit-tests-web-code-without-a-web-server-using-httpssimulator.aspx)。但是 Sitecore api 中的一个函数会在以下代码中引发异常：

```
request.Browser.Browser.IndexOf("IE", StringComparison.OrdinalIgnoreCase) > -1; 
```

我调试了我的代码并且 request.Browser.Browser 是空的。我试图用最小起订量填充该属性，但出现异常。我还尝试将其添加为标题。

我的代码如下所示：

```
using (HttpSimulator simulator = new HttpSimulator("/", "localpath"))
{
    //NameValueCollection nvc = new NameValueCollection { { "User-Agent", "IE" } };
    //simulator.SimulateRequest(new Uri("http://www.foo.bar"), HttpVerb.GET, nvc);
    simulator.SimulateRequest();        

    var browserMock = new Mock<HttpBrowserCapabilities>();
    browserMock.SetupAllProperties();
    //browserMock.SetupProperty(b => b.Browser, "IE");
    HttpContext.Current.Request.Browser = browserMock.Object;
} 
```

有谁知道我如何模拟这个属性？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-04-29T06:25:29.040

实际上这是可能的 - 您可以直接在请求上设置 Browser 属性：

```
httpSim.SimulateRequest(new Uri("http://www.test.com"));

HttpContext.Current.Request.Browser = new HttpBrowserCapabilities
                                                        {
                                                            Capabilities = new Dictionary<string,string>
                                                                {
                                                                    {"majorversion", "8"},
                                                                    {"browser", "IE"},
                                                                    {"isMobileDevice","false"}
                                                                }
                                                        }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T07:51:07.060

这是无法做到的，您将不得不在 MVC 中使用 HttpContextBase ed 类。事实证明，使用 Web 表单进行单元测试很混乱（？）

# node.js - MongoDB GridFS“非法块格式”异常

> ID：11529458
> 
> 赞同：6
> 
> 时间：2012-07-17T19:26:30.113
> 
> 标签：node.js, mongodb, gridfs

我一直在用 Node.js 编写一个应用程序，它将图像存储在 MongoDB 的 GridFS 文件系统中。

我已经通过该应用上传了图像，并且图像似乎已正确存储：

```
$ mongofiles -v -d speaker-karaoke get howard-basement-100x115.jpg
Tue Jul 17 12:14:16 creating new connection to:127.0.0.1
Tue Jul 17 12:14:16 BackgroundJob starting: ConnectBG
Tue Jul 17 12:14:16 connected connection!
connected to: 127.0.0.1
done write to: howard-basement-100x115.jpg 
```

这从 MongoDB 中抓取了 .jpg，我可以毫无问题地打开它，所以看起来我上传的内容被正确存储。

但是，在我正在运行的应用程序中，当我尝试读取同一个文件时，我得到：

```
12:15:44 web.1     | started with pid 89621
12:15:45 web.1     | Connecting to mongodb://localhost/speaker-karaoke
12:15:45 web.1     | Speaker Karaoke express app started on 5000
12:15:48 web.1     | DEBUG: Get review thumbnail for 5005b7550333650000000001
12:15:48 web.1     | 
12:15:48 web.1     | node.js:201
12:15:48 web.1     |         throw e; // process.nextTick error, or 'error' event on first tick
12:15:48 web.1     |               ^
12:15:48 web.1     | Error: Illegal chunk format
12:15:48 web.1     |     at Error (unknown source)
12:15:48 web.1     |     at new <anonymous> (/Users/hlship/workspaces/github/speaker-karaoke/node_modules/mongodb/lib/mongodb/gridfs/chunk.js:43:11)
12:15:48 web.1     |     at /Users/hlship/workspaces/github/speaker-karaoke/node_modules/mongodb/lib/mongodb/gridfs/gridstore.js:488:24
12:15:48 web.1     |     at Cursor.nextObject (/Users/hlship/workspaces/github/speaker-karaoke/node_modules/mongoose/node_modules/mongodb/lib/mongodb/cursor.js:462:5)
12:15:48 web.1     |     at [object Object].<anonymous> (/Users/hlship/workspaces/github/speaker-karaoke/node_modules/mongoose/node_modules/mongodb/lib/mongodb/cursor.js:456:12)
12:15:48 web.1     |     at [object Object].g (events.js:156:14)
12:15:48 web.1     |     at [object Object].emit (events.js:88:20)
12:15:48 web.1     |     at Db._callHandler (/Users/hlship/workspaces/github/speaker-karaoke/node_modules/mongoose/node_modules/mongodb/lib/mongodb/db.js:1290:25)
12:15:48 web.1     |     at /Users/hlship/workspaces/github/speaker-karaoke/node_modules/mongoose/node_modules/mongodb/lib/mongodb/connection/server.js:329:30
12:15:48 web.1     |     at [object Object].parseBody (/Users/hlship/workspaces/github/speaker-karaoke/node_modules/mongoose/node_modules/mongodb/lib/mongodb/responses/mongo_reply.js:118:5)
12:15:48 web.1     | process terminated
12:15:48 system    | sending SIGTERM to all processes 
```

使用此代码（CoffeeScript，用于 Express）：

```
 app.get "/images/review-thumbnail/:id", (req, res) ->

    id = req.params.id

    util.debug "Get review thumbnail for #{id}"

    store = new GridStore mongoose.connection.db, new ObjectID(id), null, "r"

    store.open (err, file) ->

      throw err if err

      util.debug "Store open for #{id}, type = #{file.contentType}"

      # TODO: Scale the image before sending it!

      res.header "Content-Type", file.contentType

      store.stream(true).pipe res 
```

所以它似乎甚至没有将它传递给传递给 store.open() 的回调。

当您知道 id 但不知道文件名时，打开 GridFS 文件是否有问题？

顺便提一句：

```
$ npm ls
speaker-karaoki@0.0.1 /Users/hlship/workspaces/github/speaker-karaoke
├─┬ blueimp-file-upload-node@1.0.2  extraneous
│ ├── formidable@1.0.11 
│ ├── imagemagick@0.1.2 
│ └── node-static@0.6.0 
├── coffee-script@1.3.3 
├─┬ connect-assets@2.1.9 
│ ├── connect-file-cache@0.2.4 
│ ├── mime@1.2.2 
│ ├─┬ snockets@1.3.4 
│ │ ├── coffee-script@1.3.3 
│ │ ├── dep-graph@1.0.1 
│ │ └── uglify-js@1.0.7 
│ └── underscore@1.1.7 
├─┬ express@2.5.9 
│ ├─┬ connect@1.9.1 
│ │ └── formidable@1.0.11 
│ ├── mime@1.2.4 
│ ├── mkdirp@0.3.0 
│ └── qs@0.4.2 
├─┬ jade@0.26.0 
│ ├── commander@0.5.2 
│ └── mkdirp@0.3.0 
├─┬ mongodb@1.0.2 
│ └── bson@0.0.6 
├─┬ mongoose@2.7.0 
│ ├── hooks@0.2.1 
│ └─┬ mongodb@1.0.2 
│   └── bson@0.0.6 
├─┬ passport@0.1.10 
│ └── pkginfo@0.2.3 
├─┬ passport-twitter@0.1.3 
│ ├─┬ passport-oauth@0.1.9 
│ │ ├── oauth@0.9.7 
│ │ └── passport@0.1.11 
│ └── pkginfo@0.2.3 
├── sass@0.5.0 
└── underscore@1.3.3 
```

这是它失败的功能：

```
var Chunk = exports.Chunk = function(file, mongoObject) {
  if(!(this instanceof Chunk)) return new Chunk(file, mongoObject);

  this.file = file;
  var self = this;
  var mongoObjectFinal = mongoObject == null ? {} : mongoObject;

  this.objectId = mongoObjectFinal._id == null ? new ObjectID() : mongoObjectFinal._id;
  this.chunkNumber = mongoObjectFinal.n == null ? 0 : mongoObjectFinal.n;
  this.data = new Binary();

  if(mongoObjectFinal.data == null) {
  } else if(typeof mongoObjectFinal.data == "string") {
    var buffer = new Buffer(mongoObjectFinal.data.length);
    buffer.write(mongoObjectFinal.data, 'binary', 0);
    this.data = new Binary(buffer);
  } else if(Array.isArray(mongoObjectFinal.data)) {
    var buffer = new Buffer(mongoObjectFinal.data.length);
    buffer.write(mongoObjectFinal.data.join(''), 'binary', 0);
    this.data = new Binary(buffer);
  } else if(mongoObjectFinal.data instanceof Binary || Object.prototype.toString.call(mongoObjectFinal.data) == "[object Binary]") {    
    this.data = mongoObjectFinal.data;
  } else if(Buffer.isBuffer(mongoObjectFinal.data)) {
  } else {
    throw Error("Illegal chunk format");
  }
  // Update position
  this.internalPosition = 0;
}; 
```

*解决方案*

在此处更新解决方案，因为它在下面的评论中未正确呈现。

问题是重复；有两个副本，即使版本相同，也是 mongodb 和 bson。

幸运的是，mongoose 将它所需的 mongodb 导出为属性 mongo，因此我能够从我的文件中删除显式 mongodb`package.json`并进行了更改：

```
mongo = require "mongodb"
mongoose = require "mongoose" 
```

至：

```
mongoose = require "mongoose"
mongo = mongoose.mongo 
```

事情现在看起来不错；我仍然认为模块系统需要一种认可的方式来访问依赖项依赖项（对于一个 dep 不够周到暴露其 deps 的情况）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T00:20:28.507

很确定它是 mongodb 模块的重复副本（相同版本）；删除 node_modules 和 nmp install 似乎已经修复了它。

# sql - SQL在使用ISNULL时如何使用IN

> ID：11529464
> 
> 赞同：-1
> 
> 时间：2012-07-17T19:26:48.390
> 
> 标签：sql, sql-server

下面的参数看起来像 (2,3,4,5) 或 (2) 甚至是 NULL 列 ServiceEntryPart 可能在代码部分中具有如下数据。我的问题是正确的语法是什么，所以我可以使用过滤器。如果过滤器为 NULL，我将完全忽略它。如果它是NULL（不包括过滤器），那么到目前为止我所拥有的工作正常，但是当我有例如（1,2）的参数时，它不起作用..谢谢

```
ServiceEntryPart.ServiceTypeIDs 
 4,3
 3
 NULL
 1
 8
 2,5

--Filter:
  @ServiceTypes nvarchar(100) = NULL

--Filter with values SET @ServiceTypes = (1,2,4,5)      

--Where Clause  
WHERE   (ServiceEntryPart.ServiceTypeIDs = ISNULL(@ServiceTypes,ServiceEntryPart.ServiceTypeIDs) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T20:06:41.740

看起来您想为 IN 子句传入一个变量列表。一种方法是使用动态 SQL，但我会说这是矫枉过正。

您可以尝试以下方法：

```
where @ServiceTypes is null or
      charindex(','+cast(ServiceEntryPart.ServiceTypeIDs as varchar(255)+',',
                ','+@ServiceTypes+',') > 0 
```

这是使用字符串搜索来执行与 IN 等效的操作。它假定 @ServiceTypes 是一个没有空格的逗号分隔列表。它前置和后置逗号。当您查找类似 5 的内容时，它实际上是在查找“,5”，因此它与列表中的 25 或 55 不匹配。

# html - 是否有从 SVG 文件创建 SVG 路径的工具？

> ID：11529470
> 
> 赞同：93
> 
> 时间：2012-07-17T19:27:16.673
> 
> 标签：html, svg, adobe-illustrator

有谁知道可以获取 SVG 文件并将其转换为 HTML 5 SVG 路径的工具？你知道`d="M 0 0 L 20 134 L 233 24 Z" fill="#99dd79"`吗？

我在这里：[使用 Adob​​e Illustrator 使用“移动到”命令创建 SVG 路径](https://stackoverflow.com/questions/7378742/use-adobe-illustrator-to-create-svg-path-using-move-to-commands)

但不确定。这是否意味着 Illustrator 可以采用任何线条绘制并将其保存为 SVG 路径？

**注意：** 是的，有inkscape，但如果可能的话，我正在寻找渐变和遮罩支持。我希望能够利用 .ai 文件并使用 illustrator 或 Acrobat 或其他工具导出它们......那里有什么东西吗？还是作为输出格式内置在 Illustrator 或 Acrobat 中？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2017-05-10T15:40:56.067

Gimp 可用于将带有基元（例如矩形、圆形等）的 SVG 转换为可在 HTML5 中使用的单个路径。

1.  首先下载 Gimp：[https ://www.gimp.org/downloads/](https://www.gimp.org/downloads/)
2.  `.svg`使用任何选择的工具（例如 Illustrator）将您的 SVG 导出为文件。如果 SVG 输出现在很乱，请不要担心，Gimp 会清理它
3.  **使用File -> Open**将 SVG 文件导入 Gimp ，然后应该会显示以下（或类似的）对话框：

[![Gimp SVG 打开对话框](../Images/53c9f30f3410b429b2801151d26a783d.png)](https://i.stack.imgur.com/xEVx1.png)

检查**导入路径**和**合并导入路径**选项

4.  然后转到**Windows->可停靠对话->路径**
5.  右键单击显示*Imported Path*的单个路径，您应该会看到以下对话框：

[![在此处输入图像描述](../Images/60d34f785bcde37e75192c5a8d767eb7.png)](https://i.stack.imgur.com/StcS9.png)

6.  单击**导出路径...**并将此文本文件保存到您选择的位置
7.  使用您选择的文本编辑器（例如记事本、TextEdit）找到并打开此文件
8.  复制里面的文字`<path d="copy this text here" />`
9.  由于 Gimp 使用大量空格格式化文本，您可能需要重新格式化它，通过删除一些空格将其粘贴到 HTML 中的一行中

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2016-07-05T15:11:34.557

使用文本编辑器打开 SVG。如果运气好的话，该文件将包含以下内容：

```
<path d="M52.52,26.064c-1.612,0-3.149,0.336-4.544,0.939L43.179,15.89c-0.122-0.283-0.337-0.484-0.58-0.637  c-0.212-0.147-0.459-0.252-0.738-0.252h-8.897c-0.743,0-1.347,0.603-1.347,1.347c0,0.742,0.604,1.345,1.347,1.345h6.823  c0.331,0.018,1.022,0.139,1.319,0.825l0.54,1.247l0,0L41.747,20c0.099,0.291,0.139,0.749-0.604,0.749H22.428  c-0.857,0-1.262-0.451-1.434-0.732l-0.11-0.221v-0.003l-0.552-1.092c0,0,0,0,0-0.001l-0.006-0.011l-0.101-0.2l-0.012-0.002  l-0.225-0.405c-0.049-0.128-0.031-0.337,0.65-0.337h2.601c0,0,1.528,0.127,1.57-1.274c0.021-0.722-0.487-1.464-1.166-1.464  c-0.68,0-9.149,0-9.149,0s-1.464-0.17-1.549,1.369c0,0.688,0.571,1.369,1.379,1.369c0.295,0,0.7-0.003,1.091-0.007  c0.512,0.014,1.389,0.121,1.677,0.679l0,0l0.117,0.219c0.287,0.564,0.751,1.473,1.313,2.574c0.04,0.078,0.083,0.166,0.126,0.246  c0.107,0.285,0.188,0.807-0.208,1.483l-2.403,4.082c-1.397-0.606-2.937-0.947-4.559-0.947c-6.329,0-11.463,5.131-11.463,11.462  S5.15,48.999,11.479,48.999c5.565,0,10.201-3.968,11.243-9.227l5.767,0.478c0.235,0.02,0.453-0.04,0.654-0.127  c0.254-0.043,0.507-0.128,0.713-0.311l13.976-12.276c0.192-0.164,0.874-0.679,1.151-0.039l0.446,1.035  c-2.659,2.099-4.372,5.343-4.372,8.995c0,6.329,5.131,11.461,11.462,11.461c6.329,0,11.464-5.132,11.464-11.461  C63.983,31.196,58.849,26.064,52.52,26.064z M11.479,46.756c-4.893,0-8.861-3.968-8.861-8.861s3.969-8.859,8.861-8.859  c1.073,0,2.098,0.201,3.051,0.551l-4.178,7.098c-0.119,0.202-0.167,0.418-0.183,0.633c-0.003,0.022-0.015,0.036-0.016,0.054  c-0.007,0.091,0.02,0.172,0.03,0.258c0.008,0.054,0.004,0.105,0.018,0.158c0.132,0.559,0.592,1,1.193,1.05l8.782,0.727  C19.397,43.655,15.802,46.756,11.479,46.756z M15.169,36.423c-0.003-0.002-0.003-0.002-0.006-0.002  c-1.326-0.109-0.482-1.621-0.436-1.704l2.224-3.78c1.801,1.418,3.037,3.515,3.32,5.908L15.169,36.423z M25.607,37.285l-2.688-0.223  c-0.144-3.521-1.87-6.626-4.493-8.629l1.085-1.842c0.938-1.593,1.756,0.001,1.756,0.001l0,0c1.772,3.48,3.65,7.169,4.745,9.331  C26.012,35.924,26.746,37.379,25.607,37.285z M43.249,24.273L30.78,35.225c0,0.002,0,0.002,0,0.002  c-1.464,1.285-2.177-0.104-2.188-0.127l-5.297-10.517l0,0c-0.471-0.936,0.41-1.062,0.805-1.073h17.926c0,0,1.232-0.012,1.354,0.267  v0.002C43.458,23.961,43.473,24.077,43.249,24.273z M52.52,46.745c-4.891,0-8.86-3.968-8.86-8.858c0-2.625,1.146-4.976,2.962-6.599  l2.232,5.174c0.421,0.977,0.871,1.061,0.978,1.065h0.023h1.674c0.9,0,0.592-0.913,0.473-1.199l-2.862-6.631  c1.043-0.43,2.184-0.672,3.381-0.672c4.891,0,8.861,3.967,8.861,8.861C61.381,42.777,57.41,46.745,52.52,46.745z" fill="#241F20"/> 
```

该`d`属性*是*您正在寻找的。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2013-12-10T00:24:20.200

使用 Inkscape 打开 svg。

*Inkscape 是一个 svg 编辑器，它有点像 Illustrator，但由于它是专门为 svg 构建的，所以处理起来更好。它是一款免费软件，可在 @ [https://inkscape.org/en/获取](https://inkscape.org/en/)*

*   ctrl A（全选）
*   shift ctrl C（=路径/对象到路径）
*   ctrl s（保存（选择纯 svg））

完毕

所有矩形/圆形都已转换为路径

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-07-11T16:24:54.147

（回答“情况是否有所改善？”部分问题）：

不幸的是，并非如此。Illustrator 对 SVG 的支持一直有点不稳定，而且，在 Illustrator 的内部结构中乱七八糟的，我怀疑就 Illustrator 而言我们会看到很多改进。

如果您正在寻找对 Illustrator 文档的 DOM 样式访问，您可能需要查看[Hanpuku](http://alex-r-bigelow.github.io/#hanpuku) *（披露 #1：我是作者。披露 #2：它是研究代码，这意味着存在大量错误，以及未来的支持不太可能）*。

使用 Hanpuku，您可以执行以下操作：

1.  在 Illustrator 中选择感兴趣的路径
2.  单击“到 D3”按钮
3.  在脚本编辑器中，键入：

    `selection.attr('d', 'M 0 0 L 20 134 L 233 24 Z');`

4.  点击运行

5.  如果更改符合预期，请单击“到 Illustrator”以将更改应用到文档

当然，这种方法不会公开原始路径字符串。如果您按照插件欢迎页面末尾的说明进行操作，则可以使用 Chrome 的开发人员工具编辑 Illustrator 文档，但是到处都会暴露出许多丑陋的工程（镜像 Illustrator 文档的 SVG DOM 被埋在 iframe 中深入扩展——使用 Chrome 的工具更改 DOM 并单击“To Illustrator”应该仍然有效，但您可能会遇到很多问题）。

**TL;DR：** Illustrator 使用的内部模型在很多方面与 SVG 大不相同，这意味着当您在两者之间进行迭代时，目前，您唯一的选择是使用两者以相同方式支持的功能子集。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-07-05T23:05:53.260

没有人提到 Illustrator 的另存为 > 格式下拉菜单 > .svg 选项，这让我感到惊讶。

输出包含 .svg (xml) 文件中的路径（以及 svg 定义的其余部分）的 .svg 文件。

路径本身在`<path d>`.

# biopython - biopython qblast 函数没有返回数据

> ID：11529471
> 
> 赞同：2
> 
> 时间：2012-07-17T19:27:17.290
> 
> 标签：biopython

我正在尝试针对 NCBI 数据库爆破一个 8-mer（长度为 8 的字符串）。但是，每当我使用 qblast 时，就匹配而言它是空的。这是我的代码：

```
from Bio.Blast.NCBIWWW import qblast  
import Bio.Blast.NCBIXML as parser

a = qblast('blastp','nr','GGMPSGCS')  
b = parser.read(a)  
print b.alignments` 
```

每当我这样做时，它只会打印空列表 []。为什么会这样？任何人都可以照亮它吗？

我可以使用 NCBI 在线 BLAST 工具进行匹配，如果我使用像“SSRVQDGMGLYTARRVR”这样的更长的 kmer，我什至可以得到匹配。碰巧我搜索的所有 8-mers 都是空的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-04T20:00:03.987

正如在这个[答案](https://stackoverflow.com/a/24698333/1688590)中一样，您必须微调 qblast 以覆盖默认值。NCBI-BLAST 的 WWW 前端会自动调整您的参数以匹配短（8 bp）序列，但如果您通过 Biopython API 进行，则必须手动进行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T02:49:12.040

来自[http://biopython.org/DIST/docs/tutorial/Tutorial.html的常见问题解答](http://biopython.org/DIST/docs/tutorial/Tutorial.html)

> 为什么 Bio.Blast.NCBIWWW.qblast() 没有给出与 NCBI BLAST 网站相同的结果？您需要指定相同的选项——NCBI 经常调整 >website 上的默认设置，它们不再匹配 QBLAST 默认设置。检查诸如差距>惩罚和期望阈值之类的内容。

检查 qblast 是否使用相同的默认值，如果不确定，请明确显示。如果它正在执行某种“读短”过滤步骤，我不会感到惊讶。

# android - ExpandableListView OnChildClickListener 不起作用

> ID：11529472
> 
> 赞同：17
> 
> 时间：2012-07-17T19:27:19.693
> 
> 标签：android, expandablelistview

我的 Android 应用程序上的可扩展列表视图有问题

这是我的代码

```
package proyek.akhir;
import android.app.ListActivity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import android.widget.TextView;
import android.widget.Toast;
import android.widget.AdapterView.OnItemClickListener;

import java.util.ArrayList;
import java.util.List;

import android.app.Activity;
import android.os.Bundle;

import android.app.Activity;
import android.os.Bundle;
import android.view.Gravity;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AbsListView;
import android.widget.BaseExpandableListAdapter;
import android.widget.ExpandableListView;
import android.widget.ExpandableListView.OnChildClickListener;
import android.widget.ExpandableListView.OnGroupCollapseListener;
import android.widget.ExpandableListView.OnGroupExpandListener;
import android.widget.Toast;
import android.widget.ExpandableListView.OnGroupClickListener;
import android.widget.TextView;

public class list_tempat extends Activity {
private List<String> groupData;
private List<List<String>> childrenData;
static String asalfromList ;
protected static final Object[] String = null;
static String l1 ;
private void loadData() {
    groupData = new ArrayList<String>();
    groupData.add("Group 1");
    groupData.add("Group 2");
    groupData.add("Group 3");

    childrenData = new ArrayList<List<String>>();
    List<String> sub1 = new ArrayList<String>();
    sub1.add("G1 Item 1");
    sub1.add("G1 Item 2");
    childrenData.add(sub1);
    List<String> sub2 = new ArrayList<String>();
    sub2.add("G2 Item 1");
    sub2.add("G2 Item 2");
    sub2.add("G2 Item 3");
    sub2.add("G2 Item 4");
    childrenData.add(sub2);
    List<String> sub3 = new ArrayList<String>();
    sub3.add("G3 Item 1");
    sub3.add("G3 Item 2");
    sub3.add("G3 Item 3");
    sub3.add("G3 Item 4");
    sub3.add("G3 Item 5");
    childrenData.add(sub3);
}

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.expandable_list_view);

    l1 = "l1";

    loadData();

    ExpandableListView expandableListView = (ExpandableListView)findViewById(R.id.expandable_list_view);
    expandableListView.setAdapter(new ExpandableAdapter());
    expandableListView.setOnGroupClickListener(new OnGroupClickListener() {
        @Override
        public boolean onGroupClick(ExpandableListView parent, View clickedView, int groupPosition, long groupId) {
            return false;
        }
    });
    expandableListView.setOnChildClickListener(new OnChildClickListener() {
        @Override
        public boolean onChildClick(ExpandableListView expandablelistview,
                View clickedView, int groupPosition, int childPosition, long childId) {
            Intent i = getIntent();

            //asalfromList =(String) ((TextView) view).getText();
            Intent intent = new Intent(list_tempat.this, ruteangkot.class).setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
            intent.putExtra("l1", String);
            intent.putExtra("textAsal",asalfromList );

            if (i.getStringExtra("tujuan") != null){
                intent.putExtra("textTujuan",list_tempat2.tujuanfromList );
                System.out.println("adaan");
            }else{
                System.out.println("eweh");
                intent.putExtra("textTujuan","");
            }
            menuutama.mu = "";
            list_tempat2.l2 = "";

            startActivity(intent);
            finish();
            System.out.println("wkwkwk");
            showMessage("hahasu" + ((TextView)clickedView).getText());
            return false;
        }
    });
    expandableListView.setOnGroupCollapseListener(new OnGroupCollapseListener() {
        @Override
        public void onGroupCollapse(int groupPosition) {

        }
    });
    expandableListView.setOnGroupExpandListener(new OnGroupExpandListener() {
        @Override
        public void onGroupExpand(int groupPosition) {

        }
    });
}

private class ExpandableAdapter extends BaseExpandableListAdapter {

    @Override
    public Object getChild(int groupPosition, int childPosition) {
        return childrenData.get(groupPosition).get(childPosition);
    }

    @Override
    public long getChildId(int groupPosition, int childPosition) {
        return 0;
    }

    @Override
    public View getChildView(int groupPosition, int childPosition, boolean isLastChild, View convertView, ViewGroup parent) {
        TextView text = null;
        if (convertView != null) {
            text = (TextView)convertView;
            text.setText(childrenData.get(groupPosition).get(childPosition));
        } else {
            text = createView(childrenData.get(groupPosition).get(childPosition));
        }
        return text;
    }

    @Override
    public int getChildrenCount(int groupPosition) {
        return childrenData.get(groupPosition).size();
    }

    @Override
    public Object getGroup(int groupPosition) {
        return groupData.get(groupPosition);
    }

    @Override
    public int getGroupCount() {
        return groupData.size();
    }

    @Override
    public long getGroupId(int groupPosition) {
        return 0;
    }

    @Override
    public View getGroupView(int groupPosition, boolean isExpanded, View convertView, ViewGroup parent) {
        TextView text = null;
        if (convertView != null) {
            text = (TextView)convertView;
            text.setText(groupData.get(groupPosition));
        } else {
            text = createView(groupData.get(groupPosition));
        }
        return text;
    }

    @Override
    public boolean hasStableIds() {
        return false;
    }

    @Override
    public boolean isChildSelectable(int groupPosition, int childPosition) {
        return false;
    }

    private TextView createView(String content) {
        AbsListView.LayoutParams layoutParams = new AbsListView.LayoutParams(  
                ViewGroup.LayoutParams.FILL_PARENT, 38);  
        TextView text = new TextView(list_tempat.this);  
        text.setLayoutParams(layoutParams);  
        text.setGravity(Gravity.CENTER_VERTICAL | Gravity.LEFT);  
        text.setPadding(40, 0, 0, 0);  
        text.setText(content);
        return text;
    }
}

private void showMessage(String message) {
    Toast.makeText(this, message, Toast.LENGTH_SHORT).show();
}
} 
```

expandableListView.setOnChildClickListener 不起作用我想从该子列表视图中捕获数据，任何人都可以帮助我吗？谢谢

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2012-09-05T14:38:52.683

您必须激活您的孩子是可选择的！为此，请在[ExpandableListAdapter类的（重写的）](http://developer.android.com/reference/android/widget/ExpandableListAdapter.html) [isChildSelectable](http://developer.android.com/reference/android/widget/ExpandableListAdapter.html#isChildSelectable%28int,%20int%29)方法中返回 true 。

```
@Override
public boolean isChildSelectable(int groupPosition, int childPosition) {
    return true;
} 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2013-12-26T22:58:49.730

如果您正在使用`OnChildClickListener`和/或`OnGroupClickListener`组行和子行中的每个子视图，则不得聚焦。例如，如果您在子项中有一个复选框，则将该复选框设置为不可聚焦：

```
checkBox.setFocusable(false); 
```

此外，如果您将组/子 convertView 设置为可点击，它将阻止点击到达`OnChildClickListener`and `OnGroupClickListener`。如果是这种情况，请转到`getGroupView`，在您的`expListViewAdapter`，并设置：

```
convertView.setClickable(false); 
```

然后转到`getChildView`, 在你的`expListViewAdapter`, 并设置：

```
convertView.setClickable(false); 
```

在这之后两者都`OnGroupClickListener`应该`OnChildClickListener`工作 - 授予您首先设置侦听器（使用`expandableListView.setOnGroupClickListener(...)`and `expandableListView.setOnChildClickListener(...)`）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-25T05:39:43.383

您必须将返回值更改为 true 而不是 false。使您的子视图可选择。

用这个：

```
 @Override
        public boolean isChildSelectable(int groupPosition, int childPosition) {
            return true;
        } 
```

代替：

```
@Override
        public boolean isChildSelectable(int groupPosition, int childPosition) {
            return false;
        } 
```

# mysql - Spring JPA 不存储实体

> ID：11529476
> 
> 赞同：0
> 
> 时间：2012-07-17T19:27:25.097
> 
> 标签：mysql, spring, jpa, annotations, persistence

我创建了一个基本的 Spring MVC / JPA / Hibernate 应用程序。我正在尝试保存一个 UserProfile 实体以测试我是否可以真正持久保存它，但没有保存任何内容，也没有引发异常。

在控制器方法中，我创建了一个简单的 UserProfile（它是一个 @Entity）并将其发送到服务方法。UserProfileServiceImpl 类用@Service 注释，addUserProfile(UserProfile profile) 方法用@Transactional 注释。

在服务方法中，我所做的只是调用一个 DAO 方法（使用 @Repository 注释的类）。在 DAO 方法中，我所做的只是调用 entityManager.persist(object)，其中 object 是用户配置文件对象。

*   没有任何内容写入服务器日志，并且日志级别为 INFO。
*   Mysql 查询日志中没有出现任何内容（我知道查询日志有效）
*   entityManager 被正确注入。
*   数据源已正确启动，因为当我输入错误的凭据时，我得到了 SQLExceptions。

我希望你能告诉我有什么问题。我将在下面发布我的一些代码和配置文件。

服务方式：

```
// The service method gets called from the controller. 
// Its class is annotated with @Service

@Transactional(readOnly = false)
public void addUserProfile(UserProfile userProfile) {
    userProfileDao.save(userProfile);
} 
```

道法：

```
// The save(T object) method is in the GenericDaoJpa class, which is the superclass
// of the UserProfileDaoJPA class that is referenced from the service.
// I have established that the entityManager is there and the object is a
// UserProfile. The @Repository annotation is on the child class UserProfileDaoJpa.

public void save(T object) {
    entityManager.persist(object);
} 
```

主应用程序-context.xml

```
<context:property-placeholder location="classpath*:**/*.properties"/>
<import resource="spring-jpa.xml"/> 
```

application-context-web.xml 文件

```
<mvc:annotation-driven />
<context:component-scan base-package="nl.codebasesoftware.produx" />

<bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="prefix" value="/WEB-INF/views/"/>
    <property name="suffix" value=".jsp"/>
</bean> 
```

spring-jpa.xml

```
<bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close" p:driverClassName="${db.driverClassName}"
      p:url="${db.url}" p:username="${db.username}" p:password="${db.password}"/>

<bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean"
      p:dataSource-ref="dataSource"/>

<bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager"
      p:entityManagerFactory-ref="entityManagerFactory"/>

<tx:annotation-driven mode="aspectj" transaction-manager="transactionManager"/>

<bean id="defaultLobHandler" class="org.springframework.jdbc.support.lob.DefaultLobHandler"/> 
```

持久性.xml

```
<persistence-unit name="mysqlPersistenceUnit" transaction-type="RESOURCE_LOCAL">
    <provider>org.hibernate.ejb.HibernatePersistence</provider>
    <properties>
        <property name="hibernate.dialect" value="org.hibernate.dialect.MySQL5InnoDBDialect"/>
        <property name="hibernate.hbm2ddl.auto" value="create-drop"/>
    </properties>
</persistence-unit>

<!-- Needed to properly process @PersistenceContext -->
<bean class="org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor"/> 
```

不知何故，这个设置没有向 Mysql 发送 SQL，但也没有抛出异常，所以我不知道发生了什么。希望你能帮忙:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T05:59:06.190

我认为您在服务中缺少交易传播。标记 readonly=false 只是将会话设置为自动刷新。但是设置适当的事务传播将确保开始事务和提交/回滚。

删除 mode="aspectj" 后它已经开始工作，因为我认为是因为根据 spring doc

> 默认模式“代理”将使用 Spring 的 AOP 框架处理要代理的注释 bean（遵循代理语义，如上所述，仅适用于通过代理传入的方法调用）。替代模式“aspectj”将改为使用 Spring 的 AspectJ 事务方面编织受影响的类（修改目标类字节码以应用于任何类型的方法调用）。AspectJ 编织需要在类路径上使用 spring-aspects.jar 并 启用**加载时编织**（或编译时编织）。（有关如何设置加载时编织的详细信息，请参阅标题为第 6.8.4.5 节“弹簧配置”的部分。）

可能你还没有配置[加载时间编织](http://static.springsource.org/spring/docs/2.5.x/reference/aop.html#aop-aj-ltw)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T22:36:05.623

好，我知道了。首先我以为我在这里找到了答案

[声明式事务 (@Transactional) 在 Spring 中不适用于 @Repository](https://stackoverflow.com/questions/9051721/declarative-transactions-transactional-doesnt-work-with-repository-in-sprin)

但经过更多测试后，我发现它不是

`<tx:annotation-driven mode="aspectj" transaction-manager="transactionManager"/>`

但它的内容。

删除`mode="aspectj"`属性后它开始工作！如果有人想评论为什么会这样，请这样做。

让我与您分享我的完整设置。这是针对带有 Hibernate 4 的 Spring 3.1。注意：为了“简洁”，我只发布了配置文件的内容，并省略了外部标签`<beans>`和`<persistence>`命名空间声明。我完全删除了 spring-jpa.xml 并将其内容移动到 application-context.xml 中。

web.xml 的内容

```
<?xml version="1.0" encoding="ISO-8859-1" ?>

<web-app xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee     http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd" version="2.4">

<display-name>My Spring MVC web application</display-name>

<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>classpath*:**/application-context.xml</param-value>
</context-param>

<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>

<servlet>
    <servlet-name>produxDispatcherServlet</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>classpath*:**/application-context-web.xml</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>produxDispatcherServlet</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping>
</web-app> 
```

application-context.xml 的内容：

```
<!-- main setup -->
<context:property-placeholder location="classpath*:**/*.properties"/>
<context:annotation-config/>
<context:component-scan base-package="nl.codebasesoftware.produx.domain" />
<context:component-scan base-package="nl.codebasesoftware.produx.service" />
<context:component-scan base-package="nl.codebasesoftware.produx.dao" />
<!-- Data and JPA setup -->
<bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close" p:driverClassName="${db.driverClassName}"
      p:url="${db.url}" p:username="${db.username}" p:password="${db.password}"/>
<bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean" p:dataSource-ref="dataSource"/>
<bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager" p:entityManagerFactory-ref="entityManagerFactory"/>
<tx:annotation-driven  transaction-manager="transactionManager"/>
<bean id="defaultLobHandler" class="org.springframework.jdbc.support.lob.DefaultLobHandler"/> 
```

application-context-web.xml 的内容：

```
<mvc:annotation-driven />

<context:component-scan base-package="nl.codebasesoftware.produx.controller" />

<bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="prefix" value="/WEB-INF/views/"/>
    <property name="suffix" value=".jsp"/>
</bean> 
```

webapps/META-INF/persistence.xml 的内容

```
<persistence-unit name="mysqlPersistenceUnit" transaction-type="RESOURCE_LOCAL">
    <provider>org.hibernate.ejb.HibernatePersistence</provider>
    <properties>
        <property name="hibernate.dialect" value="org.hibernate.dialect.MySQL5InnoDBDialect"/>
        <!-- <property name="hibernate.hbm2ddl.auto" value="create-drop"/>  -->
    </properties>
</persistence-unit>

<!-- Needed to properly process @PersistenceContext which injects the entity manager -->
<bean class="org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor"/> 
```

environment.properties 的内容：

```
db.url=jdbc:mysql://localhost:3306/yourDatabaseName
db.driverClassName=com.mysql.jdbc.Driver
db.username=yourUsername
db.password=yourPassword 
```

# jquery - jQuery 在 Safari 中无法完全运行

> ID：11529477
> 
> 赞同：0
> 
> 时间：2012-07-17T19:27:26.823
> 
> 标签：jquery, safari

我已经阅读了与 jQuery 和 Safari 相关的其他帖子，其他人遇到的问题似乎不适用于我的。我使用的是最新版本的 jQuery，dreamweaver 没有发现 javascript 的任何错误。我迫切需要找出为什么这不起作用。它在 chrome 和 firefox 中运行良好（不幸的是，我目前无法在 IE 上测试它）

```
<script src="../../zoom/jquery.min.js" type="text/javascript"></script>
<script src="../../zoom/epic-image-zoom.min.js" type="text/javascript"></script>

<script type="text/javascript">

jQuery(document).ready(function($){
  $('.my-image').epicZoom( {largeImage: '../../images/large/domestic_musings/Gaylen-Beyond_zoom.jpg', magnification: 1} );
});

</script>

</head>

<body>

<div id="wrapper">
<div id="header"> </div>
  <!--End "header"--> 

<div class="center"><img src="../../images/large/domestic_musings/Gaylen&amp;Beyond.jpg" alt="Gaylen and Beyond - large image " width="921" height="718" class="my-image" /></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:30:36.330

尝试使用`onload`事件，因为您正在处理大图像。当 dom 准备好而不是图像时会触发 dom ready 事件，因此您可能想尝试以下操作：

```
jQuery(window).load(function($){
  $('.my-image').epicZoom( {largeImage: '../../images/large/domestic_musings/Gaylen-Beyond_zoom.jpg', magnification: 1} );
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-11T20:21:06.090

而是在这里发布@sparky 的评论，以便人们真正看到它。这对我来说是解决办法。jQuery 事件没有在 Safari 中触发（但它们在其他浏览器上）。我去了 W3C HTML 验证器，修复了错误，并解决了问题。

> 您是否验证了您的 HTML？无效的 HTML 解释了大多数跨浏览器问题。虽然，你从来没有解释过你遇到了什么问题，所以我不知道。– Sparky 2012 年 7 月 17 日 19:30

# foursquare - FourSquare：我应该在哪里存储我的客户机密？

> ID：11529478
> 
> 赞同：2
> 
> 时间：2012-07-17T19:27:37.670
> 
> 标签：foursquare

有人说：

（由于 PHP 处理本地文件系统，实际上最好将您的 secrets.php 重新定位到 Web 服务器路径之外的位置。以防万一:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T06:05:58.033

这意味着您将 secrets.php 文件存储在“根目录之上”。这意味着它无法通过浏览器访问，但可以通过 php 包含在内`include()`。

这个[StackOverflow 问题](https://stackoverflow.com/questions/2370053/how-to-include-file-outside-document-root)更详细地解释了这一点。

# c - 局部变量转换成全局变量？

> ID：11529479
> 
> 赞同：0
> 
> 时间：2012-07-17T19:27:55.177
> 
> 标签：c, regex, shell

我在一个 C 文件中传递。C 文件包含包含局部变量的函数。给定任何 C 文件，我必须能够在特定方法（用户指定）中找到局部变量并使它们成为全局变量。（另一个只能处理全局变量的应用程序的规范）...

最简单的方法是什么？是通过 shell 脚本还是应该直接在 C 中。我应该使用正则表达式吗？我是否正在考虑以错误的方式做这件事？

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:32:44.863

您正在寻找变量的特定上下文，在您的情况下，上下文是在函数内部声明的局部变量。正则表达式可用于提取函数定义，但某种标记解析器会好得多。

使用 C 的简化语法可以发现，您可以自己获取函数字符串，并从那里可以找到局部变量本身。

但是，如果传入的 C 代码采用特定格式，IE 局部变量位于函数定义的顶部，则可以使用简单的正则表达式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T20:10:49.423

C99 将允许在整个函数中、在块内等声明变量，因此识别它们的任务很复杂。可以利用 yacc 和 flex 之类的词法分析器/解析器来标记 C 源文件，然后从生成的结构中提取变量声明。实现这个通用目的可能需要做很多工作。

# wordpress - 激活新的 WordPress 插件时出错

> ID：11529481
> 
> 赞同：0
> 
> 时间：2012-07-17T19:28:06.593
> 
> 标签：wordpress, plugins, hook

我正在学习开发插件，我在激活时遇到错误说

> 该插件在激活期间生成了 157 个字符的意外输出。如果您注意到“标头已发送”消息、联合提要问题或其他问题，请尝试停用或删除此插件。

我尝试删除并制作一个新的但同样的错误。这是我的代码（启动插件的基本 PHP 注释，没什么特别的）。

```
/*
Plugin Name: Awesomeness
Plugin URI: http://www.example.com/
Author URI: http://www.example.com/
Author: abc
Description: Just a fun plugin
*/
function fubs(){
    error.log("this is working");
}
register_activation_hook(__FILE__,'fubs'); 
```

PHP 代码之前或结尾没有空格。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T03:57:28.567

`error`是 PHP 代码中的未定义常量。您尝试将 JavaScript 与 PHP 混合使用，因此 PHP 会打印一条错误消息。

解决方案：在 PHP 中使用 PHP 代码，在 JavaScript 中使用 JavaScript 代码。

# asp.net - Windows Azure 应用程序崩溃 IISConfigurator.exe

> ID：11529489
> 
> 赞同：1
> 
> 时间：2012-07-17T19:28:41.570
> 
> 标签：asp.net, iis, azure, iis-express

我正在使用 Visual Studio Express 2012 和 Windows Azure SDK for .NET v11.0.5022，它安装了 IIS Express 8。当我尝试运行 Windows Azure 应用程序时，IISConfigurator.exe 将崩溃

![在此处输入图像描述](../Images/5f84cd4a43011d3f87b637a0f2277283.png)

这是日志文件

```
IISConfigurator Information: 0 : [00011404:00000001, 2012/07/17 19:18:56.304] Started 

iisconfigurator with args /start
IISConfigurator Information: 0 : [00011404:00000001, 2012/07/17 19:18:56.32] StartForeground selected. Check if an instance is already running
IISConfigurator Information: 0 : [00011404:00000001, 2012/07/17 19:18:56.341] Starting service WAS
IISConfigurator Information: 0 : [00011404:00000001, 2012/07/17 19:18:56.51] Starting service w3svc
IISConfigurator Information: 0 : [00011404:00000001, 2012/07/17 19:18:56.516] Starting service apphostsvc
IISConfigurator Information: 0 : [00011404:00000001, 2012/07/17 19:18:56.583] Unhandled exception: IsTerminating 'True', Message 'System.IO.FileNotFoundException: Could not load file or assembly 'Microsoft.Web.Administration, Version=7.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. The system cannot find the file specified.
File name: 'Microsoft.Web.Administration, Version=7.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'
   at Microsoft.WindowsAzure.ServiceRuntime.IISConfigurator.HostingEnvironment.ConfigureAnonymousAuthentication(String configPath)
   at Microsoft.WindowsAzure.ServiceRuntime.IISConfigurator.HostingEnvironment.Initialize(Boolean setupRewrite, String configPath)
   at Microsoft.WindowsAzure.ServiceRuntime.IISConfigurator.HostingEnvironment.Initialize(Boolean setupRewrite, String configPath)
   at Microsoft.WindowsAzure.ServiceRuntime.IISConfigurator.IISConfigurator.Initialize()
   at Microsoft.WindowsAzure.ServiceRuntime.IISConfigurator.WCFServiceHost.Open()
   at Microsoft.WindowsAzure.ServiceRuntime.IISConfigurator.Program.StartForgroundProcess()
   at Microsoft.WindowsAzure.ServiceRuntime.IISConfigurator.Program.DoActions(String[] args)
   at Microsoft.WindowsAzure.ServiceRuntime.IISConfigurator.Program.Main(String[] args)

WRN: Assembly binding logging is turned OFF.
To enable assembly bind failure logging, set the registry value [HKLM\Software\Microsoft\Fusion!EnableLog] (DWORD) to 1.
Note: There is some performance penalty associated with assembly bind failure logging.
To turn this feature off, remove the registry value [HKLM\Software\Microsoft\Fusion!EnableLog].
'
IISConfigurator Information: 0 : [00010228:00000001, 2012/07/17 19:19:07.934] Started iisconfigurator with args /start
IISConfigurator Information: 0 : [00010228:00000001, 2012/07/17 19:19:07.941] StartForeground selected. Check if an instance is already running
IISConfigurator Information: 0 : [00010228:00000001, 2012/07/17 19:19:07.963] Starting service WAS
IISConfigurator Information: 0 : [00010228:00000001, 2012/07/17 19:19:08.032] Starting service w3svc
IISConfigurator Information: 0 : [00010228:00000001, 2012/07/17 19:19:08.037] Starting service apphostsvc
IISConfigurator Information: 0 : [00010228:00000001, 2012/07/17 19:19:08.106] Unhandled exception: IsTerminating 'True', Message 'System.IO.FileNotFoundException: Could not load file or assembly 'Microsoft.Web.Administration, Version=7.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. The system cannot find the file specified.
File name: 'Microsoft.Web.Administration, Version=7.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'
   at Microsoft.WindowsAzure.ServiceRuntime.IISConfigurator.HostingEnvironment.ConfigureAnonymousAuthentication(String configPath)
   at Microsoft.WindowsAzure.ServiceRuntime.IISConfigurator.HostingEnvironment.Initialize(Boolean setupRewrite, String configPath)
   at Microsoft.WindowsAzure.ServiceRuntime.IISConfigurator.HostingEnvironment.Initialize(Boolean setupRewrite, String configPath)
   at Microsoft.WindowsAzure.ServiceRuntime.IISConfigurator.IISConfigurator.Initialize()
   at Microsoft.WindowsAzure.ServiceRuntime.IISConfigurator.WCFServiceHost.Open()
   at Microsoft.WindowsAzure.ServiceRuntime.IISConfigurator.Program.StartForgroundProcess()
   at Microsoft.WindowsAzure.ServiceRuntime.IISConfigurator.Program.DoActions(String[] args)
   at Microsoft.WindowsAzure.ServiceRuntime.IISConfigurator.Program.Main(String[] args)

WRN: Assembly binding logging is turned OFF.
To enable assembly bind failure logging, set the registry value [HKLM\Software\Microsoft\Fusion!EnableLog] (DWORD) to 1.
Note: There is some performance penalty associated with assembly bind failure logging.
To turn this feature off, remove the registry value [HKLM\Software\Microsoft\Fusion!EnableLog].
' 
```

该应用程序似乎正在尝试绑定到安装了 IIS 版本 7.9.0.0（IIS 8 Release Candidate）的 IIS 版本 7.0。

有什么办法可以解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T20:42:47.337

有同样的问题，使用 MS Web 平台安装程序安装了“IIS 管理控制台”，它解决了这个问题。

发生这种情况是因为 IISConfigurator.exe 正在尝试使用对“Microsoft.Web.Administration, Version=7.0.0.0...”的引用，这是我在安装管理控制台之前没有的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-18T11:13:12.213

如果 IIS Express 不起作用，您始终可以使用完整的 IIS。在 Windows Azure 项目的属性页，点击 Web 标签，可以选择使用完整的 IIS。

从屏幕截图来看，您使用的是 Windows 7（因为您的窗口有圆角）。请注意，Windows 7 仅支持完整的 IIS 7。还请确保您已在 Windows 功能中启用完整的 IIS。如果要使用完整的 IIS 8，则需要使用 Windows 8 或 Windows Server 8。

# cakephp - CakePHP 1.3 版精灵组件/教程

> ID：11529491
> 
> 赞同：2
> 
> 时间：2012-07-17T19:28:44.813
> 
> 标签：cakephp

有人可以指点我正确的方向吗，我正在寻找有关如何在 cakephp 1.3 版中创建表单向导的教程

提前感谢您的回答。路易斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T08:29:15.133

尝试[表单向导 Jquery 插件](http://thecodemine.org/)。这在某种程度上与您可能需要的相同。

# ios - 如何以编程方式从 iOS 访问 Safari 的阅读列表

> ID：11529493
> 
> 赞同：17
> 
> 时间：2012-07-17T19:28:53.873
> 
> 标签：ios, safari

是否可以从 iOS 以编程方式访问 Safari 的“阅读列表”？我知道可以从 Mac 上执行此操作，如下所述：

[https://discussions.apple.com/thread/3238741?start=0&tstart=0](https://discussions.apple.com/thread/3238741?start=0&tstart=0)

谢谢，gb

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-09-19T07:53:58.430

iOS 7 添加了一个 API 来将项目添加到阅读列表中：

```
#import <SafariServices/SafariServices.h>

SSReadingList *readList = [SSReadingList defaultReadingList];
NSError *error = nil;

BOOL status = [readList addReadingListItemWithURL:[NSURL URLWithString:urlToAdd]
                                            title:titleToAdd
                                      previewText:previewText
                                            error:&error];

if (status) {
    NSLog(@"Added URL");
}
else {
    NSLog(@"Error: %@", [error localizedDescription]);
} 
```

正如 Ashok 在评论中指出的那样，无法从阅读列表中检索项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-26T15:17:01.513

这是不可能的。没有用于访问阅读列表的 API。此外，如果您找出 plist 文件的位置也无济于事，因为沙盒环境无法访问它。

# java - 单击一次将 JTable 单元格值传递给 textarea

> ID：11529494
> 
> 赞同：0
> 
> 时间：2012-07-17T19:28:56.073
> 
> 标签：java, swing, jtable, jtextarea

在我的表单上，我有一个 jtable 和一个 textarea。我的表只有 2 列 - ID 和评论 当用户点击评论列中的单元格时是否有可能。单元格值会在编辑模式下出现在文本区域中吗？

我确实将单元格编辑器设置为单击

```
selectTable.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
TableColumn col = selectTable.getColumnModel().getColumn(1);
DefaultCellEditor singleclick = new DefaultCellEditor(new JTextField()); 
singleclick.setClickCountToStart(1); 
col.setCellEditor(singleclick); 
```

我有一个从编辑按钮调用的方法 outputSelection()。该方法从选定的单元格中获取值并将该值放入文本区域以进行编辑。

单击是否可以激活该方法，以便用户不必单击编辑按钮？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T20:27:31.800

您可以将鼠标侦听器附加到表格并从那里监视鼠标单击，获取选定的列/行，从而获取值

您可以提供自己的单元格编辑器，在设置编辑器值时更新文本区域

您可以扩展 te jtable & 当单元格编辑开始时，更新文本区域

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T23:47:16.540

是的，这是我在整个 Swing 应用程序中重复代码后学会使用的过程。我开始制作独立的方法来完成我想要的工作，然后我从按钮或鼠标单击的动作事件中调用这些方法。这样他们都执行相同的代码。

即使您有一个选项卡或输入键命令，您也可以让它执行与其他方法相同的方法以获得更一致的代码。

如果您的按钮使用单元格值执行特定代码，只需将所有代码提取到一个将单元格值作为输入的方法中。然后，您可以从任何事件调用相同的方法，并传入要在文本区域中显示的输入数据。

# css - css 样式表层次结构的重要性

> ID：11529495
> 
> 赞同：13
> 
> 时间：2012-07-17T19:29:05.200
> 
> 标签：css

我已经进行了一些谷歌搜索，但到目前为止，我还没有找到任何可以回答我关于 CSS 顺序或重要性的问题。

例如，内联覆盖外部。知道了。在外部添加 !important 可以覆盖内联。此外，从我所学过的所有内容来看，后来的风格会覆盖早期的风格。所以：

```
h1 { font-size: 12pt; }
h1 { font-size: 14pt; } 
```

将呈现 14pt 的字体大小。但情况并非总是如此。有时我想定义如下样式：

```
<div id="content">
    <input class="regular" type="text" />
    <input class="regular" type="text" />
    <input class="long" type="text" /> 
```

然后在css中：

```
#content input { width: 50%; }
.long { width: 75%; } 
```

但这并不总是有效。我在哪里可以看到重要性的顺序，因为所有这些都有特定的重要性级别：

```
input {} 
#content input {}
#content input.regular {}
#content input.long
input.regular {}
input.long {}
.regular {}
.long {} 
```

我真的不喜欢写 !important ，但是如果我不能具体弄清楚重要性的顺序，那么有时我必须更改 ids、classes 等。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-17T19:34:38.200

您要搜索的术语是“特异性”。

当您有两个（或更多）CSS 块，其选择器选择相同的 HTML 元素，并且都尝试在该元素上设置相同的 CSS 属性时，具有更具体选择器的块将胜出。

CSS 3 选择器规范详细说明了应该如何计算特异性，并且它具有合理的可读性：

*   [http://www.w3.org/TR/css3-selectors/#specificity](http://www.w3.org/TR/css3-selectors/#specificity)

还有一些很好的博客文章也描述了规则：

*   [http://coding.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/](http://coding.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/)
*   [http://reference.sitepoint.com/css/specificity](http://reference.sitepoint.com/css/specificity)

（请注意，当两个块具有*相同*特异性的选择器时，*只有随后*块的规则才会胜出，就像在您的示例中使用`h1`s 一样。具有更具体选择器的块中的规则将覆盖具有更具体选择器的块中的规则不太具体的选择器。）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-17T19:32:07.530

您正在体验 CSS 特异性。如果您有两种适用于同一元素的冲突样式，则有一个加权系统可以确定哪种样式获胜。你可以在这里读更多关于它的内容：

[http://css-tricks.com/specifics-on-css-specificity/](http://css-tricks.com/specifics-on-css-specificity/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-17T19:31:45.580

对于这种情况，这就是您要做的

```
#content input { width: 50%; }
#content .long { width: 75%; } 
```

选择具有其 ID 的元素将优先，因此您遇到了这个特定问题。将 ID 添加到您的选择中并更具体将解决问题

例如 ：

```
#content input.long { width: 75%; } 
```

甚至比

```
#content .long { width: 75%; } 
```

# java - 从 .docx 转换为 pdf 时，图像看起来不太好

> ID：11529499
> 
> 赞同：3
> 
> 时间：2012-07-17T19:29:08.443
> 
> 标签：java, pdf, apache-commons-io

我将*.docx*文件转换为*.pdf*文件，文本转换正常，但*.docx*文件中的图像没有出现，而是表示为一些特殊字符，下面是我的代码：

```
import com.lowagie.text.Document;    
import com.lowagie.text.Paragraph;    
import com.lowagie.text.pdf.PdfWriter;    
import java.io.File;    
import java.io.FileOutputStream;    
public class PDFConversion {

    /**
     * 14\. This method is used to convert the given file to a PDF format 15.
     * 
     * @param inputFile
     *            - Name and the path of the file 16.
     * @param outputFile
     *            - Name and the path where the PDF file to be saved 17.
     * @param isPictureFile
     *            18.
     */

    private void createPdf(String inputFile, String outputFile, boolean isPictureFile) {
        /**
         * 22\. Create a new instance for Document class 23.
         */
        Document pdfDocument = new Document();
        String pdfFilePath = outputFile;

        try {
            FileOutputStream fileOutputStream = new FileOutputStream(pdfFilePath);
            PdfWriter writer = null;
            writer = PdfWriter.getInstance(pdfDocument, fileOutputStream);
            writer.open();
            pdfDocument.open();

            /**
             * 34\. Proceed if the file given is a picture file 35.
             */
            if (isPictureFile) {
                pdfDocument.add(com.lowagie.text.Image.getInstance(inputFile));
            }

            /**
             * 41\. Proceed if the file given is (.txt,.html,.doc etc) 42.
             */

            else {
                File file = new File(inputFile);
                pdfDocument.add(new Paragraph(org.apache.commons.io.FileUtils
                        .readFileToString(file)));      
            }
            pdfDocument.close();
            writer.close();
        } catch (Exception exception) {
            System.out.println("Document Exception!" + exception);
        }
    }

    public static void main(String args[]) {
        PDFConversion pdfConversion = new PDFConversion();
        pdfConversion.createPdf("C:/Users/LENOVO/Downloads/The_JFileChooser_Component.doc",
                "E:/The_JFileChooser_Component.pdf", false);
        // For other files
        // pdfConversion.createPdf("C:/shunmuga/sample.html",
        // "C:/shunmuga/sample.pdf", false);
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-20T19:45:06.067

我不确定它可能是什么，但对于一些替代方案，请查看：

*   **[Apose.Words Library](http://www.aspose.com/categories/java-components/aspose.words-for-java/default.aspx)** for Java 它有一些非常酷的功能，其中之一是通过几行简单的行将 docx 转换为 pdf（而且它是可靠的）：

    ```
    Document doc = new Document("d:/test/mydoc.docx");
    doc.Save("d:/test/Out.pdf", SaveFormat.Pdf); 
    ```

*   **[Docx4j](http://www.docx4java.org/svn/docx4j/trunk/docx4j/docs/Docx4j_GettingStarted.html)** 可用于将 docx 和许多其他文件转换为 PDF，它首先使用基于[IText](http://itextpdf.com/download.php)的 HTML/XML然后将其转换为 PDF（所有库都包含在 docx4j 中，只是添加了 itext 链接以确保完整性）：

    ```
    org.docx4j.convert.out.pdf.PdfConversion c
     = new org.docx4j.convert.out.pdf.viaXSLFO.Conversion(wordMLPackage);//using xml
    // = new org.docx4j.convert.out.pdf.viaHTML.Conversion(wordMLPackage);//using html
    // = new org.docx4j.convert.out.pdf.viaIText.Conversion(wordMLPackage);//using itext libs 
    ```

如果这还不够，它有[示例源代码](http://www.docx4java.org/svn/docx4j/trunk/docx4j/src/main/java/org/docx4j/samples/CreatePdf.java)供您尝试。

*   **[xdocreport](http://code.google.com/p/xdocreport/)** 还附带了很多用于转换的[示例](http://code.google.com/p/xdocreport/downloads/detail?name=docxandvelocity.converters-0.9.8-sample.zip)（尚未下载，但应该有 doc/docx 到 PDF 转换器的源）

# android - Setvbuf 用于在 C++ 中打开创建的文件描述符？

> ID：11529500
> 
> 赞同：4
> 
> 时间：2012-07-17T19:29:12.757
> 
> 标签：android, c++, c

有谁知道如何将 int 文件描述符缓冲区设置为无缓冲区并立即刷新？我试过使用`setvbuf`，但它需要一个`FILE*`not `int fd`。

凯文

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T19:46:22.897

与 an 关联的文件`int`是操作系统句柄。 [`setvbuf()`](https://en.cppreference.com/w/c/io/setvbuf)使用 C 运行时库管理缓冲区`FILE`。

为了防止缓冲，您必须使用适当的操作系统特定功能，这可能可以在文件[打开](http://linux.die.net/man/2/open)时完成。例如，在 Linux 上

```
int fd = open ("/dev/whatever", O_APPEND | O_WRONLY | O_DIRECT); 
```

要刷新已写入的数据，请使用[`fsync()`](http://linux.die.net/man/2/fsync)：

```
#include <unistd.h>

...
fsync(fd); 
```

# c++ - 嵌套绑定到成员，需要一个指针，得到一个引用。做什么？

> ID：11529504
> 
> 赞同：0
> 
> 时间：2012-07-17T19:29:34.583
> 
> 标签：c++, visual-studio-2010, c++11, bind, unique-ptr

我有一个 foo 类型的 std::unique_ptr 映射，我正在尝试迭代映射，将每个映射的值传递给不在映射中的 foo 的公共成员。我很接近，但我无法弄清楚如何将最内层绑定的结果从对指针的引用转变。

鉴于：

```
class foo
{
public:
    bool DoWork(foo *);
};

std::map<long, std::unique_ptr<foo> map_t;

map_t foo_map_;
foo bar_;

std::for_each(std::begin(foo_map_), std::end(foo_map_), std::bind(&Foo::DoWork, &bar_, std::bind(&std::unique_ptr<foo>::get, /* This guy here -->*/std::bind(&std::pair<long, std::unique_ptr<foo>>::second, std::placeholders::_1)))); 
```

建议？我正在使用 Visual Studio 2010 SP1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:33:12.093

编译器错误是由于 const'ify 键类型的事实`std::map`，因此`value_type`of`map_t`不是`std::pair<long, std::unique_ptr<foo> >`而是`std::pair<long const, std::unique_ptr<foo> >`。为避免此类错误，最好使用`map_t::value_type`. 以下更改修复了该错误：

```
... std::bind(&map_t::value_type::second, std::placeholders::_1) ... 
```

在 C++11 中，您可以将其简化为：

```
for(auto const& kv : foo_map_)
    bar_.DoWork(&*kv.second); 
```

或者，使用`std::for_each`C++11 lambda：

```
for_each(foo_map_.begin(), foo_map_.end(), 
    [&bar_](map_t::value_type const& kv) { bar_.DoWork(&*kv.second); }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T19:40:16.327

### 简单真棒。。

*您可以通过使用一个非常小的lambda* 而不是*std::bind* -madness来简化您的代码，请参见下面的代码片段：

```
foo obj;

typedef std::map<long, std::unique_ptr<foo>> fooMap;

fooMap map_t; 
```

```
std::for_each (
  map_t.begin (), map_t.end (), 
  [&obj](fooMap::value_type& elem) {
    obj.DoWork (elem.second.get ());
  }   
); 
```

# mysql - MySQL LEFT JOIN NULL 值

> ID：11529512
> 
> 赞同：1
> 
> 时间：2012-07-17T19:30:03.303
> 
> 标签：mysql, join, where

这个问题是对 2012 年 3 月回答的问题的进一步说明。因为这是 4 个月后，我提出了一个新问题。参考：[MySQL LEFT JOIN - 值可以为 NULL](https://stackoverflow.com/questions/9607767/mysql-left-join-values-can-be-null)

我的 SQL 语句如下：

```
SELECT cs.case_id, cs.child_firstname, gu.* 
FROM tblcases AS cs 
LEFT JOIN tblguardians AS gu 
ON cs.case_id = gu.case_id AND gu.firstname LIKE '%Craig%'
WHERE cs.child_firstname LIKE '%Sally%' 
```

这工作正常：

1.  如果设置了两个值（根据上面的示例）。
2.  如果设置了 cs.child_firstname 并且 gu.firstname 只是一个通配符

但是，如果 cs.child_firstname 仅是通配符并且设置了 gu.firstname 则返回数据库中的所有行，包括 NULL 值 - 理想情况下，我不想要 NULL 值。

可以重写此查询以完成所有操作还是我需要超过 1 个查询？

**更新**

下面的字段是我表单中的字段，所有字段都使用 $_POST 传递并使用 PHP 处理。我希望这能说明数据的来源以及它与数据库表的关系。子字段在 tblcases 中，监护人字段在 tblguardians 中。

*   孩子的名字
*   孩子姓
*   儿童出生日期
*   监护人名字
*   监护人姓氏
*   监护人电话
*   卫报邮政编码

**更新 2**

SQL查询现在如下：

```
SELECT 
    DISTINCT(cs.case_id) AS case_id, CONCAT(cs.child_firstname, ' ', child_surname) AS childname, DATE_FORMAT(child_dob, '%d/%m/%Y') AS child_dob, DATE_FORMAT(created, '%d/%m/%Y') AS created, gu.firstname, gu.surname
FROM 
    tblcases AS cs 
LEFT JOIN tblguardians AS gu 
    ON cs.case_id = gu.case_id 
    AND gu.firstname LIKE '%$_POST[parent_firstname]%'
    AND gu.surname LIKE '%$_POST[parent_lastname]%'
WHERE 
cs.child_firstname LIKE '%$_POST[child_firstname]%' 
AND cs.child_surname LIKE '%$_POST[child_surname]%'
AND ('$_POST[child_firstname]' != '' OR gu.firstname IS NOT NULL) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T16:42:05.733

听起来理想的解决方案是“完全连接” - 返回两个表中的所有行，然后您将使用 where 子句来消除“双方均为空”的位置 - 例如 ifnull( gu.firstname, cs.child_firstname) 不是无效的

Mysql 不支持完全连接，所以你最好的选择是一个类似的联合

```
select blah
from tblcases 
join tblguardians on blah
where tblcases.child_firstname like childINPUT

union

select blah -- same blah as aobve
from tblcases 
join tblguardians on blah
where tblguardians.firstname like guardianINPUT 
```

# ruby - 使用符号访问实例变量？

> ID：11529514
> 
> 赞同：4
> 
> 时间：2012-07-17T19:30:13.723
> 
> 标签：ruby, block, symbols, proc

显然，Ruby 可以使代码块返回带有符号的实例变量的值。考虑：

```
class Person
    attr_accessor :fn
end

def give(n,&b)
    i=0
    while(i<n)
       aa = Person.new
       aa.fn = "name #{i}"
       i=i+1
       puts b.call(aa)
    end
end 
```

现在，`give(5, &:fn)`两者`give(5) {|x| x.fn}`都给

```
name 0
name 1
name 2
name 3
name 4
=> nil 
```

但`&:fn`真正的意思是什么？我知道＆符号可以将 Proc 转换为块，例如

```
bb = Proc.new {|x| x.fn}
give(5, &bb) 
```

那么这个符号`:fn`是什么意思呢？我在哪里可以看到这样的使用文档？我们可以使用符号来访问实例变量，例如 say`person:new`或`person[:new]`吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T20:01:34.193

简单的。声明

```
attr_accessor :fn 
```

没有定义某种特殊的实例变量。它声明了（大约）这种形式的两种方法：

```
def fn
  @fn
end
def fn=(v)
  @fn=v
end 
```

Ruby“语法”`&:fn`是运算符`&`尝试转换为 proc 的符号。你猜怎么着？`Symbol`实现`to_proc`。猜猜这看起来像：

```
def to_proc
  Proc.new {|obj| obj.__send__(self)}
end 
```

这捕获`self`，这是符号`:fn`，在调用时，它告诉`obj`执行方法`fn`，该方法返回实例变量的值。

编辑：回答问题的第二部分，不是和是。用你说的语法，不。但是您可以从符号中调用方法，`BasicObject#__send__`并且您可以对**非`attr_accessor`**实例变量执行相同的操作`Object#instance_variable_get`。

# inheritance - 如何使 NSCoding 与对象继承一起工作？

> ID：11529515
> 
> 赞同：2
> 
> 时间：2012-07-17T19:30:16.617
> 
> 标签：inheritance, state, nscoding

我正在尝试使用基本的父子对象继承系统编写一个简单的 RPG，该继承系统被保存并加载到游戏状态中，但是当加载发生时，父级没有数据出现，我很难理解为什么。

为简单起见，我做了一个简单的父子对象继承，其中，

`Player`从父母继承`Character`

我把所有东西都放在一个数组（`listOfPlayers`）中，然后归档对象；当我来加载数据时，`Character`对象不再存在。

我已经登录到控制台以下；

```
METHOD: saveGameState()
2012-07-17 20:12:24.762 TestState[72342:40b] self.listOfPlayers (1)
2012-07-17 20:12:24.762 TestState[72342:40b] p.name = BOB
2012-07-17 20:12:24.763 TestState[72342:40b] p.xp = 1000

METHOD: loadGameState()
2012-07-17 20:12:27.098 TestState[72342:40b] Last Save Date = 2012-07-17 19:12:24 +0000
2012-07-17 20:12:27.099 TestState[72342:40b] self.listOfPlayers (1)
2012-07-17 20:12:27.100 TestState[72342:40b] p.name = (null)
2012-07-17 20:12:27.101 TestState[72342:40b] p.xp = 1000
2012-07-17 20:12:27.102 TestState[72342:40b] State:Loaded 
```

保存状态似乎正在保存名称（`Character`模型的一部分），但随后加载状态的名称似乎为`null`

我不确定我做错了什么。

我的代码现在如下；

```
// Inside my app delegate
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    // Singleton
    GameStateManager *state = [GameStateManager sharedGameStateManager];
    [state setupGameState];
    return YES;
}

// Character.h
@interface Character : NSObject
<NSCoding>
{
    NSString *name;
}

@property (nonatomic, retain) NSString *name;

@end

// Character.m
@implementation Character
@synthesize name;

#pragma mark - NSCoding

-(id)initWithCoder:(NSCoder *)aDecoder
{
    self = [super init];

    if (self) 
    {
        NSLog(@"Loading character object");
        self.name   = [aDecoder decodeObjectForKey:@"name"];
    }

    return self;
}

-(void)encodeWithCoder:(NSCoder *)aCoder
{      
    // Archive the object
    NSLog(@"Archiving character object");

    [aCoder encodeObject:self.name forKey:@"name"];
}
@end

// Player.h
#import "Character.h"

@interface Player : Character
<NSCoding>
{
    NSNumber *xp; // xp points
}
@property (nonatomic, retain) NSNumber *xp;

+(NSMutableArray *) createPlayers;
@end

// Player.m
@implementation Player
@synthesize xp;

- (id)init {
    self = [super init];
    if (self) {
    }
    return self;
}

+(NSMutableArray *) createPlayers
{
    NSMutableArray *list = [NSMutableArray array];

    Player *p1 = [[Player alloc] init];
    [p1 setXp:[NSNumber  numberWithInt:1000]];
    [p1 setName:@"BOB"];
    [list addObject:p1];
    [p1 release];

    return list;
}

#pragma mark - NSCoding

-(id)initWithCoder:(NSCoder *)aDecoder
{
    self = [super init];

    if (self) 
    {
        self.xp = [aDecoder decodeObjectForKey:@"xp"];
    }

    return self;
}

-(void)encodeWithCoder:(NSCoder *)aCoder
{      
    // Archive the object
    [aCoder encodeObject:self.xp forKey:@"xp"];
}
@end

// GameStateManager.m file    
-(void)saveGameState
{
    NSLog(@"METHOD: saveGameState()");

    self.lastSaveDate   = [NSDate date];

    NSLog(@"self.listOfPlayers (%d)", [self.listOfPlayers count]);

    for (Player *p in self.listOfPlayers) {
        NSLog(@"p.name = %@", p.name);
        NSLog(@"p.xp = %d", [p.xp intValue]);
    }

    NSString *file = kGameSaveFile;    
    NSString *documentsDirectory = [MyHelpers getDocumentsDirectory];
    NSString *gameStatePath = [documentsDirectory stringByAppendingPathComponent:file];
    BOOL result;

    NSLog(@"gameStatePath = %@", gameStatePath);

    // Set up the encoder and storage for the game state data
    NSMutableData *gameData;
    NSKeyedArchiver *encoder;
    gameData = [NSMutableData data];
    encoder = [[NSKeyedArchiver alloc] initForWritingWithMutableData:gameData];

    // Archive the object
    [encoder encodeObject:self.lastSaveDate forKey:@"lastSaveDate"];
    [encoder encodeObject:self.listOfPlayers forKey:@"listOfPlayers"];

    // Finish encoding and write to disk
    [encoder finishEncoding];
    result = [gameData writeToFile:gameStatePath atomically:YES];
    [encoder release];

    if (result == YES)
    {
        NSLog(@"Result = OK");
    } else {
        NSLog(@"Result = BAD");
    }
}

-(void)loadGameState
{
    NSLog(@"METHOD: loadGameState()");

    NSString *file = kGameSaveFile;   
    NSString *documentsDirectory = [MyHelpers getDocumentsDirectory];
    NSString *gameStatePath = [documentsDirectory stringByAppendingPathComponent:file];

    NSMutableData *gameData;
    NSKeyedUnarchiver *decoder;    
    gameData = [NSData dataWithContentsOfFile:gameStatePath];

    // Check to see if the .dat file exists, and load contents
    if (gameData)
    {
        decoder = [[NSKeyedUnarchiver alloc] initForReadingWithData:gameData];

        self.lastSaveDate = [[decoder decodeObjectForKey:@"lastSaveDate"] retain];
        self.listOfPlayers = [[decoder decodeObjectForKey:@"listOfPlayers"] retain]; 

        [decoder finishDecoding];
        [decoder release];

        NSLog(@"Last Save Date = %@", self.lastSaveDate);
        NSLog(@"self.listOfPlayers (%d)", [self.listOfPlayers count]);

        for (Player *p in self.listOfPlayers) {
            NSLog(@"p.name = %@", p.name);
            NSLog(@"p.xp = %d", [p.xp intValue]);
        }

    } else {

        NSLog(@"No game data!");
        assert(-1);
        abort();

    }

    NSLog(@"State:Loaded");
} 
```

编辑，

我认为它必须有`if ( (self = [super initWithCoder:aDecoder]) )`并且`[super encodeWithCoder:aCoder];`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T08:14:58.247

使用

```
 if ( (self = [super initWithCoder:aDecoder]) ) and [super encodeWithCoder:aCoder]; 
```

帮助我解决了这个问题，这个[问题](https://stackoverflow.com/questions/7904298/using-nscoding-on-a-subclass-of-custom-class?rq=1)也有帮助的答案。

谢谢

# c++ - 反转十六进制值的数字

> ID：11529520
> 
> 赞同：2
> 
> 时间：2012-07-17T19:30:25.557
> 
> 标签：c++, hex

我需要取十六进制数字中的所有数字并“反转”它们：所有零都变成非零（F），所有非零都变成零。

我试过：

```
void someFunction(DWORD hexVal)
{
     //...
     hexVal = ~hexVal;
     //...
} 
```

这将 0xE0000000 更改为 0x1FFFFFFF 而不是 0x0FFFFFFF。

我怎样才能产生想要的结果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T19:36:38.793

这应该为您提供 2 个字节的所需结果。你明白了 4 个字节的想法。

```
hexval = ((hexval & 0xf000) ? 0 : 0xf000) |
         ((hexval & 0xf00) ? 0 : 0xf00) |
         ((hexval & 0xf0) ? 0 : 0xf0) |
         ((hexval & 0xf) ? 0 : 0xf); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-17T19:37:38.987

假设您真的意味着您想要零->非零，反之亦然，逐位计算：

```
DWORD invertDigits(DWORD in) {
    return (
        ((in & (0xF << 28)) ? 0x0 : (0xF << 28)) |
        ((in & (0xF << 24)) ? 0x0 : (0xF << 24)) |
        ((in & (0xF << 20)) ? 0x0 : (0xF << 20)) |
        ((in & (0xF << 16)) ? 0x0 : (0xF << 16)) |
        ((in & (0xF << 12)) ? 0x0 : (0xF << 12)) |
        ((in & (0xF << 8)) ? 0x0 : (0xF << 8)) |
        ((in & (0xF << 4)) ? 0x0 : (0xF << 4)) |
        ((in & (0xF << 0)) ? 0x0 : (0xF << 0))
    );
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-17T19:31:49.730

这是按位非运算的期望结果。0xE0000000 + 0x1FFFFFFF = 0xFFFFFFFF

做你想做的事情的绝对最快的方法是将它分成字节并使用查找表。

该解决方案采用的处理器相当于大约：24 次加法、4 次乘法和 4 次内存查找。乘法是数组索引的一部分。所有简单的数学运算都以大致相同的速度运行，除了乘法和内存查找稍长一些。您的里程可能会因您的处理器架构和执行的编译器优化而异。

```
unsigned int transform1(unsigned int value)
{
    // static const unsigned char ZZ = 0x0, ZF = 0xF, FZ = 0xF0, FF = 0xFF; // for C++

    #define ZZ (unsigned char) 0x00
    #define FZ (unsigned char) 0xF0
    #define ZF (unsigned char) 0x0F
    #define FF (unsigned char) 0xFF

    static const unsigned char lookup[256] = 
    {
        FF, FZ, FZ, FZ, FZ, FZ, FZ, FZ, FZ, FZ, FZ, FZ, FZ, FZ, FZ, FZ,
        ZF, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ,
        ZF, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ,
        ZF, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ,
        ZF, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ,
        ZF, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ,
        ZF, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ,
        ZF, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ,
        ZF, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ,
        ZF, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ,
        ZF, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ,
        ZF, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ,
        ZF, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ,
        ZF, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ,
        ZF, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ,
        ZF, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ, ZZ,
    }; // array takes up 1KB of RAM

    unsigned int result = 0;

    result |= lookup[(unsigned int)((value & (FF << 0 )) >> 0) ] << 0;
    result |= lookup[(unsigned int)((value & (FF << 8 )) >> 8) ] << 8;
    result |= lookup[(unsigned int)((value & (FF << 16)) >> 16)] << 16;
    result |= lookup[(unsigned int)((value & (FF << 24)) >> 24)] << 24;
    return result;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T19:36:21.040

您可能必须逐个字节，从 MSB 开始。检查该值是否在 16^6 和 16^7 之间（假设这是无符号的）。如果是，则添加到新数 0。如果不是，则添加到新数 2^31+2^30+2^29+2^28。

看看我在说什么？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-17T19:36:39.880

所以反转和否定是两个不同的东西。

反转获取每一位并产生其补码，如下所示：

```
 0xE0000000 = 1110 0000 0000 0000 0000 0000 0000 0000
~0xE0000000 = 0001 1111 1111 1111 1111 1111 1111 1111 = 0x1FFFFFFF 
```

如果你想要“除了零之外的任何东西都需要变成零”你想要布尔否定，即

```
hexVal = !hexVal; 
```

**编辑：**好的，所以在阅读了其他一些答案后，我终于得到了提问者的要求，这是我的个人版本，使用了一个巨大的数学表达式

```
n = ~(n | ((n & 0x77777777) << 1) | ((n & 0x88888888) >> 3)
        | ((n & 0x33333333) << 2) | ((n & 0xCCCCCCCC) >> 2)
        | ((n & 0x11111111) << 3) | ((n & 0xEEEEEEEE) >> 1)); 
```

# groovy - 如何同时执行两个任务并在 Groovy 中等待结果？

> ID：11529521
> 
> 赞同：6
> 
> 时间：2012-07-17T19:30:33.583
> 
> 标签：groovy, concurrency, gpars

我有一个大型处理任务，我认为通过并发性和并行性提高效率已经成熟。

我查看了 GPars 文档，发现它们很混乱，所以我希望这里的人们可以提供帮助。

我想并行执行的第一个任务目前看起来像这样：

```
def providerOneProgrammes = providerOneProgrammeService.getProgrammes(timeWindow)
def providerTwoProgrammes = providerTwoProgrammeService.getProgrammes(timeWindow) 
```

两者都返回一个对象列表，并且都可以并行运行。

我想一起执行它们，然后在处理返回列表之前等待它们完成（然后我将在列表之间查找匹配项，但我稍后会谈到）。

谢谢

拉克什

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-17T22:29:37.430

在这里利用 GPar 的最简单方法是使用`callAsync`. 这是一个简单的例子：

```
@Grab(group='org.codehaus.gpars', module='gpars', version='1.0-beta-2')

import groovyx.gpars.GParsPool

def providerOneProgrammeService(timeWindow) {
    println "p1 starts"
    Thread.sleep(4000)
    println "p1 still going"
    Thread.sleep(4000)
    println "p1 ends"
    return "p1 return value"
}

def providerTwoProgrammeService(timeWindow) {
    println "p2 starts"
    Thread.sleep(5000)
    println "p2 still going"
    Thread.sleep(5000)
    println "p2 still going"
    Thread.sleep(5000)
    println "p2 ends"
    return "p2 return value"
}

def results = []
GParsPool.withPool {
    results << this.&providerOneProgrammeService.callAsync("arg1")
    results << this.&providerTwoProgrammeService.callAsync("arg2")
}
println "done ${results*.get()}" 
```

# python - 来自 Scikit-Learn 的 K 均值的失真函数

> ID：11529524
> 
> 赞同：2
> 
> 时间：2012-07-17T19:30:39.870
> 
> 标签：python, k-means, scikit-learn

在进行 K 意味着通过 Scikit-Learn 进行聚类时，要获得失真函数（每个点到其中心的距离之和），一种简单的方法是获取中心 ( `k_means.cluster_centers_`) 并总结每个点的距离。

只是想知道是否有更快的方法？（就程序员时间而言）类似于直接函数调用之类的东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-18T08:19:08.117

`fit`这已经在该类的`inertia_`属性中预先计算过了`KMeans`。

```
>>> from sklearn.datasets import load_iris
>>> from sklearn.cluster import KMeans
>>> iris = load_iris()
>>> km = KMeans(3).fit(iris.data)
>>> km.inertia_
78.940841426146108 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-11-07T21:53:06.347

根据失真度量的定义，它可以是

> **每个示例到其最近的聚类中心的距离的平方和**。****

 **或者

> **到各个簇的质心的欧几里得平方距离的**平均值。****

 **对于后一种情况，您可以访问 [在 kmeans 的情况下，能否从惯性导出失真而不是从头开始重新计算？](https://datascience.stackexchange.com/questions/89960/can-distortion-be-derived-from-inertia-rather-than-recalculating-it-from-scratch)

**KMeans**中的惯性属性在[官方文档](https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html)中定义为

> 样本到它们最近的聚类中心的距离平方和，如果提供，则按样本权重加权。****

# sql - SQL 最新日期（按电路 ID）

> ID：11529526
> 
> 赞同：1
> 
> 时间：2012-07-17T19:30:42.827
> 
> 标签：sql

我需要有关此 sql 的帮助。我需要根据创建日期（字段名称-create_bill_date）找到每个电路 ID（字段名称-strip_ec_circuit_id）的最新日期。我只需要找到最新的日期，而其他的可以删除。你能帮我做这件事吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:47:37.420

这是一个基本的 group by 查询，应该适用于任何数据库：

```
select strip_ec_circuit_id, max(create_bill_date) as lastDate
from t
group by strip_ec_circuit_id 
```

我不确定你说的删除所有其他人是什么意思。你真的想从表中删除不是最大值的行吗？

# android - 您是否应该能够安装不是来自 Play 商店的数字签名 APK？

> ID：11529527
> 
> 赞同：0
> 
> 时间：2012-07-17T19:30:43.613
> 
> 标签：android, apk, google-play

我通过电子邮件将最终构建、数字签名的 APK 发送给客户。他们应该能够从他们的电子邮件中打开它，还是您只能在[此处提到](https://stackoverflow.com/questions/7772148/android-how-to-install-signed-apk-on-device)的外壳中打开已签名的 APK （或者当然是从 Play 商店）？他们以前可以通过我的电子邮件安装 APK，但从未进行过数字签名。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T19:42:05.537

如果客户在手机上收到电子邮件，他们应该可以直接从手机打开 .apk 进行安装。

您确实需要在**Settings => Application中允许安装****Unknown Sources**

 **这也是用户安装亚马逊商城的方式。亚马逊会向您发送一封电子邮件，您可以在其中打开 .apk 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:35:42.317

任何人都可以将签名的apk文件复制到手机SD卡，然后通过点击手机中的这个apk文件（从任何文件资源管理器应用程序），它的安装向导将为它自己打开。并会要求用户安装应用程序。

用户必须在设置中启用未知来源的安装。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T19:37:38.743

当然，您的客户将能够安装您的应用程序。只需点击手机中的 .apk 文件即可。**

# android - 如何检查哪个 Intent 启动了活动？

> ID：11529529
> 
> 赞同：17
> 
> 时间：2012-07-17T19:30:44.853
> 
> 标签：android

我有很多活动。他们每个人都有一个指向相同活动的意图。有没有办法找出启动活动的意图？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-07-17T19:36:20.840

尝试：

```
Intent intent = new Intent();  
intent.setClass(A.this,Receiveractivity.class);
intent.putExtra("Uniqid","From_Activity_A");  
A.this.startActivity(intent);

Intent intent = new Intent();  
intent.setClass(B.this,Receiveractivity.class);
intent.putExtra("Uniqid","From_Activity_B");  
B.this.startActivity(intent);

Intent intent = new Intent();  
intent.setClass(C.this,Receiveractivity.class);
intent.putExtra("Uniqid","From_Activity_C");  
C.this.startActivity(intent); 
```

在主 Activity 的 onCreate 中：

```
//obtain  Intent Object send  from SenderActivity
 Intent intent = this.getIntent();

  /* Obtain String from Intent  */
        if(intent !=null)
        {
        String strdata = intent.getExtras().getString("Uniqid");
         if(strdata.equals("From_Activity_A"))
         {
         //Do Something here...
         }
         if(strdata.equals("From_Activity_B"))
         {
         //Do Something here...
         }
         if(strdata.equals("From_Activity_C"))
         {
         //Do Something here...
         }
         ........
        }
        else
        {
            //do something here
        } 
```

用于`putExtra`从每个 Activity 发送唯一密钥，以识别从哪个 Activity 接收意图

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-17T19:35:03.603

您没有提供任何上下文，因此这是一种通用方法。

在每个 Intent 类型中添加一个额外的内容，例如唯一的 int 或 String：

```
intent.putExtra("Source", "from BroadcastReceiver"); 
```

并使用：

```
String source = getIntent().getStringExtra("Source"); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-06-23T16:55:00.723

我找到了一个不涉及将数据从一个 Activity 传递到另一个的解决方案。

在您的调用活动中使用 startActivityForResult 来启动活动：

```
ActivityCompat.startActivityForResult(this, new Intent(this, MyActivity.class), 0, null); 
```

在被调用者Activity中，可以使用以下代码来检测调用Activity。

```
 if (getCallingActivity() != null) {
        Log.d(TAG, getCallingActivity().getClassName());
    } 
```

希望这可以帮助。干杯。

# java - 是什么导致此 JNA GMP 包装器中的段错误

> ID：11529533
> 
> 赞同：1
> 
> 时间：2012-07-17T19:30:49.683
> 
> 标签：java, jna, gmp

所以，下面的 java 代码在 finalize 期间会出现段错误。

```
public class Mpz_t extends com.sun.jna.Structure {
    public int _mp_alloc;
    public int _mp_size;
    public NativeLongByReference _mp_d;

    protected void initFieldOrder() {
        setFieldOrder(new String[] { "_mp_alloc", "_mp_size", "_mp_d" });
    }

    public Mpz_t() {
        super();
        initFieldOrder();
        allocateMemory();
        ensureAllocated();
    }

    public static class ByReference extends Mpz_t implements
        Structure.ByReference {

    }

    public static class ByValue extends Mpz_t implements
        Structure.ByValue {

    }

    @Override public void finalize() {
        Gmp.gmp().__gmpz_clear(this);
    }
} 
```

`.__gmpz_clear()`据我所知，破坏了 C 端的结构。如果我撕掉那部分，就没有段错误，但我的代码会泄漏内存。有人对此有想法吗？

我可能会补充一点，它不可靠的段错误。在问题发生之前，它可能会正确破坏其中的 20 个结构。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T20:11:18.183

所以我找到了我自己问题的答案，解决方案目前是半hacky。

问题是 JNA 调用`__gmpz_clear`与垃圾收集器在不同的线程上，有时垃圾收集器在`__gmpz_clear`完成执行之前会破坏指针数据和其他东西。通过添加自旋锁`while(_mp_size > 0) ;`完全解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T20:24:04.863

为了确保清理以正确的顺序运行，您可能会考虑重写`Structure.autoAllocate(int size)`以返回一个自定义`Memory`对象，该对象会增加其现有的终结器，`__gmpz_clear`以便在实际释放分配的内存的现有终结器之前调用。

```
public class Mpz_t extends Structure {
    protected Memory autoAllocate(int size) {
        return new Memory(size) {
            protected void finalize() {
                GMP.gmp().__gmpz_clear(this);
                super.finalize();
            }
        };
    }
} 
```

这确保了内存在被释放之前*总是被“清除”。*

# java - Java中的内存问题

> ID：11529536
> 
> 赞同：1
> 
> 时间：2012-07-17T19:30:54.403
> 
> 标签：java, out-of-memory, heap-memory

我有一个多线程程序，它处理大量的字符串操作，执行几小时后，内存超出并导致“java.lang.OutOfMemoryError：Java 堆空间”问题。而且我已经把我的整个内存都用到了java程序上，即16 GB。

对于测试，我创建了以下示例程序以了解问题及其执行相同的问题，在重新初始化字符串生成器数千次后，它消耗超过 5-10MB 的内存，任何人都可以帮助克服这个问题.

```
StringBuilder strObj = new StringBuilder();
for(int i=0; i<50000; i++) {
    strObj = null;
    strObj = new StringBuilder();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:45:02.817

它在什么意义上消耗了 5-10MB 的内存？你在这里分配了那么多。在需要内存之前，Java 不会费心回收它。这不可能导致`OutOfMemoryError`，不是这种类型的代码。

那么，为什么不实际显示导致 OOME 的代码类型呢？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T10:21:32.277

感谢支持人员，实际上我的问题是通过调用**System.gc()**语句手动收集垃圾后解决的。

# objective-c - 错误：从 JSON 文件发送到 NSMutableArray 的不可变对象的变异方法

> ID：11529538
> 
> 赞同：3
> 
> 时间：2012-07-17T19:30:54.877
> 
> 标签：objective-c, xcode, popup, viewdidload

这似乎是一个相当普遍的问题，但我看过的解决方案并不能解决错误。我正在尝试从 JSON 文件中读取 NSMutableArray。我看到的许多建议都涉及使用**mutableCopy**或**[NSMutableArray arrayWithArray:] ，但这两种解决方案在使用如下所示的调用****replaceObjectAtIndex:withObject:**时都不能解决问题。如果您对如何解决此问题有任何建议，请告诉我。

**编辑：**我还想补充一点，库存列表是 NSMutableArray 对象的 NSMutableArray。

确切的错误是：

```
Terminating app due to uncaught exception 'NSInternalInconsistencyException', 
reason: '-[__NSCFArray replaceObjectAtIndex:withObject:]: 
mutating method sent to immutable object' 
```

我在实现文件的顶部定义了如下属性：

```
NSMutableArray *inventoryData; 
```

我正在尝试从 JSON 文件中读取它，如下所示：

```
- (void)readJSON
{
    //Code to get dictionary full of saves from JSON file (overworld.json) - includes the file path on the ipad as well as
    //the dictionary itself
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSString *localPath = [[NSString alloc] initWithString:[documentsDirectory stringByAppendingPathComponent:@"savedPaintGameData.json"]];
    NSString *filePath = [localPath mutableCopy];
    NSError *e = nil;

    // Read data from file saved previously - read the raw data from the path, then parse it into a dictionary using JSONObjectWithData
    NSData *RawJSON = [NSData dataWithContentsOfFile:filePath options:NSDataReadingMappedIfSafe error:&e];

    if (RawJSON == nil) {
        [self saveGameInitialize];
    } else {
        NSMutableDictionary *localDictionary = [[NSMutableDictionary alloc] initWithDictionary:[NSJSONSerialization JSONObjectWithData:RawJSON options:NSJSONReadingAllowFragments error:&e]];
        NSMutableDictionary *savedDataDictionary = [localDictionary mutableCopy];

        //inventoryData = [[savedDataDictionary objectForKey:@"inventory"] mutableCopy];
        inventoryData = [NSMutableArray arrayWithArray:[savedDataDictionary objectForKey:@"inventory"]];
    }
} 
```

然后我尝试替换 NSMutableArray 的给定索引处的对象，如下所示：

```
- (void)setInventoryData: (NSString *) colorKey: (int) change
{
    // Check if inventory already contains the paint and change the amount
    bool foundPaint = false;
    int newAmount = 100;    // Magic number prevents crashing @ removal check
    for (int i = 0; i < [inventoryData count]; i++) {
        NSMutableArray *object = [inventoryData objectAtIndex:i];
        if ([[object objectAtIndex:0] isEqualToString:colorKey]) {
            newAmount = [[object objectAtIndex:1] integerValue] + change;
            [[inventoryData objectAtIndex:i] replaceObjectAtIndex:1 withObject:[NSNumber numberWithInt:newAmount]];
            foundPaint = true;
            break;
        }
    }

    if (newAmount == 0) {
        [self removeInventoryColor:colorKey];
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-17T19:36:08.233

问题似乎围绕着您工作的深度......您正在创建的容器的可变版本仅适用于该“级别”。您稍后将索引到该级别（即访问更深一层的容器），该级别仍然是不可变的。`NSJSONReadingMutableContainers`首次反序列化 JSON 时尝试传递该选项：

```
NSUInteger jsonReadingOptions = NSJSONReadingAllowFragments | NSJSONReadingMutableContainers;
NSMutableDictionary *localDictionary = [[NSMutableDictionary alloc] initWithDictionary:[NSJSONSerialization JSONObjectWithData:RawJSON options:jsonReadinOptions error:&e]]; 
```

# java - 使用 apache poi 更改单元格颜色

> ID：11529542
> 
> 赞同：26
> 
> 时间：2012-07-17T19:31:09.147
> 
> 标签：java, excel, apache-poi

我正在使用 Apache POI 读取零件编号电子表格中的数据。我在我们的数据库中查找零件编号，如果我们有零件的 CAD 图纸，我将零件编号单元格涂成绿色，如果没有，我将其涂成红色。处理完成后，电子表格被保存。我遇到的问题是该列中的每个单元格都是绿色的。我已经逐步完成了代码，查找部件号的逻辑工作正常，确定单元格应该是什么颜色以及设置颜色和填充的逻辑似乎也可以正常工作。有什么想法我在这里做错了吗？

谢谢。

```
//Check the parts
for(int r=1;r<sheet.getPhysicalNumberOfRows();r++) {
    String partNumber = null;
    switch(cell.getCellType()) {
        case HSSFCell.CELL_TYPE_NUMERIC:
            long pNum = (long) cell.getNumericCellValue();
            partNumber = String.valueOf(pNum);
            break;
        case HSSFCell.CELL_TYPE_STRING:
            partNumber = cell.getStringCellValue();
            break;
        default:
            logger.info("Part Number at row " + r + " on sheet " + partList.getSheetName(s) + "is of an unsupported type");
    }

    try {
        List<String> oldMaterialNumbers = getOldMaterialNumbers(partNumber);

        boolean gotDrawing = checkPartNumber(oldMaterialNumbers, partNumber);
        //If there's a drawing then color the row green, if not red.
        short bgColorIndex = gotDrawing
                                ?HSSFColor.LIGHT_GREEN.index //42
                                :HSSFColor.RED.index; //10

        HSSFCell curCell = row.getCell(partNumberColumn);
        HSSFCellStyle curStyle = curCell.getCellStyle();

        curStyle.setFillPattern(HSSFCellStyle.SOLID_FOREGROUND);
        curStyle.setFillForegroundColor(bgColorIndex);

        curCell.setCellStyle(curStyle);

    }catch(Exception e) {
        throw e;
    }
} 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-07-17T20:13:05.157

短版：只创建一次样式，随处使用。

长版：使用一种方法创建您需要的样式（注意样式数量的限制）。

```
private static Map<String, CellStyle> styles;

private static Map<String, CellStyle> createStyles(Workbook wb){
        Map<String, CellStyle> styles = new HashMap<String, CellStyle>();
        DataFormat df = wb.createDataFormat();

        CellStyle style;
        Font headerFont = wb.createFont();
        headerFont.setBoldweight(Font.BOLDWEIGHT_BOLD);
        headerFont.setFontHeightInPoints((short) 12);
        style = createBorderedStyle(wb);
        style.setAlignment(CellStyle.ALIGN_CENTER);
        style.setFont(headerFont);
        styles.put("style1", style);

        style = createBorderedStyle(wb);
        style.setAlignment(CellStyle.ALIGN_CENTER);
        style.setFillForegroundColor(IndexedColors.LIGHT_CORNFLOWER_BLUE.getIndex());
        style.setFillPattern(CellStyle.SOLID_FOREGROUND);
        style.setFont(headerFont);
        style.setDataFormat(df.getFormat("d-mmm"));
        styles.put("date_style", style);
        ...
        return styles;
    } 
```

您还可以在创建样式 hashmap 时使用方法来执行重复性任务

```
private static CellStyle createBorderedStyle(Workbook wb) {
        CellStyle style = wb.createCellStyle();
        style.setBorderRight(CellStyle.BORDER_THIN);
        style.setRightBorderColor(IndexedColors.BLACK.getIndex());
        style.setBorderBottom(CellStyle.BORDER_THIN);
        style.setBottomBorderColor(IndexedColors.BLACK.getIndex());
        style.setBorderLeft(CellStyle.BORDER_THIN);
        style.setLeftBorderColor(IndexedColors.BLACK.getIndex());
        style.setBorderTop(CellStyle.BORDER_THIN);
        style.setTopBorderColor(IndexedColors.BLACK.getIndex());
        return style;
    } 
```

然后，在您的“主要”代码中，从您拥有的样式映射中设置样式。

```
Cell cell = xssfCurrentRow.createCell( intCellPosition );       
cell.setCellValue( blah );
cell.setCellStyle( (CellStyle) styles.get("style1") ); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-16T11:24:20.503

要创建您的单元格样式，请参阅： http: [//poi.apache.org/spreadsheet/quick-guide.html#CustomColors](http://poi.apache.org/spreadsheet/quick-guide.html#CustomColors)。

自定义颜色

HSSF：

```
HSSFWorkbook wb = new HSSFWorkbook();
HSSFSheet sheet = wb.createSheet();
HSSFRow row = sheet.createRow((short) 0);
HSSFCell cell = row.createCell((short) 0);
cell.setCellValue("Default Palette");

//apply some colors from the standard palette,
// as in the previous examples.
//we'll use red text on a lime background

HSSFCellStyle style = wb.createCellStyle();
style.setFillForegroundColor(HSSFColor.LIME.index);
style.setFillPattern(HSSFCellStyle.SOLID_FOREGROUND);

HSSFFont font = wb.createFont();
font.setColor(HSSFColor.RED.index);
style.setFont(font);

cell.setCellStyle(style);

//save with the default palette
FileOutputStream out = new FileOutputStream("default_palette.xls");
wb.write(out);
out.close();

//now, let's replace RED and LIME in the palette
// with a more attractive combination
// (lovingly borrowed from freebsd.org)

cell.setCellValue("Modified Palette");

//creating a custom palette for the workbook
HSSFPalette palette = wb.getCustomPalette();

//replacing the standard red with freebsd.org red
palette.setColorAtIndex(HSSFColor.RED.index,
        (byte) 153,  //RGB red (0-255)
        (byte) 0,    //RGB green
        (byte) 0     //RGB blue
);
//replacing lime with freebsd.org gold
palette.setColorAtIndex(HSSFColor.LIME.index, (byte) 255, (byte) 204, (byte) 102);

//save with the modified palette
// note that wherever we have previously used RED or LIME, the
// new colors magically appear
out = new FileOutputStream("modified_palette.xls");
wb.write(out);
out.close(); 
```

XSSF：

```
 XSSFWorkbook wb = new XSSFWorkbook();
    XSSFSheet sheet = wb.createSheet();
    XSSFRow row = sheet.createRow(0);
    XSSFCell cell = row.createCell( 0);
    cell.setCellValue("custom XSSF colors");

    XSSFCellStyle style1 = wb.createCellStyle();
    style1.setFillForegroundColor(new XSSFColor(new java.awt.Color(128, 0, 128)));
    style1.setFillPattern(CellStyle.SOLID_FOREGROUND); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-17T22:07:05.360

我相信这是因为`cell.getCellStyle`最初返回默认单元格样式，然后您更改。

创建这样的样式并将它们应用于单元格：

```
cellStyle = (XSSFCellStyle) cell.getSheet().getWorkbook().createCellStyle(); 
```

尽管正如之前的海报所指出的那样，尝试创建样式并重用它们。

XSSF 库中还有一些实用程序类可以避免我提供的代码并自动尝试和重用样式。不记得0ff级的手了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-04-02T04:52:54.147

在此处查看示例

[http://svn.apache.org/repos/asf/poi/trunk/src/examples/src/org/apache/poi/ss/examples/BusinessPlan.java](http://svn.apache.org/repos/asf/poi/trunk/src/examples/src/org/apache/poi/ss/examples/BusinessPlan.java)

```
style.setFillForegroundColor(IndexedColors.LIGHT_CORNFLOWER_BLUE.getIndex()); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-07-05T11:21:53.723

对于 apache POI 3.9，您可以使用以下代码：

```
HSSFCellStyle style = workbook.createCellStyle()
style.setFillForegroundColor(HSSFColor.YELLOW.index)
style.setFillPattern((short) FillPatternType.SOLID_FOREGROUND.ordinal()) 
```

3.9版本的方法接受short，你应该注意输入。

# wso2 - 如何检查一个代理服务对另一个代理服务的响应是否是 FAULT 消息？

> ID：11529544
> 
> 赞同：0
> 
> 时间：2012-07-17T19:31:11.867
> 
> 标签：wso2, wso2esb

我在 MAC OSX 10.7.4 上使用 WSO2 ESB 4.0.3 和 Java 6。我还安装了数据服务功能。

在典型的场景中，我有一个客户端调用的代理服务，我将一个请求传递给数据服务。现在，如果我有从数据服务返回到代理的 FAULT 消息，我如何在代理服务中检查来自数据服务的响应是故障还是正常有效响应？

目前我在代理服务之外使用以下过滤器中介逻辑

```
 <filter xpath="get-property('FAULT')">
            <then>
                <log category="ERROR" level="custom" separator=",">
                    <property name="OWCHECK-faultMessage" value="TQS_OWCHECK - Received Fault From OWCHECK Data Service !!!!"/>
                    <property expression="$body" name="Fault-I-Got-Is"/>
                    <property name="OWCHECK-Forwading-Error" value="TQS_OWCHECK - Forwarding the Fault to Error Handler !!!!"/>
                </log>
            <else>
                <xslt key="conf:/tqs/owcheck/proxy-output-transform.xslt"/>
                <log category="INFO" level="custom" separator=",">
                    <property name="ValidResponse" value="TQS_OWCHECK - Sending Valid Response Back."/>
                </log>
                <send/>
            </else>
        </filter> 
```

但是，当axis2 在axis2.xml 中有NIO 发送器和接收器时，这种检查“FAULT”属性的逻辑有效。

如果我将axis2.xml中的接收器和发送器从NIO切换到标准servlet（org.wso2.carbon.core.transports.http.HttpTransportListener / org.wso2.carbon.core.transports.http.HttpTransportListener），我会怎么做没有设置“FAULT”属性，我的错误处理不起作用。

是否有一种标准方法可以检查一个代理服务对另一个代理服务的响应或数据服务对代理的响应是否为 FAULT？我正在寻找独立于传输发送者和接收者的东西，至少是 HTTP 的。

请帮忙。谢谢阿比吉特

我相信这不是一个好的文档，其中没有一个样本谈论如何处理从数据服务到代理服务的故障，或者我错过了什么？

如果我知道处理来自数据服务以及从一个代理到另一个代理服务的错误的最佳实践，我将不胜感激。

请帮忙。这是非常有声望的公司的大项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T05:40:11.363

我认为您需要检查soap body 元素是否有soap:fault 消息。您可以使用带有一些 xpath 表达式的过滤器中介来检查它。

# c# - Firebird 错误：打开连接时出现“操作系统指令 CreateFile 失败”

> ID：11529545
> 
> 赞同：2
> 
> 时间：2012-07-17T19:31:13.207
> 
> 标签：c#, firebird, firebird-.net-provider

我已将我的问题缩小到可以轻松产生此问题的小样本。

***简介 -*** 我使用 firebird 的嵌入式 dll 进行数据库连接，即 fbembed.dll 连接到 firebird 数据库。在代码中，我有三个这样的连接字符串（注意在第三个连接字符串中指定的附加属性客户端库） -

```
private const string connection1 = @"User=SYSDBA;Password=masterkey;Database=D:\DB1.fdb;ServerType=1;Charset=UTF8";
private const string connection2 = @"User=SYSDBA;Password=masterkey;Database=D:\DB2.fdb;ServerType=1;Charset=UTF8";
private const string connection3 = @"User=SYSDBA;Password=masterkey;Database=D:\DB2.fdb;ServerType=1;client library=D:\fbembed.dll;Charset=UTF8"; 
```

我在 UI 上有两个按钮，在第一个按钮单击时我有这个代码 -

```
FbConnection fbConnection = new FbConnection(connection1);
fbConnection.Open(); 
```

在第二个按钮点击我有这个代码 -

```
FbConnection fbConnection = new FbConnection(connection3);
fbConnection.Open(); 
```

如果我使用指定为 connection3 的连接字符串创建连接，我将收到 FbException *"operating system directive CreateFile failed"*。

但是，如果我将连接字符串替换为 connection2，它工作正常。

此外，如果我先创建与 connection3 的连接，然后与 connection1 没有问题，但如果我创建与 connection1 的连接，然后是 connection3，则会出现相同的 fbexception。

*注意，connection2 和 connection3 中指定的数据库是相同的，唯一的区别是附加的属性客户端库。*

为什么嵌入 firebird 会出现这种奇怪的行为。如果我的系统上安装了 firebird 服务器，一切正常。但是，我想知道为什么它仍然存在于 firebird 的嵌入式 dll 中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T14:14:39.603

您的问题与：[http ://tracker.firebirdsql.org/browse/CORE-2507 有关](http://tracker.firebirdsql.org/browse/CORE-2507)

这是 FB 引擎的一个 bug，在 2.1.4 版本中修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T18:05:00.220

问题是您正在使用 Firebird 服务器和嵌入的 Firebird 连接到数据库。第一个锁定数据库文件以便与其他进程一起打开（我认为您正在使用超级服务器）。

另一种选择是您使用来自不同位置的两个 fbembed.dll。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T09:14:53.600

这很有趣，但我解决了我的`Firebird 1.5 + Windows 7`问题！将 Firebird 安装为应用程序，然后以管理员身份运行 fb 应用程序，并以管理员身份运行批处理文件`(gbak.exe -b -v -g)`。摆脱：

```
**ERROR**:uavailable database
or
operating system directive CreateFile failed 
```

# qt - 我将如何使用 QStyledItemDelegate 使视图的一部分可编辑？

> ID：11529547
> 
> 赞同：1
> 
> 时间：2012-07-17T19:31:17.687
> 
> 标签：qt, model-view-controller

我正在尝试自学如何`QStyledItemDelegate`正确使用课程。Qt 有一个很棒的例子，我在这里读到：[Qt Spin Box Delegate Example](http://doc.qt.nokia.com/4.7-snapshot/itemviews-spinboxdelegate.html)。

但这是一个我似乎无法回答的问题。让我们看一下他们的示例屏幕截图。

![Qt Spin Box 委托截图](../Images/e98d1439db57b6c7b77bdb37402df5c8.png)

我将如何`SpinBoxDelegate`在他们的示例中编写以便我只能编辑部分数据，例如，只有第 2 列中的项目？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T19:40:56.107

我假设您已经在重新实现`QAbstractItemDelegate::createEditor()`

指示表中的某个索引不应该是可编辑的最简单方法是`NULL`从此函数返回，例如：

```
QWidget *QAbstractItemDelegate::createEditor( QWidget *parent, const QStyleOptionViewItem &option, const QModelIndex &index )
{
  if( index.column() == 0 )
    return NULL;

  return new QSpinBox( parent );
} 
```

您可以通过在模型中填充其他信息并使用`QModelIndex::data()`

# javascript - 如何使用 Jquery 基于多个选择框更改总和？

> ID：11529548
> 
> 赞同：0
> 
> 时间：2012-07-17T19:31:18.277
> 
> 标签：javascript, jquery, forms

我有一组具有不同数值的选择框，它们加在一起以产生总和。

每次我想要新值时都不必刷新页面，如何更改 Jquery 以便在表单中记住新的选定值，并在更改值时计算新的总和？

你可以在这里看到我想要做什么：http: [//jsfiddle.net/beehive/Za42G/3/](http://jsfiddle.net/beehive/Za42G/3/)

```
var combined = 0;
$("select").each(function() {
    combined += parseInt($(this).val());
});

$("#sum").html(combined);

$("#sum").change(); 
```

​</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T19:34:41.623

一种可能的方式：

```
$("select").change(function() {
    var combined = 0;
    $("select").each(function() {
        combined += parseInt(this.value, 10);
    });
    $("#sum").html(combined);
}).trigger("change");​ 
```

**演示：http:** [//jsfiddle.net/Za42G/4/](http://jsfiddle.net/Za42G/4/)

# google-app-engine - 应用引擎找不到图片

> ID：11529549
> 
> 赞同：0
> 
> 时间：2012-07-17T19:31:24.510
> 
> 标签：google-app-engine, gwt, playn

我正在使用 PlayN 开发一个 html5 游戏。它在 Eclipse 中运行良好。（Java 应用程序和 html）。但是我将它部署到应用引擎后，总是找不到5张图片。有谁知道原因？

谢谢！！！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T23:38:06.347

不愿提供更多信息，此类问题的通常原因是图像文件要么配置为获取资源（这使得 HTTP 无法访问），要么配置为静态文件（这使得应用程序无法打开它们）。

# ruby-on-rails-3 - Rails 会话找不到用户名 = 退出的用户；为什么用户控制器要寻找那个？

> ID：11529550
> 
> 赞同：0
> 
> 时间：2012-07-17T19:31:26.237
> 
> 标签：ruby-on-rails-3, session, activerecord, controller

我正在阅读 Michael Hartl 教程，但无法让注销工作正常进行。

我不是通过电子邮件识别，而是通过用户名工作。

注册和唱歌都可以正常工作，但我的退出导致错误：

```
ActiveRecord::RecordNotFound in UsersController#show

Couldn't find User with username = signout

app/controllers/users_controller.rb:9:in `show' 
```

为什么它在显示方法中的 users_controller 中查找？为什么这么叫？应该是调用会话控制器的delete方法吧？

违规的第 9 行是：

```
 8  def show
  9     @user = User.find_by_username!(params[:username])
  10 end 
```

我不明白参数在哪里传递（在哪里和什么地方），导致它认为“signout”== 用户名，而不是通过用户名查找和路由到`session#destroy`. 我该如何诊断？我可以在 Rails 控制台中输入什么来找出参数中当前包含的内容？

**更新：**

当我立即尝试时，我认为下面的解决方案有效，但问题刚刚从一条错误消息变为另一条错误消息。我已经按照建议移动了路线，但仍在继续

`Request Parameters: {"username"=>"signout"}`只是这次它位于我的

```
`Users#show model: users/show.html.erb where line #1 raised: 

undefined method username' for nil:NilClass 

Extracted source (around line #1): 

1: <\h2><%= @user.username %><\/h2> 
2: 
3: <!-- 
4:` 
```

这是我的 routes.rb 文件的内容：

```
 match 'signup', to: 'users#new'
   match 'signin', to: 'sessions#new'
   match 'signout', to: 'sessions#destroy', via: 'delete'

   resources :sessions, only: [:new, :create, :destroy]

   match "/:username"  => "users#show", via: "get"
   resources :users 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T19:46:40.920

我猜你有一条看起来像这样的路线：

```
get "/users/signout" => "sessions#destroy" 
```

在此之前，您可能有一行如下所示：

```
get "/users/:username" => "users#show" 
```

问题是路由到`/users/signout`将匹配`/users/:username`，并将您的请求发送到设置为的`show`操作。然后你打电话`UsersController``params[:username]``"signout"``User.find_by_username!("signout")`

您需要将您的`/users/signout`路线放在您的线路*上方，*`/users/:username`以便在路线之前匹配`/users/:username`。*请记住，Rails 在第*一个可以匹配请求 URI的路由处停止尝试查找匹配的路由。您的更通用的通配符路线必须出现*在*可能重叠的更具体的路线之后。

* * *

### 回复：你的更新

您的`signout`路由需要 HTTP DELETE 请求，该请求通过带有`_method=delete`参数的 POST 请求进行模拟。

为了匹配此路由，您需要使用表单或 a`button_to`来发出 DELETE 请求：

```
button_to "Signout", signout_path, :method => :delete 
```

销毁会话（在我看来）是一种特殊情况，您应该接受*任何*类型的 HTTP 请求。用户应该能够在他们的地址栏中输入`/logout`或`/signout`输入，并通过 GET 请求销毁他们的会话。我强烈建议您删除`via: :delete`并使用以下内容：

```
match 'signout' => 'sessions#destroy' 
```

相反，您对`signup`and`signin`路由过于宽容，应该专门使用 GET 和 POST 请求，并路由到`new`and`create`操作而不是相同的操作。

```
get 'signup' => 'users#new'
post 'signin' => 'sessions#create' 
```

* * *

> 我可以在 Rails 控制台中输入什么来找出参数中当前包含的内容？

没有什么。您无法`params`通过 Rails 控制台检查哈希，因为没有请求。您可以通过添加来检查您的日志文件`logger.info(params.inspect)`，或者在浏览器中通过将其提升为错误消息来检查：`raise params.inspect`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T20:12:16.567

我也遇到了这个问题，meagar 提到的修复并没有为我解决。我的问题实际上源于 JavaScript 和`DELETE`链接中使用的方法。显然，如果没有 JavaScript 的帮助，浏览器实际上并不支持该`DELETE`请求。

要重现，只需关闭 JavaScript 并尝试使用使用此请求的链接，您会注意到它使用`GET`请求而不是指定的`DELETE`. 最终，我需要包含需要`rails.js`（或`jquery-ujs`在我的情况下）解决此问题的 application.js。

# c++ - 无法使用 WSO2 (Axis2c) 执行简单的 SOAP 操作

> ID：11529551
> 
> 赞同：0
> 
> 时间：2012-07-17T19:31:30.423
> 
> 标签：c++, wso2

我已经使用 Scratchbox 为 ARM（诺基亚 N9）交叉编译了 WSO2，即使我也能做到这一点也很容易。我现在有了需要部署到设备上的库。

然后我使用 WSO2 CPP 生成 C++ 数据绑定并将它们添加为源文件（仅供参考 - 我在这里使用了来自 ebay 的 FindingService.wsdl：http: [//developer.ebay.com/webservices/finding/latest/FindingService.wsdl](http://developer.ebay.com/webservices/finding/latest/FindingService.wsdl)）

我正在尝试执行最简单的操作，基本上是 getVersion，但它不起作用，它以某种方式无法正确序列化对象，我不知道为什么。

这是我的 main.cpp 代码：

```
int mainGetVersionUsingWSOFCPP() {
Environment::initialize("wsof.log", AXIS2_LOG_LEVEL_DEBUG);
std::string client_home = "/opt/meebay/res/axis2c/axis2.xml";

//ServiceClient sc("http://svcs.ebay.com/services/search/FindingService/v1");

FindingServiceStub *stub = new FindingServiceStub(client_home);
Options * op = stub->getOptions();
op->setSoapVersion(AXIOM_SOAP12);

GetVersionRequest *req = new GetVersionRequest();
GetVersionRequestE8 *reqE8 = new GetVersionRequestE8(req);

GetVersionResponse *res = NULL;
GetVersionResponseE3 *resE3 = NULL;

ServiceClient *sc = stub->getServiceClient();

resE3 =  stub->getVersion(reqE8);

res = resE3->getGetVersionResponse();

} 
```

这是axis2c WSDL2CPP为这个特定的getVersion请求生成的代码：

```
com_ebay_www_marketplace_search_v1_services::GetVersionResponseE3* WSF_CALL FindingServiceStub::getVersion(com_ebay_www_marketplace_search_v1_services::GetVersionRequestE8*  _getVersionRequest)
     {
        axis2_svc_client_t *svc_client = NULL;
        axis2_options_t *options = NULL;
        axiom_node_t *ret_node = NULL;

        const axis2_char_t *soap_action = NULL;
        axutil_qname_t *op_qname =  NULL;
        axiom_node_t *payload = NULL;
        axis2_bool_t is_soap_act_set = AXIS2_TRUE;
        axutil_string_t *soap_act = NULL;

        com_ebay_www_marketplace_search_v1_services::GetVersionResponseE3* ret_val;

                            payload = _getVersionRequest->serialize(NULL, NULL, AXIS2_TRUE, NULL, NULL);

    svc_client = serviceClient->getAxis2SvcClient();

    options = clientOptions->getAxis2Options();
        if (NULL == options)
        {
            AXIS2_ERROR_SET(Environment::getEnv()->error, AXIS2_ERROR_INVALID_NULL_PARAM, AXIS2_FAILURE);
            AXIS2_LOG_ERROR(Environment::getEnv()->log, AXIS2_LOG_SI, "options is null in stub");
            return (com_ebay_www_marketplace_search_v1_services::GetVersionResponseE3*)NULL;
        }
        soap_act = axis2_options_get_soap_action( options, Environment::getEnv() );
        if (NULL == soap_act)
        {
          is_soap_act_set = AXIS2_FALSE;
          soap_action = "http://www.ebay.com/marketplace/search/v1/services/getVersion";
          soap_act = axutil_string_create(Environment::getEnv(), "http://www.ebay.com/marketplace/search/v1/services/getVersion");
          axis2_options_set_soap_action(options, Environment::getEnv(), soap_act);    
        }

        axis2_options_set_soap_version(options, Environment::getEnv(), AXIOM_SOAP11);

        ret_node =  axis2_svc_client_send_receive_with_op_qname( svc_client, Environment::getEnv(), op_qname, payload);

        if (!is_soap_act_set)
        {

          axis2_options_set_soap_action(options, Environment::getEnv(), NULL);    

          axis2_options_set_action( options, Environment::getEnv(), NULL);
        }
        if(soap_act)
        {
          axutil_string_free(soap_act, Environment::getEnv());
        }

                if ( NULL == ret_node )
                {
                    return (com_ebay_www_marketplace_search_v1_services::GetVersionResponseE3*)NULL;
                }
                ret_val = new com_ebay_www_marketplace_search_v1_services::GetVersionResponseE3();

                if(ret_val->deserialize(&ret_node, NULL, AXIS2_FALSE ) == AXIS2_FAILURE)
                {
                    if(ret_val != NULL)
                    {
                       delete ret_val;
                    }

                    AXIS2_LOG_ERROR( Environment::getEnv()->log, AXIS2_LOG_SI, "NULL returned from the _deserialize: "
                                                            "This should be due to an invalid XML");
                    return (com_ebay_www_marketplace_search_v1_services::GetVersionResponseE3*)NULL;
                }

                        return ret_val;

    } 
```

您可以提供的任何帮助都将受到欢迎，我一直在努力解决这个问题已经有一段时间了。

我只是尝试生成 WSDL 或 XSD 的 C++ XML 数据绑定对象，因此我不必手工制作每个请求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T22:01:44.643

对于其他坚持这一点的人 - 问题是我需要在 --enable-ssl 支持下编译 wsof/axis2c。

然后按照此处关于如何获取 ebay .crt 文件的说明进行操作（它保存为 .pem 但这是脚本的错误，.pem 文件包含 .crt 和 .key 文件，但这只包含 .crt 文件）：

[http://axis.apache.org/axis2/c/core/docs/axis2c_manual.html#ssl_client](http://axis.apache.org/axis2/c/core/docs/axis2c_manual.html#ssl_client)

我只需要设置 SERVER_CERT 参数。

原因是 URI 集是 https（不要混淆命名空间与仅 http - 它与端点不同，不要被愚弄假设这一点。）

就像我刚才想出来的那样，一定要加一点盐。我从 ebay 收到一条 SOAP 错误消息——但我只需要根据文档设置 HTTP 标头就可以了。

# c# - 基于另一个控件验证的样式标签

> ID：11529554
> 
> 赞同：0
> 
> 时间：2012-07-17T19:31:33.590
> 
> 标签：c#, wpf, validation, xaml, idataerrorinfo

当 ComboBox 出错时，我希望我的 ComboBox 旁边的标签文本变为红色，但是我目前如何设置标签的文本颜色仅在控件的初始加载时更新。当 ComboBox 中的选择发生更改时，如何进行 Label 的验证？还是有另一种方法来更新标签的样式？

我有以下 XAML：

```
<Style x:Key="labelStyle" TargetType="Label">
    <Setter Property="HorizontalContentAlignment" Value="Left" />
    <Setter Property="VerticalContentAlignment" Value="Center" />
    <Setter Property="Validation.ErrorTemplate">
        <Setter.Value>
            <ControlTemplate>
                <AdornedElementPlaceholder>
                    <Border BorderBrush="Transparent" BorderThickness="0" />
                </AdornedElementPlaceholder>
            </ControlTemplate>
        </Setter.Value>
    </Setter>

    <Style.Triggers>
        <Trigger Property="Validation.HasError" Value="true">
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="Red"/>
        </Trigger>
    </Style.Triggers>
</Style>

<Label Style="{StaticResource labelStyle}" Content="{Binding Path=Label, ValidatesOnDataErrors=True}" />

<ComboBox ItemsSource="{Binding Path=ItemList}" SelectedItem="{Binding Path=SelectedItem, ValidatesOnDataErrors=True}"/> 
```

然后在代码中：

```
public string this[string propertyName]
{
    get
    {
        if (propertyName == "Label")
        {
            if (this.IsRequired && !DelayValidation && SelectedItem == "")
                return Label + " required";
        }

        return null;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T23:08:53.323

根据您的操作方式，每当您的“SelectedItem”属性更改时，您还需要在“Label”属性上引发属性更改。

您可以通过仅使用 xaml 的解决方案来做到这一点，而不必在模型/视图模型（或您绑定的任何东西）上具有额外的属性。如果您有一个组合框，例如：

```
<ComboBox Name="comb" ItemsSource="{Binding Strings}" SelectedValue="{Binding Stringy,ValidatesOnDataErrors=True}" /> 
```

您可以制作如下标签：

```
<Label Content="Select a string">
    <Label.Style>
        <Style TargetType="Label">
            <Style.Triggers>
                <DataTrigger Binding="{Binding ElementName=comb,Path=(Validation.HasError)}" Value="True">
                    <Setter Property="Foreground" Value="Red" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </Label.Style>
</Label> 
```

或者，如果您希望在多个控件上使用此功能（或者如果您不想在标签的显式样式中使用此样式/触发器），您可以制作一个附加的属性/行为，例如：

```
public class LabelValidationHelper
{
    public static FrameworkElement GetDetailControl(DependencyObject obj)
    {
        return (FrameworkElement)obj.GetValue(DetailControlProperty);
    }

    public static void SetDetailControl(DependencyObject obj, FrameworkElement value)
    {
        obj.SetValue(DetailControlProperty, value);
    }

    public static readonly DependencyProperty DetailControlProperty = DependencyProperty.RegisterAttached("DetailControl", typeof(FrameworkElement), typeof(LabelValidationHelper), new UIPropertyMetadata(null, OnDetailControlChanged));       

    private static void OnDetailControlChanged(DependencyObject sender, DependencyPropertyChangedEventArgs args)
    {
        if (args.NewValue == null)
            return;

        var label = (Label)sender;

        var style = new Style(typeof(Label), label.Style);

        var binding = new Binding();
        binding.Source = args.NewValue;
        binding.Path = new PropertyPath(Validation.HasErrorProperty);

        var trigger = new DataTrigger();
        trigger.Binding = binding;
        trigger.Value = true;

        var setter = new Setter();
        setter.Property = Label.ForegroundProperty;
        setter.Value = Brushes.Red;

        trigger.Setters.Add(setter);

        style.Triggers.Add(trigger);

        label.Style = style;
    }

} 
```

你可以像这样使用它：

```
<Label Content="Select a string" example:LabelValidationHelper.DetailControl="{Binding ElementName=comb}" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-28T07:28:19.943

你只能用风格来做到这一点。

```
<Style TargetType="Label">
        <Setter Property="FontSize" Value="20"/>
        <Setter Property="FontWeight" Value="Bold"/>
        <Setter Property="Padding" Value="0,5"/>
        <Style.Triggers>
            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=(Target).(Validation.HasError)}" Value="True">
                <Setter Property="Foreground" Value="Red" />
            </DataTrigger>
            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=(Target).(Validation.HasError)}" Value="False">
                <Setter Property="Foreground" Value="Gray" />
            </DataTrigger>
        </Style.Triggers>
    </Style> 
```

并像这样使用它：

```
<Label Target="{Binding ElementName=NominaalBox}" Content="Nominaal (gram):"/>
<TextBox x:Name="NominaalBox" Text="{Binding Path=NominaalGram, Mode=TwoWay, TargetNullValue='', UpdateSourceTrigger=PropertyChanged}"/> 
```

# asp.net-mvc - ASP.NET MVC - 剃刀。使用@helper 创建面板

> ID：11529555
> 
> 赞同：1
> 
> 时间：2012-07-17T19:31:37.637
> 
> 标签：asp.net-mvc, razor-declarative-helpers

我正在尝试使用 ASP.NET MVC 中的 @helper 实用程序创建以下帮助程序。想法是创建一个 Panel 并从页面调用此帮助程序以设置面板的标题和正文（我希望在同一页面上有多个面板，因此我不能使用布局）。

这里是帮手：

```
@helper PanelHelper(string title, string body){
    <fieldset class="fieldset-border-2">
        <legend style="display: none;">Edit</legend>
        <div style="display: table;">
            <div style="display: table-row;">
                <div class="panel-first-row" style="display: table-cell;">
                    <div style="border-bottom: 1px solid #cecece; padding-left: 5px; height: 25px;">
                        <div style="display: table; margin: 9px 0 9px 0;">
                            <div style="display: table-row;">
                                <div class="title" style="display: table-cell;">
                                    @title
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="edit-row-separator" style="display: table-row;">
            </div>
            <div style="display: table-row;">
                <div style="display: table-cell;">
                    @body
                </div>
            </div>
        </div>
    </fieldset>
} 
```

在这里我想如何调用这个助手：

```
@Helpers.PanelHelper("Customers")
{
    <div style="display: table; width: 100%;">
        <div style="display: table-row; width: 100%;">
           ................ HTML => Customer Fields ......................
        </div>
    </div>
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T20:37:24.200

你真的应该这样称呼它：

```
@{
   string body = "<div style=\"display: table; width: 100%;\">
        <div style=\"display: table-row; width: 100%;\">
           ................ HTML => Customer Fields ......................
        </div>
    </div>";
}

@PanelHelper("Customers", body) 
```

在这里查看更多信息：[http ://weblogs.asp.net/scottgu/archive/2011/05/12/asp-net-mvc-3-and-the-helper-syntax-within-razor.aspx](http://weblogs.asp.net/scottgu/archive/2011/05/12/asp-net-mvc-3-and-the-helper-syntax-within-razor.aspx)

# c# - Windows 模拟以静默方式失败，没有错误并结束执行

> ID：11529560
> 
> 赞同：-1
> 
> 时间：2012-07-17T19:31:50.200
> 
> 标签：c#, .net, impersonation, windows-identity

我正在使用以下内容在 Windows 7 上模拟用户。此代码编译为 dll 并从 python 调用。通常它可以工作，但最近我们看到主要执行失败并追溯到“ `WindowsIdentity.Impersonate(safeTokenHandle.DangerousGetHandle());`”方法。当它被调用时，它不会冒充用户，不会引发错误，并且执行会立即停止（`Console.WriteLine()`不会调用右边的 after）。

有任何想法吗？请？我不想承认我花了多少时间试图解决这个问题。

谢谢！

```
using System;
using System.Runtime.InteropServices;
using System.Security.Principal;
using System.Security.Permissions;
using Microsoft.Win32.SafeHandles;
using System.Runtime.ConstrainedExecution;
using System.Security;

namespace PEServ.DataIntegration.Utilities
{
    public class WindowsCredentialHelper
    {

        [DllImport("advapi32.dll", SetLastError = true, CharSet = CharSet.Unicode)]
        public static extern bool LogonUser(String lpszUsername, String lpszDomain, String lpszPassword,
            int dwLogonType, int dwLogonProvider, out SafeTokenHandle phToken);

        [DllImport("kernel32.dll", CharSet = CharSet.Auto)]
        public extern static bool CloseHandle(IntPtr handle);

        public WindowsCredentialHelper()
        {
            Console.WriteLine("CS: WindowsCredentialHelper instance created successfully");
        }

        [PermissionSetAttribute(SecurityAction.Demand, Name = "FullTrust")]
        public WindowsImpersonationContext LogonAsUser(string username, string password, string domain)
        {
            SafeTokenHandle safeTokenHandle;

            const int LOGON32_PROVIDER_DEFAULT = 0;
            //This parameter causes LogonUser to create a primary token. 
            const int LOGON32_LOGON_INTERACTIVE = 2;

            Console.WriteLine("DotNet: Attempting to Logon user: {0}", username);
            // Call LogonUser to obtain a handle to an access token. 
            bool returnValue = LogonUser(username, domain, password,
                LOGON32_LOGON_INTERACTIVE, LOGON32_PROVIDER_DEFAULT,
                out safeTokenHandle);

            if (returnValue)
            {
                Console.WriteLine("DotNet: Successfully logged on as user: {0}", username);
            }
            else
            {
                Console.WriteLine("DotNet: Failed to create a user");

                int err = Marshal.GetLastWin32Error();
                if (err == 1909 || err == 1331)
                {
                    Console.WriteLine("Logon user failed because account is currently locked/disabled");
                }
                else
                {
                    Console.WriteLine("Logon user failed with error code: {0}", err);
                }

                throw new System.ComponentModel.Win32Exception(err);
            }

            //Console.WriteLine("DotNet: About to create a windows identity");
            //WindowsIdentity newId = new WindowsIdentity(safeTokenHandle.DangerousGetHandle());
            //Console.WriteLine("New windows identity is: {0}", newId.Name);

            //Console.WriteLine("Attempting to imperonate user: {0}", newId.Name);
            //WindowsImpersonationContext impersonatedUser = newId.Impersonate();
            //Console.WriteLine("DotNet: Impersonation of user: {0} was successful", newId.Name);

            Console.WriteLine("DotNet: Attempting to impersonate the user");
            WindowsImpersonationContext impersonatedUser = WindowsIdentity.Impersonate(safeTokenHandle.DangerousGetHandle());
            Console.WriteLine("DotNet: Impersonated the user");

            return impersonatedUser;

        }

        public void Undo(WindowsImpersonationContext impersonatedUser)
        {
            impersonatedUser.Undo();
        }

        public string GetCurrentUser()
        {
            return WindowsIdentity.GetCurrent().Name;

        }

        public string GetCurrentUserNameOnly()
        {
            return this.GetCurrentUser().Split(new char[] { '\\' })[1];

        }  
    }

    public sealed class SafeTokenHandle : SafeHandleZeroOrMinusOneIsInvalid
    {
        private SafeTokenHandle()
            : base(true)
        {
        }

        [DllImport("kernel32.dll")]
        [ReliabilityContract(Consistency.WillNotCorruptState, Cer.Success)]
        [SuppressUnmanagedCodeSecurity]
        [return: MarshalAs(UnmanagedType.Bool)]
        private static extern bool CloseHandle(IntPtr handle);

        protected override bool ReleaseHandle()
        {
            return CloseHandle(handle);
        }
    }
} 
```

根据 Ben 的建议改为 python：

```
 def impersonate_user(self, user_name, password, domain):
        handel=win32security.LogonUser(user_name, domain, password, win32con.LOGON32_LOGON_INTERACTIVE,win32con.LOGON32_PROVIDER_DEFAULT)
        win32security.ImpersonateLoggedOnUser(handel)
    print "Hello"

    return True 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-16T20:16:58.407

迟来的回答，但刚刚遇到这个问题。更改`LOGON32_LOGON_INTERACTIVE`为`LOGON32_LOGON_BATCH (4)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:41:03.680

您可以使用 和 直接从 Python 执行`LogonUser`此`ImpersonateLoggedOnUser`操作`RevertToSelf`。

只需这样做并删除使事情复杂化的 C#。

初始点：

*   [http://docs.activestate.com/activepython/2.6/pywin32/Windows_NT_Security_.2d.2d_Impersonation.html](http://docs.activestate.com/activepython/2.6/pywin32/Windows_NT_Security_.2d.2d_Impersonation.html)

# java - 我应该在方法声明中提及哪些异常，以及我应该在我的 catch 块中捕获哪些异常？

> ID：11529565
> 
> 赞同：0
> 
> 时间：2012-07-17T19:32:08.370
> 
> 标签：java, exception, exception-handling, core

假设我们有如下条件。

一个）

```
public void method() throws ... {

      XXXXXXXXXXXXXXXXXXXXXXX;
} 
```

或者

二）

```
public void method(){

  try{

      XXXXXXXXXXXXXXXXXXXXXXX;
   }catch(...){

      //doing something here
   }

} 
```

假设标有`"XXXX"`的行是可能引发异常的一行代码（假设该行不会引发错误）。

所以我的问题是，在第一种情况下（在方法声明中）我应该提到哪些异常以及我应该在我的 catch 块中捕获哪个异常？

***** 我知道仅仅抛出和捕获 Exception 异常就足够了，但我认为这不是一个好的设计。*******

 *** * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T19:39:35.690

似乎您在问如何判断给定方法将或可能抛出哪些异常。这很难回答，因为您没有告诉我们您要运行什么方法。但是 Java 的部分要点在于它是静态类型的，而且您实际上确实知道任何方法都可以抛出哪些异常。不显式捕获您调用的任何异常方法可能会触发是编译时错误，因此您会立即知道是否应该捕获某些东西。例外情况是`RuntimeException`它的孩子，它故意不属于编译时合同的一部分。

通常，`RuntimeException`s 不应该被捕获，它们表示您不应该让程序首先进入的某种状态（例如不检查`null`触发 a `NullPointerException`）但是您可以查看文档以了解您正在使用的方法看看他们可能会扔什么。例如，[`String.substring()`](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#substring%28int%29)说它可能会抛出一个`IndexOutOfBoundsException`. 通常，您应该提前进行必要的索引检查，但如果您不能提前这样做，您可以抓住它，如下所示：

```
int userInputWeCantTrust = -4;
try {
  System.out.println("foo".substring(userInputWeCantTrust));
} catch (IndexOutOfBoundsException e) {
  System.err.println("Looks like I can't trust you, user.");
} 
```

当您这样做时，您希望尽可能明确地使用异常类型（例如 catch `IndexOutOfBoundsException`， not `RuntimeException`），并在块中放置尽可能少的代码`try`。否则，您可能会意外捕获本应允许继续传播的异常。

* * *

决定接住还是扔掉是一个设计决策。如果您能够处理给定的异常，则将其包装在 try-catch 中，如果不能，则不要。

**示例一**，解析整数，默认为`default`on failure：

```
public static int parse(String s, int default) {
  try {
    return Integer.parseInt(s);
  } catch (NumberFormatException e) {
    return default;
  }
} 
```

**示例二**，解析用户输入，让main方法处理报错：

```
// the throws note here isn't actually necessary, since NFE is a RuntimeException
public static int parse(String s) throws NumberFormatException {
  return Integer.parseInt(s);
}

public static void main(String[] args) {
  try {
    for(String s : args){
      System.out.println(parse(s));
    }
  } catch (NumberFormatException e) {
    System.err.println("You entered an invalid number.");
  }
} 
```

这实际上取决于您的用例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T19:40:06.047

编译器将为您回答这些问题：您需要捕获`Exceptions`您的代码可以生成，**或者**将它们声明为由您的方法抛出。如果您遗漏了任何内容，编译器会抱怨。`RuntimeExceptions`是例外。

您唯一的选择是捕获这些特定异常或使用`throws`. 这种选择 - 哪些`Exceptions`被抛出，哪些被捕获，取决于您的特定目标。

您需要熟悉您正在使用的 API，部分 API 是`Exceptions`由 API 方法抛出的，但如果您错过了一个，那么您的代码将无法编译，让您有机会解决它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T19:39:57.453

简单地说：

1.  (a) 所有检查的异常
2.  (b) 所有处理的异常

如果您不处理异常，最好将它们标记为抛出，因为它们[成为该方法文档的一部分](http://docs.oracle.com/javase/tutorial/essential/exceptions/runtime.html)（例如 JavaDocs）：

> 方法可以抛出的任何异常都是该方法的公共编程接口的一部分。调用方法的人必须知道方法可以抛出的异常，以便他们可以决定如何处理它们。这些异常与其参数和返回值一样，都是该方法编程接口的一部分。

对于您的`catch`块，主要是确保您正在处理您正在捕获的任何异常（至少，记录异常消息）。您可能想尝试从异常中恢复，抛出不同类型的异常或只记录输出：

例如好：

```
catch(NullPointerException e) {
    variable = "default-value";
}

catch(NullPointerException e) {
    throw new OhNoesException();
}

catch(NullPointerException e) {
    log.warn(e.getMessage());
} 
```

如果您所做的只是放弃异常，那么最好抛出它。E,g, Bad（作为一般经验法则）：

```
catch(NullPointerException e) {} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T19:49:12.897

试着想想调用者对你的方法的期望。想想这是你的方法给调用者的“承诺”。

现在，假设你正在调用某个东西，你可能会得到一个异常。你可能会问自己的问题是：我是否仍然可以通过处理那个异常来履行我所做的承诺，然后继续？如果你不能：抛出异常（或者，或者，抛出一个不同的异常——通过将它包装在 MyApplicationException 或其他东西中）。

如前所述：这可能是一个设计问题——整数解析方法的“承诺”可能是“以最佳方式将字符串转换为数字”，在这种情况下，您不会抛出异常在任何情况下，或者它可能是“解析一个应该是整数的正确编码的字符串”；在这种情况下，抛出异常将是一个更好的主意。**

# asp.net - 使徽标跨多个分辨率居中

> ID：11529568
> 
> 赞同：0
> 
> 时间：2012-07-17T19:32:13.800
> 
> 标签：asp.net, css

我有一个徽标，我试图将其置于页面中心。从左到右的死点。我一直面临的问题是，当我在不同的显示器尺寸/分辨率上查看它时，它永远不会对齐居中。我在一种分辨率/尺寸上做对了，然后当我在较小的显示器上工作时，它没有对齐。这需要通过多个样式表或动态主题来完成吗？我在 ASP.NET 中对站点进行编码并设置了主题。如果需要，可以更改此设置。

```
<body>
<div class="wrap_1">
    <form id="form1"  runat="server">
    <!-- LOGO WRAP STARTS HERE-->

        <asp:Image SkinID="DefaultLogo" runat="server"/>

  <div style="background-color: #c5e8ea;"  >
  <!-- TITLE WRAP STARTS HERE-->
    <div class="wrap">
<div>
    <h1 style="padding-left:2em;">BLAH BLAH BLAH </h1>
    <h2 style="padding-left:5em;">BLAH BLAH BLAH </h2>
    <div>
 <!--CONTROLS -->
 <ul id="home-menu">
    <li>
        <asp:Button SkinID="Button1" runat="server" PostBackUrl="~/Reinstall.aspx"/>
    </li>
    <li>
        <asp:Button SkinID="Button2" runat="server" PostBackUrl="~/Registration.aspx" />
    </li>
</ul>

    </div>
  </div>
  </div>
  </div>
    </form> 
```

CSS

```
.DefaultLogo {
     margin: auto auto;
}

.wrap_1 {
    margin: 0 auto;
}

.wrap {
    margin: auto auto;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:35:31.320

您应该能够仅使用 CSS 来实现。

```
#theCoolestLogoEver{
  margin: auto auto;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T20:39:50.087

如果图像的宽度总是一定的宽度，比如说 300px，那么你可以应用这个 css 到它：

```
#Logo {
    width: 300px;
    height: 110px;
    position: relative;
    left: 50%;
    margin-left: -150px;
} 
```

不过，我会尝试使用“margin：0 auto”选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T19:39:47.100

您可以给您的图像一个 ID 或类并在 css 中设置它，或者只是将样式内联设置为

```
<img src="blah" style="margin: auto auto;"/> 
```

或在 CSS

```
<img src="blah" name="moo"/>

#blah { 
    margin: auto auto;
} 
```

或在 CSS 中使用类

```
<img src="blah" class="moo"/>

.blah { 
   margin: auto auto;
} 
```

我也注意到你在你的控制中使用 SkinID，我不认为它做你认为它做的事情。它设置应该在控件上使用什么皮肤，而不是

```
<asp:Image SkinID="DefaultLogo" runat="server"/> 
```

尝试

```
<asp:Image runat="server" CssClass="moo"/> 
```

并让你的 CSS 设置为

```
.blah { 
   margin: auto auto;
} 
```

# jquery - 每次更改我的下拉选择时，它都会删除最后一个下拉选项

> ID：11529570
> 
> 赞同：1
> 
> 时间：2012-07-17T19:32:19.073
> 
> 标签：jquery

我正在制作一个简单的下拉菜单，根据所选内容更改内容。然而，随着擦除以前的内容，jquery 也删除了最后一个下拉选项。

这是我的 HTML。

```
<body>
<h2>Analyze</h2>
<form id="analyze" method="get" action="/results/">
<div id="analyzecontainer">
<p>Search by: </p>
<select id="analyzeselector" class="dropdown" name="analyzeselector">
<option class="dropdownitem" name="select">Select</option>
<option id="byexercisename" class="dropdownitem" name="byexercisename">By Exercise Name </option>
<option id="bydate" class="dropdownitem" name="bydate" value="date">By Date</option>
<option id="byworkoutname" class="dropdownitem" name="byworkoutname" value="workoutname">By Workout Name</option>
</select>
<input id="exercisename" class="textbox required" type="text" name="exercisename" value="Enter Exercise Name">
</div>
<input class="textbox int" type="text" value="How many results" name="numresults">
<input id="submitquery" type="submit">
</form>
</body> 
```

现在这是我的 Jquery 代码：

```
$(document).ready(
function () {

$(document).on("change", "#analyzeselector", function () {
    var selected = $(this).find(':selected').attr("name");
    if ($("#analyzecontainer :last-child").attr('id') != 'analyzeselector') {
        alert($("#analyzecontainer :last-child").attr('id'))
        $("#analyzecontainer :last-child").remove()
    }

    if (selected == 'byexercisename') {

        $('<input>').attr({
            type: 'text',
            id: 'exercisename',
            name: 'exercisename',
            value: "Enter Exercise Name",
            class: "textbox required"
        }).appendTo('#analyzecontainer')

    }

    else if (selected == 'bydate') {
        $("#analyzecontainer").datepicker({ dateFormat: "yy-mm-dd" });

    }

}) 
```

})

同样，每次更改我的下拉选择时，它都会删除最后一个下拉选项。多谢你们！欣赏它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T19:49:21.313

这一行：

```
$("#analyzecontainer :last-child") 
```

没有做你认为它正在做的事情。它正在删除`#analyzecontainer`其父级的最后一个子级下面的每个元素。这包括 a 中的最后一个 `option`元素`select`。

您可以使用`:last`来获取容器的最后一个孩子：

```
var $lastChild = $("#analyzecontainer :last");
if ($lastChild.attr('id') != 'analyzeselector') {
    $lastChild.remove()
} 
```

**示例：http:** [//jsfiddle.net/bthzc/1](http://jsfiddle.net/bthzc/1)

# c++ - 如何在 msvc 中添加突出显示的关键字

> ID：11529576
> 
> 赞同：0
> 
> 时间：2012-07-17T19:32:49.707
> 
> 标签：c++, visual-c++, visual-c++-2010-express

我无意更改任何东西的语法或在编译期间对关键字进行任何不同的处理。我想要的只是为了我自己的视觉目的，当我在 msvc 中键入我选择的令牌时变成蓝色。大多数 IDE 都允许这种功能，我不明白为什么 msvc 和各种花里胡哨的东西不支持这种功能。我会去使用另一个 IDE，如果智能感知不是那么有用-_-。大佬们帮忙看看？

顺便说一句，已经找到[这个链接](http://msdn.microsoft.com/en-us/library/zy61y8b8%28v=vs.71%29.aspx)。devenv.exe 不存在 -_- 。

编辑：还应该提到我正在使用 msvc++ express。认为这只有在我付款时才可用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T20:08:03.533

实际上它确实有效，请查看本教程：

[http://arthy303.wordpress.com/2010/10/09/defining-keywords-in-visual-c/](http://arthy303.wordpress.com/2010/10/09/defining-keywords-in-visual-c/)

我将 my_var 更改为始终为红色（使用 VS C++ 2010 Express）：

![在此处输入图像描述](../Images/7b1b5fbee10aeac9c6c5edb519381dbe.png)

# ruby-on-rails-3 - 显示关联数据的最佳方式是什么？

> ID：11529579
> 
> 赞同：0
> 
> 时间：2012-07-17T19:32:53.193
> 
> 标签：ruby-on-rails-3

我有 3 个模型，基因型、Gmarkers 和 Gsamples，以下列方式关联：

```
class Genotype < ActiveRecord::Base
  attr_accessible :allele1, :allele2, :run_date
  belongs_to :gmarkers
  belongs_to :gsamples
end

class Gmarker < ActiveRecord::Base
  attr_accessible :marker
  has_many :genotypes, :dependent => :delete_all  
end

class Gsample < ActiveRecord::Base
  attr_accessible :box, :labid, :subjectid, :well
  belongs_to :gupload
  has_many :genotypes, :dependent => :delete_all
end 
```

当我显示 Gentypes 列表（在 index.html.erb 中）时，我以以下方式显示相关数据：

```
<% @genotypes.each do |f| %>
  <tr>    
    <td><%= Gmarker.find(f.gmarkers_id).marker %></td>
    <td><%= Gsample.find(f.gsamples_id).labid %></td>
    <td><%= f.allele1 %></td>
    <td><%= f.allele2 %></td>
    <td><%= f.run_date %></td>
    <td><%= link_to 'Show', f %></td>
    <td><%= link_to 'Edit', edit_genotype_path(f) %></td>
    <td><%= link_to 'Destroy', f, confirm: 'Are you sure?', method: :delete %></td>
  </tr>
<% end %> 
```

但是，页面需要一段时间才能加载，所以我想知道是否有一种更简单的方法来显示关联数据，而无需在每个循环中进行两次查找。我无法使用内置的参考 Rails 样式显示任何相关数据，例如：

```
f.GMarker.first.marker 
```

但是每当我在控制台中尝试时，我都会收到一系列错误

```
NameError: uninitialized constant Genotype::Gmarkers 
```

我不明白为什么控制台不知道 Gmarkers，因为他们的模型之间存在一对多的关系......

非常感谢任何帮助！

--瑞克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T03:31:35.847

在您的 Genotype 类中，将您的 belongs_to 声明更改为：

```
 belongs_to :gmarker
  belongs_to :gsample 
```

然后在您的视图 (index.html.erb) 上，替换以下代码：

```
<td><%= Gmarker.find(f.gmarkers_id).marker %></td>
<td><%= Gsample.find(f.gsamples_id).labid %></td> 
```

有了这个：

```
<td><%= f.gmarker.marker %></td>
<td><%= f.gsample.labid %></td> 
```

# c++ - 如何同时运行两个循环 - C++？

> ID：11529580
> 
> 赞同：-5
> 
> 时间：2012-07-17T19:32:55.157
> 
> 标签：c++, loops

就像我想检查一个字符串是否是回文一样，我如何使用两个同时循环来实现它，以便它可以在最短的行数内完成？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-17T19:38:03.460

由于这几乎可以肯定是一项家庭作业，因此这里是对没有代码的方法的解释。

你不需要两个循环，你需要两个*循环变量*。第一个在单词的开头，第二个在结尾，比较循环索引处的字符，如果不同则返回false。如果字符相同，则通过将前索引向前和后索引向后移动来移动到下一次迭代。当前索引等于或大于后索引时停止。

这是允许您在单个循环中使用两个循环变量的语法：

```
for (int front = 0, back = s.size() ; front < back ; front++, back--) ... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T19:42:03.743

*免责声明：这只是一个线程替代方案，我不建议使用此解决方案*

您可以启动两个线程并使用`queue`.

第一个线程从头开始迭代并将元素推入队列。

第二个从末尾开始并从队列的前面弹出元素（如果它们匹配）。

当元素不匹配或到达单词中间时停止。如果元素不匹配或队列最后不为空，则不是回文。

请注意，这需要一些严格的同步。不要这样做，只是正常解析它......我怀疑有任何性能提升。

# php - 如何使用 php 通过 https 下载文件

> ID：11529583
> 
> 赞同：3
> 
> 时间：2012-07-17T19:33:00.307
> 
> 标签：php, curl, https, download, security

我需要使用 PHP 下载一个 xml 文件。在对文件进行 curl 调用时，我可以通过设置以下选项来读取文件的内容。

```
curl_setopt ($http, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt ($http, CURLOPT_SSL_VERIFYHOST, false);
curl_setopt($http,CURLOPT_USERAGENT,'XYZ'); 
```

从上面的代码片段可以明显看出，我需要将 VERIFYHOST 设置为 false，并且还需要在调用读取文件时设置显式 USERAGENT，因为该文件不可公开访问，并且只有特定的应用程序可以调用读取它（Web-Security技术和东西）

但是如何下载相同的文件，我试过了，`readfile`但似乎没有任何效果。Readfile 给出错误`fopen/fpassthru``file_get_contents``failed to open stream: HTTP request failed! HTTP/1.0 403 Forbidden`

有没有办法用`fopen`or提供类似 curl 的选项`readfile`，我认为这可能是解决这个问题的最简单方法。我在 PHP 文档中找不到太多帮助。

请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T19:35:57.863

您需要将您的特殊用户代理附加到流上下文。

来自[http://www.php.net/manual/en/wrappers.http.php](http://www.php.net/manual/en/wrappers.http.php)

> 允许使用 HTTP GET 方法通过 HTTP 1.0 对文件/资源​​进行只读访问。Host: 标头随请求一起发送以处理基于名称的虚拟主机。**如果您[使用 php.ini 文件或流上下文配置了 user_agent 字符串](http://www.php.net/manual/en/filesystem.configuration.php#ini.user-agent)，它也将包含在 request 中**。

上面链接中的示例#2：

```
<?php
ini_set('user_agent', "PHP\r\nX-MyCustomHeader: Foo");

$fp = fopen('http://www.example.com/index.php', 'r');
?> 
```

# facebook - 获取两个 Facebook 好友之间的关系类型

> ID：11529585
> 
> 赞同：0
> 
> 时间：2012-07-17T19:33:07.967
> 
> 标签：facebook, facebook-graph-api, facebook-fql

我正在构建一个类似“线索”的游戏，你必须找到你的哪个朋友是罪犯，并提供一些线索来帮助你。

我试图找到一种方法来了解用户与我在朋友列表中挑选的朋友之间的关系；他们是朋友、家人还是熟人？我在 API 文档中找不到任何关于此的信息，并问自己是否有其他方法可以找到它。

这是我目前的要求，如果它可以帮助你......

```
$criminal_infos = $facebook->api(array(
        'method'=>'fql.query',
        'locale'=>'fr_CA',
        'query'=>'SELECT sex,relationship_status,education,current_location FROM user WHERE uid='.$criminal_id.''
    )); 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:42:49.763

您可以通过请求访问他们的好友列表然后查看有问题的用户 ID 在家人或密友等的好友列表中来实现。

[https://developers.facebook.com/docs/reference/api/FriendList/](https://developers.facebook.com/docs/reference/api/FriendList/)

# jquery - 如何找出拖放的项目

> ID：11529590
> 
> 赞同：1
> 
> 时间：2012-07-17T19:33:09.673
> 
> 标签：jquery

我想要做的是创建一个站点，将项目拖入放置区域，一旦将特定拖动的项目拖放到另一个特定 div 中滑动的函数，就会调用该函数。我不知道为什么我不能得到 if --- else if 工作。我的目标是拥有一个干净的函数，可以查看哪个项目被拖放，并根据拖放的项目，我想要一个特定的“发生的事情”，例如页面幻灯片。这是我的 jquery 代码：

```
$(document).ready(function(){
var i;
var banners = ('#banners');
var tryout = ('#try2');
var navItem = [banners, tryout];
var dropItem = (".nav");

// DRAGGABLE 
$(dropItem).draggable({

});

$("#dropArea").droppable({  
    drop: function() {  

        if ("dragged Item " == banners){
            $(".panel").toggle("fast");
                $(this).toggleClass("active")
        }

        else if ("dragged Item " == tryout){
           // and so on...
        }
    }

}); 

}); 
```

在这里编辑添加是我现在在这里的示例 www.diskrim.com/tryout $(dropItem).draggable({

```
});

$("#dropArea").droppable({  
    drop: function(event, ui) {  

        if (ui.draggable = navItem[0]){
            alert("banners");

        }
        else if (ui.draggable = navItem[1]){
            alert("just pop up");

        }
        else{

        }

    }

}); 

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:37:09.597

请参阅[jQuery UI 文档](http://jqueryui.com/demos/droppable/#event-drop)

`drop`回调有两个参数：`event`和`ui`。 `ui.draggable`是被拖到可放置区域的项目

# javascript - getElementById() 的另一个令人费解的行为

> ID：11529591
> 
> 赞同：3
> 
> 时间：2012-07-17T19:33:11.610
> 
> 标签：javascript, innerhtml

试试这个脚本：http: [//jsfiddle.net/8da54/1/](http://jsfiddle.net/8da54/1/)。为什么 Firefox 和 IE 的输出不同？

HTML：

```
<div id="div1">
<div id="div2"><div id="data">data</div></div>
<div id="div3">a-</div>
</div> 
```

Javascript：

```
var data = document.getElementById("data");
document.getElementById("div2").innerHTML="";
document.getElementById("div3").appendChild(data); 
```

输出：
FF：**a-data**
IE：**a-**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T19:45:32.423

似乎是众多 IE`.innerHTML`错误之一。同时，您可以以正确的方式删除元素：

```
var elem = document.getElementById("div2");
while (elem.firstChild) {
    elem.removeChild(elem.firstChild);
} 
```

[http://jsfiddle.net/8da54/2/](http://jsfiddle.net/8da54/2/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-17T20:16:55.643

看着你问的问题。为什么 FF 和 IE 这两个浏览器，对于 JavaScript 的三行表现不同。

JavaScript 通常会复制值类型和对对象的引用。在这种特殊情况下，根据浏览器的不同，引擎在实现上存在分歧。因此，当您不确定您是在复制还是引用时。尽可能克隆对象以避免冲突。

```
var data = document.getElementById("data").cloneNode(true);
//lot's of intensive work with the cloned 'data'-object, function calls etc.
document.getElementById("div2").innerHTML="";
document.getElementById("div3").appendChild(data); 
```

这样，您还可以确定您已将“数据”对象从渲染树中拉出，并且可以在插入结果之前以任何方式安全地操作它，而不必担心性能。我的经验是，尽可能避免直接在浏览器 DOM（渲染树）中工作总是一个好主意。

就个人而言，为了清楚起见，我会保留以下两行，因为它们的意图很明显，并且可读性总是增强可维护性。特别是当性能相同时，如果不是更好（IE）。

# node.js - 服务帐户是在 node.js 中查询 google bigquery 的正确凭据吗？

> ID：11529595
> 
> 赞同：2
> 
> 时间：2012-07-17T19:33:38.583
> 
> 标签：node.js, google-api, google-bigquery, jwt

我已经在 Google API 控制台中创建了一个服务帐户，下载了 .p12 文件，现在我正在尝试使用[https://github.com/hokaccha/node-jwt-simple](https://github.com/hokaccha/node-jwt-simple)对令牌请求进行签名。

我应该在哪里/如何获得用 HS256 签名的“秘密”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T14:04:22.427

原来是我使用的 openssl 命令有问题。如果有人遇到同样的问题，请确保使用“-nodes”参数，如下所示：

openssl pkcs12 -in file.p12 -out file.pem -nodes

然后只需将 .pem 文件的内容作为签名令牌的密钥传递。

祝你好运！

# android - EditText 画线错误

> ID：11529597
> 
> 赞同：1
> 
> 时间：2012-07-17T19:33:43.100
> 
> 标签：android, android-edittext

我想做一个笔记编辑器。它将有一条`EditText`带线。这是我的代码：

```
LinedEditText.java

public class LinedEditText extends EditText {

    private Rect mRect;
    private Paint mPaint;

    public LinedEditText(Context context) {
        super(context);
        // TODO Auto-generated constructor stub
        mRect = new Rect();
        mPaint = new Paint();
        mPaint.setStyle(Paint.Style.FILL_AND_STROKE);
        mPaint.setColor(Color.BLUE); //SET YOUR OWN COLOR HERE

    }
    @Override
    protected void onDraw(Canvas canvas) {
        //int count = getLineCount();

        int height = getHeight();
        int line_height = getLineHeight();

        int count = height / line_height;

        if (getLineCount() > count)
            count = getLineCount();

        Rect r = mRect;
        Paint paint = mPaint;

        int baseline = getLineBounds(0, r);//first line
        for (int i = 0; i < count; i++) {

            canvas.drawLine(r.left, baseline + 1, r.right, baseline + 1, paint);
            baseline += getLineHeight();//next line
        }

        super.onDraw(canvas);
    } 
```

* * *

```
TextEditorActivity.java

    public class TextEditorActivity extends Activity {

    private LinedEditText text;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        this.text=new LinedEditText(getApplicationContext());
        this.setContentView(text);
    }

} 
```

结果：

[结果 http://bekirmavus.com/k-resimler/image/android/device-2012-07-17-222950.png](http://bekirmavus.com/k-resimler/image/android/device-2012-07-17-222950.png)

我犯了什么错误？

谢谢...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T20:02:23.470

这条线是从光标位置向下绘制的。只需使用 Gravity 将光标的默认位置从垂直居中移动到左上角：

```
text.setGravity(Gravity.NO_GRAVITY); 
```

或者默认为所有 LinedEditTexts 设置它：

```
public LinedEditTexts(Context context) {
    super(context);
    setGravity(Gravity.NO_GRAVITY); // or Gravity.TOP | Gravity.LEFT
    ...
} 
```

# php - 查找在其类名 HTML DOM 中有空格的 Div

> ID：11529598
> 
> 赞同：0
> 
> 时间：2012-07-17T19:33:43.820
> 
> 标签：php, class, html, simple-html-dom

如何使用在其类名中有空格的 HTML DOM 在 PHP 中找到一个 div。片段

```
<div class="f14 rel">
<input type="checkbox" class="p0m0 mr_5" name="propid[]" id="X6849129" value="X6849129"/>
      <div id="imgChkBoxX6849129">  
          <a id="desc_X6849129" class="f14 uline" target="_blank" href="some link"/>
      </div> 
```

我试过`$html->find('div."f14 rel"')`了。但它不起作用。也没有`$html->find('div.f14 rel')`

# android - 库项目重编译和依赖项目重编译

> ID：11529599
> 
> 赞同：0
> 
> 时间：2012-07-17T19:33:48.813
> 
> 标签：android, dependencies, android-library, library-project

如果我们将项目 A 构建为库项目，将项目 B 构建为包含库项目 A 的标准项目，那么当我更改库项目 A 中的代码（即项目 A 被重新编译）时会发生什么？

下次我重新编译项目 B 时，它会自动将新代码包含在项目 A 中吗？它是查看项目 A 中 Manifest 中的版本以了解库项目是否已更改，还是仅查看项目 A 的 jar 文件的时间戳以查看自上次包含在项目 B 以来是否已重新编译?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:47:38.577

我认为 Eclipse 会自动编译项目 A 的 .class 文件，并且 B 可以识别此更改，但是当您要分发应用程序时，您需要清理工作区并再次构建它，以便在项目 B 中查看项目 A 的新更改。这是eclipse编译类的原因，后来转换为dalvik类文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:43:10.647

AFAIK有两种依赖关系。

1) 在“项目属性”/“Java 构建路径”下设置。您让一个 Eclipse 项目依赖于另一个项目，因此更改为项目 A 将重建项目 B。

2) 在“项目属性”/“Android”下设置。您告诉 android 工具项目 B 在运行时依赖于一个 android 库（项目 A）。如果仅使用此依赖方法，如果项目 A 发生更改，我认为不会重建项目 B。

# android - 我的应用对 Play 商店中的某些 LG 设备不可见

> ID：11529602
> 
> 赞同：0
> 
> 时间：2012-07-17T19:34:03.797
> 
> 标签：android

嗨，我开发了一个应用程序，如果设备是 LG Optimus 2x，我无法在 Play 商店中显示它。如果我在网上搜索它，它会说不兼容。有任何想法吗？

该设备运行 4.0.4 自定义 ROM，市场型号名称显示：“Yoigo LGE LG-P990”

这是我的清单：

```
<?xml version="1.0" encoding="utf-8"?><manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="-"
android:versionCode="-"
android:versionName="-" >

<!-- Sdk min-max -->
<uses-sdk android:minSdkVersion="8" android:targetSdkVersion="15" />

<!-- Multi-screen support -->
<supports-screens 
    android:smallScreens="true" 
    android:normalScreens="true" 
    android:largeScreens="true" 
    android:xlargeScreens="true"
    android:resizeable="true" 
    android:anyDensity="true"/>

<!-- Google tv -->
<uses-feature android:name="com.google.android.tv" android:required="false"/>
<uses-feature android:name="android.hardware.touchscreen" android:required="false"/>

<!-- Permissions -->
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.VIBRATE"/>

<!-- Permission configuration required by Scoreloop -->
<uses-permission android:name="android.permission.READ_PHONE_STATE" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:name="AppApplication" >
    .....

</application> 
```

还有我的 project.properties：

```
target=android-15
android.library.reference.1=../PATH/TOLIB 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T09:57:58.337

问题是 build.prop 上修改后的密度 LCD。

# javascript - 获取动态宽度元素的编号

> ID：11529609
> 
> 赞同：0
> 
> 时间：2012-07-17T19:34:26.050
> 
> 标签：javascript, dom

我想要动态宽度元素（宽度：auto）的数字宽度（不带 Px），我用 clientWidth、parseInt、offsetWidth 尝试了它，但它总是以“0”或 NaN 返回。

我怎么能有这些数字？

非常感谢提前。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:36:32.087

在jQuery中

```
 alert($("#mydiv").innerWidth().replace("px","")); 
```

在javascript中

```
alert (document.getElementById('mydiv').style.width.replace("px","")); 
```

# c# - URL 重写的字符串正则表达式

> ID：11529611
> 
> 赞同：-1
> 
> 时间：2012-07-17T19:34:28.690
> 
> 标签：c#, asp.net, regex, url-rewriting

**规则 ：**

```
<rule name="rule1">
<match url="^variation1 or variation2/([^_]+)" ignoreCase="true"/>
<action type="Rewrite" url="strings.aspx?x1={R:1}&amp;x2={R:2}"/>
</rule> 
```

我想将变体 1 或变体 2 匹配此规则。

**示例网址：**

*   .http://localhost/variation1/3242ddfw
*   .http://localhost/variation2/3242ddfw

注意：不是两个规则使用。只有一条规则

谢谢你帮助我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:43:42.370

我找到了解决方案:)

```
<rule name="rule1">
    <match url="^(variation1|variation2)/([^_]+)" ignoreCase="true"/>
    <action type="Rewrite" url="strings.aspx?x1={R:2}&amp;x2={R:3}"/>
</rule> 
```

注意：参数计数增加。R:1 -> R:2, R:2 -> R:3

# android - 摩托罗拉设备上的自定义权限失败

> ID：11529613
> 
> 赞同：1
> 
> 时间：2012-07-17T19:34:32.483
> 
> 标签：android, broadcastreceiver, user-permissions

我为我的小部件编写了一个接收广播的自定义权限，我得到了摩托罗拉设备的权限拒绝。

> 创建权限

```
<permission
    android:name="com.sample.app.WIDGET_PERMISSION"
    android:description="@string/widgetDesc"
    android:label="@string/widgetLabel"
    android:protectionLevel="signature" >
</permission> 
```

> 向清单文件添加权限

```
 <uses-permission android:name="com.sample.app.WIDGET_PERMISSION" /> 
```

> 添加接收器

```
 <receiver android:name=".MyWidget" android:label="MyApp"
                android:icon="@drawable/image" 
                android:permission="com.sample.app.WIDGET_PERMISSION">
                <intent-filter>
                    <action android:name="android.appwidget.action.APPWIDGET_UPDATE" />
                     <category android:name="com.sample.app" />
                </intent-filter>
</receiver> 
```

> 我只收到摩托罗拉设备的许可拒绝消息，

```
07-17 11:48:18.781: W/ActivityManager(479): Permission Denial: broadcasting Intent { act=android.appwidget.action.APPWIDGET_ENABLED cmp=com.sample.app/.MyWidget} from android (pid=3116, uid=10006) requires com.sample.app.WIDGET_PERMISSION due to receiver com.sample.app/com.sample.app.MyWidget

07-17 11:48:18.781: W/ActivityManager(479): Permission Denial: broadcasting Intent { act=android.appwidget.action.APPWIDGET_UPDATE cmp=com.sample.app/.MyWidget(has extras) } from android (pid=3116, uid=10006) requires com.sample.app.WIDGET_PERMISSION due to receiver com.sample.app/com.sample.app.MyWidget

07-17 11:48:18.828: W/ActivityManager(479): Permission Denial: broadcasting Intent { act=com.motorola.blur.home.ACTION_SET_WIDGET_SIZE cmp=com.sample.app/.MyWidget(has extras) } from com.motorola.blur.home (pid=3116, uid=10006) requires com.sample.app.WIDGET_PERMISSION due to receiver com.sample.app/com.sample.app.MyWidget 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T21:44:56.850

尝试`android:permission="com.sample.app.WIDGET_PERMISSION"`从您的接收者标签中删除，并且只包含`<uses-permission android:name="com.sample.app.WIDGET_PERMISSION" />`在您的清单标签下，在任何应用程序和活动之外。

**编辑：**问题是广播者应该将许可与广播一起发送，以便它通过您的广播接收器。当您使用命令行对其进行测试时，不知何故，没有发送权限。

我认为您在接收器内部声明权限的做法是正确的，但问题在于您的权限保护级别是签名。这个级别在 Android 开发者页面中是这样描述的：

> 仅当请求应用程序使用与声明权限的应用程序相同的证书签名时，系统才会授予该权限。如果证书匹配，系统会自动授予权限，无需通知用户或请求用户明确批准。

这使我认为，在摩托罗拉设备中，这并不满足。尝试改变

```
android:protectionLevel="signature" 
```

到

```
android:protectionLevel="normal". 
```

如果它仍然不起作用，我会说摩托罗拉配置存在错误。

# android - 屏幕旋转与方向变化相结合

> ID：11529618
> 
> 赞同：1
> 
> 时间：2012-07-17T19:34:54.970
> 
> 标签：android, orientation, screen-orientation, android-sensors, tilt-sensor

我想建造什么；

应用程序始终处于横向模式（手机顶部左侧！）。

当用户翻转手机（在 Y 轴上，因此用户正在看手机的背面，屏幕在坐在桌子另一端的人面前）时，方向应该变为 Reversed Landscape。在这种情况下，正在显示的 TextView 将是正对着看屏幕的人。

然后，当用户翻转手机时，方向应该变回横向。

但是......（这里有一个问题......）当用户将手机转过 X 轴时（所以看着屏幕，顺时针转动它（couter），什么都不会发生。（在游戏中，这将是作弊)

我尝试使用 onSensorChanged，但它的行为不像我描述的那样。有什么想法吗？谢谢

```
public void onSensorChanged(SensorEvent event) {  

                TextView tv = (TextView) findViewById(R.id.TextView01);
                tv.setText("0 : " + event.values[0] + "1 : " + event.values[1] + " -- 2 : " + event.values[2]);

                if (event.values[1] < -6 || event.values[1] > 6) {
                    playfair();
                    return;
                } else {if (event.values[1] > -6 || event.values[1] < 6){cheat = false;}}
                if (event.values[0] < -8.5) {
                    if (state == PRE_ROUND)
                    startround();                                               
                } else {
                    if (state == SHOWING_OBJECT){
                        flipper.setInAnimation(inFromBottomAnimation(1));
                        flipper.setOutAnimation(outToTopAnimation(1));
                        flipper.setDisplayedChild(1);

                        state = PRE_ROUND;  
                    }

                }                   
            } 
```

# c# - 图像顶部的 Winform 文本框未打印

> ID：11529621
> 
> 赞同：0
> 
> 时间：2012-07-17T19:35:00.553
> 
> 标签：c#, winforms

我有一个创建标志的 Winform 应用程序。一切正常，看起来很好，除非我打印。我有一张图片，上面有文本框。它们在我的计算机上可见，但在我打印时不可见。我假设当我打印图像时以某种方式“被带到前面”。

下面是我的打印功能：

```
private void btnPrint_Click(object sender, EventArgs e)
    {
        PrintDocument pd = new PrintDocument();
        pd.PrintPage += new PrintPageEventHandler(PrintImage);
        pd.Print();      
    }

    void PrintImage(object o, PrintPageEventArgs e)
    {
        int x = SystemInformation.WorkingArea.X;
        int y = SystemInformation.WorkingArea.Y;
        int width = this.Width;
        int height = this.Height; 

        Rectangle bounds = new Rectangle(x, y, width, height); 

        Bitmap img = new Bitmap(width, height); 

        this.DrawToBitmap(img, bounds);
        Point p = new Point(100, 100);
        e.Graphics.DrawImage(img, p);    
    } 
```

我不确定打印功能中的任何东西都是原因，但我想不出其他任何东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T20:08:49.650

我不知道为什么没有呈现 TextBox 内容的问题的答案，但我可以告诉你你做错了。

您应该做的是在您的绘图处理程序中呈现文本并使用单个“就地”文本框来允许用户在表单上的某个位置编辑文本，该位置已移动到位并即时可见用于编辑。

它要求您的“文档”由您可以呈现的对象列表（如“文本块”）组成，并且您可以在用户尝试操作它们时检测到它们的边界。这与“绘画”程序的工作方式非常相似。

这将与你现在所做的完全不同。“正确”地做事总是需要更多的工作。我不想告诉你重做你的申请。如果这是一种学习体验而不是商业产品，那么可以使用您熟悉的东西来破解它。但也许下次你可能会尝试另一种方法。

# netty - Netty 基准和其他促销信息

> ID：11529624
> 
> 赞同：2
> 
> 时间：2012-07-17T19:35:19.637
> 
> 标签：netty

我正在寻找 Netty 基准和其他促销信息，以便让团队相信 Netty 是正确的选择。我不需要任何说服自己:)

旧网站曾经有更多关于这类事情的信息，但旧网站似乎已经消失了。

谁能给我发链接或更多信息？网站可以更新吗？

感谢 Nicholas 提供了一些基准。也很高兴看到哪些开源项目和商业组织正在使用 Netty。我认为这些信息曾经可用，但我现在无法在网上找到它。

对于我们这些必须说服持怀疑态度的团队成员以及对这是一个多么棒的项目知之甚少的新手来说，这很重要。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T21:11:12.533

带着几个附带条件、警告和免责声明，我从[vert.x中提出了这些](http://vertx.io/)[激烈竞争的基准](http://vertxproject.wordpress.com/2012/05/09/vert-x-vs-node-js-simple-http-benchmarks/)，它在幕后使用了 Netty。不完全是您要查找的内容，但基准测试和相关的测试工具可能对比较有用。

我一定会关注这个问题，看看还有什么。

# javascript - 适用于所有浏览器的 Chrome JS/Dom？

> ID：11529631
> 
> 赞同：1
> 
> 时间：2012-07-17T19:35:45.963
> 
> 标签：javascript, dom, cross-browser

我已经完成了“Javascript 权威指南”的一半，现在意识到像 jquery 这样的东西的主要原因是因为不同浏览器上的 Javascript/DOM 界面存在极大的不一致。几乎每个页面都提到了一些文档属性，但条件是（例如）它可以在除 IE 8 之前的所有浏览器（或 Firefox 或其他任何浏览器）上运行。

那么，是否有一个 JS 库可以完全按照它在 Chrome 中的功能实现 Javascript DOM，但它可以用于所有浏览器。如果没有，那么学习 DOM 似乎毫无意义——看起来还不如坚持使用 Jquery。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T21:10:10.947

不存在这样的库，它只会让所有 DOM 行为相同。部分原因是 DOM 不容易以不会与其他库可能正在做的事情发生冲突的可靠方式修补。而且，部分原因是某些东西可以以其原始形式进行修改。例如，如果可以直接访问（无需函数调用）的对象属性有时在某些浏览器中具有错误的值，则没有简单的方法可以修补它来修复它。而且，部分原因是许多项目都有来自许多来源的代码块，其中一些直接使用 DOM，而另一些则使用库。如果库改变了 DOM 行为，那么直接使用 DOM 并期望它像在本机浏览器中那样工作的代码可能会中断。

您可以争辩说所有代码都应该按照 DOM 应该工作的方式进行编码，并使用这个修复 DOM 的神奇 shim 层，但这是一个您无法取胜的实际论点。有太多的代码期望 IE6 DOM 能够像在 IE6 中那样以破碎的方式工作。例如，jQuery 本身期望 IE6 DOM 被破坏。如果你想使用这个神奇的 DOM fixer shim，那么它将与任何 jQuery 代码完全不兼容。

因此，图书馆发现使用并行访问事物的方式来隐藏 DOM 会更好、更容易，并且补丁和浏览器修复程序都在这个并行层中。然后，任何期望 DOM 以浏览器使其工作的方式工作的现有代码都不会受到影响，但是为使用该库而编写的任何代码都会按照该库的期望工作。两个目标都可以满足。是的，它是一个“新”的学习 API，但实际上并没有什么不同。如果您了解 DOM API，那么 jQuery 的大部分内容都是直接并行的，只是以常见的 jQuery 形式表示。

例如，在 jQuery 中，您可以使用DOM 属性名称来访问 DOM 对象`.attr("propName")`上的任何属性。`propName`如果您已经了解了 DOM 属性名称，那么您现在就知道如何在 jQuery 中访问它们。同样，您可以使用 选择页面中的任何一组对象`jQuery(CSS3selector)`。因此，如果您了解 CSS3 选择器，那么您现在就知道如何在 jQuery 中选择任何一组对象。是的，jQuery 中有许多增强的功能添加了 DOM 中不存在的新功能，但您可以根据需要单独学习这些功能。无论如何，它们不在常规 DOM 中。

最后，有一些`shim`库会添加缺失的功能。例如，有 shim 库可以将 ES5 方法添加到标准 javascript 对象，例如`Array.indexOf()`. 这些 shim 库确实按照您所说的方式部分工作。如果该方法不存在，他们会添加它，以便它像标准实现一样工作。他们不会尝试修复损坏的实现，但会添加缺少的东西，因为它是旧的浏览器版本，这样开发人员就可以只编写 ES5 代码，而不必担心浏览器的兼容性。与在所有浏览器中修复整个 DOM 相比，这是一个更有限的目标，并且通常是成功的。

# ruby-on-rails - Rails 3 和 HTML 从助手内部逃逸

> ID：11529638
> 
> 赞同：0
> 
> 时间：2012-07-17T19:36:00.597
> 
> 标签：ruby-on-rails

从 ERB 的角度来看，我有这个助手调用：

```
<p><%=progress @object.progress %></p> 
```

这是辅助方法（我已经简化了）：

```
def progress(value)
    s = content_tag(:span, "pre:")
    s += " <strong>#{value} %</strong>"
    return s.html_safe
end 
```

似乎如果您合并这两种类型的 HTML 字符串，最新的部分将无法正确呈现。你会看到这个：

```
pre: <strong>40 %</strong> 
```

* * *

如果你像这样组合字符串：

```
def progress(value)
    s = content_tag(:span, "pre:")
    s += content_tag(:strong, " #{value} %")
    return s.html_safe
end 
```

一切正常！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:59:26.757

`content_tag`我认为，它发生了，因为从标记为返回的字符串`html_safe`。因此，如果您尝试向此字符串添加内容，它会自动转义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T19:10:53.157

从返回的字符串`content_tag`被标记为`html_safe`，当您添加其他不安全的字符串时，它在 concat 之前被转义。

这是关于 SafeBuffers（执行 html_safe 魔法的类）如何工作的一个很好的解释：http: [//yehudakatz.com/2010/02/01/safebuffers-and-rails-3-0/](http://yehudakatz.com/2010/02/01/safebuffers-and-rails-3-0/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T19:00:19.150

如果您使用的是第一个示例，则添加**to_s**进行类型转换。

# multithreading - Delphi XE2中的异步ReadFile

> ID：11529639
> 
> 赞同：2
> 
> 时间：2012-07-17T19:36:07.683
> 
> 标签：multithreading, delphi, asynchronous, readfile

我正在编写一个小型 PE 文件分析器，我必须读取 PE 文件的内容。我是通过`ReadFile`函数来​​做的，如下图：

```
function TMainForm.GetPEData(var filename: string) : boolean;
var
  hFile:   DWORD;
  IDH:     TImageDosHeader;
  INH:     TImageNtHeaders;
  ISH:     TImageSectionHeader;
  dwRead: DWORD;
  szBuff: array[0..7] of Char;
  i:      WORD;
  PE: TPEFile;
begin
  Result := False;
  PE := TPeFile.Create;
  if PE.LoadFromFile (filename) then  
    Form2.edEntryPoint.Text := IntToHex(PE.RvaToFileOffset(PE.AddressOfEntryPoint), 8);
  SplashScreen.sLabel1.Caption := 'PE File Loaded';
  hFile := CreateFile(PChar(filename), GENERIC_READ, 
                      FILE_SHARE_WRITE, nil, 
                      OPEN_EXISTING, 0, 0);
  if hFile <> INVALID_HANDLE_VALUE then
  begin
    SetFilePointer(hFile, 0, nil, FILE_BEGIN);
    SplashScreen.sLabel1.Caption := 'Reading DOS File Headers...';
    ReadFile(hFile, IDH, 64, dwRead, nil);
    if IDH.e_magic = IMAGE_DOS_SIGNATURE then
    begin
      SetFilePointer(hFile, IDH._lfanew, nil, FILE_BEGIN);
      SplashScreen.sLabel1.Caption := 'Reading NT File Headers...';
      //Here is where the UI freezes while the file is read...
      ReadFile(hFile, INH, 248, dwRead, nil);
      if INH.Signature = IMAGE_NT_SIGNATURE then
      begin
        Form2.edImageBase.Text := IntToHex(INH.OptionalHeader.ImageBase, 8);
        Form2.edSizeOfImage.Text := IntToHex(INH.OptionalHeader.SizeOfImage, 8);
        Form2.edLinkerVersion.Text := IntToStr(INH.OptionalHeader.MajorLinkerVersion) + '.' + 
              IntToStr(INH.OptionalHeader.MinorLinkerVersion);
        Form2.edFileAlignment.Text := IntToHex(INH.OptionalHeader.FileAlignment, 8);
        Form2.edSectionAlignment.Text := IntToHex(INH.OptionalHeader.SectionAlignment, 8);
        Form2.edSubSystem.Text := IntToHex(INH.OptionalHeader.Subsystem, 4);
        Form2.edEPFilestamp.Text := IntToStr(INH.FileHeader.TimeDateStamp);
        Form2.edFileType.Text := GetPEFileType(PE.ImageNtHeaders.Signature);

        for i := 0 to INH.FileHeader.NumberOfSections - 1 do
        begin
          SetFilePointer(hFile, IDH._lfanew + 248 + i * 40, nil, FILE_BEGIN);
          ReadFile(hFile, ISH, 40, dwRead, nil);
          CopyMemory(@szBuff[0], @ISH.Name[0], 8);

          with Form2.sListView1.Items.Add do
          begin
            Caption := ShortString(szBuff);
            SubItems.Add(IntToHex(ISH.VirtualAddress, 8));
            SubItems.Add(IntToHex(ISH.Misc.VirtualSize, 8));
            SubItems.Add(IntToHex(ISH.PointerToRawData, 8));
            SubItems.Add(IntToHex(ISH.SizeOfRawData, 8));
            SubItems.Add(IntToHex(ISH.Characteristics, 8));
          end;
        end;
      end;
    end;
    CloseHandle(hFile);
    Result := True;
  end;
end; 
```

不好的是，根据文件的大小，我注意到它`ReadFile`经常会滞后——而且它是同步发生的。与此同时，UI 冻结并且对用户来说看起来非常错误，他们会很想终止它。我考虑过线程，但我只是想看看是否有任何方法可以`ReadFile`在异步模式下使用。如果没有，我会跳到线程，即使我的代码有很多要修改的地方。

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:53:46.227

> ReadFile 函数从文件中读取数据，并从文件指针指示的位置开始。您可以将此函数用于同步和异步操作。

可以异步使用 ReadFile，但根据您的 UI，这可能不是最佳解决方案。您是否希望您的用户在等待 PE 文件加载时执行任何操作？

如果您希望您的用户等待但确信您的程序没有冻结，您可以添加进度条或仅更新您的 SplashScreen。

```
for i := 0 to INH.FileHeader.NumberOfSections - 1 do
begin
   SplashScreen.sLabel1.Caption := 'Reading section ' + IntToStr(i) + ' of ' + IntToStr(INH.FileHeader.NumberOfSections);
   SplashScreen.sLabel1.Update; // see Ken Whites comment
   // Application.ProcessMessages;
   ...
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T12:03:11.603

在这种情况下，我总是将整个文件读取到内存中，并且我使用 TFileStream 类来简化操作。

将整个文件放在内存中更简单，PE 文件通常很小。

```
 type
    TSections = array [0..0] of TImageSectionHeader;
    PSections = ^TSections;

var
  Form1: TForm1;

implementation

{$R *.dfm}

procedure TForm1.Button1Click(Sender: TObject);
var
  FS : TFileStream;
  fisier : PImageDosHeader;
  INH : PImageNtHeaders;
  ISH : PSections;
  i   : Word;
begin
  FS := TFileStream.Create('fisierul_tau.exe',fmOpenRead);
  GetMem(fisier,FS.size); //Aloci memorie pentru fisier
  FS.Read(fisier^,FS.Size); // Il citesti;
  FS.Free;
  INH := PImageNtHeaders(DWORD(fisier) + DWORD(fisier^._lfanew));
  ISH := PSections(DWORD(INH) + SizeOf(TImageNtHeaders));
  for i := 0 to INH^.FileHeader.NumberOfSections - 1 do
  begin
      ShowMessage(PAnsiChar(@ISH[i].Name[0]));
  end;
end; 
```

# javascript - oauth 1.0 - Google 的无效签名 GetRequestToken

> ID：11529641
> 
> 赞同：0
> 
> 时间：2012-07-17T19:36:17.890
> 
> 标签：javascript, oauth

我找不到 Google 对 Oauth 1.0 的任何有效支持，因为它已被弃用。但由于我想访问 Gmail 数据，我必须使用 Oauth 1.0

因此，我从 2 天以来一直在尝试为我的 Google 应用程序获取 RequestToken，但我收到了无效签名错误。我的基本字符串与谷歌返回的调试字符串匹配。

我试过同时使用 HMAC-SHA1 和 RSA-SHA1 并且我的密钥是正确的。（我什至尝试过将令牌和秘密都用作匿名，谷歌建议非注册应用程序使用。）这可能是由于错误的随机数或某些百分比编码问题造成的。同样的方法也适用于 Twitter。

我也在下面粘贴我的代码，如果有人可以帮助或将我指向正确的论坛，我会很高兴。

```
 $('#GMAIL_BUTTON').click(function () {
    //oauth1 approach similar to twitter
    var requestUrl = "https://www.google.com/accounts/OAuthGetRequestToken";
    var scope = "https://mail.google.com/";
    var clientID = "anonymous";
    var clientSecret = "anonymous";
    var rsakey = "MIICblahblahblah";
    var timestamp = Math.round(new Date().getTime() / 1000.0);
    var nonce = Math.random();        
    var sigBaseStringParams = "oauth_consumer_key=" + clientID;
    sigBaseStringParams += "&" + "oauth_nonce=" + nonce;
    sigBaseStringParams += "&" + "oauth_signature_method=HMAC-SHA1";
    sigBaseStringParams += "&" + "oauth_timestamp=" + timestamp;
    sigBaseStringParams += "&" + "scope=" + encodeURIComponent(scope);
    var sigBaseString = "GET&";
    sigBaseString += encodeURIComponent(requestUrl) + "&" +        encodeURIComponent(sigBaseStringParams) + "\n" + "\n";
    requestUrl += "?scope=https://mail.google.com/";
    var keyText = encodeURIComponent(clientSecret) + "&";
    //var keyText = rsakey;
    var keyMaterial =     Windows.Security.Cryptography.CryptographicBuffer.convertStringToBinary(keyText, Windows.Security.Cryptography.BinaryStringEncoding.Utf8);
    var macAlgorithmProvider = Windows.Security.Cryptography.Core.MacAlgorithmProvider.openAlgorithm("HMAC_SHA1");
    var key = macAlgorithmProvider.createKey(keyMaterial);
    //var keyMaterial = Windows.Security.Cryptography.CryptographicBuffer.decodeFromBase64String(rsakey);
    //var macAlgorithmProvider = Windows.Security.Cryptography.Core.AsymmetricKeyAlgorithmProvider.openAlgorithm("RSASIGN_PKCS1_SHA1");
    //var key = macAlgorithmProvider.importKeyPair(keyMaterial);
    var tbs = Windows.Security.Cryptography.CryptographicBuffer.convertStringToBinary(sigBaseString, Windows.Security.Cryptography.BinaryStringEncoding.Utf8);
    var signatureBuffer = Windows.Security.Cryptography.Core.CryptographicEngine.sign(key, tbs);
    var signature =    Windows.Security.Cryptography.CryptographicBuffer.encodeToBase64String(signatureBuffer);
    var dataToPost = "OAuth oauth_consumer_key=\"" + clientID + "\", oauth_nonce=\"" + nonce + "\", oauth_signature_method=\"HMAC-SHA1\", oauth_timestamp=\"" + timestamp + "\", oauth_signature=\"" + encodeURIComponent(signature) + "\", oauth_version=\"1.0\"";
    var response = sendGetRequest(requestUrl, dataToPost, null);
}); 
```

SendGetRequest 方法是 -

```
 function sendGetRequest(url, authzheader, params) {
    try {
        var request = new XMLHttpRequest();
        request.open("GET", url, false);
        request.setRequestHeader("Authorization", authzheader);
        request.send(params);
        return request.responseText;
    } catch (err) {
        WinJS.log("Error sending request: " + err, "Web Authentication SDK Sample", "error");
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T09:56:51.267

我在您的代码中找不到任何明显的错误，但您可能会更轻松地在[https://developers.google.com/accounts/docs/OAuth2UserAgent](https://developers.google.com/accounts/docs/OAuth2UserAgent)使用 Google 的 OAuth 2 客户端应用程序库。此外，您可能想要使用 atom 提要范围 (https://mail.google.com/mail/feed/atom)——您可以在[https://code.google.com/尝试使用它和其他范围oauthplayground/](https://code.google.com/oauthplayground/) .

# jquery - jQueryMobile 和切换 DIV 可见性

> ID：11529645
> 
> 赞同：0
> 
> 时间：2012-07-17T19:36:27.983
> 
> 标签：jquery, jquery-mobile, jquery-events

我有奇怪的行为，我不知道如何解决它。

我有移动版本的网络服务，在每个页面上我都在`DIV`元素中放置搜索表单，整个容器应该用常见的 jQuery 的[.toggle()切换](http://api.jquery.com/toggle/)

代码是（脚本直接放在页面的代码中，就像在示例中一样）：

```
<div id="search-area" style="display: none">
    search form here...
</div>

<a href="#" id="search-area-switch" data-role="button">Search</a>

<script type="text/javascript">
    $('#search-area-switch').live('tap',function (event) {
        $('#search-area').toggle();
    });
</script> 
```

我的问题是`toggle()`仅在重新加载后的**第一**页上有效，并且在下一页更改后切换不再可能。（顺便说一句。页面加载了 AJAX 以保持转换等）

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:47:35.137

如果脚本位于页面头部，则在您更改页面时它不会运行，因为 Jquery Mobile 会忽略第一页之后的头部。

一般来说，拥有多个具有相同 id 的项目是不好的做法。最好让它们都属于同一个类，然后让您的选择器以这种方式找到项目。

# ios - Delphi ClientDataSets 可以在 iOS 应用程序中使用吗？

> ID：11529647
> 
> 赞同：0
> 
> 时间：2012-07-17T19:36:30.383
> 
> 标签：ios, delphi, tclientdataset, client-dataset

我在 Embarcadero DocWiki 中阅读了***[未在 iOS 应用程序中使用的组件](http://docwiki.embarcadero.com/RADStudio/en/Components_Not_Used_in_iOS_Apps)***，但无法判断 ClientDataSets 和 DataSources 是否可以在 iOS 应用程序中使用。任何人都可以确认或否认这些组件是否可以在 iOS 应用程序中工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T19:57:49.377

您引用的列表中的前两项是*Data.DB*和*Datasnap.DBClient*单元，表明 iOS 应用程序不支持它们。`TDataSource`来自前者，而`TClientDataSet`来自后者。

要自己确认，请尝试在 iOS 应用程序中使用它们并查看是否收到预期的编译器错误（“无法找到 Project1 使用的单元 %NameOfTheUnit%”）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-28T15:53:04.763

是的，ClientDataSet 和 DataSetProvider 都可以在 iOS 应用程序中使用。关于 Data 和 Datasnap 命名空间，上述答案是不正确的。这些单元是跨平台的。如果您将光标悬停在工具面板中的 ClientDataSet 或 DataSetProvider 上，您可以看到这一点。这样做会显示您正在暂停的组件支持的操作系统，并且这两个组件的显示都包括 iOS 和 Android。

# c++ - C++ 强制转换是如何实现的？

> ID：11529656
> 
> 赞同：16
> 
> 时间：2012-07-17T19:36:51.133
> 
> 标签：c++, casting

C++ casts `static_cast`, `const_cast`,`reinterpret_cast`具有类似模板的语法，例如

```
long foo = 3; 
int bar = static_cast<int>(foo); 
```

我查看了标准，它说强制转换是表达式，而不是我想的模板函数。

这让我想知道：在幕后，这些演员表只是具有特权状态的模板，还是它们恰好借用了模板语法的关键字？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-17T19:38:04.707

> 它们是恰好借用模板语法的关键字吗？

这。强制转换的实现取决于它们所使用的上下文——一般来说，它们**不能**作为函数来实现。例如，`static_cast`有时只是一个编译时操作，不会为它发出任何代码。但其他时候（特别是在调用构造函数、在类型层次结构中强制转换或在布局不兼容的原始类型之间转换时）它需要运行时操作。

也就是说，您可以实现自己的*类似于*标准强制转换语法的函数（`boost::lexical_cast`这样做）。

# c++ - C++ 内联汇编错误

> ID：11529659
> 
> 赞同：2
> 
> 时间：2012-07-17T19:36:56.173
> 
> 标签：c++, visual-c++, assembly, inline-assembly

我正在尝试使用内联汇编，但我收到错误..

这是代码的一部分：

```
char * buffer = new char[10];
__asm {
    mov ecx,&buffer
    mov edx,07
} 
```

以及错误；

> 错误 1 ​​错误 C2400：“第二个操作数”中的内联汇编器语法错误；找到“和”

我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T20:02:42.207

这完全取决于您要达到的目标。

*1.如果您尝试将分配的`char`数组的地址加载到`ecx`*

的值`buffer`已经是您需要的地址`ecx`。它类似于`0x004F5A42`（例如）它是`char`内存中数组的地址，因此没有理由`&`附加到`buffer`您的 asm 代码中。`&buffer`将是`buffer`指针本身的地址，它在内存中可能距`char`数组几兆字节。

*2.如果您尝试将地址加载`buffer`到`ecx`*

你应该试试这个：

```
char * buffer = new char[10];
char ** buffer_ptr = &buffer;
__asm {
    mov ecx,buffer_ptr
    mov edx,07
} 
```

这种变通方法的原因是，看起来，角色`&`仅保留给 AND 运算符。以下引用摘自[x86 汇编语言参考手册](http://docs.oracle.com/cd/E19253-01/817-5477/817-5477.pdf)

> **运营商**
> 
> 汇编器支持在表达式中使用以下运算符。
> 
> ...
> 
> & 按位逻辑与

此后`&`从未在手册中提及。

# vba - 共享驱动器的不同字母

> ID：11529660
> 
> 赞同：2
> 
> 时间：2012-07-17T19:36:59.013
> 
> 标签：vba, excel

**快速背景：**我为一家使用网络共享驱动器在员工之间共享信息的公司编写了 excel 宏

**问题：**不同的员工在不同的字母下列出了相同的共享驱动器。例如，Susie 将“Commissions Shared Drive”作为驱动器“Z”，但 Betty 将其作为驱动器“x”。

我将设计一个两个不同的人使用的宏，但由于它们有不同的驱动器号，宏会出错。**简而言之，由于驱动器号的不同，代码中写入的文件位置对于两个人来说都是不正确的。**

**当前解决方案：**我目前有一个完全相同的宏的副本，其中对文件位置进行了更改以解决驱动器号的差异。这很烦人，因为每当我对一个文件进行更改时，我都必须确保另一个文件完全相同。

**问题：**有没有一种方法可以在一个宏中说明不同的驱动器号，这样我就不必拥有具有不同地址的文件的副本？

提前致谢！

-麦克风

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T19:49:55.860

使用实际的网络路径。

例如，而不是像

```
Z:\filename 
```

采用

```
\\servername\foldername\filename 
```

只要用户有权访问该路径，无论驱动器映射如何，代码都会找到它。

编辑：您可以查看[此问题](https://superuser.com/questions/393397/why-is-it-bad-to-map-network-drives-in-windows)及其答案，原因是您不应在代码中使用映射的驱动器号。附带说明一下，如果您使用的是比 Excel 宏更不可更新的东西，那么最好不要将路径实际存储在代码中。相反，您将拥有一个文件，代码查看该文件以获取路径。因此，您编写的内容将工作更长时间，而无需重新编译或修改。但同样，由于您只是在执行 Excel 宏，我认为没有令人信服的理由不使用直接路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T12:37:11.167

@Daniel Cook 我还找到了另一条可用于引用共享驱动器的路径。

如果您右键单击共享驱动器并转到属性> DFS（DFS 是属性窗口中的一个选项卡），它们会在那里列出一个单独的有效路径。我创建了一个宏来测试两条路径并且都有效。

但是，我的一位同事说他使用 \servername\foldername\filename 的路径方法为另一名员工制作了一个宏，但由于某种原因它在她的计算机上不起作用，但是当他使用 DFS 选项卡中的其他路径时在共享驱动器的属性下，它对她有用。

任何想法为什么 \servername\foldername\filename 路径可能在一台计算机上而不是另一台计算机上工作？

# php - TCPDF 因连接重置错误而失败

> ID：11529661
> 
> 赞同：2
> 
> 时间：2012-07-17T19:37:01.557
> 
> 标签：php, apache, tcpdf

我`TCPDF`用来生成一个相当大的文档。该文档中可以嵌入超过 1000 张图像（每个图像在 20KB-50KB 之间）。

它工作得很好（如果有点慢）直到大约 800 个图像，浏览器返回 a`Connection Reset error`并停止加载。

我检查了所有常见的嫌疑人`PHP max execution time`，，，，，`memory limits`都`Apache execution time`无济于事。我在任何日志文件中都没有收到任何错误，以帮助我进一步诊断。

我错过了什么吗？以前有人见过这样的东西吗？

谢谢

# solr - Solr：将 useCompoundFile 设置为 true 对索引文件没有任何影响

> ID：11529667
> 
> 赞同：2
> 
> 时间：2012-07-17T19:37:22.863
> 
> 标签：solr

在 SolrConfig.xml 中，我设置如下：

```
<useCompoundFile>true</useCompoundFile> 
```

但是，一旦我重新索引我的东西，我仍然会看到一堆从 _0* 到 _9* 的索引文件，而不是看到单个索引文件。

问题：

```
1\. how to fix this?
2\. if i update index at the run time, is it ok to use compound index then? 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T20:01:36.137

这些是段文件，请参见[此处](http://lucene.apache.org/core/old_versioned_docs/versions/3_5_0/fileformats.html#File%20Naming)。这些并不意味着没有使用复合文件，请查看[此文档](http://lucene.apache.org/core/old_versioned_docs/versions/3_5_0/fileformats.html#Compound%20Files)以确保。基本上在索引目录中查找 .cfx 文件。

# php - 初始化对象数组

> ID：11529673
> 
> 赞同：1
> 
> 时间：2012-07-17T19:37:38.700
> 
> 标签：php, arrays, wamp

测试 rand 函数的程序就是一个例子：

```
<?php 
        class number {
           function number() {
               $occurences=0;
           }
           public $occurences;
           public $value;
        }
        $draws = 5000;
        $numOfInts = 10;
        //$integers = array();
        $integers [] = new number(); 
        //initialising loop
        for($i=0;$i<=$numOfInts;$i++)
            $integers[$i]->$value = $i;  //debugger points here

        for($i=0;$i<$draws;$i++) {
            $integers[rand(0,numOfInts)]->$occurences++;               
        }
        foreach($integers as $int)
            printf("%5d %5d  <br/>",$int->$value,$int->$occurences);       
 ?> 
```

WAMP 服务器上的错误：

> 未定义变量：第 31 行 C:\path\index.php 中的值
> 
> 致命错误：无法访问第 31 行 C:\path\index.php 中的空属性

是什么导致了它们以及如何解决？我想 $integers 声明不正确。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T19:39:22.807

为什么？

```
//$integers = array();
$integers [] = new number(); 
```

应该只是

```
$integers = array();
for($i=0;$i<=$numOfInts;$i++) {
    $integers[$i] = new number();
} 
```

PHP 中没有类型化数组

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-17T19:41:44.047

您应该使用以下语法访问对象的成员：

```
$integers[$i]->value
$integers[$i]->occurences; 
```

但是，您还必须先初始化数组，这意味着取消注释初始行

```
$integers = array(); 
```

事实上，你并没有使用更好的[OOP](http://php.net/oop)风格，它会像这样改变你的数据结构：

```
class Number {
    private $value;
    private $occurences = 0;
    public function __construct($value = 0) {
        $this->value = $value;
    }
    public function getValue() {
        return $this->number;
    }
    public function addOccurence() {
        $this->occurences++;
    }
    public function getOccurences() {
        return $this->occurences;
    }
} 
```

然后，您将像这样访问成员：

```
// init part
$integers = array();
for($i = 0; $i < $numOfInts; $i++) {
    $integers[] = new Number($i);
}

// draws part
for($i=0; $i < $draws; $i++) {
    $integers[rand(0,$numOfInts-1)]->addOccurence();               
}

// print part
foreach($integers as $number) {
    printf("%5d %5d<br />", $number->getValue(), $number->getOccurences());
} 
```

# java - 如何通过指定命令行参数将字符串读入 Strings[] args？

> ID：11529678
> 
> 赞同：1
> 
> 时间：2012-07-17T19:37:54.347
> 
> 标签：java, command-line, io, arguments

我想通过命令行参数在 main() 函数中填充 String[] 数组。所有字符串都已写入一个文本文件，我在运行时使用“<”运算符将其传递给它，例如-->
java Sort < input.txt

所有字符串都包含在文件 input.txt 中（需要排序）---> zzz bbb ggg aaa fff kkk lll

但这并没有发生。我知道使用 java.io 可以轻松完成，但我需要这种更简单的方法..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T19:40:44.987

好吧，您不能，`<`运算符用于重定向输入，而不是将文件的内容作为命令行参数传递。

在这种情况下，标准 IO 是实现这一目标的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-17T19:46:51.797

所以更一般地说，您想将文件的内容转换为程序的参数吗？

`cat input.txt | xargs java Sort`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T21:43:25.910

这可以通过编写脚本来实现，该脚本将从文件中输入字符串，然后使用这些输入执行 java 命令。

像这样的东西可以从 Windows 批处理文件中工作

```
SetLocal EnableDelayedExpansion
设置“str=”

for /F "delims=;" %%I in (sample.txt) do set str=!str!!%%I%

java测试%str%

```

# javascript - 停止无限重定向

> ID：11529679
> 
> 赞同：0
> 
> 时间：2012-07-17T19:37:58.963
> 
> 标签：javascript, jquery, html

以下是我网站的 .js 文件的功能，该文件包含在网页的 head 部分中，test.html

```
function test_redirect() {
    var urlCurrent = document.URL;
    window.location = "http://webanywhere.cs.washington.edu/beta/?starting_url=" + urlCurrent;
}
$.test_redirect(); 
```

从 javascript 代码中可以清楚地看到，我试图将打开页面**test.html**的用户重定向到另一个页面，该页面接受我所在的正确页面的 URL 作为查询字符串中的参数并执行一些操作它。

当重定向的网页加载多次时会出现问题。重定向页面实际上打开了带有注入脚本页面的相同 test.html，但重定向再次开始。

有人可以帮我找出问题所在吗？.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T20:24:37.023

有多种方法可以决定不对来自第三方的后续页面加载进行重定向：

1.  在您重定向之前，设置一个具有相当短的过期时间（例如 1-2 分钟）的 cookie。如果 cookie 在加载时存在，请不要重定向，因为您不久前刚刚完成了重定向，因此此页面加载必须来自第三方。如果 cookie 不存在，则进行重定向。

2.  让第三方网站使用某种查询参数第二次加载您的页面，您可以将其识别为第三方网站放置在那里，这样您就知道不要重定向。例如，如果您将“?noredirect=true”（正确编码）添加到您重定向到的 URL 的末尾，会发生什么情况。第三方网站会在您的 URL 上留下“？noredirect=true”，当它返回给您时，您可以检测到并避免重定向吗？

3.  查看document.referrer，看看它是否是第三方页面。一些用户可能会将他们的浏览器配置为阻止推荐人，因此这不是 100% 可靠的。

4.  让您的页面第一次打开（从它来自的任何链接）指定一个查询参数，该参数指定应允许重定向。这仅在您的页面仅链接到您控制的位置且不太可能被添加书签的情况下才可行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T20:28:51.823

检查推荐人：

```
function test_redirect() {
    if( document.referrer.indexOf('http://webanywhere.cs.washington.edu') < 0 ){
      var urlCurrent = window.location.url;
      window.location = "http://webanywhere.cs.washington.edu/beta/?starting_url=" + urlCurrent;
    }
}
$.test_redirect(); 
```

# php - 访问令牌过期后被动获取新的访问令牌

> ID：11529692
> 
> 赞同：1
> 
> 时间：2012-07-17T19:39:21.417
> 
> 标签：php, facebook-php-sdk, facebook-apps, facebook-access-token

我正在开发一个简单的 Facebook 应用程序，它允许我从客户的网站发布到客户的 Facebook 粉丝页面。

现在，我在使用`$facebook->setAccessToken( EXTENDED_ACCESS_TOKEN_IN_DB );`PHP SDK 创建我的应用程序实例后设置了访问令牌。我正在使用 60 天长寿命的扩展访问令牌，因此客户每次想要发布到粉丝页面时都不必登录 Facebook **。**

在某些时候，访问令牌将由于多种原因而变得无效。

在理想情况下，这将是每 60 天一次。同时，如果我们可以继续通过应用程序从网站发布到粉丝页面，直到用户取消对应用程序的授权的那一天到来，那将是很好的。

无论如何，一旦它过期而不要求用户登录Facebook，是否可以获得新的访问令牌？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T20:07:00.963

> 无论如何，一旦它过期而不要求用户登录Facebook，是否可以获得新的访问令牌？

不，这就是弃用offline_access 的全部意义——应用程序不能“永远”以用户的名义做事。

也许您想获取页面访问令牌而不是用户访问令牌？前者没有默认到期日期。

# nhibernate - nHibernate 一对多最佳实践持久性以避免 INSERT NULL

> ID：11529699
> 
> 赞同：2
> 
> 时间：2012-07-17T19:39:50.757
> 
> 标签：nhibernate, mapping, one-to-many, cascade

我有一个一对多的映射。具有集合的实体持久存在于两个表 1:N

这是类和映射：

```
public class Test
    {
        public virtual string Id { get; set; }
        public virtual string Description { get; set; }
        public virtual IList<TestItem> Items { get; set; }

        public Test()
        {
            Items = new List<TestItem>();
        }
    }

    public class TestItem
    {
        public virtual string Id { get; set; }
        public virtual Test Test { get; set; }
        public virtual string ItemCode { get; set; }
        public virtual string ItemData { get; set; }
    }

    public class TestMap : ClassMapping<Test>
    {
        public TestMap()
        {
            Id(x => x.Id, m => m.Column("IDTest"));

            Bag(x => x.Items, c =>
            {
                c.Key(k =>
                {
                    k.NotNullable(true);
                    k.Column("IDTest");
                });
                c.Cascade(Cascade.DeleteOrphans);
                c.Lazy(CollectionLazy.NoLazy);
                c.Inverse(true);
            }, r => r.OneToMany(m =>
            {
                m.NotFound(NotFoundMode.Exception);
                m.Class(typeof(TestItem));
            }));
        }
    }

    public class TestItemMap : ClassMapping<TestItem>
    {
        public TestItemMap()
        {
            Id(x => x.Id, m => m.Column("IDTestItem"));

            ManyToOne(x => x.Test, m =>
            {
                m.Column("IDTest");
                m.NotNullable(false);
                m.Lazy(LazyRelation.NoLazy);
            });

            Property(x => x.ItemCode);
            Property(x => x.ItemData);
        }
    } 
```

这就是代码。如果我删除标记的行，我会收到错误消息。

```
var session = SessionFactory.OpenSession();

            using (var tr = session.BeginTransaction())
            {
                var test = new Test();
                test.Id = "T01";
                test.Description = "Desc TEST 01";

                session.SaveOrUpdate(test); // If Removed Get INSERT ERROR on TestItem

                var item = new TestItem { Id = "NEW01", ItemCode = "A", Test = test, ItemData = "New T01A" };
                test.Items.Add(item);
                session.SaveOrUpdate(item);

                session.SaveOrUpdate(test);

                tr.Commit();
            } 
```

我的问题是：

这是保持“一对多”关系的最佳做法吗？

可以使用下面的代码并全部保存，只保存标题行（测试）并自动级联子表上的所有插入？

```
var session = SessionFactory.OpenSession();

            using (var tr = session.BeginTransaction())
            {
                var test = new Test();
                test.Id = "T01";
                test.Description = "Desc TEST 01";

                //session.SaveOrUpdate(test); // If Removed Get INSERT ERROR on TestItem

                var item = new TestItem { Id = "NEW01", ItemCode = "A", Test = test, ItemData = "New T01A" };
                test.Items.Add(item);
                //session.SaveOrUpdate(item);

                session.SaveOrUpdate(test);

                tr.Commit();
            } 
```

我想我需要在我的映射代码上进行一些更改，但我不明白是什么！！！

许多天的工作，谷歌搜索，stackoverflow，但没有任何改变结果。

谢谢！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T21:01:34.663

问：*这是保持“一对多”关系的最佳做法吗？*

答：如果您在谈论“[组合](http://en.wikipedia.org/wiki/Class_diagram#Composition)”关系，级联方法可能是一个不错的选择。

问：*可以使用下面的代码并全部保存，只保存标题行（测试）并自动级联子表上的所有插入？*

答：是的，这是可能的。但是您的代码应如下所示：

```
public class TestMap : ClassMapping<Test>
{
    public TestMap()
    {
        Id(x => x.Id, m => m.Column("IDTest"));

        Bag(x => x.Items, c =>
        {
            c.Key(k =>
            {
                k.NotNullable(true);
                k.Column("IDTest");
            });
            c.Cascade(Cascade.All | Cascade.DeleteOrphans); //<- My suggestion
            c.Lazy(CollectionLazy.NoLazy);
            c.Inverse(true);
        }, r => r.OneToMany(m =>
        {
            m.NotFound(NotFoundMode.Exception);
            m.Class(typeof(TestItem));
        }));
    }
} 
```

# c# - 关于 Simple.Data.Mocking xml 结构的文档？

> ID：11529701
> 
> 赞同：0
> 
> 时间：2012-07-17T19:39:59.493
> 
> 标签：c#, simple.data

任何人都有用于 Simple.Data.Mocking 的 xml 结构的链接？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T13:24:41.067

XmlMockAdapter 已弃用，因此除了项目的单元测试中的内容之外，不会出现任何文档。

正如你所说，你应该使用 InMemoryAdapter。:)

# playframework - 寻找一个网络框架

> ID：11529705
> 
> 赞同：3
> 
> 时间：2012-07-17T19:40:12.177
> 
> 标签：playframework, wicket, vaadin

我正在启动一个新项目，该项目涉及一个托管 Web 应用程序的网站，并且希望在决定选择哪个 Web 框架时获得一些帮助。由于我在过去几年中是一名 Eclipse 开发人员，因此我更愿意使用 Java Web 框架（我还发现 Java 更易于维护，更易于测试、调试和扩展，但这是另一个话题......）

我已经做了一些研究，框架的数量是惊人的，你不可能在合理的时间内完成所有这些，这就是为什么我要向这个美妙的社区发表演讲:-)
不管怎样，我已经研究过 GWT，Play !、Wicket、Vaadin 和其他几个。在他们每个人中，我都发现了一些问题。

例如，Vaadin 和 wicket 都有一个非常好的小部件集，并且非常易于使用。我认为用它编写 Web 应用程序比编写和调试 javascript 代码要容易得多。缺点是 - 所有逻辑都驻留在服务器上，我发现它损害了用户体验（我查看了一些使用 Vaadin 的网站，感觉就像我登录到远程计算机......其实离真相不远..)

Play 很棒，但它缺乏 GWT 和 Vaadin 的 GUI 编程能力，使用纯 jquery 构建复杂的 Web 应用程序可能很乏味，尤其是在涉及 AJAX 的情况下。

目前，我发现使用 GWT 插件是一个合理的解决方案。有谁熟悉更好的候选人吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T22:33:48.840

这类问题并不是 StackOverflow 真正的意思，所以请在得到满意的答案后删除。

也就是说，

如果您想最小化整体网络流量，或者更好地说，对您的应用程序生成的网络流量进行更好的控制（您基本上会有一个客户端应用程序在需要数据时与服务器通信），那么 GWT 是一个不错的解决方案。它有一些非常丰富的组件库，但是一旦你选择了一个，与其他人混合搭配并不是一件容易的事，所以你最终会受到限制。而且，用 Java 代码布置组件并不是那么有趣。

我对 Play! 了解不多，但它是一个基于动作的框架，所以即使它使做事变得非常简单，它所做的事情都是基本的事情，你根本无法抽象和模块化你的使用基于组件的框架编写代码。

像 Vaadin 和 Seam 这样的框架抽象太多，并且剥夺了您有时需要对网络流量和资源消耗（特别是 Seam）的控制。

Wicket 是围绕组件抽象构建的（这在构建复杂的应用程序时很有帮助），但不会对您隐藏太多，让您可以根据需要对其进行微调。缺点是，与您所说的相反，它没有非常丰富的组件库（尽管所有构建块都在那里，并且很容易集成 javascript 库以添加“丰富性”）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T22:23:58.590

我认为 play、vaadin 或 gwt 是不同的，这取决于您对项目的需求。

就我个人而言，我正在使用 Play，我对此非常满意。一旦习惯了它，您的工作效率就会大大提高。表演也很棒！
我不熟悉 Vaadin 或 GWT，但从我的角度来看，jQuery 并不难学习，而且使用 jQuery UI，您可以非常轻松地访问基本小部件。对我来说，如果你学习 play + jQuery，而不是 Vaadin 或 GWT，你将拥有更多有用的技能。

一般来说，我总是更喜欢选择最流行的框架或语言，因为你会得到社区的很多支持。

# java - Lotus Notes:通过代码读取复制历史

> ID：11529708
> 
> 赞同：0
> 
> 时间：2012-07-17T19:40:16.747
> 
> 标签：java, replication, lotus-notes, lotus-domino, lotusscript

是否有任何可能的方法来编写代码来读取 Lotus Notes 中任何数据库/应用程序的复制历史记录。

解决方案可以是任何语言，我只需要一点开始就可以找到它以及如何开始。

任何帮助都会很棒！

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:52:34.070

您可以通过 Notes C API 阅读它。我发现了一个帖子，其中包含一些可能有帮助的[示例代码。](http://www-10.lotus.com/ldd/nd85forum.nsf/DateAllFlatWeb/96e67b880e693734852577c500790efd?OpenDocument)

# objective-c - 从应用程序保存到联系人时出错

> ID：11529710
> 
> 赞同：0
> 
> 时间：2012-07-17T19:40:22.240
> 
> 标签：objective-c, ios, addressbook

使用以下内容将姓名地址等保存到联系人时出现错误

IBA动作：

```
ABUnknownPersonViewController *unknownPersonViewController = [[ABUnknownPersonViewController alloc] init];
unknownPersonViewController.displayedPerson = (ABRecordRef)[self buildContactDetails];
unknownPersonViewController.allowsAddingToAddressBook = YES;
[self.navigationController pushViewController:unknownPersonViewController animated:YES];

}
 - (ABRecordRef)buildContactDetails {
NSLog(@"building contact details");
ABRecordRef person = ABPersonCreate(); 
CFErrorRef  error = NULL;  

// firstname
ABRecordSetValue(person, kABPersonFirstNameProperty, @"Don Juan", NULL);

// email
ABMutableMultiValueRef email = ABMultiValueCreateMutable(kABMultiStringPropertyType);
ABMultiValueAddValueAndLabel(email, @"myemail.hotmail.com", CFSTR("email"), NULL);
ABRecordSetValue(person, kABPersonEmailProperty, email, &error);
CFRelease(email); 

// Start of Address
ABMutableMultiValueRef address =   ABMultiValueCreateMutable(kABMultiDictionaryPropertyType);  
NSMutableDictionary *addressDict = [[NSMutableDictionary alloc] init];
[addressDict setObject:@"Hig Street" forKey:(NSString *)kABPersonAddressStreetKey];   
[addressDict setObject:@"WR11" forKey:(NSString *)kABPersonAddressZIPKey];  
[addressDict setObject:@"Evesham" forKey:(NSString *)kABPersonAddressCityKey]; 
ABMultiValueAddValueAndLabel(address, addressDict, kABWorkLabel, NULL);
ABRecordSetValue(person, kABPersonAddressProperty, address, &error); 

// End of Address

if (error != NULL) 
    NSLog(@"Error: %@", error);

return person; 
```

我在以下行中收到错误：

```
ABMultiValueAddValueAndLabel(address, addressDict, kABWorkLabel, NULL); 
```

具体来说`addressDict`，

```
"Implicit conversion of the Objective-C pointer ARC error requires a  bridged cast" 
```

所以我尝试了：

```
ABMultiValueAddValueAndLabel(address, (__bridge_retained CFDataRef)dataRef, kABWorkLabel, NULL); 
```

现在我没有想法了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T21:33:04.163

好的，解决了这个问题，对于其他有 ARC 问题的人

代替：

```
ABMultiValueAddValueAndLabel(address, addressDict, kABWorkLabel, NULL); 
```

和：

```
ABMultiValueAddValueAndLabel(address,(__bridge_retained CFDataRef) addressDict,  kABWorkLabel, NULL); 
```

# javascript - 防止浏览器自动填写表单域

> ID：11529712
> 
> 赞同：7
> 
> 时间：2012-07-17T19:40:30.167
> 
> 标签：javascript, jquery, html, firefox, security

我试图找到一种方法来阻止浏览器（主要是 FF）阻止自动填写我的表单。我没有自动完成，因为他们输入的值会提供建议。但是当我在 FF 中加载表单时，它会自动用以前的值填充表单。但我希望在加载时字段始终为空白。

我尝试在标签中使用 autocomplete="off" ，但这不起作用。有什么解决办法吗？我一直在寻找其他问题，他们都说要使用该属性，但它不适用于自动填充，它适用于自动完成。我可以使用 JS/jQuery 来做到这一点吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-17T19:51:15.193

试试这可能对你有用`autocomplete="off"`

```
<input type="text" autocomplete="off" /> 
```

检查：[**如何关闭表单自动完成**](https://developer.mozilla.org/en/How_to_Turn_Off_Form_Autocompletion)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-07-11T14:09:49.907

新版本的 Chrome 和 Mozilla 无法识别`autocomplete="off"`或`autocomplete="false"`. 我使用这个[js 解决方案解决了自动完成问题](https://github.com/terrylinooo/jquery.disableAutoFill)

# jquery - 如果单选的值是指定值，则使文本字段成为必需

> ID：11529714
> 
> 赞同：0
> 
> 时间：2012-07-17T19:40:40.850
> 
> 标签：jquery, jquery-validate

我有一个带有单选按钮和一个文本字段的表单。如果所选收音机的值为 96 或 97，我如何使文本字段成为强制性的。到目前为止，我的代码如下

```
<p style="margin: 0px 4px 1px 4px;padding: 4px 0 4px 0; background:#FFF"><input type="radio" name="qID18" value="96" class="required" />  All Festivals / Events  </p>

<p style="margin: 0px 4px 1px 4px;padding: 4px 0 4px 0; background:#FFF"><input type="radio" name="qID18" value="97" class="required" />  Similar Festivals / Events  </p>

<p style="margin: 0px 4px 1px 4px;padding: 4px 0 4px 0; background:#FFF"><input type="radio" name="qID18" value="98" class="required" />  No thank you  </p>

<p style="margin: 0px 4px 1px 4px;padding: 4px 0 4px 0; background:#FFF">&nbsp; Enter Email To Send Information To: <input type="text" name="something" ></p> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:47:15.720

尝试这个：

```
$('input[name="qID18"]').change(function(){
   if (this.value == 96 || this.value == 97) {
      $('input[name="something"]').addClass('required')
   } else {
      $('input[name="something"]').removeClass('required')
   }
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:46:47.190

是否有包含这些输入元素的表单元素？如果是这样，只需添加一个提交处理程序来检查值并根据需要应用或删除所需的属性。我在您的标记周围添加了一个表单容器并添加了一个提交按钮，并将我的解决方案发布在 jsFiddle 上：http: [//jsfiddle.net/quant/2pJkc/](http://jsfiddle.net/quant/2pJkc/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T19:46:15.613

像这样的东西应该工作：

```
$("form").on("submit", function() {
    var radio = $(":radio:checked").val();
    if (radio == 96 || radio == 97) {
        if ($.trim($(":text").val()) == "") {
            alert("Failed!");
            return false;
        }
    }
    return true;
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T20:03:16.543

```
var radiobuttonchecked = $(":radio:checked").val();
if (radiobuttonchecked !=98 ) {
    if ($.trim($(":text").val()) == '') {
        alert('text is mandatory.');
        return false;
    }
} 
```

# php - 如何使用 PHP 或 Linux 脚本找到 PDF 的方向？

> ID：11529715
> 
> 赞同：9
> 
> 时间：2012-07-17T19:40:41.883
> 
> 标签：php, linux, pdf

我需要扫描上传的 PDF 以确定其中的页面是否都是纵向的，或者是否有横向页面。有没有办法可以使用 PHP 或 linux 命令来扫描这些页面的 PDF？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-17T20:51:12.447

## （更新的答案 - 向下滚动......）

您可以使用`pdfinfo`（*poppler-utils*或*xpdf-tools*的一部分）或`identify`（ImageMagick 工具包的一部分）。

## 确认：

```
identify -format "%f  Page %s:   Width: %W -- Height: %H\n" T-VD7.PDF 
```

示例输出：

```
T-VD7.PDF  Page 0:  Width: 595 -- Height: 842
T-VD7.PDF  Page 1:  Width: 595 -- Height: 842
T-VD7.PDF  Page 2:  Width: 1191 -- Height: 842
[...]
T-VD7.PDF  Page 11:  Width: 595 -- Height: 421
T-VD7.PDF  Page 12:  Width: 595 -- Height: 842 
```

或者更简单一点：

```
identify -format "%s: %Wx%H\n" T-VD7.PDF 
```

给出：

```
0:  595x842
1:  595x842
2:  1191x842
[...]
11:  595x421
12:  595x842 
```

**注意**，如何`identify`使用从零开始的页面计数机制！

如果页面的宽度大于高度，则页面为“横向”。如果两者相等，则它们既不是也不是。

优点是可以`identify`让您非常轻松且非常广泛地调整输出格式。

## pdf信息：

```
pdfinfo input.pdf | grep "Page.*size:" 
```

示例输出：

```
Page size:      595.276 x 841.89 pts (A4) 
```

`pdfinfo`如果涉及多页 PDF，肯定比*更快*、更*精确。*`identify`（*我测试的 13 页 PDF 需要`identify`31 秒才能处理，而`pdfinfo`需要不到半秒......*）

**警告：**默认情况下只`pdfinfo`报告***第一页***的大小。要获取*所有*页面的大小（您可能知道，有些 PDF 使用混合页面大小和混合方向），您必须修改命令：

```
pdfinfo -f 3 -l 13 input.pdf | grep "Page.*size:" 
```

现在输出：

```
Page    1 size: 595.276 x 841.89 pts (A4)
Page    2 size: 595.276 x 841.89 pts (A4)
Page    3 size: 1191 x 842 pts (A3)
[....]
Page   12 size: 595 x 421 pts (A5)
Page   13 size: 595.276 x 841.89 pts (A4) 
```

这将打印第 3 页（**首先**报告）到第 13 页（**最后**报告）的大小。

## 编写脚本：

```
 pdfinfo \
    -f 1 \
    -l 1000 \
     Vergleich-VD7.PDF \
| grep "Page.* size:" \
| \
| while read Page _pageno size _width x _height rest; do 
  [ "$(echo "${_width} / 1"|bc)" -gt "$(echo "${_height} / 1"|bc)" ] \
     && echo "Page $_pageno is landscape..." \
    || echo "Page $_pageno is portrait..."  ; \
 done 
```

（`bc`-trick 是必需的，因为`-gt`比较仅适用于整数的 shell。除以`1`with`bc`会将可能的实数值取整为整数......）

结果：

```
Page 1 is portrait...
Page 2 is portrait...
Page 3 is landscape...
[...]
Page 12 is landscape...
Page 13 is portrait... 
```

* * *

# 更新：使用“权利”`pdfinfo`发现页面旋转...

我最初的回答吹响了`pdfinfo`. Serenade X 在评论中说他/她的问题是发现*旋转*的页面。

好的，这里有一些尚未广为人知的附加信息，因此尚未被所有`pdfinfo`用户真正吸收......

正如我所提到的，有两种不同的`pdfinfo`实用程序：

1.  作为`xpdf-utils`包的一部分提供的一个（在某些平台上也称为`xpdf-tools`）。
2.  作为包的一部分出现的那个`poppler-utils`（在某些平台上也称为`poppler-tools`，有时它不是作为包分开而是作为主`poppler`包的一部分）。

### 波普勒的`pdfinfo`输出

因此，这里是 Poppler`pdfinfo`命令的示例输出。测试文件是 2 页 PDF，其中第一页为纵向 A4，第二页为横向 A4 格式：

```
kp@mbp:~$ pdfinfo -f 1 -l 2 a4portrait+landscape.pdf
制作人：GPL Ghostscript 9.05
创建日期：2012 年 7 月 26 日星期四 14:23:31
修改日期：2012 年 7 月 26 日星期四 14:23:31
标签： 没有
形式：无
页数：2
加密：否
第 1 页尺寸：595 x 842 磅 (A4)
第 1 页腐烂：0
第 2 页尺寸：842 x 595 磅 (A4)
第 2 页腐烂：0
文件大小：3100 字节
优化：无
PDF版本：1.4

```

你看到说`Page 1 rot: 0`和的线条了`Page 2 rot: 0`吗？

你注意到这句话`Page 1 size: 595 x 842 pts (A4)`和`Page 2 size: 842 x 595 pts (A4)`两者之间的区别了吗？

### XPDF 的`pdfinfo`输出

现在让我们将其与 XPDF 的输出进行比较`pdfinfo`：

```
kp@mbp:~$ xpdf-pdfinfo -f 1 -l 2 a4portrait+landscape.pdf
制作人：GPL Ghostscript 9.05
创建日期：2012 年 7 月 26 日星期四 14:23:31
修改日期：2012 年 7 月 26 日星期四 14:23:31
标签： 没有
页数：2
加密：否
第 1 页尺寸：595 x 842 磅 (A4)
第 2 页尺寸：842 x 595 磅 (A4)
文件大小：3100 字节
优化：无
PDF版本：1.4

```

如果您仔细观察，您可能会注意到*另一个不同之处。*我不会把手指指向它，我会暂时闭上嘴...... :-)

### Poppler`pdfinfo`正确报告第 2 页的旋转

`pdftk`接下来，我使用（我没有 Adob​​e Acrobat）将文件的第二页旋转 90 度：

```
pdftk \
  a4portrait+landscape.pdf \
  cat 1 2E \
  output a4portrait+landscape---page2-landscaped-by-pdftk.pdf 
```

现在波普勒的`pdfinfo`报道是这样的：

```
kp@mbp:~$ pdfinfo -f 1 -l 2 a4portrait+landscape---page2-landscaped-by-pdftk.pdf
创建者：pdftk 1.44 - www.pdftk.com
制作人：itext-paulo-155 (itextpdf.sf.net-lowagie.com)
创建日期：2012 年 7 月 26 日星期四 14:39:47
修改日期：2012 年 7 月 26 日星期四 14:39:47
标签： 没有
形式：无
页数：2
加密：否
第 1 页尺寸：595 x 842 磅 (A4)
第 1 页腐烂：0
第 2 页尺寸：842 x 595 磅 (A4)
第 2 页腐烂：90
文件大小：1759 字节
优化：无
PDF版本：1.4

```

如您所见，该行`Page 2 rot: 90`告诉我们我们正在寻找什么。XPDF`pdfinfo`将基本上报告有关更改文件的信息，就像它报告原始文件一样。当然，它仍然可以正确捕获更改的`Creator:`,`Producer:`和`*Date:`信息，但它会错过旋转的页面......

**还要注意这个细节：第2页最初设计为横向页面，从`Page 2 size: 842 x 595 pts (A4)`信息部分可以看出。但是，它在当前 PDF 中显示为纵向页面，如`Page 2 rot: 90`部件所示。**

另请注意，轮换信息可能会出现 4 个不同的值：

*   `0`（无旋转），
*   `90`（向东旋转，或顺时针旋转 90 度），
*   `180`（向南旋转，翻滚的页面图像，倒置，或顺时针 180 度），
*   `270`（向西旋转，或逆时针旋转 90 度，或顺时针旋转 270 度）。

## 一些背景信息

[Popper](http://poppler.freedesktop.org/releases.html)（由[*The Poppler Developers 开发*](http://poppler.freedesktop.org/)）是[XPDF](http://www.foolabs.com/xpdf/download.html)（由[*Glyph & Cog LLC*](http://www.glyphandcog.com/)开发）的一个分支，它发生在 2005 年左右。（当时他们分叉 Poppler 开发人员的重要原因之一是：Glyph & Cog 没有t 总是为与安全相关的问题提供及时的错误修复......）

无论如何，Poppler fork 很长一段时间以来一直保持相关的命令行实用程序、它们的命令行参数和语法以及它们的输出格式与原始 (XPDF/Glyph & Cog LLC) 兼容。

### 与竞争 XPDF 工具相比，现有的 Poppler 工具获得了额外的功能

但是，最近他们开始添加其他功能。从我的头顶冒出：

*   `pdfinfo`现在还报告每个页面的*轮换*状态（从 2012 年 3 月 1 日发布的 Poppler v0.19.0 开始）。
*   `pdffonts`现在还报告每种字体的*字体编码*（从 2012 年 3 月 15 日发布的 Poppler v0.19.1 开始）。

### Poppler 工具获得更多兄弟姐妹

Poppler 工具还提供了一些额外的命令行实用程序，这些实用程序不在原始 XPDF 包中（其中一些是最近才添加的）：

*   `pdftocairo`- 用于创建 PNG、JPEG、PostScript、EPS、PDF、SVG 的实用程序（使用 Cairo）
*   `pdfseparate`- 提取 PDF 页面的实用程序
*   `pdfunite`- 用于合并 PDF 文件的实用程序
*   `pdfdetach`- 从 PDF 中列出或提取嵌入文件的实用程序
*   `pdftohtml`- 从 PDF 文件转换 HTML 的实用程序

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-17T19:48:05.210

`identify`ImageMagick 附带的将为您提供给定 PDF 文件的宽度和高度（它还需要在系统上安装 GhostScript）。

```
$ identify -format "%g\n" FILENAME.PDF
1417x1106+0+0 
```

`1417`宽度在哪里，`1106`高度在哪里，您（为此）可以忽略`+0+0`.

*编辑：*对不起，我指的是**Mike B**对原始问题的评论 - 正如他所说，在知道宽度和高度后，您可以确定您是否有纵向或横向图像（如果高度 > 宽度则纵向，否则为横向）。

此外，`\n`添加到参数中的`-format`参数（如 Kurt Pfeifle 所建议的）会将每个页面分隔成自己的行。他还提到了`%W`和`%H`格式参数；所有可能的格式参数都可以在[这里](http://www.imagemagick.org/script/escape.php)找到（有很多）。

# qt - PySide 和 Qt 属性框架

> ID：11529721
> 
> 赞同：1
> 
> 时间：2012-07-17T19:41:05.203
> 
> 标签：qt, properties, frameworks, pyside

是否可以将[Qt 属性框架](http://doc.qt.nokia.com/qq/qq18-propertybrowser.html)与[PySide](http://www.pyside.org/)一起使用？如果没有，您是否有关于如何使用[Qt MVC 框架](http://doc.qt.nokia.com/4.7-snapshot/model-view-programming.html)实现类似行为的提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-16T19:49:39.863

即使这个问题有点陈旧...... **是**的，你可以很好地使用它。看看[这里](https://wiki.qt.io/Qt_for_Python_UsingQtProperties)作为例子。AFAIK 也努力使用 Python @properties 作为 Qt 属性。

# ios - 如何在 UITableViewController 中显示无数据启动 UIView？从 tableView 添加和删除视图？

> ID：11529722
> 
> 赞同：1
> 
> 时间：2012-07-17T19:41:18.253
> 
> 标签：ios, xcode, uitableview, ios5, storyboard

如何在 TableView 中添加或删除视图？

我希望它在 tableView 中没有任何内容时提出“无连接”，但是当有数据时，我只想要一个普通的 tableView。

我检查了很多问题，所有这些问题都以奇怪的方式从单元格中删除视图并在单元格中执行所有操作。但是，我还发现你可以在 Xcode 中将 UIView 拖到 tableView 中，它会随之滚动。

当你这样做，并且你想摆脱视图时，你只需将该视图的 hidden 属性设置为 true。

这里的问题是，曾经有视图的地方有空白。我希望它完全消失而不在那里，但是添加/删除子视图对我不起作用。我也尝试了很多其他解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:41:18.253

我发现您可以简单地将视图放入 Xcode 中的存储桶中，但不能放入视图控制器中。（见图）

![不在视图控制器中](../Images/bc574c333cb45adbc81fcf5f62cac58b.png)

然后，我发现如果我为此做了一个出口`UIView`，我仍然可以使用它。请注意，在将视图移到此位置之前，我必须以编程方式或在 IB 中设计视图并使其具有适当的大小等，因为我在 IB 中再也看不到它了。

然后，在`TableViewController`课堂上，我曾经`ViewWillAppear`检查过备份 TableView 的数组的计数。如果它为零，我将视图（使用 Outlet）设置为隐藏或不隐藏。

接下来，我使用了这段代码：

```
-(CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section
{
    if (noConnectionView.hidden)
    {
        return 0;
    } else {
        return 480;
    }
}

- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section
{
    if (noConnectionView.hidden)
    {
        return nil;
    } else {
        return noConnectionView;
    }
} 
```

这使它填充了我的弹出框，并且由于 section 方法的单元格数返回了我已经检查过的相同计数（如果表为空，则为零），这是唯一显示的内容（没有空单元格）。

当有东西要显示时，`ViewWillAppear`每次都会被调用（每当东西被删除时，我都会再次调用view），然后tableView摆脱了标题，它的行为就像一个普通的tableView。

这很棒，因为您可以将它与`UITableViewController`导航控制器一起使用或按顺序使用。

# c# - 将字符串与 null 进行比较 - 为什么 Resharper 认为这总是错误的？

> ID：11529726
> 
> 赞同：12
> 
> 时间：2012-07-17T19:41:35.530
> 
> 标签：c#, .net, string, resharper, membership-provider

我的自定义 MembershipProvider 中有这段代码：

```
public override void Initialize(string name, System.Collections.Specialized.NameValueCollection config)
{
    if (config == null)
        throw new ArgumentNullException("config");

    if (name == null)
        name = "MyCustomMembershipProvider";
    ...
} 
```

Resharper 标记了第二个 if 语句并告诉我，它总是评估为假。

![更清晰的消息](../Images/9f482f9b52f7635645f6e943eb9930d7.png)

但是为什么这总是评估为假？我可以轻松地将 null 作为参数传递给该方法。

这是一个错误还是 Resharper 就在这里？

PS 1：我使用 Resharper 6.1
PS 2：我知道使用 string.IsNullOrEmpty() 无论如何都是去这里的方式。我只是好奇。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-17T19:45:27.827

可能，参数`name`被标记为`[NotNull]`。Resharper 附带常见 BCL 类的合同元数据。

# c - 这种结构指针的使用正确吗？

> ID：11529727
> 
> 赞同：-2
> 
> 时间：2012-07-17T19:41:43.003
> 
> 标签：c, pointers, struct

我有这个结构：

```
typedef struct Grades {
int  grade1;
int  grade2;
int  grade3;
int  grade4;
int  grade5;
} 
```

我使用创建了一个指向 Grades 结构的指针

```
struct Grades   *pointer; 
```

我有一个 function()，它返回一个 (void *) 指向特定 Grades 结构的指针。

如何使用 (void *) 指针设置指向该特定结构的指针？

我刚在想：

```
pointer = &function(); 
```

但这给了我一个错误：“'&'需要左值

有任何想法吗？顺便说一句，我不能修改函数所以......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T19:44:04.530

```
pointer = function(); 
```

如果 function() 返回一个 void 指针，则不需要获取它的地址，它已经是指向 Grades 结构的指针。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-17T19:44:18.110

如果 function() 返回一个指针，你应该能够做到

```
pointer = function(); 
```

# architecture - mach-o 但错误的架构

> ID：11529729
> 
> 赞同：1
> 
> 时间：2012-07-17T19:41:47.767
> 
> 标签：architecture, mach-o, tix

我正在尝试安装一个名为 ARIA2.3 的程序，该程序用于使用 NMR 数据计算蛋白质结构。该程序需要另一个名为 Tix 的程序来运行图形界面。然而，事实证明，Tix 安装起来很麻烦（保持礼貌）。我想我设法安装了它，但是当我使用命令启动 ARIA 的图形界面时仍然出现错误

```
aria --gui 
```

我收到此错误消息：

```
Traceback (most recent call last):  
File "/Users/davidbernard/Desktop/RMN/aria2.3/aria2.py", line 875, in <module>
    run_gui(a['-g'])
  File "/Users/davidbernard/Desktop/RMN/aria2.3/aria2.py", line 556, in run_gui
    gui.go(project_file)
  File "/Users/davidbernard/Desktop/RMN/aria2.3/src/py/aria/gui/gui.py", line 1555, in go
    root = Tix.Tk()
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-tk/Tix.py", line 225, in __init__
    self.tk.eval('package require Tix')
_tkinter.TclError: dlopen(/usr/local/lib/Tix8.4.3/libTix8.4.3.dylib, 6): no suitable image found.  Did find:
    /usr/local/lib/Tix8.4.3/libTix8.4.3.dylib: mach-o, but wrong architecture 
```

我知道 libTix8.4.3.dylib 在架构 x86_64 中。我正在使用 Mac OS X 10.6.8，但我对信息学知之甚少。有人可以帮我让 ARIA 工作吗？

# asp.net-mvc - 使用 PhoneGap 在本地加载资源

> ID：11529733
> 
> 赞同：0
> 
> 时间：2012-07-17T19:42:03.003
> 
> 标签：asp.net-mvc, jquery-mobile, cordova, asp.net-mvc-4

我正在使用 HTML5 和 jQuery Mobile 为智能手机和平板电脑创建一个应用程序，我想使用 PhoneGap 发布它。我的应用程序完全基于 Web。（我使用 Microsoft MVC 和 C# 编写它），这意味着我的应用程序也可以通过网址获得。

但是当智能手机/平板电脑用户打开我的应用程序时，没有必要远程加载 Javascript 和 CSS。用户的智能手机/平板电脑上应该有本地副本。

所以我的问题是：如何在本地加载 Javascript 和 CSS 资源，而应用程序正在远程加载？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T04:29:18.210

我认为你不能同时拥有这两种方式：Phonegap 应用程序基本上是托管在智能手机/平板电脑中的本地网站。在 PG 上加载远程网站意味着使用 ChildBrowser 或将网站加载到 iframe 中。因此，虽然您可以将 CSS 和 JS 加载到 PG 应用程序的 index.html 中，但它对远程网站不可用...

如果你正在做一个 Phonegap 应用程序，你应该考虑在 HTML5/CSS/JS 中做它，这样一切都是本地的......

# ruby-on-rails - PG::Error: 错误：关系“用户”不存在

> ID：11529738
> 
> 赞同：19
> 
> 时间：2012-07-17T19:42:07.057
> 
> 标签：ruby-on-rails, testing, rspec, pg

很抱歉打扰您，但我对这个错误有很多疑问。首先这是我的 user_controller rspec 文件

需要'spec/spec_helper'

```
describe UserController do

it "create new user" do
    post "create"
    assigns[:users].should_not be_new_record
end
end 
```

这是我的用户控制器

```
 class UserController < ApplicationController
   def create
     @users = User.new
     if @users.save
       flash[:notice] = 'new user was successfully created.'
     else
       render :action => :new
     end
   end

   def new
     @user = User.new
   end
 end 
```

和我的 routes.rb （我认为问题就在这里，对不起，但我是这门语言的新手）

```
Estaciones::Application.routes.draw do
  devise_for :users

  root :to => "home#index"
  resources :user
end 
```

当我尝试测试我的 user_controller_rspec 时，我得到了这个错误

失败：

```
1) UserController create new user
   Failure/Error: post "create"
   ActiveRecord::StatementInvalid:
     PG::Error: ERROR:  relation "users" does not exist
     LINE 4:              WHERE a.attrelid = '"users"'::regclass
                                             ^
     :             SELECT a.attname, format_type(a.atttypid, a.atttypmod), d.adsrc, a.attnotnull
                   FROM pg_attribute a LEFT JOIN pg_attrdef d
                     ON a.attrelid = d.adrelid AND a.attnum = d.adnum
                    WHERE a.attrelid = '"users"'::regclass
                    AND a.attnum > 0 AND NOT a.attisdropped
                  ORDER BY a.attnum
 # ./app/controllers/user_controller.rb:3:in `new'
 # ./app/controllers/user_controller.rb:3:in `create'
 # ./spec/controllers/user_controller_spec.rb:6

 Finished in 0.01722 seconds
 1 example, 1 failure

 Failed examples:

 rspec ./spec/controllers/user_controller_spec.rb:5 # UserController create new user 
```

我该如何解决它...谢谢

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-07-17T19:51:55.820

运行这个

```
 rake db:migrate 
```

那么这个

```
 rake db:test:prepare 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-20T13:03:06.027

替代变体

> RAILS_ENV=test rake db:migrate

# google-maps - 设计谷歌地图时选择森林？

> ID：11529741
> 
> 赞同：3
> 
> 时间：2012-07-17T19:42:22.677
> 
> 标签：google-maps

我最近发现了谷歌地图样式（https://developers.google.com/maps/documentation/javascript/styling）

我一直在想办法隐藏森林。（[就像挪威的绿色东西](https://maps.google.com/?q=norway&ll=59.712097,13.798828&spn=13.534619,26.455078&hnear=Norway&t=m&z=5)）

并改变所有土地区域的颜色。

```
using       featureType: "landscape",
        stylers: [
          { visibility: "off" }
        ] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T20:10:44.687

使用此向导 ( [http://gmaps-samples-v3.googlecode.com/svn/trunk/styledmaps/wizard/index.html](http://gmaps-samples-v3.googlecode.com/svn/trunk/styledmaps/wizard/index.html) ) 自定义地图的样式。然后获取您创建的 JSON 并将其分配给您的样式变量`var styles`。然后您可以在地图选项中设置样式变量。

针对您的问题的 JSON 应该是：

```
[
  {
    featureType: "landscape.natural",
    stylers: [
      { visibility: "off" }
    ]
  },{
    featureType: "poi.park",
    stylers: [
      { visibility: "off" }
    ]
  }
] 
```

您也可以使用向导更改土地类型的颜色（更改色调字段）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T19:57:18.353

谷歌显然认为“森林”是一个兴趣点：

```
{
 featureType: "poi",
 stylers: [
  { visibility: "off" }
 ]
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T18:46:13.760

[在这里你有风格地图向导](https://mapstyle.withgoogle.com/)

在底部，您有“更多选项”单击横向 -> 全部。

完成点击后显示结果

# c++ - printf：以十六进制显示 SHA1 哈希

> ID：11529744
> 
> 赞同：1
> 
> 时间：2012-07-17T19:42:50.787
> 
> 标签：c++, windows, sha1, cryptoapi

我一直在关注显示如何使用 Windows CryptoAPI 对数据进行哈希处理的 msdn 示例。该示例可以在这里找到：http: [//msdn.microsoft.com/en-us/library/windows/desktop/aa382380%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa382380%28v=vs.85%29.aspx)

我已修改代码以使用 SHA1 算法。

我不明白以十六进制显示哈希（如下所示）的代码是如何工作的，更具体地说，我不明白 >> 4 运算符和 & 0xf 运算符的作用。

```
if (CryptGetHashParam(hHash, HP_HASHVAL, rgbHash, &cbHash, 0)){
    printf("MD5 hash of file %s is: ", filename);
    for (DWORD i = 0; i < cbHash; i++)
    {
        printf("%c%c", rgbDigits[rgbHash[i] >> 4],
           rgbDigits[rgbHash[i] & 0xf]);
    }
    printf("\n");
} 
```

如果有人能为我解释一下，我将不胜感激，在此先感谢:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T19:50:39.010

`x >> 4`右移`x`四位。在和之间`x & 0xf`进行按位运算。0xf 设置了四个最低有效位，所有其他位都清除。`and``x``0xf`

假设`rgbHash`是一个无符号字符数组，这意味着第一个表达式仅保留四个最高有效位，第二个表达式保留（大概）8 位输入的四个最低有效位。

四位恰好适合一个十六进制数字，因此每个位都用于在数组中查找一个十六进制数字，大概看起来像这样：

```
char rgbDigits[] = "0123456789abcdef"; // or possibly upper-case letters 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T19:54:10.500

此代码使用简单的位“过滤”技术

*   “>> 4”表示右移 4 位，这反过来表示“除以 16”
*   "& 0xf" 等于位与运算，意思是“取前 4 位”

这两个值都被传递给 rgbDigits，它在有效范围内产生了输出 - 人类可读

# javascript - 不显示图形

> ID：11529750
> 
> 赞同：2
> 
> 时间：2012-07-17T19:43:05.833
> 
> 标签：javascript, html, css, raphael

我只是想使用 Javascript Library Raphael 创建一些简单的矢量图形。应该有一个方形对象和一个弯曲对象，但没有显示任何内容。谁能帮我。谢谢你。

```
<html>

<head>
<script src="raphael.js"></script>
<script src="jquery-1.7.2.js"></script>

<script type="text/javascript"> //all your javascript goes here  
var paper = Raphael("sample-2", 200, 100);
var rectPath = paper.path("M10,10L10,90L90,90L90,10Z");
var curvePath = paper.path("M110,10s55,25 40,80Z");

rectPath.attr({fill:"green"});
curvePath.attr({fill:"blue"});
</script>

</head>

<body>

<div id="sample-2" style="width:500px; height:500px;">

</div>

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T19:44:41.307

将您的脚本移动到`<div id="sample-2" style="width:500px; height:500px;">`标签之后

或者有些人更喜欢使用 onload 处理程序，为了简单起见使用 jQuery

```
$(function(){
    // Your code that runs after the DOM is loaded
}); 
```

关键是您的代码正在访问 DOM，并且它需要在 DOM 构建后运行。从 onload 处理程序或在您使用的 DIV 之后调用它可确保元素已准备好与之交互。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T19:46:34.833

您运行 Javascript 太早了。您的浏览器将在读取 Javascript 时运行它，如果尚未加载 DOM 元素，它不会执行任何操作。

尝试这个：

```
<html>
    <head>
        <script src="raphael.js"></script>
        <script src="jquery-1.7.2.js"></script>
    </head>

    <body>
        <div id="sample-2" style="width:500px; height:500px;"></div>
        <script type="text/javascript">
            //all your javascript goes here  
            var paper = Raphael("sample-2", 200, 100);
            var rectPath = paper.path("M10,10L10,90L90,90L90,10Z");
            var curvePath = paper.path("M110,10s55,25 40,80Z");

            rectPath.attr({
                fill: "green"
            });
            curvePath.attr({
                fill: "blue"
            });
        </script>
    </body>
</html> 
```

享受和好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T21:38:02.847

@JuanMendes 有点令人困惑，最后的问题是在 DOM 准备好之前调用了 js 函数，仍在创建元素。我建议使用`$(document).ready(function(){})`，以便仅在创建 DOM 后执行脚本。我只是再次解释，因为他在问他为什么必须这样做。例如，如果他这样做：

```
<html>

<head>
<script src="raphael.js"></script>
<script src="jquery-1.7.2.js"></script>

<script type="text/javascript">
$(document).ready(function(){ //all your javascript goes here  
var paper = Raphael("sample-2", 200, 100);
var rectPath = paper.path("M10,10L10,90L90,90L90,10Z");
var curvePath = paper.path("M110,10s55,25 40,80Z");

rectPath.attr({fill:"green"});
curvePath.attr({fill:"blue"});
}
)
</script>

</head>

<body>

<div id="sample-2" style="width:500px; height:500px;">

</div>

</body>

</html> 
```

该脚本应该可以工作，因为该脚本是在 DOM 准备好之后执行的。

PS 附带说明一下，如果您想操作动态创建的内容，您需要将事件处理程序附加为单击、模糊、悬停等......使用绑定操作以便注册事件。例子：

```
$('#form').on('blur', '#input', function(){
 // code

}) 
```

[您可以在http://api.jquery.com/on/](http://api.jquery.com/on/) 和 .ready() 上 查看绑定文档： http: [//api.jquery.com/ready/](http://api.jquery.com/ready/)

# mercurial - 推荐 Perfarce（或其他？）用于评估 Mercurial 工作流程

> ID：11529756
> 
> 赞同：2
> 
> 时间：2012-07-17T19:43:24.630
> 
> 标签：mercurial, perforce, perfarce

**[注意：“Perfarce”是与 Perforce 集成的 Mercurial 扩展名：[https](https://www.mercurial-scm.org/wiki/PerfarceExtension) ://www.mercurial-scm.org/wiki/PerfarceExtension ]**

我们开始为当前存储在 Perforce 中的项目评估 Mercurial。与其放弃 P4 仓库并在 ​​Hg 中进行所有更改，我们希望主要在 Hg 中工作并定期将更改推送到 P4。在此评估期间，一些开发人员可能会继续在 Perforce 中工作，但除此之外，我们还想评估 DVCS 使之成为可能的工作流程，例如从一个开发人员的 repo 拉到另一个。

我已经尝试过 Perfarce 扩展，它看起来是使用 Hg 作为具有更精细本地历史的高级 P4 客户端的好方法。然而，当我使用 Perfarce 在两台不同的机器上检查同一棵树时，我得到了两个具有不同变更集 ID 的 Mercurial 历史记录。看起来以这种方式共享更改的唯一方法是通过 P4 仓库。

是否有其他选项可以使开发人员的存储库与 P4 同步，而不会使它们在 Mercurial 级别不兼容？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T23:29:15.070

老实说 - 这听起来像是一种可能导致噩梦的情况。以下是我将如何处理它以最大程度地减少一些风险和痛苦：

*   将 Perforce 工作区设置为“ [allwrite](http://www.perforce.com/perforce/doc.current/manuals/p4web/help/editclient.html) ”，这样 Perforce 就不会过多地干扰 Hg。
*   使用单个 P4 工作区将更改从 depot 同步到 mercurial 存储库（以及从 hg 返回到 depot），然后从中执行您的 mercurial 推/拉工作。将其视为 GitHub 或 Bitbucket 上的主存储库。
*   通过使用 P4V 的“协调离线工作”功能，使用 one-true-workspace 同步更改回 Perforce，并确保仔细查看更改列表（您不想提交 .hg 目录）。

通过一些纪律，您应该能够避免一些陷阱，尽管这肯定不是一个理想的前进道路。我不认为有一个项目符号可以让您无缝地保持您的更改在所有不同的存储库中正确镜像，并让每个人都像往常一样工作。

# c# - 动态生成 html 并进行验证

> ID：11529762
> 
> 赞同：0
> 
> 时间：2012-07-17T19:44:09.473
> 
> 标签：c#, javascript, asp.net, .net, jquery-ui

如果在点击提交按钮之前选择的日期小于客户端的当前日期，我正在尝试添加 TextBox ID="tbComment"。

哪种方式会更好？我尝试过使用 javascript 方式，但我不知道为什么，但页面无法加载。

I know there is "onTextChanged" event for a textbox when fired we can call a javascript, but how does one implement it to add html when the date selected is less than the current date on the client side?

```
<table class="sidemenu" id="BudgetDetailsTable" align="left" border="0" runat="server"
                    width="100%">
                    <tr>
                        <td width="20%">
                            Project Period Start Date:
                        </td>
                        <td width="80%">
                            <asp:TextBox ID="txtFromDate" title="Click to select date" Style="cursor: pointer"
                                runat="server" CssClass="textboxunderline" EnableViewState="true" TabIndex="1"></asp:TextBox><asp:RequiredFieldValidator
                                    ID="rfvFromDate" runat="server" ErrorMessage="<br /> - Please provide Start Date."
                                    ControlToValidate="txtFromDate">*</asp:RequiredFieldValidator><asp:CompareValidator
                                        ID="cvFromDate" runat="server" ErrorMessage="<br /> - Please provide valid From date. From date should be before End date."
                                        ControlToValidate="txtFromDate" Display="dynamic" Type="Date" Operator="LessThanEqual"
                                        ControlToCompare="txtEndDate">*
                                    </asp:CompareValidator>
                                    <asp:CustomValidator ID="cvBeforeDate" runat="server" ErrorMessage="<br /> - Please provide a reason to for adding a sheet having start date before today's date."
                                OnServerValidate="cvCheck_StartDate">* </asp:CustomValidator>

                        </td>
                    </tr>
                    <tr>
                        <td width="20%">
                            Project Period End Date:
                        </td>
                        <td width="80%">
                            <asp:TextBox ID="txtEndDate" title="Click to select date" Style="cursor: pointer"
                                runat="server" CssClass="textboxunderline"  EnableViewState="true" TabIndex="2"></asp:TextBox><asp:RequiredFieldValidator
                                    ID="rfvEndDate" runat="server" ErrorMessage=" <br /> - Please provide End Date."
                                    ControlToValidate="txtEndDate">* </asp:RequiredFieldValidator><asp:CompareValidator
                                        ID="cvEndDate" runat="server"  ErrorMessage="<br /> - Please provide valid End date. End date should be larger than From date."
                                        ControlToValidate="txtEndDate"   Display="dynamic" Type="Date" Operator="GreaterThanEqual"
                                        ControlToCompare="txtFromDate">*
                                    </asp:CompareValidator>
                            <asp:CustomValidator ID="cvDateMonth" runat="server"  ErrorMessage="<br /> - Please provide start day and month different to end day and month."
                                  ClientValidationFunction="cvDateMonth_ServerValidate">*</asp:CustomValidator>
                        </td>
                    </tr>
                    <tr>
                        <td width="20%" >
                            <asp:Label ID="Reason" CssClass="sidemenu" runat="server" Visible="False">Reason:</asp:Label>                                    
                        </td>
                        <td width="80%" >
                            <asp:TextBox ID="tbComment" runat="server"  Visible="False" TabIndex="3" 
                                CausesValidation="false" Width="646px"  Enabled="False"></asp:TextBox><asp:RequiredFieldValidator
                                ID="rfvReason" runat="server"   CssClass="requiredStar" ErrorMessage="<br /> - Please provide a reason to submit a proposal who's start date is before Today's date."
                                ControlToValidate="tbComment">* </asp:RequiredFieldValidator>

                        </td>
                    </tr> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:47:33.893

您可以使用 (element).innerHTML 直接修改元素的源代码。这不应该给你一个错误，但也许其他人有更高级的方法？

# php - 使用 Codeigniter 安全地转义 MySQL 中的动态表名

> ID：11529763
> 
> 赞同：8
> 
> 时间：2012-07-17T19:44:12.630
> 
> 标签：php, mysql, security, codeigniter, activerecord

我面临一个小问题。我目前正在开发一个需要在 MySQL 中使用动态表名的应用程序。

基本上，我有一个基于多种因素（类型、播放长度、发行日期等）从数据库中选择专辑的过程——这个过程的一部分允许用户创建一堆自定义过滤器。

自定义过滤器向用户返回该选择条件内所有专辑的计数。然后将这些专辑的 ID 存储在一个带有随机生成的哈希/序列号的表中（例如，albumSelect_20880f9c05d68a）

我这样做是因为我不想在一个字段中存储一个巨大的逗号分隔列表（真的很傻）——而且我不喜欢将一组值发送到我的 HTML 中的隐藏字段，因为这只会增加数据吞吐量（一次可能是数千行）

在 CodeIgniter 中，我使用查询绑定来生成我的 SQL 查询，如下所示：

```
select * from artists where artistName = ? AND albumTitle = ? 
```

当我参数化查询时，查询会自动转义

```
$query = $this->db->query($sql,array("Singer","Album")); 
```

**现在是棘手的部分**

如果我将查询编写为如下所示：

```
$sql = "select albumid from albums where albumid in (select albumid from albumSelect_?)";
$this->db->query($sql,array('20880f9c05d68a')); 
```

结果查询变为：

```
select `albumid` from `albums` where `albumid` in (select `albumid` from `albumSelect_'20880f9c05d68a'`) 
```

完全正确，但显然查询无效..

**编辑：更多信息**

查询可能是更大查询的一部分，具体取决于用户选择的条件。例如

```
$sql = "select albumid from albums where albumid in(select albumid from tags where tag = ?) AND albumid in(select albumid from albumSelect_?)"; 
```

我只是想知道是否有办法让这个工作，或者是否有人可以提出更好的选择。表名的连接显然**不是**一个选项。

提前致谢！

戴夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T20:03:17.750

转义机制仅适用于数据字符串，不适用于模式名称。换句话说，只针对表格的*内容*，不针对其*结构*。因此，您要么必须自己将字符串粘贴到查询中，要么避免以这种方式使用表。查询模板在`?`那里帮不上忙。

如果将字符串粘贴到表名中，则可以使用通常的 PHP 字符串连接机制。您应该**额外确保**对照适当严格的正则表达式检查字符串，以避免 SQL 注入。确保您**实际上**只粘贴您生成的格式的单个随机字符串，而不是其他任何内容。

作为替代方案，您可以有一个包含所有选择的大表，并使用附加列来保存您的标识散列，或使用其他合适的键来标识单个选择。这样，您就不必在正常操作期间修改数据库模式。我相信大多数开发人员，包括我在内，都宁愿避免通过程序代码进行此类修改。良好的数据库设计适用于固定模式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T07:28:50.847

听起来你想使用动态 SQL。您可能不得不走[准备好的陈述](http://dev.mysql.com/doc/refman/5.1/en/sql-syntax-prepared-statements.html)的道路。有了它们，您可以调用`PREPARE`字符串，然后调用`EXECUTE`它。正常的连接工作得很好。

这应该允许您将 SQL 构建为字符串并执行它。如果将 CodeIgniter 的参数化与 MySQL 存储过程结合使用，则可以调用类似的查询`"CALL selectAlbums(?, ?)"`（假设`selectAlbums`是包含实际查询的存储过程`PREPARE`），它将返回集合。

如果您想摆脱`'`输出中的 s，请通过 引导参数[`CONCAT`](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_concat)，这将产生一个正常的字符串。

# tomcat - 如何在 Windows 上的 solr 上安装 Rich Document 补丁？

> ID：11529767
> 
> 赞同：0
> 
> 时间：2012-07-17T19:44:34.443
> 
> 标签：tomcat, solr, lucene

文档说要查看此页面：[http ://wiki.apache.org/solr/HowToContribute#Working_With_Patches](http://wiki.apache.org/solr/HowToContribute#Working_With_Patches)

但这并不是很有帮助。

我已经下载了rich.patch (http://wiki.apache.org/solr/UpdateRichDocuments#Updating_a_Solr_Index_with_Rich_Documents_such_as_PDF_and_MS_Office) 并且我已经 cd'd 进入了我的 solr 主目录。我尝试运行以下命令：

```
patch -p0 -i rich.patch 
```

它只是问我要修补哪个文件。例如，它会这样说：

```
can't find file to patch at input line 2681
Perhaps you used the wrong -p or --strip option?
The text leading up to this was:

Index: example/solr/conf/solrconfig.xml 
```

然后，当它提示我要修补的文件时，我只需输入我的 solrconfig.xml 文件的路径，“C:\xampp\solr\conf\solrconfig.xml”

当我这样做时，它成功更新了我的 java/org 文件夹以包含 ExcelParse.java、PowerPointParser.java 等。但是当我尝试使用“java -jar post.jar *.* ”发布 word 文档时，我得到了错误

```
FATAL: Solr returned an error #400 Bad Request 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T04:13:33.770

rich.patch 已在 Solr 1.4 版本中修复，您应该能够使用 Solr 解析和索引 Rich 文档，无需任何补丁。

正如 Mauricio 提到的，查看[ExtractingRequestHandler](http://wiki.apache.org/solr/ExtractingRequestHandler)

另请查看： -

[使用 solrj 和 solr-cell-apache-tika 将丰富的文档发布到 apache-solr](http://www.lucidimagination.com/blog/2009/09/14/posting-rich-documents-to-apache-solr-using-solrj-and-solr-cell-apache-tika/)
[索引丰富的文件到 solr 快速且轻松地发布](http://www.lucidimagination.com/blog/2011/08/31/indexing-rich-files-into-solr-quickly-and-easily/)

# jquery - 来自 android 的 http $.post 不起作用

> ID：11529771
> 
> 赞同：-1
> 
> 时间：2012-07-17T19:45:00.417
> 
> 标签：jquery, asp.net, jquery-mobile, android-emulator

带有 jquery 1.7.1 的 Asp.net 页面当我通过 Eclipse 中的模拟器从 Android 手机发布它时，没有[http://www.somedomain.com/](http://www.somedomain.com/)的帖子完美运行。如果我包含 http url，它就不起作用。wfo_s.aspx 可以插入数据库，但[http://www.somedomain.com/wfo_s.aspx不行](http://www.somedomain.com/wfo_s.aspx)

如果有人能解释为什么会发生这种情况，我将不胜感激。谢谢！

```
//this does not work?
//$.post("http://www.somedomain.com/wfo_s.aspx", { the_User: theheatmap, conn: db_connection }, function (data) { });
//$.post("http://www.somedomain.com/wfo_s.aspx?the_User=" + theheatmap + "&conn=" + db_connection);
//this does work, why does the post to the url not work, page works fine 
//$.post("wfo_s.aspx", { the_User: theheatmap, conn: db_connection }, function (data) { });
//$.post("wfo_s.aspx?the_User=" + theheatmap + "&conn=" + db_connection); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:53:14.203

您**不能**跨站点执行 ajax 请求。

有一些技巧（例如：），`jsonp`但不是常规请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T21:04:31.393

嗬！我正在测试 Android 1.5，然后加载了 Android 2.1，帖子现在可以工作了。

# php - 抑制 Codeigniter 中的 DOMdocument 错误

> ID：11529774
> 
> 赞同：0
> 
> 时间：2012-07-17T19:45:13.000
> 
> 标签：php, codeigniter, codeigniter-2

我`@$this->dom->loadHTML($page);`用来抑制错误，但 CodeIgniter 似乎不尊重这一点......

日志中返回一系列错误

> 错误 - 2012-07-17 16:36:27 --> 严重性：警告 --> DOMDocument::loadHTML():

有没有办法只为一段代码或功能禁用日志记录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T03:16:42.053

这与“尊重”无关`@`，它与您误解`@`CI 的作用以及与它的关系有关。

`@`函数前面的符号告诉 PHP（不是 CI ）

> 当附加到 PHP 中的表达式时，该表达式可能生成的任何错误消息都将被忽略。

**参考：** [http ://us3.php.net/manual/en/language.operators.errorcontrol.php](http://us3.php.net/manual/en/language.operators.errorcontrol.php)

这基本上意味着它会“跳过”错误（否则你的执行会因任何错误而中断）。如果配置为这样做，CI 仍将**记录错误。**

您必须编辑 CI 的配置，并定义您的日志记录级别：

```
/*
|--------------------------------------------------------------------------
| Error Logging Threshold
|--------------------------------------------------------------------------
|
| If you have enabled error logging, you can set an error threshold to
| determine what gets logged. Threshold options are:
| You can enable error logging by setting a threshold over zero. The
| threshold determines what gets logged. Threshold options are:
|
|   0 = Disables logging, Error logging TURNED OFF
|   1 = Error Messages (including PHP errors)
|   2 = Debug Messages
|   3 = Informational Messages
|   4 = All Messages
|
| For a live site you'll usually only enable Errors (1) to be logged otherwise
| your log files will fill up very fast.
|
*/
$config['log_threshold'] = 1; 
```

# c++ - 为什么自定义循环更快？编译器不好？不安全的自定义代码？运气？（幸运的缓存命中）

> ID：11529778
> 
> 赞同：1
> 
> 时间：2012-07-17T19:45:44.933
> 
> 标签：c++, optimization, assembly

我刚刚开始学习汇编并制作一些自定义循环，以使用 C++ 的 asm{} 主体与 C-Free 5.0 中的 Digital-Mars 编译器交换两个变量

启用 -o（优化）

并得到了结果：

```
 time of for-loop(cycles)        844
 time of while-loop(cycles)      735
 time of custom-loop-1(cycles)   562
 time of custom-loop-2(cycles)   469 
```

我找不到 Digital-Mars 编译器“asm 输出”选项进行比较。构建选项中没有其他优化选项。我应该改变我的编译器吗？如果是，是哪一个？你能看看下面的代码并告诉我为什么自定义循环更快吗？

这是for循环的标准：

```
t1=clock(); 
for(int i=0;i<200000000;i++)
{
    temp=a;//instruction 1
    a=b;//instruction 2
    b=temp;//3 instructions total   
}   
t2=clock();
printf("\n time of for-loop(increasing) %i  \n",(t2-t1)); 
```

这是标准的while循环：

```
t1=clock();
while(j<200000000)
{
    temp=a;//again it is three instructions
    a=b;
    b=temp; 
            j++;
}
t2=clock();
printf("\n time of while-loop(cycles)  %i  \n",(t2-t1)); 
```

这是我的自定义循环 1：

```
t1=clock();
j=200000000;//setting the count
    __asm
    {
        pushf           //backup
        push eax        //backup
        push ebx        //backup
        push ecx        //backup
        push edx        //backup

        mov ecx,0       //init of loop range(0 to 200000000)
        mov edx,j

        do_it_again:    //begin to loop

        mov eax,a       //basic swap steps between cpu and mem(cache)
        mov ebx,b       
        mov b,eax       
        mov a,ebx       //four instructions total

        inc ecx         // j++
        cmp ecx,edx     //i<200000000  ?
        jb do_it_again  // end of loop block

        pop edx     //rolling back to history   
        pop ecx         
        pop ebx         
        pop eax         
        popf            
    }

t2=clock();
printf("\n time of custom-loop-1(cycles)   %i   \n",(t2-t1)); 
```

这是我的第二个自定义循环：

```
t1=clock();
j=200000000;//setting the count
    __asm
    {
        pushf           //backup
        push eax        
        push ebx        
        push ecx        
        push edx        

        mov ecx,0       //init of loop range(0 to 200000000)
        mov edx,j

        mov eax,a       //getting variables to registers
        mov ebx,b

        do_it_again2:   //begin to loop

        //swapping with using only 2 variables(only in cpu)
        sub eax,ebx         //a is now a-b
        add ebx,eax         //b is now a
        sub eax,ebx         //a is now -b
        xor eax,80000000h   //a is now b and four instructions total

        inc ecx         // j++
        cmp ecx,edx     //i<200000000  ?
        jb do_it_again2  // end of loop block

        pop edx         //rollback
        pop ecx         
        pop ebx         
        pop eax         
        popf            
    }

t2=clock();
printf("\n time of custom-loop-2(cycles)  %i   \n",(t2-t1)); 
```

完整代码：

```
#include<stdio.h>
#include<stdlib.h>
#include<time.h>

int main()
{
int j=0;

int a=0,b=0,temp=0;

srand(time(0));
time_t t1=0;
time_t t2=0;

t1=clock(); 
for(int i=0;i<200000000;i++)
{
    temp=a;//instruction 1
    a=b;//instruction 2
    b=temp;//3 instructions total   
}   
t2=clock();
printf("\n time of for-loop(cycles) %i  \n",(t2-t1));

t1=clock();
while(j<200000000)
{
    temp=a;//again it is three instructions
    a=b;
    b=temp; 
    j++;
}
t2=clock();
printf("\n time of while-loop(cycles)  %i  \n",(t2-t1));

t1=clock();
j=200000000;//setting the count
    __asm
    {
        pushf           //backup
        push eax        //backup
        push ebx        //backup
        push ecx        //backup
        push edx        //backup

        mov ecx,0       //init of loop range(0 to 200000000)
        mov edx,j

        do_it_again:    //begin to loop

        mov eax,a       //basic swap steps between cpu and mem(cache)
        mov ebx,b       
        mov b,eax       
        mov a,ebx       //four instructions total

        inc ecx         // j++
        cmp ecx,edx     //i<200000000  ?
        jb do_it_again  // end of loop block

        pop edx     //rolling back to history   
        pop ecx         
        pop ebx         
        pop eax         
        popf            
    }

t2=clock();
printf("\n time of custom-loop-1(cycles)   %i   \n",(t2-t1));

t1=clock();
j=200000000;//setting the count
    __asm
    {
        pushf           //backup
        push eax        
        push ebx        
        push ecx        
        push edx        

        mov ecx,0       //init of loop range(0 to 200000000)
        mov edx,j

        mov eax,a       //getting variables to registers
        mov ebx,b

        do_it_again2:   //begin to loop

        //swapping with using only 2 variables(only in cpu)
        sub eax,ebx         //a is now a-b
        add ebx,eax         //b is now a
        sub eax,ebx         //a is now -b
        xor eax,80000000h   //a is now b and four instructions total

        inc ecx         // j++
        cmp ecx,edx     //i<200000000  ?
        jb do_it_again2  // end of loop block

        pop edx         //rollback
        pop ecx         
        pop ebx         
        pop eax         
        popf            
    }

t2=clock();
printf("\n time of custom-loop-2(cycles)  %i   \n",(t2-t1));

return 0;

} 
```

我只是在学习 c++ 和汇编，想知道事情是怎么回事。谢谢

windows xp, pentium 4 (2 GHz) Digital-Mars in C-Free

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-17T20:29:12.330

该编译器生成的代码非常糟糕。用 反汇编目标文件后`objconv`，这是我对第一个`for`循环的了解。

```
?_001:  cmp     dword [ebp-4H], 200000000               ; 0053 _ 81\. 7D, FC, 0BEBC200
        jge     ?_002                                   ; 005A _ 7D, 17
        inc     dword [ebp-4H]                          ; 005C _ FF. 45, FC
        mov     eax, dword [ebp-18H]                    ; 005F _ 8B. 45, E8
        mov     dword [ebp-10H], eax                    ; 0062 _ 89\. 45, F0
        mov     eax, dword [ebp-14H]                    ; 0065 _ 8B. 45, EC
        mov     dword [ebp-18H], eax                    ; 0068 _ 89\. 45, E8
        mov     eax, dword [ebp-10H]                    ; 006B _ 8B. 45, F0
        mov     dword [ebp-14H], eax                    ; 006E _ 89\. 45, EC
        jmp     ?_001                                   ; 0071 _ EB, E0 
```

任何看过某个程序集的人都应该清楚这些问题。

1.  循环非常紧密地依赖于放入的值`eax`。由于每条下一条指令在该寄存器上创建依赖关系，这使得任何乱序执行几乎不可能。

2.  有六个通用寄存器可用（因为`ebp`并且`esp`在大多数设置中并不是真正通用的），但是您的编译器**不**使用它们，而是使用本地堆栈。当速度是优化目标时，这是绝对不能接受的。我们甚至可以看到当前循环索引存储在`[ebp-4H]`，而它本来可以很容易地存储在寄存器中。

3.  该`cmp`指令使用内存和立即操作数。这是最慢的操作数组合，在性能受到威胁时绝不应使用。

4.  不要让我开始了解代码大小。这些指令中有一半是不必要的。

总而言之，我要做的第一件事就是尽早放弃那个编译器。但是话又说回来，看到它提供“内存模型”作为其选择之一，人们似乎真的没有太大希望。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-17T20:03:09.927

在没有看到它创建的汇编语言结果的情况下，很难猜测你的编译器可能在做什么。使用 VC++ 10，我得到以下结果：

```
time of for-loop(cycles) 155

time of while-loop(cycles)  158

time of custom-loop-1(cycles)   369

time of custom-loop-2(cycles)  314 
```

我没有看输出，但我的直接猜测是`for`and`while`循环之间的区别只是噪音。不过，两者显然都比您手写的汇编代码快得多。

编辑：查看汇编代码，我是对的—— the`for`和 the的代码`while`是相同的。它看起来像这样：

```
 call    _clock
        mov     ecx, DWORD PTR _a$[ebp]
        cdq
        mov     ebx, edx
        mov     edx, DWORD PTR _b$[ebp]
        mov     edi, eax
        mov     esi, 200000000
$LL2@main:
; Line 28
        dec     esi
; Line 30
        mov     eax, ecx
; Line 31
        mov     ecx, edx
; Line 32
        mov     edx, eax
        jne     SHORT $LL2@main
        mov     DWORD PTR _b$[ebp], edx
        mov     DWORD PTR _a$[ebp], ecx
; Line 35
        call    _clock 
```

虽然可以说不如第二个循环“聪明”，但现代 CPU 往往用简单的代码做得最好。它在循环内也只有更少的指令（并且根本不引用循环内的内存）。无论如何，这些都不是衡量效率的唯一指标，但是通过这个简单的循环，它们具有相当的指示性。

编辑2：

只是为了好玩，我写了一个新版本，添加了三异或交换，以及一个使用 CPU`xchg`指令的版本（只是因为如果我不太关心速度等，我可能会手动编写它。 ) 尽管 Intel/AMD 通常建议不要使用更复杂的指令，但它似乎不会引起问题——它的出现速度似乎至少与其他任何指令一样快：

```
 time of for-loop(cycles) 156

 time of while-loop(cycles)  160

 time swap between register and cache  284

 time to swap using add/sub:  308

 time to swap using xchg:  155

 time to swap using triple-xor  233 
```

来源：

```
// Note: updated source -- it was just too ugly to live. Same results though.
#include<stdlib.h>
#include<time.h>
#include <iostream>
#include <string>
#include <iomanip>
#include <sstream>

namespace { 
    int a, b;
    const int loops = 200000000;
}

template <class swapper>
struct timer {
    timer(std::string const &label) { 
        clock_t t1 = clock();
        swapper()();
        clock_t t2 = clock();
        std::ostringstream buffer;
        buffer << "Time for swap using " << label;
        std::cout << std::left << std::setw(30) << buffer.str() << " = " << (t2-t1) << "\n";
    }
};

struct for_loop {
    void operator()() {
        int temp;
        for(int i=0;i<loops;i++) {
            temp=a;//instruction 1
            a=b;//instruction 2
            b=temp;//3 instructions total   
        }
    }
};

struct while_loop {
    void operator()() { 
        int j = 0;
        int temp;
        while(j<loops) {
            temp=a;//again it is three instructions
            a=b;
            b=temp; 
            j++;
        }
    }
};

struct reg_mem {
    void operator()() {
        int j=loops;//setting the count
        __asm {
            mov ecx,0       //init of loop range(0 to 200000000)
            mov edx,j
    do_it_again:    //begin to loop
            mov eax,a       //basic swap steps between cpu and mem(cache)
            mov ebx,b       
            mov b,eax       
            mov a,ebx       //four instructions total

            inc ecx         // j++
            cmp ecx,edx     //i<200000000  ?
            jb do_it_again  // end of loop block
        }
    }
};

struct add_sub {
    void operator()() { 
        int j=loops;//setting the count
        __asm {
            mov ecx,0       //init of loop range(0 to 200000000)
            mov edx,j

            mov eax,a       //getting variables to registers
            mov ebx,b

    do_it_again2:   //begin to loop

            //swapping with using only 2 variables(only in cpu)
            sub eax,ebx         //a is now a-b
            add ebx,eax         //b is now a
            sub eax,ebx         //a is now -b
            xor eax,80000000h   //a is now b and four instructions total

            inc ecx         // j++
            cmp ecx,edx     //i<200000000  ?
            jb do_it_again2  // end of loop block

            mov a, eax
            mov b, ebx
        }
    }
};

struct xchg {
    void operator()() {
        __asm {
            mov ecx, loops
            mov eax, a
            mov ebx, b
    do_it_again3:
            dec ecx
            xchg eax, ebx
            jne do_it_again3
            mov a, eax
            mov b, ebx
        }
    }
};

struct xor3 {
    void operator()() { 
        _asm { 
            mov ecx, loops
            mov eax, a
            mov edx, b
    do_swap4:
            xor eax, edx
            xor edx, eax
            xor eax, edx
            dec ecx
            jnz do_swap4

            mov a, eax
            mov b, edx
        }
    }
};

int main() {
    timer<for_loop>("for loop");
    timer<while_loop>("while loop");
    timer<reg_mem>("reg<->mem");
    timer<add_sub>("add/sub");
    timer<xchg>("xchg");
    timer<xor3>("triple xor");
    return 0;
} 
```

底线：至少对于这个微不足道的任务，你不会击败一个体面的编译器足以关心（可能根本不会，除非可能在更小的代码方面）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-17T20:15:14.077

这可能是由于编译器未能使其成为寄存器操作数，而是使用间接（地址）操作数。

**切换编译器**<--这是你最好的优化。

**更新**我经历了翻译相同程序 gcc intel inline assembly: **[test.c](https://gist.github.com/3131989#file_test.c)**的麻烦。它清楚地显示了 for 循环和 and-while 循环如何***大大优于***手写程序集。

* * *

也就是说，使用 Digital Mars，以下速度更快：

```
__asm
{
    xor ecx,j     //init of loop range(200000000 to 0)

    mov eax,a     //getting variables to registers
    mov ebx,b

do_it_again3: //begin to loop

    //swapping with xor idiom
    xor eax,ebx
    xor ebx,eax         
    xor eax,ebx         

    mov a,eax
    mov b,ebx

    dec ecx           // j--
    jnz do_it_again3  // end of loop block
} 
```

使用

*   XOR[交换习语](http://en.wikipedia.org/wiki/XOR_swap_algorithm)
*   下降循环
*   隐式比较标志（带`dec ecx`）

我对 Digital Mars Compiler 版本 8.42n 的基准测试结果为：

```
time of for-loop(cycles) 572  
time of while-loop(cycles)  566  
time of custom-loop-1(cycles)   355   
time of custom-loop-2(cycles)  317   
time of custom-loop-3(cycles)  234 
```

完整清单：

```
#include<stdio.h>
#include<stdlib.h>
#include<time.h>

int main()
{
    int j=0;

    int a=0,b=0,temp=0;

    srand(time(0));
    time_t t1=0;
    time_t t2=0;

    t1=clock();
    for(int i=0; i<200000000; i++)
    {
        temp=a;//instruction 1
        a=b;//instruction 2
        b=temp;//3 instructions total
    }
    t2=clock();
    printf("\n time of for-loop(cycles) %i  \n",(t2-t1));

    t1=clock();
    while(j<200000000)
    {
        temp=a;//again it is three instructions
        a=b;
        b=temp;
        j++;
    }
    t2=clock();
    printf("\n time of while-loop(cycles)  %i  \n",(t2-t1));

    t1=clock();
    j=200000000;//setting the count
    __asm
    {
        pushf           //backup
        push eax        //backup
        push ebx        //backup
        push ecx        //backup
        push edx        //backup

        mov ecx,0       //init of loop range(0 to 200000000)
        mov edx,j

        do_it_again:    //begin to loop

        mov eax,a       //basic swap steps between cpu and mem(cache)
        mov ebx,b
        mov b,eax
        mov a,ebx       //four instructions total

        inc ecx         // j++
        cmp ecx,edx     //i<200000000  ?
        jb do_it_again  // end of loop block

        pop edx     //rolling back to history
        pop ecx
        pop ebx
        pop eax
        popf
    }

    t2=clock();
    printf("\n time of custom-loop-1(cycles)   %i   \n",(t2-t1));

    t1=clock();
    j=200000000;//setting the count
    __asm
    {
        pushf           //backup
            push eax        
            push ebx        
            push ecx        
            push edx        

            mov ecx,0       //init of loop range(0 to 200000000)
            mov edx,j

            mov eax,a       //getting variables to registers
            mov ebx,b

            do_it_again2:   //begin to loop

            //swapping with using only 2 variables(only in cpu)
            sub eax,ebx         //a is now a-b
            add ebx,eax         //b is now a
            sub eax,ebx         //a is now -b
            xor eax,80000000h   //a is now b and four instructions total

            inc ecx         // j++
            cmp ecx,edx     //i<200000000  ?
            jb do_it_again2  // end of loop block

            pop edx         //rollback
            pop ecx         
            pop ebx         
            pop eax         
            popf            
    }

    t2=clock();
    printf("\n time of custom-loop-2(cycles)  %i   \n",(t2-t1));

    t1=clock();
    j=200000000;//setting the count
    __asm
    {
        xor ecx,j     //init of loop range(200000000 to 0)

        mov eax,a     //getting variables to registers
        mov ebx,b

    do_it_again3:   //begin to loop

        //swapping with using only 2 variables(only in cpu)
        xor eax,ebx
        xor ebx,eax         
        xor eax,ebx         

        mov a,eax
        mov b,ebx

        dec ecx         // j--
        jnz do_it_again3  // end of loop block
    }

    t2=clock();
    printf("\n time of custom-loop-3(cycles)  %i   \n",(t2-t1));

    return 0;

} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-18T01:21:56.657

我很惊讶你们中的任何人都从 C 代码中得到了零周期以外的任何东西。在这里，使用 gcc 4.6.3 和`-O2`，循环消失了，因为它没有副作用。除了 asm 块之外的所有内容都被删除。如果 Digital Mars 不能做如此微不足道的优化，我会感到惊讶；我敢打赌，您可以尝试不同的优化开关来删除 C 代码，此时这种微不足道的比较变得不可能。

您的玩具示例无法将编译器优化与手工组装进行比较。从统计上讲，编译器可以始终编写比人类更好的机器代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-17T20:00:15.573

这是正常的，改变编译器并不能解决这个“问题”。汇编程序非常低级，您可以控制一切。你的 C++ 编译器总是做的比它需要的多。调用函数会比汇编中花费更多的时间，因为编译器会保护堆栈（例如）。在循环中也是一样的：声明一个新变量需要更多时间，也可以添加值等等......

这个问题应该对更多信息感兴趣： [汇编程序何时比 C 更快？](https://stackoverflow.com/q/577554/1202769)

# java - 如何通过 java 代码确定系统上安装的 java 版本？

> ID：11529779
> 
> 赞同：0
> 
> 时间：2012-07-17T19:45:47.093
> 
> 标签：java

如何通过 java 代码确定系统上安装的 java 版本，如果不是最新的，则下载并安装所需的 jre？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T19:49:49.267

第一个问题很简单，用[`System.getProperty`](http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#getProperty%28java.lang.String%29)得到[`java.version`](http://docs.oracle.com/javase/tutorial/essential/environment/sysprop.html)：

```
System.getProperty("java.version") 
```

第二部分，我将向用户显示一个弹出对话框，并要求他从[Oracle](http://www.oracle.com/technetwork/java/javase/downloads/index.html)（或其他来源）下载最新（或所需）版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:49:34.143

如果您有 Windows，则可以使用以下脚本检查版本：

[检查默认java安装版本是否大于1.x的DOS脚本](https://stackoverflow.com/questions/3812186/dos-script-to-check-if-the-default-java-installed-version-is-greater-than-1-x)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T19:50:34.143

System.getProperty(); 允许您访问此类信息。 [http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/System.html](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/System.html) java.version 就是这样一个属性。您不能以编程方式重新安装 java 环境。你所能做的就是让用户自己做，如果你愿意，可以给他们一个下载链接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T19:51:04.430

没有必要检查 JRE 版本，因为字节码只会在 JRE 中运行，至少与编译它的版本一样新。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-17T19:52:01.850

正如 adChilds 在评论中所说，要安装当前的 java 版本，请使用 System.getProperty("java.version") 返回字符串或 null。

至于第二个问题，您可以做到这一点的一种方法是将您想要的版本的安装可执行文件与您的应用程序一起打包，然后通过代码执行它。

# ruby - ruby-1.9.3-p194/lib/ruby/1.9.1/csv.rb:1855:in `sub!': UTF-8 中的无效字节序列（ArgumentError）

> ID：11529780
> 
> 赞同：0
> 
> 时间：2012-07-17T19:45:48.950
> 
> 标签：ruby, csv, utf-8

我不确定如何调试这个......

ruby-1.9.3-p194/lib/ruby/1.9.1/csv.rb:1855:in `sub!': UTF-8 中的无效字节序列（ArgumentError）

有什么建议么？我应该先尝试转换文件吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T16:54:50.543

在文本编辑器中手动转换为 UTF-8 为我解决了这个问题。

# c++ - ISO C++ 禁止声明没有类型的“表达式”

> ID：11529781
> 
> 赞同：1
> 
> 时间：2012-07-17T19:45:51.240
> 
> 标签：c++, types, declaration, bison, flex-lexer

我正在为大学编译器学科实践编写一个小型编译器，当我尝试编译我的程序时它说：

```
In file included from lexer.l:2:
parser.y++:21: error: ISO C++ forbids declaration of ‘Expresion’ with no type
parser.y++:21: error: expected ‘;’ before ‘*’ token
make: *** [principal] Error 1 
```

在这里，我给你来自 lexer.l 文件的第 2 行：

```
#include "parser.tab.h++" 
```

和 parser.y++ 的第 21 行。

```
Expresion *exp; 
```

注意：“parser.tab.h++”是使用野牛从“parser.y++”生成的。

我正在使用 Flex 和 Bison GNU 工具来生成词汇和语法分析器。这里我给你整个 lexer.l 文件

```
%{
#include "parser.tab.h++"
int lineaComentario;
extern bool errorFlag;
#define POSICION \
    yylloc.last_line = 1; \
%}
digito                  [0-9]
letra                   [a-zA-Z]
entero                  {digito}+

%x COMENTARIO_TIPO1 COMENTARIO_TIPO2

%%
[ \t]+                  ;
\n                  { yylloc.last_line++; } 
"//"(.*)[\n]                yylloc.last_line++;     /* Comentarios de una sola linea */
program                 return PROGRAM;  
var                 return VAR;
integer                 return INTEGER;
begin                   return BEGINN;
end                 return END;
if                  return IF;
then                    return THEN;
else                    return ELSE;
while                   return WHILE;
do                  return DO;
print                   return PRINT;
({letra}|_)({letra}|{digito}|_)*    {if (yyleng > 16){printf("***ERROR,\n    el identificador : %s en linea : %d excede 16 caracteres\n",yytext,yylloc.last_line);errorFlag=true;yytext[16]='\0';};yylval.cadena=strdup(yytext);return ID;}
{entero}                {yylval.numero=atoi(yytext);if ((yyleng!=1)&&((atoi(yytext)>32767)||(yytext[0]=='0'))){printf("***ERROR,\n    el entero : %s en linea : %d esta fuera de rango u empieza con cero  \n",yytext,yylloc.last_line);};errorFlag=true; return INTLITERAL;}
"("                 return LPAREN;      
")"                 return RPAREN;
";"                 return SEMICOLON;
","                 return COMMA;
":="                    return ASSIGNOP;
"+"                 return PLUSOP;
"*"                 return MULTOP;
"-"                 return MINUSOP;
"/"                 return DIVOP;
"."                 return POINT;
":"                 return TWO_POINTS;
\"[^"\n]*\"             {yylval.cadena=strdup(yytext);return STR;}
\"[^"\n]*$                  {printf("***ERROR,\n    cadena sin cerrar en linea : %d\n",yylloc.last_line);yylloc.last_line++;errorFlag=true;}                
"(*"                        {BEGIN(COMENTARIO_TIPO1);lineaComentario=yylloc.last_line;}
"{"                         {BEGIN(COMENTARIO_TIPO2);lineaComentario=yylloc.last_line;}
[^[:alnum:]();,:+*/.{}"_\n-]+       {printf("***ERROR,\n    la siguiente secuencia de simbolos : %s en la linea : %d no ha sido reconocida :\n",yytext,yylloc.last_line);errorFlag=true;}       /* Modo panico */

<COMENTARIO_TIPO1>{
[^*]*                       ;                                   /* Cualquier cosa que no es '*' */
"*"+[^)]                ;                               /* '*' no seguida de ')'  */    
"*"+")"                         BEGIN(0);                           /* con "*)" se acaba modo comentario tipo 1 */
                                                    /* En caso de llegar al fin de fichero */ 
<<EOF>>                         {printf("***ERROR,\n    comentario sin cerrar. linea : %d \n",yylloc.last_line);errorFlag=true;yyterminate();}   
}

<COMENTARIO_TIPO2>{
[^}]*                           ;                               /* Cualquier cosa que no es '}' */
"}"                         BEGIN(0);                       /* con '}' se acaba modo comentario tipo 2 */
<<EOF>>                         {printf("***ERROR,\n    comentario sin cerrar, linea : %d \n",lineaComentario);errorFlag=true;yyterminate();}
}   

%% 
```

parser.y++ 文件

```
%{
#include <stdio.h>
#include "codigo.h"
#include"tablaSimbolos.h++"
#include <sstream>
extern bool errorFlag;
extern int yylex(void);
string intToSTR(int num);
void yyerror(char *error);
TablaSimbolos tabla;
int dir = 1;
int despl = 0;
%}

%locations

%union{
char *cadena;
int numero;
Expresion *exp;
}

%type <exp> expression term factor

%token PROGRAM LPAREN RPAREN SEMICOLON POINT VAR TWO_POINTS COMMA INTEGER ASSIGNOP IF THEN ELSE WHILE DO PRINT PLUSOP MINUSOP MULTOP DIVOP BEGINN END
%token <numero> INTLITERAL
%token <cadena> STR
%token <cadena> ID

%%

program : PROGRAM ID LPAREN RPAREN SEMICOLON declarations compound_statement POINT
          {}
;
declarations: declarations VAR identifier_list TWO_POINTS type SEMICOLON
              {}
    | 
;
identifier_list: ID {
            Simbolo *aux = tabla.buscaSimbolo($1);
            if(aux!=NULL){
                errorFlag = true; 
                printf("***ERROR, variable %s en linea : %d esta previamente declarada\n",$1,@1.last_line);
            }else{
                Simbolo *nuevo =new Simbolo($1,despl,true);
                despl+=4; 
                tabla.nuevoSimbolo(nuevo);
            }
            free($1);
        }
    | identifier_list COMMA ID{
                    Simbolo *aux = tabla.buscaSimbolo($3);
                    if(aux!=NULL){
                        errorFlag = true; 
                        printf("***ERROR, variable %s en linea : %d esta previamente declarada\n",$3,@1.last_line);
                    }else{
                        Simbolo *nuevo =new Simbolo($3,despl,true);
                        despl+=4; 
                        tabla.nuevoSimbolo(nuevo);
                    }
                    free($3);
                }
;
type : INTEGER 
       {}
;
compound_statement : BEGINN optional_statements END
                     {}
;
optional_statements : statement_list
                     {}
    | 

;
statement_list : statement
                 {}
    | statement_list SEMICOLON statement
    {}
;
statement : ID ASSIGNOP expression{
        Simbolo *aux = tabla.buscaSimbolo($1);
        if(aux==NULL){
            errorFlag = true;
            printf("***ERROR, la variable %s en linea : %d no ha sido declarada previamente \n",$1,@1.last_line);
        }
        free($1);
    } 

    | compound_statement
    {}
    | IF expression THEN statement ELSE statement
    {}
    | IF expression THEN statement
    {}
    | WHILE expression DO statement
    {}
    | PRINT print_list
    {}
;
print_list : print_item
             {}
    | print_list COMMA print_item
        {}
;
print_item : expression
             {}
    | STR{      
        Simbolo *aux = tabla.buscaSimbolo($1);
        if(aux==NULL){ // si existe y como es cadena dejar anterior
            Simbolo *nuevo =new Simbolo($1,dir,false);
            dir++;
            tabla.nuevoSimbolo(nuevo);      
        }
    }
;
expression : expression PLUSOP term
             {}
    | expression MINUSOP term
    {}
    | term
    {}
;
term : term MULTOP factor
       {}
    | term DIVOP factor
    {}
    | factor
    {$$ = $1}
;
factor : MINUSOP factor
         {
        $$ = new Expresion(""); // new Temp()
        $$->concatenar($2); 
        Cuadrupla *c = new Cuadrupla("SUB","0",$2->getResult(),$$->getResult());
        $$->concatenar(c)
    }
    | LPAREN expression RPAREN
    { $$ = $2; } // copia
    | ID{
        Simbolo *aux = tabla.buscaSimbolo($1);  
        if(aux==NULL) {
            errorFlag = true;
            printf("***ERROR, no se ha declarado la variable %s en linea : %d\n",$1,@1.last_line);
        }else
            $$ = new Expresion($1);
    }
    | INTLITERAL
    { $$ = new Expresion(intToSTR($1)); }
;

%%

string intToSTR(int num){
   stringstream ss;
   ss << num;
   return ss.str();
}

void yyerror(char *error) {
    printf("%s!\n",error);
} 
```

表达式类在文件 "codigo.h" 中声明：

```
#include <string>
#include <list>

using namespace std;

class Cuadrupla{
    private: 
        string op;
        string arg1;
        string arg2;
        string res;
    public:
        Cuadrupla(string op, string arg1, string arg2, string res);
        void toString();
        string getResult();

};

class Expresion{
    private:
        list<Cuadrupla *> codigo;   
        string result;
    public:
        string getResult();
        Expresion(string result);
        void concatenar(Expresion *exp);
        void concatenar(Cuadrupla *cuad);
        void toString();
};

class Sentencia{
    private:
        list<Cuadrupla *> codigo;   

    public:
        Sentencia();
        void concatenar(Expresion *exp);
        void concatenar(Cuadrupla *cuad);
        void concatenar(Sentencia *sent);
        void toString();            
}; 
```

和我的makefile：

```
principal: principal.c++ tablaSimbolos.c++ parser.tab.c++ lex.yy.c 
    g++ -Wno-write-strings principal.c++ tablaSimbolos.c++ parser.tab.c++ lex.yy.c -lfl -o miniPascal
parser.tab.c++ parser.tab.h++: parser.y++
    bison -d parser.y++
lex.yy.c: lexer.l
    flex lexer.l
clear: 
    rm -f lex.yy.c parser.tab.c++ parser.tab.h++ miniPascal 
```

我没有看到我以前在 JAVA 中编码的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:51:00.780

看来，你需要一个`;`后定义的联合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T02:22:26.760

我发现如果我使用我创建的类，例如 MyClass 在野牛的语法定义文件中的 %union 定义中，然后我在另一个源文件（lexer.l在我的情况下）其中 Myclass 不是定义的类型。

有两种解决方案：

*   在需要的文件中包含 MyClass.h，例如，如果我在 lexer.l 中包含grammar.tab.h，我必须在 lexer.l 中也包含 MyClass.h
*   将 %code 指令与 requires 选项一起使用：

    %code 需要{ class MyClass; }

# apache - 通配符 DNS 仅选择性工作

> ID：11529784
> 
> 赞同：0
> 
> 时间：2012-07-17T19:46:02.587
> 
> 标签：apache, dns, bind

我正在尝试设置我自己的 DNS 服务器以便能够对其进行自定义。现在，通过记录

```
*.technolobuzz.tk.          IN  A   184.153.205.110 
```

这在我做“www”时有效。甚至是随机的“不”，但如果我尝试做“博客”。在我的网络浏览器中，找不到服务器。所以，我不知道我做错了什么只让某些域工作。（我这样做是为了可以使用 Wordpress 多站点，而 .TK 不提供通配符。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:51:33.237

您使用的格式是正确的，但是您是否更新了您设置的记录的序列号？

```
example.com. 86400     IN      SOA     example.com. hostmaster.example.com. (
 >>>>>>>>>>>>>>>>>>>>>>             2005100804      ; Serial YYYYMMDDXX
                                    10800           ; Refresh
                                    3600            ; Retry
                                    3600000         ; Expire
                                    86400 )         ; minimum
                        IN      NS      ns1.example.com.
                        IN      NS      ns2.example.com.
                        IN      MX      10      mail.example.com.
                        IN      A       192.168.1.1
mail                    IN      A       192.168.1.1
ns1                     IN      A       192.168.1.1
ns2                     IN      A       10.0.0.2
*.example.com.          IN      A       192.168.1.1 
```

每次更新记录时，您还需要更新序列号，以便传播更改（即在 TTL 到期后，它知道记录已更改）。

# java - 带有韩语的 Android TTS

> ID：11529785
> 
> 赞同：0
> 
> 时间：2012-07-17T19:46:03.657
> 
> 标签：java, android, text-to-speech

似乎在 sdk 中找到的 android TTS 类不支持韩语，我有哪些选项可以使用韩语在 Android 上进行文本转语音？例如，是否有一些可以工作的 java 库？我已经搜索并没有找到解决方案，所以在此先感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T20:16:49.017

[这](https://www.ispeech.org/developers)是一个很棒的图书馆。我将它用于英语 TTS，语音非常自然和逼真。他们也有韩语。

唯一的障碍是在播放语音时屏幕上会出现一个很短的时间的小对话框，但这是确保其版权所必需的。我猜有一个选项可以通过支付他们来禁用它。如果您不介意这一点，使用起来非常方便。

# javascript - HTML 5 拖动事件

> ID：11529788
> 
> 赞同：6
> 
> 时间：2012-07-17T19:46:14.630
> 
> 标签：javascript, html, dom-events

我正在尝试在 JS 和 HTML 中构建一个可重新排序的列表。（试图在不使用 jQuery ui 的情况下做到这一点）我似乎无法弄清楚为什么在拖动列表项时只有 dragstart 和 dragend 事件会触发。任何人都知道为什么其他事件没有触发？

```
<ul>
    <li draggable="true" class="drag">1111111</li>
    <li draggable="true" class="drag">222222</li>
    <li draggable="true" class="drag">333333</li>
    <li draggable="true" class="drag">444444</li>
</ul>

<script type="text/javascript">
    var drags = document.querySelectorAll('.drag');
    [].forEach.call(drags, function(drag) {
      drag.addEventListener('dragstart', handleDragStart, false);
      drag.addEventListener('dragenter', handleDragEnter, false);
      drag.addEventListener('dragover', handleDragOver, false);
      drag.addEventListener('dragleave', handleDragLeave, false);
      drag.addEventListener('dragend', handleDragEnd, false);
    });

    function handleDragStart(e){
        console.log('handleDragStart');
    }

    function handleDragEnter(e){
        console.log('handleDragEnter');
    }

    function handleDragOver(e){
        console.log('handleDragOver');
    }

    function handleDragLeave(e){
        console.log('handleDragLeave');
    }

    function handleDragEnd(e){
        console.log('handleDragEnd');
    }
</script> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-17T22:09:02.693

正如其他人所提到的，它已经在 Chrome 中运行。在 Firefox 中，您需要设置`dataTransfer`on`dragstart`并且需要执行 an`e.preventDefault()`以使元素成为有效的放置目标。之后[一切开始工作](http://jsfiddle.net/robertc/4H4E5/)：

```
var drags = document.querySelectorAll('.drag');
[].forEach.call(drags, function(drag) {
  drag.addEventListener('dragstart', handleDragStart, false);
  drag.addEventListener('dragenter', handleDragEnter, false);
  drag.addEventListener('dragover', handleDragOver, false);
  drag.addEventListener('dragleave', handleDragLeave, false);
  drag.addEventListener('dragend', handleDragEnd, false);
  drag.addEventListener('drop', handleDragEnd, false);
});

function handleDragStart(e) {
  console.log('dragstart ' + e.target.innerText);
  e.dataTransfer.setData('text/plain', 'This text may be dragged')
}

function handleDragEnter(e) {
  console.log('dragenter ' + e.target.innerText);
  e.preventDefault();
}

function handleDragOver(e) {
  console.log('dragover ' + e.target.innerText);
  e.preventDefault();
}

function handleDragLeave(e) {
  console.log('dragleave ' + e.target.innerText);
}

function handleDragEnd(e) {
  console.log('dragend ' + e.target.innerText);
  e.preventDefault();
}
```

```
<div draggable="true" class="drag">AAAAAA</div>
<div draggable="true" class="drag">BBBBBB</div>
<div draggable="true" class="drag">CCCCCC</div>
<div draggable="true" class="drag">DDDDDD</div>
<div draggable="true" class="drag">EEEEEE</div>
```

注意：我还添加了一个`drop`处理程序，以便 Firefox 在您删除某些内容时不会尝试加载 URL。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-17T21:56:28.020

使用 IE 10 可以正常工作。

我推荐使用 jQuery UI，它非常非常简单，适用于所有浏览器：http: [//jqueryui.com/demos/sortable/](http://jqueryui.com/demos/sortable/)

# asp.net-mvc-4 - 未调用 Azure MVC4（测试版）WebApi Global.asax Session_Start？WebApi 会话状态访问？

> ID：11529790
> 
> 赞同：1
> 
> 时间：2012-07-17T19:46:14.847
> 
> 标签：asp.net-mvc-4, session-state, asp.net-web-api

我的 MVC4(beta) Azure WebRole 具有用于 WebApi 访问的控制器。这工作正常，除了一个小问题：似乎 Global.asax.cs Session_Start 仅在我访问 MVC 页面（例如 HomeController）时被调用。

场景：我的 WebApi 控制器需要访问（进行中的）会话状态存储。我访问 Start_Session 中的 Session State 对象并将其缓存以供 WebApi 控制器使用。这很好用，只要我先访问一个 MVC-Web-Page，但是如果我先访问 WebApi，我的 Session State 缓存没有初始化，但显然路由表是，所以 Global.asax 正在被访问。

在这种情况下，有关初始化或会话状态访问的任何提示？我需要在不首先访问网页的情况下访问 WebApi 控制器...

谢谢！R

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T08:38:30.497

在 Global.asax

```
public override void Init()
{
    this.PostAuthenticateRequest += MvcApplication_PostAuthenticateRequest;
    base.Init();
}

void MvcApplication_PostAuthenticateRequest(object sender, EventArgs e)
{
    System.Web.HttpContext.Current.SetSessionStateBehavior(SessionStateBehavior.Required);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T01:55:02.740

这是关于 ASP.NET -[启用会话](http://forums.asp.net/post/4847931.aspx)的论坛帖子，它显示了如何使用 PostAuthorizeRequest 方法为 WebApi 调用启用会话状态。我在 Global.asax 文件的修改下包含了代码片段，供您参考。

```
private const string _WebApiPrefix = "api";
private static string _WebApiExecutionPath = String.Format("~/{0}", _WebApiPrefix);

public static void RegisterRoutes(RouteCollection routes)
{
  routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

  routes.MapHttpRoute(
      name: "DefaultApi",
      routeTemplate: String.Format("{0}/{{controller}}/{{id}}", _WebApiPrefix),
      defaults: new { id = RouteParameter.Optional }
  );

}

protected void Application_PostAuthorizeRequest()
{
  if (IsWebApiRequest())
  {
    HttpContext.Current.SetSessionStateBehavior(SessionStateBehavior.Required);
  }
}

private static bool IsWebApiRequest()
{
  return HttpContext.Current.Request
       .AppRelativeCurrentExecutionFilePath.StartsWith(_WebApiExecutionPath);
} 
```

看起来这应该可以解决您的问题。

# django - Django HTTP_X_FORWARDED_FOR 和 Amazon ELB

> ID：11529791
> 
> 赞同：4
> 
> 时间：2012-07-17T19:46:21.807
> 
> 标签：django

我们有两个 Amazon EC2 实例，一个负载均衡器和一个 Django 应用程序。亚马逊表示，ELB 默认配置为将`X-Forwarded-For`标头发送到 Django 应用程序。

我已经打印了`request.META`，我看到没有`HTTP_X_FORWARDED_FOR`，当我这样做时`request.META.get('HTTP_X_FORWARDED_FOR')`，我没有。

是否有 django 配置（顺便说一下，我们使用的是 1.3），我必须配置或设置以便 Django 读取 Forwarded-For 标头？

谢谢，

山姆

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-20T13:21:56.007

经过进一步调查，我们发现 ELB 正在转发到 TCP 上的 443 端口，而 Apache 正在处理 SSL 证书。为了让 ELB 转发 X-Forwarded-For 标头，它应该在 HTTP 上转发，这也需要在 ELB 上而不是在 Apache 上安装 SSL 证书。希望这对其他人有帮助

# c++ - 访问回调c ++范围之外的变量

> ID：11529793
> 
> 赞同：1
> 
> 时间：2012-07-17T19:46:22.697
> 
> 标签：c++, callback, scope, static

我一直在思考静态与非静态、回调函数、函数指针等问题。我的目标是访问回调接口范围之外的结构数据。我正在尝试在我的名为 TextDetect 的课程中​​执行此操作。当我问这个问题时，我以为我走上了正轨：[使用 C 中的回调接口时避免 C++ 中的静态成员函数](https://stackoverflow.com/questions/11513071/avoiding-a-static-member-function-in-c-when-using-a-callback-interface-from-c) 但是，我仍然无法访问数据而不会丢失我最感兴趣的数据的范围。在运行时，我得到“访问冲突读取位置......”我会在下面指出它失败的地方。我将上一个问题的答案实现为以下类，完全显示（注意：vtrInitialize 是第 3 方 api 代码的一部分**int vtrInitialize(const char *inifile, vtrCallback cb, void *calldata);** ):

```
 class TextDetect {
     const char * inifile;
     vtrImage *vtrimage;
     int framecount;
 public:
     TextDetect();
     ~TextDetect();
     void vtrCB(vtrTextTrack *track);
     static void vtrCB_thunk(vtrTextTrack *track, void *calldata);
     int vtrTest(cv::Mat);
     bool DrawBox(cv::Mat&);
     vtrTextTrack *texttrack;
 };

 TextDetect::TextDetect() : inifile("vtr.ini")
 {
      if (vtrInitialize(inifile, vtrCB_thunk, static_cast<void *>(this) ) == -1) 
         std::cout << "Error: Failure to initialize" << std::endl;
         vtrimage = new vtrImage;
  }

  int TextDetect::vtrTest(cv::Mat imagetest)
  {
    /*store image data in an image structure*/
  }

   void TextDetect::vtrCB(vtrTextTrack *track)
   {
     /*send data to command line from callback */ 
```

我尝试过以多种方式复制我需要的数据，但没有任何效果（此代码是上面的延续）：

```
 //texttrack = track;
     //texttrack = new vtrTextTrack (*track);
     memcpy(texttrack,track,sizeof(*track));
     //vtrTextTrackFree(track); 

    }
  void TextDetect::vtrCB_thunk(vtrTextTrack *track, void *calldata)
  {
       static_cast<TextDetect *>(calldata)->vtrCB(track);
  } 
```

这是我想要使用数据的成员函数。Texttrack 是公共成员，因此我可能在课堂之外也需要它（此代码是上面的延续）：

```
 bool TextDetect::DrawBox(cv::Mat& tobeboxed)
  { 
```

在这行代码中，我在运行时收到了访问冲突错误（此代码是上面的延续）：

```
 if (texttrack->best->ocrconf > 90)
     {
        /*do some more stuff*/
   }
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T20:53:32.093

希望我能正确理解这一点。

在我看来，问题在于试图不正确地复制那些 vtrTextTrack 结构。这个：

```
//texttrack = track; 
```

只是复制指针。如果结构的所有者（可能是回调函数的调用者）破坏/删除了 vtrTextTrack，那么您将持有一个无效的指针。

这个：

```
memcpy(texttrack,track,sizeof(*track)); 
```

将复制 vtrTextTrack 的所有成员，但不会复制其成员指针所指向的内容（例如`texttrack->best`）。同样，如果所有者销毁/删除轨道，那么您将持有无效指针。

而且因为

```
//texttrack = new vtrTextTrack (*track); 
```

没用，我猜 vtrTextTrack 不提供复制构造函数。

至于解决方法，首先检查您的第三方库是否提供了复制这些结构的功能。如果不是这种情况（这可能是设计使然吗？），那么您可能必须自己实现一个。这可能很难，因为可能存在您不知道的各种内部结构。如果您不需要整个 vtrTextTrack，我会说定义另一个结构并仅存储您需要的信息。类似的东西

```
SomeType* bestCopier(SomeType* src)
{
     SomeType* temp;
     /* copy over struct */
     return temp;
}

Foo* fooCopier(Foo* src)
{
    /*...*/
}

struct myTextTrack 
{
public:
    myTextTrack(vtrTextTrack* src)
    {
        //copy over stuff
        m_best = bestCopier(src->best);
        m_foo = fooCopier(src->foo);
    }

private:
    /* the members you care about*/
    SomeType* m_best;
    Foo * m_foo;
} 
```

# php - 使用 ajax 在基于 mvc 的 php 应用程序的下拉列表中填充城市？

> ID：11529797
> 
> 赞同：1
> 
> 时间：2012-07-17T19:46:41.307
> 
> 标签：php, javascript, ajax, model-view-controller

在 PHP MVC 应用程序中，模型部分有一个`city.php`定义城市类的文件。

city 类有一个方法来获取一个省的所有城市，即

```
getCitiesByProvince('ProvinceId') 
```

当用户从省下拉列表中选择一个省时，我需要`getCitiesByProvince('ProvinceId')`根据用户在省下拉列表中选择的省 ID 值进行 ajax 调用。

我该怎么做呢？

编辑：1）页面使用 GET 方法而不是 POST 方法。2) 控制器文件使用 switch($action) 来执行特定案例。例如获取所有城市

```
 case 'cities': //Get all cities for  a provinceId
                $city= new city();
                $cities = $City->getCitiesByProvince('ProvinceId');
                echo json_encode($cities); 
```

动作可能是一个隐藏的 html 属性，它告诉 php 脚本要执行什么动作/案例......也许像

```
 <input type="hidden" name="action" value="cities" /> 
```

这是我目前不太熟悉的另一个开发人员的代码，我只是想通过查看各种文件来猜测事情是如何工作的......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:52:11.820

让您的 PHP 文件执行以下操作：

```
<?php
$province = $_GET['p'];

$cities = array();
$city_results = ... // fetch cities from database

foreach($city_results as $city_result) {
    $cities[] = $city_result->city;
}

echo json_encode($cities);
?> 
```

让您的 Javascript 执行以下操作：

```
$.ajax({
    type: "GET",
    url: "php_url_path",
    data: { p: get_province_here() },
    success: function (cities) {
        for (var i = 0; i < cities.length; i++) {
            ... // handle options here
        }
    }
}); 
```

这将创建您寻求的文件间连接。享受和好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T19:50:57.123

您将无法直接从模型中调用它，您需要在控制器中执行名为 getcities 或其他任何操作并使用 $.ajax 或 $.get 或 $.post 或 $.getJSON 来检索结果假设它们是 json 格式，这里有一个使用 $.post 的示例

如果你的控制器是控制器内的 citycntrl.php 你会做

//以任何你想要的格式获取城市数组的任何逻辑例如：'{zip}' => '{cityname}'，或者只是带有常规键的 {cityname}

使用 $_POST['providenceId']; 密钥是用 jQuery 发送的

你想要做的是通过 json_encode($arrayname); 运行数组。并根据providenceId post值在您的控制器中回显。

这是一个更好的代码示例，适用于您的下拉场景，我第一次误读并错过了下拉部分

```
$.post('controller/getcities', {
    provinceId: $('#{dropdownIDorCLASS}:selected').val();
}, function (data) {
    //data will contain your list of cities passed down from your controller.
    //do whatever with returned json data
}, 'json'); 
```

如果我只是把你的废话弄糊涂了，请随时通过 Skype 与我联系，我希望能更好地帮助联合国：fall.networks

# java - Java：将 ByteBuffer 复制到 byte[] 数组是性能禁忌吗？

> ID：11529801
> 
> 赞同：2
> 
> 时间：2012-07-17T19:46:48.240
> 
> 标签：java, sockets, memory, bytebuffer

基本上，我的情况是这样的：

1.  服务器将数据从客户端连接流式传输到`ByteBuffer`名为**inQueue**的对象。这包含最新的数据流
2.  服务器必须处理每个流中的数据，并期望一个特定格式的数据包
3.  数据的有效载荷将被读入一个`byte[]`对象，然后单独处理

现在我的问题归结为： ***将剩余的缓冲区数据（有效负载）复制到`byte[]`数组对性能不利吗？***

这是它的样子：

```
// pretend we're reading the packet ID and length
// int len = LENGTH OF PACKET PAYLOAD

/* 
 * Mark the starting position of the packet's payload.
 */
int pos = inQueue.position();

byte[] payload = new byte[len];
inQueue.get(payload);

// Process the packet's payload here

/*
 * Set the inQueue buffer to the length added to the previous position
 * so as to move onto the next packet to process.
 */
inQueue.position(pos + len); 
```

如您所见，我实际上是在这样做：

1.  将完整缓冲区的位置标记为就在有效负载之前
2.  将 inQueue 的内容复制到有效负载到单独的`byte[]`对象
3.  将完整缓冲区的位置设置为我们刚刚读取的有效负载之后，以便我们可以读取更多数据包

我担心的是，在这样做时，我通过复制缓冲区来浪费内存。请记住*，使用的数据包永远不会超过 500 字节，并且通常小于 100 字节*。

我的担忧是有效的，还是我表现得偏执？:p

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T04:07:26.873

你应该避免它。这就是 ByteBuffer 设计的全部原因：避免数据复制。

'在这里处理有效负载'到底是什么意思？

稍微重新安排那里发生的任何事情，您应该能够直接在 ByteBuffer 中执行此操作，`flip()`首先调用一个或多个`get()`s 来获取您需要的数据，`compact()`然后（`clear()`如果您确定它是空的），没有中间复制步骤进入另一个 byte[] 数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T20:23:18.667

这不仅没有必要，而且为了回答您的问题，即使扩大规模，您也不会注意到性能变化。

# php - 如何检查当前 PHP 会话设置或取消设置

> ID：11529805
> 
> 赞同：1
> 
> 时间：2012-07-17T19:46:58.637
> 
> 标签：php, session, login

伙计们在我的 php 项目中，我想检查登录页面会话的状态..如果它未设置，我希望用户登录。我已将此代码添加到登录页面，但它在循环时无济于事。

```
if (strlen(session_id()) < 1) {
    ?>
    <script>window.location.href="login.php";</script>  
    <?php     
}
elseif(strlen(session_id()) > 1){ 
    ?>   
    <script>window.location.href="index.php";</script>   
    <?php 
} 
```

现在我想要的另一件事是如果会话已经开始并且如果用户手动尝试从地址栏进入登录页面，他应该被重定向回当前页面。

如果他没有登录，如果他试图直接打开任何页面，他应该被重定向回登录页面。

还有一个新的疑问是我正在
使用 wamp 服务器运行我的 PHP 项目的家伙。我在我的项目中使用了 PHP 会话，现在当用户从一个项目登录时，会话被设置，如果用户打开其他项目，则在同一台电脑上它们彼此没有链接，他甚至不这样做就直接登录，如果他从一个项目注销，他会从该电脑上运行的所有其他项目注销。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-17T19:50:14.017

尝试这个：

```
<?php
    session_start();
    if(isset($_SESSION['logged_in']) && $_SESSION['logged_in'] == 1) {
        //session is set
        header('Location: /index.php');
    } else if(!isset($_SESSION['logged_in']) || (isset($_SESION['logged_in']) && $_SESSION['logged_in'] == 0)){
        //session is not set
        header('Location: /login.php');
    }
?> 
```

在回复上述评论时，是的，您应该在用户登录时创建一个会话变量。编辑代码以反映它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T19:54:41.763

你想检查一个特定的会话值，而不是一个会话的存在..

```
if ($_SESSION['logged_in']==1){

//
}else{

//
} 
```

登录时将 $_SESSION['logged_in'] 设置为 1 并在注销时取消设置（或将其设置为 0）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-28T10:42:40.387

1.  记得包含 session_start(); 在每一页的顶部通过$_SESSION['example']获取SESSION中变量SET的值，否则你将无法获取会话变量值，或者

* * *

1.  另一种方法是使用 session_start(); 在 config.php 文件中，并将该文件包含在需要会话的每个页面的代码顶部，否则 U 将无法获得 SESSION 变量的值..！！

# android - 在 Android 中从广播接收器中查找正在运行的活动

> ID：11529806
> 
> 赞同：0
> 
> 时间：2012-07-17T19:47:03.150
> 
> 标签：android

我想从我的广播接收器中找到当前正在运行的其他活动。这是我从活动中用来查找其他正在运行的活动的代码，但是当我尝试在广播接收器中使用此代码时，出现以下几行错误：

```
ActivityManager am = (ActivityManager)this.getSystemService(ACTIVITY_SERVICE); 
```

显示 eclipse 中的错误 ACTIVITY_SERVICE 无法解析为变量

```
 PackageManager pm = this.getPackageManager(); 
```

这显示了 Eclipse 中的错误 对于 ScreenReceiver 类型（我的广播接收器），方法 getPackageManager() 未定义

这是完整的代码：

```
public void getRunning(){
        ActivityManager am = (ActivityManager)this.getSystemService(ACTIVITY_SERVICE);
        List l = am.getRunningAppProcesses();
        Iterator i = l.iterator();
        PackageManager pm = this.getPackageManager();
        while(i.hasNext()) {
          ActivityManager.RunningAppProcessInfo info = (ActivityManager.RunningAppProcessInfo)(i.next());
          try {
            CharSequence c = pm.getApplicationLabel(pm.getApplicationInfo(info.processName, PackageManager.GET_META_DATA));
            Log.w("LABEL", c.toString());
            runningApplications.add(c.toString());
          }catch(Exception e) {
            //Name Not Found Exception
          }
        }

    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T19:56:53.907

由于 BroadcastReceiver 不会从 Context 下降，因此您不能像在 Activity 中那样使用**this 。**您应该使用传递给 onReceive() 方法的 Context 实例。

```
public void getRunning(Context context){
        ActivityManager am = (ActivityManager)context.getSystemService(Context.ACTIVITY_SERVICE);
        List l = am.getRunningAppProcesses();
        Iterator i = l.iterator();
        PackageManager pm = context.getPackageManager();
        while(i.hasNext()) {
          ActivityManager.RunningAppProcessInfo info = (ActivityManager.RunningAppProcessInfo)(i.next());
          try {
            CharSequence c = pm.getApplicationLabel(pm.getApplicationInfo(info.processName, PackageManager.GET_META_DATA));
            Log.w("LABEL", c.toString());
            runningApplications.add(c.toString());
          }catch(Exception e) {
            //Name Not Found Exception
          }
        }

    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T19:52:58.813

尝试：

```
public class ScreenReceiver  extends BroadcastReceiver {
private Context ctext;
    @Override
    public void onReceive(Context context, Intent intent) {
      ctext=context;
         //OR you can also pass context as param to  getRunning()
      //your code here....
    }
public void getRunning(){
        ActivityManager am = (ActivityManager)ctext.getSystemService(Context.ACTIVITY_SERVICE);
        List l = am.getRunningAppProcesses();
        Iterator i = l.iterator();
        PackageManager pm = ctext.getPackageManager();
        while(i.hasNext()) {
          ActivityManager.RunningAppProcessInfo info = (ActivityManager.RunningAppProcessInfo)(i.next());
          try {
            CharSequence c = pm.getApplicationLabel(pm.getApplicationInfo(info.processName, PackageManager.GET_META_DATA));
            Log.w("LABEL", c.toString());
            runningApplications.add(c.toString());
          }catch(Exception e) {
            //Name Not Found Exception
          }
        }

    }

} 
```

# iphone - DetailView 只显示 Tableview 的一项

> ID：11529814
> 
> 赞同：1
> 
> 时间：2012-07-17T19:47:29.940
> 
> 标签：iphone, ios, xcode, tableview, master-detail

我在 Xcode 中有一个主从应用程序，带有一个 TableView 和一个 SearchDisplayController。
在 TableView 我有一个 NSArray 有 10 个条目。
如果我使用搜索栏，DetailView 会正确显示我单击的条目。
但是，如果我不使用搜索栏并在 TableView 中单击一个条目，那么 DetailView 每次都会向我显示 TableView 的第一个条目。
我能做些什么来修复它？

MasterViewController.m：http: [//i.imgur.com/ZS1Oe.png](http://i.imgur.com/ZS1Oe.png)

MasterViewController.h：

```
#import <UIKit/UIKit.h>  
@interface DPMasterViewController : UITableViewController  
@property (nonatomic, strong) IBOutlet UITableView *tableView;  
@end 
```

DetailViewController.m：http: [//i.imgur.com/AkVJ8.png](http://i.imgur.com/AkVJ8.png)

DetailViewController.h：

```
#import <UIKit/UIKit.h>  
@interface DPDetailViewController : UIViewController  
@property (strong, nonatomic) id detailItem;  
@property (strong, nonatomic) IBOutlet UILabel *detailDescriptionLabel;  
@end 
```

对不起，我使用了图片，但我认为您更容易检查。:)
我希望你能帮助我！
如果有什么遗漏，请告诉我。

编辑：

在此方法中，每次 indexPath.row = 0 时都在 else 之后。我不知道如何解决它:(

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
if ([segue.identifier isEqualToString:@"showDetail"]) {
    DPDetailViewController *destViewController = segue.destinationViewController;

    NSIndexPath *indexPath = nil;

    if ([self.searchDisplayController isActive]) { 
        indexPath = [self.searchDisplayController.searchResultsTableView indexPathForSelectedRow];
        destViewController.detailItem = [searchItemList objectAtIndex:indexPath.row];
    } else {
        indexPath = [self.tableView indexPathForSelectedRow];
        destViewController.detailItem = [itemList objectAtIndex:indexPath.row];

    }
  }    
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T20:10:56.947

当您单击不属于 searchDisplayController 的 tableView 的单元格时，您似乎没有执行任何操作，因此请尝试将您的 tableView:didSelectRowAtIndexPath: 方法更改为

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    [self performSegueWithIdentifier:@"showDetail" sender:self];
} 
```

# vb.net - 如何在 VB.NET 模块中调用方法

> ID：11529820
> 
> 赞同：0
> 
> 时间：2012-07-17T19:47:48.403
> 
> 标签：vb.net

我有以下 VB.NET 代码：

```
Namespace Data 
    Public Module Part
        Public function IsValidPart() 
        End Function
    End Module
End NameSpace 
```

现在，如何调用模块`IsValidPart`中的方法`Part`？当我尝试调用该方法时，出现以下错误：

> 'MyCompany.Lender.Data.Part' 的类型初始化程序引发了异常。---> System.NullReferenceException：对象引用未设置为对象的实例..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T20:16:05.523

问题代码不在您的代码段中。它是由模块中的变量初始化引起的。此类问题的一个简单示例是：

```
Module Module1
    Public Example As String = Nothing.ToString()

    Sub Main()
    End Sub
End Module 
```

当模块的静态构造函数运行时，您会得到一个非描述性的 TypeInitializationException。这是编译器生成的代码，以确保*Example*变量被初始化。不幸的是，调试器没有为此显示一个好的诊断。

您可以使用 Debug + Exceptions 找到问题陈述，勾选 CLR exceptions 的 Throw 框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:50:02.717

就像您调用静态/共享方法一样：

```
Part.IsValidPart() 
```

模块中的所有成员都是共享/静态的。

> 我收到以下错误：“MyCompany.Lender.Data.Part”的类型初始化程序

**编辑**：

您`Sub New`的模块中有一个抛出空引用异常：

```
Sub New()
    'An exception is being thrown somewhere in here
End Sub 
```

修复您的异常，如果您在附加调试器的情况下运行，您可以获得更多详细信息。

# web-services - 使用 API 创建 Magento 管理员用户

> ID：11529821
> 
> 赞同：1
> 
> 时间：2012-07-17T19:47:54.630
> 
> 标签：web-services, magento, soap

我想使用 Web 服务为 Magento 商店创建一个管理员用户，而不必从管理员网站创建它。那可能吗？？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T15:01:25.480

查看这个项目：[https](https://github.com/nvahalik/Wiz) ://github.com/nvahalik/Wiz 。

Wiz 可让您从命令行执行许多繁琐的任务（通常在 Magento 管理面板中完成）。虽然它不是网络服务，但它允许您跳过登录管理面板并点击周围的需要。

顺便说一句，其中一项任务是创建管理员用户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T16:19:51.200

**第一步**

将新用户绑定到预定义角色。API 的角色必须先在 System → Web Services → Roles 中创建，然后才能在此处分配。

[资源](http://www.magentocommerce.com/api/soap/introduction.html)

* * *

**第二步**

使用 SOAP v1/v2 或 XML-RPC（在我的例子中是 SOAP v1）

这是 [教程](http://www.magentocommerce.com/wiki/modules_reference/english/mage_adminhtml/api_user/index)链接。您可以管理客户，直到管理订单。

希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T17:40:06.087

我找到了它，因为我试图在 C# 中完成所有这些操作，所以这里是执行此操作的简单代码：

```
 MagentoService proxy = new MagentoService();
            string sessionId = proxy.login(username, password);
            customerCustomerEntityToCreate ctc = new customerCustomerEntityToCreate();

            ctc.email = email;
            ctc.firstname = firstname;
            ctc.lastname = lastname;
            ctc.password = password;

            proxy.customerCustomerCreate(sessionId, ctc); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T15:57:40.687

一种需要一些自定义编码的方法是创建一个新的 API 资源，该资源可以使用该`Mage::getModel('admin/user')`模型来创建管理员用户。

# network-programming - 获取糕点覆盖中的节点列表

> ID：11529825
> 
> 赞同：0
> 
> 时间：2012-07-17T19:48:07.397
> 
> 标签：network-programming, dht

请问，我怎样才能得到糕点覆盖中的节点列表？那可能吗 ？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T13:36:27.223

我不相信直接获得糕点覆盖中所有节点的列表。并非所有节点都知道覆盖中的每个节点。然而，他们确实知道他们的叶子集中的节点。可以使用以下方法找到叶子集：node.getLeafSet()

我已经完成了一些关于糕点的阅读，通常似乎不需要检查网络中的所有节点。如果您想出于测试目的查看此内容，即节点已成功进入覆盖层，只需使用 .getLeafSet()

# mysql - Perl 与 inet_aton

> ID：11529830
> 
> 赞同：0
> 
> 时间：2012-07-17T19:48:37.580
> 
> 标签：mysql, perl, inet

我的脚本是：

```
foreach (@missing) {
    my $ipdone = $_;
    $sth = $dbh->prepare("UPDATE tbl_ips SET searched=\'1\' WHERE ip = '$ipdone'");
    $sth->execute();
} 
```

现在我们在 mysql 中更改了 ip，所以它是 inet_aton 格式，所以我们想：

```
("UPDATE tbl_ips SET searched=\'1\' WHERE ip = inet_aton('$ipdone')"); 
```

但我不能让它工作。

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T20:07:40.897

“不能让它工作”是什么样的？怎么了？

我能想到的一件事可能会使原始查询有效，但如果`$ipdone`有尾随空格，则替换无效；这些将在`ip = '$ipdone'`选择的内容中被忽略，但会导致 mysql 的 inet_aton 返回 NULL。

# deployment - 启动 EJB3 服务 JBOSS 时出错，org.omg.CosNaming.NamingContextPackage.InvalidName：IDL:omg.org/CosNaming/NamingContext/InvalidName:1.0

> ID：11529831
> 
> 赞同：0
> 
> 时间：2012-07-17T19:48:46.717
> 
> 标签：deployment, jboss, ejb-3.0, ejb-2.x

我有一个使用 EJB2 接口的 EJB3，它在我的本地开发实例上部署得很好。但是，尝试将其部署在工作中的其中一台服务器上时，出现以下异常。

**[org.jboss.kernel.plugins.dependency.AbstractKernelController] 安装到开始时出错：name=jboss.j2ee:ear=myear.ear,jar=myejb.jar,name=myejb,service=EJB3_IORFactory state=Create org.omg。 CosNaming.NamingContextPackage.InvalidName: IDL:omg.org/CosNaming/NamingContext/InvalidName:1.0 at org.omg.CosNaming.NamingContextPackage.InvalidNameHelper.read(InvalidNameHelper.java:60) at org.omg.CosNaming._NamingContextExtStub.to_name(_NamingContextExtStub .java:86)**

虽然我看到当我打开 jmx-console 时，我可以看到 EJB 已部署并且里面的所有操作都在工作。关于可能导致这种情况的任何想法？

我正在使用 JBossEAP 5.1.1

# magento - Magento - 按数组保持顺序的集合过滤器

> ID：11529833
> 
> 赞同：7
> 
> 时间：2012-07-17T19:48:54.997
> 
> 标签：magento

是否可以使用 id 数组过滤 Magento 集合，**但**集合结果按传递给过滤器的 id 顺序排序。

例如：

```
$collection = Mage::getModel('catalog/product')
                  ->getCollection()
                  ->addAttributeToFilter('entity_id', array(
                       'in' => array(1, 3, 2),
                   )); 
```

我希望集合中的产品按顺序排列，1、3、2，以便在循环浏览集合时它们以特定顺序出现？

我目前唯一的选择是手动创建一系列产品：

```
$productIds = array(1,3,2);
$collection = array();

foreach($productIds as $productId) {
    $collection[] = Mage::getModel('catalog/product')->load($productId);
} 
```

这显然有效，但似乎是一种丑陋的方法。

有没有办法纯粹通过 magento 收藏来做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-23T11:48:33.577

```
$productIds = array(1,3,2);

/**
 * Build up a case statement to ensure the order of ids is preserved
 */
$orderString = array('CASE e.entity_id');
foreach($productIds as $i => $productId) {
    $orderString[] = 'WHEN '.$productId.' THEN '.$i;
}
$orderString[] = 'END';
$orderString = implode(' ', $orderString);

/**
 * Filter the collection
 */
$productCollection = Mage::getModel('catalog/product')->getCollection()
    ->addAttributeToFilter('entity_id', array('in' => $productIds));

/**
 * Apply the order based on the case statement
 */
$productCollection->getSelect()
    ->order(new Zend_Db_Expr($orderString)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-03-29T15:21:24.873

我在stackoverflow上找到的一个很旧但简单的解决方案是

```
$productIds = array(1,3,2);
$products = Mage::getModel('catalog/product')->getCollection()
            ->addAttributeToFilter('entity_id', array('in' => $productIds));
$products->getSelect()->order("find_in_set(entity_id,'".implode(',',$productIds)."')"); 
```

[从这里开始stackoverflow](https://stackoverflow.com/a/13179933/3713817)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T07:44:11.010

您可以在 PHP 中对其进行排序之前加载该集合。例如：

```
$result = array();
$productIds = array(1,3,2);
$collection = Mage::getModel('catalog/product')
    ->getCollection()
    ->addAttributeToFilter('entity_id', array('in' => $productIds))
    ->load();

foreach ($productIds as $productId) {
    if ($product = $collection->getItemById($productId)) {
        $result[$productId] = $product;
    }
} 
```

否则，纯粹使用集合，您应该首先通过`Zend_Db_Select`集合的对象，以便能够对表达式进行排序（例如，基于 EAV 的集合和对`addAttributeToSort`or的调用可能无法做到这一点`sortOrder`）。
然后，您可以`order`按照 Gershon 的回答中所述使用多个调用，也可以将单个调用`order`与生成的`CASE WHEN THEN`语句一起使用。知道这可能取决于您可能必须过滤的最大 ID 数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T21:39:15.230

这是一个具有挑战性的问题，这是一个应该可行的解决方案：

```
$collection = Mage::getModel('catalog/product')
                  ->getCollection()
                  ->addAttributeToFilter('entity_id', array(
                       'in' => array(1928, 1930, 1929),
                   ))
           ->addAttributeToSort('entity_id = 1928', 'ASC')
           ->addAttributeToSort('entity_id = 1930', 'ASC')
           ->addAttributeToSort('entity_id = 1929', 'ASC')
           ; 
```

# java - 2 个给定日期之间的天数

> ID：11529836
> 
> 赞同：4
> 
> 时间：2012-07-17T19:49:15.333
> 
> 标签：java, algorithm, date

我被分配了一项任务来计算 2 个给定日期之间的天数，并发现输入行 3 的结果非常奇怪（2127 天），这似乎是正确的，但该任务预期的给定输出是不同的结果（1979天）。我看过这篇文章[计算两个日期之间的天数](https://stackoverflow.com/questions/7103064/calculate-the-number-of-days-between-two-dates)以及这里的其他几篇文章，并按照建议使用 Joda 库，得到 2127 天的结果。

*问题：给定两个日期（包括 1901 年和 2999 年），求两个日期之间的天数。

输入：六组数据。每组有两个日期，格式为月、日、年。例如，输入行 '6, 2, 1983, 6, 22, 1983' 表示 1983 年 6 月 2 日至 1983 年 6 月 22 日。

输出：给定日期之间的天数，不包括开始日期和结束日期。例如，从 1983 年 6 月 2 日到 1983 年 6 月 22 日有 19 天；即 6 月 3 日、4 日、...、21 日。

样本输入（3 组）：

```
 Input Line #1:  6, 2, 1983, 6, 22, 1983
 Output #1:  19

Input Line #2:  7, 4, 1984, 12, 25, 1984
 Output #2:  173

 Input Line #3:  1, 3, 1989, 3, 8, 1983
 Output #3:  1979 
```

这是我的解决方案

```
private boolean isYearValid(int year){
    return year >=1901 && year <= 2999;
}

public int numOfDays(String dates){
    Calendar date1 = new GregorianCalendar();
    Calendar date2 = new GregorianCalendar();
    String [] dateSplit = dates.split(",");
    int len = dateSplit.length;
    int year = 0;
    for(int i=0;i<len;i++){
        dateSplit[i]=dateSplit[i].trim();
        if(i==2||i==5){
            try {
                year = Integer.parseInt(dateSplit[i]);
            }
            catch (NumberFormatException e){
                throw new IllegalArgumentException(String.format("Usage: Year input %s is not valid",dateSplit[i]));
            }
            if(!isYearValid(year))
                throw new IllegalArgumentException("Usage: Year of date should be between the years 1901 and 2999, inclusive");
        }
    }
    int [] d = new int[6];

    for(int i=0;i<6;i++)
        try {
            d[i]=Integer.parseInt(dateSplit[i]);
        }
    catch(NumberFormatException e){
        throw new IllegalArgumentException("Usage: Date entered is not valid");
    }
    date1.set(d[2], d[0],d[1]);
    date2.set(d[5], d[3], d[4]);
    long milli1= date1.getTimeInMillis();
    long milli2 = date2.getTimeInMillis();
    long diff;
    if(milli1>milli2){
        diff = milli1 - milli2;
    }
    else{
        diff = milli2 - milli1;
    }
    return (int) (diff / (24 * 60 * 60 * 1000))-1;
} 
```

已解决 - 似乎测试数据是错误的，因为`1, 3, 1989, 8, 3, 1983`产生了 1979 天。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T19:55:23.933

您的测试数据不正确。请参阅：[http](http://www.timeanddate.com/date/durationresult.html?d1=08&m1=03&y1=1983&d2=3&m2=1&y2=1989) ://www.timeanddate.com/date/durationresult.html 。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T20:44:57.003

出于好奇，这是作业吗？如果没有，为什么不直接使用 Joda-Time 库来为你做这件事。它负责处理月份的长度、闰年等......

```
 DateTime dt1 = ...;
    DateTime dt2 = ...;
    Duration duration = new Duration(dt1, dt2);
    long days = duration.getStandardDays(); 
```

# objective-c - 任务完成时的表视图复选标记

> ID：11529839
> 
> 赞同：0
> 
> 时间：2012-07-17T19:49:24.657
> 
> 标签：objective-c, tableview, checkmark

我在 Objective C 中工作。我有一个 UITableViewController，它有大约 25 个单元格推送到 UIViewController。当用户回击时，我想查看用户是否为给定单元格输入了正确的数据。（我有一个工作 bool ，我们现在称之为`isCellComplete`）。如果 isCellComplete 为真，我想添加一个复选标记作为单元格的附件。我一直在尝试进行测试，`cellForRowAtIndexPath`但是每次出现视图时该方法似乎都不会运行并刷新单元格。有人有建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T21:52:18.947

你应该看看`UITableView`方法`reloadRowsAtIndexPaths:withRowAnimation:`。这比重新加载整个表格视图要优雅得多。如果你不想要动画，你可以指定`UITableViewRowAnimationNone`它看起来就像`reloadData`但效率更高。

您应该进行检查`tableView:cellForRowAtIndexPath:`，如果检查通过，请将电池的附件设置为`UITableViewCellAccessoryCheckmark`. 然后，当您告诉表视图重新加载适当的行时，它会自动调用`tableView:cellForRowAtIndexPath:`数据源并更新该单元格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:53:48.097

你可以打电话

```
[self.tableView reloadData]; 
```

在

```
-(void) viewWillAppear:(BOOL)animated 
```

`cellForRowAtIndexPath`当视图出现时，这将再次调用

# svg - 将 D3.js 移植到其他语言

> ID：11529850
> 
> 赞同：9
> 
> 时间：2012-07-17T19:50:33.567
> 
> 标签：svg, visualization, d3.js

我希望在 c++ 应用程序中使用 D3.js，由于各种原因，使用 js 是不可行的。

代码中依赖 js/svg/css 的哪些元素不容易被 c++ 库中的 svg/vector 类型绘图函数替换。

我在哪里可能遇到困难？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-22T17:34:33.687

正如一些人评论的那样，除了 D3 之外，它还依赖于 Javascript 的一些特性（不仅在语法上，而且在语言本身的性质方面更是如此）——它还依赖于 DOM 和一些解释 SVG 标记的方法—— - 所有这些都包含在浏览器环境中。

您是否考虑过[R 编程语言](http://www.r-project.org/)？我一直认为 D3 填补的空白之一是提供一些与 R 相同的数据驱动的可视化方法，但仅在浏览器环境中。

现在 - 这并不是说 R 可以做 D3 可以做的所有事情，反之亦然 - 但就可视化而言，有很多重叠，具体取决于您的需求性质 - R 可能正是您正在寻找的为了。如果是这样的话，有一个很棒的库叫做[RInside](http://dirk.eddelbuettel.com/code/rinside.html)和另一个叫做[rcpp](http://dirk.eddelbuettel.com/code/rcpp.html)的库，旨在提供 R 中的 C++ 和 C++ 中的 R 的集成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-27T23:30:21.683

javascript 很容易在 C++ 中移植……不要让普通人告诉你。Clipp 可以解析 javascript ，所以你甚至不需要完全移植 D3.js。

人们混淆了函数式编程和 C++ 语法，你可以涵盖 C++ 中所有类型的编码风格（无论是 Spirit、Phoenix、boost:lambda、表达性或远程动态库）。

# css - 如何使用 SVG 图像作为背景？

> ID：11529857
> 
> 赞同：12
> 
> 时间：2012-07-17T19:50:56.903
> 
> 标签：css, html, svg

我一定做错了什么。该图像是从 illustrator 导出为 SVG 并且（我不确定这是否相关）它确实有一些像素数据。 [这是我的 JSFiddle 示例](http://jsfiddle.net/wdW2K/)。

请注意，直接转到图像，它显示得很好：http://ykcreations.com/tv.svg

* * *

**编辑：这在 Chrome 或 Safari 中不起作用，但在 Firefox 中起作用。Webkit 问题？**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-17T20:38:37.110

您的源 SVG 有问题。请参阅此更新的 Fiddle 指向正常工作[的不同 SVG 文件](http://phrogz.net/svg/800x800.svg)：http : [//jsfiddle.net/wdW2K/2/](http://jsfiddle.net/wdW2K/2/)

```
.tv {
  background: url("http://phrogz.net/svg/800x800.svg");
  width: 400px; height: 400px;
}​ 
```

**编辑**：具体来说，问题*似乎*是 WebKit 不支持`<image>`用作背景的 SVG。最低限度地修改您的文件以将 更改`<image>`为引用本地（非数据uri）文件，并添加 a `<circle/>`，当直接在 Chrome 中查看 SVG 时，我能够同时看到图像和圆圈，但仅在用作背景图像时圆圈是可见的。

[这个错误](https://lists.webkit.org/pipermail/webkit-unassigned/2011-February/290645.html)闻起来很相关。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T20:38:14.183

它与您的图像有关，请尝试将以下内容插入您的`CSS`：

```
.tv
{
    background-image: url("http://croczilla.com/bits_and_pieces/svg/samples/butterfly/butterfly.svg");
    width: 400px;
    height: 400px;
}​ 
```

也许你`SVG`实际上是一个`SVGZ`？ `SVGZ`文件是文件的压缩版本`SVG`。通常你必须配置你的服务器来处理它，但 FF 可能只能处理压缩版本。

**编辑** 请参阅下面的 Phrogz 的答案（在您阅读本文时可能在上面）；它涵盖了这一点并给出了更好的解释。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-20T23:52:12.133

另一个可能的原因是使用错误的 MIME 类型为 SVG 提供服务。将其设置为 'image/svg+xml' 可能会解决此问题。

在 Rails 中，这可以通过将以下内容添加到 config/initializers/mime_types.rb 来完成：

`Mime::Type.register 'image/svg+xml', :svg`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-19T06:43:53.677

我在 Chrome 中将 svg 渲染为背景图像时遇到了类似的问题，但在 Firefox 中一切都很好。我发现从 Adob​​e 导出的 svg 文件中存在语法错误：

错误的 xlink 属性：

```
xlink:href="data:img/png;base64 
```

正确的 xlink 属性：

```
xlink:href="data:image/png;base64 
```

文章如下：

[链接到帮助我的 css-trick 文章](https://css-tricks.com/forums/topic/svg-css-background-image-not-showing-in-chrome/)

# arrays - ivar 在 ARC 下发布 - 我如何保留它以用于另一种方法？

> ID：11529863
> 
> 赞同：1
> 
> 时间：2012-07-17T19:51:14.267
> 
> 标签：arrays, uitableview, ivar, twrequest

几个星期以来，我一直在为某些事情苦苦挣扎，这让我的进步真正停滞不前。我已经在 SO 上问了几次问题，人们一直很有帮助，但没有人破解我做错了什么。这似乎是一件相当简单的事情，所以希望有人在那里有一个灯泡时刻并解决这个问题。我正在实现一个 TWRequest，结果在字典中返回，我正在循环遍历结果以提取推文的一部分并创建这些“文本”组件的数组。直接通过循环我正在打印数组的日志 - _twitterText 并且它打印得很好。在这个方法完成之后，看起来好像 _twitterText 正在被转储。我在我的 .h 文件中将它创建为一个强大的属性，并在 viewdidload 中创建了一个 ivar。仍然没有喜悦。**如何保留此数组以在另一个方法中使用？** 这是我的 .h 文件....

```
#import <UIKit/UIKit.h>
#import <CoreLocation/CoreLocation.h>
#import "CustomCell.h"
#import "AppDelegate.h"
#import <Twitter/Twitter.h>

@interface MyViewController : UITableViewController <CLLocationManagerDelegate>
{
    CLLocationManager *here;
}

@property(strong) NSDictionary *dict;
@property(strong) CLLocationManager *here;
@property (strong, nonatomic) NSMutableArray *twitterText;

- (void)fetchTweets;

@end </p> 
```

这是我的 .m 实现文件......

```
#import "MyViewController.h"

@interface MyViewController ()

@end

@implementation MyViewController
@synthesize dict;
@synthesize twitterText = _twitterText;

- (id)initWithStyle:(UITableViewStyle)style
{
    self = [super initWithStyle:style];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    _twitterText = [[NSMutableArray alloc] init];

    here = [[CLLocationManager alloc] init];
    here.delegate = self;
    [here startUpdatingLocation];

    AppDelegate *delegate = (AppDelegate*)[[UIApplication sharedApplication]delegate];

    NSLog(@"phrase carried over is %@", delegate.a);

    [self fetchTweets];

}

- (void)fetchTweets
{
    TWRequest *request = [[TWRequest alloc] initWithURL:[NSURL URLWithString:
                                                         @"http://search.twitter.com/search.json?q=%40wimbledon"] 
                                             parameters:nil requestMethod:TWRequestMethodGET];

    [request performRequestWithHandler:^(NSData *responseData, NSHTTPURLResponse *urlResponse, NSError *error)
     {
         if ([urlResponse statusCode] == 200) 
         {
             // The response from Twitter is in JSON format
             // Move the response into a dictionary and print
             NSError *error;        
             NSDictionary *dict = [NSJSONSerialization JSONObjectWithData:responseData options:0 error:&error];
             //NSLog(@"Twitter response: %@", dict);

             NSArray *results = [dict objectForKey:@"results"];

             //Loop through the results
 for (NSDictionary *tweet in results) {
                 // Get the tweet
                 NSString *twittext = [tweet objectForKey:@"text"];

                 // Save the tweet to the twitterText array
                 [_twitterText addObject:twittext];
             }

             NSLog(@"MY ************************TWITTERTEXT************** %@", _twitterText);

         }

         else
             NSLog(@"Twitter error, HTTP response: %i", [urlResponse statusCode]);
     }];

}
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
#warning Potentially incomplete method implementation.
    // Return the number of sections.
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
#warning Incomplete method implementation.
    // Return the number of rows in the section.
    return 5;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"MyCell";
    CustomCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    // Configure the cell...
   //cell.venueDetails.text = [_twitterText objectAtIndex:indexPath.row]; 
   NSLog(@"MY ************************OTHER BIT THAT WONT PRINT************** %@", _twitterText);
    return cell;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T20:49:22.320

所以这里的问题是，在网络连接完成并且服务器响应您的请求之前，您传递给的完成处理程序`-[TWTweet performRequestWithHandler:]`不会（不能）触发。这可能需要数百毫秒甚至几秒钟才能完成。（或者它可能永远不会发生）。

同时，当这种情况发生时，UITableView 想要自己绘制，因此会询问您有多少个部分/行，然后会要求您为每一行提供一个单元格。因此，当表格视图询问时，您应该返回当时必须绘制的实际行**数**：

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    // Return the number of rows in the section.
    return [self.twitterText count]; // the actual number of rows we have right now
} 
```

因此，您需要的下一步是在您的数据实际来自服务器时重新加载表。这将提示您的表格视图再次询问部分和行的数量，然后询问每个部分和行的单元格。因此，在您处理完所有数据后，您需要在完成块中的某个位置执行以下操作：

```
dispatch_async(dispatch_get_main_queue(), ^{

  // you'll need an outlet to the UITableView
  // here I assume you call that 'tableView'
  // then just ask it to reload on the main thread

  [self.tableView reloadData];

}); 
```

我希望这有帮助吗？

# asp.net-mvc-3 - SignalR 0.5.2 - Context.User 在断开连接时为空

> ID：11529866
> 
> 赞同：3
> 
> 时间：2012-07-17T19:51:45.653
> 
> 标签：asp.net-mvc-3, signalr

我最近在我的 ASP.NET MVC3 应用程序中从 0.4.0 更新到 SignalR 0.5.2。在 SignalR 0.5.2 中，Context 实例上的“用户”属性是`null`用户断开连接时 - 这是设计使然吗？

从下面的“立即窗口”快照中可以看出，我所知道的关于`Context`客户端断开连接的时间是断开连接的客户端的 ConnectionId。

```
Context
{SignalR.Hubs.HubCallerContext}
    ConnectionId: "... some connection id ..."
    Headers: null
    QueryString: null
    RequestCookies: null
    ServerVariables: null
    User: null 
```

简化后，我的 SignalR`Hub`实现如下所示：

```
public class MyHub : Hub, IDisconnect, IConnected
{
    // some other code

    public Task Disconnect()
    {
        var user = Context.User; // <-- This is null
        // more code
    }
} 
```

总而言之 - 我在这里忘记了什么还是 Context.User 是设计使然`null`？如果是这样 - 为什么？:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-18T16:53:17.003

我在 SignalR wiki 中找到了答案。在其关于集线器的部分（[https://github.com/SignalR/SignalR/wiki/Hubs](https://github.com/SignalR/SignalR/wiki/Hubs)）中指出：

> 每当客户端断开连接时，将在所有实现 IDisconnect 的集线器上调用 Disconnect 方法。调用此方法时，您可以使用 Context.ConnectionId 访问断开连接的客户端。 **注意：此方法是从服务器调用的，这意味着 Caller 对象上的状态、连接中的任何状态以及 HubContext 的用户和 Cookie 都不会被填充。**

# ruby-on-rails - ActiveRecord 回调列表

> ID：11529867
> 
> 赞同：37
> 
> 时间：2012-07-17T19:51:50.970
> 
> 标签：ruby-on-rails, activerecord, callback

我已经浏览了 Rails 源代码一段时间了，我认为除了以下之外没有更好的方法来获取*所有*回调的列表：`ActiveRecord::Callbacks::CALLBACKS`- 这是一个常量列表。

这意味着如果您使用的是像 devise_invitable 这样的 gem，它添加了一个`:invitation_accepted`用分数调用的新回调`:after`，`:before`然后`ActiveRecord::Callbacks::CALLBACKS`将不起作用。

除了打开 rails 模块并确保每个模型类都有一个内部回调列表之外，您是否知道一个简单的修复方法？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-01-15T09:33:58.863

您可以调用`Model._save_callbacks`以获取保存时所有回调的列表。然后，您可以将其过滤为您需要的类型，例如`:before`或`:after`像这样：

```
Model._save_callbacks.select {|cb| cb.kind == :before} 
```

`Model._destroy_callbacks`对等工作相同。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-12-18T08:29:48.987

[文档](http://api.rubyonrails.org/classes/ActiveRecord/Callbacks.html)说“总共有 19 个回调”......但他们似乎并没有说出这 19 个究竟是什么！

对于那些像我一样在 Google 上搜索“所有 ActiveRecord 回调列表”的人，这里是列表（通过使用`ActiveRecord::Callbacks::CALLBACKS`问题中的描述找到）：

```
:after_initialize
:after_find
:after_touch
:before_validation
:after_validation
:before_save
:around_save
:after_save
:before_create
:around_create
:after_create
:before_update
:around_update
:after_update
:before_destroy
:around_destroy
:after_destroy
:after_commit
:after_rollback 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-09-25T15:49:14.557

请注意，如果您只是想触发回调，则可以使用该`#run_callbacks(kind)`方法：

```
o = Order.find 123 # Created with SQL
o.run_callbacks(:create)
o.run_callbacks(:save)
o.run_callbacks(:commit) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-12-24T18:12:37.003

如果您在该`._save_callbacks`方法之前的 Rails 版本中工作，则可以使用以下内容：

```
# list of callback_chain methods that return a CallbackChain
Model.methods.select { |m| m.to_s.include? "callback" }.sort

# get all methods in specific call back chain, like after_save
Model.after_save_callback_chain.collect(&:method) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-11-30T20:28:28.940

我将提出最通用的解决方案。

即使 gem 声明自定义回调（例如[偏执狂](https://github.com/rubysherpas/paranoia)和`after_real_destroy`

列出所有回调

```
Model.methods.select { |m| m.to_s.include? "callback" }.sort 
```

然后，如果您输入方法名称，您可以获得给定的回调，例如

```
Model._update_callbacks
Model._real_destroy_callbacks
Model._destroy_callbacks 
```

如果列出所有回调，则可以通过检查`@filter`实例变量来找到所需的回调，例如

```
require 'pp'
Activity._destroy_callbacks.each_with_index { |clbk,index| puts "#{index}-------\n#{clbk.pretty_inspect}" } ; nil 

# [...]

#<ActiveSupport::Callbacks::Callback:0x00007ff14ee7a968
 @chain_config=
  {:scope=>[:kind, :name],
   :terminator=>
    #<Proc:0x00007ff13fb825f8@/Users/mypc/.rbenv/versions/2.3.7/lib/ruby/gems/2.3.0/gems/activemodel-4.1.16/lib/active_model/callbacks.rb:103 (lambda)>,
   :skip_after_callbacks_if_terminated=>true},
 @filter=
  #<Proc:0x00007ff14ee7ac10@/Users/mypc/.rbenv/versions/2.3.7/lib/ruby/gems/2.3.0/gems/activerecord-4.1.16/lib/active_record/associations/builder/association.rb:135 (lambda)>,
 @if=[],
 @key=70337193825800,
 @kind=:before,
 @name=:destroy,
 @unless=[]>
4-------
#<ActiveSupport::Callbacks::Callback:0x00007ff14ee3a228
 @chain_config=
  {:scope=>[:kind, :name],
   :terminator=>
    #<Proc:0x00007ff13fb825f8@/Users/mypc/.rbenv/versions/2.3.7/lib/ruby/gems/2.3.0/gems/activemodel-4.1.16/lib/active_model/callbacks.rb:103 (lambda)>,
   :skip_after_callbacks_if_terminated=>true},
 @filter=:audit_destroy,
 @if=[],
 @key=:audit_destroy,
 @kind=:before,
 @name=:destroy,
 @unless=[]>
5------- 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-02-24T21:43:34.647

对于`after_commit`回调，调用`Model._commit_callbacks`.

但是请注意，Rails 中存在一个已知错误（Rails 5.2.2 中仍然存在），即`after_commit`回调不是按照它们在模型中声明的顺序运行的，即使它们在该`_commit_callbacks`调用中以正确的顺序出现也是如此。

更多信息：[多个 after_commit 回调（Rails）的执行顺序](https://stackoverflow.com/questions/30625790/execution-order-of-multiple-after-commit-callbacks-rails)和 [https://github.com/rails/rails/issues/20911](https://github.com/rails/rails/issues/20911)

# c# - 范围内的单元格样式对齐

> ID：11529870
> 
> 赞同：34
> 
> 时间：2012-07-17T19:52:01.293
> 
> 标签：c#, excel, format, alignment

我在 Excel 工作表中处理单元格时遇到问题。由于某种原因，当我只想更改一些指定或指定范围的样式时，我的代码似乎正在更改所有单元格的样式。

这是我正在使用的一些代码：

```
app = new Microsoft.Office.Interop.Excel.Application();
workbook = app.Workbooks.Add(1);
worksheet = (Microsoft.Office.Interop.Excel.Worksheet)workbook.Sheets[1];

//Change all cells' alignment to center
worksheet.Cells.Style.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignCenter;

//But then this line changes every cell style back to left alignment
worksheet.Cells[y + 1, x + 2].Style.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignLeft; 
```

为什么当我将它设置为只在一个单元格上工作时它会改变多个单元格的样式？它不应该按我想要的方式工作吗？还有另一种方法吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-07-31T11:29:31.947

这很好用

```
worksheet.get_Range("A1","A14").Cells.HorizontalAlignment = 
                 Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignLeft; 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2012-07-17T23:43:30.850

根据 OP 的评论，“我发现了问题。显然是 worksheet.Cells[y + 1, x + 1].Horizo​​ntalAlignment”，我相信真正的解释是所有单元格开始共享同一个 Style 对象。因此，如果您更改该样式对象，它会更改所有使用它的单元格。但是，如果您只是直接更改单元格的对齐属性，则只有该单元格会受到影响。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-07-17T20:06:02.093

也许声明一个范围可能对你更好。

```
// fill in the starting and ending range programmatically this is just an example. 
string startRange = "A1";
string endRange = "A1";
Excel.Range currentRange = (Excel.Range)excelWorksheet.get_Range(startRange , endRange );
currentRange.Style.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignLeft; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-09-16T07:25:50.887

直接在范围或单元格中修改样式对我不起作用。但想法是：

1.  创建单独的样式
2.  应用所有必要的样式属性值
3.  将样式的名称设置为`Style`范围的属性

，在[MSDN How to: Programmatically Apply Styles to Ranges in Workbooks](http://msdn.microsoft.com/en-us/library/f1hh9fza.aspx)中给出了这项工作。

例如：

```
var range = worksheet.Range[string.Format("A{0}:C{0}", rowIndex++)];
range.Merge();
range.Value = "some value";

var style = workbook.AddStyle();
style.HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignLeft;

range.Style = style.Name; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-02-25T20:23:14.667

```
 ExcelApp.Sheets[1].Range[ExcelApp.Sheets[1].Cells[1, 1], ExcelApp.Sheets[1].Cells[70, 15]].Cells.HorizontalAlignment =
                 Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignCenter; 
```

这对我来说很好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-03-04T21:23:13.823

不要使用“样式：

```
worksheet.Cells[y,x].HorizontalAlignment = Microsoft.Office.Interop.Excel.XlHAlign.xlHAlignLeft; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-04-03T08:55:46.497

对我有用的东西。享受。

```
Excel.Application excelApplication =  new Excel.Application()  // start excel and turn off msg boxes
{
     DisplayAlerts = false,
     Visible = false
};

Excel.Workbook workBook = excelApplication.Workbooks.Open(targetFile);
Excel.Worksheet workSheet = (Excel.Worksheet)workBook.Worksheets[1];

var rDT = workSheet.Range(workSheet.Cells[monthYearNameRow, monthYearNameCol], workSheet.Cells[monthYearNameRow, maxTableColumnIndex]);
rDT.Merge();
rDT.Value = monthName + " " + year;
var reportDateRowStyle = workBook.Styles.Add("ReportDateRowStyle");
reportDateRowStyle.HorizontalAlignment = XlHAlign.xlHAlignCenter;
reportDateRowStyle.Font.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Black);
reportDateRowStyle.Font.Bold = true;
reportDateRowStyle.Font.Size = 14;
rDT.Style = reportDateRowStyle; 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2019-08-12T14:22:14.527

Manikandan 的回答很好。对于 SpreadSheetGear 用户（用于与电子表格进行更轻松交互的 C# 框架），请尝试以下操作：

`workbook.Worksheets[0].Cells["B1:B4"].HorizontalAlignment = HAlign.Center;`. 这会将工作表中的所有单元格从 B1 对齐到 B4（第 2 列 - 第 1 行到第 4 行）。

# javascript - 如何在浏览器中读取 Connect Js cookie？

> ID：11529874
> 
> 赞同：1
> 
> 时间：2012-07-17T19:52:19.703
> 
> 标签：javascript, node.js, cookies, extjs

我正在使用 Sencha Connect cookie 会话。它在 Node 中运行良好，但我需要在客户端解析 cookie。Connect 将 s:j: 添加到 cookie 的前面，并在末尾使用点符号 + 生成的密钥。有没有办法防止这种情况或在 JS 中解析它，还是我需要编写自己的解析器？
cookie 值如下所示：

```
s: j: {
    "oauth": {
        "token": "xxxxxx",
        "token_secret": "xxxxxx",
        "results": {
            "oauth_callback_confirmed": "true"
        },
        "access_token": "xxxxx-xxxx",
        "access_token_secret": "xxxx"
    },
    "me": {
        "val": "bu-rcizj7u8jm7jzgea",
        "refs": {
            "bu-rcizj7u8jm7jzgea": {
                "id": "bu-rcizj7u8jm7jzgea",
                "creation_time": "2012-07-13T16:01:17.159+0000",
                "twitter_id": "138031018",
                "first_name": "xxx",
                "last_name": "xxx",
                "email": "xxx@xxx.com",
                "permission": {
                    "can_update": false,
                    "can_delete": false,
                    "can_read": false
                },
                "twitter_screen_name": "xxxx"
            }
        }
    }
}.DdFx96zckmMbWY8wLiFhuGwnofluk3x2WSVBv71LOV8 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T18:42:36.507

你为什么不做这样的事情？它应该适用于任何返回的结构（注意 indexOf 如果未找到则返回 -1，并且 '}.' 通常不是有效的 JSON，因此在实际有效的 JSON 的情况下它只会读到最后）。另一种方法是编写 Dijkstra 算法的实现，该算法仅在找到开头的“{”后才开始推入值堆栈；这会稍微快一些，因为它只会是一次通过（而调用 indexOf 两次可以使我的实现在最坏的情况下通过三次）。如果您有兴趣，我很乐意发送一次性密码。

```
var rawCookie = 's: j: { "oauth": { "token": "xxxxxx", "token_secret": "xxxxxx", "results": { "oauth_callback_confirmed": "true" },"access_token": "xxxxx-xxxx", "access_token_secret": "xxxx"}, "me": {"val": "bu-rcizj7u8jm7jzgea","refs": {"bu-rcizj7u8jm7jzgea": { "id": "bu-rcizj7u8jm7jzgea", "creation_time": "2012-07-13T16:01:17.159+0000", "twitter_id": "138031018", "first_name": "xxx", "last_name": "xxx", "email": "xxx@xxx.com", "permission": { "can_update": false, "can_delete": false,"can_read": false }, "twitter_screen_name": "xxxx" } } } }.DdFx96zckmMbWY8wLiFhuGwnofluk3x2WSVBv71LOV8';
var niceJsonCookie = rawCookie.slice(rawCookie.indexOf('{'), rawCookie.indexOf('}.') + 1);
var niceJsonObject = JSON.parse(niceJsonCookie); 
```

# php - 使用 PHP 从网页中获取特定的 HTML

> ID：11529875
> 
> 赞同：1
> 
> 时间：2012-07-17T19:52:27.807
> 
> 标签：php, regex, parsing, html-parsing

> **可能重复：**
> [如何使用 PHP 解析和处理 HTML？](https://stackoverflow.com/questions/3577641/how-to-parse-and-process-html-with-php)

我正在学习 PHP，当我必须从没有可用 API 的网页中提取（解析）一些数据时，我使用正则表达式或一个函数来获取两个字符串之间的字符串。

我想知道是否有更“专业”、更简单的方法来做到这一点，因为 regexp 是资源消耗，而不是现在对我来说最容易写的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:53:28.200

您永远不应该尝试使用*正则表达式解析 XML (* *html* ) ，而应该为自己准备一个合适的 XML 解析器库并以正确的方式进行。我可能听起来像是一项艰巨的任务，但你最终会感谢自己。

 *可以使用以下资源之一或类似资源来完成解析。

*   **[php.net - PHP: DOM - 手册](http://php.net/manual/en/book.dom.php)**
*   **[simplehtmldom.sourceforge.net - PHP 简单的 HTML DOM 解析器](http://simplehtmldom.sourceforge.net/)**

* * *

关于 html 和*正则表达式*的流行和传奇答案，值得一读的诗歌：

*   **[stackoverflow.com -*传说中的 HTML+RegExp 答案！*](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T19:54:32.130

PHP 带有一个默认的 XML 解析库，供您在这种特定情况下使用。用于`file_get_contents`检索 HTML 页面并进行相应的解析。

**XML**： [http: //php.net/manual/en/book.xml.php](http://php.net/manual/en/book.xml.php)

**[文件获取内容： http](http://php.net/manual/en/function.file-get-contents.php) : **//php.net/manual/en/function.file-get-contents.php*****

# java - NetBeans 7.1.2 tomcat /manager 访问配置问题

> ID：11529877
> 
> 赞同：1
> 
> 时间：2012-07-17T19:52:34.790
> 
> 标签：java, tomcat, netbeans

我正在尝试访问`/manager`由 NetBeans 7.1.2 安装的 Tomcat 实例的页面。

当我右键单击属性的相应树节点时，我得到这个：

![在此处输入图像描述](../Images/f77c17d1823c5f7e397fcedbc104926c.png)

这似乎表明我可以使用这些凭据，但它们不起作用。

当我查看时`tomcat-users.xml`，该用户似乎不存在：

```
<tomcat-users>
<!--
  NOTE:  By default, no user is included in the "manager-gui" role required
  to operate the "/manager/html" web application.  If you wish to use this app,
  you must define such a user - the username and password are arbitrary.
-->
<!--
  NOTE:  The sample user and role entries below are wrapped in a comment
  and thus are ignored when reading this file. Do not forget to remove
  <!.. ..> that surrounds them.
-->
<!--
  <role rolename="tomcat"/>
  <role rolename="role1"/>
  <user username="tomcat" password="tomcat" roles="tomcat"/>
  <user username="both" password="tomcat" roles="tomcat,role1"/>
  <user username="role1" password="tomcat" roles="role1"/>
-->
</tomcat-users> 
```

我应该创建它吗？如果是，我已经尝试过，但找不到合适的角色。什么是正确的添加行？（是的，我已经重新启动了 Tomcat）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T20:12:53.720

在属性对话框中，您可以看到两个变量：

*   **`CATALINA_HOME`**，您选择安装 Tomcat 的目录。例如`c:\Program Files\Apache Software Foundation\Tomcat 6.0`。Tomcat 使用此变量来查找其内部类和库。

*   **`CATALINA_BASE`**配置文件和目录的目录，例如Web应用程序目录。如果`CATALINA_BASE`未设置，则默认为 的值`CATALINA_HOME`。例如`C:\Users\JVerstry\.netBeans\7.1.2\apache-tomcat-7.0.22.0_base`

如果要使用管理器，则需要将管理器应用程序部署（复制）到位于`C:\Users\JVerstry\.netBeans\7.1.2\apache-tomcat-7.0.22.0_base`该应用程序不存在的正确文件夹中（请参阅目录`conf/Catalina/localhost`）并将角色添加`manager-gui`到用户

# delphi - 如何在位图上渲染棋盘格？

> ID：11529878
> 
> 赞同：4
> 
> 时间：2012-07-17T19:52:35.570
> 
> 标签：delphi, delphi-xe

我在另一个“下方”图像之上显示透明图像。

在这种情况下，底部（实心）图像是棋盘格，顶部图像是狮子（透明）：

![在此处输入图像描述](../Images/4d9b8576e04af5b91f882577e71fae91.png)

![在此处输入图像描述](../Images/9c1a1cf6a1f0150c452ca497501b9db1.png)=![在此处输入图像描述](../Images/43902ddcfa1a30bbf40ce737f0693426.png)

原因是更好地显示透明区域，因为通常您不会看到哪些区域是透明的。

问题是，位图的尺寸可以是任意大小，因此网格也需要与位图的大小相同。

如果您愿意，一个肮脏的方法是创建一个更大版本的上述棋盘网格，大小为 2000x2000，然后根据您正在使用的位图的大小，您可以调整网格画布的大小以匹配。这并不理想，因为这意味着将大型棋盘格位图与您的应用程序一起存储，然后意味着调整它的大小，这可能无法根据纵横比等给出正确的结果。

我认为正确的方法是以编程方式渲染棋盘网格，例如：

```
procedure RenderGrid(Source: TBitmap; Height, Width: Integer;
  Size: Integer; Color1, Color2: TColor);
begin

end; 
```

这将允许自定义具有不同大小和颜色的网格，而不必担心存储大型棋盘网格位图和调整其大小的开销。

但是我不确定如何将网格绘制到位图上？我的一个想法是你需要循环遍历位图的每一行并以这种方式着色？我不确定。

这涉及我不擅长的数学和计算。如果您能告诉我在位图上渲染网格的最有效方法，我将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T20:07:07.890

```
procedure RenderGrid(Source: TBitmap; Height, Width: Integer;
  Size: Integer; Color1, Color2: TColor);
var
  y: Integer;
  x: Integer;
begin
  Source.SetSize(Width, Height);
  for y := 0 to Height div Size do
    for x := 0 to Width div Size do
    begin
      if Odd(x) xor Odd(y) then
        Source.Canvas.Brush.Color := Color1
      else
        Source.Canvas.Brush.Color := Color2;
      Source.Canvas.FillRect(Rect(x*Size, y*Size, (x+1)*Size, (y+1)*Size));
    end;
end; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-17T22:31:56.553

曾几何时，我[描述了这个特定的需求](http://www.nldelphi.com/Forum/showthread.php?p=243743#post243743)。考虑到您的`RenderGrid`签名，可能`Bitmap`会在绘制位图后绘制参数的图像。然后通过绘制整个位图获得最佳性能`Color1`，并且只绘制正方形`Color2`：

```
procedure RenderGrid(Target: TBitmap; Height, Width: Integer; Size: Integer;
  Color1, Color2: TColor);
var
  Col: Integer;
  Row: Integer;
begin
  Target.SetSize(Width, Height)
  Target.Canvas.Brush.Color := Color1;
  Target.Canvas.FillRect(Rect(0, 0, Width, Height));
  Target.Canvas.Brush.Color := Color2;
  for Col := 0 to Width div Size do
    for Row := 0 to Height div Size do
      if Odd(Col + Row) then
        Target.Canvas.FillRect(Bounds(Col * Size, Row * Size, Size, Size));
end; 
```

* * *

### 更新

但是由于您在谈论*大型*位图，所以下面显示的例程甚至还要快 20%。它创建了一个只有 4 个方格的小位图，比如一个 2 x 2 的棋盘，并让目标的画笔属性自动将其展开。^(*))

```
procedure RenderGrid(Target: TBitmap; Height, Width: Integer; Size: Integer;
  Color1, Color2: TColor);
var
  Tmp: TBitmap;
begin
  Tmp := TBitmap.Create;
  try
    Tmp.Canvas.Brush.Color := Color1;
    Tmp.Width := 2 * Size;
    Tmp.Height := 2 * Size;
    Tmp.Canvas.Brush.Color := Color2;
    Tmp.Canvas.FillRect(Rect(0, 0, Size, Size));
    Tmp.Canvas.FillRect(Bounds(Size, Size, Size, Size));
    Target.Canvas.Brush.Bitmap := Tmp;
    if Target.Width * Target.Height = 0 then
      Target.SetSize(Width, Height)
    else
    begin
      Target.SetSize(Width, Height)
      Target.Canvas.FillRect(Rect(0, 0, Width, Height));
    end;
  finally
    Tmp.Free;
  end;
end; 
```

为了进一步优化这一点：缓存这个小位图 ( `Tmp`)，并在其大小未更改时重用它。

^(*))另请参阅：[如何在不调用的情况下为位图着色`FillRect()`？](https://stackoverflow.com/a/7736435/757830).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-03-01T17:10:56.047

对于 Firemonkey 使用此功能

```
procedure PaintChessBrush(const Canvas: TCanvas; const AColor: TAlphaColor; const ARect: TRectF; const AOpacity: Single; const AChessStep: Single = 10);

  procedure MakeChessBrush(ABrushBitmap: TBrushBitmap; const AChessStep: Single);
  var
    BitmapTmp: TBitmap;
  begin
       BitmapTmp := ABrushBitmap.Bitmap;
       with BitmapTmp do
       begin
            SetSize(Trunc(2 * AChessStep), Trunc(2 * AChessStep));
            Clear(TAlphaColorRec.White);
            ClearRect(RectF(0, 0, AChessStep, AChessStep), TAlphaColorRec.Lightgray);
            ClearRect(RectF(AChessStep, AChessStep, 2 * AChessStep, 2 * AChessStep), TAlphaColorRec.Lightgray);
       end;

       ABrushBitmap.WrapMode := TWrapMode.Tile;
  end;

var
  State: TCanvasSaveState;
begin
     State := Canvas.SaveState;
     try
          MakeChessBrush(Canvas.Fill.Bitmap, AChessStep);
          Canvas.Fill.Kind := TBrushKind.Bitmap;
          Canvas.FillRect(ARect, 0, 0, AllCorners, AOpacity);

          Canvas.Fill.Kind := TBrushKind.Solid;
          Canvas.Fill.Color := AColor;
          Canvas.FillRect(ARect, 0, 0, AllCorners, AOpacity);
     finally
        Canvas.RestoreState(State);
     end;
end; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-17T20:24:15.953

使用这种方法，您将获得更好的性能。只是不要传递 CellSize = 0。

```
// Color1, Color2 in RRGGBB format (i.e. Red = $00FF0000)
procedure RenderGrid(Source: TBitmap; CellSize: Integer; Color1, Color2: TColorRef);
var
  I, J: Integer;
  Pixel: ^TColorRef;
  UseColor1: Boolean;
begin
  Source.PixelFormat := pf32bit;
  Pixel := Source.ScanLine[Source.Height - 1];
  for I := 0 to Source.Height - 1 do
  begin
    UseColor1 := (I div CellSize) mod 2 = 0;
    for J := 0 to Source.Width - 1 do
    begin
      if J mod CellSize = 0 then UseColor1 := not UseColor1;

      if UseColor1 then
        Pixel^ := Color1
      else
        Pixel^ := Color2;
      Inc(Pixel);
    end;
  end;
end; 
```

# plone - 无法在 Plone 中下载用于 sendaspdf 的 wkhtmltopdf 添加

> ID：11529879
> 
> 赞同：1
> 
> 时间：2012-07-17T19:52:37.177
> 
> 标签：plone

当我按照 Dan 的建议修改 buildout.cfg 文件后尝试使用 bin/buildout 通过 build out 安装 wkhtmltopdf 时，出现以下错误：

```
Updating wkhtmltopdf_executable.
mv: cannot stat `wkhtmltopdf-amd64': No such file or directory
chmod: cannot access `wkhtmltopdf': No such file or directory
Installing wkhtmltopdf.
wkhtmltopdf: Unable to extract the package /home/user/Plone/buildout-cache/downloads/94af137dfe94508c7d7bfab08214118c. Unknown format.
While:
  Installing wkhtmltopdf.
Error: Package extraction error 
```

我已经完成了这个链接中所说的一切：[https ://github.com/vincent-psarga/collective.sendaspdf](https://github.com/vincent-psarga/collective.sendaspdf)

我的构建文件现在看起来像这样：（buildout.cfg）：

```
############################################
#
# Buildout Configuration File for Standalone Plone
# ------------------------------------------------
#
# After making changes in this configuration file,
# you should run bin/buildout to update the components.
# 
# ALWAYS back up all Plone/Zope data and components
# before changing configuration.
# 
# Running "bin/buildout" will update your installation,
# installing missing components as necessary.
# 
# Use "bin/buildout -n" to update many components here to the newest
# available releases.
# This will update the add-on products you've added in the eggs= lines.
# This will not, however, upgrade Plone itself (or anything else you've
# pinned with a version specification). To upgrade Plone itself, see the
# comments in "Plone Component Versions".
#
# Tutorial instructions for using zc.buildout for
# configuration management are available at:
# http://plone.org/documentation/tutorial/buildout
# Full details at http://pypi.python.org/pypi/zc.buildout
#
############################################

[buildout]

############################################
# Plone Component Versions
# ------------------------
# This version of the Unified Installer has the components of Plone 4 
# preloaded so that it can install without an Internet connection.
# If you want to update, uncomment the "http://..." line below,
# edit it to point to the current version URL, comment out the 
# "versions.cfg" line and run "bin/buildout" while attached to the 
# Internet. Generally, you only want to do that as part of a planned migration.
# Note that if you are updating components, you should also check the versions
# section at the end of this file, since recipes or components other than
# those of Zope and Plone may need updating at the same time.
#
extends = 
    base.cfg
    versions.cfg
    http://dist.plone.org/release/4.2-latest/versions.cfg

# If you change your Plone version, you'll also need to update
# the repository below.
find-links +=
    http://dist.plone.org/release/4.2

############################################
# Ports
# -----
# Specify the port on which your Zope installation
# will listen:
http-address = 8080

# If you try to start Zope as root, it will change user id to run as
# the effective user specified here. This user id must own the var directory
# of your buildout.
effective-user = user

############################################
# Eggs
# ----
# Add an indented line to the eggs section for any Python
# eggs or packages you wish to include.
#
eggs =
    Plone
    Pillow
    lxml
    pisa
    pyPdf
    html5lib
    reportlab 
    collective.quickupload
    Products.reflecto
    Products.ploneboard
    Products.EasyNewsletter
    collective.subscribablesections
    Products.CMFNotification
    Products.PloneSubscription
    plone.app.ldap
    plone.app.theming
    collective.groupspace.content
    collective.groupspace.mail
    collective.groupspace.workflow
    collective.groupspace.roles
    collective.sendaspdf
    ftw.dashboard.portlets.favourites
    quintagroup.dropdownmenu
    Products.Carousel
    Products.ContentWellPortlets
    quintagroup.theme.lite
    zettwerk.ui
    collective.kuputabs
    collective.tabr
    collective.zipfiletransport  

# Optional Functionality
# ----------------------
# Uncomment the indented lines to include these add-on products.
# Documentation on all of them, along with many more products,
# is available at
# http://plone.org/products/
#
# Example products:
# * LinguaPlone provides tools for building multi-lingual sites
# * PloneFormGen provides through-the-web form building
#
#    Products.LinguaPlone==4.1.1
#    Products.PloneFormGen==1.7.0
#
# Note that versions may be specified here or in the [versions]
# section below. You should always specify versions that you know
# are compatible with the Plone release and at an acceptable
# development level.
#
# Commonly used development tools:
# Several excellent development tools are included in the develop.cfg
# buildout extension. Read it to learn how to activate these tools.

############################################
# ZCML Slugs
# ----------
# Some eggs need ZCML slugs to tell Zope to
# use them. This is increasingly rare.
zcml =
#    plone.reload
     ftw.dashboard.portlets.favourites
     collective.kuputabs

############################################
# Development Eggs
# ----------------
# You can use paster to create "development eggs" to
# develop new products/themes. Put these in the src/
# directory.
# You will also need to add the egg names in the
# eggs section above, and may also need to add them
# to the zcml section.
#
# Provide the *paths* to the eggs you are developing here:
develop =
#    src/my.package

############################################
# Debug Mode
# ----------
# Change debug-mode to "on" to run in development mode.
# This will dramatically slow Plone.
# 
debug-mode = off
# Add-on developers should turn deprecation warnings on
deprecation-warnings = off
# change verbose-security to "on" for useful security errors while developing
verbose-security = off

############################################
# Backup Directory
# ----------------
# Sets the target directory for the bin/backup and bin/snapshotbackup
# commands. Default is inside this project's var directory, but ideally
# this should be on a separate volume or backup server.
# 
backups-dir=${buildout:directory}/var

############################################
# Initial User
# ------------
# This is the user id and password that will be used to create the initial 
# user id that will allow you to log in and create a Plone site. This only
# sets the initial password; it will not allow you to change an already 
# existing password. If you change the admin password via the web interface,
# the one below will no longer be valid.
# If you find yourself locked out of your Zope/Python installation, you may
# add an emergency user via "bin/plonectl adduser".
user=admin:*******

############################################
# Parts Specification
#--------------------
# Specifies the components that should be included in the buildout.
# All the basics are in the base.cfg extension; you may add your
# own if you need them at the end of this file.
parts =
    instance
    zopepy
    zopeskel
    unifiedinstaller
    repozo
    backup
    chown 
    wkhtmltopdf
    wkhtmltopdf_executable

############################################
# Environment Variables
# ---------------------
# Some of the behavior of your Zope/Plone instances are controlled with OS
# environment variables. You may set those here in a key / value format.
# Some common settings:
#    * TZ allows you to set a time zone for systems where it's not
#      automatically available.
#    * zope_i18n_compile_mo_files allows for automatic compilation of
#      missing translation files (may slow startup).
#    * zope_i18n_allowed_languages allows you to limit the available
#      translations.
#    * PYTHON_EGG_CACHE determines where zipped python packages are unpacked
#      for use.
[instance]
environment-vars =
    zope_i18n_compile_mo_files true
    PYTHON_EGG_CACHE ${buildout:directory}/var/.python-eggs
    WKHTMLTOPDF_PATH ${buildout:directory}/wkhtmltopdf

[wkhtmltopdf]
recipe = hexagonit.recipe.download
url = http://wkhtmltopdf.googlecode.com/files/wkhtmltopdf-0.9.9-static-amd64.tar.bz2

[wkhtmltopdf_executable]
recipe = collective.recipe.cmd
on_install = true
on_update = true
cmds =
     cd ${buildout:directory}/parts/wkhtmltopdf
     mv wkhtmltopdf-amd64 wkhtmltopdf
     chmod +x wkhtmltopdf

############################################
# Versions Specification
# ----------------------
# Version information supplied here will "pin" Python packages to a particular
# version number, even when you use the "newest" flag running buildout.
# Specifying versions for all packages is a good idea and can prevent
# accidental changes when you add new packages to your buildout.
# Note that versions specified here will override those specified earlier
# in the configuration, including those from the Plone and Zope version
# config files.
#
[versions]
Cheetah = 2.2.1
Pillow = 1.7.6
Products.DocFinderTab = 1.0.5
ZopeSkel = 2.21.2
collective.recipe.backup = 2.4
plone.recipe.command = 1.1
plone.recipe.unifiedinstaller = 4.1
ftw.dashboard.portlets.favourites = 2.0
lxml = 2.3.4 
```

文塞特：这是我的 base.cfg 文件

```
######################################################
# Base Configuration; used by both standalone and zeo,
# which extend it.
# ---------------------------------------------------

# Buildout instructions in this file are
# usually only changed by experienced developers.
#
# Beyond here there be dragons!

[buildout]
eggs-directory=../buildout-cache/eggs
download-cache=../buildout-cache/downloads

# Don't download new things unless needed to satisfy dependencies.
# Override this on the command line with the "-n" flag.
newest = false

# Pick final releases over newer development releases when it's
# possible to do so and still fulfil requirements. Note that explicit
# version specifications will override this preference.
prefer-final = true

versions = versions

# Add additional egg download sources here. dist.plone.org contains archives
# of Plone packages.
find-links =
    http://dist.plone.org
    http://download.zope.org/ppix/
    http://download.zope.org/distribution/
    http://effbot.org/downloads

# unzip all eggs for easier debugging
unzip = true

# Load the DumpPickedVersions extension, which will notify
# you of versions picked by buildout that were not specifically
# pinned. 
extensions = buildout.dumppickedversions

[instance]
# Use this section to install and configure a Zope operating
# instance.
# For options see http://pypi.python.org/pypi/plone.recipe.zope2instance
recipe = plone.recipe.zope2instance
# The line below sets only the initial password. It will not change an
# existing password.
user = ${buildout:user}
http-address = ${buildout:http-address}
# if we try to start as root, Zope will switch to the user below
effective-user = ${buildout:effective-user}
# change debug-mode to "on" to run in development mode
debug-mode = ${buildout:debug-mode}
# change verbose-security to "on" for detailed security
# errors while developing
verbose-security = ${buildout:verbose-security}
# change deprecation-warnings to "on" to get log warnings
# for deprecated usages.
deprecation-warnings = ${buildout:deprecation-warnings}
blob-storage = ${buildout:directory}/var/blobstorage

# If you want Zope to know about any additional eggs, list them here.
# e.g. eggs = ${buildout:eggs} my.package
eggs =
    ${buildout:eggs}

# If you want to register ZCML slugs for any packages, list them here.
# e.g. zcml = my.package my.other.package
zcml = ${buildout:zcml}

products = ${buildout:directory}/products

# You may also control the environment variables for the instance.
environment-vars = ${buildout:environment-vars}

[zopepy]
# installs a zopepy python interpreter that runs with your
# full Zope environment
recipe = zc.recipe.egg
eggs = ${buildout:eggs}
interpreter = zopepy
scripts = zopepy

[chown]
# This recipe is used to set permissions for root mode installs
# For options see http://pypi.python.org/pypi/plone.recipe.command
recipe = plone.recipe.command
command =echo Dummy references to force this to execute after referenced parts
    echo ${backup:location} ${unifiedinstaller:sudo-command}
    chmod 600 .installed.cfg
    find ${buildout:directory}/var -type d -exec chmod 700 {} \;
    chmod 744 ${buildout:directory}/bin/*
update-command = ${chown:command}

[unifiedinstaller]
# This recipe installs the plonectl script and a few other convenience
# items.
# For options see http://pypi.python.org/pypi/plone.recipe.unifiedinstaller
recipe = plone.recipe.unifiedinstaller
user = ${buildout:user}
primary-port = ${buildout:http-address}
sudo-command = 

[repozo]
# This recipe builds the repozo script for non-zeo installations.
recipe = zc.recipe.egg
eggs = ZODB3
scripts = repozo

[backup]
# This recipe builds the backup, restore and snapshotbackup commands.
# For options see http://pypi.python.org/pypi/collective.recipe.backup
recipe = collective.recipe.backup
location = ${buildout:backups-dir}/backups
snapshotlocation = ${buildout:backups-dir}/snapshotbackups

[zopeskel]
# installs paster and Zopeskel
recipe = zc.recipe.egg
eggs =
    ZopeSkel
    Paste
    PasteDeploy
    PasteScript
    ${buildout:eggs} 
```

这是我的versions.cfg 文件：

```
# http://dist.plone.org/release/4.1.4/versions.cfg

[buildout]
extends = 
    zopeapp-versions.cfg
    zope-versions.cfg
#    http://download.zope.org/zopetoolkit/index/1.0.5/zopeapp-versions.cfg
#    http://download.zope.org/Zope2/index/2.13.12/versions.cfg

[versions]
# Zope overrides
# Products.BTreeFolder2 2.13.4 causes a regression
Products.BTreeFolder2 = 2.13.3

# Buildout infrastructure
buildout.dumppickedversions = 0.5
collective.recipe.omelette = 0.12
mr.developer = 1.18
plone.recipe.alltests = 1.2
plone.recipe.zope2instance = 4.1.9
plone.recipe.zeoserver = 1.2.2
distribute = 0.6.24
setuptools = 0.6c11
z3c.coverage = 1.2.0
z3c.ptcompat = 1.0
z3c.template = 1.4.0

# External dependencies
Markdown = 2.0.3
PIL = 1.1.6
Unidecode = 0.04.1
elementtree = 1.2.7-20070827-preview
feedparser = 5.0.1
mailinglogger = 3.3.3
python-dateutil = 1.5
python-openid = 2.2.5
simplejson = 2.1.6

# Plone release
Plone                                 = 4.1.4
Products.ATContentTypes               = 2.1.6
Products.ATReferenceBrowserWidget     = 3.0
Products.Archetypes                   = 1.7.12
Products.CMFActionIcons               = 2.1.3
Products.CMFCalendar                  = 2.2.2
Products.CMFCore                      = 2.2.5
Products.CMFDefault                   = 2.2.2
Products.CMFDiffTool                  = 2.0
Products.CMFDynamicViewFTI            = 4.0.2
Products.CMFEditions                  = 2.1.7
Products.CMFFormController            = 3.0.2
Products.CMFPlacefulWorkflow          = 1.5.6
Products.CMFPlone                     = 4.1.4
Products.CMFQuickInstallerTool        = 3.0.5
Products.CMFTestCase                  = 0.9.11
Products.CMFTopic                     = 2.2.1
Products.CMFUid                       = 2.2.1
Products.contentmigration             = 2.0.3
Products.DCWorkflow                   = 2.2.4
Products.ExtendedPathIndex            = 2.9
Products.ExternalEditor               = 1.0
Products.GenericSetup                 = 1.6.5
Products.Marshall                     = 2.1.1
Products.MimetypesRegistry            = 2.0.3
Products.PasswordResetTool            = 2.0.7
Products.PlacelessTranslationService  = 2.0.3
Products.PloneLanguageTool            = 3.2.4
Products.PlonePAS                     = 4.0.11
Products.PloneTestCase                = 0.9.13
Products.PluggableAuthService         = 1.7.7
Products.PluginRegistry               = 1.3
Products.PortalTransforms             = 2.0.7
Products.ResourceRegistries           = 2.0.6
Products.SecureMailHost               = 1.1.2
Products.TinyMCE                      = 1.2.10
Products.ZopeVersionControl           = 1.1.3
Products.ZSQLMethods                  = 2.13.4
Products.i18ntestcase                 = 1.2
Products.kupu                         = 1.5.0
Products.statusmessages               = 4.0
Products.validation                   = 2.0
archetypes.kss                        = 1.7.1
archetypes.referencebrowserwidget     = 2.4.9
archetypes.schemaextender             = 2.1.1
borg.localrole                        = 3.0.2
collective.monkeypatcher              = 1.0.1
collective.testcaselayer              = 1.3
collective.z3cform.datetimewidget     = 1.0.5
five.customerize                      = 1.0.2
five.formlib                          = 1.0.4
five.globalrequest                    = 1.0
five.localsitemanager                 = 2.0.5
kss.core                              = 1.6.3
plone.app.blob                        = 1.5.1
plone.app.caching                     = 1.0.1
plone.app.content                     = 2.0.7
plone.app.contentmenu                 = 2.0.5
plone.app.contentrules                = 2.1.4
plone.app.controlpanel                = 2.1.3
plone.app.customerize                 = 1.2.2
plone.app.discussion                  = 2.1.3
plone.app.folder                      = 1.0.4
plone.app.form                        = 2.0.5
plone.app.i18n                        = 2.0.1
plone.app.imaging                     = 1.0.5
plone.app.iterate                     = 2.1.4
plone.app.jquerytools                 = 1.3.1
plone.app.kss                         = 1.6.2
plone.app.layout                      = 2.1.13
plone.app.linkintegrity               = 1.4.4
plone.app.locales                     = 4.0.11
plone.app.openid                      = 2.0.2
plone.app.portlets                    = 2.1.7
plone.app.redirector                  = 1.1.2
plone.app.registry                    = 1.0.1
plone.app.testing                     = 4.0.2
plone.app.upgrade                     = 1.1.5
plone.app.users                       = 1.1.3
plone.app.uuid                        = 1.0
plone.app.viewletmanager              = 2.0.2
plone.app.vocabularies                = 2.1.5
plone.app.workflow                    = 2.0.6
plone.app.z3cform                     = 0.5.7
plone.autoform                        = 1.0
plone.browserlayer                    = 2.1.1
plone.cachepurging                    = 1.0.3
plone.caching                         = 1.0
plone.contentrules                    = 2.0.1
plone.fieldsets                       = 2.0.1
plone.folder                          = 1.0.1
plone.i18n                            = 2.0
plone.indexer                         = 1.0
plone.intelligenttext                 = 2.0.1
plone.keyring                         = 2.0
plone.locking                         = 2.0.3
plone.memoize                         = 1.1.1
plone.openid                          = 2.0
plone.outputfilters                   = 1.1
plone.portlet.collection              = 2.0.4
plone.portlet.static                  = 2.0.1
plone.portlets                        = 2.0.2
plone.protect                         = 2.0
plone.registry                        = 1.0
plone.reload                          = 2.0
plone.scale                           = 1.2.2
plone.session                         = 3.5
plone.stringinterp                    = 1.0.5
plone.supermodel                      = 1.0.3
plone.testing                         = 4.0.3
plone.theme                           = 2.1
plone.transformchain                  = 1.0.2
plone.uuid                            = 1.0.2
plone.z3cform                         = 0.7.8
plonetheme.classic                    = 1.1.2
plonetheme.sunburst                   = 1.1.6
wicked                                = 1.1.9
z3c.autoinclude                       = 0.3.4
z3c.batching                          = 1.1.0
z3c.caching                           = 2.0a1
z3c.form                              = 2.5.1
z3c.formwidget.query                  = 0.5
z3c.zcmlhook                          = 1.0b1
zope.globalrequest                    = 1.0 
```

你能告诉我我做错了什么吗？帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T21:09:35.343

按照[https://github.com/vincent-psarga/collective.sendaspdf](https://github.com/vincent-psarga/collective.sendaspdf)上的说明为我工作。

**编辑**：啊，现在你已经发布了你的整个`buildout.cfg`我可以看到问题。该`parts =`部分必须是该`[buildout]`节的一部分。目前处于`[wkhtmltopdf_executable]`.

设置初始用户也是如此。请注意，您已经包含了管理员密码，所以如果这真的是密码，我现在就更改它！

# ios - UITableView 上面的 UIView 没有显示——iOS

> ID：11529880
> 
> 赞同：0
> 
> 时间：2012-07-17T19:52:39.773
> 
> 标签：ios, cocoa-touch

我们在 iOS 上的 tableView 上方显示视图时遇到问题。我们的方法是创建一个 UIView，它是 UIViewController 的子类的子视图，将其发送到后面，然后在 didSelectRowAtIndexPath 上将其带到前面。我们使用 XIB 来创建用户界面。视图层次结构是这样的：

视图
-- UIView ("loading..." 视图)
-- -- UILabel ("loading...")
-- -- UIActivityIndi​​catorView
-- UITableView
-- UILabel

下面是我们尝试显示“正在加载”视图的方法：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Create a request to the server based on the user's selection in the table view
    NSMutableURLRequest *request = [[NSMutableURLRequest alloc] initWithURL:url];
    NSError *err;

    // Show the "loading..." message in front of all the other views.
    [self.view bringViewToFront:self.loadingView];
    [self.loadingWheel startAnimating];

    // Make the request
    NSData *data = [NSURLConnection sendSynchronousRequest:request returningResponse:nil error:&err];

    // Stop animating the activity indicator.
    [loadingWheel stopAnimating];

    // other stuff...
} 
```

每当我们将“正在加载”视图放在 XIB 中所有其他视图的前面时，我们可以看到它看起来像我们想要的那样。但是，当我们将加载视图留在后面（根据上面的视图层次结构）然后尝试将其带到前面时，视图永远不会显示。打印出来`self.view.subviews`表明我们的加载视图实际上是在视图层次结构中。有趣的是，如果我们尝试在 didSelectRowAtIndexPath 中更改视图中的其他内容（例如，更改已在视图中显示的标签的背景颜色），则更改永远不会显示在模拟器上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T20:06:49.730

问题是同步请求。它阻塞了主线程，因此活动指示器没有机会显示。

一个简单的解决方案是异步加载全局队列中的数据，当所有内容都加载完毕后，回调主队列。

```
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
    // Make the request
    NSData *data = [NSURLConnection sendSynchronousRequest:request returningResponse:nil error:&err];

    dispatch_async(dispatch_get_main_queue(), ^{
        // Stop animating the activity indicator.
        [loadingWheel stopAnimating];

        // other stuff...
    });
}); 
```

虽然上述解决方案有效，但它会阻塞全局队列，因此并不理想。看看通过`NSURLConnection`. 在 Apple 的“URL 加载系统编程指南”中有详细的解释。

# entity-framework - Entity Framework Code First 4.3 / LINQKit 相关表谓词

> ID：11529881
> 
> 赞同：5
> 
> 时间：2012-07-17T19:52:40.980
> 
> 标签：entity-framework, entity-framework-4, linq-to-entities, ef-code-first

我正在使用 Entity Framework 4.3.1 和 Code First 方法。另外，我正在使用 LinqKit 来使用 PredicateBuilder。

如果我有这样的表：

位置、时区（多：1）

..我希望有这样的东西：

```
Expression<Func<TimeZone, bool>> pred = PredicateBuilder.True<TimeZone>();
pred = pred.And(tz => tz.TimeZoneCode == "EST");

List<Location> locations = context.Locations
    .AsExpandable().Where(pred)
    .Select(loc => loc).ToList(); 
```

这不起作用，因为谓词是为接受 TimeZone 而构建的，但 Where() 方法接收的是 Location。

我可以像这样重写谓词，但我不想这样做，因为我想要一个为特定类型创建谓词的谓词工厂（我不想以这种方式使用 Navigator 属性）：

```
Expression<Func<Location, bool>> pred = PredicateBuilder.True<Location>();
pred = pred.And(loc => loc.TimeZone.TimeZoneCode == "EST"); 
```

我可以使用什么语法（如果有的话）来使用第一个示例中构造的谓词，它需要一个 TimeZone，而不是让它接受一个 Location 并通过导航属性遍历树（因为这不太可重用）。如果有一种方法可以首先利用 EF 对导航属性的了解，并且能够使用范围为导航属性类型的谓词，那就太好了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-01-27T15:02:26.810

经过大约一周的努力，我发现你实际上可以做到这一点。步骤是：

1.  定义一个 Predicate 来查询你的内部属性 ( `subPredicate`)
2.  `Invoke`从`subPredicate`另一个 Predicate ( `predicate`) 中，针对父对象的属性。
3.  `Expand`你`predicate`在你的`Where`条款中使用它时。

这是您的示例的修改后的代码：

```
var subPredicate = PredicateBuilder.True<TimeZone>();
subPredicate = subPredicate.And(tz => tz.TimeZoneCode == "EST");

var predicate = PredicateBuilder.True<Location>();
predicate = predicate.And(l => subPredicate.Invoke(l.TimeZone));

List<Location> locations = context.Locations
    .AsExpandable().Where(pred.Expand())
    .Select(loc => loc).ToList(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T14:53:37.653

只是为了更新这一点：事实证明，这些谓词的目的是过滤主要实体。心理概念是：决定你想归还哪些实体，然后归还它们。EF 显然不是为这种在子实体上的深度谓词应用程序而设计的。

一个人（我不记得在哪里）提出了一个很好的观点：如果孩子们是预先加载的，你就不会期望一个部分加载的集合。因此，例如，拥有一个 Invoice 实体，但只有一半的 Invoice Lines 是没有意义的。

我想要实现的更像是 EXISTS() 或 IN()，您可以在其中说“给我所有发票，其中有产品类型‘螺母’和‘螺栓’的发票行”。这是可行的，但您可能必须应用 LINQ 或编写自己的对象。EF 开箱即用的目的是将发票交给您，然后您可以懒惰或急切地加载发票行，但不直接将它们用作数据库中的过滤器。

我看到有一些结构可以完成一些接近的事情，但是语法很快变得非常难以管理。

不要和市政厅打架。

# lua - 回调 Lua 成员函数

> ID：11529883
> 
> 赞同：1
> 
> 时间：2012-07-17T19:52:49.103
> 
> 标签：lua, luabind

我有一个 lua“动画变量”，它有一个在动画循环中使用的回调函数。

```
local av = AnimationVariable(ticker.Position.Y)
...
av:addCallback( ** animation function goes here **) 
```

跳过细节，这个 addCallback 函数在 C++ 中定义如下：

```
void LuaUIAnimationVariable::addCallback(luabind::object callback); 
```

并且当动画变量被更新时，回调就这样执行（我们用一个参数调用函数）：

```
luabind::call_function<void>(boost::ref(callback), newValue); 
```

我的问题如下：**如何将成员函数与 addCallback 一起使用？**假设我有一个`Ticker:animate(ypos)`函数，在 Ticker 实例上使用 addCallback`addCallBack(ticker:animate)`不会编译，`addCallBack(ticker.animate)`也不起作用。我知道lua中的成员函数有一个隐含的“self”第一个参数。

任何解决方案还是我被迫使用全局函数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T19:57:30.167

不确定我是否理解你的问题，但如果你的意思是 Lua 成员函数，你可以使用闭包：

```
av:addCallback(function(yval) ticker:animate(yval) end) 
```

# c# - C#调用线程函数失败

> ID：11529889
> 
> 赞同：-3
> 
> 时间：2012-07-17T19:53:11.613
> 
> 标签：c#, multithreading, inheritance, invoke

我正在使用计时器定期读入日志文件并将某些内容发布到我正在用 C# 开发的 Windows 窗体应用程序中的文本框中。我通过向 set_textbox_thread 发送一个字符串来执行此操作，该字符串将文本发布到下面 else 中的相应文本框 (tbc)。下面的代码适用于我构建的练习应用程序。但是，相同的代码运行，但无法在我正在构建的完整应用程序中更新我的文本框。Invoke 语句似乎失败了，该语句无法再次调用 set_textbox_thread。我的理论是，因为我的完整应用程序有一组更复杂的控件，所以我没有通过正确的控件调用 Invoke。我尝试通过“this”父面板、父表单和触发 set_textbox_thread 的按钮来调用它，并且正在处理相同的结果。两个问题：

1.  我应该在哪个控件下调用 Invoke？
2.  有没有办法检索“拥有底层窗口句柄控件的线程？我可以通过 Controls.Owner 方法来做到这一点吗？
3.  我尝试使用 try/catch 进行此 Invoke 调用，但无法在 catch 中检索错误消息。任何想法如何以这种方式解决问题？

提前致谢！

```
private delegate void stringDelegate(string s);        
private void set_textbox_thread(string s)
    {
        TextBox tbc = get_thread_tb();

        if (tbc.InvokeRequired)
        {
            MessageBox.Show("Invoke Required");
            stringDelegate sd = new stringDelegate(set_textbox_thread);
            **this.Invoke(sd, new object[] {s });**
            MessageBox.Show("Invoke Completed");
        }
        else
        { 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:57:25.833

1）你调用什么控制并不重要；只有一个 UI 线程和任何控件将调用编组回该 UI 线程。

2）你可以用这个线程做什么？

3）那里没有太多细节。你怎么知道你有错误信息？“错误消息”是什么意思

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:57:39.867

改为在文本框上调用调用：

```
tbc.Invoke(sd, new object[] {s }); 
```

# regex - 正则表达式排除以 /(es|fr|it)/? 开头的域路径

> ID：11529891
> 
> 赞同：0
> 
> 时间：2012-07-17T19:53:15.337
> 
> 标签：regex, url, regex-negation

试图提出一个匹配不以国家前缀开头的 uri 路径的正则表达式。以下用例是一个示例：

```
'^/$'          == true
'^/es$'        == false
'^/es/$'       == false
'^/es/.*$'     == false
'^/escro.*$'   == true
'^/lies$'      == true # newish
'^/lies/$'     == true # newish
'^/fr$'        == false
'^/fr/$'       == false
'^/fr/.*$'     == false
'^/freedom/$'  == true
'^/it$'        == false
'^/it/$'       == false
'^/it/.*$'     == false
'^/item/.*$'   == true
'^/foo/bar/$'  == true 
```

摘要：应该匹配任何不通过 "^/(fr|it|es)$" 或 "^/(fr|it|es)/.*$" 的 URL

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T20:54:26.780

这是一个对我有用的更紧凑的版本：

```
^/[^/]*(?<!/(?:es|fr|it))(?:/.*?)?$ 
```

我使用 PHP 引导程序对其进行了测试，[您可以从演示](http://viper-7.com/0u7HgF)中看到它通过了所有测试用例。

**正则表达式：**

```
^               - Start of string
/               - Match a forward slash
[^/]*           - Match anything that's not a forward slash, 0 or more times
(?<!            - Negative lookbehind making sure
  /(?:es|fr|it) -      We didn't match a forward slash followed by (es|fr|it)
)   
(?:/.*?)?       - Match a forward slash followed by any number of characters, optionally
$               - End of string 
```

# php - Joomla 网站上的 nginx/FastCGI 与 Apache/suPHP

> ID：11529898
> 
> 赞同：0
> 
> 时间：2012-07-17T19:53:49.150
> 
> 标签：php, apache, joomla, nginx, webserver

我总是在我的 VPS 上使用 Apache 和 suPHP。现在，由于页面加载不是很快，我的托管客户支持建议我使用 FastCGI 安装 nginx。我不确定这一点，因为 nginx 安装在大约 11% 的服务器上，而 Apache 是使用最广泛的网络服务器。

我的问题是：

*   这个系统是否健壮和稳定？是否有满足所有需求的模块？
*   nginx 与 apache 兼容吗？例如，我已经看到必须重写 .htaccess 文件...
*   我在 joomla 中的网站应该有问题吗？也许应该有与nginx不兼容的模块，组件或其他？

谢谢您的回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T14:44:12.357

这个系统是否健壮和稳定？是否有满足所有需求的模块？
答：是的，Nginx 非常好，稳定，几乎所有需要的模块

nginx 与 apache 兼容吗？例如我看到.htaccess 文件必须重写...
答：不，它不兼容，你需要重写nginx 配置文件中的所有规则。但我认为对于 joomla 来说并不难，你可以很容易地获得 joomla .htaccess 的示例 nginx conf 文件。

我在 joomla 中的网站应该有问题吗？也许应该有与nginx不兼容的模块，组件或其他？
答：对于 Joomla，您需要的是，只要适当的配置和站点就会生效。

**但**

我认为 Nginx 无法解决您的速度问题 :-(

Nginx 的性能几乎与您的 Joomla 相同，它适用于静态内容。根据我的个人经验，Joomla 本身对于大型数据库和用户群来说是一个非常大的问题.

我希望这会有所帮助

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T20:17:46.470

1.  是的——它很稳定，而且性能比 Apache 好得多（当然，如果配置正确的话）
2.  不，nginx 与 apache 不兼容 - 配置完全不同
3.  Joomla 由 PHP 解析器执行，因此如果您将运行与之前配置相同的 PHP 版本，您应该不会遇到任何问题。

# xml - 使用 xml::Twig 返回整个标签

> ID：11529899
> 
> 赞同：0
> 
> 时间：2012-07-17T19:53:52.637
> 
> 标签：xml, perl, xml-twig

如何使用 xml::twig 返回整个 xml 标记并将其保存到数组：

例如 ：

```
my @array=();
my $twig = XML::Twig->new(
twig_handlers => {
'data'=> sub {push @array, $_->xml_string;}

}); 
```

此代码返回所有嵌套标签，但没有标签本身及其属性，是否可以选择使用 xml::twig 返回整个标签并将其保存到变量？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T21:04:22.633

使用 XML::Twigs 方法`sprint`而不是`xml_string`. [文档](http://search.cpan.org/~mirod/XML-Twig/Twig.pm)说：

> xml_string @optional_options
> 
> ```
> Equivalent to $elt->sprint( 1), returns the string for the entire element, excluding the element's tags (but nested element tags are present) 
> ```

搜索该`sprint`函数会产生：

> 短跑
> 
> ```
> Return the text of the whole document associated with the twig. To be used only AFTER the parse. 
> ```

因此，您可以执行以下操作：

```
use strict;
use warnings;
use Data::Dumper;
use XML::Twig;

my @array=();
my $twig = XML::Twig->new(
twig_handlers => {
  'data'=> sub {push @array, $_->sprint;}
});

$twig->parse(qq~
  <xml>
        <data id="foo">
      <deep>
            <deeper>the deepest</deeper>
      </deep>
    </data>
  </xml>
~);

print Dumper \@array; 
```

哪个打印：

```
$VAR1 = [
          '<data id="foo"><deep><deeper>the deepest</deeper></deep></data>'
        ]; 
```

# jquery - 如何将 Json 对象转换为 Jquery 数组？

> ID：11529903
> 
> 赞同：1
> 
> 时间：2012-07-17T19:54:18.753
> 
> 标签：jquery, jquery-plugins

我通过 ajax 调用从 Web 方法中获取 Year 和 'NoOfOrders'。我想将 Json 对象转换为数组，以便可以使用 jqbargraph 进行绘图。

```
$(document).ready(function () {
    var myArray = [];
    $("[id$=btnSubmit]").click(function () {
        $.ajax({
            type: "POST",
            url: "Charts.aspx/GetOrderCount",
            data: "{}",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                var OrdersInfo = data.d;
                $.each(OrdersInfo, function (index, order) {
                    myArray.push(order.OrderYear, order.OrderCount);
                });
            }
        });
        $('#divChart').jqbargraph({
            data: myArray,
            position: 'bottom',
            animate: false
        });
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:58:52.677

尝试将一个数组而不是单独的值推送到`myArray`：

```
$.each(OrdersInfo, function (index, order) {
      myArray.push([order.OrderYear, order.OrderCount]);
}); 
```

# spring - 我正在尝试在我的 scala vaadin 应用程序中使用 spring 应用程序上下文和 spring di，但无法获取要注入的数据源

> ID：11529907
> 
> 赞同：0
> 
> 时间：2012-07-17T19:54:37.860
> 
> 标签：spring, scala, vaadin

我是 scala 和 vaadin 的新手，我只是在尝试。我正在尝试在我的 scala vaadin 应用程序中使用 spring 应用程序上下文和 spring di，但无法获取要注入的数据源。我不知道，也许我在做一些根本错误的事情，但这是我的代码：

web.xml

```
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>
        /WEB-INF/applicationContext.xml
    </param-value>
</context-param>

<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>

<context-param>
    <description>
    Vaadin production mode</description>
    <param-name>productionMode</param-name>
    <param-value>false</param-value>
</context-param>
<servlet>
    <servlet-name>Scalatest Application</servlet-name>
    <servlet-class>com.vaadin.terminal.gwt.server.ApplicationServlet</servlet-class>
    <init-param>
        <description>Vaadin application class to start</description>
        <param-name>application</param-name>
        <param-value>com.example.scalatest.ScalaApp</param-value>
    </init-param>
</servlet>
<servlet-mapping>
    <servlet-name>Scalatest Application</servlet-name>
    <url-pattern>/*</url-pattern>
</servlet-mapping> 
```

应用上下文：

```
<bean id="main" class="com.example.scalatest.ScalaApp">
    <property name="dataSource" ref="dataSource"/>
</bean>
<bean id="dataSource" destroy-method="close" class="org.apache.commons.dbcp.BasicDataSource">
    <property name="driverClassName" value="com.mysql.jdbc.Driver"/>
    <property name="url" value="url"/>
    <property name="username" value="root"/>
    <property name="password" value="pass"/>
</bean> 
```

在我的 scala 课上

```
var dataSource:DataSource = _;  
def setDataSource(datasource:DataSource){
dataSource = datasource;
} 
```

不工作， ds 在启动时为空。有人可以指导我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T01:06:56.263

您遇到的主要问题是**您的应用程序（ScalaApp）不是由 Spring 容器实例化，而是由 VaadinServlet 实例化**- 确保它确实如此。有几种策略。这是可以帮助您的示例项目：[https ://github.com/archiecobbs/dellroad-stuff-vaadin-spring-demo3](https://github.com/archiecobbs/dellroad-stuff-vaadin-spring-demo3)

还有几条建议...

无需自己编写 setter，而是**将 @BeanProperty 注释添加**到您的变量中。Scala 编译器将为您的变量生成 setter 和 getter：

```
@BeanProperty private var dataSource:DataSource = _ 
```

还有**更好的方法——使用 Spring 的基于注解的容器配置**。如果您的上下文中只有一个类型`DataSource`的 bean，只需添加`@Autowired`到您的变量中（不需要在上下文文件中定义 xml - 您的类应该注释为 @Component ）：

```
@Component
class ScalaApp {
   @Autowired private var dataSource:DataSource = _ 
} 
```

这里有更多信息：[http ://static.springsource.org/spring/docs/3.0.x/reference/beans.html#beans-annotation-config](http://static.springsource.org/spring/docs/3.0.x/reference/beans.html#beans-annotation-config)

# javascript - jQuery替换每个div中字符串中的字符和符号，逗号用€和€无

> ID：11529910
> 
> 赞同：1
> 
> 时间：2012-07-17T19:54:44.453
> 
> 标签：javascript, jquery, string, replace, split

所以这是场景：我有一堆像这样的“价格”类的跨度：12,99€</p>

我需要在昏迷后拆分美分，这样我就可以用 css 设置它的样式 -> 完成了，美分有自己的类“美分”

现在我正在尝试用€欧元符号替换逗号“，”，并删除末尾的€符号'将其替换为空，空）

我希望这是有道理的，这里有一个例子......：

现在怎么样：12,99€ 我需要什么：12€99

我现在的代码：

```
<!-- the html part CANNOT BE MODIFIED -->
<span class="price">29,49€&lt;/span>

<script>
jQuery(".price").each(function() {
var newText = jQuery(this).text().split(",").join("</span>,<sup class='cents'>");
newText = "<span class='euros'>" + newText + "</sup>";
jQuery(this).html(newText);
});

// Tryed to replace euro symbol by nothing but doesn't work //
var value = jQuery(".cents").val()+"";
value.replace("€", "");
var val = jQuery(".cents").val();
</script> 
```

如果有人可以在这里帮助我，我将非常感激，因为我真的很想学习如何实现这一目标。它看起来并不太复杂，但无法使其工作，这令人沮丧。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T19:57:23.400

```
$(".price").text( function(i, oldtext){
    return oldtext.replace("€","").replace(",","€")
}); 
```

[http://jsfiddle.net/8da54/9/](http://jsfiddle.net/8da54/9/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T20:01:39.753

如何改用以下内容：

```
$(".price").html(function(i, val) {
    val = val.split(",");
    return "<span class='euros'>" + val[0] + "</span>" + "€" +
        "<sup class='cents'>" + val[1].replace("€", "") + "</sup>";
}); 
```

**演示：http:** [//jsfiddle.net/8da54/11/](http://jsfiddle.net/8da54/11/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T20:12:30.593

你不需要使用`replace`，你可以使用`slice`or `substr`。

```
$(".price").html(function(i, oldVal) {
    var value = oldVal.split(",");
    return "<span class='euros'>" + value[0] + "€&lt;/span>" +
        "<sup class='cents'>" + value[1].slice(0, -1) + "</sup>";
}); 
```

[**演示**](http://jsfiddle.net/2hpVt/1/)

# mysql - 在插入语句 MySql 上将表 2 中的自动递增 ID 插入表 1

> ID：11529911
> 
> 赞同：0
> 
> 时间：2012-07-17T19:54:52.830
> 
> 标签：mysql, insert, inner-join, mysql-workbench

我在 MySql 中有一个存储过程，我试图将值插入到 Person_Table 中。Person_Table 中的一列是 CompanyID。

但我需要从中检索 CompanyID`Company_Table.CompanyID`是一个自动递增的主键。两个表也都有列`CompanyName`。我想`Company+Table.CompanyID`插入`Person_Table.CompanyID`中。

我在加入 2 个表时遇到问题。***您可以***在插入语句上连接表吗？

这是我到目前为止所拥有的，但它不喜欢内部连接：

```
 insert into person p
    (FarmName, FirstName, MiddleName, LastName, Phone, CompanyID)
    values
   ( oFarmName, oFirstName, oMiddleName, oLastName, oPhone, oCompanyID)   

    inner join company c on p.FarmNamne =  c.CompanyName
    where p.FarmName = c.CompanyID; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T21:09:05.223

如果我正确理解了您的问题，那么在重命名表和列以匹配您的信息后，这应该可以工作：

```
INSERT INTO Person_Table
(FarmName, FirstName, MiddleName, LastName, Phone, CompanyID)
VALUES
( oFarmName, oFirstName, oMiddleName, oLastName, oPhone, (
    SELECT c.CompanyId FROM Person_Table p 
    INNER JOIN Company_Table c ON c.CompanyName = p.CompanyName)
) 
```

这仅在没有重复的公司名称但试一试的情况下才有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T20:24:06.950

我无法回答是否可以插入内部连接，但我的感觉是不可能。

无论如何，为了提供一点帮助，我建议您以不同的方式解决这个问题：

你在你的第一张桌子上放一个触发器怎么样`AFTER INSERT`？此时，自动增量 id 是已知的，可以使用触发器轻松插入到表 2 中。

[http://dev.mysql.com/doc/refman/5.1/en/create-trigger.html](http://dev.mysql.com/doc/refman/5.1/en/create-trigger.html)

# ruby-on-rails - wicked_pdf 不呈现标题

> ID：11529912
> 
> 赞同：7
> 
> 时间：2012-07-17T19:55:05.757
> 
> 标签：ruby-on-rails, ruby, wicked-pdf

```
 render :pdf => "file_name",
                     :layout      => 'pdf.html.erb',
                     :template    => 'transactions/show.pdf.erb',
                      :wkhtmltopdf => WICKED_PDF_BIN,
                      :show_as_html => true,
                    :layout => 'pdf.html.erb',
                    :header => {:html => { :template => 'shared/header.pdf.erb'}} 
```

PDF 生成良好，不幸的是我没有看到标题。我可以将标题粘贴在主布局中，它也可以正常工作。在我看来，上面的标题行没有被处理。文件名“header.pdf.erb”似乎无关紧要。我可以将它指向一个不存在的文件并且它不会引发错误。

这是 Mac OS、Rails 3.2.1、ruby 1.9

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-10-11T17:12:09.833

您可能希望简单地将模板呈现为字符串并将其分配给标题的内容。试试这个：

```
header: {
  content: render_to_string(template: 'header.pdf.haml')
} 
```

这对我来说很有用。

# javascript - document-ready v/s body-ready v/s window-ready事件

> ID：11529916
> 
> 赞同：1
> 
> 时间：2012-07-17T19:55:21.067
> 
> 标签：javascript, javascript-events, event-handling, jquery

这三个事件有什么不同？

哪一个在其他之前/之后加载？

```
 <body> 
        <script type='text/javascript'> 
            $(document).ready(function(){
                console.log('Document %s',+new Date());
            });
            $('body').ready(function(){
                console.log('Body %s',+new Date());
            });
            $(window).ready(function(){
                console.log('Window %s',+new Date());
            }); 
        </script>
        <div>hello world</div>
    </body> 
```

奇怪的是，它们的触发顺序与我将它们放在代码上的顺序相同。对于当前示例。`document`一个先`windows`开火，一个最后开火。

ps 我已经阅读了[window.onload 与 <body onload=""/>](https://stackoverflow.com/questions/191157/window-onload-vs-body-onload)、 [window.onload 与 document.onload](https://stackoverflow.com/questions/588040/window-onload-vs-document-onload)以及其他一些内容。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-17T20:02:07.153

它们完全相同，实际上传递给的参数`$(...)`并不重要。

* * *

从**[jQuery 文档中关于`.ready`](http://api.jquery.com/ready/)**：

> ## .ready（处理程序）
> 
> **handler** - 在 DOM 准备好后执行的函数。

> 以下所有三种语法都是等效的：
> 
> *   `$(document).ready(handler)`
> *   `$().ready(handler)`（不建议这样做）
> *   `$(handler)`

> 该`.ready()`方法只能在匹配当前文档的 jQuery 对象上调用，因此可以省略选择器。

正如所见，参数（*选择器*）`$()`被明确地称为可选（当做时`$(...).ready`），因此我们可以安全地假设它与最终结果无关。

# apache-camel - 使用 Apache Camel Mina 组件实现请求-回复协议

> ID：11529918
> 
> 赞同：0
> 
> 时间：2012-07-17T19:55:25.633
> 
> 标签：apache-camel, apache-mina

我需要通过 TCP 为基于 XML-RPC 的服务实现消费者。在建立与服务器的连接时，它需要

1.  身份验证凭据由客户端发送
2.  客户端发送事件订阅请求，最后
3.  客户端将切换到“接收”模式，其中消息将异步发送
4.  当客户端不再对接收更多事件感兴趣时，客户端应该“放松”步骤 1-3。

因此，我想使用 Apache Camel 来实现客户端，具有明显的 Mina 组件入口端点（“mina:tcp:// *host* :_port_?textline=true&decoderMaxLineLength=10240&sync=true”）。我的问题是，我将如何实施上述步骤 1、2 和 4？在调用 RouteBuilder 中的处理器之前，我将如何执行这些“握手”步骤？骆驼甚至可以做到这一点，还是我必须编写一个直接的 Mina 客户端来处理这个问题。是否有更好的选择来处理这种类型的集成场景？

谢谢你。

-桑蒂

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T12:32:45.803

这是一个非常好的使用[Netty](http://netty.io)[实现会话握手协议的教程](http://biasedbit.com/handshaking-tutorial-with-netty/)，它与 Mina 非常相似。您可以使用[Camel 的 Netty 组件](http://camel.apache.org/netty.html)来实现这一点，或者参考教程使用 Mina 构建相同的组件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-08T00:05:51.307

可能为时已晚，但其他人可能需要答案。关键是您需要使用处理器。像这样的东西

```
from("mina:tcp:////host:_port_?textline=true&decoderMaxLineLength=10240&sync=true")  
.process(new Processor() {  
   public void process(Exchange exchange) throws Exception {  
     String inboundMessage =  exchange.getIn().getBody(String.class);  
     String outboundMessage = "echo:"+inboundMessage;
     exchange.getOut().setBody(outboundMessage);  
   }  
}).to(""mock:result""); 
```

outboundMessage 将是对表单端点的回复`mina:tcp:////host:_port_?textline=true&decoderMaxLineLength=10240&sync=true`

# android - Eclipse 内存分析器 - 帮助查找泄漏

> ID：11529920
> 
> 赞同：0
> 
> 时间：2012-07-17T19:55:27.703
> 
> 标签：android, eclipse, memory-management, memory-leaks, eclipse-memory-analyzer

我正在尝试在我的 Android 应用程序中查找内存泄漏。我有以下情况：

A 类创建了一个 A$24 类，它创建了一个线程。这个线程有一个类 A 的引用，所以这就是泄漏。我知道 A$24 是在 A 类中创建的匿名类，但我怎样才能找出在哪里创建，在代码中的哪一行。我的问题是了解谁是有问题的线程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T20:41:44.770

In the *project explorer* of the *resource perspective* use the view menu, select "Customize view..." and uncheck "Inner class files" and "Java output folders". Now you should see the generated class files in the project explorer in a "bin" folder.

If you navigate to your A$24.class file, you can open it using a double click. Look for lines at the top talking about field selectors, like this

```
 // Field descriptor #10 Z
  private final synthetic boolean val$fStartMinimized 
```

In this example, a final field *fStartMinimized* is used by the anonymous class (and therefore copied into the anonymous class). Using that field name you should be able to locate the anynomous class in question.

If there is no such field declaration (and also no method name giving you a clue), then you may get more insight with the [ByteCode outline plugin](http://andrei.gmxhome.de/bytecode/index.html) (but I've never used that myself).

# python - 如何获取可与 scapy 中的字段一起使用的值列表，例如 DHCP 的合法选项

> ID：11529922
> 
> 赞同：0
> 
> 时间：2012-07-17T19:55:39.077
> 
> 标签：python, scapy

如何获取scapy中图层的字段值列表？例如，是否有一种简单的方法可以查看所有可用于 DHCP 的“选项”字段的值（例如）？（我知道我可以挖掘对象的**dict**等。有更好的方法吗？）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T20:05:56.843

[源代码](http://trac.secdev.org/scapy/browser/scapy/layers/dhcp.py)通常是一个很好的查看位置，尤其是在文档稀疏的情况下。幸运的是，作者很友善地列举了 DHCP 选项`dhcp.DHCPOptions`

# jquery - jQuery选择框问题

> ID：11529924
> 
> 赞同：3
> 
> 时间：2012-07-17T19:55:43.720
> 
> 标签：jquery, html, list, drop-down-menu

我正在添加一个下拉列表并使用 .selectbox("attach") 将其转换为选择框。第二个以外的选项（除了电子产品，它让我选择电子产品）不允许我选择它们。这是附加命令生成的代码。

```
<div id="sbHolder_3628646" class="sbHolder"><a id="sbToggle_3628646" href="#" class="sbToggle"></a>
 <a id="sbSelector_3628646"
    href="#" class="sbSelector">Electronics</a>

    <ul id="sbOptions_3628646" class="sbOptions"
    style="top: 30px; max-height: 260px; display: none; ">
        <li><a href="# " rel=" "></a>
        </li>
        <li><a href="#1" rel="1">Electronics</a>
        </li>
        <li><a href="#2" rel="2">Tvs</a>
        </li>
        <li><a href="#3" rel="3">Plasma</a>
        </li>
        <li><a href="#4" rel="4">LED</a>
        </li>
    </ul>
</div> 
```

这是它生成它的代码

```
<select name="cat2" class="longinput" id="drop2" sb="3628646" style="display: none; ">
    <option value=" "></option>
    <option value="1">Electronics</option>
    <option value="2">Tvs</option>
    <option value="3">Plasma</option>
    <option value="4">LED</option>
</select> 
```

来自选择框的 jQuery

```
(function (jQuery, undefined) {
var PROP_NAME = 'selectbox',
    FALSE = false,
    TRUE = true;
/**
 * Selectbox manager.
 * Use the singleton instance of this class, jQuery.selectbox, to interact with the select box.
 * Settings for (groups of) select boxes are maintained in an instance object,
 * allowing multiple different settings on the same page
 */
function Selectbox() {
    this._state = [];
    this._defaults = { // Global defaults for all the select box instances
        classHolder: "sbHolder",
        classHolderDisabled: "sbHolderDisabled",
        classSelector: "sbSelector",
        classOptions: "sbOptions",
        classGroup: "sbGroup",
        classSub: "sbSub",
        classDisabled: "sbDisabled",
        classToggleOpen: "sbToggleOpen",
        classToggle: "sbToggle",
        speed: 200,
        effect: "slide", // "slide" or "fade"
        onChange: null, //Define a callback function when the selectbox is changed
        onOpen: null, //Define a callback function when the selectbox is open
        onClose: null //Define a callback function when the selectbox is closed
    };
}

jQuery.extend(Selectbox.prototype, {
    /**
     * Is the first field in a jQuery collection open as a selectbox
     * 
     * @param {Object} target
     * @return {Boolean}
     */
    _isOpenSelectbox: function (target) {
        if (!target) {
            return FALSE;
        }
        var inst = this._getInst(target);
        return inst.isOpen;
    },
    /**
     * Is the first field in a jQuery collection disabled as a selectbox
     * 
     * @param {HTMLElement} target
     * @return {Boolean}
     */
    _isDisabledSelectbox: function (target) {
        if (!target) {
            return FALSE;
        }
        var inst = this._getInst(target);
        return inst.isDisabled;
    },
    /**
     * Attach the select box to a jQuery selection.
     * 
     * @param {HTMLElement} target
     * @param {Object} settings
     */
    _attachSelectbox: function (target, settings) {
        if (this._getInst(target)) {
            return FALSE;
        }
        var jQuerytarget = jQuery(target),
            self = this,
            inst = self._newInst(jQuerytarget),
            sbHolder, sbSelector, sbToggle, sbOptions,
            s = FALSE, optGroup = jQuerytarget.find("optgroup"), opts = jQuerytarget.find("option"), olen = opts.length;

        jQuerytarget.attr("sb", inst.uid);

        jQuery.extend(inst.settings, self._defaults, settings);
        self._state[inst.uid] = FALSE;
        jQuerytarget.hide();

        function closeOthers() {
            var key, uid = this.attr("id").split("_")[1];
            for (key in self._state) {
                if (key !== uid) {
                    if (self._state.hasOwnProperty(key)) {
                        if (jQuery(":input[sb='" + key + "']")[0]) {
                            self._closeSelectbox(jQuery(":input[sb='" + key + "']")[0]);
                        }
                    }
                }
            }
        }

        sbHolder = jQuery("<div>", {
            "id": "sbHolder_" + inst.uid,
            "class": inst.settings.classHolder
        });

        sbSelector = jQuery("<a>", {
            "id": "sbSelector_" + inst.uid,
            "href": "#",
            "class": inst.settings.classSelector,
            "click": function (e) {
                e.preventDefault();
                closeOthers.apply(jQuery(this), []);
                var uid = jQuery(this).attr("id").split("_")[1];
                if (self._state[uid]) {
                    self._closeSelectbox(target);
                } else {
                    self._openSelectbox(target);
                }
            }
        });

        sbToggle = jQuery("<a>", {
            "id": "sbToggle_" + inst.uid,
            "href": "#",
            "class": inst.settings.classToggle,
            "click": function (e) {
                e.preventDefault();
                closeOthers.apply(jQuery(this), []);
                var uid = jQuery(this).attr("id").split("_")[1];
                if (self._state[uid]) {
                    self._closeSelectbox(target);
                } else {
                    self._openSelectbox(target);
                }
            }
        });
        sbToggle.appendTo(sbHolder);

        sbOptions = jQuery("<ul>", {
            "id": "sbOptions_" + inst.uid,
            "class": inst.settings.classOptions,
            "css": {
                "display": "none"
            }
        });

        jQuerytarget.children().each(function(i) {
            var that = jQuery(this), li, config = {};
            if (that.is("option")) {
                getOptions(that);
            } else if (that.is("optgroup")) {
                li = jQuery("<li>");
                jQuery("<span>", {
                    "text": that.attr("label")
                }).addClass(inst.settings.classGroup).appendTo(li);
                li.appendTo(sbOptions);
                if (that.is(":disabled")) {
                    config.disabled = true;
                }
                config.sub = true;
                getOptions(that.find("option"), config);
            }
        });

        function getOptions () {
            var sub = arguments[1] && arguments[1].sub ? true : false,
                disabled = arguments[1] && arguments[1].disabled ? true : false;
            arguments[0].each(function (i) {
                var that = jQuery(this),
                    li = jQuery("<li>"),
                    child;
                if (that.is(":selected")) {
                    sbSelector.text(that.text());
                    s = TRUE;
                }
                if (i === olen - 1) {
                    li.addClass("last");
                }
                if (!that.is(":disabled") && !disabled) {
                    child = jQuery("<a>", {
                        "href": "#" + that.val(),
                        "rel": that.val(), 
                        "text": that.text(),
                        "click": function (e) {
                            e.preventDefault();
                            var t = sbToggle,
                                uid = t.attr("id").split("_")[1];
                            self._changeSelectbox(target, jQuery(this).attr("rel"), jQuery(this).text());
                            self._closeSelectbox(target);
                        }
                    });
                    if (sub) {
                        child.addClass(inst.settings.classSub);
                    }
                    child.appendTo(li);
                } else {
                    child = jQuery("<span>", {
                        "text": that.text()
                    }).addClass(inst.settings.classDisabled);
                    if (sub) {
                        child.addClass(inst.settings.classSub);
                    }
                    child.appendTo(li);
                }
                li.appendTo(sbOptions);
            });
        }

        if (!s) {
            sbSelector.text(opts.first().text());
        }

        jQuery.data(target, PROP_NAME, inst);

        sbSelector.appendTo(sbHolder);
        sbOptions.appendTo(sbHolder);           
        sbHolder.insertAfter(jQuerytarget);
    },
    /**
     * Remove the selectbox functionality completely. This will return the element back to its pre-init state.
     * 
     * @param {HTMLElement} target
     */
    _detachSelectbox: function (target) {
        var inst = this._getInst(target);
        if (!inst) {
            return FALSE;
        }
        jQuery("#sbHolder_" + inst.uid).remove();
        jQuery.data(target, PROP_NAME, null);
        jQuery(target).show();          
    },
    /**
     * Change selected attribute of the selectbox.
     * 
     * @param {HTMLElement} target
     * @param {String} value
     * @param {String} text
     */
    _changeSelectbox: function (target, value, text) {
        var inst = this._getInst(target),
            onChange = this._get(inst, 'onChange');
        jQuery("#sbSelector_" + inst.uid).text(text);
        jQuery(target).find("option[value='" + value + "']").attr("selected", TRUE);
        if (onChange) {
            onChange.apply((inst.input ? inst.input[0] : null), [value, inst]);
        } else if (inst.input) {
            inst.input.trigger('change');
        }
    },
    /**
     * Enable the selectbox.
     * 
     * @param {HTMLElement} target
     */
    _enableSelectbox: function (target) {
        var inst = this._getInst(target);
        if (!inst || !inst.isDisabled) {
            return FALSE;
        }
        jQuery("#sbHolder_" + inst.uid).removeClass(inst.settings.classHolderDisabled);
        inst.isDisabled = FALSE;
        jQuery.data(target, PROP_NAME, inst);
    },
    /**
     * Disable the selectbox.
     * 
     * @param {HTMLElement} target
     */
    _disableSelectbox: function (target) {
        var inst = this._getInst(target);
        if (!inst || inst.isDisabled) {
            return FALSE;
        }
        jQuery("#sbHolder_" + inst.uid).addClass(inst.settings.classHolderDisabled);
        inst.isDisabled = TRUE;
        jQuery.data(target, PROP_NAME, inst);
    },
    /**
     * Get or set any selectbox option. If no value is specified, will act as a getter.
     * 
     * @param {HTMLElement} target
     * @param {String} name
     * @param {Object} value
     */
    _optionSelectbox: function (target, name, value) {
        var inst = this._getInst(target);
        if (!inst) {
            return FALSE;
        }
        //TODO check name
        inst[name] = value;
        jQuery.data(target, PROP_NAME, inst);
    },
    /**
     * Call up attached selectbox
     * 
     * @param {HTMLElement} target
     */
    _openSelectbox: function (target) {
        var inst = this._getInst(target);
        //if (!inst || this._state[inst.uid] || inst.isDisabled) {
        if (!inst || inst.isOpen || inst.isDisabled) {
            return;
        }
        var el = jQuery("#sbOptions_" + inst.uid),
            viewportHeight = parseInt(jQuery(window).height(), 10),
            offset = jQuery("#sbHolder_" + inst.uid).offset(),
            scrollTop = jQuery(window).scrollTop(),
            height = el.prev().height(),
            diff = viewportHeight - (offset.top - scrollTop) - height / 2,
            onOpen = this._get(inst, 'onOpen');
        el.css({
            "top": height + "px",
            "maxHeight": (diff - height) + "px"
        });
        inst.settings.effect === "fade" ? el.fadeIn(inst.settings.speed) : el.slideDown(inst.settings.speed);
        jQuery("#sbToggle_" + inst.uid).addClass(inst.settings.classToggleOpen);
        this._state[inst.uid] = TRUE;
        inst.isOpen = TRUE;
        if (onOpen) {
            onOpen.apply((inst.input ? inst.input[0] : null), [inst]);
        }
        jQuery.data(target, PROP_NAME, inst);
    },
    /**
     * Close opened selectbox
     * 
     * @param {HTMLElement} target
     */
    _closeSelectbox: function (target) {
        var inst = this._getInst(target);
        //if (!inst || !this._state[inst.uid]) {
        if (!inst || !inst.isOpen) {
            return;
        }
        var onClose = this._get(inst, 'onClose');
        inst.settings.effect === "fade" ? jQuery("#sbOptions_" + inst.uid).fadeOut(inst.settings.speed) : jQuery("#sbOptions_" + inst.uid).slideUp(inst.settings.speed);
        jQuery("#sbToggle_" + inst.uid).removeClass(inst.settings.classToggleOpen);
        this._state[inst.uid] = FALSE;
        inst.isOpen = FALSE;
        if (onClose) {
            onClose.apply((inst.input ? inst.input[0] : null), [inst]);
        }
        jQuery.data(target, PROP_NAME, inst);
    },
    /**
     * Create a new instance object
     * 
     * @param {HTMLElement} target
     * @return {Object}
     */
    _newInst: function(target) {
        var id = target[0].id.replace(/([^A-Za-z0-9_-])/g, '\\\\jQuery1');
        return {
            id: id, 
            input: target, 
            uid: Math.floor(Math.random() * 99999999),
            isOpen: FALSE,
            isDisabled: FALSE,
            settings: {}
        }; 
    },
    /**
     * Retrieve the instance data for the target control.
     * 
     * @param {HTMLElement} target
     * @return {Object} - the associated instance data
     * @throws error if a jQuery problem getting data
     */
    _getInst: function(target) {
        try {
            return jQuery.data(target, PROP_NAME);
        }
        catch (err) {
            throw 'Missing instance data for this selectbox';
        }
    },
    /**
     * Get a setting value, defaulting if necessary
     * 
     * @param {Object} inst
     * @param {String} name
     * @return {Mixed}
     */
    _get: function(inst, name) {
        return inst.settings[name] !== undefined ? inst.settings[name] : this._defaults[name];
    }
});

/**
 * Invoke the selectbox functionality.
 * 
 * @param {Object|String} options
 * @return {Object}
 */
jQuery.fn.selectbox = function (options) {

    var otherArgs = Array.prototype.slice.call(arguments, 1);
    if (typeof options == 'string' && options == 'isDisabled') {
        return jQuery.selectbox['_' + options + 'Selectbox'].apply(jQuery.selectbox, [this[0]].concat(otherArgs));
    }

    if (options == 'option' && arguments.length == 2 && typeof arguments[1] == 'string') {
        return jQuery.selectbox['_' + options + 'Selectbox'].apply(jQuery.selectbox, [this[0]].concat(otherArgs));
    }

    return this.each(function() {
        typeof options == 'string' ?
            jQuery.selectbox['_' + options + 'Selectbox'].apply(jQuery.selectbox, [this].concat(otherArgs)) :
            jQuery.selectbox._attachSelectbox(this, options);
    });
};

jQuery.selectbox = new Selectbox(); // singleton instance
jQuery.selectbox.version = "0.1.3";
})(jQuery); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-28T09:22:09.597

我遇到了同样的问题，只是在`_changeSelectbox()`函数中添加了一行。

在第 345 行周围应该有以下行：

```
$(target).find("option[value='" + value + "']").attr("selected", TRUE); 
```

在此**之前**，我添加了以下内容：

```
$(target).find("option").attr("selected", FALSE); 
```

因此，当它触发`_changeSelectbox()`函数并设置选定属性时，它首先删除任何现有的选定属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T20:36:41.067

他们推出了修复此错误的更新！ [http://www.bulgaria-web-developers.com/projects/javascript/selectbox/](http://www.bulgaria-web-developers.com/projects/javascript/selectbox/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T07:06:03.907

创建一个 div 或 span 分配 id 名称键同时创建任何人弹出给 id 名称 key_con，当您单击键弹出将显示。再次单击该键弹出将隐藏。

# wordpress - Wordpress 内置分页不起作用

> ID：11529927
> 
> 赞同：-2
> 
> 时间：2012-07-17T19:55:51.287
> 
> 标签：wordpress, pagination

在 Wordpress 阅读选项中，我将其设置为索引最多只显示 2 个帖子。但是，缺少下一页和上一页按钮。我进入我的模板，尝试了默认方法，但它们都不起作用。

我尝试添加

```
<?php posts_nav_link(); ?> 
```

没用。然后我尝试了

```
<div class="navigation">
  <div class="alignleft"><?php next_posts_link('« Previous Entries') ?></div>
  <div class="alignright"><?php previous_posts_link('Next Entries »') ?></div>
</div> 
```

这也没有奏效。最后一页的源代码中根本没有出现任何内容。这些是默认的 Wordpress 功能，对吧？这里出了什么问题？

如果它有任何用处，这里是 index.php

```
<?php get_header(); ?>

<section class="content">
    <ul class="items wrap">
        <?php if (have_posts()) : while (have_posts()) : the_post(); ?>
        <h1><?php the_title(); ?></h1>
        <h4><?php the_time('F jS, Y') ?></h4>
        <p><?php the_content(__('(more...)')); ?></p>
        <hr>
        <?php endwhile; else: ?>
        <p><?php _e('Sorry, we couldn’t find the post you are looking for.'); ?></p>
        <?php endif; ?>
        <!-- I added the pagination code here. -->
    </ul>
</section>

<div id="delimiter"></div>

<?php get_footer(); ?> 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T12:31:58.680

原来只有两个帖子要显示，所以它当然没有显示下一个/上一个链接。就这样，问题解决了。

# regex - 正则表达式非贪婪匹配与制表符

> ID：11529928
> 
> 赞同：1
> 
> 时间：2012-07-17T19:55:59.127
> 
> 标签：regex, vi

我不明白为什么如果给出以下行（vi with set list on）

```
10.0.6.5^IVirtual^IVmware^IHTTP, MS SQL, Windows SVC^IcpHelpdesk $ 
```

为什么使用以下正则表达式：

```
^I.*?^I 
```

与我上面的行中的字符串“虚拟”不匹配？我在 VI 搜索和替换中使用下面的正则表达式

```
:%s/^I.*?^I/replace/g 
```

如果我使用，这将在同一字符串上返回不匹配

```
^I.*^I 
```

我会得到

```
10.0.6.5replaceIcpHelpdesk $ 
```

我试图说的`^I.*?^I`是从第一个制表符（`^I`）匹配任何内容（除了换行符之外的点）零次或多次（`*?`），直到你来到下一个标记是制表符（`^I`）

我没有看到我错过了什么，任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T20:14:24.023

你在这里谈论 vim 正则表达式吗？在这种情况下，非贪婪量词是`\{-}`：

```
\t.\{-}\t 
```

否则，您可以通过不将制表符与否​​定组匹配来做到这一点：

```
\t[^\t]*\t 
```

# ruby-on-rails - 创建一个简单的路线

> ID：11529931
> 
> 赞同：0
> 
> 时间：2012-07-17T19:56:17.833
> 
> 标签：ruby-on-rails, custom-routes

我在创建正确的路线时遇到问题。我想传入我正在处理的元素的 id，但它看起来不正确。

我的路线看起来像

```
resources :accounts
  match 'account-audit' => 'accounts#audited',:as => :accountaudit 
```

当我耙路线时，我得到

```
 accounts GET    /accounts(.:format)                          accounts#index
                   POST   /accounts(.:format)                          accounts#create
       new_account GET    /accounts/new(.:format)                      accounts#new
      edit_account GET    /accounts/:id/edit(.:format)                 accounts#edit
           account GET    /accounts/:id(.:format)                      accounts#show
                   PUT    /accounts/:id(.:format)                      accounts#update
                   DELETE /accounts/:id(.:format)                      accounts#destroy
      accountaudit        /account-audit(.:format)                     accounts#audited 
```

当我转到页面时，链接看起来

> 本地主机：3000/account-audit.3

它应该看起来像

> 本地主机：3000/帐户/3/审计

我如何让我的路线做我需要做的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-21T23:34:10.053

看起来您正在尝试做的是嵌套路由，这将为您提供用于帐户内部审计的宁静路由

```
resources :accounts do
  resources :audit
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T20:01:43.393

你需要像这样声明路由

```
resources :accounts do
  get :audit, on: :member, as: :accountaudit
end 
```

这将生成像`localhost:3000/accounts/account_id/audit`. 检查[这个 stackoverlow 问题](https://stackoverflow.com/questions/3028653/difference-between-collection-route-and-member-route-in-ruby-on-rails)以了解成员和集合路由。

# haskell - setPosition 是如何工作的？

> ID：11529932
> 
> 赞同：1
> 
> 时间：2012-07-17T19:56:17.990
> 
> 标签：haskell, parsec

我不确定如何使用[`setPosition`](http://hackage.haskell.org/packages/archive/parsec/3.1.3/doc/html/Text-Parsec-Prim.html#v%3asetPosition)（Parsec 库）。这是一段非常简单的代码，它应该读取文本第二行的前 3 个字符。

```
import Text.ParserCombinators.Parsec

content = ["This is the first line",
           "and this is the second one",
           "not to talk about the third one"]

txt = unlines content

main = parseTest myPar txt

myPar = getPosition >>= \oldPos ->
        let newPos = setSourceLine oldPos 2 in
        setPosition newPos >>
        count 3 anyChar 
```

尽管如此，输出是“Thi”而不是“and”，正如我所期望的那样......我觉得我错过了一些非常简单的东西，但是唉，我不知道是什么；你能帮助我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T20:34:15.417

该`setPosition`函数更改 Parsec 报告错误的位置，但不影响解析*实际在标记流中的位置*。它被用作需要做花哨的事情的后端的原语：必须报告其他文件中位置的预处理器，对非`Char`标记流进行操作的解析器等等。

# python - 为什么这两种 append 方法会产生不同的结果？

> ID：11529933
> 
> 赞同：-1
> 
> 时间：2012-07-17T19:56:18.930
> 
> 标签：python, list, append

> **可能的重复：**
> [Python 中的“Least Astonishment”：可变默认参数](https://stackoverflow.com/questions/1132941/least-astonishment-in-python-the-mutable-default-argument)

我试图了解以下两种方法之间的区别：

```
def first_append(new_item, a_list=[]):
    a_list.append(new_item)
    return a_list

def second_append(new_item, a_list=None):
    if a_list is None:
        a_list = []
    a_list.append(new_item)
    return a_list 
```

`first_append``a_list`多次调用时不断增加，导致它增长。但是，`second_append`总是返回一个长度为 1 的列表。这里有什么区别？

例子：

```
>>> first_append('one')
['one']
>>> first_append('two')
['one', 'two']
>>> second_append('one') 
['one']
>>> second_append('two')
['two'] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T20:00:22.097

`second_append`每次调用函数时，它总是为您创建一个新的本地列表。

# ios - GLONASS 数据和越狱 iOS

> ID：11529934
> 
> 赞同：3
> 
> 时间：2012-07-17T19:56:22.603
> 
> 标签：ios, gps, cllocationmanager, jailbreak

是否有编程方式可以在越狱设备上访问 iOS 上的 GLONASS 卫星信号和位置数据？也就是说，是否可以在越狱设备上进行私人通话，并返回此数据？（就我所尝试的而言，我没有越狱设备，所以我还不能尝试任何东西，但我很好奇那里有什么可能。谢谢。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T01:03:20.597

即使您的设备没有越狱，您仍然可以**看到**越狱设备可以使用的功能……您只是还不能**完全**测试它。

在您的开发 Mac 上，您拥有完整的框架，包括公共的和私有的，您可以使用诸如[class-dump](http://www.codethecode.com/projects/class-dump/)（或 class-dump-z）之类的东西来检查它们。

下载 class-dump，然后在您的 Mac 上，您可以使用这样的脚本（将所有标题转储到 /Users/Shared/Headers/ 下的文件夹中）：

```
#!/bin/bash
cd /Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS5.0.sdk/;

for FRAMEWORKS in Frameworks PrivateFrameworks; do
 frameworklib=./System/Library/"${FRAMEWORKS}"
 for frameworkpath in "${frameworklib}"/*.framework; do
   frameworkdir="$(basename "${frameworkpath}")"
   frameworkbin="${frameworkdir%.*}"
   if [ -f "${frameworkpath}/${frameworkbin}" ]; then
     echo "Framework: ${frameworkbin}"
     mkdir -p /Users/Shared/Headers/5.0/${frameworkbin}
     class-dump -H -o "/Users/Shared/Headers/5.0/${frameworkbin}" "${frameworkpath}/${frameworkbin}"
   fi
 done
done 
```

然后，您将看到不仅显示公开记录的 API，还显示私有 API 的标头。完全私有的框架和公共框架的私有部分**。**

然后，我只需转到此脚本转储 .h 文件的根文件夹，然后开始 grepping：

```
> find . -name '*.h' | xargs grep -i GLONASS 
```

遗憾的是，该术语 (GLONASS) 没有出现在 5.0 的标题中，但听起来您似乎了解这个问题域，您可能会找到一些更好的术语来搜索。

不幸的是，标头只包含方法原型和数据定义。没有文档。因此，例如，在有`int`参数的地方，您可能需要对它们的含义进行一些猜测。

但是，这就是发现隐藏设备功能的试错性质:)

**注意：**您当然可以在您自己的非越狱手机上测试*一些私有API，在通过上述过程发现它们之后。*但是，如果设备没有越狱、应用程序退出其沙盒、或者可能具有 root 权限或其他权利，其他 API 将无法工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T21:57:17.553

Well, for starters you are looking in the right direction: if you don't jailbreak you'll have access to Core Location framework & API that can give you location, precision etc, but no info from GPS/GLONASS receiver (not even which of them was used to get location).

But before you go digging around inside framework: do you need to access build in GPS/GLONASS receiver or is external bluetooth one acceptable? Have a look [http://itunes.apple.com/us/app/bluetooth-gps-status-tool/id422661436?mt=8](http://itunes.apple.com/us/app/bluetooth-gps-status-tool/id422661436?mt=8)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T07:38:43.380

iPhone 4S 支持 AGPS 和 GLONASS。我相信核心位置管理较低级别的通信，并且我的应用程序不关心纬度/经度数据是来自美国 GPS 卫星还是俄罗斯 GLONASS 卫星。无论如何，核心位置都会为您提供正确的纬度/经度信息。

更新：重读您的问题后，也许我误解了开始的问题。我认为您将无法访问 GLONASS 卫星信号和位置。但祝你好运！

# google-maps - Google Maps API V3：基于搜索创建标记 HTML if/else

> ID：11529939
> 
> 赞同：1
> 
> 时间：2012-07-17T19:56:48.240
> 
> 标签：google-maps, google-maps-api-3, google-geocoding-api

我在这里有一个“商店定位器”设置：

[http://www.brynei.com/fertdealer_map_bry.htm](http://www.brynei.com/fertdealer_map_bry.htm)

lat、lng、姓名、地址、csz 和电话信息存储在 mySQL 数据库中。如果您输入邮政编码 13165，定位器将正常工作。但是，我需要限制一系列邮政编码以显示一个标记，并为一系列邮政编码（66000 到 69999）显示标记 html。这部分实际上是使用函数 searchLocations() 部分使地图居中，但我需要函数 createMarker(latlng, name, address, csz, phone) 和函数 createOption(name, distance, num) 部分的帮助。

目前，如果您使用邮政编码 67501，地图将居中，但不显示任何标记。我需要它在特定位置放置标记，并将 Company Name Inc, 123 Main St, Anywhere KS 67501, 555-555-1234 作为标记 HTML。如果在 66000 到 69999 范围内使用 zip，则该标记将是静态的。

如果这是一个更简单的解决方案，我也可以在数据库方面做一些事情。

任何帮助表示赞赏。

这些是我遇到问题的 3 个部分（功能）：

```
function searchLocations() {
var address = document.getElementById("addressInput").value;
var mylatlng = new google.maps.LatLng(37.928552, -97.898658);
var geocoder = new google.maps.Geocoder();
   if (address >= 66000 && address <= 69999) {
       map.setCenter(mylatlng);
       map.setZoom(10);        }
       else { 
           geocoder.geocode({address: address}, function(results, status) {       
            if (status == google.maps.GeocoderStatus.OK) {
               searchLocationsNear(results[0].geometry.location);   } 
    else {
        alert(address + ' not found');
   }
 });
 }}

function createMarker(latlng, name, address, csz, phone) {
  var html = "<font face = 'arial'>" + "<b>" + name + "</b> <br/>" + address + "<br/>" + csz + "<br/>" + phone + "</font>";
  var marker = new google.maps.Marker({
    map: map,
    position: latlng
  });
  google.maps.event.addListener(marker, 'click', function() {
    infoWindow.setContent(html);
    infoWindow.open(map, marker);
  });
  markers.push(marker);
} 

function createOption(name, distance, num) {
  var option = document.createElement("option");
  option.value = num;
  option.innerHTML = name + "(" + distance.toFixed(1) + ")";
  locationSelect.appendChild(option);
} 
```

# image - 带有 JPG 扩展名的文件就像一个 GIF，其中有一只猫用枪射击，回扣很重

> ID：11529941
> 
> 赞同：17
> 
> 时间：2012-07-17T19:56:56.857
> 
> 标签：image, gif, jpeg, file-extension

我最近遇到了这张看起来像普通 GIF 的图片：

![似乎是 gif 图像](../Images/46fe45527bc5e1e703b3982ef323d1fe.png)

当我上传到这里时，甚至[imgur 都将它存储为 GIF。](http://imgur.com/)

但是当我看到链接时，它是一个 JPEG 图像，不像我预期的 GIF！

这是链接：[https ://fbcdn-sphotos-a.akamaihd.net/hphotos-ak-ash3/559307_325955130827518_630404691_n.jpg](https://fbcdn-sphotos-a.akamaihd.net/hphotos-ak-ash3/559307_325955130827518_630404691_n.jpg)

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-07-17T19:58:11.693

这实际上是一个 .gif - 查看 HTTP 响应的标头。

[MIME 类型](http://en.wikipedia.org/wiki/Internet_media_type)是image/gif

因此，URL 最后说什么并不重要——决定浏览器如何解释它的是 MIME 类型。

例如，很多网站都使用这个（我猜是为了甩掉收割机？）imgur.com 经常报告错误的扩展名。尝试去`i.imgur.com/yourpic.txt`- 它仍应显示为正确的 gif。

# asp.net - Facebook 登录弹出窗口不会在 Windows 8 上的 IE10 中关闭

> ID：11529942
> 
> 赞同：0
> 
> 时间：2012-07-17T19:57:02.583
> 
> 标签：asp.net, facebook, facebook-graph-api, internet-explorer-10

我正在处理的网站使用 Facebook Javascript SDK，如此处所述[https://developers.facebook.com/docs/reference/javascript/](https://developers.facebook.com/docs/reference/javascript/)，以允许用户登录。该站点是一个 ASP.NET MVC 站点。

它适用于最新版本的 Chrome、Firefox、Safari 和 IE9。

但是，在使用 IE10 的 Windows 8 消费者预览版中（在正常和兼容模式下）登录 Facebook 时，弹出窗口会变白并且不会关闭。如果手动关闭并刷新原始页面，我会看到我已登录。

我查看了所有其他 SO 问题并搜索了网络。我已经尝试了所有解决方案，但没有一个有效。

我正确使用了 channelUrl，它可以在其他浏览器中使用。我还在这里尝试了 IE10 错误修复[http://www.hanselman.com/blog/BugAndFixASPNETFailsToDetectIE10CausingDoPostBackIsUndefinedJavaScriptErrorOrMaintainFF5ScrollbarPosition.aspx](http://www.hanselman.com/blog/BugAndFixASPNETFailsToDetectIE10CausingDoPostBackIsUndefinedJavaScriptErrorOrMaintainFF5ScrollbarPosition.aspx)

与我的代码和 Facebook 示例确实没有太大区别。所以我认为在使用 IE10 时，IE10 或 Facebook API 存在问题。

有没有人遇到过类似的问题并找到了解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T09:11:14.787

问题出在 HTML 中。http-equiv 的元标记设置为

```
<meta http-equiv="X-UA-Compatible" value="IE=8"> 
```

这会导致 IE10 以 IE8 模式显示网页。将其更改为 9，并且 Facebook 弹出框消失。

# asp.net - 分页列表不起作用

> ID：11529946
> 
> 赞同：0
> 
> 时间：2012-07-17T19:57:17.553
> 
> 标签：asp.net, asp.net-mvc-3, pagedlist

我完成了 Rick Anderson 的 ASP.NET MVC 3 (C#) 入门教程，它是一个产品目录，已经在工作，但是，由于我添加了很长的产品列表，现在我需要一个 pagedList 来获取一个数字每页的产品数量，环顾四周，我找到了一个示例，但没有工作，我在模型文件中添加了这个名为 IPagedList.cs 的类

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;

namespace Presupuestos.Models
{
    public interface IPagedList
    {
        int ItemCount
        {
            get;
            set;
        }

        int PageCount
        {
            get;
            set;
        }

        int PageIndex
        {
            get;
            set;
        }

        int PageSize
        {
            get;
            set;
        }

        bool IsPreviousPage
        {
            get;
        }

        bool IsNextPage
        {
            get;
        }
    }

    public interface IPagedList<T> : IList<T>, IPagedList
    {
    }

    public class PagedList<T> : List<T>, IPagedList<T>
    {
        private List<Productos> list;
        private int p;
        private int p_2;

        public PagedList(IQueryable<T> source, int index, int pageSize)
        {
            this.ItemCount = source.Count();
            this.PageSize = pageSize;
            this.PageIndex = index;
            this.AddRange(source.Skip(index * pageSize).Take(pageSize).ToList());
            this.PageCount = (int)Math.Ceiling((double)this.ItemCount / this.PageSize);
        }

        public PagedList(List<T> source, int index, int pageSize)
        {
            this.ItemCount = source.Count();
            this.PageSize = pageSize;
            this.PageIndex = index;
            this.AddRange(source.Skip(index * pageSize).Take(pageSize).ToList());
        }

        public PagedList(List<Productos> list, int p, int p_2)
        {
            // TODO: Complete member initialization
            this.list = list;
            this.p = p;
            this.p_2 = p_2;
        }

        public int ItemCount
        {
            get;
            set;
        }

        public int PageCount
        {
            get;
            set;
        }

        public int PageIndex
        {
            get;
            set;
        }

        public int PageSize
        {
            get;
            set;
        }

        public bool IsPreviousPage
        {
            get
            {
                return (PageIndex > 0);
            }
        }

        public bool IsNextPage
        {
            get
            {
                return (PageIndex + 1) * PageSize <= ItemCount;
            }
        }
    }

    public static class Pagination
    {
        public static PagedList<T> ToPagedList<T>(this IQueryable<T> source, int index, int pageSize)
        {
            return new PagedList<T>(source, index, pageSize);
        }

        public static PagedList<T> ToPagedList<T>(this IQueryable<T> source, int index)
        {
            return new PagedList<T>(source, index, 10);
        }
    }
} 
```

另外，我添加了另一个名为 HTMLHelpers.cs 的类：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using System.Text;
using Presupuestos.Models;

namespace Presupuestos.Models
{
    public static class ListPaging
    {
        public static MvcHtmlString Paging(this HtmlHelper html, IPagedList pagedList, string url, string pagePlaceHolder)
        {
            StringBuilder sb = new StringBuilder();
            // only show paging if we have more items than the page size
            if (pagedList.ItemCount > pagedList.PageSize)
            {
                sb.Append("<ul class=\"paging\">");
                if (pagedList.IsPreviousPage && pagedList.PageIndex != 1)
                {
                    // previous link
                    sb.Append("<li class=\"prev\"><a href=\"");
                    sb.Append(url.Replace(pagePlaceHolder, (pagedList.PageIndex - 1).ToString()));
                    sb.Append("\" title=\"Go to Previous Page\">prev</a></li>");
                }
                for (int i = 0; i < pagedList.PageCount; i++)
                {
                    sb.Append("<li>");
                    if (i == pagedList.PageIndex)
                    {
                        sb.Append("<span>").Append((i + 1).ToString()).Append("</span>");
                    }
                    else
                    {
                        sb.Append("<a href=\"");
                        sb.Append(url.Replace(pagePlaceHolder, (i + 1).ToString()));
                        sb.Append("\" title=\"Go to Page ").Append((i + 1).ToString());
                        sb.Append("\">").Append((i + 1).ToString()).Append("</a>");
                    }
                    sb.Append("</li>");
                }
                if (pagedList.IsNextPage)
                {
                    // next link
                    sb.Append("<li class=\"next\"><a href=\"");
                    sb.Append(url.Replace(pagePlaceHolder, (pagedList.PageIndex + 1).ToString()));
                    sb.Append("\" title=\"Go to Next Page\">next</a></li>");
                }
                sb.Append("</ul>");
            }
            return MvcHtmlString.Create(sb.ToString());
        }
    }
} 
```

最后这是视图文件，我刚刚添加了@using presupuestos.models 和最后一个 html.paging：

```
@model IEnumerable<Presupuestos.Models.Productos>        
@using Presupuestos.Models

@{
    ViewBag.Title = "Productos";
}

<h2>Catalogo de Productos</h2>

<p>
    @Html.ActionLink("Agregar Producto", "Create")
</p>
<table>
    <tr>
        <th>
            Marca
        </th>
        <th>
            Codigo
        </th>
        <th>
            Nombre
        </th>
        <th>
            Envase
        </th>
        <th>
            Presentación
        </th>
        <th>
            Linea
        </th>
        <th>
            Categoria
        </th>
        <th></th>
    </tr>

@foreach (var item in Model)
{
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.marca)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.codigo)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.nombre)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.envase)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.presentación)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.linea)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.categoria)
        </td>
        <td>
            @Html.ActionLink("Editar", "Edit", new { id = item.ID }) |
            @Html.ActionLink("Detalles", "Details", new { id = item.ID }) |
            @Html.ActionLink("Borrar", "Delete", new { id = item.ID })
        </td>
    </tr>
}

</table>
<div>
@Html.Paging(new PagedList<Productos>(ViewData.Model.ToList(),1,10), Url.Action("Index","Index", new { page = "PAGENUM" }), "PAGENUM")
</div> 
```

希望你能帮助我，我已经坚持了一天，就在上周五我开始使用 mvc3，好在我的老板需要的是教程中的内容，但是，现在我想做这个额外的事情（pagedlist）我真的迷路了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T21:41:48.080

看起来好像在这一行

```
@Html.Paging(new PagedList<Productos>(ViewData.Model.ToList(),1,10), Url.Action("Index","Index", new { page = "PAGENUM" }), "PAGENUM") 
```

您正在将当前页面索引硬编码为 1。

我猜想在您的 Index 操作方法中，您可能需要一些代表您当前页面的东西，您可以将其传递给您的视图，并用它替换硬编码的 1 。

例如

```
public void Index(int page = 1)
{
    // ... set up your view model
    // ...
    // ...

    // page is added to the url by your paging helper.
    ViewBag.CurrentPage = page;

    return View(viewModel);
} 
```

而在视野中...

```
@Html.Paging(new PagedList<Productos>(ViewData.Model.ToList(),@ViewBag.CurrentPage,10), Url.Action("Index","Index", new { page = "PAGENUM" }), "PAGENUM") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T10:51:11.377

根据您在评论中所说的，分页列表不会出现在页面底部，我真的建议您进行一些调试并查看实际执行的代码路径。但无论如何，我们也许可以猜到以下......

第一步是在 中放置一个断点`ListPaging.Paging`并检查它是否实际被调用。如果是这样，并且没有任何内容附加到您的 StringBuilder，那么也许

```
if (pagedList.ItemCount > pagedList.PageSize)
{
     // ... 
```

没有评估为真。我假设您的列表中的项目超过 10 个，所以它应该是真的。所以也许这没有评估为真的原因是因为没有设置任何值。

您添加的构造函数看起来很可疑：

```
public PagedList(List<Productos> list, int p, int p_2)
{
    // TODO: Complete member initialization
    this.list = list;
    this.p = p;
    this.p_2 = p_2;
} 
```

PagedList 使用的所有属性实际上都没有在这里设置。这个构造函数有什么意义？`p`和是什么`p_2`？如果调用此构造函数，则 ItemCount 和 PageSize 将没有值。我建议摆脱它并让其他构造函数被调用。

# regex - 多个文件名的正则表达式

> ID：11529951
> 
> 赞同：0
> 
> 时间：2012-07-17T19:57:21.023
> 
> 标签：regex, filenames

我有一些文件，例如 15.58.55.ser 16.22.20.ser 16.36.23.ser 16.40.13.ser 16.59.41.ser 17.05.08.ser 17.14.40.ser 18.14.40.ser 18.20.43。 ser 我想用以下格式替换这些文件名 image_1.ser image_2.ser ....

我不知道如何实现它。

请给我一些建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T10:21:15.087

试试这个（如果你需要 Java 代码）

```
String regex = "\\.ser";
fileName = "15.58.55.ser";
System.out.println(filename.replaceAll(fileName.split(regex)[0], "image_1")); 
```

这仅适用于一个条目。如果要替换多个文件，请在 For 循环或其他方式中执行

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T20:09:10.033

正则表达式非常简单：

```
(?:\d{2}\.){3}ser 
```

它匹配两个数字`\d{2}`和一个点`\.`3 次`{3}`，以 . 结尾`ser`。

您可以[从 RegExr](http://regexr.com?31icp)中看到它与您的所有测试用例匹配。

但是，为了知道如何进行替换，您必须指定您正在使用的语言。

# asp.net - 更改 asp.net 下拉列表的选定值而不触发回发

> ID：11529957
> 
> 赞同：1
> 
> 时间：2012-07-17T19:57:35.977
> 
> 标签：asp.net, drop-down-menu

如何在不触发回发的情况下更改 asp.net 下拉列表的选定值？

我尝试将自动回发设置为 false，但在下拉列表中选择另一个选项时，选项上的“已选择”属性不会更改。

我已经看到了一些使用更新面板的示例，并且我已经成功尝试过，但是由于页面上的其他 javascript 和 jquery 函数，我无法使用它而不会在其他函数上遇到很多麻烦..

**代码更新**

```
 <asp:DropDownList ID="USERS" DataTextField="NAME" DataValueField="ID" runat="server"
                     Width="150px">
    </asp:DropDownList> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T05:37:50.533

尝试使用带有 asp:UpdatePanel 和 asp:updateprogress 标签的 AJAX。如果您已经尝试过，请向我们展示您的代码，以便我们提供帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T05:52:54.113

Lemme 给你详细解释...

```
 <asp:UpdatePanel ID="UpdatePanel1" runat="server">
     <ContentTemplate>
 <asp:DropDownList ID="DropDownList1" runat="server">
 </asp:DropDownList>
     </ContentTemplate> 
```

并根据需要添加更新进度

```
<asp:UpdateProgress ID="UpProDisp" runat="Server" AssociatedUpdatePanelID="UpdatePanel1" OnLoad="UpdatePanelProdDisp_Load">
          <ProgressTemplate>
          </ProgressTemplate>
 </asp:UpdateProgress> 
```

还添加模态弹出窗口

```
<asp:ModalPopupExtender ID="modalExtender" runat="server" TargetControlID="UpProDisp" PopupControlID="Panel1" DropShadow="true" BackgroundCssClass="modalBackground">
</asp:ModalPopupExtender>
<asp:Panel ID="Panel1" runat="server" CssClass="modalExtender">
     <img alt="Processing" src="../Images/Processing.jpg" />
       <br />
     <asp:Label ID="lblProcessing" runat="server" Text="Processing..." CssClass="TitleBar"></asp:Label>
  </asp:Panel> 
```

使用以下 javascript 代码...

```
<script type="text/javascript">
 Sys.WebForms.PageRequestManager.getInstance().add_beginRequest(showPopup);
 Sys.WebForms.PageRequestManager.getInstance().add_endRequest(hidePopup);

function showPopup(sender, args) {
var ModalControl = '<%= modalExtender.ClientID %>';
$find(ModalControl).show();
}

function hidePopup(sender, args) {
var ModalControl = '<%= modalExtender.ClientID %>';
$find(ModalControl).hide();
} 
</script> 
```

告诉我它是否有效。

# string - 在 iif() 语句中组合字符串和月份名称返回类型时，SSRS 2012 #error

> ID：11529962
> 
> 赞同：0
> 
> 时间：2012-07-17T19:57:51.110
> 
> 标签：string, reporting-services, iif

在 SSRS 2012 中使用 iif() 语句时，我遇到了一个非常奇怪的错误。

我试图选择在月份值不等于 99 时打印月份名称，当它等于 99 时，我想打印字符串“YTD”我试图使用以下语句来实现这一点：

=iif(Fields!Month.Value = 99, "YTD", MonthName(Fields!Month.Value, true) )

每当我尝试使用此 MonthName() 函数时，月份都会正确打印，但 99 字段返回为“#error”。当我将月份保留为整数或只是输入一个虚拟字符串时，此语句可以正常工作，并且我已经尝试将 MonthName() 转换为字符串（例如“cStr(MonthName())”）。

有任何想法吗？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T13:03:52.230

要回答我自己的问题/引用我在微软论坛上从 Syed Qazafi Anjum 收到的另一个答案：

`=iif(Fields!Month.Value=99,"Y.T.D",monthname(iif(Fields!Month.Value<=12,Fields!Month.Value,12),true))`

取自： [http ://social.msdn.microsoft.com/Forums/en-US/sqlreportingservices/thread/d484d8d4-3809-4850-ada6-8cac1239bfce/](http://social.msdn.microsoft.com/Forums/en-US/sqlreportingservices/thread/d484d8d4-3809-4850-ada6-8cac1239bfce/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T21:40:16.083

`MonthName`即使月份数为 99，该函数也会被评估。使用`switch`而不是`iif`解决此问题。

# java - GlassFish 上的独立 ActiveMQ 客户端

> ID：11529964
> 
> 赞同：0
> 
> 时间：2012-07-17T19:57:54.527
> 
> 标签：java, activemq, glassfish-3

大家好，我有这样的问题，我做了所有的事情，就像[教程](http://javadude.wordpress.com/2011/07/21/glassfish-v3-1-running-embedded-activemq-for-jms-part-1/)说的那样。所以现在我想查找我配置的主题和连接工厂，但它看不到它们。我做了类似的东西：

> ```
>  try {
>         Properties propertiesAMQ = new Properties();
>         propertiesAMQ.load(new FileInputStream("AMQ.properties"));
>         logger.info("Property file loaded succesfully...");
>         propertiesAMQ.setProperty(Context.INITIAL_CONTEXT_FACTORY,
>             "org.apache.activemq.jndi.ActiveMQInitialContextFactory");
>         propertiesAMQ.setProperty(Context.PROVIDER_URL,
>                 "tcp://localhost:61616");
>     Context ctx = new InitialContext(propertiesAMQ);
>         javax.jms.TopicConnectionFactory factory = (javax.jms.TopicConnectionFactory) ctx
>                 .lookup("amqpool");
> javax.jms.Topic mytopic = (javax.jms.Topic) ctx.lookup("amqmsg") 
> ```
> 
> }

并收到 NameNotFoundException。如果我使用连接工厂的名称，例如“ConnectionFactory”，它会没问题，但它不会看到我的主题我做错了什么？你有这个主题的其他例子吗？我正在使用 glassfish 3.0.1 和 AMQ 5.5.0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T16:20:53.943

您如何创建主题资源？我遇到了类似的问题，解决方案是使用 Glassfish 命令行工具“asadmin”创建管理资源对象。使用 Glassfish 管理控制台创建它不起作用（导致 NameNotFoundException）。

我最终使用以下命令创建了我的队列资源：'create-admin-object –restype javax.jms.Queue –raname activemq-rar-5.7.0 –property PhysicalName=queueName queueName'

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T20:20:29.677

可能您缺少名称空间，您可以在 glassfish 控制台中查看确切的名称，但很可能应该是；

```
javax.jms.Topic mytopic = (javax.jms.Topic) ctx.lookup("java:amqmsg") 
```

# android - 如何在选项卡之间发送数据作为活动？

> ID：11529969
> 
> 赞同：1
> 
> 时间：2012-07-17T19:58:21.917
> 
> 标签：android, android-intent

我有这个父选项卡，我想从中将布尔值发送到我的一个选项卡。我该怎么做？我这个下面会工作，但显然它没有！

这是父选项卡（IncludeTabActivity.java）：

```
Intent i = getIntent();

i.putExtra("FromMyActivity", fromLogin);

        TabActivity ta = (TabActivity) IncludeTabActivity.this;
        ta.getTabHost().setCurrentTab(0); 
```

这是子选项卡：

```
Bundle extras = getIntent().getExtras();
boolean fromLogin = extras.getBoolean("FromMyActivity"); 
```

怎么可能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T20:04:36.430

尝试：

```
SharedPreferences settings = getSharedPreferences("DefaultSettings", 0);
SharedPreferences.Editor editor = settings.edit();
editor.putBoolean("FromMyActivity", fromLogin);
editor.commit(); 
```

然后让它使用

```
SharedPreferences settings = getSharedPreferences("DefaultSettings", 0);
boolean fromLogin = settings.getBoolean("FromMyActivity", defaultFromLoginValue); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T20:04:41.567

我接收数据的方式略有不同。

```
Intent received = getIntent();
boolean dataReceived = received.getExtra("FromMyActivity"); 
```

# c# - C#中的SplitContainer拆分器？

> ID：11529975
> 
> 赞同：5
> 
> 时间：2012-07-17T19:58:34.460
> 
> 标签：c#, winforms, splitter

我正在使用拆分容器。出于某种原因，拆分器看起来像这样： ![在此处输入图像描述](../Images/29f5adc8b8ac2fba8a7b8b208adeb129.png)

很难看到。就是两条黑线中间的那两条微弱的线。如何解决此问题并在两行之间添加填充？我使用 Fixed Single 作为我的边框样式。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-17T20:02:49.910

尝试更改背景色，但如果使用设计器，则还要进入 Panel1 和 Panel2 并将这些各自的背景色更改为您想要的颜色。

此外，它们是一个 SplitterWidth 属性，可以调整拆分器手柄的整体大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T20:01:47.110

验证拆分容器的锚点是否设置正确。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T20:01:54.473

使用背景色来改变颜色。

[http://msdn.microsoft.com/en-us/library/system.windows.forms.control.backcolor.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.backcolor.aspx)

# bash - 如何使用 ssh 到另一台机器与另一个用户执行脚本

> ID：11529976
> 
> 赞同：0
> 
> 时间：2012-07-17T19:58:41.617
> 
> 标签：bash, ssh

概要：

```
[user1]$ whoami   
         user1

[user1]$ vi someScript.sh 

#!/bin/sh 
echo "Hello World!"

[user1]$ chmod 777 someScript.sh 

[user1]$ ls -l

        xrw-xrw-xrw someScript.sh

[user1]$ ssh user2@remoteMachine /home/user1/someScript.sh

**Problem Area** 

[user1]$

  Permission denied 
```

**期望的结果**

从不同的用户执行这种类型的执行。我该怎么做呢？

这是一个 NFS 文件系统。user1 和 user2 可以看到彼此的文件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T21:04:00.503

如果您的脚本不引用 $0 或任何参数变量，您可以这样做

```
 ssh user2@remoteMachine bash <  ./someScript.sh 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T08:35:37.660

也许您在远程主机上的 /home 分区是使用“noexec”选项挂载的，您可以在 /etc/fstab 中检查

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T20:05:22.750

假设 user2 可以访问用户的主页 - 就像您所做的那样。否则 user2 必须访问 user1 的文件，特别是：获得在该脚本上执行的权限。或者至少要阅读它，因此可以使用`sh .../script.sh`.

# java - Java数组长度小于0？

> ID：11529988
> 
> 赞同：27
> 
> 时间：2012-07-17T20:00:15.350
> 
> 标签：java, arrays

我正在浏览一个他们正在创建输出流的开源项目，并遇到了以下方法：

```
@Override public void write(byte[] buffer, int offset, int length) {
    if (buffer == null) {
        throw new NullPointerException("buffer is null");
    }
    if (buffer.length < 0) { // NOTE HERE
        throw new IllegalArgumentException("buffer length < 0");
    }
    if (offset < 0) {
        throw new IndexOutOfBoundsException(String.format("offset %d < 0", offset));
    }
    if (length < 0) {
        throw new IndexOutOfBoundsException(String.format("length %d < 0", length));
    }
    if (offset > buffer.length || length > buffer.length - offset) {
        throw new IndexOutOfBoundsException(String.format("offset %d + length %d > buffer"                                                       " length %d", offset, length, buffer.length));
    }
} 
```

所以`byte[] buffer`只是一个普通的老`byte[]`。我们知道它不是空的。甚至有可能使它的长度小于0？就像，它可以通过**反思**来完成，而这正是他们所防范的吗？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-07-17T20:03:56.847

不，这永远不会发生。根据 Java 规范，长度保证为非负数。

> 数组类型的成员全部如下：
> 
> *   公共最终字段长度，其中包含数组的组件数。**长度可以是正数或零**。

资料来源：[JLS §10.7](http://docs.oracle.com/javase/specs/jls/se7/html/jls-10.html#jls-10.7)

正如 mprivat 所提到的，如果您尝试创建一个负大小的数组，则会抛出[NegativeArraySizeException 。](http://docs.oracle.com/javase/7/docs/api/java/lang/NegativeArraySizeException.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-17T20:02:46.893

我不相信这是可能的。即使通过反射，它也受到 NegativeArraySizeException 的保护

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-21T17:17:52.603

这只是一个异常处理问题。你可以在 Java 中创建一个负大小的数组——当你编译它时它甚至不会抛出异常。但是在运行时，您的程序将不会运行，直到此问题得到纠正。（它会抛出一个`NegativeArraySizeException`。）

问题在于这个异常是在运行时而不是编译时抛出的——这就是为什么使用`IllegalArgumentException`.

# wcf - 在构建过程中生成 WCF 代理

> ID：11529990
> 
> 赞同：6
> 
> 时间：2012-07-17T20:00:34.030
> 
> 标签：wcf, msbuild, proxy

我正在编写一个将在我们公司内广泛使用的 WCF 服务，我想生成 WCF 客户端代理作为构建过程的一部分并将它们打包到一个程序集中，这样服务的客户端就没有多次重复这个过程。有没有人知道可以做到这一点的方法？MSBuild 是否有任何预先存在的构建任务？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-08-07T12:59:26.947

我试图解决同样的问题。这就是最终要做的事情。在 .csproj 中，在 AfterBuild 目标下，添加获取 SDK 路径的任务，并使用 Exec 命令运行 svcutil.exe。我不得不使用“” 因为路径包含空格。

```
<Target Name="AfterBuild">
   <GetFrameworkSdkPath>
       <Output TaskParameter="Path" PropertyName="SdkPath"/>
   </GetFrameworkSdkPath>
   <Exec Command="&quot;$(SdkPath)bin\NETFX 4.5.1 Tools\svcutil.exe&quot; $(TargetPath)"/>
</Target> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-25T15:27:12.817

这就是我最终要做的事情：

1）创建具有我要为其生成客户端代码的服务的项目

2) 创建执行以下操作的 MSBuild 任务：

```
a) Takes the compiled WCF Service assembly, runs svcutil.exe on it to extract XSD and WSDL metadata for all the services in the Service assembly.

b) Runs svcutil.exe again, this time on the extracted XSD and WSDL files to generate a .cs file containing the client

c) Run csc.exe to compile the generated client code into a separate assembly. 
```

3) 将 MSBuild 任务插入到包含该服务的项目的“AfterBuild”目标中。

现在，每次构建服务时，我都会得到一个自动生成的程序集，其中包含我们公司中的多个其他项目可以引用的客户端代码，而无需在多个项目中重新/生成相同的 Web 引用。他们可以只引用单个程序集，并且更容易更新，只需更新项目文件中的一行，而不是 Web 引用生成器生成的多个文件。如果有人感兴趣，我可以将 MSBuild 任务的代码和使用它的 XML 片段发送给他们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T08:09:50.980

我不知道任何内置任务，这就是我的做法：

创建一个项目，通过svcutil生成代理类并添加到项目中。创建一个 MSBuild 脚本，该脚本 (1) 调用 svcutil 并覆盖上述类并 (2) 构建项目。

那不会达到你想要的吗？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-18T08:22:28.980

看看`T4`模板，以及 T4Toolbox 等项目

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-25T15:51:19.080

为什么不简单地创建一个单独的类库项目。在该项目中，为您需要的每个服务使用“添加服务引用”。

然后其他代码可以简单地使用类库中的类。

# android - 标志意图问题

> ID：11529991
> 
> 赞同：-1
> 
> 时间：2012-07-17T20:00:41.020
> 
> 标签：android, task

在我的代码中，我有 2 个应用程序。启动应用程序 b 的应用程序 a，如启动器。

代码应用 a 看起来像这样：

```
 Intent i = new Intent(Intent.ACTION_MAIN);
    PackageManager manager = getPackageManager();
    i = manager.getLaunchIntentForPackage("com.test.vayo");
    i.addCategory(Intent.CATEGORY_LAUNCHER);
    startActivity(i);
    finish(); 
```

应用 B 上的代码：

```
 Intent intent = new Intent(this.context, first.class);
            intent.setFlags(intent.FLAG_ACTIVITY_REORDER_TO_FRONT);
            context.startActivity(intent);
            finish(); 
```

我的问题是只有在 a 没有启动应用程序 b 的情况下才启动任务 b私人任务。为此，我使用 FLAG_ACTIVITY_REORDER_TO_FRONT 它仅在我运行第一个应用程序 b 和应用程序 a 时才有效，但如果我运行 a 然后运行 ​​b 它不起作用，它从根活动启动 b。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T20:43:23.583

在您的清单文件中，对于 B 的启动器活动，声明

```
android:launchMode="singleTask" 
```

你不需要在 B 中做任何事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T11:14:04.433

我用应用程序 a 上的一个标志和应用程序 b 上的另一个标志，即标志

```
 intent.setFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP); 
```

# javascript - 防止定时器上的 JavaScript 注入

> ID：11529994
> 
> 赞同：2
> 
> 时间：2012-07-17T20:01:15.483
> 
> 标签：javascript, setinterval, xss, firebase

我正在制作一个浏览器游戏，其中每 10 秒`i`递增一次，并且积分算法用于`i`确定授予的积分数。（对我来说）显而易见的方法是使用`setInterval(10000)`计时器，并在函数内部运行点计算。

**如何防止 JavaScript 注入增加** `i`**，使应用程序认为用户实际上玩的时间比他实际玩的时间长？**

我使用 Firebase 作为后端。作为一名 PHP 程序员，我通常会在玩家提交分数时通过检查开始和结束时间来对玩家的分数进行服务器端验证。我想我也可以在 Firebase 中做到这一点，所以我可能只是回答了我自己的问题......

不过，有没有办法阻止 JavaScript 注入？（**预防**，而不是服务器端**检测**）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T20:42:03.653

您可以使变量本质上是私有的，这意味着用户不可能通过普通的 JS 注入来更改它们。但这不会阻止某人使用调试器拦截您的 Javascript，拦截您在客户端和服务器之间的通信，或进行各种其他摆弄。

要将变量设为私有，只需将其包含在函数中，执行该函数，然后返回包含引用该变量的函数的内容。这称为`closure`. 这很容易做到。

在[这个小提琴](http://jsfiddle.net/CrossEye/WynX5/1/)中，有一个`counter`每秒更新的变量（不是每十秒 - 我很着急！:-)）和另一个变量，`basePoints` 它们一起添加到当前分数。

公开的功能是允许您添加到 basePoints 值，但没有任何内容允许您添加到计数器。我认为如果不进入 JS 引擎（就像调试器所做的那样），你就无法做到这一点。主要的一点是，在 Javascript 中没有办法更新`counter`变量。

```
var app = this.app = (function() {
    var counter = 0;
    var basePoints = 0;
    var div = document.getElementById("score");
    var addPoints = function(nbr) {
        basePoints += nbr;
        display();            
    };

    document.getElementById("add20").onclick = function() {
        addPoints(20);            
    };

    var display = function() {
        var points = counter + basePoints;
        div.innerHTML = points + " points";
    };

    setInterval(function() {
        counter += 1; 
        display();
    }, 1000);

    return {
        addPoints: addPoints
    };
}());​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T20:44:52.137

您可以通过确保变量在函数上下文内部并且不是全局变量并且不能从全局范围访问来防止通过诸如小书签之类的东西对变量进行简单操作。这可以像这样简单地将其放入一个自执行函数上下文中：

```
(function() {
    var i;

    // code that uses i

    setTimeout(function() {
        more code that uses i
    }, 1000);
})(); 
```

在这种情况下，只有第一个功能块内的代码才能访问变量`i`。

请注意，正如其他人所说，这并不能阻止更复杂的操作，即在页面执行之前实际更改源 javascript 或在调试器中中断并在那里操作，因为没有办法阻止这些操作，但它确实阻止了最简单的操作进入页面并更改变量的方法（例如从书签中）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T20:10:10.367

几乎没有办法通过计算客户端的值并随后推送到服务器端来防止任何形式的高分黑客攻击。只有混淆和不同的技巧可以使黑客或多或少变得复杂，但他们根本无法阻止它。这就是为什么首选服务器端验证或事件更好的服务器端计算的原因。

# android - Android 中的动态通知图标（大），针对 2.2

> ID：11529999
> 
> 赞同：0
> 
> 时间：2012-07-17T20:01:41.457
> 
> 标签：android

这个问题以前有人问过，但还没有得到正确的回答。我知道这是可能的，但我们感到有点困惑。

**当收到推送通知时，我们需要在状态栏中显示自定义/动态图像。我们关心的是下拉菜单中的大图，而不是实际状态栏中的小图。因为它们需要是动态的，所以图像不能用 apk 打包，我们正在尝试针对 Android 2.2**

我们试图实现的目标类似于 Facebook 如何在通知栏中显示发起通知的用户的个人资料图像。这也类似于当新的推送通知到达时，WhatsApp 在通知栏中显示群组图像的方式。

根据我们所读到的，这仅在 Android 3+、sdk 11 中才有可能。但事实并非如此。

我们已经在运行 2.3.4 的 Android 手机上安装了 Facebook 和 WhatsApp，果然，自定义图标显示在通知栏中。

*那么秘诀是什么？他们是如何做到的呢？我们该怎么做？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T21:26:46.200

所以你要做的是`setLargeIcon(Bitmap icon)`在通知生成器中设置。这在 APi 11 及更高版本（蜂窝）中可用。兼容包 v9 中的通知生成器可以为你设置，但只会出现在 api 11 及以上版本。要在 2.3 及以下版本中达到相同的效果，您必须创建自定义通知布局并`setContent(RemoteViews views)`在 Notification.Builder 中进行设置以生成自定义布局。这可以在左侧用一个大图标设置样式，以模仿 > API 11 样式。

创建自定义布局很棘手，必须考虑很多事情，例如在其他设备上显示通知的可用屏幕尺寸和主题文本颜色（尤其是通知曾经是白色背景上的深色文本，现在它们是浅色文本在黑暗的 bg 上）有很多指南甚至 SO 帖子可以帮助你（[比如这个](https://stackoverflow.com/questions/4867338/custom-notification-layouts-and-text-colors)）

关于获取动态图像，当手机收到消息（推送通知或其他）并且您的应用程序开始构建通知时，您可以在构建通知之前执行一个小的 http 请求来拉动动态图像。这将延迟发布几秒钟，但这并不重要。然后您可以获取生成的图像并在通知中使用它。可以通过发送一些数据来选择特定的图像（我假设是推送通知），这些数据标识了哪些照片，例如 url，或者您可以附加到应用程序的通知构建部分中已经存在的 url 上的 id。

希望这会有所帮助，任何后续都只是问:)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-17T20:36:26.457

除了在状态栏上看到的通知图标，您不能使用任何东西，只能使用预先打包的可绘制对象作为通知**图标。**不，你没有看到任何你在 FB 应用程序中寻找的东西（或者你谈论的是当你把它拉下来时看到的通知区域）。