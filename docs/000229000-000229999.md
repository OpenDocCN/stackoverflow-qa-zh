# StackOverflow 问答 000229000-000229999

# excel - 如何关闭打开的文件？

> ID：229004
> 
> 赞同：0
> 
> 时间：2008-10-23T08:52:31.163
> 
> 标签：excel, csv

我打开了一个 csv 文件并复制了内容。我激活了一个 excel 文件，并将 csv 文件中的复制内容粘贴到 excel 文件中。
现在，如何以编程方式关闭 csv 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-23T11:48:30.950

这应该这样做..

```
Workbooks("MYCSV_File.CSV").Close SaveChanges:=False 
```

# mod-rewrite - 在匹配的 RewriteCond 上停止 Mod_Rewrite 执行

> ID：229007
> 
> 赞同：6
> 
> 时间：2008-10-23T08:53:17.167
> 
> 标签：mod-rewrite

我在 IIS 上运行 Helicon ISAPI Rewrite 的免费版本，并且有多个站点通过相同的重写规则集运行。到目前为止，这一切都很好，因为所有规则都适用于所有站点。我最近添加了一个我不想通过所有规则运行的新站点。在执行自己的规则后，有什么方法可以使对该站点的请求突破规则集。

我试过以下没有运气；对 mysite.com 的所有请求都会导致 404。我想我正在寻找的是一个什么都不做的规则，并且被标记为最后一个要执行的规则 [L]。

```
## New site rule for mysite.com only
RewriteCond  Host:  (?:www\.)?mysite\.com
RewriteRule  /content([\w/]*)   /content.aspx?page=$1 [L]

## Break out of processing for all other requests to mysite.com
RewriteCond  Host:  (?:www\.)?mysite\.com
RewriteRule (.*) - [L]

## Rules for all other sites
RewriteRule ^/([^\.\?]+)/?(\?.*)?$ /$1.aspx$2 [L]
... 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-23T12:22:28.867

我做了类似的事情，在 WebDAV 文件夹上停止 mod_rewrite：

```
# stop processing if we're in the webdav folder
RewriteCond %{REQUEST_URI} ^/webdav [NC]
RewriteRule .* - [L] 
```

这也应该适用于您的目的。如果没有，或者如果您对其他参考感兴趣，请参阅上一个问题：[如何忽略 mod_rewrite 中的目录？](https://stackoverflow.com/questions/163302/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-11-25T15:23:38.800

## `RewriteRule ^ - [END]`

*   `.`将是不正确的，因为它至少需要 1 个字符
*   `.*` *恕我直言，效率*可能会降低**
**   L 比 END 差，因为它允许额外的轮次，包括内部重定向。只有 END 真正停止。→[**详情**](https://httpd.apache.org/docs/2.4/rewrite/flags.html#flag_l)*

 ** * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-23T08:58:56.890

自己重写？

```
RewriteCond  Host:  (?:www\.)?mysite\.com
RewriteRule ^(.*)$ $1 [QSA,L] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-15T00:59:50.507

我不知道 ISAPI Rewrite 语法，但是在[IIRF](http://iirf.codeplex.com)上，“break out”规则是这样的：

```
## Break out of processing for all other requests to mysite.com
RewriteCond %{SERVER_NAME}  ^(?:www\.)?mysite\.com$
RewriteRule (.*) - [L] 
```

或者

```
## Break out of processing for all other requests to mysite.com
RewriteCond %{HTTP_HOST}  ^(?:www\.)?mysite\.com$
RewriteRule (.*) - [L] 
```

在每种情况下，规则都说“不要重写（并且不要再处理任何规则）”，并且当使用的主机名是 mysite.com 或 www.mysite.com 时适用。[L] 标志是表示“不再处理任何规则”的部分，而 - 替换是表示“不要重写”的部分。

# perl - 如何在 Perl 中获取调用堆栈列表？

> ID：229009
> 
> 赞同：72
> 
> 时间：2008-10-23T08:53:45.357
> 
> 标签：perl, stack-trace, callstack

有没有一种方法可以访问（用于打印输出）子 + 模块列表到 Perl 脚本中当前位置之前的任意深度的子调用？

我需要对一些 Perl 模块 (.pm's) 进行更改。工作流程通过 cgi 脚本从网页启动，通过几个模块/对象传递输入，这些模块/对象以我需要使用数据的模块结尾。沿着这条线的某个地方，数据发生了变化，我需要找出在哪里。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2008-10-23T08:59:56.390

您可以使用[Devel::StackTrace](http://search.cpan.org/dist/Devel-StackTrace/)。

```
use Devel::StackTrace;
my $trace = Devel::StackTrace->new;
print $trace->as_string; # like carp 
```

它的行为类似于 Carp 的跟踪，但您可以更好地控制帧。

一个问题是引用是字符串化的，如果引用的值发生变化，您将看不到它。但是，您可以使用[PadWalker 制作](http://search.cpan.org/dist/PadWalker/)一些东西来打印出完整的数据（虽然它会很大）。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2016-08-18T06:59:47.253

此代码**无需任何附加模块即可**工作。只需在需要的地方包含它。

```
my $i = 1;
print STDERR "Stack Trace:\n";
while ( (my @call_details = (caller($i++))) ){
    print STDERR $call_details[1].":".$call_details[2]." in function ".$call_details[3]."\n";
} 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-10-23T22:50:45.557

`Carp::longmess`会做你想做的，这是标准的。

```
use Carp qw<longmess>;
use Data::Dumper;
sub A { &B; }
sub B { &C; }
sub C { &D; }
sub D { &E; }

sub E { 
    # Uncomment below if you want to see the place in E
    # local $Carp::CarpLevel = -1; 
    my $mess = longmess();
    print Dumper( $mess );
}

A();
__END__
$VAR1 = ' at - line 14
    main::D called at - line 12
    main::C called at - line 10
    main::B called at - line 8
    main::A() called at - line 23
'; 
```

我想出了这个子（现在有可选的祝福动作！）

```
my $stack_frame_re = qr{
    ^                # Beginning of line
    \s*              # Any number of spaces
    ( [\w:]+ )       # Package + sub
    (?: [(] ( .*? ) [)] )? # Anything between two parens
    \s+              # At least one space
    called [ ] at    # "called" followed by a single space
    \s+ ( \S+ ) \s+  # Spaces surrounding at least one non-space character
    line [ ] (\d+)   # line designation
}x;

sub get_stack {
    my @lines = split /\s*\n\s*/, longmess;
    shift @lines;
    my @frames
        = map { 
              my ( $sub_name, $arg_str, $file, $line ) = /$stack_frame_re/;
              my $ref =  { sub_name => $sub_name
                         , args     => [ map { s/^'//; s/'$//; $_ } 
                                         split /\s*,\s*/, $arg_str 
                                       ]
                         , file     => $file
                         , line     => $line 
                         };
              bless $ref, $_[0] if @_;
              $ref
          } 
          @lines
       ;
    return wantarray ? @frames : \@frames;
} 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2008-10-23T09:01:26.463

[caller](http://perldoc.perl.org/functions/caller.html)可以这样做，尽管您可能需要更多信息。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2008-10-23T09:53:32.740

还有`Carp::confess`和`Carp::cluck`。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-07-18T10:28:55.120

一个更漂亮的：[Devel::PrettyTrace](https://metacpan.org/pod/Devel::PrettyTrace "开发::PrettyTrace")

```
use Devel::PrettyTrace;
bt; 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2019-06-14T10:48:06.647

如果您不能使用（或想避免）非核心模块，这是我想出的一个简单的子程序：

```
#!/usr/bin/perl
use strict;
use warnings;

sub printstack {
    my ($package, $filename, $line, $subroutine, $hasargs, $wantarray, $evaltext, $is_require, $hints, $bitmask, $hinthash);
    my $i = 1;
    my @r;
    while (@r = caller($i)) {
        ($package, $filename, $line, $subroutine, $hasargs, $wantarray, $evaltext, $is_require, $hints, $bitmask, $hinthash) = @r;
        print "$filename:$line $subroutine\n";
        $i++;
    }
}

sub i {
    printstack();
}

sub h {
    i;
}

sub g {
    h;
}

g; 
```

它产生如下输出：

```
/root/_/1.pl:21 main::i
/root/_/1.pl:25 main::h
/root/_/1.pl:28 main::g 
```

或单线：

```
for (my $i = 0; my @r = caller($i); $i++) { print "$r[1]:$r[2] $r[3]\n"; } 
```

[您可以在此处](https://perldoc.perl.org/functions/caller.html)找到有关呼叫者的文档。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-01-17T17:02:52.470

将[我的评论](https://stackoverflow.com/questions/229009/how-can-i-get-a-call-stack-listing-in-perl#comment87243409_229030)移至答案：

1.  安装[Devel::Confess](https://metacpan.org/pod/Devel::Confess)正确的[方式](https://cpan.metacpan.org/modules/INSTALL.html)

    ```
    cpanm Devel::Confess 
    ```

2.  运行

    ```
    perl -d:Confess myscript.pl 
    ```

出错时，这将显示整个调用堆栈列表。

# jquery - jQuery 调整大小不适用于 FireFox、Chrome 和 Safari

> ID：229010
> 
> 赞同：13
> 
> 时间：2008-10-23T08:53:47.697
> 
> 标签：jquery

```
$("#dvMyDIV").bind("resize", function(){
    alert("Resized");
}); 
```

或者

```
$("#dvMyDIV").resize(function(){
    alert("Resized");
}); 
```

问题

1.  为什么这在 FireFox、Chrome 和 Safari 上不起作用？
2.  由于其他浏览器不处理调整大小，这可以被视为 jQuery 错误吗？
3.  唯一的解决方法是调用 SetTimeout 函数检查 clientHeight 和 clientWidth 吗？
4.  使用 jQuery 的任何解决方法？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-10-23T08:59:39.947

我相信 JavaScript 调整大小事件仅适用于框架或窗口，而不适用于 DIV。

例如看到[这个页面](http://devguru.com/technologies/javascript/10929.asp)：

> onResize 偶数处理程序用于在用户或脚本调整窗口或框架的大小时执行指定的代码。这允许您查询窗口元素的大小和位置，动态重置 SRC 属性等。

因此，如果您想检测窗口何时调整大小，在 jQuery 中您可能应该使用`$(window).resize(function() { });`

**编辑：**如果您想查看 DIV 的大小，这取决于您的意图。如果您使用 JavaScript 调整大小，那么您可以实现一个方法来执行调整大小并让该句柄调用任何其他调整大小代码。

否则，如果您只是在有人调整窗口大小时观察 DIV 调整大小，那么将调整大小侦听器附加到窗口然后检查 DIV 是否已调整大小（即存储旧的宽度值） / 高度并在调整大小时检查它们）？

最后，您可以考虑在宽度/高度属性上使用[watch](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Object/watch)，尽管我不知道这是否完全兼容浏览器（认为这可能仅限于 Mozilla）。我确实找到[了这个 jQuery 插件](http://www.west-wind.com/Weblog/posts/453942.aspx)，它看起来可能会做同样的事情（稍作修改）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-10-26T11:45:42.480

有一个 benalman 插件 :)

[http://benalman.com/projects/jquery-resize-plugin/](http://benalman.com/projects/jquery-resize-plugin/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T10:03:16.183

您是否尝试将 myDiv 设置为特定大小？

试试下面的 JavaScript 代码。我用它来调整一个 div 的大小，该 div 基于从 flash 文件返回的高度来保存一个 flash 对象，它似乎对我来说还可以。

```
function setMovieHeight(value) {
    var height = Number(value) + 50;
document.getElementById("video").height = height;
} 
```

jQuery equivilent 应该是：

```
function setHeight(value) {
   var height =  number(value) + 50;
   $('#MyDiv').attr('height') = height;
} 
```

调整大小似乎只适用于 windows 对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-09-13T21:24:06.393

这不是为什么？这是必需的，例如，我们希望在调整 DIV 大小时对其进行监控。

例如，jQuery UI，可调整大小。是的，用户通过鼠标拖动调整了 div 的大小，现在怎么办？也许里面的内容被调整了大小，我们想知道它。我们是否应该将所有代码放在原始调整代码中的一个巨大熔炉中？我不这么认为。

另一个什么都不做的快速浏览器，叹息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T09:10:48.600

为什么您希望 #dvMyDIV 调整大小？调整该元素的大小可能是由于其他原因，也许是调整窗口的大小？如果是这样，请尝试

```
$(window).resize(function(){alert("Resized");}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-23T09:48:05.747

我可能会建议这样的事情：

1）在页面加载时，获取 div 的宽度并将其放入全局变量中

2）在执行任何操作时直接或隐式调整该 div 的大小（我假设这是一个 javascript 驱动的事件）检查新宽度与旧宽度并用新宽度更新全局值。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-03-02T20:07:54.573

这是一个更加精致和生动的示例，它根据窗口调整大小事件进行了大量调整大小的数学运算。在 ff 3.6、safari 4.0.4 和 chrome 中表现出色。它在 ff 3.5 中有点厚实。因此，它应该可以在 Mozilla 和 webkit 中全面运行。我避免使用其他浏览器，因为我真的不喜欢它，而且代码干净得多，不必考虑它。我意识到我将不得不克服这一点，当我不得不和 IE 附加费时，我会吞下它。

无论如何链接：

[http://fridaydev.com/bookmap/proport3.html](http://fridaydev.com/bookmap/proport3.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-02-04T04:08:23.327

使用 MSIE，一切正常。使用 Firefox，我想您将不得不求助于一些倾斜技术，例如将元素的原始宽度/高度存储在自定义属性中并使用`$(elem).bind('DOMAttrModified', func)`. 然后在 func() 回调中，检查新的宽度/高度是否与您之前存储的不同，采取相应的调整大小操作并再次存储它们以用于下一个事件回调。请注意，此方法仅适用于 Firefox。我还没有为 Chrome、Safari 和 Opera 找到合适的解决方法。也许使用 window.setInterval() 会做，但是......听起来太草率了......事件的想法让我有点恶心:(

# silverlight - Silverlight 中的异步 Web 服务器调用和最大 HTTP 连接数

> ID：229011
> 
> 赞同：3
> 
> 时间：2008-10-23T08:53:48.087
> 
> 标签：silverlight, multithreading, http, browser

我读过 Silverlight 2.0 在与 Web 服务器通信时通过设计强加了一个异步模型。我还没有机会尝试使用 Silverlight，但我假设它使用线程池来管理线程，就像在 .NET Framework 中一样。

现在，由于某些浏览器，尤其是 Internet Explorer，硬编码限制了最多可以在 Web 服务器上建立两个并发 HTTP 连接，如果我从 Silverlight 发出一堆异步请求会发生什么？

Silverlight 是否绕过 Web 浏览器中的这一限制并打开与可用线程一样多的 HTTP 连接，或者异步请求是否排队等待两个连接之一可用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-28T18:20:25.813

在 IE 中（尚未测试其他），Silverlight 一次限制为 2 个连接。

Silverlight 中的行为是根本不发出请求。因此，如果您连续发出 5 个异步 Web 服务请求，则前 2 个会发生，其他三个不会。没有抛出我见过的例外......

提琴手在这里是一个很大的帮助:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-24T18:30:08.783

为您的客户创建消息管理器界面。任何传出请求都会发布到该管理器处理的队列中。它将串行处理排队的消息（即，当调用发送到服务器的最后一条消息的回调时，可以安全地继续处理下一条排队的消息）。

您可以通过保持对服务器的 Comet 连接打开来消耗其他连接资源。服务器将通过此 Comet 连接将任何返回消息推送到客户端。您需要使用唯一编号标记传出消息，该编号可以作为传入消息的属性嵌入 - 以便结果可以与请求相关联。消息传递管理器将结果消息分派给该结果的适当处理程序。

本质上，您最终会使用两个连接资源来建立双向消息传递。但是客户端上的请求者数量没有人为的限制（尽管请求将被串行传输到服务器）。但是，发送的动作总是很快的，因为您无需等待任何结果被计算出来——您只需将消息可靠地传递到服务器并返回即可。结果在另一个 Comet 连接上异步返回。

我们将 Flex 客户端应用程序与在我们的 Tomcat Web 服务器中运行的 Adob​​e BlazeDS 结合起来执行以下操作：

[基于 Flex 的异步堆栈](https://stackoverflow.com/questions/390740/messaging-queues-and-esbs-i-know-where-i-want-to-be-but-not-how-to-get-there#390957)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-16T17:54:00.800

除了如前所述的 IE 之外，Firefox 也仅限于两个连接。

请注意，限制是每个主机名。

如果您将条目添加到主机文件，或使用 dns 别名，您可以获得更多连接。例如在测试中，在你的 hosts 文件中添加像 '127.0.0.1 test1' 这样的行，然后你可以打开两个到[http://localhost](http://localhost)的连接和另外两个到[http://test1的连接](http://test1)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-23T11:03:59.290

我想，作为一个 .NET 应用程序 Silverlight 2 具有独立于浏览器的限制。
我会假设它是*Machine.config中的**maxconnection*属性，如[http://support.microsoft.com/kb/828219中所述](http://support.microsoft.com/kb/828219)

 ** * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-10-23T18:46:31.730

首先，不会使用 Machine.config 文件，因为 Silverlight 控件是使用其自己的 CoreCLR 版本进行沙盒化的。

我相信 Silverlight 控件实际上是利用底层浏览器来发出异步 HTTP 请求。考虑到 Silverlight 控件如何无法访问 SOAP 错误信息，这很可能是这种情况，因为 SOAP 规范要求服务器返回 HTTP 500 响应代码，而 Silverlight 控件无法从托管该控件的浏览器中获取该代码。

这篇文章[在这里](http://www.wilcob.com/Wilco/News/http-requests-in-silverlight.aspx)证实了这一点。

关于并发HTTP连接的限制，我相信IE5及更高版本会根据HTTP协议版本限制到同一站点的连接数——HTTP/1.0限制为4个连接，HTTP/1.1限制为3个连接。大多数情况下，Web 服务器会将每个客户端的连接数限制为 2，排队或丢弃剩余的连接数。

# c - 获取文件的绝对路径

> ID：229012
> 
> 赞同：53
> 
> 时间：2008-10-23T08:53:52.720
> 
> 标签：c, unix, path, filesystems, absolute

如何在 Unix 上将相对路径转换为 ​​C 中的绝对路径？有没有方便的系统功能？

在 Windows 上有一个`GetFullPathName`功能可以完成这项工作，但我在 Unix 上没有找到类似的东西......

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2008-10-23T09:03:08.520

使用[realpath()](http://www.opengroup.org/onlinepubs/000095399/functions/realpath.html)。

> 该`realpath()`函数应从 指向的路径名派生 `file_name`一个绝对路径名，该路径名命名相同的文件，其解析不涉及' `.`'、' `..`'或符号链接。生成的路径名应存储为以空字符结尾的字符串，最多为`{PATH_MAX}` 字节，存储在 指向的缓冲区中 `resolved_name`。
> 
> 如果`resolved_name`是空指针，则 的行为`realpath()`是实现定义的。

* * *

> 以下示例为 symlinkpath 参数标识的文件生成绝对路径名。生成的路径名存储在实际路径数组中。

```
#include <stdlib.h>
...
char *symlinkpath = "/tmp/symlink/file";
char actualpath [PATH_MAX+1];
char *ptr;

ptr = realpath(symlinkpath, actualpath); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-12-17T03:44:13.113

试穿`realpath()`_`stdlib.h`

```
char filename[] = "../../../../data/000000.jpg";
char* path = realpath(filename, NULL);
if(path == NULL){
    printf("cannot find file with name[%s]\n", filename);
} else{
    printf("path[%s]\n", path);
    free(path);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-03-03T15:33:39.317

还有一个跨平台的小型路径库[cwalk 。](https://github.com/likle/cwalk)它有[cwk_path_get_absolute](https://likle.github.io/cwalk/reference/cwk_path_get_absolute.html)来做到这一点：

```
#include <cwalk.h>
#include <stdio.h>
#include <stddef.h>
#include <stdlib.h>

int main(int argc, char *argv[])
{
  char buffer[FILENAME_MAX];

  cwk_path_get_absolute("/hello/there", "./world", buffer, sizeof(buffer));
  printf("The absolute path is: %s", buffer);

  return EXIT_SUCCESS;
} 
```

输出：

```
The absolute path is: /hello/there/world 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-18T19:40:56.150

也尝试“getcwd”

```
#include <unistd.h>

char cwd[100000];
getcwd(cwd, sizeof(cwd));
std::cout << "Absolute path: "<< cwd << "/" << __FILE__ << std::endl; 
```

结果：

```
Absolute path: /media/setivolkylany/WorkDisk/Programming/Sources/MichailFlenov/main.cpp 
```

测试环境：

```
setivolkylany@localhost$/ lsb_release -a
No LSB modules are available.
Distributor ID: Debian
Description:    Debian GNU/Linux 8.6 (jessie)
Release:    8.6
Codename:   jessie
setivolkylany@localhost$/ uname -a
Linux localhost 3.16.0-4-amd64 #1 SMP Debian 3.16.36-1+deb8u2 (2016-10-19) x86_64 GNU/Linux
setivolkylany@localhost$/ g++ --version
g++ (Debian 4.9.2-10) 4.9.2
Copyright (C) 2014 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. 
```

# java - java中的编码转换

> ID：229015
> 
> 赞同：32
> 
> 时间：2008-10-23T08:54:55.620
> 
> 标签：java, character-encoding, converters

是否有任何免费的 java 库可用于将一种编码中的字符串转换为另一种编码，例如[`iconv`](https://en.wikipedia.org/wiki/Iconv)？我正在使用 Java 1.3 版。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-10-23T08:57:41.043

您不需要标准库之外的库 - 只需使用[Charset](https://docs.oracle.com/javase/6/docs/api/java/nio/charset/Charset.html)。（您可以只使用 String 构造函数和 getBytes 方法，但我个人不喜欢只使用字符编码的名称。错别字的空间太大。）

编辑：正如评论中所指出的，您仍然可以使用 Charset 实例，但可以轻松使用 String 方法：[new String(bytes, charset)](https://docs.oracle.com/javase/6/docs/api/java/lang/String.html#String%28byte%5B%5D%2C%20java.nio.charset.Charset%29)和[String.getBytes(charset)](https://docs.oracle.com/javase/6/docs/api/java/lang/String.html#getBytes%28java.nio.charset.Charset%29)。

请参阅“ [URL 编码（或：'那些“ `%20`URL 中的代码是什么？'）](http://www.blooberry.com/indexdot/html/topics/urlencoding.htm) ”。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-10-23T08:57:21.123

[`CharsetDecoder`](http://java.sun.com/j2se/1.4.2/docs/api/java/nio/charset/CharsetDecoder.html)应该是你要找的，不是吗？

许多网络协议和文件使用面向字节的字符集存储它们的字符，例如`ISO-8859-1`( `ISO-Latin-1`)。
但是，Java 的本机字符编码是[~~统一码~~](http://www.joelonsoftware.com/articles/Unicode.html)UTF16BE（十六位 UCS 转换格式，大端字节序）。

见[`Charset`](http://download-llnw.oracle.com/javase/6/docs/api/java/nio/charset/Charset.html)。这并不意味着`UTF16`是默认字符集（即：默认的“16 位**[Unicode 代码单元](http://download-llnw.oracle.com/javase/6/docs/api/java/lang/Character.html#unicode)**序列和字节序列之间的映射”）：

> Java 虚拟机的每个实例都有一个默认字符集，它可能是也可能不是标准字符集之一。
> [ `US-ASCII`, `ISO-8859-1`aka `ISO-LATIN-1`, `UTF-8`, `UTF-16BE`, `UTF-16LE`, `UTF-16`]
> 默认字符集在虚拟机启动期间确定，通常取决于底层操作系统使用的语言环境和字符集。

此示例演示如何将a 中的`ISO-8859-1`编码字节转换`ByteBuffer`为 a 中的字符串，`CharBuffer`反之亦然。

```
// Create the encoder and decoder for ISO-8859-1
Charset charset = Charset.forName("ISO-8859-1");
CharsetDecoder decoder = charset.newDecoder();
CharsetEncoder encoder = charset.newEncoder();

try {
    // Convert a string to ISO-LATIN-1 bytes in a ByteBuffer
    // The new ByteBuffer is ready to be read.
    ByteBuffer bbuf = encoder.encode(CharBuffer.wrap("a string"));

    // Convert ISO-LATIN-1 bytes in a ByteBuffer to a character ByteBuffer and then to a string.
    // The new ByteBuffer is ready to be read.
    CharBuffer cbuf = decoder.decode(bbuf);
    String s = cbuf.toString();
} catch (CharacterCodingException e) {
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-09-02T10:31:47.603

我只想补充一点，如果字符串最初是使用错误的编码进行编码的，则可能无法将其更改为另一种编码而不会出错。这个问题并没有说明这里的转换是从错误的编码到正确的编码，但我个人只是因为这种情况而偶然发现了这个问题，所以也只是为其他人提个醒。

其他问题中的这个答案解释了为什么转换并不总是产生正确的结果 [https://stackoverflow.com/a/2623793/4702806](https://stackoverflow.com/a/2623793/4702806)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-29T17:34:35.427

如果您将 unicode 视为一个字符集（它实际上是 - 它基本上是所有已知字符的编号集），那就容易多了。您可以将其编码为 UTF-8（取决于每个字符 1-3 个字节）或 UTF-16（每个字符 2 个字节或使用代理对 4 个字节）。

回到 Java 过去使用 UCS-2 对 unicode 字符集进行编码的时间的迷雾中。这只能处理每个字符 2 个字节，现在已过时。添加代理对并升级到 UTF-16 是一个相当明显的 hack。

很多人认为他们应该首先使用 UTF-8。最初编写 Java 时，unicode 的字符数远远超过 65535 个......

# java - 在 JLabel 中显示 OSX 命令符号键

> ID：229021
> 
> 赞同：3
> 
> 时间：2008-10-23T08:57:19.390
> 
> 标签：java, macos, command, key

我们希望为 JList 显示一个提示，即用户可以使用与平台相关的键来选择多个项目以进行多选。

但是我还没有找到任何方法在 JLabel 中显示 OS X COMMAND 符号，这意味着在命令键上打印在苹果键盘上的符号，也称为苹果键。

这是我想在 OS X 上显示的符号图片。[（来源：][[wikimedia.org](https://upload.wikimedia.org/wikipedia/commons/thumb/0/0c/Command_key.svg/120px-Command_key.svg.png)][）][![命令符号](https://i.stack.imgur.com/VKGb4.png)](https://i.stack.imgur.com/VKGb4.png)

我也想让它独立于平台。

即类似的东西

```
component.add( new JList() , BorderLayout.CENTER );
component.add( new JLabel( MessageFormat.format("With {0} you can " 
  + "select multiple items", 
  KeyStroke.getKeyStroke( ... , ... ) ) ) , BorderLayout.SOUTH ); 
```

而不是*{0}*应该出现在上面看到的符号...

有没有人知道如何做到这一点？我知道这一定是可能的，因为在 JMenuItems 中有符号......

我自己的（非图形解决方案）如下所示：

```
add( new JLabel( MessageFormat.format(
  "With {0} you can select multiple items" , 
  System.getProperty( "mrj.version" ) != null ? "COMMAND" : "CTRL" ) ) ,
  BorderLayout.SOUTH ); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-25T16:22:29.267

有问题的符号可通过 Unicode 和 HTML 字符集获得。您需要做的就是让您的 JLabel 显示 HTML，方法是使用 <html> 开始其文本字符串，然后包含字符代码。

```
JLabel label = new JLabel( "<html>&#8984; is the Apple command symbol." ); 
```

这将在 Mac 上运行，但我不知道它会在其他平台上做什么，尽管你似乎已经掩盖了这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-25T18:03:32.400

正如大卫指出的那样，您可以使用 Unicode 转义序列`\u2318`，尽管它必须使用支持它的字体显示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T07:56:03.647

您的解决方案看起来很完美。我假设您打算分解提示代码以便重用它。

```
add( new JLabel( MessageFormat.format(
  "With {0} you can select multiple items", 
  getMetaKeyHint(),
  BorderLayout.SOUTH );

public String getMetaKeyHint() {
    return System.getProperty( "mrj.version" ) != null ? "COMMAND" : "CTRL" );
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T10:49:55.263

我使用以下代码检查系统并相应加载

```
(System.getProperty("os.name").toUpperCase(Locale.US).indexOf("MAC OS X") == 0 ) 
```

# web - 如何对 Web 表单文件上传进行压力测试？

> ID：229031
> 
> 赞同：4
> 
> 时间：2008-10-23T09:00:02.210
> 
> 标签：web, webforms, file-upload, bandwidth

我需要测试一个需要文件上传的网络表单。每次上传的文件大小约为 10 MB。我想测试服务器是否可以同时处理 100 多个上传，并且仍然对站点的其余部分保持响应。

从我们办公室重复提交的表格将受到我们当地 DSL 线路的限制。服务器在异地，带宽更高。

基于经验的答案会很棒，但欢迎任何建议。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-27T14:59:38.473

使用与 Apache 捆绑在一起的[ab (ApacheBench)](http://httpd.apache.org/docs/2.0/programs/ab.html)命令行工具（我刚刚发现了这个很棒的小工具）。与 cURL 或 wget 不同，ApacheBench 设计用于在 Web 服务器（任何类型的 Web 服务器！）上执行压力测试。它也产生大量统计数据。以下命令将发送包含文件的 HTTP POST 请求`test.jpg`100`http://localhost/` 次，最多 4 个并发请求。

```
ab -n 100 -c 4 -p test.jpg http://localhost/ 
```

它产生如下输出：

```
Server Software:        
Server Hostname:        localhost
Server Port:            80

Document Path:          /
Document Length:        0 bytes

Concurrency Level:      4
Time taken for tests:   0.78125 seconds
Complete requests:      100
Failed requests:        0
Write errors:           0
Non-2xx responses:      100
Total transferred:      2600 bytes
HTML transferred:       0 bytes
Requests per second:    1280.00 [#/sec] (mean)
Time per request:       3.125 [ms] (mean)
Time per request:       0.781 [ms] (mean, across all concurrent requests)
Transfer rate:          25.60 [Kbytes/sec] received

Connection Times (ms)
          min  mean[+/-sd] median   max
Connect:        0    0   2.6      0      15
Processing:     0    2   5.5      0      15
Waiting:        0    1   4.8      0      15
Total:          0    2   6.0      0      15

Percentage of the requests served within a certain time (ms)
  50%      0
  66%      0
  75%      0
  80%      0
  90%     15
  95%     15
  98%     15
  99%     15
 100%     15 (longest request) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-23T09:09:15.030

我可能会指导您使用 cURL 并仅提交随机内容（例如，读取 10MB`/dev/urandom`并将其编码为 base32），通过 POST 请求并手动将主体制作为文件上传（这不是火箭科学）。

将该脚本分叉 100 次，可能在几台服务器上。只要确保系统管理员不认为你在做 DDoS 或其他什么 :)

不幸的是，这个答案仍然有点模糊，但希望它可以帮助你，让你走上正确的道路。

**根据 Liam 的评论继续：**
如果接收上传的服务器与连接到它的客户端不在同一个 LAN 中，最好尽可能地获取远程节点进行压力测试，如果只是为了模拟尽可能真实的行为。但是，如果您无法访问本地 LAN 之外的计算机，则本地 LAN 总比没有好。

在同一硬件内部进行压力测试不是一个好主意，因为您会在服务器上进行双重加载：找出随机数据，打包它，通过 TCP/IP 堆栈发送它（尽管可能不是通过以太网），以及*只有这样*，服务器才能发挥它的魔力。如果发送部分是外包的，那么接收端的性能会加倍（使用任意大小的盐）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T09:12:00.267

使用您最喜欢的语言自动化[Selenium RC 。](http://selenium-rc.openqa.org/)启动 100 个 Selenium 线程，每个线程在输入中输入文件路径并单击提交。

您可以生成 100 个按顺序命名的文件，以便轻松循环它们，或者只是一遍又一遍地使用同一个文件

# sql-server - 为什么要缩小 sqlserver 2005 数据库？

> ID：229052
> 
> 赞同：5
> 
> 时间：2008-10-23T09:09:58.023
> 
> 标签：sql-server, performance, storage, filesize

缩小数据库的优缺点是什么？是否有任何性能影响？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-23T09:12:54.133

*   优点：使用的磁盘空间更少
*   缺点：更容易耗尽空间

基本上就是这样 - 一个没有可用空间的缩小数据库需要“增长”才能完成几乎所有操作。

当 SQL 用完 MDF 文件中的空间时，它必须增大它，这*非常*缓慢且昂贵。

如果您知道文件中有足够的空间，请继续缩小。请注意碎片文件，因为如果是碎片文件，您需要在之后重新索引。

基本示例：

500MB 数据库文件，已使用 400MB。您可以将其缩小到 400MB，但下一个操作会非常慢，因为 SQL 会在大小上增加 40MB（默认为 10%）。

500MB 数据库文件，已使用 50MB。你可能在浪费空间。把它缩小到 100MB，数据库仍然有空间做很多事情。

500MB 数据库文件，50MB 已使用，但即将导入数百万条记录。让它不收缩。导入后再次检查。

只读数据库应始终缩小。

# ruby-on-rails - 在 irb 或脚本/控制台中解释 \n

> ID：229058
> 
> 赞同：2
> 
> 时间：2008-10-23T09:12:34.993
> 
> 标签：ruby-on-rails, ruby

当使用类似的东西时，`object.methods.sort.to_yaml`我想让 irb 解释 \n 字符而不是打印它们。

我目前得到以下输出：

```
--- \n- "&"\n- "*"\n- +\n- "-"\n- "<<"\n- <=>\n ... 
```

我想要的是类似于这样的东西：

```
--- 
 - "&"
 - "*"
 - +
 - "-"
 - "<<"
 - <=> 
```

这可能吗？我可以调用另一种方法来解释字符串吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-23T09:16:00.820

在您的输出前加上`puts`：

```
> puts object.methods.sort.to_yaml
--- 
 - "&"
 - "*"
 - +
 - "-"
 - "<<"
 - <=>
 => nil 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T09:51:14.057

另一种选择是使用 noinspect 选项启动 irb：

```
C:\>irb --noinspect
irb(main):001:0> Object.methods.to_yaml
=> ---
- instance_method
- yaml_tag_read_class
.....
- constants
- is_a?

irb(main):002:0> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-26T17:53:52.060

Ruby *yaml*库包含“ **y** ”命令，它负责 yamlizing 和格式化：

```
y object.methods.sort 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-23T09:15:33.877

这只是 irb - 我认为您无法控制`return`格式。

您仍然可以根据需要使用`print`或`puts`显示它。

# project-management - 如何向客户传达坏消息？

> ID：229067
> 
> 赞同：8
> 
> 时间：2008-10-23T09:17:11.830
> 
> 标签：project-management

如何向客户传达坏消息？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-23T09:43:11.840

当出现问题时，客户需要知道三件事：

1.  究竟出了什么问题
2.  对他们有什么影响
3.  你要怎么做

如果您不完全诚实和透明，您将在以后被发现并加剧麻烦。

如果你和他们的关系很好，那么你可能会活下来——假设这不是完全灾难性的——但你必须提供一个体面的补救措施。

如果你们的关系不好，那就做好准备，让他们根据合同条款开始对你强硬。

高温高压

附录：下面有一个很好的评论，关于尽快告诉他们，我很高兴按照要求在这个答案中出现。这让我想起了一句话“坏消息越早知道越详细，对每个人都越好”。在生活中如此，在项目管理中也是如此。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-23T09:22:48.263

强调您提出的解决坏消息的解决方案。

> 我们将无法在我们的系统中拥有月球控制功能（由于...），但我们可以并且将提供天气变化模块，这对您的世界统治计划几乎同样有益。

诚实并尝试提供有效和现实的解决方案，而不是最终会成为更坏消息的事情。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-23T09:40:49.240

管理您的客户/老板的期望是避免这种情况的好方法。

在工程学科中，古老的格言仍然正确：

> 承诺之下。在交付。

如果你已经得到了坏消息，那么：

*   坦诚相待。
*   让他们选择他们希望你如何解决它；详细说明成本估算。
*   不要做出任何进一步的承诺“弥补它”。如果您提出的某些解决方案提供了优势，请告诉他们；但不要说你会在解决问题的同时添加一个特性。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-23T09:44:31.917

“一次把坏消息传出去，一点点传好消息。——马基雅维利” :)

认真..事先调查损害控制或补救措施。将它们设置到位以确保它不会再次发生。如果需要，请退回到应急计划，你有一个.. 客观，真诚，道歉，不要玩责备游戏。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-23T11:00:44.790

说实话，因为没有什么比谎言更让人分心的了。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-30T20:48:35.827

[发表一个半开玩笑的道歉，最好从辛普森一家的艺术品开始](http://blog.dreamhost.com/2008/01/15/um-whoops/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-06T16:22:43.263

首先，理想情况下应该尽快传达坏消息，如果可能会产生某种财务影响，则更应如此。此外，当您传达坏消息时，您应该确保尽快解决所有问题，即：

*   什么地方出了错。
*   他们是如何受到影响的。
*   修复需要多长时间。
*   正在做什么以确保它不会再次发生。

你如何传递坏消息是一个很大的主观因素，但经验法则似乎是你应该亲自传递它（例如电话）。此外，即使你还不知道发生了什么，你至少应该让人们知道你已经意识到一个问题并且你正在解决它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-23T09:22:10.683

什么样的坏消息？

一般来说，人们喜欢通过声明更正/新的时间表将比我们真正能够完成的时间早得多来发布坏消息。坦诚相待，不要给予虚假的希望。一个坏消息的例子就足够了......无需创建您将来无法兑现的新承诺。

底线：对您的客户和您自己诚实以控制期望管理。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-06T20:44:22.253

我通常做的是：

**好消息** *坏消息* **好消息**

而且，对于您如何执行坏消息，已经提到的答案就足够了。所以，你每次都应该有两个好消息，或者你把一分为二:)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-30T20:46:23.270

这是一个简短的哈佛商业评论播客的链接，标题为：[在艰难时刻说得好](http://www.hbsp.harvard.edu/b02/en/misc/ideacast/archives_hbrideacast.jhtml#episode114)

在播客中，他们提出了您必须进行艰难对话的不同场景。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-23T12:14:11.693

除了诚实和直截了当，同样重要的是你如何传达新闻。一个简单的“你注定要失败”的陈述可能是诚实的，但却是不恰当的。重要的是要告知客户您所做的所有尽职调查，有哪些（如果有）可供他使用的选项或解决方法，并建议与他一起寻找前进的道路。你并没有误导客户，而是试图为他提供一些思考的途径，并意识到你不仅仅是把所有东西都扔在他的盘子里。

# c++ - 遗留 C/C++ 项目中的死代码检测

> ID：229069
> 
> 赞同：68
> 
> 时间：2008-10-23T09:18:25.010
> 
> 标签：c++, automation, static-analysis, legacy-code, dead-code

您将如何在 C/C++ 代码中进行死代码检测？我有一个相当大的代码库可供使用，至少 10-15% 是死代码。是否有任何基于 Unix 的工具来识别这些区域？有些代码仍然使用大量的预处理器，自动化过程可以处理吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-10-23T09:38:59.103

您可以为此使用代码覆盖率分析工具，并在代码中查找未使用的点。

gcc 工具链的一个流行工具是 gcov，以及图形前端 lcov ( [http://ltp.sourceforge.net/coverage/lcov.php](http://ltp.sourceforge.net/coverage/lcov.php) )。

如果您使用 gcc，则可以使用 gcov 支持进行编译，该支持由“--coverage”标志启用。接下来，运行您的应用程序或使用此启用 gcov 的构建运行您的测试套件。

基本上 gcc 会在编译期间发出一些额外的文件，并且应用程序也会在运行时发出一些覆盖率数据。您必须收集所有这些（.gcdo 和 .gcda 文件）。我不会在这里详细介绍，但您可能需要设置两个环境变量以理智的方式收集覆盖率数据：GCOV_PREFIX 和 GCOV_PREFIX_STRIP...

运行后，您可以将所有覆盖率数据放在一起，并通过 lcov 工具包运行。合并来自不同测试运行的所有覆盖文件也是可能的，尽管有点涉及。

无论如何，你最终会得到一组漂亮的网页，显示一些覆盖信息，指出没有覆盖的代码片段，因此没有被使用。

当然，您需要仔细检查代码部分是否在任何情况下都没有使用，这在很大程度上取决于您的测试对代码库的执行情况。但至少，这将给出一个关于可能的死代码候选者的想法......

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-10-23T14:50:23.797

在 gcc 下使用 -Wunreachable-code 编译它。

我认为版本越新，你会得到更好的结果，但我的印象可能是错误的，因为这是他们一直在积极努力的事情。请注意，这会进行流分析，但我不相信它会告诉您在离开预处理器时已经死掉的“代码”，因为编译器从未解析过它。它也不会检测到例如从未调用过的导出函数，或者恰好是不可能的特殊情况处理代码，因为没有任何东西使用该参数调用函数 - 你需要代​​码覆盖（并运行功能测试，而不是单元测试。单元测试*应该是*具有 100% 的代码覆盖率，因此就应用程序而言执行“死”的代码路径）。尽管如此，考虑到这些限制，这是一种开始在代码库中查找最完整的 bollixed 例程的简单方法。

[此 CERT 公告列出了一些其他用于静态死代码检测的工具](https://www.securecoding.cert.org/confluence/display/seccode/MSC07-C.+Detect+and+remove+dead+code)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-23T14:30:40.450

您的方法取决于可用性（自动化）测试。如果您有一个您信任的测试套件可以涵盖足够数量的功能，则可以使用覆盖率分析，正如之前的答案已经建议的那样。

如果你不是那么幸运，你可能想研究一下源代码分析工具，比如[SciTools](http://www.scitools.com/products/understand/)的“理解”，它可以帮助你使用大量内置的分析报告来分析你的代码。我使用该工具的经验可以追溯到 2 年前，因此我无法为您提供太多详细信息，但我确实记得他们提供了令人印象深刻的支持，以及非常快的错误修复和问题答案的周转时间。

我找到了一个关于[静态源代码分析](http://spinroot.com/static/)的页面，其中还列出了许多其他工具。

如果这也对您没有足够的帮助，并且您对找出与预处理器相关的死代码特别感兴趣，我建议您发布有关该代码的更多详细信息。例如，如果它主要与 #ifdef 设置的各种组合相关，您可以编写脚本来确定设置（的组合）并找出哪些组合从未真正构建，等等。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-23T18:32:30.617

[Mozilla](https://wiki.mozilla.org/DXR)和[Open Office](http://www.csn.ul.ie/~caolan/Packages/callcatcher.html)都有自己开发的解决方案。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-07-16T20:55:02.220

仅针对 C 代码并假设整个项目的源代码可用，使用开源工具[Frama-C](http://frama-c.com/)启动分析。任何在 GUI 中显示为红色的程序语句都是死代码。

如果您有“死代码”问题，您可能也有兴趣删除“备用代码”，即执行但对最终结果没有贡献的代码。这要求您提供 I/O 函数的准确建模（您不希望删除看似“备用”但用作 的参数的计算`printf`）。Frama-C 有一个用于指出多余代码的选项。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-18T21:41:23.343

g++ 4.01 -Wunreachable-code 对函数内无法访问的代码发出警告，但不对未使用的函数发出警告。

```
int foo() { 
    return 21; // point a
}

int bar() {
  int a = 7;
  return a;
  a += 9;  // point b
  return a;
}

int main(int, char **) {
    return bar();
} 
```

g++ 4.01 将发出关于点 b 的警告，但对 foo() (点 a) 只字不提，即使它在此文件中不可访问。尽管令人失望，但这种行为是正确的，因为编译器无法知道函数 foo() 没有在其他编译单元中声明为 extern 并从那里调用；只有链接器可以确定。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-07-03T09:54:31.710

像这样的死代码分析需要对整个项目进行全局分析。您无法通过单独分析翻译单元来获取此信息（好吧，如果它们完全位于单个翻译单元中，您可以检测到死实体，但我认为这不是您真正想要的）。

我们已经使用我们的 DMS Software Reengineering Toolkit 为 Java 代码准确地实现了这一点，通过一次解析所有涉及的编译单元，为所有内容构建符号表并追踪所有引用。没有引用且没有声称是外部 API 项的顶级定义已死。这个工具还会自动去除死代码，最后你可以选择你想要的：死实体的报告，或者那些实体的代码剥离。

DMS 还解析各种方言中的 C++（2014 年 2 月编辑：[包括 C++14 的 MS 和 GCC 版本 [2017 年 11 月编辑：现为 C++17]](http://www.semanticdesigns.com/Products/FrontEnds/CppFrontEnd.html?site=StackOverflow)）并构建所有必要的符号表。从那时起，追踪死引用就很简单了。DMS 也可用于剥离它们。请参阅[http://www.semanticdesigns.com/Products/DMS/DMSToolkit.html](http://www.semanticdesigns.com/Products/DMS/DMSToolkit.html)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-23T09:23:23.520

[Bullseye](http://www.bullseye.com/)覆盖工具会有所帮助。虽然它不是免费的。

# sql-server - SQL Server 报告服务

> ID：229071
> 
> 赞同：0
> 
> 时间：2008-10-23T09:19:59.033
> 
> 标签：sql-server, reporting-services

如何在文本框中显示特定字段的所有值？？？IE。例如。当你运行 SP 时，你会得到 3 行。我想在文本框中显示（eg.empname），每个值用逗号分隔。（拉姆，约翰，西塔）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-23T10:42:48.803

I had this problem the other day. If you are using SQL 2005 you can use the CROSS APPLY function.

Here is a sample;

```
Structure; 
ID TYPE TEXT
1 1 Ram
2 1 Jon
3 2 Sita
4 2 Joe

Expecteed Output;
ID TYPE TEXT
1 1 Ram, Jon
2 2 Sita, Joe

Query; 
SELECT t.TYPE,LEFT(tl.txtlist,LEN(tl.txtlist)-1)
FROM(SELECT DISTINCT TYPE FROM Table)t
CROSS APPLY (SELECT TEXT + ','
             FROM Table
             WHERE TYPE=t.TYPE
             FOR XML PATH(''))tl(txtlist) 
```

Hope this helps :)

Remember you'll need to select this as something in your sp, then bind that to the textbox on your report. Good luck!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-28T06:22:14.133

在 2005 年，交叉应用看起来像是一个很好的解决方案（我自己没有使用过）。我通常通过创建一个通过游标循环连接值的 UDF 来解决这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-05T20:52:31.177

问题应该是“如何连接行” [http://databases.aspfaq.com/general/how-do-i-concatenate-strings-from-a-column-into-a-single-row.html](http://databases.aspfaq.com/general/how-do-i-concatenate-strings-from-a-column-into-a-single-row.html)

CROSS APPLY 作品或 FOR XML 与游标相比是不错的替代品

```
SELECT 
CustomerID, 
SalesOrderIDs = REPLACE( 
    ( 
        SELECT 
            SalesOrderID AS [data()] 
        FROM 
            Sales.SalesOrderHeader soh 
        WHERE 
            soh.CustomerID = c.CustomerID 
        ORDER BY 
            SalesOrderID 
        FOR XML PATH ('') 
    ), ' ', ',') 
```

FROM Sales.Customer c ORDER BY CustomerID

您也可以使用 Number/Tally 表

# c# - 如何将 %programfiles%\directory\tool.exe 形式的字符串转换为 C#/.net 中的可用文件名？

> ID：229073
> 
> 赞同：8
> 
> 时间：2008-10-23T09:20:42.603
> 
> 标签：c#, .net, file

我有一个应用程序，它从其应用程序配置文件中**获取 %programfiles%\directory\tool.exe**形式的字符串值。

我想把它变成一个可用的文件名，这样我就可以调用

```
System.Diagnostics.Process.Start(filename) 
```

并让它执行应用程序。我目前收到**System.ComponentModel.Win32Exception - 系统找不到指定的文件**

非常感谢您对此的任何帮助。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-23T09:22:52.427

```
filename = Environment.ExpandEnvironmentVariables(filename); 
```

# visual-studio-2008 - 如何将 VisualSVN 与 VS 2005 和 VS 2008 之间共享的解决方案一起使用？

> ID：229076
> 
> 赞同：0
> 
> 时间：2008-10-23T09:21:22.447
> 
> 标签：visual-studio-2008, version-control, visual-studio-2005, projects-and-solutions

在查看与在 VS 2005 和 VS 2008 之间共享解决方案相关的其他问题之后，似乎要走的路是拥有两个解决方案文件（一个用于 VS 2005，一个用于 VS 2008）。

但是，如果解决方案受源代码控制（在我们的例子中是 VisualSVN），我们将如何维护两个解决方案文件而不是在每次更新/提交时不断覆盖一个或另一个？

是否可以仅从源代码管理中删除 .sln 文件并阻止 VisualSVN 客户端检查其在 Visual Studio 中的状态？

谢谢

马特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-23T09:43:18.097

我不确定我是否看到了问题 - 如果您有两个解决方案文件，为什么它们中的任何一个都会被覆盖？我的意思是两个文件，例如 MyApp2005.sln 和 MyApp2008.sln，当您创建一个新项目时，您在 2005 解决方案中执行此操作，然后在 2008 解决方案中“添加现有项目”。

VisualSVN 会做些什么来搞砸这个？

[（我在深度源代码中](http://csharpindepth.com/Downloads.aspx)为我的 C# 设置了相同的设置，并且我使用 VisualSVN - 我没有看到任何问题。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-23T10:09:08.700

它现在正在工作。

我试图将解决方案升级/转换为 2008（解决方案名称与 2005 相同）并以某种方式阻止 2008 解决方案文件提交/更新。

我现在在 VS 2008（不同的名称）中创建了一个新的空白解决方案，并按照您的建议使用了“添加现有项目”。

谢谢

马特

# php - 正则表达式错误：PHP 中的“警告：ereg() [function.ereg]:REG_ERANGE”

> ID：229078
> 
> 赞同：0
> 
> 时间：2008-10-23T09:21:25.100
> 
> 标签：php, regex

下面的代码给了我这个神秘的错误，我无法理解它。我是正则表达式的新手，因此被难住了。正则表达式应该验证任何国际电话号码。

任何帮助将非常感激。

```
function validate_phone($phone)
{
    $phoneregexp ="^(\+[1-9][0-9]*(\([0-9]*\)|-[0-9]*-))?[0]?[1-9][0-9\- ]*$";

    $phonevalid = 0;

    if (ereg($phoneregexp, $phone))
    {
        $phonevalid = 1;
    }else{
        $phonevalid = 0;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T09:26:52.263

嗯，您粘贴的代码不太有效，我通过添加缺少的引号、缺少的分隔符并将 preg 更改为 preg_match 来修复它。我没有收到警告。

**编辑**：在看到其他评论后，您的意思是“ereg”而不是“preg”......这会发出警告。尝试`preg_match()`改用 ;)

```
<?php
function validate_phone($phone) {
    $phoneregexp ='/^(\+[1-9][0-9]*(\([0-9]*\)|-[0-9]*-))?[0]?[1-9][0-9\- ]*$/';

    $phonevalid = 0;

    if (preg_match($phoneregexp, $phone)) {
        $phonevalid = 1;
    } else {
        $phonevalid = 0;
    }
}
validate_phone("123456");
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T09:24:05.390

如果这是 PHP，那么正则表达式必须用引号引起来。~~此外，什么是`preg`？你的意思是`preg_match`？~~

另一件事。PHP 知道布尔值。规范的解决方案宁愿看起来像这样：

```
return preg_match($regex, $phone) !== 0; 
```

编辑：或者，使用`ereg`：

```
return ereg($regex, $phone) !== FALSE; 
```

（在这里，明确的测试`FALSE`并不是绝对必要的，但由于`ereg`成功返回一个数字，我觉得将值强制转换为 a 更安全`bool`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T09:28:46.037

只是为了提供一些参考资料，请阅读

*   [正则表达式（Perl 兼容）](http://de.php.net/manual/en/book.pcre.php)
*   [preg_match()](http://de.php.net/manual/en/function.preg-match.php)

或者如果您想坚持使用 POSIX 正则表达式：

*   [正则表达式（POSIX 扩展）](http://de.php.net/manual/en/book.regex.php)
*   [ereg()](http://de.php.net/manual/en/function.ereg.php)

上面已经给出了正确的示例代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-23T09:33:06.993

这`[0-9\\- ]`是您的 RE 的一部分 - 它没有`-`正确地转义 " "。将其更改为`[0-9 -]`，您应该没问题（`-`字符类中最后一个位置的“”被视为文字，而不是范围规范的一部分）。

# javascript - 类方法作为 JavaScript 中的事件处理程序？

> ID：229080
> 
> 赞同：28
> 
> 时间：2008-10-23T09:21:47.423
> 
> 标签：javascript, html, function, class

JavaScript 中是否有最佳实践或通用方法将类成员作为事件处理程序？

考虑以下简单示例：

```
<head>
    <script language="javascript" type="text/javascript">

        ClickCounter = function(buttonId) {
            this._clickCount = 0;
            document.getElementById(buttonId).onclick = this.buttonClicked;
        }

        ClickCounter.prototype = {
            buttonClicked: function() {
                this._clickCount++;
                alert('the button was clicked ' + this._clickCount + ' times');
            }
        }

    </script>
</head>
<body>
    <input type="button" id="btn1" value="Click me" />
    <script language="javascript" type="text/javascript">
        var btn1counter = new ClickCounter('btn1');
    </script>
</body> 
```

事件处理程序 buttonClicked 被调用，但 _clickCount 成员不可访问，或者*this*指向其他对象。

关于这类问题的任何好的提示/文章/资源？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-10-23T09:33:42.470

```
ClickCounter = function(buttonId) {
    this._clickCount = 0;
    var that = this;
    document.getElementById(buttonId).onclick = function(){ that.buttonClicked() };
}

ClickCounter.prototype = {
    buttonClicked: function() {
        this._clickCount++;
        alert('the button was clicked ' + this._clickCount + ' times');
    }
} 
```

几乎 10 年后编辑，使用 ES6、箭头函数和[类属性](https://babeljs.io/docs/plugins/transform-class-properties/)

```
class ClickCounter  {
   count = 0;
   constructor( buttonId ){
      document.getElementById(buttonId)
          .addEventListener( "click", this.buttonClicked );
  }
   buttonClicked = e => {
     this.count += 1;
     console.log(`clicked ${this.count} times`);
   }
} 
```

[https://codepen.io/anon/pen/zaYvqq](https://codepen.io/anon/pen/zaYvqq)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-03-19T13:00:47.483

I don't know why [`Function.prototype.bind`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind) wasn't mentioned here yet. So I'll just leave this here ;)

```
ClickCounter = function(buttonId) {
    this._clickCount = 0;
    document.getElementById(buttonId).onclick = this.buttonClicked.bind(this);
}

ClickCounter.prototype = {
    buttonClicked: function() {
        this._clickCount++;
        alert('the button was clicked ' + this._clickCount + ' times');
    }
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-23T10:05:05.307

直接附加到 onclick 属性的函数将使执行上下文的`this`属性指向元素。

当您需要一个元素事件来针对对象的特定实例（.NET 中的委托）运行时，您将需要一个闭包：-

```
function MyClass() {this.count = 0;}
MyClass.prototype.onclickHandler = function(target)
{
   // use target when you need values from the object that had the handler attached
   this.count++;
}
MyClass.prototype.attachOnclick = function(elem)
{
    var self = this;
    elem.onclick = function() {self.onclickHandler(this); }
    elem = null; //prevents memleak
}

var o = new MyClass();
o.attachOnclick(document.getElementById('divThing')) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-03-19T16:22:21.983

You can use fat-arrow syntax, which binds to the lexical scope of the function

```
function doIt() {
  this.f = () => {
    console.log("f called ok");
    this.g();
  }
  this.g = () => {
    console.log("g called ok");
  }
} 
```

After that you can try

```
var n = new doIt();
setTimeout(n.f,1000); 
```

You can try it on [babel](https://babeljs.io/repl/#?evaluate=true&presets=es2015%2Ces2015-loose%2Creact%2Cstage-0&experimental=true&loose=true&spec=false&code=%0Afunction%20doIt2()%20%7B%0A%20%20this.f%20%3D%20()%20%3D%3E%20%7B%0A%20%20%20%20console.log(%22f%20called%20ok%22)%3B%0A%20%20%20%20this.g()%3B%0A%20%20%7D%0A%20%20this.g%20%3D%20()%20%3D%3E%20%7B%0A%20%20%20%20console.log(%22g%20called%20ok%22)%3B%0A%20%20%7D%0A%7D%0Aclass%20doIt%20%7B%0A%20%20%20%20f()%20%7B%0A%20%20%20%20%20%20console.log(%22f%20called%22)%3B%0A%20%20%20%20%20%20this.g()%3B%0A%20%20%20%20%7D%0A%20%20%20%20g()%20%7B%0A%20%20%20%20%20%20console.log(%22g%20called%22)%3B%0A%20%20%20%20%7D%0A%7D%0A%0Avar%20n%20%3D%20new%20doIt()%3B%0An.f()%3B%0Avar%20n2%20%3D%20new%20doIt2()%3B%0An2.f()%3B%0A%0AsetTimeout(n.f%2C1000)%3B%0AsetTimeout(n2.f%2C1000)%3B%0A%0A%0A%0A%0A%0A%0A%0A) or if your browser supports ES6 on [jsFiddle](https://jsfiddle.net/tbr976b7/).

Unfortunately the ES6 Class -syntax does not seem to allow creating function lexically binded to this. I personally think it might as well do that. EDIT: There seems to be [experimental ES7 feature to allow it](https://stackoverflow.com/questions/31362292/can-i-use-es6-fat-arrow-in-class-methods).

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-08T16:55:05.657

I like to use `unnamed` functions, just implemented a navigation Class which handles this correctly:

```
this.navToggle.addEventListener('click', () => this.toggleNav() ); 
```

then `this.toggleNav()` can be just a function in the `Class`.

I know I used to call a named function but it can be any code you put in between like this :

```
this.navToggle.addEventListener('click', () => { [any code] } ); 
```

Because of the `arrow` you pass the this instance and can use it there.

Pawel had a little different convention but I think its better to use `functions` because the naming conventions for `Classes` and `Methods` in it is the way to go :-)

# apache - Apache MOD_REWRITE 域级 Cookie

> ID：229100
> 
> 赞同：1
> 
> 时间：2008-10-23T09:30:08.187
> 
> 标签：apache, mod-rewrite, cookies

我需要处理我们网站上的会员跟踪。

在我们的 .htaccess 中，我们有：

```
RewriteCond %{QUERY_STRING} affiliate=(.*)
RewriteRule ^(.*)$ $1?  [NC,R,L,co=AFFID:%1:%{HTTP:Host}:7200:/] 
```

它创建了一个名为 AFFID 的 COOKIE，其 URL 参数附属公司的值。

但是 Cookie 并不适用于整个域，即转到[http://www.domain.com/?affiliate=bmk](http://www.domain.com/?affiliate=bmk)将 AFFID cookie 设置为 .www.domain.com 的值为 bmk 但我希望 ti 用于.domain.com 以便它可以在我们的安全域中使用，这将是 secure.domain.com

任何帮助，将不胜感激

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T09:39:25.077

你为什么不直接硬编码呢？

```
RewriteRule ^(.*)$ $1?  [NC,R,L,co=AFFID:%1:.domain.com:7200:/] 
```

如果你不能这样做，你必须匹配域，像这样（未经测试）：

```
RewriteCond %{QUERY_STRING} affiliate=(.*)
#This would work only for xxx.dom.com or dom.com forms, not for x.y.dom.com
RewriteCond %{HTTP_HOST} [^.]*?\.?([^.]+\.[^.]+) 
RewriteRule ^(.*)$ $1?  [NC,R,L,co=AFFID:%1:.%2:7200:/] 
```

# java - 原型模式的 Java 实现

> ID：229112
> 
> 赞同：1
> 
> 时间：2008-10-23T09:34:17.413
> 
> 标签：java, oop, design-patterns, prototype-pattern

Java 平台上有哪些[原型模式的实现？](http://en.wikipedia.org/wiki/Prototype_pattern)

> 原型模式是软件开发中使用的创建型设计模式，当要创建的对象类型由原型实例确定时，原型实例被克隆以生成新对象。

[基于原型的编程](http://en.wikipedia.org/wiki/Prototype-based_programming)：

> 基于原型的编程是一种面向对象的编程风格，其中不存在类，行为重用（在基于类的语言中称为继承）是通过克隆作为原型的现有对象的过程来执行的。

实现应该知道有些 Java 对象是可变的，有些是不可变的（请参阅[Mutable vs Immutable objects](https://stackoverflow.com/questions/214714/mutable-vs-immutable-objects)）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T09:50:57.707

根据 Josh Bloch 和 Doug Lea 的说法，[Cloneable 已损坏](http://www.artima.com/intv/bloch13.html)。在这种情况下，您可以使用[复制构造函数](http://www.javapractices.com/topic/TopicAction.do?Id=12)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-23T09:35:19.813

Java 定义了[Cloneable](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Cloneable.html)接口，在[JGuru中进行了描述](http://www.jguru.com/faq/view.jsp?EID=255004)

> Java 提供了一个名为 Cloneable 的简单接口，它提供了原型模式的实现。如果你有一个可克隆的对象，你可以调用它的 clone() 方法来创建一个具有相同值的对象的新实例。

警告：请参阅[Cloneable 已损坏](http://www.artima.com/intv/bloch13.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T09:36:32.510

[Steve Yegge](http://steve-yegge.blogspot.com/2008/10/universal-design-pattern.html)描述了[ASTNode的](http://publib.boulder.ibm.com/infocenter/rsdhelp/v7r0m0/index.jsp?topic=/org.eclipse.jdt.doc.isv/reference/api/org/eclipse/jdt/core/dom/package-summary.html)[Eclipse](http://www.eclipse.org/)实现

# .net - XamlParseException：自定义控件中的属性缺失，但已定义！

> ID：229117
> 
> 赞同：0
> 
> 时间：2008-10-23T09:37:31.087
> 
> 标签：.net, silverlight, silverlight-2.0

我的自定义控件*有时会出现以下异常：*

`XamlParseException occurred` `Unknown attribute Points in element SectionClickableArea [Line: 10 Position 16]`

堆栈跟踪：

```
{System.Windows.Markup.XamlParseException: Unknown attribute Points on element SectionClickableArea. [Line: 10 Position: 16]
   at System.Windows.Application.LoadComponent(Object component, Uri resourceLocator)
   at SomeMainDialog.InitializeComponent()
   at SomeMainDialog..ctor()} 
```

发生这种情况的元素声明如下所示（当然，此处引用的**事件处理程序**已定义）：

```
<l:SectionClickableArea x:Name="SomeButton" 
    Points="528,350, 508,265, 520,195, 515,190, 517,165, 530,120, 555,75, 570,61, 580,60, 600,66, 615,80, 617,335, 588,395, 550,385, 540,390, 525,393, 520,385" 
    Click="SomeButton_Click"/> 
```

这是代码的一部分`SectionClickableArea`：

```
public partial class SectionClickableArea : Button {

    public static readonly DependencyProperty PointsProperty
        = DependencyProperty.Register("Points", typeof(PointCollection), typeof(SectionClickableArea),
            new PropertyMetadata((s, e) => {
                SectionClickableArea area = (SectionClickableArea) s;
                area.areaInfo.Points = (PointCollection) e.NewValue;
                area.UpdateLabelPosition();
            }));
    public PointCollection Points {
        get { return (PointCollection) GetValue(PointsProperty); }
        set { SetValue(PointsProperty, value); }
    } 
```

我将此控件用于多边形按钮之类的东西。因此我从按钮继承。使用此控件数周以来，我遇到了类似的问题（`E_AG_BAD_PROPERTY_VALUE`在另一个`DependencyProperty`字符串类型上，根据给定的行和列等），但我完全不知道为什么。

* * *

今天早上另一个用户发生了相同控件的另一个异常（取自日志并翻译自德语）：

```
Type: System.InvalidCastException Message: The object of type System.Windows.Controls.ContentControl could not be converted to type [...]SectionClickableArea. at SomeOtherMainDialog.InitializeComponent()
    at SomeOtherMainDialog..ctor() 
```

内部异常：

```
Type: System.Exception Message:  An HRESULT E_FAIL error was returned when calling COM component at MS.Internal.XcpImports.CheckHResult(UInt32 hr)
    at MS.Internal.XcpImports.SetValue(INativeCoreTypeWrapper obj, DependencyProperty property, DependencyObject doh)
    at MS.Internal.XcpImports.SetValue(INativeCoreTypeWrapper doh, DependencyProperty property, Object obj)
    at System.Windows.DependencyObject.SetObjectValueToCore(DependencyProperty dp, Object value)
    at System.Windows.DependencyObject.SetValueInternal(DependencyProperty dp, Object value, Boolean allowReadOnlySet, Boolean isSetByStyle, Boolean isSetByBuiltInStyle)
    at System.Windows.DependencyObject.SetValueInternal(DependencyProperty dp, Object value)
    at System.Windows.DependencyObject.SetValue(DependencyProperty dp, Object value)
    at System.Windows.Controls.Control.set_DefaultStyleKey(Object value)
    at System.Windows.Controls.ContentControl..ctor()
    at System.Windows.CoreTypes.GetCoreWrapper(Int32 typeId)
    at MS.Internal.ManagedPeerTable.EnsureManagedPeer(IntPtr unmanagedPointer, Int32 typeIndex, Type type, Boolean preserveManagedObjectReference)
    at MS.Internal.ManagedPeerTable.EnsureManagedPeer(IntPtr unmanagedPointer, Int32 typeIndex, Type type)
    at MS.Internal.ManagedPeerTable.GetManagedPeer(IntPtr nativeObject)
    at MS.Internal.FrameworkCallbacks.SetPropertyAttribute(IntPtr nativeTarget, String attrName, String attrValue, String attachedDPOwnerNamespace, String attachedDPOwnerAssembly) 
```

任何想法控件有什么问题，或者我可以做些什么来找到这些异常的来源？正如我所说，这些问题仅在控件实例化几十次时发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-30T11:37:59.607

我也遇到过这个问题。我对此没有很好的解释（似乎是 XAML 解析错误），但我已通过向 XAML 添加以下代码来修复它：

```
<UserControl.Resources>
   <customNamespace:InheritedControl x:Name="dummyInstance"/>
</UserControl.Resources> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T14:13:35.430

我认为我们看到了同样的问题。我只是更频繁地得到 invalidcast 异常。当通过对东西的盲目评论，我可以抑制无效转换时，我有时确实会得到一个属性的属性缺失错误，事实上，在那里。你找到解决办法了吗？

顺便说一句：重现它的简单方法是加载有问题的应用程序并反复按 F5 以刷新页面。你最终会得到它。

我还看到了来自 DependencyObject.get_NativeObject() 的间歇性 InvalidOperationException。

在此处查看我的 SO 问题： [UserControl.InitializeComponent() 中的间歇性 InavlidCastException](https://stackoverflow.com/questions/470942/intermittent-inavlidcastexception-in-a-usercontrol-initializecomponent)

在此处查看我的 silverlight.net 错误报告：http: [//silverlight.net/forums/t/67732.aspx](http://silverlight.net/forums/t/67732.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-02T11:15:59.730

我有同样的问题。在我的情况下，错误发生在其中一名成员身上。成员构造函数引发异常。
我通过在 InitializeComponent() 方法之前放置断点并在调试模式下按 F11 进入 Step Into 并发现错误来解决它。
希望这会有所帮助。
谢谢。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T05:22:45.377

我不是 XAML 专家，但您是否缺少 Points 上的命名空间（例如 l:Points）？

# java - java：与批处理服务器通信的最佳技术是什么？

> ID：229131
> 
> 赞同：3
> 
> 时间：2008-10-23T09:41:38.473
> 
> 标签：java, standards, communication

我有一个 WEB 应用程序（带有纯 Java servlet），它有一些繁重的计算工作，具有数据库访问权限，可以在异步模式下完成。我计划使用专用服务器来执行此类批处理作业，并且我想知道使用哪些工具/技术/协议在 WEB 服务器中的 servlet 和新专用服务器中的批处理作业之间进行通信。我在看JMS。这是正确的选择吗？有行业标准和/或广泛采用的技术吗？我还需要同时处理多个作业的队列和优先级处理。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-23T10:47:47.343

JMS is a pretty standard solution. The high-end platforms (Sun's JCAPS, for example) makes heavy use of JMS to partition and manage the workload of web services.

There are many advantages to buying a high-end JMS implementation from Sun (or IBM or Microsoft). First, you get things like reliable message queues that are backed to the file system. No message can get lost. Second, you get some monitoring and management tools.

One cool thing is to have a JMS queue with (potentially) multiple subscribers to do workload balancing.

Another cool thing is to have JMS topic which has a logging process as well as the real work process subscribed. The logging process picks off the messages and simply records the essential stages of the job being started and stopped.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-23T10:08:55.923

消息传递是最好的选择之一。

使消息传递框架非常通用，以便它可以处理任何类型的批处理作业。

一种方法是拥有一个事件/任务管理器，您可以在其中将事件放在队列中，队列使用者处理该事件并将其转换为一组任务。然后可以由单独的任务处理程序执行任务。任务还可以生成更多事件，这些事件可以再次放入队列以提供反馈循环。通过这种方式，您可以将类似工作流的功能添加到框架中，并允许您的批处理作业相互依赖。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T13:57:28.833

JMS 将是从 servlet 发送批处理作业的合适解决方案。但它可能不是批处理服务器与 servlet 通信的最佳解决方案，因为它不能成为消息的侦听器。

由于我不知道从批处理服务器到 servlet 的通信应该包含什么内容，我只能说您可能可以使用几个选项（是的，JMS 就是其中之一）。但是它们基本上都依赖于对 servlet 的轮询调用，然后它将以某种方式检查批处理服务器是否有任何东西在等待。这可能只是批处理服务器上的 servlet 或对 JMS 响应队列进行接收调用。其他解决方案是可用的，但关键是它不是异步的，除非您能够通过 AJAX 之类的东西从批处理服务器一直推送到客户端（我猜是浏览器）。

无论如何，只是要记住一些事情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-23T14:13:02.280

异步处理的另一种替代方法是让 Web 应用程序将请求存储在数据库中，并让批处理轮询数据库以查找要处理的新批处理作业。由于您的应用程序看起来更小（纯 Java Servlet），这可能是一个更简单且成本更低的解决方案。

希望能帮助到你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-30T20:12:34.827

我们将 JMS 与 Web 服务一起使用：

1.  客户端通过 Web 服务请求计算
2.  服务器写入 JMS 消息，并创建一个 ID 值，该 ID 值与状态（最初为“待处理”）一起存储在数据库中。服务器将 id 返回给客户端。
3.  服务器（可以是单独的服务器）读取 JMS 消息，进行计算，完成后将数据库中的状态更新为“已完成”
4.  在计算过程中，客户端正在轮询服务器以确定使用另一个 Web 服务（连同 id）的状态。服务器返回从数据库中检索到的状态。一旦服务端计算完成，客户端会看到“Completed”状态并知道计算完成。

# iis - IIS中的url重写

> ID：229137
> 
> 赞同：1
> 
> 时间：2008-10-23T09:46:43.237
> 
> 标签：iis, isapi, plugins

这个问题与我昨天问的另一个问题有关！

[列出网站中的所有链接](https://stackoverflow.com/questions/220796/list-all-links-in-web-site)

我认为将所有 .html 文件重命名为 .asp 并更改链接不适合 SEP 目的。有人告诉我isapi插件可以用来重定向（301）所有.html文件到.asp文件。

任何人都可以为我解释一下吗？搜索对我没有多大帮助。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-23T12:11:17.393

我们一直在使用[Ionic 重写器](http://www.codeplex.com/IIRF)。它似乎工作得很好。您的应用程序不需要重写器的任何知识。您只需在 IIS 中配置它，它就会重定向您的链接。它也是免费的/捐赠软件。

[IIS 7 内置了此功能](http://www.iis.net/downloads/default.aspx?tabid=34&g=6&i=1691)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-15T21:57:23.003

您可以使用[http://urlrewriter.net/](http://urlrewriter.net/)来做您需要的事情。您需要对其进行设置，以便 ASP.NET 处理 .html 扩展名。然后，您可以使用 web.config 中的这一行（在 urlrewriter 部分中）非常轻松地将 (301) .html 重定向到 .aspx：

```
<redirect url="^(.+)\.html(.+)$" to="$1.aspx$2" permanent='true' /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T12:39:34.430

另一种选择是根本不重命名文件。您可以为 HTML 文件设置应用程序映射，该映射将通过 asp 处理器传递它们。这将为您提供动态内容等，而不会产生任何 SEO 副作用。

与以往一样，有一个缺点。通过 asp 处理器传递一个静态的 HTML 文件比仅仅提供它的效率要低。

# svn - OSX 上融合（图形差异工具）的替代品是什么

> ID：229142
> 
> 赞同：47
> 
> 时间：2008-10-23T09:49:38.333
> 
> 标签：svn, macos, diff, meld

我主要在 Linux 上开发，meld 对我来说是必不可少的。但是，当我在路上时，我使用的是 MacBook（豹），并且我想使用与我的主要开发工具箱上相同的工具集，meld 就是其中之一。

尽管您应该能够安装 meld，但我无法成功。那么......是否有任何替代品与融合一样好（或更好）？

需要指出的一件事，我使用颠覆，我只是喜欢“融合”。将我的工作目录与 BASE 版本进行比较的命令...

约翰

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-10-23T10:06:30.797

有 FileMerge.app，它是 XCode 附带的。

它可以作为单独的独立应用程序运行：

![在此处输入图像描述](https://i.stack.imgur.com/qwzlk.png)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-23T10:12:27.210

**Apple 的[FileMerge](http://en.wikipedia.org/wiki/Apple_Developer_Tools#FileMerge)**（包含在他们的[Developer Tools 下载](http://developer.apple.com/tools/download/)中）[看起来与 Meld 相似](http://images.google.com/images?hl=en&q=apple+filemerge)，但我承认两者都没有使用过。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-24T21:36:02.513

[Sourcegear DiffMerge](http://www.sourcegear.com/diffmerge/ "Sourcegear DiffMerge")是免费的并且完全跨平台（Windows、Mac 和 Linux）。我只使用过 Windows 版本，它缺少一些更高级的功能（如语法高亮和打开 .diff 文件），但我对此非常满意。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-04T18:38:59.867

KDiff 是跨平台、开源的，并且有一个可用的 OSX 二进制文件。

[http://kdiff3.sourceforge.net/](http://kdiff3.sourceforge.net/)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-10-23T17:13:11.653

[Fink](http://www.finkproject.org/)有一个融合包。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-23T17:46:13.847

看看[Changes.app](http://changesapp.com/)。是的，它是收费的，但它功能强大、速度快、易于使用。它还有一个命令行工具。查看 wiki 以获取提示和技巧，尤其是在使其与版本控制系统集成方面。我喜欢 Changes.app。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-23T10:18:14.267

[BBEdit](http://barebones.com/products/bbedit/) has a good diff viewer in it.

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-11-09T12:38:33.787

我自己不是 Mac 用户 - 但我偶然发现了这篇文章，同时发现了[tkdiff](http://sourceforge.net/projects/tkdiff/)，它的屏幕截图似乎是在 Mac 上拍摄的；所以也许它有帮助..干杯！

# java - 比较休眠映射的日期？

> ID：229143
> 
> 赞同：4
> 
> 时间：2008-10-23T09:49:59.317
> 
> 标签：java, hibernate, date

如何使用 Hibernate 将日期从 java 对象映射到数据库？我尝试了不同的方法，但我对它们不满意。为什么？让我解释一下我的问题。我有以下类 [1]，包括我调用的主要方法和以下映射 [2]。当您查看控制台输出时，您可以看到有关此方法的问题。

> 错误的
> 
> 错误的
> 
> 1
> 
> -1
> 
> 1224754335648
> 
> 1224754335000
> 
> 2008 年 10 月 23 日星期四 11:32:15 CEST
> 
> 时钟@67064

正如您所看到的，截止日期并不完全相等，尽管它们应该是相等的，因此很难在没有返回值的情况下比较它们`getTime`。我还尝试了 java.sql.Date、Timestamp 和 date 而不是映射中的时间戳，但没有成功。

我想知道为什么最后三位数字为零，这是休眠还是 java 问题还是我自己的愚蠢。

感谢您的阅读。

[1]

```
public class Clock {

    int id;
    java.util.Date date;

    public static void main(String[] args) {
        HibernateUtil.init();
        HibernateUtil.getSessionFactory().getCurrentSession().beginTransaction();

        Clock clock = new Clock();
        clock.date = new java.util.Date();

        HibernateUtil.getSessionFactory().getCurrentSession().saveOrUpdate(clock);
        HibernateUtil.getSessionFactory().getCurrentSession().getTransaction().commit();

        HibernateUtil.getSessionFactory().getCurrentSession().beginTransaction();

        Clock fromDBClock = (Clock)HibernateUtil.getSessionFactory()
                        .getCurrentSession().get(Clock.class, 1);

        System.out.println(clock.date.equals(fromDBClock.date));
        System.out.println(fromDBClock.date.equals(clock.date));

        System.out.println(clock.date.compareTo(fromDBClock.date));
        System.out.println(fromDBClock.date.compareTo(clock.date));

        System.out.println(clock.date.getTime());
        System.out.println(fromDBClock.date.getTime());

        System.out.println(clock.date.toString());
        System.out.println(fromDBClock.toString());

        HibernateUtil.getSessionFactory().getCurrentSession().getTransaction().commit();

        HibernateUtil.end();
    }

    public int getId() {
        return id;
    }

    public void setId(int id) {
        this.id = id;
    }

    public java.util.Date getDate() {
        return date;
    }

    public void setDate(java.util.Date date) {
        this.date = date;
    }

} 
```

[2]

```
<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<hibernate-mapping>

    <class name="Clock" table="CLOCK">
        <id name="id" column="CLOCK_ID">
            <generator class="native"/>
        </id>
        <property name="date" type="timestamp"/>

    </class>

</hibernate-mapping> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-23T20:44:21.133

MySql DateTime 精度仅为秒。Java 日期精度为毫秒。这就是为什么最后三位数字在放入数据库后为零的原因。

对您的原始日期执行此操作：

日期 = date.setTime((date.getTime() / 1000) * 1000);

这会将其设置为最后一秒，然后您的所有比较都将匹配。

(顺便说一句，System.out.println(fromDBClock.toString()); 应该是 System.out.println(fromDBClock.date.toString());

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-23T16:45:05.890

SQL Server 以 3 毫秒的精度存储日期时间，这肯定会导致您看到的问题。这样做的一个后果是 Java 中的 23:59:59.999 最终成为 SQL Server 中的第二天。我从来没有遇到过 Oracle、Informix 或 MySQL 的问题，但其他数据库的精度可能也较低。您可以通过使用 Hibernate 自定义类型来解决它。当您写出日期值时，您必须四舍五入到比基础数据库精度更低的精度。在 Hibernate 文档中搜索 UserType，您将更改 nullSafeSet 方法以进行舍入。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T10:24:37.700

显然，目标 RDBMS 上的 TIMESTAMP 类型（*顺便说一句，您在使用什么？*）不存储毫秒。尝试找到另一种可以执行此操作的本机类型，或者将您的时间映射到其他内容上，例如 long = ms-since-epoch。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-28T16:51:17.037

个人而言，我使用名为 DateUtils 的 Apache commons lang 包类截断我在 POJO 对象中收到的每个日期。

请参阅 [Apache 公共站点][1]

[1]：[http](http://commons.apache.org/lang/api/org/apache/commons/lang/time/DateUtils.html#truncate(java.util.Date) ://commons.apache.org/lang/api/org/apache/commons/lang/time/DateUtils.html#truncate(java.util.Date , int)

# html - CSS "valign" 定位

> ID：229153
> 
> 赞同：1
> 
> 时间：2008-10-23T09:54:16.453
> 
> 标签：html, css, xhtml, positioning

```
<div>
<h1>Title</h1>
<table>
...
</table>
</div> 
```

现在

```
<h1> 
```

有边距：0；所以它位于div的顶部。div 的高度为 300px。

但是，我希望将表格放置在 div 的底部，例如。valign="bottom" 但对于整个表格。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-23T10:16:44.113

这是雷米夏普的建议：

```
<style type="text/css" media="screen">
#container { 
    position: relative; 
    margin: 0;
    height:300px;
    border:1px solid #000; 
}
#container h1 { 
    margin:0; 
}
#tableLayout { 
    position: absolute;
    bottom:0; 
    border: 1px solid #c00;
}
</style>

<div id="container">
    <h1>Title</h1>
    <table id="tableLayout">
      <tr><td>example cell</td></tr>
    </table>
</div> 
```

看起来它有效！

我把它贴在这里，所以它会一直在这里。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-23T10:14:23.947

试试这个：http: [//jsbin.com/emoce](http://jsbin.com/emoce)

虽然它类似于达里尔的解决方案。除了我没有在包装 div 上使用 position:absolute，而是使用 position: relative 来使表格的位置相对于该位置绝对。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T10:03:29.680

那这个呢：

```
<style type="text/css">
#container { 
    position: absolute; 
    margin: 0;
    height:300px;
    border:1px solid #000; }
#container h1 { 
    margin:0; }
#tableContainer { 
    position: absolute;
    bottom:0; }
</style>

<div id="container">
    <h1>Title</h1>
    <div id="tableContainer">
        <table id="tableLayout">
            <tr><td>...</td></tr>
        </table>
    </div>
</div> 
```

唯一的问题是容器 div 和 tableContainer div 都需要绝对定位。不确定这是否适用于您的布局。

# c# - app.config configSections 自定义设置找不到架构信息

> ID：229155
> 
> 赞同：16
> 
> 时间：2008-10-23T09:55:29.443
> 
> 标签：c#, schema, app-config

我只是在了解有关创建自定义部分的 app.config 。我有这部分工作，它编译并根据需要获取信息，但我收到有关它找不到架构信息的警告。

我做了一些谷歌搜索，找不到这种情况的简单解释。

该方法（目前对我来说似乎很有意义）是为该项目中的每个部分都有一个模式文件。我了解如何创建架构文件，但不知道我希望如何将其纳入项目。

此外，当它被编译并部署到另一台机器时，我认为模式文件也需要被复制。

感谢您的任何帮助

乔恩

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-23T10:35:28.960

尝试将 app.config 文件链接到相应的架构（通常您可以在 C:\Program Files\Microsoft Visual Studio 8\xml\Schemas\DotNetConfig.xsd 上找到它），为此只需在可视化中打开 app.config 文件studio，打开属性窗口（F4）并将上面的路径放入**schemas**。巴勃罗。

# php - Perl 的等价于 PHP 的 print_r() 是什么？

> ID：229168
> 
> 赞同：26
> 
> 时间：2008-10-23T10:00:15.113
> 
> 标签：php, perl, debugging

我发现 PHP 中的 print_r 非常有用，但想知道 Perl 中是否有任何远程等效的东西？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-10-23T10:01:33.443

注意@tchrist 建议使用[Data::Dump](http://search.cpan.org/~gaas/Data-Dump-1.21/lib/Data/Dump.pm)而不是[Data::Dumper](http://search.cpan.org/~jhi/perl-5.8.0/ext/Data/Dumper/Dumper.pm)。我没有意识到这一点，但从它的外观来看，它似乎更容易使用并且产生更好的外观和更容易解释结果。

[数据::翻车机](http://search.cpan.org/~jhi/perl-5.8.0/ext/Data/Dumper/Dumper.pm)：

上面链接中显示的示例片段。

```
use Data::Dumper;

package Foo;
sub new {bless {'a' => 1, 'b' => sub { return "foo" }}, $_[0]};

package Fuz;                       # a weird REF-REF-SCALAR object
sub new {bless \($_ = \ 'fu\'z'), $_[0]};

package main;
$foo = Foo->new;
$fuz = Fuz->new;
$boo = [ 1, [], "abcd", \*foo,
         {1 => 'a', 023 => 'b', 0x45 => 'c'}, 
         \\"p\q\'r", $foo, $fuz];

########
# simple usage
########

$bar = eval(Dumper($boo));
print($@) if $@;
print Dumper($boo), Dumper($bar);  # pretty print (no array indices)

$Data::Dumper::Terse = 1;          # don't output names where feasible
$Data::Dumper::Indent = 0;         # turn off all pretty print
print Dumper($boo), "\n";

$Data::Dumper::Indent = 1;         # mild pretty print
print Dumper($boo);

$Data::Dumper::Indent = 3;         # pretty print with array indices
print Dumper($boo);

$Data::Dumper::Useqq = 1;          # print strings in double quotes
print Dumper($boo); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-23T14:44:13.060

通常与 Perl 一样，您可能更喜欢古老的 Data::Dumper 的替代解决方案：

*   [Data::Dump::Streamer](http://search.cpan.org/dist/Data-Dump-Streamer/)输出比 Data::Dumper 更简洁，也可以比 Data::Dumper 更好的序列化一些数据，
*   [YAML](http://search.cpan.org/dist/YAML) (or [Yaml::Syck](http://search.cpan.org/dist/YAML-Syck/), or an other YAML module) generate the data in YAML, which is quite legible.

And of course with the debugger, you can display any variable with the 'x' command. I particularly like the form '`x 2 $complex_structure`' where 2 (or any number) tells the debugger to display only 2 levels of nested data.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-23T14:47:05.783

An alternative to [Data::Dumper](http://perldoc.perl.org/Data/Dumper.html) that does not produce valid Perl code but instead a more skimmable format (same as the `x` command of the Perl debugger) is [Dumpvalue](http://perldoc.perl.org/Dumpvalue.html). It also consumes a lot less memory.

As well, there is [Data::Dump::Streamer](http://p3rl.org/Data::Dump::Streamer), which is more accurate in various edge and corner cases than [Data::Dumper](http://perldoc.perl.org/Data/Dumper.html) is.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-23T15:43:06.497

I use [Data::Dump](http://search.cpan.org/dist/Data-Dump/lib/Data/Dump.pm), it's output is a bit cleaner than Data::Dumper's (no $VAR1), it provides quick shortcuts and it also tries to DTRT, i.e. it will print to STDERR when called in void context and return the dump string when not.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-28T20:22:00.077

I went looking for the same thing and found [this lovely little Perl function](http://web.archive.org/web/20090730012843/http://netmesh.org/odds-ends/), explicitly meant to generate results like print_r().

The author of the script was asking your exact question in a forum [here](http://www.nntp.perl.org/group/perl.beginners/2006/04/msg83026.html).

```
print objectToString($json_data); 
```

Gives this output:

```
HASH {
time                             => 1233173875
error                            => 0
node                             => HASH {
    vid                              => 1011
    moderate                         => 0
    field_datestring                 => ARRAY {
        HASH {
            value                            => August 30, 1979
        }
    }

    field_tagged_persons             => ARRAY {
        HASH {
            nid                              => undef
        }
    }

...and so on... 
```

# java - Hibernate 什么时候从二级缓存读取，什么时候从 DB 读取？

> ID：229173
> 
> 赞同：1
> 
> 时间：2008-10-23T10:01:26.623
> 
> 标签：java, hibernate

据我所知，Hibernate 让您将实体和集合配置为存储在二级缓存中。

Hibernate 什么时候尝试从二级缓存中读取这些缓存的实体，什么时候命中 DB？`Sesssion.get()`当通过调用加载实体和初始化代理（包括集合）时，Hibernate 是否只从二级缓存中读取？Hibernate 在执行 HQL 或 Criteria-Queries 时是否会命中二级缓存？

例子？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-01-20T23:23:32.207

二级缓存仅包含通过 id 的实体，因此当通过 id 检索实体时（即隐式获取、加载或解析代理），可以访问二级缓存。任何其他查询（hal、criteria）都将绕过缓存并命中数据库——至少只要不使用查询缓存。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-23T10:15:55.533

（注意：回答这类问题的最简单方法是打开 show_sql 并查看 Hib 生成的查询。）

有时查询只返回记录的 PK（例如，对于迭代查询），然后 Hib 可以使用缓存。

检索链接对象时也可以使用缓存。

我不能在这里给你确切的规则。我还怀疑答案取决于所使用方言的能力。

# sql - MySQL 中的 NULL（性能和存储）

> ID：229179
> 
> 赞同：82
> 
> 时间：2008-10-23T10:02:48.150
> 
> 标签：sql, mysql, null

在 MySQL 中，null 究竟对性能和存储（空间）有什么影响？

例如：

TINYINT：1 字节 TINYINT w/NULL 1 字节 + 以某种方式存储 NULL？

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2008-10-23T18:41:38.743

这取决于您使用的存储引擎。

在 MyISAM 格式中，每个行标题包含一个位域，每列一个位用于编码 NULL 状态。为 NULL 的列仍会占用空间，因此 NULL 不会减少存储空间。见[https://dev.mysql.com/doc/internals/en/myisam-introduction.html](https://dev.mysql.com/doc/internals/en/myisam-introduction.html)

在 InnoDB 中，每一列在行头中都有一个“字段起始偏移量”，即每列一个或两个字节。如果该列为 NULL，则该字段开始偏移中的高位打开。在这种情况下，根本不需要存储该列。因此，如果您有很多 NULL，您的存储空间应该会大大减少。见[https://dev.mysql.com/doc/internals/en/innodb-field-contents.html](https://dev.mysql.com/doc/internals/en/innodb-field-contents.html)

**编辑：**

NULL 位是行标题的一部分，您不要选择添加它们。

我可以想象 NULL 提高性能的唯一方法是，在 InnoDB 中，如果行包含 NULL，则一页数据可能适合更多行。所以你的 InnoDB 缓冲区可能更有效。

但是，如果这在实践中提供了显着的性能优势，我会感到非常惊讶。担心 NULL 对性能的影响属于微优化领域。你应该把注意力集中在其他地方，在那些能带来更大收益的领域。例如添加精心挑选的索引或增加数据库缓存分配。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2015-08-18T04:52:00.047

比尔的回答很好，但有点过时了。使用一或两个字节存储 NULL 仅适用**于**InnoDB REDUNDANT 行格式。由于 MySQL 5.0.3 InnoDB 使用**COMPACT**行格式，它只使用一位来存储 NULL（当然，一个字节是最小值），因此：

NULL 所需的空间 = **CEILING(N/8) 字节**，其中 N 是一行中的 NULL 列数。

*   0 NULLS = 0 字节
*   1 - 8 NULLS = 1 个字节
*   9 - 16 NULLS = 2 个字节
*   17 - 24 NULLS = 3 个字节
*   ETC...

根据有关 COMPACT vs REDUNDANT 的 MySQL 官方网站：

> 紧凑行格式将行存储空间减少了大约 20%，但代价是增加了某些操作的 CPU 使用率。如果您的工作负载是典型的受缓存命中率和磁盘速度限制的工作负载，那么紧凑格式可能会更快。

## 使用 NULLS 优于空字符串或零的优势：

*   1 NULL 需要 1 个字节
*   1 个空字符串需要 1 个字节（假设为 VARCHAR）
*   1 零需要 4 个字节（假设为 INT）

您开始看到这里的节省：

*   8 个 NULL 需要 1 个字节
*   8 个空字符串需要 8 个字节
*   8 个零需要 32 个字节

另一方面，我建议在空字符串或零上使用 NULL，因为它们更有条理、更便携，并且需要更少的空间。为了提高性能和节省空间，请专注于使用正确的数据类型、索引和查询，而不是使用奇怪的技巧。

更多信息： [https ://dev.mysql.com/doc/refman/5.7/en/innodb-physical-record.html](https://dev.mysql.com/doc/refman/5.7/en/innodb-physical-record.html)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-03-08T22:58:36.023

我同意 Bill Karwin 的观点，尽管我会添加[这些 MySQL 技巧](http://code.tutsplus.com/tutorials/top-20-mysql-best-practices--net-7855)。11 号特别解决了这个问题：

> 首先，问问自己，空字符串值与 NULL 值之间是否有任何区别（对于 INT 字段：0 与 NULL）。如果没有理由同时拥有两者，则不需要 NULL 字段。（你知道 Oracle 认为 NULL 和空字符串是一样的吗？）
> 
> NULL 列需要额外的空间，它们会增加比较语句的复杂性。尽可能避免它们。但是，我知道有些人可能有非常具体的理由来使用 NULL 值，这并不总是一件坏事。

另一方面，我仍然在没有大量行的表上使用 null，主要是因为我喜欢说 NOT NULL 的逻辑。

**更新** 稍后再谈，我要补充一点，我个人不喜欢在数据库中使用 0 而不是 NULL，我也不推荐它。如果您不小心，这很容易在您的应用程序中导致大量误报。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-19T17:30:42.107

[dev.mysql.com/doc/refman/5.0/en/is-null-optimization.html](http://dev.mysql.com/doc/refman/5.0/en/is-null-optimization.html)

MySQL 可以对 col_name IS NULL 执行与 col_name = constant_value 相同的优化。例如，MySQL 可以使用索引和范围来搜索 NULL 与 IS NULL

# c# - 如何对 MVC UserViewControl 进行单元测试？

> ID：229185
> 
> 赞同：7
> 
> 时间：2008-10-23T10:03:44.157
> 
> 标签：c#, asp.net-mvc, mocking

我一直在尝试为 ASP.NET MVC 中的 UserViewControl 编写单元测试。我想得到看起来像这样的代码：

```
[TestMethod]
public void HaveControlToDisplayThings()
{
    var listControl = new ControlUnderTest();
    var viewData = new ViewDataDictionary<IList<string>>(this.repo.GetMeSomeData());

    // Set up a ViewContext using Moq.
    listControl.SetFakeViewContext(viewData);
    listControl.ViewData = viewData;
    listControl.RenderView(listControl.ViewContext);

    // Never got this far, no idea if this will work :)
    string s = listControl.ViewContext.HttpContext.Response.Output.ToString();
    Assert.AreNotEqual(0, s.Length);
    foreach (var item in this.repo.GetMeSomeData())
    {
        Assert.IsTrue(s.IndexOf(item) != -1);
    }
} 
```

不幸的是，无论我尝试什么，我都会从 RenderView 深处得到错误。这是由静态 HttpContext.Current 对象无用引起的（据我所知） - 我`NullReferenceException`从`System.Web.UI.Page.SetIntrinsics`.

我尝试使用 Phil Haack 的[HttpSimulator](http://haacked.com/archive/2007/06/19/unit-tests-web-code-without-a-web-server-using-httpsimulator.aspx)，它给了我一个 HttpContext 对象，但我发现我还需要指定一个假`HttpBrowserCapabilities`对象才能稍微进一步：

```
Subtext.TestLibrary.HttpSimulator simulator = new HttpSimulator();
simulator.SimulateRequest();
var browserMock = new Mock<HttpBrowserCapabilities>();
browserMock.Expect(b => b.PreferredRenderingMime).Returns("text/html");
browserMock.Expect(b => b.PreferredResponseEncoding).Returns("UTF-8");
browserMock.Expect(b => b.PreferredRequestEncoding).Returns("UTF-8");
HttpContext.Current.Request.Browser = browserMock.Object; 
```

现在我得到了对该对象的属性访问异常。我尽可能多地嘲笑，但似乎无处可去。

有没有人设法完成这项工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-23T23:37:08.913

不幸的是，ASP.NET 视图引擎在 ASP.NET 宿主环境中使用了 VirtualPathProvider。更糟糕的是，我使用 Reflector 跟踪了一些其他代码，发现对 VirtualPath 实用程序的一些硬代码引用存在其他依赖关系。我希望他们在版本中解决这个问题，这样我们就可以真正测试我们的视图以及它们是如何呈现的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-23T23:27:09.527

一种选择是在浏览器中运行单元测试。在这种情况下，我在[Selenium上取得了成功。](http://seleniumhq.org/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-23T23:34:32.930

我们放弃了单元测试视图，现在使用 WatiN 浏览器测试作为我们构建的一部分。

我们还使用 Resharper 解决方案范围分析来检查是否存在编译器错误。不完美，但它得到了非常相似的结果。缺点 - WatiN 测试很慢。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-28T22:58:01.610

这些是需要在 HttpBrowserCapabilities 对象中设置才能运行 asp.net webforms 站点的值，我会尝试确保设置这些值，看看是否能解决您的问题，我不确定是否会，但嘿值得一试吗？

*   浏览器（又名）
*   useragent（在请求中传递）
*   表（真/假）
*   版本（浏览器版本，例如 1.0）
*   w3cdomversion（例如 1.0）
*   饼干（真/假）
*   ecmascript 版本（例如 1.0）

希望这可以帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-30T15:50:42.580

我也会推荐[selenium](http://seleniumhq.org/)用于 UI 测试。标准 MVC 应用程序中有相当多的内容可以进行单元测试，但 UI 级别的组件似乎更适合 Selenium 等浏览器内测试。[您可以使用Cruisecontrol.net](http://cruisecontrol.sourceforge.net/)将 Selenium 测试与您的单元测试集成。

这是将 Selenium 与 CC.Net 集成的[指南](http://wiki.openqa.org/display/SEL/Integrating+Selenium+And+CruiseControl.Net)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-30T15:55:20.277

使用 TypeMock 来模拟依赖项。我写[了一篇](http://itscommonsensestupid.blogspot.com/2008/09/testing-aspnet-mvc-using-typemock-aaa.html)关于如何在控制器层模拟请求和响应依赖项的博客文章。也许它有帮助。

# python - os.walk 没有深入到下面的目录

> ID：229186
> 
> 赞同：120
> 
> 时间：2008-10-23T10:03:59.490
> 
> 标签：python, file, os.walk

如何限制`os.walk`只返回我提供的目录中的文件？

```
def _dir_list(self, dir_name, whitelist):
    outputList = []
    for root, dirs, files in os.walk(dir_name):
        for f in files:
            if os.path.splitext(f)[1] in whitelist:
                outputList.append(os.path.join(root, f))
            else:
                self._email_to_("ignore")
    return outputList 
```

* * *

## 回答 #1

> 赞同：229
> 
> 时间：2008-10-23T10:15:38.907

不要使用 os.walk。

例子：

```
import os

root = "C:\\"
for item in os.listdir(root):
    if os.path.isfile(os.path.join(root, item)):
        print item 
```

* * *

## 回答 #2

> 赞同：111
> 
> 时间：2008-10-24T16:46:02.707

使用该`walklevel`功能。

```
import os

def walklevel(some_dir, level=1):
    some_dir = some_dir.rstrip(os.path.sep)
    assert os.path.isdir(some_dir)
    num_sep = some_dir.count(os.path.sep)
    for root, dirs, files in os.walk(some_dir):
        yield root, dirs, files
        num_sep_this = root.count(os.path.sep)
        if num_sep + level <= num_sep_this:
            del dirs[:] 
```

它的工作方式与 类似`os.walk`，但您可以向它传递一个`level`参数来指示递归的深度。

* * *

## 回答 #3

> 赞同：59
> 
> 时间：2014-01-01T12:44:22.767

我认为解决方案实际上非常简单。

采用

```
break 
```

只做for循环的第一次迭代，必须有更优雅的方式。

```
for root, dirs, files in os.walk(dir_name):
    for f in files:
        ...
        ...
    break
... 
```

第一次调用 os.walk 时，它会返回当前目录的郁金香，然后在下一个循环中返回下一个目录的内容。

获取原始脚本并添加一个**break**。

```
def _dir_list(self, dir_name, whitelist):
    outputList = []
    for root, dirs, files in os.walk(dir_name):
        for f in files:
            if os.path.splitext(f)[1] in whitelist:
                outputList.append(os.path.join(root, f))
            else:
                self._email_to_("ignore")
        break
    return outputList 
```

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2008-10-23T10:46:22.620

使用建议`listdir`是一个很好的建议。您在 Python 2 中的问题的直接答案是`root, dirs, files = os.walk(dir_name).next()`.

等效的 Python 3 语法是`root, dirs, files = next(os.walk(dir_name))`

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2008-10-23T10:06:02.450

您可以使用[`os.listdir()`](http://www.python.org/doc/2.5.2/lib/os-file-dir.html)which 返回给定目录中的名称列表（对于文件和目录）。如果您需要区分文件和目录，请调用`os.stat()`每个名称。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-10-23T10:49:05.220

如果您有比顶级目录更复杂的要求（例如忽略 VCS 目录等），您还可以修改目录列表以防止 os.walk 递归遍历它们。

IE：

```
def _dir_list(self, dir_name, whitelist):
    outputList = []
    for root, dirs, files in os.walk(dir_name):
        dirs[:] = [d for d in dirs if is_good(d)]
        for f in files:
            do_stuff() 
```

注意 - 小心改变列表，而不是重新绑定它。显然 os.walk 不知道外部重新绑定。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2016-05-03T15:43:13.630

```
for path, dirs, files in os.walk('.'):
    print path, dirs, files
    del dirs[:] # go only one level deep 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2014-06-25T20:38:16.873

与 相同的想法`listdir`，但更短：

```
[f for f in os.listdir(root_dir) if os.path.isfile(os.path.join(root_dir, f))] 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2017-06-02T08:14:38.033

感觉就像把我的 2 便士扔进去一样。

```
baselevel = len(rootdir.split("\\"))
for subdirs, dirs, files in os.walk(rootdir):
    curlevel = len(subdirs.split("\\"))
    if curlevel <= baselevel + 1:
        [do stuff] 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2019-05-27T12:15:54.470

从**Python 3.5**开始，您可以[`os.scandir`](https://docs.python.org/3.5/library/os.html#os.scandir)使用[`os.listdir`](https://docs.python.org/3.5/library/os.html#os.listdir). [`DirEntry`](https://docs.python.org/3.5/library/os.html#os.DirEntry)作为回报，您得到的不是字符串，而是对象的迭代器。从文档：

> 使用`scandir()`而不是`listdir()`可以显着提高还需要文件类型或文件属性信息的代码的性能，因为`DirEntry`如果操作系统在扫描目录时提供这些信息，对象就会公开这些信息。所有`DirEntry`方法都可以执行系统调用，但`is_dir()`通常`is_file()`只需要对符号链接进行系统调用；`DirEntry.stat()`在 Unix 上总是需要一个系统调用，但在 Windows 上只需要一个用于符号链接。

您可以通过`DirEntry.name`它访问对象的名称，然后等效于的输出`os.listdir`

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-10-18T23:15:07.673

您还可以执行以下操作：

```
for path, subdirs, files in os.walk(dir_name):
    for name in files:
        if path == ".": #this will filter the files in the current directory
             #code here 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-04-01T14:13:41.290

在 Python 3 中，我能够做到这一点：

```
import os
dir = "/path/to/files/"

#List all files immediately under this folder:
print ( next( os.walk(dir) )[2] )

#List all folders immediately under this folder:
print ( next( os.walk(dir) )[1] ) 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2019-09-30T17:09:40.043

```
import os

def listFiles(self, dir_name):
    names = []
    for root, directory, files in os.walk(dir_name):
        if root == dir_name:
            for name in files:
                names.append(name)
    return names 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-01-06T17:47:02.483

这就是我解决它的方法

```
if recursive:
    items = os.walk(target_directory)
else:
    items = [next(os.walk(target_directory))]

... 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-09-23T18:42:26.563

使用 listdir 时有一个问题。os.path.isdir(identifier) 必须是绝对路径。要选择您执行的子目录：

```
for dirname in os.listdir(rootdir):
  if os.path.isdir(os.path.join(rootdir, dirname)):
     print("I got a subdirectory: %s" % dirname) 
```

另一种方法是切换到目录以在没有 os.path.join() 的情况下进行测试。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-08-24T08:56:51.557

您可以使用此代码段

```
for root, dirs, files in os.walk(directory):
    if level > 0:
        # do some stuff
    else:
        break
    level-=1 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-11-21T09:49:23.500

创建排除列表，使用 fnmatch 跳过目录结构并执行该过程

```
excludes= ['a\*\b', 'c\d\e']
for root, directories, files in os.walk('Start_Folder'):
    if not any(fnmatch.fnmatch(nf_root, pattern) for pattern in excludes):
        for root, directories, files in os.walk(nf_root):
            ....
            do the process
            .... 
```

与“包括”相同：

```
if **any**(fnmatch.fnmatch(nf_root, pattern) for pattern in **includes**): 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-11-29T21:18:20.723

为什么不简单地使用 a`range`并与`os.walk`结合`zip`？不是最好的解决方案，但也可以。

例如像这样：

```
# your part before
for count, (root, dirs, files) in zip(range(0, 1), os.walk(dir_name)):
    # logic stuff
# your later part 
```

在 python 3 上为我工作。

另外：`break`顺便说一句，A 也更简单。（看@Pieter的答案）

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-01-30T13:59:55.777

亚历克斯的答案略有变化，但使用`__next__()`：

`print(next(os.walk('d:/'))[2])` 或者 `print(os.walk('d:/').__next__()[2])`

在其他答案`[2]`中提到`file`的`root, dirs, file`

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-06-05T15:31:04.850

os.walk 找到的每个目录的根文件夹都会更改。我求解检查是否 root == 目录

```
def _dir_list(self, dir_name, whitelist):
    outputList = []
    for root, dirs, files in os.walk(dir_name):
        if root == dir_name: #This only meet parent folder
            for f in files:
                if os.path.splitext(f)[1] in whitelist:
                    outputList.append(os.path.join(root, f))
                else:
                    self._email_to_("ignore")
    return outputList 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2020-12-23T07:44:32.123

这是一个很好的python示例

```
def walk_with_depth(root_path, depth):
        if depth < 0:
            for root, dirs, files in os.walk(root_path):
                yield [root, dirs[:], files]

            return

        elif depth == 0:
            return

        base_depth = root_path.rstrip(os.path.sep).count(os.path.sep)
        for root, dirs, files in os.walk(root_path):
            yield [root, dirs[:], files]

            cur_depth = root.count(os.path.sep)

            if base_depth + depth <= cur_depth:
                del dirs[:] 
```

# java - 不支持的协议：尝试将文件作为资源访问时使用 Websphere 6.1 的 jndi

> ID：229196
> 
> 赞同：0
> 
> 时间：2008-10-23T10:06:36.287
> 
> 标签：java, websphere, jndi

我有一个问题，从我的存档中获取资源失败了`MalformedURLException: unknown protocol: jndi`

存档是一个war 文件，并成功部署到Websphere 中。

当我尝试通过

```
jndi://server/context/filename 
```

我得到`MalformedURLException`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-11-19T11:54:35.587

带有“jndi”方案的 URL 由 Tomcat 中的 ServletContext#getResource 方法返回。然而，这是非标准的（即 J2EE 规范不强制在该方法的返回值中使用 URL 方案）并且在其他应用程序服务器上会有所不同。始终使用 ServletContext#getResource 方法，而不是尝试直接编写 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-01T05:05:46.940

除非您注册了自定义 URL 处理程序，否则“jndi”不是受支持的协议。

您是否尝试通过 Java 代码读取文件？

# php - 是否有可用于 phing 的 ssh 和 scp 任务？

> ID：229201
> 
> 赞同：6
> 
> 时间：2008-10-23T10:08:05.847
> 
> 标签：php, deployment, phing

我想从我的构建机器远程部署到服务器上。远程处理可以通过脚本中的 ssh 命令来完成，但我宁愿使用 phing 和可以执行自动化的 deploy.xml 文件。

我必须从 phing 构建文件中执行 ssh（以及 scp）任务的替代方法是什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2010-12-15T11:37:13.297

[Phing 中的SCPTask](https://www.phing.info/docs/guide/stable/ScpTask.html)：

> 使用 scp 将文件复制到远程主机或从远程主机复制文件。此任务需要**[PHP SSH2 扩展](http://web.archive.org/web/20101219161808/http://pecl.php.net/package/ssh2)**才能运行...

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-28T21:25:15.923

我昨天遇到了Phing 的[SCP 和 SSH 任务](http://phing.info/trac/browser/branches/2.4/classes/phing/tasks/ext)。您还需要按照[安装 SSH2 for PHP](http://us3.php.net/manual/en/ssh2.setup.php)的说明进行操作。我无法让任务直接开箱即用，你可能会。我修改了我的副本，如果你需要我可以提供。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-23T11:23:06.570

大约一年前我遇到了同样的问题，那时我找不到任务。我最终做了一个 exec 任务，这样它就在 xml 文件中。

```
<exec command="scp -i keys/id_rsa myfile user@$server:myfile" dir="." /> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-02-03T20:50:41.987

我知道这很旧，但似乎有多个断开的链接和一些错误信息。

[**ScpTask**：http: //www.phing.info/docs/guide/stable/apcs60.html](http://www.phing.info/docs/guide/stable/apcs60.html)

[**SshTask**: http://www.phing.info/docs/guide/stable/apcs60.htm](http://www.phing.info/docs/guide/stable/apcs60.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-06-12T18:13:19.290

对于[SemanticScuttle](http://semanticscuttle.sourceforge.net/)，我们使用[rsync 将](http://semanticscuttle.git.sourceforge.net/git/gitweb.cgi?p=semanticscuttle/sc;a=blob;f=build.xml;hb=HEAD)发布文件部署到 SourceForge 服务器 - 也通过 exec。Rsync 理解 ssh。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-17T10:58:26.603

For ssh, there's the ssh2 PECL extension and then Phing has the [ssh](http://www.phing.info/docs/guide/stable/apcs63.html) and [scp](http://www.phing.info/docs/guide/stable/apcs62.html) tasks.

1.  On a Mac, install libssh2 via Homebrew. On Linux, use your package manager.
2.  `sudo pecl install pecl.php.net/ssh2-0.12`

You can now do this:

```
<?xml version="1.0"?>
<project name="test" default="test">
  <target name="test">
    <ssh username="vagrant" password="vagrant" host="192.168.123.456"
        command="pwd" property="pwd" display="false" />
    <echo>The current working directory is ${pwd}</echo>
  </target>
</project> 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-10-23T12:52:01.493

如果你真的需要 phing，那么 afaik 只有 exec。如果您愿意使用其他工具，请查看[capistrano和我在“](http://www.capify.org/)[设置 PHP Web 项目，基础设施](https://stackoverflow.com/questions/220638/setting-up-a-php-web-project-the-infrastructure#225524)”中的回答。

# mysql - 如何在 Perl 中干净地提取 MySQL 枚举值？

> ID：229206
> 
> 赞同：6
> 
> 时间：2008-10-23T10:11:10.053
> 
> 标签：mysql, perl, enums, dbix-class

我有一些代码需要在插入数据库之前确保一些数据在 mysql 枚举中。我发现这样做的最干净的方法是以下代码：

```
sub enum_values {
    my ( $self, $schema, $table, $column ) = @_;

    # don't eval to let the error bubble up
    my $columns = $schema->storage->dbh->selectrow_hashref(
        "SHOW COLUMNS FROM `$table` like ?",
        {},
        $column
    );

    unless ($columns) {
        X::Internal::Database::UnknownColumn->throw(
            column => $column,
            table  => $table,
        );
    }

    my $type = $columns->{Type} or X::Panic->throw(
        details => "Could not determine type for $table.$column",
    );

    unless ( $type =~ /\Aenum\((.*)\)\z/ ) {
        X::Internal::Database::IncorrectTypeForColumn->throw(
            type_wanted => 'enum',
            type_found  => $type,
        );
    }
    $type = $1;

    require Text::CSV_XS;
    my $csv = Text::CSV_XS->new;
    $csv->parse($type) or X::Panic->throw(
        details => "Could not parse enum CSV data: ".$csv->error_input,
    );
    return map { /\A'(.*)'\z/; $1 }$csv->fields;
} 
```

我们正在使用[DBIx::Class](http://search.cpan.org/dist/DBIx-Class/)。当然有更好的方法来实现这一点吗？（请注意，$table 变量来自我们的代码，*而不是*来自任何外部来源。因此，没有安全问题）。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-23T12:40:11.047

没必要这么英勇。使用相当现代的[DBD::mysql版本，](http://search.cpan.org/dist/DBD-mysql/) [DBI](http://search.cpan.org/dist/DBI/)的[column info](http://search.cpan.org/dist/DBI/DBI.pm#column_info)方法返回的哈希包含 key 中有效枚举值的预拆分版本`mysql_values`：

```
my $sth = $dbh->column_info(undef, undef, 'mytable', '%');

foreach my $col_info ($sth->fetchrow_hashref)
{
  if($col_info->{'TYPE_NAME'} eq 'ENUM')
  {
    # The mysql_values key contains a reference to an array of valid enum values
    print "Valid enum values for $col_info->{'COLUMN_NAME'}: ", 
          join(', ', @{$col_info->{'mysql_values'}}), "\n";
  }
  ...
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-23T10:41:32.003

我会说使用 Text::CSV_XS 可能有点过头了，除非你在枚举中有奇怪的东西，比如逗号（如果你问我，无论如何都是个坏主意）。我可能会改用这个。

```
my @fields = $type =~ / ' ([^']+) ' (?:,|\z) /msgx; 
```

除此之外，我认为没有捷径可走。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-27T02:40:44.900

我花了一天的时间在 MagNet 上的#dbix-class 频道上询问同样的问题，并遇到了这个缺乏答案的问题。由于我找到了答案，但似乎还没有其他人这样做，我将把成绩单粘贴到 TL;DR 下方：

```
my $cfg = new Config::Simple( $rc_file );
my $mysql = $cfg->get_block('mysql');
my $dsn =
  "DBI:mysql:database=$mysql->{database};".
  "host=$mysql->{hostname};port=$mysql->{port}";

my $schema  =
  DTSS::CDN::Schema->connect( $dsn, $mysql->{user}, $mysql->{password} );

my $valid_enum_values =
  $schema->source('Cdnurl')->column_info('scheme')->{extra}->{list}; 
```

现在 IRC 日志中我用头撞墙：

```
14:40 < cj> is there a cross-platform way to get the valid values of an 
            enum?
15:11 < cj> it looks like I could add 'InflateColumn::Object::Enum' to the 
            __PACKAGE__->load_components(...) list for tables with enum 
            columns
15:12 < cj> and then call values() on the enum column
15:13 < cj> but how do I get dbic-dump to add 
            'InflateColumn::Object::Enum' to 
            __PACKAGE__->load_components(...) for only tables with enum 
            columns?
15:20 < cj> I guess I could just add it for all tables, since I'm doing 
            the same for InflateColumn::DateTime
15:39 < cj> hurm... is there a way to get a column without making a 
            request to the db?
15:40 < cj> I know that we store in the DTSS::CDN::Schema::Result::Cdnurl 
            class all of the information that I need to know about the 
            scheme column before any request is issued
15:42 <@ilmari> cj: for Pg and mysql Schema::Loader will add the list of 
                valid values to the ->{extra}->{list} column attribute
15:43 <@ilmari> cj: if you're using some other database that has enums, 
                patches welcome :)
15:43 <@ilmari> or even just a link to the documentation on how to extract 
                the values
15:43 <@ilmari> and a willingness to test if it's not a database I have 
                access to
15:43 < cj> thanks, but I'm using mysql.  if I were using sqlite for this 
            project, I'd probably oblige :-)
15:44 <@ilmari> cj: to add components to only some tables, use 
                result_components_map
15:44 < cj> and is there a way to get at those attributes without making a 
            query?
15:45 < cj> can we do $schema->resultset('Cdnurl') without having it issue 
            a query, for instance?
15:45 <@ilmari> $result_source->column_info('colname')->{extra}->{list}
15:45 < cj> and $result_source is $schema->resultset('Cdnurl') ?
15:45 <@ilmari> dbic never issues a query until you start retrieving the 
                results
15:45 < cj> oh, nice.
15:46 <@ilmari> $schema->source('Cdnurl')
15:46 <@ilmari> the result source is where the result set gets the results 
                from when they are needed
15:47 <@ilmari> names have meanings :) 
```

# asp.net - 哪个最快？数据检索

> ID：229211
> 
> 赞同：4
> 
> 时间：2008-10-23T10:12:58.800
> 
> 标签：asp.net, sql, database, linq

一次访问数据库并带回 3000 多行，然后在 .net 和 LINQ 中操作它们更快，还是更快地进行 6 次调用，一次带回几 100 行？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-23T10:15:36.627

这完全取决于数据库的速度、网络带宽和延迟、.NET 机器的速度、实际查询等。

换句话说，我们不能给你一个真实的一般性答案。我知道哪个听起来更容易编码:)

*不幸的是，如果没有生产环境的精确*副本，您将无法轻松地进行有用的测试——大多数测试环境与生产环境有些不同，这可能会严重改变结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T11:22:53.997

Is this for one user, or will many users be querying the data? The single database call will scale better under load.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T11:28:55.420

Speed is only one consideration among many.

How flexible is your code? How easy is it to revise and extend when the requirements change? How easy is it for another person to read and maintain your code? How portable is your code? what if you change to a diferent DBMS, or a different progamming language? Are any of these considerations important in your case?

Having said that, go for the single round trip if all other things are equal or unimportant.

You mentioned that the single round trip might result in reading data you don't need. If all the data you need can be described in a single result table, then it should be possible to devise a query that will get that result. That result table might deliver some result data in more than one row, if the query denormalizes the data. In that case, you might gain some speed by obtaining the data in several result tables, and composing the result yourself.

You haven't given enough information to know how much programming effort it will be to compose a single query or to compose the data returned by 6 queries.

As others have said, it depends.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-23T12:08:30.097

> the problem I have here is that I need it all, i just need it displayed separately...

The answer to your question is 1 query for 3000 rows is better than 6 queries for 500 rows. (given that you are bringing all 3000 rows back regardless)

However, there's no way you're going (to want) to display 3000 rows at a time, is there? In all likelihood, irrespective of using Linq, you're going to want to run aggregating queries and get the database to do the work for you. You should hopefully be able to construct the SQL (or Linq query) to perform all required logic in one shot.

Without knowing what you're doing, it's hard to be more specific.

* If you absolutely, positively need to bring back all the rows, then investigate the ToLookup() method for your linq IQueryable< T >. It's very handy for grouping results in non-standard ways.

Oh, and I highly recommend [LINQPad](http://www.linqpad.net/) (free) for trying out queries with Linq. It has loads of examples, and it also shows you the sql and lambda forms so you can familiarize yourself with Linq<->lambda form<->Sql.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-23T13:14:53.210

If you know which 6 SQL statements you're going to execute beforehand, you can bundle them into one call to the database, and return multiple result sets using ADO or ADO.NET.

[http://support.microsoft.com/kb/311274](http://support.microsoft.com/kb/311274)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-23T10:16:51.260

好吧，答案总是“视情况而定”。您想优化数据库负载还是应用程序负载？

在这种情况下，我的一般答案是在数据库级别使用尽可能具体的查询，因此使用 6 次调用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-23T10:25:03.457

谢谢

我有点想“棒球场”，但这听起来好像是一个选择……差异可能很小。

我在想在.net中获取所有数据并进行操作将是最好的-我没有任何具体的基础（因此是问题），我只是倾向于觉得对数据库的调用很昂贵，如果我知道我需要所有数据……一击搞定？！？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-23T10:34:14.250

部分问题是您没有提供足够的信息来给您一个准确的答案。显然，需要考虑可用资源。

If you pull 3000 rows infrequently, it might work for you in the short term. However, if there are say 10,000 people that execute the same query (ignoring cache effects), this could become a problem for both the app and db.

Now in the case of something like pagination, it makes sense to pull in just what you need. But that would be a general rule to try to only pull what is necessary. It's much more elegant to use a scalpel instead of a broadsword. =)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-23T10:38:52.463

If you are talking about a query that has already been run by SQL (so optimized by SQL Server), working with LINQ or a SqlDataReader might actually have the same performance.

The only difference will be "how hard will it be to maintain your code?"

LINQ doesn't query anything to the database until you ask for the result with ".ToList()" or ".ToArray()" or even ".Count()". LINQ is dynamically building your query so it is exactly the same as having a SqlDataReader but with runtime verification.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-23T10:45:14.680

I always stick to the rule of "bring in what I need" and nothing more...the problem I have here is that I need it all, I just need it displayed separately.

So say... I have a table with userid and typeid. I want to display all records with a userid, and display on the page in grids say separated by typeid.

At the moment I call sproc that does "select field1, field2 from tab where userid=1", then on the page set the datasource of a grid to from t in tab where typeid=2 select t;

Rather than calling a different sproc "select field1, field2 from tab where userid=1 and typeid=2" 6 times.

??

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-23T11:18:32.833

Rather than speculating, why don't you try both and measure the results?

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-23T15:13:37.103

It depends

1) if your connector implementation precaches a lot of objects AND you have big rows (for example blobs, contry polygons etc.) you have a problem, you have to download a LOT of data. I've optimalized once a code that had this problem and it was just downloading some megs of garbage all the time via localhost, and my software runs now 10 times faster because i removed the precaching by an option

2) If your rows are small and you have a good chance that you need to read through all the 3000, you're better going on a big resultset

3) If you don't use prepared statements, all queries have to be parsed! Big resultset might be better.

Hope it helped

# hibernate - 你总是在 Hibernate 中使用二级缓存吗？

> ID：229217
> 
> 赞同：4
> 
> 时间：2008-10-23T10:14:49.000
> 
> 标签：hibernate

你总是在 Hibernate 中使用二级缓存，还是先尝试不使用它，然后只在性能下降时使用它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-23T13:42:57.910

先让它工作，然后让它快速。如果您不需要缓存，请不要实现它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-23T11:21:57.930

在我使用过的应用程序中，数据库在多个应用程序之间共享，其中一些应用程序根本不是 Java。因此，在这些情况下，二级缓存对我来说不是一个选项，因为我永远不知道其他应用程序何时可以更新数据库。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-23T11:18:42.133

我一直在另一个框架（例如 Spring）的上下文中使用 Hibernate，在其中启用缓存几乎是微不足道的。其中许多项目已经通过[ehcache](http://ehcache.sourceforge.net/)对一些关键的域类使用缓存。

话虽如此，这是我们必须在资源之间进行权衡的另一个领域 - 平衡检索性能与内存使用情况。没有测量的优化已经一次又一次地被证明是不好的做法。

收集有关应用程序性能的指标。然后决定如何解决慢点。缓存可能是您最不担心的事情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-23T11:24:30.153

如果你做对了（注意选择 N+1 等），在绝大多数情况下，如果没有二级缓存，性能应该是可以接受的

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-23T12:03:07.813

我们首先尝试不使用它，并且仅在性能下降时使用它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-14T03:27:53.930

引用著名的 Donald Knuth 的话：“程序员会浪费大量时间来思考或担心程序中非关键部分的速度，而在考虑调试和维护时，这些提高效率的尝试实际上会产生强烈的负面影响。我们应该忘记小的效率，大约 97% 的时间说：过早的优化是万恶之源。但我们不应该放弃关键的 3% 的机会。

如果您发现性能问题，只有这样您才能开始优化。而且您应该只优化最大的瓶颈，并在需要时逐步降低。

然而，在 NHibernate 中实现这种优化在大多数情况下对调试和维护的影响可以忽略不计，并且通常可以通过对代码的极少添加来实现。

如果您广泛依赖延迟加载，拥有只读表，不必担心与不使用 NHibernate 的应用程序的并发性，性能是一个问题，并且您了解如何使用二级缓存进行优化（意味着您已经知道答案这个问题），那么你应该使用二级缓存。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-06-06T08:21:38.767

现在有一个与此相关的休眠特定问题。还有臭名昭著的 LazyInitializationException。基本上，当实体附加到持久性上下文时，您需要初始化所有惰性关联。有两种方法可以做到这一点：

1.  手动访问关系以强制加载它们。
2.  使用指定连接提取的查询。

这两种方法会产生完全不同的代码片段，因此将一个迁移到另一个可能是一项艰巨的工作。问题是方法一在不使用二级缓存的情况下会导致大量的查询，所以人们可以决定使用方法二导致发烧查询。但是，当您稍后打开 2 级缓存时，方法 2 中的查询不会从缓存中加载数据，而是会将结果实体放入其中，从而使查询执行速度比没有缓存时慢。这会导致复杂的事情，比如必须使用查询缓存。

因此，对我来说（在这种特殊情况下）似乎更好的方法是首先为所有实体启用缓存，这通常是微不足道的，然后在开发过程中为不需要它的实体禁用它。

# asp.net - Asp.net 中的会话

> ID：229228
> 
> 赞同：4
> 
> 时间：2008-10-23T10:20:08.570
> 
> 标签：asp.net

当我们向 ASP.NET Session 添加变量时，这些变量实际存储在客户端的什么位置？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-23T10:22:47.563

如果您在 ASP.NET 中使用默认会话，则它存储在 ASP.NET 工作进程内的内存中。它是一个服务器端缓存，与客户端完全无关。还有其他可用的会话存储选项，例如专用会话状态机或 sql 服务器。您还可以推出自己的会话提供程序。

所有解释都在这里[http://msdn.microsoft.com/en-us/library/ms972429.aspx](http://msdn.microsoft.com/en-us/library/ms972429.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-23T10:35:23.017

为客户端提供了一个 cookie 来识别它（ASP.NET_SessionId），但所有值都存储在服务器上。

如果你使用 Firebug 或 Fiddler，你可以看到这个设置。您可以使用 Session.SessionID.ToString() 查看值是什么

正如 redsquare 建议的那样，默认配置是将所有值存储在服务器的内存中（限制您在会话中存储内容的一个原因），但如果您愿意，您也可以将其存储在 sql server、state server 或您自己的提供程序中，

如果您更改识别烹饪中的值，那么它将改变服务器在返回会话变量时认为您是谁。我们使用此功能来帮助我们调试用户会话中的内容。

我认为识别会话 cookie 还设置了一个名为 HttpReadOnly 的属性，因此出于安全原因无法从 javascript 中读取它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-23T10:25:54.767

会话存储在 Web 服务器上，而不是客户端上。ASP.NET 通常将会话密钥存储在 cookie 中，并在您下次联系 Web 服务器时使用它来识别您的会话。

# .net - dbmetal 视觉金属错误：“岩浆字符串不能为空”

> ID：229229
> 
> 赞同：2
> 
> 时间：2008-10-23T10:20:47.867
> 
> 标签：.net, mysql, linq

我只是想用**dbmetal / visual metal为****linq** to **mysql**生成类，并不断遇到错误：

 **```
"magma string must not be empty"... 
```

我已经用谷歌搜索了，我已经在本地重新编译，检查了引用等。我真的不想开始调试这个......以前有人遇到过同样的问题，或者知道生成这些类的另一种方法吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T10:11:42.203

实际上，信不信由你，它是由表中以下划线 (_) 结尾的字段名称引起的...仅供将来参考，可能会为其他人节省很多时间...

# iis - MOD_Rewrite 重写是否通过重写规则调用第二次运行？

> ID：229231
> 
> 赞同：0
> 
> 时间：2008-10-23T10:21:22.607
> 
> 标签：iis, mod-rewrite, isapi-rewrite

当 MOD_Rewrite 执行 RewriteRule 时，是否会为新生成的请求再次执行所有 MOD_Rewrite 规则？具体在以下示例中，这会导致循环吗？

```
RewriteCond Host:  (?:www\.)?mysite\.com
RewriteRule ^(.*)$ $1 [QSA,L] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-23T12:10:09.860

在您的情况下，它无论如何都不会循环。您打开了“L”开关，将该特定规则固定为最后一个。

此外，您必须使用“N”或“NS”开关显式地强制下一次迭代，否则它只会在您的规则文件中移动并在最后一个匹配的规则处停止。从文档：

> **N（下一次迭代）**
> 
> 强制重写引擎修改规则的目标并从头开始重新启动规则检查（保存所有修改）。重新启动的次数受 RepeatLimit 指令中指定的值的限制。如果超过这个数字，N 标志将被简单地忽略。
> 
> **NS（相同规则的下一次迭代）**
> 
> 像 N 标志一样工作，但从同一规则重新开始规则处理（即强制重复规则应用）。单个规则迭代的最大次数由 RepeatLimit 指令给出。但是单个规则的重复次数不计入全局重复次数（即N标志引起的重复次数限制与NS引起的重复次数无关）。

# business-process-management - Disadvantages of automating a business process?

> ID：229238
> 
> 赞同：2
> 
> 时间：2008-10-23T10:23:52.477
> 
> 标签：business-process-management

What would be the disadvantages (if any) of automating business process for a Enterprise/organization?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-23T10:28:29.613

*   Loosing discretionary error checking, i.e. numbers that look out of line;
*   Potentially, knowledge of how a process is operated could be lost if it is automated but not documented. More often than not, manual processes are passed on;
*   Accountability for the process becomes muddled.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-23T10:45:24.367

You lose some flexibility on unplanned situations. On a manual process, you can often "work around" the process when there is something you did not expect, but with automated processes, you cannot.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-23T10:29:44.087

The money you need to spend to automate it.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-23T10:33:00.790

Would depend upon the process, but the classic situation where automation fails is when the automated system decides badly or masks a problem.

Another might be where it becomes a maintenance issue. Humans adapt pretty well to fluctuations in the process flow, typically automated systems don't.

Again, its a fairly vague question so it is hard for me to talk specifics. Do you have a particular process you want to automate?

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-23T10:33:08.090

*   It's always difficult to find a right tool for it.
*   You may end up ordering a custom tool and it's risky. However an off-the-shelf tool might be as difficult to implement.
*   It's very difficult to capture the business process right. Sometimes it's quite convoluted - especially in a big and old organisation. You may end up having 80% of cases automated and the other 20% being impossible to do at all
*   It's an investment for which a ROI should be calculated carefully. Sometimes you are better off just not doing anything at all.

Saying that I was involved in the projects where the automation of the business process allowed 1 person to do the work of a small department and that department was able to spend their time on significantly increasing the company revenue

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-23T11:27:35.577

自动化是一组工具和程序，可以使事情更有效地工作，但可能存在问题：

*   如果用户支持是自动的（并且不相关），客户可能会开始觉得您不关心他们。有些人想要个人支持而不是自动回复。
*   如果存在系统中的一组功能未涵盖的问题，并且因此而丢失数据。
*   如果没有人经常检查该系统仍然以正确的方式工作。
*   如果自动化系统没有经过足够的测试并且错误会导致巨大的损失（财务或声誉）。
*   如果出现其他问题（并且没有人可以修复它）。

确保您有足够的人员来维护和支持您的系统，因此如果自动化失败，您的业务也不会因此而失败。有很多业务流程自动化失败的例子，所以在尝试做事之前要计划好你的项目。想想自动化可能失败的可能（和不可能）方式，并进行足够的错误检查，以确保即使在出现错误（输入数据、信息处理或其他系统级别）的情况下也能正确进行。

有时最好手动做事，而在其他情况下，自动化是可行的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-02-21T20:24:26.197

根据我的经验，假设业务流程设计良好并正确实施，以下是 BPM 自动化业务流程的缺点：

1.  对业务流程的更改将需要对 BPM 解决方案进行更改。
2.  更改业务流程更加困难，因为您有需要迁移的历史数据，或者它迫使您使用次优工作。
3.  业务流程可能会受到 BPM 平台维护的影响。
4.  由于需要开发人员支持的 BPM 引擎错误，业务流程可能会在系统中丢失。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-09T19:21:22.333

仅仅为了自动化而自动化业务流程是愚蠢的差事。并且可能会使您的业务付出很多代价（以您可以想象的各种方式 - 财务影响、业务中断、新技术问题、士气等......）。

如果不小心，自动化业务流程可以：

*   花了很多钱（没有必要以某种方式将其收回）
*   需要很长时间才能实施（使用在其他地方会更好地使用的资源）
*   使过程更脆弱（失去灵活性/适应性）
*   发现当前流程中的次要问题，并使其不成比例
*   如果忽略过程中的某些内容，则会产生错误
*   使你的员工士气低落

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-09-22T01:30:37.547

花费？

人员流失-自动化可以很好地工作，以至于您需要更少的工人。低质量输出的损失——自动化可以提供可预测的结果。缺乏朝九晚五的工作——自动化软件 Dan 可以随时运行。我已经建立了每三个小时运行一次的例程，并且已经运行了多年。失去不满意的客户——正确完成自动化后，质量和收益都会提高。我创建了一个自动化的电子邮件程序，它可以准确地提醒我们的员工我们在发薪日存入他们银行账户的金额。这很容易做到，因为我刚刚自动创建了需要上传到我们背后的文本文件来支付他们已经有所需的数字。

你明白了。正确完成自动化会预先花费很多......但在短时间内节省成本并增加收益！

# unit-testing - Humble dialog vs MVC

> ID：229245
> 
> 赞同：8
> 
> 时间：2008-10-23T10:26:22.597
> 
> 标签：unit-testing, user-interface, design-patterns

Why should I choose to use one instead of the other and in which cases?

I mainly focus on desktop applications and personally speaking I do find the humble dialog box more easy and natural to use.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-23T10:30:02.043

In MVC, you would still use your "humble" dialog. Except all the business logic for it would be farmed off to another class somewhere else.

[http://en.wikipedia.org/wiki/Model-view-controller](http://en.wikipedia.org/wiki/Model-view-controller)

You need to weight up whether the investment in MVC will be worth it - especially if you're only working with a single simple dialog.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-23T10:48:31.023

One of the best discussions I've found regarding the advantages and disadvantages of the model view controller/presenter patterns was written by Martin Fowler: [http://martinfowler.com/eaaDev/uiArchs.html](http://martinfowler.com/eaaDev/uiArchs.html)

In short, by choosing to use a MVC variant you are increasing the testability of your view (dialog). Keeping all of your logic in your dialog class on the other hand, can be fine if you do not expect that dialog to be very complex, however as the complexity increases, the benefit of testable code increases.

It really is a judgement call.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-26T00:05:32.530

“Humble”对话框本身已经是 MVC。你有：

*   M，对话框消息的内容。
*   五、用户可以看到的窗口和小部件。
*   C、对话框如何显示以及它如何响应用户活动。

您的 GUI 框架或包装器库可以无缝地为您提供 MVC，而无需您考虑它，但它仍然是 MVC。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-24T12:00:30.817

没有简单的答案。

你应该使用任何能让你的生活更轻松的东西。

如果对话真的很简单，而且你*确定*它会保持这种状态，那就用谦虚的对话吧。

如果你有更复杂的东西，比如相同数据的多个视图表示，或者你知道你的简单对话框会随着时间的推移变得更加复杂，那么一定要使用 MVC。

您还可以查看 ant MVP 模式作为 MVC 的替代方案。

# .net - Microsoft.SqlServer.Management.Smo and its brothers works on SQL2000?

> ID：229248
> 
> 赞同：1
> 
> 时间：2008-10-23T10:28:44.277
> 
> 标签：.net, sql-server, sql-server-2000, smo

As title, I need that to run an import script generated by SQL Server DB Publishing Tool. Would that work on Sql2000 server too? Also I have seen ppl reporting missing library issues related to GAC, which libraries I precisely need to include if I am not controlling the deployment server?

To know how this thing works you can check here in MSDN Forum. [http://forums.microsoft.com/msdn/ShowPost.aspx?PostID=3947420&SiteID=1](http://forums.microsoft.com/msdn/ShowPost.aspx?PostID=3947420&SiteID=1)

I tested and indeed it works in my devbox with SQL2005 Express installed.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T04:45:10.093

是的，SMO 适用于 SQL Server 2000：

[SMO 和 Sql Server 7.0](https://stackoverflow.com/questions/33457/smo-and-sql-server-70)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T04:55:03.573

[部分](http://msdn.microsoft.com/en-us/library/ms162130(SQL.90).aspx)......所以“是”和“否”的答案都是正确的

# c# - 需要帮助在 C# 中跨 UI 线程和另一个线程获取信息

> ID：229254
> 
> 赞同：2
> 
> 时间：2008-10-23T10:31:59.357
> 
> 标签：c#, forms, invoke, multithreading

我有一个服务器应用程序，它通过网络接收信息并对其进行处理。服务器是多线程的，一次处理多个套接字，线程是通过 BeginInvoke 和 EndInvoke 样式的方法在我的控制下创建的，这些方法由相应的回调函数链接。

除了主 GUI 之外，我正在尝试创建一个表单，该表单显示一个 ListBox 项目，该项目由描述当前连接的套接字的项目填充。所以，我基本上想要做的是使用它的 Add() 函数将一个项目添加到 ListBox 中，从线程中运行适当的回调函数。我正在通过 Controls 属性访问我的表单控件 - IE：

```
(ListBox)c.Controls["listBox1"].Items.Add(); 
```

当然，我不只是调用该函数，我尝试了几种我在这里和网上找到的在线程之间进行通信的方法，包括`MethodInvoker`使用 a `delegate`、结合`Invoke()`等`BeginInvoke()`。似乎没有任何效果，我总是得到同样的异常告诉我我的控件是从创建它的线程以外的线程访问的。

有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-23T10:46:14.663

我一直使用这些方面的东西：

```
 c = <your control>
        if (c.InvokeRequired)
        {
            c.BeginInvoke((MethodInvoker)delegate
            {
                //do something with c
            });
        }
        else
        {
            //do something with c
        } 
```

我还写了一堆辅助扩展方法来...帮助。

```
using System;
using System.ComponentModel;
public static class CrossThreadHelper
{
    public static bool CrossThread<T,R>(this ISynchronizeInvoke value, Action<T, R> action, T sender, R e)
    {
        if (value.InvokeRequired)
        {
            value.BeginInvoke(action, new object[] { sender, e });
        }

        return value.InvokeRequired;
    }
} 
```

像这样使用：

```
 private void OnServerMessageReceived(object sender, ClientStateArgs e)
    {
        if (this.CrossThread((se, ev) => OnServerMessageReceived(se, ev), sender, e)) return;
        this.statusTextBox.Text += string.Format("Message Received From: {0}\r\n", e.ClientState);
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-23T10:44:41.000

使用 BeginInvoke 或 Invoke 应该可以正常工作。您能否发布一个简短但完整的程序来演示该问题？您应该能够处理一个实际上不需要任何服务器端东西的工作 - 只需拥有一堆“假装”接收传入连接的线程。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-23T10:47:32.367

您必须在您正在访问的 ListBox 控件上调用 Invoke（或 BeginInvoke），以便在创建该控件的线程上调用委托。

```
ListBox listBox = c.Controls["listBox1"] as ListBox;
if(listBox != null)
{
   listBox.Invoke(...);
} 
```

# visual-studio-2008 - 查看 VS 2008 中缺少的代码/设计器

> ID：229261
> 
> 赞同：2
> 
> 时间：2008-10-23T10:33:35.810
> 
> 标签：visual-studio-2008

很多时候，在 ASP.NET 网站上工作时，代码窗口的内容菜单中以及“查看”菜单中都会缺少“查看代码”和“查看设计器”选项。它们仅在解决方案资源管理器的上下文菜单中可用。

调试和不调试时都会发生这种情况。有谁知道这可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-25T06:56:34.393

他们在 VS2008 中加入了很多东西，试图改善用户体验。他们线程化的一件事是环境“决定”您的 ASPX 文件具有代码隐藏，反之亦然。我相信线程的优先级较低，甚至等待计算机空闲。

我认为这就是它的要点。当您遇到这种情况时，不要在几秒钟内对您的计算机进行任何操作，然后再次右键单击，此时该选项应该在菜单中。正是这种快速的停顿让 VS 认为它可以偷走一些“空闲”时间或其他任何东西。几周前，当我有一台新电脑在工作时，我对此感到非常恼火，并且我打开的每个文件都得到了这个。我用谷歌搜索了一下，并想出了上面的内容。最近一直没有问题，不知道为什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-23T10:49:32.097

不知道为什么，但尝试使用 F7 和 Shift-F7 在代码和设计器之间切换。

# php - 为什么在 PHP 中发布文本区域时 _POST 有时为空

> ID：229269
> 
> 赞同：5
> 
> 时间：2008-10-23T10:37:13.620
> 
> 标签：php, apache2

Ubuntu 上 Apache 2.2.4 下的 PHP 4.4 和 PHP 5.2.3。

我正在运行 Moodle 1.5.3，最近在更新课程时遇到了问题。$_POST 变量为空，但前提是在表单的文本区域中输入了大量文本。如果只输入一个简短的文本，它就可以正常工作。

我已将 post_max_size 从 8M 增加到 200M 并将 memory_limit 增加到 256M 但这没有帮助。我将 LimitRequestFieldSize 和 LimitRequestLine 加倍为 16380，并将 LimitRequestBody 设置为 0，但没有任何改进。

我已经用谷歌搜索了答案，但一直找不到。

Firefox 上的 HTTP 标头显示 3816 的内容大小和正确的数据，所以它只是没有到达 $_POST。

该系统运行良好，直到几周前。唯一的更改是 /etc/hosts 以更正 exim4 电子邮件服务器的 HELO 问题。

我可以在 exim4 未运行的开发机器上复制该问题，所以我认为这只是巧合。

感谢你的协助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T13:00:28.027

我没有足够的知识来真正提供有用的答案，所以以下是一个受过良好教育的猜测（至少我希望如此）。

首先，您应该通过 access_log 或例如通过[firebug](http://www.getfirebug.com/)来调试整个请求。（无论如何都有 Firebug 很好。）对我来说，您的问题*听起来*像是在两者之间发生了重定向。我给你举个例子：

假设这是您的结构：

```
/form.php
/directory/index.php 
```

这是你的表格：

```
<form action="/directory" method="post">
...
</form> 
```

这种情况下的问题是，即使`/directory`是一个有效的 url，Apache 也会再次将您重定向到`/directory/`，因此您正在丢失您的有效负载（应该在 中的内容`$_POST`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T11:43:34.500

表单的enctype是什么？可能是它限制了通过表单发送的数据量。

您可能还想检查传入的原始 $_POST 数据：

```
file_get_contents('php://input'); 
```

确保它们实际上是数据发送。[在这里](http://www.bradino.com/php/empty-post-array/)得到这些建议。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T15:19:06.717

可能不是与帖子的大小有关，而是新行之前的行有多长。如果他们使用 Moodle WYSIWYG 视图，则 html 将被放入一行而没有中断。如果您进入 html 并在每 1000 个字符左右按回车键，它会起作用吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-23T10:42:18.213

这听起来像是 Apache 或 Apache/PHP 集成问题。如果 $_POST 为空，则表明 http 服务器没有将 POST 信息提供给 PHP。如果我是你，我会调查 Apache 配置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T10:57:31.770

这很明显，但是您 /etc/init.d/apache2 restart 了吗？

此外，error_log 文件应显示有关帖子大小是否超过设置限制的一些信息。考虑增加排查问题的详细程度

# html - 相对于 CSS 中的可用空间居中文本

> ID：229272
> 
> 赞同：1
> 
> 时间：2008-10-23T10:38:29.530
> 
> 标签：html, css, xhtml, positioning

```
<div style="width: 300px">
<div id="one" style="float: left">saved</div><input type="submit" id="two" style="float: right" value="Submit" />
</div> 
```

我希望 div#one 在父 div 的左边缘和提交按钮的左边缘之间的空间中居中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-23T10:41:10.273

[这里](http://css-discuss.incutio.com/?page=CenteringBlockElement)列出了许多技术

但是，如果您只是想让“已保存”文本居中，我认为您需要为#one 指定宽度，例如

```
<div style="width: 300px">
<div id="one" style="float: left;text-align:center;width:80%">saved</div>
<input type="submit" id="two" style="float: right;width:20%" value="Submit" />
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T11:02:29.340

还有一些方法可以做到：

```
<div style="width: 300px">
    <input type="submit" id="two" style="float: right" value="Submit" />
    <div id="one" style="text-align:center;">saved</div>
</div> 
```

很难说文本`saved`不在容器`div`的左边缘和提交按钮的左边缘之间居中。

这是上述内容的确切版本：

```
<div style="width: 300px;">
    <input type="submit" id="two" style="float: right; width:64px;" value="Submit" />
    <div id="one" style="text-align:center;margin-right:64px;">saved</div>
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-29T02:07:36.487

这是 CSS 常见问题的一个示例，即无法计算各种布局中的“剩余空间”。

我遇到过您（a）需要精确布局和（b）您不知道浮动项目大小的情况。

例子：

> [---- 占用 100% 剩余空间的输入字段----] [未知宽度的按钮]

你会认为这是可能的，但是 AFAIK，你必须使用表格来实现这一点。CSS 中甚至没有关于将来如何解决此问题的提案。*叹*

# java - 如何在读取文件以生成 XML DOM 时忽略空格

> ID：229310
> 
> 赞同：9
> 
> 时间：2008-10-23T10:55:26.330
> 
> 标签：java, xml, whitespace

我正在尝试读取文件以生成 DOM 文档，但该文件有空格和换行符，我试图忽略它们，但我不能：

```
DocumentBuilderFactory docfactory=DocumentBuilderFactory.newInstance();
docfactory.setIgnoringElementContentWhitespace(true); 
```

我在 Javadoc 中看到 setIgnoringElementContentWhitespace 方法仅在启用验证标志时运行，但我没有文档的 DTD 或 XML Schema。

我能做些什么？

更新

我不喜欢引入 mySelf < !ELEMENT... 声明的想法，我已经尝试了 Tomalak 指出的[论坛](http://forums.sun.com/thread.jspa?messageID=2054303#2699961)中提出的解决方案，但它不起作用，我在 linux 环境中使用了 java 1.6。我想如果没有更多的提议，我会做一些方法来忽略空白文本节点

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-23T12:21:04.830

'IgnoringElementContentWhitespace' 并不是要删除*所有*纯空白文本节点，仅删除其父级在模式中被描述为具有 ELEMENT 内容的空白节点——也就是说，它们只包含其他元素而不包含文本。

如果您没有使用模式（DTD 或 XSD），则元素内容默认为 MIXED，因此此参数将永远不会有任何效果。（除非解析器提供了一个非标准的 DOM 扩展来将所有未知元素视为包含 ELEMENT 内容，据我所知，可用于 Java 的那些没有。）

您可以在进入解析器的过程中破解文档以包含架构信息，例如通过将内部子集添加到包含 < !ELEMENT ... > 声明的 < !DOCTYPE ... [...] > 声明，然后使用 IgnoringElementContentWhitespace 参数。

或者，可能更简单，您可以在后期处理中或在它们使用 LSParserFilter 进入时去除空白节点。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-05-01T22:29:12.147

这是一个（真的）迟到的答案，但这是我解决它的方法。我编写了自己的`NodeList`类实现。它只是忽略空的文本节点。代码如下：

```
private static class NdLst implements NodeList, Iterable<Node> {

    private List<Node> nodes;

    public NdLst(NodeList list) {
        nodes = new ArrayList<Node>();
        for (int i = 0; i < list.getLength(); i++) {
            if (!isWhitespaceNode(list.item(i))) {
                nodes.add(list.item(i));
            }
        }
    }

    @Override
    public Node item(int index) {
        return nodes.get(index);
    }

    @Override
    public int getLength() {
        return nodes.size();
    }

    private static boolean isWhitespaceNode(Node n) {
        if (n.getNodeType() == Node.TEXT_NODE) {
            String val = n.getNodeValue();
            return val.trim().length() == 0;
        } else {
            return false;
        }
    }

    @Override
    public Iterator<Node> iterator() {
        return nodes.iterator();
    }
} 
```

然后，您将所有 s 包装`NodeList`在此类中，它将有效地忽略所有空白节点。（我将其定义为具有 0 长度修剪文本的文本节点。）

它还具有能够在 for-each 循环中使用的额外好处。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-26T03:58:36.297

我通过这样做使它起作用

```
DocumentBuilderFactory dbFactory = DocumentBuilderFactory.newInstance();
        dbFactory.setIgnoringElementContentWhitespace(true);
        dbFactory.setSchema(schema);
        dbFactory.setNamespaceAware(true);
NodeList nodeList = element.getElementsByTagNameNS("*", "associate"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-07-07T02:34:58.703

我最终遵循了@bobince 使用 LSParserFilter 的想法。是的，该界面记录在[https://docs.oracle.com/javase/7/docs/api/org/w3c/dom/ls/LSParserFilter.html](https://docs.oracle.com/javase/7/docs/api/org/w3c/dom/ls/LSParserFilter.html)但很难找到好的示例/解释材料。经过大量搜索后，我在[http://www.informit.com/articles/article.aspx?p=31297&seqNum=29（Nicholas](http://www.informit.com/articles/article.aspx?p=31297&seqNum=29) Chase，2003 年 3 月 14 日）找到了 DOM Level 3 Load and Save XML Reference Guide。这对我帮助很大。这是我的代码的一部分，它与 org.custommonkey.xmlunit 进行 XML 差异。（这是我自己写的一个工具，用来帮助我完成有偿工作，所以我留下了很多东西，比如更好的异常处理，以备不时之需。）

我特别喜欢使用 LSParserFilter，因为出于我的目的，我可能会在将来添加一个选项来忽略 id 属性，这应该是这个框架的一个简单增强。

```
// A small portion of my main class.
// Other imports may be necessary...
import org.w3c.dom.bootstrap.DOMImplementationRegistry;
import org.w3c.dom.ls.DOMImplementationLS;
import org.w3c.dom.ls.LSParser;
import org.w3c.dom.ls.LSParserFilter;

Document controlDoc = null;
Document testDoc = null;
try {
    System.setProperty(DOMImplementationRegistry.PROPERTY, "org.apache.xerces.dom.DOMImplementationSourceImpl");
    DOMImplementationRegistry registry = DOMImplementationRegistry.newInstance();
    DOMImplementationLS impl = (DOMImplementationLS) registry.getDOMImplementation("LS");
    LSParser builder = impl.createLSParser(DOMImplementationLS.MODE_SYNCHRONOUS, null);
    LSParserFilter filter = new InputFilter();
    builder.setFilter(filter);
    controlDoc = builder.parseURI(files[0].getPath());
    testDoc = builder.parseURI(files[1].getPath());
} catch (Exception exc) {
    System.out.println(exc.getMessage());
}

//--------------------------------------

import org.w3c.dom.ls.LSParserFilter;
import org.w3c.dom.Element;
import org.w3c.dom.Node;
import org.w3c.dom.traversal.NodeFilter;

public class InputFilter implements LSParserFilter {

    public short acceptNode(Node node) {
        if (Utils.isNewline(node)) {
            return NodeFilter.FILTER_REJECT;
        }
        return NodeFilter.FILTER_ACCEPT;
    }

    public int getWhatToShow() {
        return NodeFilter.SHOW_ALL;
    }

    public short startElement(Element elem) {
        return LSParserFilter.FILTER_ACCEPT;
    }

}

//-------------------------------------
// From my Utils.java:

    public static boolean isNewline(Node node) {
        return (node.getNodeType() == Node.TEXT_NODE) && node.getTextContent().equals("\n");
    } 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2018-02-16T22:44:17.640

试试这个：

```
private static Document prepareXML(String param) throws ParserConfigurationException, SAXException, IOException {

        param = param.replaceAll(">\\s+<", "><").trim();
        DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
        factory.setIgnoringElementContentWhitespace(true);
        DocumentBuilder builder = factory.newDocumentBuilder();
        InputSource in = new InputSource(new StringReader(param));
        return builder.parse(in);

    } 
```

# macos - Mac/Windows 切换

> ID：229324
> 
> 赞同：2
> 
> 时间：2008-10-23T11:02:41.603
> 
> 标签：macos, keymapping

大约 2 年前，我从家里的 PC 上放弃了 Windows，并 100% 切换到 linux（fedora，然后是 ubuntu）——这位女士不太高兴，但她已经习惯了，并且学到了一两件事。然后大约 6 个月前，我给自己买了一台闪亮的新 Macbook，自从搬到 OSX 之后，我就再也没有回头；不幸的是，我没有成功让我的雇主给我买一个工作（而且我不能来回携带我的）所以我不得不“忍受”窗户。

我在 8 年前开始使用 Windows，因此我非常了解它的工作原理，并且在 Win32/MFC/.NET 开发方面做了我应有的贡献。

我的问题是；还有谁必须在工作中使用 Windows 盒子（并且在家里有 Mac）以及您如何应对 - 他们使用哪些 Windows 应用程序/配置让他们以与 OSX 类似的方式工作？- 我只是在想，如果我能获得某种键盘映射应用程序，将我的 Windows 键重新映射到 OSX 变体（Apple+W、Apple+Q、Apple+Left、Apple+Right 等），那该有多酷.

我想念暴露（TopDesk 不错但不是免费的）...我想念查找器的简单性...我想念漂亮的平滑对话框和窗口和阴影（YzShadow 可以应付）我想念底层的 unix 框架（我运行 andLinux 在工作）我想念 OSX :(

不幸的是，我们 90% 的客户使用 IE，所以 windows 是必须的；他们也无法证明为开发人员购买 Mac 是合理的；尤其是 Mac Pro :-p

呃，好吧。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T11:12:35.123

操作系统只是一个工具，如果您正在构建跨平台应用程序（或 Web 应用程序[它仅取决于您的目标 Web 浏览器]）并且您可以使用您喜欢的任何操作系统，您可以在 osx 上的虚拟机中安装 windows xp例如，使用 IE，**但**如果您的公司强制您登录他们的域控制器，使用项目经理分配给您的电子邮件和任务管理的 Outlook，这是不同的故事。正如您在工作和家庭中提到的多个操作系统，我个人在家里使用 Linux，但我在工作中使用 Windows，因为在我的日常工作中，我编写了大量 C# .NET 代码，但在家里我花时间使用开源编程技术，我使用它是因为我从 2001 年 10 月开始使用 Linux。所以试着习惯它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-23T11:42:27.887

如果您喜欢命令行上的生活，我是否可以建议您尝试使用 PowerShell 作为 windows 框上 cmd 的替代品。它极大地帮助了我从 Unix 服务器环境过渡。你有一个配置文件和创建别名和修改东西的能力。现在我不必担心使用我信任的 Unix 命令之一，如果我发现 PowerSHell 团队尚未处理的命令，我只需创建它并将其添加到我的配置文件中。ls，处理 grep，top 并找到胜利！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T11:12:45.280

我每天从一个切换到另一个都没有太多的痛苦。最后，我大部分时间都花在了完全独立于平台的 Eclipse 和 Opera Web 浏览器上。

其余的，我使用 launchy 来模仿 quicksilver 和 e 作为 Textmate 的替代品。

最后，我对我的 mac 比较满意，不是因为它提供的软件，而是因为它不提供的软件，比如我在工作中被迫使用的 Toad 或 IE。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-23T11:12:55.607

尽管有很多方法可以让 Windows 看起来像 OS X，但没有一个解决方案能够提供真正的 OS X 体验。不是就操作系统功能而言，那是不可能的，但外观和感觉总是不同的。我记得为了快乐而剥皮，我的 Windows XP 盒子（就像 5 年前一样）并使用 Windows Blind 加上很多工具（YZDock！）来拥有一个“WS X”；）

它从未有过相同的感觉。

如果您的硬件在 OS X 上“正常”，您可以尝试“hackintosh”。然后运行 ​​VMWare/Parallels。

否则，你就像我一样：

哭一条河。建造一座桥梁并克服它。:)

我使用 OS X (Mac Pro)，但我用 C# 编写代码，所以我每天 90% 的时间都在 Windows VIsta 中，在众多空间之一中全屏显示；优点是 VMWare（和 Parallels）允许您映射您的密钥，以便我可以在 Windows 中使用 cmd-c/v。

我理解你的沮丧：S

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-23T11:17:08.190

我认为我为最大限度地提高生产力所做的最好的事情就是跨平台标准化我的文本编辑器。就我个人而言，我尽可能地使用 vim。我使用 viemu 集成到 windows 上的 Visual Studio，用 gvim 替换了记事本，我在 mac 和 linux 上都使用 vim。

您可以重新映射快捷方式，但简单的快捷方式无论如何都是一样的。就我个人而言，我没有记住两者的问题。我每隔几分钟就会进行一次心理锻炼，以寻找特定于操作系统的地标，以提醒我我在 Vista 或 OS X 上，这有助于我保持专注。

如果您是 Linux 脚本的粉丝，我也会研究 Powershell，它是 IMNSHO 中最酷的 shell。失败总是有[Interix](http://en.wikipedia.org/wiki/Interix)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-23T13:06:34.130

> 不幸的是，我们 90% 的客户使用 IE，所以 windows 是必须的

[IE6 可以在没有 Windows 的 OS X 下运行](http://www.kronenberg.org/ies4osx/)（字体不太对，但对于日常测试来说已经足够了），并且您可以在虚拟化（Parallels、VMWare、VirtualBox）下获得 100% 完美。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-23T11:13:18.850

作为一名软件开发人员，我几乎生活在我的文本编辑器和 shell 中。在我被迫使用 Windows 的工作中，我安装了 emacs 和 cygwin，然后我就开始参加比赛了。

我不专注于外围——控制面板、窗口管理器等——我专注于我真正使用的 90+% 的时间，其余的时间都不会出汗。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-23T11:31:37.253

一点点cygwin来消除窗户的痛苦。任何虚拟环境都可以工作。Mac 可以运行具有强制 Outlook 要求的并行托管窗口。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-23T12:01:21.860

如果这不是经济负担并且您的公司允许这样做，那就给自己买一台 macbook。我每天带着我的macbook回家工作。我有外部 24" 屏幕在工作，这与在 windows 盒子上工作没有区别。当我需要使用 windows/IE 时，我会运行并行，否则，我所有的时间都花在了 mac 上。

这种安排中的另一个重要项目是用于工作备份的外部硬盘驱动器。时间机器每小时备份 + Windows 工作文件同步，一切就绪。这样，您就不必担心如果您被抢劫或发生事故而失去工作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-23T12:39:01.767

我也遇到了同样的情况——家里的 Mac，工作的 Windows。没有任何方法可以将 Mac 体验带入 Windows，而不会出现问题或编写不良的程序行为不端。你只需要习惯在两者之间进行调整。

唯一让我印象深刻的三件事是在 Windows 中按 Shift-2 的“@”符号（我有一个英式键盘，但 Mac 使用美式键位），尝试用两根手指和鼠标点击右键单击 Windows 笔记本电脑触控板，然后按 F9 显示。在 Command-C 和 Ctrl-C 之间切换并没有真正困扰我。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-23T12:49:49.220

我在工作中使用 Windows XP，在家里使用 Mac OS X 和 Linux。

Windows XP 每天都让我感到沮丧。如果我只使用它，我会习惯这些限制，但每天都会接触到它们（以及大量糟糕的软件，从可怕的 Checkpoint VPN 客户端到笨拙的 Outlook），然后在晚上体验到不错的软件只是强调了 XP 的局限性（公平地说，现在 XP 很受人尊敬）。

但是，每天进行切换不是问题，@/" 问题除外。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-26T12:27:28.117

为了让 Mac 更“像 Windows”，我做过的唯一一件事就是安装 Office for Mac。我从来没有遇到过我无法读取或写入的文件的问题，而且“学生版”非常便宜。最近，为了处理 IE6，我使用购买的 bootcamp 和一份 XP 的 MSDN 副本在我的 Macbook 上的分区上安装 XP。没问题。

我经常使用 OSX、Windows 和 Linux，唯一让我感到困惑的是当我在 Macbook 上的 VMWare 下运行 XP 时。出于某种原因，当我的手指在 Mac 键盘上时，我在使用 Windows 击键时遇到了很多麻烦。

否则，没有真正的问题。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-15T09:53:02.757

我没什么大问题。我可以在 OSX 中完成大部分开发工作，eclipse 可以工作，Coda 是一个很棒的 Web 开发工具，但是当我需要使用 Visual Studio 时，我可以通过在 Fusion 中运行或通过 bootcamp 启动到 Windows 来完成。在 bootcamp 上安装 Windows 意味着我还可以比我拥有的大多数 Windows PC 更好地运行游戏！

# java - JBoss/EJB 与对称 DS

> ID：229325
> 
> 赞同：0
> 
> 时间：2008-10-23T11:03:02.833
> 
> 标签：java, hibernate, jakarta-ee, jboss, ejb-3.0

我正在做一个即将开始的项目，由于我正忙于另一个项目，我的同事们继续着手研究新项目的规范。当我进来时，他们刚刚选择使用纯 SQL 进行持久化（尽管很快接受了我添加 Hibernate 的建议），但坚持认为应该使用一个我从未听说过的名为**Symmetric DS的工具来执行数据复制。**

我很担心，因为据我所知，拥有一个带有 EJB3 的 JBoss 服务器（当前计划仅使用 Tomcat）可以处理所有事务/复制的麻烦，并且应该让我们免于很多麻烦。

你们如何看待这款**Symmetric DS**？（请注意，我对此没有任何反对意见，只是我知道 JBoss 已经存在了很长时间，而且它的声誉相当可观）

您如何比较这两种解决方案？

谢谢！

**编辑**：顺便说一下，SymmetricDS 如何处理重复的主键？我的意思是，如果我在数据库 A 中添加一行，在数据库 B 中添加另一行，那么两者可能都会添加相同的主键，对吧？SymmetricDS 如何处理以避免冲突？这个[论坛讨论](http://sourceforge.net/forum/forum.php?thread_id=2375854&forum_id=739236)起初似乎解决了其中的一些问题，但并没有完全回答我的问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-23T17:47:55.933

我认为 EJB 和 SymmetricDS 正在尝试解决不同的问题。EJB 是一个为数据库提供（在许多方面）持久性的框架。SymmetricDS 是一个应用程序，它捕获对数据库所做的更改并以异步方式将它们应用到另一个数据库。事实上，这两者一起工作，使您能够轻松地将数据从 Java Bean 持久保存到数据库，并将其复制到其他远程数据库。

您可以将 SymmetricDS 部署到 JBoss 或 Tomcat（也有独立和嵌入式选项），它只关心数据库。在幕后，它使用 Spring 框架来访问数据库。它安装数据库触发器来捕获更改，并以完全相同的方式将更改应用于目标数据库。因此，如果行 A 和 B 在源数据库上一起提交，那么它们在目标上一起提交。

我希望这有助于澄清这两种技术。SourceForge 上有一个活跃的 SymmetricDS 社区，非常乐意回答问题并提供成功部署的示例：

[http://sourceforge.net/projects/symmetricds](http://sourceforge.net/projects/symmetricds)

祝你的项目好运！

埃里克

# unit-testing - GWT 单元测试 TDD 和工具

> ID：229333
> 
> 赞同：7
> 
> 时间：2008-10-23T11:07:18.317
> 
> 标签：unit-testing, gwt, tdd

我刚刚开始使用 gwt，到目前为止一切都很好，但是在阅读了一些示例代码之后，我想知道是否需要高水平的测试覆盖率？（我可以看到大多数代码都是声明性的，然后添加一些属性，我可以看到检查的意义，所以我有特定的属性但不是全部）

我也很想知道关于使用 GWT 进行 TDDing 的陷阱是什么

我正在使用 Eclipse，所以如果您对 GWT 的一些特别添加插件真的很满意，我会很高兴听到这一点，谢谢您的意见

编辑：也许我在问一个非常广泛的问题，但即使是很少的信息也会帮助我从 jquery/extJs/prototype/scriptaculous 中获得 nvelocity 视图，这有点不同

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T02:54:18.560

在将 GWT 应用程序设计为易于测试时，最好将尽可能多的逻辑移出视图。使用使 GUI 测试更容易的设计模式，例如 Model-View-Presenter (MVP)，它广泛用于构建桌面应用程序（C#/.NET 人员已经写了很多关于这种模式的文章。）

您可以使用 GWTTestCases 测试远程通信和最终执行原始 JavaScript 的代码（大多数 GWT 核心类都需要这个，尤其是小部件）。但是，这些测试执行起来很慢，因此您应该更喜欢将所有逻辑放在可以在普通的 JUnit 测试用例中测试的对象中的设计。

有关以测试为先编写 GWT 应用程序的更多信息，我为 Better Software 杂志撰写了一篇文章，该文章[在我的博客上](http://blog.danielwellman.com/2008/11/test-first-gwt-article-in-november-2008-better-software-magazine.html)以 PDF 格式在线提供。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-11-26T17:02:39.137

我认为目前最好的参考是this [Testing Methodologies Using Google Web Toolkit](http://code.google.com/webtoolkit/articles/testing_methodologies_using_gwt.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-25T19:29:17.313

我认为您提出了一个相当广泛的问题，这也是您有一段时间没有得到答复的部分原因。

与传统的 AJAX Web 开发相比，可以说 GWT 应用程序需要更少的测试。由于 GWT 团队一直在努力确保其小部件在所有 Web 浏览器中始终如一地工作，因此您几乎不必担心自己的应用程序的跨浏览器兼容性。

这让您可以专注于自己的应用程序。为您自己的每个自定义小部件创建一个单独的测试用例并测试它们的行为是否符合您的预期，然后为每个模块编写更高级别的测试。采取额外的步骤使您的测试完全自动化 - 这样每次您进行更改或即将发布时，都可以轻松运行所有测试。

[http://code.google.com/docreader/#p=google-web-toolkit-doc-1-5&s=google-web-toolkit-doc-1-5&t=DevGuideJUnitIntegration](http://code.google.com/docreader/#p=google-web-toolkit-doc-1-5&s=google-web-toolkit-doc-1-5&t=DevGuideJUnitIntegration)

# flash - Flash 中的“static void Main”等价物是什么？

> ID：229334
> 
> 赞同：2
> 
> 时间：2008-10-23T11:07:29.847
> 
> 标签：flash, actionscript-3, actionscript, fdt

我正在对以前在 Flash CS3 中成功运行的项目尝试 FDT 编辑器。

FDT 成功构建并运行它，但 SWF 为空白（白色）。我在输出文件上尝试了几个查看器，它实际上是空白的。

一个区别是现在我的项目似乎不包括我的入口`.fla`文件。我是 Flash/ActionScript 的新手，想知道 FLA 文件是否包含类似于`public static void Main`其他语言中的方法的魔法。

那么，如果我纯粹在 ActionScript 3（无`.fla`文件）中构建应用程序，我该如何指定入口点、画布大小等？

当然，也有可能是我设置的 FDT 不正确 :)

**编辑：**新手警报！

原来我通过 FDT 看到的白色阶段是因为我的 FLA 在不同的文件夹中运行，我无法加载我的任何资源，所以没有准备好显示。我还配置了 FDT，使我没有通过调试器看到错误。

这个问题有点傻。删除这样的问题是否正常？

对于其他具有扎实编程背景的 Flash/ActionScript 的人来说，我发现这是对显示模型的一个很好的概述：

[http://livedocs.adobe.com/flex/3/html/help.html?content=05_Display_Programming_02.html#152593](http://livedocs.adobe.com/flex/3/html/help.html?content=05_Display_Programming_02.html#152593)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-23T11:53:44.323

等价的将是主类的构造函数。那是您指定用于编译的类（原则上，其余类仅在它们在正在编译的代码中被引用时才被编译，无论是主类还是它的任何类引用）。

在 Flash IDE 中，它将是 Document 类的构造函数（如果您碰巧使用一个，则不是强制性的），或者只是主时间轴中的第一个关键帧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T11:25:57.920

您只能从 Flash IDE 发布基于 fla 的内容，因此如果您不再使用它，则需要发布图形的资产 swf 等。

我想你正在使用 MXML 编译器？如果是这样，请查看有关如何设置舞台大小等的 adobe live 文档。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T17:49:26.960

那么您在什么情况下使用 FDT？假设这是在 Eclipse 中运行的，您只需要为 mxmlc 编译器指定一些参数作为构建过程的一部分。例如...

$ mxmlc Main.as -默认大小 100 200

其中“Main.as”是您的入口点 AS3 文件，“100”是宽度，“200”是高度。MXMLC 默认输出 SWF 与您的输入类同名。所以在本例中，它将发布为名为“Main.swf”的 SWF，但这也是可配置的。这是 mxmlc 命令行参数的一个很好的 Adob​​e 资源：[Adobe MXMLC docs](http://livedocs.adobe.com/flex/3/html/help.html?content=compilers_13.html)

高温高压

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-27T13:28:01.333

您可以使用 SWF 元数据在主类中设置一些内容，例如 -

[SWF(宽度='455', 高度='200', backgroundColor='#123456', frameRate='25')]

# c# - 为什么我永远不应该使用不安全的块来修改字符串？

> ID：229346
> 
> 赞同：3
> 
> 时间：2008-10-23T11:12:57.510
> 
> 标签：c#, .net

我有一个字符串，我想以某种方式对其进行修改。例如：反转它或大写它。

我发现最快的方法是使用不安全的块和指针。

例如：

```
 unsafe 
        {
            fixed (char* str = text)
            {
                *str = 'X';
            }
        } 
```

有什么理由让我永远不应该这样做吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-23T11:15:05.727

.Net 框架要求字符串是不可变的。由于这个要求，它能够优化各种操作。

[字符串实习](http://en.wikipedia.org/wiki/String_intern_pool)是这个要求被大量利用的一个很好的例子。为了加快一些字符串比较（并减少内存消耗），.Net 框架维护了一个指针字典，所有预定义的字符串都将存在于这个字典或您调用该`String.intern`方法的任何字符串中。当调用 IL 指令 ldstr 时，如果我们已经分配了字符串，它将检查实习字典并避免内存分配，注意：[String.Concat](http://bartdesmet.net/blogs/bart/archive/2006/09/27/4472.aspx)不会检查实习字符串。

.net 框架的这一属性意味着，如果您开始直接使用字符串，您可能会破坏您的实习生表，进而破坏对同一字符串的其他引用。

例如：

```
 // these strings get interned
        string hello = "hello";
        string hello2 = "hello";

        string helloworld, helloworld2;

        helloworld = hello;
        helloworld += " world";

        helloworld2 = hello;
        helloworld2 += " world"; 

        unsafe
        {
            // very bad, this changes an interned string which affects 
            // all app domains.
            fixed (char* str = hello2)
            {
                *str = 'X';
            }

            fixed (char* str = helloworld2)
            {
                *str = 'X';
            }

        }

        Console.WriteLine("hello = {0} , hello2 = {1}", hello, hello2);
        // output: hello = Xello , hello2 = Xello  

        Console.WriteLine("helloworld = {0} , helloworld2 = {1}", helloworld, helloworld2);
        // output : helloworld = hello world , helloworld2 = Xello world 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-23T11:16:11.013

> 有什么理由让我永远不应该这样做吗？

是的，非常简单：因为 .NET 依赖于字符串不可变这一事实。某些操作（例如`s.SubString(0, s.Length)`）实际上返回对原始字符串的引用。如果现在对此进行修改，则所有其他引用也将如此。

最好使用 a`StringBuilder`来修改字符串，因为这是默认方式。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-23T11:35:36.123

这么说吧：如果另一个程序员决定在执行时将代码中的任何地方的 0 替换为 1，你会有什么感觉？它会与你的所有假设一起玩地狱。字符串也是如此。*每个人都*希望它们是不可变的，并且在编码时考虑到这种假设。如果你违反了这一点，你很可能会引入错误——而且它们*真的*很难追踪。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-23T11:18:10.480

哦，亲爱的主，是的。

1）因为该类不是为篡改而设计的。

2）因为字符串在整个框架中被设计并期望是不可变的。这意味着其他所有人（包括 MSFT）编写的代码都期望字符串的基础值永远不会改变。

3）因为这是过早的优化，也就是 EVI L。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T17:46:51.490

同意 StringBuilder，或者只是将您的字符串转换为字符/字节数组并在那里工作。此外，您还举了“upcasing”的例子—— String 类有一个 ToUpper 方法，如果这*至少*不如您不安全的“upcasing”那么快，我会吃掉我的帽子。

# python - Python 查找问题

> ID：229352
> 
> 赞同：2
> 
> 时间：2008-10-23T11:15:42.683
> 
> 标签：python, url

我正在使用 Python 从使用 rfind 的链接中提取文件名，如下所示：

```
url = "http://www.google.com/test.php"

print url[url.rfind("/") +1 : ] 
```

这适用于结尾没有 / 的链接并返回“test.php”。我在末尾遇到了带有 / 的链接，例如“ [http://www.google.com/test.php/](http://www.google.com/test.php/) ”。当末尾有“/”时，我无法获取页面名称，有人可以帮忙吗？

干杯

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-23T11:32:46.660

仅删除末尾的斜杠是行不通的，因为您可能有一个如下所示的 URL：

```
http://www.google.com/test.php?filepath=tests/hey.xml 
```

...在这种情况下，您将返回“hey.xml”。**您可以使用urlparse**摆脱参数，而不是手动检查，然后执行其他人建议的检查：

```
from urlparse import urlparse
url = "http://www.google.com/test.php?something=heyharr/sir/a.txt"
f = urlparse(url)[2].rstrip("/")
print f[f.rfind("/")+1:] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-23T11:42:52.613

使用 [r]strip 删除尾部斜杠：

```
url.rstrip('/').rsplit('/', 1)[-1] 
```

如果可能的 URL 范围更广，包括带有 ?queries、#anchors 或没有路径的 URL，请使用 urlparse 正确处理：

```
path= urlparse.urlparse(url).path
return path.rstrip('/').rsplit('/', 1)[-1] or '(root path)' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T11:31:12.917

末尾带有斜杠的文件名在技术上仍然是路径定义，表示要读取索引文件。如果您实际上有一个以 结尾的`test.php/`，我会认为这是一个错误。在任何情况下，您都可以在运行代码之前从末尾删除 /，如下所示：

```
url = url.rstrip('/') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-23T11:32:14.197

有一个名为[urlparse](http://www.python.org/doc/2.4/lib/module-urlparse.html)的库可以为您解析 url，但仍然不会删除末尾的 / 所以上述之一将是最好的选择

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T11:38:13.170

只是为了好玩，您可以使用正则表达式：

```
import re
print re.search('/([^/]+)/?$', url).group(1) 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-23T11:28:54.670

你可以使用

```
print url[url.rstrip("/").rfind("/") +1 : ] 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-23T13:10:34.840

```
filter(None, url.split('/'))[-1] 
```

（但 urlparse 可能更具可读性，即使更冗长。）

# c# - 部分 ViewData.Model 为空

> ID：229353
> 
> 赞同：0
> 
> 时间：2008-10-23T11:16:07.270
> 
> 标签：c#, asp.net-mvc, model

在我的主页（调用它`index.aspx`）我调用

```
<%Html.RenderPartial("_PowerSearch", ViewData.Model);%> 
```

当我`viewdata.model != null` 到达我的部分时：

```
<%=ViewData.Model%> 
```

说`viewdata.model == null`

是什么赋予了？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-23T11:21:25.323

您是否尝试过只传入 ViewData 而不是 ViewData.Model？这是我在助手中使用的精简版（无耻地从 Storefront 系列中窃取）：

```
 /// <summary>
    /// Renders a LoggingWeb user control.
    /// </summary>
    /// <param name="helper">Helper to extend.</param>
    /// <param name="control">Type of control.</param>
    /// <param name="data">ViewData to pass in.</param>
    public static void RenderLoggingControl(this System.Web.Mvc.HtmlHelper helper, LoggingControls control, object data)
    {
        string controlName = string.Format("{0}.ascx", control);
        string controlPath = string.Format("~/Controls/{0}", controlName);
        string absControlPath = VirtualPathUtility.ToAbsolute(controlPath);
        if (data == null)
        {
            helper.RenderPartial(absControlPath, helper.ViewContext.ViewData);
        }
        else
        {
            helper.RenderPartial(absControlPath, data, helper.ViewContext.ViewData);
        }
    } 
```

请注意，我传入的是当前 ViewData 而不是 Model。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-23T11:51:18.697

这是未经测试的：

```
<%=Html.RenderPartial("_ColorList.ascx", new ViewDataDictionary(ViewData.Model.Colors));%> 
```

在这种情况下，您的控制视图需要特定于它的视图数据。如果您的控件想要一个名为 Colors 的模型上的属性，那么也许：

```
<%=Html.RenderPartial("_ColorList.ascx", new ViewDataDictionary(new { Colors = ViewData.Model.Colors }));%> 
```

# perl - Perl 中将文件复制到尚未创建的目录树中的最佳方法是什么？

> ID：229357
> 
> 赞同：21
> 
> 时间：2008-10-23T11:17:21.887
> 
> 标签：perl, directory, copy

**Perl**中将文件复制到尚未创建的目标目录树的最佳方法是什么？

就像是

```
copy("test.txt","tardir/dest1/dest2/text.txt"); 
```

由于目录*tardir/dest1/dest2*尚不存在，因此无法正常工作。在 Perl 中创建目录的最佳复制方法是什么？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-10-23T11:33:32.257

```
use File::Path;
use File::Copy;

my $path = "tardir/dest1/dest2/";
my $file = "test.txt";

if (! -d $path)
{
  my $dirs = eval { mkpath($path) };
  die "Failed to create $path: $@\n" unless $dirs;
}

copy($file,$path) or die "Failed to copy $file: $!\n"; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-23T11:27:39.930

```
use File::Basename qw/dirname/;
use File::Copy;

sub mkdir_recursive {
    my $path = shift;
    mkdir_recursive(dirname($path)) if not -d dirname($path);
    mkdir $path or die "Could not make dir $path: $!" if not -d $path;
    return;
}

sub mkdir_and_copy {
    my ($from, $to) = @_;
    mkdir_recursive(dirname($to));
    copy($from, $to) or die "Couldn't copy: $!";
    return;
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-23T21:09:15.933

[File::Copy::Recursive](http://search.cpan.org/perldoc?File::Copy::Recursive) ::fcopy() 是非核心的，但将 File::Path::mkpath() 和 File::Copy::copy() 解决方案组合成更短的解决方案，并保留与 File 不同的权限： ：复制。它还包含其他漂亮的实用功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-24T08:15:38.757

请参阅其他答案以进行复制，但对于创建目录[Path::Class](http://search.cpan.org/dist/Path-Class/)非常好用：

```
use Path::Class;

my $destination_file  = file('tardir/dest1/dest2/test.txt');
$destination_file->dir->mkpath;

# ... do the copying here 
```

# c# - 从 C# 调用 FORTRAN DLL 的受保护内存冲突

> ID：229362
> 
> 赞同：4
> 
> 时间：2008-10-23T11:18:40.587
> 
> 标签：c#, .net, interop, fortran, dllimport

我正在尝试调用从 FORTRAN 代码编译的旧版 dll。我是 Interop 的新手，但我已经阅读了一些关于它的文章，看起来我的案例应该相当简单。

我真正想调用的方法有一个复杂的方法签名，但我什至不能调用这个简单的 GetVersion 方法而不会得到受保护的内存冲突。

这是我的 DllImport 代码：

```
[DllImport("GeoConvert.dll", 
            EntryPoint="_get_version@4", 
            CallingConvention=CallingConvention.StdCall)]
public static extern void GetGeoConvertVersion([MarshalAs(UnmanagedType.LPStr, SizeConst=8)]
                                                    ref string version); 
```

这是 FORTRAN 代码：

```
SUBROUTINE GetVer( VRSION )
C
!MS$DEFINE  MSDLL 
!MS$IF DEFINED (MSDLL)
        ENTRY Get_Version (VRSION)  
      !MS$ATTRIBUTES DLLEXPORT,STDCALL :: Get_Version
      !MS$ATTRIBUTES REFERENCE :: VRSION
!MS$ENDIF
!MS$UNDEFINE  MSDLL 
C
  CHARACTER*8  VRSION
C
  VRSION = '1.0a_FhC'                                        
C
  RETURN
  END 
```

这是我失败的单元测试：

```
[Test]
public void TestGetVersion()
{
    string version = "";
    LatLonUtils.GetGeoConvertVersion(ref version);
    StringAssert.IsNonEmpty(version);
} 
```

这是我收到的错误消息：

```
System.AccessViolationException
Message: Attempted to read or write protected memory. 
         This is often an indication that other memory is corrupt. 
```

我尝试过的其他事情：

*   使用默认编组
*   传递 char[] 而不是字符串（改为获取方法签名错误）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-23T17:56:58.817

...剪断...好吧，我让它工作，问题是通过参考。我不知道为什么，但这有效：......剪断......

您需要通过引用传递，因为这是 FORTRAN 代码使用的语义。客户端代码正在传递一个缓冲区，FORTRAN 代码将写入该缓冲区以代替使用返回值。

...snip... !MS$ATTRIBUTES 参考 :: VRSION ...snip...

FORTRAN 代码中的此属性指定此参数通过引用传递。这意味着 FORTRAN 代码将写入该地址。如果 DllImport 也没有将其声明为 ref 值，您将遇到访问冲突。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T12:22:49.833

好的，我让它工作了，问题是通过参考。我不知道为什么，但这有效：

```
[DllImport("GeoConvert.dll", 
                EntryPoint="_get_version@4", 
                CallingConvention=CallingConvention.StdCall)]
    public static extern void GetGeoConvertVersion([MarshalAs(UnmanagedType.LPArray)]
                                                    byte[] version); 
```

通过这个测试：

```
[Test]
    public void TestGetVersion()
    {
        //string version = "";
        byte[] version = new byte[8];
        LatLonUtils.GetGeoConvertVersion(version);
        char[] versionChars = System.Text.Encoding.ASCII.GetChars(version);

        string versionString = new string(versionChars);
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T12:13:56.920

您是否尝试过使用 StringBuilder？

将您的 String 创建为 StringBuilder 并将其传递给 dll 函数。

我不确定要使用什么 Marashlling 语句，也许默认值可能会起作用。

看看：[C# P/Invoke 中的 Marshal C++ “string” 类](https://stackoverflow.com/questions/158628/marshal-c-string-class-in-c-pinvoke)

这是一篇可能也有帮助的好文章：[Interop Marshalling](http://www.arstdesign.com/articles/interopmarshaling.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-23T14:14:32.917

由于我没有 FORTRAN 编译器，因此我无法尝试此解决方案，但我认为这对您有用：

```
 [DllImport("GeoConvert.dll", 
            EntryPoint="_get_version@4", 
            CallingConvention=CallingConvention.StdCall,
            CharSet=CharSet.Ansi)]
    public static extern void GetGeoConvertVersion(StringBuilder version); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-02-11T06:48:01.527

谢谢大家，我一直在尝试将字符串从 c# 传递给 fortran dll 的子例程，这种方法是许多其他方法中唯一有效的方法

# visual-studio-2008 - 如何不签署 ClickOnce 清单

> ID：229373
> 
> 赞同：9
> 
> 时间：2008-10-23T11:23:27.380
> 
> 标签：visual-studio-2008, deployment, clickonce

我有一个在 Visual Studio 2008 中创建的[Office 2007](https://en.wikipedia.org/wiki/Microsoft_Office#Windows_versions)（特别是[Outlook 2007](https://en.wikipedia.org/wiki/Microsoft_Outlook#Outlook_2007)）插件。

当我取消选中“签署 ClickOnce 清单”选项，然后发布时，它会自动重新检查该选项。

我在同一个解决方案中有一个常规的[Windows 窗体](http://en.wikipedia.org/wiki/Windows_Forms)项目，允许我在未选中的情况下发布。

为什么不允许我取消选中签名选项？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-23T13:54:05.533

您不需要签署 EXE 文件，但需要签署 DLL 文件以进行部署。您的 Office 加载项采用 DLL 文件的形式，因此必须对其进行签名。您的 Windows 窗体项目链接到一个 EXE 文件，因此不需要签名。

请参阅相关的 MSDN 页面，[*ClickOnce Manifest Signing 和 Strong-Name Assembly Signing Using Visual Studio Project Designer's Signing Page 的**Signing Assemblies*](http://msdn.microsoft.com/en-us/library/aa730868(VS.80).aspx#rsvssign_topic3)[小节](http://msdn.microsoft.com/en-us/library/aa730868(VS.80).aspx#rsvssign_topic3)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-29T04:12:39.760

虽然您不再需要使用 Windows 窗体、[WPF](http://en.wikipedia.org/wiki/Windows_Presentation_Foundation)和控制台应用程序对清单进行签名，但[VSTO](http://en.wikipedia.org/wiki/Visual_Studio_Tools_for_Office)解决方案仍然需要在使用 ClickOnce 部署时对清单进行签名。

大多数 VSTO 场景都在企业中，其中最佳实践需要对应用程序进行签名。此外，由于 VSTO 解决方案始终完全信任，因此将签名设为可选会带来更高的风险。这与签署 DLL 文件完全不同；您不需要使用 ClickOnce 部署的 VSTO 应用程序对程序集进行签名，您必须对清单进行签名；他们在安装时处理文件的散列和验证。

# visual-studio - Visual Studio 中上一个和下一个调用堆栈帧的热键

> ID：229385
> 
> 赞同：19
> 
> 时间：2008-10-23T11:28:33.407
> 
> 标签：visual-studio, keyboard-shortcuts

Visual Studio 提供了许多导航热键： `F8`用于当前面板中的下一项（搜索结果、错误...）、 `Control`+ `K`、`N`用于书签、 `Alt`+`-`用于返回等等。

我找不到一个热键，我什至找不到它的菜单命令，所以我自己无法创建热键。

我不知道是否存在：上一个和下一个调用堆栈框架。

我在编程时尽量不用鼠标，但是当我需要回栈时，我必须用它来双击上一帧。

任何人？做它的宏怎么样？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-07-31T10:17:23.653

我写了2个宏来获得它：`PreviousStackFrame`并`NextStackFrame`分配了快捷方式

```
Function StackFrameIndex(ByRef aFrames As EnvDTE.StackFrames, ByRef aFrame As EnvDTE.StackFrame) As Long
    For StackFrameIndex = 1 To aFrames.Count
        If aFrames.Item(StackFrameIndex) Is aFrame Then Exit Function
    Next
    StackFrameIndex = -1
End Function

Sub NavigateStack(ByVal aShift As Long)
    If DTE.Debugger.CurrentProgram Is Nothing Then
        DTE.StatusBar.Text = "No program is currently being debugged."
        Exit Sub
    End If

    Dim ind As Long = StackFrameIndex(DTE.Debugger.CurrentThread.StackFrames, DTE.Debugger.CurrentStackFrame)
    If ind = -1 Then
        DTE.StatusBar.Text = "Stack navigation failed"
        Exit Sub
    End If

    ind = ind + aShift
    If ind <= 0 Or ind > DTE.Debugger.CurrentThread.StackFrames.Count Then
        DTE.StatusBar.Text = "Stack frame index is out of range"
        Exit Sub
    End If

    DTE.Debugger.CurrentStackFrame = DTE.Debugger.CurrentThread.StackFrames.Item(ind)
    DTE.StatusBar.Text = "Stack frame index: " & ind & " of " & DTE.Debugger.CurrentThread.StackFrames.Count
End Sub

Sub PreviousStackFrame()
    NavigateStack(1)
End Sub

Sub NextStackFrame()
    NavigateStack(-1)
End Sub 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-11-03T16:26:40.737

我已经用[AutoHotkey](http://www.ahkscript.org)解决了这个问题。我几个月前做的。假设您想使用 Control+1 和 Control+2 并且 Control+Alt+C 必然会显示调用堆栈窗口：

```
^1::SendInput !^c{down}{enter}
^2::SendInput !^c{up}{enter} 
```

它似乎工作得很好。如果您还没有使用 AutoHotkey 向 Visual Studio 展示谁是老大，请试一试。你的问题表明你会从中受益匪浅。这是一个改变游戏规则的人。祝你好运。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-23T17:34:00.113

我认为没有明确的下一帧/前一帧键绑定，但这就是我所做的。

CTRL-ALT-C 已经绑定到“Debug.CallStack” 这将使您集中在调用堆栈工具窗口中

一旦聚焦在 Callstack 窗口中...向上和向下箭头将移动您通过调用堆栈帧

然后我绑定了

CTRL-C、CTRL-S 到“DebuggerContextMenus.CallStackWindow.SwitchToFrame”和 CTRL-C、CTRL-C 到“DebuggerContextMenus.CallStackWindow.SwitchToCode”

两者都会带您回到特定帧的代码窗口。

希望有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-07-05T04:58:09.917

非常感谢@Oleg Svechkarenko 的回答，这给了我制定这个解决方案的起点。由于现代版本的 Visual Studio 不再有官方宏支持，这应该适合那些使用[Visual Commander](https://marketplace.visualstudio.com/items?itemName=SergeyVlasov.VisualCommander "视觉指挥官")插件的人，但可能很容易适应任何其他宏扩展。

这是命令的代码，我创建了一个用于向上导航调用堆栈，另一个用于使用相同的代码向下导航，除了传递给的参数`MoveStackIndex()`，然后将键盘快捷键绑定到它们：

```
using EnvDTE;
using EnvDTE80;
using System;

public class C : VisualCommanderExt.ICommand
{
    enum MoveDirection
    {
        Up,
        Down,
    }

    private bool IsValidFrame(StackFrame frame)
    {
        string language = frame.Language;

        bool result = (language == "C#"  || 
                       language == "C++" || 
                       language == "VB"  || 
                       language == "Python");

        return result;
    }

    private void MoveStackIndex(EnvDTE80.DTE2 DTE, MoveDirection direction)
    {
        StackFrame currentFrame = DTE.Debugger.CurrentStackFrame;

        bool foundTarget = false;
        bool pastCurrent = false;

        StackFrame lastValid = null;
        foreach (StackFrame frame in DTE.Debugger.CurrentThread.StackFrames)
        {
            bool isCurrent = frame == currentFrame;

            if (direction == MoveDirection.Down)
            {
                if (isCurrent)
                {
                    if (lastValid == null)
                    {
                        // No valid frames below this one
                        break;
                    }
                    else
                    {
                        DTE.Debugger.CurrentStackFrame = lastValid;
                        foundTarget = true;
                        break;                      
                    }
                }
                else
                {
                    if (IsValidFrame(frame))
                    {
                        lastValid = frame;
                    }
                }
            }

            if (direction == MoveDirection.Up && pastCurrent)
            {
                if (IsValidFrame(frame))
                {
                    DTE.Debugger.CurrentStackFrame = frame;
                    foundTarget = true;
                    break;
                }               
            }

            if (isCurrent)
            {
                pastCurrent = true;
            }
        }

        if (!foundTarget)
        {
            DTE.StatusBar.Text = "Failed to find valid stack frame in that direction.";
        }
    }

    public void Run(EnvDTE80.DTE2 DTE, Microsoft.VisualStudio.Shell.Package package) 
    {
        if (DTE.Debugger.CurrentProgram == null)
        {
            DTE.StatusBar.Text = "Debug session not active.";
        }
        else
        {
            // NOTE: Change param 2 to MoveDirection.Up for the up command
            MoveStackIndex(DTE, MoveDirection.Down);
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-23T11:32:38.907

查看**Tools->Options->Environment->Keyboard**。输入“stack”或“frame”，将出现相关菜单。似乎没有下一个和上一个调用堆栈框架。

# database-design - 在没有存储过程或触发器的情况下工作

> ID：229388
> 
> 赞同：4
> 
> 时间：2008-10-23T11:29:38.413
> 
> 标签：database-design, stored-procedures, triggers, normalization, platform-agnostic

在过去的 18 个月里，我们一直在研究复杂的数据库和客户端界面。我们会定期向此应用程序添加新功能，现在每天都有数十名用户在我们的所有办公室（包括站点和海外）使用。这只是为了告诉您它是一个带有 REAL 数据库的 REAL 应用程序。

到现在为止，我们仍然不用写任何存储过程，除了临时解决客户端版本和更新数据库模型之间的小问题（旧客户端版本不会正确更新新创建的字段，直到大家安装最新的版本）。

同样，我们仍然不需要任何触发器。事实上，唯一的 SP 和触发器是系统的，或者是为了复制目的而添加的。

当开发人员认为数据库优化必须反对数据库规范化时，我有一种奇怪的感觉，即 SP 和触发器主要用于补偿数据库设计默认值和/或试图绕过数据库设计规则。

问题是这些工具非常耗时（无论是开发还是维护）。然后每个开发人员都应该非常小心地使用它们，记住它们是在数据库中维护的最“昂贵”的项目。

我们是否可以认为在数据库中没有或只有很少的存储过程/触发器是其规范化水平和/或代码维护成本的一个很好的指标？

编辑：

你们中的一些人为使用触发器和 SP 提供了公平的论据。但我一直认为，***大多数时候***这些工具的使用方式不当或过度。设置了多少触发器来在表字段之间进行一些花哨的更新，或者重新计算总计或其他聚合数据？有多少 SP 用于构建用于报告问题的临时表？这是开发人员使用这些工具的许多情况中的两种，我认为这通常说明数据库设计/规范化缺陷。

其他一些人承认应该严格控制 SP 和触发器的使用。我也觉得很有必要。

我必须承认，我试图找到一些支持的论点，所有这些在我们其他数据库上工作的 SQL 极客都看不起我们，告诉他们的朋友“你知道吗？他们甚至不使用 SP 和触发器！哈哈！”

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-23T11:36:26.637

> 我们是否可以认为在数据库中没有或只有很少的存储过程/触发器是其规范化水平和/或代码维护成本的一个很好的指标？

你不能。

规范化和存储过程是完全分开的。

我对 SP 的看法是数据库和使用它的人之间的抽象层。

强迫人们使用 SP 而不是直接的 CRUD 操作将更容易改变表的设计而不会破坏它们。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-23T11:42:39.400

存储过程和触发器是*工具*——在数据库管理系统中使用的非常具体的工具。

触发器有多种用途，从大大简化*历史*表的维护（其中每一行代表主表的过去时间段）到将 ETL 请求排队到数据仓库（取决于特定的 RDBMS）

存储过程也有自己的位置，无论它们是从应用程序调用还是从 SQL 命令行工具调用。

包含存储过程或触发器实际上与规范化或“数据库设计默认值”无关。它们在应用程序中的使用通常与应用程序的其他要求直接相关，即可扩展性、可靠性、复制或其他*可以通过使用这些工具最有效地满足的*要求。

如果您不需要它们，请不要使用它们。但是，不要假设触发器或存储过程的存在表明设计不佳。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-23T11:57:06.017

没有什么比在代码中遇到一大堆有 bug 的内联 SQL 更让我讨厌的了。至少使用存储过程，您可以对其进行语法检查，甚至可以执行它以查看问题所在。更不用说当执行计划被保存时，它比仅仅在数据库中触发查询要快。我一直认为数据库代码属于数据库，但这只是我的看法。

触发器有其用途。它们并不总是最好的，但肯定是有原因的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-23T12:28:00.807

至于存储过程，我们不要忘记安全问题。允许应用程序运行内联 SQL 意味着您的用户帐户需要直接读取、插入、更新和删除所有表的访问权限。如果有任何违规行为，您的数据库就会暴露出来。

触发器有它们的位置。尤其是在有很多数据库开发人员可能知道也可能不知道（例如）我们保留预算信息更改历史的 SOX 要求的环境中。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-23T11:40:11.433

不可以。存储过程和触发器以许多不同的方式使用。这取决于环境、开发人员等。例如，存储过程通常用作安全机制。

我认为唯一适合使用触发器的地方是重构数据库时。所以也许你在这一点上有所作为。但是其他人可能会以其他方式使用它们。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-23T11:50:58.043

如何从数据库中取回数据？你会构建 SQL 字符串并执行它们吗？如果是这样，您如何验证条目不会破坏数据库？存储过程有助于大大降低这种风险，因为服务器将文本作为文本而不是命令进行处理。

存储过程通常比对数据库执行 SQL 字符串快得多，这也意味着您不必为不同的信息组编写不同的选择，因为它都可以由存储过程完成。从程序中抽象出数据库的能力也是一个被提出过几次的好处。

最后，我真的只使用触发器进行数据库审计（在 SQL2005 之前没有内置的审计功能），它将用每次更改的 prev 和新值更新表。

规范化和优化与存储过程或触发器无关，规范化和优化可能会影响您需要多少抽象数据库，但在我看来，每次更改数据库时都必须重构代码比使用存储过程更糟糕

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-29T13:35:12.487

“设置了多少触发器来在表字段之间进行一些花哨的更新，或者重新计算总计或其他聚合数据？”

使用触发器根据业务规则进行复杂的更新并不是一个缺陷。这是首选方法。如果要维护数据完整性，则应在数据库级别强制执行所有业务规则。除了用户界面之外，还有其他方法可以影响数据库中的数据，无论使用哪种方法，都应该应用业务规则。这样，导入的数据必须遵守规则，新功能必须遵守规则（而不是必须记住有规则并找到您为执行规则而构建的功能），人们从查询工具批量更新数据（认为将所有价格提高 10%）将必须遵守规则等。

如果您没有单独的报告数据库，通常会重新计算总计以提高报告速度。当财务部门运行需要数小时才能运行的季度报告时，您是否想放慢或锁定整个数据库，因为他们必须根据数百万条记录计算总计？还是您宁愿对数据的每次更改都多花一秒钟的时间？这通常是一种仅在数据库变大并且在它变得足够大以证明拥有单独的报告数据库的成本之前才使用的方法。因此，是的，这是一种临时权宜之计，但是当您从原始设计转移到新设计时，这对于保持业务运行是非常必要的（构建 OLAP 需要相当长的时间和一套不同的技能数据库）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-10T03:23:45.657

我们有一个我正在工作的程序，我认为这是一个很好的触发器案例，因为现在有大约 8 个不同的版本（一个 API 和许多版本的前端和后端）。如果我想改变它处理某些东西的方式，如果它在触发器中，而不是必须在 8 个以上不同的代码库中做出完全相同的改变（意大利面条编码的水平不同），这会容易得多和命名不佳的变量）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-29T14:07:28.477

这是一个绝对需要 SP 的示例：用户界面只是整个应用程序的一小部分。并且当整个过程独立于用户发生时。例如，我从事一个项目，该项目涉及来自许多不同来源的大量数据处理。所以我们收到这些文件，然后我们只运行一个脚本外壳，它会简单地启动一个 SP 来导入文件中的所有数据，检查它们，操作它们等等......你猜怎么着？用户也可以从用户界面使用相同的 SP，而无需再次重写整个数据处理查询！

当然，如果那些处理查询只是简单的 SELECT，那么你可以争论 SP 的必要性，但是当你需要 UPDATE 几十张表、计算字段、清除数据、清理数据时，SP 是有福的。这并不意味着我们的数据库缺乏规范化，但是当您每天处理数十亿数据时，并非一切都可以简单。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-09-14T20:29:25.553

如果您有七个不同的应用程序都在与用户数据库通信，那么拥有一个名为“createUser”的存储过程而不是七个不同的应用程序自己构建该 INSERT 语句不是更有意义吗？

现在，一个新应用程序必须将用户添加到此数据库，但它有一个新要求，需要添加一个新字段，即默认值是从存储在完全不同的第 3 方应用程序数据库中的值填充的。

现在，你去改变这七个应用程序，加上新的一个，与第 3 方应用程序对话以获得价值，同时构建 INSERT 语句。

或者，您可以修改用户数据库的 createUser proc 以从 3rd 方数据库中查找数据作为默认值，因此您的其他程序都不需要更改和重新部署，因为它们并不真正关心该值...然而。

或者，您可以在用户表更新时向用户数据库添加触发器，以从第 3 方数据库中获取该值。

存储过程还具有编译的好处，因此比常规语句更快。

存储过程还可以将单个复杂的 sql 语句分解为几个更简单的语句，以提高查询运行的速度。

当数据需求发生变化时，修改存储过程比更新 1000 次安装的应用程序要简单得多。

我的 $.02

附言。多年来我没有在应用程序中编写过一行 sql。这一切都在存储过程中。无论是简单的选择、插入、更新、复杂的报告，还是在应用程序中实际上是单个对象但存储在数据库中的 7 个不同表中的更新。

# visual-c++ - 如何尽可能快地将大量字符串加载到 MFC 组合框控件中？

> ID：229395
> 
> 赞同：5
> 
> 时间：2008-10-23T11:31:33.963
> 
> 标签：visual-c++, mfc, combobox, arrays

我有一个包含 1000 个字符串的数组要加载到组合框中。将字符串数组加载到组合框中的最快方法是什么？

除了遍历字符串列表，一次将每个字符串放入组合框中，还有其他方法吗？

以及如何将加载后的组合框数据复制到其他 10 个其他组合框？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-23T12:50:58.890

如果您在 10 个组合框中重复了 1,000 个字符串，您可能需要考虑使用所有者绘制的组合框，它根据数组中的索引动态绘制字符串，而不是将它们存储在组合框中。速度更快，内存效率更高。查看在线帮助中的**DrawItem**方法和**DRAWITEMSTRUCT结构。**基本上，您会使用**InitStorage**和**InsertString**（如 NuSonic 所述）在您的组合框中创建 1000 个空白项，并覆盖**DrawItem**以根据索引提取和绘制所需的字符串，因为它需要被绘制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-23T12:04:13.727

我不知道以原子方式加载多个字符串的任何方法，但是您可以采取一些措施来提高该过程的效率：

*   在添加项目以预分配内存之前调用 CComboBox::InitStorage
*   使用 InsertString 而不是 AddString 以防止在每次添加时触发排序（假设启用了 CBS_SORT 样式）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-24T00:09:12.840

可能比具有 DrawItem 的 CComboBox 更快的是[所有者数据 CListCtrl](http://msdn.microsoft.com/en-us/library/ye4z8x58(VS.80).aspx)。这也有助于您将项目的子集复制到其他列表中，因为可以使用公共数据源。

我建议这样做是因为包含 1000 个项目的 CComboBox 不会很有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-23T12:05:49.540

我会考虑使用选择列表而不是组合框来提高性能。

在 UI 列表中插入许多项目时提高性能的一般经验法则是在插入之前调用并在之后将其设置回 true。

这是正确的语法

```
#define NB_ITEM 1000
#define ITEM_LENGTH 10

void CMFCComboDlg::InitMyCombo()
{
    CString _strData;
    m_cbMyCombo.SetRedraw( FALSE );

    m_cbMyCombo.Clear();

    m_cbMyCombo.InitStorage(NB_ITEM, ITEM_LENGTH); 

    for( int i = 0; i < NB_ITEM; i++ )
    {
        _strData.Format( L"Test %ld", i );
        m_cbMyCombo.InsertString( i, _strData );
    }

    m_cbMyCombo.SetCurSel(0);

    m_cbMyCombo.SetRedraw( TRUE );
} 
```

编辑：改进解决方案以包含 smacl 建议

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-10T20:35:57.143

我遇到了这个问题并以两种方式解决了它，具体取决于 # 个项目。设置为不绘制和初始化存储对我来说没有任何区别。让所有者绘制一个也是可行的，但我有大量的组合框。假设每个组合框都有一个固定列表，不改变内容，列表设置一次。

非常大 # 项目：使用 SetWindowText 使组合框变得简单/禁用以设置初始字符串，并且它旁边的一个小按钮打开一个对话框，让您在数据的报告模式下从列表控件中选择项目'已经在组合框中（可以在对话框中完成任何操作）。

中等#项目：制作了一个自定义派生组合框类，它覆盖了 AddString、SelectString 和处理 OnDropDown。当您添加项目时，它会将它们放入一个临时向量中，然后在 SelectString 上（也可以执行 SetCurSel 覆盖），它会添加它找到并选择的一个项目。下拉时，它会重置组合框并添加所有项目并选择当前选定的项目。删除组合框的速度略有放缓，但在项目数量较少时并不明显。

它使我的对话框加载速度更快，并且在没有所有者绘制的情况下仍然可以正常工作。

# visual-studio - 在 Sourcesafe 中合并文件

> ID：229403
> 
> 赞同：1
> 
> 时间：2008-10-23T11:34:57.950
> 
> 标签：visual-studio, version-control, visual-sourcesafe

全部，

我目前有两个在 SourceSafe 下的项目，由于多种原因，我无法迁移到我们的 SVN 服务器。

但是，我目前正在尝试将一个项目的修复合并到另一个项目中。

我知道 Sourcesafe 在这方面不是最好的，但我刚刚经历的过程特别乏味

1.  比较识别我需要合并的更改的文件。
2.  将相关更改复制并粘贴到所需的项目中
3.  测试
4.  犯罪

这似乎并不算太​​糟糕，但是随着多次更改和需要审查的多个文件，这正在成为一场噩梦。

有没有人有任何其他方法来执行这个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-23T11:55:19.920

检查不同的版本并使用 3rd-party 工具合并它们可能是值得的。看看 kdiff3 ( [http://kdiff3.sourceforge.net/)——](http://kdiff3.sourceforge.net)它在 linux 或 Windows 上运行，并且可以非常智能地合并多达 3 个不同的版本。这允许您将两个开发人员的更改与一个通用的基本版本进行比较。

另一个有用的工具是 kompare，它在突出两个文件之间非常具体的差异方面做得非常出色。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T11:42:38.557

老实说，在 VSS 中合并非常糟糕，我个人会将您项目的两个版本都签入到 SVN 中，并在两个目录树之间进行比较以找出您的差异。

这至少会使第 1 步变得非常容易。如果您不允许在您的 SVN 服务器上执行此操作，请暂时使用 TortoiseSVN 在您的磁盘上创建一个本地存储库以完成该任务。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-03T12:40:39.483

winmerge 可以与 sourcesafe 结合使用。支持文件夹比较。

# excel - 使用vb6从excel中提取忽略的列

> ID：229404
> 
> 赞同：0
> 
> 时间：2008-10-23T11:35:07.200
> 
> 标签：excel, vb6, oledb, adodb, msdasql

我正在尝试使用 vb6 从 excel (2003) 电子表格中提取值表，其结果需要存储在 (adodb) 记录集中。该表如下所示：

```
    名称 Option.1 Option.2 Option.3 Option.4 Option.5 Option.6
    -------------------------------------------------- ---------------
    姓名1 2 3 4
    姓名2 2 3 4
    姓名3 2 3 4
    姓名4 2 3 4
    姓名5 2 3 4
    姓名6 2 3 4
    姓名7 2 3 4
    姓名8 2 3 4
    姓名9 2 3 4 5 6 7  

```

在连接并执行查询“ `SELECT * FROM [Sheet1$]`”甚至是特定于列的“ `SELECT [Option#6] FROM [Sheet1$]`”（参见脚注 1）并循环遍历结果时，我得到`Null`的是 row 的值`Name9`-- `Option.4`>`Option.6`而不是正确的值 5、6 和 7 .似乎与电子表格的连接正在使用“最佳猜测”来确定有效的表限制是什么，并且只考虑了一组行数。

要连接到电子表格，我尝试了两个连接提供程序`Microsoft.Jet.OLEDB.4.0`并`MSDASQL`遇到了同样的问题。

以下是我使用的连接设置：

```
Set cn = New ADODB.Connection
With cn
    .Provider = "Microsoft.Jet.OLEDB.4.0"
    .ConnectionString = "Data Source=" & filePath & ";Extended Properties=Excel 8.0;"
    - - - - OR - - - - 
    .Provider = "MSDASQL"
    .ConnectionString = "Driver={Microsoft Excel Driver (*.xls)};" & _
                        "DBQ=" & filePath & ";MaxScanRows=0;"
    .CursorLocation = adUseClient
    .Open
End With  
Set rsSelects = New ADODB.Recordset
Set rsSelects = cn.Execute("SELECT [Option#5] FROM " & "[" & strTbl & "]") 
```

仅当行数超过 8 行（不包括列名）时才会出现此问题，并且我已`MaxScanRow=0`为`MSDASQL`连接设置，但这产生了相同的结果。

我包括的值得注意的项目参考是：

*   MS ActiveX 数据对象 2.8 库
*   MS ActiveX 数据对象 Recordset 2.8 库
*   MS Excel 11.0 对象库
*   MS 数据绑定集合 VB 6.0 (SP4)

在这件事上的任何帮助将不胜感激！

(1) 出于某种原因，当列名中包含小数点时，它被解释为#。

* * *

谢谢大家！`Schema.ini`在尝试从[KB155512](http://support.microsoft.com/kb/155512) [onedaywhen](https://stackoverflow.com/questions/229404/ignored-columns-using-vb6-to-extract-from-excel#229721)的“以编程方式”设置“程序化”的过程中，出色[的帖子将](http://www.dailydoseofexcel.com/archives/2004/06/03/external-data-mixed-data-types/)我指向了解决方案：

```
.Provider = "Microsoft.Jet.OLEDB.4.0"
.ConnectionString = "Data Source=" & filePath & ";Extended Properties=""Excel 8.0;HDR=Yes;IMEX=1"";" 
```

我会鼓励任何有类似问题的人阅读这篇文章和评论，因为从一个人到另一个人的解决方案略有不同。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-23T12:00:54.810

默认情况下，Excel ISAM 驱动程序会查看您的前几行并猜测它们的数据类型。如果有（表中后面的）数据不符合初始假设，它会皱眉并将其变为 NULL。

您的`MaxScanRows=0`设置是解决此问题的关键。听起来它会做正确的事情（扫描整个表以查找要使用的数据类型），但实际上并没有。

有关更多详细信息，请参阅[onedaywhen](https://stackoverflow.com/questions/229404/ignored-columns-using-vb6-to-extract-from-excel#229721)的答案，我关于[KB282263](http://support.microsoft.com/kb/282263/)的第一个信息不是正确的建议。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T13:31:15.187

你是对的：它是根据行数猜测数据类型。您可以更改本地计算机注册表项以影响所选数据类型。有关更多详细信息，请参阅[此答案](https://stackoverflow.com/a/10102515/15354)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T13:05:28.673

我能给你的最好的建议是停止在 VB6 环境中这样做。打开 Excel，按 ALT+F11 并加载 VBA IDE。把你的代码放在那里。在此环境中，您可以访问完整的 Excel 对象模型。

我见过很多人尝试以多种不同方式与 Excel 进行交互，但他们都遇到了问题。我发现使用 VBA 宏或加载项方法是获取数据的最佳方法。这就是微软如何让 Excel 和 Project 与 TFS 集成。

有时您需要重新考虑该过程以使这种方法适合。例如，您可能需要让正在使用电子表格的用户运行一个宏，该宏会将数据从电子表格中推出，而不是您运行一个进程从电子表格中提取数据，但通常这是非常可行的。

# asp.net - jQuery - Ajax - 当用户更改 DropDownList 中的选定索引时，如何将 ascx 加载到 DIV 中

> ID：229422
> 
> 赞同：3
> 
> 时间：2008-10-23T11:40:43.977
> 
> 标签：asp.net, jquery, ajax, custom-server-controls

在 A.ascx 中，我有一个 DropDownList 和一个 DIV。DropDownList 是动态填充的。

当用户更改 DropDownList 中的选定索引时，如何将 B.ascx 加载到 DIV 中。这应该通过使用 jQuery 和 Ajax 在客户端完成，无需回发。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2008-10-24T08:56:30.547

```
 function selectedindexchange() {
  $.ajax({
    type: "POST",
    url: "CONTROLNAME.ascx",
    data: "{}",
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function(msg) {
      $('#ContentDIV').html(msg.d);
    }
  });
}); 
```

# biztalk - 协议转换/规范化：Biztalk，替代品？

> ID：229423
> 
> 赞同：3
> 
> 时间：2008-10-23T11:40:51.353
> 
> 标签：biztalk, messaging, scada

我们需要从安全系统、火警、摄像系统等系统中获取数十种不同的协议，并将它们集成到一个通用协议中。

我希望这是一个消息服务器，许多系统都可以订阅和/或通过它进行通信。

*   轮询和非轮询“驱动程序”（协议转换器）
*   处理 RS232 / RS485 / tcp
*   以 Java 或 C# 等托管语言编写的可编程“驱动程序”
*   规则引擎能力

biztalk 适合这个吗？

有开源替代品吗？

是否有 Java / Java EE 方法可以做到这一点？

该系统一方面是 SCADA 系统，另一方面是一种中间件/消息服务器。

任何关于最佳方式的想法将不胜感激。我知道在驱动程序方面会涉及大量的编程，但是尽管我很想从头开始构建整个系统是不合适的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-23T14:30:59.513

我会避免 BizTalk 用于 SCADA 和 RS232/RS485，因为这些通常需要实时（或至少低延迟）解决方案。BizTalk 针对高吞吐量进行了优化，但默认情况下具有高延迟的缺点。

您可以调整 BizTalk 以获得低延迟，但此时您会发现您绕过了 BizTalk 内置的几乎所有内容，它可能会阻碍而不是帮助您。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-23T13:53:09.747

如果您不介意在 Java 平台上工作，那么在一个名为[Apache Camel](http://activemq.apache.org/camel/)的开源项目中，有一个轻量级协议切换器和[企业集成模式](http://activemq.apache.org/camel/enterprise-integration-patterns.html)的实现。

Camel 已经可以说大多数[常见的协议和技术](http://activemq.apache.org/camel/components.html)，如[文件](http://activemq.apache.org/camel/file.html)、[电子邮件](http://activemq.apache.org/camel/mail.html)、[JMS](http://activemq.apache.org/camel/jms.html)、[XMPP](http://activemq.apache.org/camel/xmpp.html)等，因此这些东西不需要实际编码。

[要添加新的自定义协议，最简单的方法是构建在MINA 组件](http://activemq.apache.org/camel/mina.html)之上，该组件负责所有网络、套接字处理、线程等（例如 NIO 与 BIO 等）。

然后你只需扩展它以添加你自己的协议编解码器（如何在套接字上编组/解组消息，可能使用框架等）。

[HL7 组件](http://activemq.apache.org/camel/hl7.html)就是这样做的一个例子。更多[关于在此处编写 MINA 编解码器的详细信息](http://mina.apache.org/tutorial-on-protocolcodecfilter.html)。

然后，一旦您有了骆驼组件（我们称之为 foo），您就可以使用简单的 URI 从任何协议桥接到任何其他协议，以实现任何[企业集成模式](http://activemq.apache.org/camel/enterprise-integration-patterns.html)，例如[基于内容的路由器](http://activemq.apache.org/camel/content-based-router.html)、[收件人列表](http://activemq.apache.org/camel/recipient-list.html)、[路由](http://activemq.apache.org/camel/routing-slip.html)单等

例如在 Java 代码中

```
// route all messages from foo
// to a single queue on JMS
from("foo://somehost:1234").
  to("jms:MyQueue");

// route all messages from foo component
// to a queue using a header
from("foo://somehost:1234").
  recipientList().
    simple("activemq:MyPrefix.${headers.cheese}"); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-06-16T04:31:07.890

www.livedata.com

它有点贵，但它是一个基于 python 的引擎，可以采用一个协议并吐出另一个协议，它已经为多种 scada 协议设置，例如 ICCP、modbus、OPC 和 DNP。然后你可以在下游说任何你想要的东西。

*   约翰

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-08-13T21:11:03.987

我建议[OpenSCADA](http://www.openscada.org)。该网站目前有点混乱，但该软件正在积极使用和积极开发中。一个明确的目标是为 SCADA 用例创建一个通用的、独立于技术的接口（尽管目前方向或多或少面向 java [但我们也尝试使用 ikvm 创建一个 .NET 版本]）。

因此，您可以使用 OpenSCADA 与所有“硬件”设备进行通信，然后创建一个连接到其余中间件的桥，或者创建一个 OpenSCADA 桥作为中间件中的插件。例如，我们已经拥有连接到通过串行服务器连接到 LAN 的读卡器的驱动程序。

# .net - .NET DataTable 跳过 Load(DataReader) 上的行

> ID：229425
> 
> 赞同：22
> 
> 时间：2008-10-23T11:41:40.010
> 
> 标签：.net, datatable, datareader, localreport

我正在尝试使用以下内容填充 DataTable 以构建 LocalReport：

```
MySqlCommand cmd = new MySqlCommand();
cmd.Connection = new MySqlConnection(Properties.Settings.Default.dbConnectionString);
cmd.CommandType = CommandType.Text;
cmd.CommandText = "SELECT ... LEFT JOIN ... WHERE ..."; /* query snipped */

// prepare data
dataTable.Clear();
cn.Open();
// fill datatable
dt.Load(cmd.ExecuteReader());
// fill report
rds = new ReportDataSource("InvoicesDataSet_InvoiceTable",dt);
reportViewerLocal.LocalReport.DataSources.Clear();
reportViewerLocal.LocalReport.DataSources.Add(rds); 
```

有一次，我注意到报告不完整，并且缺少一条记录。我更改了一些条件，以便查询将准确返回两行并且...**惊喜**：报告仅显示一行而不是两行。我试图调试它以找出问题所在，但我陷入了困境

```
 dt.Load(cmd.ExecuteReader()); 
```

当我注意到`DataReader`包含两条记录但`DataTable`仅包含一条时。偶然地，我`ORDER BY`在查询中添加了一个子句，并注意到这次报告正确显示。

显然，DataReader 包含两行，但 DataTable 仅在 SQL 查询字符串包含时读取这两行`ORDER BY`（否则它只读取最后一行）。谁能解释为什么会发生这种情况以及如何解决？

**编辑：** 当我第一次发布问题时，我说它跳过了第一行；后来我意识到它实际上只读取了最后一行，并且我已经相应地编辑了文本（当时所有记录都分为两行，当它实际上只显示最后一行时，它似乎跳过了第一行）。这可能是由于它没有唯一标识符来区分 MySQL 返回的行，因此添加`ORDER BY`语句会导致它为每行创建唯一标识符。
这只是一个理论，我没有任何证据支持它，但我所有的测试似乎都得出了相同的结果。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-02-09T11:43:07.600

After fiddling around quite a bit I found that the `DataTable.Load` method expects a primary key column in the underlying data. If you read the documentation carefully, this becomes obvious, although it is not stated very explicitly.

If you have a column named "id" it seems to use that (which fixed it for me). Otherwise, it just seems to use the first column, whether it is unique or not, and overwrites rows with the same value in that column as they are being read. If you don't have a column named "id" and your first column isn't unique, I'd suggest trying to explicitly set the primary key column(s) of the datatable before loading the datareader.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-01-09T17:18:06.357

Just in case anyone is having a similar problem as canceriens, I was using If `DataReader.Read` ... instead of If `DataReader.HasRows` to check existence before calling `dt.load(DataReader)` Doh!

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-17T07:59:02.763

I had same issue. I took hint from your blog and put up the ORDER BY clause in the query so that they could form together the unique key for all the records returned by query. It solved the problem. Kinda weird.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-02-28T20:51:16.927

Had the same issue. It is because the primary key on all the rows is the same. It's probably what's being used to key the results, and therefore it's just overwriting the same row over and over again.

Datatables.Load points to the fill method to understand how it works. This page states that it is primary key aware. Since primary keys can only occur once and are used as the keys for the row ...

"The Fill operation then adds the rows to destination DataTable objects in the DataSet, creating the DataTable objects if they do not already exist. When creating DataTable objects, the Fill operation normally creates only column name metadata. However, if the MissingSchemaAction property is set to AddWithKey, appropriate primary keys and constraints are also created." (http://msdn.microsoft.com/en-us/library/zxkb3c3d.aspx)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-12-09T13:23:47.503

Don't use

```
dr.Read() 
```

Because It moves the pointer to the next row. Remove this line hope it will work.

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-04-15T12:16:47.710

Came across this problem today.

Nothing in this thread fixed it unfortunately, but then I wrapped my SQL query in another SELECT statement and it work!

Eg:

```
SELECT * FROM (
    SELECT ..... < YOUR NORMAL SQL STATEMENT HERE />
) allrecords 
```

Strange....

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-23T11:52:16.620

你能抓住从 SQL 探查器运行的实际查询并尝试运行它吗？这可能不是你所期望的。

使用 SqlDataAdapter.Fill(dataTable) 时是否得到相同的结果？

Have you tried different command behaviors on the reader? [MSDN Docs](http://msdn.microsoft.com/en-us/library/y6wy5a0f.aspx)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-04-28T08:52:57.540

I know this is an old question, but for me the think that worked whilst querying an access database and noticing it was missing 1 row from query, was to change the following:-

```
 if(dataset.read())  - Misses a row.

    if(dataset.hasrows) - Missing row appears. 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-10-22T17:46:08.457

For anyone else that comes across this thread as I have, the answer regarding the DataTable being populated by a unique ID from MySql is correct.

However, if a table contains multiple unique IDs but only a single ID is returned from a MySql command (instead of receiving all Columns by using '*') then that DataTable will only organize by the single ID that was given and act as if a 'GROUP BY' was used in your query.

So in short, the DataReader will pull all records while the DataTable.Load() will only see the unique ID retrieved and use that to populate the DataTable thus skipping rows of information

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-27T21:15:32.997

Not sure why you're missing the row in the datatable, is it possible you need to close the reader? In any case, here is how I normally load reports and it works every time...

```
 Dim deals As New DealsProvider()
        Dim adapter As New ReportingDataTableAdapters.ReportDealsAdapter
        Dim report As ReportingData.ReportDealsDataTable = deals.GetActiveDealsReport()
        rptReports.LocalReport.DataSources.Add(New ReportDataSource("ActiveDeals_Data", report)) 
```

Curious to see if it still happens.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-28T14:37:31.317

Have you tried calling `dt.AcceptChanges()` after the `dt.Load(cmd.ExecuteReader())` call to see if that helps?

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-08-03T16:50:23.803

In my case neither ORDER BY, nor dt.AcceptChanges() is working. I dont know why is that problem for. I am having 50 records in database but it only shows 49 in the datatable. skipping first row, and if there is only one record in datareader it shows nothing at all.

what a bizzareeee.....

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-03-26T14:54:33.023

I know this is an old question, but I was experiencing the same problem and none of the workarounds mentioned here did help.

In my case, using an alias on the colum that is used as the `PrimaryKey` solved the issue.

So, instead of

```
SELECT a
     , b
FROM table 
```

I used

```
SELECT a as gurgleurp
     , b
FROM table 
```

and it worked.

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-10-09T11:12:59.357

I had the same problem.. do not used dataReader.Read() at all.. it will takes the pointer to the next row. Instead use directly datatable.load(dataReader).

# java - Java移动应用程序的地理位置？

> ID：229432
> 
> 赞同：3
> 
> 时间：2008-10-23T11:43:43.453
> 
> 标签：java, java-me, mobile, gis, mobile-phones

有没有办法使用 J2ME 应用程序以编程方式确定手机的大致地理位置，例如确定当前小区？这个问题尤其适用于不支持 GPS 的设备。

我不是在寻找一组地理坐标，而是让用户能够定义特定位置的软件行为。

任何硬件的解决方案都将受到高度赞赏；然而，解决方案越通用——越好。非常感谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-23T11:52:00.833

如果设备支持[JSR 179](http://jcp.org/en/jsr/detail?id=179)位置 API，您可以使用它。上次我研究这个几乎没有任何设备支持它，但那是几年前的事了。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-30T12:31:33.770

这是我的第一篇文章 stackoverflow。

您可以通过以下方式在许多手机上获取 cellID（手机连接的电话杆的 ID）。**`System.getProperty(String arg)`** 这里我有一个示例，它尝试了几个键来查看是否可以找到 cellID。我已经在很多 SonyEricsson 手机上对此进行了测试，只要它不是像 P1 之类的 Symbian 手机，它就可以正常工作。如果您在网上搜索，您可能会找到更多键来查找摩托罗拉、三星等的 cellID:s。

```
try{
  String[] cellIDTags = {"com.sonyericsson.net.cellid", "phone.cid", "Siemens.CID", "CellID"};
  for(int i = 0; i < cellIDTags.length; i++){
    cellID = System.getProperty(cellIDTags[i]);
    if(cellID != null && cellID != ""){
      location.setCellId(cellID);
      break;
    }
  }
}catch(Exception e){
  cellID = "";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T11:49:11.027

我不相信有用于确定位置的通用 J2ME API。

我确实知道黑莓有一个特定的 API，不仅可以检索粗略的“手机”位置，还可以检索 GPS API。

恐怕目前，GPS 解决方案是由制造商专有的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-23T12:03:44.427

IMO，没有任何应用程序能够自己做到这一点。它将需要卫星或手机外壳的帮助，即手机信号塔，以训练手机当前所在的位置，该位置再次精确到大约 30-50 米。 ![定位电话](https://i.stack.imgur.com/lNcR5.jpg)

此处的计算将由蜂窝塔中的软件或卫星中的软件完成。您的应用程序只会发出请求，然后接收作为响应发送过来的数据。

同样，您将使用的 API 将是手机公司或卫星服务提供的 API。这些几乎从来都不是免费的。我不确定他们是否也将其出售给普通用户。只有像黑莓之类的大公司。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T09:43:24.447

我浏览了许多应用程序下载站点，但没有找到：: 但我相信对此进行一些研究可以帮助您使用 J2ME API 构建自己的应用程序。由于 DAN 给出的代码给出了基站编号。您可以识别该单元格能够对应的最近车站。实际上，一个单元格能够同时捕获至少 6 个站点，因此 deamonkid 解释说，只要您有您所在地区或城市的地理参考地图，就可以使用多点定位来近似位置。该应用程序将计算距离最近的塔的距离和方向，并且地图已经有了该基站的坐标。所以你可以计算空间坐标（估计）suresh。你可以得到100米的精度。这可能需要您可能下载的信号强度测量应用程序。现在，如果您可以基于此生成代码，请分享。我也对此进行了广泛的研究。祝你好运

# axapta - MS Dynamics AX / AXAPTA - 防止重新打印未过帐支票付款通知的代码在哪里？

> ID：229436
> 
> 赞同：1
> 
> 时间：2008-10-23T11:44:41.253
> 
> 标签：axapta, microsoft-dynamics, x++, ax

我们想要重新打印付款通知书，甚至在它发布之前。报告 BankPaymAdviceCheque 应该能够做到这一点，但只打印已经过帐支票的通知。但是，报告的对话框也允许您选择未发布的对话框。

无论我如何在代码中搜索，我都找不到阻止未发布的汇款被重新打印的位 -

帮助将不胜感激？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-23T22:22:32.573

逻辑在 vendTransInvoice 方法中。当针对已打印和过帐的支票运行报告时，vendOutPaymCheque 将为空，因此在 vendTrans 和 vendSettlement 中查找记录的代码块将运行。在打印支票期间运行报告时，vendOutPaymCheque 不为空，因此会运行在 specTrans 中查找记录的代码块。当为已打印但未过帐的支票调用报告时，此代码错误地查找 vendTrans 和 vendSettlement 中的记录，并且由于日记帐尚未过帐而未找到任何数据。

# visual-studio - 如何重构：将一个类分成两个通过接口进行通信

> ID：229438
> 
> 赞同：1
> 
> 时间：2008-10-23T11:45:02.827
> 
> 标签：visual-studio, visual-studio-2008, refactoring, resharper

我刚刚开始我的第一次大规模重构，并且需要将一个（不幸的是大）类分成两个，然后它们只能通过接口进行通信。（我的 Presenter 原来是一个 Controller，需要将 GUI 逻辑从 App 逻辑中分离出来）。在 VisualStudio 2008 和 Resharper 中使用 C#，实现这一目标的最简单方法是什么？

我要尝试的是a）收集新类的成员并“提取新类”b）清理产生的混乱c）“提取接口”d）追踪对类的任何引用并将它们转换为接口引用

但我以前从来没有这样做过，在我开始把所有东西都拆开之前，想知道是否有人知道任何好的技巧或陷阱......谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-23T11:51:20.303

称我为老式，但就个人而言，我仅在用于技术任务（例如重命名等）时使用您描述的自动化功能

对于所有其他重构，例如提取接口等，我更喜欢手动进行。你会发现你可以做更多的重构，而且通常代码会更干净。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-23T11:50:19.230

婴儿步。

第 1 步：使用 Resharper 出色的重构进行小改动。
第 2 步：测试（最好是单元测试）以确保代码仍然有效
第 3 步：提交源代码控制

多次重复这 3 个步骤。

如果您正在进行“必须同时迈出一大步”的重构之一，这可能行不通。在这种情况下，在迈出大步之前尽可能多地进行小的重构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T18:50:25.230

我只有一条重要的建议 - 绝对确保您可以恢复到开始重构之前的状态而不会丢失任何东西。然后潜入并继续前进。您可能最终不得不停下来重新开始，但这没什么好害怕的（只要您听从我的一条建议）。这样做你会学到很多东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-23T13:06:18.250

首先在这里简短回答，我要写一篇关于它的博客文章，谢谢你的想法！

所以，让我们假设我们有这个：

```
class PresenterAndController
  {
    public void Control()
    {
      Present();
    }

    public void Present()
    {
      // present something
    }
  } 
```

首先，我们需要将所有直接成员的用法转换为间接的，即用字段限定它们。为此，请使用提取超类重构将 Presenter 部分提取到超类中：

```
 internal class Presenter
  {
    public void Present()
    {
      // present something
    }
  }

  class PresenterAndController : Presenter
  {
    public void Control()
    {
      Present();
    }
  } 
```

在 PresenterAndController 中创建将委派一个字段并使用 Generate（Alt-Ins）创建委派成员。它们碰巧会隐藏基本方法，因为它们是相同的：

```
 internal class Presenter
  {
    public void Present()
    {
      // present something
    }
  }

  class PresenterAndController : Presenter
  {
    private Presenter myPresenter;

    public void Present() // hides base method
    {
      myPresenter.Present();
    }

    public void Control()
    {
      Present(); // it now references method from this type
    }
  } 
```

从继承列表中删除 Presenter，您就完成了拆分类。现在您可以提取接口，尽可能使用基本类型，并以其他方式整理它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T18:48:27.967

我从未使用过 VisualStudio，但我发现 Eclipse 中的自动重构非常可靠——至少和我做同样的工作一样可靠。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-05-19T14:10:40.447

在你做之前，投资源代码控制：学习 Git。没有 SCM 的重构就像蒙着眼睛开车。

# c# - 如何以最少的锁定访问文件

> ID：229441
> 
> 赞同：2
> 
> 时间：2008-10-23T11:48:42.853
> 
> 标签：c#, file, locking, io

在我的应用程序（c# 3.5）中，有各种进程非常频繁地访问单个 xml 文件（读取和写入）。访问该文件的代码被放置在一个被许多其他应用程序引用的程序集中。例如，Windows 服务可能会实例化 MyFileReaderWriter 类（位于前面提到的程序集中）并使用此类的读/写方法。

我正在寻找以最少锁定量读取和创建/附加文件的最佳/最快方法。缓存文件数据并定期刷新新内容不是一种选择，因为数据很关键。

我忘了提到我目前使用 XDocument（LInq2Xml 基础结构）来读取/写入文件的内容。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-23T12:25:53.930

如果通过写作您只是附加到文档，那么试试这个

[http://msdn.microsoft.com/en-us/library/aa302289.aspx](http://msdn.microsoft.com/en-us/library/aa302289.aspx)

基本上，您的 xml 文档是一个带有开始和结束标记的外壳。标签之间是一个包含引用，它引用另一个文件，这个另一个文件是 xml 文档的主体。对于写入操作，这要快很多倍，因为您不必每次写入时都加载 xml 文件，也不必每次都写入整个文件。

使用 XmlWriter 类，您可以非常轻松地将节点附加到正文文件的末尾。

当其他人想要读取 xml 时，他们只需打开文档，他们的 xml 解析器“知道”加载和解析这两个文件。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-23T11:59:15.670

首先，确保对 XML 文档的所有访问都是通过单个实例完成的。

然后在访问它的函数的开头放置一个锁定机制（等待解锁）并在最后解锁它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T12:00:42.343

你的意思是数据很关键？您的应用程序不是专门使用 XML 文件吗？

锁定对文件的 IO 访问的简单（并且可能足够好）方法是创建一个静态工厂类，该类提供每个 I/O 操作都必须锁定的“读写令牌”对象。

```
public static object GetReadWriteToken(String fileName)
{
    //use a hashtable to retreive an object, with filename as key
    return token;
} 
```

并在阅读和写作时简单地做到这一点：

```
lock(GetReadWriteToken(@"C:\important.xml"))
{
    //io code
} 
```

# c# - 如何防止 DataGridView 共享行？

> ID：229443
> 
> 赞同：1
> 
> 时间：2008-10-23T11:49:08.810
> 
> 标签：c#, .net, datagridview

我制作了一个自定义的 DataGridViewCell，它显示了一个自定义控件而不是单元格；但是如果 DataGridView 使用共享行，那么自定义控件实例也是共享的，所以你会得到奇怪的行为（例如，将鼠标悬停在按钮上会突出显示所有按钮）。另外，我无法访问 DataGridViewCell.Selected 属性，所以我不知道该行绘制什么颜色。

如何防止 DataGridView 共享行？我知道我可以使用 Rows.Add(object[]) 覆盖添加行，但是第一行仍然是共享的（即具有索引-1），所以颜色问题仍然存在。

我需要能够告诉 DataGridView 不要共享包含自定义单元格的行。可以用属性来完成吗？可以做到吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-23T12:48:05.180

尝试在行的一个单元格中设置工具提示文本

在以下任何一种情况下都不能共享行： 该行包含一个未在选定列中的选定单元格。该行包含一个设置了 ToolTipText 或 ContextMenuStrip 属性的单元格。该行包含一个 DataGridViewComboBoxCell 及其 Items 属性集。

或阅读

[http://msdn.microsoft.com/en-us/library/ha5xt0d9.aspx](http://msdn.microsoft.com/en-us/library/ha5xt0d9.aspx)

了解更多信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-30T14:06:59.130

```
DataGridViewRowCollection.AddRange(params DataGridViewRow[] dataGridViewRows) 
```

和

```
new[]{someDataGridviewRow} 
```

为我工作。

# php - 如何将 exif 数据添加到图像中？

> ID：229446
> 
> 赞同：23
> 
> 时间：2008-10-23T11:49:26.843
> 
> 标签：php, image-processing, imagemagick, exif

在我们的网站上，我们从各种来源上传了大量照片。

为了减小文件大小，我们使用[mogrify](http://www.imagemagick.org/www/mogrify.html)从源中删除所有[exif 数据](http://en.wikipedia.org/wiki/Exif)：

```
mogrify -strip image.jpg 
```

我们想要做的是将一些基本的 exif 数据（版权 Initrode 等）插入到这个新的“干净”图像中，但我似乎在文档中找不到任何可以实现这一点的东西。

有没有人有这样做的经验？

如果不能通过 imagemagick 完成，那么基于 PHP 的解决方案将是下一个最好的选择！

谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-23T12:01:15.120

[Exiftool](http://www.sno.phy.queensu.ca/~phil/exiftool/)看起来很适合您。

我还没有尝试过，但我现在很想去修复我所有标记为 01/01/2074 的蜜月照片，因为我忘记在电池耗尽后重置日期。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-23T16:42:33.663

您可以节省大量空间，特别是如果您有大量图像。

将以下内容添加到 text.txt （从[此处](http://www.narf.ssji.net/~shtrom/wiki/tips/imagemanipulation)获取的 IPTC 标签格式）：

```
2#110#Credit="My Company"
2#05#Object Name="THE_OBJECT_NAME"
2#55#Date Created="2011-02-03 12:45"
2#80#By-line="BY-LINE?"
2#110#Credit="The CREDIT"
2#115#Source="SOURCE"
2#116#Copyright Notice="THE COPYRIGHT"
2#118#Contact="THE CONTACT"
2#120#Caption="AKA Title" 
```

从图像中删除所有现有的 exif 数据

```
mogrify -strip image.jpg 
```

将功劳添加到您的图像中

```
mogrify -profile 8BIMTEXT:text.txt image.jpg 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-23T12:05:46.827

这是一个[PHP Exif 库](https://github.com/pel/pel)，应该可以满足您的需要。

> PHP Exif 库 (PEL) 可让您完全操作 Exif（可交换图像文件格式）数据。这是数码相机在其图像中放置的数据，例如日期和时间、快门速度、ISO 值等。
> 
> 使用 PEL，可以完全修改 Exif 数据，这意味着它可以读写。全新的 Exif 数据也可以添加到图像中。PEL 完全用 PHP 编写，除了 PHP 的标准安装，版本 5 之外什么都不依赖。PEL 托管在 SourceForge 上。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-01-08T19:11:48.837

在linux上有一个叫做jhead的程序。它可以使用以下命令添加最小的 exif 标头：

jhead -mkexif img.jpg

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-23T15:23:10.627

我怀疑你会通过删除 Exif 信息获得很多空间......

无论如何，我可能是错的，但 Exif 元数据更多地属于存储技术（和上下文）信息。对于版权等内容，您应该改用 IPTC。

显然，使用 ImageMagick 可以做到这一点：使用 ImageMagick[将 IPTC 数据写入 Jpeg](http://www.experts-exchange.com/Software/Photos_Graphics/Web_Graphics/Q_21093317.html "使用 ImageMagick 将 IPTC 数据写入 Jpeg")。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-09-12T14:57:08.523

您可以使用[PEL](https://packagist.org/packages/lsolesen/pel)库直接在 PHP 中执行此操作。您可以通过简单地覆盖现有的 EXIF 标头来做到这一点，

```
// Load image data
$data = new PelDataWindow(file_get_contents('IMAGE PATH'));

// Prepare image data
$jpeg = $file = new PelJpeg();
$jpeg->load($data);

// Create new EXIF-headers, overwriting any existing ones (when writing to disk)
$exif = new PelExif();
$jpeg->setExif($exif);
$tiff = new PelTiff();
$exif->setTiff($tiff);

// Create Ifd-data that will hold EXIF-tags
$ifd0 = new PelIfd(PelIfd::IFD0);
$tiff->setIfd($ifd0);

// Create EXIF-data for copyright
$make = new PelEntryAscii(PelTag::COPYRIGHT, '2008-2017 Conroy');
$ifd0->addEntry($make);

// Add more EXIF-data...

// Save to disk
$file->saveFile('IMAGE.jpg'); 
```

[您可以在 PEL 文档](https://lsolesen.github.io/pel/doc/PEL/PelTag.html#sec-description)中找到所有受支持的 EXIF 数据 (PelTag) 的完整列表。

# mysql - 如何在两个字段上创建“双面”唯一索引？

> ID：229447
> 
> 赞同：5
> 
> 时间：2008-10-23T11:49:52.943
> 
> 标签：mysql, database-design, indexing, constraints, unique

如何有效地在表中的两个字段上创建唯一索引，如下所示： create table t (a integer, b integer);

其中两个不同数字的任何唯一组合不能在表的同一行上出现多次。

换句话说，如果存在 a=1 和 b=2 的行，则不能存在 a=2 和 b=1 或 a=1 和 b=2 的另一行。换句话说，两个数字不能以任何顺序一起出现多次。

我不知道这样的约束被称为什么，因此标题中的“双面唯一索引”名称。

**更新**：如果我在列 (a,b) 上有一个复合键，并且数据库中存在一行 (1,2)，则可以插入另一行 (2,1) 而不会出错。***我正在寻找的是一种防止同一对数字以任何顺序***多次使用的方法......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-23T13:56:26.527

如何控制表中的内容，以便始终将最小的数字存储在第一列，将最大的数字存储在第二列？当然，只要它“意味着”同样的事情。在它到达数据库之前这样做可能更便宜。

如果这是不可能的，您可以按原样保存字段，但将它们按数字顺序复制到两个其他字段中，您将在其上创建主键（伪代码）：

```
COLUMN A : 2
COLUMN B : 1

COLUMN A_PK : 1  ( if new.a < new.b then new.a else new.b )
COLUMN B_PK : 2  ( if new.b > new.a then new.b else new.a ) 
```

这可以通过触发器轻松完成（如在 Ronald 的响应中）或在应用程序中更高层处理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-23T12:21:44.923

我认为这只能使用 FOR INSERT 触发器（结合对两列的唯一约束）来完成。我对MySql语法不是很流利（我的T-SQL更好），所以我猜下面会包含一些错误：

**编辑：**清理语法，使其适用于 MySQL。另外，请注意，您可能也希望将此作为`BEFORE UPDATE`触发器（当然使用不同的名称）。

此外，此方法依赖于在两个字段上具有主键或其他唯一键（即，此触发器仅检查反向不存在。）似乎没有任何方法可以从触发器中引发错误，所以我敢说这是最好的。

```
CREATE TRIGGER tr_CheckDuplicates_insert
BEFORE INSERT ON t
FOR EACH ROW
BEGIN
    DECLARE rowCount INT;
    SELECT COUNT(*) INTO rowCount
                   FROM t
                   WHERE a = NEW.b AND b = NEW.a;

    IF rowCount > 0 THEN
        -- Oops, we need a temporary variable here. Oh well.
        -- Switch the values so that the key will cause the insert to fail.
        SET rowCount = NEW.a, NEW.a = NEW.b, NEW.b = rowCount;
    END IF;
END; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-23T12:23:00.613

在 Oracle 中，您可以使用这样的基于函数的索引：

```
create unique index mytab_idx on mytab (least(a,b), greatest(a,b)); 
```

我不知道 mySQL，但也许类似的东西是可能的？例如，您可以向表中添加 2 个新列 minimumab 和 greatab ，最大）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-23T11:53:20.643

请参阅[两个外键而不是主键](https://stackoverflow.com/questions/208666/two-foreign-keys-instead-of-primary)

# java - 为软件分发创建多平台 CD

> ID：229456
> 
> 赞同：2
> 
> 时间：2008-10-23T11:51:26.060
> 
> 标签：java, cross-platform, software-distribution, cd

这不是严格的编程相关，但我希望仍然相关。

我正在开发一个用 Java 编写并打算在 PC 和 Mac 上使用的项目。它将在 CD 上分发（最终可能还有 DVD）。我们的目标受众绝对是非技术性的，因此，加载 CD 时“正常工作”很重要。

这本身并不难。对于 Windows，我们可以设置 Autorun 以自动启动应用程序，对于 Mac，我们可以使用特殊的文件夹格式来明确用户应该做什么。

问题是我们想寄送一张可以在 Mac 或 PC 上使用的光盘。我已经看到了一些[相当拜占庭式的方法](http://davidseah.com/blog/creating-a-hybrid-cd-rom-with-toast-7/)来使用特定的专有软件来实现这一点。希望这不是实现这一目标的唯一方法。

所以我的问题是：**如何创建 CD 来分发软件，以便 CD 在 Mac 和 PC 上打开时都能正常工作、执行或显示为“原生”？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-23T12:08:39.007

有很多工具可以刻录 CD 或创建可在 Mac 和 PC 上本地读取的 CD 映像。

[以](http://www.macdisk.com/macimgen.php3)MacImage为例

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-23T12:40:57.770

您可以使用 mkisofs 或 mkhybrid 创建“混合”CD 映像。

# spring - SpringSecurity：始终将登录用户重定向到页面

> ID：229459
> 
> 赞同：3
> 
> 时间：2008-10-23T11:52:33.390
> 
> 标签：spring

Spring Security 有一个很好的特性，它会记住请求资源的 url，并在身份验证成功后将用户重定向到该资源。但我希望用户总是在用户登录后重定向到其他页面。它是如何完成的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-24T15:17:34.367

在您的 spring-security 配置中使用以下内容：

```
<http>
        <form-login default-target-url='/some/other/page' always-use-default-target="true"/>
</http> 
```

# language-agnostic - 控制结构逻辑的正确顺序（真/假、假/真）？

> ID：229468
> 
> 赞同：1
> 
> 时间：2008-10-23T11:56:54.503
> 
> 标签：language-agnostic, conditional, logic, control-structure

我是编程新手，想知道是否有正确的方法来订购您的控制结构逻辑。

首先检查最可能的情况似乎更自然，但我感觉某些控制结构将无法工作，除非他们检查所有错误的东西以得出正确的结果（逻辑推论？）

很难适应这种“负面”观点，我更喜欢更积极的观点，假设一切都是真的:)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-23T12:07:20.660

*[在 McConnell 的Code Complete](http://cc2e.com/)*中有一个关于这个主题的精彩讨论。这是一本我强烈推荐的书。无论如何，相关讨论在第一版或 pg 的第 706-708 页上。第二版的 749-750（感谢 plinth）。从那本书：

> 安排测试，以便首先执行最快且最有可能正确的测试。正常情况下应该很容易掉线，如果效率低下，他们应该在处理异常。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-23T12:06:49.197

除了条件语句的值之外，还有一些事情需要考虑。例如，如果代码块的大小明显不同，您可能希望将小块放在第一位，以便更容易看到。（如果较大的块真的很大，它可能需要重构，或者可能被拉到一个单独的方法中。）

```
if( condition is true ) {
    do something small;
} else { 
    do something;
    and something else; 
    . . .
    and the 20th something;
} 
```

在条件范围内，是的，一旦表达式的一部分为假，有些语言将停止计算表达式。如果您在代码中包含某种 is-defined 逻辑，请务必记住这一点：如果您的语言评估整个表达式，您应该这样做：

```
if( variable is defined ) {
    if( variable == value ) {
        ...
    }
} 
```

而不是这个：

```
if( (variable is defined) && (variable == value) ) {
     ...
} 
```

我认为没有一种“正确”的方式来设计您的条件。如果您在一家有编码标准的公司工作，您应该检查是否包含在标准中。（我工作的最后一个地方定义了合理数量的标准，但没有指定如何编写条件逻辑。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-23T12:04:25.223

一般来说，我会先检查意外的项目，这迫使我处理程序的异常流程。

这样，我可以在开始“设置”正常程序流程之前抛出异常/中止操作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-23T12:29:27.717

另请参阅此问题：

[在 IF 块中放什么，在 ELSE 块中放什么？](https://stackoverflow.com/questions/166550/what-to-put-in-the-if-block-and-what-to-put-in-the-else-block)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-23T12:09:24.340

我的目标是以某种方式构建我的条件，以尽量减少读者必须接受的信息量。有时更容易测试负面以证明正面：

一个例子 - 查看一个 2 个日期的周期是否与另一个 2 个日期的周期相交的测试更容易编写为两个周期不相交的测试

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-23T13:01:27.730

在大多数情况下，可读性比执行速度更重要。因此，我尝试使用以下方法进行优化以易于理解：

所有“断言”检查都是预先完成的。这保证了所有错误的情况在一开始就得到处理。这对于空指针检查尤其重要，例如

```
    如果（arg == null）{
      抛出新的 IllegalArgumentException(); // 苛刻（正确）
    }
    // 或者
    如果（arg == null）{
        参数 = ""; // 宽容（懒惰）
    }

```

接下来，我尝试仅在每个 if 语句中检查 1 个条件。代替

```
    如果（条件1 && 条件2）{
        ...
    } 别的 {
        ...
    }

```

我一般更喜欢

```
    如果（条件1）{
        如果（条件2）{
            ...
        } 别的 {
            ...
        }
    } 别的 {
        ...
    }

```

这种方法更容易设置断点，并且使逻辑更加明显。

我避免否定；代替

```
    如果（！条件）{
        ...一种...
    } 别的 {
        ...b...
    }

```

事情最好重新安排

```
    如果（条件）{
        ...b...
    } 别的 {
        ...一种...
    }

```

最后，所有返回布尔结果的方法都应该有一个“肯定”的名字来表明结果的含义：

```
    boolean checkSomething(Something x){ ... } // 不好——结果是什么？
    boolean isSomethingInvalid(Something x){ ... } // 更好，但是 ...
    boolean isSomethingValid(Something x){ ... } // 最好，没有“心理否定”

```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-23T12:18:22.650

如果这是一个简单的“是”或“错误”问题，那么我通常会构造一些东西，以便错误处理分支是 else 子句。如果这是一个是或否的问题（即两个分支都不是错误），那纯粹是对感觉更自然的判断。如果在代码的核心可以执行之前必须进行很多测试，我通常会尝试构建一些东西，以便首先出现负面测试并以某种方式跳过后面的代码（从函数返回，中断或继续一个循环）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-23T12:00:12.860

两者任一。不过，我通常使用“否定”方法。

如果（！某事）{

}

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-23T13:17:04.857

这有点超出了问题的范围，但通常您也希望您的方法快速失败。出于这个原因，我倾向于在方法的顶部进行所有的参数验证，即使在代码的后面部分我不会使用该参数。这会损害可读性，但仅在方法非常长的情况下（必须滚动屏幕才能看到它）。当然，这本身就是一种代码味道，并且往往会被重构。

另一方面，如果检查不简单并且我将把它传递给另一个将要检查它的方法，我不会重复代码来检查当前方法。与大多数事情一样，有一个平衡。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-23T13:29:31.043

（上下文：Java）

READABILITY1：解析为较小代码块的条件首先出现

```
if (condition) {
  smallBlock();
} else {
  bigBlockStart();
  ........
  bigBlockEnd();
} 
```

READABILITY2：肯定的断言是第一位的，因为它更容易不注意到否定符号

有意义：使用 Assert.blabla() 断言方法的所有先决条件，并仅对方法的作用使用条件。

# survey - 贵公司的软件开发真正喜欢什么（方法、工具……）？

> ID：229472
> 
> 赞同：22
> 
> 时间：2008-10-23T11:59:30.193
> 
> 标签：survey

自从我大约两年前开始作为专业软件开发人员的第一份工作以来，我已经阅读了许多关于普遍接受的方法（例如 Scrum、XP）、技术（例如 EJB、Spring）、技术（例如 TDD、代码审查）的文章)、软件公司中的工具（错误跟踪、wiki）等。

对于其中许多，我发现我们公司不使用它们，我问自己为什么。我们做错了还是仅仅是我读过的这些文章并没有真正说明现实世界中的情况？这些文章更具学术性吗？

所以，请告诉我你们公司的情况。讲述有关软件开发的一切。这里有一些建议（按照我脑海中的顺序）。至少告诉您是否这样做，或发表简短评论：

*   测试驱动开发
*   领域驱动设计
*   模型驱动设计/架构
*   你测试吗？
*   单元测试
*   集成测试
*   验收测试
*   代码审查
*   创新技术（Spring、Hibernate、Wicket、JSF、WS、REST，...）
*   敏捷
*   结对编程
*   UML
*   特定领域的语言
*   需求规范（如何？）
*   持续集成
*   代码覆盖工具
*   贫血域模型
*   通信（Wiki、邮件、即时消息、邮件列表、其他文档）
*   努力估计
*   团队规模
*   会议
*   代码指标
*   静态代码分析
*   错误跟踪
*   ...

请记住：我想知道你真正在做什么，而不是你想做什么或认为你应该做什么。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-10-23T13:18:46.260

*   **测试驱动开发**- 没门。
*   **领域驱动设计**- 什么是*设计*？
*   **模型驱动设计/架构**- 什么是*设计*？我们确实有一个架构团队。除了一个例外（最初级的建筑师），他们无法从纸袋中编写代码。不过，他们肯定擅长用线条画框！并建立[蹩脚、毫无价值、过于笼统和完全无用的标准](http://www.opcfoundation.org/)。（旧的 OPC 东西还可以，但在过去 4 年左右的时间里，UA 标准已经“下个月完成”。）
*   **你测试吗？**- 是的，我们确实有一个专门的测试团队。每 10-12 名开发人员大约有 1 名测试人员。他们完全被淹没了。问我我们是否测试*得很好*。
*   **单元测试**- 完全非正式/由开发人员决定。当我得到的时间表允许时，我会这样做。
*   **集成测试**- 是的。鉴于我们开发和支持的产品套件，这是必要的。
*   **验收测试**- 是的，仅适用于合同制工作。
*   **代码审查**- 总是口头上说，永远*不*要这样做。
*   **创新技术（Spring、Hibernate、Wicket、JSF、WS、REST，...）** - 强烈反对采用新的依赖项。Boost 永远不会被采用，例如，我们通常很幸运能够获得较新版本的 .Net，但通常会落后 2 年左右。
*   **敏捷**——不。管理层声称想要“敏捷”，尽管他们没有表现出对它是什么的最简单的理解。我们最近刚刚修改了我们的流程，以便指定更高优先级的任务并以......（等待它）更高的优先级来实现！管理层告诉我，这是我们新的“敏捷”流程。不过，它仍然像瀑布一样闻起来、走路和嘎嘎叫。
*   **结对编程**- 没门！付钱让*两个*人做一个人的工作？接下来，您将建议开发人员应该将时间浪费在*设计*和*代码审查*等无意义的事情上。狗，猫，一起生活！
*   **UML** - 不。我们曾经有过一个 UML 工具来帮助我们理解已经发展的遗留代码库。该工具的评估负责人非常喜欢它，它在不到 30 秒的时间内对整个百万行以上的 C++ 代码库进行了逆向工程！在他们被说服购买它并且实际的开发人员尝试使用它之后，我们发现实际上只需要这 30 秒就无法解析 95% 以上的代码库。错误报告太糟糕了，评估员甚至没有发现它失败了。（[我在看着你，孩子！](http://www.magicdraw.com/)）我们只花了一年半的时间就放弃了我们的许可证。看？敏捷！
*   **特定领域的语言**——它们可能在某处被使用，虽然不是我自己。
*   **需求规范（如何？）** - 产品经理执行一些巫术并发明它们。有时他们甚至可能与客户谈论他们！如果你真的很幸运，他们甚至会理解用例和需求之间的区别。不过，不要指望它。我们真的不做用例。
*   **持续集成**- 没办法。当一切都同时破裂时，它会更令人兴奋。
*   **代码覆盖工具**- 有人曾经在冰冷的服务器机房中的源存储库服务器上放了一块毯子。这算不算？
*   **贫血领域模型**- 说真的，我以前从未听说过这个。
*   **通信（Wiki、邮件、即时消息、邮件列表、其他文档）** - 备忘录。Lotus Notes*不做*“电子邮件”。一堆新奇的垃圾。
*   **努力估计**- 不是真的。在我的组织中，[估计是目标的代码。](http://blogs.construx.com/blogs/stevemcc/archive/2008/05/13/Software_2700_s-Classic-Mistakes_2D002D00_2008.aspx). 项目的截止日期锁定在项目的瀑布式开发的 5 个“敏捷”阶段中的第一个阶段。这些到期日称为“大致估计”，但实际上是指“发货日期”。
*   **团队规模**- 根据产品运行范围。如果包括经理，我们的团队小至四人，大至十五人。
*   **会议**——如果你相对初级并且不从事超过一两个产品的工作，这还不错。我每周只需要参加 2-3 次 1 小时的会议。
*   **代码指标**- 否。
*   **静态代码分析**- 从理论上讲，.Net b/c FxCop 是内置的，它的使用是我们的标准规定的，但实际上，没有。没有人检查它 b/c 从来没有任何代码审查。只是偶尔的质量审核（又名，书面跟踪/责任审核），以确保我们不会失去今年的认证。
*   **错误跟踪**- 是的，但仅针对客户报告的问题。不允许开发人员针对他们正在开发的 b/c 产品提交发现的错误，这些产品不是“团队合作者”。（当我犯了*那个*错误时，我老板的老板向我解释了这一点。我现在对一个愿意“发现”我可能在其他与支持相关的沟通过程中“不小心”提到的错误的特定客户很友好.)

就大型企业开发而言，还有更糟糕的情况。考虑到我住的地方，以及该地区缺乏高科技工作，我真的很幸运能有一份演出。但这并不意味着我必须喜欢事情的现状。甚至试图影响已建立的企业文化也需要大量的时间和持续的压力。

但如果他们厌倦了我试图改变文化并解雇我的尝试，好吧，我想那天晚上我不会哭着入睡。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-23T12:45:01.817

我认为著名的*[Big Ball of Mud](http://www.laputan.org/mud/)*模式描述了很多工作环境，并为您提供了一些关于如何与此类事情作斗争的好主意。

* * *

顺便说一句，我意识到我没有直接回答你的问题，但大泥球在令人沮丧的大部分开发情况中占主导地位。你可以询问测试驱动开发和缺陷跟踪以及其他类似的事情，但如果从我所看到的情况来看真相，我会说大泥球几乎是人们工作的事实上的方式——他们应该或不应该。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-23T12:35:44.317

*   测试驱动开发 - 几乎就在那里。
*   领域驱动设计 - 否
*   模型驱动设计/架构 - 否
*   你测试吗？- 是的
*   单元测试 - 是的
*   集成测试 - 是
*   验收测试 - 否
*   代码审查 - 否
*   创新/新技术（Spring、Hibernate、Wicket、JSF、WS、REST，...） - ASP.NET MVC？休眠？是的
*   敏捷——刚刚开始
*   结对编程 - 否
*   UML - 没有正式的
*   特定领域的语言 - 否
*   需求规范（如何？） - 是的。捕获故事需求。
*   持续集成 - 是的。团队城市
*   代码覆盖工具 - 是的。无盖
*   贫血域模型 - 否
*   通信（Wiki、邮件、IM、邮件列表、其他文档）- IM、电子邮件
*   努力估计 - 1,2,4,8
*   团队规模 - 4
*   会议 - 每日站立
*   代码指标 - 否
*   静态代码分析 - 否
*   错误跟踪 - 现有的自定义作业

我的部门正在进行中。在过去的几个月里，我一直在努力实施持续改进。有些事情已经很难谈论了。然而，当回首往事时，他们已经有所改善。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-08T13:52:42.583

*   测试驱动开发：是
*   领域驱动设计：是
*   模型驱动设计/架构：是
*   你测试吗？是的
*   单元测试 - 是的
*   集成测试 - 是的
*   验收测试 - 是的
*   代码审查 - 是的
*   创新技术 - 是的
*   敏捷——完全敏捷
*   结对编程 - 是的
*   UML - 有时用于 ddd 白板战斗
*   特定领域的语言 - 是的
*   需求规范（如何？） - 以示例和验收测试的形式
*   持续集成 - 是的 - TeamCity
*   代码覆盖工具 - 是的 - NCover
*   贫血域模型 - 不确定
*   通信（Wiki、邮件、IM、邮件列表、其他文档） - wiki、邮件、msn
*   团队规模 - 6+ 取决于项目
*   会议 - 每天早上 9:30 - SCRUM
*   代码指标 - 不知道
*   静态代码分析 - 不知道
*   错误跟踪 - 螳螂

而且最重要的是...

*   每个人都在 5 点 30 分回家：**是**

但是工资低很多，因为很多人想为这家公司工作。不能拥有一切！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-11-01T22:15:48.020

*   **测试驱动开发：**不。充其量，在非常小的部分。我们都在谈论，但不要这样做。
*   **领域驱动设计：**不。如果您正在开发技术框架，很难知道“域”是什么。在DDD方面没有太多经验知道如何去做。
*   **模型驱动设计/架构：**不。
*   **你测试吗？：**是的，但还不够。每个版本（我们尝试每 8 周推出次要版本）总是有超过 2 个服务版本。我们正处于产品开发的第一年，所以我认为这还不错。
*   **单元测试：**是的。在大约。30% 的覆盖率。大多数开发人员现在都知道他们应该为自己编写单元测试。每次他们必须修复自己代码中的关键错误时，如果他们事先编写一个简单的测试以首先防止错误，他们就会看到好处。
*   **集成测试：**是的，使用 Selenium 和 WebDriver。
*   **性能测试：**是的，从现在开始。目标是存档长期性能测量并将它们与发布进行比较。为此使用 JMeter 和专用的性能测试服务器。
*   **验收测试：**并非如此，但我们的产品也在内部使用，并且在发布之前我们很快就收到了反馈。我将其视为验收测试。
*   **代码审查：**不。有时，其他人会看 30 分钟，但仅此而已。
*   **创新技术（Spring、Hibernate、Wicket、JSF、WS、REST ......）：**从我的观点来看，这些技术不再“创新”。他们现在几乎是老派了。除了 JSF，它几年前就死了。Spring + Hibernate 在过去的几年里。现在做 Wicket + WS 2 年了。将 Hibernate 替换为 iBatis SqlMaps。
*   **敏捷：**不。
*   **结对编程：**不。
*   **UML：**一点点，主要用于部署图。类图过于细化，常常与现实不同步。开发人员做他们认为最好的事情，而不是 UML 图告诉他们做的事情。
*   **特定领域的语言：**是的，我们正在使用自制的业务规则技术。这是一种适用于最终用户的可视化 DSL。有点像使用 Visio 来为决策建模。
*   **需求规范（如何？）：**不。
*   **持续集成：**是的。基于 Hudson 和 Maven。单元测试在每个构建上运行。启用更详细报告的其他夜间构建。整个团队都会收到有关构建失败的通知（是的，他们有时会抱怨收到太多邮件，如果某些事情破坏了链并且所有 30 个子模块都出现构建失败，例如当 Maven 存储库无法访问时）
*   **代码覆盖工具：**是的。Maven/Cobertura 和声纳。
*   **贫血领域模型：**不知道这应该是什么。
*   **通信（Wiki、邮件、IM、邮件列表、其他文档）：**由专业/非开发人员编写的 Wiki、邮件、IM、每日站立会议、最终用户和开发人员手册。
*   **努力估算：**努力做好估算。但是没有reqs，它们只是粗略的估计。不过，对于资源规划来说已经足够了。
*   **团队规模：** 12
*   **会议：**每日站立，每次小版本发布后每 8 周回顾一次。
*   **代码指标：**声纳。希望遵守大多数规则。虽然没有时间重新配置规则以满足我们的需求。
*   **静态代码分析：** Sonar。
*   **错误跟踪：** JIRA

笔记：

*   Sonar 是一个代码质量服务器。它结合了 PMD、Findbugs、Checkstyle 等工具。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-23T12:00:04.530

*   测试驱动开发 - 否
*   领域驱动设计 - 否
*   模型驱动设计/架构 - 否
*   你测试吗？- 几乎从不
*   单元测试——几乎从不
*   集成测试 - 否
*   验收测试 - 否
*   代码审查 - 否
*   创新技术（Spring、Hibernate、Wicket、JSF、WS、REST，...） - Spring、Hibernate、Wicket
*   敏捷 - 否
*   结对编程 - 否
*   UML - 只是草图
*   特定领域的语言 - 否
*   需求规范（如何？）——我们得到一个庞大的客户需求规范，我们使用思维导图来提取实际的特征，然后进行估计
*   持续集成 - 否
*   代码覆盖工具 - 否
*   贫血域模型 - 是
*   通信（Wiki、邮件、IM、邮件列表、其他文档）- 思维导图、邮件
*   努力估计 - FITA（指在空中，[见这里](http://weblogs.asp.net/astopford/archive/2008/08/26/software-estimation-is-hard-right.aspx)）
*   团队规模 - 2-6
*   会议 - 每周 2-3 次
*   代码指标 - 否
*   静态代码分析 - 否（尝试过 FindBugs 和 Checkstyle）
*   错误跟踪 - 是的，Bugzilla

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-23T12:19:09.407

我为你感到难过 :) 这不是一个好的工作环境，因为你需要不断练习实践好的做法才能真正理解和使用它们。

我知道有几家（包括我的）公司能够在您的清单中勾选所有“*好*”的方框。

然而，魔鬼在细节中，即使在一些拥有良好 SDP 政策的公司中，也不是每个项目都遵循它们。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-23T15:38:55.883

*   测试驱动开发——虽然它应该是试图引入的，但我不认为它已经起飞，所以这仍然是一个不，但现在有更多细节。
*   领域驱动设计 - 否
*   模型驱动设计/架构 - 否
*   你测试吗？- 是的，但不全面。我们确实有一些单元测试、一些集成测试和一些 WatiN 测试。
*   单元测试——我们有一些用于我们的新开发，但旧的没有。
*   集成测试 - 通常，当它适用时。我的团队作为网络团队似乎还没有经常发生这种情况。
*   验收测试 - 我们有几个级别。第一个是当一个新功能正在开发中，并且必须得到另一个团队的某个人的初步批准，该团队将输入在它甚至与代码集成之前出现的内容。第二个是在 Sprint 结束时展示功能以获得更多关于看起来不正确或运行良好的反馈。然后在它作为决赛投入生产之前还有第三个关卡，“是的，这并没有破坏我们已经拥有的东西，”之类的事情。
*   代码审查 - 这些不再完成，但可能是一件好事。
*   创新技术（Spring、Hibernate、Wicket、JSF、WS、REST ......） - 我们的项目中应用了一些 RESTful 思想，我们正在使用 .Net 框架的一些特性，如 lambda 表达式。
*   敏捷 - 我们使用 Scrum 并有站立会议、故事板、迭代计划会议（这实际上是针对 sprint 而不是 2 个 sprint 的迭代，因为在每对 sprint 之后，工作会向高管和其他部门展示，而另一个演示适用于架构师和内容输入团队的负责人。）
*   结对编程——我们确实在大多数不被视为繁重工作的新开发中结对。因此，对于想要在网站的培训部分工作的人来说，一对将完成，而不仅仅是一个开发人员。
*   UML - 不，我们的新机器中删除了 UML 工具
*   特定领域的语言 - 不，但有一些术语是公司自己对事物的解释，因为内部产品的一些名称与其他人可能用于各种事物的术语发生冲突。
*   需求规范（如何？） - 这可以从一个大字文档说明需要做什么到要做什么的对话，然后尝试这个，然后再尝试那个。
*   持续集成 - 我们为我们的 CI 运行 Cruise Control.Net，当我们提交代码更改时使用它。
*   代码覆盖工具 - 不。
*   贫血的领域模型 - 某种程度上，这里并没有真正的大领域模型。
*   通信（Wiki、邮件、即时消息、邮件列表、其他文档） - 按重要性排序：电子邮件、即时消息、电话，然后是访问隔间。每周与应用程序经理举行一次团队会议，并就大项目进行每日站立会议。
*   工作量估算——这在每个 sprint 中都很常见，尽管有时这是通过发送电子表格让每个人输入他们的估算来完成的，Scrum Master 将所有结果结合起来供我们最终查看。
*   团队规模 - 5 名开发人员和一名团队负责人、一名担任 Scrum Master 的业务分析师、一名负责监督我们拥有的内容的测试人员以及根据需要弹出的团队之外的其他人，包括实际使用系统的内容作者。
*   会议 - 实事求是，简短，有效，通常有利于沟通当前的情况。
*   代码指标 - 我不知道。
*   静态代码分析 - 不。
*   缺陷跟踪 - Quality Center 用于跟踪缺陷。 *** 源代码控制 - 我们现在正在使用 Subversion。对于任何功能或错误，我们都会创建一个新分支，这样我们就可以独立工作，而不会让我们的提交在我们处理某些事情时破坏构建。但是，我们都共享相同的数据库进行开发，这有时会很有趣。**
*   IDE - 在 XP 上使用 .Net 3.5 和 Sitecore 6.1 的 Visual Studio 2008
*   ...

在我来这里的近 2 年里，该团队是我们的第三个团队领导。

CMS 项目是我们都在努力的大项目，尽管有其他人处理的各种支持请求。

在我们拥有 IS 副总裁的这一年发生了很多变化。生产更加锁定，还有更多的工作来完成发布，因为现在有一个检查列表程序和更多可能有用的箍。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-11-01T19:51:41.663

*   测试驱动开发——如果你的意思是在代码之前编写测试，并不总是
*   领域驱动设计——不是纯粹的 DDD
*   模型驱动设计/架构 - 永远不会，但真的永远不会，再次
*   你测试吗？- 是的，总是
*   单元测试 - 是的，总是
*   集成测试 - 这取决于但我们尽量避免它们，因为它们通常很慢
*   验收测试 - 是的，理想情况下是自动化的
*   代码审查 - 是的，这包含在完成的定义中
*   创新技术 (Spring, Hibernate, Wicket, JSF, WS, REST, ...) - 不确定提到的技术是否具有创新性，但对 Spring、Hibernate、WS 是肯定的
*   敏捷——是的，这在我的 DNA 中
*   结对编程 - 并非总是如此（如果明确要求，与新团队成员一起讨论新主题）
*   UML - 一点点（即白板上不时出现的类或序列图），仅在有帮助的情况下
*   特定领域的语言 - 直到现在还没有真正的使用
*   需求规范（如何？） - 轻量级规范（例如用户故事）
*   持续集成——当然（根据我们对完成的定义，代码必须是“集成的”）
*   代码覆盖工具 - 是的 (cobertura)，这是在 done 的定义中
*   贫血领域模型 - 不，我们尽量避免这种情况
*   交流（Wiki、邮件、IM、邮件列表、其他文档）- 面对面、wiki、IM、邮件、邮件列表（但我们尽量避免使用 word 文档）
*   工作量估计 - 是的，在积压级别的故事点，在迭代级别的小时数
*   团队规模 - 7+/-2
*   会议 - 是的，但只有一个有用且总是有时间限制的（迭代计划、每日会议、演示和回顾）
*   代码指标 - 是（圈复杂度、代码覆盖率、声纳中收集的编码标准）
*   静态代码分析 - 是的（findbugs、checkstyle）
*   错误跟踪 - 是的，当然（但我们会在发现错误后立即修复它们）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-12-05T04:10:42.997

我是一家小型软件公司的两名程序员之一，拥有非常非技术的所有者（“什么是'浏览器'” - 上周被认真问过）。

优点是我可以在大多数这些点上自己选择。

测试驱动开发 - 我们的所有者有一个糟糕的经历或其他东西。以错误的方式提及测试，我发誓她的行为是出于创伤后应激障碍。

领域驱动设计——是的。

模型驱动设计/架构 - 是的。

你测试吗？- 没有。测试落在销售和支持人员以及业主身上。因此，一旦它离开我的开发机器，就没有什么能得到太多测试。

单元测试——如果我被发现这样做我可能会被解雇。它真的是唯一可以让我被解雇的事情。

集成测试 - 请参阅“您进行测试吗？”

验收测试 - 好吧，我们必须在某个时候部署它，对吧？

代码审查 - 没有其他人会理解它。我见过其他人。希望我没有。

创新技术（Spring、Hibernate、Wicket、JSF、WS、REST，...） - 是的。但我很生气。我是一个“孩子”，对过去十年没有发明的东西一无所知（尽管我已经 30 岁了，而且我的办公桌上有“数据库系统读物”）。

敏捷 - 我不瀑布。但我也不是很敏捷。

结对编程 - 您不想尝试与在我们公司工作的其他“程序员”交谈。

UML - 不。但我有时会在白板上画出带有标识符的方框。大佬们都这样。好在他们没有更多的技术倾向，否则我可能会看到更多的盒子。

特定领域的语言 - 不。

需求规范（如何？） - 不。

持续集成 - 不。

代码覆盖工具 - 不。

贫血域模型 - 是的。试过了。在我的大多数情况下，我不喜欢它并且不使用它。

通信（Wiki、邮件、即时消息、邮件列表、其他文档）- 尝试过，无法获得同事的支持。我们的 MediaWiki 安装仍然具有默认的徽标图形。

工作量估算——我们必须估算每项工作需要多长时间（以小时为单位）。这就是客户收取的费用。这就是我们期望在该项目上花费的费用。我们甚至在寻找新客户和从头开始开发新应用程序时，以及在我们进行错误修复（是的，我们为此向客户收费）、功能添加等时都会这样做。

团队规模 - 1。让我说这不是一个好的工作方式。能够实时反映其他有能力的程序员的想法要好得多。

会议 - 几个小时值得一周，有时会翻倍，很少少于。我做的一半会议是与客户的，完全是内部的。

代码指标 - 不。

静态代码分析 - 不。

错误跟踪 - 没有我应该的那么多。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-12-05T04:37:54.627

我在澳大利亚布里斯班的一家 Ruby on Rails 咨询公司工作。

*   **测试驱动开发**：我们办公室非常非常努力地推动这一点。不测试被视为“非常愚蠢”。您编写代码，如何通过诸如 CI 之类的自动化过程确保它仍然有效？测试。

*   **你测试吗？**: 见第一点。

*   **单元测试**：一直使用 RSpec。我在 Test::Unit 和 Shoulda 中也很“流利”。

*   **集成测试**：再一次，一直，Cucumber。

*   **验收测试**：我们用我们的票“交付”他们的验收标准。然后客户必须通过跟随弹跳球来“接受”或“拒绝”他们。验收标准还有一个好处，那就是我们的 Cucumber 功能也被写入其中。

*   **代码审查和配对编程**：我们配对。这是代码审查的即时版本。这很棒，因为您可以坐下来观看其他人的工作，他们编写测试，然后您编写代码以使测试通过。如果您生病了，那么其他人就会知道您在做什么，并且可以与其他人配对。

*   **创新技术**：因为我们使用 Rails，所以我们非常喜欢 REST。

*   **敏捷**：我们使用[Pivotal Tracker](http://pivotaltracker.com)进行 2 周的迭代。

*   **需求规范（如何？）**：使用 Pivotal Tracker 中的功能，客户可以指定他们有什么需求，然后我们将它们充实（通常通过与他们交谈）成为验收标准，最终成为现实世界的功能。

*   **持续集成**：我们使用我开发的 CI 服务器，称为[构造](http://github.com/radar/construct)。这是建立在像 Integrity 一样的想法的基础上，但有后台工作和对分支机构的更好支持。现在 Integrity 有了背景建设，仍然有分支支持让我们“领先”。

*   **代码覆盖工具**：有时是 RCov。我们并不真正关心代码覆盖率，因为我们在编写之前测试了所有内容。如果它存在，就会有一些东西可以测试它。

*   **沟通（Wiki、邮件、IM、邮件列表、其他文档）**：我们主要使用电子邮件与客户沟通，但我们也使用 Skype 与他们进行“站立”。我们也为此使用了 Basecamp。我想在我们的下一个项目中使用 Google Wave，就像一个小实验。我认为这真的很有帮助。

*   **团队规模**：我们团队有 4 人，通常是 2 对，除非有人生病。

*   **会议**：我们早上有一个持续约 15 分钟的“scrum”/“standup”。这样做的想法是你回顾你前一天所做的事情，你遇到的任何问题，你今天要做什么，以及你发现的一些“新的和闪亮的”。这不应该变成项目会议。如果需要，这些是在站立之后的。
*   **错误跟踪**：我们再次使用 Pivotal Tracker。客户可以在此处提交错误，然后（理想情况下）编写如何复制它。然后我们编写一个测试以确保这种情况永远不会再次发生（又名：回归测试），它与我们的功能经历相同的工作流程，我们交付并且客户接受。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-01-27T13:02:40.170

我在南非的 Chillisoft.co.za 工作

**测试驱动开发**：自第一本 Kent Beck 书籍以来，我们一直在使用测试驱动开发实践，它一直在执行。我们使用 NUnit 和 R# 作为测试运行器。

**你测试吗？**：除了 TDD 之外，我们还进行手动测试（视觉），并在必要时自动进行。用于自动化的技术依赖于 UI 技术。

**单元测试**：见 TDD。

**集成测试**：是的，但我们还没有普遍使用。

**验收测试**：我们为外部客户进行定制软件开发，在他们接受之前您不会获得报酬，因此是的。

**代码审查**：为每个项目安排双月一次。即使是那些已经配对/对等编程的。

**结对编程**：我们的大部分编码都是结对进行的，但肯定有一些任务和项目的某些阶段效率较低。我们所做的是在项目启动期间（每个阶段的前几周），我们配对编程。在完成阶段，我们没有。当我们从事开源项目时，我们也有特定的时间（每个开发人员每周 8 小时），这些都是成对编程的。我们所有的机器都设置了多个键盘和鼠标，以促进开发人员之间的顺畅交互。

**创新技术：我们在**[Habanero](http://www.habanerolabs.com/)上做了大量工作，并将这个框架与 DI 容器 Unity 和 RhinoMocks 一起使用。

**敏捷**：我们使用敏捷哲学已经 8 年了，并且在我们继续沿着这条道路前进的过程中，我们将继续尝试使用工具和哲学。

**需求规范（如何？）**：我们为 MSWord 中的下一次迭代捕获用户故事（用例）。然后，我们在 Jeera 中通过工作量估计等捕获这些摘要，该工作量估计等管理绘制图表等。

**持续集成**：我们目前使用的是在 SVN 之上工作的 Hudson。

**代码覆盖工具**：我们为每个项目运行代码覆盖，作为我们夜间构建的一部分。我们已将生成的报告集成到 Hudson 报告中，以便我们可以每天跟踪每个项目的这些报告。

**交流（Wiki、邮件、IM、邮件列表、其他文档）**：显然我们以许多不同的方式进行交流，我们有一个内部 Wiki 等。

**团队规模**：我们有 15 名软件开发人员。

**会议**：我们每天早上都有一个“scrum”，持续约 10 分钟。

**错误跟踪**：我们使用不同的系统进行内部错误跟踪（即在开发和内部测试期间）和外部错误跟踪，即来自客户的错误。内部跟踪（即在内部测试和开发期间）我们使用 redmine。外部跟踪（即我们的客户）我们使用 Mantis。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-23T12:24:27.337

*   测试驱动开发 - 否
*   领域驱动设计 - 否
*   模型驱动设计/架构 - 否
*   你测试吗？- 有时
*   单元测试——几乎从不
*   集成测试 - 是
*   验收测试 - 有时
*   代码审查 - 只是偶尔
*   创新技术（Spring、Hibernate、Wicket、JSF、WS、REST，...） - 否
*   敏捷 - 否
*   结对编程 - 否
*   UML - 在我的标记板上，是的。
*   特定领域的语言 - C++ 是特定领域的，对吧？
*   需求规范（如何？） - 我认为我们满足他们。
*   持续集成 - 是
*   代码覆盖工具 - 否
*   贫血领域模型 - 什么是领域模型
*   通信（Wiki、邮件、即时消息、邮件列表、其他文档）- 电子邮件和 Skype。什么是维基？
*   工作量估算 - 任何给定任务需要 1-2 天
*   团队规模 - 2 名软件工程师，10 名硬件工程师
*   会议 - 每周 2 次
*   代码指标 - 否
*   静态代码分析 - 否
*   错误跟踪 - 否

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-23T12:25:54.167

*   测试驱动开发 - 是的
*   领域驱动设计 - 否
*   模型驱动设计/架构 - 否
*   你测试吗？- 是的
*   单元测试 - 是的
*   集成测试 - 是
*   验收测试 - 开始
*   代码审查 - 否
*   创新技术（Spring、Hibernate、Wicket、JSF、WS、REST ......）——不是吗？
*   敏捷 - 是的
*   结对编程 - 几乎所有时间都是
*   UML - 没有比白板上的线条和方框更正式的了。
*   特定领域的语言 - 一点
*   需求规范（如何？） - 不，如果可能，我们会尝试获取用户故事
*   持续集成 - 是
*   代码覆盖工具 - 否
*   贫血域模型 -
*   通信（Wiki、邮件、IM、邮件列表、其他文档）- Wiki、IM、电子邮件、Word Docs
*   努力估算 - 我们使用 T 恤尺码（S、M、L、XL 等）和按冲刺速度进行冲刺的积分系统的组合。
*   团队规模 - 6->8
*   会议 - 每日站立
*   代码指标 - 否
*   静态代码分析 - 否
*   错误跟踪 - Bugzilla / 版本一

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-23T12:30:06.030

*   测试驱动开发：偶尔有人可能会为一个组件做它。此外，实现带有一致性测试的公共规范提供了 TDD 的一些优点，而且还有很多优点。
*   领域驱动设计：否
*   模型驱动设计/架构：否
*   你测试吗？：是的
*   单元测试：一些，虽然不完整。很多组件都是供客户使用的库。“strlen”实现的单元测试和功能测试之间有一条细线。
*   集成测试：并非如此，单元测试和系统测试之间几乎没有什么区别
*   验收测试：是的，验收测试的子集用作系统测试
*   代码审查：没有正式的过程，但一些代码得到审查
*   创新技术（Spring、Hibernate、Wicket、JSF、WS、REST ......）：否
*   敏捷：没有
*   结对编程：无
*   UML：没有
*   特定领域的语言：非常偶尔
*   需求规范（如何？）：有点
*   持续集成：不，但测试团队自行决定每日构建和恢复导致失败的更改
*   代码覆盖工具：没有正式要求，已知测试团队使用它们
*   贫血领域模型：我什至不知道这是什么
*   通信（Wiki、邮件、IM、邮件列表、其他文档）：所有这些都是临时选择的，除了需求和设计文档必须是受源代码控制的 HTML，并且内部接口文档是从标题中的 Doxygen 注释生成的。
*   努力估计：有点
*   团队规模：约 20 名程序员，分成 1-4 人的组件团队。几乎没有人专门为他们所属团队的组件工作。
*   会议：每周一次的全体会议，以交换进度报告并以其他方式分享正在发生的事情。没有其他定期为开发人员安排的会议：根据需要安排讨论。
*   代码指标：无
*   静态代码分析：除非你算上 -pedantic ;-)
*   错误跟踪：Bugzilla，在某种程度上与源代码控制集成

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-23T12:31:57.553

•Test-Driven-Development - 刚刚开始接管，到目前为止非常满意

•你测试吗？- 当然，每个人都喜欢，谁想让QA嘲笑他们？

•单元测试 - 大约 2 年以来，帮助提高了稳定性，并且每次构建都运行测试

•代码审查 - 到处都是，尤其是任何后期更改

•Agile - 热爱敏捷及其响应性

•结对编程- 只是在几个地方尝试，早期回报很有希望

•持续集成——CruiseControl.NET 的胜利！！！如此巨大的帮助

•代码覆盖工具——总是在每次单元测试运行期间，CC.NET 都会向全世界发布这些信息

•通信（Wiki、邮件、IM、邮件列表、其他文档）- WIKI、IM、Campfire

•团队规模——小，当产品团队变大时，我们会分解成功能团队

• 会议 - 时间短且不经常，更有可能在走廊聚会

•代码度量——只有圈复杂度

•静态代码分析 - 真正尝试这个 更多使用 FxCop 和 VSTS 的自产

•错误跟踪 - Windows 的 TFS 和 Mac 的 Traq

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-10-23T12:32:15.993

测试：我做了很多系统测试，以及少量的单元测试。我尝试在有意义的时候使用测试驱动开发，但感觉大多数时候它对我正在做的事情的核心没有意义。

至于其余的，我不确定我是否正确地使用了“特定领域的语言”，但我确实使用了很多自动生成的代码来捕获我工作中的重复内容——我统计了 9 个 Perl 脚本几乎生成了100,000 行代码。

至于其余的，团队规模始终是一个。我大约每年使用一次 PC-Lint 进行静态代码分析。我大量使用 gprof 和 valgrind（您似乎没有提到这类工具）。多年来，我一直在寻找一个合适的错误跟踪系统，但目前仍在使用待办事项列表软件和电子邮件来处理它。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-10-23T15:47:04.057

*   测试驱动开发：没有。
*   领域驱动设计：否
*   模型驱动设计/架构：我们确实从应用程序的模型开始
*   你测试吗？是的。有时我是唯一一个测试我的东西的人。我讨厌这个。
*   单元测试 - 没有。这是我技能中缺乏的一个领域，我认为需要优先解决。
*   集成测试 - 否
*   验收测试 - 有时。即使有来自 On High 的威胁，也很难让用户接受它。
*   代码审查 - 没有。我们已经讨论过这样做，但最终没有这样做。我对此感到沮丧。
*   创新技术 - 没有
*   敏捷——我们有点敏捷，虽然不是通过预先思考的努力
*   结对编程 - 否
*   UML - 我们需要的尽可能少，但我们做模型（我们在这里更加刻意敏捷）。
*   特定领域的语言 - 否
*   需求规范（如何？） - 我们这样做。我的团队有时主要负责收集需求。我们现在通常由业务分析师协助，但并非总是如此。Veep 有时会向我们提出一些我不知道从哪里来的要求。有时它们是从未做过但很久以前就计划好的旧事情。通常将收集到的需求放入由主要用户以及我的团队、业务分析师和副总裁审查的 Word 文档中。
*   持续集成 - 不
*   代码覆盖工具 - 没有
*   贫血领域模型 - 我不熟悉他的，但不熟悉。
*   通信（Wiki、邮件、即时消息、邮件列表、其他文档）- 只需电子邮件和面对面。我最近提出了这个主题，因为我们需要做更多的事情，最好是 wiki。它被放在后面的燃烧器上。
*   努力估计——是的，但我们没有尝试真正追踪它们。这是我缺乏的另一个领域。
*   团队规模 - 3，包括我自己（主管 <- 团队负责人 <- 我）。
*   会议——我们每周见面一次，但并非总是如此。老板通常每周至少单独检查几次。较大的小组会议偶尔举行。当然，我们会根据需要安排会议来讨论项目要求。
*   代码指标 - 不
*   静态代码分析 - 不
*   错误跟踪 - 我们记录错误。这几乎就是我们的错误跟踪。

就是这样。我们有一些我觉得可以改进的地方。

更新：

在我发布此消息几周后（08 年 11 月上旬），我们的业务分析师因大规模裁员而失业。从那以后，我在现有应用程序中实现了 ELMAH，*最近*开发了一个来帮助跟踪错误（我们也登录到数据库），我喜欢它的易用性、特性和捕获异常的能力。 't catch (这在很大程度上是未使用的，但仍然有很好的覆盖范围)。我仍然在自己研究单元测试——我真的需要加快步伐（我也想学习 MVC，但我主要也是在研究这个）。

我们现在正在设计一个新的应用程序，我正在为 6 个模块中的 3 个（团队负责人正在研究另外 3 个）做一个模拟数据库模式（它将获得一些基本图表）。我不期待它，因为这将由我们三个人（每人 2 个模块）使用 IronSpeed Designer (6.1) 一起开发。IronSpeed 会为我做一些我喜欢的事情，但这并不是快速完成这些事情的唯一方法，它还会做一些我不关心的事情。

其他一切都没有改变。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-06-18T13:44:41.987

我的公司已经采用了大多数“流行语”方法。单元测试、测试驱动开发、Scrum、敏捷、持续集成、代码覆盖分析等。我发现随着团队规模随着经济的变化而变化，我们正在从一个产品跳到另一个产品。经过大量裁员后，我们从 Rally Dev/Scrum 转移到了 Jira/Agile。我们正在使用 Selenium 进行自动化测试，但现在正在研究 Tellenium 和 Google 的 WebDriver。

我们发现了什么？通过了为其创建的所有测试（包括负载测试）的站点，在真正分析时可能会非常低效。经过代码性能分析，我们能够将其中一个站点的服务器资源减少 2/3，并且仍然具有更好的性能。它仍然通过了同样的测试。

前端自动化测试无法捕捉到人类会在几秒钟内注意到的定位问题。当然，我们可以花几个小时编写测试来检查定位。但是测试很脆弱，当页面布局发生变化时必须重写，即使只是一点点。测试通常只是表明代码有效，而不是它有多好。

我曾在使用许多不同技术的大公司和小公司工作过。包括简单的“牛仔编码”。当我们不采用计划和测试方法时，会有更多的错误，但我们移动得更快。我们在数小时内推出更改和修复，而不是几天和一周。

Facebook 每周（星期二）都会进行一次“推送”。最新的代码推送中经常有错误（没有足够的测试？），但他们经常在那个星期四或星期五再次推送以解决任何问题。我的猜测是 Facebook 更接近于“牛仔编码”方法并且它一直在为他们工作。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-06-18T19:38:06.603

*   测试驱动开发——不，是故意的。
*   领域驱动设计——不，我们仍在研究领域。
*   模型驱动设计/架构 - 不
*   你测试吗？- 我们测试构建，并让高级用户进行测试。
*   单元测试 - 没有正式的（没有 nUnit 等）
*   集成测试 - 否
*   验收测试 - 是
*   代码审查 - 偶尔。
*   创新技术 - 随机 SharePoint 工具
*   敏捷 - 是的
*   结对编程 - 否
*   UML - 从不
*   特定领域的语言 - 不
*   需求规范（如何？） - 我们对此保持清醒并进行迭代。我们有一个做一些需求分析的 BA，但通常我们只是邀请客户参加我们的计划和日常会议。没有正式的文档。
*   持续集成 - 是 (cruisecontrol.net)
*   代码覆盖工具 - 否（但我们确实使用 Visual Studio 代码分析）
*   沟通 - 展望
*   努力估计 - 大致，加倍，然后再加倍。
*   团队规模 - 2-4
*   会议 - 每天上午 9 点（scrum！）加上每周计划/审查会议
*   代码指标 - 不
*   错误跟踪 - Bugzilla
*   **源代码控制 - SVN**

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-11-01T19:17:11.140

以下是我的观察：

*   测试驱动开发：否

*   领域驱动设计：是

*   模型驱动设计/架构：是

*   你测试吗？： 是的

*   单元测试：是的

*   集成测试：是

*   验收测试：是

*   代码审查：否

*   创新技术（Spring、Hibernate、Wicket、JSF、WS、REST，...）：是

*   敏捷结对编程：否

*   UML：是的

*   特定领域语言：是

*   需求规范（如何？） 是

*   持续集成：是

*   代码覆盖工具：否

*   贫血域模型：否（这是什么意思？）

*   通信（Wiki、Mail、IM、Mailinglists、其他文档）：Wiki、Mail、IM、Mailinglists

*   努力估计：是

*   团队规模：2-4人

*   会议：每周一固定会议，隔日浮动会议

*   代码指标：是

*   静态代码分析：否

*   错误跟踪：是的

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2010-10-18T18:09:52.573

你看过 NDepend 吗？该工具分析 C# 和 .NET 代码，并带有许多很酷的功能来浏览分析结果。使用 NDepend，您可以编写代码规则，可以[比较代码库的 2 个版本，](http://www.ndepend.com/Features.aspx#BuildComparison)并且可以利用[80 多个代码指标](http://www.ndepend.com/Metrics.aspx)。

此外，该工具还具有几个出色的可视化功能，例如：

依赖图： ![替代文字](https://i.stack.imgur.com/pZT2j.png)

依赖矩阵： ![替代文字](https://i.stack.imgur.com/dwXPE.png)

通过树形映射实现代码度量可视化： ![替代文字](https://i.stack.imgur.com/Wer0h.png)

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2008-10-23T12:49:42.900

很高兴听到 MDA、DDD 和结对编程在任何地方都没有使用：D Martin Fowler 不是上帝，只是有一些奇怪想法的人。

*   测试驱动开发——如果你想
*   单元测试 - 是的
*   代码审查 - kindda
*   创新技术（Spring、Hibernate、Wicket、JSF、WS、REST，...）——是的，Seam
*   UML - 有点
*   持续集成 - 是与否
*   代码覆盖工具 - 是和否

# java - 在 JBoss 中公开 RMI 服务器？

> ID：229482
> 
> 赞同：2
> 
> 时间：2008-10-23T12:01:57.567
> 
> 标签：java, jboss, rmi

我需要从客户端前端访问 RMI 方法。由于不同的原因，我让 JBoss 在服务器端运行。这让我想到使用 JBoss 来公开 RMI 服务器方法。

我对 JBoss 有点陌生，所以我的问题是：需要哪些步骤才能使 RMI 服务器方法对客户端可见？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T14:10:37.650

以下是如何从 JBoss[步骤通过 HTTP 公开任何 RMI 接口](http://docs.huihoo.com/jboss/online_manual/4.0.1/ch2.chapter.html#d0e7226)

# php - 用在同一循环中修改的数组替换 foreach 循环中的数组

> ID：229491
> 
> 赞同：1
> 
> 时间：2008-10-23T12:06:06.950
> 
> 标签：php, loops

```
foreach($arrayOne as $value){
    do function
} 
```

在上面的示例中，我想将 $arrayOne 传递到一个循环中，让一个函数操作删除 $arrayOne 的一些元素，然后让循环传递剩余元素上减少的 $arrayOne 直到循环返回 false .

建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-23T12:16:49.270

你只需要一个函数来删除数组的一些元素吗？

如果是这样，您可以使用[array_filter](http://uk.php.net/array_filter)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-23T13:55:50.740

如果要修改数组项的值，请按引用使用。如果要完全删除数组项，请拆分键/值对。

```
$arrayOne = array('example', 'listing of', 'stuff');

foreach ($arrayOne as $key => &$value) {
    $value .= ' alteration';

    if ($value == 'listing of alteration') {
        unset($arrayOne[ $key ]);
    }

} 
```

上面的代码会将文本“altering”添加到数组中每个项目的末尾。当它匹配“更改列表”时，它还将删除第二个索引。在 PHP 5.2 上测试

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T12:11:04.977

我建议有两个数组，
一个带有数据 - dataarray，
另一个最初为空 - emptyarray
以及第一个 foreachloop 中符合条件的任何内容，你推入第二个数组，最后，清空第一个数组，交换标识符两个数组中的一个（dataarray 变为空数组，反之亦然）并重复，直到您返回 false 或其他

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-23T15:17:03.757

Rabbit 对于使用引用来编辑值和索引以在 foreach 循环中取消设置有正确的答案（我会投票给你，但这是我的第一篇文章，所以我还没有 15 个代表，抱歉）

如果您将引用传递给需要编辑值的函数，请务必记住使用引用。如果要从中删除值，您还需要将数组作为参考传递。

我建议让函数返回布尔值是否删除以防止创建更多引用。例如

```
foreach ($array AS $key => &$value) {
    //& reference only needed if execFunction must edit $value
    if (execFunction(&$value)) { 
        unset($array[$key]);
    } else {
        $value['exec_failed']+=1;
    }
}
unset($value); 
```

$value 引用也将持续超出循环范围，因此尾随未设置。

最后一个想法，听起来好像您想多次循环遍历数组。一定要注意你的循环是如何停止执行的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T17:21:32.243

感谢大家的帮助。最后，unset() 函数在今天的特定需求中对我有用。这是我使用 unset() 的简短故事：

```
//array to be processed
$one=array('1','2','3');
//array of terms previously defined as a group to compare against
$against=array('1','2');

foreach($one as $key=>$value){

    //pull out matching terms   
    $match=array_intersect($one,$against);
    //my need is to sum grouped numbers
    $sum=array_sum($match);
    echo $sum."<br />";

    //remove matching terms from original array
    foreach($match as $key=>$value){
        unset($one[$key]);
    }
}
//now a parent looping function will process the remaining array elements. In this case, the only one left is '3'. 
```

# delegates - 通过委托执行可重写方法时，Invoke() 和 BeginInvoke() 的行为不同

> ID：229508
> 
> 赞同：7
> 
> 时间：2008-10-23T12:14:02.333
> 
> 标签：delegates, virtual, overriding, invoke, begininvoke

谁能告诉我为什么这段代码的行为方式如此？查看代码中嵌入的注释...

我在这里错过了一些非常明显的东西吗？

```
using System;
namespace ConsoleApplication3
{
    public class Program
    {
        static void Main(string[] args)
        {
            var c = new MyChild();
            c.X();
            Console.ReadLine();
        }
    }

    public class MyParent
    {
        public virtual void X()
        {
            Console.WriteLine("Executing MyParent");
        }
    }

    delegate void MyDelegate();

    public class MyChild : MyParent
    {
        public override void X()
        {
            Console.WriteLine("Executing MyChild");
            MyDelegate md = base.X;

            // The following two calls look like they should behave the same,
            //  but they behave differently!    

            // Why does Invoke() call the base class as expected here...
            md.Invoke();

            // ... and yet BeginInvoke() performs a recursive call within
            //  this child class and not call the base class?
            md.BeginInvoke(CallBack, null);
        }

        public void CallBack(IAsyncResult iAsyncResult)
        {
            return;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-23T12:27:44.880

我还没有答案，但我有一个我认为是更清晰的程序来证明奇怪：

```
using System;

delegate void MyDelegate();

public class Program
{
    static void Main(string[] args)
    {
        var c = new MyChild();
        c.DisplayOddity();
        Console.ReadLine();
    }
}

public class MyParent
{
    public virtual void X()
    {
        Console.WriteLine("Executing MyParent.X");
    }
}

public class MyChild : MyParent
{
    public void DisplayOddity()
    {
        MyDelegate md = base.X;

        Console.WriteLine("Calling Invoke()");
        md.Invoke();                // Executes base method... fair enough

        Console.WriteLine("Calling BeginInvoke()");
        md.BeginInvoke(null, null); // Executes overridden method!
    }

    public override void X()
    {
        Console.WriteLine("Executing MyChild.X");
    }
} 
```

这不涉及任何递归调用。结果仍然是同样的奇怪：

```
Calling Invoke()
Executing MyParent.X
Calling BeginInvoke()
Executing MyChild.X 
```

（如果您同意这是一个更简单的重现，请随时替换原始问题中的代码，我会将其从我的答案中删除：）

老实说，这对我来说似乎是一个错误。我会多挖一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-01T01:13:30.827

当 Delegate.Invoke 直接调用委托方法时，Delegate.BeginInvoke 在内部使用 ThreadPool.QueueUserWorkItem()。md.Invoke() 只能调用 base.X，因为可以通过 base 关键字在派生类中访问基类的方法。由于线程池启动的委托在您的类外部，因此对其 X 方法的引用会受到重载，就像下面的代码一样。

```
 public class Program
    {
        static void Main(string[] args)
        {
            MyChild a = new MyChild();
            MyDelegate ma = new MyDelegate(a.X);

            MyParent b = new MyChild();
            MyDelegate mb = new MyDelegate(b.X);

            ma.Invoke();
            mb.Invoke();
            ma.BeginInvoke(CallBack, null);
            mb.BeginInvoke(CallBack, null); //all four calls call derived MyChild.X

            Console.ReadLine();
        }

        public static void CallBack(IAsyncResult iAsyncResult)
        {
            return;
        }
    } 
```

调试到 .NET Framework 代码：http: [//blogs.msdn.com/sburke/archive/2008/01/16/configuring-visual-studio-to-debug-net-framework-source-code.aspx](http://blogs.msdn.com/sburke/archive/2008/01/16/configuring-visual-studio-to-debug-net-framework-source-code.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T14:53:50.700

也许不是您正在寻找的答案，但这似乎有效：

```
ThreadPool.QueueUserWorkItem(x => md()); 
```

或者

```
new Thread(() => md()).Start(); 
```

但是你需要自己做会计:(

# c# - IIS7 通过网络写入共享

> ID：229511
> 
> 赞同：0
> 
> 时间：2008-10-23T12:16:18.723
> 
> 标签：c#, iis-7

我正在从 windows vista 机器开发一个应用程序。Web 应用程序托管在 IIS 中。从该应用程序中，我尝试写入另一台 vista 机器上的网络共享，但我不断收到拒绝访问错误。在共享上，我给了所有人、访客、网络、匿名登录完全控制共享和 ntfs 访问权限。但仍然拒绝访问。

但是，当我从 Visual Studio 启动应用程序时，它可以完美运行，但从 IIS 会抛出拒绝访问。

任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-23T12:36:15.267

这是一个安全问题。如果您不以具有网络权限的用户身份运行，则标准 IIS 用户没有网络权限。考虑这篇[文章](http://imar.spaanjaars.com/QuickDocId.aspx?quickdoc=276)。

# delphi - 如何确定当前光标位置的活动监视器

> ID：229528
> 
> 赞同：4
> 
> 时间：2008-10-23T12:23:49.630
> 
> 标签：delphi, multiple-monitors

我目前有一个应用程序需要知道在多监视器配置中运行时光标所在的监视器。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-23T12:25:10.627

[GetCursorPos](http://msdn.microsoft.com/en-us/library/ms648390.aspx)和[MonitorFromPoint](http://msdn.microsoft.com/en-us/library/ms534603.aspx)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-23T13:10:37.553

不要忘记 Screen.MonitorFromPoint 和 Mouse.CursorPos - 这些 WinAPI 函数封装在 VCL 中。

# mysql - 将表从 MS SQL Server 迁移到 MySQL

> ID：229534
> 
> 赞同：1
> 
> 时间：2008-10-23T12:25:49.813
> 
> 标签：mysql, sql-server, migrate

我必须将表从 MSSQL Server 迁移到 MySql。问题是表很大（6500 万条记录），整个过程耗时太长。有谁知道如何加快速度？有什么有用的工具可以改善这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-23T12:41:05.460

只需要做一次吗？不要浪费太多时间优化，等到它完成后再继续。

需要更频繁地进行吗？然后详细说明您当前使用的工具/技术会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-31T22:28:44.870

这是我将 800K 记录表从 MS Sql Server 迁移到 MySQL 的方法。

创建查询以**表格格式**显示数据：

```
SELECT [PostalCode] + ' ' +
  [StateCode] + '   ' +
  [Latitude] + '    ' +
  [Longitude] + '   ' +
  [CityName]  
FROM [dbo].[PostalCode] 
```

使用 SQL Server Management Studio 执行查询，并选择将结果输出到文件中（菜单：查询 -> 结果到 -> 结果到文件）

文件名必须是 MySQL 中表的名称。文件扩展名无关紧要。

然后使用**mysqlimport.exe**（在 Windows 上）导入数据（该表必须存在于 MySQL 数据库中）：

```
mysqlimport.exe --user=user_name
  --columns=postalcode,statecode,latitude,longitude,cityname 
  --ignore-lines=2 databaseName pathToFile 
```

导入后，我不得不删除表的最后 2 条记录，因为文件末尾包含一些垃圾：（*受影响的 818193 行）*

对于 800K，它非常快：10 秒导出，然后 10 秒导入。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T12:43:25.550

您可以将数据导出为文本，然后使用 mysql load 语句：

将数据本地 infile 加载`'/somefolder/text_file_with_data.txt'`到表 some_table 字段中，这些字段由终止的`'\t'`行终止`'\n'`

或者，如果您将数据文件放在 mysql 服务器上，您可以：

将数据 infile 加载`'/somefolder_on_the_mysql_server/text_file_with_data.txt'`到表 some_table 字段中，这些字段由终止的`'\t'`行终止`'\n'`

我不确定要导出 mssql 的语法是什么

您始终可以以 10,000 或 100,000 个为一组导出。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-23T17:56:49.520

确保 mysql 表最初没有索引；加载完成后添加它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T18:01:43.160

通过在 my.ini 文件中使用这样的语句，在开始插入之前确保 MySQL 表存储文件足够大：

```
innodb_data_file_path=ibdata1:1000M:autoextend 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-23T19:23:00.250

尝试使用 SQL Server 的导入/导出向导生成的 SSIS/DTS 包是否可以将数据从 mssql 中取出并导入 mysql。（使用适当的 OLEDB/ADO 提供程序连接到 MySQL。

周五回家时开始，周末后再回来查看；）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-23T19:27:26.640

确保没有列上有索引，并删除任何外键（如果您使用 InnoDB 作为表类型）以进行导入。

# string - 如何检查字符串是否包含Bash中的子字符串

> ID：229551
> 
> 赞同：3138
> 
> 时间：2008-10-23T12:37:31.787
> 
> 标签：string, bash, shell, substring, sh

我在 Bash 中有一个字符串：

```
string="My string" 
```

如何测试它是否包含另一个字符串？

```
if [ $string ?? 'foo' ]; then
  echo "It's there!"
fi 
```

`??`我不知名的接线员在哪里。我使用`echo`and`grep`吗？

```
if echo "$string" | grep 'foo'; then
  echo "It's there!"
fi 
```

这看起来有点笨拙。

* * *

## 回答 #1

> 赞同：4393
> 
> 时间：2008-10-23T12:55:24.963

如果您使用双括号，您也可以在 case 语句之外使用[Marcus 的答案（* 通配符） ：](https://stackoverflow.com/a/229585/3755692)

```
string='My long string'
if [[ $string == *"My long"* ]]; then
  echo "It's there!"
fi 
```

注意针字符串中的空格需要放在双引号之间，`*`通配符应该在外面。另请注意，使用了一个简单的比较运算符（即`==`），而不是正则表达式运算符`=~`。

* * *

## 回答 #2

> 赞同：839
> 
> 时间：2008-10-23T20:10:53.493

如果您更喜欢正则表达式方法：

```
string='My string';

if [[ $string =~ "My" ]]; then
   echo "It's there!"
fi 
```

* * *

## 回答 #3

> 赞同：445
> 
> 时间：2008-10-23T12:47:04.310

我不确定是否使用 if 语句，但您可以使用 case 语句获得类似的效果：

```
case "$string" in 
  *foo*)
    # Do stuff
    ;;
esac 
```

* * *

## 回答 #4

> 赞同：299
> 
> 时间：2013-12-08T23:06:09.210

# `stringContain`变体（兼容或独立于大小写）

由于这些 Stack Overflow 的答案主要讲述了[Bash](https://en.wikipedia.org/wiki/Bash_%28Unix_shell%29)，我在这篇文章的最底部发布了一个***独立于案例的 Bash 函数......***

反正有我的

## 兼容的答案

由于已经有很多使用 Bash 特定功能的答案，因此有一种方法可以在功能较差的 shell 下工作，例如[BusyBox](https://en.wikipedia.org/wiki/BusyBox)：

```
[ -z "${string##*$reqsubstr*}" ] 
```

在实践中，这可以给出：

```
string='echo "My string"'
for reqsubstr in 'o "M' 'alt' 'str';do
  if [ -z "${string##*$reqsubstr*}" ] ;then
      echo "String '$string' contain substring: '$reqsubstr'."
    else
      echo "String '$string' don't contain substring: '$reqsubstr'."
    fi
  done 
```

这是在 Bash、[Dash](https://en.wikipedia.org/wiki/Almquist_shell#dash:_Ubuntu,_Debian_and_POSIX_compliance_of_Linux_distributions)、[KornShell](https://en.wikipedia.org/wiki/KornShell) ( `ksh`) 和[ash](https://en.wikipedia.org/wiki/Almquist_shell) (BusyBox) 下测试的，结果始终是：

```
String 'echo "My string"' contain substring: 'o "M'.
String 'echo "My string"' don't contain substring: 'alt'.
String 'echo "My string"' contain substring: 'str'. 
```

### 合一功能

正如@EeroAaltonen 所问，这里是同一演示的一个版本，在相同的外壳下进行了测试：

```
myfunc() {
    reqsubstr="$1"
    shift
    string="$@"
    if [ -z "${string##*$reqsubstr*}" ] ;then
        echo "String '$string' contain substring: '$reqsubstr'.";
      else
        echo "String '$string' don't contain substring: '$reqsubstr'."
    fi
} 
```

然后：

```
$ myfunc 'o "M' 'echo "My String"'
String 'echo "My String"' contain substring 'o "M'.

$ myfunc 'alt' 'echo "My String"'
String 'echo "My String"' don't contain substring 'alt'. 
```

**注意：**您必须转义或双引号和/或双引号：

```
$ myfunc 'o "M' echo "My String"
String 'echo My String' don't contain substring: 'o "M'.

$ myfunc 'o "M' echo \"My String\"
String 'echo "My String"' contain substring: 'o "M'. 
```

## 简单的功能

这是在 BusyBox、Dash，当然还有 Bash 下测试的：

```
stringContain() { [ -z "${2##*$1*}" ]; } 
```

那么现在：

```
$ if stringContain 'o "M3' 'echo "My String"';then echo yes;else echo no;fi
no
$ if stringContain 'o "M' 'echo "My String"';then echo yes;else echo no;fi
yes 
```

...或者如果提交的字符串可能是空的，正如@Sjlver 所指出的那样，该函数将变为：

```
stringContain() { [ -z "${2##*$1*}" ] && [ -z "$1" -o -n "$2" ]; } 
```

或如[Adrian Günter 的评论](https://stackoverflow.com/posts/comments/86532588)所建议的那样，避免`-o`开关：

 ~~~~```
stringContain() { [ -z "${2##*$1*}" ] && { [ -z "$1" ] || [ -n "$2" ];};} 
```~~  ~~### 最终（简单）功能：

并反转测试以使它们可能更快：

```
stringContain() { [ -z "$1" ] || { [ -z "${2##*$1*}" ] && [ -n "$2" ];};} 
```

使用空字符串：

```
$ if stringContain '' ''; then echo yes; else echo no; fi
yes
$ if stringContain 'o "M' ''; then echo yes; else echo no; fi
no 
```

## 大小写无关（仅限 Bash！）

要在不区分大小写的情况下测试字符串，只需将每个字符串转换为小写即可：

```
stringContain() {
    local _lc=${2,,}
    [ -z "$1" ] || { [ -z "${_lc##*${1,,}*}" ] && [ -n "$2" ] ;} ;} 
```

查看：

```
stringContain 'o "M3' 'echo "my string"' && echo yes || echo no
no
stringContain 'o "My' 'echo "my string"' && echo yes || echo no
yes
if stringContain '' ''; then echo yes; else echo no; fi
yes
if stringContain 'o "M' ''; then echo yes; else echo no; fi
no 
```

* * *

## 回答 #5

> 赞同：176
> 
> 时间：2008-10-27T14:57:44.833

您应该记住，shell 脚本与其说是一种语言，不如说是一组命令。您本能地认为这种“语言”要求您遵循`if`a`[`或 a `[[`。这两个只是返回指示成功或失败的退出状态的命令（就像所有其他命令一样）。出于这个原因，我会使用`grep`，而不是`[`命令。

做就是了：

```
if grep -q foo <<<"$string"; then
    echo "It's there"
fi 
```

既然您正在考虑`if`测试其后命令的退出状态（用分号完成），为什么不重新考虑您正在测试的字符串的来源呢？

```
## Instead of this
filetype="$(file -b "$1")"
if grep -q "tar archive" <<<"$filetype"; then
#...

## Simply do this
if file -b "$1" | grep -q "tar archive"; then
#... 
```

该`-q`选项使 grep 不输出任何内容，因为我们只需要返回码。`<<<`使shell扩展下一个单词并将其用作命令的输入，这是here文档的单行版本`<<`（我不确定这是标准还是Bashism）。

* * *

## 回答 #6

> 赞同：98
> 
> 时间：2008-10-23T14:35:45.400

公认的答案是最好的，但由于有不止一种方法可以做到这一点，这里有另一种解决方案：

```
if [ "$string" != "${string/foo/}" ]; then
    echo "It's there!"
fi 
```

`${var/search/replace}`是`$var`与`search`替换为的第一个实例`replace`，如果找到它（它不会改变`$var`）。如果你尝试用空替换`foo`，并且字符串已经改变，那么显然`foo`已经找到了。

* * *

## 回答 #7

> 赞同：74
> 
> 时间：2014-08-27T19:42:38.477

所以这个问题有很多有用的解决方案——但哪个最快/使用最少的资源？

使用此框架重复测试：

```
/usr/bin/time bash -c 'a=two;b=onetwothree; x=100000; while [ $x -gt 0 ]; do TEST ; x=$(($x-1)); done' 
```

每次更换 TEST：

```
[[ $b =~ $a ]]           2.92 user 0.06 system 0:02.99 elapsed 99% CPU

[ "${b/$a//}" = "$b" ]   3.16 user 0.07 system 0:03.25 elapsed 99% CPU

[[ $b == *$a* ]]         1.85 user 0.04 system 0:01.90 elapsed 99% CPU

case $b in *$a):;;esac   1.80 user 0.02 system 0:01.83 elapsed 99% CPU

doContain $a $b          4.27 user 0.11 system 0:04.41 elapsed 99%CPU 
```

（doContain 在 F. Houri 的回答中）

对于咯咯笑：

```
echo $b|grep -q $a       12.68 user 30.86 system 3:42.40 elapsed 19% CPU !ouch! 
```

因此，无论是在扩展测试还是案例中，简单的替换选项都可以预见地获胜。箱子是便携式的。

管道输出到 100000 个 greps 是可以预见的痛苦！关于无需使用外部实用程序的旧规则仍然适用。

* * *

## 回答 #8

> 赞同：31
> 
> 时间：2012-12-01T15:41:25.683

这也有效：

```
if printf -- '%s' "$haystack" | egrep -q -- "$needle"
then
  printf "Found needle in haystack"
fi 
```

阴性测试是：

```
if ! printf -- '%s' "$haystack" | egrep -q -- "$needle"
then
  echo "Did not find needle in haystack"
fi 
```

我想这种风格更经典一些——更少依赖 Bash shell 的特性。

该`--`参数是纯 POSIX 偏执狂，用于保护类似于选项的输入字符串，例如`--abc`or `-a`。

注意：在紧密循环中，此代码将比使用内部 Bash shell 功能慢*得多*，因为将创建一个（或两个）单独的进程并通过管道连接。

* * *

## 回答 #9

> 赞同：28
> 
> 时间：2018-10-05T18:54:36.850

Bash 4+ 示例。注意：当单词包含空格等时，不使用引号会导致问题。始终在 Bash、IMO 中引用。

以下是 Bash 4+ 的一些示例：

示例 1，检查字符串中的“是”（不区分大小写）：

```
 if [[ "${str,,}" == *"yes"* ]] ;then 
```

示例 2，检查字符串中的“是”（不区分大小写）：

```
 if [[ "$(echo "$str" | tr '[:upper:]' '[:lower:]')" == *"yes"* ]] ;then 
```

示例 3，检查字符串中的“是”（区分大小写）：

```
 if [[ "${str}" == *"yes"* ]] ;then 
```

示例 4，检查字符串中的“是”（区分大小写）：

```
 if [[ "${str}" =~ "yes" ]] ;then 
```

示例 5，完全匹配（区分大小写）：

```
 if [[ "${str}" == "yes" ]] ;then 
```

示例 6，完全匹配（不区分大小写）：

```
 if [[ "${str,,}" == "yes" ]] ;then 
```

示例 7，完全匹配：

```
 if [ "$a" = "$b" ] ;then 
```

示例 8，通配符匹配 .ext（不区分大小写）：

```
 if echo "$a" | egrep -iq "\.(mp[3-4]|txt|css|jpg|png)" ; then 
```

享受。

* * *

## 回答 #10

> 赞同：23
> 
> 时间：2014-12-31T22:32:14.613

正如[保罗](https://stackoverflow.com/questions/229551/how-to-check-if-a-string-contains-a-substring-in-bash/25535717#25535717)在他的性能比较中提到的：

```
if echo "abcdefg" | grep -q "bcdef"; then
    echo "String contains is true."
else
    echo "String contains is not true."
fi 
```

[这是符合 POSIX 的，就像Marcus 提供的答案](https://stackoverflow.com/questions/229551/how-to-check-if-a-string-contains-a-substring-in-bash/229585#229585)中的 'case "$string" 一样，但它比 case 语句的答案更容易阅读。另请注意，这将比使用 case 语句慢得多。正如保罗指出的那样，不要在循环中使用它。

* * *

## 回答 #11

> 赞同：20
> 
> 时间：2009-02-09T06:15:45.083

这个怎么样：

```
text="   <tag>bmnmn</tag>  "
if [[ "$text" =~ "<tag>" ]]; then
   echo "matched"
else
   echo "not matched"
fi 
```

* * *

## 回答 #12

> 赞同：12
> 
> 时间：2013-08-26T10:13:42.567

[这个 Stack Overflow 答案](https://stackoverflow.com/a/229606/65706)是唯一一个捕获空格和破折号字符的答案：

```
# For null cmd arguments checking   
to_check=' -t'
space_n_dash_chars=' -'
[[ $to_check == *"$space_n_dash_chars"* ]] && echo found 
```

* * *

## 回答 #13

> 赞同：12
> 
> 时间：2015-04-28T19:55:58.883

```
[[ $string == *foo* ]] && echo "It's there" || echo "Couldn't find" 
```

* * *

## 回答 #14

> 赞同：11
> 
> 时间：2011-11-11T05:51:10.990

一种是：

```
[ $(expr $mystring : ".*${search}.*") -ne 0 ] && echo 'yes' ||  echo 'no' 
```

* * *

## 回答 #15

> 赞同：7
> 
> 时间：2019-12-04T15:14:29.443

由于[POSIX](http://stackoverflow.com/questions/2829613/how-do-you-tell-if-a-string-contains-another-string-in-unix-shell-scripting) /BusyBox 问题在没有提供正确答案的情况下关闭（恕我直言），我将在此处发布答案。

**最短的答案是：**

```
[ ${_string_##*$_substring_*} ] || echo Substring found! 
```

*或者*

```
[ "${_string_##*$_substring_*}" ] || echo 'Substring found!' 
```

请注意，对于某些 shell ( ) ，***双重哈希***是**强制性的。**上面将在未找到子字符串时`ash`进行评估。`[ stringvalue ]`它不返回错误。当找到子字符串时，结果是空的，它计算`[ ]`. 这将抛出错误代码 1，因为字符串被完全替换（由于`*`）。

**最短更常用的语法：**

```
[ -z "${_string_##*$_substring_*}" ] && echo 'Substring found!' 
```

*或者*

```
[ -n "${_string_##*$_substring_*}" ] || echo 'Substring found!' 
```

**另一个：**

```
[ "${_string_##$_substring_}" != "$_string_" ] && echo 'Substring found!' 
```

*或者*

```
[ "${_string_##$_substring_}" = "$_string_" ] || echo 'Substring found!' 
```

注意*单个*等号！

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2017-01-14T05:36:44.597

我的*.bash_profile*文件以及我如何使用 grep：

如果 PATH 环境变量包括我的两个`bin`目录，不要附加它们，

```
# .bash_profile
# Get the aliases and functions
if [ -f ~/.bashrc ]; then
    . ~/.bashrc
fi

U=~/.local.bin:~/bin

if ! echo "$PATH" | grep -q "home"; then
    export PATH=$PATH:${U}
fi 
```

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2019-02-02T06:03:56.923

此处回答的问题的扩展*[如何判断一个字符串是否包含 POSIX sh 中的另一个字符串？](https://stackoverflow.com/questions/2829613/how-do-you-tell-if-a-string-contains-another-string-in-posix-sh/8811800#8811800)*：

此解决方案适用于特殊字符：

```
# contains(string, substring)
#
# Returns 0 if the specified string contains the specified substring,
# otherwise returns 1.
contains() {
    string="$1"
    substring="$2"

    if echo "$string" | $(type -p ggrep grep | head -1) -F -- "$substring" >/dev/null; then
        return 0    # $substring is in $string
    else
        return 1    # $substring is not in $string
    fi
}

contains "abcd" "e" || echo "abcd does not contain e"
contains "abcd" "ab" && echo "abcd contains ab"
contains "abcd" "bc" && echo "abcd contains bc"
contains "abcd" "cd" && echo "abcd contains cd"
contains "abcd" "abcd" && echo "abcd contains abcd"
contains "" "" && echo "empty string contains empty string"
contains "a" "" && echo "a contains empty string"
contains "" "a" || echo "empty string does not contain a"
contains "abcd efgh" "cd ef" && echo "abcd efgh contains cd ef"
contains "abcd efgh" " " && echo "abcd efgh contains a space"

contains "abcd [efg] hij" "[efg]" && echo "abcd [efg] hij contains [efg]"
contains "abcd [efg] hij" "[effg]" || echo "abcd [efg] hij does not contain [effg]"

contains "abcd *efg* hij" "*efg*" && echo "abcd *efg* hij contains *efg*"
contains "abcd *efg* hij" "d *efg* h" && echo "abcd *efg* hij contains d *efg* h"
contains "abcd *efg* hij" "*effg*" || echo "abcd *efg* hij does not contain *effg*" 
```

* * *

## 回答 #18

> 赞同：6
> 
> 时间：2021-11-30T20:12:44.643

接受的答案是正确的，但很难阅读和理解。
对于与搜索相关的问题，您应该始终在 $haystack成语中使用*$needle 。*
由于其*建议的编辑队列已满*，因此我发布以下内容：

```
haystack='There are needles here.'
if [[ "$haystack" == *"needle"* ]]; then
    echo "It's there!"
fi 
```

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2008-12-21T14:27:17.807

`grep -q`可用于此目的。

同样使用`awk`：

```
string="unix-bash 2389"
character="@"
printf '%s' "$string" | awk -vc="$character" '{ if (gsub(c, "")) { print "Found" } else { print "Not Found" } }' 
```

输出：

> 未找到

```
string="unix-bash 2389"
character="-"
printf '%s' "$string" | awk -vc="$character" '{ if (gsub(c, "")) { print "Found" } else { print "Not Found" } }' 
```

输出：

> 成立

原文来源：[http ://unstableme.blogspot.com/2008/06/bash-search-letter-in-string-awk.html](http://unstableme.blogspot.com/2008/06/bash-search-letter-in-string-awk.html)

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2012-07-01T11:31:45.450

我发现经常需要这个功能，所以我`.bashrc`像这样使用自制的 shell 函数，这样我就可以根据需要经常重复使用它，并且名称很容易记住：

```
function stringinstring()
{
    case "$2" in
       *"$1"*)
          return 0
       ;;
    esac
    return 1
} 
```

要测试`$string1`（例如*abc*）是否包含在`$string2`（例如*123abcABC*）中，我只需要运行`stringinstring "$string1" "$string2"`并检查返回值，例如

```
stringinstring "$str1" "$str2"  &&  echo YES  ||  echo NO 
```

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2016-03-03T19:12:33.617

我喜欢sed。

```
substr="foo"
nonsub="$(echo "$string" | sed "s/$substr//")"
hassub=0 ; [ "$string" != "$nonsub" ] && hassub=1 
```

编辑，逻辑：

*   使用 sed 从字符串中删除子字符串的实例

*   如果新字符串与旧字符串不同，则存在子字符串

* * *

## 回答 #22

> 赞同：5
> 
> 时间：2020-03-17T10:34:37.390

通用**针 haystack**示例跟随着**变量**

```
#!/bin/bash

needle="a_needle"
haystack="a_needle another_needle a_third_needle"
if [[ $haystack == *"$needle"* ]]; then
    echo "needle found"
else
    echo "needle NOT found"
fi 
```

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2020-03-27T10:42:14.977

```
case $string in (*foo*)
  # Do stuff
esac 
```

[这与https://stackoverflow.com/a/229585/11267590](https://stackoverflow.com/a/229585/11267590)的答案相同。但简单的风格也符合 POSIX 标准。

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2010-08-27T19:19:19.380

试试 oobash。

它是一个面向 Bash 4 的 OO 风格的字符串库。它支持德语变音符号。它是用 Bash 编写的。

许多功能可用：`-base64Decode`, `-base64Encode`, `-capitalize`, `-center`, `-charAt`, `-concat`, `-contains`, `-count`, `-endsWith`, `-equals`, `-equalsIgnoreCase`, `-reverse`, `-hashCode`, `-indexOf`, `-isAlnum`, `-isAlpha`, `-isAscii`, `-isDigit`, `-isEmpty`, `-isHexDigit`, `-isLowerCase`, `-isSpace`, , `-isPrintable`, `-isUpperCase`, `-isVisible`, `-lastIndexOf`, `-length`, `-matches`, `-replaceAll`, `-replaceFirst`, `-startsWith`, `-substring`, `-swapCase`, `-toLowerCase`, `-toString`, `-toUpperCase`,`-trim`和`-zfill`.

查看*包含*示例：

```
[Desktop]$ String a testXccc
[Desktop]$ a.contains tX
true
[Desktop]$ a.contains XtX
false 
```

[oobash 可在 Sourceforge.net 获得](http://sourceforge.net/projects/oobash/)。

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2016-11-10T14:56:18.973

精确单词匹配：

```
string='My long string'
exactSearch='long'

if grep -E -q "\b${exactSearch}\b" <<<${string} >/dev/null 2>&1
  then
    echo "It's there"
  fi 
```

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2018-04-11T02:09:50.817

我使用这个函数（不包括但很明显的一个依赖项）。它通过了如下所示的测试。如果函数返回值 > 0，则找到该字符串。您也可以轻松地返回 1 或 0。

```
function str_instr {
   # Return position of ```str``` within ```string```.
   # >>> str_instr "str" "string"
   # str: String to search for.
   # string: String to search.
   typeset str string x
   # Behavior here is not the same in bash vs ksh unless we escape special characters.
   str="$(str_escape_special_characters "${1}")"
   string="${2}"
   x="${string%%$str*}"
   if [[ "${x}" != "${string}" ]]; then
      echo "${#x} + 1" | bc -l
   else
      echo 0
   fi
}

function test_str_instr {
   str_instr "(" "'foo@host (dev,web)'" | assert_eq 11
   str_instr ")" "'foo@host (dev,web)'" | assert_eq 19
   str_instr "[" "'foo@host [dev,web]'" | assert_eq 11
   str_instr "]" "'foo@host [dev,web]'" | assert_eq 19
   str_instr "a" "abc" | assert_eq 1
   str_instr "z" "abc" | assert_eq 0
   str_instr "Eggs" "Green Eggs And Ham" | assert_eq 7
   str_instr "a" "" | assert_eq 0
   str_instr "" "" | assert_eq 0
   str_instr " " "Green Eggs" | assert_eq 6
   str_instr " " " Green "  | assert_eq 1
} 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2020-02-13T00:22:58.900

```
msg="message"

function check {
    echo $msg | egrep [abc] 1> /dev/null

    if [ $? -ne 1 ];
    then 
        echo "found" 
    else 
        echo "not found" 
    fi
}

check 
```

这将发现任何出现的 a 或 b 或 c

# c# - Invoke() 和 BeginInvoke() 有什么区别

> ID：229554
> 
> 赞同：424
> 
> 时间：2008-10-23T12:38:04.530
> 
> 标签：c#, .net, multithreading, invoke, begininvoke

`BeginInvoke()`只是想知道和之间有什么区别`Invoke()`？

主要是每个人的用途。

`BeginInvoke()`编辑：创建线程对象和调用调用和调用委托之间有什么区别？还是它们是同一回事？

* * *

## 回答 #1

> 赞同：609
> 
> 时间：2008-10-23T12:40:02.747

你是说`Delegate.Invoke`/`BeginInvoke`还是`Control.Invoke`/ `BeginInvoke`？

*   `Delegate.Invoke`：在同一个线程上同步执行。
*   `Delegate.BeginInvoke`：在`threadpool`线程上异步执行。
*   `Control.Invoke`：在 UI 线程上执行，但调用线程在继续之前等待完成。
*   `Control.BeginInvoke`：在 UI 线程上执行，调用线程不等待完成。

蒂姆的回答提到了您可能想要使用的时间`BeginInvoke`- 尽管我怀疑它主要面向`Delegate.BeginInvoke`.

对于 Windows 窗体应用程序，我建议您*通常*应该使用`BeginInvoke`. 例如，这样您就不必担心死锁 - 但您需要了解，当您下次查看 UI 时，它可能尚未更新！特别是，您不应修改 UI 线程可能将用于显示目的的数据。例如，如果你有一个`Person`with`FirstName`和`LastName`属性，你做了：

```
person.FirstName = "Kevin"; // person is a shared reference
person.LastName = "Spacey";
control.BeginInvoke(UpdateName);
person.FirstName = "Keyser";
person.LastName = "Soze"; 
```

然后 UI 很可能最终会显示“Keyser Spacey”。（有一个外部机会它可以显示“Kevin Soze”，但只能通过记忆模型的怪异。）

但是，除非您遇到此类问题，否则`Control.BeginInvoke`更容易解决问题，并且可以避免您的后台线程无缘无故地等待。请注意，Windows 窗体团队已保证您可以`Control.BeginInvoke`以“即发即弃”的方式使用 - 即无需调用`EndInvoke`. 一般来说，异步调用并非如此：通常每个 BeginXXX 都应该有一个对应的 EndXXX 调用，通常在回调中。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2008-10-23T12:49:49.360

基于 Jon Skeet 的回复，有时您想要调用委托并等待其执行完成，然后再继续当前线程。在这些情况下，调用调用就是您想要的。

在多线程应用程序中，您可能不希望线程等待委托完成执行，特别是如果该委托执行 I/O（这可能使委托和您的线程阻塞）。

在这些情况下，BeginInvoke 会很有用。通过调用它，您是在告诉委托开始，但是您的线程可以自由地与委托并行执行其他操作。

使用 BeginInvoke 会增加代码的复杂性，但有时改进的性能值得复杂性。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2012-09-11T07:07:32.857

`Control.Invoke()`和之间的区别`Control.BeginInvoke()`是，

*   `BeginInvoke()`将在 GUI 线程上安排异步操作。安排异步操作后，您的代码将继续。一段时间后（您不知道确切的时间）您的异步操作将被执行
*   `Invoke()`将执行您的异步操作（在 GUI 线程上）并等待您的操作完成。

一个合乎逻辑的结论是，您传递给的委托`Invoke()`可以具有输出参数或返回值，而您传递给的委托`BeginInvoke()`则不能（您必须使用 EndInvoke 来检索结果）。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2012-12-14T05:11:39.043

只是给出一个简短的工作示例，以了解它们的差异的影响

```
new Thread(foo).Start();

private void foo()
{
  this.Dispatcher.BeginInvoke(DispatcherPriority.Normal,
    (ThreadStart)delegate()
    {
        myTextBox.Text = "bing";
        Thread.Sleep(TimeSpan.FromSeconds(3));
    });
  MessageBox.Show("done");
} 
```

如果使用**BeginInvoke**，MessageBox 会在文本更新的同时弹出。如果使用**Invoke**，则 MessageBox 在 3 秒睡眠后弹出。因此，显示了异步 ( **BeginInvoke** ) 和同步 ( **Invoke** ) 调用的效果。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-10-23T12:47:01.080

Delegate.BeginInvoke() 将委托的调用异步排队并立即返回控制权。使用 Delegate.BeginInvoke() 时，应在回调方法中调用 Delegate.EndInvoke() 以获取结果。

Delegate.Invoke() 在同一个线程中同步调用委托。

[MSDN 文章](http://msdn.microsoft.com/en-us/library/22t547yb(VS.71).aspx)

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2015-01-06T04:28:15.717

只需添加使用 Invoke() 的原因和时间。

Invoke() 和 BeginInvoke() 都将您指定的代码编组到调度程序线程。

但与 BeginInvoke() 不同的是，Invoke() 会暂停您的线程，直到调度程序执行您的代码。**如果您需要暂停异步操作，直到用户提供某种反馈，您可能需要使用 Invoke()。**

例如，您可以调用 Invoke() 来运行一段显示 OK/Cancel 对话框的代码。在用户单击按钮并且您的编组代码完成后，invoke() 方法将返回，您可以根据用户的响应采取行动。

请参阅 C# 中的 Pro WPF 第 31 章

# c# - 在 C# 中使用全局互斥锁的好模式是什么？

> ID：229565
> 
> 赞同：396
> 
> 时间：2008-10-23T12:41:18.767
> 
> 标签：c#, concurrency, mutex

Mutex 类很容易被误解，全局互斥体更是如此。

创建全局互斥体时使用什么好的、安全的模式？

一个可以工作的

*   无论我的机器所在的语言环境如何
*   保证正确释放互斥锁
*   如果未获取互斥锁，则可选地不会永远挂起
*   处理其他进程放弃互斥锁的情况

* * *

## 回答 #1

> 赞同：432
> 
> 时间：2008-10-23T12:42:14.990

我想确保这是存在的，因为很难做到正确：

```
using System.Runtime.InteropServices;   //GuidAttribute
using System.Reflection;                //Assembly
using System.Threading;                 //Mutex
using System.Security.AccessControl;    //MutexAccessRule
using System.Security.Principal;        //SecurityIdentifier

static void Main(string[] args)
{
    // get application GUID as defined in AssemblyInfo.cs
    string appGuid =
        ((GuidAttribute)Assembly.GetExecutingAssembly().
            GetCustomAttributes(typeof(GuidAttribute), false).
                GetValue(0)).Value.ToString();

    // unique id for global mutex - Global prefix means it is global to the machine
    string mutexId = string.Format( "Global\\{{{0}}}", appGuid );

    // Need a place to store a return value in Mutex() constructor call
    bool createdNew;

    // edited by Jeremy Wiebe to add example of setting up security for multi-user usage
    // edited by 'Marc' to work also on localized systems (don't use just "Everyone") 
    var allowEveryoneRule =
        new MutexAccessRule( new SecurityIdentifier( WellKnownSidType.WorldSid
                                                   , null)
                           , MutexRights.FullControl
                           , AccessControlType.Allow
                           );
    var securitySettings = new MutexSecurity();
    securitySettings.AddAccessRule(allowEveryoneRule);

   // edited by MasonGZhwiti to prevent race condition on security settings via VanNguyen
    using (var mutex = new Mutex(false, mutexId, out createdNew, securitySettings))
    {
        // edited by acidzombie24
        var hasHandle = false;
        try
        {
            try
            {
                // note, you may want to time out here instead of waiting forever
                // edited by acidzombie24
                // mutex.WaitOne(Timeout.Infinite, false);
                hasHandle = mutex.WaitOne(5000, false);
                if (hasHandle == false)
                    throw new TimeoutException("Timeout waiting for exclusive access");
            }
            catch (AbandonedMutexException)
            {
                // Log the fact that the mutex was abandoned in another process,
                // it will still get acquired
                hasHandle = true;
            }

            // Perform your work here.
        }
        finally
        {
            // edited by acidzombie24, added if statement
            if(hasHandle)
                mutex.ReleaseMutex();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：140
> 
> 时间：2011-10-18T15:53:03.507

使用接受的答案，我创建了一个帮助类，因此您可以以与使用 Lock 语句类似的方式使用它。只是想我会分享。

采用：

```
using (new SingleGlobalInstance(1000)) //1000ms timeout on global lock
{
    //Only 1 of these runs at a time
    RunSomeStuff();
} 
```

和助手类：

```
class SingleGlobalInstance : IDisposable
{
    //edit by user "jitbit" - renamed private fields to "_"
    public bool _hasHandle = false;
    Mutex _mutex;

    private void InitMutex()
    {
        string appGuid = ((GuidAttribute)Assembly.GetExecutingAssembly().GetCustomAttributes(typeof(GuidAttribute), false).GetValue(0)).Value;
        string mutexId = string.Format("Global\\{{{0}}}", appGuid);
        _mutex = new Mutex(false, mutexId);

        var allowEveryoneRule = new MutexAccessRule(new SecurityIdentifier(WellKnownSidType.WorldSid, null), MutexRights.FullControl, AccessControlType.Allow);
        var securitySettings = new MutexSecurity();
        securitySettings.AddAccessRule(allowEveryoneRule);
        _mutex.SetAccessControl(securitySettings);
    }

    public SingleGlobalInstance(int timeOut)
    {
        InitMutex();
        try
        {
            if(timeOut < 0)
                _hasHandle = _mutex.WaitOne(Timeout.Infinite, false);
            else
                _hasHandle = _mutex.WaitOne(timeOut, false);

            if (_hasHandle == false)
                throw new TimeoutException("Timeout waiting for exclusive access on SingleInstance");
        }
        catch (AbandonedMutexException)
        {
            _hasHandle = true;
        }
    }

    public void Dispose()
    {
        if (_mutex != null)
        {
            if (_hasHandle)
                _mutex.ReleaseMutex();
            _mutex.Close();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-07-31T16:20:40.980

如果另一个实例已经在运行，此示例将在 5 秒后退出。

```
// unique id for global mutex - Global prefix means it is global to the machine
const string mutex_id = "Global\\{B1E7934A-F688-417f-8FCB-65C3985E9E27}";

static void Main(string[] args)
{

    using (var mutex = new Mutex(false, mutex_id))
    {
        try
        {
            try
            {
                if (!mutex.WaitOne(TimeSpan.FromSeconds(5), false))
                {
                    Console.WriteLine("Another instance of this program is running");
                    Environment.Exit(0);
                }
            }
            catch (AbandonedMutexException)
            {
                // Log the fact the mutex was abandoned in another process, it will still get aquired
            }

            // Perform your work here.
        }
        finally
        {
            mutex.ReleaseMutex();
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2013-03-08T09:21:09.653

Mutex 和 WinApi CreateMutex() 都不适合我。

另一种解决方案：

```
static class Program
{
    [STAThread]
    static void Main()
    {
        if (SingleApplicationDetector.IsRunning()) {
            return;
        }

        Application.Run(new MainForm());

        SingleApplicationDetector.Close();
    }
} 
```

和`SingleApplicationDetector`：

```
using System;
using System.Reflection;
using System.Runtime.InteropServices;
using System.Security.AccessControl;
using System.Threading;

public static class SingleApplicationDetector
{
    public static bool IsRunning()
    {
        string guid = ((GuidAttribute)Assembly.GetExecutingAssembly().GetCustomAttributes(typeof(GuidAttribute), false).GetValue(0)).Value.ToString();
        var semaphoreName = @"Global\" + guid;
        try {
            __semaphore = Semaphore.OpenExisting(semaphoreName, SemaphoreRights.Synchronize);

            Close();
            return true;
        }
        catch (Exception ex) {
            __semaphore = new Semaphore(0, 1, semaphoreName);
            return false;
        }
    }

    public static void Close()
    {
        if (__semaphore != null) {
            __semaphore.Close();
            __semaphore = null;
        }
    }

    private static Semaphore __semaphore;
} 
```

使用 Semaphore 而不是 Mutex 的原因：

> Mutex 类强制执行线程标识，因此互斥锁只能由获取它的线程释放。相反， Semaphore 类不强制执行线程标识。
> 
> << [System.Threading.Mutex](http://msdn.microsoft.com/zh-cn/library/system.threading.mutex.aspx)

参考：[信号量.OpenExisting()](http://msdn.microsoft.com/zh-cn/library/8ye97d5d.aspx)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-09-14T23:56:34.060

有时通过示例学习最有帮助。在三个不同的控制台窗口中运行此控制台应用程序。您将看到您首先运行的应用程序首先获取互斥锁，而其他两个正在等待轮到它们。然后在第一个应用程序中按 enter，您会看到应用程序 2 现在通过获取互斥锁继续运行，但应用程序 3 正在等待轮到它。在应用程序 2 中按 Enter 后，您会看到应用程序 3 继续。这说明了互斥锁的概念，它保护一段代码只能由一个线程（在本例中为进程）执行，例如写入文件。

```
using System;
using System.Threading;

namespace MutexExample
{
    class Program
    {
        static Mutex m = new Mutex(false, "myMutex");//create a new NAMED mutex, DO NOT OWN IT
        static void Main(string[] args)
        {
            Console.WriteLine("Waiting to acquire Mutex");
            m.WaitOne(); //ask to own the mutex, you'll be queued until it is released
            Console.WriteLine("Mutex acquired.\nPress enter to release Mutex");
            Console.ReadLine();
            m.ReleaseMutex();//release the mutex so other processes can use it
        }
    }
} 
```

[![在此处输入图像描述](https://i.stack.imgur.com/LbJAH.png)](https://i.stack.imgur.com/LbJAH.png)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-11-27T23:09:12.347

没有 WaitOne 的解决方案（针对 WPF），因为它可能导致 AbandonedMutexException。此解决方案使用返回 createdNew 布尔值的 Mutex 构造函数来检查互斥体是否已创建。它还使用 GetType().GUID，因此重命名可执行文件不允许多个实例。

全局与本地互斥锁见注释： [https ://docs.microsoft.com/en-us/dotnet/api/system.threading.mutex?view=netframework-4.8](https://docs.microsoft.com/en-us/dotnet/api/system.threading.mutex?view=netframework-4.8)

```
private Mutex mutex;
private bool mutexCreated;

public App()
{
    string mutexId = $"Global\\{GetType().GUID}";
    mutex = new Mutex(true, mutexId, out mutexCreated);
}

protected override void OnStartup(StartupEventArgs e)
{
    base.OnStartup(e);
    if (!mutexCreated)
    {
        MessageBox.Show("Already started!");
        Shutdown();
    }
} 
```

因为 Mutex 实现了 IDisposable 它会自动释放，但为了完整性调用 dispose：

```
protected override void OnExit(ExitEventArgs e)
{
    base.OnExit(e);
    mutex.Dispose();
} 
```

将所有内容移到基类中，并从接受的答案中添加 allowEveryoneRule 。还添加了 ReleaseMutex，尽管它看起来并不真正需要，因为它是由操作系统自动释放的（如果应用程序崩溃并且从不调用 ReleaseMutex，您是否需要重新启动？）。

```
public class SingleApplication : Application
{
    private Mutex mutex;
    private bool mutexCreated;

    public SingleApplication()
    {
        string mutexId = $"Global\\{GetType().GUID}";

        MutexAccessRule allowEveryoneRule = new MutexAccessRule(
            new SecurityIdentifier(WellKnownSidType.WorldSid, null),
            MutexRights.FullControl, 
            AccessControlType.Allow);
        MutexSecurity securitySettings = new MutexSecurity();
        securitySettings.AddAccessRule(allowEveryoneRule);

        // initiallyOwned: true == false + mutex.WaitOne()
        mutex = new Mutex(initiallyOwned: true, mutexId, out mutexCreated, securitySettings);        
    }

    protected override void OnExit(ExitEventArgs e)
    {
        base.OnExit(e);
        if (mutexCreated)
        {
            try
            {
                mutex.ReleaseMutex();
            }
            catch (ApplicationException ex)
            {
                MessageBox.Show(ex.Message, ex.GetType().FullName, MessageBoxButton.OK, MessageBoxImage.Error);
            }
        }
        mutex.Dispose();
    }

    protected override void OnStartup(StartupEventArgs e)
    {
        base.OnStartup(e);
        if (!mutexCreated)
        {
            MessageBox.Show("Already started!");
            Shutdown();
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-10-10T15:54:56.733

全局互斥锁不仅是为了确保应用程序只有一个实例。我个人更喜欢使用 Microsoft.VisualBasic 来确保单实例应用程序，如[创建单实例 WPF 应用程序的正确方法是什么？](https://stackoverflow.com/questions/19147/what-is-the-correct-way-to-create-a-single-instance-wpf-application)（Dale Ragan 回答）...我发现将新应用程序启动时收到的参数传递给初始单实例应用程序更容易。

但是关于这个线程中的一些以前的代码，我宁愿不要在每次我想要锁定它时创建互斥锁。对于单实例应用程序来说可能没问题，但在其他用途​​中，我觉得它有点矫枉过正。

这就是为什么我建议使用此实现：

用法：

```
static MutexGlobal _globalMutex = null;
static MutexGlobal GlobalMutexAccessEMTP
{
    get
    {
        if (_globalMutex == null)
        {
            _globalMutex = new MutexGlobal();
        }
        return _globalMutex;
    }
}

using (GlobalMutexAccessEMTP.GetAwaiter())
{
    ...
} 
```

互斥锁全局包装器：

```
using System;
using System.Reflection;
using System.Runtime.InteropServices;
using System.Security.AccessControl;
using System.Security.Principal;
using System.Threading;

namespace HQ.Util.General.Threading
{
    public class MutexGlobal : IDisposable
    {
        // ************************************************************************
        public string Name { get; private set; }
        internal Mutex Mutex { get; private set; }
        public int DefaultTimeOut { get; set; }
        public Func<int, bool> FuncTimeOutRetry { get; set; }

        // ************************************************************************
        public static MutexGlobal GetApplicationMutex(int defaultTimeOut = Timeout.Infinite)
        {
            return new MutexGlobal(defaultTimeOut, ((GuidAttribute)Assembly.GetExecutingAssembly().GetCustomAttributes(typeof(GuidAttribute), false).GetValue(0)).Value);
        }

        // ************************************************************************
        public MutexGlobal(int defaultTimeOut = Timeout.Infinite, string specificName = null)
        {
            try
            {
                if (string.IsNullOrEmpty(specificName))
                {
                    Name = Guid.NewGuid().ToString();
                }
                else
                {
                    Name = specificName;
                }

                Name = string.Format("Global\\{{{0}}}", Name);

                DefaultTimeOut = defaultTimeOut;

                FuncTimeOutRetry = DefaultFuncTimeOutRetry;

                var allowEveryoneRule = new MutexAccessRule(new SecurityIdentifier(WellKnownSidType.WorldSid, null), MutexRights.FullControl, AccessControlType.Allow);
                var securitySettings = new MutexSecurity();
                securitySettings.AddAccessRule(allowEveryoneRule);

                Mutex = new Mutex(false, Name, out bool createdNew, securitySettings);

                if (Mutex == null)
                {
                    throw new Exception($"Unable to create mutex: {Name}");
                }
            }
            catch (Exception ex)
            {
                Log.Log.Instance.AddEntry(Log.LogType.LogException, $"Unable to create Mutex: {Name}", ex);
                throw;
            }
        }

        // ************************************************************************
        /// <summary>
        /// 
        /// </summary>
        /// <param name="timeOut"></param>
        /// <returns></returns>
        public MutexGlobalAwaiter GetAwaiter(int timeOut)
        {
            return new MutexGlobalAwaiter(this, timeOut);
        }

        // ************************************************************************
        /// <summary>
        /// 
        /// </summary>
        /// <param name="timeOut"></param>
        /// <returns></returns>
        public MutexGlobalAwaiter GetAwaiter()
        {
            return new MutexGlobalAwaiter(this, DefaultTimeOut);
        }

        // ************************************************************************
        /// <summary>
        /// This method could either throw any user specific exception or return 
        /// true to retry. Otherwise, retruning false will let the thread continue
        /// and you should verify the state of MutexGlobalAwaiter.HasTimedOut to 
        /// take proper action depending on timeout or not. 
        /// </summary>
        /// <param name="timeOutUsed"></param>
        /// <returns></returns>
        private bool DefaultFuncTimeOutRetry(int timeOutUsed)
        {
            // throw new TimeoutException($"Mutex {Name} timed out {timeOutUsed}.");

            Log.Log.Instance.AddEntry(Log.LogType.LogWarning, $"Mutex {Name} timeout: {timeOutUsed}.");
            return true; // retry
        }

        // ************************************************************************
        public void Dispose()
        {
            if (Mutex != null)
            {
                Mutex.ReleaseMutex();
                Mutex.Close();
            }
        }

        // ************************************************************************

    }
} 
```

服务员

```
using System;

namespace HQ.Util.General.Threading
{
    public class MutexGlobalAwaiter : IDisposable
    {
        MutexGlobal _mutexGlobal = null;

        public bool HasTimedOut { get; set; } = false;

        internal MutexGlobalAwaiter(MutexGlobal mutexEx, int timeOut)
        {
            _mutexGlobal = mutexEx;

            do
            {
                HasTimedOut = !_mutexGlobal.Mutex.WaitOne(timeOut, false);
                if (! HasTimedOut) // Signal received
                {
                    return;
                }
            } while (_mutexGlobal.FuncTimeOutRetry(timeOut));
        }

        #region IDisposable Support
        private bool disposedValue = false; // To detect redundant calls

        protected virtual void Dispose(bool disposing)
        {
            if (!disposedValue)
            {
                if (disposing)
                {
                    _mutexGlobal.Mutex.ReleaseMutex();
                }

                // TODO: free unmanaged resources (unmanaged objects) and override a finalizer below.
                // TODO: set large fields to null.

                disposedValue = true;
            }
        }
        // TODO: override a finalizer only if Dispose(bool disposing) above has code to free unmanaged resources.
        // ~MutexExAwaiter()
        // {
        //   // Do not change this code. Put cleanup code in Dispose(bool disposing) above.
        //   Dispose(false);
        // }

        // This code added to correctly implement the disposable pattern.
        public void Dispose()
        {
            // Do not change this code. Put cleanup code in Dispose(bool disposing) above.
            Dispose(true);
            // TODO: uncomment the following line if the finalizer is overridden above.
            // GC.SuppressFinalize(this);
        }
        #endregion
    }
} 
```

# security - 关键业务信息和服务可访问性的安全计划

> ID：229571
> 
> 赞同：5
> 
> 时间：2008-10-23T12:44:02.757
> 
> 标签：security, backup

我参与创建基于 Web 的业务解决方案。这个想法是客户将使用它，将他们的业务流程和信息集中到一个地方，并通过系统间通信获得附加的业务价值。简而言之，他们将把它作为日常工作的核心工具，并高度依赖它。

需要解决的一个问题是如何让这个网络系统足够安全，成为我们和客户都满意的替代方案。我正在向曾经或处于相同情况的其他人寻求好的建议。

在我们的特定场景中，我们目前正在研究使用 Java SE 6、Tomcat（作为 Servlet 容器，我们将使用 Wicket 时需要）、Hibernate（与我们的数据库交互）和 MySQL（作为 DBMS）。

我认为其他技术用户也会对这个问题和建议感兴趣。由于许多问题都是关于 HDD 故障、网络可访问性和其他问题的一般问题。

随时提出您的任何建议！我仍然提供一些问题和想法让我们继续前进：

*   该系统需要可通过 Internet 访问。在决定如何托管它时，我们应该考虑什么？（即我们是否需要我们的网络主机有多个物理路径将它们连接到互联网和类似的问题。）
*   有这类事情的检查清单吗？也许是 ISO 标准或通过查看文章/检查清单/学术论文/书籍来了解我们走在正确轨道上的其他方式？
*   在项目的后期，我们认为让在该领域具有丰富经验的人参与是一个好主意。在这种情况下，我们不是在寻找普通的 Web 开发人员。很可能更多的咨询公司会告诉我们他们有能力提供这种专业知识，而不是实际。关于我们如何与合适的人取得联系的任何提示？（我们的总部设在斯堪的纳维亚半岛，所以最好在那里找人。）
*   多高的起床时间才足够好？99.99% 似乎是一个合理的目标。但是任何停机时间都可能导致我们的客户失去业务。
*   我们如何保证每个客户只能访问自己的数据？由于系统将能够访问它自己的数据库，这似乎很难。涉及大量测试的正确开发过程实际上是我们所拥有的关于用户权限的全部内容。
*   我们如何处理硬盘故障？RAID 5 与每日增量备份和每周完整备份相结合是否足够？或者你会选择RAID 6吗？
*   如果一台服务器足以为客户端提供服务。你还会使用集群吗？（我会这么认为。）在这种情况下，集群中有多少个节点？
*   您将使用哪种备份策略？
*   您认为将系统托管在计算机云中是一个不错的选择吗？（即由亚马逊、谷歌或其他公司提供。）
*   你会使用硬盘加密吗？如果是这样，是哪一种？（一个澄清：是的，如果有人偷了硬盘，这只是一件好事，但这仍然增加了安全性，并且可以防止（物理）入侵者访问重要的客户业务数据。）
*   为客户提供一种自己进行备份的方法也是一个不错的选择吗？这些客户不会以技术为导向。那么在这种情况下，下载包含 Microsoft Office 文件的 ZIP 存档中的信息可能是一个好方法吗？
*   您将如何监控解决方案？
*   您认为我们应该在内部做哪些事情，哪些事情应该外包？当然，我们将开发我们自己的核心系统。
*   如果你觉得系统是安全的，作为一个技术人员。您如何让非技术人员相信它是安全可靠的？

感谢您的时间！我希望你有一些意见可以分享。稍后可能会添加更多问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T13:35:32.310

我也在我的个人时间和工作中制作网络应用程序，所以我能理解你为什么问上述问题。虽然在工作中没有讨论上述问题，但我在个人工作中非常关注这些事情。我不能回答你所有的问题，但对于我能回答的问题，我会这样说：

您将如何监控解决方案？我正在开发一个 ASP.NET Web 应用程序，因此我正在使用性能监视器、日志记录、跟踪（尽管仅适用于开发人员）、运行状况监视和我正在编写的自定义 Sql Server 性能监视系统（尽管在此之前得到推出后，我将使用 AdventNet 的 AppManager）。

`Which of these things do you think we should do in house and which should be out sourced? We will develop the core system our self's, of course.`

这是一个很好的问题，因为我一直在做同样的决定。我会将不属于我技能的东西外包（所以如果我需要做 3d 工作，就外包）。此外，坚持团队的优势，专注于业务功能，因为这会取悦/吸引用户（我是从面向家庭用户的网络应用程序的商业角度说的），并将关键的内部系统外包例如备份、监控、日志记录等（由于我有可用的成本/财务资源，我没有将其外包，并且我制作东西以便我可以学习 - 因此即使这是一个长期的方法，也可以自己编写代码 - 但我喜欢它）。

`Are there check lists for these kinds of things? Maybe ISO standards or some other way of seeing that we are on the right track by looking through an article/check list/academic paper/book?`

您说您正在使用 Java/MySQL/Hibernate，但 Microsoft 有一些关于 Web 应用程序安全性的优秀指南，并且通常构建可扩展且安全的应用程序（基于 Web 和 Windows）。查看 Microsoft 模式和实践。

`Do you think hosting the system in a computer cloud is a good alternative? (i.e. as provided by Amazon, Google or others.)`

是的。这既便宜又有效，并且可以减轻您的内部架构的压力（我正在考虑如何使用 CDN 和 Amazon EC2 来存储静态文件）。我说的是静态文件，因此您可以存储不经常更改的内容，并且可以缓存这些内容。

`If you feel that the system is secure, as a technical person. How do you convince a non technical person that it's safe and secure?`

要求他们造成破坏。

`How do we guarantee that each customer only will be able to access its own data? As the system will be able to access it's own database, it seems hard. A proper development process, involving lots of testing, is really all we have regarding user privileges.`

我不确定我是否理解这个问题在问什么，但您可以使用登录系统、成员资格/角色（尽管这只是 ASP.NET）和存储过程来确保用户只能看到他或她自己的数据和不是其他人。

我也会对其余问题的答案感兴趣。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-23T13:51:05.663

免责声明：我不是网络工程师。我跳过了我觉得无法回答的问题

该系统需要可通过 Internet 访问。在决定如何托管它时，我们应该考虑什么？（即我们是否需要我们的网络主机有多个物理路径将它们连接到互联网和类似的问题。）

> 我会根据需要扩大规模。在您的第一阶段，您可能不需要多余的一切。一旦人们依赖您来满足他们的业务需求，请升级您网络中最不稳定的部分。如果您的互联网不可靠，请使用辅助管道。如果你的开关坏了，把它们加倍。

多高的起床时间才足够好？99.99% 似乎是一个合理的目标。但是任何停机时间都可能导致我们的客户失去业务。

> [九号](http://en.wikipedia.org/wiki/Myth_of_the_nines)。不要为正常运行时间支付比停机时间损失更多的费用。如果您因意外停机一个小时而损失 50K，则您应该支付大约 50K 以将停机时间控制在一个小时以内。4 Nines 是一年 52 分钟的停机时间。这对你来说合理吗？五个九是极其困难的。开始的四个九可能更困难。我在一家金融公司工作，我们运行大约 98% 到 99%，计划停机时间的大约 50-80%。我们过得很好。

我们如何保证每个客户只能访问自己的数据？由于系统将能够访问它自己的数据库，这似乎很难。涉及大量测试的正确开发过程实际上是我们所拥有的关于用户权限的全部内容。

> 我们有同样的问题。优秀的开发人员、适当的开发实践、自动化测试、手动测试、开发工具（例如，在公共上下文中使用对象时会引发警告的修饰专有数据的属性）、代码扫描器（例如，寻找使用具有专有数据的表的过程和代码）指标而不引用它），代码审查，等等。

您将使用哪种备份策略？

> 我能负担得起的最好的。如果可能的话，我会说每小时 24 小时，每天 3 周，每周无限。

您认为将系统托管在计算机云中是一个不错的选择吗？（即由亚马逊、谷歌或其他公司提供。）

> Joel 喜欢说您的核心业务不应该外包。如果您的核心业务是存储文件，也许不是。如果你的核心业务是附属于文件，似乎是合理的。

你会使用硬盘加密吗？如果是这样，是哪一种？

> 这只有在有人偷了你的硬盘时才有用，如果他们入侵了你的系统，这将无济于事。您正在错误地查看加密。你不想为了加密而加密——你想要它真正有用的地方。HTTPS 是一种很好的加密方式。也许（-也许-）逐个文档加密每个文档，并要求用户提供密钥来解密它。

为客户提供一种自己进行备份的方法也是一个不错的选择吗？这些客户不会以技术为导向。那么在这种情况下，下载包含 Microsoft Office 文件的 ZIP 存档中的信息可能是一个好方法吗？

> 无论如何，这是一个很好的功能。将其作为备份计费是合理的，但如果您真的想为他们的 netops 提供备份解决方案，它需要比这更强大。

您将如何监控解决方案？

> 向我的黑莓发送 SMS 警报，对使用情况进行完整性检查，有人 24/7 全天候待命，能够对系统进行故障排除。

如果你觉得系统是安全的，作为一个技术人员。您如何让非技术人员相信它是安全可靠的？

> 非技术人员？在整个网站上放置挂锁。或者，说服他们的技术朋友这是安全的（通过让他们看到您的安全性），并让朋友向非技术人员担保。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T13:41:42.980

> 该系统需要可通过 Internet 访问。在决定如何托管它时，我们应该考虑什么？

我会考虑一些事情。首先，您的托管服务提供商需要提供从托管位置到 Internet 的多个独立网络路径。其次，您愿意为您的机器投资什么级别的物理安全？通常，至少在英国，您（大部分）按 U（高度单位）租用 co-lo 空间，这意味着在同一个机架（甚至可能是同一个机房​​）中工作的任何人都可以访问您的机器。如果您租用整个机架，则可以拥有自己的钥匙。

> 多高的起床时间才足够好？99.99% 似乎是一个合理的目标。但是任何停机时间都可能导致我们的客户失去业务。

首先，考虑何时需要存在此正常运行时间。99.99% 听起来不错，但如果客户只需要在周一至周五 08:00-20:00 访问，您的可用性可能会略低于 50%，而不会降低客户满意度。还要考虑到您将不得不进行可能影响应用程序可用性的维护（数据库检查、备份和其他事情），所以我会确保将其包含在服务级别保证中（或者作为“...窗口中的 X% 可用性” ”或“X% 的可用性在宣布的、计划外的中断之外”）。

> 如果一台服务器足以为客户端提供服务。你还会使用集群吗？（我会这么认为。）在这种情况下，集群中有多少个节点？

如果一台服务器在可预见的未来足够好，我个人不会打扰集群，但我会确保在 co-lo 站点上有相同的机器，关闭电源，所以一台机器的修复时间最短。

> 您认为将系统托管在计算机云中是一个不错的选择吗？（即由亚马逊、谷歌或其他公司提供。）

对于数据云提供商的正常运行时间、数据隐私和类似情况，您有什么保证？您不能（或至少不应该）向您的客户保证更多。此外，如果您可以在斯堪的纳维亚托管您的机器，您可能比从美国托管的计算云提供类似服务的人拥有网络优势。老实说，我不知道是否有任何计算云提供商在斯堪的纳维亚拥有服务器，但他们可能很乐意回答这个问题。

> 您认为我们应该在内部做哪些事情，哪些事情应该外包？当然，我们将开发我们自己的核心系统。

“那要看”。您在内部做的越多，您向其他服装支付的费用就越少。另一方面，如果你能找到好的外围服务提供商（数据中心设计，可能是基本机器构建，可能是服务监控，可能是安全监控，可能每周 X 天来更换备份磁带并将旧磁带带到保险箱地点）。在内部做这件事的一个好处是它可以成为你员工的动力。另一方面，如果你的一名或多名员工被公共汽车撞到，你在内部做的越多，你暴露的风险就越大。所以，对于你在内部做的任何事情，确保你至少有两个

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T22:24:06.763

> 该系统需要可通过 Internet 访问。在决定如何托管它时，我们应该考虑什么？（即我们是否需要我们的网络主机有多个物理路径将它们连接到互联网和类似的问题。）

如果您想要 99% 的正常运行时间，那么您会的。我会看一家名为 Server Vault 的公司。

> 有这类事情的检查清单吗？也许是 ISO 标准或通过查看文章/检查清单/学术论文/书籍来了解我们走在正确轨道上的其他方式？

官方清单，不是我见过的。通常，这意味着要针对每场灾难和缓解措施制定政策并制定政策。

> 在项目的后期，我们认为让在该领域具有丰富经验的人参与是一个好主意。在这种情况下，我们不是在寻找普通的 Web 开发人员。很可能更多的咨询公司会告诉我们他们有能力提供这种专业知识，而不是实际。关于我们如何与合适的人取得联系的任何提示？（我们的总部设在斯堪的纳维亚半岛，所以最好在那里找人。）

我会咨询 Internet Security Solutions 或 At Stake。我相信它们遍布世界各地。

> 多高的起床时间才足够好？99.99% 似乎是一个合理的目标。但是任何停机时间都可能导致我们的客户失去业务。

如果您真的希望您的客户让他们的业务依赖于您构建的产品，那么停机时间确实是不可接受的。您可以通过拥有集群服务器和 DR 站点来实现这一点。在这一点上，这对你来说可能是可行的，所以我会说一个月有几个小时的维护窗口是可以接受的。您将不得不检查您的客户所在的位置，因为您可能在半夜为您的客户休息。

> ```
> How do we guarantee that each customer only will be able to access 
> ```
> 
> 自己的数据？由于系统将能够访问它自己的数据库，这似乎很难。涉及大量测试的正确开发过程实际上是我们所拥有的关于用户权限的全部内容。

大量的测试。我建议经常进行渗透测试，以确保您不会在某处留下漏洞。

> 我们如何处理硬盘故障？RAID 5 与每日增量备份和每周完整备份相结合是否足够？或者你会选择RAID 6吗？

我会选择某种类型的 Raid 和多个服务器。如果服务器出现故障，您将需要某种监控来提醒您。根据您托管它的位置，他们可能有某种您可以雇用他们的监控解决方案，因此他们将负责让您知道是否有东西脱机。我建议使用 Nagios 进行服务器监控。

```
If one server is enough to serve the clients. Would you still use a cluster? (I would think so.) And in that case, how many nodes would you have in the cluster? 
```

是的，你永远不知道会发生什么。

```
 Which backup strategy would you use? 
```

具有 DR 站点、日志传送（我知道 sql server 我知道有一个过程可以使多个数据库服务器保持同步）和夜间备份的集群解决方案。所有备份应运至异地并保存至少 7 天。它们还应该被加密以确保数据安全。

```
Do you think hosting the system in a computer cloud is a good alternative? (i.e. as provided by Amazon, Google or others.) 
```

我不知道我是否会相信它们，而且我听说它们非常昂贵。对于任务关键型系统，我使用我所知道的并使用经过验证的技术。这是我的意见。他们可能工作正常。

```
Would you use hard disk encryption? And if so, which kind? (One clarification: Yes it's only good if someone steals the hard disk, but that's still added security and may prevent (physical) intruders access to vital client business data.) 
```

可能不是。它会使服务器速度减慢太多。我宁愿使用我可以信任的托管服务来保证服务器的安全。

```
Is providing the customer with a way to do their own backups as well a good alternative? These customers won't be technically oriented. So in that case downloading the information in a ZIP archive containing Microsoft Office files might be a good way? 
```

提供选项可能会很好，但如果您可以向他们展示全面的备份策略，我会说这就足够了。

```
How would you monitor the solution? 
```

像 Nagios 之类的东西，并聘请托管服务来观察服务器的运行状况。对于 100% 的正常运行时间，它确实需要在 NOC 之类的地方，有人总是在那里监视服务器监视器。

您认为我们应该在内部做哪些事情，哪些事情应该外包？当然，我们将开发我们自己的核心系统。

做你觉得舒服和擅长的事情。这听起来像是编程和测试。我会雇人来做服务器设置、托管和监控。关键是不要选择出价最低的人。和会做好事的人一起去。

```
If you feel that the system is secure, as a technical person. How do you convince a non technical person that it's safe and secure? 
```

您有一套书面的政策和程序可以遵循。您有一个您使用的所有供应商的列表，其中包含从他们那里购买的商品以及它们的运行方式。您确保与您签约的所有供应商都是有信誉的并且有良好的业绩记录。

# xml - 用 Ant 替换多行文本

> ID：229579
> 
> 赞同：4
> 
> 时间：2008-10-23T12:46:17.773
> 
> 标签：xml, ant, replace, comments

我有一个 xml 文件，我需要用 Ant 注释掉整段文本。

有这个 Ant 任务

```
<replace file="${src.dir}/Version.as" 
         token="@revisionPrana" value="${revision}"/> 
```

我用来替换单词，但就我而言，我需要像这样替换整个块：

```
<value>
  <object class="edumatic.backoffice.view.modules.NavigationModuleInfo">
    <property name="url"
     value="edumatic/backoffice/view/modules/support/ExamsNavigationModule.swf"/>
    <property name="icon"
     value="edumatic/backoffice/view/modules/support/assets/book.png" />
    <property name="title" value="Assessments" />
    <property name="pluginID" value="EXAM" />
  </object>
</value>
<value>
  <object class="edumatic.backoffice.view.modules.ContentModuleInfo">
    <property name="url"
     value="edumatic/backoffice/view/modules/support/ExamsContentModule.swf" />
    <property name="pluginID" value="EXAM" />
  </object>
</value> 
```

进入

```
<!--value>
  <object class="edumatic.backoffice.view.modules.NavigationModuleInfo">
    <property name="url"
     value="edumatic/backoffice/view/modules/support/ExamsNavigationModule.swf"/>
    <property name="icon"
     value="edumatic/backoffice/view/modules/support/assets/book.png" />
    <property name="title" value="Assessments" />
    <property name="pluginID" value="EXAM" />
  </object>
</value>
<value>
  <object class="edumatic.backoffice.view.modules.ContentModuleInfo">
    <property name="url"
     value="edumatic/backoffice/view/modules/support/ExamsContentModule.swf" />
    <property name="pluginID" value="EXAM" />
  </object>
</value--> 
```

所以，基本上我需要注释掉整个 XML 块。我可以通过替换任务来做到这一点（将整个块放在属性标记和值中并不起作用）吗？还是有一种快速的方法可以用 ant 读取 xml 并删除一些节点并再次保存 xml？

搜索并替换它不是一种选择，因为有多个值子项，并非所有子项都需要注释掉。

添加类似的属性也不是一个选项，因为 xml 正在由 IOC 容器 (Prana) 解析。也许 prana 会忽略 id="1" 但它仍然很乱，从长远来看我不喜欢凌乱。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-23T13:13:09.390

如果您可以通过正则表达式确定要替换的内容，我建议使用可选任务**replaceregexp**。这是文档：[http](http://ant.apache.org/manual/Tasks/replaceregexp.html) ://ant.apache.org/manual/Tasks/replaceregexp.html 您可以调用它两次，一次用于开始标记，另一次用于结束标记。

替换你的正则表达式*可能有点麻烦，因为你说你不想全部替换*标签，但我认为这是最简单的方法。**

 **另一种选择是创建一个自定义的 ant 任务来做你想做的事。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-24T23:15:29.317

如果它是一个 XML 文件，那么您也可以调用 XSLT 转换

# internet-explorer - 如何使用 SendMessage 刷新 Internet Explorer？

> ID：229590
> 
> 赞同：1
> 
> 时间：2008-10-23T12:48:44.307
> 
> 标签：internet-explorer, refresh, sendmessage

有人知道如何刷新 Internet Explorer（例如按 F5 键）但使用 PostMessage 或 SendMessage 等“后门”吗？Internet Explorer 窗口未激活，因此我无法使用键盘。

谢谢

（语言不重要）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-16T08:03:28.863

使用这个 Vb 脚本

`Set WshShell = WScript.CreateObject("WScript.Shell") WshShell.AppActivate "Iexplore" WshShell.SendKeys "{F5}"`

将其保存到anything.vbs 并运行它

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T14:17:29.773

您可以使用键盘...启动一个宏来执行此操作！

使用自动热键：

```
#^x:: ControlSend Edit1, {Enter}, ahk_class IEFrame 
```

Win+Ctrl+X 刷新窗口。注意我在脚本中有以下设置：

```
SetTitleMatchMode RegEx
SendMode Input 
```

即使窗口没有焦点，它也可以工作。
您还可以循环进行定期刷新。

问题：地址栏必须存在，并且要刷新的URL必须存在......
但这是我找到的最可靠的方式，我尝试了：

```
 #^x:: ControlSend ahk_parent, {F5}, Microsoft Internet Explorer 
```

但它不是每次都有效。奇怪的是，使用最小化的窗口可以更好地工作......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T13:05:20.123

有 IE 插件可以为您自动刷新页面。我发现的拳头随机免费软件工具：[用于 IE 的 AutoRefresher](http://www.download.com/AutoRefresher-for-IE/3000-12777_4-10062693.html)。如果你不喜欢这个特定的，还有其他的可以尝试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-23T12:58:06.520

我想我现在更了解您的需求了。

使用以下内容在您的机器上创建一个新网页：

```
<html>
<head>
    <meta http-equiv="refresh" content="5"/>
</head>
<body>
    <iframe src="http://google.com" height="100%" width="100%" frameborder="0">
            If you see this - Get a new browser.
    </iframe>
</body>
<html> 
```

然后双击以在浏览器窗口中打开它。

如果您是网页的开发者，只需添加您在 HEAD 部分看到的元标记即可自动刷新页面。

# iphone - iPhone 模拟器支持多少种国际语言？

> ID：229594
> 
> 赞同：6
> 
> 时间：2008-10-23T12:49:56.427
> 
> 标签：iphone, ios, simulator

iPhone 模拟器支持多少种国际语言？

选择：设置/常规/国际/语言

我的只列出了英文，但我担心我可能无意中去掉了本地化？

[iPhone/设置/常规/国际/语言 http://i36.tinypic.com/1q50t1.png](http://i36.tinypic.com/1q50t1.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T10:53:31.320

我重新安装了 SDK/Xcode，把 40 个都拿回来了。

（当时是 18 岁，但现在更多了）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-23T13:09:30.800

我的支持 18 种语言。也许尝试重置内容和设置...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T15:36:53.453

我的也是 18 岁，应您在此处截屏的要求，它是： [iPhone Simulator Languages http://img.skitch.com/20081023-1kw7jjymr9sr9dc59eyfqunr5x.jpg](http://img.skitch.com/20081023-1kw7jjymr9sr9dc59eyfqunr5x.jpg)

您是否尝试过重置模拟器菜单中的内容和设置？

# c# - 网络上是否有一个资源列出了所有 ASP.Net 安全问题（XSS 等）并采取了预防措施？

> ID：229596
> 
> 赞同：6
> 
> 时间：2008-10-23T12:51:41.820
> 
> 标签：c#, asp.net, security, web-applications, xss

有这么多攻击站点的方法，如果有一个指南或资源，列出所有已知的漏洞和可能的预防措施，那将很有用。有人知道吗？

另外，是否有可以处理这种事情的库或框架？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-23T13:47:32.707

ASP.NET 可以很好地为您处理大多数安全问题。安全性内置于框架中。我建议阅读一些这样的文章：

*   [.NET 配置文件中的十大安全漏洞](http://www.devx.com/dotnet/Article/32493)
*   [Web.config 文件中的前 10 个应用程序安全漏洞](http://www.codeproject.com/KB/aspnet/application-security.aspx)
*   [.NET 开发人员犯的三大安全错误](http://dotnet.sys-con.com/node/38982)
*   [使用每个开发人员必须知道的十大安全提示来保护您的代码](http://msdn.microsoft.com/en-us/magazine/cc188938.aspx)
*   [ASP.NET 安全性：避免攻击的 8 种方法](http://www.devx.com/security/Article/20898/0/page/2)

在 Google 上搜索有关 ASP.NET、安全性、提示、错误、最佳实践的变体。基本上，确保您处理的最重要的事情是 XSS、web.config 和 SQL 注入。您还应该确保寻找[CSRF 漏洞](https://blog.codinghorror.com/preventing-csrf-and-xsrf-attacks/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T13:10:55.573

查看 www.owasp.org 上的 OWASP 开发指南。它有点过时（2005 年），但它包含有关 Web 应用程序的许多安全问题的信息。

我不知道有任何单个库或框架可以处理这个问题。这实际上取决于您使用的技术和应用程序框架。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T14:38:42.213

我强烈推荐一本书，它很好地涵盖了 ASP.NET 的基础。它不再全面，因为它已有几年的历史，因此不包括 IIS7、ASP.NET AJAX 等较新的东西。但我仍然推荐它，因为对于所有基本的东西，它真的很好地涵盖了它。

它被 Microsoft Press 称为**提高 Web 应用程序安全**性，ISBN 978-0735618428。整个[文本托管在 MSDN 上](http://msdn.microsoft.com/en-us/library/ms994921.aspx)。

[死树版本](https://rads.stackoverflow.com/amzn/click/com/0735618429)和[电子书版本](http://download-ebook.org/index.php?target=desc&ebookid=2159)也可用。

# asp.net-mvc - RE：在 ASP.Net MVC 中使用主题

> ID：229603
> 
> 赞同：1
> 
> 时间：2008-10-23T12:54:38.960
> 
> 标签：asp.net-mvc

我有一个使用主题的 ASP.NET MVC (Beta 1) 网站。当我启动我的网站（我仍在使用 ASP.Net 开发 Web 服务器运行）时，默认页面给了我这个错误：

```
Server Error in '/' Application.
Using themed css files requires a header control on the page. (e.g. <head runat="server" />).
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.

Exception Details: System.InvalidOperationException: Using themed css files requires a header control on the page. (e.g. <head runat="server" />).

Source Error:

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.

Stack Trace:

[InvalidOperationException: Using themed css files requires a header control on the page. (e.g. <head runat="server" />).]
   System.Web.UI.PageTheme.SetStyleSheet() +2458366
   System.Web.UI.Page.OnInit(EventArgs e) +8694828
   System.Web.UI.Control.InitRecursive(Control namingContainer) +333
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +378

Version Information: Microsoft .NET Framework Version:2.0.50727.3053; ASP.NET Version:2.0.50727.3053 
```

我需要对我的路线进行一些更改吗？还是我需要对我的网站做其他事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-23T14:45:32.793

一个更简洁的想法是只拥有一个由 CSS 组成的“主题”。在您的母版页（或单个视图）中链接到相应的 CSS 文件。

例如，我将“主题”保存在站点根目录下的主题目录中。每个主题都存在于自己的文件夹中，并且有一个 main.css。main.css 负责引用所有其他必需的 CSS。所以我的例子中的母版页只是链接到一个 main.css。您甚至可以将 ViewData["theme"] 变量（如果需要）设置为主题名称，因此母版页可以简单地将其用作正确主题目录的占位符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-23T14:06:31.920

该错误告诉您您的 ASP.NET 页面（或母版页）需要有一个 <head runat="server"> 标记。没有它，您将无法使用主题。

由于服务器端标头标签不应该依赖于视图状态（因为它们不包含在表单中），它可能仍然有效。

话虽如此，主题不一定适合 MVC 范式，因此您应该考虑是否真的需要它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T00:03:50.987

这是我的解决方案[http://frugalcoder.us/post/2008/11/ASPNet-MVC-Theming.aspx](http://frugalcoder.us/post/2008/11/ASPNet-MVC-Theming.aspx) 今天刚刚发布了这个...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T12:42:02.513

我喜欢你的想法杰森，谢谢你的提示。这对我来说实际上很容易实现。:)

就像任何试图做我正在/正在做的主题的人的参考一样，我只是将 header 元素添加到 default.aspx 页面，一切都得到了照顾 - 正是 Richard 建议的。

# design-patterns - 应用工作单元模式

> ID：229621
> 
> 赞同：5
> 
> 时间：2008-10-23T13:02:13.110
> 
> 标签：design-patterns, unit-of-work, poeaa

我在企业应用程序架构模式中读到过，工作单元只能在单个会话中使用。所以每个会话都应该有它唯一的工作单元。谁能告诉我为什么我不能为整个应用程序使用一个工作单元（在我的例子中是 ASP.NET）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-23T13:38:24.957

工作单元模式的一半是跟踪事务中的更改，您当然可以跟踪整个应用程序（这似乎很常见），但另一半是解决并发问题，如果您是将模式应用到整个应用程序而不是每个会话级别。
此外，在某些时候，您必须决定“嘿，这是一个单位……提交时间”，当考虑到整个应用程序以及不同的用户同时做不同的事情时，这可能会很困难。

# sql - 使用可选的存储过程参数

> ID：229622
> 
> 赞同：3
> 
> 时间：2008-10-23T13:03:55.010
> 
> 标签：sql, database

我正在研究一个带有几个可选参数的存储过程。其中一些参数是单个值，使用 WHERE 子句很容易，例如：

```
WHERE (@parameter IS NULL OR column = @parameter) 
```

但是，在某些情况下，WHERE 条件更复杂：

```
WHERE (@NewGroupId IS NULL OR si.SiteId IN (SELECT gs.SiteId
FROM [UtilityWeb].[dbo].[GroupSites] AS gs
WHERE gs.GroupId = @NewGroupId)) 
```

当我取消注释这些复杂的 WHERE 子句时，查询执行时间加倍，执行计划变得更加复杂。虽然执行计划并不困扰我，但将查询的执行时间加倍是一个明确的问题。

是否有其他人发现在其存储过程中使用可选参数的最佳实践或模式？

这是动态 SQL 是更好解决方案的实例之一吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-23T13:08:28.417

我会为参数是否可用创建单独的查询。

这将创建更简单的 SQL，优化器会做得更好。

像这样：

```
if (@parameter IS NULL) then begin
   select * from foo
end
else begin
   select * from foo where value = @parameter
end 
```

在您必须像这样重新设计许多参数时，您会选择动态 sql 解决方案，然后还要始终使用参数，您可能会被[SQL-Injection](https://stackoverflow.com/questions/1973/what-is-the-best-way-to-avoid-sql-injection-attacks#2040)错误所困扰。

组合也是可能的。您完整编码并预编译的最有可能使用的查询/查询。所有其他组合都是动态创建的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-23T13:28:12.527

主要问题可能是[参数嗅探](http://omnibuzz-sql.blogspot.com/2006/11/parameter-sniffing-stored-procedures.html)，以及根据您的哪些参数为 NULL 的不同最佳执行计划。尝试使用[RECOMPILE](http://www.sqlmag.com/Article/ArticleID/94369/sql_server_94369.html)运行存储过程。

与某些看法相反，Sql Server[*确实*](http://weblogs.sqlteam.com/jeffs/archive/2008/02/22/sql-server-short-circuit.aspx) [会进行](http://technet.microsoft.com/en-us/cc678236.aspx)短路评估——尽管（与所有查询优化一样）它可能并不完全是您想要的。

顺便说一句 - 我可能会将查询的那部分重写为 JOINed 派生表：

```
SELECT * 
FROM Table as si
JOIN (
  SELECT SiteId
  FROM [UtilityWeb].[dbo].[GroupSites]
  WHERE GroupId = ISNULL(@NewGroupId, GroupId)
  /* --Or, if all SiteIds aren't in GroupSites, or GroupSites is unusually large 
     --this might work better
  SELECT @newGroupId
  UNION ALL
  SELECT SiteId FROM [UtilityWeb].[dbo].[GroupSites]
  WHERE GroupId = @NewGroupId
  */
) as gs ON
  si.SiteId = gs.SiteId 
```

它可能会或可能不会影响查询计划，但它对我来说更干净一些。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-23T13:34:10.503

案例陈述是你的朋友……

而不是：

```
if (@parameter IS NULL) then begin
   select * from foo
end
else begin
   select * from foo where value = @parameter
end 
```

您可以使用：

```
SELECT * FROM foo 
WHERE value = CASE WHEN @parameter IS NULL THEN value ELSE @parameter END 
```

或者

```
SELECT * FROM foo 
WHERE value = ISNULL(@parameter,value) 
```

我倾向于更多地使用 CASE 语句，因为我的可选参数可能使用某些值而不是 NULL...

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-23T13:11:48.863

在这种情况下，动态 SQL 可能是更好的解决方案，特别是如果存储过程只包装这个查询。

要记住的一件事是 SQL Server 不会在单个查询中对布尔表达式进行短路。在许多语言中，如果 a 为真，“(a) || (b)”将不会导致 b 被评估。类似地，如果 a 为假，“(a) && (b)”将不会导致 b 被评估。在 SQL Server 中，情况并非如此。因此，在您给出的示例中，即使 @NewGroupId 不为空，“或”后端的查询也会被评估。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-23T13:20:54.787

对于少量可选参数，从 GvS 建议的几个静态查询之一中进行条件选择是可以的。

但是，如果有多个参数，这将变得笨拙，因为您需要处理所有排列 - 5 个参数即 32 个静态查询！使用动态 SQL，您可以构建最适合给定参数的精确查询。一定要使用绑定变量！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-08T13:00:27.647

恕我直言，参数嗅探问题可以通过将所有参数复制到变量中来解决；然后不惜一切代价避免直接使用参数，而是使用变量。例子：

```
 create proc ManyParams
(
    @pcol1 int,
    @pcol2 int,
    @pcol3 int
)
as
declare
    @col1 int,
    @col2 int,
    @col3 int

select
    @col1 = @pcol1,
    @col2 = @pcol2,
    @col3 = @pcol3

select 
    col1,
    col2,
    col3
from 
    tbl 
where 
    1 = case when @col1 is null then 1 else case when col1 = @col1 then 1 else 0 end end
and 1 = case when @col2 is null then 1 else case when col2 = @col2 then 1 else 0 end end
and 1 = case when @col3 is null then 1 else case when col3 = @col3 then 1 else 0 end end 
```

# html - CSS 按钮（带背景但需要斜角）

> ID：229623
> 
> 赞同：1
> 
> 时间：2008-10-23T13:03:57.163
> 
> 标签：html, css, xhtml

```
<input type="submit"/>

<style>
input {
  background: url(tick.png) bottom left no-repeat;
  padding-left: 18px;
}
</style> 
```

但是斜面消失了，我怎样才能添加一个图标来提交按钮并保持斜面？
编辑：我希望它看起来像浏览器的默认设置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T13:38:33.440

根据您使用的浏览器/操作系统，使用带有背景的 <.input type="submit" /> 看起来会有所不同。

如果要保留浏览器样式，可以使用 button 元素，它允许 HTML 位于标签内：

```
<button type="submit"><img src="image.gif" /> Text</button>
or 
<button type="submit"><span class="icon"></span> Text</button> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T13:09:44.077

您可以使用边框样式开始：

边框：2px 开头#cccccc；

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T13:14:14.787

对于真正的按钮效果，我还喜欢引入悬停或焦点样式。与@Roburg 提到的类似，我通常会执行以下操作：

```
input#button {
    border: 2px outset rgb(0, 0, 0);
}

input#button:focus {
    border: 2px inset rgb(0, 0, 0);
} 
```

这会产生按钮已被按下的错觉，即使它本身不是真正的按钮。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-23T13:21:25.537

我的旧商店过去常常使用 input type="image" 语法——它作为提交工作。正如我最喜欢的扑克玩家之一喜欢说的那样，“宝贝，你可以吃到饱！” - 任何你想作为图形放在那里的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T13:08:18.150

使用边框。例如：

```
INPUT.button {
    BORDER-RIGHT: #999999 1px solid;
    BORDER-TOP: #999999 1px solid;
    FONT-SIZE: 11px;
    BACKGROUND: url(tick.png) bottom left no-repeat;
    BORDER-LEFT: #999999 1px solid;
    CURSOR: pointer;
    COLOR: #333333;
    BORDER-BOTTOM: #999999 1px solid
}

<input type="submit" class="button" /> 
```

# iframe - 在不同域中的不安全页面上保护 iframe

> ID：229624
> 
> 赞同：7
> 
> 时间：2008-10-23T13:03:58.347
> 
> 标签：iframe, https, cross-domain, security

我们公司正在考虑允许第三方网站使用我们的在线结账系统。

一位客户表示，他们希望能够使用灯箱样式的弹出窗口来显示结帐。他们希望在网站的每个页面上都可以使用它，因此大多数是不安全的页面。我们的结帐系统和客户站点显然位于不同的域上。

我猜我可以使用安全的 iframe（使用 https）来显示我们的结帐系统。

这个 iframe 真的安全吗？

这样做是明智的吗？（我的直觉说不，因为用户怎么能告诉页面是安全的）

有没有更好的方法来实现同样的功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-23T13:08:04.487

是的，iframe 将是安全的，但您是正确的，客户实际上无法判断它是安全的。另一方面，大多数用户都无法判断页面是否安全——散布在各处的几张挂锁图片足以说服他们中的大多数人。

当他们点击弹出结帐时，您能否将它们发送到 HTTPS 下的相同 url，然后将其弹出（当然，您需要自己的 SSL 证书）？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T19:17:15.630

你见过其他类似的结账系统是如何工作的吗？例如 ebay 上的 paypal 结账？他们会带您通过“全屏”结帐流程，并在交易完成后返回原始站点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-15T12:40:54.320

我知道这是一个老问题，但我打算做同样的事情。解决方法是要么做贝宝的事情 -> 去一个安全的网站进行支付 -> 返回到 return-url。或者，您可以使用一个非常通用的短名称（例如 shop.com）（显然已采用）建立您自己的网站，但该名称并未采用。

然后，您的客户可以拥有自己的空间，例如 https/www.theirsitename.shop.com，
因此他们将从 http/www.theirsitename.com 移至上述空间。

大多数用户甚至无法知道他们已经转移到一个新网站，并且该页面将是安全的。要获得他们的产品，您可以让他们从他们的最后发布它，也许还让他们发布一个 CSS 文件，这将完全改变布局，使其看起来像他们自己的网站。

# linq-to-sql - 实体类从 LINQ 到 SQL 提供程序分离，以实现存储库模式。如何？

> ID：229627
> 
> 赞同：9
> 
> 时间：2008-10-23T13:04:51.513
> 
> 标签：linq-to-sql, design-patterns, repository-pattern, provider, decouple

我查看了存储库模式，我发现了一些我过去使用的想法，这些想法让我感觉很好。

但是现在我想编写一个使用这种模式的应用程序，**但我希望实体类**与存储库提供者分离。

我会创建几个程序集：

1.  一个“接口”程序集，它将承载包括 IRepository 接口在内的通用接口
2.  一个“实体”程序集，它将承载产品、用户、订单等实体类。该程序集将由“接口”程序集引用，因为某些方法将返回此类类型或它们的数组。它也将被主应用程序程序集（例如 Web 应用程序）引用
3.  一个或多个存储库提供程序程序集/程序集。每个都将包括（至少）一个实现 IRepository 接口的类，并且它将与某个数据存储一起使用。数据存储可以包括 SQL Server、Oracle 服务器、MySQL、XML 文件、Web/WCF 服务等。

在我发现生成的类和 CustomDataContext 类之间存在深度依赖之前，研究 LINQ to SQL 看起来在实现所有方面所花费的时间方面看起来非常有成效。

在这种情况下如何使用 LINQ to SQL？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-23T15:56:22.540

我不知道这是否正是您想要的，但您可能想看看 Rob Conery 的 MVC Storefront 代码。他将存储库模式的变体与 linq 提供程序一起使用。他将 LINQ to Sql 对象映射到域对象，然后将域对象从存储库提供者返回到服务层，该服务层包装提供者，允许他在返回的数据到达业务层之前对其进行一些逻辑处理。

[MVC 店面网络广播](http://blog.wekeroad.com/mvc-storefront/)
[代码](http://www.codeplex.com/mvcsamples/SourceControl/ListDownloadableCommits.aspx)

对我来说，听起来您希望提供者返回 DTO，然后您希望将 DTO 映射到存储库/服务层中的域对象。如果是这种情况，您可以将 LINQ to SQL 提供程序映射到 DTO，让它返回它们，然后将 DTO 映射到存储库/服务层中的域对象。这应该可以正常工作，但它可能会变得乏味，因为您现在将有 2 个映射层。

在这种情况下，您将拥有：ProductService，它采用 IProductRepository。它调用 IProductRepository 上的方法来取回您的 DTO。然后它将 DTO 映射到真实的业务对象，并将它们返回给调用代码。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-24T07:33:33.397

您可以创建将数据库映射到任何类的外部 XML 文件：

```
 <?xml version="1.0" encoding="utf-8"?>
 <Database Name="DbName" 
           xmlns="http://schemas.microsoft.com/linqtosql/dbml/2007">
    <Table Name="DbTableName">
       <Type Name="EntityClassName" >
           <Column Name="ID" Type="System.Int64" Member="Id"
                   DbType="BigInt NOT NULL IDENTITY" IsPrimaryKey="true"
                   CanBeNull="false" />
           <Column Name="ColumnName" Type="System.String" Member="PropertyA"
                   DbType="VarChar(1024)" CanBeNull="true" />
       </Type>
    </Table>
 </Database> 
```

然后将 XML 传递给 DataContext 类：

```
 using (var cn = GetDbConnection())
  { var mappingSrc = XmlMappingSource.FromReader(xmlReader);

    using (var db = new DataContext(cn, mappingSrc))
     { var q = from entity in db.GetTable<EntityClassName>()
               where entity.PropertyA = "..."
               select entity.ID;
     }
  } 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-12T12:05:48.967

我在这里找到了一篇很棒的博客文章（有很多好的代码）：http: [//iridescence.no/post/Linq-to-Sql-Programming-Against-an-Interface-and-the-Repository-Pattern.aspx](http://iridescence.no/post/Linq-to-Sql-Programming-Against-an-Interface-and-the-Repository-Pattern.aspx)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-24T08:03:41.963

我认为您需要 POCO（普通旧 CLR 对象）支持。LINQ to SQL 有一个名为[Close2Poco](http://www.codeplex.com/Close2Poco)的适配器。

但我建议切换到实体框架，目前他们也有一个[POCO 适配器](http://code.msdn.microsoft.com/EFPocoAdapter)，但在[v2 中，它预计会得到开箱即用的支持](http://blogs.msdn.com/efdesign/archive/2008/08/01/discussion-about-api-changes-necessary-for-poco.aspx)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-24T06:54:40.793

您不必使用 LINQ to SQL 生成的代码，您可以使用必要的 ColumnAttributes 装饰您自己的类或使用外部 XML 映射文件。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-24T08:19:29.513

最简单的方法是将您的实体与数据上下文分离：加载所需的实体，将其与 DataContext 分离，随意使用它，然后使用 Attach() 将其与 DataContext 耦合以进行保存。

遗憾的是 LINQ 没有将实体与数据上下文分离的方法，但您可以克隆它们，效果很好。最简单的方法是这样的：

```
public static T CloneEntity<T>(T source)
{
  DataContractSerializer dcs = new DataContractSerializer(typeof(T));
  using (Stream stream = new MemoryStream())
  {
    dcs.WriteObject(stream, source);
    stream.Seek(0, SeekOrigin.Begin);
    return (T)dcs.ReadObject(stream);
  }
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-24T17:48:39.867

我用 WCF 做了类似的事情

1 在您的 DBML 上，将您的序列化模式设置为单向

2 将表上的所有列设置为 UpdateCheck=false

3 编写您的服务，如下所示：

```
 `public class Service1 : IService1
    {
        public Company GetCompany(int companyId)
        {
            using (DataClasses1DataContext dc = new DataClasses1DataContext())
            {
                return (from c in dc.Companies where c.CompanyId == companyId select c).Single();
            }
        }

```
 public void SaveCompany(Company company)
    {
        using (DataClasses1DataContext dc = new DataClasses1DataContext())
        {
            dc.Companies.Attach(company, true);
            dc.SubmitChanges();
        }
    }

    public void InsertCompany(Company company)
    {
        using (DataClasses1DataContext dc = new DataClasses1DataContext())
        {
            dc.Companies.InsertOnSubmit(company);
            dc.SubmitChanges();
        }
    }
} 
```` 

4 添加服务引用

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T13:59:12.697

不完全相同的场景，但我正在努力创建一个基于 XML 文件将生成 OO 模型的自定义工具。我的方法是在幕后使用 LINQ to SQL，因为我是自动生成代码的，所以可以很容易地使用另一种机制来假设 MySQL 数据源。由于 LINQ to SQL 不支持它，您将不得不手动编写数据访问代码，但是将使用 OO 模型的客户端代码会以任何方式发生变化。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T14:50:51.113

您的实体类能否实现将在“接口”程序集中声明的 IProduct、IUser、IOrder 等接口？这样，IRepository 接口仅引用业务对象接口（即返回 IProduct 等的集合），并且“接口”程序集与您的其他特定于实现的程序集分离。

# multithreading - Delphi 多线程消息循环

> ID：229630
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2008-10-23T13:05:21.310
> 
>         
> 
> 标签：multithreading, delphi, winapi

我的应用程序有几个线程：1）主线程 2）2 个子主线程（每个都有消息循环，如下所示），由 TFQM 使用 3）n 工作线程（简单循环，包含 Sleep()）

我的问题是，当我关闭我的应用程序时，工作线程设法正确退出，但是当我发出 WM_QUIT 关闭它们时，2 个子主线程中的 1 个挂起（从不退出）。

* * *

```
procedure ThreadProcFQM(P: Integer); stdcall;
var
  Msg: TMsg;
 _FQM: TFQM;
begin
  _FQM := Ptr(P);
  try
    _FQM.fHandle := AllocateHwnd(_FQM.WndProc);

    while GetMessage(Msg, 0, 0, 0) do
    begin
      TranslateMessage(Msg);
      DispatchMessage(Msg);
    end;

  finally
    DeallocateHWnd(_FQM.fHandle);
    SetEvent(_FQM.hTerminated);
  end;
end; 
```

* * *

```
procedure TFQM.Stop;
begin
  PostMessage(fHandle, WM_QUIT, 0, 0);

  WaitForSingleObject(hTerminated, INFINITE);
  if hThread <> INVALID_HANDLE_VALUE then
  begin
    CloseHandle(hThread);
    hThread := INVALID_HANDLE_VALUE;
  end;
end; 
```

* * *

## 回答 #1

> 赞同：11
> 
>             
> 
> 时间：2008-10-23T17:10:08.583

如果我可以指出您的代码中的一些问题...

1）您没有检查 AllocateHwnd 的输出。是的，很可能它永远不会失败，但仍然......

2) AllocateHwnd 退出 try..finally！如果失败，则不应调用 DeallocateHwnd。

3) AllocateHwnd 不是线程安全的。如果同时从多个线程调用它，可能会遇到问题。[阅读更多。](http://17slon.com/blogs/gabr/2007/06/allocatehwnd-is-not-thread-safe.html)

正如戴维所说，使用 MsgWaitForMultipleObjects 而不是创建隐藏的消息窗口。然后使用 PostThreadMessage 将消息发送到线程。

如果我可以在这里插入一个完全免费的产品 - 请改用我的[OmniThreadLibrary](http://otl.17slon.com/)。比直接使用 Windows 消息传递要简单得多。

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2008-10-23T13:57:21.110

我遇到了同样的问题，我发现我**不应该**仅仅为了接收消息而创建一个隐藏窗口。线程已经有一个消息系统。

我认为您正在创建 Windows 句柄并将其存储在 fHandle 中，但 GetMessage 会检查您线程的消息循环。因此消息 PostMessage(fHandle, WM_QUIT, 0, 0); getmesssage 永远不会收到。

您可以使用 PostThreadMessage 将消息发布到您的线程，并在线程中使用 GetMessage(CurrentMessage, 0, 0, 0)。唯一重要的区别是您必须通过调用从线程启动消息循环

```
PeekMessage(CurrentMessage, 0, WM_USER, WM_USER, PM_NOREMOVE); 
```

你应该从这个开始，而不是你的设置，而不是开始你的循环。

您应该从 peek 消息开始的原因是确保在线程过程初始化期间发送的消息不会丢失。

奇怪的是，目前我找不到我学到这一点的参考资料，但我猜是新闻组社区。

* * *

## 回答 #3

> 赞同：8
> 
>             
> 
> 时间：2008-10-23T15:50:59.290

1）你不需要在你的线程中 AllocateHwnd 。首次调用 GetMessage 将为该线程创建一个单独的消息队列。但是为了向线程发送消息，您应该使用 PostThreadMessage 函数。

请注意，在调用 PostThreadMessage 的那一刻，仍然无法创建队列。我通常使用构造：

```
while not PostThreadMessage(ThreadID, idStartMessage, 0, 0) do
  Sleep(1); 
```

确保创建了消息队列。

2）为了终止线程循环，我定义了自己的消息：

```
 idExitMessage = WM_USER + 777; // you are free to use your own constant here 
```

3) 不需要单独的事件，因为您可以将线程句柄传递给 WaitForSingleObject 函数。因此，您的代码可能如下所示：

```
 PostThreadMessage(ThreadID, idExitMessage, 0, 0);
  WaitForSingleObject(ThreadHandle, INFINITE); 
```

考虑到 ThreadID 和 ThreadHandle 是不同的值。

4）因此，您的 ThreadProc 将如下所示：

```
procedure ThreadProcFQM; stdcall;
var
  Msg: TMsg;
begin
  while GetMessage(Msg, 0, 0, 0) 
    and (Msg.Message <> idExitMessage) do
  begin
    TranslateMessage(Msg);
    DispatchMessage(Msg);
  end;
end; 
```

# c - 在 **portable C** 中，如何启动将命令的标准输入连接到启动器的标准输出的命令？

> ID：229632
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-10-23T13:05:35.130
> 
>         
> 
> 标签：c, ipc, pipe, portability

在 C 程序 (p1) 中，如何启动从 p1 的标准输出读取其标准输入的动态构造命令（及其参数）？

注意：

1.  除了这个 stdout --> stdin 管道之外的方法也可以**，只要**
    它在 Windows 和 Linux 上是可**移植的。**

2.  我不能在这里使用 C++、Java、Perl、Ruby、Python 等。

此外，这是否会对其 Windows 构建有 MinGW 依赖项？

**REOPENED**：下面的问题为 Linux 提供了答案，但这个问题需要一种可移植的方法。
[从 C 程序中执行程序](https://stackoverflow.com/questions/70842/execute-program-from-within-a-c-program)

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2008-10-23T15:07:10.173

Microsoft C 运行时调用它[`_popen`](http://msdn.microsoft.com/en-us/library/96ayss4b.aspx)而不是[`popen`](http://linux.die.net/man/3/popen)，但它似乎在 Windows（用于控制台应用程序）和 Linux 中具有相同的功能。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-10-23T13:52:18.780

老实说，我并不是 100% 清楚你想要达到的目标。

但据我了解，您可以看看[Boost.Process](http://www.netbsd.org/~jmmv/process/)

你可以做类似的事情

```
 bp::child cs = p.start();
 bp::postream& os = cs.get_stdin(); 
```

然后将*os*用作任何流来将内容转储到子进程的标准输入中。

无论如何，使用库 wrt 管道重定向和链接可以实现很多目标。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T14:53:02.230

链接的分析器（您拒绝）指的是 POSIX 管道。POSIX 是 C 的扩展，它添加了标准 C 中缺少的功能。POSIX 管道是此类功能的一个很好的例子：它们被添加到 POSIX 是因为标准 C 没有该功能。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T16:00:54.903

glib 库是用 C 编写的，其实现在 Linux 和 Windows 上都经过了很好的测试。  [有关生成新进程的手册部分](https://developer.gnome.org/glib/stable/glib-Spawning-Processes.html)将为您提供有关如何使用**g_spawn_async_with_pipes**调用启动新进程并挂钩其标准输入和标准输出句柄的信息。

# windows - 如何将 AltGr 键全局映射到 Alt 键？

> ID：229633
> 
>         
> 
> 赞同：47
> 
>         
> 
> 时间：2008-10-23T13:06:04.210
> 
>         
> 
> 标签：windows, keyboard-shortcuts, autohotkey

我希望我的`AltGr`钥匙的行为与 left 完全一样`Alt`。[通常，我用Autohotkey](http://www.autohotkey.com/)

做这种事情，但我对不同的解决方案持开放态度。  

我试过这个：

```
LControl & RAlt::Alt 
```

并且 Autohotkey 显示有关`Alt`未识别操作的错误。

然后我尝试了以下代码：

```
LControl & RAlt::
  Send {Alt down}
  KeyWait LCtrl
  KeyWait Ralt
  Send {Alt up}
return 
```

哪种有效 - 我可以使用该`AltGr`键访问热键，但它的行为仍然不同：

当我按下并释放 left`Alt`时，当前程序中的第一个菜单项获得焦点。

用这个脚本按下和释放`AltGr`没有任何作用。  

有任何想法吗？这甚至可以使用 Autohotkey 吗？（重新映射左右`Ctrl`兄弟`Shift`姐妹是小菜一碟）

* * *

注意：我尝试在代码中切换`Alt`，`LAlt`但没有任何区别。

* * *

## 回答 #1

> 赞同：53
> 
>             
> 
> 时间：2009-01-20T10:54:45.943

谢谢大家的回答。我无法使用 AutoHotkey 解决这个问题——PhilLho 的答案很接近，但我确实需要与左键完全相同的行为`Alt`。  

但是，[注册表的东西](https://stackoverflow.com/questions/229633/how-to-globally-map-altgr-key-to-alt-key#396859)实际上是按我的需要工作的。  

将此保存为*AltGR_to_LeftAlt.reg*文件并运行它：

```
Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Keyboard Layout]
"Scancode Map"=hex:00,00,00,00,00,00,00,00,02,00,00,00,38,00,38,e0,00,00,00,00 
```

或者，有一个 GUI 工具可以为你做这件事——它被称为[SharpKeys](https://github.com/randyrants/sharpkeys)并且工作得很好：

![SharpKeys 在行动](https://i361.photobucket.com/albums/oo51/Stark3000/SharpKeys.png)

哦，别忘了重启或注销——在那之前它不会工作！

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2008-12-28T23:37:40.173

正如 PhiLho 所指出的，Windows 提供了一种通过注册表键重新映射任何键的方法`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Keyboard Layout`。可以在[Scan Code Mapper for Windows](http://www.microsoft.com/whdc/archive/w2kscan-map.mspx)中找到基本概述。更好的描述可能是[对扫描码映射或更改键值的回答](https://web.archive.org/web/20120323030858/www.annoyances.org/exec/forum/win2000/n1019911460)。

我正在使用这种方法将 放在`Windows Key`上`Caps Lock`，因为我的键盘没有 a`Windows Key`并且我不需要`Caps Lock`.

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2008-10-23T16:16:02.407

通过组合两个热键，我得到了一个不错的行为：

```
LControl & RAlt::Send {Alt}
RAlt::Alt 
```

第一个用于独立按键（避免按住...），第二个用作组合（`Alt`+`F`等）。

它并不完美，你不能做像`Ctrl`++`Alt`这样的组合`T`，但也许它足以满足你的需要。

请注意，您可以使用注册表进行永久重新映射。有关示例，请参[见此论坛帖子。](http://www.autohotkey.com/forum/viewtopic.php?t=9150 "cygwin和putty中的问题重映射键")不确定它是否适用于像这样的复合键，但我想我应该提到它......

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2010-06-20T13:48:30.490

这对我有用：

```
LControl & *RAlt::Send {LAlt Down}
LControl & *RAlt Up::Send {LAlt Up} 
```

这用于将其映射到 Windows 键：

```
LControl & *RAlt::Send {LWin Down}
LControl & *RAlt Up::Send {LWin Up} 
```

不过，使用 SharpKeys（见上文）修改注册表更可靠（如果您具有管理员访问权限）。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2008-10-23T13:30:05.970

在AHK，你能做到：

```
LControl & RAlt::! 
```

或者

```
<^>!::! 
```

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2012-10-07T19:11:49.123

如果您想全局映射此键并且不需要为每次更改（但一次）重新启动系统，您可能需要为此编写键盘过滤器驱动程序。看[这里](https://stackoverflow.com/questions/12612355/swap-alt-keys-functionality)。

* * *

## 回答 #7

> 赞同：-1
> 
>             
> 
> 时间：2014-11-08T13:21:55.783

Windows 注册表编辑器 5.00 版：

```
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Keyboard Layout]
"Scancode Map"=hex:00,00,00,00,00,00,00,00,02,00,00,00,38,00,38,e0,00,00,00,00 
```

1.  将上述代码保存在 reg 文件中。

2.  将其合并到注册表中。

3.  重新启动您的电脑。

4.  现在检查。

# windows-server-2008 - 如何克服“符号链接无法访问，因为它的类型被禁用”。获取符号链接的目标时出错？

> ID：229643
> 
>         
> 
> 赞同：58
> 
>         
> 
> 时间：2008-10-23T13:08:42.067
> 
>         
> 
> 标签：windows-server-2008, symlink

继上一个[问题](https://stackoverflow.com/questions/221417/how-do-i-programmatically-access-the-target-path-of-a-windows-symbolic-link)之后，我正在使用 UNC 路径从 Vista 机器上创建 Server 2008 上的符号链接。我可以很好地创建链接。我可以转到 Server 2008 框并双击资源管理器中的链接以打开目标文件。我不能做的是使用 FileCreateW 来获取 UNC 路径链接的句柄（来自 Vista 框）。当我尝试它时，它失败并且 GetLastError() 返回错误代码 1463 (0x5B7)，即：

> 无法跟踪符号链接，因为它的类型已禁用。

如何在 Server 2008 中启用其“类型”（假设错误意味着它所说的）？

* * *

## 回答 #1

> 赞同：69
> 
>             
> 
> 时间：2008-10-23T14:53:15.380

好吧，我找到了答案，尽管将其描述为记录不全是轻描淡写的！

首先，[这篇 TechEd 文章](http://technet.microsoft.com/en-us/library/cc754077.aspx)强调了用户可以“启用或禁用符号链接中可用的四种评估中的任何一种”这一事实。这四个“评估”包括远程到本地和本地到远程。它没有提供有关如何执行此操作的任何线索。

然而，进一步的搜索发现了[这个 fsutil 帮助页面](http://itsvista.com/2007/03/fsutil/)，它确实记录了如何“启用或禁用符号链接中可用的四种评估中的任何一种”。因此，要解决我遇到的问题，我需要**在 Vista 框中**发出以下命令：

```
fsutil behavior set SymlinkEvaluation L2L:1 R2R:1 L2R:1 R2L:1 
```

为了允许完全访问符号链接在本地和远程计算机上指向的位置。

* * *

## 回答 #2

> 赞同：50
> 
>             
> 
> 时间：2010-03-31T20:29:05.023

要添加到[@David Arno 的有用答案](https://stackoverflow.com/a/230047/45375)，基于 W7：

* * *

`fsutil.exe`可以通过简单地运行来显示它需要什么参数：

```
fsutil behavior set /? 
```

要**报告*当前*配置**，请运行`fsutil behavior query SymlinkEvaluation`- 请参阅[@Jake1164 的回答](https://stackoverflow.com/a/24364595/45375)，特别是关于**组策略**如何控制行为。

**符号链接解析行为是在*访问*给定链接**的机器上设置的，而不是在托管它的机器上。

- 即、、和-的**行为代码**含义如下：`fsutil behavior set SymlinkEvaluation``L2L``L2R``R2L``R2R`

*   `L`代表“本地”和`R`“远程”

*   FIRST`L`或`R`-在 -*之前*是`2`指链接本身（与其目标相对）*相对于正在访问链接的机器的*位置。

*   SECOND`L`或`R`-*后面*的`2`- 指的是链接*目标相对于 LINK 本身所在机器的位置*。

因此，例如，执行`fsutil behavior set SymlinkEvaluation R2L`意味着您可以访问链接：

*   位于远程机器上 ( `R`)

*   指向同一台远程机器上的目标 ( `L`)

* * *

与 David 在 Vista 上所经历的不同，我在 W7 上能够通过单独启用 R2R（并且不必启用 R2L）来解析指向另一台远程计算机上的资源的远程链接。

* * *

## 回答 #3

> 赞同：13
> 
>             
> 
> 时间：2014-06-23T11:19:19.977

当我的一个旧程序停止工作时，我最近在我所有的公司 Windows 7 机器上发现了这个问题。经过一番搜索并找到这些设置后，我尝试通过命令行和注册表进行设置，但没有任何缓解。

我发现您可以在提升的提示符下使用该命令：

```
fsutil behavior query SymlinkEvaluation 
```

这将返回这些链接的状态，并且在我的情况下，它们受到组策略的控制！感谢 IT 部门（你 f@$#%$rs）！

![在此处输入图像描述](https://i.stack.imgur.com/LE8th.jpg)

* * *

## 回答 #4

> 赞同：8
> 
>             
> 
> 时间：2015-04-23T07:16:21.783

这些设置也可以直接通过注册表在***HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\FileSystem***进行操作：请参阅 SymlinkLocalToLocalEvaluation、SymlinkLocalToRemoteEvaluation、SymlinkRemoteToLocalEvaluation、SymlinkRemoteToRemoteEvaluation。

如果使用“fsutil 行为查询 SymlinkEvaluation”，您会收到消息 ..“**当前由组策略控制**”...，请检查***HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Filesystems\NTFS***
或简单地在注册表中搜索“Symlink”

* * *

## 回答 #5

> 赞同：5
> 
>             
> 
> 时间：2008-12-17T18:28:37.203

感谢 David 的提示，我迫切地想要解决这个问题，这使得符号链接几乎毫无用处。

应该注意的是，Vista 的默认配置是启用 L2L 和 L2R，但禁用 R2R 和 R2L。

我首先尝试仅启用 R2R，但这还不够。R2L 也必须启用。

我列表中的下一个问题：如何摆脱用于目录链接的 mklink 命令的那个愚蠢的 /D 开关。应该从目标路径名类型自动推断默认链接类型！

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2014-05-19T20:24:46.520

这些设置也可以通过注册表直接操作（需要本地管理员编写）：

注册表项：`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\FileSystem`

注册表值（名称/数据对）：

```
Name                             Type       Data  (1: Enabled; 0: Disabled)
-------------------------------------------------
SymlinkLocalToLocalEvaluation    REG_DWORD     1
SymlinkLocalToRemoteEvaluation   REG_DWORD     1
SymlinkRemoteToLocalEvaluation   REG_DWORD     1
SymlinkRemoteToRemoteEvaluation  REG_DWORD     1 
```

官方文档很难找到，但这似乎是微软官方页面：[Selectively allow the evaluation of a symbolic link](http://gpsearch.azurewebsites.net/default.aspx?policyid=286&ref=1#286)

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2014-07-15T22:34:21.323

仅供参考，如果您有控制 SymlinkEvaluation 设置的组策略，您仍然可以从命令行自己设置它们。它们将在下次重新启动/登录时被 GP 覆盖，但您的设置将在您的用户会话期间工作。

因此，作为一种解决方法，如果您需要将其设置为 GP 规定的内容以外的内容，您甚至可以在登录时运行脚本以在应用 GP 后对其进行设置。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2009-10-08T04:19:14.977

远程连接点默认工作。对于文件，您仍然需要符号链接。

# visual-studio - VS.NET“监视”对象和递归深度

> ID：229654
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-23T13:11:43.590
> 
>         
> 
> 标签：visual-studio, debugging

在 VS.NET 中，当您向手表添加项目时，为什么基属性经常（总是？？）无休止地递归？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2011-05-20T21:29:13.480

您在 Visual Studio 2010 中仍然看到这种行为吗？我记得偶尔会在 2k8 和 2k5 中看到它，但粗略浏览一下我的 2k10 项目，发现在`base`. 有时它们会在下面显示许多级别`base`（在一个实例中为 18 级），并且它似乎是“递归的”，只是因为可见列是`Value`列。

# c# - 将子类的枚举数强制转换为父类的枚举数有错吗？

> ID：229656
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-10-23T13:12:00.750
> 
>         
> 
> 标签：c#, .net, generics, covariance

我的构建中有一个错误，上面写着：

> 错误 12 无法将类型“System.Collections.Generic.IEnumerator<BaseClass>”隐式转换为“System.Collections.Generic.IEnumerator<IParentClass>”。存在显式转换（您是否缺少演员表？）

简单地丢弃它是错误的吗？

这是我的代码：

```
public Dictionary<Int32, BaseClass> Map { get; private set; }

public IEnumerator<BaseClass> GetEnumerator()
        {
            return this.Map.Values.GetEnumerator();
        }

public IEnumerator<IParentClass> IEnumerable<IParentClass>.GetEnumerator()
        {
            return this.GetEnumerator(); // ERROR!
        } 
```

我的问题是，我可以改变这一行：

```
return this.GetEnumerator(); 
```

到：

```
return (IEnumerator<IParentClass>)this.GetEnumerator(); 
```

（没有任何不良副作用）？

**接受的答案：**

我已将功能更改为以下内容（阅读 Jon Skeet 的帖子后）：

```
IEnumerator<IParentClass> IEnumerable<IParentClass>.GetEnumerator()
        {
            return this.Map.Values.Cast<IParentClass>().GetEnumerator();
        } 
```

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2008-10-23T13:16:41.240

不，你不能，因为泛型目前在 C# 中不是协变的。.NET 本身有一些支持（对于委托和接口），但还没有真正使用。

如果您要返回`IEnumerable<BaseClass>`而不是`IEnumerator<BaseClass>`（并假设 .NET 3.5），您可以使用`Enumerable.Cast`- 但您目前需要编写自己的扩展方法，例如

```
public static IEnumerator<TParent> Upcast<TParent, TChild>
    (this IEnumerator<TChild> source)
    where TChild : TParent
{
    while (source.MoveNext())
    {
        yield return source.Current;
    }
} 
```

或者，在您的情况下，您可以更早地使用 Cast：

```
return this.Map.Values.Cast<BaseClass>().GetEnumerator(); 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-10-23T13:16:07.730

不，您不能，至少在 C# 3.0 及以下版本中不支持接口变化。请参阅 Eric Lippert 的优秀系列，特别是[这个](http://blogs.msdn.com/ericlippert/archive/2007/10/26/covariance-and-contravariance-in-c-part-five-interface-variance.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-23T13:15:49.197

`IEnumerator<BaseClass>`并且`IEnumerator<ParentClass>`是不相关的，尽管它们的通用参数是。我会改为使用 LINQ`Select`扩展方法，如下所示：

```
return this.Select(x => (IParentClass)x).GetEnumerator(); 
```

或`Cast`扩展方法：

```
return this.Cast<IParentClass>().GetEnumerator(); 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-10-23T13:19:17.147

不，这不安全，请参见下文：

使用 System.Collections.Generic；类 Foo { } 类 Bar : Foo { }

```
static class Program
{
    static IEnumerator<Foo> GetBase() {
        yield return new Foo();
        yield return new Bar();
    }
    static IEnumerator<Bar> GetDerived()
    {
        return (IEnumerator<Bar>)GetBase();
    }
    static void Main()
    {
        var obj = GetDerived(); // EXCEPTION
    }
} 
```

但是，您应该能够使用迭代器块为您进行强制转换吗？

```
static IEnumerator<Bar> GetDerived()
{
    using (IEnumerator<Foo> e = GetBase())
    {
        while (e.MoveNext())
        {
            // or use "as" and only return valid data
            yield return (Bar)e.Current;
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2008-10-23T13:22:59.400

要*解释为什么*这不合适，请使用图片而不是 a `Enumerator`， a `List`。两者都使用泛型 - 编译器不会以与泛型参数相关的特殊方式处理任何一个。

```
void doStuff() {
    List<IParentThing> list = getList();
    list.add(new ChildThing2());
}

List<IParentThing> getList() {
    return new List<ChildThing1>();  //ERROR!
} 
```

第一种方法很好——一个`IParentThing`s 列表应该能够接收一个`ChildThing2`. 但是`ChildThing1`s 的列表不能处理 a `ChildThing2`，或者实际上任何`IParentThing`其他的实现者`ChildThing1`——换句话说，如果`List&lt;ChildThing1>`允许将 a 转换为 a `List&lt;IParent>`，它就必须能够处理 的*所有*子类`IParentThing`，而不仅仅是`IParentThing`and `ChildThing1`。

请注意，Java 泛型除了“我想要一个继承自它的任何东西的列表”之外，还有一种说法是“我想要一个继承自 this 的任何东西的列表”，这允许更有趣（并且在我看来优雅）的解决方案对于一些问题。

# asp.net - ASP.NET 3.5 后退按钮控件/刷新控件（从未找到有效的解决方案）

> ID：229663
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-23T13:14:45.643
> 
>         
> 
> 标签：asp.net, back-button-control

您好，感谢您的宝贵时间。

我花了相当多的时间来寻找一个老问题的答案，即当用户向后导航、向前导航或刷新页面时防止重复发布。我已经看到了很多提出的解决方案，但都没有奏效。

建议的解决方案#1）许多人提供了指示浏览器不缓存页面的方法，包括我拥有的一些书籍。人们经常注意到这并不是一个很好的解决方案，因为用户可以在他们的浏览器中关闭此功能，导致它不响应请求。

建议的解决方案#2）在我的一本书中，它建议使用在 Viewstate 和 Session 中设置的时间戳可以检测过时的页面。此检测确实有效，但“如何处理”部分不起作用：重定向到同一页面，从而重新加载处于原始状态的页面。

我没有发布任何代码，因为我只是在很多版本中转了一圈。

这是我第一次访问这个网站，希望我能找到一些很棒的建议:)

再次感谢您的宝贵时间。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T13:28:30.497

我发现一个有效的解决方案是在页面上放置一个隐藏控件，其中包含 GUID 值。将 GUID 保存到您的数据库记录中，然后每次用户提交数据时，在处理数据之前确保 GUID 是唯一的。

# c++ - 使用外部（非项目）dll 的本机 VC++ 参考如何指定 dll 的路径

> ID：229664
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2008-10-23T13:14:51.617
> 
>         
> 
> 标签：c++, dll, visual-studio-2005, native

我有一个使用 dll 的本机 VC++ 项目（不在项目中）。现在，我必须将 dll 放在“Windows 用来定位 DLL 的搜索路径” 
[链接中](http://msdn.microsoft.com/en-us/library/7d83bc18(VS.80).aspx)

但我不希望 dll 位于可执行文件或当前目录或 windows 或系统目录中。

因此，据此我唯一的选择是将路径添加到 %PATH% 环境变量。

还有其他方法吗？

有没有一种优雅的方法（添加到PATH）？我应该在安装时这样做吗？如果我这样做，我应该担心吗？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2008-10-23T15:37:29.240

总结一下我发现的所有技术：

*   如果您使用托管项目作为启动项目（实际上是我的情况），请使用 Enviroment 类

字符串 temp = "myFullDirectoryPathToDll"; 字符串 temp2 =Environment.GetEnvironmentVariable("PATH") + ";" +温度；Environment.SetEnvironmentVariable("PATH", temp2);

这一点，我认为 MSDN 应该强调，仅在此过程中更改环境变量 PATH。

在 VS 中调试时，appPath 不起作用，请使用属性->调试->环境并合并环境变量
[链接](https://stackoverflow.com/questions/100543/how-do-i-set-specific-environment-variables-when-debugging-in-visual-studio)

*   如果您使用本机：做显式链接 - 对于简单的事情来说似乎很重要，也许在部署
    [链接](http://www.codeguru.com/cpp/w-p/dll/print.php/c99)上使用 appPath 注册键，没有人有一个经过测试和证明的答案

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2008-10-23T13:27:37.347

这里有一些建议：

*   您可以将 dll 作为资源嵌入到主可执行文件中，然后将其解压缩到临时目录并使用 LoadLibrary 从其加载，然后使用 GetProcAddress 获取相关函数地址。

*   您可以使用[SetDllDirectory()](http://msdn.microsoft.com/en-us/library/ms686203(VS.85).aspx)修改主进程搜索路径以包含 DLL 的位置。这避免了必须对系统进行任何全局更改。并再次使用 LoadLibrary/GetProcAddress 来解析函数地址。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T13:17:59.303

如果您知道 DLL 可能位于何处，您可以尝试在运行时使用 LoadLibrary() 加载它，然后使用 GetProcAddress() 绑定到您需要调用的函数。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T13:19:30.203

如果已安装的应用程序将随机内容添加到我的全局 PATH，我将不高兴。因为这会影响所有应用程序，并且可能会产生令人讨厌的副作用。

我所看到的是有一个启动脚本。

该脚本对用户来说看起来和行为就像一个应用程序（所以你仍然可以加倍时钟）。但是脚本设置了适当的路径，然后启动了真正的应用程序。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T17:37:56.360

如果您使用 DelayLoad，则在调用将导致 dll 加载的任何函数之前，请调用 LoadLibrary。这将“启动”应用程序，它不会去搜索它。不需要 GetProcAddress

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2008-10-23T19:35:45.700

如果您从 Windows 快捷方式启动，您可以在“Start in”位置指定 DLL 的路径，同时在“Target”位置指定 .exe 的全名和路径。

如果 .exe 的目录中有需要的 DLL，Windows*应该*也能找到它们，因为我相信 Windows DLL 搜索顺序首先会在 .exe 的路径中查找（当前目录在列表中排名第五）。

我已经多次使用 LoadLibrary/GetProcAddress 方法，我尽量避免使用它，因为它确实需要一些额外的工作——大量的类型定义和类型转换。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2008-10-23T19:43:04.453

延迟加载方法在决定调用时对工作目录起作用`LoadLibrary`。你可以利用它来发挥你的优势。有关搜索路径顺序的详细信息，请参阅[http://msdn.microsoft.com/en-us/library/ms682586(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms682586(VS.85).aspx)。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-01-15T22:01:34.317

我试图在系统注册表中设置应用程序路径。只有当用户有权访问 regedit 时它才能正常工作。并且还修改环境变量PATH。我的测试用户没有修改变量的管理员权限。

# database - MS Access 的实体关系图

> ID：229666
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2008-10-23T13:15:19.540
> 
>         
> 
> 标签：database, ms-access, database-design, entity-relationship

我使用 MySQL 和 MSSQL 已经有一段时间了，并且在设计一些更复杂的项目时使用了各种 CASE 和 UML 工具。

最近一位同事问我是否可以为他的部门提供一个 Access 数据库。应用程序本身并不太复杂，而且 Access 实际上看起来是完成手头任务的理想工具。

除了多年前的几个非常业余的数据库（甚至在我听说过规范化之前）之外，我对 Access 的经验并不多。我已经养成使用 ER 图设计数据库的习惯，并且希望在使用 Access 时也这样做。似乎内置的“关系”视图可以很好地查看关系（呃！），但是您必须先创建表格，这似乎有点违背了这一点。

有没有人知道使用 ERD 直接设计数据库的任何方法，无论是在 Access 中，还是通过使用 3rd 方工具的往返生成？我常用的软件都不支持Access。

我想我已经被使用“真实”数据库宠坏了，但是任何帮助都值得赞赏......

**更新：**我选择了下面的答案，因为它唤起了我对使用 ODBC 进行工作的记忆——我已经使用了可以通过 ODBC 连接的优秀 ArgoUML 应用程序。只是想澄清一下，选择下面的答案并不认可 ModelRight 应用程序，因为我从来不需要安装它。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2008-10-23T13:40:03.640

ModelRight 将为您执行此操作。您可以下载社区版本，该版本将使用 ODBC 和 Mysql 访问任何数据库。

[http://www.modelright.com/downloads.aspx](http://www.modelright.com/downloads.aspx)

我目前将它与 SQL Server 一起使用，效果很好。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-03-04T08:59:25.697

来自 datanamic（erd 工具）的 Dezign 可以读取访问数据库并从中制作图表。不需要 ODBC。本机连接到 ms 访问。

[数据库设计](http://www.datanamic.com)

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2015-10-17T22:26:10.453

您当然可以从图表视图中设计表格。只需右键单击图表中的任何表格并选择设计视图。

要添加表格，您必须先创建表格（但这并不是什么大不了的事，实际上只需要额外单击鼠标左右。）

并且您发现 Access 图表正确显示了左连接，因为 SQL 服务器和您注意到的其他人没有正确显示关系设计器中的左连接。因此，所有重要的连接信息都必须记录在其他“假定”专业工具的其他地方。所以不知何故设法在他们的关系设计师中遗漏了一个最有用和最重要的选择。

因此，任何和所有表格设计都可以从访问关系（图表）视图中完成。您只有“非常轻微”的更改是敲击创建选项卡，然后选择表格设计 - 您必须添加表格。（只需添加 PK id 自动编号）并保存。从那时起，从 Access ERD 视图中，您可以添加表并右键单击以从那时起设计其他所有内容（包括设置关系）。

# c++ - C for 循环的实现方式与其他语言不同？

> ID：229671
> 
>         
> 
> 赞同：13
> 
>         
> 
> 时间：2008-10-23T13:16:52.533
> 
>         
> 
> 标签：c++, c, knuth

我在 Knuth 的“计算机编程艺术”的评论中阅读了以下内容：

“非常‘实用性’意味着想成为 CS 专业的学生必须学习 Kernighan 在设计 C 时的错误，尤其是臭名昭著的事实，即 for 循环反复评估 for 条件，它重复 while 并且无法匹配大多数其他语言的行为它实现了一个 for 循环。”

（[http://www.amazon.com/review/R9OVJAJQCP78N/ref=cm_cr_pr_viewpnt#R9OVJAJQCP78N](http://www.amazon.com/review/R9OVJAJQCP78N/ref=cm_cr_pr_viewpnt#R9OVJAJQCP78N)）

这家伙在说什么？你怎么能实现一个 for 循环，而不仅仅是 for 循环的语法糖？

* * *

## 回答 #1

> 赞同：29
> 
>             
> 
> 时间：2008-10-23T13:26:00.440

考虑一下：

```
for i:=0 to 100 do { ... } 
```

在这种情况下，我们可以通过函数调用替换最终值 100：

```
for i:=0 to final_value() do { ... } 
```

...并且`final_value`-function 只会被调用一次。

然而，在 C 中：

```
for (int i=0; i<final_value(); ++i) // ... 
```

... `final_value`- 函数将在循环中的每次迭代中被调用，因此更详细的做法是一个好习惯：

```
int end = final_value();
for (int i=0; i<end; ++i) // ... 
```

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2008-10-23T14:21:37.520

如果你想要的只是一个简单的计数循环，那么

```
for (i=0; i<100; i++) dostuff(); 
```

会好的，编译器可以优化它。

如果您在 for 语句的 continue 部分使用函数，例如

```
for (i=0; i<strlen(s); i++) dostuff(); 
```

然后每次都会评估该函数，这通常不是一个好主意，因为函数开销会减慢您的进程。有时它会减慢你的进程到无法使用的程度。

如果函数的返回值在迭代过程中不会改变，则将其从循环中提取出来：

```
slen = strlen(s);
for (i=0; i<slen; i++) dostuff(); 
```

但是有时函数会在每次调用时返回不同的值，然后你不希望它从循环中提取：

```
for (isread(fd, &buffer, ISFIRST);
     isstat(fd) >= 0;
     isread(fd, &buffer, ISNEXT)
{
  dostuff(buffer);
} 
```

并且您希望每次都对其进行评估。（基于我所做的工作，这是一个稍微做作的例子，但它显示了潜力）。

C 为您提供了以任何方式滚动循环的原始能力。您必须知道您的循环应该如何工作，并根据您的需要尽可能优化它。

最后一个例子可以表示为一个while循环：

```
isread(fd, &buffer, ISFIRST);
while (isstat(fd) >= 0)
{
  dostuff(buffer);
  isread(fd, &buffer, ISNEXT);
} 
```

但它不是那么整洁，如果我在循环中使用 continue ，那么我必须再次调用迭代 isread 。将整个事情放在一个 for 循环中使它更整洁，并确保迭代 isread 被称为每个循环。

我编写了较低级别的函数，因此它们可以在这样的 for 循环中使用。它将 while 循环的所有元素组合在一起，因此您可以更轻松地理解它。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2008-10-23T13:22:46.953

他可能指的`for i:=0 to N`是迭代集合元素的 for 循环和 for-each 循环。我怀疑所有具有 C 风格 for 循环的语言实际上都是从 C 中获得的。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2008-10-23T13:34:46.147

Magnus 说得对，但还应注意，在大多数语言（C 之前）中，条件是*结束*标准（即“当 i 等于 100 时停止”）。在 C（和大多数后 C 语言）中，它是*继续*标准（即“在 i 小于 100 时继续”）。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2008-10-23T13:32:47.087

也许循环展开？如果您知道 for 循环将执行多少次，您可以从字面上复制并粘贴循环的内容。大多数 while 循环将基于某些条件，而不是从 0 到 N 的简单计数，因此将无法使用此优化。

举这个例子

```
int x;
for (x = 10; x != 0; --x)
{
    printf ("Hello\n");
} 
```

我知道你通常会这样做`x = 0; x <= 10; ++x`，但一切都会在大会中揭晓。

一些伪组装：

```
mov 10, eax
loop:
print "hello"
dec eax
jne loop 
```

在这个例子中，我们不断跳回循环以打印“hello”10 次。但是，我们`jne`每次都在循环周围使用指令评估条件。

如果我们展开它，我们可以简单地放

```
print "hello"
print "hello"
print "hello"
print "hello"
print "hello"
print "hello"
print "hello"
print "hello"
print "hello"
print "hello" 
```

我们不需要任何其他指令，所以它更快。这只是一个简单的例子——我会努力找到一个更好的！

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2008-10-23T13:35:17.787

基本上，C（以及 Java、JavaScript 和许多 C 派生语言）`for`循环确实是循环的语法糖`while`：

```
for (int i = 0; i < max; i++) { DoStuff(); } 
```

这是一个非常流行的成语，严格等同于：

```
int i = 0; while (i < max) { DoStuff(); i++; } 
```

（撇开范围问题，无论如何，这在 C 版本之间发生了变化。）

每次迭代都会评估停止条件。在某些情况下它可能很有趣，但它可能是一个陷阱：我`i < strlen(longConstantString)`在源代码中看到，这是减慢程序速度的主要方法，因为`strlen`它在 C 中是一个代价高昂的函数。

不知何故，`for`循环主要用于运行提前知道多少次，你仍然可以使用`break`to 提前终止，所以 stop term 的动态评估比有用更烦人：如果你真的需要动态评估，你使用`while () {}`(or `do {} while ()`)。

在其他一些语言上，比如 Lua，停止条件只在循环初始化时计算一次。它有助于预测循环行为，并且通常性能更高。

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2008-10-23T13:38:04.097

在 x86 上，for 循环可以在汇编级别完成，而无需进行 while 循环。**循环**指令减小寄存器 ecx的值，如果 ecx 大于 0，则跳转到操作数，否则不执行任何操作。这是一个经典的 for 循环。

```
mov ecx, 0x00000010h
loop_start:
;loop body
loop loop_start
;end of loop 
```

* * *

## 回答 #8

> 赞同：2
> 
>             
> 
> 时间：2008-10-23T14:22:24.133

在 Ada（我相信大多数其他源自 Algol 的语言）中，“for”循环的终止条件仅在循环开始时评估一次。例如，假设您在 Ada 中有以下代码

```
q := 10;
for i in 1..q loop
    q := 20;
    --// Do some stuff
end loop; 
```

这个循环将精确地迭代 10 次，因为循环开始时 q 是 10。但是，如果我在 C 中编写看似等效的循环：

```
q = 10;
for (int i=0;i<q;i++) {
   q = 20;
   // Do some stuff
} 
```

然后循环迭代 20 次，因为当我变得足够大时，q 已更改为 20。

当然，C 方式更灵活。然而，这有相当多的负面影响。显而易见的是，程序必须浪费精力重新检查每个循环的循环条件。一个好的优化器可能足够聪明，可以在像这样的简单情况下解决问题，但是如果“q”是全局的并且“做一些事情”包括过程调用（因此理论上可以修改 q）会发生什么？

一个严峻的事实是，我们对 Ada 循环*的*了解比对 C 循环的了解要多得多。这意味着，在其优化器具有相同水平的智能和努力的情况下，Ada 可以在优化方面做得更好。例如，Ada 编译器知道它可以用 10 个内容副本替换整个循环，无论这些内容是什么。AC 优化器必须检查和分析内容。

这实际上只是 C 语法设计阻碍编译器的众多方式之一。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T14:45:50.093

这些语言纯粹主义者似乎从未意识到的是 C 的全部意义，在某种程度上，C++ 提供了实现您想要的东西以及如何实现它的可能性。现在诚然，如果您的结束表达式的结果发生变化，最好只使用一个while循环。也许问题在于程序员得到的印象是 C 实现了“高级”，但每个人都应该知道 C 是一种相当低级的语言。

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2008-10-24T08:28:52.020

> > 非常“实用”意味着想成为 CS 专业的学生必须学习 Kernighan 在设计 C 时的错误，尤其是臭名昭著的事实，即 for 循环重复评估 for 条件，它重复 while 并且无法匹配大多数其他语言的行为实现一个for循环。

*啊哈哈哈哈！*

我喜欢审稿人的基本（双关语）断言：

*   克尼汉的错误

*   臭名昭著的事实

*   无法匹配大多数其他语言的行为

对我来说，它闻起来像是从未成功掌握 C 的基本特征/哲学的人。

## 介绍

当我还在大学学习物理时，当我发现 C 的**for**循环时，我发现 C（即类 C 语言）将成为我的首选语言。

显然，一个人的风格失败就是另一个人的风格成功。这将结束本次讨论的主观部分。

## 也许 Kernigan 的 for 应该被称为循环？

只是在开玩笑？也许不是。

该评论的作者显然决定每种语言结构都应该具有跨语言的相同行为。因此，将 for as 重命名**为**循环**会**缓解他/她的不适。

问题是作者未能理解 C 的**for**是 while 的扩展，**而**不是不同的循环。这意味着**while**是 for 的语法糖轻版本**，**而不是**for**可能已被阉割的**while**其他语言。

 **## 真的需要C吗？

引用评论的作者，他/她对**for**和**while**做出以下断言：

*   **for**用于常量循环，从开始到结束

*   **while**用于在每次迭代时评估条件的循环

当您可以组合它们时，拥有正交特征是一件好事。但是在我知道的所有语言中，没有办法将**for**和**while**结合在一起。

示例：如果对于审阅者的语言，您需要一个从头到尾的循环（例如**for**），但仍然能够在每次循环迭代时进行评估（例如**while**）：您可能需要在子集中查找一个容器（不是整个容器），根据一些有状态测试的值？

在类 C 语言中，您使用**for**。在审阅者的理想语言中，你只是，好吧，破解一些丑陋的代码，因为你没有**for_while**循环（或 C 的**for**循环）而哭泣。

## 结论

我相信我们可以用以下陈述来总结审稿人对 C（和类 C 语言）的批评“ *Kernigan 的臭名昭著的错误，即没有给 C 提供以前现有语言的语法*”，这可以再次概括为“*从不认为不同*” .

引用 Bjarne Stroustrup 的话：

> > 只有两种语言：人们抱怨的语言和没人使用的语言。

所以，总而言之，审稿人的评论应该算是一种表扬。

^_^

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2008-10-23T14:34:46.293

也许 Knuth 指的是 BASIC。

在 BASIC（较旧的，我不了解 VB）中，FOR 循环的实现方式不同。

例如循环十次

对于 N=1 到 10

...

下一个

---- OR ---- 求小于 100 的偶数之和

对于 N=0 到 100 第 2 步

...

下一个

在 C 中，您可能在“for”中有任何条件来检查是否退出循环。更灵活，我想。

# excel - 从内存中提供 Excel QueryTable 对象

> ID：229676
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-10-23T13:17:16.637
> 
>         
> 
> 标签：excel, vba

问候，

下面的 VBA 代码将创建一个 Excel QueryTable 对象并从 Range("D2") 开始显示它。这个目标范围的具体地址无关紧要。

我的问题是——是否可以手动将值输入到内存中的 Recordset，然后从中读取表？换句话说，我想在 VBA 中指定表列和值，而不是让它们来自数据库或文件。

```
Public Sub Foo()

    Dim blah As QueryTable
    Dim rngTarget As Range

    Dim strQuery As String

    strQuery = "SELECT * FROM MY_TABLE"
    Set rngTarget = Range("D2")
    Dim qt As QueryTable
    Set qt = rngTarget.Worksheet.QueryTables.Add(Connection:= _
        "ODBC;DRIVER=SQL Server;SERVER=MY_SQL_SERVER;APP=MY_APP;Trusted_Connection=Yes", Destination:=rngTarget)

    With qt
        .CommandText = strQuery
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = False
        .Name = "MY_RANGE_NAME"
        .MaintainConnection = False
        .RefreshStyle = xlOverwriteCells
        .SavePassword = False
        .SaveData = False
        .AdjustColumnWidth = False
        .RefreshPeriod = 0
        .PreserveColumnInfo = False
        .Refresh BackgroundQuery:=False
   End With

End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-10-29T21:40:30.993

是的，当然。

```
 Dim vConnection As Variant, vCommandText As Variant
  Dim r As ADODB.Recordset
  Dim i As Long

  'Save query table definition
  vConnection = QueryTable.Connection
  vCommandText = QueryTable.CommandText

  Set r = New ADODB.Recordset
  <populate r>

  Set QueryTable.Recordset = r
  QueryTable.Refresh False

  'Restore Query Table definition
  Set QueryTable.Recordset = Nothing
  QueryTable.Connection = vConnection
  QueryTable.CommandText = vCommandText 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-10-23T22:00:10.747

来自 Excel VB 帮助 连接参数可以是：

“ADO 或 DAO 记录集对象。从 ADO 或 DAO 记录集中读取数据。Microsoft Excel 保留记录集，直到删除查询表或更改连接。无法编辑生成的查询表”

所以是的，看起来你可以做到。

# java - 如何在 Java 中为 iPhone 创建“Hello World”应用程序？

> ID：229679
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-10-23T13:18:14.263
> 
>         
> 
> 标签：java, iphone

我想使用 Java 为 iPhone 创建一个基本的“Hello World”风格的应用程序——谁能告诉我怎么做？

* * *

## 回答 #1

> 赞同：11
> 
>             
> 
> 时间：2008-10-23T13:19:39.517

你不能用 Java for iPhone 编写代码。iPhone 仅支持 C/C++/Objective-C - Cocoa。

但是，在当前许可下，您可以使用生成此类代码的翻译工具。有几种解决方案可以做到这一点：

[Codename One](http://www.codenameone.com/) - 专注于使用带有可视化工具和模拟器的 Java 构建应用程序。具有 SaaS 后端的开源，无需 Mac。

[XMLVM](http://www.xmlvm.org/) - 将 Java 字节码转换为 C/Objective-C 的转换器。开源，但目前需要编写 iOS 特定代码。

还有几个专有解决方案，但我没有使用它们的经验。例如，Software AG 有一个名为 web objects 的工具。

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2008-10-23T13:22:23.910

可能想检查一下[Alchemo for iphone](http://www.innaworks.com/alcheMo-for-iPhone.html)，我自己还没有使用过它。它将您的 CLDC 1.1 MIPD 2.0 代码转换为原生 iPhone 代码。它甚至负责内存管理。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2008-10-23T14:28:20.580

有 2 种方法可以为 iPhone 开发。

最好的方法是使用 Objective-C 和 Cocoa。

另一种方法是使用 JavaScript 创建一个基于 Web 的应用程序，他们可以通过 iPhone 浏览器访问该应用程序（但这仅对连接到 Web 的用户可用）。

如果您想在 Java 中创建类似的东西，一个不错的选择是针对 google 的 Android 平台（例如 G1 手机）

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2008-10-23T21:44:41.370

我刚刚偶然发现了这个 Google TechTalk 视频[“使用 Java 开发 iPhone 应用程序”](http://www.youtube.com/watch?v=s8nMpi5-P-I)。

* * *

## 回答 #5

> 赞同：4
> 
>             
> 
> 时间：2008-10-23T18:28:25.963

1) 如果您了解 J2ME，那非常容易。首先你写代码。

2) 然后下载[alcheMo](http://www.innaworks.com/alcheMo.html) for iPhone，包含将 J2ME 应用程序源代码转换为 iPhone 等效 C++ 源代码的翻译器。alcheMo for iPhone 能够利用 Java ME CLDC 1.1 和 MIDP 2.0 的扩展子集（包括触摸屏支持）转换 J2ME 应用程序，并支持多个 JSR 扩展 API，包括 JSR-256 移动传感器 API。

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2008-10-23T13:21:13.790

简短的回答：你不能，不支持 Java。查看如何：[http://developer.apple.com/iphone/](http://developer.apple.com/iphone/) 

[http://blogs.zdnet.com/Burnette/?p=338](http://blogs.zdnet.com/Burnette/?p=338)

好吧，也许它在内部确实支持 Java，但开发人员还不能使用它。一世

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T14:14:52.137

就目前而言，iPhone 不支持 Java。您可以使用 Objective C，然后将其交叉编译成 Java 应用程序。Sun Microsystems 正在与 Apple 合作，以使 iphone java 能够使用。如上所述，Cocoa 是为 iphone 开发应用程序时使用的最佳语言。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T18:34:26.340

如果您真的想在 iPhone（或任何其他支持其他语言的手机）上开发 Java 应用程序，您可以让 JVM（Java 虚拟机）与 C++/Cocoa（头文件/包装器）一起工作，并且然后从 C++ 或通过 JVM 的接口调用您的 java 代码。

虽然我不确定你有多少经验。做这样的事情需要一些时间和专业知识，但我确信 C++ 的 JVM 接口至少在你可以以这种方式使用的某个地方浮动。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2008-10-27T18:15:33.373

您可以编写 Java 代码并使用[XMLVM](http://www.xmlvm.org/overview/)将其转换为 Objective-C 。

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2008-10-27T18:38:36.713

如前所述，Java 不受官方支持。但是，如果您绝对必须运行 Java，您可以越狱您的手机并以这种方式运行 Java。我不会提供有关越狱手机的说明，谷歌很容易。

Cydia 是您越狱时安装的应用程序/安装程序之一，它有一个可供您使用的 Java 安装程序。它使用 JamVM，一个小型、轻量级的 JVM。

通过 Cydia，您还可以安装一些演示应用程序，包括一个示例 HelloWorld 控制台应用程序。此外，我听说有人让[Jetty](http://oliever.multiply.com/journal/item/28)在 iPhone 上工作，但我自己没有尝试过。

iPhone 上的 Java 图形用户界面开发目前正在进行中。要了解更多信息，您可以订阅[iPhone-Java邮件列表。](http://www.telesphoreo.org/cgi-bin/mailman/listinfo/iphone-java)Java 层对 Objective-C 层进行本机调用，并不是非常以 Java 为中心。您需要了解如何在 Objective-C 中编写代码来创建 GUI。

* * *

## 回答 #11

> 赞同：1
> 
>             
> 
> 时间：2012-03-20T11:27:56.027

查看这个新平台[http://www.codenameone.com](http://www.codenameone.com) (FOSS)，它提供了一个 java 框架，可以将你的 java 代码编译为 Objective-c 并为你提供一个原生应用程序

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2009-09-30T21:47:59.540

根据[http://www.mono-project.com/Mono：Iphone](http://www.mono-project.com/Mono:Iphone) Mono 已被移植到 iPhone 上，并作为名为 MonoTouch 的商业产品提供。如果您了解 C# 但不了解 Objective C，这可能是快速启动和运行的好方法。

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2010-06-09T03:16:01.463

如果你越狱了，你可以使用Cydia找到java编译器、Jikes和所需的单元，你可以在iPhone上编写、编译和运行。当然，我永远不会这样做，因为它违反了 Apple 的 EULA：p

# ruby-on-rails - CSS 不适用于 IIS7

> ID：229683
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-23T13:19:21.687
> 
>         
> 
> 标签：ruby-on-rails, css, iis-7, windows-vista

我有一个使用 Vista、IIS7 和 SQL 2005 运行的 rails 应用程序。由于某种原因，没有呈现 CSS。当我使用 Webrick 时，CSS 工作正常。

任何想法如何让 CSS 与 IIS7 一起正常工作。我已经卸载并重新安装了 Windows 组件“通用 Http 功能”，但没有成功。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-12-30T14:05:02.860

[我的解决方案在这里](http://weblogs.asp.net/meligy/archive/2009/10/12/funny-problem-windows-7-iis-7-5-images-css-not-showing.aspx)

您需要从程序和功能中向 IIS 添加一些附加功能

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2008-10-23T13:28:28.343

您可以使用 Firebug 或其他工具来检查 IIS7 是否使用您的样式表发送正确的 MIME 类型？一些浏览器会忽略 CSS，除非服务器明确发送

```
Content-Type: text/css 
```

在 HTTP 响应标头中，并且使用动态内容或非标准文件扩展名，您可能会发现 IIS7 未配置为“开箱即用”执行此操作

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T13:28:33.260

从服务器发送的 CSS 文件头中的 mime-type 是什么？它需要是文本/css。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T13:31:00.307

我会在 IE 中安装和运行[Fiddler2](http://www.fiddler2.com/fiddler2/)，然后查看 HTTP 请求上的内容。

如果“CSS”不起作用，则几乎可以保证文件没有正确链接，或者提供了错误的内容类型标题。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2011-07-29T21:31:56.837

就我而言，启用了“静态内容”，而 IIS 7 仍未处理 css。我尝试手动添加 CSS 处理程序无济于事。我卸载了IIS，重新安装，现在很好。当这样的解决方案是重新安装时，特别是像 IIS 这样的解决方案，但很好。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2008-10-23T13:29:04.413

您的 CSS 文件是链接资源吗？如果不是，而且它是内联的，我发现您的 CSS 没有呈现非常奇怪 - 因为 CSS 仅由 Web 浏览器处理。

如果 CSS 很可能是一个链接资源，那么可以肯定没有找到 CSS 文件 - 可能您的 Web 根目录配置不正确，或者您的 CSS 文件已生成并且文件头响应不正确。

尝试更改链接，如果它是相对的，则使其成为绝对，否则执行相反的操作。使用 Firebug 或 HTTP Fiddler 之类的东西来查看是否找到了文件。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2008-10-23T13:35:12.857

我之前遇到的一个问题是给每个 css 链接标签一个“标题”属性来描述它们：一些浏览器会认为这意味着每个 css 文件都应该独立于其他文件来查看（如主题）

如果是这种情况，请删除 title 属性

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2010-12-28T14:29:31.053

当您转到控制面板和程序和功能并将功能添加到 IIS 时，您需要启用“静态内容”。对我来说，默认情况下未启用此功能并导致`images/css/js`不显示。

# asp.net-mvc - BindingHelperExtensions.updatefrom / Controller.UpdateModel 不安全吗？

> ID：229696
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-23T13:23:02.647
> 
>         
> 
> 标签：asp.net-mvc

我一直在阅读有关 UpdateFrom 的信息，用于从请求中更新业务对象。它是否非常容易受到 XSS 代码和发布的额外表单参数的影响？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-10-23T17:25:02.970

UpdateFrom 在较旧的 MVC 预览之一中被删除。替代品是 Controller.UpdateModel。

关于安全性，以下其中一项应为真：

1.  您的类型（您传递给 UpdateModel 的对象的类型）没有用户无法更新的字段，或者

2.  您使用提供的重载将表示用户可以更新的属性名称的键列表传递给 UpdateModel。

如果其中之一为真，则使用 UpdateModel 没有特殊的安全风险。当然，所有其他安全最佳实践仍然适用。

# c# - 需要带有向下钻取的 PropertyGrid，类似于 QuickWatch

> ID：229700
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2008-10-23T13:24:52.207
> 
>         
> 
> 标签：c#

我正在尝试以通用方式显示对象数据成员。我从使用 PropertyGrid 开始，就简单属性而言，它满足了我的需求。但是，它不允许用户向下钻取数据成员。它允许浏览收藏，但界面有点尴尬。

我基本上是在寻找具有 QuickWatch 功能的东西。有人知道任何可以进行向下钻取的库吗？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-10-23T14:25:32.207

当然，您可以深入研究 PropertyGrid 中的属性。这是一个庞大的主题，但也许您的属性只需要将 ExpandableObjectConverter 附加到它们？或者，如果您要了解更多细节，附加的 TypeConverter 需要覆盖 GetPropertiesSupported 和 GetProperties 方法。

还有另一种方法可以告诉网格在属性下方显示哪些属性。您可以实现 ICustomTypeDescriptor 并返回您自己的 PropertyDescriptor。但通常这是针对更复杂的场景。

如果您需要任何具体细节，请告诉我。

**更新：**在评论中，您询问了有关显示字典的问题。如果您想将 dict 的每个条目视为子属性，那么这就是上面提到的复杂场景。您的 TypeConverter 或自定义 TypeDescriptor 必须为每个条目生成一个 PropertyDescriptor。它的名称将是键，它的值将是......好吧......属性值。如果您是 PropertyGrid 的新手，我鼓励您阅读大量有关它的内容，因为它可能非常复杂，您会从这里找到一个很好的资源列表：[www.propertygridresourcelist.com](http://www.propertygridresourcelist.com)

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-10-23T13:36:11.077

我会使用一个树视图控件，其样式看起来像一个“网格”。然后，当您向下钻取时，您可以动态加载您需要的任何子项。

# javascript - 在 JSP 标记中使用 JavaScript

> ID：229726
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2008-10-23T13:33:20.660
> 
>         
> 
> 标签：javascript, jsp, jsp-tags

我已经看到[这个问题](https://stackoverflow.com/questions/49156/importing-javascript-in-jsp-tags)重新考虑了与标签内容本身相关的 js 文件的导入。我有一个类似的问题，这里我有一个生成一些 HTML 的 jsp 标记，并有一个通用的 js 实现来处理这个 HTML 的行为。此外，我需要编写一些初始化语句，以便之后通过 JavaScript 使用它。为了能够在我的 JavaScript 中使用这个“处理程序”，它应该可以以某种方式访问​​。

问题是...可以将内联 <script> 标记与我的 HTML 一起编写用于实例化和初始化目的（我个人认为它不是很优雅）吗？关于 JS 世界可以访问，我是否应该留下一个全局变量来引用我的处理程序对象（我认为也不是很优雅），有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2008-10-23T13:50:09.660

您应该在自己的文件中争取 javascript。这通常通过[渐进增强](http://accessites.org/site/2007/02/graceful-degradation-progressive-enhancement/)来完成。但有时您别无选择，例如当同一个 JSP 以不同语言呈现页面时。这是一个真实的例子：

JSP：

```
 <script src="/javascript/article_admin.js"></script>  
  <script type="text/javascript">  
      NP_ArticleAdmin.initialize({  
            text: {  
              please_confirm_deletion_of: '<i18n:output text="please.confirm.deletion.of"/>',  
              this_cannot_be_undone: '<i18n:output text="this.cannot.be.undone"/>'  
            }  
      });  
  </script> 
```

javascript (article_admin.js)：

```
 /*global NP_ArticleAdmin, jQuery, confirm */  
 NP_ArticleAdmin = function ($) {  
     var text;  

     function delete_article(event) {  
         var article = $(this).parents("li.article"),  
         id = article.attr("id"),  
         name = article.find("h3.name").html();  
         if (confirm(text.please_confirm_deletion_of + name + text.this_cannot_be_undone)) {  
             $.post("/admin/delete_article", {id: id});  
             article.fadeOut();  
         }  
         event.preventDefault();  
         return false;  
     }  

     function initialize(data) {  
         text = data.text;  
         $("#articles a.delete").click(delete_article);  
     }  

     return {initialize: initialize};  
 }(jQuery); 
```

在此示例中，JSP 文件中唯一的 javascript 是需要存在的部分。核心功能在其自己的 js 文件中分离。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T13:49:19.863

我不完全确定你在这里问什么，但我认为`<script>`在 JSP 中包含标签以实例化 javascript 代码没有任何问题。我经常遵循这个模型，在外部 javascript 文件中编写库代码，然后从`<script>`标签中调用我的对象的构造函数。

这使得调试变得容易，因为逻辑都在外部文件中（而且 firebug 似乎在调试内联 javascript 代码时遇到了麻烦）。库被缓存，但实例化它们的数据没有（这是所需的行为）。

另一种方法是在外部 javascript 文件或 AJAX 调用中动态生成实例化代码。我也这样做了，取得了积极的成果。

我认为决定因素是您拥有多少动态数据。如果您需要表示大型数据结构，我会通过返回 JSON 的 AJAX 调用来提供它。如果它是对构造函数的简单调用，请将其放在 JSP 中。

至于全局变量，我通常会为顶级对象设置一个全局变量，它会启动一切。在其中，是对辅助对象的所有其他引用。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-23T13:48:30.707

尽管我同意它并不完全优雅，但众所周知，在将服务器端决策与 AJAX 集成环境结合起来时，我曾多次这样做。回显内联 <script> 标记以初始化某些变量并不是一件可怕的事情，只要没有人看到它。

至于更好的方法，我不知道这些。我很少这样做，以至于我没有寻求更优雅或“适当”的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-10-23T13:49:45.603

可以使用`<script>`符合 HTML 的标签。有时需要它，但至于任何更好的方法我不知道。在不让事情看起来更复杂的情况下，使用`<script>`标签比尝试找到实现 js 文件的方法更容易。

# c# - 为什么 PopupControlExtender 在 UpdatePanel 中生成完整的回发？

> ID：229747
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-10-23T13:38:29.387
> 
>         
> 
> 标签：c#, asp.net, ajax

我在更新面板中有一个按钮。我有一个 PopupControlExtender 链接到该按钮，因此当单击该按钮时会弹出一个面板。它工作正常，除了它做了一个完整的回发，我不知道为什么。按钮和 PopupControlExtender 位于 ContentTemplate 标记内的更新面板内。当我取出 PopupControlExtender 时，该按钮仅执行部分回发。我在 PopupControlExtender 上找不到任何有用的信息。我是否必须声明回发触发器或其他东西？

编辑：如果我使用 LinkBut​​ton 控件，它会生成部分回发。似乎只使用 Button 控件进行完整的回发。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-10-23T17:31:07.683

确保按钮的 UseSubmitBehavior 属性设置为 false

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2012-02-29T22:54:20.110

我有完全相反的问题：Link Button 在 Button 控件工作时会导致完整的回发。但是，与其他答案不同，按钮仅在 UseSubmitBehavior 为 True/未定义时才有效。

所以我只是使用一些带有按钮的 CSS 让它看起来像一个链接按钮，例如

```
input.linkButton
{
    background-color: transparent;
    border-style: none;
    color: #0000FF;
    cursor: pointer;
    text-align: left;
    text-decoration: underline; 
} 
```

（感谢 Englestone 的博客）。

# python - Python - 库问题

> ID：229756
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2008-10-23T13:41:31.703
> 
>         
> 
> 标签：python, networking, scapy

我对 Python 比较陌生，并且在使用 Python 网络操作工具 Scapy 进行编程时遇到问题。但是，我不知道这是否是一个 Scapy 问题，因为它是一个 Python 新手问题。在[scapy 网站上](http://www.secdev.org/projects/scapy/build_your_own_tools.html)，他们提供了一个我无法在我自己的机器上运行的示例程序：

```
#! /usr/bin/env python

import sys
from scapy import sr1,IP,ICMP

p=sr1(IP(dst=sys.argv[1])/ICMP())
if p:
    p.show() 
```

我得到：

```
Traceback (most recent call last):
  File "test.py", line 4, in <module>
    from scapy import sr1,IP,ICMP
ImportError: cannot import name sr1 
```

所以我的问题是：在安装 Python 库时，我是否需要更改路径或类似的东西？另外，我可以在解释器中运行一些东西来告诉我 scapy 包的内容吗？我可以跑得`from scapy import *`很好，但是由于我不知道里面有什么，所以很难使用它。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2008-10-23T13:59:23.523

鉴于 Federico Ramponi 的警告“您应该单独使用 scapy 作为解释器，而不是作为库”，我想回答问题的非 scapy 特定部分。

**问：**安装 Python 库时，是否需要更改路径或类似的东西？

**答：**我认为您是在谈论`PYTHONPATH`整个系统范围内的变化。这通常不是必需的，也不是一个好主意。

第三方 Python 库应安装在系统目录中，例如`/usr/lib/python2.5/site-packages`，或安装在本地，在这种情况下，您可能需要`PYTHONPATH`在 Makefile 或驱动程序 shell 脚本中进行设置。

**问：**另外，我可以在解释器中运行一些东西来告诉我 scapy 包的内容吗？

**答：**你可以这样做：

```
>>> import scapy
>>> dir(scapy) 
```

甚至更好：

```
>>> import scapy
>>> help(scapy) 
```

在评论中提出了额外的问题。

**问：** 'import scapy' 和 'from scapy import *' 一样吗？

**A：** `import scapy`将本地命名空间中的 scapy 名称绑定到 scapy 模块对象。OTOH，`from scapy import *`不绑定模块名称，但是在 scapy 模块中定义的所有公共名称都绑定在本地命名空间中。

请参阅 Python 参考手册的第 6 和 7 段，[6.12 The import statement](http://www.python.org/doc/2.5.2/ref/import.html)。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-06-02T22:30:00.657

我有同样的问题，在 scapy v2.x 使用

```
 from scapy.all import * 
```

取而代之的是 v1.x

```
 from scapy import * 
```

[如此处](http://www.secdev.org/projects/scapy/doc/installation.html)所写

享受它 =)

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2008-10-23T14:05:46.273

它告诉你它在 scapy 中找不到 sr1。不确定你是多么的新手，但口译员永远是你的朋友。启动解释器（只需在命令行中输入“python”），然后在提示符 (>>>) 处输入（但不要输入 >，它们会自行显示）：

```
>>> import scapy
>>> from pprint import pformat
>>> pformat(dir(scapy)) 
```

最后一行应该打印很多东西。您是否在任何地方看到“sr1”、“IP”和“ICMP”？如果不是，则示例有问题。

尝试也帮助（scapy）

这就是我可以在不安装 scapy 并亲自查看您的实际源文件的情况下为您提供多少帮助。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T16:04:30.807

[scapy](http://www.secdev.org/projects/scapy/index.html)包是一个用于网络操作和监控的工具。我很好奇你想用它做什么。监视你的朋友是不礼貌的。:-)

```
coventry@metta:~/src$ wget -q http://www.secdev.org/projects/scapy/files/scapy-latest.zip
coventry@metta:~/src$ unzip -qq scapy-latest.zip 
warning [scapy-latest.zip]:  61 extra bytes at beginning or within zipfile
  (attempting to process anyway)
coventry@metta:~/src$ find scapy-2.0.0.10 -name \*.py | xargs grep sr1
scapy-2.0.0.10/scapy/layers/dns.py:    r=sr1(IP(dst=nameserver)/UDP()/DNS(opcode=5,
scapy-2.0.0.10/scapy/layers/dns.py:    r=sr1(IP(dst=nameserver)/UDP()/DNS(opcode=5,
scapy-2.0.0.10/scapy/layers/inet6.py:from scapy.sendrecv import sr,sr1,srp1
scapy-2.0.0.10/scapy/layers/snmp.py:            r = sr1(IP(dst=dst)/UDP(sport=RandShort())/SNMP(community=community, PDU=SNMPnext(varbindlist=[SNMPvarbind(oid=oid)])),timeout=2, chainCC=1, verbose=0, retry=2)
scapy-2.0.0.10/scapy/layers/inet.py:from scapy.sendrecv import sr,sr1,srp1
scapy-2.0.0.10/scapy/layers/inet.py:            p = sr1(IP(dst=target, options="\x00"*40, proto=200)/"XXXXYYYYYYYYYYYY",timeout=timeout,verbose=0)
scapy-2.0.0.10/scapy/sendrecv.py:def sr1(x,filter=None,iface=None, nofilter=0, *args,**kargs): 
```

根据最后一行，`sr1`是一个定义在`scapy.sendrecv`. 有人应该向作者提交文档错误。

# java - 抽象 Java 网格

> ID：229757
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-10-23T13:42:13.777
> 
>         
> 
> 标签：java, web-applications, grid

我正在寻找Java中网格的抽象表示（网格就像在具有数据列和行的那个东西中一样）。这样的事情存在吗？我希望能够对行进行排序、过滤、跟踪、设置列属性等。然后我将在网络上实现网格。

需要明确的是：我已经决定了终极视图技术（客户端）。我正在寻找的东西将保存所有记录并根据视图要求提供它们。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T14:00:07.813

查看 Sun 的本教程，了解 java 中的表。它为如何实现模型提供了一个好主意。

[Java中的表教程](http://java.sun.com/docs/books/tutorial/uiswing/components/table.html)

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-10-23T13:55:20.413

[JTable](http://java.sun.com/j2se/1.4.2/docs/api/javax/swing/JTable.html)是您正在寻找的。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-23T14:42:51.003

您可以重用 Glazed Lists 项目的表格模型（前提是您可以将 Web 视图挂钩到常规 TableModel）

# wcf - 超时 WCF 服务

> ID：229760
> 
>         
> 
> 赞同：61
> 
>         
> 
> 时间：2008-10-23T13:43:05.320
> 
>         
> 
> 标签：wcf, configuration, timeout, wcf-binding

超时如何在 WCF 中工作？例如，我知道您可以为客户端绑定配置*sendTimeout*和*receiveTimeout*。但它们是如何工作的？

MSDN 将*sendTimeout*描述为：

> 一个 TimeSpan 值，它指定为完成发送操作提供的时间间隔。此值应大于或等于零。默认值为 00:01:00。

什么是发送操作/接收操作？

* * *

## 回答 #1

> 赞同：62
> 
>             
> 
> 时间：2008-10-23T16:51:45.283

客户端：

*   SendTimeout 用于初始化 OperationTimeout，它控制发送消息的整个交互（包括在请求-回复情况下接收回复消息）。当从 CallbackContract 方法发送回复消息时，此超时也适用。

*   OpenTimeout 和 CloseTimeout 在打开和关闭通道时使用（当没有传递明确的超时值时）。

*   不使用 ReceiveTimeout。

服务器端：

*   发送、打开和关闭超时与客户端相同（用于回调）。

*   ServiceFramework 层使用 ReceiveTimeout 来初始化会话空闲超时。

来源是[MSDN 论坛上的 Brian McNamara](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/84551e45-19a2-4d0d-bcc0-516a4041943d/)。

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2011-10-16T01:58:06.570

请参阅“WCF 中的超时及其默认值” [http://blogs.msdn.com/b/hongmeig/archive/2010/03/06/timeouts-in-wcf-and-their-default-values.aspx](http://blogs.msdn.com/b/hongmeig/archive/2010/03/06/timeouts-in-wcf-and-their-default-values.aspx)

> 绑定-SendTimeout、ReceiveTimeout、OpenTimeout 和 CloseTimeout 的超时。它们可以通过配置或绑定上的代码轻松设置。这些的默认值为 1 分钟。
> 
> ServiceHost 有 OpenTimeout 和 CloseTimeout。OpenTimeout 的默认值为 1 分钟，CloseTimeout 的默认值为 10 秒。
> 
> 客户端通道超时。有一个 OperationTimeout，您可以通过将频道转换为 IContextChannel 来设置它。其默认值也是 1 分钟。tcp传输上的Ttimeout，称为ChannelInitializationTimeout，默认值为5秒。
> 
> ASP 网络。有关闭超时，就像服务主机关闭超时一样，默认是90秒。ExecutionTimeout，就像我们的操作超时一样，默认是110秒。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-09-09T20:46:39.347

除了该帖子上的内容之外，还有在客户端定义的操作超时。看到这个：

[http://final-proj.blogspot.com/2009/09/wcf-timeouts.html](http://final-proj.blogspot.com/2009/09/wcf-timeouts.html)

# java - 如何提高 Netbeans 的性能？

> ID：229763
> 
>         
> 
> 赞同：113
> 
>         
> 
> 时间：2008-10-23T13:44:47.517
> 
>         
> 
> 标签：java, performance, jakarta-ee, netbeans

有没有一种真正的方法可以让 Netbeans 更快地加载和工作？

当您编码一段时间后，它太慢并且变得更糟。它吃掉了我所有的内存。

* * *

我在 Windows 机器上，特别是 Windows Server 2008 Datacenter Edition x64、4Gb RAM、3Ghz Core 2 Duo 处理器等。我使用的是 x64 JDK。我使用 NOD32 Antivirus，因为对我来说它是机器性能最好的。

在任务管理器中 netbeans.exe 只显示不超过 20 Mb，java.exe 超过 600 Mb。

我的项目是一个 J2EE Web 应用程序，有 500 多个类，只有项目库不包括（外部）。当我说慢时，我的意思是 3、4、5 分钟或更长时间 Netbeans 被冻结。

我的项目是否对 Netbeans 来说太大了，如果它必须读取所有文件以获取错误警告、svn 状态等文件的状态？我可以禁用这一切吗？是否可以将其设置为仅在我打开文件时扫描？

我的 CPU 使用率通常为 30%，我的所有工具都打开了，我的意思是 Netbeans、MS SQL 管理器、记事本、XMLSpy、任务管理器、Delphi、VirtualBox。Netbeans 比我的虚拟化系统消耗更多的 RAM。

在 Linux 中，它与在同一台机器上的 Windows 中一样慢（Ubuntu 8.04 x64）。

确实，Netbeans 团队提高了启动速度，但是当它打开时，它开始缓存 ALL。

我使用了一些 JVM 参数来设置高内存使用率和其他参数：
`"C:\Program Files\NetBeans Dev\bin\netbeans.exe" -J-Xms32m -J-Xmx512m -J-Xverify:none  -J-XX:+CMSClassUnloadingEnabled`

但它仍然很慢。

* * *

## 回答 #1

> 赞同：59
> 
>             
> 
> 时间：2011-10-14T06:06:15.400

**当您的NetBeans**或**Eclipse** IDE 似乎使用太多内存时，该问题的非常简单的解决方案：

1.  **禁用您不使用的插件。**

2.  **关闭你不从事的项目。**

我的 Linux Mint 和 Ubuntu 机器上的 Netbeans 7.0 也遇到了类似的问题。Netbeans 使用 > 700 MiB 空间和 50-80% CPU。然后我决定做一些清理工作。我安装了 30 个插件，但我没有使用其中的大部分。所以，我禁用了我不使用的插件，我禁用了多达 19 个插件。现在内存使用量低至 400+ MiB，CPU 使用量低至 10，最高可达 50%。

现在我的生活轻松多了。

* * *

## 回答 #2

> 赞同：51
> 
>             
> 
> 时间：2010-09-20T11:11:35.150

只要您可以垂直扩展，就不要花时间优化您的 NB 安装：获得 SSD（以及通常更快的硬件）。

还：

*   将所有相关文件夹（例如项目目录、临时目录）的例外添加到您的防病毒软件（或者更好，摆脱它）。

*   不要为您的项目使用网络驱动器

    *   检查您的家庭驱动器是否是本地驱动器

    *   检查您的 IDE 是否使用非本地文件夹（例如`%AppData%`）

* * *

## 回答 #3

> 赞同：24
> 
>             
> 
> 时间：2008-10-23T14:02:16.717

*   下载最新的 Netbeans

*   删除所有不需要的插件。

*   使用最新版本的 Java

* * *

## 回答 #4

> 赞同：21
> 
>             
> 
> 时间：2012-07-09T07:04:02.143

我们可以使用以下 JVM 选项来加快 NetBeans 的加载/运行速度。

JVM 选项：`-J-Xverify:none`

*   此选项告诉 JVM 在类加载期间不要验证字节码，并避免预加载不必要的类。

**如何设置：**

编辑文件`C:\Program Files\NetBeans <version>\etc\netbeans.conf`
（如果您将它安装在其他位置，请检查您的 NetBeans 安装文件夹）

*   找到写着的那一行

    netbeans_default_options="..."

*   将选项添加到选项`-J-Xverify:none`列表中。

*   重新启动 NetBeans。

* * *

## 回答 #5

> 赞同：15
> 
>             
> 
> 时间：2012-11-13T15:26:47.787

停用 Git、Subversion、Local History、Spell checker 和其他未使用的插件

* * *

## 回答 #6

> 赞同：5
> 
>             
> 
> 时间：2013-03-17T04:53:25.520

我使用的是 Windows 7。我建议右键单击 NetBeans 快捷方式，转到“属性”，然后在“目标”的“快捷方式”选项卡上，添加`-J-Xmx1024m -J-Xms256m`.

这设置了 JVM 的内存使用情况。Xms 是最小值，而 Xmx 是最大值。

这是目标文本字段的值：

```
"C:\Program Files\NetBeans 7.1\bin\netbeans.exe" --jdkhome "C:\Program Files\Java\jdk1.6.0_10" -J-Dorg.netbeans.modules.php.dbgp.level=400 -J-Xmx1024m -J-Xms256m 
```

由于我添加了该属性，我的 NetBeans 运行得如此之快！

[**另一种尝试更多参考的方法在这里**](https://stackoverflow.com/a/18992956)

在`etc`您的目录下`Netbeans-Home`，编辑文件`netbeans.conf`文件。`-Xms`并且`-Xmx` **应该增加到**允许您的程序编译的值。

**netbeans.conf**中的说明：

```
# Note that default -Xmx and -XX:MaxPermSize are selected for you automatically.
# You can find these values in var/log/messages.log file in your userdir.
# The automatically selected value can be overridden by specifying -J-Xmx or
# -J-XX:MaxPermSize= here or on the command line. 
```

将值放在**netbeans_default_options**字符串中。例子 ：

```
netbeans_default_options="-J-client -J-Xss2m -J-Xms32m -J-XX:PermSize=32m -J-Dapple.laf.useScreenMenuBar=true -J-Dapple.awt.graphics.UseQuartz=true -J-Dsun.java2d.noddraw=true -J-Dsun.java2d.dpiaware=true -J-Dsun.zip.disableMemoryMapping=true  -J-Dsun.awt.disableMixing=true -J-Dswing.aatext=true -J-Dawt.useSystemAAFontSettings=lcd --laf Nimbus" 
```

**如何加快/释放内存窗口：**

1.  禁用 Windows 更新：

    *   打开任务管理器，打开选项卡服务，禁用 Windows 更新：

[![禁用win更新](https://i.stack.imgur.com/zUgBp.jpg)](https://i.stack.imgur.com/zUgBp.jpg)

2.  点击 `Ctrl` + `R` 并输入`Services.msc`，然后按 Enter。

    *   排序方式`Startup Type`

    *   从运行的 3rd 方（非 Windows）中选择服务`Automatic`，右键单击，单击`Properties`并将启动类型更改为`Manual`

[![服务](https://i.stack.imgur.com/uwYjP.jpg)](https://i.stack.imgur.com/uwYjP.jpg)

*   排序`Status`并停止您认为未使用的（第 3 方）应用程序的服务

* * *

## 回答 #7

> 赞同：4
> 
>             
> 
> 时间：2008-10-23T14:30:20.403

它是公司的 Windows 机器吗？如果如此激进的病毒扫描程序确实会减慢现代 IDE 的速度。检查您的任务管理器是否有使用大量 CPU 或磁盘读取的进程。

* * *

## 回答 #8

> 赞同：4
> 
>             
> 
> 时间：2009-09-12T13:17:31.237

每个人都应该注意 Sun 的 Windows Java 虚拟机不使用共享内存。这意味着您为 VM 提供的堆越多，它为自己保留的内存就越多。更多堆的优点是垃圾收集更少，并且您正在运行的 Java 应用程序的性能可能更快，但缺点是您的其他应用程序可能使用的内存更少，因此您的系统可能会感觉更慢。

* * *

## 回答 #9

> 赞同：3
> 
>             
> 
> 时间：2008-10-24T15:00:41.157

还要对磁盘进行碎片整理。Netbeans 非常积极地创建一种或另一种形式的缓存。它们中的大多数会在某些时候持久化到磁盘上，这会影响启动时间。病毒扫描程序（尤其是赛门铁克）、桌面搜索引擎和任何其他侵入式 I/O 产品都会大大降低性能。

我注意到，Netbeans 有时可能会喜怒无常，而且它的性能在具有几乎相同规格的两台机器之间会有很大差异。我的工作机器性能很差，有时无法使用，但是当我在家用机器上使用它时速度快如闪电（在许多情况下有更大的项目）。

* * *

## 回答 #10

> 赞同：3
> 
>             
> 
> 时间：2014-12-02T15:59:46.677

这是我`etc/netbeans.conf`使用**G1 GC**和其他一些改进的 netbeans 选项。

> netbeans_default_options="-J-server -J-Xss4m -J-Xms256m -J-Xmx512m -J-XX:PermSize=256m -J-Dapple.laf.useScreenMenuBar=true -J-Dapple.awt.graphics.UseQuartz=true - J-Dsun.java2d.noddraw=true -J-Dsun.java2d.dpiaware=true -J-Dsun.zip.disableMemoryMapping=true -J-Xverify:none -J-XX:+UseG1GC -J-XX:+TieredCompilation - J-XX:+AggressiveOpts -J-Dswing.aatext=true -J-Dawt.useSystemAAFontSettings=lcd -J-Dorg.netbeans.editor.aa.extra.hints=true"

字体设置（`swing.aatex`和以下）是可选的 - 根据需要设置或删除。

这些设置极大地提升了我的netbeans！

* * *

## 回答 #11

> 赞同：3
> 
>             
> 
> 时间：2018-01-08T13:20:55.153

上次我决定研究一下为什么我的 NetBeans 运行缓慢。

我正在运行具有 16GB 内存和 3.5GHz 8 核处理器的 PC。我的 CPU 使用率约为 5-20%，内存低于 40%，但 NetBeans 比我藏在车库里的 15 年前的 PC 慢。

在找到这个主题并浏览[http://wiki.netbeans.org/FaqSlowNetBeans](http://wiki.netbeans.org/FaqSlowNetBeans)之后，我意识到在 NetBeans 的右下角，我一直看到一个栏显示“正在扫描...”，然后尝试停止它并什么也没发生我进一步研究了“扫描……”在做什么，我意识到：

**每次我启动 NetBeans 时，NetBeans 都会自动扫描所有打开的项目。**

就是这样，我已经关闭了 20 个打开的项目，NetBeans 的运行速度与记事本一样快。

* * *

## 回答 #12

> 赞同：2
> 
>             
> 
> 时间：2009-02-06T23:46:20.993

如果它在公司机器上 - 确保缓存没有存储在网络上

* * *

## 回答 #13

> 赞同：2
> 
>             
> 
> 时间：2014-01-31T06:18:18.220

这对我有用：

> netbeans_default_options="-J-client -J-Xverify:none -J-Xmx1024m -J-Xss2m -J-Xms256m -J-XX:PermSize=32m -J-Dnetbeans.logger.console=true -J-ea -J- Dapple.laf.useScreenMenuBar=true -J-Dapple.awt.graphics.UseQuartz=true -J-Dsun.java2d.noddraw=true -J-Dsun.java2d.dpiaware=true -J-Dsun.zip.disableMemoryMapping=true - J-Dplugin.manager.check.updates=false -J-Dnetbeans.extbrowser.manual_chrome_plugin_install=yes"

中的设置`etc/netbeans.conf`。

* * *

## 回答 #14

> 赞同：2
> 
>             
> 
> 时间：2014-06-03T07:15:45.997

关于您的 NetBeans 运行缓慢的原因的非常有用的文章：

[http://wiki.netbeans.org/FaqSlowNetBeans](http://wiki.netbeans.org/FaqSlowNetBeans)

* * *

## 回答 #15

> 赞同：2
> 
>             
> 
> 时间：2010-03-11T14:52:47.773

在文章中可以找到或多或少详细的描述，为什么 NetBeans 经常这么慢：

> ### [提高您的 NetBeans 性能](http://web.archive.org/web/20110323111257/http://phundament.com/en_us/blog?postId=35&postName=boost-your-netbeans-performance)
> 
> 第一的。检查 NetBeans 在您的磁盘上实际执行的操作。在 Mac 上，您可以发出以下命令：
> 
> ```
>  sudo fs_usage | grep /path/to/workspace 
> ```
> 
> 在我的特殊情况下，我得到了一个不再存在的目录，但 NetBeans 一直尝试访问该文件夹：
> 
> ```
>  14:08:05 getattrlist /path/to/workspaces/pii 0.000011 java 
> ```
> 
> 重复了很多很多很多次。如果您有类似的问题，请在此处删除您的 NetBeans 缓存文件夹来修复它：
> 
> ```
>  ~/.netbeans/6.8/var/cache 
> ```
> 
> 如果您的 NetBeans.app 仍在进行大量磁盘 I/O。检查它是否正在访问 subverison 文件夹和 svncache。
> 
> 我不得不使用配置文件禁用颠覆功能：
> 
> ```
>  ~/.netbeans/VERSION/config/Preferences/org/netbeans/modules/versioning.properties 
> ```
> 
> 添加一行：
> 
> ```
>  unversionedFolders=FULL_PATH_TO_PROJECT_FOLDER 
> ```
> 
> 资料来源：[Netbeans 论坛](http://forums.netbeans.org/post-42506.html)

恕我直言，这主要与丢失文件或文件夹以及 svncache 引起的大量磁盘 I/O 有关。

* * *

## 回答 #16

> 赞同：2
> 
>             
> 
> 时间：2010-08-05T08:10:12.583

Netbeans 太慢了，我也遇到了同样的问题，但是在停用 SVN 插件后，它现在好多了。我认为这可能会有所帮助。

祝你好运

* * *

## 回答 #17

> 赞同：2
> 
>             
> 
> 时间：2011-02-28T08:05:55.093

为了改善 Netbeans 的启动和构建时间，应该（按此顺序）：

1.  确保有足够的可用**RAM**内存（在我的 64 位系统上，4GB Windows 就足够了）

2.  购买**SSD**，启动时间和构建时间都不同（我的项目构建时间从 60 秒变为 6 秒！）

3.  注意**病毒扫描程序**，它们会大大降低随机文件访问速度（确保它们不会扫描您的 .java 和 .class 文件！）

4.  购买你能拿到的最快的**处理器。**

* * *

## 回答 #18

> 赞同：2
> 
>             
> 
> 时间：2016-05-30T16:46:07.097

**将您的 .netbeans 主文件夹放入 Ramdisk**中，Netbeans 将会非常快。

我在 Ubuntu 16.04 上检测到每个按键都会导致 HDD 读取或写入操作。我有足够的理由使用 Ramdisk。作为一个有点积极的副作用，我的硬盘现在很正常（不再有 tickclickrrickrrrticktick）并且寿命更长。

* * *

## 回答 #19

> 赞同：1
> 
>             
> 
> 时间：2014-02-27T20:22:19.217

类似于将所有内容放在 SSD 上的建议。

我从 freeBSD 运行 netbeans。netbeans 缓存文件位于我的 .netbeans 主目录中。我的主目录安装在 nfs 上，因此访问速度非常慢。将 .netbeans 移动到本地机器大大提高了性能。我在我的主目录中添加了一个从 .netbeans 到本地目录的软链接。[Netbeans 在此处](http://wiki.netbeans.org/FaqAlternateUserdir)描述了如何更改 usedir 和 cachedir并将其列为第 4 项下的原因。

在此之前，我可以在 gui 赶上并显示它们之前在评论中写下整个句子。在我键入时出现文本后。

* * *

## 回答 #20

> 赞同：1
> 
>             
> 
> 时间：2015-03-09T05:49:16.713

NetBeans 8.0.2 (PHP) 有两个问题：SubVersion 客户端和[Twig 模板](https://netbeans.org/bugzilla/show_bug.cgi?id=244246)。为了显着提高整体性能，a) 禁用“Twig Templates”插件（这也会停用 Symphony2，以防您可能需要它）和 b) 使用此开关覆盖 SVN 客户端：

```
run.args.extra=-J-DsvnClientAdapterFactory=commandline 
```

^ project.properties 允许单独定义 CLI 参数（这对于 RAM 设置和其他自定义也可能有意义）。猜想一旦关闭了链接的错误报告，就可以重新启用 Twig。重新扫描并不是真正的问题，而重新扫描应按时执行。

刚刚进行了更多测试并注意到，在 Linux 上，它与 Oracle JDK 一起运行比（普通）OpenJDK 运行得更顺畅——甚至已经看到它捆绑了一个版本的 NetBeans。

* * *

## 回答 #21

> 赞同：1
> 
>             
> 
> 时间：2014-03-25T08:46:50.123

最简单的解决方案：

转到首选项->编辑器并
**禁用：自动弹出完成窗口**

当您需要代码完成时，使用：元键 + \ 代替。

我发现的最大问题是自动代码完成功能。当我输入时，它一直在尝试运行代码完成。这导致性能非常缓慢，因为我的项目有很多依赖的库。

最棒的是，您可以停止与编辑器对抗，因为它会在完成弹出窗口中不断出现误报。

自从我关掉它后就再也没有回头。

* * *

## 回答 #22

> 赞同：0
> 
>             
> 
> 时间：2014-04-10T01:51:55.177

**对于 Windows** - 也应该适用于其他操作系统

Netbeans 就像任何其他需要对其 JVM 进行调整的 Java 应用程序一样。

请阅读以下链接以获得一些 netbeans 的基准测试结果

[https://performance.netbeans.org/reports/gc/](https://performance.netbeans.org/reports/gc/)

以下设置在我的具有 4GB RAM 和 I5 四核处理器的 Windows 7 PC 中运行良好。

（检查 bin 文件夹内 netbeans 配置文件中的 netbeans_default_options 行，并将配置行替换如下）

netbeans_default_options="-XX:TargetSurvivorRatio=1 -Xverify:none -XX:PermSize=100M -Xmx500m -Xms500m -XX+UseParallelGC ${netbeans_default_options}"

小建议：垃圾收集在 JVM 堆大小中起着至关重要的作用，因为我有一个四核处理器，所以我使用了 Parallel GC。如果你有单线程处理器，请使用 UseSerialGC。根据我的经验，如果 Xmx Xms 值相同，则 JVM 在最小值和最大值之间切换不会产生性能开销。就我而言，每当我的应用程序大小试图超过 500MB 时，并行 GC 就会派上用场来清理不需要的垃圾，因此我的应用程序在我的 PC 中永远不会超过 500MB。  

* * *

## 回答 #23

> 赞同：0
> 
>             
> 
> 时间：2013-09-16T08:47:54.970

在 Windows 7 上使用 Netbeans 7.3.* 和 7.4 Beta 时遇到了同样的问题。打开和关闭一些插件，我发现是**svn 插件**不断将 CPU 提升到大约 27%，将我的笔记本电脑变成了烤面包机。将其关闭并再次快乐编码:)

* * *

## 回答 #24

> 赞同：0
> 
>             
> 
> 时间：2015-06-28T20:26:09.433

对我来说，启用自动扫描源。

* * *

## 回答 #25

> 赞同：0
> 
>             
> 
> 时间：2016-06-21T16:13:11.493

打开文件：

`/Applications/NetBeans/NetBeans\ 8.0.2.app/Contents/Resources/NetBeans/etc/netbeans.conf`

我添加了一些如下所示的选项：

`netbeans_default_options="-J-Dsun.java2d.opengl=true -J-Dsun.java2d.d3d=false -J-Xmx2048m ...`

根据您的系统，使用 opengl 可能会对您有所帮助。我正在运行 OsX。2048m可能太多了，但似乎没有伤害:-) ...

* * *

## 回答 #26

> 赞同：0
> 
>             
> 
> 时间：2021-01-28T13:11:50.943

在我的例子中，我通过禁用 Rainbow 获得了巨大的性能优势（它是一个用于为代码中的括号着色的插件）：

`Tools -> Options -> Miscellaneous -> Rainbow`（取消选中启用）

在带有 Java 8 的 Netbeans 10 上进行了测试。

严重减速的问题只发生在特别大的 Java 文件（超过 5000 行代码）上，而较小的文件（在 1000 或 2000 行代码以内）则没有问题。

我进行了其他优化，但这是最相关的，因为它大大减少了 CPU 的使用量。

* * *

## 回答 #27

> 赞同：0
> 
>             
> 
> 时间：2022-01-21T17:31:57.853

对此最简单的答案是在 $NETBEANS_HOME/etc/netbeans.conf 文件中显式设置 Xms 和 Xmx。对于一般情况，默认内存分配可以正常工作，但对于大型项目或大量项目，将这些标志显式设置为相当高的值将减轻 NB 在运行期间的大量启动滞后和运行时停滞。

例如，在我的工作站上，我通常将 NB 设置为 Xms=768m，将 Xmx 设置为 1536m 以上。显然可以根据您的需求和要求进行调整，但这应该提供一个不错的起点。

* * *

## 回答 #28

> 赞同：0
> 
>             
> 
> 时间：2018-12-03T15:11:52.430

尝试使用 VisualVM 分析 Netbeans。如果“热点”是 org.gnome.accessibility.atkwrapper.emitsignal()，请尝试运行 Netbeans

`-J-Djavax.accessibility.assistive_technologies=" "`

对我来说帮助很大。

我真的不知道为什么要使用这个工具包，但看起来禁用它通常是安全的。

* * *

## 回答 #29

> 赞同：0
> 
>             
> 
> 时间：2015-09-23T21:01:14.653

我在使用 NetBeans 8.0.2 时遇到了大问题。这是一个老问题，但也许其他人会像我一样遇到同样的问题，我找不到任何可以帮助我的答案。  

我在 Windows 7 上安装了带有 Ruby on Rails 插件的 NetBeans 8.0.2。在我对某些文件所做的几乎每一次更改时，IDE 都会挂起长达 10 秒。只是大文件有问题，但它必须依赖于更多，还有其他大文件没有问题。  

问题是由“提示”“Rails 3 Deprecations”引起的，我将其关闭，现在它非常快，我可以毫无问题地打开其他*所有内容。*

它在`Tools -> Options -> Editor -> Hints`.  

在使用启动参数进行优化的其他答案中也有一些建议。我发现这些关于 JVM-switches 的链接在测试优化时帮助了我（但事实证明这些设置与我的问题无关），它们很旧但有一些有用的信息：

[Explanation of JVM-switches](https://performance.netbeans.org/howto/jvmswitches/index.html)。

[一些（旧）建议](https://performance.netbeans.org/reports/gc/)

* * *

## 回答 #30

> 赞同：0
> 
>             
> 
> 时间：2020-03-10T08:52:25.620

关闭您正在运行的所有实例。您可能有一段时间没有关闭它们中的任何一个，导致它们堆积起来并在后台运行。因此导致滞后/使程序运行缓慢。

* * *

## 回答 #31

> 赞同：-1
> 
>             
> 
> 时间：2016-03-16T18:45:09.877

验证您的项目文件夹是否有一个包含框架文件或库的文件夹（例如：Laravel 有一个文件夹供应商） - 您不直接使用的文件。单击您的“项目”> 属性。在左侧，选择“忽略文件夹”（我不知道英文如何，但在“框架”之前）。在右侧，单击“添加文件夹”，选择 de 文件夹 - 这将使您的 Netbeans 8 更快。这个对我有用。

# mysql - 导致 INSERT 失败的触发器？可能的？

> ID：229765
> 
>         
> 
> 赞同：14
> 
>         
> 
> 时间：2008-10-23T13:46:27.590
> 
>         
> 
> 标签：mysql, triggers, rdbms

在清理[这个答案](https://stackoverflow.com/questions/229447/how-to-create-a-two-sided-unique-index-on-two-fields#229521)时，我了解了一些关于`TRIGGER`MySQL 中的 s 和存储过程的知识，但令我震惊的是，虽然`BEFORE INSERT`和`BEFORE UPDATE`触发器可以修改数据，但它们似乎不会导致插入/更新失败（即验证）。在这种特殊情况下，我能够通过以导致主键重复的方式操作数据来使其工作，这在这种特殊情况下是有道理的，但在一般意义上不一定有意义。

这种功能在 MySQL 中是否可行？在任何其他 RDBMS 中（我的经验仅限于 MySQL）？也许是`THROW EXCEPTION`样式语法？

* * *

## 回答 #1

> 赞同：19
> 
>             
> 
> 时间：2008-10-23T13:56:09.007

从这篇[博文](https://web.archive.org/web/20180330233216/http://www.brokenbuild.com/blog/2006/08/15/mysql-triggers-how-do-you-abort-an-insert-update-or-delete-with-a-trigger/)

> MySQL 触发器：如何使用触发器中止 INSERT、UPDATE 或 DELETE？在 EfNet 的#mysql 上有人问：
> 
>   
>   
> 
> *如果我的业务规则失败，如何使触发器中止操作？*
> 
>   
>   
> 
> 在 MySQL 5.0 和 5.1 中，您需要使用一些技巧来使触发器失败并传递有意义的错误消息。MySQL 存储过程常见问题解答说明了错误处理：
> 
>   
>   
> 
> *SP 11\. SP 是否有“引发应用程序错误”的“引发”声明？抱歉，暂时没有。SQL 标准 SIGNAL 和 RESIGNAL 语句在 TODO 上。*
> 
>   
>   
> 
> 也许 MySQL 5.2 将包含 SIGNAL 语句，这将使直接从 MySQL 存储过程编程中窃取的这个黑客过时。什么是黑客？您将强制 MySQL 尝试使用不存在的列。丑陋？是的。它有效吗？当然。
> 
> ```
> CREATE TRIGGER mytabletriggerexample
> BEFORE INSERT
> FOR EACH ROW BEGIN
> IF(NEW.important_value) < (fancy * dancy * calculation) THEN
>     DECLARE dummy INT;
> 
>     SELECT Your meaningful error message goes here INTO dummy 
>         FROM mytable
>       WHERE mytable.id=new.id
> END IF; END; 
> ```

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2010-04-22T20:07:26.583

这是我的做法。注意`SET NEW='some error';`. MySQL会告诉你“变量'new'不能设置为'错误：无法删除这个项目。销售表中有这个项目的记录。'”

您可以在代码中捕获它，然后显示结果错误:)

```
DELIMITER $$
DROP TRIGGER IF EXISTS before_tblinventoryexceptionreasons_delete $$
CREATE TRIGGER before_tblinventoryexceptionreasons_delete
BEFORE DELETE ON tblinventoryexceptionreasons
FOR EACH ROW BEGIN
  IF (SELECT COUNT(*) FROM tblinventoryexceptions WHERE tblinventoryexceptions.idtblinventoryexceptionreasons = old.idtblinventoryexceptionreasons) > 0
  THEN
    SET NEW='Error: Cannot delete this item. There are records in the inventory exception reasons table with this item.';
  END IF;
END$$
DELIMITER ;

DELIMITER $$
DROP TRIGGER IF EXISTS before_storesalesconfig_delete $$
CREATE TRIGGER before_storesalesconfig_delete
BEFORE DELETE ON tblstoresalesconfig
FOR EACH ROW BEGIN
  IF (SELECT COUNT(*) FROM tblstoresales WHERE tblstoresales.idtblstoresalesconfig=old.idtblstoresalesconfig) > 0
  THEN
    SET NEW='Error: Cannot delete this item. There are records in the sales table with this item.';
  END IF;
  IF (SELECT COUNT(*) FROM tblinventory WHERE tblinventory.idtblstoresalesconfig=old.idtblstoresalesconfig) > 0
  THEN
    SET NEW='Error: Cannot delete this item. There are records in the inventory table with this item.';
  END IF;
  IF (SELECT COUNT(*) FROM tblinventoryexceptions WHERE tblinventoryexceptions.idtblstoresalesconfig=old.idtblstoresalesconfig) > 0
  THEN
    SET NEW='Error: Cannot delete this item. There are records in the inventory exceptions table with this item.';
  END IF;
  IF (SELECT COUNT(*) FROM tblinvoicedetails WHERE tblinvoicedetails.idtblstoresalesconfig=old.idtblstoresalesconfig) > 0
  THEN
    SET NEW='Error: Cannot delete this item. There are records in the inventory details table with this item.';
  END IF;
END$$
DELIMITER ;

DELIMITER $$
DROP TRIGGER IF EXISTS before_tblinvoice_delete $$
CREATE TRIGGER before_tblinvoice_delete
BEFORE DELETE ON tblinvoice
FOR EACH ROW BEGIN
  IF (SELECT COUNT(*) FROM tblinvoicedetails WHERE tblinvoicedetails.idtblinvoice = old.idtblinvoice) > 0
  THEN
    SET NEW='Error: Cannot delete this item. There are records in the inventory details table with this item.';
  END IF;
END$$
DELIMITER ; 
```

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2014-09-30T07:34:46.340

因为这篇文章在我搜索 MySQL 触发器中的错误处理时排名靠前，所以我想我会分享一些知识。

如果出现错误，您可以强制 MySQL 使用[SIGNAL](http://dev.mysql.com/doc/refman/5.5/en/signal.html "信号")，但如果您不将其指定为 SQLEXCEPTION 类，则不会发生任何事情，因为并非所有 SQLSTATE 都被认为是坏的，即使那样您也必须如果您有任何嵌套的 BEGIN/END 块，请确保重新[签名。](http://dev.mysql.com/doc/refman/5.5/en/resignal.html "重新信号")

或者，可能更简单，在您的触发器中，声明一个退出处理程序并重新发出异常信号。

```
CREATE TRIGGER `my_table_AINS` AFTER INSERT ON `my_table` FOR EACH ROW
BEGIN
    DECLARE EXIT HANDLER FOR SQLEXCEPTION
        RESIGNAL;
    DECLARE EXIT HANDLER FOR SQLWARNING
        RESIGNAL;
    DECLARE EXIT HANDLER FOR NOT FOUND
        RESIGNAL; 
    -- Do the work of the trigger.
END 
```

如果你的身体发生错误，它会被抛回顶部并以错误退出。这也可以用于存储过程等。  

这适用于任何 5.5+ 版本。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T13:59:43.680

这将通过引发异常（来自[http://www.experts-exchange.com/Database/MySQL/Q_23788965.html](http://www.experts-exchange.com/Database/MySQL/Q_23788965.html)）中止您的 INSERT

```
DROP PROCEDURE IF EXISTS `MyRaiseError`$$

CREATE PROCEDURE `MyRaiseError`(msg VARCHAR(62))
BEGIN
DECLARE Tmsg VARCHAR(80);
SET Tmsg = msg;
IF (CHAR_LENGTH(TRIM(Tmsg)) = 0 OR Tmsg IS NULL) THEN
SET Tmsg = 'ERROR GENERADO';
END IF;
SET Tmsg = CONCAT('@@MyError', Tmsg, '@@MyError');
SET @MyError = CONCAT('INSERT INTO', Tmsg);
PREPARE stmt FROM @MyError;
EXECUTE stmt;
DEALLOCATE PREPARE stmt;
END$$ 
```

用法：

```
call MyRaiseError('Here error message!'); 
```

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2012-07-03T20:25:40.537

不能在触发器中工作（存储函数或触发器中不允许使用动态 SQL）

我使用了一个非常肮脏的解决方案：

`If NEW.test=1 then
  CALL TEST_CANNOT_BE_SET_TO_1;
end if;` 

当 test=1 Mysql 抛出如下异常：

PROCEDURE administratie.TEST_CANNOT_BE_SET_TO_1 不存在

不复杂但快速且有用。

* * *

## 回答 #6

> 赞同：-1
> 
>             
> 
> 时间：2008-10-23T14:01:49.917

在 MS SQL 中，您可以使用正确的语法使其工作：

```
IF UPDATE(column_name)
BEGIN
  RAISEERROR
  ROLLBACK TRAN
  RETURN
END 
```

[http://msdn.microsoft.com/en-us/magazine/cc164047.aspx](http://msdn.microsoft.com/en-us/magazine/cc164047.aspx)

# asp.net - VS 设计时用户控制 CSS 复制

> ID：229781
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-10-23T13:51:33.133
> 
>         
> 
> 标签：asp.net, css, design-time

当用户控件被拖放到 aspx 页面上时，我想避免在输出 html 中重复样式表链接标记。但是，如果您省略样式表链接标记，您将无法获得样式表的设计时支持。

有人知道解决这个问题的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-11-09T17:11:21.343

我建议看这个线程：

[如何让用户控件了解 ASP.NET 中的 CSS 类。](https://stackoverflow.com/questions/34390/how-to-make-user-controls-know-about-css-classes-in-aspnet)

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-10-23T13:59:15.817

虽然这会影响 HTML 的大小。我认为它不会影响您网页的整体性能。浏览器会缓存 CSS 客户端，所以它应该只下载一次。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-11-20T16:29:38.497

使用自定义设计器将样式表作为资源加载，并在呈现设计时 HTML 时应用样式。

# web-services - 为什么我要使用 WSDL 来描述 Web 服务？

> ID：229797
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2008-10-23T13:55:18.307
> 
>         
> 
> 标签：web-services, wsdl

我很难理解为什么 WSDL 会如此有益，而事实是服务定义不是那么可读，并且大多数开发人员将使用自动化工具来使用它以在应用程序中生成对象。为什么服务提供商不能更容易地定义一个简单的 XML 模式，并在文档中告诉我我可以获得什么以及如何获得它？我了解整个“通用定义”方面，但这一切对我来说似乎过于复杂。大多数用于社交网站的 API 都使用基本的 RESTful 架构，它们所做的只是为您提供将要返回的数据的模式表示。说真的，我一定在这里遗漏了一些东西。

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2008-10-23T14:01:04.583

曾经，WSDL 很流行，我确信对于许多公司（以及大型 SOA 系统）的内部工具，WSDL 仍在使用中。但是你是对的，一旦 WSDL “出现”，REST 的采用已经让 WSDL 脱离了地图。

以亚马逊 S3 为例。他们提供 WSDL 和 REST API。我在某处读到过，98% 的 S3 用户正在使用 REST API，而亚马逊正在考虑放弃对 WSDL 的支持。

REST 是干净的。WSDL 通常依赖于其他工具来解析它，或者为您的应用程序自动构建函数以从 WSDL 提供的服务中受益。REST 还具有通过利用 HTTP 而不再真正依赖任何东西而更加自然的好处。如果您将 SOAP 和与 WSDL 一起使用的许多其他首字母缩略词混在一起，您最终会得到很多东西......

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2008-10-23T13:58:35.303

那么，您会提出什么样的“简单 XML 模式”来让工具提供与现在相同级别的代码生成支持呢？

我认为 WSDL 设计者会争辩说，他们已经给出了他们所能提供的最简单的模式，这暴露了他们需要的一切。我并不是说我一定会同意，但是能够自动生成客户端是非常强大的。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2008-10-23T14:11:30.613

对我来说，WSDL 似乎是另一个过度设计的“洋葱架构”的例子，就像原始的 Java EJB 一样。很多层次和眼泪。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T14:12:52.437

一方面，WSDL 是自动化工具用来生成对象的东西。它已经是一种非常简单的 XML 格式，但我开始相信，让编写 XML 变得容易的工具永远不会存在。我认为没有人说它是比 REST 更好的协议，但它首先问世，具有强大的工具支持（Visual Studio 在创建和使用服务时完全抽象出来），而且它是一个标准，因此它可能会继续流行一会儿。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2008-10-23T14:01:28.683

WSDL 是 XML 表示文件和任何外部系统与您的 Web 服务通信的通信标准，无论其实现技术或平台。仅供参考，RESTful 服务也可以使用称为 WADL 的定义语言文件来描述服务。因此，这不仅仅是关于 Web 服务。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2008-10-23T14:04:09.163

这个链接应该可以帮助你。

[http://www.prescod.net/rest/rest_vs_soap_overview/](http://www.prescod.net/rest/rest_vs_soap_overview/)

这是一个很好的资源，可以帮助那些不了解 SOAP 与 REST 争论的人。它们是不同的工具。使用它们，以便您以最有效的方式解决问题。

# sql-server - TSQL 电子邮件验证（无正则表达式）

> ID：229824
> 
>         
> 
> 赞同：30
> 
>         
> 
> 时间：2008-10-23T14:00:19.730
> 
>         
> 
> 标签：sql-server, tsql, email-validation

好的，有一百万个正则表达式用于验证电子邮件地址，但是一些基本的电子邮件验证可以集成到 Sql Server 2005 的 TSQL 查询中吗？

我不想使用 CLR 过程或函数。只是直接的TSQL。

有没有人已经解决了这个问题？

* * *

## 回答 #1

> 赞同：54
> 
>             
> 
> 时间：2008-10-23T14:28:51.953

*非常*基本的是：

```
SELECT
  EmailAddress, 
  CASE WHEN EmailAddress LIKE '%_@_%_.__%' 
            AND EmailAddress NOT LIKE '%[any obviously invalid characters]%' 
  THEN 'Could be' 
  ELSE 'Nope' 
  END Validates
FROM 
  Table 
```

这将匹配中间带有@ 的所有内容，前面至少有一个字符，后跟至少两个字符，一个点，至少两个TLD。

你可以编写更多的`LIKE`模式来做更具体的事情，但是你永远无法匹配所有可能是电子邮件地址的东西，同时又不会漏掉不是的东西。即使使用正则表达式，你也很难做到正确。此外，即使根据 RFC 的字母进行匹配，也会匹配大多数电子邮件系统不会接受/使用的地址结构。

无论如何，在数据库级别执行此操作可能是错误的方法，因此如上所述的基本完整性检查可能是您可以获得的最佳性能，并且在应用程序中执行此操作将为您提供更大的灵活性。

* * *

## 回答 #2

> 赞同：20
> 
>             
> 
> 时间：2009-08-28T07:28:40.820

这是一个更详细的示例函数，我不记得我从哪里得到它（几年前），或者我是否修改过它，否则我会包括适当的归属：

```
CREATE FUNCTION [dbo].[fnAppEmailCheck](@email VARCHAR(255))   
--Returns true if the string is a valid email address.  
RETURNS bit  
as  
BEGIN  
     DECLARE @valid bit  
     IF @email IS NOT NULL   
          SET @email = LOWER(@email)  
          SET @valid = 0  
          IF @email like '[a-z,0-9,_,-]%@[a-z,0-9,_,-]%.[a-z][a-z]%'  
             AND LEN(@email) = LEN(dbo.fnAppStripNonEmail(@email))  
             AND @email NOT like '%@%@%'  
             AND CHARINDEX('.@',@email) = 0  
             AND CHARINDEX('..',@email) = 0  
             AND CHARINDEX(',',@email) = 0  
             AND RIGHT(@email,1) between 'a' AND 'z'  
               SET @valid=1  
     RETURN @valid  
END 
```

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2016-05-27T19:47:44.230

很好的答案！基于这些建议，我想出了一个结合了最佳 2 个答案的简化函数。

```
CREATE FUNCTION [dbo].[fnIsValidEmail]
(
    @email varchar(255)
)   
--Returns true if the string is a valid email address.  
RETURNS bit  
As  
BEGIN
    RETURN CASE WHEN ISNULL(@email, '') <> '' AND @email LIKE '%_@%_.__%' THEN 1 ELSE 0 END
END 
```

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2016-02-02T17:39:51.470

分数下缺少 FnAppStripNonEmail，需要将其添加到保留值

```
Create Function [dbo].[fnAppStripNonEmail](@Temp VarChar(1000))
Returns VarChar(1000)
AS
Begin

    Declare @KeepValues as varchar(50)
    Set @KeepValues = '%[^a-z,0-9,_,@,.,-]%'
    While PatIndex(@KeepValues, @Temp) > 0
        Set @Temp = Stuff(@Temp, PatIndex(@KeepValues, @Temp), 1, '')

    Return @Temp
End 
```

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2017-04-24T13:45:51.050

```
CREATE FUNCTION fnIsValidEmail
(
    @email varchar(255)
)
RETURNS bit
AS
BEGIN

    DECLARE @IsValidEmail bit = 0

    IF (@email not like '%[^a-z,0-9,@,.,!,#,$,%%,&,'',*,+,--,/,=,?,^,_,`,{,|,},~]%' --First Carat ^ means Not these characters in the LIKE clause. The list is the valid email characters.
        AND @email like '%_@_%_.[a-z,0-9][a-z]%'
        AND @email NOT like '%@%@%'  
        AND @email NOT like '%..%'
        AND @email NOT like '.%'
        AND @email NOT like '%.'
        AND CHARINDEX('@', @email) <= 65
        )
    BEGIN
        SET @IsValidEmail = 1
    END

    RETURN @IsValidEmail

END 
```

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2017-11-17T12:35:56.463

在 SQL 2016 或 +

```
CREATE FUNCTION [DBO].[F_IsEmail] (
 @EmailAddr varchar(360) -- Email address to check
)   RETURNS BIT -- 1 if @EmailAddr is a valid email address

AS BEGIN
DECLARE @AlphabetPlus VARCHAR(255)
      , @Max INT -- Length of the address
      , @Pos INT -- Position in @EmailAddr
      , @OK BIT  -- Is @EmailAddr OK
-- Check basic conditions
IF @EmailAddr IS NULL 
   OR @EmailAddr NOT LIKE '[0-9a-zA-Z]%@__%.__%' 
   OR @EmailAddr LIKE '%@%@%' 
   OR @EmailAddr LIKE '%..%' 
   OR @EmailAddr LIKE '%.@' 
   OR @EmailAddr LIKE '%@.' 
   OR @EmailAddr LIKE '%@%.-%' 
   OR @EmailAddr LIKE '%@%-.%' 
   OR @EmailAddr LIKE '%@-%' 
   OR CHARINDEX(' ',LTRIM(RTRIM(@EmailAddr))) > 0
       RETURN(0)

declare @AfterLastDot varchar(360);
declare @AfterArobase varchar(360);
declare @BeforeArobase varchar(360);
declare @HasDomainTooLong bit=0;

--Control des longueurs et autres incoherence
set @AfterLastDot=REVERSE(SUBSTRING(REVERSE(@EmailAddr),0,CHARINDEX('.',REVERSE(@EmailAddr))));
if  len(@AfterLastDot) not between 2 and 17
RETURN(0);

set @AfterArobase=REVERSE(SUBSTRING(REVERSE(@EmailAddr),0,CHARINDEX('@',REVERSE(@EmailAddr))));
if len(@AfterArobase) not between 2 and 255
RETURN(0);

select top 1 @BeforeArobase=value from  string_split(@EmailAddr, '@');
if len(@AfterArobase) not between 2 and 255
RETURN(0);

--Controle sous-domain pas plus grand que 63
select top 1 @HasDomainTooLong=1 from string_split(@AfterArobase, '.') where LEN(value)>63
if @HasDomainTooLong=1
return(0);

--Control de la partie locale en detail
SELECT @AlphabetPlus = 'abcdefghijklmnopqrstuvwxyz01234567890!#$%&‘*+-/=?^_`.{|}~'
     , @Max = LEN(@BeforeArobase)
     , @Pos = 0
     , @OK = 1

WHILE @Pos < @Max AND @OK = 1 BEGIN
    SET @Pos = @Pos + 1
    IF @AlphabetPlus NOT LIKE '%' + SUBSTRING(@BeforeArobase, @Pos, 1) + '%' 
        SET @OK = 0
END

if @OK=0
RETURN(0);

--Control de la partie domaine en detail
SELECT @AlphabetPlus = 'abcdefghijklmnopqrstuvwxyz01234567890-.'
     , @Max = LEN(@AfterArobase)
     , @Pos = 0
     , @OK = 1

WHILE @Pos < @Max AND @OK = 1 BEGIN
    SET @Pos = @Pos + 1
    IF @AlphabetPlus NOT LIKE '%' + SUBSTRING(@AfterArobase, @Pos, 1) + '%' 
        SET @OK = 0
END

if @OK=0
RETURN(0);

return(1);

END 
```

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2014-09-22T16:38:00.310

```
Create Function [dbo].[fnAppStripNonEmail](@Temp VarChar(1000))
Returns VarChar(1000)
AS
Begin

    Declare @KeepValues as varchar(50)
    Set @KeepValues = '%[^a-z,0-9,@,.,-]%'
    While PatIndex(@KeepValues, @Temp) > 0
        Set @Temp = Stuff(@Temp, PatIndex(@KeepValues, @Temp), 1, '')

    Return @Temp
End 
```

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2015-03-10T11:23:49.903

这是选择它们的最简单方法。

使用此查询

```
SELECT * FROM <TableName> WHERE [EMail] NOT LIKE '%_@__%.__%' 
```

* * *

## 回答 #9

> 赞同：-2
> 
>             
> 
> 时间：2010-05-11T10:19:00.793

来自托马拉克的选择

```
select 1
where @email not like '%[^a-z,0-9,@,.]%'
and @email like '%_@_%_.__%' 
```

# html - 如果内容小于限制，如何将滚动条添加到我的 HTML 中消失

> ID：229831
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2008-10-23T14:02:24.720
> 
>         
> 
> 标签：html, css, scrollbar

我正在尝试创建一个具有可扩展小部件的表单。问题是，当小部件打开时，表单超出了内容框中的限制，看起来很糟糕。

我尝试使用`overflow:scroll`，但它创建了 2 个丑陋的滚动条，即使内容小于内容框，它们也不会消失。我只需要一个垂直滚动条。

Visual Studio 还警告在 CSS 中没有溢出-y。

* * *

## 回答 #1

> 赞同：15
> 
>             
> 
> 时间：2008-10-23T14:04:29.363

将溢出更改为`auto`并定义元素的高度和/或宽度。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-10-23T14:48:46.170

`overflow-x`并且`overflow-y`是 CSS3 提案的一部分，适用于四大浏览器的所有当前版本。

我通常这样做：

```
overflow: auto;
overflow-x: auto;
overflow-y: auto; 
```

原因是有时浏览器会在内容向一个方向溢出时立即将`overflow: auto`其视为（两个丑陋的滚动条），但那些浏览器已经支持and ，它具有优先权。`overflow: scroll``overflow-x``overflow-y`

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T14:14:11.623

Swilliams 就如何治疗这种症状给出了很好的答案。但是，您可能也想考虑根本原因 - 如果内容框没有被限制为固定大小，它可以缩小和/或扩展以适应任何大小的形式，而没有滚动条。网页在设计上是灵活的，并且试图“修复”这种灵活性通常最终会遇到此类问题。

# metaphone - 双变位错误

> ID：229834
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-10-23T14:03:36.277
> 
>         
> 
> 标签：metaphone, soundex, algorithm

我正在使用[Lawrence Philips Double-Metaphone](http://www.ddj.com/cpp/184401251?pgno=2)算法取得了巨大成功，但我发现某些组合出现了奇怪的“意外结果”。

是否有其他人对算法的其他部分进行了添加或更改，他们不介意共享，或者只是他们发现无法按预期工作的组合。

例如。我有以下问题：

*   皮希尔和布什利。（均与 PXL 匹配）

*   罗克利夫和罗克利夫（RKLF 和 RKKL）

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2008-10-23T16:21:58.120

所有 Soundex、Metaphone 和变体方案有时会给出与您预期不同的结果。这是不可避免的——它们或多或少可以被视为具有特殊信息保留属性的简单哈希算法，有时会在您不希望它们不发生冲突时产生冲突，而当您不希望它们不这样做时有时会产生差异.

改进事物的一种可能方法是使用“同义词环”。这基本上产生了应该被视为同义词的单词列表，与拼写无关。我在名称匹配的上下文中遇到了它们。例如，Chaudri 的变体包括：

CHAUDARY CHAUDERI CHAUDERY CHAUDHARY CHAUDHERI CHAUDHERY CHAUDHRI CHAUDHRY乔杜里·乔杜里CHAUDHY绍德雷CHAUDRI乔德里CHAUDURI CHAWDHARY CHAWDHRY CHAWDHURY CHDRY CHODARY CHODHARI CHODHOURY CHODHRY CHODREY CHODRY CHODURY CHOUDARI CHOUDARY CHOUDERY CHOUDHARI CHOUDHARY CHOUDHERY CHOUDHOURY CHOUDHRI乔德里CHOUDHURI乔杜里CHOUDREY CHOUDRI CHOUDRY CHOUDURY CHOUWDHRY CHOWDARI CHOWDARY CHOWDHARY CHOWDHERY CHOWDHRI乔杜里CHOWDHURI CHOWDHURRYY乔杜里 乔杜里 乔杜里 乔杜里 乔杜里 乔杜里 乔杜里 乔杜里 乔杜里 乔杜里 乔杜里

* * *

## 回答 #2

> 赞同：-1
> 
>             
> 
> 时间：2008-12-12T22:47:56.780

常规变音器正在返回 Peashill 和 Bushley 之间的差异

Peashill PXL 布什利 BXL

# c# - Visual C# 2005 是否有字符串表资源？

> ID：229844
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2008-10-23T14:06:10.407
> 
>         
> 
> 标签：c#, visual-studio, localization

作为一名在 Visual C++ 6 中工作多年的开发人员，我习惯于使用字符串表资源来存储用于本地化的 unicode 字符串。Visual Studio 2005 中是否有提供相同功能的资源？是否有任何第三方库或工具？

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2008-10-23T14:07:07.533

[ResourceManager](https://docs.microsoft.com/en-us/dotnet/api/system.resources.resourcemanager)是你的朋友——是的，Visual Studio 仍然在编辑器中支持它。您可能还想阅读“[编码和本地化](https://docs.microsoft.com/en-us/dotnet/standard/globalization-localization)”。如果你真的很感兴趣，我可以彻底推荐[Guy Smith-Ferrier 关于 .NET i18n 的书](https://rads.stackoverflow.com/amzn/click/com/0321341384)。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T17:29:29.310

简短的回答是“resources.resx”——如果你为你的新项目使用了一个模板，你可能已经有了一个。打开它，然后下拉“资源类型”选择器并选择字符串。您可以将它们作为（项目名称空间）.Properties.Resources.（字符串名称）访问，尽管您可能需要在其前面加上“global::”。

当然，正如 Jon 所指出的，对于多语言本地化，您可以独立访问多个资源文件。

# windows - 克服“它正在被另一个人或程序使用”。

> ID：229851
> 
>         
> 
> 赞同：25
> 
>         
> 
> 时间：2008-10-23T14:08:54.003
> 
>         
> 
> 标签：windows, permissions, locking

有没有办法在不下载实用程序的情况下解锁 Windows 文件？

我的 Windows XP C: 驱动器上有一些非常旧且非常无用的文件。当我尝试删除这些文件时，我收到以下消息：

```
无法删除 FILENAME.zip：它正被其他人或程序使用

关闭所有可能正在使用该文件的程序，然后重试。

```

没有人访问此文件。目前没有程序在使用它。Windows 搞砸了文件锁定机制。  

有没有办法在不下载某人的解锁实用程序的情况下删除此文件？我发现提供这些程序的网站有点粗略。

你怎么能强制文件从程序中解锁？我精通 Java、Perl 和 Ruby，但我在他们的库中没有看到任何可以帮助我的东西。

* * *

## 回答 #1

> 赞同：32
> 
>             
> 
> 时间：2008-10-23T14:17:55.030

我已成功使用 Process Explorer 找出打开文件的进程。它节省了可能无法解决问题的重新启动。

在进程资源管理器中：查找 > 句柄或 DLL... 然后搜索文件夹/文件的名称，然后双击搜索结果之一。它将在主窗口中选择一个句柄，您可以右键单击并关闭它。

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2008-10-23T18:50:49.693

尝试下载“解锁器”。谷歌它并相信它没有任何蠕虫/间谍软件/病毒。这是一个非常酷的实用程序，效果很好。试试看。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2008-10-23T14:15:10.403

您是否尝试过命令行命令[OpenFiles](http://technet.microsoft.com/en-us/library/cc732490.aspx)

它是内置的（我相信是 XP 及更高版本），并且有几个可以传入的参数。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2008-10-23T14:15:07.393

使用 msconfig 并在一切关闭的情况下启动。

然后尝试移动/删除文件。

或者您可以随时以安全模式启动并删除它。

您可以通过在机器启动时按 f8 来做到这一点。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T14:12:34.370

如果您重新启动并且文件仍然被锁定，那么您的机器上有一些进程**仍在**使用它们。首先，您应该弄清楚该过程是什么，并确定这些文件是否真的不再被使用。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T14:34:17.947

重新启动到安全模式通常是一种非常简单的方法。当您以安全模式启动时，它不会加载所有设置为在启动时运行的东西。在启动时按 F8 进入启动菜单，然后选择“安全模式”。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2012-08-27T18:17:41.617

我有一个 .jpg pfile 有这个问题，我无法删除。这让我想到了这个话题。当没有其他工作时，我重命名了文件并放弃了.jpg。然后我可以轻松地删除它。不知道为什么，但对我有用

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2008-10-24T15:32:14.243

您不需要任何实用程序。只需使用 Win32 api 解锁它们（只需关闭手柄）

# java - 将枚举保存在数据库中的方法

> ID：229856
> 
>         
> 
> 赞同：139
> 
>         
> 
> 时间：2008-10-23T14:11:15.093
> 
>         
> 
> 标签：java, database, enums

将枚举保存到数据库中的最佳方法是什么？

我知道 Java 提供了将枚举值转换为字符串并返回的方法`name()`。`valueOf()`但是还有其他（灵活的）选项来存储这些值吗？

有没有一种聪明的方法可以将枚举变成唯一的数字（`ordinal()`使用不安全）？

**更新：**

感谢所有真棒和快速的答案！正如我所怀疑的那样。

但是，请注意“工具包”；这是一种方式。问题是我必须向我创建的每个 Enum 类型添加相同的方法。那是很多重复的代码，目前，Java 不支持任何解决方案（Java 枚举不能扩展其他类）。

* * *

## 回答 #1

> 赞同：178
> 
>             
> 
> 时间：2008-10-23T14:21:58.300

我们*不再*将枚举存储为数字序数值；它使调试和支持变得太困难了。我们存储转换为字符串的实际枚举值：

```
public enum Suit { Spade, Heart, Diamond, Club }

Suit theSuit = Suit.Heart;

szQuery = "INSERT INTO Customers (Name, Suit) " +
          "VALUES ('Ian Boyd', %s)".format(theSuit.name()); 
```

然后回读：

```
Suit theSuit = Suit.valueOf(reader["Suit"]); 
```

问题在于过去盯着 Enterprise Manager 并试图破译：

```
Name          Suit
------------  ----
Kylie Guénin  2
Ian Boyd      1 
```

诗句

```
Name          Suit
------------  -------
Kylie Guénin  Diamond
Ian Boyd      Heart 
```

后者要容易得多。前者需要获取源代码并找到分配给枚举成员的数值。

是的，它需要更多空间，但是枚举成员名称很短，而且硬盘很便宜，当您遇到问题时，更值得帮助。

此外，如果您使用数值，您将被绑定到它们。您不能很好地插入或重新排列成员，而不必强制使用旧的数值。例如，将 Suit 枚举更改为：

```
public enum Suit { Unknown, Heart, Club, Diamond, Spade } 
```

将不得不成为：

```
public enum Suit { 
      Unknown = 4,
      Heart = 1,
      Club = 3,
      Diamond = 2,
      Spade = 0 } 
```

为了维护存储在数据库中的旧数值。

## 如何在数据库中对它们进行排序

问题出现了：假设我想订购这些值。有些人可能希望按`enum`' 的序数值对它们进行排序。当然，按枚举的数值排序卡片是没有意义的：

```
SELECT Suit FROM Cards
ORDER BY SuitID; --where SuitID is integer value(4,1,3,2,0)

Suit
------
Spade
Heart
Diamond
Club
Unknown 
```

这不是我们想要的顺序 - 我们希望它们按枚举顺序：

```
SELECT Suit FROM Cards
ORDER BY CASE SuitID OF
    WHEN 4 THEN 0 --Unknown first
    WHEN 1 THEN 1 --Heart
    WHEN 3 THEN 2 --Club
    WHEN 2 THEN 3 --Diamond
    WHEN 0 THEN 4 --Spade
    ELSE 999 END 
```

如果保存字符串，则需要进行与保存整数值相同的工作：

```
SELECT Suit FROM Cards
ORDER BY Suit; --where Suit is an enum name

Suit
-------
Club
Diamond
Heart
Spade
Unknown 
```

但这不是我们想要的顺序 - 我们希望它们按枚举顺序：

```
SELECT Suit FROM Cards
ORDER BY CASE Suit OF
    WHEN 'Unknown' THEN 0
    WHEN 'Heart'   THEN 1
    WHEN 'Club'    THEN 2
    WHEN 'Diamond' THEN 3
    WHEN 'Space'   THEN 4
    ELSE 999 END 
```

我的看法是，这种排名属于用户界面。如果您根据枚举值对项目进行排序：您做错了。

但如果你真的想这样做，我会创建一个`Suits` [维度表](https://en.wikipedia.org/wiki/Dimension_(data_warehouse))：

 套装 |
 西装编号 |
 秩 |
 颜色 |

| --- | --- | --- | --- | --- | --- | --- | --- | --- |

 未知 |
 4 |
 0 |
 空值 |

 心 |
 1 |
 1 |
 红色的 |

 俱乐部 |
 3 |
 2 |
 黑色的 |

 钻石 |
 2 |
 3 |
 红色的 |

 铲 |
 0 |
 4 |
 黑色的 |

这样，当您想更改您的卡片以使用[***Kissing Kings* New Deck Order**](https://www.quora.com/When-you-buy-a-deck-of-cards-does-it-come-mixed-or-in-order)时，您可以将其更改为显示目的，而不会丢弃所有数据：

 套装 |
 西装编号 |
 秩 |
 颜色 |
 卡令 |

| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

 未知 |
 4 |
 0 |
 空值 |
 空值 |

 铲 |
 0 |
 1 |
 黑色的 |
 1 |

 钻石 |
 2 |
 2 |
 红色的 |
 1 |

 俱乐部 |
 3 |
 3 |
 黑色的 |
 -1 |

 心 |
 1 |
 4 |
 红色的 |
 -1 |

现在，我们将内部编程细节（枚举名称、枚举值）与用于用户的显示设置分开：

```
SELECT Cards.Suit 
FROM Cards
   INNER JOIN Suits ON Cards.Suit = Suits.Suit
ORDER BY Suits.Rank, 
   Card.Rank*Suits.CardOrder 
```

* * *

## 回答 #2

> 赞同：48
> 
>             
> 
> 时间：2009-01-06T05:55:57.977

除非您有特定的性能原因来避免它，否则我建议您使用单独的表进行枚举。使用外键完整性，除非额外的查找真的要了你的命。

### 适合表：

```
suit_id suit_name
1       Clubs
2       Hearts
3       Spades
4       Diamonds 
```

### 球员表

```
player_name suit_id
Ian Boyd           4
Shelby Lake        2 
```

1.  如果您曾经将枚举重构为具有行为（例如优先级）的类，那么您的数据库已经对其进行了正确建模

2.  您的 DBA 很高兴，因为您的模式已标准化（为每个玩家存储一个整数，而不是整个字符串，可能有也可能没有错别字）。

3.  您的数据库值 ( `suit_id`) 独立于您的枚举值，这也有助于您处理来自其他语言的数据。

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2008-10-23T14:24:23.553

正如你所说，序数有点冒险。考虑例如：

```
public enum Boolean {
    TRUE, FALSE
}

public class BooleanTest {
    @Test
    public void testEnum() {
        assertEquals(0, Boolean.TRUE.ordinal());
        assertEquals(1, Boolean.FALSE.ordinal());
    }
} 
```

如果您将其存储为序数，您可能会有如下行：

```
> SELECT STATEMENT, TRUTH FROM CALL_MY_BLUFF

"Alice is a boy"      1
"Graham is a boy"     0 
```

但是如果你更新布尔值会发生什么？

```
public enum Boolean {
    TRUE, FILE_NOT_FOUND, FALSE
} 
```

这意味着你所有的谎言都会被误解为“找不到文件”

最好只使用字符串表示

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2008-10-23T14:18:42.813

我认为这里唯一安全的机制是使用 String`name()`值。写入数据库时​​，您*可以*使用 sproc 插入值，读取时使用视图。以这种方式，如果枚举发生变化，则存储过程/视图中存在一定程度的间接性，以便能够将数据呈现为枚举值，而不会将其“强加”在数据库上。

* * *

## 回答 #5

> 赞同：4
> 
>             
> 
> 时间：2008-10-23T14:39:18.903

我们只存储枚举名称本身 - 它更具可读性。

我们确实为存在一组有限值的枚举存储了特定值，例如，这个枚举具有一组有限的状态，我们使用 char 来表示（比数值更有意义）：

```
public enum EmailStatus {
    EMAIL_NEW('N'), EMAIL_SENT('S'), EMAIL_FAILED('F'), EMAIL_SKIPPED('K'), UNDEFINED('-');

    private char dbChar = '-';

    EmailStatus(char statusChar) {
        this.dbChar = statusChar;
    }

    public char statusChar() {
        return dbChar;
    }

    public static EmailStatus getFromStatusChar(char statusChar) {
        switch (statusChar) {
        case 'N':
            return EMAIL_NEW;
        case 'S':
            return EMAIL_SENT;
        case 'F':
            return EMAIL_FAILED;
        case 'K':
            return EMAIL_SKIPPED;
        default:
            return UNDEFINED;
        }
    }
} 
```

当你有很多值时，你需要在你的枚举中有一个 Map 来保持 getFromXYZ 方法很小。

* * *

## 回答 #6

> 赞同：4
> 
>             
> 
> 时间：2008-10-23T15:06:49.410

对于大型数据库，我不愿意失去数字表示的大小和速度优势。我经常得到一个代表枚举的数据库表。

您可以通过声明外键来强制数据库一致性——尽管在某些情况下最好不要将其声明为外键约束，因为这会为每个事务带来成本。您可以通过在您选择的时间定期进行检查来确保一致性：

```
SELECT reftable.* FROM reftable
  LEFT JOIN enumtable ON reftable.enum_ref_id = enumtable.enum_id
WHERE enumtable.enum_id IS NULL; 
```

该解决方案的另一半是编写一些测试代码来检查 Java 枚举和数据库枚举表是否具有相同的内容。这留给读者作为练习。

* * *

## 回答 #7

> 赞同：3
> 
>             
> 
> 时间：2016-05-27T00:48:00.467

我遇到了同样的问题，我的目标是将 Enum String 值而不是 Ordinal 值持久保存到数据库中。

为了解决这个问题，我已经使用`@Enumerated(EnumType.STRING)`并且我的目标得到了解决。

例如，您有一个`Enum`类：

```
public enum FurthitMethod {

    Apple,
    Orange,
    Lemon
} 
```

在实体类中，定义`@Enumerated(EnumType.STRING)`：

```
@Enumerated(EnumType.STRING)
@Column(name = "Fruits")
public FurthitMethod getFuritMethod() {
    return fruitMethod;
}

public void setFruitMethod(FurthitMethod authenticationMethod) {
    this.fruitMethod= fruitMethod;
} 
```

当您尝试将值设置为数据库时，字符串值将作为“ `APPLE`”、“ `ORANGE`”或“ `LEMON`”保存到数据库中。

* * *

## 回答 #8

> 赞同：2
> 
>             
> 
> 时间：2008-10-23T18:00:13.523

如果将枚举保存为数据库中的字符串，您可以创建实用方法来（反）序列化任何枚举：

```
 public static String getSerializedForm(Enum<?> enumVal) {
        String name = enumVal.name();
        // possibly quote value?
        return name;
    }

    public static <E extends Enum<E>> E deserialize(Class<E> enumType, String dbVal) {
        // possibly handle unknown values, below throws IllegalArgEx
        return Enum.valueOf(enumType, dbVal.trim());
    }

    // Sample use:
    String dbVal = getSerializedForm(Suit.SPADE);
    // save dbVal to db in larger insert/update ...
    Suit suit = deserialize(Suit.class, dbVal); 
```

* * *

## 回答 #9

> 赞同：2
> 
>             
> 
> 时间：2015-07-09T23:22:51.390

我所有的经验告诉我，在任何地方持久化枚举的最安全方法是使用额外的代码值或 id（@jeebee 答案的某种演变）。这可能是一个很好的想法示例：

```
enum Race {
    HUMAN ("human"),
    ELF ("elf"),
    DWARF ("dwarf");

    private final String code;

    private Race(String code) {
        this.code = code;
    }

    public String getCode() {
        return code;
    }
} 
```

现在，您可以使用任何通过代码引用枚举常量的持久性。即使您决定更改一些常量名称，您也始终可以保存代码值（例如`DWARF("dwarf")`to `GNOME("dwarf")`）

好的，深入了解这个概念。这是一些实用方法，可以帮助您找到任何枚举值，但首先让我们扩展我们的方法。

```
interface CodeValue {
    String getCode();
} 
```

让我们的枚举实现它：

```
enum Race implement CodeValue {...} 
```

这是魔术搜索方法的时间：

```
static <T extends Enum & CodeValue> T resolveByCode(Class<T> enumClass, String code) {
    T[] enumConstants = enumClass.getEnumConstants();
    for (T entry : enumConstants) {
        if (entry.getCode().equals(code)) return entry;
    }
    // In case we failed to find it, return null.
    // I'd recommend you make some log record here to get notified about wrong logic, perhaps.
    return null;
} 
```

并像魅力一样使用它：`Race race = resolveByCode(Race.class, "elf")`

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2012-01-31T17:47:43.090

一个枚举字段具有 OR 关系的多个值。.NET 的概念，将枚举类型存储在数据库中，如字节或 int，并在代码中使用 FlagsAttribute。

[http://blogs.msdn.com/b/efdesign/archive/2011/06/29/enumeration-support-in-entity-framework.aspx](http://blogs.msdn.com/b/efdesign/archive/2011/06/29/enumeration-support-in-entity-framework.aspx)

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2020-01-03T08:51:54.763

您可以在枚举常量中使用一个额外的值，该值可以在名称更改和枚举的重新使用中幸存下来：

```
public enum MyEnum {
    MyFirstValue(10),
    MyFirstAndAHalfValue(15),
    MySecondValue(20);

    public int getId() {
        return id;
    }
    public static MyEnum of(int id) {
        for (MyEnum e : values()) {
            if (id == e.id) {
                return e;
            }
        }
        return null;
    }
    MyEnum(int id) {
        this.id = id;
    }
    private final int id;
} 
```

要从枚举中获取 id：

```
int id = MyFirstValue.getId(); 
```

要从 id 获取枚举：

```
MyEnum e = MyEnum.of(id); 
```

如果必须更改枚举名称，我建议使用没有意义的值以避免混淆。

在上面的示例中，我使用了“基本行编号”的一些变体，留下空格，因此数字可能与枚举保持相同的顺序。

这个版本比使用二级表要快，但是它让系统更加依赖代码和源码知识。

为了解决这个问题，您也可以在数据库中设置一个包含枚举 ID 的表。或者换一种方式，在向表中添加行时从表中选择枚举的 ID。

**旁注**：始终确认您没有设计应该存储在数据库表中并作为常规对象维护的东西。如果您可以想象此时您必须向枚举添加新常量，那么当您设置它时，这表明您最好创建一个常规对象和一个表。

# vba - 将突出显示的文本更改为不同的颜色

> ID：229865
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2008-10-23T14:13:05.087
> 
>         
> 
> 标签：vba, ms-word, highlighting, word-2007

我在 Word 2007 中制作了一些简单的 .doc 文件，我在其中更改了文本颜色并使用高亮显示来比较一些相似的文本。我想做的是将绿色文本或灰色突出显示的任何实例更改为各自不同的颜色。

我敢肯定有一种简单的方法可以用 VBA 做到这一点，但也欢迎任何其他类型的答案。

编辑：虽然我很欣赏答案，但首选允许我将 .doc 文件保留为 .docs 的答案。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-10-23T22:10:51.020

这不是从 2007 年开始的，但这个想法应该适合。此示例将任何当前突出显示更改为新的默认突出显示 (wdBrightGreen)，并将任何绿色文本更改为红色。

```
Sub ChangeColor
Options.DefaultHighlightColorIndex = wdBrightGreen

    Selection.Find.ClearFormatting
    Selection.Find.Highlight = True
    Selection.Find.Replacement.ClearFormatting
    Selection.Find.Replacement.Highlight = True
    Selection.Find.Execute Replace:=wdReplaceAll

    Selection.Find.ClearFormatting
    Selection.Find.Font.Color = wdColorBrightGreen
    Selection.Find.Replacement.ClearFormatting
    Selection.Find.Replacement.Font.Color = wdColorRed
    With Selection.Find
        .Text = ""
        .Replacement.Text = ""
        .Forward = True
        .Wrap = wdFindContinue
    End With
    Selection.Find.Execute Replace:=wdReplaceAll
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T15:57:18.887

您始终可以将文件另存为 HTML，并在那里替换颜色。颜色用

```
<span style='color:red'>... 
```

重点是

```
<span style='background:yellow;mso-highlight:yellow'>... 
```

如果您的文档足够简单，应该很容易操作。

回答问题中的编辑的编辑：完成后，重新打开文件并将文件另存为 .doc。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2012-02-15T01:19:51.663

我认为可以突出显示彩色文本的一部分，然后从“主页”选项卡上的选择文本菜单选项中选择“选择具有相似格式的文本”选项。然后只需选择所需的文本颜色。希望这有效。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-02-27T16:20:41.733

这应该适用于您的目的：

```
Sub RehiliteAll()

    Const YOUR_REQUIRED_COLOR_IDX As Integer = 6 'RED'
    Dim doc As Range
    Set doc = ActiveDocument.Range

    With doc.Find
        .ClearFormatting 'resets default search options'
        .Highlight = True
        .Wrap = wdFindStop

        While .Execute

            If doc.HighlightColorIndex = YOUR_REQUIRED_COLOR_IDX Then
                doc.Select
                MsgBox doc.HighlightColorIndex
                'Do stuff here'
            End If

            'doc has been reassigned to the matching'
            'range; we do this so word keeps searching'
            'forward'
            doc.Collapse wdCollapseEnd
        Wend
    End With

    Set doc = Nothing
End Sub

'I am closing comment quotes so that SO formatting'
'does not get messed up too much.' 
```

# vb6 - 如何编译旧版 VB6 代码

> ID：229868
> 
>         
> 
> 赞同：13
> 
>         
> 
> 时间：2008-10-23T14:13:39.050
> 
>         
> 
> 标签：vb6

我们继承了需要对其进行更改的 VB6 dll。我们有代码但没有 VB6 编译器。我们如何重建dll？我们可以从哪里下载 VB6 环境/编译器？提前致谢。

* * *

## 回答 #1

> 赞同：18
> 
>             
> 
> 时间：2008-10-23T14:15:23.303

VB6 仍然作为 MSDN 订阅的一部分提供。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T18:29:40.780

看起来您现在可以获得 VB6，但只能通过购买 Visual Studio 2005 / 2008 和“降级”。  [来源。](http://social.msdn.microsoft.com/Forums/en-US/vbgeneral/thread/fdc67d40-f434-49b6-b626-a9c50bf23429/)

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2013-08-29T18:49:32.723

我认为您的 eBay 区域网站 - 美国的 eBay.com - 将是您的最佳选择。

但是，在购买之前，请确保您购买的是合法软件。请查看以下链接：
 [ebay 软件购买指南，](http://www.ebay.com/gds/How-to-Buy-Legal-Software-on-an-Auction-Site-/10000000004661417/g.html)
并请对您所在国家/地区的相关版权法进行一些研究。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2017-09-12T05:54:31.990

这是 MSDN 订阅者链接。您还可以在 MSDN 网站上搜索：“Visual Basic 6.0”

好像是[两盘下载](https://my.visualstudio.com/Downloads?q=vb6)

* * *

## 回答 #5

> 赞同：-5
> 
>             
> 
> 时间：2008-10-23T18:12:25.853

您可以将旧版 VB6 代码导入到较新版本的 Visual Studio 中。

只需使用*File → Open → Convert*打开 VB6 项目，它就会自动将 VB6 代码升级到当前版本。

# asp.net - imagebutton中的gridview动态图像变化

> ID：229870
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-23T14:14:07.003
> 
>         
> 
> 标签：asp.net, gridview

我有一个包含来自 db 的一些数据的 gridview，在检查后，由于检查的结果，我想在每一行中看到一个小的十字/刻度图像。如何动态更改图像 url？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2010-09-11T03:11:12.063

您可以使用内联语句，例如

`<%#Eval("check").ToString() == "1" ? "images/checked.gif" : "images/unchceked.gif")%>`

或使用函数获取结果如下：

```
<%# getImageUrl(Eval("value")) %>
Public Function getImageUrl(ByVal value As Integer) As String
   If value = 0 Then
      Return "images/unchceked.gif"
   Else
      Return "mages/checked.gif"
   End If
End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2010-12-27T14:26:32.613

通知：

```
<Columns>
    <asp:TemplateField>
        <ItemTemplate>
            <asp:ImageButton ID="check" runat="server" ImageUrl='<%# GetImageUrl(Eval("Check")) %>' />
        </ItemTemplate>
    </asp:TemplateField>
</Columns> 
```

代码隐藏：

```
public string GetImageUrl(object checkObject)
{
     if (checkObject!= null)
     {
          bool check;
          bool parsable = bool.Parse(checkObject.ToString(), out check);
          check= parsable ? check : false;

          return check ? "~/Media/Images/tick.png" : "~/Media/Images/untick.png";
     }

     return "~/Media/Images/none.png";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-30T20:25:49.943

```
<Columns>
    <asp:TemplateField>
        <ItemTemplate>
            <asp:Image ID="check" runat="server" ImageUrl='<%#If(Eval("check") = 1,"images/checked.gif","images/unchceked.gif") %>' />
        </ItemTemplate>
    </asp:TemplateField>
</Columns> 
```

# javafx - JavaFx 新闻和资源的良好 RSS 新闻提要

> ID：229876
> 
>         
> 
> 赞同：-1
> 
>         
> 
> 时间：2008-10-23T14:14:58.610
> 
>         
> 
> 标签：javafx, rss, feed

...是的，我见过：

[学习 JavaFX 的最佳资源？](https://stackoverflow.com/questions/116519/best-resources-for-learning-javafx)

但它并没有真正回答这个问题。也许目前没有任何好的资源？

更新：

[http://developers.sun.com/rss/javafx.xml](http://developers.sun.com/rss/javafx.xml)没问题

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-10-30T16:07:31.680

*   如果你有谷歌阅读器，你可以使用他们的发现工具来查找提要，例如[JavaFX 提要](http://www.google.com/reader/view/#directory-search/javafx/)。

*   Technorati 有[很多选择](http://www.technorati.com/search/javafx?authority=n&language=en)

*   谷歌博客搜索也有[一些结果](http://blogsearch.google.com/blogsearch?hl=en&ie=UTF-8&q=javafx&btnG=Search+Blogs)。

请注意，我什至不知道 JavaFX*是*什么- 与任何主题一样，您最好的选择是使用社交搜索工具来查找撰写有关您的特定主题的作者，然后如果您喜欢您的内容，请订阅他们读。

我最近采取的措施是使用[Google Alerts](http://www.google.com/alerts/)和 Google Reader（任何 RSS 阅读器都可以）在搜索特定主题时获取报告。您可以访问人们在某个主题中搜索的内容以及他们最终决定的内容。自从我开始使用 PHP 以来，我发现了一些关于 PHP 的有趣页面，它是一个有用的工具。

# sql-server - 在 2005/2008 上同步 SQL 登录实用程序

> ID：229883
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-10-23T14:15:52.930
> 
>         
> 
> 标签：sql-server, sql-server-2005

在将数据库还原到其他服务器后，任何人都指向我用于同步 sql server 登录的实用程序？  

我知道我可以用脚本来完成，但我一直在使用一个很棒的小实用程序 - 'Db Maint Sync SQL Logins' ( [http://www.dbmaint.com/SyncSqlLogins.asp](http://www.dbmaint.com/SyncSqlLogins.asp) ) 在 sql server 2000 上完成它不幸的是不支持 2005 年，我不愿意回到实际思考:-)

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T14:33:17.747

`sp_change_users_login`使用该`Update_One`操作可以将数据库中的登录名映射到新服务器上的用户。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-28T14:35:01.557

您可以使用`sp_change_users_login`Auto_Fix 选项自动链接登录名和同名用户。

如果在设置服务器时，将登录及其 SID 编写为脚本，则根本不会出现用户和登录不匹配的问题。

* * *

## 回答 #3

> 赞同：-1
> 
>             
> 
> 时间：2009-02-04T09:29:48.120

dbmaint的sync sql server logins工具有一个sql server 2005版本：
 [link text](http://www.karaszi.com/SQLServer/util_sync_logins.asp)

# java - 内存中字节的大小 - Java

> ID：229886
> 
>         
> 
> 赞同：56
> 
>         
> 
> 时间：2008-10-23T14:16:35.190
> 
>         
> 
> 标签：java, performance, memory

对于一个字节在 java 程序中占用的内存量，我听到了不同的意见。

我知道您可以在 java 字节中存储不超过 +127，并且[文档](http://java.sun.com/docs/books/tutorial/java/nutsandbolts/datatypes.html)说一个字节只有 8 位，但[在这里](http://www.jguru.com/faq/view.jsp?EID=13647)我被告知它实际上占用与 int 相同的内存量，因此只是一种有助于代码理解而非效率的类型。

任何人都可以解决这个问题，这将是一个特定于实现的问题吗？

* * *

## 回答 #1

> 赞同：67
> 
>             
> 
> 时间：2008-10-23T14:57:26.793

好的，有很多讨论，但代码不多:)

这是一个快速基准。当涉及到这种事情时，它有一些正常的警告——由于 JITting 等原因，测试内存有一些奇怪的地方，但如果数量足够大，它还是很有用的。它有两种类型，每种类型有 80 个成员——LotsOfBytes 有 80 个字节，LotsOfInts 有 80 个整数。我们构建了很多，确保它们没有被 GC，并检查内存使用情况：

```
class LotsOfBytes
{
    byte a0, a1, a2, a3, a4, a5, a6, a7, a8, a9, aa, ab, ac, ad, ae, af;
    byte b0, b1, b2, b3, b4, b5, b6, b7, b8, b9, ba, bb, bc, bd, be, bf;
    byte c0, c1, c2, c3, c4, c5, c6, c7, c8, c9, ca, cb, cc, cd, ce, cf;
    byte d0, d1, d2, d3, d4, d5, d6, d7, d8, d9, da, db, dc, dd, de, df;
    byte e0, e1, e2, e3, e4, e5, e6, e7, e8, e9, ea, eb, ec, ed, ee, ef;
}

class LotsOfInts
{
    int a0, a1, a2, a3, a4, a5, a6, a7, a8, a9, aa, ab, ac, ad, ae, af;
    int b0, b1, b2, b3, b4, b5, b6, b7, b8, b9, ba, bb, bc, bd, be, bf;
    int c0, c1, c2, c3, c4, c5, c6, c7, c8, c9, ca, cb, cc, cd, ce, cf;
    int d0, d1, d2, d3, d4, d5, d6, d7, d8, d9, da, db, dc, dd, de, df;
    int e0, e1, e2, e3, e4, e5, e6, e7, e8, e9, ea, eb, ec, ed, ee, ef;
}

public class Test
{
    private static final int SIZE = 1000000;

    public static void main(String[] args) throws Exception
    {        
        LotsOfBytes[] first = new LotsOfBytes[SIZE];
        LotsOfInts[] second = new LotsOfInts[SIZE];

        System.gc();
        long startMem = getMemory();

        for (int i=0; i < SIZE; i++)
        {
            first[i] = new LotsOfBytes();
        }

        System.gc();
        long endMem = getMemory();

        System.out.println ("Size for LotsOfBytes: " + (endMem-startMem));
        System.out.println ("Average size: " + ((endMem-startMem) / ((double)SIZE)));

        System.gc();
        startMem = getMemory();
        for (int i=0; i < SIZE; i++)
        {
            second[i] = new LotsOfInts();
        }
        System.gc();
        endMem = getMemory();

        System.out.println ("Size for LotsOfInts: " + (endMem-startMem));
        System.out.println ("Average size: " + ((endMem-startMem) / ((double)SIZE)));

        // Make sure nothing gets collected
        long total = 0;
        for (int i=0; i < SIZE; i++)
        {
            total += first[i].a0 + second[i].a0;
        }
        System.out.println(total);
    }

    private static long getMemory()
    {
        Runtime runtime = Runtime.getRuntime();
        return runtime.totalMemory() - runtime.freeMemory();
    }
} 
```

我的盒子上的输出：

```
Size for LotsOfBytes: 88811688
Average size: 88.811688
Size for LotsOfInts: 327076360
Average size: 327.07636
0 
```

所以很明显有一些开销 - 看起来有 8 个字节，虽然不知何故只有 7 个字节用于lotsofints（？就像我说的，这里有一些奇怪的东西） - 但关键是字节字段似乎是为lotsofbytes 打包的占用（在去除开销之后）仅是LotsOfInts 的四分之一的内存。

* * *

## 回答 #2

> 赞同：20
> 
>             
> 
> 时间：2008-10-23T14:35:20.270

是的，Java 中的字节变量实际上是内存中的 4 个字节。但是，这不适用于数组。一个 20 字节的字节数组的存储实际上只有 20 字节在内存中。

这是因为 Java 字节码语言只知道两种整数类型：int 和 long。因此它必须在内部将所有数字作为任一类型处理，这些类型在内存中分别为 4 和 8 个字节。

但是，Java 知道具有每种整数格式的数组。所以短数组的存储实际上是每个条目两个字节，字节数组每个条目一个字节。

我一直说“存储”的原因是数组也是 Java 中的一个对象，每个对象都需要多个字节的存储空间，而不管实例变量的存储空间或数组需要的数组存储空间。

* * *

## 回答 #3

> 赞同：7
> 
>             
> 
> 时间：2008-10-23T14:21:09.377

Java 从来都不是特定于实现或平台的（至少就[原始类型大小](http://java.sun.com/docs/books/tutorial/java/nutsandbolts/datatypes.html)而言）。无论您在什么平台上，它们的原始类型始终保证保持不变。这不同于（并且被认为是对）C 和 C++ 的改进，其中一些原始类型是特定于平台的。

由于底层操作系统一次处理四个（或 8 个，在 64 位系统中）字节更快，JVM 可能会分配更多字节来存储原始字节，但您仍然只能存储从 -128 到其中有 127 个。

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2008-10-23T14:30:40.543

一个有启发性的练习是在一些用字节和整数做简单事情的代码上运行[javap 。](http://java.sun.com/j2se/1.5.0/docs/tooldocs/windows/javap.html)您将看到期望 int 参数对字节进行操作的字节码，以及插入的字节码以从一个强制转换到另一个。

请注意，尽管字节数组不存储为 4 字节值的数组，因此 1024 长度的字节数组将使用 1k 的内存（忽略任何开销）。

* * *

## 回答 #5

> 赞同：5
> 
>             
> 
> 时间：2012-12-16T05:11:58.673

我使用[http://code.google.com/p/memory-measurer/](http://code.google.com/p/memory-measurer/)进行了测试
请注意，我使用的是 64 位 Oracle/Sun Java 6，没有对引用等进行任何压缩。

每个对象占用一些空间，加上JVM需要知道那个对象的地址，而“地址”本身就是8个字节。

使用原语，看起来像原语被转换为 64 位以获得更好的性能（当然！）：

```
byte: 16 bytes,
 int: 16 bytes,
long: 24 bytes. 
```

使用数组：

```
byte[1]: 24 bytes
 int[1]: 24 bytes
long[1]: 24 bytes

byte[2]: 24 bytes
 int[2]: 24 bytes
long[2]: 32 bytes

byte[4]: 24 bytes
 int[4]: 32 bytes
long[4]: 48 bytes

byte[8]: 24 bytes => 8 bytes, "start" address, "end" address => 8 + 8 + 8 bytes
 int[8]: 48 bytes => 8 integers (4 bytes each), "start" address, "end" address => 8*4 + 8 + 8 bytes
long[8]: 80 bytes => 8 longs (8 bytes each), "start" address, "end" address => 8x8 + 8 + 8 bytes 
```

现在猜猜是什么...

```
 byte[8]: 24 bytes
 byte[1][8]: 48 bytes
   byte[64]: 80 bytes
 byte[8][8]: 240 bytes 
```

PS Oracle Java 6，最新最好的，64 位，1.6.0_37，MacOS X

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2008-10-23T14:22:24.117

这取决于 JVM 如何应用填充等。一个字节数组（在任何健全的系统中）将被打包成每个元素 1 个字节，但是具有四个字节字段的类可以紧密打包或填充到字边界 -它依赖于实现。

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2008-10-23T14:21:56.537

你被告知的是完全正确的。Java字节码规范只有4字节类型和8字节类型。

byte、char、int、short、boolean、float 都存储在 4 个字节中。

double 和 long 存储在 8 个字节中。

然而字节码只是故事的一半。还有 JVM，它是特定于实现的。Java 字节码中有足够的信息来确定变量被声明为字节。JVM 实现*者可能*决定只使用一个字节，尽管我认为这不太可能。

* * *

## 回答 #8

> 赞同：2
> 
>             
> 
> 时间：2008-10-23T14:26:47.633

您总是可以使用 long 并将数据打包在自己的内部以提高效率。然后你总是可以保证你将使用所有 4 个字节。

* * *

## 回答 #9

> 赞同：2
> 
>             
> 
> 时间：2008-10-27T20:37:55.163

byte = 8bit = Java Spec 定义的一个字节。

字节数组需要多少内存**不是**由规范定义的，也没有定义一个复杂对象需要多少。

对于 Sun JVM，我记录了规则：[https ://www.sdn.sap.com/irj/sdn/weblogs?blog=/pub/wlg/5163](https://www.sdn.sap.com/irj/sdn/weblogs?blog=/pub/wlg/5163)

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2008-10-28T10:57:52.290

在我的站点上查看我的 MonitoringTools (www.csd.uoc.gr/~andreou)

```
X类{
   字节 b1, b2, b3 ...;
}

long memoryUsed = MemoryMeasurer.measure(new X());

```

（它也可以用于更复杂的对象/对象图）

在 Sun 的 1.6 JDK 中，似乎一个字节确实需要一个字节（在旧版本中，int ~ byte 就内存而言）。但请注意，即使在旧版本中，byte[] 也被打包为每个条目一个字节。

无论如何，关键是不需要像上面 Jon Skeet 那样的复杂测试，只给出估计。我们可以直接测量物体的大小！

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2008-10-28T11:02:37.897

看了上面的评论，我的结论似乎会让很多人感到惊讶（这对我来说也是一个惊喜），所以值得重复一下：

*   **变量的旧 size(int) == size(byte) 不再适用**，至少在 Sun 的 Java 6 中是这样。

相反，大小（字节）== 1 字节（！！）

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2012-08-09T09:01:16.703

只是想指出声明

*你可以在一个java字节中存储不超过+127*

并不真正正确。

您始终可以在一个字节中存储 256 个不同的值，因此您可以轻松地将 0..255 范围视为“无符号”字节。

这完全取决于您如何处理这 8 位。

例子：

```
byte B=(byte)200;//B contains 200
System.out.println((B+256)%256);//Prints 200
System.out.println(B&0xFF);//Prints 200 
```

* * *

## 回答 #13

> 赞同：-3
> 
>             
> 
> 时间：2011-08-04T12:41:29.727

看来答案可能取决于您的 JVM 版本，也可能取决于您正在运行的 CPU 架构。Intel 系列 CPU 高效地执行字节操作（由于其 8 位 CPU 历史）。一些 RISC 芯片需要对许多操作进行字（4 字节）对齐。堆栈上的变量、类中的字段和数组中的内存分配可能不同。

# asp.net - ASP.NET 和 Flash - 可以通过 Flash 与 .net 对话

> ID：229887
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2008-10-23T14:16:43.910
> 
>         
> 
> 标签：asp.net, flash

flash 前端可以与.net 后端通信吗？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2008-10-23T14:18:35.623

是的。

我们使用[Adob​​e Flex](http://www.adobe.com/products/flex/)与 .Net XML Web 服务对话。

小心复杂的序列化 .Net 类型（例如 DataSets）——ActionScript 无法处理它们。

而是生成具有原始类型的简单 XML。

另请参阅：[Flex 和 ADO.NET 数据服务...有人做过吗？](https://stackoverflow.com/questions/44817)

```
<mx:WebService id="myDataService" showBusyCursor="true">
    <mx:operation name="WebMethodName" resultFormat="object" result="functionFiredOnComplete();"></mx:operation>
</mx:WebService>

public function load():void
{
    myDataService.loadWSDL( "web method's wsdl" );
    myDataService.WebMethodName.send( params );
}

public function functionFiredOnComplete():void
{           
    // get data
    var myData:Object = myDataService.WebMethodName.lastResult;
    ... 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-10-28T11:15:18.043

您还可以尝试 AMF.NET，这是一个使用 ActionScript 消息格式 (AMF) 的 Flash Remoting 的 .NET 实现

[http://amfnet.openmymind.net/overview/default.aspx](http://amfnet.openmymind.net/overview/default.aspx)

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2008-10-23T14:20:55.633

Flash 还可以通过 JavaScript 与托管页面对话。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T14:53:56.863

如果您要反序列化很多对象（Flash/Flex 不是特别快）或更复杂的类型，那么您可能想看看[WebOrb](http://www.themidnightcoders.com/weborb/)。它是一个免费的对象代理，听起来可能很吓人，但它基本上可以处理两种技术的本地对象类型之间的转换。它几乎“正常工作”，并且在某些情况下可以显着提高性能。

如果您想要的只是 CRUD 和 SQL 数据库的存储过程访问，它还附带一个代码生成工具，这非常好。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T14:20:10.020

是的

搜索的最佳关键字是 Flash .net 和 Flex

在过去，还有另一种工具，但有了 Flex，一切都被简化了。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-03-30T14:57:26.290

我会推荐[FluorineFX](http://fluorinefx.net/docs/fluorine/index.html)我们在工作中使用它，它很棒。唯一的缺点是我们最终会得到很多值对象，这些值对象仅用于在 .net 和 flex 之间传输数据。标准 C# 命名风格和 flex 命名风格有一些细微差别，这使得值对象在 flex 或 .net 中都显得有些难看。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2010-02-25T17:03:35.023

我的哥哥和我开发了几种 Flash/.Net 通信方法。我见过上面提到的 Web 服务（这是一种很好的方法），但我们也使用简单的 .aspx 页面并通过查询字符串（穷人的做事方式）传递内容，使用 Flashvars 将数据获取到 Flash，但我最喜欢 - 使用 .Net 和中继器控件来构建 xml 文件，然后由 Flash 使用。我们为此创造了一些非常酷的东西！

# mysql - 清理 MySQL 用户参数

> ID：229889
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2008-10-23T14:17:00.477
> 
>         
> 
> 标签：mysql, sanitization, exploit

当用户的输入将被插入到 MySQL 查询中时，应该在用户输入中替换哪些危险字符？我知道引号、双引号、\r 和 \n。还有其他人吗？
[（我没有使用接受参数的智能连接器的选项，因此我必须自己构建查询，这将在多种编程语言中实现，包括一些晦涩难懂的语言，因此`mysql_real_escape_string`PHP 等解决方案无效）]

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2008-10-23T15:34:36.953

[mysql.com 文档中的mysql_real_escape_string()](http://dev.mysql.com/doc/refman/5.0/en/mysql-real-escape-string.html)：

> *考虑到连接的当前字符集，将 from 中的字符串编码为转义的 SQL 字符串。结果被放入 to 并附加一个终止的空字节。编码的字符为 NUL (ASCII 0)、“\n”、“\r”、“\”、“'”、“"”和 Control-Z（参见第 8.1 节“文字值”）。（严格来说， MySQL 只要求对查询中用于引用字符串的反斜杠和引号字符进行转义。此函数引用其他字符以使它们更易于在日志文件中阅读。）*

* * *

**mysql_real_escape_string()**是字符集感知的，因此复制它的所有功能（尤其是针对多字节攻击问题）并不是一件小事。

来自[http://cognifty.com/blog.entry/id=6/addslashes_dont_call_it_a_comeback.html](http://cognifty.com/blog.entry/id=6/addslashes_dont_call_it_a_comeback.html)：

```
AS = 添加斜杠（）  
MRES = mysql_real_escape_string()
ACS = addcslashes() //用 "\\\000\n\r'\"\032%_" 调用

特征作为 MRES ACS
转义引号、双引号和反斜杠 是 是 是
转义 LIKE 修饰符：下划线、百分号 no no yes
用单引号而不是反斜杠转义 no yes*1 no
字符集感知 否 是*2 否
防止多字节攻击 否 是*3 否

```

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2008-10-23T14:25:33.470

您需要支持哪些语言？使用语言的内置清理比编写自己的要好得多。

编辑：在[`mysql_real_escape_string`](http://php.net/mysql_real_escape_string)php.net 上查看：

> `mysql_real_escape_string()`调用 MySQL 的库函数，该函数在以下字符前面加上`mysql_real_escape_string`反斜杠：`\x00`、`\n`、`\r`、`\`、`'`和.`"``\x1a`

# serialization - 序列化的类设计 - 想法或模式？

> ID：229890
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-10-23T14:17:09.637
> 
>         
> 
> 标签：serialization, oop

让我从一个说明性示例开始（假设实现是使用静态类型语言，如 Java 或 C#）。

假设您正在构建内容管理系统 (CMS) 或类似的东西。数据被分层组织成`Folder`s。每个文件夹都有一个孩子的集合；一个孩子可能是一个`Page`或一个`Folder`。所有项目都存储在根文件夹中。不允许循环。我们有一个无环图。

系统将具有远程 API 和实例，`Folder`并且`Page`必须通过网络进行序列化/反序列化。对于文件夹的典型实现，其中文件夹的子节点是 a `List`，根节点的序列化将发送整个图。由于显而易见的原因，这是不可接受的。

我很想听到人们过去已经解决了这个问题。

我有两个潜在的建议：

1.  **按查询导航**：更改域模型，使文件夹类仅包含每个子项的 ID 列表。要访问一个孩子，我们必须查询它。序列化现在是微不足道的，因为图表在一个明确定义的点结束。主要的缺点是我们失去了类型安全性 - ID 可能用于文件夹/子项以外的其他内容。

2.  **停止并重新附加**：在序列化过程中，只要我们检测到对文件夹或页面的引用，就发送 ID。反序列化时，我们必须为每个 ID 查找相应的对象，并将其重新附加到新生对象的相关位置。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-06-14T14:38:01.823

我不知道您要构建什么样的 API，但您的建议 #1 听起来与 REST 样式服务和 API 的建议很接近。基本上，一个`Folder`对象将包含一个指向其子级的 URL 列表。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2010-05-07T17:51:48.853

*查询导航*解决方案用于[NFS](http://en.wikipedia.org/wiki/Network_File_System_%28protocol%29)。通过阅读您的问题，在我看来，好像您正在尝试自己实现某种文件系统。

如果您正在专门研究通过网络发送对象，那么总会有[CORBA](http://en.wikipedia.org/wiki/Common_Object_Request_Broker_Architecture)。除此之外还有[DCOM](http://en.wikipedia.org/wiki/Distributed_Component_Object_Model)和较新的[WCF](http://en.wikipedia.org/wiki/Windows_Communication_Foundation)。但是等等，那里更像是[RMI](http://java.sun.com/javase/technologies/core/basic/rmi/index.jsp)。此外还有[网络服务](http://en.wikipedia.org/wiki/Web_service)。我现在就停在这里。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2012-07-31T07:51:14.033

经典的解决方案可能是使用[代理模式](http://en.wikipedia.org/wiki/Proxy_pattern)，其中一些图形通过网络发送，*一些*文件夹被代理替换，这些代理在查询它们之前不会填充其子列表。往返服务器需要大量时间，如果所有文件夹都是代理，则可能会导致请求过多（每次检查文件夹内容时都会产生一个新请求），因此您想要在每个数据块的大小和典型场景中所需的服务器请求数之间进行一些权衡。这当然是特定于应用程序的，但是发送所有子文件夹的内容，例如深度 2 可能是一个有用的策略......

**长话短说**：最好的解决方案可能是您的解决方案＃1，但由于往返服务器的开销，您希望一次发送多个文件夹......

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2010-08-23T06:30:51.367

我不会通过查询导航方法来做到这一点。仅仅是因为我想坚持文件夹包含文件夹或页面的域模型。

自定义序列化也可能很棘手，容易出错并且难以更改\理解。

我建议你`FolderBowser`在你的模型中引入和反对，它需要一个 id 并为你提供文件夹内容的列表。这将使您的服务操作更简单。

干杯，取消网格

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-08-01T19:40:01.337

假设您对整个树建模，其中每个元素都是节点，节点的特化是文件夹，嗯，叶子。你有一个“根”节点。节点有方法

```
canHaveChildren() 
getChildren() 
```

叶节点具有明显的行为（甚至不需要打网络）

文件夹`getChildren()`获得下一组节点。

我确实按照这些思路设计了一个带有 Restful 服务的系统。似乎相当容易编程。

# c++ - 以二进制和文本模式编写的文件之间的区别

> ID：229924
> 
>         
> 
> 赞同：64
> 
>         
> 
> 时间：2008-10-23T14:22:25.070
> 
>         
> 
> 标签：c++, c, file-io

写入以文本模式打开而二进制模式不存在的文件时会发生什么转换？特别是在 MS Visual C 中。

```
unsigned char buffer[256];
for (int i = 0; i < 256; i++) buffer[i]=i;
int size  = 1;
int count = 256; 
```

二进制模式：

```
FILE *fp_binary = fopen(filename, "wb");
fwrite(buffer, size, count, fp_binary); 
```

与文本模式：

```
FILE *fp_text = fopen(filename, "wt");
fwrite(buffer, size, count, fp_text); 
```

* * *

## 回答 #1

> 赞同：60
> 
>             
> 
> 时间：2008-10-23T18:28:30.017

我相信大多数平台在处理流时都会忽略“t”选项或“text-mode”选项。但是，在 Windows 上，情况并非如此。如果你看一下 fopen() 函数的描述：[MSDN](http://msdn.microsoft.com/en-us/library/yeby3zcb(vs.71).aspx)，你会看到指定“t”选项将产生以下效果：

*   换行符 ('\n') 将在输出时转换为 '\r\n" 序列

*   回车/换行序列将在输入时转换为换行。

*   如果文件以追加模式打开，则将检查文件末尾是否有 ctrl-z 字符（字符 26），如果可能，删除该字符。它还将将该字符的存在解释为文件的结尾。这是从 CPM 时代起不幸的遗留物（关于父母的罪孽在他们的孩子身上被探视到第三代或第四代）。与之前陈述的观点相反，不会附加 ctrl-z 字符。

* * *

## 回答 #2

> 赞同：31
> 
>             
> 
> 时间：2008-10-23T14:30:54.897

在文本模式下，换行符“\n”可以转换为回车+换行符“\r\n”

通常你会想要以二进制模式打开。试图以文本模式读取任何二进制数据都行不通，它会被损坏。不过，您可以在二进制模式下正常阅读文本 - 它只是不会将“\n”自动翻译成“\r\n”。

见[fopen](http://hostprogressive.com/support/php_5_docs/function.fopen.html)

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2008-10-23T14:36:26.960

此外，当您使用“rt”打开文件时，输入以 Crtl-Z 字符终止。

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2014-07-17T08:46:28.577

另一个区别是使用时`fseek`

> 如果流以二进制模式打开，如果源是 SEEK_SET，则新位置正好是从文件开头测量的偏移字节，如果源是 SEEK_CUR，则从当前文件位置测量，如果源是 SEEK_END，则从文件末尾测量。一些二进制流可能不支持 SEEK_END。
> 
> 如果流以文本模式打开，则唯一支持的 offset 值是零（适用于任何来源）和先前在与同一文件关联的流上调用 std::ftell 返回的值（仅适用于SEEK_SET 的来源。

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2008-10-23T17:32:16.340

我们在以文本模式打开文件时遇到了一个有趣的问题，其中文件混合了行尾字符：

```
1\n\r
2\n\r
3\n
4\n\r
5\n\r 
```

我们的要求是我们可以将当前位置存储在文件中（我们使用 fgetpos），关闭文件，然后重新打开文件并寻找该位置（我们使用 fsetpos）。

但是，如果文件混合了行尾，则此过程无法找到实际的相同位置。在我们的例子中（我们的工具解析 C++），我们正在重新读取我们已经看到的部分文件。

使用二进制 - 然后您可以准确控制从文件中读取和写入的内容。

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2020-10-11T16:32:36.437

尽管这个问题已经得到解答并得到了清楚的解释，但我认为用一个简单的代码示例来展示主要问题（\n 和 \r\n 之间的翻译）会很有趣。请注意，我没有解决文件末尾的 Crtl-Z 字符的问题。

```
#include <stdio.h>
#include <string.h>

int main() {
    FILE *f;
    char string[] = "A\nB";
    int len;

    len = strlen(string);
    printf("As you'd expect string has %d characters... ", len); /* prints 3*/
    f = fopen("test.txt", "w"); /* Text mode */
    fwrite(string, 1, len, f);  /* On windows "A\r\nB" is writen */
    printf ("but %ld bytes were writen to file", ftell(f)); /* prints 4 on Windows, 3 on Linux*/ 
    fclose(f);
    return 0;
} 
```

如果您在 Windows 上执行该程序，您将看到打印以下消息：

```
As you'd expect string has 3 characters... but 4 bytes were writen to file 
```

当然，您也可以使用 Notepad++ 之类的文本编辑器打开文件，然后查看自己的字符：

[![在此处输入图像描述](https://i.stack.imgur.com/p3uAB.png)](https://i.stack.imgur.com/p3uAB.png)

在以文本模式读取文件时，在 Windows 上执行逆变换。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2019-11-09T07:09:02.523

在'w'模式下，文件以写模式打开，基本编码是'utf-8'，在'wb'模式下，文件以写-二进制模式打开，负责写入其他特殊字符和编码可能是 'utf-16le' 或其他

# c# - 在 C# 中输出操纵的 QueryString

> ID：229925
> 
>         
> 
> 赞同：23
> 
>         
> 
> 时间：2008-10-23T14:22:28.453
> 
>         
> 
> 标签：c#, asp.net, collections, query-string

使用以下代码，我得到了一个很好的格式化字符串：

```
Request.QueryString.ToString 
```

给了我类似的东西：&hello=worldµsoft=sucks

但是，当我使用此代码将集合克隆到另一个对象（相同类型）时，我会从 ToString() 方法中取回 Type()。

```
System.Collections.Specialized.NameValueCollection variables = new System.Collections.Specialized.NameValueCollection(Request.QueryString);
if (!string.IsNullOrEmpty(variables["sid"]))
    variables.Remove("sid");
Response.Write(variables.ToString()); 
```

有没有一种更整洁的方式来输出它而不是手动查找和构建字符串？

* * *

## 回答 #1

> 赞同：69
> 
>             
> 
> 时间：2009-09-15T07:43:56.787

HttpValueCollection 是内部的，但您可以使用“var”来声明它，而无需使用反射器提取它。

```
var query = HttpUtility.ParseQueryString(Request.Url.Query);
query["Lang"] = myLanguage; // Add or replace param
string myNewUrl = Request.Url.AbsolutePath + "?" + query; 
```

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2008-10-23T14:35:10.613

您也可以使用 Reflector 将`HttpValueCollection`类提取到您自己的类中，然后使用它。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2008-10-23T14:32:20.977

因为它实际上是一个 HTTPValueCollection 类型的特殊 NVC。因此，当您在其上调用 .ToString 时，它知道如何正确格式化它。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2008-10-23T14:30:16.987

为什么要将 QueryString 集合复制到新的 NameValueCollection 中？

```
 if (!string.IsNullOrEmpty(Request.QueryString["sid"]))
        Request.QueryString.Remove("sid"); 
```

是的，确实，我错了，它是只读的。所以本质是在你的 NameValuecollection 上使用 Remove 方法：

```
System.Collections.Specialized.NameValueCollection variables = new System.Collections.Specialized.NameValueCollection(Request.QueryString);
if (!string.IsNullOrEmpty(variables["sid"]))
    variables.Remove("sid"); 
```

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T15:07:10.517

如果你不是绝对需要 NameValueCollection，字典提供了很多相同的语义：

```
var variables = Request.QueryString.OfType<DictionaryEntry>()
    .Where(entry => entry.Key != "sid")
    .ToDictionary(entry => entry.Key, entry => entry.Value); 
```

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2008-10-23T14:30:42.870

Request.QueryString 实际上返回一个 HttpValueCollection 对象（不幸的是，它是 System.Web 内部的，所以你不能这样做）。  

尽管如此，HttpValueCollection 是从 NameValueCollection 派生的，并且它的 Remove() 方法保持不变，因此您应该能够调用 Request.QueryString.Remove("sid");

# c# - .NET：是否有单击并拖动“类似桌面”的控件？

> ID：229935
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-10-23T14:23:27.970
> 
>         
> 
> 标签：c#, .net, forms, controls, user-interface

好的，首先查看Windows桌面的上下文；您可以将桌面上的项目（文件夹、文件）拖到不同的地方，然后它们“停留”在您拖动它们的位置。这似乎是向用户提供的一个非常有用的功能，以便允许他们创建自己的项目“分组”。

因此，我的问题是：.NET 中是否有一个控件可以通过项目集合来近似此行为？

我正在考虑类似于“LargeIcon”模式下的列表视图，但它允许您将图标拖动到控件内的不同位置。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2008-10-23T20:54:11.487

您可以使用标准的 ListView 控件通过实现拖放来做到这一点。这是执行此操作的示例控件：

```
using System;
using System.Drawing;
using System.Windows.Forms;

public class MyListView : ListView {
  private Point mItemStartPos;
  private Point mMouseStartPos;

  public MyListView() {
    this.AllowDrop = true;
    this.View = View.LargeIcon;
    this.AutoArrange = false;
    this.DoubleBuffered = true;
  }

  protected override void OnDragEnter(DragEventArgs e) {
    if (e.Data.GetData(typeof(ListViewItem)) != null) e.Effect = DragDropEffects.Move;
  }
  protected override void OnItemDrag(ItemDragEventArgs e) {
    // Start dragging
    ListViewItem item = e.Item as ListViewItem;
    mItemStartPos = item.Position;
    mMouseStartPos = Control.MousePosition;
    this.DoDragDrop(item, DragDropEffects.Move);
  }
  protected override void OnDragOver(DragEventArgs e) {
    // Move icon
    ListViewItem item = e.Data.GetData(typeof(ListViewItem)) as ListViewItem;
    if (item != null) {
      Point mousePos = Control.MousePosition;
      item.Position = new Point(mItemStartPos.X + mousePos.X - mMouseStartPos.X,
          mItemStartPos.Y + mousePos.Y - mMouseStartPos.Y);
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T14:34:15.060

我认为最接近的应该是 ListView 控件，但它更像是一个资源管理器窗口。您也许可以创建自己的视图来执行您想要的操作，但您需要在某处手动保存图标位置。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T15:13:30.443

如果您不反对使用 WPF，Josh Smith 已经创建了一个非常简洁的画布，我目前正在将它用于一个项目。它允许您添加控件并将它们拖到画布上。您必须处理画布上加载的内容以及程序下一次加载的位置，但这非常简单。
[http://www.codeproject.com/KB/WPF/DraggingElementsInCanvas.aspx](http://www.codeproject.com/KB/WPF/DraggingElementsInCanvas.aspx)

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T15:14:34.607

这取决于这是 Windows 应用程序还是基于 Web 浏览器的应用程序。无论哪种情况，您都需要某种容器来管理控件的位置。您可以使用其 X 和 Y 坐标来管理容器内控件的位置。

您将使用拖动事件处理实际移动。所以你有拖动开始，同时拖动（你可能会显示一个占位符图形或更改光标），最后是拖动结束（将控件的 x 和 y 设置为新位置）。显然这些不是实际的事件名称，但搜索“如何处理拖动事件”应该可以帮助您入门。

在 web 环境中，我知道 jquery 具有内置的拖动功能。所以你可能想看看。您必须注意的一件大事是在回发之间保持控件的位置。我不确定在这种情况下会发生什么。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2016-05-03T13:38:44.943

Windows 使用`ListView32`，具有拖放占位符功能的内部控件，自定义边框...

图标位置可以存储在 XML 文件中，也可以存储在应用程序设置中（通过将 XML 作为字符串并在需要时将其转换为文件）。

例如，您可以这样做：

```
<icons>
    <icon1>
        <name>Icon1</name>
        <text>My PC</text>
        <imageIndex>16</imageIndex>
    </icon1>
    <icon2>
        .....
    </icon2>            
    .....
</icons> 
```

洛伦佐

# java - 在 JSP 页面中使用 request.setAttribute

> ID：229937
> 
>         
> 
> 赞同：24
> 
>         
> 
> 时间：2008-10-23T14:24:30.667
> 
>         
> 
> 标签：java, jakarta-ee, setattribute, request-object

是否可以`request.setAttribute`在 JSP 页面上使用，然后在 HTML Submit 中获取相同的请求属性`Servlet`？

* * *

## 回答 #1

> 赞同：26
> 
>             
> 
> 时间：2008-10-23T14:29:15.320

不。不幸的是，请求对象仅在页面完成加载之前可用 - 一旦完成，您将丢失其中的所有值，除非它们已存储在某处。

如果要通过请求保留属性，则需要：

1.  在您的表单中有一个隐藏的输入，例如`<input type="hidden" name="myhiddenvalue" value="<%= request.getParameter("value") %>" />`. 这将在 servlet 中作为请求参数提供。

2.  将它放在会话中（参见`request.getSession()`- 在 JSP 中，这很简单`session`）

我建议使用 Session，因为它更易于管理。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2008-10-25T19:04:14.527

Phil Sacre 的回答是正确的，但是会话不应该仅仅用于它的地狱。您应该只将它用于*真正*需要在会话生命周期内存在的值，例如用户登录。通常会看到人们过度使用会话并遇到更多问题，尤其是在处理集合时，或者当用户返回他们之前访问过的页面时，却发现他们仍然有之前访问过的值。一个聪明的程序尽可能地最小化变量的范围，一个糟糕的程序会过多地使用会话。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2014-03-13T17:57:49.250

如果您希望您的请求持续存在，请尝试以下操作：

示例：在您的 JSP 或 servlet 页面上

```
request.getSession().setAttribute("SUBFAMILY", subFam); 
```

并在任何接收页面上使用以下行来检索您的会话和数据：

```
SubFamily subFam = (SubFamily)request.getSession().getAttribute("SUBFAMILY"); 
```

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2014-09-25T08:37:09.297

但是，您可以使用 pageContext 属性来做到这一点：

在 JSP 中：

```
<form action="Enter.do">
    <button type="SUBMIT" id="btnSubmit" name="btnSubmit">SUBMIT</button>
</form>
<% String s="opportunity";
pageContext.setAttribute("opp", s, PageContext.APPLICATION_SCOPE); %> 
```

在 Servlet 中（链接到“Enter.do” url 模式）：

```
String s=(String) request.getServletContext().getAttribute("opp"); 
```

除了 APPLICATION_SCOPE 之外，还有其他范围，例如 SESSION_SCOPE。APPLICATION_SCOPE 用于 ServletContext 属性。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2010-04-07T09:40:46.533

尝试

```
request.getSession().setAttribute("SUBFAMILY", subFam);
request.getSession().getAttribute("SUBFAMILY"); 
```

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2008-10-24T03:43:07.933

如果错了请纠正我...我认为请求确实在连续页面之间持续存在..

假设您从第 1 页--> 第 2 页--> 第 3 页遍历。

您使用第 1 页中的 setAttribute 在请求对象中设置了一些值，您使用 getAttribute 在第 2 页中检索该值，然后如果您尝试在同一请求对象中再次设置某些内容以在第 3 页中检索它，那么它无法为您提供空值“创建 JSP 的请求和提交 JSP 时生成的请求是完全不同的请求，放置在第一个请求上的任何属性在第二个请求上都将不可用”。

我的意思是第 2 页中的类似内容失败了：

在第 1 页的情况下，同样的事情也有效，例如：

所以我认为我需要继续 Phill 建议的两个选项中的任何一个。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-10-13T12:20:46.710

我认为 phil 是正确的请求选项在页面加载之前可用。因此，如果我们想将值发送到另一个页面，我们希望在隐藏标签或会话中设置在那个时候在多个页面上会话是比隐藏标签更好的选择。

# .net - ASPX 文本框：返回按键时执行方法

> ID：229944
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-10-23T14:25:46.810
> 
>         
> 
> 标签：.net, asp.net, textbox

我有一个没有提交按钮的搜索框，我需要能够按回车然后执行一个方法，我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2008-10-23T16:16:50.127

你也可以用 CSS 做一些简单的事情：

```
<asp:Panel DefaultButton="myButton" runat="server">
    <asp:TextBox ID="myTextBox" runat="server" />
    <asp:Button ID="myButton" runat="server" onclick="myButton_Click" style="display: none; "  />
</asp:Panel> 
```

该面板可能需要也可能不需要，具体取决于您的实现和周围的控件，但这对我有效并且可以回发。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-10-23T16:10:09.250

您可以在页面中添加一个隐藏按钮，并将您的方法连接到该按钮的单击事件。然后添加一点 javascript 以在您在文本框中按 enter 时触发该按钮的回发操作。

```
this.myTextBox.Attributes.Add(
    "onkeydown", 
    "return keyDownHandler(13, 'javascript:" 
     + this.Page.ClientScript.GetPostBackEventReference(this.myButton, string.Empty).Replace("'", "%27") 
     + "', event);"); 
```

[（您也可以用Windows.Forms.Keys](http://msdn.microsoft.com/en-us/library/system.windows.forms.keys.aspx) .Enter替换硬编码的 13 ，如果您更喜欢更易于阅读的版本。）

其中 keyDownHandler 是这样的 JavaScript 函数：

```
function keyDownHandler(iKeyCode, sFunc, e) { 
    if (e == null) { 
        e = window.event; 
    } 
    if (e.keyCode == iKeyCode) { 
        eval(unescape(sFunc)); return false; 
    } 
} 
```

请注意，这是基于[DotNetNuke](http://www.dotnetnuke.com/)的[ClientAPI Web 实用程序](http://www.dotnetnuke.com/Products/Development/Forge/ComponentClientAPI/tabid/851/Default.aspx)的实现。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-23T14:29:24.073

使用 TextChanged 事件，并将 AutoPostBack 属性设置为 true。

# c# - C# 代理和 var 关键字

> ID：229959
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-10-23T14:29:43.340
> 
>         
> 
> 标签：c#, castle-windsor, proxy-classes

这个问题与我以前的帖子[有关](https://stackoverflow.com/questions/227225/is-injecting-dao-into-entities-a-bad-thing)。基本上，我想将 DAO 注入一个实体，即

```
public class User
{
   IUserDAO userDAO;
   public User()
   {
         userDAO = IoCContainer.Resolve<IUserDAO>;
   }
  public User(IUserDAO userDAO)
   {
         this.userDAO = userDAO;
   }
   //Wrapped DAO methods i.e
   public User Save()
   {
       return userDAO.Save(this);
   }

} 
```

在这里，如果我的 DAO 中有自定义方法，那么我基本上必须将它们包装在实体对象中。因此，如果我有一个 IUserDAO.Register() 我将不得不创建一个 User.Register() 方法来包装它。

更好的是创建一个代理对象，其中来自 DAO 的方法动态分配给用户对象。所以我可能有这样的东西：

```
var User = DAOProxyService.Create(new User());
User.Save(); 
```

这意味着我可以将 User 实体保持为一个适合通过网络传输数据的非常愚蠢的类，但也可以神奇地给它一堆 DAO 方法。

不过，这远远超出了我的舒适区，我想知道我需要做什么才能做到这一点？我可以使用 Castles 动态代理吗？C# 编译器是否也能够处理这个问题并了解动态添加的方法？

如果这是胡说八道，请随时告诉我。

编辑：

> 我们需要做的是在编译时以某种方式将 DAOProxyService.Create() 声明为返回一个 User 对象。这可以通过泛型来完成。

这不完全正确，我想要返回的不是 User 对象，而是具有动态添加的 UserDAO 方法的 User 对象。由于此类在任何地方都没有定义，因此编译器将不知道该怎么做。

我本质上返回的是一个新对象，它看起来像：用户：IUserDAO，所以我想我可以根据需要进行转换。但这似乎很混乱。

看起来我正在寻找的是类似于这个：[Mixins](http://www.almostserio.us/articles/2005/01/12/mixins-using-castle-dynamicproxy)

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2008-10-23T14:41:12.363

我最初打算说你问的东西行不通。但是通过一些调整，我们也许可以让它工作。

var 只是一个编译器功能。当你说。

```
 var x = GetSomeValue(); 
```

编译器说“'GetSomeValue' 被定义为返回一个字符串，所以程序员必须要写'string x = GetSomeValue();'”。请注意，*编译器*是这样说的；此更改在*编译*时完成。

您想要定义一个本质上返回一个对象的类 (DAOProxyService)。这将起作用，但“var User”将与“Object user”相同。

我们需要做的是在编译时以某种方式将 DAOProxyService.Create() 声明为返回一个 User 对象。这可以通过泛型来完成：

```
class DAOProxyService
{
     static DAOProxyService<T> Create<T>(T obj) { ......} 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-10-23T15:25:18.717

它不是*完全*自动的，但您可以考虑使用 Oleg Sych 的方法的变体来生成装饰器类。每当 IUserDAO 更改（新方法等）时，只需重新生成文件。比手动维护要好:-)

[http://www.olegsych.com/2007/12/how-to-use-t4-to-generate-decorator-classes/](http://www.olegsych.com/2007/12/how-to-use-t4-to-generate-decorator-classes/)

# asp.net - ASP.NET 动态数据中的多对多关系

> ID：229966
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-10-23T14:30:37.750
> 
>         
> 
> 标签：asp.net, many-to-many, dynamic-data

我需要在我的项目中使用多对多关系，并且由于动态数据本身不支持它，我想要求一个类似的实现示例。

我正在特别寻找一种方法来创建目标实体的新实例并将新的 m2m 关系添加到记录以及使用现有实例来创建关系。

我的时间很紧，所以非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-10-28T05:32:42.743

David Ebbo（Dynamic Data 的架构师）在他的博客上发布了一个[多对多字段模板。](http://blogs.msdn.com/davidebb/archive/2008/10/25/a-many-to-many-field-template-for-dynamic-data.aspx)请注意，此解决方案专门用于实体框架。

# .net - 如何阻止 Visual Studio 更新程序集引用？

> ID：229986
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2008-10-23T14:34:44.997
> 
>         
> 
> 标签：.net, ide, tfs

在我们的环境中，我们有一个 Lib 文件夹，其中包含我们项目引用的各种第三方程序集。例如，企业图书馆和 Elmah。

有时开发人员不会在该文件夹上获取最新信息。当开发人员随后加载在预期文件夹中找不到程序集的项目时，Visual Studio 会自动找到另一个副本并更新项目引用。

当开发人员签入项目并将其他所有人搞砸时，就会出现问题。

有没有办法阻止 Visual Studio 2008 这样做？

更新：我想补充一点，我们正在使用 TFS 进行源代码控制。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2008-10-23T15:34:30.760

这是我们在我的公司如何防范这种情况的方法。（您的里程会有所不同！）

任何非系统（或其他非 GAC）引用都来自我们的开发服务器，每个开发人员都已将其映射到他们的 W: 驱动器。我们有一个公用的 DLL 目录，其中包含客户端（或供应商）的子目录，以及其他适当的子目录。除了 Infragistics 偶尔需要的 license.dll 之外，没有任何 DLL 存储在源代码管理**中**。

对于供应商提供的库（EntLib、Infragistics 等），作为我们从 W: 驱动器引用的策略。时期。没有人被授权从其他任何地方引用。这会将项目文件中的提示编码为公共路径。

对于内部库（客户和内部项目），我们的持续集成过程将 DLL 输出到该目录的适当分支中——同样，我们所有的引用都来自该分支。

这确实减慢了我们的本地编译时间（用于本地调试），因为 VS 每次都会针对服务器自动刷新这些。这很烦人（有时一个项目可能需要 5 或 6 分钟才能在本地构建），但在使用不同引用的人周围工作是必要的。这里的好处是，只要有人签入其中一个引用的代码，CI 服务器就会开始构建，每个人都会很快得到它。

这样做的诀窍是稳定、可重复的构建过程和持续集成服务器。我们使用[CruiseControl.NET](http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET)，与[NAnt](http://nant.sourceforge.net/)构建集成，但在此处插入您最喜欢的 CI 服务器和构建工具。

到目前为止，由于此过程，我们遇到的问题为零，除非在我们的源代码控制系统（也称为 Demon Spawn，请参阅我最近的许多评论）执行大型多文件检查时启动构建服务器-在。（因为 Demon Spawn 不支持交易签到。）但是，这种情况非常罕见——可能每 5 或 6 周一次。之后立即进行部队重建来处理它。

只是一些想法......这种技术应该可以防止人们搞砸你的源代码控制 - 作为一个额外的好处，减少你的源代码控制的大小，因为你不会检查 DLL，只是 dll.refresh 文件。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-10-23T18:49:56.543

除了将您的 dll 置于源代码管理中之外，我在大多数方面都同意 John 的观点。

我通常有一个 ThirdParty 文件夹，然后会有供应商产品和版本细分，因此，ajax 工具包存储在 $/ThirdParty/Microsoft/AjaxToolkit/（一些版本号）中。我喜欢这种方法，因为我们可以在构建构建的所有工件上贴上标签。

另一个想法可能是项目中的 dll，所以如果他们获得最新的项目，他们将获得 dll。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T14:56:36.967

我不认为这是可能的。

如果您在文本编辑器中打开项目文件，您会看到 Visual Studio 不存储对程序集的硬引用，而是存储“HintPath”。如果没有找到参考，Visual Studio 将自动尝试 GAC。

设置一个持续集成服务器（如果您还没有）可能是一个好主意，这将作为此类情况的早期预警系统。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2018-01-22T23:49:25.423

是的，这绝对是疯狂的，真的很痛苦。这是您的另一个选择： 1\. 从 GAC 中删除程序集，正如其他帖子所建议的那样。2\. 让您的依赖解析系统将程序集传送到您的 BIN 文件夹。这也是您的所有解决方案程序集也将被编译到的地方。3\. 设置所有引用 Copy Local = false AND Specific Version = False。这样做的目的是在调试时导致程序集加载异常，因为如果它不在 BIN 中，那么那里没有任何东西可以复制它。并且您的解决方案将编译得更快，因为 VS 不必复制文件。并且这将防止“不死” dll 位于 obj 目录中的某个位置，VS 会奇迹般地找到并复制它......

这适用于您控制的解决方案。多年来，我们一直在这样做。并且很容易找出是否有事情偏离了轨道，然后您只需寻找具有 Copy Local = true 或 Specific Version = True 的程序集，这种情况偶尔会发生（忘记、累等）。我目前的问题是我无法控制我正在研究的解决方案的结构或设置，因此为这个古老的问题寻找解决方案。我希望VS团队解决它......唉......团队，停止这种痛苦。

# mysql - 在 MySQL 中复制行

> ID：229998
> 
>         
> 
> 赞同：14
> 
>         
> 
> 时间：2008-10-23T14:38:58.093
> 
>         
> 
> 标签：mysql, sql

我想复制一行的所有列，但不必指定每一列。我知道[http://dev.mysql.com/doc/refman/5.1/en/insert-select.html](http://dev.mysql.com/doc/refman/5.1/en/insert-select.html)的语法，但我看不到忽略列的方法。

对于我的示例，我试图将行的所有列复制到新行，但主键除外。

有没有办法做到这一点，而不必用其中的每个字段编写查询？

* * *

## 回答 #1

> 赞同：16
> 
>             
> 
> 时间：2010-10-12T20:03:57.573

如果您的`id`或主键列是，`auto_increment`您可以使用临时表：

```
CREATE TEMPORARY TABLE temp_table 
AS 
SELECT * FROM source_table WHERE id='7'; 
UPDATE temp_table SET id='100' WHERE id='7';
INSERT INTO source_table SELECT * FROM temp_table;
DROP TEMPORARY TABLE temp_table; 
```

所以通过这种方式，您可以复制行 id='7' 中的所有数据，然后分配新值 '100'（或任何值超出 source_table 中当前 auto_increment 值的范围）。

编辑：注意 ; 在陈述之后:)

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2008-10-23T14:43:09.100

如果您没有选择所有列，则需要列出要选择的列。复制/粘贴是您的朋友。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2011-06-10T16:38:51.973

这是我为此编写的一个 PHP 脚本，它将假定您的第一个 col 是您的自动增量。

```
$sql = "SELECT * FROM table_name LIMIT 1"; 
$res = mysql_query($sql) or die(mysql_error());
for ($i = 1; $i < mysql_num_fields($res); $i++) {
     $col_names .= mysql_field_name($res, $i).", ";
 }
 $col_names = substr($col_names, 0, -2);

$sql = "INSERT INTO table_name (".$col_names.") SELECT ".$col_names." FROM table_name WHERE condition ";
$res = mysql_query($sql) or die(mysql_error()); 
```

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T14:46:04.147

如果您不指定列，则必须使条目保持有序。例如：

```
INSERT INTO `users` (`ID`, `Email`, `UserName`) VALUES
(1, 'so@so.com', 'StackOverflow') 
```

会工作，但

```
INSERT INTO `users` VALUES
('so@so.com', 'StackOverflow') 
```

会将电子邮件放在 ID 列中，这样就不好了。

尝试像这样编写列：

```
INSERT INTO `users` (`Email`, `UserName`) VALUES
('so@so.com', 'StackOverflow'),
('so2@so.com', 'StackOverflow2'),
('so3@so.com', 'StackOverflow3'),
etc... 
```

我认为使用该方法可以插入多少行是有限制的。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2008-10-23T14:57:17.510

不，这是不可能的。

但是获取列列表很容易，只需删除您不想复制的列，此过程也可以通过代码等完成。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2011-12-13T05:23:03.067

将表复制到新表，然后删除不需要的列。简单的。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-03-20T21:24:39.813

I'm assuming that since you want to omit the primary key that it is an `auto_increment` column and you want MySQL to autogenerate the next value in the sequence.

Given that, assuming that you do not need to do bulk inserts via the insert into ... select from method, the following will work for single/multi record inserts:

insert into mytable (null, 'a', 'b', 'c');

Where the first column is your `auto_incremented` primary key and the others are your other columns on the table. When MySQL sees a null (or 0) for an `auto_incremented` column it will automatically replace the null with the next valid value (see [this link](http://dev.mysql.com/doc/refman/5.0/en/server-sql-mode.html#sqlmode_no_auto_value_on_zero) for more information). This functionality can be disabled by disabling the `NO_AUTO_VALUE_ON_ZERO` sql mode described in that link.

Let me know if you have any questions.

-Dipin** 
```**~~~~****