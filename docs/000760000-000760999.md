# StackOverflow 问答 000760000-000760999

# xmpp - 哪些用户当前连接到 Openfire Jabber 服务器？

> ID：760001
> 
> 赞同：1
> 
> 时间：2009-04-17T11:03:35.700
> 
> 标签：xmpp, openfire

我有一个 Openfire Jabber 服务器，列出了超过 75,000 个用户。其中，150 人或更多人可以随时在线。

有没有什么地方可以收集当前登录用户的 JID（用户名）？我拥有对基础数据的完全数据库访问权限，但服务器似乎没有将当前状态写回数据库。由于用户数量众多，没有使用名册。

返回的一组非常有用的数据将来自一个简单的（受密码保护的）网页，每行一个 JID，可选的还有登录时间，也可能是该帐户最后一次执行操作 [如发送消息]。后两者不是必需的，但如果数据可用，以及有关用户会话的任何其他可用信息，将很有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T01:11:48.597

不知道这是否会有所帮助，但我遇到了类似的功能。如 XEP-0045 [http://xmpp.org/extensions/xep-0045.html#disco-roominfo](http://xmpp.org/extensions/xep-0045.html#disco-roominfo)中所定义：

> 如果该信息是公开的，则实现可以返回现有居住者的列表，或者如果该信息保持私密，则根本不返回列表。建议实现和部署默认关闭此类信息共享。

所以你需要确保它像 Openfire 上宣传的那样工作（我遇到的所有 xmpp 服务器都有一个或两个错误），我想你需要编写一些逻辑来获得结果。

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-04T18:11:00.753

不是一个完美的答案，但您想要的查询可能嵌入在 session-summary.jsp 页面中。我在[http://localhost:9090/session-summary.jsp](http://localhost:9090/session-summary.jsp)的本地托管服务器上找到了它。我不知道是否将其存储在可查询的数据库中，或者是否存储在客户端内部。后者的可能性更大。

该页面显示的数据是名称、资源、状态、状态、优先级、客户端 IP 和关闭连接。

# projects-and-solutions - 不编写程序的原因？

> ID：760002
> 
> 赞同：9
> 
> 时间：2009-04-17T11:03:43.750
> 
> 标签：projects-and-solutions, enterprise

让我们扮演魔鬼的拥护者：您不让管理层编写解决方案，而是购买昂贵的软件包的原因是什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-17T11:05:47.223

1.  买进更便宜。
2.  如果现有开发人员不熟悉该域
3.  如果风险水平高得无法接受
4.  时间紧迫性。

尽管在一天结束时，一切都以某种方式归结为第 1 点。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-17T11:04:36.337

简单的; 当您自己编写的总拥有成本 ( [TCO](http://en.wiktionary.org/wiki/TCO) ) 大于软件包的 TCO 时购买。（如何可靠地计算出自己编写的 TCO 是留给读者的练习 ;-)）

没那么简单; 当软件是你的核心业务，或者当软件是一个独特的卖点时，DIY。你不想外包你的大脑或心脏。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T11:05:32.187

已经存在一个非常相似的程序。除非您是出于娱乐/学习目的而这样做

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-17T11:17:43.297

购买组件的优势： - 购买它可能比开发它更便宜 - （在某些情况下）团队不知道如何开发该组件。因此，收集该专有技术的时间令人望而却步 - 维护成本转移给了供应商

缺点 - 无法控制组件的生命周期（包括何时发布新版本，应该进行哪些修复等） - 可能需要适应/集成工作。- 由于集成问题，它可能会引入性能惩罚。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-17T11:27:39.793

我见过很多这样的例子，我认为它分为两半。首先，您的“商品”软件——消息传递中间件、数据库等——通常总是被购买。我永远不会坐下来编写自己的异步消息传递系统，除非那绝对是我业务的核心。其次，还有增值部分，我认为是比较不同的。

我从事金融工作，有一些供应商系统（例如 Murex、Summit 和 Sophis）为各种金融市场产品执行风险/预订/后台功能。我认为选择这些是危险的，原因有两个。

第一个原因是您在软件方面并没有进一步领先于您的竞争对手，您没有增加自己的价值，所以就您可以收取的价格或价格而言，它只是一场“竞相”你可以承担的风险。

第二个原因，从软件开发人员的角度来看更重要的是，虽然供应商的系统现在可能适合您，但可能在两三年后不适合您。如果您在此基础上建立了自己的业务，但它突然发生了变化——或者在您需要时没有变化——您可能会被抛在脑后。或者，如果公司破产或想要退出市场，您有两种选择 - 购买它，或者从头开始重新编写您的所有系统。

我已经数不清有多少公司拼命尝试关闭增值供应商系统（典型的例子是 Murex、Sophis、Summit ......见上文 :) 并编写自己的系统。

反对供应商系统增值的补充论点是顾问/承包商通常要贵得多。可以在这里以每天 x00 英镑的价格聘请高级 c# 顾问。具有供应商系统经验的顾问将增加约 20-25%。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-17T13:52:38.307

我会给他们真正的原因（假设我在一家我真正想工作的公司，也就是说，而不是被 PHB 奴役）。通常这是“如果我有这个，我会更快地完成我的工作，我的时间对你来说很有价值”。

但更有帮助：如果问题是“什么时候出现你想为软件付费的情况？”，那么：

*   当有问题的软件不是公司赚钱的核心竞争力时。在非软件公司的情况下，同样的事情，但用“部门”而不是“公司”和“证明其存在”而不是“赚钱”。所以我们要买一个包裹，问题是要不要买那个贵的。

在这种情况下

*   当没有好的免费选项存在时，或者由于更好的功能、更低的 TCO（因为不必自己修复错误）或其他原因，昂贵的软件比免费的软件更好。

或者：

*   当软件包不仅仅是软件，它是一项托管服务时，组织培训某人安装服务并让整个人 24/7 全天候待命维护它的成本甚至比“昂贵”还要高包裹。这是 TCO 的另一部分，但即使软件本身的成本相同，它也适用。

第一点的意思是，游戏公司不应该编写自己的 IDE，Web 应用程序公司不应该编写自己的编译器，银行软件部门不应该编写办公应用程序等，除非你真的认为自己' 这样做比编写游戏、网络应用程序、交易软件或任何你有实际截止日期的东西要好。显然有一些例外：如果您想要一个很小的脚本或 web 应用程序，那么编写它可能比找到可以满足您需要的现成的东西更容易。

第二点，“更好”对不同的组织意味着不同的东西。假设功能相同，如果您的部门充满了 linux 极客，那么免费选项可能比您没有 linux 极客有更多的加分，并且还需要有关软件包的 SLA。如果“包”将被编译到您的非自由产品中，而不是仅仅支持您的开发，那么显然 GPL 中的免费软件对您毫无用处，而 MIT 中的免费软件可能是美好的。等等。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-17T12:02:59.520

大大简化，但选择最小的：

*   对于自制工具：成本 = (task_execution_time * uses * $/user-h + tool_development_time * $/dev-h
*   对于购买的工具：成本 = task_execution_time * uses * $/user-h + tool_purchase_price
*   没有工具：cost = task_execution_time * uses * $/user-h

cost 是执行`task` `uses`次数的成本。task_execution_time 是执行任务所需的（人）时间，包括任何开销，tool_development_time 是开发工具所需的时间。

为了简单起见，我省略了很多变量。添加更多以适合:)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-09T13:55:27.653

这部分取决于管理层希望开发人员编写什么代码。

如果它是一家游戏开发公司并且他们正在推出自己的电子邮件解决方案，那将是一种浪费。有才华的游戏开发人员编写自己的 SMTP 客户端和服务器系统，而不是进行更有趣的游戏开发（更不用说这可能会违背开发人员在被录用时可能想到的任何“使命宣言”） .

相反，如果它正在编写一些小实用程序或其他代码，那么它可能是值得的。如果有实习生，这可能是一个很好的项目，可以让他们开始，或者如果一些开发人员厌倦了游戏物理并想做一些更平淡的事情，他们可以工作一段时间。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-09T13:58:46.257

当我想自己编写一些代码，而我的老老板认为我们应该买它时，他会说，“买最好的，做剩下的。”

另一个经验法则：当它是您业务的核心产品之一时，请自己动手。如果不是，请考虑外包或从有核心产品的人那里购买。反正他们会做得更好。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-09T14:01:15.940

我认为一个类比是合适的。

假设您对最新的赛车引擎有一个想法，该引擎可以立即使任何汽车以 20 英里/小时的速度行驶。你之所以能够做到这一点，是因为你在量子层面深入了解了如何优化引擎以使它们更好地工作。但是，您在其他领域（例如设计车架或车轮）的工程技能只是平均水平。您是否打算花时间尝试提高这些技能并重新发明轮子（或原来的框架？）？不。

相反，您将与制造最好的轮胎和制造最好的车架的人合作，并将您的引擎与他们结合起来。这可以节省您的时间和金钱，因为您专注于您的产品，而不是提供支持基础设施。

这也适用于软件。如果您需要的工具非常复杂，请从其他地方获取它们，因为您希望专注于制作最终产品，而不是让您制作产品的基础设施。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-17T11:07:16.737

与购买解决方案所涉及的成本和时间相比，开发新解决方案所涉及的成本和时间很高。通常管理层对这两个因素非常敏感。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-17T11:10:08.713

它会更便宜，但前提是您准备修改您的业务实践以适应该软件包的工作方式。在包上执行大量定制以适应您的业务实践几乎总是比从头开始创建定制应用程序花费更多，而且常常以泪水告终。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-17T11:24:40.877

购买软件的原因有很多。在我看来，最重要的是：

*   组织内部缺乏知识和专业知识
*   缺乏快速适应市场或法律变化的人力（税收）

外包优势：

*   更容易预算
*   无需雇佣、培训人员
*   能够签订严格的服务水平合同

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-04-17T11:31:30.797

如果您要从头开始制造自己的汽车，那可能会非常昂贵且非常不可靠，但如果您要购买现成的汽车，则可能会便宜得多，而且更可靠。

软件也是如此（大多数时候），每一位定制代码不仅需要开发，还需要测试和支持。如果您可以使产品符合客户的要求，那么它通常是一个更具成本效益的解决方案。然而，我认为当一个产品被硬塞进一组需求时，问题就会出现，这些需求需要一些它不是为它设计的东西。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-04-17T11:43:51.813

一些原因

*   该解决方案不支持核心业务流程，而是支持**商品流程**，例如财务、人力资源、设施管理，您与竞争对手没有什么不同（您的核心/非核心流程会有所不同！）。您的内部开发技能将更好地用于创建和维护使您的公司具有竞争优势的解决方案。
*   如果解决方案不需要与您现有或未来的解决方案高度集成（它支持相对孤立的过程），则前者适用。
*   在内部开发的应用程序的整个生命周期中，无需为维护预算和人员。数字各不相同，但我看到并认为相当可信的一个数字是自定义应用程序的初始开发成本仅占**总生命周期成本的十分之一**。当然，这包括最终用户培训、O/S 升级和集成等内容，这些内容也会影响外部采购的解决方案，但初始价格标签的 10 倍因素将使大多数管理人员暂停。
*   前者的一个特例：您的组织可能缺乏开发、维护和运营**技能或存在瓶颈。**每个技能短缺都可以用足够的时间和金钱来填补，但不一定在可接受的范围内。您的员工需要获得的每一项额外技术技能都意味着更少的时间来开发和维护现有技能：多样化技术环境的技能成本以超过线性的速度增长......
*   正如彼得所说：**可预测**但高成本可以胜过启动开发项目的风险，在一个企业中，20% 的成本超支通常被认为是一个成功的项目，而不成功的项目基本上没有限制......
*   **正如 vatine 还注意到的那样：商业软件现在**可以拥有，仅因安装和最终用户培训而延迟。诚然，SAP 之类的安装不是一天就能完成的……

这适用于您的供应商相当稳定的情况。如果他们规模小或财力薄弱，那么商业软件可能比内部开发是一场更大的赌博。

不管你走哪条路，你都会得到锁定效应。从真正有用的应用程序中迁移出来从来都不是免费的，而且很少便宜。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-04-17T11:48:42.410

一次性内部开发可以取代订阅软件，即，如果您有可用的开发资源，一次性开发成本 2X 可以取代 X 的年度订阅。这也可能意味着最终解决方案完全针对业务需求，而第三方解决方案可能不完全匹配或需要额外的支持或解决方法。这适用于我在过去一两年内从事的项目，其好处是新系统更准确，因此需要更少的支持人员。是的，好的软件会让人变得多余。

公司核心软件也应该进行内部开发，该软件允许您作为一个实体存在，这样您就不会在下次软件支持合同或订阅到来时闲逛，或者通过一个解决方案不完全适合您的需求。

但是，不提供核心功能的基本软件的一次性成本很容易证明是合理的，无论是对甲骨文来说是巨额资金，还是上周您需要的体面的 CMS、CRM 或客户票务系统。

# windows - 如何理解 Windows 中的异步 io？

> ID：760012
> 
> 赞同：1
> 
> 时间：2009-04-17T11:05:49.127
> 
> 标签：windows, multithreading, operating-system, filesystems, io

1.如何理解Windows中的异步io？？

2.如果我使用异步 io 向文件写入/读取内容：

```
WriteFile();
ReadFile();
WriteFile(); 
```

操作系统生成多少线程来完成这些任务？

3个任务是同时以多线程方式运行还是以不同的顺序一个接一个地运行？

3.我可以使用多线程并且在每个线程中使用一个异步io来读写同一个文件吗？</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T11:30:13.437

> 1.如何理解Windows中的异步io？？

阅读 Win32 文档。在网上搜索。不要期望在 SO 中回答如此大而广泛的问题。

> 2.如果我使用异步 io 向文件写入/读取内容：
> 
> 写入文件（）；读取文件（）；写入文件（）；
> 
> 操作系统生成多少线程来完成这些任务？

我认为不会。它将重新使用现有的线程上下文来执行内核函数调用。基本上操作系统会安排工作并借用一个线程来完成它——这很好，因为内核上下文总是相同的。

> 3.我可以使用多线程并且在每个线程中使用一个异步io来读写同一个文件吗？</p>

我相信是的，是的。我不知道执行顺序是否保证与提交顺序匹配，在这种情况下，如果您在相同的字节范围上发出并发读/写，您将获得不可预知的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T11:14:16.067

我想这取决于您使用的操作系统。但是无论如何你都不应该担心这个，它是透明的，不应该影响你编写代码的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T11:19:31.293

如果您在 windows 中使用标准读写，则不必担心系统可能不会立即写入，除非您在命令行上写入并等待用户输入一些输入。操作系统负责确保您写入的内容最终会写入硬盘驱动器，并且会做得更好，无论如何您都可以做到。

如果您正在处理一些奇怪的异步 io，请重新格式化您的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T11:21:13.303

对于您的问题：

> 操作系统生成多少线程来完成这些任务？

取决于您是否使用 Windows 池、iocp 等。通常由您决定。

> 3个任务是同时以多线程方式运行还是以不同的顺序一个接一个地运行？

这取决于您的架构。在单核机器上，3个任务一个接一个地运行，顺序由os决定。在多核机器上，它们可能一起运行，具体取决于操作系统如何调度线程。

> 3.我可以使用多线程并且在每个线程中使用一个异步io来读写同一个文件吗？</p>

那是我不知道的，所以其他人需要回答这个问题。

[我建议通过 C/C++](https://rads.stackoverflow.com/amzn/click/com/0735624240)获取 Windows 的副本，因为其中有很大一章是关于异步 IO 的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T18:40:35.837

我建议寻找 Jeffery Richter 关于 Win32 编程的书籍。对于这类事情，它们是写得非常好的指南。我认为他有一本关于 C# 的新书，所以请注意不要买错了。

# sql-server - SQLBulkCopy 是否会显着增加 .mdf 文件的大小？

> ID：760013
> 
> 赞同：0
> 
> 时间：2009-04-17T11:05:52.140
> 
> 标签：sql-server, sqlbulkcopy

我正在使用 SqlBulkCopy 类对 SQLServer 数据库进行批量插入。

与 DB 关联的 .mdf 文件的原始大小为 1508 Mb。

当我以 100000 的 BatchSize 运行它（在大约 400 万条记录的相同数据上）时
，.mdf 的大小增长到 1661 MB。
BatchSize 为 1000000，.mdf 的大小增长到 1659 MB。

为什么会有这种变化？这么小的变化可以忽略不计，除了**当我的测试器以 100 的批量大小运行它（在相同的数据上）时，.mdf 文件疯狂增长，直到它用完所有可用的 20 个演出，然后它由于可用空间不足，出现错误。**

这是因为 SqlBulkCopy 分配了一些固定大小的块吗？
它在 BatchSizes > 100000 时工作正常，但我想了解这种奇怪行为/错误的根本原因。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T11:22:17.373

您的 mdf 文件是存储数据的位置 - 它应该根据您的数据负载大致增长。但正如“ck”已经指出的那样——SQL Server 允许您指定某种增长模式，例如，每当您插入一行时，mdf 文件不会逐字节增长。因此，根据您的设置，当它需要更多空间时，它的大小会“跳跃”。

这与您是使用常规 INSERT 语句还是 SqlBulkLoad 加载数据无关。

马克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T11:07:36.970

这取决于数据库的增长设置。默认是增长 10%，但是当它填满时你可以设置增长 1GB 等等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T15:04:47.633

通过批量加载或“常规”加载加载数据将影响日志文件的大小，而不是 MDF 文件（数据库必须处于简单或批量日志恢复模式，还有一些其他要求）你确定测试人员的日志文件没有用完所有可用空间？

# c# - 传输 LINQ 数据对象

> ID：760017
> 
> 赞同：2
> 
> 时间：2009-04-17T11:06:36.457
> 
> 标签：c#, linq, linq-to-sql

我正在开发一个使用 LINQ-to-SQL 进行数据库抽象的 Web 服务。当客户使用我们的 web 服务时，对象被序列化为 XML，一切都很好。

现在我们希望开发我们自己的使用本机数据类型的客户端，因为没有理由做对象->xml->对象。但是，据我了解，您无法传输 LINQ 对象，因为它们直接映射到数据库，因此数据是“实时的”。

我的问题是是否有办法对您提取的数据进行“快照”，将 LINQ 对象设置为“离线”，然后传输它。数据传输到我们的客户后不会改变，我们不需要数据库访问。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T11:32:27.300

LINQ-to-SQL 类可以`DataContractSerializer`很容易地与（对于 WCF）一起使用（不过，您需要在设计器中启用序列化属性）。有了这个，您应该能够与客户端共享数据集。只要您不使用数据上下文，对象本身就应该表现良好（只是断开连接 - 所以没有延迟加载）。

诀窍是您需要在序列化代码中重用这些类型（来自现有程序集）。如果您使用的是 WCF，则可以使用`svcutil /r`IDE 或通过 IDE 执行此操作。

话虽如此；为这些场景维护单独的 DTO 类通常更简洁。但我有时会因为上述方式而感到内疚。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T11:31:15.527

如果您愿意使用 WCF（用于 Web 服务和客户端），您可以使用 [DataContract] 和 [DataMember] 属性装饰您的 Linq2SQL 生成的类。

检查以下链接以获得一些指导：

*   [http://msdn.microsoft.com/en-us/library/bb546184.aspx](http://msdn.microsoft.com/en-us/library/bb546184.aspx)
*   [http://msdn.microsoft.com/en-us/library/bb546185.aspx](http://msdn.microsoft.com/en-us/library/bb546185.aspx)
*   [http://www.codeproject.com/KB/WCF/LinqWcfService.aspx](http://www.codeproject.com/KB/WCF/LinqWcfService.aspx)
*   [http://www.aspfree.com/c/a/Windows-Scripting/Designing-WCF-DataContract-Classes-Using-the-LINQ-to-SQL-Designer/](http://www.aspfree.com/c/a/Windows-Scripting/Designing-WCF-DataContract-Classes-Using-the-LINQ-to-SQL-Designer/)

# c++ - 变量值的后缀#DEN 是什么意思

> ID：760030
> 
> 赞同：62
> 
> 时间：2009-04-17T11:13:37.470
> 
> 标签：c++, visual-studio, debugging, visual-studio-2005

在 VS2005 中调试时，我在 Locals 窗口中有一个浮点数，其值为： `1.744e-039#DEN`

`#DEN`表示/代表什么？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-04-17T11:17:25.917

这是针对“[非规范化数字](http://en.wikipedia.org/wiki/Denormal_number)”的。有关更多信息，请参阅[此](http://www.masonzhang.com/2008/09/floating-point-bit-value-of-inf-nan-den.html)内容。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-04-17T11:16:58.820

非规范化；太小（接近于零）无法表示为 1.M * 2^E 形式的数字

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-17T11:17:33.280

非正常 - 太接近于零 - 见[http://en.wikipedia.org/wiki/Denormal](http://en.wikipedia.org/wiki/Denormal)

# python - 调查 python 进程以查看正在消耗 CPU 的内容

> ID：760039
> 
> 赞同：6
> 
> 时间：2009-04-17T11:17:34.200
> 
> 标签：python, multithreading, debugging, monitoring, pylons

我有一个不断使用 10-30% CPU 的 python 进程（Pylons webapp）。我将改进/调整日志记录以了解正在发生的事情，但在此之前，是否有任何工具/技术可以查看 python 进程正在做什么、它有多少线程和有多忙等？

**更新：**

*   配置的访问日志显示没有请求正在进行，webapp 只是空闲
*   没有必要在中间件链中插入 paste.profile，因为没有请求，活动必须在 webapp 的工作线程或粘贴 web 服务器中发生
*   像这样运行 paste: "python -m cProfile -o outfile /usr/bin/paster serve dev.ini" 并检查结果表明大部分时间都花在了 "posix.waitpid" 上。Paster在子流程中运行webapp，探查器未拾取子流程活动
*   调查 ;hacking PasteScript "serve" 命令，以便对子进程进行分析

**另一个更新：**

经过多次修改，在各个地方粘贴分析器并熟悉 PasteScript 内部，我发现如果应用程序在没有“--reload”参数的情况下启动，持续的 CPU 负载就会消失（这个标志告诉 paster 如果代码发生变化，则重新启动，很方便开发），这在生产环境中很好。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-17T11:22:27.543

[分析](http://docs.python.org/library/profile.html#instant-user-s-manual)可能会帮助您了解它在做什么。如果您按“时间”对输出进行排序，您将看到哪些函数占用了 cpu 时间，这应该会给您一些很好的提示。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-24T03:45:38.397

如您所述，在 --reload 模式下，Paste 每秒扫描一次文件系统，以查看加载的任何文件是否已更改。如果有，Paste 会重新加载该过程。如果需要，您还可以手动告诉 Paste 监视非 Python 代码模块的更改。

您可以使用 --reload-interval 选项更改重新加载间隔，这将减少使用 --reload 时的 CPU 使用率，因为它会减少扫描频率。

# mysql - 如何在数据库中存储“愿望清单”？

> ID：760050
> 
> 赞同：0
> 
> 时间：2009-04-17T11:22:52.473
> 
> 标签：mysql, database, database-design

我正在考虑创建一个“愿望清单”。每个用户都可以在商店中购买愿望。如何存储心愿单？我正在考虑创建一个用户表和一个愿望清单表。

用户表的结构： 列：id、用户名、密码等

列：id、wish、价格、数量等

用户 id 是用户表的主键，它是愿望清单表的外键。但是，当我想到它时，我的愿望清单中的每个用户都会有重复的项目，不是吗？

有没有更好的方法来存储愿望清单的东西？

我正在使用mysql。谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T11:30:27.977

您还应该有另一个表来存储购买：

购买

*   ID
*   用户身份
*   WishId
*   购买日期

用户

*   ID
*   姓名
*   密码

愿望

*   ID
*   希望
*   价格
*   数量

每次用户购买愿望时，您都会在 Purchases 表中创建一条记录，并减少该愿望的数量计数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T11:25:20.190

这是一对一的关系。

假设您有一个以 user_id 作为主键的 User 表，然后创建一个以 user_id 作为外键的表 Wish。将您想要的属性添加到第二个表和中提琴。

路易斯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T11:27:15.147

您应该有另一个愿望表（愿望 ID、价格、描述等），并且应该有一个连接表（用户 ID、愿望 ID、数量、报价等）。该表将允许您在用户和愿望之间建立多对多的关系。

（进一步我的评论......看？你已经有**两个**不同的建议。最终你必须决定什么是最好的，理想情况下你的业务/项目需求应该指导你。）

**编辑**：提出**三个**不同的建议

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-07T08:45:42.933

您基本上只需要知道几件事即可将信息添加到愿望清单。这是我在我的一个客户项目中使用它的方式：

**愿望清单**

*   愿望清单_id
*   用户身份
*   product_id
*   created_date_time

只为经过身份验证的用户提供愿望清单是有意义的，因此请确保您正在处理这一点。

# .net - 来自 ide 的格式代码（VS2008）

> ID：760054
> 
> 赞同：0
> 
> 时间：2009-04-17T11:24:49.613
> 
> 标签：.net, visual-studio, visual-studio-2008, ide, code-formatting

每隔一段时间我会粘贴一些代码，它会丢失所有的标签，看起来很糟糕

我知道在 vs2008 xml 查看器中有一个按钮可以将所有代码格式化（缩进）到正确的层次结构

是否有这样的功能或宏或快捷键可以将其应用于一段代码（或该窗口中的所有代码）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T11:31:11.767

编辑菜单 - 然后是高级 - 然后是格式选择（如果您突出显示它）。

快捷键是：Ctrl + E、F（用于选择）和 Ctrl + E、D（用于文档）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-17T11:51:23.853

注意键盘快捷键，我认为它们取决于开发环境样式设置，例如我的格式文档是 Ctrl+K, D

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-17T18:06:45.707

格式化文档

```
( Ctrl-K, Ctrl-D ) 
```

格式选择

```
( Ctrl-K, Ctrl-F ) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-24T14:26:09.513

“Pimp My IDE”中的第 42 项：Brian Schroer[的 101 个 Visual Studio 提示、技巧和插件](http://geekswithblogs.net/brians/archive/2008/05/12/122087.aspx)。其他一些技巧也很不错。

# integration-testing - 集成测试 - 您在什么级别进行测试以及如何设置？

> ID：760061
> 
> 赞同：1
> 
> 时间：2009-04-17T11:27:25.300
> 
> 标签：integration-testing

我刚刚在我的应用程序中遇到了一个错误，可能已经被一些集成测试捕获了，所以我认为是时候写一些了！

我的问题与这些测试的设置有关，以及您在代码的哪一层运行测试。

**设置**

考虑到我应该有很多集成测试，我不想为每个测试创建和删除一个测试数据库，这会非常慢（即使它是内存中的 SqlLite）。我的想法是：

1.  在我的开发数据库旁边有一个测试数据库
2.  在测试之前，运行一些重置脚本，它将正确设置我的模式并插入任何必要的数据（不是特定于测试用例）
3.  只需使用这个测试数据库，就好像它是真正的数据库一样。

但是，我必须在每个 [Setup] 中运行我的 Fluent NHib 配置似乎非常浪费。这很难吗？我在这里有什么选择？

我的会话当前包含在 UoW 模式中，分别在 begin_request 和 end_request（MVC Web 应用程序）上执行创建和销毁。我应该修改它以与测试一起解决这个问题吗？

**测试**

在实际编写一些测试时，我应该怎么做？

我应该从可能的最高级别（我的 MVC 控制器操作）还是从最低级别（存储库）进行测试。

如果我测试最低，我将不得不手动对所有数据进行硬编码。这将使我的测试对代码的更改变得脆弱，并且也不能代表运行时代码中实际发生的情况。如果我在最高级别进行测试，我必须运行我的所有 IoCC 设置，以便注入依赖项并让整个事情发挥作用（再次，在每个 [SetUp] 中重复这个？）

呸！我迷路了，有人指出我正确的方向！

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T12:12:22.917

In regards to creating the session factory, I create a class called _AssemblyCommon in my test project and expose the session factory as a static from there. A method marked with the [SetupFixture] (NUnit) attribute configures the session factory.

In general integration tests should cover CRUD operations in the repositories. To do this, I have one test method per object (or aggregate root) and do an insert, retrieve, update, and delete all within that method. I also test any cascade deletes that I've defined. Keeping these operations in a single method doesn't leave any traces behind in the database. I do have some integration tests that leave behind test data but that hasn't been a problem.

Your higher level operations should be unit tested and mock (I use Moq) the repositories if possible.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T12:59:31.023

在我当前的 MVC 应用程序中，我发现测试存储库和数据库之间的交互就足够了。最重要的是，这是为了消除 NHibernate 映射中的任何皱纹。该层之上的所有内容（好吧，当我说所有内容时我都在夸大其词）都是单独进行单元测试的。我确实有一些从控制器一直到堆栈到数据库的集成测试，这些测试使用 IoC 容器 (StructureMap) 来构建控制器和依赖项，但我发现这些测试实际上并没有添加任何东西，而且它们相当维护的开销，所以我现在已经从“集成”测试中删除了它们——我可能会找到一个理由把它们放进去，但到目前为止我还没有。

无论如何，我使用的测试过程是这样的：

数据访问层测试程序集的构建过程通过 FluentNHibernate 配置 ExposeSchema() 调用创建测试数据库。构建过程然后运行一些 NHibernate 存储库级别的代码来填充数据库中的引用表。

然后将运行的每个集成测试包装在 System.Transactions.TransactionScope using() 语句中，并且 TransactionScope 永远不会调用 Complete()，因此每个测试都可以单独运行，并且可以在 using() 范围内设置和验证结果通过 ISession 而不改变任何其他测试数据的状态。例如

```
 using (new TransactionScope())
  {
    var session = NHibernateTestSessionCreator.GetNHibernateSessionForIntegrationTesting();
    // This is an NHibernate ISession - setup any dependencies for the repository tests here

    var testRepository = new NHibernateGenericRepository<NewsItem>(NHibernateTestSessionCreator.GetNHibernateSessionForIntegrationTesting())
    // repository test code goes here - the repository is using a different ISession

    // Validate the results here directly with the ISession
  }

  // at this point the transaction is rolled back and we haven't changed the test data 
```

这意味着我不必修改我正在使用的 UnitOfWork 实现 - 事务在更高级别回滚。

# c# - 警告为错误，但不是全部

> ID：760071
> 
> 赞同：6
> 
> 时间：2009-04-17T11:32:47.627
> 
> 标签：c#

出于显而易见的原因，我想在我们当前的项目/解决方案中启用警告作为错误。

有几个警告不应作为错误处理，例如已过时和使用#warning 指令。

这可能吗？

我看到我可以让特定的警告表现为错误，但我真的很喜欢“反转”。

我能得到的最接近的是禁用上面提到的 2 个警告，但是它们也不会有“警告”。

有什么建议么？

**澄清：**

我想要警告，而不是错误。因此，除了上述异常之外的所有警告都将表现为错误，而上述将是警告（我可以在编译器结果中看到的警告）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-17T12:00:14.880

编译器[`warnaserror`](http://msdn.microsoft.com/en-us/library/406xhdz3.aspx)选项仅支持在特定警告时出错。因此，您可以指定将所有警告显示为错误，然后禁用某些警告的错误。使用页面的示例作为指南：

```
/warnaserror
/warnaserror-:642,649,652 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T12:07:45.983

假设您使用的是 C#，则在 VS2005 中是可能的。

来自[http://blogs.msdn.com/kaevans/archive/2005/11/06/489681.aspx](http://blogs.msdn.com/kaevans/archive/2005/11/06/489681.aspx)

> 在 Visual Studio 2005 中，您可以使用更多选项来控制它。现在，您有 3 个选项可将警告视为错误：全部、无或特定警告，您可以在其中提供以分号分隔的错误编号列表。

也可以使用 GCC 选项 -Werror=

# sharepoint - 是否可以在页面布局中格式化 NumberField？

> ID：760081
> 
> 赞同：1
> 
> 时间：2009-04-17T11:41:06.813
> 
> 标签：sharepoint, formatting, moss, page-layout

我正在开发一个 SharePoint 发布网站并设置其内容类型和页面布局。我需要显示 Number 类型的 Year 字段的值。目前的标记是：

```
<SharePointWebControls:NumberField FieldName="Year" runat="server" id="Year" /> 
```

默认行为的问题是它用逗号显示每个数字，例如“2,009”而不是“2009”。有没有办法可以在字段上设置某种 String.Format 语法以使其正确显示？

我尝试创建一个新的渲染模板，如下所示：

```
<SharePoint:RenderingTemplate ID="YearNumberField" runat="server">
  <Template>
    <SharePoint:FormField ID="TextField" runat="server"/>
  </Template>
</SharePoint:RenderingTemplate> 
```

...但 FormField 对象上似乎没有任何“格式”属性。

谢谢你的帮助。

**更新：**

我尝试将 SharePoint:FormField 标记包装在 SharePoint:FormattedString 中。不幸的是，该字段未格式化，结果与[此问题](https://stackoverflow.com/questions/704332/sharepoint-2007-formatting-a-formfield)相同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T13:34:12.403

问题是渲染模板必须使用 FormField。这始终以以下格式呈现值：**1,989** . 为了解决这个问题，需要捕获和更改渲染的文本以获得所需的输出。以下是解决此问题的两种方法：

**1.写一个继承自NumberField的自定义控件**

可以重写 RenderFieldForDisplay 和 RenderFieldForInput 方法以提供所需的输出。可以将其他属性添加到控件以描述其他行为。

*优点：无需更改渲染模板。*

**2.编写一个自定义控件，在渲染模板中使用**

（例如）使用正则表达式更改文本的控件可以环绕 FormField 控件。

```
<SharePoint:RenderingTemplate ID="YearField" runat="server">
    <Template>
        <RX:RegexManipulatorControl runat="server"
                Mode="Replace"
                Expression=","
                Replacement="">
            <SharePoint:FormField runat="server"/>
        </RX:RegexManipulatorControl>
    </Template>
</SharePoint:RenderingTemplate> 
```

*优点：通用解决方案可用于任何类型的字段。*

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-21T16:24:55.987

来自*另一个 SharePoint 博客*

> 在 SharePoint Designer 中打开列表视图。
> 
> 右键单击数据视图 Web 部件。（名单）
> 
> 选择转换为 XSLT 数据视图
> 
> 单击要格式化的数字字段
> 
> A > 将出现显示数据字段，格式为
> 
> 单击格式为 - 数字格式选项下方的链接
> 
> 在选项下取消选择使用 1000 分隔符
> 
> 点击确定
> 
> 保存更改并按 F12 进行预览

# visual-studio-2005 - 视觉工作室和共享内存

> ID：760083
> 
> 赞同：0
> 
> 时间：2009-04-17T11:41:56.747
> 
> 标签：visual-studio-2005

我现在处理的项目是基于进程间通信的。

并且正在使用共享内存概念进行此进程间通信。

当我使用共享内存概念时，我需要的文件很少，例如 sys/ipc.h、sys/shm.h

这些文件是视觉工作室安装的一部分还是我必须下载的东西。

我需要知道是否需要重新安装 Visual Studio 2005 并启用进程间通信，以便这些文件可以自动使用。

检查此链接[http://www.cs.cf.ac.uk/Dave/C/node27.html](http://www.cs.cf.ac.uk/Dave/C/node27.html)

如果这个关于链接指的是 Solaris，我可以使用哪个概念在 Windows 中共享内存

**编辑：**但 CreateFileMapping 是正确映射文件。我需要将内存位置映射到另一个进程，以便使用存储在该位置的数据..

谢谢你，我会尝试代码..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-17T18:22:44.773

[http://msdn.microsoft.com/en-us/library/aa366551(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa366551(VS.85).aspx)

使用 CreateFileMapping 和 MapViewOfFile。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T11:44:26.383

您提到的头文件适用于类 UNIX 系统。下载标头对您没有好处，因为 UNIX 和 Windows 通常使用不同的方法来共享内存和 IPC。有关详细信息，请参阅[CreateFileMapping](http://msdn.microsoft.com/en-us/library/aa366537%28VS.85%29.aspx)和相关函数。

**编辑：**您引用的链接明确指的是 Solaris，而不是 Windows。正如我已经说过的，如果你想在 Windows 上使用共享内存，你需要使用像 CreateFileMapping 这样的内存映射文件函数。概括地说，两个进程都需要创建文件映射，然后可以将映射的文件视为共享内存。[这里](http://www.codeproject.com/KB/threads/csharedstruct.aspx)有一个例子。

# cocoa - 如何将其他语言添加到与 .dmg 一起使用的 sla.r？

> ID：760086
> 
> 赞同：0
> 
> 时间：2009-04-17T11:43:17.400
> 
> 标签：cocoa, macos, installation, dmg

我正在使用与我的 DMG 捆绑在一起的 SLA，如此处[所述](http://www.cocoadev.com/index.pl?InternetEnabledDiskImages)。

但是，我想支持 Apple 提供的 SLAResources 文件中给出的语言（例如加泰罗尼亚语）的 SLA。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T19:38:14.607

是的。将 Catalan 条目添加到“LPic”资源，并使用您在条目中定义的资源 ID 添加匹配的“TEXT”和“STR#”资源。您可以使用[ResKnife](http://resknife.sourceforge.net/)（ResEdit 的开源克隆）来编辑文件。

语言代码在 /System/Library/Frameworks/CoreServices.framework/Frameworks/CarbonCore.framework/Headers/Script.h 中定义。

# c# - 在 C# 4.0 中执行字符串

> ID：760088
> 
> 赞同：7
> 
> 时间：2009-04-17T11:43:33.000
> 
> 标签：c#

我想在 C# 中执行动态创建的字符串。我知道 VB 和 JScript.Net 可以做到这一点，甚至还有一种[方法](http://odetocode.com/Code/80.aspx)可以在 C# 中使用它的程序集作为解决方法。我还发现这篇[文章](http://www.ziggyware.com/readarticle.php?article_id=98)描述了如何做到这一点。

我今天阅读了有关 C# 4.0 特性的信息，这些特性使其更接近于将其作为主要特性之一的动态语言。那么，是否有人知道 C# 4.0 是否包含一些允许字符串执行的内置功能，或任何其他方式来执行上述文章中描述的操作。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-17T13:42:11.250

这很容易做到。我构建了以下便利包装器。它们是结构化的，因此您可以从定义方法或表达式的源代码片段构造一个程序集，并使用 DynamicCodeManager 的辅助方法按名称调用它们。

代码根据调用进行按需编译。添加更多方法将导致下次调用时自动重新编译。

您只提供一个方法体。如果您不想返回值，则返回 null 并且不要费心使用 InvokeMethod 返回的对象。

如果您在商业代码中使用它，请帮我一个忙，并感谢我的工作。这个库中真正的宝石是调用支持。让代码编译不是问题，而是调用。当你有一个可变长度的参数列表时，让反射正确匹配方法签名是相当棘手的。这就是 DynamicBase 存在的原因：编译器将方法绑定解析​​到这个显式声明的基类，使我们能够访问正确的 VMT。从那里开始，一切都在洗涤中。

我还应该指出，此功能使您的桌面应用程序容易受到脚本注入攻击。您应该非常小心地审查脚本的来源，或者降低运行生成的程序集的信任级别。

## 动态基础.cs

```
using System.Reflection;

namespace Dynamo
{
  public abstract class DynamicBase
  {
    public bool EvaluateCondition(string methodName, params object[] p)
    {
      methodName = string.Format("__dm_{0}", methodName);
      BindingFlags flags = BindingFlags.InvokeMethod | BindingFlags.Instance | BindingFlags.NonPublic;
      return (bool)GetType().InvokeMember(methodName, flags, null, this, p);
    }
    public object InvokeMethod(string methodName, params object[] p)
    {
      BindingFlags flags = BindingFlags.InvokeMethod | BindingFlags.Instance | BindingFlags.NonPublic;
      return GetType().InvokeMember(methodName, flags, null, this, p);
    }
    public double Transform(string functionName, params object[] p)
    {
      functionName = string.Format("__dm_{0}", functionName);
      BindingFlags flags = BindingFlags.InvokeMethod | BindingFlags.Instance | BindingFlags.NonPublic;
      return (double)GetType().InvokeMember(functionName, flags, null, this, p);
    }
  }
} 
```

## 动态代码管理器.cs

```
using System;
using System.CodeDom.Compiler;
using System.Collections.Generic;
using System.Diagnostics;
using System.Reflection;
using System.Text;
using Microsoft.CSharp;

namespace Dynamo
{
  public static class DynamicCodeManager
  {
    #region internal statics and constants
    static Dictionary<string, string> _conditionSnippet = new Dictionary<string, string>();
    static Dictionary<string, string> _methodSnippet = new Dictionary<string, string>();
    static string CodeStart = "using System;\r\nusing System.Collections.Generic;\r\n//using System.Linq;\r\nusing System.Text;\r\nusing System.Data;\r\nusing System.Reflection;\r\nusing System.CodeDom.Compiler;\r\nusing Microsoft.CSharp;\r\nnamespace Dynamo\r\n{\r\n  public class Dynamic : DynamicBase\r\n  {\r\n";
    static string DynamicConditionPrefix = "__dm_";
    static string ConditionTemplate = "    bool {0}{1}(params object[] p) {{ return {2}; }}\r\n";
    static string MethodTemplate = "    object {0}(params object[] p) {{\r\n{1}\r\n    }}\r\n";
    static string CodeEnd = "  }\r\n}";
    static List<string> _references = new List<string>("System.dll,System.dll,System.Data.dll,System.Xml.dll,mscorlib.dll,System.Windows.Forms.dll".Split(new char[] { ',' }));
    static Assembly _assembly = null;
    #endregion

    public static Assembly Assembly { get { return DynamicCodeManager._assembly; } }

    #region manage snippets
    public static void Clear()
    {
      _methodSnippet.Clear();
      _conditionSnippet.Clear();
      _assembly = null;
    }
    public static void Clear(string name)
    {
      if (_conditionSnippet.ContainsKey(name))
      {
        _assembly = null;
        _conditionSnippet.Remove(name);
      }
      else if (_methodSnippet.ContainsKey(name))
      {
        _assembly = null;
        _methodSnippet.Remove(name);
      }
    }

    public static void AddCondition(string conditionName, string booleanExpression)
    {
      if (_conditionSnippet.ContainsKey(conditionName))
        throw new InvalidOperationException(string.Format("There is already a condition called '{0}'", conditionName));
      StringBuilder src = new StringBuilder(CodeStart);
      src.AppendFormat(ConditionTemplate, DynamicConditionPrefix, conditionName, booleanExpression);
      src.Append(CodeEnd);
      Compile(src.ToString()); //if the condition is invalid an exception will occur here
      _conditionSnippet[conditionName] = booleanExpression;
      _assembly = null;
    }

    public static void AddMethod(string methodName, string methodSource)
    {
      if (_methodSnippet.ContainsKey(methodName))
        throw new InvalidOperationException(string.Format("There is already a method called '{0}'", methodName));
      if (methodName.StartsWith(DynamicConditionPrefix))
        throw new InvalidOperationException(string.Format("'{0}' is not a valid method name because the '{1}' prefix is reserved for internal use with conditions", methodName, DynamicConditionPrefix));
      StringBuilder src = new StringBuilder(CodeStart);
      src.AppendFormat(MethodTemplate, methodName, methodSource);
      src.Append(CodeEnd);
      Trace.TraceError("SOURCE\r\n{0}", src);
      Compile(src.ToString()); //if the condition is invalid an exception will occur here
      _methodSnippet[methodName] = methodSource;
      _assembly = null;
    }
    #endregion

    #region use snippets
    public static object InvokeMethod(string methodName, params object[] p)
    {
      DynamicBase _dynamicMethod = null;
      if (_assembly == null)
      {
        Compile();
        _dynamicMethod = _assembly.CreateInstance("Dynamo.Dynamic") as DynamicBase;
      }
      return _dynamicMethod.InvokeMethod(methodName, p);
    }

    public static bool Evaluate(string conditionName, params object[] p)
    {
      DynamicBase _dynamicCondition = null;
      if (_assembly == null)
      {
        Compile();
        _dynamicCondition = _assembly.CreateInstance("Dynamo.Dynamic") as DynamicBase;
      }
      return _dynamicCondition.EvaluateCondition(conditionName, p);
    }

    public static double Transform(string functionName, params object[] p)
    {
      DynamicBase _dynamicCondition = null;
      if (_assembly == null)
      {
        Compile();
        _dynamicCondition = _assembly.CreateInstance("Dynamo.Dynamic") as DynamicBase;
      }
      return _dynamicCondition.Transform(functionName, p);
    }
    #endregion

    #region support routines
    public static string ProduceConditionName(Guid conditionId)
    {
      StringBuilder cn = new StringBuilder();
      foreach (char c in conditionId.ToString().ToCharArray()) if (char.IsLetterOrDigit(c)) cn.Append(c);
      string conditionName = cn.ToString();
      return string.Format("_dm_{0}",cn);
    }
    private static void Compile()
    {
      if (_assembly == null)
      {
        StringBuilder src = new StringBuilder(CodeStart);
        foreach (KeyValuePair<string, string> kvp in _conditionSnippet)
          src.AppendFormat(ConditionTemplate, DynamicConditionPrefix, kvp.Key, kvp.Value);
        foreach (KeyValuePair<string, string> kvp in _methodSnippet)
          src.AppendFormat(MethodTemplate, kvp.Key, kvp.Value);
        src.Append(CodeEnd);
        Trace.TraceError("SOURCE\r\n{0}", src);
        _assembly = Compile(src.ToString());
      }
    }
    private static Assembly Compile(string sourceCode)
    {
      CompilerParameters cp = new CompilerParameters();
      cp.ReferencedAssemblies.AddRange(_references.ToArray());
      cp.ReferencedAssemblies.Add(Assembly.GetExecutingAssembly().ManifestModule.FullyQualifiedName);
      cp.CompilerOptions = "/target:library /optimize";
      cp.GenerateExecutable = false;
      cp.GenerateInMemory = true;
      CompilerResults cr = (new CSharpCodeProvider()).CompileAssemblyFromSource(cp, sourceCode);
      if (cr.Errors.Count > 0) throw new CompilerException(cr.Errors);
      return cr.CompiledAssembly;
    }
    #endregion

    public static bool HasItem(string methodName)
    {
      return _conditionSnippet.ContainsKey(methodName) || _methodSnippet.ContainsKey(methodName);
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-17T11:47:57.483

除了将其编译成程序集然后执行之外，没有其他方法可以执行任意 C# 源代码。Anders Hejlsberg（C# 的架构师）宣布计划将 C# 编译器公开为服务（基本上是一组 CLR 类），因此当这种情况发生时，这可能会有所帮助。

“编译器即服务”基本上意味着您可以将任意一段代码编译为 Expression，或者更好的是，编译为 AST，并且通常可以掌握内部编译器的工作原理。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-17T11:48:37.607

目前，`CSharpCodeProvider`（在您引用的文章中）是 MS .NET 实现中的唯一方法。“编译器即服务”是 .NET vFuture 的功能之一，可提供您所要求的内容。Mono 2.x 已经有了类似的东西，IIRC（[如这里所讨论的](http://mono-project.com/CsharpRepl)）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T11:47:54.860

`dynamic`这与C# 4.0的特性没有太大关系。相反，托管编译器的增强以及将其数据结构暴露给托管代码使其变得如此简单。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T11:54:50.960

字符串中的语言必须是 C# 吗？

我知道如果包含相关的 Jars，Java 可以动态执行 Python 和 Ruby，而且我不明白为什么有人不考虑将这些系统移植到 C# 和 .NET。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T13:20:52.703

您可以在内存中动态创建一个包含 ac# 扩展方法的 XSLT 文档。

实际的转换可能只是将 parms 传递给扩展方法并返回结果。

但是引用的文章可能更容易使用....

使用该代码有什么问题？

# c# - 位图和地理坐标

> ID：760090
> 
> 赞同：1
> 
> 时间：2009-04-17T11:44:23.107
> 
> 标签：c#

我有一组地理坐标。我必须在每个地理坐标上画一个圆圈。我必须得到这些圆圈所在的位图。

位图大小也在地理坐标中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-17T11:49:32.360

听起来您需要阅读[地图投影](http://en.wikipedia.org/wiki/Map_projection)，然后选择一个合适的来寻找实现或自己实现。

# permissions - 设置应用程序事件日志的权限

> ID：760093
> 
> 赞同：2
> 
> 时间：2009-04-17T11:44:55.977
> 
> 标签：permissions, event-log

是否有某种方法可以设置 Windows 事件日志（在本例中为应用程序）的权限，类似于您可以对目录和文件执行的操作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T11:57:21.407

是的。我们为运行我们的网络应用程序的“有限隐私”帐户执行此操作：

要为用户组的所有成员启用应用程序事件日志条目：

```
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog\Application
Edit CustomSD and append this to the end:
(A;;0x7;;;AU) 
```

# asp.net - 带有 asp.net MVC 的 SOA

> ID：760096
> 
> 赞同：0
> 
> 时间：2009-04-17T11:46:29.733
> 
> 标签：asp.net, asp.net-mvc

我知道 asp.net MVC 支持 webservices 调用，

但是我在广泛的范围内询问我已经开发了 MVC 应用程序，并且我想构建一个集成了 asp.net 2005 应用程序和我自己的 MVC 应用程序的 ERP。

那么有可能吗？我只是一个能这样想的婴儿。

当我看到 WCF 网络直播的第一个视频时，我想到了这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T12:40:48.493

是的，您可以 - 可能需要对 asp.net 应用程序进行一些修改以包含 Web 服务层。

我会看 MVC Storefront 系列[http://www.asp.net/learn/mvc-videos/#MVCStorefrontStarterKit](http://www.asp.net/learn/mvc-videos/#MVCStorefrontStarterKit)

有关构建应用程序和存储库+模式的一些技巧

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T12:06:29.823

是的，有可能。我会为您的 ERP 构建服务调用（WCF、REST 等……无论您喜欢什么）。一旦你有了 ASP.NET 应用程序就可以调用它们，你的 MVC 应用程序也可以。

# ajax - Scala提升框架，提交多个值的ajax表单？

> ID：760097
> 
> 赞同：6
> 
> 时间：2009-04-17T11:47:29.607
> 
> 标签：ajax, scala, lift, ajax-forms

我刚刚开始使用lift，我现在正试图将普通表单更改为ajax 表单，但`processEntryAdd`从未调用过该方法。

```
def addUser(xhtml : Group) : NodeSeq = {

    var firstName = ""
    var lastName = ""

    def processEntryAdd() {
        Log.info("processEntryAdd: " + firstName + ", " + lastName)
    }

    SHtml.ajaxForm(
        bind("entry", xhtml,
             "firstName" -> SHtml.text(firstName, 
                 (x) => {
                     Log.info("Setting firstName to " + x); 
                     firstName = x
                 }),
             "lastName" -> SHtml.text(lastName, 
                 (x) => {
                     Log.info("Setting lastName to " + x); 
                     lastName = x
                 }),
             "submit" -> SHtml.submit("Add user", processEntryAdd),
        ))
} 
```

知道如何实现我想要做的事情，或者为什么上面的代码不起作用。按下按钮时会提交两个表单字段的值，并且设置了两个局部变量`firstName`和`lastName`，但不调用与 SHtml.submit 关联的函数。

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-09-09T22:09:09.523

This question is kind of old, but I recently needed to know this myself, and this is the best solution I've seen so far:

```
ajaxForm(
    bind("entry", xhtml,
         "firstName" -> text(firstName, firstName = _),
         "lastName" -> text(lastName, lastName = _),
         "submit" -> submit("Add user", processEntryAdd _),
    ) ++ hidden(processEntryAdd _)
) 
```

By adding the processing to a hidden form element you get to keep the the submit button, without changing any view code.

You can add client side behaviour by having processEntryAdd() return a JsCmd:

```
def processEntryAdd() {
    Log.info("processEntryAdd: " + firstName + ", " + lastName)
    JsRaw("alert('process entry added')")
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T20:33:37.880

In response to this question David Pollak suggested using

"submit" -> SHtml.hidden("Add user", processEntryAdd) ++

on the lift mailing list.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-04T14:41:11.080

这是答案，滚动到底部，（忽略<后面的第一个空格）

[http://www.assembla.com/wiki/show/liftweb/ajaxForm](http://www.assembla.com/wiki/show/liftweb/ajaxForm)

"提交" -> (SHtml.hidden(auth) ++ < input type="submit" value="Login"/>)

# perl - 在 Perl 中我应该使用什么来代替 printf？

> ID：760104
> 
> 赞同：7
> 
> 时间：2009-04-17T11:49:08.103
> 
> 标签：perl, printf, string-formatting

我需要在 Perl 中使用一些字符串替换来简化翻译，即替换很多

```
print "Outputting " . $n . " numbers"; 
```

通过类似的东西

```
printf ("Outputting %d numbers", $n); 
```

但是，我想用更容易为人类解析的东西替换 printf，如下所示：

```
printX ("Outputting {num} numbers", { num => $n }); 
```

或者通常更珀利。

你能推荐一些你喜欢和使用的东西（来自或不是来自 CPAN）吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-17T12:00:56.857

简单地说：

```
 print "Outputting $n numbers"; 
```

这很佩利。如果您不需要任何花哨的格式，那么字符串插值绝对是您的最佳选择。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-17T12:42:21.673

CPAN 上的大多数模板模块可能会做你想做的事。[这是使用模板工具包](http://search.cpan.org/dist/Template-Toolkit/)的示例...

```
use Template;
my $tt = Template->new;

$tt->process( \"Outputting [% num %] numbers\n", { num => 100 } ); 
```

你可以用这样的东西模仿你需要的例子......

```
sub printX {
    use Template;
    my $tt = Template->new( START_TAG => '{', END_TAG => '}' );
    $tt->process( \( $_[0] . "\n" ), $_[1] );
} 
```

你有...

```
printX 'Outputting {num} numbers' => { num => 100 }; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-17T16:17:29.130

内置在大多数情况下`print`都非常方便。除了变量插值：

```
print "Outputting $n numbers";    # These two lines
print "Outputting ${n} numbers";  # are equivalent 
```

请记住，它`print`可以接受多个参数，因此如果您需要打印子例程调用的结果，则无需先将它们连接成单个字符串：

```
print "Output data: ", Dumper($data); 
```

但是，对于输出简单整数以外的数字，您可能需要 printf 的格式化便利。不过，使用 输出其他数据类型很容易`print`。

您可以使用方便`join`地输出数组：

```
print join ', ', @array; 
```

并结合`map`和`keys`输出哈希：

```
print join ', ', map {"$_ : $hash{$_}"} keys %hash; 
```

`qq`如果要在数据周围输出引号，请使用运算符：

```
print join ', ', map {qq("$_" : "$hash{$_}"}) keys %hash; 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-17T16:38:34.163

如果您希望简化翻译，您应该考虑使用可用的 L10n/i18n CPAN 模块之一。[具体来说，作为 Local::Maketext docs 的一部分，对](http://search.cpan.org/perldoc?Locale::Maketext::TPJ13)您的方法最终会失败的原因进行了很好的概述。

与 Locale::Maketext 完美搭配的另一个很棒的模块是[Locale::Maketext::Lexicon](http://search.cpan.org/perldoc?Locale::Maketext::Lexicon)。这允许您使用更标准的本地化格式，例如 gettext 的 .po/.mo 文件，这些文件具有 GUI 工具来帮助翻译人员处理所有需要翻译的文本。Locale::Maketext::Lexicon 还附带了一个帮助脚本 (xgettext.pl)，它有助于使您的本地化文件与您的模板或模块保持最新，这些模板或模块具有需要翻译的文本。过去，我通过这种设置获得了非常好的结果。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-17T11:53:58.187

看来您希望有一种不同的方式来解析字符串。我建议你不要这样做。唯一看到 %d 语法的人是开发人员，他会完全理解其含义。由于填充、小数等选项，printf 语法非常强大。

我认为您想使用更多的替换方法。做 s/{num}/$n/ 是没用的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-17T11:59:09.873

鉴于您对翻译人员的评论，我建议编写一个 perl 脚本，将所有内容剥离`printf()`并以更容易对翻译人员友好的方式将它们制成表格。

像这样的东西：

```
while(<>)
{
    #regex for striping printf

    #print in tabulated form
} 
```

如果您也打印出行号，您可以轻松编写另一个程序来替换翻译后的文本。

这个解决方案不会花费你更多的时间来重新分解`printf()`并且它是可重用的。

* * *

我肯定会坚持`printf()`，它是许多语言的标准。

它几乎已成为字符串输出的标准。就像`i`是 for`for`循环。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-17T17:22:30.657

一般来说，来自 Draegtun 的回答很好，但如果你需要更小的东西（即更少的内存），并且没有那么强大，你可以使用这个函数轻松地做到这一点：

```
sub printX {
    my ( $format, $vars ) = @_;

    my @sorted_keys = sort { length($b) <=> length($a) } keys %{ $vars };
    my $re = join '|', map { "\Q$_\E" } @sorted_keys;

    $format =~ s/ \{ \s* ($re) \s* \} /$vars->{$1}/xg;

    print $format;
} 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-04-17T12:01:25.670

好吧，perl 有[printf](http://perldoc.perl.org/functions/printf.html)函数……等等，你想要[python 的字符串格式化之](http://docs.python.org/library/stdtypes.html#string-formatting)类的东西吗？

```
 >>> print '%(key)s' % {'key': 'value'}
 value 
```

嗯，我不知道 perl 中存在类似的东西......至少不是这个“简单”......也许[Text::Sprintf::Named](http://search.cpan.org/~shlomif/Text-Sprintf-Named-0.0300/lib/Text/Sprintf/Named.pm)可以成为你的朋友

# vxworks - 批处理文件疑问

> ID：760107
> 
> 赞同：0
> 
> 时间：2009-04-17T11:50:09.583
> 
> 标签：vxworks, batch-processing

我有一个如下所示的 .bat 文件，我想在其中将 IDE 中存在的全部内容重定向到某个文本文件。

```
D:\WindRiver\wrenv.exe -p vxworks653-2.2.3 run
D:\WindRiver\wrenv.exe -p vxworks653-2.2.3>C:\ThreePartition\output.txt 
PAUSE 
```

我只能得到一些部分输出，即我无法得到在编译或构建过程中抛出的错误。这是正确的还是任何人都可以建议任何其他方式？

非常感谢麦迪

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T12:26:23.647

You can try this: D:\WindRiver\wrenv.exe -p vxworks653-2.2.3 > C:\ThreePartition\output.txt 2>&1

You can find a good explanation [here](http://programing-fun.blogspot.com/2008/04/redirecting-standard-error-output-in.html). Basically you need to redirect both stdout AND stderr to your file.

Best regards.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T12:19:27.220

I think you want to combine both those lines into one:

```
D:\WindRiver\wrenv.exe -p vxworks653-2.2.3 run >C:\ThreePartition\output.txt 
```

OK, looking at your posts [here](http://www.computing.net/answers/programming/batch-files-redirection/18654.html), [here](http://en.kioskea.net/forum/affich-87872-extraction-of-output-from-an-ide-into-text) and [here](http://groups.google.com/group/ccnet-user/browse_thread/thread/b5742af3ff9eda42), it seems you want to log the compilation process. The command for that will be something like (all on one line):

```
make ThreePartition.mak >C:\ThreePartition\output.txt 
```

Assuming there's a file called ThreePartition.mak.

The command you've been using so far is designed to simply open an interface where you can type commands, which is why you get no output. If you want to log simulation, or a kernel build, there is a file called `vxworks_cli_tools_users_guide_6.6.pdf` which describes the command line interface, including `vxprj` in full detail.

Also, are you really using a nant script to call a .vbs to call a .bat to call wrenv.exe? I'm sure there's a simpler way to do that.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T11:56:20.707

您的批处理正在重定向从 wrenv.exe 发送到标准输出的所有消息。

我从未使用过 WinRiver，但通常 IDE 会在内部管理控制台，并且不会在标准输出/错误流上记录任何消息。

不过，也许可以设置 IDE 控制台的输出。如果是，请尝试将其设置为标准输出。

# shell - 我可以在 KornShell 中获取当前脚本的绝对路径吗？

> ID：760110
> 
> 赞同：22
> 
> 时间：2009-04-17T11:51:07.723
> 
> 标签：shell, unix, scripting, path, ksh

是否可以找出当前在 KornShell (ksh) 中执行的脚本的完整路径？

即，如果我的脚本在`/opt/scripts/myscript.ksh`其中，我可以在该脚本中以编程方式发现`/opt/scripts/myscript.ksh`吗？

谢谢，

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-04T11:16:43.610

你可以使用：

```
## __SCRIPTNAME - name of the script without the path
##
typeset -r __SCRIPTNAME="${0##*/}"

## __SCRIPTDIR - path of the script (as entered by the user!)
##
__SCRIPTDIR="${0%/*}"

## __REAL_SCRIPTDIR - path of the script (real path, maybe a link)
##
__REAL_SCRIPTDIR=$( cd -P -- "$(dirname -- "$(command -v -- "$0")")" && pwd -P ) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-07-31T17:40:51.067

在 korn shell 中，如果您在有问题的脚本中进行采购，所有这些 $0 解决方案都会失败。得到你想要的东西的正确方法是使用 $_

```
$ cat bar

echo dollar under is $_
echo dollar zero is $0

$ ./bar

dollar under is ./bar
dollar zero is ./bar

$ . ./bar
dollar under is bar
dollar zero is -ksh 
```

注意到最后一行了吗？使用 $_。至少在科恩。bash、csh 等中的 YMMV

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-02-07T00:06:17.913

好吧，我花了一段时间，但这一个是如此简单，以至于尖叫。

```
_SCRIPTDIR=$(cd $(dirname $0);echo $PWD) 
```

由于 CD 在生成的 shell 中使用 $() 运行，因此不会影响当前脚本。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-17T11:55:41.457

脚本的调用方式存储在变量 $0 中。您可以使用`readlink`获取绝对文件名：

```
readlink -f "$0" 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-08-25T15:53:57.987

变量 $RPATH 包含真实文件的相对路径或真实文件的真实路径。

```
CURPATH=$( cd -P -- "$(dirname -- "$(command -v -- "$0")")" && pwd -P )

CURLOC=$CURPATH/`basename $0`

if [ `ls -dl $CURLOC |grep -c "^l" 2>/dev/null` -ne 0 ];then

    ROFFSET=`ls -ld $CURLOC|cut -d ">" -f2 2>/dev/null`

    RPATH=`ls -ld $CURLOC/$ROFFSET 2>/dev/null`

else

    RPATH=$CURLOC

fi

echo $RPATH 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-03-03T18:48:52.377

`readlink -f`如果它是可移植的，那将是最好的，因为它可以解析为目录和文件找到的每个链接。

在 mac os x 上没有`readlink -f`（可能通过 macports 除外），因此您只能用于`readlink`获取特定符号链接文件的目标。

该`$(cd -P ... pwd -P)`技术很好，但仅适用于解析指向脚本的目录的链接，如果脚本本身是符号链接，则它不起作用

此外，还有一个没有提到的情况：当您通过将脚本作为参数传递给 shell ( `/bin/sh /path/to/myscript.sh`) 来启动脚本时，`$0`在这种情况下不可用

我查看了 mysql “二进制文件”，其中许多实际上是 shell 脚本；现在我明白了为什么他们要求`--basedir`选择或需要从特定的工作目录启动；这是因为没有很好的解决方案来定位目标脚本

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-06-11T13:51:26.793

这就是我所做的：

```
if [[ $0 != "/"* ]]; then
  DIR=`pwd`/`dirname $0`
else
  DIR=`dirname $0`
fi 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-15T19:42:33.853

这也有效，尽管如果它是链接，它不会给出“真实”路径。它更简单，但不太精确。

```
SCRIPT_PATH="$(whence ${0})" 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-12-07T11:22:03.950

试试哪个命令。

```
which scriptname 
```

将为您提供脚本的完整限定名及其绝对路径

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-01-04T14:58:21.567

我升级了 Edward Staudt 的答案，以便能够处理绝对路径符号链接以及链接链。

```
DZERO=$0
while true; do
  echo "Trying to find real dir for script $DZERO"
  CPATH=$( cd -P -- "$(dirname -- "$(command -v -- "$DZERO")")" && pwd -P )
  CFILE=$CPATH/`basename $DZERO`
  if [ `ls -dl $CFILE | grep -c "^l" 2>/dev/null` -eq 0 ];then
    break
  fi
  LNKTO=`ls -ld $CFILE | cut -d ">" -f2 | tr -d " " 2>/dev/null`
  DZERO=`cd $CPATH ; command -v $LNKTO`
done 
```

丑陋，但有效...运行后，路径为 $CPATH ，文件为 $CFILE

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2010-05-04T00:15:32.427

尝试使用这个：

```
dir = $(dirname $0) 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2017-09-07T14:35:48.073

使用 $_ 提供最后一个命令。

```
>source my_script 
```

如果我两次发出命令，则有效：

```
>source my_script
>source my_script 
```

如果我使用不同的命令序列：

```
>who
>source my_script 
```

$_ 变量返回“谁”

# ruby - 引号变成问号

> ID：760113
> 
> 赞同：0
> 
> 时间：2009-04-17T11:51:44.540
> 
> 标签：ruby, parsing, encoding, utf-8

所以我有一个**ruby**​​ 脚本来解析 HTML 页面并将提取的字符串保存到数据库中......但我得到的是奇怪的字符（通常是问号）而不是纯文本......

例如：“Some TEXT”而不是“Some Text”

我已经尝试过 HTML 实体和 CGI​​::unescape ......但无济于事......做了一些谷歌搜索 n set $KCODE = 'u' & require 'jcode' 仍然无法正常工作......

任何建议/指针都会很棒

谢谢

PS：使用mysql 5.1

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-17T12:10:55.930

Your script is storing the Unicode escape sequences for quotation marks (instead of ASCII quotation marks) in the database.

That's actually good - it shows that the DB itself is working fine, although for best results you should ensure that the table is set to use 'utf8_collation_ci' so that string sorting works properly.

The fact that the output is *displayed* as "â€˜" just means that your terminal (and/or web page) *output* encoding is incorrect.

If it's terminal output, make sure that `$ENV{'LANG'}` is set to the appropriate UTF8 encoding (e.g. `en.UTF-8`) and that the terminal emulator itself is set the same way.

If it's HTML output, make sure that the page encoding is set to `UTF-8` as well, i.e.:

```
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T11:55:28.727

您存储数据的数据库是否能够处理 Unicode？这些症状似乎暗示它不是。有关 MySQL 下的 Unicode 支持，请参阅[此链接](http://dev.mysql.com/doc/refman/5.0/en/charset-unicode.html)。

有问题的引号似乎不是标准的 ASCII 引号，而是[Unicode](http://www.cl.cam.ac.uk/~mgk25/ucs/quotes.html)引号。

Ruby 有一个`iconv`实现在编码类型之间进行转换。请参阅[此处](http://www.ruby-doc.org/stdlib/libdoc/iconv/rdoc/index.html)了解更多信息。

# c++ - 您将使用什么来实现快速、轻量级的文件服务器？

> ID：760114
> 
> 赞同：1
> 
> 时间：2009-04-17T11:52:31.013
> 
> 标签：c++, sockets, fileserver

我需要有一个文件服务器作为桌面应用程序的一部分，它应该尽可能快地响应文件传输请求（来自远程客户端，通常位于同一个 LAN 上）。小文件会有很多文件请求。服务器应该能够提供上传和下载服务。

我不拘泥于任何特定的技术，所以我对任何编程语言、工具包、库都持开放态度，只要它们可以在 Windows 上运行。

我最初的想法是使用 Windows 套接字实现 C/C++ 或使用 Boost（asio 等）等库提供的服务。我也想到了 Erlang，但我必须学习，因此性能优势应该证明由于必须学习该语言而增加的开发时间是合理的。

后期编辑：我很欣赏那些说使用 FTP 或 HTTP 或基本上已经创建的任何东西的答案，但考虑到你仍然想从头开始编写一个，你会怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T11:54:55.173

为什么不直接使用[FTP](http://en.wikipedia.org/wiki/File_Transfer_Protocol)呢？您应该能够找到任何语言的适当服务器实现，以及客户端访问库。

这听起来像是很多轮子改造。诚然，FTP 并不理想，并且有一些奇怪的地方，但是……它就在那里，它是标准的、众所周知的，并且已经非常广泛地实施。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-17T14:28:36.037

对于小文件的频繁上传，最快的方法是实现自己的专有协议，但这需要大量的工作——而且它也是非标准的，这意味着未来的集成将很困难，除非你能够实现您将支持的任何客户端中的协议。如果您仍然选择这样做，这是我对简单协议的建议：

1.  命令：1 个字节来标识将要做什么：（0x01 表示上传请求，0x02 表示下载请求，0x11 表示上传响应，0x12 表示下载响应等）。
2.  文件名：可以是固定大小或以字节为前缀长度（假设名称小于255字节）
3.  校验和，例如 MD5（如果上传请求或下载响应）
4.  文件大小（如果上传请求或下载响应）
5.  有效载荷（如果上传请求或下载响应）

这可以在一个简单的 TCP 套接字之上实现。您也可以使用 UDP，避免建立连接的成本，但在这种情况下，您必须处理重传控制。

在决定实现你自己的协议之前，先看看像 libcurl 这样的 HTTP 库，你可以让你的服务器使用标准的 HTTP 命令，比如 GET 来下载和 POST 来上传。这将节省大量工作，您将能够使用任何 Web 浏览器测试下载。

另一个提高性能的建议是使用文件存储库而不是文件系统，而是使用 SQLite 之类的东西。您可以创建一个表，其中包含一个用于文件名的 char 列和一个用于文件内容的 blob 列。由于 SQLite 是轻量级的并且可以进行有效的缓存，因此您大部分时间都可以避免磁盘访问开销。

我假设您不需要客户端身份验证。

最后：尽管 C++ 是您的首选，可以为您提供原始本机代码速度，但这很少是此类应用程序的主要瓶颈。很可能是磁盘访问和网络带宽。我之所以提到这一点，是因为在 Java 中，您可能能够用不到 100 行代码制作一个 servlet 来做完全相同的事情（使用 HTTP GET 进行下载和 POST 进行上传）。在这种情况下使用 Derby 而不是 SQLite，将该 servlet 放入任何容器（Tomcat、Glassfish 等）中，然后就完成了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T11:56:56.243

如果所有机器都在同一个 LAN 上的 Windows 上运行，那为什么还需要一台服务器呢？为什么不简单地使用 Windows 文件共享？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-17T12:01:19.027

我建议不要使用 FTP、SFTP 或任何其他面向连接的技术。相反，请选择无连接协议或技术。

原因是，如果您需要上传或下载大量小文件，并且响应应该尽可能快，您希望避免建立和破坏连接的成本。

我建议您查看使用现有实现或实现自己的 HTTP 或 HTTPS 服务器/服务。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-17T13:40:25.560

您的瓶颈可能来自以下来源之一：

*   硬盘 I/O - WD velociraptor 应该具有大约 100MB/s 的随机访问速度。此外，重要的是您是否将其设置为 RAID0、1、5 或其他。有些人读得快，写得慢。权衡取舍。

*   网络 I/O - 假设您在快速 RAID 设置中拥有最快的硬盘，除非您使用 Gbit I/O，否则您的网络将会很慢。如果您的管道很大，您仍然需要为其提供数据。

*   内存缓存 - 内存中文件系统缓存需要足够大以缓冲所有网络 I/O，这样它就不会减慢您的速度。对于您正在查看的工作，这将需要大量内存。

*   文件系统结构——假设你有千兆字节的内存，那么瓶颈很可能是你用于文件系统的数据结构。如果文件系统结构很麻烦，它会减慢你的速度。

假设所有其他问题都已解决，那么您是否担心您的应用程序本身。请注意，大多数瓶颈都超出了您的软件控制范围。因此，无论您是使用 C/C++ 编写代码还是使用特定的库，您仍然会受制于操作系统和硬件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-17T11:56:25.713

听起来您应该使用[SFTP (SSH) 服务器](http://en.wikipedia.org/wiki/SSH_file_transfer_protocol#SFTP_server)，它是防火墙/NAT 安全、可靠的，并且已经可以满足您的需求等等。您还可以使用 SAMBA 或 windows 文件共享来实现更简单的实现。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-17T12:00:24.193

为什么不使用现有的东西，例如普通的 Web 服务器可以非常快速地处理大量小文件（图像）。

许多人已经花时间优化代码。

第二个好处是传输是通过已建立的协议 HTTP 完成的。如果您需要更高的安全性，可以轻松切换到 SSL。

对于上传，脚本或自定义模块也没有问题 - 使用相同的方法您也可以添加授权。

只要您不需要动态查找文件，我想这将是最好的解决方案之一。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-17T12:10:41.983

它是现有桌面应用程序的新部分吗？服务器的目标是什么？它是否保护上传/下载的文件并提供身份验证和/或授权？它是否为要存储的上传内容提供某种结构？

一种选择可能是在机器上安装 Apache HTTP Server 并通过它提供文件。使用 POST 上传，使用 GET 下载。

如果客户端在 LAN 内，您是否可以不共享驱动器？

# c# - 使用 C#/ASP.Net 查找有关浏览器版本的更多信息

> ID：760117
> 
> 赞同：1
> 
> 时间：2009-04-17T11:54:35.580
> 
> 标签：c#, asp.net, internet-explorer, browser

首先，我的问题的一些背景。

Internet Explorer 6 和 7 的许多版本不支持 cookie 中超过 20 个键值对。我有一个完整版本的列表，它们支持和不支持这个。这已在 Windows 更新中修复，但我无法强制我的应用程序的用户执行 Windows 更新以使用我的应用程序。

我们为不支持此功能的 Internet Explorer 版本开发了一个不同的 cookie jar，但是其性能不是最佳的，因此我们只需要在需要它的 IE 版本上使用它。

IE 浏览器的完整版本号格式为 6.00.2900.2180。我发现的任何地方都建议使用 Request.Browser 来查找浏览器信息，但这对于我的需求来说太有限了。为了澄清这一点，MajorVersion 返回 6，MinorVersion 返回 0，给我 6.0（6.0 几乎是所有 Internet Explorer 6 版本的版本）。所以我需要的是完整版的第三和第四部分（或者至少是第三部分）。

那么，有没有人知道在 ASP.Net 中使用 C# 找到我需要的信息的方法？如果有人对此进行了广泛的研究并发现这是不可能的，那作为答案很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-18T00:34:55.110

您可能需要重新审视为什么要存储这么多不同的键值对。走向低技术，你不能将值连接成更少甚至一个键吗？您在 cookie 中存储什么样的值？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T11:59:18.453

尝试使用 Request.Headers 获取“User-Agent”请求标头

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T16:34:36.327

从 meandmycode 复制它以接受它作为答案。

> IE 没有在用户代理标头中指定长版本号，因此除了使用 javascript 发送“窥探”页面以检测复杂版本号之外，您绝对没有机会检测到这一点。但做类似的事情是躲避城市, 并且 javascript 也可能无法找到完整版本。

# c# - SourceSafe CRC 计算

> ID：760124
> 
> 赞同：1
> 
> 时间：2009-04-17T11:55:55.187
> 
> 标签：c#, version-control, visual-sourcesafe

有谁知道 Microsoft SourceSafe 中使用了什么 CRC 校验和计算？我想在本地计算校验和并将其与 SourceSafe 校验和进行比较。

我正在使用在 Internet 上找到的 CRC 算法，但 SourceSafe 的算法的种子或多项式似乎不同。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-17T12:07:22.567

看到这个帖子：

[http://www.tesoga.com/vssnotes.html](http://www.tesoga.com/vssnotes.html)

您可能正在寻找的简介是：

> 而 16 位 CRC 主要是标准算法。一个区别是，根据我的经验，CRC 通常从将状态初始化为 -1 (0xFFFFFFFF) 开始，累积，然后返回结果的逻辑非。但是，VSS CRC 逻辑将状态初始化为 0，并且在末尾不应用逻辑非。在验证文件中的任何 CRC 时，请确保使用此技术。（有关工作实现，请参阅 CRC32.c 中的 VssCrc32()。）

他提到的代码包含在这个 zip 文件中：

[http://www.teachsolaisgames.com/downloads/vsscode.zip](http://www.teachsolaisgames.com/downloads/vsscode.zip)

# php - 检查内容是否已经在 PHP 中发送

> ID：760133
> 
> 赞同：5
> 
> 时间：2009-04-17T11:59:44.990
> 
> 标签：php, http-headers

是否有一种聪明的方法来检查输出是否已经发送到浏览器并发送标头会生成 PHP_WARNING？

显然，可以选择使用输出缓冲区，但这并不总是一种选择。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-17T12:02:55.573

您可以使用 headers_sent() 方法。这是因为在输出任何内容之前，将首先发送标头。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-08-17T12:00:07.840

[headers_sent()](https://www.php.net/manual/en/function.headers-sent.php)做得很差，并且在输出已发送的情况下并不总是返回 TRUE（例如通知和警告）。

作为替代方案，我使用这个：

```
<?php

$obStatus = ob_get_status();

if ($obStatus['buffer_used'] > 0) {
    echo 'Content was sent';
} else {
    echo 'Content was NOT sent';
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-17T12:02:43.670

如果您只想隐藏警告，只需关闭[错误报告](http://www.php.net/error_reporting)：

```
$old_er = error_reporting(0);

header(...)

error_reporting($old_er); 
```

或者，您可以将 PHP 错误和警告重定向到日志文件（这在生产中更可取，IMO）。

# programming-languages - 什么是最好的屏幕抓取语言？

> ID：760142
> 
> 赞同：12
> 
> 时间：2009-04-17T12:02:05.717
> 
> 标签：programming-languages, screen-scraping, web-scraping

嗨，我想创建一个桌面应用程序 (c# prob) 来抓取或操作 3rd 方网页上的表单。基本上我在桌面应用程序的表单中输入我的数据，它会转到第 3 方网站，然后使用脚本或后台的任何内容，在那里输入我的数据（包括我的登录名）并为我单击提交按钮。我只是想避免加载浏览器！

在这方面没有做太多（任何！）工作我想知道像 perl、python、ruby 等脚本语言是否允许我这样做？或者干脆使用 c# 和 .net 完成所有的抓取？哪一个是最好的IYO？

我在想脚本可能需要从不同平台上的应用程序中挂钩到相同的脚本（例如 symbian 移动设备，我无法像桌面版本那样在 c# 中开发它）。

它不是网络应用程序，否则我不妨使用原始网站。我意识到这一切听起来毫无意义，但这种特定形式的自动化对我来说将是一个真正的节省时间。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-17T12:16:48.943

Do not forget to look at [BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/), comes highly recommended.

See, for example, [options-for-html-scraping](https://stackoverflow.com/questions/2861/options-for-html-scraping). If you need to select a programming language for this task, I'd say `Python`.

A more direct solution to your question, see [twill](http://twill.idyll.org/), a simple scripting language for Web browsing.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-17T13:16:37.410

我使用 C# 进行抓取。请参阅有用的[HtmlAgilityPack](http://www.codeplex.com/htmlagilitypack)包。对于解析页面，我使用 XPATH 或正则表达式。如果需要，.NET 也可以轻松处理 cookie。

我编写了一个小类，它包含了创建 WebRequest、发送它、等待响应、保存 cookie、处理网络错误和重新传输等所有细节 - 最终结果是，对于大多数情况，我可以调用"GetRequest\PostRequest" 并返回一个 HtmlDocument。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-17T12:10:10.377

C# is more than suitable for your screen scraping needs. .NET's Regex functionality is really nice. However, with such a simple task, you'll be hard to find a language that doesn't do what you want relatively easily. Considering you're already programming in C#, I'd say stick with that.

The built in screen scraping functionality is also top notch.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-17T13:30:15.333

您可以尝试使用 .NET HTML Agility Pack：

[http://www.codeplex.com/htmlagilitypack](http://www.codeplex.com/htmlagilitypack)

> “这是一个敏捷的 HTML 解析器，它构建了一个读/写 DOM 并支持普通的 XPATH 或 XSLT（你实际上不必了解 XPATH 或 XSLT 就可以使用它，不用担心......）。它是一个 .NET允许您解析“网络外”HTML 文件的代码库。解析器非常容忍“现实世界”格式错误的 HTML。对象模型与 System.Xml 的提议非常相似，但适用于 HTML 文档（或流） 。”

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-01-21T09:21:50.840

我们将 Groovy 与 NekoHTML 结合使用。（另请注意，您现在可以在 Google App Engine 上运行 Groovy。）

以下是 Keplar 博客上的一些可运行代码示例：

[通过使用 Groovy 抓取来获得更好的竞争情报](http://www.keplarllp.com/blog/2010/01/better-competitive-intelligence-through-scraping-with-groovy)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-17T12:06:22.493

IMO Perl 内置的正则表达式功能和处理文本的能力将使其成为屏幕抓取的一个很好的竞争者。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-17T13:38:27.000

Ruby 非常棒！...试试它的 hpricot/mechanize

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-18T17:13:04.573

Groovy 非常好。

示例： http: [//froth-and-java.blogspot.com/2007/06/html-screen-scraping-with-groovy.html](http://froth-and-java.blogspot.com/2007/06/html-screen-scraping-with-groovy.html)

Groovy 和 HtmlUnit 也是一个很好的匹配： [http](http://groovy.codehaus.org/Testing+Web+Applications) : //groovy.codehaus.org/Testing+Web+Applications Htmlunit 将模拟一个支持 Javascript 的完整浏览器。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-17T12:09:17.417

PHP is a good contender due to its good [Perl-Compatible Regex support](http://is.php.net/manual/en/book.pcre.php) and [cURL library.](http://is.php.net/manual/en/book.curl.php)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-24T16:36:21.400

[HTML 敏捷包 (c#)](http://www.codeplex.com/htmlagilitypack)

1.  XPath 很糟糕，清理 html 以使其符合 xml 的方式将丢弃标签，您必须调整表达式才能使其正常工作。
2.  使用简单

[Mozilla 解析器 (Java)](http://mozillaparser.sourceforge.net/)

1.  可靠的 XPath 支持

2.  您必须先设置环境变量才能工作，这很痛苦

3.  在 org.dom4j.Node 和 org.w3c.dom.Node 之间进行转换以获得不同的属性是一个真正的痛苦

4.  在非标准 html 上死掉**（0.3 修复了这个）**

5.  XPath 的最佳解决方案

6.  访问 NodeList 中节点上的数据的问题

    使用 for(int i=1;i<=list_size;i++) 来解决这个问题

[美丽的汤（Python）](http://www.crummy.com/software/BeautifulSoup/)

我没有太多经验，但这是我发现的

1.  不支持 XPath
2.  路径 html 的漂亮界面

* * *

我更喜欢 Mozilla HTML 解析器

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-12-03T18:23:01.053

看看 HP 的 Web 语言（以前称为 WEBL）。

[http://en.wikipedia.org/wiki/Web_Language](http://en.wikipedia.org/wiki/Web_Language)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-17T13:34:39.940

或者坚持使用 C# 中的 WebClient 和一些字符串操作。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-29T07:30:12.840

我支持python（或Beautiful Soup）的推荐。我目前正在使用 python 进行一个小型屏幕抓取项目，python 3 自动处理诸如 cookie 身份验证（通过 CookieJar 和 urllib）之类的事情大大简化了事情。Python 支持您可能需要的所有更高级的功能（如正则表达式），并且具有能够快速处理此类项目的好处（在处理低级内容时不会产生太多开销）。它也是相对跨平台的。

# email - 电子邮件地址可以包含国际（非英语）字符吗？

> ID：760150
> 
> 赞同：98
> 
> 时间：2009-04-17T12:03:47.133
> 
> 标签：email, internationalization, non-english

如果可能的话，我应该接受来自用户的此类电子邮件吗？当我将邮件发送到此类地址时会出现什么问题？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-04-17T12:04:46.663

正式地，根据[RFC 6532](https://www.rfc-editor.org/rfc/rfc6532) - **Yes**。

如需快速解释，请查看有关该主题的[维基百科。](http://en.wikipedia.org/wiki/E-mail_address#Internationalization)

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2015-06-26T07:05:57.153

2015 年更新：使用[RFC 6532](https://www.rfc-editor.org/rfc/rfc6532)

实验性的[5335](https://www.rfc-editor.org/rfc/rfc5335)已被[6532](https://www.rfc-editor.org/rfc/rfc6532)淘汰，
后来被设置为“类别：标准轨道”，
使其*成为*标准。

第[3.2 节（](https://www.rfc-editor.org/rfc/rfc6532#section-3.2) [RFC 5322](https://www.rfc-editor.org/rfc/rfc5322)的语法扩展）更新了大多数文本字段以
包含（正确的）UTF-8。

```
The following rules extend the ABNF syntax defined in [RFC5322] and
[RFC5234] in order to allow UTF-8 content.

VCHAR   =/  UTF8-non-ascii
ctext   =/  UTF8-non-ascii
atext   =/  UTF8-non-ascii
qtext   =/  UTF8-non-ascii
text    =/  UTF8-non-ascii
             ; note that this upgrades the body to UTF-8
dtext   =/  UTF8-non-ascii

The preceding changes mean that the following constructs now
allow UTF-8:
   1\.  Unstructured text, used in header fields like
       "Subject:" or "Content-description:".
   2\.  Any construct that uses atoms, including but not limited
       to the local parts of addresses and Message-IDs. This
       includes addresses in the "for" clauses of "Received:"
       header fields.
   3\.  Quoted strings.
   4\.  Domains.

Note that header field names are not on this list; these are still
restricted to ASCII. 
```

请注意**明确**包含域。
并且明确排除标头*名称*。

另请注意[NFKC](https://en.wikipedia.org/wiki/Unicode_equivalence#Combining_and_precomposed_characters "组合字符")：

```
The UTF-8 NFKC normalization form SHOULD NOT be used because
it may lose information that is needed to correctly spell
some names in some unusual circumstances. 
```

[第 3 节](https://www.rfc-editor.org/rfc/rfc6532#section-3)开始：

```
Also note that messages in this format require the use of the
SMTPUTF8 extension [RFC6531] to be transferred via SMTP. 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-17T13:00:48.010

问题是某些邮件客户端（服务器工具和/或桌面工具）不支持它，并在您尝试将邮件发送到包含变音符号的地址时抛出“无效电子邮件”异常。

如果您想要完全支持，您可以将电子邮件地址部分转换为“punycode”。这允许用户以通常的方式输入他们的地址，但您将其保存为受支持级别的方式。

示例：müller.com » xn--mller-kva.com

两者都指向同一件事。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-17T12:17:44.103

I would assume yes since a number of top level domains already allow non ascii characters for domains and since the domain is part of an email address, it's perfectly possible. An example for such a domain would be www.öko.de

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-17T12:31:24.897

short answer: yes

not only in the username but also in the domain name are allowed.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-17T13:03:42.510

答案是肯定的，但需要对它们进行特殊编码。

[看看这个](http://en.wikipedia.org/wiki/Unicode_and_e-mail)。阅读有关电子邮件标头和 RFC 2047 的部分。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-17T12:06:31.603

还没有。IEEE 计划这样做： [H-Online 文章：IEFT 计划国际化电子邮件地址](https://web.archive.org/web/20090302031911/http://www.h-online.com/news/IEFT-planning-internationalised-email-addresses--/111542)，这里是[RfC：国际化电子邮件地址的 SMTP 扩展](http://www.ietf.org/rfc/rfc5336.txt)

来自 H-Online 的引述（当它下降时）：

> Internet 工程任务组 (IETF) 发布了三个重要文件，用于标准化包含 ASCII 字符集之外的符号的电子邮件地址标头。这意味着您很快就可以在电子邮件地址以及邮件正文中使用中文字符、法语口音和德语变音符号。因此，如果您的名字是 Zoë，并且您在一家制造外墙的公司工作，您可能会对新的电子邮件地址感兴趣。但供应商的代表已经在抱怨了。他们说，如果 Unicode 标准 UTF-8 要取代目前用作通用电子邮件语言的美国信息交换标准代码 (ASCII)，就需要出现“升级狂热”。
> 
> RFC 5335 指定在几乎所有电子邮件标头中使用 UTF-8。必须对 SMTP 客户端、SMTP 服务器、邮件用户代理 (MUA)、邮件列表软件、其他媒体的网关以及处理或传递电子邮件的任何其他地方进行更改。RFC 5336 扩展了 SMTP 电子邮件传输协议。在协议级别，扩展标记为 UTF8SMTP。
> 
> 将添加一个新的标头字段作为一种“紧急降落伞”，以确保 UTF-8 电子邮件在到达收件人之前被未升级的系统丢弃时可以软着陆。“OldAddress”是一个纯 ASCII 地址。但 OldAddress 不能用作第二次传输尝试的渠道，而是确保将反馈发送回家。
> 
> 最后，RFC5337 确保发送与非 ASCII 电子邮件的传递状态相关的正确消息。即使进一步的传输被拒绝，也必须将无法到达的收件人的正确地址发回。电子邮件地址国际化 (EAI) 工作组还在为各种标头字段和信封制定许多“降级机制”。如果可能，原始头信息将被“打包”并保存。
> 
> 尽管如此，“.de”域名的注册商德国的 DeNIC 仍然从容应对。“我们真的无能为力”，DeNIC 发言人 Klaus Herzig 解释道。相反，DeNIC 更加关注 IETF 正在为国际域标准（有时称为 RFC3490 或 IDNA2003）而进行的更新。“我们对此并不满意，因为没有向后兼容性，”Herzig 解释说。当更新到来时，DeNIC 表示它将把重心放在符号“ß”（也称为 estzett）后面，该符号迄今为止一直被忽视。这家德国注册商还表示，鉴于缺乏向后兼容性，它可能会在切换之前稍等片刻。
> 
> 相比之下，专家认为中国大陆和台湾的中国注册商将迅速实施国际化电子邮件的变化。CNIC 和 TWNIC 的代表是标准的作者。对于已经国际化的中文域名，中国用户目前必须在@左边用ASCII写电子邮件，在@右边用汉字写电子邮件。
> 
> （莫妮卡·厄默特）

# eclipse - 是时候在 Eclipse 中开发一个选项来修改 Java 文件源了

> ID：760155
> 
> 赞同：5
> 
> 时间：2009-04-17T12:05:53.943
> 
> 标签：eclipse, eclipse-plugin, code-generation

我正在评估开发一个 Eclipse 插件来修改一些 Java 文件的源代码的可能性。

Eclipse 插件应该：

1.  添加一个菜单选项或上下文菜单选项以启动修改过程。
2.  添加键绑定
3.  仅当在 Java 文件上打开编辑器时才以这种方式更改 UI。
4.  修改过程不会打开一个对话框，或者可能是一个非常简单的对话框。
5.  修改过程将遍历 Java 文件的 AST 并对其进行修改。

考虑到我们没有使用 Eclipse 插件的经验，而且我们需要花时间阅读文档，您估计开发该插件需要多少时间？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-17T13:53:33.780

真的一点都不难……我的设计模式课上有学生在做作业（添加/删除javabean getter和setter）

见[http://help.eclipse.org/ganymede/topic/org.eclipse.jdt.doc.isv/guide/jdt_api_manip.htm](http://help.eclipse.org/ganymede/topic/org.eclipse.jdt.doc.isv/guide/jdt_api_manip.htm)

[**编辑**：*添加了以下文章参考*]

[在http://www.eclipse.org/articles/article.php?file=Article-JavaCodeManipulation_AST/index.html](http://www.eclipse.org/articles/article.php?file=Article-JavaCodeManipulation_AST/index.html)上有一篇很棒的文章（从 2006 年开始，可能会有一些 API 更改）

是的，编写插件需要一点时间来适应，但任何 API 也是如此。

您可以修改 AST——参见我上面引用的页面。

（我应该注意，上面的链接来自 Eclipse 帮助，也可以通过 Eclipse 中的 Help->Help Contents 访问——那里有很多很好的信息，但这只是一个起点）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T12:23:01.377

您可能会花费相当长的时间来诅咒 eclipse 插件系统的复杂性。有一些示例插件开发项目，如果它们涵盖您正在工作的领域，它们会非常有用。

我会说你正在看 2-4 天的工作，主要用于熟悉平台 - 具有丰富编写 eclipse 插件经验的人可能需要不超过一个小时。

但是，您的第 5 步可能很棘手。我不知道访问和更改 Java AST 有多么容易；我的经验是基于为异国情调的文件格式而不是 Java 代码开发编辑器插件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T12:37:25.523

嗯，前四点很容易实现，即使是查看 Eclipse 附带的 eclipse PDE 文档的猴子程序员也是如此。这些可以在 1 天的工作中实现，也许 2 天。

最难的点实际上是第五个，也是你期望做的那种修改。直接作用于编辑器内容很简单，访问编辑器内部 AST 并修改它确实是一个更大的挑战，我怀疑没有经验的人可以在不到一周的时间内实现（可能需要更长的时间，取决于什么样的修改你想申请）。

# c# - .NET 中的应用程序域是什么，它的需求是什么？

> ID：760156
> 
> 赞同：0
> 
> 时间：2009-04-17T12:06:09.670
> 
> 标签：c#, .net

### 复制：

> [什么是应用域](https://stackoverflow.com/questions/574708/what-is-appdomain)

* * *

.NET 中的应用程序域是什么，它的需求是什么？

* * *

### 也可以看看：

> [C#中AppDomain的使用](https://stackoverflow.com/questions/665668/usage-of-appdomain-in-c/666122)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T12:11:06.193

这里有一个非常好的简短解释：http: [//codebetter.com/blogs/raymond.lewallen/archive/2005/04/03/61190.aspx](http://codebetter.com/blogs/raymond.lewallen/archive/2005/04/03/61190.aspx) 希望它有所帮助；）

# c# - How to convert an MD5 hash to a string and use it as a file name

> ID：760166
> 
> 赞同：5
> 
> 时间：2009-04-17T12:09:26.150
> 
> 标签：c#, md5

I am taking the MD5 hash of an image file and I want to use the hash as a filename.

How do I convert the hash to a string that is valid filename?

EDIT: `toString()` just gives "System.Byte[]"

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-17T12:39:22.757

这个怎么样：

```
string filename = BitConverter.ToString(yourMD5ByteArray); 
```

如果您更喜欢没有连字符的较​​短文件名，那么您可以使用：

```
string filename =
    BitConverter.ToString(yourMD5ByteArray).Replace("-", string.Empty); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-17T12:11:44.290

[System.Convert.ToBase64String](http://msdn.microsoft.com/en-us/library/system.convert.tobase64string(loband).aspx)

As a commenter pointed out -- normal base 64 encoding can contain a '/' character, which obivously will be a problem with filenames. However, there are other characters that are usable, such as an underscore - just replace all the '/' with an underscore.

```
string filename = Convert.ToBase64String(md5HashBytes).Replace("/","_"); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-03T16:24:35.467

Try this:

```
Guid guid = new Guid(md5HashBytes);
string hashString = guid.ToString("N"); 
// format: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

string hashString = guid.ToString("D"); 
// format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx

string hashString = guid.ToString("B"); 
// format: {xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}

string hashString = guid.ToString("P"); 
// format: (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-21T18:46:09.743

尝试这个：

```
string Hash = Convert.ToBase64String(MD5.Create().ComputeHash(Encoding.UTF8.GetBytes("sample")));
//input "sample" returns = Xo/5v1W6NQgZnSLphBKb5g== 
```

或者

```
string Hash = BitConverter.ToString(MD5.Create().ComputeHash(Encoding.UTF8.GetBytes("sample")));
//input "sample" returns = 5E-8F-F9-BF-55-BA-35-08-19-9D-22-E9-84-12-9B-E6 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-12-02T03:37:30.953

这可能是最安全的文件名。你总是得到一个十六进制字符串，而不必担心 / 或 + 等。

```
 byte[] data = md5Hash.ComputeHash(Encoding.UTF8.GetBytes(inputString));
        StringBuilder sBuilder = new StringBuilder();
        for (int i = 0; i < data.Length; i++)
        {
            sBuilder.Append(data[i].ToString("x2"));
        }
        string hashed = sBuilder.ToString(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-17T13:09:07.537

如果这是 Windows，从技术上讲，使用 Base64 是不好的，文件名不区分大小写（至少在资源管理器视图中）.. 但在 base64 中，“a”与“A”不同，这意味着这可能不太可能，但你最终会得到更高的速率碰撞..

更好的选择是像 bitconverter 类这样的十六进制，或者如果您可以使用 base32 编码（在从 base64 和 base32 中删除填充后，在 128 位的情况下，将为您提供相似长度的文件名）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-07-26T23:31:42.333

尝试 MD5 的 Base32 哈希。它提供文件名安全的不区分大小写的字符串。

```
 string Base32Hash(string input)
    {
        byte[] buf = MD5.Create().ComputeHash(Encoding.UTF8.GetBytes(input));
        return String.Join("", buf.Select(b => "abcdefghijklmonpqrstuvwxyz234567"[b & 0x1F]));
    } 
```

# c# - 什么时候应该使用每个线程同步对象？

> ID：760168
> 
> 赞同：3
> 
> 时间：2009-04-17T12:10:00.113
> 
> 标签：c#, multithreading, synchronization

在什么情况下应该使用以下每个同步对象？

1.  读写锁
2.  信号
3.  互斥体

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T13:16:22.217

*   由于每次调用 post() 时 wait() 将返回一次，因此信号量是基本的生产者-消费者模型 - 除了信号之外，最简单的线程间消息形式。使用它们是为了让一个线程可以告诉另一个线程它感兴趣的事情发生了（以及发生了多少次），并用于管理对最多可以拥有固定有限数量用户的资源的访问。它们提供多线程代码所需的排序保证。

*   互斥体做他们在锡上所说的 - “互斥”。它们确保访问某些资源的权利一次仅由线程“持有”。这保证了多线程代码所需的原子性和排序。在大多数操作系统上，它们还提供相当复杂的服务员行为，特别是为了避免优先级倒置。

请注意，信号量可以很容易地用于实现互斥，但是由于信号量没有“所有者线程”，因此您无法通过信号量避免优先级反转。因此它们并不适合所有需要“锁定”的用途。

*   ReaderWriter 锁是对互斥锁的优化，在您有很多争用的情况下，大多数访问是只读的，并且允许同时读取受保护的数据结构。在这种情况下，只有当涉及到作者时才需要排除——读者不需要相互排除。为了将一个读者提升为写者，所有其他读者必须在获得写者锁之前完成（或者如果他们也希望成为写者，则中止并开始等待重试）。ReaderWriter 锁在速度不快的情况下可能会变慢，因为它们对互斥锁进行了额外的记账。

*   条件变量用于允许线程等待某些事实或事实组合为真，其中所讨论的条件比信号量的“它已被戳”或互斥锁的“没有其他人正在使用它”更复杂，并且读写器锁的写入器部分，或者“没有写入器正在使用它”作为读写器锁的读取器部分。它们也用于不同等待线程的触发条件不同的情况，但取决于部分或全部相同状态（内存位置或其他）。

*   自旋锁适用于您将在一个处理器或内核上等待很短的时间（如几个周期），而另一个内核（或 I/O 总线等硬件）同时执行一些您关心的工作时关于。在某些情况下，它们比信号量或中断等其他原语提高了性能，但必须非常小心地使用（因为在现代内存模型中无锁算法很困难）并且只有在证明有必要时（因为避免系统原语的聪明想法通常是过早的优化）。

顺便说一句，这些答案不是 C# 特定的（因此例如关于“大多数操作系统”的评论）。Richard 提出了一个很好的观点，即在 C# 中你应该在适当的地方使用普通的旧锁。我相信监视器是一个互斥体/条件变量对组合到一个对象中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T12:11:19.423

我会说他们每个人都可以是“最好的” - 取决于用例;-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T15:14:40.340

简单的答案：几乎从不。

最好的锁定类型是不需要锁（无共享可变状态）。

如果您确实需要锁，请尝试使用 Monitor（通过 lock 语句），除非您对不同的东西有特定需求（在这种情况下，请参阅 Onebyone 的答案

此外，更喜欢[`ReaderWriteLockSlim`](http://msdn.microsoft.com/library/system.threading.readerwriterlockslim "MSDN")（[`ReaderWriterLock`](http://msdn.microsoft.com/library/system.threading.readerwriterlock "MSDN")除了要求后者公平的极少数情况）。

# c# - Mapping a ternary association with FluentNHibernate, using IDictionary

> ID：760180
> 
> 赞同：2
> 
> 时间：2009-04-17T12:12:52.023
> 
> 标签：c#, .net, nhibernate, fluent-nhibernate

I'm trying to map a ternary association using FluentNhibernate.

I have 3 tables:

*   `TUser(PK int id, string name, ...)`
*   `TGroup(PK int id, string name, ...)`
*   `TRole(PK int id, string name, ...)`

And a 4th one that associates them, representing the ternary association:

*   `TUserGroupRole(FK int userid, FK int groupid, FK int roleid)`

Basically, a user has a particular role for a group. I'm using 3 types in my model :

*   `User`
*   `UserGroup`
*   `UserRole`

In the `User` class, I want to use an `IDictionary<UserGroup,UserRole>` to index user roles by groups:

```
public class User
{
    public virtual int Id { get; set; }
    public virtual IDictionary<UserGroup, UserRole> Roles { get; set; }
    // ...
} 
```

Using regular hbm fashioned XML mapping file, I achieved that with a `<map>` element, like so (pseudo mapping):

```
<map name="Roles" table="TUserGroupRole">
    <key column="userid"/>
    <index-many-to-many column="groupid" class="UserGroup"/>
    <many-to-many column="roleid" class="UserRole"/>
</map> 
```

**I wasn't able to figure out how to generate the same mapping using FluentNhibernate**, so any help on this point would be very appreciated.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T20:56:10.347

为了响应您在 FNH 组上得到的回复，请确保您正在导出映射文件，例如：

```
.Mappings(m => m.FluentMappings.AddFromAssemblyOf<MyObject>()
    .ExportTo("path") 
```

我倾向于同意这种回应，因为我只在元素乱序时看到过这种类型的异常。也就是说，当键/索引或 id 元素不是第一个子元素时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-11T07:08:38.517

使用 FNH 1.3 它应该看起来像

```
HasManyToMany(x => x.Roles)
    .ParentKeyColumn("userid")
    .AsTernaryAssociation("groupid")
    .ChildKeyColumn("roleid"); 
```

# apache-flex - 有没有一种简单的方法来隐藏 flex 预加载器？

> ID：760182
> 
> 赞同：0
> 
> 时间：2009-04-17T12:15:24.017
> 
> 标签：apache-flex, preloader

有没有办法隐藏预加载器。我的一个想法是制作一个空的新的，但肯定有一种更简单的方法来做到这一点。

这听起来像是一个愚蠢的想法，但在某些情况下，隐藏预加载器可能会很好。特别是如果它不需要大量的工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T14:45:06.887

添加`usePreloader="false"`到您的`mx:Application`标签：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" 
    usePreloader="false"> 
```

# e-commerce - Adding custom developed code to software product

> ID：760183
> 
> 赞同：2
> 
> 时间：2009-04-17T12:15:45.340
> 
> 标签：e-commerce, customization, contracts

In your opinion is it common and ethical to do custom software development for a Customer and then add that software to your base product which is available to your other customers?

My take on it is that:

1.  It's a contractual issue between you and the Customer.
2.  It's done often (although maybe not 'common').
3.  It's similar to the Customer paying to have their pet feature bumped up the development priority queue.

Can anyone point to any well known (or at least public) examples of this?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T12:21:19.557

1.  You are right, it should be a contractual obligation over who owns the source code. Many vendors will sell the finished product to the client but keep the source code, others will give the whole thing away (which is S.O.P. with our company)

2.  I imagine it gets done, just not sure as far as the scope or depth of the copying.

I can't think of any well-known examples (primarily because business between two companies isn't often publicized), but a personal example is when we developed a much more flexible time-tracking system in one of our client applications and it turned out so well that we implemented it into our own personal time-tracking system (which wasn't that great out the gate).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T12:19:08.530

From an ethical standpoint, I think it's actually quite simple: It's a matter of what your customer perceives you to be doing. Do they think you are customizing your product for them, or do they think they are paying for their pet requests to be bumped up in your feature queue?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T20:36:33.790

作为一个极端的观点：如果所有定制代码都不能在其他任何地方使用，那么在某些时候你将无法继续你的业务而不违反该规则。

作为相反的极端：如果所有定制代码最终都成为通用产品，那么没有客户会再向您提供他们的具体问题。

当然，这两种观点都非常极端，在我看来不太可能发生到那种程度。

就我个人而言，我会非常清楚地向新客户说明，通常所有（自定义）代码都可以在其他产品和项目中使用，除非事先同意不对代码的特定部分这样做。然后，如果某些部分关起门来对他们来说真的很重要，他们会告诉你。

# regex - 正则表达式：我怎样才能强加一个完美的字符串匹配？

> ID：760184
> 
> 赞同：0
> 
> 时间：2009-04-17T12:16:06.510
> 
> 标签：regex

目前我正在使用这个（**编辑：我错过了解释我使用这个来排除这些单词：p** ）：

```
 String REGEXP = "^[^(REG_)?].*"; 
```

但也匹配（不包括）ERG、EGR、GRE 等...

PS我删除了super，因为它是我必须过滤的另一个关键字，图一个由以下三个单词组成的数组列表用作模型：

REG_info1、info2、SUPER_info3 等...

我需要三个过滤器一次匹配一个模型，我的问题只关注基于模型“info2”的第二个过滤器解析关键字。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-17T12:19:12.353

只需按字面意思输入：

```
REG 
```

这只会匹配`REG`。

所以：

```
String REGEXP = "^(REG_|SUPER_)?.*"; 
```

* * *

**编辑**   在您澄清要匹配每个*不*`REG_`以or开头的单词后`SUPER_`，您可以尝试以下操作：

```
\b(?!REG_|SUPER_)\w+ 
```

是`\b`单词边界，表达式是前瞻断言。`(?!`*`expr`*`)`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T12:30:12.343

正如大家已经回答的那样，如果要匹配以 REG 开头的行，请使用正则表达式“^REG”，如果要匹配任何以 REG 或 SUPER 开头的行，请使用“^(REG|SUPER)”和正则表达式否定通常是一个棘手的问题。

要匹配所有不以 'REG' 开头的行，您需要匹配 "^[^R]|R[^E]|RE[^G]" 并且可以构造一个正则表达式来匹配所有不以 REG 或 SUPER 开头的行以类似的方式（首先将括号中的“not REG”分组，然后将“not SUPER”模式构造为“[^S]|S[^U]|[SU[^P]...”，将其分组并交替使用两组）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T12:20:30.243

[] 表示字符类。这不是你想要的。您可以只使用“REG”来匹配 REG。（您可以将 REG|SUPER 用于 REG 或 SUPER）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T12:21:08.540

怎么样

```
\mREG\M

// \mREG\M
// 
// Options: ^ and $ match at line breaks
// 
// Assert position at the beginning of a word «\m»
// Match the characters “REG” literally «REG»
// Assert position at the end of a word «\M» 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T12:55:11.580

```
REGEXP = "^(REG_|SUPER_)" 
```

将匹配任何在字符串开头具有 REG_ 或 SUPER_ 的内容。在组“（..|..）”之后你不需要更多

# design-patterns - 这是命令模式吗？

> ID：760195
> 
> 赞同：1
> 
> 时间：2009-04-17T12:19:48.467
> 
> 标签：design-patterns, command, mvp

我有一个 MVP Gui，现在我想为某些视图定义某些操作或命令（修改、保存、关闭……）。

是否有捷径可寻？我应该为每个视图提供命令吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T12:26:42.007

最简单的方法是创建一个工厂，在其中实例化所有命令对象。因此，如果您有一个打开的作业命令，所有视图都会进入工厂并拉出打开的作业命令对象，实例化它，然后执行它。如果您需要修复错误或更改打开作业命令，您只需在一个地方为所有视图执行此操作。

话虽如此，每个视图都会有一些命令可能是唯一的。尽管如此，您可能仍希望将它们封装在命令对象中，因为您可以通过命令对象轻松实现撤消/重做。

# .net - PEVerify MD 错误：0x8013124C

> ID：760196
> 
> 赞同：0
> 
> 时间：2009-04-17T12:20:23.067
> 
> 标签：.net, peverify

在自定义生成的程序集上运行 PEVerify 时出现此“错误”。

```
[MD](0x8013124C): Error: Method has a duplicate, token=0x06000023\. 
                         [token:0x06000021]
[MD](0x8013124C): Error: Method has a duplicate, token=0x06000021\. 
                         [token:0x06000023] 
```

除此之外（以及其他 196 个完全相同的错误），元数据和 IL 没有问题。它也可以正常工作。

我一直无法追踪它的来源（因为它不会以任何方式影响组装）。

不幸的是，谷歌并没有透露太多关于这个错误的信息。

有人可以提供一些关于这个“错误”的见解以及它是如何引起的吗？

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T14:37:36.920

我解决了这个问题。

它是由发出具有另一个确切签名的方法引起的。

**更新**

这适用于任何成员。因此，在混淆程序集上运行时，这可能会出现相同的 MD 错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T13:30:52.040

听起来 peverify 认为您在程序集元数据中有重复的方法行。我在评论中读到您正在使用 Reflection.Emit 来生成程序集。听起来您可能正在重新使用方法定义进行生成，而不是为每个方法创建一个新方法。

# postgresql - 如何在 PostgreSQL 中创建只读用户？

> ID：760210
> 
> 赞同：523
> 
> 时间：2009-04-17T12:26:58.123
> 
> 标签：postgresql

我想在 PostgreSQL 中创建一个只能从特定数据库执行 SELECT 的用户。在 MySQL 中，命令将是：

```
GRANT SELECT ON mydb.* TO 'xxx'@'%' IDENTIFIED BY 'yyy'; 
```

PostgreSQL 中的等效命令或命令系列是什么？

我试过...

```
postgres=# CREATE ROLE xxx LOGIN PASSWORD 'yyy';
postgres=# GRANT SELECT ON DATABASE mydb TO xxx; 
```

但似乎您可以在数据库上授予的唯一内容是 CREATE、CONNECT、TEMPORARY 和 TEMP。

* * *

## 回答 #1

> 赞同：783
> 
> 时间：2009-04-18T00:39:02.683

## 将使用/选择授予单个表

如果您仅将 CONNECT 授予数据库，则用户可以连接但没有其他权限。您必须在命名空间（模式）上授予 USAGE 并在表和视图上分别授予 SELECT ，如下所示：

```
GRANT CONNECT ON DATABASE mydb TO xxx;
-- This assumes you're actually connected to mydb..
GRANT USAGE ON SCHEMA public TO xxx;
GRANT SELECT ON mytable TO xxx; 
```

## 多个表/视图 (PostgreSQL 9.0+)

在最新版本的 PostgreSQL 中，您可以使用单个命令授予架构中所有表/视图/等的权限，而不必一一键入它们：

```
GRANT SELECT ON ALL TABLES IN SCHEMA public TO xxx; 
```

这只会影响已经创建的表。更强大的是，您可以在将来自动将[默认角色分配给新对象：](http://www.postgresql.org/docs/9.0/static/sql-alterdefaultprivileges.html)

```
ALTER DEFAULT PRIVILEGES IN SCHEMA public
   GRANT SELECT ON TABLES TO xxx; 
```

请注意，默认情况下，这只会影响发出此命令的用户创建的对象（表）：尽管它也可以在发出用户所属的任何角色上设置。但是，在创建新对象时，您不会为您所属的所有角色选择默认权限......所以仍然存在一些问题。如果您采用数据库具有拥有角色的方法，并且架构更改是作为该拥有角色执行的，那么您应该将默认权限分配给该拥有角色。恕我直言，这有点令人困惑，您可能需要进行试验才能提出功能性工作流程。

## 多个表/视图（9.0 之前的 PostgreSQL 版本）

为避免在冗长的多表更改中出错，建议使用以下“自动”过程来生成`GRANT SELECT`每个表/视图所需的：

```
SELECT 'GRANT SELECT ON ' || relname || ' TO xxx;'
FROM pg_class JOIN pg_namespace ON pg_namespace.oid = pg_class.relnamespace
WHERE nspname = 'public' AND relkind IN ('r', 'v', 'S'); 
```

这应该在公共的所有表、视图和序列上将相关的 GRANT 命令输出到 GRANT SELECT，以便进行复制粘贴。自然，这只适用于已经创建的表。

* * *

## 回答 #2

> 赞同：121
> 
> 时间：2017-02-04T19:51:34.507

**[参考来自这个博客：](http://www.dbrnd.com/2015/10/postgresql-script-to-create-a-read-only-database-user/)**

**创建只读用户的脚本：**

```
CREATE ROLE Read_Only_User WITH LOGIN PASSWORD 'Test1234' 
NOSUPERUSER INHERIT NOCREATEDB NOCREATEROLE NOREPLICATION VALID UNTIL 'infinity'; 
```

**为该只读用户分配权限：**

```
GRANT CONNECT ON DATABASE YourDatabaseName TO Read_Only_User;
GRANT USAGE ON SCHEMA public TO Read_Only_User;
GRANT SELECT ON ALL TABLES IN SCHEMA public TO Read_Only_User;
GRANT SELECT ON ALL SEQUENCES IN SCHEMA public TO Read_Only_User; 
```

***分配权限以读取将来创建的所有新表***

```
ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT SELECT ON TABLES TO Read_Only_User; 
```

* * *

## 回答 #3

> 赞同：47
> 
> 时间：2010-06-19T21:21:01.380

请注意 PostgreSQL 9.0（今天在 beta 测试中）将有一个[简单的方法来做到这一点](http://www.postgresql.org/docs/9.0/static/sql-grant.html)：

```
test=> GRANT SELECT ON ALL TABLES IN SCHEMA public TO joeuser; 
```

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2013-09-05T21:10:54.010

**这是我发现添加只读用户的最佳方法（使用 PostgreSQL 9.0 或更高版本）：**

```
$ sudo -upostgres psql postgres
postgres=# CREATE ROLE readonly WITH LOGIN ENCRYPTED PASSWORD '<USE_A_NICE_STRONG_PASSWORD_PLEASE';
postgres=# GRANT SELECT ON ALL TABLES IN SCHEMA public TO readonly; 
```

然后登录所有相关机器（master + read-slave(s)/hot-standby(s)等）并运行：

```
$ echo "hostssl <PUT_DBNAME_HERE> <PUT_READONLY_USERNAME_HERE> 0.0.0.0/0 md5" | sudo tee -a /etc/postgresql/9.2/main/pg_hba.conf
$ sudo service postgresql reload 
```

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2016-08-19T00:08:31.463

默认情况下，新用户将有权创建表。如果您打算创建一个只读用户，这可能不是您想要的。

要使用 PostgreSQL 9.0+ 创建真正的只读用户，请运行以下步骤：

```
# This will prevent default users from creating tables
REVOKE CREATE ON SCHEMA public FROM public;

# If you want to grant a write user permission to create tables
# note that superusers will always be able to create tables anyway
GRANT CREATE ON SCHEMA public to writeuser;

# Now create the read-only user
CREATE ROLE readonlyuser WITH LOGIN ENCRYPTED PASSWORD 'strongpassword';
GRANT SELECT ON ALL TABLES IN SCHEMA public TO readonlyuser; 
```

如果您的只读用户没有列出表的权限（即`\d`不返回结果），可能是因为您没有`USAGE`架构的权限。`USAGE`是一种允许用户实际使用他们被分配的权限的权限。这有什么意义？我不知道。修理：

```
# You can either grant USAGE to everyone
GRANT USAGE ON SCHEMA public TO public;

# Or grant it just to your read only user
GRANT USAGE ON SCHEMA public TO readonlyuser; 
```

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2021-04-22T13:12:17.977

从 PostgreSQL v14 开始，您只需授予预定义[`pg_read_all_data`](https://www.postgresql.org/docs/current/predefined-roles.html#PREDEFINED-ROLES-TABLE)角色即可：

```
GRANT pg_read_all_data TO xxx; 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2014-08-14T20:27:36.220

我为此创建了一个方便的脚本；[pg_grant_read_to_db.sh](https://gist.github.com/jirutka/afa3ce62b1430abf7572#file-pg_grant_read_to_db-sh)。此脚本将只读权限授予数据库模式中所有表、视图和序列的指定角色，并将它们设置为默认值。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2019-01-15T06:38:22.507

我阅读了所有可能的解决方案，一切都很好，如果你记得在授予东西之前连接到数据库;）无论如何感谢所有其他解决方案！

```
user@server:~$ sudo su - postgres 
```

创建 psql 用户：

```
postgres@server:~$ createuser --interactive 
Enter name of role to add: readonly
Shall the new role be a superuser? (y/n) n
Shall the new role be allowed to create databases? (y/n) n
Shall the new role be allowed to create more new roles? (y/n) n 
```

启动 psql cli 并为创建的用户设置密码：

```
postgres@server:~$ psql
psql (10.6 (Ubuntu 10.6-0ubuntu0.18.04.1), server 9.5.14)
Type "help" for help.

postgres=# alter user readonly with password 'readonly';
ALTER ROLE 
```

连接目标数据库：

```
postgres=# \c target_database 
psql (10.6 (Ubuntu 10.6-0ubuntu0.18.04.1), server 9.5.14)
You are now connected to database "target_database" as user "postgres". 
```

授予所有需要的权限：

```
target_database=# GRANT CONNECT ON DATABASE target_database TO readonly;
GRANT

target_database=# GRANT USAGE ON SCHEMA public TO readonly ;
GRANT

target_database=# GRANT SELECT ON ALL TABLES IN SCHEMA public TO readonly ;
GRANT 
```

更改目标数据库公共 shema 的默认权限：

```
target_database=# ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT SELECT ON TABLES TO readonly;
ALTER DEFAULT PRIVILEGES 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2017-03-28T17:07:55.390

如果您的数据库在公共模式中，这很容易（假设您已经创建了`readonlyuser`）

```
db=> GRANT SELECT ON ALL TABLES IN SCHEMA public to readonlyuser;
GRANT
db=> GRANT CONNECT ON DATABASE mydatabase to readonlyuser;
GRANT
db=> GRANT SELECT ON ALL SEQUENCES IN SCHEMA public to readonlyuser;
GRANT 
```

如果您的数据库正在使用`customschema`，请执行上述操作，但还要添加一个命令：

```
db=> ALTER USER readonlyuser SET search_path=customschema, public;
ALTER ROLE 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-17T12:35:08.633

不直接的方法是在数据库的每个表上授予选择：

```
postgres=# grant select on db_name.table_name to read_only_user; 
```

您可以通过从数据库元数据生成授权语句来自动执行此操作。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-10-27T16:22:09.877

取自为回应[despesz 的](http://www.depesz.com/index.php/2007/10/19/grantall/)链接而发布的链接。

Postgres 9.x 似乎有能力做所要求的事情。请参阅授予数据库对象的段落：

[http://www.postgresql.org/docs/current/interactive/sql-grant.html](http://www.postgresql.org/docs/current/interactive/sql-grant.html)

它说：“还有一个选项可以授予对一个或多个模式中相同类型的所有对象的权限。此功能目前仅支持表、序列和函数（但请注意，所有表都被认为包括视图）和外国表）。”

本页还讨论了 ROLE 和称为“ALL PRIVILEGES”的 PRIVILEGE 的使用。

还提供了有关 GRANT 功能如何与 SQL 标准进行比较的信息。

* * *

## 回答 #12

> 赞同：-5
> 
> 时间：2019-05-14T07:18:32.747

```
CREATE USER username SUPERUSER  password 'userpass';
ALTER USER username set default_transaction_read_only = on; 
```

# html - CSS Floats - content falling down in IE6

> ID：760211
> 
> 赞同：4
> 
> 时间：2009-04-17T12:27:16.653
> 
> 标签：html, css, xhtml, internet-explorer-6

I have a layout with a menu DIV on the left. This is floated left with a fixed EM width. I then have a content DIV which has a left margin of more than the menu's width. So it sits nicely to the right of the menu and fills up the remaining space with both menu and content lined up perfectly.

However, in Internet Explorer 6, if the content gets too wide it falls down below the menu. which means you have loads of whitespace and can't actually see any of the content at all without scrolling.

Unfortunately I am not able to make changes to the content - this is a redesign of a site hosting 3rd party content, and changing that content is outside the scope of what I can do.

Also, there is a footer bar that must be underneath both the menu and the content.

I managed to almost get it to work by providing IE6 with a different layout using absolute positioning - unfortunately the footer looks rubbish and as IE6 is the 2nd most used browser on our site I can't really go with that.

I also tried messing around with overflows but ended up causing problems with random scrollbars appearing all over the place which wasn't any good either.

Does anyone know if there is a simple non-Javascript way of doing this that will work in IE6 as well as "proper" browsers? I'm currently thinking that it will have to be a table based layout.

Here's an example of the problem:

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html>
    <head>
        <style type="text/css">
            .menu {
                width: 14em;
                float: left;
            }

            .content {
                margin-left: 15em;
                zoom: 1;
            }

            .footer {
                clear: both;
            }

             /* styling to make the demo more obvious */
            .menu {
                background-color: #f99;
            }
            .content {
                background-color: #9f9;
            }
            .footer {
                background-color: #99f;
            }
            td {
                border: 1px solid #000;
            }
        </style>
    </head>

    <body>

    <div class="container">
        <div class="menu">
            <ul>
                <li><a href="#">menu item</a></li>
                <li><a href="#">menu item</a></li>
                <li><a href="#">menu item</a></li>
                <li><a href="#">menu item</a></li>
            </ul>
        </div>

        <div class="content">
            <h1>Main Content</h1>
                <table>
                    <tr>
                        <td>this is a really</td>
                        <td>wide table which</td>
                        <td>I am using to push</td>
                        <td>the content down</td>
                        <td>need to keep going</td>
                        <td>so that it breaks</td>
                        <td>in ie6</td>
                        <td>but naturally</td>
                        <td>nothing else</td>
                        <td>sghskdhksdhfsdhffs</td>
                        <td>sghskdhksdhfsdhffs</td>
                        <td>sghskdhksdhfsdhffs</td>
                        <td>sghskdhksdhfsdhffs</td>
                    </tr>
                </table>
            </div>
        </div>

        <div class="footer">
            <p>Copyright blah blah blah</p>
        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T18:59:05.933

正如您提到的，您已经尝试过绝对位置。但我会尝试以下方法，它可能对你有用。这是CSS：

```
.container {
    position:relative;
}
.menu {
    width: 14em;
    position:absolute;
    top: 0;
    left: 0 !important;
    left: -15em;
}

.content {
    margin-left: 15em;
}
.footer {
} 
```

一些解释：菜单是绝对定位的，独立于其他内容。但是，IE 将菜单相对于“内容”div 放置，并将其隐藏在“内容”div 后面。解决方法是将其定位为负数，就像内容 div 具有“margin-left”的左侧一样多的 em。但这应该只对 IE 进行，因此添加了“left 0 !important”（但在负左之前），这是因为 IE 忽略了“！important”，而其他浏览器确实承认它并将使用“left 0” .

更新：

正如 Alohci 所指出的，更好的方法是使用“* html”hack，在这种情况下，“菜单”的 CSS 变为：

```
.menu {
    width: 14em;
    position:absolute;
    top: 0;
    left: 0;
}

* html .menu {
     left: -15em;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T12:39:11.243

为什么不使用已建立的布局，例如[http://layouts.ironmyers.com/](http://layouts.ironmyers.com/)

或者你可能想调查这个[css 溢出](http://www.w3schools.com/Css/pr_pos_overflow.asp)

看看[这个](http://www.domedia.org/oveklykken/css-div-scroll.php)，有用吗？

**编辑：**

尝试以下修复之一：（您可以使用@Blake 建议的一些条件代码）

*   溢出：滚动——这确保你的内容可以以设计为代价被看到（滚动条很难看）
*   溢出：隐藏 - 只是切断任何溢出。这意味着人们无法阅读内容。

    ```
    .content {
            margin-left: 15em;
            zoom: 1;
            overflow:scroll  
            /* overflow:hidden */ /* probably second best */
    } 
    ```

试试看这个[如何防止长词破坏我的div？](https://stackoverflow.com/questions/320184/who-has-solved-the-long-word-breaks-my-div-problem-hint-not-stackoverflow)这是你的问题吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T13:02:55.650

使用 IE6 的一些条件注释来读取并放入必要的 CSS 以修复有问题的 div 的宽度，如下所示：

```
<!--[if IE 6]>
IE 6 specific stuff goes here. You can load a specific stylesheet here, or just have inline css
<![endif]--> 
```

[您可以在此处阅读有关条件评论的更多信息。](http://www.quirksmode.org/css/condcom.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T13:33:27.260

删除 `zoom: 1`; 让它在 IE6 中对我来说很好用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-12-17T06:58:19.493

为时已晚，但通常我通过添加或绝对宽度（以像素、点或任何硬测量系统而不是 em、% 等为单位的数字）或有时放置 min-width 属性来解决它，也请注意由于 boxmodel 和的填充和边框。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T12:58:26.407

我已经多次遇到这种情况，以至于我只是试图完全远离花车。也就是说，你可以做一些事情来让它们工作，但你可能不得不接受一个固定的布局和/或[一些 IE6 特定的修复](http://www.sitepoint.com/blogs/2009/03/06/10-fixes-for-ie6-problems/)。以下是您可以尝试的一些事情：

1.  这听起来像是异端邪说，但表格的布局并没有错，它们只是不酷。
2.  尝试使用固定宽度和自动边距设置“容器”div。
3.  如果这不起作用，请尝试使用固定宽度的 'content' div 和固定宽度的 'container' div。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-21T12:09:44.637

感谢您的立场：绝对的想法。这类似于我几乎采用的一种解决方案。

这里的问题是，如果菜单比内容长（而且经常如此），菜单将覆盖页脚。我可以尝试向内容添加任意高度以尝试强制最小高度，但我真的不知道菜单会有多大。该区域的侧面板有很多潜力。

我认为没有办法强制相对定位的容器响应绝对定位的内容而增长，是吗？即使它是 IE6 hack，因为我可以将 float 方法用于其他浏览器。

（再次，很抱歉没有将此作为评论发布，但我不认为这是一个选项）

# django - 需要 Django 片段

> ID：760213
> 
> 赞同：1
> 
> 时间：2009-04-17T12:28:22.330
> 
> 标签：django, open-source, django-models

我是一个非常紧张的时间来编写一个网站的原型。我正在与 Django 合作，并且刚刚开始。您能否为以下内容推荐开源 Django 片段：

1) 用户注册系统（注册/认证/会话） 2) 评级系统（最好是 ax/10 或 5 星评级系统） 3) 基于标签的搜索系统

我真的是个菜鸟，我需要在 4 小时内完成第 1 版。所以我将使用开源代码并对其进行修改。我将确保最终版本也保持开源。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-17T12:39:05.720

查看[Pinax 项目](http://pinaxproject.com/)。这应该涵盖#1（OpenID）和#3（标记）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-17T14:21:03.090

您的基本 Django 安装将提供开箱即用的用户、身份验证和会话处理。对于您的用户注册需求，您可以考虑[django-registration](http://bitbucket.org/ubernostrum/django-registration/wiki/Home)。它由受人尊敬的 Django 贡献者[James Bennett编写。](https://stackoverflow.com/users/28070/james-bennett)对于标记，我一直使用[django-tagging](http://code.google.com/p/django-tagging/)。

我从未在 Django 应用程序中使用过评分系统，但您可能会考虑使用[django-ratings](http://code.google.com/p/django-ratings/)。

祝你好运！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-17T12:40:03.037

我从未搜索过您的确切两个示例，但[django 片段](http://www.djangosnippets.org/)通常是寻找 django 代码示例时的一个非常好的起点。

# c++ - 打破 std::for_each 循环

> ID：760221
> 
> 赞同：34
> 
> 时间：2009-04-17T12:30:17.317
> 
> 标签：c++, stl

在使用 std::for_each 算法时，当满足某个条件时如何中断？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-07-13T12:30:48.440

您可以像这样使用 std::any_of （或 std::all_of 或 std::none_of）：

```
std::vector<int> a;
// ...     
std::all_of(a.begin(), a.end(), [&](int val) { 
  // return false if you want to break, true otherwise
  }); 
```

但是，这是一种浪费的解决方案（返回值并没有真正用于任何事情），而且您最好编写自己的循环。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-04-17T12:34:21.770

您可以使用[`std::find_if`](https://en.cppreference.com/w/cpp/algorithm/find)算法，它将停止并将迭代器返回到应用谓词条件返回的第一个元素`true`。因此，您的谓词应更改为返回布尔值作为继续/中断条件。

但是，这是一个 hack，因此您可以使用这些算法。

另一种方法是使用 BOOST_FOREACH。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-04-17T12:35:17.913

您可以通过从仿函数中抛出异常来打破 for_each()。然而，这通常不是一个好主意，还有其他选择。

您可以在仿函数中保留状态。如果您检测到“中断”条件，只需在仿函数中设置一个标志，然后对于每个后续迭代只需返回而不执行仿函数的操作。显然这不会停止迭代，这对于大型集合来说可能是昂贵的，但它至少会停止执行工作。

如果您的集合已排序，您可以 find() 要中断的元素，然后从 begin() 到返回的元素 find() 执行 for_each。

最后，您可以实现一个`for_each_if()`. 如果谓词评估为假，这将再次不会停止迭代，但不会评估执行工作的函子。这里有 2 种风格`for_each_xxx()`，一种接受一个值并在 operator==() 评估为 true 时执行工作，另一种接受两个仿函数；一个执行比较 ala find_if()，另一个在比较运算符评估为真时执行工作。

```
/* ---

    For each
    25.1.1

        template< class InputIterator, class Function, class T>
            Function for_each_equal(InputIterator first, InputIterator last, const T& value, Function f)

        template< class InputIterator, class Function, class Predicate >
            Function for_each_if(InputIterator first, InputIterator last, Predicate pred, Function f)

    Requires:   

        T is of type EqualityComparable (20.1.1) 

    Effects:    

         Applies f to each dereferenced iterator i in the range [first, last) where one of the following conditions hold:

            1:  *i == value
            2:  pred(*i) != false

    Returns:    

        f

    Complexity: 

        At most last - first applications of f

    --- */

    template< class InputIterator, class Function, class Predicate >
    Function for_each_if(InputIterator first, 
                         InputIterator last, 
                         Predicate pred, 
                         Function f)
    {
        for( ; first != last; ++first)
        {
            if( pred(*first) )
                f(*first);
        }
        return f;
    };

    template< class InputIterator, class Function, class T>
    Function for_each_equal(InputIterator first, 
                            InputIterator last, 
                            const T& value, 
                            Function f)
    {
        for( ; first != last; ++first)
        {
            if( *first == value )
                f(*first);
        }
        return f;
    }; 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-17T12:43:21.280

如果你想在条件不满足的情况下做一些动作，也许你需要改变算法，比如`std::find_if`？

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-17T17:01:39.070

正如其他人已经表明的那样，只有通过恕我直言混淆代码的解决方法才能实现。

所以我的建议是将 for_each 更改为常规的 for 循环。这将使其他人更容易看到您正在使用 break （甚至可能继续）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-17T12:32:30.137

你不能这样做，除非你抛出一个异常，这不是一个好主意，因为你不对异常进行流控制。

更新：显然 Boost 有一个 for_each_if*可能会*有所帮助，但你没有使用 Boost。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-17T12:38:43.320

你抛出一个异常。这是否是一个好主意是一个风格问题，步伐@Dan，但可能更多的是你的设计问题。for_each 旨在用于一种函数式编程风格，它隐含地假设您的函数可以在整个集合中统一应用。所以，如果你*确实*需要中断，那可能是一种不寻常的情况，因此值得例外。

另一个解决方案，也是一个更“功能性”的解决方案，是编写您的函数，以便如果它不应该对某些应用程序产生影响，那么将其编写为无效。因此，例如，如果您有一个求和函数，则在您“中断”的情况下将其添加 0。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-09-15T14:38:05.477

您可以`std::find_if`改用`std::for_each`：

```
int aaa[]{ 1, 2, 3, 4, 5, 6, 7, 8 };
std::find_if(aaa, std::next(aaa, sizeof(aaa) / sizeof(int)), [](const auto &i) {
    if (i == 5)
        return true;
    std::cout << i << std::endl;
    return false;
}); 
```

输出：
1
2
3
4

# winforms - 将击键转发到 WinForms 中的另一个控件

> ID：760224
> 
> 赞同：0
> 
> 时间：2009-04-17T12:31:07.130
> 
> 标签：winforms, winapi, keyboard

我在`Form`对象的`OnKeyDown`. 当满足某些条件时（例如击键是可打印字符而不是热键），我想将键转发到表单上的文本控件并将焦点设置到文本控件，以便用户可以继续输入。我能够解码使用输入的字符，`MapVirtualKey`但我只得到“未移位”字符（总是大写）。使用`ToUnicodeEx`PITA 似乎太多了。

做这个的最好方式是什么？难道没有办法简单地转发 Windows 消息本身吗？

我不能拦截`ProcessKeyPreview`或一些这样的并将其转发到文本控件`ProcessKeyPreview`吗？有类似的想法吗？

**Bump：**没有答案！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-29T11:04:02.590

我使用以下表格在一个表格上执行此操作

```
private void MyFunkyForm_KeyDown(object sender, KeyEventArgs e)
{
    // to avoid duplicate letters in textbox :-)
    if (textBox2.Focused == false)
    {

        // get the char from the Keycode
        char inputChar = (char)e.KeyCode;
        if (char.IsLetterOrDigit(inputChar))
        {
            // if letter or number then add it to the textbox
            textBox2.Text += inputChar;
        }

        // set focus
        textBox2.Focus();
        // set cursor to the end of text, no selection
        textBox2.SelectionStart = textBox2.Text.Length;
    }
} 
```

# windows-vista - preventing vista shutdown loggoff API showing

> ID：760226
> 
> 赞同：0
> 
> 时间：2009-04-17T12:31:21.090
> 
> 标签：windows-vista, shutdown

I want to stop the shutdown / log off API which appears when you have programs open to confirm a shutdown/logoff.

I have an application already that send a reason to the API.

I know this is bad practice but I really need to override / cancel the shutdown with out displaying the API after 5 seconds.

is there any way to hack this or run a custom shutdown script to override the shutdown.

thanks in advance

* * *

it doesnt matter about holding it for5 seconds just catching it if it is pressed once. I can do that but vista shows a API screen after 5 seconds which All i want is vista not to show that.

vista shows that because I prevent it from shutting down.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-17T12:55:07.773

你可能想看看这个： http: [//msdn.microsoft.com/en-us/library/aa376871 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa376871(VS.85).aspx)

当我执行此功能时，我必须在非托管 C++ 中执行所有操作，因为我在尝试使用 Interop 设置权限时遇到问题。

您需要这个标志：ExitWindowsEx 中的 EWX_FORCE。

# java - 如何在 Java 中合并两个输入流？

> ID：760228
> 
> 赞同：31
> 
> 时间：2009-04-17T12:31:55.567
> 
> 标签：java, io, inputstream

在 Java 中有两个 InputStreams，有没有办法合并它们，所以你以一个 InputStream 结束，给你两个流的输出？如何？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-04-17T12:51:15.427

正如所评论的，目前尚不清楚您所说的合并是什么意思。

从任一“随机”获取可用输入很复杂，`InputStream.available`因为不一定会给您有用的答案和阻止流的行为。您将需要两个线程来从流中读取数据，然后通过`java.io.Piped(In|Out)putStream`（尽管这些类有问题）传回数据。或者，对于某些类型的流，可以使用不同的接口，例如`java.nio`非阻塞通道。

如果您想要第一个输入流的全部内容，然后是第二个：`new java.io.SequenceInputStream(s1, s2)`.

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-04-17T13:08:36.133

`java.io.SequenceInputStream`可能是你需要的。它接受流的枚举，并将输出第一个流的内容，然后是第二个，依此类推，直到所有流为空。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-17T12:43:12.980

您可以编写一个自定义`InputStream`实现来执行此操作。例子：

```
import java.io.IOException;
import java.io.InputStream;
import java.util.Collections;
import java.util.Deque;
import java.util.LinkedList;

public class CatInputStream extends InputStream {
    private final Deque<InputStream> streams;

    public CatInputStream(InputStream... streams) {
        this.streams = new LinkedList<InputStream>();
        Collections.addAll(this.streams, streams);
    }

    private void nextStream() throws IOException {
        streams.removeFirst().close();
    }

    @Override
    public int read() throws IOException {
        int result = -1;
        while (!streams.isEmpty()
                && (result = streams.getFirst().read()) == -1) {
            nextStream();
        }
        return result;
    }

    @Override
    public int read(byte b[], int off, int len) throws IOException {
        int result = -1;
        while (!streams.isEmpty()
                && (result = streams.getFirst().read(b, off, len)) == -1) {
            nextStream();
        }
        return result;
    }

    @Override
    public long skip(long n) throws IOException {
        long skipped = 0L;
        while (skipped < n && !streams.isEmpty()) {
            int thisSkip = streams.getFirst().skip(n - skipped);
            if (thisSkip > 0)
                skipped += thisSkip;
            else
                nextStream();
        }
        return skipped;
    }

    @Override
    public int available() throws IOException {
        return streams.isEmpty() ? 0 : streams.getFirst().available();
    }

    @Override
    public void close() throws IOException {
        while (!streams.isEmpty())
            nextStream();
    }
} 
```

此代码未经测试，因此您的里程可能会有所不同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T12:37:07.847

不是我能想到的。您可能必须将两个流的内容读入一个 byte[]，然后从中创建一个 ByteArrayInputStream。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-12T14:47:32.923

这是一个特定于字节数组的 MVar 实现（确保添加您自己的包定义）。从这里开始，在合并流上编写输入流是微不足道的。如果需要，我也可以发布。

```
import java.nio.ByteBuffer;

public final class MVar {

  private static enum State {
    EMPTY, ONE, MANY
  }

  private final Object lock;

  private State state;

  private byte b;

  private ByteBuffer bytes;
  private int length;

  public MVar() {
    lock = new Object();
    state = State.EMPTY;
  }

  public final void put(byte b) {
    synchronized (lock) {
      while (state != State.EMPTY) {
        try {
          lock.wait();
        } catch (InterruptedException e) {}
      }
      this.b = b;
      state = State.ONE;
      lock.notifyAll();
    }
  }

  public final void put(byte[] bytes, int offset, int length) {
    if (length == 0) {
      return;
    }
    synchronized (lock) {
      while (state != State.EMPTY) {
        try {
          lock.wait();
        } catch (InterruptedException e) {}
      }
      this.bytes = ByteBuffer.allocateDirect(length);
      this.bytes.put(bytes, offset, length);
      this.bytes.position(0);
      this.length = length;
      state = State.MANY;
      lock.notifyAll();
    }
  }

  public final byte take() {
    synchronized (lock) {
      while (state == State.EMPTY) {
        try {
          lock.wait();
        } catch (InterruptedException e) {}
      }
      switch (state) {
      case ONE: {
        state = State.EMPTY;
        byte b = this.b;
        lock.notifyAll();
        return b;
      }
      case MANY: {
        byte b = bytes.get();
        state = --length <= 0 ? State.EMPTY : State.MANY;
        lock.notifyAll();
        return b;
      }
      default:
        throw new AssertionError();
      }
    }
  }

  public final int take(byte[] bytes, int offset, int length) {
    if (length == 0) {
      return 0;
    }
    synchronized (lock) {
      while (state == State.EMPTY) {
        try {
          lock.wait();
        } catch (InterruptedException e) {}
      }
      switch (state) {
      case ONE:
        bytes[offset] = b;
        state = State.EMPTY;
        lock.notifyAll();
        return 1;
      case MANY:
        if (this.length > length) {
          this.bytes.get(bytes, offset, length);
          this.length = this.length - length;
          synchronized (lock) {
            lock.notifyAll();
          }
          return length;
        }
        this.bytes.get(bytes, offset, this.length);
        this.bytes = null;
        state = State.EMPTY;
        length = this.length;
        lock.notifyAll();
        return length;
      default:
        throw new AssertionError();
      }
    }
  }
} 
```

# c# - 序列化对于对象大小估计是否可靠？

> ID：760230
> 
> 赞同：2
> 
> 时间：2009-04-17T12:33:10.370
> 
> 标签：c#, memory, serialization, object

我使用序列化，以估计用于对象的内存量。我已经读过[这个](https://stackoverflow.com/questions/426396/how-much-memory-does-a-c-net-object-use)，还有[这个](https://stackoverflow.com/questions/26570/sizeof-equivalent-for-reference-types)。所以我知道使用分析器或 sizeof （对于值类型）可能会更好。

我想知道，序列化对象和内存中的对象之间的确切区别是什么？序列化在什么方面对对象大小估计是可靠的？

我对 C# 序列化机制特别感兴趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T12:45:35.550

数据的序列化形式与内存不同；例如，集合/字典将涉及项目、数组、散列桶/索引等的多个对象 - 但原始数据（序列化时）*通常*只是数据 - 所以序列化时您可能会看到更少的数量。

同样，诸如`BinaryFormatter`必须包含大量（详细）类型元数据之类的东西 - 但在对象中，它在对象句柄中只有一个（简洁）类型句柄 - 因此您可能会在序列化数据中看到*更多*数据。同样，序列化程序（除非它是手动优化的）需要标记各个字段 - 但在内存中，这隐含在对象地址的偏移量中。

所以你可能会从序列化中得到*一个*数字，但它不是**同一个**数字。

要准确了解对象图的大小是很棘手的。SOS 可能会有所帮助；否则，创建一个完整的卸载并划分它们。粗制滥造，但它可能只是工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T15:16:31.990

这是我用来估计托管类型的内存成本的函数。它假定对象是在内存中按顺序分配的（而不是从大对象堆中分配的），因此它不会为分配大量数组的对象提供准确的结果。它也不能绝对保证 GC 不会破坏答案，但这不太可能。

```
/// <summary>
/// Gets the memory cost of a reference type.
/// </summary>
/// <param name="type">The type for which to get the cost. It must have a
/// public parameterless constructor.</param>
/// <returns>The number of bytes occupied by a default-constructed
/// instance of the reference type, including any sub-objects it creates
/// during construction. Returns -1 if the type does not have a public
/// parameterless constructor.</returns>
public static int MemoryCost(Type type)
{
  // Make garbage collection very unlikely during the execution of this function
  GC.Collect();
  GC.WaitForPendingFinalizers();

  // Get the constructor and invoke it once to run JIT and any initialization code
  ConstructorInfo constr = type.GetConstructor(Type.EmptyTypes);
  if (constr == null)
    return -1;
  object inst1 = constr.Invoke(null); // 

  int size;
  unsafe
  {
    // Create marker arrays and an instance of the type
    int[] a1 = new int[1];
    int[] a2 = new int[1];
    object inst2 = constr.Invoke(null);
    int[] a3 = new int[1];

    // Compute the size by determining how much was allocated in between
    // the marker arrays.
    fixed (int* p1 = a1)
    {
      fixed (int* p2 = a2)
      {
        fixed (int* p3 = a3)
        {
          size = (int)(((long)p3 - (long)p2) - ((long)p2 - (long)p1));
        }
      }
    }
  }
  return size;
} 
```

# ruby-on-rails - 基于数组生成文件列表

> ID：760233
> 
> 赞同：2
> 
> 时间：2009-04-17T12:34:15.250
> 
> 标签：ruby-on-rails, ruby, list, acts-as-tree

我尝试了一些事情，但是这周我觉得我的大脑正在放假，我需要完成这件事..所以我希望有人能帮助我。

我需要根据保存到数据库中的哈希创建一个文件列表。看起来像这样：

```
['file1', 'dir1/file2', 'dir1/subdir1/file3'] 
```

输出应该是这样的：

*   文件 1
*   目录1

*   文件2
*   子目录1

*   文件 3

在html中，最好是这样（用js扩展它以折叠和多选）

```
<ul>
  <li>file1
  <li>dir1</li>
  <ul>
    <li>file2</li>
    <li>subdir1</li>
    <ul>
      <li>file3</li>
    </ul>
  </ul>
</ul> 
```

我正在使用 Ruby on Rails 并尝试在 RJS 模板中实现这一点。但这并不重要。您还可以帮助我提供一些详细的伪代码。

有人知道如何解决这个问题吗？

* * *

编辑

感谢大家提供这些解决方案。清单有效，我将其扩展为可折叠的解决方案来显示/隐藏目录内容。我仍然有一个问题：代码旨在在条目后面的复选框中包含完整的文件路径以进行同步。基于 sris 的解决方案，我只能读取当前文件及其子文件，但不能读取根目录的整个路径。为了更好地理解：

目前：

```
[x] dir1
    [x] dir2
        [x] file1 
```

给我

与文本显示的值相同的复选框，例如 [x] file1 的“file1”。但我需要的是完整路径，例如 [x] file1 的“dir1/dir2/file1”。

有人有另一个提示如何添加这个吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T13:04:18.827

这是一个快速实现，您可以从中获得灵感。此实现忽略输入数组中文件的顺序。

我已经更新了解决方案以根据您的需要保存整个路径。

```
dirs = ['file1', 'dir1/file2', 'dir1/subdir1/file3',  'dir1/subdir1/file5']
tree = {}

dirs.each do |path|
  current  = tree
  path.split("/").inject("") do |sub_path,dir|
    sub_path = File.join(sub_path, dir)
    current[sub_path] ||= {}
    current  = current[sub_path]
    sub_path
  end
end

def print_tree(prefix, node)
  puts "#{prefix}<ul>"
  node.each_pair do |path, subtree| 
    puts "#{prefix}  <li>[#{path[1..-1]}] #{File.basename(path)}</li>"    
    print_tree(prefix + "  ", subtree) unless subtree.empty?
  end
  puts "#{prefix}</ul>"
end

print_tree "", tree 
```

此代码将像您的示例一样生成正确缩进的 HTML。但由于 Ruby (1.8.6) 中的哈希没有排序，因此无法保证文件的顺序。

产生的输出将如下所示：

```
<ul>
  <li>[dir1] dir1</li>
  <ul>
    <li>[dir1/subdir1] subdir1</li>
    <ul>
      <li>[dir1/subdir1/file3] file3</li>
      <li>[dir1/subdir1/file5] file5</li>
    </ul>
    <li>[dir1/file2] file2</li>
  </ul>
  <li>[file1] file1</li>
</ul> 
```

我希望这可以作为如何获取路径和文件名的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T12:50:18.893

想想树。

```
 # setup phase
  for each pathname p in list
  do
     add_path_to_tree(p)
  od
  walk tree depth first, emitting HTML 
```

`add_path_to_tree`是递归的

```
 given pathname p
 parse p into first_element, rest
 # that is, "foo/bar/baz" becomes "foo", "bar/baz"
 add first_element to tree
 add_path_to_tree(rest) 
```

我将把树（列表列表）的最佳数据结构（列表列表）作为练习。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T13:19:51.037

扩展 sris 的答案，如果您真的想要对所有内容进行排序并在目录之前列出文件，您可以使用以下内容：

```
def files_first_traverse(prefix, node = {})
  puts "#{prefix}<ul>" 
  node_list = node.sort
  node_list.each do |base, subtree|
    puts "#{prefix}  <li>#{base}</li>" if subtree.empty?
  end
  node_list.each do |base, subtree|
    next if subtree.empty?
    puts "#{prefix}  <li>#{base}</li>"
    files_first_traverse(prefix + '  ', subtree)
  end
  puts '#{prefix}</ul>'
end 
```

# c++ - 无法编辑 CListCtrl 中的标签

> ID：760237
> 
> 赞同：3
> 
> 时间：2009-04-17T12:36:17.087
> 
> 标签：c++, visual-c++, mfc, mfc-feature-pack, clistctrl

我正在使用 MFC Feature Pack 构建一个项目。这个项目是否我有一个包含 的窗口`CView`，其中包含一个`CListCtrl`衍生对象。该对象包括`LVS_EDITLABELS`标志。

不知何故，我无法`CListCtrl`通过两次单击（不是双击）图标标签来编辑图标标签。在我通过单击选择项目后，第二次单击只会使项目闪烁（向下按钮将文本背景变为白色，向上按钮将其变为蓝色）并且编辑控件永远不会出现。

我将这个问题简化为最简单的形式，即使使用普通`CListCtrl`对象我也无法编辑标签。

我还发现：

*   这个问题出现在VS2008中。在VS2003内置的类似项目中不会出现这种情况。

*   如果我构建 a`CListView`而不是`CView`+ ，我可以编辑标签`CListCtrl`。

*   如果我构建一个`CFormView`并将其`CListCtrl`放入资源对话框中，我也可以编辑标签。

下面是一些最简单形式的代码：.h 文件：

```
// vwTerminaisTeste.h
//
#pragma once
// vwTerminaisTeste view

    class vwTerminaisTeste : public CView
{
    DECLARE_DYNCREATE(vwTerminaisTeste)

protected:
    vwTerminaisTeste();           // protected constructor used by dynamic creation
    virtual ~vwTerminaisTeste();

    CListCtrl m_lstTerminais;

protected:
    DECLARE_MESSAGE_MAP()
    virtual void OnDraw(CDC* /*pDC*/);
public:
    afx_msg int OnCreate(LPCREATESTRUCT lpCreateStruct);
    afx_msg void OnSize(UINT nType, int cx, int cy);
}; 
```

和 .cpp 文件：

```
// vwTerminaisTeste.cpp : implementation file
//

#include "stdafx.h"
#include "vwTerminaisTeste.h"

// vwTerminaisTeste

IMPLEMENT_DYNCREATE(vwTerminaisTeste, CView)
vwTerminaisTeste::vwTerminaisTeste()
{
}

vwTerminaisTeste::~vwTerminaisTeste()
{
}

BEGIN_MESSAGE_MAP(vwTerminaisTeste, CView)
    ON_WM_CREATE()
    ON_WM_SIZE()
END_MESSAGE_MAP()

// vwTerminaisTeste message handlers

void vwTerminaisTeste::OnDraw(CDC* /*pDC*/)
{
    CDocument* pDoc = GetDocument();
}

int vwTerminaisTeste::OnCreate(LPCREATESTRUCT lpCreateStruct)
{
    if (CView::OnCreate(lpCreateStruct) == -1)
        return -1;

    m_lstTerminais.Create(WS_CHILD | WS_VISIBLE | LVS_EDITLABELS, CRect(0,0,1,1), this, 0);
    m_lstTerminais.InsertItem(0, "Teste", 0);

    return 0;
}

void vwTerminaisTeste::OnSize(UINT nType, int cx, int cy)
{
    CView::OnSize(nType, cx, cy);

    if (IsWindow(m_lstTerminais.GetSafeHwnd()))
        m_lstTerminais.MoveWindow(0, 0, cx, cy);
} 
```

这样我就无法编辑标签。要将其更改为，`CListView`我只需将其替换`CView`为`CListView`and `m_lstTerminais`by `GetListCtrl()`，并删除`OnCreate`and`OnSize`实现。这样它就起作用了。

注意：`vwTerminaisTeste`是从 -派生类中创建`CSplitterWndEx`的。`CMDIChildWndEx`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T12:11:57.077

这听起来可能是焦点或命令路由问题，尽管这并不能解释为什么它在 VS2003 中可以正常工作。您可以尝试将命令和/或焦点消息从拆分器 ctrl 路由到 vwTerminaisTeste，和/或从 MDIChild 到拆分器。如果您还没有，您可能需要派生自己的拆分器窗口。命令/焦点转发将类似于...

```
BEGIN_MESSAGE_MAP(MySplitter, CSplitterWnd)
  ON_WM_SETFOCUS()
END_MESSAGE_MAP(...)

void MySplitter::OnSetFocus(CWnd* pOldWnd)
{
  // forward focus to the view window
  m_vwTerminaisTeste.SetFocus();
}

BOOL MySplitter::OnCmdMsg(UINT nID, int nCode, void* pExtra, AFX_CMDHANDLERINFO* pHandlerInfo)
{
  // let the view have first crack at the command
  if (m_vwTerminaisTeste.OnCmdMsg(nID, nCode, pExtra, pHandlerInfo))
    return TRUE;

  // otherwise, do default handling
  return MySplitter::OnCmdMsg(nID, nCode, pExtra, pHandlerInfo);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T12:20:47.667

好吧，没有人解决这个问题，但我设法通过将 CView 更改为 CFormView 并使用 ListView 控件构建资源对话框，将其附加到 CListCtrl 派生类来解决它。

如果有人仍然对我如何完全解决这个问题有任何建议，我将不胜感激。

# asp.net-mvc - 使用 JSON、JQuery 将复杂对象数组发布到 ASP.NET MVC 控制器

> ID：760249
> 
> 赞同：4
> 
> 时间：2009-04-17T12:40:20.087
> 
> 标签：asp.net-mvc, json, jquery

我知道这个问题之前已经提到过，例如在这里：

[如何使用 JSON、jQuery 将一组复杂对象发布到 ASP.NET MVC 控制器？](https://stackoverflow.com/questions/320291/how-to-post-an-array-of-complex-objects-with-json-jquery-to-asp-net-mvc-controll)

但解决方案似乎不适合我的问题。

这是我的 HTML。行数是可变的：

```
 <table id="workPlanTable">
    <tr>
        <th>
            Begin
        </th>
        <th>
            End
        </th>
    </tr>

    <tr itemId="1">
        <td><input class="begin" id="begin_1" name="begin_1" type="text" value="5:30" /></td>
        <td><input class="end" id="end_1" name="end_1" type="text" value="11:30" /></td>
    </tr>
    <tr itemId="3">
        <td><input class="begin" id="begin_3" name="begin_3" type="text" value="5:30" /></td>
        <td><input class="end" id="end_3" name="end_3" type="text" value="7:30" /></td>
    </tr>

</table> 
```

JS 构建一个对象数组并将它们发布到一个控制方法：

```
<script type="text/javascript">
$(function() {

  submitForm = function() {
    var items = new Array();
    $("#workPlanTable tr").each(function(i) {
      var end = $(this).find(".end").val();
      var begin = $(this).find(".begin").val();
      var item = {
        "Begin": begin,
        "End": end
      };
      items.push(item);

    });
    var postData = {
      myItems: items
    };

    $.ajax({
      url: '~/WorkPlan/AjaxUpdate',
      type: 'POST',
      dataType: 'json',
      data: postData,
      contentType: 'application/json; charset=utf-8',
      success: function(result) {
        alert(result.Result);
      }
    });
  }
})
</script> 
```

每行代表一个 WorkPlanItem。

我的目标是将它们全部发布到我的控制器以更新它们。

我似乎无法弄清楚如何在我的控制器方法（AjaxUpdate）中访问数组。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-17T17:09:08.833

您可以按照[Vikas 发布](https://stackoverflow.com/questions/760249/post-an-array-of-complex-objects-with-json-jquery-to-asp-net-mvc-controller/760384#760384)的形式序列化表单，或者如果您希望浏览页面（如您当前所做的那样）并使用数组，则可以使用`stringify` [函数。](https://github.com/douglascrockford/JSON-js/blob/master/json2.js)`postData`

在控制器上，您需要处理 json 字符串。您可以使用`System.Web.Script.Serialization.JavaScriptSerializer` [该类](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx)对其进行反序列化。如果您有一个映射到您正在传递的数据的对象，则可以使用[Deserialize](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx)方法。如果你不这样做，你仍然可以使用[DeserializeObject](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.deserializeobject.aspx)，但是这会为你提供一个`Dictionary<string, string>`你必须遍历才能获取数据的集合。不是很有趣（相信我），但它确实有效。

# java - 创建一个战争文件

> ID：760252
> 
> 赞同：1
> 
> 时间：2009-04-17T12:40:39.337
> 
> 标签：java, ant

我想为项目创建一个战争文件。该代码适用于创建 jar 文件。当我运行以下 ant`build.xml`时，它仍然会给出消息 jar 文件 BUILD SUCCESSFULL。

```
<project name="struts-spring" basedir="../" default="all">
    <!-- Project settings -->
    <property name="project.title" value="Sufalam Struts 2 Tutorials"/>
    <property name="project.jar.file" value="struts-spring.jar"/>

      <path id="class.path">

        <fileset dir="lib">

          <include name="**/*.jar"/>

        </fileset>

        <fileset dir="libext">

          <include name="**/*.jar"/>

        </fileset>

      </path>

        <!-- Classpath for Project -->

        <path id="compile.classpath">

            <pathelement path ="lib/commons-beanutils.jar"/>

            <pathelement path ="lib/commons-digester.jar"/>

            <pathelement path ="lib/struts.jar"/>

            <pathelement path ="libext/servlet-api.jar"/>

            <pathelement path ="libext/catalina-ant.jar"/>

            <pathelement path ="classes"/>

            <pathelement path ="${classpath}"/>

        </path>

        <!-- Check timestamp on files -->

        <target name="prepare">

            <tstamp/>
            <copy
                file="src/struts.xml"
                todir="src/classes"/>

        </target>
        <!-- Copy any resource or configuration files -->

        <target name="resources">

            <copy todir="classes" includeEmptyDirs="no">

                <fileset dir="src/java">

                <patternset>

                    <include name="**/*.conf"/>

                    <include name="**/*.properties"/>

                    <include name="**/*.xml"/>

                </patternset>

                </fileset>

            </copy>

        </target>

        <!-- Normal build of application -->

        <target name="compile" depends="prepare,resources">

            <javac srcdir="src" destdir="classes" 
                         debug="true" debuglevel="lines,vars,source">

                <classpath refid="class.path"/>

            </javac>

            <jar

            jarfile="lib/${project.jar.file}"

            basedir="classes"/>

        </target>
        <!-- Remove classes directory for clean build -->

        <target name="clean"

          description="Prepare for clean build">

          <delete dir="classes"/>

          <mkdir  dir="classes"/>

        </target>

        <!-- Build Javadoc documentation -->

        <target name="javadoc"

         description="Generate JavaDoc API docs">

            <delete dir="./doc/api"/>

            <mkdir dir="./doc/api"/>

            <javadoc sourcepath="./src/java"

                destdir="./doc/api"

                classpath="${servlet.jar}:${jdbc20ext.jar}"

                packagenames="*"

                author="true"

                private="true"

                version="true"

                windowtitle="${project.title} API Documentation"

                doctitle="&lt;h1&gt;${project.title}
                          Documentation (Version ${project.version})&lt;/h1&gt;"

                bottom="Copyright &#169; 2002">

                <classpath refid="compile.classpath"/>

            </javadoc>

        </target>

        <!-- Build entire project -->

        <target name="project" depends="clean,prepare,compile"/>

        <!-- Create binary distribution -->

        <target name="dist"

            description="Create binary distribution">

          <mkdir

            dir="${distpath.project}"/>

<!--          <jar

            jarfile="${distpath.project}/${project.distname}.jar"

            basedir="./classes"/>

          <copy

            file="${distpath.project}/${project.distname}.jar"

            todir="${distpath.project}"/>-->

          <war

            basedir="../"

            warfile="${distpath.project}/${project.distname}.war"

            webxml="web.xml"> </war>

            <copy file="${distpath.project}/${project.distname}.war"    todir="${distpath.project}"/>

            <!--<exclude name="${distpath.project}/${project.distname}.war"/>-->

    </target>

    <!-- Build project and create distribution-->
    <target name="all" depends="project"/>
</project> 
```

请帮我创建一个战争文件。提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T12:46:58.917

我没有看到您告诉战争任务要将哪些文件放入战争文件中。您可能想查看[此处](http://ant.apache.org/manual/Tasks/war.html)的示例。我认为 Ant 有很棒的文档。

以下是使用上述链接中的战争任务的示例：

```
<war destfile="myapp.war" webxml="src/metadata/myapp.xml">
  <fileset dir="src/html/myapp"/>
  <fileset dir="src/jsp/myapp"/>
  <lib dir="thirdparty/libs">
    <exclude name="jdbc1.jar"/>
  </lib>
  <classes dir="build/main"/>
  <zipfileset dir="src/graphics/images/gifs"
          prefix="images"/>
</war> 
```

# asp.net-mvc - 如何全球化 ASP.NET MVC 视图（特别是小数分隔符）？

> ID：760258
> 
> 赞同：5
> 
> 时间：2009-04-17T12:43:12.297
> 
> 标签：asp.net-mvc, globalization

我正在使用[NerdDinner](http://www.nerddinner.com/)示例[应用程序](http://tinyurl.com/aspnetmvc)并到达处理虚拟地球地图的部分。应用程序存储一些经度和纬度值。不幸的是，在我的系统上，浮点数是用逗号作为小数点分隔符存储的，而不是像美国那样的点。因此，如果我的纬度为 47.64，它将被检索并显示为 47,64。因为该值在函数调用中传递给 Virtual Earth API，所以它在该点失败（例如 JavaScript API 需要*47.64, -122.13*，但得到*47,64, -122,13*）。

我需要确保应用程序始终使用点。在 WebForms 应用程序中，我将拥有一个覆盖该`System.Web.UI.Page.InitializeCulture()`方法的通用类，并且我将从该类继承我的页面。

我不确定如何对 MVC 做同样的事情。我需要定制`ViewPage`还是什么？有没有**简单**的方法来解决这个问题？例子？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T12:24:48.983

因为设置`<globalization/>`为 en-US 根本没有帮助，所以我决定创建一个自定义类来初始化正确的文化设置，并确保所有需要这种行为的视图都继承自我的自定义类。

**NerdDinnerViewPage.cs：**

```
using System.Globalization;
using System.Threading;
using System.Web.Mvc;

namespace NerdDinner.Views
{
    public class NerdDinnerViewPage<T> : ViewPage<T> where T : class
    {
        protected override void InitializeCulture()
        {
            base.InitializeCulture();

            Thread.CurrentThread.CurrentCulture = Thread.CurrentThread.CurrentCulture.Clone() as CultureInfo;

            if (Thread.CurrentThread.CurrentCulture != null)
            {
                Thread.CurrentThread.CurrentCulture.NumberFormat.CurrencyDecimalSeparator = ".";
                Thread.CurrentThread.CurrentCulture.NumberFormat.NumberDecimalSeparator = ".";
            }
        }
    }
} 
```

**编辑.aspx：**

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="NerdDinner.Views.NerdDinnerViewPage<NerdDinner.Models.DinnerFormViewModel>" %> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-15T10:45:59.507

我是一名丹麦开发人员，面临着完全相同的问题。我找到了 Kristof Neirynck 在他的开发博客上描述的一个可行的解决方案：

[自定义模型绑定器](http://www.crydust.be/blog/2009/07/30/custom-model-binder-to-avoid-decimal-separator-problems/)

最好的问候， Finn Vilsbaek

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T16:04:09.317

当你说

> 在我的系统上，浮点数以逗号作为小数分隔符存储

我假设您的意思是它们用逗号*格式化*，浮点数存储为`float`.

虽然您可以通过设置文化来解决格式问题，但“真正的”解决方法是更改​​代码。好的，这不是您的代码，所以也许您不想在这种情况下这样做，但作为一般参考，您需要确保在格式化浮点数或其他任何内容时使用适当的文化。在格式化数字以供 API 使用的情况下，您将使用 InvariantCulture。

即在使用 string.Format(...) 时使用`foo.ToString(CultureInfo.InvariantCulture)`代替和同样。`foo.ToString()`

**编辑**我刚刚查看了 NerdDinner 代码并意识到这个错误出现在 Javascript 而不是 C# 中，所以我上面的代码没有帮助。我不知道是否可以在 Javascript 中格式化数字，但我认为真正的解决方案是修复模型代码以返回格式正确的字符串。

**编辑 2**我建议您尝试以下操作：在更改`SearchController.cs`和`Latitude`更改为. IE`Longitude``JsonDinner``strings`

```
public class JsonDinner {
    public int      DinnerID    { get; set; }
    public string   Title       { get; set; }
    public string   Latitude    { get; set; }
    public string   Longitude   { get; set; }
    public string   Description { get; set; }
    public int      RSVPCount   { get; set; }
} 
```

然后向下滚动到 SearchByLocation 方法并更改 Lat/Long 行以正确格式化 JavaScript 的字符串：

```
Latitude = dinner.Latitude.ToString(CultureInfo.InvariantCulture),
Longitude = dinner.Longitude.ToString(CultureInfo.InvariantCulture), 
```

这应该意味着您不需要您输入的修复程序，并且应该解决您的其他问题......我将在哪里发表评论。希望这会有所帮助，因为我不在您的语言环境中，所以我还没有完全测试过，但它似乎确实有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-24T10:25:14.793

我在模板编辑器中使用了一个简单的快速修复。我的应用程序只使用瑞典语（逗号作为小数分隔符），所以它是一个字符串。替换但你当然可以让它了解多种文化。

在我的 Views/Shared/EditorTemplates/Decimal.ascx 中：

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-23T12:50:49.257

我在 JavaScript 端修复了这个问题，确保传入地图库的内容使用点 (.)，而填充回文本框的内容使用逗号 (,)。显然，这不是为了本地化，而是快速修复。

**callbackForLocation 中的Map.js**：

```
//If we've found exactly one place, that's our address.
if (points.length === 1) {
    $("#Latitude").val(points[0].Latitude.toString().replace('.', ','));
    $("#Longitude").val(points[0].Longitude.toString().replace('.', ','));
} 
```

**jquery-ready() 中的**Map.ascx ：****

 **```
 var latitude = <%=Model.Latitude.ToString().Replace(',', '.')%>;
    var longitude = <%=Model.Longitude.ToString().Replace(',', '.')%>; 
```

# .net - XmlSerializer：删除不必要的 xsi 和 xsd 命名空间

> ID：760262
> 
> 赞同：144
> 
> 时间：2009-04-17T12:44:21.950
> 
> 标签：.net, xml, xml-serialization

有没有办法配置 XmlSerializer 使其不在根元素中写入默认命名空间？

我得到的是：

```
<?xml ...>
<rootelement xmlns:xsi="..." xmlns:xsd="...">
</rootelement> 
```

我想删除两个 xmlns 声明。

**重复**：[如何在不获取 xmlns="..." 的情况下将对象序列化为 XML？](https://stackoverflow.com/questions/258960)

* * *

## 回答 #1

> 赞同：277
> 
> 时间：2009-04-17T12:52:23.147

```
//Create our own namespaces for the output
XmlSerializerNamespaces ns = new XmlSerializerNamespaces();

//Add an empty namespace and empty value
ns.Add("", "");

//Create the serializer
XmlSerializer slz = new XmlSerializer(someType);

//Serialize the object with our own namespaces (notice the overload)
slz.Serialize(myXmlTextWriter, someObject, ns) 
```

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2012-06-21T12:33:44.953

由于 Dave 要求我重复我对[Omitting all xsi and xsd namespaces when serializing an object in .NET](https://stackoverflow.com/a/11129732/1470649)的回答，我已经更新了这篇文章，并从上述链接中重复了我的回答。此答案中使用的示例与其他问题中使用的示例相同。以下内容是逐字复制的。

* * *

在网上阅读了微软的文档和几个解决方案后，我发现了这个问题的解决方案。它适用于内置`XmlSerializer`和自定义 XML 序列化（通过`IXmlSerialiazble`.

顺便说一句，我将使用`MyTypeWithNamespaces`迄今为止在此问题的答案中使用的相同 XML 示例。

```
[XmlRoot("MyTypeWithNamespaces", Namespace="urn:Abracadabra", IsNullable=false)]
public class MyTypeWithNamespaces
{
    // As noted below, per Microsoft's documentation, if the class exposes a public
    // member of type XmlSerializerNamespaces decorated with the 
    // XmlNamespacesDeclarationAttribute, then the XmlSerializer will utilize those
    // namespaces during serialization.
    public MyTypeWithNamespaces( )
    {
        this._namespaces = new XmlSerializerNamespaces(new XmlQualifiedName[] {
            // Don't do this!! Microsoft's documentation explicitly says it's not supported.
            // It doesn't throw any exceptions, but in my testing, it didn't always work.

            // new XmlQualifiedName(string.Empty, string.Empty),  // And don't do this:
            // new XmlQualifiedName("", "")

            // DO THIS:
            new XmlQualifiedName(string.Empty, "urn:Abracadabra") // Default Namespace
            // Add any other namespaces, with prefixes, here.
        });
    }

    // If you have other constructors, make sure to call the default constructor.
    public MyTypeWithNamespaces(string label, int epoch) : this( )
    {
        this._label = label;
        this._epoch = epoch;
    }

    // An element with a declared namespace different than the namespace
    // of the enclosing type.
    [XmlElement(Namespace="urn:Whoohoo")]
    public string Label
    {
        get { return this._label; }
        set { this._label = value; }
    }
    private string _label;

    // An element whose tag will be the same name as the property name.
    // Also, this element will inherit the namespace of the enclosing type.
    public int Epoch
    {
        get { return this._epoch; }
        set { this._epoch = value; }
    }
    private int _epoch;

    // Per Microsoft's documentation, you can add some public member that
    // returns a XmlSerializerNamespaces object. They use a public field,
    // but that's sloppy. So I'll use a private backed-field with a public
    // getter property. Also, per the documentation, for this to work with
    // the XmlSerializer, decorate it with the XmlNamespaceDeclarations
    // attribute.
    [XmlNamespaceDeclarations]
    public XmlSerializerNamespaces Namespaces
    {
        get { return this._namespaces; }
    }
    private XmlSerializerNamespaces _namespaces;
} 
```

这就是这堂课的全部内容。现在，有些人反对`XmlSerializerNamespaces`在他们的类中的某个地方有一个对象。但正如您所看到的，我巧妙地将其隐藏在默认构造函数中，并公开了一个公共属性以返回命名空间。

现在，当需要序列化类时，您将使用以下代码：

```
MyTypeWithNamespaces myType = new MyTypeWithNamespaces("myLabel", 42);

/******
   OK, I just figured I could do this to make the code shorter, so I commented out the
   below and replaced it with what follows:

// You have to use this constructor in order for the root element to have the right namespaces.
// If you need to do custom serialization of inner objects, you can use a shortened constructor.
XmlSerializer xs = new XmlSerializer(typeof(MyTypeWithNamespaces), new XmlAttributeOverrides(),
    new Type[]{}, new XmlRootAttribute("MyTypeWithNamespaces"), "urn:Abracadabra");

******/

/*****
  Per @dbc, since MyTypeWithNamespaces has a XmlRootAttribute decorating the class,
  You may be able to get away with NOT using this .ctor and use the simple
  XmlSerializer(Type) .ctor.
  Also, be careful not to use serializer creation in loops, as it could lead
  to extensive memory issues due to how serializers are cached (or not...).
  See @dbc's comment and link to SO Q&A for more details.

XmlSerializer xs = new XmlSerializer(typeof(MyTypeWithNamespaces),
    new XmlRootAttribute("MyTypeWithNamespaces") { Namespace="urn:Abracadabra" });
****/
XmlSerializer xs = new XmlSerializer(typeof(MyTypeWithNamespaces));

// I'll use a MemoryStream as my backing store.
MemoryStream ms = new MemoryStream();

// This is extra! If you want to change the settings for the XmlSerializer, you have to create
// a separate XmlWriterSettings object and use the XmlTextWriter.Create(...) factory method.
// So, in this case, I want to omit the XML declaration.
XmlWriterSettings xws = new XmlWriterSettings();
xws.OmitXmlDeclaration = true;
xws.Encoding = Encoding.UTF8; // This is probably the default
// You could use the XmlWriterSetting to set indenting and new line options, but the
// XmlTextWriter class has a much easier method to accomplish that.

// The factory method returns a XmlWriter, not a XmlTextWriter, so cast it.
XmlTextWriter xtw = (XmlTextWriter)XmlTextWriter.Create(ms, xws);
// Then we can set our indenting options (this is, of course, optional).
xtw.Formatting = Formatting.Indented;

// Now serialize our object.
xs.Serialize(xtw, myType, myType.Namespaces); 
```

完成此操作后，您应该得到以下输出：

```
<MyTypeWithNamespaces>
    <Label xmlns="urn:Whoohoo">myLabel</Label>
    <Epoch>42</Epoch>
</MyTypeWithNamespaces> 
```

我在最近的一个项目中成功地使用了这种方法，其中包含一系列被序列化为 XML 以用于 Web 服务调用的类。Microsoft 的文档并不清楚`XmlSerializerNamespaces`一旦创建了可公开访问的成员后如何处理它，因此许多人认为它没有用。但是通过遵循他们的文档并以上面显示的方式使用它，您可以自定义 XmlSerializer 如何为您的类生成 XML，而无需诉诸不受支持的行为或通过实现`IXmlSerializable`.

我希望这个答案能够一劳永逸地解决如何`xsi`摆脱`xsd`由`XmlSerializer`.

更新：我只是想确保我回答了 OP 关于删除所有命名空间的问题。我上面的代码将为此工作；让我来告诉你怎么做。现在，在上面的示例中，您确实无法摆脱所有名称空间（因为有两个名称空间在使用中）。在您的 XML 文档的某个地方，您将需要有类似`xmlns="urn:Abracadabra" xmlns:w="urn:Whoohoo`. 如果示例中的类是较大文档的一部分，则必须在命名空间上方的某处为 和 之一（或两者）`Abracadbra`声明`Whoohoo`。如果没有，那么一个或两个命名空间中的元素必须用某种前缀修饰（你不能有两个默认命名空间，对吧？）。所以，对于这个例子，`Abracadabra`是默认命名空间。我可以在我的`MyTypeWithNamespaces`类中为命名空间添加一个命名空间前缀，`Whoohoo`如下所示：

```
public MyTypeWithNamespaces
{
    this._namespaces = new XmlSerializerNamespaces(new XmlQualifiedName[] {
        new XmlQualifiedName(string.Empty, "urn:Abracadabra"), // Default Namespace
        new XmlQualifiedName("w", "urn:Whoohoo")
    });
} 
```

现在，在我的类定义中，我指出该`<Label/>`元素在 namespace`"urn:Whoohoo"`中，所以我不需要做任何进一步的事情。当我现在使用上面的序列化代码序列化类时，输出如下：

```
<MyTypeWithNamespaces xmlns:w="urn:Whoohoo">
    <w:Label>myLabel</w:Label>
    <Epoch>42</Epoch>
</MyTypeWithNamespaces> 
```

因为`<Label>`它与文档的其余部分位于不同的命名空间中，所以它必须以某种方式用命名空间“装饰”。请注意，仍然没有`xsi`和`xsd`命名空间。

* * *

这结束了我对另一个问题的回答。但我想确保我回答了 OP 关于不使用名称空间的问题，因为我觉得我还没有真正解决它。假设它`<Label>`与文档的其余部分属于同一命名空间，在这种情况下`urn:Abracadabra`：

```
<MyTypeWithNamespaces>
    <Label>myLabel<Label>
    <Epoch>42</Epoch>
</MyTypeWithNamespaces> 
```

您的构造函数看起来就像在我的第一个代码示例中一样，以及用于检索默认命名空间的公共属性：

```
// As noted below, per Microsoft's documentation, if the class exposes a public
// member of type XmlSerializerNamespaces decorated with the 
// XmlNamespacesDeclarationAttribute, then the XmlSerializer will utilize those
// namespaces during serialization.
public MyTypeWithNamespaces( )
{
    this._namespaces = new XmlSerializerNamespaces(new XmlQualifiedName[] {
        new XmlQualifiedName(string.Empty, "urn:Abracadabra") // Default Namespace
    });
}

[XmlNamespaceDeclarations]
public XmlSerializerNamespaces Namespaces
{
    get { return this._namespaces; }
}
private XmlSerializerNamespaces _namespaces; 
```

然后，稍后，在您使用该`MyTypeWithNamespaces`对象序列化它的代码中，您可以像我上面那样调用它：

```
MyTypeWithNamespaces myType = new MyTypeWithNamespaces("myLabel", 42);

XmlSerializer xs = new XmlSerializer(typeof(MyTypeWithNamespaces),
    new XmlRootAttribute("MyTypeWithNamespaces") { Namespace="urn:Abracadabra" });

...

// Above, you'd setup your XmlTextWriter.

// Now serialize our object.
xs.Serialize(xtw, myType, myType.Namespaces); 
```

并且`XmlSerializer`会吐出与上面所示相同的 XML，输出中没有额外的命名空间：

```
<MyTypeWithNamespaces>
    <Label>myLabel<Label>
    <Epoch>42</Epoch>
</MyTypeWithNamespaces> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-18T22:16:26.803

还有一种替代方法 - 您可以在要序列化的类型中提供[XmlSerializerNamespaces类型的成员。](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializernamespaces.aspx)[用XmlNamespaceDeclarations](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlnamespacedeclarationsattribute.aspx)属性装饰它。将命名空间前缀和 URI 添加到该成员。然后，任何未显式提供 XmlSerializerNamespaces 的序列化都将使用您放入类型中的命名空间前缀+URI 对。

示例代码，假设这是您的类型：

```
[XmlRoot(Namespace = "urn:mycompany.2009")]
public class Person {
  [XmlAttribute] 
  public bool Known;
  [XmlElement]
  public string Name;
  [XmlNamespaceDeclarations]
  public XmlSerializerNamespaces xmlns;
} 
```

你可以这样做：

```
var p = new Person
  { 
      Name = "Charley",
      Known = false, 
      xmlns = new XmlSerializerNamespaces()
  }
p.xmlns.Add("",""); // default namespace is emoty
p.xmlns.Add("c", "urn:mycompany.2009"); 
```

这意味着该实例的任何未指定其自己的一组前缀+URI 对的序列化都将使用“urn:mycompany.2009”命名空间的“p”前缀。它还将省略 xsi 和 xsd 命名空间。

这里的区别在于您将 XmlSerializerNamespaces 添加到类型本身，而不是在调用 XmlSerializer.Serialize() 时显式使用它。这意味着，如果您的类型的实例由您不拥有的代码序列化（例如在 web 服务堆栈中），并且该代码未显式提供 XmlSerializerNamespaces，则该序列化程序将使用实例中提供的命名空间。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2020-03-12T13:20:37.163

我正在使用：

```
public class Person
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
}

class Program
{
    static void Main(string[] args)
    {
        const string DEFAULT_NAMESPACE = "http://www.something.org/schema";
        var serializer = new XmlSerializer(typeof(Person), DEFAULT_NAMESPACE);
        var namespaces = new XmlSerializerNamespaces();
        namespaces.Add("", DEFAULT_NAMESPACE);

        using (var stream = new MemoryStream())
        {
            var someone = new Person
            {
                FirstName = "Donald",
                LastName = "Duck"
            };
            serializer.Serialize(stream, someone, namespaces);
            stream.Position = 0;
            using (var reader = new StreamReader(stream))
            {
                Console.WriteLine(reader.ReadToEnd());
            }
        }
    }
} 
```

要获取以下 XML：

```
<?xml version="1.0"?>
<Person xmlns="http://www.something.org/schema">
  <FirstName>Donald</FirstName>
  <LastName>Duck</LastName>
</Person> 
```

如果您不想要命名空间，只需将 DEFAULT_NAMESPACE 设置为“”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-03-25T06:24:06.270

我知道它很脏，但它对我来说很重要，只是使用正则表达式来摆脱垃圾。我只是不想要任何 xmlns 的东西，想要像普通 JSON 一样对待 XML。其他的回答太仪式感了。

所以在序列化对象之后，我这样做：

```
string xml = "<string xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\">Hello, world!</string>";
xml = Regex.Replace(x, @" xmlns:.*?"".*?""", ""); 
```

# genetic-algorithm - 近交系数/莱特算法/遗传学

> ID：760265
> 
> 赞同：6
> 
> 时间：2009-04-17T12:46:35.220
> 
> 标签：genetic-algorithm, genealogy

我正在寻找一个好的伪代码 - 或者更好的实际代码片段 - 在我为存储在 SQL Server 数据库中的绵羊的家谱数据库上实现 wrights 算法。

我有一个非常古老的 C 程序，它针对一个平面文本文件工作，直到人口变得如此之大，算法崩溃了——因为整个事情都是在内存中完成的，所以对数据库的实现会更好......

任何人都看到过这样的事情，他们可以指点我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-30T15:11:45.467

如果你不想自己动手，你可以使用 Python [pypedal 包](https://github.com/wintermind/pypedal)来[计算近亲繁殖系数](http://pypedal.sourceforge.net/manual/node52.html)，它[支持 SQL 数据库](http://pypedal.sourceforge.net/manual/node47.html)。

Pypedal 计算近亲繁殖系数的代码在[这里](https://github.com/wintermind/pypedal/blob/master/PyPedal/pyp_metrics.py)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-11-05T16:57:50.183

在家谱中，我们将其称为[关系系数](https://blobswai.blob.core.windows.net/gfg-software/report_family_tree.html)（COR）。[在GitHub 上](https://github.com/waigitdas/Neo4j-Genealogy-PlugIns/blob/main/java%20classes/rel/coefficient_of_relationship.java)有一些为 Neo4j 插件设计的 Java 代码；它在那里调用其他功能。它使用个体到共同祖先之间的路径长度来计算 COR。通过近亲繁殖，有多个共同的祖先和“谱系崩溃”，这也更容易对图表进行 svg 可视化。

# wcf - 在 WCF 服务中公开自定义复杂接口类型的问题

> ID：760270
> 
> 赞同：0
> 
> 时间：2009-04-17T12:47:33.643
> 
> 标签：wcf, wcf-binding, wcf-client

我正在尝试使用 WCF 从另一个应用程序中获取对象。使用内置类它可以正常工作，但是在尝试从 WCF 操作返回自定义接口类型时遇到了问题。

无论我在两个应用程序中分别包含接口，还是将其指定为共享程序集，我都会得到相同的结果：带有消息“从管道读取错误：无法识别的错误 109”的 CommunicationException。

界面如下所示：

```
[ServiceContract]
public interface IBase {
    int IntTest {
        [OperationContract]
        get;
    }
    String StringTest {
        [OperationContract]
        get;
    }
    IOther OtherTest {
        [OperationContract]
        get;
    }
}

[ServiceContract]
public interface IOther {
    String StringTest {
        [OperationContract]
        get;
    }
} 
```

我的服务器如下所示：

```
public partial class MainWindow : Window {
    private Base fb;
    private ServiceHost host;

    public MainWindow() {
        InitializeComponent();
        fb = new Base();
        host = new ServiceHost(fb, new Uri[] { new Uri("net.pipe://localhost") });
        host.AddServiceEndpoint(typeof(IBase), new NetNamedPipeBinding(),
            "PipeReverse");
        host.Open();
    }

    private void Window_Closing(object sender, CancelEventArgs e) {
        host.Close();
    }
} 
```

这是我的接口实现：

```
[Serializable]
[ServiceBehavior(InstanceContextMode=InstanceContextMode.Single)]
public class Base : MarshalByRefObject, IBase {
    public int IntTest {
        get { return 4; }
    }

    public string StringTest {
        get { return "A string from Base"; }
    }

    public IOther OtherTest {
        get { return new Other(); }
    }
}

[Serializable]
[DataContract]
public class Other : MarshalByRefObject, IOther {
    [DataMember]
    public string StringTest {
        get { return "A string from Other"; }
    }

} 
```

客户端看起来像这样：

```
public partial class Form1 : Form {

    IBase obj;

    public Form1() {
        InitializeComponent();
        ChannelFactory<IBase> pipeFactory = new ChannelFactory<IBase>(
            new NetNamedPipeBinding(), new EndpointAddress(
            "net.pipe://localhost/PipeReverse"));

        obj = pipeFactory.CreateChannel();
    }

    private void button2_Click(object sender, EventArgs e) {

        Console.WriteLine("Returns: " + obj.StringTest + " " + 
            obj.StringTest.Length);
        Console.WriteLine("Returns: " + obj.IntTest);
        Console.WriteLine(obj.OtherTest);

    }
} 
```

除了这一行之外，一切都像魅力一样：

```
Console.WriteLine(obj.OtherTest); 
```

它给了我一个 CommunicationException 消息“从管道读取错误：无法识别的错误 109”。据我所知，这是由于故障状态导致的管道损坏，但我不知道为什么，或者更重要的是如何修复它。有任何想法吗？

我没有配置文件，因为上面的代码中已经完成了所有操作，所以我不知道如何打开跟踪，否则我也会包含它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-18T15:43:34.803

返回的属性**OtherTest**需要是具体类型而不是接口，否则序列化将不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-18T12:24:44.670

这通常是一个序列化错误。查看 [KnownType] 属性。测试这一点的最简单方法是直接调用 DataContractSerializer。您可以使用它的 WriteObject 和 ReadObject 方法来获取真正的序列化错误。您还可以检查流（通常是 FileStream）以确保您正确键入序列化。

# jquery - 如何在使用 ajax 和 JQuery 时加密发布数据？

> ID：760273
> 
> 赞同：3
> 
> 时间：2009-04-17T12:48:34.013
> 
> 标签：jquery, asp.net-mvc

服务器端我们可以对用户进行身份验证，但是当 ajax 或 JQuery 发送数据时我想要数据的安全性。就像在客户端一样，有人只能以加密格式查看任何调用的参数。那么我该怎么做。我在这个网站上看到过这种情况。

**编辑**

当数据来自服务器时，我们可以忽略加密数据。但至少在发送时它是必需的。**在您的偏好**设置中查看此站点上的示例以设置通知复选框。可以通过在 Mozilla firefox 中使用 firebug 插件来观看请求。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-17T12:55:09.897

你不能。

如果浏览器（即 JavaScript）应该读取/使用这些值，它们必须是明文。你可能想出的任何加密/加扰方案都会被固有地破坏，因为 JavaScript 本身必须能够解密/解扰数据，因此任何具有中等智慧的人都可以访问源代码将能够弄清楚。

您可以执行 SSL 请求来加密服务器连接，对第三方隐藏数据。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-17T13:02:33.137

您可以使用一些库来加密数据，例如[http://home.versatel.nl/MAvanEverdingen/Code/](http://home.versatel.nl/MAvanEverdingen/Code/)但正如上面提到的，它可以由使用调试器的人进行逆向工程以查看密钥。

为了安全地执行此操作，您需要有一个服务器的公钥，它会使用它从服务器获取对称密钥，服务器用它的私钥加密密钥。

javascript 然后用公钥解密对称密钥。

现在，此对称密钥用于加密数据。

如果数据足够小，那么您可以使用公钥来加密数据，但根据您的公钥大小存在大小限制。

所以，是的，你可以做到，但它可以被逆向工程。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T17:03:22.577

如果您的问题只是加密用户发送的数据，请在服务器上使用 SSL，以便加密与它的连接。您的 AJAX 网址将是`https://myserver.com/Ajax/Endpoint`或其他。

# objective-c - 如何将对象添加到以编程方式绑定的 NSMutableArray？

> ID：760277
> 
> 赞同：1
> 
> 时间：2009-04-17T12:49:22.437
> 
> 标签：objective-c, cocoa, cocoa-bindings, key-value-observing, key-value-coding

我有一个具有以下结构的 NSDocument：

```
@interface MyDocument : NSDocument
{
    NSMutableArray *myArray;

    IBOutlet NSArrayController *myArrayController;
    IBOutlet MyView *myView;
}
@end 
```

我在 MyDocument.xib 中实例化了 NSArrayController 和 MyView，并与文件的所有者 (MyDocument) 建立了连接，所以我很确定从 Interface Builder 的角度来看，我已经正确地完成了所有操作。

MyView 的界面很简单：

```
@interface MyView : NSView {
    NSMutableArray *myViewArray;
}
@end 
```

现在，在 中`MyDocument windowControllerDidLoadNib`，我有以下代码：

```
- (void)windowControllerDidLoadNib:(NSWindowController *) aController
{
    [super windowControllerDidLoadNib:aController];
    [myArrayController setContent:myArray];
// (This is another way to do it)    [myArrayController bind:@"contentArray" toObject:self withKeyPath:@"myArray" options:nil];

    [myView bind:@"myViewArray" toObject:myArrayController withKeyPath:@"arrangedObjects" options:nil];
} 
```

在调试器中，我已经验证了它`myViewArray`是一个 NSControllerArrayProxy，所以看起来我的编程绑定是正确的。但是，当我尝试将 MyView 方法中的对象添加到 MyView`myViewArray`时，它们似乎不会更新 MyDocument 的`myArray`. 我尝试了以下两种方法：

```
[myViewArray addObject:value];
[self addMyViewArraysObject:value]; 
```

（正如预期的那样，第二种方法会导致编译器错误，但我认为根据我对 KVO 的有限理解，Objective-C 运行时会“实现”此方法。）

我尝试更新的方式有问题`myViewArray`吗？我的编程绑定有问题吗？（我正在尝试以编程方式执行此操作，因为 MyView 是自定义视图，我不想为其创建 IB 调色板。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T13:46:02.817

我可以在这里看到两种可能性：

首先，您是否`NSMutableArray`在您的类中实例化该对象（并释放它）`MyDocument`？它应该看起来像这样：

```
- (id)init
{
    if ((self = [super init]) == nil) { return nil; }
    myArray = [[NSMutableArray alloc] initWithCapacity:0];
    return self;
}

- (void)dealloc
{
    [myArray release];
    [super dealloc];
} 
```

其次，您是否将 myViewArray 声明为 in 中的属性`MyView`？它应该看起来像这样：

```
// MyView.h:
@interface MyView : NSView
{
    NSMutableArray * myViewArray;
}
@property (assign) NSMutableArray * myViewArray;
@end 
```

```
// MyView.m:
@implementation MyView

@synthesize myViewArray;

@end 
```

除此之外，在我看来，您已正确完成所有绑定。

**更新：**如何使用`NSArrayController`将项目添加到数组：

```
// MyView.h:
@interface MyView : NSView
{
    NSMutableArray * myViewArray;
    IBOutlet NSArrayController * arrayController;
}
@property (assign) NSMutableArray * myViewArray;
- (void)someMethod;
@end 
```

```
// MyView.m:
@implementation MyView

@synthesize myViewArray;

- (void)someMethod
{
    id someObject = [[SomeClass alloc] init];
    [arrayController addObject:[someObject autorelease]];
}

@end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T16:21:19.277

问题似乎是我一直将 MyView 绑定`myViewArray`到 NSArrayController 的`arrangedObjects`属性而不是它的`content`属性。

绑定到 时`arrangedObjects`，我发现 指向的实际对象`myViewArray`是 的一个实例*`NSControllerArrayProxy`*。当我在网上搜索有关它的更多信息时，我没有找到关于该对象实际作用的明确答案。但是，我发现的代码示例表明 NSControllerArrayProxy 旨在公开访问*数组中对象属性的*便利，而不是对象（数组中）本身。这就是为什么我认为我错误地绑定到`arrangedObjects`.

解决方案是将 MyView 绑定`myViewArray`到 NSArrayController 的**`content`**属性：

```
- (void)windowControllerDidLoadNib:(NSWindowController *) aController
{
    [super windowControllerDidLoadNib:aController];

    [myArrayController setContent:myArray];
    [myView bind:@"myViewArray" toObject:myArrayController withKeyPath:@"content" options:nil];
} 
```

尽管这似乎可行，但我不能 100% 确定**`content`**在这种情况下绑定是正确的。如果有人可以对以编程方式绑定到 NSArrayController 的各种属性有所了解，我会欢迎对此答案发表评论。谢谢。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T19:51:10.207

问题是你直接改变你的数组。实现[索引访问器方法](http://developer.apple.com/documentation/Cocoa/Conceptual/ModelObjects/Articles/moAccessorMethods.html#//apple_ref/doc/uid/TP40002132-SW8)并调用它们。

KVO 会覆盖您的访问器方法（只要您符合[某些格式](http://boredzo.org/blog/archives/2007-08-07/a-complete-raw-list-of-kvc-accessor-selector-formats)）并发布必要的通知。当您直接与您的阵列交谈时，您不会得到这个；除非您明确告诉它，否则绑定到该属性的任何内容都不会知道您已更改该属性。当您使用访问器方法时，KVO 会告诉您其他对象。

唯一不使用访问器方法（综合或其他）的时间是在`init`and中`dealloc`，因为您将与half `init`-ed 或`dealloc`-ked 对象交谈。

一旦您使用自己的访问器方法来改变数组，从而获得免费的 KVO 通知，事情应该会正常工作：

*   视图在改变它的属性时，会自动通知数组控制器，它改变它的`content`属性，通知你的控制器。
*   你的控制器在改变它的属性时，会自动通知数组控制器，它改变它的`arrangedObjects`属性，通知视图。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-10T15:06:35.390

首先，绑定到排列对象没有任何问题：例如，一个 NSTableColumn 应该将其内容仅绑定到排列对象，并将其内容值绑定到排列对象.someProperty。

常见的错误是将arrangerObjects 视为arrayController 的内容，但正如您所见，这会导致悲痛：arrangerObjects 是arrayController 当前在其内容中排列对象的方式的表示，而不是内容本身。

也就是说，将数组绑定到 arrayController 的方法是：

```
[self.myArrayController bind:NSContentArrayBinding 
 toObject:self
 withKeyPath:@"myView.myViewArray" 
 options:nil]; 
```

顺便说一句，您确定您的视图需要保存 myViewArray 吗？这通常由控制器或模型对象负责。

现在您可以通过在 arrayController*上*调用 addObject 来添加对象，因为这是控制器的职责。

```
[self.myArrayController addObject: anObject] 
```

# java - 我可以获得java程序测试用例的执行跟踪吗？

> ID：760278
> 
> 赞同：1
> 
> 时间：2009-04-17T12:49:25.680
> 
> 标签：java, trace, execution

我想运行一个带有一些测试输入值的 java 程序，当执行结束时，我想知道每个条件语句的完整执行跟踪 - 遵循什么路径。有什么可以帮助我的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T12:53:02.397

当然，只需使用[调试 API](http://docs.rinet.ru/JaTricks/ch26.htm)即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T13:00:19.680

您可能想看看[AspectJ](http://www.eclipse.org/aspectj/)。

您可以使用它透明地拦截和记录代码执行。我不确定您是否可以拦截每个（比如说）`if()`语句，但您当然可以拦截方法调用等，并且您应该希望能够从那里导出执行流程。

# jquery - 当一个悬停在上面时，jQuery 淡化/变暗其他列表元素，我在那里 90%..？

> ID：760280
> 
> 赞同：2
> 
> 时间：2009-04-17T12:49:54.527
> 
> 标签：jquery, hover, fade, wait

我有一个无序列表，可能有 30 项。当其中一个项目悬停时，列表的其余项目消失到 30%，悬停的项目保持在 100%；当您从列表中移出时，它们都会恢复到 100%，而我已经做到了。

当您从一个项目移到另一个项目时，我的问题出现了，其他列表项目淡化回 100%，然后又回落到 30%。我希望他们保持在 30%，除非用户离开整个列表。

我在每个列表项上使用 hoverIntent 插件。我还使用 jQuery 向当前列表项添加了一个类，这样我就可以淡化其余部分，并在您离开后将其删除。我使用了 jQuery Cookbook 网站 ( [http://docs.jquery.com/Cookbook/wait](http://docs.jquery.com/Cookbook/wait) )上的等待函数

你明白我的意思吗？

到目前为止，这是我的代码：

```
$.fn.wait = function(time, type) {
    time = time || 300;
    type = type || "fx";
    return this.queue(type, function() {
        var self = this;
        setTimeout(function() {
            $(self).dequeue();
        }, time);
    });
};

$("#sites li:not(#sites li li)").hoverIntent(function(){
    $(this).attr('class', 'current'); // Add class .current
    $("#sites li:not(#sites li.current,#sites li li)").fadeTo("slow", 0.3); // Fade other items to 30%
    },function(){
    $("#sites li:not(#sites li.current,#sites li li)").wait().fadeTo(600, 1.0); // This should set the other's opacity back to 100% on mouseout
    $(this).removeClass("current"); // Remove class .current
}); 
```

*显然这是在 $(document).ready(function()

任何人都可以帮助我吗？

非常感谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-17T13:38:45.530

这听起来很有趣，所以我实现了它。从外观上看，您的 css 选择器可以简化。我认为您只希望最上面的列表项淡入淡出，但从示例中并不清楚。此示例突出显示最顶部的节点并正确进行淡入淡出。我认为这就是你想要的效果，但我不是 100% 确定。我没有使用 wait() 功能，因为我不确定它对你有什么作用。

从本质上讲，听起来您遇到的问题是当您尚未离开列表时，您在悬停时正在淡入项目。当您完全离开列表时，您只想淡入列表或其他列表项。不要对该部分使用 hoverIntent ，并处理整个无序列表上的淡入淡出，这应该很好。

示例：http: [//jsbin.com/usobe](http://jsbin.com/usobe)

修补示例：http: [//jsbin.com/usobe/edit](http://jsbin.com/usobe/edit)

```
<ul id="sites">
  <li> site 1
   <ul><li>sub item 1</li><li>sub item 2</li><li>sub item 3</li></ul>
  <li> site 2
   <ul><li>sub item 1</li><li>sub item 2</li><li>sub item 3</li></ul>  
  <li> site 3  
   <ul><li>sub item 1</li><li>sub item 2</li><li>sub item 3</li></ul>
  <li> site 4
   <ul><li>sub item 1</li><li>sub item 2</li><li>sub item 3</li></ul>  
  <li> site 5
</ul>    

<script>
$(function() {

$("#sites").hover(
     function() {}, 
     function() {        
       $('#sites>li').fadeTo("fast", 1.0); 
     }
);

$("#sites>li").hoverIntent(
    function(){
       $(this).attr('class', 'current'); // Add class .current
       $(this).siblings().fadeTo("fast", 0.3); // Fade other items to 30%
       $(this).fadeTo("slow", 1.0); // Fade current to 100%

    },
    function(){            
      $(this).removeClass("current"); // Remove class .current
      $(this).fadeTo("fast", 1.0); // This should set the other's opacity back to 100% on mouseout   
    });
});

</script> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-17T13:46:15.747

做这样的事情怎么样：
简单地测试了它，但我认为它达到了你想要的效果。

```
jQuery(function($){
  var $ul = $("ul#sites")

  $ul.hover(function(){
    $("li", $ul).stop().fadeTo("fast", 0.3)

    $("li", $ul).hover(function(){
        $(this).stop().fadeTo("fast", 1.0)
    },function(){
        $(this).stop().fadeTo("fast", 0.3)
    })
  },function(){
    $("li", $ul).stop().css("opacity", 1.0)
  })

}) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-29T13:08:36.890

**这是更简单的解决方案：**

```
$("ul#sites > li").fadeTo("fast", 0.3);
$("ul#sites > li").hover(
    function() { $(this).fadeTo("fast", 1.0); },
    function() { $(this).fadeTo("fast", 0.3); }
); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-15T17:35:43.877

对于纯 CSS 解决方案：

```
$('a.leaders').hover(function() {
    $(this).addClass('hovered');
    $('a.leaders').not('.hovered').addClass('nothovered');
}, function() {
    $('a.leaders').removeClass('nothovered hovered');
});

a.leaders.hovered { opacity:1; }
a.leaders.nothovered { opacity:0.6; } 
```

只需确保您已将过渡应用于您的元素，例如：

```
-moz-transition: opacity .5s ease-in-out;
-webkit-transition: opacity .5s ease-in-out;
transition: opacity .5s ease-in-out; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T13:16:33.463

id 需要查看您的 html 以更好地理解这个问题，但是这样的事情呢：

在我看来，您的问题是您正在列表中的每个项目上淡入和淡出，您应该做的是：1）如果鼠标从整个列表中移出，则将其淡入 2）当用户从一个项目移动时到另一个项目，将鼠标悬停的项目淡化为可见，其他项目不可见。

使用自定义插件会很容易 - 同样，id 需要查看 html。它有很多东西可以在没有看到它的情况下进行，或者至少是 html。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T13:27:41.657

你很接近，这应该很容易解决。在您的输出功能上，首先检查鼠标是否完全离开了 UL。如果有，则处理您的淡入。如果没有，则保持淡入，并简单地更改您离开的 li 和您正在输入的 li 的淡入。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-09-05T02:14:18.030

使用 CSS 很容易做到这一点。

看看这个[http://jsfiddle.net/drjorgepolanco/ga5dy0tp/](http://jsfiddle.net/drjorgepolanco/ga5dy0tp/)

html

```
<div id="main-nav">
    <ul>
        <li>Link 1</li>
        <li>Link 2</li>
        <li>Link 3</li>
        <li>Link 4</li>
    </ul>
</div> 
```

css

```
 #main-nav ul {
    list-style: none;
 }

 #main-nav ul:hover li {
    opacity: 0.2;
 }

 #main-nav ul:hover li:hover {
    opacity: 1;
 } 
```

向列表元素添加过渡，使其看起来更漂亮......

```
#main-nav ul li {
    transition: opacity 0.4s ease-out;
} 
```

# html - 行尾区别是否适用于 html 表单？

> ID：760282
> 
> 赞同：4
> 
> 时间：2009-04-17T12:50:24.477
> 
> 标签：html, textarea, newline

我知道用于文件的行尾因操作系统而异。我想知道，如果用户将文本粘贴到诸如 textarea 之类的 http 表单输入中，发送的行尾字符是否以同样的方式取决于操作系统？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-17T12:52:18.060

不，浏览器应该规范化行尾。

# apache - apache ProxyPass：如何保留原始IP地址

> ID：760283
> 
> 赞同：42
> 
> 时间：2009-04-17T12:50:44.743
> 
> 标签：apache, redirect, proxypass

我们正在使用 ProxyPass 将所有“/r”请求重定向到端口 18080 上的 jboss，如下所示：

```
ProxyPreserveHost on
ProxyPass /r http://localhost:18080/redirectService/
ProxyPassReverse /r http://localhost:18080/redirectService/ 
```

但是，这会导致 jboss 的访问日志中记录的 IP 地址为“127.0.0.1”。有人知道我们如何保留请求来自 HttpServletRequest 的原始 IP 吗？我们想从 doGet() 中的 jboss servlet 请求访问它

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-04-17T12:54:45.123

[您可以从X-Forwarded-For](http://en.wikipedia.org/wiki/X-Forwarded-For)标头字段中获取原始主机。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2015-06-11T14:51:52.933

JasonW 的回答很好。但由于 apache httpd 2.4.6 有一个替代方案：mod_remoteip

您必须做的就是：

1.  可能你必须安装 mod_remoteip 包

2.  启用模块：

    ```
    LoadModule remoteip_module modules/mod_remoteip.so 
    ```

3.  将以下内容添加到您的 apache httpd 配置中。请注意，您必须将此行添加**到**代理服务器的配置中。您必须**将此添加到代理目标 httpd 服务器**（代理后面的服务器）的配置中：

    ```
    RemoteIPHeader X-Forwarded-For
    # replace IP with the remote server you trust
    RemoteIPInternalProxy 10.123.123.1/24 
    ```

有关更多信息和更多选项，请参见[http://httpd.apache.org/docs/trunk/mod/mod_remoteip.html](http://httpd.apache.org/docs/trunk/mod/mod_remoteip.html)。

**安全警告！**仅对您信任的代理执行此操作。否则有人可以伪造他们的IP。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2011-11-26T05:36:05.990

这有更优雅的解释和不止一种可能的解决方案。[http://kasunh.wordpress.com/2011/10/11/preserving-remote-iphost-while-proxying/](http://kasunh.wordpress.com/2011/10/11/preserving-remote-iphost-while-proxying/)

这篇文章描述了如何在涉及代理的设置中使用一个流行的和一个鲜为人知的 Apache 模块来保留主机/IP。

> 使用 mod_rpaf 模块，在后端服务器中安装并启用它，并在模块的配置中添加以下指令。RPAFenable On
> RPAFsethostname On
> RPAFproxy_ips 127.0.0.1

（2017 年编辑）mod_rpaf 的当前位置：[https ://github.com/gnif/mod_rpaf](https://github.com/gnif/mod_rpaf)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-17T21:41:02.347

如果您有能力这样做，我建议使用[mod-jk](http://tomcat.apache.org/connectors-doc/)或[mod-proxy-ajp](http://httpd.apache.org/docs/2.2/mod/mod_proxy_ajp.html)将请求从 Apache 传递到 JBoss。与使用 HTTP 代理请求相比，AJP 协议效率更高，而且作为一个好处，JBoss 会将请求视为来自原始客户端而不是 Apache。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2018-01-16T07:00:18.130

如果您使用 Apache 反向代理来为在 localhost 端口上运行的应用程序提供服务，则必须将位置添加到您的虚拟主机。

```
<Location />            
   ProxyPass http://localhost:1339/ retry=0
   ProxyPassReverse http://localhost:1339/
   ProxyPreserveHost On
   ProxyErrorOverride Off
</Location> 
```

要获取 IP 地址，有以下选项

```
console.log(">>>", req.ip);// this works fine for me returned a valid ip address 
console.log(">>>", req.headers['x-forwarded-for'] );// returned a valid IP address 
console.log(">>>", req.headers['X-Real-IP'] ); // did not work returned undefined 
console.log(">>>", req.connection.remoteAddress );// returned the loopback IP address 
```

所以要么使用 req.ip 要么 req.headers['x-forwarded-for']

# gtk - 在 gtk 中捕获滚动事件#

> ID：760287
> 
> 赞同：0
> 
> 时间：2009-04-17T12:52:01.213
> 
> 标签：gtk, scroll, gtk#

当滚动 ScrolledWindow 时需要运行一些代码时，我应该从哪个小部件中捕获哪个事件？

我正在使用的小部件树是：（我的小部件：Gtk.Container）> Viewport > ScrolledWindow

我尝试了许多 ScrollEvent、ScrollChild 等事件处理程序的组合，这些事件处理程序连接到所有这些，但唯一运行任何东西的是来自 Viewport 的事件，当应用程序启动时，SetScrollAdjutstments 被更改为 (x=0,y=0) .

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T12:58:25.083

您应该附加到相关滚动条中的[GtkAdjustment](http://library.gnome.org/devel/gtk/unstable/GtkAdjustment.html)，并对其“[更改](http://library.gnome.org/devel/gtk/unstable/GtkAdjustment.html#GtkAdjustment-changed)”事件做出反应。由于滚动条是范围，因此您可以使用`[gtk_range_get_adjustment()](http://library.gnome.org/devel/gtk/unstable/GtkRange.html#gtk-range-get-adjustment)`调用来执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T13:20:38.290

unwind 的回答是正确的。只需发布我的代码以防有人需要完整的解决方案：

```
// in the xxx : Gtk.Container class:

protected override void OnParentSet(Widget previous_parent) {
    Parent.ParentSet += HandleParentParentSet;
}

void HandleParentParentSet(object o, ParentSetArgs args) {
    ScrolledWindow swn = (o as Widget).Parent as ScrolledWindow;
    swn.Vadjustment.ValueChanged += HandleScrollChanged;
}

void HandleScrollChanged(object sender, EventArgs e) {
    // vertical value changed
} 
```

如果您需要更改任何这些小部件的父级，或者可能需要更改类型并更改硬编码类型并处理与前一个父级的断开连接。

# php - 如何防止用作 HTML 电子邮件正文的 PHP 变量中的换行符

> ID：760300
> 
> 赞同：1
> 
> 时间：2009-04-17T12:55:45.167
> 
> 标签：php, html, email

我创建了一个 PHP 脚本，它获取一个数组的内容并将它们填充到一个名为 $body 的变量中：

```
foreach($_POST as $var => $value)
{

    if (($var != "Submit") && ($value != "")) {

    $body .= $var .': '.filter_var($value, FILTER_SANITIZE_STRING) . '<br>';}

} 
```

这个 $body 然后形成 HTML 电子邮件的正文。一切都很好，直到这些内容变得太长，然后我最终收到一封电子邮件，有时会丢失一个`<br />`（因为它变成`<b`一行和`r />`下一行。这导致我的字段在电子邮件客户端中一起运行。

想法？

编辑：我尝试`\n`在休息前添加，但我的电子邮件客户端显示它们但是用双引号它可以工作。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T12:59:43.503

打印您的`"\n<br/>"`. 这样，您将始终获得`<BR>`新的线路。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T13:30:04.740

而不是试图阻止休息，我会强迫他们在你想要的地方。弄清楚您希望该行在字符中多长时间，然后在空格处有这么多字符后创建换行符。这将使您能够更好地控制您在电子邮件中发送的布局，并将
正确执行。

# c++ - 实现无操作 std::ostream

> ID：760301
> 
> 赞同：32
> 
> 时间：2009-04-17T12:55:46.367
> 
> 标签：c++, logging, debugging

我正在考虑制作一个日志类，其中包含 Info、Error 等可以配置输出到控制台、文件或无处的成员。

为了提高效率，我想避免格式化将被丢弃的消息的开销（即不以详细模式运行时的信息消息）。如果我实现一个自定义的 std::streambuf 输出到任何地方，我想 std::ostream 层仍将执行所有格式化。任何人都可以建议一种方法来拥有一个真正的“空” std::ostream 来避免对传递给它的参数做任何工作`<<`吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-17T13:12:56.547

一个迅速的谷歌想出了这个可能有用的例子。我不提供任何保证，除了它编译和运行:-)

```
#include <streambuf>
#include <ostream>

template <class cT, class traits = std::char_traits<cT> >
class basic_nullbuf: public std::basic_streambuf<cT, traits> {
    typename traits::int_type overflow(typename traits::int_type c)
    {
        return traits::not_eof(c); // indicate success
    }
};

template <class cT, class traits = std::char_traits<cT> >
class basic_onullstream: public std::basic_ostream<cT, traits> {
    public:
        basic_onullstream():
        std::basic_ios<cT, traits>(&m_sbuf),
        std::basic_ostream<cT, traits>(&m_sbuf)
        {
            init(&m_sbuf);
        }

    private:
        basic_nullbuf<cT, traits> m_sbuf;
};

typedef basic_onullstream<char> onullstream;
typedef basic_onullstream<wchar_t> wonullstream;

int main() {
    onullstream os;
    os << 666;
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-07-16T02:03:49.710

各位，谢谢分享代码，我只是做个测试，然后Neil的方法还是会做字符串格式化，例如：

```
#include <streambuf>
#include <ostream>
#include <iostream>
using namespace std;

template <class cT, class traits = std::char_traits<cT> >
class basic_nullbuf: public std::basic_streambuf<cT, traits> {
    typename traits::int_type overflow(typename traits::int_type c)
    {
        return traits::not_eof(c); // indicate success
    }
};

template <class cT, class traits = std::char_traits<cT> >
class basic_onullstream: public std::basic_ostream<cT, traits> {
    public:
        basic_onullstream():
        std::basic_ios<cT, traits>(&m_sbuf),
        std::basic_ostream<cT, traits>(&m_sbuf)
        {
            init(&m_sbuf);
        }

    private:
        basic_nullbuf<cT, traits> m_sbuf;
};

typedef basic_onullstream<char> onullstream;
typedef basic_onullstream<wchar_t> wonullstream;

class MyClass
{
    int a;
    friend ostream& operator<< (ostream&, MyClass const&);
};

ostream& operator<<(ostream& out,MyClass const& b)
{
    std::cout<<"call format function!!";
    out << b.a;
    return out;
}

int main() {
    onullstream os;
    MyClass obj;
    os<<obj;
} 
```

运行这个程序，你会发现会调用“ostream& operator<<(ostream& out,MyClass const& b)”。因此，仍然会调用对 obj 进行格式化。所以，我们仍然无法避免格式化消息的开销。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-17T13:11:47.920

为了防止`operator<<()`调用进行格式化，您应该在编译时知道流类型。这可以通过宏或模板来完成。

我的模板解决方案如下。

```
class NullStream {
public:
    void setFile() { /* no-op */ }
    template<typename TPrintable>
    NullStream& operator<<(TPrintable const&)
    { return *this; } /* no-op */
}

template<class TErrorStream> // add TInfoStream etc
class Logger {
public:
    TErrorStream& errorStream() {
        return m_errorStream;
    }

private:
    TErrorStream m_errorStream;
};

//usage
int main() {
    Logger<std::ofstream> normal_logger; // does real output
    normal_logger.errorStream().open("out.txt");
    normal_logger.errorStream() << "My age is " << 19;

    Logger<NullStream> null_logger; // does zero output with zero overhead
    null_logger.errorStream().open("out.txt"); // no-op
    null_logger.errorStream() << "My age is " << 19; // no-op
} 
```

由于您必须在编译时执行此操作，因此它当然非常不灵活。

例如，您无法在运行时从配置文件中决定日志记录级别。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T13:02:07.227

可能您需要的不仅仅是文本格式和消息过滤。多线程呢？

我将实现过滤和多线程同步作为单独类的职责。

但是，日志记录不是一个简单的问题，我会尝试使用现有的日志记录解决方案，而不是开发新的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T13:13:23.003

为什么不使用数百万用户使用的现有日志记录解决方案？log4j、log4net、log4cxx..，仅举几例..

# asp.net - 不同环境中的 ASP.NET 意外和不同行为

> ID：760302
> 
> 赞同：0
> 
> 时间：2009-04-17T12:56:14.057
> 
> 标签：asp.net, windows-server-2003

我有一个正在尝试清理的 ASP.NET 站点 (VB.NET)。最初创建它时，它是在没有错误处理的情况下编写的，我正在尝试添加它以改善用户体验。

```
Try
    If Not String.IsNullOrEmpty(strMfgName) And Not String.IsNullOrEmpty(strSortType) Then
        If Integer.TryParse(Request.QueryString("CategoryID"), i) And String.IsNullOrEmpty(Request.QueryString("CategoryID")) 
            MyDataGrid.DataSource = ProductCategoryDB.GetMfgItems(strMfgName, strSortType, i)
        Else
            MyDataGrid.DataSource = ProductCategoryDB.GetMfgItems(strMfgName, strSortType)
        End If
        MyDataGrid.DataBind()

        If CType(MyDataGrid.DataSource, DataSet).Tables("Data").Rows.Count > 0 Then
            lblCatName.Text = CType(MyDataGrid.DataSource, DataSet).Tables("Data").Rows(0).Item("mfgName")
        End If

        If MyDataGrid.Items.Count < 2 Then
            cboSortTypes.Visible = False
            table_search.Visible = False
        End If
        If MyDataGrid.PageCount < 2 Then
            MyDataGrid.PagerStyle.Visible = False
        End If
    Else
        lblCatName.Text &= "<br /><span style=""fontf-size: 12px;"">There are no items for this manufacturer</span>"
        MyDataGrid.Visible = False
        table_search.Visible = False
    End If
Catch
    lblCatName.Text &= "<br /><span style=""font-size: 12px;"">There are no items for this manufacturer</span>"
    MyDataGrid.Visible = False
    table_search.Visible = False
End Try 
```

现在，这是试图通过捕获异常来避免产生 500 错误。查询字符串可以包含三个项目，但这里只有两个重要。在我的测试环境和 Visual Studio 中，当我运行此站点时，该项目是否在查询字符串中并不重要。在生产中，这确实很重要。如果查询字符串中不存在第三个项目 (SubCategoryID)，则显示“没有此制造商的项目”而不是数据库中的数据。

在两个不同的环境中，我看到了两个不同的代码执行路径，尽管 URL 和代码库相同。

该站点在带有 IIS 6 的 Server 2003 上运行。

想法？

编辑：在回答下面的答案时，我怀疑这是一个连接错误（尽管我看到了你要做什么），因为当我将 SubCategoryID 添加到查询字符串时，该站点可以正常工作（显示来自数据库的数据）。

此外，如果您对如何测试此场景有任何建议，请告诉我，无需将代码部署回生产环境（已回滚）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T12:59:11.307

我认为您应该尝试在 catch 块中打印出异常详细信息以查看问题所在。它可能是任何事情，例如与您的数据库的连接错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T13:37:18.390

错误可能是任何东西，您绝对应该考虑将其打印出来或记录在某处，而不是假设没有数据。您还将针对两个不同的代码路径向 UI 输出相同的错误消息，这使调试变得更加困难，尤其是在不知道是否发生异常以及如果发生异常是什么的情况下。

通常，在这种情况下最好不要捕获所有异常，尤其是在不记录错误的情况下。相反，您应该捕获特定异常并适当地处理这些异常，并且任何真正的异常都可以向上传递，理想情况下传递给可以记录它和/或发送某种错误通知的全局错误处理程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T11:51:31.317

我昨天发现了原因。简而言之，这是因为当我将我的文件从我的计算机复制到我的开发测试环境中时，我错过了一个文件，具有讽刺意味的是，这导致它工作，而不是没有。所以最终它在两种环境中的功能都是一样的。

# vb6 - 准确访问 VB6 限制

> ID：760305
> 
> 赞同：14
> 
> 时间：2009-04-17T12:58:24.600
> 
> 标签：vb6, code-metrics

尽管它过时而痛苦 - 我在一家继续积极使用 VB6 进行大型项目的公司工作。事实上，18 个月前我们遇到了 32k 标识符的限制。

不愿意放弃大型代码库并在 .NET 中重写所有内容，我们将应用程序分解为一个主可执行文件和几个支持 DLL 文件。本周我们再次遇到了 32k 的限制。

我们遇到的问题是，我们找不到任何工具可以告诉我们源使用了多少唯一标识符。我们没有准确的方法来衡量我们的努力如何减少标识符的数量，或者我们在达到极限之前有多接近极限。

有谁知道一个工具可以扫描项目的源代码并返回一些准确的指标和统计数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T17:04:54.210

好的。Project Metrics Viewer 是 Aivosto 的 Project Analyzer 工具的一部分，它将完全满足您的需求。我已经包含了一个屏幕截图以及指向包含变量数量等的指标列表的链接。

[指标列表](http://www.aivosto.com/project/help/metricssample/metricslist.html)

[![替代文字](https://i.stack.imgur.com/01OF6.gif)](https://i.stack.imgur.com/01OF6.gif)
[（来源：[aivosto.com](http://www.aivosto.com/project/help/pm-main.gif)）]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T13:15:00.660

AxTools 的 CodeSmart 非常好。[（来源：][[axtools.com](http://www.axtools.com/products/showcs2k3vb/CodeStatistics.gif)][）]
[![替代文字](https://i.stack.imgur.com/ylkWG.gif)](https://i.stack.imgur.com/ylkWG.gif)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-09-30T17:11:16.760

我工作的公司也有一个遇到标识符限制的大型 VB6 项目。我开发了一种方法来准确计算剩余标识符的数量，这已被纳入我们这个项目的构建过程中。

在尝试了几个工具都没有成功之后，我终于意识到 VB6 IDE 本身确切地知道它还剩下多少标识符。事实上，当您添加一个超过其限制的变量时，VB6 IDE 会引发“内存不足”错误。

**利用这个事实，我编写了一个 VB6 Add-In 项目，它首先在 IDE 中编译当前加载的项目，然后将唯一命名的变量添加到项目中，直到它抛出错误。当出现错误时，它会将在错误之前添加的标识符的数量记录为剩余的标识符数量。**

此编号存储在我们的自动构建过程已知位置的文件中，然后读取此编号并将其报告给开发团队。当它低于我们认为合适的值时，我们会安排一些重构时间并将更多代码从该项目移出到 DLL 项目中。几年来，我们一直在生产中使用它，并且已被证明是一个可靠的过程。

要直接回答这个问题，我知道使用加载项是准确测量剩余标识符数量的唯一方法。虽然我无法分享我们项目正在使用的插件代码，但我可以说涉及的代码并不多，而且开发时间也不长。

Microsoft 有一个关于如何创建加载项的不错的指南，可以帮助您入门： https: [//support.microsoft.com/en-us/kb/189468](https://support.microsoft.com/en-us/kb/189468)

以下是特定于计数标识符的一些重要细节：

*   **在当前加载的项目被编译之前，VB6 IDE 在标识符不足时不会始终抛出错误。**我们的插件在添加标识符之前以编程方式执行此操作以确保准确计数​​。如果无法编译项目，则无法获得准确的计数。
*   有 32,500 个标识符可用于新的空 VB6 项目。
*   只计算唯一标识符名称。在两个不同的例程中具有相同名称的两个局部变量仅算作一个标识符。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-12T04:10:07.320

您可以从从 VB6 代码中提取标识符的工具中获得此信息。然后您所要做的就是对列表进行排序、消除重复项并测量列表大小。我们有一个[源代码搜索引擎](http://www.semanticdesigns.com/Products/SearchEngine)，它将源代码分解为语言标记（“lexes”），其中一些标记正是那些标识符。那将包含您想要的数据。

但也许还有另一种方法可以解决您的问题：找出哪些变量名很少出现，并将它们替换为一组标准名称（例如，“temp”）。所以你真正想要的是计算每个变量名的数量，这样你就可以对“少量引用”进行排序。相同的词法分析器数据可以提供此信息。

然后，您所需要的只是一个工具，可以将低出现率的标识符重命名为标准集中的名称。我们提供了混淆器，可以用另一个名称替换一个名称，这可能会做到这一点。

[2014 年 10 月更新]。刚刚和有这个问题的人进行了长时间的交谈。事实证明，有一个非常概念性的答案可以作为工具的基础，称为[寄存器着色](http://en.wikipedia.org/wiki/Register_allocation)，它将固定数量的寄存器分配给任意数量的操作数。这是通过计算操作数上的“干涉图”来实现的；并且两个不“干扰”的操作数可以分配给同一个寄存器。如果干扰图还不够糟糕，可以使用它将 2^16 个可用变量名称分配给任意数量的标识符。我的猜测是它不是。YMMV，仍然需要有人构建这样的工具，可能需要 VB6 解析器和机器来计算这样的图。[查看我的简历]。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-16T19:41:01.637

作弊 - 创建一个未使用的类，其中包含#### 唯一变量。使用 Excel 或其他工具生成按字母顺序排列的唯一变量名称。当您达到限制时从项目中删除该类，或注释掉 100 个唯一变量的块。

无论如何，我宁愿依靠编译器（它**定义**了多少变量太多）而不是一些第 3 方工具。

（哦，粗鲁，抱歉死灵 - 没有注意到日期）

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-17T13:58:30.773

[Compuware 的 DevPartner](http://www.compuware.com/products/devpartner/studio.htm)似乎有这种代码分析。不知道当前版本是否还支持Visual Basic 6.0。（但至少有 14 天的试用期）

# java - 用于开发 JMX 模型 MBean 的 IDE 插件

> ID：760309
> 
> 赞同：1
> 
> 时间：2009-04-17T12:58:32.930
> 
> 标签：java, eclipse, netbeans, eclipse-plugin, jmx

我正在寻找一个插件来帮助开发人员创建适用于 Eclipse 和/或 Netbeans 的 JMX 模型 MBean。我知道 Netbeans 的 JMX 插件允许创建简单的 MBean，但可以寻找更高级的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-04T18:42:04.790

你试过[eclipse-jmx](http://code.google.com/p/eclipse-jmx/)吗？不确定它对您来说是否足够先进，但它是一个具有自己视角的 Eclipse 插件，您可以在 MBean 上显示信息、设置属性、获取通知、执行操作以及连接到 MBean 服务器。

还有[Eclipse 的 JMX 控制台](http://www.eclipseplugincentral.com/Web_Links-index-req-viewlink-cid-314.html)。我从未使用过它，但它在 Eclipse Plugin Central 站点上的评价非常好。不过，它可能有点过时了……看起来它自 2004 年以来就没有更新过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T18:50:59.043

我不确定，但我认为用于 Eclipse 的新 JBoss IDE 可能具有一些 mbean 功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T10:37:07.817

我认为 Apache Modeler 可能最适合这里...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-05T15:52:16.757

查看 Apache common modeler，它允许您通过简单的注册 MbeanServer 从普通的 java 类中获取模型 mbean。

查看以下链接：

[http://liviutudor.com/2011/12/22/apache-commons-modeler-simplesample-usage/](http://liviutudor.com/2011/12/22/apache-commons-modeler-simplesample-usage/)

[http://marxsoftware.blogspot.com/2008/07/jmx-model-mbean.html](http://marxsoftware.blogspot.com/2008/07/jmx-model-mbean.html)

# python - 如何以 HAL 可以检索但不需要安装或更改标签的方式标记设备

> ID：760310
> 
> 赞同：1
> 
> 时间：2009-04-17T12:58:48.950
> 
> 标签：python, hardware, mount, dbus, hal

我正在尝试找到一种方法来标记 USB 闪存设备，这种方法无需安装或更改标签即可以编程方式进行测试。

是否有任何我可以修改的关于设备的属性不会导致其行为/外观对用户有所不同？

运行 Ubuntu Jaunty。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T14:59:41.483

您无法修改此属性，但元组 (vendor_id, product_id, serial_number) 对于每个设备都是唯一的，因此您可以将其用作已经存在的标记。您可以使用 lsusb 或 usblib 枚举 USB 总线上的设备。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T15:12:10.393

如果没有自定义驱动程序，更改 VID/PID 可能会使您的设备无法使用。HAL 不应该为您自动安装闪存驱动器。

话虽如此，您总是可以将某些东西偷偷溜进引导扇区和/或驱动器的开头部分。那里有很多多余的字节可以用于自定义目的——无论是邪恶的还是其他的。

# git - 解决 Git Svn 冲突

> ID：760312
> 
> 赞同：10
> 
> 时间：2009-04-17T12:59:09.777
> 
> 标签：git, git-svn

我正在使用 Git-Svn 与工作中的 Svn 存储库进行交互，但我似乎无法找到一种方法来有效地解决我一生中的冲突。我已经阅读了关于这个主题的其他问题，但显然我需要一些更有效的补救措施，因为我似乎总是陷入某种无休止的循环。我变基，使用 mergetool (meld) 来解决我的冲突，当我完成所有这些时，我尝试执行 dcommit 并在提交错误期间遇到合并冲突。

我知道这感觉像是重复，但沮丧让我再次询问，并提供了一些关于我将如何处理的非常具体的细节，以便希望有人能准确地告诉我我的流程在哪里搞砸了。

我的设置：

我有一个远程分支 (svn/trunk)、一个本地分支 (trunk) 和另一个我通常工作的本地分支 (working-trunk)。主干已从 svn/trunk 中检出，工作主干已从主干中检出。

这是我一直在做的事情：

1.  在我的后备箱上，`git svn rebase`（返回冲突）
2.  `git mergetool`
3.  [解决该文件的冲突]
4.  从 meld 中保存合并的文件并关闭 meld。
5.  `git add .`
6.  `git rebase --continue`
7.  [冲洗，重复]
8.  如果我收到一条消息询问我是否使用过`git add`，我`git rebase --skip`

当我完成所有报告的更改时，一切都停止了，我想也许我现在不确定该怎么做。Git 没有显示任何要提交的内容，我似乎又回到了主干上。然后 Git 允许我 dcommit，但如果我之后立即尝试变基，我最终会重新解决我刚刚解决的冲突。

显然我在这里遗漏了一个关键部分，但我只是没有看到它，它导致了很多问题和挫败感。在 Git 中合并可能很容易，但我肯定不会发现这种情况。

谢谢。

**更新：**只是想快速更新一下来描述我的工作流程，以防这是问题的一部分（或全部）。

首先，在使用`svn/`前缀克隆我的存储库后，我有我的`svn/trunk`远程分支。鉴于：

1.  我`git co -b trunk svn/trunk`要检查我的远程到本地分支。
2.  我`git co -b working-trunk`创建了一个工作分支，用于创建更多程度的分离，以便我的本地**主干**始终可以镜像我的远程主干。
3.  我删除了默认的 master 分支（使用 svn 时，我发现用“trunk”而不是“master”来思考更容易）。

拥有所有分支后，我的典型工作流程如下所示：

1.  在**working-trunk**上，我进行更改并提交它们。
2.  我`git co trunk`和做一个`git svn rebase`。
3.  假设新代码被重新定位，我`git rebase working-trunk`.
4.  `git co working-trunk`
5.  `git merge trunk`
6.  `git rebase trunk`
7.  `git co trunk`
8.  `git merge working-trunk`
9.  `git svn dcommit`

这是很多步骤，我知道，但这是这里和其他地方的每个人都推荐的。我的致命缺陷可能在那个过程中的某个地方吗？

再次感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-23T06:54:46.373

我建议使用 git rebase 而不是 git merge。Svn 保持线性历史，有时似乎与 git branch merges 混淆。使用 git rebase 可确保 svn 理解线性历史。

有关更多信息和指南，请参见： [http ://learn.github.com/p/git-svn.html。](http://learn.github.com/p/git-svn.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-09T17:33:43.810

我最终遇到了同样的问题（返回冲突的 git svn rebase）。我在工作流程中发现了问题。这是我/您应该遵循的工作流程：

```
git svn rebase # put all the new commits on top

git svn dcommit # push the new commits to svn (will rewrite each commit message to add the svn tag)

git pull # merge the conflicts due to the commit messages

git push # push the synchronized version to the remote git server 
```

每当我忘记在 dcommit 之后合并历史记录时，如果我进行新的提交，就会出现新的（假的）冲突。要解决它们，您可以按照上面描述的方法，或者如果它是由于与我完全相同的问题，您也可以使用以下方法以自动方式进行：

```
git svn rebase --strategy ours 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T17:38:04.703

人们可能会发现[SubGit](http://subgit.com/)的方法更容易一些：

1.  将 SubGit 安装到服务器端的 Subversion 存储库中
2.  用于`git`不`git-svn`向 SVN 存储库发送更改*

SubGit 安装创建 SVN 存储库的 Git 副本。将此存储库克隆到您的本地存储库；创建任何分支并将它们推送到远程 Git 存储库，SubGit 会自动将这些分支转换为 SVN。

有关详细信息，请参阅[SubGit 文档](http://subgit.com/documentation/)和[git-svn 比较](http://subgit.com/documentation/gitsvn.html)。

* 适用于任何 Git 客户端。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T13:23:38.813

我用我强迫的（当然很小的）冲突尝试了这个，之后`git svn dcommit`我没有进一步的冲突。一个区别是我没有收到关于`git add`. 您的团队是否有可能只是发送了许多与您的工作发生冲突的提交？这似乎不太可能，但似乎是最简单的解释。

您可能值得花时间在不同的位置再次获取 repo，并测试您是否可以推送不冲突的更改，以确保在`dcommit`以某种方式隐藏的阶段期间没有通信问题。

更新：我的另一个想法是：我`git add foo.bar`在解决冲突后做了一个。有没有可能`git add .`做一些意想不到的事情？我并没有真正扩展`git svn`所有功能，所以这些几乎都是 WAG。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-18T06:48:45.807

似乎有些事情并没有按照您想象的方式运行。如果这不是 Hank Gay 建议的不太可能的事情，那么它就是其他一些不太可能的事情。

我不太可能是您的分支结构不是您认为的那样，或者您没有重新基于您认为的分支。所以我建议你：

1.  `git branch` 只是为了确认您的分支结构是您所期望的

2.  添加
    `export PS1='\e[0;31m\n\w$(__git_ps1 "(%s)") $ \e[m'`
    到 ~/.bash_profile 并再次登录，
    以在提示中显示分支（和任何进程内 git 命令）：

    /workspace/wikka(featurebranch1|REBASE-i) $

这将为您提供更多反馈（并可能消除此 WAG）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-18T07:58:17.853

我建议仅在本地*中继*和远程*中继*之间使用 git-svn 。在你的本地*trunk*和本地*mytrunk 之间*，坚持标准的 git only 功能。您可以尝试这样的工作流程：

```
[SVN]---git-svn---[trunk]---branch---[mytrunk] 
```

要合并，请切换到*中继*并执行以下操作：

```
git svn rebase 
```

这会从远程提取更改并将其与*trunk*合并。然后，切换到*mytrunk*并执行以下操作：

```
git rebase 
```

*这会从trunk*中提取更改并将其与*mytrunk*合并。我认为它应该工作。否则，只需 git-clone 本地主干并在克隆上工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-23T14:50:58.680

我刚刚在使用推荐的工作流程时遇到了这个问题，所以我认为我们在这里缺乏答案。

这就是我遇到这种情况的方式。

我使用 Apache 基础架构通过 git svn 有一个 git repo。

我有一个当地的分支机构。

我尝试遵循以下程序：

1）重新设置主干。2）将主干合并到私有分支。3）做工作。4）重新设置主干。5）将私有合并到主干中。6) 提交。

但是，我搞砸了，我忘记将更改从私有推送到中继。然后，我对我的私有分支进行了一系列其他更改，并最终陷入了完全虚假冲突的冲洗和重复循环。我提出的最后一个更改是注释掉一行。然后，当我在被忽略的更改中删除该行时，它产生了无论如何都无法解决的冲突。我最终使用了 --skip 。

# eclipse - 无法运行包含来自 Eclipse 的线程的 JUnit 测试用例

> ID：760315
> 
> 赞同：3
> 
> 时间：2009-04-17T12:59:42.927
> 
> 标签：eclipse, junit

我正在从 Eclipse 3.4.1 运行 JUnit 测试用例。这个测试用例创建了一个类，它启动一个线程来做一些事情。当测试方法结束时，似乎 Eclipse 正在强行关闭线程。

如果我从命令行运行相同的测试，那么线程运行正常。

不知何故，我不记得以前在 Eclipse 中遇到过此类问题。这是 Eclipse 中一直存在的东西，还是他们在 3.4.x 中添加了它？

这是一个例子：

当我从 Eclipse 运行这个测试时，我得到了一些 cnt 的打印（直到大约 1800），然后测试用例自动终止。但是，如果我运行启动 JUnit 的 TestRunner 的 main 方法，那么线程将无限计数。

```
import junit.framework.TestCase;
import junit.textui.TestRunner;

/**
 * This class shows that Eclipses JUnit test case runner will forcibly 
 * terminate all running threads
 * 
 * @author pshah
 *
 */
public class ThreadTest extends TestCase {

  static Runnable run = new Runnable() {
    public void run() {
      int cnt = 0;
      while(true) System.out.println(cnt++);
    }
  };

  public void testThread() {
    Thread t = new Thread(run);
    t.start();
  }

  public static void main(String args[]) {
    TestRunner runner = new TestRunner();
    runner.run(ThreadTest.class);
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T05:58:15.090

我将您的代码改编为 JUnit NG，结果相同：线程被杀死。

```
public class ThreadTest {

  static Runnable run = new Runnable() {
    public void run() {
      int cnt = 0;
      while (true)
        System.out.println(cnt++);
    }
  };

  @Test
  public void threadRun() {
    Thread t = new Thread(run);
    t.start();
    assertEquals("RUNNABLE", t.getState().toString());
  }

} 
```

* * *

如果我使用 Ecipe 插件文件夹中的 JUnit jar（在我的情况下为 4.3.1）通过命令行执行测试，它的行为与在 Eclipse 中执行它的行为相同（这是合乎逻辑的:)）。

我在命令行中测试了 JUnit 4.6（刚刚下载），它也在短时间内停止了！这与 Eclipse 中的行为完全相同

* * *

我发现，如果最后一条指令完成，它就会被杀死。如果您考虑 JUnit 的工作原理，这是合乎逻辑的：
对于每个测试，都会创建一个新对象。如果测试结束，它就会被杀死。属于这个测试的所有东西都被杀死了。
这意味着，必须停止每个线程。

JUnit 正确地处理了这种情况。单元测试必须隔离且易于执行。因此，如果达到测试结束，它必须结束所有线程。

您**可以**等待，直到测试完成，然后执行您的`assertXXX`指令。这将是测试线程的正确方法。
但要小心：它可能会缩短您的执行时间！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-20T01:31:11.810

我相信这种修改将产生单元测试各种线程场景所需的结果。

（抱歉，如果格式不正确）

```
public class ThreadTest {

static Runnable run = new Runnable() {
public void run() {
  int cnt = 0;
  while (true)
    System.out.println(cnt++);
}
};

@Test
public void threadRun() {
Thread t = new Thread(run);
t.start();  

//Run the thread, t, for 30 seconds total. 
//Assert the thread's state is RUNNABLE, once per second
for(int i=0;i<30;i++){ 
    assertEquals("RUNNABLE", t.getState().toString());
    try {
        Thread.sleep(1000);//1 second sleep
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
}
System.out.println("Done with my thread unit test.");
 }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-12-01T14:19:05.013

这可行，但您必须命名您的线程或找到另一种方式来引用它。

```
protected boolean monitorSecondaryThread(String threadName, StringBuilder errorMessage, boolean ignoreFailSafe) {
    int NUM_THREADS_BESIDES_SECONDARY_THREAD = 2;
    int MAX_WAIT_TIME = 10000;

    MyUncaughtExceptionHandler meh = new MyUncaughtExceptionHandler();
    Set<Thread> threadSet = Thread.getAllStackTraces().keySet();
    for (Thread t : threadSet) {
        t.setUncaughtExceptionHandler(meh);
    }

    Date start = Calendar.getInstance().getTime();

    boolean stillAlive = true;
    while (stillAlive) {
        for (Thread t : threadSet) {
            if (t.getName().equalsIgnoreCase(threadName) && !t.isAlive()) {
                stillAlive = false;
            }
        }

        Date end = Calendar.getInstance().getTime();

        if (!ignoreFailSafe && (end.getTime() - start.getTime() > MAX_WAIT_TIME || Thread.activeCount() <= NUM_THREADS_BESIDES_SECONDARY_THREAD)) {
            System.out.println("Oops, flawed thread monitor.");
            stillAlive = false;
        }
    }

    if (meh.errorCount > 0) {
        System.out.println(meh.error);
        errorMessage.append(meh.error);
        return false;
    }

    return true;
}

private class MyUncaughtExceptionHandler implements UncaughtExceptionHandler {

    public int errorCount = 0;
    public String error = "";

    @Override
    public void uncaughtException(Thread t, Throwable e) {
        ByteArrayOutputStream bs = new ByteArrayOutputStream();
        PrintStream ps = new PrintStream(bs);
        e.printStackTrace(ps);
        error = bs.toString();
        errorCount++;
    }

} 
```

# sql-server - 是否有用于 SQL Server Express 的 SQL Server Profiler？

> ID：760321
> 
> 赞同：33
> 
> 时间：2009-04-17T13:02:06.320
> 
> 标签：sql-server, profiling, sql-server-express

是否有用于 SQL Server Expess 的 SQL Server Profiler？也许是一个开源的？或者也许只是一个工具，可以帮助我查看传递给数据库的查询？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-24T07:50:12.587

SQL Server Express 2012 高级服务的 SP1 现在包括完整的 SQL Management Studio，它具有分析器。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-11-28T18:34:39.557

好的，老问题，但也许这可以帮助其他有同样问题的人。

您可以激活 SQL Server Express 错误日志，使其监视针对每个数据库运行的所有语句。为此，您必须在提升的命令提示符（即以管理员身份运行的命令提示符）上运行以下命令：

```
net stop MSSQL$SQLEXPRESS
net start MSSQL$SQLEXPRESS /T4032 
```

现在，使用 SQL Server Management Studio 运行以下命令：

```
dbcc traceon(3605, -1) 
```

现在您可以查看 MS SQL 文件夹的 Log 文件夹中的 ERRORLOG 文件（对于 SQL Server Express 2012 的默认安装，可能是“C:\Program Files\Microsoft SQL Server\MSSQL11.SQLEXPRESS\MSSQL\Log”）。

希望这可以帮助某人（因为它确实帮助了我）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-17T13:09:01.813

IIRC，探查器是 SQL Server Express 不可用的功能之一。

但是，我也觉得 SQL Server Express 仍然支持付费版的*许多*功能，只是它们在 Management Studio 的 Express 版中被禁用。因此，如果您还可以访问完整的数据库和随附的管理工作室，则*可以*将该分析器指向您的快速安装。

在这种情况下，我怀疑这不起作用，因为分析器还依赖于数据库提供的额外内容。尽管如此，还是值得一试。

如果它不起作用，则可以使用一些第三方工具来满足您的需求。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-17T13:08:18.960

[SQL Express Profiler](http://www.DataWizard.com/)可能会满足您的需求。当被问到这个问题时，它是免费的，但看起来它最近已更改为付费许可模式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-06-13T17:46:30.350

Anjlab SQL Server Profiler 不再免费，它仅适用于 2005 实例。我编写了一个基本的 SQL Server 2012 Profiler，它可以在 2012 Enterprise 和 2005 Developer 引擎实例上完美运行。你可以[在这里下载](http://ivanz.webuda.com/)

请给我您的反馈。

# windows - 为什么我的 Qt 4.5 应用程序在 Windows 下打开控制台窗口？

> ID：760323
> 
> 赞同：34
> 
> 时间：2009-04-17T13:02:10.253
> 
> 标签：windows, qt, console, mingw, qt-creator

我一直在 Linux 下使用 Qt Creator 4.5。我的应用程序在 Linux 下构建得很好，但如果我在 Windows 中构建，应用程序总是在启动时打开一个控制台窗口。

我可以阻止它这样做吗？

我正在使用默认的 MinGW 设置进行构建，也许这是相关的。如果需要，我可以使用 Visual Studio 构建，但我想先了解发生了什么......

**编辑**：我刚刚在 Windows 下使用 Qt Creator 创建了一个简单的测试 GUI 应用程序，它没有表现出这种行为。由于在 linux 下创建项目的方式导致了这种行为，或者我的应用程序执行了某些操作导致控制台窗口出现。当我诊断它时会发布详细信息，以防它帮助其他人。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2016-04-10T10:43:18.297

对于那些在**Windows下使用****CMake**时遇到此问题的人（请参阅[Amoo 的评论](https://stackoverflow.com/questions/760323/why-does-my-qt-4-5-app-open-a-console-window-under-windows/36528717?noredirect=1#comment110396547_36528717)），这里有一个解决[方案](https://cmake.org/pipermail/cmake/2008-March/020576.html)。

 **简而言之，您需要在语句中`WIN32`添加`add_executable()`：

```
add_executable(GuiApplication WIN32 src/main.cpp) 
```

有关更多详细信息，请参阅 和 上的 CMake[`add_executable`](https://cmake.org/cmake/help/latest/command/add_executable.html)文档[`WIN32_EXECUTABLE`](https://cmake.org/cmake/help/latest/prop_tgt/WIN32_EXECUTABLE.html#prop_tgt:WIN32_EXECUTABLE)。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-04-20T09:21:33.720

简短的回答是包含 Qt testlib 会导致控制台出现。删除它使它消失。

为了进一步解释，如果您的 .pro 文件将 testlib 添加到 QT，例如

```
QT += sql \
    webkit \
    network \
    testlib 
```

然后使用这样的行执行最后的链接步骤

```
g++ -enable-stdcall-fixup 
   -Wl,-enable-auto-import 
   -Wl,-enable-runtime-pseudo-reloc 
   -mthreads 
   -Wl 
   -Wl,-subsystem,console 
   -o debug\MyApp.exe object_script.MyApp.Debug  
   -L"c:\Qt\2009.01\qt\lib"  
   -lglu32 -lgdi32 -luser32 -lQtWebKitd4 -lQtTestd4 
   -lQtSqld4 -lQtGuid4 -lQtNetworkd4 -lQtCored 
```

我们已经使用控制台子系统了！我认为使用 testlib 会强制发生这种情况，以便测试输出有去处。

如果我们现在编辑 .pro 文件并删除对 testlib 的引用并重新构建，我们会得到一个像这样的链接步骤

```
g++ -enable-stdcall-fixup 
   -Wl,-enable-auto-import 
   -Wl,-enable-runtime-pseudo-reloc 
   -mthreads 
   -Wl 
   -Wl,-subsystem,windows 
   -o debug\Ammotin.exe object_script.Ammotin.Debug  
   -L"c:\Qt\2009.01\qt\lib" 
   -lglu32 -lgdi32 -luser32 -lmingw32 -lqtmaind -lQtWebKitd4 
   -lQtSqld4  -lQtGuid4 -lQtNetworkd4 -lQtCored4 
```

耶！子系统是窗口，不再是控制台窗口。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-10-06T04:32:10.580

我认为这不是这个特定答案的解决方案（除了 4 年后），但我认为很多登陆这个线程的人都会寻找这个设置：

项目 > 构建和运行 > 运行设置 > 运行 > **[x] 在终端中运行**

取消选择它并从 QtCreator 运行您的 GUI，而无需额外的终端窗口。然后终端输出将嵌入到 IDE 中。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-04-17T13:14:41.377

您需要确保提供了 -mwindows 开关。

**编辑：**

或者，您可以进入您的 makefile 并将其添加到您的链接器标志中：

```
-Wl,-subsystem,windows 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-18T17:44:07.570

确保您的 .pro 文件没有添加`console`到变量`CONFIG`中。您可以通过添加来做到这一点

```
CONFIG -= console 
```

.pro 文件末尾的某处。If `CONFIG`contains`console`每次启动程序时都会弹出一个窗口，并且在打印调试输出时也会使用此窗口。因此，`console`在调试程序时添加可能很有用。否则，您需要使用[DebugView](http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx)之类的工具来显示`qDebug()`调用的输出。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2011-11-13T17:49:33.953

我使用 cmake 而不是 qmake。我使用 set(CMAKE_CXX_FLAGS "-mwindows") 似乎 QMAKE_CXXFLAGS +=-mwindows 在你的 .pro 文件中会做同样的事情。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-17T13:28:02.047

听起来您的链接器设置是为控制台应用程序设置的。您可以尝试将链接器设置为使用 /subsystem:windows 选项。控制台应用程序的选项是 /subsystem:console。如果您在 Visual Studio 中构建项目，请创建一个 Win32 项目。不要创建 Win32 控制台应用程序。Visual Studio 下用于设置子系统的选项位于 Project Settings->Linker->System->SubSystem 下。选择 Windows（/子系统：windows）。

我研究了如何使用 MinGW/gcc 做到这一点。[gcc](http://gcc.gnu.org/onlinedocs/gcc/i386-and-x86_002d64-Windows-Options.html)的在线文档显示了 Windows 目标的不同选项。就像其他人所说的那样，您正在寻找的选项是 -mwindows。选项 -mwindows 创建一个窗口应用程序。您当前的设置似乎是 -mconsole。选项 -mconsole 生成一个控制台应用程序。这是一个链接器选项。我不熟悉 Qt Creator，但我猜它有类似的方式来查看 Visual Studio 的项目设置。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-02-17T20:11:16.373

转到：`Projects --> Run`并取消选中`Run in terminal`复选框

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-17T13:46:27.167

默认情况下，链接器假定您需要一个控制台应用程序。

修复方法是将“-mwindows”添加到编译器的参数列表中，这也将不可见地添加所需的库（-lkernel32、-lgdi32 等）。您可能需要从 main() 更改为 WinMain() 作为入口点。

**RE：您的编辑：** Qt 构建系统使用“spec”文件添加变量，您可以在 $QTDIR/qt/mkspecs 中找到它们。当您在 QCreator 中创建新的 Windows 应用程序时，它会将默认规范设置为“win32-g++”，这会自动设置正确的变量（Windows 应用程序、链接器标志等）。

当您在 Linux 下创建项目时，它使用了另一个规范，这导致了您的问题。您可以在“yourproject.pro.user”文件中查看当前规范。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-02-02T21:32:42.097

Qt/2009.05/qt/mkspecs/win32-g++
编辑文件 qmake.conf
修改行
QMAKE_LFLAGS_CONSOLE = -Wl,-subsyetem,console
为
QMAKE_LFLAGS_CONSOLE = -Wl,-subsyetem,windows

并修改您的 ???.pro 文件（例如添加新行或空格）
并编译
它工作正常

# java - 重新实现“ToneMatrix”音频玩具

> ID：760329
> 
> 赞同：0
> 
> 时间：2009-04-17T13:04:19.140
> 
> 标签：java, audio, memory-management, jfugue

有一个非常酷的音频“玩具”，叫做[ToneMatrix](http://lab.andre-michelle.com/tonematrix)。我想将它重新实现为 Java 小程序。我尝试过使用[JFugue](http://www.jfugue.org/)和`player.play`单独的音符来进行声音和`Thread.sleep`计时，但结果很糟糕。

JFugue 在第 17 次（是的，真的，我数过）调用后停止响应，`player.play`并且`Thread.sleep`太不规则而无法提供良好的节奏。

你会推荐什么？基本上，我正在寻找一种简单的方法来动态生成单个音符。因此，在播放声音之前的几分之一秒，我需要能够查看数据并告诉音频库要播放哪些音符。（可能有多个和声音符。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T13:56:30.030

我的猜测是你忘记在 JFugue 中关闭音符，或者有一个错误是一旦开始就忘记停止播放音符。

使用 MIDI 是一种非常简单的方法来做你正在谈论的事情。以下是 midi 包中一些有用的方法，可以帮助您入门：

```
Synthesizer synth = MidiSystem.getSynthesizer();
synth.open();
MidiChannel midiChannel = synth.getChannels()[0];
midiChannel.allNotesOff();
currentInstrument = synth.getAvailableInstruments()[index];
System.out.println("Switching instrument to #" + index + ": " + currentInstrument.getName());
synth.loadInstrument(currentInstrument);
midiChannel.programChange(currentInstrument.getPatch().getBank(), currentInstrument.getPatch().getProgram());
midiChannel.noteOn(noteNumber, velocity);
midiChannel.noteOff(noteNumber); 
```

# asp.net - ContentPlaceHolders：重复内容

> ID：760334
> 
> 赞同：10
> 
> 时间：2009-04-17T13:05:30.947
> 
> 标签：asp.net, master-pages, contentplaceholder

# 设想

我有一个使用 asp.net Master Pages 的应用程序，我想在其中重复页面顶部和底部的一些内容。目前我使用这样的东西：

母版页

```
<html>
  <body>
    <asp:ContentPlaceHolder ID="Foo" runat="server">
    </asp:ContentPlaceHolder>
    <!-- page content -->
    <asp:ContentPlaceHolder ID="Bar" runat="server">
    </asp:ContentPlaceHolder>
  </body>
</html> 
```

内容页

```
<asp:Content ID="Top" ContentPlaceHolderID="Foo" runat="server">
  <!-- content -->
</asp:Content>
<asp:Content ID="Bottom" ContentPlaceHolderID="Bar" runat="server">
  <!-- content repeated -->
</asp:Content> 
```

# 维护

如您所知，在代码中重复内容通常不好。它会产生维护问题。以下是我想做的，但由于重复的 id 属性显然不起作用：

母版页

```
<html>
  <body>
    <asp:ContentPlaceHolder ID="Foo" runat="server">
    </asp:ContentPlaceHolder>
    <!-- page content -->
    <asp:ContentPlaceHolder ID="Foo" runat="server">
    </asp:ContentPlaceHolder>
  </body>
</html> 
```

内容页

```
<asp:Content ID="Top" ContentPlaceHolderID="Foo" runat="server">
  <!-- content (no repetition) -->
</asp:Content> 
```

# 可能的？

有没有办法使用 asp.net webforms 做到这一点？解决方案不一定要与上述内容相似，它只需要以相同的方式工作。

# 笔记

我在 Visual Studio 2008 中使用 asp.net 3.0

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-10-03T16:05:26.223

嘿，如果有人仍然需要解决这个问题，我就是这样做的：把它放在你的母版页的代码文件中

```
protected override void RenderChildren(HtmlTextWriter writer)
{
    Control mainPlaceHolder = FindControl("MainContentPlaceHolder");
    Control doublePlaceHolder = FindControl("ContentDoublePlaceHolder");

    StringBuilder sb = new StringBuilder();

    using (StringWriter sw = new StringWriter(sb))
    using (HtmlTextWriter tw = new HtmlTextWriter(sw))
    {
        mainPlaceHolder.RenderControl(tw);
    }

    LiteralControl lc = new LiteralControl(sb.ToString());
    doublePlaceHolder.Controls.Add(lc);

    base.RenderChildren(writer);
} 
```

我不确定这里的性能问题，但它确实有效。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-08-31T16:38:26.700

如果您只想重复一个字符串，这对我有用：

```
<asp:ContentPlaceHolder ID="TitleContent" runat="server" /> 
```

可以在别处引用为：

```
<%  Dim title As LiteralControl = TitleContent.Controls.Item(0)
    Response.Write(title.Text)
%> 
```

但不保证这是正确的行动方案:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-17T13:23:55.100

正如其他人所说，根据内容本身，可以根据内容的类型采取捷径。

但是，假设您需要“内容”来完全运行 asp.net 代码，那么我建议为每个包含内容本身的 ContentPage 使用 UserControl，然后您只需要复制一行代码。

例子

母版页

```
<html>
    <body>
        <asp:ContentPlaceHolder ID="Foo" runat="server">
        </asp:ContentPlaceHolder>
        <!-- page content -->
        <asp:ContentPlaceHolder ID="Bar" runat="server">
        </asp:ContentPlaceHolder>
    </body>
</html> 
```

内容页

```
<asp:Content ID="Top" ContentPlaceHolderID="Foo" runat="server">
    <uc1:Page1Control id="page1Control1" runat="server" />
</asp:Content>
<asp:Content ID="Bottom" ContentPlaceHolderID="Bar" runat="server">
    <uc1:Page1Control id="page1Control2" runat="server" />
</asp:Content> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T13:15:15.213

您可以为其创建一个 COMMON 用户控件，并将其添加到顶部和底部的母版页中。您可以创建一个属性来描述控件是在顶部还是底部加载。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T13:15:30.643

根据内容，您可能可以在代码中执行此操作。如果它只是 HTML，只需将它放在一个变量中并将其分配给另一个。如果您有控件，您可以遍历控件集合并创建一个复制控件并将其放置在另一个区域中。在任何一种情况下，第二个位置都不是 div 应该到期的内容占位符。

# c# - 我如何验证 wpf 绑定是否将用于真实属性？

> ID：760336
> 
> 赞同：5
> 
> 时间：2009-04-17T13:06:53.360
> 
> 标签：c#, .net, wpf, unit-testing

我想要一种简单的方法来确保我在 xaml 文件中声明的所有绑定都转到真实属性。更好的是，我想在单元测试中实例化我的 wpf 窗口并调用一个方法来确保绑定是正确的。

不幸的是，如果我有什么问题，wpf 甚至不会抛出异常。这让我有责任在 QA 阶段“发现”问题。

有谁知道我可以更好地验证我的绑定的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-17T13:51:56.467

次优方法是在可视化树中搜索所有依赖属性，然后检查：

```
var bindingExpression = BindingOperations.GetBindingExpressionBase(dependencyObject, dependencyProperty);

if (bindingExpression != null)
{
    var status = bindingExpression.Status;
} 
```

如果`status`是，`Unattached`则表达式尚未解析。

当然，您不希望在生产应用程序中执行此操作，但在调试或集成测试场景中可能有意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T15:22:01.897

数据绑定错误显示在 Visual Studio 输出窗口中。例如，假设我想将 TextBlock 绑定到 Window 的 Title 属性，但我将“Title”错误地输入为“Ritle”。我将在输出窗口中看到：

> System.Windows.Data 错误：39：BindingExpression 路径错误：在“对象”“MessageWindow”（名称=“Window”）上找不到“Ritle”属性。BindingExpression：路径=Ritle；DataItem='MessageWindow' (Name='Window'); 目标元素是'TextBlock'（名称='WindowTitle'）；目标属性是“文本”（类型“字符串”）

通过使用跟踪源，您可以更好地控制这些消息的报告方式。 Bea Stollnitz 的[这篇文章更详细地描述了这一点。](http://www.beacosta.com/blog/?p=52)

# visual-c++ - 如何将功能区菜单添加到现有 MFC 应用程序？

> ID：760339
> 
> 赞同：5
> 
> 时间：2009-04-17T13:08:27.180
> 
> 标签：visual-c++, mfc, ribbon, mfc-feature-pack

Microsoft Visual C++ 2008 Feature Pack 支持功能区菜单。是否可以在未使用功能区菜单创建的现有 MFC 应用程序中使用它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T13:47:38.163

当然可以采用现有的 MFC 应用程序并对其进行更新以使用 MFC 功能包中的功能区，我自己已经完成了这项工作。

在 MSDN 上有几篇演练文章[，](http://msdn.microsoft.com/en-us/library/bb982451.aspx)展示了如何使用您可能熟悉的 Scribble MFC 示例应用程序来执行此操作。

本质上，您需要做的是更改代码以使用 Feature Pack 基类而不是标准 MFC 基类 - 例如，替换`CWinApp`为`CWinAppEx`、`CFrameWnd`with`CFrameWndEx`等。然后您可以将对象添加`CMFCRibbonBar`到`CMFCRibbonApplicationButton`主窗口类以创建丝带本身。要开始，我建议下载 Scribble 示例并遵循演练文章。

我希望这有帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-19T02:53:13.600

除了 ChrisN 指出的资源，我建议创建一个新的 MFC 应用程序，其中包括一个功能区并检查生成的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T13:29:56.223

是的，当然可以使用随 MFC 功能包提供的功能区类。

此处提供了基本介绍：[新 MFC 功能快速浏览](http://blogs.msdn.com/vcblog/archive/2007/11/09/quick-tour-of-new-mfc-functionality.aspx)和更详细的教程可在此处找到：[MFC 功能包教程](http://nibuthomas.com/tutorial_mfc_feature_pack1_part1/)。

但是，请注意，它附带了一个相当严格的许可证。有关条件，请参阅[许可 2007 Microsoft Office 用户界面](http://blogs.msdn.com/jensenh/archive/2006/11/21/licensing-the-2007-microsoft-office-user-interface.aspx)和有关SO 的[相关讨论。](https://stackoverflow.com/questions/563312/is-the-ms-ribbon-office-ui-license-worth-worrying-about)

# delphi - Delphi 中的 ActiveX 控件出现“无效浮点”错误

> ID：760348
> 
> 赞同：0
> 
> 时间：2009-04-17T13:10:21.060
> 
> 标签：delphi, activex

供应商开发了 Microsoft C++ 中的 ActiveX 控件。当他们使用 16 位版本的编译器时，ActiveX 运行良好。在 Delphi2007/D7 环境中使用 32 位版本编译时，该控件不起作用。如果您将控件放在窗体上并运行它会引发“浮点错误”。

这是一个德尔福问题。我们可以在其他应用程序中使用 ActiveX。

有人遇到过类似的问题或有解决方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-17T14:23:18.343

听起来像是一个 FPU 问题——查看 Delphi 帮助文件中的 Set8087CW。

# java - 除了 BouncyCastle 还有其他开源 JCE 库吗？

> ID：760358
> 
> 赞同：3
> 
> 时间：2009-04-17T13:14:48.257
> 
> 标签：java, cryptography, rsa, bouncycastle, jce

我正在寻找实现一些更深奥的加密算法的开源 JCE 库，以便我可以研究它们的实现。我对那些实施斯坦福大学发布的基于身份的加密（IBE）的人特别感兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T13:24:15.130

[GNU Classpath](http://www.gnu.org/software/classpath/)也有自己的 JCE 实现，但是，它们是否支持 IBE 是另一回事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T13:29:07.380

Cryptix（目前不确定它的状态，但我上次使用它时质量很高）：

[http://www.cryptix.org](http://www.cryptix.org/)

[http://sourceforge.net/projects/cryptix](http://sourceforge.net/projects/cryptix/)

# sharepoint - 不需要的 SharePoint 上下文菜单

> ID：760363
> 
> 赞同：1
> 
> 时间：2009-04-17T13:16:10.657
> 
> 标签：sharepoint

我创建了一个可以正常工作的自定义查找字段类型。但是，这种类型的列中的每个项目都有一个上下文菜单。

![不需要的 SharePoint 下拉菜单](https://i.stack.imgur.com/hOfby.png)

我**没有故意**添加此上下文菜单。

如何摆脱它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-17T16:49:00.113

如果您转到`View`-> `Modify this View`，您可以从您希望在默认视图中显示的字段中进行选择。某些字段应该有几个选项，默认情况下您可能拥有的选项类似于`medium city (linked to document with edit menu)`. `medium city`自行选择，你应该很高兴！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T14:07:48.907

我解决了这个问题。

源列表“城市”有三列 - “城市名称”、“城市名称（链接到项目）”和“城市名称（链接到带有编辑菜单的项目）”。
当我在“客户”列表中创建“中等城市”列时，我从下拉列表中选择了“城市名称”。我很肯定这是第 1 列，但结果却是第 3 列。
我修改了用数据填充下拉列表的代码，因此它不包含*与项目*列的链接，现在它工作正常。

# .net - 强制 web 应用程序使用 .net framework 1.1

> ID：760366
> 
> 赞同：1
> 
> 时间：2009-04-17T13:16:35.040
> 
> 标签：.net, frameworks

我们有一个 web 应用程序，取决于 .net framework 1.1 的安装。如果用户安装 .net framework 2.0 作为附加组件，或者如果用户只安装了 .net framework 2.0，某些功能会被破坏，从而导致错误消息以 :" Message: Request for the permission of type 'system.net.WebPermission ，系统，版本=2.0.0.0....."

有什么方法可以定义 Web 应用程序仅使用 .net 框架而不修改代码？也许在 IIS 的 web.config 中？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T13:21:00.253

在 IIS 中，转到 ASP.NET 选项卡（文件夹属性），并将其更改为 1.x。那应该这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T13:22:18.583

您应该能够在 IIS 中访问网站的属性并指定您将在其下运行的 .Net 版本。

这是在服务器上到达那里的方法...

```
Start Menu>(Right+Mouse+Click)MyComputer>Manage>Services And Applications>IIS>Websites>(Right+Mouse+Click) [your website]>Properties>Asp.Net>Asp.Net Version 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T13:22:33.840

在 IIS 中，您可以将网站配置为使用任一已安装的框架：

1.  在 IIS 中，右键单击网站或应用程序，选择属性
2.  转到 ASP.NET 选项卡
3.  选择要使用的 ASP.NET 版本

# java - 流行的 JSP/Servlet/Portlet 错误日志查看器？

> ID：760373
> 
> 赞同：5
> 
> 时间：2009-04-17T13:20:35.527
> 
> 标签：java, error-reporting, error-logging

在阅读了最新的 Coding Horror 帖子后，我想知道开源社区中是否有基于 Java 的 ELMAH 版本？一个可配置的 JSP/Servlet/Portlet WAR，我可以将其放入大多数服务器中，并有一个不错的 GUI 用于查看系统中的日志。有人有项目可以推荐吗？

> ### 重复
> 
> [Java中的异常驱动编程](https://stackoverflow.com/questions/760397/exception-driven-programming-in-java)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-18T03:18:54.017

[http://www.baremetalsoft.com/baretail/](http://www.baremetalsoft.com/baretail/)

[http://www.moonlit-software.com/logfaces/web/index.php](http://www.moonlit-software.com/logfaces/web/index.php)

# c# - 寻找用不同语言编写的示例程序

> ID：760376
> 
> 赞同：2
> 
> 时间：2009-04-17T13:21:00.097
> 
> 标签：c#, c, oop, programming-languages, procedural-programming

作为了解 OOP 和过程语言之间差异的一种方式，我一直在寻找用 C 和 C++ 或 C# 或 Java 编写的示例程序。我只是想看看解决同一问题的不同方法，以帮助我了解真正的差异。有谁知道我在哪里可以找到这样的教程？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-17T13:54:04.370

我不认为这可能会教给你很多东西。在不同编程范式之间的差异真正显示出来之前，程序必须具有一定的大小。如果同一个程序用不同的语言编写，人们不太可能写出相同的副本，除非该程序是微不足道的。

大多数现实生活中的例子也会被很多额外的噪音污染，这些事情可以在一种语言的标准库中完成，但需要另一种语言的第三方库。编写它的程序员可能更熟悉一种语言而不是另一种语言，因此他在某些语言中的实现并不代表它“应该”如何完成。

您更有可能以通常的方式了解这些范式之间的区别。通过了解每个含义以及如何使用它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-17T13:31:06.283

我推荐[99瓶啤酒](http://99-bottles-of-beer.net/)网站

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-17T13:25:08.747

您可以随时查看[Project Euler](http://projecteuler.net/)。人们用许多不同的语言解决同样的问题。大多数人会发布他们的解决方案，您也可以在解决问题后访问这些解决方案。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-17T13:31:19.917

看看[计算机语言基准游戏](http://shootout.alioth.debian.org/)。它以您能想象到的几乎所有语言实现了各种程序。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-17T13:25:50.850

对于您的目的来说，这可能有点简单，但[Hello World Collection](http://www.roesler-ac.de/wolfram/hello.htm)总是很有趣。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-17T13:45:46.967

[Rosetta Code](http://rosettacode.org)拥有丰富的数据，但与过程/面向对象的区别相关的数据很少。您还应该看到他们收集的[相关网站](http://www.rosettacode.org/wiki/Help:Similar_Sites)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-17T13:51:09.340

[多种语言的 Black Scholes](http://www.espenhaug.com/black_scholes.html)有很多 Black-Scholes 公式的实现。该公式在 Objective-C/iPhone、F#、Autoit、Fortress、Lua、APL、SAS、Mathcad、J、MEL、Postscript、VB.NET、Clean、Ruby、Lisp、Prolog、PL/SQL、LyME、ColdFusion 中实现, K, C#, HP48, Transact SQL, O'Caml, Rebol, Real Basic, Icon, Squeak, Haskell, JAVA , JavaScript, VBA, C++, Perl, Maple, Mathematica, Matlab, S-Plus, IDL, Pascal, Python 、Fortran、Scheme、PHP、GNU、gnuplot。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-17T19:59:04.290

这是两个实现 n-body 的程序

[**Java 实现**](http://shootout.alioth.debian.org/u32/benchmark.php?test=nbody&lang=java&box=1)

[**C 实现**](http://shootout.alioth.debian.org/u32/benchmark.php?test=nbody&lang=gcc&box=1)

你发现它们之间有什么不同？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-17T14:40:52.123

前几天有人在 Reddit 上发布了 Evil Walrus / ReFactory：

[http://www.refactory.org/](http://www.refactory.org/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-12-09T03:36:07.113

考虑蛇和梯子游戏的实现

在程序设计中，我们可能会编写如下函数

```
function move(int n) {
    pos += n;
    switch(pos) {
        case 6: pos = 10; break;
        case 12: pos = 4; break;
        case 15: pos = 32; break;
        case 16: pos = 8; break;

        // ...

    }
 } 
```

在对象设计语言中，我们将创建一个实例链接列表，`Square`其中一些实例分支到其他方块。`Ladder``Snake`

```
class Square
  def initialize(next)
    @tokens = []
    @next = next
  end
  def next(n)
    n == 0 ? self : next.next(n-1)
  end
  def move(token,n)
    tokens.remove(token)
    target = self.next(n)
    target.tokens << token
  end
end

class SnakeOrLadder < Square
  def initialize(next,branch)
    super(next)
    @branch = branch
  end
  def next(n)
    # goes to branch when landing on this square!
    n == 0 ? @branch : next.next(n-1)
  end
end 
```

如您所见，我们在对象中实现游戏规则*以及*它们的组合方式（而不是在 switch case 语句中）。这样做的好处是

*   在开发时添加新的游戏规则很简单，您只需编写一个新的 Square 子类
*   在运行时更改游戏布局很简单（对于游戏来说可能听起来很奇怪，但对于您的普通商业应用程序来说，这就是您想要的）

这种灵活性使 OO 如此强大。

# python - 自更新 py2exe/py2app 应用程序

> ID：760383
> 
> 赞同：13
> 
> 时间：2009-04-17T13:22:58.940
> 
> 标签：python, deployment, patch, py2exe

我维护一个跨平台应用程序，基于在 linux mac 和 windows 上运行的 PyQt。

windows 和 mac 版本使用 py2exe 和 py2app 分发，它们会产生相当大的包 (~40 MB)。

我想添加一个“自动更新”功能，基于补丁来限制下载大小：

*   在 http 服务器上检查新版本
*   下载更新到最新版本所需的补丁
*   应用补丁列表并重新启动应用程序

我有一些疑问：

*   由于打开的文件被锁定且无法覆盖，因此更新 Windows 应用程序的首选方法是什么？
*   如何准备和应用补丁？也许使用[bsdiff/pspatch](http://www.daemonology.net/bsdiff/)？

**[更新]**

我做了一个简单的类来使用[bsdiff](http://www.daemonology.net/bsdiff/)制作补丁，这在他们的网站上宣传非常有效：我的应用程序的两个 py2exe 版本（未压缩约 75 MB）上的差异会产生一个 44 kB 的补丁！对我来说足够小，我会坚持这种格式。

该代码可在[pyflu](http://pypi.python.org/pypi/pyflu)的“更新”包中找到，这是一个小型 Python 代码库。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-17T13:48:34.447

我不相信 py2exe 支持补丁更新。但是，如果您不将整个包捆绑到单个 EXE 中（[py2exe 网站示例](http://www.py2exe.org/index.cgi/SingleFileExecutable)- 页面底部），**您可以通过替换某些文件**（例如 EXE 文件）来避免较小的更新。这可以显着减少更新的大小。

您可以编写一个单独的**更新程序应用程序**，它可以从您的应用程序内部下载/运行。此应用程序可能因每次更新而有所不同，因为需要更新的文件可能会发生变化。

应用程序启动更新程序后，需要自行关闭，以便覆盖文件。更新程序完成后，您可以让它在关闭之前重新打开应用程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-17T13:47:47.710

我不知道补丁，但在 OS X 上，可可应用程序的“标准”是[Sparkle](http://sparkle.andymatuschak.org/)。基本上它会“应用广播”。它每次都会下载完整的应用程序。可能值得一看它以获得灵感。

我想在 OS X 上，您可能只需下载包含您的特定代码的应用程序包的实际部分（而不是打包的库等），并且在包中相当小且易于替换。

在 Windows 上，您可能可以通过不将您的应用程序捆绑到一个 exe 中来执行类似的技巧 - 从而让您更改一个实际更改的文件。

我想你的实际 Python 代码将远小于 40Mb，所以这可能是要走的路。

至于替换正在运行的应用程序，首先你需要找到它的位置，这样你就可以用它`sys.executable`来获得一个起点，然后你可以派生一个子进程，杀死父进程并让子进程进行实际替换？

我目前正在玩一个小的 wxPython 应用程序，并想知道这个问题。我很想听听你的想法。

压缩时你的应用程序有多大？如果它压缩得很好，那么也许你仍然有能力发送整个东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-09T05:02:48.827

现在已经 4 岁了，但是[Esky](https://pypi.python.org/pypi/esky)呢？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T15:06:33.260

由于 py2exe 将应用程序的所有已编译模块放入一个 ZIP 文件中，因此您可以尝试通过创建一个脚本来更新此文件，该脚本从给定的文件集更新它。然后替换已更改的剩余文件（如果有的话，应该很少）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-12-14T14:59:23.737

一个旧帖子，但我想我会提到 pyupdater 和 pyinstaller。

它支持亚马逊和scp。

未来，根据最近的 github 帖子，他们计划支持免费替代品。

# sharepoint - MOSS 2007 服务器挂起问题 - AppDomainUnloadListener.RegisterSelf() & PublishingHttpModule.Init()

> ID：760386
> 
> 赞同：2
> 
> 时间：2009-04-17T13:23:40.623
> 
> 标签：sharepoint, sharepoint-2007, moss

最近 Sharepoint 服务器不时挂起；当我看到日志时，我发现了很多这样的条目，

04/17/2009 10:07:09.51 w3wp.exe (0x11C0) 0x0CF8 CMS Publishing 8zug Medium PublishingHttpModule.Init() 调用 AppDomainUnloadListener.Register()
04/17/2009 10:07:09.51 w3wp.exe (0x11C0) 0x0CF8 CMS发布 8x0a 高 AppDomainUnloadListener.RegisterSelf() 进入锁（this=3183676）

我不知道这意味着什么，这是否会导致 Serving Hanging 问题？谁能解释这个错误？

提前致谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-20T00:43:55.993

您的服务器场负载平衡吗？

如果是这样，则此问题（仅由上述错误引用，因此，如果您的场不是，这可能确实不是您的解决方案）可能是由于负载平衡配置不正确造成的。

当尝试在端口 80 上对 url 进行负载平衡时，该问题已在其他论坛中出现，这些 url 的 Web 应用程序位于 80 以外的端口上。不在端口 80 上的应用程序的负载平衡 url 需要包含端口号。

Sharepoint 会自动将端口号放在负载平衡 URL 的末尾，因此如果您希望负载平衡 URL 全部位于端口 80 上，则需要配置主机标头并在端口 80 上设置 Web 应用程序。

# testing - 远程访问应用程序的自动化工具

> ID：760392
> 
> 赞同：0
> 
> 时间：2009-04-17T13:24:37.000
> 
> 标签：testing

我正在使用 citrix 远程访问应用程序。我无法使用 winrunner，因为它无法识别对象，因为应用程序未安装在工作 PC 上。是否有任何工具可以自动化此类应用程序

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-23T18:35:03.697

Citratest 适用于您所描述的内容，但它**不是**开源的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T14:47:21.560

你看过使用[AutoIt](http://www.autoitscript.com/autoit3/index.shtml)吗？它有一个内置的记录器来记录您的击键和鼠标移动/点击，然后您可以将其转储到脚本中并播放。您还可以引用某些显示并执行特殊操作的窗口，例如隐藏它们或添加/删除控件......实际上几乎是您想要的任何东西。他们还有一个很棒的社区论坛，请参见[这里](http://www.autoitscript.com/forum/index.php?)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-23T07:25:53.683

tevron Citrab 测试工具是开源工具吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T14:38:01.350

Citrix 有一个名为[EdgeSight](http://www.citrix.com/english/ps2/products/product.asp?contentID=25119)的产品。 [Tevron](http://www.tevron.com)有一种名为 CitraTest 的产品。

# php - PHP 和 Fusion Chart API 问题

> ID：760393
> 
> 赞同：0
> 
> 时间：2009-04-17T13:24:51.150
> 
> 标签：php, charts

我正在使用 PHP 的 Fusion Chart Free API。文档声明您可以从任何类型的数据库查询生成图表，但是当我尝试传递除 mySQL 结果之外的结果时。但是，当我尝试此操作时： $FC->addDataFromDatabase($result, "SALES", "ITEM"); 如果 $result 是有效的 DB2 结果集，我会收到此错误。

“mysql_fetch_array()：提供的资源不是有效的 MySQL 结果”错误“有人知道我如何告诉 Fusion 图表使用不同的数据库类型吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-17T13:35:59.190

[他们论坛上的这篇](http://www.fusioncharts.com/forum/Topic7278-31-1.aspx#bm7290)帖子表明他们目前只支持 MySQL 数据库结果。您可以使用其中一种其他方法来提供数据或自己扩展 addDataFromDatabase 函数。

# java - 当 Quartz 调度程序关闭时，我需要执行一项任务

> ID：760394
> 
> 赞同：0
> 
> 时间：2009-04-17T13:24:56.797
> 
> 标签：java, quartz-scheduler

我有一个要求，当我的 Quartz 将被关闭时，我必须执行某些与数据库相关的活动。我的意思是当我关闭调度程序时，我必须从数据库中清除某些数据。有什么办法可以做到这一点？

在谷歌搜索时，我遇到了确定调度程序当前状态的方法。但是，有没有办法可以捕获这个调度程序关闭事件。

提前致谢， 伊布

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-17T13:34:24.637

您可以添加一个[ScheduleListener](http://www.opensymphony.com/quartz/api/org/quartz/SchedulerListener.html)并监视[schedulerShutdown()](http://www.opensymphony.com/quartz/api/org/quartz/SchedulerListener.html#schedulerShutdown%28%29)上的调用吗？

例如，实现一个 ScheduleListener 的实例（它可能*只会*为实现 schedulerShutdown() 做一些事情。

然后使用 Scheduler.addSchedulerListener() 将其添加到您的调度程序实例中。这样，当调度程序关闭时，您的 SchedulerListener 实例应该得到回调。

这假设调度程序完全关闭。您*可能*必须添加一个 Runtime [shutdownHook](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Runtime.html#addShutdownHook%28java.lang.Thread%29)来要求调度程序关闭。

# c# - C#：如何在备忘录中添加一行？

> ID：760395
> 
> 赞同：3
> 
> 时间：2009-04-17T13:25:04.770
> 
> 标签：c#, winforms

我有一个想要添加行的 RichBox(memo)。

目前，我用这个

```
RichBox1.text += "the line I'd like to add" + "\n"; 
```

下面的Delphi中没有类似的方法吗？

```
Memo.Lines.add('The line I''d like to add'); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-17T13:31:30.573

[AppendText](http://msdn.microsoft.com/en-us/library/system.windows.forms.textboxbase.appendtext(VS.71).aspx)是最接近的。不幸的是，您仍然必须附加换行符：

```
RichBox1.AppendText( "the line I'd like to add" + Environment.NewLine ); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-17T13:34:30.830

您可以使用扩展方法将此方便的`add`方法添加到 RichTextBox 类。 [http://msdn.microsoft.com/en-us/library/bb383977.aspx](http://msdn.microsoft.com/en-us/library/bb383977.aspx)

```
public static class Extension
{
    public static void add(this System.Windows.Forms.RichTextBox richText, string line)
    {    
       richText.Text += line + '\n';
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T13:32:41.427

您可以使用 TextBoxBase 中的 AppendText 方法并显式添加新行

```
RichBox1.AppendText("the line i'd like to add" + Environment.NewLine); 
```

# c# - Java中的异常驱动编程

> ID：760397
> 
> 赞同：21
> 
> 时间：2009-04-17T13:25:17.263
> 
> 标签：c#, java

我刚读完[异常驱动编程](https://blog.codinghorror.com/exception-driven-development/)，我想知道类似[ELMAH](https://code.google.com/archive/p/elmah/) for Java 的东西。你知道它吗？

有趣的特点：

*   用于远程查看重新编码异常的整个日志的网页
*   用于远程查看任何记录的异常的完整详细信息的网页
*   每个错误发生时的电子邮件通知
*   来自日志的最后 15 个错误的 RSS 提要
*   其他接口（JSON、RESTful 接口等）
*   日志的多种后备存储实现，包括内存中、JDBC、JMS 等
*   开源

**笔记**

log4j 用于日志记录，它不是异常处理的集成解决方案

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-02-20T19:18:40.260

这是一个老问题，但我没有看到一个公认的答案，所以......

我很高兴地宣布[LogDigger 连接器](http://logdigger.com)库 v3.0：

*   如果出现错误，收集请求级数据和日志。
*   可以使用内存或 JDBC 进行存储。
*   具有内置的 Web 界面（类似于 ELMAH）。
*   可以通过电子邮件发送通知，您可以使用 RSS 收集它们或实现自己的机制。
*   可以跟踪用户操作并在错误报告中包含最近的使用历史记录。
*   非常轻量级（500KB），没有外部依赖项（显然除了 JDBC 驱动程序和 JavaMail API，如果你想发送电子邮件）。

# svn - 将 subversion 存储库分支到分布式 CMS

> ID：760398
> 
> 赞同：2
> 
> 时间：2009-04-17T13:25:45.267
> 
> 标签：svn, content-management-system, bazaar

我有一个问题，我不确定最好的解决方法。我一直在做一个需要我去中国进行安装和集成的项目。我的代码从一开始就被颠覆了，因为那是我过去知道并使用过的。我现在担心我在中国期间可能无法办理登机手续。

我认为在我离开时创建一个分支并使用 bazaar-cvs 并在我回来时将更改合并回 subversion 存储库可能是个好主意。

有什么需要注意的警告吗？我会丢失我的提交日志吗？任何完成 CMS 转换的人的建议将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-24T19:29:18.380

bzr-svn 是 bzr 的插件，它允许您将 svn 主干的副本作为 bzr 分支，对其进行处理，然后将您的工作转换回 svn 而不会丢失任何内容。在 Windows 和 Linux 上运行良好。该插件是标准 Windows 安装程序（独立安装程序）的一部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-17T13:52:37.837

我建议使用 git-svn。它是带有 svn 集成的 git。我将它用于我的内部开发，因为远程 SVN 服务器并不总是在线。您可以获得分布式本地存储库的好处，并且稍后可以使用单个命令轻松地将更改提交回 SVN：

`git svn dcommit`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T13:31:45.783

我从未使用过它，但您可能想查看 SVK。这是一个基于SVN的分布式版本控制。这允许您在“离线”时进行签到和其他操作。

[http://en.wikipedia.org/wiki/SVK](http://en.wikipedia.org/wiki/SVK) [http://svk.bestpractical.com/view/HomePage](http://svk.bestpractical.com/view/HomePage)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T13:36:27.377

你也可以试试 Git

[http://git-scm.com/](http://git-scm.com/)

它是一个分布式 CMS，它有一个很好的迁移工具，可以将 SVN 存储库转换为 Git。我自己从未使用过它，但它看起来很容易使用，并且很容易使用不同的协议在网络上发布公共 repo。

# sharepoint - Sharepoint-网站设置页面设 计

> ID：760401
> 
> 赞同：0
> 
> 时间：2009-04-17T13:26:54.280
> 
> 标签：sharepoint, designer

当我自定义设计 Settings.aspx 页面时，它看起来与我们设计的主页相同，一个错误是顶部导航菜单的选项卡与主页对齐不正确，我的错误是什么，请任何人帮助我..，

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-17T13:34:26.667

品牌本身就够难了，但标签似乎也总是给我带来问题。通常对我有帮助的是比较标签部分的呈现 HTML（查看源代码）的两个部分。通常情况下，会存在导致错位的细微差异。

希望有帮助。

# c# - IHierarchicalEnumerable 到 SiteMapPath？

> ID：760403
> 
> 赞同：1
> 
> 时间：2009-04-17T13:27:14.967
> 
> 标签：c#, asp.net, sitemap, sitemappath

是否存在在 SiteMapPath 控件中使用我的 IHierarchicalEnumerable 类的任何简单方法？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-25T06:34:36.657

我不确定它有多简单，但您需要实现一个[站点地图提供程序](http://msdn.microsoft.com/en-us/library/system.web.sitemapprovider.aspx)。

# xaml - XAML 绑定属性

> ID：760404
> 
> 赞同：0
> 
> 时间：2009-04-17T13:27:31.050
> 
> 标签：xaml, binding, properties

嗨，
有人可以指出某种文档，其中包含 Binding 类提供的属性及其值类型的完整列表。

```
<Image Source={Binding ......}/> 
```

**基本上是Binding**关键字之后的所有属性的列表。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T13:32:16.513

[绑定标记扩展 - WPF](http://msdn.microsoft.com/en-us/library/ms750413.aspx)

[绑定标记扩展 - Silverlight](http://msdn.microsoft.com/en-us/library/cc189022(VS.95).aspx)

# iphone - 如何使用矢量公式实现球的运动？

> ID：760418
> 
> 赞同：1
> 
> 时间：2009-04-17T13:30:38.407
> 
> 标签：iphone, objective-c, collision-detection

我正在做乒乓球比赛，我必须移动球并检测与外部边界以及移动桨的碰撞。我想使用向量而不是三角函数来实现它。

我的数学很弱，所以请指导我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T13:38:55.547

您可能需要更具体地了解您的需求。要知道的关键是，在弹跳球时，入射角等于反射角。然而，在类似乒乓球的游戏中，他们通常会根据它击中的球拍部分来改变角度（就好像球拍是一个弧线一样）。

对于使用向量，它有一个起点和一个斜率。如果起点是屏幕的左侧（x == 0），那么您很幸运，因为正常的斜率截距公式效果很好

```
Y = mX + B 
```

其中 M 是斜率，B 是它穿过 Y 轴的位置（X 为 0 时 Y 的值）。然后将 X 增加一些数量并计算 Y。在回击时，您可以向后执行此操作。当向量完全水平时，m 为 0。当它碰到桨时，为了保持入射角 == 反射角——你只需要使用 -m （根据桨上的位置进行调整）。

无论如何-如果您有任何问题，请对此答案发表评论或更新您的问题，我会尽力提供更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T13:39:41.520

GameDev.net 上有一个[很棒的关于碰撞检测的教程](http://nehe.gamedev.net/data/lessons/lesson.asp?lesson=30)。这是一个OpenGL教程，我不知道你是否使用OpenGL，但数学是一样的，所以我认为它会很有用。

# javascript - 如何在 Mozilla Firefox 3 上使用 Javascript 关闭窗口？

> ID：760422
> 
> 赞同：24
> 
> 时间：2009-04-17T13:31:20.730
> 
> 标签：javascript, firefox

我需要通过单击一个按钮来关闭显示我的网页的选项卡。但是firefox不允许通过javascript关闭窗口，只要它不是由javascript打开的。如果我将值设置`dom.allow_scripts_to_close_windows`为“true”，那么即使是正常的`window.close()`也可以。但这不是一个好的解决方案。:(

我尝试了其中一个论坛中建议的以下解决方法：

```
<script language="javascript" type="text/javascript">
function closeWindow() {
   window.open('','_parent','');
   window.close();
}
</script> 
```

它应该让浏览器误以为它实际上是由 javascript 打开的，但这在 Firefox 3 中不起作用。

任何人都可以建议一个解决方法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-01T07:06:40.303

```
function closeWindow() {
    netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserWrite");
    alert("This will close the window");
    window.open('','_self');
    window.close();
}

closeWindow(); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-17T20:42:24.640

出于安全原因，您的脚本无法关闭它未打开的窗口/选项卡。

解决方案是在导航历史的较早点显示年龄提示。然后，您可以根据他们的输入选择是否允许他们进入您的网站。

您可以简单地说“对不起”，或者将用户重定向到他们的主页，而不是关闭显示提示的页面。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-08-20T10:31:07.197

此代码适用于 IE 7 和最新版本的 Mozilla，尽管 Mozilla 中的默认设置不允许通过 javascript 关闭窗口。

这是代码：

函数 F11() { window.open('','_parent',''); window.open("login.aspx", "", "channelmode"); 窗口.close(); }

要更改默认设置：

1.在你的Firefox地址栏中输入“about:config”并输入；

2.确保你的“dom.allow_scripts_to_close_windows”是真的

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-12-10T08:48:43.440

self.close() 不起作用，您确定要关闭窗口而不是脚本生成的弹出窗口吗？

你们可能想看看这个：[https ://bugzilla.mozilla.org/show_bug.cgi?id=183697](https://bugzilla.mozilla.org/show_bug.cgi?id=183697)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-17T14:02:53.727

从用户体验的角度来看，您不希望被动地完成重大操作。

诸如关闭窗口之类的重大事件应该是用户操作的结果。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-03-10T02:55:14.360

如果浏览器人员将此视为安全和/或可用性问题，那么您的问题的答案就是不要关闭窗口，因为根据定义，无论如何他们都会为您的解决方法提出解决方案。关于为什么选择在 firefox bug 数据库中的原因有一个很好的总结[https://bugzilla.mozilla.org/show_bug.cgi?id=190515#c70](https://bugzilla.mozilla.org/show_bug.cgi?id=190515#c70)

所以，你可以做什么？

更改您网站的规范，以便为这些人提供解决方案。例如，您可以借此机会将他们引向合作伙伴。

也就是说，将其视为（可能）需要它的其他人的移交。例如，Hanselman 最近有一篇关于在其他类似情况下该怎么做的文章，即 404 错误：[http ://www.hanselman.com/blog/PutMissingKidsOnYour404PageEntirelyClientSideSolutionWithYQLJQueryAndMSAjax.aspx](http://www.hanselman.com/blog/PutMissingKidsOnYour404PageEntirelyClientSideSolutionWithYQLJQueryAndMSAjax.aspx)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-11-10T12:16:20.463

这段代码肯定会解决的

```
function closing() {
var answer = confirm("Do you wnat to close this window ?");
    if (answer){
        netscape.security.PrivilegeManager.enablePrivilege('UniversalBrowserWrite');
        window.close();
    }
    else{
        stop;
    }
} 
```

# msbuild - 选择一个 MSBuldTarget 以使用 Cruisecontrol.Net 启动

> ID：760423
> 
> 赞同：1
> 
> 时间：2009-04-17T13:31:21.027
> 
> 标签：msbuild, cruisecontrol.net, target

我想使用 CCNetRequestSource，它是启动 MSbuild 任务的触发器的名称。例如，当执行“toto”触发器时，我想在 MSBuild 上启动“toto”目标。是否可以？

这是一个夜间构建，我想在这个时候创建​​ MSI 文件和文档，我在 MSBuild 中创建了特定的目标，但我不知道如何仅在抛出特定触发器时执行它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-21T12:02:01.127

有 msbuild 语法可以帮助您解决这个问题。看看以下链接：

*   [MSBuild 任务 - 运行另一个项目](http://msdn.microsoft.com/en-us/library/z7f65y0d.aspx)
*   [MSBuild 中的条件构造 - 允许您在不同的项目配置之间进行选择](http://msdn.microsoft.com/en-us/library/ms164307(VS.80).aspx)

您应该尝试为 CruiseControl 添加一个外观构建文件以调用该文件，该文件将委托给您的解决方案文件，其构造类似于以下内容：

```
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <Choose>
            <!-- If the toto CCNETRequestSource was submitted -->
        <When Condition="'$(CCNetRequestSource)'=='toto'">
            <PropertyGroup>
                <Target Name="toto">
                    <MSBuild Projects="MyProject.sln" Properties="Configuration=Debug" Targets="toto" />
                </Target>
            </PropertyGroup> 
        </When>
            <Otherwise><!-- Place your standard build call here --></Otherwise>
    </Choose>
    </Target>
</Project> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T12:12:12.397

我这样做：

```
 <Project DefaultTargets="Integration" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
        <PropertyGroup>

            <Configuration Condition="'$(CCNetBuildCondition)' == 'ForceBuild'">Release</Configuration>
            <Configuration Condition="'$(CCNetBuildCondition)' != 'ForceBuild'">Debug</Configuration>
        </PropertyGroup>
      <Target Name="Integration" DependsOnTargets="ConstruireSolution;FaireDoc">
      </Target>
      <Target Name="ConstruireSolution" >
    <!-- with first build -->
<MSBuild Projects="MyBuild.sln" Properties="Configuration=$(Configuration)" Targets="Clean;Rebuild" />
    </Target>

    <Target Name="FaireDoc" Condition=" '$(CCNetRequestSource)' =='FaireDoc'">
    <!--Build to add when FaireDoc trigger is fired -->
<MSBuild Projects="C:\CI\Plateforme\Documentation\Doc.shfbproj" Targets="Build" />
      </Target> 
```

我选择这个解决方案是因为我总是需要第一个构建 :) 第二个目标是一个沙堡项目，只在晚上吃午饭 :)

# sql-server - 在 Reporting Services 中模拟“.contains()”

> ID：760425
> 
> 赞同：0
> 
> 时间：2009-04-17T13:31:39.697
> 
> 标签：sql-server, reporting-services, ssas

我在 Reporting Services 中有一个如下所示的数据集：

```
 ID  |  Type  | Name   
-----+--------+--------  
  1  |   A    | Mary  
  2  |   A    | Joe  
  3  |   D    | Steve  
 12  |   F    | Irving 
```

如果且仅当存在 type = A 的行时，我想显示一个文本框。基本上，我想做“Fields！Type.Contains（“A”）”并将可见性绑定到结果。这是一种倒退的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T14:05:52.440

如果 Type 列的值为 A，则使用返回 1 的表达式创建一个不可见列。创建该列的总和，并在 TextBox 的可见性属性后面的表达式中使用它。

# sql - 了解关系和 LDAP 的建模工具

> ID：760430
> 
> 赞同：1
> 
> 时间：2009-04-17T13:32:36.450
> 
> 标签：sql, database-design, ldap, data-modeling, visio

我正在寻找做一些建模，并希望有一个工具，它不仅可以捕获像 ERWIN 这样的关系模型，而且还允许我们轻松地移植到 LDAP 作为选项。

注意：Visio 可以连接到现有的 LDAP 服务器并进行绘图，但不允许您先建模然后部署，这与它的关系功能不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T13:47:04.827

我已经有几年没用过了，但微软有一个 Enterprise Architect 版本的 Visio，它允许数据建模。如果 Visio 不处理 LDAP，我会感到惊讶。

数据建模部分可能不像 ErStudio 那样广泛，但它允许对 ODBC 数据源和大多数其他基本数据建模功能进行逆向工程（至少它确实如此）。当我使用它时，他们刚刚开始转向数据建模，所以希望从那时起它会有所改进。

# language-agnostic - 您如何确定应用程序的最低硬件规格？

> ID：760434
> 
> 赞同：9
> 
> 时间：2009-04-17T13:33:20.863
> 
> 标签：language-agnostic, hardware, specifications

我们开发了一个企业应用程序，我们需要为其记录以下目标部署的最低硬件要求：

1.  厚客户端
2.  数据库/应用程序服务器（我们运行几个需要访问数据库的服务器端进程和一个文件服务器，通常是同一台机器）
3.  网络服务器

我们提出的一些想法包括基于我们的测试环境的要求，基于每个目标组件的最高规格的要求，以及基于当前可用硬件的规格。

你如何提出你的硬件规格？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T13:43:30.857

通常，我们将针对我们环境的最低建议（即客户端上的 .NET 或数据库上的 IIS/SQL Server 的最低建议）作为模糊的基准。

一般来说，我们根据客户端大小知道应用程序的应用程序大小/预期的数据库大小。

在此之后，我们根据使用 Windows PerfMon 进行的观察添加了一些“软糖”数字。我们在正常情况下运行时观察系统的客户端内存/cpu 使用情况。对于服务器层，我们还将考虑在负载条件下运行时的内存/处理器负载。

基于所有这些，我们得出了最好的猜测。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-17T13:35:51.390

我的测试环境中有一些机器，最低硬件和软件要求取决于这些机器。我认为这是定义此类指标的唯一“安全”方式。

在这些机器上，我每周至少运行 3 次所有类型的测试，确保在所有更改之后应用程序有足够的资源。所以如果你改变你的测试机器，你也会改变最低要求。

在一些项目中，我们与客户一起定义了最小值，并购买/建造了一些具有此最小值的测试机器以再次测试......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T13:37:12.510

我们在我们的环境中为用户机器使用最低基线规范，这些机器将在合理的客户期望范围内有效地运行软件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-17T13:42:48.783

我通常使用我的软件运行/依赖的操作系统或其他软件的系统要求。我相信这是一个很好的起点。

一些例子：

*   [https://help.ubuntu.com/7.04/installation-guide/i386/minimum-hardware-reqts.html](https://help.ubuntu.com/7.04/installation-guide/i386/minimum-hardware-reqts.html)
*   [http://msdn.microsoft.com/en-us/windowsserver/cc196364.aspx](http://msdn.microsoft.com/en-us/windowsserver/cc196364.aspx)
*   [http://www.sun.com/software/products/postgresql/techspecs.jsp](http://www.sun.com/software/products/postgresql/techspecs.jsp)
*   [http://www.microsoft.com/Sqlserver/2005/en/us/system-requirements.aspx](http://www.microsoft.com/Sqlserver/2005/en/us/system-requirements.aspx)
*   [http://java.com/en/download/help/6000011000.xml](http://java.com/en/download/help/6000011000.xml)
*   [http://msdn.microsoft.com/en-us/library/8z6watww(VS.80).aspx](http://msdn.microsoft.com/en-us/library/8z6watww(VS.80).aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-17T13:43:21.620

还要了解您选择的软件框架/平台的最低要求是什么。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T13:40:59.410

我们的大部分工作是通过与客户的直接合同工作，因此许多硬件规格直接来自客户以及他们当前在其环境中运行的内容（即必须能够在他们拥有的最糟糕的计算机上充分运行计划使用该应用程序）。

有时我们也可以说服他们将技术升级作为开发工作的一部分，但这种情况并不常见。

# java - 网络服务：代码或连接错误

> ID：760449
> 
> 赞同：0
> 
> 时间：2009-04-17T13:36:13.073
> 
> 标签：java, mysql, database, service

我认为我的代码或连接有问题...

我尝试连接到 MySQL 数据库和 Web 服务，但是当我运行该程序时，它给了我以下错误：

[替代文字 http://www6.0zz0.com/2009/04/17/13/808603628.jpg](http://www6.0zz0.com/2009/04/17/13/808603628.jpg)

> @WebService() 公共类 LostNumWebService {

```
/**
 * Web service operation
 */
@WebMethod(operationName = "getCategory")
public List getCategory(@WebParam(name = "city_name")
String city_name) {
    List cityName = null;
    try{
        String url = "jdbc:mysql://localhost:3306/mobileapplication";
        Connection conn = DriverManager.getConnection(url,"***","***");
        Statement stmt = conn.createStatement();
        ResultSet rs;
        rs = stmt.executeQuery("SELECT city_id, city_name FROM city WHERE city_name = $city_name");
        while ( rs.next() ) {
            String lastName = rs.getString("city_name");
            cityName.add(lastName);
           // System.out.println(lastName);
        }
        conn.close();

    } catch (Exception e) {
        System.err.println("Got an exception! ");
        System.err.println(e.getMessage()); 
    }

    return cityName;
} 
```

我不知道是什么错误，连接或代码？我可以在这里得到一些帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T13:40:06.557

我猜“www.localhost.com”应该只是“localhost”；如果服务器没有响应，通常会发生这种情况，Firefox 会尝试在网络上搜索服务器。你确定端口号是正确的吗？

**注意#1**：您使用的是哪个 appserver/webservice 平台？您是否编写了客户端，或者您是否尝试使用默认自动生成的客户端？

**注意#2**：当您的代码将被调用时，它很可能会在此处引发“空指针异常”

> cityName.add(lastName);

因为你忘了初始化列表，它可能永远找不到你的城市，因为你忘了设置参数

> $城市名称

在调用preparedStatement之前。

**注意#3**：您最好在两个不同的步骤中测试 Web 服务调用和它正在执行的代码；考虑为后者编写一个简单的主用例或测试用例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T17:45:51.333

正如曼里科所说；你没有连接到你的网络服务器。

将 url 更改为“ [http://127.0.0.1:17978/LostNumApplication](http://127.0.0.1:17978/LostNumApplication) ”，然后重试。

如果这不起作用，则可能是防火墙，或者服务器可能在不同的端口上运行。

如果是 tomcat，请检查 server.xml。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T13:40:50.957

我以前经历过，但那是我的 DNS 搞砸了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T15:02:23.660

一些提示...

您可能应该弄清楚程序的错误输出在哪里结束。通常，当在 servlet 容器（tomcat？）中运行时，服务器将 stdout 和 stderr 写入文件（可能在日志中？）此外，了解应用程序服务器/容器如何记录异常。

也许您应该首先尝试将您的代码作为常规 java 应用程序运行。

捕获异常时，使用日志框架来记录异常可能是个好主意。log4j 或 java.util.logging 都可以。

...或者 - 仅用于测试，执行 exception.printStackTrace() 以便获得完整信息。

此外，SQL 查询也不好...查找 PreparedStatement 以获取动态参数。

```
如果（城市名称==空）{
  //什么都不返回？
} 别的 {
PreparedStatement pstmt = con.prepareStatement("SELECT city_id, city_name FROM city WHERE city_name = ?");

   pstmt.setString(1, city_name); ///

 结果集 rs = stmt.executeQuery();
}

```

# sharepoint - 获取正在运行的工作流列表？

> ID：760454
> 
> 赞同：2
> 
> 时间：2009-04-17T13:37:02.680
> 
> 标签：sharepoint, sharepoint-2007

我想查看当前在整个农场中运行的所有工作流的列表。我知道您可以使用 /_layouts/wrkmng.aspx 来获取一些数字，但我需要知道实际的工作流程（以及它们运行的​​站点/列表/项目）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T13:42:08.690

无需编写代码（抱歉），您可以迭代场中的每个网站集，并使用 Microsoft.SharePoint.Workflow 命名空间中的 API 成员来获取您需要的信息。

# javascript - Struts2 使用 javascript 选择标签添加/删除值

> ID：760471
> 
> 赞同：0
> 
> 时间：2009-04-17T13:41:13.467
> 
> 标签：javascript, struts2

我想在 struts2 中使用 javascript 从列表框中添加/删除值。我怎么能那样做？

```
<s:select label="Select Month" 
name="monthname" 
headerKey="1"
headerValue="-- Please Select --"
list="#{'01':'January','02':'February','03':'March','04':'April',
        '05':'May','06':'June','07':'July','08':'August','09':'September','10':
        'October','11':'November','12':'December'}"
/> 
```

假设我想从列表中删除一月或通过 struts2 中的 javascript 在列表中添加新月份。我将如何实施它？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T13:48:10.750

Struts2 与它无关。

我建议你看看 jQuery，因为它使这变得微不足道：

```
<select>
 <option>Jan
 <option>Feb
 <option>Mar
 <option>Apr
 <option>Jun
</select>
<input type="button" id="removeJanuary" value="Remove January">

<script>
  $(function() {
   $('#removeJanuary').click(function() {
     $("option:contains('Jan')").remove();
   });
  });
</script> 
```

见例子：http: [//jsbin.com/ajoqa](http://jsbin.com/ajoqa)

# inheritance - 可测试性的继承与组合

> ID：760473
> 
> 赞同：32
> 
> 时间：2009-04-17T13:41:58.067
> 
> 标签：inheritance, composition, testability

在设计我的对象时，我发现从可测试性的角度来看，组合是一个更好的选择。原因是，如果需要，我可以在运行单元测试时模拟部分组合结构。如果我有继承层次结构，这是不可能的。

我想知道其他人是否也发现这是更喜欢作曲的原因。另外，由于使用了继承，您还遇到了哪些其他可测试性陷阱？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-04-17T13:46:13.627

我相信，您越是开始使用设计模式进行开发，您就会越来越多地发现组合比继承更受青睐。实际上，我相信**Head First: Design Patterns**一书认为“优先*组合胜过继承*”是主要的设计原则之一。

您能够模拟部分组合进行测试的示例可能是最好的示例之一。

**编辑**：虽然设计模式的基本原则是支持组合而不是继承，但这并不意味着没有设计模式在需要的地方利用继承。另一个基本示例是装饰器模式，您在其中编写抽象超类（尽管这是用于类型匹配而不是实现“is-a”关系）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-17T13:50:08.220

这不是一个非此即彼的情况。他们不是竞争对手。

继承也很容易进行单元测试。但是，有时需要模拟具体类来测试抽象超类。

继承很容易被不当使用。有些设计看起来像“是”的情况，但实际上并非如此——它们更加细微。有时它真的是“行为类似”，您需要某种组合（例如**Strategy**）来将行为与其他属性分开。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-17T13:49:30.420

Gang of Four [Design Patterns](https://rads.stackoverflow.com/amzn/click/com/0201633612)这本书基本上都是关于为什么更喜欢组合而不是继承，并提供了许多方法来做到这一点。一些原因：

1.  类的数量增加了代码库的复杂性。
2.  在许多较新的语言中，继承仅限于一个类，而您可以随心所欲地组合。
3.  基类不能在运行时更改（本质上是您遇到的问题）。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-17T13:59:28.650

我认为组合更容易测试的最大原因是（实现）继承往往会创建非常耦合的类，这些类更脆弱（脆弱基类）并且更难单独测试。

继承肯定有它的用途，但我发现自己越来越喜欢组合而不是继承。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-17T13:57:57.967

*“优先对象组合优于类继承”*实际上来自 GoF 书。[与 Erich Gamma 的对话](http://www.artima.com/lejava/articles/designprinciples4.html)描述了书中的这个想法。

需要继承的一个重要模式是模板方法模式。这种模式被广泛使用，非常方便，所以继承就在这里。另一个使用继承的常见模式是复合模式。我试图说明的一点是，根本不贬低继承，但我希望无论如何只要看看这么多常见的 API 就很清楚了......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-04-03T12:54:28.073

这取决于上下文。当类很简单并且从简单的公共类（配置/记录器）继承时，继承获胜。我在其他情况下作文大多获胜

# .net - 标准 SQL 查询比 Linq 2 SQL 快得多

> ID：760482
> 
> 赞同：2
> 
> 时间：2009-04-17T13:46:11.253
> 
> 标签：.net, sql, linq

嘿，我的代码有问题，我比较了在数据库上实现查询的三种方法

1.  标准 SQL 查询 (From * Select ...)
2.  LinQ 查询
3.  预编译的 LinqQuery (CompiledQuery)

现在我得到的结果是 Precompiled LingQuery 比 LinQ Query 快 5 倍，但更有趣的是，Standard SQL Query 比 Precompiled LinqQuery 快大约 10 倍。我的查询运行的表是一个简单的表，与其他表没有关联。

使该表有趣的事实是它由 5 列组成，它们一起代表我的意思的主键。所有列一起是唯一的，因此表中没有与另一列相似的行。所有列都被索引。

有人知道 LinQ 出了什么问题吗？

亲切的问候

塞巴斯蒂安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T13:54:18.147

您是否看过 linq 生成的实际查询？将这些与您的 SQL 查询进行比较可能会给您一些答案。

您可以使用 SQL Profiler 或侦听 linq datacontext 的 Out 属性来执行此操作吗？您可以在控制台应用程序中这样做：

```
DataContext ctx = new ...;
ctx.Log = Console.Out;
//Now execute the linq query, and the query will be output to the console. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T14:02:48.377

只需确保您的查询没有被缓存，这可能会扭曲结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T13:47:51.407

你是如何测量的？您是使用所有查询结果，还是只执行查询？（例如，LINQ 很可能会为您获取结果。）

这是否会在您第二次执行查询时发生，或者您只是在测量第一次执行所花费的时间？

# php - 指定的 CGI 应用程序因未返回完整的 HTTP 标头而行为异常

> ID：760486
> 
> 赞同：0
> 
> 时间：2009-04-17T13:46:53.827
> 
> 标签：php

尝试运行 PHP 页面时出现以下错误

指定的 CGI 应用程序因未返回完整的 HTTP 标头集而行为异常。

该页面之前工作正常。然后我对页面进行了一些更改以格式化内容（在 HTMLtable 中添加了更多行并为其提供了一些样式）

谁能告诉我它为什么来？

在我当地的环境（WAMP）中，它工作正常。我的生产服务器在 IIS 中运行

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-17T13:57:15.830

这意味着错误发生在脚本的早期或由更改引起的解析错误。使用 php.ini 的错误级别设置，以便将错误打印到 Web 浏览器。我不确定 ISS 日志，但错误可能会出现在那里。但请注意，在 Web 浏览器中出现 PHP 打印错误会使它们在面向 Internet 的服务器上全球可见。

# wysiwyg - 符合 W3C 的所见即所得？

> ID：760493
> 
> 赞同：1
> 
> 时间：2009-04-17T13:48:19.237
> 
> 标签：wysiwyg, w3c

有人可以向我推荐一个符合 W3C 且功能不错的 WYSIWYG 编辑器吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T14:11:50.710

WYSIWYG 的整个概念与 HTML 规范的精神背道而驰。

我不确定是否有任何适用于网络的优秀 WYSIWYM 编辑器。Lyx 非常适合文档，但不适用于网站。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-06-15T10:36:13.543

也许是 Amaya，它是[W3C 的 Editor/Browser](http://www.w3.org/Amaya/)。

# asp.net - 使用 jQuery 使用数据库中的值设置背景颜色

> ID：760496
> 
> 赞同：0
> 
> 时间：2009-04-17T13:49:21.077
> 
> 标签：asp.net, javascript, jquery

我正在寻找一个示例，说明如何从数据库中读取值并在 jQuery 脚本中使用它来设置控件的背景颜色。我还在学习 jQuery，我不清楚如何从数据库中获取值。我正在使用 ASP.NET MVC，并且我的表单已经在提取值 - 我需要将它放在隐藏字段中并以这种方式使用它，还是有更好/不同的方式将颜色值传达给 jQuery？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T14:10:08.513

我可以想到几种不同的方法来做到这一点，其中一些不使用 jQuery，具体取决于您要完成的工作。

**主题化**

开发自定义 CSS 并让您的视图根据数据库中的选择来选择要使用的 CSS 文件。这将是基于数据库字段的值构造 CSS 链接的视图代码。将类应用到主题中的控件（每个主题将具有相同的类，只是每个主题的设置不同）。

```
 <link href='<%= Url.Content( "~/Content/styles/" + Model.Theme ) %>'
       type="text/css"
       rel="stylesheet" /> 
```

**用户偏好**

您希望用户能够实际更改特定元素的外观和感觉，而不仅仅是选择主题。在这种情况下，有几个不同的选项——一个有一个帮助器，它根据数据库值为用户生成自定义 CSS——再次使用公共类，以便您可以使用类设置控件的样式。从您的视图中调用此帮助程序，并将正确的 CSS 直接或作为生成 CSS 以响应链接的操作的链接注入页面。或者，我不喜欢这个选项，使用 View 布局设置控件本身的样式属性，并从 ViewData 获取背景颜色属性的值。

```
<link href='<% Url.Action("css","generate", new { id = Model.UserID } ) %>'
      type="text/css"
      rel="stylesheet" />

<div style='background-color: <%= ViewData["controlBackgroundColor"] %>;'></div> 
```

**动态变化**

您希望根据用户操作动态更改颜色，并让新颜色来自数据库。在这种情况下，您可以将颜色注入到您的 jQuery 直接所在的脚本标记中。

```
<script type="text/javascript">
     $(document).ready( function() {
         $('#someButton').click( function() {
              $('#someControl').css('background','<%= ViewData["controlBackground"] %>');
         });
     });
</script> 
```

我认为没有必要使用隐藏字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T13:53:39.117

隐藏值可以正常工作，您可以使用以下方法检索它：

```
$("#hiddenFieldId").val(); 
```

您可以做的另一件事是在 javascript 中设置一个全局变量（即，在文件顶部，在所有函数的定义之外。然后它将在所有函数中可用。）。你会做这样的事情：

```
//On top of your-file.js:
var color='';
$(document).ready(function()
    {
        $("body").css("background-color",color); //Not tested
    }
); 
```

在 HTML 文件中：

```
<script type='text/javascript' src='your-file.js'>
</script>
color="<?=$color;?>"; //Or do it how you'd do it in ASP 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T13:55:03.137

隐藏值很好：

```
<input type="hidden" value="#ff3300" id="backgroundColor">
<div id="someControl">I'm some control</div>
<script>
  $(function() {
  $('#someControl').css('background', $('#backgroundColor').val());
});
</script> 
```

见例子：http: [//jsbin.com/aneno](http://jsbin.com/aneno)

# xaml - 半透明背景上的文本

> ID：760501
> 
> 赞同：8
> 
> 时间：2009-04-17T13:50:25.863
> 
> 标签：xaml, transparency

这一定很简单，但我做不到：如果我将文本块放入容器中并使容器的不透明度 < 1，则无论我是否尝试在文本块中覆盖它，文本都会继承该不透明度。如何在半透明容器中保持文本 100% 不透明度？

```
<Grid x:Name="LayoutRoot">
    <Border Background="red" Opacity="0.5">
        <TextBlock Text="TextBlok" Opacity="1"/>
    </Border>
</Grid> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-17T13:57:37.640

这会奏效吗？

```
<Border Background="#80FF0000">
    <TextBlock Text="TextBlok"/>
</Border> 
```

将背景设置为透明，而不是整个边框元素...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-17T14:00:29.410

只需使用颜色值而不是不透明度即可使其透明。

Color 属性可以由 4 个参数组成：

1.  透明度
2.  红色的
3.  绿
4.  蓝色的

它们的范围都是 0-255

半透明的蓝色将是：（128,0,0,255）翻译成 XAML（十六进制）：#800000FF

这种颜色可以在任何颜色刷中使用。

所以 else 已经有一个示例如何在我刚刚看到的代码中实现它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-22T14:40:56.937

```
<Grid>
    <Grid.Background>
        <SolidColorBrush Color="Red" Opacity="0.5"></SolidColorBrush>
    </Grid.Background>

    <TextBlock Text="Hallo there"></TextBlock>
</Grid> 
```

# c# - 如何传递方法名称以实例化委托？

> ID：760503
> 
> 赞同：2
> 
> 时间：2009-04-17T13:51:03.457
> 
> 标签：c#, delegates

在下面的示例中，我想定义一个 System.Action 来执行我在运行时定义的特定方法，但是**如何传递方法名称（或方法本身）**以便 Action 方法可以定义要指向的委托那个特别的方法？

我目前收到以下错误：

*'methodName' 是一个'变量'，但用作'method'*

```
using System;
using System.Collections.Generic;

namespace TestDelegate
{
    class Program
    {
        private delegate void WriteHandler(string message);

        static void Main(string[] args)
        {
            List<string> words = new List<string>() { "one", "two", "three", "four", "five" };
            Action<string> theFunction = WriteMessage("WriteBasic");

            foreach (string word in words)
            {
                theFunction(word);
            }
            Console.ReadLine();
        }

        public static void WriteBasic(string message)
        {
            Console.WriteLine(message);
        }

        public static void WriteAdvanced(string message)
        {
            Console.WriteLine("*** {0} ***", message);
        }

        public static Action<string> WriteMessage(string methodName)
        {
            //gets error: 'methodName' is a 'variable' but is used like a 'method'
            WriteHandler writeIt = new WriteHandler(methodName);

            return new Action<string>(writeIt);
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T13:58:51.943

您不需要 Delegate 声明或 WriteMessage 方法。尝试以下操作：

```
using System;
using System.Collections.Generic;

namespace TestDelegate
{
    class Program
    {
        static void Main(string[] args)
        {
            List<string> words = new List<string>() { "one", "two", "three", "four", "five" };
            Action<string> theFunction = WriteBasic;

            foreach (string word in words)
            {
                theFunction(word);
            }
            Console.ReadLine();
        }

        public static void WriteBasic(string message)
        {
            Console.WriteLine(message);
        }

        public static void WriteAdvanced(string message)
        {
            Console.WriteLine("*** {0} ***", message);
        }

    }
} 
```

Action 已经是一个委托，所以你不需要再做一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T13:55:34.117

不带引号传递它 -

```
Action<string> theFunction = WriteMessage(WriteBasic); 
```

将“WriteMessage”的签名更改为 -

```
public static Action<string> WriteMessage(WriteHandler methodName) 
```

还将“私人”代表更改为“公共” -

```
public delegate void WriteHandler(string message); //Edit suggested by Mladen Mihajlovic 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T13:54:16.273

除非你使用反射，否则你不能通过这样的方法。为什么不将 WriteHandler 作为参数而不是字符串？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T13:54:43.480

您可以使其与反射一起使用，但不建议这样做。

为什么不让 WriteMessage 方法接受 WriteHandler 的参数呢？

然后你可以这样调用它（在 C# 2+ 中）：

```
WriteMessage(myMethod); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T19:21:16.627

你想要[Delegate.CreateDelegate](http://msdn.microsoft.com/en-us/library/system.delegate.createdelegate.aspx)。在您的特定情况下，您可能想要[Delegate.CreateDelegate(Type,Type,string)](http://msdn.microsoft.com/en-us/library/1xw3bk13.aspx)：

> ```
> 公共静态 Action<string> WriteMessage(string methodName)
> {
>   return (Action<string>) Delegate.CreateDelegate (
>       类型（动作<字符串>），
>       类型（程序），
>       方法名）；
> }
> 
> ```

但是，正如 Mladen Mihajlovic 所问的，*为什么*要基于字符串创建委托？这会容易得多——并由编译器检查！-- 使用 C# 对从方法到匹配签名委托的隐式转换的支持。

# iphone - 保持 UITableView 的最后一行被选中

> ID：760506
> 
> 赞同：0
> 
> 时间：2009-04-17T13:51:54.407
> 
> 标签：iphone, objective-c

我正在使用`cellForRowAtIndexPath`方法将每一行插入 UITable 视图。现在我需要始终保持选中表格视图的最后一个单元格。即，每当添加新条目时，它应该处于选中状态，而当它被删除时，表视图的前一个条目必须处于选中状态。我尝试使用`selectRowAtIndexPath:animated:scrollPosition:`方法，但没有成功。关于如何实现这一目标的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T14:15:32.683

在确定应选择集合中的哪个项目后，尝试在您的方法中使用`selectRowAtIndexPath:animated:scrollPosition:`from [UITableView API来执行加法和减法。](http://developer.apple.com/iPhone/library/documentation/UIKit/Reference/UITableView_Class/Reference/Reference.html#//apple_ref/occ/instm/UITableView/selectRowAtIndexPath:animated:scrollPosition:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T14:08:07.160

使用的`selected`属性`UITableViewCell`

# .net - 从 C++ 中的 .Net TextBox 获取双精度值

> ID：760512
> 
> 赞同：1
> 
> 时间：2009-04-17T13:53:19.147
> 
> 标签：.net, c++

如何使用 C++ 从 .NET 中的文本框中获取双精度值。我必须获取文本并执行 atof() 还是有更简单的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T13:59:31.970

是的，您必须获取文本并对其进行解析——尽管您可以坚持使用 .NET 并使用[`Double.TryParse`](http://msdn.microsoft.com/en-us/library/system.double.tryparse.aspx)而不是`atof()`，这可以让您更轻松地检测用户错误。

`Convert.ToDouble`并且`Double.Parse`在失败的情况下都会抛出异常；`atof()`会默默地忽略我记忆中的错误输入。`Double.TryParse`只是返回`true`/`false`表示成功/失败，并使用`out`参数传回解析的结果。对于用户输入，这通常是正确的做法——您希望能够检测到故障，但异常并不适合，因为用户输入无效数据远非异常情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T14:01:04.777

您必须解析文本。

```
Double value = 0.0;

if (Double.TryParse(textBox.Text, out value))
{
    // Value is valid here.
}
else
{
   // Handle invalid input here.
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T13:59:46.463

在 .NET 中，您可以使用[Double.Parse](http://msdn.microsoft.com/en-us/library/system.double.parse.aspx)、[Double.TryParse](http://msdn.microsoft.com/en-us/library/system.double.tryparse.aspx)或[Convert.ToDouble](http://msdn.microsoft.com/en-us/library/system.convert.todouble.aspx)。

# delphi - 我在哪里可以找到有关 Delphi VMT 结构的信息？

> ID：760513
> 
> 赞同：12
> 
> 时间：2009-04-17T13:53:27.400
> 
> 标签：delphi, structure, vmt

System.pas 文件包含大量有关硬编码 VMT 偏移的信息，但它似乎并没有真正说明 VMT 本身的结构。我真正想知道的是，有没有办法在运行时找出 VMT 的大小，或者换句话说，给定类存在多少虚拟方法？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-17T16:19:58.000

你想知道 VMT 结构怎么样？您也知道这是一个内部实现细节，可能会发生变化（并且随着时间的推移而变化）。

要回答您的具体问题，这里有一个简单的方法来查找给定类的虚拟方法的数量：

```
function GetVirtualMethodCount(AClass: TClass): Integer;
begin
  Result := (PInteger(Integer(AClass) + vmtClassName)^ - 
    (Integer(AClass) + vmtParent) - SizeOf(Pointer)) div SizeOf(Pointer);
end; 
```

这是有效的，因为我碰巧知道代表类名的字符串紧跟在 VMT 中的所有虚拟方法向量之后。

我还知道所有与 VMT 指针本身负偏移的 TObject 上有 11 个虚拟方法（对于 D2009，对于 D2007 和之前的版本有 9 个）。

这就是 vmtParent 引用的原因。

最后，通过使用 TClass 类引用，您可以将任何 TObject 派生类传递给此函数并获取虚拟方法的数量。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-17T16:30:36.647

我很确定 Hallvard 在 VMT 上有一些东西。果然，他有[Hack #8: Explicit VMT calls](http://hallvards.blogspot.com/2006/03/hack-8-explicit-vmt-calls.html)，它引用了 Ray Lischner *Secrets of Delphi 2*和*Delphi in a Nutshell*。

这是他破解的 VMT 版本

```
type
  PClass = ^TClass;
  PSafeCallException = function  (Self: TObject; ExceptObject:
    TObject; ExceptAddr: Pointer): HResult;
  PAfterConstruction = procedure (Self: TObject);
  PBeforeDestruction = procedure (Self: TObject);
  PDispatch          = procedure (Self: TObject; var Message);
  PDefaultHandler    = procedure (Self: TObject; var Message);
  PNewInstance       = function  (Self: TClass) : TObject;
  PFreeInstance      = procedure (Self: TObject);
  PDestroy           = procedure (Self: TObject; OuterMost: ShortInt);
  PVmt = ^TVmt;
  TVmt = packed record
    SelfPtr           : TClass;
    IntfTable         : Pointer;
    AutoTable         : Pointer;
    InitTable         : Pointer;
    TypeInfo          : Pointer;
    FieldTable        : Pointer;
    MethodTable       : Pointer;
    DynamicTable      : Pointer;
    ClassName         : PShortString;
    InstanceSize      : PLongint;
    Parent            : PClass;
    SafeCallException : PSafeCallException;
    AfterConstruction : PAfterConstruction;
    BeforeDestruction : PBeforeDestruction;
    Dispatch          : PDispatch;
    DefaultHandler    : PDefaultHandler;
    NewInstance       : PNewInstance;
    FreeInstance      : PFreeInstance;
    Destroy           : PDestroy;
   {UserDefinedVirtuals: array[0..999] of procedure;}
  end; 
```

不过，您需要阅读他的文章以了解有关该 hack 的更多信息。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-17T16:20:23.693

我将为此插入我自己的网站：

[什么是虚方法表？](http://www.cs.wisc.edu/~rkennedy/vmt)

我认为它在 Delphi 2005 中是准确的。

VMT 没有给出它持有的虚拟方法指针数量的任何值。只有编译器需要知道这些信息，所以没有理由记录它以供在运行时使用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-17T14:27:30.967

谷歌搜索 :-P 为“delphi vmt”会产生[这个](http://hallvards.blogspot.com/2006/03/hack-8-explicit-vmt-calls.html)。也许这会给你一个开始。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T14:57:12.193

我记得在“delphi in a nutshell”一书中有一些关于 delphi vmt 的信息。简而言之，你可以从[delphi 第 2 章](http://oreilly.com/catalog/delphi/chapter/ch02.html "简而言之，第 2 章")或[这个开始](http://www.deltics.co.nz/blog/?p=307)

# c++ - ACE vs Boost vs Poco vs wxWidgets

> ID：760522
> 
> 赞同：17
> 
> 时间：2009-04-17T13:55:24.103
> 
> 标签：c++, boost, ace, poco-libraries

[我在ACE](http://www.cs.wustl.edu/~schmidt/ACE.html)、[Boost](http://www.boost.org/)和[wxWidgets](http://www.wxwidgets.org/)方面拥有丰富的经验。我最近发现了[POCO](http://pocoproject.org/)库。有没有人对它们有任何经验，以及它们在性能和可靠性方面如何与 ACE、Boost 和 wxWidgets 进行比较？

我对用 POCO 替换 ACE 特别感兴趣。我一直无法让 ACE 使用带有 x64 目标的 VS2008 进行编译。我主要使用 ACE_Task，所以我想我可以用 Poco 的线程和消息队列替换它们。

我感兴趣的 POCO 的其他一些部分是 HTTPServer、HTTPClient 和 LayeredConfiguration。这些库与 Boost 和 wxWidgets 中的库类似，但我尝试将 wxWidgets 的使用限制在 GUI 组件中，并且可比较的 Boost 库......很难。

我对任何人都可以分享的关于 POCO 的任何经验感兴趣，无论好坏。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-17T16:29:49.053

我一次又一次地使用了 POCO 的一部分，发现它是一个非常好的库。几年前我基本上放弃了 ACE，但 POCO 包含一些相同的模式——任务、反应堆等。我从来没有遇到过任何问题，所以我不得不假设它是稳定的。

我喜欢的一些方面：

*   它是一个很好的集成 OOP 层次结构，因此组件可以很好地相互配合。它比像 Boost 这样零碎的东西更有凝聚力。

*   源代码可用且非常清晰。您无需花费大量时间来了解它在做什么（ACE，至少我上次查看源代码）或成为模板向导（Boost）。

*   组件接近标准 C++。异常源自 std::exception；他们没有重新发明另一个字符串类等。

*   这是令人惊讶的全面。那里的内容比乍看之下要多得多。

不足之处：

*   个人喜好问题，但作者几乎坚持每个头文件模型一个类，因此您最终会包含许多不同的文件。

*   有限的文档。大多数是 doxygen 类型的 API 页面和一些指向源示例的 PDF。它是可用的，但考虑到库的大小，最初很难确定您是否正在充分利用这些组件。

*   如果围绕它建立了一个活跃的社区，我从来没有找到它。该软件包由一些欧洲公司维护，他们有一个 wiki，但我发现它没有那么活跃或有用。

考虑到所有因素，缺点很小。我认为这是一个非常好的图书馆，肯定会推荐它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-17T16:18:10.093

我从未使用过 ACE，但我使用过 Boost 和 Poco。我真的很喜欢 Poco 的编码风格。包是一致的，源代码易于阅读。它们不像 boost 那样疯狂。以我的经验，我花了几个小时阅读如何使用 boost——序列化包、指针映射容器等——而很少花时间阅读如何使用 Poco 的东西。我会说他们有很好的设计并在需要的地方使用模板。

不利的一面是，他们有 API 文档，但没有关于如何使用包的大量文档。为此，您通常会查看示例源代码或它们的单元测试源代码。

我有 HTTPServer 在 Windows/Linux 上工作，没有任何明显的错误。

所以把它记为一种积极的体验。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T16:30:46.197

对我来说，boost 似乎对新的 C++ 库具有最大的吸引力，其中许多被即将到来的 C++ 标准接受这一事实不言而喻。

我自己使用 ACE 和 Boost，我选择它们的原因是它们成熟（尤其是 ACE）有一个庞大而强大的用户社区，可以确保它们得到维护和增强，并且我可以获得高质量的专业支持。我们将[Remedy IT](http://www.remedy.nl/)用于我们的 ACE/TAO 支持，并且非常满意。

由于 ACE 是一个比 Boost 更古老的库，并且它的目标之一是支持更奇特的（如嵌入式）平台，它不像 Boost 那样使用那么多前沿的 C++ 技术。我正在使用 ACE 和 Boost 的混合物，并且对这种组合非常满意。

我不太明白你为什么把 wxWidgets 放在比赛中，因为它主要是一个图形 UI 库。但是如果我必须做一些 C++ UI 项目，我会选择[QT](http://qt.nokia.com/)，主要是因为这也是一个广泛使用的库（所有 KDE 桌面都建立在 QT 之上），因此维护得很好，我可以访问一个大用户群的问题和支持。

# .net - 如何重置 .NET Windows 窗体 TextBox BackColor 属性？

> ID：760543
> 
> 赞同：16
> 
> 时间：2009-04-17T14:02:12.323
> 
> 标签：.net, winforms, controls, colors

`BackColor`a 属性的默认行为`TextBox`如下：启用时为`White`( `SystemColors.Window`)，禁用时为 Gray（不确定这是什么 SystemColor）。

如果我更改`BackColor`属性，启用和禁用都使用相同的颜色。如何重置`BackColor`属性（在之前更改后）以使行为恢复为默认值？

我尝试将其设置回`SystemColors.Window`，但禁用时该框保持白色。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-04-17T14:16:50.883

如果您的意思是在设计器中，您只需单击 BackColor 属性并删除其中的任何内容，然后按 Enter。这会将属性重置为其默认值。

如果您的意思是在代码中，您可以将 BackColor 属性设置为[Color.Empty](http://msdn.microsoft.com/en-us/library/system.drawing.color.empty%28v=vs.110%29.aspx)，这将具有相同的效果。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-17T14:16:11.730

```
TextBox.ResetBackColor() 
```

由于某种原因，它不会在[IntelliSense](http://en.wikipedia.org/wiki/IntelliSense)中弹出，但它就在那里并且可以编译。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-17T14:15:13.773

`SystemColors.Window`（通常）是白色的。使用`SystemColors.Control`.

当然，您可以在将其设置为自己的颜色时缓存正在使用的颜色，然后使用它来重置它。但最终，任何一种方法都行得通。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T14:14:03.667

如果无法重置控件，以便在启用/禁用时返回自动更改其背景颜色，我建议使用该`UIElement.IsEnabledChanged`事件来设置所需的启用/禁用背景颜色。我希望这是有帮助的！

# .net - 哪种 .Net Framework 通用集合类型将允许/提供此（关键）功能？

> ID：760548
> 
> 赞同：0
> 
> 时间：2009-04-17T14:04:27.233
> 
> 标签：.net, vb.net, generics, collections

我想知道 System.Collections.Generic 中的哪种集合类型将支持这种情况，如果有的话：

```
Public Class MyCollectionBase(Of ItemType, KeyType)
     Inherits System.Collection.Generic.???

     Default Public Shadows ReadOnly Property Item(ByVal key as KeyType) as ItemType
         Get
             ....
         End Get
     End Property

End Class 
```

过去，我在继承 System.Configuration.ConfigurationElementType 的配置对象中使用过这种行为，如下所示：

```
 Default Public Shadows ReadOnly Property Item(ByVal id As String) As Element
     Get
         Return CType(BaseGet(id), Element)
     End Get
 End Property 
```

但是，在这种情况下，我的集合与配置无关，我需要元素是通用的，以及元素键/ID。

提前致谢。

编辑：接受乔尔的回答。我觉得自己像个白痴。出于某种原因，我坚持我想坚持使用不是 IDictionary 的 ICollection 实现的想法，可能是因为我正在重构原本打算与 NHibernate 映射一起使用的类。字典就是它，当然。如果有人需要我，我会躲在角落里。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-17T14:06:20.037

字典？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T14:07:23.187

看起来像一个

```
Dictionary<TKey, ItemType> 
```

是必须的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T14:09:06.393

它看起来肯定`Dictionary<TKey, TValue>`是你想要的。我还强烈建议您重新排序您的类型参数 - 几乎*每个*字典/映射/我所见过的键和值类型参数都将键类型参数放在首位。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T14:09:34.880

您正在寻找`System.Collections.Generic.Dictionary`

# database-design - 此选项列表是否可以接受数据库中的布尔标志？

> ID：760554
> 
> 赞同：2
> 
> 时间：2009-04-17T14:06:52.873
> 
> 标签：database-design

我正在将用户提交的评论添加到个人项目中。

注释有许多用于特殊目的的标志。出于审核目的，还对评论进行了版本控制，因此特定字段不需要时间戳。

这些是我目前在功能设计中的选择。（列表不是最终的）这个列表会在某个时候改变，因为我知道我还没有弄清楚所有事情。

*   Wrapped（文本隐藏在 javascript 链接后面）
*   隐藏（评论文本对非版主隐藏）
*   已锁定（无法编辑）
*   已删除（评论已删除）
*   版主（隐藏发帖人姓名）
*   管理员（与版主相同，但版主无法编辑）
*   Hellbanned（除海报外的行为已删除）

有一些规则可以管理哪些标志可以一起存在。（就显示而言。）

*   不应包装、隐藏、锁定或禁止管理员/版主的评论。（版主不能被封杀）
*   评论不能同时是管理员和版主评论。
*   Hellbanned 不应该被删除。
*   评论不能同时包含 Wrapped 和 Hidden
*   隐藏的评论应该被锁定。

布尔标志是否足以在数据库中实现这一点？（我将 Ruby on Rails 与 SQLite/MySQL 一起使用，因此数据库不能有触发器/约束）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-17T14:15:51.900

这是布尔标志的问题：它们只有两种状态。

事实证明，许多事情都有多个条件，而一个简单的布尔值证明是不够的。

有些东西实际上可能是布尔值。然而，这种情况很少见。

我建议不要使用布尔值，而是使用某种值枚举。

*   Wrapped（文本隐藏在 javascript 链接后面）。看起来是布尔值：有链接或没有链接。可悲的是，您可能有不同类型的链接（内部、外部等），因此这可能会超过两个值。

*   隐藏（评论文本对非版主隐藏）。看起来是布尔值——隐藏与否。当然，除了非主持人的定义可能会扩大，然后这就会变得更加复杂。

*   锁定（无法编辑）。看起来是布尔值，锁定或打开。除非您可能已锁定一类用户但未锁定另一类用户。布尔分解。

*   已删除（评论已删除）。布尔值，直到您添加挂起删除，或需要再次投票删除。

*   版主（隐藏发帖人的姓名）。布尔值，直到您拥有其他类别的用户、超级用户、更多特权用户和更少特权用户。

*   Hellbanned（除海报外的行为已删除）。这似乎是评论作者的一个特征，而不是评论本身。这甚至不属于这里，而是属于您模型的其他地方。

我投票支持枚举值而不是简单的 True/False。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T14:11:54.063

您可以将这些实现为布尔标志列，或者具有一个充当位掩码的 int 列。有些人可能会争辩（他们在技术上是正确的）数据库中的位掩码违反规范化（因为多个“值”存储在单个列中），但我发现它们在过去很有用。唯一的问题是它会使代码的可读性降低。

不过，最后，我会说你的方法没有错。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T14:15:34.290

对于规则，您似乎有两种选择：

1.  您可以尝试设置约束和触发器，以强制禁止任何不良数据进入数据库
2.  您可以通过函数上的前置条件和后置条件（不一定是编码的前置条件和后置条件，但明确定义和遵守的条件）在应用程序代码中确保它们不会引入错误数据。然后，您可以定期运行 Bad Data 脚本，以提醒您任何违反规则的行为。

无论如何你都需要做一些#2，除非你打算在数据库中引发异常并在客户端处理它们（这对我来说很难闻......）但我想我会犹豫不决# 1 除非你涵盖所有情况，因为如果你不这样做，你会在那里强制执行一些，而有些则不会，这对我来说也很糟糕......

# entity-framework - 如何通过实体框架创建关系映射

> ID：760555
> 
> 赞同：0
> 
> 时间：2009-04-17T14:06:55.933
> 
> 标签：entity-framework

我有以下域模型：

```
User
{
int Id;
}

City
{
int Id;
}

UserCity
{
int UserId,
int CityId,
dateTime StartDate
} 
```

在我必须将用户附加到城市的功能中，以下代码适用于我：

```
UserCity uc = new UserCity();

//This is a db hit
uc.User = MyEntityFrameworkDBContext.User.FirstOrDefault(u => u.ID == currentUserId);

//this is a db hit
uc.City = MyEntityFrameworkDBContext.City.FirstOrDefault(c => c.ID == currentCityId);
uc.StartDate = userCityStartDate;

//this is a db hit
MyEntityFrameworkDBContext.SaveChanges(); 
```

有什么方法可以只用一个数据库命中来创建关系吗？实际上，前两个数据库命中不是必需的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-17T16:26:55.067

```
uc.UserReference.EntityKey =
    new EntityKey("MyEntities.Users", "Id", currentUserId); 
```

...对于城市也是如此。显然，将 EntityKey 构造函数的参数替换为您的实体模型的正确值。请注意，设置 EntityKey 后，您将无法引用 City 或 User 属性。但是因为你从来没有在代码中这样做，所以这对你来说不是问题。

此外，在您显示的代码中，您永远不会将新实体添加到上下文中。我认为这只是问题中的一个遗漏。您应该在设置用户和城市之前执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T16:10:59.940

不，因为 EF v1.0 不支持外键字段。他们将在 v2.0 (.NET 4.0) 中添加它。

# flash - 从 actionscript - flash 应用程序中监视控制台输出

> ID：760560
> 
> 赞同：0
> 
> 时间：2009-04-17T14:08:39.063
> 
> 标签：flash, actionscript-3

我正在将 as2 swf 加载到 as3 swf 中。当我调试 as3 应用程序时（我使用 flex builder 作为我的 ide），我可以看到 as2 应用程序的调试输出。您不能从 as3 swf 中调用 as2 swf 的函数或属性，因此我无法以编程方式知道 as2 swf 中发生了什么。

是否有一个聪明的解决方法，我可以从我的 as3 swf 中使用 as2 swf 的调试输出？flexbuilder 插入什么 api 来显示调试输出？我可以在我的 as3 应用程序中使用它吗？

我尝试了 swfBridge，但经过一周的尝试后遇到了限制。这将是一个很好的解决方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T15:00:01.420

本地连接怎么样？这是一个可能适合也可能不适合您需求的[示例。](http://www.learningactionscript3.com/2007/12/14/sending-data-from-avm2-to-avm1/#more-29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-09-11T09:24:15.990

我知道这个问题已经很老了，但你总是可以使用 MonsterDebugger，它非常简单，可以处理任何 SWF 的多个实例。它是用于 ActionScript/AIR 应用程序的 Firebug。

例如，它也非常容易实现

1.  将 SWC 导入您的项目
2.  添加 MonsterDebugger.initialize(this); 进入你的构造函数
3.  使用 MonsterDebugger.trace(this, 'Hello world'); 输出到它的控制台

他们也有一个非常好的网站，可以向您展示如何使用它，但通常您不需要的不仅仅是上述内容。

[怪物调试器官方网站](http://www.monsterdebugger.com/)

# asp.net-mvc - 用 ASP.NET MVC 实现 MEF？

> ID：760563
> 
> 赞同：33
> 
> 时间：2009-04-17T14:09:34.413
> 
> 标签：asp.net-mvc, plugins, mef, composite

我试图找出是否有人有任何使用 MEF（托管可扩展框架（微软的新插件框架）和 ASP.NET MVC 的经验或想法。我需要创建一个标准的 ASP.NET MVC，我有。但我需要提供附加功能，即视图和控制器等，具体取决于我是否添加插件。它不需要动态编译，即源代码......但是我放入系统的 DLL..

有没有办法在应用程序启动时动态加载 DLL，然后将视图和控制器与主系统合并？我不知道我是否在正确的轨道上。

然后，我想在应用程序附带的“标准”视图中，我可以使用“IF THEN”来确定是否加载了插件并在用户控件中合并。

好吧，我在这里大声说话，但我想你明白我在说什么。

有任何想法吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-22T09:55:10.333

有什么运气吗？我正在阅读[这篇](http://blog.maartenballiauw.be/post/2009/04/21/ASPNET-MVC-and-the-Managed-Extensibility-Framework-(MEF).aspx)文章，并认为这就是你要找的。
我对 MEF 的 xp 完全为零，但它看起来很有希望。我希望我可以在家里一起抽出几个小时的空闲时间来试验一下。以这种方式创建某种模块化的 MVC“框架”将非常有用。

至于我正在处理的当前项目，我有以下问题：多个站点具有相同的视图，只有其他 CSS 文件。目前我必须复制导致维护问题的视图。
我希望我可以使用 MEF 将这些视图放在一个中心位置。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-06-01T14:42:36.800

检查这个：

[http://www.fidelitydesign.net/?p=104](http://www.fidelitydesign.net/?p=104)

使用托管可扩展性框架 (MEF) 的模块化 ASP.NET MVC，第一部分作者 Matthew Abbott。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-09-10T20:35:01.393

我们在 ASP.NET MVC 中使用了大量的 MEF，尽管其中大部分位于控制器级别以下，因为在我们的较低级别模块中使用 MEF 插件来检查权限和验证数据。

然而，我们也对我们的控制器使用了一种更可组合的方法。视图更棘手，但我们实际上完全消除了常规 ASP.NET MVC 视图的使用，并将我们的 Razor 视图存储在数据库中的片段中。然后，我们的控制器在运行时向模板引擎请求视图并将 ContentResult 呈现给响应，而不是返回 View("Viewname") 等。

我们的 MEF 插件都带有标识符属性，可以让我们在运行时进行级联覆盖，以确定应该将哪个插件/类用于给定目的。最简单的演示示例是，如果您考虑一个具有共同基础但部署到 50 多个实现的应用程序，每个实现都可以选择覆盖核心功能。

因此，您可能有类似 IUserController 的东西，其中包含“登录”、“注销”等方法。

除了该实际功能之外，我们还将向名为“SiteId”的界面添加一个只读 GUID 属性。然后，每个实现都会硬编码它打算用于的 SiteId。对于核心代码中的“默认”实现，它将返回“Guid.Empty”。

然后，当我们调用 MEF 并查找要使用的 IUserController 的实现时，我们会将所有这些实现 ImportMany 到一个 List 中，然后使用 LINQ 查询属性以确定要使用哪个：

```
var _currentUserController = _availableUserControllers.FirstOrDefault(
  c=>c.SiteId == AppSettings.SiteId);
if(_currentUserController == null){
    //There is no site-specific override
    _currentUserController = _availableUserControllers.FirstOrDefault(
      c=>c.SiteId == Guid.Empty);
} 
```

要使用控制器执行此操作，最好的办法是查看 Web 上基于 MEF 的控制器工厂的一些实现。

然而，就像我说的那样，我们几乎所有这些都是在较低的级别上进行的，并且让我们的模块或控制器进行这种查找以确定要运行哪些插件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T14:17:35.687

这是一个疯狂的猜测。您可以使用使用 MEF 发现`IController`s 的控制器工厂覆盖默认控制器工厂。由于视图是按惯例发现的，因此您不必担心它们。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-25T09:23:30.340

有[http://blog.maartenballiauw.be/post/2009/04/21/ASPNET-MVC-and-the-Managed-Extensibility-Framework-(MEF).aspx](http://blog.maartenballiauw.be/post/2009/04/21/ASPNET-MVC-and-the-Managed-Extensibility-Framework-(MEF).aspx)和[https://blogs.msdn.com/hammett /archive/2009/04/23/mef-and-asp-net-mvc-sample.aspx](https://blogs.msdn.com/hammett/archive/2009/04/23/mef-and-asp-net-mvc-sample.aspx)描述了如何在应用程序中使用 MEF 和 MVC。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-06-01T21:17:51.363

我已经使用 MVC 和 MEF 组合了一个具有强类型视图的可插拔框架：[http ://www.thegecko.org/index.php/2010/06/pluggable-mvc-2-0-using-mef-and -强类型视图/](http://www.thegecko.org/index.php/2010/06/pluggable-mvc-2-0-using-mef-and-strongly-typed-views/)

# ruby-on-rails - Ruby Rails 集合选择显示空白“提示”值？

> ID：760566
> 
> 赞同：12
> 
> 时间：2009-04-17T14:10:27.560
> 
> 标签：ruby-on-rails, ruby, forms, collections, prompt

我有一个集合选择，如下所示：

```
<%= f.collection_select :region_id, Region.find(:all), :id, :name, { :prompt => 'Select a State/Province' }, :style => "width: 200px;" %> 
```

有时会出现 :prompt 选项的提示，但有时不会。有谁知道我可以从哪里开始解决这个问题？可能是我看太久了……

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-05-14T09:46:50.330

`:include_blank`使用空白选项的值似乎可以解决问题。尝试这个：

```
 {:include_blank => "Please select"} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-03-13T21:27:07.607

`:prompt`当没有选定的值时出现在列表中。

`:include_blank`始终出现在列表中，即使您已使用选定值加载选择。

* * *

如果您希望您的选择始终`"Select a State/Province"`作为第一个选项：

```
<%= f.collection_select :region_id, Region.all, :id, :name, include_blank: 'Select a State/Province' %> 
```

如果您希望您的收藏`"Select a State/Province"`仅在尚未选择区域时作为第一个选项：

```
<%= f.collection_select :region_id, Region.all, :id, :name, prompt: 'Select a State/Province' %> 
```

来源：[http ://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html](http://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-09-27T08:43:13.110

我一直有同样的问题。使用“提示”似乎为选择标签创建了一个属性，问题是我不知道这样的属性。加上它显然不是 Rails 文档[http://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html#method-i-options_from_collection_for_select](http://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html#method-i-options_from_collection_for_select)中描述的内容。

使用 include_blank 对我来说似乎是一个很好的解决方法。

干杯，罗宾。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-19T10:34:28.823

尝试这个`<%= f.collection_select :region_id, Region.all, :id, :name, {prompt: 'Select a State/Province'}, {class: "form-control"} %>`

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-18T09:10:07.977

代替

```
:prompt => "Select a State/Province" 
```

尝试

```
:allow_blank => "Select a State/Province" 
```

编辑：是的，在检查 API 之后，我可以看到我弄糊涂了，提示是根据文档的正确方法，可能只是有时它出现是因为你的对象已经有一个值，因此提示在那里但是它不是下拉列表中当前选择的值？？？

# c# - 在 Gridview_Sorting 之后编辑搞砸了

> ID：760567
> 
> 赞同：0
> 
> 时间：2009-04-17T14:10:38.717
> 
> 标签：c#, asp.net, gridview, sorting, editing

我有一个 Web 应用程序（ASP.NET 2.0 C#），在其中一个页面上我有一个`Gridview`. 有`Gridview`3 列（编辑、ID、名称），并且启用了排序。Edit 不能以常规方式工作：它使用 ID 并将其添加到`QueryString`，然后用户被带到 Edit 页面。像这样的东西：

```
protected void Grid_RowEditing(object sender, GridViewEditEventArgs e)
{
   string editID = Grid.DataKeys[e.NewEditIndex].Value.ToString();  
   Response.Redirect("~/Admin/Edit_Page.aspx?EditID=" +
                     HttpUtility.HtmlDecode(editID));
} 
```

当页面加载时，网格无论如何都不会排序。如果我点击编辑，它工作正常。但是，如果我在排序后单击编辑，它会在排序之前传递最初存在的行的 ID，而不是当前存在的行的 ID。

为什么会这样？有任何想法吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T14:15:25.863

你在重新绑定你的数据集吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T15:19:10.703

如果想保持它的工作方式，可能还有另一种可能的解决方案。如果您使用按钮进行编辑，并且按钮的用户 CommandName 是“编辑”，而 CommandArgument 是正在编辑的实体的 id，那么它可能会起作用。我给你下面的代码。

后面的代码：

```
protected void Grid_RowCommand(object sender, GridViewCommandEventArgs e)
{
    if (e.CommandName == "Edit")
    {
        int intEditId = Convert.ToInt32(e.CommandArgument);
        Response.Redirect("~/Admin/Edit_Page.aspx?EditID=" + intEditId);

    }
 } 
```

.aspx 文件：

在网格中：

```
<asp:TemplateField>
   <ItemTemplate><asp:ImageButton CommandName="Edit"
   CommandArgument='<%# Eval("EditID") %>' runat="server" ID="lnkEdit" ImageUrl="../images/edit.gif" ToolTip="View/Edit"></asp:ImageButton></ItemTemplate></asp:TemplateField> 
```

希望这可以帮助。阿宁迪亚

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T14:30:34.517

在页面加载时尝试在页面未回发时绑定网格。我的意思是页面加载中的以下代码：

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!this.IsPostBack)
        PopulateGrid();
} 
```

这是因为我怀疑，网格会在每个帖子上重新绑定，这可能会导致问题。

# oracle - Oracle：将名称值对展平到表中

> ID：760568
> 
> 赞同：0
> 
> 时间：2009-04-17T14:10:38.903
> 
> 标签：oracle, dynamic-sql, denormalization

我希望有人可以提供一些建议，以更轻松地解决此问题。我正在努力为一组高度规范化的数据创建一个平面视图。扁平化的目标是提供一个普通人可以用来开发报告的视图。源数据包含几个表，如下所示：

```
CREATE TABLE VARIABLES  ( 
    VARIABLE_ID INT NOT NULL IDENTITY, 

    VARIABLE_NAME VARCHAR(100) NOT NULL, 

    VARIABLE_DATATYPE VARCHAR(100) NOT NULL, 

    PRIMARY KEY (VARIABLE_ID), 

    UNIQUE (VARIABLE_NAME,VARIABLE_DATATYPE) 
)

CREATE TABLE RECORD_VALUES (
    RUN_ID INT NOT NULL REFERENCES RUNS (RUN_ID) ON DELETE CASCADE, 

    VARIABLE_ID INT NOT NULL REFERENCES VARIABLES(VARIABLE_ID) ON DELETE CASCADE, 

    RECORD_ID VARCHAR(100) NOT NULL, 

    VARIABLE_VALUE VARCHAR(1000), 

    PRIMARY KEY (RUN_ID,VARIABLE_ID,RECORD_ID)
) 
```

记录值表中的 variable_id 对应于原始输入流中的变量之一，例如地址或帐户余额。对于其中包含 12 个变量的输入记录，记录值表中将有 12 行。

原始过程的输入包括不同宽度和变量名称的记录。这些被拆分为 record_values 表中的名称/值元组。我正在编写一个程序来将变量重新组合成一个看起来像的记录

```
run_id
record_id (which is actually an underlying account number)
variable_value_1
variable_value_2
...
variable_value_n 
```

我目前的方法是通过查找给定运行集的唯一变量来动态构建表（这里的细节不重要），然后构建将创建表的 SQL 字符串。

我的挑战是如何有效地从原始数据加载这个生成的工作表。由于变量的名称和数量因 run_id 而异，我能想到的唯一方法是通过以下方式：

```
create a cursor for the list of variables
for each variable in the list
   create a cursor to find all the record values for that variable
   for each record value
       update the appropriate record/column in the work table
   end
end 
```

这将永远运行，因为父表有 100 的数百万行。

有没有人知道如何生成一种我可以用来对每个目标行进行一次更新的方法？

以免有人跳上原始表格的设计——这样做是有商业原因的。我不喜欢它，但这样做是有充分理由的。

感谢您提供的任何想法。

安德鲁

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T14:29:01.043

在`Oracle 10g`及以上：

```
SELECT  DISTINCT run_id, record_id, val1, val2, ..., val12
FROM    record_values
MODEL
IGNORE NAV
PARTITION BY
        (run_id, record_id)
DIMENSION BY
        (variable_id)
MEASURES
        (val, 0 AS val1, 0 AS val2, ..., 0 AS val12)
RULES UPDATE
        (
        val1[ANY] = val[1], /* Put real variable ID's in the square brackets */
        val2[ANY] = val[2],
        ...,
        val12[ANY] = val[12]
        ) 
```

# .net - ReportViewer (RDLC) 上的文本框不换行但强制分页

> ID：760570
> 
> 赞同：6
> 
> 时间：2009-04-17T14:10:45.643
> 
> 标签：.net, visual-studio-2008, reportviewer, rdlc

情况：我的报告使用了几个 ReportViewer 文本框控件，这些控件根据绑定文本的大小而增长和缩小。当 ReportViewer 文本框控件中的文本太长而无法容纳在当前页面上时，会在文本框***之前***出现分页符，然后将其全部呈现在下一页中。这通常会导致出现分页符的第一页底部出现较大的空白。

我希望文本框将文本包装在两个页面上，呈现尽可能多的文本以适合当前页面，然后将其余部分包装到下一页。有谁知道这是否可能？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2011-06-17T23:22:50.630

这是很有可能的。文本框的**KeepTogether**属性默认为 true，并且是防止文本框分成多个部分的原因。要让您的文本框换行到下一页，只需将**KeepTogether**设置为 false。（请注意，您必须使用*属性窗口*(F4)，而不是*TextBox 属性...*对话框。）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-05T02:56:49.700

这是不可能的。

我的解决方法是将文本按段落拆分为一个数组，并将列表控件与文本框一起使用。

# encoding - 人性化的二进制编码

> ID：760572
> 
> 赞同：5
> 
> 时间：2009-04-17T14:11:18.510
> 
> 标签：encoding

前段时间，我遇到了一个网站，该网站描述了一种对人类友好的二进制到文本编码。例如，在输入（用于解码）时，它接受 0、o 和 O 都作为相同的值，因为人们往往很容易混合这些字符。

不幸的是，我不记得它是怎么称呼的...

编辑：这是我一直在寻找的：“ [Base32 的另一种替代设计是由 Douglas Crockford 创建的](http://www.crockford.com/wrmg/base32.html)，他建议使用额外的字符作为校验和。”

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T14:36:38.293

听起来像[Base32](http://en.wikipedia.org/wiki/Base32)。

有一些变体（例如[z-base-32](http://zooko.com/repos/z-base-32/base32/DESIGN)）接受 O 表示 0，接受 l/I 表示 1 等。

# exception - PHP的异常驱动编程？

> ID：760576
> 
> 赞同：7
> 
> 时间：2009-04-17T14:12:17.853
> 
> 标签：exception, testing, exception-handling

我在他的博客上看到了 Jeff Atwood 关于[异常驱动编程](https://blog.codinghorror.com/exception-driven-development/)的帖子，我很好奇 PHP 是否有类似[ELMAH](https://code.google.com/archive/p/elmah/)的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T14:46:35.667

[Zend Server](http://www.zend.com/en/products/server/)提供对 PHP 应用程序的监控。它可以监控的内容包括：

*   应用响应时间
*   失败的用户请求
*   应用程序可访问性
*   产生的错误

这可能是最接近您的需求的。

# c++ - const 对临时的引用

> ID：760578
> 
> 赞同：9
> 
> 时间：2009-04-17T14:12:50.537
> 
> 标签：c++, reference, temporary

在阅读了 Herb Sutter 博客上的[这篇文章](http://herbsutter.wordpress.com/2008/01/01/gotw-88-a-candidate-for-the-most-important-const/)后，我做了一些实验，遇到了一些让我困惑的事情。我正在使用 Visual C++ 2005，但如果这取决于实现，我会感到惊讶。

这是我的代码：

```
#include <iostream>

using namespace std;

struct Base {
    //Base() {}
    ~Base() { cout << "~Base()" << endl; }
};

int main()
{
    const Base & f = Base();
} 
```

运行时，它会显示“ `~Base()`”**两次**...但是如果我取消注释构造函数，它只会显示**一次**！

有人对此有解释吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-17T14:15:57.937

**这取决于实现。**

该标准允许在将临时绑定到 const 引用时发生副本。在您的情况下，VC++ 仅在隐式定义构造函数时执行复制。这是出乎意料的，但也是允许的。

C++1x[将解决这个问题](http://www.comeaucomputing.com/iso/cwg_defects.html#391)。

# apache-flex - 100% 到 100% Flex 应用程序预加载器定位

> ID：760580
> 
> 赞同：1
> 
> 时间：2009-04-17T14:13:15.637
> 
> 标签：apache-flex, preloader

我在尝试将加载动画应用到我的 Flex 应用程序时遇到问题 - 整个浏览器窗口的占用者。我正在继承 Adob ​​e关于此的[文章中描述的 DownloadProgressBar 类。](http://livedocs.adobe.com/flex/3/html/help.html?content=app_container_4.html)`stageHeight`和`stageWidth`，基类报告的不正确。它在构造函数中显示 500x375 像素，在其他地方显示 0x0。为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-27T13:09:58.493

你解决了这个问题吗？我的 flex 应用程序也有同样的问题。舞台返回 500x375。我的解决方法并不漂亮。此函数在 FlexEvent.INIT_PROGRESS 上调用。所以当我的应用程序可用时，我会使用它的道具。

```
private function onFlexInitProgress( event:FlexEvent ):void {
    if (Application.application != null){
        var appWidth:Number = Application.application.width;
        var appHeight:Number = Application.application.height;
        x = (appWidth * 0.5) - (preloaderSWF.width * 0.5);
        y = (appHeight * 0.5);
        preloaderSWF.visible = true;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T16:35:36.060

我不确定这是否会有所帮助，但我认为可以通过使用 Application.width、Application.height 来引用 Flex 应用程序的大小。

[http://livedocs.adobe.com/flex/3/html/help.html?content=app_container_2.html](http://livedocs.adobe.com/flex/3/html/help.html?content=app_container_2.html)

以下问题似乎与您的问题有关：

[http://www.nabble.com/Stupid-Question---Flex-width-and-height-td21423345.html](http://www.nabble.com/Stupid-Question---Flex-width-and-height-td21423345.html)

[http://www.nabble.com/Flex-stage-size-td20167125.html](http://www.nabble.com/Flex-stage-size-td20167125.html)

[http://dreamweaverforum.info/flex/125327-reference-stage-flex.html](http://dreamweaverforum.info/flex/125327-referencing-stage-flex.html)

希望他们有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T23:55:10.730

0x0 的宽度/高度测量值通常表示所讨论的组件在读取时尚未完全布局（包括子组件）。在构造函数中检查测量值肯定为时过早。在您将舞台设置为全屏并且您正在显示的所有内容都已布置好之后，您可能想要检查测量结果，可能在应用程序创建完成事件中，甚至可能更晚。以下链接应该是一个很好的资源：

[http://blog.flexexamples.com/2007/08/07/creating-full-screen-flex-applications/](http://blog.flexexamples.com/2007/08/07/creating-full-screen-flex-applications/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-18T00:45:16.227

您要做的是将事件侦听器添加到舞台以获取其调整大小事件，并相应地调整预加载器的大小。否则，如果有人在显示预加载器时调整您的 Flex 应用程序的大小，它将不会调整大小。

```
stage.addEventListener(Event.RESIZE, onStageResize);

public function onStageResize(e : Event) : void {
    this.width = stage.stageWidth;
    this.height = stage.stageHeight;
} 
```

或者，您可以使用如下代码将您的预加载器集中在舞台上：

```
preloader.x = this.stage.stageWidth/2 - preloader.width/2; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-27T20:02:59.493

我在 flash builder 的 actionscript 项目中遇到了同样的问题，使用 100% 到 100% 的宽度和高度。我观察到 stage.stageWidth 和 stage.stageHeight 是 500x375，直到预加载器加载主类之后，它才会变为全屏大小。因此，预加载器中的项目定位不正确。我发现正是我的主课中的这一行正在更新舞台大小：

```
stage.scaleMode = StageScaleMode.NO_SCALE; 
```

这是我在预加载器中实现它的方式：

```
public function Preloader()
    {
        addEventListener(Event.ADDED_TO_STAGE, onAddedToStage);
    }

    private function onAddedToStage(event:Event):void {
        removeEventListener(Event.ADDED_TO_STAGE, onAddedToStage);
        stage.scaleMode=StageScaleMode.NO_SCALE;
        stage.align=StageAlign.TOP_LEFT;
        ...
    } 
```

# javascript - 如何引用 HTML 锚点

> ID：760584
> 
> 赞同：4
> 
> 时间：2009-04-17T14:14:37.380
> 
> 标签：javascript, html, iphone, cocoa-touch, uiwebview

我正在通过 loadHTMLString 将一串 HTML 加载到 UIWebView 中。它会产生一个很长的网页。加载该字符串后，我需要导航到设置了“名称”属性的 HTML 锚标记。在 HTML 中，我可能有：

```
//3 pages of text here
<a name="go here"></a> lots more text here
//another 3 pages of text here 
```

加载后，我需要网页向下滚动到“转到此处”。如果用户单击网页内的链接并加载外部 URL，则映射工作正常。但在这种情况下，我需要先向下滚动一个已经加载的网页。

我仍然可以像这样执行 JavaScript 代码：

```
[MyWebView loadHTMLString:dataString baseURL:[NSURL URLWithString:@"http://www.myscheme.com"]];
[webView stringByEvaluatingJavaScriptFromString:@"javascriptFunc('param1');"]; 
```

但是我需要类似的东西来导航到锚标记。有什么建议么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-12-29T18:24:00.973

您可以通过执行以下操作跳转到已加载的 HTML 文件中的锚点：

```
[webView stringByEvaluatingJavaScriptFromString:@"window.location.hash='#foo'"]; 
```

这将执行跳跃，无动画。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T14:25:46.837

如果我没记错的话，只需将#go%20here 添加到 URL 的末尾即可。

啊，你的意思是已经加载了。只是重新加载页面真的不可能吗？无论如何，浏览器应该已经缓存了大部分内容......

# c# - 如何将方程转换为单个变量的公式？

> ID：760604
> 
> 赞同：6
> 
> 时间：2009-04-17T14:18:58.383
> 
> 标签：c#, .net, math, logic, expression-trees

如何将方程转换为单个变量的公式？我正在考虑一个数学方程式，例如：

```
c^2 = a^2 + b^2 
```

我想要一个可以处理任何公式的函数，并给我单独的变量公式。上述等式将产生以下结果：

```
a = (c^2 - b^2)^0.5
b = (c^2 - a^2)^0.5
c = (a^2 + b^2)^0.5 
```

我也想从以下开始：

```
a = (c^2 - b^2)^0.5 
```

和输出：

```
b = (c^2 - a^2)^0.5
c = (a^2 + b^2)^0.5 
```

我看过表达式树，但我无法想象它是如何工作的。我想要一个 .NET（C#、VB.NET 或 F#）解决方案。有任何想法吗？

就像是：

```
public string[] GetFormulas(string equation)
{
   ...
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-17T14:27:14.323

符号方程求解是一个复杂的问题，许多方程没有封闭解。编写自己的[计算机代数系统](http://en.wikipedia.org/wiki/Computer_algebra_system)并非易事，但您也许可以编写简单方程的程序。

您必须构建输入字符串的表达式树并定义用于操作表达式树的转换规则。为了求解一个变量，您可以在表达式树的空间上执行搜索（由良好的启发式方法引导以保持运行时可接受），表达式树可以通过转换规则的多种应用从原始树派生。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-17T14:26:42.513

这是您要解决的一个不平凡的问题……我认为您自己尝试解决它不会有太大的运气。最好找到某种第三方应用程序或库来做到这一点。有许多程序可以完成您所说的操作，例如 Matlab 和 Maple。此外，TI-89 图形计算器可以做到这一点。您也许可以从[Octave](http://www.gnu.org/software/octave/)获得所需的算法，它本质上是 Matlab 的开源实现。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T14:26:35.993

这是您可能希望使用数学库查看的内容。对于 .NET，[Math.NET](http://mathnet.opensourcedotnet.info/)似乎是最完整的选择（不确定它有多稳定，但它肯定非常完整）。进行符号操作的库应该能够处理您在此处提出的特定问题。

老实说，从头开始写这个应该不会*太难*，但如果你对表达式树不是很熟悉并且不知道如何处理这个任务，我仍然建议使用现有的数学库，无论是 Math. NET 或任何其他体面的符号代数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-17T14:28:01.530

您唯一的选择是通过应用所有已知技术来暴力破解它。在像上面这样的简单代数方程中，这可能就足够了，但更复杂的问题将需要越来越复杂的解决方案。简而言之，这并不容易。

一旦你弄清楚如何将文本解析为符号，创建一个可以确定

```
c^2 = a^2 + b^2 
```

可以替换为

```
c = (a^2 + b^2)^.5 
```

但是关于

```
cos(c) = sin(a^2/b) - b^(a/sin(b)) 
```

更糟糕的是，您有无法解决的集成和抽象代数……您必须在某处绘制复杂性线，否则您最终将构建另一个[Maple](http://www.maplesoft.com/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-17T14:27:01.703

以符号和非数字的方式处理方程绝对不是一件容易的事。我认为对你来说最简单的方法是在幕后简单地使用 Mathematica、Maple 或类似的工具，让他们为你做艰苦的工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T14:23:04.207

由于 c^2 = a^2 + b^2 不是 C# 中的表达式，因此您走错了路。

忘记 .NET 表达式树并创建自己的。您需要描述进行这些转换所需的算法，以及描述方程所需的数据。您会发现最终得到的结果与 .NET 表达式树完全不同。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-17T14:32:34.217

除了已经说过的任何内容之外，您还可以查看数值方法。

有一些算法可以对方程的解进行近似。因为它们中的大多数都不会那么容易（甚至不可能）准确地解决。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-17T15:05:31.547

总体来说是个讨厌的问题。对于低阶多项式表达式，这并不太难。对于线性问题，您只需要一个解析器和一点点后处理。但即使是一个简单的表达式也可能不是微不足道的。例如，您将如何处理

```
x^5 + y^5 - xy + 1 = 0 
```

用其他方式求解 x 或 y 中的任何一个，您必须求解 5 阶非常数系数多项式的根。这通常是不可能做到的。

更糟糕的是，在混合中引入三角函数或任何特殊函数，它会迫使你在完成之前重新编写 Mathematica。

# java - 尝试在 Java ME 中播放音乐，但出现异常“不兼容的类型”

> ID：760606
> 
> 赞同：1
> 
> 时间：2009-04-17T14:21:01.297
> 
> 标签：java, java-me

我需要播放音乐（这是我游戏中唯一的声音）。到目前为止，我已经写了这个，但它一直给我错误：

```
"incompatible types" 
```

这是我的声音代码：

```
try {
    InputStream is = getClass().getResourceAsStream("/sound.wav");
    Player p = Manager.createPlayer(is, "/X-wav");
    p.start();
} catch (IOException ioe) { 
} catch (MediaException me) { 
} 
```

错误发生在第 3 行；

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-17T14:48:32.807

具体来说，尝试“audio/wav”而不是“X/-wav”；否则，请查看 Manager.getSupportedContentTypes() 返回的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T14:36:22.227

使用 Manager 静态函数来确定目标手机上支持的 mime 类型。

/X-wave 给我的印象是错误的，尽管我接触 j2me 已经有一段时间了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T04:03:06.350

尼尔是对的，首先检查支持的类型。大多数手机支持mid和mp3。部分手机支持wav文件，但是wav文件比较大，占用内存和jar空间，不推荐

# .net - Path.Combine 如何与两个以上的参数一起使用？

> ID：760612
> 
> 赞同：23
> 
> 时间：2009-04-17T14:23:57.840
> 
> 标签：.net, string, path, io, concatenation

我很惊讶没有可以采用字符串数组的重载。无论如何，避免嵌套调用 Path.Combine 的最佳方法是什么？

```
pathValue = Path.Combine(path1, Path.Combine(path2, Path.Combine(path3, path4))) 
```

这似乎效率低下，因为它导致创建四个新字符串只是为了获得一个。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-04-17T14:51:28.523

如果您已经有一个数组或 IEnumerable<T> 那么您可以在一行中执行此操作...

```
// I'm assuming that you've got an array or IEnumerable<T> from somewhere
var paths = new string[] { path1, path2, path3, path4, path5, path6 };

string result = paths.Aggregate(Path.Combine); 
```

如果没有，那么将您自己的扩展方法写入字符串...

```
public static class PathExtension
{
    public static string CombinePathWith(this string path1, string path2)
    {
        return Path.Combine(path1, path2);
    }
} 
```

...这将允许您像这样链接这些...

```
string result = path1.CombinePathWith(path2)
                     .CombinePathWith(path3)
                     .CombinePathWith(path4)
                     .CombinePathWith(path5)
                     .CombinePathWith(path6); 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-04-17T14:33:39.503

事物的效率方面不是 IMO 的问题 - 它是事物的可用性方面。我个人认为应该超载：

```
Combine(string first, string second, string third, params string[] others) 
```

如果您只是编写，您至少需要三个以防止它与现有的双参数版本发生冲突，`Path.Combine("foo", "bar")`但这肯定有助于使代码更清晰。为什么不在[Connect](http://connect.microsoft.com/)上打开功能请求？

当然，您可以自己实现它（在另一个类中，参数的数量并不重要）：

```
public static string CombinePaths(string first, params string[] others)
{
    // Put error checking in here :)
    string path = first;
    foreach (string section in others)
    {
        path = Path.Combine(path, section);
    }
    return path;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T14:40:05.150

自己实现它非常简单：

```
public string Combine(params string[] paths)
{
    char[] pathSeparators = new char[] 
        { Path.AltDirectorySeparatorChar, Path.DirectorySeparatorChar, Path.VolumeSeparatorChar };

    if(paths == null) throw new ArgumentNullException("paths");
    if(paths.Length == 1) return paths[0];

    StringBuilder pathBuilder = new StringBuilder();

    foreach(string path in paths)
    {
        if(Path.IsPathRooted(path))
            pathBuilder = new StringBuilder(path);
        else
        {
            char last = pathBuilder.Length > 0 ?
                pathBuilder[pathBuilder.Length - 1] :
                path[path.Length - 1];

            if(Array.IndexOf(pathSeparators, last) == -1)
                pathBuilder.Append(Path.DirectorySeparatorChar);

            pathBuilder.Append(path);
        } // else
    } // foreach

    return pathBuilder.ToString();
}

[Test()]
public void CombinePaths()
{
    string result = Combine(@"C:\Program Files\", @"Microsoft.NET", @"ADOMD.NET\", "90", "msadomdx.dll");
    Assert.AreEqual(@"C:\Program Files\Microsoft.NET\ADOMD.NET\90\msadomdx.dll", result);
} 
```

# vb.net - 在字符串中某个字符之后删除空格的最佳方法是什么？

> ID：760613
> 
> 赞同：1
> 
> 时间：2009-04-17T14:24:43.080
> 
> 标签：vb.net, string

我正在尝试构建一个列表，该列表将用作 select 语句的 in 子句。要求是让用户输入以逗号分隔的描述列表。每个描述都可以包含空格，所以我不能在用逗号分隔之前删除空格以在每个描述周围添加单引号。我想删除单引号后的所有空格，因为没有描述会以空格开头。在 VB.NET 中执行此操作的最佳方法是什么？正则表达式还是字符串函数？这是我到目前为止所拥有的：

```
Partial Class Test
    Inherits System.Web.UI.Page

    Protected Sub cmdGetParts_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles cmdGetParts.Click
        Dim sDescriptionList As String = ""
        BuildList(sDescriptionList)
        RemoveSpacesFromList(sDescriptionList)
        FillGrid(sDescriptionList)
    End Sub

    'Build descriptions List based on txtDescriptionList.Text
    Private Sub BuildList(ByRef sDescriptionList As String)
        Dim sDescriptionArray As String()
        sDescriptionArray = txtDescriptionList.Text.Trim.Split(","c)
        Dim iStringCount As Integer = 0
        For Each description In sDescriptionArray
            If iStringCount > 0 Then
                sDescriptionList = sDescriptionList & ","
            End If
            sDescriptionList = sDescriptionList & "'" & description & "'"
            iStringCount = iStringCount + 1
        Next
    End Sub

    **'This procedure removes unwanted spaces from  description list
    Private Sub RemoveSpacesFromList(ByRef sList As String)
        sList = sList.Replace("' ", "'")
    End Sub**

    'This procedure fills the grid with data for descriptions passed in
    Private Sub FillGrid(ByVal sDescriptionList As String)
        Dim bo As New boPart
        Dim dtParts As Data.DataTable
        dtParts = bo.GetPartByDescriptionList(sDescriptionList)
        GridView1.DataSource = dtParts
        GridView1.DataBind()
    End Sub
End Class 
```

***编辑：查看此代码后，我想我可以将 description.Trim 放在 BuildList 过程的 For Each 循环中。***

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T14:28:47.113

只要你不能嵌入单引号，下面就可以了

```
Dim replaced = Regex.Replace(input, "'\s+", "'") 
```

正则表达式字符串`'\s+`将匹配任何单引号，后跟一个或多个空格字符。此匹配的所有实例都将替换为单引号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T14:36:08.093

使用正则表达式将逗号与任何周围的空格匹配，并用撇号和逗号替换。第一个项目的起始撇号和最后一个项目的结束撇号，您只需在之后添加。

`RemoveSpacesFromList`不再需要该方法，因为 BuildList 方法可以完成所有工作。

```
Protected Sub cmdGetParts_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles cmdGetParts.Click
    Dim descriptions As String = txtDescriptionList.Text
    descriptions = BuildList(descriptions)
    FillGrid(descriptions)
End Sub

''//Build descriptions List based on a comma separated string
Private Function BuildList(ByVal descriptions As String) As String
   Return "'" + Regex.Replace(descriptions, "\s*,\s*", "','", RegexOptions.Compiled) + "'"
End Function 
```

注意：
如果您使用此字符串构建 SQL 查询，则您的应用程序很容易受到 SQL 注入攻击。使用参数化查询是首选方法，但在您的情况下这可能不方便。用户输入必须至少在用于查询之前进行清理。

编辑：
如果适配器在字符串文字中使用撇号作为转义字符，则可以像这样正确转义字符串：

```
Private Function BuildList(ByVal descriptions As String) As String
   Return "'" + Regex.Replace(descriptions.Replace("'","''"), "\s*,\s*", "','", RegexOptions.Compiled) + "'"
End Function 
```

# subsonic - 使用 SubSonic 返回 SQLDataReader？

> ID：760614
> 
> 赞同：0
> 
> 时间：2009-04-17T14:24:46.483
> 
> 标签：subsonic, sqldatareader

我正在更新一个 Web 应用程序并决定使用 SubSonic，因为它看起来很棒，我想学习它:) 我正在尝试`SQLDataReader`从我已经拥有的方法中返回 a 并且已经这样做了

```
public SqlDataReader GetAllCarTypes_dr()
{
    return (SqlDataReader)new Query("tblCarType").ExecuteReader();
} 
```

只是检查这是正确的方法吗？或者有更好的亚音速语法`ExecuteSQLDataReader()`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T14:45:31.253

您指定的方式是您可以做到的一种方式。但是，没有`ExecuteSQLDataReader()`功能，因为它是多余的。

由于`SQLDataReader`已经实现了`IDataReader`接口，因此创建特定于`SQLDataReader`.

您可以考虑以与 SubSonic 相同的方式返回接口，例如：

```
public IDataReader GetAllCarTypes_dr()
{
    return new Query("tblCarType").ExecuteReader();
} 
```

并在您的逻辑中执行分配：

```
SQLDataReader reader = GetAllCarTypes_dr(); 
```

我认为这是最好的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T14:46:44.167

好吧，它编译，对吧？只是在开玩笑。

这个链接给出了关于何时使用的更多解释：http: [//social.msdn.microsoft.com/Forums/en-US/adodotnetdataproviders/thread/a8ed157d-e93c-4a8d-83a4-78645614b4ac](http://social.msdn.microsoft.com/Forums/en-US/adodotnetdataproviders/thread/a8ed157d-e93c-4a8d-83a4-78645614b4ac)

只要确保你在某个地方关闭了阅读器（读者？），这样他们就不会留下开放的连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T18:10:00.647

```
private void CreateDynamicControls()
{

    panGvHolder.Controls.Clear();

    Query qry = Northwind.Product.CreateQuery();
    qry.Columns.AddRange(Northwind.Product.Schema.Columns);
    qry.WHERE("UnitPrice > 15").AND("UnitsInStock < 20 ");
    //WHERE("UnitPrice > 15").AND("UnitsInStock < 30 ");

    using (IDataReader rdr = qry.ExecuteReader())
    {
        Response.Write("<table>");
        while (rdr.Read())
        {
            Response.Write("<tr>");
            for (int i = 0; i < rdr.FieldCount; i++)
            {
                Response.Write("<td>");
                Response.Write(rdr[i].ToString() + " ");
                Response.Write("<td>");
            } //eof for 
            Response.Write("</br>");
            Response.Write("</tr>");
        }
        Response.Write("<table>");
    }
} //eof method 
```

# c# - 如何在项目文件夹中找到不再在项目中的 .CS 文件？

> ID：760622
> 
> 赞同：5
> 
> 时间：2009-04-17T14:27:04.947
> 
> 标签：c#, .net, visual-studio

随着我们项目多年来的发展，许多 .cs 文件已从项目中删除、重命名等，但它们仍处于源代码控制中。因此，当您提取最新代码时，您将获得所有这些 .cs 文件，这些文件不再在任何 .csproj 文件中引用。

有人知道检测这些文件并消除它们的简单、可靠的机制吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T14:41:42.587

最好使用脚本语言来完成此任务。我发现 powershell 非常适合这种情况。

第 1 步是查找包含在您的 csproj 文件中的所有实际 .cs 文件。以下函数将搜索所有 csproj 文件的目录结构并返回包含在这些文件中的一组 .cs 文件

```
function Get-IncludedCsFiles() {
  param ( $rootPath = $(throw "Need a path") )
  $projFiles = gci -re -in *.csproj $rootPath
  foreach ( $file in $projFiles ) { 
    $dir = split-path $file.FullName
    foreach ( $line in (gc $file) ) { 
      if ( $line -match 'Compile\s+Include="([^"]+)"' ) {
        join-path $dir $matches[1]
      }
    }
  }
} 
```

现在您需要做的就是将其包装到字典中，然后在目录结构中进行搜索

```
$map = @{}
$pathToSearch = "Path\To\Search"
Get-IncludedCsFiles $pathToSearch | 
%{
    if(!$map.Contains($_))
    {
      $map.Add($_, $true)
    } 
}
$notIncluded = gci -re -in *.cs $path | ?{ -not $map.Contains($_.FullName) } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-17T14:59:03.997

在 VS 解决方案资源管理器中尝试“显示所有文件”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-11-13T10:42:36.830

我前段时间为此做了一个小项目。[在这里](https://github.com/RogerKratz/NonSolutionFiles)可用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T14:47:49.233

我目前手头没有 VS，但是解决方案资源管理器中没有“显示不在项目中的文件”选项吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-03-24T15:59:15.953

感谢 JaredPar 的解决方案！正因为如此，这对我来说要容易得多:) 你所提供的有点强大的版本。

```
function Get-IncludedCsFiles() 
{
  param ( $rootPath = $(throw "Need a path") )
  $projFiles = gci -re -in *.csproj $rootPath
  foreach ( $file in $projFiles ) 
  {
    $dir = split-path $file.FullName
    foreach ( $line in (gc $file) ) 
    { 
      $correctedLine = $line -replace '%28', '(' #some files have "(" in them, and csproj changes them for %28
      $correctedLine = $correctedLine -replace '%29', ')'

      if ($correctedLine -match 'Compile\s+Include="([^"]+)"') 
      {
        $filepath = join-path $dir $matches[1]
        [System.IO.Path]::GetFullPath($filePath)#this resolves path (removes \..\)
      }
    }
  }
}

$tempFilePattern = '*\obj\*'
$map = @{}
$pathToSearch = "Path to search"
$resultFilePath = [io.path]::combine($pathToSearch, 'notIncluded.txt')

Get-IncludedCsFiles $pathToSearch | 
%{
    if(!$map.Contains($_))
    {
      $map.Add($_, $true)
    }
}

echo "Map created"

$notIncluded = gci -re -in *.cs $path | ?{ (-not $map.Contains($_.FullName)) -and !($_ -like $tempFilePattern)} | %{$_.FullName}

$notIncluded | Out-File $resultFilePath

$notIncluded |
%{
    #tf delete $_ #Remove from TFS
} 
```

它还考虑名称中带有括号的文件，与 csproj 不在同一文件夹中的文件（或其下的子文件夹）。此外，它不包括通过编译（/obj/ 文件夹）创建的临时生成的文件。它列出了输出文件中的所有路径，您甚至可以将它们从 TFS 中删除。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T15:38:59.970

避免此问题的一种方法是程序：（适用于任何项目，但“网站”项目除外，该项目没有项目文件）：

不要从源代码管理工具中“获取最新”，而是始终在 Visual Studio 中执行“从源代码管理中打开”，并从解决方案资源管理器中获取最新信息。VS 只会拉取属于该项目的文件。

这不是一个完美的答案——当你执行合并时，你最终可能会拉下分支中的每个文件，但它对我们来说效果很好。

（当然，这要求您使用提供 VS 集成的源代码控制工具——它还要求您将任何未编译但必需的文件（图标等）添加到项目中，否则它们不会被下拉VS）。

# nhibernate - NHibernate 不保存对象的项目集合

> ID：760627
> 
> 赞同：1
> 
> 时间：2009-04-17T14:27:41.047
> 
> 标签：nhibernate, collections

我有一个包含 OrderItems 的 Order 类。当我保存 Order 类时，数据库中填充了 Order 信息，但没有一个子 OrderItems 保存到它们各自的表中。下面是 Order 映射的样子：

```
<class name="Order" table="Orders">
<id name="OrderID" column="OrderID" type="Int64" unsaved-value="0">
  <generator class="identity"/>
</id>
<list name="OrderItems" table="OrderItems" inverse="true" >
  <key column="OrderID"/>
  <index column="OrderItemID" />
  <one-to-many class="OrderItem" />
</list> 
```

下面是 OrderItem 映射的样子：

```
<class name="OrderItem" table="OrderItems">
<id name="OrderItemID" column="OrderItemID" type="Int64" unsaved-value="0">
  <generator class="identity"/>
</id>
<property name="OrderID" />
<many-to-one name="Order" class="Order" column="OrderID" not-null="true" />
</class> 
```

保存订单的代码如下所示：

```
if (o.CreatedBy == null || o.CreatedBy == string.Empty) {
       o.CreatedBy = userID.ToString();
       foreach (OrderItem oi in obj.OrderItems) {
           oi.CreatedBy = userID.ToString();
           oi.ModifiedBy = userID.ToString();
           oi.ModifiedOn = DateTime.Now;
        }
 }
 o.ModifiedBy = userID.ToString();
 o.ModifiedOn = DateTime.Now;
 ISession session = NHibernateHelper.GetCurrentSession();
 ITransaction tx = session.BeginTransaction();
 session.Save(o);
 tx.Commit();
 NHibernateHelper.CloseSession(); 
```

知道为什么没有保存子 OrderItems 吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-17T14:50:54.563

要使更新命令在 Order 的所有子节点上传播，您需要在集合映射上启用级联更新：

```
<list name="OrderItems" table="OrderItems" inverse="true" cascade="all">
  <key column="OrderID"/>
  <index column="OrderItemID" />
  <one-to-many class="OrderItem" />
</list> 
```

此外，由于集合被标记为“反向”并且 - 在上面的示例中 - 您正在尝试**保存**新订单，因此您需要单独更新 OrderItem.Order 属性并对项目发出 Update() 调用：

```
using(ITransaction tx = session.BeginTransaction()){
    session.Save(o);
    foreach(var item in o.OrderItems){
        item.Order = o;
        session.SaveOrUpdate(item);
    }
    tx.Commit();
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-17T14:34:02.420

添加`cascade="all"`到您的集合映射。

# javascript - Javascript AJAX 函数在 IE 中不起作用？

> ID：760628
> 
> 赞同：2
> 
> 时间：2009-04-17T14:27:47.833
> 
> 标签：javascript, internet-explorer, xmlhttprequest

我有这个代码：

```
function render_message(id)
{
var xmlHttp;
  xmlHttp=new XMLHttpRequest();  
  xmlHttp.onreadystatechange=function()
    {
    if(xmlHttp.readyState==4)
      {
        document.getElementById('message').innerHTML=xmlHttp.responseText;
        document.getElementById('message').style.display='';
        }
    }
    var url="include/javascript/message.php";
    url=url+"?q="+id;
  xmlHttp.open("GET",url,true);
  xmlHttp.send(null);
} 
```

由于某种原因，它在 IE 中不起作用，并且在“document.getElementById('message').innerHTML=xmlHttp.responseText;”这一行报告了错误 带有“未知的运行时错误”。

任何人都可以帮忙吗？

编辑：添加到 div 的代码是有效的代码等。

这是回应：

```
<div style="margin-left:auto;margin-right:auto;width:400px;">
    <img src="/forum/img/avatars/2.gif" width="90" height="89" style="float:left;">
    <div style="margin-left:100px;">
        <span style="font-size:16pt;">Sam152</a></span><br>
        <span style="font-size:10pt;text-transform:uppercase;font-weight:bold;">From Sam152</span><br>
        <span style="font-size:10pt;font-weight:bold;">Recieved April 17, 2009, 9:44 am</span><br>
        <br><br>

    </div>
</div>
<div style="margin-left:auto;margin-right:auto;width:400px;">
        asd</div>
<div style="margin-left:auto;margin-right:auto;width:400px;text-align:right;padding-top:10px;">
        <span onClick="requestPage('http://www.gametard.com/include/scripts/delete_message.php?id=14');document.getElementById('message14').style.display='none';document.getElementById('message').style.display='none';" class="button">Delete</span>
        <span onClick="document.getElementById('message').style.display='none';" class="button">Close</span>
        <span onClick="document.getElementById('to').value ='Sam152';document.getElementById('to').style.color ='#000';document.getElementById('newmessage').style.display='';" class="button">Reply</span>     

</div> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T14:44:55.827

不确定以下是否适用于您，因为您没有提及您使用的 ie 版本。

仅适用于 ie7 以上

```
var xmlhttp=new XMLHttpRequest(); 
```

在 Internet Explorer 5 和 6 中，您必须使用

```
var xmlhttp=new ActiveXObject("Microsoft.XMLHTTP"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T14:31:40.147

[你的问题。](http://piecesofrakesh.blogspot.com/2007/02/ies-unknown-runtime-error-when-using.html)

本质上，您正在尝试添加在您添加它的上下文中没有意义的 HTML。在没有 ul 的地方添加 li，或者在没有 table 的地方添加行会导致这种事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T14:52:31.703

相信我：使用 Ajax 框架。

jQuery 或原型或任何其他。

不要自己动手——你只是看到了这个问题的跨浏览器冰山一角。

如果您必须自己做，请`xmlHttp.status`在收到您的消息之前检查。请记住，IE 有时会在此处返回 Windows 错误代码而不是 HTTP 状态，如果错误是连接丢失而不是 HTTP 状态，旧版 FX 会引发异常。

哦，IE6 仍然占网络市场的 30% 和企业市场的 60%，所以@Paul Whelan 的建议也值得一试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T14:36:29.403

如果结果是无效的 HTML - 例如`<a><a>foo</a></a>`或`<a><p>foo</p></a>`.

如果没有看到更多代码（“消息”是什么类型的元素以及 responseText 是什么），很难说更多。

您的代码无效：

```
<span style="font-size:16pt;">Sam152</a></span>
                                    ^^^^ 
```

# zend-framework - 找不到类 Zend_Test_PHPUnit_ControllerTestCase

> ID：760640
> 
> 赞同：3
> 
> 时间：2009-04-17T14:33:24.760
> 
> 标签：zend-framework, phpunit

当我运行 phpunit 来测试我的控制器时，总会出现以下消息：`Class Zend_Test_PHPUnit_Controller_TestCase could not be found ...`

所有 require_once 都被执行并运行而没有错误。

我的文件：

**测试.php：**

```
<?php

require_once 'bootstrap.php';

class indexTest extends Zend_Test_PHPUnit_ControllerTestCase
{
    protected function setUp ()
    {
        $this->bootstrap = array($this, 'appBootstrap');
        parent::setUp();
    }

    public function appBootstrap ()
    {
        $this->frontController->registerPlugin(new DemoApp_Controller_Plugin_Initialize('test', PROJECT_ROOT));
    }

    public function testIndex()
    {
        $this->dispatch('/');
        $this->assertController('login');
    }   
} 
```

**引导程序.php：**

```
<?php
define('APPLICATION_PATH', realpath(dirname(__FILE__) . '/../src/application/'));

set_include_path( APPLICATION_PATH . '/../library' . PATH_SEPARATOR .
        APPLICATION_PATH . '/modules' . PATH_SEPARATOR .
        APPLICATION_PATH . '/layouts' . PATH_SEPARATOR .
        get_include_path() );

require_once 'PHPUnit/Framework.php';     
require_once 'PHPUnit/Framework/TestSuite.php';    
require_once 'PHPUnit/TextUI/TestRunner.php';

error_reporting(E_ALL);

require_once APPLICATION_PATH . "/../library/Zend/Loader.php";
Zend_Loader::registerAutoload();

// Set up the config in the registry path relative to public/index.php
$config = new Zend_Config_Ini(APPLICATION_PATH . '/config.ini'); //, 'test'
Zend_Registry::set('config', $config);

/*// Set up the database in the Registry
$db = Zend_Db::factory($config->db);
Zend_Db_Table_Abstract::setDefaultAdapter($db);
*/

// Set timezone
date_default_timezone_set("Europe/Berlin"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T19:50:58.490

该类不在您的包含路径中，或者您根本没有该类。
采取的步骤：

1.  找到类文件
2.  确保该类在您的包含路径中，包括 auto_loader 名称解析： Z_Y_YourClass 将查看 include_path/Z/Y/YourClass.php

祝你好运

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-01T04:55:29.587

你可以把它放在你的引导程序中来激活自动加载器。

`require_once 'Zend/Loader/Autoloader.php'; $loader = Zend_Loader_Autoloader::getInstance();`

如果您创建应用程序对象，它会自动为您执行此操作，否则请使用上述内容自行执行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T12:05:26.590

我在以下设置中遇到了类似的问题

*   下载了zend 1.12，
*   通过 zf 工具创建了一个项目：`sh bin/zf.sh create project my-project`
*   然后`phpunit`从项目的根文件夹运行。

**解决方案**是然后`cd tests`运行 ​​phpunit。

发生这种情况的**原因**是 phpunit 需要先引导。引导脚本在`tests/phpunit.xml`配置文件中定义，如果文件与命令运行在同一目录中，则默认加载该文件。

phpunit.xml：

```
<?xml version="1.0" encoding="utf-8" ?>
<phpunit bootstrap="./bootstrap.php">
    <testsuite name="Application Test Suite">
    .... 
```

或者，您可以使用 -c 参数从指定 phpunit.xml 位置的任何目录调用 phpunit

```
phpunit -c tests/phpunit.xml 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T19:50:30.037

最明显的第一个问题是，Zend 框架源代码有什么版本？在里面`Zend/Version.php.`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-02-28T17:16:32.020

把它放在你的 bootstrap.php 文件中：

```
require_once 'Zend/Test/PHPUnit/ControllerTestCase.php'; 
```

为我工作。祝你好运！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-01-10T11:10:21.787

两个对我有用的解决方案：

1.  在测试目录中创建符号链接作为 ln -s ../library/Zend 允许自动加载器找到文件
2.  将 /library 添加到 php 包含路径 - 这也有助于自动加载器定位文件

# python - 生成器函数被执行两次？

> ID：760647
> 
> 赞同：1
> 
> 时间：2009-04-17T14:35:51.743
> 
> 标签：python, generator

我正在使用 python 生成器函数为我提供当前目录中的图像列表。但是我看到该函数两次而不是一次给出整个列表，我不知道为什么。我正在使用 Python PIL 库来创建批量缩略图。

谁能指出我正确的方向？

脚本：

```
 import os
import sys
import Image

class ThumbnailGenerator:
    def __init__(self, width, height, image_path, thumb_path):
        self.width = width
        self.height = height
        self.image_path = image_path
        self.thumb_path = "%s%s%s" % (self.image_path, os.sep, thumb_path)

    def __call__(self):
        self.__create_thumbnail_dir()

        for filename, image in self.__generate_image_list():
            try:
                thumbnail = "%s%s%s" % (self.thumb_path, os.sep, filename)
                image.thumbnail((self.width, self.height))
                image.save(thumbnail, 'JPEG')
                print "Thumbnail gemaakt voor: %s" % filename
            except IOError:
                print "Fout: thumbnail kon niet gemaakt worden voor: %s" % filename

    def __generate_image_list(self):
        for dirpath, dirnames, filenames in os.walk(self.image_path):
            count = 0
            for filename in filenames:
                try:
                    image = Image.open(filename)
                    print '=========', count, filename
                    count += 1
                    yield (filename, image)
                except IOError:
                    pass

    def __create_thumbnail_dir(self):
        try:
            os.mkdir(self.thumb_path)
        except OSError as exception:
            print "Fout: %s" % exception

if __name__ == '__main__':
    try:
        thumbnail_generator = ThumbnailGenerator(80, 80, '.', 'thumbs')
        thumbnail_generator()
    except KeyboardInterrupt:
        print 'Programma gestopt' 
```

此时脚本的输出（带有一些测试图像）是：

```
========= 0 124415main_image_feature_380a_ys_full.jpg
缩略图gemaakt voor：124415main_image_feature_380a_ys_full.jpg
========= 1 60130main_image_feature_182_jwfull.jpg
缩略图gemaakt voor：60130main_image_feature_182_jwfull.jpg
========= 2assetImage.jpg
缩略图gemaakt voor：assetImage.jpg
========= 3 devcon-c1-image.gif
Fout：缩略图 kon niet gemaakt worden voor：devcon-c1-image.gif
========= 4 image-646313.jpg
缩略图gemaakt voor：image-646313.jpg
========= 5 图片-Schloss_Nymphenburg_Munich_CC.jpg
缩略图图像：Image-Schloss_Nymphenburg_Munich_CC.jpg
========= 6 image1w.jpg
缩略图gemaakt voor：image1w.jpg
========= 7 新%20Image.jpg
缩略图gemaakt voor：New%20Image.jpg
========= 8 samsung-gx20-image.jpg
缩略图gemaakt voor：samsung-gx20-image.jpg
========= 9 三星图片.jpg
缩略图gemaakt voor：samsung-image.jpg
========= 0 124415main_image_feature_380a_ys_full.jpg
缩略图gemaakt voor：124415main_image_feature_380a_ys_full.jpg
========= 1 60130main_image_feature_182_jwfull.jpg
缩略图gemaakt voor：60130main_image_feature_182_jwfull.jpg
========= 2assetImage.jpg
缩略图gemaakt voor：assetImage.jpg
========= 3 devcon-c1-image.gif
Fout：缩略图 kon niet gemaakt worden voor：devcon-c1-image.gif
========= 4 image-646313.jpg
缩略图gemaakt voor：image-646313.jpg
========= 5 图片-Schloss_Nymphenburg_Munich_CC.jpg
缩略图图像：Image-Schloss_Nymphenburg_Munich_CC.jpg
========= 6 image1w.jpg
缩略图gemaakt voor：image1w.jpg
========= 7 新%20Image.jpg
缩略图gemaakt voor：New%20Image.jpg
========= 8 samsung-gx20-image.jpg
缩略图gemaakt voor：samsung-gx20-image.jpg
========= 9 三星图片.jpg
缩略图gemaakt voor：samsung-image.jpg

```

虽然它应该是：

```
========= 0 124415main_image_feature_380a_ys_full.jpg
缩略图gemaakt voor：124415main_image_feature_380a_ys_full.jpg
========= 1 60130main_image_feature_182_jwfull.jpg
缩略图gemaakt voor：60130main_image_feature_182_jwfull.jpg
========= 2assetImage.jpg
缩略图gemaakt voor：assetImage.jpg
========= 3 devcon-c1-image.gif
Fout：缩略图 kon niet gemaakt worden voor：devcon-c1-image.gif
========= 4 image-646313.jpg
缩略图gemaakt voor：image-646313.jpg
========= 5 图片-Schloss_Nymphenburg_Munich_CC.jpg
缩略图图像：Image-Schloss_Nymphenburg_Munich_CC.jpg
========= 6 image1w.jpg
缩略图gemaakt voor：image1w.jpg
========= 7 新%20Image.jpg
缩略图gemaakt voor：New%20Image.jpg
========= 8 samsung-gx20-image.jpg
缩略图gemaakt voor：samsung-gx20-image.jpg
========= 9 三星图片.jpg
缩略图gemaakt voor：samsung-image.jpg

```

如您所见，生成器函数两次返回列表（我验证了它，它只被调用一次）。

@heikogerlach：os.walk 找不到缩略图，因为我正在遍历当前目录的文件名，并且缩略图被写入当前目录的名为“thumb”的子文件夹中。该列表是在将缩略图写入“thumb”目录之前生成的，我验证（使用 WinPDB）缩略图不包含在列表中。

@S.Lott：感谢您的建议。os.path.join 解决了这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T14:51:34.357

在您的调试中，打印完整路径。我认为您在浏览`thumbs`目录后正在浏览子目录`.`。

还。

```
class ThumbnailGenerator( object ): 
```

从长远来看，通常效果更好。

请不要`__`在您的方法名称前使用（generate_image_list 和 create_thumbnail_dir）。

不要`"%s%s%s" % (self.image_path, os.sep, thumb_path)`用来制作路径名，请使用`os.path.join`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T14:46:26.337

您的缩略图位于原始图像的子目录中，`self.image_path`并且与原始图像具有相同的名称。您可以检查 walk 是否在创建缩略图时找到它们？只需打印图像的路径和名称即可。

# java - Postgres + Hibernate + Java UUID

> ID：760649
> 
> 赞同：12
> 
> 时间：2009-04-17T14:36:14.193
> 
> 标签：java, hibernate, postgresql, jakarta-ee, uuid

我想将 PostgreSQL 的本机 UUID 类型与 Java UUID 一起使用。我使用 Hibernate 作为我的 JPA 提供程序和 ORM。如果我尝试直接保存它，它只是在 Postgres 中保存为字节。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-23T09:19:13.407

尝试使用最新开发版本的 JDBC 驱动（目前为 8.4dev-700），或者等待下一个发布版本。（编辑添加：8.4-701 已发布）

[发行说明](http://jdbc.postgresql.org/changes.html#version_8.4dev-700)提到了这一变化：

> 将数据库 uuid 类型映射到 java.util.UUID。这仅适用于相对较新的服务器 (8.3) 和 JDK (1.5) 版本。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-11-23T03:36:39.010

[这是我对Hibernate 支持的 Postgresql UUID](https://stackoverflow.com/questions/4495233/postgresql-uuid-supported-by-hibernate/7479035#7479035)的回答的转贴？...我知道这个问题很老，但如果有人偶然发现它，这将帮助他们。

这可以通过向 UUID 添加以下注释来解决：

```
import org.hibernate.annotations.Type;
...
@Type(type="pg-uuid")
private java.util.UUID itemUuid; 
```

至于为什么 Hibernate 不只是将其设为默认设置，我无法告诉你......

**更新**`createNativeQuery`：使用该方法打开具有 UUID 字段的对象似乎仍然存在问题。幸运的是，`createQuery`到目前为止，该方法对我来说效果很好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-21T14:31:03.673

你可以尝试：

```
 @Column(name="foo", columnDefinition="uuid") 
```

其中 columnDefinition 是原生 SQL 的一个片段

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-02-27T22:58:30.550

试试这个

```
@Column(name = "UUID", nullable=false, insertable = false, columnDefinition="uuid DEFAULT uuid_generate_v4()")
private String uuid; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T17:39:51.350

在非 JPA 使用中，我将创建一个 UserType 以将 UUID 格式化为 PostgreSQL 接受的字符串，然后只需将 UserType 实现的名称作为列类型。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-22T21:50:18.913

也许您可以让 UUID 类型自动转换为字符串（uuid.toString() 应该给出规范的 36 字符表示）？DB 通常在字符串和本机类型之间进行可靠的转换。

# php - 带有媒体插件和漂亮网址的良好 CMS/发布平台

> ID：760655
> 
> 赞同：0
> 
> 时间：2009-04-17T14:37:16.203
> 
> 标签：php, content-management-system, media, gallery

我正在寻找一个具有良好媒体库的良好发布平台。我需要展示几种视频和图像，所以一个好的媒体库是必须的。我试过drupal，但我不喜欢节点组织结构。我正在寻找一个简单的 URL 方案，因为将来我可能想将我的静态 html 站点迁移到这个平台。

所以我更喜欢一个网址类似于[www.mysite.com/parent/child/grandchild/page](http://www.mysite.com/parent/child/grandchild/page)的平台，有点像 atlassian confluence 网址（例如：confluence/display/TKB/Technical+Details）。这样我就可以制作一个简单的脚本来将我的静态页面迁移到动态版本。

* * *

编辑：CMS/发布平台必须在 PHP 上运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T15:09:01.930

我会衷心支持 Wordpress。它针对的是博客社区，但许多“严肃”的网站使用它并取得了很大的成功：

*   [http://politicalticker.blogs.cnn.com/](http://politicalticker.blogs.cnn.com/)
*   [http://scobleizer.com/](http://scobleizer.com/)
*   [http://www.zeldman.com](http://www.zeldman.com)
*   [http://www.techcrunch.com/](http://www.techcrunch.com/)

它有许多很棒的媒体处理插件：

[http://wordpress.org/extend/plugins/search.php?q=gallery](http://wordpress.org/extend/plugins/search.php?q=gallery)

并且还可以定制以生成您想要的任何 URL：

[http://codex.wordpress.org/Using_Permalinks](http://codex.wordpress.org/Using_Permalinks)

到目前为止，我已经用它开发了 4 个网站，而且它很容易定制，并且拥有很好的用户群。FTW。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T14:45:38.897

你在寻找开源的东西吗？您可以尝试查看 Drupal 或 Joomla。虽然，我推荐 Drupal。

但是，如果您正在寻找您的企业，那么您真的应该看看 Alfresco。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T15:54:10.417

最近关于[Concrete5](http://www.concrete5.org/)的讨论越来越多。URL 方案简单直接（您选择 slug），以及完整的文件/媒体管理器和[插件市场](http://www.concrete5.org/marketplace/)。我一直将它用于客户工作，它是一种很好的组合，对客户来说非常容易使用，同时对于知道自己在做什么的开发人员来说仍然足够强大。

值得一看。

# interop - 与 Office 2003 和 2007 互操作

> ID：760664
> 
> 赞同：1
> 
> 时间：2009-04-17T14:41:53.290
> 
> 标签：interop, ms-office

我希望我的应用程序功能与两个版本的 Office（以及其中的 Outlook）一起使用。我知道我不能*完全*并行安装它们（Outlook 真的是战斗）。

具体来说，我们的应用程序打开 Outlook，填写一些信息并加载联系人（以便他们可以选择将其发送给谁）以及其他一些基础知识。如果重要，操作系统会因 Windows SP、Server 2003、Server 2008 和 Vista 而异。

我们正在考虑使用 Office 2007（无论我们喜欢与否，迟早*都必须*这样做，所以我要早晚做准备），如果我安装 Office 2007，我发现我无法使用旧的互操作 dll （应用程序不会编译）。我只能假设，如果我使用 2007 互操作，那么 2003 将无法工作——这就是我们现在所做的。

其他应用程序这样做，但我的 Google foo 失败了，而我的 StackOverflow foo 也差不多。

关于如何让 Visual Studio 允许我为两者编写代码的任何想法？

编辑：我实际上忘记了这个问题，但是我有答案。

答案是其他原因。Interop 工作得很好，但是另一段代码引用了另一个版本特定的参考（具体来说是 Excel）而不是 Interop。以前从未与 Interop 合作过，我只是认为这无关紧要，它们是一回事。原来我错了。一旦我们删除了所有引用并重新添加回正常的 Microsoft.Office.Interop 引用，这一切都是 Just Worked (TM)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T14:26:33.333

错误，所以问题可以关闭我将在此处添加答案：

答案是其他原因。Interop 工作得很好，但是另一段代码引用了另一个版本特定的参考（具体来说是 Excel）而不是 Interop。以前从未与 Interop 合作过，我只是认为这无关紧要，它们是一回事。原来我错了。一旦我们删除了所有引用并重新添加回正常的 Microsoft.Office.Interop 引用，这一切都是 Just Worked (TM)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T22:20:49.207

该应用程序不会编译？你在说什么？错误是什么？如果您安装 Office 桌面套件，它应该不会影响您的代码的编译。

您并不是说该应用程序*不起作用*。你是说编译中断。这怎么可能？

可能是您没有安装 PIA，或者旧的 PIA 被卸载，或者当您安装新办公室时，您获得了新的 PIA，并且存在一些不兼容。

后一种选择对我来说似乎难以置信。

我在想这是另外一回事。但是看到这个 Q 已经休眠了多久，我想你现在已经继续前进了。

# linq-to-sql - DBLinq 不生成 where 子句

> ID：760665
> 
> 赞同：3
> 
> 时间：2009-04-17T14:42:07.157
> 
> 标签：linq-to-sql, dblinq

我正在使用 MySQL 和 Postgresql 测试来自 SVN Trunk 的 DBLinq-0.18 和 DBLinq。我只使用了一个非常简单的查询，但在两个数据库上 DBLinq 都没有生成 Where 子句。我已经通过打开 Postgresql 上的语句记录来确认 DBLinq 正在发送的确切请求。

我的 Linq 查询是：

```
MyDB db = new MyDB(new NpgsqlConnection("Database=database;Host=localhost;User Id=postgres;Password=password"));

var customers = from customer in db.Customers
                where customer.CustomerUserName == "test"
                select customer; 
```

查询工作正常，但 DBLinq 生成的 SQL 格式如下：

```
select customerusername, customerpassword .... from public.customers 
```

没有 Where 子句，这意味着 DBLinq 必须在运行 Linq 查询之前将整个表拉下来。

有没有人对 DBLinq 有任何经验并且知道我可能做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T15:45:56.007

我发现了问题，它与 DBLinq 无关。

我一直在测试 IronRuby 的一些东西，其中有一个名为 Microsoft.Scripting.Core 的程序集，它复制了 System.Data.Linq 命名空间（我不知道它为什么这样做）。

参考 Microsoft.Scripting.Core 程序集，我的测试 DBLinq 应用程序可以正常编译和运行，但 SQL 中缺少 where 子句。删除程序集引用会导致正确生成 where 子句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-05T13:59:47.793

我会避免将 DBLinq 用于生产代码...许多 Linq-To-SQL 的功能没有实现，并且浏览源代码显示成熟度较低...许多方法没有实现或标记为“未终止”。

...您已被警告！

# vim - VIM - 显示上次保存版本和当前未保存版本的差异

> ID：760666
> 
> 赞同：18
> 
> 时间：2009-04-17T14:42:32.850
> 
> 标签：vim, diff, vimdiff

> **可能重复：**
> [我可以在将文件保存到 Vim 之前查看更改吗？](https://stackoverflow.com/questions/749297/can-i-see-changes-before-i-save-my-file-in-vim)

> 重复：[我可以在将文件保存到 Vim 之前查看更改吗？](https://stackoverflow.com/questions/749297/can-i-see-changes-before-save-my-file-in-vim)

有没有办法在 VIM 中查看保存版本和编辑版本的差异？

这是场景：我打开了一个文件，编辑了一些东西，但由于一些工作我离开了电脑。过了一段时间，我回来了，我忘记了我在编辑什么，我想看看同一个文件的最后保存版本和当前未保存版本之间的区别。有没有办法做到这一点？

当然，我可以一直撤消直到最后一次更改并开始重做以返回到我未保存的版本。但我想看到的是差异。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-04-17T14:44:12.550

```
:w !diff % - 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-21T23:01:24.770

显然 :DiffOrig 的作用与自定义函数的作用相同，它们在 Golubyev 先生的帖子中做了几个链接。不过，默认情况下它可能只存在于较新版本的 Vim 中。

# javascript - IE6 z-index 错误解决方法，在 Ajax 回发后搞砸了

> ID：760667
> 
> 赞同：0
> 
> 时间：2009-04-17T14:42:41.167
> 
> 标签：javascript, jquery, internet-explorer-6

我有一个页面上有 3 个按钮，当用户单击一个按钮时，它会显示一个模型弹出窗口，用户在其中输入数据等。

在主页上有一个`dropdownlist`弹出模型时会突破模型，这是一个已知的 IE6 z-index 错误。

我的解决方法（尝试后`bgiframe`）是在可见弹出窗口时简单地隐藏下拉菜单。它工作得很好。

主页在下拉列表下方还有一个按钮，单击该按钮时，将执行 Ajax 回发，将所选项目的值发送到数据库。

出于某种原因，在用户单击该按钮后，我的 JavaScript (jQuery) 停止工作。任何想法为什么它搞砸了我的 js 代码？Firebug 不报告任何错误。回发后发送`alert('blah')`事件停止工作（Ajax 回发，而不是整个页面刷新）。

这可能是什么原因？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T14:47:24.790

它可能与您的初始化连接相关联吗？最近阅读了一篇关于[document.ready 和 pageload 之间区别](http://encosia.com/2009/03/25/document-ready-and-pageload-are-not-the-same/)的文章，这可能会有所帮助。

本质上问题可能是您将事件连接到元素，然后在 AJAX 更新之后您的元素实际上已被替换，因此需要重新连接事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T14:54:14.727

1.  您可以发布任何来源或网址吗？
2.  在您的 AJAX 之后，您可以对 location.href 进行任何调用（例如设置哈希或任何东西）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-09-29T00:45:43.303

根据定义 z-index 工作的权威指南，您需要一个包装相对定位元素，其中子定位元素的 z-index 定义为低至 1 或更大，而不是某些首选的 9999。对于 IE6，您也许可以利用下划线 css hack 来获取 IE6 z-index。已经有一段时间了，但你可以试试 { position:absolute; _z-索引：2；}

# c - 有人可以解释这个 C 函数吗？

> ID：760668
> 
> 赞同：-1
> 
> 时间：2009-04-17T14:43:15.143
> 
> 标签：c

我对这种语法有一些问题。有人可以向我解释这个 C 函数在做什么吗？

```
unsigned long protodec_henten(int from, int size, unsigned char *frame)
{
   int i = 0;
   unsigned long tmp = 0;

   for (i = 0; i < size; i++)
     tmp |= (frame[from + i]) << (size - 1 - i);

   return tmp;
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-17T14:50:42.973

我猜您将以下行称为具有令人困惑的语法的行。

```
tmp |= (frame[from + i]) << (size - 1 - i); 
```

让我们分解一下

*   frame[from+i]: "from" 表示数组的初始索引，i 只是当前偏移量。所以这实际上是从索引“from”开始迭代数组
*   size - 1 - i：这是根据当前索引计算要移位的位数。这个数字将从 -1 开始，随着循环的进行而减小
*   (frame[from+i] << (size - 1 - i)：这会将 from+i 处的值移动指定的位数
*   tpm |= ... ：对迭代值移位后仍然可用的字节执行按位或表达式。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-17T15:02:39.870

其他人已经描述了每一行，所以我只添加函数的*作用*。您可以想象具有不同位置的“堆栈”上`frame`位置 ( `from`) 和 ( ) 之间的字节。`from+size`第一个字节将放在左边。

```
bits from:      tmp: |    +  +     |(LSB-side of tmp)
frame[from]:           ---+----
frame[from+1]:          -----+--
frame[from+2]:           -+------
... 
```

现在，如果“下面”的任何字节在相关位置设置了位，则 tmp 设置了位。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T16:39:18.827

看起来像一个位包装器。如果按照 Eric 的建议，所有字符`frame`都为零或一，那么这将获取`size`字符并将它们的值打包到`tmp`. 例如，如果`frame`(at offset `start`) 包含 values `00 01 00 00 01 01 01 00`，`protodec_henten(0,8,frame)`则将返回（省略前导零） 0x4E （或`01001110`二进制）。有更好的方法可以做到这一点，所以它可能会做其他事情，但很难说是什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T14:48:34.053

~~看起来像一个哈希函数。~~再三考虑，这会使散列函数变得很差。

他们将每一帧移动大小的剩余部分，然后将其与静态值进行或运算。然后返回该值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T14:48:35.800

我猜你不明白，`tmp |=`因为这可能是代码中唯一“难以”理解的部分。如果您尝试搜索 C 运算符，您会在[此处](http://en.wikipedia.org/wiki/Operators_in_C_and_C%2B%2B)找到一个列表，现在的意思是“按位或”，您可以[在此处](http://irc.essex.ac.uk/www.iota-six.co.uk/c/e4_bitwise_operators_and_or_xor.asp)`|=`阅读有关它们的更多信息。

所以这段代码真正做的是它需要一些输入，你告诉函数从哪里开始读取“缓冲区”/“帧”，然后按位或在“大小”参数所说的尽可能多的位置上执行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T15:05:21.610

`frame`由于按位或，这个函数只有在所有值都是 0 或 1时才有意义。

在这种情况下，它将从索引开始的`size`连续值（即位）放入单个. 最后一位（在索引处）将作为最低有效位插入。`frame``from``unsigned long``from+size-1`

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-04-17T16:20:58.713

整个代码只是将一系列数据复制到 tmp 变量中。事实上，它只是在艰难地做一个 memcpy。

为什么不直接做：memcpy(&tmp, frame+from, size)

# php - 用 PHP 创建一个社交网站

> ID：760669
> 
> 赞同：0
> 
> 时间：2009-04-17T14:44:02.927
> 
> 标签：php, wordpress, cakephp, codeigniter, buddypress

什么是最快的开源 PHP 社交网络框架，可以帮助我在 4 小时内获得工作原型？我正在寻找可以处理个人资料的东西，每个个人资料可以发布多个帖子，并且每个帖子都可以由社区评分？我在用 Wordpress MU 看 BuddyPress？这是可以实现的，还是我应该使用 CakePHP 或 CodeIgniter？有没有可以推荐的插件？非常感谢您的反馈。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-21T23:35:40.103

我看过两者，BuddyPress 似乎有更多现成的插件，因为它本身就是一个 wordpress 插件。在 db 方面，buddypress 似乎比 elgg 更容易开发。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-17T14:49:12.350

看看[Elgg——](http://www.elgg.org/)它似乎正是你想要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T14:53:40.860

[不是在 PHP 中，但如果您需要在如此短的期限内使用Django](http://www.djangoproject.com)和[Pinax](http://pinaxproject.com/) (Python) ，您可以免费获得一个社交网站。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T14:49:49.277

我认为，如果您正在考虑创建一个截止日期如此严格的网站，那么您最好尝试使用预构建的 CMS，例如 Joomla、Drupal 或其他许多 PHP 的。大多数（如果不是全部）都是开源的，这意味着您可以自己进行开发以扩展或修改功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-03T16:32:20.037

cakephp 或 elgg。

# list - Freemarker中的字符串列表

> ID：760673
> 
> 赞同：18
> 
> 时间：2009-04-17T14:44:55.247
> 
> 标签：list, freemarker

我在java代码中有一个字符串列表：

```
List<String> keywords = new ArrayList<String>();
keywords.add("Apple");
keywords.add("Banana"); 
```

我想使用 Freemarker 显示关键字：Apple、Banana

怎么做？

PS：我通读了手册，发现一些建议使用的文章`<#list>`，但输出是：Apple

香蕉

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-02-23T10:56:17.243

如果您想要一个逗号分隔的列表，您可以使用以下内容：

```
<#list seq as x>
   ${x_index + 1}. ${x}<#if x_has_next>,</#if>
</#list> 
```

见： http: [//freemarker.org/docs/ref_directive_list.html#pageTopTitle](http://freemarker.org/docs/ref_directive_list.html#pageTopTitle)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-10-01T07:52:15.077

从 Freemarker 的 2.3.20 版本开始，有[一个用于逗号分隔列表的内置命令](http://freemarker.org/docs/ref_builtins_sequence.html)。

例如，模板：

> <#assign colors = ["red", "green", "blue"]>
> 
> ${colors?join(", ")}

.. 将生成：

> 红、绿、蓝

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-02-18T06:04:22.143

从 2.3.23 版本开始，您还可以使用以下代码：

```
<#list users as user>
  <div>
    ${user}<#sep>, </#sep>
  </div>
</#list> 
```

取自[sep 指令](http://freemarker.incubator.apache.org/docs/ref_directive_list.html#autoid_96)。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-17T15:41:45.097

FreeMarker 会保留您的空间（和 EOL），但不会自行添加任何空间。因此，只需将所有内容放在同一行：

```
<#list myListName as item>${item}</#list> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-17T15:48:01.727

Freemarker 提供了一些空白控制功能，参见[http://freemarker.sourceforge.net/docs/dgui_misc_whitespace.html](http://freemarker.sourceforge.net/docs/dgui_misc_whitespace.html)

# vb.net - 为什么 VB.net 类中的可为空的公共属性不接受 0（零）作为赋值？

> ID：760675
> 
> 赞同：3
> 
> 时间：2009-04-17T14:44:59.040
> 
> 标签：vb.net, nullable

我在使用 Vb.net 3.5 的类上有一个可为空的公共属性：

```
 Public Property TicketCharge() As Nullable(Of Decimal)
        Get
            If _TicketCharge = Nothing Then
                Return Nothing
            Else
                Return _TicketCharge
            End If
        End Get
        Set(ByVal value As Nullable(Of Decimal))
            If value.HasValue Then _TicketCharge = value
        End Set
    End Property 
```

有一种分配值的方法。它工作正常，除非我尝试将值 0（零）分配给它。

```
 If FundBuySell = "Exchange $" Or FundBuySell = "Exchange Shares" Then
            TicketCharge = 0
    Else 
```

当我分配零然后检索它时，它显示属性 = 无。

我需要属性有时为空，有时为零。有人可以解释发生了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T14:48:30.123

没有按照`If _TicketCharge = Nothing`您的预期进行（煽动性评论：VB.NET 总是如此；对不起，伙计们，无法抗拒）。你要么需要`If _TicketCharge Is Nothing`要么`If Not _TicketCharge.HasValue`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T14:53:30.080

进一步解释：

在 VB.Net 中，没有什么可以作为引用类型的“空”值和值类型的“默认”值来实现双重职责。当您使用“=”而不是“Is”或“HasValue”时，您将其强制为值类型角色，因此 Nullable 类会将其与其当前存储的值进行比较（包括如果没有值则抛出异常放！）。由于 Decimal 的默认值为 0，因此访问器顶部的比较结果`Get`为 True。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T14:54:48.313

问题在于您比较 _TicketChange 以确定它是否具有值的方式。Nothing 在 VB.Net 中具有多种含义，因为它既代表空值又代表引用类型。使用 Nothing 和 Nullable 执行布尔逻辑通常会导致意外行为。

而是使用 _TicketChange.HasValue。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-03-01T22:00:56.513

最后这工作：

```
If Not IsDBNull(var) 
```

# html - 如何将播放器嵌入网页？

> ID：760683
> 
> 赞同：1
> 
> 时间：2009-04-17T14:46:43.917
> 
> 标签：html, browser

我想在网页中嵌入 MPC 播放器，有示例吗？

我的意思是 MPC 播放器 => [http://sourceforge.net/projects/guliverkli/](http://sourceforge.net/projects/guliverkli/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T14:49:14.410

这里有一些小部件..

[http://www.ohloh.net/p/mpc-hc/widgets](http://www.ohloh.net/p/mpc-hc/widgets)

这些是你要找的吗？

试试这个代码：

```
<OBJECT id="VIDEO" width="320" height="240" 
style="position:absolute; left:0;top:0;"
CLASSID="CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6"
type="application/x-oleobject">

<PARAM NAME="URL" VALUE="your file or url">
<PARAM NAME="SendPlayStateChangeEvents" VALUE="True">
<PARAM NAME="AutoStart" VALUE="True">
<PARAM name="uiMode" value="none">
<PARAM name="PlayCount" value="9999">
</OBJECT> 
```

# python - 在 lambda 表达式中使用变量的值

> ID：760688
> 
> 赞同：5
> 
> 时间：2009-04-17T14:47:48.843
> 
> 标签：python, lambda

```
a = [] a.append(lambda x:x**0) 
a.append(lambda x:x**1)

a[0](2), a[1](2), a[2](2)... spits out 1, 2, 4, ...

b=[]
for i in range(4)
    b.append(lambda x:x**i)

b[0](2), b[1](2), b[2](2)... spits out 8, 8, 8, ... 
```

在 for 循环中，i 作为变量传递给 lambda，因此当我调用它时，将使用 i 的最后一个值，而不是使用 a[] 运行的代码。（即 b[0] 应该使用 x^1，b[1] 应该使用 x^2，...）

我如何告诉 lambda 获取 i 的值而不是变量 i 本身。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-17T14:56:57.857

丑陋，但一种方式：

```
for i in range(4)
    b.append(lambda x, copy=i: x**copy) 
```

你可能更喜欢

```
def raiser(power):
    return lambda x: x**power

for i in range(4)
    b.append(raiser(i)) 
```

（所有代码未经测试。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-17T15:26:41.340

定义工厂

```
def power_function_factory(value):
    def new_power_function(base):
        return base ** value
    return new_power_function

b = []
for i in range(4):
    b.append(power_function_factory(i)) 
```

或者

```
b = [power_function_factory(i) for i in range(4)] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T15:00:27.737

```
b=[]
f=(lambda p:(lambda x:x**p))
for i in range(4):
   b.append(f(i))
for g in b:
   print g(2) 
```

# sql-server - 如何防止我的 SQL Server Express 连接在第一次通过测试时超时？

> ID：760691
> 
> 赞同：0
> 
> 时间：2009-04-17T14:48:09.687
> 
> 标签：sql-server, sql-server-express

我们对数据访问层 (C#) 和数据库 (MS SQL) 之间的交互进行了一些自动化测试。我们正在使用 SQL Express 挂载一个 mdf，在测试完成后我们将其还原。似乎第一次在新启动的机器上运行测试时，我们会看到超时，即使 SQLExpress 正在运行。第二次，他们运行得很好。

查询字符串示例：

```
Data Source=.\SQLEXPRESS; AttachDbFilename=|DataDirectory|\TEST_DATA.mdf; Integrated Security=True; User Instance=True 
```

示例错误：

```
 [nunit2] 1) Test : System.Data.SqlClient.SqlException : Timeout expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.
   [nunit2]    at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   [nunit2]    at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj)
   [nunit2]    at System.Data.SqlClient.TdsParserStateObject.ReadSniError(TdsParserStateObject stateObj, UInt32 error)
   [nunit2]    at System.Data.SqlClient.TdsParserStateObject.ReadSni(DbAsyncResult asyncResult, TdsParserStateObject stateObj)
   [nunit2]    at System.Data.SqlClient.TdsParserStateObject.ReadPacket(Int32 bytesExpected)
   [nunit2]    at System.Data.SqlClient.TdsParserStateObject.ReadBuffer()
   [nunit2]    at System.Data.SqlClient.TdsParserStateObject.ReadByte()
   [nunit2]    at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   [nunit2]    at System.Data.SqlClient.SqlInternalConnectionTds.CompleteLogin(Boolean enlistOK)
   [nunit2]    at System.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, Boolean ignoreSniOpenTimeout, Int64 timerExpire, SqlConnection owningObject)
   [nunit2]    at System.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(String host, String newPassword, Boolean redirectedUserInstance, SqlConnection owningObject, SqlConnectionString connectionOptions, Int64 timerStart)
   [nunit2]    at System.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(SqlConnection owningObject, SqlConnectionString connectionOptions, String newPassword, Boolean redirectedUserInstance)
   [nunit2]    at System.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, Object providerInfo, String newPassword, SqlConnection owningObject, Boolean redirectedUserInstance)
   [nunit2]    at System.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection)
   [nunit2]    at System.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnection owningConnection, DbConnectionPool pool, DbConnectionOptions options)
   [nunit2]    at System.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject)
   [nunit2]    at System.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject)
   [nunit2]    at System.Data.ProviderBase.DbConnectionPool.GetConnection(DbConnection owningObject)
   [nunit2]    at System.Data.ProviderBase.DbConnectionFactory.GetConnection(DbConnection owningConnection)
   [nunit2]    at System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory)
   [nunit2]    at System.Data.SqlClient.SqlConnection.Open()
   [nunit2]    at Test() 
```

有没有人经历过这个？你找到解决方法了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T15:08:43.427

当您第一次点击它或设置自动关闭并且当您第一次点击它时它必须由引擎打开时，数据库可能仍在恢复。通过执行以下命令检查此设置，将 msdb 更改为您的数据库名称，如果返回 1，则您将其设置为自动关闭

```
SELECT DATABASEPROPERTYEX( 'msdb' , 'IsAutoClose' ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-24T17:31:27.663

看起来这个问题除了增加连接超时或只是重试之外没有太多的解决方案。这只是服务器在新系统上启动数据库的成本。在我的测试中，它在重新启动后发生，但停止和启动 SQL 服务不会导致问题。 [EE 上的这个线程](http://www.experts-exchange.com/Microsoft/Development/MS-SQL-Server/SQL-Server-2005/Q_24087313.html)提出了类似的问题。

# silverlight - silverlight 访问文件路径

> ID：760701
> 
> 赞同：3
> 
> 时间：2009-04-17T14:49:57.187
> 
> 标签：silverlight, file, path

我有一个 Silverlight 应用程序，我**需要**一种方法来找出选定文件的**物理路径**。

**注意：**我知道客户端禁止获取路径的安全限制。

我想到了一个解决方案，但我不确定它是否有效：silverlight 应用程序与允许执行受限操作的 ActiveX 组件一起在页面中运行。Silverlight 应用程序要求 ActiveX 组件执行特权操作并返回路径。

这是一个有效的场景还是有更简单的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T14:53:09.847

您可以使用通用文件打开对话框，让用户告诉您文件在哪里。这将是安全的方法，不会损害用户的系统。

如果您在 Full-Trust 中运行，您可能会得到它……查看这篇[文章](http://www.ddj.com/security/206902613?pgno=3)，它可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T18:52:12.063

现在你评论的方式是我听说做“禁止的事情”的方式（例如将信息发送到银行信息亭中的打印机）。

如果您对从 SL 调用它有限制，则要调用 ActiveX，您可以从 javascript 方法调用它（利用调用 javascript 的 SL 功能，反之，js 回调 SL 方法）。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-06-27T06:59:40.233

由于某些安全原因，您无法在本地文件系统中获取文件的真实路径。只能获取文件名，文件路径是私有字段，无法访问。我不知道是否有办法通过分析其流来获取文件的全部信息，据我所知，您可以通过 OpenFileDialog 获取文件的流

# asp.net-mvc - 一直收到“找不到资源”，直到我编辑控制器

> ID：760708
> 
> 赞同：1
> 
> 时间：2009-04-17T14:51:29.133
> 
> 标签：asp.net-mvc

如果我在未先更改其中一个控制器的情况下启动应用程序，我的 ASP.NET MVC 项目将返回“找不到资源”。

如果我去控制器并添加一个空格，它就可以正常工作。如果我然后转到一个视图，添加一个空格，然后再次按 Ctrl-F5，我会再次收到错误消息。这是怎么回事？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T14:54:48.797

当我按下 Ctrl-F5 时，我看到了这一点，因为 VS2008 使用的 URL 不是“正确”的路由。我最终做的是将我的项目设置为在启动时始终通过属性页面转到特定路线。

# unit-testing - 单元测试期间的 nHibernate 输出 sql 日志记录

> ID：760712
> 
> 赞同：4
> 
> 时间：2009-04-17T14:52:19.647
> 
> 标签：unit-testing, nhibernate, logging

我正在 VS2008 内部针对 nHibernate 应用程序运行单元测试，并希望在单元测试期间打开日志记录，以便我可以看到更多正在发生的事情。我已经复制并粘贴了另一个应用程序的 app.config，它成功地将 nhibernate 信息记录到单元测试 app.config 中，但仍然没有得到任何输出。

这是我的测试项目的 app.config：

```
<log4net>
    <appender name="NHibernateFileLog" type="log4net.Appender.RollingFileAppender">
      <file value="Logs/nhibernate.txt" />
      <appendToFile value="true" />
      <rollingStyle value="Size" />
      <maxSizeRollBackups value="10" />
      <maximumFileSize value="100KB" />
      <staticLogFileName value="true" />
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%d{HH:mm:ss.fff} [%t] %-5p %c - %m%n"  />
      </layout>
    </appender>

    <appender name="GeneralLog" type="log4net.Appender.RollingFileAppender">
      <file value="Logs/general.txt" />
      <appendToFile value="true" />
      <maximumFileSize value="100KB" />
      <rollingStyle value="Size" />
      <maxSizeRollBackups value="5" />
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%d{HH:mm:ss.fff} [%t] %-5p %c - %m%n"  />
      </layout>
    </appender>
    <appender name="DataLog" type="log4net.Appender.RollingFileAppender">
      <file value="Logs/data.txt" />
      <appendToFile value="true" />
      <maximumFileSize value="100KB" />
      <rollingStyle value="Size" />
      <maxSizeRollBackups value="5" />
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%d{HH:mm:ss.fff} [%t] %-5p %c - %m%n"  />
      </layout>
    </appender>

    <!-- levels: DEBUG, INFO, WARN, ERROR, FATAL -->

    <root>
      <level value="DEBUG"/>
      <appender-ref ref="GeneralLog" />
    </root>

    <logger name="NHibernate" additivity="false">
      <level value="DEBUG"/>
      <appender-ref ref="NHibernateFileLog"/>
    </logger>
    <logger name="Pushable.Data" additivity="false">
      <level value="DEBUG"/>
      <appender-ref ref="DataLog"/>
    </logger>
</log4net> 
```

当我运行测试项目时，log4net 的任何地方都没有创建任何输出。运行 log4net 的应用程序是否必须是 web 或 windows 而不是测试应用程序？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-24T18:55:08.307

在 Test 初始化器中，需要有一个调用：

```
log4net.Config.XmlConfigurator.Configure(); 
```

这将启用日志记录就好了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T15:19:54.603

如果您只想查看所有触发的 sql 语句，请在 Nhiberante 配置部分中将 show_sql 属性设置为 true，

例如

```
<hibernate-configuration xmlns="urn:nhibernate-configuration-2.2">
<property name="show_sql">true</property>
</hibernate-configuration> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T15:25:16.273

在 DEBUG 中使用 log4net 将为您提供 NHibernate 必须告诉您的所有信息。

如果您只想查看 SQL 输出，show_sql 是一个不错的选择

[配置 Log4Net 以与 NHibernate 一起使用](http://nhforge.org/wikis/howtonh/configure-log4net-for-use-with-nhibernate.aspx)

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
<configSections>
<!-- Others sections -->
<section name="log4net"
type="log4net.Config.Log4NetConfigurationSectionHandler,log4net" />
</configSections>

<!-- Some others configurations -->

<!-- This section contains the log4net configuration settings -->
<log4net debug="false">

<appender name="console"
type="log4net.Appender.ConsoleAppender, log4net">
<layout type="log4net.Layout.PatternLayout,log4net">
<param name="ConversionPattern"
value="%d{ABSOLUTE} %-5p %c{1}:%L - %m%n" />
</layout>
</appender>

<!-- Setup the root category, add the appenders and set the default priority -->
<root>
<priority value="DEBUG" />
<appender-ref ref="console" />
</root>

</log4net>
</configuration> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-21T07:05:27.860

如果您的代码正在登录生产但不在测试中，请查看测试目录。测试在为每个测试运行创建的“testresults”子目录中运行。您的配置文件肯定不存在。

所有需要安装到测试目录的东西都需要声明。添加一个 [DeploymentItem("myfile")] 到使用它的测试类，或者去测试 -> 编辑测试运行配置 -> 本地测试运行。然后转到“部署”并添加配置文件。

# graph - 使用graphviz绘制格子时如何将y位置强加在节点上？

> ID：760714
> 
> 赞同：6
> 
> 时间：2009-04-17T14:52:46.023
> 
> 标签：graph, visualization, graphviz

我正在使用 Graphviz 绘制格子。
节点是一组数字。

作为一个格子，我希望节点的高度位置（y）表示该节点表示的集合中的元素数。然后 x 位置应由 graphviz 定义，以使表示更清晰。

是否可以？

根据 dot 文档，应该有属性 pos 应该定义节点的位置。但是，尽管我以许多不同的方式尝试了很多次，但我无法获得任何定义节点位置的图表。有人在这方面取得了成功吗？

以下是我使用的经典点文件：

```
digraph G {
"528 544\n640 768" -> "768 528"; 
"528 536\n530 539" -> "539"; 
"528 536\n530 539" -> "528"; 
"800 896 548\n944 566 728\n539 704 768" -> "704 768\n539 548"; 
"800 896 548\n944 566 728\n539 704 768" -> "944 728\n539 566"; 
"800 896 548\n944 566 728\n539 704 768" -> "944 800\n896 768"; 
"768 539" -> "768"; 
"768 539" -> "539"; 
"768" -> "∅"; 
"944" -> "∅"; 
"944 528 536\n530 566 560\n728 656 539" -> "528 536\n530 539"; 
"944 528 536\n530 566 560\n728 656 539" -> "944 728\n539 566"; 
"944 528 536\n530 566 560\n728 656 539" -> "944 656\n528 560"; 
"704 768\n539 548" -> "768 539"; 
"944 728\n539 566" -> "944"; 
"944 728\n539 566" -> "539"; 
"800 896 640\n944 560 528\n544 656 768" -> "528 544\n640 768"; 
"800 896 640\n944 560 528\n544 656 768" -> "944 656\n528 560"; 
"800 896 640\n944 560 528\n544 656 768" -> "944 800\n896 768"; 
"539" -> "∅"; 
"944 656\n528 560" -> "944"; 
"944 656\n528 560" -> "528"; 
"896 640 656 536\n530 728 539 704\n768 800 544 528\n548 944 566 560" -> "800 896 548\n944 566 728\n539 704 768"; 
"896 640 656 536\n530 728 539 704\n768 800 544 528\n548 944 566 560" -> "944 528 536\n530 566 560\n728 656 539"; 
"896 640 656 536\n530 728 539 704\n768 800 544 528\n548 944 566 560" -> "800 896 640\n944 560 528\n544 656 768"; 
"896 640 656 536\n530 728 539 704\n768 800 544 528\n548 944 566 560" -> "768 704 548\n528 530 544\n536 640 539"; 
"768 528" -> "768"; 
"768 528" -> "528"; 
"528" -> "∅"; 
"768 704 548\n528 530 544\n536 640 539" -> "528 544\n640 768"; 
"768 704 548\n528 530 544\n536 640 539" -> "704 768\n539 548"; 
"768 704 548\n528 530 544\n536 640 539" -> "768 528 530\n539 536"; 
"944 800\n896 768" -> "768"; 
"944 800\n896 768" -> "944"; 
"768 528 530\n539 536" -> "528 536\n530 539"; 
"768 528 530\n539 536" -> "768 539"; 
"768 528 530\n539 536" -> "768 528"; 
} 
```

如果有人可以编写一个定义一个节点高度的文件示例，我将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-17T17:11:54.943

我找到了答案。

这里： [http ://www.linuxdevcenter.com/pub/a/linux/2004/05/06/graphviz_dot.html?page=2](http://www.linuxdevcenter.com/pub/a/linux/2004/05/06/graphviz_dot.html?page=2)

本质上，可以定义哪些节点集应该处于相同的高度。为了让节点 A 和 B 处于相同的高度，我需要添加以下行： {rank=same; 乙};

因此，这里有一个与之前类似的示例，但节点设置正确：

```
digraph G {
{rank=same;  "768"  "944"  "539"  "528" };
{rank=same;  "768 539"  "768 528" };
{rank=same;  "768 640\n528 544"  "528 536\n530 539"  "768 704\n539 548"  "944 728\n539 566"  "944 656\n528 560"  "944 800\n896 768" };
{rank=same;  "800 896 548\n944 566 728\n539 704 768"  "528 944 536\n530 566 560\n728 656 539"  "800 896 944\n656 560 528\n544 640 768"  "768 640 548\n528 530 544\n536 539 704" };
"768 640\n528 544" -> "768 528"; 
"528 536\n530 539" -> "539"; 
"528 536\n530 539" -> "528"; 
"800 896 548\n944 566 728\n539 704 768" -> "768 704\n539 548"; 
"800 896 548\n944 566 728\n539 704 768" -> "944 728\n539 566"; 
"800 896 548\n944 566 728\n539 704 768" -> "944 800\n896 768"; 
"768 539" -> "768"; 
"768 539" -> "539"; 
"768" -> "∅"; 
"944" -> "∅"; 
"528 944 536\n530 566 560\n728 656 539" -> "528 536\n530 539"; 
"528 944 536\n530 566 560\n728 656 539" -> "944 728\n539 566"; 
"528 944 536\n530 566 560\n728 656 539" -> "944 656\n528 560"; 
"768 704\n539 548" -> "768 539"; 
"944 728\n539 566" -> "944"; 
"944 728\n539 566" -> "539"; 
"800 896 944\n656 560 528\n544 640 768" -> "768 640\n528 544"; 
"800 896 944\n656 560 528\n544 640 768" -> "944 656\n528 560"; 
"800 896 944\n656 560 528\n544 640 768" -> "944 800\n896 768"; 
"539" -> "∅"; 
"944 656\n528 560" -> "944"; 
"944 656\n528 560" -> "528"; 
"896 640 656 536\n530 728 539 704\n768 800 544 528\n548 944 566 560" -> "800 896 548\n944 566 728\n539 704 768"; 
"896 640 656 536\n530 728 539 704\n768 800 544 528\n548 944 566 560" -> "528 944 536\n530 566 560\n728 656 539"; 
"896 640 656 536\n530 728 539 704\n768 800 544 528\n548 944 566 560" -> "800 896 944\n656 560 528\n544 640 768"; 
"896 640 656 536\n530 728 539 704\n768 800 544 528\n548 944 566 560" -> "768 640 548\n528 530 544\n536 539 704"; 
"768 528" -> "768"; 
"768 528" -> "528"; 
"528" -> "∅"; 
"768 640 548\n528 530 544\n536 539 704" -> "768 640\n528 544"; 
"768 640 548\n528 530 544\n536 539 704" -> "768 704\n539 548"; 
"768 640 548\n528 530 544\n536 539 704" -> "528 768 530\n539 536"; 
"944 800\n896 768" -> "768"; 
"944 800\n896 768" -> "944"; 
"528 768 530\n539 536" -> "528 536\n530 539"; 
"528 768 530\n539 536" -> "768 539"; 
"528 768 530\n539 536" -> "768 528"; 
} 
```

# cocoa - 即使光标移出影片后仍继续跟踪鼠标拖动事件

> ID：760717
> 
> 赞同：1
> 
> 时间：2009-04-17T14:53:09.893
> 
> 标签：cocoa

我在父视图的网格中对齐的视图很少（都是 NSView 的）

我正在覆盖 -(void)mouseDown:(NSEvent *)event - (void)mouseDragged:(NSEvent *)theEvent 用于子视图子类中的一些自定义绘图

具体来说，我在子视图中的鼠标拖动过程中绘制了一些矩形框。

问题：当光标移出子视图时（在鼠标拖动期间），显然，我无法跟踪事件，因此我无法调整矩形的大小。我想甚至在应用程序窗口之外跟踪鼠标移动......（现在只是拖动事件）

有什么明显或复杂的方法可以实现这一点......

提前致谢

拉杰什

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2018-01-31T17:12:32.297

我想提出一个不涉及在 while 循环中拦截事件的已接受答案的替代方案。

处理鼠标拖动事件：

```
- (void)mouseDragged:(NSEvent *)theEvent
{
} 
```

如果您在 NSView 内开始拖动，这将触发，如果您将鼠标拖到外部，它将继续触发。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-18T06:13:13.317

```
- (void)mouseDown:(NSEvent *)theEvent
{
    NSPoint point;
    while (1) {
        theEvent = [[self window] nextEventMatchingMask: (NSLeftMouseDraggedMask | NSLeftMouseUpMask)];
        point = [self convertPoint: [theEvent locationInWindow] fromView: nil];

        // do something with point

        if ([theEvent type] == NSLeftMouseUp)
            break;
    }
} 
```

# database - 什么是高可用性授权服务的正确解决方案？

> ID：760727
> 
> 赞同：3
> 
> 时间：2009-04-17T14:55:17.390
> 
> 标签：database, performance, batch-processing, high-availability

我在一家软件商店工作，该商店有一个内部预测拨号器产品，我们需要实施一个解决方案来遵守 DO-NOT-CALL 列表。

基本上，我有一个包含我需要拨打的客户/潜在客户的数据库，以及另一个包含我无法拨打的电话号码的数据库。由于该系统是一个预测拨号器，根据操作性能、时间平均值等，它会为每个登录的系统用户拨打或多或少的电话。通常这个“神奇”数字是每个登录的代理大约 3 到 4 个呼叫。

预测拨号器的电话号码存储库是一个 PostgreSQL 数据库。预测拨号器从数据库中挑选一堆号码，然后向 pbx 发送一个命令来拨号，然后业务逻辑继续将有效呼叫转移到呼叫中心文员等（这与我的无关问题是在通话之前）。

我需要实现请勿呼叫列表功能。政府机构将每天以 CSV 文件的形式向我们公司提供此拒绝来电清单。每次我收到一个新的 CSV 文件时，我都必须清除旧的请勿呼叫列表，并将新的放在适当的位置。

我实现它的第一个想法是进行批处理，将 DO NOT CALL LIST 与我当前的客户数据库进行交叉引用。但我认为，根据两个数据库的大小，交叉引用会非常耗费性能，有时无法在一夜之间完成。我以前在批处理时遇到过这种问题，这不是一件好事。

当我想到大型机构如何处理高性能和高吞吐量的授权系统（例如信用卡或用户身份验证/授权）时，我的第二个想法出现了。我认为为 DO NOT CALL LIST 号码创建身份验证服务，并更改我的预测拨号器的算法以在拨号之前根据此授权服务检查每个号码会很整洁。

由于我只是在这里胡说八道，我不知道哪个想法是最好的，或者我是否完全错了，应该转向另一个方向。所以，我的问题是：你的建议是什么？将 DO NOT CALL CSV 文件存储在内存中？使用 LDAP？使用 MySQL？PostgreSQL？做批处理的事情吗？还是我绝对搞砸了？

我知道我不是世界上第一个遇到这种问题的人，所以请赐教。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T20:17:20.987

您的挑战是从大量可能的条目中查找多个条目，这让我想起了[DNS 黑/黑名单](http://en.wikipedia.org/wiki/DNSBL)。

> [rbldnsd](http://www.corpit.ru/mjt/rbldnsd.html)是一个小而快的 DNS 守护程序，专门用于服务 DNSBL 区域。这个守护进程的灵感来自于 djbdns 包中的 Dan J. Bernstein 的 rbldns 程序。[更多 rbldnsd，来自 Google](http://google.com/search?q=rbldnsd)

它支持基于名称的区域，因此您可以将数字列表转换为 ENUM 样式的 URI - 例如 +1-555-4242 变为 2.4.2.4.5.5.5.1.e164.arpa。然后将其输入 rbldnsd 数据文件，编译到内存中并像任何其他阻止列表一样访问。默认条目意味着可以调用，或者如果该条目存在，则将给予它一个 DoNotCall 条目。

不过，您仍然遇到批量转换问题，尽管它会是一个稍微简单的脚本，很可能与 Perl 或 AWK 一起使用。您还可以将传入的 CSV 文件拆分为多个文件以进行并行处理和最终合并。

# asp.net - 首次加载时删除 ASP.NET 查询字符串

> ID：760733
> 
> 赞同：2
> 
> 时间：2009-04-17T14:57:06.497
> 
> 标签：asp.net, query-string

我在使用 asp.net 时遇到了一个令人沮丧的问题。

1.  打开一个新的浏览器（清除历史记录、临时文件等...）
2.  加载 www.mysite.com/page.aspx?anystring=1234
3.  该页面将加载为 www.mysite.com/page.aspx。查询字符串将消失。某些东西重定向并删除了它。

**但：**

1.  打开一个新的浏览器（清除历史记录、临时文件等...）
2.  加载 www.mysite.com 上的任何页面。
3.  加载 www.mysite.com/page.aspx?anystring=1234
4.  查询字符串被保留，page.aspx?anystring=1234 加载正确的值。

如果 www.mysite.com/page.aspx?anystring=1234 是用户尝试打开的第一个页面，则查询字符串会通过看起来像重定向的方式删除。页面上的代码或后面的代码都没有关系。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T15:20:10.263

ASP.Net 中基于 Cookie 的会话管理将写入一个 cookie 并重定向以查看它是否获得了一个 cookie。我以前没有经历过这种吃 URL 参数的情况，但这是在第一页视图上进行重定向的一件事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T15:53:29.997

您可以尝试几件事：

您可以使用诸如[ieHttpHeaders](http://www.blunck.se/iehttpheaders/iehttpheaders.html) for IE 或 Firebug for FireFox 之类的实用程序来观察 HTTP 流量以了解发生了什么。通过这种方式，您将能够查看请求中发送的参数，并查看浏览器是否以意想不到的方式被重定向。

您可能还希望在相同的虚拟目录下创建一个测试页面，该目录仅显示参数的值并查看是否有效，这会将其缩小为 page.aspx 中的配置问题或编码问题。

# jquery - 使用 jQuery > 选择器的问题

> ID：760734
> 
> 赞同：0
> 
> 时间：2009-04-17T14:57:12.177
> 
> 标签：jquery, css-selectors

我有类似下面的 jQuery 代码

```
buttons =
document.createElement('div');      
$(buttons).addClass("overlay_buttons").css({
           styles });

save =
document.createElement('input');
$(save).attr({  type: "button",
    value: "Save" 
}).css({width:'45%'});

undo =
document.createElement('input');
$(undo).attr({  type: "button",
    value: "Start again" 
}).css({width:'93%'});

//add elements to document
$(buttons).append(undo);
$(buttons).append(save); 
$(buttons +'> input').css({
       shared styles for buttons 
}); 
```

我遇到的问题是按钮的共享样式不适用。我没有收到错误消息。我也尝试使用其他 jQuery 方法来检查问题不是 css，但没有任何适用于 $(buttons +'> input') 的工作。

有谁知道为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-17T15:01:52.383

你的问题在这里：

```
$(buttons +'> input').css({
   shared styles for buttons 
}); 
```

`buttons`此时不是一个字符串，而是一个 DOM 元素对象。因此，当您尝试将此对象附加到字符串时，`> input`您的选择器最终会变成“[object HTMLDivElement] > input”之类的东西，这显然是不正确的。

这*应该可以*工作，因为根据[`children()`](http://docs.jquery.com/Traversing/children#expr)文档它只选择直接子代，复制`>`选择器的行为：

```
$(buttons).children('input').css({
   shared styles for buttons 
}); 
```

或者，如果没有，它应该，那么你可以试试这个，虽然我感觉不太好：

```
$('> input', buttons).css({
   shared styles for buttons 
}); 
```

另外，我不确定您为什么要单独使用`createElement`. jQuery 支持动态创建 DOM[元素](http://docs.jquery.com/Core/jQuery#htmlownerDocument)。使用它，您可以缩短它：

```
undo =
document.createElement('input');
$(undo).attr({  type: "button",
    value: "Start again" 
}).css({width:'93%'}); 
```

对此：

```
$('<input>').attr({  type: "button",
    value: "Start again" 
}).css({width:'93%'}); 
```

# delphi - Delphi：透明控件在上网本上变得不透明

> ID：760739
> 
> 赞同：4
> 
> 时间：2009-04-17T14:57:58.867
> 
> 标签：delphi, vcl

出于某种原因，表单上的透明控件在某些计算机上变得不透明。我在“Acer Netbook”和“Thinkpad x600”上收到了有关它的报告。该应用程序是使用 Delphi 2007 构建的。

这是它的样子： [链接](http://www.cleverbyte.com/updump/81feb63c514fe314e919296b3899ce1a/ss.jpg)

虽然它应该看起来像这样： [链接](http://dump.thecybershadow.net/786570d0d9dcdbd3ff3385d4f0355a6b/000002F9.png)

窗体上的不透明控件是 TLabels 和 TStaticTexts。

（我使用 TStaticText 控件来定义可点击区域，因为无句柄控件（如标签）的鼠标消息转到 WM_NCHITTEST 处理程序。底部的“按钮”是黑色的，因为我不小心将其颜色设置为 clNone，尽管它不应该完全可见。）

为什么会发生这种情况以及如何防止这种情况（除了将文本渲染到背景图像等变通方法）？

编辑：我设法在我的笔记本电脑上重现了这个问题，它运行的是 32 位颜色的 Windows XP，并使用经过认证的 ATI 驱动程序。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-17T18:41:51.590

TLabel 和表单之间有 TImage 吗？如果是这种情况，则将表单的颜色设置为黑色。当您将 TLabel 设置为透明时，它会将其绘制在其父级上，并且 TImage 不能有子控件。实际上，它是将表单的颜色渲染到标签上，因为表单是父表单。

另外两种可能的解决方法包括将图像直接绘制到表单上（不使用 TLabel），但我不知道这是否可行。另一种方法是创建您自己的图像控件，该控件源自 TWinControl（而不是 TGraphicControl）并且可以包含子控件。YMMV 关于这些解决方案。

我怀疑它在某些机器上不起作用的原因是底层的 Windows API 库不同。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-17T15:34:46.440

这与系统本身的品牌无关。按照可能性的顺序，检查这些（假设您正在谈论 Windows 系统）：

*   透明度要求显示位深度为 32。如果显示设置为 16 位颜色，则无法绘制透明控件。用户可修复，您不应自动切换模式。

*   视频驱动程序问题 - 确保用户拥有制造商推荐的视频驱动程序。如果这些都失败了，请尝试最新的。

*   透明度（实际上是 alpha 混合）仅在 Windows 2000 或更高版本上受支持 - 您确定它们没有运行旧版本吗？

如果您从用户那里获得更多数据（或者如果您有这些数据，请发布它），这将很有帮助。因为您甚至没有提及使用的操作系统，所以我们在这里盲目拍摄。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-06-29T03:50:43.280

如果上面有`TForm`with`TImage`和`TLabel`- 透明度存在问题，有时即使`TLabel.Transparent`属性显示为，标签也不透明`True`。

我已经使用 VMWare 和 Windows XP / Windows 7 重现了这个问题。为了实现它，我必须启用“Windows Classic”主题。Windows 7 具有 Windows Aero 主题、Windows Basic 和 Windows Classic 主题。仅当启用“Windows 经典”主题时才会出现问题。（Windows XP 也有这个主题）。

`TLabel`已经有`Transparent`属性，它是`True`默认的。并且标签是透明的，除非启用“Windows 经典”主题。当您在表单上放置新标签时 - 它的`Transparent`属性显示为`True`，但在 Object Inspector中未显示为**粗体。**要解决透明度问题，您只需切换标签的`Transparent`属性：首先将其设置为`False`，然后再设置为`True`. 这将使标签的`Transparent`属性显示为`True`，但值将是**粗体**。或者只是编辑`.dfm`文件并添加`Transparent = True`到所有需要透明度的标签。

这个问题对于 Delphi 10.2 Tokyo 是实际的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T20:37:03.933

虽然不是一个完美的解决方案，但在处理透明度问题方面会更好，那就是根本不使用透明度，将标签背景颜色设置为与背景颜色匹配，然后使用与边距属性对齐并设置边距以定位表格上的标签。对于下一个，关闭和最小化按钮，我会制作这些单独的图形以避免任何字体或 DPI 问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-21T15:32:38.723

我遇到了这个问题，这让我发疯了。

我的应用程序使用 TLabels 而不是 TButtons。在运行时，我创建 TShapes，大小适合标签。我设置了 OnMouseEnter 和 OnMouseLeave 事件来更改 TShape 的颜色。它在我测试的每台机器上都运行良好，直到我安装了一个遇到 OP 问题的特定 XP 安装。

我终于找到了一个有效的解决方案。

```
 for i := 0 to frm.ComponentCount-1 do begin
  if (frm.Components[i] is TLabel) and
     (((TLabel(frm.Components[i]).Tag > 999) and
     (Length(TLabel(frm.Components[i]).Caption) > 1) and (Assigned(TLabel(frm.Components[i]).OnClick))) or
     (TLabel(frm.Components[i]).Caption = 'Close')) then
    begin
      //setting this to false here, then to true at the bottom eliminates the "opaquing" problem
      TLabel(frm.Components[i]).Transparent := False;

      ls := TShape.Create(frm);
      ls.Name := 'ClickLabel' + IntToStr(i) + TWinControl(frm.Components[i]).Name;
      ls.Parent := TWinControl(frm.Components[i]).Parent;
      ls.Hint := TWinControl(frm.Components[i]).Hint;
      ls.ShowHint := True;
      ls.Top := TWinControl(frm.Components[i]).Top-4;
      ls.Left := TWinControl(frm.Components[i]).Left-7;
      ls.Width := TWinControl(frm.Components[i]).Width + 12;
      ls.Height := TWinControl(frm.Components[i]).Height + 8;
      ls.Shape := stRoundRect;   
      ls.BringToFront;
      TWinControl(frm.Components[i]).BringToFront;
      ls.Visible := TWinControl(frm.Components[i]).Visible;
      ls.Tag := TWinControl(frm.Components[i]).Tag;

      ls.OnMouseEnter := EvHandler.lblNavMouseEnter;
      ls.OnMouseLeave := EvHandler.lblNavMouseLeave;
      ls.Anchors := TLabel(frm.Components[i]).Anchors;

      ls.Pen.Width := 2;

      TLabel(frm.Components[i]).Transparent := True;
    end;
end; 
```

# java - 为什么此代码编译并成功运行，它似乎应该使索引越界

> ID：760740
> 
> 赞同：2
> 
> 时间：2009-04-17T14:57:59.677
> 
> 标签：java, arrays, exception

我正在阅读我正在处理的项目中的一些 java 代码，并提出了一个具有这种效果的方法。

```
Object[] objs = null;
objs[0] = str1;
objs[1] = obj1;
for(String str: strArray)
{
    objs[objs.length+1] = str;
} 
```

我无法弄清楚这里发生了什么。我希望有人可以向我解释这段代码是如何工作的，最好是在高级别和幕后低级别。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-17T15:00:14.307

那不应该运行。objs[0] 会报错。

您确定您运行的是正确版本的文件吗？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-17T15:03:44.827

这没有希望在 Java 中工作。我怀疑“有这种效果的东西”与真正的代码有细微的不同，如果它似乎工作的话。几个问题：

*   `NullPointerException`当您尝试取消引用变量时，它显然应该在第二行抛出
*   `objs[objs.length+1]`不扩展数组，这似乎是意图 - 数组在分配后是固定大小的。
*   即使可以扩展数组*，*它们也是从 0 开始的，因此您实际上希望通过设置来扩展它们`objs[objs.length]`- 如果此代码有效，您最终会发现所有其他元素都“丢失”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T15:01:36.347

您的第一个问题是它`objs`不是`null`作为数组分配的。第一行应该是：

```
Object[] objs = new Object[2];  // array 2 elements long 
```

接下来，“数组长度”是数组的总分配大小，而不是您插入的元素数。所以在这个例子中，`objs.length`总是`2`。

因此你的循环也是错误的。

正确的代码是这样的：

```
Object[] objs = new Object[ strArray.length ];  // array of the right size.
for( int k = 0 ; k < strArray.length ; k++ )
{
    objs[k] = strArray[k];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T15:06:27.990

*   代码在语法上是正确的
*   它不能独立编译，但有一些附加功能，例如

    ```
    public class Test {
        public static void main(String[] args) {
            String[] strArray = new String[]{"a","b","c","d","e","f"};
            Object obj1 = new Object();
            String str1 = "test";
            Object[] objs = null;
            objs[0] = str1;
            objs[1] = obj1;
            for(String str: strArray)
            {
                objs[objs.length+1] = str;
            }
        }
    } 
    ```

    它会的，因为它是正确的Java然后

*   它不会在没有错误的情况下运行（`NullPointerException`将发生在`objs[0] = str1`）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T15:10:45.997

下面的代码是您的代码，它带有几个修复程序以使其能够像预期的那样抛出 NullPointerException。

```
public class Crap
{
  public static void main (String[] args)
  {
    Object[] objs = null;
    objs[0] = "str1";
    objs[1] = new Object ();
    for(String str: new String [] { "str1", "str2" })
    {
        objs[objs.length+1] = str;
    }
  }
}

Exception in thread "main" java.lang.NullPointerException
    at Crap.main(Crap.java:6)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:585)
    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:90) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T15:11:33.827

@杰森科恩

也应该存储在 objs 数组中的 str1 和 obj1 成员呢？

# visual-studio-2008 - TFS 工作区

> ID：760741
> 
> 赞同：2
> 
> 时间：2009-04-17T14:58:13.407
> 
> 标签：visual-studio-2008, tfs

我想从与我不同的其他用户那里删除工作区 我该怎么做？如果我使用 Visual Studio 2008 集成，我只能管理我自己的工作区，但我看不到其他用户的工作区。我想一个选项应该是在 Visual Studio 中使用不同的用户连接到服务器，但我找不到该选项。Visual Studio 使用我的 Windows 用户名登录，所以我看不到登录对话框。有任何想法吗？

谢谢

费德里科

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T15:01:28.280

您需要使用命令行工具`TF.EXE`（使用 Visual Studio 命令行在您的路径中获取它）。

```
tf help workspace 
```

在[MSDN](http://msdn.microsoft.com/en-us/library/y901w7se.aspx)上列出选项和更详细的帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-20T08:01:03.510

除了命令行 (tf.exe) 之外，如果您不喜欢命令行，您还可以使用 Atrice 提供的出色且免费的[TFS SideKicks 来](http://www.attrice.info/cm/tfs/)执行此操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-11T18:25:42.290

不久前我遇到了一个类似的问题，这是我修复它的方法。我们有一个人离开了公司，他们锁定了一堆文件。

这是我所做的命令列表...我有一篇博客文章（底部的链接），详细重播了我的修复内容。

1.  tf 工作区 /computer:ComputerName /owner:* /format:detailed /server: [http://teamserver01:8080](http://teamserver01:8080)
2.  tf 工作区 /delete /server: [http://teamserver01:8080](http://teamserver01:8080) ComputerName;TheOtherGuy
3.  是的
4.  tf 工作区 /computer:ComputerName /owner:* /format:detailed /server: [http://teamserver01:8080](http://teamserver01:8080)

[YetAnotherDeveloper.com](http://yetanotherdeveloper.com/post/2007/12/12/How-to-remove-roguezombie-workspaces-from-TeamServer.aspx)

# asp.net - ASP.NET 连接字符串加密/保护

> ID：760745
> 
> 赞同：5
> 
> 时间：2009-04-17T14:59:57.910
> 
> 标签：asp.net

在 ASP.NET 中保护/加密连接字符串的最佳实践是什么，而不是仅仅在 Web.Config 中存储为纯文本

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-17T15:02:59.480

看看[Programmatically encrypting a config-file in .NET](https://stackoverflow.com/questions/21965/programmatically-encrypting-a-config-file-in-net)，它似乎涵盖了这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-17T15:03:45.373

您可以将此部分设置为[加密](http://chiragrdarji.wordpress.com/2008/08/11/how-to-encrypt-connection-string-in-webconfig/)。

但是，该默认加密存在其他人指出的缺陷。您还可以将连接字符串部分设置为指向外部文件，该外部文件将与加密协同工作。这应该可以解决大多数问题，因为系统管理员可以在那里设置加密而不会破坏开发人员的 web.config 中的任何其他内容，并且开发人员可以在不撤消系统管理员加密的情况下部署对配置的更改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T15:03:23.923

Web.Config 内置了对加密连接字符串（和其他数据）的支持，但这确实有一些开销，因为加密与服务器相关联，因此加密必须由服务器管理员而不是开发人员设置。

您也可以使用源中的加密例程手动加密。

你为什么要加密？你在保护谁？黑客可以访问网络配置？不应该知道 prod 连接字符串的开发人员？加密背后的原因将在某种程度上改变解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T15:05:56.943

最佳实践是使用 Windows 身份验证（注意连接池）。

如果做不到这一点，加密连接字符串是一种很好的做法：[在 ASP.NET 2.0 中保密。](http://msdn.microsoft.com/en-us/magazine/cc163614.aspx)

注意：基本方法不适用于网络农场。

# iteration - 以 n 的倍数迭代 python 序列？

> ID：760753
> 
> 赞同：27
> 
> 时间：2009-04-17T15:01:35.550
> 
> 标签：iteration, python

如何按惯用方式批量处理序列的元素？

例如，对于序列“abcdef”和批量大小为 2，我想做如下的事情：

```
for x, y in "abcdef":
    print "%s%s\n" % (x, y)
ab
cd
ef 
```

当然，这不起作用，因为它期望列表中的单个元素本身包含 2 个元素。

什么是一种不错的、简短的、干净的、pythonic 的方式来处理批处理中列表的下 n 个元素，或者来自较大字符串的长度为 n 的子字符串（两个类似的问题）？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-04-17T15:20:36.487

生成器函数会很整洁：

```
def batch_gen(data, batch_size):
    for i in range(0, len(data), batch_size):
            yield data[i:i+batch_size] 
```

示例使用：

```
a = "abcdef"
for i in batch_gen(a, 2): print i 
```

印刷：

```
ab
cd
ef 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-17T16:24:48.190

我有另一种方法，适用于没有已知长度的迭代。

```
 def groupsgen(seq, size):
    it = iter(seq)
    while True:
        values = ()        
        for n in xrange(size):
            values += (it.next(),)        
        yield values 
```

它通过按大小组迭代序列（或其他迭代器），收集元组中的值来工作。在每个组的末尾，它产生元组。

当迭代器用完值时，它会产生一个 StopIteration 异常，然后向上传播，表明 groupsgen 没有值。

它假设这些值以大小集合（2、3 等集合）的形式出现。如果没有，任何剩余的值都将被丢弃。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-04-17T15:28:48.497

不要忘记 zip() 函数：

```
a = 'abcdef'
for x,y in zip(a[::2], a[1::2]):
  print '%s%s' % (x,y) 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-04-17T15:13:44.790

我相信有人会想出更多的“Pythonic”，但是怎么样：

```
for y in range(0, len(x), 2):
    print "%s%s" % (x[y], x[y+1]) 
```

请注意，这只有在您知道这一点时才有效`len(x) % 2 == 0;`

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-04-17T15:30:53.390

但更一般的方法是（受此[答案](https://stackoverflow.com/questions/756550/multiple-tuple-to-two-pair-tuple-in-python/756602#756602)的启发）：

```
for i in zip(*(seq[i::size] for i in range(size))):
    print(i)                            # tuple of individual values 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-04-24T18:59:15.690

然后总是有[文档](http://docs.python.org/library/itertools.html)。

```
def pairwise(iterable):
    "s -> (s0,s1), (s1,s2), (s2, s3), ..."
    a, b = tee(iterable)
    try:
        b.next()
    except StopIteration:
        pass
    return izip(a, b)

def grouper(n, iterable, padvalue=None):
    "grouper(3, 'abcdefg', 'x') --> ('a','b','c'), ('d','e','f'), ('g','x','x')"
    return izip(*[chain(iterable, repeat(padvalue, n-1))]*n) 
```

注意：当给定字符串序列作为输入时，这些生成元组而不是子字符串。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-04-23T15:41:37.513

```
>>> a = "abcdef"
>>> size = 2
>>> [a[x:x+size] for x in range(0, len(a), size)]
['ab', 'cd', 'ef'] 
```

..或者，不是作为列表理解：

```
a = "abcdef"
size = 2
output = []
for x in range(0, len(a), size):
    output.append(a[x:x+size]) 
```

或者，作为生成器，如果多次使用最好（对于一次性的东西，列表理解可能是“最好的”）：

```
def chunker(thelist, segsize):
    for x in range(0, len(thelist), segsize):
            yield thelist[x:x+segsize] 
```

..它的用法：

```
>>> for seg in chunker(a, 2):
...     print seg
... 
ab
cd
ef 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-17T15:14:36.283

您可以创建以下生成器

```
def chunks(seq, size):
    a = range(0, len(seq), size)
    b = range(size, len(seq) + 1, size)
    for i, j in zip(a, b):
        yield seq[i:j] 
```

并像这样使用它：

```
for i in chunks('abcdef', 2):
    print(i) 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-12-06T06:38:02.410

来自[more_itertools](https://more-itertools.readthedocs.io/en/stable/)的文档：[`more_itertools.chunked()`](https://more-itertools.readthedocs.io/en/stable/api.html#more_itertools.chunked)

```
more_itertools.chunked(iterable, n) 
```

将一个可迭代对象分解为给定长度的列表：

```
>>> list(chunked([1, 2, 3, 4, 5, 6, 7], 3))
[[1, 2, 3], [4, 5, 6], [7]] 
```

如果 iterable 的长度不能被 n 整除，则最后返回的列表会更短。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-09-09T09:52:09.897

```
 s = 'abcdefgh'
for e in (s[i:i+2] for i in range(0,len(s),2)):
  print(e) 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-06-03T04:28:50.830

[itertools 文档](https://docs.python.org/2/library/itertools.html)对此有一个秘诀：

```
from itertools import izip_longest

def grouper(iterable, n, fillvalue=None):
    "Collect data into fixed-length chunks or blocks"
    # grouper('ABCDEFG', 3, 'x') --> ABC DEF Gxx
    args = [iter(iterable)] * n
    return izip_longest(fillvalue=fillvalue, *args) 
```

用法：

```
>>> l = [1,2,3,4,5,6,7,8,9]
>>> [z for z in grouper(l, 3)]
[(1, 2, 3), (4, 5, 6), (7, 8, 9)] 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-09-30T10:03:23.963

除了两个答案外，我看到很多批次的过早实现和下标（不适用于所有迭代器）。因此我想出了这个替代方案：

```
def iter_x_and_n(iterable, x, n):
    yield x
    try:
        for _ in range(n):
            yield next(iterable)
    except StopIteration:
        pass

def batched(iterable, n):
    if n<1: raise ValueError("Can not create batches of size %d, number must be strictly positive" % n)
    iterable = iter(iterable)
    try:
        for x in iterable:
            yield iter_x_and_n(iterable, x, n-1)
    except StopIteration:
        pass 
```

令我震惊的是，没有针对此问题的单行或少行解决方案（据我所知）。关键问题是外部生成器和内部生成器都需要正确处理 StopIteration。外部生成器应该只在至少剩下一个元素时才产生一些东西。检查这一点的直观方法是执行 next(...) 并捕获 StopIteration。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-01-10T07:18:11.767

改编自Python 3 的[这个答案](https://stackoverflow.com/a/761125/2381330)：

```
def groupsgen(seq, size):
    it = iter(seq)
    iterating = True
    while iterating:
        values = ()
        try:
            for n in range(size):
                values += (next(it),)
        except StopIteration:
            iterating = False
            if not len(values):
                return None
        yield values 
```

如果它们的数字不能被 整除，它将安全终止并且不会丢弃值`size`。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-04-23T15:10:44.917

迭代工具怎么样？

```
from itertools import islice, groupby

def chunks_islice(seq, size):
    while True:
        aux = list(islice(seq, 0, size))
        if not aux: break
        yield "".join(aux)

def chunks_groupby(seq, size):
    for k, chunk in groupby(enumerate(seq), lambda x: x[0] / size):
        yield "".join([i[1] for i in chunk]) 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-06-22T00:27:24.917

给定

```
from __future__ import print_function                      # python 2.x

seq = "abcdef"
n = 2 
```

代码

```
while seq:
    print("{}".format(seq[:n]), end="\n")
    seq = seq[n:] 
```

输出

```
ab
cd
ef 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-04-29T11:40:18.930

这是一个解决方案，它产生一系列迭代器，每个迭代器迭代*n 个*项目。

```
def groupiter(thing, n):
    def countiter(nextthing, thingiter, n):
        yield nextthing
        for _ in range(n - 1):
            try:
                nextitem = next(thingiter)
            except StopIteration:
                return
            yield nextitem
    thingiter = iter(thing)
    while True:
        try:
            nextthing = next(thingiter)
        except StopIteration:
            return
        yield countiter(nextthing, thingiter, n) 
```

我使用它如下：

```
table = list(range(250))
for group in groupiter(table, 16):
    print(' '.join('0x{:02X},'.format(x) for x in group)) 
```

请注意，它可以处理对象的长度不是*n*的倍数。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2009-04-17T15:13:39.423

一种解决方案，尽管我挑战某人做得更好;-)

```
a = 'abcdef'
b = [[a[i-1], a[i]] for i in range(1, len(a), 2)]

for x, y in b:
  print "%s%s\n" % (x, y) 
```

# java - 在 Eclipse 中调试 Java 时如何使 getResourceAsStream 工作？

> ID：760756
> 
> 赞同：7
> 
> 时间：2009-04-17T15:01:59.670
> 
> 标签：java, eclipse, resources

这令人难以置信...当我在包含文本文件的打包 JAR 文件上运行 Java 时，我可以使 getResource() 和 getResourceAsStream() 正常工作。（作为参考，请参阅 Sun docs on [access resources](http://java.sun.com/j2se/1.5.0/docs/guide/lang/resources.html)）当我在 Eclipse 中运行相同的程序时，我似乎无法使它正常工作，即使我已将我的文本文件放在与我编译的 .class 文件相同的树中

你们中有人能指出我确保 getResource() 和 getResourceAsStream() 函数正常工作的任何细节吗？

我有一种预感，它与 CLASSPATH 和/或 Eclipse 放置它自动编译的 .class 文件的位置有关。（我注意到，当我运行 Ant 时，它会编译自上次 Ant 构建以来发生更改的所有 Java 文件，即使 Eclipse 已经编译了这些 Java 文件。）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-17T15:37:12.937

几点注意事项：

首先 - 正如 Chocos 所说，将它放在 eclipse 源目录中，而不是二进制目录中。Eclipse 将在您“清理”时清除二进制目录，并清理不匹配的文件。它将非 java 源文件复制到二进制目录。

这意味着即使您将文件放在二进制目录中，它也可能被 eclipse 删除...

请记住，getResourceAsStream 和 getResource 相对于调用它们的代码包进行操作。例如：

```
package a.b.c;
public class Foo {
   ...
   getClass().getClassLoader().getResourceAsStream("fee.txt");
   ...
} 
```

这实际上会查找 a/b/c/fee.txt；包是预先准备好的。如果您在与 Foo.java 文件相同的源目录中拥有 fee.txt，或者如果您在具有相同目录结构的类路径上有一组单独的资源目录，则此方法效果很好。

如果你使用

```
...getResourceAsStream("/fee.txt"); 
```

它将直接在类路径中查找 fee.txt。

从命令行运行时，JAR 中的资源文件在哪里？——斯科特

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-17T15:06:48.377

如果您将文本文件与源文件放在一起，Eclipse 会将其复制到放置已编译的 .class 文件的任何位置，因此当您从 Eclipse 运行应用程序时，您将看到您的文本文件（并且您将能够编辑Eclipse 中的文件）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T15:53:47.360

**发现问题了！**

我**确实**在源代码树中有我的图像文件。（在我的 Ant 构建中，我将它们复制到构建目录）

问题是我最近没有刷新 Eclipse 中的源代码树。所以文件在那里，但 Eclipse 没有注意到它们。

感谢您告诉我 Eclipse 应该在我的源代码树中包含它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T15:07:11.013

> 我有一种预感，它与 CLASSPATH 和/或 Eclipse 放置它自动编译的 .class 文件的位置有关。

在启动应用程序的运行配置中，转到类路径选项卡并添加用于访问文件的路径的根文件夹。

因此，例如，如果您尝试加载“blah/file.txt”并且文件位于“folder/blah/file.txt”中，请将“folder”添加到类路径中。如果您尝试仅使用“file.txt”加载资源，请添加“folder/blah”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-10-11T09:37:04.507

我在使用 IntelliJ 时遇到了同样的问题，解决方案是，在项目设置中，添加包含资源文件的文件夹，在我的情况下为声音文件，作为源。在 Settings->Compiler Resource patterns 中添加 ?*.wav （或您的 pref 文件类型）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T15:07:48.407

您所说的“正常工作”到底是什么意思？错误/行为是什么？

我建议使用`getResource`来查找您的一个文件的 URL `.class`（或大致等价`getClass().getProtectionDomain().getCodeSource()`的 .您可能会发现它指向了一个意想不到的地方。

# regex - 在 "> 中提取一个字符串，然后 我正在尝试从一行中具有以下模式的文件中提取字符串 >------ </ ----- 代表可以是任何可变长度的字符串。一行中的开始模式是>和结束模式</。 使用 VIM 的正则表达式可以进行命令行搜索吗？如果可以，可以打印吗？ 问问题 问问题 2009-04-17T15:02:45.267 1404 次 This question shows research effort; it is useful and clear 2 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 我正在尝试从一行中具有以下模式的文件中提取字符串 >------ </ ----- 代表可以是任何可变长度的字符串。一行中的开始模式是>和结束模式</。 使用 VIM 的正则表达式可以进行命令行搜索吗？如果可以，可以打印吗？ 还是必须写一个脚本？ 我是 VIM 的新用户 尝试以下 vim 搜索： /">\(.*\)<\/ 这应该与具有该模式的任何行匹配。它还将存储它在您的开始和结束标记之间抓取的任何文本，\1如果您想在 vim 中进行搜索和替换，您可以使用这些文本。例如： :%s/">\(.*\)<\//Log message: \1/ 如果您想在命令行中使用 grep 来搜索该字符串，您可以使用： $ egrep "\">.*<\/" foo.txt 这将只打印出匹配的行foo.txt。如果要将这些发送到新文件，请尝试： $ egrep "\">.*<\/" foo.txt > new.txt regexvim 4 2 回答 2 This answer is useful 6 尝试以下 vim 搜索： /">\(.*\)<\/ 这应该与具有该模式的任何行匹配。它还将存储它在您的开始和结束标记之间抓取的任何文本，\1如果您想在 vim 中进行搜索和替换，您可以使用这些文本。例如： :%s/">\(.*\)<\//Log message: \1/ 如果您想在命令行中使用 grep 来搜索该字符串，您可以使用： $ egrep "\">.*<\/" foo.txt 这将只打印出匹配的行foo.txt。如果要将这些发送到新文件，请尝试： $ egrep "\">.*<\/" foo.txt > new.txt 于 2009-04-17T15:11:41.597 回答 This answer is useful 1 试试这个 %:s/.*>\(.*\)<\/.*/\1/ 于 2009-04-17T15:35:06.000 回答 Related 5 javascript - javascript：将 a='x1y2' 转换为 x=1 和 y=2？ 4 jquery - 如果我在 Rails 中使用 Turbolinks，则在浏览器中单击“返回”会禁用我的 javascript 代码 1 javascript - javascript更改标签属性未按正确顺序执行？ 1 c# - 在 C# 中为 WinForms 创建对象编辑器 1 multithreading - 如何在powershell的多线程中调用自定义dll？ 1 c - 使 DMA 内存可临时缓存 3 java - 对非标准浏览器显示警告 1 svn - svn 转储文件：Node-copyfrom-rev 2 php - 使用预设文件名上传 PHP 文件 1 odbc - golang：如果不将 fmt.Printf() 放在 for 循环的末尾，则 CSV 文件到 MS SQL 将无法正常工作 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：760761
> 
> 赞同：2
> 
> 时间：
> 
> 标签：regex, vim

我正在尝试从一行中具有以下模式的文件中提取字符串

```
>------ </ 
```

----- 代表可以是任何可变长度的字符串。一行中的开始模式是`>`和结束模式`</`。

使用 VIM 的正则表达式可以进行命令行搜索吗？如果可以，可以打印吗？

还是必须写一个脚本？

我是 VIM 的新用户

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-17T15:11:41.597

尝试以下 vim 搜索：

```
/">\(.*\)<\/ 
```

这应该与具有该模式的任何行匹配。它还将存储它在您的开始和结束标记之间抓取的任何文本，`\1`如果您想在 vim 中进行搜索和替换，您可以使用这些文本。例如：

```
:%s/">\(.*\)<\//Log message: \1/ 
```

如果您想在命令行中使用 grep 来搜索该字符串，您可以使用：

```
$ egrep "\">.*<\/" foo.txt 
```

这将只打印出匹配的行`foo.txt`。如果要将这些发送到新文件，请尝试：

```
$ egrep "\">.*<\/" foo.txt > new.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T15:35:06.000

试试这个

```
%:s/.*>\(.*\)<\/.*/\1/ 
```

# jquery - jquery 支持函数 pageload() 和 $().ready()？

> ID：760762
> 
> 赞同：1
> 
> 时间：2009-04-17T15:02:46.670
> 
> 标签：jquery, asp.net-ajax

jquery 是否同时支持函数 pageload() 和 $().ready() ？

还是 ajax.net 的 pageload() ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T15:13:22.543

它只支持 $().ready()

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T15:12:58.723

JQuery 没有页面加载功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-18T12:55:37.273

[http://encosia.com/2009/03/25/document-ready-and-pageload-are-not-the-same/](http://encosia.com/2009/03/25/document-ready-and-pageload-are-not-the-same/)

# asp.net - xslt：如何创建动态表？

> ID：760763
> 
> 赞同：1
> 
> 时间：2009-04-17T15:02:48.823
> 
> 标签：asp.net, xml, xslt

鉴于此 xml

```
<Documents>
<Section>
<SectionName>Green</SectionName>
  <Document>
    <FileName>Tier 1 Schedules</FileName>     
  </Document>
  <Document>
    <FileName>Tier 3 Schedules</FileName>      
  </Document>
  <Document>
    <FileName>Setback Schedule</FileName>    
  </Document>
  <Document>
    <FileName>Tier 2 Governance</FileName>    
  </Document>
</Section>
<Section>
<SectionName>MRO/Refurb</SectionName>
  <Document>
    <FileName>Tier 2 Governance</FileName>    
  </Document>
</Section>
</Documents> 
```

xslt 是什么来输出这个 html

```
<table>
  <tr>
    <td>Green</td>
  </tr>
  <tr>
    <td>Tier 1 Schedules</td>
  </tr>
  <tr>
    <td>Tier 3 Schedules</td>
  </tr>
  <tr>
    <td>Setback Schedule</td>
  </tr>
  <tr>
    <td>Tier 2 Governance</td>
  </tr>
  <tr>
    <td>MRO/Refurb</td>
  </tr>
  <tr>
    <td>Tier 2 Governance</td>
  </tr>
</table> 
```

我可以在 asp.net 中执行此操作，但不确定如何在 xslt 中执行循环。

谢谢，艾尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T15:25:45.103

```
<xsl:stylesheet 
  version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
>
  <xsl:output method="xml" indent="yes" omit-xml-declaration="yes" />

  <xsl:template match="/">
    <table>
      <xsl:apply-templates select="//SectionName | //FileName" />
    </table>
  </xsl:template>

  <xsl:template match="SectionName | FileName">
    <tr>
      <td><xsl:value-of select="." /></td>
    </tr>
  </xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T16:14:43.830

**实际上，有一个**比 Tomalak 提出的解决方案稍微简单的解决方案：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output omit-xml-declaration="yes" indent="yes"/>

    <xsl:strip-space elements="*"/>

    <xsl:template match="/">
        <table>
            <xsl:apply-templates/>
        </table>
    </xsl:template>

    <xsl:template match="SectionName | FileName">
        <tr>
            <td>
                <xsl:value-of select="." />
            </td>
        </tr>
    </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于最初提供的 XML 文档时，会产生所需的结果**：

```
<table>
   <tr>
      <td>Green</td>
   </tr>
   <tr>
      <td>Tier 1 Schedules</td>
   </tr>
   <tr>
      <td>Tier 3 Schedules</td>
   </tr>
   <tr>
      <td>Setback Schedule</td>
   </tr>
   <tr>
      <td>Tier 2 Governance</td>
   </tr>
   <tr>
      <td>MRO/Refurb</td>
   </tr>
   <tr>
      <td>Tier 2 Governance</td>
   </tr>
</table> 
```

**请注意**：

1.  **该`<xsl:apply-templates>`指令没有明确指定**必须处理的节点列表。在这里，我们依赖于这样一个事实，即文档中唯一的非空白节点是我们有匹配模板的节点的子节点。

2.  **对于这个特定的 XML 文档，我们甚至可以将匹配模式更改`<xsl:template match="SectionName | FileName">`为 just:`<xsl:template match="text()">`**并且转换仍然会产生想要的结果。

3.  **该`<xsl:strip-space>`指令**的使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T15:24:17.867

像这样的东西应该可以解决问题：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:msxsl="urn:schemas-microsoft-com:xslt" exclude-result-prefixes="msxsl">
    <xsl:output method="html" indent="yes"/>

    <xsl:template match="/">
      <table>
        <xsl:copy>
            <xsl:apply-templates />
        </xsl:copy>
      </table>
    </xsl:template>

  <xsl:template match="SectionName">
    <tr>
      <td>
        <xsl:value-of select="."/>
      </td>
    </tr>
  </xsl:template>

  <xsl:template match="Document">
    <tr>
      <td>
        <xsl:value-of select="FileName"/>
      </td>
    </tr>
  </xsl:template>
</xsl:stylesheet> 
```

马克

# c++ - 通过检测文件打开（创建）进行进程同步

> ID：760766
> 
> 赞同：1
> 
> 时间：2009-04-17T15:03:10.290
> 
> 标签：c++, windows, file

有两种应用。第一个应用程序对有问题的机器是远程的（我没有访问它）并通过网络（LAN）创建一个大文件。我无法控制这个过程，也不知道它何时发生。这就是我必须解决的问题。我不能以任何方式添加、更改或更改它。

第二个应用程序由我编写，并在找到该文件时对其进行处理。此应用程序计划每 5 分钟运行一次。

当我的应用程序尝试处理文件时，可能会出现正在写入文件的情况，从而导致处理不完整和/或其他错误，因此我需要在开始处理文件之前检测文件是否已完全写入。

我可以使用 OpenFile() 并请求读/写锁定访问。错误将表明正在创建文件。

我可以用文件系统观察者做一些聪明的事情 [http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)

但我怀疑有一种我没有想到的优雅方式用于 Windows（NT 及更高版本）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T15:52:19.797

我认为您通过 FileSystemWatcher 或[ReadDirectoryChanges](http://msdn.microsoft.com/en-us/library/aa365465(VS.85).aspx)的系统观察程序解决方案是您可以获得的最佳解决方案。您也可以在 CodeProject中查看[本教程。](http://www.codeproject.com/KB/files/directorychangewatcher.aspx)无论如何，它还能优雅多少？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T15:21:25.877

标准解决方案是让作者写入一个临时文件，然后在完成后重命名该文件。

这样，阅读器（您的应用程序）只会在文件完成后才能看到文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T16:01:00.243

另一个答案但不同：我突然想起另一个做类似事情的项目。我的应用程序只`OpenFile()`与`OF_SHARE_EXCLUSIVE`（我认为）一起使用，直到它成功打开文件。在这种情况下，这可以正常工作，因为我的应用程序正在访问由远程应用程序写入的文件到与我的应用程序在同一台机器上的共享。我从来没有用文件服务器上的文件测试过它，但它可以工作。然而，当与远程文件一起使用时，文件锁定并不总是可靠的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T15:30:35.980

回到过去，我不得不编写使用网络上的文件进行通信的软件（在某些 *NIX 应用程序和通过 Novell 文件服务器的 Windows 应用程序之间）。为了可靠地做到这一点，我们总是说服数据文件的提供者在完成写入数据时创建一个额外的握手文件（只是一个空文件）。我们的应用程序会轮询握手文件，如果握手文件存在，我们就会读取数据文件。当我们的应用程序完成读取数据时，它会删除握手文件。握手文件由提供者监控，只要握手文件存在，它就不会接触数据文件。

然而，大多数时候数据的提供者愿意修改他们的应用程序。我认为可靠地做到这一点的唯一方法是从提供商那里获得信号。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T16:51:39.857

正如许多其他人已经指出的那样，唯一明智的方法是额外握手。由于这似乎不可能，我会做以下事情。

*   编写您的应用程序以永久运行（如守护程序）。
*   检查文件，如果找到它
    *   监视它的大小，直到它在指定的时间（例如 30 秒）内不再增长
    *   在您决定完成传输后重命名文件
    *   处理重命名的文件

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T15:08:13.070

一个完全骇人听闻的方法是在远程机器上安装一个 API 挂钩以捕获文件关闭，然后启动您的程序或发送完成的通知。

# oracle - 从 Oracle Express 迁移到 Real Deal 需要注意什么？

> ID：760767
> 
> 赞同：0
> 
> 时间：2009-04-17T15:03:18.947
> 
> 标签：oracle, oracle-xe

我正在编写一个需要在 Oracle DB 上运行的应用程序，我们没有 Oracle Db，但我们的客户有，所以我一直在使用 Oracle Express 开发/测试它。

在从免费版本迁移到全脂版本时，我应该注意哪些可能会破坏我的应用程序的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T21:49:10.347

其中大部分与部署有关：

1.  代码页差异。
2.  10g / 11g / 9i / 8i ...版本差异，您可能正在使用早期版本不支持的特定内容（AFAIK，XE 是 10g）。
3.  网络/tnsnames.ora/sqlnet.ora
4.  expdp/impdp 或 exp/imp，以及不同的选项。

您不必被迫使用 XE 进行开发，Oracle 也允许使用开发许可证，因此如果您仅将其用于开发而不在生产中使用，您可以运行任何版本或功能集（甚至是 Enterprise 或 RAC），他们在 OTN 下载页面上说： *所有软件下载都是免费的，并且每个都带有一个开发许可证，允许您在开发和原型设计应用程序时免费使用产品的完整版本（或用于严格的自学目的）*，除非您在笔记本电脑或低功率 VM 上使用 XE，否则我会在 300 美元的 Linux（Centos？）PC 上购买企业版。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T15:32:12.920

并不真地。我能想到的唯一可能会咬你的东西：

*   您是否只在本地进行测试（即同一台机器上的代码+数据库）？网络应该只是一个配置问题，但值得牢记以避免任何部署问题。
*   是全胖版上的版本和点发布吗？如果没有，请检查发行说明以了解差异。可能对你来说无关紧要。
*   从理论上讲，您可能希望注意版本功能，但这不应该适用于这种情况，因为 S1/S/E 拥有 XE 所拥有的一切。

除此之外，同一版本的不同版本在功能上应该相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T02:03:47.743

取决于“全脂”版的版本。如果它们仍在旧的 Oracle 9i/9iR2/10gR1 版本上，那么如果您使用了 10gR2 的功能，您可能会遇到问题。Apex 在 11g 之前默认不安装，但可以添加。嵌入式 pl/sql 网关在非 XE 10gR2 上不可用。如果你不知道这两个是什么，那么它不会影响你。

XE 还对数据库到 Internet 连接（google NETWORK_ACL）应用了更严格的安全控制，直到 11g 才应用于全脂版本。

# c# - 当表单将读取的 txt 文件加载到数组中时

> ID：760771
> 
> 赞同：0
> 
> 时间：2009-04-17T15:03:41.957
> 
> 标签：c#, arraylist

我正在开发一个 C# 应用程序，当加载表单时，我希望它读取 txt 文件的内容并将其存储到数组中。接下来，当单击表单上的按钮时，我希望按钮单击事件来访问数组。如何将数组传递给按钮单击事件？我下面的代码有一个错误“statusArray 在当前上下文中不存在”，并且与按钮单击事件中对数组的引用有关。我需要做什么？

苏珊

```
private void btnCompleted_Click(object sender, EventArgs e)
    {

        for (int i = 0; i < statusArray.Count; i++)
        {
            if (statusArray[i].Equals("Complete"))

                lstReports.Items.Add(statusArray[i-2]);

        }
    }

    private void Reports_Load(object sender, EventArgs e)
    {
        // declare variables
        string inValue;
        string data;
        ArrayList statusArray = new ArrayList();

        inFile = new StreamReader("percent.txt");

        // Read each line from the text file

        while ((inValue = inFile.ReadLine()) != null)
        {
            data = Convert.ToString(inValue);
            statusArray.Add(inValue);

        }

        // Close the text file
        inFile.Close();

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T15:08:32.243

将 ArrayList 作为成员变量存储在表单上，​​如下所示：

```
private ArrayList statusArray = new ArrayList();

private void btnCompleted_Click(object sender, EventArgs e) {

    for (int i = 0; i < statusArray.Count; i++)
    {
        if (statusArray[i].Equals("Complete"))

            lstReports.Items.Add(statusArray[i-2]);

    }
}

private void Reports_Load(object sender, EventArgs e)
{
    // declare variables
    string inValue;
    string data;

    inFile = new StreamReader("percent.txt");

    // Read each line from the text file

    while ((inValue = inFile.ReadLine()) != null)
    {
        data = Convert.ToString(inValue);
        statusArray.Add(inValue);

    }

    // Close the text file
    inFile.Close();

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T15:08:52.927

将您的 arrayList 声明移到 `Reports_Load(object sender, EventArgs e)`方法之外，这使其成为一个全局类。

您可能还会发现`List<string>`将数据存储在（强类型）中会更好

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T15:09:26.390

ArrayList与 Array*不同*，如果您使用的是 .Net 2.0 或更高版本，则 ArrayLists 是**邪恶**的。

至于失败的原因：您的数组列表的范围为 Reports_Load() 函数。您想将其移至类级别，并声明为`List<string>`.

如果你真的*想要*一个数组，另一个选择是使用 File 类的`.ReadAllLines()`方法。

```
private string[] status;

private void btnCompleted_Click(object sender, EventArgs e)
{
    for (int i = 2; i < status.Length; i++)
    {
        if (status[i] == "Complete")
            lstReports.Items.Add(status[i-2]);

    }
}

private void Reports_Load(object sender, EventArgs e)
{
    status = File.ReadAllLines("percent.txt");
} 
```

# c# - 管理表单状态的最佳方法是什么？

> ID：760776
> 
> 赞同：1
> 
> 时间：2009-04-17T15:04:44.700
> 
> 标签：c#, winforms, design-patterns, controls, state

我正在 C# .NET 2.0 应用程序中开发一个表单，其中包含有关表单上各种控件的状态（启用/禁用）的复杂逻辑。（该设计是业务分析师对 UI 最佳实践缺乏了解的表现。）

管理表单“状态”的最佳方法是什么？通常，我见过一个 ShowControls(state) 或 SetEnables(state) 函数，其中 state 是可能的配置（INITIAL、AFTER_SELECT、AFTER_COPY 等）的枚举。我预测这将很快变得无法维护。

您使用什么方法来维护表单“状态”？在跟踪复杂的控制交互过程中，您可能会涉及哪些模式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T15:21:55.113

我最喜欢的模式是[被动视图](http://martinfowler.com/eaaDev/PassiveScreen.html)。它从表单中删除了所有状态管理责任。最后，它使您的演示文稿代码的维护变得更加容易，但在额外代码方面存在一些前期成本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-12-13T08:39:48.993

您可能会考虑与业务分析师一起采取其他策略，要么诋毁他，要么让他进入你的阵营，然后再继续，因为你正在进入一个黑洞听起来像。最好是在你身边赢得他，但这需要更多的耐心。这可能不是技术问题。

但是进入技术讨论...

由于您使用的是 Web 表单 2.0，哎呀，您可以使用用户控件使用视图状态来封装您的表单状态。您应该使用自上而下的方法。假设您有 5 个控制表单状态的控件。在每个控件中，您都有一个占位符，您可以根据控件的状态动态加载和加载内容。在动态加载的每个用户控件中，您可以执行俄罗斯娃娃效果（封装）并在其中放置更多疯狂的规则，分析师会随机抽出他的屁股。在这种情况下，封装和 ViewState 是你的朋友。只要确保在 Page_Init 事件上加载控件，因为它会使所有其他事件很好地配合。很抱歉您正在使用 Web 表单和 .net 2.0。非常抱歉。

# c++ - C++ getter/setter 编码风格

> ID：760777
> 
> 赞同：67
> 
> 时间：2009-04-17T15:04:46.667
> 
> 标签：c++, coding-style, getter-setter

我用 C# 编程已经有一段时间了，现在我想复习一下我的 C++ 技能。

上课：

```
class Foo
{
    const std::string& name_;
    ...
}; 
```

什么是最好的方法（我只想允许读取 name_ 字段）：

*   使用 getter 方法：`inline const std::string& name() const { return name_; }`
*   公开该字段，因为它是一个常数

谢谢。

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-04-17T15:26:34.213

使用 getter 方法对于长期存在的类来说是更好的设计选择，因为它允许您在将来用更复杂的东西替换 getter 方法。尽管对于 const 值似乎不太可能需要这样做，但成本很低，可能的好处很大。

顺便说一句，在 C++ 中，为成员赋予*相同名称*的 getter 和 setter 是一个特别好的主意，因为将来您可以实际更改这对方法：

```
class Foo {
public:
    std::string const& name() const;          // Getter
    void name(std::string const& newName);    // Setter
    ...
}; 
```

进入一个`operator()()`为每个定义一个公共成员变量：

```
// This class encapsulates a fancier type of name
class fancy_name {
public:
    // Getter
    std::string const& operator()() const {
        return _compute_fancy_name();    // Does some internal work
    }

    // Setter
    void operator()(std::string const& newName) {
        _set_fancy_name(newName);        // Does some internal work
    }
    ...
};

class Foo {
public:
    fancy_name name;
    ...
}; 
```

客户端代码当然需要重新编译，但不需要更改语法！显然，这种转换同样适用于 const 值，其中只需要一个 getter。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-04-17T15:08:58.077

公开非常量字段往往不是一个好主意，因为这样就很难强制错误检查约束和/或在未来对值更改添加副作用。

在您的情况下，您有一个 const 字段，因此上述问题不是问题。将其设为公共字段的主要缺点是您锁定了底层实现。例如，如果将来您想将内部表示更改为 C 字符串或 Unicode 字符串或其他内容，那么您将破坏所有客户端代码。使用 getter，您可以转换为现有客户端的旧表示，同时通过新的 getter 向新用户提供更新的功能。

我仍然建议使用像您上面放置的那样的 getter 方法。这将最大限度地提高您未来的灵活性。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-04-18T03:07:25.573

顺便说一句，在 C++ 中，有一个 const 引用成员有点奇怪。您必须在构造函数列表中分配它。谁拥有该对象的实际内存，它的生命周期是多少？

至于风格，我同意其他人的观点，即您不想暴露自己的隐私。:-) 我喜欢 setter/getter 的这种模式

```
class Foo
{
public:
  const string& FirstName() const;
  Foo& FirstName(const string& newFirstName);

  const string& LastName() const;
  Foo& LastName(const string& newLastName);

  const string& Title() const;
  Foo& Title(const string& newTitle);
}; 
```

这样，您可以执行以下操作：

```
Foo f;
f.FirstName("Jim").LastName("Bob").Title("Programmer"); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-12-09T16:24:27.217

我认为现在的 C++11 方法会更像这样。

```
#include <string>
#include <iostream>
#include <functional>

template<typename T>
class LambdaSetter {
public:
    LambdaSetter() :
        getter([&]() -> T { return m_value; }),
        setter([&](T value) { m_value = value; }),
        m_value()
    {}

    T operator()() { return getter(); }
    void operator()(T value) { setter(value); }

    LambdaSetter operator=(T rhs)
    {
        setter(rhs);
        return *this;
    }

    T operator=(LambdaSetter rhs)
    {
        return rhs.getter();
    }

    operator T()
    { 
        return getter();
    }

    void SetGetter(std::function<T()> func) { getter = func; }
    void SetSetter(std::function<void(T)> func) { setter = func; }

    T& GetRawData() { return m_value; }

private:
    T m_value;
    std::function<const T()> getter;
    std::function<void(T)> setter;

    template <typename TT>
    friend std::ostream & operator<<(std::ostream &os, const LambdaSetter<TT>& p);

    template <typename TT>
    friend std::istream & operator>>(std::istream &is, const LambdaSetter<TT>& p);
};

template <typename T>
std::ostream & operator<<(std::ostream &os, const LambdaSetter<T>& p)
{
    os << p.getter();
    return os;
}

template <typename TT>
std::istream & operator>>(std::istream &is, const LambdaSetter<TT>& p)
{
    TT value;
    is >> value;
    p.setter(value);
    return is;
}

class foo {
public:
    foo()
    {
        myString.SetGetter([&]() -> std::string { 
            myString.GetRawData() = "Hello";
            return myString.GetRawData();
        });
        myString2.SetSetter([&](std::string value) -> void { 
            myString2.GetRawData() = (value + "!"); 
        });
    }

    LambdaSetter<std::string> myString;
    LambdaSetter<std::string> myString2;
};

int _tmain(int argc, _TCHAR* argv[])
{
    foo f;
    std::string hi = f.myString;

    f.myString2 = "world";

    std::cout << hi << " " << f.myString2 << std::endl;

    std::cin >> f.myString2;

    std::cout << hi << " " << f.myString2 << std::endl;

    return 0;
} 
```

我在 Visual Studio 2013 中对此进行了测试。不幸的是，为了使用 LambdaSetter 中的底层存储，我需要提供一个“GetRawData”公共访问器，这可能会导致封装损坏，但您可以将其排除在外并提供自己的存储容器T 或者只是确保您使用“GetRawData”的唯一时间是在您编写自定义 getter/setter 方法时。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-17T15:10:55.793

即使名称是不可变的，您可能仍希望选择计算它而不是将其存储在字段中。（我意识到这对于“名称”来说不太可能，但让我们针对一般情况。）因此，即使是常量字段也最好包裹在 getter 中：

```
class Foo {
    public:
        const std::string& getName() const {return name_;}
    private:
        const std::string& name_;
}; 
```

请注意，如果您要更改`getName()`为返回计算值，则它无法返回 const ref。没关系，因为它不需要对调用者进行任何更改（模重新编译。）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-17T15:50:35.653

避免使用公共变量，除了本质上是 C 风格结构的类。进入这不是一个好习惯。

一旦你定义了类接口，你可能永远无法改变它（除了添加它），因为人们会在它之上构建并依赖它。将变量公开意味着您需要拥有该变量，并且您需要确保它具有用户需要的内容。

现在，如果您使用 getter，您承诺提供一些信息，这些信息当前保存在该变量中。如果情况发生变化，并且您不想一直维护该变量，则可以更改访问权限。如果需求发生变化（并且我看到了一些非常奇怪的需求变化），并且您主要需要此变量中的名称，但有时需要该变量中的名称，您只需更改 getter。如果你将变量公开，你就会被它困住。

这不会总是发生，但我发现写一个快速的 getter 比分析情况看我是否会后悔将变量公开（并冒着以后出错的风险）要容易得多。

将成员变量设为私有是一个好习惯。任何有代码标准的商店都可能会禁止将偶尔的成员变量公开，任何有代码审查的商店都可能会因此批评你。

每当写作的便利性真的无关紧要时，养成更安全的习惯。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-10-25T21:04:20.510

从多个 C++ 源中收集想法并将其放入一个不错的、仍然非常简单的 C++ 中的 getter/setter 示例：

```
class Canvas { public:
    void resize() {
        cout << "resize to " << width << " " << height << endl;
    }

    Canvas(int w, int h) : width(*this), height(*this) {
        cout << "new canvas " << w << " " << h << endl;
        width.value = w;
        height.value = h;
    }

    class Width { public:
        Canvas& canvas;
        int value;
        Width(Canvas& canvas): canvas(canvas) {}
        int & operator = (const int &i) {
            value = i;
            canvas.resize();
            return value;
        }
        operator int () const {
            return value;
        }
    } width;

    class Height { public:
        Canvas& canvas;
        int value;
        Height(Canvas& canvas): canvas(canvas) {}
        int & operator = (const int &i) {
            value = i;
            canvas.resize();
            return value;
        }
        operator int () const {
            return value;
        }
    } height;
};

int main() {
    Canvas canvas(256, 256);
    canvas.width = 128;
    canvas.height = 64;
} 
```

输出：

```
new canvas 256 256
resize to 128 256
resize to 128 64 
```

你可以在这里在线测试：http: [//codepad.org/zosxqjTX](http://codepad.org/zosxqjTX)

PS：FO 伊薇特 <3

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-17T17:04:53.647

来自设计模式理论；“封装变化的东西”。通过定义“吸气剂”，可以很好地遵守上述原则。因此，如果将来成员的实现表示发生变化，则可以在从“getter”返回之前对成员进行“按摩”；暗示在进行“getter”调用的客户端没有代码重构。

问候，

# java - getBytes vs getBinaryStream vs getBlob 用于从 BLOB 列中获取数据

> ID：760781
> 
> 赞同：20
> 
> 时间：2009-04-17T15:05:42.170
> 
> 标签：java, sql, jdbc

有 3 种不同的方法可以`BLOB`从`ResultSet`

*   `getBytes`
*   `getBinaryStream`
*   `getBlob`

此外，`Blob`返回的对象`getBlob`也有可用`getBytes`的`getBinaryStream`方法。

是否有任何特殊原因（性能、内存、数据库特定问题）我应该选择其中一个？

该`Blob`对象还具有`free()`自 JDBC 4.0 以来引入的调用。这有什么区别吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-17T15:18:46.430

如果您要提取大量数据（即足以导致内存问题的数据），那么 getBinaryStream 将为您提供最大的灵活性来处理和丢弃读取的数据。

另一方面，这可能会很慢，具体取决于您的 JDBC 驱动程序，因为从流中读取的每次都可能需要与数据库进行大量网络通信。如果您调用 getBytes，那么驱动程序就知道一次性获取全部内容，这可能会更有效率。

getBlob() 返回一个指向数据的“指针”，您可以使用 Blob 接口上的方法对其进行操作。如果您需要修改或以其他方式对数据感兴趣，那么这可能最适合您。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-17T15:11:52.593

通常，您希望选择基于流的方法（即 getBlob().getBinaryStream() 或 getBinaryStream()）而不是字节数组方法。

1.  表现。驱动程序有机会从数据库中逐步提取字节。
2.  记忆。您不必一次加载所有字节，并且在一个连续的块中。

最坏的情况是数据库（或 JDBC 驱动程序）并不真正支持流式二进制数据，但使用流式方法仍然没有明显的损失。

# version-control - Team Foundation Server 在签入时也会丢失代码，就像 SourceSafe 一样

> ID：760785
> 
> 赞同：-2
> 
> 时间：2009-04-17T15:06:06.337
> 
> 标签：version-control, tfs, visual-sourcesafe

因此，我们让 Team Foundation Server 代替旧的 SourceSafe 运行了大约几个月，而我刚刚遇到了第一个严重后果。与 SourceSafe 经常发生的情况相同。

我签入一个文件，其内容仅部分到达存储库。其余的在途中丢失了。

这次我一个人在处理文件。所以其他同事没有临时签到。也没有报告冲突。大约一半的文件丢失了，这是我今天实施的所有内容，直到午餐时间。

它出什么问题了？它比 SourceSafe 贵得多。为什么它不能按比例更好地工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T02:46:14.563

当您在其中检查文件时，它会检查磁盘中的文件，而不是当前在 IDE 中显示的文件，因此如果您尚未保存更改，它将不会检查您的更改。

这与 msbuild 过程相同，这就是为什么在 VS 中构建之前可以选择保存文件的原因。这是因为编译器和源代码控制是从 IDE 调用的外部应用程序。

# c++ - 写入 std::string 是否合法？

> ID：760790
> 
> 赞同：14
> 
> 时间：2009-04-17T15:06:59.813
> 
> 标签：c++, string, standards

在 std::string 中，只有 const 成员可以像 c_str() 这样获取数据。但是，我可以通过获取对字符串第一个元素的引用，`operator[]`并且可以对其进行写入。

例如，如果我有功能：

```
void toupper(char *first,char *last_plus_one); 
```

我可以直接写入 vector 以获取指向第一个元素的指针：

```
vector<char> message // has "Some Message";
toupper(&message[0],&message[0]+message.size()); 
```

我可以用 std::string 做同样的事情吗？

```
string message="Some Message";
toupper(&message[0],&message[0]+message.size()); 
```

标准是否保证内存的位置实际上是线性的？IE：

```
&(*(message.begin()+n)) == &message[n] 
```

谢谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-17T15:31:13.250

Herb Sutter 有这个说法（[http://herbsutter.wordpress.com/2008/04/07/cringe-not-vectors-are-guaranteed-to-be-contiguous/#comment-483](http://herbsutter.wordpress.com/2008/04/07/cringe-not-vectors-are-guaranteed-to-be-contiguous/#comment-483)）：

> 当前的 ISO C++ 确实需要 &str[0] 提供一个指向连续字符串数据的指针（但不一定以 null 结尾！），因此无论如何，实现者没有太多余地来拥有非连续字符串。对于 C++0x，我们已经采用了 std::string 内容确实必须连续存储的保证。有关详细信息，请参阅[http://www.open-std.org/jtc1/sc22/wg21/docs/lwg-defects.html#530](http://www.open-std.org/jtc1/sc22/wg21/docs/lwg-defects.html#530)

Matt Austern 在参考文件（[http://www.open-std.org/jtc1/sc22/wg21/docs/lwg-defects.html#530](http://www.open-std.org/jtc1/sc22/wg21/docs/lwg-defects.html#530)）中也说过类似的话。

因此，您似乎可以假设，一旦您调用 str[0]，您确实会得到一个可修改的字符数组（但请注意，它不需要以空值终止）。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-04-17T15:08:21.650

std::string 需要使用新的 c++0x 标准进行连续存储。目前这是未定义的行为。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-17T15:47:40.917

是的，您可以修改字符串。

您也可以在使用迭代器的算法中使用它。

您不能以与 vector<> 相同的方式使用它，因为不能保证元素位于连续的内存位置（但是：很快就会成为您附近的标准）。

因此，如果您修改方法以使用迭代器而不是指针，它应该可以工作。由于迭代器的行为与指针非常相似，因此代码更改应该可以忽略不计。

```
template<typename I>
void toupper(I first,I last_plus_one)
{
    // Probably the same code as you had before.
}

{
     std::string  s("A long string With Camel Case");

     toupper(s.begin(),s.end());
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-17T17:15:43.623

正如已经指出的那样，可以在使用迭代器的算法中使用字符串；可以使用`std::transform`Ex 实现相同的情况：- 考虑将字符串 's' 转换为小写：

```
int (*pf)(int)=tolower; //lowercase
std::transform(s.begin(), s.end(), s.begin(), pf); 
```

问候，

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-04-17T15:11:10.770

我认为它给了你一个未定义的行为。使用 stringstream 写入，然后使用 str() 成员获取流的字符串。

# sql-server-2005 - 仅授予视图权限

> ID：760793
> 
> 赞同：3
> 
> 时间：2009-04-17T15:07:16.707
> 
> 标签：sql-server-2005, database-permissions

我的数据库中有一个用户，我想授予他只读一个视图的权限，仅此而已，没有表，什么都没有。

我怎样才能做到这一点？

非常感谢。

PS：我使用的是 MS SQL Server 2005

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-17T15:13:39.127

```
USE DB1;
GRANT SELECT ON OBJECT:: View1 TO JohnDoe;
GO 
```

有关授予权限的其他示例，请参阅[GRANT Object Permissions](http://msdn.microsoft.com/en-us/library/ms188371.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T15:12:20.503

试试这个：

```
GRANT SELECT ON whatever_your_view_is_called TO bob_or_whatever_his_name_is 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T15:40:47.733

使用 Enterprise Manager UI 或使用其他一些人发布的 SQL 代码非常简单。

我想补充的一件事是，您要避免在以后可能要锁定的任何对象上分配对 Public 角色的权限，因为您添加的每个新用户都将自动成为该角色的成员。

# linux - linux上机器之间的tcp/ip连接数有限制吗？

> ID：760819
> 
> 赞同：25
> 
> 时间：2009-04-17T15:13:02.013
> 
> 标签：linux, sockets, tcp

我有一个在 5 分钟内编写的非常简单的程序，它打开一个服务器套接字并循环请求并将发送给它的字节打印到屏幕上。

然后，我尝试对可以使用多少个连接进行基准测试，以尝试找出该程序可以支持多少并发用户。

在另一台机器上（它们之间的网络未饱和）我创建了一个简单的程序，该程序进入一个循环并连接到服务器机器并发送字节“hello world”。

当循环为 1000-3000 时，客户端完成发送所有请求。当循环超过 5000 时，它在完成前 X 个请求后开始超时。为什么是这样？我确保在循环中关闭我的套接字。

你只能在一定时间内创建这么多连接吗？

这个限制是否仅适用于同一台机器，我不必担心在生产中 5000 多个请求都来自不同的机器？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-04-17T15:16:02.600

有限制，是的。见`ulimit`。

您还需要考虑`TIMED_WAIT`状态。一旦 TCP 套接字关闭（默认情况下），端口将保持*占用*状态`TIMED_WAIT`2 分钟。该值是可调的。即使它们已关闭，这也会“使您无法使用套接字”。

跑去`netstat`看看这些`TIMED_WAIT`东西在起作用。

PS 的原因`TIMED_WAIT`是为了处理套接字关闭后数据包到达的情况。这可能是因为数据包延迟或另一方不知道套接字已关闭。这允许操作系统静默丢弃这些数据包，而不会“感染”不同的、不相关的套接字连接。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-17T15:29:14.673

在寻找最大性能时，您会遇到很多问题和潜在的瓶颈。运行一个简单的 hello world 测试不一定会找到所有这些。

可能的限制包括：

*   内核套接字限制：寻找`/proc/sys/net` 大量内核调整..
*   流程限制：查看`ulimit`其他人在此处所述
*   随着您的应用程序变得越来越复杂，它可能没有足够的 CPU 能力来跟上进入的连接数量。使用`top`来查看您的 CPU 是否已达到最大值
*   线程数？我对线程没有经验，但这可能与前面的项目一起发挥作用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T16:06:09.000

你的服务器是单线程的吗？如果是这样，您使用的是什么轮询/多路复用功能？

使用 select() 不能超出在编译时设置的硬编码最大文件描述符限制，这是没有希望的（通常是 256 或更多）。

poll() 更好，但您最终会遇到可伸缩性问题，因为每次循环都会有大量 FD 重新填充集合。

epoll() 应该可以很好地工作到您达到的其他一些限制。

10k 连接应该很容易实现。使用最近的（ish）2.6 内核。

您使用了多少台客户端计算机？你确定你没有达到客户端限制吗？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-12-28T14:53:39.693

快速回答是 2^16 个 TCP 端口，64K。

系统强加限制的问题是一个配置问题，在之前的评论中已经提到过。

对 TCP 的内部影响不是很清楚（对我来说）。每个端口的实例化都需要内存，进入列表并需要网络缓冲区来传输数据。

给定 64K TCP 会话，端口实例的开销在 32 位内核上可能是一个问题，但在 64 位内核上不是问题（这里很高兴接受更正）。具有 64K 会话的查找过程可能会稍微减慢速度，并且每个数据包都会进入计时器队列，这也可能会出现问题。传输中数据的存储理论上可以膨胀到窗口大小乘以端口（可能是 8 GB）。

连接速度问题（如上所述）可能就是您所看到的。TCP 通常需要时间来做事。但是，这不是必需的。TCP 连接、处理和断开连接可以非常有效地完成（检查 TCP 会话是如何创建和关闭的）。

有些系统每秒通过数十千兆比特，因此数据包级别的缩放应该没问题。

有些机器有大量的物理内存，所以看起来还不错。

系统的性能，如果仔细配置应该没问题。

事物的服务器端应该以类似的方式扩展。

我会担心诸如内存带宽之类的事情。

考虑一个您登录本地主机 10,000 次的实验。然后键入一个字符。通过用户空间的整个堆栈将参与每个角色。活动占用空间可能会超过数据缓存大小。运行大量内存会给 VM 系统带来压力。上下文切换的成本可能接近一秒！

这在各种其他线程中进行了讨论： [https ://serverfault.com/questions/69524/im-designing-a-system-to-handle-10000-tcp-connections-per-second-what-problems](https://serverfault.com/questions/69524/im-designing-a-system-to-handle-10000-tcp-connections-per-second-what-problems)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-17T15:16:42.393

您可能想查看 /etc/security/limits.conf

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-17T15:17:30.787

是的，限制是由内核设置的；查看 Stack Overflow 上的此线程以获取更多详细信息：[增加 linux 中 tcp/ip 连接的最大数量](https://stackoverflow.com/questions/410616/increasing-the-maximum-number-of-tcp-ip-connections-in-linux)

# wcf - WCF：如何获取主机 IP 或服务器名称

> ID：760820
> 
> 赞同：15
> 
> 时间：2009-04-17T15:13:10.983
> 
> 标签：wcf

我有一个通过 IIS 在多个 Web 服务器上托管的 WCF 服务。我有一个记录对数据库的调用的日志记录方法，我想记录调用正在哪个服务器上执行。

有谁知道如何获取正在执行 WCF 调用的主机服务器名称或 IP 地址？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-17T10:16:26.680

使用 Dns.GetHostName()，因为获取计算机名比获取主机 IP 要好得多。考虑当您的主机具有多个 IP 地址、具有虚拟网卡 (VMWare) 的情况。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-08-31T11:05:39.277

这对我们有用。确保您有对 System.ServiceModel 的引用。然后在您的服务方法中实现以下代码：

```
var context = System.ServiceModel.OperationContext.Current;

RemoteEndpointMessageProperty property = (RemoteEndpointMessageProperty)context.IncomingMessageProperties[RemoteEndpointMessageProperty.Name];

string externalIP = property.Address; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T15:15:36.140

Dns.GetHostName() 是我使用最多的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-11-22T12:58:35.060

```
Environment.MachineName 
```

确实如此

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-22T19:24:16.967

DNS 主机名不起作用，因为许多服务器有多个主机名，而您不知道调用了哪个服务。IIRC，IIS 可以根据指定的主机名调用不同的 Web 服务，这使事情变得更糟。如果您不运行单个实例，则使用 .Current 非常好，在这种情况下，您并不总是有一个非空上下文对象，以上所有情况都是我的情况。如果有人有更可靠的东西，请分享:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-05-05T10:48:53.417

您可以使用以下代码获取服务器（主机）的当前基地址。

```
using System.ServiceModel;

var baseAddress = OperationContext.Current.Host.BaseAddresses[0].Authority; 
```

# c# - subsonic.migrations 和 Oracle XE

> ID：760821
> 
> 赞同：0
> 
> 时间：2009-04-17T15:13:21.263
> 
> 标签：c#, oracle, subsonic, migration, oracle-xe

可能我做错了什么，但在这里：

我正在尝试在 OracleXE 版本 10.2.0.1.0 中使用 subsonic.migrations 创建数据库。我安装了 ODP v 10.2.0.2.20。

这是我的 app.config：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <configSections>
    <section name="SubSonicService" type="SubSonic.SubSonicSection, SubSonic" requirePermission="false"/>
  </configSections>

  <connectionStrings>
    <add name="test" connectionString="Data Source=XE; User Id=test; Password=test;"/>
  </connectionStrings>

  <SubSonicService defaultProvider="test">
    <providers>
      <clear/>
      <add name="test" type="SubSonic.OracleDataProvider, SubSonic" connectionStringName="test" generatedNamespace="testdb"/>
    </providers>
  </SubSonicService>

</configuration> 
```

这是我的第一次迁移：

```
public class Migration001_Init : Migration {

        public override void Up() {

            //Create the records table
            TableSchema.Table records = CreateTable("asdf");
            records.AddColumn("RecordName");
       }

        public override void Down() {
            DropTable("asdf");
        }
    } 
```

当我运行 sonic.exe 时，我得到了这个异常：

```
Setting ConfigPath: 'App.config'
Building configuration from D:\Users\carlucci\Documents\Visual Studio 2008\Projects\Wum\Wum.Migration\App.config
Adding connection to test
ERROR: Trying to execute migrate
Error Message: System.Data.OracleClient.OracleException: ORA-02253: especifica‡Æo de restri‡Æo nÆo permitida aqui

   at System.Data.OracleClient.OracleConnection.CheckError(OciErrorHandle errorHandle, Int32 rc)
   at System.Data.OracleClient.OracleCommand.Execute(OciStatementHandle statementHandle, CommandBehavior behavior, Boolean needRowid, OciRowidDescriptor& rowidDescriptor, ArrayList& resultParameterOrdinals)
   at System.Data.OracleClient.OracleCommand.ExecuteNonQueryInternal(Boolean needRowid, OciRowidDescriptor& rowidDescriptor)
   at System.Data.OracleClient.OracleCommand.ExecuteNonQuery()
   at SubSonic.OracleDataProvider.ExecuteQuery(QueryCommand qry) in D:\@SubSonic\SubSonic\SubSonic\DataProviders\OracleDataProvider.cs:line 350
   at SubSonic.DataService.ExecuteQuery(QueryCommand cmd) in D:\@SubSonic\SubSonic\SubSonic\DataProviders\DataService.cs:line 544
   at SubSonic.Migrations.Migrator.CreateSchemaInfo(String providerName) in D:\@SubSonic\SubSonic\SubSonic.Migrations\Migrator.cs:line 249
   at SubSonic.Migrations.Migrator.GetCurrentVersion(String providerName) in D:\@SubSonic\SubSonic\SubSonic.Migrations\Migrator.cs:line 232
   at SubSonic.Migrations.Migrator.Migrate(String providerName, String migrationDirectory, Nullable`1 toVersion) in D:\@SubSonic\SubSonic\SubSonic.Migrations\Migrator.cs:line 50
   at SubSonic.SubCommander.Program.Migrate() in D:\@SubSonic\SubSonic\SubCommander\Program.cs:line 264
   at SubSonic.SubCommander.Program.Main(String[] args) in D:\@SubSonic\SubSonic\SubCommander\Program.cs:line 90
Execution Time: 379ms 
```

我究竟做错了什么？

非常感谢您的帮助:)

安德烈·卡鲁奇

更新：正如 Anton 所指出的，问题是亚音速 OracleSqlGenerator。它正在尝试使用此 sql 创建模式表：

```
CREATE TABLE SubSonicSchemaInfo (
       version int NOT NULL CONSTRAINT DF_SubSonicSchemaInfo_version DEFAULT (0)
) 
```

这在甲骨文上不起作用。正确的 sql 是：

```
CREATE TABLE SubSonicSchemaInfo (
  version int DEFAULT (0),
  constraint DF_SubSonicSchemaInfo_version primary key (version)
) 
```

有趣的是，由于这是亚音速迁移执行的第一个 sql，所以没有人在 oracle 上测试过它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T15:27:35.643

只是一个疯狂的猜测（我不完全了解`CREATE TABLE`Oracle 的精确语法）：SubSonic 尝试创建一个“架构信息”表（请参阅[此](http://subsonicproject.googlecode.com/svn/trunk/SubSonic.Migrations/Migrator.cs)，搜索`private static void CreateSchemaInfo(string providerName)`），默认值为“0”。它在内部使用`OracleGenerator`基本上是[ANSIGenerator](https://forgesvn1.novell.com/svn/mojoportal/vendor/SubSonic/SqlQuery/SqlGenerators/ANSISqlGenerator.cs)，所以这可能是问题所在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T18:26:57.740

这是我的错。我没有 Oracle 的许可证，也不知道它是如何工作的。我试图做的（关于 SQL 生成）是有一个基类，它使用每个提供者可以根据需要调整的虚拟方法生成符合 ANSI 的 SQL（是的，我知道 - 但一个人可以梦想）。

Eric 和其他人（使用 Oracle）测试了大部分查询等 - 但你是对的 - 我们从来没有机会在 Oracle 上测试迁移。这是我的错，我承担责任。我需要花一些时间来了解 Oracle - 或者找到愿意在这里投入更多时间的提交者。

# javascript - 我将如何使用 jQuery 来获取页面的内容并将其呈现在 div 中？

> ID：760832
> 
> 赞同：0
> 
> 时间：2009-04-17T15:14:43.007
> 
> 标签：javascript, jquery

这是针对thise的一个问题：[Javascript AJAX function not working in IE?](https://stackoverflow.com/questions/760628/javascript-function-not-working-in-ie)

我需要 jQuery 来做这样的事情：

```
function render_message(id)
{
var xmlHttp;
  xmlHttp=new XMLHttpRequest();  
  xmlHttp.onreadystatechange=function()
    {
    if(xmlHttp.readyState==4)
      {
        document.getElementById('message').innerHTML=xmlHttp.responseText;
        document.getElementById('message').style.display='';
        }
    }
    var url="include/javascript/message.php";
    url=url+"?q="+id;
  xmlHttp.open("GET",url,true);
  xmlHttp.send(null);
} 
```

有人可以快速为我编写函数吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T15:21:00.950

[`load()`](http://docs.jquery.com/Ajax/load#urldatacallback)您可以为此使用方便的功能：

```
$('#message').load("include/javascript/message.php", {q: id}, function() {
    $(this).show();
}); 
```

回调函数假设`message`div 是隐藏的，并且您只希望它在请求完成后显示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T15:18:34.700

请参阅`$.ajax()`以检索页面和访问内容。 [文档在这里](http://docs.jquery.com/Ajax)。

然后使用 eg`$("#yourElementId").html( myHtmlContent )`替换 HTML。 [更多文档在这里](http://docs.jquery.com/Manipulation)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T15:23:41.443

使用 JQuery 的 $.load() 函数（[http://docs.jquery.com/Ajax/load](http://docs.jquery.com/Ajax/load)）：

```
$("#mydiv").load("a/url/here.html"); 
```

# javascript - jquery 需要在部分页面回发时重新绑定事件

> ID：760833
> 
> 赞同：8
> 
> 时间：2009-04-17T15:15:17.843
> 
> 标签：javascript, jquery, binding, postback

当我执行部分页面回发时，如何重新绑定我的事件 (jquery)？

我正在使用以下方式连接所有内容：

```
$(document).ready(function(){}; 
```

在部分页面回发后，我的事件没有触发。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-17T15:29:31.663

您可以点击[PageRequestManager](http://msdn.microsoft.com/en-us/library/bb383810.aspx) endRequestEvent：

```
Sys.WebForms.PageRequestManager.getInstance().add_endRequest(function(){}); 
```

或者，如果它是您尝试附加的控制事件，您可以使用 jQuery[实时事件](http://docs.jquery.com/Events/live#typefn)。

另一种选择是手动进行事件委托。这就是“现场”活动在幕后所做的事情。将事件处理程序附加到文档本身，然后如果事件的发送者是您期望的元素，则有条件地执行您的方法。

```
$(document).click(function(e){  
    if($(e.target).is(".collapseButton")){  
        $(this).find(".collapsePanel").slideToggle(500);  
    }  
}) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-17T15:27:31.963

我从'部分页面回发'猜测你在 Asp.net 土地上工作。

尝试使用

```
Sys.Application.add_load(function() { }); 
```

您应该仍然可以在该 func 中使用所有正常的 jQuery 内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T15:30:07.247

[在此处查看](http://docs.jquery.com/Events/live)jQuery 1.3 的“实时”功能。您可以将事件添加到未来元素以及页面上的当前元素。这可能会简化您需要编写的代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-23T17:43:15.350

最优雅的解决方案（使用 jQuery 2.x）是这样的：

使用“on”事件。确保将事件绑定到文档而不是元素本身！

代码示例：

```
$(document).on('click', 'div.messages', function () {
    console.log('click on div.messages');
    return false;
}); 
```

例如，将此代码放入 document.ready 中。

即使在 UpdatePanel 中更改或创建了 div.messages，这仍然有效。而且它永远不会一次发射两次或更多次。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T15:27:53.163

当您执行部分回发时，一些 DOM 元素会被替换，当然，新元素会丢失 jQuery 绑定。您可以使用 ScriptManager 类来注册将在部分回发完成后执行的脚本（看看[这里](https://stackoverflow.com/questions/545290/does-the-clientscriptmanager-work-when-called-in-a-partial-postback)）

# oop - 如何在没有 ORM 和嵌入式 SQL 的情况下设计 Java Web 应用程序

> ID：760834
> 
> 赞同：60
> 
> 时间：2009-04-17T15:15:29.153
> 
> 标签：oop, design-patterns, orm

编辑：原始标题：关于使用 ORM 的好处的问题。

我想将 ORM 用于学习目的，并尝试使用 nhibernate。我正在使用教程，然后我有一个真正的项目。我可以走“老路”或使用 ORM。我不确定我是否完全理解它的好处。一方面，我可以在代码中创建我的抽象，以便我可以更改我的数据库并独立于数据库。另一方面，如果我真的更改数据库列，我似乎必须更改所有代码。

为什么我的应用程序没有 ORM，更改我的数据库并更改我的代码，而不是更改我的数据库、orm 和代码？是他们的数据库结构没有太大变化吗？

我相信有真正的好处，因为 ORM 被很多人使用。我只是不确定我是否得到它。

谢谢你。

编辑：在教程中，他们有许多文件用于使 ORM 工作

[http://www.hibernate.org/362.html](http://www.hibernate.org/362.html)

在应用程序更改的情况下，仅仅说我有“适当的”抽象层似乎需要做很多额外的工作。因为我是新手，所以它看起来并不容易维护，而且看起来像是额外的工作，而不是更少。

编辑：这是一个老问题，我一直在回过头来。我想看看一个正确设计一个没有 ORM、不使用嵌入式 SQL 和不使用 .NET LINQ-to-SQL 的应用程序的示例，没有冒犯。我现在在 Java 世界中，我不知道如何继续。它是一个网络应用程序。没有 Spring，没有其他世俗的框架。JSP、JSTL、EL、HTML、JavaScript、CSS、Java、Tomcat。希望我没有遗漏任何东西。是的，我知道这是一个老问题。它仍然是相关的。

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2010-04-19T23:14:25.957

为什么，哦，为什么，这个行业如此沉迷于这个概念的灾难？之前的答案都没有充分解决@johnny 的担忧。它们都是半生不熟的挥手理由，完全避开了数据库程序员面临的具体问题。

@TheTXI 的回答是我在问同一个问题时得到的典型回答：分层。那应该是什么意思？为什么我*要*分离我的图层？或者，更重要的是，创建一个与关系层不同但又应该是该层的规范映射的附加层对我有什么好处？

此外，（@johhny 尚未回答的观点）这如何保护我们免受改变？如果数据库发生变化，ORM 层几乎肯定要效仿。事实上，在对象级别不对连接表建模的默认做法使情况变得更糟，因为当表不可避免地增长了一些额外的列时，您不仅向对象模型添加了一些额外的字段，而且还更改了它的拓扑和强制一堆代码重写！这对变革管理来说是一场灾难，也是一个典型的例子，说明了对关系的错误看法（认为它们代表对象）如何导致灾难。*如果您只是将关系数据库直接映射到编程语言中的一致概念（想想 LINQ-to-SQL，而不是*LINQ-to-EF），这根本不会发生。

这个领域最大的悬而未决的问题——房间里的大象——是：ORM 应该解决什么问题？并且不要说“对象关系阻抗不匹配”。这只是另一个挥手的离岸价。解释为什么会出现阻抗不匹配，以及为什么应该是数据库出现在语言中，而不是语言出现在数据库中。我的解释是，大多数编程语言在表达和处理关系数据方面都很糟糕，但这是一个正在逐渐消失的历史现实（LINQ-to-SQL 是朝这个方向迈出的第一步），而不是基本原则声音架构的基础。

ORM 变得如此复杂是有原因的，包括延迟加载、缓存、令人眼花缭乱的持久性和所有权语义等。还有一个原因是，尽管这些额外的敲击键盘，它们仍然无法有效地解决基本问题诸如“哪对成员共享多个组？”之类的问题。关系模型是在网络和层次模型在此类问题的重压下屈从于膝盖的时候构思的。这是一股新鲜空气。现在我们似乎都渴望回到满是猫尿的旧沙坑，我们认为我们已经发明了一些新东西（只要我们捂住鼻子）。

（我完全希望对这个答案投反对票。但是当你这样做时请发表评论。我不介意被告知我错了，只要我知道为什么。）

**编辑：**感谢@Chris 花时间发表评论。它给了我一些具体的要解决的问题...（请注意，虽然我经常在下面对@Chris 讲话，但我并不是要让他具体完成任务；他的回答是我在讨论主题。所以我希望他不要把我的批评当作个人的侮辱；他们不是故意的，我真的很感谢他花时间做出回应。）

首先，让我澄清@Chris 的评论和回答中明显的一些误解。

1.  出于所有显而易见的原因，以及一些不那么明显的原因，我不提倡在代码中使用原始 SQL（例如，SQL 既不是代数也不是微积分，这使得函数分解实际上是不可能的）。
2.  我不提倡单体应用程序设计。一般来说，图层是一件好事。
3.  我不提倡使用诸如特殊字段、方法和属性之类的大量线路噪声来污染对象模型。然而，坦率地说，这是一个稻草人，因为域/对象模型只存在于 ORM 世界中。现在，我知道 LINQ-to-SQL 有所有这些类，其中有很多嘈杂的部分，但它们只是幕后管道；您不编辑该代码，通常甚至不应该查看它。

现在对反对意见提出一些反对意见：

1.  应用程序可以独立于数据库构建的断言是没有根据的。总的来说，ORM 只是到数据层的规范映射（表 Foo 和 Bar 变成了类 Foo 和 Bar，表 FooBar 变成了类 Foo 和 Bar 之间的某种激烈的事情）。这个映射没有太多的回旋余地，因此对数据模型的任何更改几乎肯定需要对对象模型进行相应的更改。在我看来，这是一件好事，因为从根本上偏离相应数据库模型的对象对于所有相关人员来说只不过是额外的维护难题。
2.  一旦 ORM 产生数据模型独立性的幻想被抛弃，所有关于直接耦合到数据模型的弊端的抗议都变得毫无意义。但我想进一步研究这一点，而不是简单地忽略它。耦合是系统设计的基本特征。在某些时候，必须做出决定和假设。您不能使用单个“事物”表对所有内容进行编程。您必须确定您的域包含某些特定概念，然后创建尊重这些概念的模式和代码，将它们视为一等公民，对它们进行硬编码。*应用程序应该*的想法*独立于数据库是错误的。数据库是（或应该是）企业知识的最纯粹表示（我知道并非总是如此，我将在稍后解决这个问题）。耦合到这种表示应该提供最强大的弹性保证，因为这种数据模型只会在业务本身发生一些内在变化时才会改变。简而言之，耦合到设计良好的数据库模式是一件非常好的事情。*
**   分层本身并不是目的。这很好，因为它实现了一些特定的目标。前面的几点表明，以 ORM 的方式在数据库和应用程序之间进行分层对于实现弹性变化的真正目标既无效也没有必要。这是通过良好的数据库设计来实现的。*   @Chris 断言让数据库决定事情会阻碍 OO 设计。确实如此，但只有当面向对象设计是建模知识的最佳方式时才有意义。OODBMS 在市场上几乎完全失败表明情况并非如此。具有谓词逻辑基础的关系模型具有与面向对象设计相同的表达能力，而不会导致面向对象模型的图论复杂性。*   @Chris 反对关系模型，理由是它不能解决当今的问题（因此 NoSQL 运动）完全不合时宜。NoSQL 的意思是“没有 SQL”，而不是“没有关系模型”。不幸的是，即使是 NoSQL 运动的支持者在这方面似乎也毫无头绪。SQL 有很深的缺陷，其中许多可以追溯到它与关系模型的彻底背离。说我们应该放弃关系模型，因为 SQL 很烂，这是一个相当公然的把婴儿和洗澡水一起扔出去的例子。*   不使用 ORM 不会*使*构建应用程序的工作量增加三倍。这是一个可笑的说法，甚至@Chris 似乎也在对代码生成替代方案进行反面恭维。Codegen 工具（例如 LINQ-to-SQL 的 sqlmetal）对于那些不拘泥于应用程序数据模型绝对必须不同于数据库数据模型的教条的人来说是一个完美的解决方案。*

 *我自己使用 ORM 的经验是，它们在教程中表现出色，并在现实世界中造成无尽的痛苦和挫败感。随着 LINQ-to-SQL 解决了最初激发 ORM 的许多问题，我认为没有理由让自己经历这种折磨。

一个主要问题仍然存在：当前的 SQL 数据库对物理层和逻辑层的分离没有提供任何有意义的控制程度。从表到磁盘上的东西的映射在很大程度上是固定的，并且完全在 SQL DBMS 的控制之下。这不是关系模型计划的一部分，它明确地将两者分开，并允许定义数据的一致逻辑表示，这些数据可以以与逻辑模型建议的完全不同的结构存储在磁盘上。例如，出于性能原因，系统（或 dba）可以自由地对高度规范化的逻辑模型进行物理非规范化。因为 SQL 引擎不允许这种关注点分离，所以出于绝对必要性而对逻辑模型进行非规范化或以其他方式折磨是很常见的。因此，逻辑模型并不总是完全符合其应有的状态，因此无法完全实现将数据库用作最纯粹的知识表示的理想。然而，在实践中，无论如何，设计人员通常都坚持从数据库到域模型的规范映射，因为其他任何事情都太痛苦而无法维护。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2010-04-20T00:04:14.027

根据我使用 NHibernate 的经验，它有点像 Visual Basic：**它使简单的问题变得*非常*容易，但它也使比这更难的事情变得*非常*困难，甚至完全不可能。**

基本思想是 ORM 避免了编写持久性代码。这样的代码有很多重复，所以很容易使这些代码通用，而不是特定于特定的业务层，并在项目中重用它。到现在为止还挺好。对于简单的对象层次结构和业务需求，这实际上工作得很好。如果您的数据库发生更改，是的，您确实必须更改 ORM 映射文件，但这通常很简单，您只需在一个地方进行更改 - 比更改访问数据库的代码容易得多。

问题是随着您的数据库和需求变得越来越复杂，ORM 发现越来越难以跟上。所以 ORM 变得越来越复杂。它还走捷径，做一些事情效率低下，因为它不够聪明，无法弄清楚如何在*所有*情况下有效地完成它。更重要的是，因为整个想法是透明地工作，所以您通常看不到这些性能问题，直到它们变得严重到影响用户体验。一个相关的问题是 bug 更难找到，因为除非你调试它，否则你不知道 ORM 内部发生了什么。（是的，我不得不单步执行 NHibernate 代码，这不是野餐！）

因此，您开始在某些事情上绕过 ORM 并直接使用 SQL。当然，您必须使*该*代码与*使用*ORM 的代码一起工作，这需要更多的工作。您最终编写代码来手动加载和保存一些对象，并以某种方式将其工作到 ORM 代码中。最终，您开始怀疑 ORM 是否为您创造了比它节省的更多的工作 - 更不用说性能和寻找错误的问题了。

因此，如果您正在编写一个非常简单的应用程序，您可以在教程中找到那种应用程序，ORM 会做得很好。如果它比这更复杂，那么我认为它不值得。当然，对于一个简单的应用程序，节省的绝对时间也很少。我的结论是：不要打扰 ORM。**ORM 是通向黑暗面的道路。**

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2011-01-10T16:40:22.597

在阅读本文之前，我经常想知道是否有其他人真的很想了解 ORM 工具对项目的影响。@Evgeny、@Marcelo Cantos 和 @Jimmy B 让这一切安息。

简而言之，他们对围绕 ORM 工具的大多数问题都束手无策。只有一对他们没有覆盖或覆盖不够。

首先，使用 ORM 并不意味着更少的代码。这可能意味着更少的 SQL，但它肯定不意味着更少的代码。沿着这些思路，工具生成的代码可能是错误的。更糟糕的是，对生成的错误代码进行补偿是一种挫败感。

其次，ORM 工具并不意味着您不必了解 SQL。换一种说法，你必须知道 SQL 才能成为一个有效的程序员（也有像嵌入式程序员这样的例外）。从性能或资源的角度来看，这些工具发出的查询（类型和数量）还不够好。如果您已经必须了解 SQL，为什么还要束缚自己？

第三，ORM 工具不会节省时间。您将花费尽可能多（如果不是更多）时间来击败您选择的 ORM 工具以处理任何大小合适的应用程序。雪上加霜的是，当你完成后，你会发现查询的质量通常比你自己做的要差。重点是 ORM = 花在项目上的时间越多，结果越差。

第四，DBMS 的独立性通常是浪费时间。大多数应用程序将在其生命周期内只使用一个 DBMS；无论是 Oracle、SQL server、MySql 等等。如果能够利用 DBMS 提供的功能，应用程序将变得更好。与 DBMS 无关意味着您必须将自己限制为低于标准的查询。

第五，并非所有事物都必须是对象。这是需要注意的重要事项。我们经常被要求在页面上显示一组特定的数据。这通常意味着连接来自两个或多个表的数据。您的应用程序是否必须创建和实例化所有这些对象才能显示一些数据？或者您最好只执行查询并以您选择的格式将数据直接发送到屏幕/浏览器？

即使是最简单的事情，ORM 也会增加很多开销。大多数 ORM 将生成多个 sql 查询，甚至对表执行简单的 UPDATE。

第六，也是我心目中最重要的问题：ORM 会降低您的安全性。当然，您可以将 ORM 与 s'procs 一起使用；但大多数人没有。我见过的几乎每一个利用 ORM 的应用程序都以这样一种方式暴露了数据库，即如果网站被破解，整个数据库很*容易*被杀死或窃取。ORM 工具即时生成 SQL。这意味着他们需要直接访问表。这意味着，如果您的应用程序遭到入侵，黑客将可以直接访问表。这意味着您已经从应用程序中有效地移除了至少一层安全性。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2011-01-10T16:02:33.803

我意识到这个问题是不久前发布的，但我想知道和约翰尼一样的事情。我已经看到聪明人在几个大型项目中使用了 Hibernate，在每种情况下，这都是一场彻头彻尾的灾难。根据我的经验，大多数企业应用程序中最复杂和影响性能的区域是业务层和数据库层之间。这就是我们添加数据访问层以尝试将数据库交互封装到可管理的块中的部分原因。

我见过的使用 ORM 的最大论点是它们“减少了手写代码”并提供了一个抽象层，将业务逻辑与数据访问分开。我断言，除非在非常简单的情况下，否则这些在实践中都不正确。

为了使 Hibernate（和大多数其他 ORM 工具）工作，我们要么创建一个记录所有数据库和对象交互的 hibernate 映射文件，要么我们使用注释来记录相同的关系。在一种情况下，我们将代码移动到一个更难测试但同样复杂的 xml 配置文件中。另一方面，我们将如何与数据库交互的逻辑分布在整个域模型中。关键是，虽然我们编写了更少的实际“代码”，但将代码移动到配置文件或注释！=“更少的代码”。它只是将复杂性从我们可以直接控制和减轻它的代码转移到控制少得多的第三方工具。

应该将业务/域层与数据库层分开的 ORM 抽象层往往具有更微妙的效果来抵消这种“分离”。您见过多少项目，其中 ORM 层以一种被认为不太理想的方式影响对象模型和/或数据库的设计？用一个糟糕的物理类比，假设你的业务层、ORM 层和数据库层都有质量。仅在另一层之间存在 ORM 层往往会施加改变和扭曲其他层的力量。您是否必须引入一个不太适合您的业务模型的主键对象，因为 ORM 层需要它？您是否必须调整数据库结构以适应特别复杂的对象图模型，因为 ORM 工具不能 不处理吗？在极端情况下，ORM 层的存在可能会扭曲数据库交互应该如何工作的整个视角。代替处理持久对象图的服务层，它可以转变成为每个域对象创建单独的数据访问层对象，就好像它们孤立存在一样。我在不同程度上看到了所有这些情况。也许是对 ORM 工具集缺乏经验。也许这是一个糟糕的数据库结构。我对此表示怀疑。我所看到的一切都表明 ORM 解决方案不足。就好像他们孤立地生活一样。我在不同程度上看到了所有这些情况。也许是对 ORM 工具集缺乏经验。也许这是一个糟糕的数据库结构。我对此表示怀疑。我所看到的一切都表明 ORM 解决方案不足。就好像他们孤立地生活一样。我在不同程度上看到了所有这些情况。也许是对 ORM 工具集缺乏经验。也许这是一个糟糕的数据库结构。我对此表示怀疑。我所看到的一切都表明 ORM 解决方案不足。

如果您接受我的断言，即数据访问层是一种复杂性，极易出现性能瓶颈，我为什么要考虑添加一个无法实现其减少代码和分离目标的工具，同时对我的应用程序的其他层的结构？

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2010-04-19T23:43:03.003

我对@Marcelo Cantos 的回答做出了彻底的回应，但是我将总结使用 ORM 的主要好处。

## 持久性无知 (PI) 和域驱动设计 (DDD)

ORM 非常适合这两种整体设计模式。对于正确的面向对象设计，您将使用分层和多态对象来表达数据在应用程序中的流动方式。通过良好的设计，您将经常争取 POCO 对象（简单的旧 C/C# 对象，我已经看到了这个词的其他定义），因为如果我有一个拥有 List 的 Person，我应该拥有它。我不应该以某种方式强制使用我的应用程序的人员数据表和地址数据表。除此之外，我不需要将大量数据库特定逻辑绑定到我的对象，为什么我的人的 FirstName 字段需要具有类似`[ColumnName("First_Name")] [Length(255)] [DataType(Types.Nvarchar)]`或任何其他种类的疯狂属性或代码，这些属性或代码定义了强制存在多少数据库我的域名设计？

## 更少的手写代码

当您不再需要为应用程序中的每个对象编写 Select、Insert、Update 和 Delete 语句以将其保存到数据库中时，编写的代码行数就会大大减少。这使您只需要编写有意义的查询。此外，许多 ORM（如 NHibernate）将包含一种位于 SQL 之上的语言，该语言被更多地定义为与之交互，并且在语法上可以更少地填充箍。

最充分显示的时间是考虑一个应用程序，它有一个链接到每个对象的 UserTable，并且由于某种原因，您必须更改主键名称或类型。此时，您可能需要更改数据库中的每个存储过程，使用正确实施的 ORM 解决方案，您只需要更改一些配置映射（或可能不更改）即可完成。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-04-17T15:19:52.433

使用 ORM 工具的基本好处是便于将业务逻辑与多层应用程序中的数据访问分离。如果您可以成功构建一个响应数据库更改的数据访问层（通过更改映射），那么在进行更改时，您需要处理的整体代码就会减少。

层的分离通常是 3 层或 n 层应用程序的目标，而 ORM 是一种很好的方法。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-04-17T15:22:44.563

主要驱动力：管理/维护的整体代码更少

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-11-08T08:56:47.210

我还没有看到任何人解决的问题是 ORM 应该解决什么问题。ORM 应该解决的问题是应用程序端代码和数据库之间的断开连接以及开发人员花在数据库问题上的时间量。数据库和应用程序代码之间的断开是指必须运行应用程序才能意识到编写的代码引用了无效的列。ORM 应该弥补这一差距，使数据库、应用程序和数据一起移动的模型；我编译我知道代码不同步（假设我保持我的模型是最新的）。

我在从小型到大型企业应用程序的各种规模的项目中使用了 3 种不同的 ORM（EF、LINQ to SQL 和 N-Hibernate）。此外，我对使用 ADO.NET 并不陌生；DataReaders 和映射到类、DataSet 和各种生成工具。我在 3 种不同的 ORM 中看到了好的和坏的实现，并且没有 ORM 方法。我见过的大多数问题都可以追溯到反模式，而不是理解特定 ORM 的局限性。以下文章（[在 N 层应用程序中要避免的反模式](http://msdn.microsoft.com/en-us/magazine/dd882522.aspx)) 很好地突出了许多这些反模式。即使是最优秀的软件架构师、开发人员和最聪明的人，在他们发现设计模式或解决反模式所产生问题的某些设计原则的价值之前，也参与了他们的反模式。

不知道你的工具是另一个问题，因为这是性能问题的来源。很明显，许多人不确定动态 SQL 和存储过程在执行数据库逻辑（如 CRUD 操作）方面的性能差异。好吧，事实证明，动态命令与存储过程对应的命令一样有效。两者都有优点和缺点。关键是知道它们是什么并根据情况选择合适的选择。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-02-27T15:38:29.060

如果我从 ORM 中得到的只是让我免于维护存储过程的需要，那么这对我来说已经足够了。

然而，ORM 让我们摆脱了强加于代码设计的类似人质的数据库模式。当我可以像现实世界一样对代码进行建模时，事情就简单多了，而且我仍然可以使用（好的）ORM 来做到这一点，它有助于（并隐藏）将具有糟糕命名约定的潜在难看的遗留数据库映射到一个结构中意味着一些东西，而不关心到处都是这样的冗余代码：

```
using (SqlWrapper sql = SqlWrapper.Create(WrapperConnectionType.ShopNet, "sStore_InsertUpdate_v4"))
            {
                sql.AddParameter("StoreId", StoreId);
                sql.AddParameter("StoreName", StoreName);
                sql.AddParameter("Region", Region);
                sql.AddParameter("PostCode", PostCode);
                sql.AddParameter("Tel", Tel);
                sql.AddParameter("Email", Email);
                sql.AddParameter("RegionId", RegionId);
                sql.AddParameter("MapImage", MapImage);
                sql.AddParameter("ShopImage", ShopImage);
                sql.AddParameter("Visible", Visible ? 'Y' : 'N');
                sql.AddParameter("TazEnabled", TasEnabled ? 'Y' : 'N');
                sql.AddParameter("Latitude", Latitude);
                sql.AddParameter("Longitude", Longitude);
                sql.AddParameter("StoreOpeningDate", OpeningDate);
                sql.AddParameter("CustomerNo", CustomerNo);
                sql.AddParameter("ReserveAtStoreEnabled", RasEnabled);
                sql.AddParameter("OpeningHoursId", OpeningHours.Id);
                sql.AddParameter("AddressLine1", AddressLine1);
                sql.AddParameter("AddressLine2", AddressLine2);
                sql.AddParameter("City", City);
                sql.AddParameter("District", District);
                sql.AddParameter("County", County);
                sql.AddParameter("CountryCode", CountryCode);
                sql.AddParameter("GoogleCategories", GoogleCategories);
                sql.AddParameter("GooglePlacesEnabled", GooglePlacesEnabled);
                sql.AddParameter("ManagerName", ManagerName);
                sql.AddParameter("MapZoomLevel", MapZoomLevel);
                sql.AddParameter("IpAddress", IpAddress);
                sql.AddParameter("FlibbleEnabled", FlibbleEnabled);
                sql.AddParameter("RegionalManager", RegionalManagerId);
                sql.AddParameter("ShutlLogin", ShutlLogin);
                sql.AddParameter("ShutlPassword", ShutlPassword);
                sql.Execute();
            } 
```

并让我们根除（但不要忘记）这些类型的战斗：

```
System.IndexOutOfRangeException
at System.Data.SqlClient.SqlDataReader.GetOrdinal(String name) 
```

对我来说，论点不必比这更复杂，我得到了一些好东西，而一些可怕的东西被带走了。纳夫说，下一个！

没有人争辩说 ORM 可以 100% 替代传统的一切。它不是编写复杂报告的好工具，因为它使用 SP 和视图，并使用 NHibernate 本地调用它们并将它们自动映射到您的 c# 实体。很好，仍然具有 SQL 的所有功能，并且没有糟糕的映射代码。

0 和 1 的储存者进入黑暗，来到健康 c# weltanschauung 的光明中。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-17T15:50:33.547

您获得的 1 个优势是您的数据层与对象层分离，因此当您有多个依赖于该层的应用程序/项目时，您可以在 ORM 中更改一次，并且所有引用对象层的应用程序/项目都不必更改，如果没有它，您将不得不在所有项目中进行更改。

# http - Flex 3 - 从 Flash 发送 HTTP Get 请求并希望 Firefox 显示 Open With Box

> ID：760838
> 
> 赞同：1
> 
> 时间：2009-04-17T15:16:01.290
> 
> 标签：http, firefox, flex3

就 Flex 和 Flash 而言，我是一名新手开发人员。这就是我想要做的：

1) 向我们的服务器发送 HTTP 请求（使用自定义 URL）。URL 基本上告诉服务器以 CSV 格式发送数据。2）服务器发送200 OK响应，内容类型为：application/csv，payload为纯CSV数据。

我想要做的是，当 Firefox 得到这个 200 OK 响应时，我希望它显示标准的 Open with 框（当你下载一些文件时出现的那个）。

我尝试用 HTTPService 来做这件事。我在 Flash 组件上有一个“导出到 CSV”按钮。单击该按钮后，flash 组件能够成功发送 HTTP 请求。但是我不希望 Flash 组件处理响应，所以我没有定义“结果”标签。但什么也没有发生。有关如何执行此操作的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-17T16:43:07.960

您的服务器需要与文件一起发送标头：

```
Content-Disposition: attachment; filename=foo.csv 
```

编辑：让我们通过解释来澄清这一点：

当你这样做时：

```
navigateToURL(new URLRequest('foo.csv'), '_self'); 
```

您实际上是在间接要求*浏览器*获取 foo.csv。现在，为了让浏览器显示“保存”对话框，它需要知道数据应该被视为附件。标题：

```
Content-Disposition: attachment 
```

做到这一点。但通常你也想让浏览器知道文件名（和文件类型，通过扩展名），这就是为什么你在分号后面添加文件名位的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T15:21:43.723

您将需要 Flash 至少响应请求，然后调用 navigateToURL 转到您的文件，如下所示：

```
private function resultHandler(event:ResultEvent):void
{
    navigateToURL(new URLRequest('createdFile.csv','_self'));
} 
```

# database-design - MySQL 对统计数据进行大量“轮换”的想法？

> ID：760847
> 
> 赞同：4
> 
> 时间：2009-04-17T15:18:26.743
> 
> 标签：database-design

我有一个在线游戏，我记录了很多游戏统计数据。这些统计表很快就会变大，我必须小心，因为一旦表变得足够大，简单地记录更多的统计数据就会导致游戏的性能变得非常糟糕。

我的策略，这不是一个很好的策略，是保持统计表很小。我有一个自动进程，每 24 小时创建一个新表，以防止性能过于失控。但我的解决方案很丑陋，是一种统计表的“轮换”。我使用 innodb 并设置了几个索引来提高性能，然后我只保留了 30 个这样的表（每个表都是 24 小时，所以我节省了一个月的统计数据）。每隔 24 小时，我的自动化进程会删除“stats30”表，然后将所有编号的表重命名为更大的编号，然后创建一个新的空白表，简称为“stats”。这是“实时”表，其中正在积极记录统计数据。

这些表基本上记录了游戏中每个玩家和他们与之交互的每个其他玩家之间的每一笔交易，因此数据呈指数爆炸式增长。当发生新交易时，它会检查这两个玩家之间的交易在当天是否已经存在一行。如果有，它会使用对其事务的更改来更新该行。否则，它会创建一个新行。一对每天互动 1000 次的玩家和一对只互动一次的玩家在当天的表格中都只有一行。数据库上的每个操作都涉及一个 SELECT，然后是一个 UPDATE 或一个 INSERT，因此它在当前设计的读取和写入之间非常均匀。更广泛意义上的数据读取，即用于分析统计数据和多个玩家的情况非常罕见，相对于单个 SELECT、UPDATE 和 INSERT。每天创建大约 150,000 行。

我知道这可能会更好。我不能轻易减少我正在记录的数据量，但我担心 1.performance 和 2.simplicity。例如，我可以通过每 4 小时创建一个新表来进一步提高性能，但是我不得不处理 180 个表。相反，我可以只用一张桌子让它变得更简单，然后一切都戛然而止。

请注意，我确实需要更新这些表中的行，所以我不能使用 ARCHIVE 存储引擎之类的东西，但我只需要在“实时”统计表上插入或更新。

还有一个小问题，当每日轮换过程发生时，此时进入的任何查询都可能丢失。（如果它正在重命名所有表并创建一个新表，新条目可能会失败。）丢失一些插入不是一个大问题，但是不会发生此错误的解决方案，或者可以“原子地完成” “ 会更好。

感谢您提供任何可能有帮助的想法！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T16:27:24.160

每天有 150k 行，平均数是多少。一行的大小？这些行是否包含您可以通过仅保留引用来最小化的冗余数据？

一般来说，保持表较小总是一件好事，这样索引更新就会快速完成。此外，正如 Ben S 上面提到的，您的查询至少应该进行优化，以便无法访问缺少索引的列等。如果您已经使用 EXPLAIN 和 mysql 服务器的慢查询日志，您可以找到一些可能的问题启用它。

可以帮助您解决性能问题的一件事是 memcached 守护程序。使用它，您可以延迟对数据库的写入，从而消除一些压力，并且仍然不会受到脏缓存等的影响。尽管取决于您使用的应用程序框架（如果有的话），但需要一些工作才能将其实现到您的应用程序中。

出于存档和统计目的，我建议您查看 InfoBright ( [http://www.infobright.org/](http://www.infobright.org/)）。这是一个开源的 MySQL 替代品（基于 MySQL）。它的指定目的是成为数据仓库存储。不过，您可以将其用于各种大容量数据分析。它有一个非常好的压缩功能，在我们的例子中，它可以将大约 23TB 的原始数据减少到大约 1.2TB 的压缩数据。我想不用说查询压缩数据的特定行可能/将会很慢。但是对于统计数据来说，它非常快。因此，如果您不查询特定行，而是分析诸如“在 12 月 8 日到 2 月 9 日之间使用值 foo > bar 更新了多少行”，它将为您提供非常好的性能。事实上，当您使用数据库时，它会分析您的使用情况并创建一个知识网格，为您的特定查询优化其数据。

我想到的下一个问题是......如果它是您保留一天或几个小时的“唯一”统计/会话数据，那么关系数据库是否适合这项工作？在不知道您的应用程序的确切性质的情况下，我可以想象某种内存中的会话（例如，可能驻留在兵马俑集群中）编写事务日志并每隔一段时间提交其数据可能更适合。但正如我所说，这在很大程度上取决于您的应用程序的性质和相关数据的数量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T15:28:49.933

没有数据库专家，但是您是否尝试过使用不同的数据库引擎（innoDB 很慢，请尝试 myISAM）并确保您选择的数据已编入索引？

似乎是一个愚蠢的问题，但是，您拥有的解决方案非常疯狂

也试试这个： http: [//forums.mysql.com/read.php?24,92131,92131](http://forums.mysql.com/read.php?24,92131,92131)进行性能调整。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T15:31:27.757

首先要做的是分析您的应用程序，以找出实际花费最多的时间。如果另一个更改会提供更好的性能，那么继续这个表轮换是没有用的。

对所有查询运行[EXPLAIN](http://dev.mysql.com/doc/refman/5.0/en/explain.html)并确保您了解结果并[适当地优化您的查询](http://dev.mysql.com/doc/refman/5.0/en/using-explain.html)。

我还强烈建议您阅读《[优化 MySQL 参考手册》](http://dev.mysql.com/doc/refman/5.0/en/optimizing-the-server.html)。它提供了许多关于如何配置服务器以获得最佳性能的提示，并可能让您深入了解可能导致性能瓶颈的原因。

如果实时表的性能确实是问题，并且您需要减少该表中的行数，那么只需将行移动到存档表即可。这样，您始终拥有一张纤薄的现场餐桌。并且可以轻松地对存档运行更长时间的查询。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T15:32:59.533

我们在这里谈论多少行？百万？数十万？

既然你说你只需要更新实时表中的行，听起来你可能只需要两个表就可以做到这一点——一个实时统计表和一个 statsarchive 表。然后，您的批处理作业将定期将行从实时统计表移动到 stats_archive 表。另一项工作可以在归档表达到一定年龄后清除这些行。最好有第三个工作定期重新计算归档表的统计信息，以确保 MySQL 可以为您的查询生成良好的计划。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T15:42:14.847

我想更多地了解您的域名，以便给出更准确的答案。但简短的回答是，您需要某种基于月份、年份或地理的分区。因此，属于特定城市的用户的所有统计信息都将进入这些表格。通过这种方式，您的选择可以变得更快。

当然，通常关于添加索引的 yada yada...

告诉我更多，我也许可以帮助你...

# windows - 在 Emacs + Slime + Clojure + Windows 设置中，无法加载 clojure-auto

> ID：760868
> 
> 赞同：7
> 
> 时间：2009-04-17T15:24:40.317
> 
> 标签：windows, emacs, clojure, slime

我按照[这个非常有用的指南](http://dc.clj.fogus.me/index.php?title=Installing_Clojure_and_Slime_on_Windows)来设置这个开发环境。运行*emacs.bat*时，我在 Emacs 中收到以下错误：

> 文件错误：无法打开加载文件，clojure-auto

不幸的是，我对 Clojure 和 Emacs 都是全新的，所以任何帮助甚至弄清楚从哪里开始寻找都会有所帮助。

此外，作为旁注，指南中的最后一步是：

> 使用 emacs.bat 文件启动 Emacs。然后，只需输入“Mx slime”，REPL 就会出现，你就可以开始了。

根据 Emacs 文档，Mx 将是 Meta key + x。但是，Windows 中的 Meta 键尚不清楚。它谈到了控制，但那将是 C+x，所以我假设它是 Shift。我也试过M+！认为这是一个shell命令，但没有运气。也许有人可以在评论中确认。

**更新：**来自评论中的*dfa*：“meta is Alt”有效。谢谢你。

**更新：**来自 Rayne 的非常有用的信息：

> 如果您的 emacs 经验继续走错路，请不要放弃 Clojure。总是有 La Clojure for IDEA Clojure-dev for Eclipse 和我个人最喜欢的 Enclojure for NetBeans。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-17T16:13:41.337

与其按照指南进行操作，不如直接安装[ClojureBox](http://clojure.bighugh.com/)？这将为您设置一切。这是一个交钥匙 clojure + emacs 安装。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T15:39:39.187

问题很可能出在你告诉它闭包文件在哪里的 load-path 命令中。尝试将路径扩展为完整路径名，看看是否有帮助。

您也可以尝试设置您的 HOME 环境变量，我认为那里的代码依赖于它是 C:\clojure-dev

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-30T09:55:52.210

我[记录](http://tommih.blogspot.com/2009/08/emacs-clojure-and-windows.html)了自己将 Emacs 和最新的 Clojure 从 Git 存储库安装到 Windows Vista 中的经验。你可能会发现它很有用。不过，如果您对 Clojure 1.0.0 感到满意，您可以安装 Clojure Box。

# c# - List.ForEach 在技术上是否是 LINQ 的一部分？

> ID：760869
> 
> 赞同：10
> 
> 时间：2009-04-17T15:24:59.020
> 
> 标签：c#, linq

目前对我来说，LINQ 只是一个松散且无定形的概念云，通常与数据访问有关，但也与 lambda 表达式、委托、匿名函数和扩展方法相结合，它与字符串和集合操作有关，所以我想把它固定下来.

**当我编写以下代码时，我可以说我“使用 LINQ”吗？**

```
List<string> words = new List<string>() { "one", "two", "three" };
words.ForEach(word => Console.WriteLine(word.ToUpper())); 
```

例如，“ **ForEach** ”方法被广泛称为“LINQ 方法”，但它的主页位于**System.Collections.Generic.List**而不是**System.Linq**。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-17T15:30:17.057

它不是 LINQ 的一部分——它早在 LINQ 之前就存在于 .NET 2.0 中。它类似于 LINQ，但我不会说它是 LINQ 的一部分。

另一方面，如果您实现自己的`IEnumerable<T>`扩展方法`ForEach`（如在 MoreLINQ 中），*可以*将其视为非标准 LINQ 运算符......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-17T15:30:18.197

ForEach 不是 LINQ，它只是一个接受委托的方法。自 .NET 2.0 以来一直存在。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T15:34:16.363

Linq 的意思是“语言综合查询”。要真正“使用”linq，您需要一个类似这样的构造：

```
var result = from word in words
                 where word.Length < 5
                 select word; 
```

也就是说，linq 所依赖的*IEnumerable + 惰性求值 + lamdba 表达式 + 闭包*的系统本身就足以保证它自己的流行语。说你可以使用 lambda 表达式并没有真正削减它，imo。这个例子就是一个例子。您*可以*使用 linq，但为什么它同样好且更短：

```
var result = words.Where(w => w.Length < 5); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T15:31:52.310

接受委托并不能使其成为 LINQ。

Foreach 不是“LINQ”方法，它不是`Enumerable`or的成员`Queryable`，并且没有任何理解语法。

而且，最重要的是，它修改了源（列表），这不是 LINQ to Objects 所做的。

我会说“不”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T15:30:23.937

在您发布的示例中，您没有使用 LINQ。ForEach 方法只是一种很好的方法来遍历可枚举数据类型中的项目，而无需显式编写循环。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-04-17T15:27:51.727

如果您试图证明 LINQ 是一个简历关键字，那么可能不会。但是该功能是与其他 Linq 功能一起添加的，并且属于同一个功能系列，所以排序:)

# asp.net-mvc - Asp.Net MVC 和会话

> ID：760872
> 
> 赞同：20
> 
> 时间：2009-04-17T15:25:38.833
> 
> 标签：asp.net-mvc, session-state, session-variables

我想在 asp.net mvc 应用程序的不同步骤中构造一个对象，每个步骤都是一个不同的页面。您将在快速 Web.Forms 应用程序中存储在 Session 中的那种东西。

读到它，在我看来，Session 并不是很像 asp.net MVC 的东西。但是我真的想不出这种情况的其他替代方案，因为 TempData 和 ViewData 似乎也不适合，所以也许我错了。

当然，我可以将 4 个步骤放在一页中并显示/隐藏，但这不是我的问题所在。我想听听你对 MVC 中的 Session 的看法，如果它是解决这种多步骤问题的好方法，或者你倾向于以其他方式来做。

[这与 ASP.NET MVC 中](https://stackoverflow.com/questions/560084/session-variables-in-asp-net-mvc)的问题 Session variables 非常相似，只是我不是在寻找如何访问 Session，但如果这是解决此类问题的最佳方法，或者我在 Asp 中缺少更好的方法。网络 MVC。

提前致谢

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-17T16:23:38.630

Session 没有任何非 MVC，它是 Web 的重要组成部分，大多数网站都以某种方式使用它。你真的有两个主要选择。要么将对象存储在页面之间的数据库中（这意味着保存不完整的对象），要么将其放入会话中。两者都有优点和缺点。

在会话中，您不必将部分对象保存到数据库中，但如果用户离开或会话超时，您将丢失所有信息。它还可能导致每个用户占用更大的内存，并且当您进行扩展时，它会导致一些其他问题。（所有这些都可以使用负载均衡器或中央会话存储上的粘性会话来解决）。

数据库方式在很多方面都更好，但通常您不想将不完整的对象保存到数据库中，一种折衷方案是创建另一个表并将序列化的对象保存到该表中。它不会通过您的真实表，因此您不必在数据库约束上妥协。（您也可以将会话数据存储在数据库中，这基本上是做同样的事情）

最后，这是两种方式之间的判断电话，多年来我都使用过。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T16:30:31.127

您可以在带有 TempData 的视图之间传递它......但您必须保持通过后续视图传递它。它旨在供后续请求使用，但这并不是说您不能将临时数据传递给下一个请求，这也会将相同的数据放回临时数据中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T15:28:34.877

你试过`<%= Html.HiddenField(...) %>`吗？

# php - 在我的本地主机和我的域之间返回值的问题

> ID：760876
> 
> 赞同：0
> 
> 时间：2009-04-17T15:26:29.733
> 
> 标签：php, xampp, redhat

我的本地主机（xampp windows）和我的域（FC7 linux）之间有一个令人困惑的区别。我有一个包含很多数据库驱动选择列表的页面。更新时，这些值被传递到更新数据库并向用户确认的页面。（我正在直接监控我的数据库，这正在正确发生）

有一个菜单选项可以返回到输入页面。在我的 locahost 上选择此项将正确返回具有更新值的页面。在我的域上选择此项将返回具有原始值的页面（例如，php 脚本似乎未运行）。我必须刷新（调用查询）然后重新加载（将值加载到字段中）以获取要显示的新值。

迄今为止，我的经验是使用模板将 PHP 和 HTML 分开，所以我以前从未遇到过这个问题。我尝试了许多替代方案，但效果不大 - 有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T17:22:45.540

您得到的错误响应很可能来自缓存。

您可以使用[HTTP 标头查看器](http://www.rexswain.com/httpview.html)来找出您的服务器发送的缓存标头，或者您可以使用 Firefox 的[LiveHTTPHeaders](https://addons.mozilla.org/en-US/firefox/addon/3829)插件来确定。

您在寻找什么：

*   **Expires:**标头告诉浏览器在特定日期之前重新使用同一页面进行进一步的请求，而无需从服务器进行检查。**Cache-Control:标头中的****max-age=**部分也是如此。也就是说，如果您看到 Expires 标头或 max-age 部分，则浏览器可能会返回陈旧（过期）页面而无需返回服务器。

 **您的服务器或浏览器与服务器之间的代理服务器很可能会自动将此类缓存验证器添加到您的页面中，而您本地主机上的服务器却没有。如果是这样，您可以尝试删除它们。也许服务器管理员已经配置[了 mod_expires](http://httpd.apache.org/docs/2.0/mod/mod_expires.html)（你可以在 .htaccess 中覆盖它）。如果它是由您的浏览器和服务器之间的代理服务器引起的，您可能没有太多选择。

其他一些有趣的事情：

*   如果某个操作更改服务器上的某些内容很重要，那么您应该使用 POST 请求而不是 GET 请求。对 POST 请求的响应永远不会被缓存（尽管，如果您执行[Post-Redirect-Get](http://en.wikipedia.org/wiki/Post/Redirect/Get)，那么它之后的 get 可能是，但那是另一回事了）。
*   请注意，当您在“localhost”访问某些内容时，与在任何其他域访问它相比，您的浏览器缓存的行为可能会有所不同，即使服务器配置相同并发送相同的标头也是如此。至少 Firefox 是这种情况（我自己见过）。IE 也有不同的安全区域，这可能会影响缓存，使其在 localhost 上的行为有所不同。
*   您可以强制您的服务器输出一个**Cache-Control: no-cache**标头和一个**Pragma: no-cache**标头。这可以在 PHP 中通过两次调用 header() 函数来完成。虽然浏览器和代理不应该默认为在没有给出验证器时可以返回陈旧结果的行为，但这至少明确表明您绝对不希望缓存某些内容。

另请注意，如果您通过代理服务器访问 Web，这也可能会影响某些事情，包括您收到的缓存标头。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T15:33:33.477

刷新，然后重新加载？是否存在将数据加载到选择框中的页面交互？

听起来这里存在浏览器缓存问题，或者加载数据的顺序不寻常，但我们需要更多细节来了解如何复制它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T07:31:42.337

我一直在进一步研究这个。事实证明，仅当通过我的工作互联网提供商访问该站点时才会出现此缓存问题！（如果我从家里或通过其他提供商访问它就可以了）。

**对我的原始帖子稍作更正**我必须 (1) 重新加载页面 (2) 保留 URL

# .net - 如何检测应用程序是否从 VisualStudio 启动？

> ID：760879
> 
> 赞同：0
> 
> 时间：2009-04-17T15:27:31.650
> 
> 标签：.net, visual-studio, winforms

我有一个快速的问题。是否有任何简单的方法来检测 .net 2.0/3.x winforms 应用程序是否从 Visual Studio 运行（在任何配置调试/发布/自定义中）？

最好的问候，托马斯。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T15:29:15.220

我对此并不完全确定，但我认为即使在发布配置中[Debugger.IsAttached](http://msdn.microsoft.com/en-us/library/system.diagnostics.debugger.isattached.aspx)也是如此。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-17T15:32:25.540

我不完全确定你的意思。看来您可能会问以下问题之一

## 确定我的应用程序是否已启动以从 Visual Studio 进行调试

对于这种情况，只要启用托管进程，只需查找 vshost.exe 为进程名称的后缀即可。

```
var isVsDebugLaunched = Process.GetCurrentProcess().ProcessName.EndsWith("vshost.exe") 
```

## 确定 Visual Studio 是否以任何形式或形式启动了我的进程。

为此，您需要查看给定进程的父进程。我不确定是否有通过 BCL 在托管代码中执行此操作的好方法（仍在寻找）。

# deployment - 用多个同名文件打包一个vb6项目

> ID：760884
> 
> 赞同：1
> 
> 时间：2009-04-17T15:28:31.337
> 
> 标签：deployment, vb6, packaging

我正在使用打包和部署向导打包一个 VB6 项目。但是，我最近添加了一个依赖于 XML 数据文件目录的第三方库。这些文件被拆分为子目录，其中一些子目录包含与其他子目录中的文件同名的文件，但它们是不同的文件。我无法更改文件的名称，因为第三方库需要特定的名称和特定的目录结构。打包和分解向导不允许我添加同名文件。这个问题的建议解决方案是什么？我不在乎它是在打包和部署向导中还是使用不同的打包解决方案，只要它可靠并且最好是免费的。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T16:37:21.077

尝试使用 MS，Visual Studio 安装程序的替代品。它支持 VB6 项目，创建 MSI 文件，我相信它没有与 PDW 相同的限制。

这是一个旧的下载，从那时起它在 MS 网站上的位置发生了变化，但我认为是[这个](http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=5fbbc453-cd04-4562-a66e-5c21436e6f56)。

[使用说明（devx.com 通过谷歌）](http://www.devx.com/vb2themax/Article/19893)

[来自 MSDN 的参考](http://msdn.microsoft.com/en-us/library/aa244938(VS.60).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T19:16:52.160

我最喜欢的安装程序是 InnoSetup - 它是免费的并且非常强大：

[http://www.jrsoftware.org/isinfo.php](http://www.jrsoftware.org/isinfo.php)

这里有一个关于安装VB系统文件的页面：

[http://www.jrsoftware.org/iskb.php?vb](http://www.jrsoftware.org/iskb.php?vb)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T17:17:44.037

我会第二个亚历克斯，

在过去的 5 年里，我一直在将 Inno 用于 VB6 项目。

除此之外，我建议使用 Istool，它是 Inno 的附加组件。您可以导入 VB6 打包和部署创建的 .lst 文件，它将为您创建 Inno 安装。从这里可以轻松添加文件并将安装更改为您的要求。 [http://hubpages.com/hub/ISTOOL](http://hubpages.com/hub/ISTOOL)

# iphone - iPhone/Cocoa：NSPredicate 正则表达式替换？

> ID：760902
> 
> 赞同：2
> 
> 时间：2009-04-17T15:31:43.047
> 
> 标签：iphone, regex, cocoa

根据[本指南](http://developer.apple.com/documentation/Cocoa/Conceptual/Predicates/Articles/pUsing.html#//apple_ref/doc/uid/TP40001794-SW9)，我可以使用 NSPredicate 对字符串进行正则表达式匹配，即 perl 等价于`$my_string =~ m/[some regex]/`

但是我可以做正则表达式替换，即相当于这个 perl 表达式：`$my_string =~ s/[pattern]/[replacement]/g`？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-17T17:23:30.843

[Google Toolbox for Mac](http://code.google.com/p/google-toolbox-for-mac/)有一些有用的正则表达式功能。它适用于 iPhone。看看[GTMRegex.h](http://code.google.com/p/google-toolbox-for-mac/source/browse/trunk/Foundation/GTMRegex.h)。NSString 上有一个使用此方法的类别：

```
- (NSString *)gtm_stringByReplacingMatchesOfPattern:(NSString *)pattern withReplacement:(NSString *)replacementPattern; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-18T04:48:04.130

我发现的最简单的解决方案是 RegexKitLite：

[http://regexkit.sourceforge.net/](http://regexkit.sourceforge.net/)

（注意“精简版”是您用于 iPhone 的版本）

只需将两个文件添加到项目中，以及链接器的 -licucore 标志。它使用内置的正则表达式功能。

它具有 NSString 扩展，包括用于替换的扩展，还可以按数字提取多个匹配项。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-17T15:58:59.250

此功能在 Cocoa 中本机不可用，但您可以使用[此处](http://cocoacast.com/?q=node/87)描述的标准 c regex.h 函数（大约在页面下方的四分之三处）。

还有一个名为[ObjPCRE](http://mohrt.blogspot.com/2009/03/perl-compatible-regular-expressions.html)的开源库可以解决问题。

[有人能够使用 JavascriptCore](http://parmanoir.com/Cocoa_Regular_Expressions_via_JavascriptCore)使其工作。

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-07-11T20:46:36.893

在 iOS 4.0+ 和 Mac OS X 10.7+ 中，您可以使用`NSRegularExpression`

# windows - 如何监视 Windows 目录的更改？

> ID：760904
> 
> 赞同：35
> 
> 时间：2009-04-17T15:32:11.093
> 
> 标签：windows, directory, monitoring

当在 Windows 系统上的目录中进行更改时，我需要一个程序来立即通知更改。

发生更改时是否有某种执行程序的方法？

我不是 C/C++/.NET 程序员，所以如果我可以设置一些东西以便更改可以触发批处理文件，那将是理想的。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-17T15:39:12.653

使用如下所示的[FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)创建 WatcherCreated Event()。

我用它创建了一个 Windows 服务，它监视一个网络文件夹，然后在新文件到达时向指定的组发送电子邮件。

```
 // Declare a new FILESYSTEMWATCHER
    protected FileSystemWatcher watcher;
    string pathToFolder = @"YourDesired Path Here";

    // Initialize the New FILESYSTEMWATCHER
    watcher = new FileSystemWatcher {Path = pathToFolder, IncludeSubdirectories = true, Filter = "*.*"};
    watcher.EnableRaisingEvents = true;
    watcher.Created += new FileSystemEventHandler(WatcherCreated);

    void WatcherCreated(object source , FileSystemEventArgs e)
    {
      //Code goes here for when a new file is detected
    } 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-13T04:35:51.533

FileSystemWatcher 是正确的答案，只是它曾经是 FileSystemWatcher 一次只能用于“少数”更改。那是因为操作系统缓冲区。实际上，每当复制许多小文件时，保存已更改文件的文件名的缓冲区就会溢出。这个缓冲区并不是真正跟踪最近更改的正确方法，因为当缓冲区已满时操作系统必须停止写入以防止溢出。

相反，Microsoft 提供了其他工具（编辑：如更改日志）来真正捕获所有更改。这本质上是备份系统使用的设施，并且在记录的事件上很复杂。而且记录也很差。

一个简单的测试是生成大量的小文件，看看它们是否都被 FileSystemWatcher 报告。如果您有问题，我建议回避整个问题并定期扫描文件系统以查找更改。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-17T15:36:58.523

如果您想要一些非程序化的东西，请尝试[GiPo@FileUtilities](http://4sysops.com/archives/free-gipofileutilities-monitor-directory-changes-mount-folders-and-more/) ...但在这种情况下，问题不属于这里！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-17T15:35:01.837

使用[FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-10-07T07:03:46.330

这个问题对我理解 File Watcher System 有很大帮助。我实现了[ReadDirectoryChangesW](http://msdn.microsoft.com/en-us/library/aa365465.aspx)来监视目录及其所有子目录并获取有关这些目录中更改的信息。

我已经写了一篇博客文章，我想分享它，这样它可以帮助那些在这里遇到同样问题的人。

[Win32 File Watcher Api 监控目录变化](http://developersarea.wordpress.com/2014/09/26/win32-file-watcher-api-to-monitor-directory-changes/)。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-12-16T19:35:20.443

我在寻找监视文件系统活动的方法时来到了这个页面。我接受了 Refracted Paladin 的帖子和他分享的[FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx) ，并编写了一个快速而简单的 C# 实现：

```
using System;
using System.IO;

namespace Folderwatch
{
    class Program
    {
        static void Main(string[] args)
        {

            //Based on http://stackoverflow.com/questions/760904/how-can-i-monitor-a-windows-directory-for-changes/27512511#27512511
            //and http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx

            string pathToFolder = string.Empty;
            string filterPath = string.Empty;
            const string USAGE = "USAGE: Folderwatch.exe PATH FILTER \n\n e.g.:\n\n Folderwatch.exe c:\\windows *.dll";

            try
            {
                pathToFolder = args[0];

            }
            catch (Exception)
            {
                Console.WriteLine("Invalid path!");
                Console.WriteLine(USAGE);
                return;
            }

            try
            {
                filterPath = args[1];
            }
            catch (Exception)
            {
                Console.WriteLine("Invalid filter!");
                Console.WriteLine(USAGE);
                return;

            }

            FileSystemWatcher watcher = new FileSystemWatcher();

            watcher.Path = pathToFolder;
            watcher.Filter = filterPath;

            watcher.NotifyFilter = NotifyFilters.Attributes | NotifyFilters.CreationTime | 
                NotifyFilters.DirectoryName | NotifyFilters.FileName | NotifyFilters.LastAccess | 
                NotifyFilters.LastWrite | NotifyFilters.Security | NotifyFilters.Size;

            // Add event handlers.
            watcher.Changed += new FileSystemEventHandler(OnChanged);
            watcher.Created += new FileSystemEventHandler(OnChanged);
            watcher.Deleted += new FileSystemEventHandler(OnChanged);
            watcher.Renamed += new RenamedEventHandler(OnRenamed);

            // Begin watching.
            watcher.EnableRaisingEvents = true;

            // Wait for the user to quit the program.
            Console.WriteLine("Monitoring File System Activity on {0}.", pathToFolder);
            Console.WriteLine("Press \'q\' to quit the sample.");
            while (Console.Read() != 'q') ;

        }

        // Define the event handlers. 
        private static void OnChanged(object source, FileSystemEventArgs e)
        {
            // Specify what is done when a file is changed, created, or deleted.
            Console.WriteLine("File: " + e.FullPath + " " + e.ChangeType);
        }

        private static void OnRenamed(object source, RenamedEventArgs e)
        {
            // Specify what is done when a file is renamed.
            Console.WriteLine("File: {0} renamed to {1}", e.OldFullPath, e.FullPath);
        }
    }
} 
```

要使用它，请下载 Visual Studio（Express 即可）。创建一个名为 Folderwatch 的新 C# 控制台应用程序，并将我的代码复制并粘贴到您的 Program.cs 中。

作为替代方案，您可以使用 Sys Internals Process Monitor：[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx) 它可以监控文件系统等等。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-17T15:40:21.480

Windows 附带没有实用程序或程序来执行此操作。需要一些编程。

如另一个答案所述，.NET[`FileSystemWatcher`](http://msdn.microsoft.com/library/system.io.filesystemwatcher.aspx)是最简单的方法。

本机 API [ReadDirectoryChangesW](http://msdn.microsoft.com/en-us/library/aa365465.aspx)更难使用（需要了解完成端口）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-04-26T17:28:50.067

在按照此处的指示搜索 github 几个小时后`FileSystemWatcher`，我发现以下页面有几个但相似的替代方案来处理`FileSystemWatcher`'s 的缺点（在一些答案中也提到了）：

[https://github.com/theXappy/FileSystemWatcherAlts](https://github.com/theXappy/FileSystemWatcherAlts)

一个比较表，说明哪种替代方案在每种情况下效果更好，底部的一般经验法则解释了在哪种情况下使用哪种替代方案：

[https://github.com/theXappy/FileSystemWatcherAlts/blob/master/AltComparison.md](https://github.com/theXappy/FileSystemWatcherAlts/blob/master/AltComparison.md)

它很容易实现或修改。如果您的项目已经在使用`FileSytemWatcher`，您可以简单地更改它：

```
FileSystemWatcher sysMonitor = new FileSystemWatcher(@"C:\"); 
```

对这些中的任何一个：

```
IFileSystemWatcher sysMonitor = new FileSystemRefreshableWatcher(@"C:\");
IFileSystemWatcher sysMonitor = new FileSystemAutoRefreshingWatcher(@"C:\");
IFileSystemWatcher sysMonitor = new FileSystemPoller(pollingInterval: 500,path: @"C:\");
IFileSystemWatcher sysMonitor = new FileSystemOverseer(pollingInterval: 500, path: @"C:\"); 
```

# .net - .Net 的数据导入向导库？

> ID：760910
> 
> 赞同：2
> 
> 时间：2009-04-17T15:33:29.280
> 
> 标签：.net, import, wizard

有谁知道可以嵌入到应用程序中的 3rd 方数据导入向导？它应该从 Excel、Access、SQLServer、csv、制表符分隔的平面文件、XML、Oracle 等导入。我们的应用程序中有一个固定的数据结构，用户应该能够配置向导以匹配他/她的导入字段我们自己的数据结构。

该向导应该是一个库——最好是一个 .Net 类型库。我们可能希望它既基于 Web 又基于桌面（因此我们可能需要一个 ASP.Net 控件版本和一个 Winforms 版本）。我们可能还希望与 WPF 和 Silverlight 集成。

如果没有可用的 UI 向导，是否有人知道支持从许多不同数据源轻松配置导入的非 UI 库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-17T15:57:55.807

如果您可以假设您的应用程序具有可用的 SQL Server，那么以编程方式设置 SSIS 包来执行此类转换是相当简单的。您的应用程序将提供一个 UI，您可以在其中设置数据源的元数据并将其映射到目标。您甚至可以只使用 BIDS 本身中的 SSIS 包编辑器来完成这项工作，并在您的应用程序中加入一个工具来执行包。

如果您无法使用 SSIS，那么您将不得不购买一些商业产品——我不知道有任何成熟的基于开源 .Net 的此类 ETL 工具。

如果您并不严格需要基于 .Net 的工具链（例如，您的应用程序可能只是外壳到外部可执行文件），那么有这种类型的开源工具，主要是用 Java 编写的。看看[Jasper](http://www.jaspersoft.com)或[Pentaho 等各种开源 BI 供应商提供的产品。](http://www.pentaho.com)

另一种选择可能是将诸如 Python 之类的脚本语言解释器嵌入到您的系统中（查看[IronPython](http://www.codeplex.com/Wiki/View.aspx?ProjectName=IronPython) - 基于 .net 的 python 系统）。这些语言有各种各样的库工具来读取各种类型的文件。该语言可以用作应用程序的宏工具，并且可以通过这种机制实现数据导入。这是以某种技术为代价的，因此这将由支持人员完成，而不是直接由最终用户完成。根据您的应用程序的客户群和其他实施成本，这可能会或可能不会被接受。

# asp.net - Page.IsPostBack 和 Page.IsCallBack 有什么区别？

> ID：760912
> 
> 赞同：44
> 
> 时间：2009-04-17T15:33:45.210
> 
> 标签：asp.net, postback, callback, page-lifecycle

我最近遇到了一些检查代码，`Page.IsCallBack`但我不确定它与`Page.IsPostBack`. 任何人都可以启发我吗？

**编辑**：它们是互斥的还是在给定的情况下可以同时发生？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-04-17T15:35:32.397

**Page.IsCallBack**

> 它正在获取一个值，该值指示页面请求是否是回调的结果。它是一个特殊的回发，所以总是会发生往返；但是，与经典回发不同，脚本回调不会重绘整个页面。*ViewState*在回调期间不会更新，它用于回发。

**Page.IsPostBack**

> 检查页面是否是第一次访问服务器。与 IsCallBack 不同，ViewState 是更新的

有关显示说明**事件顺序的**图表的更多详细信息，请参阅[页面生命周期](http://edndoc.esri.com/arcobjects/9.2/net_server_doc/developer/adf/pagepost_clientcall.htm)

 ****编辑 -**回答您的新问题

> Page.IsPostback 属性将为两种请求类型返回 true。只有当请求是客户端回调时，Page.IsCallback 属性才会返回 true

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-04-17T15:36:46.543

[`IsPostBack`](http://msdn.microsoft.com/en-us/library/system.web.ui.page.ispostback.aspx)当页面通过表单方法发布时为真

[`IsCallBack`](http://forums.asp.net/p/1007585/1339737.aspx)当页面已从 AJAX 调用回调时为真。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-17T15:36:42.517

回调是一种特殊的回发，因此总是会发生往返；但是，与经典回发不同，脚本回调不会重绘整个页面。ViewState 在回调期间不会更新，它用于回发。

更多信息[在这里](http://geekswithblogs.net/AaronLi/archive/2007/04/20/111817.aspx)：

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-17T15:37:27.307

回发是指通过单击提交按钮或通过 Javascript（如 AutoPostback 控件）将表单回发回自身

回调是 AJAX 控件调用页面上的方法作为 ajax 请求的一部分

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-04T15:20:27.030

Page.IsPostBack 检查页面是否是第一次访问服务器。与 IsCallBack 不同，ViewState 是更新的

# .net - 升级的 .NET 应用程序上的 ClickOnce 部署错误

> ID：760920
> 
> 赞同：2
> 
> 时间：2009-04-17T15:35:34.283
> 
> 标签：.net, .net-3.5, deployment, clickonce

我有一个在 Visual Studio 2005 中开发并通过 ClickOnce 部署到 IIS 服务器的 Windows 窗体应用程序。我已经升级到 VS2008，所以我决定升级并重新部署应用程序（在测试中）。我运行了升级向导，手动将项目的目标运行时更改为 3.5，从部署服务器中删除了所有旧的发布文件，并发布了应用程序。

我可以毫无问题地启动它（即“在我的机器上工作”），但是当其他人启动它时，他们会得到一个错误。

> 无法继续。应用程序格式不正确。请联系应用程序供应商寻求帮助。

错误对话框上有一个详细信息... 按钮。以下是其中的一些内容。

```
PLATFORM VERSION INFO
Windows             : 5.1.2600.131072 (Win32NT)
Common Language Runtime     : 2.0.50727.1433
System.Deployment.dll       : 2.0.50727.1433 (REDBITS.050727-1400)
mscorwks.dll            : 2.0.50727.1433 (REDBITS.050727-1400)
dfdll.dll           : 2.0.50727.1433 (REDBITS.050727-1400)
dfshim.dll          : 2.0.50727.1433 (REDBITS.050727-1400) 
```

请注意，CLR 是 2.0。

```
ERROR SUMMARY
Below is a summary of the errors, details of these errors are listed later in the log.
* Activation of http://{deployment host name}/ resulted in exception. Following failure messages were detected:
    + Exception reading manifest from http://{deployment host name}/{application name}.application: the manifest may not be valid or the file could not be opened.
    + Manifest XML signature is not valid.
    + No signature was present in the subject. 
```

我没有签署申请。这是一个完全内部的部门应用程序。我怀疑问题不在于缺少签名，而是.NET 使用了错误的运行时，并且 2.0 运行时无法处理 3.5 清单。但如果是这样的话，我不知道如何让它使用 3.5 运行时。

我想可能是旧版本被缓存了，所以我让用户运行`rundll32 %windir%\system32\dfshim.dll CleanOnlineAppCache`. 这清除了缓存（应用程序下一次完全重新加载），但它没有解决问题。

将 ClickOnce 应用程序从 2.0 升级到 3.5 是否有人遇到过这样的问题？知道我的问题可能是什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T12:55:03.787

请确认您已将 .NET Framework 3.5 设置为先决条件。

项目设置 -> 发布 -> 先决条件

# cocoa-touch - 子视图运行但不显示

> ID：760922
> 
> 赞同：0
> 
> 时间：2009-04-17T15:36:38.680
> 
> 标签：cocoa-touch, uiview, uiviewcontroller

从绑定到 UIView（在 nib 文件中绘制）的 UIViewController 开始，我尝试添加另一个视图，作为第一个视图的子视图。

如果您感到困惑：UIViewController -> UIView + GraphView（扩展 UIView）

所以我说：

```
GraphView *myGraphView = [[GraphView alloc] init];
graphView = myGraphView;
[self.view addSubview:graphView];
[myGraphView release]; 
```

我也试过了`insertSubview`。

UIView 出现并且 GraphView 子视图被正确实例化（它的属性在那里，我可以访问它的方法）。但它从不显示在屏幕上！ **它的`drawRect`方法永远不会被调用**（我有一个`NSLog`从不显示的方法），即使我手动调用`[graphView setNeedsDisplay]`.

有人有线索吗？

非常感谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-19T23:36:11.367

看起来您没有设置 GraphView 框架矩形，如果它不在屏幕上，它将不会显示。`initWithFrame:`另外，如果您不是，您可能应该调用 UIView初始化程序。

# ruby-on-rails - 如何将 URL 中的 ID 传递到 Ruby 中的 form_tag 中？

> ID：760928
> 
> 赞同：0
> 
> 时间：2009-04-17T15:38:20.017
> 
> 标签：ruby-on-rails

我有一个动作，它将通过link_to 包含供应商类的.id。

该操作是对不同控制器的评论的 new() 的修改，需要将来自 URL 和 session[:user_id] 的 ID 值传递到数据库中。

*   如何获取 vendor.id 的值？是否可以不通过 URL 传递它并将其放在闪存中？

*   是否使用隐藏值来传递 session[:user_id]？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T15:43:51.393

我假设您可以`params[:id]`从控制器操作中访问它？如果是这样，您应该能够像`params[:id]`在视图中一样访问它。同上`session[:user_id]`。

**编辑**：我想我可能误解了你的问题。您是在询问有关通过表单发回 id 的问题吗？或者可能在 url 中没有 id？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-18T01:09:24.997

如果您在控制器之间传递参数，通常应该将其作为参数传递。

```
<%= link_to "Link to other controller", other_path(@other, :some_param => param_value) %> 
```

在您链接到的操作中（这里是 SHOW），您将能够以 params[:some_param] 的形式访问 :some_param。

在表单中，继续并包含一个隐藏字段（只要您稍后检查它是否有效，因为用户可以提交任何内容）。

无论哪种方式，都不要使用闪存来存储会话状态 - 闪存仅用于用户消息。

# nhibernate - 在NHibernate中覆盖==（相等）运算符？

> ID：760932
> 
> 赞同：1
> 
> 时间：2009-04-17T15:39:08.737
> 
> 标签：nhibernate, equals

使用 NHibernate 实体，您需要覆盖 Equals 和 GetHashCode。重写 == 运算符以使用 .Equals 实现是一个好主意吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T15:45:39.610

`Equals()`是的，`operator==`保持一致是更通用的 .NET“最佳实践” `GethasCode()`。

请参阅[重载 Equals() 和运算符 == 的指南](http://msdn.microsoft.com/en-us/library/ms173147(VS.80).aspx)。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-04-17T15:50:23.733

为什么您认为在使用 NHibernate 时需要覆盖 Equals 和 GetHashCode？NHibernate 保证在同一 ISession 中访问的任何实体的实体平等。请参阅文档中的[考虑对象身份](http://knol.google.com/k/fabio-maulo/nhibernate-chapter-10/1nr4enxv3dpeq/13#10(2E)3(2E)(C2)(A0)Considering_object_identity)。

编辑添加：在重新阅读问题并进行一些谷歌搜索之后，我不得不承认我不知道等式运算符（==）可以在 C# 中被覆盖。

# python - 是否有用 C 编写的 python 模块的 fini 例程？

> ID：760937
> 
> 赞同：3
> 
> 时间：2009-04-17T15:40:25.333
> 
> 标签：python, c, python-module

我有一个用 C 编写的 python 模块，我想添加一个在卸载模块时调用的函数。我显然有一个`initfoo`初始化模块的函数——有没有办法告诉python在`finifoo`取消初始化模块时调用一个函数？

是`atexit`我唯一的选择吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-17T15:52:00.080

不是在 Python 2 中，但[Python 3 似乎是](http://www.python.org/dev/peps/pep-3121/). 如果您需要管理某些资源，我建议将其放在模块级对象中——我很确定在卸载模块时这些资源将被垃圾收集。

* * *

从链接：

> 目前，扩展模块通常初始化一次，然后永远“存活”。唯一的例外是调用 Py_Finalize() 时：然后第二次调用初始化例程。

这表明您可以在初始化程序中设置一个静态布尔值，每次调用都会翻转。检查它的状态以查看模块是否正在完成。

# ruby - 我在哪里可以托管 Ruby、GraphViz 和 Dot？

> ID：760938
> 
> 赞同：2
> 
> 时间：2009-04-17T15:40:28.703
> 
> 标签：ruby, hosting, sinatra, heroku, graphviz

我想为使用 Graphviz 和 Dot 的小型 Rub​​y (Sinatra) 应用程序找到一些托管服务。

Heroku 通常是我最喜欢的，因为它 a) 免费，b) 简单，c) 可扩展。Heroku 不做 Graphviz 和 Dot，所以我正在寻找替代方案。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T18:00:03.407

我对[bluehost.com](http://www.bluehost.com/)非常满意。它们支持 ruby​​/rails 等，虽然它们不提供 graphviz 或 dot 'out-of-the-box'，但它们提供 shell 帐户。我以前曾在不同但相似的系统上使用过 Graphviz 和 dot。如果您愿意从 bash 提示符中尝试一下，那么 bluehost 会更容易接受。

他们还拥有出色的客户支持。（不，我根本不属于他们。只是一个客户。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-24T11:00:20.053

Dreamhost 似乎允许您安装 Graphviz：

> [http://wiki.dreamhost.com/Graphviz](http://wiki.dreamhost.com/Graphviz)

希望这对您有所帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-07-02T19:08:17.257

如果您愿意处理精简的 'Viz api，Google Charts API[现在实验性地支持 GraphViz](http://code.google.com/apis/chart/docs/gallery/graphviz.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-20T00:32:14.230

我建议转移到VPS。我使用[Slicehost](http://www.slicehost.com/)，他们的计划起价为每月 20 美元。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-28T13:55:59.977

现在 Heroku 的 Cedar 堆栈支持[自定义构建包](https://devcenter.heroku.com/articles/buildpacks)，您可能可以创建自定义构建包来使用 Graphviz 和 Dot。看起来有人在[这里](https://github.com/stigkj/heroku-buildpack-graphviz)创建了一个。也许试一试。

# sql - 如何在选择中进行选择

> ID：760950
> 
> 赞同：3
> 
> 时间：2009-04-17T15:42:33.363
> 
> 标签：sql

我有一个包含唯一 ID 字段的表。另一个字段 (REF) 包含对另一个数据集 ID 字段的引用。现在我必须选择 REF 指向不存在的数据集的所有数据集。

```
SELECT * FROM table WHERE ("no dataset with ID=REF exists") 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-17T15:49:25.733

3种方式

```
SELECT * FROM YourTable y WHERE NOT EXISTS 
     (SELECT * FROM OtherTable o WHERE y.Ref = o.Ref)

SELECT * FROM YourTable WHERE Ref NOT IN 
     (SELECT Ref FROM OtherTable WHERE Ref IS NOT NULL)

SELECT y.* FROM YourTable y 
LEFT OUTER JOIN  OtherTable o ON y.Ref = o.Ref
WHERE o.Ref IS NULL 
```

另请参阅[从一个表中返回不在另一个表中的所有行的五种方法](http://wiki.lessthandot.com/index.php/5_ways_to_return_rows_from_one_table_not_in_another_table)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-17T15:45:11.563

试试这个：

```
SELECT * FROM TABLE WHERE NOT EXISTS 
     (SELECT * FROM OtherTable WHERE TABLE.Ref = OtherTable.ID) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-17T15:44:59.037

我认为这应该有效

```
SELECT * FROM table WHERE id NOT IN (SELECT ref_id FROM ref_table) 
```

或与 JOIN

```
SELECT table.* 
FROM table LEFT JOIN ref_table ON table.id = ref_table.ref_id
WHERE ref_table.ref_id IS NULL 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-17T15:47:48.733

```
SELECT 
 table1.* 
FROM 
 table1
 LEFT JOIN table2 ON table1.id = table2.ref
WHERE 
 table2.ref IS NULL 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-17T15:45:08.007

您可以执行如下子查询：

```
select * from table where somefield not in (select otherfield from sometable where ID=REF) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-17T15:44:35.603

```
SELECT * 
FROM table 
WHERE ((SELECT COUNT(*) FROM table2 WHERE table2.id = table.ref) = 0) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-17T15:45:56.707

类似的东西：

```
SELECT * FROM table WHERE ID NOT IN(SELECT REF FROM Table2 ) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-12-18T11:12:42.417

是的，您可以使用

select * from x where not exist ( select * from y )

# linq - 尝试编写像 LogParser 这样的程序/库 - 它是如何在内部工作的？

> ID：760951
> 
> 赞同：2
> 
> 时间：2009-04-17T15:42:46.887
> 
> 标签：linq, iis, parsing, logging, logparser

LogParser 不是开源的，我需要这个功能用于我正在处理的开源项目。

我想编写一个库，允许我查询巨大的（主要是 IIS）日志文件，最好使用 Linq。

你有任何可以帮助我的链接吗？LogParser 之类的程序如何运行得如此之快？它如何处理内存限制？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T15:56:11.380

它可能会在读取日志时处理日志中的信息。这意味着它（库）不必分配大量内存来存储信息。它可以读取一个块，对其进行处理并将其丢弃。这是处理数据的一种常用且非常有效的方法。

例如，您可以逐行工作并解析每一行。对于实际的解析，您可以编写状态机，或者如果要求允许，请使用正则表达式。

另一种方法是读取和解析数据的状态机。如果由于某种原因，日志条目跨越多行，则可能需要这样做。

一些状态机相关链接：

一个用 C 编写的**非常**简单的状态机：http: [//snippets.dzone.com/posts/show/3793](http://snippets.dzone.com/posts/show/3793)

很多与 python 相关的代码，但有些部分是普遍适用的：http: [//www.ibm.com/developerworks/library/l-python-state.html](http://www.ibm.com/developerworks/library/l-python-state.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T10:34:10.870

如果您的目标是使用 LINQ 查询 IIS 日志数据。然后我建议您将原始 IIS 日志数据移动到数据库并使用 LINQ 查询数据库。这篇博文可能会有所帮助。

[http://getsrirams.blogspot.in/2012/07/migrate-iislog-data-to-sqlce-4-database.html](http://getsrirams.blogspot.in/2012/07/migrate-iislog-data-to-sqlce-4-database.html)

# c# - 将 WinForm ClickNCode 重构为 MVP Passive View

> ID：760961
> 
> 赞同：5
> 
> 时间：2009-04-17T15:46:40.530
> 
> 标签：c#, winforms, refactoring, mvp

我正在尝试重构现有的 Winform 应用程序以使用 MVP Passive View 模式。应用程序的 UI、业务逻辑和数据存储代码多年来一直自由混合。看起来它要么从单独的层开始，要么有人试图将其分成层。在任何情况下，层边界都没有得到尊重。

由于表单直接操作域对象和数据源（反之亦然），我的首要任务是创建演示者/控制器对象并委派这些职责。

该应用程序是一个 .NET 1.1 应用程序，我正在 VS.NET 2003 中使用相当有限的重构加载项进行开发。我使用现有代码的测试生成器来创建样板单元测试，然后通过并手动编辑每个测试。当然，这最终会测试代码的作用，而不一定是它应该做的事情。对于新课程，我正在做 TDD。

**在这种规模的重构工作中，有什么技巧、资源、陷阱需要注意吗？**

我已经掌握了一些资源：

*   编程书籍合集；*重构*, *PEAA* , *WELC*
*   互联网（显然）
*   大量含咖啡因的饮料

更新：作为一个例子，你会采取什么步骤来改变这个：

```
 private void OneOfManyFormEventHandlers(object sender, System.EventArgs e)
    {
        string LocalVariable;
        decimal AnotherLocal;
        if (!this._SomeDomainObject.SomeMethod(ClassField, out LocalVariable, out AnotherLocal))
        {
            MessageBox.Show("An error occurred calling method");
            return;
        }

        this.FormControl.Value = LocalVariable;
        this.AnotherFormContorl.Value = AnotherLocal;

        this.AnotherPrivateMethod();
    } 
```

进入这个：

```
 private void OneOfManyFormEventHandlers(object sender, System.EventArgs e)
    {
         this.FormPresenter.DoSomething();
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T16:32:27.377

我采取的方法也是先将代码移出事件处理程序。本质上，我在表单旁边放置了一个类，它实现了事件处理程序并将 UI 状态保存在控件旁边。

通过这一举措，我将表单和与剩余应用程序的实际交互清晰地分开，并能够在该级别引入测试。这样做的另一个结果是视图很快变得被动。

我在一个单独的步骤中重构了演示者（它现在拥有事件处理程序），并且仅在我将这些对象的所有用途从所有形式中移出之后才引入域对象。

所以我的步骤是：

1.  从逻辑中移除 UI 依赖
2.  创建域对象（如果尚不可用）
3.  重构演示者以使用域对象
4.  在您使用时根据您的设计选择介绍服务

当我这样做时，我开始在新引入的边界处引入测试，以确保我不会破坏工作代码或在我正在移动的现有代码中发现错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T16:44:12.253

如果您有时间，我建议您**首先**使用 WinForms 测试框架（如[White](http://www.codeplex.com/white)）在现有应用程序上编写一些冒烟测试。这样，当您开始重构代码时，您将能够检查任何新引入的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-21T08:48:14.813

您可能会发现[使用 Windows 窗体实现 MVC](https://stackoverflow.com/questions/654722/implementing-mvc-with-windows-forms)的答案很有帮助，因为他们讨论了实现 MVC 和 MVP 时的不同选项

# iphone - UIACtionSheet 代表问题

> ID：760971
> 
> 赞同：0
> 
> 时间：2009-04-17T15:49:46.323
> 
> 标签：iphone, cocoa-touch, multithreading, xcode

我正在使用操作表在登录我的应用程序时提醒用户注意几个项目。列出了一些警报示例和附带的按钮。

```
INVALID USER - OK
INVALID PASSWORD - OK
INVALID USER - OK
UNKNOWN USER - CREATE NEW USER, CANCEL
USER ALREADY LOGGED IN - DISCONNECT, CANCEL LOGIN 
```

管理多个操作表并让一个代表（自己）处理各种工作表上的各种按钮的最佳方法是什么？

我尝试将 AppDelegate 属性设置为标志值以确定应在委托函数中执行哪些操作...即...

```
//not actual code written in english-ese...
if (lastCommand = @"INVALIDUSER")
  if buttonIndex=0 { .. }
  if buttonIndex=1 { .. }
} else if (lastCommand = @"UNKNOWNUSER"){
  if button index=0 { .. }
  if button index=1 { .. }
} 
```

等等...但是我的标志属性（lastCommand）无效，我假设是因为我在两个单独的线程中工作。

最好的方法是什么？一如既往，非常感谢您的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T17:50:22.120

我最终使用了 UIActionSheet.tag 属性。

# python - python paramiko 模块中长时间运行的 ssh 命令（以及如何结束它们）

> ID：760978
> 
> 赞同：25
> 
> 时间：2009-04-17T15:51:20.050
> 
> 标签：python, ssh, paramiko

我想`tail -f logfile`使用 python 的 paramiko 模块在远程机器上运行命令。到目前为止，我一直在尝试以下方式：

```
interface = paramiko.SSHClient()
#snip the connection setup portion
stdin, stdout, stderr = interface.exec_command("tail -f logfile")
#snip into threaded loop
print stdout.readline() 
```

我希望命令在必要时运行，但我有两个问题：

1.  我该如何干净地停止这个？我想制作一个频道，然后在完成后使用频道`shutdown()`上的命令-但这似乎很混乱。是否可以执行类似发送`Ctrl-C`到频道的标准输入的操作？
2.  `readline()`块，如果我有一种获取输出的非阻塞方法，我可以避免使用线程——有什么想法吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-19T22:27:05.900

不要在客户端调用 exec_command，而是获取传输并生成您自己的通道。[通道](http://www.lag.net/paramiko/docs/paramiko.Channel-class.html)可用于执行命令，您可以在 select 语句中使用它来确定何时可以读取数据：

```
#!/usr/bin/env python
import paramiko
import select
client = paramiko.SSHClient()
client.load_system_host_keys()
client.connect('host.example.com')
transport = client.get_transport()
channel = transport.open_session()
channel.exec_command("tail -f /var/log/everything/current")
while True:
  rl, wl, xl = select.select([channel],[],[],0.0)
  if len(rl) > 0:
      # Must be stdout
      print channel.recv(1024) 
```

可以读取和写入通道对象，连接远程命令的标准输出和标准输入。您可以通过调用 stderr 来获取`channel.makefile_stderr(...)`。

我已将超时设置为`0.0`秒，因为请求了非阻塞解决方案。根据您的需要，您可能希望使用非零超时来阻止。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-07T17:43:22.737

1）如果你愿意，你可以关闭客户端。另一端的服务器将终止尾部进程。

2）如果您需要以非阻塞方式执行此操作，则必须直接使用通道对象。然后，您可以使用 channel.recv_ready() 和 channel.recv_stderr_ready() 来查看 stdout 和 stderr，或者使用 select.select。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-02-15T04:40:38.033

Andrew Aylett 对解决方案的一个小更新。以下代码实际上会在外部进程完成时中断循环并退出：

```
import paramiko
import select

client = paramiko.SSHClient()
client.load_system_host_keys()
client.connect('host.example.com')
channel = client.get_transport().open_session()
channel.exec_command("tail -f /var/log/everything/current")
while True:
    if channel.exit_status_ready():
        break
    rl, wl, xl = select.select([channel], [], [], 0.0)
    if len(rl) > 0:
        print channel.recv(1024) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-18T00:58:10.717

要关闭该过程，只需运行：

```
interface.close() 
```

在非阻塞方面，您无法获得非阻塞读取。您能做的最好的事情是一次解析一个“块”，“stdout.read(1)”只有在缓冲区中没有字符时才会阻塞。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-25T14:02:15.117

仅供参考，有一个使用 channel.get_pty() 的解决方案。更多细节请看：[https ://stackoverflow.com/a/11190727/1480181](https://stackoverflow.com/a/11190727/1480181)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-03-26T03:20:26.317

我解决这个问题的方法是使用上下文管理器。这将确保我长时间运行的命令被中止。关键逻辑是包装以模仿 SSHClient.exec_command 但捕获创建的通道并使用`Timer`如果命令运行时间过长将关闭该通道。

```
import paramiko
import threading

class TimeoutChannel:

    def __init__(self, client: paramiko.SSHClient, timeout):
        self.expired = False
        self._channel: paramiko.channel = None
        self.client = client
        self.timeout = timeout

    def __enter__(self):
        self.timer = threading.Timer(self.timeout, self.kill_client)
        self.timer.start()

        return self

    def __exit__(self, exc_type, exc_val, exc_tb):
        print("Exited Timeout. Timed out:", self.expired)
        self.timer.cancel()

        if exc_val:
            return False  # Make sure the exceptions are re-raised

        if self.expired:
            raise TimeoutError("Command timed out")

    def kill_client(self):
        self.expired = True
        print("Should kill client")
        if self._channel:
            print("We have a channel")
            self._channel.close()

    def exec(self, command, bufsize=-1, timeout=None, get_pty=False, environment=None):
        self._channel = self.client.get_transport().open_session(timeout=timeout)
        if get_pty:
            self._channel.get_pty()
        self._channel.settimeout(timeout)
        if environment:
            self._channel.update_environment(environment)
        self._channel.exec_command(command)
        stdin = self._channel.makefile_stdin("wb", bufsize)
        stdout = self._channel.makefile("r", bufsize)
        stderr = self._channel.makefile_stderr("r", bufsize)
        return stdin, stdout, stderr 
```

现在使用代码非常简单，第一个示例将抛出一个`TimeoutError`

```
ssh = paramiko.SSHClient()
ssh.connect('hostname', username='user', password='pass')

with TimeoutChannel(ssh, 3) as c:
    ssh_stdin, ssh_stdout, ssh_stderr = c.exec("cat")    # non-blocking
    exit_status = ssh_stdout.channel.recv_exit_status()  # block til done, will never complete because cat wants input 
```

此代码可以正常工作（除非主机处于疯狂的负载下！）

```
ssh = paramiko.SSHClient()
ssh.connect('hostname', username='user', password='pass')

with TimeoutChannel(ssh, 3) as c:
    ssh_stdin, ssh_stdout, ssh_stderr = c.exec("uptime")    # non-blocking
    exit_status = ssh_stdout.channel.recv_exit_status()     # block til done, will complete quickly
    print(ssh_stdout.read().decode("utf8"))                 # Show results 
```

# javascript - Apache PDF 数字签名

> ID：760979
> 
> 赞同：1
> 
> 时间：2009-04-17T15:51:37.210
> 
> 标签：javascript, apache, pdf, webforms

我有一个网站，其中包含我通过 ftp 上传的所有 pdf 文件的目录列表。通过单击任何文件名，pdf 文档将显示在您的网络浏览器中。外部各方是否可以在网络浏览器中对文档进行数字签名并将其保存回服务器，并在文件名上附加“签名”。

我的主要问题是：

1.  通过网络浏览器将签名的文档保存回服务器

2.  保存文档时更改文件名

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-17T18:27:26.663

这将取决于您的权限，但如果用户通过 http 下载它（您在您的网站上启用了目录列表），除非您允许上传，否则他们应该无法将其保存回站点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-25T09:18:20.903

我建议阅读[PHP 上传教程](http://php.net/manual/en/features.file-upload.php)。

您可能会考虑使用 WebDAV，但我不会推荐它。

# c# - 停止重复插入数据库的最佳方法是什么

> ID：760985
> 
> 赞同：1
> 
> 时间：2009-04-17T15:53:02.527
> 
> 标签：c#, asp.net, sql, sql-server, linq-to-sql

我有一个使用 asp.net、c#、sql server 和 linq to sql 的论坛应用程序。它受到多次插入的影响，我认为当按下插入按钮时，也可能在刷新浏览器或单击返回时。

什么是最全面的方法，或防止这种情况的方法。

更新：我目前在插入文本后使用 response.redirect。我认为在阅读回复后，正确的方法可能是立即使用 javascript 禁用该按钮？然后在表单上的隐藏字段（或会话？）上保存唯一值。在数据库中为该值创建一个字段并针对该字段检查此唯一值？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-17T15:54:52.973

1.  为每个页面分配`UNIQUE`cookie 或隐藏控件
    *   在您的表中创建一个`UNIQUE`包含此 cookie 或控件值的字段。
    *   如果使用相同的 cookie 插入记录，`INSERT`则会失败，您可以处理（或忽略）此情况。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-17T15:56:46.637

当我有一个插入或更新的页面时，我通常会在更新完成后执行 Response.Redirect 到另一个页面，即使您只是 Response.Redirect 到同一页面。这样，如果页面被刷新，您就不会重新发布您的数据。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-17T15:57:41.283

请注意，您的问题并不是真正特定于您的数据库。您在发送多个浏览器请求时遇到问题，您必须解决该问题。使用 Dave 上述的重定向模式或使用 Cookie 签名

一个例子可以在这里找到[http://aspalliance.com/711_Preventing_Duplicate_Record_Insertion_on_Page_Refresh_or_Postback_of_a_Web_Form](http://aspalliance.com/711_Preventing_Duplicate_Record_Insertion_on_Page_Refresh_or_Postback_of_a_Web_Form)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-17T15:58:41.250

使用主键或唯一约束，如果你不能这样做，我建议你使用新的 MERGE 语句，如果它不存在则插入或更新，如果它存在（不知道你的业务规则，所以可能不会在您的情况下工作）MERGE 是 SQL Server 2008 及更高版本

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-17T19:16:55.327

查看来自 SO'r [Dave Ward的这个名为](https://stackoverflow.com/users/60/dave-ward)[PostBack Ritalin](http://encosia.com/downloads/postback-ritalin/)的 ASP.NET AJAX 控件。这可以帮助您为您的 javascript disabler 想法提供一个已经测试过的解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T15:56:11.160

从输入数据流的一列或多列中选择一个自然主键。使用这些列在表上声明主键约束。如果您已经对代理键有一个主键约束，并且您不想删除它，请改为在自然键上声明一个 UNIQUE 约束。

当应用程序尝试向表中插入重复行时，这将导致错误。但是，您必须对应用程序进行编程以识别错误并做正确的事情。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-17T16:00:11.340

为评论在表单中分配一个唯一的ID，并将其与评论一起记录在数据库中。如果注释不存在，请在执行插入之前检查具有该唯一 ID 的注释。

要允许用户一次在活动站点上进行多个回复，您可以最初在服务器端分配令牌，将其放入该用户会话上的活动发布令牌列表中，将其放入评论的隐藏字段中表单，并且仅当该令牌在会话列表中时才允许将表单提交插入数据库（并在成功插入数据库后将其从会话列表中删除）。这使您不必像上面那样将发布令牌存储在数据库中，这有点容易但简陋。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-17T19:13:22.827

在数据的自然键上放置唯一索引，以防止输入重复。如果需要，将其针对表的所有字段（除了任何面向日期的字段，它们将在插入时接收系统日期或仅由后端使用的字段，例如 insertby，其中包含执行人的用户 ID插入）除了id。

# javascript - jquery getJSON 跨域问题

> ID：760993
> 
> 赞同：10
> 
> 时间：2009-04-17T15:55:00.103
> 
> 标签：javascript, jquery, json

使用 JQuerys getJSON 从另一个域中拉入我的 JSON 文件时，我似乎无法使其正常工作。我已将回调部分放在 url 的末尾，但仍然没有乐趣。Firebug 告诉我这是一个跨域问题，这似乎很有意义，就好像我将 json 文件放在下面的代码中一样（不包括**?jsoncallback=?**工作正常）

这是 Jquery 部分

```
$.getJSON("http://anotherdomain/js/morearticles.js?jsoncallback=?",
    function(json){
        if (show5More.nextSetCount < json.items.length) { // Check not on last group of data
            $('#lineupswitch li').hide();  // Hide the existing items    
            $.each(json.items, function(key,value){ // Loop over the returned data from the json file
                if (key === show5More.nextSetCount) {  // If the itteration is equal to the datablock continure
                     show5More.nextSetCount = show5More.nextSetCount + 1; // 
                     $(value).each( function(index) {
                         if( (index % 2) == 0) {
                             $('<li class="even ' + this.cname +'"><a href="' + this.href + '" class="lineup-thumb"><img src="' + this.thumbimg + '" /></a><h3><a href="' + this.href + '">' + this.titletext + '</a></h3><p>' + this.paratext + '</p></li>').appendTo("#lineupswitch");
                          } else {
                              $('<li class="odd ' + this.cname +'"><a href="' + this.href + '" class="lineup-thumb"><img src="' + this.thumbimg + '" /></a><h3><a href="' + this.href + '">' + this.titletext + '</a></h3><p>' + this.paratext + '</p></li>').appendTo("#lineupswitch");                              
                          } 
                     });
                     return false;
                }
            });
        }
    });         
} 
```

还有我已经验证过的 JSON。

```
{
  “项目”： [
            [
                {
                    "href": "/edinburgh/video/news-090415-s2-squalor-edinburgh/",
                    "thumbimg": "http://brightcove.vo.llnwd.net/d7/unsecured/media/1486976045/1486976045_19721015001_asset-1239819553334.jpg?pubId=1486976045",
                    "titletext": "家里有被忽视的孩子的大麻植物",
                    "paratext": "法庭听说有四个小孩住在里面",
                    “cname”：“”
                },
                {
                    "href": "/edinburgh/video/news-090414-s2-waverley-station-edinburgh/",
                    "thumbimg": "http://brightcove.vo.llnwd.net/d7/unsecured/media/1486976045/1486976045_19537855001_asset-1239732920496.jpg?pubId=1486976045",
                    "titletext": "耗资数百万英镑的韦弗利车站改造",
                    "paratext": "爱丁堡的韦弗利站设置为 a",
                    “cname”：“”
                },
                {
                  "href": "/edinburgh/video/news-s2-natal-20090408/",
                  "thumbimg":"http://brightcove.vo.llnwd.net/d7/unsecured/media/1486976045/1486976045_18948154001_asset-1239206353135.jpg?pubId=1486976045",
                  "titletext": "在提高认识的路上死胎慈善",
                  "paratext": "SANDS Lothian 希望突出他们的",
                  “cname”：“”
                },
                {
                  "href": "/edinburgh/video/news-090407-l2-rbs/",
                  “拇指”：“http://brightcove.vo.llnwd.net/d7/unsecured/media/1486976045/1486976045_18827378001_asset-1239110600777.jpg?pubId=1486976045”，
                  "titletext": "苏格兰皇家银行有数以千计的工作要做",
                  "paratext": "总部位于爱丁堡的银行裁员 4,500 个职位",
                  “cname”：“”
                },
                {
                    "href": "/edinburgh/video/news-090415-s2-squalor-edinburgh/",
                    "thumbimg": "http://brightcove.vo.llnwd.net/d7/unsecured/media/1486976045/1486976045_19721015001_asset-1239819553334.jpg?pubId=1486976045",
                    “标题文本”：“1”，
                    "paratext": "法庭听说有四个小孩住在里面",
                    “cname”：“lastlineup”
                }               
            ],

            [
                {
                    "href": "/edinburgh/video/news-090415-s2-squalor-edinburgh/",
                    "thumbimg": "http://brightcove.vo.llnwd.net/d7/unsecured/media/1486976045/1486976045_19721015001_asset-1239819553334.jpg?pubId=1486976045",
                    “标题文本”：“1”，
                    "paratext": "法庭听说有四个小孩住在里面",
                    “cname”：“”
                },
                {
                    "href": "/edinburgh/video/news-090414-s2-waverley-station-edinburgh/",
                    "thumbimg": "http://brightcove.vo.llnwd.net/d7/unsecured/media/1486976045/1486976045_19537855001_asset-1239732920496.jpg?pubId=1486976045",
                    “标题文本”：“2”，
                    "paratext": "爱丁堡的韦弗利站设置为 a",
                    “cname”：“”
                },
                {
                  "href": "/edinburgh/video/news-s2-natal-20090408/",
                  "thumbimg":"http://brightcove.vo.llnwd.net/d7/unsecured/media/1486976045/1486976045_18948154001_asset-1239206353135.jpg?pubId=1486976045",
                  "titletext": "在提高认识的路上死胎慈善",
                  “副文本”：“3”，
                  “cname”：“”
                },
                {
                  "href": "/edinburgh/video/news-090407-l2-rbs/",
                  “拇指”：“http://brightcove.vo.llnwd.net/d7/unsecured/media/1486976045/1486976045_18827378001_asset-1239110600777.jpg?pubId=1486976045”，
                  "titletext": "苏格兰皇家银行有数以千计的工作要做",
                  “副文本”：“4”，
                  “cname”：“”
                },
                {
                  "href": "/edinburgh/video/news-090407-l2-rbs/",
                  “拇指”：“http://brightcove.vo.llnwd.net/d7/unsecured/media/1486976045/1486976045_18827378001_asset-1239110600777.jpg?pubId=1486976045”，
                  "titletext": "苏格兰皇家银行有数以千计的工作要做",
                  "paratext": "总部位于爱丁堡的银行裁员 4,500 个职位",
                  “cname”：“lastlineup”
                }               

            ]   

        ]
}

{
  “项目”： [
            [
                {
                    "href": "/edinburgh/video/news-090415-s2-squalor-edinburgh/",
                    "thumbimg": "http://brightcove.vo.llnwd.net/d7/unsecured/media/1486976045/1486976045_19721015001_asset-1239819553334.jpg?pubId=1486976045",
                    "titletext": "家里有被忽视的孩子的大麻植物",
                    "paratext": "法庭听说有四个小孩住在里面",
                    “cname”：“”
                },
                {
                    "href": "/edinburgh/video/news-090414-s2-waverley-station-edinburgh/",
                    "thumbimg": "http://brightcove.vo.llnwd.net/d7/unsecured/media/1486976045/1486976045_19537855001_asset-1239732920496.jpg?pubId=1486976045",
                    "titletext": "耗资数百万英镑的韦弗利车站改造",
                    "paratext": "爱丁堡的韦弗利站设置为 a",
                    “cname”：“”
                },
                {
                  "href": "/edinburgh/video/news-s2-natal-20090408/",
                  "thumbimg":"http://brightcove.vo.llnwd.net/d7/unsecured/media/1486976045/1486976045_18948154001_asset-1239206353135.jpg?pubId=1486976045",
                  "titletext": "在提高认识的路上死胎慈善",
                  "paratext": "SANDS Lothian 希望突出他们的",
                  “cname”：“”
                },
                {
                  "href": "/edinburgh/video/news-090407-l2-rbs/",
                  “拇指”：“http://brightcove.vo.llnwd.net/d7/unsecured/media/1486976045/1486976045_18827378001_asset-1239110600777.jpg?pubId=1486976045”，
                  "titletext": "苏格兰皇家银行有数以千计的工作要做",
                  "paratext": "总部位于爱丁堡的银行裁员 4,500 个职位",
                  “cname”：“”
                },
                {
                    "href": "/edinburgh/video/news-090415-s2-squalor-edinburgh/",
                    "thumbimg": "http://brightcove.vo.llnwd.net/d7/unsecured/media/1486976045/1486976045_19721015001_asset-1239819553334.jpg?pubId=1486976045",
                    “标题文本”：“1”，
                    "paratext": "法庭听说有四个小孩住在里面",
                    “cname”：“lastlineup”
                }               
            ],

            [
                {
                    "href": "/edinburgh/video/news-090415-s2-squalor-edinburgh/",
                    "thumbimg": "http://brightcove.vo.llnwd.net/d7/unsecured/media/1486976045/1486976045_19721015001_asset-1239819553334.jpg?pubId=1486976045",
                    “标题文本”：“1”，
                    "paratext": "法庭听说有四个小孩住在里面",
                    “cname”：“”
                },
                {
                    "href": "/edinburgh/video/news-090414-s2-waverley-station-edinburgh/",
                    "thumbimg": "http://brightcove.vo.llnwd.net/d7/unsecured/media/1486976045/1486976045_19537855001_asset-1239732920496.jpg?pubId=1486976045",
                    “标题文本”：“2”，
                    "paratext": "爱丁堡的韦弗利站设置为 a",
                    “cname”：“”
                },
                {
                  "href": "/edinburgh/video/news-s2-natal-20090408/",
                  "thumbimg":"http://brightcove.vo.llnwd.net/d7/unsecured/media/1486976045/1486976045_18948154001_asset-1239206353135.jpg?pubId=1486976045",
                  "titletext": "在提高认识的路上死胎慈善",
                  “副文本”：“3”，
                  “cname”：“”
                },
                {
                  "href": "/edinburgh/video/news-090407-l2-rbs/",
                  “拇指”：“http://brightcove.vo.llnwd.net/d7/unsecured/media/1486976045/1486976045_18827378001_asset-1239110600777.jpg?pubId=1486976045”，
                  "titletext": "苏格兰皇家银行有数以千计的工作要做",
                  “副文本”：“4”，
                  “cname”：“”
                },
                {
                  "href": "/edinburgh/video/news-090407-l2-rbs/",
                  “拇指”：“http://brightcove.vo.llnwd.net/d7/unsecured/media/1486976045/1486976045_18827378001_asset-1239110600777.jpg?pubId=1486976045”，
                  "titletext": "苏格兰皇家银行有数以千计的工作要做",
                  "paratext": "总部位于爱丁堡的银行裁员 4,500 个职位",
                  “cname”：“lastlineup”
                }               

            ]   

        ]
}

```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-30T15:10:09.357

altCognito is correct. Here is a working example:

Put this in the top of your page you are calling from, in the

```
$.getJSON("http://www.yourotherdomain.com/testcross.php?jsoncallback=?",
  function(data) {
    $('body').html(data.name).css("color", "green");
  }
); 
```

and the php that would return stuff:

```
$data = '{"name" : "hello world"}';
echo $_GET['jsoncallback'] . '(' . $data . ');'; 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-17T15:58:36.477

它不返回回调函数，因此无法评估。

您的 PHP 代码中应该有这样的内容：

```
echo $_GET['callback'] . '(' . $jsonData . ');'; 
```

哈，哦，对不起，如果您使用的是 php，那就是这种情况。

您希望在您的 javascript 文件中使用它，并且您需要指定一个硬编码的回调，因为它是一个静态列表。

请参阅： [http ://www.ibm.com/developerworks/library/wa-aj-jsonp1/](http://www.ibm.com/developerworks/library/wa-aj-jsonp1/)

# html - 水平规则：好的或坏的设计决策

> ID：760997
> 
> 赞同：6
> 
> 时间：2009-04-17T15:56:44.403
> 
> 标签：html

我有一个我构建的自定义控件，其中包含要选择的项目列表。我担心这些项目会一起运行，因为在这个列表中可以有许多不同类型的操作。

*   创造
*   编辑
*   看法

所以我可以通过使用水平规则将它们分成组。

与我一起工作的人认为水平规则是一个糟糕的设计选择，并希望我将其更改为风格化的 DIV。除了它们易于实施之外，我真的没有意见。我实现的 HR 风格很好，看起来不错。

想法？水平规则是好还是坏的设计选择？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-17T16:04:59.097

不好，因此仅使用 div 来添加水平 div。相反，请考虑将看起来像水平线的线作为要划分的元素的边框。这在语义上是正确的，因为您不会影响您正在创建的 HTML 文档的结构。

[本文深入探讨了如何](http://www.smashingmagazine.com/2009/04/08/from-table-hell-to-div-hell/)通过仅将 div 用作表示元素来滥用 div。虽然有时无法避免，但这不是其中之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T16:15:12.083

在这一点上，我倾向于同意 altCognito，因为它们纯粹是展示性的（至少它们似乎在我迄今为止看到它们使用的所有实例中）它们应该通过 css 应用。

可能有一个`:after {content: /* hr */;}`选项，但是，老实说，当有边界底部时，它在视觉上服务（或至少可以服务）相同的目的，为什么还要`<hr />`再打扰呢？

当然，如果您决定采用它们，它们当然可以进行样式化，尽管[W3 Schools](http://www.w3schools.com/tags/tag_hr.asp "链接到 W3 School 的水平尺页面。")建议所有潜在的样式选项现在都已弃用。如果是这样，并且它不能被“官方”风格化，我认为最好避免它。即使只是出于纯粹的心态来保持样式表的有效性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T16:22:41.800

HR的唯一问题是它总是在那里。我假设您的同事认为您可能并不总是希望显示 HR，并且使用 DIV 和 css 解决方案让我们在一个全局 css 文件中删除或更改它。（尽管 HR 也可以由 css 控制）

div+css 解决方案还不错，但就您所描述的而言，HR 解决方案也不错。在这种情况下，我会选择任何方便的东西。*********