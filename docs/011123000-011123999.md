# StackOverflow 问答 11123000-11123999

# vb.net - 无法让组合框在子表单中正常工作？VB

> ID：11123002
> 
> 赞同：2
> 
> 时间：2012-06-20T15:32:17.497
> 
> 标签：vb.net, combobox, parent-child, mdichild, mdiparent

我花了很长时间试图找到解决我在子窗体中使用组合框时遇到的问题的方法。我确定这一定是 Microsoft 错误，而不是我做错了什么......我真的很感激一些帮助，在此先感谢......

解释这个问题的最好方法是告诉你我到目前为止做了什么：

如果您在 VB 中打开一个新项目并添加两个 Windows 窗体。Form1 将是父级。Form2 将是孩子。

在 Form1 上添加 1 个面板（Form2 将在面板内打开，因此请确保面板足够大以适合 Form2）和 1 个按钮。此表单所需的唯一代码是：

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click

Form2.Show()

End Sub 
```

在 Form2 上添加一个文本框和一个组合框。将以下代码复制到 Form2 中：

```
Private Sub Form2_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.GotFocus

    ActivateMdiChild(Me)

End Sub

Private Sub Form2_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

    TopLevel = False
    Form1.Panel1.Controls.Add(Me)
    Me.BringToFront()

End Sub 
```

现在运行程序并单击 button1 打开 form2（form2 现在应该在 panel1 中打开）。

组合框和文本框失去了一些功能，例如： 1\. 您不能在不点击下拉菜单的情况下将焦点设置在组合框上 2\. 您无法在组合框或文本框中正确突出显示文本。3\. 您无法在组合框或文本框中使用鼠标设置光标索引位置。

有谁知道解决这个问题的方法？？主要用于组合框，因为我有一些适用于文本框的功能。

问候，本

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T15:48:17.687

您的点击事件可能看起来像这样：

```
Private Sub Button1_Click(ByVal sender As Object, ByVal e As EventArgs) Handles Button1.Click
  Dim f As New Form2
  f.TopLevel = False
  f.Dock = DockStyle.Fill
  f.Visible = True
  Panel1.Controls.Add(f)
  f.BringToFront()
End Sub 
```

而且您几乎可以丢弃您为 Form2 发布的代码。将作为父级的 MDI 子级的窗体移动到面板的子级控件有点尴尬。我猜这不是你真正想要做的。

此外，此当前代码将继续在面板中已有的任何现有控件或表单上放置一个新的 Form2。确保处理掉不需要的控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T16:46:55.077

另一种获得您想要使用的功能的方法`Form2`是通过属性设置`Form1`为 MDI 容器`IsMdiContainer`on `Form1`。`Form2`然后，您可以通过以下方式调用`Form1`按钮单击：

```
Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click
    Dim f As New Form2()
    f.MdiParent = Me
    f.Show()
End Sub 
```

这显然会在`Form2`您每次单击 Button1 时创建一个新实例，因此您可以将单击操作更改为`Form2.Show()`并在`Form2`构造函数中设置`MdiParent`为`Form1`。那应该只创建一个`Form2`.

我很好奇您为什么要通过面板模仿 MDI 功能？

# algorithm - 6*6拼图算法

> ID：11123003
> 
> 赞同：7
> 
> 时间：2012-06-20T15:32:17.930
> 
> 标签：algorithm, puzzle

我有一个 6*6 的拼图，随机排列有 35 个数字（1~35）。将空白的数字用作“寄存器”并将数字一一移动以使它们按顺序排列。我可以处理一个 3*3 的拼图，但是如何处理一个 6*6 的拼图呢？你能给我一些提示吗？ ![在此处输入图像描述](../Images/503e4d4c275ff5275cab79a330762444.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-20T15:34:03.953

想法是一样的，将问题表示为状态[图](http://en.wikipedia.org/wiki/Graph_%28mathematics%29)，并运行[**最短路径**](http://en.wikipedia.org/wiki/Shortest_path_problem)**算法**。

如果算法的效率很重要，您可能需要一个明智的算法 - 例如 [**A* 算法**](http://en.wikipedia.org/wiki/A%2a_search_algorithm)，预计它会非常快（相对于替代方案）并具有良好的[可接受启发式函数](http://en.wikipedia.org/wiki/Admissible_heuristic)。
一个更慢但更简单的解决方案可以运行[**BFS**](http://en.wikipedia.org/wiki/Breadth-first_search)。

两种算法（A*、BFS）都是**完整**的（如果存在，总是找到解决方案）和**最优**的（找到最短路径）。

另请注意，您可以使用**宏来学习“好的”系列动作**，以更快地获得算法。在您实施有效（虽然缓慢）的解决方案之前，请忽略此改进。

* * *

**编辑：**编码指南：
将问题视为图表：图表将在`G=(V,E)`哪里`V = { all possible states}`和`E = { (u,v) | can move from state u to state v within a single step }`

现在，有了这个图 - 你有一个起始位置（源，作为输入给出）和一个目标（一个排序的谜题）。启动 BFS 或 A*（在附加的 wikipedia 链接中查看这些伪代码），以找到从源到目的地的路径。你应该从 BFS 开始——它更简单。
最短路径算法返回的路径与从起始板到目标必须执行的一系列移动相同。

注意：您不需要创建实际的图表！你只需要 a 来保存起始节点（源） - 并创建它的顶点，并拥有一个`successors:V->2^V`函数，它为你提供每个顶点的后继节点（正式地：）`successors(v) = { (v,u) | (v,u) is in E }`。这样，您可以即时构建图表的相关部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T16:06:06.323

我在大学时研究过同样的问题/谜题，这是一个非常有趣的问题，涉及人工智能、启发式技术和图论。如**amit**所述，强烈建议您检查 A*、BFS 和启发式。

这是我的贡献：当试图解决这个问题时，你可以尝试**分而治之的**策略。你可以认为这个 6x6 网格只是四个相互靠近的 3x3 网格，并尝试按照给定的顺序将每个网格作为单独的案例来解决。

例如，您可以尝试以下算法：

1.  以左上网格包含所有作品的方式排列你的作品，除了一个（将用作工作空间）；
2.  求解左上网格；
3.  以包含所有部分的方式排列右上网格，除了右下角的网格（将用作工作空间）；
4.  求解右上网格；
5.  ...等等，与网格数量无关！

最后要说的是，你必须**注意你要留下哪个角落作为工作空间**，因为你不能让右上角网格的右上角成为你的工作空间“缺失的部分”，因为它不会将来有可能放一块；

Ps1：工作空间是您暂时让棋子错过的位置，以便能够有自由空间来操纵棋子；

Ps2：在这种情况下，网格是 NxN 块的组合，它包含所有正确的块，不一定按顺序排列。

希望我在某种程度上有所帮助。:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T15:54:43.750

这个游戏的一个简单策略是将正确的数字放在第一行（这应该很容易，因为你不关心其他数字，最后两个数字更难放在正确的位置，因为你必须放置他们都在同一个动作），然后你冻结顶行并继续左列，然后是顶行，然后是左列……</p>

这不是最佳策略，但它是一种有效且易于编码的策略。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-03T07:03:52.300

我已经通过使用插入排序算法解决了上述难题。我花了将近 2 天的时间来解决上述难题。如果您需要询问任何内容，只需在 .Net 代码下方运行，然后给我留言。我没有使用任何 C# 内置类来解决上述问题。这是一个带有代码的纯 c 逻辑代码解决方案

```
 private static void MazePuzzle()
        {
            /****
         * A typical C Problem for Maze puzzle has been solved by prince.It took almost 3 days.
         * Problem is about Sorting a 2D Matrix with any number of row and column
         * This problem is also known as Rat Maze puzzle
         * It is also be a typical Backtracking Problem
         * ***/
            const int _row = 6;
            const int _coloumn = 6;
            //int _column1 = _coloumn;

            int[,] _doubleArray = new int[_row, _coloumn] { { 19, 2, 4, 34, 23, 41 }, { 11, 63, 3, 93, 65, 98 }, { 12, 80, 15, 76, 71, 90 }, { 119, 32, 94, 84, 23, 41 }, { 129, 232, 124, 341, 253, 411 }, { 197, 289, 47, 343, 293, 401 } };
            int [] _StoringArray1D=new int[_row*_coloumn];
            int i = 0;
            int j = 0;
            int _comparingArrayElement = 0;
            int _swipeTemp = 0;

            for (; i < _row; i++)
            {
                int _trackrow = 0;
                for (;j <_coloumn; j++)
                {
                    _trackrow = 0;
                    if(i==0 && j==0)
                    {
                          _comparingArrayElement= _doubleArray[i, j + 1];
                        if(_comparingArrayElement<_doubleArray[i,j])
                        {
                             _swipeTemp = _doubleArray[i,j+1];
                             _doubleArray[i, j + 1] = _doubleArray[i, j];
                             _doubleArray[i, j] = _swipeTemp;

                        }//innerMost if
                    }//For First time
                        else
                        {
                            int k = 0;
                            do
                            {
                                if (_trackrow == i || _trackrow < i)
                                {
                                    for (; k < _coloumn; k++)
                                    {
                                        if(k==j && i==_trackrow)
                                        {
                                            break;
                                        }
                                        else
                                        {
                                        if(_doubleArray[_trackrow,k]>_doubleArray[i,j])
                                        {
                                            int _swipetempPrevious=_doubleArray[_trackrow,k];
                                            _doubleArray[_trackrow,k]=_doubleArray[i,j];
                                            _doubleArray[i, j] = _swipetempPrevious;
                                        }
                                        else
                                        {
                                            //do nothing just traverse
                                        }//swipe else
                                        }//k==j else
                                    }//inner for do while
                                    _trackrow++;
                                    k = 0;
                                }//trackrow if
                                else
                                {
                                    break;
                                }//trackrow else
                            } while (true);
                        }//else
                }//innner for
                j = 0;
            }//outer for
            Console.WriteLine("End of Program");
        }//Maze Puzzle Method 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-01T09:13:10.497

我认为如果我们一次遍历整个 6*6 矩阵，我们将只能找到一个小数字并将其移动到下一个矩阵，这不是一个相关的解决方案。解决这个问题的更好方法是在给定矩阵上使用二进制搜索。如果我们将应用二进制搜索，那么时间复杂度会很高。那么解决这个问题的更好方法是什么

# scheduled-tasks - 获取 web.config 中配置的任务的上次运行时间

> ID：11123005
> 
> 赞同：0
> 
> 时间：2012-06-20T15:32:22.047
> 
> 标签：scheduled-tasks, sitecore, task

对于 web.config 中配置的任务，有没有办法找出该任务最后一次运行的时间？从字段保存此信息的 Sitecore 任务中配置的任务中很容易弄清楚这一点。我试图在 Sitecore API 中找到一些东西，但没有成功。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T17:43:26.610

是的，Sitecore 日志中有 INFO 条目会告诉您作业何时运行。日志文件夹可以位于您的数据文件夹内，该文件夹可以位于`web.config`密钥上`dataFolder`

# macos - 在 Perl 的 Mac::FSEvents 中检查哪些文件发生了变化？

> ID：11123007
> 
> 赞同：1
> 
> 时间：2012-06-20T15:32:40.207
> 
> 标签：macos, perl, fsevents

每当使用以下命令调用更改事件时，是否可以查看哪些文件已更改： [https](https://metacpan.org/pod/Mac::FSEvents) ://metacpan.org/pod/Mac::FSEvents ？

非常感谢！:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-21T00:51:19.797

文件系统事件 API 旨在镜像大型文件更改树，如果您想镜像特定的文件更改，最好使用[IO::KQueue](http://search.cpan.org/dist/IO-KQueue/)。perl 绑定缺少一些用于事件标志的常量，但您可以从[File System Events Programming Guide](http://developer.apple.com/library/mac/#documentation/Darwin/Conceptual/FSEvents_ProgGuide/Introduction/Introduction.html)获得这些。

这个脚本应该让你开始，它打印出任何文件事件`'/path'`

```
#!/usr/bin/perl
use strict;
use warnings;

use IO::Select    qw[];
use Mac::FSEvents qw[FILE_EVENTS];

my $fse = Mac::FSEvents->new({
    path  => '/path',
    flags => FILE_EVENTS
});

my $select = IO::Select->new($fse->watch);

# http://developer.apple.com/library/mac/#documentation/Darwin/Reference/FSEvents_Ref/FSEvents_h/index.html#//apple_ref/c/tag/FSEventStreamEventFlags
my %names = reverse (
    kFSEventStreamEventFlagNone              => 0x00000000,
    kFSEventStreamEventFlagMustScanSubDirs   => 0x00000001,
    kFSEventStreamEventFlagUserDropped       => 0x00000002,
    kFSEventStreamEventFlagKernelDropped     => 0x00000004,
    kFSEventStreamEventFlagEventIdsWrapped   => 0x00000008,
    kFSEventStreamEventFlagHistoryDone       => 0x00000010,
    kFSEventStreamEventFlagRootChanged       => 0x00000020,
    kFSEventStreamEventFlagMount             => 0x00000040,
    kFSEventStreamEventFlagUnmount           => 0x00000080,
    kFSEventStreamEventFlagItemCreated       => 0x00000100,
    kFSEventStreamEventFlagItemRemoved       => 0x00000200,
    kFSEventStreamEventFlagItemInodeMetaMod  => 0x00000400,
    kFSEventStreamEventFlagItemRenamed       => 0x00000800,
    kFSEventStreamEventFlagItemModified      => 0x00001000,
    kFSEventStreamEventFlagItemFinderInfoMod => 0x00002000,
    kFSEventStreamEventFlagItemChangeOwner   => 0x00004000,
    kFSEventStreamEventFlagItemXattrMod      => 0x00008000,
    kFSEventStreamEventFlagItemIsFile        => 0x00010000,
    kFSEventStreamEventFlagItemIsDir         => 0x00020000,
    kFSEventStreamEventFlagItemIsSymlink     => 0x00040000
);

use constant kFSEventStreamEventFlagItemIsFile => 0x00010000;

while ($select->can_read) {
    for my $event ($fse->read_events) {
        my $flags = $event->flags;
        my @names;

        next unless $flags & kFSEventStreamEventFlagItemIsFile;

        while ((my $flag = $flags & -$flags) != 0) {
            push @names, $names{$flag} || sprintf '0x%.8X';
            $flags &= ~$flag;
        }

        printf qq['%s': %s\n], $event->path, join ' | ', @names;
    }
}
$fse->stop; 
```

示例事件：

```
$ echo foo > foo.txt
'/path/foo.txt': kFSEventStreamEventFlagItemCreated | kFSEventStreamEventFlagItemModified | kFSEventStreamEventFlagItemIsFile

$ touch foo.txt
'/path/foo.txt': kFSEventStreamEventFlagItemInodeMetaMod | kFSEventStreamEventFlagItemIsFile

$ echo foo >> foo.txt
'/path/foo.txt': kFSEventStreamEventFlagItemModified | kFSEventStreamEventFlagItemIsFile

$ mv foo.txt bar.txt
'/path/foo.txt': kFSEventStreamEventFlagItemRenamed | kFSEventStreamEventFlagItemIsFile
'/path/bar.txt': kFSEventStreamEventFlagItemRenamed | kFSEventStreamEventFlagItemIsFile

$ rm bar.txt
'/path/bar.txt': kFSEventStreamEventFlagItemRemoved | kFSEventStreamEventFlagItemIsFile 
```

# r - R：如何对数据框中定义的不同时间段内的数据进行平均？

> ID：11123008
> 
> 赞同：2
> 
> 时间：2012-06-20T15:32:47.450
> 
> 标签：r

假设我有一个数据框“数据”，其中包含测量变量 x 的时间序列数据：

```
 date            x
2009/10/01 00:00    10
2009/10/01 01:00    11
2009/10/01 02:00    12
2009/10/01 03:00    13
2009/10/01 04:00    14
2009/10/01 05:00    15
2009/10/01 06:00    16
2009/10/01 07:00    17
2009/10/01 08:00    18
2009/10/01 09:00    19
2009/10/01 10:00    20
2009/10/01 11:00    21
2009/10/01 12:00    22
2009/10/01 13:00    23
2009/10/01 14:00    24
2009/10/01 15:00    25
2009/10/01 16:00    26
2009/10/01 17:00    27
2009/10/01 18:00    28
2009/10/01 19:00    29
2009/10/01 20:00    30
2009/10/01 21:00    31
2009/10/01 22:00    32
2009/10/01 23:00    33
2009/10/02 00:00    34
... 
```

另一个数据框“事件”具有由开始和停止日期定义的不同时间段：

```
id        start              stop
1   2009/10/01 02:00    2009/10/01 04:00
2   2009/10/01 07:00    2009/10/01 10:00
3   2009/10/01 08:00    2009/10/01 20:00
... 
```

现在我想得到一个 x 在不同事件中的平均值表，如下所示：

```
id  mean.x
1   13
2   18.5
3   25.5 
```

在数据库中，我执行如下简单的 SQL 语句：

```
SELECT a.id, avg(b.x) 
FROM events as a, data as b 
WHERE b.date between a.start and a.stop 
GROUP BY a.id 
```

我想知道我怎么能在 R 中做这样的平均？如果我在数据中有一个 id 列指示哪个数据点属于哪个事件，我可以使用“聚合”，但我找不到创建此列的方法......

任何建议将不胜感激。

辛

编辑：

输入（数据）：

```
structure(list(date = structure(c(1254348000, 1254351600, 1254355200, 
1254358800, 1254362400, 1254366000, 1254369600, 1254373200, 1254376800, 
1254380400, 1254384000, 1254387600, 1254391200, 1254394800, 1254398400, 
1254402000, 1254405600, 1254409200, 1254412800, 1254416400, 1254420000, 
1254423600, 1254427200, 1254430800, 1254434400), class = c("POSIXct", 
"POSIXt"), tzone = "Europe/Berlin"), x = 10:34), .Names = c("date", 
"x"), row.names = c(NA, -25L), class = "data.frame") 
```

输入（事件）：

```
structure(list(id = 1:3, start = structure(c(1254355200, 1254373200, 
1254387600), class = c("POSIXct", "POSIXt"), tzone = "Europe/Berlin"), 
    stop = structure(c(1254362400, 1254384000, 1254420000), class = c("POSIXct", 
    "POSIXt"), tzone = "Europe/Berlin")), .Names = c("id", "start", 
"stop"), row.names = c(NA, -3L), class = "data.frame") 
```

编辑2：

输入（事件2）：

```
structure(list(id = structure(1:3, .Label = c("AGH", "TRG", "ZUH"
), class = "factor"), start = structure(c(1254355200, 1254358800, 
1254358800), class = c("POSIXct", "POSIXt"), tzone = "Europe/Berlin"), 
    stop = structure(c(1254362400, 1254384000, 1254420000), class = c("POSIXct", 
    "POSIXt"), tzone = "Europe/Berlin")), .Names = c("id", "start", 
"stop"), row.names = c(NA, -3L), class = "data.frame") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T18:18:34.957

尝试这个：

```
library(sqldf)
sqldf("
    SELECT a.id, avg(b.x) 
    FROM events as a, data as b 
    WHERE b.date between a.start and a.stop 
    GROUP BY a.id 
") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T16:24:58.023

您可以像这样获取每个日期属于什么事件的列表：

```
event.indices = sapply(data$date, function(d) which(d >= events$start & d <= events$stop)) 
```

问题是如果它们不属于任何事件，它们中的一些将是空的。所以你用 NA 替换那些，你就在路上：

```
event.indices = sapply(event.indices, function(i) ifelse(is.null(i), NA, i)) 
```

根据您的数据，这是：

```
 [1] NA NA  1  1  1 NA NA  2  2  2  2  3  3  3  3  3  3  3  3  3  3 NA NA NA NA 
```

然后，您可以将其添加到原始数据框中，并按照您最初的建议使用聚合。

注意：这是假设每个日期都保证最多属于一个事件。如果事件重叠（即使一个事件恰好在最后一个事件结束时开始），您必须决定如何处理属于多个事件的日期并进行适当调整。

# c#-2.0 - 如何在 xslt 1.0 中缓存 xml 文档

> ID：11123012
> 
> 赞同：0
> 
> 时间：2012-06-20T15:33:06.533
> 
> 标签：c#-2.0, xslt-1.0

我正在使用 XSLT 1.0 和 C# 2.0。我想缓存我加载的文档，这样每当调用下一页时，它应该使用缓存文档而不是再次加载它。

这是 XSLT 的一部分，我在 param **sitespath**中从 C# 获取物理路径，我知道我可以使用 C# 缓存此文档，但我正在寻找在 xslt 1.0 中缓存加载的文档

示例代码：

```
<xsl:param name="sitespath"/>
<xsl:variable name="siteInfoPath" select="document($sitespath)/sitedata/region/site/language"/> 
```

现在我想缓存**siteInfoPath**变量，以便每次它不将其作为文档加载时，它会首先检查缓存的变量尝试从缓存中加载，否则它将再次加载。

这是可能的吗？

请推荐！！

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T16:03:34.533

我认为您不能在 xslt 中缓存 document() 函数的结果以进行多次转换。document() 函数在运行时进行评估。但是，您可以做的是在您的 c# 程序中缓存文档并将其作为外部参数传递给转换（您可能必须传递 XPathNavigator；请参阅此处的 XsltArgumentList.AddParam 文档[http://msdn.microsoft.com/en -us/library/system.xml.xsl.xsltargumentlist.addparam.aspx](http://msdn.microsoft.com/en-us/library/system.xml.xsl.xsltargumentlist.addparam.aspx)了解更多详细信息）。

# c - 将无符号变量分配给有符号值有什么意义？

> ID：11123014
> 
> 赞同：0
> 
> 时间：2012-06-20T15:33:08.503
> 
> 标签：c, unsigned, signed

我正在查看的这段代码有很多地方我看到这样的事情发生：

```
char *functionName(char *passedVariable)
{
    unsigned char *newVariable = (char* ) passedVariable; 
```

为什么要这样做？我总是尽量在有符号/无符号的使用上保持一致，因为我知道在两者之间切换会导致问题，但是这个开发者似乎并不在意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T15:44:16.060

更改指针类型并不是真正的问题，此地址仍然有效。但是，当且仅当……有符号数据为负时，将指向的数据解释为有符号/无符号会有所不同。所以在你的例子中，如果你`char`的总是积极的，那么没关系，否则不是。

有符号/无符号转换示例：

```
char c = 42;
char d = -42;
unsigned char cu = c;
unsigned char du = d;

printf("c  %d\n", c);
printf("cu %d\n", cu);
printf("d  %d\n", d);
printf("du %d\n", du); 
```

输出：

```
c  42
cu 42
d  -42
du 214 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T15:37:24.413

例如，它们可能是 UTF-8 字符串，它由无符号字节组成，并且可能需要手动处理，但它们可以安全地传递给 printf，在许多平台上它需要一个带符号的字符，所以你必须在某个地方转换为避免警告。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T15:37:39.917

对于您的示例看起来像的字符串，这可能无关紧要。ASCII 值仅在 0-127 之间，这意味着它们可以毫无问题地适合有符号或无符号字符。此外，未装饰的符号`char`是实现定义的（因此存在`signed`关键字）。如果`char`是无符号类型，则您的示例根本不会有任何符号转换。

通常，在使用使用不同编码风格或对`char`. 在这种情况下，并不总是可以保持一致，但是强制转换以更改字符串指针的符号不太可能导致任何问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-20T15:38:38.647

对于指针来说，这并不重要，只要有符号和无符号字符在内存中的大小相同，这只是地址。并且 unsigned char * 对任意内存地址最有意义——这就是为什么大多数纯内存函数将其作为参数

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-20T16:18:08.040

C 语言没有指定 的有符号性，因为字符本质上不是有符号值，并且当 C 标准化时，一些实现将它们视为有符号，而另`char`一些则没有。因此，转换`char`为`signed char`or总是安全的`unsigned char`。前者并不常见，但后者是为了将 char 用作数组索引或 ctype.h`is...`和`to...`函数的参数。但是如果没有看到任何使用`unsigned char*`指针的实际代码，就不可能确定为什么要使用它。

# asp.net-web-api - 何时使用 HttpMessageHandler 与 ActionFilter？

> ID：11123015
> 
> 赞同：54
> 
> 时间：2012-06-20T15:33:09.190
> 
> 标签：asp.net-web-api

看来这两者的目的是相似的。很高兴看到一些示例何时使用一个而不是另一个，利弊，并指出主要区别是什么。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-08-05T19:39:29.420

> 他们两个之间的主要区别是他们的重点。消息处理程序适用于所有 HTTP 请求。它们执行 HTTP 中介的功能。过滤器仅适用于分派到应用过滤器的特定控制器/操作的请求。
> 
> 当您希望将行为应用于绝大多数请求时，您应该使用 MessageHandlers。当过滤器仅适用于某些资源时，应使用过滤器。

![在此处输入图像描述](../Images/cfc3edaeb7b4b93adaaecd5f32471de9.png)

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2015-06-05T13:32:36.467

处理程序和操作过滤器之间的一个很大区别是它们执行的阶段。动作过滤器在控制器分派和模型绑定发生后执行，因此您可以与处理请求的控制器实例交互，以及直接访问传递给动作方法的类型化模型对象。我已经使用这种方法来执行请求/响应值的高级记录 - 因为我可以访问控制器，所以我能够记录有关如何处理请求的其他信息。

消息处理程序在流程的早期执行，并且比过滤器更接近原始请求/响应值（将处理程序中使用的 HttpRequestMessage/HttpResponseMessage 对象与过滤器中可用的更丰富的 HttpActionContext 和 HttpActionExecutedContext 对象进行对比）。这使得它们对于某些活动可能更有效，例如，如果您尝试确定是否需要提前终止请求。如果您知道请求应该被拒绝，处理程序将允许您在 WebApi 基础设施着手实例化控制器、执行模型绑定等工作之前执行此操作。

另一个区别是处理程序是链式的，您可以更好地控制链的执行方式。尽管过滤器是按顺序调用的，但是在一个过滤器中设置响应将有效地结束请求，从而阻止执行列表中的下一个过滤器。例如，如果您的第一个过滤器在您的模型为空时返回错误请求，并且有第二个过滤器来记录请求，那么一旦第一个过滤器生成错误请求，您的第二个过滤器将不会执行。使用处理程序，仍然可以（尽管不一定可取！）调用内部处理程序并允许处理程序链正常运行。

# objective-c - 弹出框消失时我可以发出通知吗（iPad）

> ID：11123018
> 
> 赞同：3
> 
> 时间：2012-06-20T15:33:35.273
> 
> 标签：objective-c, ios, ipad, notifications, uipopovercontroller

当用户在弹出框外按下时，我需要通过通知或其他方式知道。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-20T15:43:35.747

为什么不实现`UIPopoverControllerDelegate`协议？

假设您有一个`MyController`显示弹出框的控制器。在 MyController.h 中说它实现`UIPopoverControllerDelegate`如下；

```
@interface DocumentViewController : UIViewController <UIPopoverControllerDelegate> 
```

现在，在 .m 某个地方，您可以显示弹出框并将其委托设置为`self`（这意味着`MyController`它将成为弹出框的委托）。

```
UIPopoverController* pop = // init the popover here
pop.delegate = self; 
```

此时，您可以实现该协议中列出的方法（通常，您必须实现所需的方法）。在您的情况下，您可以实现以下内容：

```
- (BOOL)popoverControllerShouldDismissPopover:(UIPopoverController *)popoverController
{
    // here I'm closing the popover...
}

- (void)popoverControllerDidDismissPopover:(UIPopoverController *)popoverController
{    
    // here I closed the popover...
} 
```

有关详细信息，请参阅[UIPopoverControllerDelegate 类参考](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIPopoverControllerDelegate_protocol/Reference/Reference.html)。

希望有帮助。

# sorting - 将排序顺序保存在数据库中

> ID：11123019
> 
> 赞同：0
> 
> 时间：2012-06-20T15:33:41.937
> 
> 标签：sorting

我是一名网络开发人员，目前我正在使用一种非常烦人的方法，我认为我的 cms 的以下方法很困难；

我正在制作一个画廊，我想让用户选择如何订购/排序图像。所以他可以更改显示它们的顺序（[http://jqueryui.com/demos/sortable/](http://jqueryui.com/demos/sortable/)）。但是接下来要做什么；如何在数据库中保护这个订单？目前我有一个带有 id 的额外表格，它们必须按顺序出现在网站上。我猜想很难。

谁知道更好的方法？这很难维护。我正在使用 codeigniter 和 jquery。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:09:02.050

为 Image_Order
创建图像列表在数据库表中添加一个额外字段 [photo_ord]

```
<li class="left" id="someId">        
<a href="#" >
<img src="image path here" alt="error" id="image_id_here" class="img_thumb"/>
</a>
</li> 
```

函数处理程序（它会在任何图像移动时调用）

```
<a href="#" onclick="change_order()" class="btn_1">Save Order</a> 
```

函数将对更新图像顺序进行 ajax 调用

```
function change_order()
{
    var urlst="";
    var co=1;
    $('.img_thumb').each(function()
    {
        urlst=urlst+this.id+'#'+co+'*';
        co++;
    });
    $.ajax(
    {
        type:"POST",
        url:"xhr_change_image_order.php",
        data:"orader="+urlst,
        success:function(data)
        {
            if(data=="changed")
                alert("Image order changed.");            
        },
        error:function()
        {
            alert('error occure');
        }
    });
} 
```

文件：xhr_change_image_order.php（将更新数据库）

```
<?php    
$url = $_POST['orader'];
$photo_arr = explode("*", $url);
foreach ($photo_arr as $k => $ph) {
    if (strlen($ph) > 1) 
    {
          // Update Query 
          // $arr[0]  will contain image id
          // $arr[1]  will contain image order            
            UPDATE `photo` SET `photo_ord` =  $arr[1]  WHERE `photo_id` = $arr[0];
    }
}
echo "changed";
?> 
```

之后，当创建图库时只需使用 ORDER BY 子句获取数据

```
SELECT * FROM photo ORDER BY  photo_ord asc or DESC 
```

# .net - WIN2K8 R2 公共消息队列

> ID：11123022
> 
> 赞同：1
> 
> 时间：2012-06-20T15:33:44.573
> 
> 标签：.net, msmq, public

我有一个小域（6 个服务器），我需要使用 MSMQ。该项目的代码库来自一家使用 WIN2K3 服务器的公司的一个 5 年历史的项目，并且所有功能都可以正常工作。

我已在所有服务器上启用了 MSMQ 功能（包括 AD 集成）。

我在所有服务器上创建了 PUBLIC 队列。

当代码尝试列出远程服务器上的所有公共队列时，代码指示有 0 个公共队列。

```
MessageQueue[] MqList = MessageQueue.GetPublicQueuesByMachine(HostName); 
```

它不会抛出异常，它根本看不到队列。

此外，当我使用计算机管理管理单元连接到远程计算机时，我看不到消息队列节点。我能够在 WIN2K3 中看到远程消息队列节点。（见图片）![在此处输入图像描述](../Images/cac65b8ea7049fc265b284568633c9a1.png)

我认为这是一个权限问题，但我试图尽可能广泛地开放权限，但我仍然没有得到爱。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T20:20:36.960

我还发现 GetPublicQueuesByMachine 方法在 Win2K8 服务器上不起作用。

我发现 GetPublicQueues 确实有效。所以我使用它并以这种方式拉出我需要的队列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T11:10:45.133

该方法`GetPublicQueuesByMachine()`确实**不适**用于远程访问。

您可以在 MSDN 文档的功能矩阵中看到这一点：[MessageQueue.GetPublicQueuesByMachine](http://msdn.microsoft.com/en-us/library/system.messaging.messagequeue.getpublicqueuesbymachine.aspx)：

> 下表显示了此方法是否适用于各种工作组模式。
> 
> ```
>  Workgroup mode                         Available
>  --------------                         ---------
>  Local computer                         No
>  Local computer and direct format name  No
>  Remote computer                        No
>  Remote computer and direct format name No 
> ```

我最近才发现 Queue 类的大多数方法都有这样的特征矩阵。:-)

# javascript - 将数组从控制器传递到 Javascript

> ID：11123028
> 
> 赞同：1
> 
> 时间：2012-06-20T15:34:00.180
> 
> 标签：javascript, asp.net-mvc-3, controller

我在将数组从控制器传递到视图中的 javascript 时遇到了一些问题。我正在使用 ASP .Net MVC3，我正在尝试使用数据库中的数据制作一些图表/图形，我找到了 HighCharts javascript，我正在尝试使用它。

这是示例：

```
$(function () {
var chart;
$(document).ready(function() {
    chart = new Highcharts.Chart({
        chart: {
            renderTo: 'container',
            plotBackgroundColor: null,
            plotBorderWidth: null,
            plotShadow: false
        },
        title: {
            text: 'Browser market shares at a specific website, 2010'
        },
        tooltip: {
            formatter: function() {
                return '<b>'+ this.point.name +'</b>: '+ this.percentage +' %';
            }
        },
        plotOptions: {
            pie: {
                allowPointSelect: true,
                cursor: 'pointer',
                dataLabels: {
                    enabled: true,
                    color: '#000000',
                    connectorColor: '#000000',
                    formatter: function() {
                        return '<b>'+ this.point.name +'</b>: '+ this.percentage +' %';
                    }
                }
            }
        },
        series: [{
            type: 'pie',
            name: 'Browser share',
            data: [
                ['Firefox',   45.0],
                ['IE',       26.8],
                ['Chrome',       12.8],
                ['Safari',    8.5],
                ['Opera',     6.2],
                ['Others',   0.7]
            ]
        }]
    });
});

}); 
```

我做了这门课：

```
public class RegistoPie
{
    public string na { get; set; }
    public double da { get; set; }

    public RegistoPie(string n, double d) {

        na = n;
        da = d;

    }
} 
```

我将此对象发送到试图在javascript中填充**数据变量的视图：**

```
var pie = new [] { new RegistoPie("papa",20.0), new RegistoPie("pepe",50.0) }; 
```

但它返回的内容如下：

```
[{"na":"papa","da":20},{"na":"pepe","da":50}]; 
```

所以它的语法与javascript中的**数据**变量不同，只有：

```
[[string,double], [,] , ... ] 
```

帮助任何人？！泰，赫尔德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T15:59:34.423

在控制器中：

```
ViewBag.Array = new[] { new RegistoPie("papa", 20.0), new RegistoPie("pepe", 50.0) }; 
```

在视图中：

```
@{
    var myArray = ViewBag.Array as TestMVC.Controllers.RegistoPie[];

    for (int i = 0; i < myArray.Length; i++)
    {
        var item = myArray[i];
    <text> ['@item.na', @item.da] @((myArray.Length - 1) != i ? "," : "")</text>
    }
} 
```

# datetime - Solr 的日期时间字段存储错误

> ID：11123032
> 
> 赞同：0
> 
> 时间：2012-06-20T15:34:08.127
> 
> 标签：datetime, solr, format

为什么当我尝试将日期时间 000-00-00T00:00:00Z（数据源是 Mysql）存储到 solr 时，它被保存为 0002-11-30T00:00:00Z？

Solr 可以存储格式为 0000-00-00T00:00:00Z 的日期时间吗？

```
<response>
<lst name="responseHeader">
  <int name="status">0</int>
  <int name="QTime">2</int>
</lst>
<result name="response" numFound="334" start="0">
<doc>
  <short name="contacts">0</short>
  <str name="country">PT</str>
  <str name="email"/>
  <date name="first_visit_datetime">0002-11-30T00:00:00Z</date>
  <long name="id">101</long>
  <date name="last_visit_datetime">0002-11-30T00:00:00Z</date>
  <str name="name"/>
  <str name="organization"/>
  <str name="phone"/>
  <str name="region">14</str>
  <short name="visits">0</short>
</doc> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T15:38:05.830

不，它源自[ISO 8601](http://lucene.apache.org/solr/api/org/apache/solr/schema/DateField.html)，我认为它始终相同。

# actionscript-3 - Actionscript 3：mouse_over & mouse_out 导致错误 #1009？

> ID：11123033
> 
> 赞同：0
> 
> 时间：2012-06-20T15:34:10.550
> 
> 标签：actionscript-3

当我将鼠标悬停在 buttonSprite 上时，它会将 displaySprite 添加到舞台，当我将鼠标移出 buttonSprite 时，会删除 displaySprite。

我的问题是，当我将鼠标快速移出 buttonSprite 几次时，不会删除 displaySprite 并显示错误消息（错误＃1009）。即使我输入“displaySprite = null”，它仍然无法正常工作。有什么建议么？谢谢

```
var buttonSprite:Sprite = new Sprite();
addChild(buttonSprite);
buttonSprite.addEventListener(MouseEvent.MOUSE_OVER, overSprite);

var displaySprite:Sprite;

function overSprite(e:MouseEvent):void{

    displaySprite = new Sprite();
    addChild(displaySprite);
    buttonSprite.addEventListener(MouseEvent.MOUSE_OUT, outSprite);

}
function outSprite(e:MouseEvent):void{

    removeChild(displaySprite);
    displaySprite = null;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T19:34:45.083

不能保证事件会按顺序触发。
在您的情况下，您不必多次实例化 displaySprite。
只是不要将其清空，对象就会在那里。

```
var buttonSprite:Sprite = new Sprite();
addChild(buttonSprite);
buttonSprite.addEventListener(MouseEvent.MOUSE_OVER, overSprite);

//you only need to create it once.
var displaySprite:Sprite = new Sprite();

function overSprite(e:MouseEvent):void{
    addChild(displaySprite);
    buttonSprite.addEventListener(MouseEvent.MOUSE_OUT, outSprite);
}
function outSprite(e:MouseEvent):void{
    removeChild(displaySprite);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T15:49:28.147

这个怎么样？

```
var buttonSprite:Sprite = new Sprite();
addChild(buttonSprite);
buttonSprite.addEventListener(MouseEvent.MOUSE_OVER, overSprite);
buttonSprite.addEventListener(MouseEvent.MOUSE_OUT, outSprite);

var displaySprite:Sprite;
addChild(displaySprite);
displaySprite.visible=false;

function overSprite(e:MouseEvent):void
{
    displaySprite.visible = true;
}

function outSprite(e:MouseEvent):void
{
    displaySprite.visible = false;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T15:54:45.950

问题是当您将鼠标悬停在显示对象上时，MouseEvent.MOUSE_OVER 会被多次调度。您应该尝试的是 MouseEvent.ROLL_OVER 和 MouseEvent.ROLL_OUT 这两个事件被调度一次。

类似的东西：

```
var buttonSprite:Sprite = new Sprite();
addChild(buttonSprite);
buttonSprite.addEventListener(MouseEvent.ROLL_OVER, overSprite);
buttonSprite.addEventListener(MouseEvent.ROLL_OUT, outSprite);
var displaySprite:Sprite;

function overSprite(e:MouseEvent):void
{
    if(!displaySprite)
    {
       displaySprite = new Sprite();
       addChild(displaySprite);
    }

}

function outSprite(e:MouseEvent):void{
    if(displaySprite)
    {
        removeChild(displaySprite);
        displaySprite = null;
    }

} 
```

# magento - Magento 的空白主题是否仍应用作主题基线（Magento 1.7 版）？

> ID：11123034
> 
> 赞同：4
> 
> 时间：2012-06-20T15:34:13.177
> 
> 标签：magento, themes

我在 Magento 主题开发中找到的大量教程建议从使用空白作为制作您自己的自定义主题的指南开始。很多这些文章都很老了，从当前版本（1.7）开始，现在还是这样吗？

PS - 如果有任何好的/相关的主题开发文章，除了 Magento 的[官方设计指南](http://www.magentocommerce.com/design_guide)，请随时链接它们。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T16:00:37.843

在我看来，你永远不应该从基本主题中“雕刻”出你自己的主题。您并没有完整地学习主题开发。您可能会遇到无法预料的后果。完成后，您可能会有多余的代码和模板。

我写了一个 Magento 1.6.1 教程来创建一个应该支持 1.7 的主题：

[http://zaclee.net/magento/make-magento-1-6-theme-from-scratch](http://zaclee.net/magento/make-magento-1-6-theme-from-scratch)

如果您在 1.7 中遇到任何问题，请告诉我，我很乐意接受。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-20T16:29:43.457

我同意上述答案，因为将现有主题（即您购买的商业主题）转换为适合您已经给出或自己完成的设计可能会更加消耗。你最终做的删除比添加更多，并且不可避免地会导致大量没有被使用的代码（因为删除它可能会导致问题，截止日期即将到来......sod it，它只有几 Kb，你把它留在里面）。

但是，我不同意 Magento 空白主题会导致代码和模板过多的说法。首先，您只需要提取您需要的模板，并且主题几乎是最基本的。我总是以空白主题为基础。很可能我当时还没有完全学习主题开发，但工作必须完成，必须支付账单 - 而且我不会每次都坐下来从头开始构建所有东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T17:06:33.483

为了进一步讨论，一段时间以来，我确实被 Magento 附带的默认 CSS 所困扰。工作起来很痛苦，当你开始在一个多人处理 CSS 的环境中开发时，你不可避免地会遇到[CSS Kudzu](http://www.slideshare.net/stubbornella/5-mistakes-of-massive-css)。

一段时间以来，我一直在考虑将默认 CSS 完全重写为更易于维护和精简的内容，但就像 rabmcnab 提到的那样，有截止日期、需要支付的账单等。

# python - 使用 Python 3.2 解析并打印文本文件中的属性值

> ID：11123042
> 
> 赞同：0
> 
> 时间：2012-06-20T15:34:45.407
> 
> 标签：python, file-io, python-3.x

我刚开始使用/学习 Python 并且有一些问题。

我有一个由报告工具生成的文本文件。该文件包含一些这样的东西。有很多东西基本上遵循与下面写的相同的格式。

> 格式= {
> Window_Type="Tabular",
> Tabular= { Num_row_labels=5 } }

此文件中有命名值属性。例如，Window_Type 是具有值 Tabular 的属性的名称。同样，对于 Tabular 命名属性，其关联值为 5。

我想要做的是打开文件。

1.  检查 Window_Type 是否为表格
2.  如果是，则检查与表格关联的 Num_row_labels。
3.  如果 Num_row_lables 的值大于或等于 5，则打印文本文件的名称和该文件所在的文件夹的路径。

我在 Eclipse 3.7.2 IDE 中使用 Python 3.2。

对于测试部分，我在 IDE 中导入了我的文本文件，并使用下面的代码来读取文件。将来我应该能够遍历扩展名为 mrk 的文件所在的文件夹。（这将是一个已知目录，因为我们将这些文件保存在其中。）请帮助我。非常感谢！

```
import os.path
fn = os.path.join(os.path.dirname(__file__), 'Multitab.mrk')
with open(fn, 'r') as file: 
    print(file.read()) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T18:00:37.473

请注意，这个答案是一个非常肮脏的黑客。这种格式几乎类似于 JSON 格式，这促使我编写了一个 RE 来转换字符串，以便它可以被 json 解析器干净地解析。这就是我所做的：

```
import re
import json

s = """Format= {
Window_Type="Tabular",
Tabular= { Num_row_labels=5 } }"""

s = "{" + re.sub(r'([a-zA-Z0-9_]+)=',r'"\1":', s) + "}"
obj = json.loads(s)

if obj['Format']['Window_Type'] == "Tabular":
    print "Its tabular!"
    numrows = obj['Format']['Tabular']['Num_row_labels']
    print "Numrows:", numrows
    if numrows >= 5:
        print "Print this fileName" 
```

输出：

```
Its tabular!
Numrows: 5
Print this fileName 
```

# c# - 如何从 SQL 数据库中只更新 DataView 中的一行？

> ID：11123043
> 
> 赞同：1
> 
> 时间：2012-06-20T15:34:49.187
> 
> 标签：c#, sql, datagridview, dataview

我有一个加载了数据的网格的情况。它不受数据约束。单击图像会打开另一个表单，该表单允许更改网格中的数据。

现在更改的数据（1 行）被写入数据库，整个网格从现在包含更改的数据库中重新加载。

我的问题是我可以更新数据视图中的数据吗？这样我就可以纠正对数据库的更改并更新 DataView，而不必每次都浸入数据库，并且基本上避免重新加载 1000 行数据，因为我更改了一个。

如何更改 DataView 中的一行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T15:44:29.607

这不是一个普遍支持的功能，因为它仅在您使用已知 PK 进行直接 select * from table 查询时才有效。每当您有任何联接或涉及的聚合函数等时，都需要执行整个查询才能获取该行的值。

你为什么不使用数据绑定？如果您的网格绑定到数据表，并且您以这种方式进行更新，那么网格将由于绑定到表而自动更新。

即使您不想进行完整的往返数据绑定，如果您仍然使用表，只需使用适当的更改更新表，然后重新绑定网格。

# iphone - 替换 NSFileWrappers

> ID：11123051
> 
> 赞同：6
> 
> 时间：2012-06-20T15:35:12.850
> 
> 标签：iphone, objective-c, cocoa, nsfilewrapper

我有一个 NSFileWrapper 目录，我想在其中更新某个 FileWrapper。我想知道最好的方法是什么？

到目前为止，我已经使用了这段代码：

```
[self.fileWrapper addRegularFileWithContents:photoData 
                           preferredFilename:@"photo.data"]; 
```

但是，只要 FileWraper 已经存在，我就会在 FileWrapper 中得到重复项，如下所示：

```
"1__#$!@%!#__photo.data" = "<NSFileWrapper: 0x6bb0260>";
"2__#$!@%!#__photo.data" = "<NSFileWrapper: 0x6b89b80>";
"3__#$!@%!#__photo.data" = "<NSFileWrapper: 0x6ba1700>";
"4__#$!@%!#__photo.data" = "<NSFileWrapper: 0x6bc8480>";
"photo.data" = "<NSFileWrapper: 0x6bcfc50>"; 
```

如何防止这种情况并简单地替换 FileWrapper - 在这种情况下为 photo.data？我没有在[NSFileWrapper Class Reference](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSFileWrapper_Class/Reference/Reference.html)中找到任何替换 FileWrappers 的方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-20T15:57:02.840

我认为这可能是解决方案：

```
NSFileWrapper *oldFileWrapper = [self.fileWrapper.fileWrappers objectForKey:fileName];
if (oldFileWrapper) [self.fileWrapper removeFileWrapper:oldFileWrapper];

[self.fileWrapper addRegularFileWithContents:[self encodeObject:object] 
                           preferredFilename:fileName]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-08T21:34:57.480

我只是偶然发现了这个问题，对我来说这是因为我有一个名为**"Resources"**的文件夹和一个名为**"resources"**的文件夹。这造成了一个 iCloud 问题，因为*在 Mac OS X 上文件系统不区分大小写，但它在 iOS 上*。

看起来您案例中的潜在问题也可能与大写/小写相关。当然，您可以通过替换文件包装器来解决此问题，这会有效地删除并重新创建文件。对于小文件，这可能是一种可接受的解决方案，但对于目录中较大或许多文件的效率可能非常低（因为即使文件没有更改，文件也会被同步）。

# forms - 单选按钮的jQuery验证自定义错误消息显示

> ID：11123055
> 
> 赞同：5
> 
> 时间：2012-06-20T15:35:40.820
> 
> 标签：forms, jquery-validate

我正在使用 jQuery 验证并尝试获取一对单选按钮的错误消息以显示在第一个按钮之前。

这是验证：

```
errorPlacement: function(error, element) {
if (element.attr("type") == "radio")
   error.insertBefore(element.first());
 else
   error.insertAfter(element);
} 
```

这是html：

```
<div class="full">
<label id="sample">Have you received your sample pack?</label>

<input type="radio" name="sample" id="sample_yes" value="yes" />
<label for="eliteflexsample_yes">Yes</label>

<input type="radio" name="sample" id="sample_no" value="no" />
<label for="eliteflexsample_no">No</label>    
</div> 
```

现在，错误出现在第一个单选按钮之后。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-09T21:37:33.530

这是有效的：

```
$(document).ready(function() {

    $('form').validate({

        // your validation options,

        errorPlacement: function(error, element) {
            if (element.attr("type") == "radio") {
                error.insertBefore(element);
            } else {
                error.insertAfter(element);
            }
        }

    });

});​ 
```

[**工作演示：**](http://jsfiddle.net/DR5Aw/2/)

[http://jsfiddle.net/DR5Aw/2/](http://jsfiddle.net/DR5Aw/2/)

# javascript - 是否可以在 gRaphael 中获得 X 轴偏移或填充？

> ID：11123062
> 
> 赞同：2
> 
> 时间：2012-06-20T15:35:59.993
> 
> 标签：javascript, raphael, graphael

我正在尝试在 gRaphael 中创建一个非常简单的折线图。我的问题是我的图表的第一个值总是放在 y 轴上。有没有办法向第一个点添加填充或偏移，使其不在 y 轴上？

我尝试过的一个解决方案是添加另一组 x 值，它们比我的另一行的 x 值小一个和一个大，但这会破坏我的 x 轴标签。

我创建了一个[jsFiddle](http://jsfiddle.net/arosen/SKv3Q/)来说明我的问题。其中第一张图是我目前拥有的，第二张图显示了上述解决方案的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T20:43:01.357

*（虽然[@eterps](https://stackoverflow.com/users/189551/eterps)的建议是可以接受的，而且有时使用现成的解决方案很方便，但我认为有必要使用 gRaphaël 提供解决方案，以帮助其他解决相同问题的人。）*

* * *

*   > ...但这搞砸了我的 x 轴标签

    如果“搞砸”是指缺失值，那么您就快到了。只需将`axisxstep`值更新为 4，考虑到添加的额外 2 个值，您就可以开始了（参见下面的演示）。

*   另一方面，如果您指的是过多的填充 - 我建议使用日期对 x 轴的值进行更语义化的描述，同时为演示文稿（标签）应用日期格式化程序。[Ex Ratione的](http://www.exratione.com/)*原因*在一篇描述这种方法的综合论文中对此进行了描述（见下面的链接）。

    应用此技术后，您可以对格式化的日期值使用填充黑客，并获得更精细的粒度，从而缩小那些丑陋的排水沟。查看下面的第二个演示，了解如何开始使用它。

    ***免责声明：****这种方法需要将[Steven Levithan 的日期格式](http://blog.stevenlevithan.com/archives/date-time-format)作为附加依赖项包含在内。在提交代码之前考虑到这一点。*

**演示：**

*   [`axisxstep`更新](http://jsfiddle.net/eliranmal/SKv3Q/2/)
*   [使用日期格式化程序](http://jsfiddle.net/eliranmal/neYgk/)

**参考：**

*   [*Ex Ratione 上***的 gRaphaël 折线图提示****](http://www.exratione.com/2011/10/a-few-tips-for-graphael-line-charts/)

# go - 有没有更好的方法来停止 Go 中的无限 goroutine？

> ID：11123065
> 
> 赞同：3
> 
> 时间：2012-06-20T15:36:05.430
> 
> 标签：go, goroutine

我使用 goroutines 制作了一个简单的时钟信号：

```
func clockloop(ch chan byte) {
    count := 0
    for {
        time.Sleep(FRAMELEN)
        count++
    innerfor:
        for count {
            select {
                case ch <- 1:
                    count--
                default:
                    break innerfor
            }
        }
    }
}

func MakeClock() chan byte {
    clock := make(chan byte)
    go clockloop(clock)
    return clock
} 
```

我知道这个时钟不精确，但这无关紧要。我想知道的是停止这个 goroutine 的最佳方法是什么？

理想情况下，我希望它在频道的任何听众超出范围时立即停止，但我确实知道如何做到这一点（很像垃圾收集器，但用于 goroutines）。我想出了两种手动停止它的方法：(1) 使用全局停止变量，所有此类 goroutine 都会检查每个循环；(2) 使用停止通道。这些方法的缺点是我必须手动停止 goroutines。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-20T16:11:10.457

停止通道是一个很好的方法。goroutine 必须自行停止。没有办法从外部杀死一个人。

作为参考，Go-Nuts 上有[这个线程](https://groups.google.com/d/topic/golang-nuts/SPAgm0TlWc0/discussion)，Ian 基本上是这么说的，Russ 补充说：“杀死单个 goroutine 是一件非常不稳定的事情：不可能知道这些 goroutine 有哪些锁或其他资源需要清理让程序继续顺利运行。”

# c# - 以编程方式在文本框中移动插入符号，向上和向下

> ID：11123067
> 
> 赞同：5
> 
> 时间：2012-06-20T15:36:09.433
> 
> 标签：c#, winforms, datagridview, textbox, caret

我正在努力在**DataGridView 内的文本框编辑控件中**移动插入符号，向上一行和向下一行，就像用户在按下向上和向下箭头时会得到的一样。

所以我的意思不是换行符之间的行，我的意思是文本框左右两侧之间的行。

我不能使用 GetCharIndexFromPosition 和 GetPositionFromCharIndex，因为并非所有文本都会始终显示在文本框显示区域中。

**编辑：** 我无法模拟 KeyPress，因为我正在处理 DataGridView 中的文本框单元格。我的目标实际上是让箭头键做他们在普通文本框中会做的事情，而不是从一行跳到另一行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:59:03.383

这应该有效。

```
Point pOld = textBox1.GetPositionFromCharIndex(textBox1.SelectionStart);
Point pNew = new Point(pOld.X, pOld.Y + textBox1.Font.Height)
int charIndex = textBox1.GetCharIndexFromPosition(pNew);
textBox1.SelectionStart = charIndex; 
```

我不认为这是最干净的解决方案。也许您应该查看 DataGridView 属性/键处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T16:19:41.837

该方法`GetPositionFromCharIndex()`有`GetCharIndexFromPosition()`两个限制：

1.  它们不适用于超出文本框边界的文本
2.  的字符索引`TextBox.SelectionStart`对于行尾的插入符号和下一行开头的插入符号是相同的。

要纠正此问题，您可以：

1.  在使用上述方法之前，滚动文本框以显示相关行。
2.  使用 user32.dll 中的 GetCaretPos 函数将其与 SelectionStart 的位置进行比较。如果它们不相等，则表示插入符号位于行尾。
3.  模拟 {END} 键按下以将插入符号定位在行尾。

我遇到的另一个问题是`TextBox.Lines`指用换行符分隔的逻辑行，而函数`TextBox.GetLineFromCharIndex()`和`TextBox.GetFirstCharIndexFromLine()`指的是在文本框中显示的视觉线（即从文本框的一侧到另一侧，不必有换行符人物）。不要把它们混在一起。

生成的代码（你可能声称丑陋，但有效）如下：

```
class Utils
{
    [DllImport("user32.dll")]
    static extern bool GetCaretPos(out System.Drawing.Point lpPoint);

    public static void LineUp(TextBox tb)
    {
        int oldCharIndex = tb.SelectionStart;
        int oldLineNo = tb.GetLineFromCharIndex(oldCharIndex);
        System.Drawing.Point oldCharPos = tb.GetPositionFromCharIndex(oldCharIndex);
        System.Drawing.Point oldCaretPos;
        if (GetCaretPos(out oldCaretPos))
        {
            if (oldCharPos == oldCaretPos)
            {
                if (oldLineNo > 0)
                {
                    tb.SelectionStart = tb.GetFirstCharIndexFromLine(oldLineNo - 1);
                    tb.ScrollToCaret();
                    System.Drawing.Point newPos = new System.Drawing.Point(oldCaretPos.X, oldCaretPos.Y - tb.Font.Height);
                    int newCharIndex = tb.GetCharIndexFromPosition(newPos);
                    if (tb.GetPositionFromCharIndex(newCharIndex).Y == newPos.Y)
                    {
                        tb.SelectionStart = newCharIndex;
                    }
                    else
                    {
                        tb.SelectionStart = tb.GetFirstCharIndexFromLine(oldLineNo - 1);
                        System.Windows.Forms.SendKeys.Send("{END}");
                    }
                }
            }
            else
            {
                if (oldLineNo > 1)
                {
                    tb.SelectionStart = tb.GetFirstCharIndexFromLine(oldLineNo - 2);
                    tb.ScrollToCaret();
                    System.Drawing.Point newPos = new System.Drawing.Point(oldCaretPos.X, oldCaretPos.Y - tb.Font.Height);
                    int newCharIndex = tb.GetCharIndexFromPosition(newPos);
                    if (tb.GetPositionFromCharIndex(newCharIndex).Y == newPos.Y)
                    {
                        tb.SelectionStart = newCharIndex;
                    }
                    else
                    {
                        tb.SelectionStart = tb.GetFirstCharIndexFromLine(oldLineNo - 2);
                        System.Windows.Forms.SendKeys.Send("{END}");
                    }
                }
            }
        }
    }

    public static void LineDown(TextBox tb)
    {
        int oldCharIndex = tb.SelectionStart;
        int oldLineNo = tb.GetLineFromCharIndex(oldCharIndex);
        System.Drawing.Point oldCharPos = tb.GetPositionFromCharIndex(oldCharIndex);
        System.Drawing.Point oldCaretPos;
        if (GetCaretPos(out oldCaretPos))
        {
            if (oldCharPos == oldCaretPos)
            {
                if (oldLineNo < tb.GetLineFromCharIndex(tb.Text.Length - 1))
                {
                    tb.SelectionStart = tb.GetFirstCharIndexFromLine(oldLineNo + 1);
                    tb.ScrollToCaret();
                    System.Drawing.Point newPos = new System.Drawing.Point(oldCaretPos.X, oldCaretPos.Y + tb.Font.Height);
                    int newCharIndex = tb.GetCharIndexFromPosition(newPos);
                    if (tb.GetPositionFromCharIndex(newCharIndex).Y == newPos.Y)
                    {
                        tb.SelectionStart = newCharIndex;
                    }
                    else
                    {
                        tb.SelectionStart = tb.GetFirstCharIndexFromLine(oldLineNo + 1);
                        System.Windows.Forms.SendKeys.Send("{END}");
                    }
                }
            }
            else
            {
                System.Drawing.Point newPos = new System.Drawing.Point(oldCaretPos.X, oldCaretPos.Y + tb.Font.Height);
                int newCharIndex = tb.GetCharIndexFromPosition(newPos);
                if (tb.GetPositionFromCharIndex(newCharIndex).Y == newPos.Y)
                {
                    tb.SelectionStart = newCharIndex;
                }
                else
                {
                    tb.SelectionStart = tb.GetFirstCharIndexFromLine(oldLineNo);
                    System.Windows.Forms.SendKeys.Send("{END}");
                }
            }
        }
    }
} 
```

这个想法的功劳归功于[这个答案](https://stackoverflow.com/a/610030/1361941)，您可能还想看看[MSDN 参考上的 GetCaretPos](http://msdn.microsoft.com/en-us/library/windows/desktop/ms648402%28v=vs.85%29.aspx)和[其他 Caret 函数](http://msdn.microsoft.com/en-us/library/windows/desktop/ff468799%28v=vs.85%29.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-15T18:15:23.847

```
 /// ------------------------------------------------------------------------------------
    /// <summary>
    /// Processes up key when a grid cell is in the edit mode. This overrides the default
    /// behavior in a grid cell when it's being edited so using the up arrow will move the
    /// IP up one line rather than moving to the previous row.
    /// </summary>
    /// ------------------------------------------------------------------------------------
    protected virtual bool ProcessUpKey(TextBox txtBox)
    {
        // Don't override the default behavior if all the text is selected or not multi-line.
        if (txtBox.SelectedText == txtBox.Text || !txtBox.Multiline)
            return false;

        int selectionPosition = txtBox.SelectionStart;
        // Getting the position after the very last character doesn't work.
        if (selectionPosition == txtBox.Text.Length && selectionPosition > 0)
            selectionPosition--;
        Point pt = txtBox.GetPositionFromCharIndex(selectionPosition);

        if (pt.Y == 0)
            return false;

        pt.Y -= TextRenderer.MeasureText("x", txtBox.Font).Height;
        txtBox.SelectionStart = txtBox.GetCharIndexFromPosition(pt);
        return true;
    }

    /// ------------------------------------------------------------------------------------
    /// <summary>
    /// Processes down key when a grid cell is in the edit mode. This overrides the default
    /// behavior in a grid cell when it's being edited so using the down arrow will move the
    /// IP down one line rather than moving to the next row.
    /// </summary>
    /// ------------------------------------------------------------------------------------
    protected virtual bool ProcessDownKey(TextBox txtBox)
    {
        // Don't override the default behavior if all the text is selected or not multi-line.
        if (txtBox.SelectedText == txtBox.Text || !txtBox.Multiline)
            return false;

        int chrIndex = txtBox.SelectionStart;
        Point pt = txtBox.GetPositionFromCharIndex(chrIndex);
        pt.Y += TextRenderer.MeasureText("x", txtBox.Font).Height;
        var proposedNewSelection = txtBox.GetCharIndexFromPosition(pt);
        if (proposedNewSelection <= chrIndex)
            return false; // Don't let "down" take you *up*.
        txtBox.SelectionStart = proposedNewSelection;
        return true;
    } 
```

# c# - 对 DataTable 集合的对象进行排序

> ID：11123069
> 
> 赞同：2
> 
> 时间：2012-06-20T15:36:10.697
> 
> 标签：c#, sorting

我使用从数据库中获取所有表

```
tables = Utility.DBConnection.GetSchema("Tables", restrictions); 
```

之后如何按字母顺序排列表格？我检查了`GetSchema`，没有属性可以给出任何排序顺序。

我想稍后做：

```
foreach (DataRow row in tables.Rows) {} 
```

但我想先对表格进行排序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T15:45:29.800

只是从数据集中的集合中复制一个表的数组/列表，然后自己排序？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T15:46:22.570

不确定 Utility.DBConnection.GetSchema 返回什么，但这可能非常接近您想要的：

```
var sortedTables = from table in tables
                   orderby table.TableName ascending
                   select table; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T16:20:28.347

如果表是 DataTable，您可以使用[DataTable.DefaultView 属性](http://msdn.microsoft.com/en-us/library/system.data.datatable.defaultview.aspx)来提供数据的排序视图：

```
DataView view = tables.DefaultView;

view.Sort = "Name";

foreach (DataRowView row in view)
{
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-10T21:28:39.603

您可以使用排序字典 -

```
DataTable dtTables = conn.GetSchema("Tables");
SortedDictionary<string, DataRow> dcSortedTables = new SortedDictionary<string, DataRow>();

foreach (DataRow table in dtTables.Rows) {
    string tableName = (string)table[2];
    dcSortedTables.Add(tableName, table);
}

// Loop through tables
foreach (DataRow table in dcSortedTables.Values) {
    // your stuff here
} 
```

# extjs - 如何从视图中调用设置或获取控制器的配置属性？

> ID：11123073
> 
> 赞同：0
> 
> 时间：2012-06-20T15:36:41.130
> 
> 标签：extjs, view, controller, extjs4, extjs-mvc

我有一个这样的控制器：

```
Ext.define('DigitalPaper.controller.Documents', {
extend: 'Ext.app.Controller',

views:  ['Documents'],
stores: ['Documents'],
models: ['Documents'],

config: {
  defaultColumnSet: undefined  
},.... 
```

**我想从视图**中调用 getDefaultColumnSet 或 setDefaultColumnSet 方法。这可能吗？

我试过了

```
 Ext.app.Controller.getController('Documents'); 
```

但它不起作用！

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:10:51.233

从视图调用控制器方法不是一个好主意。这是可能的，但如果您尝试使用 MVC 范例 - 我会避免这样做。

你到底想达到什么目的？

# c# - 我可以在 .Net 中加载到内存中的 DataTable 的最大大小是多少？

> ID：11123074
> 
> 赞同：6
> 
> 时间：2012-06-20T15:36:43.067
> 
> 标签：c#, .net, ado.net, datatable

我可以在 .Net 中加载到内存中的 DataTable 的最大大小是多少？

是否存在人为限制，或者仅受我运行代码的盒子限制？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-20T15:39:46.720

虽然我不确定内存占用，但存在最大行数。来自[MSDN](http://msdn.microsoft.com/en-us/library/system.data.datatable.aspx)：

> DataTable 可以存储的最大行数为 16,777,216。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-20T15:38:44.313

根据这个[链接](http://forums.asp.net/t/1198310.aspx/1)，它基于你的机器......但我喜欢这个链接，因为如果你想知道限制，你可能做错了什么。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-01-13T07:25:25.840

最大大小受 Int32 限制。所以 2^32 是您可以在 DataSet 中保存的最大 DataTable 数。所以最大大小是 20 亿。大约是 4GB

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-04-09T06:22:50.210

The maximum number of rows that a DataTable can store is 25,558,144 (visual Studio 2016)

# javascript - 延迟javascript函数执行

> ID：11123076
> 
> 赞同：0
> 
> 时间：2012-06-20T15:36:45.900
> 
> 标签：javascript, jquery

我正在使用 jQuery（最新版本）并有一个名为“calculate()”的函数，每次编辑字段和退出字段（模糊等）时都会调用该函数。（允许“动态”计算”）计算需要不到 4 秒的时间来完成，但是如果用户在计算完成之前更改了表单上的另一个元素，那么它们会被排队，并且在当前操作完成后再次调用该函数.由于我无法停止该功能一旦启动就停止处理，是否可以将功能延迟几秒钟，然后每次与表单元素交互时，添加到计时器。

我不认为这是可能的，但我想试一试。

我知道我可以做到： `setTimeout(function(){ ... }, 4000);` 但我需要一种方法来添加到这个计时器。（即计时器还剩 1 秒，我点击一个字段，我希望计时器回到 4 秒）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T15:40:47.980

这可以通过`clearTimeout()`在执行`setTimeout()`清除任何未决操作之前调用来处理。

```
// Declare the variable that holds the timeout pointer at a higher scope
var ts;

// in your onblur
// clear any pending pointer
if (ts) window.clearTimeout(ts);
// then reset the timeout and assign its handle to the same variable ts
ts = window.setTimeout(function() {}, 4000); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T15:41:34.863

我会做的是这样的：

```
var isCalculating = false;
var calculateQueue = false;

function calculate(){
  isCalculating = true;

  // do calculations

  isCalculating = false;

  if(calculateQueue){
    calculate();
  }
}

$('element').blur(function(){
  if(!isCalculating){
    calculate();
  }
  else{
    calculateQueue = true;
  }
}); 
```

这样你就不会运行并发`calculate()`函数。不需要无休止的计时器，如果有计算“排队”，那么它们将在第一个计算函数停止后计算……而不是每次等待 4 秒。当您更改计算功能并且需要更长的时间时会发生什么？

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T15:46:43.663

您的问题不是要添加到计时器，而是要清除以前的计时器。

你可以这样做：

```
var delay = (function() {
    var time_id;
    return function(callback, ms) {
      if (time_id) {
         window.clearTimeout(time_id);
      }
      time_id = window.setTimeout(callback, ms);
  };
}());

// use it like
delay(function(){...}, 4000); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-20T15:40:56.317

您可以记住 timeoutID 并在每次启动新计时器时重置旧计时器。

```
var timeoutID = null;
if ( timeoutID !== null ) {
  window.clearTimeout( timeoutID );
}
timeoutID  = window.setTimeout( function(){
  // your code here
}, 4000 ); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-20T18:04:06.733

正如其他人所提到的，`clearTimeout`是处理这个问题的方法。我整理了一个非常基本的例子来说明它是如何工作的。单击按钮将在函数运行之前取消并重新启动计时器，但此事件可以很容易地绑定到另一个事件（例如字段上的焦点或模糊，就像您正在做的那样）

[此处使用 clearTimeout 延迟执行的示例 >>](http://jsfiddle.net/eW7m7/1/)

# c - GMT 与 ctime 函数的混淆

> ID：11123083
> 
> 赞同：1
> 
> 时间：2012-06-20T15:37:03.427
> 
> 标签：c, gmt

> **可能重复：**
> [将 struct tm（以 UTC 表示）转换为 time_t 类型的简单方法](https://stackoverflow.com/questions/283166/easy-way-to-convert-a-struct-tm-expressed-in-utc-to-time-t-type)

我正在尝试将文件路径转换为 ​​UNIX 时间。文件路径的格式为：“~/foo/bar/YYYYMMDD/HHMMSS.egg”

路径中包含的时间信息已经是 UTC 时间。但是，我找不到将 UTC 时间转换为 UNIX 时间的方法，只能将本地时间转换为 UNIX 时间。

我的相关代码如下：

```
struct tm * timeinfo;
time_t timeint;

time(&timeint);
timeinfo = gmtime(&timeint);

timeinfo->tm_year = year-1900;
timeinfo->tm_mon = month - 1;
...

timeint = mktime(timeinfo); 
```

当我试图通过在[http://www.csgnetwork.com/unixds2timecalc.html](http://www.csgnetwork.com/unixds2timecalc.html)上检查结果来验证这一点时，我发现它已经关闭了 4 小时，这表明它实际上是在输入时间，就好像它是 EDT 中的时间一样，不是实际的UTC。我需要做什么？

# three.js - 如何在 Three.js 中找到粒子的大小？

> ID：11123084
> 
> 赞同：2
> 
> 时间：2012-06-20T15:37:07.470
> 
> 标签：three.js

如何在 Three.js 中找到粒子的大小？

使用几何图形，您可以使用边界框/球体以三个.js 为单位计算其大小。但是一个粒子没有边界框，我无论如何也看不到计算它的大小。

有没有人有什么建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T23:11:47.063

这取决于您正在处理的“粒子”的含义。使用 a您将指`WebGLRenderer`的是 a 中的顶点`ParticleSystem`，但使用 a`CanvasRenderer`您的意思是`Particle`（仅适用于 Canvas）。就粒子系统而言，用于构造它的材料具有大小，就像在通常的示例中一样：geometry = new THREE.Geometry();

```
for ( i = 0; i < 10000; i ++ ) {
  var vertex = new THREE.Vector3(); // and set its location
  geometry.vertices.push( vertex );
}

material = new THREE.ParticleBasicMaterial( { 
  size: 35,  // This might be the size you are thinking of?
  sizeAttenuation: false, 
  map: // Some THREE.Texture
});

particles = new THREE.ParticleSystem( geometry, material ); 
```

然后你可以访问大小，并简单地修改它

```
particles.material.size = newSize; 
```

如果您正在为画布创建一个`Particle`，那么它非常相似：

```
// Construct the particle with a material
var material = new THREE.ParticleBasicMaterial( { 
  map: new THREE.Texture(  canvas ), 
  blending: THREE.AdditiveBlending 
}); 
particle = new THREE.Particle( textMaterial );
// Just need to access the material to get the 'size'
var size = particle.material.size 
```

# python - 从文本文件中解析/提取数据。无法使其工作

> ID：11123087
> 
> 赞同：1
> 
> 时间：2012-06-20T15:37:14.003
> 
> 标签：python, parsing

我有一个文件，我试图从中提取信息，该文件中包含信息，并且是逐行格式，信息用逗号分隔。

我想把它放在一个列表中，或者尽我所能从特定索引中提取信息。该文件很大，有超过 1000000000 行，我必须在每一行中提取相同的索引才能获得相同的信息。这些是我想要从文件中获取的哈希值，所以我想知道如何根据长度找到所有出现的哈希值。

```
import os

os.chdir('C:\HashFiles')

f = open('Part1.txt','r')

file_contents=f.readlines()

def linesA():

for line in file_contents:
    lista = line.split(',')

print linesA() 
```

这就是我到目前为止所拥有的一切，这只是将所有内容放在一个我可以索引的列表中，但我想将这些索引中的数据输出到另一个文件，但由于 for 语句我无法做到，我该如何解决这？

哇你们太棒了，现在我有一个问题，因为在存储此信息的文件中，它以提供信息的赞助商的信息开头，我如何绕过这些行从另一行开始，因为我需要的行从文件中大约有 100 行，以帮助我，因为目前我遇到索引错误并且无法弄清楚如何设置条件来应对它。我尝试了这种情况但没有用：如果 line[:] != 15: continue

可使用的最新代码：

导入 csv

```
with open('c:/HashFiles/search_engine_primary.sql') as inf, open('c:/HashFiles/hashes.txt','w') as outf:
for i in xrange(47):
    inf.next()       # skip a line

for line in inf:
    data = line.split(',')
    if str(line[0]) == 'GO':
        continue
    hash = data[15]
    outf.write(hash + '\n') 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T15:40:39.380

您可以尝试逐行处理文件

```
 with open('Part1.txt') as inf:
      for line in inf:
          # do your processing
          # ... line.split(',') etc... 
```

而不是使用`readlines()`which*一次将所有数据读入内存*。

此外，根据您在做什么， [列表理解](http://docs.python.org/tutorial/datastructures.html#list-comprehensions)可能有助于从您正在阅读的文件中创建所需的输出列表。

注意：使用`with`打开文件的好处是当你完成或遇到异常时它会*自动为你关闭它。*

**更新**：

要跳过输入文件的第一`N`行，您可以将代码更改为：

```
N = 100

with open('Part1.txt') as inf:
     for i, line in enumerate(inf, 1):
         if i < N:   # if line is less than N
            continue # skip the processing
         print line  # process the line 
```

我正在使用[enumerate()](http://docs.python.org/library/functions.html#enumerate)自动生成行号。我从 1 开始这个计数器（如果未指定，则默认为 0）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T15:41:41.377

您可以逐行处理文件，如下所示：

```
with open('c:/HashFiles/Part1.txt') as inf, open('c:/HashFiles/hashes.txt','w') as outf:
    for line in inf:
        data = line.split(',')
        hash = data[4]
        outf.write(hash + '\n') 
```

如果您想按长度分隔散列，可能类似于：

```
class HashStorage(object):
    def __init__(self, fname_fmt):
        self.fname_fmt = fname_fmt
        self.hashfile = {}

    def thefile(self, hash):
        hashlen = len(hash)
        try:
            return self.hashfile[hashlen]
        except KeyError:
            newfile = open(self.fname_fmt.format(hashlen), 'w')
            self.hashfile[hashlen] = newfile
            return newfile

    def write(self, hash):
        self.thefile(hash).write(hash + '\n')

    def __del__(self):
        for f in self.hashfiles.itervalues():
            f.close()
        del self.hashfiles

store = HashStorage('c:/HashFiles/hashes{}.txt')

with open('c:/HashFiles/Part1.txt') as inf:
    for line in inf:
        data = line.split(',')
        hash = data[4]
        store.write(hash) 
```

**编辑:** : 有没有办法识别赞助商行 - 例如，它们以“#”开头？你可以过滤像

```
with open('c:/HashFiles/Part1.txt') as inf, open('c:/HashFiles/hashes.txt','w') as outf:
    for line in inf:
        if not line.startswith('#'):
            data = line.split(',')
            hash = data[4]
            outf.write(hash + '\n') 
```

否则，如果您必须跳过 N 行 - 这很糟糕，因为如果数字发生变化怎么办？- 你可以改为

```
with open('c:/HashFiles/Part1.txt') as inf, open('c:/HashFiles/hashes.txt','w') as outf:
    for i in xrange(N):
        inf.next()       # skip a line

    for line in inf:
        data = line.split(',')
        hash = data[4]
        outf.write(hash + '\n') 
```

**编辑2：**

```
with open('c:/HashFiles/search_engine_primary.sql') as inf, open('c:/HashFiles/hashes.txt','w') as outf:
    for i in xrange(47):
        inf.next()       # skip a line

    for line in inf:
        data = line.split(',')
        if len(data) > 15:      # skip any line without enough data items
            hash = data[15]
            outf.write(hash + '\n') 
```

这仍然给你错误吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T15:52:27.687

```
import csv

with open(os.path.join('C:\HashFiles','Part1.txt'), 'rb') as f:
    reader = csv.reader(f)
    for row in reader:
        print row 
```

# linker - 无法打开文件 atls.lib

> ID：11123088
> 
> 赞同：10
> 
> 时间：2012-06-20T15:37:15.230
> 
> 标签：linker, atl, visual-c++-2008-express

我的硬盘中有 atls.lib，但我无法将它链接到我的 Visual Studio 项目中。我知道 atls.lib 是 ATL 特定的库文件，并且我拥有所有 ATL 文件/头文件/库。但是，我仍然无法链接它们。

链接：致命错误 LNK1104：无法打开文件“atls.lib”

谁能帮助一个无助的程序员？

非常感谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2016-02-18T08:44:52.293

在我的情况下，问题是缺少 x64 的 ATL/MFC 库，我必须在 Visual Studio 安装程序中添加它们（这是一个开源项目，所以我不知道这个要求）。

再一次，无价的[procmon](https://technet.microsoft.com/en-us/sysinternals/processmonitor)完成了这项工作：
虽然在链接器下找到了*atls.lib*`$(VCInstallDir)atlmfc\lib` ，但在`$(VCInstallDir)atlmfc\lib\amd64`.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2019-03-13T15:00:29.607

为了更新这个问题，我在运行安装 Spectre（VC++ 规范代码缓解工具）后遇到了这个错误。查看 VC++ 目录后，我注意到 Include Directories 和 Library Directories 都已更改为在路径中添加了“Spectre”，而实际文件的原始路径不再存在。在确定 Spectre 是否未正确安装，或者只是更改路径即可解决问题后，我将在稍后更新此内容；我不希望在我的代码中暴露投机攻击，这显然发生在 ATL 代码中。

**编辑**

我的编译器是 VS 2017 社区版。

**编辑**

对我有用的解决方案在[这里](https://developercommunity.visualstudio.com/content/problem/253047/spectre-lib-folder-missing.html)，由 Holger Schmeken 发现

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-06-20T23:57:18.893

好像还没有添加库目录。在项目属性、链接器、常规选项中，将`atls.lib`驻留的目录添加到该`Additional Library Directories`字段。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2020-09-09T16:09:18.583

通过 Visual Studio 安装程序安装以下单个组件，为我使用 VS2019 运行 32 位驱动程序修复：

*   用于具有 Spectre 缓解（x86 和 x64）的最新 v142 构建工具的 C++ ATL

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-11-27T21:05:12.867

我添加`<Visual Studio folder\VC\Tools\MSVC\14.15.26726\atlmfc\lib\x64\atls.lib>`到`Linker>Input> Additional Dependencies` 解决方案属性中，它得到了解决。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-09-26T01:46:23.403

我只需将此文件复制到我的项目文件夹即可解决此问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-04-28T19:08:35.773

在我获得最近的 VS2019 更新后，这个问题开始发生在我身上。我注意到这是因为 Spectre Mitigation 已自动启用，但我没有库的 Spectre Mitigation 版本。

安装 Spectre 缓解版本或禁用 Spectre 缓解都是可能的修复。

# java - 多个线程与多个传感器通信

> ID：11123093
> 
> 赞同：0
> 
> 时间：2012-06-20T15:37:34.377
> 
> 标签：java, multithreading

我是线程新手。我想在每分钟 24/7 连续不断地与多个传感器进行通信。

**Senario：** 我有一种与传感器对话的方法，它需要 3 个参数

```
public String perform(String command, String ip, String port)
{
  //talk to the sensor and then 
  returns reply;
} 
```

我有一个包含传感器详细信息的数据库。

**我现在在做什么**

```
while(true)
{
  //get sensors from database

   //run perform method for all instruments
   for(int i=0;i<sensors.length-1;i++)
   {
    //call perform method and save the reply
   }
   Thread.sleep('one minute');
} 
```

**问题：** 问题是如果我有 100 个传感器并且每个传感器需要 1 秒来回复，然后我将等待 1 分钟，在这种情况下我可能会丢失一些信息。老实说，有时需要一秒钟以上的时间才能做出回应。

**我想要做的是**，从数据库中获取所有传感器的信息，然后为每个传感器创建一个线程。然后一次运行所有线程，这将返回一些信息。之后等待一分钟，然后再做一次。

任何帮助表示赞赏。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T15:42:08.853

你看过[ScheduledThreadPoolExecutor](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/ScheduledThreadPoolExecutor.html)吗？

一个简单的用法是为每个传感器创建一个[Callable](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/Callable.html)，并将线程池配置为包含与传感器一样多的线程。然后提交每个 Callable，指定适当的时间表。

请注意，这种方法不能保证特别准确的计时（Java 绝不是实时平台）。另一个问题是创建大量线程可能会相对占用大量内存（IIRC 每个线程的标准堆分配为 512k，但它是可配置的），如果您有 1000 个传感器，这种方法将无法扩展。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T16:04:14.410

我个人会采取不同的方法。我会让服务器始终通过 RESTful API 进行侦听，然后让传感器每分钟（或您决定的其他时间间隔）发布它们的状态。这样，服务器和传感器不需要在同一个 JVM 中，恕我直言，更具可扩展性。此外，这样任何传感器也可以通过服务器上的另一个 RESTful API 查询任何其他传感器的状态。

此外，服务器可以启动一个线程来处理每个 POST，如果一个传感器花费很长时间，其他传感器不会被阻塞。

# emacs - elisp中如何管理底层接口的变化

> ID：11123114
> 
> 赞同：3
> 
> 时间：2012-06-20T15:38:47.313
> 
> 标签：emacs, elisp

在 emacs 23.1 和 24.1 之间的某个地方，接口发生了`url-retrieve`变化。在 emacs 23.1 中，它看起来像这样：

```
(url-retrieve URL CALLBACK &optional CBARGS) 
```

在 24.1 版本中，它看起来像这样：

```
(url-retrieve URL CALLBACK &optional CBARGS SILENT INHIBIT-COOKIES) 
```

我有一个使用此功能的 emacs 包。我想利用 emacs 24.1 上新的*SILENT*参数，同时保持与不支持它的旧版 emacs 的向后兼容性。

管理此问题的最佳方法是什么？我可以在运行时获取最大数量的参数吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T16:58:35.653

您可以使用此函数来获取参数列表：

```
(defun my-get-arglist (obj)
  ;; code taken from disassemble-internal
  (let ((macro 'nil)
        (name 'nil)
        (doc 'nil)
        args)
    (while (symbolp obj)
      (setq name obj
            obj (symbol-function obj)))
    (if (subrp obj)
        (error "Can't disassemble #<subr %s>" name))
    (if (and (listp obj) (eq (car obj) 'autoload))
        (progn
          (load (nth 1 obj))
          (setq obj (symbol-function name))))
    (if (eq (car-safe obj) 'macro)  ;handle macros
        (setq macro t
              obj (cdr obj)))
    (if (and (listp obj) (eq (car obj) 'byte-code))
        (setq obj (list 'lambda nil obj)))
    (if (and (listp obj) (not (eq (car obj) 'lambda)))
        (error "not a function"))
    (if (consp obj)
        (if (assq 'byte-code obj)
            nil
          (setq obj (byte-compile obj))))
    (cond ((consp obj)
           (setq obj (cdr obj))     ;throw lambda away
           (setq args (car obj))    ;save arg list
           (setq obj (cdr obj)))
          ((byte-code-function-p obj)
           (setq args (aref obj 0)))
          (t (error "Compilation failed")))
    args)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-20T21:51:27.923

您可以检查`emacs-major-version`并确保它 >= 24。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-21T00:21:43.137

```
(defun try-call-with-more-args (function a b c d)
  (condition-case var
      (progn
        (funcall function a b c d)
        (message "there was no error"))
    (wrong-number-of-arguments (funcall function a b c))))

(try-call-with-more-args #'message "b = %d, c = %d" 1 2 3) 
```

尽管 Trey Jackson 发布的那个更聪明，但它更简单，而且实际上有很好的工作机会，即使你的目标是原生 C 函数:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-22T01:20:09.950

如果它是较旧的 emacs 版本，请围绕较旧的函数编写一个包装器：

```
(let ((orig-fun #'symbol-name-of-orig-fun))
  (defun symbol-name-of-orig-fun (arglist of new function interface)
    (declare (ignore new function interface))
    (funcall orig-fun arglist of))) 
```

这会生成一个词法闭包，它将旧函数的引用存储在新函数中。我不知道 emacs 方言，但我敢打赌这种模式可以在 emacs 中使用。我每隔一段时间就会在普通的 lisp 中使用它。

# command-line - 从命令行/类路径设置执行 Schemagen (Jena)

> ID：11123116
> 
> 赞同：0
> 
> 时间：2012-06-20T15:38:53.820
> 
> 标签：command-line, classpath, rdf, jena, schemagen

我正在学习 Jena API，我想使用 Schemagen 为我自己的词汇创建类似于 com.hp.hpl.jena.vocabulary 包中的类；

[我在http://www.apache.org/dist/incubator/jena/apache-jena-2.7.0-incubating/](http://www.apache.org/dist/incubator/jena/apache-jena-2.7.0-incubating/)下载了 Jena 。下载后，我将其解压缩并保持原样。

C:\Users\moi\NetBeansProjects\apache-jena-2.7.0-incubating\apache-jena-2.7.0-incubating 是包含 bat 文件夹、bin 文件夹、javadoc-arq 文件夹等的文件夹。

我在我的一个项目中使用 C:\Users\moi\NetBeansProjects\apache-jena-2.7.0-incubating\apache-jena-2.7.0-incubating\lib 中的所有库和一个相对链接测试了 Jena，它作品。

为了便于在命令行中使用，我将文件“MyKnowledgeBase.rdf”移到了 lib 文件夹中。

我从 lib 文件夹中尝试过

```
java jena.schemagen -i "myKnowledgeBase.rdf" 
```

得到这个

```
Exception in thread "main" java.lang.NoClassDefFoundError: jena/schemagen
Caused by: java.lang.ClassNotFoundException: jena.schemagen
    at java.net.URLClassLoader$1.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
Could not find the main class: jena.schemagen.  Program will exit. 
```

所以我尝试设置类路径：

```
C:\Users\moi\NetBeansProjects\apache-jena-2.7.0-incubating\apache-jena-2.7.0-incubating\lib>
set CLASSPATH=commons-codec-1.5.jar;httpclient-4.1.2.jar;httpcore-4.1.3.jar;icu4j3.4.4.jar;jena.arq-2.9.0-incubating.jar;jena.core-2.7.0-incubating.jar;jena.iri0.9.0-incubating.jar;log4j-1.2.16.jar;slf4j-api-1.6.4.jar;slf4j-log4j12-1.6.4.jar;xercesImpl-2.10.0.jar; xml-apis-1.4.01.jar; 
```

但我仍然有同样的错误。我也试过

```
java -cp commons-codec-1.5.jar;httpclient-4.1.2.jar;httpcore-4.1.3.jar;icu4j3.4.4.jar;jena.arq-2.9.0-incubating.jar;jena.core-2.7.0-incubating.jar;jena.iri0.9.0-incubating.jar;log4j-1.2.16.jar;slf4j-api-1.6.4.jar;slf4j-log4j12-1.6.4.jar;xercesImpl-2.10.0.jar; xml-apis-1.4.01.jar; jena.schemagen -i myKnowledgeBase.rdf 
```

当我做

```
echo %CLASSPATH% 
```

我得到了我输入的内容

我尝试将 set CLASSPATH 与每个 jar 的绝对路径一起使用，但它也不起作用。

所以现在我不知道该怎么办。

在 Jena，我在 jena-core-2.7.0-incubating.jar 包“jena”中找到了 schemagen.class（使用 netbeans）

使用资源管理器我没有找到类文件。

我已经在命令行中运行了几个项目，执行 java -jar 所以 java 和命令行都可以

谢谢您的帮助

编辑：我删除了参数 -classpath 和 %CLASSPATH% 之间的空格，我得到了不同的东西 \o/ 仍然不起作用，但它正在进行中！

“无法识别的选项”和“无法创建 java 虚拟机”

Edit2：由于我无法解决这个问题，我用 netbeans 创建了一个新项目。我创建了 schemagen 类的副本，将其作为主类，将所有 jar 作为库包含在内。接着 ：

```
java -jar "C:\Users\moi\NetBeansProjects\MyJena\dist\MyJena.jar" -i "myKnowledgeBase.rdf" -o "C:\Users\moi\NetBeansProjects\apache-jena-2.7.0-incubating\apache-jena-2.7.0-incubating\lib" --ontology 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T09:15:00.477

在包括 Jena 2.7.0 在内的所有最新版本中，为所有 Jena 命令行工具提供了 Linux shell 和 Windows 批处理脚本。这些脚本适当地设置了 CLASSPATH。由于您似乎使用的是 Windows，因此您应该使用`bat\schemagen.bat`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-03-23T22:07:38.917

我有同样的问题。如果有人遇到同样的问题，我正在使用 Jena 3.10，解决方案是使用位于 bat 文件夹中的 schemagen bat 文件。我使用这个命令行来生成词汇表

C:\Jena\apache-jena-3.10.0\bat\schemagen.bat -i "文件名"

# multithreading - 调用 detachNewThreadSelector:target:object: vs dispatch_async()

> ID：11123117
> 
> 赞同：1
> 
> 时间：2012-06-20T15:38:54.797
> 
> 标签：multithreading, grand-central-dispatch, nsthread, nsoperation

Concurrency Programming Guide（PDF 版）的第 37 页和第 39 页似乎是矛盾的。在第 37 页中，代码片段指定了以下内容：

```
if (![anOp isConcurrent])
    [anOp start];
else
    [NSThread detachNewThreadSelector:@selector(start) toTarget:anOp withObject:nil]; 
```

这看起来不错，除了第 39 页的文档指出：

> 您可以使用调度队列来执行您过去在单独线程上执行的几乎所有任务。调度队列的优点是它们比相应的线程代码更易于使用并且在执行这些任务时效率更高。

那么为什么不调用 detachNewThreadSelector:target:object:，为什么代码不调用 dispatch_async() 呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T08:14:32.500

是的，我明白你在说什么。我认为每种方式都有效，但根据具体情况，您应该选择要使用的根目录。需要注意的是`NSOperationQueues`很好用；在 mac osx 中，它们用于`GCD`优化，因此它们是一个不错的选择。在 iOS 4 及更低版本中，它们不会。因此，`GCD`如果在以前版本的 iOS 上工作，使用是您应该认真考虑的事情。如果您调度一个新`NSThread`的操作系统必须不断切换线程，这可能是一个性能问题。`GCD`使用池方法，这意味着如果这样做很好，它将重新使用现有线程。

希望这会为您指明正确的方向

# c# - Excel 应用程序未在互操作中退出

> ID：11123118
> 
> 赞同：0
> 
> 时间：2012-06-20T15:38:56.020
> 
> 标签：c#, asp.net, excel, impersonation, excel-interop

我正在使用以下代码在可以将数据表保存到 excel 的 ASP.net 表单上动态写入 excel 文件。

```
//Create Excel Object
Microsoft.Office.Interop.Excel.Application excel = new Microsoft.Office.Interop.Excel.Application();
Microsoft.Office.Interop.Excel.Workbook workbook = excel.Workbooks.Open(target);
Microsoft.Office.Interop.Excel.Worksheet worksheet = (Microsoft.Office.Interop.Excel.Worksheet)workbook.Worksheets[1];

worksheet.Name = "Worksheet1";
excel.Visible = false;
//Generate Fields Name
foreach (DataColumn col in dataTable.Columns)
{
    colIndex++;
    excel.Cells[1, colIndex] = col.ColumnName;
}
object[,] objData = new object[rowNo, columnNo];
for (int row = 0; row < rowNo; row++)
{
    for (int col = 0; col < columnNo; col++)
    {
        objData[row, col] = dataTable.Rows[row][col];
    }
}
Microsoft.Office.Interop.Excel.Range range;
range = worksheet.Range[excel.Cells[2, 1], excel.Cells[rowNo + 1, columnNo]];
range.Value2 = objData;
worksheet.Columns.AutoFit();

workbook.Save();
workbook.Close();

IntPtr hwnd = new IntPtr(excel.Hwnd);
IntPtr processId;
IntPtr foo = GetWindowThreadProcessId(hwnd, out processId);
Process proc = Process.GetProcessById(processId.ToInt32());
proc.Kill();

//excel.Quit();
GC.Collect();
GC.WaitForPendingFinalizers(); 
```

数据被很好地写入excel文件。但是，当我尝试像上面那样使用 proc.Kill() 终止进程时，出现以下异常

说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

异常详细信息：System.ComponentModel.Win32Exception：访问被拒绝

源错误：

在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。

堆栈跟踪：

```
[Win32Exception (0x80004005): Access is denied]
   System.Diagnostics.Process.GetProcessHandle(Int32 access, Boolean throwIfExited) +1985316
   System.Diagnostics.Process.Kill() +49
   Faculty_Report1.FetchData_EXCEL(String prog, String cls, String spcln, String fromdate, String todate) +2413
   Faculty_Report1.fetchselectedvalues_EXCEL() +1044
   System.Web.UI.WebControls.ImageButton.OnClick(ImageClickEventArgs e) +187
   System.Web.UI.WebControls.ImageButton.RaisePostBackEvent(String eventArgument) +165
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +3707 
```

我没有使用 proc.Kill() 方法，而是尝试使用 excel.Quit() 方法，但该过程不会终止。当我这样做时，每次用户尝试生成报告时，我都会得到一个新的 Excel 流程。

我在 web.config 文件中有用户模拟，但这并没有改变任何东西。

```
 <system.web>
    <identity impersonate="true" userName="xxxxxx" password="xxxxxxxx" />
  </system.web> 
```

关于如何避免异常并确保 excel 进程正常终止的任何指示？我已经尝试过在这里找到的 COM 清理解决方案，但它不起作用..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T15:46:23.037

MS 不支持在服务器上使用互操作（如 ASP.NET） - 请参阅[http://support.microsoft.com/default.aspx?scid=kb;EN-US;q257757#kb2](http://support.microsoft.com/default.aspx?scid=kb;EN-US;q257757#kb2)

由于 Windows Vista MS 引入了一些与安全相关的措施，这些措施会阻止 Windows 服务执行“类似桌面”的操作......这意味着您必须绕过一些安全措施才能使其正常工作（不推荐！）。

要在服务器方案中处理 Excel，有几个选项（免费和商业）：

我可以推荐[Aspose.Cells](http://www.aspose.com/categories/.net-components/aspose.cells-for-.net/default.aspx)和[Flexcel](http://www.tmssoftware.com/site/flexcelnet.asp) ......没有尝试[SpreadsheetGear](http://www.spreadsheetgear.com/)但听到+阅读了很多关于它的好东西......

免费选项（尽管仅适用于较新的 xlsx 格式！）例如 [来自 MS](http://www.microsoft.com/download/en/details.aspx?id=5124)和[EPPlus](http://epplus.codeplex.com/)的 OpenXML 2 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T15:55:16.463

要创建简单的 excel 数据表，除了 interop 之外，还有几个可能很有趣的选项，但是当必须使用 interop 时，有一些方法可以帮助处理 excel。

第一件事是第一件事。如果您确定可以重用现有应用程序，则可以使用 'oldschool' getactiveobject 获取现有实例：

```
 using System.Runtime.InteropServices;

    Microsoft.Office.Interop.Excel.Application excel;
            try
            {
                excel = (Microsoft.Office.Interop.Excel)Marshal.GetActiveObject("Excel.Application");
            }
            catch
            {
                 excel = new Microsoft.Office.Interop.Excel.Application();
            } 
```

要使 excel 应用程序成功退出，必须销毁所有句柄，但我想这就是 COM 清理的意思？确保使用 marshal.releasecomobject 释放所有句柄可能会很痛苦（也许在现代互操作中不再需要了？），这就是为什么我将每个办公室互操作“句柄”（例如工作表、工作簿、范围等）包装在一个包装。我拥有的代码并没有太多用处，但无论如何我都会在这里发布它以给出一个总体思路：

```
public class WrapperBase<T>: IWrapper
{

    protected T obj;
    protected internal WrapperBase(IWrapper Owner)
    {
        SetOwner(Owner);
    }

    protected WrapperBase() { }

    CultureSwitcher cultswitch;
    public CultureSwitcher CultureSwitcher
    {
        get
        {
            if (cultswitch == null)
            {
                if (owner != null) return owner.CultureSwitcher;
                cultswitch = new CultureSwitcher();
            }
            return cultswitch;
        }
    }

    public T Object { get { return obj; } internal set { obj = value; } }

    //public abstract void Save();

    public bool IsDisposed { get { return disposed; } }

    bool disposed;
    public void Dispose()
    {
        Dispose(false);
    }

    void Dispose(bool fromfinalize)
    {
        if (disposed) return;
        disposed = true;
        if (!fromfinalize)
            GC.SuppressFinalize(this);

        CultureSwitcher.Try(OnDisposing);

        if (obj != null)
        {
            while (Marshal.ReleaseComObject(obj) > 0) { }
            obj = default(T);
        }

        if (cultswitch != null)
        {
            cultswitch.Dispose();
            cultswitch = null;
        }

        SetOwner(null);
    }

    protected virtual void OnDisposing()
    {
        if (children != null)
        {
            foreach (var c in children)
                c.Dispose();
            children = null;
        }
    }

    ~WrapperBase()
    {
        Dispose(true);
    }

    List<IWrapper> children;
    IWrapper owner;

    public IWrapper Owner
    {
        get { return owner; }
    }

    protected void SetOwner(IWrapper Owner)
    {
        if (Owner == owner) return;
        if (owner != null)
        {
            owner.DeRegister(this);
        }
        owner = Owner;
        if (owner != null)
        {
            owner.Register(this);
        }
    }

    public void Register(IWrapper Child)
    {
        if (disposed)
            throw new ObjectDisposedException("Cannot register children after disposing");
        if (children == null)
            children = new List<IWrapper>();
        children.Add(Child);
    }

    public void DeRegister(IWrapper Child)
    {
        if (disposed) return;
        children.Remove(Child);
    }

    protected IEnumerable<IWrapper> GetChildren()
    {
        return children;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T15:50:06.007

过去我也遇到过使用 Interop 让 Excel 应用程序真正关闭的问题，但找到了释放应用程序实例的解决方案。尝试以下操作：

```
excel.Quit();
excel = null; 
```

这听起来太简单了，但它成功地防止了 Excel 的幽灵实例在我的应用程序的操作系统中徘徊。

# database - BDE 安装：驱动器 c 上没有足够的空间。无论如何都要安装到这个位置

> ID：11123121
> 
> 赞同：1
> 
> 时间：2012-06-20T15:39:01.057
> 
> 标签：database, delphi, installation, delphi-xe, bde

我正在尝试通过从我的安装程序执行以下命令行来安装 BDE 引擎，如下所示。

```
ShellExecute(0, nil, 'regsvr32.exe', 'BdeInst.dll', nil, SW_SHOW); 
```

它会弹出一条消息，请求允许在特定位置安装 BDE 引擎。当您单击确定按钮时，它会弹出另一条消息，如下所示。

![在此处输入图像描述](../Images/66c1e2f261aea3f8fa709c7fcb235529.png)

我确实验证了我的硬盘中有足够的可用空间。当您单击 Yes 按钮时，它会成功安装 BDE 引擎。

我不知道为什么。另外，网上没有太多关于这方面的信息。

任何输入将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T14:54:42.160

BDE 是一款旧软件，现已弃用数年。虽然人们仍然在运行它，但我相信它最初是 16 位软件，可能永远不会改变。我有一种感觉，该消息来自某些无法理解您的大硬盘驱动器的软件。我不记得 BDEInst.dll 是否是 Borland 的 BDE 安装程序，但该消息可能来自该安装程序。您还提到“正在开发安装程序......”。

它应该安装到 XP，我会先让它在那里工作。Win 7 和 8 引入了更多问题。但是，如果可能，请重新考虑是否要在此时安装 BDE。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-24T15:41:52.243

首先，BDE 已被弃用，您最好避免使用它，即使与其他版本的 Delphi 一起使用。

您周围的第三方组件能够在不使用 BDE 的情况下直接连接到 DB。参见[DevArt](http://www.devart.com/)、[SQLDirect](http://www.sqldirect-soft.com/)、[DASoft](http://www.da-soft.com/)（它的 FreeDAC 是免费的），以及许多其他组件，如[Zeos](http://sourceforge.net/projects/zeoslib/)或[我们的 SynDB 开源库](http://blog.synopse.info/tag/SynDB)。

您达到了众所周知的“2GB 舍入误差”。BDE 安装程序会受到影响，但使用 BDE 的应用程序也会受到影响。

**BDE 安装程序有问题。**

它只是不适用于较新版本的 Windows。

您周围还有其他安装程序，例如[Windows 7 上的 interbase 和 BDE](https://stackoverflow.com/questions/4670104/interbase-and-bde-on-windows-7)或[Embarcadero 时代的 Bde Installer](https://stackoverflow.com/questions/1679806/bde-installer-on-these-embarcadero-days)

**应用程序中使用的 BDE 也会受到[同样的 2GB 限制，这与`GetDiskFreeSpace`使用不当](http://qc.embarcadero.com/wc/qcmain.aspx?d=7089)有关。**

Embarcadero CodeCentral 上有[一个解决方法](http://cc.embarcadero.com/item/21475)，值得将其包含在您的应用程序代码中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-24T11:23:46.600

bdeinst.dll 使用 Win32 API 函数`GetDiskFreeSpace`，当针对大于 2GB 的驱动器执行时，该函数可能会报告完全误导的值 - 有关基于开发人员的解决方法，请参阅[http://support.microsoft.com/kb/202455](http://support.microsoft.com/kb/202455)。

我知道这一点的原因是因为我之前被它击中并检查了 bdeinst.dll 二进制文件的导入，该二进制文件表明它使用`GetDiskFreeSpaceA`（这是函数的 ascii 版本）。

如果您*必须*使用 BDE，那么您只需要接受在尝试安装应用程序时可能会看到此错误

# matlab - MATLAB 无法调整我的图形大小？

> ID：11123137
> 
> 赞同：0
> 
> 时间：2012-06-20T15:39:59.540
> 
> 标签：matlab, resize, position, matlab-figure

这是我遇到的一个非常奇怪的问题。我的 MATLAB 脚本中有一个主窗口。这是管理它的代码：

```
mainfigure = figure (100);
set(0,'Units','pixels')
set (mainfigure, 'Position', [384   433   943   582],...
    'Color', [0.8 0.8 0.8],...
    'NumberTitle', 'off',...
    'MenuBar', 'none',...
    %'CloseRequestFcn',{@closeGUI},... % commented out because it makes it impossible to close this figure when closeGUI isn't defined
    'Name', 'ASProject'); 
```

该图内部有许多 uicontrols 和一个子图（我没有发布代码，因为它很长，但如果您需要它来诊断，我会提供它）。代码中没有其他数字，所以不应该有任何干扰。

无论如何，我正在尝试调整我的身材。但是，无论我在 set 的“位置”部分插入什么值，窗口大小都保持不变！所发生的只是屏幕上的位置发生变化。事实上，我只是修改了高度和宽度参数，它仍然改变了屏幕上的位置，而不是图形大小。所以

```
[384 433 943 582]
[384 433 200 200]
[384 433 5   5  ] 
```

大小都相同，只是在屏幕上的不同位置！

这对我来说没有任何意义。为什么我的身材尺寸会这样锁定？这很令人沮丧，因为我只需要将尺寸减小很小的量（宽度减少 50-70 像素），我做不到！

# jquery - Safari 浏览器中的 Mouseenter 和 mouseleave 事件

> ID：11123139
> 
> 赞同：1
> 
> 时间：2012-06-20T15:40:04.403
> 
> 标签：jquery, safari

我正在尝试使用 jQuery 在菜单页面中连接一些简单的鼠标事件。它在 Chrome 和 IE9 中运行良好，但在 Safari 中，当我移动鼠标时，突出显示会卡在某些元素上。这是显示页面的 3 个浏览器。您将不得不想象这一点，因为我不允许发布屏幕截图的链接。对不起。

这是连接事件的代码：

```
$(document).ready(function() {

    $("#number").focus();

    // We use td elements instead of anchors as the menu items. The ones we want to work with all have 
    // a custom attribute called url that stores the url template...
    var linkCells = $("td[url]");

    // Wire up the click handler for each link cell...
    linkCells.click(function () {
        Navigate($(this).attr('url'));
    });

    // Wire up mouse events for the link cells. We want to highlight the current cell and update
    // the number label...
    linkCells.bind('mouseenter mouseleave', function(e) {
        var linkCell = $(this);
        linkCell.toggleClass('linkOn');
        if(e.type == 'mouseenter') {
            $("#numberLabel").html('<b>' + linkCell.attr('numberLabel') + '</b>');
        }
    });

    // Wire up the submit event in case the user presses the Enter key instead of clicking a link...
    $("#Form1").submit(function() {
        Navigate($("#lastLink").val());
        return false;
    });
}); 
```

是否有任何特殊技巧可以使 Safari 的行为与其他浏览器相同？

谢谢，

马修麦克法兰

# ruby - 使用 rvm OS X Lion 将 Ruby 1.9.2 升级到 1.9.3 时出错

> ID：11123145
> 
> 赞同：0
> 
> 时间：2012-06-20T15:40:20.260
> 
> 标签：ruby, rvm

您好我正在尝试使用 RVM 将我的 ruby​​ 1.9.2 升级到 1.9.3。这就是我正在做的事情：

```
rvm upgrade 1.9.2
Are you sure you wish to upgrade from ruby-1.9.2-p290 to     ruby-1.9.3-p0? (Y/n): y 
```

然后我收到以下错误：

```
Installing new ruby ruby-1.9.3-p0
Installing Ruby from source to: /Users/jeanosorio/.rvm/rubies/ruby-1.9.3-p0, this may take a while depending on your cpu(s)...

ruby-1.9.3-p0 - #fetching 
ruby-1.9.3-p0 - #extracted to /Users/jeanosorio/.rvm/src/ruby-1.9.3-p0 (already extracted)
Fetching yaml-0.1.4.tar.gz to /Users/jeanosorio/.rvm/archives
Extracting yaml-0.1.4.tar.gz to /Users/jeanosorio/.rvm/src
Configuring yaml in /Users/jeanosorio/.rvm/src/yaml-0.1.4.
Compiling yaml in /Users/jeanosorio/.rvm/src/yaml-0.1.4.
Installing yaml to /Users/jeanosorio/.rvm/usr
ruby-1.9.3-p0 - #configuring 
ERROR: Error running ' ./configure --prefix=/Users/jeanosorio/.rvm/rubies/ruby-1.9.3-p0 --enable-shared --disable-install-doc --with-libyaml-dir=/Users/jeanosorio/.rvm/usr ', please read /Users/jeanosorio/.rvm/log/ruby-1.9.3-p0/configure.log
ERROR: There has been an error while running configure. Halting the installation.
ERROR: Unable to install ruby ruby-1.9.3-p0\.         Please install it manually to continue. 
```

我正在使用 XCODE 4.2.1，有什么想法吗？？？

这是configure.log

```
[2012-06-20 11:31:41]  ./configure --prefix=/Users/jeanosorio/.rvm/rubies/ruby-1.9.3-p0 --enable-shared --disable-install-doc --with-libyaml-dir=/Users/jeanosorio/.rvm/usr 
configure: WARNING: unrecognized options: --with-libyaml-dir
checking build system type... x86_64-apple-darwin11.4.0
checking host system type... x86_64-apple-darwin11.4.0
checking target system type... x86_64-apple-darwin11.4.0
checking whether the C compiler works... no
configure: error: in `/Users/jeanosorio/.rvm/src/ruby-1.9.3-p0':
configure: error: C compiler cannot create executables
See `config.log' for more details 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T17:24:34.557

1.  更新 RVM`curl -L get.rvm.io | bash -s stable && rvm reload`
2.  安装[osx-gcc-installer](https://github.com/kennethreitz/osx-gcc-installer/downloads)
3.  阅读并遵循说明`rvm requirements`
4.  安装红宝石：rvm install 1.9.3

您还可以使用[http://railsinsaler.org](http://railsinsaler.org)进行新系统安装。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T15:49:18.110

尝试升级到 Xcode 4.3。通过全新安装，我能够让 1.9.3-p125 正常工作。

如果这不起作用，RVM 有一些提示：[https ://rvm.io/os/osx/](https://rvm.io/os/osx/)

# php - 使用厨师食谱将亚马逊 ec2 ubuntu 上的 php 版本从 5.3.2 更新到 5.3.x

> ID：11123146
> 
> 赞同：0
> 
> 时间：2012-06-20T15:40:27.890
> 
> 标签：php, ubuntu, amazon-ec2, version, chef-infra

盒子上当前的 php 版本是

```
PHP 5.3.2-1ubuntu4.17 with Suhosin-Patch (cli) (built: Jun 19 2012 01:35:33) 
```

我通过以下方式更改了 chef/cookbooks/php/attributes 中的 default.rb

```
default['php']['install_method'] = 'source' 
```

从“包”，和

```
default['php']['version'] = '5.3.10' 
```

我也用 5.3.5、.6、.9 试过最后一个。

我能看到的唯一影响是在刀部署日志中：

```
INFO: Processing remote_file[/var/chef/cache/php-5.3.10.tar.bz2] action create (php::source line 43) 
```

所以至少配置被使用了，但无论我改变什么，PHP 都保持在上面提到的版本。

# r - 随机效应的点图

> ID：11123147
> 
> 赞同：4
> 
> 时间：2012-06-20T15:40:29.237
> 
> 标签：r, plot, lme4

我有一个广义的混合效应模型，如下所示：

```
d <- data.frame(
    g = sample(c("A","B","C","D","E"), 250, replace=TRUE),
    x = runif(250, max=100),
    y = sample(c(0,1), 250, replace=TRUE)
)

require(lme4)

fm <- lmer(y ~ x + (1 + x | g), data=d, family=binomial) 
```

我想使用`dotplot`但不绘制 x 的随机斜率分量来绘制截距的随机效应。我的问题是我似乎无法弄清楚如何只访问*截距*组件而不是随机斜率。

例如，我想要的是这个情节的左侧：

```
dotplot(ranef(fm, postVar=TRUE)) 
```

![在此处输入图像描述](../Images/0aa2e90dd646c9d3a6ac86955807e8e3.png)

使用`dotplot(ranef(fm, postVar=TRUE)$g[,2])`并没有给我我想要的东西，即使我认为它应该！我看过`str(fm)`，但没有看到任何帮助我更接近的东西。

任何帮助和提示将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T20:12:51.730

你几乎在你的原始代码中：

```
dotplot(ranef(fm, postVar=TRUE))$g[1] 
```

释放每个图的比例的附加提示：

```
dotplot(ranef(fm, postVar=TRUE),
        scales = list(x =list(relation = 'free'))) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T16:19:38.597

您只需要更加聪明地删除另一列随机效应：

```
re <- ranef(fm,postVar = TRUE)
re$g$x <- NULL
dotplot(re) 
```

您的其他方法不起作用的原因是`dotplot`被调度的方法仍然希望其输入看起来像一个元素列表，就像它来自`ranef`. 因此，您只需要进入并移除那个有问题的列，但保持结构的其余部分不变。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-20T16:20:18.417

你看的不是正确的 str() 。

```
re <- ranef(fm, postVar = TRUE)
str(re) 
```

这向您显示了一个列表，其中第一项是包含您想要的数据框的数据框。我只是从中删除 $x 列。

```
re[[1]]$x <- NULL 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-20T18:58:51.370

这应该让你非常接近。我一直想添加对`lme4`对象的支持，`coefplot`所以这可能是我的催化剂。

```
theRan <- ranef(fm, postVar=TRUE)
pv <- attr(theRan$g, "postVar")
se <- pv[1, 1, ]
theIntercepts <- theRan$g[, 1, drop=F]
theFrame <- cbind(theIntercepts, se)
names(theFrame)[1] <- "Intercept"
theFrame$Low <- with(theFrame, Intercept - 2 * se)
theFrame$High <- with(theFrame, Intercept + 2 * se)
theFrame$Variable <- rownames(theFrame)
ggplot(theFrame, aes(y=Intercept, x=reorder(Variable, Intercept))) + geom_linerange(aes(ymin=Low, ymax=High), colour="black") + geom_point(, colour="blue") + coord_flip() + labs(y="Intercept", x=NULL) 
```

# proxy - WSO2 ESB - 代理参数的动态值（传输）

> ID：11123151
> 
> 赞同：4
> 
> 时间：2012-06-20T15:40:44.160
> 
> 标签：proxy, wso2, mediator, synapse, wso2esb

我需要能够为代理参数指定一个动态值。实际上，我必须使用完整的 URL 指定每个参数，例如：

```
<parameter name="transport.vfs.FileNamePattern">.*.txt</parameter> 
```

我看到一些带有属性调解器的示例，我想它适用于下一个代理，但这里的问题是我需要在执行之前更改代理参数值。我尝试使用“触发器”代理调用自定义调解器，该调解器更改所需代理的 SynapseConfiguration 但这不起作用。

有没有办法用查找替换这些固定值来创建一些部署配置？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T18:37:20.820

您可以查看这篇文章[如何根据 XML 配置文件在 WSO2 ESB 中动态路由消息，以](https://stackoverflow.com/questions/11034013/how-to-dynamically-route-message-in-wso2-esb-based-on-xml-configuration-file/11081687#11081687)了解如何在代理序列中动态设置值。

你可以这样做：

```
<parameter name="transport.vfs.FileNamePattern">
    <script language="js">mc.getProperty('MY_DYNAMIC_VALUE')</script>
</parameter> 
```

我不确定这会对您有多大帮助，因为我怀疑 vfs 参数是在初始化代理时设置的，而不是在运行时设置的。如果你试一试，如果可能的话，如果它有效，请回帖到这个线程。

问候，尼德基尔

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T08:40:31.043

代理服务定义中的参数是 Axis2Service 配置中的服务级别参数。它们在您初始化 Axis2Service 时使用，在这种情况下，它是 Synapse/WSO2 ESB 代理服务。所以你不能动态地改变参数。

但我可以建议以下方法。它可能适用于您的方案，也可能不适用。

有一组 VFS 代理来侦听不同的位置。每个人都会查看一个给定的文件扩展名。（一个用于 .txt 一个用于 .foo 等）

使用另一个通用 vfs 代理将文件动态复制到正确的位置（它接受任何扩展名）。（您可以使用 vfs 发件人）。

希望这可以帮助。

干杯，慈善机构

# r - R中调整矩阵大小的函数

> ID：11123152
> 
> 赞同：9
> 
> 时间：2012-06-20T15:40:44.310
> 
> 标签：r, matrix

我想知道是否有一个函数可以缩小 R 统计软件中的矩阵，就像调整图像大小一样。MATLAB 中的函数`imresize()`正是我正在寻找的（我相信它取周围点的平均值，但我不确定），但我想知道这个函数是否有 R 等价物。

这个问题之前已经在这个论坛上发布过，但是参考了 MATLAB，而不是 R： [Matlab "Scale Down" a Vector with Averages](https://stackoverflow.com/questions/7741808/matlab-scale-down-a-vector-with-averages)`imresize()`这篇文章以“你不能使用这个函数 的任何原因吗？”开头。正是我正在寻找的东西，但在 R 中，而不是在 MATLAB 中。

假设我有一个世界各地的经纬度网格，假设它由一个 64*128 的温度矩阵表示。现在假设我想将相同的数据包含在一个新矩阵中，但我想重新调整我的网格，使其成为一个 71*114 的全球温度矩阵。我正在寻找一个允许我这样做的函数（同样是 imresize() 函数，但在 R 中，而不是在 MATLAB 中）

谢谢你。史蒂夫

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-20T18:53:53.603

一种方法是使用包中的`resample()`函数`raster`。

我将首先展示如何使用它来重新调整网格，然后给出一个更易于检查的示例，说明它在较小的栅格对象中的应用

## 用于`resample()`调整矩阵大小

```
library(raster)
m <- matrix(seq_len(68*128), nrow=68, ncol=128, byrow=TRUE)

## Convert matrix to a raster with geographical coordinates
r <- raster(m)
extent(r) <- extent(c(-180, 180, -90, 90))

## Create a raster with the desired dimensions, and resample into it
s <- raster(nrow=71, ncol=114)
s <- resample(r,s)

## Convert resampled raster back to a matrix
m2 <- as.matrix(s) 
```

## 目视确认`resample()`是否符合您的要求：

```
library(raster)
## Original data (4x4)
rr <- raster(ncol=4, nrow=4)
rr[] <- 1:16
## Resize to 5x5
ss <- raster(ncol=5,  nrow=5)
ss <- resample(rr, ss)
## Resize to 3x3
tt <- raster(ncol=3, nrow=3)
tt <- resample(rr, tt)
## Plot for comparison
par(mfcol=c(2,2))
plot(rr, main="original data")
plot(ss, main="resampled to 5-by-5")
plot(tt, main="resampled to 3-by-3") 
```

![在此处输入图像描述](../Images/9ece4b628e5312afe6339261b939454f.png)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-05-02T13:36:45.417

Josh O'Brien 发布的答案是好的，它帮助了我（作为起点），但这种方法太慢了，因为我有大量的数据列表。下面的方法是不错的选择。它使用`fields`和工作得更快。

### 功能

```
rescale <- function(x, newrange=range(x)){
  xrange <- range(x)
  mfac <- (newrange[2]-newrange[1])/(xrange[2]-xrange[1])
  newrange[1]+(x-xrange[1])*mfac
}

ResizeMat <- function(mat, ndim=dim(mat)){
  if(!require(fields)) stop("`fields` required.")

  # input object
  odim <- dim(mat)
  obj <- list(x= 1:odim[1], y=1:odim[2], z= mat)

  # output object
  ans <- matrix(NA, nrow=ndim[1], ncol=ndim[2])
  ndim <- dim(ans)

  # rescaling
  ncord <- as.matrix(expand.grid(seq_len(ndim[1]), seq_len(ndim[2])))
  loc <- ncord
  loc[,1] = rescale(ncord[,1], c(1,odim[1]))
  loc[,2] = rescale(ncord[,2], c(1,odim[2]))

  # interpolation
  ans[ncord] <- interp.surface(obj, loc)

  ans
} 
```

### 让我们看看它是如何工作的

```
## Original data (4x4)
rr <- matrix(1:16, ncol=4, nrow=4)
ss <- ResizeMat(rr, c(5,5)) 
tt <- ResizeMat(rr, c(3,3)) 

## Plot for comparison
par(mfcol=c(2,2), mar=c(1,1,2,1))
image(rr, main="original data", axes=FALSE)
image(ss, main="resampled to 5-by-5", axes=FALSE)
image(tt, main="resampled to 3-by-3", axes=FALSE) 
```

![调整大小的矩阵](../Images/ea22a25dc98f23412c4b0bca3e545c31.png)

# iphone - CoreData 中保存的字符串返回 和字符串。为什么？

> ID：11123153
> 
> 赞同：1
> 
> 时间：2012-06-20T15:40:47.510
> 
> 标签：iphone, objective-c, ios, core-data

嗨，我将来自数据库的值保存在 MultableArray 中，然后保存在 CoreData 中：

```
 NSMultableArray *mutary = [[NSMultableArray alloc] init];
      NSManagedObjectContext *context = [app managedObjectContext];
    for(int n=0; n<[AttributeArray count]; n++)
    {

    [mutary addObject:[[AttributeArray objectAtIndex:n] objectForKey:@"AttributName"]];
    NSLog(@"%@", mutary);
}
attributeString = [mutary componentsJoinedByString:@","];

 raume = [NSEntityDescription insertNewObjectForEntityForName:@"Raum" inManagedObjectContext:context];

raume.raumattribut = attributeString;

 if (![context save:&error]) {
 NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
 abort(); 
```

}

MultableArray 的 NSLog 输出为：

```
 2012-06-20 17:21:00.047 book-app[31984:15803] (
    A7OVERHEAD,
    Beamer
) 
```

到目前为止，它的工作正常。数据库中的两个预期值现在位于数组中。现在我从 CoreData 获取这些属性：

```
 NSManagedObjectContext *context = [app managedObjectContext];
    NSFetchRequest *request = [[NSFetchRequest alloc] init];
    NSEntityDescription *entity = [NSEntityDescription entityForName:@"Raum" inManagedObjectContext:context];
    [request setEntity:entity];
    NSError *error = nil;
    NSArray *events = [context executeFetchRequest:request error:&error];

for (Raum *att in events)
    {
     stringAttribute = [[events valueForKey:@"raumattribut"] componentsJoinedByString:@","];
     NSLog(@"ATTRIBUTE: %@", stringAttribute);
    }
} 
```

到目前为止，一切都很好。但是，如果我现在查看我的 NSLog 输出：

```
2012-06-20 17:21:00.055 book-app[31984:15803] ATTRIBUTE: <null>,A7OVERHEAD,Beamer 
```

CoreData 正在返回，然后是两个值。那是从哪里来的？

有人可以帮忙吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T15:46:55.857

编辑：经过一些调查和澄清（见评论），这是我的答案：在 NSArray 上调用 valueForKey 返回一个数组，其中每个元素都是通过在原始数组的每个成员上调用 valueForKey 创建的。这意味着您的输出表明您的 fetch 请求返回了 3 个对象，而第一个对象没有设置它的 raumattribut 属性。

上一个答案：您在 NSArray 的实例（查询结果）上调用 valueForKey。也许你需要~~获取 objectAtIndex:0~~首先使用要迭代值的变量？valueForKey 可能返回 nil。

```
stringAttribute = [[att valueForKey:@"raumattribut"] componentsJoinedByString:@","]; 
```

或类似的。

编辑：起初我错过了第二部分的 for 循环，我编辑了上面的代码示例以使用 attr，它

# javascript - 如何用rails标签连接整数？

> ID：11123156
> 
> 赞同：1
> 
> 时间：2012-06-20T15:41:06.367
> 
> 标签：javascript, ruby-on-rails, erb

我试图在 erb 内的 rails 标记中连接动态 int。主要思想是动态更新信息框文本。

```
for (i=2;i<=numplayers;i++)
{
    document.getElementById("infobox2").innerHTML= '<%= @plrdet["+i+"].name %>';
} 
```

如果我尝试类似的东西

```
 document.getElementById("infobox2").innerHTML= '<%= @plrdet["+i+"].name %>'; 
```

它发送错误

```
can't convert String into Integer 
```

尝试了很多组合，有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T04:45:16.170

```
for(i=2;i<=numplayers;i++)
{  
    document.getElementById("infobox2").innerHTML = <%= @plrdet[i].name%>;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T15:54:51.957

你必须反过来做。您的 javascript 代码将在客户端浏览器中进行评估，`i`直到那时才知道。在这些条件下，`<%= @plrdet[i] %>`不会被 Rails 评估。

```
<% for i in (0..numberofplayers) do %>
  document.getElementById("infobox2").innerHTML= '<%= @plrdet[i].name %>';
<% end %> 
```

不过，您必须能够`numberofplayers`在 ERB 中进行评估。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T15:45:28.550

尝试：

```
document.getElementById("infobox2").innerHTML= '<%= @plrdet["+i.to_s"].name %>'; 
```

但是，看起来您想要一个数组的索引，但是在这种情况下将它包装在一个字符串中，您应该只使用：

```
document.getElementById("infobox2").innerHTML = '<%= @plrdet[i].name%>'; 
```

### 更新...

我相信问题在于您在需要 JavaScript 变量时尝试执行 ruby​​ 代码。我相信这可能会奏效。

```
document.getElementById("infobox2").innerHTML = "<%= @plrdet["+i+"].name%>"; 
```

注意使用双引号而不是单引号以及开头和结尾。

# java - Guice 等价于 Spring 的 BeanPostProcessor

> ID：11123166
> 
> 赞同：4
> 
> 时间：2012-06-20T15:41:24.790
> 
> 标签：java, spring, dependency-injection, guice

使用 Spring，可以将`BeanPostProcessor`实现添加到上下文中，以便在使用它们的依赖项初始化它们之前和之后有条件地替换、包装或代理 bean。

Google Guice 是否提供类似的功能？

***示例：**我有一个`SomethingHandler`带有单个`execute`方法的接口，并且基于某些条件，我想用 来装饰/包装实现`LoggingHandler`，`AuthenticationHandler`依此类推。*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-20T15:52:29.230

您应该使用 InjectionListener

[http://google-guice.googlecode.com/git/javadoc/com/google/inject/spi/InjectionListener.html](http://google-guice.googlecode.com/git/javadoc/com/google/inject/spi/InjectionListener.html)

更多关于这个主题：

[http://code.google.com/p/google-guice/issues/detail?id=62](http://code.google.com/p/google-guice/issues/detail?id=62)

# javascript - HTML5 缩放到不同的检测到的屏幕尺寸

> ID：11123167
> 
> 赞同：1
> 
> 时间：2012-06-20T15:41:27.240
> 
> 标签：javascript, html, cordova, canvas

我正在使用 HTML5 <canvas> 标记制作一个简单的应用程序，并使用 Cordova 将代码编译到本机应用程序中，但问题是画布使用与其大小无关的坐标，我们计划让它跨越Apple 和 Google 支持的设备……这可能意味着至少有 10 种以上的屏幕尺寸/分辨率。

所以我想知道如何`<canvas>`在不同的屏幕尺寸上使用（将全屏显示）。

使用基于模型的坐标会有帮助吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T17:55:51.167

我很确定您只能在画布元素本身中设置一个宽度和高度。如果您想根据纵向、横向等更改其大小，您可以使用[CSS 媒体查询](https://developer.mozilla.org/en/CSS/Media_queries)。我很确定这会使您的画布在某些情况下看起来质量不是很高，因为您实际上只是在放大或缩小预定义元素的大小。

根据屏幕尺寸等，可能有一种更好的方式来重绘画布，但我还没有尝试过。

# ms-access-2007 - Access 2007 交叉表查询表达式

> ID：11123168
> 
> 赞同：1
> 
> 时间：2012-06-20T15:41:28.300
> 
> 标签：ms-access-2007

目标：根据计算列的值创建百分比列。

这是 Crosstab 查询的 SQL 代码：

```
TRANSFORM Count(Master_Calendar.ID) AS CountOfID
SELECT Master_Calendar.Analyst, Count(Master_Calendar.ID) AS [Total Of ID]
FROM Master_Calendar
GROUP BY Master_Calendar.Analyst
PIVOT Master_Calendar.[Current Status]; 
```

这给了我一个交叉表查询，显示数据库中“已完成”、“处理中”或“未开始”的条目数量，按它们所属的分析师排序。

我想要做的是添加另一列来计算完成百分比 - 所以（已完成/ID总数）* 100。我尝试将其放入另一个单元格的表达式中，但它返回一个“[已完成]”没有找到，即使它给了我它作为表达式生成器中的一个选项。

我只是错误地命名了我的变量，还是不可能这样做？我可以使用查询代码引用包含“已完成”的记录的总数，而不是使用数据透视表查找值吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T18:33:45.950

尝试：

```
SELECT 
    xTab.Analyst,
    [Completed]/([Total of ID]/100) AS [Complete%], 
    [In Process]/([Total of ID]/100) AS [In Process%],
    [Not Started]/([Total of ID]/100) AS [Not Started%]
FROM xTab; 
```

# asp.net-mvc - 在 MVC 项目中将 Azure 与 Ninject InSessionScope 类一起使用

> ID：11123170
> 
> 赞同：1
> 
> 时间：2012-06-20T15:41:33.000
> 
> 标签：asp.net-mvc, azure, ninject

我有一些使用 ninject“会话范围”实例化的类——因为这些对象在控制器方法之间传递，然后只被持久化一次，这种技术对这个项目很有效。

借助 Azure 的多主机功能，我假设 InSessionScope 不再可靠，因为任何服务器都可以为我的请求提供服务。

有谁知道我是否错了并且仍然可以在 Azure 中使用会话范围，或者有人知道对此的替代方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T17:21:20.347

在这种情况下，您将使用适用于 Windows Azure 的自定义会话状态提供程序：

*   [Windows Azure 缓存的会话状态提供程序](http://msdn.microsoft.com/en-us/library/windowsazure/gg185668.aspx)
*   [Azure 提供商](http://azureproviders.codeplex.com/)

现在，如果您使用 InProc 以外的会话状态提供程序，您需要确保存储在会话中的任何内容都是可[序列化](http://msdn.microsoft.com/en-us/library/ms178586.aspx)的。您应该对此进行测试，因为这可能会影响您的应用程序今天的工作方式。

# vba - 使用vba在excel中的现有列之前添加20行的空列

> ID：11123172
> 
> 赞同：0
> 
> 时间：2012-06-20T15:41:39.443
> 
> 标签：vba, excel

今天我面临一个可能很容易的问题，但对我来说很困难，因为我不精通 VBA。

场景是，当我插入整列然后将一列复制到该列时，我的 Excel 文件会变成几 MB 大小。实际上，我想最小化文件空间以便可以轻松共享。

**我的问题**：有什么方法可以复制和粘贴特定行的列 - 不是所有行，因为这样文件的大小是几 KB 而不是 MB。

请提出一个有效的解决方案来减少文件大小。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T21:16:15.420

如果您打开宏记录器，做您想做的事，并查看生成的代码，您将能够看到如何在 VBA 中执行此操作。

具体来说，您要做的第一件事是在范围对象上使用 .Insert 方法和参数 Shift:=xlToRight 来腾出空间，然后使用 .Copy 和 .Paste 将范围复制到新清除的空间中，例如

```
Range("C1:C2").Insert Shift:=xlToRight
Range("A1:A2").Copy
Range("C1").Select
ActiveSheet.Paste 
```

# ios - 在情节提要中使用 iOS 静态库公共视图控制器？

> ID：11123179
> 
> 赞同：10
> 
> 时间：2012-06-20T15:41:57.270
> 
> 标签：ios, storyboard, xib, reusability

我们正在创建一组可在我们拥有的多个应用程序中重用的通用组件和通用视图。在这些库中，我们有 .xib 文件和视图控制器。我们希望能够在情节提要中为特定应用程序使用这些。这甚至可能吗？

我还没有看到一种简单的方法来共享故事板中静态库中的可重用视图或组件。

为了避免在每个项目中重复代码，推荐的方法是什么？

谢谢..

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-05T14:05:19.087

通常，在制作用于共享的静态库时，您还可以包含资源包（例如 xib 和图像文件）。以 FacebookSDK 为例。它包含一个包含图像和字符串的包。这些可以由 SDK 代码或 SDK 的客户端应用程序加载。

有关使用资源制作静态库的帮助，请参阅：[https](https://github.com/jverkoey/iOS-Framework) ://github.com/jverkoey/iOS-Framework （感谢@jnjosh）或[https://github.com/kstenerud/iOS-Universal-Framework](https://github.com/kstenerud/iOS-Universal-Framework)。我最近在一个运输应用程序上使用了 iOS-Universal-Framework。效果很好。

为了使用带有故事板的 xib 文件，您可以采用以下两种方法之一：

*   在情节提要中 VC 调用的动作或 segue 中加载 xib 视图控制器。

*   或者在情节提要中使用 xib。请参阅：[使用 XCode 故事板实例化使用 XIB 进行设计的视图控制器](https://stackoverflow.com/questions/9155719/using-xcode-storyboard-to-instantiate-view-controller-that-uses-xib-for-its-desi)

此外，如果它只是供内部使用，我建议简单地制作代码+资源的共享存储库，而不是制作静态库。静态库的主要好处是易于在团队之外分发。

# iphone - Gyro 在 Cocos2D 环境中不工作

> ID：11123181
> 
> 赞同：0
> 
> 时间：2012-06-20T15:42:04.443
> 
> 标签：iphone, cocos2d-iphone, gyroscope

我有一个非常奇怪的问题。我有一个基于 cocos2D 库的 AR 应用程序。最近，当我当天第一次启动 xcode 时，陀螺仪不工作，即无论设备如何定向，偏航和横滚都被测量为 0。它应该根据我在代码中执行的检查工作：

```
 // Initialize Gyro
    self.motionManager = [[[CMMotionManager alloc] init] autorelease];
    motionManager.deviceMotionUpdateInterval = (1.0/60.0);
    if (motionManager.isDeviceMotionAvailable) {
        NSLog(@"motion available");
        [motionManager startDeviceMotionUpdatesUsingReferenceFrame:CMAttitudeReferenceFrameXTrueNorthZVertical];
    } 
```

在过去的几天里，我通过注释掉一些我不再使用的内容或更改与屏幕上的精灵动画相关的内容来解决了这个问题。奇怪的是我会让它在我剩下的编码会话中正常工作，关闭 xcode，第二天当我再次打开 xcode 和我的项目时，陀螺仪再次坏了。

有没有对 cocos2d 或陀螺仪有更多经验的人知道可能是什么原因造成的？

谢谢。

**更新**

我注释掉了这条线

```
[mySprite runAction:[CCMoveTo actionWithDuration:refreshRate position:ccp(newX, newY)]]; 
```

并运行应用程序，陀螺仪再次工作。奇怪的是，当我取消注释同一行并再次运行应用程序时，陀螺仪仍然工作。是什么赋予了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T18:39:26.003

只是一种预感……是`motionManager`保留财产吗？

因为如果没有，motionManager 将被自动释放：

```
self.motionManager = [[[CMMotionManager alloc] init] autorelease]; 
```

# python - Python tkinter，如何禁用背景按钮被点击

> ID：11123185
> 
> 赞同：3
> 
> 时间：2012-06-20T15:42:14.703
> 
> 标签：python, button, background, window, tkinter

打开新的 tkinter 窗口时，我只希望用户能够单击新窗口上的按钮。他们不应该能够从属于应用程序的其他窗口单击按钮。我将如何做到这一点？

这是我的代码片段：

```
def exportEFS(self):
  self.exportGUI = Toplevel()
  Button(self.exportGUI, text='Backup', command=self.backup).pack(padx=100,pady=5)
  Button(self.exportGUI, text='Restore', command=self.restore).pack(padx=100,pady=5)

def backup(self):
  self.backupWindow = Toplevel()

  message = "Enter a name for your Backup."

  Label(self.backupWindow, text=message).pack()

  self.entry = Entry(self.backupWindow,text="enter your choice")
  self.entry.pack(side=TOP,padx=10,pady=12)

  self.button = Button(self.backupWindow, text="Backup",command=self.backupCallBack)
  self.button.pack(side=BOTTOM,padx=10,pady=10) 
```

在此片段中，一旦打开了 backupWindow，exportGUI 仍保持打开状态，但在打开 backupWindow 时用户不应单击“备份”或“恢复”。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T15:49:04.380

您将需要在 TopLevel 窗口上调用 grab_set，以便将所有键盘和鼠标事件发送到该窗口。

```
def exportEFS(self):
  self.exportGUI = Toplevel()
  Button(self.exportGUI, text='Backup', command=self.backup).pack(padx=100,pady=5)
  Button(self.exportGUI, text='Restore', command=self.restore).pack(padx=100,pady=5)

def backup(self):
  self.backupWindow = Toplevel()
  self.backupWindow.grab_set()

  message = "Enter a name for your Backup."

  Label(self.backupWindow, text=message).pack()

  self.entry = Entry(self.backupWindow,text="enter your choice")
  self.entry.pack(side=TOP,padx=10,pady=12)

  self.button = Button(self.backupWindow, text="Backup",command=self.backupCallBack)
  self.button.pack(side=BOTTOM,padx=10,pady=10) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T15:50:05.573

您可以做的是将状态设置为禁用。如此：

```
self.button.config(state="disabled") 
```

要启用它，您只需使用：

```
self.button.config(state="normal") 
```

但是，您必须先将按钮分配给变量，如下所示：

```
self.backup=Button(self.exportGUI, text='Backup', command=self.backup)
self.backup.pack(padx=100,pady=5)
self.restore=Button(self.exportGUI, text='Restore', command=self.restore)
self.restore.pack(padx=100,pady=5) 
```

所以你可以使用以下方法禁用这些：

```
self.backup.config(state="disabled")
self.restore.config(state="disabled") 
```

并重新启用：

```
self.backup.config(state="normal")
self.restore.config(state="normal") 
```

但是请注意，当按钮被禁用时，无论是通过代码还是通过使用它的用户，都无法对该按钮进行任何更改。所以这意味着如果您想更改该按钮的文本，则必须在更改`"normal"`之前将按钮的状态更改为（如果它已经不处于该状态，默认情况下，所有小部件在首次创建）。

干杯:)

# c# - 有没有办法从锁定的文件中读取数据？

> ID：11123187
> 
> 赞同：4
> 
> 时间：2012-06-20T15:42:23.330
> 
> 标签：c#, file, file-io, io

这是我的想法：

```
 var file = @"myfile";
        File.Open(file,
                  FileMode.Open, FileAccess.ReadWrite, FileShare.None);

        using (StreamReader rdr = new StreamReader(File.Open(file, FileMode.Open, FileAccess.Read, FileShare.Read)))
        {
            rdr.ReadToEnd();
        }
        var t = File.ReadAllBytes(file); 
```

既不能读取文件数据，`File.Open(file, FileMode.Open, FileAccess.Read, FileShare.Read)`也`File.ReadAllBytes`不能读取文件数据。

从我以前的 c++ 和 winapi 时代开始，我确实记得，如果你有备份权限，曾经有一种读取锁定文件的好方法，但我不知道如何在 c# 中获取和使用这些文件。

任何人都可以向我提供有关如何在文件被锁定后读取文件的示例吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-20T15:52:08.357

好吧，如果文件被完全锁定（不[共享](http://msdn.microsoft.com/en-us/library/system.io.fileshare%28v=vs.110%29.aspx)），您将无法读取它。如果打开文件以[共享 read](http://msdn.microsoft.com/en-us/library/system.io.fileshare%28v=vs.110%29.aspx)，您将能够使用非侵入式方法进行读取：

```
string fileName = @"myfile";
using (FileStream fileStream = new FileStream(fileName, FileMode.Open, FileAccess.Read, FileShare.ReadWrite);
using (StreamReader fileReader = new StreamReader(fileStream ))
{
    while (!fileReader .EndOfStream)
    {
        string line = fileReader .ReadLine();
        // Your code here
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T17:25:29.373

事实上，我试图做的事情是不可能的，备份权限也无济于事：

```
 [DllImport("kernel32.dll", CharSet = CharSet.Auto,
        CallingConvention = CallingConvention.StdCall,
        SetLastError = true)]
            public static extern SafeFileHandle CreateFile(
                string lpFileName,
                uint dwDesiredAccess,
                uint dwShareMode,
                IntPtr SecurityAttributes,
                uint dwCreationDisposition,
                uint dwFlagsAndAttributes,
                IntPtr hTemplateFile
            );

    private static uint READ_CONTROL = 0x00020000;
    private static uint OPEN_EXISTING = 3;
    private static uint FILE_FLAG_BACKUP_SEMANTICS = 0x02000000;

        var file = @"myfile";
        File.Open(file,
                  FileMode.Open, FileAccess.ReadWrite, FileShare.None);

        using(PrivilegeEnabler pe = new PrivilegeEnabler(Process.GetCurrentProcess(), Privilege.Backup))
        {
            var hFile = CreateFile(file,           // lpFileName
                       READ_CONTROL,               // dwDesiredAccess
                       0,                          // dwShareMode
                       IntPtr.Zero,                // lpSecurityAttributes
                       OPEN_EXISTING,              // dwCreationDisposition
                       FILE_FLAG_BACKUP_SEMANTICS, // dwFlagsAndAttributes
                       IntPtr.Zero);               // hTemplateFile
            using (var fs=new  FileStream(hFile.DangerousGetHandle(),FileAccess.Read))
            {
                using (StreamReader rdr=new StreamReader(fs))
                {
                    rdr.ReadToEnd();
                }
            }
        } 
```

仍然会导致错误。

# c# - 在应用程序中存储字符串的位置？

> ID：11123188
> 
> 赞同：2
> 
> 时间：2012-06-20T15:42:27.703
> 
> 标签：c#, .net

WinForms 相对较新，但我正在开发一个小型企业应用程序。无论如何，我应该在哪里存储表单的字符串和其他资源？我会有名称、地址等标签。我应该在设计器中对它们进行硬编码吗？或者将它们存储在 .resx 文件中？如果是这样，哪个 .resx 文件（表单或属性）？

我只是想弄清楚“经验丰富”的 C#/.NET 开发人员认为什么是好的做法？我的第一选择是表单的 .resx 文件。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-20T15:45:01.447

除非是多语言应用程序，否则通常不会更改名称和地址等字段。如果它是一个只有英文的应用程序并且标签不太可能改变，我会留下硬编码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T15:47:01.990

要跟进其他答案：如果您要本地化此应用程序（或至少预期本地化此应用程序），那么通常您会使用 .NET 中的内置资源功能（项目 > 添加新项目 > 资源）你可以让 WinForms 控件自动从资源中加载 .Text 等属性，而无需手动定义。

# ios - Cocos2d v2.x，安装模板失败..权限被拒绝。我在做傻事吗？

> ID：11123189
> 
> 赞同：11
> 
> 时间：2012-06-20T15:42:39.980
> 
> 标签：ios, macos, templates, unix, cocos2d-iphone

我想澄清这个问题。我在 iMac 上安装了 Cocos2d 1.01 rc，安装了 XCode 4.3，现在我已经下载了 v2.0 并想安装模板（按照[官方指南](http://www.cocos2d-iphone.org/wiki/doku.php/prog_guide:migrate_to_v2.0)）。不幸的是，终端在尝试此操作时允许我拒绝消息。

我认为我需要做的只是一个“sudo su”命令，然后是一个 chmod，这就是我试图做的：

```
sudo su
chmod -R 0777 /Users/xxx/Library/Developer/Xcode/Templates/* 
```

结果对我来说似乎很好（在模板的所有子目录上读取、写入和执行）：

```
ls -l /Users/xxxx/Library/Developer/Xcode/Templates/
total 0
drwxrwxrwx   4 root  staff  136 20 Giu 17:30 File Templates
drwxrwxrwx  19 root  staff  646 15 Mar 15:14 cocos2d 
```

但是当我安装模板时，我得到以下内容，我不会安静地得到..它说“完成！” 但是终端中有几个错误表明由于权限而无法创建目录（即使它们似乎都设置了 r,w,x ）。另外，我尝试通过 XCode 创建一个空的 Cocos2d 项目（重新启动 XCode 后），cocos2d.m 仍然显示版本 v1.0.1。

为了清楚起见，这里是尝试安装模板后来自终端的日志（**我有点迷茫**）：

```
./install-templates.sh -f
cocos2d-iphone template installer

Installing Xcode 4 cocos2d iOS template
----------------------------------------------------

...creating destination directory: /Users/xxx/Library/Developer/Xcode/Templates/cocos2d v2.x/
mkdir: /Users/xxx/Library/Developer/Xcode/Templates/cocos2d v2.x: Permission denied
mkdir: /Users/xxx/Library/Developer/Xcode/Templates/cocos2d v2.x: Permission denied
...copying cocos2d files
rsync: mkdir "/Users/xxx/Library/Developer/Xcode/Templates/cocos2d v2.x/lib_cocos2d.xctemplate/libs" failed: No such file or directory (2)
rsync error: error in file IO (code 11) at /SourceCache/rsync/rsync-42/rsync/main.c(544) [receiver=2.6.9]
rsync: connection unexpectedly closed (8 bytes received so far) [sender]
rsync error: error in rsync protocol data stream (code 12) at /SourceCache/rsync/rsync-42/rsync/io.c(452) [sender=2.6.9]
rsync: mkdir "/Users/xxx/Library/Developer/Xcode/Templates/cocos2d v2.x/lib_cocos2d.xctemplate/libs" failed: No such file or directory (2)
rsync error: error in file IO (code 11) at /SourceCache/rsync/rsync-42/rsync/main.c(544) [receiver=2.6.9]
rsync: connection unexpectedly closed (8 bytes received so far) [sender]
rsync error: error in rsync protocol data stream (code 12) at /SourceCache/rsync/rsync-42/rsync/io.c(452) [sender=2.6.9]
mkdir: /Users/xxx/Library/Developer/Xcode/Templates/cocos2d v2.x: Permission denied
...copying CocosDenshion files
rsync: mkdir "/Users/xxx/Library/Developer/Xcode/Templates/cocos2d v2.x/lib_cocosdenshion.xctemplate/libs" failed: No such file or directory (2)
rsync error: error in file IO (code 11) at /SourceCache/rsync/rsync-42/rsync/main.c(544) [receiver=2.6.9]
rsync: connection unexpectedly closed (8 bytes received so far) [sender]
rsync error: error in rsync protocol data stream (code 12) at /SourceCache/rsync/rsync-42/rsync/io.c(452) [sender=2.6.9]
rsync: mkdir "/Users/xxx/Library/Developer/Xcode/Templates/cocos2d v2.x/lib_cocosdenshion.xctemplate/libs" failed: No such file or directory (2)
rsync error: error in file IO (code 11) at /SourceCache/rsync/rsync-42/rsync/main.c(544) [receiver=2.6.9]
rsync: connection unexpectedly closed (8 bytes received so far) [sender]
rsync error: error in rsync protocol data stream (code 12) at /SourceCache/rsync/rsync-42/rsync/io.c(452) [sender=2.6.9]
mkdir: /Users/xxx/Library/Developer/Xcode/Templates/cocos2d v2.x: Permission denied
...copying CocosDenshionExtras files
rsync: mkdir "/Users/xxx/Library/Developer/Xcode/Templates/cocos2d v2.x/lib_cocosdenshionextras.xctemplate/libs" failed: No such file or directory (2)
rsync error: error in file IO (code 11) at /SourceCache/rsync/rsync-42/rsync/main.c(544) [receiver=2.6.9]
rsync: connection unexpectedly closed (8 bytes received so far) [sender]
rsync error: error in rsync protocol data stream (code 12) at /SourceCache/rsync/rsync-42/rsync/io.c(452) [sender=2.6.9]
mkdir: /Users/xxx/Library/Developer/Xcode/Templates/cocos2d v2.x: Permission denied
...copying Kazmath files
rsync: mkdir "/Users/xxx/Library/Developer/Xcode/Templates/cocos2d v2.x/lib_kazmath.xctemplate/libs" failed: No such file or directory (2)
rsync error: error in file IO (code 11) at /SourceCache/rsync/rsync-42/rsync/main.c(544) [receiver=2.6.9]
rsync: connection unexpectedly closed (8 bytes received so far) [sender]
rsync error: error in rsync protocol data stream (code 12) at /SourceCache/rsync/rsync-42/rsync/io.c(452) [sender=2.6.9]
rsync: mkdir "/Users/xxx/Library/Developer/Xcode/Templates/cocos2d v2.x/lib_kazmath.xctemplate/libs" failed: No such file or directory (2)
rsync error: error in file IO (code 11) at /SourceCache/rsync/rsync-42/rsync/main.c(544) [receiver=2.6.9]
rsync: connection unexpectedly closed (8 bytes received so far) [sender]
rsync error: error in rsync protocol data stream (code 12) at /SourceCache/rsync/rsync-42/rsync/io.c(452) [sender=2.6.9]
...copying template files
rsync: mkdir "/Users/xxx/Library/Developer/Xcode/Templates/cocos2d v2.x" failed: Permission denied (13)
rsync error: error in file IO (code 11) at /SourceCache/rsync/rsync-42/rsync/main.c(544) [receiver=2.6.9]
rsync: connection unexpectedly closed (8 bytes received so far) [sender]
rsync error: error in rsync protocol data stream (code 12) at /SourceCache/rsync/rsync-42/rsync/io.c(452) [sender=2.6.9]
done!

Installing Xcode 4 Chipmunk iOS template
----------------------------------------------------

mkdir: /Users/xxx/Library/Developer/Xcode/Templates/cocos2d v2.x: Permission denied
...copying Chipmunk files
rsync: mkdir "/Users/xxx/Library/Developer/Xcode/Templates/cocos2d v2.x/lib_chipmunk.xctemplate/libs" failed: No such file or directory (2)
rsync error: error in file IO (code 11) at /SourceCache/rsync/rsync-42/rsync/main.c(544) [receiver=2.6.9]
rsync: connection unexpectedly closed (8 bytes received so far) [sender]
rsync error: error in rsync protocol data stream (code 12) at /SourceCache/rsync/rsync-42/rsync/io.c(452) [sender=2.6.9]
rsync: mkdir "/Users/xxx/Library/Developer/Xcode/Templates/cocos2d v2.x/lib_chipmunk.xctemplate/libs" failed: No such file or directory (2)
rsync error: error in file IO (code 11) at /SourceCache/rsync/rsync-42/rsync/main.c(544) [receiver=2.6.9]
rsync: connection unexpectedly closed (8 bytes received so far) [sender]
rsync error: error in rsync protocol data stream (code 12) at /SourceCache/rsync/rsync-42/rsync/io.c(452) [sender=2.6.9]
done!

Installing Xcode 4 Box2d iOS template
----------------------------------------------------

mkdir: /Users/xxx/Library/Developer/Xcode/Templates/cocos2d v2.x: Permission denied
...copying Box2d files
rsync: mkdir "/Users/xxx/Library/Developer/Xcode/Templates/cocos2d v2.x/lib_box2d.xctemplate/libs" failed: No such file or directory (2)
rsync error: error in file IO (code 11) at /SourceCache/rsync/rsync-42/rsync/main.c(544) [receiver=2.6.9]
rsync: connection unexpectedly closed (8 bytes received so far) [sender]
rsync error: error in rsync protocol data stream (code 12) at /SourceCache/rsync/rsync-42/rsync/io.c(452) [sender=2.6.9]
rsync: mkdir "/Users/xxx/Library/Developer/Xcode/Templates/cocos2d v2.x/lib_box2d.xctemplate/libs" failed: No such file or directory (2)
rsync error: error in file IO (code 11) at /SourceCache/rsync/rsync-42/rsync/main.c(544) [receiver=2.6.9]
rsync: connection unexpectedly closed (8 bytes received so far) [sender]
rsync error: error in rsync protocol data stream (code 12) at /SourceCache/rsync/rsync-42/rsync/io.c(452) [sender=2.6.9]
done!

Installing Xcode 4 CCNode file templates...
----------------------------------------------------

...creating destination directory: /Users/xxx/Library/Developer/Xcode/Templates/File Templates/cocos2d v2.x/
mv: rename /Users/xxx/Library/Developer/Xcode/Templates/cocos2d v2.x//CCNode class.xctemplate to /Users/xxx/Library/Developer/Xcode/Templates/File Templates/cocos2d v2.x/CCNode class.xctemplate: No such file or directory
done! 
```

任何帮助将不胜感激:)，谢谢！

编辑：尝试

```
sudo ./install-templates.sh -f 
```

给出：

```
cocos2d-iphone template installer

Error: Do not run this script as root.

'root' is no longer supported

RECOMMENDED WAY:
 ./install-templates.sh -f 
```

编辑2：

我尝试删除 Templates 目录中的 cocos2d 文件夹，如下所示：

```
drwxrwxrwx  3 root     staff  102 15 Mar 15:14 cocos2d
drwxr-xr-x  2 user  staff   68 20 Giu 17:30 cocos2d v2.x
imac-di-user:File Templates user$ cd ..
imac-di-user:Templates user$ ls 
File Templates  cocos2d
imac-di-user:Templates user$ sudo rm -rf *
Password:
imac-di-user:Templates user$ ls 
```

并显示没有留下任何目录。然后我回到包含下载的 Cocos2d 2.x 文件的文件夹，我启动了安装脚本，如下所示：

```
imac-di-daniele:cocos2d-iphone-2.0-rc2 user$ ./install-templates.sh -f 
```

不幸的是，它仍然无法安装它们，现在我没有模板了。这是控制台的输出：

```
./install-templates.sh -f
cocos2d-iphone template installer

Installing Xcode 4 cocos2d iOS template
----------------------------------------------------

...creating destination directory: /Users/user/Library/Developer/Xcode/Templates/cocos2d v2.x/
mkdir: /Users/user/Library/Developer/Xcode/Templates/cocos2d v2.x: Permission denied
mkdir: /Users/user/Library/Developer/Xcode/Templates/cocos2d v2.x: Permission denied
...copying cocos2d files
rsync: mkdir "/Users/user/Library/Developer/Xcode/Templates/cocos2d v2.x/lib_cocos2d.xctemplate/libs" failed: No such file or directory (2)
rsync error: error in file IO (code 11) at /SourceCache/rsync/rsync-42/rsync/main.c(544) [receiver=2.6.9]
rsync: connection unexpectedly closed (8 bytes received so far) [sender]
rsync error: error in rsync protocol data stream (code 12) at /SourceCache/rsync/rsync-42/rsync/io.c(452) [sender=2.6.9]
rsync: mkdir "/Users/user/Library/Developer/Xcode/Templates/cocos2d v2.x/lib_cocos2d.xctemplate/libs" failed: No such file or directory (2)
rsync error: error in file IO (code 11) at /SourceCache/rsync/rsync-42/rsync/main.c(544) [receiver=2.6.9]
rsync: connection unexpectedly closed (8 bytes received so far) [sender]
rsync error: error in rsync protocol data stream (code 12) at /SourceCache/rsync/rsync-42/rsync/io.c(452) [sender=2.6.9]
mkdir: /Users/user/Library/Developer/Xcode/Templates/cocos2d v2.x: Permission denied
...copying CocosDenshion files
rsync: mkdir "/Users/user/Library/Developer/Xcode/Templates/cocos2d v2.x/lib_cocosdenshion.xctemplate/libs" failed: No such file or directory (2)
rsync error: error in file IO (code 11) at /SourceCache/rsync/rsync-42/rsync/main.c(544) [receiver=2.6.9]
rsync: connection unexpectedly closed (8 bytes received so far) [sender]
rsync error: error in rsync protocol data stream (code 12) at /SourceCache/rsync/rsync-42/rsync/io.c(452) [sender=2.6.9]
rsync: mkdir "/Users/user/Library/Developer/Xcode/Templates/cocos2d v2.x/lib_cocosdenshion.xctemplate/libs" failed: No such file or directory (2)
rsync error: error in file IO (code 11) at /SourceCache/rsync/rsync-42/rsync/main.c(544) [receiver=2.6.9]
rsync: connection unexpectedly closed (8 bytes received so far) [sender]
rsync error: error in rsync protocol data stream (code 12) at /SourceCache/rsync/rsync-42/rsync/io.c(452) [sender=2.6.9]
mkdir: /Users/user/Library/Developer/Xcode/Templates/cocos2d v2.x: Permission denied
...copying CocosDenshionExtras files
rsync: mkdir "/Users/user/Library/Developer/Xcode/Templates/cocos2d v2.x/lib_cocosdenshionextras.xctemplate/libs" failed: No such file or directory (2)
rsync error: error in file IO (code 11) at /SourceCache/rsync/rsync-42/rsync/main.c(544) [receiver=2.6.9]
rsync: connection unexpectedly closed (8 bytes received so far) [sender]
rsync error: error in rsync protocol data stream (code 12) at /SourceCache/rsync/rsync-42/rsync/io.c(452) [sender=2.6.9]
mkdir: /Users/user/Library/Developer/Xcode/Templates/cocos2d v2.x: Permission denied
...copying Kazmath files
rsync: mkdir "/Users/user/Library/Developer/Xcode/Templates/cocos2d v2.x/lib_kazmath.xctemplate/libs" failed: No such file or directory (2)
rsync error: error in file IO (code 11) at /SourceCache/rsync/rsync-42/rsync/main.c(544) [receiver=2.6.9]
rsync: connection unexpectedly closed (8 bytes received so far) [sender]
rsync error: error in rsync protocol data stream (code 12) at /SourceCache/rsync/rsync-42/rsync/io.c(452) [sender=2.6.9]
rsync: mkdir "/Users/user/Library/Developer/Xcode/Templates/cocos2d v2.x/lib_kazmath.xctemplate/libs" failed: No such file or directory (2)
rsync error: error in file IO (code 11) at /SourceCache/rsync/rsync-42/rsync/main.c(544) [receiver=2.6.9]
rsync: connection unexpectedly closed (8 bytes received so far) [sender]
rsync error: error in rsync protocol data stream (code 12) at /SourceCache/rsync/rsync-42/rsync/io.c(452) [sender=2.6.9]
...copying template files
rsync: mkdir "/Users/user/Library/Developer/Xcode/Templates/cocos2d v2.x" failed: Permission denied (13)
rsync error: error in file IO (code 11) at /SourceCache/rsync/rsync-42/rsync/main.c(544) [receiver=2.6.9]
rsync: connection unexpectedly closed (8 bytes received so far) [sender]
rsync error: error in rsync protocol data stream (code 12) at /SourceCache/rsync/rsync-42/rsync/io.c(452) [sender=2.6.9]
done!

Installing Xcode 4 Chipmunk iOS template
----------------------------------------------------

mkdir: /Users/user/Library/Developer/Xcode/Templates/cocos2d v2.x: Permission denied
...copying Chipmunk files
rsync: mkdir "/Users/user/Library/Developer/Xcode/Templates/cocos2d v2.x/lib_chipmunk.xctemplate/libs" failed: No such file or directory (2)
rsync error: error in file IO (code 11) at /SourceCache/rsync/rsync-42/rsync/main.c(544) [receiver=2.6.9]
rsync: connection unexpectedly closed (8 bytes received so far) [sender]
rsync error: error in rsync protocol data stream (code 12) at /SourceCache/rsync/rsync-42/rsync/io.c(452) [sender=2.6.9]
rsync: mkdir "/Users/user/Library/Developer/Xcode/Templates/cocos2d v2.x/lib_chipmunk.xctemplate/libs" failed: No such file or directory (2)
rsync error: error in file IO (code 11) at /SourceCache/rsync/rsync-42/rsync/main.c(544) [receiver=2.6.9]
rsync: connection unexpectedly closed (8 bytes received so far) [sender]
rsync error: error in rsync protocol data stream (code 12) at /SourceCache/rsync/rsync-42/rsync/io.c(452) [sender=2.6.9]
done!

Installing Xcode 4 Box2d iOS template
----------------------------------------------------

mkdir: /Users/user/Library/Developer/Xcode/Templates/cocos2d v2.x: Permission denied
...copying Box2d files
rsync: mkdir "/Users/user/Library/Developer/Xcode/Templates/cocos2d v2.x/lib_box2d.xctemplate/libs" failed: No such file or directory (2)
rsync error: error in file IO (code 11) at /SourceCache/rsync/rsync-42/rsync/main.c(544) [receiver=2.6.9]
rsync: connection unexpectedly closed (8 bytes received so far) [sender]
rsync error: error in rsync protocol data stream (code 12) at /SourceCache/rsync/rsync-42/rsync/io.c(452) [sender=2.6.9]
rsync: mkdir "/Users/user/Library/Developer/Xcode/Templates/cocos2d v2.x/lib_box2d.xctemplate/libs" failed: No such file or directory (2)
rsync error: error in file IO (code 11) at /SourceCache/rsync/rsync-42/rsync/main.c(544) [receiver=2.6.9]
rsync: connection unexpectedly closed (8 bytes received so far) [sender]
rsync error: error in rsync protocol data stream (code 12) at /SourceCache/rsync/rsync-42/rsync/io.c(452) [sender=2.6.9]
done!

Installing Xcode 4 CCNode file templates...
----------------------------------------------------

...creating destination directory: /Users/user/Library/Developer/Xcode/Templates/File Templates/cocos2d v2.x/
mkdir: /Users/user/Library/Developer/Xcode/Templates/File Templates: Permission denied
mv: rename /Users/user/Library/Developer/Xcode/Templates/cocos2d v2.x//CCNode class.xctemplate to /Users/user/Library/Developer/Xcode/Templates/File Templates/cocos2d v2.x/: No such file or directory
done! 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-20T18:37:19.187

在 Finder 中导航到此文件夹：

```
/Users/xxx/Library/Developer/Xcode/Templates 
```

找到所有以“cocos2d”开头的文件夹。应该有两个，一个用于项目模板，另一个用于文件模板。

**删除这些文件夹。**系统会要求您输入密码，因为它需要超级用户权限。旧文件夹消失后，您可以安装模板。

发生错误是因为您之前使用`sudo`. 当前的模板安装程序脚本不能运行`sudo`（如果您尝试已经发现，则会失败），因此无法删除/替换以前由超级用户创建的模板文件。因此，只需删除文件夹即可解决问题，而`chmod`不能。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-07-22T11:47:43.027

1.  Command + Shift + G
2.  ~/库/开发者/Xcode
3.  删除 Templates 文件夹并重新创建它
4.  cd ....../cocos2d-iphone-2.0
5.  ./install-templates.sh –f

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-09-27T09:27:04.217

经过几次尝试，这对我有用。这只是对上面答案的澄清，还有更多细节。注意：我使用的是带有 MountainLion 10.8.2 的 MacBook Pro）。而且，我有一个很好的 coco2d v1.x 安装。

** 此过程将安装 cocos2D v2.0 和模板 **

下载后`cocos2d-iphone-2.0.tar` （解压缩并保留在桌面上）

1.  点击`Command`++ （打开您的目录搜索 `Shift`）`G`
2.  输入搜索：/Library/Developer/Xcode（定位 cocos2d 模板文件夹）
3.  删除（并备份）“模板”文件夹（因为安装程序不会覆盖内容）
4.  在 xCode 文件夹中创建一个新的“模板”文件夹（这样安装程序就会知道在哪里编写新模板）
5.  打开终端，然后键入 cd，然后按回车键（获取新行）使终端保持打开状态。
6.  现在转到并打开新的 cocos2d-iphone-2.0 文件夹，然后查找“install-templates.sh”文件。
7.  您应该将该文档拖到当前行的终端中，然后按 enter(return)
8.  安装应该开始。
9.  开始 xcode > 寻找你的新 coco2s v2.x 模板

注意：我没有使用`sudo, -u, or -f`. 我也没有`cocos2d-iphone-2.0`在终端中引用文件夹（只是安装文档）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-19T09:08:56.720

1: sudo chmod -R 777 /用户/你的名字/图书馆/开发者/Xcode/模板

2：./install-templates.sh -f

3: sudo chmod -R 755 /用户/你的名字/图书馆/开发者/Xcode/模板

祝你好运

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-20T16:14:27.853

尝试

```
sudo ./install-templates.sh -f 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-17T09:40:58.407

执行以下黑客操作：打开文件 install-templates.sh 并将退出命令注释为：

```
# Make sure root is not executed
if [[ "$(id -u)" != "0" ]]; then
echo ""
echo "Error: Do not run this script as root." 1>&2
echo ""
echo "'root' is no longer supported" 1>&2
echo ""
echo "RECOMMENDED WAY:" 1>&2
echo " $0 -f" 1>&2
echo ""
#exit 1
fi 
```

我试过了，和我一起工作

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-07-15T08:06:43.647

我猜有一些以前由 root 创建的文件夹，您没有权限更改它。

尝试：

```
sudo chown -R xxx /Users/xxx/Library/Developer/Xcode/Templates
./install-templates.sh -f 
```

# perl - ClearQuest 中的选项按钮挂钩

> ID：11123190
> 
> 赞同：1
> 
> 时间：2012-06-20T15:42:42.687
> 
> 标签：perl, radio-button, hook, clearquest

当一组两个选项按钮设置为是时，我正在尝试设置一个文本字段以显示文本。（它们是是和否单选按钮）。我设置了它们，所以当检查时，值为 1。

When Yes is selected, text is supposed to be visible in the text field. When No is selected, I would like for the field to be blank.

现在，当我运行测试数据库时，选中是，然后保存单选按钮看起来像是在保存是，但随后又恢复为选中否。

我正在用 Perl 编写我的钩子。到目前为止，我在 Yes 单选按钮的 Value Changed 挂钩中有这个：

```
my $checked = $entity->GetFieldValue($fieldname)->GetValue();
if($checked eq "1"){
        my $setCharge = " This text when check Yes!";
        $entity->SetFieldValue("name_of_text_field", $setCharge);
} 
```

单选按钮都是 SHORT_STRING，我的字符串比较可能很明显。

我尝试将另一个单选按钮设置为 0 只是为了确保它未被选中，但这似乎是多余的，因为只能选择一个单选按钮。我试过为 no Value Changed 写一个钩子，但这也没有用。

想法？

# vba - IF 语句中的“And”和“Or”问题

> ID：11123191
> 
> 赞同：19
> 
> 时间：2012-06-20T15:42:46.487
> 
> 标签：vba, excel

我试图在 If 语句中使用“And”和“Or”。我可能有我的语法错误。

当数据应该使结果为真时，结果返回为假。这是代码：

```
ElseIf (origNum = "006260006" Or origNum = "30062600006") And creditOrDebit = "D" Then

'do things here

End If 
```

- 当我调试并来到这条线时，它会跳过它并且不会进入。

-origNum 实际上等于“006260006”和 creditOrDebit =“D”。

- 所以我假设我的“或”语句不起作用。

-希望这是一个快速简单的问题。谢谢！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-06-20T15:48:30.640

问题可能出在其他地方。试试这个代码，例如：

```
Sub test()

  origNum = "006260006"
  creditOrDebit = "D"

  If (origNum = "006260006" Or origNum = "30062600006") And creditOrDebit = "D" Then
    MsgBox "OK"
  End If

End Sub 
```

你会看到你的`Or`作品符合预期。您确定您的`ElseIf`语句已执行（如果之前的任何 if/elseif 为真，则不会执行）？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-20T18:31:24.447

这不是答案，但评论太长了。

在回复[JP 的回答/评论](https://stackoverflow.com/a/11123972/829571)时，我运行了以下测试来比较两种方法的性能。该`Profiler`对象是一个自定义类 - 但总的来说，它使用了一个相当准确的 kernel32 函数（`Private Declare Sub GetLocalTime Lib "kernel32" (lpSystemTime As SYSTEMTIME)`）。

```
Sub test()

  Dim origNum As String
  Dim creditOrDebit As String
  Dim b As Boolean
  Dim p As Profiler
  Dim i As Long

  Set p = New_Profiler

  origNum = "30062600006"
  creditOrDebit = "D"

  p.startTimer ("nested_ifs")

  For i = 1 To 1000000

    If creditOrDebit = "D" Then
      If origNum = "006260006" Then
        b = True
      ElseIf origNum = "30062600006" Then
        b = True
      End If
    End If

  Next i

  p.stopTimer ("nested_ifs")
  p.startTimer ("or_and")

  For i = 1 To 1000000

    If (origNum = "006260006" Or origNum = "30062600006") And creditOrDebit = "D" Then
      b = True
    End If

  Next i

  p.stopTimer ("or_and")

  p.printReport

End Sub 
```

5 次运行的结果（以毫秒为单位，1m 循环）：

> 2012 年 6 月 20 日 19:28:25
> nested_ifs (x1)：156 - 上次运行：156 - 平均运行：156
> or_and (x1)：125 - 上次运行：125 - 平均运行：125
> 
> 2012 年 6 月 20 日 19:28:26
> nested_ifs (x1)：156 - 上次运行：156 - 平均运行：156
> or_and (x1)：125 - 上次运行：125 - 平均运行：125
> 
> 2012 年 6 月 20 日 19:28:27
> nested_ifs (x1)：140 - 上次运行：140 - 平均运行：140
> or_and (x1)：125 - 上次运行：125 - 平均运行：125
> 
> 2012 年 6 月 20 日 19:28:28
> nested_ifs (x1)：140 - 上次运行：140 - 平均运行：140
> or_and (x1)：141 - 上次运行：141 - 平均运行：141
> 
> 2012 年 6 月 20 日 19:28:29
> nested_ifs (x1)：156 - 上次运行：156 - 平均运行：156
> or_and (x1)：125 - 上次运行：125 - 平均运行：125

**笔记**

如果`creditOrDebit`不是`"D"`，JP 的代码运行得更快（大约 60 毫秒，而 or/and 代码为 125 毫秒）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T16:27:30.833

我喜欢[assylias](https://stackoverflow.com/a/11123287/190829)的回答，但我会重构它如下：

```
Sub test()

Dim origNum As String
Dim creditOrDebit As String

origNum = "30062600006"
creditOrDebit = "D"

If creditOrDebit = "D" Then
  If origNum = "006260006" Then
    MsgBox "OK"
  ElseIf origNum = "30062600006" Then
    MsgBox "OK"
  End If
End If

End Sub 
```

`creditOrDebit`这可能会为您节省一些 CPU 周期，因为如果`<> "D"`检查`origNum`.

## 更新：

我使用以下过程来测试我的理论，即我的过程更快：

```
Public Declare Function timeGetTime Lib "winmm.dll" () As Long

Sub DoTests2()

  Dim startTime1 As Long
  Dim endTime1 As Long
  Dim startTime2 As Long
  Dim endTime2 As Long
  Dim i As Long
  Dim msg As String

  Const numberOfLoops As Long = 10000
  Const origNum As String = "006260006"
  Const creditOrDebit As String = "D"

  startTime1 = timeGetTime
  For i = 1 To numberOfLoops
    If creditOrDebit = "D" Then
      If origNum = "006260006" Then
        ' do something here
        Debug.Print "OK"
      ElseIf origNum = "30062600006" Then
        ' do something here
        Debug.Print "OK"
      End If
    End If
  Next i
  endTime1 = timeGetTime

  startTime2 = timeGetTime
  For i = 1 To numberOfLoops
    If (origNum = "006260006" Or origNum = "30062600006") And _
      creditOrDebit = "D" Then
      ' do something here
      Debug.Print "OK"
    End If
  Next i
  endTime2 = timeGetTime

  msg = "number of iterations: " & numberOfLoops & vbNewLine
  msg = msg & "JP proc: " & Format$((endTime1 - startTime1), "#,###") & _
       " ms" & vbNewLine
  msg = msg & "assylias proc: " & Format$((endTime2 - startTime2), "#,###") & _
       " ms"

  MsgBox msg

End Sub 
```

我的计算机一定很慢，因为与[assylias](https://stackoverflow.com/a/11125916/190829)的测试相比，1,000,000 次迭代所花费的时间远不及 ~200 毫秒。我不得不将迭代次数限制在 10,000 次——嘿，我还有其他事情要做 :)

运行上述程序 10 次后，我的程序只快了 20% 的时间。然而，当它变慢时，它只是表面上变慢。然而，正如[assylias](https://stackoverflow.com/a/11125916/190829)指出的那样，`creditOrDebit`我`<>"D"`的过程至少快两倍。我能够在 1 亿次迭代中合理地测试它。

这*就是*我重构它的原因——将逻辑短路，这样`origNum`就不需要在`creditOrDebit <> "D"`.

此时，其余的取决于 OP 的电子表格。如果`creditOrDebit`可能等于 D，则使用[assylias](https://stackoverflow.com/a/11125916/190829)程序，因为它通常会运行得更快。但是，如果`creditOrDebit`具有广泛的可能值，并且`D`不再可能是目标值，我的程序将利用它来防止不必要地评估其他变量。

# java - Asynctask 异常 - android

> ID：11123195
> 
> 赞同：0
> 
> 时间：2012-06-20T15:43:06.097
> 
> 标签：java, android, android-layout, android-widget, android-sdcard

我使用以下代码将目录和一些文件复制到 sdcard。我复制的目录放在 assets 文件夹中。

```
public class CopyAssets  extends Activity{
Button btn;
File sdCard = Environment.getExternalStorageDirectory();
private CameraBaseActivity mCamBase;
protected static String copyStatus;
CopyAssets(String path){
    //copyFileOrDir(path);
    copyStatus = "loading";
    mCamBase = CameraBaseActivity.getInstance();
    if(isSdPresent())
    new MoveDir().execute(path);
}

private class MoveDir extends AsyncTask<String, Void, String> {

    @Override
    protected String doInBackground(String... params) {
        copyStatus = "loaded";
        copyFileOrDir("edu.cmu.pocketsphinx");
        return (copyStatus);
    }

    @Override
    protected void onPostExecute(String result) {
        //TextView txt = (TextView) findViewById(R.id.output);
        //txt.setText("Executed"); // txt.setText(result);
        // might want to change "executed" for the returned string passed
        // into onPostExecute() but that is upto you
        mCamBase.initARParams();
    }

    @Override
    protected void onPreExecute() {
    }

    @Override
    protected void onProgressUpdate(Void... values) {
    }
}

private void copyFileOrDir(String path) {
    AssetManager assetManager = this.getAssets();
    String assets[] = null;
    try {
        assets = assetManager.list(path);
        if (assets.length == 0) {
            copyFile(path);
        } else {
            File dir = new File(sdCard.getAbsolutePath() + "/" + path);
            if (!dir.exists()) {
                System.out.println("Created directory"
                        + sdCard.getAbsolutePath());
                boolean result = dir.mkdir();
                System.out.println("Result of directory creation" + result);
            }

            for (int i = 0; i < assets.length; ++i) {
                copyFileOrDir(path + "/" + assets[i]);
            }
        }
    } catch (IOException ex) {
        System.out.println("Exception in copyFileOrDir" + ex);
    }
}

private void copyFile(String filename) {
    AssetManager assetManager = this.getAssets();

    InputStream in = null;
    OutputStream out = null;
    try {
        in = assetManager.open(filename);
        // String newFileName = "/data/data/" + this.getPackageName() + "/"
        // + filename;//path for storing internally to data/data
        String newFileName = sdCard.getAbsolutePath() + "/" + filename;
        out = new FileOutputStream(newFileName);
        byte[] buffer = new byte[1024];
        int read;
        while ((read = in.read(buffer)) != -1) {
            out.write(buffer, 0, read);
        }
        in.close();
        in = null;
        out.flush();
        out.close();
        out = null;
        System.out.println("File created in path" + newFileName);
    } catch (Exception e) {
        System.out.println("Exception in copyFile" + e);
        // System.out.println("Exception in copyFile"+e.print);
        // Log.e("tag", e.printStackTrace());
    }

}
public static boolean isSdPresent() {
    return android.os.Environment.getExternalStorageState().equals(android.os.Environment.MEDIA_MOUNTED);
}
} 
```

例外是在doinbackground：

```
01-01 00:00:41.679: WARN/dalvikvm(1530): threadid=11: thread exiting with uncaught exception (group=0x40b3d1f8)
01-01 00:00:41.687: ERROR/CameraBaseActivity(1530): uncaughtException.
01-01 00:00:41.695: ERROR/CameraBaseActivity(1530):     at android.os.AsyncTask$3.done(AsyncTask.java:278)
01-01 00:00:41.695: ERROR/CameraBaseActivity(1530):     at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:273)
01-01 00:00:41.695: ERROR/CameraBaseActivity(1530):     at java.util.concurrent.FutureTask.setException(FutureTask.java:124)
01-01 00:00:41.703: ERROR/CameraBaseActivity(1530):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:307)
01-01 00:00:41.703: INFO/ActivityManager(292): Start proc com.test.android.imageplugin for service com.test.android.imageplugin/.ImagePluginServer: pid=1549 uid=6062 gids={1015, 1023}
01-01 00:00:41.710: ERROR/LL_Core(1530): [LifeLogSecurityUtility]lifelogdb permission error
01-01 00:00:41.710: ERROR/CameraBaseActivity(1530):     at java.util.concurrent.FutureTask.run(FutureTask.java:137)
01-01 00:00:41.710: ERROR/CameraBaseActivity(1530):     at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:208)
01-01 00:00:41.710: ERROR/CameraBaseActivity(1530):     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
01-01 00:00:41.710: ERROR/CameraBaseActivity(1530):     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
01-01 00:00:41.710: ERROR/CameraBaseActivity(1530):     at java.lang.Thread.run(Thread.java:856)
01-01 00:00:41.710: ERROR/CameraBaseActivity(1530): java.lang.RuntimeException: An error occured while executing doInBackground()
01-01 00:00:41.710: ERROR/CameraBaseActivity(1530): uncaughtException.
01-01 00:00:41.710: ERROR/CameraBaseActivity(1530): uncaughtException : other thread.
01-01 00:00:41.710: ERROR/CameraBaseActivity(1530): LLDB regist error. unregisted.
01-01 00:00:41.710: DEBUG/Camera(1530): Capture get() mIsExecuteRegistMenu=false
01-01 00:00:41.710: DEBUG/Camera(1530): onResumeImpl start
01-01 00:00:41.710: DEBUG/Camera(1530): execDisplayLayoutChangeNonSync start rotation:0
01-01 00:00:41.726: DEBUG/Camera(1530): onResumeImpl end
01-01 00:00:41.726: INFO/CameraBaseActivity(1530): onResume end
01-01 00:00:41.726: INFO/CameraBaseActivity(1530): onPostResume
01-01 00:00:41.890: INFO/CameraBaseActivity(1530): Camera.finish 
```

我找不到它在 doinbackground 中意外崩溃的原因，因为我在这里发布的代码看不到任何错误。非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T15:45:49.180

LifeLogSecurityUtility 是什么？

这条线是可能的：

```
[LifeLogSecurityUtility]lifelogdb permission error 
```

告诉您清单中缺少权限标记。虽然我不熟悉这个 LifeLogSecurityUtility 所以我不知道那个东西希望你拥有哪个权限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T15:47:09.970

如果您还没有这样做，请在您的 AndroidManifest.xml 中添加 WRITE_EXTERNAL_STORAGE 权限

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

# php - Cookie 仅适用于带有 www 的网站。字首

> ID：11123196
> 
> 赞同：0
> 
> 时间：2012-06-20T15:43:21.810
> 
> 标签：php, apache, cookies

所以我正在创建一个用户必须登录的网站。如果用户希望网站记住他的登录信息，我会设置一个 cookie 来记住这些数据。但是，cookie 似乎是为网站 www.mysite.com 设置的。这似乎意味着如果我使用地址 mysite.com（没有 www.）访问我的网站，则无法再访问 cookie。如何使两个站点都可以访问任一站点上设置的 cookie？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T15:48:09.243

布赖恩斯科特已经正确回答了这个问题，但我想我会添加这个：

在我看来，如果您允许用户“记住”他们的登录，那么您将希望对如何/在哪里/为什么/何时保持特定的控制，这包括保持安全连接。

对于涉及任何类型登录的项目，我始终确保我拥有适当的 SSL 证书和安全连接，然后我检查他们用于访问站点的 URL 并重定向以确保它们留在我的安全域中。例如，我检查 www。和 https 前缀，并始终重定向到[https://www.domain.com](https://www.domain.com) ......只是我的两分钱。

**编辑：**回应评论。真的很粗糙，但是像这样：

```
if (($_SERVER['SERVER_PORT'] != '443') || ($_SERVER['HTTPS'] != 'on') || (!strstr ($_SERVER['HTTP_HOST'], 'www'))) {
  header ("Location: https://www.mydomain.com");
  exit();
} 
```

**第二次编辑：**我粗略输入的代码中有两个错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T15:46:27.660

**为.mysite.com**而不是**www.mysite.com**设置您的 cookie 。这样，cookie 将识别公共域后缀并与两个 url 兼容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T16:23:35.073

您不想同时使用两者。选择一个，它对 SEO 也更好。我个人只是通过 htaccess 重定向到 www 并保持它的标准。

```
RewriteEngine On
RewriteCond %{HTTP_HOST} !^www\.
RewriteRule ^(.*)$ http://www.%{HTTP_HOST}/$1 [R=301,L] 
```

# jquery - 条件渲染可能吗？

> ID：11123201
> 
> 赞同：0
> 
> 时间：2012-06-20T15:43:47.563
> 
> 标签：jquery, handlebars.js, mustache

是否可以使用 Mustache 进行条件渲染？示例：如果我想根据 X 的状态显示不同的值？例如。

```
if x.value=1
                        <td>                                            
                            <span class="label label-success">{{this.X1}}</span></td>                       
else x.value=2                                                              
                        <td>                                            
                            <span class="label label-warning"{{this.X2}}</span></td>
else if x.value=3                         
                        <td>                                            
                            <span class="label label-inverse"{{this.X3}}</span> </td> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T15:48:21.023

我相信你唯一能做的就是检查布尔属性，例如

```
{{#IsLate}}
    <span class="late">You owe me money, sucka.</span>
{{/IsLate}}
{{^IsLate}}
    <span class="on-time">No money due at this time.</span>
{{/IsLate}} 
```

您可能想研究构建一个适合您需要的新包装器对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T16:55:36.173

在深入研究文档后，我发现可以使用 Helpers 来实现：

```
Handlebars.registerHelper('HelperName', function (status) {
            var statusClass = {
                '1': 'label-inverse',
                '2': 'label-important',
                '3': 'label-warning',
                '4': 'label-success'
            };
            return statusClass[status];
        }); 
```

并在模板中使用它，例如：

```
<td>                                            
<span class="label {{HelperName this.myStatus}}">TEXT</span>                                
</td> 
```

# java - 同一个数据包中的两个表单提交

> ID：11123202
> 
> 赞同：1
> 
> 时间：2012-06-20T15:43:52.913
> 
> 标签：java, http-unit

我的测试中有以下代码：

```
WebResponse response = webConversation.getResponse(loginUrl);
System.err.println("Session ID:" + webConversation.getCookieValue("JSESSIONID"));
WebForm form = response.getFormWithID(loginFormId);
for(String parmName: form.getParameterNames()){
  if(loginDayName.equals(parmName)){
    form.setParameter(parmName, day);
  }
  else if(loginMonthName.equals(parmName)){
    form.setParameter(parmName, month);
  }
  else if(loginYearName.equals(parmName)){
    form.setParameter(parmName, year);
  }
  else if(loginPersonIdName.equals(parmName)){
    form.setParameter(parmName, person.getPersonId());
  }
}

response = form.submit();
System.err.println(response.getText()); 
```

所以第一次调用登录 URL 应该返回表单。然后我更改参数并将表单提交回它来自的同一个 servlet。

控制器中的调试表明我使用两个会话 ID 两次获取表单数据。第二个是与我的 webConversation 匹配的会话 ID，并且总是失败，因为第一个实际上是那个人登录的。

这是我目前测试中唯一的 form.submit() 。

我很迷惑。我用错了工具吗？或者这是一个错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T11:31:29.790

我最终切换到 html 单元，因为这样的问题对于这个旧项目来说似乎很正常。

# android - NullPointer 异常 ContextWrapper

> ID：11123204
> 
> 赞同：2
> 
> 时间：2012-06-20T15:44:07.757
> 
> 标签：android, achartengine

我正在尝试使用 AChartEngine 库绘制饼图。我对此没有任何问题，因为我已经在另一个 Activity 上绘制了图表。现在我需要绘制另一个图表，但我在 ContextWrapper 上得到了 Nullpointer 异常。这就是 Logcat 所说的：

```
06-20 17:09:46.391: W/System.err(14261): java.lang.NullPointerException
06-20 17:09:46.391: W/System.err(14261): at android.content.ContextWrapper.getResources(ContextWrapper.java:80) 
```

这是导致错误的代码行：

```
PieGraph pie = new PieGraph();
View timesheetsPage = pie.getView(MainActivity.this , values, colors, jobDescriptions, totalTimes); 
```

如您所见，我将`MainActivity.this`其用作上下文，即使我使用 getApplicationContext() 也会得到相同的错误。我肯定知道的所有其他参数都不为空。

这段代码在另一个 Activity 的图表上完美运行，所以我怀疑它是 AChartEngine 库问题。

任何帮助将不胜感激。

# c++ - ANTLR 生成的 Cpp 文件在 Lua 注释上抛出错误

> ID：11123206
> 
> 赞同：0
> 
> 时间：2012-06-20T15:44:16.047
> 
> 标签：c++, antlr

```
In member function ‘bool LuaLexerCyclicDFA6::msynpred(PredType)’:
     error: ‘LuaLexerCyclicDFA6::CtxType’ has no member named ‘msynpred’ 
```

使用 -language Cpp 构建，这是引发错误的部分：

```
BLOCK_COMMENT
    :   '--[[' ( options {greedy=false;} : . )* '--]]' 
    ;

LINE_COMMENT 
    : '--' ~('\n'|'\r')* '\r' ? '\n'
    ; 
```

想知道是否有人知道这个错误是如何引起的。

使用 g++ 4.6 编译

# c# - CRM 创建一个新的 CrmConnection 实例

> ID：11123211
> 
> 赞同：1
> 
> 时间：2012-06-20T15:44:36.013
> 
> 标签：c#, .net, wcf, dynamics-crm-2011

我是 Dynamic CRM 2011 的新人，所以也许这个问题真的很简单。我正在使用这部分代码
将 WCF 服务连接到**不同的 CRM 实例：**

```
 var settings = new ConnectionStringSettings("Xrm", connectionString);

 var connection = new CrmConnection(settings);

 using (var xrm = new XrmServiceContext(connection))
 {
    //do the magic here
 } 
```

“connectionString”参数，是一个包含CRM的连接字符串的字符串。

所以，问题是它第一次很好地连接到我在 connectionString 中编写的服务器，但是，它总是连接到同一个服务器，我的意思是，即使我更改服务器地址，总是尝试连接到第一。

调试，我在看

```
var connection = new CrmConnection(settings); 
```

并且始终与第一台服务器连接相同....

所以，我需要一种方法来处理该连接，或强制构造函数始终创建一个新实例......或类似的东西......但我找不到这样做的方法或操作......

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T16:04:13.133

好的，我找到了一个解决方案，我不知道是否是最好的解决方案，但它有效......
而不是使用这个

```
var settings = new ConnectionStringSettings("Xrm", connectionString);
var connection = new CrmConnection(settings); 
```

我用

```
var connection = CrmConnection.Parse(connectionString); 
```

这给了我相同的结果，并且总是使用正确的连接字符串

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T20:40:30.707

这里的根本问题是为每个`ConnectionStringSettings`. 您可以通过为每个实例指定一个唯一名称来避免这种情况（例如：Xrm1、Xrm2 等）。我不确定因此行为是否明确记录在 SDK 中，但我确实遇到过它并按照我的指示进行了修复。

# c++ - 小数点后两位四舍五入

> ID：11123213
> 
> 赞同：2
> 
> 时间：2012-06-20T15:44:47.543
> 
> 标签：c++, rounding

```
double x = 9.29;
double y = 8.69;

double diff = floor((x - y)*100+0.5)/100.0; 
```

这给了我 0.6 的差异，但我需要它作为 0.60（两位小数） 有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-20T15:52:18.157

双精度值是 0.6，因为 0.6 和 0.60（在数学上）是相同的。您需要的是在*打印*值时设置精度，而不是在计算时设置精度。

这可以使用

```
cout << setprecision (2) << diff << endl; 
```

或者

```
printf("%.2f\n", diff); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T16:18:34.253

如果你使用 C++，你应该这样做：

```
cout.precision(2);
cout << fixed << diff << "\n"; 
```

如果您正在使用 C，请尝试以下操作：

```
printf("%.2e\n", diff); 
```

该`precision`函数确定要在插入操作中写入以表示浮点值的最大位数。所以，如果你执行这段代码，你会得到

```
0.60 
```

如果你将 presision 设置为 3 你会得到

```
0.600 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-01T09:56:34.240

我尝试了这些解决方案，但对我来说效果并不理想。我有这样的事情。

```
 cout << "balance owing: " << balOwed[i] << endl; 
```

注意：balOwed[i] 是一个“双”类型的“数组”。它在一个 for 循环下。无论如何，这会给出类似“欠款：1234.00”的输出。但是，它只给出“余额欠款：1234”之类的输出。

我尝试使用：

```
 cout.presicion(2);
  cout << "balance owing: " << balOwed[i] << endl; 
```

它没有用。所以最终对我有用的是以下代码：

```
 cout.setf(ios::fixed);
  cout.precision(2);
  cout << "balance owing: " << balOwed[i] << endl; 
```

只是为了让你们知道，我还尝试了 setprecision(2) 并且必须包含一个新库。但这也没有用。希望能帮助到你！

# php - PHP Foreach 问题

> ID：11123219
> 
> 赞同：1
> 
> 时间：2012-06-20T15:45:06.390
> 
> 标签：php, arrays, foreach

`$papers`所以我有一个来自数据库的数组。更改数据库的人可以随意更改数组的大小。

我想如果我做了类似的事情：

```
foreach($papers as $paper) {
    echo '<option value="' . $paper . '">' . $paper . '</option>';
} 
```

我可以在我的表单中获得一个动态列表。但是，由于某种原因，当我尝试此操作时，网页只是空白。显然我可以做类似的事情：

```
for($i = 0; $i < SOME_NUMBER; $i++) {
    echo '<option value="' . $papers[$i] . '">' . $papers[$i] . '</option>';
} 
```

但是由于数组的大小是可变的，这似乎不是一个可行的选择。此外，当我使用简单 for 循环的第二种方法时，页面会加载，并且值确实会出现。我很困惑为什么会这样。任何帮助都会很棒，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T15:50:48.430

你可以`foreach`像这样修改你的循环

```
foreach($papers as $key => $value) {
    echo '<option value="' . $key . '">' . $value . '</option>';
} 
```

在哪里`$key`保存索引并`$value`保存数组的实际值

我不确定你在你的`$papper`数组中得到了什么数据，但我猜你也可以这样做

```
foreach($papers as $paper) {
    echo '<option value="' . $paper['your_db_field_name'] . '">' . $paper['your_db_field_name'] . '</option>';
} 
```

很简单`for loop`，你可以`sizeof()`像下面这样使用

```
for($i = 1 ; $i <= sizeof($pappers) ; $i++){
//your logic
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T15:50:23.903

如果你想使用数组引用方法，试试这个：

```
for($i = 0; $i < count($papers); $i++) {
    echo '<option value="' . $papers[$i] . '">' . $papers[$i] . '</option>';
} 
```

count() 函数将返回数组的长度，正如您所说，每次运行它时可能会有所不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T15:52:42.117

打开错误报告

```
error_reporting(E_ALL | E_STRICT);
init_set('display_errors', 'on'); 
```

并尝试调试：

```
print_r($papers); 
```

并查看数组 $papers 的结构

# cxf - 通过 TLS 的 Apache CXF

> ID：11123221
> 
> 赞同：0
> 
> 时间：2012-06-20T15:45:18.343
> 
> 标签：cxf

2012 年 6 月 21 日更新 一点更新。今天我终于发现了阻止我连接到服务器的异常。这是我打电话后得到的`getInputStream()`：

```
javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target 
```

==================================================== =========

**原始信息：**

我试图让我的客户端（客户端不是完全由我编写的）通过 TLS 使用已发布的 Web 服务（客户端通过 http 工作）。我是这个领域的新手，以前从未与 Web 服务密切合作过。我已经使用soapUI 检查了Web 服务是否已正确发布和访问。地址是**https://:9080/SOAOICCT/services/SessionService?wsdl**。我可以发送请求并收到回复。但是我的客户抛出了很多异常。以下是最重要的：

```
javax.xml.ws.WebServiceException: org.apache.cxf.service.factory.ServiceConstructionException: Failed to create service.
    at <My class.my method>(SessionServiceDAO.java:548)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
......
Caused by: javax.xml.ws.WebServiceException: org.apache.cxf.service.factory.ServiceConstructionException: Failed to create service.
    at org.apache.cxf.jaxws.ServiceImpl.<init>(ServiceImpl.java:150)
    at org.apache.cxf.jaxws.spi.ProviderImpl.createServiceDelegate(ProviderImpl.java:65)
    at javax.xml.ws.Service.<init>(Service.java:56)
.........
Caused by: javax.wsdl.WSDLException: WSDLException: faultCode=PARSER_ERROR: java.lang.IllegalArgumentException: InputSource must have a ByteStream or CharacterStream
    at org.apache.cxf.wsdl11.WSDLManagerImpl.loadDefinition(WSDLManagerImpl.java:226)
    at org.apache.cxf.wsdl11.WSDLManagerImpl.getDefinition(WSDLManagerImpl.java:179)
    at org.apache.cxf.wsdl11.WSDLServiceFactory.<init>(WSDLServiceFactory.java:91)
    ... 70 more
Caused by: java.lang.IllegalArgumentException: InputSource must have a ByteStream or CharacterStream
    at org.apache.cxf.staxutils.StaxUtils.createXMLStreamReader(StaxUtils.java:983)
    at org.apache.cxf.wsdl11.WSDLManagerImpl.loadDefinition(WSDLManagerImpl.java:217)
    ... 72 more 
```

我已将此问题跟踪到方法`java.net.HttpURLConnection.getResponseCode()`。这里是：

```
public int getResponseCode() throws IOException {
    /*
     * We're got the response code already
     */
    if (responseCode != -1) {
        return responseCode;
    }

    /*
     * Ensure that we have connected to the server. Record
     * exception as we need to re-throw it if there isn't
     * a status line.
     */
    Exception exc = null;
    try {
            getInputStream();
    } catch (Exception e) {
        exc = e;
    } 
```

我得到一个异常`getInputStream()`并且从未真正连接到服务器。这个例外后来在`org.apache.cxf.transport.TransportURIResolver.resolve(String, String)`这里被吞没了

```
} catch (Exception e) {
                //ignore
            } 
```

这个问题似乎很简单，比如身份验证或参数。是否有任何明显的原因导致我无法连接到 Web 服务？我是一个新手，我什至可以犯一个非常简单的错误。

这是我的`http:conduit`：

```
<http:conduit name="*.http-conduit">
      <http:tlsClientParameters secureSocketProtocol="TLS">
            <sec:trustManagers>
                <sec:keyStore type="JKS" password="123123" file="config.soa.client/trustedCA.keystore"/>
            </sec:trustManagers>

            <sec:cipherSuitesFilter>
                <sec:include>SSL_RSA_WITH_RC4_128_MD5</sec:include>
                <sec:include>SSL_RSA_WITH_RC4 _128_SHA</sec:include>
                <sec:include>SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA</sec:include>
                <sec:include>.*_EXPORT_.*</sec:include>
                <sec:include>.*_EXPORT1024_.*</sec:include>
                <sec:include>.*_WITH_DES_.*</sec:include>
                <sec:include>.*_WITH_NULL_.*</sec:include>
                <sec:exclude>.*_DH_anon_.*</sec:exclude>
            </sec:cipherSuitesFilter>
        </http:tlsClientParameters>
    </http:conduit> 
```

一点更新。今天我终于发现了阻止我连接到服务器的异常。这是我打电话后得到的`getInputStream()`：

```
javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target 
```

# c# - VS2010 - 在监视窗口变量以十六进制显示，但未选中“十六进制显示”选项

> ID：11123228
> 
> 赞同：0
> 
> 时间：2012-06-20T15:45:48.310
> 
> 标签：c#, visual-studio-2010, watch

我的 Visual Studio 2010 中的“监视”窗口存在问题。值显示为十六进制，但选项“十六进制显示”。更重要的是，当我打破同一个变量并且我想获取它的属性的值（例如`e`是一个异常，我想看看里面有什么`e.Message`）我得到错误“xxx不存在”。但是当我使用 C++ 语法时，这些字段是可访问的（见下图）。我的解决方案/项目使用 C#。我想我在调试器设置中改变了一些东西，但我不知道它是什么。

![下图](../Images/28140ab64fc80e5342616e6834e28583.png)

**更新**

我还有一个问题。当我在断点处停止并想查看任何局部变量时，我会收到消息`error: identifier 'xxxx' out of scope`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:34:08.413

这只是一个猜测，但我认为无论如何所有指针（引用）都显示为十六进制。试着看一个 int 看看会发生什么。`e`是对 Exception 对象的引用。

# android - 如何强制重绘列表视图？

> ID：11123231
> 
> 赞同：8
> 
> 时间：2012-06-20T15:45:57.110
> 
> 标签：android, android-widget, android-listview, android-adapter

这个问题与其他类似标题的问题略有不同。我不是要更新列表中的数据，而是要更新列表的*外观*。

我的应用程序是基于片段的，使用支持库。我有一个 PreferenceActivity，我允许用户在列表中设置他们想要的文本颜色（适配器读取首选项并设置颜色）。这在大多数情况下都按预期工作。

我遇到的问题如下。当我在屏幕上有列表（它是 ListFragment）并拉出菜单时，选择 Preferences 并更改颜色首选项。从 PreferenceActivity 返回列表后，我似乎无法让列表使用指定的新颜色重新绘制自身。

如果我离开列表并返回它，它会用新颜色重新生成。

我正在尝试使用`onResume`来进行更改。我目前拥有的代码（似乎对列表没有任何作用，但会更改标题颜色）：

```
@Override
public void onResume() {
    super.onResume();
    header.setTextColor(MyApplication.header);
    line.setBackgroundColor(MyApplication.header_line);
    subheader.setTextColor(MyApplication.header);
    getListView().invalidateViews();
} 
```

我试过`invalidateViews`和`invalidate`. 绝望中我尝试调用`notifyDataSetChanged`适配器，即使数据本身没有变化。似乎没有任何效果。

我错过了一些明显的东西，还是没有办法做到这一点？

**编辑**

我的适配器中的“getView”方法：

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
    if (convertView == null)
        convertView = View.inflate(context, layout, null);
    View row = convertView;
    c.moveToPosition(position);
    TextView first = (TextView) convertView.findViewById(R.id.ListItem1);
    TextView second = (TextView) convertView.findViewById(R.id.ListItem2);
    TextView third = (TextView) convertView.findViewById(R.id.ListItem3);
    TextView fourth = (TextView) convertView.findViewById(R.id.ListItem4);

    DecimalFormat df = new DecimalFormat("0.00");
    Double hold = Double.valueOf(c.getString(3));
    Double qty = Double.valueOf(c.getString(1));
    Double total = hold * qty;

    String color = "#FF00FF";
    first.setText(c.getString(2));
    first.setTextColor(MyApplication.shoplistitem_name);
    second.setText(c.getString(4));
    second.setTextColor(MyApplication.shoplistitem_desc);
    third.setText(c.getString(1));
    third.setTextColor(MyApplication.shoplistitem_qty);
    fourth.setText("$" + df.format(total));
    fourth.setTextColor(MyApplication.shoplistitem_desc);

    if (strikethroughState[position] == 1) {
        first.setPaintFlags(first.getPaintFlags()
                | Paint.STRIKE_THRU_TEXT_FLAG);
        second.setPaintFlags(second.getPaintFlags()
                | Paint.STRIKE_THRU_TEXT_FLAG);
        third.setPaintFlags(third.getPaintFlags()
                | Paint.STRIKE_THRU_TEXT_FLAG);
        fourth.setPaintFlags(third.getPaintFlags()
                | Paint.STRIKE_THRU_TEXT_FLAG);
        row.setBackgroundColor(MyApplication.shoplistitem_checked);
    } else {
        first.setPaintFlags(first.getPaintFlags()
                & ~Paint.STRIKE_THRU_TEXT_FLAG);
        second.setPaintFlags(second.getPaintFlags()
                & ~Paint.STRIKE_THRU_TEXT_FLAG);
        third.setPaintFlags(third.getPaintFlags()
                & ~Paint.STRIKE_THRU_TEXT_FLAG);
        fourth.setPaintFlags(third.getPaintFlags()
                & ~Paint.STRIKE_THRU_TEXT_FLAG);
        row.setBackgroundResource(R.color.black);
    }
    return (row);
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-20T18:10:52.880

`notifyDataSetChanged()`当然应该为你工作。您如何处理偏好更改？如果您只是将首选项提交给 SharedPreferences 那么它永远不会更新静态 MyApplication 变量。您可以发布用于设置首选项的代码吗？如果您不使用它，`onPreferenceChangedListener()`请为颜色首选项设置一个以在更改时设置该静态变量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-20T16:12:50.210

您应该在适配器上调用[notifyDataSetChanged() 。](http://developer.android.com/reference/android/widget/BaseAdapter.html#notifyDataSetChanged%28%29)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-22T01:03:26.050

无效，无效视图，notifyDatasetChanged，对我没有用！要更新列表视图（使用 cursoradapter），我只需：

```
cur = db.rawQuery( "SELECT * FROM ssnt WHERE mid = 1000" ); //optional, initial query
adapter.changeCursor(cur); // or swapCursor(), cur is the initial and the only cursor 
```

但要获得正确的背景颜色、可绘制、下划线文本，我只需：

```
cur = db.rawQuery( "SELECT * FROM ssnt WHERE mid = 1000" );
adapter.changeCursor(cur);
list.setAdapter(adapter);    //just like I did oncreate 
```

我不喜欢 Barak 解决方案，因为它看起来很重，并且在不需要时执行代码。

# android - 为什么 Android 上的 MediaPlayer 不能通过 RTSP 播放，而 Vitamio 可以？

> ID：11123234
> 
> 赞同：1
> 
> 时间：2012-06-20T15:46:10.460
> 
> 标签：android, rtsp, android-mediaplayer

当我打开 RTSP 流时，MediaPlayer 将抛出错误 1，-1005 - ERROR_CONNECTION_LOST（通过[http://android.joao.jp/2011/07/mediaplayer-errors.html ）：](http://android.joao.jp/2011/07/mediaplayer-errors.html)

```
E/MediaPlayer(27899): Error (1,-1005)
D/VideoView(27899): Error: 1,-1005 
```

但是 Vitamio 这个流会播放，但会出现错误：

```
E/Vitamio(27899): Couldn't open file on client side, trying server side rtsp://host:80/path_to_file.mp4 (unfortunately can't give video link) 
```

Vitamio 会给我一些有趣的调试信息：

```
D/Vitamio[Player](27899): [rtsp @ 0x347630] UDP timeout, retrying with TCP
D/Vitamio[Player](27899): [rtsp @ 0x347630] Estimating duration from bitrate, this may be inaccurate 
```

最后它会播放视频。哪一边有错误？如何解决这样的问题？

# javascript - 如何停止计时器功能的运行？

> ID：11123237
> 
> 赞同：6
> 
> 时间：2012-06-20T15:46:15.770
> 
> 标签：javascript, jquery, clearinterval

我对 js 有点陌生，并且一直试图弄清楚当我点击一个按钮时如何阻止这个函数运行。我尝试使用 clearInterval，但我不确定我做得是否正确。有人可以看看这段代码并指出我正确的方向吗？

代码：

```
<div><h1 id="target"></h1></div>
<button id="stop">Stop</button>​ 
```

脚本：

```
var arr = [ "one", "two", "three"];

(function timer(counter) {
     var text = arr[counter];

    $('#target').fadeOut(500, function(){ 
        $("#target").empty().append(text).fadeIn(500);
    });

    delete arr[counter];
    arr.push(text);

    setTimeout(function() {
        timer(counter + 1);
    }, 3000);

    $("#stop").click(function () {
       clearInterval(timer);
    });

})(0);

setInterval(timer); 
```

JS 小提琴：http: [//jsfiddle.net/58Jv5/13/](http://jsfiddle.net/58Jv5/13/)

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-20T15:48:42.430

您需要为 JavaScript 提供对区间的引用：

```
var t = setTimeout(function() {
    timer(counter + 1);
}, 3000); 
```

然后你可以像这样清除它：

```
$("#stop").click(function () {
   clearTimeout(t);
}); 
```

# c# - .gitignore 和 Visual Studio 项目：忽略 bin/Debug 目录但不忽略 bin/Release 目录

> ID：11123248
> 
> 赞同：68
> 
> 时间：2012-06-20T15:46:55.117
> 
> 标签：c#, .net, visual-studio, git, gitignore

我在 git 存储库中有一个 C# Visual Studio 项目。我想忽略内容`bin/Debug`目录，但不忽略`bin/Release`' 目录的内容。我已添加`bin/Debug`到我的`.gitignore`文件中，但它似乎不起作用 - 它包括`bin`目录的全部内容。正确的条目是什么？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2013-03-11T18:18:55.147

你不应该删除任何东西。添加 .gitignore 文件后，运行此命令以清除缓存，然后再次暂存并提交：

```
git rm -r . --cached 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2012-06-20T16:07:29.853

这通常是因为 .gitignore 是在文件提交后添加的。.gitignore 告诉 git 忽略匹配的未跟踪文件，一旦提交内容，忽略将不再起作用。修复它的一种方法是删除 bin/debug 文件夹（手动通过 explorer/powershell/bash），然后提交删除。一旦完成，忽略应该按您的预期工作。

1.  删除文件/文件夹
2.  `git add -A`
3.  `git commit`

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2012-06-20T15:56:37.047

这是我们最近一直在使用的，它删除了所有重新生成的东西和其他一些重要的东西。请注意，我们不会提交我们的发布目录，因此您不应包含`Release/`在您`.gitignore`的`Debug/`.

```
/build/
*.suo
*.user
_ReSharper.*/
*.sdf
bin/
obj/
Debug/
Release/
*.opensdf
*.tlog
*.log
TestResult.xml
*.VisualState.xml
Version.cs
Version.h
Version.cpp 
```

**更新**

这是来自 github 的一个非常全面的示例：

*   [https://github.com/github/gitignore](https://github.com/github/gitignore)
*   [https://github.com/github/gitignore/blob/master/VisualStudio.gitignore](https://github.com/github/gitignore/blob/master/VisualStudio.gitignore)

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2016-12-06T08:50:49.180

运行以下命令对我有用（感谢“orourkedd”）：

```
git rm -r . --cached 
```

我手动添加了`.gitignore`文件，但在我运行此命令之前没有考虑到它。

然后我不得不再次承诺，现在一切顺利。`/bin`并且`/obj`文件夹现在已正确排除。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2016-02-03T11:16:13.950

我知道这是一个老问题，但我决定分享我的方法，它完全排除了 bin/Debug、bin/Release 等。

```
*/**/bin/Debug
*/**/bin/Release
*/**/obj/Debug
*/**/obj/Release 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-06-20T16:35:33.987

我通过替换`bin/Debug`为`Debug`.

这也会产生忽略`obj/Debug`目录的影响，但是我想忽略目录的全部内容`obj`，所以我也添加`obj`了`.gitignore`.

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-09-17T05:21:58.620

这对我有用：

```
*.exe
*.pdb
*.manifest
*.cache 
```

如果你像我一样使用 GitHub Desktop，你可以右键单击要排除的文件或右键单击它并按扩展名排除：

[![在此处输入图像描述](../Images/f681d3817a495874a17b3e60f7242220.png)](https://i.stack.imgur.com/2wbYg.png)

这将`.gitignore`使用上面的代码自动为您生成一个文件。您可以在此处下载 GitHub Desktop：[适用于 Windows 64 位的 GitHub Desktop](https://desktop.github.com/)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-03-22T17:16:01.950

右键单击要从“Git Desktop”中忽略的文件名，然后将它们添加到`.gitignore`文件中。这里会自动创建 gitignore 文件。将该文件签入 git。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-12-03T01:52:07.917

这可能有点跑题了，但是每当开始创建一个新项目时，我通常使用[GitIgnore.IO](https://www.gitignore.io/)来创建我的初始 gitignore 文件，然后根据我的需要从那里调整它。

# facebook - 在 R 编程中为 Facebook 提供任何 twitteR 类型的包？

> ID：11123259
> 
> 赞同：7
> 
> 时间：2012-06-20T15:47:20.803
> 
> 标签：facebook, r

R for Facebook 中是否有任何类似于 twitteR 的包？我想分析 Facebook 数据，就像 twitteR 包对 Twitter 所做的那样。

我的目标是分析 facebookers 如何谈论某个关键字。使用 twitteR 包对 Twitter 进行了类似的分析。例如：[推特收听机器人](http://www.cloudstat.org/index.php?do=/kafechew/blog/twitter-listening-apps/)。这个分析可以告诉我们谁在发推文、转发推文、谁是顶级用户、他们何时发推文、谁在推文谁、wordcloud 等等。

我想为 Facebook 复制相同的内容。我刚开始对此进行研究，发现缺乏使用 R 的公共 Facebook 分析。

我发现了一些关于这个主题的有用资源：

1.  [脸书挖矿](https://gist.github.com/1634662)
2.  [挖掘 Facebook 数据：最“喜欢”的状态和友谊网络](http://applyr.blogspot.com/2012/01/mining-facebook-data-most-liked-status.html?spref=tw)

6 月 23 日更新：

由于缺乏关于公共 facebook 图分析的信息，我想开始滚动，这里有一些源代码或信息可能有用。如果你有兴趣加入我。

*   [Facebook Graph: Scrapping Social Info with R](http://www.cloudstat.org/index.php?do=/kafechew/blog/facebook-graph-scrapping-social-info-with-r/)是 Facebook Graph (#API) 参数摘要。
*   [关键字 UMNO 3 的大多数 LIKES facebook 帖子](http://www.cloudstat.org/index.php?do=/kafechew/blog/most-likes-facebook-post-for-keyword-umno-3/)是带有 Facebook Graph 应用程序的示例 R 脚本。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-20T23:19:59.677

与 twitteR 所做的不完全相同。但是您可以查看 David Smith（Revolutions Analytics）的帖子。

1.  Facebook 状态更新分析[http://blog.revolutionanalytics.com/2010/12/analysis-of-facebook-status-updates.html](http://blog.revolutionanalytics.com/2010/12/analysis-of-facebook-status-updates.html)

2.  使用 R 和 Hadoop 进行 Facebook 级社交网络分析[http://blog.revolutionanalytics.com/2012/05/facebook-class-social-network-analysis-with-r-and-hadoop.html](http://blog.revolutionanalytics.com/2012/05/facebook-class-social-network-analysis-with-r-and-hadoop.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-23T01:16:10.007

这是关于此主题的[另一篇博文。](http://romainfrancois.blog.free.fr/index.php?post/2012/01/15/Crawling-facebook-with-R)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-29T21:57:24.020

现在，您可以使用 Rfacebook 包。您可以访问您帐户中的几乎所有内容（甚至可以更改您的 fb 状态）。

更多信息在这里： [http ://cran.r-project.org/web/packages/Rfacebook/](http://cran.r-project.org/web/packages/Rfacebook/) [https://github.com/pablobarbera/Rfacebook](https://github.com/pablobarbera/Rfacebook)

RFacebook 入门的分步教程在这里： [http ://thinktostart.wordpress.com/2013/11/19/analyzing-facebook-with-r/](http://thinktostart.wordpress.com/2013/11/19/analyzing-facebook-with-r/)

还有一些使用它的例子：http: [//blog.revolutionanalytics.com/2013/11/how-to-analyze-you-facebook-friends-network-with-r.html](http://blog.revolutionanalytics.com/2013/11/how-to-analyze-you-facebook-friends-network-with-r.html)

# sql - SQL 选择查询（员工和职位）

> ID：11123262
> 
> 赞同：2
> 
> 时间：2012-06-20T15:47:34.137
> 
> 标签：sql, sybase

我有 2 张桌子

1）表位置

```
pos_id, pos_description, pos_total(maximum # of employees for that position)

    1     c++ Developer     3
    2     Java Developer    2
    3     DBA               3 
```

2）表员工

```
emp_id, emp_pos_id 
1       1
2       1
3       2
4       3
5       3
6       3 
```

我想在 SQL Server 或 Sybase 中创建以下报告：

```
 Position Pos. Description     Serial No of Position  ID of Employee
    1     C++ Developer        1                      1
    1     C++ Developer        2                      2
    1     C++ Developer        3                      ------------------
    2     Java Developer       1                      3
    2     Java Developer       2                      ------------------
    3     DBA                  1                      4
    3     DBA                  2                      5
    3     DBA                  3                      6 
```

如何实现这样的查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:03:03.947

您想要的基本查询如下所示：

```
select p.pos_id, p.pos_description,
       row_number() over (partition by p.pos_id order by e.emp_id) as SerialNumber,
       e.emp_id
from positions p left outer join
     employees e 
     on p.pos_id = e.emp_pos_id
order by 1, 2, 3 
```

问题是这不会返回空头寸。可以想象，既然每个位置都可能是空的，那么在这种情况下需要什么？

```
select p.pos_id, p.pos_description,
       row_number() over (partition by p.pos_id order by p.pos_id) as SerialNumber,
       NULL as emp_id
from position p join
     (select row_number() over (partition by NULL order by pos_id) as seqnum
      from positions
     ) as numbers
     on numbers.seqnum <= p.pos_total 
```

在这里，我只是使用表格来创建数字列表。我将这些加入到可用的位置。

下一个查询使用连接将这两者结合起来：

```
with byemp as (
     select p.pos_id, p.pos_description,
            row_number() over (partition by p.pos_id order by e.emp_id) as SerialNumber,
            e.emp_id
     from positions p left outer join
          employees e 
          on p.pos_id = e.emp_pos_id
   ),
allpos as (
     select p.pos_id, p.pos_description,
            row_number() over (partition by p.pos_id order by p.pos_id) as SerialNumber,
            NULL as emp_id
     from position p join
           (select row_number() over (partition by NULL order by pos_id) as seqnum
            from positions
           ) as numbers
           on numbers.seqnum <= p.pos_total
   )
select allpos.pos_id, allpos.pos_description, allpos.SerialNumber,
       coalesce(byemp.emp_id, allpos.emp_id) as emp_id
from allpos join
     byemp
     on allpos.pos_id = byemp.pos_id and
        allpos.SerialNumber = byemp.SerialNumber 
```

基本上，它保留了 allpos 中的所有位置信息，但是当它可用时从 byemp 中引入 empid。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T16:24:55.387

在 SQL Server 中：

```
;WITH DummyTable AS (
    SELECT 1 AS Value
    UNION ALL
    SELECT Value + 1 
    FROM DummyTable 
    WHERE Value < 1000 --This value must be least as large as the largest "maximum # of employees for that position"
)
SELECT p.pos_id Position, p.pos_description [Pos. Description], n.Value [Serial No of Position], emp_id [ID of Employee]
FROM DummyTable n
    INNER JOIN Positions p
        ON n.Value <= p.pos_total
    LEFT JOIN (SELECT emp_id, emp_pos_id, ROW_NUMBER() OVER(PARTITION BY emp_pos_id ORDER BY emp_id) AS emp_position FROM Employees) e
        ON e.emp_pos_id = p.pos_id
        AND e.emp_position = n.Value
ORDER BY p.pos_id, n.Value
OPTION (MAXRECURSION 0); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T19:37:53.783

```
 with mycte
 as
 (
 select * from pos p inner join dbo.nums n on p.nums >= n.cnt
 ) ,
 em as (select empid,empposid,ROW_NUMBER() over(PARTITION by empposid order by empid) as  rn        from   emp)
 select mc.id as positionid,mc.descr,mc.cnt,isnull(convert(varchar(30),e.empid),'------------') 
 from mycte mc 
 left join em e on mc.id= e.empposid
 and e.rn = mc.cnt 
```

试试这个 nums 表只是一个包含 1 到 1 百万值的表

# java - 如何指示 JVM 保持内存占用尽可能低？

> ID：11123268
> 
> 赞同：9
> 
> 时间：2012-06-20T15:47:43.080
> 
> 标签：java, jvm

我有一个执行 5 个不同任务的 java 程序。当我使用 -Xmx512m 内存参数运行程序时，任务 1-4 运行良好，但任务 5 内存不足。当我使用 -Xmx1024m 运行程序时，所有 5 个任务都运行良好，但以前使用 512m 堆运行良好的任务 1-4 现在几乎用完了所有 1024m 堆。如果我使用 -Xms128m -Xmx1024m，也会发生同样的事情。

指示 JVM 保持低内存利用率（例如，任务 1-4 为 512m）并且仅在实际需要时（例如，在任务 5 的情况下）使用更多内存的内存参数是什么？

也许我需要一种比默认设置更频繁地激活垃圾收集器的方法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-20T18:20:30.733

这两个参数建议 jvm 在需要调整其堆大小时：

```
-XX:MaxHeapFreeRatio=10
-XX:MinHeapFreeRatio=10 
```

这几乎意味着如果在 gc 之后，超过 10% 的堆是空闲的，它将尝试将内存还给操作系统。并且只有在 gc 之后使用超过 90% 的堆时才会增长堆。

这可能会减慢您的程序，因为 gc 将不断更改分配的内存大小。如果您的程序在短时间内分配大量内存，它可能根本没有效果。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-20T15:51:28.073

我认为您对 JVM 的工作方式存在误解。这不是 GC 问题或“任务”问题。

您的任务存在内存泄漏，或者它们旨在占用越来越多的内存。

-Xmx1024m 设置 JVM 可以分配的最大内存。这就像你只有 1024 兆物理内存而没有虚拟内存一样。

使用 Task 的定义更新您的问题会很有帮助。这5个独立的JVM吗？或者在单个 JVM 中只有 5 个工作单元。

**更新**

> 我不打算让程序总是使用所有 1g 堆。我的意图是指示 JVM 在可以管理的情况下使用 512m 堆，并且仅在需要时使用更多内存。当内存不再需要时，回退到 512m 甚至更少的内存量。

仅仅因为您设置了 -Xmx1024m 并不意味着 JVM 将使用所有这些内存。这只是一个最大限制。设置 Xms 直到设置要使用的最小内存量。您的程序最终决定了正在使用的内存的运行量。如果它达到 -Xmx 设置的限制，那么它将抛出 OutOfMemoryError

您可以建议 JVM 通过调用来运行垃圾收集器`System.gc()`。注意我说的建议，你不能强制 GC 运行。你可以在一个甚至拒绝做 GC 的平台上运行。您还需要查看它为您的应用程序选择的 GC 算法。我会看这里[Tuning Garbage Collector](http://www.oracle.com/technetwork/java/gc-tuning-5-138395.html)。

如果您需要对内存使用进行如此精细的控制，您将需要选择除 JVM 之外的其他东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T16:10:24.377

尝试使用[http://visualvm.java.net/](http://visualvm.java.net/)以查看内存消耗。然后您可以使用 jhat 来可视化堆内容并使用[http://www.eclipse.org/mat/](http://www.eclipse.org/mat/)来识别泄漏。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-20T16:03:18.817

通过将 -Xmx1024m 传递给虚拟机，您基本上可以告诉虚拟机它最多可以使用 1 gig 的堆，它最终会这样做。VM 在需要时开始运行垃圾收集，例如。当堆用完时，这取决于可用的堆大小。如果您知道要在外部运行哪个任务（我猜您这样做是因为您将它作为 cmd 行参数传递），为什么不从外部也设置 -Xmx 呢？

# javascript - javascript：更改特定表行的属性

> ID：11123269
> 
> 赞同：-3
> 
> 时间：2012-06-20T15:47:45.670
> 
> 标签：javascript, jquery, html

我有这个 html 表：

```
<table class="table-all"> 
<tbody>
      <tr>
           <td>BISFENOLO</td>
           <td>Bisfenolo-AF 10/10</td>
           <td class="right">€ 30,79</td>
           <td class="right">$ 43,00</td>
           <td class="right">1.000,00</td>
      </tr>
      <tr>
           <td>BISFENOLO</td>
           <td>BPAF-ALLO 1/11</td>
           <td class="right">€ 46,76</td>
           <td class="right">$ 64,00</td>
           <td class="right">1.000,00</td>
      </tr><tr>
           <td>TOTAL</td>
           <td></td>
           <td class="right">€ 698,72</td>
           <td class="right">$ 97,13</td>
           <td class="right">17,00</td>
      </tr>
</tbody> 
```

我会更改包含“TOTAL”单元格的行的背景和字体。任何想法？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T15:51:19.290

选择所有行，过滤到 td 包含文本“TOTAL”的行，然后添加您的类。

```
$('table.table-all tr').has('td:contains("TOTAL")').addClass("totalRow"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T15:51:51.337

这将找到实际的总文本并设置父行颜色：

```
$("td:contains('TOTAL')").parent().css('background-color','#d0d0d0') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T16:00:05.323

在这里 - 不使用 jQuery！

```
var tr = document.getElementsByTagName('tr')[2];
tr.style.backgroundColor = "red"; 
```

# php - 复制没有第一条记录的php数组的最简单方法是什么？

> ID：11123271
> 
> 赞同：1
> 
> 时间：2012-06-20T15:47:49.837
> 
> 标签：php, arrays

如果您正在创建一个数组，请说：

```
$url = explode("/", $_SERVER['QUERY_STRING']); 
```

除了第一个之外，获取所有数组值的最简单方法是什么？

```
$controller = $url[0];

//Pseudo Code
$data       = $url[!0]; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-20T15:49:23.903

使用数组切片。

```
$data = array_slice($url, 1); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T15:49:32.287

怎么样：

```
$data = $controller;
unset ($data[0]); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T15:49:48.747

您可以使用[array_shift](http://jp2.php.net/array_shift)，即将元素从数组的开头移开。

```
$controller = array_shift($url);
$data = $url; 
```

# eclipse - 在 Eclipse/PyDev Jython 项目中将 .dll 添加到 java.library.path

> ID：11123274
> 
> 赞同：22
> 
> 时间：2012-06-20T15:47:58.353
> 
> 标签：eclipse, jython, pydev, java.library.path

我正在尝试在我的 PyDev Jython 项目中使用已编译的 .jar Java 库。

我成功地将 .jar 添加到 PYTHONPATH 并且能够开始使用自动完成工作进行编码。

该库还需要 .dll 扩展名`javaHeclib.dll`，因此我将其添加到项目的 External Libs 部分。

我可以很好地导入库，但是当我尝试访问它的任何功能时出现错误：

```
java.lang.UnsatisfiedLinkError: java.lang.UnsatisfiedLinkError: no javaHeclib in java.library.path 
```

我在运行配置中添加了一个 VM 参数，但没有成功：

```
-Djava.library.path="Y:/path/to/javaHeclib.dll;${env_var:PATH}" 
```

我可以使用上面的方法从命令行运行库`java.library.path`。

在 PyDev 控制台中进行实验，我注意到我可以使用绝对路径加载 .dll 扩展名，但不能使用相对路径：

```
>>> import java.lang
>>> java.lang.System.load('Y:/path/to/javaHeclib.dll')
>>> java.lang.System.loadLibrary('javaHeclib')
Traceback (most recent call last):
  File "<console>", line 1, in ?
java.lang.UnsatisfiedLinkError: java.lang.UnsatisfiedLinkError: no javaHeclib in java.library.path 
```

不幸的是，图书馆正在使用`System.loadLibrary`上面的调用，我无权访问它的源代码。

为什么`javaHeclib.dll`不在我的`java.library.path`？

**编辑**

将 设置为`java.library.path`包含 dll 的目录不允许我使用`System.loadLibrary`.

```
-Djava.library.path="Y:/path/to/dll/;${env_var:PATH}" 
```

（使用正斜杠没有任何区别。）我还尝试更改默认 VM 参数 in `eclipse.ini`，但没有运气：

```
-vmargs
-Dosgi.requiredJavaVersion=1.5
-Xms40m
-Xmx384m
-Djava.library.path="Y:\path\to\dll\;${env_var:PATH}" 
```

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-02-01T18:35:27.740

我认为更好的方法是：

1.  在项目下创建一个文件夹，例如dll。
2.  将所有 dll 文件复制/粘贴到此文件夹中。
3.  在项目 -> 属性 -> Java 构建路径 -> 源中，单击并展开源详细信息。
4.  您将看到本机库位置，单击/突出显示它。
5.  然后点击右边的编辑，再次点击工作区。可以看到项目下的dll文件夹。
6.  选择它并单击确定，确定。您将看到 dll 已添加到本机库位置。

就是这样。您无需手动更改配置中的任何内容。

![Java 构建路径配置](../Images/f94edf4f9ee70e20cfb954188241253a.png)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-06-20T22:13:11.457

我得到了这个工作。

备查：

假设您需要的 dll 在`Y:\path\to\dlls\lib\`. 然后将您的运行配置的工作目录设置为`Y:\path\to\dlls\`并将您的 VM 参数设置为 include `-Djava.library.path=lib`。

就是这样，它现在应该可以工作了。我不知道为什么在`java.library.path`以前指定绝对路径不起作用，但设置工作目录似乎已经完成了。

也许这是我正在使用的特定库所特有的东西（或者 Eclipse 是从与库所在的驱动器不同的驱动器运行的）......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-12T19:10:54.247

我有类似的问题，但使用 Ghost Script dll。即使按照将文件放在工作目录中并按照说明进行操作，它对我也不起作用，请参阅标签 [Ghost4J。java.lang.UnsatisfiedLinkError: 无法加载库 'gsdll64'](https://stackoverflow.com/questions/12153235/ghost4j-java-lang-unsatisfiedlinkerror-unable-to-load-library-gsdll64)并使用 -Djna.library.path 使其工作。

# sql - sql中的查询问题

> ID：11123275
> 
> 赞同：1
> 
> 时间：2012-06-20T15:47:58.653
> 
> 标签：sql, oracle

我无法执行此查询

> ORA-00933: SQL 命令未正确结束
> 00933\. 00000 - “SQL 命令未正确结束”

```
select count(user_id) 
from t_user 
where user_id = 2699478, object_id = 1329 
  and user_id not in
      (SELECT owner_user_id FROM t_obj where actual_id = 17447); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T15:50:54.157

您必须用适当的条件运算符替换`,`两个条件之间的逗号`user_id=2699478 ,object_id=1329`，并使用括号以您想要的方式表达它们，如下所示：

```
SELECT COUNT(user_id) 
FROM t_user 
WHERE user_id = 2699478 
  AND object_id = 1329 
  AND user_id NOT IN
    (
        SELECT owner_user_id 
        FROM t_obj 
        WHERE actual_id = 17447
    ) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-20T15:50:38.760

尝试将逗号替换为`AND`：

```
select count(user_id) from t_user where user_id=2699478 AND object_id=1329 and user_id not in
  (SELECT owner_user_id FROM t_obj where actual_id = 17447); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-20T15:50:48.600

将逗号替换为`and`：

```
select count(user_id)
from t_user
where user_id=2699478
  and object_id=1329
  and user_id not in (SELECT owner_user_id FROM t_obj where actual_id = 17447); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-20T15:54:46.963

您需要用“AND”替换逗号：

```
SELECT count(user_id) FROM t_user WHERE user_id=2699478 AND object_id=1329 AND user_id NOT IN
      (SELECT owner_user_id FROM t_obj WHERE actual_id = 17447); 
```

# css - 添加了 CSS 文件，并且在 Chrome 中看到大幅减速

> ID：11123278
> 
> 赞同：-1
> 
> 时间：2012-06-20T15:48:04.110
> 
> 标签：css

我在我的项目中添加了 jquery ui 1.8.21 redmond css 文件，并注意到 Chrome 的速度很慢。当然，这可能与 jQuery 文件本身无关，所以我怀疑其中一个或多个规则以某种方式干扰了我当前的页面（不太确定如何，我没有看到与页面上的任何元素匹配的选择器）。

我可以通过哪些方法来找出造成这种情况的根本原因是什么？我没有从 Chrome 开发者工具中看到太多有用的信息，但我可能只是不知道一些很酷的功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T15:50:08.137

尝试为 Chrome 开发者工具使用 PageSpeed 插件。也许它可以告诉你问题出在哪里

# cakephp - CakePHP 2.1 - 模型关联 - 保存和查找

> ID：11123280
> 
> 赞同：1
> 
> 时间：2012-06-20T15:48:15.617
> 
> 标签：cakephp, model, find, associations, save

在阅读了食谱和各种问答之后，我在概念上仍然对模型关联及其作用感到有些困惑。我希望有人可以帮助我解决这个问题。所以这是我的问题：

据我所知，模型关联有助于阅读/查找相关数据。那么如果我加载一个用户，那么该用户的所有帖子也会被加载吗？但是，CakePHP 在保存新条目方面真的没有做太多事情吗？例如：如果我创建一个新帖子，那么我必须手动为相关用户指定 user_id 字段，CakePHP 不会以某种方式自动执行吗？手动我的意思是在这个答案中明确定义mentor_id：[CakePHP model associations table w/data and new table](https://stackoverflow.com/questions/10337638/cakephp-model-associations-table-w-data-and-new-table)

为什么在保存时需要“提及”这两个模型？例如 $this->Mentor->Student->save($student)。这是一种跟踪双向关联的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:23:36.787

> 如果我加载一个用户，那么该用户的所有帖子也会被加载？

是的，CakePHP 将加载所有相关数据，除非您[取消绑定](http://api20.cakephp.org/class/model#method-ModelunbindModel)或[绑定](http://api20.cakephp.org/class/model#method-ModelbindModel)模型或更改您正在使用的模型的递归属性。

> 但是，CakePHP 在保存新条目方面真的没有做太多事情吗？例如：如果我创建一个新帖子，那么我必须手动为相关用户指定 user_id 字段，CakePHP 不会以某种方式自动执行它？

您必须为用户指定 ID，然后进行保存，当您从具有指定 ID 的模型中保存时，它将处理其余部分。例如，假设您有一个 Post 和一个 User 模型，并且用户使用 Auth 登录：

```
 $this->request->data['Post']['user_id'] = $this->Auth->user('id');
  if ($this->Post->save($this->request->data)) {
    $this->Session->setFlash('Your post has been saved.');
    $this->redirect(array('action' => 'index'));
  } 
```

因此，没有必要提及这两个模型，如果您同时提及两个模型，您可以执行以下操作，再次以帖子和用户为例。

```
$this->User->read(null, $this->Auth->user('id'));
if ($this->User->Post->save($this->request->data)) {
  $this->Session->setFlash('Your post has been saved.');
  $this->redirect(array('action' => 'index'));
} 
```

这将等同于前一种情况，因为您正在使用用户数据加载用户模型并为该用户保存一个帖子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T16:05:55.390

我假设您使用的是belongTo 关系，但我认为它可能是食谱中描述的任何类型

> 如果我加载一个用户，那么该用户的所有帖子也会被加载？

是的，如果您设置了正确的关系（belongsTo、hasA 等），Cake 会自动处理。

> 但是，CakePHP 真的没有为保存新条目做太多事情吗？例如：如果我创建一个新帖子，那么我必须手动为相关用户指定 user_id 字段，CakePHP 不会以某种方式自动执行它？

我相信这是用[saveAll、saveAssociated 等](http://book.cakephp.org/2.0/en/appendices/new-features-in-cakephp-2-1.html)方法处理的，但我还没有遇到使用它的场景

> 为什么在保存时需要“提及”这两个模型？例如 $this->Mentor->Student->save($student)。这是一种跟踪双向关联的方法吗？

这是因为您要保存主模型及其依赖项（同样取决于您建立关系的方式），因此您需要明确说明。其他方法是导入 StudenController （根据您的示例）和（[在构造类之后](http://book.cakephp.org/2.0/en/core-utility-libraries/app.html#including-files-with-app-import)）调用 save 方法`$studentController->Student->save($student)`

希望这可以帮助

# asp.net - 顶级域正在使用子域 global.asax

> ID：11123282
> 
> 赞同：0
> 
> 时间：2012-06-20T15:48:18.280
> 
> 标签：asp.net, iis-7.5

我在 ASP.NET 2.0 中的域 www.xyz.com 上有一个网站

我还有几个其他网站在子域上运行，其中一个是 www.abc.ef.xyz.com

现在子域中的 global.asax 有一些通过发送电子邮件记录错误的代码。

我们在 www.xyz.com 上遇到了一些问题，我开始收到有关该网站错误的电子邮件。

xyz.com 也有 global.asax，但在代码中我没有发送任何错误电子邮件。

知道如何/为什么会发生这种情况吗？

注意：我无权访问服务器本身，即我无法提供有关网络服务器设置的信息。虽然它是一个私人服务器（2008/IIS7.5）而不是任何托管服务提供商。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T15:51:26.977

不幸的是，如果无法访问服务器，就很难猜测发生了什么。我想你只是有分隔站点的文件夹，而不是实际的应用程序（在 IIS 中定义），它们将决定读取 global.asax 文件的范围。在代码级别走得太远之前，我会更好地了解 IIS 级别的体系结构。

# download - AFNetworking + 大下载文件 + 恢复下载

> ID：11123288
> 
> 赞同：6
> 
> 时间：2012-06-20T15:48:32.303
> 
> 标签：download, afnetworking, resume

我需要使用 AFNetworking 下载文件 > 500 Mo。有时，下载它们的时间超过 10 分钟，如果应用程序在后台，则下载无法完成。

所以我想尝试部分下载。我发现了很多链接，这似乎可以通过 AFHTTPRequestOperation 上的 pause() 和 resume() 方法实现。

实际上，我做到了：

```
 [self.downloadOperation setShouldExecuteAsBackgroundTaskWithExpirationHandler:^{   
    // Clean up anything that needs to be handled if the request times out
    [self.downloadOperation pauseDownload];
  }]; 
```

DownloadOperation 是 AFHTTPRequestOperation（单例）的子类。

在 AppDelegate 中：

```
- (void)applicationWillEnterForeground:(UIApplication *)application
{
  // resume will only resume if it's paused...
  [[DownloadHTTPRequestOperation sharedOperation] resumeDownload];  
} 
```

服务器可以在标头中获取新范围...

我的问题：

1）这不是好方法吗？2) 简历是否需要更改 outputStream (append:NO => append:YES) ？或者它是由 AFNetworking 管理的吗？（没找到）

```
self.outputStream = [NSOutputStream outputStreamToFileAtPath:self.filePath append:YES]; 
```

像这样的东西（在 DownloadHTTPRequestOperation 中）：

```
- (void)pauseDownload
{
  NSLog(@"pause download");
  [self pause];
}

- (void)resumeDownload
{
  NSLog(@"resume download");
  self.outputStream = [NSOutputStream outputStreamToFileAtPath:self.filePath append:YES];
  [self resume];
} 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T07:15:37.733

更新：

由于 steipete 可能不再维护 AFDownloadRequestOperation ( [https://github.com/steipete/AFDownloadRequestOperation/pull/68](https://github.com/steipete/AFDownloadRequestOperation/pull/68) )。NSURLSessionDownloadTask 可能是更好的选择。

* * *

[https://github.com/steipete/AFDownloadRequestOperation](https://github.com/steipete/AFDownloadRequestOperation)

另外，我写了一个基于 AFDownloadRequestOperation 的库：[https ://github.com/BB9z/RFDownloadManager](https://github.com/BB9z/RFDownloadManager)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T18:30:17.177

我最终使用旧的（非 ARC）[ASIHTTPRequest](http://allseeing-i.com/ASIHTTPRequest/)框架来完成类似的任务。*AllowResumeForFileDownloads 可以满足*您的需要。请注意，您的服务器需要通过读取*Range* http 标头来支持恢复。

```
if (![[NSFileManager defaultManager] fileExistsAtPath:downloadPath]){
    ASIHTTPRequest *request = [ASIHTTPRequest requestWithURL:url];
    [request setDelegate:self];
    [request setAllowResumeForFileDownloads:YES];
    [request setDownloadDestinationPath:downloadPath];
    [request setTemporaryFileDownloadPath:tmpPath];
    [request startAsynchronous];
} 
```

# eclipse - 更改我的项目的 C/C++ 构建命令

> ID：11123290
> 
> 赞同：0
> 
> 时间：2012-06-20T15:48:41.610
> 
> 标签：eclipse

我需要能够在我的 Eclipse 插件中更改项目构建命令。我有一个 Eclipse 插件，只要激活它，我就需要更改当前项目的构建命令。我希望插件能够做到这一点，而不是用户必须手动更改它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T17:14:32.090

我自己解决了这个问题。如果您使用 ManagedBuildManager，它允许您修改构建命令。

这是示例代码：

```
IConfiguration config = ManagedBuildManager.getBuildInfo(activeProject).getDefaultConfiguration();
config.setBuildCommand("test");
ManagedBuildManager.saveBuildInfo(activeProject, true); 
```

# sql - 使用生产日期表添加缺失的行

> ID：11123304
> 
> 赞同：3
> 
> 时间：2012-06-20T15:49:27.583
> 
> 标签：sql, sql-server, tsql

这个问题与[此 SO 帖子有关](https://stackoverflow.com/questions/11031287/adding-a-further-group-into-a-recursive-cte)

我如何使用 DimDates 表添加丢失的数据（通过日期视为丢失）而不是使用递归 CTE？

我有以下两个表：

```
create table the_table 
(
  [Date] datetime,
  Category2 varchar(10),
  Amount INT
)
insert into the_table
values
( '01 jan 2012', 'xx', 10),
( '03 jan 2012', 'yy', 50)

create table DimDate 
(
  [Date] datetime
)
insert into DimDate
values
( '01 jan 2012'),
( '02 jan 2012'),
( '03 jan 2012'),
( '04 jan 2012') 
```

这些是我试图达到的结果。我没有为递归 CTE 烦恼，因为我错误地认为，使用我们的仓库 DimDate 表会更容易加载：

![在此处输入图像描述](../Images/88a5d33561edc7685193ff27cfee2b64.png)

好的 - 我可能偶然发现了一个可能的解决方案 - 如果它是错误的，请戳以下漏洞：

```
select

  coalesce(x.[Date], y.[Date]) AS Date ,
  coalesce(x.Category2, y.Category2) AS Category2 ,
  isnull(Amount,0) as Amount
from the_table x
full outer join 
(
select 
    d.Date
    , t.Category2
from 
        the_table t
        cross join DimDate d 
) y
    on
    x.Category2 = y.Category2
    and 
    x.Date = y.Date 
```

这就是我最终的结果。Aaron 帖子中标记的答案和 cte 的组合：

```
;WITH 
    Dates_cte ([Date]) AS
            (
            SELECT [Date] = DayMarker 
            FROM WHData.dbo.vw_DimDate x
            WHERE
                    x.DayMarker >= (SELECT MIN([Date]) FROM #Data1 WHERE Period = 'Daily') AND
                    x.DayMarker <= GETDATE()
            )   
    ,Categories ([Operator], [Market], [Product], [Measure]) AS 
                ( 
                SELECT DISTINCT 
                        [Operator]
                        , [Market]
                        , [Product]
                        , [Measure] 
                FROM #Data1 
                WHERE [Period] = 'Daily'
                ) 
INSERT INTO #Data1 
    SELECT 
         c.[Operator]
        , c.[Market]
        , c.[Product]
        , [Period] = CONVERT(VARCHAR(100), 'Daily')
        , d.[Date]  
        , c.[Measure]   
        , 0 
    FROM Dates_cte d CROSS JOIN Categories c
    WHERE NOT EXISTS 
            ( 
            SELECT * 
            FROM #Data1 AS T 
            WHERE 
                    t.[Period] = 'Daily' AND
                    t.[Operator] = c.[Operator] AND 
                    t.[Market] = c.[Market] AND 
                    t.[Product] = c.[Product] AND 
                    t.[Measure] = c.[Measure] AND 
                    t.[Date] = d.[Date] 
            ) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T15:59:18.553

使用`INSERT INTO ... SELECT FROM DimDate CROSS JOIN categories WHERE NOT EXISTS ...`.

试试这个：

```
INSERT INTO the_table
([Date], Category2, Amount)
SELECT [Date], category2, 0
FROM DimDate
CROSS JOIN
(
    SELECT DISTINCT category2 FROM the_table
) AS categories
WHERE NOT EXISTS
(
    SELECT *
    FROM thetable AS T
    WHERE T.category2 = categories.Category2
    AND T.[Date] = DimDate.[Date]
) 
```

在线查看它：[ideone](http://sqlfiddle.com/#!3/c16e7b/3)

如果您正在创建数据仓库，我建议您将类别放入维度表中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T15:56:47.647

显然是错误的伪代码，显示了可能的解决方案

```
insert into table1
    select  from table2 
        where not exists (select from table1 where table1.date = table2.date) 
```

假设您正在尝试将数据添加到表 1 中。

如果你只是想在内存中，

```
select * from table 1
union 
select * from table 2 where not exists (select from table1 where table1.date = table2.date) 
```

或者只是一个外部连接

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T16:10:41.660

```
;WITH cat AS (SELECT Category2 FROM the_table GROUP BY Category2)
INSERT the_table([Date], Category2, Amount)
SELECT d.[Date], cat.Category2, 0
FROM DimDate AS d CROSS JOIN cat
LEFT OUTER JOIN the_table AS t
ON d.[Date] = t.[Date]
AND cat.Category2 = t.Category2
WHERE t.[Date] IS NULL; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-20T15:59:09.363

第 1 步，插入缺失的日期：

```
select [Date], '', 0 from DimDate
where [Date] not in (select [Date] from the_table) 
```

第二步，更新`Categoriy2`列：

```
update the_table
set Category2 =
     (select aux.Category from the_table aux where t.Date = 
        (select max(t.Date) from the_table t
         where t.Category2 <> '' and t.Date < aux.Date) 
```

# php - 正则表达式和重音符号/波浪号

> ID：11123314
> 
> 赞同：3
> 
> 时间：2012-06-20T15:49:52.803
> 
> 标签：php, regex, diacritics

我应该如何在正则表达式中包含口音？我想检测来自`a-z`and的字母，`äáàëéèíìöóòúùñç`但是这个正则表达式不起作用：

```
$pattern = '/^([a-zäáàëéèíìöóòúùñç])/i'; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T16:07:07.790

您可以尝试使用预定义的类来匹配所有字母，例如：

```
[\p{L}] 
```

这将适用于大多数正则表达式引擎。

您可以在此处阅读有关正则表达式中 unicode 的更多信息，例如：[http ://www.regular-expressions.info/unicode.html](http://www.regular-expressions.info/unicode.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-20T17:31:10.747

怎么样：

```
cat test.php
<?php
preg_match('/\pL/u', 'é', $m);
print_r($m);
?>

php -q test.php
Array
(
    [0] => é
) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T16:06:00.760

您可能会尝试将`u`标志添加到您的正则表达式（请参阅[修饰符](http://php.net/manual/en/reference.pcre.pattern.modifiers.php)页面上的*PCRE_UTF8 ）*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-20T16:16:00.973

如果您删除最后一个“i”怎么办，我正在使用[Rubular 对其](http://rubular.com/)进行测试，没有它它也可以工作（也没有，`/`因为这些是特定于 php 的。）

所以基本上像这样在这个页面中测试它：`^([a-zäáàëéèíìöóòúùñç])`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-21T08:50:13.010

在这里你可以找到我的问题的解决方案： [使用正则表达式和 preg_replace_callback](https://stackoverflow.com/questions/11133485/using-of-regex-whith-preg-replace-callback/11133597#comment14592579_11133597) ，似乎正则表达式必须像： $pattern = '/(\p{L})(.+)/iu';

# bash - Bash 循环只处理所有其他文件

> ID：11123320
> 
> 赞同：0
> 
> 时间：2012-06-20T15:50:09.643
> 
> 标签：bash, loops

我一直在编写一个脚本来为我的家庭视频生成 .tbn 文件。如果我运行脚本，它似乎只处理所有其他文件。

```
#!/bin/bash

find ~/Movies/Home\ Movies/Canada\ Trip -type f | egrep '\.mp4$|\.avi$|\.mkv$' | while read file ; do

    if [ ! -f "${file:0:${#file}-3}tbn" ]; then
        # .tbn not found
        echo "$file"
        ffmpeg  -itsoffset -13  -i "$file" -vcodec mjpeg -vframes 1 -s 400x224 -an -f rawvideo "${file:0:${#file}-3}tbn"
    fi

done 
```

这是我的数据集：

```
Canada.Trip.S01E01.avi
Canada.Trip.S01E02.avi
Canada.Trip.S01E03.avi
Canada.Trip.S01E04.avi
Canada.Trip.S01E05.avi
Canada.Trip.S01E06.avi
Canada.Trip.S01E07.avi
Canada.Trip.S01E08.avi
Canada.Trip.S01E09.avi
Canada.Trip.S01E10.avi
Canada.Trip.S01E11.avi
Canada.Trip.S01E12.avi
Canada.Trip.S01E13.avi
Canada.Trip.S01E14.mp4
Canada.Trip.S01E15.mp4
Canada.Trip.S01E16.mp4
Canada.Trip.S01E17.mp4
Canada.Trip.S01E18.avi
Canada.Trip.S01E19.mkv
Canada.Trip.S01E20.mp4 
```

所以我第一次运行它时，它会为 1、3、5、7 等生成 tbn。偶数文件失败`vies/Canada Trip/Canada.Trip.S01E16.mp4: No such file or directory` （注意文件名的截断开头）

如果我再次运行脚本，它会生成偶数文件 .tbn 文件。我以前从未使用过 Bash，所以我发现整个情况令人困惑！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:11:43.487

ffmpeg[读取标准输入](http://mywiki.wooledge.org/BashFAQ/089)。此外，您应该始终使用`read -r`.

# java - 在 Mac OSX Lion 上使用 Eclipse 运行 C++

> ID：11123322
> 
> 赞同：1
> 
> 时间：2012-06-20T15:50:11.737
> 
> 标签：java, c++, eclipse, ide, eclipse-cdt

所以我正在运行 Mac OSX Lion，并且我最近为 Java 开发人员安装了 Eclipse IDE。我最近开始使用 C++ 进行编程，我希望能够使用 Eclipse 作为我的主要 IDE。所以我做的第一件事是安装从 Xcode 告诉的命令行，以便能够使用 g++ 编译器。然后我进入 Eclipse -> 帮助 -> 安装新软件并输入以下链接：http: [//download.eclipse.org/tools/cdt/releases/indigo](http://download.eclipse.org/tools/cdt/releases/indigo)。

我安装了所有主要功能和可选功能。然后我创建了一个新的 C++ Hello World 项目并构建了它。但是，当我右键单击二进制文件时，没有“作为本地 C/C++ 应用程序运行”选项。实际上根本没有运行选项。

我为 C/C++ 开发人员下载并安装了 Eclipse IDE，并创建了一个新的 hello world 项目来进行测试。这个似乎工作正常。为什么它可以在 c/c++ IDE 中工作，但不能在同时安装 CDT 的 java IDE 中工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T22:25:25.503

视图名称是什么 - 是“包资源管理器”还是“项目资源管理器”？第一个明确用于 Java，不支持某些 C++ 工具功能。切换到 C/C++ 透视图并重试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T14:25:56.517

所以在玩了很多之后，我想出了一个有点烦人的解决方案。因为它适用于 C/C++ IDE，所以我决定查看安装在该版本中的所有内容，并确保它安装在 Java IDE 中。出于某种奇怪的原因，它起作用了。我添加了已经安装的所有主要功能，但我想这还不够。

# drupal - 使 quicktabs 模块具有响应性

> ID：11123323
> 
> 赞同：2
> 
> 时间：2012-06-20T15:50:12.777
> 
> 标签：drupal, drupal-7, responsive-design

我正在使用 drupal 7 的高级响应主题，并将快速选项卡模块添加到首页。目前，快速选项卡模块的主体正在随着屏幕调整大小，但选项卡彼此堆叠。是否可以调整选项卡（连同字体）以使它们保持并排？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T20:26:27.133

Quick Tabs 模块不会自动输出宽度或高度，因此您可以使用响应式 CSS 技术来实现这一点。 [http://drupal.org/node/1377736](http://drupal.org/node/1377736)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T13:13:57.857

我遇到了类似的问题。查看主题为您提供的 layout.css 文件夹并为快速选项卡建模。您想为快速选项卡提供一个特定的“阈值”，以在达到特定屏幕尺寸时调整宽度。然后我在其中放置了一小段 php，其中包含选项卡并将它们从选项卡更改为可单击的下拉列表。我不会给你代码，因为你自己学习它最符合你的利益。祝你好运，我希望这能让你朝着正确的方向前进！

# html - CSS 两列布局宽度（正文与标题）

> ID：11123325
> 
> 赞同：0
> 
> 时间：2012-06-20T15:50:19.083
> 
> 标签：html, css, width

我确信对此有一个非常简单的解释，但我似乎无法弄清楚，希望能得到一些帮助。

尽管所有数字似乎加起来，并且基本上没有任何填充或边距，但我的主要部分（由#main 和#rightnav 组成）比我的标题更宽。

我错过了什么？

```
<head>

<style type="text/css">
body {
background: url('cwbg.jpg');
text-align: center;
border: 0;
padding: 0;
margin: 0;
}
a {
border: 0;
text-decoration: none;
}
img {
vertical-align: top;
}
#container {
width: 800px;
height: auto;
margin: auto;
}
#header {
width: 800px;
height: 100px;
margin: auto;
padding-top: 50px;
}
#main {
width: 650px;
height: 700px;
float: left;
}
#rightnav {
width: 150px;
height: 700px;
float: left;
padding-top: 7px;
}
#rightnav ul {
list-style-type: none;
padding: 0;
margin: 0;
}
#rightnav img {
float: left;
}
</style>
</head>

<body>
<div id="container">
<div id="header">
    <img src="header.png" alt="Christopher James Wilson">
</div>
<div id="main">
</div>
<div id="rightnav">
    <ul>
        <li><img src="navslices/images/menu_01.png" /></li>
        <li><img src="navslices/images/menu_02.png" /></li>
        <li><img src="navslices/images/menu_03.png" /></li>
        <li><img src="navslices/images/menu_04.png" /></li>
        <li><img src="navslices/images/menu_05.png" /></li>
        <li><img src="navslices/images/menu_06.png" /></li>
        <li><img src="navslices/images/menu_07.png" /></li>
        <li><img src="navslices/images/menu_08.png" /></li>
        <li><img src="navslices/images/menu_09.png" /></li>
        <li><img src="navslices/images/menu_10.png" /></li>
        <li><img src="navslices/images/menu_11.png" /></li>
        <li><img src="navslices/images/menu_12.png" /></li>
        <li><img src="navslices/images/menu_13.png" /></li>
        <li><img src="navslices/images/menu_14.png" /></li>
        <li><img src="navslices/images/menu_15.png" /></li>
        <li><img src="navslices/images/menu_16.png"></li>
    </ul>
</div>
</div>
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T15:53:04.800

您可能想尝试相对定位元素。如果您的图片比您设置的尺寸宽，它们可能会推出区域。

另一种选择是将所有元素包装在一个 div 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T16:51:32.113

```
<html>
<head>
<style type="text/css">

#container{
width: 800px; /*Width of main container*/
margin: 0 auto; /*Center container on page*/
}

#header{
background: #EAEAEA;
height: 100px; /*Height of top section*/
}

#topsection h1{
margin: 0;
padding-top: 15px;
}

#contentwrapper{
float: left;
width: 100%;
}

#rightnav{
margin-left: 650px; /*Set left margin to LeftColumnWidth*/
height:700px;
}

#main{
float: left;
width: 650px; /*Width of left column*/
margin-left: -800px; /*Set left margin to -(MainContainerWidth)*/
background: #C8FC98;
height:700px;
}

</style>
</head>
<body>
<div id="container">

<div id="header"><h1>Header</h1></div>

<div id="contentwrapper">
<div id="rightnav">
<b>Content Column:
</div>
</div>

<div id="main">
  Left Column
</div>

</div>
</body>
</html> 
```

从 DynamicDrive 代码编辑以满足您的要求。

更多布局请参考[http://www.dynamicdrive.com/style/layouts/](http://www.dynamicdrive.com/style/layouts/)

问题如上所述，您的 div 容器缺少一些位置属性。

# java - JMS 队列“热”交换

> ID：11123326
> 
> 赞同：0
> 
> 时间：2012-06-20T15:50:20.367
> 
> 标签：java, queue, jms, weblogic, ibm-mq

目前我有一个 Weblogic 10R3 的 Java EE App 主机，我有兴趣测试 1 个消息驱动 Bean。问题是我无法访问 Bean 正在侦听的外部 JMS 服务器，这里是 MDB 代码：

```
import static com.citi.primefinance.utils.jms.ForeignJMSConstants.Queue.INCOMING_QUEUE_SWIFT_FX;
@MessageDriven(name = "IncomingSwiftFxProcessorMDB", mappedName = INCOMING_QUEUE_SWIFT_FX)
public class IncomingSwiftFxProcessorMDB extends AbstractMessageDrivenBean {
@Override
protected void processMessage(Serializable obj) throws Exception{

    debug(this.getClass().getName() + ".processMessage()");

    if (obj instanceof String) {
        info(this.getClass().getName() + ": received on Message object");
        processSwiftFxTradeMessage((String)obj);
    } else {
        error(this.getClass().getName() + ": received an object " + obj + " which is not a TextMessage");
    }
 } 
```

我的计划是因为 Bean 将通过 JNDI 查找队列，并且我确实可以访问 Weblogic 托管服务器。所以我可以删除外部 JMS 服务器，然后添加一个本地 jms 队列和 connectionFactory 保存确切的 JNDI 名称。因此隔离外部依赖。

人们认为这是合理的吗？或者有人有其他想法吗？我也在考虑使用 Mocking 来隔离对 JMS 的依赖。

非常感谢任何帮助，谢谢

这是一些 Weblogic 日志，表明 Message Bean 无法处理“热”交换？

incomingSwiftFxProcessorMDB 无法连接到 JMS 目标：IncomingSwiftFxQueue。错误是：消息驱动的 EJB 尝试使用 JNDI 名称连接到 JMS 连接工厂：SwiftConnectionFactory。但是，具有 JNDI 名称的对象：SwiftConnectionFactory 不是 JMS 连接工厂。NestedException 消息是：weblogic.jms.client.JMSConnectionFactory>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T16:40:59.313

最终，您应该在 JMS 接口的上下文之外测试您的业务逻辑。否则，是的——这是可行的。WebLogic 中的外部 JMS 服务器只是远程 JMS 目标的本地 JNDI 表示。

但是，您不必删除外部配置 - 只需将其从服务器/集群中取消定位即可。然后，使用当前用于访问外部资源的相同 JNDI 名称创建包含 JMS 队列（和 ConnectionFactory，如果适用）的 JMS 模块，然后您可以测试 MDB。完成后，您可以取消用于测试的 JMS 模块的目标，并将外部 JMS 服务器重新定位到适当的资源。

保留“测试”JMS 模块可能会很好，这样您将来可以轻松地再次测试:)

尝试将其更新为如下所示，并实现 MessageListener 接口：

```
@MessageDriven(
messageListenerInterface = javax.jms.MessageListener.class,
name = "MyListener",
mappedName = "jms/my/notification",
activationConfig = {
    @ActivationConfigProperty(
        propertyName = "connectionFactoryJndiName",
        propertyValue = "weblogic.jms.XAConnectionFactory"),
    @ActivationConfigProperty(
        propertyName = "destinationType",
        propertyValue = "javax.jms.Queue")
}) 
```

# iphone - 使用 NSDateformatter 将 NSString 转换为 NSDate

> ID：11123329
> 
> 赞同：0
> 
> 时间：2012-06-20T15:50:23.377
> 
> 标签：iphone, ios, nsdate, nsdateformatter

我有一串日期 2010-11-29T00:00:00+05:30 ，我想将其转换为`NSDate`. 我想将其转换为 2010 年 11 月 29 日。为此，我正在做这样的事情..

```
NSDateFormatter *df = [[NSDateFormatter alloc] init];
textForLabel = @"2010-11-29T00:00:00+05:30";
[df setDateFormat:@"yyyy-MM-dd"];
NSDate *myDate = [df dateFromString:textForLabel];
NSLog(@"date : %@",myDate); 
```

但输出为空。

2010-11-29T00:00:00+05:30 的日期格式可能是什么？

我不明白这里出了什么问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:13:47.733

首先，去掉时区中的冒号，因为“+05:30”没有[时区格式标识符](http://unicode.org/reports/tr35/tr35-6.html#Date_Format_Patterns)

```
textForLabel = [textForLabel
                stringByReplacingCharactersInRange:NSMakeRange(21,1)
                withString:@""]; 
```

然后，您将拥有以下字符串：`2010-11-29T00:00:00+0530`

可以使用以下日期格式：

```
[df setDateFormat:@"yyyy:MM:dd'T'HH:mm:sszzz"]; 
```

相关问题：[iPhone NSDateFormatter 时区转换](https://stackoverflow.com/questions/3094730/iphone-nsdateformatter-timezone-conversion)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T04:10:38.170

```
-(NSDate *) getDateFor :(NSString *)ICSDateString
{
    int strLen = [ICSDateString length];    
    NSString * subString1 = [ICSDateString substringWithRange:NSMakeRange(0, strLen - 1)];
    NSLog(@"%d  %d subString1 %@", strLen, subString1.length, subString1);
    NSDateFormatter* df = [[NSDateFormatter alloc] init];
    [df setDateFormat:@"yyyyMMdd'T'HHmmss'Z'"];
    [df setLocale:[[[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"] autorelease]];

    NSDate* parsedDate = [df dateFromString:subString1];

    [df release];
    NSLog(@"parsedDate %@", parsedDate);
    return parsedDate;
} 
```

想想，这是从 ICS 格式日期获取 NSDate 的正确方法。请查看[此链接](https://stackoverflow.com/a/7554525/1424174)以供参考。谢谢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T15:54:42.587

> textForLabel = 2010-11-29T00:00:00+05:30

那不是字符串。考虑到缺少结束分号，我怀疑它甚至会编译，但如果编译器可以编译，则可能会将其解释为表达式并将结果数字分配给`textForLabel`. 要使其成为字符串，请执行以下操作：

```
textForLabel = @"2010-11-29T00:00:00+05:30"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-20T15:55:49.340

尝试这个，

```
NSDateFormatter *df = [[NSDateFormatter alloc] init];
textForLabel = @"2010-11-29T00:00:00+05:30";
NSArray *components = [textForLabel componentsSeperatedByString:@"T"];
[df setDateFormat:@"yyyy-MM-dd"];
NSDate *myDate = [df dateFromString:[components objectAtIndex:0]];
NSLog(@"date : %@",myDate); 
```

这不是所需的方法，但会起作用:)

# java - Cloud Datastore 和会话

> ID：11123332
> 
> 赞同：0
> 
> 时间：2012-06-20T15:50:28.057
> 
> 标签：java, database, google-app-engine, google-cloud-datastore, jdo

我正在为我的应用程序使用 JDO 对象。最近，当我将应用程序部署到 Google App Engine 时，我的实体没有以相对类型保存在 Cloud Datastore 数据库中，而是存储在 ah_session 中。如何在 ah_session 中查看我的数据值？我如何将这些数据存储在 Cloud Datastore 中？

这是没有 set 和 get 方法和构造函数的 JDO 类：

```
@PersistenceCapable(identityType = IdentityType.APPLICATION)
public class Utente implements Serializable {

@PrimaryKey
@Persistent(valueStrategy = IdGeneratorStrategy.IDENTITY)
    private Long idUtente; 
@Persistent
private String email;
@Persistent
private String nome;
@Persistent
private String cognome;
@Persistent
private String password;
@Persistent
private Boolean attivo;
@Persistent
private String sesso;
@Persistent//(dependent = "true")
private Long idMatrimonio; 
```

这是我创建对象的 utils 类：

```
public class UtenteUtils implements Serializable {
//private Logger log = Logger.getLogger(this.getClass());

public Utente creaUtente(Utente utente) {
    PersistenceManager pm = PMF.get().getPersistenceManager();
    try {
        utente = pm.makePersistent(utente);     
    } catch (Exception e) {        // TODO: handle exception
        System.out.println(e.getMessage() + "DB-creaUtente");
        //log.finest("crea utente errore");
    }
    finally{
        pm.close();
    }
    return utente;      
  }

  public void eliminaUtente(Long idUtente){
    PersistenceManager pm = PMF.get().getPersistenceManager();
            Query q = pm.newQuery(Utente.class);
    q.setFilter("idUtente == idUtenteParam");
    q.declareParameters("Long idUtenteParam");
    List<Utente> risultato = (List<Utente>) q.execute(idUtente);
    if(!risultato.isEmpty())
      for(Utente u : risultato)
          pm.deletePersistent(u);
      pm.close();
    }

  public Utente cercaUtente(Long idUtente) {
      PersistenceManager pm = PMF.get().getPersistenceManager();
      Utente u = pm.getObjectById(Utente.class, idUtente);
      return u;
  }

  public List<Utente> cercaUtentePerEmail(String mail) {
      List<Utente> utenti = new ArrayList<Utente>();
      PersistenceManager pm = PMF.get().getPersistenceManager();
              Query query = pm.newQuery(Utente.class);
      query.setFilter("email == emailParam");
      query.declareParameters("String emailParam");
      utenti = (List<Utente>) query.execute(mail);
      return utenti;
  }

  public List<Utente> listaUtenti() {
      List<Utente> utenti = new ArrayList<Utente>();
      PersistenceManager pm = PMF.get().getPersistenceManager();
      Query query = pm.newQuery("SELECT FROM it.nozze.cliente.JDO.Utente");
      utenti = (List<Utente>) query.execute();
      return utenti;
  } 
```

这是我使用该对象的类：

```
@ManagedBean
@SessionScoped
public class Registrazione implements Serializable {
private UtenteUtils utenteUtils;
private Utente sposo;
private Utente sposa;
private MatrimonioUtils matrimonioUtils;
private Matrimonio matrimonio;

public Registrazione() {
    this.sposo = new Utente();
    this.sposa = new Utente();
    this.matrimonio = new Matrimonio();
}

public void creaUtenteSposo() {
    matrimonioUtils = new MatrimonioUtils();
    matrimonio = matrimonioUtils.creaMatrimonio(matrimonio);

    sposo.setSesso("M");
    sposo.setPassword("x");
    sposo.setAttivo(true);
    sposo.setMatrimonio(m.getIdMatrimonio());
    utenteUtils = new UtenteUtils();
    sposo = utenteUtils.creaUtente(sposo);
} 
```

# arrays - 在循环中使用带有数组的 conj 时出现空指针错误

> ID：11123340
> 
> 赞同：2
> 
> 时间：2012-06-20T15:50:51.583
> 
> 标签：arrays, loops, clojure, variable-assignment

解决 Project Euler 上的问题以尝试学习 Clojure。我在第7题。

我得到一个空指针，我无法弄清楚我到底做错了什么。

```
;;By listing the first six prime numbers: 2, 3, 5, 7, 11, and 13, we can
;;see that the 6th prime is 13.
;;
;;What is the 10 001st prime number?

(defn isPrime [x]
    (if-not (> x 2) false (loop [i 2]
            (if (= i x)
                true
                (if (= (mod x i) 0) false (recur (inc i)) )
            )
        )
    )
)

(loop [ x [2]
        y 3   ]
    (if (= (count x) 6)
        (println (last x))
        ( if (isPrime y) ((let [x (conj x y)]) (println (str (last x)))) )
    )
    (if-not (= (count x) 10001) (recur x (inc y)) )
) 
```

`( if (isPrime y) ((let [x (conj x y)]) (println (str (last x)))) )`根据java，错误在于。

这是追溯..

```
gcoles@gcoles-pc:~/euler$ clj 7.clj 
2
Exception in thread "main" java.lang.NullPointerException
    at user$eval2.invoke(7.clj:21)
    at clojure.lang.Compiler.eval(Compiler.java:6511)
    at clojure.lang.Compiler.load(Compiler.java:6952)
    at clojure.lang.Compiler.loadFile(Compiler.java:6912)
    at clojure.main$load_script.invoke(main.clj:283)
    at clojure.main$script_opt.invoke(main.clj:343)
    at clojure.main$main.doInvoke(main.clj:427)
    at clojure.lang.RestFn.invoke(RestFn.java:408)
    at clojure.lang.Var.invoke(Var.java:415)
    at clojure.lang.AFn.applyToHelper(AFn.java:161)
    at clojure.lang.Var.applyTo(Var.java:532)
    at clojure.main.main(main.java:37) 
```

空指针实际上直到第二次循环才出现（通过在`print`之后放置 a 看到`let`），所以这让我有点困惑..

有人对此有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T16:23:33.820

`let`是以下形式：

```
(let [binding values]
  (body)) 
```

这将返回评估的结果`body`。在上面的代码中，您的`let`表单如下所示：

```
(let [x (conj x y)]) 
```

注意没有身体。因此，`let`表单返回`nil`. 因为它是`nil`，所以您真正调用的代码如下所示：

```
(nil (println (str (last x)))) 
```

因此，您实际上是在尝试`nil`作为函数调用。这会导致您的空指针异常。例如，如果您编写代码：

```
(let [x (conj x y)] (println (str (last x)))) 
```

它将打印出 的最后一个值`x`。但是，值得注意的是，这个新`x`的（ 的结果`(conj x y)`）仅适用于`let`语句。如果您真的想在其他地方使用它，例如，您将不得不`recur`使用它。

# css - 将背景图像添加到 Google Fusion Tables 地图信息窗口？

> ID：11123344
> 
> 赞同：0
> 
> 时间：2012-06-20T15:50:54.760
> 
> 标签：css, google-maps, google-maps-api-3, google-fusion-tables, infowindow

我正在为 Google Fusion Tables 地图创建自定义信息窗口布局。我的专栏之一指定了（部分）图像名称，然后将其用作背景图像。我希望这个背景图像与信息窗口的边缘齐平。我在下面编写的代码在本机 html 中有效，但在信息窗口中无效，因为：

1.  背景图片不显示（默认为后面的纯色）
2.  我无法摆脱信息窗口中内容周围的填充

> ```
> <div class='googft-info-window' style='font-family: sans-serif; width:495px; padding:0px; margin:0px;'>
> <div style="width:495px; height:36px; background:url(http://www.exampleurl.com/images/{header_hex}.gif) #{header_hex};">
> <a href="{url}" style="font-weight:bold;font-size:14pt;color:#0066ff; text-decoration:none;" target="_blank" >{item}</a>
> </div>
> </div> 
> ```

感激地收到任何想法......谢谢。

编辑添加：

我在将视频嵌入到我的信息窗口时也遇到了问题。只有一个视频 - 在下面地图链接东边的黄色标记上。（在该标记的信息窗口中显示了一个损坏的图像，就在视频应该在的位置上方，因为该图像尚未上传）。我正在使用的视频嵌入代码是：

```
<iframe width="300" height="165" src="http://www.youtube.com/embed/-yYLLb53V8E?rel=0" frameborder="0" allowfullscreen></iframe> 
```

我正在使用 Fusion Tables（实验性），我的信息窗口布局是：

```
<div class='googft-info-window' style='font-family:sans-serif; color:#666; width:495px; padding:0px; margin:0px;'>

<div style="width:495px; background:url(http://www.responsibletravel.com/imagesclient/{header_hex}.gif) #{header_hex};"><div style="padding:8px;">
<a href="{url}" style="font-weight:bold;font-size:14pt;color:#0066ff; text-decoration:none;" target="_blank" >{item}</a>
</div></div>

<div style="float:left; width:330px; padding-top:10px;">
<div style="width:330px; padding-bottom:15px;">{description}</div>
<div style="width:330px; padding-bottom:15px;"><a href="{url}" style="color:#0066ff; text-decoration:none;" target="_blank" >Read more about this {type}</a></div>
<div style="width:330px;">{enquiry_url}</div>
<div style="width:330px;"><a href="{review_url}" target="_blank" >{stars}</a> <a href="{review_url}" style="color:#0066ff; text-decoration:none;" target="_blank" >{reviews}</a></div>
<div style="float:left; width:110px; padding-top:10px">
<span style="font-weight:bold; font-size:11px">Share this:</span><br>
<a href="http://www.facebook.com/sharer.php?u={url}&t={item}" style="color:#0066ff; text-decoration:none;" target="_blank"><img src="http://www.responsibletravel.com/imagesclient/facebook-button-26.gif" style="border:0; padding:5px 5px 5px 0px;"></a>
<a href="http://twitter.com/home?status={item}+{url}+%28via+%40r_travel%29" style="color:#0066ff; text-decoration:none;" target="_blank"><img src="http://www.responsibletravel.com/imagesclient/twitter-button-26.gif" style="border:0; padding:5px 5px 5px 0px;"></a>
</div>
<div style="float:left; width:100px; padding-top:26px">{xsell_icon_1}</div>
</div>

<div style="float:right; width:160px; padding-top:10px;">
<div style="float:right; padding-top:10px"><a href="{url}" target="_blank" ><img src='{image_S}' width='148' style='float:right; vertical-align:top; border:0'alt="{item}"/></a></div>
<div style="float:right; padding-top:5px">{video_embed}</div>
<div style="float:right; padding-top:10px"><a href="http://www.visitbrighton.com" target="_blank"><img src="http://www.responsibletravel.com/imagesclient/visit-brighton-logo-148x58.gif" style="border:0; width:148px;"></a></div>
</div>

</div> 
```

地图在这里（一些信息仍在填充，但你明白了）：

[https://www.google.com/fusiontables/embedviz?viz=MAP&q=select+col0+from+1r9PzOl93v_3amDCSXBHJcWhMCK6X9BufzF4TJhM&h=false&lat=50.82791056751128&lng=-0.14479637145996094&z=15&t=t=1colt=1colt](https://www.google.com/fusiontables/embedviz?viz=MAP&q=select+col0+from+1r9PzOl93v_3amDCSXBHJcWhMCK6X9BufzF4TJhM&h=false&lat=50.82791056751128&lng=-0.14479637145996094&z=15&t=1&l=col0&y=1&tmplt=1)

谢谢...

# javascript - 如何使用 javascript 将 html 中的表单字段转换为 UTF8？

> ID：11123347
> 
> 赞同：1
> 
> 时间：2012-06-20T15:51:13.783
> 
> 标签：javascript, html, forms, utf-8, character-encoding

我不得不说我在 HTML 和 javascript 方面完全是新手。但是我必须修复不属于我的代码中的一个小错误。

我有一个 html 表单在 iso8859-1 中发送一些数据。我只需要在发送表单之前将其中一个字段转换为 UTF8。我已阅读有关 javascript 函数 utf8_encode() 的信息。我应该在我的 html 代码中在哪里应用该函数？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T16:09:36.063

无处可去 :) 作为[标准](http://www.w3.org/TR/html401/interact/forms.html "w3.org")状态，html 表单具有可选属性 accept-charset。这通常默认为响应标头中服务器提供的值和`<head>`. 恕我直言，最简单的解决方案是将 utf-8 设置为某处排名最高的字符集。我假设您至少可以访问 html，因此您可以更改整个页面或仅表单的字符集。

如果你**真的**坚持使用 utf8_encode() 请注意，这个函数不是默认的 JavaScript 函数。您应该从输入中获取文本，对其进行编码，然后将原始文本替换为已编码。并且很可能会遇到其他编码问题

# magento - 导入带有特殊字符（例如 ® 和 ©）的名称/类别

> ID：11123349
> 
> 赞同：0
> 
> 时间：2012-06-20T15:51:26.620
> 
> 标签：magento, magmi

我有一个 .csv 文件，其中的产品名称和类别包含以下符号：©。当我使用 Magmi 导入 .csv 文件时，Magmi 始终切断符号和之后的所有内容。有谁知道原因以及如何在名称/类别中添加特殊符号？

先谢谢了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T20:58:25.950

显然 Excel 没有执行您需要的正确字符编码。我使用了 openOffice Calc（他们的 Excel 版本），然后将我的数据复制并粘贴到 openOffice 中。当您转到“另存为”时，将其保存为 .csv 文件，然后（在一系列提示之后）会询问您使用哪种编码。选择 UTF-8。上传并上路！

# java - 在Java中根据给定的String创建一个字节数组

> ID：11123352
> 
> 赞同：0
> 
> 时间：2012-06-20T15:51:29.973
> 
> 标签：java

我只需要从给定的字符串中创建一个字节数组。

例如，如果我的 String 是，`String ss = "21331UA";`那么字节数组元素应与它们对应如下。

```
2 1 3 3 1 U A 
```

我可以像这样静态地创建它。`byte[] arr = new byte[]{2,1,3,3,1,'U','A'}`但是必须在运行时动态地创建这个字节数组，因为它会不时改变。那就是问题所在。

我只是尝试如下并打印它们，它包含它们相应的 ASCII 值。**这不是我想要的。**

```
byte[] arr = ss.getBytes();

for(int i=0; i<arr.length; i++)
{
    System.out.print(arr[i] + "  ");
}
Ans==> 50  49  51  51  49  85  65 
```

非常感谢任何指导....在此先感谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-20T15:53:01.290

您可以像这样转换字节数组中的值：

```
System.out.print((char)arr[i] + "  "); 
```

或者，或者，立即将您的字节数组设置为字符：

```
char[] arr = ss.toCharArray();

for(int i=0; i<arr.length; i++)
{
    System.out.print(arr[i] + "  ");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T15:57:06.913

您需要 CAST`byte`为`char`数组类型`arr[i]`为`byte`.

简单地说

```
System.out.print((char) arr[i] + "  "); 
```

# javascript - Underscore.js 中的 if 条件语句

> ID：11123358
> 
> 赞同：7
> 
> 时间：2012-06-20T15:51:45.947
> 
> 标签：javascript, jquery, backbone.js, underscore.js

我将`_.template()`underscorejs的功能与backbonejs一起使用。使用 underscore.js v1.3.0 时，我可以使用`if`如下所示的语句：

```
<script type="text/template" id="tpl_listing_list_item">
    <% if(<%= address_2 %>){%>, <%= address_2 %><%}%>
</script> 
```

**问题：**更新到 v1.3.3 后，我`Uncaught SyntaxError: Unexpected token ILLEGAL`在 Javascript 控制台中收到错误消息。此功能是否已删除？删除`if`代码可修复错误。如果将其删除，是否有另一种方法可以实现相同的目标？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-20T16:01:02.330

在您的`if`声明中，您已经转义到插值模式，因此`<%=`是非法字符。

当我在带有 1.3.3 的浏览器中使用它时，这有效

```
<script type="text/template" id="tpl_listing_list_item">
    <% if(address_2){ %>, <%= address_2 %> <% } %>
</script> 
```

例子：

```
var t = _.template('{% if(address_2){ %}, {{ address_2 }} {% } %}')
undefined
t({'address_2': 'test'});
", test " 
```

（我们使用 JSP，所以我们的模板标签是`{% %}`, `{{ }}`, 而`{%- %}`不是默认值，所以请原谅我的标签）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-20T16:46:57.980

[tkone](https://stackoverflow.com/a/11123525/479863)是对的，但是对于像您这样的模板，您可以使用特殊[`print`功能](http://underscorejs.org/#template)来清理标签：

> 您也可以`print`在 JavaScript 代码中使用。这有时比使用更方便`<%= ... %>`。
> 
> ```
> var compiled = _.template("<% print('Hello ' + epithet); %>");
> compiled({epithet: "stooge"});
> => "Hello stooge." 
> ```

所以你可以像这样减少噪音：

```
<script type="text/template" id="tpl_listing_list_item">
    <% if(address_2){ print(', ', address_2) } %>
</script> 
```

演示：http: [//jsfiddle.net/ambiguous/UgATZ/](http://jsfiddle.net/ambiguous/UgATZ/)

# delphi - 为什么 SystemParametersInfo(SPI_SETNONCLIENTMETRICS, ...) 以前没有挂在 Windows 7 中？

> ID：11123369
> 
> 赞同：4
> 
> 时间：2012-06-20T15:52:21.367
> 
> 标签：delphi, delphi-7, winapi

我有一些代码可以扩展在触摸屏 PC 上运行的应用程序的系统滚动条的大小。这段代码是用Delphi 7编写的，已经运行了好几年了，但是我发现在Windows 7上运行时似乎出现了问题。

代码如下所示：

```
procedure SetLargeScrollBars();
type
    // Extended NONCLIENTMETRICS structure not defined in Delphi 7's Windows.pas
    tagNONCLIENTMETRICSXA = packed record
        cbSize: UINT;
        iBorderWidth: Integer;
        iScrollWidth: Integer;
        iScrollHeight: Integer;
        iCaptionWidth: Integer;
        iCaptionHeight: Integer;
        lfCaptionFont: TLogFontA;
        iSmCaptionWidth: Integer;
        iSmCaptionHeight: Integer;
        lfSmCaptionFont: TLogFontA;
        iMenuWidth: Integer;
        iMenuHeight: Integer;
        lfMenuFont: TLogFontA;
        lfStatusFont: TLogFontA;
        lfMessageFont: TLogFontA;
        // This member not supported for Windows Server 2003 and Windows XP/2000
        iPaddedBorderWidth: Integer;
    end;
    NONCLIENTMETRICSX = tagNONCLIENTMETRICSXA;
var
    ncm: NONCLIENTMETRICSX;
    osvi: OSVERSIONINFO;
const
    LARGE_SCROLL_DIM = 48;
begin
    // Zero the NONCLIENTMETRICS type and fill in its size
    ZeroMemory(@ncm, Sizeof(ncm));
    ncm.cbSize := SizeOf(ncm);

    // This is necessary because SystemParametersInfo works differently for 
    // Windows Server 2008, Windows Vista and after.
    ZeroMemory(@osvi, SizeOf(osvi));
    osvi.dwOSVersionInfoSize := SizeOf(osvi);
    GetVersionEx(osvi);

    if (osvi.dwMajorVersion < 6) then
    begin
        ncm.cbSize := ncm.cbSize - SizeOf(ncm.iPaddedBorderWidth);
    end;

    // Seems to return true all the time.
    SystemParametersInfo(
        SPI_GETNONCLIENTMETRICS,
        Sizeof(ncm),
        @ncm,
        0);

    if (ncm.iScrollWidth <> LARGE_SCROLL_DIM) then
    begin
        // Save the scrollbar width and height for restoration when the application closes.
        m_ScrollWidth := ncm.iScrollWidth;
        m_ScrollHeight := ncm.iScrollHeight;

        ncm.iScrollWidth := LARGE_SCROLL_DIM;
        ncm.iScrollHeight := LARGE_SCROLL_DIM;

        // This call never returns...
        SystemParametersInfo(
            SPI_SETNONCLIENTMETRICS,
            Sizeof(ncm),
            @ncm,
            SPIF_SENDCHANGE);
    end;
end; 
```

奇怪的是滚动条大小实际上是设置的，所以看起来 SystemParametersInfo 正在做它应该做的事情，但在那之后似乎变得困惑。

由于在函数中检查滚动条是否已经展开，因此应用程序第二次及之后运行良好（除非通过将主题恢复为原始主题来重置滚动条）。

我想知道它是否与最后一个参数（fWinIni）有关，并尝试了所有各种值，包括零，但无济于事。

也许在更改设置后，Windows 7 会与早期版本的操作系统有所不同？话虽如此，我还没有在 Vista 上尝试过，所以也许同样的事情也会发生在那里。它可能与为 Windows Vista、Windows Server 2008 和后续版本添加 iPaddedBorderWidth 有关 - 请参阅[NONCLIENTMETRICS 结构](http://msdn.microsoft.com/en-us/library/ms724506%28VS.85%29.aspx)

[在 MSDN Problem Changeing size of scrollbars using SystemParametersInfo(SPI_SETNONCLIENTMETRICS)](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/7da5c8df-7320-4eff-bfb7-14a60b655335)上有一个类似的问题，从 .NET 的角度来看同样的情况，但到目前为止还没有答案。

* * *

# 更多信息

我使用 DebugDiag 对相关应用程序执行挂起分析，它显示以下堆栈跟踪：

> **Function**
> ntdll!KiFastSystemCallRet uxtheme
> !Ordinal45+25d
> uxtheme!BeginBufferedAnimation+25b
> user32!SystemParametersInfoA+40
> programName
> +13024f programName
> +117c8d programName+6ae72 programName
> +727dc programName
> +132645
> kernel32!BaseThreadInitThunk+12
> ntdll!RtlInitializeException !Chain+efChainnt+
> cdllR

所以看起来好像挂起发生在 uxtheme!Ordinal45+25d 中——大概是在某种系统调用中。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-07-03T13:55:05.040

也许问题是由另一个窗口引起的。您正在`SystemParametersInfo`使用`SPIF_SENDCHANGE`-parameter 调用。这会导致`WM_SETTINGSCHANGE`使用 广播消息`SendMessage`。当有一个窗口不响应此消息时，调用`SystemParametersInfo`将挂起。请阅读旧新事物的[这个条目](http://blogs.msdn.com/b/oldnewthing/archive/2005/03/10/392118.aspx)。

# max - 使用 max/min 函数来记住 Google Docs 中动态数据的高点/低点

> ID：11123370
> 
> 赞同：0
> 
> 时间：2012-06-20T15:52:23.193
> 
> 标签：max, google-docs, min

在 Google 电子表格中，如何检索包含动态数据的单元格的最大值和最小值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T15:56:31.343

使用 DMAX 和 DMIN

[https://support.google.com/docs/bin/static.py?hl=en&topic=25273&page=table.cs](https://support.google.com/docs/bin/static.py?hl=en&topic=25273&page=table.cs)

# jquery - 在 jQuery DataTables 中保留搜索条件

> ID：11123373
> 
> 赞同：1
> 
> 时间：2012-06-20T15:52:29.287
> 
> 标签：jquery

我是 jQuery 数据表的新手。我正在开发一个使用数据表的现有项目。在一个这样的屏幕上，当在搜索文本框中输入值时，会在全局以及列上进行过滤。目前在我的应用程序中，每次我点击此屏幕时，搜索文本框都会显示为空白。这不是预期的行为。我想保留搜索文本，以便下次访问此屏幕时，不必再次键入搜索条件。是否应该设置 DataTable 的特定属性以重置搜索文本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:59:48.017

您是否尝试过 DataTables 的状态保存选项：[http](http://datatables.net/release-datatables/examples/basic_init/state_save.html) ://datatables.net/release-datatables/examples/basic_init/state_save.html ？

# php - PHP OOP 中每个表一个对象？

> ID：11123376
> 
> 赞同：0
> 
> 时间：2012-06-20T15:52:34.670
> 
> 标签：php, database, oop

我想知道在 PHP 中为数据库上的每个表创建一个对象（一个类）是个好主意。

例如，我有 3 个表：用户、视频、评分

Rating 只是一个表格，其中包含**idUser**、**idVideo**和用户对视频的**评分。**可以说，它与转换为数据库表的属性的关系。

我在我的系统上创建了两个类：**user**，**video**

我应该创建另一个评级类吗？或者我应该通过用户或视频内部的方法获取评级信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T15:57:02.903

**是**的，创建一个类。

即使优势不明显，当您必须添加其他属性（例如“DateVoted”）时，它也会非常有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T16:02:25.510

正如 Tyler Eaves 在评论中提到的，不要像很多人那样重新发明类似 ORM 的系统。使用[Propel](http://www.propelorm.org)或[Doctrine之类的东西](http://www.doctrine-project.org/)

# unit-testing - TestNG @Factory 和 group-by-instances 和保留顺序

> ID：11123378
> 
> 赞同：2
> 
> 时间：2012-06-20T15:52:45.060
> 
> 标签：unit-testing, selenium, selenium-webdriver, testng

我正在尝试第一次将 TestNG 与 @Factory 一起使用，但对我来说不起作用，我会告诉你为什么。

我有一个名为 Extend 的类，其中我有一些测试，“启动站点”，“登录”，“检查用户是否在他自己的仪表板中”等等，我希望对于从工厂传递的所有数据，这些命令测试总是相同的“启动站点”>>“登录”>>“检查用户在他的仪表板中”>>“注销”好吗？所以我有以下extend.xml 文件和类：

```
 <suite name="ExtendFactory"  group-by-instances="true">
              <test name="Factory"  preserve-order="true" group-by-instances="true"> 
                <classes>
                  <class name="net.whaooo.ExtendFactory">
                    <methods>
                      <include name="launchSite"></include>
                      <include name="loginTest" />
                      <include name="userIsInHisOwnDashboardTest" />
                      <include name="logoutTest" />
                    </methods>
                  </class>
                </classes>
              </test>
            </suite> 
```

扩展类：

```
 public class Extend extends BaseTest{
            protected static FirefoxDriver driver;
            private String a_driver;
            private String password;

            public Extend(String a_driver, String pwd){
                this.a_driver = a_driver;
                this.password = pwd;
            }
            @BeforeTest
            public void stDriver() {
                DesiredCapabilities caps = DesiredCapabilities.firefox(); caps.setCapability(CapabilityType.ForSeleniumServer.ENSURING_CLEAN_SESSION, true); 
                driver = new FirefoxDriver(caps);
                driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);
            }
            @AfterTest
            public void stopDriver() {
                driver.close();
            }   
            @Test
            public void launch() {
                launchSite(driver);
            }
            @Test (description = "Enter a valid login as driver")
            public void loginTest() {
                login(driver, a_driver, password);
            }
            @Test (description = "Check the driver is in his own dashboard")
            public void userIsInHisOwnDashboardTest(){
                userIsInHisOwnDashboardTest(driver, a_driver, password);
            }
            @Test(description="logout")
            public void logout(){
                logoutTest(driver);
            }
        } 
```

简化工厂：

```
 public class ExtendFactory {
      @Factory
      public Object[] createInstances() {
           Object[] result = new Object[2]; 
              result[0] = new Extend("test1@test.com","tester");
              result[1] = new Extend("test2@test.com","tester");
            return result;
          }
    } 
```

但我的问题是，即使我插入子句 preserve-order="true" group-by-instances="true"，启动测试的顺序也不遵循 xml 文件中指定的顺序，我也试过了使用 order-by-instances="true"。谁能帮我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T13:06:19.193

我认为您需要在测试用例中使用dependsOnMethods，因为您提到的流程，如果第一个方法没有执行，则执行第二个测试用例没有意义。即如果“启动站点”失败，则无需执行“登录”。这也将确保执行顺序。查看[依赖方法](http://testng.org/doc/documentation-main.html#dependent-methods)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T20:52:47.643

我一直在使用

```
@Test(dependsOnMethods = "TestName") 
```

其中“TestName”是运行的先决条件测试。因此，对于您的登录测试，它应该具有以下注释：

```
@Test(dependsOnMethods = "launchSite") 
```

我连续运行 9 次测试，并且自从添加了dependsOnMethods 后，所有测试都按顺序运行，没有任何问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T11:00:16.557

感谢您的回答，我最终使用@Factory 指定“order-by-instances="true"”，而不是在动态对象中插入依赖项！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-10T14:34:05.230

我看到了很多问题......首先@Factory 与 group-by-instance="true" 搞砸了整个测试（它只执行一个实例并且只执行非依赖方法）。

`@Factory`无需按实例分组即可工作，但它首先执行所有非依赖方法，而与实例数量无关。例如..`Class A {@Test public void a() {} @Test(dependsOnMethod="a") public void b() {}}...`随之`@Factory`返回两个实例..然后执行是`ref1.a, ref2.a, ref1.b, ref2.b.`这有严重的问题..说A类使用大量内存然后确保它会在执行所有之前用完。

ps：不知道是不是eclipse的问题。我正在使用 testng 6.8.1 ps2：似乎 testng 打算进行回归..但它仍然不存在..`@Factory`它自己的类也不支持它的回归 (工厂不能设置相同）或由第三方设置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-18T07:02:28.637

在 TestClass 文件中使用依赖不是一个解决方案，因为不依赖于任何其他函数的函数仍然是随机执行的。我需要按照我提到的顺序执行测试用例。这可以在使用 TestNG 执行时使用“preserve-order”来实现，但在 TestNG 中使用分组时会失败。

如果有人可以帮助解决这个问题，请回复。

# php - 在 $_SESSION 中保存页面 ID

> ID：11123379
> 
> 赞同：1
> 
> 时间：2012-06-20T15:52:58.950
> 
> 标签：php, session

我是会话的新手，并且认为我了解了它们的基础知识，它们似乎就像容器一样，其中包含您可以在稍后阶段使用的信息并链接到您的 UID。

我想知道如何在单击按钮时保存页面的 ID（例如 ID123），以及标题中的确切代码。

非常感谢提前！

编辑：

这是在 wordpress 上，很抱歉添加这个，每个页面都有一个“事件 ID”我希望这个被存储以供以后使用（在一种结帐页面上）抱歉没有添加这个！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T15:56:11.693

> 在 $_SESSION 中保存页面 ID

```
session_start();
$_SESSION['pageId'] = (int) $_GET['ID']; 
```

现在您可以使用`$_SESSION['pageId']`它在您需要的地方获取它的值。

确保将使用与会话相关的函数或数组放在`session_start();`脚本顶部。`$_SESSION`

要在您不再需要它时取消设置，您可以：

```
unset($_SESSION['pageId']);
session_destroy();
session_regenerate_id(); 
```

* * *

# 更新

单击按钮时，您将执行以下操作：

```
var btn = document.getElementById('btnId');
btn.onClick = function() {
  window.location = 'saveSession.php?id=xxx' // replace xxx with your id value
}; 
```

现在，`saveSession.php`您将不得不使用如上所示的代码将其存储在会话中。

不过，您也可以使用 Ajax。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T17:53:22.320

在 wordpress 中，您不能传递自定义 url 参数。所以你不能发送类似 [http://yourwordpresswebsite.com/?custom_param='value](http://yourwordpresswebsite.com/?custom_param=) '

Wordpress 不允许。所以，如果你想要的只是一个帖子 ID 或一个页面 ID。在wordpress中很容易抓取。做：

```
$val= $post->ID 
```

就是这样， $val 已设置。如果我必须将任何自定义参数发送到不同的文件，我的做法是将其作为表单变量发送。可能有更好的方法，但我也是 Wordpress 和 php 的新手。所以这就是我所做的：

```
<?php
echo "<form action='php_file.php' method='post' name='form_name'>
<input type='hidden' name='eventid' value='$event_id' />
<input type='submit' name='submit' value='submit'/>
</form>";

?> 
```

如果您希望这是您的会话信息，您可以将其添加到您收集上述字段的 php 文件中。

```
session_start();
$_SESSION['pageId'] = (int) $_GET['eventid'];

/*  Do not forget to check if the get variable is clean before you perform any operations, use mysql_real_escape_string(). It is a very important security measure. */ 
```

这可能不是最好的方法，因为我告诉过你我也是 wordpress 的新手。

# wordpress - 是否可以在 Bitnami MAMP 堆栈中安装 WordPress 多站点？

> ID：11123384
> 
> 赞同：0
> 
> 时间：2012-06-20T15:53:22.627
> 
> 标签：wordpress, mediawiki, wiki, mamp, bitnami

我正在使用 Bitnami 的 MAMP 堆栈在 OSX 中本地开发 WordPress 和 MediaWiki，但我需要一个安装了 WordPress*多站点*和 MediaWiki 的堆栈。Bitnami 的站点有一个 WordPress 多站点 (http://bitnami.org/stack/wordpress) 的安装程序，但这是一个独立的堆栈，他们拥有的唯一模块是用于常规 WordPress。仅在该安装的 wp-config 中启用多站点不起作用。有没有办法做到这一点？我可以独立安装 WordPress Multisite，将其移动到 MAMP 堆栈的应用程序文件夹并在 wp-config 中设置适当的 mySQL 设置吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T16:04:07.550

有可能的。尝试安装 WordPress Multisite Stack，然后在其上安装 Mediawiki 模块。我希望它有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T18:49:03.927

[http://bitnami.org/stack/wordpress/](http://bitnami.org/stack/wordpress/)转到亚马逊系统映像部分。选择您所在的地区，然后单击 Ubuntu EBS 32-bit 下的 ami 链接

# ruby - “||=”是如何工作的？

> ID：11123385
> 
> 赞同：0
> 
> 时间：2012-06-20T15:53:24.460
> 
> 标签：ruby

> **可能重复：**
> [||=（或等于）在 Ruby 中是什么意思？](https://stackoverflow.com/questions/995593/what-does-or-equals-mean-in-ruby)

我正在学习 Ruby，对以下代码感到困惑。我可以理解它的作用，但无法理解它是如何工作的。

```
h = Hash.new
h['key1'] ||= 'value1'
=> "value1"

p h
=> {"key1"=>"value1"} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T16:38:51.553

给定一个`Hash`：

```
hash = {} 
```

这个表达式：

```
hash[:key] ||= :value 
```

扩展为：

```
hash[:key] || hash[:key] = :value 
```

Ruby 的逻辑运算符[shortcircuit](http://en.wikipedia.org/wiki/Short-circuit_evaluation)，这意味着只有当且仅当是or`hash[:key] = :value`时才会执行。`hash[:key]``false``nil`

如果它是其他任何东西，它的值本身就足以确定[逻辑析取](http://en.wikipedia.org/wiki/Logical_disjunction)的结果，并且不会计算表达式的其余部分。

这*根本*不同于：

```
hash[:key] = hash[:key] || :value 
```

在这种情况下，该`[]=`方法将被调用任何一种方式，唯一的区别是它将接收哪个参数：`:value`如果`hash[:key]`是`false`or ，否则它本身`nil`的值。`hash[:key]`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-20T16:06:36.263

它是一个*缩写的赋值伪操作符*。其中有十一个；最常见的是：

```
x += y #expands to x = x+y 
```

`||=`以同样的方式进行：

```
x ||= y expands to x = x||y 
```

它适用于 +, -, *, /, %, ** , &&, ||, &, |, ^, <<, >>。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-06-20T16:00:33.653

中的默认值`Hash.new`是`nil`

所以`h['key1'] ||= 'value1'`作为“如果key='key1'还没有对应的值，让值是'value1'”

# actionscript-3 - Action Script 3.0 gotoAndStop() 不与其内容同步

> ID：11123386
> 
> 赞同：0
> 
> 时间：2012-06-20T15:53:26.033
> 
> 标签：actionscript-3, actionscript, frame

我有一个movieClip，它有3 帧。当我调用`mc.init();`mc movieClip 时，应该检查当前语言并转到特定帧。
例如，当前语言是“tw”，跟踪正确返回 2。但是，屏幕上显示的是第 1 帧的内容。我仍然可以在第 1 帧内跟踪电影剪辑。

谁能告诉我问题的原因？？

# mc (电影剪辑)

```
function changeLanguage(){
if (currentLang =='en'){
gotoAndStop(1);
}else if (currentLang=='tw'){
gotoAndStop(2);
}else if (currentLang=='fr'){
gotoAndStop(3);
}

trace(this.currentFrame);

}

function init(){
changeLanguage();
} 
```

# 主文件

```
mc.init(); 
```

# 2012 年 6 月 21 日凌晨 2:23 添加

我发现它可以 gotoAndStop(3) 没有任何问题，只有从 frame2 到 frame1 有问题。

# java - 用于异步服务器的 Java NIO 和多线程

> ID：11123388
> 
> 赞同：3
> 
> 时间：2012-06-20T15:53:33.587
> 
> 标签：java, multithreading, concurrency, css-selectors, nio

我一直在尝试将 NIO 与多线程读取处理配对，以制作可扩展的服务器。我不能使用任何框架，例如 Netty 或 MINA，因为有几个低级别的客户端-服务器协议细节在任何一个框架中都很难实现。我只是在检查我的代码，我意识到这个片段中有一个潜在的竞争条件：

```
//executes in selector thread
public void runSelector() {
    //...
    Set<SelectionKey> keys = selector.selectedKeys();
    for (Iterator<SelectionKey> keyIter = keys.iterator(); keyIter.hasNext(); ) {
        final SelectionKey key = keyIter.next();
        keyIter.remove();
        if (key.isValid() && key.isReadable()) { //point A
            //maybe some other short calculations
            ((SocketChannel) key.channel()).read(buffer); //point B
            workerThreadPool.submit(new Runnable() { public void run() { processRead(key, buffer); } });
        }
    }
    //...
}

//executes in a worker thread
private void processRead(SelectionKey key, ByteBuffer buf) {
    //... somewhere
    key.cancel();
    //...
} 
```

这是一个极不可能发生的事件，但完全有可能在工作线程中，我调用 key.cancel() 而选择器线程位于我在 runSelector() 方法中注释的两点之间。请记住，这可以部署在高并发机器上，并且运行选择器线程的 CPU 内核可能会陷入困境。在选择器线程中的 key.isReadable() 和 channel.read() 之间的工作线程中调用 key.cancel() 并导致 CancelledKeyException 是否是一个有效的担忧？我是否应该有某种线程安全的集合来存储所有要取消的键，以便 runSelector() 可以在迭代结束时取消所有键？像 Netty 或 MINA 这样更专业的项目是如何处理这种情况的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T16:17:08.467

锁定资源，

```
synchronized(key) {
    ((SocketChannel) key.channel()).read(buffer); //point B
} 
```

如果这看起来很奇怪，请查看[这个](http://docs.oracle.com/javase/tutorial/essential/concurrency/sync.html)关于并发的 Oracle 教程。

# list - Scala 的 equals 方法在 List 的情况下如何工作？

> ID：11123393
> 
> 赞同：24
> 
> 时间：2012-06-20T15:53:54.710
> 
> 标签：list, scala, equals

```
list1 == list2 
```

要进行上述检查，Scala 会遍历两个列表并在每对元素上调用 equals 吗？

（我敢肯定，这个问题以前有人问过，但我在 Google & Co 上找不到好的答案）

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-06-20T16:01:42.390

通过查看 Scaladoc 并找出它的定义位置，然后查看源代码，您可以自己找到任何方法。如果您从[在线文档](http://www.scala-lang.org/api/current/index.html)开始，您只需单击即可完成所有操作：转到方法，单击左侧的箭头将其打开，您将看到覆盖类的列表。转到第一个，并查看源代码。

无论如何，在这种情况下，`GenSeqLike`，`List`以及许多其他集合的超特征，定义`equals`为`canEqual`检查后跟`sameElements`. 反过来，`sameElements`检查两个参数是否都是`LinearSeq`s，如果是，则通过将头部和尾部一一分开来对每对元素调用 equals。否则，它默认使用迭代器，调用`hasNext`每个迭代器，然后将元素与`equals`.

所以，长话短说：是的，它在每对元素上调用 equals （一旦发现不匹配就停止）。

# backbone.js - 在 Backbone.js 中使用 localStorage

> ID：11123394
> 
> 赞同：8
> 
> 时间：2012-06-20T15:53:58.493
> 
> 标签：backbone.js, local-storage

我正在整理一个主干示例，其中创建模型并编辑和删除。我能够将新模型和编辑保存到本地存储，但是在刷新本地存储以正确显示时遇到问题。它似乎是作为单个对象加载的，因此无论添加了多少，都给了我一个模型。

```
 var Thing = Backbone.Model.extend({
     defaults: {
         title: 'blank'
     }
 });
 var ThingView = Backbone.View.extend({
     template: _.template('<b><button id="remove">X</button> <b><button id="edit">Edit</button> <%= title %></b>'),
     editTemplate: _.template('<input class="name" value="<%= name %>" /><button id="save">Save</button>'),
     events: {
         "click #remove": "deleteItem",
         "click #edit": "editItem",
         "click #save": "saveItem",
     },
     deleteItem: function () {
         console.log('deleted');
         this.model.destroy();
         this.remove();
     },
     editItem: function () {
         console.log('editing');
         this.$el.html(this.editTemplate(this.model.toJSON()));
     },
     saveItem: function () {
         console.log('saved');
         editTitle = $('input.name').val();
         console.log(editTitle);
         this.model.save({
             title: editTitle
         });
         this.$el.html(this.template(this.model.toJSON()));
     },
     render: function () {
         var attributes = this.model.toJSON();
         this.$el.append(this.template(attributes));
         return this;
     }
 });
 var ThingsList = Backbone.Collection.extend({
     model: Thing,
     localStorage: new Store("store-name"),
 });
 var storeVar = localStorage.getItem("store-name");
 console.log(storeVar);
 var thingsList = new ThingsList;
 thingsList.reset(storeVar);
 var ThingsListView = Backbone.View.extend({
     el: $('body'),
     events: {
         'click #add': 'insertItem',
     },
     initialize: function () {
         this.render();
         this.collection.on("add", this.renderThing, this);
     },
     insertItem: function (e) {
         newTitle = $('input').val();
         newThing = new Thing({
             title: newTitle
         });
         this.collection.add(newThing);
         newThing.save();
         console.log(this.collection.length);
     },
     render: function () {
         _.each(this.collection.models, function (items) {
             this.renderThing(items);
         }, this);
     },
     renderThing: function (items) {
         var thingView = new ThingView({
             model: items
         });
         this.$el.append(thingView.render().el);
     }
 });
 var thingsListView = new ThingsListView({
     collection: thingsList
 }); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-20T16:15:25.433

您需要将项目添加到您的集合中，然后要读取它，您需要调用 fetch。您的对象中还有几个额外的尾随逗号。

这是您的代码稍作修改的版本，似乎可以正常工作。

```
var Thing = Backbone.Model.extend({
  defaults:{
    title:'blank'
  }
 });

 var ThingView = Backbone.View.extend({
    //el: $('body'),
     template: _.template('<b><button id="remove">X</button> <b><button id="edit">Edit</button> <%= title %></b>'),
     editTemplate: _.template('<input class="name" value="<%= name %>" /><button id="save">Save</button>'),

    events: {
    "click #remove": "deleteItem",    
    "click #edit": "editItem",
    "click #save": "saveItem",
    },

    deleteItem: function(){
      console.log('deleted');

            this.model.destroy();
            //remove view from page
            this.remove();
    },

    editItem: function(){
     console.log('editing');
     this.$el.html(this.editTemplate(this.model.toJSON())); 
    },

    saveItem: function(){
     console.log('saved');
     editTitle = $('input.name').val();
     console.log(editTitle);
     this.model.save({title: editTitle});
     this.$el.html(this.template(this.model.toJSON()));
    },

    render: function(){
      var attributes = this.model.toJSON();
      this.$el.append(this.template(attributes));
      return this;
    }
 });

 var storeVar = localStorage.getItem("store-name");

 var ThingsList = Backbone.Collection.extend({
   model: Thing,
   localStorage: new Store("store-name")
});

 var things = [
  { title: "Macbook Air", price: 799 },
  { title: "Macbook Pro", price: 999 },
  { title: "The new iPad", price: 399 },
  { title: "Magic Mouse", price: 50 },
  { title: "Cinema Display", price: 799 }
];

console.log(things);

var thingsList = new ThingsList;

var ThingsListView = Backbone.View.extend({
   el: $('body'),

events: {
      'click #add': 'insertItem'
    },

initialize: function () {
    this.render();
    this.collection.on("add", this.renderThing, this);
    },

    insertItem: function(e){
      newTitle = $('input').val();
      newThing = new Thing({ title: newTitle });
      this.collection.add(newThing);
      newThing.save();
      //this.model.saveItem;
      console.log(this.collection.length);
    },

   render: function(){
     _.each(this.collection.models, function (items) {
            this.renderThing(items);
        }, this);
    },

  renderThing: function(items) {
    //console.log('added something');
    var thingView = new ThingView({ model: items }); 
        items.save();
    this.$el.append(thingView.render().el); 
  }

});

var thingsListView = new ThingsListView( {collection: thingsList} );
thingsList.fetch();
console.log(thingsList.toJSON());
thingsList.reset(things); 
```

**编辑：**我看到您正在尝试读取存储在“store-name”下的本地存储中的值，backbone-localStorage 的工作方式是它使用商店的名称（在您的情况下为“Store-name”）来存储其余模型的 id，然后将每个模型保存在商店名称和 id 的组合下，所以假设你有三个模型，你最终会在本地存储中有 4 个条目，

```
 localStorage["store-name"]  //id1, id2, id3"
  localStorage["store-name-id1"] //model with id1
  localStorage["store-name-id2"] // model with id2
  localStorage["store-name-id3"] // model with id3 
```

**编辑 2**

[这是您的代码的jsfiddle](http://jsfiddle.net/ma7Pu/)的链接，首先我将`thingsList.fetch();`注释掉该行，取消注释该行并注释掉`thingsList.add(things);`并再次运行它，它应该从本地存储中提取模型（我在那里留下了一个警报） .

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-27T14:51:26.837

```
var Thing = Backbone.Model.extend({
     defaults: {
         title: 'blank'
     }
 });
 var ThingView = Backbone.View.extend({
     template: _.template('<b><button id="remove">X</button> <b><button id="edit">Edit</button> <%= title %></b>'),
     editTemplate: _.template('<input class="name" value="<%= name %>" /><button id="save">Save</button>'),
     events: {
         "click #remove": "deleteItem",
         "click #edit": "editItem",
         "click #save": "saveItem",
     },
     deleteItem: function () {
         console.log('deleted');
         this.model.destroy();
         this.remove();
     },
     editItem: function () {
         console.log('editing');
         this.$el.html(this.editTemplate(this.model.toJSON()));
     },
     saveItem: function () {
         console.log('saved');
         editTitle = $('input.name').val();
         console.log(editTitle);
         this.model.save({
             title: editTitle
         });
         this.$el.html(this.template(this.model.toJSON()));
     },
     render: function () {
         var attributes = this.model.toJSON();
         this.$el.append(this.template(attributes));
         return this;
     }
 });
 var ThingsList = Backbone.Collection.extend({
     model: Thing,
     localStorage: new Store("store-name"),
 });
 var storeVar = localStorage["store-name-7ee7d1e3-bbb7-b3e4-1fe8-124f76c2b64d"];
 console.log(storeVar);
 var thingsList = new ThingsList;
 //thingsList.reset(storeVar);
 var ThingsListView = Backbone.View.extend({
     el: $('body'),
     events: {
         'click #add': 'insertItem',
     },
     initialize: function () {
    thingsList.fetch();
    thingsList.toJSON();
         this.render();
         this.collection.on("add", this.renderThing, this);
     },
     insertItem: function (e) {
         newTitle = $('input').val();
         newThing = new Thing({
             title: newTitle
         });
         this.collection.add(newThing);
         newThing.save();
         console.log(this.collection.length);
     },
     render: function () {
         _.each(this.collection.models, function (items) {
             this.renderThing(items);
         }, this);
     },
     renderThing: function (items) {
         var thingView = new ThingView({
             model: items
         });
         this.$el.append(thingView.render().el);
     }
 });
 var thingsListView = new ThingsListView({
     collection: thingsList
 }); 
```

# cocoa - 当绑定的 NSMutableArray 更新时，有一个 NSComboBox 进行更新

> ID：11123397
> 
> 赞同：0
> 
> 时间：2012-06-20T15:54:08.517
> 
> 标签：cocoa, cocoa-bindings, nscombobox

假设我有一个带有 2 个组合框的窗口。控制窗口的`NSWindowController`，有两个可变数组绑定到组合框内容值。

我想要的是，虽然第一个组合框具有固定值，但第二个组合值取决于第一个组合选择值。

当关联的可变数组更新时，我应该怎么做才能让第二个组合框重新加载其内容（或者我应该如何更新数组以实现这一点？）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T16:01:05.610

如果您通过其普通访问器方法设置第二个数组的值，则应将正确的更新消息传播到所有绑定值和其他侦听器。

```
// When first combo box changes value
// NSArray *newArray = // Fancy algorithm..
self.secondArray = newArray; 
```

这应该让第二个组合框更新。

如果您不想更改`NSMutableArray`支持您的属性的实例，您可以使用可变访问器方法，在[此处](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/KeyValueCoding/Articles/AccessorConventions.html)讨论。它们将允许您在不更改数组本身的情况下更改可变数组的内容。KVC/KVO 系统会将更改传播给侦听器。

# ipad - 在 iPad 应用程序中下载大量图像

> ID：11123400
> 
> 赞同：0
> 
> 时间：2012-06-20T15:54:30.610
> 
> 标签：ipad, ios5

我正在开发一个应用程序，我需要在本地下载大量图像（以便它们可以离线使用）。图像的数量可以是 100 - 10,000。每个图像可能从 100K 到 250K 不等

我可以通过 NSOperationQueue 做到这一点，并且我已经有代码可以完成这项工作，但这个问题更多的是概念性的。我不确定在这里采取的最佳方法是什么。

1) 用户第一次登录后，我是否会立即下载所有图像？根据图像的数量，这可能需要很长时间，如果用户同时关闭应用程序会怎样。我知道在这种情况下后台进程可以花费的时间有限制吗？老实说，我不想在后台做任何事情（即当应用程序关闭时）

2）当用户选择特定类别时，我是否下载图像？如果一个类别有 800 张图片，那么如果用户在所有这 800 张图片下载完成之前选择了另一个类别会发生什么？我总是可以开始下载线程，但是如果用户选择另一个类别，线程会继续运行吗？

3）在“设置”中放一些东西，让用户自己决定。像“总图像：8000”图像可用：2000 和一个按钮说“全部下载”将显示正在发生的事情的 UIProgressView....所以用户可能会等到它全部完成。

还是其他方法？

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T15:57:12.943

我只会在用户实际需要对图像做某事时下载图像。如果您预先下载所有图像，您的用户会讨厌您。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T16:07:50.633

据我从您的描述（包括评论）中了解到，我认为最好的方法是在一个线程中下载您的所有图像并使下载过程可恢复。通过这种方式，您将镜像一个远程图像数据库以供离线使用。

这意味着：

1.  您跟踪已下载的图像；

2.  每次应用程序启动/恢复时，您都将从您离开的位置开始下载线程；

3.  您还应该提供一种机制，以便用户在尝试访问尚未下载的图像时得到适当的通知，但我认为这应该没问题（您也可以在某处提供进度指示器）。

# c# - asp c#循环遍历动态数据表

> ID：11123401
> 
> 赞同：0
> 
> 时间：2012-06-20T15:54:39.823
> 
> 标签：c#, asp.net, foreach, datatable

asp c#
我有一个页面，用户选择一个项目及其要购买的数量和下一个项目等等，所有选择的项目都填写在数据表中，并 在用户单击处理按钮时
在选择项目结束时显示在gridview中 我想插入所有项目及其在数据库中的数量

在页面加载时，btn_Select_Click 上的数据表为空
我在 btn_Process_Click 上填充了几行
我想遍历这些行并在 db 中为每一行插入记录

但它返回零行

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T15:58:11.533

你的问题有点含糊。“但它返回零行”......我猜你的意思是，在你的按钮的点击处理程序中，当你访问你的网格对象时，它里面没有行？

请记住，页面的每次加载都会创建一整套全新的 Web 控件。Webcontrol 对象不会保留在内存中，以便在每次点击页面时重复使用。

如果您希望在单击按钮后正在呈现的新页面上可用相同的行，则必须重新绑定网格。我猜你的代码中没有发生这种情况。

# java - Unix - 解析 html 文件并获取他所有的资源列表

> ID：11123408
> 
> 赞同：1
> 
> 时间：2012-06-20T15:54:56.977
> 
> 标签：java, unix, sed, grep, html-parsing

我有一个 html 文件，我需要生成它使用的所有资源的列表：*.htm、*.html、*.css、*.js、*.jpg

我尝试了许多选项，例如 grep 和 sed，但没有太多成功。也不确定如何在 JAVA 中进行操作。

这是一个示例文件内容：

```
--------------------------------

>   <link rel="StyleSheet" href="css/webworks.css" type="text/css"
> media="all" />
>     <script type="text/javascript" language="JavaScript1.2"   src="wwhdata/common        /context.js">
>     /script>
>     <a class="WebWorks_Breadcrumb_Link" href="Page1.htm#1110364">Job Status</a> &gt;  Jobs tatus</div>
>     <div class="Indented"><a name="1115395">The <img class="Default"  src="images/Pic.2.jpg" width="26" height="29" style="display: inline;
 > float: none; left: 0.0; top: 0.0;" alt="" /> icon indicates that the
 > job is recurring. Hover the mouse over the icon to display the
     > schedule.</a></div>
 >     <div class="Body_Help_only"><a href="javascript:WWHClickedPopup('HelpSR2',   'Page4.htm#1110375', '');"
 > title="fsafsa" name="1118038">abcde</a></div>
 >     <div class="Body_Help_only"><a href="javascript:WWHClickedPopup('HelpSR2',   'Page2.htm#1110547', '');"
  > title="fsafsa" name="1118063">fsafsa</a></div>
  >     <div class="Body_Help_only"><a href="javascript:WWHClickedPopup('HelpSR2', 'Page3.htm#1110472', '');"
 > title="fsafasb" name="1118082">fsafsa</a></div> 
```

输出应该是：

```
-----------------
css/webworks.css
wwhdata/common/context.js
Page1.htm
images/Pic.2.jpg
Page4.htm
Page2.htm
Page3.htm 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T15:57:45.160

使用[JSOUP](http://jsoup.org/)

jsoup 是一个用于处理真实世界 HTML 的 Java 库。它提供了一个非常方便的 API 用于提取和操作数据，使用最好的 DOM、CSS 和类似 jquery 的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T10:33:42.557

以下内容应该可以帮助您：

```
% sed -n -E 's/.*(href|src)="([^"]*).*/\2/p' input.html 
```

该`-n`方法*默认不打印行*；该`-E`方法*使用扩展的正则表达式*（因此我们可以使用竖线进行交替）；替换的尾随`p`意味着*打印出任何成功替换的行*。一起，这会找到任何带有`href=`or`src=`的行，将整行替换为`"..."`or 到 a之间的内容`#`，并打印出结果。

根据您的输入，这会产生：

```
css/webworks.css
wwhdata/common/context.js
Page1.htm
images/Pic.2.jpg
javascript:WWHClickedPopup('HelpSR2',   'Page4.htm
javascript:WWHClickedPopup('HelpSR2',   'Page2.htm
javascript:WWHClickedPopup('HelpSR2', 'Page3.htm 
```

这个简单版本的限制：

*   如果一行中有多个 href 或 src，它将不起作用；
*   它无法提取 Javascript 参数的内容；
*   它假定输入使用`"..."`而不是`'...'`分隔文件名。

这些中的每一个都可以通过对 sed 脚本的适当添加来改进，尽管第二个可能最好通过另一个 sed 脚本发送输出来完成，或者......

```
% cat /tmp/t.sed
s/.*(href|src)="([^#"]*).*/\2/
s/javascript.*'//
t x
b
:x
p
% sed -n -E -f /tmp/t.sed /tmp/so.txt
css/webworks.css
wwhdata/common/context.js
Page1.htm
images/Pic.2.jpg
Page4.htm
Page2.htm
Page3.htm
% 
```

最后一张有点特别！我会留下你和手册页来制定细节。

# javascript - Javascript 性能问题

> ID：11123409
> 
> 赞同：3
> 
> 时间：2012-06-20T15:54:58.177
> 
> 标签：javascript, performance, function, html5-canvas

我正在使用 HTML5 画布制作游戏引擎，我决定为图像编写一些“包装器”，因为这为我提供了一个用于各种类型的动画、图像等的通用界面。我的意思是每个对象都有一个`.picture`属性，它提供`draw()`方法、`.phi`旋转值、an`.alpha`等。这种方法对我来说很酷的是，本质上，这个`.picture`属性可以是任何东西：

*   `Picture`图像（实际上称为包装器）。
*   动画（许多图像的包装器，具有一些功能，例如`next()`和`getImage()`）。
*   合成（许多图像和动画被绘制在彼此之上或其他具有绘制方法的东西上。）
*   一个状态（类似于组合）

为了方便起见，所有这些包装器（图像、动画、合成、状态）都会翻译和旋转上下文（如果不先将 HTML5 画布上下文翻译到旋转点，就无法成功旋转 HTML5 画布上下文）。现在，有很多翻译！第一个问题：**为每个绘制调用翻译上下文是否昂贵？**

另一个问题是这种设计意味着很多函数调用！

流程如下：

*   渲染器遍历场景，然后是场景的图层
*   当它到达一个drawable（`ob.picture != undefined`）时，它调用它的`.picture`draw函数（每个可见对象都继承自一个名为Drawable的“类”，该类实际上具有位置和图片属性）

以下是在最佳情况下发生的情况：

*   drawable 的`.picture`属性是一个 Picture 对象（图像的包装器）
*   将`.picture`上下文转换为它的位置
*   旋转`.picture`上下文
*   `.picture`来电_`context.drawImage(.picture.image, etc);`

这是最坏情况下发生的情况：

*   图片属性是一个合成或状态对象
*   合成开始迭代它的元素，每个元素都是另一个图片或动画（或者，更糟糕的是，另一个合成/状态）
*   调用他们的绘制方法
*   他们通过他们的元素渲染实际图片/迭代并重复

如您所见，有很多绘图函数调用。这会是一个重大的速度问题，还是调用函数很便宜？

**编辑：**这个问题发生了一些变化。“游戏”变成了“引擎”，引擎的结构略有改变。但是，没有什么太重要或不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T06:56:36.013

不确定上下文翻译，但我认为翻译不是免费的。

对于函数调用，它取决于您正在绘制的对象的数量。函数调用具有非零运行时长度。虽然它非常小。

我在测量一堆嵌套函数的运行时设置了一个真正愚蠢而简单的示例：http: [//jsfiddle.net/luketmillar/D5sHE/](http://jsfiddle.net/luketmillar/D5sHE/)

当涉及到图形时，每一毫秒都很重要。如果您可以避免额外的函数调用，也可以。

# ios - iOS 远程推送通知通常需要多长时间才能到达设备？

> ID：11123410
> 
> 赞同：1
> 
> 时间：2012-06-20T15:55:01.413
> 
> 标签：ios, push, apple-push-notifications

通过 APNS 将推送通知发送到设备后，您可以期望看到通知到达设备的正常时间范围是多少？在我的开发设置中，我似乎看到了延迟数小时的时间框架，这听起来是错误的（并且可能使得围绕接收和处理通知进行任何类型的迭代开发变得非常困难）。但话又说回来，我通常也会收到很长时间延迟的 Facebook 和电子邮件通知。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T15:56:59.490

最多几秒钟，具体取决于您与 APNS 服务器的连接速度。

# php - $_SESSION 变量的问题

> ID：11123414
> 
> 赞同：0
> 
> 时间：2012-06-20T15:55:10.593
> 
> 标签：php, session-variables

我第一次使用 $_SESSION 变量，我无法理解它发生了什么。我想要这段代码做的是每次按下“提交”按钮时更新计数器。它从零开始，在第一次单击后更新为 1。然后它卡在一个并且似乎没有更新过去。我已经遵循了几个例子，但我似乎无法找到解释为什么它会这样。我究竟做错了什么？我确信这是相当基本的东西，但对于我的生活，我无法弄清楚它是什么。

在此先感谢您的帮助！

```
 1 <?php
 2         session_start();
 3         $_SESSION['counter']=((!isset($_SESSION['counter']))? 0 : $_SESSION['counter']);
 4         if($_POST['submit']){
 5                 $_SESSION['counter']++;
 6         }
 7 ?>
 8 <html>
 9 <body>
10 <form  method = "post">
11         <input type="submit" name="submit" value = "Submit button" />
12 </form>
13         <div name = "content">
14                 <h3>Submit has been clicked <?php echo $_SESSION['counter'] ?> times</h3>
15         </div>
16 </body>
17 </html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:00:29.680

试试这个代码......我认为你在每次页面加载时都将你的计数器重置为 0。

```
<?php
session_start();
if (!isset ($_SESSION['counter'])) {
  $_SESSION['counter'] = 0;
}
if (isset ($_POST['submit'])) {
  $_SESSION['counter']++;
}
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T16:01:40.410

它可能来自您的原始设置`$_SESSION['counter']`。

我会以不同的方式启动它：

```
if($_POST['submit'] && isset($_SESSION['counter'])){
        $_SESSION['counter']++;
}else{
        $_SESSION['counter'] = 0;
} 
```

# javascript - 将 Keycode 与 CKeditor 一起使用

> ID：11123417
> 
> 赞同：4
> 
> 时间：2012-06-20T15:55:19.237
> 
> 标签：javascript, jquery, ckeditor, dom-events

我想在 ckeditor 中获取`keydown`事件的 keyCode。我的代码看起来有点像这样：

```
 editor.document.on( 'keydown', function(event) {
   var keycode= event.data.keyCode & ~(CKEDITOR.SHIFT | CKEDITOR.CTRL |CKEDITOR.ALT);
  alert('Key:'+keycode);

}); 
```

但它总是提醒0。不知道为什么会这样。？

我也想`event.preventDefault()`从 jQuery 中使用，但我不知道如何在我的 plugin.js 文件中包含 jQuery 库。有什么建议么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-20T17:41:41.710

如果您想玩得开心，这是正确的代码：

```
CKEDITOR.instances.editor1.on( 'key', function (evt) {
    var kc = evt.data.keyCode,
        csa = ~(CKEDITOR.CTRL | CKEDITOR.SHIFT | CKEDITOR.ALT);

    console.log(kc, kc & csa);
    // kc & csa is what you need
}); 
```

或者，如果您想要更短的代码：

```
CKEDITOR.instances.editor1.document.on( 'keydown', function (evt) {
    console.log(evt.data.getKeystroke(), evt.data.getKey());
    // getKey() is exactly what you want
}); 
```

关于防止默认 - 你不需要 jQuery。CKEditor 是如此庞大的工具，它内置了 DOM 库。您可以在第二个示例中找到`preventDefault`方法。`evt.data`

# iphone - 将数据保存到导航控制器，以便在整个应用程序中进行访问

> ID：11123418
> 
> 赞同：0
> 
> 时间：2012-06-20T15:55:21.533
> 
> 标签：iphone, objective-c, ios, navigationcontroller

首先我想知道这是否是一个好主意，基本上我有用户类，并且在整个应用程序中我会有一个当前用户，并且各种视图都想要访问这个用户数据。将此用户存储在导航控制器中是否有意义，以便每个类都可以访问它而不必在每个视图上通过 prepareforsegue 传递它？

其次，如果可以这样做，我如何访问导航控制器中的变量？我已经设置好了，所以它有一个叫做 _myUser 的，就像我在其他视图中一样，但是我如何从视图中调用/设置它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T15:57:27.013

我建议将数据保存到您的应用程序委托中，或者如果创建单例开始变得混乱。应用程序委托是一种更好的做法，可以轻松地在整个应用程序中共享。您可以通过以下方式轻松访问它：

```
YourAppDelegate * del = (YourAppDelegate *)[[UIApplication sharedApplication] delegate];
NSLog(@"%@", del.yourPropertyToShare); 
```

# macos - 我的程序是 root，但只有从 sudo 开始才能工作

> ID：11123419
> 
> 赞同：0
> 
> 时间：2012-06-20T15:55:21.333
> 
> 标签：macos, root, ipfw

我写了一个小助手工具来将规则输入 ipfw 并启动一个 dns-server。它与这个 shell 脚本的作用相同：

```
#!/bin/sh

# run the dns server
./nin_mdns_osx 127.0.0.1 &

ipfw add 27000 fwd 127.0.0.1,53 ip from any to any dst-port 53
ipfw add 27101 fwd 127.0.0.1,8081 tcp from any to any dst-port 80 
```

该脚本以 sudo （预期）开始工作。我的 helpertool 也从 sudo 开始工作（预期）。当我通过“chmod u+s”和“chown root”使其成为 root 时，帮助工具告诉我它是 root（geteuid retuns 0） - 但它无法执行 ipfw-calls 并且 dns-server 也不能 bin （端口 53 需要特权）。

我正在运行 Osx 10.6.8。有什么想法吗？

# nginx - 在 NGINX 中配置子域

> ID：11123420
> 
> 赞同：5
> 
> 时间：2012-06-20T15:55:26.873
> 
> 标签：nginx, subdomain

我正在尝试在 NGINX 中配置一个子域。我哪里错了？

以下是配置文件：

```
server {

listen 80;
server_name www.teamomattic.com;
rewrite ^/(.*) http://teamomattic.com permanent;

}

server {
    listen 80 default;
    server_name teamomattic.com *.teamomattic.com;

    root /home/jclark/web/teamomattic.com;

    access_log /var/log/nginx/$host-access.log;
    error_log  /var/log/nginx/dev-error.log error;

    index index.php index.html index.htm;

    try_files $uri $uri/ @rewrite;

    location @rewrite {
        rewrite ^/(.*)$ /index.php/$1;
    }

    location ~ \.php {
        # try_files $uri =404;

        fastcgi_index index.php;
        fastcgi_pass 127.0.0.1:9000;

        include fastcgi_params;
        fastcgi_split_path_info ^(.+\.php)(/.+)$;
        fastcgi_param PATH_INFO $fastcgi_path_info;
        fastcgi_param PATH_TRANSLATED $document_root$fastcgi_path_info;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
    }

    location ~ /\.ht {
        deny all;
    }
}

server {
    listen 80;
    server_name test.teamomattic.com;

    root /home/jclark/web/teamomattic.com/images;

    access_log /var/log/nginx/$host-access.log;
    error_log  /var/log/nginx/dev-error.log error;

    index index.php index.html index.htm;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-08-01T12:42:56.450

只是猜测。我会这样做。

```
server
{
    listen 80;
    server_name subdomain.teamomattic.com;

    location / { return 303 http://teamomattic.com$request_uri; }
} 
```

*   303 是新的临时重定向。我从不使用永久重定向，b/c 你保持灵活，不需要要求你的客户清除缓存。
*   您可能不需要此位置块包装器，可以直接在服务器中使用 return。但最佳做法是始终使用位置，b/c 您可以轻松添加更多位置。
*   如果可能，请使用 https。
*   `request_uri`传递路径和查询字符串 - 因此您不会丢失该信息。

# php - 循环hmac哈希有用吗？

> ID：11123427
> 
> 赞同：0
> 
> 时间：2012-06-20T15:55:51.327
> 
> 标签：php, security, hmac

我需要将密码存储在数据库中，并且我曾经将加盐密码的 sha1 哈希与随机盐一起存储，该随机盐是循环的，如下所示：

```
$salt = sha1(microtime().mt_rand());
for ($i=0; $i < 4000; $i++) {
    $password = sha1($password.$salt);
} 
```

（在我的示例中，`$password`并`$salt`存储在数据库中）。

我最近发现了这个`hash_hmac()`函数，它显然是一个比简单的 SHA1 哈希更安全的函数。我计划以相同的模式使用它（盐是密钥），但我想知道它是否值得像我之前的示例中那样循环它。如果有人能给我一些见解，那将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T07:49:47.023

是的。

您在此处所做的操作称为*[密钥拉伸](http://en.wikipedia.org/wiki/Key_stretching)*，它会使攻击者检查每个候选密码与哈希值所需的时间相乘。在您的示例中，它将时间增加了 4000 倍。您在这里要防御的具体威胁是当攻击者掌握了您的哈希值（例如最近发生在 LinkedIn、Last.fm 和 eHarmony 上的事情）并且可以投入尽可能多的 CPU 能力来破解它们。

如果这不是研究项目，您应该使用众所周知且经过公开测试的函数，例如[`bcrypt()`](http://en.wikipedia.org/wiki/Bcrypt),[`PBKDF2()`](http://en.wikipedia.org/wiki/PBKDF2)或[`scrypt()`](http://www.tarsnap.com/scrypt.html).

该循环中的数字应该远高于 4000，并且由于您的攻击者将使用 C 循环而不是 PHP 循环，因此您将无法在合理的时间内完成他想做的那么多。即使在 PHP 循环中，我也可以在 0.3 秒内完成 500,000 次。上述散列算法解决了这个问题，因为它们将在 C 中实现。（[并非所有这些算法都可以在 PHP 中使用](https://stackoverflow.com/questions/10149554/are-there-any-php-implementations-of-scrypt)。）它似乎`bcrypt`在 5.3 中，但它被称为`CRYPT_BLOWFISH`. [有关如何使用它的详细信息，请参见 crypt() 页面](http://php.net/manual/en/function.crypt.php)。

* * *

`hash_hmac()`不是*更安全*的散列算法，而是用于不同的目的。在此处查看[Thomas 答案的结尾](https://security.stackexchange.com/questions/10901/openssl-digest-vs-hash-vs-hash-hmac-difference-between-salt-hmac)。像`MD5`和`SHA`家族这样的算法是通用哈希算法，通常用作特定目的的更具体算法的一部分。例如，上述一些密码散列算法多次使用通用散列算法。 `has_hmac()`询问您要使用哪种通用哈希算法。

# php - 应用授权文件下载

> ID：11123430
> 
> 赞同：1
> 
> 时间：2012-06-20T15:55:58.740
> 
> 标签：php, nginx, symfony-1.4

我有一个带有管理后端的 symfony 1.4 应用程序，我想让一些 pdf / 图像仅对经过身份验证的用户可用。身份验证过程由 symfony 处理。

我如何确保只有经过身份验证的用户才能下载文件，甚至超过 php 的 memory_limit 设置的文件？

我使用的网络服务器是 nginx。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T16:07:16.073

使用[`X-Sendfile`](http://wiki.nginx.org/XSendfile)(/ `X-Accel-Redirect`)，nginx 将在 PHP 脚本发送适当的标头并结束后提供文件。[这似乎是一个恰当的解释](http://kovyrin.net/2006/11/01/nginx-x-accel-redirect-php-rails/)。

greg0ire > 这是我使用 symfony 1.4 和 nginx 的实现：

1.  在web下创建一个名为“secure”的目录
2.  像这样配置nginx：
3.  创建一个 symfony 路由
4.  创建一个 symfony 动作

**Nginx 配置**：

```
location /secure/ {
    internal;
  } 
```

**Symfony 路由**

```
SecureDownload:
  url: /anything-you-want-but-secure/:filename
  options:
    segment_separators: ['/'] # filenames often contain dots
  params:
    module: YourModule
    action: secureDownload 
```

**Symfony 动作**

```
<?php
class SecureDownloadAction extends sfAction
{
  public function execute($request)
  {
    $this->getResponse()->setHttpHeader(
      "X-Accel-Redirect",
      "/secure/" . $request->getParameter('filename'));
    $this->getResponse()->setHttpHeader(
      "Content-Disposition",
      "attachement; filename=". $request->getParameter('filename'));
    return sfView::HEADER_ONLY;
  }
} 
```

# sharepoint - 递归创建 Sharepoint 目录

> ID：11123437
> 
> 赞同：0
> 
> 时间：2012-06-20T15:56:08.957
> 
> 标签：sharepoint, recursion

我正在尝试以以下方式创建一组来自平面文件的文件夹。

X/Y/Z

我想为每一个创建一个目录，但我对递归的记忆让我陷入了困境。

这是我的代码有人可以建议。

```
 public void CreateDirectory(SPFolderCollection oWeb, string folder)
    {
        SPFolder theFolder = oWeb.Add(folder);
        theFolder.Update();
    }

    public void FolderCreator(SPWeb oWeb)
    {
        StreamReader reader = new StreamReader(this.txtFolders.Text);
        while (reader.Peek() != -1)
        {
            string folderLine = reader.ReadLine();
            if (folderLine.Contains("/"))
            {
                SPFolderCollection collection = oWeb.Folders["Documents"].SubFolders[folderLine.Split('/')[0]].SubFolders;
                CreateDirectory(collection, folderLine);
            }
            SPFolderCollection newCollection = oWeb.Folders["Documents"].SubFolders;
            CreateDirectory(newCollection, folderLine);
        }
    } 
```

这不起作用我正在寻找它来做recrusion所以如果我通过

ABC/DEF/GHI 和 ABC/DEF 它将去适当地创建文件夹。

但我被困在如何做到这一点上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T21:28:07.053

SPFileCollection.Add [()](http://msdn.microsoft.com/en-us/library/ms414180)方法允许您传入文件的完整相对路径。因此，这可能是一个选项，假设您不只是生成一个文件夹结构，您可能正在这样做，在这种情况下，除非您创建一个临时文件然后删除它以保留文件夹路径，否则这将不会真正起作用。

```
web.Files.Add("/sites/somesite/shared documents/foldera/folderb/folderc/somefile.txt", stream); 
```

# facebook-graph-api - Facebook Javascript SDK 扩展访问令牌获取“无效的 OAuth 访问令牌” - 190 - “OAuthException”

> ID：11123444
> 
> 赞同：4
> 
> 时间：2012-06-20T15:56:33.007
> 
> 标签：facebook-graph-api, oauth, facebook-javascript-sdk, facebook-access-token

我尝试使用 javacript SDK 获取访问令牌，然后将该访问令牌延长 60 天。我从响应中得到这样的响应错误：`Object { message="Invalid OAuth access token.", type="OAuthException", code=190}`

我的期望：

1.  获取 60 天到期的新访问令牌
2.  控制台到屏幕。

我的代码：

```
window.onload = function() {

var isLogin = true;

FB.init({appId:422642254433770, cookie:true, status:true, xfbml:true });

FB.getLoginStatus(function(response) {
    if (response.status === 'connected') {
        // the user is logged in and connected to your
        // app, and response.authResponse supplies
        // the user’s ID, a valid access token, a signed
        // request, and the time the access token 
        // and signed request each expire
        var uid = response.authResponse.userID;
        var accessToken = response.authResponse.accessToken;
        var accessTokenOld = response.authResponse.accessToken;

        //Extend access token                    
        var OauthParams = {};
        OauthParams['client_id'] = '//REMOVED APP ID';
        OauthParams['client_secret'] = '//REMOVED APP SECRET';
        OauthParams['grant_type'] = 'fb_exchange_token';
        OauthParams['fb_exchange_token'] = 'accessToken';
        OauthParams['response_type'] = 'token';

        console.log("Old accessToken => " + accessToken);
        FB.api('/oauth/access_token', 'post', OauthParams, function(response) {
            console.log(response);

            if (!response || response.error) {
                console.log(response.accesstoken);
            } else {
                console.log("Lay new access token bi loi " + response.error.message);
            }
        });        
    }
});
}; 
```

我尝试在没有任何线索的情况下在任何地方搜索这个问题 3 天。我有没有人有经验？请帮忙。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-14T20:14:16.683

在客户端中执行此操作是一个坏主意，因为需要在实际客户端中包含应用程序机密，这是非常危险的。最好在您的服务器上调用一个单独处理此问题的端点，以便应用程序机密保留在您的受控环境中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T01:52:53.850

如果在您的 FB 应用程序的高级设置中您启用了“删除 offline_access 权限”，则默认情况下您的所有访问令牌将是 60 天。

我们最近遇到了同样的问题，这解决了这个问题。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2014-04-01T11:53:50.200

我找到了一个简单的解决方案，可以使用 Jquery valide 获得长达 2 个月的扩展访问令牌

**传递给 URL 的变量：**

```
var accessToken = 'CURRENT_ACCESS_TOKEN';
var appid       = 'APPID';
var appsecret   = 'APPSECRET'; 
```

**您的网址应指向**

```
var exchangeUrl = "https://graph.facebook.com/oauth/access_token?grant_type=fb_exchange_token&fb_exchange_token="+accessToken+"&client_id="+appid+"&client_secret="+appsecret; 
```

**发出 Ajax 请求**

```
$.ajax({  
type: "GET",
url: exchangeUrl,  
success: function(data)
{ 
   extended = data.split('=');
   extendedAT = extended['1'].replace('&expires','');
       alert(extendedAT);

}

}); 
```

# php - 按其他数组排序 PHP 数组

> ID：11123445
> 
> 赞同：0
> 
> 时间：2012-06-20T15:56:36.860
> 
> 标签：php, arrays, multidimensional-array

给定以下数组：

```
 $array = array(
        'note' => array('test', 'test1', 'test2', 'test3', 'test4'),
        'year' => array('2011','2010', '2012', '2009', '2010'),
        'type' => array('journal', 'conference', 'editorial', 'conference','conference'),
    ); 
```

如果使用以下函数更容易，则可以轻松转换数组：

```
for($i=0; $i < count($array['type']); $i++)
  foreach($array as $key=> $value)
    $temp[$i][$key] = $value[$i];

print_r($temp); 
```

我想使用以下标准对其进行排序：

1.  数组`$sortby = ('journal', 'editorial', 'conference')`
2.  在按类别排序后，我想`year DESC`对每个类别进行排序。

期望的结果：

```
Array
(
[note] => Array
    (
        [0] => test
        [1] => test2
        [2] => test1
        [3] => test4
        [4] => test3
    )

[year] => Array
    (
        [0] => 2011
        [1] => 2012
        [2] => 2010
        [3] => 2010
        [4] => 2009
    )

[type] => Array
    (
        [0] => journal
        [1] => editorial
        [2] => conference
        [3] => conference
        [4] => conference
    )

) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T16:14:01.257

```
<?php 
$Array= array(array('note'=>'test1','year'=>'2011','type'=>'journal'),
              array('note'=>'test2','year'=>'2012','type'=>'editorial'),
              array('note'=>'test3','year'=>'2012','type'=>'conference'),
              array('note'=>'test4','year'=>'2012','type'=>'conference'),
              array('note'=>'test5','year'=>'2012','type'=>'conference'));
print_r($Array);
/*Array
(
    [0] => Array
        (
            [note] => test1
            [year] => 2011
            [type] => journal
        )

    [1] => Array
        (
            [note] => test2
            [year] => 2012
            [type] => editorial
        )

    [2] => Array
        (
            [note] => test3
            [year] => 2012
            [type] => conference
        )

    [3] => Array
        (
            [note] => test4
            [year] => 2012
            [type] => conference
        )

    [4] => Array
        (
            [note] => test5
            [year] => 2012
            [type] => conference
        )

)*/

//Lets sort them by value
function array_sort_by_column(&$arr, $col, $dir = SORT_DESC) {
    $sort_col = array();
    foreach ($arr as $key=> $row) {
        $sort_col[$key] = $row[$col];
    }
    return array_multisort($sort_col, $dir, $arr);
}

array_sort_by_column($Array, 'year');
print_r($Array);
/*Array
(
    [0] => Array
        (
            [note] => test2
            [year] => 2012
            [type] => editorial
        )

    [1] => Array
        (
            [note] => test3
            [year] => 2012
            [type] => conference
        )

    [2] => Array
        (
            [note] => test4
            [year] => 2012
            [type] => conference
        )

    [3] => Array
        (
            [note] => test5
            [year] => 2012
            [type] => conference
        )

    [4] => Array
        (
            [note] => test1
            [year] => 2011
            [type] => journal
        )

)*/

array_sort_by_column($Array, 'note');
print_r($Array);
/*
Array
(
    [0] => Array
        (
            [note] => test5
            [year] => 2012
            [type] => conference
        )

    [1] => Array
        (
            [note] => test4
            [year] => 2012
            [type] => conference
        )

    [2] => Array
        (
            [note] => test3
            [year] => 2012
            [type] => conference
        )

    [3] => Array
        (
            [note] => test2
            [year] => 2012
            [type] => editorial
        )

    [4] => Array
        (
            [note] => test1
            [year] => 2011
            [type] => journal
        )

)*/

array_sort_by_column($Array, 'type');
print_r($Array);
/*
Array
(
    [0] => Array
        (
            [note] => test1
            [year] => 2011
            [type] => journal
        )

    [1] => Array
        (
            [note] => test2
            [year] => 2012
            [type] => editorial
        )

    [2] => Array
        (
            [note] => test3
            [year] => 2012
            [type] => conference
        )

    [3] => Array
        (
            [note] => test4
            [year] => 2012
            [type] => conference
        )

    [4] => Array
        (
            [note] => test5
            [year] => 2012
            [type] => conference
        )

)

*/
?> 
```

# java - Hibernate: Doman Model to JPA Entity/DTO & Merge() 设计模式或最佳实践

> ID：11123446
> 
> 赞同：1
> 
> 时间：2012-06-20T15:56:36.943
> 
> 标签：java, hibernate

使用 merge() 的推荐方法是在输入更改之前首先获取 DTO。

```
public void merge(PersonModel model) {

Person inputDTO = PersonBuilder.build(model)

Person dto = get(pk)
dto.setName(inputDTO.getName())

dto.getChildren().clear()

Iterator<Child> iter = inputDTO .getChildren().Iterator();

while(iter.hasNext()){
   dto.getChildren().add(iter.next());
}

dto.merge(); 
```

}

是否有一种更优雅的方式来执行将域模型转换为 dto 并合并它的操作，以免意外删除数据。

问题示例： [休眠：使用merge()时防止删除孤儿；](https://stackoverflow.com/questions/11098266/hibernate-prevent-delete-orphan-when-using-merge)

我发现需要清除列表并添加它非常浪费。

有人可以向我推荐一种设计模式或一种正确编码的方法吗？

谢谢

添加在：

1) 可以用 Hibernate Hashset 代替 List 吗？hibernate hashset 会根据主键替换元素吗？

有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-01T10:27:14.913

> “使用 merge() 的推荐方法是在输入更改之前先获取 DTO”

谁建议你这样做？

> “有没有更优雅的方式来执行这种将域模型转换为 dto 并合并它的操作，这样就不会意外删除任何数据。”

我认为您不能将域对象转换为 DTO。DTO 只是关于数据，域对象是数据、行为和上下文。完全不同。

如果您的域对象（[也称为贫血域模型](http://en.wikipedia.org/wiki/Anemic_domain_model)）中没有行为和上下文，则不需要仅复制对象的额外 DTO 层。

因为你用 Hibernate 标记了这个问题并在你的问题中提到了它，所以你不需要自己调用 merge，因为你刚刚从数据库中获取了对象，Hibernate 将刷新会话以将更改与数据库同步。

> “可以用 Hibernate Hashset 代替 List 吗？hibernate hashset 会根据主键替换元素吗？”

我会用 Hashset 替换 List，因为要存储数据的表是一个集合，而不是一个列表（你不能有重复的记录）。哈希集不会根据主键替换元素。一个集合（任何集合，Hibernate 的实现也不例外）通过防止重复来工作。它使用您的 equals() 和 getHashCode() 实现来确定该集合中是否已经存在一个对象。如果是这种情况，则不会添加，但会保留原始内容。

# c# - C# 性能计数器和 nic 名称

> ID：11123450
> 
> 赞同：7
> 
> 时间：2012-06-20T15:56:56.663
> 
> 标签：c#, networking, performancecounter

与 ipconfig/all 和 c# 系统调用相比，perfmon 计数器使用不同的 NIC 名称，如下所示（来自 ipconfig/all）

> ```
>  Ethernet adapter HHHH:       
> 
>    Connection-specific DNS Suffix  . :   
> 
>    Description . . . . . . . . . . . : HP NC364T PCIe Quad Port Gigabit Server Adapter #3
>    Physical Address. . . . . . . . . : 00-1F-29-0D-26-59
>    DHCP Enabled. . . . . . . . . . . : No
>    Autoconfiguration Enabled . . . . : Yes
>    IPv4 Address. . . . . . . . . . . : 166.49.47.10(Preferred)
>    Subnet Mask . . . . . . . . . . . : 255.255.255.240
>    Default Gateway . . . . . . . . . :
>    NetBIOS over Tcpip. . . . . . . . : Disabled 
> ```

```
using System.Net.NetworkInformation;
NetworkInterface[] interfaces = NetworkInterface.GetAllNetworkInterfaces(); 
```

我明白了`HP NC364T PCIe Quad Port Gigabit Server Adapter #3`。与 ipconfig 完全相同。 **但是**perfmon 正在使用`HP NC364T PCIe Quad Port Gigabit Server Adapter _3`（下划线而不是哈希）。我是否必须使用不同的调用来获得与 perfmon 具有的完全相同的计数器名称？如果是这样，它是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T22:16:06.890

我个人会使用注册表以本机方式列出网络设备。检索信息的方式有很多种，但并非所有方式都像系统那样显示信息。可能的代码示例可能如下所示（未完全处理错误）。它适用于 Windows Vista 32/64 位和 7。它与 NET 类有很大不同，但它认为它的作用相同。必须添加命名空间“使用 Microsoft.Win32”才能运行代码。

```
private void button1_Click(object sender, EventArgs e)
    {
        ListPCIDevices(false, listBox1);
    }

    public static void ListPCIDevices(bool ListOnlyNetworkDevices, ListBox LB)
    {
        string NetKey = @"SYSTEM\ControlSet001\Enum\PCI";
        using (RegistryKey rk = Registry.LocalMachine.OpenSubKey(NetKey))
        {
            foreach (string skName in rk.GetSubKeyNames())
            {
                using (RegistryKey sk = rk.OpenSubKey(skName))
                {

                    foreach (string skSubName in sk.GetSubKeyNames())
                    {

                        using (RegistryKey ssk = sk.OpenSubKey(skSubName))
                        {

                            object ItemName = ssk.GetValue("DeviceDesc");
                            object ItemCat = ssk.GetValue("Class");
                            if (ItemCat == null) { ItemCat = "Unknown"; }

                            if ((ItemName != null) && ((ItemCat.ToString() == "Net")||(!ListOnlyNetworkDevices)))
                            {
                                LB.Items.Add(ItemName.ToString().Split(';')[1]);
                            }

                        }
                    }
                }
            }
        }
    } 
```

# jenkins - 詹金斯不承认 git 二进制

> ID：11123452
> 
> 赞同：7
> 
> 时间：2012-06-20T15:56:59.567
> 
> 标签：jenkins, jenkins-plugins

我已经在 Centos 5.7 上成功安装了 git，

$ git --version git 版本 1.7.4.1

在从 jenkins 的 github 中提取源代码时，我面临以下问题

```
Caused by: java.io.IOException: Cannot run program "git": error=2, No such file or directory
at java.lang.ProcessBuilder.start(ProcessBuilder.java:1029)
at hudson.Proc$LocalProc.<init>(Proc.java:244)
at hudson.Proc$LocalProc.<init>(Proc.java:216)
at hudson.Launcher$LocalLauncher.launch(Launcher.java:709)
at hudson.Launcher$ProcStarter.start(Launcher.java:338)
at hudson.Launcher$ProcStarter.join(Launcher.java:345)
at hudson.plugins.git.GitAPI.launchCommandIn(GitAPI.java:774) 
```

Jenkins 无法识别 git 二进制文件。

请帮助我

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T12:13:25.750

您还可以基于每个节点覆盖 git 路径。只需转到节点的配置页面，然后检查`Tool Locations`并提供该系统上的 git 路径。

在 OSX 上，这是`/usr/local/git/bin/git`给我的。您可以通过`which git`在您的节点上以 jenkins 用户身份执行来确定它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T16:45:06.263

Jenkins needs to know where your git binary file is installed; this is usually at /usr/bin/git on Linux systems. Go to the /configure page of your Jenkins installation (the "Manage Jenkins" link) and set it up in the "Git" section.

# c# - 如何在.NET中运行在一台机器上运行而在另一台机器上不运行的批处理（.bat）文件

> ID：11123460
> 
> 赞同：0
> 
> 时间：2012-06-20T15:57:15.877
> 
> 标签：c#, .net, iis, batch-file

当我启动一个`BAT`在本地启动带有参数的文件的进程时，一切正常。我将此站点上传到 Windows 服务器，然后一个进程运行此进程失败。它只是执行代码，什么也没发生。

我尝试`UseShellExecute = false`在有和没有的情况下运行它`cmd`...

我还能检查什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T22:47:09.307

从依赖项开始。例如：

1.  您在服务器上是否有 cygwin 或类似的东西会实际运行 bash shell？
2.  执行该进程的用户实际上是否有权启动 bash shell？
3.  执行进程的用户是否有权在 bash 脚本中执行操作？
4.  它们的文件路径或环境变量依赖关系吗？这些路径和变量是否存在？

一种测试方法是使用用于执行脚本的用户帐户登录到该服务器，以查看您是否可以自己运行它。

bash 脚本完全有可能在尝试提示用户输入时失败并挂起。也有可能 UAC 已打开，并且脚本需要提升权限才能执行操作。没有看剧本很难说。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T23:41:41.257

您几乎可以肯定遇到安全/权限问题。检查服务器的事件日志（尤其是安全事件日志）。此外，如果可以的话，在服务器上运行 SysInternals Process Monitor (procmon) 也可能会有所帮助。

除非您已将网站设置为使用模拟，否则它将使用本地受限帐户运行。对于 Windows Server 2008，DefaultAppPool 将使用本地`IIS APPPOOL\DefaultAppPool`身份，几乎可以肯定它没有调用 bash 的权限。

它可能适用于您的本地开发机器，因为 Visual Studio 将模拟您（可能是本地管理员）以调试您的应用程序。

为了解决这个问题，您需要授予用于应用程序池的身份的权限，以便您的站点执行 bash，或者（这可能更容易）将应用程序池的身份更改为域用户（或本地用户，至少）。

# puppet - Puppet 语法：如何将对象数组包含到排序 -> 链中？

> ID：11123462
> 
> 赞同：0
> 
> 时间：2012-06-20T15:57:24.637
> 
> 标签：puppet

假设我有：

```
$files = ["file1", "file2"]
exec { "exec1" :
    command => "mycommand";
}
file { $files :
    ensure => present;
} 
```

我想使用`->`and`~>`结构来控制执行的通知/要求顺序，如下所示：

```
Exec["exec1"] -> File[$files] 
```

我该怎么做？

如果我执行上述操作，我会得到`Could not find resource 'File[file1]File[file2]'`（当然，对于真实的文件路径）。我玩过用`$files`引号和 {} 包装变量，但无济于事。

将资源名称的数组变量放入排序链的语法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:46:40.980

[您可以使用来自 RIPienaar 的大量](http://www.devco.net/archives/2009/08/19/tips_and_tricks_for_puppet_debugging.php)提示中的“数组中的内容”提示：

首先定义一个处理链接的函数，然后将数组传递给该函数。
该函数将为数组中的每个项目调用一次。

代码示例时间：

```
exec { "exec1":
     command => "/bin/echo 'i am the very model of a modern major general'";
}

file { 
    "/var/tmp/file1":
        ensure => present;
    "/var/tmp/file2":
        ensure => present;
}

define chaintest() {
    notify{"Calling chaintest with ${name}": }
    Exec["exec1"] -> File["${name}"]
}

$files = ["/var/tmp/file1","/var/tmp/file2"]

chaintest{$files: } 
```

Ubuntu 12.04 上 puppet 2.7.11 上的“puppet apply test.pp”的输出给出：

```
notice: Calling chaintest with /var/tmp/file1
notice: /Stage[main]//Chaintest[/var/tmp/file1]/Notify[Calling chaintest with /var/tmp/file1]/message: defined 'message' as 'Calling chaintest with /var/tmp/file1'
notice: /Stage[main]//Exec[exec1]/returns: executed successfully
notice: Calling chaintest with /var/tmp/file2
notice: /Stage[main]//Chaintest[/var/tmp/file2]/Notify[Calling chaintest with /var/tmp/file2]/message: defined 'message' as 'Calling chaintest with /var/tmp/file2'
notice: Finished catalog run in 0.11 seconds 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T18:05:06.590

为什么不使用 require 呢？

```
$files = ["file1", "file2"]
exec { "exec1" :
    command => "mycommand";
}
file { $files :
    ensure => present;
    require => Exec["exec1"]
} 
```

或者只是做

```
Exec["exec1"] -> [File["file1"], File["file2"]] 
```

# android - 试图制作单进程设备......这可能吗？？？:(

> ID：11123469
> 
> 赞同：-1
> 
> 时间：2012-06-20T15:57:38.873
> 
> 标签：android, linux, linux-kernel, embedded-linux, odroid

大家好，我是韩国人，不太会用英语，所以如果我说的不恰当的话，请尽量理解。

所以，我的状态是我有 odroid-s。

我想要做的一个月或更长时间是我想把 android 变成 HelloWorld。

我想说的是，在 odroid-s 上，bootloader 部分，内核部分是相同的，但框架部分（将是 android），我将删除所有 android 部分并仅用 HelloWorld 程序替换它。这个 HelloWorld 程序的目的是在屏幕上显示 HelloWorld。

我想我发现的是，当我在正常引导日志和我删除所有系统分区部分（这是 android 系统分区部分）之间的“vimdiff”引导日志时，**android 内核的 init**继续并执行控制台（/bin/ sh), netd(bin/netd), ... 它启用了 adb 并完成了他的工作。

所以我的结论是，我需要使用未修改的 Linux 内核并将其修改为 odroid-s，并将该内核用于我的 HelloWorld 程序！

我想问的是……我做得对吗？T_T

我现在的目标是让 HelloWorld 从这个 odroid-s 设备中出来......

请有人帮助我。如果有人不明白我写了什么请告诉我，我会修复它。谢谢阅读....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:30:19.013

对 linux 内核的修改可能与您的目标无关，因此为了简单起见，您不妨保留它们。

你最大的挑战是输出——你想把它送到哪里？如果您的设备之一具有（或可以具有正确的内核配置）调试串行端口，那么编写由 init 脚本触发的内容将非常容易（甚至在脚本中使用“echo”）在该端口上输出您的消息。

但是你很可能想在屏幕上放一些东西。这将变得更加复杂，并且可能取决于设备。android 运行时为实际应用程序执行此操作的方式将比您可能想了解的要复杂得多。

更实用的方法可能是查看启动动画是如何完成的。对于初学者，您可以将其替换为显示“hello world”的静态图像。一旦你能做到这一点，下一步可能是找到一些字符生成器代码。最后，您可能想要实现滚动和其他类似终端的功能。

作为一种替代方法，可以为某些 android 设备构建更传统的 linux - 例如 debian 或 ubuntu。这些可能包括能够在设备屏幕上显示的控制台实现。

另一个想法是，如果您对愿意在设备上保留多少 android 有足够的灵活性，您可以构建一个版本的 android 终端仿真器示例，修改为主屏幕替代品。您也许可以删除很多 android 组件（最终包括默认主屏幕）。或者在一个安全的设备上（即大多数没有root的消费设备）你可以只做主屏幕更换，同时保持实际系统不变。对于想要运行其他东西的用户来说，它并不安全，但通常用户只会与您的代码交互。

# php - PHP获取数组中的所有数字/匿名键

> ID：11123471
> 
> 赞同：5
> 
> 时间：2012-06-20T15:57:45.073
> 
> 标签：php, arrays, key, anonymous

我有一个多维数组，我有兴趣获取所有没有命名键的元素（一层深）。

IE

```
Array
{
  ['settings'] {...}
  ['something'] {...}
  [0] {...} // I want this one
  ['something_else'] {...}
  [1] {...} // And this one
} 
```

有任何想法吗？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-20T16:01:05.167

这是一种方式

```
foreach (array_keys($array) as $key) {
 if(is_int($key)) {
  //do something
 }
} 
```

编辑

根据数组的大小，这样做可能会更快，内存效率更高。但是，它确实要求键是有序的，并且没有丢失。

```
for($i=0;isset($array[$i]);$i++){
 //do something
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T16:01:28.083

```
$result = array();
foreach ($initial_array as $key => $value)
  if ( ! is_string( $key ) )
    $result[ $key ] = $value; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T16:00:10.993

关键是`0`，不应该`$your_array[0]`吗？

# linker - 基于 ATL 的链接器错误

> ID：11123475
> 
> 赞同：6
> 
> 时间：2012-06-20T15:57:57.547
> 
> 标签：linker, atl, visual-c++-2008

我最近遇到了与 atls.lib 的链接问题。我更新了链接器的附加依赖项：

```
comctl32.lib
C:\WinDDK\7600.16385.1\lib\ATL\i386\atls.lib
C:\WinDDK\7600.16385.1\lib\ATL\i386\atl.lib
C:\WinDDK\7600.16385.1\lib\ATL\i386\atlsd.lib 
```

但是，现在，我开始收到这些错误。

什么会导致这些问题？

非常感谢你。

```
------ Build started: Project: hede, Configuration: Debug Win32 ------
Linking...
atlsd.lib(externs.obj) : error LNK2005: "char const * const g_pszUpdateEventName" (?g_pszUpdateEventName@@3PBDB) already defined in atls.lib(externs.obj)
atlsd.lib(externs.obj) : error LNK2005: "char const * const g_pszAllocFileMapName" (?g_pszAllocFileMapName@@3PBDB) already defined in atls.lib(externs.obj)
atlsd.lib(externs.obj) : error LNK2005: "char const * const g_pszKernelObjFmt" (?g_pszKernelObjFmt@@3PBDB) already defined in atls.lib(externs.obj)
atlsd.lib(externs.obj) : error LNK2005: "class CAtlAllocator g_Allocator" (?g_Allocator@@3VCAtlAllocator@@A) already defined in atls.lib(externs.obj)
SettingPropPage.obj : error LNK2001: unresolved external symbol __forceAtlDllManifest
stdafx.obj : error LNK2001: unresolved external symbol __forceAtlDllManifest
trace.obj : error LNK2001: unresolved external symbol __forceAtlDllManifest
util.obj : error LNK2001: unresolved external symbol __forceAtlDllManifest
genericpropclasses.obj : error LNK2001: unresolved external symbol __forceAtlDllManifest
hede.obj : error LNK2001: unresolved external symbol __forceAtlDllManifest
hede2.obj : error LNK2001: unresolved external symbol __forceAtlDllManifest
propclasses.obj : error LNK2001: unresolved external symbol __forceAtlDllManifest
propclasses.obj : error LNK2019: unresolved external symbol __imp__AtlWinModuleAddCreateWndData@12 referenced in function "public: void __thiscall ATL::CAtlWinModule::AddCreateWndData(struct ATL::_AtlCreateWndData *,void *)" (?AddCreateWndData@CAtlWinModule@ATL@@QAEXPAU_AtlCreateWndData@2@PAX@Z)
propclasses.obj : error LNK2019: unresolved external symbol "void __stdcall ATL::__FreeStdCallThunk(void *)" (?__FreeStdCallThunk@ATL@@YGXPAX@Z) referenced in function "public: static void __cdecl ATL::_stdcallthunk::operator delete(void *)" (??3_stdcallthunk@ATL@@SAXPAX@Z)
propclasses.obj : error LNK2019: unresolved external symbol __imp__AtlWinModuleExtractCreateWndData@4 referenced in function "public: void * __thiscall ATL::CAtlWinModule::ExtractCreateWndData(void)" (?ExtractCreateWndData@CAtlWinModule@ATL@@QAEPAXXZ)
propclasses.obj : error LNK2019: unresolved external symbol "void * __stdcall ATL::__AllocStdCallThunk(void)" (?__AllocStdCallThunk@ATL@@YGPAXXZ) referenced in function "public: static void * __cdecl ATL::_stdcallthunk::operator new(unsigned int)" (??2_stdcallthunk@ATL@@SAPAXI@Z)
stdafx.obj : error LNK2019: unresolved external symbol __imp__AtlUpdateRegistryFromResourceD@20 referenced in function "public: long __stdcall ATL::CAtlModule::UpdateRegistryFromResourceDHelper(wchar_t const *,int,struct ATL::_ATL_REGMAP_ENTRY *)" (?UpdateRegistryFromResourceDHelper@CAtlModule@ATL@@QAGJPB_WHPAU_ATL_REGMAP_ENTRY@2@@Z)
stdafx.obj : error LNK2019: unresolved external symbol __imp__AtlCreateRegistrar@4 referenced in function "public: long __stdcall ATL::CAtlModule::UpdateRegistryFromResourceDHelper(wchar_t const *,int,struct ATL::_ATL_REGMAP_ENTRY *)" (?UpdateRegistryFromResourceDHelper@CAtlModule@ATL@@QAGJPB_WHPAU_ATL_REGMAP_ENTRY@2@@Z)
stdafx.obj : error LNK2019: unresolved external symbol __imp__AtlCallTermFunc@4 referenced in function "public: void __thiscall ATL::CAtlModule::Term(void)" (?Term@CAtlModule@ATL@@QAEXXZ)
Debug/hede.exe : fatal error LNK1120: 8 unresolved externals
Build log was saved at "file://c:\Users\JohnDoe\Desktop\myproject\hede\Debug\BuildLog.htm"
hede- 20 error(s), 0 warning(s)
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T12:26:26.190

在项目设置中，将“使用 ATL”从“动态链接到 ATL”更改为“静态链接到 ATL”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-08-21T15:50:15.370

我也必须调试这个问题。似乎 DLL bulid 不起作用，因为 atl.lib 中缺少许多函数。我将“使用 ATL”切换为“到 ATL 的静态链接”。之后我只剩下 3 个缺失的符号，我发现这些是在`atlthunk.lib`. atlbase.h 中从未引用过这个。这就是我添加的原因

```
#pragma comment(lib, "atlthunk.lib") 
```

在`atlbase.h`调试是/否部分之前`atls.lib/atlsd.lib`

之后构建成功。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-20T19:08:32.100

atls.lib 是 ATL 的静态库。atlsd.lib 是该库的调试版本。您在同一个版本上链接到两者，因此您获得了多个定义。此外，如果您想使用 ATL 的动态库，您应该链接到 atl.lib。因此，要么使用 atl.lib，要么在发布版本中使用 atls.lib，在调试版本中使用 atlsd.lib。但不要将它们混合在一起。

# php - 如何在 php 中使用 wget 或 curl 获取网页上所有路径/文件的列表？

> ID：11123477
> 
> 赞同：0
> 
> 时间：2012-06-20T15:58:03.470
> 
> 标签：php, curl, header, wget

我`wget -p $url` 用来获取网页上的所有文件，以便获取列表。但是对于某些 URL，事实证明 wget 只能获取 index.html。有没有办法通过 wget 或 cURL 获取特定 URL 上的文件列表？我需要检查请求标头和响应标头吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T16:01:27.240

有些服务器不允许您浏览目录列表，如果该目录中有默认文档，它将接管并且您也无法浏览。

您需要实现一个蜘蛛，它解析所有路径、文件和链接，并创建在 HTML 中声明和使用的文件的目录结构。**然后**，您可以下载这些文件。

# silverlight - 如何在 MainPage.Xaml 以外的单独窗口中打开 Xaml 页面

> ID：11123478
> 
> 赞同：0
> 
> 时间：2012-06-20T15:58:07.650
> 
> 标签：silverlight, out-of-browser

以下所有功能都应在浏览器外模式下工作。在我的项目开始时，在 MainPage.xaml 中登录后有一个登录页面，有一个按钮，单击此按钮时，应打开一个新页面，页面中有 WebBrowser 控件，有网格控件，因为网格选定项会更改它应该反映到第一个窗口。

请帮助我
谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T09:29:14.897

我认为这在silverlight 4 中是不可能的。所以我将我的项目更新为silverlight 5，并将Window 类用于浏览器外的应用程序。达到我的要求

```
 WebBrower wb = new WebBrowser();
                        wb.ScriptNotify += new EventHandler<NotifyEventArgs>(b_ScriptNotify);
                        Window win = new Window();
                        win.Height = 870;
                        win.Width = 600;
                        win.Title = "Site Map";
                        win.Content = wb;
                        win.Visibility = Visibility.Visible;

 void b_ScriptNotify(object sender, NotifyEventArgs e)
        {
           MessageBox.Show(Convert.ToInt32(e.Value).ToString());
        } 
```

# joomla - 我如何解决迁移到 Joomla 的这些荒谬的副作用！2.5？

> ID：11123480
> 
> 赞同：0
> 
> 时间：2012-06-20T15:58:17.920
> 
> 标签：joomla, joomla1.5, joomla2.5

我的任务是从*Joomla 迁移网站！1.5*到*Joomla！2.5* . 那是一团糟，但我终于让网站运行起来了。

这是我的一篇文章中的一段代码：

```
<p><span class="Apple-style-span" style="font-family: Helvetica, Arial, Helvetica, sans-serif; font-size: 18px; font-weight: bold;">Description </span><span class="Apple-style-span" style="font-family: Helvetica, Arial, Helvetica, sans-serif; font-size: 18px; font-weight: bold;"><br /></span></p>
<p>A bunch of text goes here</p>
<p style="font-size: 10px;" align="center"><a href="some_image.jpg" target="_PCI-104-3000"> <img src="another_image.jpg" border="1" alt="Image of The Thing" height="120px" /> 
```

当我将鼠标悬停在中间的段落（“这里有一堆文本”）或其上方的标题行上时，整个段落变为粗体。当鼠标离开该区域时，文本恢复正常。

为什么？*这是在Joomla!*上运行的完全相同的代码！*该网站的1.5*版本，在那边它没有这样做。新版本的*Joomla！*阅读 HTML 有问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T17:12:02.747

如果我能看到有问题的实际站点，我可以告诉你确切的位置，但很明显，你在*新*站点中有一些 CSS 会触发 :hover。检查模板的 J2.5 版本的 CSS 文件。

# java - 带有 ws-security 时间戳令牌的 JAX-WS 独立客户端

> ID：11123484
> 
> 赞同：0
> 
> 时间：2012-06-20T15:58:36.853
> 
> 标签：java, web-services, jax-ws, ws-security

我创建了一个应用程序，其中包含一个使用 JAX-WS（使用 wsimport）实现的独立 Web 服务客户端。

现在客户要求我添加 ws-security 功能，在soap 标头中签名时间戳标记。

我实际上处于危机之中，因为我不知道如何在这个项目中添加此功能，而无需制作新功能。有人建议我使用 CXF，但我想用 JAX-WS 保留实际项目。

有没有办法在 jax-ws 中添加 ws-security 功能？JAX-WS 类是使用 wsimport 从客户提供的 wdsl 和 xsd 文件开始生成的。

谢谢...

# iphone - 将从自定义类加载的 XIB 的操作连接到情节提要

> ID：11123487
> 
> 赞同：2
> 
> 时间：2012-06-20T15:58:57.047
> 
> 标签：iphone, xcode, uibutton, xib, ibaction

我正在尝试创建一个可重用的组件来显示一些照片集。基本流程如下：

*   第一视角：`View`。它包含我所谓的库，以编程方式设计并通过分配自定义类从情节提要中加载
*   我在模态视图中拍照，从“拍照”按钮打开
*   一旦照片保存在磁盘上，我要求从照片路径`PhotoLib`创建一个新的`PhotoCell`

我希望我`PhotoCell`的触摸启用，所以当我点击它时，它会以模态方式打开第二个视图，但从我读到的内容，我无法从我的`PhotoCell`或内部的 UIImageView（不是控制器）执行此操作。

那我该怎么办？`View`嵌入在 NavigationController 中，即使下面的屏幕截图中没有显示。

谢谢 ！

![从 XCode 查看](../Images/56a70016cf1217f9ca5a24a499be9c0a.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T18:15:53.707

如果你在 photolib 中创建 Photocell，那么 photolib 应该从 photocell 实现委托方法。但是 photolib 本身不是 rootviewcontroller，所以它应该自己声明委托方法，并且包含的​​视图应该实现它。

基本上，您将 Photocell 从自身传递给 Photolib（实现委托方法

```
-(void) openPhotoCell:(Photocell*)cell
{
  [self.delegate openPhotocell:(Photocell*)cell];
} 
```

，然后将其传递给 View，后者又将其打开。

这看起来像是从耳朵里拔牙，但实际上它很有效，如果你编写了很好的不言自明的代码，那不是问题。我目前正在做一个有几十个视图和控制器的大项目，它工作得很好，没有人对此有任何问题。

如果您有更多层，那么也许您应该查看 NSNotification。

希望它有所帮助，我很乐意解释更多。

升级版：

链接：

[关于可可基础指南中的代表](http://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/CocoaFundamentals/CommunicatingWithObjects/CommunicateWithObjects.html#//apple_ref/doc/uid/TP40002974-CH7-SW18)

[维基百科中的委托模式](http://en.wikipedia.org/wiki/Delegation_pattern)

# css - 背景图像慢速滚动

> ID：11123488
> 
> 赞同：1
> 
> 时间：2012-06-20T15:58:59.060
> 
> 标签：css

我正在尝试使用 css3 实现根据屏幕大小自动调整大小的背景图像。我在使用 Chrome 时遇到了一个问题，它使网站垂直滚动变得非常缓慢。这不会发生在 Opera、Firefox 或 IE 上。我在我的 css 代码中遗漏了一个声明还是 Chrome 是罪魁祸首？

```
 body { 
 background: #000 url(../images/bg.jpg) no-repeat center center fixed;  
 -webkit-background-size: cover;    
 -moz-background-size: cover;   
 -o-background-size: cover;  
 padding: 0; 
 margin: 0 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-24T18:02:51.823

我可能有点晚了，但我自己也遇到了类似的问题，在这里找到了问题的答案：

[我的固定背景使网站滚动很慢，我可以做些什么来改善它？](https://stackoverflow.com/questions/7033979/my-fixed-background-made-scrolling-the-site-very-slow-what-can-i-do-to-improve)

似乎 background-size 属性是导致问题的原因。当然删除它会引发某些浏览器的其他问题，但也许使用这个 Jquery 插件可能会解决这个问题，但我自己还没有测试过： [http ://srobbin.com/jquery-plugins/backstretch/](http://srobbin.com/jquery-plugins/backstretch/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-20T17:34:23.933

可能这一切都取决于在 mac os 中的渲染。Mac os 在 windows 中使用 opengl 而不是 Direct3d。尝试在 chrome 中禁用\启用硬件加速并检查它是如何工作的

# css - Firefox/Mac 和 iPad 中的@font-face 问题

> ID：11123489
> 
> 赞同：2
> 
> 时间：2012-06-20T15:59:00.460
> 
> 标签：css, ipad, firefox, font-face

我有一些奇怪的问题需要解决。

首先，让我在我的 CSS 文件中显示我的 @font-face 声明。

```
@font-face {
font-family: "Conv_Gotham-Book";
src: url("fonts/Gotham-Book.eot");
src: local("☺"), 
    url("fonts/Gotham-Book.woff") format("woff"), 
    url("fonts/Gotham-Book.ttf") format("truetype"), 
    url("fonts/Gotham-Book.svg#Gotham-Book") format("svg");
font-weight: normal;
font-style: normal;
}

@font-face {
font-family: "Conv_Gotham-Light";
src: url("fonts/Gotham-Light.eot");
src: local("☺"),
    url("fonts/Gotham-Light.woff") format("woff"), 
    url("fonts/Gotham-Light.ttf") format("truetype"), 
    url("fonts/Gotham-Light.svg#Gotham-Light") format("svg");
font-weight: normal;
font-style: normal;
}

@font-face {
font-family: "Conv_Gotham-Medium";
src: url("fonts/Gotham-Medium.eot");
src: local("☺"), 
    url("fonts/Gotham-Medium.woff") format("woff"), 
    url("fonts/Gotham-Medium.ttf") format("truetype"), 
    url("fonts/Gotham-Medium.svg#Gotham-Medium") format("svg");
font-weight: normal;
font-style: normal;
}

@font-face {
font-family: "Conv_Gotham-Bold";
src: url("fonts/Gotham-Bold.eot") format("eot");
src: local("☺"),
    url("fonts/Gotham-Bold.woff") format("woff"), 
    url("fonts/Gotham-Bold.ttf") format("truetype"), 
    url("fonts/Gotham-Bold.svg#GothamBold") format("svg");
font-weight: normal;
font-style: normal;
} 
```

问题：使用任何这些自定义字体的超链接仅在一个浏览器/平台组合 Firefox 13.0.1/Mac 中不起作用（例如：http://lonely-dev.com/leapfrogbeta/?page_id=896[在](http://lonely-dev.com/leapfrogbeta/?page_id=896)标题上， )

第二个问题：字体在 iPad2/Safari 浏览器上消失。

其他一切都很好，希望有一些见解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T18:15:08.380

您已声明在您的 css 中使用名为“Journal”的字体`.custom .headline_area h2 a`，`custom.css`而在上面的代码示例中，您正在调用 Gotham Family（顺便说一句，目前没有网络许可证）。日记在 Firefox/Mac 和 iPad/Safari 中都正确加载。链接在两者中都有效。

更新：字体在所有提到的情况下都可以正常加载，但链接不起作用。这是因为`a`它是一个内联元素。此外，声明标题的高度`a`是一个坏主意。只需使用此规则：

```
.custom .headline_area h2 a {
  display: block;
} 
```

并且链接将起作用。

另一件事是您应该在 h1、h2 等上声明标题字体，而不仅仅是在它们包含的链接上。

# wpf - 更改按钮图像问题

> ID：11123491
> 
> 赞同：2
> 
> 时间：2012-06-20T15:59:11.693
> 
> 标签：wpf, image, xaml, controls

我在 WPF 中工作，我正在尝试更改按钮的图像，我创建了一些触发器和设置器，但它不起作用。

这是我的 XAML 代码：

```
<Button BorderThickness="0" Height="23" HorizontalAlignment="Left" Margin="59,6,0,0" Name="topButton" Width="26"  VerticalAlignment="Top"  
            Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}" IsEnabled="False" >
        <StackPanel>
            <Image>
                <Image.Style>
                    <Style TargetType="Image">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding ElementName=topButton, Path=Button.IsEnabled}" Value="True">
                                <Setter Property="Image.Source" Value="Images/MoveFirst_Enabled.bmp" />
                            </DataTrigger>
                            <DataTrigger Binding="{Binding ElementName=topButton, Path=Button.IsEnabled}" Value="False">
                                <Setter Property="Image.Source" Value="Images/MoveFirst_Disabled.bmp" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Image.Style>
            </Image>
        </StackPanel>
    </Button> 
```

我无法意识到我做错了什么。希望您能够帮助我。先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T16:24:56.630

删除. `Button.`_ `Path`所以而不是

```
Path=Button.IsEnabled 
```

你应该有

```
Path=IsEnabled 
```

*例子*

```
<Button BorderThickness="0" Height="23" HorizontalAlignment="Left" Margin="59,6,0,0" Name="topButton" Width="26"  VerticalAlignment="Top"               Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}" IsEnabled="False">
    <StackPanel>
        <Image>
            <Image.Style>
                <Style TargetType="Image">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding ElementName=topButton, Path=IsEnabled}" Value="True">
                            <Setter Property="Source" Value="Images/MoveFirst_Enabled.bmp" />
                        </DataTrigger>
                        <DataTrigger Binding="{Binding ElementName=topButton, Path=IsEnabled}" Value="False">
                            <Setter Property="Source" Value="Images/MoveFirst_Disabled.bmp" />
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Image.Style>
        </Image>
    </StackPanel>
</Button> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T16:21:13.583

我认为您没有使用正确的 Uri 字符串作为图像的来源。

```
<Button BorderThickness="0" Height="23" HorizontalAlignment="Left" Margin="59,6,0,0" Name="topButton" Width="26"  VerticalAlignment="Top"  
                Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}" IsEnabled="False" >
            <StackPanel>
                <Image>
                    <Image.Style>
                        <Style TargetType="Image">

                                <!-- If you are using the Image as a Resource, you should use the following format.-->

                            <Style.Triggers>    
                                <DataTrigger Binding="{Binding ElementName=topButton, Path=Button.IsEnabled}" Value="True">
                                    <Setter Property="Image.Source" Value="assemblyname;component/Images/MoveFirst_Enabled.bmp" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding ElementName=topButton, Path=Button.IsEnabled}" Value="False">
                                    <Setter Property="Image.Source" Value="assemblyname;component/Images/MoveFirst_Disabled.bmp" />
                                </DataTrigger>
                            </Style.Triggers>

                           <!-- If you are using the Image as Content then you should use the below format.-->

                            <Style.Triggers>    
                                <DataTrigger Binding="{Binding ElementName=topButton, Path=Button.IsEnabled}" Value="True">
                                    <Setter Property="Image.Source" Value="Images/MoveFirst_Enabled.bmp" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding ElementName=topButton, Path=Button.IsEnabled}" Value="False">
                                    <Setter Property="Image.Source" Value="Images/MoveFirst_Disabled.bmp" />
                                </DataTrigger>
                            </Style.Triggers>

                        </Style>
                    </Image.Style>
                </Image>
            </StackPanel>
        </Button> 
```

我希望它可以帮助你...

# racket - this-expression-file-name 的新名称是什么？

> ID：11123493
> 
> 赞同：2
> 
> 时间：2012-06-20T15:59:25.503
> 
> 标签：racket

我需要返回表达式路径的函数的名称。在旧的 mzscheme 时代，这两个函数被调用`this-expression-file-name`，`this-expression-source-directory`但是它们在 Racket 中是什么命名的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T19:47:38.000

`this-expression-file-name`您仍然可以`this-expression-source-directory`在`mzlib/etc`. 但通常现在您会使用`define-runtime-path`来处理`this-expression-source-directory`和直接访问文件名的语法对象。

# django - Django，如何连接（和范围）facebook 和 django-userena 或类似的

> ID：11123494
> 
> 赞同：2
> 
> 时间：2012-06-20T15:59:27.140
> 
> 标签：django, django-models, django-registration, django-facebook

它已在 Django-facebook 中明确编写，他们建议将其与 Userena 一起使用：

> 我们推荐使用 Django Userena。它似乎比 Django 注册更容易使用。两者都受支持并且是很好的软件包。要使用 django userena，只需指向 userena 兼容层。

```
AUTH_PROFILE_MODULE = 'django_facebook.FacebookProfile' 
```

我的问题来自`AUTH_PROFILE_MODULE = 'django_facebook.FacebookProfile'`部分。我在**Userena**中开发了自己的**UserProfile** ，并根据自己的需要继承了一些系统 Actor，例如 Student 和 Tutors。所以我的设置是这样的：

 **```
AUTH_PROFILE_MODULE = 'profiles.UserProfile' 
```

在 django-facebook 中还有一个很棒的示例项目，用于混合 userena 和 django-facebook 设置。但是我的问题依然存在。。

我应该用facebook的代码替换我自己的代码吗？

这是我的代码：

```
from django.db import models
from django.contrib.auth.models import User
from django.utils.translation import ugettext as _
from django.db.models import permalink

from userena.models import UserenaBaseProfile

from courses.models import Course

class UserProfile(UserenaBaseProfile):
    user = models.OneToOneField(User, unique=True, verbose_name=_('user'), related_name='user_profile')
    department     = models.ForeignKey('Department' , null = True , blank = True , related_name=_('user'))
    name           = models.CharField(max_length = 100)
    birthday       = models.DateField()

    def __unicode__(self):
        return self.name

class Student(UserProfile):
    courses = models.ManyToManyField(Course , null = True, blank = True, related_name = _('student')) 
```

提前谢谢..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T10:17:11.987

只需将 Facebook 所需的字段添加到您现有的个人资料中。

类 UserProfile(UserenaBaseProfile, FacebookProfileModel): ....

（https://docs.djangoproject.com/en/dev/topics/db/models/#model-inheritance）**

# jquery - 倒计时然后重定向jquery

> ID：11123497
> 
> 赞同：-1
> 
> 时间：2012-06-20T15:59:30.847
> 
> 标签：jquery, timer, hyperlink, countdown

```
<a href="javascript:void(0)" data-url="http://google.com" class="red"> 
```

基本上，一旦用户单击它，就会出现一个带有计时器的灯箱，然后使用 data-url 进入 url。那可能吗？

* * *

你也将如何结合这些，

```
 jQuery(document).ready(function(){

var link = document.getElementsByTagName("a")[0];

    link.onclick = function(){
       $('.lightbox').show();
        setTimeout(function(){window.location.href = link.getAttribute("data-url")}, 1000)
    }

});

$(function(){
  var count = 10;
  countdown = setInterval(function(){
    $("p.countdown").html(count + " seconds remaining!");
    if (count == 0) {
      window.location = 'http://google.com';
    }
    count--;
  }, 1000);
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T16:04:25.377

非常简单的示例，应该可以帮助您入门。

```
var link = document.getElementsByTagName("a")[0];

    link.onclick = function(){
        // make the modal popup here.
        alert("imma let you finish but first imma take you to a new webapge in 1 second");

        // after the setTimeout go to a new page
        setTimeout(function(){window.location.href = link.getAttribute("data-url")}, 1000)
    }
​ 
```

**[现场演示](http://jsfiddle.net/loktar/QsKJF/)**

（注意，由于 jsFiddle，live demo 实际上不会转发）

# android - 查询 spotify web-api 返回 404

> ID：11123499
> 
> 赞同：0
> 
> 时间：2012-06-20T15:59:33.130
> 
> 标签：android, spotify, asp.net-web-api

在我的 android 应用程序中，当我尝试解析 spotify web api 时，页面返回 404。 URL 对我来说似乎没问题（http://ws.spotify.com/search/1/album.xml?q=album: 'Meteora'+艺术家：'Linkin Park'），但返回 404。

这是我的代码：

```
 url = new URL("http://ws.spotify.com/search/1/album.xml?q=album:'" + albumName + "'+artist:'" +artistName +"'");

        urlc = url.openConnection();
        urlc.addRequestProperty("User-Agent", userAgent);
        Log.v(TAG_SPOTIFY, "User-agent set: " + userAgent);
        return this.parseSpotifyURI(urlc.getInputStream()); 
```

这是错误：

```
06-20 16:51:00.846: W/System.err(4962): java.io.FileNotFoundException: http://ws.spotify.com/search/1/album.xml?q=album:'Meteora'+artist:'Linkin Park'
06-20 16:51:00.846: W/System.err(4962):     at libcore.net.http.HttpURLConnectionImpl.getInputStream(HttpURLConnectionImpl.java:177)
06-20 16:51:00.846: W/System.err(4962):     at com.micky.scanthings.music.ParseMusic.getSpotifyURI(ParseMusic.java:489)
... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:17:29.317

好吧，我的坏。我的 URL 没有以 UTF8 编码，因此 Spotify 以 404 响应。解决方案是这样解析专辑名称和艺术家：

```
String myURL = "album:'" + albumName + "'+artist:'" +artistName +"'";
url = new URL("http://ws.spotify.com/search/1/album.xml?q=" + URLEncoder.encode(myURL,"UTF-8")); 
```

然后用这个 URL 做任何我们想做的事情。

# jquery - 使用jQuery设置所有供应商前缀版本的“width：calc ...”？

> ID：11123501
> 
> 赞同：5
> 
> 时间：2012-06-20T15:59:34.187
> 
> 标签：jquery, css, vendor-prefix

我正在使用一个使用 jQuery 的项目，我需要使用 jQuery 动态设置基于 calc() 的宽度。问题是要让 calc 工作，CSS 需要看起来像这样：

**CSS**

```
width: -moz-calc(33% - 50px);
width: -webkit-calc(33% - 50px);
width: calc(33% - 50px); 
```

当我尝试使用 jQuery`$(selector).css('width', 'calc(33% - 50px)')`时，我无法使用多个供应商前缀版本的 calc 设置宽度。在jQuery中处理同一CSS属性的多个设置以允许供应商前缀的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T01:25:49.900

您是否尝试过类似的方法：

```
calc = "calc(33% - 50px)";

if ($.browser.webkit) {
  calc = "-webkit-"+calc;
}

$(selector).css('width',calc); 
```

# javascript - 每次发生事件时如何调用特定页面？

> ID：11123504
> 
> 赞同：0
> 
> 时间：2012-06-20T15:59:48.167
> 
> 标签：javascript, jquery

我的 javascript 中有以下代码。

当用户单击特定复选框时，我会调用此函数，然后我只需更改此复选框的图像。

问题是我的 ExportaZap 只被访问一次，例如，如果现在在我的复选框中单击，我调用 ExportaZap.ashx，然后更改此复选框的图像。如果再次单击，他不会通过我的 ExportaZap.ashx。

在我的用户使用下面的函数单击我的复选框之前，我该如何调用 ExportaZap？

```
 function Visibilidade(id, imagemBaixa, credenciada) {
            $.get("../Action/ExportaZap.ashx", { id: id, imagemBaixa: imagemBaixa, credenciada: credenciada }, function (data) {
                if (data != "limite") {

                    if ($("#" + imagemBaixa).attr("src") == "../tema/default/images/CheckVerde.png") {
                        $("#" + imagemBaixa).attr("src", "../tema/default/images/CheckCinza.jpg");
                    }
                    else if ($("#" + imagemBaixa).attr("src") == "../tema/default/images/CheckCinza.jpg") {
                        $("#" + imagemBaixa).attr("src", "../tema/default/images/CheckVerde.png");
});
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T16:04:43.977

这样的事情应该可以解决问题：

```
$(document).ready(function(){
    $('input[type=checkbox]').click(function(){
        Visibilidade(this.id, imagemBaixa, credenciada);
    });
} 
```

# c++ - c++ 如何从派生类实例调用模板化基类函数

> ID：11123507
> 
> 赞同：1
> 
> 时间：2012-06-20T15:59:54.140
> 
> 标签：c++, templates, inheritance

找到了相关的问题，但不是确切的变体，所以我发布了一个非常简单的问题。派生类继承自一个模板化的基类，我想调用基类函数，怎么办？

```
template <class A>
class testBase {
public:
    void insert(const A& insertType) {
         // whatever
    }
};

class testDerived : testBase<double> {
     // whatever
};

int main() {

    testDerived B;

    // Compiler doesn't recognize base class insert
    // How do you do this?
    B.insert(1.0);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T16:03:13.840

需要`public`继承（默认`private`为`class`）：

```
class testDerived : public testBase<double> { 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T16:03:38.163

一个类的默认访问级别为“私有”。您基本上使用私有继承继承了“testBase”，因此 testBase 的公共接口不是 testDerived 的一部分。简单的解决方案：

```
class testDerived: public testBase<double> {...}; 
```

我确实希望 C++ 默认应用公共继承，因为这通常是更常见的情况。话又说回来，我们都可以使用结构来代替。:-D

# .htaccess - htaccess - 重定向子目录中的所有请求，除非请求的文件存在

> ID：11123508
> 
> 赞同：1
> 
> 时间：2012-06-20T15:59:56.013
> 
> 标签：.htaccess, mod-rewrite, redirect, subdirectory, file-exists

我正在用 php 开发一个应用程序，我需要设置一个相当广泛的 .htaccess 重定向。我做了一些阅读并尝试自己编写 RewriteConds，但它有点超出我的工资等级 - 我希望有更多经验的人可以提供帮助。这是我要完成的工作：

*   该应用程序包含在`www.example.com/app/`. 不要重定向此目录上方的任何内容。
*   此目录中存在一些需要访问的文件。目前这些是`/app/includes/*`和`/app/sb_pages/*`。这将在未来发生变化和扩展，因此我需要一个包含所有现有文件的优雅解决方案。如果找不到文件时在这些目录中触发重定向，那很好 - 我关心的是能够在没有重定向触发的情况下访问其中的文件。
*   所有其他请求都应重定向到`/app/index.php`，并在查询字符串中传递尾随 url。例如，一个请求`/app/path1/path2/`应该重定向到`/app/index.php?path=path1/path2/`
*   重定向不应该是透明的。当用户请求`/app/path1/path2/`时，我希望他们相信他们一直在那里。他们**不应该**看到 url 更改为`/app/index.php?path=path1/path2/`.

为了更清楚起见，这里有几个案例需要详细说明：

*   `/app/includes/sidebar.php`不应该重定向。
*   `/app/includes/nothing.html`不存在 - 重定向正常
*   `/app/path1/path2/`应该重定向到`/app/index.php?path=path1/path2/`. 用户仍应将其当前 URL 视为`/app/path1/path2/`.

我希望我已经清楚地解释了它并预先解决了大多数问题。如果您需要澄清，请不要犹豫。在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-20T17:44:52.670

尝试将此添加到文档根目录中的 .htaccess 文件中：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^app/(.*)$ /app/index.php?path=$1 [L,QSA] 
```

请注意，如果您希望不重定向对现有目录（而不是文件）的访问，请`RewriteCond %{REQUEST_FILENAME} !-d`在规则上方添加 a。

# javascript - Google Closure Compiler 的 Underscore.js externs

> ID：11123509
> 
> 赞同：3
> 
> 时间：2012-06-20T15:59:57.717
> 
> 标签：javascript, backbone.js, underscore.js, google-closure-compiler

我正在使用[Luke Rodgers 的 Backbone 和 Underscore externs](http://www.lukerodgers.ca/2012/05/closure-compiler-externs-files-for-underscore-and-backbone-js/)，但无法弄清楚为什么`_.extend`在编译输出中被修改。

例如，在 Backbone 0.9.2 中，以下代码 (193:195)：

```
if (defaults = getValue(this, 'defaults')) {
  attributes = _.extend({}, defaults, attributes);
} 
```

编译为：

```
if(c=r(this,"defaults"))a=f.extend({},c,a); 
```

我使用了以下编译命令：

```
java -jar compiler.jar 
     --externs backbone-0.9.2-externs.js 
     --externs underscore-1.3.3-externs.js 
     --compilation_level ADVANCED_OPTIMIZATIONS 
     --js underscore-1.3.3.js  
     --js backbone-0.9.2.js 
     --js_output_file compiled.js 
```

如果我包含另一个 JavaScript 文件：

```
 --js test.js 
```

其中包含以下内容：

```
_.extend({}, {name: 'test'}); 
```

中未修改`compiled.js`。

有谁知道为什么`_.extend`要修改backbone.js 中的调用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-20T16:40:35.377

很高兴您发现我的 externs 文件很有用。在我的脑海中，我相信您遇到的问题是由于您既使用 externs 文件又在编译库。

当库不是编译过程的一部分时，通常会使用 externs 文件。有些人可能只是使用（例如）jQuery、Underscore 等的预编译版本，或者链接到共享的 Google 库以利用预缓存的 js，但仍然想让 Closure Compiler 理解 jQuery 和 Underscore API，所以他们使用externs。

如果您要查找的是 Underscore 和 Backbone 库中的显式类型注释，那么这是一个稍微不同的问题。

# c# - 未显示模型上的显示名称？

> ID：11123513
> 
> 赞同：7
> 
> 时间：2012-06-20T16:00:26.537
> 
> 标签：c#, asp.net-mvc

我有一个类似于以下的模型类：

```
using System;
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations;
using System.Linq;
using System.Web;
using System.Web.Mvc;

[System.Runtime.Serialization.DataContract(IsReference = true)]
[System.ComponentModel.DataAnnotations.ScaffoldTable(true)]
public class TestModel
{
    [Display(Name="Schedule Name")]
    [Required]
    public string scheduleName;
} 
```

在我的 .cshtml 文件中，我有：

```
 <li>
            @Html.LabelFor(m => m.scheduleName)
            @Html.TextBoxFor(m => m.scheduleName, Model.scheduleName)
            @Html.ValidationMessageFor(m => m.scheduleName)
        </li> 
```

但由于某种原因，我的显示名称没有出现（标签显示“scheduleName”）

我发誓我在其他课程中也有相同的代码，而且它似乎显示得很好。谁能指出这行不通的原因？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-20T16:10:45.813

`DataAnnotationsModelMetadataProvider`关于属性的作品。您`scheduleName`应该是一个属性，而不是“只是”一个字段。

```
[System.Runtime.Serialization.DataContract(IsReference = true)]
[System.ComponentModel.DataAnnotations.ScaffoldTable(true)]
public class TestModel
{
    [Display(Name="Schedule Name")]
    [Required]
    public string scheduleName { get; set; }
} 
```

注意：根据 C# 命名约定，您的属性名称应为 PascalCased。

# actionscript-3 - 将数据从 iframe 传递到 flex

> ID：11123518
> 
> 赞同：1
> 
> 时间：2012-06-20T16:00:35.343
> 
> 标签：actionscript-3, flash, apache-flex, iframe

我已经在我的 flex 应用程序中实现了一个 iframe。iframe 包含一个谷歌地图和各种 JavaScript 函数，我可以成功地从我的 flex 应用程序中调用它们。

像这样

```
ExternalInterface.call("top.frames[0].addMarker", i, latitude, longitude, timestamp, user, state, datestring); 
```

但现在我想在另一个方向传递数据。

我找到了以下文章[http://webdevwonders.com/communication-between-flex-and-javascript/](http://webdevwonders.com/communication-between-flex-and-javascript/)

其中显示了 addcallback 的用法

```
ExternalInterface.addCallback( "iAmCalledFromJavascript", iAmCalledFromJavascript); 
```

我需要添加相同的 top.frames[0]。或不同的东西？

谢谢

文斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:04:46.470

不，您不需要添加**top.frames[0]。**因为您从 JavaScript 调用 Flex 内部的 ActionScript，并且 Flex 内部没有 DOM 框架之类的东西。

只需继续使用与以前相同的 JavaScript 方法即可：但可以在此处找到有关访问父 iframe 文档的更多详细信息 [http://www.esqsoft.com/javascript_examples/iframe_talks_to_parent/](http://www.esqsoft.com/javascript_examples/iframe_talks_to_parent/)

```
// This is the function that gets called from ActionScript
function iAmCalledFromAS(argument1, argument2) {

    // Do whatever you like in here
    return "result";
}

function initCommunication() {

    // 'FlexJSExample' is the id of the Flash object
    var flashObj = "FlexJSExample";
    parent.$("iframe").each(function(iel, el) {
      if(el.contentWindow === window)
        // call the previously in ActionScript defined callback function of the Flash object
        el[flashObj].iAmCalledFromJavascript("argument1", 2);
    });
   }
} 
```

# wpf - 防止 DataGrid 滚动捕捉到行

> ID：11123521
> 
> 赞同：5
> 
> 时间：2012-06-20T16:00:47.090
> 
> 标签：wpf, wpfdatagrid

我有一个 DataGrid，其中每一行都包含一个 ItemsControl。因此，网格的行可以非常高。如果一行高于网格的高度，我将无法滚动查看该行的其余部分，因为 DataGrid 会自动滚动到下一行。也就是说，如果我正在查看第 1 行的上半部分并单击垂直滚动条的向下箭头，它会跳到第 2 行的顶部。它不会让我看到第 1 行的下半部分。我该怎么做DataGrid 平滑滚动行而不是逐行步进？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-20T16:16:45.947

听起来您想禁用虚拟化。要做到这一点，只需设置`CanContentScroll`为`False`. `ScrollViewer`但是，如果您有大量数据，`DataGrid`则打开虚拟化可能会变得非常慢，因为所有数据都`DataGridRows`将立即生成，而不是在用户实际可见时生成。

```
<DataGrid ...
          ScrollViewer.CanContentScroll="False"> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-08-16T10:17:45.043

我遇到了滚动会粘在行上的问题。然后我遇到了：[https ://stackoverflow.com/a/13384164/4791472](https://stackoverflow.com/a/13384164/4791472)

```
<Datagrid ..
            VirtualizingPanel.ScrollUnit="Pixel" 
```

基本上它将滚动设置为对齐像素而不是项目。这将带来流畅的滚动体验。

# python - 用于目录的python n-ary树

> ID：11123522
> 
> 赞同：0
> 
> 时间：2012-06-20T16:00:51.773
> 
> 标签：python, tree

我在 python 中寻找一个答案来表示目录的 n 叉树。我认为文件夹的 N 叉树就是一个很好的例子。这是我的代码：

```
class Node(object):
    def __init__(self, data):
        self.data = data
        self.children = []

n = Node(sys.argv[1])

def walktree(top): # recurse from "/top/"

    X = [] # clear record
    for f in os.listdir(top):
        pathname = os.path.join(top,f)
        mode = os.stat(pathname)[ST_MODE]
        if S_ISDIR(mode):  # It's a directory
            X.append(pathname)  #
            walktree(pathname)  # recursion
    X.sort()
    n.add_child(X) 
```

我的问题是：

1.  这段代码正确吗？
2.  如何填充N叉树的给定节点
3.  如何遍历构造的 N 叉树

1、2、3 的答案。

```
def dirwalk(top): # build an n_ary tree 
    n = Node(top) # ONE Node per folder 
    for f in os.listdir(top): # loop over the current dir
        pathname = os.path.join(top,f) # dir + fname
        mode = os.stat(pathname)[ST_MODE]
        if S_ISDIR(mode):  # It's a directory
            ptr = dirwalk(pathname) # go down 
            n.add_child(ptr) # add pointer to node
    return n # return Node

def traverse(n): # traverse buildt tree
    for p in n:  # loop over children
        print p.data  
        traverse(p.children) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T16:45:02.030

This should be fairly trivial to implement using [os.walk](http://docs.python.org/library/os.html#os.walk):

```
class Node():
    def __init__(self, name):
        self.name = name
        self.files = []
        self.folders = {} 
    def __str__(self):
        return '%s: files: %s, folders: %s' % (self.name, self.files, self.folders)

def find_node(top_node, name):
    import pdb; pdb.set_trace()
    result = top_node
    path = name.split(os.sep)[1:]
    for path_comp in path:
        result = result.folders[path_comp]

    return result

import sys, os
tree = Node(sys.argv[1])
for root, folders, files in os.walk(sys.argv[1]):
    parent_node = find_node(tree, root)

    for folder in folders:
        parent_node.folders[folder] = Node(folder)

    for file in files:
        parent_node.files.append(file)

print tree 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T16:08:19.097

在我看来，pythonic 的方法就是使用嵌套列表。您可以通过元组表示一个目录，`(subdirs, files)`其中`subdirs`和`files`都是列表，`subdirs`包含更多元组，`files`是文件名列表。

构造示例，合并了 Niklas B 建议的 namedtuple：

```
import os, os.path
from collections import namedtuple

Directory = namedtuple('Directory', ['path', 'subdirectories', 'files'])

def walktree(path):
    dirs = []
    files = []
    for f in os.listdir(path):
        if os.path.isdir(os.path.join(path, f)):
            dirs.append(walktree(os.path.join(path, f)))
        else:
            files.append(f)
    return Directory(path, dirs, files) 
```

# java - 在 zipentry java 中查找文件

> ID：11123528
> 
> 赞同：5
> 
> 时间：2012-06-20T16:01:06.237
> 
> 标签：java, zipinputstream

我正在尝试在 zip 文件中查找文件并将其作为`InputStream`. 所以这就是我到目前为止所做的事情，我不确定我是否做得正确。

这是一个样本，因为原件稍长，但这是主要组成部分......

```
public InputStream Search_Image(String file_located, ZipInputStream zip) 
    throws IOException {
    for (ZipEntry zip_e = zip.getNextEntry(); zip_e != null ; zip_e = zip.getNextEntry()) {
        if (file_located.equals(zip_e.getName())) {
            return zip;
        }
        if (zip_e.isDirectory()) {
            Search_Image(file_located, zip); 
        }
    }
    return null;
} 
```

现在我面临的主要问题是`ZipInputStream`in与...`Search_Image`的原始组件相同`ZipInputStream`

```
if(zip_e.isDirectory()) {
    //"zip" is the same as the original I need a change here to find folders again.
    Search_Image(file_located, zip); 
} 
```

现在的问题是，您如何获得`ZipInputStream`新的`zip_entry`？如果我在我的方法中做错了什么，也请补充，因为我对这个类的逻辑仍然缺乏。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-20T16:13:13.677

`ZipFile`如果您还不需要它，您应该使用该类而不用担心输入流。

```
ZipFile file = new ZipFile("file.zip");
ZipInputStream zis = searchImage("foo.png", file);

public InputStream searchImage(String name, ZipFile file) {
  for (ZipEntry e : Collections.list(file.entries())) {
    if (e.getName().endsWith(name)) {
      return file.getInputStream(e);
    }
  }
  return null;
} 
```

一些事实：

*   您应该遵循代码中命名方法和变量的约定（`Search_Image`不好，`searchImage`是）
*   zip 文件中的目录不包含任何文件，它们只是与其他所有内容一样的条目，因此您不应尝试递归到它们）
*   您应该比较您提供的名称，`endsWith(name)`因为文件可能位于文件夹中，而 zip 中的文件名始终包含路径

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-10-12T18:18:08.113

使用 访问 zip 条目`ZipInputStream`显然不是这样做的方法，因为您需要遍历条目才能找到它，这**不是一种可扩展的方法**，因为性能将取决于 zip 文件中的条目总数。

为了获得最佳性能，您需要使用 a[`ZipFile`](https://docs.oracle.com/javase/8/docs/api/java/util/zip/ZipFile.html)来**直接访问条目**，这要归功于该方法，[`getEntry(name)`](https://docs.oracle.com/javase/8/docs/api/java/util/zip/ZipFile.html#getEntry-java.lang.String-)无论您的存档大小如何。

```
public InputStream searchImage(String name, ZipFile zipFile) throws IOException {
    // Get the entry by its name
    ZipEntry entry = zipFile.getEntry(name);
    if (entry != null) {
        // The entry could be found
        return zipFile.getInputStream(entry);
    }
    // The entry could not be found
    return null;
} 
```

请注意，此处提供的名称是存档中**图像的相对路径，**`/`用作路径分隔符，因此如果您要访问`foo.png`目录中的图像`bar`，则预期名称将为`bar/foo.png`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-24T04:24:51.190

这是我对此的看法：

```
ZipFile zipFile = new ZipFile(new File("/path/to/zip/file.zip"));
InputStream inputStream = searchWithinZipArchive("findMe.txt", zipFile);

public InputStream searchWithinZipArchive(String name, ZipFile file) throws Exception {
  Enumeration<? extends ZipEntry> entries = file.entries();
  while(entries.hasMoreElements()){
     ZipEntry zipEntry = entries.nextElement();
      if(zipEntry.getName().toLowerCase().endsWith(name)){
             return file.getInputStream(zipEntry);
      }
  }
  return null;
} 
```

# product - 在 Opencart product.tpl 上查看的产品

> ID：11123529
> 
> 赞同：-1
> 
> 时间：2012-06-20T16:01:18.777
> 
> 标签：product, opencart, viewer

如何在 opencart 产品页面上添加 product_viewed 来计算产品浏览量？

这是一张图片：

[图片 http://imglink.ru/pictures/20-06-12/094b53c8a98506e2c13f499289f8cec0.jpg](http://imglink.ru/pictures/20-06-12/094b53c8a98506e2c13f499289f8cec0.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T19:11:17.073

你应该可以添加

```
<?php echo $product_info['viewed']; ?> 
```

到您的模板 (product.tpl)

# java - 多线程客户端服务器在套接字上聊天。负载测试。接收失败

> ID：11123530
> 
> 赞同：1
> 
> 时间：2012-06-20T16:01:25.343
> 
> 标签：java, multithreading, sockets

大家好，有客户端服务器聊天，我尝试对其进行负载测试。我使用我的协议，它看起来像 XMPP。我发送 XML 并解析它。如果我启动服务器，对于某些用户来说它可以正常工作。但是我正在进行负载测试，并且正在启动很多用户并从每个用户发送消息。在测试中我没有创建新客户端，我只是用输出流实例化一个输出线程并使用它发送消息。服务器将收到的消息发送给所有用户，因此我创建了一个用户来监听其他用户。有时我会收到异常：**软件导致连接中止：recv failed**这是我的控制台：

```
06:55:49 Guest 9 (online)  says : Hello Server. Message number^4
06:55:49 Guest 9 (online)  says : Hello Server. Message number^5
06:55:49 Guest 11 (online)  says : Hello Server. Message number^0
06:55:49 Guest 4 (online)  says : Hello Server. Message number^6
ERROR ServerThread - Error in reading from stream: java.net.SocketException: Software caused connection abort: recv failed
ERROR ServerThread - Error in reading from stream: java.net.SocketException: Software caused connection abort: recv failed
06:55:49 Guest 9 (online)  says : Hello Server. Message number^6 
```

这是我的服务器线程。我跳过了它正在等待用户的部分。

```
public class ServerThread implements Runnable {
    private static final Logger LOG = Logger.getLogger(ServerThread.class);
    private XMLProtocol protocol;
    private Socket socket;
    private BufferedReader input;
    private PrintWriter out;
    private static Date date;
    private String username;
    private String status = "online";
    private SimpleDateFormat dateFormat;
    private String buffer = "";
    private JAXBContext jaxbContext;
    private Unmarshaller jaxbUnmarshaller;

    public ServerThread(Socket s) throws SAXException, IOException, JAXBException {
        input = new BufferedReader(new InputStreamReader(s.getInputStream()));
        jaxbContext = JAXBContext.newInstance(XMLProtocol.class);
        out = new PrintWriter(s.getOutputStream());
        username = "Guest " + Server.getUserCounter();
        dateFormat = new SimpleDateFormat("hh:mm:ss");
        Server.addUser(username, out);
        date = new Date();
        socket = s;
        new Thread(this);
    }

    public void run() {

        try {
            while (true) {
                if (input.ready()) {
                    if (buffer.length() <= 256) {
                        if ((buffer = input.readLine()).toString().endsWith("</XMLProtocol>")) {

                            protocol = new XMLProtocol();
                            jaxbUnmarshaller = jaxbContext.createUnmarshaller();
                            protocol = (XMLProtocol) jaxbUnmarshaller.unmarshal(new StreamSource(new StringReader(buffer)));

                            switch (ChatCommands.valueOf(protocol.getStatus())) {
                            case LOGIN: {
                                Server.sendToAll(Server.buildResponce("User: " + this.username + " Has been changed nickname on "
                                        + protocol.getContent()));
                                this.username = protocol.getContent();
                                break;
                            }
                            case STATUS: {
                                Server.sendToAll(Server.buildResponce("The user: " + this.username + " Is now:" + protocol.getContent()));
                                this.status = protocol.getContent();
                                break;
                            }
                            case LOGOUT: {
                                Server.sendResponce(Server.buildResponce(ResponseCommands.DISCONNECT), out);
                                quit();
                                break;
                            }
                            default: {
                                LOG.trace("Getting message from user: " + username + " recived message: " + protocol.getContent());
                                date = Calendar.getInstance().getTime();
                                Server.sendToAll(Server.buildResponce(dateFormat.format(date.getTime()) + " " + username + " ("
                                        + this.status + ") " + " says : " + protocol.getContent()));
                                break;
                            }
                            }
                        }
                    } else {
                        Server.sendResponce(Server.buildResponce(ResponseCommands.SENDING_FAILED), out);
                    }
                }
            }

        } catch (IOException e) {
            LOG.error("Error in reading from stream: " + e);
        } catch (JAXBException e) {
            LOG.error("Error in Marshalling: " + e);
        } finally {
            try {
                Server.sendResponce(Server.buildResponce(ResponseCommands.UNEXPECTED), out);
                quit();
                LOG.trace("Socket closed");
            } catch (IOException | JAXBException e) {
                LOG.error("Socket no closed" + e);
            }
        }
    }

    public void quit() throws IOException, JAXBException {
        Server.sendToAll(Server.buildResponce("User: " + this.username + " quited"));
        Server.removeUser(out);
        socket.shutdownInput();
        socket.shutdownOutput();
        socket.close();
    }
} 
```

这是我的测试

```
public class ServerLoadTest {

    private static ExecutorService exec = Executors.newFixedThreadPool(1000);
    private static Socket s[] = new Socket[50];// = new Socket();

    public static void main(String[] args) throws JAXBException, UnknownHostException, IOException, InterruptedException,
            XMLStreamException, ParserConfigurationException, SAXException {
        exec.execute(new TestServerThread()); // start Server thread
        Thread.sleep(500); // wait till Server starts.

        s[0] = new Socket("localhost", 4444);

        exec.execute(new InputThread(s[0], new BufferedReader(new InputStreamReader(s[0].getInputStream())))); // Start
                                                                                                                // one
        for (int i = 0; i < 20; i++) {
            exec.execute(new TestClientThread());           
        }
    }

}

class TestClientThread implements Runnable {
    private static final Logger LOG = Logger.getLogger(TestClientThread.class);
    private XMLProtocol protocol;
    private JAXBContext jaxbContext;
    private Marshaller jaxbMarshaller;
    private Socket socket;
    private OutputStream outputStream;

    public TestClientThread() throws JAXBException, UnknownHostException, IOException, InterruptedException, XMLStreamException,
            ParserConfigurationException, SAXException {
        jaxbContext = JAXBContext.newInstance(XMLProtocol.class);
        jaxbMarshaller = jaxbContext.createMarshaller();
        socket = new Socket("localhost", 4444);
        protocol = new XMLProtocol();
        outputStream = socket.getOutputStream();

        new Thread(this);

    }

    @Override
    public void run() {
        try {

            for (int i = 0; i < 10; i++) {
                protocol.setContent("Hello Server. Message number^" + i);
                protocol.setStatus(ChatCommands.MSG.getCommandCode());
                jaxbMarshaller.marshal(protocol, outputStream);
            }
            protocol.setContent("Hello Server. Message number^");
            protocol.setStatus(ChatCommands.LOGOUT.getCommandCode());
            jaxbMarshaller.marshal(protocol, outputStream);

/*          socket.shutdownInput();
            socket.shutdownOutput();
            socket.close();
            Thread.currentThread().interrupt();*/

        } catch (JAXBException  e) {
            LOG.trace("Error in marshaling ");

        }
    }
}

class TestServerThread implements Runnable {
    private Server server;

    public TestServerThread() {
        new Thread(this);
    }

    @SuppressWarnings("static-access")
    @Override
    public void run() {
        try {
            server.main(null);
        } catch (IOException | JAXBException | ParserConfigurationException | SAXException e) {
            Assert.assertFalse(false);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T06:14:21.063

我过去也遇到过这些错误。我认为，这些错误是由非同步资源引起的。但是我在 javadoc 中找不到指向我错误的内容。

所以我决定使用 jersey/grizzly 进行连接处理、数据编码等。如果你有兴趣，请阅读我的评论：[MultiClient / Server。处理通讯](https://stackoverflow.com/questions/11624752/multiclient-server-handle-communications/11625335#11625335)

但是，如果有人能告诉我们如何在繁重的并发环境中使用普通的旧套接字，我将不胜感激。

# python - python：基本 XML 解析错误（使用 lxml）

> ID：11123536
> 
> 赞同：1
> 
> 时间：2012-06-20T16:01:38.387
> 
> 标签：python, xml, xml-parsing

我正在尝试使用 lxml 使用 python 解析 XML 文件，但在基本尝试时出错。我使用[这篇文章](http://www.inductiveload.com/posts/simple-xml-parsing-with-python-and-lxml/)和[lxml 教程](http://lxml.de/index.html)来引导。

我的 XML 文件基本上是根据下面的记录构建的（我将其修剪下来以便于阅读）：

```
<?xml version="1.0" ?>
<?xml-stylesheet href="file:///usr/share/nmap/nmap.xsl" type="text/xsl"?>
<nmaprun scanner="nmap" args="nmap -sV -p135,12345 -oX 10.232.0.0.16.xml 10.232.0.0/16" start="1340201347" startstr="Wed Jun 20 16:09:07 2012" version="5.21" xmloutputversion="1.03">
<host>
  <hostnames>
    <hostname name="host1.example.com" type="PTR"/>
  </hostnames>
</host>
</nmaprun> 
```

我通过这个复杂的脚本运行它：

```
from lxml import etree

d = etree.parse("myfile.xml")
for host in d.findall("host"):
    aa = host.find("hostnames/hostname")
    print aa.attrib["name"] 
```

我`AttributeError: 'NoneType' object has no attribute 'attrib'`上`print`线了。我检查了的值`d`，它们都被定义为元素。`host``aa`

如果这是显而易见的事情（很可能是），请提前道歉。

**编辑：我按要求添加了 XML 文件的标题**（我仍在阅读和重新阅读答案:)）

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T16:07:02.757

您可以使用 xpath 表达式解决此问题。

```
d.xpath('//hostname/@name') # thank you for comment 
```

或者

```
for host in d.xpath('//hostname'):
    print host.get('name'), host.get('whatever else etc...') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T16:18:23.700

尽管使用 XPath 会更有意义，但您的代码在单独运行时已经可以正常工作，只要处理主机未找到主机名的情况：

```
doc = lxml.etree.XML("""
  <nmaprun>
    <host>
      <hostnames>
        <hostname name="host1.example.com" type="PTR"/>
      </hostnames>
    </host>
  </nmaprun>""")
for host in doc.findall('host'):
  host_el = host.find('hostnames/hostname')
  if host_el is not None:
    print host_el.attrib['name'] 
```

使用 XPath（`doc.xpath()`而不是`doc.find()`or `doc.findall()`），可以做得更好，只过滤带有名称的主机名，从而完全避免错误记录：

*   `host[hostnames/hostname/@name]`将找到`host`至少`hostnames`有一个`hostname`带有 aa`name`属性的 s。
*   `//hostnames/hostname/@name`将直接只返回名称本身（如果使用`lxml`，则将它们公开为字符串）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T16:21:48.610

看起来您可能有一些`<host>`元素没有`<hostnames>`或没有`<hostname>`定义子元素。

正如@Charles Duffy 对您的问题的评论中所建议的那样，您需要检查您的调用是否`find()`找到了一个元素

```
for host in d.findall("host"):
    aa = host.find("hostnames/hostname")
    if aa:
        print aa.attrib["name"] 
```

# jquery - jquery 调整 div 大小

> ID：11123539
> 
> 赞同：0
> 
> 时间：2012-06-20T16:01:42.237
> 
> 标签：jquery

我正在编写一个小函数来调整我的搜索 div 的大小以保持与下面的动态表相同的宽度。为什么如果我不使用函数它会工作，如果我使用该函数会失败。我想为此使用一个函数，因为我有多个网格视图/搜索。

Javascript代码

```
 $(document).ready(function() {
                   function ResizeSearch(GridID, SearchID) {                              
                          alert("\"" + GridID + "\"" + ' ' + "\"" + SearchID + "\"");
                          var eleWidth = $("\"" + GridID + "\"").width();
                           $("\"" + SearchID + "\"").width(eleWidth);
                       };
                       $("#getp").click(function() {
                       ResizeSearch("$(#<%= gvValidStatus.ClientID %>)", "$(#ValidStatusSearch)");
                       /* 
                       ****** Why does this work, but when passing to function it does not? ******
                       var eleWidth = $("#<%= gvValidStatus.ClientID %>").width();
                       $("#ValidStatusSearch").width(eleWidth);
                       */
                       });
                   }); 
```

警报的输出

```
---------------------------
Windows Internet Explorer
---------------------------
"$(#ctl00_Content_gvValidStatus)" "$(#ValidStatusSearch)"
---------------------------
OK   
--------------------------- 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:08:03.630

试试这样：

```
function ResizeSearch(GridID, SearchID) {                              
    var eleWidth = $("#"+GridID).width();
    $("#"+SearchID).width(eleWidth);
}
$("#getp").click(function() {
    ResizeSearch("<%= gvValidStatus.ClientID %>", "ValidStatusSearch");
}); 
```

# caching - 相当于 Memcached 中的 Redis 哈希？

> ID：11123540
> 
> 赞同：3
> 
> 时间：2012-06-20T16:01:42.660
> 
> 标签：caching, memcached, redis

我正在为我们的应用程序制定缓存策略，它同时使用 Redis 和 Memcached。

我们生成相当长的缓存数据 JSON 字符串，从我们的 SQL 数据库计算。由于缓存的数据是一次性的，所以我想使用 Memcached，这样它就会驱逐我们不再需要的键。

问题是可以从不同的参数访问一个集合（例如，用户）。在 Redis 中，我会使用哈希，因此我可以访问`hget`该哈希中的键`del`（但是，我找不到像 Memcached 那样将旧键逐出到给定数据库大小的方法。

所以我的问题是：

*   如何设置 Redis 以保持最大 DB 大小并根据需要逐出键？，或
*   如何在 Memcached 中对 Redis 哈希建模，以便我可以轻松地使一组密钥过期？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T17:41:57.493

To configure Redis so it has a memcached-like cache behavior, you need to update the configuration file as follows:

*   set a value for maxmemory (in bytes)
*   set the maxmemory-policy to allkeys-lru

You should get the behavior you want.

# android - 警报管理器重复

> ID：11123543
> 
> 赞同：5
> 
> 时间：2012-06-20T16:01:57.233
> 
> 标签：android, time, notifications, alarmmanager

我有一个警报，它在特定时间发送通知（如果那天有联系人的生日）。

我需要的是，当我设置闹钟时，它应该每年在同一天同一时间重复。我怎么能那样做？

```
Intent myIntent = new Intent(Main.this, MyAlarmService.class);
pendingIntent = PendingIntent.getService(Main.this, 0, myIntent, 0);

AlarmManager alarmManager = (AlarmManager)getSystemService(ALARM_SERVICE);

Calendar cal = Calendar.getInstance();
cal.setTimeInMillis(System.currentTimeMillis());
cal.clear();
cal.set(2012,5,20,18,40);

alarmManager.set(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(), pendingIntent);

alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(), 60*60*24*365*1000, pendingIntent); 
```

这是警报服务：

```
public class MyAlarmService extends Service {
  static final int uniqueID = 1394885;
  private PendingIntent pendingIntent;

  @Override
  public void onCreate() {
    // TODO Auto-generated method stub
    Toast.makeText(this, "MyAlarmService.onCreate()", Toast.LENGTH_LONG).show();

  }

  @Override
  public IBinder onBind(Intent intent) {
    // TODO Auto-generated method stub
    Toast.makeText(this, "MyAlarmService.onBind()", Toast.LENGTH_LONG).show();
    return null;
  }

  @Override
  public void onDestroy() {
    // TODO Auto-generated method stub
    super.onDestroy();
    Toast.makeText(this, "MyAlarmService.onDestroy()", Toast.LENGTH_LONG).show();
  }

  @Override
  public void onStart(Intent intent, int startId) {
    // TODO Auto-generated method stub

  }

  @Override
  public boolean onUnbind(Intent intent) {
    // TODO Auto-generated method stub
    Toast.makeText(this, "MyAlarmService.onUnbind()", Toast.LENGTH_LONG).show();
    return super.onUnbind(intent);
  }
} 
```

请问你能帮帮我吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-10-31T04:27:15.913

```
Intent intent = new Intent(this, MyReceiver.class);
intent.putExtra("key", "Alert");
pendingIntent = PendingIntent.getBroadcast(this.getApplicationContext(), 0, intent, 0);

alarmManager = (AlarmManager) getSystemService(ALARM_SERVICE);
Calendar calendar=Calendar.getInstance();

// Calendar.set(int year, int month, int day, int hourOfDay, int minute, int second)
calendar.set(2013, Calendar.OCTOBER, 13, 18, 55, 40);
alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, calendar.getTimeInMillis(), 5*1000, pendingIntent); 
```

此参数是警报的后续重复之间的间隔（以毫秒为单位）：

> 5*1000 = 5 秒

样本：

> 1 年 = 365（天）* 24（小时）* 60（分钟）* 60（秒）* 1000（秒 -> 毫秒）；
> // 闰年 366 天

月份值是从 0 开始的，因此使用常量可能更清楚`Calendar.OCTOBER`

MyReceiver.java

```
public class MyReceiver extends BroadcastReceiver {

  @Override
  public void onReceive(Context context, Intent intent) {
       Toast.makeText(context,intent.getStringExtra("key"),Toast.LENGTH_SHORT).show();
  }

} 
```

**更新**：注意：从 API 19 (Build.VERSION_CODES.KITKAT) 开始，警报传递不准确：操作系统将切换警报以最大程度地减少唤醒和电池使用。有新的 API 来支持需要严格交付保证的应用程序；参见 setWindow(int, long, long, PendingIntent) 和 setExact(int, long, PendingIntent)。targetSdkVersion 早于 API 19 的应用程序将继续看到以前的行为，即所有警报都在请求时准确传递。[参考](https://developer.android.com/reference/android/app/AlarmManager)

我建议将[JobScheduler](https://developer.android.com/reference/android/app/job/JobScheduler.html)用于 android 21 或[Firebase JobDispatcher](https://github.com/firebase/firebase-jobdispatcher-android)用于旧设备，而不是 Alarm Manager

**更新**：Google 已将 WorkManager 作为 JetPack [Schedule 任务的一部分与 WorkManager 一起发布](https://developer.android.com/topic/libraries/architecture/workmanager)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-20T16:11:09.553

使用设置闹钟`alarmManager.set()`

```
Intent myIntent = new Intent(Main.this, MyAlarmService.class);
pendingIntent = PendingIntent.getService(Main.this, 0, myIntent, 0);

AlarmManager alarmManager = (AlarmManager)getSystemService(ALARM_SERVICE);

Calendar cal = Calendar.getInstance();
cal.setTimeInMillis(System.currentTimeMillis());
cal.clear();
cal.set(2012,5,20,18,40);

alarmManager.set(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(), pendingIntent); 
```

并且，当闹钟响起时，从`MyAlarmService`.

# c# - 使用ajax将javascript数组发送到代码后面（c＃）

> ID：11123545
> 
> 赞同：10
> 
> 时间：2012-06-20T16:02:03.053
> 
> 标签：c#, javascript, jquery, asp.net, webforms

我对 C# 和 javascript 有点陌生，所以虽然我的问题很具体，但我愿意接受任何替代方案。

我有一个值数组（我在 javascript 函数中创建），我想将其发送到我的代码隐藏文件以在方法中使用。从我使用 ajax 研究并使用 JSON 对数组进行字符串化似乎是最好的方法。

我的问题是

1.  我可以使用这种方法传递数组吗？

2.  如何捕获服务器端的信息（在我的代码隐藏中？）

Javascript 传递值

```
var jsonvalues = JSON.stringify(values);
var callback = window.location.href
$.ajax({
  url: callback
  type: "POST",
  contentType: 'application/json',
  data: jsonvalues
}); 
```

我见过许多使用 [WebMethod] 或某种 WebService 来捕获数据的解决方案，我可以使用它在我的代码隐藏文件中工作而无需返回数据吗？

这是我在代码隐藏文件中使用的内容

```
[WebMethod]
public static void done(string[] ids)
{
String[] a = ids;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-20T21:23:53.997

我已经为此使用 ASP.NET MVC 编写了一个深入的示例，但它可以很容易地适用于 WebForms。

[使用 jquery 将数据发送到 MVC 控制器](https://stackoverflow.com/questions/11016388/send-data-with-javascript-to-an-mvc-action)

除了调用 WebMethod 的位置之外，HTML 和 jQuery 看起来几乎完全相同。

如果您正在使用的页面被调用`Default.aspx`，并且该方法被调用`Done`，那么您的 WebMethod 的 URL 将是`Default.aspx/Done`。

```
<script>
       // Grab the information 
       var values = {"1,","2","3"};
       var theIds = JSON.stringify(values);

       // Make the ajax call
       $.ajax({
         type: "POST",
         url: "Default.aspx/Done", // the method we are calling
         contentType: "application/json; charset=utf-8",
         data: {ids: theIds },
         dataType: "json",
         success: function (result) {
             alert('Yay! It worked!');               
         },
         error: function (result) {
             alert('Oh no :(');
         }
     });
  </script> 
```

你的`WebMethod`将仍然是一样的。

```
[WebMethod]
public static void done(string[] ids)
{
   String[] a = ids;
   // Do whatever processing you want
   // However, you cannot access server controls
   // in a static web method.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T16:08:23.333

最简单的方法是使用 ASP.NET MVC 并将数据绑定到一个列表。因此，对于字符串列表，这将非常容易。只需进行如下所示的控制器操作：

```
[HttpPost]
public ActionResult MyAction(string[] values)
{
    ... debug and see that values gets set to your array from javascript ...
} 
```

然后传递`data: values`你的`$.ajax`电话。不需要字符串化，jQuery 会弄清楚该怎么做。对于更复杂的列表绑定，请查看此（以及许多其他资源，例如它谈论绑定到复杂对象列表的奇特方法）：

[http://blog.stevensanderson.com/2010/01/28/editing-a-variable-length-list-aspnet-mvc-2-style/](http://blog.stevensanderson.com/2010/01/28/editing-a-variable-length-list-aspnet-mvc-2-style/)

`[WebMethod]`要从网页或 Web 服务调用方法，请查看本指南：

[http://encosia.com/using-jquery-to-directly-call-aspnet-ajax-page-methods/](http://encosia.com/using-jquery-to-directly-call-aspnet-ajax-page-methods/)

基本上虽然你需要的网址是`ServicePage.aspx/MethodName`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-20T21:11:14.700

使用 runat=server 将您的数据放在隐藏字段中。发布表单并正常获取数据。

# c# - 使用反射实例化对象内部的控件属性

> ID：11123547
> 
> 赞同：0
> 
> 时间：2012-06-20T16:02:18.857
> 
> 标签：c#, .net, reflection, dynamic, instantiation

我正在测试无法轻松编辑的预先存在的代码中的逻辑，但是代码所在的对象内部有 50 多个对象，无论出于何种原因，这些对象都为空。我要做的是：从我的测试代码中，使用反射，遍历我正在测试的类的所有内部对象，如果所述对象为空，则实例化它。这是我迄今为止所拥有的：

```
Type ucApprovedType = ucApproved.GetType();
System.Reflection.FieldInfo[] fieldInfo = ucApprovedType.GetFields(System.Reflection.BindingFlags.Public | System.Reflection.BindingFlags.NonPublic | System.Reflection.BindingFlags.Instance);

foreach (System.Reflection.FieldInfo ucFieldInfo in fieldInfo)
{
    Control control = ucApproved.FindControl(ucFieldInfo.Name);

    if (control == null)
        control = new Control();

    //Set instantiated control back to ucApproved item
} 
```

我在上面遇到的第一个问题是控件从 FindControl(ucFieldInfo.Name) 调用返回 null。然后，一旦我拥有了 instatiated 控件，我不知道如何将它的值设置回 ucApproved 对象，因为我不能这样做，`ucApproved.Controls[0] = control`因为 ControlCollection 是只读的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T16:48:55.833

您快到了，但直接使用 fieldInfo 对象来引用相关对象会更容易。尝试这个：

```
Type ucApprovedType = ucApproved.GetType();
System.Reflection.FieldInfo[] fieldInfo = ucApprovedType.GetFields(System.Reflection.BindingFlags.Public | System.Reflection.BindingFlags.NonPublic | System.Reflection.BindingFlags.Instance);

foreach (System.Reflection.FieldInfo ucFieldInfo in fieldInfo)
{
    //get its current value
    Control control = ucFieldInfo.GetValue(ucApproved) as Control;

    if (control == null)
    {
        control = new Control();

        //Set instantiated control back to ucApproved item
        ucFieldInfo.SetValue(ucApproved, control);
    }
} 
```

**警告** 这实际上只有在您在此循环中获得的唯一字段是字段时才有效`Control`。否则，您需要添加过滤语句。

```
if (ucFieldInfo.FieldType.IsInstanceOfType(typeof(Control)) || ucFieldInfo.FieldType.IsSubclassOf(typeof(Control))) 
```

或类似的。

**- - - -另外的选择 - - - - - -**

假设 ucApproved 是一个自定义用户控件，为什么不在控件类中创建一个公共实用程序函数来为您实例化控件。

是的，我看到你说“不能轻易去编辑”。我什至理解这个概念。然而，这是更容易的答案。调用`ucApproved.CreateControls();`将是一个更清洁的解决方案。

# c# - 在 Visual Studio 中加载第三方 DLL

> ID：11123548
> 
> 赞同：1
> 
> 时间：2012-06-20T16:02:24.700
> 
> 标签：c#, asp.net, visual-studio-2010, dll

我有两个问题。

问题1：

我们如何从文件夹中添加对网站/Web 应用程序中第三方 DLL（如 recaptcha）的引用。该文件夹可以出现在 C: 驱动器或网站/webapp 的根目录中的任何位置。

问题2：

是否可以使用 app/web.config 在网站/webapp 中添加对第三方 DLL 的引用？我知道如果将DLL添加到GAC就可以做到。除了这个方法，还有什么方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T16:10:54.820

对于你的第一个问题：

您可以从项目中添加它，打开 VS2010，在项目“引用”文件夹下的解决方案资源管理器中，右键单击 -> 添加引用 -> 查找 dll。

然后你只需要在你的代码中引用它。例如，我使用 Telerik 库，并通过以下方式引用：

前端：

```
<%@ Register TagPrefix="telerik" Namespace="Telerik.Web.UI" Assembly="Telerik.Web.UI" %> 
```

代码：

```
using Telerik.Web.UI; 
```

# xml - XSLT 在保持顺序的同时将重复元素转换为一个

> ID：11123551
> 
> 赞同：0
> 
> 时间：2012-06-20T16:02:35.097
> 
> 标签：xml, xslt

我正在尝试使用一个样式表来转换一些 XML，该样式表看起来像：

```
 <m10:RESPONSE_DETAIL> 
        <m10:LINE_NO>001</m10:LINE_NO> 
        <m10:APPR_ITEM_AMT>00000109</m10:APPR_ITEM_AMT> 
        <m10:APPR_ITEM_TAX>00000009</m10:APPR_ITEM_TAX> 
        <m10:TAX_FLAG>N</m10:TAX_FLAG> 
     </m10:RESPONSE_DETAIL> 
     <m10:RESPONSE_DETAIL> 
        <m10:LINE_NO>002</m10:LINE_NO> 
        <m10:APPR_ITEM_AMT>00000109</m10:APPR_ITEM_AMT> 
        <m10:APPR_ITEM_TAX>00000009</m10:APPR_ITEM_TAX> 
        <m10:TAX_FLAG>N</m10:TAX_FLAG> 
     </m10:RESPONSE_DETAIL> 
     <m10:RESPONSE_DETAIL> 
        <m10:LINE_NO>003</m10:LINE_NO> 
        <m10:APPR_ITEM_AMT>00000100</m10:APPR_ITEM_AMT> 
        <m10:APPR_ITEM_TAX>00000000</m10:APPR_ITEM_TAX> 
        <m10:TAX_FLAG>N</m10:TAX_FLAG> 
     </m10:RESPONSE_DETAIL> 
```

进入这个：

```
 <m10:RESPONSE_DETAIL> 
        <m10:LINE_NO>001</m10:LINE_NO> 
        <m10:APPR_ITEM_AMT>109</m10:APPR_ITEM_AMT> 
        <m10:APPR_ITEM_TAX>9</m10:APPR_ITEM_TAX> 
        <m10:TAX_FLAG>N</m10:TAX_FLAG> 
        <m10:LINE_NO>002</m10:LINE_NO> 
        <m10:APPR_ITEM_AMT>109</m10:APPR_ITEM_AMT> 
        <m10:APPR_ITEM_TAX>9</m10:APPR_ITEM_TAX> 
        <m10:TAX_FLAG>N</m10:TAX_FLAG> 
        <m10:LINE_NO>003</m10:LINE_NO> 
        <m10:APPR_ITEM_AMT>100</m10:APPR_ITEM_AMT> 
        <m10:APPR_ITEM_TAX>0</m10:APPR_ITEM_TAX> 
        <m10:TAX_FLAG>N</m10:TAX_FLAG> 
     </m10:RESPONSE_DETAIL> 
```

我在 xslt 方面不太强，所以这可能是基本的，但到目前为止我所尝试的一切都回来了：

```
 <m10:RESPONSE_DETAIL> 
        <m10:LINE_NO>001</m10:LINE_NO> 
        <m10:LINE_NO>002</m10:LINE_NO> 
        <m10:LINE_NO>003</m10:LINE_NO> 
        <m10:APPR_ITEM_AMT>109</m10:APPR_ITEM_AMT> 
        <m10:APPR_ITEM_AMT>109</m10:APPR_ITEM_AMT> 
        <m10:APPR_ITEM_AMT>100</m10:APPR_ITEM_AMT> 
        <m10:APPR_ITEM_TAX>9</m10:APPR_ITEM_TAX> 
        <m10:APPR_ITEM_TAX>9</m10:APPR_ITEM_TAX> 
        <m10:APPR_ITEM_TAX>0</m10:APPR_ITEM_TAX> 
        <m10:TAX_FLAG>N</m10:TAX_FLAG> 
        <m10:TAX_FLAG>N</m10:TAX_FLAG> 
        <m10:TAX_FLAG>N</m10:TAX_FLAG> 
     </m10:RESPONSE_DETAIL> 
```

任何建议将不胜感激...

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T16:34:16.027

这个 XSLT 1.0 样式表...

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:m10="m10">
<xsl:output method="xml" indent="yes"/>

<xsl:template match="@*|node()">
  <xsl:copy>
   <xsl:apply-templates select="@*|node()" /> 
  </xsl:copy>
</xsl:template>  

<xsl:template match="m10:RESPONSE_DETAIL[1]">
  <xsl:copy>
   <xsl:apply-templates select="@*" /> 
   <xsl:apply-templates select="../m10:RESPONSE_DETAIL/*" /> 
  </xsl:copy>    
</xsl:template>

<xsl:template match="m10:RESPONSE_DETAIL" />

</xsl:stylesheet> 
```

... 将转换此输入文档

```
<root xmlns:m10="m10" > 
<m10:RESPONSE_DETAIL> 
        <m10:LINE_NO>001</m10:LINE_NO> 
        <m10:APPR_ITEM_AMT>00000109</m10:APPR_ITEM_AMT> 
        <m10:APPR_ITEM_TAX>00000009</m10:APPR_ITEM_TAX> 
        <m10:TAX_FLAG>N</m10:TAX_FLAG> 
     </m10:RESPONSE_DETAIL> 
     <m10:RESPONSE_DETAIL> 
        <m10:LINE_NO>002</m10:LINE_NO> 
        <m10:APPR_ITEM_AMT>00000109</m10:APPR_ITEM_AMT> 
        <m10:APPR_ITEM_TAX>00000009</m10:APPR_ITEM_TAX> 
        <m10:TAX_FLAG>N</m10:TAX_FLAG> 
     </m10:RESPONSE_DETAIL> 
     <m10:RESPONSE_DETAIL> 
        <m10:LINE_NO>003</m10:LINE_NO> 
        <m10:APPR_ITEM_AMT>00000100</m10:APPR_ITEM_AMT> 
        <m10:APPR_ITEM_TAX>00000000</m10:APPR_ITEM_TAX> 
        <m10:TAX_FLAG>N</m10:TAX_FLAG> 
</m10:RESPONSE_DETAIL>
</root> 
```

按要求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T16:12:47.733

您发布的示例不是有效的 Xml 文档-您要转换的示例具有多个根元素，并且都没有显示 m10 前缀绑定到的名称空间。

您可以使用身份转换来实现您想要的。我修复了您的输入文档，以便可以编写 xslt。我的输入文档如下所示：

```
<root xmlns:m10="m10">
     <m10:RESPONSE_DETAIL>  
        <m10:LINE_NO>001</m10:LINE_NO>  
        <m10:APPR_ITEM_AMT>00000109</m10:APPR_ITEM_AMT>  
        <m10:APPR_ITEM_TAX>00000009</m10:APPR_ITEM_TAX>  
        <m10:TAX_FLAG>N</m10:TAX_FLAG>  
     </m10:RESPONSE_DETAIL>  
     <m10:RESPONSE_DETAIL>  
        <m10:LINE_NO>002</m10:LINE_NO>  
        <m10:APPR_ITEM_AMT>00000109</m10:APPR_ITEM_AMT>  
        <m10:APPR_ITEM_TAX>00000009</m10:APPR_ITEM_TAX>  
        <m10:TAX_FLAG>N</m10:TAX_FLAG>  
     </m10:RESPONSE_DETAIL>  
     <m10:RESPONSE_DETAIL>  
        <m10:LINE_NO>003</m10:LINE_NO>  
        <m10:APPR_ITEM_AMT>00000100</m10:APPR_ITEM_AMT>  
        <m10:APPR_ITEM_TAX>00000000</m10:APPR_ITEM_TAX>  
        <m10:TAX_FLAG>N</m10:TAX_FLAG>  
     </m10:RESPONSE_DETAIL>
</root> 
```

我创建了以下样式表：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:m10="m10">
    <xsl:output method="xml" indent="yes"/>

    <xsl:template match="@* | node()">
        <xsl:copy>
            <xsl:apply-templates select="@* | node()"/>
        </xsl:copy>
    </xsl:template>

  <xsl:template match="root">
    <m10:RESPONSE_DETAIL>
      <xsl:apply-templates />
    </m10:RESPONSE_DETAIL>
  </xsl:template>

  <xsl:template match="m10:RESPONSE_DETAIL">
    <xsl:apply-templates select="*"/>
  </xsl:template>
</xsl:stylesheet> 
```

它将您的输入文档转换为：

```
<?xml version="1.0" encoding="utf-8"?>
<m10:RESPONSE_DETAIL xmlns:m10="m10" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
     <m10:LINE_NO>001</m10:LINE_NO><m10:APPR_ITEM_AMT>00000109</m10:APPR_ITEM_AMT><m10:APPR_ITEM_TAX>00000009</m10:APPR_ITEM_TAX><m10:TAX_FLAG>N</m10:TAX_FLAG>  
     <m10:LINE_NO>002</m10:LINE_NO><m10:APPR_ITEM_AMT>00000109</m10:APPR_ITEM_AMT><m10:APPR_ITEM_TAX>00000009</m10:APPR_ITEM_TAX><m10:TAX_FLAG>N</m10:TAX_FLAG>  
     <m10:LINE_NO>003</m10:LINE_NO><m10:APPR_ITEM_AMT>00000100</m10:APPR_ITEM_AMT><m10:APPR_ITEM_TAX>00000000</m10:APPR_ITEM_TAX><m10:TAX_FLAG>N</m10:TAX_FLAG>
</m10:RESPONSE_DETAIL> 
```

# c# - 在 C# 中引用已处置的对象

> ID：11123552
> 
> 赞同：1
> 
> 时间：2012-06-20T16:02:41.157
> 
> 标签：c#, dispose, idisposable

如果这是一个愚蠢的问题，我很抱歉，但是在您明确处理一个对象之后，您不应该再次引用该对象......对吗？

示例：这通常是个坏主意，对吧？

```
SomeObject o = new SomeObject();

o.DoStuff();

o.Dispose();

o.DoMoreStuff(); 
```

另外，有没有必要做这样的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T16:11:59.637

处理一个对象会告诉它释放所有非托管资源，因此您必须问自己的问题是“如果没有这些资源，该对象是否可以做任何有意义的事情”。这将取决于对象的具体情况。

大多数`IDisposable`对象的设计是这样的，如果您在处理完实例后尝试调用它们的方法，它们将抛出异常，或者更糟的是，只会出现意外行为。

即使在被处置之后，其他对象仍有可能做有意义的事情。例如，DataTable 实现 IDisposable，但有意义的数据往往存储在托管资源中，而不是非托管资源中。在其当前的实现中（可能会发生变化），它的`Dispose`方法没有做任何事情，所以在它被处理后使用它就可以了。（话虽如此，当您仍打算使用它时， 没有令人信服的*理由将其丢弃。）*

也可以想象一个对象在它被处理后重新创建它需要的任何资源（这将是一个坏主意，但仍然*可能*）。

说了这么多，专门设计一个即使在它已经被处置后也打算使用的对象被认为是不好的做法，而且 Disposable 对象的意图也是在你完成之前不要处置它用它。这里的重点是，即使你不应该这样做，而且它经常会在你的脸上爆炸，这将是因为这就是选择实现类的方式（符合惯例）而不是因为它是技术要求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T16:10:02.503

除非你需要它，否则你永远不会 Dispose 一个对象。处理一个对象意味着你不再需要它了。当您不再需要该对象时，您将丢弃它（如果它是一次性的）。因此，在对象被处理后，就没有必要访问它了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T16:22:31.803

我喜欢在实现 IDisposable 时使用这种模式...

```
private bool m_disposed;

public void Dispose()
{
    Dispose(true);
    GC.SuppressFinalize(this);
}

public void Dispose(bool disposing)
{
    if (!m_disposed)
    {
        if (disposing)
            // Cleanup and close resources

        m_disposed = true;
    }
} 
```

然后在课堂上的所有其他方法中，我将这样做......

```
public void DoMoreStuff()
{
    if (m_disposed)
        throw new ObjectDisposedException();

  // Your code here
}

public void DoStuff()
{
    if (m_disposed)
        throw new ObjectDisposedException();

    // Your code here
 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-20T16:14:55.870

尽管从理论上讲，绝对没有什么能阻止您创建一个允许您处理然后继续使用该对象的类，但我想不出有一种情况是可取的（除了检查对象是否有已处置，例如[IsDisposed](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.isdisposed.aspx)）。

通常使用的模式是简单地*丢弃*已丢弃的对象，并在必要时重新创建它们，实际上在许多情况下尝试访问已丢弃的对象将导致`ObjectDisposedException`被抛出。如果您正在创建一个实现的对象，[`IDisposable`](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx)那么遵循此约定将是一个好主意。

为了帮助跟踪哪些对象已被处置和尚未被处置（以及确保您的对象已被处置，即使在抛出异常的情况下），请使用以下[`using`](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)语句：

```
using (SomeObject o = new SomeObject())
{
    o.DoStuff();
} 
```

# php - 如何将 Mediawiki 1.19.1 的登录页面更改为直接转到 Special:UserLogin

> ID：11123554
> 
> 赞同：7
> 
> 时间：2012-06-20T16:02:56.613
> 
> 标签：php, customization, mediawiki

我正在尝试设置一个私有 Mediawiki 实例，该实例希望用户登录以查看任何内容。我尝试调整 Localsettings.php 文件中的 $wgWhitelistRead 变量，但它仍然将我带到一个显示“需要登录”的页面。如果用户未登录，我希望 wiki 重定向到 Special:userLogin。我该怎么做？

我[在 mwforums 上发现了一个类似的问题，](http://www.mwusers.com/forums/showthread.php?6981-Default-Landing-Page&p=23741&viewfull=1#post23741)但它似乎是针对旧版本的 mediawiki。有任何想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-21T21:18:59.587

看起来很自然的地方是在[OutputPage::showPermissionsErrorPage()](https://github.com/wikimedia/mediawiki/blob/REL1_27/includes/OutputPage.php#L2459)中。具体来说，实际的错误消息显示在以下两行中：

```
$this->prepareErrorPage( $this->msg( 'loginreqtitle' ) );
$this->addHTML( $this->msg( $msg )->rawParams( $loginLink )->parse() ); 
```

要直接重定向到 Special:UserLogin，您可以用类似这样的代码（未经测试！）替换它们：

```
$this->redirect( SpecialPage::getTitleFor( 'Userlogin' )->getFullURL( $query ) ); 
```

唉，似乎没有任何方便的[钩子](http://www.mediawiki.org/wiki/Hooks)可以让你从扩展中做到这一点，所以看起来你必须求助于修补代码。这看起来确实是挂钩的自然位置，因此[提交功能请求](https://bugzilla.wikimedia.org/)要求添加这样的挂钩可能不是一个坏主意。

（或者，您确实可以在适当的位置输出登录表单，但这可能比仅重定向到 Special:UserLogin 更难实现。乍一看，我找不到任何方便的“outputLoginForm()”方法来调用[Special:UserLogin 代码](https://github.com/wikimedia/mediawiki/blob/REL1_27/includes/specials/SpecialUserLogin.php)，虽然自己生成匹配的登录表单实际上并不难，但这意味着以后对表单的任何更改都可能破坏兼容性。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T18:45:40.300

作为一个特别可怕的黑客，您可以将登录表单放入需要登录时显示的消息中（应该是`loginreqpagetext`消息）。由于反 CSRF 保护，这将是非常重要的，但您可以通过 AJAX 解决这个问题。（肯定有更好的解决方案；这只是一种快速而肮脏的方法。）

# c# - 如何从左到右对齐按钮

> ID：11123561
> 
> 赞同：2
> 
> 时间：2012-06-20T16:03:22.113
> 
> 标签：c#, winforms

所以我四处寻找关于如何动态创建按钮的一些想法。我找到了一个可以合并到我的项目中的[帖子。](http://bitvector.net/?p=41)不幸的是，这些按钮是垂直创建的。windows窗体有没有办法从左到右水平对齐它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T16:09:01.817

听起来像是[FlowLayoutPanel](http://msdn.microsoft.com/en-us/library/system.windows.forms.flowlayoutpanel.aspx)控件的一个很好的案例。我们有一些旧代码可以相对于彼此移动按钮。我用 FlowLayoutPanel 替换了它，它让生活变得更加轻松。

您可以让按钮水平或垂直布局，在每个按钮周围设置填充以使它们等距间隔，设置用于对齐面板内控件的属性，如果用户调整表单大小，则允许它们流入多行等。进行维护以后也容易多了。想象一下在其他 10 个按钮中间添加一个按钮，然后必须进行手动调整，使按钮不会相互重叠，等等。

听起来您不会遇到最后一个问题，因为您是在运行时动态创建它们的。不过，您可以创建一个按钮并将其放置到 FlowLayoutPanel 中，并让控件处理它相对于其他控件的实际放置。另外，如果用户调整表单大小，您不必担心移动它们，只要您可以使用多行按钮...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T16:05:58.333

只需为每个按钮设置 location 属性：

```
int lastX = 0;
for (int i = 0; i < 4; i++) {
  Button b = new Button();
  b.Location = new Point(lastX, 0);
  this.Controls.Add(b);
  lastX += b.Width;
} 
```

# sql-server - 使用高级服务为 SQL Server Express Edition 生成架构和数据

> ID：11123564
> 
> 赞同：0
> 
> 时间：2012-06-20T16:03:35.973
> 
> 标签：sql-server, sql-server-2008-express

我有 2008 年的带有高级服务的 Microsoft SQL Server Express Edition。

我只看到数据库的脚本选项，而不是模式和数据。

SQL Server Express Edition 中是否提供此功能？

我遇到了一个提到的资源。

在 SQL Management Studio Express 中，我可以使用生成和发布脚本并单击高级并获取高级脚本选项并指定架构和元数据。

我的 Express Edition 中没有看到此选项，此选项仅在 SQL Server 2012 中可用吗？

请指教。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T17:20:24.410

以下作品。

SQL Server 2008 -

任务 -> 生成脚本 -

选择要编写脚本的数据库，然后。表/视图选项 - 脚本数据 = True。

这解决了我的问题。

请参阅 -[如何获取 SQL Server 数据的脚本？](https://stackoverflow.com/questions/2321052/get-script-of-sql-server-data)

# jquery - jquery加载远程html页面

> ID：11123568
> 
> 赞同：0
> 
> 时间：2012-06-20T16:03:47.120
> 
> 标签：jquery, get, xmlhttprequest, cross-domain

我想加载远程 html 页面然后解析它。有很多这样的例子，但任何人都可以解释为什么我会收到这个错误：

> XMLHttpRequest 无法加载[http://html.comsci.us/examples/blank.html](http://html.comsci.us/examples/blank.html)。Access-Control-Allow-Origin 不允许 Origin null。

当我尝试加载此 html 页面时：

```
<!DOCTYPE HTML>
<html>
  <head>
  <script type="text/javascript"
     src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <script>
      $(document).ready(function(){ 
        $.get('http://html.comsci.us/examples/blank.html', function(data) {
           alert('Load was performed.');
        }); 
      });
    </script>
  </head>
  <body>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:06:05.410

您需要在自己的服务器上创建一个请求该页面的脚本，然后使用您的 ajax 请求调用该脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T06:04:49.483

您遇到的安全限制称为“同源策略”或“跨域访问”。

解决方法：

*   使查询服务器端或客户端应用程序
*   如果两个站点同意访问，您可以使用[CORS](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)，在其他站点上运行代码
*   JSONP 如果其他站点支持它

# scala - Scala将两个整数相除并得到一个浮点结果

> ID：11123572
> 
> 赞同：51
> 
> 时间：2012-06-20T16:04:09.740
> 
> 标签：scala, casting, floating-point, integer

如果我执行以下操作

```
 println(3/4)
 >0 
```

我想得到一个十进制的答案而不是一个整数。由于我在实际代码中打印的方式，如果可能的话，我更愿意在 println 中进行转换。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-06-20T16:07:24.930

如果您正在输入数字，只需将其中至少一个输入为浮点数（我假设您的意思`Float`不是`Double`）：

```
println(3f/4) 
```

如果您已经在变量中有数字，请至少将其中一个转换为`toFloat`

```
val x = 3
println(x.toFloat/4) 
```

（在每种情况下，如果您至少有一个，编译器会将另一个转换`Float`为匹配。）

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-06-20T16:06:13.720

这些有帮助吗？

```
println(3.0/4.0)
println(3.toDouble/4.toDouble) 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-06-21T22:43:54.407

对于原始类型（Int、Float、Double 等），Scala 遵循 Java 中的规则。

如果您编写文字整数 3、4 等，它们的表达式将保持为整数。所以

```
println(3/4) 
```

有一个由两个整数组成的表达式，所以结果是一个整数：0。

如果任何值碰巧是 Float 而不是 Int，则整个表达式会扩展为 Float。Double 也是如此。这种扩大几乎完全自动发生 - 你只需要给编译器你想要的提示，例如

```
println(3f/4) 
```

扩大到浮动和

```
println(3.0/4) 
```

扩大到双倍。

在实际程序中使用这些语言功能时，请始终考虑可能发生的精度损失。您已经注意到在这种情况下整数除法会导致小数部分丢失。但是这里说明了浮点的不同情况：

```
println(4f/3) 
```

实际结果以二进制表示形式保存（使用 IEEE754 标准），它具有二进制分数，而不是十进制分数，因此无法在没有小错误的情况下保存 4f/3。

```
scala> println(100f/99f * 99)
99.99999 
```

您可能期望它打印 100。有时这无关紧要，但有时确实如此。一个非常重要的非常常见的情况是在处理货币价值时。经验法则是始终避免浮点数和双倍金钱：改用 BigDecimal，或者只是将便士的数量保留为 Long，或者有时使用字符串（如果它们没有被解析为 Double 值方法）。

# java - Spring Integration 和 RabbitMQ，如何避免对入站通道适配器进行轮询

> ID：11123579
> 
> 赞同：2
> 
> 时间：2012-06-20T16:04:35.060
> 
> 标签：java, rabbitmq, spring-integration, amqp

我目前有一个带有直接交换的 Rabbit MQ Broker 设置，并且我正在使用 Spring Integration 来生成和使用来自队列的消息。我正在使用责任链模式，我使用 SI 将使用的消息从一个 POJO 传递到另一个 POJO。现在为此，我使用了 Spring Integration 入站通道适配器。这要求它具有对轮询器的引用。

如何删除轮询器，使其不在轮询机制上工作，而是使用回调，以便一旦消息可用，它将从队列中获取它，同时仍然能够使用 SI 提供的责任链模式。

我尝试将入站通道适配器更改为 Spring Rabbit 入站通道适配器，但这无法将消息转发到我的 POJO。不支持以下内容。

```
ref="eventConsumer" method="onReceiveEvent" 
```

我在下面定义了一些简单的配置，如何在不需要轮询的情况下实现相同的目标？

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:int="http://www.springframework.org/schema/integration"
    xsi:schemaLocation="http://www.springframework.org/schema/integration http://www.springframework.org/schema/integration/spring-integration-2.0.xsd
                        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

    <import resource="classpath:datasource-config.xml" />

    <int:logging-channel-adapter id="logger" level="DEBUG" log-full-message="true" />

    <int:channel id="eventChannel">
        <int:interceptors>
            <int:wire-tap channel="logger" />
        </int:interceptors>
    </int:channel>

    <int:channel id="errorChannel">
        <int:interceptors>
            <int:wire-tap channel="logger" />
        </int:interceptors>
    </int:channel>

    <bean id="connectionFactory" class="org.springframework.amqp.rabbit.connection.CachingConnectionFactory">
        <property name="host" value="${rabbitmq.host}" />
        <property name="port" value="${rabbitmq.port}" />
        <property name="username" value="${rabbitmq.username}" />
        <property name="password" value="${rabbitmq.password}" />
        <property name="virtualHost" value="${rabbitmq.events.virtual.host}" />
    </bean>

    <bean id="rabbitTemplate" class="org.springframework.amqp.rabbit.core.RabbitTemplate">
        <constructor-arg name="connectionFactory" ref="connectionFactory" />
        <property name="exchange" value="${rabbitmq.events.exchange.name}" />
        <property name="routingKey" value="${rabbitmq.events.routing.key}" />
    </bean>

    <bean id="pollingInterval" class="java.lang.String">
        <constructor-arg value="${rabbitmq.message.polling.interval}" />
    </bean>

    <int:poller id="rabbitConsumerPoller" fixed-rate="#{pollingInterval}" error-channel="errorChannel" />

    <bean id="eventConsumer" class="com.idna.events.consumer.EventsConsumer">
        <property name="rabbitTemplate" ref="rabbitTemplate"/>
        <property name="consumerDao" ref="eventsConsumerDao" />
        <property name="queueName" value="${rabbitmq.events.queue.name}" />
    </bean>

    <int:inbound-channel-adapter id="inboundChannelAdapter" channel="eventChannel" ref="eventConsumer" method="onReceiveEvent">
        <int:poller ref="rabbitConsumerPoller"/>
    </int:inbound-channel-adapter>

</beans> 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T16:33:02.890

使用 <int-amqp:inbound-channel-adapter/> 将消息发送到您的 eventChannel。您的消费者不需要了解兔子；它可以通过 <service-activator/> 调用

# speech-to-text - Mp3 / Wav 到文本

> ID：11123588
> 
> 赞同：0
> 
> 时间：2012-06-20T16:05:18.800
> 
> 标签：speech-to-text, lync

我目前有一个移动应用程序，可以将语音录制为 WAV 或 MP3，并希望将其转换为文本。我环顾四周——Microsoft Speech、UCMA 等——但没有看到任何关于如何做到这一点的好例子。有人可以在这里帮忙吗？

仅供参考 - 我们可以访问 MS Lync。

期待任何回应，詹姆斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T16:31:59.263

[此处](http://code.msdn.microsoft.com/Using-VoiceXML-in-a-UCMA-560116d2)提供了使用 UCMA 3.0 SDK 执行语音识别的示例。但是，根据经验（我很乐意在这里被证明是错误的），您只能从预先确定的一组选项中识别出特定的响应。所以，你可以问“你今天过得怎么样”，并告诉 UCMA 有效的回答是“好”、“一般”、“坏”，然后它会尝试匹配其中任何一个。我还没有看到它能够“只是”进行言论自由转换。（一个更难的问题）

这可能是 Microsoft Speech API 可以做得更好的事情。试试[这篇文章](http://www.codestrider.com/BlogRead.aspx?b=62772cb1-acd2-4935-acae-2356c43421ad)以获得良好的开端。

# objective-c - 在后台线程中运行的方法调用的主线程上执行延迟选择器

> ID：11123591
> 
> 赞同：0
> 
> 时间：2012-06-20T16:05:22.907
> 
> 标签：objective-c, multithreading, nstimer, background-process

我有一个在后台运行的方法，通过调用

```
[self performSelectorInBackground:@selector(getTweets) withObject:nil]; 
```

'getTweets' 调用包装类中的一个方法，该方法获取推文并在它们准备好时发布通知。当这种情况发生时，我有一个观察者会触发“showTweets”。

当调用 showTweets 时，我想以 5 秒的延迟调用“hideTweets”。我通过调用来做到这一点：

```
self.hideTweetTimer = [NSTimer scheduledTimerWithTimeInterval:5 target:self  selector:@selector(hideTweet) userInfo:nil repeats:NO]; 
```

然而，它似乎没有火。我还有一个调用 showTweets 方法的按钮，但是当它被按下时，它似乎卡在了 isHighlighted 状态。

由于最初的调用是在后台线程中，我做错了什么吗？

我试过

```
[[NSRunLoop currentRunLoop] addTimer:self.hideTweetTimer forMode:NSDefaultRunLoopMode];
[[NSRunLoop currentRunLoop] run]; 
```

这似乎可以隐藏推文，但这似乎会导致性能问题。例如，当我在不同的屏幕中加载 UIScrollView 时，滚动非常粘。

基本上，我所有的问题似乎都源于在后台线程上执行某些操作，但我不确定是什么......非常感谢任何帮助。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-20T16:44:13.280

您是否正在从这些线程修改 UI 元素？唯一应该处理 UI 的线程是主线程。其他线程应该将他们的需求传达给主线程，主线程实际上会为他们做这件事。

您可以使用以下方法将某些内容回调到主线程：

```
[self performSelectorOnMainThread:@selector(method) withObject:nil waitUntilDone:YES]; 
```

# qt4 - QHash中的长密钥

> ID：11123595
> 
> 赞同：0
> 
> 时间：2012-06-20T16:05:42.207
> 
> 标签：qt4, qt4.7, qhash

我想创建一个具有 64 个字符键和大约 100 万条记录的 QHash。可能吗 ？密钥大小有限制吗？我的记录有冲突。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T17:57:55.673

使用的内部散列大小`QHash`固定为`uint`- 通常至少 32 位。一百万条记录`QHash`根本不是问题。如果您使用自定义数据类型`T`作为键，请确保您提供 的独立（不是类成员）实现`uint qHash(const T &)`，以及`bool operator==(const T& other)`或类外的`bool operator==(const T& first, const T& second)`.

# ajax - java.lang.ClassNotFoundException: Spring 3 项目中的 org.codehaus.jackson.map.ObjectMapper

> ID：11123596
> 
> 赞同：2
> 
> 时间：2012-06-20T16:05:42.833
> 
> 标签：ajax, json, spring, spring-mvc, get

我正在尝试建立一个没有 Maven 的 Spring 项目。我的项目必须通过 Spring MVC 框架提供 jsp 页面和 json 流。Jsp 页面的部分运行良好，但是当我尝试设置 json 流式传输（以制作 ajax GET）时，我得到了

```
java.lang.ClassNotFoundException: org.codehaus.jackson.map.ObjectMapper 
```

我的 servletname-servlet.xml 如下：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
xmlns:context="http://www.springframework.org/schema/context"
xmlns:mvc="http://www.springframework.org/schema/mvc"
xsi:schemaLocation="
     http://www.springframework.org/schema/beans
     http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
     http://www.springframework.org/schema/context
     http://www.springframework.org/schema/context/spring-context-3.0.xsd
     http://www.springframework.org/schema/mvc
     http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
     ">
<mvc:annotation-driven />
<context:component-scan base-package="org.package.servletname" />

<bean
    class="org.springframework.web.servlet.view.ContentNegotiatingViewResolver">
    <property name="mediaTypes">
        <map>
            <entry key="atom" value="application/atom+xml" />
            <entry key="html" value="text/html" />
            <entry key="json" value="application/json" />
        </map>
    </property>
    <property name="viewResolvers">
        <list>
            <bean class="org.springframework.web.servlet.view.BeanNameViewResolver" />
            <bean
                class="org.springframework.web.servlet.view.InternalResourceViewResolver">
                <property name="prefix" value="/WEB-INF/jsp/" />
                <property name="suffix" value=".jsp" />
            </bean>
        </list>
    </property>
    <property name="defaultViews">
        <list>
            <bean
                class="org.springframework.web.servlet.view.json.MappingJacksonJsonView" />
        </list>
    </property>
</bean>

<mvc:resources mapping="/css/**" location="/css/" />
<mvc:resources mapping="/img/**" location="/img/" />
<mvc:resources mapping="/js/**" location="/js/" />

</beans> 
```

我的控制器如下

```
package org.package.servletname;

import java.util.LinkedList;
import java.util.List;

import org.package.servletname.orm.*;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.ResponseBody;

@Controller
@RequestMapping("/ajax")
public class JSONGetController
{
@RequestMapping(value = "/getproducts", method = RequestMethod.GET)
public @ResponseBody
List<Product> JSONGetProducts()
{
    List<Product> productList = null;
    Product p = new Product();
    p.setName("ProductName");
    productList = new LinkedList<Product>();
    productList.add(p);
    return productList;
}
} 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T16:12:48.850

[杰克逊](http://jackson.codehaus.org/)在类路径中丢失

# mysql - 从多个表中选择某些字段而无需任何连接

> ID：11123610
> 
> 赞同：0
> 
> 时间：2012-06-20T16:06:24.380
> 
> 标签：mysql, join

我有 5 个表（tbl1、tbl2、tbl3、tbl4、tbl5），它们都有相似的列，但没有共享 fk。我需要按照它们的时间戳（每个表都有的列）的顺序编译一个项目列表。我尝试了以下方法，但没有奏效：

```
SELECT 
    t1.id, t1.name, t1.created,
    t2.id, t2.name, t2.created,
    t3.id, t3.name, t3.created,
    t4.id, t4.name, t4.created,
    t5.id, t5.name, t5.created
FROM tbl1 t1, tbl2 t2, tbl3 t3, tbl4 t4, tbl5 t5; 
```

显然，上面的内容不会按时间戳列排序，但是在添加“ORDER BY”子句之前，我需要让类似的东西正常工作。

有没有办法（不创建视图）运行从 5 个表返回数据的查询（如果某些表为空，则事件）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:12:54.187

听起来您正在寻找的是`UNION ALL`操作员。

```
SELECT t1.id, t1.name, t1.created FROM tbl1 t1
 UNION ALL 
SELECT t2.id, t2.name, t2.created FROM tbl2 t2
 UNION ALL 
SELECT t3.id, t3.name, t3.created FROM tbl3 t3
 UNION ALL 
SELECT t4.id, t4.name, t4.created FROM tbl4 t4
 UNION ALL 
SELECT t5.id, t5.name, t5.created FROM tbl5 t5
 ORDER BY 3 
```

该`UNION ALL`运算符基本上将查询的结果连接到一个结果集中。请注意，表达式的数量和每个表达式的数据类型必须在所有查询中匹配。（如果您需要在其中一个查询中包含额外的列，则需要在其他查询中添加相应的表达式（甚至是虚拟占位符）。

当我进行这样的查询时，包含一个表达式（列）有时会很有帮助，它告诉我哪个源查询返回了该行：

```
SELECT 't1' as source, t1.id, t1.name, t1.created FROM tbl1 t1
 UNION ALL 
SELECT 't2', t2.id, t2.name, t2.created FROM tbl2 t2
 UNION ALL 
SELECT 't3', t3.id, t3.name, t3.created FROM tbl3 t3
 UNION ALL 
SELECT 't4', t4.id, t4.name, t4.created FROM tbl4 t4
 UNION ALL 
SELECT 't5', t5.id, t5.name, t5.created FROM tbl5 t5
 ORDER BY 4 
```

请注意，ORDER BY 适用于整个结果集，您必须引用表达式以按列位置排序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T16:13:14.220

使用***[UNION ALL](http://dev.mysql.com/doc/refman/5.0/en/union.html)***

```
SELECT id, name, created FROM tbl1
UNION ALL
SELECT id, name, created FROM tbl2
UNION ALL
SELECT id, name, created FROM tbl3
UNION ALL
SELECT id, name, created FROM tbl4
UNION ALL
SELECT id, name, created FROM tbl5 
```

# facebook - facebook 权限对话框弹出，就像同一页面上的叠加层一样

> ID：11123611
> 
> 赞同：0
> 
> 时间：2012-06-20T16:06:25.590
> 
> 标签：facebook, oauth, dialog, x-facebook-platform

我已经看到音乐/歌曲应用程序的应用程序权限对话框出现在同一页面上。

对于其他应用程序，它会打开新标签或重定向。

游戏应用程序是否可以有相同的权限对话框？

例如，如果用户没有 Saavn 应用程序并且他们单击 appname 链接，它将显示权限对话框作为叠加层，如下所示： ![在此处输入图像描述](../Images/9e6c4ccf2da7017f4e339d8ca95f513e.png)

对于我的应用程序，权限对话框将用户带到新页面，如下所示： ![在此处输入图像描述](../Images/e6e626918991d439f3cc300d3696175c.png)

我的经过身份验证的推荐的应用设置：![在此处输入图像描述](../Images/c3f2c68d0a9616dbc9939849131448ae.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:30:12.657

您需要按照 Facebook 文档中的说明启用[Authenticated Referrals](https://developers.facebook.com/docs/opengraph/authentication/#referrals) - 这一切都在您的应用设置中进行控制，如果您使用的是 Facebook PHP SDK，则不需要任何代码更改

# c# - C# - 设置组合框的高度

> ID：11123614
> 
> 赞同：3
> 
> 时间：2012-06-20T16:06:56.373
> 
> 标签：c#, combobox, height

我想*在 runtime 期间*`ComboBox`将 a （从 Windows Forms [Control](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.aspx) s）的高度设置为**X** 。

 *我有

*   将`DrawMode`Property 设置为`OwnerDrawVariable`，以指定手动绘制项目；
*   将`IntegralHeight`Property 设置为 false，以避免`Control`自动调整大小；
*   的`ItemHeight`Property`ComboBox`也设置为**X**。

我还覆盖了组合框项目的`DrawItem`和`MeasureItem`事件（参见下面的代码）

但是，**在运行时****设置ComboBox 的 仅在设置为时才有效。`Height``DropDownStyle``Simple`**

我这样做是两种方式，以编程方式（修改`ComboBox`'s`Height`或`Size`）属性，并使用`PropertyGrid`我在我的应用程序上拥有的控件。

`DropDown`当我设置 a or的高度时`DropDownList` `ComboBox`，我注意到 Windows 会自动将其高度更改为另一个值：**Y**（经过一些调试后，由于某种原因，我注意到它是**X + 6**）。

我错过了什么？为什么会这样？

以下是处理程序的代码：

```
private void DrawItemHandler(object sender, DrawItemEventArgs e)
{
  //Create a new font to write the item
  Font ComboItemFont = new Font(FontFamily.GenericSansSerif, 8, FontStyle.Regular);

  e.DrawBackground();
  e.DrawFocusRectangle();

  //Write the item's value
  e.Graphics.DrawString(((ComboBox) sender).Items[e.Index].ToString(),
                        ComboItemFont,
                        new SolidBrush(Color.Black),
                        e.Bounds);

  //Update the source's font to match the current font
  ((Control) sender).Font = ComboItemFont;
}

private void MeasureItemHandler(object sender, MeasureItemEventArgs e)
{
     //Do nothing
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:35:59.753

```
 namespace WinForms 
 {
      public partial class Form1 : Form
      {
          public Form1()
          {
              InitializeComponent();
              comboBox1.Size = new Size(10,10);
          }
      }
 } 
```

您还可以`Size(Width,Height)`在 Visual Studio 中更改来自属性视图*

# java - TinyMCE 从 Applet 内容插入图像

> ID：11123615
> 
> 赞同：1
> 
> 时间：2012-06-20T16:06:59.993
> 
> 标签：java, content-management-system, applet, tinymce

我有一个小程序，它使用 Java 图形库来允许用户绘制线条和形状，它们将作为插件嵌入到 TinyMCE 编辑器中。我不确定如何将用户绘制的图像作为图像插入到编辑器中。

非常感谢任何帮助或参考！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:16:14.913

我不相信你的目标是没有（受信任的）小程序将图像保存到磁盘并提示用户然后将其上传到 CMS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T16:50:57.343

您可以将图像上传到网络服务器，并使用代码插件（“html”按钮）将引用该图像的图像标签输入到编辑器中。

**更新：**

您需要创建 base64 编码字符串并调用以下 tinymce 命令：

示例：对于您的系统，您需要将 base64 编码的字符串放入变量 my_image_base64_string。

```
var my_image_base64_string = 'R0lGODlhEAAOALMAAOazToeHh0tLS/7LZv/0jvb29t/f3//Ub//ge8WSLf/rhf/3kdbW1mxsbP//mf///yH5BAAAAAAALAAAAAAQAA4AAARe8L1Ekyky67QZ1hLnjM5UUde0ECwLJoExKcppV0aCcGCmTIHEIUEqjgaORCMxIC6e0CcguWw6aFjsVMkkIr7g77ZKPJjPZqIyd7sJAgVGoEGv2xsBxqNgYPj/gAwXEQA7';

tinymce.activeEditor.execCommand('insertHTML', false, '<img src="data:image/gif;base64,' + my_image_base64_string + '" width="16" height="14">'); 
```

# javascript - 使用 javascript 进行动态表单验证

> ID：11123617
> 
> 赞同：1
> 
> 时间：2012-06-20T16:07:01.913
> 
> 标签：javascript

它又是新手.. 我正在尝试设计一种采用用户名和密码并验证它们的表单。但是，首先我想确保用户在将其传递给 servlet 或任何其他与服务器相关的组件之前填写这两个字段。我希望使用生成警报按钮的 javascript 来执行此操作，当其中一个或两个字段为空时，更像是 JOptionPane。我的代码是

* * *

索引.jsp

* * *

```
<%@page contentType="text/html" pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>JSP Page</title>
    <script src="newjavascript.js"></script>
</head>
<body>
    <h1>Hello World!</h1>
    <form id="form" method="post" action="final.jsp">
    Student name :<br><input type="text" value="" name="username"   id="idusername"><br><br>
    Password :<br><input type="text" value="" name="password" id="idpassword"><br><br>
    <input type="submit" value="Register" />
</form>
</body>
</html> 
```

* * *

我将上面的内容传递到一个 javascript 文件 newjavascript.js 这是

* * *

```
$(document).ready(function(){
var form = $("#form");
var username = $("#idusername");
    var password = $("idpassword");
//On Submitting
form.submit(function(){
    if(validateName() & validatePassword())
        return true;
    else
    {
        alert('Some fields are not filled correctly. Please fill them correctly.');
        return false;
    }
});

function validateName(){

    if(username.val().length < 1){
        return false;
    }

    else{
        return true;
    }
}

    function validatePassword(){

    if(password.val().length <5){
        return false;
    }

    else{           
        return true;
    }
}
}); 
```

* * *

我的 javascript 代码是错误的还是我无法正确地将参数传递给它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:17:40.377

这样做

```
$(document).ready(function(){
var form = $("#form");
form.submit(function(){
    if(validateName() && validatePassword())
        return true;
    else
    {
        alert('Some fields are not filled correctly. Please fill them correctly.');
        return false;
    }
});

});
function validateName(){
var username = $("#idusername");

    if(username.val().length < 1){
        return false;
    }

    else{
        return true;
    }
}

    function validatePassword(){
    var password = $("#idpassword");//previously it was wrong

    if(password.val().length <5){
        return false;
    }

    else{           
        return true;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T16:21:21.353

这是您的代码的更正版本的[小提琴](http://jsfiddle.net/wfccR/)，其中包含以下修复：

1.  你必须使用 $("#idpassword");
2.  您应该使用 && 进行“逻辑与”比较 - 而不是 & 用于“按位与”。该代码适用于按位 &，但您并没有尝试进行按位运算。

**添加**

1.  您必须阻止默认表单提交。

    form.submit(function(event) { ... if (bad) { event.preventDefault(); }

（我在小提琴中有这个但忘了提）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T16:22:04.213

```
<script>
        $(document).ready(function () {
            var form = $("#form");
            alert(form);
            var username = $("#idusername");
            var password = $("#idpassword");
            //On Submitting
            form.on("submit",function () {
                if (validateName() & validatePassword())
                    return true;
                else {
                    alert('Some fields are not filled correctly. Please fill them correctly.');
                    return false;
                }
            });

            function validateName() {

                if (username.val().length < 1) {
                    return false;
                }

                else {
                    return true;
                }
            }

            function validatePassword() {
                alert(password);

                if (password.val().length < 5) {
                    return false;
                }

                else {
                    return true;
                }
            }
        });

    </script> 
```

# java-me - 调用的平台请求在 j2me 中不起作用

> ID：11123619
> 
> 赞同：1
> 
> 时间：2012-06-20T16:07:07.250
> 
> 标签：java-me, call, lwuit, midp

我正在构建电话簿的应用程序。我正在使用 lwit 进行 ui 构建，因此我的应用程序在 MIDP2.1 和 CDLC1.1 上运行。该应用程序针对诺基亚 s40 设备。

当我`platformRequest`从我的表单类中调用该方法时，我使用下面这段代码中的常量编号，`StartApp`我的主要 MIDlet 在哪里。

```
 try 
        { 
    if (StartApp.getInstance().platformRequest("tel:01239201300") == true)
          {
            StartApp.getInstance().notifyDestroyed();
          }
       }
     catch(Exception ex)
     {
        System.out.println(ex);
     } 
```

应用程序运行正确并生成了一个呼叫请求，但是如果我尝试像下面的这段代码一样进行这项工作

```
 try{   
     String number = "tel:" + lblTelNumber.getText();
        System.out.println(number);
        if (StartApp.getInstance().platformRequest(number) == true)
        {
            StartApp.getInstance().notifyDestroyed();
        }
     }
   catch(Exception ex)
    {
        System.out.println(ex);
    } 
```

这会导致以下异常。

```
ordinary platformRequest: tel:01239201300 
URL is : tel:01239201300 
javax.microedition.io.ConnectionNotFoundException: Invalid Phone Number
at javax.microedition.midlet.MIDlet.platformRequest(+76)
at package1.InformationForm.Call(+48) 
```

我不知道这里有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T17:21:58.193

您的第二个代码片段中可能会有不可见的符号（例如尾随空格）。

要确定是否如此，请将调试消息修改为类似的内容`System.out.println("[" + number + "]")`，重新运行测试并重新检查输出。

### 更新

> 似乎数字末尾有一个换行符，数字出现在注释中，`[tel:01239201300 ]`（第二个括号出现在注释的下一行）。

好吧，仅此一项似乎就足够了`Invalid Phone Number`。

[MIDlet.platformRequest](http://docs.oracle.com/javame/config/cldc/ref-impl/midp2.0/jsr118/javax/microedition/midlet/MIDlet.html#platformRequest(java.lang.String))的 API 文档参考[RFC2806，](http://www.ietf.org/rfc/rfc2806.txt)用于电话号码 URL，它似乎非常严格地指定了*2.2 节“tel” URL 方案*中允许和不允许的内容。

# java - 从另一个线程在主线程中运行代码

> ID：11123621
> 
> 赞同：368
> 
> 时间：2012-06-20T16:07:11.457
> 
> 标签：java, android, multithreading, android-handler

在一个 android 服务中，我创建了线程来执行一些后台任务。

我有一个线程需要在主线程的消息队列上发布某些任务的情况，例如`Runnable`.

有没有办法从我的另一个线程获取`Handler`主线程并发布`Message`/到它？`Runnable`

* * *

## 回答 #1

> 赞同：681
> 
> 时间：2012-06-20T17:49:22.887

注意：这个答案引起了如此多的关注，我需要更新它。自从发布了原始答案以来，@dzeikei 的评论几乎与原始答案一样受到关注。所以这里有两种可能的解决方案：

**1.如果你的后台线程有一个`Context`对象的引用：**

确保您的后台工作线程可以访问 Context 对象（可以是应用程序上下文或服务上下文）。然后只需在后台工作线程中执行此操作：

```
// Get a handler that can be used to post to the main thread
Handler mainHandler = new Handler(context.getMainLooper());

Runnable myRunnable = new Runnable() {
    @Override 
    public void run() {....} // This is your code
};
mainHandler.post(myRunnable); 
```

**2.如果你的后台线程没有（或不需要）一个`Context`对象**

（由@dzeikei 建议）：

```
// Get a handler that can be used to post to the main thread
Handler mainHandler = new Handler(Looper.getMainLooper());

Runnable myRunnable = new Runnable() {
    @Override 
    public void run() {....} // This is your code
};
mainHandler.post(myRunnable); 
```

* * *

## 回答 #2

> 赞同：154
> 
> 时间：2012-06-20T22:19:47.087

正如下面的评论者正确指出的那样，这不是服务的通用解决方案，仅适用于从您的活动启动的线程（服务可以是这样的线程，但并非所有这些都是）。关于服务活动通信的复杂主题，请阅读官方文档的整个服务部分 - 它很复杂，因此了解基础知识是值得的：http: [//developer.android.com/guide/components/services.html #通知](http://developer.android.com/guide/components/services.html#Notifications)

下面的方法可能适用于最简单的情况：

如果我理解正确，您需要在应用程序的 GUI 线程中执行一些代码（不能考虑其他任何称为“主”线程的东西）。为此，有一个方法`Activity`：

```
someActivity.runOnUiThread(new Runnable() {
        @Override
        public void run() {
           //Your code to run in GUI thread here
        }//public void run() {
}); 
```

文档：http: [//developer.android.com/reference/android/app/Activity.html#runOnUiThread%28java.lang.Runnable%29](http://developer.android.com/reference/android/app/Activity.html#runOnUiThread%28java.lang.Runnable%29)

希望这是您正在寻找的。

* * *

## 回答 #3

> 赞同：63
> 
> 时间：2019-07-02T12:14:03.843

## Kotlin 版本

当**您进行活动**时，请使用

```
runOnUiThread {
    //code that runs in main
} 
```

当**您有活动上下文**时， mContext 然后使用

```
mContext.runOnUiThread {
    //code that runs in main
} 
```

**当您在没有可用上下文**的地方时，请使用

```
Handler(Looper.getMainLooper()).post {  
    //code that runs in main
} 
```

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2015-07-03T07:15:47.033

如果您无权访问 Context，还有另一种简单的方法。

1）。从主循环器创建一个处理程序：

```
Handler uiHandler = new Handler(Looper.getMainLooper()); 
```

2）。实现一个 Runnable 接口：

```
Runnable runnable = new Runnable() { // your code here } 
```

3）。将您的 Runnable 发布到 uiHandler：

```
uiHandler.post(runnable); 
```

就是这样 ;-) 享受线程的乐趣，但不要忘记同步它们。

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2013-09-27T09:27:29.960

如果您在线程中运行代码，例如延迟某些操作，那么您需要`runOnUiThread`从上下文中调用。例如，如果您的代码在`MainActivity`类内，则使用以下代码：

```
MainActivity.this.runOnUiThread(new Runnable() {
    @Override
    public void run() {
        myAction();
    }
}); 
```

如果您的方法可以从主（UI 线程）或其他线程调用，则需要进行如下检查：

```
public void myMethod() {
   if( Looper.myLooper() == Looper.getMainLooper() ) {
       myAction();
   }
   else {

} 
```

* * *

## 回答 #6

> 赞同：27
> 
> 时间：2018-02-20T17:46:10.150

一个精简的代码块如下：

```
 new Handler(Looper.getMainLooper()).post(new Runnable() {
       @Override
       public void run() {
           // things to do on the main thread
       }
   }); 
```

这不涉及传递 Activity 引用或 Application 引用。

Kotlin 等价物：

```
 Handler(Looper.getMainLooper()).post(Runnable {
        // things to do on the main thread
    }) 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2018-10-30T03:54:01.370

最简单的方法，特别是如果你没有上下文，如果你使用 RxAndroid，你可以这样做：

```
AndroidSchedulers.mainThread().scheduleDirect {
    runCodeHere()
} 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2019-01-14T11:04:17.300

使用 handler 更精确的 Kotlin 代码：

```
Handler(Looper.getMainLooper()).post {  
 // your codes here run on main Thread
 } 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2012-06-20T16:41:01.240

我能想到的一种方法是：

1) 让 UI 绑定到服务。2）通过注册您
的公开如下方法：`Binder``Handler`

```
public void registerHandler(Handler handler) {
    mHandler = handler;
} 
```

3）在UI线程中，绑定服务后调用上述方法：

```
mBinder.registerHandler(new Handler()); 
```

4）使用服务线程中的处理程序发布您的任务：

```
mHandler.post(runnable); 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2019-10-21T09:51:40.663

所以最方便的是做这样的事情：

```
import android.os.AsyncTask
import android.os.Handler
import android.os.Looper

object Dispatch {
    fun asyncOnBackground(call: ()->Unit) {
        AsyncTask.execute {
            call()
        }
    }

    fun asyncOnMain(call: ()->Unit) {
        Handler(Looper.getMainLooper()).post {
            call()
        }
    }
} 
```

之后：

```
Dispatch.asyncOnBackground {
    val value = ...// super processing
    Dispatch.asyncOnMain { completion(value)}
} 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2018-06-14T22:05:26.857

我知道这是一个老问题，但我遇到了一个我在 Kotlin 和 Java 中都使用的主线程单线器。这可能不是服务的最佳解决方案，但对于调用将更改片段内的 UI 的东西来说，这是非常简单和明显的。

爪哇 (8):

```
 getActivity().runOnUiThread(()->{
      //your main thread code
 }); 
```

科特林：

```
this.runOnUiThread {
     //your main thread code
} 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2017-05-09T12:40:10.967

`HandlerThread`是 Android 中普通 java 线程的更好选择。

1.  创建一个[HandlerThread](https://developer.android.com/reference/android/os/HandlerThread.html)并启动它
2.  从 HandlerThread创建一个带有[Looper的](https://developer.android.com/reference/android/os/Looper.html)[处理程序：](https://developer.android.com/reference/android/os/Handler.html)`requestHandler`
3.  `post`一个`Runnable`任务`requestHandler`

与 UI 线程的通信来自`HandlerThread`

1.  为主线程创建一个`Handler`with `Looper`: `responseHandler`并覆盖`handleMessage`方法
2.  其他线程的内部`Runnable`任务（在`HandlerThread`这种情况下），调用`sendMessage``responseHandler`
3.  这`sendMessage`导致`handleMessage`in 的调用`responseHandler`。
4.  从中获取属性`Message`并对其进行处理，更新 UI

**示例**：`TextView`使用从 Web 服务接收到的数据进行更新。由于应在非 UI 线程上调用 Web 服务，`HandlerThread`为网络操作创建。从 Web 服务获取内容后，将消息发送到主线程（UI 线程）处理程序，该处理程序`Handler`将处理消息并更新 UI。

示例代码：

```
HandlerThread handlerThread = new HandlerThread("NetworkOperation");
handlerThread.start();
Handler requestHandler = new Handler(handlerThread.getLooper());

final Handler responseHandler = new Handler(Looper.getMainLooper()) {
    @Override
    public void handleMessage(Message msg) {
        txtView.setText((String) msg.obj);
    }
};

Runnable myRunnable = new Runnable() {
    @Override
    public void run() {
        try {
            Log.d("Runnable", "Before IO call");
            URL page = new URL("http://www.your_web_site.com/fetchData.jsp");
            StringBuffer text = new StringBuffer();
            HttpURLConnection conn = (HttpURLConnection) page.openConnection();
            conn.connect();
            InputStreamReader in = new InputStreamReader((InputStream) conn.getContent());
            BufferedReader buff = new BufferedReader(in);
            String line;
            while ((line = buff.readLine()) != null) {
                text.append(line + "\n");
            }
            Log.d("Runnable", "After IO call:"+ text.toString());
            Message msg = new Message();
            msg.obj = text.toString();
            responseHandler.sendMessage(msg);

        } catch (Exception err) {
            err.printStackTrace();
        }
    }
};
requestHandler.post(myRunnable); 
```

有用的文章：

[handlerthreads-and-why-you-should-be-using-them-in-your-android-apps](https://medium.com/@ali.muzaffar/handlerthreads-and-why-you-should-be-using-them-in-your-android-apps-dc8bf1540341)

[android-looper-handler-handlerthread-i](https://blog.nikitaog.me/2014/10/11/android-looper-handler-handlerthread-i/)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2021-09-13T08:18:25.740

```
ContextCompat.getMainExecutor(context).execute {
  // do something
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-09-17T08:00:49.903

对于 Kotlin，您可以使用[Anko corountines](https://github.com/Kotlin/anko/wiki/Anko-Coroutines)：

**更新**

```
doAsync {
   ...
} 
```

**已弃用**

```
async(UI) {
    // Code run on UI thread
    // Use ref() instead of this@MyActivity
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2018-02-19T13:42:53.833

按照这个方法。使用这种方式，您可以简单地从后台线程更新 UI。runOnUiThread 在主（UI）线程上工作。我认为这个代码片段不那么复杂和简单，尤其是对于初学者。

```
AsyncTask.execute(new Runnable() {
            @Override
            public void run() {

            //code you want to run on the background
            someCode();

           //the code you want to run on main thread
 MainActivity.this.runOnUiThread(new Runnable() {

                    public void run() {

/*the code you want to run after the background operation otherwise they will executed earlier and give you an error*/
                        executeAfterOperation();

                   }
                });
            }
        }); 
```

在服务的情况下

在 oncreate 中创建一个处理程序

```
 handler = new Handler(); 
```

然后像这样使用它

```
 private void runOnUiThread(Runnable runnable) {
        handler.post(runnable);
    } 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-08-23T12:24:21.853

```
public void mainWork() {
    new Handler(Looper.getMainLooper()).post(new Runnable() {
        @Override
        public void run() {
            //Add Your Code Here
        }
    });
} 
```

这也可以在没有问题的服务类中工作。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2019-09-25T09:40:09.827

使用 Kotlin，在任何函数中都是这样的：

```
runOnUiThread {
   // Do work..
} 
```

# javascript - 如何在 jquery 中设置会话变量？

> ID：11123622
> 
> 赞同：33
> 
> 时间：2012-06-20T16:07:14.437
> 
> 标签：javascript, jquery, html

我有一个 html 页面，当页面加载时会打开一个弹出窗口。

我只需要在页面第一次打开时设置弹出窗口。我认为要设置会话或cookie。

```
 <script>
        !window.jQuery && document.write('<script src="fancybox/jquery-1.4.3.min.js"><\/script>');
    </script>
    <script type="text/javascript" src="fancybox/jquery.fancybox-1.3.4.pack.js"></script>       
    <script type="text/javascript">
    $(document).ready(function() {  
        $("a#example1").fancybox();     
        $("a#example1").trigger('click');           
    });

    </script>   
    <link rel="stylesheet" type="text/css" href="fancybox/jquery.fancybox-1.3.4.css" media="screen" />  
</head>
<body>
<a id="example1" href="images/pic.jpg"></a> 
</body> 
```

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-06-20T16:10:16.370

使用[localStorage](https://developer.mozilla.org/en/DOM/Storage)存储您打开页面的事实：

```
$(document).ready(function() {
    var yetVisited = localStorage['visited'];
    if (!yetVisited) {
        // open popup
        localStorage['visited'] = "yes";
    }
}); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-03-12T08:11:22.177

您可以尝试使用 HTML5s sessionStorage 它持续页面会话的持续时间。只要浏览器打开并在页面重新加载和恢复后仍然存在，页面会话就会持续。在新选项卡或窗口中打开页面将导致启动新会话。

sessionStorage.setItem("用户名", "约翰");

[https://developer.mozilla.org/en-US/docs/Web/Guide/API/DOM/Storage#sessionStorage](https://developer.mozilla.org/en-US/docs/Web/Guide/API/DOM/Storage#sessionStorage)

浏览器兼容性[https://code.google.com/p/sessionstorage/](https://code.google.com/p/sessionstorage/)兼容所有 A 级浏览器，包括 iPhone 或 Android。[http://www.nczonline.net/blog/2009/07/21/introduction-to-sessionstorage/](http://www.nczonline.net/blog/2009/07/21/introduction-to-sessionstorage/)

# jquery - MVC 3 中的 jQuery UI 选项卡调用控制器上的操作

> ID：11123624
> 
> 赞同：1
> 
> 时间：2012-06-20T16:07:16.840
> 
> 标签：jquery, asp.net-mvc-3, tabs, jquery-ui-tabs

我在页面上有一个标签：

```
<div id="tabs">
    <ul>
        <li><a href="#tabs-1">tab1</a></li>
        <li><a href="#tabs-2">tab2</a></li>
        <li><a href="#tabs-3">tab3</a></li>
    </ul>
    <div id="tabs-1">
    </div>
    <div id="tabs-2">
    </div>
    <div id="tabs-3">
    </div>
</div> 
```

页面控制器上的操作如下所示：

```
public ActionResult PageWithTabs(int id)
{
    return View();
} 
```

该页面的链接是：

```
http://localhost:65334/Home/PageWithTabs/1 
```

当我单击一个选项卡时，它会通过链接

```
http://localhost:65334/Home/PageWithTabs/1#tabs-2 
```

并使用 null id（显然 - 1#tabs-2 not int）调用我的操作，但我有一个例外。
那么，如何防止在选项卡单击时调用操作？

* * *

我找到了唤醒动作的原因 - 选项卡上有uploadify插件，但我仍然不知道如何修复它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:17:30.673

试试这个：

```
$('a').on('click', function (ev) {
    ev.preventDefault();
    // your click logic...
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T18:39:13.960

也许您应该尝试使用 @ActionLink 而不是

# c# - 无法在数据库中存储带逗号的字符串

> ID：11123630
> 
> 赞同：-2
> 
> 时间：2012-06-20T16:07:42.753
> 
> 标签：c#, sql-server, tsql, stored-procedures

我正在使用以下行将字符串存储在数据库中，但目前无法将其存储为单个字符串。每次在字符串中遇到逗号时，它都会在数据库表中创建一个新行。

```
cmd.Parameters.AddWithValue("@ImageURL", String.Join(",", img.ToArray())); 
```

有什么办法呢？

这就是我定义表格的方式：

```
@ImageURL VARCHAR(max)

AS
BEGIN
  SET NOCOUNT ON added to prevent extra result sets from
  interfering with SELECT statements.
  SET NOCOUNT ON;

  Insert statements for procedure here
  insert into 
  DECLARE @String    VARCHAR(100) 

  SET @String =''            

  IF(LEN(@Images)>0)        
  BEGIN        
       DELETE FROM Business_images WHERE BusinessId=@BusinessId        
  END        

  WHILE LEN(@ImageURL) > 0              
  BEGIN           
    SET @String = LEFT(@ImageURL, ISNULL(NULLIF(CHARINDEX(',', @ImageURL) - 1, -1),  LEN(@ImageURL)))              
    SET @ImageURL = SUBSTRING(@ImageURL, ISNULL(NULLIF(CHARINDEX(',', @ImageURL), 0), LEN(@ImageURL)) + 1, LEN(@ImageURL)) 

    insert into Images(ImageURL) values (@String)
  END
END 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T16:14:13.107

```
string specialString = "this is silly, string,,not so special''special";
using (SqlConnection conn = new SqlConnection(connectionString))
{
    using (SqlCommand command = new SqlCommand("Insert into t1 (col1) VALUES (@parame)"))
    {
        command.Connection = conn;
        command.Parameters.AddWithValue("@parame",specialString);
        command.ExecuteNonQuery();
    }
} 
```

仅供参考：我能够插入到 sql server 中。在我的情况下`col1`是类型`nvarchar`

# iphone - 移动地理定位需要两个负载才能准确

> ID：11123633
> 
> 赞同：0
> 
> 时间：2012-06-20T16:07:55.860
> 
> 标签：iphone, mobile, geolocation

**我的问题：** 需要从我的移动浏览器（使用 iphone 测试）加载两个页面才能获得准确的结果。第一个负载将偏离半英里或更远，然后第二个负载将非常接近。

**我的问题：** 需要做什么才能在第一次加载时获得准确的位置？

**额外信息：**

我已经阅读了[http://www.w3.org/TR/geolocation-API/](http://www.w3.org/TR/geolocation-API/)并且正在使用带有 enableHighAccuracy 的 watchPosition。另外我正在使用 maximumAge:0 并且未设置超时。

来自[http://www.w3.org/TR/geolocation-API/](http://www.w3.org/TR/geolocation-API/)

> 如果 maximumAge 设置为 0，则实现必须立即尝试获取新的位置对象
> 
> 用于超时属性的默认值为 Infinity

**我的代码在下面列出**

```
// Try HTML5 geolocation
    if(navigator.geolocation) {

    // updated this with watchPosition rather than getCurrentPosition
      navigator.geolocation.getCurrentPosition(function(position) {
        var pos = new google.maps.LatLng(position.coords.latitude,
                                         position.coords.longitude);

        var infowindow = new google.maps.InfoWindow({
          map: map,
          position: pos,
          content: 'Location found using HTML5.'
        });

        map.setCenter(pos);
      }, function() {
        handleNoGeolocation(true);
      },
    // enable high accuracy
    //  {maximumAge:100, timeout:5000, enableHighAccuracy: true}
            // 
                {maximumAge:0, enableHighAccuracy: true}
      );
    } else {
      // Browser doesn't support Geolocation
      handleNoGeolocation(false);
    }
  }

  function handleNoGeolocation(errorFlag) {
    if (errorFlag) {
      var content = 'Error: The Geolocation service failed.';
    } else {
      var content = 'Error: Your browser doesn\'t support geolocation.';
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T22:50:18.810

我有解决方案来获得最准确的地理位置。您需要在给定超时后调用 clearWatch()。超时可能是时间和/或诸如表单点击之类的事件。

在我的应用程序中，我使用 5 秒超时和单击表单元素。

这是所有有用的代码片段。

设置onclick

```
<select onclick="aFormClick()" id="location" 
```

在作为 watchPosition 函数的父函数的函数中设置超时

```
setTimeout("stopWatchPosition()",5000); 
```

创建一个函数来监听表单点击

```
function aFormClick(){
stopWatchPosition();
} 
```

创建调用 clearnWatch() 的函数

```
function stopWatchPosition(){
if (clearWatchCalled == 0){
    navigator.geolocation.clearWatch(watchID);
    clearWatchCalled++;
}
} 
```

确保你的 watchPosition 可以被 ID 引用

```
watchID = navigator.geolocation.watchPosition(function(position) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T21:05:04.980

GPS 无线电可能在第一页加载时未打开。为了让收音机有时间打开，您可能需要读取一个位置来启动 GPS，丢弃第一个位置结果，等待几秒钟让 GPS 收音机预热并找到足够的卫星以获得良好的位置定位，然后在定时异步回调函数中再次读取位置。

# c# - 如何从 C#.NET 中的本地 IP 解析主机名？

> ID：11123639
> 
> 赞同：14
> 
> 时间：2012-06-20T16:08:16.377
> 
> 标签：c#, .net

我正在尝试列出网络上当前在线的计算机名称。我只设法获得了活动 IP，但我无法获得这些 IP 的计算机名称。有任何想法吗 ？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-06-20T16:14:20.167

您可以使用[Dns.GetHostEntry](http://msdn.microsoft.com/en-us/library/ms143996.aspx)尝试**解析**名称，因为**并非每个 IP 都有名称**。

```
using System.Net;
...

public string GetHostName(string ipAddress)
{
    try
    {
        IPHostEntry entry = Dns.GetHostEntry(ipAddress);
        if (entry != null)
        {
           return entry.HostName;
        }
    }
    catch (SocketException ex)
    {
       //unknown host or
       //not every IP has a name
       //log exception (manage it)
    }

    return null;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-20T16:14:13.563

如果您已经有一个 IP 地址列表，您可以通过以下方式找到名称：

```
 System.Net.Dns.GetHostEntry("youripaddress").HostName; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-20T16:13:31.830

从 IP 地址，您可以使用该[`Dns.GetHostEntry`](http://msdn.microsoft.com/en-us/library/ms143998%28v=vs.100%29.aspx)方法。

# c++ - 如何释放 boost::multi_index::multi_index_container 使用的内存？

> ID：11123644
> 
> 赞同：1
> 
> 时间：2012-06-20T16:08:38.753
> 
> 标签：c++, memory, free, boost-multi-index

如何释放“person_map_t multi_indexed_persons_map”使用的内存？我在谷歌上找不到关于它的东西。

这是我的测试代码：

```
#include <sstream>
#include <ostream>
#include <stdio.h>
#include <iostream>
#include <string>
#include <boost/lexical_cast.hpp>
#include <boost/multi_index_container.hpp>
#include <boost/multi_index/hashed_index.hpp>
#include <boost/multi_index/mem_fun.hpp>
#include <boost/multi_index/tag.hpp>
#include <boost/multi_index/ordered_index.hpp>

struct name {};
struct age {};

struct person
{
    std::string name_;
    int age_;

    std::string name() const
    {
        return name_;
    }

    int age() const
    {
        return age_;
    }
};

typedef boost::multi_index::multi_index_container<
    person,
    boost::multi_index::indexed_by<
        boost::multi_index::ordered_unique<
            boost::multi_index::tag<name>,
            boost::multi_index::const_mem_fun<person, std::string, &person::name>
        >,
        boost::multi_index::ordered_non_unique<
            boost::multi_index::tag<age>,
            boost::multi_index::const_mem_fun<person, int, &person::age>
        >
    >
> person_map_t;

int main(int argc, char *argv[])
{
    std::string userinput;

    {
        person_map_t multi_indexed_persons_map;
        for (int i = 0; i < 100000; i++)
        {
            person p;
            p.name_ = std::string("MyName_") + boost::lexical_cast<std::string>(i);
            p.age_ = i;
            multi_indexed_persons_map.insert(p);
        }

        std::cout << "Done inserting." << std::endl;

        std::cin >> userinput; // while this is blocking, check consumtion with: `ps u -C <binname>`
    }

    // multi_indexed_persons_map.erase(multi_indexed_persons_map.begin(), multi_indexed_persons_map.end()); /* dosnt work too ... */

    std::cout << "Memory freed?" << std::endl;
    // out of scope, memory should be freed now,
    // check again with: `ps u -C <binname>` and compare.
    std::cin >> userinput;

    return 0;
} 
```

如何测试：

1.  启动二进制文件。
2.  等到它完成插入。
3.  使用 . 检查内存消耗`ps u -C <binname>`。
4.  cin somthing，至少一个标志。
5.  使用 再次检查内存消耗`ps u -C <binname>`。

现在应该释放一些内存，对吧？

编辑：

valgrind 输出：

```
==2314== 
==2314== HEAP SUMMARY:
==2314==     in use at exit: 0 bytes in 0 blocks
==2314==   total heap usage: 400,005 allocs, 400,005 frees, 16,489,069 bytes allocated
==2314== 
==2314== All heap blocks were freed -- no leaks are possible
==2314== 
==2314== For counts of detected and suppressed errors, rerun with: -v
==2314== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 6 from 6) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T17:15:56.590

它应该而且我猜它会，虽然我不知道 multi_index_container 的细节。这与您使用的平台更相关，而不是与 boost 或 C++ 相关的任何事情。

如果您将日志记录在 Person 的 ctors 和 dtors 中，您可以查看 Persons 是否还在，我怀疑他们不会。

进程是否真的将内存返回给操作系统取决于平台，但我相信在语言本身和操作系统之间通常有一层内存管理可以保留内存。

此外，正如 Emile 指出的那样，stl 和 boost 类使用分配器，它们是运行时之上的附加层，也可以保留内存。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-20T16:10:57.277

内存释放发生在超出范围而不是使用擦除时。`{ }`要使其超出范围，将其与内存一起使用并在内存之后使用它的代码`}`将被释放。

# .net - 程序关闭时的 Log4Net Persist 缓冲区

> ID：11123650
> 
> 赞同：0
> 
> 时间：2012-06-20T16:09:14.150
> 
> 标签：.net, winforms, user-interface, log4net

全新的 Log4Net 库，有一些我无法弄清楚的东西。

我假设缓冲区仅在内存中，对吗？当您启动应用程序的新实例时，缓冲区会重新初始化吗？我有一个要求，我被告知仅在应用程序失败 x 次后才向技术支持发送电子邮件。此应用程序将按计划运行（每两分钟左右）。如果失败，它将在两分钟内重试。如果它失败了太多次而不成功（并且由于抛出错误而失败），那么它应该发送电子邮件。

我现在能想到的最简单的方法是将失败尝试的次数保存到 user.config。然后，当我的程序捕获异常时，检查发生了多少次失败尝试，如果达到阈值，则使用正确的记录器/附加器发送电子邮件。程序成功运行后，它在退出之前要做的最后一件事是将 user.config 设置重置为 0 次失败尝试。

有没有更好的办法？也许某种方式可以保留缓冲区，以便我可以对有损设置做一些事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T18:27:05.323

缓冲区在内存中，这意味着如果您要一次又一次地启动应用程序并考虑计划任务，您将不得不以某种方式保存您的数据。

我会为此使用文件或注册表（其他持久性解决方案 - 数据库，[memcached](http://memcached.org/) ...等）

要使用 log4net 发送消息，您可以查看[这篇文章](http://sradack.blogspot.co.il/2007/09/have-log4net-send-email-when-error.html)

# javascript - 人脸 API 检测 Canvas 的问题

> ID：11123651
> 
> 赞同：0
> 
> 时间：2012-06-20T16:09:19.897
> 
> 标签：javascript, canvas

我目前正在尝试做的是使用人脸 API 来检测用户上传的图像。我正在尝试关注文档并且论坛已锁定，所以我最好的选择是在这里。代码如下：

```
<!DOCTYPE html>
<html>
    <head>
        <title>FaceDetect</title>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.js"></script>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        <script type="text/javascript" src="http://api.face.com/lib/api_client.js"></script>
        <!--<script type="text/javascript" src="http://api.face.com/lib/tagger.js"></script>-->
        <style type="text/css">
            .f_attribution {display:none;}
        </style>
        <script type="text/javascript"> 
        var data = canvas.toDataURL('image/jpeg', 1.0);
        newblob = dataURItoBlob(data);
        var formdata = new FormData();
        formdata.append("<-- Insert Key -->", faceKey);
        formdata.append("<-- Insert Key -->", faceSecret);
        formdata.append("filename","temp.jpg");
        formdata.append("file",newblob);
        $.ajax({
                         url: 'http://api.face.com/faces/detect.json',
                         data: formdata,
                         cache: false,
                         contentType: false,
                         processData: false,
                         dataType:"json",
                         type: 'POST',
                         success: function (data) {
                             handleResult(data.photos[0]);
                         }
         });
        //credit http://stackoverflow.com/a/8782422/52160
        function dataURItoBlob(dataURI, callback) {
                // convert base64 to raw binary data held in a string
                // doesn't handle URLEncoded DataURIs
                var byteString;
                if (dataURI.split(",")[0].indexOf("base64") >= 0) {
                    byteString = atob(dataURI.split(",")[1]);
                } else {
                    byteString = unescape(dataURI.split(",")[1]);
                }
                // separate out the mime component
                var mimeString = dataURI.split(",")[0].split(":")[1].split(";")[0];
                // write the bytes of the string to an ArrayBuffer
                var ab = new ArrayBuffer(byteString.length);
                var ia = new Uint8Array(ab);
                for (var i = 0; i < byteString.length; i++) {
                    ia[i] = byteString.charCodeAt(i);
                }
                // write the ArrayBuffer to a blob, and you're done
                var BlobBuilder = window.WebKitBlobBuilder || window.MozBlobBuilder;
                var bb = new BlobBuilder();
                bb.append(ab);
                return bb.getBlob(mimeString);
        }
        </script>
    </head>
    <body>
        <h1>MetroClick FaceDetect</h1>
        <!--<img id="simage" src="http://images.wikia.com/powerrangers/images/f/fe/ActorJohnCho_John_Shea_55027822.jpg"/>-->
        <canvas id="canvas" width="500" height="500"></canvas>
        <input type='file' name='img' size='65' id='uploadimage' />
        <script type="text/javascript">
        //<![CDATA[ 
        function draw(ev) {
            console.log(ev);
            var ctx = document.getElementById('canvas').getContext('2d'),
                img = new Image(),
                f = document.getElementById("uploadimage").files[0],
                url = window.URL || window.webkitURL,
                src = url.createObjectURL(f);

            img.src = src;
            img.onload = function() {
                ctx.drawImage(img, 0, 0);
                url.revokeObjectURL(src);
            }
        }

        document.getElementById("uploadimage").addEventListener("change", draw, false)
        //]]>  
        //FaceClientAPI.init('8b3b9170dc5b8a8a4012b06b492449e5');
        //FaceTagger.load("#simage", { demo_mode:true, click_add_tag: false, resizable: true, facebook: false, fade: true, tags_list: false, add_tag_button: true });
        </script>
    </body>
</html> 
```

我在 Chrome 控制台中不断收到“画布”未定义错误。不太确定我在哪里遇到问题。

任何帮助都会非常感谢。

编辑 - 删除的键

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T16:11:06.120

因为你没有定义它...

```
var canvas = document.getElementById('canvas'),
    data = canvas.toDataURL('image/jpeg', 1.0); 
```

更改您的 js 中的第一行以包含此内容，您应该已准备就绪。

此外，当您定义“画布”时，您应该能够更改

```
document.getElementById('canvas').getContext('2d') 
```

至

```
canvas.getContext('2d'); 
```

# cakephp - 代码中出现意外的 T_FUNCTION，是什么意思？

> ID：11123652
> 
> 赞同：0
> 
> 时间：2012-06-20T16:09:20.537
> 
> 标签：cakephp, error-handling

~~我在 $keyRows++ 行上收到意外的 T_FUNCTION 错误。~~

```
 $mapArray = array();
    $unifiedKeys = array();
    $unifiedKeys = $this->query("select distinct FLOWSHEET_ID from FLOWSHEET_TEMPLATE;");
    $keyRows = 1;
    while ($row = mssql_fetch_assoc($unifiedKeys)) {

        $mapArray['Method'.$keyRows] = array(
                CaBase::KEY_MAPPING_LOGIC_COMPLEXITY => CaBase::LEVEL3_COMPLEXITY,
                CaBase::KEY_FIELD_LOGIC_NAME         => 'wsUnifiedKey' ,
                //CaBase::KEY_FIELD_QUESTION_ID      => $unifiedKeys($id_position))
                CaBase::KEY_FIELD_QUESTION_ID        => '$row[\"FLOWSHEET_ID\"]'
                );  //fixed error
        $keyRows++;
    }
    return $mapArray; 
```

1）这个错误是什么意思？我明白了很多，但我不知道如何调试它，因为我不知道它是什么意思。

~~2）我应该如何解决错误？我尝试添加 $this->keyRows++，但这也不起作用。最初我在这一行收到“无法在写入上下文中使用函数返回值”错误，但我将 $mapArray[] 行更改为括号而不是括号，现在我收到 T_FUNCTION 错误。~~

错误现已修复。但是我仍然对 T_FUNCTION 错误的含义/出现时要查找的内容感到好奇。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:34:49.420

问题出在 $keyRows++ 之上。您没有将分号放在数组之后。:D

```
$mapArray['Method'.$keyRows] = array(
                CaBase::KEY_MAPPING_LOGIC_COMPLEXITY => CaBase::LEVEL3_COMPLEXITY,
                CaBase::KEY_FIELD_LOGIC_NAME         => 'wsUnifiedKey' ,
                //CaBase::KEY_FIELD_QUESTION_ID      => $unifiedKeys($id_position))
                CaBase::KEY_FIELD_QUESTION_ID        => '$row[\"FLOWSHEET_ID\"]'
                ); 
```

# java - 我应该将main方法放在Java的超类还是子类中

> ID：11123653
> 
> 赞同：2
> 
> 时间：2012-06-20T16:09:24.447
> 
> 标签：java

如果一个类在Java程序中具有继承性，我需要将main方法放在超类还是子类中？许多程序将主要方法放在不同的位置。谁能告诉我该怎么做？非常感谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-20T16:11:43.923

我认为最好有一个简单的类，其唯一的专用目的是包含该`static main`方法。它简单明了。

然后，您的 main 方法将通过从您的程序创建初始对象来开始工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-20T16:12:19.843

您可以使用 main 方法创建一个新的专用类，比如 Launcher，在那里实例化您的类，并管理任何意外异常：

```
public class Luncher{

  public static void main(String args){
    //insert argument checking logic

    try{
      new MyClass.executeLogic(someArguments);
    }catch(Exception e){
      //insert exception handling logic here
    }

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T16:11:36.117

将主要方法放在哪里取决于您，但我只是将它放入新类中，只有一种方法，`static Main(String[] args)`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-20T16:11:53.127

您可能希望将`main()`方法放在您可以控制或驱动程序的所有操作的地方。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-20T16:17:47.303

好吧，这取决于，但通常主要方法放在子类中。继承和阴影之间有很大的区别。但是你可以把它放在子类或超类。记住主要方法是静态的。

# iphone - 将 UIAlertViewStyleLoginAndPasswordInput 与 UIKeyboardTypeEmailAddress 结合起来

> ID：11123656
> 
> 赞同：4
> 
> 时间：2012-06-20T16:09:34.873
> 
> 标签：iphone, ios, email, login, xamarin.ios

有什么方法可以显示`UIAlertView`带有登录名/密码的文本字段，以便键盘类型为 type `UIKeyboardTypeEmailAddress`？

我使用`UIAlertView`如下：

```
var alertView = new UIAlertView("Login".Translate(), "", null, "Cancel".Translate(), "Login".Translate());
alertView.AlertViewStyle = UIAlertViewStyle.LoginAndPasswordInput; 
```

或者，在 Objective-C 中：

```
UIAlertView *alertView = [[UIAlertView alloc]
                          initWithTitle:@"Title"
                          message:@"Message"
                          delegate:self
                          cancelButtonTitle:@"Cancel"
                          otherButtonTitles:@"Login", nil];
[alertView setAlertViewStyle:UIAlertViewStyleLoginAndPasswordInput]; 
```

但是我的应用程序的所有用户名都是电子邮件地址，所以我希望将登录文本字段的键盘作为电子邮件地址键盘，即`UIKeyboardTypeEmailAddress`.

有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-20T16:14:38.117

知道了。您可以获取的文本字段`UIAlertView`并在那里设置样式：

```
alertView.GetTextField(0).KeyboardType = UIKeyboardType.EmailAddress; 
```

对象-C：

```
[[alertView textFieldAtIndex:0] setKeyboardType:UIKeyboardTypeEmailAddress]; 
```

# c - 为什么循环裂变在这种情况下有意义？

> ID：11123658
> 
> 赞同：9
> 
> 时间：2012-06-20T16:09:57.760
> 
> 标签：c, performance, optimization, memory

没有裂变的代码是这样的：

```
int check(int * res, char * map, int n, int * keys){
    int ret = 0;
    for(int i = 0; i < n; ++i){
        res[ret] = i;
        ret += map[hash(keys[i])]
    }
    return ret;
} 
```

裂变：

```
int check(int * res, char * map, int n, int * keys){
    int ret = 0;
    for(int i = 0; i < n; ++i){
        tmp[i] = map[hash(keys[i])];
    }
    for(int i = 0; i < n; ++i){
        res[ret] = i;
        ret += tmp[i];
    }
    return ret;
} 
```

笔记：

*   瓶颈是`map[hash(keys[i])]`随机访问内存。

*   通常，这是`if(tmp[i]) res[ret++] = i;`为了避免 if，我正在使用`ret += tmp[i]`.

*   `map[..]`始终为 0 或 1

裂变版本通常要快得多，我试图解释原因。我最好的猜测是，它`ret += map[..]`仍然引入了一些依赖，并阻止了投机执行。

我想听听是否有人有更好的解释。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-20T17:47:17.957

从我的测试中，我得到了融合和分裂循环之间大约 2 倍的速度差异。无论我如何调整循环，这种速度差异都非常一致。

```
Fused: 1.096258 seconds
Split: 0.562272 seconds 
```

（请参阅底部的完整测试代码。）

* * *

虽然我不是 100% 确定，但我怀疑这是由于两件事的结合：

1.  由于[来自](http://en.wikipedia.org/wiki/Memory_disambiguation)`map[gethash(keys[i])]`. _
2.  融合循环版本中添加的依赖项。

很明显，`map[gethash(keys[i])]`几乎每次都会导致缓存未命中。事实上，可能足以使整个加载存储缓冲区饱和。

现在让我们看看添加的依赖项。问题是`ret`变量：

```
int check_fused(int * res, char * map, int n, int * keys){
    int ret = 0;
    for(int i = 0; i < n; ++i){
        res[ret] = i;
        ret += map[gethash(keys[i])];
    }
    return ret;
} 
```

store***的地址解析需要***该`ret`变量。*`res[ret] = i;`*

 **   在融合循环`ret`中，来自确定的缓存未命中。
*   在拆分循环中，`ret`即将到来`tmp[i]`- 这要快得多。

融合循环情况的地址解析延迟可能会导致`res[ret] = i`存储与`map[gethash(keys[i])]`.

由于加载存储缓冲区的大小是固定的，但其中的垃圾数量增加了一倍：
**您只能将缓存未命中重叠的次数减少到以前的一半。**因此减速了 2 倍。

* * *

**假设如果我们将融合循环更改为：**

```
int check_fused(int * res, char * map, int n, int * keys){
    int ret = 0;
    for(int i = 0; i < n; ++i){
        res[i] = i;    //  Change "res" to "i"
        ret += map[gethash(keys[i])];
    }
    return ret;
} 
```

这将打破地址解析依赖性。

^(（请注意，它不再相同，但这只是为了展示性能差异。）)

然后我们得到类似的时间：

```
Fused: 0.487477 seconds
Split: 0.574585 seconds 
```

* * *

**这是完整的测试代码：**

```
#define SIZE 67108864

unsigned gethash(int key){
    return key & (SIZE - 1);
}

int check_fused(int * res, char * map, int n, int * keys){
    int ret = 0;
    for(int i = 0; i < n; ++i){
        res[ret] = i;
        ret += map[gethash(keys[i])];
    }
    return ret;
}
int check_split(int * res, char * map, int n, int * keys, int *tmp){
    int ret = 0;
    for(int i = 0; i < n; ++i){
        tmp[i] = map[gethash(keys[i])];
    }
    for(int i = 0; i < n; ++i){
        res[ret] = i;
        ret += tmp[i];
    }
    return ret;
}

int main()
{
    char *map = (char*)calloc(SIZE,sizeof(char));
    int *keys =  (int*)calloc(SIZE,sizeof(int));
    int *res  =  (int*)calloc(SIZE,sizeof(int));
    int *tmp  =  (int*)calloc(SIZE,sizeof(int));
    if (map == NULL || keys == NULL || res == NULL || tmp == NULL){
        printf("Memory allocation failed.\n");
        system("pause");
        return 1;
    }

    //  Generate Random Data
    for (int i = 0; i < SIZE; i++){
        keys[i] = (rand() & 0xff) | ((rand() & 0xff) << 16);
    }

    printf("Start...\n");

    double start = omp_get_wtime();
    int ret;

    ret = check_fused(res,map,SIZE,keys);
//    ret = check_split(res,map,SIZE,keys,tmp);

    double end = omp_get_wtime();

    printf("ret = %d",ret);
    printf("\n\nseconds = %f\n",end - start);

    system("pause");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T16:13:36.750

我不认为这是数组索引，而是对函数的调用`hash()`可能导致管道停顿并阻止最佳指令重新排序。*

# wcf - NSMutableURLRequest http 状态码 413

> ID：11123661
> 
> 赞同：0
> 
> 时间：2012-06-20T16:10:15.110
> 
> 标签：wcf, rest, post, nsmutableurlrequest, http-protocols

我有一个网络服务。我用它来接受一个小（缩略图大小）图像的 base 64 字符串表示。当与 Fiddler 一起使用并手动发布请求时，此 Web 服务非常棒。当我使用 NSMutableURLRequest（或 ASIHTTPRequest）运行相同的请求时，它总是返回 413 状态代码（413 是请求实体太大）。

为什么 NSMutableURLRequest 会导致它出现 413，而 Fiddler 每次都返回 200？

这是我的 NSMutableURLRequest 代码。如果有人有任何想法，我真的可以使用推送。

```
 //the image request
        NSMutableURLRequest *imageRequest=[NSMutableURLRequest requestWithURL:[NSURL URLWithString:POST_IMAGE_API_URL] 
                                                                  cachePolicy:NSURLRequestUseProtocolCachePolicy
                                                              timeoutInterval:240.0];

        //the post parameters
        [imageRequest setHTTPMethod:@"POST"];
        [imageRequest setHTTPBody:[imageMessage dataUsingEncoding:NSUTF8StringEncoding]];
        [imageRequest setValue:@"text/xml" forHTTPHeaderField:@"Content-Type"];

        //a few other things
        NSURLResponse* imageresponse;
        NSError *imageerror;

        NSData* imageresult = [NSURLConnection sendSynchronousRequest:imageRequest returningResponse:&imageresponse error:&imageerror];
        NSHTTPURLResponse *httpResponse = (NSHTTPURLResponse*)imageresponse;

        NSLog(@"imageresponse: %d", httpResponse.statusCode); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:28:32.317

当我看到你的这段代码时：

```
//the image request
NSMutableURLRequest *imageRequest = 
    [NSMutableURLRequest requestWithURL:[NSURL URLWithString:POST_IMAGE_API_URL]  
                            cachePolicy:NSURLRequestUseProtocolCachePolicy   
                        timeoutInterval:240.0]; 
```

我猜你的“ `POST_IMAGE_API_URL`”#define 中有一些古怪的字符，很可能在你传递的参数中。

您需要对传递给 URL 请求[的 URL 字符串进行 URL 编码。](http://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/instm/NSString/stringByAddingPercentEscapesUsingEncoding%3a)

尝试做：

```
// assuming POST_IMAGE_API_URL starts with a "@" character
NSString * yourURLAsString = [NSString stringWithString: POST_IMAGE_API_URL]; 
NSURL * yourEncodedURL = [yourURL stringByAddingPercentEscapesUsingEncoding: NSUTF8StringEncoding]; 
```

并将“yourEncodedURL”作为参数传递给 URLRequest。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T13:57:41.327

我找到了解决方案。问题不在 Apple 端，而在 IIS 端。除了在 WCF 的 web.config 文件中指定的为每个服务指定“uploadReadAheadSize”的参数之外，还有一个用于 IIS 托管应用程序（其中一个是我的 WCF 服务）的附加参数。我增加了这个，413就消失了。有趣的是，在与服务所在的服务器位于同一网络的桌面客户端上从 Fiddler 发送 HTTP 请求时，我没有收到此错误。基本上，我有[这个人问题](https://stackoverflow.com/questions/10122957/iis7-413-request-entity-too-large-uploadreadaheadsize)的解决方案，但没有他的背景。我的解决方案是他的上下文。

# python - rmul有红宝石等价物吗？

> ID：11123676
> 
> 赞同：1
> 
> 时间：2012-06-20T16:11:03.517
> 
> 标签：python, ruby

ruby 中是否有 __rmul__ 的 ruby​​ 等效项？我似乎找不到任何关于此的信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T16:15:19.553

不确定 py，但是重载运算符`*`是你想要的吗？

如果那样的话，一个方法`*`就可以了。

```
a=Object.new
def a.*(rhs); rhs+2;end

a*2 #=> 4 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T16:20:28.943

进一步研究，似乎 rmul 的等价物是添加

```
def coerce(other)
    return self, other
end 
```

那么用 is_a 也有通常的 * 重载处理其他类型吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T17:26:33.327

在这里查看关于`coerce`Ruby 的讨论：

[在 Ruby 中， coerce() 是如何工作的？](https://stackoverflow.com/questions/2799571/in-ruby-how-does-coerce-actually-work)

# java - 3D 编程截锥体剔除

> ID：11123677
> 
> 赞同：2
> 
> 时间：2012-06-20T16:11:04.110
> 
> 标签：java, 3d, java-3d, openscenegraph

请在 3D 图形编程中对 Frustum Culling 进行一个很好的解释。我需要学习 3D（到目前为止从未进行过认真的图形编程），而且我很难理解手册中使用的一些术语以及我正在使用的书籍。

我目前正在尝试通读 Java 3D API 规范，因为这些书似乎和这本书一样。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T16:17:04.920

*   你的相机正在寻找一个方向，让我们称之为向前。
*   到处都有物体。
*   不在相机前面的对象对于渲染是不必要的。
*   太远的物体将不可见。
*   太近的物体会表现不佳（填满整个屏幕等）。

解决方案：移除所有不在视野范围内、太近或太远的物体。包含区域的形状是“[平截头](http://en.wikipedia.org/wiki/Frustrum)体”，您正在“[剔除](http://en.wikipedia.org/wiki/Culling)”不在其中的所有内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T18:29:56.143

“平截头体”是 3D 场景的区域，在该区域之外不会绘制任何内容。它是一个截断的金字塔，由 4 侧屏幕的可见性限制以及也由相机矩阵定义的“近”和“远”可见性限制（通常垂直于视图方向）​​限制。

使用 3D API 绘制的图形基元被*裁剪*到视锥体：只有在视锥体内的基元部分会出现。完全在截锥体之外的基元根本不会出现。

但是，即使您的图元没有出现在屏幕上，尝试绘​​制它也不是免费的：提交给硬件的每个图元都需要时间。而且，由于完全在截锥体之外的原语根本不出现，这是*浪费*时间。

因此，视锥体剔除是对基元或（更经济有效）整个对象的初步排序，以确定它们是否完全在视锥体之外。当它确定一个对象或图元在截锥体之外时，截锥体剔除通过根本不尝试绘制它来节省时间。

# html - 在 Smarty 的块中摆脱 HTML 标签

> ID：11123681
> 
> 赞同：2
> 
> 时间：2012-06-20T16:11:12.240
> 
> 标签：html, tags, smarty, block

如何摆脱 Smarty 块中的 HTML 标签？
我已经`{strip}`在街区内尝试过，但没有奏效。
我也尝试写一个插件。但是如何将块的内容解析为字符串变量呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T16:20:40.063

这`{strip}`块实际上做了其他事情 - 它只是从标记中去除空格。

您可以编写一个简单的块插件：

```
function smarty_block_sanitize($parms, $content, &$smarty, &$repeat ) {
    if( $repeat ) {
        return( strip_tags( $content ) );
    }
} 
```

将它放在显示模板之前调用的 PHP 文件中的某个位置。要在模板中使用它，请执行以下操作：

```
Sample text {sanitize}<more markup>test</more markup>{/sanitize}  End text. 
```

当心允许带有 strip_tags 的标签（带有它的 PHP 参数），因为 onclick / onmouseover / 其他邪恶属性不会被过滤。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-18T02:52:09.573

您可以[`{capture}`](http://www.smarty.net/docs/en/language.function.capture.tpl)对变量进行块，然后[`strip_tags()`](http://php.net/strip_tags)在其上使用 PHP：

```
{capture name="withtags"}
    <em>Text</em> with <strong>tags</strong>
{/capture}
{$smarty.capture.withtags|strip_tags} 
```

# sql - 计数项目并创建一个数组

> ID：11123682
> 
> 赞同：0
> 
> 时间：2012-06-20T16:11:16.933
> 
> 标签：sql, postgresql, aggregate-functions

我有两列 A 和 B，并希望在 B 列中获取按 A 列中的项目分组的项目列表（及其计数），并使用该信息创建一个新表。所以新表看起来像：

```
newCol1 | newCol2
--------+--------
a1,     | b1:3,b4:1,b7:11
a2,     | b2:1,b3:5,b4:3,b8:2 
```

……等等。（不过，分隔符可以是任何东西。如果无法连接项目和计数，我也可以有一列包含项目列表，另一列包含由分隔符分隔的计数列表。）

我可以通过首先获取所有项目并将它们存储在具有计数更新的映射中，然后更新新表来在 Java 中做到这一点，但我想知道在 PostgreSQL 中是否有任何方法可以做到这一点（也许通过编写一个函数）。

我已经查看了 PostgreSQL 中的数组函数，但没有走多远。任何指针以及存储此类数据的建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T17:47:35.950

您没有提供任何表定义或输入数据（应该产生您的输出），所以这只是在黑暗中拍摄：

```
select a, string_agg(b||':'||to_char(b_count), ',)
from (
   select a, 
          b,
          count(b) over (partition by a) as b_count,
   from the_unknown_table
) t
group by a 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T17:52:45.613

`a`并且`b`是 type `text`，我假设。

```
SELECT a, array_agg(bs) AS b_list
FROM  (
    SELECT a, b || ':' || count(*) AS bs  -- coerced to text automatically
    FROM   tbl
    GROUP  BY a, b
    ORDER  BY a, b   -- to sort b_list in the result
    ) x
GROUP  BY a; 
```

或者使用`string_agg()`@a_horse 演示来获取字符串而不是数组作为结果。

# c# - XtraTreeList AutoNodeHeight

> ID：11123683
> 
> 赞同：2
> 
> 时间：2012-06-20T16:11:19.750
> 
> 标签：c#, .net, winforms, devexpress, xtratreelist

早上好，我有一个无法解决的问题，我需要你在一个对象“TreeListNode”的行中可以分三行显示一个文本，问题是我只能看到这个文本的第一行剩下的两行即使扩大行的高度也不会丢失。

我试图按如下方式包装属性 setar。

tln.TreeList.Appearance.Row.TextOptions.WordWrap = WordWrap.Wrap;

tnl 是“TreeListNode”所在的对象，但这样我看不到我的字符串的 3 行。

我也试过这样做。

tln.TreeList.OptionsBehavior.AutoNodeHeight = true;

成就还显示我的文本字符串的所有行。

我的文本字符串的格式如下。

文本 文本 文本 文本 \r\n 文本 文本 文本 \r\n 文本 文本 文本 文本 文本 文本。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T19:48:40.020

[我在这里](http://www.devexpress.com/Support/Center/kb/p/A8.aspx)找到了答案。您需要将单元格的编辑器设置为**RepositoryItemMemoEdit**类型。

示例代码（windows窗体项目）：

```
 protected override void OnLoad(EventArgs e)
    {
        CreateColumns(treeList1);
        CreateNodes(treeList1);

        treeList1.Appearance.Row.TextOptions.WordWrap = DevExpress.Utils.WordWrap.Wrap;
        treeList1.OptionsBehavior.AutoNodeHeight = true;

        base.OnLoad(e);
    }

    private void CreateColumns(TreeList tl)
    {
        // Create three columns.
        tl.BeginUpdate();
        tl.Columns.Add();
        tl.Columns[0].Caption = "Customer";
        tl.Columns[0].VisibleIndex = 0;
        tl.Columns.Add();
        tl.Columns[1].Caption = "Location";
        tl.Columns[1].VisibleIndex = 1;
        tl.Columns.Add();
        tl.Columns[2].Caption = "Phone";
        tl.Columns[2].VisibleIndex = 2;
        tl.Columns[0].ColumnEdit = new DevExpress.XtraEditors.Repository.RepositoryItemMemoEdit();
        tl.EndUpdate();
    }

    private void CreateNodes(TreeList tl)
    {
        tl.BeginUnboundLoad();
        // Create a root node .
        TreeListNode parentForRootNodes = null;
        TreeListNode rootNode = tl.AppendNode(
            new object[] { "Alfreds FutterkisteTEST\r\nTEST\r\nTEST", "Germany, Obere Str. 57", "030-0074321" },
            parentForRootNodes);            

        // Create a child of the rootNode
        tl.AppendNode(new object[] { "Suyama, Michael", "Obere Str. 55", "030-0074263" }, rootNode);
        // Creating more nodes
        // ...
        tl.EndUnboundLoad();
    } 
```

# c++ - 分配一个stl容器是否安全？

> ID：11123684
> 
> 赞同：5
> 
> 时间：2012-06-20T16:11:19.867
> 
> 标签：c++, stl, variable-assignment

例如：

```
set<int> s1;
set<int> s2;
s1.insert(1);
s2.insert(2);
s1 = s2; 
```

安全吗？如果是这样，旧元素（以及它们发生的记忆）是从哪里来的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-20T16:13:18.243

是的，完成任务是安全的。它调用复制构造函数或赋值运算符，旧元素被删除`s1`并被`s2`.

[注意：如果存在任何潜在问题，则复制构造函数和赋值将被禁止，如`fstream`, `ofstream`, `ifstream`.]

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-20T16:13:12.453

是的。旧元素将以通常的方式销毁并释放任何内存。（当然，如果你在容器中存储指针，它只会破坏指针，而不会释放它指向的东西）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-20T16:12:53.250

是的，您的示例是安全的。但请注意：您没有将 s2 分配给 s1，而是将 s2 复制到 s1。有关更多信息，请参见：[set::operator=](http://cplusplus.com/reference/stl/set/operator=/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-20T18:39:21.520

任务是安全的。

赋值运算符将通过调用它们的析构函数来销毁最初包含在 s1 中的对象（在您的示例中对 int 来说是一个微不足道的无操作）。该集合是否也释放内存，或者将其保留为未初始化的内存以供随后添加的元素使用，取决于实现。

s1 中的新对象将从 s2 中的对象复制，这可能需要相当长的时间。如果您不想在分配后保留 s2，更好的方法可能是交换两个容器或使用 C++11 移动分配。

```
std::swap(s1, s2);  // Backwards-compatible swap
s1 = std::move(s2); // C++11 rvalue move assignment 
```

这两个很可能只是交换一个指针，将您要保留在 s1 中的内容和其余内容留在 s2 中，以便在 s2 超出范围时清除。

# sql-server - SSIS 查询不会在执行 Sql 任务编辑器中更新，但会在 sql server management studio 中更新

> ID：11123685
> 
> 赞同：0
> 
> 时间：2012-06-20T16:11:19.927
> 
> 标签：sql-server, sql-server-2008, ssis

这是脚本：

```
DECLARE @Filename varchar(10)
SET @Filename = 'TubeSta_cycle_log.txt'

UPDATE    Torque.LastUpdate
SET       LastUpdated = getDate()
WHERE     Station  = substring(@Filename,1,CHARINDEX('_', @FileName)-1) 
```

“执行 SQL 任务编辑器”执行时没有错误，但不会更新表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T16:16:17.587

好吧，我看到了一些可能的问题。

```
DECLARE @Filename varchar(10)
SET @Filename = 'TubeSta_cycle_log.txt' 
```

添加到参数的值是`TubeSta_cy`您的文件名被截断。

如果您在 SSMS 中运行：

```
select substring(@Filename,1,CHARINDEX('_', @FileName)-1) 
```

结果是`TubeSta`，你有那个值的记录吗？

看来你需要扩展你的`varchar(50)`

# gcc - 使用 gcc-4.7 编译 cilk plus 时出错

> ID：11123691
> 
> 赞同：0
> 
> 时间：2012-06-20T16:11:35.797
> 
> 标签：gcc, cilk, cilk-plus

我收到以下错误

```
main.c:107:2: internal compiler error: in extract_for_fields, at cilk-spawn.c:1857
} 
```

相关线路是：

```
cilk_for (index = 0; table_name[index]!=NULL; ++index )
{
      /* some work*/
} 
```

`Line 107`对应于 cilk_for 循环的右大括号。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T17:50:30.047

尝试构建没有优化（省略任何优化标志，或`-O0`明确使用）。

如果这有帮助，您可以尝试看看`-O1`（一些优化）是否有效，然后`-O2`，等等。如果幸运的话，您可以找出导致问题的优化方式，然后简单地使用一些`-fno-foo`标志禁用该优化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T18:02:03.433

我上面所做的不是一个有效`cilk_for`的循环，因为`cilk_for`循环必须测试控制变量。还必须能够预测循环将运行多少次，在这种情况下这是不可能的。所以正确的版本是

```
int count=0;
while(table_name[count]!=NULL)
    count++;
cilk_for (index = 0; index!=count; ++index )
{
      /* some work*/
} 
```

# jquery - 如何设计一个依赖于已加载页面的 jQuery 插件？

> ID：11123705
> 
> 赞同：1
> 
> 时间：2012-06-20T16:12:33.620
> 
> 标签：jquery, jquery-plugins

我正在编写一个这样开始的 jQuery 插件：

```
$.fn.kewTip = (function() {
    var $kewtip = $('<div></div>').css({'position':'absolute','zIndex':2147483647}).attr({'class':'kewtip'}).hide().appendTo('body'); 
```

您会注意到它会立即将一个元素附加到页面正文，但在 DOM 准备好之前它不能这样做，这意味着在 DOM 准备好之前也不能定义插件。

但是，`$('xxx').kewTip()`如果他们尝试在`$(document).ready({ ... })`. 那么我该如何解决呢？

我的插件依赖于这个元素存在，那么如何在 DOM 准备好之前定义它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T16:26:14.607

如果您要做的`div`只是在第一次调用插件方法时确定存在，那么只需创建它。为了使用元素（附加元素、事件处理程序），不必将其添加到 DOM。

`body`然后，在加载 DOM 时独立地添加元素。

例如：

```
$.fn.kewTip = (function() {
    // create element
    var $kewtip = $('<div />', {
        'class': 'kewtip',
        'style': 'position:absolute;zIndex:2147483647;display:none'
     });

    // add to DOM once it is ready
    $(function() {
        $kewtip.appendTo('body');
    });

    return function() {
        // here you can do whatever with `$kewtip` no matter whether it was 
        // already appended to body or not
    }
}()); 
```

*（我假设你在那里有一个自调用函数）*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T16:25:54.063

根据乔伊的建议，我想出了这个：

```
$.fn.kewTip = (function() {
    var $kewtip = $();
    $(function() {
        $kewtip = $('<div></div>').css({'position':'absolute','zIndex':2147483647}).hide().appendTo('body');
    }); 
```

`$()`只是给出一个[空的 jQuery 对象](https://stackoverflow.com/a/897341/65387)，所以其余的代码在它准备好之前不会发生灾难性的失败。

# javascript - Google Charts 自定义数据点标记（图片）

> ID：11123706
> 
> 赞同：3
> 
> 时间：2012-06-20T16:12:35.570
> 
> 标签：javascript, jquery, charts, google-visualization

我想知道是否有一种方法可以将自定义图像定义为数据点。

对于 LineGraph，有一个`pointSize`属性可以设置数据点的大小。（这并不奇怪）。

该属性也可以被系列属性覆盖，您还可以在其中定义自定义颜色。

尽管如此，我看不到任何允许自定义标记的东西。

为了让我的问题绝对清楚：

这就是我想要的：[带有示例的图像](http://imageshack.us/photo/my-images/213/timelinewithpics.png/)

两种理想的解决方案

1.  将属性设置为具有类名的数据点，并在 css 中为该类名定义图片。（对我来说这似乎是不可能的，因为这些是 SVG 图形）
2.  添加带有数据标记图像源的额外列。

尽管这些在理论上看起来很完美，但我不知道如何实施它们。

一个不太完美的解决方案可能是从 SVG 中提取点位置并使用 JavaScript 动态定位带有图像的 div（这似乎非常不雅且容易出现错误）

或者，请推荐一个免费且支持此类功能的 js 图表库。

**编辑：**

与此同时，我发现了一个非常好的且相当便宜的库（每个网站许可证 60 美元），它涵盖了这个功能：[Highcharts library](http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/demo/spline-symbols/)但最初的问题仍然悬而未决。

# bash - 在将 shell 变量传递给另一个命令之前删除前导零

> ID：11123717
> 
> 赞同：50
> 
> 时间：2012-06-20T16:13:06.503
> 
> 标签：bash, strip

事实证明，iptables 不能很好地处理前导零。由于`$machinenumber`它必须有一个前导零用于其他目的，因此这个想法只是创建一个`$nozero`基于 的新变量 ( ) `$machinenumber`，其中前导零被去除。

`$machinenumber`是 01 到 24 之间的两位数。目前是 09

`$machinetype`现在是74，以前没有造成任何问题。

到目前为止，我所拥有的是：

```
nozero = (echo $machinenumber | sed 's/^0*//')
iptables -t nat -I POSTROUTING -s 10.($machinetype).($nozero).0/24 -j MASQUERADE 
```

虽然我相信我走在正确的轨道上，但代码会导致：

```
ERROR - Unknown string operation 
```

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2012-06-21T01:10:23.267

您不需要使用`sed`或其他外部实用程序。以下是 Bash 可以为您去除前导零的几种方法。

```
iptables -t nat -I POSTROUTING -s "10.$machinetype.$((10#$machinenumber)).0/24" -j MASQUERADE 
```

`$(())`设置算术上下文并将数字从以 10 为底的`10#`数字转换为以 10 为底的数字，从而导致丢弃任何前导零。

```
shopt -s extglob
iptables -t nat -I POSTROUTING -s "10.$machinetype.${machinenumber##+(0)}.0/24" -j MASQUERADE 
```

`extglob`打开时，显示的参数扩展会删除所有前导零。不幸的是，如果原始值为 0，则结​​果为空字符串。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-06-20T16:20:44.653

不，您使所有（几乎所有）都正确。你必须：

*   删除周围的空格`=`
*   使用`$()`或反引号代替`()`

那将是正确的：

```
 nozero=$(echo $machinenumber | sed 's/^0*//') 
```

此外，您必须使用没有`()`围绕它们的变量。您可以`""`根据需要添加：

```
iptables -t nat -I POSTROUTING -s "10.$machinetype.$nozero.0/24" -j MASQUERADE 
```

当然，这里的变量不是必需的。你可以简单地说：

```
iptables -t nat -I POSTROUTING -s "10.$(echo $machinenumber | sed 's/^0*//').$nozero.0/24" -j MASQUERADE 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2012-06-20T18:17:00.697

你也可以

```
machinenumber=$(expr $machinenumber + 0) 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2013-08-21T15:33:49.727

我无法发表评论，因为我没有足够的声誉，但我建议你接受[丹尼斯的回答](https://stackoverflow.com/a/11130324/1014396)（这真的很整洁）

首先，我认为您的答案不是有效的 bash。在我的安装中，我得到：

```
> machinetype=74
> machinenumber=05
> iptables -t nat -I POSTROUTING -s 10.($machinetype).($machinenumber + 0).0/24 -j MASQUERADE
-bash: syntax error near unexpected token `('
> echo 10.($machinetype).($machinenumber + 0).0/24
-bash: syntax error near unexpected token `(' 
```

如果我引用它，我会得到：

```
> echo "($machinetype).($machinenumber + 0)"
(74).(05 + 0) 
```

我假设你的意思是：

```
> echo 10.$(($machinetype)).$(($machinenumber + 0)).0/24
10.74.5.0/24 
```

但是，由于八进制，它当然仍然是一个糟糕的解决方案：

```
> machinenumber=09
> echo 10.$(($machinetype)).$(($machinenumber + 0)).0/24
-bash: 09: value too great for base (error token is "09") 
```

我假设您的号码目前不是 08 或 09。

这是丹尼斯的：

```
> echo $((10#09))
9
> echo $((10#00))
0
> echo $((10#00005))
5
> echo $((10#))
0 
```

诚然，最后一个可能是某人的输入验证问题。

sed解决方案存在的问题：

```
> echo "0" | sed 's/^0*//'

> 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-06-20T16:20:23.763

```
nozero=$(echo $machinenumber | sed 's/^0*//') 
```

尝试在周围没有空格`=`并使用附加`$`标志。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-10-23T18:05:03.173

一个纯粹的 bash 解决方案：

```
> N=0001023450 
> [[ $N =~ "0*(.*)" ]] && N=${BASH_REMATCH[1]}
> echo $N 
1023450 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2015-08-07T00:17:02.387

使用 sed：

```
echo 000498 | sed "s/^0*\([1-9]\)/\1/;s/^0*$/0/"
498
echo 000 | sed "s/^0*\([1-9]\)/\1/;s/^0*$/0/"
0 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-04-06T14:47:08.683

我通过使用来做到这一点

```
awk '{print $1 + 0}' 
```

我比 sed 方法更喜欢这种方法，因为它仍然适用于 0、000 和 001 等数字。

所以在你的例子中我会替换

```
nozero=$(echo $machinenumber | sed 's/^0*//') 
```

和

```
nozero=$(echo $machinenumber | awk '{print $1 + 0}' ) 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-02-11T12:34:29.233

我还不能评论或投票，但 Duncan Irvine 的回答是最好的。

我想添加一个关于可移植性的说明。`$((10#0009))`语法不可移植。它适用于 bash 和 ksh，但不适用于 dash：

```
$ echo $((10#09))
dash: 1: arithmetic expression: expecting EOF: "10#09"

$ dpkg -s dash | grep -i version
Version: 0.5.7-2ubuntu2 
```

如果可移植性对您很重要，请使用 sed 答案。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-09-10T05:30:03.720

如果您使用的是 bash，这看起来是最简单的：

```
nozero=$(bc<<<$machinenumber) 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-08-21T23:57:48.103

我会说你非常接近。我没有看到对 bash 的要求，但是您的非零逻辑有缺陷。

```
nonzero=`echo $machinenumber + 0 | bc`
iptables -t nat -I POSTROUTING -s 10.$machinetype.$nozero.0/24 -j MASQUERADE 
```

添加 0 是将字符串数字更改为非填充整数的常用方法。bc 是一个基本的计算器。我一直使用这种方法从数字中删除空格和零填充。

虽然我不是 iptables 语法方面的专家，但我很确定括号不是必需的。由于我已经有与这两个变量接壤的非单词字符，因此我不需要在它们周围使用特殊的外壳。单词字符是；

```
[a-zA-z0-9_] 
```

使用此解决方案，您不会丢失零作为潜在值，并且应该可以跨所有 shell 移植。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-10-25T20:23:05.220

添加数字与 0，它将删除前导零

```
eg: expr 00010 + 0 #becomes 10 
```

或者

```
num=00076
num=${num##+(0)}
echo $num 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-02-22T13:58:27.033

前几天我不得不重新访问这段代码，因为一些不相关的东西，并且由于与其他一些读取相同脚本的软件的兼容性，我发现将它重写成这个很容易，它应该仍然是有效的 bash：

`iptables -t nat -I POSTROUTING -s 10.($machinetype).($machinenumber + 0).0/24 -j MASQUERADE`

基本上，添加 0 会强制将其解释为整数，因此会自动去除前导零

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-12-30T13:01:58.383

如果您没有 sed 或 awk 或 perl，那么您可以使用**cut**和**grep**

```
mn="$machinenumber"
while echo "$mn"|grep -q '^0';do mn=$(echo "$mn"|cut -c2-);done
iptables -t nat -I POSTROUTING -s 10.($machinetype).($mn).0/24 -j MASQUERADE 
```

适用于 bash 和 dash shell。

# java - Java 是否有控制台分析器？

> ID：11123727
> 
> 赞同：16
> 
> 时间：2012-06-20T16:13:20.957
> 
> 标签：java, linux, terminal, console, profiling

是否有可以从 Linux 终端运行的类似 gprof 的 Java 分析器？我发现的所有工具都是 GUI 程序，我需要从终端运行它。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-20T16:24:01.443

[JVM 有一个名为HPROF](http://java.sun.com/developer/technicalArticles/Programming/HPROF.html)的内置分析器。您可以像这样在命令行上启用它：

```
java -agentlib:hprof=file=hprof.txt,cpu=samples MyClass 
```

这将在程序完成时将配置文件信息转储到文本文件中。除了分析 CPU 使用情况，它还可以跟踪堆使用情况。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-08-20T20:34:03.810

开源工具[jvmtop](https://github.com/patric-r/jvmtop/)包含一个终端分析器，可能值得一看：

```
JvmTop 0.7.0 alpha - 15:16:34,  amd64,  8 cpus, Linux 2.6.32-27, load avg 0.41
 http://code.google.com/p/jvmtop

 Profiling PID 24015: org.apache.catalina.startup.Bootstrap

  36.16% (    57.57s) hudson.model.AbstractBuild.calcChangeSet()
  30.36% (    48.33s) hudson.scm.SubversionChangeLogParser.parse()
   7.14% (    11.37s) org.kohsuke.stapler.jelly.JellyClassTearOff.parseScript()
   6.25% (     9.95s) net.sf.json.JSONObject.write()
   3.13% (     4.98s) ....kohsuke.stapler.jelly.CustomTagLibrary.loadJellyScri() 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-22T12:51:56.300

JXInsight/OpenCore 具有术语/shell 报告插件（顶部、队列、堆栈等），它们将定期输出其计量和度量数据。还可以使用 Open API 访问此信息，该 API 允许在 JVM 中实时检查模型或使用快照文件句柄离线检查。两者都通过插件 API 得到支持，它是如何工作的。

[http://www.jinspired.com/products/opencore](http://www.jinspired.com/products/opencore)（商业）

是否存在不能使用 GUI 的技术原因？它只是由工作流程习惯驱动的偏好吗？如果没有，那么您可以随时试用我们的免费 JXInsight/Opus Java 版——一种高效且可扩展的代码级延迟性能测量解决方案，用于快速识别 Java 和 JRuby 应用程序中的热点。

[http://www.jinspired.com/products/opus](http://www.jinspired.com/products/opus)

注意：我是这两个产品的产品架构师。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-20T16:17:40.360

我为此使用 jconsole。[http://docs.oracle.com/javase/6/docs/technotes/tools/share/jconsole.html](http://docs.oracle.com/javase/6/docs/technotes/tools/share/jconsole.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-20T16:19:09.837

如果您希望将其用于分析和监控。您可以使用[Jvisualvm](http://docs.oracle.com/javase/6/docs/technotes/tools/share/jvisualvm.html)。

来自应用网站：

**描述** Java VisualVM 是一个直观的图形用户界面，可在基于 Java 技术的应用程序（Java 应用程序）在给定的 Java 虚拟机 (JVM*) 上运行时提供有关它们的详细信息。Java VisualVM 的名称来源于 Java VisualVM 以可视方式提供有关 JVM 软件的信息这一事实。

Java VisualVM 将多个监控、故障排除和分析实用程序组合到一个工具中。例如，独立工具 jmap、jinfo、jstat 和 jstack 提供的大部分功能都已集成到 Java VisualVM 中。其他功能，例如 JConsole 工具提供的一些功能，可以作为可选插件添加。

**编辑：** 因为您想要终端方法。请参阅此链接[Triggering a Javadump](http://publib.boulder.ibm.com/infocenter/javasdk/v5r0/index.jsp?topic=/com.ibm.java.doc.diagnostics.50/diag/tools/javadump_trigger.html)。它描述了 java 转储的创建。

# oracle-apex - 将公开报告设为默认值

> ID：11123728
> 
> 赞同：1
> 
> 时间：2012-06-20T16:13:27.243
> 
> 标签：oracle-apex

使用 Apex 版本 4.1.1.00.23。

保存报告并选择操作、保存报告时，结果窗口有一个“公共”复选框以使报告为公共。是否可以选中 Public 复选框（导致 Public 成为默认选项）？

我读到，不能选择只拥有公共报告而没有私人报告。这是真的？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T11:55:13.430

仅仅因为保存的设置方式，就不可能有没有私人报告的公共报告。如果你要影响它，那么是的，这是可能的。

您不能轻易影响“公共”复选框。原因是当您从操作列表中选择一个选项时弹出的 html 区域（例如本例中的“保存”）是通过 ajax 调用检索的。这种方式甚至不可能使用一些 javascript/jquery 来影响这一点，因为只要没有选择该选项，该项目就不存在。

如果你真的想影响它，只有一个选择：研究 ajax 调用并重现它们。例如，我一直在为过滤器执行此操作。您需要查看 ir javascript 文件，该文件位于`/i/javascript/apex_interactive_reports_4_1.js`

首先，您需要一个钩子来成功回调 IR ajax。然而，没有框架事件。我所做的是“覆盖” `gReport._Finished_Loading`：检查执行的操作，触发原始代码，然后挂钩我自己的函数。一旦到了那里，您就可以影响发生的事情：隐藏复选框，始终选中它，添加项目或更改一些。例如，始终选中复选框并将其隐藏，您将始终生成公共报告。

您还可以研究保存报告 ajax 调用，并模仿这种行为，使用您自己的小接口来提供参数。

# asp.net-web-api - ASP .Net 4 Web Api RC + Autofac 手动解析

> ID：11123732
> 
> 赞同：3
> 
> 时间：2012-06-20T16:13:51.917
> 
> 标签：asp.net-web-api, autofac, asp.net-mvc

我正在尝试在 Web Api 方法中使用依赖解析器。这可以正常工作，并且可以与带有 DepedencyResolver.GetService() 的经典 ASP.NET MVC 一起正常工作

但我不能让它在 WepApi 方法中工作。

我的注册将所有实例注册为 InstancePerApiRequest ，如果我在 WebAPiConroller 的构造函数上添加我在引导程序中注册的所有类型中的任何一种，则在内部调用它们时注入正常，但不再注入。

就像我说的获取方法中的这样

```
var userRepository = (IUserRepositoryu)GlobalConfiguration
       .Configuration.DependencyResolver.GetService(typeof(IUserRepository)); 
```

我得到了 no scope WebRequest 错误。奇怪的是，在将其全部更改为 GlobalConfiguration 之前，它在 Beta 中运行良好。

**所以我的问题是，如何像以前一样在我的 webAPI 的生命周期范围内激活我的 Autofac 注册程序集**？

我的错误：

“从请求实例的范围中看不到带有与‘AutofacWebRequest’匹配的标记的范围。这通常表明注册为每个 HTTP 请求的组件正在被 SingleInstance() 组件（或类似场景）请求。）在 Web 集成下，始终从 DependencyResolver.Current 或 ILifetimeScopeProvider.RequestLifetime 请求依赖项，而不是从容器本身请求依赖项。”

```
 var resolver = new AutofacWebApiDependencyResolver(container);
 configuration.DependencyResolver = resolver; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-22T06:29:19.560

在 Web API 中，全局依赖解析器用于访问全局实例。每个请求的服务来自 Web API 为处理请求而创建的依赖范围。我不确定 Web API 中是否有任何方法可以访问当前的依赖范围 - 知道会很有趣。

这里最好的选择是只使用依赖注入而不是像这样直接调用解析器。您的代码的哪一部分需要进行此调用？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T18:07:17.097

AutoFac 已与 ASP.NET WebAPI 集成考虑使用它。

此外，WebAPi 的依赖解析器与 ASP.NET MVC 略有不同，因此请确保您已经实现了适用于 WebAPI 的解析器并将其添加到 WebAPI 配置中。

[http://www.asp.net/web-api/overview/extensibility/using-the-web-api-dependency-resolver](http://www.asp.net/web-api/overview/extensibility/using-the-web-api-dependency-resolver)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-05T11:02:21.563

如错误所示，您必须始终从 DependencyResolver.Current 或 ILifetimeScopeProvider.RequestLifetime 请求依赖项。正确的方法是从当前的 web api 请求中获取依赖：</p>

```
// Get the request lifetime scope so you can resolve services.
var requestScope = Request.GetDependencyScope();
// Resolve the service you want to use.
var userRepository = requestScope.GetService(typeof(IUserRepository)) as IUserRepository; 
```

从 Autofac 官方文档中查看更多信息：http: [//docs.autofac.org/en/latest/integration/webapi.html#standard-web-api-filter-attributes-are-singletons](http://docs.autofac.org/en/latest/integration/webapi.html#standard-web-api-filter-attributes-are-singletons)

# git - 似乎在日志中丢失了 git 提交，reflog 仍然显示提交

> ID：11123733
> 
> 赞同：0
> 
> 时间：2012-06-20T16:13:53.873
> 
> 标签：git

我有一个只有本地的 git 项目，并且只有一个 master 分支。昨天我做了一些提交。今天我做了一个承诺。提交看起来不错——这是现有文件和一些新文件的差异。

但是，当我在 gitx 中查看我的 master 分支时，它只显示了今天的提交，并且看起来就像我通过这一次提交从头开始提交了所有文件。

Git 日志显示了同样的内容，但 git reflog 显示了我之前的所有提交：

```
$ git log
 commit bd7d6af7f916706c5df6d57bed883d2c2d81f60f
 Author: Sam Fen
 Date:   Wed Jun 20 12:00:38 2012 -0400

  Add Genotype class, update naming

$ git reflog
 bd7d6af HEAD@{0}: checkout: moving from master to master
 bd7d6af HEAD@{1}: commit: Add Genotype class, update naming
 bf0d3dd HEAD@{2}: commit: Add start to genetics manipulation library
 2335bf2 HEAD@{3}: commit: Convert to CoffeeScript
 4c26713 HEAD@{4}: commit: Initial commit with basic structure, trivial Jasmine t 
```

reflog 显示了似乎是一个奇怪的双重提交，最后一个具有相同的哈希 (bd7d6af)，但我认为这只是因为在 gitx 中看到空的历史记录后，我回到命令行并输入了 'git checkout主人'只是为了确保我在主人（我是）。

关于可能发生的事情以及如何恢复我的历史的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T16:22:30.543

看起来 bd7d6af 认为这是一个初始提交

您可以尝试`git reset bf0d3dd; git add -A; git commit`查看是否获得了正确的提交。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T16:39:08.610

如果`bf0d3dd`是您昨天所做的最后一次提交，您可以：

```
git checkout master
git rebase --onto bf0d3dd master 
```

这将获取您当前的提交并重写它，`bf0d3dd`使其成为其父级，从而有效地将您的主分支重新附加到历史记录。

不知道它是如何进入这种状态的——它有几种不同的方式，但我们必须更多地了解你经历过的确切事件。

# android - C2DM 源代码在哪里？

> ID：11123738
> 
> 赞同：1
> 
> 时间：2012-06-20T16:14:06.900
> 
> 标签：android, open-source, push, real-time, android-c2dm

**有人知道 C2DM 源代码是否开放吗？如果是这样，它位于哪里？**

*需要明确的是，我对连接到 C2DM 的任何客户端代码不感兴趣，对任何将通知推送到 C2DM 的服务器代码也不感兴趣。我实际上对**C2DM 服务本身的来源**（在云中运行的服务，它处理客户端和应用程序服务器之间的协调/注册）感兴趣。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T16:18:29.837

C2DM 是封闭源代码，但是如果您想构建推送服务，请考虑使用 XMPP。使用 OpenFire XMPP Server 和 aSmack 来实现推送通知。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T16:16:42.630

它不是开源的 AFAIK，就像大多数 Google 服务不是开源的 AFAIK 一样。

# ruby-on-rails - 在 Rails 中建立多对多关联的正确方法是什么

> ID：11123742
> 
> 赞同：0
> 
> 时间：2012-06-20T16:14:21.750
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, ruby-on-rails-3.1

所以我的应用中有三个模型，一个用户模型、一个评论模型和一个电影模型。一个用户可以评论许多电影（每部电影一个），一个电影可以有许多用户的许多评论。他们的联系是评论。

我在做以下设置吗？

```
class Movie < ActiveRecord::Base
  has_many :reviews, :through => :users

end

class Review < ActiveRecord::Base
  belongs_to :user
  belongs_to :project
end

class User < ActiveRecord::Base
  has_many :reviews, :through => :movies

end 
```

我希望我可以做类似的事情：

`User.reviews`（这会让我返回用户的评论和评论相关的电影的相应 ID）

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:21:17.250

我相信这是你应该采取的方法

```
class User < ActiveRecord::Base
  has_many :reviews
  has_many :movies, :through => :reviews
end

class Review < ActiveRecord::Base
  belongs_to :user
  belongs_to :movie
end

class Movie < ActiveRecord::Base
  has_many :reviews
  has_many :users, :through => :reviews
end 
```

您还希望验证模型中的唯一性`Review`和/或在连接表上强制执行唯一性以仅允许每部电影单个用户。如果您也想将此 UQ 约束带入架构，这取决于您（DHH 说“是”，我说“愚蠢的持久性”是“不，不”......）

`User.reviews`将为您提供“连接记录”，即按照“`<Review user_id=x, movie_id=y>` 当然，您在连接表上会有更多与评论相关的列，例如`:summary, :content`等。从评论中访问电影很容易，即`Movie.find_by_id(User.reviews.last.movie_id).title`

# objective-c - 在 iPad 上输入非英文键盘时出错

> ID：11123744
> 
> 赞同：1
> 
> 时间：2012-06-20T16:14:30.423
> 
> 标签：objective-c, ios, xcode, ipad

我正在为 iPad 开发一个应用程序，当我使用俄语布局的键盘输入搜索栏时，它会不断在日志中写入错误（但工作正常）。搜索栏是标准的。

错误看起来像这样（“/tmp.”之后的字母组合根据按下的键而变化：

```
Mapping '/var/mobile/Library/Caches/com.apple.keyboards/images/tmp.B943Tm5q' failed: 'Invalid argument' (22) 
```

不过，应用程序运行良好，但这些错误很烦人，我不需要日志中的那么多垃圾。

这些错误是什么，我该如何解决？我试过谷歌搜索。很多。但答案甚至不接近我正在寻找的东西。

UPD：错误不仅在键入时显示，而且在任何键盘状态更改时都会显示：当它出现时，当我切换语言时，当我按下任何按钮（甚至是 shift）时。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T16:51:40.033

这是一个操作系统问题。您应该在[http://bugreporter.apple.com](http://bugreporter.apple.com)上报告它。不过，在您的应用程序中您无能为力，所以不要浪费时间担心它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T16:53:14.463

是的，因为您混合了 iOS 版本/版本。我相信。

# jquery - 如何使用jquery检查选择元素是否仍然“打开”/处于活动状态

> ID：11123746
> 
> 赞同：6
> 
> 时间：2012-06-20T16:14:32.007
> 
> 标签：jquery, forms

无论如何，如果选择表单元素目前处于活动状态，我是否可以通过 jQuery 检测到？

我创建了这个小提琴来演示这个问题：

[http://jsfiddle.net/E2PhT/2/](http://jsfiddle.net/E2PhT/2/)

当您将鼠标悬停在“搜索”链接上时，将显示搜索表单。当您现在单击选择字段以打开其中的选项，然后不选择任何内容，将表单留在右侧（将鼠标移过灰色块的右边缘），选择字段保持打开状态，而所有内容eles 消失（应该如此）。

现在我想让选择元素再次处于非活动状态，这样它就不会保持打开状态，或者只要选择元素仍然打开，它就不会阻止表单的其余部分消失。

因此，无论哪种方式，我都必须以某种方式检测选择字段是否仍然打开或处于活动状态。有没有办法用 jQuery 检查这个状态？

谢谢帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T16:17:25.763

您可以尝试`:focus`选择器：

```
if (!$("select").is(":focus")) {
    // ...
} 
```

**演示：http:** [//jsfiddle.net/E2PhT/3/](http://jsfiddle.net/E2PhT/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T16:24:09.743

您可以像这样使用全局布尔变量：

```
var isFocused;
$(document).ready(function(){
    $('select').focus(function(){
        isFocused = true;
    }).blur(function(){
        isFocused = false;
    });
}); 
```

# ruby-on-rails - Rails 3 rails3-jquery-autocomplete 搜索几个字段

> ID：11123749
> 
> 赞同：0
> 
> 时间：2012-06-20T16:14:45.673
> 
> 标签：ruby-on-rails, ruby-on-rails-3, autocomplete, named-scope

我正在使用**rails3-jquery-autocomplete**插件。

我想按几个属性进行搜索，例如**title**和**app_number**。

我尝试了什么：

在模型中：

```
class Eclaim < ActiveRecord::Base
  scope :search_by_number, ->(query){ 
      (query ? where(["app_number LIKE ?", '%'+ query + '%']) : {})
  }
end 
```

在控制器中：

```
class ClaimsController < ApplicationController
   autocomplete :eclaim, :title,  :extra_data => [:app_number], :scopes => [:search_by_number]
end 
```

但是当我使用自动完成字段时，我收到错误：

```
ArgumentError (wrong number of arguments (0 for 1)):
  app/models/eclaim.rb:16:in `block in <class:Eclaim>' 
```

看起来插件没有分配**查询**变量。

谁能帮我？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T16:41:35.820

希望这会有所帮助： [Rails gem rails3-jquery-autocomplete：如何查询多个字段](https://stackoverflow.com/questions/3866391/rails-gem-rails3-jquery-autocomplete-how-do-i-query-multiple-fields)

该错误意味着`Eclaim.search_by_number()`在没有任何参数的情况下调用。确实比较好奇。让我知道上面的链接是否可以帮助您解决此问题。

请注意，`:extra_data`仅设置您希望通过 JSON 响应在自动完成器结果中返回的额外属性。

**更新**：在你的控制器中试试这个，调整`:term`

```
def get_autocomplete_items(parameters)
   super(parameters)
   items = Eclaim.search_by_number(params[:term])
end 
```

# ios - xcode LLMV 3.1 编译器数组问题

> ID：11123752
> 
> 赞同：3
> 
> 时间：2012-06-20T16:15:06.167
> 
> 标签：ios, xcode, compiler-construction

我在 Apple LLVM 编译器 3.1 上遇到了以下问题：

```
int numIndex = 0;
int *indices = (int *)malloc(3 * sizeof(int));
indices[numIndex] = numIndex++;
indices[numIndex] = numIndex++;
indices[numIndex] = numIndex++;
for (int i = 0; i < 3; i++) {
    NSLog(@"%d", indices[i]);
} 
```

输出：1 0 1

和

```
int numIndex = 0;
int indices[3];
indices[numIndex] = numIndex++;
indices[numIndex] = numIndex++;
indices[numIndex] = numIndex++;
for (int i = 0; i < 3; i++) {
    NSLog(@"%d", indices[i]);
} 
```

输出：0 0 1

我期待 0 1 2 作为输出。使用 LLVM GCC 4.2 的相同代码会产生正确的输出。是否有任何我遗漏的优化标志或我误解的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T16:21:57.700

所以看起来行为如下

```
int numIndex = 0;
int indices[3];
indices[numIndex] = numIndex++; 
```

这里首先计算右侧，返回 0，并将 numIndex 递增 1，然后计算右侧，因此 indices[1] 得到 0

```
indices[numIndex] = numIndex++; 
```

这里首先计算右侧，返回 1，然后将 numIndex 递增 1，然后计算右侧，因此 indices[2] 得到 1

```
indices[numIndex] = numIndex++; 
```

这里首先评估右侧，返回 2，然后将 numIndex 递增 1，然后评估右侧，因此 indices[3] 得到 2（实际上你超出了界限）

请注意，您从未真正分配过索引 [0]，因此它可以是任何东西（在我的测试中，它是最大 int 数）

编辑-从评论看来，这是行为实际上是未定义的，所以即使我观察到这一点，它也不是一个明确的答案

# ios - GLSL 边框着色器

> ID：11123753
> 
> 赞同：3
> 
> 时间：2012-06-20T16:15:09.257
> 
> 标签：ios, glsl, opengl-es-2.0, shader

我正在尝试编写一个着色器来为文本添加边框。它编译并运行正常，但边框呈颗粒状且有锯齿。有什么建议可以让它变得更好吗？

![着色器](../Images/9f2b6b6a5c7d933774bfc77bc749e908.png)

这是**我编写的第一个着色器，**所以对 API 了解不多。可以评论任何示例代码吗？我不想只是复制和粘贴答案；我想了解它。

此外，当我缩小文本时，我遇到了一个问题，这张图片可以很好地解释这一点。请问有什么解决这个问题的建议吗？

![着色器](../Images/c2a68bf0d7b3126b8779e8c31a361802.png)

边缘检测也可以更好。到目前为止，我利用了我用于输入的抗锯齿纹理具有边缘的事实`0.0 < alpha < 1.0`

到目前为止，我有这个：

```
#ifdef GL_ES
precision mediump float;
#endif
varying vec2 v_texCoord;
uniform sampler2D u_texture;
uniform vec4 u_borderColor;
uniform float u_width;
uniform float u_height;

void main()
{
    mediump vec4 total = vec4(0.0);

    float alpha = texture2D(u_texture, v_texCoord).a; 
    //If somewhere between complete transparent and completely opaque
    if (alpha > 0.0 && alpha < 1.0)
    {
        total.rgb = u_borderColor.rgb;
        total.a *= u_borderColor.a;
        gl_FragColor = u_borderColor;
    }
    else
    {
        gl_FragColor = texture2D(u_texture, v_texCoord);
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T18:34:42.707

为什么不将 gl_FragColor 的值设置为总计？Alpha 不再正确维护....

接下来，total.a = 1 - alpha；（从外到内）

或类似的变体：

total.a = abs(0.5 - alpha); （两边混合）

混合时可能更有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T01:08:25.183

在代码中，我看到如果 alpha`gl_FragColor = u_borderColor`是. 首先将您的总数更改为其他一些对比色，然后您的代码适用于图像。但是文本有不同的弯曲，这使得它变得颗粒状，所以需要改变它的渲染，没有代码就不能说。如果我错了请建议谢谢`(0,0,0,0)``>0 <1`

# rubygems - 系统级与应用级包分发

> ID：11123760
> 
> 赞同：2
> 
> 时间：2012-06-20T16:15:33.640
> 
> 标签：rubygems, package, packaging, easy-install, software-distribution

如果我创建了一个 FOSS 命令行实用程序（即*应用程序*而不是*库*）并且我想将它作为一个包分发以方便安装，**那么通过以下方式执行此操作是否更好**：

*   [应用程序级别的包管理](http://en.wikipedia.org/wiki/List_of_software_package_management_systems#Application-level_package_managers)（例如 RubyGems，如果它是用 Ruby 编写的；EasyInstall 如果是 Python 等），或者
*   [系统级包管理](http://en.wikipedia.org/wiki/Package_management_system#Application-level_package_managers)（例如 Mac 的 MacPorts、Debian 的 Debian 包等）。

*注意。如果您认为没有普遍正确的做法，而是认为在特定情况下一种或另一种方法显然是最好的，那么这些情况是什么？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T19:34:26.730

根据[这篇博](http://workaround.org/easy-install-debian)文，你应该这样做的主要原因

> **切勿**在 Debian 系统上使用 setuptools/ez_setup 在系统范围内安装 Python 模块

是

1.  您可以在不同的安装路径中拥有相同 Python 模块的不同版本（通过`easy_install`和安装`aptitude`）

2.  没有`easy_uninstall`。（但是，`pip`似乎能够做到这一点：[如何删除使用 Python 的 easy_install 安装的软件包？](https://stackoverflow.com/questions/1231688/how-do-i-remove-packages-installed-with-pythons-easy-install)）

这同样适用于 CLI 工具，它也是某种（Python）模块。

当然，`easy_install`与所有系统包管理器的打包相比，打包所需的工作更少。但是，您为什么不打包您的工具，`easy_install`并向熟悉针对特定目标打包的人寻求帮助呢？`submit@bugs.debian.org`（对于 Debian，您可以尝试发送主题以“[needs-packaging]”开头的电子邮件。）

让我仅从我作为用户的有限经验——Python 和 Debian/Ubuntu 来说明。当我最终从 Windows 切换到 Ubuntu 时，主要原因之一是可以轻松安装几乎所有*为 Debian 打包的*软件。第一个过渡时期的问题之一是：

“最近的多路diff工具是什么？好的，有融合和扩散。让我们看看……”

```
sudo apt-get install meld diffuse 
```

“好的。这个剪贴板管理器叫做 Parcellite？”

```
sudo apt-get install parcellite 
```

“我喜欢Task Coach。他们有吗？”

```
sudo apt-get install taskcoach 
```

“现在为什么`svn`不安装开箱？”

```
sudo apt-get install svn
... (some error)
apt-file search svn
... (tl;dr)
apt-file search svn | grep /svn$
sudo apt-get install subversion 
```

如此多的方便包装。请注意，至少提到的前两个工具是纯 Python 工具，但*我不在乎*——**系统包管理**器为我做了一切。如果这是唯一的选择，也许我什至会使用它来安装它们`easy_install`，但是我本可以意识到使用`easy_install`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T05:22:01.707

在我看来，对于用户对其分发方式感到满意的应用程序而言，所遵循的程序大致如下：

![在此处输入图像描述](../Images/737c32d6e449da2ca052cf700ea05338.png)

举个例子：

*   **Bundler**：用 Ruby 编写，对 Ruby 开发人员有用；通过应用程序级包分发。
*   **fwknop**：用 Perl 编写（至少最初是），对最终用户有用；通过系统级包/安装程序分发。
*   **Pandoc**：用 Haskell 编写，可能对 Haskell 开发人员在开发 Haskell 应用程序的过程中有用，但对其他人*也有用；*[通过应用程序级和系统级](http://johnmacfarlane.net/pandoc/installing.html)*包* 分发。

可能有比这些更好的例子。此外，到目前为止，我的结论只是观察性结论：我还​​没有找到明确列出此决策流程的参考资料。因此，我欢迎更全面的答案。

*注意。流程图的代码是[在线](https://gist.github.com/3015915#file_packaging_flowchart.tex)的，以防您想根据自己的答案对其进行调整。为了能够使用它，你需要一个工作的 LaTeX 安装。*

# python - 2个python列表之间的相关性

> ID：11123762
> 
> 赞同：0
> 
> 时间：2012-06-20T16:15:41.237
> 
> 标签：python, time, statistics, correlation

我想关联 2 个这样的列表：

```
a=[1337687805.49052, 1337687808.560519, 1337687813.06552, 1337687814.602522,
   1337687817.16352, 1337687823.836521, 1337687831.942522, 1337687837.931519, 
   1337687839.760519, 1337694258.54652, 1337709019.39452, 1337712024.05452, 
   1337714200.05952, 1337714903.08152, 1337721205.97952, 1337721207.05052, 
   1337723273.93052]

b=[1337687803.533521, 1337688287.44452, 1337689866.760521, 1337689866.76352,
   1337690758.328521, 1337691231.61552, 1337691261.578519, 1337691261.68752,
   1337691362.20652, 1337691362.51652, 1337691366.431521, 1337691369.55252,
   1337691369.992521, 1337691387.000521, 1337691391.50552, 1337691406.192519, 
   1337691407.79952, 1337691411.74352, 1337691420.308521, 1337691422.035521, 
   1337691426.60752, 1337691426.753521, 1337691431.44952, 1337691437.87152, 
   1337691438.66452, 1337691448.45452, 1337691450.15852, 1337691451.49252, 
   1337691454.335519, 1337691459.87152, 1337691461.01652, 1337691480.819519, 
   1337691482.980521, 1337691484.914522, 1337691500.15652, 1337691514.32752] 
```

a 和 b 包含一些事件的纪元时间，所以我需要 a 和 b 之间的相关性，做一些有意义的图表，也许相关系数也很有用。目标是比较许多具有不同时间戳的向量 a,b,c,d,...，以了解它们是否具有相似的行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:19:58.897

我觉得你应该考虑[`scipy.spatial.distance`](http://docs.scipy.org/doc/scipy/reference/spatial.distance.html)。

您可以使用`scipy.spatial.distance.euclidean()`或获得相关性[`scipy.spatial.distance.correlation()`](http://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.correlation.html?highlight=correlation#scipy.spatial.distance.correlation)

[http://docs.scipy.org/doc/scipy/reference/search.html?q=correlation&check_keywords=yes&area=default](http://docs.scipy.org/doc/scipy/reference/search.html?q=correlation&check_keywords=yes&area=default)

# makefile - Makefile:4: *** 缺少分隔符

> ID：11123765
> 
> 赞同：5
> 
> 时间：2012-06-20T16:15:52.853
> 
> 标签：makefile

> **可能重复：**
> [出错：缺少分隔符](https://stackoverflow.com/questions/920413/make-error-missing-separator)

这个愚蠢的错误让我感到压力很大......

这是[文件](https://docs.google.com/open?id=0B0GDyEdUryzERkY1VncwdkpmQXc)...

我花了一个小时试图找出它有什么问题......我是一个 VIM 用户。有人能指出为什么吗？我用标签！

谢谢。

```
all: hello

hello:  hello_world.c   
    gcc -Wall -o hello.exe hello_world.c 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-20T16:23:39.463

具有 gcc 命令的行应该以制表符开头，并且您似乎正在使用扩展制表符（空格而不是制表符）。尝试`set noexpandtab`在`vim`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-20T16:23:50.010

这就是你所拥有的：

```
all: hello

hello:  hello_world.c   
    gcc -Wall -o hello.exe hello_world.c 
```

`gcc`命令之前的空格必须是 a `Tab`，不是一个空格，不是两个空格，不是 3 个空格等等，而是一个，并且正好是一个制表符

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T16:25:21.313

不，你没有！

我已经下载了你的文件——里面有四个空格，不是制表符。你可以`:set list`在vim中运行自己查看。

请删除空格并用制表符代替它（按 ctrl-v ctrl-i）。

将来您可以添加

```
 # vim:noet 
```

到文件。您的默认设置将被`set noexpandtab`文件的设置覆盖。

# php - MySQL没有获取正确的数据？(PHP)

> ID：11123766
> 
> 赞同：6
> 
> 时间：2012-06-20T16:15:53.873
> 
> 标签：php, mysql

这很简单。编辑：更新了问题并添加了第四个回声。

这是PHP代码：

```
<?php

$ratings="3";
$item="Inception";

$query="SELECT * FROM items WHERE item = '". $item ."' LIMIT 1";

echo $query;

echo "<br />";

$result=mysql_query($query);

echo $result;

echo "<br />";

while ($row = mysql_fetch_array($result)) { 
    $item_id = $row['item_id'];
    echo $item_id;
    echo "<br />";
 }  

  $query_two = "INSERT INTO ratings (rating, item_id), VALUES (' {$ratings} ', ' {$item_id} ')";

  echo $query_two;
  $sql = mysql_query($query_two);
  mysql_close();
?> 
```

这是带有所有回声的网络输出：

```
SELECT * FROM items WHERE item = 'Inception' LIMIT 1
Resource id #7

INSERT INTO ratings (rating, item_id), VALUES (' 3 ', ' ') 
```

为什么我的 $item_id 是空白的？（资源 ID 下方的第三行）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T16:18:20.127

这部分代码产生它：

```
$result=mysql_query($query);

echo $result; 
```

它显示是`Resource...`因为它是[资源](http://php.net/manual/en/language.types.resource.php)类型，它只是一种特殊的查询处理程序，它不像普通类型（例如字符串或 int），所以它没有可读的打印内容。

如果要从查询中打印数据，则必须首先获取它。

另请注意，这些`mysql_*`功能已被弃用，不鼓励使用它们。php手册中的注释：

> 不鼓励使用此扩展程序。相反，应该使用 MySQLi 或 PDO_MySQL 扩展。另请参阅 MySQL：选择 API 指南和相关的常见问题解答以获取更多信息。此功能的替代方案包括：
> 
> mysqli_query()
> 
> PDO::查询（）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-20T16:17:51.087

这与数据库中的 ID 没有任何关系。

这个 ( `Result#7`) 表示这个结果资源是由您的 php 脚本执行创建的第七个资源。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-20T16:20:44.460

还

```
$query_two = "INSERT INTO ratings (rating, item_id), VALUES (' {$ratings} ', ' {$item_id} ')"; 
```

应该

```
$query_two = "INSERT INTO ratings (rating, item_id) VALUES (' {$ratings} ', ' {$item_id} ')"; 
```

你前面有**逗号**`VALUES`。

此外，它似乎`$item_id`是空白的。请检查数据库是否有`item = 'Inception'`.

关于，`Result#7`请关注其他人的回答。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-20T16:19:01.877

资源 ID 来自 MySQL 查询的实际进程/对象。

返回您需要的结果：

```
$row = mysql_fetch_array( $query );

echo $row['item'] 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-20T16:19:40.193

您需要对结果资源做一些事情。试试这个：

```
$result=mysql_query($query);

//echo $result;

$result_array = mysql_fetch_assoc( $result );

print_r( $result_array ); 
```

**编辑：**我看到你更新了你的问题。

您应该`item='Inception'`直接在 MySQL 中运行查询以确认结果是您所期望的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-20T16:22:49.673

你不能这么简单地回显结果。您需要将结果获取到例如数组：

```
while ($row = mysql_fetch_array($query)) {
  echo $row['a_column'] . "<br />";
} 
```

或一个对象：

```
while ($variable = mysql_fetch_object($query) {
 $value = $variable->a_column;
}
echo $value; 
```

还有更多方法，但这只是两个例子

# java - 无法从 Android 中的 URL 读取 HTML 内容

> ID：11123768
> 
> 赞同：2
> 
> 时间：2012-06-20T16:15:59.410
> 
> 标签：java, android, url

我试图从 url 读取 HTML 内容。我尝试了来自许多站点的许多示例和代码示例，但它对我不起作用。当我运行代码时，它会在 textview 中保留默认文本。我什至也尝试过使用edittext。我什至在清单文件中添加了权限。

我使用的代码之一在这里：我在这里添加了完整的代码。我尝试使用下面的所有代码都没有成功。

```
 package com.adn;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;

import org.apache.http.HttpResponse;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;

import android.app.Activity;
import android.os.Bundle;
import android.widget.EditText;

public class REEActivity extends Activity {
    private static BufferedReader reader = null;

    /** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    EditText ed = (EditText) findViewById(R.id.editText1);

    try {
        ed.append(getStringFromUrl("http://www.google.com"));
        //getInputStreamFromUrl("").close();
    } catch (Exception e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
}

public static InputStream getInputStreamFromUrl(String url){
       InputStream contentStream = null;

       try{
         HttpClient httpclient = new DefaultHttpClient();
         HttpResponse response = httpclient.execute(new HttpGet(url));
         contentStream = response.getEntity().getContent();
       } catch(Exception e){
          e.printStackTrace();
       }
       System.out.println("Content stream is " + contentStream);
       return contentStream;
    }

public static String getStringFromUrl(String url) throws IOException{
    reader = new BufferedReader(new InputStreamReader(getInputStreamFromUrl(url)));

    StringBuilder sb = new StringBuilder();
    try{
    String line = null;
    while((line = reader.readLine()) != null)
    {
        sb.append(line);
    }    
    }catch (IOException e){
     e.printStackTrace();
    }
   getInputStreamFromUrl(url).close();
    return sb.toString();
}
} 
```

这是日志猫：

```
 06-20 21:25:18.022: E/AndroidRuntime(14095): FATAL EXCEPTION: main
06-20 21:25:18.022: E/AndroidRuntime(14095): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.adn/com.adn.REEActivity}: java.lang.NullPointerException
06-20 21:25:18.022: E/AndroidRuntime(14095):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)
06-20 21:25:18.022: E/AndroidRuntime(14095):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
06-20 21:25:18.022: E/AndroidRuntime(14095):    at android.app.ActivityThread.access$600(ActivityThread.java:123)
06-20 21:25:18.022: E/AndroidRuntime(14095):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
06-20 21:25:18.022: E/AndroidRuntime(14095):    at android.os.Handler.dispatchMessage(Handler.java:99)
06-20 21:25:18.022: E/AndroidRuntime(14095):    at android.os.Looper.loop(Looper.java:137)
06-20 21:25:18.022: E/AndroidRuntime(14095):    at android.app.ActivityThread.main(ActivityThread.java:4424)
06-20 21:25:18.022: E/AndroidRuntime(14095):    at java.lang.reflect.Method.invokeNative(Native Method)
06-20 21:25:18.022: E/AndroidRuntime(14095):    at java.lang.reflect.Method.invoke(Method.java:511)
06-20 21:25:18.022: E/AndroidRuntime(14095):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
06-20 21:25:18.022: E/AndroidRuntime(14095):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
06-20 21:25:18.022: E/AndroidRuntime(14095):    at dalvik.system.NativeStart.main(Native Method)
06-20 21:25:18.022: E/AndroidRuntime(14095): Caused by: java.lang.NullPointerException
06-20 21:25:18.022: E/AndroidRuntime(14095):    at java.io.Reader.<init>(Reader.java:64)
06-20 21:25:18.022: E/AndroidRuntime(14095):    at java.io.InputStreamReader.<init>(InputStreamReader.java:79)
06-20 21:25:18.022: E/AndroidRuntime(14095):    at com.adn.REEActivity.getStringFromUrl(REEActivity.java:49)
06-20 21:25:18.022: E/AndroidRuntime(14095):    at com.adn.REEActivity.onCreate(REEActivity.java:28)
06-20 21:25:18.022: E/AndroidRuntime(14095):    at android.app.Activity.performCreate(Activity.java:4465)
06-20 21:25:18.022: E/AndroidRuntime(14095):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
06-20 21:25:18.022: E/AndroidRuntime(14095):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
06-20 21:25:18.022: E/AndroidRuntime(14095):    ... 11 more 
```

这是清单文件

```
 <?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.adn"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="15" />
    <uses-permission android:name="android.permission.INTERNET"/>

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".REEActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

有人可以帮我解决这个问题。我也是安卓新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:28:35.373

代替

```
StringBuffer sb = new StringBuffer(); 
```

和

```
StringBuffer sb = new StringBuilder(); 
```

并使用 close() 方法关闭您的 InputStrem

尝试在第二种方法中使用此代码，希望这能解决问题

```
public static String getStringFromUrl(String url) throws UnsupportedEncodingException{
    BufferedReader br = new BufferedReader(new InputStreamReader(getInputStreamFromUrl(url)));

    StringBuilder sb = new StringBuilder();
    try{
    String line = null;
    while((line = reader.readLine()) != null)
    {
        sb.append(line);
    }    
    }catch (IOException e){
     e.printStackTrace();
    }
    getInputStreamFromUrl(url).close();
    return sb.toString();
} 
```

我尝试了您更新的代码，它现在可以工作了，这就是我得到的：

![在此处输入图像描述](../Images/1b2f4800edf95e1ed2700d676e0460a7.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T16:28:16.873

你能试试这个代码吗

```
public String getUrlContents(String url){
    String content = "";
    HttpClient hc = new DefaultHttpClient();
    HttpGet hGet = new HttpGet(url);
    ResponseHandler<String> rHand = new BasicResponseHandler();
    try {
        content = hc.execute(hGet,rHand);
    } catch (ClientProtocolException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }
    return content;
} 
```

# facebook - 喜欢和发送按钮在发布或发送时不显示图片

> ID：11123770
> 
> 赞同：-1
> 
> 时间：2012-06-20T16:16:02.670
> 
> 标签：facebook, facebook-like, facebook-opengraph, facebook-social-plugins

我已将发送喜欢和发送按钮添加到我正在处理的网站，但我仍然无法显示我想要分享（喜欢或发送）的产品图像。我添加了带有正确图像 url 的元标记。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T17:10:59.953

如果您要添加新的或更新现有的 og:meta 标签，您需要将 url 运行到 Facebook Linter @ [https://developers.facebook.com/tools/debug](https://developers.facebook.com/tools/debug)
这将强制 Facebook 抓取页面并更新信息页面上有。此更新只能由页面管理员完成，或者由 Facebook 大约每 24 小时自动完成一次

# java - 将字符串格式化为两位小数

> ID：11123771
> 
> 赞同：0
> 
> 时间：2012-06-20T16:16:06.037
> 
> 标签：java, string, formatting, currency

> **可能重复：**
> [如何在 Java 中将数字四舍五入到 n 位小数](https://stackoverflow.com/questions/153724/how-to-round-a-number-to-n-decimal-places-in-java)

我正在尝试将用作货币的字符串格式化为两位小数。例如，如果他们输入 100，它将被格式化为 100.00，如果他们输入 100.5，它将被格式化为 100.50。解决此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:26:05.990

您可以使用十进制格式：

```
new DecimalFormat("###0.00").format(...); 
```

DecimalFormat 的其他构造函数引入了对 Locale 的支持。

# .net - C# - 获取给定字符串输入的字节值

> ID：11123772
> 
> 赞同：0
> 
> 时间：2012-06-20T16:16:09.700
> 
> 标签：.net, visual-studio-2008, c#-3.0, bit

我正在研究一些采用十六进制字符串输入并生成该输入的二进制值的代码。一旦我有了二进制十六进制字符串的值，我就需要访问该字节的各个位。

我不能准确地说出我在做什么，但我可以这样说：十六进制字符表示某些硬件上给定寄存器选择的字节值 - 它为我们提供了十六进制字符串，因为它在完成运算后输出一些数字。

作为一个虚构的例子，输出值“A2”（10100010）将意味着寄存器（再次虚构）将具有以下值：

```
RegA  RegB  RegC  RegD
 101     0   001     0 
```

我需要访问返回的字节值中的 N 个位数。除了我在路上遇到了一个颠簸。

到目前为止，我已经尝试了以下方法：

```
string inputString = "F";
byte[] byteValues = new byte[inputString.Length * sizeof(char)];
System.Buffer.BlockCopy(inputString.ToCharArray(), 0, byteValues,
                        0, byteValues.Length);
return byteValues; 
```

但是，当给定输入字符串“F”时，此代码返回一个包含 4 个元素的字节数组。第一个元素的值为 70，其余的值为 0。这是大写 F 的 ASCII 键 - 不是我想要的。

我也试过：

```
int tempInt = Convert.ToInt32("F", 16);
byte[] value = BitConverter.GetBytes(tempInt); 
```

当给定输入字符串“F”时，此代码返回一个包含 4 个元素的字节数组。第一个元素的值为 15，其余的值为 0。这更像是它，但我现在需要访问字节数组的第一个元素中的各个位。

除了提供一种将十六进制字符输入的方法，打开它并返回一个具有该十六进制字符正确位值的 4 元素字节 [] 之外，是否有一种编程方式来获取单个位信息？

这就是我的意思：

```
public byte[] getByteValueForString (string inputString)
{
  /* is there a better way than this? */
  switch(inputString)
  {
     case "0":
       return new byte[] {0, 0, 0, 0};
     //....
     case "E":
       return new byte[] {1, 1, 1, 0};
     case "F":
       return new byte[] {1, 1, 1, 1};
  }
}

//or a similar method that switches on the output
//of Convert.ToInt32(string, 16) and returns the a
//byte[] in the same manner as getByteValueForString

public bool bar ()
{
  /* check the value for some representation
   * of a register */
  if (fooByteArray[2] == 0 & fooByteArray[3] == 0)
  {
    //some register, on the remote machine, is set to false
    return false;
  }
} 
```

对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T16:25:42.283

我*个人*只为此使用一个字节，而不是将 4 位拆分为 4 个字节。那时你可以使用：

```
byte b = Convert.ToByte(text, 16); 
```

如果你*真的*想要 4 个字节，你可以使用：

```
// Note: name changed to comply with .NET conventions
static byte[] GetByteValuesForString(string text)
{
    // TODO: Consider what you want to happen for invalid input.
    // You can easily write your own equivalent, ideally for a
    // single char
    byte value = Convert.ToByte(text, 16);
    return new byte[] {
        (byte) (value >> 3) & 1, 
        (byte) (value >> 2) & 1,
        (byte) (value >> 1) & 1,
        (byte) (value >> 0) & 1
    };
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T16:26:08.783

> 我使用 4 个字节来表示 4 位的唯一原因是因为我无法确定使用哪个对象来表示各个位。

看看[System.Collection.BitArray](http://msdn.microsoft.com/en-us/library/system.collections.bitarray.aspx)类。

```
 byte[] byteArray = new byte[yourString.Length / 2];
 for(int i = 0; i < byteArray.Length; ++i)  
 { 
     int tempInt1 = Convert.ToInt32(yourString[i], 16); 
     int tempInt2 = Convert.ToInt32(yourString[i + 1], 16);
     byteArray[i] = (byte)(tempInt1 << 4 + tempInt2);
 }

BitArray bits = new BitArray(byteArray);
for (int i = 0; i = bits.Count; ++i)
{
   Console.WriteLine(bits[i]);
} 
```

# ruby-on-rails - 设计 - ActionController::RoutingError (没有路由匹配 [GET] "/confirm"):

> ID：11123776
> 
> 赞同：0
> 
> 时间：2012-06-20T16:16:23.360
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise, devise-confirmable

我正在使用 Devise 的“可确认”模块，并进行“[仅电子邮件注册](https://github.com/plataformatec/devise/wiki/How-To%3a-Email-only-sign-up)”

但是，一旦用户确认了他们的电子邮件地址并添加了密码，这就是我在 Heroku (Cedar Stack) 上的日志中遇到的错误：

```
2012-06-20T16:02:37+00:00 app[web.1]: Started PUT "/confirm" for xx.xxx.4x.x2 at 2012-06-20 16:02:37 +0000
2012-06-20T16:02:37+00:00 heroku[router]: POST myapp.herokuapp.com/confirm dyno=web.1 queue=0 wait=0ms service=666ms status=302 bytes=114
2012-06-20T16:02:38+00:00 app[web.1]: 
2012-06-20T16:02:38+00:00 app[web.1]: 
2012-06-20T16:02:38+00:00 app[web.1]: Started GET "/confirm" for xx.xxx.4x.x2 at 2012-06-20 16:02:38 +0000
2012-06-20T16:02:38+00:00 app[web.1]: ActionController::RoutingError (No route matches [GET] "/confirm"):
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/rack/logger.rb:16:in `call'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.6/lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.6/lib/action_dispatch/middleware/request_id.rb:22:in `call'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/rack/logger.rb:26:in `call_app'
2012-06-20T16:02:38+00:00 app[web.1]: 
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.6/lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/runtime.rb:17:in `call'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/methodoverride.rb:21:in `call'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/lock.rb:15:in `call'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.6/lib/active_support/cache/strategy/local_cache.rb:72:in `call'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.6/lib/action_dispatch/middleware/static.rb:62:in `call'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:136:in `forward'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:245:in `fetch'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:185:in `lookup'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:51:in `call'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:66:in `call!'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/engine.rb:479:in `call'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.3.1/lib/thin/connection.rb:38:in `receive_data'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.3.1/lib/thin/backends/base.rb:61:in `start'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.3.1/lib/thin/server.rb:159:in `start'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.3.1/lib/thin/connection.rb:78:in `catch'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.3.1/lib/thin/controllers/controller.rb:86:in `start'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.3.1/lib/thin/runner.rb:185:in `run_command'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.3.1/lib/thin/runner.rb:151:in `run!'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.3.1/bin/thin:6:in `<top (required)>'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/bin/thin:19:in `load'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/bin/thin:19:in `<main>'
2012-06-20T16:02:38+00:00 app[web.1]: 
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.3.1/lib/thin/connection.rb:53:in `process'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run'
2012-06-20T16:02:38+00:00 app[web.1]: 
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.3.1/lib/thin/connection.rb:80:in `block in pre_process'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/application.rb:220:in `call'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.3.1/lib/thin/connection.rb:78:in `pre_process'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run_machine'
2012-06-20T16:02:38+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/railtie/configurable.rb:30:in `method_missing' 
```

用户记录成功创建，只是没有正确执行路由并引发错误。

`Routes.rb`

```
 devise_scope :user do
        put "/confirm" => "confirmations#confirm"  
  end

  devise_for :users, :controllers => { :confirmations => 'confirmations' } 
```

`ConfirmationsController.rb`

```
class ConfirmationsController < Devise::ConfirmationsController
  def show
        @categories = Category.all
    self.resource = resource_class.find_by_confirmation_token(params[:confirmation_token])
    super if resource.confirmed? 
  end

  def confirm
    self.resource = resource_class.find_by_confirmation_token(params[resource_name][:confirmation_token])
    if resource.update_attributes(params[resource_name]) && resource.password_match?
      self.resource = resource_class.confirm_by_token(params[resource_name][:confirmation_token])
      set_flash_message :notice, :confirmed
      sign_in_and_redirect(resource_name, resource)
    else
      render :action => "show"
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T17:23:33.160

你需要在你的 routes.rb 中

```
get "/confirm" => "confirmations#show" 
```

# f# - 如何使用 F# 3.0 类型提供程序生成 C# 友好、.Net 4.0 兼容的类型

> ID：11123777
> 
> 赞同：10
> 
> 时间：2012-06-20T16:16:26.167
> 
> 标签：f#, type-providers, f#-3.0

我想使用 F# 3.0 类型提供程序机制基于“弱”类型的数据源生成“强”类型。在仅安装 .Net 4.0 而不是 .Net 4.5 的环境中，必须可以从 C# 客户端访问生成的类型。如果无法与 .Net 4.0 兼容，我们就不能在当前的大型 ERP 项目中使用类型提供程序。

到目前为止，我已经按照msdn 上的[教程](http://msdn.microsoft.com/en-us/library/hh361034%28v=vs.110%29.aspx)（“提供生成的类型”部分），使用`ProvidedTypeDefinition`F# 3.0 示例包中的“ProvidedTypes-0.2.fs”中的教程成功创建了 MyGeneratedTypes.dll。（为了让它工作，我必须`File.Delete`从“ `ProvidedTypeDefinition.ConvertToGenerated`...”方法中删除“...”行）。

MyGeneratedTypes.dll 有运行时版本v4.0.30319，可以（.Net 4.0 的运行时）。我可以在 C#/.Net 4.0 应用程序中添加对 MyGeneratedTypes.dll 的引用，并且 IntelliSense 会按预期显示类型和成员。但是，当我尝试编译时，C# 编译器失败并产生“警告 MSB3258：无法解析主引用“MyGeneratedTypes”，因为它间接依赖于 .NET Framework 程序集“FSharp.Core，Version=4.3.0.0 , Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a”，在当前目标框架中，“4.3.0.0”版本比“4.0.0.0”版本高。

查看 IL Spy 确认 MyGeneratedTypes.dll 确实包含对 FSharp.Core 4.3 的引用，尽管此引用完全没有必要。到目前为止，我还没有发现任何方法可以阻止 F# 编译器将此引用放入生成的程序集中。（除此之外，我在 C# 中创建了一个纯 .Net 4.0 程序集并将其传递给 的构造函数`ProvidedTypeDefinition`，但这没有影响）。

有谁知道a）如何摆脱引用，或者b）如果这只是一个F# 3.0候选版本问题，将在最终版本中解决。

**编辑**

与@Brian 的对话导致了以下问题的“部分”解决方案：您*可以*编译引用具有 F# 3.0 生成类型的库的“纯 C#/.Net 4.0”客户端，但只能通过调用 .Net 4.0 C# 编译器( *csc* ) 直接*从命令行*。在 VS 2010 中或通过 MSBuild 命令行编译时，它不起作用。我怀疑这是由以下行为引起的：

1.  MyGeneratedTypes.dll 在 VS 2012 中使用 F# 类型提供程序机制生成。
2.  在生成过程中，会自动插入对 FSharp.Core 4.3 的引用（即使不需要），而无需在依赖项的元数据中指定“SpecificVersion:true”。
3.  “.Net 4.5-free”系统上的 VS 2010 中的 AC# 客户端引用 MyGeneratedTypes.dll。
4.  编译 C# 客户端时，MSBuild 会在 MyGeneratedTypes.dll 中发现对 FSharp.Core 4.3 的间接引用。
5.  因为间接引用存在于“SpecificVersion:false”中，所以 MSBuild 发出警告*MSB3257*并拒绝将直接引用 /r:"MyGeneratedTypes.dll" 传递给 C# 编译器 (csc)。（注意：不能以任何方式抑制 MSBuild 警告。）
6.  C# 编译器 (csc) 由 MSBuild 调用，不带 /r:"MyGeneratedTypes.dll"。因此，它无法编译，并发出编译器错误 CS0246：“找不到类型或命名空间名称 'MyGeneratedTypes' (...)”。

据我所知，除非修改 F# 类型提供程序机制 a) 在生成的程序集中不需要时排除对 FSharp.Core 4.3 的引用，或者 b) 包含参考元数据“ `SpecificVersion:true`”。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-20T18:22:19.123

只需在 C# 项目中添加对 FSharp.Core 4.3.0.0 的引用（或忽略警告）。尽管编号约定很奇怪，但 FSharp.Core 4.3.0.0 不依赖于 .Net 4.5 中的任何内容，它只依赖于 .Net 4.0。

# php - 将 PHP 表单复选框处理成 MySQL 表的问题

> ID：11123782
> 
> 赞同：0
> 
> 时间：2012-06-20T16:16:47.977
> 
> 标签：php, mysql

我有一个使用复选框的 PHP 表单。我还有一个带有 3 个表的 MySQL 数据库。

其中一张表名为 TAGS，其列是 ID 和 ARTICLE_CONTENTS。

数据库中的另一个表称为 ARTICLES，其列是 ID、ARTICLETITLE、ARTICLEORGANIZATION、ARTICLEDATE 和 ARTICLEURL。

第三个表称为 ARTICLES_TAGS，其列是 ARTICLE_ID 和 TAG_ID

TAGS 表有 87 个条目，类似于：

```
1    |    geology
2    |    astronomy
3    |    chemistry 
```

数据库的目的是创建标签和文章之间的关系。为此，PHP 表单使用复选框，用户可以在向数据库添加新条目时选中这些复选框。这些复选框代表 TAGS 表中的标签。因此，例如，TAGS 表中的每个条目都会有一个复选框：[ ]geology [ ]astronomy [ ]chemistry ...etc...

我要做的是使用文本框（文章标题、文章组织、文章日期和文章 url）插入信息，并使用 mysql_insert_id() 获取该插入的 ID 并将该 ID 与 ID 配对与选中的复选框关联的标签。

因此，例如，如果要选中 geology 复选框，并且如果在 TAGS 表中的 geology 条目是：

```
02  |  geology 
```

并且，如果插入的文章的 ID 恰好是 142

然后

将在 ARTICLES_TAGS 中插入一个新条目：

```
Article_ID    |    TAG_ID
   142        |      02 
```

但是，每当我执行我的表单时，尽管信息正确插入到 ARTICLES 表中，但我在 ARTICLES_TAGS 表中没有任何条目。我无法弄清楚我哪里出错了。

几天来我一直在研究这个问题的措辞，我认为现在很清楚。请让我知道是否需要任何澄清。

代码是：

```
<?php
    function renderForm($articletitle, $articleorganization, $articledate, $articleurl, $articletags )
{
?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    . . .
</head>
    <body>
        <div class="container">
        <div class="header">
            . . .
        </div>
        <div class="sidebar1">
            . . .
        </div>
        <div class="content">
            <div id="stylized" class="myform">
                <form id="form" name="form" action="" method="post">
                    <h1>Create a new entry in the database</h1>
                        <table width="76%" border="0" cellpadding="6">
                            <tr>
                                <td colspan="2"><legend></legend></td>
                            </tr>
                            <tr>
                                <td width="20%" align="right"><span class="field">Article Title:</span></td>
                                <td width="80%" align="left"><span class="field">
                                    <input name="articletitle" type="text" value="<?php echo $articletitle; ?>" size="50"/>
                                </span></td>
                            </tr>
                            <tr>
                                <td align="right"><span class="field">Article Author:</span></td>
                                <td align="left"><span class="field">
                                    <input name="articleorganization" type="text" value="<?php echo $articleorganization; ?>" size="50"/>
                                </span></td>
                             </tr>
                             <tr>
                                 <td align="right"><span class="field">Access Date:</span></td>
                                 <td align="left"><span class="field">
                                     <input name="articledate" type="text" value="MM/DD/YYYY" size="50"/>
                                 </span></td>
                             </tr>
                             <tr>
                                 <td align="right"><span class="field">Article URL:</span></td>
                                 <td align="left"><span class="field">
                                     <input name="articleurl" type="text" value="<?php echo $articleurl; ?>" size="50"/>
                                 </span></td>
                             </tr>
                             <tr>
                                 <td align="right"><span class="field">Article Tags:</span></td>
                                 <td align="left"><span class="field">
                                     <input type="checkbox" name="articletags[]" value="1" id="articletags_0" />Science
                                     <input type="checkbox" name="articletags[]" value="2" id="articletags_1" />Geology

                                 </span></td>
                             </tr>
                             <tr>
                                 <td colspan="2" align="center" valign="middle"><input type="submit" name="submit" value="Add this Article" /></td>
                             </tr>
                        </table>
                </form>
        </div>
       <div class="footer">
           . . .
       </div>
    </body>
</html>
<?php 
}
    include('settings.php');

    if(count($articletags) > 0)
{
    $articletags_string = implode(",", $articletags);
}
    if($_SERVER['REQUEST_METHOD'] == 'POST')
{ 
    $articletitle = mysql_real_escape_string(htmlspecialchars($_POST['articletitle']));
    $articleorganization = mysql_real_escape_string(htmlspecialchars($_POST['articleorganization']));
    $articledate = mysql_real_escape_string(htmlspecialchars($_POST['articledate']));
    $articleurl = mysql_real_escape_string(htmlspecialchars($_POST['articleurl']));
{
}
    if ($articletitle == '' || $articleorganization == '')
{
    $error = 'ERROR: Please fill in all required fields!';
    renderForm($articletitle, $articleorganization);
}
    else
{
    mysql_query("INSERT INTO articles SET articletitle='$articletitle',
        articleorganization='$articleorganization',
        articledate='$articledate',
        articleurl='$articleurl' ");
    $article_id = mysql_insert_id();       

    foreach ($_POST['articletags'] as $newtag)
{
    mysql_query(" INSERT INTO articles_tags article_id='$article_id',
               tag_id='$newtag' ");
}
    header("Location:addsuccess.php");  
}
}
    else
{
    renderForm('','','','','');
}
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T16:50:17.910

# 让它工作...

首先，您需要修复一个解析错误。

### 第 93 行：

```
mysql_query("INSERT INTO articles SET articletitle='$articletitle',
    articleorganization='$articleorganization',
    articledate='$articledate',
    articleurl='$articleurl' ")
    $article_id = mysql_insert_id();       
or die(mysql_error()); 
header("Location:addsuccess.php"); 
```

注意 的`or die()`赋值后`$article_id = mysql_insert_id()`。这是无效的语法。

```
mysql_query("INSERT INTO articles SET articletitle='$articletitle',
    articleorganization='$articleorganization',
    articledate='$articledate',
    articleurl='$articleurl' ")
    or die(mysql_error()); 
$article_id = mysql_insert_id();       
header("Location:addsuccess.php"); 
```

### 第 84 - 85 行：

```
foreach( $POST_['articletags'] as $newtag )
{
} 
```

这个块是问题所在：你有一个循环什么都不做。但是，您确实已经准备好插入语句。因此，让我们将此循环与第 101 行（在 101 的位置）合并以进行有效插入。

```
foreach( $_POST['articletags'] as $newtag )
{
  mysql_query('INSERT INTO articles_tags (article_id,tag_id) VALUES ($article_id, $newtag)');
} 
```

您的结果应如下所示：

```
<?php
    function renderForm($articletitle, $articleorganization, $articledate, $articleurl, $articletags )
{
?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    . . .
</head>
    <body>
        <div class="container">
        <div class="header">
            . . .
        </div>
        <div class="sidebar1">
            . . .
        </div>
        <div class="content">
            <div id="stylized" class="myform">
                <form id="form" name="form" action="" method="post">
                    <h1>Create a new entry in the database</h1>
                        <table width="76%" border="0" cellpadding="6">
                            <tr>
                                <td colspan="2"><legend></legend></td>
                            </tr>
                            <tr>
                                <td width="20%" align="right"><span class="field">Article Title:</span></td>
                                <td width="80%" align="left"><span class="field">
                                    <input name="articletitle" type="text" value="<?php echo $articletitle; ?>" size="50"/>
                                </span></td>
                            </tr>
                            <tr>
                                <td align="right"><span class="field">Article Author:</span></td>
                                <td align="left"><span class="field">
                                    <input name="articleorganization" type="text" value="<?php echo $articleorganization; ?>" size="50"/>
                                </span></td>
                             </tr>
                             <tr>
                                 <td align="right"><span class="field">Access Date:</span></td>
                                 <td align="left"><span class="field">
                                     <input name="articledate" type="text" value="MM/DD/YYYY" size="50"/>
                                 </span></td>
                             </tr>
                             <tr>
                                 <td align="right"><span class="field">Article URL:</span></td>
                                 <td align="left"><span class="field">
                                     <input name="articleurl" type="text" value="<?php echo $articleurl; ?>" size="50"/>
                                 </span></td>
                             </tr>
                             <tr>
                                 <td align="right"><span class="field">Article Tags:</span></td>
                                 <td align="left"><span class="field">
                                     <input type="checkbox" name="articletags[]" value="1" id="articletags_0" />Science
                                     <input type="checkbox" name="articletags[]" value="2" id="articletags_1" />Geology
                                 </span></td>
                             </tr>
                             <tr>
                                 <td colspan="2" align="center" valign="middle"><input type="submit" name="submit" value="Add this Article" /></td>
                             </tr>
                        </table>
                </form>
        </div>
       <div class="footer">
           . . .
       </div>
    </body>
</html>
<?php 
}
    include('settings.php');

    if(count($articletags) > 0)
    {
        $articletags_string = implode(",", $articletags);
    }

    if($_SERVER['REQUEST_METHOD'] == 'POST')
    { 
        $articletitle = mysql_real_escape_string(htmlspecialchars($_POST['articletitle']));
        $articleorganization = mysql_real_escape_string(htmlspecialchars($_POST['articleorganization']));
        $articledate = mysql_real_escape_string(htmlspecialchars($_POST['articledate']));
        $articleurl = mysql_real_escape_string(htmlspecialchars($_POST['articleurl']));
        if ($articletitle == '' || $articleorganization == '')
        {
            $error = 'ERROR: Please fill in all required fields!';
            renderForm($articletitle, $articleorganization);
        }
        else
        {
            mysql_query("INSERT INTO articles SET articletitle='$articletitle',
                articleorganization='$articleorganization',
                articledate='$articledate',
                articleurl='$articleurl' ")
                or die(mysql_error()); 
            $article_id = mysql_insert_id();       
            header("Location:addsuccess.php");  
        }
        foreach( $_POST['articletags'] as $newtag )
        {
          mysql_query('INSERT INTO articles_tags (article_id,tag_id) VALUES ($article_id, $newtag)');
        }
    }
    else
    {
    renderForm('','','','','');
    }
?> 
```

# 现在它起作用了......

我们必须讨论一下安全性。到目前为止，对于初学者来说，您已经做得很好，但是您错过了转义一个被插入（逐字！）到查询中的变量：tag_id。而且您忘记了单引号不插入值。

```
mysql_query('INSERT INTO articles_tags (article_id,tag_id) VALUES ($article_id, $newtag)'); 
```

真的应该是（主要是为了安全）：

```
mysql_query(sprintf('INSERT INTO articles_tags (article_id,tag_id) VALUES (%d, %d)', $article_id, $newtag)); 
```

## 一点优化

当您插入大量标签时，此脚本会创建多个查询。所以我想我会告诉你如何清理它以一次插入多个标签。

```
if(isset($POST_['articletags']) && count($POST_['articletags'])) {
  $query = 'INSERT INTO articles_tags (article_id,tag_id) VALUES ';
  $tags = array();
  foreach( $POST_['articletags'] as $newtag )
  {
    $tags[] = sprintf('(%d, %d)', $article_id);
  }
  mysql_query($query . implode(', ', $tags));
} 
```

此代码生成与以前相同的查询，但它将构建一组列表以一次插入多个条目。最重要的是，它还将两个值过滤为整数。

## 代码格式

我必须做一些重新格式化才能理解您的代码。这部分是您的问题的原因。如果没有适当的缩进，您可能很容易错过这样的错误并且永远不会知道。您可能想阅读[编程风格](http://en.wikipedia.org/wiki/Programming_style)。

# git - 不允许在特定本地分支上拉特定远程

> ID：11123784
> 
> 赞同：0
> 
> 时间：2012-06-20T16:16:59.007
> 
> 标签：git

在 git 中，我有一个名为的分支`localbranch1`，我做了一个`git pull origin remotebranch1`

我有另一个本地分支叫它`localbranch2`应该从`remotebranch2`

我有一个习惯，`git pull origin remotebranch1`当我在发生我不想`localbranch2`发生的原因合并时，我会意外地做一个。

有没有办法“锁定”或限制自己从不同的分支拉出？如果我在尝试从不同的远程分支提取时遇到某种类型的错误或警告，那就太好了。还是我应该以完全不同的方式处理这个工作流程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:33:59.083

如果提到的每个本地分支总是对应于 上的同一个分支`origin`，最简单的解决方案是设置分支来跟踪远程分支，然后简单地使用`git pull origin`：

```
$ git branch --set-upstream localbranch1 origin/remotebranch1
Branch localbranch1 set up to track remote branch remotebranch1 from origin.
  ...
$ git pull 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T16:33:30.567

我认为没有任何方法可以限制将其包装在“您确定要...”确认脚本中。最好的办法可能是确保设置好东西，以便无论您在哪个分支上，bare`git pull`都可以完成您想要的操作，然后打破自己打字的习惯`git pull`（或者`git pull origin`如果您有多个遥控器）。`git pull <remote> <branch>`为不寻常的非标准工作流程事件预留。

# asp.net-mvc - 如何将数据访问代码从控制器移动到存储库

> ID：11123786
> 
> 赞同：0
> 
> 时间：2012-06-20T16:17:00.613
> 
> 标签：asp.net-mvc, asp.net-mvc-3, model-view-controller, viewmodel, repository-pattern

我有一个控制器，它返回一个 ViewModel 到一个视图，它工作得很好。我想迁移到存储库模式，但无法在存储库中获取正确的语法。我已经创建了存储库和它的接口。

```
 public interface IShippingRepository
{
    IQueryable<ShippingCommHdr> All { get; }
    IQueryable<ShippingCommHdr> AllIncluding(params Expression<Func<ShippingCommHdr, object>>[] includeProperties);
    void InsertOrUpdate(ShippingCommHdr shippingcommhdr);
    void Delete(int id);
    void Save();
} 
```

这是我要移动到存储库的控制器的代码：

```
public ViewResult ShippingSummary()
    {
        CPLinkEntities context = new CPLinkEntities();
        var shipments =
                  from h in context.ShippingCommHdrs
                  where (h.CompletedDate == null)
                  join
                  e in context.vHr_Employees on h.CreatedBy equals e.ID
                  join
                  s in context.Shippers on h.ShipperID equals s.ShipperID
                  join
                  r in context.vAaiomsSites on h.ShipToSiteID equals r.SiteID
                  join
                  c in context.vHr_Employees on h.CreatedBy equals c.ID
                  join
                  p in context.vHr_Employees on h.FromSitePOC equals p.ID
                  select new
                  {
                      h.ID,
                      ShippedToSite = r.SiteName,
                      h.DateShipped,
                      h.EstDeliveryDate,
                      h.TrackingNo,
                      h.HeaderComments,
                      h.ShippingCommLI.Count,
                      s.Shipper,
                      CreatedBy = c.LastName,
                      FromSitePoc = p.LastName

                  };

        var model = new List<ShippingSummaryVM>();

        foreach (var h in shipments)
        {

            var viewModel = new ShippingSummaryVM
            {
                ID = h.ID,
                ShippedToSite = h.ShippedToSite,
                DateShipped = h.DateShipped,
                EstDeliveryDate = h.EstDeliveryDate,
                TrackingNo = h.TrackingNo,
                FromSitePOC = h.FromSitePoc,
                Shipper = h.Shipper,
                HeaderComments = h.HeaderComments,
                NumOrders = h.Count,
                CreatedBy = h.CreatedBy,

            };

            model.Add(viewModel);
        }

        return View(model);

    } 
```

如果我能让这个 Controller/Repository 工作，我就可以相当快地迁移所有其他控制器/存储库。感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T12:39:53.067

我首先将方法定义添加到您需要执行的查询的存储库接口。存储库可以给这个查询一个有意义的名字：

```
public interface IShippingRepository
{
    IQueryable<Shipment> GetShipments()
    // ...
} 
```

在控制器中，您需要一个存储库实例。您可以将它注入到构造函数中，或者在构造函数中创建一个，但是无论哪种方式，存储库都需要在幕后与 CPLinkEntities 上下文进行对话。您需要将上下文传递到存储库以供存储库使用。

```
public class SomeController : Controller
{

    IShippingRepository _shippingRepository;

    public SomeController()
    {
        _shippingRepository = new ShippingRepository(new CPLinkEntities());
    }

    public ViewResult ShippingSummary()
    {
        var shipments = _shippingRepository.GetShipments();

        // ....
    }   
} 
```

具体的存储库定义可能如下所示。

```
public class ShippingRepository : IShippingRepository
{
    CPLinkEntities _entities;

    ShippingRepository (CPLinkEntities entities)
    {
        _entites = entities;
    }

    public IQueryable<Shipment> GetShipments()
    {
        return from ship in _entities.Ships join ... join ... select
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T20:52:27.400

您的控制器方法基本上有两个职责

1.  运行查询
2.  将查询结果映射到视图模型中

您可以将该查询放入存储库，然后您可以使用[AutoMapper](http://automapper.codeplex.com/)或[ValueInjecter](http://valueinjecter.codeplex.com/)等自动映射器工具来帮助您将查询结果映射到视图模型。

您生成的控制器方法将简单地调用存储库以获取 CPLinkEntities 列表。然后，您的控制器方法可以获取这些实体，然后调用自动映射器为您提供 ShippingSummaryVM 的列表。我留下了一些实现细节，但这应该让您对如何实现您的要求有一个高度的了解。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T21:46:30.330

选项 A：拥有更强大的领域模型。您的存储库将负责加载根级域对象，并让底层 OR/M 处理对象遍历。您的控制器将调用装运方法来查找尚未完成的装运。您将取回一个货件对象，并可以遍历相关实体以获取您的 VM 所需的站点名称和其他详细信息

选项 B：拥有为每个实体返回全部的存储库，然后在业务或服务层中进行连接。即使您说 ShippingRepository.All，实体框架也不会全部加载。它仅在最后一个负责任的时刻加载（当您需要具体化结果时）。因此，您可以有一个业务方法，将每个实体上的“全部”加入并根据完成日期进行过滤，然后返回结果。

选项 A 更好，但可能需要更多的工作。

# c - 与按位运算混淆 &

> ID：11123787
> 
> 赞同：1
> 
> 时间：2012-06-20T16:17:01.987
> 
> 标签：c, linux, bit-manipulation, boolean-operations

以下行应该测试当前文件是否为目录：

```
if ((stbuf.st_mode & S_IFMT) == S_IFDIR)
      //file is a directory. 
```

`stbuf`类型 在哪里

```
 struct stat            /* inode information returned by stat */
 {
      dev_t st_dev;     /* device of inode */
      ino_t st_ino;     /* inode number */
      short st_mode;    /* mode bits */
      short st_nlink;   /* number of links to file */
      short st_uid;     /* owners user id */
      short st_gid;     /* owners group id */
      dev_t st_rdev;    /* for special files */
      off_t st_size;    /* file size in characters */
      time_t st_atime;  /* time last accessed */
      time_t st_mtime;  /* time last modified */
      time_t st_ctime;  /* time originally created */
 }; 
```

和定义 `S_IFMT`为`S_IFDIR`

```
#define S_IFMT 0160000  /* type of file: */
#define S_IFDIR 0040000 /* directory */ 
```

我不明白上面给出的声明将如何工作？请任何人解释其背后的逻辑。
谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T16:22:19.220

它基本上是说如果你把所有的位都`stbuf.st_mode`放在`S_IFMT`. 您将生成第三行，即 AND 操作的结果。有关 AND 操作，请参见以下内容`truth table`，仅`1`当*两个*输入均为时，输出为`1`。

```
input1| input2| output
------+-------+-------
  0   |   0   |   0
  0   |   1   |   0
  1   |   0   |   0
  1   |   1   |   1 
```

对于每个相应的位位置，将 a`0`放在数字下方，**除非给定位置的** *两个*相应位都是`1`，在这种情况下，您记录 a `1`。

也许这个视觉图像会有所帮助：

```
st_mode   |  0100 0000 0000 0000 0000 0000 0000 0000
S_IFMT    |  1110 0000 0000 0000 0000 0000 0000 0000
bitwise & |===========================================
result    |  0100 0000 0000 0000 0000 0000 0000 0000 
```

将此结果位模式与`S_IFDIR`. 如果它们相等，则您有一个目录。

也许这个 SO question [Using Struct Stat()](https://stackoverflow.com/questions/3512434/using-struct-stat)也会有所帮助。最后，除了这个结构的所有血腥细节之外， [stat(3) 手册页](http://linux.die.net/man/3/stat)还有一些示例代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T16:24:13.697

按位与获取与特定设置有关的位`S_IFDIR`。

如果结果是`S_IFDIR`，则设置该标志。`0160000`以八进制表示，表示整数的前 3 位。`0040000`是第二位，所以它们重叠。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-20T16:29:49.943

对于来自源和掩码的每一对对应位，当且仅当这两个位都设置为 1 时，逻辑与运算会给出一个开启位 (1)。这意味着掩码中未开启的所有位都归零。假设您有一个带有位 abcdefgh 的单个字节，其中每个字母都是一个位，因此是 0 或 1。如果您有一个值为例如 00111000 的掩码，则两者将得到 00cde000。因此，使用掩码，您“剪切”了位的子串。通常，掩码只设置一个位，在这种情况下，您将测试一个位。在您的示例中，掩码是 S_IFMT。现在，您可以在掩码保持不变的 3 位空间中获取许多值，例如 00101000、00011000 或任何其所有 1 位都在掩码分隔的空间内的任何值（这就是您的 S_IFDIR 在您的示例中), 和你可以对比一下。因此，如果是简单的话，整个操作意味着“获取变量位的子字符串并检查它是否是预定义值之一”。这一切都是为了空间效率，如果它不重要，设计者可能会为模式字段定义一个单独的变量。

# javascript - 自定义 Javascript 灯箱

> ID：11123788
> 
> 赞同：0
> 
> 时间：2012-06-20T16:17:02.720
> 
> 标签：javascript, jquery, onclick

我正在尝试为我的网站上的图像创建自己的灯箱。是的，我知道有 lightbox2，它是免费的，但我喜欢挑战。我在灯箱本身上的点击事件有问题，我试图让它删除灯箱，但点击事件似乎没有注册，我在谷歌浏览器的开发工具中没有错误。这是我的代码：

```
$(document).ready(function(){
    $(".lbox").click(function(){
        $("body").append("<DIV class='lbox_container'><DIV class='img_container'><IMG src='" + this.src + "'/></DIV></DIV>");
        $(".lbox_container").width($(document).width()).height($(document).height());
    });
    $(".lbox_container").click(function(){
        $(".lbox_container").remove();
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T16:20:19.983

代替

```
$(".lbox_container").click(function(){
    $(".lbox_container").remove();
}); 
```

用这个：

```
$("body").on('click','div.lbox_container', function(){
    $(".lbox_container").remove();
}); 
```

您需要这样做，因为 jQuery 不会在 DOM 中的新项目上注册 .click() 事件，只是在调用 document.ready 函数时页面上存在的项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T16:21:11.937

将 lbox_container 添加到页面后，您需要设置它的单击状态 - 在第一次单击中移动绑定事件应该可以工作。

```
$(document).ready(function(){
    $(".lbox").click(function(){
        $("body").append("<DIV class='lbox_container'><DIV class='img_container'><IMG src='" + this.src + "'/></DIV></DIV>");
        $(".lbox_container").width($(document).width()).height($(document).height());

        $(".lbox_container").click(function(){
             $(".lbox_container").remove();
        });
    });
}); 
```

# excel - excel vb中的平均每日变化列

> ID：11123790
> 
> 赞同：0
> 
> 时间：2012-06-20T16:17:03.637
> 
> 标签：excel, vbscript

每天我都要分析两列数字。

1.  Cols 每天都不同。
2.  Col 1 有从 1 到 5 的编号，例如。第 1 天有 150 x 1 和 200 x 2 等。第 2 天有 350 x 1 和 85 x 2 等。
3.  Col 2 的值介于 1 和 99 之间。

我需要计算有多少个 1 以获得 1 的平均值、2 的平均值等。到目前为止，我已经尝试编写一个 vb 程序（excel 2010） - 我写了以下内容：

```
Function Phil2()
ct = 0
For X = 2 To 10
If ax = 1 Then Let b15 = b15 + bx
ct = ct + 1
Next
End Function. 
```

但我无法让它显示。谁能帮我？我想要单元格 b15 中 1 的平均值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T21:22:44.350

请参阅编辑栏以了解单元格 E1 中的内容。如果你没有XL2007或以上，公式变为：

```
=IF(ISERROR(SUMIF($A$1:$B$10,D1,$B$1:$B$10)/COUNTIF($A$1:$B$10,D1)),"",SUMIF($A$1:$B$10,D1,$B$1:$B$10)/COUNTIF($A$1:$B$10,D1)) 
```

您还可以通过为您的 ID (1,2,3..) 和数据 (%) 集使用[动态命名范围](http://www.ozgrid.com/Excel/DynamicRanges.htm)来实现更多“自动化”，这些范围每天都在变化。

![在此处输入图像描述](../Images/faa8c5364c224fa005e728db701bbf20.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-24T11:29:39.087

好的，它工作正常 - 我将您的公式修改为：

```
=IFERROR(AVERAGEIFS(B$16:B$500,$A$16:$A$500,$A2,B$16:B$500,">0"),"") 
```

它非常适合值 1 和 2。所以这是一个很好的开始。我将公式单元格放在顶部：所以在 a1 中，我输入了奶牛编号、b1 %Milk、c1 % 重量等。在 a2 中，我输入了 1、a3 2、a4 3 等。在 b2 中，你的公式等。 . 我的下一个挑战是将所有奶牛类型 3 到 11 放在一起。所以在奶牛类型 1 旁边，每个类别都有一个百分比，对于奶牛类型 2 也是如此，等等。但是第三行必须有所有类别 3 的平均值+。原始数据牛类型在 a10 down，vals 在 b10，c10 等。

# emacs - Emacs Editor 的添加/编辑功能

> ID：11123793
> 
> 赞同：1
> 
> 时间：2012-06-20T16:17:19.240
> 
> 标签：emacs, lisp, elisp, emacs23

我需要在编辑器上实现一些新功能。我选择了 Emacs——虽然我的主要编程知识是 Java 和 C——我想添加一些功能并编辑 Emacs Editor 的一些现有功能。我查看了它的源代码，我有点迷茫。我想知道是否有人可以给我一些关于从哪里开始以及是否有任何教程可以提供帮助的建议？

PS 一个具体的问题是如何开始编写具有所有新功能和行为的新模式？或者我如何禁用一些基本功能，如复制/粘贴？

干杯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T16:43:51.110

**Emacs Lisp 编程简介** [http://www.gnu.org/software/emacs/emacs-lisp-intro/](http://www.gnu.org/software/emacs/emacs-lisp-intro/) 或输入 emacs：

```
M-: (info "(eintr)Top") RET 
```

**Emacs Lisp 手册** [http://www.gnu.org/software/emacs/manual/elisp.html](http://www.gnu.org/software/emacs/manual/elisp.html) 或输入 emacs：

```
M-: (info "(elisp)Top") RET 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T12:53:56.060

有一些专门针对编写主要模式的教程。

*   [emacs 扩展指南](http://www.emacs.uniyar.ac.ru/doc/O%27Reilly_Emacs/Writing%20GNU%20Emacs%20Extensions.PDF)[pdf]
*   [如何写一个主模式...](http://xahlee.org/emacs/elisp_syntax_coloring.html)

除此之外，在 Emacs 中编写模式只是编写 Lisp 函数。

我要指出的一件事是，您在这里提议做的事情可能毫无意义。如果您将权限系统实现为主要模式，用户只需切换模式即可将其关闭。如果此权限系统的目的是避免破坏编辑，那很好（在这种情况下，我假设您的用户会配合您的目标）。如果您期望您的用户具有对抗性，那么 Emacs 是错误的工具。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T22:48:43.140

这是关于定义主要和次要模式的手册部分：

`C-h``i``g` `(elisp) Modes` `RET`

从现有模式派生出一种新模式通常是有益的，它提供与您需要的类似的基本功能。

如果没有足够匹配的东西，那么检查源代码中提供某些相同行为的模式将是下一个最好的事情。

我注意到“派生”一个模式`nil`似乎是创建一个全新的主要模式的常用方法。这样，您仍然可以获得`define-derived-mode`宏的所有好处。

# java - Swing 和 MySql 中的瘦客户端之间的安全问题直接

> ID：11123796
> 
> 赞同：1
> 
> 时间：2012-06-20T16:17:30.223
> 
> 标签：java, mysql, swing, security

我有一个直接连接到 MySql 数据库以进行用户身份验证的 Swing 应用程序。

*   该应用程序的位代码将在互联网上提供下载
*   连接信息在静态变量中

我知道我应该编写一个服务器来处理身份验证，但最初的要求没有提到身份验证用例

我的问题是：混淆应用程序是否足以对连接信息进行编码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:22:00.157

不，大多数人将能够对字节码进行逆向工程或反编译并查看变量。您可以自己尝试一下，看看您并没有真正向任何高级用户隐藏任何东西。

在这种情况下，您真的希望在客户端和数据库之间有一个服务来处理身份验证，就像您说的那样。

然后，该服务将拥有允许/禁止访问数据库的用户帐户。

编辑：

尝试使用[这个](http://java.decompiler.free.fr/)反编译器并亲自看看这不起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T16:23:28.673

你知道他们怎么说通过默默无闻的安全！（提示：这根本不是安全性）。

加密它（尽管似乎没有服务器端组件，我没有看到可行的方法）。或者像你说的那样做认证服务器端。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T01:08:33.440

我想做一些快速而肮脏的事情，但最后我意识到做正确的事情也不会花费太多。我所做的是有一个在服务器端公开[DAO的](http://en.wikipedia.org/wiki/Data_access_object)[外观](http://en.wikipedia.org/wiki/Facade_pattern)，一个服务器和一个通过 Java Socket 通信的客户端对象。

然后，我不直接从客户端调用 DAO，而是通过将方法名称作为字符串传递来调用服务器上的方法。并且在反射的帮助下，facade 调用了 DAO 上的正确方法。

我想我应该对字符串进行编码并添加一个安全令牌。

# c# - 集合在 datatable.Copy() 上被修改异常

> ID：11123798
> 
> 赞同：1
> 
> 时间：2012-06-20T16:17:33.060
> 
> 标签：c#, .net, thread-safety

我打电话时遇到以下异常，我`datatable.Copy()`不知道为什么。我应用了一个锁来避免这个问题，但它似乎没有解决它。异常不会始终如一地发生，所以我知道它与线程有关。我误解了锁的工作原理吗？

> System.InvalidOperationException：集合已修改；枚举操作可能不会执行。在 System.Data.RBTree`1.RBTreeEnumerator.MoveNext() 在 System.Data.DataTable.Copy()

代码：

```
DataTable dt;

lock (ClassName.datatable)
{
    dt = ClassName.datatable.Copy();
} 
```

`ClassName`是类型而不是对象（在我的上一个问题中有一些混淆）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T16:47:52.030

从评论来看，你误解了它的`lock`工作原理。这是一个*合作*方案，两个线程不能同时在同一个监视器上持有锁。除非一个线程尝试使用`lock`语句或（和相关调用）“进入”锁，否则另一个线程*持有*[`Monitor.Enter`](http://msdn.microsoft.com/en-us/library/system.threading.monitor.enter.aspx)锁的事实是无关紧要的。

 *这有点像一个没有锁的浴室，但有一个“订婚”或“空置”的标志......没有人*被迫*自己更改标志或注意到它的当前状态......但如果每个人都*同意*两者都做，你可以避免尴尬的情况。

就我个人而言，我尽量避免锁定任何其他代码可见的监视器，所以我可能会有：

```
private readonly object tableLock = new objet();
private readonly DataTable table;

...

lock (tableLock)
{
    ...
} 
```

您至少需要在使用表的*任何地方都*可能获得锁- 当然，如果您将它传递给可能存储对它的引用的其他方法，或者您是由其他代码提供的，那么您实际上几乎没有控制权关于它发生了什么。*

# javascript - 在父点击而不是在子点击时触发事件

> ID：11123799
> 
> 赞同：7
> 
> 时间：2012-06-20T16:17:37.343
> 
> 标签：javascript, jquery, html, css

如果我有一个绝对定位的父 div，然后是一个具有更高 z-index 并且相对定位的子 div，有没有办法只有在单击父 div 而不是内部 div 时才注册单击事件?

[相关的jsFiddle](http://jsfiddle.net/Bt5HA/)

[更新了带有文本输入示例的小提琴](http://jsfiddle.net/Bt5HA/1/)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-20T16:21:12.767

```
$(".parent").click(function(e) {
    if (e.target == this) {
        $(this).hide();
    }
});​ 
```

**演示：http:** [//jsfiddle.net/Bt5HA/4/](http://jsfiddle.net/Bt5HA/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T16:20:42.273

改成：

```
$('.child a').click(function(e) {
    $(this).parent('.child').hide();
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T16:21:11.880

访问子元素并在单击它们时返回 false [http://jsfiddle.net/Bt5HA/3/](http://jsfiddle.net/Bt5HA/3/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-02T10:30:00.490

试试这个

```
$('#child').click(function(event) {
event.stopPropagation();
alert('You clicked Child');
});

$('#parent').click(function() {
alert('You clicked on Parent');
}); 
```

您可以在这里查看工作 [http://jsfiddle.net/VnHGH/24/](http://jsfiddle.net/VnHGh/24/)

# c++ - 从子 DLL 访问/修改变量

> ID：11123807
> 
> 赞同：0
> 
> 时间：2012-06-20T16:17:53.523
> 
> 标签：c++, winapi

我正在使用以下代码在 win32 可执行文件上加载 DLL：

```
int _tmain(int argc, _TCHAR* argv[])
{
    DWORD somevar = 0;
    HINSTANCE hDLL;
    hDLL = LoadLibrary( argv[1] );
    if ( !hDLL ){
      MessageBox(NULL, _T("Unable to load dll."), _T("Fatal Error"), MB_ICONERROR);
      return -1;
    }
} 
```

加载 DLL 后，DLL 是否可以访问其父可执行文件的变量，比如`somevar`上面的 DWORD 变量？

场景是加载DLL的实际可执行文件已经编译并在生产中使用，所以我不能在父可执行文件中添加任何代码。我只有源代码供参考。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T16:21:52.617

您需要从您的 DLL 中[导出](http://msdn.microsoft.com/en-us/library/a90k134d%28v=vs.80%29.aspx)访问器函数，这可能看起来像这样：

```
__declspec(dllexport) DWORD getSomevar();
__declspec(dllexport) void setSomevar(DWORD somevar); 
```

（此时最好`somevar`不要成为堆栈变量。）

加载的 DLL 然后可以使用[GetProcAddress](http://msdn.microsoft.com/en-us/library/64tkc9y5.aspx)获取这些函数的地址并调用它们。链接中有示例代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T16:27:47.870

为了访问 somevar 变量，您应该传递 var 的地址。我的意思是将 var 作为指向 dll 的指针传递。

```
__declspec(dllexport) void DLLFunc1(DWORD* somevar); 
```

---在您的代码中

```
 DWORD somevar = 0;
hDLL = LoadLibrary("MyDLL");
if (hDLL != NULL)
{
   lpfnDllFunc1 = (LPFNDLLFUNC1)GetProcAddress(hDLL,                                          "DLLFunc1")
}
lpfnDllFunc1(&somevar); 
```

# jquery - jQuery Mobile，HTML5，设置输入字段 type="date"

> ID：11123812
> 
> 赞同：8
> 
> 时间：2012-06-20T16:18:22.920
> 
> 标签：jquery, html, mobile

我正在使用 jQuery 移动 1.1.0。我有一个表单，用户可以在其中编辑信息。在该表单中有 2 个带有日期值的字段。由于我想利用内置的日期选择器功能，输入类型设置为“日期”。当表单在桌面浏览器上加载时，该值已正确设置为日期，但是当我在移动设备（iPhone iOS 5）上查看相同的表单时，不会填充日期字段。

下面是一个字段，type="text"。该值设置得很好：

```
<input type="text" id="name"  />

$("#name").val(obj.Name); 
```

日期字段 (type="date") 永远不会设置值：

```
<input type="date" id="startdate" />

$("#startdate").val(obj.StartDate); 
```

如前所述，在桌面浏览器 (Chrome/Firefox) 上，这些字段会设置一个值。它在 Safari 手机上却没有。

如果这已经在某个地方得到了回答，请原谅！我已经搜索过，但没有找到任何相关的东西。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-06T23:59:38.550

我从另一篇文章中找到了答案：[在 iPad 上设置日期输入值](https://stackoverflow.com/questions/11183959/setting-the-value-of-date-inputs-on-ipad)

只需将日期格式化为 yyyy-MM-dd，就这么简单。

# c - C 编程中的 pthread 内存泄漏

> ID：11123823
> 
> 赞同：1
> 
> 时间：2012-06-20T16:19:22.063
> 
> 标签：c, memory-leaks, pthreads

我有下面的代码。

```
void *timer1_function(void * eit);
pthread_t timer1;
int thread_check1 = 0;

line72: thread_check1 = pthread_create( &timer1, NULL, timer1_function,  NULL); 
```

Valgrind 显示下面的输出并说`line 72`. `pthread_create`上面的用法有什么问题？

```
272 bytes in 1 blocks are possibly lost in loss record 2 of 5
  in main in main.c:72
  1: calloc in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so
  2: _dl_allocate_tls in /build/buildd/eglibc-2.15/elf/dl-tls.c:297
  3: pthread_create@@GLIBC_2.2.5 in /build/buildd/eglibc-2.15/nptl/allocatestack.c:571
  4: main in <a href="file:///home/user/Project-build-desktop-Qt_4_8_1_in_PATH__System__Release/../project/main.c:72" >main.c:72</a> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T16:25:44.430

当你创建一个线程时，你会为它分配一些内存。清理此内存的任务是通过调用 来完成的`pthread_join`。

线程退出时未清理此内存的原因是这些数据包含诸如“线程的退出状态”之类的信息，父级可能希望稍后检查这些信息。因此，从不`join`ing 线程意味着永远不会清理该内存。

未加入线程的概念类似于[僵尸进程](http://en.wikipedia.org/wiki/Zombie_process)。

# android - 如何制作带有可拖动项目的 ListView？

> ID：11123824
> 
> 赞同：5
> 
> 时间：2012-06-20T16:19:26.040
> 
> 标签：android, listview

我正在寻找一个 ListPreference，用户可以在其中更改列表中项目的顺序。这些项目将是可拖动的，并且可以由用户重新排序。

我在 QuickPanel 的自定义 ROM 中看到了这个（我几乎可以肯定我在 Cyanogenmod 中看到过）。这是一个屏幕截图，可以帮助您理解这个想法：

![截图](../Images/37d282f2c08d4a3280d24680593f76fd.png)

我知道如何制作自定义 ListView 项目并设置图标以指示这些项目是可拖动的，但我不知道如何使它们可拖动，并相应地更改顺序。至于将它们保存在首选项中，我发现[这](https://stackoverflow.com/a/8287418/1043456)很容易实现。

*PS*：我知道 Cyanogenmod 是开源的，但我找不到这个特定东西的来源 :( 我能得到的最接近的是[这个](https://github.com/CyanogenMod/android_packages_apps_CMParts/blob/gingerbread/res/xml/ui_status_bar.xml)，它应该在另一个屏幕附近的某个地方......

在此先感谢您提供有关此问题的任何提示。

**更新**：我最终使用了已接受答案中的文件，并进行了添加和修改。我在这里列出它们以供进一步参考。

*   使用一个自定义的Adapter（我这里是ArrayAdapter），来实现这个item可拖动的视觉反馈，就是TextView附近的一个ImageView。这是可选的。

*   设置 DragListener 和 RemoveListener 以相应地更新列表。ListView 不会自动执行此操作。这取决于您使用的适配器。

*   有一行将 View 投射到 ViewGroup，它出现了一些错误，所以我删除了投射没有任何问题，不需要它。（在 onInterceptTouchEvent 方法中）。

*   TouchInterceptor`mRemoveMode = 1;`的构造函数中的更改，或以下之一：`FLING = 0; SLIDE = 1; TRASH = 2;`。我认为对于`TRASH`，资源也应该可用。

实际上，我不是从答案的链接中获取文件，而是从我已经拥有的 Cyanogenmod 获取文件，但我猜这些文件是相同的。

这些是项目中的实际文件（在 r12，在撰写本文时）：

*   [使用此 ListView 的首选项](http://code.google.com/p/jlyr/source/browse/src/com/jlyr/preference/ProvidersPreference.java)
*   [带有侦听器和适配器的 ListActivity](http://code.google.com/p/jlyr/source/browse/src/com/jlyr/preference/JLyrSourceSelector.java)
*   [实际的 ListView](http://code.google.com/p/jlyr/source/browse/src/com/jlyr/preference/TouchInterceptor.java)

我希望它可以帮助别人:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T16:36:39.710

没有内置小部件可以执行此操作，但您可能需要查看 AOSP 音乐播放器使用的自定义实现，以允许对播放列表中的歌曲进行重新排序。

[TouchInterceptor.java](https://github.com/android/platform_packages_apps_music/blob/master/src/com/android/music/TouchInterceptor.java)

这是扩展 ListView 的类，负责处理所有 MotionEvents 并重新排序其项目，以及检测用于删除项目的滑动。[您可以在此处的TrackBrowserActivity.java](https://github.com/android/platform_packages_apps_music/blob/master/src/com/android/music/TrackBrowserActivity.java)类中看到它实现到一个活动中。

它具有您还应该注意的三个接口：DragListener、DropListener 和 RemoveListener。您可以使用这些接口为其提供回调以触发这些事件，以便您可以将对列表顺序所做的更改更新为 SavedPreferences（因为 ListView 不会为您处理）。

您可以轻松地扩展或修改 TouchInterceptor 类以添加额外的功能，因为低级的东西都为您准备好了。

# c# - 通过来自 SPListTemplateType 枚举的值获取 SPList

> ID：11123825
> 
> 赞同：1
> 
> 时间：2012-06-20T16:19:36.460
> 
> 标签：c#, sharepoint, sharepoint-2010

我正在从事 2009 年以来的一个较旧的项目，并且有类似的东西

```
SPList tasksList = web.Lists["Tasks"] 
```

用于获取`SPList`. 但由于语言问题，我们无法编写“任务”。

我想用[SPListTemplateType enumeration](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.splisttemplatetype.aspx)`107`甚至更好地替换“Tasks” ，例如

```
SPList tasksList = web.Lists[SPListTemplateType.Tasks]; 
```

哪个不起作用，因为`Lists`期望 a`GUID`但尚不清楚如何实现这一目标。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T16:33:53.123

您可以在 LINQ 查询中使用[BaseTemplate属性：](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.splist.basetemplate)

```
SPList tasksList = 
                 web.Lists
                    .Cast<SPList>()
                    .FirstOrDefault(list => list.BaseTemplate == SPListTemplateType.Tasks); 
```

# jquery-ui - jquery嵌套li点击事件多次调用

> ID：11123829
> 
> 赞同：5
> 
> 时间：2012-06-20T16:19:47.867
> 
> 标签：jquery-ui, jquery, jquery-plugins

我有以下结构。

```
<ul id="browser" class="filetree">

        <li><span class="folder">Folder 1</span>

            <ul>

                <li><span class="file">Item 1.1</span></li>

            </ul>

        </li>

        <li><span class="folder">Folder 2</span>

            <ul>

                <li><span class="folder">Subfolder 2.1</span>

                    <ul id="folder21">

                        <li><span class="file">File 2.1.1</span></li>

                        <li><span class="file">File 2.1.2</span></li>

                    </ul>

                </li>

                <li><span class="file">File 2.2</span></li>

            </ul>

        </li>

        <li class="closed"><span class="folder">Folder 3 (closed at start)</span>

            <ul>

                <li><span class="file">File 3.1</span></li>

            </ul>

        </li>

        <li><span class="file">File 4</span></li>

    </ul> 
```

在 js 中，我有以下功能。

```
$("#browser li").click(function(){

}); 
```

当我点击 li 文件 2.1.1\. 函数调用3次

第一次为 li 文件 2.1.1 ，第二次为 li 子文件夹 2.1 ，第三次为 li 文件夹 2 。

谁能给我一个解决方案来只调用一次函数？

非常感谢您的帮助。谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-20T16:21:30.807

**那是因为** 你`li`在`#broswer`.

试试这个：

```
$("#browser>li").click(function(){
    //only direct children of #browser
    //your code
}); 
```

或者您可以使用[`event.stopPropagation()`](http://api.jquery.com/event.stopPropagation/)：

```
$("#browser li").click(function(event){
    event.stopPropagation();
    //your code
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-20T16:22:32.470

将您的功能更改为

```
$("#browser li").click(function(event){
   event.stopPropagation();
   //do your other stuff

}); 
```

这样，对较低级别的点击就`li`不会“冒泡”到较高级别`li`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-20T16:22:49.627

这是由于事实事件“冒泡”了你的 dom，所以如果你点击

文件 2.1.1，文件 2.1 和文件 2 也将听到此更改事件以修复

```
$("#browser li").click(function(e){
  //Your code here
  e.stopPropagation();
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-04T02:18:29.610

与其在 li 对象上使用 click 事件，不如添加另一个元素（在示例 span 中）并在其中处理 click。这种方式仍然可以为更高的事件冒泡，只是不会通过嵌套的 li 冒泡。

```
//Run the following to see the no li bubble result 

$(".nobubble").on('click',function(){
    $("#result").append($(this).attr("data-id") +"<br />")
   });

//uncomment the following to see the li bubble result
/*$(".bubble").on('click',function(){
    $("#result").append($(this).attr("data-id") +"<br />")
   });*/
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<ul>
  <li class="bubble" data-id="li-a"><span  class="nobubble" data-id="span-a">a</span>
    <ul>
      <li class="bubble" data-id="li-b"><span class="nobubble" data-id="span-b">b</span>
      </li>
    </ul>
  </li>
</ul>

<div id="result">
</div>
```

# ajax - ajax请求是否需要进行重定向后获取？

> ID：11123830
> 
> 赞同：4
> 
> 时间：2012-06-20T16:19:53.120
> 
> 标签：ajax, http-post, idempotent

是否有任何理由将 post-redirect-get (prg) 用于您知道只会通过 ajax 请求发生的请求？

在这种情况下，您可能有一个发送的请求（通过 ajax 或直接），我们假设在后端我们可以区分哪个是哪个。在使用 prg 处理直接请求的情况下，是否有任何理由也使用 prg 处理*ajax*请求？

还是可以直接回复 ajax 帖子？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T16:28:42.177

对于只使用 AJAX 的东西，我看不出使用 prg 的理由。由于它不是用户控制的操作，可能会重复，因此 AJAX 调用被复制的唯一方法是在操作完成之前刷新原始页面，并且由于 prg 具有相同的缺陷，您不妨使用直接方法。

# c - 如何在 ARM 处理器上随机访问字对齐数据？

> ID：11123832
> 
> 赞同：1
> 
> 时间：2012-06-20T16:19:59.797
> 
> 标签：c, embedded, alignment, arm

至少达到 ARMv5 的 ARM CPU 不允许随机访问非字对齐的内存地址。问题在这里详细描述： [//lecs.cs.ucla.edu/wiki/index.php/XScale_alignment](http://lecs.cs.ucla.edu/wiki/index.php/XScale_alignment) - 一种解决方案是重写您的代码或首先考虑这种对齐方式。然而并没有说如何。给定一个字节流，其中我有 2 个或 4 个字节的整数，这些整数在流中不是字对齐的。如何在不损失太多性能的情况下以智能方式访问这些数据？

我有一个说明问题的代码片段：

```
#include <stdio.h>
#include <stdlib.h>

#define BUF_LEN 17

int main( int argc, char *argv[] ) {
    unsigned char   buf[BUF_LEN];
    int             i;
    unsigned short  *p_short;
    unsigned long   *p_long;

    /*  fill array  */
    (void) printf( "filling buffer:" );
    for ( i = 0; i < BUF_LEN; i++ ) {
        /* buf[i] = 1 << ( i % 8 ); */
        buf[i] = i;
        (void) printf( " %02hhX", buf[i] );
    }
    (void) printf( "\n" );

    /*  testing with short  */
    (void) printf( "accessing with short:" );
    for ( i = 0; i < BUF_LEN - sizeof(unsigned short); i++ ) {
        p_short = (unsigned short *) &buf[i];
        (void) printf( " %04hX", *p_short );
    }
    (void) printf( "\n" );

    /*  testing with long   */
    (void) printf( "accessing with long:" );
    for ( i = 0; i < BUF_LEN - sizeof(unsigned long); i++ ) {
        p_long = (unsigned long *) &buf[i];
        (void) printf( " %08lX", *p_long );
    }
    (void) printf( "\n" );

    return EXIT_SUCCESS;
} 
```

在 x86 CPU 上，这是输出：

```
filling buffer: 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F 10
accessing with short: 0100 0201 0302 0403 0504 0605 0706 0807 0908 0A09 0B0A 0C0B 0D0C 0E0D 0F0E
accessing with long: 03020100 04030201 05040302 06050403 07060504 08070605 09080706 0A090807 0B0A0908 0C0B0A09 0D0C0B0A 0E0D0C0B 0F0E0D0C 
```

在 ATMEL AT91SAM9G20 ARMv5 内核上，我得到了（注意：这是这个 CPU 的预期行为！）：

```
filling buffer: 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F 10
accessing with short: 0100 0100 0302 0302 0504 0504 0706 0706 0908 0908 0B0A 0B0A 0D0C 0D0C 0F0E
accessing with long: 03020100 00030201 01000302 02010003 07060504 04070605 05040706 06050407 0B0A0908 080B0A09 09080B0A 0A09080B 0F0E0D0C 
```

因此，鉴于我想要或必须访问未对齐地址的字节流：我将如何在 ARM 上有效地做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T17:11:17.900

您编写自己的打包/解包函数，在对齐的变量和未对齐的字节流之间进行转换。例如，

```
void unpack_uint32(uint8_t* unaligned_stream, uint32_t* aligned_var)
{
  // copy byte-by-byte from stream to var, you can fill in the details
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T20:51:15.007

您的示例将演示任何平台上的问题。当然是简单的修复：

```
unsigned char   *buf;
int             i;
unsigned short  *p_short;
unsigned long   p_long[BUF_LEN>>2]; 
```

如果您不能以更好的对齐方式组织数据（更多的字节有时可以等于更好的性能），那么做显而易见的事情并将所有内容都处理为 32 位并从那里切掉部分，优化器将为短裤和一个单词中的字节（实际上包括结构中的字节和short，无论是结构还是从内存中挑选的字节，可能会更昂贵，因为与将所有内容都作为单词传递相比，会有额外的指令，您必须进行系统工程）。

提取未对齐单词的示例。（当然必须管理你的字节序）

```
a = (lptr[offset]<<16)|(lptr[offset+1]>>16); 
```

从 armv4 到现在的所有 arm 内核都允许非对齐访问，大多数默认情况下都打开了异常，但您可以将其关闭。现在较旧的在单词内旋转，但如果我没记错的话，其他人可以抓住其他字节通道。

进行系统工程，进行性能分析，并确定将所有内容作为单词移动是更快还是更慢。数据的实际移动会产生一些开销，但如果一切都对齐，两边的代码会运行得更快。您是否可以忍受一些 X 倍的数据移动速度，以使该数据的生成和接收速度提高 2 到 4 倍？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T22:27:53.647

此函数始终使用对齐的 32 位访问：

```
uint32_t fetch_unaligned_uint32 (uint8_t *unaligned_stream)
{
    switch (((uint32_t )unaligned_stream) & 3u)
    {
        case 3u:
            return ((*(uint32_t *)unaligned_stream[-3]) << 24)
                 | ((*(uint32_t *)unaligned_stream[ 1]) & 0xffffffu);
        case 2u:
            return ((*(uint32_t *)unaligned_stream[-2]) << 16)
                 | ((*(uint32_t *)unaligned_stream[ 2]) & 0x00ffffu);
        case 1u:
            return ((*(uint32_t *)unaligned_stream[-1]) <<  8)
                 | ((*(uint32_t *)unaligned_stream[ 3]) & 0x0000ffu);
        case 0u:
        default:
            return *(uint32_t *)unaligned_stream;
    }
} 
```

它可能比分别读取和移动所有 4 个字节要快。

# xml - 解析特殊字符时出现 IllegalDataException

> ID：11123833
> 
> 赞同：1
> 
> 时间：2012-06-20T16:20:11.687
> 
> 标签：xml, encoding, jdom

我的网络应用程序中有一个输入框，如果我输入以下输入：

**字符ʃƪ**

在服务器端，当我尝试使用 Jdom 构建 xml 文档时，它会崩溃并引发以下异常：

**org.jdom.IllegalDataException：数据“char (3A”对于 JDOM 属性是不合法的：0x1a 不是合法的 XML 字符。**

```
 at org.jdom.Attribute.setValue(Attribute.java:491)      
     at org.jdom.Attribute.<init>(Attribute.java:228)
     at org.jdom.Attribute.<init>(Attribute.java:251)
     at org.jdom.Element.setAttribute(Element.java:1128) 
```

这就是浏览器对 ajax 调用进行编码的方式... **&MESSAGE=char%20(3%1AA**

在服务器端，当我执行 **pRequest.getParameter("MESSAGE");** 它返回给我：“ **char (3A** ”

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T16:37:19.067

它现在正在工作。

我从jQuery插件URLEncode切换到原生javascript函数：

```
encodeURIComponent() 
```

此外，我发现在 ajax 调用中您可以指定 contentType

```
contentType: "application/x-www-form-urlencoded; charset=UTF-8" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T10:35:58.600

正如@rolfl 所怀疑的那样，您的浏览器中有些东西非常奇怪。你在用什么？

如果我们做一些 Unicode 和编码检测工作，我们可以得到关于可能发生的事情的提示。

假设您正在尝试输入这些字符：

*   ʃ, Unicode U+0283（拉丁文小写字母 esh）
*   ƪ，Unicode U+01AA（拉丁字母反转 esh 循环）

我们可以看到浏览器编码源于这两个字符的 unicode 代码点：

*   (, 在 ascii 字符集中恰好是 28
*   3个，剩下的3个
*   %1A, 1A 不是合法的 URL 字符，所以它被编码
*   A，剩下的A

它是您正在使用的一些 ajax javascript 库吗？也许是时候切换了？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T17:04:07.923

XML 1.0 规范不允许使用字符 0x1a ......永远。它*不是*一个 unicode 字符

[http://www.w3.org/TR/2008/PER-xml-20080205/#charsets](http://www.w3.org/TR/2008/PER-xml-20080205/#charsets)

XML 1.1 规范*确实*允许 0x1a 字符，我看到：[http ://www.w3.org/TR/2004/REC-xml11-20040204/#NT-Char](http://www.w3.org/TR/2004/REC-xml11-20040204/#NT-Char)

不过三件事：

*   JDOM 1.x（和 2.x）将拒绝非 XML1.0 字符。
*   即使在 XML 1.1 中， 0x1a 字符也是“受限制的”（我还不能 100% 确定这意味着什么，我正在调查）。
*   您确定*要*使用“替换”字符 (0x1a)

不管上述情况如何，我怀疑您在输入框和 JDOM setAttribute(...) 调用之间的代码中存在问题。这些地方之间是否有一些东西正在改变字符编码、序列化或以其他方式改变输入值？我怀疑在调用 JDOM 之前还会发生一些其他问题，这会改变数据，因为您不太可能真的试图将 char 0x1a 作为 XML 字符加载。

# javascript - 通过属性值获取数组中的下一个对象？

> ID：11123835
> 
> 赞同：10
> 
> 时间：2012-06-20T16:20:13.603
> 
> 标签：javascript, jquery

## 背景

我定义并设置了一组对象（用户），如下所示：

```
// object definition
function Users()
{
  this.Id = null;
  this.Name = null;
  this.FirstName = null;
  this.LastName = null;
  this.IsActive = null;
  this.Title = null;
  this.index = null;
  this.selected = null;
}

// object array
var AllUsers = [];

// ...
// an ajax call retrieves the Users and adds them to the AllUsers array
// ... 
```

每个用户的索引值设置为检索它们的顺序。一旦检索到用户，就可以一个一个地选择它们，并将它们从列表移动到页面上的表中。选择后，该`selected`属性设置为 true，用于数组中的选定对象。

我正在使用 grep 返回所有选定的用户。

```
var SelectedUsers = $.grep(AllUsers,function(obj){
  return obj["selected"] == true;
}); 
```

以下是返回数据的示例：

```
[ 
  Object { 
    Id="00540000001AbCdEFG", 
    Name="First Last1", 
    FirstName="First", 
    LastName="Last1", 
    Title="Title", 
    index=56, 
    selected=true 
  },
  Object { 
    Id="00540000001AbChIJK", 
    Name="First Last2", 
    FirstName="First", 
    LastName="Last2", 
    Title="Title", 
    index=12, 
    selected=true 
  },
  Object { 
    Id="00540000001AbClMNO", 
    Name="First Last3", 
    FirstName="First", 
    LastName="Last3", 
    Title="Title", 
    index=92, 
    selected=true 
  }
] 
```

## 问题

我希望能够对数据进行分页，为此，我需要能够按索引获取下一个和上一个选定的用户。我怎样才能做到这一点？

例如，如果我在表中打开第一个选定用户（索引 = 56），我怎样才能获得具有下一个索引的用户（索引 = 92 的第三个选定用户）？

[JSFiddle](http://jsfiddle.net/MatthewKeefe/2VdUZ/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T16:26:02.147

为什么不按索引对数组进行排序？

```
allUsers.sort(function(a, b) {
    return(a.index - b.index);
}); 
```

然后，下一个选定的用户将是数组中被选中的下一个用户。您可以沿着阵列向上走，直到找到选定的用户。

或者，您可以使用 grep 函数来获取所有选定的用户，然后按索引对其进行排序，这样下一个选定的用户就是 selectedUsers 数组中的下一个用户，如下所示：

```
var SelectedUsers = j$.grep(AllUsers,function(obj){
  return obj["selected"] == true;
}).sort(function(a, b) {
    return(a.index - b.index);
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-20T16:28:55.687

小提琴：http: [//jsfiddle.net/iambriansreed/KEXwM/](http://jsfiddle.net/iambriansreed/KEXwM/)

添加了 JavaScript：

```
SelectedUsers.sort(function(a,b){
      return a.index == b.index ? 0 : (a.index < b.index ? -1 : 1)}); 
```

如果您不想修改原始`SelectedUsers`数组，则将排序定义为新变量：

```
var SortedSelectedUsers = SelectedUsers.slice(0);
SortedSelectedUsers.sort(function(a,b){
      return a.index == b.index ? 0 : (a.index < b.index ? -1 : 1)}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-20T16:34:14.153

按索引实现自己的排序功能：

```
function compareUsers(a,b)
{
    return (a.index - b.index);
} 
```

并对对象进行排序：

```
SelectedUsers.sort(compareUsers); 
```

现在您拥有正确顺序的所有索引。由此，很容易通过索引号获取后面或前面的对象。

# sharepoint - InfoPath 2010 属性提升在 SharePoint 2010 中创建列，但不会将表单数据保存到其中

> ID：11123836
> 
> 赞同：0
> 
> 时间：2012-06-20T16:20:15.023
> 
> 标签：sharepoint, sharepoint-2010, infopath, infopath2010, infopath-forms-services

我有一个发布到 SharePoint 2010 表单库的 InfoPath 2010 表单。填写并提交表单后，将保存表单，但字段数据不会填充 InfoPath 使用属性提升创建的列。

知道我可能做错了什么吗？

谢谢，乔恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:59:46.543

检查重复项 - 打开列表设置页面并通过单击“编辑”检查列内部名称，然后检查浏览器地址栏中的名称。

# asp.net - 在高流量场景中使用 Dapper.Net 时打开 DataReader 问题 - 现在要解决吗？

> ID：11123839
> 
> 赞同：2
> 
> 时间：2012-06-20T16:20:18.940
> 
> 标签：asp.net, c#-4.0, datareader, dapper, dbdatareader

下面是使用 Dapper.Net 在 DAL 中调用数据的示例：

```
 /// <summary>
    /// Handles db connectivity as Dapper assumes an existing connection for all functions
    /// Since the app uses three databases, pass in the connection string for the required db.
    /// </summary>
    /// <returns></returns>
    protected static IDbConnection OpenConnection(string connectionStringName)
    {
        try
        {
            connection = new SqlConnection(WebConfigurationManager.ConnectionStrings[connectionStringName].ConnectionString);
            //connection = SqlMapperUtil.GetOpenConnection(connectionStringName);       // if we want to use the Dapper utility methods
            //connection = new SqlConnection(connectionString);
            connection.Open();
            return connection;
        }
        catch (Exception ex)
        {
            ErrorLogging.Instance.Fatal(ex);        // uses singleton for logging
            return null;
        }
    }

    public string GetNickname(int profileID)
    {
        string nickname = string.Empty;

        using (IDbConnection connection = OpenConnection("PrimaryDBConnectionString"))
        {
            try
            {
                var sp_nickname = connection.Query<string>("sq_mobile_nickname_get_by_profileid", new { profileID = profileID }, commandType: CommandType.StoredProcedure);
                nickname = sp_nickname.First<string>();
            }
            catch (Exception ex)
            {
                ErrorLogging.Instance.Fatal(ex);
                return null;
            }
        }

        return nickname;
    } 
```

我们看到的一致错误如下：

> 2012-06-20 11:42:44.8903|致命|已经有一个打开的 DataReader 与此命令关联，必须先关闭。| 在 System.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand 命令) 在 System.Data.SqlClient.SqlConnection.ValidateConnectionForExecute(String 方法，SqlCommand 命令) 在 System.Data.SqlClient.SqlCommand.ValidateCommand(String 方法，布尔异步) 在 System System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result) at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method) 在系统。 Data.SqlClient.SqlCommand.ExecuteReader（CommandBehavior 行为，
> 在 MyApp.DAL.DapperORM.SqlMapper.d_ *13 `1.MoveNext() in C:\Projects\Git\MyApp\MyApp.DAL\MyApp.DAL.MyAppPrimary.Repositories\Dapper\SqlMapper.cs:line 581 at System.Collections.Generic.List`1..ctor(IEnumerable `1 collection) at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 源) 在 MyApp.DAL.DapperORM.SqlMapper.Query[T](IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable `1 commandTimeout, Nullable`1 commandType) 在 C:\Projects\Git\MyApp\MyApp.DAL\MyApp.DAL.MyAppPrimary.Repositories\Dapper\SqlMapper.cs:C 中 MyApp.DAL.Repositories.MemberRepository.AddNotificationEntry(NewsfeedNotification notificationEntry) 的第 538 行： \Projects\Git\MyApp\MyApp.DAL\MyApp.DAL.MyAppPrimary.Repositories\MemberRepositories\MemberRepository.cs:line 465 2012-06-20 11:42:45.2491|致命|当阅读器关闭时调用读取无效。 | 在 System.Data.SqlClient.SqlDataReader.ReadInternal（布尔 setTimeout）
> 在 System.Data.SqlClient.SqlDataReader.Read() 在 MyApp.DAL.DapperORM.SqlMapper.d* _13 `1.MoveNext() in C:\Projects\Git\MyApp\MyApp.DAL\MyApp.DAL.MyAppPrimary.Repositories\Dapper\SqlMapper.cs:line 597 at System.Collections.Generic.List`1..ctor(IEnumerable `1 collection) at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 源) 在 MyApp.DAL.DapperORM.SqlMapper.Query[T](IDbConnection cnn, String C:\Projects\Git\MyApp\MyApp.DAL\MyApp.DAL.MyAppPrimary.Repositories\Dapper\SqlMapper.cs 中的sql、对象参数、IDbTransaction 事务、布尔缓冲、可空`1 commandTimeout, Nullable`1 命令类型）：MyApp.DAL 的第 538 行。 DapperORM.SqlMapper.Query(IDbConnection cnn, String sql, Object param, IDbTransaction transaction, Boolean buffered, Nullable`1 commandTimeout, Nullable`1 commandType) 在 C:\Projects\Git\MyApp\MyApp.DAL\MyApp.DAL.MyAppPrimary.Repositories\Dapper\SqlMapper.cs:C 中 MyApp.DAL.Repositories.MemberRepository.GetBuddies(Int32 profileID) 的第 518 行： \Projects\Git\MyApp\MyApp.DAL\MyApp.DAL.MyAppPrimary.Repositories\MemberRepositories\MemberRepository.cs:line 271 2012-06-20 11:43:01.2392|致命|序列不包含元素| 在 System.Linq.Enumerable.First[TSource](IEnumerable`1 源) 在 C:\Projects\Git\MyApp\MyApp.DAL\MyApp.DAL.MyAppPrimary 中的 MyApp.DAL.Repositories.MemberRepository.GetNickname(Int32 profileID) .Repositories\MemberRepositories\MemberRepository.cs：第 337 行

最初我将退货放在里面`using {...}`并将它们移到`using`街区外，但仍然遇到同样的问题。

这是一个高流量的应用程序，所以在测试这个问题直到我们上线后才真正出现。

对于使用 Dapper 进行 DataReader 管理，这里还有其他事情要做吗？

**- - - 更新 - - -**

我应该早点发布这个，但现在才添加这个。

Dapper.Net 的第 581 行包含`ExecuteReader()`代码：

```
 private static IEnumerable<T> QueryInternal<T>(this IDbConnection cnn, string sql, object param, IDbTransaction transaction, int? commandTimeout, CommandType? commandType)
    {
        var identity = new Identity(sql, commandType, cnn, typeof(T), param == null ? null : param.GetType(), null);
        var info = GetCacheInfo(identity);

        using (var cmd = SetupCommand(cnn, transaction, sql, info.ParamReader, param, commandTimeout, commandType))
        {
            using (var reader = cmd.ExecuteReader())
            {
                Func<Func<IDataReader, object>> cacheDeserializer =  () =>
                {
                    info.Deserializer = GetDeserializer(typeof(T), reader, 0, -1, false);
                    SetQueryCache(identity, info);
                    return info.Deserializer;
                };

                if (info.Deserializer == null)
                {
                    cacheDeserializer();
                }

                var deserializer = info.Deserializer;

                while (reader.Read())
                {
                    object next;
                    try
                    {
                        next = deserializer(reader);
                    }
                    catch (DataException)
                    {
                        // give it another shot, in case the underlying schema changed
                        deserializer = cacheDeserializer();
                        next = deserializer(reader);
                    }
                    yield return (T)next;
                }

            }
        } 
```

...在嵌套`using`代码中看到它？我想知道是否由于`yield return (T)next;`while 内部的代码，嵌套的内部`using`，是否会导致问题。

问题是，在流量适中的情况下，Dapper 似乎运行良好。然而，在一个每秒大约有 1000 个请求的系统中，它似乎会出错。

我想这对于 Dapper 开发者来说更​​像是一个仅供参考，并且想知道他们是否可以解决这个问题。

（我意识到我在代码中错过了命名 DapperORM - 它不是 ORM）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T13:41:33.310

您只读取数据读取器的第一行，因此如果有不止一行，它永远不会关闭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T15:14:24.207

我使用 Entity Framework 来生成我的类，因此并为 DAL 访问创建了一个不同的存储库 - 而不是使用 Dapper，我只是重写了访问代码以使用 Entity Framework。`using`与 EF 连接字符串和在我的语句中使用 EF 数据库上下文没有什么不同。

这一切都很好。

根据我的阅读，Dapper 非常快，这就是我最初为我的 DAL 选择它的原因。但是，它似乎在高频交易环境中有其局限性。也许 Dapper 团队可以澄清这一点，以防我遗漏了某些东西或错误地实施了某些东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-17T18:58:19.767

Ladislav Mrnka 对类似问题的回答更有意义：

> 如果您在迭代另一个查询的结果时执行查询，则可能会发生这种情况......可能导致这种情况的一件事是在迭代某些查询的结果时触发延迟加载。这可以通过在连接字符串中允许 MARS 轻松解决。将 MultipleActiveResultSets=true 添加到连接字符串的提供者部分（其中指定了数据源、初始目录等）。

[https://stackoverflow.com/a/6064422/1681490](https://stackoverflow.com/a/6064422/1681490)

有关火星的更多信息：http: [//msdn.microsoft.com/en-us/library/h32h3abf (v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/h32h3abf(v=vs.100).aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-07-30T19:55:02.120

聚会有点晚了，但它可能会帮助像我一样被卡住的人。

问题是 Dapper “Query” 方法返回的 IEnumerable 实际上是使用 “yield return” 语句来生成结果集的迭代器：

```
// From Dapper SqlMapper.cs QueryImpl function:
            while (reader.Read())
            {
                object val = func(reader);
                if (val == null || val is T)
                {
                    yield return (T)val;
                }
                else
                {
                    yield return (T)Convert.ChangeType(val, convertToType, CultureInfo.InvariantCulture);
                }
            } 
```

关闭 DataReader 的部分稍后发生。因此，如果您不遍历整个结果集并尝试查询另一个请求，您将收到“已经有一个打开的 DataReader 与此命令关联，必须先关闭”错误。

# c# - WebClient and callback function

> ID：11123851
> 
> 赞同：0
> 
> 时间：2012-06-20T16:21:03.043
> 
> 标签：c#, asp.net, silverlight, silverlight-4.0

I am developing a Silverlight custom control where I am sending some XML data to my server using WebClient. After the file is uploaded I need to run a callback function. So, the question is how do I know it is done uploading the file? Here is the code I wrote:

```
WebClient wc = new WebClient();
wc.OpenWriteCompleted += new OpenWriteCompletedEventHandler(wc_OpenWriteCompleted);
Uri uri = new Uri(myUrl);
wc.OpenWriteAsync(uri, "POST", data);

...

private void wc_OpenWriteCompleted(object sender, OpenWriteCompletedEventArgs e){

        if (e.Error == null)
        {

            byte[] fileContent = e.UserState as byte[];

            Stream outputStream = e.Result;

            outputStream.Write(fileContent, 0, fileContent.Length);
            outputStream.Flush();
            outputStream.Close();                
        }

        HtmlPage.Window.Invoke("callBackFunction");

    } 
```

That all looked good to me but there are two problems. One I am not sure that wc_OpenWriteCompleted is actually running when the file is done uploading. How do I confirm that? The call back function, if the file is not complete it is not going to do anything. Is that the right place to put that call back? Last, the server responds with some test after the call is placed, how can I pass that to my callback function?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T18:45:25.730

You can try by creating the service request.

```
HttpWebRequest request = (HttpWebRequest)WebRequest.Create(new Uri(SessionConstants.serviceURL, UriKind.Absolute));
request.Method = "POST";
request.ContentType = "application/x-www-form-urlencoded";
request.BeginGetRequestStream(new AsyncCallback(ObjectListRequestReady), request); 
```

Then Send the service request to the server for upload the file.

```
void ObjectListRequestReady(IAsyncResult asyncResult)
{

     HttpWebRequest request = asyncResult.AsyncState as HttpWebRequest;
     Stream stream = request.EndGetRequestStream(asyncResult);

     Deployment.Current.Dispatcher.BeginInvoke(delegate()
     {
            SELECTED_NODE = SPSITETextBox.Text;
            StreamWriter writer = new StreamWriter(stream);
            writer.WriteLine("pass your data to upload on server");
            writer.Flush();
            writer.Close();
            request.BeginGetResponse(new AsyncCallback(ObjectListResponseReady), request);

            // ObjectListResponseReady is the callback method called after uploading the data.
      });
} 
```

Get the Result from the service. `ObjectListResponseReady` is the callback method which ack you after uploading the file.

```
void ObjectListResponseReady(IAsyncResult asyncResult)
{
        try
        {
            HttpWebRequest request = asyncResult.AsyncState as HttpWebRequest;
            HttpWebResponse response = (HttpWebResponse)request.EndGetResponse(asyncResult);

            Deployment.Current.Dispatcher.BeginInvoke(delegate()
            {
                Stream responseStream = response.GetResponseStream();
                XmlReader xmlReader = XmlReader.Create(responseStream);
            });
            }

        catch (Exception ex)
        {
            Message.ErrorMessage("error: " + ex);
        }
} 
```

# iphone - 如何在另一个方法中调用一个方法

> ID：11123861
> 
> 赞同：0
> 
> 时间：2012-06-20T16:21:23.103
> 
> 标签：iphone

我将 resumeLayer 和 PauseLayer 方法定义放在 h 文件中的 @interface 和 @end 块中。

```
@interface MainViewController : UIViewController

@property (nonatomic, retain) UIToolbar *toolbar;
@property (strong)AVAudioPlayer *audioPlayer;
@property (nonatomic, retain) NSTimer * timer;

- (void)resumeLayer:(CALayer *)layer;
- (void)pauseLayer:(CALayer *)layer;

@end 
```

m 文件中的方法

```
-(void)pauseLayer:(CALayer*)layer
{
  CFTimeInterval pausedTime = [layer convertTime:CACurrentMediaTime() fromLayer:nil];
  layer.speed = 0.0;
  layer.timeOffset = pausedTime;
}

-(void)resumeLayer:(CALayer*)layer
{
  CFTimeInterval pausedTime = [layer timeOffset];
  layer.speed = 1.0;
  layer.timeOffset = 0.0;
  layer.beginTime = 0.0;
  CFTimeInterval timeSincePause = [layer convertTime:CACurrentMediaTime() fromLayer:nil] - pausedTime;
  layer.beginTime = timeSincePause;
 } 
```

现在想**在 PlayPauseAction 方法中调用 resumeLayer 和 PauseLayer 方法**

```
-(void)playpauseAction:(id)sender {

if([audioPlayer isPlaying])
{
    [sender setImage:[UIImage imageNamed:@"Play Icon.png"] forState:UIControlStateSelected];
    [audioPlayer pause];
    [self pauseTimer];
    [self pauseLayer: CALayer];

}
else
{
    [sender setImage:[UIImage imageNamed:@"pause.png"] forState:UIControlStateNormal];
    [audioPlayer play];
    [self resumeTimer];

if(isFirstTime == YES)
    {
        self.timer = [NSTimer scheduledTimerWithTimeInterval:11.0
                                                      target:self
                                                    selector:@selector(displayviewsAction:)
                                                    userInfo:nil
                                                     repeats:NO];
        isFirstTime  = NO;
    }
   } 
  } 
```

现在当我打电话

```
[self PauseLayer:CALayer]; 
```

&

```
[self resumeLayer:CALayer]; 
```

得到红色消息`unexpected interface name CALayer expected expression`。

任何人都可以请告诉如何在方法中调用`PauseLayer`和`resumeLayer`方法`playpauseAction`。

感谢帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T17:04:50.850

当您可以使用您的方法时，您需要立即而不是上课..

所以不要这样称呼它

```
[self PauseLayer:CALayer]; 
```

做类似的事情

```
[self PauseLayer:(UIButton*)sender.layer]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T17:37:57.327

这行没有意义：

```
[self pauseLayer:CALayer]; 
```

因为 CALayer 是一个类。编译器希望您发送一个 CALayer 类型的对象。您需要执行以下操作：

```
//Get a reference to your UIImageView somehow
UIImageView *myImageView = [yourOtherClass getTheImageView];

[self pauseLayer:myImageView.layer]; // Pause the CALayer of the UIImageView 
```

为了解释原因，与这段代码相比，假设您有一个类似这样的方法，可以将 NSNumber 中的数字添加到存储在类中的 int“totalValue”：

```
/** Adds the number to totalValue **/
-(int)addNumber:(NSNumber)number {
    totalValue = totalValue + [number intValue]; 

    return totalValue;
} 
```

调用此方法的正确方法例如是：

```
// Store the value 10 into an NSNumber
NSNumber *numberToAdd = [NSNumber numberWithInt:10];
[self addNumber:numberToAdd]; // Add number 10 to totalValue 
```

但这是你想要做的：

```
[self addNumber:NSNumber]; // WRONG, 'NSNumber' is not a value! 
```

编译器抱怨是因为 CALayer 不是一个值，就像 NSNumber 不是一个值一样。你不能做像 10 + NSNumber 这样的操作。上面的代码需要一个对象，一个 NSNumber 类的实例，而不是对 NSNumber 类本身的引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T16:29:37.867

尝试更改 P on -(void)pauseLayer:(CALayer*)layer {

大写或周围的方式。

# maven - 如何获取 Maven 程序集插件来复制工件？

> ID：11123862
> 
> 赞同：2
> 
> 时间：2012-06-20T16:21:25.293
> 
> 标签：maven, maven-assembly-plugin

我有一个 Maven 汇编脚本，它复制资源来构建我们的应用程序。我需要将一些战争文件从单独的外部项目复制到输出中的 /webapps 目录中。似乎找不到执行此操作的魔术命令。

我尝试使用`<include com.mygroup:mywarfile>`. 如果我在项目中添加“mywarfile”作为战争依赖项，并且具有编译或运行时的范围，这将起作用。不幸的是，我的项目产生了一场战争，而 maven-war-plugin 包含外部 mywarfile 作为覆盖，这是我不想要的。

如果我将外部战争依赖项的范围设置为提供或测试，则程序集将失败并显示警告：

[警告] 在此工件包含过滤器中从未触发以下模式：“com.mygroup:mywarfile”

我要做的就是让程序集将一个工件从我的本地存储库复制到程序集输出。如何在不弄乱项目其他部分的情况下做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T16:44:48.360

The maven-assembly-plugin is not intended for copying. The better way to copy dependencies is the [maven-dependency-plugin](http://maven.apache.org/plugins/maven-dependency-plugin) which can copy dependencies etc. If you a talking about deployment into Tomcat etc. than you should take a deeper look into [carg2-maven-plugin](http://cargo.codehaus.org/Maven2+plugin) or the [tomcat-maven-plugin](http://tomcat.apache.org/maven-plugin.html) which seemed to be more appropriate for that task.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T06:18:48.200

我还没有尝试过，但是您可以尝试使用配置的`exclude`功能将依赖的war文件的内容排除在您的war项目中。[覆盖](http://maven.apache.org/plugins/maven-war-plugin/overlays.html)文档的修改片段，`overlay``maven war plugin`

```
...
  <build>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-war-plugin</artifactId>
        <version>2.2</version>
        <configuration>
          <overlays>
            <overlay>
              <groupId>com.example.projects</groupId>
              <artifactId>warToBeExcluded</artifactId>
              <excludes>
                <exclude>*</exclude>
              </excludes>
            </overlay>
          </overlays>
        </configuration>
      </plugin>
    </plugins>
  </build>
... 
```

# java - Java regEx URL 匹配问题

> ID：11123864
> 
> 赞同：0
> 
> 时间：2012-06-20T16:21:31.243
> 
> 标签：java, regex

和往常一样提前谢谢你。

我正在尝试熟悉 regEx，但遇到了与 URL 匹配的问题。

这是一个示例网址：

```
www.examplesite.com/dir/2012/06/19/title-of-some-story/FAQKZjC3veXSalP9zxFgZP/htmlpage.html 
```

这是我的正则表达式分解的样子：

```
[site]/[dir]*?/[year]/[month]/[day]/[storyTitle]?/[id]/htmlpage.html 
```

the`[id]`是一个长度为 22 个字符的字符串，可以是大写或小写字母，也可以是数字。但是，我不想从 URL 中提取它。只是澄清

现在，我需要从这个 url 中提取两个值。

首先，我需要提取目录。但是，`[dir]`是可选的，也可以是任意多的。换句话说，该参数不能存在，或者它可能是`dir1/dir2/dir3` ..etc 。所以，离开我的第一个例子：

```
 www.examplesite.com/dir1/dir2/dir3/2012/06/19/title-of-some-story/FAQKZjC3veXSalP9zxFgZP/htmlpage.html 
```

在这里，我需要提取`dir1/dir2/dir3`dir 是一个字符串，该字符串是一个包含所有小写字母的单词（即sports/mlb/games）。目录中没有数字，仅以此为例。

但在这个有效 URL 的示例中：

```
www.examplesite.com/2012/06/19/title-of-some-story/FAQKZjC3veXSalP9zxFgZP/htmlpage.html 
```

没有`[dir]`，所以我不会提取任何东西。因此，这`[dir]`是可选的

其次，我需要像上面一样提取`[storyTitle]`where`[storyTitle]`也是可选的`[dir]`，但是如果有 a`storyTitle`则只能有一个。

所以离开我之前的例子

```
www.examplesite.com/dir/2012/06/19/title-of-some-story/FAQKZjC3veXSalP9zxFgZP/htmlpage.html 
```

在我需要提取`'title-of-some-story'`故事标题是破折号分隔的字符串的地方是有效的，这些字符串总是小写的。下面的例子也是有效的：

```
www.examplesite.com/dir/2012/06/19/FAQKZjC3veXSalP9zxFgZP/htmlpage.html 
```

在上面的例子中，没有`[storyTitle]`因此使它成为可选的

最后，为了彻底，没有 a`[dir]`和没有 a的 URL`[storyTitle]`也是有效的。例子：

```
www.examplesite.com/2012/06/19/FAQKZjC3veXSalP9zxFgZP/htmlpage.html 
```

是一个有效的 URL。任何输入都会有所帮助，我希望我很清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:45:36.520

这是一个可行的示例。

```
public static void main(String[] args) {

    Pattern p = Pattern.compile("(?:http://)?.+?(/.+?)?/\\d+/\\d{2}/\\d{2}(/.+?)?/\\w{22}");

    String[] strings ={
            "www.examplesite.com/dir1/dir2/4444/2012/06/19/title-of-some-story/FAQKZjC3veXSalP9zxFgZP/htmlpage.html",
            "www.examplesite.com/2012/06/19/title-of-some-story/FAQKZjC3veXSalP9zxFgZP/htmlpage.html",
            "www.examplesite.com/dir/2012/06/19/title-of-some-story/FAQKZjC3veXSalP9zxFgZP/htmlpage.html",
            "www.examplesite.com/dir/2012/06/19/FAQKZjC3veXSalP9zxFgZP/htmlpage.html",
            "www.examplesite.com/2012/06/19/FAQKZjC3veXSalP9zxFgZP/htmlpage.html"
    };
    for (int idx = 0; idx < strings.length; idx++) {
        Matcher m = p.matcher(strings[idx]);
        if (m.find()) {
            String dir = m.group(1);
            String title = m.group(2);
            if (title != null) {
                title = title.substring(1); // remove the leading /
            }
            System.out.println(idx+": Dir: "+dir+", Title: "+title);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T17:25:47.897

这是一个全正则表达式解决方案。

**编辑：**允许 http://

**Java源码：**

```
import java.util.*;
import java.lang.*;
import java.util.regex.*;

class Main
{
    public static void main (String[] args) throws java.lang.Exception
    {
        String url = "http://www.examplesite.com/dir/2012/06/19/title-of-some-story/FAQKZjC3veXSalP9zxFgZP/htmlpage.html";
        String url2 = "www.examplesite.com/dir/dir2/dir3/2012/06/19/FAQKZjC3veXSalP9zxFgZP/htmlpage.html";
        String url3 = "www.examplesite.com/2012/06/19/title-of-some-story/FAQKZjC3veXSalP9zxFgZP/htmlpage.html";

        String patternStr = "(?:http://)?[^/]*[/]?([\\S]*)/[\\d]{4}/[\\d]{2}/[\\d]{2}[/]?([\\S]*)/[\\S]*/[\\S]*";

        // Compile regular expression
        Pattern pattern = Pattern.compile(patternStr);

        // Match 1st url
        System.out.println("Match 1st URL:");
        Matcher matcher = pattern.matcher(url);

        if (matcher.find()) {
            System.out.println("URL: " + matcher.group(0));
            System.out.println("DIR: " + matcher.group(1));
            System.out.println("TITLE: " + matcher.group(2));
        }
        else{ System.out.println("No match."); }

        // Match 2nd url
        System.out.println("\nMatch 2nd URL:");
        matcher = pattern.matcher(url2);

        if (matcher.find()) {
            System.out.println("URL: " + matcher.group(0));
            System.out.println("DIR: " + matcher.group(1));
            System.out.println("TITLE: " + matcher.group(2));
        }
        else{ System.out.println("No match."); }

        // Match 3rd url
        System.out.println("\nMatch 3rd URL:");
        matcher = pattern.matcher(url3);

        if (matcher.find()) {
            System.out.println("URL: " + matcher.group(0));
            System.out.println("DIR: " + matcher.group(1));
            System.out.println("TITLE: " + matcher.group(2));
        }
        else{ System.out.println("No match."); }
    }
} 
```

**输出：**

```
Match 1st URL:
URL: http://www.examplesite.com/dir/2012/06/19/title-of-some-story/FAQKZjC3veXSalP9zxFgZP/htmlpage.html
DIR: dir
TITLE: title-of-some-story

Match 2nd URL:
URL: www.examplesite.com/dir/dir2/dir3/2012/06/19/FAQKZjC3veXSalP9zxFgZP/htmlpage.html
DIR: dir/dir2/dir3
TITLE: 

Match 3rd URL:
URL: www.examplesite.com/2012/06/19/title-of-some-story/FAQKZjC3veXSalP9zxFgZP/htmlpage.html
DIR: 
TITLE: title-of-some-story 
```

# string - 格式化 Go 字符串而不打印？

> ID：11123865
> 
> 赞同：479
> 
> 时间：2012-06-20T16:21:34.830
> 
> 标签：string, go, formatting, string-formatting

有没有一种简单的方法可以在不打印字符串的情况下在 Go 中格式化字符串？

我可以：

```
bar := "bar"
fmt.Printf("foo: %s", bar) 
```

但我希望返回格式化的字符串而不是打印出来，这样我就可以进一步操作它。

我也可以做类似的事情：

```
s := "foo: " + bar 
```

但是当格式字符串很复杂时，这变得难以阅读，并且当一个或多个部分不是字符串并且必须首先转换时很麻烦，比如

```
i := 25
s := "foo: " + strconv.Itoa(i) 
```

有没有更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：603
> 
> 时间：2012-06-20T16:43:59.803

[Sprintf](https://golang.org/pkg/fmt/#Sprintf)是您正在寻找的。

**例子**

```
fmt.Sprintf("foo: %s", bar) 
```

您还可以在“A Tour of Go”的[错误示例中看到它的使用情况。](https://tour.golang.org/methods/19)

```
return fmt.Sprintf("at %v, %s", e.When, e.What) 
```

* * *

## 回答 #2

> 赞同：231
> 
> 时间：2015-07-31T09:06:01.600

### 1.简单的字符串

对于“简单”字符串（通常适合一行），最简单的解决方案是使用[`fmt.Sprintf()`](https://golang.org/pkg/fmt/#Sprintf)和朋友（[`fmt.Sprint()`](https://golang.org/pkg/fmt/#Sprint), [`fmt.Sprintln()`](https://golang.org/pkg/fmt/#Sprintln)）。这些类似于没有起始`S`字母的函数，但这些`Sxxx()`变体将结果作为 a 返回，`string`而不是将它们打印到标准输出。

例如：

```
s := fmt.Sprintf("Hi, my name is %s and I'm %d years old.", "Bob", 23) 
```

该变量`s`将使用以下值初始化：

```
Hi, my name is Bob and I'm 23 years old. 
```

**提示：**如果您只想连接不同类型的值，您可能不需要像这样自动使用`Sprintf()`（需要格式字符串）`Sprint()`。看这个例子：

```
i := 23
s := fmt.Sprint("[age:", i, "]") // s will be "[age:23]" 
```

对于仅连接`string`s，您还可以使用[`strings.Join()`](https://golang.org/pkg/strings/#Join)where 您可以指定自定义分隔符`string`（放置在要连接的字符串之间）。

[在Go Playground](http://play.golang.org/p/Sc9G_SlURH)上试试这些。

### 2\. 复杂的字符串（文档）

如果您尝试创建的字符串更复杂（例如，多行电子邮件），`fmt.Sprintf()`则可读性和效率会降低（特别是如果您必须多次这样做）。

为此，标准库提供了包[`text/template`](https://golang.org/pkg/text/template/)和[`html/template`](https://golang.org/pkg/html/template/). 这些包实现了用于生成文本输出的数据驱动模板。`html/template`用于生成对代码注入安全的 HTML 输出。它提供与包相同的接口，`text/template`并且应该`text/template`在输出为 HTML 时使用。

使用这些`template`包基本上需要您以值的形式提供一个静态模板`string`（它可能源自一个文件，在这种情况下您只提供文件名），其中可能包含静态文本，以及在引擎处理模板并生成输出。

您可以提供静态模板中包含/替换的参数，这些参数可以控制输出生成过程。这种参数的典型形式是可以嵌套的`struct`s 和values。`map`

**例子：**

例如，假设您要生成如下所示的电子邮件：

```
Hi [name]!

Your account is ready, your user name is: [user-name]

You have the following roles assigned:
[role#1], [role#2], ... [role#n] 
```

要生成这样的电子邮件正文，您可以使用以下静态模板：

```
const emailTmpl = `Hi {{.Name}}!

Your account is ready, your user name is: {{.UserName}}

You have the following roles assigned:
{{range $i, $r := .Roles}}{{if $i}}, {{end}}{{.}}{{end}}
` 
```

并提供这样的数据来执行它：

```
data := map[string]interface{}{
    "Name":     "Bob",
    "UserName": "bob92",
    "Roles":    []string{"dbteam", "uiteam", "tester"},
} 
```

通常模板的输出被写入 a [`io.Writer`](https://golang.org/pkg/io/#Writer)，因此如果您希望结果为 a `string`，请创建并写入 a [`bytes.Buffer`](https://golang.org/pkg/bytes/#Buffer)（实现`io.Writer`）。执行模板并获得结果`string`：

```
t := template.Must(template.New("email").Parse(emailTmpl))
buf := &bytes.Buffer{}
if err := t.Execute(buf, data); err != nil {
    panic(err)
}
s := buf.String() 
```

这将产生预期的输出：

```
Hi Bob!

Your account is ready, your user name is: bob92

You have the following roles assigned:
dbteam, uiteam, tester 
```

[在Go Playground](https://play.golang.org/p/5KXMHSIUxXv)上尝试一下。

另请注意，从 Go 1.10 开始，可以使用更新、更快、更专业的替代方案`bytes.Buffer`：[`strings.Builder`](https://golang.org/pkg/strings/#Builder). 用法非常相似：

```
builder := &strings.Builder{}
if err := t.Execute(builder, data); err != nil {
    panic(err)
}
s := builder.String() 
```

[在Go Playground](https://play.golang.org/p/wjJnD1uJlWy)上试试这个。

注意：如果您提供`os.Stdout`作为目标（也实现`io.Writer`），您也可以显示模板执行的结果：

```
t := template.Must(template.New("email").Parse(emailTmpl))
if err := t.Execute(os.Stdout, data); err != nil {
    panic(err)
} 
```

这会将结果直接写入`os.Stdout`. [在Go Playground](https://play.golang.org/p/Eo-QiN_QCKJ)上试试这个。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2021-05-31T03:29:45.540

尝试使用`Sprintf()`；它不会打印输出，而是将其保存以备将来使用。看一下这个。

```
package main

import "fmt"

func main() {

    address := "NYC"

    fmt.Sprintf("I live in %v", address)

} 
```

当您运行此代码时，它不会输出任何内容。但是，一旦将 分配`Sprintf()`给单独的变量，它就可以用于将来的目的。

```
package main

import "fmt"

func main() {

    address := "NYC"

    fmt.Sprintf("I live in %v", address)

    var city = fmt.Sprintf("lives in %v", address)
    fmt.Println("Michael",city)

} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-01-23T02:55:27.480

在您的情况下，您需要使用 Sprintf() 作为格式字符串。

`func Sprintf(format string, a ...interface{}) string`

Sprintf 根据格式说明符格式化并返回结果字符串。

`s := fmt.Sprintf("Good Morning, This is %s and I'm living here from last %d years ", "John", 20)`

您的输出将是：

> 早上好，我是约翰，我过去 20 年来一直住在这里。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-04-02T11:53:26.983

我们可以通过支持自定义一个新的字符串`define new Type`类型`Format`。

```
package main

import (
    "fmt"
    "text/template"
    "strings"
)

type String string
func (s String) Format(data map[string]interface{}) (out string, err error) {
    t := template.Must(template.New("").Parse(string(s)))
    builder := &strings.Builder{}
    if err = t.Execute(builder, data); err != nil {
        return
    }
    out = builder.String()
    return
}

func main() {
    const tmpl = `Hi {{.Name}}!  {{range $i, $r := .Roles}}{{if $i}}, {{end}}{{.}}{{end}}`
    data := map[string]interface{}{
        "Name":     "Bob",
        "Roles":    []string{"dbteam", "uiteam", "tester"},
    }

    s ,_:= String(tmpl).Format(data)
    fmt.Println(s)
} 
```

注：`{{.}}`表示`{{$r}}`在`{{range $i, $r := .Roles}} {{.}} {{end}}`

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-08-25T13:30:24.270

我已经创建了用于从模板格式化字符串的 go 项目（它允许以***C# 或 Python***样式格式化字符串，只是非常简单情况的第一个版本），你可以在这里找到它[https://github.com/Wissance/stringFormatter](https://github.com/Wissance/stringFormatter)

它以下列方式工作：

```
 func TestStrFormat(t *testing.T) {
    strFormatResult, err := Format("Hello i am {0}, my age is {1} and i am waiting for {2}, because i am {0}!",
                              "Michael Ushakov (Evillord666)", "34", "\"Great Success\"")
    assert.Nil(t, err)
    assert.Equal(t, "Hello i am Michael Ushakov (Evillord666), my age is 34 and i am waiting for \"Great Success\", because i am Michael Ushakov (Evillord666)!", strFormatResult)

    strFormatResult, err = Format("We are wondering if these values would be replaced : {5}, {4}, {0}", "one", "two", "three")
    assert.Nil(t, err)
    assert.Equal(t, "We are wondering if these values would be replaced : {5}, {4}, one", strFormatResult)

    strFormatResult, err = Format("No args ... : {0}, {1}, {2}")
    assert.Nil(t, err)
    assert.Equal(t, "No args ... : {0}, {1}, {2}", strFormatResult)
}

func TestStrFormatComplex(t *testing.T) {
    strFormatResult, err := FormatComplex("Hello {user} what are you doing here {app} ?", map[string]string{"user":"vpupkin", "app":"mn_console"})
    assert.Nil(t, err)
    assert.Equal(t, "Hello vpupkin what are you doing here mn_console ?", strFormatResult)
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-09-14T14:23:58.027

我来到这个页面专门寻找一种格式化错误字符串的方法。因此，如果有人需要帮助，您需要使用该`fmt.Errorf()`功能。

方法签名是`func Errorf(format string, a ...interface{}) error`. 它将格式化的字符串作为满足`error`接口的值返回。

您可以在文档中查找更多详细信息 - [https://golang.org/pkg/fmt/#Errorf](https://golang.org/pkg/fmt/#Errorf)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-06-20T06:47:31.903

`fmt.SprintF`函数返回一个字符串，您可以按照与使用相同的方式格式化字符串`fmt.PrintF`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-07-14T22:49:03.917

而不是 using `template.New`，您可以只使用`new`内置的 [template.Template](//pkg.go.dev/text/template#Template)：

```
package main

import (
   "strings"
   "text/template"
)

func format(s string, v interface{}) string {
   t, b := new(template.Template), new(strings.Builder)
   template.Must(t.Parse(s)).Execute(b, v)
   return b.String()
}

func main() {
   bar := "bar"
   println(format("foo: {{.}}", bar))
   i := 25
   println(format("foo: {{.}}", i))
} 
```

# ios - MagicalRecord：多个数据库

> ID：11123867
> 
> 赞同：10
> 
> 时间：2012-06-20T16:21:43.323
> 
> 标签：ios, core-data, magicalrecord

我有一个使用 MagicalRecord 的应用程序，并且我正在使用大量用于参考的数据预先填充数据库。在同一个数据模型中，我有用户可定义的信息，这些信息与用户可能在应用程序中执行的操作有关。

该应用程序被拒绝，因为预填充的数据应该被标记为“不备份”。所以，我想把这些数据放在一个单独的数据存储中，这样我就可以将用户数据保存为可备份的。

有没有办法使用 MagicalRecord 拥有两个独立的数据存储？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-20T19:11:32.190

我认为这是可能的，但不是太容易。如您所知，要使用多个数据库，您应该对您`PersistentStoreCoordinator`的`PersistentStores`. 在此之后，您的核心数据堆栈将如下所示： ![在此处输入图像描述](../Images/d218682f840ad347600c67383a75379d.png)

另一种方式是两个创建两个独立的 PersistentStoreCoordinators，每个承载一个存储。

**在 Magical Record 中，在NSPersistentStoreCoordinator+MagicalRecord.h**中有几种添加商店的类方法 。

> *   (NSPersistentStore *) MR_addInMemoryStore;
> *   (NSPersistentStore *) MR_addAutoMigratingSqliteStoreNamed:(NSString *) storeFileName;
> *   (NSPersistentStore *) MR_addSqliteStoreNamed:(id)storeFileName withOptions:(__autoreleasing NSDictionary *)options;

我认为，这是你可以做你想做的事情的地方。

我还应该提到，设置堆栈的整个过程都在**MagicalRecord+Setup.h 中**

```
+ (void) setupCoreDataStackWithStoreNamed:(NSString *)storeName 
```

所以你可以在那里添加你的商店和协调员。我从来没有自己管理过，这只是对可能解决方案的简要调查。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-06-03T19:04:51.710

我能够使用配置解决这个问题。由于 Magical Record 总是发送`null`配置参数，因此我将其拆分`setupCoreDataStackWithAutoMigratingSqliteStoreNamed`并替换为支持多种配置的方法。

因为 Magical Record 在处理自动迁移方面做得很好，所以我首先调用`setupCoreDataStackWithAutoMigratingSqliteStoreNamed`，然后进行清理，然后提供替换代码。

我有一个对象模型，我的种子数据对象分配给“种子”配置，用户对象分配给“用户”配置。Magical Record 已经初始化，因此它可以在必要时自动迁移。

```
+(void) RB_setupMultipleStores:(NSString *) seedStoreName userStore:(NSString *) userStoreName
/* change persistent store to one with multiple configurations. Assumes Magical Record is initialized. */
{
NSError * error= nil;

[MagicalRecord cleanUp];

NSManagedObjectModel * model = [NSManagedObjectModel MR_defaultManagedObjectModel];

NSURL *seedURL = [NSPersistentStore MR_urlForStoreName:[seedStoreName stringByAppendingString:@".sqlite"]];

NSPersistentStoreCoordinator * coordinator = [[NSPersistentStoreCoordinator alloc] initWithManagedObjectModel:model];

NSDictionary *options = [NSDictionary dictionaryWithObjectsAndKeys:
                         [NSNumber numberWithBool:YES], NSMigratePersistentStoresAutomaticallyOption,
                         [NSNumber numberWithBool:YES], NSInferMappingModelAutomaticallyOption,
                         nil];

NSPersistentStore * seedStore =[coordinator
                                  addPersistentStoreWithType:NSSQLiteStoreType
                                  configuration:@"Seed"
                                  URL:seedURL
                                  options:options
                                  error:&error];
if (!seedStore || error)
{
    NSLog(@"Error setting up seed store:%@ for %@", [error localizedDescription], seedURL);
    exit(-1);
}

NSURL *userURL = [NSPersistentStore MR_urlForStoreName:[userStoreName stringByAppendingString:@".sqlite"]];

NSPersistentStore * userStore = [coordinator
                                 addPersistentStoreWithType:NSSQLiteStoreType
                                 configuration:@"User"
                                 URL:userURL
                                 options:options
                                 error:&error];

if (!userStore || error)
{
    NSLog(@"Error setting up user store:%@ for %@", [error localizedDescription], userURL);
    exit (-1);
}
[NSPersistentStoreCoordinator MR_setDefaultStoreCoordinator:coordinator];

[NSManagedObjectContext MR_initializeDefaultContextWithCoordinator:coordinator];
} 
```

此外，MR 3.0 具有并发堆栈，一旦完成就可以解决问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-03-10T20:05:09.230

将不同核心数据实体的数据保存在不同的存储文件中得到了很好的支持并且相当简单。但是，MagicalRecrd 没有提供任何方便的方法来以这种方式设置您的 Core Data 堆栈。您只需手动分配堆栈，并告诉 MagicalRecord 使用`NSPersistentStoreCoordinator`您创建的堆栈。以下是我快速完成的方法：

```
import Foundation
import CoreData
import MagicalRecord

class CoreDataSetup {
    static func setupAutoMigratingStack(withContentConfigurationName contentConfigurationName: String, userConfirgurationNameName: String) {
        MagicalRecord.cleanUp()

        let managedObjectModel = NSManagedObjectModel.MR_defaultManagedObjectModel()
        let persistentStoreCoordinator = NSPersistentStoreCoordinator(managedObjectModel: managedObjectModel!)

        let contentURL = NSPersistentStore.MR_urlForStoreName(contentConfigurationName + ".sqlite")
        let userURL = NSPersistentStore.MR_urlForStoreName(userConfirgurationNameName + ".sqlite")
        let options = [
            NSMigratePersistentStoresAutomaticallyOption : true,
            NSInferMappingModelAutomaticallyOption: true,
            NSSQLitePragmasOption: ["journal_mode": "DELETE"]
        ]
        do {
            try persistentStoreCoordinator.addPersistentStoreWithType(NSSQLiteStoreType, configuration: contentConfigurationName, URL: contentURL, options: options)
            try persistentStoreCoordinator.addPersistentStoreWithType(NSSQLiteStoreType, configuration: userConfirgurationNameName, URL: userURL, options: options)

            NSPersistentStoreCoordinator.MR_setDefaultStoreCoordinator(persistentStoreCoordinator)
            NSManagedObjectContext.MR_initializeDefaultContextWithCoordinator(persistentStoreCoordinator)
        } catch {
            print("Error adding persistent store to coordinator: \(error) ")
        }
    }
} 
```

请注意，在我的代码中，我将您的“种子”存储概念称为“内容”，将用户可定义存储称为“用户”。

要完成问题的第二个方面，将内容存储配置为不备份，您只需使用存储每个存储的 URL，将内容存储放置在未备份的临时目录中，然后复制它如果它不存在，则从您的应用程序包启动到该位置。

# sql - 仅从 .bak 文件恢复文件列表时出错

> ID：11123868
> 
> 赞同：0
> 
> 时间：2012-06-20T16:21:45.487
> 
> 标签：sql, sql-server-2012, database-restore

我正在尝试从 .bak 文件恢复 filelistonly 并收到以下错误：

> 消息 3201，级别 16，状态 2，第 1 行无法打开备份设备“C:\Users...\myFile.bak”。操作系统错误 5（拒绝访问。）。

该文件最初被阻止，但我取消阻止它，所以这不应该是问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T17:00:04.370

错误消息准确地解释了发生了什么：您已将 .BAK 文件放在 SQL Server 服务帐户无权访问的文件夹中。

您可以通过向 SQL Server 服务帐户授予对您的配置文件文件夹的访问权限来“解决”此问题，但这是对安全最佳实践的不必要的违反。

将文件移动到 SQL Server 服务帐户已经具有本机访问权限的位置（例如备份或数据目录）要容易得多。您可以通过查看以下查询的结果找到数据文件夹（可能有多个有效位置）：

```
SELECT DISTINCT SUBSTRING(physical_name, 1, LEN(physical_name) 
  - CHARINDEX('\', REVERSE(physical_name)) + 1) 
FROM [master].sys.master_files
WHERE [type] = 0; 
```

如果您备份了任何数据库（希望您有！），您可以通过以下方式找到一些有效的备份位置：

```
SELECT DISTINCT SUBSTRING(physical_device_name, 1, LEN(physical_device_name) 
  - CHARINDEX('\', REVERSE(physical_device_name)) + 1) 
FROM msdb.dbo.backupmediafamily; 
```

当然，这些没有考虑到诸如只读卷上的只读数据文件、SQL Server 可能有权访问但您不能访问的卷、没有足够可用空间用于 .BAK 文件的卷或备份位置过去使用过但不再存在或无法访问的内容。

# android - RotateAnimation 在启动 Activity 之前不等待按钮旋转

> ID：11123869
> 
> 赞同：0
> 
> 时间：2012-06-20T16:21:46.443
> 
> 标签：android, rotateanimation

我有一个`ImageButton`在点击时旋转的android。问题是当用户点击它并继续到下一行的新活动时，它没有完成旋转。我已经尝试过`Thread.sleep(..)`，`wait(..)`但`RotateAnimation(..)`实际上在动画开始之前就睡着了。

我需要动画真正完成，然后继续`startActivity(new Intent(..))`

这是代码

```
 amazingPicsButton.setOnClickListener(new View.OnClickListener() {          
        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            amazingPicsSound = createRandButSound();
            amazingPicsSound.start();               
            rotateAnimation(v);

            startActivity(new Intent("com.jasfiddle.AmazingInterface.AMAZINGPICS"));            
        }
    });         
}

/** function that produces rotation animation on the View v.
 * Could be applied to button, ImageView, ImageButton, etc.
 */
public void rotateAnimation(View v){
    // Create an animation instance
    Animation an = new RotateAnimation(30, 360, v.getWidth()/2, v.getHeight()/2);

    // Set the animation's parameters
    an.setDuration(20);               // duration in ms
    an.setRepeatCount(10);                // -1 = infinite repeated
  //  an.setRepeatMode(Animation.REVERSE); // reverses each repeat
    an.setFillAfter(true);               // keep rotation after animation

    v.setAnimation(an);
    // Apply animation to the View

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T16:31:15.833

您永远不会要求您的应用程序等待动画结束以启动新活动。见[http://developer.android.com/reference/android/view/animation/Animation.html#setAnimationListener(android.view.animation.Animation.AnimationListener)](http://developer.android.com/reference/android/view/animation/Animation.html#setAnimationListener%28android.view.animation.Animation.AnimationListener%29)

学习如何使用`AnimationListener`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T16:31:51.883

动画是一个异步过程，因此如果您希望动画在继续之前完成，那么您需要添加动画侦听器并在动画完成时执行下一行代码：

```
amazingPicsButton.setOnClickListener(new View.OnClickListener() {          
    @Override
    public void onClick(View v) {
        // TODO Auto-generated method stub
        amazingPicsSound = createRandButSound();
        amazingPicsSound.start();
        rotateAnimation(v);
    }
}); 
```

进而

```
public void rotateAnimation(View v){
    // Create an animation instance
    Animation an = new RotateAnimation(30, 360, v.getWidth()/2, v.getHeight()/2);

    // Set the animation's parameters
    an.setDuration(20);               // duration in ms
    an.setRepeatCount(10);                // -1 = infinite repeated
    //  an.setRepeatMode(Animation.REVERSE); // reverses each repeat
    an.setFillAfter(true);               // keep rotation after animation

    an.addAnimationListener(new AnimationListener() {
            @Override
            public void onAnimationStart(Animation animation) {}

            @Override
            public void onAnimationRepeat(Animation animation) {}

            @Override
            public void onAnimationEnd(Animation animation) {
                startActivity(new Intent("com.jasfiddle.AmazingInterface.AMAZINGPICS"));
            }
        });

    v.setAnimation(an);

} 
```

请注意，`startActivity`调用不在 the`onAnimationEnd`方法内部，`AnimationListener`而不是在将动画设置到视图之后。

# iphone - UIBarButtonSystemItem PageCurl 不随工具栏改变颜色

> ID：11123883
> 
> 赞同：3
> 
> 时间：2012-06-20T16:22:41.080
> 
> 标签：iphone, colors, toolbar, page-curl, tint

我想改变导航栏和工具栏的颜色，但是页面卷曲系统图标的颜色`UIBarButtonSystemItemPageCurl`不会随着工具栏的色调颜色而改变。如果我使用书签等其他系统图标，它们会改变。有没有人有解决这类问题的方法？

我使用以下几行来更改导航栏和工具栏的颜色。

```
 self.navigationController.navigationBar.tintColor = [UIColor redColor];
    self.navigationController.toolbar.tintColor = [UIColor redColor]; 
```

这是一个屏幕截图，显示页面卷曲颜色没有改变：

![页面卷曲](../Images/7c6de6892dea13f5b9706b50f011f8e8.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T12:41:30.280

在将其添加到工具栏之前尝试设置`tintColor`for ？`UIBarButtonSystemItemPageCurl`当我上次查看 iOS 4.3 时，这肯定是一个问题。

# c++builder-xe2 - Embarcadero C++ Builder XE2 构建错误

> ID：11123886
> 
> 赞同：1
> 
> 时间：2012-06-20T16:22:48.580
> 
> 标签：c++builder-xe2

我正在使用（目前）Embarcadero C++ Builder XE2 Architect 的试用版。我正在从 Borland C++ Builder 6 迁移我们当前的代码。

我一直在将一些类型库导入并安装到一个包中。到目前为止，我遇到的那些已经进口得很好。但是，我需要导入 OLE 自动化 2.0 库。这样做后，我收到了几个错误，第一个错误在这篇文章的标题中提到。

到目前为止我导入的其他库是：Crystal Reports ActiveX Designer Run Time Library 11.0 (craxdrt.dll) 和 Microsoft Jet and Replication Objects 2.6 Library (msjro.dll)。

下面显示了 IDE 指出问题所在的位置（文件 stdole_TLB.h）：

```
typedef Stdole_tlb::IFontDisp IFontDisp;
typedef Stdole_tlb::IFontDisp *IFontDispPtr;
typedef Stdole_tlb::IPictureDisp IPictureDisp;
typedef Stdole_tlb::IPictureDisp *IPictureDispPtr; 
```

那些刚刚显示的完整解析器上下文消息：

```
stdole_TLB.cpp(28): #include ..\9.0\Imports\stdole_TLB.h
stdole_TLB.h(56): namespace Stdole_tlb 
```

我还收到另一条错误消息：

```
[BCC32 Error] stdole_TLB.h(254): E2029 'TDispWrapper<IDispatch>' must be a previously defined class or struct
  Full parser context
    stdole_TLB.cpp(28): #include ..\9.0\Imports\stdole_TLB.h
    stdole_TLB.h(56): namespace Stdole_tlb
    stdole_TLB.h(253): class IUnknown 
```

最后一个会产生很多错误消息，所以我认为如果可以消除它，大多数错误都会消失。

任何帮助深表感谢！

# android - BaseAdapter中带有希伯来语字符串的android setText导致stackoverflow

> ID：11123889
> 
> 赞同：0
> 
> 时间：2012-06-20T16:23:13.690
> 
> 标签：android, textview, baseadapter

我已经为我的列表视图构建了一个 BaseAdapter 扩展类。
在里面我有一个我想通过代码设置的 TextView 字段。此字段表示用户的 Facebook 状态。
该字段有时会收到希伯来语文本，然后由于 stackoverflow 错误而崩溃。
重要的是要补充一点，当字段获取的文本是英文时，这不会发生，当我尝试调试它以找到问题时，我在活动（不是 BaseAdapter）中使用了带有希伯来语字符串的 setText 和它工作得很好。

这是我的课：

```
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.UnsupportedEncodingException;
import java.net.MalformedURLException;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;    
import com.WhosAround.R;
import com.WhosAround.AppVariables;    
import com.WhosAround.Facebook.FacebookUser;
import com.facebook.android.AsyncFacebookRunner.RequestListener;
import com.facebook.android.FacebookError;    
import android.app.Activity;
import android.content.Context;
import android.graphics.drawable.Drawable;
import android.os.AsyncTask;
import android.os.Bundle;
import android.os.Handler;
import android.os.Message;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageView;
import android.widget.TextView;  

public class FriendsFriendsTabList extends BaseAdapter {

    private static LayoutInflater inflater = null;
    private AppVariables app;
    private final FacebookUser[] chatList;

    public FriendsFriendsTabList(Activity activity) {
        inflater = (LayoutInflater) activity
                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        app = (AppVariables) activity.getApplicationContext();
        chatList = app.makeApplicationFacebookUsersArray();
    }

    public int getCount() {
        return chatList.length;
    }

    public Object getItem(int position) {
        return position;
    }

    public long getItemId(int position) {
        return position;
    }

    public View getView(final int position, View convertView, ViewGroup parent) {
        View vi = convertView;
        if (convertView == null)
            vi = inflater.inflate(
                    R.layout.activity_friends_friends_tab_list_row, null);
        if (position % 2 == 0)
            vi.setBackgroundResource(R.color.list_background_light);
        else
            vi.setBackgroundResource(R.color.list_background_dark);

        TextView name = (TextView) vi
                .findViewById(R.id.list_friends_friends_tab_name);
        TextView status = (TextView) vi
                .findViewById(R.id.list_friends_friends_tab_status);
        ImageView profilePicture = (ImageView) vi
                .findViewById(R.id.list_profile_picture);   
        loadStatus(position, status);

        return vi;
    }

    private void loadStatus(final int position, final TextView status) {
        if (chatList[position].getStatus() != null)
            status.setText(chatList[position].getStatus());
        else {
            final Handler handler = new Handler() {
                @Override
                public void handleMessage(Message message) {                    
                    try {
                        String currentStatus = (String) message.obj;
                        String utf8Status;
                        utf8Status = new String(currentStatus.getBytes(), "UTF-8");
                        chatList[position].setStatus(currentStatus);                    
                        Log.d("status", chatList[position].getStatus()); 
                                                      //this is the line that causes the error
status.setText(utf8Status);

                    } catch (UnsupportedEncodingException e) {
                        e.printStackTrace();
                    }
                }
            };

            Thread thread = new Thread() {
                @Override
                public void run() {
                    String fqlQuery = "SELECT message FROM status WHERE uid="
                            + Integer.toString(chatList[position].getId())
                            + " LIMIT 1";                    
                     Bundle fqlQueryParams = new Bundle();
                     fqlQueryParams.putString("method", "fql.query");
                     fqlQueryParams.putString("query", fqlQuery);                                       
                    app.getFacebookManager().getFacebookRunner().request(null, fqlQueryParams, new RequestListener() {

                        @Override
                        public void onMalformedURLException(MalformedURLException e, Object state) {
                            Log.e("Facebook User Status", e.toString());
                        }

                        @Override
                        public void onIOException(IOException e, Object state) {
                            Log.e("Facebook User Status", e.toString());                            
                        }

                        @Override
                        public void onFileNotFoundException(FileNotFoundException e, Object state) {
                            Log.e("Facebook User Status", e.toString());                            
                        }

                        @Override
                        public void onFacebookError(FacebookError e, Object state) {
                            Log.e("Facebook User Status", e.toString());                            
                        }

                        @Override
                        public void onComplete(String response, Object state) {
                            Log.d("Facebook Response", response);
                            JSONArray statusResults = app.convertToJSONArray(response);
                            try {
                                JSONObject statusObject = statusResults.getJSONObject(0);
                                String currentStatus = statusObject.getString("message");                                                               
                                Message message = handler.obtainMessage(1, currentStatus);
                                handler.sendMessage(message);
                            } catch (JSONException e) {
                                Log.e("Facebook User Status", e.toString());
                            } 

                        }
                    });

                }
            };
            thread.start();
        }
    }

} 
```

我知道代码有点庞大，我应该使用 asynctask 而不是线程和处理程序，但这只是一个测试，我想看看它是否有效......

堆栈跟踪：

```
06-20 19:30:15.180: E/AndroidRuntime(3863): FATAL EXCEPTION: main
06-20 19:30:15.180: E/AndroidRuntime(3863): java.lang.StackOverflowError
06-20 19:30:15.180: E/AndroidRuntime(3863):     at com.ibm.icu4jni.util.LocaleData.get(LocaleData.java:96)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at java.util.Formatter.format(Formatter.java:1061)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at java.util.Formatter.format(Formatter.java:1031)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at java.lang.String.format(String.java:2183)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at java.lang.String.format(String.java:2157)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.text.Styled.drawDirectionalRun(Styled.java:266)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.text.Styled.drawText(Styled.java:362)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.text.Layout.drawText(Layout.java:1546)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.text.Layout.draw(Layout.java:380)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.widget.TextView.onDraw(TextView.java:4417)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.View.draw(View.java:6933)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.drawChild(ViewGroup.java:1646)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.drawChild(ViewGroup.java:1644)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.drawChild(ViewGroup.java:1644)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.View.draw(View.java:6936)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.drawChild(ViewGroup.java:1646)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.widget.AbsListView.dispatchDraw(AbsListView.java:1648)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.widget.ListView.dispatchDraw(ListView.java:3217)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.View.draw(View.java:6936)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.widget.AbsListView.draw(AbsListView.java:3030)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.drawChild(ViewGroup.java:1646)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.View.draw(View.java:6936)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.widget.FrameLayout.draw(FrameLayout.java:357)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.drawChild(ViewGroup.java:1646)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.drawChild(ViewGroup.java:1644)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.drawChild(ViewGroup.java:1644)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.drawChild(ViewGroup.java:1644)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.drawChild(ViewGroup.java:1644)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.drawChild(ViewGroup.java:1644)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.View.draw(View.java:6936)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.widget.FrameLayout.draw(FrameLayout.java:357)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.drawChild(ViewGroup.java:1646)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.drawChild(ViewGroup.java:1644)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.View.draw(View.java:6936)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.widget.FrameLayout.draw(FrameLayout.java:357)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.drawChild(ViewGroup.java:1646)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.drawChild(ViewGroup.java:1644)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.drawChild(ViewGroup.java:1644)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.drawChild(ViewGroup.java:1644)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.drawChild(ViewGroup.java:1644)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.drawChild(ViewGroup.java:1644)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.drawChild(ViewGroup.java:1644)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.View.draw(View.java:6936)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.widget.FrameLayout.draw(FrameLayout.java:357)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.drawChild(ViewGroup.java:1646)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1373)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.View.draw(View.java:6936)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.widget.FrameLayout.draw(FrameLayout.java:357)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at com.android.internal.policy.impl.PhoneWindow$DecorView.draw(PhoneWindow.java:1917)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewRoot.draw(ViewRoot.java:1530)
06-20 19:30:15.180: E/AndroidRuntime(3863):     at android.view.ViewRoot.perfor 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T20:51:42.217

你确定你的

```
status.setText(utf8Status) 
```

在 UI 线程上运行？可能不是因为线程处理程序。您需要尝试将其作为 POST 运行。但是，这通常会导致不同的错误消息。

您能否指出第 96 行代码的哪一部分？导致错误的那个？

# c# - C# - 大整数的按位运算

> ID：11123890
> 
> 赞同：2
> 
> 时间：2012-06-20T16:23:16.477
> 
> 标签：c#, .net, bitwise-operators

我有很多标志，我想将它们存储在一个整数中，以便稍后我可以对它们执行按位与运算。这些标志的数量可能高达 1000。但是，C# 中没有可以存储 1000 位的类型。

例如，我想对ü执行（&）操作

```
100000010000000011100000000000000000000000000000...........00001 --> (1000 flags)
000000000000000001111110000000000000000000010101.......... 11111 --> (1000 flags) 
```

那么，如何对两位集合执行此 (&) 操作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-20T16:27:17.180

> 我有很多标志，我想将它们存储在一个整数中，以便稍后我可以对它们执行按位与运算。

那是不合逻辑的。您可以使用[`BitArray`](http://msdn.microsoft.com/en-us/library/system.collections.bitarray.aspx)它的[`And`](http://msdn.microsoft.com/en-us/library/system.collections.bitarray.and.aspx)方法来满足该要求，而无需*人为*地通过数字类型。

如果您在*逻辑上*没有数字（而且“许多标志”对我来说听起来不像数字），那么您不应该特意使用数字表示。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-20T16:25:59.217

我想[`BigInteger`](http://msdn.microsoft.com/en-us/library/system.numerics.biginteger.aspx)这就是你要找的。它有[`BitwiseAnd`运营商](http://msdn.microsoft.com/en-us/library/system.numerics.biginteger.op_bitwiseand.aspx)

# xml - 重新排序 xml，首先是文本节点，然后是具有子节点的节点

> ID：11123892
> 
> 赞同：-3
> 
> 时间：2012-06-20T16:23:30.640
> 
> 标签：xml, xslt, xsd

> **可能重复：**
> [使用彼此相关的节点重建 magento XML，通过转换更紧密地结合在一起。](https://stackoverflow.com/questions/11105050/rebuild-magento-xml-with-nodes-related-to-each-other-closer-together-with-a-tra)

这是一个双重帖子，但使用当前标签我没有得到回复。我会更新其他帖子或删除它。

我从 Magento 那里得到了这个，开发人员无法轻松地将其更改为“之后”示例。我的解析器在解析这个时遇到了一些问题，所以我的问题是。我可以使用 xsl 样式表将其转换为“之后”示例，其中 nodea 到 nodeh 更接近彼此，因此更具可读性。

这将为我节省大量研究解析器的时间。

前：

```
 <Envelope encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
<Body>
    <salesOrderInfoResponse>
        <result type="ns1:salesOrderEntity">
            <nodec>value</nodec>
            <noded>value</noded>
            <shipping_address type="ns1:salesOrderAddressEntity">
                <parent_id type="xsd:string">762</parent_id>
                <address_type type="xsd:string">shipping</address_type>
                <firstname type="xsd:string">K</firstname>
                <lastname type="xsd:string">Jansen</lastname>
            </shipping_address>
            <billing_address type="ns1:salesOrderAddressEntity">
                <parent_id type="xsd:string">762</parent_id>
                <address_type type="xsd:string">billing</address_type>
                <firstname type="xsd:string">K</firstname>
                <lastname type="xsd:string">Jansen</lastname>
            </billing_address>
            <items arrayType="ns1:salesOrderItemEntity[4]" type="ns1:salesOrderItemEntityArray">
                <item type="ns1:salesOrderItemEntity">
                    <item_id type="xsd:string">3105</item_id>
                </item>
                <item type="ns1:salesOrderItemEntity">
                    <item_id type="xsd:string">3106</item_id>
                </item>
                <item type="ns1:salesOrderItemEntity">
                    <item_id type="xsd:string">3107</item_id>
                </item>
                <item type="ns1:salesOrderItemEntity">
                    <item_id type="xsd:string">3108</item_id>
                </item>
            </items>
            <payment type="ns1:salesOrderPaymentEntity">
                <parent_id type="xsd:string">762</parent_id>
                <cc_last4 type="xsd:string"></cc_last4>
            </payment>
            <nodea>value</nodea>
            <nodeb>value</nodeb>
            <nodee>value</nodee>
            <nodef>value</nodef>
            <nodeg>value</nodeg>
            <nodeh>value</nodeh>
        </result>
    </salesOrderInfoResponse>
</Body> 
```

后：

```
<Envelope encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
<Body>
    <salesOrderInfoResponse>
        <result type="ns1:salesOrderEntity">
            <nodea>value</nodea>
            <nodeb>value</nodeb>
            <nodec>value</nodec>
            <noded>value</noded>
            <nodee>value</nodee>
            <nodef>value</nodef>
            <nodeg>value</nodeg>
            <nodeh>value</nodeh>
            <shipping_address type="ns1:salesOrderAddressEntity">
                <parent_id type="xsd:string">762</parent_id>
                <address_type type="xsd:string">shipping</address_type>
                <firstname type="xsd:string">K</firstname>
                <lastname type="xsd:string">Jansen</lastname>
            </shipping_address>
            <billing_address type="ns1:salesOrderAddressEntity">
                <parent_id type="xsd:string">762</parent_id>
                <address_type type="xsd:string">billing</address_type>
                <firstname type="xsd:string">K</firstname>
                <lastname type="xsd:string">Jansen</lastname>
            </billing_address>
            <items arrayType="ns1:salesOrderItemEntity[4]" type="ns1:salesOrderItemEntityArray">
                <item type="ns1:salesOrderItemEntity">
                    <item_id type="xsd:string">3105</item_id>
                </item>
                <item type="ns1:salesOrderItemEntity">
                    <item_id type="xsd:string">3106</item_id>
                </item>
                <item type="ns1:salesOrderItemEntity">
                    <item_id type="xsd:string">3107</item_id>
                </item>
                <item type="ns1:salesOrderItemEntity">
                    <item_id type="xsd:string">3108</item_id>
                </item>
            </items>
            <payment type="ns1:salesOrderPaymentEntity">
                <parent_id type="xsd:string">762</parent_id>
                <cc_last4 type="xsd:string"></cc_last4>
            </payment>
        </result>
    </salesOrderInfoResponse>
</Body> 
```

我添加了一个 xslt 建议并对其进行了一些修改，它的接缝正在工作：

```
<xsl:template match="@*|node()"> 
    <xsl:copy> 
        <xsl:apply-templates select="@*|node()" /> 
    </xsl:copy> 
</xsl:template> 

<xsl:template match="result"> 
    <xsl:copy> 
        <xsl:apply-templates select="@*" /> 
        <xsl:apply-templates select="*[    starts-with(local-name(),'node') ]" /> 
        <xsl:apply-templates select="*[not(starts-with(local-name(),'node'))]|processing-instruction()|comment()" /> 
    </xsl:copy> 
</xsl:template> 
```

我知道有：

```
 <salesOrderInfoResponse> 

     <result type="ns1:salesOrderEntity">
        <nodec>value</nodec>
        <noded>value</noded>
        <nodea>value</nodea>
        <nodeb>value</nodeb>
        <nodee>value</nodee>
        <nodef>value</nodef>
        <nodeg>value</nodeg>
        <nodeh>value</nodeh>
        <shipping_address type="ns1:salesOrderAddressEntity"> 

           <parent_id type="xsd:string">762</parent_id> 

           <address_type type="xsd:string">shipping</address_type> 

           <firstname type="xsd:string">K</firstname> 

           <lastname type="xsd:string">Jansen</lastname> 

        </shipping_address>
        <billing_address type="ns1:salesOrderAddressEntity"> 

           <parent_id type="xsd:string">762</parent_id> 

           <address_type type="xsd:string">billing</address_type> 

           <firstname type="xsd:string">K</firstname> 

           <lastname type="xsd:string">Jansen</lastname> 

        </billing_address>
        <items arrayType="ns1:salesOrderItemEntity[4]" type="ns1:salesOrderItemEntityArray"> 

           <item type="ns1:salesOrderItemEntity"> 

              <item_id type="xsd:string">3105</item_id> 

           </item> 

           <item type="ns1:salesOrderItemEntity"> 

              <item_id type="xsd:string">3106</item_id> 

           </item> 

           <item type="ns1:salesOrderItemEntity"> 

              <item_id type="xsd:string">3107</item_id> 

           </item> 

           <item type="ns1:salesOrderItemEntity"> 

              <item_id type="xsd:string">3108</item_id> 

           </item> 

        </items>
        <payment type="ns1:salesOrderPaymentEntity"> 

           <parent_id type="xsd:string">762</parent_id> 

           <cc_last4 type="xsd:string"/> 

        </payment>
     </result> 

  </salesOrderInfoResponse> 
```

这几乎是正确的！我不明白额外间距从何而来，但我在正确的轨道上。

用真实数据进一步测试我没有看到顶部的文本节点。在上面的例子中，我猜是因为'node'命令。我创建了这个示例并用作文本节点、nodea、nodeb 等，但在现实生活中，它们被称为 orderid、name、数量。

查看带有子节点的 xml 节点，我可以看到它们都有一个属性类型，其值以“ns1:...”开头

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T04:55:39.460

试试这个 XSLT 1.0 样式表...

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xml" indent="yes"/>

<xsl:template match="@*|node()">
 <xsl:copy>
   <xsl:apply-templates select="@*|node()" />
 </xsl:copy>
</xsl:template>

<xsl:template match="result">
 <xsl:copy>
   <xsl:apply-templates select="@*" />
   <xsl:apply-templates select="*[not(starts-with(local-name(),'node'))]|processing-instruction()|comment()" />
   <xsl:apply-templates select="*[    starts-with(local-name(),'node') ]" />
 </xsl:copy>
</xsl:template>

</xsl:stylesheet> 
```

或者，您可以将模板更改为...

```
<xsl:template match="result">
 <xsl:copy>
   <xsl:apply-templates select="@*" />
   <xsl:apply-templates select="node()">
     <xsl:sort select="starts-with(local-name(),'node') and self::*" data-type="number" />
  </xsl:apply-templates>
 </xsl:copy>
</xsl:template> 
```

如果您需要 XSLT 2.0，请告诉我们，因为 XSLT 2.0 会有更简洁的解决方案。

# php - php中有“地图”功能吗？

> ID：11123893
> 
> 赞同：6
> 
> 时间：2012-06-20T16:23:30.727
> 
> 标签：php, map, range

我正在尝试找到一个与处理的“map”函数等效的php，这样我就可以将一个数字从一个范围重新映射到另一个范围。有什么存在吗？它被称为不同的东西吗？

[http://processing.org/reference/map_.html](http://processing.org/reference/map_.html)

例如将值从 0-100 映射到 0-9。

```
map(75, 0, 100, 0, 9); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-20T16:33:48.693

没有用于执行此操作的本机函数，但很容易创建：

```
function map($value, $low1, $high1, $low2, $high2) {
    return ($value / ($high1 - $low1)) * ($high2 - $low2) + $low2;
} 
```

这是未经测试的，但你应该希望得到这个想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-01-17T15:26:44.853

感谢这个伟大的功能！

我个人会通过添加简单的错误检查来改进这个功能，以避免除以 0，这会使 PHP 出现致命错误。

```
function map($value, $low1, $high1, $low2, $high2) {
    if ($low1 == $high1)
         return $low1;

    return ($value / ($high1 - $low1)) * ($high2 - $low2) + $low2;
} 
```

# c# - 将 C# 类对象传入和传出 C++ DLL 类

> ID：11123899
> 
> 赞同：14
> 
> 时间：2012-06-20T16:23:40.403
> 
> 标签：c#, c++, pinvoke, marshalling, dllimport

我一直在开发一个原型代码应用程序，该应用程序在 C# 中运行并使用旧 C++ 代码中的类和函数（以导入的 DLL 的形式）。代码要求是将类对象传递给非托管 C++ DLL（来自 C#），并存储/修改它以供 C# 应用程序稍后检索。这是我到目前为止的代码......

简单的 C++ DLL 类：

```
class CClass : public CObject
{
public:
    int intTest1
}; 
```

C++ DLL 函数：

```
CClass *Holder = new CClass;

extern "C"
{
    // obj always comes in with a 0 value.
    __declspec(dllexport) void SetDLLObj(CClass* obj)
    {
        Holder = obj;
    }

    // obj should leave with value of Holder (from SetDLLObj).
    __declspec(dllexport) void GetDLLObj(__out CClass* &obj)
    {
        obj = Holder;
    }
} 
```

C# 类和包装器：

```
[StructureLayout(LayoutKind.Sequential)]
public class CSObject
{
    public int intTest2;
}

class LibWrapper
{
    [DLLImport("CPPDLL.dll")]
    public static extern void SetDLLObj([MarshalAs(UnmanagedType.LPStruct)] 
      CSObject csObj);
    public static extern void GetDLLObj([MarshalAs(UnmanagedType.LPStruct)] 
      ref CSObject csObj);
} 
```

对 DLL 的 C# 函数调用：

```
class TestCall
{
    public static void CallDLL()
    {
        ...
        CSObject objIn = new CSObject();
        objIn.intTest2 = 1234; // Just so it contains something.
        LibWrapper.SetDLLObj(objIn);
        CSObject objOut = new CSObject();
        LibWrapper.GetDLLObj(ref objOut);
        MessageBox.Show(objOut.intTest2.ToString()); // This only outputs "0".
        ...
    }
} 
```

DLL 中似乎只有垃圾值可用（来自传入的 C# 对象）。我相信我在类编组或内存/指针问题上遗漏了一些东西。我错过了什么？

编辑：我更改了上面的代码以反映 Bond 建议的 C#/C++ 中方法/函数定义的更改。现在，C# 代码可以正确检索传入的值 (1234)。这暴露了 C++ DLL 中的另一个问题。1234 值不可用于 C++ 代码。相反，该对象在 DLL 中的值为 0。我想使用预定义的 C++ 函数从 DLL 中编辑对象。任何更多的帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-10T13:20:09.933

Bond 是正确的，我不能在托管代码和非托管代码之间传递一个对象，并且仍然让它保留其存储的信息。

我最终只是调用 C++ 函数来创建一个对象并将指针传回 C# 的 IntPtr 类型。然后，我可以将指针从 C# 传递给我需要的任何 C++ 函数（如果它是外部函数）。这并不是我们想要做的事情，但它会在我们需要的范围内发挥作用。

这是我正在使用的 C# 包装器作为示例/参考。（注意：我使用 StringBuilder 而不是上面示例中的“int intTest”。这是我们想要的原型。为了简单起见，我只是在类对象中使用了一个整数。）：

```
class LibWrapper
{
    [DllImport("CPPDLL.dll")]
    public static extern IntPtr CreateObject();
    [DllImport("CPPDLL.dll")]
    public static extern void SetObjectData(IntPtr ptrObj, StringBuilder strInput);
    [DllImport("CPPDLL.dll")]
    public static extern StringBuilder GetObjectData(IntPtr ptrObj);
    [DllImport("CPPDLL.dll")]
    public static extern void DisposeObject(IntPtr ptrObj);
}

public static void CallDLL()
{
    try
    {
        IntPtr ptrObj = Marshal.AllocHGlobal(4);
        ptrObj = LibWrapper.CreateObject();
        StringBuilder strInput = new StringBuilder();
        strInput.Append("DLL Test");
        MessageBox.Show("Before DLL Call: " + strInput.ToString());
        LibWrapper.SetObjectData(ptrObj, strInput);
        StringBuilder strOutput = new StringBuilder();
        strOutput = LibWrapper.GetObjectData(ptrObj);
        MessageBox.Show("After DLL Call: " + strOutput.ToString());
        LibWrapper.DisposeObject(ptrObj);
    }
    ...
} 
```

当然，C++ 执行所有需要的修改，而 C# 访问内容的唯一方法或多或少是通过 C++ 请求所需的内容。C# 代码无法以这种方式访问​​未管理的类内容，这使得两端编码的时间更长一些。但是，它对我有用。

这是我用来提出解决方案基础的参考资料：http: [//www.codeproject.com/Articles/18032/How-to-Marshal-aC-Class](http://www.codeproject.com/Articles/18032/How-to-Marshal-a-C-Class)

希望这可以帮助其他一些人节省比我试图弄清楚的时间更多的时间！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-20T16:51:58.827

我相信你应该像这样声明你的返回方法

```
__declspec(dllexport) void getDLLObj(__out CClass* &obj) 
```

分别是 C# 原型

```
public static extern void GetDLLObj([MarshalAs(UnmanagedType.LPStruct)] 
      ref CSObject csObj); 
```

入*站*方法也应该使用指向 CClass 的指针，C# 原型是可以的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T16:50:51.947

如果你只使用 C# 中的类，你应该使用 GCHandle [http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.gchandle%28v=vs.110%29.aspx](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.gchandle%28v=vs.110%29.aspx)

编辑：

```
CClass *Holder;

extern "C"
{
    // obj always comes in with a 0 value.
    __declspec(dllexport) void SetDLLObj(CClass* obj)
    {
        (*Holder) = (*obj);
    }

    // obj should leave with value of Holder (from SetDLLObj).
    __declspec(dllexport) void GetDLLObj(__out CClass** &obj)
    {
        (**obj) = (*Holder);
    }
} 
```

# android - Android Talkback 一直说 Webview

> ID：11123904
> 
> 赞同：8
> 
> 时间：2012-06-20T16:23:56.547
> 
> 标签：android, accessibility, android-webview

我已经为 webview 设置了内容描述，并且我已经覆盖了 dispatchPopulateAccessibilityEvent，但是当 webview 首次加载时，回话一直说 webview。反正有没有把它关掉。

谢谢。

# javascript - 开始日期范围的 JQuery show()/hide() 选择器

> ID：11123907
> 
> 赞同：0
> 
> 时间：2012-06-20T16:24:03.353
> 
> 标签：javascript, jquery, show-hide

[这](http://fiddle.jshell.net/chrisfrisina/xBKCR/)是小提琴。我试图允许用户选择一个范围（如果他们选择多次），它会显示时间范围内的位置。我无法让开始日期输入范围多次工作，尽管它正在更改。开始日期选择器代码是这样的：

```
//start selector functionality
    $('#startdate').on('change', function () {
        var $formelem = $(this);
        // Hide all positions that end before the specified date.
        $('section.position time.start').each(function () {
            if (compareTime($(this).attr('datetime'), $formelem.val()) <= 0) {
                $(this).parent().hide();
            } else {
                $(this).parent().show();
            }
        });
        $('section.company > time').remove();
        $('section.company').each(processCompanyTime);
    }); 
```

关于为什么它不会多次工作的任何线索？结束选择器多次工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:54:07.757

您的问题出在您的`processCompanyTime`功能中，该功能有条件隐藏`section.company`但不显示它。因此，当它被隐藏时，它将永远不会再次显示。

# java - 通过网络接收新课程

> ID：11123908
> 
> 赞同：1
> 
> 时间：2012-06-20T16:24:04.337
> 
> 标签：java, classpath, classloader

我正在写一些将接收新类型对象的东西。在它获取这些对象之前，我发送了这些新类型的类文件。当我读入新对象时，除非类文件位于运行类路径（bin 文件夹）的应用程序中，否则会抛出 ClassNotFoundException。

我想将我的类文件保存在系统的其他位置（Windows）。我研究过使用自定义类加载器，但未能成功使用。更简单的解决方案似乎只是添加另一个位置/类路径来查找类文件。但是将位置添加到 Windows CLASSPATH 变量似乎没有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T16:35:34.173

`ClassLoader`无论您如何注入类（通过网络或接触文件系统），您最终都需要使用 a来执行此类操作。

但是，有些库会为您处理这个问题，尤其是[Jodd](http://jodd.org/doc/add-classpath-in-runtime.html)会处理这个问题。根据文档，如果您通过网络获取类字节，则可以使用单线添加类：

```
Class c = ClassLoaderUtil.defineClass("MyNewClass", classBytes); 
```

看：[`ClassLoaderUtil.defineClass()`](http://jodd.org/api/jodd/jodd/util/ClassLoaderUtil.html#defineClass%28byte%5b%5d%29)

这将对您隐藏`ClassLoader`详细信息，但是使用`ClassLoader`来做您想做的事情 - 通过网络提取类字节 - 非常容易。您应该在此处发布您遇到的特定问题以及您的一些代码，并且应该有人能够给您一个有用的答案，然后您就不需要其他库了。

# c# - C#正则表达式不匹配空字符串

> ID：11123911
> 
> 赞同：1
> 
> 时间：2012-06-20T16:24:11.847
> 
> 标签：c#, regex

我正在使用以下内容来匹配一行。一条线可以像下面这样。例如，如果 field1 存在但值为 null，则它不匹配。即使 field1 等有空白或没有值，我也希望它匹配。有任何想法吗？谢谢

```
 field33
   field1 
   field2   lkjk
   field3   12.01.12

 static string partPattern = @"^(?<Key>\w+)\s+(?<Value>.*)$";

 line = line.Trim();  Match m = Regex.Match(line, partPattern);  
if(m.Groups["Key"].Length > 0) { 
 //do something heree 
} 
```

因此，当它查看 field33 时，行变为 field33 并且正则表达式条件语句失败，即使键在那里......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:32:16.307

在正则表达式模式中，`+`表示`One or More`.

尝试改用这个字符串

```
@"^(?<Key>\w+)\s+(?<Value>.*)$ 
```

`*`表示`Any Number`包括 0 。

**更新**

我测试了以下代码，并得到了这个输出。

```
 string t1 = "field1   ";
        string t2 = "field2   iopoi";
        string t3 = "field3   12.12.12";
        Regex rTest = new Regex(@"^(?<Key>\w+)\s+(?<Value>.*)$");
        if (rTest.IsMatch(t1))
        {
            MessageBox.Show("T1 match");
            foreach (Match m in rTest.Matches(t1))
                textBox1.Text += String.Format("Key: {0}\tValue: {1}\r\n", m.Groups["Key"].Value, m.Groups["Value"].Value);
        }
        textBox1.Text += "\n\n";
        if (rTest.IsMatch(t2))
        {
            MessageBox.Show("T2 match");
            foreach (Match m in rTest.Matches(t2))
                textBox1.Text += String.Format("Key: {0}\tValue: {1}\r\n", m.Groups["Key"].Value, m.Groups["Value"].Value);
        }
        textBox1.Text += "\n\n";
        if (rTest.IsMatch(t3))
        {
            MessageBox.Show("T3 match");
            foreach (Match m in rTest.Matches(t3))
                textBox1.Text += String.Format("Key: {0}\tValue: {1}\r\n", m.Groups["Key"].Value, m.Groups["Value"].Value);
        } 
```

输出：

```
Key: field1 Value: 
Key: field2 Value: iopoi
Key: field3 Value: 12.12.12 
```

我还测试了调用`.Trim()`每个初始字符串的代码。

调用后 t1 DID NOT MATCH`.Trim()`

这样做的原因是因为 .Trim 删除了 field1 或 field33 或其他任何内容之后的所有空格，并且正则表达式需要`One or More`空格字符。

**新正则表达式：**尝试改用它`@"^(?<Key>\w+)\s*(?<Value>.*)$"`

请注意，现在 \s 后面也跟着一个 *。现在它也应该在使用 Trim 后匹配。

# php - 在数据库 PHP 中搜索日期

> ID：11123914
> 
> 赞同：2
> 
> 时间：2012-06-20T16:24:15.240
> 
> 标签：php, mysql, database, phpmyadmin

当我是 PHP 的初学者时，我创建了我的数据库来将日期和时间一起存储，现在我遇到了一个大问题，我已经在数据库中有超过 3000 个订单但是当我想用日期进行搜索时遇到大麻烦，因为日期和时间在一个字段中，我试图进行查询，`where date LIKE '%$date'`但我没有得到任何结果，有人知道我现在能做什么吗？

还有我怎样才能改变整个数据库，它应该是所有日期和时间，它不应该影响我的数据库？

更新：

数据库中的数据看起来像，`10/16/2012 5:00pm`

感谢任何帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T16:30:33.820

为什么是 %$日期？你应该做相反的事情。

```
WHERE date LIKE "".$date."%" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T16:30:32.707

您可以执行以下操作：

```
$date = "2012-03-08";
$sql = "SELECT * FROM table WHERE date => '$date 00:00:00' AND date =< '$date 23:59:59' 
```

编辑：看到你的编辑，这不再起作用了。您需要将日期列转换为正确的 MySQL 日期时间或 TIMESTAMP 类型。

在当前的数据库设计中，您可以使用如下内容：

日期

```
$date = "10/16/2012";
$sql = "SELECT * FROM table WHERE date LIKE '$date%' 
```

时间

```
$time = "5:00pm";
$sql = "SELECT * FROM table WHERE date LIKE '%$time' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-20T16:34:34.777

针对您问题的各个部分：

**1.**在当前模式中查找您需要的日期。

根据您的编辑，使用：

```
 <?php

 $query = "SELECT * FROM table_name WHERE `date` LIKE '{$date}%'";

 ?> 
```

~~类似于您发布的查询应该可以帮助您：~~

 ~~```
<?php

$query = "SELECT * FROM table_name WHERE `date` LIKE '%{$date}%'";

?> 
```~~ 

~~请注意，您`%`在问题 ( `'%$date'`) 中的使用将仅匹配以 结尾的值`$date`，而我的示例 ( `'%{$date}%'`) 中的模式将匹配其中`$date`任何位置的值。或者，您可以使用`'{$date}%'`匹配值开头的日期 - 不确定您想要哪个。~~

**2.**更新您的架构以将日期和时间分成两列。

您应该在这里采取的第一步是将两列 (`date_only`和`time_only`) 添加到您的表中。接下来，更新您的代码以处理和存储这些信息*以及*`date`您当前使用的“一体化”列；您不想通过一步切换来破坏当前的代码库。一旦您可以验证日期/时间数据是否按照您希望的方式写入，第三步是从新的日期/时间列中读取（并记录）您的生产读取到`date`. 一旦您可以验证读取是否按计划工作，请切换您的开发环境以从新列中读取并进行测试，直到您确信一切正常。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-20T17:47:51.347

如果是 DATETIME 字段，则可以使用

```
WHERE DATE(datetime_field) = '01-01-2012'; 
```

或（更好，因为它可以使用索引）

```
WHERE datetime_field >= '01-01-2012 00:00:00' AND datetime_field <= '01-01-2012 23:59:59'; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-05-13T09:20:40.580

这对我有用

$日期=“2018-05-13”；

"SELECT * FROM $username WHERE reg_date LIKE '%$date%'";

# jquery - jQTouch pageAnimationStart 触发两次

> ID：11123916
> 
> 赞同：2
> 
> 时间：2012-06-20T16:24:22.980
> 
> 标签：jquery, bind, jqtouch

由于某种原因，当我使用 jQTouch pageAnimationStart 时，它会被触发两次。

例子：

```
$(this).bind('pageAnimationStart', function(e,info) {
    alert('Animation Started');
}); 
```

警报被调用两次。有任何想法吗？

我创建的解决方法似乎有效，如下所示：

```
var animation_start_count = 0;

$(document).bind('pageAnimationStart', function(e,info) {
    animation_start_count ++;

    if (animation_start_count == 1) {
        alert('Animation Started');
    }
    else {
        animation_start_count = 0;
    }
}); 
```

在我的解决方法中，警报只被调用一次。

我只创建一次 jQT 对象。小麻烦，但我想知道是否有其他人遇到过这个问题。pageAnimationEnd 的结果也相同。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T08:50:52.783

我认为有两个`pageAnimationStart`事件，因为两个页面正在动画：`toPage`和`fromPage`。也是如此`pageAnimationEnd`。

这一切都在 jqtouch.js 中的 doNavigation 方法中。

# json.net - ASP.NET Web API - 将日期序列化为 JSON - 无法让示例工作

> ID：11123920
> 
> 赞同：0
> 
> 时间：2012-06-20T16:24:43.983
> 
> 标签：json.net, asp.net-web-api

对于不熟悉 Web API 并将日期序列化为 JSON 的任何人，[这就是我正在尝试做的事情。](http://blogs.msdn.com/b/henrikn/archive/2012/02/18/using-json-net-with-asp-net-web-api.aspx)

但它对我不起作用，我的日期仍然被序列化为“/Date(1039330800000-0700)/”。

这是我的 JsonNetFormatter：

```
public class JsonNetFormatter : MediaTypeFormatter
{
    private JsonSerializerSettings _jsonSerializerSettings;

    public JsonNetFormatter(JsonSerializerSettings jsonSerializerSettings)
    {
        _jsonSerializerSettings = jsonSerializerSettings ?? new JsonSerializerSettings();

        // Fill out the mediatype and encoding we support 
        SupportedMediaTypes.Add(new MediaTypeHeaderValue("application/json"));
        Encoding = new UTF8Encoding(false, true);
    }

    protected override bool CanReadType(Type type)
    {
        if (type == typeof(IKeyValueModel))
        {
            return false;
        }

        return true;
    }

    protected override bool CanWriteType(Type type)
    {
        return true;
    }

    protected override Task<object> OnReadFromStreamAsync(Type type, Stream stream, HttpContentHeaders contentHeaders, FormatterContext formatterContext)
    {
        // Create a serializer 
        JsonSerializer serializer = JsonSerializer.Create(_jsonSerializerSettings);

        // Create task reading the content 
        return Task.Factory.StartNew(() =>
        {
            using (StreamReader streamReader = new StreamReader(stream, Encoding))
            {
                using (JsonTextReader jsonTextReader = new JsonTextReader(streamReader))
                {
                    return serializer.Deserialize(jsonTextReader, type);
                }
            }
        });
    }

    protected override Task OnWriteToStreamAsync(Type type, object value, Stream stream, HttpContentHeaders contentHeaders, FormatterContext formatterContext, TransportContext transportContext)
    {
        // Create a serializer 
        JsonSerializer serializer = JsonSerializer.Create(_jsonSerializerSettings);

        // Create task writing the serialized content 
        return Task.Factory.StartNew(() =>
        {
            using (JsonTextWriter jsonTextWriter = new JsonTextWriter(new StreamWriter(stream, Encoding)) { CloseOutput = false })
            {
                serializer.Serialize(jsonTextWriter, value);
                jsonTextWriter.Flush();
            }
        });

    }
} 
```

和我的 Global.asax.cs 文件：

```
public class WebApiApplication : System.Web.HttpApplication
{
    private static Logger Logger = NLog.LogManager.GetCurrentClassLogger();

    public static void RegisterGlobalFilters(GlobalFilterCollection filters)
    {
        filters.Add(new HandleErrorAttribute());
        filters.Add(new WebApiApplication.Filters.ExceptionHandlingAttribute());
    }

    public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.MapHttpRoute(
            name: "DefaultApi",
            routeTemplate: "api/{controller}/{id}",
            defaults: new { id = RouteParameter.Optional }
        );
    }

    protected void Application_Start()
    {
        RegisterDependencies();

        AreaRegistration.RegisterAllAreas();

        RegisterGlobalFilters(GlobalFilters.Filters);
        RegisterRoutes(RouteTable.Routes);

        JsonSerializerSettings serializerSettings = new JsonSerializerSettings();
        serializerSettings.Converters.Add(new IsoDateTimeConverter());
        GlobalConfiguration.Configuration.Formatters.Add(new JsonNetFormatter(serializerSettings));

        BundleTable.Bundles.RegisterTemplateBundles();
    }

    private void RegisterDependencies()
    {

        IUnityContainer container = new UnityContainer();
        container.RegisterInstance<IClientRepository>(new ClientRepository());

        GlobalConfiguration.Configuration.ServiceResolver.SetResolver(
            t =>
            {
                try
                {
                    return container.Resolve(t);
                }
                catch (ResolutionFailedException)
                {
                    return null;
                }
            },
            t =>
            {
                try
                {
                    return container.ResolveAll(t);
                }
                catch (ResolutionFailedException)
                {
                    return new List<object>();
                }
            });
    }

    /// <summary>
    /// Catches all exceptions.
    /// </summary>
    protected void Application_Error()
    {
        var exception = Server.GetLastError();

        Logger.Debug(exception);
    }
} 
```

根据我的阅读，这对很多人都有效。我不确定我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T17:54:59.767

您是否删除了默认添加到配置中的“旧”json 格式化程序？认为默认格式化程序可以代替您的格式化程序。在添加之前尝试删除默认的 Json 格式化程序

# android - 按钮没有样式

> ID：11123921
> 
> 赞同：0
> 
> 时间：2012-06-20T16:24:44.853
> 
> 标签：android, android-layout, button, android-widget, dashboard

我有一个按钮，我在我实现的仪表板模式中动态插入。在 onCreate 方法中，我创建了我的按钮并插入我的仪表板（名为**MainMenu**）：

```
Drawable dr = getResources().getDrawable(R.drawable.my_drawable);
Rect rect = new Rect();
rect.set(0, 0, dr.getIntrinsicWidth(), dr.getIntrinsicHeight());
dr.setBounds(rect);
button = new ImageButton(this);
int id = getResources().getIdentifier("home_button", "style", getPackageName());
button.setId(i+1);
mainMenu.addView(button); 
```

这是我在 styles.xml 中的风格：

```
 <style name="home_button">
    <item name="android:layout_gravity">center_vertical</item>
    <item name="android:layout_width">100dip</item>
    <item name="android:layout_height">100dip</item>
    <item name="android:gravity">center_horizontal</item>
    <item name="android:drawablePadding">2dp</item>
    <item name="android:textSize">16dp</item>
    <item name="android:text">"Some Text"</item>
    <item name="android:textStyle">bold</item>
    <item name="android:textColor">#ff29549f</item>
</style> 
```

当我从 getIdentifier 获取样式时，会引发 Resources.NotFoundException。消息是：

> 请求资源 0x7f060000 失败，因为它很复杂

而且我的按钮没有出现。对不起，如果我扩展了自己，但有人知道发生了什么吗？

# jquery - 使用 ddslick 在 firebug 中出错

> ID：11123922
> 
> 赞同：0
> 
> 时间：2012-06-20T16:24:47.477
> 
> 标签：jquery, jquery-ui, jquery-plugins, firebug

[使用ddslick](http://dl.dropbox.com/u/40036711/Scripts/jquery.ddslick.min.js) jquery 插件时出现以下错误。尝试太多来修复它，但我无法找出错误所在。有人可以帮助我吗？

错误

```
 c.find(".dd-select").on is not a function 
```

代码

```
<script type="text/javascript">
$(document).ready(function() {
    $('#media_idselect').ddslick({
        selectText: "Select the media",
    });

}); 
</script>
<select id="demo-htmlselect">
    <option value="0" data-imagesrc="http://dl.dropbox.com/u/40036711/Images/facebook-icon-32.png"
        data-description="Description with Facebook">Facebook</option>
    <option value="1" data-imagesrc="http://dl.dropbox.com/u/40036711/Images/twitter-icon-32.png"
        data-description="Description with Twitter">Twitter</option>
    <option value="2" selected="selected" data-imagesrc="http://dl.dropbox.com/u/40036711/Images/linkedin-icon-32.png"
        data-description="Description with LinkedIn">LinkedIn</option>
    <option value="3" data-imagesrc="http://dl.dropbox.com/u/40036711/Images/foursquare-icon-32.png"
        data-description="Description with Foursquare">Foursquare</option>
</select> 
```

jQuery 库版本：jquery-1.6.4.min.js

jQuery UI 版本：jquery-ui-1.8.16.min.js

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:59:41.373

您使用的是哪个版本的 jQuery？按照推荐使用 jquery 1.7.2 并且您的代码中有错误。您在“#media_idselect”上使用 ddscick()，其中 select 标记的 ID 是 #demo-htmlselect#

# entity-framework - 实体框架代码优先：“在模型中找不到指定的表 'foo'。”

> ID：11123923
> 
> 赞同：3
> 
> 时间：2012-06-20T16:24:51.377
> 
> 标签：entity-framework, ef-code-first, entity-framework-4.3

以前没有见过这个错误，粗略的网络搜索很少出现。这是（我认为）有问题的代码：

```
this.HasMany(a => a.ListItems).WithRequired()
    .Map(m =>
        {
            m.MapKey("AttributeId");
            m.ToTable("ProductAttributeListItem");
        }
    )
; 
```

这是完整的错误：

> 在模型中找不到指定的表“ProductAttributeListItem”。确保已正确指定表名。

桌子在那里并且拼写正确。

缺少搜索结果让我觉得我遗漏了一些明显的东西。那可能是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-20T16:42:23.297

如果要定义实体的表名`ListItems`是指您需要在实体上执行此操作，而不是在关系映射中：

```
modelBuilder.Entity<ListItem>() // or whatever the entity is called
    .ToTable("ProductAttributeListItem"); 
```

并`m.ToTable`从`Map`行动中移除。

# module - 在 D 中导入模块

> ID：11123931
> 
> 赞同：8
> 
> 时间：2012-06-20T16:25:19.040
> 
> 标签：module, d

我正在尝试在 D（语言版本 2）中使用基本模块导入。作为指导，我在 dlang.org 上使用了示例，但我的简单程序无法编译。这些文件位于同一目录中。

这是我的 main.d 文件的内容：

```
import std.stdio;
import mymodule;

void main(string[] args){
  sayHello();
  writeln("Executing Main");
} 
```

这是我的模块文件的内容（mymodule.d）：

```
void sayHello(){
  writeln("hello");

} 
```

要编译，我通过 bash 执行：

```
dmd main.d 
```

错误输出是：

```
main.o: In function `_Dmain':
main.d:(.text._Dmain+0x5): undefined reference to `_D8mymodule8sayHelloFZv'
collect2: ld returned 1 exit status
--- errorlevel 1 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-20T17:34:30.693

1.  您需要在命令行上列出您正在编译的所有模块。如果你不列出一个模块，那么它就不会被编译。*已*编译的模块将能够使用未编译的模块，因为编译器会引入它们的声明，但编译器不会为它们生成目标文件。因此，当链接器转到链接时，它会抱怨缺少定义。在这种情况下，它抱怨`mymodule.sayHello`尚未定义的事实。

    如果您希望编译器自动搜索第一个模块导入的所有模块并为您全部编译，那么您将需要使用 rdmd，它是 dmd 的包装器，它是 dmd 附带的。dmd 本身并不这样做。它只编译你告诉它的模块。

2.  你还没有`std.stdio`在 mymodule 中导入。所以，即使你`dmd main.d mymodule.d`喜欢你应该的（甚至更好，`dmd -w main.d mymodule.d`or `dmd -wi main.d mymodule.d`），它也将无法编译 mymodule，因为`writeln`尚未声明。main.d 导入它的事实对 mymodule 没有影响。

3.  虽然在这种情况下这没什么大不了的，但您确实应该`module modulename;`在模块的顶部放置一个声明。编译器会根据文件名推断模块名称，但是一旦有了子包，*就需*要这样做，否则会遇到导入问题，因为只推断出文件名，而不是包名。所以，如果你有`foo/bar/mod.d`，而你没有在 中`module`声明`mod.d`，它将被推断为`mod`，而不是`foo.bar.mod`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-20T17:47:18.393

`dmd mymodule.d main.d`

我所知道的能够独立解决依赖关系的唯一语言是 Go 和 Haskell。

# r - 在R中的大方阵内沿对角线选择较小的方阵

> ID：11123932
> 
> 赞同：1
> 
> 时间：2012-06-20T16:25:20.837
> 
> 标签：r, matrix, outer-join

首先，如果我的问题标题不清楚，请继续编辑！

所以假设我有一个方阵。

```
ex = outer(1:4, 2:5, "+")
colnames(ex) = paste(rep(c("Subj1", "Subj2"), each=2), "_", 
               rep("Factor1", each=2), ".", rep(c("A", "B")), sep="")
rownames(ex) = paste(rep(c("Subj1", "Subj2"), each=2), "_", 
               rep("Factor2", each=2), ".", rep(c("A", "B")), sep="") 
```

矩阵： ![在此处输入图像描述](../Images/1ac48a50415b1aef6c70715541512822.png)

我想提取红色框中的值，这些值基本上是每个主题内（但不是跨不同主题）因子水平的不同组合的值，并将它们按以下顺序保存到向量中：

```
[1] 3, 4, 4, 5, 7, 8, 8, 9 
```

我当然可以使用如下循环：

```
v = NULL
for(i in 1:16){if(ex2[i,2] == ex2[i,3]) v[i] = ex2[i,1]}
v = v[!is.na(v)]
v
[1] 3 4 4 5 7 8 8 9 
```

我想知道是否有更优雅的方法来做到这一点，可以考虑到受试者的数量、因素的数量以及每个因素中的级别数（假设所有因素都有相同的级别数。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T16:27:17.850

要提取红色框中的子矩阵，您可以简单地执行以下操作：

```
ex[1:2, 1:2] 
```

和

```
ex[3:4, 3:4] 
```

要将它们变成您想要的单个向量，只需执行以下操作：

```
c(ex[1:2, 1:2], ex[3:4, 3:4])
# [1] 3 4 4 5 7 8 8 9 
```

ETA：更笼统地回答您的问题：假设我们预先设置了科目和级别的数量（增加因素的数量会更复杂，除非我弄错了，因为那样它就不再是两个维矩阵）。

```
num.subjects = 2
num.levels = 2
size = num.subjects * num.levels
ex = outer(1:size, (1:size)+1, "+") 
```

我们可以得到这样的解决方案：

```
subjects = rep(1:num.subjects, each=num.levels)
v = c(sapply(1:num.subjects, function(s) ex[subjects == s, subjects == s])) 
```

`v`就是现在

```
 [1] 3 4 4 5 7 8 8 9 
```

这可以扩展到更多的科目和级别。将科目设置为 3 并将级别设置为 4 可以获得：

```
 [1]  3  4  5  6  4  5  6  7  5  6  7  8  6  7  8  9 11 12 13 14 12 13 14 15 13
[26] 14 15 16 14 15 16 17 19 20 21 22 20 21 22 23 21 22 23 24 22 23 24 25 
```

给出更多解释：创建每个个体子矩阵的列表可以非常简单地完成：

```
matrices = lapply(1:num.subjects, function(s) ex[subjects == s, subjects == s]) 
```

`matrices`就是现在：

```
[[1]]
     [,1] [,2]
[1,]    3    4
[2,]    4    5

[[2]]
     [,1] [,2]
[1,]    7    8
[2,]    8    9 
```

对于矢量版本，您必须单独连接每个然后整体连接。这实际上是上述解决方案所做的。

# asp.net-mvc-3 - asp.net mvc 3 中的元标记

> ID：11123934
> 
> 赞同：0
> 
> 时间：2012-06-20T16:25:23.067
> 
> 标签：asp.net-mvc-3, seo

我有一个 MVC3 的网站，它没有出现在谷歌搜索中。作为 SEO 优化的一部分，我想将元标记放在 _layout.cshtml 中。将元标记仅放在母版页或内容页中是否很好？什么是 SEO 更好的技术？元标记是静态的。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T18:02:44.880

1.  所有站点共有的元标记应放在 _layout.cshtml 中
2.  描述某些自定义页面的元标记应在此页面的自定义部分中定义。

例子：

```
_layout.chtml
    <head>
        <title>@Html.Raw(ViewBag.Title)</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    ... other common tags
        @RenderSection("Meta", required: false) // your section
    ...
    </head> 
```

在自定义页面中，您应该使用

```
@model SomeModel
@section Meta
{
    <meta name="description" content="your custom tag" />
// other custom tags
}
// some html or other code 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T17:06:56.470

由于元标记放置在 上`head`，它们应该只放置在布局上。您可能还想查看文章[“SEO 不仅仅是元标签和好内容”](http://www.trechic.com/seo/seo-is-more-than-meta-tags-and-good-content/)

# xcode - xcodebuild 导致致命错误，但在 Xcode 中，编译正常

> ID：11123936
> 
> 赞同：0
> 
> 时间：2012-06-20T16:25:35.517
> 
> 标签：xcode, configuration, compilation, xcodebuild

当我尝试使用 xcodebuild 进行编译时，我遇到了一件奇怪的事情。如果我在 Mac 上使用 XCode 打开项目，代码编译时没有任何警告。

如果我使用以下命令行： xcodebuild -configuration Debug -target myApp PROVISIONING_PROFILE=B5AD0E27-B224-4962-B0DC-XXXXXXXX

我有一些编译错误：/Users/myUser/.jenkins/jobs/myApp/workspace/prj/Controllers/DeclarerEtape1Adresse.m:75:6: error: receiver type 'DeclarerEtape1Adresse' 例如消息没有声明带有选择器的方法' rechercheAdresse' [4] [self rechercheAdresse]; ^ 1 个错误生成。

此错误可能出现在外部代码中（取自 github）。编译器在命令行模式下似乎比 Xcode 更严格。

命令行中是否有任何特定配置？

感谢您的反馈意见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T07:56:31.790

詹姆斯，你是老板：p 我`xcodebuild -version`在这两个环境上都试过了，而 ci 服务器使用的是旧的 SDK 4.2.X。所以我使用了`sudo xcode-select -switch /Applications/Xcode.app/Contents/Developer`它，它解决了这个问题

# javascript - 如何根据 N:N 关系检索 SOAP 中的相关记录

> ID：11123941
> 
> 赞同：4
> 
> 时间：2012-06-20T16:25:48.800
> 
> 标签：javascript, dynamics-crm-2011, dynamics-crm

我们正在尝试使用 SOAP 来检索基于 N:N 关系的相关记录。因此，我们从当前表单中检索到 1 个实体的 1 个 GUID。然后我们需要来自其他实体的所有 GUID。我们如何正确地形成我们的 SOAP 请求。

```
RetrieveContacts = function (EntityName, EntityKeyName, contactGUID) {
    // Prepare IDs to retrieve the records
    var authenticationHeader = GenerateAuthenticationHeader();

    // Prepare the SOAP message.
    var xml = "";
    xml += "<?xml version='1.0' encoding='utf-8'?>";
    xml += "<soap:Envelope xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'";
    xml += " xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'";
    xml += " xmlns:xsd='http://www.w3.org/2001/XMLSchema'>";
    xml += authenticationHeader;
    xml += "<soap:Body>";
    xml += "<RetrieveMultiple xmlns='http://schemas.microsoft.com/crm/2007/WebServices'>";
    xml += "<query xmlns:q1='http://schemas.microsoft.com/crm/2006/Query'";
    xml += " xsi:type='q1:QueryExpression'>";
    xml += "<q1:EntityName>" + EntityName + "</q1:EntityName>";
    xml += "<q1:ColumnSet xsi:type='q1:ColumnSet'>";
    xml += "<q1:Attributes>";
    xml += "<q1:Attribute>" + EntityKeyName + "</q1:Attribute>";
    xml += "</q1:Attributes>";
    xml += "</q1:ColumnSet>";
    xml += "<q1:Distinct>false</q1:Distinct>";
    xml += "<q1:Criteria>";
    xml += "<q1:Conditions>";
    xml += "<q1:Condition>";
    xml += "<q1:AttributeName>" + EntityKeyName + "</q1:AttributeName>";
    xml += "<q1:Operator>Equal</q1:Operator>";
    xml += "<q1:Values>";
    xml += "<q1:Value xsi:type='xsd:string'>" + contactGUID + "</q1:Value>";
    xml += "</q1:Values>";
    xml += "</q1:Condition>";
    xml += "</q1:Conditions>";
    xml += "</q1:Criteria>";
    xml += "</query>";
    xml += "</RetrieveMultiple>";
    xml += "</soap:Body>";
    xml += "</soap:Envelope>";
    // Prepare the xmlHttpObject and send the request.
    var xHReq = new ActiveXObject("Msxml2.XMLHTTP");
    xHReq.Open("POST", "/mscrmservices/2007/CrmService.asmx", false);
    xHReq.setRequestHeader("SOAPAction", "http://schemas.microsoft.com/crm/2007/WebServices/RetrieveMultiple");
    xHReq.setRequestHeader("Content-Type", "text/xml; charset=utf-8");
    xHReq.setRequestHeader("Content-Length", xml.length);
    xHReq.send(xml);
    // Capture the result.
    var resultXml = xHReq.responseXML;

    // Check for errors.
    var errorCount = resultXml.selectNodes('//error').length;
    if (errorCount != 0) {
        var msg = resultXml.selectSingleNode('//description').nodeTypedValue;
        alert(msg);
    }
    // Parse and display the results.
    else {
        var results = resultXml.getElementsByTagName('BusinessEntity');
        var msg = "";
        if (results.length == 0) {
            msg = "No records to submit.";
            alert(msg);
            return;
        }
        else {
            for (i = 0; i < results.length; i++) {
                var idValue = results[i].selectSingleNode('./q1:' + EntityKeyName).nodeTypedValue;
                //Now insert the new RSVP record
                msg += idValue + "\t" + name + "\r";
            }
            alert(msg);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T03:16:40.450

当然我使用的是 2011 服务，但这里是使用 JavaScript 中的 SOAP 的示例[http://blog.customereffective.com/blog/2011/05/execute-fetch-from-javascript-in-crm-2011.html](http://blog.customereffective.com/blog/2011/05/execute-fetch-from-javascript-in-crm-2011.html)

或者，您可以使用这篇文章中的内容，然后传入 FetchXML 来查询相同的信息。如果你这样做，这也可能会有所帮助......

[http://blog.customereffective.com/blog/2011/05/parsing-and-sumption-the-crm-2011-soap-service-inside-javascript.html](http://blog.customereffective.com/blog/2011/05/parsing-and-consuming-the-crm-2011-soap-service-inside-javascript.html)

# jquery - 将进一步的事件处理程序添加到 jquery datepicker 月份下拉列表

> ID：11123943
> 
> 赞同：1
> 
> 时间：2012-06-20T16:25:58.973
> 
> 标签：jquery, events, select, datepicker, handler

如果那个月没有航班，我被要求从我们的 jQuery 日期选择器的月份下拉列表中删除月份。我最初的想法是，在**beforeShow**事件中，将更改事件处理程序添加到**年**下拉列表中，该处理程序将关闭并为该年的每个月调用一个名为 monthHasFlights() 的函数（第一次手动调用它日期选择器加载）。如果 monthHasFlights() 返回 false，我将删除该月。 **问题是**......我的处理程序不会附加。

所以，在 beforeShow 事件处理程序中，我有这个：

```
$('.ui-datepicker-year').change(function(){setDropdownMonths()}); 
```

但事件永远不会附加，即使我看到这一行在 firebug/tools 中执行我对 jQuery 事件绑定的理解是，您可以根据需要多次分配更改事件，并且处理程序将按照您创建它们的顺序触发。 .但我想我错了？只是当我尝试附加事件处理程序时下拉菜单还不存在吗？我确实尝试了 100 的 setTimeout，但我的事件仍然没有附加。任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-20T16:31:29.227

可能的问题：您尝试在`datepicker`它被初始化之前进行更改。我想，完成任务的最佳方法是将函数调用添加到 inicalizing 代码中`datapicker`。

此外， .change 事件将在其附加的元素更改其状态时触发。我看不到您的 HTML 和 JQuery 代码可以肯定地说，但可能由于这个问题，该事件不会触发。

`$('.ui-datepicker-year')`你确定这个元素的 HTML 中有 CLASS，而不是 ID 吗？

* * *

更新：我在 datapicker 中找到了可以帮助您的事件：

```
beforeShow      function(input, inst) 
```

可以是一个函数，它接受一个输入字段和当前日期选择器实例并返回一个选项对象来更新日期选择器。在显示日期选择器之前调用它。代码示例

提供一个回调函数来处理 beforeShow 事件作为一个 init 选项。

```
$('.selector').datepicker({
   beforeShow: function(input, inst) { ... }
}); 
```

因此，您可以使用它事件 whule 初始化数据选择器来调用您的函数，该函数将从列表中排除空月份！

# gdb - GDB 给出分段错误（gdb...不是我的程序）

> ID：11123950
> 
> 赞同：0
> 
> 时间：2012-06-20T16:26:09.333
> 
> 标签：gdb, segmentation-fault, cluster-computing, icc

通过标题，我的意思是段错误不是正在调试的程序，而是 gdb 本身。

所以我只是想创建一个断点；当我按 gdb 时死了。

![在此处输入图像描述](../Images/bb0994802405c72fbe1331a1d4eb9978.png)

我喜欢相信这不是错误，而是背景中的一些混乱。因为这台电脑上的intel编译器（icc）已经更新了。

这台机器在具有 2 x Intel Xeon X5650 @ 2.67GHz（每个 6 核，总共 12 个，24 个多线程）、48 Gb 的 DRAM (NUMA) 和 2 个 GPU ( Tesla C2070 和 Tesla C2090 [这个没有正确安装]）。这是运行 Cent OS：

```
~$ 猫 /proc/版本
Linux 版本 2.6.32-220.17.1.el6.x86_64 (mockbuild@c6b5.bsys.dev.centos.org)
  （gcc 版本 4.4.6 20110731 (Red Hat 4.4.6-3) (GCC)）#1 SMP 周三 5 月 16 日
  2012 年英国夏令时 00:01:37
```

有任何想法吗？

# c++ - 我应该将我的程序从 C 更新到现代 C 还是 C++？

> ID：11123954
> 
> 赞同：4
> 
> 时间：2012-06-20T16:26:27.140
> 
> 标签：c++, c, compiler-construction

我有一个 1990 年代用 C 语言编写的旧程序。我想更新它，以便它适用于下一个人和现代编译器。目前我正在使用一个非常旧版本的 TurboC 进行更改。我应该专注于用现代 C 或 C++ 重写它吗？哪一个最容易更新此代码而无需重写太多并且能够重用大部分现有代码？

我的编程背景主要是 Perl、Python、PHP、Powershell 和 Visual Basic 等 hprogramming 语言，所以我不太熟悉 C 和 C++ 之间的区别。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T16:28:43.313

C 和 C++ 是不同的语言，而不是同一语言的不同版本。坚持使用 C，尽管您可以使用标准新版本（如 C99）的花哨功能。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-20T16:29:34.200

你的最后一句话几乎回答了你的情绪。如果您不熟悉这些差异并且您只知道较旧的语言，我不会更新此程序，除非它存在影响许多用户的可怕错误。

如果你有更新的编译器，你可以在 C 世界中更新它以遵守 C99 或 C11

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-20T16:42:29.567

鉴于：

有一个 1990 年代用 C 语言编写的旧程序。

你有两个问题：

我应该专注于用现代 C 重写它吗？也许，也许不是。我会尽量遵守标准的 C89、C99 或 C11。这主要取决于您的工具以及会发生多少新开发。

你喜欢在作用域的开头以外的地方声明变量吗？如果是这样，那么可能会更新到 C99。您是否正在使用任何真正喜欢 C89 并使用 C99 约定显示错误或警告的工具？如果是这样，那么坚持C89。

如果该计划不断更新并且您正在招聘年轻人，那么更新的公约可能是有益的。

我应该专注于用 C++ 重写它吗？不。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-20T16:43:01.677

大多数编写良好的 C 程序也是有效的 C++ 程序，或者只需要稍作修改。反之则不然。

坚持使用 ANSI/ISO C 并为下一个维护者打开两扇门可能更容易。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-20T16:47:51.050

迁移到现代 C 编译器与现代 C++ 编译器的努力可能大致相同。C 和 C++ 的演变发生了分歧，每个都有相似的功能，但它们不兼容源代码。

有几个因素会导致我选择更新到 C++：

*   现代 C 似乎不像 C++ 那样受到支持。例如，C 中的许多新事物似乎只能根据 C++ 的要求来实现，尤其是在 Microsoft 世界中。VS 甚至不支持 C99，除了 C++ 中的内容，更不用说 C11。

*   [C++ 是更好的 C](http://www2.research.att.com/~bs/bs_faq.html#difference)：“C++ 是‘更好的 C’，因为它支持使用 C 完成的编程风格，具有更好的类型检查和更多的符号支持（不损失效率）。” 现代版本的 C 语言仍然如此。

*   C++ 添加了支持一些非常强大的技术的特性。真正使用它们可能最好留给库开发人员，但这意味着 C++ 可以支持非常棒的库。

# python - 有没有人尝试将 redactor.js 与 django-admin 集成？

> ID：11123957
> 
> 赞同：1
> 
> 时间：2012-06-20T16:26:34.923
> 
> 标签：python, django, django-admin, wysiwyg

有没有人尝试将 redactor.js 与 django-admin 集成？

Redactor.js 是一个基于 o jquery 的 WYSIWYG 文本编辑器。[Redactor.js 网站](http://redactorjs.com)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T22:14:36.650

是的，它非常适合管理界面。查看[https://github.com/hcarvalhoalves/django-redactor](https://github.com/hcarvalhoalves/django-redactor)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-02T09:36:53.297

我在 github 上找到的所有项目多年来都没有维护，并且不支持 django 和 python 的最新版本，所以我编写了自己的[django-imperavi-widget](https://github.com/dzaytsev91/django-imperavi-widget)，它支持 python 2/3 和 django >= 1.8 版本。

# css - 将 ID 与 CSS 中的类关联

> ID：11123961
> 
> 赞同：2
> 
> 时间：2012-06-20T16:26:53.257
> 
> 标签：css

我可以在 CSS 中做一些聪明的事情来指示具有特定 ID 的元素应该始终使用一个或多个类吗？就像是：

```
 #user_info_box {
    use-class: ui-widget-content ui-corner-all;
    position: fixed;
    left: 10px;
    ...
} 
```

只有，你知道，使用实际有效的 CSS 属性。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T16:30:29.337

[LESS](http://lesscss.org/)非常适合这个。具体来说，请参见“mixins”。

```
#user_info_box {
    .ui-widget-content;
    .ui-corner-all;
    position: fixed;
    left: 10px;
    ...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T16:30:48.233

你不能在 CSS 中做到这一点，但是你可能对[SASS感兴趣](http://sass-lang.com/try.html)

```
#user_info_box {
  @extend .ui-widget-content;
  @extend .ui-corner-all;
  position: fixed;
  left: 10px;
  ...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T16:31:17.657

查看[http://lesscss.org/](http://lesscss.org/)

它将为您的 CSS 提供更大的灵活性，包括类似于您所要求的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-20T16:28:48.243

嗯，没有。不过你可以使用 javascript/jQuery。

# asp.net-mvc - 返回部分视图的 RedirectToAction 如何返回完整视图？

> ID：11123962
> 
> 赞同：4
> 
> 时间：2012-06-20T16:26:59.197
> 
> 标签：asp.net-mvc, asp.net-mvc-3, model-view-controller, partial-views

我正在重定向到一个动作，该动作又在一个`PartialView`

```
return PartialView(data); 
```

我这样做重定向：

```
return RedirectToAction("SpkAction",  new { id = ID}); 
```

重定向工作正常，我确实得到了正确的`SpkAction`。但是当 PartialView 被渲染时，它只显示`PartialView`而不是整个表单。

如何让`PartialView`显示整个表单，而不仅仅是`PartialView`使用 a`RedirectToAction`来执行返回 a 的操作`PartialView`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-20T16:27:58.780

> 如何让 PartialView 显示整个表单，而不仅仅是使用 RedirectToAction 的 PartialView，该 RedirectToAction 转到返回 PartialView 的操作？

**你不能。**

如果你重定向到一个返回一个`PartialView`如何以你的名义返回一个完整视图的动作，你希望它返回一个完整的视图吗？

重定向到返回 a 的操作`View`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T16:32:16.423

您应该做的是在视图中呈现操作，而不是从控制器重定向到它。将此放置在您希望部分显示在您的视图中的位置：

```
@Html.Action("SpkAction", new { id = ID}) 
```

如果您使用的是 Razor 视图引擎。

否则重定向到仅呈现部分的操作将导致仅该部分在浏览器中可见。

# select - css3pie 选择边框半径

> ID：11123964
> 
> 赞同：0
> 
> 时间：2012-06-20T16:27:05.843
> 
> 标签：select, css, css3pie

我正在尝试使用 CSS3PIE 来圆化选择元素的边缘。我正在使用下面的代码并在 IE7 中运行。我得到的行为看起来好像在选择元素的右下角有两个圆形结节。我会假设元素试图以某种方式使边缘变圆，但是比例和/或位置没有正确传递给创建的外部元素。其他人有这个问题或知道如何解决它？

CSS

```
select
{
        behavior: url(http:\\pc-653336\APTEIT\HTC\PIE.htc);
}

select
{
    border:1px solid black;

    border-radius: 10px;
} 
```

HTML

```
<html>
<head>
<link rel="Stylesheet" href="test.css" />
</head>
<body>
<div id="divy"><select></select></div>
</body>
</html> 
```

# r - R 跳过 /dev/stdin 中的行

> ID：11123969
> 
> 赞同：4
> 
> 时间：2012-06-20T16:27:23.330
> 
> 标签：r, terminal

我有一个包含数字列表的文件（自己制作：）`for x in $(seq 10000); do echo $x; done > file`。

```
$> R -q -e "x <- read.csv('file', header=F); summary(x);"

> x <- read.csv('file', header=F); summary(x);
       V1       
 Min.   :    1  
 1st Qu.: 2501  
 Median : 5000  
 Mean   : 5000  
 3rd Qu.: 7500  
 Max.   :10000 
```

现在，人们可能期望`cat`ing 文件和读取 from`/dev/stdin`具有相同的输出，但事实并非如此：

```
$> cat file | R -q -e "x <- read.csv('/dev/stdin', header=F); summary(x);"
> x <- read.csv('/dev/stdin', header=F); summary(x);
       V1       
 Min.   :    1  
 1st Qu.: 3281  
 Median : 5520  
 Mean   : 5520  
 3rd Qu.: 7760  
 Max.   :10000 
```

使用`table(x)`显示跳过了一堆行：

```
 1  1042  1043  1044  1045  1046  1047  1048  1049  1050  1051  1052  1053 
    1     1     1     1     1     1     1     1     1     1     1     1     1 
 1054  1055  1056  1057  1058  1059  1060  1061  1062  1063  1064  1065  1066 
    1     1     1     1     1     1     1     1     1     1     1     1     1
 ... 
```

看起来 R 正在做一些有趣的事情`stdin`，因为这个 Python 将正确打印文件中的所有行：

```
cat file | python -c 'with open("/dev/stdin") as f: print f.read()' 
```

* * *

[这个问题](https://stackoverflow.com/questions/8568968/r-programming-read-csv-skips-lines-unexpectedly)似乎是相关的，但更多的是关于在格式错误的 CSV 文件中跳过行，而我的输入只是一个数字列表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T13:38:53.280

`head --bytes=4K file | tail -n 3`

产生这个：

```
1039
1040
104 
```

这表明 R 在 /dev/stdin 上创建了一个大小为 4KB 的输入缓冲区，并在初始化期间填充它。当您的 R 代码读取 /dev/stdin 时，它会在此时从文件中开始：

```
 1
1042
1043
... 
```

实际上，如果在文件中将行替换为 ，则会在以下`1041`内容中`1043`得到“3”而不是“1” `table(x)`：

```
3  1042  1043  1044  1045  1046  1047  1048  1049  1050  1051  1052  1053 
1     1     1     1     1     1     1     1     1     1     1     1     1 
... 
```

第一个`1`实际上`table(x)`是 的最后一个数字`1041`。前 4KB 的文件已被吃掉。

# asp.net-mvc - 从数据驱动的菜单中处理静态内容路由/控制器/视图的最小方法？

> ID：11123971
> 
> 赞同：3
> 
> 时间：2012-06-20T16:27:30.607
> 
> 标签：asp.net-mvc, asp.net-mvc-3, controller, routes

我有一个 ListItem 类，用于表示我的应用程序中的菜单项：

```
 public class ListItem : Entity
{
    public virtual List List { get; set; }
    public virtual ListItem ParentItem { get; set; }
    public virtual ICollection<ListItem> ChildItems { get; set; }

    public int SortOrder { get; set; }
    public string Text { get; set; }
    public string Controller { get; set; }
    public string Action { get; set; }
    public string Area { get; set; }
    public string Url { get; set; }
} 
```

我使用这些数据来构造应用程序的路由，但我想知道是否有一种干净的方法来处理静态内容的控制器/视图？基本上任何不使用任何数据而只使用视图的页面。现在我有一个名为 StaticContentController 的控制器，它包含每个静态页面的唯一操作，该操作返回适当的视图，如下所示：

```
public class StaticContentController : Controller
{

    public ActionResult Books()
    {
        return View("~/Views/Books/Index.cshtml");
    }

    public ActionResult BookCategories()
    {
        return View("~/Views/Books/Categories.cshtml");
    }

    public ActionResult BookCategoriesSearch()
    {
        return View("~/Views/Books/Categories/Search.cshtml");
    }
} 
```

有什么方法可以最小化这种情况，这样我就不必为静态内容设置这么多控制器/动作了吗？似乎在创建我的 ListItem 数据时，我可以将控制器设置为处理静态内容的特定控制器，就像我所做的那样，但是无论如何使用一个函数来计算要返回的视图？似乎我仍然需要单独的操作，否则我将不知道用户试图访问哪个页面。

ListItem.Url 包含来自用于创建路由的应用程序根目录的完整 URL 路径。项目中视图的位置将对应于 URL 位置，以保持组织结构平行。

有什么建议么？谢谢。

编辑：我的路线注册如下所示：

```
public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");
        routes.IgnoreRoute("Shared/{*pathInfo}");
        routes.MapRoute("Access Denied", "AccessDenied", new { controller = "Shared", action = "AccessDenied", area = "" });
        List<ListItem> listItems = EntityServiceFactory.GetService<ListItemService>().GetAllListItmes();
        foreach (ListItem item in listItems.Where(item => item.Text != null && item.Url != null && item.Controller != null).OrderBy(x => x.Url))
        {
            RouteTable.Routes.MapRoute(item.Text + listItems.FindIndex(x => x == item), item.Url.StartsWith("/") ? item.Url.Remove(0, 1) : item.Url, new { controller = item.Controller, action = item.Action ?? "index" });
        }

        routes.MapRoute(
            "Default", // Route name
            "{controller}/{action}/{id}", // URL with parameters
            new { controller = "Home", action = "Index", id = UrlParameter.Optional } // Parameter defaults
        );

    } 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-21T14:41:00.090

您可以使用带有一个参数（视图名称）的单个操作，这将返回所有静态页面

```
public class StaticContentController : Controller
{
    public ActionResult Page(string viewName)
    {
        return View(viewName);
    }
} 
```

您还需要创建一个自定义路由来提供这些视图，例如：

```
routes.MapRoute(
    "StaticContent",                                      // Route name
    "page/{viewName}",                                    // URL with parameters
    new { controller = "StaticContent", action = "Page" } // Parameter defaults
); 
```

我在您的示例中看到您为视图指定了不同的文件夹。此解决方案将强制您将所有静态视图放在 StaticContentController 的 Views 文件夹中。

如果您必须具有自定义文件夹结构，那么您可以`/`通过添加`*`到`{viewName}`like this来更改要接受的路由`{*viewname}`。现在你可以使用这条路线：`/page/Books/Categories`. 在`viewName`输入参数中，您将收到`"Books/Categories"`，然后您可以根据需要返回它：`return View(string.Format("~/Views/{0}.cshtml", viewName));`

**更新（避免`page/`前缀）**

这个想法是有一个自定义约束来检查文件是否存在。给定 URL 存在的每个文件都将被视为静态页面。

```
public class StaticPageConstraint : IRouteConstraint
{
    public bool Match(HttpContextBase httpContext, Route route, string parameterName, RouteValueDictionary values, RouteDirection routeDirection)
    {
        string viewPath = httpContext.Server.MapPath(string.Format("~/Views/{0}.cshtml", values[parameterName]));

        return File.Exists(viewPath);
    }
} 
```

更新路线：

```
routes.MapRoute(
    "StaticContent",                                       // Route name
    "{*viewName}",                                         // URL with parameters
    new { controller = "StaticContent", action = "Page" }, // Parameter defaults
    new { viewName = new StaticPageConstraint() }          // Custom route constraint
); 
```

更新动作：

```
public ActionResult Page(string viewName)
{
    return View(string.Format("~/Views/{0}.cshtml", viewName));
} 
```

# mysql - 更改 mysql 中 smallint 数据类型的格式

> ID：11123973
> 
> 赞同：0
> 
> 时间：2012-06-20T16:27:41.763
> 
> 标签：mysql

我有一个以 NUMBER 作为主键的表，数据类型是 SMALLINT。如何格式化该字段的值，以便显示为 0001 而不是 1 等等？谢谢！顺便说一句，我正在使用 mySQL 工作台 5.2.40

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T16:31:30.647

将其更改为`SMALLINT(4) ZEROFILL`. zerofill 将用零填充数字到指定的长度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T12:37:11.967

在我看来，格式化应该按需完成，而不是在模式中。

```
SELECT LPAD(id, 4, '0') FROM ... 
```

# visual-studio-2010 - VisualStudio 2010：在文本编辑器配色方案之间快速切换？（用于 LCD 与投影仪）

> ID：11123978
> 
> 赞同：0
> 
> 时间：2012-06-20T16:28:00.613
> 
> 标签：visual-studio-2010, plugins, color-scheme

在 VS2010 中，我有一个自定义的文本编辑器配色方案，它具有黑色背景和浅灰色文本。这对我自己在 LCD 显示器上工作非常有用。但是，我经常需要插入投影仪才能向组显示代码。黑色背景配色方案在投影仪上根本无法正常工作，所以我总是想回到基本的“默认”配色方案。

我现在知道的唯一方法是将 VS 颜色设置导出到备份文件，然后恢复为默认值。完成小组演示后，我可以重新导入之前导出的颜色设置。

有谁知道这样做的更简单/更少手动的方法？就像一个让您在文本编辑器配色方案之间切换的插件，或者只是一个宏来执行上面的手动过程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T11:51:20.980

我发现这篇关于如何制作宏和菜单项以快速导出/导入字体和颜色的文章：http: [//jeffhandley.com/archive/2010/03/09/225.aspx](http://jeffhandley.com/archive/2010/03/09/225.aspx)

# git - 使用 Git 进行协作编程

> ID：11123979
> 
> 赞同：3
> 
> 时间：2012-06-20T16:28:02.973
> 
> 标签：git, collaboration

使用 Git 时有没有办法锁定文件？或者我将如何着手并通知同事我正在更改 Java 类，以便他们不会开始处理它？Git中有什么东西可以防止这样的事情发生吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T16:32:30.493

理想情况下，您可以在同事编辑文件的同时编辑文件，git 会帮助您将更改合并在一起。文件锁定不是 Git 允许的，它们更喜欢良好的沟通和协作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T16:31:43.407

不，无法在 Git 中锁定文件，但 Veracity 是支持锁定的 Git 的替代方案。但是，即使在那里，[它也打算用于二进制文件，而不是文本文件](http://veracity-scm.com/qa/questions/102/why-would-you-design-a-dvcs-in-2011-that-supports-file-locks-dvcs-are-meant-to-make-it-needless-to-worry-about-that)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T19:09:12.310

你需要一个分支。只有你需要这个修改？您无需与他人分享。创建一个本地分支并使用它。

# scala - 哪个 GOF 设计模式具有完全不同的实现（java vs Scala）

> ID：11123984
> 
> 赞同：31
> 
> 时间：2012-06-20T16:28:35.600
> 
> 标签：scala, design-patterns

最近我阅读了以下 SO 问题：

> 在 Scala 中是否有使用访问者模式的用例？每次在 Java 中使用访问者模式时，是否应该在 Scala 中使用模式匹配？

标题为问题的链接： [Scala 中的访问者模式](https://stackoverflow.com/questions/8618082/visitor-pattern-in-scala)。接受的答案以

> 是的，您可能应该从模式匹配而不是访问者模式开始。请参阅此 [http://www.artima.com/scalazine/articles/pattern_matching.html](http://www.artima.com/scalazine/articles/pattern_matching.html)

我的问题（受上述问题的启发）是哪种 GOF 设计模式在 Scala 中有完全不同的实现？如果我在 Scala 中编程，我应该在哪里小心而不遵循基于 Java 的设计模式（四人组）编程模型？

**创造模式**

*   抽象工厂
*   建造者
*   工厂方法
*   原型
*   单例：*直接创建一个对象（scala）*

**结构图案**

*   适配器
*   桥
*   合成的
*   装饰器
*   正面
*   蝇量级
*   代理

**行为模式**

*   责任链
*   命令
*   口译员
*   迭代器
*   调解员
*   纪念
*   观察者
*   状态
*   战略
*   模板法
*   访问者：*Patten Matching (scala)*

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-06-20T20:15:43.440

对于几乎所有这些，有 Scala 替代方案涵盖了这些模式的*一些但不是全部*用例。当然，所有这些都是 IMO，但是：

## 创作模式

### 建造者

Scala 使用泛型类型可以比 Java 更优雅地做到这一点，但总体思路是相同的。在 Scala 中，该模式最简单地实现如下：

```
trait Status
trait Done extends Status
trait Need extends Status

case class Built(a: Int, b: String) {}
class Builder[A <: Status, B <: Status] private () {
  private var built = Built(0,"")
  def setA(a0: Int) = { built = built.copy(a = a0); this.asInstanceOf[Builder[Done,B]] }
  def setB(b0: String) = { built = built.copy(b = b0); this.asInstanceOf[Builder[A,Done]] }
  def result(implicit ev: Builder[A,B] <:< Builder[Done,Done]) = built
}
object Builder {
  def apply() = new Builder[Need, Need]
} 
```

（如果你在 REPL 中尝试这样做，请确保类和对象 Builder 定义在同一个块中，即使用`:paste`。）检查类型与`<:<`、泛型类型参数和案例类的复制方法的组合使得一个非常强大的组合。

### 工厂方法（和抽象工厂方法）

工厂方法的主要用途是使您的类型保持直截了当；否则你也可以使用构造函数。使用 Scala 强大的类型系统，您不需要帮助来保持类型的正确性，因此您也可以使用`apply`类的伴随对象中的构造函数或方法并以这种方式创建事物。特别是在伴随对象的情况下，保持接口一致并不比保持工厂对象中的接口一致更难。因此，工厂对象的大部分动机都消失了。

类似地，抽象工厂方法的许多情况可以通过从适当的特征继承的伴随对象来替换。

### 原型

当然，被覆盖的方法等在 Scala 中占有一席之地。[但是，在设计模式](http://www.javacamp.org/designPattern/)网站上用于原型模式的示例在 Scala（或 Java IMO）中是相当不可取的。但是，如果您希望超类根据其子类选择操作而不是让它们自己决定，那么您应该使用`match`而不是笨拙的`instanceof`测试。

### 辛格尔顿

Scala 使用`object`. 他们是单身人士——使用和享受！

## 结构模式

### 适配器

Scala`trait`在这里提供了更多的功能——而不是创建一个实现接口的类，例如，您可以创建一个仅实现*部分*接口的 trait，其余部分由您定义。比如 `java.awt.event.MouseMotionListener`要求你填写两个方法：

```
def mouseDragged(me: java.awt.event.MouseEvent)
def mouseMoved(me: java.awt.event.MouseEvent) 
```

也许您想忽略拖动。然后你写一个`trait`：

```
trait MouseMoveListener extends java.awt.event.MouseMotionListener {
  def mouseDragged(me: java.awt.event.MouseEvent) {}
} 
```

现在你只能`mouseMoved`在继承这个时才能实现。所以：类似的模式，但 Scala 更强大。

### 桥

您可以在 Scala 中编写桥梁。这是一个巨大的样板，虽然没有Java那么糟糕。我不建议经常将其用作抽象方法；首先仔细考虑你的接口。请记住，随着特征功能的增强，您通常可以使用它们来简化更复杂的界面，否则您可能会想写一个桥梁。

在某些情况下，您可能希望编写接口转换器而不是 Java 桥接模式。例如，也许您想使用相同的界面来处理鼠标的拖动和移动，只有一个布尔标志来区分它们。那么你就可以

```
trait MouseMotioner extends java.awt.event.MouseMotionListener {
  def mouseMotion(me: java.awt.event.MouseEvent, drag: Boolean): Unit
  def mouseMoved(me: java.awt.event.MouseEvent) { mouseMotion(me, false) }
  def mouseDragged(me: java.awt.event.MouseEvent) { mouseMotion(me, true) }
} 
```

这使您可以跳过大部分桥接模式样板，同时实现高度的实现独立性，并且仍然让您的类遵守原始接口（因此您不必继续包装和解包它们）。

### 合成的

使用案例类特别容易实现复合模式，尽管进行更新相当费力。它在 Scala 和 Java 中同样有价值。

### 装饰器

装饰师很尴尬。如果继承不是您想要的，您通常不想在不同的类上使用相同的方法；你真正想要的是同一个类上的不同方法，它可以做你想做的事情，而不是默认的事情。“[丰富我的图书馆”模式](https://stackoverflow.com/questions/11053214)通常是更好的替代品。

### 正面

Facade 在 Scala 中比在 Java 中效果更好，因为您可以让特征携带部分实现，因此在组合它们时您不必自己完成*所有工作。*

### 蝇量级

尽管享元思想在 Scala 中与 Java 一样有效，但您可以使用更多工具来实现它：`lazy val`，除非实际需要，否则不会创建变量（然后被重用），并且`by-name parameters`，您只执行如果函数实际使用该值，则创建函数参数所需的工作。也就是说，在某些情况下，Java 模式保持不变。

### 代理

在 Scala 中的工作方式与 Java 相同。

## 行为模式

### 责任链

在您可以按顺序列出责任方的情况下，您可以

```
xs.find(_.handleMessage(m)) 
```

假设每个人都有一个`handleMessage`方法，`true`如果消息被处理则返回。如果您想在消息发生时对其进行变异，请改用折叠。

由于很容易将责任方归`Buffer`为某种类型，Java 解决方案中使用的复杂框架很少在 Scala 中占有一席之地。

### 命令

这种模式几乎完全被函数所取代。例如，而不是所有

```
public interface ChangeListener extends EventListener {
  void stateChanged(ChangeEvent e)
}
...
void addChangeListener(ChangeListener listener) { ... } 
```

你只是

```
def onChange(f: ChangeEvent => Unit) 
```

### 口译员

Scala 提供的[解析器组合](http://debasishg.blogspot.com/2008/04/external-dsls-made-easy-with-scala.html)器比作为设计模式建议的简单解释器要强大得多。

### 迭代器

Scala 已`Iterator`内置到其标准库中。`Iterator`让你自己的类扩展或几乎是微不足道的`Iterable`；后者通常更好，因为它使重用变得微不足道。绝对是一个好主意，但如此简单，我几乎不会称之为模式。

### 调解员

这在 Scala 中运行良好，但通常对可变数据有用，如果不小心使用，即使中介也可能与竞争条件发生冲突。相反，尽可能尝试将您的相关数据全部存储在一个不可变集合、案例类或其他任何东西中，并且在进行需要协调更改的更新时，同时更改所有内容。这不会帮助您与 交互`javax.swing`，但在其他方面广泛适用：

```
case class Entry(s: String, d: Double, notes: Option[String]) {}

def parse(s0: String, old: Entry) = {
  try { old.copy(s = s0, d = s0.toDouble) }
  catch { case e: Exception => old }
} 
```

当您需要处理多个不同的关系（每个关系一个中介）或当您有可变数据时，请保存中介模式。

### 纪念

`lazy val`对于备忘录模式的许多最简单的应用程序来说几乎是理想的，例如

```
class OneRandom {
  lazy val value = scala.util.Random.nextInt
}
val r = new OneRandom
r.value  // Evaluated here
r.value  // Same value returned again 
```

您可能希望创建一个专门用于惰性评估的小类：

```
class Lazily[A](a: => A) {
  lazy val value = a
}
val r = Lazily(scala.util.Random.nextInt)
// not actually called until/unless we ask for r.value 
```

### 观察者

这充其量是一个脆弱的模式。尽可能支持保持不可变状态（请参阅 Mediator），或者使用参与者，其中一个参与者向所有其他参与者发送有关状态更改的消息，但每个参与者都可以应对过时的情况。

### 状态

这在 Scala 中同样有用，实际上是在应用于无方法特征时创建枚举的首选方式：

```
sealed trait DayOfWeek
final trait Sunday extends DayOfWeek
...
final trait Saturday extends DayOfWeek 
```

（通常你会希望工作日做一些事情来证明这个样板数量是合理的）。

### 战略

这几乎完全被让方法采用实现策略的功能并提供可供选择的功能所取代。

```
def printElapsedTime(t: Long, rounding: Double => Long = math.round) {
  println(rounding(t*0.001))
}
printElapsedTime(1700, math.floor)  // Change strategy 
```

### 模板法

特征在这里提供了更多可能性，因此最好将它们视为另一种模式。您可以从抽象级别的尽可能多的信息中填写尽可能多的代码。我真的不想把它叫做同样的东西。

### 游客

在[结构类型](http://markthomas.info/blog/?p=66)和[隐式转换](http://tomjefferys.blogspot.com/2011/11/implicit-conversions-in-scala.html)之间，Scala 比 Java 的典型访问者模式具有惊人的更多功能。使用原始模式没有意义；你只会从正确的方法上分心。许多示例实际上只是希望在被访问的事物上定义一个函数，Scala 可以为您做些微不足道的事情（即将任意方法转换为函数）。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-06-20T21:03:31.647

好的，让我们简单看看这些模式。我纯粹从函数式编程的角度来看待所有这些模式，而忽略了许多 Scala 从 OO 角度可以改进的东西。Rex Kerr 的答案为我自己的答案提供了一个有趣的反驳点（我在写完自己的答案后才阅读他的答案）。

考虑到这一点，我想说研究持久数据结构（功能纯数据结构）和 monad 很重要。如果你想深入，我认为范畴论基础很重要——范畴论可以正式描述所有程序结构，包括命令式结构。

# 创作模式

构造函数只不过是一个函数。例如，类型 T 的无参数构造函数只不过是一个函数`() => T`。事实上，Scala 的函数语法糖在案例类中得到了利用：

```
case class T(x: Int) 
```

这相当于：

```
class T(val x: Int) { /* bunch of methods */ }
object T {
  def apply(x: Int) = new T(x)
  /* other stuff */
} 
```

这样您就可以`T`使用`T(n)`而不是`new T(n)`. 你甚至可以这样写：

```
object T extends Int => T {
  def apply(x: Int) = new T(x)
  /* other stuff */
} 
```

它变成`T`了一个正式的函数，无需更改任何代码。

这是在考虑创建模式时要牢记的重要一点。那么让我们来看看它们：

## 抽象工厂

这个不太可能发生太大变化。一个类可以被认为是一组密切相关的函数，因此一组密切相关的函数很容易通过一个类来实现，这就是这种模式对构造函数的作用。

## 建造者

构建器模式可以被柯里化函数或部分函数应用程序替换。

```
def makeCar: Size => Engine => Luxuries => Car = ???
def makeLargeCars = makeCar(Size.Large) _

def makeCar: (Size, Engine, Luxuries) => Car = ???
def makeLargeCars = makeCar(Size.Large, _: Engine, _: Luxuries) 
```

## 工厂方法

如果您放弃子类化，就会过时。

## 原型

不会改变——事实上，这是在函数式数据结构中创建数据的常用方法。请参阅案例类`copy`方法，或返回集合的集合上的所有非可变方法。

## 辛格尔顿

当您的数据不可变时，单例并不是特别有用，但 Scala`object`实现这种模式是一种安全的方式。

# 结构模式

这主要与数据结构有关，而函数式编程的重点是数据结构通常是不可变的。您最好查看持久数据结构、monad 和相关概念，而不是尝试翻译这些模式。

并不是说这里的某些模式不相关。我只是说，作为一般规则，您应该研究上述内容，而不是试图将结构模式转换为功能等价物。

## 适配器

这种模式与类（名义类型）有关，所以只要你有它，它仍然很重要，而当你没有它时，它就无关紧要了。

## 桥

与OO架构相关，同上。

## 合成的

很多在镜头和拉链。

## 装饰器

装饰器只是功能组合。如果你正在装饰整个班级，那可能不适用。但是，如果您将功能作为函数提供，那么在保持其类型的同时组合函数就是装饰器。

## 正面

与桥的评论相同。

## 蝇量级

如果您将构造函数视为函数，请将享元视为函数记忆。此外，享元本质上与如何构建持久性数据结构相关，并且从不变性中受益匪浅。

## 代理

与适配器相同的注释。

# 行为模式

这到处都是。其中一些是完全无用的，而另一些在功能环境中与往常一样相关。

## 责任链

和装饰器一样，这是功能组合。

## 命令

这是一个功能。如果您的数据是不可变的，则不需要撤消部分。否则，只需保留一对函数及其相反。另请参阅镜头。

## 口译员

这是一个单子。

## 迭代器

只需将函数传递给集合即可使其过时。`Traversable`实际上，这`foreach`就是 。另请参阅 Iteratee。

## 调解员

仍然相关。

## 纪念

对不可变对象无用。此外，它的重点是保持封装，这不是 FP 中的主要问题。

请注意，此模式不是序列化，这仍然是相关的。

## 观察者

相关，但请参阅功能响应式编程。

## 状态

这是一个单子。

## 战略

策略是一种功能。

## 模板法

这是一种 OO 设计模式，因此它与 OO 设计相关。

## 游客

访问者只是接收函数的方法。事实上，这就是`Traversable`'s 的`foreach`作用。

在 Scala 中，它也可以用提取器代替。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-20T16:40:57.647

我想，`Command`函数式语言根本不需要模式。而不是在对象内部封装命令函数然后选择合适的对象，只需使用合适的函数本身。

`Flyweight`只是缓存，并且在大多数函数式语言中都有默认实现（在 clojure 中的*memoize ）*

Even `Template method`, `Strategy`and`State`可以通过在方法中传递适当的函数来实现。

所以，我建议你在尝试函数式风格时不要深入设计模式，而是阅读一些关于函数式概念的书籍（高阶函数、惰性、柯里化等）

# c# - 从表中获取数据到 ASP.NET Web 应用程序

> ID：11123985
> 
> 赞同：0
> 
> 时间：2012-06-20T16:28:38.100
> 
> 标签：c#, asp.net, database-connection, connection-string

我正在使用 Visual Studio 2010 构建一个 ASP.NET Web 应用程序，我正在从数据库中的信息动态填充（部分）站点地图。现在，我的 App_Data 文件夹中只有一个名为 DrugTest.mdf 的虚拟表。该表只是名为 DrugTest1，它只有一个字段 DrugName。我碰壁的地方实际上是从该表中获取数据。我感到困惑的一部分是连接字符串。我查看了很多关于连接字符串的不同信息，最值得注意的是[http://www.connectionstrings.com/](http://www.connectionstrings.com/)，但我对如何将所述信息实际应用到这个项目有点困惑。

编辑：我使用的是 SQL Server 2008 RC。

例如：`Data Source=myServerAddress;Initial Catalog=myDataBase;User Id=myUsername;Password=myPassword;`

密码和用户 ID 是不言自明的，但据我所知，我没有得到其中任何一个，我只是在 App_Data 文件夹中添加了一个表并用虚拟数据填充它。ServerAddress 有点令人困惑，因为这些信息并没有真正存储在服务器上，它只是存储在本地。老实说，我不确定初始目录的含义。这是填充子树的代码。您会注意到连接字符串留空。

```
string connString = ""; // get the connection string
string commandString = "SELECT drugName FROM DrugTable1";

SqlConnection connection = new SqlConnection(connString); // connect to db
SqlCommand command = new SqlCommand(commandString, connection); // set up the command
SqlDataAdapter adapter = new SqlDataAdapter(command);
DataSet drugs = new DataSet();
adapter.Fill(drugs);

foreach (DataRow row in drugs.Tables[0].Rows)
{
    string drugName = row["Name"] + "";
    SiteMapNode node = new SiteMapNode(this, drugName,
                        "~/PlaceHolderUrl?path=" + drugName,
                        drugName);
    AddNode(node, root);
} 
```

此外，我有一个挥之不去的怀疑，即我不会以正确的方式处理这件事。我认为一旦数据库启动并运行，这将是正确的实现，但现在我只想让它工作，所以它准备好了 - 只需输入正确的连接字符串和表/字段名称。

所以，最后，我的问题是：我将如何连接到这个本地表？我的连接字符串应该是什么格式？我注意到有很多。有没有更好的方法来做到这一点/我做错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T16:37:34.517

尝试将连接字符串的初始目录部分替换为`AttachDbFilename=|DataDirectory|DrugTest.mdf`.

此外，如果您使用的是 SQL Server Express，则可能需要在数据源中包含该实例，因此可以尝试`Data Source=mySeverAddress\SQLExpress`，其中 SQLExpress 是实例名称。

顺便说一句，在[http://www.connectionstrings.com](http://www.connectionstrings.com)站点上，如果您向下滚动到标题为“在连接时附加位于数据目录中的数据库文件”的部分，您可以在 SQL Server 2008 页面中找到此信息到本地 SQL Server Express 实例。”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T16:48:11.490

另一种获取正确连接字符串的方法在 ServerExplorer 窗口中检查

*   在菜单上单击查看-> 服务器资源管理器
*   在服务器资源管理器窗口中找到 DrugTest.mdf
*   右键单击该文件并选择属性

![在此处输入图像描述](../Images/9701f404a2b4d07763c6fb455118699b.png)

*   您可以在属性中看到正确的连接字符串
*   复制连接字符串并使用

注意：文件位置是硬编码的。您可能需要`|DataDirectory|`稍后使用

# c# - 有没有 CSV 序列化器之类的东西？（类似于 XmlSerializer）

> ID：11123995
> 
> 赞同：15
> 
> 时间：2012-06-20T16:29:09.337
> 
> 标签：c#, serialization, csv

我正在玩弄 CSV 文件的序列化和反序列化，我想知道是否有一个现有的库，在概念上类似于 XmlSerializer，它可以声明性地定义对象并将它们（反）序列化到/从文件或流中。我环顾四周，但没有发现任何专注于序列化的东西。我已经有非常可靠的代码来解析每个 RFC 4180 的 CSV 文档，但真正有用的是序列化部分。我*不*想要的只是一个解析器，使用 String.Split() 的建议等。

**那里有现成的项目，还是我应该建立一个？**

额外的礼仪问题：如果我最终推出了自己的序列化程序，是否适合用 codeplex 项目的链接来回答这个问题？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2014-08-03T09:36:25.403

为此，我强烈推荐[servicestack.text 。](https://github.com/ServiceStack/ServiceStack.Text)可在 nuget 上使用：

```
Install-package servicestack.text 
```

它支持对许多数据格式的序列化，并且与内置的 XmlSerializer 不同，您不需要使用属性来装饰所有属性。这是一个序列化为 CSV 的示例。

```
using ServiceStack.Text;
...

var csv = CsvSerializer.SerializeToCsv(new[]{
    new Dog () {
    Bark = "Woof!",
    Male = true,
    Size = 10
}}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-20T16:34:23.997

我过去曾使用过[这个项目 (CsvHelper)](https://github.com/JoshClose/CsvHelper)，它的工作方式类似于 .NET 序列化程序类中的构建，因为您使用属性来制作输入/输出。

真的没有必要自己动手，因为那里有很多。如果您最终自己滚动，请随时发布。大多数用户在用他们自己（或以某种方式关联）编写的内容回答问题时，通常会出于礼貌而给出免责声明。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T16:33:37.573

您应该查看[FileHelpers Library](http://filehelpers.sourceforge.net/)。

他们网站上的一些示例代码：

```
using FileHelpers; 

// First declare the record class 
[DelimitedRecord(",")] 
public class SampleType 
{ 
    public string Field1; 
    public int    Field2; 
} 

public void WriteExample() 
{ 
    FileHelperEngine engine = new FileHelperEngine(typeof(SampleType)); 

    SampleType[] records = new SampleType[1]; 

    records[0] = new SampleType(); 
    records[0].Field1 = "Hello World"; 
    records[0].Field2 = 12; 

    engine.WriteFile("destination.txt", records); 

    // Now the file contains the created record in this format: 
    //  
    // Hello World,12 
} 
```

# contacts - 如何在 Tridion 2011 中删除代码中的 Audience Manager 联系人？

> ID：11123996
> 
> 赞同：2
> 
> 时间：2012-06-20T16:29:25.277
> 
> 标签：contacts, tridion

我正在使用 Tridion.OutboundEmail.ContentDelivery.Profile.Contact，但找不到任何删除联系人的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T11:45:02.157

Content Delivery API 中没有这样的选项。

您只能在 Content Manager 端删除联系人。使用 Tridion.AudienceManagement.API.Contact.Delete() 删除您的联系人。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T17:07:09.757

您使用的是什么版本的 Tridion？

在 2011 SP1 中，有用于联系人的新 API 命名空间。AFAIK，有可能在 2011 年病房，但不是在 2009 年（只读 API？）。

命名空间：Tridion.AudienceManagement.API。以下是 API Docs 中的示例

```
TcmUri uri = new TcmUri(3, 456, TcmItemTypes.Contact);
Contact contact = new Contact(uri);
contact.Delete(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T16:39:16.303

删除用户只能在 Content Manager API 上进行。或者至少 Content Manager 的 API 文档提到了 Contact.Delete 方法，而 Content Delivery API 的 API 文档中没有提到。

# java - Java日历添加问题

> ID：11123997
> 
> 赞同：3
> 
> 时间：2012-06-20T16:29:27.790
> 
> 标签：java, calendar

我在使用 Java 日历 add() 功能时遇到问题。给予或接受用于为在旅游网站上出发的日期提供一个迂回日期。

```
end.add(Calendar.DATE, Integer.parseInt(giveOrTake)); 
```

代码在上面，我使用的测试条件是选择 29/07/2012 作为日期和 3 天给或取。根据文档，这应该是 2012 年 1 月 8 日发布的，但它是 2012 年 1 月 7 日发布的。

当它被传递给方法时，我已经检查了 giveOrTake，它很好，所以我不知道发生了什么。我可以硬编码 giveOrTake 值，但仍然得到错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T16:35:43.357

为我工作：

```
import java.util.*;

public class Test {
    public static void main (String []args) {
        Calendar calendar = Calendar.getInstance();
        calendar.set(2012, Calendar.JULY, 29);
        calendar.add(Calendar.DATE, 3);
        System.out.println(calendar.getTime()); // August 1st
    }
} 
```

我的猜测是您在打电话*之前*`add`弄错了月份- 请注意我`set`上面的电话如何使用*6*作为月份，因为该电话使用基于 0 的月份编号。

请注意，根据我对这个问题的评论，如果可以的话，你最好搬到[Joda Time](http://joda-time.sf.net) ...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-17T03:20:40.300

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-26T15:09:51.913

这是日期格式的问题。它被设置为`yyyymmdd`应该是“yyyyMMdd”的时间。

# java - 调度任务 vs 忙等待

> ID：11123998
> 
> 赞同：0
> 
> 时间：2012-06-20T16:29:32.837
> 
> 标签：java, jakarta-ee, scheduled-tasks, threadpool

我需要每隔几个小时执行一次任务，我正在为此寻找最有效的解决方案。我想到了两种方法：

1）忙着等待

```
while(true){

 doMyJob()
 wait(2*hour);

} 
```

2）执行者调度：

```
executor.schedule(new MyJobTask(),2,TimeUnit.HOUR);

...

class MyJobTask implements Runnable{

void run(){

 doMyJob();
 ...
 executor.schedule(new MyJobTask(),2,TimeUnit.HOUR);

} 
```

您能否告诉我哪种解决方案更有效，以及在什么情况下它们更可取（如果有的话）。直觉上，我会选择第二种解决方案，但我找不到任何东西来证明我的直觉。如果您有其他解决方案 - 请分享。解决方案也应该是内存高效的（这就是为什么我有一个两难选择 - 我是否需要创建和保留一个 ThreadPool 对象只是为了每两个小时做一个简单的工作）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T16:43:02.267

在 EE 容器中（您应该避免弄乱线程），建议的解决方案都不是真正可取的，您似乎根据问题的标签来定位它。

从 Java EE 5 开始，有一个[计时器服务](http://docs.oracle.com/javaee/5/tutorial/doc/bnboy.html)，根据我的测试，它可以很好地使用更长的超时时间，例如您的示例中的 2 小时。不过，有一点你真的不应该忘记 - 引用上述教程：

> 计时器是持久的。如果服务器关闭（甚至崩溃），计时器将被保存，并在服务器重新启动时再次变为活动状态。如果在服务器关闭时计时器到期，则容器将在服务器重新启动时调用@Timeout 方法。

如果由于某种原因该解决方案不可接受，您应该查看[Quartz Scheduler](http://quartz-scheduler.org/)。它的可能性远远超出了您的要求，但至少它为您提供了一个即用型解决方案，它保证了与各种应用程序服务器的兼容性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T16:38:34.453

两者的效率应该差不多，但我建议使用`ScheduledExecutorService`

```
Executors.newSingleThreadScheduledExecutor()
    .scheduleAtFixedRate(new MyJobTask(), 0, 2, TimeUnit.HOUR); 
```

有几个原因，这里详述：[运行代码一段时间的更好方法](https://stackoverflow.com/questions/4950966/a-better-way-to-run-code-for-a-period-of-time)

但重要的是，`ScheduledExecutorService`它允许您使用多个线程，这样耗时较长的任务就不必备份您的任务队列（该服务可以同时运行您的两个任务）。此外，如果`doMyJob`抛出异常，`ScheduledExecutorService`将继续安排您的任务，而不是因为未能重新安排任务而被取消。