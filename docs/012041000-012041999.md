# StackOverflow 问答 12041000-12041999

# mvvm - 信使类可访问性

> ID：12041000
> 
> 赞同：0
> 
> 时间：2012-08-20T15:53:09.747
> 
> 标签：mvvm, toolkit, light, mediator, messenger

我正在使用 MVVM Light 的 Messenger 类。我想知道这个类是否应该只被 ViewModels 使用，或者它是否也可以被其他类使用。如果是后者，那还有谁可以使用呢？国际奥委会会议？服务？意见？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T20:15:05.253

大多数情况下，您会将它用于 ViewModel 之间的通信，但它也用于在代码隐藏中打开新窗口，或用于与 ViewModelLocator 类进行通信。它不是真正特定于 WPF 的，只是一个消息传递服务。

# php - TwitchTV 未定义的偏移量

> ID：12041001
> 
> 赞同：0
> 
> 时间：2012-08-20T15:53:11.087
> 
> 标签：php

所以我已经阅读了 TwitchTV API 的所有内容，在网上搜索了所有答案，尝试了多个代码，但我仍然无法让它工作。

发生的事情是当 $channel 变量中的流不在线时，页面总是返回错误

> 注意：未定义的偏移量：第 13 行 /home/user/public_html/livestreamstatus.php 中的 0

. 我需要知道如何摆脱这个，只显示“离线”这个词

这是代码：

```
<?php

    $channel = "gamespot";

    $json_file = @file_get_contents("http://api.justin.tv/api/stream/list.json?channel={$channel}", 0, null, null);
    $json_array = json_decode($json_file, true);

    if ($json_array[0]['name'] == "live_user_{$channel}") {
        $channelTitle = $json_array[0]['channel']['title'];
        $title = $json_array[0]['channel']['status'];

?>
    ONLINE
<br />

<?php

    } else {

?>
    OFFLINE
<?php

    }

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T16:19:39.860

你想要的是检查它是否存在，所以在调用它之前让 php 为你检查。

```
<?php
$channel = "gamespot";

$json_file = @file_get_contents("http://api.justin.tv/api/stream/list.json?channel={$channel}", 0, null, null);
$json_array = json_decode($json_file, true);

if( array_key_exists( '0',       $json_array )
 && array_key_exists( 'channel', $json_array[0] )
 && $json_array[0]['name'] == "live_user_{$channel}" )
{
    $channelTitle = $json_array[0]['channel']['title'];
    $title        = $json_array[0]['channel']['status'];

    printf('Online');
}
else
{
    printf('Offline');
}

?> 
```

# r - data.table 中的 i 参数（计算结果为逻辑的表达式）

> ID：12041003
> 
> 赞同：3
> 
> 时间：2012-08-20T15:53:25.210
> 
> 标签：r, group-by, subset, data.table

我有以下内容：

```
test <- data.table(id=1:11, t=c(rep(1:2,5), 3))
test[length(unique(id))>1,list(id, t), by=t]

    id t
 1:  1 1
 2:  2 2
 3:  3 1
 4:  4 2
 5:  5 1
 6:  6 2
 7:  7 1
 8:  8 2
 9:  9 1
10: 10 2
11: 11 3 
```

我希望这能够分组`test`，`t`评估`j`每个组的语句，并返回`i`为真的行（即有超过 1 个唯一 ID）。相反，返回的是：

```
> test
     id t
 1:  1 1
 2:  2 2
 3:  3 1
 4:  4 2
 5:  5 1
 6:  6 2
 7:  7 1
 8:  8 2
 9:  9 1
10: 10 2  
11: 11 3 
```

似乎`by`适用于`j`only 而不是`i`。这里有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T16:38:37.710

对或错，`i`首先`j`运行，然后`by`在所有通过的行上运行`i`。

一个常见的成语是这样的（类似于 SQL 中的 HAVING）：

```
test[,list(id, u=length(unique(id))), by=t][u>1] 
```

并从结果中排除`u`（每组中唯一 ID 的数量）：

```
test[,list(id, u=length(unique(id))), by=t][u>1][,u:=NULL] 
```

顺便说一句，`i`对（小得多的）聚合结果（例如`u>1`上面的行）进行矢量扫描比对（大得多的）原始数据进行矢量扫描效率高得多。

如果在整个数据集上`j`运行，然后在结果上运行（如您所料），那么它会导致效率问题。考虑一下它是否以这种方式工作。然后，首先需要对结果进行分组的过滤器需要分成两个调用：. 然后看不到(within ) 并且不知道它需要哪些列。将其组合为一个允许在评估之前进行检查，并且只对需要的列进行子集化。这对使用一小部分列的查询的大型数据集产生了很大的影响。`by``i``[``DT[i][,j,by]``i``j``[.data.table``DT[i,j,by]``i``j``j`

* * *

要查看发生了什么，请带上你的`i`并制作它`j`：

```
test[,length(unique(id))>1]  
# [1] TRUE 
```

然后单曲`TRUE`被回收。`DT[TRUE] == DT`. 你总是可以这样进行`i`测试`j`。

# ios - MPMoviePlayerController 仅在调用两次时播放。仅在 iOS 4 中出现

> ID：12041008
> 
> 赞同：1
> 
> 时间：2012-08-20T15:53:43.003
> 
> 标签：ios, mpmovieplayercontroller, http-live-streaming

我有一个适用于 iOS 4.0-5.1 的应用程序，它使用 HTTP Live Streaming 来播放视频。我有一个简单的设置，视图中有一个按钮，当它被点击时开始播放流。这在 iOS 5 中运行良好，但在 iOS 4 中开始播放流之前需要点击两次按钮。有谁知道为什么会发生这种情况以及如何在第一次点击按钮时播放视频？

这是我正在做的事情：

。H

```
#import <UIKit/UIKit.h>
#import <MediaPlayer/MediaPlayer.h>

@interface ViewController : UIViewController{
    MPMoviePlayerController *moviePlayer;
}

@property (nonatomic, strong) MPMoviePlayerController *moviePlayer;

-(IBAction)playApple:(id)sender;

@end 
```

* * *

.m

```
-(IBAction)playApple:(id)sender{
    if(self.moviePlayer){
        self.moviePlayer = nil;
    }

    //Use Apple's sample stream
    NSURL *mediaURL = [NSURL URLWithString:@"http://devimages.apple.com/iphone/samples/bipbop/bipbopall.m3u8"];
    self.moviePlayer = [[MPMoviePlayerController alloc] initWithContentURL:mediaURL];

    //Begin observing the moviePlayer's load state.
    [[NSNotificationCenter defaultCenter] addObserver:self 
           selector:@selector(moviePlayerLoadStateChanged:) 
           name:MPMoviePlayerLoadStateDidChangeNotification 
           object:self.moviePlayer];

    [self.moviePlayer setMovieSourceType:MPMovieSourceTypeStreaming];
    [self.moviePlayer setShouldAutoplay:NO];//Stop it from autoplaying
    [self.moviePlayer prepareToPlay];//Start preparing the video
}

#pragma mark Notification Center
- (void)moviePlayerLoadStateChanged:(NSNotification *)notification{
    NSLog(@"State changed to: %d\n", moviePlayer.loadState);
    if(self.moviePlayer.loadState == MPMovieLoadStatePlayable){
        //if load state is ready to play
        [self.view addSubview:[self.moviePlayer view]];
        [self.moviePlayer setFullscreen:YES];
        [self.moviePlayer play];//play the video
    }

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T18:05:10.437

我可以看到一些可能的问题 - 试一试，让我们知道是否有任何或所有这些都成功了。

**1.负载状态掩蔽**

`loadstate`不应该直接比较，而是在比较之前屏蔽它，因为它可能包含多种状态的混合。

```
MPMovieLoadState 
```

> 描述电影播放器​​的网络负载状态的常量。

```
enum {
   MPMovieLoadStateUnknown        = 0,
   MPMovieLoadStatePlayable       = 1 << 0,
   MPMovieLoadStatePlaythroughOK  = 1 << 1,
   MPMovieLoadStateStalled        = 1 << 2,
};
typedef NSInteger MPMovieLoadState; 
```

因此，不要像您一样直接比较它，而是将其掩盖以确保安全。

**2.查看设置**

为什么不在开始播放之前设置播放器视图。我从未见过你这样做的方式（并不是说我肯定这是问题所在 - 对我来说仍然很奇怪）。此外，即使播放器实际上不会使用您分配的视图（全屏模式会有所不同），您可能希望通过分配适当的帧来增强视图设置。

以上所有内容都融入了您的代码的这个新版本......

```
-(IBAction)playApple:(id)sender
{
    if(self.moviePlayer)
    {
        self.moviePlayer = nil;
    }

    //Use Apple's sample stream
    NSURL *mediaURL = [NSURL URLWithString:@"http://devimages.apple.com/iphone/samples/bipbop/bipbopall.m3u8"];
    self.moviePlayer = [[MPMoviePlayerController alloc] initWithContentURL:mediaURL];

    //Begin observing the moviePlayer's load state.
    [[NSNotificationCenter defaultCenter] addObserver:self 
           selector:@selector(moviePlayerLoadStateChanged:) 
           name:MPMoviePlayerLoadStateDidChangeNotification 
           object:self.moviePlayer];

    self.moviePlayer.view.frame = self.view.bounds;
    [self.view addSubview:[self.moviePlayer view]];
    [self.moviePlayer setFullscreen:YES];
    [self.moviePlayer setMovieSourceType:MPMovieSourceTypeStreaming];
    [self.moviePlayer setShouldAutoplay:NO];   //Stop it from autoplaying
    [self.moviePlayer prepareToPlay];          //Start preparing the video
}

- (void)moviePlayerLoadStateChanged:(NSNotification *)notification
{
    NSLog(@"State changed to: %d\n", moviePlayer.loadState);
    if((self.moviePlayer.loadState & MPMovieLoadStatePlayable) == MPMovieLoadStatePlayable)
    {
        //if load state is ready to play
        [self.moviePlayer play];//play the video
    }
} 
```

# c# - 插入数量值

> ID：12041009
> 
> 赞同：-1
> 
> 时间：2012-08-20T15:53:43.493
> 
> 标签：c#

我正在尝试构建一个具有输入屏幕的 C# Web 应用程序。一些字段是数量字段。我可以将什么用作能够记录数值的数据库类型以及如何在我的代码中编写它？当前使用记录值的 Nchar，但是当我尝试对 Qty1 + Qty2 进行一些基本添加时，它似乎没有返回值。这是我目前拥有的：

```
nonqueryCommand.Parameters.Add("@Qty1", System.Data.SqlDbType.NChar, 10); 
```

我试过数字和浮点数，但它们给了我一些关于将字符串转换为 int32 错误的信息。

![在此处输入图像描述](../Images/9ee1436d2216d5597d308d46595c8978.png)

感谢您的洞察力。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T16:01:46.290

如果您打算为 Qty 进行计算，那么最好不要将其作为字符数据类型存储在 SQL Server 中以避免不必要的显式/隐式转换。

你可以做的是：

a) 重新设计您的表以将 Qty 作为 int 数据类型。
b) 向您的文本框添加验证以仅接受数值。
c) 将文本框值转换为如下所示的数字类型，并将其传递给数据库 Qty 字段：

```
if (Int32.TryParse(txtQty1.Text)) 
  int Qty1 = Convert.ToInt32(txtQty1.Text);    
else
  //throw-handle exception 
```

d) 如果您需要存储较大的数字或较小的数字，请在 C# 和 SQL Server 中使用适当的等效数据类型。例如，如果您需要`long`改用，那么您的代码将如下所示，并且您需要将 Qty 字段设置为`bigint`.

```
if (Int64.TryParse(txtQty1.Text)) 
  int Qty1 = Convert.ToInt64(txtQty1.Text);
else
//throw/handle exception 
```

此[链接](http://msdn.microsoft.com/en-us/library/ms131092%28v=sql.105%29.aspx)将向您展示 SQL Server 和 .NET 框架之间的等效数据类型。

* * *

PS：请检查您的桌子设计。您可能希望对其进行规范化。
例如，您可以有一个单独的表，其中只有 ItemId、GroupId、Item、Qty、Cost。然后在现有表中，您可以删除所有 Item、Qty 和 Cost 列并保留主列。第二个表中的 GroupId 将是现有表的主键。这是对其进行规范化的一种方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T15:57:37.927

你可以使用 int 类型

```
int qte1 = Convert.ToInt32(yourTextBox1.Text);;
int qte2 = Convert.ToInt32(yourTextBox2.Text);;

int result = qte1 + qte2; 
```

# ruby-on-rails - 嵌套表单验证在 Rails 应用程序中不起作用

> ID：12041011
> 
> 赞同：0
> 
> 时间：2012-08-20T15:53:48.440
> 
> 标签：ruby-on-rails, validation, nested-forms

我的验证不适用于嵌套表单 - 消息，它位于其他模型显示页面中。

这是代码：

**在线预订：**

```
 <%= form_for([@trip, @trip.messages.build]) do |f| %>    

      <%= render 'shared/error_messages', object: f.object %>  

      <%= f.text_field :name, :class => "span3", :placeholder => "Name:" %>     
      <%= f.text_field :email, :class => "span3", :placeholder => "Email:" %>   
      <div class="h">    
        <%= f.text_field :subject, :class => "h", :value => (@trip.title) %>   
      </div>  

      <%= f.text_area :body, :class => "input-xlarge3", :placeholder => "Message:", :id => "textarea", :rows => "3" %>

      <%= f.submit :class => " btn btn-primary btn-large ", :value => "Send Message" %>    
  <% end %>                                
</div> 
```

消息.rb

```
class Message < ActiveRecord::Base

 belongs_to :trip  
 attr_accessible :name, :email, :subject, :body 

 validates_presence_of :name
 validates_format_of :email, :with => /^[-a-z0-9_+\.]+\@([-a-z0-9]+\.)+[a-z0-9]{2,4}$/i
 validates_length_of :body, :maximum => 500

end 
```

一个messages_controller.rb

```
 class MessagesController < ApplicationController

   def create
      @trip = Trip.find(params[:trip_id])
      @message = @trip.messages.create(params[:message])     
   if @trip.messages.create
      MessageMailer.send_message(@message).deliver
      redirect_to thank_you_path        
   else    
      redirect_to trip_path(@trip)
   end
 end
end 
```

_error_messages.rb

```
<% if object.errors.any? %>
  <div id="error_explanation">
   <div class="alert alert-error">
    The form contains <%= pluralize(object.errors.count, "error") %>.
   </div>
   <ul>
   <% object.errors.full_messages.each do |msg| %>
     <li>* <%= msg %></li>
   <% end %>
   </ul>
 </div>
<% end %> 
```

上面的整个代码工作正常，但验证部分被忽略了。而且我没有看到任何错误。所以我无法弄清楚我做错了什么。你能帮我吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T16:07:28.413

我认为您的控制器存在问题：

```
def create
  @trip = Trip.find(params[:trip_id])
  @message = @trip.messages.create(params[:message])     
  # the following line doesnt make sense
  # you're recreating an empty message
  # it should be something like "if @message.valid?"
  if @trip.messages.create
    MessageMailer.send_message(@message).deliver
    redirect_to thank_you_path        
  else    
    redirect_to trip_path(@trip)
  end
end 
```

尝试解决这个问题，看看它是否有帮助。

# selenium - Selenium WebDriver：流畅的等待按预期工作，但隐式等待没有

> ID：12041013
> 
> 赞同：27
> 
> 时间：2012-08-20T15:53:53.033
> 
> 标签：selenium, webdriver

我是 Selenium WebDriver 的新手，正在尝试了解“等待”元素出现的正确方法。

我正在测试一个页面，其中包含一堆带有单选按钮答案的问题。当您选择答案时，Javascript 可能会启用/禁用页面上的一些问题。

问题似乎是 Selenium '点击太快'并且没有等待 Javascript 完成。我尝试以两种方式解决这个问题 - 显式等待解决了这个问题。具体来说，这有效，并解决了我的问题：

```
private static WebElement findElement(final WebDriver driver, final By locator, final int timeoutSeconds) {
    FluentWait<WebDriver> wait = new FluentWait<WebDriver>(driver)
            .withTimeout(timeoutSeconds, TimeUnit.SECONDS)
            .pollingEvery(500, TimeUnit.MILLISECONDS)
            .ignoring(NoSuchElementException.class);

    return wait.until(new Function<WebDriver, WebElement>() {
        public WebElement apply(WebDriver webDriver) {
            return driver.findElement(locator);
        }
    });
} 
```

但是，我*更喜欢*使用隐式等待而不是这个。我的网络驱动程序配置如下：

```
driver.manage().timeouts().implicitlyWait(10, TimeUnit.SECONDS); 
```

这并不能解决问题，我得到了 NoSuchElementException。此外，我没有注意到 10 秒的暂停——它只是立即出错。我已经验证了代码中的这一行正在被调试器击中。我究竟做错了什么？为什么implicitlyWait 不等待元素出现，但FluentWait 会？

注意：正如我提到的，我已经有一个解决方法，我真的只是想知道为什么隐式等待不能解决我的问题。谢谢。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-01-25T10:19:39.883

请记住，几种情况之间存在差异：

*   DOM 中根本不存在的元素。
*   DOM 中存在但不可见的元素。
*   DOM 中存在但未启用的元素。（即可点击）

我的猜测是，如果某些页面正在使用 javascript 显示，则这些元素已经存在于浏览器 DOM 中，但不可见。隐式等待只等待一个元素出现在 DOM 中，因此它会立即返回，但是当您尝试与该元素交互时，您会收到 NoSuchElementException。您可以通过编写一个显式等待元素可见或可点击的辅助方法来测试这个假设。

一些示例（在 Java 中）：

```
public WebElement getWhenVisible(By locator, int timeout) {
    WebElement element = null;
    WebDriverWait wait = new WebDriverWait(driver, timeout);
    element = wait.until(ExpectedConditions.visibilityOfElementLocated(locator));
    return element;
}

public void clickWhenReady(By locator, int timeout) {
    WebDriverWait wait = new WebDriverWait(driver, timeout);
    WebElement element = wait.until(ExpectedConditions.elementToBeClickable(locator));
    element.click();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-05T15:16:19.440

基本思路如下：

显式等待

```
WebDriverWait.until(condition-that-finds-the-element); 
```

隐式等待

```
driver.manage().timeouts().implicitlyWait(10, TimeUnit.SECONDS); 
```

换句话说，显式与要保持的某些条件相关联，而隐式与等待某事的时间相关联。 [看到这个链接](http://www.bizalgo.com/2012/01/14/timing-races-selenium-2-implicit-waits-explicit-waits/)

为了使工作 fluentWait 正确尝试这个：

```
public WebElement fluentWait(final By locator){
    Wait<WebDriver> wait = new FluentWait<WebDriver>(driver)
        .withTimeout(Duration.ofSeconds(30))
        .pollingEvery(Duration.ofMillis(100))
        .ignoring(NoSuchElementException.class);

    WebElement foo = wait.until(
        new Function<WebDriver, WebElement>() {
            public WebElement apply(WebDriver driver) {
                return driver.findElement(locator);
            }
        }
    );
    return foo;
}; 
```

希望这可以帮助）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-11-11T09:43:15.480

**一个常见错误的警告词：**

一旦你设置了隐式等待，你就不能使用显式等待或流式等待，直到你再次重置隐式等待。这意味着`ExpectedConditions`, 其中包含`driver.findElement`调用将无法按预期使用隐式等待！您经常会遇到想要立即检查某个元素或其不存在的情况——但您也不能这样做。

经过大约 2 年的经验和问题，我强烈建议不要使用隐式等待。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-08-09T16:34:09.557

[https://stackoverflow.com/users/503060/hedley](https://stackoverflow.com/users/503060/hedley)答案的 kotlin 版本：

```
clickWhenReady("#suggest",10,driver) 
```

通过

```
fun clickWhenReady(selector: String,timeout: Long, webdriver: WebDriver?) {
    val wait = WebDriverWait(webdriver, timeout);
    val element = wait.until(ExpectedConditions.elementToBeClickable(By.cssSelector(selector)));
    element.click();
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-22T13:17:59.830

我使用 WebDriverWait 类在 C# 中编写了一个小方法。对我很有用。

```
public static void WaitForAjaxElement(IWebDriver driver, By byElement, double timeoutSeconds)
{
  WebDriverWait wait = new WebDriverWait(driver, TimeSpan.FromSeconds(timeoutSeconds));
  wait.Until(x => x.FindElement(byElement));
} 
```

使用：

```
WaitForAjaxElement(driver, By.ClassName("ui-menu-item"), 10); 
```

希望能帮助到你。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-22T13:23:24.257

来自 Seleniumhq.com：

> 隐式等待是告诉 WebDriver 在尝试查找一个或多个元素（如果它们不是立即可用）时轮询 DOM 一段时间。默认设置为 0。一旦设置，就会为 WebDriver 对象实例的生命周期设置隐式等待。

如果您发布您真正想做的测试代码，我可以提供更多信息。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-02-07T09:17:46.083

我有另一个解决方案来解决这个问题（仅适用于 IE，我从不尝试其他浏览器）：

1）创建Selenium驱动实例后，可以得到它的ie COM实例

```
Add-Type -Path .\SePSX.NET35\WebDriver.dll
$ieDriver = New-Object "OpenQA.Selenium.IE.InternetExplorerDriver"

$ieShell = $null

$shell_apps = (New-Object -ComObject Shell.Application).Windows()
foreach($app in $shell_apps)
{
    if ($app.LocationURL -eq $ieDriver.URL)
    {
        $ieShell = $app
        break
    }
}

if ($ieShell -eq $null)
{
    throw "Can't get WebDriver IE Instance"
} 
```

2) 每次调用GotoURL 或点击动作后，检查$ieShell.Busy 状态，等待页面加载完毕。

```
$ieDriver.Navigate().GotoUrl("www.google.com")
while ($ieShell.Busy -eq $true) {sleep 1}   

then call Selenium driver to get element id and do the further action

$ieDriver.FindElementById ... 
```

使用这种方式，你不需要为 Selenium 设置页面加载和 findElement 超时

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-10-10T12:03:03.743

```
import org.openqa.selenium.NoSuchElementException;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.support.ui.FluentWait;
import org.openqa.selenium.support.ui.Wait;

FluentWait<WebDriver> wait = new FluentWait<WebDriver>(driver);
            wait.pollingEvery(250,  TimeUnit.MILLISECONDS);
            wait.withTimeout(20, TimeUnit.SECONDS);
            wait.ignoring(NoSuchElementException.class);

            Predicate<WebDriver> predicate  = new Predicate <WebDriver>()
                    {
                        public boolean apply(WebDriver arg0) {
                            WebElement element = arg0.findElement(By.id("colorVar"));
                            String color = element.getAttribute("color");
                            System.out.println("The color if the button is " + color);
                            if(color.equals("blue"))
                            {
                                return true;
                            }
                            return false;
                        }
                    };

            wait.until(predicate); 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2015-06-03T06:37:25.897

下面是使用 DefaultWait 在 c#.Net 中流畅等待的代码等效代码。

```
 IWait<IWebDriver> wait = new DefaultWait<IWebDriver>(driver);
         wait.Timeout = TimeSpan.FromSeconds(10);
         wait.PollingInterval = TimeSpan.FromMilliseconds(100);

        IWebElement elementt = wait.Until<IWebElement>(ExpectedConditions.ElementIsVisible(By.Id("selectedfirstlast1")));
        SelectElement se = new SelectElement(driver.FindElement(By.Id("selectedfirstlast1")));
        element = se.SelectedOption;              
            if (element.Text.Contains("Mumbai") && element.Selected)
                driver.FindElement(By.XPath("//table/tbody/tr[2]/td[7]/a")).Click(); 
```

# c++ - 在 ruby 中捕获 bash 命令的全部输出？

> ID：12041015
> 
> 赞同：0
> 
> 时间：2012-08-20T15:54:00.180
> 
> 标签：c++, ruby, gentoo

我有一个我开发的 Ruby 脚本，它允许我安装和构建多个 C++ 包。我能够执行 Ruby 脚本并安装包而没有错误。

但是，我希望能够将所有输出（包括 cerr）捕获到我选择的“日志”文件中。我能够重定向 Ruby 的 cerr 和标准输出，但我无法捕获 bash 命令：`qmake`、、`make`或`make install`cerr。输出仍然流向终端。

我希望能够运行 Ruby 脚本并且看不到来自任何 、 或 bash 命令的任何调试消息`qmake`，`make`但`make install`能够稍后检查日志文件以获取构建结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T16:05:31.453

你可以做

```
require 'open3'

log = File.new("#{your_log_dir}/script.log", "w+")
command = "make"

Open3.popen3(command) do |stdin, stdout, stderr|
     log.puts "[OUTPUT]:\n#{stdout.read}\n"
     unless (err = stderr.read).empty? then 
          log.puts "[ERROR]:\n#{err}\n"
     end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T16:22:35.393

将子进程的 stdout 和 stderr 直接转储到文件：

```
cmd = ['ls', '-ahl', '/my/directory'] # example directory listing
pid = Process.spawn *cmd, out: '/path/to/stdout/log', err: '/path/to/stderr/log'
Process.wait pid 
```

您也可以传递文件描述符而不是路径字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T18:13:29.637

If you're on Mac OS or Linux, you can use standard redirection and a simple shell call if you want to capture the STDOUT and STDERR to a variable in your script:

```
asdf = `ls foo 2>&1`
asdf # => "ls: foo: No such file or directory\n" 
```

`2>&1` simply redirects STDERR in the command output to STDOUT, which is captured when the program runs.

If you want to redirect both STDOUT and STDERR to the same file for later, use:

```
`ls foo > output.log 2>&1` 
```

The STDOUT has to be redirected before `&2>1` will take effect, but that will capture both.

For more information see the "Redirect" section of `man sh`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T16:13:07.807

`%x[#insert bash command here]`捕获响应。如果您需要处理 STDERR，我相信您需要将其通过管道传输到 STDOUT。

# wcf - WCF：如何限制使用某些协议？

> ID：12041016
> 
> 赞同：0
> 
> 时间：2012-08-20T15:54:03.123
> 
> 标签：wcf, protocols, restrict

WCF（winodws 服务托管）服务使用一组协议和绑定：http、https、net.tcp、net.pipe。它使用配置文件设置。

我想构建服务的演示版本。此演示将仅使用 net.pipe 协议。我怎样才能限制服务只使用这个？我可以更改代码，但是如何以及在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T03:31:40.587

`ServiceHost`在财产中拥有`ChannelDispatcher`s 的集合。`ChannelDispatchers`您可以使用`ChannelDispatcher.BindingName`来确定服务中使用的绑定名称。

```
ServiceHost host = new ServiceHost(typeof(SomeService), baseAddress))
//configure service endpoints here
host.Open();

#if DEMO_MODE
foreach (ChannelDispatcher dispatcher in host.ChannelDispatchers)
{
   //binding name includes namespace. Example - http://tempuri.org/:NetNamedPipeBinding
   var bindingName = dispatcher.BindingName;
   if (!(bindingName.EndsWith("NetNamedPipeBinding") || bindingName.EndsWith("MetadataExchangeHttpBinding")))
     throw new ApplicationException("Only netNamedPipeBinding is supported in demo mode");
}
#endif 
```

# matlab - 来自 Matlab 的 Weka：属性选择

> ID：12041018
> 
> 赞同：2
> 
> 时间：2012-08-20T15:54:35.823
> 
> 标签：matlab, attributes, selection, weka

我将 Weka.jar 文件添加到我的环境变量中，并且已经可以将 ARFF 文件加载到 Matlab 并读取实例。现在我想对一组训练和测试文件对执行批量属性选择，但我似乎无法从 Matlab 中找到任何关于如何做到这一点的教程。

我不想通过 weka 命令行执行此操作，因为我有一组 15 个训练文件和 15 个测试文件，仅用于一次试验（而且我有很多不同 ARFF 文件的试验），因此我想从 Matlab 快速循环它们.

您的帮助将不胜感激:) 谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T19:22:09.530

两件事情：

首先，如果您在 MATLAB 桌面（MATLAB 控制台）中并且在命令前加上感叹号 (!)，那么您可以运行命令行参数。这也适用于脚本（.m MATLAB 文件）。

前任：

```
>> !man ls 
```

这意味着您可以在终端中执行的操作（如[本教程](http://weka.wikispaces.com/Performing+attribute+selection)中的），您应该能够在 MATLAB 中执行。

其次，您可以[从 MATLAB 访问 Java 库](http://www.mathworks.com/help/techdoc/matlab_external/f44062.html)。您可以`weka.attributeSelection`通过将函数导入 MATLAB 工作区，然后像在 java 中那样使用所需的方法来访问函数。例如，这是一个由 Matthew Dunham 编写的 .m 文件，它导入了一个 weka 库 ( `weka.core.converters.ArffLoader`) 并在 .m 文件中使用它：

```
function wekaOBJ = loadARFF(filename)
% Load data from a weka .arff file into a java weka Instances object for
% use by weka classes. This can be converted for use in matlab by passing
% wekaOBJ to the weka2matlab function. 
%
% Written by Matthew Dunham

    if(~wekaPathCheck),wekaOBJ = []; return,end
    import weka.core.converters.ArffLoader;
    import java.io.File;

    loader = ArffLoader();
    loader.setFile(File(filename));
    wekaOBJ = loader.getDataSet();
    wekaOBJ.setClassIndex(wekaOBJ.numAttributes -1);
end 
```

# powershell - 如何使用 powershell 解析 csv 文件以获得特定结果

> ID：12041027
> 
> 赞同：0
> 
> 时间：2012-08-20T15:55:09.100
> 
> 标签：powershell

我有一个包含用户登录数据的 CSV 文件，并且想使用 PowerShell 解析数据以查找每个用户的最后一次登录。

数据格式为：

```
TimeStamp                  UserName                           
---------                  --------                           
10/14/2011 12:53:12 PM     Smith                      
10/14/2011 12:54:07 PM     Jones                      
10/14/2011 12:59:45 PM     Green                      
10/14/2011 1:10:43 PM      Brown                      
8/20/2012 6:20:11 PM       Jones                     
8/20/2012 6:20:36 PM       Brown                     
8/20/2012 6:33:04 PM       Smith                      
8/20/2012 6:35:45 PM       Brown                  
8/20/2012 6:45:05 PM       Jones                  
8/20/2012 6:45:45 PM       Smith 
```

所需的输出是：

```
UserName                   TimeStamp                          
--------                   ---------                           
Brown                      8/20/2012 6:45:45 PM
Green                      10/14/2011 12:59:45 PM
Jones                      8/20/2012 6:45:05 PM
Smith                      8/20/2012 6:45:45 PM 
```

我可以逐行、嵌套循环、解决方案来做到这一点，但这似乎是一种用 PowerShell 处理它的糟糕方法。

我可以读取 csv 数据并按 UserName 和 TimeStamp 对其进行排序：

```
$data = "\\SomePath\LastLogon.csv"
$list = Import-Csv $data |Sort @{expression="UserName";Ascending=$true},@{expression="TimeStamp";Descending=$true}
$list 
```

但我现在坚持如何过滤最后一次登录。有没有一种简单的方法可以用 PowerShell 做到这一点，还是我采取了错误的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T16:52:44.333

`Group-Object`是你的朋友。首先按时间戳排序，然后分组。它将保持捕获组内的排序顺序，因此您只需读取第一项即可。

```
$data = "\\SomePath\LastLogon.csv"
Import-Csv $data | sort {[DateTime]$_.TimeStamp} -Desc | group UserName |%{ $_.Group[0] } 
```

# javascript - 如何使用js从url获取参数值

> ID：12041030
> 
> 赞同：-1
> 
> 时间：2012-08-20T15:55:10.920
> 
> 标签：javascript

> **可能重复：**
> [在 JavaScript 中获取查询字符串值](https://stackoverflow.com/questions/901115/get-query-string-values-in-javascript)

链接是

```
http://nycs00058260/sites/usitp/_layouts/CreateWebPage_DingDing.aspx?List={74AB081E-59FB-45A5-876D-284607DA03C6}&RootFolder=%3b&Text=%27MDNSO%27 
```

如何使用javascript从url解析参数“Text”（最后）？

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T16:00:43.393

[URI.js](http://medialize.github.com/URI.js/)是一个小型库，它使处理 URL 变得又好又容易 :)

```
var url = new URI("http://nycs00058260/sites/usitp/_layouts/CreateWebPage_DingDing.aspx?List={74AB081E-59FB-45A5-876D-284607DA03C6}&RootFolder=%3b&Text=%27MDNSO%27");
var queryMap = URI.parseQuery(url.query());
var text = queryMap["Text"];

console.log("Text: ", text); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T15:59:20.173

您可以结合 window.location.search ：[https ://developer.mozilla.org/en-US/docs/DOM/window.location](https://developer.mozilla.org/en-US/docs/DOM/window.location)

与 indexOf ：[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/indexOf](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/indexOf)

和子字符串：[https ://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/substring](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/substring)

# mysql - MySQL 透明列加密

> ID：12041033
> 
> 赞同：1
> 
> 时间：2012-08-20T15:55:20.827
> 
> 标签：mysql, encryption, view, triggers

我有一个表“选项卡”，它基本上由“用户”和“数据”两列组成。“用户”是指应用程序级别的一些用户ID，“数据”是指用户存储的一些机密信息。

```
CREATE TABLE IF NOT EXISTS tab(
    id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    user VARCHAR(255),
    data BLOB
); 
```

我需要使用各个用户的单独密钥加密“数据”列中的每个 blob，该密钥是根据用户的密码计算的，并在用户登录时存储在临时表中。为了执行加密和解密，我定义了两个存储过程“encData”和“decData”。

*但是有一个*问题：加密方案应该对运行在数据库之上的任何应用程序*完全透明。*不应更改表和列的名称，即“tab.data”上的 SELECT 语句应隐式调用“decData”，而 INSERT 和 UPDATE 应隐式调用“encData”。

我目前的解决方法包括两个步骤：

1.  将“tab”重命名为“tab_encrypted”并创建一个名为“tab”的视图，这会导致“data”列上的任何 SELECT 语句被解密：

    ```
    ALTER TABLE tab RENAME TO tab_encrypted;

    CREATE OR REPLACE VIEW tab AS
        SELECT id, user, decData(data) AS data FROM tab_encrypted; 
    ```

2.  创建触发器，导致对列“数据”的任何插入或更新进行加密：

    ```
    CREATE TRIGGER encOnInsert BEFORE INSERT ON tab_encrypted FOR EACH ROW
        SET NEW.data = encData(NEW.data);

    CREATE TRIGGER encOnUpdate BEFORE UPDATE ON tab_encrypted FOR EACH ROW
        SET NEW.data = encData(NEW.data);
    ```

不幸的是，由于派生列，视图“选项卡”既不可插入也不可更新，这使得有必要对“tab_encrypted”执行插入和更新。有谁知道更好的解决方法或替代方法？

非常感谢您的帮助，

简

# silverstripe - 自定义 CMS

> ID：12041035
> 
> 赞同：0
> 
> 时间：2012-08-20T15:55:29.353
> 
> 标签：silverstripe

我在如何做类似于[http://www.silverstripe.org/archive/show/2431](http://www.silverstripe.org/archive/show/2431)的事情时遇到了麻烦。基本上我希望用户能够创建内容并将他们的 ID 与新内容一起放入数据库中。如果这很明显，我很抱歉。我有点难过。我很难理解它实际上是如何工作的。我知道我可以使用以下代码检索当前用户，但我不确定从那里去哪里。

```
$currentUser = Member::currentUser(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T19:58:10.720

在 SilverStripe 中，FormField 的第三个参数通常是值，例如 TextField 具有以下参数：

```
new TextField($name = 'myField', $title = 'Please write something in my Field', $value = "yay"); 
```

但这在 CMS 中不起作用（至少在 SilverStripe 2 中，如果您使用的是页面，不确定是否使用 DataObject），因为 SilverStripe 在尝试使用当前对象的值填充表单时会覆盖所有值

所以你有几个选择，两个最简单的选择是：

```
class MyContentObject extends DataObject {
    public static $db = array(
        'Text' => 'HTMLText',
    );
    public static $has_one = array(
        'Member' => 'Member',
    )
    public function getCMSFields()  {
        $fields = new FieldSet();
        $fields->push(new Textarea('Text', 'Text'));
        if (!$this->MemberID)
            $this->MemberID = Member::currentUserID();
        $fields->push(new HiddenField('MemberID'));
        return $fields;
    }
} 
```

第二个选项，在这种情况下更好，你甚至不需要隐藏字段，你可以在记录被写入数据库之前使用 onBeforeWrite 设置 MemberID：

```
class MyContentObject extends DataObject {
    public static $db = array(
        'Text' => 'HTMLText',
    );
    public static $has_one = array(
        'Member' => 'Member',
    )
    public function getCMSFields()  {
        $fields = new FieldSet();
        $fields->push(new Textarea('Text', 'Text'));
        return $fields;
    }
    public function onBeforeWrite() {
        // this method will be called every time the object gets saved
        parent::onBeforeWrite();
        if (!$this->MemberID)
            $this->MemberID = Member::currentUserID();
    }
} 
```

# c++ - 如何在 C/C++ 中创建文件数组？

> ID：12041036
> 
> 赞同：0
> 
> 时间：2012-08-20T15:55:28.550
> 
> 标签：c++, c, file, io

在 C/C++ 程序中，我这样做是否正确：

```
int i;
FILE **files = malloc(numFiles * sizeof(FILE *));
std::string file("foo"), ext(".bar");
char *num[10];

for (i = 0; i < numFiles; i++) {
    files[i] = fopen((file + itoa(i, num, 10) + ext).c_str(), "w");
} 
```

这基本上就是我正在做的事情，但我没有将任何内容写入文件。他们是空白的。

## 编辑

我已经解决了我的问题。我以为我可能在这里做错了什么，但结果却在其他地方。无论如何，感谢您的回复。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T15:59:07.277

当然它们是空白的，你没有写任何东西，你只是在写模式下打开文件！

您必须使用 fwrite 或 fprintf 函数将数据写入文件，然后使用 fclose 关闭文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T16:10:31.077

您有指向 char 的指针数组。但是你需要char数组。 `char *num[10];`--> `char num[10]`。

我想知道它是如何不崩溃的:)

# r - 如何仅绘制 ggplot2 中的图例？

> ID：12041042
> 
> 赞同：50
> 
> 时间：2012-08-20T15:55:45.327
> 
> 标签：r, ggplot2, igraph

我目前正在使用 igraph 并用颜色标记我的顶点。我想添加一个说明每种颜色代表什么的图例。

此时我能想到的是使用 ggplot2 仅打印图例并隐藏条形图。有没有办法只输出图例？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-08-20T16:52:02.233

这里有2种方法：

## 设置绘图

```
library(ggplot2) 
library(grid)
library(gridExtra) 

my_hist <- ggplot(diamonds, aes(clarity, fill = cut)) + 
    geom_bar() 
```

## 牛图法

```
# Using the cowplot package
legend <- cowplot::get_legend(my_hist)

grid.newpage()
grid.draw(legend) 
```

![](../Images/9d8fded64d41a9da926a3146e391b6c2.png)

## 本土方法

无耻窃取自：[在ggplot2直方图中的图例下插入表格](https://stackoverflow.com/questions/11883844/inserting-a-table-under-the-legend-in-a-ggplot2-histogram)

```
## Function to extract legend
g_legend <- function(a.gplot){ 
    tmp <- ggplot_gtable(ggplot_build(a.gplot)) 
    leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box") 
    legend <- tmp$grobs[[leg]] 
    legend
} 

legend <- g_legend(my_hist) 

grid.newpage()
grid.draw(legend) 
```

由[reprex 包](http://reprex.tidyverse.org)（v0.2.0）于 2018 年 5 月 31 日创建。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2017-05-31T09:25:27.593

Cowplot 方便地添加了一个函数来提取图例。以下内容直接取自手册。

```
library(ggplot2)
library(cowplot)
p1 <- ggplot(mtcars, aes(mpg, disp)) + geom_line()
plot.mpg <- ggplot(mpg, aes(x = cty, y = hwy, colour = factor(cyl))) + geom_point(size=2.5)

# Note that these cannot be aligned vertically due to the legend in the plot.mpg
ggdraw(plot_grid(p1, plot.mpg, ncol=1, align='v'))

# now extract the legend
legend <- get_legend(plot.mpg)

# and replot suppressing the legend
plot.mpg <- plot.mpg + theme(legend.position='none')

# Now plots are aligned vertically with the legend to the right
ggdraw(plot_grid(plot_grid(p1, plot.mpg, ncol=1, align='v'),
                 plot_grid(NULL, legend, ncol=1),
                 rel_widths=c(1, 0.2))) 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2019-05-30T09:44:59.100

我使用了 ggpubr 包——让它变得非常简单！

[https://rpkgs.datanovia.com/ggpubr/reference/get_legend.html](https://rpkgs.datanovia.com/ggpubr/reference/get_legend.html)

```
# Extract the legend. Returns a gtable
leg <- get_legend(p)

# Convert to a ggplot and print
as_ggplot(leg) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-28T05:12:55.933

我正在对图中的顶点进行颜色编码，并希望尽可能简单、优雅、快速地生成图例。

我相信最快的方法是在将图例“粘贴”到与 igraph 相同的情节之前使用 ggplot2 单独生成`viewport`图例`layout()`

在这种方法中，不需要在函数中调用`rescale`或`asp`争论。`plot.igraph()`

在 data.frame 上使用 g_legend 函数`leg`，有 2 列，x 是适当的顶点属性，y 是 igraph 图中使用的十六进制颜色代码，我完成了以下操作。

我的 igraph 对象是`t8g`

```
legend <- g_legend(leg)
vpleg <- viewport(width = 0.1, height = 0.1, x=0.85,y=0.5)
layout(matrix(c(1,2),1,2,byrow=T),widths=c(3,1))
plot(t8g,edge.width=1,edge.arrow.size=0.1,vertex.label.cex=0.2,main="b2_top10")
pushViewport(vpleg)
grid.draw(legend) 
```

# python - 如何从输入列表/数组创建单列 SQL 表？

> ID：12041047
> 
> 赞同：2
> 
> 时间：2012-08-20T15:56:23.170
> 
> 标签：python, sql, postgresql, psycopg2

我想知道如何将列表/集合/元组从 python（通过 psycopg2）传递给 postgres 查询作为单列表。例如，如果列表是`['Alice', 'Bob']`，我希望表格是：

```
| Temp  |
+-------+
| Alice |
| Bob   | 
```

如果有人在阅读以下部分后有其他建议来实现我的结果，那也很好。

**背景**

我有一个包含三列感兴趣的 SQL 表：

```
ID | Members | Group
---+---------+----------
1  | Alice   | 1
2  | Alice   | 1
3  | Bob     | 1
4  | Charlie | 1
5  | Alice   | 2
6  | Bob     | 2
7  | Alice   | 3
8  | Bob     | 4
9  | Charlie | 3 
```

我想要一个包含某些成员组合的组表。请注意，一个成员在一个组中可能有多个项目（例如 ID 1 和 2）。

对于`['Alice']`我想要她在（当前）哪些组以及仅包含她（唯一）的输入，如下所示：

```
Group | Type
------+--------
1     | present
2     | present
3     | present 
```

对于 的输入`['Alice', 'Bob']`：

```
Group | Type
------+--------
1     | present
2     | unique 
```

从阅读看来，我正在寻找[此处](http://www.simple-talk.com/sql/t-sql-programming/divided-we-stand-the-sql-of-relational-division/)所述的关系划分，为此我需要执行原始问题所要求的操作，因为输入是从在 python 中处理的 Web 表单中获取的。同样，也欢迎替代解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T16:39:27.083

您需要在创建成员计数的位置创建子查询，然后使用`GROUP BY`语句执行简单的除数查询，但针对`IN static_set`子句而不是针对另一个表。因为这是 python，所以你已经知道静态集的大小。

我假设您已经有一个数据库游标，并且该表被称为`GroupMembers`：

```
MEMBERSHIP_QUERY = '''
    SELECT gm.group, mc.memberscount = %(len)s AS type
      FROM groupmembers gm
      JOIN (SELECT "group", COUNT(DISTINCT members) as memberscount 
              FROM groupmembers
             GROUP BY "group") mc
      ON gm.group = mc.group
    WHERE gm.members IN %(set)s
    GROUP BY gm.group, mc.memberscount
    HAVING COUNT(DISTINCT gm.members) = %(len)s;
'''

def membership(members):
    # obtain a cursor
    for row in cursor.execute(MEMBERSHIP_QUERY, dict(len=len(members), set=members)):
        yield dict(group=row[0], type=row[1]) 
```

因此无需使用 TEMP 表来执行此查询。

如果您确实需要一个 TEMP 表用于其他目的，插入一组行是最简单的[`.executemany()`](http://initd.org/psycopg/docs/cursor.html#cursor.executemany)：

```
members = ['Alice', 'Bob']
cursor.execute('CREATE TEMP TABLE tmp_members (member CHAR(255)) ON COMMIT DROP;')
cursor.executemany('INSERT INTO tmp_members VALUES (%s);',
    [(name,) for name in members]) 
```

请注意，`.executemany()`需要一个序列序列；每个条目都是一系列行数据，在这种情况下，每个条目只包含一个名称。我生成一个单项元组列表来填充表格。

或者，您也可以使用一系列映射并使用`%(name)s`参数语法（因此行数据序列变为`[dict(name=name) for name in members]`）。

# asp.net-mvc - Request.Params 理解 [+] 为空格

> ID：12041048
> 
> 赞同：0
> 
> 时间：2012-08-20T15:56:31.303
> 
> 标签：asp.net-mvc, razor

我正在做一个请求......这样的事情：

```
@Request.Params["id"].ToString() 
```

id 的值被加密并返回类似 `ZK10ez/BJARTw GVLbIeUOp`

代替

`ZK10ez/BJARTw+GVLbIeUOp`<- 这是在 URL 中传递的内容

换句话说，它将我的加号 [+] 替换为空格 [ ]。我可以做一个替换，但我不知道将来是否会发生其他字母。

有同样问题的人吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T15:59:18.337

URL 中的 + 字符表示空格字符。这是[URL 编码](http://en.wikipedia.org/wiki/Query_string#URL_encoding)的一个方面。

确保在 URL 中使用任何数据之前正确地对任何数据进行 URL 编码。您不应该尝试通过自己替换字符串来复制 URL 编码/解码。

在将数据用于查询字符串之前，您可以使用[Url.Encode对数据进行编码。](http://msdn.microsoft.com/en-us/library/system.web.httpserverutility.urlencode.aspx)

# c# - 构建自定义肥皂请求时重复的安全元素

> ID：12041049
> 
> 赞同：1
> 
> 时间：2012-08-20T15:56:36.003
> 
> 标签：c#, wcf, serialization, soap, xml-serialization

我正在尝试向 WCF 服务发送一个肥皂请求。我正在使用 System.ServiceModel.Channels.Message.CreateMessage() 方法构建肥皂请求。

我还没有深入到构建身体，但这就是我所拥有的......

```
Message msg = Message.CreateMessage( MessageVersion.Soap11WSAddressing10, "MethodName" );
msg.Headers.MessageId = new UniqueId( Guid.NewGuid().ToString() );
msg.Headers.Add( Message.CreateHeader( "Security", "",
    new Security()
    {
        TimeStamp = new TimeStampType() {
            Created = DateTime.Now,
            Expires = Created.AddDays( 1 )
        },
        UsernameToken = new UsernameToken() {
            Username = "stackoverflow",
            Password = new Password() {
                Type = "hashed",
                Value = "Password"
            }
        }
     }, new SecuritySerializer() ) ) ); // The serializer inherits XmlObjectSerializer. Internally it is using the XmlSerializer class.

string s = msg.ToString(); 
```

当我运行它时，我得到以下输出。我正在使用 Visual Studio XML Visualizer 顺便说一句。

```
<s:Envelope>
    <s:Header>
        <Action>MethodName</Action>
        <MessageID>GUIDVALUE</MessageID>
        <Security>
            <Security>
               .....
            </Security>
        </Security>
    </s:Header>
    <s:Body />
</s:Envelope> 
```

我的问题是，我怎样才能删除安全元素之一？我应该有一个，但我有两个，因为我第一次将元素名称传递给 Message.CreateHeader() 方法，第二个是从序列化程序生成的。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T17:50:28.553

我通过使 Security 类继承自 MessageHeader 抽象类来解决此问题。然后我重写了 OnWriteHeaderContents 方法并在那里序列化了属性。我还取出了 MessageHeader.CreateHeader() 因为 Security 对象现在是一个标头对象。

# animation - 等待/加载透明 GIF/APNG 动画

> ID：12041051
> 
> 赞同：21
> 
> 时间：2012-08-20T15:56:38.093
> 
> 标签：animation, photoshop

我在哪里可以找到一些等待/加载透明 GIF/APNG 动画，但动画非常透明，在我发现的形状周围没有一些彩色线条：

`http://www.ajaxload.info/` `http://www.loadinfo.net/` `http://www.ajaxload.info/` `http://www.chimply.com/Generator`

我需要一个程序。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-20T17:01:23.207

1.  [http://preloaders.net/](http://preloaders.net/)
2.  [http://mentalized.net/activity-indicators/](http://mentalized.net/activity-indicators/)
3.  [http://www.webscriptlab.com/](http://www.webscriptlab.com/)
4.  [http://loadinggif.com/](http://loadinggif.com/)
5.  [http://loadingapng.com/](http://loadingapng.com/)
6.  [http://cssload.net/](http://cssload.net/)
7.  [http://heartcode.robertpataki.com/canvasloader/](http://heartcode.robertpataki.com/canvasloader/) **`CSS/JS Based`**

希望上面的链接会有所帮助。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-03-05T22:37:15.973

我还发现很难找到具有透明度的良好等待 gif。我从 Ashish 的答案的第 6 个链接中取出其中一个，并用 GIMP 对其进行了修复，因此它没有白色边框。

如果它对任何人都有帮助，请在这里：

![等待](../Images/185455deb26b7806e1e516edca753f30.png)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-10-30T13:38:22.387

另一个没有白色边框的透明 gif 加载器。

![没有白色边框的 gif 加载器](../Images/f504b727ef4788b987ae8b26935267b8.png)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-11-01T23:18:14.550

这是一个没有图像的解决方案。只有css/javascript。看看小提琴。非常整洁.... [http://jsfiddle.net/qzLdjq3c/5/](http://jsfiddle.net/qzLdjq3c/5/)

```
$(window).load(function() {
    $('.spinner').show();
    $(".spinner").hide();
}); 
```

# jquery - 在不丢失事件处理程序的情况下取消设置数据

> ID：12041052
> 
> 赞同：1
> 
> 时间：2012-08-20T15:56:47.713
> 
> 标签：jquery

有例如

```
<div>
 <a>anything....</a>
</div> 
```

设置事件处理程序：

```
$("div a").click(.....) 
```

在使用稍后`$("div").html('')`的事件处理程序`<div><a>`迷路时。

有什么方法可以完成这项工作 - 清理内容 - 并让处理程序存在吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T15:59:51.627

您可以将处理程序委托给 DOM 更高层的东西，例如`<body>`：

```
$('body').on('click', 'div a', function () {...}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T16:01:56.623

您可以使用 .live()：

```
$("div a").live("click", function(){ 
    alert("Still exists"); 
}); 
```

根据[jQuery的文档](http://api.jquery.com/live/)是：

> 为现在和将来匹配当前选择器的所有元素附加一个事件处理程序。

正如你[在这里](http://jsfiddle.net/darkajax/3zKfa/)看到的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T15:59:35.467

[jQuery.delegate](http://api.jquery.com/delegate/)会有用吗？给你的链接一个参考（类，ID），你应该保留它的行为。

# ios - iOS Facebook SDK V 3.0 上的重复符号 SBJSON

> ID：12041056
> 
> 赞同：2
> 
> 时间：2012-08-20T15:57:04.917
> 
> 标签：ios, facebook, sdk, sbjson

在当前的项目中，我到处都使用 SBJSON，并且由于 SBJSON 包含在 Facebook SDK 中，因此它可以与以前版本的 iOS Facebook SDK 一起正常工作。

我刚刚升级到 iOS Facebook SDK 3.0 版并且遇到了 SBJSON 问题。

它抱怨的第一件事是没有找到 SBJSON 头文件。所以我想，我可以手动将 SBJSON 库包含到项目中。

在我这样做之后，编译器抱怨 SBJSON 符号与 Facebook SDK 重复。

我在 FB SDK 标头中的任何地方都找不到 SBJSON.h。

所以最后，我陷入了一个问题的循环。

有谁知道如何解决这个问题？最坏的情况可能是我必须切换到使用其他适用于 iOS 的 JSON 库。

**注意：** 他们使用的是 Facebook SDK 框架，而不是之前的源代码库

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T14:27:08.857

我最终用来解决这个问题的是两种方法：

**第一个**

*   首先，不使用他们提供的预先构建的 Facebook SDK 框架
*   其次，查看 Facebook SDK 中的 Facebook SDK 源代码[并将](https://github.com/facebook/facebook-ios-sdk)其集成到项目中

**第二个**

[在此处](https://github.com/stig/json-framework)使用他们的源代码集成 Json 框架，并将任何重复类的名称更改为您的项目独有的名称，例如 SBJsonParser 到 MySBJsonParser

# javascript - jquery.include 和 jquery 1.8 之间的冲突

> ID：12041058
> 
> 赞同：0
> 
> 时间：2012-08-20T15:57:11.187
> 
> 标签：javascript, jquery, jquery-1.8

```
if(jQuery.browser.mozilla||jQuery.browser.opera)document.removeEventListener("DOMContentLoaded",jQuery.ready,!1),document.addEventListener("DOMContentLoaded",function(){jQuery.ready()},!1);jQuery.event.remove(window,"load",jQuery.ready);jQuery.event.add(window,"load",function(){jQuery.ready()});
jQuery.extend({includeStates:{},include:function(c,a,d){typeof a!="function"&&!d&&(d=a,a=null);c=c.replace("\n","");jQuery.includeStates[c]=!1;var b=document.createElement("script");b.type="text/javascript";b.onload=function(){jQuery.includeStates[c]=!0;a&&a.call(b)};b.onreadystatechange=function(){this.readyState!="complete"&&this.readyState!="loaded"||(jQuery.includeStates[c]=!0,a&&a.call(b))};b.src=c;d?(d.constructor!=Array&&(d=[d]),setTimeout(function(){var a=!0;jQuery.each(d,function(c,b){if(!b())return a=
!1});a?document.getElementsByTagName("head")[0].appendChild(b):setTimeout(arguments.callee,10)},10)):document.getElementsByTagName("head")[0].appendChild(b);return function(){return jQuery.includeStates[c]}},readyOld:jQuery.ready,ready:function(){jQuery.isReady||(imReady=!0,jQuery.each(jQuery.includeStates,function(c,a){if(!a)return imReady=!1}),imReady?jQuery.readyOld.apply(jQuery,arguments):setTimeout(arguments.callee,10))}});

jQuery.noConflict(); 
```

它与加载图像有关，即使它被加载到缓存中。在 1.7.2 版本中一切正常，但现在我遇到了 promises() 的问题

```
Uncaught TypeError: Object function (){jQuery.isReady||(imReady=!0,jQuery.each(jQuery.includeStates,function(c,a){if(!a)return imReady=!1}),imReady?jQuery.readyOld.apply(jQuery,arguments):setTimeout(arguments.callee,10))} has no method 'promise' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T00:27:49.113

我看到你正在使用“jQuery.browser”......它在 Jquery 1.8 中已被弃用

# android - 结合安卓的tab和listview

> ID：12041064
> 
> 赞同：0
> 
> 时间：2012-08-20T15:57:46.507
> 
> 标签：android, eclipse, listview, tabs

我正在为 android 开发一个应用程序，它应该有三个选项卡，显示三个不同的列表视图。它应该看起来很像这个视频示例：

[http://www.androidhive.info/2012/05/android-combining-tab-layout-and-list-view/](http://www.androidhive.info/2012/05/android-combining-tab-layout-and-list-view/)

我遇到的问题是 TabActivity 已被弃用，我找不到任何好的片段视图教程（我认为这是替换 TabView 的教程）。有人知道如何结合这两种观点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T16:16:50.967

您可能想查看 ActionBar 和 Fragments。也许以下链接可以帮助您？[http://www.lucazanini.eu/2012/android/tab-layout-in-android-with-actionbar-and-fragment/?lang=en](http://www.lucazanini.eu/2012/android/tab-layout-in-android-with-actionbar-and-fragment/?lang=en)

# linux - Linux：通过 ssh 使用 tee 命令

> ID：12041072
> 
> 赞同：1
> 
> 时间：2012-08-20T15:58:50.303
> 
> 标签：linux, ssh, tee

我已经编写了一个 Fortran 程序（我们称之为 program.exe），并为我做了一些模拟。通过 ssh，我登录了一些遥远的计算机以开始在那里运行，几天后我收集了这些计算机的结果。为了了解程序如何进行的最新情况，我还想将 shell 输出写入文本文件 output.txt （因为我不能一直登录到远处的计算机）。该命令应该类似于

```
nohup program.exe | tee output.txt > /dev/null & 
```

这使我能够查看 output.txt 以查看当前状态，即使程序尚未结束运行。上面的命令在我的本地机器上运行良好。我首先尝试使用命令'>'，但这里的问题是在整个程序完成之前没有任何内容写入文本文件（可能与管道缓冲区有关？）。所以我使用了'tee'的解决方法。

现在的问题是，当我通过 ssh (ssh -X user@machine) 登录计算机时，执行上述命令并使用 VI 编辑器查看 output.txt，直到程序完成后才会出现任何内容。如果我省略 'nohup' 和 '&' 我什至不会得到任何 shell 输出，直到它完成。我的想法是它可能必须对 ssh 缓冲的数据做一些事情，但我是一个 Linux 新手。对于任何想法或解决方法，我将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T16:07:26.180

我会使用`screen`实用程序[http://www.oreillynet.com/linux/cmd/cmd.csp?path=s/screen](http://www.oreillynet.com/linux/cmd/cmd.csp?path=s/screen)而不是`nohup`. 因此，我可以将我的程序设置为分离状态 (^A^D) 重新连接到主机，检索我的屏幕会话 (screen -r) 并监控我的输出，就好像我从未注销一样。

# jquery - jQuery .delegate()。事件未在第二次点击时触发

> ID：12041075
> 
> 赞同：0
> 
> 时间：2012-08-20T15:59:01.147
> 
> 标签：jquery

在我正在设计的一个新网站上，我有一个顶部 div，里面有一个链接。单击该链接时，div 动画到内容的完整高度。这可行，但我想再次单击该链接以将 div 动画恢复到以前的状态。这是行不通的。

我使用的是 jQuery 1.5.2，因此使用 .delegate() 而不是 .on()。请不要建议升级我的 jQuery 版本！

**jQuery**

```
// top bar & basket functionality
        var topbarContractedHeight = $('#topbar').height(); // get current height
        $('#topbar').css('height','auto'); // temp. set height to auto...
        var topbarExpandedHeight = $('#topbar').height(); // ...and store it
        $('#topbar').css('height',topbarContractedHeight); // put the height back to how it was

        $('.topbarcontracted').delegate('#basket_trigger', 'click', function(){
            $('#topbar').animate({ height: topbarExpandedHeight }, 500).removeClass('topbarcontracted').addClass('topbarexpanded'); // ...animate the height to the expanded height stored earlier, remove the 'contracted' class and add 'expanded'...
            return false; // ...and don't process the link
        });

        $('.topbarexpanded').delegate('#basket_trigger', 'click', function(){
            $('#topbar').animate({ height: topbarContractedHeight }, 500).removeClass('topbarexpanded').addClass('topbarcontracted'); // ...animate the height to the expanded height stored earlier, remove the 'expanded' class and add 'contracted'...
            return false; // ...and don't process the link
        }); 
```

如何让第二个 .delegate() 事件触发？

请在[http://jsfiddle.net/4KL2z/1/上尽情测试](http://jsfiddle.net/4KL2z/1/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T16:05:27.280

这真的很简单，而不是使用第二个委托，而是使用如下`if()`语句：

```
 $('.topbarcontracted').delegate('#basket_trigger', 'click', function(){
   if ($('#topbar').hasClass('topbarcontracted')) {
     $('#topbar').animate({ height: topbarExpandedHeight }, 500).removeClass('topbarcontracted').addClass('topbarexpanded'); // ...animate the height to the expanded height stored earlier, remove the 'contracted' class and add 'expanded'...
   } else {
     $('#topbar').animate({ height: topbarContractedHeight }, 500).removeClass('topbarexpanded').addClass('topbarcontracted'); // ...animate the height to the expanded height stored earlier, remove the 'expanded' class and add 'contracted'...
   }
   return false; // ...and don't process the link
 }); 
```

和 JSfiddle 链接：http: [//jsfiddle.net/4KL2z/2/](http://jsfiddle.net/4KL2z/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T16:10:06.980

尝试存储扩展 div 的状态以减少代码：

```
var expanded = false,
    $topBar = $('#topbar');

$topBar.delegate('#basket_trigger', 'click', function() {
    var height;

    if (expanded) {
        height = topbarContractedHeight;
        $topBar.removeClass('topbarexpanded').addClass('topbarcontracted');
    } else {
        height = topbarExpandedHeight;
        $topBar.removeClass('topbarcontracted').addClass('topbarexpanded');
    }

    expanded = !expanded;

    $topBar.animate({
        height: height
    }, 500);

    return false;
}); 
```

这是一个有效的[**演示**](http://jsfiddle.net/4KL2z/8/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-20T16:12:53.227

你可以使用toggleClass，如果你已经找到了`#topbar`保存它，你没有理由需要一遍又一遍地查找它：

```
$(document).ready(function(){
    var topbar= $('#topbar');
    var topbarContractedHeight = topbar.height(); // get current height
    var topbarExpandedHeight = topbar.css('height','auto').height();

    topbar.height(topbarContractedHeight);

    topbar.delegate('#basket_trigger', 'click', function(){
        var isContracted = topbar.hasClass('topbarcontracted');
        topbar.animate({
            height: (isContracted ? topbarExpandedHeight : topbarContractedHeight)
        }, 500).toggleClass('topbarexpanded',isContracted).toggleClass('topbarcontracted',!isContracted);
        return false;
    });

}); 
```

演示：http: [//jsfiddle.net/4KL2z/6/](http://jsfiddle.net/4KL2z/6/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-20T16:14:53.493

派对迟到了，但这里有一个彻底清理过的代码版本。你应该利用`toggleClass`; 这里不需要*任何* `if`陈述：

```
$(document).ready(function (){
    // top bar & basket functionality
    var topbarContractedHeight = $('#topbar').height(); // get current height
    $('#topbar').css('height','auto'); // temp. set height to auto...
    var topbarExpandedHeight = $('#topbar').height(); // ...and store it
    $('#topbar').css('height',topbarContractedHeight); // put the height back to how it was

    $('#topbar').click(function () {
        $(this).animate({
            height: ($(this).hasClass('expanded') ? topbarContractedHeight : topbarExpandedHeight)
        }).toggleClass('expanded');
        return false;
    });

}); 
```

​</p>

# ffmpeg - ffmpeg 同时输出到多个文件

> ID：12041077
> 
> 赞同：13
> 
> 时间：2012-08-20T15:59:08.307
> 
> 标签：ffmpeg

ffmpeg 需要什么格式/语法将相同的输入输出到几个不同的“输出”文件？例如不同的格式/不同的比特率？它是否支持输出的并行性？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-07-18T14:23:13.373

ffmpeg 文档已更新，包含更多关于此的信息，选项取决于您使用的 ffmpeg 版本：http: [//ffmpeg.org/trac/ffmpeg/wiki/Creating%20multiple%20outputs](http://ffmpeg.org/trac/ffmpeg/wiki/Creating%20multiple%20outputs)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-21T16:41:54.153

从[FFMpeg 文档](http://ffmpeg.org/ffmpeg.html)中，FFmpeg*写入任意数量的输出“文件”*。

只需确保每个输出文件（或流）前面都有正确的输出选项。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-06-08T14:08:05.323

我用

```
ffmpeg -f lavfi -re -i 'life=s=300x200:mold=10:r=25:ratio=0.1:death_color=#C83232:life_color=#00ff00,scale=1200:800:flags=16' \
-f lavfi -re -i sine=frequency=1000:sample_rate=44100 -pix_fmt yuv420p \
-c:v libx264 -b:v 1000k -g 30 -keyint_min 60 -profile:v baseline -preset veryfast -c:a aac -b:a 96k  \
-f flv "rtmp://yourname.com:1935/live/stream1" \
-f flv "rtmp://yourname.com:1935/live/stream2" \
-f flv "rtmp://yourname.com:1935/live/stream3" \ 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-20T19:36:32.757

你有什么理由不能只运行一个以上的实例`ffmpeg`吗？我有很好的结果......

通常我所做的是在**源**`ffmpeg`文件上运行一次以使其符合基本标准（比如更高质量的 h.264 mp4 文件），这将确保如果您的**源**文件有任何其他作业将更快地运行问题，因为它们将在第一次通过时被清理

 ****然后使用该新的**源/输入**文件运行 x 个`ffmpeg`作业，例如在**bash** ...

*您看到“...”的地方就是您放置所有编码选项的地方。*

```
# create 'base' file

ffmpeg -loglevel error -er 4 -i $INPUT_FILE ... INPUT.mp4 >> $LOG_FILE 2>&1

# the command above will run and then move to start 3 background jobs
# text output will be sent to a log file

echo "base file done!"

# note & at the end to send job to the background

ffmpeg ... -i INPUT.mp4 ... FILENAME1.mp4 ... >/dev/null 2>&1 &
ffmpeg ... -i INPUT.mp4 ... FILENAME2.mp4 ... >/dev/null 2>&1 &
ffmpeg ... -i INPUT.mp4 ... FILENAME3.mp4 ... >/dev/null 2>&1 &

# wait until you have no more background jobs running

wait > 0
echo "done!" 
```

每个后台作业将并行运行，并将（基本上）在您的 CPU 上保持平衡，因此您可以最大化每个内核。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-20T15:59:08.307

基于[http://sonnati.wordpress.com/2011/08/30/ffmpeg---the-swiss-army-knife-of-internet-streaming---part-iv/](http://sonnati.wordpress.com/2011/08/30/ffmpeg-)和[http://ffmpeg-users .933282.n4.nabble.com/Multiple-output-files-td2076623.html](http://ffmpeg-users.933282.n4.nabble.com/Multiple-output-files-td2076623.html)

```
ffmpeg -re -i rtmp://server/live/high_FMLE_stream -acodec copy -vcodec x264lib -s 640×360 -b 500k -vpre medium -vpre baseline rtmp://server/live/baseline_500k -acodec copy -vcodec x264lib -s 480×272 -b 300k -vpre medium -vpre baseline rtmp://server/live/baseline_300k -acodec copy -vcodec x264lib -s 320×200 -b 150k -vpre medium -vpre baseline rtmp://server/live/baseline_150k -acodec libfaac -vn -ab 48k rtmp://server/live/audio_only_AAC_48k 
```

或者您可以将输出通过管道传输到“tee”并将其发送到“X”其他进程以实际进行编码，例如

ffmpeg -i 输入 - | 球座 ...

这可能会节省 cpu，因为它可能会启用更多的输出并行性，这显然是不可用的

见[http://ffmpeg.org/trac/ffmpeg/wiki/Creating%20multiple%20outputs](http://ffmpeg.org/trac/ffmpeg/wiki/Creating%20multiple%20outputs)和[这里](http://ffmpeg-users.933282.n4.nabble.com/Multiple-output-files-td2076623.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-01-09T02:30:30.303

我已经这样做了

```
ffmpeg -re -i nameoffile.mp4 -vcodec libx264 -c:a aac -b:a 160k -ar 44100 -strict -2 -f flv  \
-f flv rtmp://rtmp.1.com/code \
-f flv rtmp://rtmp.2.com/code \
-f flv rtmp://rtmp.3.com/code \
-f flv rtmp://rtmp.4.com/code \
-f flv rtmp://rtmp.5.com/code \ 
```

但是并没有像我预期的那样完全正常工作，并且在使用 nginx 进行重新流****

# css - Chrome、IE 和 Firefox 中的 CSS 位置不同

> ID：12041083
> 
> 赞同：1
> 
> 时间：2012-08-20T15:59:28.240
> 
> 标签：css, internet-explorer, firefox, google-chrome

我有一个小图像/箭头，悬停时出现在我的菜单项下。问题是 IE 和 Firefox 对图像的定位与 Chrome 不同。有什么问题，我该如何解决？

这是我应用的CSS：

```
img#menu-item-25{position:absolute;right:600px;top:92px;}
img#menu-item-26{position:absolute;right:510px;top:92px;}
img#menu-item-27{position:absolute;right:390px;top:92px;}
img#menu-item-30{position:absolute;right:220px;top:92px;}
img#menu-item-29{position:absolute;right:105px;top:92px;}
img#menu-item-28{position:absolute;right:15px;top:92px;} 
```

# internet-explorer-8 - IE8 错误 - 元素在刷新前未显示在页面上

> ID：12041084
> 
> 赞同：1
> 
> 时间：2012-08-20T15:59:29.250
> 
> 标签：internet-explorer-8

我在 IE8 中遇到了一个非常奇怪的错误。页面上没有显示一堆元素，尽管使用开发人员工具我可以看到它们在 html 中并且没有被 CSS 隐藏。刷新页面可以解决这个问题。

该站点位于本地环境中，我无法将其放到网上。我从来没有听说过这样的错误，所以有人对事情有什么想法吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T16:06:16.870

我忘记验证代码。我没有意识到（由于大量空白），但是在指定打开文档类型之前放置了一些 div。希望解决此问题将使问题消失。谢谢

# ruby-on-rails - RoR：测试使用 http 令牌身份验证的操作

> ID：12041091
> 
> 赞同：20
> 
> 时间：2012-08-20T15:59:52.430
> 
> 标签：ruby-on-rails, testing, rspec2

我正在尝试测试在 before 过滤器中使用 http 令牌身份验证的控制器。我的问题是当我使用 curl 传递令牌时它工作正常，但在我的测试中它总是失败（我正在使用 rspec btw）。尝试了一个简单的测试来查看令牌是否完全通过，但似乎没有这样做。我是否缺少任何东西来让测试将令牌实际传递给控制器​​？

这是我之前的过滤器：

```
 def restrict_access
      authenticate_or_request_with_http_token do |token, options|
        api_key = ApiKey.find_by_access_token(token)
        @user = api_key.user unless api_key.nil?
        @token = token #set just for the sake of testing
        !api_key.nil?
      end 
    end 
```

这是我的测试：

```
 it "passes the token" do
      get :new, nil,
        :authorization => ActionController::HttpAuthentication::Token.encode_credentials("test_access1")

      assigns(:token).should be "test_access1"
    end 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-08-20T18:38:44.480

我假设 ApiKey 是一个 ActiveRecord 模型，对吗？curl 命令针对开发数据库运行，测试针对测试数据库。我在您的代码段中看不到任何设置 ApiKey 的内容。除非您在其他地方有它，否则请尝试按照以下方式添加一些内容：

```
it "passes the token" do
  # use factory or just create record with AR:
  ApiKey.create!(:access_token => 'test_access1', ... rest of required attributes ...)

  # this part remains unchanged
  get :new, nil,
    :authorization => ActionController::HttpAuthentication::Token.encode_credentials("test_access1")

  assigns(:token).should be "test_access1"
end 
```

您可以稍后将其移动到`before :each`块或支持模块。

更新：

看到你的评论后，我不得不更深入地研究。这是另一个猜测。这种形式的`get`

```
get '/path', nil, :authorization => 'string' 
```

应该只在集成测试中工作。对于控制器测试，身份验证准备应如下所示：

```
it "passes the token" do
  request.env['HTTP_AUTHORIZATION'] = ActionController::HttpAuthentication::Token.encode_credentials("test_access1")
  get :new
  assigns(:token).should be "test_access1"
end 
```

这背后的原因来自各个测试模块的方法签名：

```
# for action_controller/test_case.rb
def get(action, parameters = nil, session = nil, flash = nil)

# for action_dispatch/testing/integration.rb
def get(path, parameters = nil, headers = nil) 
```

# c++ - 精确的大有限域线性代数库（例如 GF(2^128) / GF(2^256) ）

> ID：12041093
> 
> 赞同：18
> 
> 时间：2012-08-20T15:59:57.980
> 
> 标签：c++, math, linear-algebra, computer-algebra-systems, finite-field

## 一般的

我正在寻找一个能够对大型有限域进行精确计算的库，例如 GF(2 ^(128) )/ [2 ^(128)]和 GF(2 ^(256) )/ [2 ^(256)]。我在下面列出了我需要的功能以及很酷的功能。显然，图书馆应该尽可能快:-)。啊，因为我不是 C++ 大师（可能大多数库都是 C++），所以示例代码说*生成一个随机元素/一个常数并将其乘以它的乘法逆*

## 必备功能

*   添加字段元素
*   字段元素的乘法
*   求域元素的乘法逆元

## 很高兴有功能

*   矢量/矩阵支持
*   随机元素支持

## 我已经看过的库可能*不起作用*

*   [FFLAS/FFPACK](http://www-ljk.imag.fr/membres/Jean-Guillaume.Dumas/FFLAS/)，似乎不适用于如此大的有限域
*   [Givaro](http://givaro.forge.imag.fr/)似乎不适用于如此大的有限域

## 我已经看过*可以*工作的库（但我无法使用）

*   ~~[NTL](http://www.shoup.net/ntl/)，我无法反转元素，但它应该真的可以工作，因为[SAGE](http://sagemath.org)在定义 GF(2^256) 时似乎使用了这个库，并且可以使用反转元素`x^(-1)`~~
*   [PARI/GP](http://pari.math.u-bordeaux.fr/)，我无法在文档中找到我需要的所有内容，但 SAGE 文档有点说它应该可以工作

## 其他注意事项

*   我正在编写一个 Haskell 程序，稍后将与该库进行接口，因此更简单的 Haskell 接口会更好:-)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-21T10:59:00.667

NTL 库似乎可以工作，使用这个（对不起，我无法用 C++ 编程）代码

```
#include <NTL/GF2E.h>
#include <NTL/GF2EX.h>
#include <NTL/GF2X.h>
#include <NTL/GF2XFactoring.h>

NTL_CLIENT

int main()
{
    GF2X P = BuildIrred_GF2X(256);
    GF2E::init(P);

    GF2E zero = GF2E::zero();
    GF2E one;
    GF2E r = random_GF2E();
    GF2E r2 = random_GF2E();
    conv(one, 1L);
    cout << "Cardinality: " << GF2E::cardinality() << endl;
    cout << "ZERO: " << zero << " --> " << IsZero(zero) << endl;
    cout << "ONE:  " << one  << " --> " << IsOne(one)   << endl;
    cout << "1/r:  " << 1/r  << ", r * (1/r): " << (r * (1/r)) << endl;
    cout << "1/r2:  " << 1/r2  << ", r2 * (1/r2): " << (r2 * (1/r2)) << endl;
} 
```

它似乎有效，证明（该程序的输出）：

```
Cardinality: 115792089237316195423570985008687907853269984665640564039457584007913129639936
ZERO: [] --> 1
ONE:  [1] --> 1
1/r:  [0 1 0 1 1 0 1 1 1 0 1 1 1 0 0 1 1 0 1 1 1 0 1 1 0 0 0 0 0 1 0 1 0 1 1 0 1 1 0 0 0 0 0 0 1 1 1 0 1 1 1 0 1 0 1 0 0 0 1 1 1 0 1 1 1 1 0 1 0 1 0 1 1 0 1 1 1 0 0 0 1 0 0 1 0 1 1 1 0 1 1 0 1 1 0 0 0 0 0 1 1 0 1 0 1 0 0 0 0 0 1 0 0 1 1 0 0 1 0 0 1 0 1 1 1 1 0 0 1 1 0 1 0 1 1 1 1 1 1 0 1 1 0 0 0 0 0 1 1 0 1 0 0 1 1 1 0 1 1 1 1 1 0 1 0 1 0 0 0 1 1 0 0 1 1 0 0 1 0 1 1 1 0 1 1 1 1 1 0 1 1 0 1 1 1 1 0 1 0 0 0 0 1 1 1 0 1 1 1 0 1 1 1 1 1 1 1 1 0 1 0 1 0 0 1 1 0 1 1 0 1 1 1 1 1 0 0 1 1 0 1 0 1 0 0 0 0 1 1 0 0 1 1 1 0 1], r * (1/r): [1]
1/r2:  [1 0 1 1 0 0 0 0 1 0 1 0 0 0 1 0 0 0 1 1 0 0 1 0 1 0 0 0 1 1 1 0 0 0 1 1 1 1 1 0 1 0 1 1 0 0 1 1 1 0 1 0 1 0 0 1 0 0 0 0 1 1 1 0 0 0 1 1 1 1 1 0 0 1 0 0 0 1 1 0 1 0 1 1 1 0 0 1 0 1 0 1 0 0 1 0 0 0 1 0 0 1 1 1 1 1 0 0 0 0 1 1 1 0 1 0 1 0 1 0 0 0 1 0 1 0 1 1 0 0 0 1 0 1 1 0 0 1 1 0 0 1 1 0 0 1 1 1 1 1 0 1 1 0 0 0 0 1 1 0 1 1 1 0 1 0 0 0 0 0 1 1 0 1 1 1 0 0 0 0 1 1 0 1 0 0 0 0 1 0 0 0 0 1 1 1 1 1 0 1 0 1 1 0 1 0 1 0 1 1 1 1 0 0 1 1 0 1 1 1 1 1 0 1 1 1 0 1 0 0 0 0 1 0 1 1 0 0 0 1 1 0 0 1 1 0 1 0 0 1 0 1 0 0 1 1], r2 * (1/r2): [1] 
```

甚至反转似乎也有效（在上面的输出示例中尽可能向右滚动）:-)

# jquery - Infragistics Jquery Grid 主键

> ID：12041098
> 
> 赞同：3
> 
> 时间：2012-08-20T16:00:27.480
> 
> 标签：jquery, infragistics, ignite-ui, iggrid

我正在尝试在我的网格上进行行选择，但在设置或获取 datakey 值时遇到了困难，因为我在上面找不到任何文档。

```
$("#divGrid").igGrid({
            columns: [
                { headerText: "@Manage.gridColumnEmployeeNumber", key: "EmployeeNumber" },
            ],
            dataKeyFields: "EmployeeNumber",  //Is this how you set the dataKeys?
            autoGenerateColumns: false,
            dataSource: jsonp,
            features: [
                {
                    name: "Selection",
                    rowSelectionChanging: rowSelectionChanging
                }
            ]
        });
    }); 
```

这根本不起作用。如何在这部分代码中访问我的 dataKey (primaryKey)？

```
 function rowSelectionChanging(evt, ui) {
        if (confirm) {
            var rows = ui.getSelectedRows();
            var selectedRow = rows.getItem(0);
            var selectedDataKey = selectedRow.get_dataKey();

            alert(selectedDataKey);
        } else {
            return false;
        }
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-21T11:46:10.220

> [...] dataKeyFields: "EmployeeNumber", //你是这样设置数据键的吗？[...]

足够近。它实际上是像这样的'primaryKey'：

> [...]
> 主键：“员工编号”，
> [...]

对于第二部分，我想这不是很明显，但是作为参数传递的行是被选择的实际 DOM TR 元素，你可以（正如你当前的设置所建议的那样）清楚地选择它的单元格的键，比如所以：

```
var rowKey = $(ui.row.element).children().eq(0).text(); //may need to parse if int 
```

*注意： eq() 方法采用从零开始的索引，并且就结构而言，行的子元素是单元格。在您的情况下，主键列是第一个（也是唯一一个），因此索引为 0。*

我发现对编程更友好的另一种方法是直接从数据源获取密钥（更清晰易读且无需解析）：

```
var rowKey = ui.owner.grid.dataSource.dataView()[ui.row.index].EmployeeNumber; 
```

*注意：“所有者”是负责事件（选择）的实际小部件，它引用了您的“网格”，您可以从那里访问数据源。要获取记录，请使用 '.data()' 或 '.dataView()' - 后者仅包含索引所基于的实际可见行，如果启用了任何其他功能（分页、排序、过滤），则应使用后者..)。*

这是（底部）描述选择事件提供的文档页面 - [http://help.infragistics.com/NetAdvantage/jQuery/2012.1/CLR4.0?page=igGrid_Selection_Overview.html](http://help.infragistics.com/NetAdvantage/jQuery/2012.1/CLR4.0?page=igGrid_Selection_Overview.html)

这是完整的 API 参考：[http](http://help.infragistics.com/jQuery/2012.1/ui.iggridselection#events) ://help.infragistics.com/jQuery/2012.1/ui.iggridselection#events - 从这里您可以深入了解任何网格/网格功能/数据源 API 和事件有所有有用的示例片段列出的参数。

PS 如果不打算控制用户的选择，请考虑使用“rowSelectionChanged”中的“-ed”事件 - 可用的参数是相同的。不同之处在于“-ing”是在选择过程中触发的，它会阻塞 UI，如果您添加一些更繁重的逻辑，这可能会导致应用程序响应速度不快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-20T03:33:46.730

尝试 var rowKey = ui.owner.grid.options.primaryKeyValue;

# java - Java HTTPClient 4.2.1 仍然收到 401 Unauthorized

> ID：12041108
> 
> 赞同：4
> 
> 时间：2012-08-20T16:01:26.277
> 
> 标签：java, authentication, httpclient

我正在**尝试连接到**SharePoint **url**，因此我使用了 httpcomponents-client-4.2.1\examples\org\apache\http\examples\client\ClientAuthentication.java 中的示例代码，但将其更改为 NTCredentials 以忽略证书问题。**除此之外，代码是相同的，但输出如下：**

```
executing requestGET url HTTP/1.1
----------------------------------------
HTTP/1.1 401 Unauthorized
Response content length: 0 
```

这是完整的代码

```
public class DocumentApprover {

    static final String user = "user"; // your account name
    static final String pass = "password"; // your password for the account

    public static DefaultHttpClient wrapClient(DefaultHttpClient base) {
        try {
            SSLContext ctx = SSLContext.getInstance("TLS");
            X509TrustManager tm = new X509TrustManager() {

                public void checkClientTrusted(X509Certificate[] xcs, String string) throws CertificateException {
                }

                public void checkServerTrusted(X509Certificate[] xcs, String string) throws CertificateException {
                }

                public X509Certificate[] getAcceptedIssuers() {
                    return null;
                }
            };
            ctx.init(null, new TrustManager[]{tm}, null);
            SSLSocketFactory ssf = new SSLSocketFactory(ctx, SSLSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER);
            ClientConnectionManager ccm = base.getConnectionManager();
            SchemeRegistry sr = ccm.getSchemeRegistry();
            sr.register(new Scheme("https", 443, ssf));
            return new DefaultHttpClient(ccm, base.getParams());
        } catch (Exception ex) {
            ex.printStackTrace();
            return null;
        }
    }

    /**
     * @param args
     */
    public static void main(String[] args) {
        // TODO Auto-generated method stub

        try {

            DefaultHttpClient httpclient = wrapClient(new DefaultHttpClient());
            try {
                httpclient.getCredentialsProvider().setCredentials(
                    new AuthScope("host", 443),
                    new NTCredentials(user, pass, "workstation", "domain"));

                HttpGet httpget = new HttpGet("url");

                System.out.println("executing request" + httpget.getRequestLine());
                HttpResponse response = httpclient.execute(httpget);
                HttpEntity entity = response.getEntity();

                System.out.println("----------------------------------------");
                System.out.println(response.getStatusLine());
                if (entity != null) {
                System.out.println("Response content length: " + entity.getContentLength());
                }
                EntityUtils.consume(entity);
            } finally {
                // When HttpClient instance is no longer needed,
                // shut down the connection manager to ensure
                // immediate deallocation of all system resources
                httpclient.getConnectionManager().shutdown();
            }

        } catch (Exception e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    }

} 
```

为什么会失败？如果凭据错误，我不会得到不同的错误吗？

# php - 动态复制 Excel 工作表

> ID：12041109
> 
> 赞同：0
> 
> 时间：2012-08-20T16:01:26.557
> 
> 标签：php, excel, xlsx, tinybutstrong, opentbs

有没有办法在模板端使用 openTBS 动态复制 Ms Excel 工作表？我曾经在 Word 女士中用块开始和结束之间的“分页符”来分隔它......

我需要的是

```
[base;block=begin]
"blablabla text...."
(Page Break)
[base;block=end] 
```

所以它可以在另一个页面上重复所有块。

有没有办法在 Excel 中做到这一点？但不是分页符，而是任何其他可以在 Excel 中工作的东西:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T22:40:48.520

不幸的是，OpenTBS 还不能复制 Ms Excel 工作表。

这可以使用 ODS (LibreOffice) 工作表完成，但不能使用 Ms Excel 完成，因为此类工作表不是保存在单个子文件中，而是保存在多个子文件中，这些子文件都在其他子文件中引用。因此，没有定义工作表的 TBS 块。

不过，您可以通过在模板中添加尽可能多的空工作表来模拟重复，而不是重复工作表。然后在合并期间使用命令 OPENTBS_DELETE_SHEETS 删除无用的工作表。然后使用属性 $TBS->Source 将工作表的源从一个复制到另一个。如果没有图像或图表等对象，则可以复制工作表的来源。

# java - JUnit 为 com.google.common.collect.Iterables.tryFind 抛出 java.lang.NoSuchMethodError

> ID：12041111
> 
> 赞同：8
> 
> 时间：2012-08-20T16:01:31.880
> 
> 标签：java, junit, guava, nosuchmethoderror

我正在使用 Google Guava v13.0，但是当我使用包含 tryFind 的代码运行 JUnit 测试时，我收到以下消息：

```
java.lang.NoSuchMethodError: com.google.common.collect.Iterables.tryFind(Ljava/lang/Iterable;Lcom/google/common/base/Predicate;)Lcom/google/common/base/Optional; 
```

这似乎只发生在 JUnit 测试中，因为当生产代码运行时没有问题。我正在使用 Intellij IDEA v11.1.3 并且可以导航到 guava JAR 文件以在 com.google.common.collect.Iterable.class 中找到 tryFind。

我看过类似的帖子，但我不确定这与 JUnit 有何关系。关于我的问题可能是什么的任何想法？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-20T17:45:27.293

除了您尝试使用的较新版本之外，此类错误通常是由于类路径中存在较旧版本的 Guava（甚至是 google-collections）引起的。尝试在运行测试时检查类路径上的内容。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-08-20T20:30:07.040

使用 Colin 的回答，这是检测加载内容的好方法：

```
System.out.println(
    Iterables.class.getProtectionDomain().getCodeSource().getLocation()
); 
```

这应该打印出您正在使用的番石榴（或 gc）版本的路径。

# c# - 使用 MS Visual Studio 2010 在 C# 中读取 Excel 文件：如何给出相对路径？

> ID：12041113
> 
> 赞同：0
> 
> 时间：2012-08-20T16:01:38.467
> 
> 标签：c#, visual-studio-2010, excel

我正在通过以下方式读取 Excel 文件：

```
string path = @"C:\Users\myUserName\inputfile.xlsx";
Excel.Application app = new Application();
Excel.Workbook workbook = app.Workbooks.Open(path, 0, true, 5, "", "", true, Excel.XlPlatform.xlWindows, "\t", false, false, 0, true, 1, 0); 
```

我想知道是否有任何方法可以提供相对路径而不是硬编码的绝对路径。我的想法是将 inputfile.xlsx 放在同一目录中并执行类似...

```
string path = @"inputfile.xlsx"; 
```

但是，它给出了“COMException unhandled..”，“inputfile.xlsx not found”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T16:06:27.887

使用以下代码获取 .exe 位置：</p>

```
string localPath = System.IO.Path.GetDirectoryName
‫‪(System.Reflection.Assembly.GetExecutingAssembly().Location‬‬) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T16:06:06.417

如果有任何疑问，您可以使用[Directory.GetCurrentDirectory()](http://msdn.microsoft.com/en-us/library/system.io.directory.getcurrentdirectory%28v=vs.110%29.aspx)来了解您当前的目录是什么。

如果 Excel 没有找到该文件，那么您很可能误解了当前目录是什么。构造相对于 GetCurrentDirectory() 返回的目录的路径。

仅供参考，独立运行应用程序、在调试器中和在 MS Test 单元测试中都将设置*不同*的当前目录。原因是可执行文件在每种情况下都是从不同的目录启动的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T16:03:54.283

确保 excel 文件与可执行文件位于同一文件夹中，或者确保相对路径正确，相对于包含可执行文件的目录。

如果您的项目中包含 excel 文件，您也可以在解决方案资源管理器中右键单击它，单击属性，然后将“复制到输出目录”设置为“始终复制”。这将导致文件被放置在项目输出目录中。相对路径将只包含文件名。

# php - PHP基于重复键VALUE组合类似数组，而不仅仅是键本身

> ID：12041116
> 
> 赞同：0
> 
> 时间：2012-08-20T16:01:49.443
> 
> 标签：php, arrays

我有一个如下所示的数组（这是 $data 变量上的 print_r）

```
大批
(
    [0] => 数组
        (
            [权] => 1
            [prod_key] => 6f2e8858b8333afaeec8cd51be30ba6a
            [标题] => 扫帚柄 - 6" x 12.5"
            [总计] => 11.00
            [重量] => 0.25
            [图片] => thumb_37658989fcd29e9.jpg
        )

    [1] => 数组
        (
            [权] => 1
            [prod_key] => 6f2e8858b8333afaeec8cd51be30ba6a
            [标题] => 扫帚柄 - 6" x 12.5"
            [总计] => 11.00
            [重量] => 0.25
            [图片] => thumb_37658989fcd29e9.jpg
        )
    [2] => 数组
        (
            [权] => 1
            [prod_key] => of2ef85vb8333afaeec8cd51be30jq7i
            [标题] => 观看
            [总计] => 65.00
            [重量] => 0.15
            [图片] => thumb_37658989fcd29e9.jpg
        )
)

```

我要做的是遍历数组并将具有相同 prod_key 的项目组合成一个项目并更新总数、数量和重量，因此上面的示例应如下所示：

```
大批
(
    [0] => 数组
        (
            [权] => 2
            [prod_key] => 6f2e8858b8333afaeec8cd51be30ba6a
            [标题] => 扫帚柄 - 6" x 12.5"
            [总计] => 22.00
            [重量] => 0.50
            [图片] => thumb_37658989fcd29e9.jpg
        )
    [1] => 数组
        (
            [权] => 1
            [prod_key] => of2ef85vb8333afaeec8cd51be30jq7i
            [标题] => 观看
            [总计] => 65.00
            [重量] => 0.15
            [图片] => thumb_37658989fcd29e9.jpg
        )
)

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T16:09:24.073

创建一个新数组并将产品密钥用作数组索引。然后您可以轻松添加或更新条目

```
$result = array();
foreach ($data as $v) {
    if (!isset($result[$v['prod_key']])) {
        $result[$v['prod_key']] = $v;
    } else {
    $result[$v['prod_key']]['quan'] += $v['quan'];
    $result[$v['prod_key']]['total'] += $v['total'];
    $result[$v['prod_key']]['weight'] += $v['weight'];
        //etc...
    }
} 
```

# c# - EF 4.1 代码优先列名“User_UserId”无效

> ID：12041119
> 
> 赞同：0
> 
> 时间：2012-08-20T16:02:11.520
> 
> 标签：c#, entity-framework

我无法弄清楚为什么这会导致 EF 错误：保存在 EF 中时列名“User_UserId”无效。

这是我的模型：

```
 [DataContract(IsReference = true)]
public class User
{
    [Key]
    [DataMember]
    public virtual Guid UserId { get; set; }

    [DataMember]
    public virtual string Username { get; set; }

    [DataMember]
    public virtual string Password { get; set; }

    [DataMember]
    public virtual string Email { get; set; }

    [DataMember]
    public virtual ICollection<FriendList> FriendLists { get; set; }
}

[DataContract(IsReference = true)]
public class FriendList
{
    [Key]
    [DataMember]
    public virtual Guid FriendListId { get; set; }

    [DataMember]
    [ForeignKey("User")]
    public virtual Guid UserId { get; set; }

    [DataMember]
    public virtual User User { get; set; }

    [DataMember]
    [ForeignKey("FriendUser")]
    public virtual Guid FriendUserId { get; set; }

    [DataMember]
    public virtual User FriendUser { get; set; }
} 
```

基本上，它与拥有好友列表的用户的一对多关系。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T19:10:26.003

您的类中有*两个*导航类型`User`的属性`FriendList`。EF 无法确定其中哪些属于`User.FriendLists`，然后为所有*三个*导航属性创建单独的一对多关系，其中一个具有默认外键名称`User_UserId`。

`InverseProperty`您可以使用以下属性覆盖此约定：

```
public class FriendList
{
    // ...

    [DataMember]
    [InverseProperty("FriendLists")]
    public virtual User User { get; set; }

    // ...
} 
```

现在，`User.FriendLists`和`FriendList.User`是相同一对多关系的端点，并`FriendList.FriendUser`定义了第二个一对多关系（但在`User`类中没有端点）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T18:52:44.473

我猜：

1）您的情况下的属性 ForeignKey 必须设置为`[ForeignKey("UserId")]`而不是`[ForeignKey("User")]`

2) 或者如果这些类之一没有被映射，您必须在其上设置属性 [NotMapped]；

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-10T13:43:46.947

您的 ForeignKey 属性位于错误的位置。

试试这个：

```
[DataMember]
public virtual Guid UserId { get; set; }

[DataMember]
[ForeignKey("UserId")]
public virtual User User { get; set; }

[DataMember]
public virtual Guid FriendUserId { get; set; }

[DataMember]
[ForeignKey("FriendUserId")]
public virtual User FriendUser { get; set; } 
```

至少它对我有用。

# powershell - 使用 start-process 调用其他 powershell 文件的问题

> ID：12041122
> 
> 赞同：13
> 
> 时间：2012-08-20T16:02:19.637
> 
> 标签：powershell, batch-file

编辑::::查看当前问题的最底部。

在当前设置中，批处理文件调用具有以下内容的 powershell 脚本

```
powershell D:\path\powershellScript.v32.ps1 arg1 arg2 arg3 arg4 
```

我想将其转换为调用另一个 powershell 的 powershell 脚本。但是，我在使用启动过程时遇到问题。这是我目前拥有的，但在执行时我得到以下

```
No application is associated with the specified file for this operation 
```

这是正在执行的 powershell

```
$powershellDeployment = "D:\path\powershellScript.v32.ps1"
$powershellArguments = "arg1 arg2 arg3 arg4"
Start-Process $powershellDeployment -ArgumentList $powershellArguements -verb runas -Wait 
```

编辑：：：：：：

由于下面的帮助，我现在有以下

```
$username = "DOMAIN\username"
$passwordPlainText = "password"     
$password = ConvertTo-SecureString "$passwordPlainText" -asplaintext -force
$cred = New-Object -TypeName System.Management.Automation.PSCredential -argumentlist $username,$password

$powershellArguments = "D:\path\deploy.code.ps1", "arg1", "arg2", "arg3", "arg4"
Start-Process "powershell.exe" -credential $cred  -ArgumentList $powershellArguments 
```

但是，当我从远程计算机执行此脚本时，我收到“拒绝访问”错误，即使使用的用户名具有对计算机的完全管理员访问权限

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-20T16:34:00.880

您应该使用`Start-Process powershell.exe`, 并将脚本的路径作为`-File`arg 列表中的参数传递。该`No application...`位意味着您没有设置默认应用程序来处理计算机上的 .ps1 文件。如果您`Right Click -> Open With -> Select Application -> check "Use this program as default..."`对任何 .ps1 文件执行完整的花絮，那么该消息就会消失。我的默认程序是记事本，所以当我`Start-Process`在 .ps1 上使用时，它会在其中弹出。

编辑：

把它们放在一起...

```
Start-Process powershell.exe -ArgumentList "-file C:\MyScript.ps1", "Arg1", "Arg2" 
```

或者，如果你定义`$powershellArguments`为 Keith 所说的 ( `$powershellArguments = "-file C:\MyScript.ps1", "arg1", "arg2", "arg3", "arg4"`)，那么就像这样：

```
Start-Process powershell.exe -ArgumentList $powershellArguments 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-20T16:20:07.083

改变这个：

```
$powershellArguments = "arg1 arg2 arg3 arg4" 
```

至

```
$powershellArguments = "arg1", "arg2", "arg3", "arg4" 
```

该`-ArgumentList`参数需要一个参数数组 - 而不是包含所有参数的单个字符串。

# java - 加载 CSV 时的性能调整

> ID：12041123
> 
> 赞同：0
> 
> 时间：2012-08-20T16:02:20.300
> 
> 标签：java, performance, oracle

我附上了下面的代码

**功能性**

用 webmacro 替换值后读取 csv 并插入 db。

从 csv 读取值@第一个标题信息**NO,NAME**旁边一个一个读取值并放入 webmacro 上下文 context.put("1","RAJARAJAN") 下一个 webmacro 替换 $(NO) ==>1 和 $( NAME)==>RAJARAJAN 并在语句批次达到 1000 后添加执行批次。

代码按功能运行，但解析 50,000 条记录需要 4 分钟，需要性能改进或需要更改逻辑......如果有任何疑问，请告诉我。任何对剧烈性能的改变......

**注意：**我使用 webmacro 是因为将合并查询中的 $(NO) 替换为 CSV 中读取的值

**巴拉.csv**

```
 NO?NAME
    1?RAJARAJAN
    2?ARUN
    3?ARUNKUMAR

Connection con=null;
Statement stmt=null;
Connection con1=null;
int counter=0;
    try{
         WebMacro wm = new WM();
         Context context = wm.getContext();
         String strFilePath = "/home/vbalamurugan/3A/email-1822820895/Bala.csv";
         String msg="merge into temp2  A using
         (select '$(NO)' NO,'$(NAME)' NAME from dual)B on(A.NO=B.NO)
                   when not matched then  insert (NO,NAME)
                      values(B.NO,B.NAME) when matched then
                      update set A.NAME='Attai' where A.NO='$(NO)'"; 
         String[]rowsAsTokens;
         con=getOracleConnection("localhost","raymedi_hq","raymedi_hq","XE");
         con.setAutoCommit(false);
         stmt=con.createStatement();
         File file = new File(strFilePath);
     Scanner scanner = new Scanner(file);
        try {
            String headerField;
            String header[];
            headerField=scanner.nextLine();
            header=headerField.split("\\?");
            long start=System.currentTimeMillis();
            while(scanner.hasNext()) {      
                String scan[]=scanner.nextLine().split("\\?");
                for(int i=0;i<scan.length;i++){
                    context.put(header[i],scan[i]);
                }
          if(context.size()>0){
                String m=replacingWebMacroStatement(msg,wm,context);
                if(counter>1000){
                    stmt.executeBatch();
                    stmt.clearBatch();
                    counter=0;
                }else{
                    stmt.addBatch(m);
                    counter++;
                }

                  }
        }
    long b=System.currentTimeMillis()-start;
    System.out.println("=======Total Time Taken"+b);
        }catch(Exception e){
            e.printStackTrace();
        }
      finally {
         scanner.close();
       }      
              stmt.executeBatch();
              stmt.clearBatch();
              stmt.close();
        }catch(Exception e){
          e.printStackTrace();
          con.rollback();

      }finally{
          con.commit();

      }

// Method For replace webmacro with $
 public static String replacingWebMacroStatement(String Query, WebMacro wm,Context context) throws Exception {

    Template template = new StringTemplate(wm.getBroker(), Query);
    template.parse();
    String macro_replaced = template.evaluateAsString(context);
    return macro_replaced;
}
// for getting oracle connection
 public static Connection getOracleConnection(String IPaddress,String username,String password,String Tns)throws SQLException{
      Connection connection = null;
      try{
      String baseconnectionurl ="jdbc:oracle:thin:@"+IPaddress+":1521:"+Tns;
      String driver = "oracle.jdbc.driver.OracleDriver";
      String user = username;
      String pass = password;
      Class.forName(driver);
      connection=DriverManager.getConnection(baseconnectionurl,user,pass);
      }catch(Exception e){
       e.printStackTrace();
      }
      return connection;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T18:24:48.580

我可以告诉你，这段代码在我的机器上平均需要大约 150 毫秒：

```
 StrTokenizer tokenizer = StrTokenizer.getCSVInstance();
    for (int i=0;i<50000;i++) {
        tokenizer.reset("a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z");
        String toks[] = tokenizer.getTokenArray();
    } 
```

您会在 apache commons-lang 包中找到 StrTokenizer，但我怀疑 String.split()、StringTokenizer 或 Scanner.nextLine() 在任何情况下都会成为您的瓶颈。我会假设这是您的数据库插入时间。

如果是这种情况，您可以做以下两件事中的一件：

1.  调整批量大小。
2.  多线程插入

正如建议的那样，分析器将帮助确定您的时间花在哪里。，

# c# - 规范化 excel 电子表格数据（列到行）

> ID：12041124
> 
> 赞同：0
> 
> 时间：2012-08-20T16:02:25.830
> 
> 标签：c#, office-interop, excel-interop

我正在尝试使用 Microsoft Interop Excel 对象规范化 Excel 电子表格中的数据。基本上，我需要将列转换为从某个列偏移量开始的行。

```
Original Data:
ColumnA ColumnB ColumnC ColumnD ColumnE ColumnF
   X       Y      10      20      30      40

Normalized Data:
ColumnA ColumnB NewColumn Value
  X        Y     ColumnC   10
  X        Y     ColumnD   20
  X        Y     ColumnE   30
  X        Y     ColumnF   40 
```

我的功能按预期工作。但是，运行时间非常缓慢。所以，我想知道如果我使用像 OpenXML 这样的任何其他框架，我会看到效率的提高吗

这是我使用互操作对象的代码：

```
public static void Normalize(string aFilePathName, string aSheetName, int aColOffSet, string aPivotColName, string aValueColName)
{
  LOG.DebugFormat("Normaling data in file: {0}", aFilePathName);
  LOG.DebugFormat("Sheet Name:{0} ColOffset:{1}", aSheetName, aColOffSet);

   Excel.Application vExcel = new Excel.Application();
   Excel.Workbook vWorkbook = null;
   Excel.Worksheet vWsOriginal = null;
   Excel.Worksheet vWsNormalized = null;
   try
     {
        vExcel.Visible = false;
        vWorkbook = vExcel.Workbooks.Open(aFilePathName, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value);
        vWsOriginal = vWorkbook.Worksheets[aSheetName];
        string vNormalizedSheetName = string.Format("Normalized {0}", aSheetName);
        bool vNormalizedSheetExists = (vWorkbook.Sheets.Cast<object>()
                                            .Select(sheetValue => sheetValue as Excel.Worksheet))
                                            .Any(wbSheet => wbSheet != null && wbSheet.Name == vNormalizedSheetName);
            if (!vNormalizedSheetExists)
            {
                vWsNormalized = vWorkbook.Worksheets.Add(vWsOriginal, Type.Missing, Type.Missing, Type.Missing);
                vWsNormalized.Name = vNormalizedSheetName;
            }
            else
            {
                vWsNormalized = vWorkbook.Worksheets[vNormalizedSheetName];
            }
            vWsNormalized.UsedRange.ClearContents();

            long vTotalColumns = 1;
            long vRowCounter = 1;
            Excel.Range vWsRange = vWsOriginal.Cells[vRowCounter, vTotalColumns];

            List<string> vHeaders = new List<string>();
            while (vWsRange.Value2 != null)
            {
                vHeaders.Add(vWsRange.Value2.ToString());
                vTotalColumns = vTotalColumns + 1;
                vWsRange = vWsOriginal.Cells[vRowCounter, vTotalColumns];
            }

            // Insert the headers
            for (int vHeaderCol = 1; vHeaderCol < aColOffSet; vHeaderCol++)
            {
                vWsNormalized.Cells[1, vHeaderCol].Value = vHeaders[vHeaderCol - 1];
            }
            vWsNormalized.Cells[1, aColOffSet].Value = aPivotColName;
            vWsNormalized.Cells[1, aColOffSet + 1].Value = aValueColName;

            long vNewRow = 2;

            for (int vCol = aColOffSet; vCol < vTotalColumns; vCol++)
            {
                vRowCounter = 2;
                while (((Excel.Range)vWsOriginal.Cells[vRowCounter, 1]).Value2 != null)
                {
                    for (int j = 1; j < aColOffSet; j++)
                    {
                        vWsNormalized.Cells[vNewRow, j] = vWsOriginal.Cells[vRowCounter, j];
                    }

                    vWsNormalized.Cells[vNewRow, aColOffSet] = vWsOriginal.Cells[1, vCol];
                    vWsNormalized.Cells[vNewRow, aColOffSet + 1] = vWsOriginal.Cells[vRowCounter, vCol];

                    vRowCounter = vRowCounter + 1;

                    vNewRow = vNewRow + 1;
                }
            }
        }
        finally
        {
            vWorkbook.Close(Excel.XlSaveAction.xlSaveChanges, Type.Missing, Type.Missing);
            Marshal.FinalReleaseComObject(vWsNormalized);
            Marshal.FinalReleaseComObject(vWsOriginal);
            Marshal.FinalReleaseComObject(vWorkbook);
            vExcel.Quit();
            Marshal.FinalReleaseComObject(vExcel);
        }
    } 
```

如果有可能提高性能，我愿意尝试任何其他开源框架。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T18:52:40.390

我能够想出一个更好的实现。无需遍历每个单元格，而是利用 Excel 转置功能进行批量复制。

```
public static void Normalize2(string aFilePathName, string aSheetName, int aColOffSet, string aPivotColName, string aValueColName)
    {
        LOG.DebugFormat("Normaling data in file: {0}", aFilePathName);
        LOG.DebugFormat("Sheet Name:{0} ColOffset:{1}", aSheetName, aColOffSet);

        Excel.Application vExcel = new Excel.Application();
        Excel.Workbook vWorkbook = null;
        Excel.Worksheet vWsOriginal = null;
        Excel.Worksheet vWsNormalized = null;
        try
        {
            vExcel.Visible = false;
            vWorkbook = vExcel.Workbooks.Open(aFilePathName, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value, Missing.Value);
            vWsOriginal = vWorkbook.Worksheets[aSheetName];
            //vWsOriginal.Name = string.Format("Original_{0}", aSheetName);
            string vNormalizedSheetName = string.Format("Normalized {0}", aSheetName);
            bool vNormalizedSheetExists = (vWorkbook.Sheets.Cast<object>()
                                            .Select(sheetValue => sheetValue as Excel.Worksheet))
                                            .Any(wbSheet => wbSheet != null && wbSheet.Name == vNormalizedSheetName);
            if (!vNormalizedSheetExists)
            {
                vWsNormalized = vWorkbook.Worksheets.Add(vWsOriginal, Type.Missing, Type.Missing, Type.Missing);
                vWsNormalized.Name = vNormalizedSheetName;
            }
            else
            {
                vWsNormalized = vWorkbook.Worksheets[vNormalizedSheetName];
            }
            vWsNormalized.UsedRange.ClearContents();

            long vTotalColumns = 1;
            long vRowCounter = 1;
            Excel.Range vWsRange = vWsOriginal.Cells[vRowCounter, vTotalColumns];

            List<string> vHeaders = new List<string>();
            while (vWsRange.Value2 != null)
            {
                vHeaders.Add(vWsRange.Value2.ToString());
                vTotalColumns = vTotalColumns + 1;
                vWsRange = vWsOriginal.Cells[vRowCounter, vTotalColumns];
            }

            // Insert the headers
            for (int vHeaderCol = 1; vHeaderCol < aColOffSet; vHeaderCol++)
            {
                vWsNormalized.Cells[1, vHeaderCol].Value = vHeaders[vHeaderCol - 1];
            }
            vWsNormalized.Cells[1, aColOffSet].Value = aPivotColName;
            vWsNormalized.Cells[1, aColOffSet + 1].Value = aValueColName;

            long vNewRow = 2;
            long vValueColumns = vTotalColumns - aColOffSet;
            vRowCounter = 2;

            Excel.Range vHeaderData = vWsOriginal.Range[vWsOriginal.Cells[1, aColOffSet],
                                                        vWsOriginal.Cells[1, vTotalColumns - 1]];
            string[] vPivotValueNames = new string[vTotalColumns - aColOffSet];
            vHeaders.CopyTo(aColOffSet - 1, vPivotValueNames, 0, (int) (vTotalColumns - aColOffSet));
            while (((Excel.Range)vWsOriginal.Cells[vNewRow, 1]).Value2 != null)
            {
                Excel.Range vStaticRowData = vWsOriginal.Range[vWsOriginal.Cells[vNewRow, 1],
                                                                   vWsOriginal.Cells[vNewRow, aColOffSet - 1]];

                Excel.Range vDynamicRowData = vWsOriginal.Range[vWsOriginal.Cells[vNewRow, aColOffSet],
                                                                   vWsOriginal.Cells[vNewRow, vTotalColumns - 1]];

                long vDestRowStart = vRowCounter;
                long vDestRowEnd = (vRowCounter + vValueColumns) - 1;
                Excel.Range vNormalizedStaticRowData = vWsNormalized.Range[vWsNormalized.Cells[vDestRowStart, 1],
                                                                    vWsNormalized.Cells[vDestRowEnd, aColOffSet - 1]];
                Excel.Range vNormalizedPivotValueRowData = vWsNormalized.Range[vWsNormalized.Cells[vDestRowStart, aColOffSet],
                                                                    vWsNormalized.Cells[vDestRowEnd, aColOffSet]];

                Excel.Range vNormalizedValueRowData = vWsNormalized.Range[vWsNormalized.Cells[vDestRowStart, aColOffSet + 1],
                                                                    vWsNormalized.Cells[vDestRowEnd, aColOffSet + 1]];
                vNormalizedStaticRowData.Value = vStaticRowData.Value;
                vNormalizedPivotValueRowData.Value = vExcel.WorksheetFunction.Transpose(vHeaderData.Value);
                vNormalizedValueRowData.Value = vExcel.WorksheetFunction.Transpose(vDynamicRowData.Value);

                vNewRow = vNewRow + 1;
                vRowCounter = vRowCounter + vValueColumns;
            }
        }
        finally
        {
            vWorkbook.Close(Excel.XlSaveAction.xlSaveChanges, Type.Missing, Type.Missing);
            Marshal.FinalReleaseComObject(vWsNormalized);
            Marshal.FinalReleaseComObject(vWsOriginal);
            Marshal.FinalReleaseComObject(vWorkbook);
            vExcel.Quit();
            Marshal.FinalReleaseComObject(vExcel);
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-31T23:27:34.440

我最近不得不做类似的事情，并使用数据透视表向导找到了这个技巧：[http ://www.launchexcel.com/pivot-table-flatten-crosstab/](http://www.launchexcel.com/pivot-table-flatten-crosstab/)

# mobile - 分析到前端或后端

> ID：12041127
> 
> 赞同：5
> 
> 时间：2012-08-20T16:02:34.607
> 
> 标签：mobile, cordova, analytics

我正在创建一个带有 phonegap（BB/iPhone 平台）的移动应用程序，其后端将数据作为 json 提供，我想向它添加一个分析。应该将其添加到前端应用程序还是后端？最好的方法是什么？

# vbscript - 从具有变量名的文件中读取数据 - VBScript

> ID：12041128
> 
> 赞同：0
> 
> 时间：2012-08-20T16:02:38.810
> 
> 标签：vbscript

我正在尝试使用 VBScript 计算文本文件中的行数。对于具有固定名称的文本文件，我已经成功地做到了这一点。EG: "C:\Orig\sample.txt" 但是，我们的文件名每天都在变化，EG: "C:\Orig\sample* *todaysdate* *.txt"

我一直在寻找一种“读取”具有变量名的文件的方法并且没有运气。

到目前为止，我所拥有的固定文件名是：

```
Dim oFso, oReg, sData, lCount, linesum 
Const ForReading = 1, sPath = "C:\Orig\sample.txt" 
Set oReg = New RegExp 
Set oFso = CreateObject("Scripting.FileSystemObject") 
sData = oFso.OpenTextFile(sPath, ForReading).ReadAll 
With oReg 
    .Global = True 
    .Pattern = "\r\n" 'vbCrLf 
    lCount = .Execute(sData).Count + 1

End With 
WScript.Echo("The total number of lines including the header is " & lCount) 
Set oFso = Nothing 
Set oReg = Nothing 
```

这工作得很好，但我只是找不到变量文件名的正确语法。

如果有任何帮助，我要查询的文件将是包含文件夹中的唯一文件。

有人可以提供任何帮助吗？非常感谢。

* * *

我现在尝试了以下方法：

```
Dim objFso, objReg, sData, lCount 
Const ForReading = 1 
sPath = "C:\Orig" 

Set objFso = CreateObject("Scripting.FileSystemObject")  
Set objFolder = objFso.GetFolder(sPath) 
For Each objFile in objFolder.Files 
    Set objReg = New RegExp  
    sData = objFso.OpenTextFile(sPath, ForReading).ReadAll
    With objReg  
        .Global = True  
        .Pattern = "\r\n" 'vbCrLf  
        lCount = .Execute(sData).Count + 1 

    End With  
    WScript.Echo("The total number of lines including the header is " & lCount)  
    Set objFso = Nothing  
    Set objReg = Nothing
    Set objFolder = Nothing
    set sData = Nothing
Next 
```

但在第 9 行，我收到“权限被拒绝”错误。我已经检查了文件夹权限和文件权限，并且我拥有完整的权限。

有人有什么想法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T17:00:28.143

而是循环浏览文件夹中的文件。无需直接命名文件。

```
Dim oFso, oReg, sData, lCount, linesum 
Const ForReading = 1
sPath = "C:\Orig\sample\"

Set oFso = CreateObject("Scripting.FileSystemObject") 
Set objFolder = objFso.GetFolder(sPath)
For Each objFile in objFolder.Files
    Set oReg = New RegExp 
    sData = oFso.OpenTextFile(sPath, ForReading).ReadAll 
    With oReg 
        .Global = True 
        .Pattern = "\r\n" 'vbCrLf 
        lCount = .Execute(sData).Count + 1

    End With 
    WScript.Echo("The total number of lines including the header is " & lCount) 
    Set oFso = Nothing 
    Set oReg = Nothing
Next 
```

# c# - 通过带有 XML 的 JavaScript 的 WCF 服务 - 数组参数

> ID：12041130
> 
> 赞同：0
> 
> 时间：2012-08-20T16:02:54.577
> 
> 标签：c#, javascript, xml, wcf, xml-serialization

我正在使用 JavaScript 通过 XML 与 WCF 服务进行通信（我不能使用 JSON）。到目前为止，这对于公开“原始”数据类型参数的 WCF 方法一直运行良好，但现在我需要调用一个接受数组的 WCF 方法。我一直无法弄清楚如何正确调整我的 XML。

例如，具有两个参数的 WCF 方法接受：

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">
  <s:Body>
    <MySimpleMethod xmlns="http://tempuri.org/">
      <parameter1>value</parameter1>
      <parameter2>someOtherValue</parameter2>
    </MySimpleMethod>
  </s:Body>
</s:Envelope> 
```

我想我可以通过执行以下操作来传递一个数组（在这种情况下是字符串）：

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">
  <s:Body>
    <MyMethodWithAnArrayParameter xmlns="http://tempuri.org/">
      <arrayParameterName>value1</arrayParameterName>
      <arrayParameterName>value2</arrayParameterName>
    </MyMethodWithAnArrayParameter>
  </s:Body>
</s:Envelope> 
```

但这没有奏效。如果有人有任何见解，我将不胜感激。

谢谢。

编辑：

取得进展。达林的答案适用于原始数据类型，但我无法传递更复杂的东西，比如以下类的数组：

```
public class Address 
{
    public String Number {get; set;};
    public String City {get; set;};
    public String State {get; set;};
} 
```

我试过这个：

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">
  <s:Body>
    <TestMethod xmlns="http://tempuri.org/">
      <args xmlns:a="http://schemas.microsoft.com/2003/10/Serialization/Arrays" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
        <a:Address>
          <Number>31</Number>
          <City>Houston</City>
          <State>Texas</State>
        </a:Address>
      </args>
    </TestMethod>
  </s:Body>
</s:Envelope> 
```

该方法被调用（我可以在调试器中验证这一点），但它传递的数组是空的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T16:10:38.927

假设通过 a 公开以下方法签名`basicHttpBinding`：

```
[OperationContract]
string MyMethodWithAnArrayParameter(string[] values, string parameter2); 
```

你可以这样调用：

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">
    <s:Body>
        <MyMethodWithAnArrayParameter xmlns="http://tempuri.org/">
            <values xmlns:a="http://schemas.microsoft.com/2003/10/Serialization/Arrays" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
                <a:string>value1</a:string>
                <a:string>value2</a:string>
            </values>
            <parameter2>param2</parameter2>
        </MyMethodWithAnArrayParameter>
    </s:Body>
</s:Envelope> 
```

* * *

更新：

假设如下操作合约：

```
[OperationContract]
string TestMethod(Address[] args); 
```

请求可能如下所示

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">
    <s:Body>
        <TestMethod xmlns="http://tempuri.org/">
            <args xmlns:a="http://schemas.datacontract.org/2004/07/WcfService1" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
                <a:Address>
                    <a:City>Houston</a:City>
                    <a:Number>31</a:Number>
                    <a:State>Texas</a:State>
                </a:Address>
                <a:Address>
                    <a:City>Washington</a:City>
                    <a:Number>21</a:Number>
                    <a:State>DC</a:State>
                </a:Address>
            </args>
        </TestMethod>
    </s:Body>
</s:Envelope> 
```

# azure - 将 SignalR 应用程序部署到 WindowsAzure 时是否需要使用 ServiceBus？

> ID：12041132
> 
> 赞同：0
> 
> 时间：2012-08-20T16:03:08.337
> 
> 标签：azure, signalr, azure-web-app-service, signalr-hub

我创建了一个简单的井字游戏，这是一个在同一应用程序中调用 SignalR Hub 的 Web 应用程序。当部署到共享托管环境时，它很有吸引力，但是当部署到 WindowsAzure 时，集线器的响应时间非常长，有时我什至没有得到响应，直到我再次调用集线器

我想这是我对 Azure 云架构的误解；我没有运气搜索过这个问题；我发现也许我应该将 ServiceBus Queue 与 Worker 和 Web 角色一起使用，但这意味着我的应用程序的所有行为都将更改为调用控制器（它将通过服务总线队列调用工作者角色）而不是调用集线器直接从我的角度来获得实时体验

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T20:18:53.210

您使用的是什么 Azure 服务，云服务（Web/Worker），Azure 网站（WAWS）？

网站存在一个已知的 SignalR 错误：[https ://github.com/SignalR/SignalR/issues/510](https://github.com/SignalR/SignalR/issues/510)

您现在可以通过使用 longpolling 来解决这个问题。@dowler 可能能够更好地帮助你..

# common-lisp - 为什么符号宏会获得同名的周围 let 绑定的类型？

> ID：12041136
> 
> 赞同：4
> 
> 时间：2012-08-20T16:03:19.363
> 
> 标签：common-lisp, sbcl

SBCL 中的 Macroexpand-all 给了我以下扩展：

```
(SB-CLTL2:MACROEXPAND-ALL
 '(LAMBDA (A B)
   (DECLARE ((SIGNED-BYTE 4) A))
   (+ A B
    (SYMBOL-MACROLET ((A 1) (B 2))
      (+ A
         B)))))    
=>
(LAMBDA (A B)
  (DECLARE ((SIGNED-BYTE 4) A))
  (+ A B
     (SYMBOL-MACROLET ((A 1) (B 2))
       (+ (THE (SIGNED-BYTE 4) 1)
          2)))) 
```

为什么`A`要扩展到`(THE (SIGNED-BYTE 4) 1)`而不只是`1`？

我知道这来自`(DECLARE ((SIGNED-BYTE 4) A))`，但这会影响`SYMBOL-MACROLET`吗？

扩展到不是 a 的东西甚至不应该是有效的`(SIGNED-BYTE 4)`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T20:58:11.017

***免责声明*****我不知道这是否真的回答了这个问题。欢迎评论和编辑。**

## 一个开放的问题

正如 Dirk 在评论中所说，在 Common Lisp 语言中说（专用于`declare`表单的部分（[链接](http://www.cs.cmu.edu/Groups/AI/html/cltl/clm/node104.html#SECTION001310000000000000000)））：

> 有一些特殊的方面`symbol-macrolet`。[..] 定义名称的类型声明`by symbol-macrolet`实际上等同于将`the`提及该类型的表单包装在已定义符号的扩展周围。

据我所知，这个问题有些争议，例如**它似乎是一个未解决的问题**。**是强制的还是不强制的？** 在这里阅读：

[发布 SYMBOL-MACROLET-TYPE-DECLARATION 说明](http://www.lispworks.com/documentation/lw51/CLHS/Issues/iss339_w.htm)

> [..] 如果存在适用于扩展符号宏的类型声明，则 MACROEXPAND 或 MACROEXPAND-1 返回的值是否必须（或可能）包含 THE 形式？

有四个提议，**YES**、**NO**、**MAYBE**和**PROBABLY**。在我上面链接的文章中阅读它们。这四个提案中的每一个都有一个基本原理。

**SBCL 这样做。我认为这是实施者的选择。**

为什么？好吧，**YES**的理由给出了一个理由。

* * *

## 有一些优点（？）

例如，对于编译器来说，代码的优化可能更“容易”一些。检查这个。

## 没有声明，没有`the`在扩展中：

拿着这个：

```
(SB-CLTL2:MACROEXPAND-ALL
          '(LAMBDA (A B)
            (+ A B
             (SYMBOL-MACROLET ((A 1) (B 2))
               (+ A B))))) 
```

结果很简单：

```
(LAMBDA (A B)
  (+ A B
     (SYMBOL-MACROLET ((A 1) (B 2))
       (+ 1 2)))) 
```

如果你把后者放在一个你非常想优化的文件中，可以这样说：

```
(declaim (optimize (speed 3) (debug 0) (safety 0))) 
```

然后你编译它，SBCL 会给你一堆这样的警告：

```
; note: forced to do GENERIC-+ (cost 10)
;       unable to do inline fixnum arithmetic (cost 1) because:
;       The first argument is a NUMBER, not a FIXNUM.
;       The result is a (VALUES NUMBER &OPTIONAL), not a (VALUES FIXNUM &REST T).
;       unable to do inline fixnum arithmetic (cost 2) because:
;       The first argument is a NUMBER, not a FIXNUM.
;       The result is a (VALUES NUMBER &OPTIONAL), not a (VALUES FIXNUM &REST T).
;       etc. 
```

## 通过声明，SBCL`the`进行了扩展：

现在试试这个：

```
(SB-CLTL2:MACROEXPAND-ALL
          '(LAMBDA (A B)
            (DECLARE ((SIGNED-BYTE 4) A))
            (declare ((signed-byte 4) B))
            (+ A B
             (SYMBOL-MACROLET ((A 1) (B 2))
               (+ A B))))) 
```

这是扩展：

```
(LAMBDA (A B)
  (DECLARE ((SIGNED-BYTE 4) A))
  (DECLARE ((SIGNED-BYTE 4) B))
  (+ A B
     (SYMBOL-MACROLET ((A 1) (B 2))
       (+ (THE (SIGNED-BYTE 4) 1) (THE (SIGNED-BYTE 4) 2))))) 
```

将后者放在一个文件中，放入声明进行优化，编译。你猜怎么着？没有警告。SBCL 不再抱怨无法对您的代码进行一些核心优化。它可以做到。因为`(THE (SIGNED-BYTE 4) 1)`部分。

[更多关于`the special form`](http://www.cs.cmu.edu/Groups/AI/html/cltl/clm/node106.html#SECTION001330000000000000000)

因此，也许**这是一种确保您的类型声明也会影响宏形式中的变量，提供类型检查并强制编译器优化代码的能力的方法？**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T12:38:17.233

在 Common Lisp`let`和`symbol-macrolet`影子词法绑定中，这`(declare ((signed-byte 4) a))`是一个绑定声明，所以如果 SBCL 正在做的是将声明传播到影子绑定，这是一个错误。

这个例子可能会更清楚（不是一个好的做法，但它可以达到目的）：

```
(let ((a 1))
  (declare (type fixnum a))
  (let ((a "1"))
    a)) 
```

第二个`a`绑定遮住了第一个，因此第一个在第二个范围内变得不可访问。

第二个`a`没有任何类型声明，也不应该从以前的同名词法绑定中继承任何内容。词法绑定的类型声明应该只应用于该特定绑定，无论其名称如何。

因此，输出形式不`macroexpand-all`应该包含`the`对第二个的访问`a`，至少一个显然来自第一个绑定。也就是说，编译器可能足够聪明，可以看到第二个`a`始终是字符串，因此它可能将其声明为字符串。

以下示例仅使用`let`和来练习阴影`symbol-macrolet`：

```
(let ((a 1))
  (declare (type fixnum a))
  (symbol-macrolet ((a "1"))
    a))

(symbol-macrolet ((a 1))
  (declare (type fixnum a))
  (let ((a "1"))
    a))

(symbol-macrolet ((a 1))
  (declare (type fixnum a))
  (symbol-macrolet ((a "1"))
    a)) 
```

# bash - 在 bash 脚本中使用变量进行循环

> ID：12041137
> 
> 赞同：0
> 
> 时间：2012-08-20T16:03:22.990
> 
> 标签：bash, for-loop, awk

我的文件夹中有一个包含 .pdf 数量的文件。我将此数字分配给一个变量，`fileNum`如下所示：

> `fileNum=$(ls -l *.pdf | wc -l)`

`echo $fileNum`返回这个数字没有任何问题。现在我需要`fileNum`在 for 循环中使用，但我遇到了问题。

我的 for 循环是：

> ```
> for i in {1..$fileNum}
> do
>  var=$(awk 'NR=='$i 'pdfs.file')
> 
>  gs \
>  -sOutputFile="exgs_"$var \
>  -sDEVICE=pdfwrite \
>  -sColorConversionStrategy=Gray \
>  -dProcessColorModel=/DeviceGray \
>  -dCompatibilityLevel=1.4 \
>  -dNOPAUSE \
>  -dBATCH \
> $var
> 
> done 
> ```

的`$`开头`fileNum`给了我一条错误消息：

> awk：第 1 行：在 { 或附近出现语法错误

当我实际使用数字本身（在本例中为 17）时，一切都很好。显然，`awk`不喜欢这样是因为……某事……我不知道是什么。我该怎么办？

我尝试了其他形式，例如`$(fileNum)`并`filenum`在其周围加上单引号。它与字符串有关吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T16:56:06.207

我会使用 bash 来读取文件，而不是为每一行运行 awk。

```
while read -r file; do
    gs -sOutputFile="exgs_$file" \
       -sDEVICE=pdfwrite \
       -sColorConversionStrategy=Gray \
       -dProcessColorModel=/DeviceGray \
       -dCompatibilityLevel=1.4 \
       -dNOPAUSE \
       -dBATCH \
       "$file"
done < pdfs.file 
```

另请参阅[http://mywiki.wooledge.org/BashFAQ/001](http://mywiki.wooledge.org/BashFAQ/001)

否则，对于您想要从 1 迭代到*n*的一般情况，我会使用 C 风格的 for 循环。

```
n=10
for (( i=1; i <= n; i++)); do
   ...
done 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T16:10:27.147

这是因为 Bash 会在变量之前的大括号上进行扩展。在这种情况下，您需要使用 eval 以便 Bash 首先扩展变量。

```
for i in $(eval echo {1..$fileNum})
do
 var=$(awk 'NR=='$i 'pdfs.file')

 gs \
 -sOutputFile="exgs_"$var \
 -sDEVICE=pdfwrite \
 -sColorConversionStrategy=Gray \
 -dProcessColorModel=/DeviceGray \
 -dCompatibilityLevel=1.4 \
 -dNOPAUSE \
 -dBATCH \
$var

done 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T16:11:00.330

我宁愿写：

```
for i in $(seq $fileNum)
do
  ....
done 
```

# ios - iOS 看似相同但行为不同的字符串

> ID：12041145
> 
> 赞同：0
> 
> 时间：2012-08-20T16:04:09.817
> 
> 标签：ios, audio, wave

我将 WAV 文件名存储在一个数组中，包括扩展名。当我尝试加载它时，它需要删除扩展。如果我对扩展进行子串化，它会异常终止，而看似相同的字符串在硬编码时可以正常工作。

我也尝试使用**stringByDeletingPathExtension**方法，但同样崩溃。

**此代码导致崩溃**

```
NSString *fileName = [[currentWord.audioFile componentsSeparatedByString:@"."] objectAtIndex: 0];
SFCLog(@"fileName: %@",fileName);
NSString *path = [[NSBundle mainBundle] pathForResource:fileName ofType:@"wav"];
CFURLRef BaseURL = (__bridge CFURLRef)[NSURL fileURLWithPath:path];

-[ViewController loadWord] [line 143] fileName:  owe_fr
2012-08-20 17:50:21.561 Hello[8053:16a03] *** Terminating app due to uncaught exception     'NSInvalidArgumentException', reason: '*** -[NSURL initFileURLWithPath:]: nil string   parameter' 
```

**但是这段代码执行**

```
NSString *fileName = @"owe_fr";
SFCLog(@"fileName: %@",fileName);
NSString *path = [[NSBundle mainBundle] pathForResource:fileName ofType:@"wav"];    
CFURLRef fluentBaseURL = (__bridge CFURLRef)[NSURL fileURLWithPath:path]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T16:15:41.387

好的，我找到了。存储文件名版本中的前导空格 - 您可以在日志语句中看到它。我通过这样的记录找到了它（字符串两侧的标记）：

```
SFCLog(@"fileName :%@:",fileName); 
```

其中记录为：

```
-[ViewController loadWord] [line 144] fileName : about_fr: 
```

干杯，肖恩

# css - 无法理解我的简单 img 类有什么问题

> ID：12041151
> 
> 赞同：0
> 
> 时间：2012-08-20T16:04:22.640
> 
> 标签：css

我要做的就是将边框半径应用于图像。这是它的css（我在另一个项目中有非常相似的css，它工作得很好）。

```
.testimonial-pic img {
width:48px; 
height:48px;
border-radius: 4px;
-moz-border-radius: 4px;
-webkit-border-radius: 4px;
}​ 
```

我想，也许 html 中有一些东西继承导致它失败，但也无法立即发现任何明显的东西。

```
<blockquote class="testimonial">
<p>You don’t need to see his identification. 
These aren’t the droids you’re looking   for. 
He can go about his business. Move along.</p>
 </blockquote>
 <div class="arrow-down"></div>
  <img class="testimonial-pic" src="carmen_villadar_thumb.jpg"   />
  <p class="testimonial-author">Obi-Wan Kenobi | <span>Jedi Master</span></p> 
```

我试图更改应用 css 的顺序。我还检查了我周围的 css 并且看不到任何应该冲突的东西，特别是考虑到我没有将任何 css 应用于任何其他图像属性的事实，我还命名了一个独立的类，所以不明白为什么这不是或不应该工作。

这是实时页面的链接，以防万一：[https ://dl.dropbox.com/u/3417415/testimonials/carmen_villadar.html](https://dl.dropbox.com/u/3417415/testimonials/carmen_villadar.html)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T16:05:58.523

您的规则应适用于`img.testimonial-pic`. 您当前正在将该规则应用于具有 class 的元素内的图像`.testimonial-pic`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T16:07:53.657

改变你`css`的

```
.testimonial-pic img {} 
```

到

```
.testimonial-pic {} 
```

你`img`有一个类，所以将另一个 img 附加到你的类是针对错误的元素

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T16:07:35.197

`.testimonial-pic img`指定您正在寻找具有`testimonial-pic`包含图像的类的容器。在您的 HTML 中，您有`<img class="testimonial-pic" src="carmen_villadar_thumb.jpg" />`一个带有 class 的图像`testimonial-pic`。您要么需要包装图像或将您的 css 更改为

```
img.testimonial-pic {
width:48px; 
height:48px;
border-radius: 4px;
-moz-border-radius: 4px;
-webkit-border-radius: 4px;
}​ 
```

# python - 在python中实现**kwargs构造

> ID：12041157
> 
> 赞同：2
> 
> 时间：2012-08-20T16:05:07.027
> 
> 标签：python

我在 python 中实现了一个当前继承自 dict 的类，但实际上，我不希望它这样做。继承的主要原因是我可以使用 **kwargs 构造将内容复制到参数列表中。

我认为 python 对字典进行了某种迭代，但我找不到任何文档。

这可能吗？如果可以，怎么做？

代码示例只是为了让事情更清楚：

```
 class MyThing():
       def __init__(self):
            self.dictionary = {}

   thing = MyThing()
   # code that causes thing.dictionary to be populated
   somefunc(**thing) 
```

结果是：

```
TypeError: somefunc() argument after ** must be a mapping, not instance 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-20T16:31:10.043

我去看了python源码，好像用`keys()`and`__getitem__`方法

```
class A:
    def __init__(self, data):
        self.data = data
    def keys(self):
        return self.data.keys()
    def __getitem__(self, key):
        return self.data[key]

def f(alpha):
    print alpha

f(**A({'alpha': 2})) 
```

出于好奇，如果您在非字典上使用 **，CPython 会创建一个新的空字典，然后调用`dict.update()`将对象的键复制到字典中。

它可能最好将其作为一个子类来实现`collections.Mapping`

```
class A(Mapping):
    def __init__(self, data):
        self.data = data

    def __iter__(self):
        return iter(self.data)

    def __len__(self):
        return len(self.data)

    def __getitem__(self, key):
        return self.data[key] 
```

由于继承自 Mapping，几乎所有 dict 方法都受支持。鉴于错误消息，我认为您可以争辩说这应该符合所有 python 实现。

我试过 PyPy，它接受第一个版本。

# c++ - 将多态参数限制为特定子集？

> ID：12041161
> 
> 赞同：0
> 
> 时间：2012-08-17T17:23:10.307
> 
> 标签：c++, polymorphism

我有一个抽象形状类，它有十个具体的孩子（点、线、三角形、矩形、弧、扇形、圆形、椭圆、样条线、多边形）。我想将碰撞形状添加到我的物理引擎中，但只允许使用点、矩形和圆形。可能还有线和/或三角形，如果我能让它们工作的话。

这是否可能不使用重载方法（包括模板专业化）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-17T18:04:33.413

在这种情况下，您需要另一个类（或其他语言的接口），例如 CollisionShape，Point、Rectangle 和 Circle 派生自/实现，而其他类则不需要。物理引擎会接受从 CollisionShape 派生的类，而不是 Shape。

# python - 如何均匀设置有限数量的标签matplotlib python

> ID：12041166
> 
> 赞同：2
> 
> 时间：2012-08-20T16:05:37.717
> 
> 标签：python, matplotlib

![在此处输入图像描述](../Images/098bbbac1e3acd2ba4e108f8539a728a.png)

我有一个这样的图表，它记录了 21 天的每小时数据，标签如下：01-30 00:00, 01-30 01:00 ....现在它们不可读，所以我只想设置一个每天的标签，所以只显示每天的第一个标签：01-30 00:00、01-31 00:00 等

我的代码是：

```
fig1 = plt.figure()  
ax = fig1.add_subplot(111)
ind = np.arange(len(timelist))
ax.bar(ind,reqlist,color='b')
ax.set_xlim((0,len(timelist)))
ax.set_ylabel('Number of request/video',size='x-large')
ax.set_title('Request per hour North',size='xx-large')
ax.set_xticks(ind)
ax.set_xticklabels(timelist,rotation=17) 
```

timelist 是一个字符串列表：["01-30 00:00", "01-30 00:01".....]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T16:43:20.910

您可以尝试仅提供您想要的标签，并为其余的提供一个空字符串。
例如，如果您每 24 天（一天）只需要一个标签：

```
newlist = []
for index, item in enumerate(timelist):
    if index % 24 == 0:
        newlist.append(item)
    else:
        newlist.append('')
ax.set_xticklabels(newlist, rotation=17) 
```

# sql-server-2008 - 返回具有唯一列的行的存储过程

> ID：12041167
> 
> 赞同：1
> 
> 时间：2012-08-20T16:05:43.607
> 
> 标签：sql-server-2008

我有一个包含以下列的 SQL Server 2008 表：

```
ID = uniqueidentifier
EntryID = uniqueidentifier
EntryType = nvarchar(128) 
```

在此表中，某些行可能具有相同的`EntryType`值。我想要做的是运行一个查询，它将返回该`EntryType`字段唯一的行。我想到这样做的唯一方法是按此字段分组，然后检查只有一个条目的组。以下是一些示例数据：

```
11C5AEEB-6435-489D-B353-6E8D63FCD1AD, 46F95579-0AB6-4EAC-927C-7259C2F1E046, Ford
01DBC8EE-78E4-4544-A816-87086BD45DDE, EBB689E3-1379-4E22-98B2-C6BD8EBB0F9D, VW
E948C6D2-0E6E-4AC7-9799-83C5EB180219, 46F95579-0AB6-4EAC-927C-7259C2F1E046, Ford
E70806DC-9D43-4341-AEF8-4252612AF00B, 3A3D2602-DB92-412B-AA4E-8FA70438A00A, Ford
D4460A15-2C4B-475E-B5D9-82C625C10DF7, 3EA31E10-4941-46D3-B241-B091259A2AF4, Lexus 
```

我想运行一个存储过程，当应用于上述数据时，它将只返回`VW`条目，因为该`EntryType`列是唯一的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T16:57:26.580

```
;WITH x AS 
(
  -- first, identify rows where only one EntryType exists:
  SELECT EntryType FROM dbo.table_name
  GROUP BY EntryType HAVING COUNT(*) = 1
)
-- now join to that from the main table:
SELECT t.ID, t.EntryID, t.EntryType
  FROM dbo.table_name AS t
  INNER JOIN x 
  ON x.EntryType = t.EntryType; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T05:29:35.783

在 SQL Server 2008 中，您可以将[count()](http://msdn.microsoft.com/en-us/library/ms175997%28v=sql.100%29.aspx)与[over()](http://msdn.microsoft.com/en-us/library/ms189461%28v=sql.100%29.aspx)一起使用。

```
select T.ID, T.EntryID, T.EntryType
from
  (
  select ID, EntryID, EntryType,
         count(*) over(partition by EntryType) as C
  from YourTable
  ) as T
where T.C = 1 
```

[SQL小提琴](http://sqlfiddle.com/#!3/f20df/3/0)

派生表会给你

```
ID          EntryID     EntryType  C
--------    --------    ---------  --
11C5AEEB..  46F95579..  Ford       3
E948C6D2..  46F95579..  Ford       3
E70806DC..  3A3D2602..  Ford       3
D4460A15..  3EA31E10..  Lexus      1
01DBC8EE..  EBB689E3..  VW         1 
```

主查询选择计数`C`为 1 的行。

# directx - 我可以在不使用 cbuffer 的情况下从着色器访问设备数据吗？

> ID：12041168
> 
> 赞同：1
> 
> 时间：2012-08-20T16:05:46.917
> 
> 标签：directx, hlsl

有没有办法从着色器访问数据，例如当前分辨率，而无需专门传递它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:22:31.840

渲染目标的分辨率不可用，您需要显式传递它。

输入纹理的分辨率在 DirectX 10+ 中，您可以使用 GetDimensions

[http://msdn.microsoft.com/en-us/library/windows/desktop/bb509693(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/bb509693(v=vs.85).aspx)

# c++ - 你如何让一个函数“感知大小”它的参数？

> ID：12041169
> 
> 赞同：2
> 
> 时间：2012-08-20T16:05:51.363
> 
> 标签：c++

从这里：[https ://stackoverflow.com/a/3473454/499125](https://stackoverflow.com/a/3473454/499125)

```
int ( &fillarr( int (&arr)[5] ) )[5] { // no decay; argument must be size 5
    return arr;
} 
```

上面的定义可以强制编译器意识到它的参数的大小。这句话对我来说似乎很复杂。有人可以对此声明进行剖析或解释该声明是如何实现尺寸意识的吗？

这可以扩展为处理多个参数吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-20T16:15:56.217

这一切都归结为能够阅读声明。一个更简单的写完全相同的方法是：

```
typedef int int5[5]; // create a typedef
int5& fillarr( int5& ) {
} 
```

至于阅读原始声明的确切方式，只需将其分成几部分：

```
int (&fillarr( int (&arr)[5] ))[ 5 ];
               ^^^^^^^^^^^^^           // A: reference to array of 5 int
^^^^^^                        ^^^^^^   // B: reference to array of 5 int
      ^^^^^^^^               ^         // C: function taking A and returning B 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T16:16:18.397

您可以将其理解为两部分，1）返回值和 2）参数类型：

```
int ( &fillarr() )[5] {
  static int arr[5];
  return arr;
} 
```

我们可以看一下类型：`int (&fillarr())[5]`. 为了理解这一点，不幸的是，旧的 C 规则：“声明就像表达式中的用法”不适用于引用，所以让我们看一下类似的声明：

```
int (*fillarr())[5]; 
```

这是一个返回*指针*而不是对大小为 5 的数组的*引用*的函数。我如何计算？好吧，假设我们确实有一个函数`f`返回一个指向整数数组的指针，我们将如何访问第五个元素？让我们看看，我们首先要调用函数：`f()`。然后我们必须取消引用结果`*f()`，然后访问第五个元素（它不存在，但忽略它）`(*f())[5]`，它是一个`int`. 这正是声明语法：

```
int x;
int (*f())[5];
x = (*f())[5];
//    ^^^-------- call f -> yields pointer to array of 5 ints
//   ^----------- dereferene the result of f -> yields array of 5 ints
//        ^^^---- access the fifth element 
```

现在您只需将 替换`*`为 an ，`&`因为您在示例中返回了一个引用。

参数语法的工作方式类似。

# google-app-engine - 无法在适用于 Windows 7 的 Google App Engine 启动器上部署应用程序

> ID：12041171
> 
> 赞同：0
> 
> 时间：2012-08-20T16:06:02.627
> 
> 标签：google-app-engine

我在使用适用于 Windows 7 的 Google App Engine Launcher 部署我的 Hello World 应用程序时遇到了一个奇怪的问题

能够运行它，`http://localhost:8080/`但问题是：
1\. 每当单击“部署”按钮时，弹出框很小，无法调整大小。我无法查看“确定”和“取消”按钮
2\. 我无法在我的 __.appspot.com 上成功部署 Hello World 应用程序
3\. 输入电子邮件和密码并单击“确定”后，没有部署（日志）屏幕弹出

我试过ffg。已经：
1\. 在我的计算机上为 Python 添加了 Path 环境变量
2\. 转到 GAE 启动器 >> 首选项 >> 将 Python 路径设置为 C:\Python27\pythonw.exe 并将 App Engine SDK 设置为 C:\Program Files\Google\google_appengine

谢谢，米奇

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T22:38:26.677

您还可以使用 DOS 脚本来部署您的应用程序： [https ://developers.google.com/appengine/docs/python/tools/uploadinganapp](https://developers.google.com/appengine/docs/python/tools/uploadinganapp)

# javascript - 如何在 JavaScript 的可排序表中为特殊字符赋予最高值

> ID：12041173
> 
> 赞同：0
> 
> 时间：2012-08-20T16:06:06.947
> 
> 标签：javascript, regex, sorting, special-characters

在我的可排序表中，我`null`通过一系列`if/else`语句将 s 排序到底部，将数字解析为整数，将字符串小写。

我试图让带有特殊字符的字符串在顶部排序。

*   如果我给它一个数字值，它将进入数字循环并进行解析。

*   如果我给它一个`null`值，它将进入`null`循环。

我该怎么办？

```
$('#column1').click(function(e) {

    String.prototype.trim = function()
    {
    return this.replace(/^\s+|\s+$/g,"");
    }

    String.prototype.ltrim = function() 
    {
    return this.replace(/^\s+/,"");
    }

    String.prototype.rtrim = function()
    {
    return this.replace(/\s+$/,"");
    }
    var specChar = /[a-zA-Z1-9]/;
    var $sort = this;
    var $table = $('#sort-table');
    var $rows = $('tbody > tr',$table); 

    if($($sort).attr('class')== 'asc'){

        $rows.sort(function(a, b){
        var keyA = (($('td:eq(0)',a).text()).toLowerCase()).trim();
        var keyB = (($('td:eq(0)',b).text()).toLowerCase()).trim();

            if(!isNaN(keyA) || !isNaN(keyB) )
            {               
                if(keyA.length <1 || keyB.length < 1)
                    {
                        if(keyA.length <1  && keyB.length >1)
                            {
                            keyA = "zzzzzzzzzzzzzzz";
                            }
                        else if(keyB.length <1  && keyA.length >1)
                        {
                            keyB = "zzzzzzzzzzzzzzz";
                        }

                        else
                        {
                            keyA="zzzzzzzzzzzzzzz";
                            keyB="zzzzzzzzzzzzzzz";
                        }
                    }
                else
                {
                    if(!isNaN(keyA) && isNaN(keyB))
                    {
                        keyA= parseInt(($('td:eq(0)',a).text()));
                    }

                    else if(!isNaN(keyB)&& isNaN(keyA))
                    {
                        keyB= parseInt(($('td:eq(0)',b).text()));
                    }

                    else
                    {
                        keyA= parseInt(($('td:eq(0)',a).text()));
                        keyB= parseInt(($('td:eq(0)',b).text()));
                    }

                }
            }
            else if ( specChar.test[keyA] == true || specChar.test[keyB] == true)
            {
                console.log("this worked " + keyA + " " + keyB)
                if(specChar.test[keyA] == true && specChar.test[keyB] == false)
                {
                    keyA = null;
                }
                else if(specChar.test[keyB] == false && specChar.test[keyA] == false)
                {
                    keyB = null;
                }
                else
                {
                    keyA = null;
                    keyB = null;
                }
            }
            else
            {
            }
            $($sort).attr('class', 'desc');
            return (keyA < keyB) ? 1 : -1;

        }); 

    $.each($rows, function(index, row){
    $table.append(row);
    $("tr:even").css("background-color", "#FF004D");
    $("tr:odd").css("background-color", "#FFDD00"); 

    }); 

    } 

    else {
            $rows.sort(function(a, b){
                var keyA = (($('td:eq(0)',a).text()).toLowerCase()).trim();
                var keyB = (($('td:eq(0)',b).text()).toLowerCase()).trim();
                if(!isNaN(keyA) || !isNaN(keyB) )
                {                   
                    if(keyA.length <1 || keyB.length < 1)
                        {
                            if(keyA.length <1  && keyB.length >1)
                                {
                                keyA= "zzzzzzzzzzzzzzz"
                                }
                            else if(keyB.length <1  && keyA.length >1)
                            {
                                keyB= "zzzzzzzzzzzzzzz"
                            }

                            else    
                            {
                                keyA= "zzzzzzzzzzzzzzz"
                                keyB= "zzzzzzzzzzzzzzz"
                            }
                        }
                    else
                    {
                        if(!isNaN(keyA) && isNaN(keyB))
                        {
                            keyA= parseInt(($('td:eq(0)',a).text()));
                        }

                        else if(!isNaN(keyB)&& isNaN(keyA))
                        {
                            keyB= parseInt(($('td:eq(0)',b).text()));
                        }

                        else
                        {
                            keyA= parseInt(($('td:eq(0)',a).text()));
                            keyB= parseInt(($('td:eq(0)',b).text()));
                        }

                    }
                }
            else if ( specChar.test(keyA) == false || specChar.test(keyB) == false)
            {
                console.log("this worked " + keyA + " " + keyB)
                if(specChar.test(keyA) == false)
                {
                    keyA = " ";
                }
                else if(specChar.test(keyB) == false)
                {
                    keyB = " ";
                }
                else
                {
                    keyA = " ";
                    keyB = " ";
                }
            }
                else{}

            $($sort).attr('class', 'asc');
            return (keyA > keyB) ? 1 : -1;
            });     
            $.each($rows, function(index, row){
            $table.append(row);
            $("tr:even").css("background-color", "#FF004D");
            $("tr:odd").css("background-color", "#FFDD00"); 
            });
        }

        e.preventDefault();

    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T16:38:25.637

我创建了一个对数组进行排序的[小提琴。](http://jsfiddle.net/vwWkf/4/)

**JavaScript**

```
var array = ["a", "!", "2", "", "b", "1", null, "C"],
    sortedArray;

sortedArray = array.sort(function(a, b) {
    if (a === "") return 1;
    if (b === "") return -1;
    if (a === null) return 1;

    if (typeof a === 'string') {
        a = a.toLowerCase();
    }
    if (typeof b == 'string') {
        b = b.toLowerCase();
    }

    return b < a ? 1 : -1;
});

console.log(sortedArray); // => ["!", "1", "2", "a", "b", "C", null, ""]​ 
```

您可能可以根据自己的口味进一步调整它。

# unit-testing - BDD主要用于集成测试吗？

> ID：12041175
> 
> 赞同：14
> 
> 时间：2012-08-20T16:06:15.173
> 
> 标签：unit-testing, testing, tdd, bdd

一个共同的故事

```
Story: User logging in
  As a user
  I want to login with my details
  So that I can get access to the site 
```

鉴于覆盖面如此之广，如果我为了执行测试而**模拟DB等系统组件是没有用的，那么我可以说人们主要在集成测试中使用BDD吗？**

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-21T15:11:27.343

这是我的术语。

*   **场景：**用户使用系统的示例，所有相关组件都已就位而不是模拟出来。可以自动化并用作验收测试，但业务、测试人员和开发人员之间的对话是 BDD 最重要的方面。[通常使用*Given/When/Then*模板](http://code.google.com/p/wipflash/source/browse/Example.PetShop.Scenarios/PetRegistrationAndPurchase.cs)创建，有时在允许自然语言捕获的工具中创建，例如[Cucumber](http://cukes.info/)或[JBehave](http://jbehave.org/)。

*   **集成测试：**跨越两个组件的边界，通常用于检查这些组件的集成完整性。例如，可用于在 Web 界面的客户端和服务器层之间来回发送消息，或检查与 Hibernate 的数据库绑定等。不一定涉及整个堆栈。一个场景可以被认为是一种特殊的集成测试。BDD 并不真正适用于大多数非场景集成测试，尽管您仍然可以想象使用 Given / When / Then 模板。

*   **单元测试：**使用另一个类的消费类的示例，通常将协作者模拟出来。也可能是消费类如何将工作委托给其合作者的一个例子。无论如何，这就是我们在 BDD 中谈论它的方式（您可以在两个级别上进行 BDD）。也可以[使用 Given/When/Then 语法](http://code.google.com/p/wipflash/source/browse/WiPFlash.Behavior/Framework/WaiterBehaviour.cs)。

*   **故事：**通过一个功能让我们获得更快的反馈。一个特征的行为可以用几个场景来说明，这些也可以用来帮助分割特征。通常用*As a... I want... So that...*模板或*为了... as a... I want...* [Feature Injection](http://lizkeogh.com/2010/02/02/theyre-not-user-stories/)模板来说明。

*   **功能：**功能代表用户使用我们提供给他们的功能的方式。这是我们开始定义具体实现和 UI 的阶段。特征可以是网页、网页的一部分、Windows UI 中的模块、应用程序的一部分等。

*   **能力：**用户可以通过系统实现的东西，或者系统可以实现的东西。即：用户可以*预订交易*，系统足够安全，可以*抵御黑客*。此级别的短语场景有助于它们独立于 UI 并使它们保持在业务语言中。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-20T21:49:09.470

您的示例是一个用户故事，它描述了验收测试。验收测试可以有端到端的范围，但不一定。验收测试和集成测试之间的核心区别在于它们关注的内容。验收测试以业务为中心，可由非技术人员（客户）编写/阅读。另一方面，我们有以开发为中心的集成测试，它只是验证两个或多个组件可以一起工作。

回到 BDD。它可以用于验收测试（功能级别）和单元测试（代码级别）。对于不同级别的 BDD，甚至还有不同的工具：

*   SpecFlow（验收测试）
*   NSpec，NBehave（单元测试）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-21T07:07:28.123

行为驱动开发正在考虑产品在给定场景中的行为。它扩展了测试驱动开发和领域驱动设计。BDD 也在考虑集成测试之外的问题。BDD 是关于最大化用户、开发人员、测试人员、经理和分析师之间的沟通。

集成测试被认为是 BDD 的一个步骤。集成测试也可以存在于 BDD 的上下文之外。因为集成测试可用于覆盖应用程序的高级行为，而无需进入单元测试。

行为是关于系统组件之间的交互，因此使用模拟是高级 TDD 的基础。当开发人员意识到 TDD 是关于定义行为而不是测试时，TDD 的专业知识开始显现。

用户故事可能具有广泛的范围，因为它始终是开发人性化软件的优先事项。它将极限编程的务实方法与基于宏观层面分析的足够的预先思考相结合，以实现宏观层面的规划。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-22T13:50:26.177

集成测试是我们主要使用 BDD 进行的 - 使用 Selenium 进行的 UI 测试。尽管实际上我们并没有对这些测试进行任何模拟，因为 BDD 场景用于驱动 SpecFlow 进而驱动 Selenium Webdriver 执行用户旅程，例如登录、单击菜单链接、创建记录。事实上，我正在尽我最大的努力通过 UI 尽可能地完成所有工作。

我一直在努力并与业务分析师一起以 BDD 的方式编写他们的用户故事（事实上，它现在在我们与客户的合同中），在 BDD 中编写故事的过程中发现这一点非常令人耳目一新且非常有用时尚，当我们将需求外推到原子步骤（Given、When、Then）时，我们会发现可能不会被考虑的边缘情况。当我们有一种更通用的语言来表达需求时，从业务和开发人员的角度来看，这确实是一个双赢的局面。

# magento - Magento：从产品集合中获取所有产品而忽略设定的限制？

> ID：12041177
> 
> 赞同：8
> 
> 时间：2012-08-20T16:06:16.950
> 
> 标签：magento, collections

我想遍历 Mage_Catalog_Block_Product_List_Toolbar 块中给出的产品集合中的所有产品，忽略之前由“setPageSize()”和“setCurPage()”设置的限制。我的方法如下所示：

```
/** @var Mage_Catalog_Block_Product_List_Toolbar $this */
//...
$collection = $this->getCollection();
// Remove the LIMIT and OFFSET parts from the generated SQL query:
$collection->getSelect()->reset(Zend_Db_Select::LIMIT_COUNT);
$collection->getSelect()->reset(Zend_Db_Select::LIMIT_OFFSET);
// Reload the collection using the new SQL query:
$collection->load();
foreach($collection as $product)
{
    // ...
}
// ... 
```

问题是，集合似乎没有被重新加载，所以之前设置的限制仍然存在。我在这里想念什么？收藏是否被锁定或其他什么东西让我无法更改？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-20T20:59:50.070

您在产品列表工具栏块中使用的集合，通常在之前已经加载并设置为工具栏实例`Mage_Catalog_Block_Product_List::_beforeHtml()`。

仅重置语句的计数和偏移量是不够的。

您还需要重置属性

```
Varien_Data_Collection::_isCollectionLoaded
Varien_Data_Collection::_pageSize 
```

这可以通过

```
$collection->clear();
$collection->setPageSize(false); 
```

`reset`在您的 's 和 the之间插入这些说明`load`，您应该没问题。

# unit-testing - 计算我的 scala 测试的最简单方法是什么？

> ID：12041182
> 
> 赞同：4
> 
> 时间：2012-08-20T16:06:32.897
> 
> 标签：unit-testing, scala, scalatest

我希望能够计算一个目录或其子目录中的所有 scala 测试。

我正在使用 org.scalatest。谁能建议一个快速的方法来做到这一点？来自测试源还是来自测试输出？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T16:15:49.920

根据[Scalatest main page](http://scalatest.org/)，在命令行上运行测试时应该输出测试的数量：

> $ scala -cp scalatest_2.9.0-2.0.M3.jar org.scalatest.run StackSpec
> 运行开始。预期的测试计数为：2
> StackSpec：
> A Stack
> - 应按后进先出顺序弹出值 -
> 如果弹出空堆栈，则应抛出 NoSuchElementException
> 运行在 96 毫秒内完成。
> 运行的测试总数：2

# mysql - MYSQL - 如何通过使用特定顺序然后 ASC 来订购未识别的值

> ID：12041184
> 
> 赞同：0
> 
> 时间：2012-08-20T16:06:59.193
> 
> 标签：mysql

我已经看到很多关于如何使用特定顺序而不是使用默认`ASC`或`DESC`选项进行排序的线程。但是，我在一列中有一系列值，我希望一个特定值始终位于顶部，一个特定值我希望始终位于底部，其他所有值都可以通过 ASC 排序。让我在下面提供一个通用示例。想象一下，我有一列信息，如下所示。

```
Value1 | Value5 | Value3 | Value9 | Value8 | Value7 | Value5 | Value3 | Value6 
```

注意：为了争论，请假装这是一列而不是一行信息。这个论坛上的间距更容易水平呈现。请想象这是一个垂直列表。

我想`Value5`在订单的顶部，而 Value3 在底部。这样信息行将按以下顺序返回：

```
Value5 | Value5 | Value1 | Value6 | Value7 | Value8 | Value9 | Value3 | Value3 
```

请注意，5 排在第一位，3 排在最后，其他所有内容都按这两个值之间的字母顺序返回。

我正在使用 PHP，以防对情况有任何影响。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T16:09:57.677

您需要关于`ORDER BY`查询子句的条件语句：

```
ORDER BY CASE WHEN col = 'Value5' THEN 1
              WHEN col = 'Value3' THEN 3
              ELSE 2 END ASC,
         col ASC 
```

# vbscript - 使用 vbscript 运行提升并等待命令完成

> ID：12041186
> 
> 赞同：2
> 
> 时间：2012-08-20T16:07:09.357
> 
> 标签：vbscript

我正在尝试创建一个从 Java 调用的 vbscript 来解压缩文件，然后使用解压缩的文件。我需要在提升模式下运行解压缩。当我这样做时，vbscript 在返回之前不会等待文件解压缩，并且下一个命令会在文件存在之前运行。

这是我目前正在做的事情：

爪哇：

```
public void unzipElevated( String fileName, String Target )
{
   String  unzipFile = "cscript " 
          + tmpDir.getAbsoluteFile() + File.separator + "RunElevated.vbs "
          + "UnzipFiles.vbs "    
          + fileName + " "
          + Target   + File.separator;
   ArrayList<String> lines = new ArrayList<String>();

   Process p;
   try
   {
      p = Runtime.getRuntime().exec( unzipFile );
      p.waitFor();

      InputStream s = p.getInputStream();
      Scanner     i = new Scanner( s );
      while (i.hasNextLine())
         lines.add( i.nextLine() );
   }
   catch (Exception e)
   {
   }
} 
```

vbscript: (RunElevated.vbs)

```
' Run the script in elevated mode
'
' This will be needed to install programs into Program Files
prgName      = Wscript.Arguments.Item(0)
prgArgs      = ""
If Wscript.Arguments.Count > 1 Then
   For i = 1 To Wscript.Arguments.Count - 1
      prgArgs = prgArgs & " " & Wscript.Arguments.Item(i)
   Next
End If
Set objShell = CreateObject("Shell.Application")
Set fso      = CreateObject("Scripting.FileSystemObject")
strPath      = fso.GetParentFolderName (WScript.ScriptFullName)
If fso.FileExists(strPath & "\" & prgName) Then
   prgCmd = Chr(34) & strPath & "\" & prgName & Chr(34)
   If prgArgs <> "" Then
      prgCmd = prgCmd & " " & prgArgs
   End If 
   objShell.ShellExecute "wscript.exe", prgCmd, "", "runas", 1
Else
   Wscript.Echo "Script file not found"
End If 
```

vbscript：（解压缩文件.vbs）

```
' unzip a file- for now assume that full paths will be provided
ZipFile  = Wscript.Arguments.Item(0)
Extract  = Wscript.Arguments.Item(1)
Set fso  = CreateObject("Scripting.FileSystemObject") 
If fso.FileExists( ZipFile ) Then
' If the extraction location does not exist create it.
   If NOT fso.FolderExists( Extract ) Then 
      fso.CreateFolder( Extract ) 
   End If 

' Do the extraction  
   set objShell   = CreateObject( "Shell.Application" ) 
   set FilesInZip = objShell.NameSpace( ZipFile ).items 
   objShell.NameSpace( Extract ).CopyHere  FilesInZip, 16 

   Set objShell = Nothing 
Else
   Wscript.echo "Zip file not found"
End If

Set fso      = Nothing 
```

我在 RunElevated 中使用 wscript 是因为我想查看 uzip 命令的进度框，而不是 cmd 窗口。我在 CopyHere 中使用 16 来不提示覆盖文件。

它工作得很好，除了它会在压缩开始后立即返回，这会使尝试使用解压缩的文件变得一团糟。

我找到了运行命令，它有一个等待进程完成的选项：

```
Set objShell = Wscript.CreateObject("WScript.Shell")
objShell.Run "TestScript.vbs" intWindowStyle, bWaitOnReturn 
```

我认为这将允许我（将 bWaitOnReturn 设置为 true）让 vbscript 等到调用的脚本完成，但我看不到如何使用 Run 在提升模式下运行。

我一直在寻找，但我还没有找到一种方法来运行提升并等待该过程完成。这似乎是一个非常普遍的要求（无论何时复制、解压缩等）。我是vbscript新手，要么没找到答案，要么看的时候没认出来。

一些 vbscript 大师可以在这里帮助我吗？或者，如果我的 Java 出错了，我也很乐意在那里获得帮助！

# objective-c - （空）和 ，有什么区别？

> ID：12041189
> 
> 赞同：3
> 
> 时间：2012-08-20T16:07:15.123
> 
> 标签：objective-c, ios

当我尝试显示 Dictionary 值的值时：

```
NSLog(@"%@",[self.user valueForKeyPath:@"age"]); 
```

第一次收到`(null)`，第二次收到`<null>`

两种结果之间存在哪些差异？提前谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-20T16:10:37.187

当`NSLog`输出时`(null)`，它意味着它是从字面上传入的`0x0`，或`NULL`。

当它输出时`<null>`，这意味着它被传入了`[NSNull null]`，而不是。

`NSNull``nil`'s 通常用于默认情况下无法存储的数组和其他集合。因此，改为使用特殊对象。

# php - 在 PHP 之前运行 Apache 模块

> ID：12041205
> 
> 赞同：1
> 
> 时间：2012-08-20T16:08:31.063
> 
> 标签：php, apache, apache-modules

我一直在开发一个 Apache 模块，我需要它在 PHP 之前运行。

我尝试使用以下方法注册处理程序函数：

```
// Hook the main handler function to run before PHP5
static const char * const aszPos[]={ "mod_php5.c", NULL };
ap_hook_handler(cc_handler, NULL, aszPos, APR_HOOK_FIRST); 
```

...但是页面仍然带有`<?php ?>`未解析的“ ”标签。

我想知道这是否是一个钩子问题，或者 PHP 是否没有解析它，因为它无法将其识别为 PHP url，但我尝试将其称为：

`localhost/authCC/?url=http://www.google.pt/&req=name,nic,photo,TaxNo&token=12345`

...虽然在“mods-available/php5.conf”上有正确的“LocationMatch”指令，但它仍然无法解析。

还有其他建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T16:37:21.550

假设您使用的是 2.4 - 您的 C 代码看起来不错（您使用 mod_heartbeat 作为示例？）。我怀疑PHP不会以某种方式触发，因为它认为没有理由。如果您删除模块 - 它会按您的预期启动吗？关于什么（MIME、扩展名、位置？）。而且你的模块确实被运行了（ap_log 是你的朋友）并且它不会改变/取消 mod_php 依赖的东西（例如 mime 类型）来触发？

德。

# ruby-on-rails - 如何使用 rails 在 has_many 关系上创建关联对象？

> ID：12041207
> 
> 赞同：0
> 
> 时间：2012-08-20T16:08:43.923
> 
> 标签：ruby-on-rails, save, has-many

我正在使用Rails 3.2实现一个简单的飞行预订系统但是当我想保存一个可能有很多乘客的订单时遇到问题。也就是说，他们两个是一对多的关系。这是Passenger的模型。

```
class Passenger < ActiveRecord::Base
  attr_accessible :accident_number, :cred_number, :cred_type, :delay_number, :name, :order_id
  validates :cred_type, :cred_number, :name, presence: true
  belongs_to :order, :inverse_of => :passengers
end 
```

这是订单的模型

```
class Order < ActiveRecord::Base
  attr_accessible :contact_email, :contact_name, :contact_phone, :flight_id, :print_time, :remark
  validates :contact_email, :contact_name, :contact_phone, :flight_id, :print_time, presence: true

  belongs_to :flight

  has_many :passengers, :dependent => :destroy, :inverse_of => :order
  accepts_nested_attributes_for :passengers, :allow_destroy => true
  attr_accessible :passengers_attributes, :allow_destroy => true

end 
```

参数是这样的

```
Parameters: {
"passengers"=>{"new_1"=>{"name"=>"Passenger 1", "cred_type"=>"ID card", 
"cred_number"=>"12345", "accident_number"=>"1", "delay_number"=>"1"},
"new_2"=>{"name"=>"Passenger 2", "cred_type"=>"ID card", "cred_number"=>"54321", "accident_number"=>"1", "delay_number"=>"1"}}, 
"order"=>{"contact_name"=>"Contact 1", "contact_phone"=>"123456", "contact_email"=>"test2@tset,com", "print_time"=>"1", "remark"=>""}, 
"commit"=>"Create Order"} 
```

问题是订单和乘客无法挽救。我已经尝试了一些方法，但他们无法解决它......例如

```
def create                              
  @order = Order.new(params[:order])    

  respond_to do |format|                
    if @order.save                      
      params[:passengers].each do |k, v|
        @order.passengers.create(v)     
      end 
```

先感谢您！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T17:10:45.013

我认为如果您的参数在订单哈希中包含乘客集合，您可以简单地执行以下操作来保存：

```
def create                              
  @order = Order.new(params[:order])    
  respond_to do |format|                
    if @order.save
      / something else
    end
  end
end 
```

如果您的关系设置正确，则您不需要自己保存子对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T17:16:25.960

使用accepts_nested_attributes_for 应该使用key 返回Order 参数中的乘客参数`:passengers_attributes`。

您将需要添加`:passengers_attributes`到您的`attr_accessible`通话中，并查看为什么您的表单会奇怪地格式化参数哈希。您可以发布表单的视图代码吗？

# php - json解析在textview中显示url和标题

> ID：12041210
> 
> 赞同：1
> 
> 时间：2012-08-20T16:09:20.703
> 
> 标签：php, android, json, url

我对 json / android 解析有点问题。

我正在使用 json 将数据从我的数据库解析到 android textview。

但它也显示了 url 和标题。

有没有办法隐藏它或修改代码使其不显示？

[http://www.wvvzondag2.nl/android/leesverslag.php](http://www.wvvzondag2.nl/android/leesverslag.php) {"introtext":"我的数据库值"}

我想看到它显示了我从数据库中的价值，所以没有 url 和括号。

这是我正在使用的代码。

```
package wvv.zondag.app;

import java.io.BufferedReader;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.util.ArrayList;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.HttpClient;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicNameValuePair;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import android.app.Activity;
import android.os.Bundle;
import android.text.Html;
import android.util.Log;
import android.widget.LinearLayout;
import android.widget.TextView;

public class Leesverslag extends Activity{
/** Called when the activity is first created. */

TextView txt;

public static final String KEY_121 = "http://www.wvvzondag2.nl/android/leesverslag.php"; 

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.leesverslag);
    LinearLayout mLinearlayout= (LinearLayout) findViewById(R.id.Linear);
        txt = new TextView(this);
        txt.setText("Connecting..."); 
        mLinearlayout.addView(txt);

        Runnable postRunnable = new Runnable() {

            @Override
            public void run() {
                txt.setText(Html.fromHtml(getServerData(KEY_121))); 

            }
        };
        txt.post(postRunnable);
}

private String getServerData(String returnString) {
   InputStream is = null;

   String result = "";
    //Value from last activity for database
   String titelhoofd = getIntent().getStringExtra("titelverslag");
    ArrayList<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
    nameValuePairs.add(new BasicNameValuePair("titel",titelhoofd));

    //http post
    try{
            HttpClient httpclient = new DefaultHttpClient();
            HttpPost httppost = new HttpPost(KEY_121);
            httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
            HttpResponse response = httpclient.execute(httppost);
            HttpEntity entity = response.getEntity();
            is = entity.getContent();

    }catch(Exception e){
            Log.e("log_tag", "Error in http connection "+e.toString());
    }

    //convert response to string
    try{
            BufferedReader reader = new BufferedReader(new InputStreamReader(is),8);
            StringBuilder sb = new StringBuilder();
            String line = null;
            while ((line = reader.readLine()) != null) {
                    sb.append(line + "\n");
            }
            is.close();
            result=sb.toString();
    }catch(Exception e){
            Log.e("log_tag", "Error converting result "+e.toString());
    }
    //parse json data
    try{
            JSONArray jArray = new JSONArray(result);
            for(int i=0;i<jArray.length();i++){
                    JSONObject json_data = jArray.getJSONObject(i);
                    json_data.getString("introtext");
                    //Get an output to the screen
                    returnString += jArray.getJSONObject(i); 
            }
    }catch(JSONException e){
            Log.e("log_tag", "Error parsing data "+e.toString());
    }
    return returnString; 
}    

} 
```

有谁知道如何解决这个问题？

亲切的问候，帕特里克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T10:48:39.577

创建变量

```
String strData = ""; 
```

然后使用

```
//parse json data
try{
        JSONArray jArray = new JSONArray(result);
        for(int i=0;i<jArray.length();i++){
                JSONObject json_data = jArray.getJSONObject(i);

                //Get an output to the screen
                strData += json_data.getString("introtext"); 
        }
}catch(JSONException e){
        Log.e("log_tag", "Error parsing data "+e.toString());
}
return strData ; 
```

# android - Android 支持库中的片段：getLastCustomNonConfigurationInstance/onRetainCustomNonConfigurationInstance 魔术

> ID：12041220
> 
> 赞同：1
> 
> 时间：2012-08-20T16:09:50.877
> 
> 标签：android

我有一个扩展 FragmentActivity 的简单类。我使用 getLastCustomNonConfigurationInstance/onRetainCustomNonConfigurationInstance 来保存当前状态。

```
public class MyActivity extends FragmentActivity {

    static class Saver {
        // ...
    }

    @Override
    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);

        Saver saver = (Saver) getLastCustomNonConfigurationInstance();
        if (saver != null) {
            // ...
        } 
        // ...

    }

    @Override
    public Object onRetainCustomNonConfigurationInstance() {
        Saver saver = new Saver();
        // ...
        return saver;
    }
} 
```

当我关闭此活动时，有时会遇到一个奇怪的异常，例如：

```
java.lang.ClassCastException: Saver cannot be cast to android.support.v4.app.FragmentActivity$NonConfigurationInstances

at android.support.v4.app.FragmentActivity.getLastCustomNonConfigurationInstance(FragmentActivity.java:576)
... 
```

你怎么看这个问题？提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T09:27:22.647

您需要像这样进行演员表：

```
Object saver = getLastCustomNonConfigurationInstance();
if (saver != null) {
    Saver savedObject = (Saver)saver;
} 
```

# email - 蚂蚁邮件任务日志

> ID：12041221
> 
> 赞同：0
> 
> 时间：2012-08-20T16:09:51.630
> 
> 标签：email, ant

我正在尝试运行 ant 邮件任务，并且脚本在我的 cygwin 中运行良好，但是当我将它移到 ubuntu 时，我得到：

```
BUILD FAILED
/home/admin/test/build.xml:22: mail doesn't support the "enableStartTLS" attribute 
```

然后我删除了该属性并得到：

```
[mail] Failed to initialize MIMI mail: javax/mail/MessagingException 
```

我想知道在哪里可以找到某种日志或以某种方式强制日志。有任何想法吗？这是蚂蚁任务：

```
<mail mailhost="smtp.gmail.com" user="####" password="####" enableStartTLS="true" subject="jMeter test results from nightly build.">
<from address="codeslikeamonkey@ga.com"/>
<to address="codeslikeamonkey@ga.com"/>
<message>This is an automated message containing results from the most recent discovery build.</message>
<attachments>
    <fileset dir="${basedir}">
        <include name="JMeter-Results*"/>
    </fileset>
</attachments>
</mail> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-17T04:20:00.713

您需要在 ant/lib 目录中有 activation.jar 和 javax.mail.jar 才能执行 ant 目标

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T17:28:28.037

第一条错误消息表明您在 Windows 和 Ubuntu 之间有不同版本的邮件任务。在两个系统上运行“ant -version”进行检查。

还要确保在运行 Ant 时 $JAVA_HOME 指向完整的 JDK 安装，而不仅仅是 JRE。如果您需要帮助，askubuntu.com 上有大量关于如何安装 JDK 的信息。

# asp.net - 在VS 2010中将asp.net与MS access 2007连接起来

> ID：12041223
> 
> 赞同：0
> 
> 时间：2012-08-20T16:09:55.207
> 
> 标签：asp.net, database, ms-access-2007

我在 MS Access 2007 中创建了一个学生信息小表。表名为“stdinfo”，字段为 rollno、sname、sfather、address。现在我想在 asp.net 应用程序中显示表格字段。

代码背后的代码是

```
protected void Page_Load(object sender, EventArgs e)
        {
            string ConnectionString = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:|Users|mac|Desktop|db.accdb;";
            OleDbConnection cn = new OleDbConnection(ConnectionString);
            OleDbCommand cmd = new OleDbCommand();
            cmd.CommandText = "Select * from stdinfo";
            cmd.Connection = cn;
            cn.Open();
            rolllbl.Text = Convert.ToString(cmd.ExecuteNonQuery());
            cn.Close();
        } 
```

而aspx代码是

```
<p>
        <asp:Label ID="rolllbl" runat="server" Text="RollNo."></asp:Label>
&nbsp;&nbsp;&nbsp;
    </p>
    <p>
        &nbsp;<asp:Label ID="namelbl" runat="server" Text="Name"></asp:Label>
&nbsp;</p>
    <p>
        <asp:Label ID="fnamelbl" runat="server" Text="Fname"></asp:Label>
&nbsp;&nbsp;&nbsp;
    </p>
    <p>
        <asp:Label ID="addlbl" runat="server" Text="Address"></asp:Label>
    </p> 
```

我不想在 Web 配置文件中写入连接字符串。我正在使用 VS 2010。

我需要在后面的代码中添加什么吗？代码不起作用...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T16:37:22.697

你必须改变你的代码。

```
protected void Page_Load(object sender, EventArgs e)
    {
        string ConnectionString = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:|Users|mac|Desktop|db.accdb;";
        OleDbConnection cn = new OleDbConnection(ConnectionString);
        OleDbCommand cmd = new OleDbCommand();
        cmd.CommandText = "Select * from stdinfo";
        cmd.Connection = cn;
        cn.Open();
        DataTable dt = new DataTable();
        dt.Load(cmd.ExecuteReader());  // temporary storing data in a data table
        cn.Close();

     // Now assign the values to the label
           rolllbl.Text = dt.Rows[0]["ColumnName"].ToString();
           namelbl.Text = dt.Rows[0]["ColumnName"].ToString();
           fnamelbl.Text = dt.Rows[0]["ColumnName"].ToString();
           addlbl.Text = dt.Rows[0]["ColumnName"].ToString();               

            // OR  If you query returns multiple rows then use gridview 

        gv.DataSource = dt;
        gv.DataBind();  // binding grid   

    } 
```

`ExecuteNonQuery`方法返回编号。受影响的行数，您将不会通过转换为字符串得到任何东西。你也可以使用gridview控件

```
<asp:GridView ID="gv" runat="server" >
     <Columns>
         <asp:BoundField DataField="ColumnName" TextField="Roll No" />
         <asp:BoundField DataField="ColumnName" TextField="Name" />
         <asp:BoundField DataField="ColumnName" TextField="First Name" />
         <asp:BoundField DataField="ColumnName" TextField="Address" />
     </Columns>
</asp:GridView>

Output:
Roll NO | Name | First Name | Address 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:13:32.777

```
<asp:Content ID="BodyContent" runat="server" ContentPlaceHolderID="MainContent">
    <h2>
        Welcome to ASP.NET!
    </h2>
    <p>
        To learn more about ASP.NET visit <a href="http://www.asp.net" title="ASP.NET Website">www.asp.net</a>.
    </p>
    <p>
        You can also find <a href="http://go.microsoft.com/fwlink/?LinkID=152368&amp;clcid=0x409"
            title="MSDN ASP.NET Docs">documentation on ASP.NET at MSDN</a>.
    </p>

    <p>
        <asp:GridView ID="GridView1" runat="server">
        <Columns>          
        <asp:BoundField DataField="rollno" HeaderText="Roll" />          
        <asp:BoundField DataField="sname" HeaderText="Student Name" />          
        <asp:BoundField DataField="sfather" HeaderText="Fathers Name" />          
        <asp:BoundField DataField="address" HeaderText="Address" />      
        </Columns>
        </asp:GridView>
    </p>
</asp:Content> 
```

代码隐藏：

```
protected void Page_Load(object sender, EventArgs e)
        {
            string ConnectionString = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\\Users\\mac\\Desktop\\db.accdb;"; 
            OleDbConnection cn = new OleDbConnection(ConnectionString); 
            OleDbCommand cmd = new OleDbCommand(); 
            cmd.CommandText = "Select * from stdinfo";
            cmd.CommandType = CommandType.Text;
            cmd.Connection = cn;
            cn.Open();
            OleDbDataReader reader ; 
            reader=cmd.ExecuteReader();  // temporary storing data in a data table 

            GridView1.DataSource = reader;
            GridView1.DataBind();
            reader.Close();
            cn.Close();
        } 
```

事情是完美的，但结果显示，即每列显示两次？为什么 ？？

# c# - 重复事件——使用日期时间？

> ID：12041228
> 
> 赞同：1
> 
> 时间：2012-08-20T16:10:11.297
> 
> 标签：c#, .net

我想做一个重复的事件，比如每周二和周四早上 8:30 发生的事情 因为它是重复的，我不希望涉及月、日和年的属性——只是小时和分钟。我应该仍然使用 DateTime，还是有其他方法可以最好地表示这些数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T16:18:40.440

查看[Wikipedia 上的 ICal](http://en.wikipedia.org/wiki/ICalendar)和相应的[RFC 5545](https://www.rfc-editor.org/rfc/rfc5545#section-3.8.5.3)，以获取有关为经常性事件创建良好数据结构所需的信息的灵感。

> 每天到 1997 年 12 月 24 日：
> 
> ```
>  DTSTART;TZID=America/New_York:19970902T090000
>   RRULE:FREQ=DAILY;UNTIL=19971224T000000Z 
> ```

`DateTime`或者`TimeSpan`对于“时间”部分可以正常工作。尝试首先编写使用您的数据结构的代码，并查看哪些方法集最适合并`DataTime`具有`TimeSpan`稍微不同的 API。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T16:18:07.683

DateTime 没有多大意义。我只会有一个包含您需要的字段的类：

```
public class DayAndTime {
 public DayOfWeek Day { get; set; }
 public int Hour { get; set; }
 public int Minute { get; set; }
 public int Second { get; set; }
} 
```

**接受答案后进行编辑，因为我认为这很有趣**：

您还可以向该类添加一个方法，以便下次需要像这样运行：

```
public DateTime NextDate {
    get {
        DateTime today = DateTime.Today;
        DateTime now = DateTime.Now;
        int daysUntilWeekday = ((int)Day - (int)today.DayOfWeek + 7) % 7;
        DateTime nextWeekDay = today.AddDays(daysUntilWeekday);
        var nextTime = nextWeekDay.AddSeconds(Second).AddMinutes(Minute).AddHours(Hour);
        if (nextTime < DateTime.Now) {
            return nextTime.AddDays(7);
        }
        else {
            return nextTime;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-20T16:12:04.763

我会使用 a`TimeStamp`并将其从第 0 天的午夜（即星期日）偏移。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T16:12:19.873

> 我应该仍然使用 DateTime，还是有其他方法可以最好地表示这些数据？

是的，当您处理 DateTime 格式时，DateTime 是最好的。当您想要执行某些重复事件时，它将包含有关星期几的信息。

您可以使用计时器来检查它的星期二或星期四上午 8:30 是否。

# asp.net-mvc-3 - 使用“@inherits”可以解决我的编辑器模板 IEnumerable 头痛吗？

> ID：12041229
> 
> 赞同：0
> 
> 时间：2012-08-20T16:10:13.423
> 
> 标签：asp.net-mvc-3, templates, viewmodel, editorfor, inheritance

我认为通过显示一些代码并进行解释可能更容易解释：

**创建产品视图模型：**

```
[UIHint("Prices")]
public IList<CreatePricesViewModel> Prices { get; set; } 
```

有了这个，我希望能够使用 ajax 调用为产品添加另一组不同货币的价格。

**创建价格 ViewModel：**

```
[DataType(DataType.Currency)]
[DisplayName("Wholesale Price: ")]
public decimal Wholesale { get; set; }

[DataType(DataType.Currency)]
[Required]
[DisplayName("Retail Price: ")]
public decimal Retail { get; set; }

[DataType(DataType.Currency)]
[DisplayName("Discounted Price: ")]
public decimal Discount { get; set; } 
```

在我的控制器中，我创建了一个 CreatePricesViewModel 并将其添加到 CreatePricesViewModel 的 CreateProductViewModels 列表中，因此至少有一个可用的实例可以在视图中呈现。

**创建产品视图：**

```
@model CumbriaMD.Infrastructure.ViewModels.ProductViewModels.CreateProductViewModel 
......
<div class="editor-field">
    @Html.EditorFor(model => model.Prices)
    @Html.ValidationMessageFor(model => model.Prices)
</div> 
```

**价格编辑器模板：**

这是我真正挣扎的地方。当我对 CreatePricesViewModel 进行强类型输入时，我会收到投诉，因为我传入的是 CreatePricesViewModel 类型的 IEnumerable 而不是单个实例 - 但是当我使用 foreach 循环时，我的 id 和名称被弄乱了，所以模型绑定失败了？可以在这里使用@inherits 帮助吗？

```
@model CumbriaMD.Infrastructure.ViewModels.PriceViewModels.CreatePricesViewModel

<div class="editor-label">
   @Html.LabelFor(model => model.Wholesale)
</div>
<div class="editor-field">
   @Html.EditorFor(model => model.Wholesale)
   @Html.ValidationMessageFor(model => model.Wholesale)
</div>
<div class="editor-label">
   @Html.LabelFor(model => model.Retail)
</div>
<div class="editor-field">
  @Html.EditorFor(model => model.Retail)
  @Html.ValidationMessageFor(model => model.Retail)
</div>
<div class="editor-label">
  @Html.LabelFor(model => model.Discount)
</div>   
<div class="editor-field">
  @Html.EditorFor(model => model.Discount)
  @Html.ValidationMessageFor(model => model.Discount)
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T16:17:38.830

不，`@inherits`不能解决你的头痛。

使用时`UIHint`，会传递整个枚举，因此您需要将模板强类型化到列表中：

```
@model IEnumerable<CumbriaMD.Infrastructure.ViewModels.PriceViewModels.CreatePricesViewModel>
@foreach(var item in Model)
{
    @Html.Partial("_SomePrice", item)
} 
```

然后定义`_SomePrice.cshtml`部分：

```
@model CumbriaMD.Infrastructure.ViewModels.PriceViewModels.CreatePricesViewModel

<div class="editor-label">
   @Html.LabelFor(model => model.Wholesale)
</div>
<div class="editor-field">
   @Html.EditorFor(model => model.Wholesale)
   @Html.ValidationMessageFor(model => model.Wholesale)
</div>
<div class="editor-label">
   @Html.LabelFor(model => model.Retail)
</div>
<div class="editor-field">
  @Html.EditorFor(model => model.Retail)
  @Html.ValidationMessageFor(model => model.Retail)
</div>
<div class="editor-label">
  @Html.LabelFor(model => model.Discount)
</div>   
<div class="editor-field">
  @Html.EditorFor(model => model.Discount)
  @Html.ValidationMessageFor(model => model.Discount)
</div> 
```

当您不使用 UIHint 属性时，这不是必需的 => 将为 Prices 集合的每个元素自动调用编辑器模板。这很糟糕，但就是这样。

# mysql - nodejs mysql不能与mariadb一起使用

> ID：12041232
> 
> 赞同：1
> 
> 时间：2012-08-20T16:10:20.843
> 
> 标签：mysql, node.js, mariadb

我有一个使用 mysql 模块的 node.js 脚本，它在安装了 mysql 的本地机器上运行良好......当我尝试在我的服务器上运行它（安装 MariaDB）时，它无法连接到服务器（每个我尝试的选项）。

当我尝试安装 mariasql 模块时，它失败了......

谁能建议该怎么做？还是支持两者的模块？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T08:58:21.590

> 它无法连接到服务器（我尝试的每个选项）。

请提供更多信息并在 GitHub 问题页面上提交工单。

# jquery - 如果鼠标在某个时间段内未悬停在元素上，则隐藏元素

> ID：12041243
> 
> 赞同：1
> 
> 时间：2012-08-20T16:11:17.567
> 
> 标签：jquery

我有一个下拉菜单，当鼠标移到特定链接上时会触发该菜单。如果鼠标在特定时间段内远离下拉菜单，我希望该下拉菜单淡出吗？

可能吗？

这是我用于打开下拉菜单的 jQuery：

```
$('.cartpopup').css({'display':'none'});
$('.cart-link').bind('mouseenter',function(){
    $('.cartpopup').stop(true, true).show().animate({top: 100}, 200).animate({top: 44}, 500);
}); 
```

现在，如果弹出窗口处于非活动状态，例如鼠标在一段时间内没有悬停，我如何使弹出窗口自动关闭。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T16:16:32.233

如果您使用 设置计时器`setTimeout()`，那么您将获得一个返回值，您可以稍后使用它来取消该超时。

例如，如果您有：

```
var hideTimer = null;
$('.cartpopup').bind('mouseleave', function() {
    hideTimer = setTimeout(function() {
        // Code to hide menu goes here
    }, 1000);
}); 
```

然后当鼠标再次进入该项目时，您可以像这样取消计时器：

```
$('.cartpopup').bind('mouseenter', function() {
    if (hideTimer !== null) {
        clearTimeout(hideTimer);
    }
}); 
```

这样，如果鼠标在计时器执行之前重新进入该项目，则它保持可见。

# perl - Perl 创建 CSV 文件

> ID：12041245
> 
> 赞同：2
> 
> 时间：2012-08-20T16:11:40.500
> 
> 标签：perl, csv

我正在尝试创建一个 CSV 文件，该文件读取 CSV 文件，然后以以下格式输出数据：

```
Type: ABC
    A: Hello 
    B: World
    C: Test-Data, Testing
Type: ABC
    A: Hello 
    B: World
    C: Test-Data, Testing 
```

输入数据看起来像这样

```
0: "ABC", "Hello", "World", "Test-Data, Testing"
1: "ABC", "Hello", "World", "Test-Data, Testing" 
```

我从阅读[Text:CSV](http://search.cpan.org/%7Emakamaka/Text-CSV-1.21/lib/Text/CSV.pm#bind_columns)开始，然后创建

```
use strict;
use warnings;
use Text::CSV;

my $file = 'file.csv';

my $csv = Text::CSV->new ({ binary => 1, eol => $/});

open my $input, "<", $file or die "$file: $!";

while (my $row = $csv->getline ($input){    
    next if ($. == 1);
    if ($csv->parse($_)) 
    {   
        print "variable: $_";
        my @columns = $csv->fields();
        print "Type: $columns[0]\n\t A: $columns[1]\n\t B:$columns[2] \n\t C:$columns[3]";
    }
    else
    {       
        my $error = $csv->error_diag;
        print "Failed to parse line: $error";
    }   
} 
```

虽然它似乎不起作用，但我认为它会在 file.csv 中读取到 $file，然后使用*getline*循环 while 循环以读取文件的每一行。

我在这里想念什么？我想知道是否有人可以提供帮助；我试图包含尽可能多的信息。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T16:19:28.803

您的错误是尝试解析已解析的行：

```
while (my $row = $csv->getline ($input){    # your row is now in $row
....
if ($csv->parse($_))  # Wrong! This is already done with getline() 
```

只需删除`if/else`子句中的错误代码并使用

```
my @columns = @$row; 
```

而且您的打印声明应该可以正常工作。

# php - 使用 Ant 在后台运行 PHP 脚本

> ID：12041246
> 
> 赞同：8
> 
> 时间：2012-08-20T16:11:41.753
> 
> 标签：php, ant, gearman

在我现在的雇主，我们使用 Ant 来执行我们的构建脚本，我需要在 build.xml 文件中添加一个目标，该目标将在后台启动 4 个作为 Gearman 工作者的 PHP 脚本，然后在构建完成后停止这些脚本完毕。

我查看了“并行”和“守护进程”指令（这是正确的词吗？）但我对 Ant 的经验不足，无法追踪我缺少的关于如何确保脚本在后台运行的信息.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T20:27:39.980

由于您没有得到很多答案，我会建议一种可能让您入门的低技术方法...

使用 ant exec 任务触发 4 个后台 php 进程，将它们的 pid 写入包含构建号（可能来自环境）的文件以识别它。

构建完成后，使用停止参数再次运行脚本，并使用文件命名系统查找进程 ID、kill take 和删除 piddling 文件。可能值得你在那里有一些陈旧的工作清洁剂。

在找到更优雅的解决方案之前，不应该太难敲出有效的东西。

# 编辑：

这对你有什么好处：

**test.php：（**这将是您的工作脚本）

```
<?php while (true) { echo "Hello world" . PHP_EOL; sleep(5); } 
```

**亚军.sh：**

```
#!/usr/bin/bash

FILE_TO_RUN=test.php

if [ -z $TEST_RUNNERS ]; then
  TEST_RUNNERS=4;
fi;

if [ -z $BUILD_NUMBER ]; then
  echo "Can not run without a build number";
  exit 1;
fi;

FILE="${BUILD_NUMBER}.run"

if [ -e $FILE ]; then
    while read line;
    do
        echo "Killing process " $line
        kill -9 $line
    done
    echo "Deleting PID file"
    rm -f $FILE
    exit 0
fi  < $FILE

for ((i=1; i<=$TEST_RUNNERS; i++)); do
  echo "Setting up test runner number " $i " of " $TEST_RUNNERS;
  php $FILE_TO_RUN &
  echo "PID number: " $!
  echo $! >> "${BUILD_NUMBER}.run"
done
exit 0 
```

# php - PHP 和正则表达式 - 可选部分

> ID：12041247
> 
> 赞同：2
> 
> 时间：2012-08-20T16:11:43.803
> 
> 标签：php, regex

我有一个涉及 PHP 和正则表达式的问题。

我有一些文件，需要捕获一些名称。但是有一部分不是全部。

示例文件：
D.SAE.IND.001.TME.BR.SER.20120729
D.SUI.IND.003.TMC.GER.TOT.201206
D.SAE.LIS.008.AGE.APS.SER.45D.20120713

请注意，最后一个文件有一部分（“45D”）是可选的。
我需要得到每个组。我正在使用以下正则表达式：

`preg_match('/D\.(?P<font>[\w]*)\.(?P<tipo>[\w]*)\.(?P<numberLevel>[\d]*)\.(?P<indicator>[\w]*)\.(?P<nameLevel>[\w]*)\.(?P<group>[\w]*)\.(?P<id>[\d]*)/i', $arrInput , $result);`

问题在于可选部分（例如最新文件-“45D”）。
我需要这个结果：

D.SAE.IND.001.TME.BR.SER.20120729
$result['fonte'] = 'SAE'
$result['tipo'] = 'IND'
$result['numberLevel'] = '001'
$result['indicator'] = 'TME'
$result['nameLevel'] = 'BR'
$result['group'] = 'SER'
$result['op'] = ''
$result[' id'] = '20120729'

D.SAE.LIS.008.AGE.APS.SER.45D.20120713
$result['fonte'] = 'SAE'
$result['tipo'] = 'LIS'
$result['numberLevel'] = '008'
$result['indicator'] = 'AGE'
$result['nameLevel'] = 'APS'
$result['group'] = 'SER'
$result['op'] = '45D'
$result['id' ] = '20120713'

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-20T16:13:51.777

你为什么不直接使用`explode('.', $string)`？

您可以计算数组以查看条目数。如果它是 7，您就知道您缺少可选字符串。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-20T16:35:22.147

这对我有用：

```
/D\.(?P<font>[\w]*)\.(?P<tipo>[\w]*)\.(?P<numberLevel>[\d]*)\.(?P<indicator>[\w]*)\.(?P<nameLevel>[\w]*)\.(?P<group>[\w]*)\.(?:(?P<op>.*)\.)?(?P<id>[\d]*)/i 
```

关键是添加：

```
(?:(?P<op>.*)\.)? 
```

组前`id`。

**编辑**：添加了`?:`使分组不被捕获。

# ruby-on-rails - 无法创建第一个 Rails 项目

> ID：12041248
> 
> 赞同：1
> 
> 时间：2012-08-20T16:11:50.750
> 
> 标签：ruby-on-rails

我是 ruby​​onrails 新手，我已经安装了 ruby​​onrails 3.2.6，我通过键入**rails new demo**创建了一个新项目iam 出现以下错误

[从https://rubygems.org/](https://rubygems.org/)获取 gem 元数据。无法加载 OpenSSL。您必须使用 OpenSSL 支持重新编译 Ruby，或将 Gemfile 中的源代码从“https”更改为“http”。rvm.io/packages/openssl 提供了使用 RVM 使用 OpenSSL 进行编译的说明。

请帮助我创建我的第一个 Rails 项目

谢谢赛克里希纳

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T21:14:35.090

这可能不是一个好习惯，但我遇到了同样的问题。
我通过将 Gemfile 中的第一行更改为：

```
source 'https://rubygems.org' 
```

至：

```
source 'http://rubygems.org' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T16:43:24.670

[这](http://www.beginnerruby.com/rails-troubleshooting/fixing-opensslbundler-issue-for-rails-on-debian/)应该可以解决您的问题。

**更新**

`source :rubygems`在 gemfile 的开头添加。

# ruby-on-rails - Rails 3未初始化常量错误，has_many和belongs_to

> ID：12041256
> 
> 赞同：0
> 
> 时间：2012-08-20T16:12:10.370
> 
> 标签：ruby-on-rails, associations, has-many, belongs-to, uninitialized-constant

我在两个活动记录之间创建了一个简单的 has_many 和 belongs_to 关系，当我尝试创建未初始化的常量 Tool::Version 时，

工具.rb：

```
class Tool < ActiveRecord::Base
  attr_accessible :name
  validates_presence_of :name
  has_many :versions
end 
```

版本.rb

```
class Versions < ActiveRecord::Base
  belongs_to :tool
  attr_accessible :tool_version
end 
```

abc.html.erb：

```
<%= form_for([@tool, @tool.versions.build]) do |f| %>
    <div class="field">
        <%= f.label :version %><br />
        <%= f.text_field :version %>
    </div>
    <div class="actions">
        <%= f.submit %>     
    </div>

<% end %> 
```

在提交时我得到了错误。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T16:32:01.283

您的 text_field 应该是 tool_version 而不是 version

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-24T23:21:15.660

您应该更改班级名称

类名应该是`Version`，而不是`Versions`

```
class Versions < ActiveRecord::Base
  belongs_to :tool
  attr_accessible :tool_version
end 
```

# html - onresize 重载问题

> ID：12041259
> 
> 赞同：1
> 
> 时间：2012-08-20T16:12:23.260
> 
> 标签：html, css

我把这段代码：

```
<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
<link href='http://fonts.googleapis.com/css?family=Ubuntu+Condensed' rel='stylesheet' type='text/css'>  
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>Abbey Test</title>
<meta name="description" content="">
<meta name="viewport" content="width=device-width">
<link rel="stylesheet" href="css/style.css">

</head>
<script src="js/libs/modernizr-2.5.3.min.js"></script>

<![if !IE]> <body onresize="document.location=window.location";> <![endif]>
<!--[if IE]> <body onresize="window.location.reload()"> <![endif]-->

<script type="text/javascript">
(function() {
var config = {
  kitId: 'dlv2pds',
  scriptTimeout: 3000
};
var h=document.getElementsByTagName("html")[0];h.className+=" wf-loading";var t=setTimeout(function(){h.className=h.className.replace(/(\s|^)wf-loading(\s|$)/g," ");h.className+=" wf-inactive"},config.scriptTimeout);var tk=document.createElement("script"),d=false;tk.src='//use.typekit.net/'+config.kitId+'.js';tk.type="text/javascript";tk.async="true";tk.onload=tk.onreadystatechange=function(){var a=this.readyState;if(d||a&&a!="complete"&&a!="loaded")return;d=true;clearTimeout(t);try{Typekit.load(config)}catch(b){}};var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(tk,s)
})();
</script>

<body onload="draw();"> 
```

在 HTML5 页面中，我正在弥补我遇到的 chrome 窗口大小调整问题。这会导致 IE 不断重新加载。我正在尝试使此页面具有响应性，但我遇到了细节问题。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T16:18:26.820

我认为问题是你应该在没有任何条件的情况下离开第一个`<body ..>`，因为它们不会在浏览器`!=`IE中解释

**编辑**

重新考虑您的问题后（​​IE 会显示两个`<body>`标签：/），您应该尝试这种方法

```
<!--[if IE]>    <body onresize="window.location.reload()"> <![endif]-->
<!--[if !IE]><!--> <body onresize="document.location=window.location";> <!--<![endif]--> 
```

取自 html5boilerplate ;)

***在@Schnaars 评论后***编辑****

 ***您的网站正在重新加载，因为您每次调整窗口大小时都会调用`window.location.reload()`[ [window.location](https://developer.mozilla.org/en-US/docs/DOM/window.location#Methods)`resize` ]（每次加载页面时都会调用该事件）。你把它放入 IE 条件下，这就是它不断重新加载的原因。您可能想在页面调整大小时重绘“某些东西”，只需调用`onresize="draw()"`like `<body onload="draw()" onresize="draw()">`。

*旁注：*使用[jQuery](http://jquery.com)或类似的库会使事件处理和其他事情变得更容易；）***

# iphone - 一个 AVPlayerItem 不能与多个 AVPlayer 实例相关联'

> ID：12041260
> 
> 赞同：19
> 
> 时间：2012-08-20T16:12:28.903
> 
> 标签：iphone, ios, video, avplayer

```
-(IBAction)play:(id)sender
{

    thumbImageView.alpha=0.0;

    NSString *stringvideo=[NSString stringWithFormat:@"http://streaming-service",[[NSUserDefaults standardUserDefaults]valueForKey:@"VideoIdselected"]];

    NSString *videoURLString = stringvideo;

       NSURL *url = nil;

  url = [NSURL URLWithString:videoURLString];

    self.moviePlayerController = [[MPMoviePlayerController alloc] initWithContentURL:url];

    if (self.moviePlayerController)
    {
        /* Save the movie object. */
          [self setMoviePlayerController:self.moviePlayerController];

        [self installMovieNotificationObservers];

        /* Specify the URL that points to the movie file. */
        [self.moviePlayerController setContentURL:url];

        [self.moviePlayerController setMovieSourceType:MPMovieSourceTypeStreaming]; // for streaming

        self.moviePlayerController.controlStyle = MPMovieControlStyleEmbedded;

        // [self.videoPlayer setMovieSourceType:MPMovieSourceTypeStreaming];

      // self.moviePlayerController.shouldAutoplay = YES;

        [self.moviePlayerController.view setFrame: CGRectMake(0, 0, 320,160)];

        [self.moviePlayerController setFullscreen:NO animated:YES];

        [self.moviePlayerController view].backgroundColor = [UIColor lightGrayColor];

        [self.view addSubview:self.moviePlayerController.view];

        [self.view bringSubviewToFront:self.moviePlayerController.view];
        [self.moviePlayerController prepareToPlay];
        //self.moviePlayerController.useApplicationAudioSession = NO;

        [self.moviePlayerController play];

    }

} 
```

嗨，我正在尝试在我的 iphone 应用上播放视频。该代码播放本地文件，但在用于从服务器流式传输视频时出现错误“由于未捕获的异常‘NSInvalidArgumentException’导致应用程序终止，原因：‘一个 AVPlayerItem 不能与多个 AVPlayer 实例关联’”而崩溃。此外，该链接在浏览器中流式传输视频绝对正常，但我无法在应用程序中播放视频。请帮忙 。谢谢

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2013-02-12T16:02:50.057

Had same issue, try setting ContentURL after Setting the SourceType like below,

```
moviePlayerController_ = [[MPMoviePlayerViewController alloc] init];
moviePlayerController_.movieSourceType = MPMovieSourceTypeStreaming;
[moviePlayerController_.moviePlayer setContentURL:url]; 
```

Source: [devforums.apple.com/message/467199](http://devforums.apple.com/message/467199)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-05T02:57:13.737

这可能是一个问题`MovieSourceType`；您正在播放本地文件，但使用`MPMovieSourceTypeStreaming`; 只需修改类型并重试

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-06T05:53:14.803

我用过moviePlayerController.movi​​eSourceType = MPMovieSourceTypeUnknown它对我有用..试试看..

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-10T11:30:33.387

首先，您必须告知播放器您设置视频文件内容的源类型；像这样

这是两种类型的网址；如果 url 是这样的，你写这个函数

```
 NSString *aStr=@"http://www.my url like this.com/video/videos/review/Michale JACKSON  AUDIENCE Comment.mp4";   

aStr = [aStr stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]; 
```

或（第二个）

```
NSString *aStr=@"http://www.normal url.com/video.mp4"

// after add your url string to this url

NSURL *url=[NSURL URLWithString:aStr];
MPMoviePlayerViewController *MPlayer = [[MPMoviePlayerViewController alloc]init];
MPlayer.moviePlayer.movieSourceType = MPMovieSourceTypeStreaming;
[MPlayer.moviePlayer setContentURL:url];
[self presentMoviePlayerViewControllerAnimated:MPlayer]; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-07-21T14:55:58.467

不是问题的直接答案，但如果您在尝试更新 contentURL 后收到此错误，请在解决问题之前调用 stop()。

```
moviePlayerController.stop()
moviePlayerController.movieSourceType = .File
moviePlayerController.contentURL = newURL 
```

# mongodb - Mongodb集合的内部计数

> ID：12041261
> 
> 赞同：0
> 
> 时间：2012-08-20T16:12:35.600
> 
> 标签：mongodb

我需要计算以下 mongo 文档中的内部记录（而且我还必须获取所有文档的计数），

```
 "_id": ObjectId("503208f5b5db0135387d9249"),
   "function": "getNumberOfRecords",
   "graph": {
       "AB1": {
           "5028cbf7d7262c333a000cb0": 1,
           "5028ede7d7262c333a0011fb": 1
       },
       "AB2": {
           "5028ef9cd7262c333a001219": 1,
           "5028fb9cd7262c333a001c7f": 1,
           "5028fb9cd7262c333a001c80": 1,
           "5028fefcd7262c333a002354": 1,
           "50290d55d7262c333a0024e0": 1,
           "502918c9d7262c333a0025c3": 1,
           "502918c9d7262c333a0025c4": 1,
           "50293220d7262c333a002727": 1,
           "50293220d7262c333a002728": 1,
           "50293220d7262c333a002729": 1,
           "50293220d7262c333a00272a": 1,
           "50295a5bd7262c333a003bbc": 1
       },
       "AB3": {
           "5028ff00d7262c333a002363": 1,
           "50295a5ed7262c333a003bcb": 1
       },
       "AB4": {
           "50293fdfd7262c333a002977": 1
       }
   },
   "nameFilter": "name",
   "siteFilter": "sitename"
} 
```

我需要结果，

```
AB1 > 2
AB2 > 12
AB3 > 2 
```

同样地.....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T16:26:39.667

在 mongodb 中执行此操作的最佳方法是创建额外的计数字段并通过客户端代码更新它们。

因此，我建议进行以下架构更改以满足您的需求：

```
{
 graphsCount: 1,
 graph: [
       {
          name: "AB1",
          count: 2,
          items: {
             "5028ff00d7262c333a002363": 1,
             "50295a5ed7262c333a003bcb": 1
         }
        }
]
} 
```

不，您可以轻松实现所需的 ( `AB1 > 2`)：

```
db.items.find({"graph.name" : "AB1", {"$gt": {"graph.count": 2}} }) 
```

请记住，上述查询返回嵌套图形数组中至少有一个名称为“AB1”且计数 > 2 的所有**根文档。**

# javascript - 使用 KnockoutJS 和简单类继承时丢失对自身的引用

> ID：12041269
> 
> 赞同：0
> 
> 时间：2012-08-20T16:13:04.127
> 
> 标签：javascript, inheritance, knockout.js

我正在使用[John Resig 的“简单 JavaScript 继承”](http://ejohn.org/blog/simple-javascript-inheritance/)来创建一个可以继承的类。我也在使用 KnockoutJS 来计算 observables。问题在于试图将这两个概念结合起来。当我尝试在计算的 observable 中获取对 self 的引用时，我得到的是“Window”对象而不是预期的实际对象。这是一个快速的代码示例：

```
window.mynamespace.myclass = Class.extend({
    init: function() {

    },
    someProperty: ko.observable(10),
    someComputedProperty: ko.computed(function() {
       return this.someProperty();  
    }, this)
}); 
```

不幸的是 this.someProperty() 无法找到，因为“this”是对 Window 的引用。有什么想法或想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T16:34:59.863

我从来没有使用过 KnockoutJS 的经验。然而，我精通 JavaScript 中的继承，我不赞成 John Resig 的“简单 JavaScript 继承”模式（主要是因为它没有私有变量）。相反，我更喜欢使用我自己的[类模式](https://gist.github.com/3091759 "JavaScript 中的经典 OOP — 要点")。我想你可能会觉得很有趣：

```
window.mynamespace.myclass = new Class(function (uber) {
    var self = this;

    function constructor() {
    }

    this.someProperty = ko.observable(10);

    this.someComputedProperty = ko.computed(function () {
        return self.someProperty();
    });

    return constructor;
}); 
```

您也可以使用您的方法并简单地跳过创建`self`. 由于该类不是从您可以`this`在类定义中使用的对象创建的（在 John Resig 的“简单 JavaScript 继承”模式中您不能这样做）：

```
window.mynamespace.myclass = new Class(function (uber) {
    function constructor() {
    }

    this.someProperty = ko.observable(10);

    this.someComputedProperty = ko.computed(function () {
        return self.someProperty();
    }, this);

    return constructor;
}); 
```

您也可以直接将方法添加到`window.mynamespace.myclass.prototype`. 这样`self.someProperty()`你就可以返回而不是返回`myclass.prototype.someProperty()`。如果您需要任何关于我的课堂模式的帮助，请随时问我。

**编辑：**

构造`Class`函数有两个参数：**定义类的函数**和派生自的*可选* **基类。**第一个参数（即*function*）**必须**返回另一个函数，它是类的**构造**函数（类似于 C++ 或 Java 构造函数）。

让我们创建一个简单的`Rectangle`类：

```
var Rectangle = new Class(function () {
    // width and height are private variables
    var width;
    var height;

    // the class constructor accepts two arguments
    function constructor(length, breadth) {
        // save the parameters
        width = length;
        height = breadth;
    }

    // area is a public function
    this.area = function () {
        // return the area of the rectangle
        return width * height;
    };

    return constructor; // always remember to return the constructor
}); 
```

现在您可以创建该类`Rectangle`的实例，如此[小提琴](http://jsfiddle.net/H46F3/)中所示。

现在让我们做一些更有趣的事情——继承。构造函数的第二个参数`Class`是派生自的基类。让我们创建一个`Square`派生自 class 的类`Rectangle`。

```
// notice that the class definition function accepts a parameter called uber
var Square = new Class(function (uber) {
    // return the constructor of the class Square
    return function (side) {
        // call the base class constructor - uber
        uber(side, side);
    };
}, Rectangle); // Square derives from Rectangle 
```

这就是事情变得有趣的地方。好的，所以我们在这个类模式中有 4 种类型的数据成员：`private`、`public`、`shared`和`static`。我们已经看到了私有和公共数据成员。

共享数据成员是定义在类上的那些属性`prototype`。它们由类的所有实例共享。

静态数据成员是在类本身上定义的那些属性。它们不被类的实例继承。

在上面的示例中，当`Square`派生自它时，`Rectangle`它继承了`Rectangle`. 事实上，我们也可以在定义`Rectangle` **后** `Square`定义一个新的共享或静态数据成员，它仍然会被`Square`. 让我们用一个例子来演示这个概念：

```
alert(Square.staticDataMember); // staticDataMember is undefined
Rectangle.staticDataMember = "It works!"; // define staticDataMember on Rectangle
alert(Square.staticDataMember); // staticDataMember is inherited from Rectangle 
```

以上是针对静态数据成员的。让我们看看共享数据成员的情况：

```
var square = new Square(5); // create an instance of Square
alert(square.sharedDataMember); // sharedDataMember is undefined
Rectangle.prototype.sharedDataMember = 0; // define sharedDataMember on Rectangle
alert(square.sharedDataMember); // sharedDataMember is inherited from Rectangle 
```

[您可能会在以下小提琴](http://jsfiddle.net/H46F3/1/)中看到上述程序的输出。

这很酷，但是私有和公共数据成员呢？它们是如何遗传的？好吧，当我们创建一个新类时，私有和公共数据成员不会被继承。它们在创建类的新实例时被继承。这是因为同一类的不同实例具有不同的私有和公共数据成员。

当我们创建派生类的实例（如`Square`）时，我们不会继承它的基类（即`Rectangle`）的私有和公共数据成员，直到我们调用基类构造函数（即`uber`）。只有当我们调用基类构造函数时，私有和公共数据成员才会被继承（实际上只有公共数据成员被继承——其他的被称为私有是有原因的）：

```
var Square = new Class(function (uber) {
    return function (side) {
        alert(this.area); // area is undefined
        uber(side, side); // inherit public members from an instance of Rectangle
        alert(this.area); // area is now defined
    };
}, Rectangle); 
```

[您可能会在以下小提琴](http://jsfiddle.net/H46F3/2/)中看到上述程序的输出。

现在让我们为 kicks 创建另一个类，在此过程中，我们还将演示多级继承：

```
var Cube = new Class(function (uber) {
    var side; // the length of a side of the cube

    function constructor() {
        side = arguments[0]; // save the first argument passed to the constructor
        uber = uber(side); // call the base constructor and save its instance
    }

    this.area = function () {
        return 6 * uber.area(); // return the surface area of the cube
    };

    this.volume = function () {
        return side * uber.area(); // return the volume of the cube
    };

    return constructor; // remember to return the constructor
}, Square); // derive from Square 
```

这是新事物。在这里，我们创建了一个新`area`函数，它[隐藏](http://en.wikipedia.org/wiki/Variable_shadowing "可变阴影 - 维基百科，免费的百科全书")了中`area`定义的函数`Rectangle`，但是如果我们想从派生类访问基类方法怎么办？

好吧，当我们调用基类构造函数（即`uber`）时，它会返回基类的实例。由于我们不再需要基类构造函数，我们将实例保存为`uber`. 然后我们可以使用和函数中看到的那样调用基类`area`方法。`uber.area``area``volume`

[您可能会在以下小提琴](http://jsfiddle.net/H46F3/3/)中看到上述程序的输出。

因此您可能会看到，这个类模式比 John Resig 的“简单 JavaScript 继承”模式强大得多，`Class`构造函数只有 47 行代码（没有被缩小）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T16:26:16.937

您可以随时将它们添加到`init`. 在[淘汰赛自己的示例](http://knockoutjs.com/documentation/computedObservables.html)中，它们在构造函数中进行绑定。

```
window.mynamespace.myclass = Class.extend({
    init: function() {
        this.someProperty = ko.observable(10);
        this.someComputedProperty = ko.computed(function() {
           return this.someProperty();  
        }, this);  
    }
}); 
```

或者捕获对绑定的引用`this`并忘记绑定：

```
window.mynamespace.myclass = Class.extend({
    init: function() {
        var self = this;
        self.someProperty = ko.observable(10);
        self.someComputedProperty = ko.computed(function() {
           return self.someProperty();  
        });  
    }
}); 
```

* * *

## 编辑：

为了演示如何扩展类：

```
window.mynamespace.myotherclass = window.mynamespace.myclass.extend({
    init: function() {
      // do anything myotherclass init, like another observable
      this.someOtherProperty = ko.observable(10);

      // incidentally you *can* have private variables with this pattern
      var imPrivate = 1;
      this.getImPrivate = function() {
        return imPrivate;
      };

      // then call super (maybe with arguments, maybe just passing them)
      this._super('foobar');
    }
}); 
```

# java - makeActiveBinding 定义无法创建 JavaGD 窗口

> ID：12041273
> 
> 赞同：0
> 
> 时间：2012-08-20T16:13:13.033
> 
> 标签：java, r

我在我的`Rprofile.site`（WindowsOS）中使用这一行来创建一个速记：

```
makeActiveBinding('newdev', function(...) {library(grDevices); dev.new(restoreConsole=T)},.GlobalEnv) 
```

但是，当我尝试从 JavaGUI for R（又名 JGR）中的控制台执行它时，它无法创建一个窗口并返回`NULL`. 如果我键入`dev.new()`一个新窗口打开就好了。我已经安装了 JRE 1.7.0_06 和 Java7（一切都是 x64）。

然后，我尝试从 JGR 控制台定义一个新的绑定：

```
makeActiveBinding('newfoo', function(...) {library(grDevices); dev.new(restoreConsole=T)},.GlobalEnv) 
```

从某种意义上说，这奏效了——它开始创建图形窗口并且不会停止！
有任何想法吗？

谢谢

# c++ - Doxygen 没有在 main.cpp 中记录主要功能

> ID：12041274
> 
> 赞同：19
> 
> 时间：2012-08-20T16:13:30.963
> 
> 标签：c++, doxygen, main

我有一个 main.cpp，其中包含一个结构、一些全局常量和一个主函数。

我运行了 doxygen，我在输出 index.html 中获得的唯一文档是我的结构。

我希望 doxygen 也将我的 main() 记录到 index.html 文件中。我做错了什么？

```
 /// Definition of Pi
    const auto Pi = 3.141592653589793238462643383279502884197169399;

    /// \struct myStruc
    /// \brief myStruc description
    ///
    struct myStruc
    {
         /// Comments inside myStruc
    };

    /// \file

    /// \brief  Main function
    /// \param  argc An integer argument count of the command line arguments
    /// \param  argv An argument vector of the command line arguments
    /// \return an integer 0 upon exit success
    int main(int argc, char** argv)
    {
        /// Comments I would like to be documented in as well
        return 0;
    } 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-08-20T16:41:25.773

这是因为您正在记录一个全局对象，默认情况下 doxygen 不记录该对象。从[doxygen 手册](http://www.doxygen.nl/docblocks.html)（强调我的）：

> 要记录 C++ 类的成员，您还必须记录该类本身。命名空间也是如此。**要记录全局 C 函数、typedef、枚举或预处理器定义，您必须首先记录包含它的文件**（通常这将是一个头文件，因为该文件包含导出到其他源文件的信息）。
> 
> 让我们重复一遍，因为它经常被忽略：**要记录全局对象（函数、typedef、枚举、宏等），您必须记录定义它们的文件。**换句话说，至少必须有一个
> 
> ```
> /*! \file */ 
> ```
> 
> 或一个
> 
> ```
> /** @file */ 
> ```
> 
> 此文件中的行。

因此，请尝试将上述两行之一添加到您的 main.cpp 文件中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-20T17:19:57.270

确保`HIDE_IN_BODY_DOCS`设置为`NO`并使用如下内容：

```
/// \file

/// \brief  Main function
/// \param  argc An integer argument count of the command line arguments
/// \param  argv An argument vector of the command line arguments
/// \return an integer 0 upon exit success
int main(int argc, char** argv)
{
  /// Comments I would like to be documented in as well
  return 0;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-03T08:47:03.287

对我来说，我必须确保我有这一套：

SHOW_FILES = 是

您的所有全局函数都将显示在每个文件内的“文件”选项卡中。此外，如果您在代码顶部定义了 @file 或 \file ，它也会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T23:21:55.603

来自“其他地方的文档”部分的在线手册：http: [//www.doxygen.nl/manual/docblocks.html#specialblock](http://www.doxygen.nl/manual/docblocks.html#specialblock)

“Doxygen 允许您将文档块放在几乎任何地方（**例外是在函数体**内部或普通 C 样式注释块内）。”

这是有道理的，因为通常不需要函数如何工作（其实现）的本质。我相信 doxygen 的目的是帮助编写易于搜索的文档，以允许编码人员找到事物的位置并查找它们的作用（以及传递给它的参数、返回的内容等）以学习如何使用它们，但不是它的实际实现方式。这需要实际查看函数源（也可以在 doxygen 生成的文件中找到）。另外，如果您注意到，所有示例（我认为）都在头文件中显示文档，这些文档缺少任何实现，这使我相信文档是针对头文件的，但是该工具使您可以灵活地放入源文件也是如此。

无论如何，这就是我的看法。有人有不同的想法吗？

# ios - 如何从某个类名中查询我的所有自定义对象？

> ID：12041275
> 
> 赞同：0
> 
> 时间：2012-08-20T16:13:30.093
> 
> 标签：ios, cloud, titanium, appcelerator, custom-object

我正在使用 Titanium 并为 iOS 开发，我遇到了一个小问题，当我想从某个类名查询自定义对象时，我只能获取最后 10 个对象，这就是我的方式进行查询：

```
Cloud.Objects.query({
    classname : 'Reservacion'
}, function(e){
   if(e.success){
    reservaciones = e.Reservacion; //assign the custom objects to an array
   }else {
    alert('Error: ' + e.error + e.message);
   }
}); 
```

我错过了什么吗？我知道我可以指定页数来检索其余对象，但页数会不断增长，因此我需要找到一种方法来检索特定类名的所有自定义对象。谁能给我指导如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-15T21:00:22.653

我只是在调查这个。如果您不想使用 'page' 和 'per_page' 参数（分别默认为 1 和 10），请从[文档中获取。](http://docs.appcelerator.com/cloud/latest/#!/api/CustomObjects-method-query)

您需要指定一个“限制”（最大值为 1000）

如果您有超过 1000 个，请在第二个查询中使用参数“skip”以从您离开的地方继续。

所以你的第一个查询可能看起来像这样

```
Cloud.Objects.query({
    classname : 'Reservacion',
    limit : 1000,
}, function(e){
   if(e.success){
    reservaciones = e.Reservacion; //assign the custom objects to an array
   }else {
    alert('Error: ' + e.error + e.message);
   }
}); 
```

然后是第二个查询（在循环内）

```
Cloud.Objects.query({
    classname : 'Reservacion',
    limit : 1000,
    skip : 1000   
}, function(e){
   if(e.success){
    reservaciones = e.Reservacion; //assign the custom objects to an array
   }else {
    alert('Error: ' + e.error + e.message);
   }
}); 
```

没测试，希望对你有帮助。

# java - 当滚动窗格包装文本窗格时，如何防止 JScrollPane 箭头键处理移动插入符号

> ID：12041277
> 
> 赞同：1
> 
> 时间：2012-08-20T16:13:38.017
> 
> 标签：java, swing, jscrollpane, jtextpane, caret

我有以下要求：

我需要一个可滚动的 JTextPane。用户可以在该文本窗格中键入，或者可以在其中插入不是用户键入的文本。想像一个 IM 窗口之类的东西。尽管窗口必须是可滚动的以允许用户查看以前键入的文本，但插入符号不应从文本末尾的位置移动。用户输入的任何文本都将始终显示在末尾。

在 JTextPane 中，当用户使用滚动条滚动时，插入符号不会移动。视口被调整。但是，当用户按下向上和向下箭头键时，JTextPane 插入符号会随之移动（无论窗口是否滚动）。

我想要的是向上箭头键的功能与用鼠标向上移动滚动条相同。箭头键应该与插入符号无关。

我尝试了以下方法，但没有成功：1）为我的文本窗格类（使用 JTextPane.addKeymap() 和 Keymap.addActionForKeyStroke()）向 Keymap 添加“No-op”操作。这会阻止插入符号移动，但会阻止将操作传递到滚动窗格以滚动视图。2）从我的文本窗格类的键盘映射中删除箭头键。这会影响我的应用程序中的所有 JTextPanes，这不是我想要的。

我想要的是向我的 TextPane 键盘映射添加一个操作，该操作只需调用向上和向下箭头的 ScrollPane 操作。

实现这一目标的最佳方法是什么？

我想到的一种可能性是实现一个 KeyListener（它在键盘映射之前接收击键）来捕获这些键，然后手动实现滚动。但这似乎需要我计算字体大小等。有没有更简单的方法？

理想的情况是，如果有某种方法可以将插入符号“锚定”到文本的末尾。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T20:33:48.537

你将不得不修改`KeyBindings`

试试这个开始

```
InputMap im = textArea.getInputMap(WHEN_FOCUSED);
ActionMap am = textArea.getActionMap();

am.get("caret-down").setEnabled(false);
am.get("caret-up").setEnabled(false); 
```

既然你有这个工作，你需要担心所有这些

```
selection-up = shift pressed UP
caret-next-word = ctrl pressed RIGHT
selection-previous-word = shift ctrl pressed LEFT
selection-up = shift pressed KP_UP
caret-down = pressed DOWN
caret-previous-word = ctrl pressed LEFT
caret-end-line = pressed END
selection-page-up = shift pressed PAGE_UP
caret-up = pressed KP_UP
delete-next = pressed DELETE
caret-begin = ctrl pressed HOME
selection-backward = shift pressed LEFT
caret-end = ctrl pressed END
delete-previous = pressed BACK_SPACE
selection-next-word = shift ctrl pressed RIGHT
caret-backward = pressed LEFT
caret-backward = pressed KP_LEFT
selection-forward = shift pressed KP_RIGHT
delete-previous = ctrl pressed H
unselect = ctrl pressed BACK_SLASH
insert-break = pressed ENTER
selection-begin-line = shift pressed HOME
caret-forward = pressed RIGHT
selection-page-left = shift ctrl pressed PAGE_UP
selection-down = shift pressed DOWN
page-down = pressed PAGE_DOWN
delete-previous-word = ctrl pressed BACK_SPACE
delete-next-word = ctrl pressed DELETE
selection-backward = shift pressed KP_LEFT
selection-page-right = shift ctrl pressed PAGE_DOWN
caret-next-word = ctrl pressed KP_RIGHT
selection-end-line = shift pressed END
caret-previous-word = ctrl pressed KP_LEFT
caret-begin-line = pressed HOME
caret-down = pressed KP_DOWN
selection-forward = shift pressed RIGHT
selection-end = shift ctrl pressed END
selection-previous-word = shift ctrl pressed KP_LEFT
selection-down = shift pressed KP_DOWN
insert-tab = pressed TAB
caret-up = pressed UP
selection-begin = shift ctrl pressed HOME
selection-page-down = shift pressed PAGE_DOWN
delete-previous = shift pressed BACK_SPACE
caret-forward = pressed KP_RIGHT
selection-next-word = shift ctrl pressed KP_RIGHT
page-up = pressed PAGE_UP 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T07:46:29.187

如果您让用户放置插入符号，例如让他选择和复制一些文本怎么办？

我会添加一个 DocumentFilter（或覆盖 Document 的 insertString() 方法），并且在所有情况下都在 doc.getLength() 位置执行插入，并在插入后将插入符号重置为 doc.getLength() 位置。

# html - 在无序列表 Internet Explorer 中列出项目

> ID：12041279
> 
> 赞同：0
> 
> 时间：2012-08-20T16:13:52.247
> 
> 标签：html, css, internet-explorer

我已经阅读了 w3c 标准指南，他们指出对于基本的表单创建，使用 ul 优于使用表格。在 Firefox 等中，下面显示的非常简单的代码在列表中创建简单的文本/输入框对。

在 Internet Explorer (Ie8, 9) 中，文本框出现在跨度下方和右侧约 15px 处。

![在此处输入图像描述](../Images/975ac1acf54107ac5a1c72bda590705f.png)

有人可以向我解释为什么吗？我究竟做错了什么？

```
<html>
<head>
    <style type="text/css">
        ul li input
        {
            width:70%;
            float:right;
        }
        ul
        {
            list-style: none;
            width:300px;
        }
    </style>
</head>
<body>
    <ul>
        <li>
            <span>Username:</span><input type="text" id="UserNameBox" />
        </li>
        <li>
            <span>Password:</span><input type="password" id="PasswordBox" />
        </li>
    </ul>
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T16:21:22.713

如果您希望输入向右浮动，则以下 HTML 应该可以工作：

```
<body>
    <ul>
        <li>
            <input type="text" id="UserNameBox" /><span>Username:</span>
        </li>
        <li>
            <input type="password" id="PasswordBox" /><span>Password:</span>
        </li>
    </ul>
</body> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T16:20:28.500

`<input>`标签是自动关闭的，您的 html 语法在输入上是错误的。试试这个：

```
<ul>
    <li>
        <span>Username:</span><input type="text" id="UserNameBox" />
    </li>
    <li>
        <span>Password:</span><input type="password" id="PasswordBox" />
    </li>
</ul> 
```

# android - ActionBar 在 Android 上无法正确显示

> ID：12041282
> 
> 赞同：1
> 
> 时间：2012-08-20T16:14:01.713
> 
> 标签：android, android-actionbar

我正在为智能手机和平板电脑开发应用程序。我的 ActionBar 由智能手机的选项卡 (ActionBar.NAVIGATION_MODE_TABS) 和平板电脑的操作按钮 (NAVIGATION_MODE_STANDARD) 组成。问题是，在智能手机上，标签会出现，但就在下方，两个标签图标也会出现，我称之为第二个 actionBar。其余的操作菜单项通常堆叠在底部。有关更多信息，请参阅此图片：

[http://i.imgur.com/kdrdp.png](http://i.imgur.com/kdrdp.png)

我的菜单布局中的所有项目都是这样写的：

```
<item
    android:id="@+id/menu_settings"
    android:showAsAction="ifRoom"
    android:icon="@drawable/action_settings"
    android:title="@string/menu_settings"/> 
```

这两个图标不应该出现。你对此有什么想法吗？

提前致谢

更新：这是 onCreateOptionsMenu 方法，非常简单：

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.menu_activity, menu);
    this.menu = menu;
    return true;
} 
```

# android - 带有另一个视图的背景可绘制选择器的 setBackgroundDrawable 会破坏选择器状态

> ID：12041285
> 
> 赞同：3
> 
> 时间：2012-08-20T16:14:13.687
> 
> 标签：android

如果我从 Button.getBackground() 在具有选择器可绘制对象的按钮上设置可绘制对象，然后在具有相同可绘制对象的另一个按钮上调用 set setBackgroundDrawable，则选择器状态不起作用。

例子：

```
//layout is inflated from XML

//buttonA object ref set from view
//buttonB object ref set from view

drawableA = buttonA.getBackground();
drawableB = buttonB.getBackground(); 
```

现在调用`buttonA.setBackgroundDrawable(drawableB)`将导致 buttonA 在不同的选择器状态下无法正确动画。

难道我做错了什么？我尝试调用 getConstantState().newDrawable(getResources()).mutate() 来制作类似于可绘制对象的副本，以防状态绑定到原始按钮，但这似乎没有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-06T18:19:28.433

我知道这个问题很老，但我刚刚遇到了同样的问题 - 所以如果其他人找到了通往互联网这个黑暗角落的路，这就是我的解决方案......

```
buttonB.setBackground(buttonA.getBackground().getConstantState().newDrawable()); 
```

两个视图的状态现在应该可以工作了。希望这可以帮助！

# monodevelop - MonoDevelop：是否可以切换 PCL 的编译器？

> ID：12041290
> 
> 赞同：10
> 
> 时间：2012-08-20T16:14:28.327
> 
> 标签：monodevelop, portable-class-library, gmcs

我们正在启动一个跨平台项目，以部署到 Android 和 iOS。显然，很多代码要在两者之间共享，并且一些代码严重依赖于 .NET 框架项，例如 sqlite-net 库。

在 2 个项目之间共享代码的最佳方式 (afaik) 是使用 PCL——这样可以在解决方案中使用来自 iOS 和 Android 项目的共享代码来引用项目，并重新编译和链接所有内容很好的方式。

但是，在 MonoDevelop 中创建的 PCL 是使用 gmcs 编译器编译的，并且在这种情况下无法构建一些外部依赖项（即在这种情况下使用的框架缺少`System.Func<T, TResult>`，仅提供`System.Func<T1, T2, ..., T9, TResult>`）。MonoTouch 的编译器 (smcs) 能够完美地编译 PCL（通过将 gmcs 二进制替换为 smcs 二进制来证明）。根据我在谷歌搜索后发现的结果，gmcs 使用 2.0 .NET 框架，而 smcs 使用称为 2.1 框架的 smth，它实际上是最近的 .NET 的混合体。

问题来了：在 MonoDevelop 中构建 PCL（作为另一个项目的依赖项）时，是否可以指定使用哪个编译器？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-21T20:31:48.597

Mono 还没有实际 PCL 库的实现。目前，它有[一个虚拟的 Microsoft.Portable.CSharp.targets 文件](https://github.com/mono/mono/blob/master/mcs/tools/xbuild/xbuild/Microsoft.Portable.CSharp.targets)，它会覆盖框架和目标以针对 MonoTouch、Android 的 Mono 或 .NET 4.0 构建库，具体取决于安装的内容。

使用 MonoTouch 框架的代码路径中似乎存在错误 - 它使用默认的公共目标 Microsoft.CSharp.targets，而没有覆盖编译器以使用 MonoTouch 特定版本的 C# 编译器。这是必要的，因为 Mono 的 C# 编译器当前是特定于框架的（尽管这在 Mono 2.12 中已修复，它是 alpha 版本）。

您可以通过编辑文件来解决此问题`/Library/Frameworks/Mono.framework/Versions/Current/lib/mono/xbuild/Microsoft/Portable/v4.0/Microsoft.Portable.CSharp.targets`，找到设置的 PropertyGroup

```
<TargetFrameworkIdentifier>MonoTouch</TargetFrameworkIdentifier> 
```

并为此添加以下行：

```
<CscToolExe>smcs</CscToolExe>
<CscToolPath>/Developer/MonoTouch/usr/bin</CscToolPath> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-16T20:54:54.467

我知道这是一个老问题，但似乎在 3.0.x 版本中向 Mono 添加了可移植类库 (PCL) 支持，有关详细信息，请参阅[发行说明](http://www.mono-project.com/docs/about-mono/releases/)，特别是[3.0.8](http://www.mono-project.com/docs/about-mono/releases/3.0.12/)版本：

> 将 PCL 支持添加到 xbuild，mono 的 MSBuild 实现。

# php - php db2_connect - 正在使用什么驱动程序？

> ID：12041294
> 
> 赞同：1
> 
> 时间：2012-08-20T16:14:36.557
> 
> 标签：php, database, apache, connection, db2

```
 $connection = db2_connect ( '*LOCAL', PHP_USER_NAME, PHP_USER_PASS );
    if (! $connection) {
        die('Could not connect');
    }

    //Prepare and execute the SQL statement.
    $stmt = db2_prepare ( $connection, $sqlStatement );

    if (! db2_execute ( $stmt ) ) {
        Throw New Exception('Could not execute statement');
    } 
```

我们在带有 Apache 的 IBM iSeries 上运行 PHP。我们的数据库也在这个 iSeries 上。

正在建立什么样的连接？它是 ODBC 链接吗？如果这因系统而异，我怎么知道？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T17:03:57.200

似乎这是一个`ODBC`连接：

尝试[`db2_client_info`](http://www.php.net/manual/en/function.db2-client-info.php)在您的客户端上运行该功能，这应该会输出所需的信息。您可以运行以下代码：

```
<?php
$conn = db2_connect( '*LOCAL', PHP_USER_NAME, PHP_USER_PASS );
$client = db2_client_info( $conn );

if ($client) {
    echo "DRIVER_NAME: ";           var_dump( $client->DRIVER_NAME );
    echo "DRIVER_VER: ";            var_dump( $client->DRIVER_VER );
    echo "DATA_SOURCE_NAME: ";      var_dump( $client->DATA_SOURCE_NAME );
    echo "DRIVER_ODBC_VER: ";       var_dump( $client->DRIVER_ODBC_VER );
    echo "ODBC_VER: ";              var_dump( $client->ODBC_VER );
    echo "ODBC_SQL_CONFORMANCE: ";  var_dump( $client->ODBC_SQL_CONFORMANCE );
    echo "APPL_CODEPAGE: ";         var_dump( $client->APPL_CODEPAGE );
    echo "CONN_CODEPAGE: ";         var_dump( $client->CONN_CODEPAGE );
}
else {
    echo "Error retrieving client information.
     Perhaps your database connection was invalid.";
}
db2_close($conn);

?> 
```

# c# - 从后台工作人员 OnProgressChanged 事件计算剩余总时间和总时间

> ID：12041296
> 
> 赞同：3
> 
> 时间：2012-08-20T16:14:41.343
> 
> 标签：c#, winforms, datetime, date-arithmetic

我有一个后台工作人员报告计算的进度。它返回在 ProgressChangedEventArgs 中正在处理的当前行号。我可以从那里确定通过做的百分比

```
(int) (100 * (double)e.ProgressPercentage / csTextLines) 
```

其中 csTextLines 是我正在处理的行数。我遇到的麻烦是我想得到一个总估计时间和总剩余时间。我看到后台工作人员中没有任何东西可以帮助我，所以我想它必须通过 DateTime 计算来完成。这是我到目前为止所做的尝试获取 TotalEstTime 和 TimeLeft

*   TimeLeft = TotalEstTime - TimeSoFar；
*   TotalEstTime = AvgTimeForEachLine * #OfLines;

在哪里

*   TimeSoFar = DateTime.Now - m_startTime;
*   AvgTimeForEachLine = (TimeFromLastLine + TotalTimeForAllLines) / #OfLines;

在哪里

*   TimeFromLastLine = DateTime.Now - LastRecordedTime;
*   TotalTimeForAllLines += TimeFromLastLine;

所以如果我们把它变成我到目前为止的代码

```
// This event handler updates the progress. 
    private void backgroundWorker1_ProgressChanged(object sender, ProgressChangedEventArgs e)
    {
        TimeSpan difInCalls = DateTime.Now.Subtract(m_LastProgressCall);
        m_LastProgressCall = DateTime.Now;
        m_totalDif = m_totalDif.Add(difInCalls);
        TimeSpan avgDif = new TimeSpan(0, 0, 0, 0, ((int)m_totalDif.TotalMilliseconds / m_csNumLines));
        double totalTime = m_csNumLines * avgDif.TotalSeconds;
        double timeLeft = totalTime - (DateTime.Now.Subtract(m_Form2Start).TotalSeconds);
        Console.WriteLine("TotalEstTime: " + totalTime + " TimeLeft: " + timeLeft);

        // Update the progress label
        resultLabel.Text = "Line " + e.ProgressPercentage.ToString() + " of " + m_csNumLines + " at " + (int)(100 * (double)e.ProgressPercentage / m_csNumLines) + "% loaded";
    } 
```

我遇到的问题是我的 TotalTime 随着处理的行数显着增加。在 1437 行字符串中，它开始时说我有 1.4 秒，最后估计还剩 18.6 秒。虽然实际上需要 16.54 秒才能完成。

我的第二个问题是剩下的时间并没有真正改变。它在大约 1.1 和 2.5 之间波动。

可以归因于什么？可能是什么问题呢？

这是完整的代码： http: [//pastebin.com/x1CCceY7](http://pastebin.com/x1CCceY7)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T16:23:44.723

问题是您正在处理最后的进度时间，这可能会随着您的进行而波动。如果您从开始时间和当前时间开始工作，并使用完成百分比，那么您会发现时间会随着您的移动而“自我调整”。

例如，如果您存储`DateTime.Now`到一个变量中（例如`m_operationStart`，使用您的命名），您可以编写：

```
private void backgroundWorker1_ProgressChanged(object sender, ProgressChangedEventArgs e)
{
  if (e.ProgressPercentage != 0)
  {
    double percentageComplete = (double)e.ProgressPercentage / m_csNumLines;

    TimeSpan timeSinceStart = DateTime.Now.Subtract(m_operationStart);
    TimeSpan totalTime = TimeSpan.FromMilliseconds(timeSinceStart.TotalMilliseconds / percentageComplete);
    TimeSpan timeLeft = totalTime - timeSinceStart;

    Console.WriteLine("TotalEstTime: " + totalTime + " TimeLeft: " + timeLeft);

    // Update the progress label
    resultLabel.Text = "Line " + e.ProgressPercentage.ToString() + " of " + m_csNumLines + " at " + (int)(100.0 * percentageComplete) + "% loaded";
  }
  else
    resultLabel.Text = "Line " + e.ProgressPercentage.ToString() + " of " + m_csNumLines;
} 
```

# android - Android：查找内存泄漏的工具？

> ID：12041297
> 
> 赞同：4
> 
> 时间：2012-08-20T16:14:43.167
> 
> 标签：android, memory, memory-management, memory-leaks, valgrind

是否有一些有用的工具可以检测 Android Java 应用程序中的内存泄漏？类似于 Valgrind 的东西，其中显示了非释放对象的创建位置？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T16:16:46.700

观看：[http ://www.youtube.com/watch?v=_CruQY55HOk](http://www.youtube.com/watch?v=_CruQY55HOk)

然后为 Eclipse 安装[MAT](http://www.eclipse.org/mat/)。狩猎快乐！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-20T16:15:57.907

在 Android 开发者博客上阅读这篇文章，它有你需要的东西 [http://android-developers.blogspot.com/2011/03/memory-analysis-for-android.html](http://android-developers.blogspot.com/2011/03/memory-analysis-for-android.html)

# iphone - iOS 静态框架和静态库

> ID：12041299
> 
> 赞同：2
> 
> 时间：2012-08-20T16:14:49.553
> 
> 标签：iphone, objective-c, ios, xcode, static-libraries

这个[链接](http://blog.bugsense.com/post/12330021520/creating-a-framework-for-ios)讨论了如何创建 iOS 静态框架，他们说

> 对于静态库，您必须单独分发其他所有内容（包括头文件）。

实际上我发现使用静态库和框架之间没有区别，你可以看看 Admob SDK ( [https://developers.google.com/mobile-ads-sdk/docs/](https://developers.google.com/mobile-ads-sdk/docs/) )，他们要求的只是将所有文件拉入XCode 项目，所以我真的不明白为什么我们需要使用框架而不是简单的静态库，或者我错过了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T16:36:32.663

基本上，框架是一组静态库（例如，一个用于 i386，一个用于 ARM）和头文件。此外，框架也是一个具有非常明确的结构的特殊文件夹。

我不确定你所说的“只在 Xcode 中添加文件夹”是什么意思......如果你的意思是添加一个包含所有源代码的文件夹或一个包含静态库的文件夹，包括你正确的头文件（通常) 并没有太大的区别（取决于要包含的库）。

使用框架主要是可用性方面的事情。添加一个框架，也就是添加一个工件，比添加一堆文件更不容易出错。例如，不可能意外遗漏一个头文件。

# regex - Vim 中是否有 :s[ubstitute] 的标志不会保存模式？

> ID：12041302
> 
> 赞同：5
> 
> 时间：2012-08-20T16:14:56.647
> 
> 标签：regex, vim, substitution

我正在尝试创建一个`autocmd`当我退出插入模式时将替换文件中所有空格的内容。但是，AFAIK 会让 Vim 记住该模式并删除其中已有的内容。

```
" Add function for remove tailing whitespaces
command! CleanupTrailingSpaces :%s/\s\+$//ge | :nohlsearch
autocmd InsertLeave * :CleanupTrailingSpaces 
```

是否有一个标志`:s[ubstitute]`会使其不保存模式？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-20T16:28:53.893

这样的标志会很有用，但还不存在。但是，您可以像这样保存和重置寄存器：

```
" Add function for remove tailing whitespaces
command! CleanupTrailingSpaces let reset = @/ | %s/\s\+$//ge | let @/ = reset | nohlsearch
autocmd InsertLeave * :CleanupTrailingSpaces 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-20T16:52:12.510

我从[vimcasts](http://vimcasts.org/episodes/tidying-whitespace/)得到了类似的东西。:-)

```
function! <SID>StripTrailingWhitespaces()
    " Preparation: save last search, and cursor position.
    let _s=@/
    let l = line(".")
    let c = col(".")
    " Do the business:
    %s/\s\+$//e
    " Clean up: restore previous search history, and cursor position
    let @/=_s
    call cursor(l, c)
endfunction

nnoremap <silent> <F5> :call <SID>StripTrailingWhitespaces()<CR>
autocmd BufWritePre *.py,*.js :call <SID>StripTrailingWhitespaces() 
```

# css - Base64 编码的网页字体

> ID：12041304
> 
> 赞同：1
> 
> 时间：2012-08-20T16:15:05.693
> 
> 标签：css, performance, browser, base64, webfonts

我正在动态地将一个大的（大约 170Kb）CSS 字符串添加到 <style> 块中。它很大，因为它在@font-family 规则中包含许多base64 编码的字体。

执行此操作所需的时间因浏览器而异 - 在移动设备上尤其慢。我对大部分时间可能发生的事情感兴趣。是浏览器解码 base64 字符串很慢，还是解析、应用和绘制字体到屏幕？

有没有人对浏览器可能正在做的事情有任何见解，或者我如何在 Chrome 或其他浏览器中进行低级别的分析？

# sql - 基本 SQL - 显示特定项目的所有值

> ID：12041305
> 
> 赞同：2
> 
> 时间：2012-08-20T16:15:07.220
> 
> 标签：sql

我对 SQL 完全陌生，所以我想我的问题很简单，但到目前为止我无法自己执行所需的输出。

我做了一个调查，让 3 个人解决任务 A（有 3 个任务）和 3 人解决任务 B（有 3 个任务）。

然后我做了一个看起来像这样的表：

```
Table: Results
+---------+---------+---------+---------+---------+
| ID      | AssgnID | Answer1 | Answer2 | Answer3 |
+---------+---------+---------+---------+---------+
| 1       | A1      | 20      | 45      | 80      |   
| 2       | A1      | 22      | 40      | 82      |  
| 3       | A1      | 25      | 39      | 85      |
| 4       | A2      | 45      | 10      | 75      |
| 5       | A2      | 50      | 15      | 72      |
| 6       | A2      | 50      | 12      | 80      |
+---------+---------+---------+---------+---------+ 
```

我现在要做的是，为 AssgnID A1 和 A2 显示一行中的所有答案，如下所示：

```
Table: Results per AssgnID
+---------+---------+---------+---------+---------+--------+---------+---------+--------+---------+---------+
| ID      | AssgnID | Answer1 | Answer2 | Answer3 |Answer4 | Answer5 | Answer6 |Answer7 | Answer8 | Answer9 |
+---------+---------+---------+---------+---------+---------+---------+---------+-------+---------+---------+
| 1       | A1      | 20      | 45      | 80      | 22     | 40      | 82      | 22     | 40      | 82          
| 2       | A2      | 45      | 10      | 75      | 50     | 15      | 72      | 50     | 12      | 80                  
+---------+---------+---------+---------+---------+---------+---------+---------+-------+---------+---------+ 
```

我可以通过使用 DISTINCT 或 GROUP BY 显示不同的 AssgnID，但我无法在同一输出中显示所有结果。

我必须尝试使用​​ JOIN 吗？

我非常感谢你的帮助。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T16:29:33.897

如果您愿意接受您的答案列表作为逗号分隔列表而不是实际列，您可以使用 PostgreSQL`string_agg()`通过将每行的三个答案列连接成一个单元来强制它们进入列表，然后将所有这些组合在一起：

```
SELECT 
  AssgnID,
  /* Concat the 3 answers together with `,`, the group all rows together separated by `,` */
  string_agg((Answer1 || ',' || Answer2 || ',' || Answer3), ',') AS Answers
FROM yourtable
GROUP BY AssgnID 
```

会产生：

```
A1   20,45,80,22,40,82,22,42,82
A2   45,10,75,50,15,72,50,12,80 
```

但是，如果您需要执行额外的 SQL 操作，最好的做法和最好的永久解决方案是重新设计您的表结构，以便以规范化的方式存储这些答案。此方法在一个表中定义调查，另一个表每个答案保存一行，或每个答案保存三行`SurveyID`。

### 表调查

```
SurveyID
AssgnID
UserID 
```

### 表答案

```
SurveyID
Answer
Value 
```

# visual-studio-2010 - 从 SharePoint 下载页面以部署到另一个 SharePoint 站点

> ID：12041312
> 
> 赞同：0
> 
> 时间：2012-08-20T16:16:00.457
> 
> 标签：visual-studio-2010, sharepoint-2010, sharepoint-designer

我可以使用任何工具或方法将 .aspx 页面从 SharePoint 下拉到 Visual Studio 中吗？

我正在开发环境中开发一个 SharePoint 网站，以便在其他几个位置使用。我创建的所有内容都需要以编程方式创建，以便我可以在多个位置快速部署和测试。

我最熟悉使用网站和 SharePoint Designer 进行 SharePoint 开发。我希望能够将我在网站上开发的页面拉下来，这样我就可以将这些页面部署到其他位置并在 Visual Studio 中进行修改。

我要避免的是创建功能来自定义构建我网站上的每个页面。我更愿意按照我习惯的方式设计页面，然后部署它们。

我了解 SharePoint 2010 使用重影并将内容存储在数据库中，因此这可能不是一件容易的事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T20:59:53.987

将内容从 sharepoint 导入到 Visual Studio 的一种简单方法是从头开始创建站点模板并将其作为 wsp 解决方案在 Visual Studio 下导入。

一个好的起点：http: [//msdn.microsoft.com/en-us/library/ee231603.aspx](http://msdn.microsoft.com/en-us/library/ee231603.aspx)

# django - 如何让 Django 测试用例和 Selenium 服务器使用相同的数据库？

> ID：12041315
> 
> 赞同：11
> 
> 时间：2012-08-20T16:16:22.443
> 
> 标签：django, selenium, integration-testing

我有一个 Django（v1.4，使用 Postgresql）项目，我为此编写了一堆工作单元测试。这些使用[FactoryBoy](https://github.com/dnerdy/factory_boy)来生成大部分数据。

我现在开始使用[LiveServerTestCase](https://docs.djangoproject.com/en/1.4/topics/testing/#django.test.LiveServerTestCase)和 Selenium 编写一些集成测试。我刚刚意识到我的测试和实时测试服务器使用不同的数据库。这意味着我的测试中工厂创建的数据对 Selenium 不可用。

我不确定进步的最佳方式。我*想*我可以使用固定装置来提供可以工作的数据，尽管使用工厂来代替这很痛苦。

有没有办法可以继续使用工厂来生成适用于我的 Selenium 测试的数据？真的，我希望我的测试和 LiveServerTestCase 使用相同的数据库。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-08-01T13:49:58.290

我发现了为什么这会发生在我身上，以及一些可能的解决方法，包括上面 Ilya Baryshev 的回答。

如果您的测试源自 Django `TestCase`，并且您的数据库支持事务，那么每个测试都在其自己的事务中运行，并且外部的任何人（没有其他线程、外部进程或其他测试）都无法看到您的测试在数据库中创建的对象。

`LiveServerTestCase`使用线程，所以它会遇到这个问题。所以设计者让它继承自`TransactionTestCase`而不是`TestCase`，这会禁用这些事务，因此更改是全局可见的。

发生在我身上的是，我在我的测试类中添加了一些 mixin，其中一个加入了`TestCase`. 这不会导致错误，但它会默默地替换`LiveServerTestCase`with的基类`TestCase`，这会再次启用事务，从而导致您描述的问题。

Ilya 的 SQLite 内存数据库解决方法之所以有效，是因为 Django 包含检测何时使用`:memory:`实际上在线程之间共享相同连接的 SQLite 数据库的代码，因此您可以在其中看到测试的对象，`LiveServerThread`因为它们位于**同一**事务中。然而，这有一些警告：

> **防止两个线程通过此共享连接同时进行数据库查询很重要，因为这有时可能会随机导致测试失败。**所以需要保证两个线程不会同时访问数据库。特别是，这意味着在某些情况下（例如，在单击链接或提交表单之后），您可能需要检查 Selenium 是否接收到响应以及是否已加载下一页，然后再继续执行进一步的测试。例如，通过让 Selenium 等到在响应中找到 HTML 标记来执行此操作（需要 Selenium > 2.13）...

[https://docs.djangoproject.com/en/1.4/topics/testing/#live-test-server](https://docs.djangoproject.com/en/1.4/topics/testing/#live-test-server)

`autocommit`在我的例子中，一旦我们在测试开始时关闭了标识符，并追踪了原因（因为我们输入`TestCase`了不应该做的代码），我们就能够修复继承层次结构以避免拉入`TestCase`，并且然后从实时服务器线程和测试中都可以看到同一个数据库。

这也适用于 Postgres 数据库，因此它将为 velotron 提供解决方案。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-10T14:38:28.610

您是否尝试过使用 sqlite 作为测试的数据库后端？

> 当使用内存中的 SQLite 数据库运行测试时，相同的数据库连接将由两个线程并行共享：运行实时服务器的线程和运行测试用例的线程。

来自[Django 文档](https://docs.djangoproject.com/en/1.4/topics/testing/#django.test.LiveServerTestCase)

如果您没有使用常规 ORM 之外的任何东西，那么您也可能会从测试加速中受益。

# string - matlab如何检查工作区中是否存在具有字段的结构

> ID：12041318
> 
> 赞同：8
> 
> 时间：2012-08-20T16:16:41.757
> 
> 标签：string, matlab, structure

我有一个字符串，想检查工作区中是否存在任何同名的变量。在工作区中，我还有许多结构 MNO MNN MNM 等。我只能检查是否存在名为 M 的变量。如何更深入地了解这个结构？我试过了：

```
exist('M.N')
YesNo = any(strcmp(who,'M.N.O'))
evalin('base','exist(''M.N.O'',''var'')') 
```

所有人都给我同样的问题，所以我被卡住了。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-20T16:23:46.703

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-20T17:07:18.560

一种选择：编写一个递归函数将结构扩展到它们的叶子字段，将字段附加到列表中。

（未经测试的概念代码 - 可能无法正常工作）

```
function varlist = getStructFields(var,varlist)
if isstruct(var)
    fn = fieldnames(var);
    varlist = vertcat(varlist,fn); %# append fields to the list
    for field = fn' %# ' create row vector; iterate through fields
         varlist = getStructFields(var.(char(field)), varlist); %# recursion here 
    end
end
end 
```

然后你可以使用`any(strcmp(who,'M.N.O'))`你已经想出的支票。

# sql-server - 按非连续日期范围唯一标识分组数据

> ID：12041321
> 
> 赞同：0
> 
> 时间：2012-08-20T16:16:47.893
> 
> 标签：sql-server

请帮忙，我的一个 MSSQL 数据表中有以下数据。

ID |开始日期时间 |结束日期时间 |订单号|
1 |12-08-01 08:00 |12-08-01 08:00 |6001 |
5 |12-08-01 09:00 |12-08-01 10:00 |6001 |
7 |12-08-01 10:00 |12-08-01 11:00 |6001 |
10 |12-08-01 11:00 |12-08-01 12:00 |6002 |
15 |12-08-01 12:00 |12-08-01 13:00 |6002 |
22 |12-08-01 13:00 |12-08-01 14:00 |6003 |
29 |12-08-01 14:00 |12-08-01 15:00 |6001 |
33 |12-08-01 15:00 |12-08-01 16:00 |6001 |
36 |12-08-01 16:00 |12-08-01 17:00 |6004 |

问题是目前我无法判断 OrderNo 是否已被多次使用。我不能说订单 6001 已经运行了两次。

从现在开始，我希望能够添加一个新字段来唯一标识每次运行的订单。但也可以回顾以前的记录并更新它们。

ID |StartDateTime |EndDateTime |OrderNo|Run|
1 |12-08-01 08:00 |12-08-01 08:00 |6001 |1 |
5 |12-08-01 09:00 |12-08-01 10:00 |6001 |1 |
7 |12-08-01 10:00 |12-08-01 11:00 |6001 |1 |
10 |12-08-01 11:00 |12-08-01 12:00 |6002 |1 |
15 |12-08-01 12:00 |12-08-01 13:00 |6002 |1 |
22 |12-08-01 13:00 |12-08-01 14:00 |6003 |1 |
29 |12-08-01 14:00 |12-08-01 15:00 |6001 |2 |
33 |12-08-01 15:00 |12-08-01 16:00 |6001 |2 |
36 |12-08-01 16:00 |12-08-01 17:00 |6004 |1 |

这个想法是我可以按 OrderNo 和 Run 分组，并将收到以下内容。

订单号 |运行 |运行开始 |运行结束 |
6001 | 1 |12-08-01 08:00 |12-08-01 11:00 |
6001 | 2 |12-08-01 14:00 |12-08-01 16:00 |
6002 | 1 |12-08-01 11:00 |12-08-01 13:00 |
6003 | 1 |12-08-01 13:00 |12-08-01 14:00 |
6004 | 1 |12-08-01 16:00 |12-08-01 17:00 |

我尝试了多种方法使用 ROW_NUMBER、CTE、游标等来运行数据。我觉得有一个简单的解决方案，但我无法弄清楚。

我希望这是有道理的。

**编辑**

我已经更改了数据表以引用一个额外的并发症，我第一次没有包括在内。Aaron 提供的解决方案可以正常工作。但它假设运行最多只能持续 2 小时（或行）。在我的数据库中，这些运行 n 小时（或行）。对不起，我第一次不清楚，我感谢迄今为止提供的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T16:35:21.473

您的编辑实际上使问题对我来说更简单（可能只是因为我最初错过了一个更简单的岛屿方法）。

```
;WITH x AS 
(
  SELECT OrderNo, StartDateTime, EndDateTime,
    rn1 = ROW_NUMBER() OVER (ORDER BY StartDateTime), 
    rn = ROW_NUMBER() OVER (PARTITION BY OrderNo ORDER BY StartDateTIme)
  FROM dbo.table_name -- you need to change this
),
y AS
(
  SELECT OrderNo, Island = rn1 - rn, 
    rs = MIN(StartDateTime), 
    re = MAX(EndDateTime) 
  FROM x GROUP BY OrderNo, rn1 - rn
)
SELECT 
  OrderNo, 
  Run = ROW_NUMBER() OVER (PARTITION BY OrderNo ORDER BY rs),
  RunStart = rs, 
  RunEnd = rs
FROM y
ORDER BY OrderNo, Run; 
```

* * *

把我原来的答案留给后代。

* * *

可能有一种更简单的方法，但这会得到您使用窗口函数后的答案。

```
;WITH x AS 
(
  SELECT ID, StartDateTime, EndDateTime, OrderNo,
    rn = ROW_NUMBER() OVER (PARTITION BY OrderNo ORDER BY StartDateTime) 
  FROM dbo.table_name -- you need to change this
), y AS
(
  SELECT x.ID, x.StartDateTime, x.EndDateTime, x.OrderNo, x.rn,
      x2ID = x2.ID, x2S = x2.StartDateTime, x2E = x2.EndDateTime, 
      x2O = x2.OrderNo, x2rn = x2.rn
  FROM x LEFT OUTER JOIN x AS x2
  ON x.OrderNo = x2.OrderNo
  AND x.rn = x2.rn - 1
  AND x.ID = x2.ID - 1
)
SELECT 
  OrderNo, 
  Run = ROW_NUMBER() OVER (PARTITION BY OrderNo ORDER BY StartDateTime),
  RunStart = StartDateTime, 
  RunEnd = COALESCE(x2E, EndDateTime) 
FROM y
WHERE x2ID IS NOT NULL 
OR NOT EXISTS 
(
  SELECT 1 FROM y AS y2 WHERE y2.OrderNo = y.OrderNo AND y2.x2rn = y.rn
)
ORDER BY OrderNo, Run; 
```

# javascript - 使用 jQuery 更改提交的值 onSubmit

> ID：12041328
> 
> 赞同：1
> 
> 时间：2012-08-20T16:17:03.567
> 
> 标签：javascript, jquery, html

我有两个字段通常可以正常工作并提交。他们的 ID 和名称是 'location_names' 和 'sub_cat'

我的脚本是完整的，除了我希望仅当值为“-10”时才忽略“sub_cat”字段值（现在完全忽略），并且如果值为“不是”则替换“location_names” -10'。我有几次失败的尝试，他们都只是忽略这些值或返回 null。我想知道我是否应该改用常规的javascript？任何帮助都将不胜感激。

代码说明：

```
 onSubmit{
 if (sub_cat != '-10') {
 location_names.value = sub_cat.value;
 }
 else {
 // do nothing
 }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T16:23:44.910

你的意思是[这样](http://jsfiddle.net/959JY/)的？

*   “return false”语句会阻止您实际提交表单
*   基本上，通过在 JavaScript (jQuery) 中创建 $("#form").submit 事件处理程序，您将能够在实际将数据提交到服务器之前捕获事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T16:21:39.623

我想你应该像下面这样在 JS 中对数字进行caparisoning

```
if (parseInt(sub_cat, 10) != -10) {
   location_names.value = sub_cat.value;
} 
```

希望这会帮助你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T16:25:45.767

我想 sub_cat 是元素，即`sub_cat = $('#sub_cat');`

在这种情况下：

```
onSubmit {

    if (parseInt(sub_cat.val(), 10) != -10)
         location_names.val() = sub_cat.val();

    // Add this if you don't want to submit the form when the value is -10.
    return false;

} 
```

# javascript - 如何在css工作表中使用js文件中的数字？

> ID：12041331
> 
> 赞同：2
> 
> 时间：2012-08-20T16:17:12.800
> 
> 标签：javascript, html, css

我想在 css 表中使用 js 中计算的数字。

我有这个js：

```
<script type="text/javascript">

//js cut out here

//document.write('<p>Your viewport width is '+viewportwidth+'x'+viewportheight+'</p>');
alert('<p>Your viewport width is '+viewportwidth+'x'+viewportheight+'</p>');

//-->
</script> 
```

有警告，其中 viewportwidth 显示浏览器的宽度，viewportheight 显示浏览器窗口的高度。我想使用这些数字是这样的样式表：

```
<style type="text/css">
html, body, 
#page {
    width:   100%;
    height:  100%;
    margin:  0;
}
#map_canvas {
    width:   (viewportwidth-200) px;
    height:  viewportheight;
}
#sidebar {
    width:200px;
    height:viewportheight px;
    overflow:auto;
}
</style> 
```

有可能做到这一点吗？

我发现了这个：[将 Javascript 变量解析为 CSS 变量](https://stackoverflow.com/questions/5424824/pass-javascript-variable-to-css-variables)

但我无法让它工作

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T16:33:07.043

[您可以使用JavaScript](http://www.universalwebservices.net/web-programming-resources/javascript/modify-css-with-javascript)修改特定元素的样式：

```
document.getElementById('map_canvas').style.width = "800px"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T16:28:26.423

您不能使用 JS 更改 CSS 样式表。但是，您可以通过将内联样式应用于元素或`<style>`在原始样式表之后附加新标签来覆盖样式表。

使用你的`viewportheight`变量...

**选项一：**

```
myEl.style.height = viewportheight + 'px'; 
```

**选项二：**

```
var style = document.createElement('style');
style.type = 'text/css'; style.rel = 'stylesheet';
style.innerHTML = '#map_canvas { height: ' + viewportheight + 'px; }';
document.head.appendChild(style); 
```

此外，[LESS](http://lesscss.org/)可能会引起一些兴趣。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T16:42:57.073

如果你有能力使用 jQuery，这是你最好的选择。该`.width()`函数将为您提供对象的当前宽度，包括窗口，也可用于设置对象的宽度。您还可以在事件上设置一个处理程序，`.resize()`以在对象（包括窗口）发生调整大小时也不断调整对象的大小。

我创建了一个[jsFiddle](http://jsfiddle.net/mQJwz/3/)演示代码。

在示例中，我在文档加载时设置了大小，然后在窗口调整大小事件上设置了一个处理程序，以不断调整`div`示例中的大小。这是为您实际调整大小的 JavaScript/jQuery 代码。

```
$(document).ready(function() {
    adjustCanvasSize();

    $(window).resize(function() {
        adjustCanvasSize();
    });
});

function adjustCanvasSize() {
    var win = $(window);
    var width = win.width();
    var height = win.height();   
    var canvas = $('#map_canvas');
    canvas.width(width - 200);
    canvas.height(height);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T17:11:02.563

目前，您能做的最好的事情就是在 JavaScript 中设置样式（并在视口更改时更新它）。CSS3 确实添加了`vw`和`vh`单位，让您分别指定相对于视口宽度和高度的长度。结合`calc`功能，你可以为所欲为。不过，这实际上只是为了供将来参考，因为它们都是实验性的，旧版浏览器尚不支持（请参阅[http://caniuse.com/viewport-units](http://caniuse.com/viewport-units)和[http://caniuse.com/calc](http://caniuse.com/calc)）。

另外，请记住`vw`和`vh`是百分比，所以整个宽度是`100vw`。

```
<style type="text/css">
html, body, 
#page {
    width:   100%;
    height:  100%;
    margin:  0;
}
#map_canvas {
    width:  -webkit-calc(100vw - 200px);
    width:  -moz-calc(100vw - 200px);
    width:  calc(100vw - 200px);
    height: 100vh;
}
#sidebar {
    width:    200px;
    height:   100vh;
    overflow: auto;
}
</style> 
```

# android - 访问文件夹/文件结构以获取资源

> ID：12041333
> 
> 赞同：0
> 
> 时间：2012-08-20T16:17:18.720
> 
> 标签：android, android-resources, android-assets

我的各种可绘制文件夹中有一个文件夹结构，例如可绘制、可绘制-hdpi 等。

就像是：

```
drawable-hdpi
├── folder_main
│   ├── sub_folder_1
│   │   ├── 1.png
│   │   └── 2.png
│   ├── sub_folder_2
│   │   ├── 1.png
│   │   └── 2.png
│   └── sub_folder_3
│       ├── 1.png
│       └── 2.png
└── ic_launcher.png 
```

访问这些资源将是动态的并以编程方式完成。我需要一种方法来访问这些子文件夹 png 资源。

`ic_launcher`使用以下命令可以直接访问： `R.drawable.ic_launcher`。从逻辑上讲，我认为您应该能够访问以下资源：

```
R.drawable.folder_main.sub_folder_1.1 
```

但这显然不起作用，并且在子文件夹和文件是动态的情况下也不会以编程方式工作。

在此先感谢您的任何指点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T16:29:21.303

您不能在资源文件夹中创建子文件夹。层次结构必须保持平坦。我认为它甚至不会编译。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T18:35:04.987

发布我的问题后不久，我发现了这个堆栈溢出资源：

[http://www.stackoverflow.com/a/10170925/321697](http://www.stackoverflow.com/a/10170925/321697)

这和这里的答案解决了我与文件夹/文件结构有关的第一个问题。

然后我需要一种方法来处理这些资源。我这样做如下：

我将文件结构更新为：

```
drawable-hdpi
    ->name_1_0.png
    ->name_1_1.png
    ->name_1_2.png
    ->name_2_0.png
etc 
```

然后我使用以下代码访问了这些文件：

```
int folder = 1;
int image = 0;
int resourceIdentifier = resources.getIdentifier("name_"+folder+"_"+image,"drawable","*whateveryourpackageiscalled"); 
```

> 注意：*whateveryourpackageis called = com.yourwebsite.etc

这样我就可以通过改变`folder`和`image`变量来动态访问我需要的图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T16:36:20.623

不，Android**不允许**在资源文件夹中嵌套层次结构。如果你尝试这样的事情，你会立即得到编译错误。不幸的是，不能在资源文件夹中创建子文件夹。

# ruby-on-rails - Mocha Rails 怪异

> ID：12041335
> 
> 赞同：0
> 
> 时间：2012-08-20T16:17:24.813
> 
> 标签：ruby-on-rails, testing, mocha.js

我在使用 Mocha 和 Rails 3.1.0 的 Rails 测试中看到非常奇怪的输出。

```
not all expectations were satisfied
  unsatisfied expectations:
    - expected exactly once, not yet invoked: #<GitAccess:0xbb5c344>.branches(any_parameters)
  satisfied expectations:
    - allowed any number of times, invoked once: #<GitAccess:0xbb5c344>.branches(any_parameters) 
```

它说我的“分支”方法从未被调用过，而是被调用过一次——在同一个对象上？这怎么可能？我的控制器如下所示：

```
def create
  git_access.branches()
end 
```

我完全不明白这怎么可能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T18:49:36.853

好的，这就是答案。我不知何故认为 .expects 只会检查函数是否被调用。所以在我的测试中，我在同一个函数调用上有 .expects 和 .stubs，这使得 mocha 忽略了我的 .stubs。

通过在线阅读一堆教程，当您想要伪造方法的响应时应该使用 .stubs ，而当您想要伪造方法的响应并测试是否调用该方法时，应该使用 .expects 。

# sql-server-2008 - SQL Server Web 同步 - replisapi?diag 不会运行 - 只是尝试下载

> ID：12041337
> 
> 赞同：0
> 
> 时间：2012-08-20T16:17:28.937
> 
> 标签：sql-server-2008, web, merge, synchronization, replication

我正在尝试在 2 台服务器之间设置 SQL Server 2008 Web 同步，并按照 MSDN 上的说明逐步操作，此处：[http ://technet.microsoft.com/en-us/library/ff714039.aspx](http://technet.microsoft.com/en-us/library/ff714039.aspx)

一切都很好，直到我进入“测试与 replisapi.dll 的连接”部分 - 当我进入 时`https://my-server-name/sqlreplication/replisapi.dll?diag`，我得到一个用户名和密码提示，这很好，并且“该网站的安全性存在问题”证书'，这是我所期望的，因为我在开发过程中使用了自签名证书。

接下来，我希望看到一个诊断页面，但相反，我得到了浏览器的通用“您要打开还是保存 replisapi”消息，迫使我打开或保存它。

有谁知道我在这里想念什么？

提前谢谢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T18:09:45.757

.dll 文件正在下载吗？

这以前发生在我身上。我不得不使用 Aspnet_regiis.exe 实用程序修复我的 IIS 映射。运行此实用程序后，我能够查看诊断页面。

[http://www.idautomation.com/kb/aspx_error.html](http://www.idautomation.com/kb/aspx_error.html)

[http://support.microsoft.com/default.aspx?scid=kb;EN-US;q306005&GSSNB=1](http://support.microsoft.com/default.aspx?scid=kb;EN-US;q306005&GSSNB=1)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-18T05:10:17.993

问题：您的应用程序池中禁用了 32 位应用程序。

解决方案：要解决此问题，请单击应用程序池，右键单击您的应用程序池并选择高级设置。将“启用 32 位应用程序”设置为“真”。最后是“停止”和“启动”应用程序池任务。

# hibernate - 为什么 Hibernate Cascadetype 默认为空数组

> ID：12041338
> 
> 赞同：1
> 
> 时间：2012-08-20T16:17:31.310
> 
> 标签：hibernate

这是一个新手问题。太幼稚请见谅

为什么 CascadeType 默认值为空而不是 SAVE。如果我创建一个对象 Publisher 然后向它​​添加一个对象 Book 为什么我不将它持久化到 DB。我只是想了解默认值未设置为 SAVE 的原因。

感谢您在这方面帮助我。

# qt - Qt - 几个 QTextBlock 内联

> ID：12041341
> 
> 赞同：5
> 
> 时间：2012-08-20T16:17:38.587
> 
> 标签：qt, qtextdocument

是否可以将 QTextDocument 中的多个 QTextBlocks 排列在一条水平线上？

我需要知道点击了哪个文本块，并且 QTextBlock 会很好用，因为它的方法 setUserState(int) 可以用来保存特定块的 id。有更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-11T13:30:34.830

不确定我的问题是否正确，但我正在尝试一下（在提出问题三年后......）

原则上，您可以`QTextBlocks`使用`QTextTable`. 如果您随后创建一个继承自`QTextEdit`您的类，则可以捕获鼠标事件并找出单击了哪个文本块。

我在下面发布了一些代码，其中我有一个非常简单的对话框，其中只有一个文本编辑（上面提到的派生类）。我创建了一个表格，在水平线上布置了三个文本块，并将它们的用户状态设置为列号。然后我只有带有重载`mouseEvent`方法的文本编辑类，它只将`userState`它所在的任何文本块打印到命令行，只是为了展示原理。

让我知道这是否有帮助或是否误解了您的问题。

**对话框.h**

```
#ifndef MYDIALOG_H
#define MYDIALOG_H

#include "ui_dialog.h"

class MyDialog : public QDialog, public Ui::Dialog
{
 public:
  MyDialog(QWidget * parent = 0, Qt::WindowFlags f = 0);
  void createTable();

};

#endif 
```

**对话框.cpp**

```
#include "dialog.h"

#include <QTextTable>
#include <QTextTableFormat>

MyDialog::MyDialog(QWidget * parent, Qt::WindowFlags f) :
QDialog(parent,f)
{
  setupUi(this);
}

void MyDialog::createTable()
{
  QTextCursor cursor = textEdit->textCursor();

  QTextTableFormat tableFormat;
  tableFormat.setCellPadding(40);
  tableFormat.setBorderStyle(QTextFrameFormat::BorderStyle_None);

  QTextTable* table=cursor.insertTable(1,3,tableFormat);
  for( int col = 0; col < table->columns(); ++col ) {
    cursor = table->cellAt(0, col).firstCursorPosition();
    cursor.insertBlock();
    cursor.block().setUserState(col);
    cursor.insertText(QString("Block in Column ")+QString::number(col));
  }

} 
```

**mytextedit.h**

```
#ifndef MYTEXTEDIT_H
#define MYTEXTEDIT_H

#include <QTextEdit>

class MyTextEdit : public QTextEdit
{
 public:
  MyTextEdit(QWidget * parent = 0);
  void mousePressEvent(QMouseEvent *event);
};
#endif 
```

**mytextedit.cpp**

```
#include "mytextedit.h"

#include <QMouseEvent>
#include <QTextBlock>
#include <QtCore>

MyTextEdit::MyTextEdit(QWidget * parent) :
  QTextEdit(parent)
{

}

void MyTextEdit::mousePressEvent(QMouseEvent *event)
{
  if(event->button() == Qt::LeftButton) {
    qDebug() << this->cursorForPosition(event->pos()).block().userState();
  }
} 
```

**main.cpp**（仅出于完整性考虑）

```
#include <QApplication>
#include "dialog.h"

int main(int argc, char** argv)
{
  QApplication app(argc,argv);
  MyDialog dialog;

  dialog.show();
  dialog.createTable();

  return app.exec();

} 
```

# php - 发布要删除的账户列表，确认删除再删除数据 PHP、Jquery

> ID：12041343
> 
> 赞同：0
> 
> 时间：2012-08-20T16:17:39.253
> 
> 标签：php, jquery, forms, post

步骤1

我有一个包含帐户列表的表单，这些帐户具有允许用户选择多个帐户以删除它们的复选框。

第2步

用户单击一些复选框，然后单击删除按钮，然后会弹出一个 Jquery UI 对话框，要求用户确认删除数据。

第 3 步

然后将发布的数据发送到 PHP 脚本，然后进行处理，从而删除正确的数据。

问题是步骤 2 中发布的数据是 PHP 脚本删除帐户所需的帐户 ID，然后当用户单击确认删除数据时该 ID 丢失。我想要一个确认对话框，但不知道如何将发布数据再次传递给 PHP 脚本。

我猜测它与在 Jquery 对话框表单中传递数据有关，但我不确定如何去做。

这是用于确认删除的 Jquery UI 对话框代码。

```
 <script type="javascript">
    $(function() {
            // a workaround for a flaw in the demo system    (http://dev.jqueryui.com/ticket/4375), ignore!
            $( "#dialog:ui-dialog" ).dialog( "destroy" );

            $( "#dialog-confirm" ).dialog({
                resizable: false,
                height:200,
                modal: true,
                buttons: {
                    Confirm: function() {
                        $( this ).dialog( "close" );

                        location.replace("<?php  echo   $_SERVER['PHP_SELF']."?delete=yes"; ?>"); 

                    },
                    Cancel: function() {
                        $( this ).dialog( "close" );
                        location.replace("<?php  echo  $_SERVER['PHP_SELF']."?delete=no"; ?>");

                    }

                }
            });
        });
</script>

    <div id="dialog-confirm" title="Empty the recycle bin?">
    <p>Are you sure you wanted to delete the selected accounts? and their related data?</p>
        <ul>
            <li>Account History</li>
            <li>PPC</li>
            <li>FTP</li>
            <li>Phone Number</li>
            <li>Phone Number Stats</li>
        </ul>

  </div> 
```

发布表单很好，它只是问题所在的对话框以及如何将数据通过 agian 获取到 PHP 脚本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T16:26:16.037

您可以执行以下操作：

1：创建一个 JS 函数（可以在所有表​​单上使用）并在需要的地方包含它。

```
 function confirmation(question)
  {
     return confirm(question + " (OK = Yes   Cancel = No)");
  } 
```

2：在有问题的表单上放置一个 onSubmit

```
 onSubmit="return confirmation('Do you really want to delete?');" 
```

如果用户单击 Ok 并提交表单，这将返回 true。如果用户单击取消，则返回 false 并且表单不会提交。

# android - 在 android pre ICS 中创建新的本地日历

> ID：12041346
> 
> 赞同：1
> 
> 时间：2012-08-20T16:17:47.317
> 
> 标签：android, calendar

我已经为此奋斗了好几个星期，所以现在我希望这里有人能给我一些澄清。

我正在从事的项目（ICS 之前）包括登录我公司的服务器，获取我未来的工作计划并将其存储在我的手机上的单独日历中。这个日历应该可以在所有主要的日历应用程序（Jorte、Business Calendar、Smooth Calendar ++）中查看。我将日程表解析并存储在手机上的 SQLite 数据库中。但我的努力是从那里开始创建一个单独的本地日历并将所有事件存储在那里。我以为我必须为此创建一个帐户（不要弄乱电话上的任何其他帐户。这与代码配合得很好：

```
AccountManager man = (AccountManager) getSystemService(ACCOUNT_SERVICE);
Account acc = new Account("myCalendar", "com.lumabyte.mycalendar"); 
```

但我认为在该帐户上创建日历会很容易：

```
ContentValues calendar = new ContentValues();
calendar.put("_sync_account", "myCalendar"); // My account
calendar.put("_sync_account_type","com.lumabyte.mycalendar"); 
calendar.put("name", "myCalendar");
calendar.put("displayName", "myCalendar");
calendar.put("hidden",0);
calendar.put("color",0xFF008080);
calendar.put("access_level", 700);
calendar.put("sync_events", 1);
calendar.put("timezone", "Europe/Paris");
calendar.put("ownerAccount", sync_account);
Uri calendarUri = Uri.parse(getCalendarUriBase() + "calendars");
this.getContentResolver().insert(calendarUri, calendar); 
```

函数 getCalendarUriBase()：

```
private String getCalendarUriBase() {

    String calendarUriBase = null;
    Uri calendars = Uri.parse("content://calendar/calendars");
    Cursor managedCursor = null;
    try {
        managedCursor = this.managedQuery(calendars, null, null, null, null);
    } catch (Exception e) {
        // eat
    }

    if (managedCursor != null) {
        calendarUriBase = "content://calendar/";
    } else {
        calendars = Uri.parse("content://com.android.calendar/calendars");
        try {
            managedCursor = this.managedQuery(calendars, null, null, null, null);
        } catch (Exception e) {
            // eat
        }

        if (managedCursor != null) {
            calendarUriBase = "content://com.android.calendar/";
        }

    }

    managedCursor.close();

    return calendarUriBase;
} 
```

清单包括：

```
 <uses-permission android:name="android.permission.AUTHENTICATE_ACCOUNTS"/>
  <uses-permission android:name="android.permission.USE_CREDENTIALS" /> 
  <uses-permission android:name="android.permission.MAMAGE_ACCOUNTS"/>
  <uses-permission android:name="android.permission.GET_ACCOUNTS" />    
  <uses-permission android:name="android.permission.READ_CALENDAR">
  <uses-permission android:name="android.permission.WRITE_CALENDAR"> 
```

我的authenticator.xml是这样的：

```
<?xml version="1.0" encoding="utf-8"?>
<account-authenticator xmlns:android="http://schemas.android.com/apk/res/android"  
    android:accountType="com.lumabyte.mycalendar"
    android:icon="@drawable/icon"
    android:smallIcon="@drawable/icon"
    android:label="@string/authenticator_label"
/> 
```

我没有收到任何错误消息，但只创建了帐户，而不是日历。代码中是否存在小错误，或者我误解了整个概念。我知道在 ICS 之前没有 API，并且存在风险。但无论如何我都需要完成它。最好在尽可能多的手机上保持稳定。任何帮助或示例将不胜感激。

稍后我将与 ICS 合作，因为我知道他们现在有我的公共 API。

r

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T07:13:59.893

hiii rudder............. 经过大量研发后，我在 2.3.6 中使用以下代码添加了一个日历......

```
ContentValues calendar=new ContentValues();
Uri calendarUri =Uri.parse(getBaseCalUri() + "/calendars");

calendar.put("_sync_account", "Test1");
calendar.put("_sync_account_type", "LOCAL");

    calendar.put("name", "CalenTest");
    calendar.put("displayName", "calDispName");
    calendar.put("color", 0xFF008080);
    calendar.put("access_level", 700);
    calendar.put("ownerAccount", true);
    calendar.put("sync_events", 1);

    calendarUri = calendarUri.buildUpon()
        .appendQueryParameter("_sync_account", "Test1")
        .appendQueryParameter("_sync_account_type", "LOCAL")  
        .build();
    Uri result = getContentResolver().insert(calendarUri, calendar); 
```

我的 getBaseCalUri() 是

```
private Uri getBaseCalUri(){
        Class<?> calendarProviderClass;
        Field uriField;
        Uri calendarUri=null;
        try {
            calendarProviderClass = Class.forName("android.provider.Calendar");
            uriField = calendarProviderClass.getField("CONTENT_URI");
            calendarUri = (Uri) uriField.get(null);
        } catch (ClassNotFoundException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (SecurityException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (NoSuchFieldException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IllegalArgumentException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IllegalAccessException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        return calendarUri;
    } 
```

尝试这个....

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T05:03:26.817

只需在 calendar.db /data/data/com.android.providers.calendar/databases/calendar.db 中添加一条记录作为 sqlite3 calendar.db "插入日历 (_id,name,displayName,access_level) 值 (0,'本地','MyCal',700)"

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-11-07T10:11:14.430

这是我尝试过的好方法，希望对您有所帮助：

/** * 添加日历事件。*/

```
private void addCalendarEvent(){
                    Context context = getContext();
                    Intent intent = new Intent(Intent.ACTION_EDIT);
            intent.setType("vnd.android.cursor.item/event");
            intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
            intent.putExtra("beginTime", stTime);
            intent.putExtra("allDay", true);
            intent.putExtra("description", description);
            intent.putExtra("eventLocation", place);
            intent.putExtra("rrule", "FREQ=YEARLY");
            intent.putExtra("endTime", enTime);
            intent.putExtra("title", category);
                    context.startActivity(intent);
} 
```

# ruby-on-rails - 使用 ActiveRecord 时 Rails 日志的格式

> ID：12041350
> 
> 赞同：6
> 
> 时间：2012-08-20T16:18:06.830
> 
> 标签：ruby-on-rails, activerecord, logging, ruby-on-rails-3.1, activeresource

所以我有一个之前不需要 ActiveRecord 的应用程序 - 因此我们从应用程序中删除了 ActiveRecord 并将我们的日志格式化为：

*在 application.rb 中：*

```
class DreamLogFormatter < Logger::Formatter
  SEVERITY_TO_COLOR_MAP   = {'DEBUG'=>'32', 'INFO'=>'0;37', 'WARN'=>'35', 'ERROR'=>'31', 'FATAL'=>'31', 'UNKNOWN'=>'37'}

  def call(severity, time, progname, msg)
    color = SEVERITY_TO_COLOR_MAP[severity]
    "\033[0;37m[%s] \033[#{color}m%5s - %s\033[0m\n" % [time.to_s(:short), severity, msg2str(msg)]
  end
end

class ActiveSupport::BufferedLogger
  def formatter=(formatter)
    @log.formatter = formatter
  end
end 
```

*开发中.rb*

```
config.logger = Logger.new("log/#{Rails.env}.log")
config.logger.formatter = DreamLogFormatter.new
ActiveResource::Base.logger =  Logger.new("log/#{Rails.env}.log")
ActiveResource::Base.logger.formatter = DreamLogFormatter.new 
```

**注意：**添加 ActiveResource 记录器配置是因为我们希望 ActiveResource 调用的 URL 输出如下所示：

```
GET http://localhost:2524/users/
 --> 200 OK 239 (13.0ms) 
```

使用此配置进行日志记录为我们提供了 ActiveResource 调用和我们自己使用`Rails.logger`.

但是，我们需要将 ActiveRecord 添加回我们的应用程序，因为我们需要将会话存储从 cookie 存储更改为 ActiveRecord 存储。并且由于重新添加 ActiveRecord，日志记录不再正常工作。

**以前的日志输出：**

```
Started GET "/audit/?key1=value1&key2=value2" for 0:0:0:0:0:0:0:1%0 at 2012-08-15 15:39:58 -0400
[15 Aug 15:39]  INFO -   Processing by AuditController#index as HTML
[15 Aug 15:39]  INFO -   Parameters: {"utf8"=>"✓", "key1"=>"value1", "key2"=>"value2"}
[15 Aug 15:39]  INFO - GET http://localhost:2524/api/users/jeff/prefs/?label=language
[15 Aug 15:39]  INFO - --> 200 OK 151 (55.0ms)
[15 Aug 15:39]  WARN - There is no user currently logged in - retrieving default theme.
[15 Aug 15:39]  INFO - GET http://localhost:2524/api/users/jeff/prefs/?label=theme
[15 Aug 15:39]  INFO - --> 200 OK 151 (35.0ms) 
```

**注意：**我真正喜欢这种格式的地方在于，每个请求都以`Started GET <URL>`POST 或 PUT 等开头，然后是哪个控制器和函数正在处理，以及发送的参数是什么。这对调试非常有帮助。同样，这种格式允许我们打印出我们自己的`Rails.logger`日志信息。

**当前日志输出**（使用 ActiveRecord）**：**

```
[20 Aug 11:40]  INFO - GET http://localhost:2524/api/users/jeff
[20 Aug 11:40]  INFO - --> 200 OK 199 (144.0ms)
[20 Aug 11:40]  INFO - GET http://localhost:2524/api/users/jeff/prefs/?label=language
[20 Aug 11:40]  INFO - --> 200 OK 148 (12.0ms)
[20 Aug 11:40]  INFO - GET http://localhost:2524/api/users/jeff/prefs/?label=theme
[20 Aug 11:40]  INFO - --> 200 OK 155 (15.0ms) 
```

本质上，我们现在得到的只是一个恒定的 URL 调用流——它不会记录来自的任何内容，`Rails.logger`并且不同的请求之间也没有分离——它实际上只是一个恒定的 URL 和响应流。

* * *

我已经尝试`ActiveResource::Base.logger = ActiveRecord::Base.logger`按照很多博客的建议进行设置，但这只会让事情变得更糟——它记录了几个 URL，然后完全停止记录，除非它处于 ERROR 级别（而且我没有在任何地方设置日志记录级别，所以它仍然应该默认）

任何帮助或建议将不胜感激！！谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T01:44:08.040

也许[lograge](https://github.com/roidrage/lograge)的实施会有所帮助：

[https://github.com/roidrage/lograge/blob/master/lib/lograge.rb#L57](https://github.com/roidrage/lograge/blob/master/lib/lograge.rb#L57)

# java - 迁移到 WAS 8.5 和 java 1.7 后的 javax.naming.ConfigurationException

> ID：12041353
> 
> 赞同：3
> 
> 时间：2012-08-20T16:18:14.737
> 
> 标签：java, spring, jdbc, struts2, websphere

我正在将我的应用程序从 java 1.5 和 WAS 6.1 迁移到 java 1.7 和 WAS 8.5 我收到以下异常。

```
[8/20/12 12:01:00:286 EDT] 0000006b SystemErr     R org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'xxxDa
taSource' defined in class path resource [applicationContext-datasources.xml]: Invocation of init method failed; nested exception is javax.naming
.ConfigurationException: NamingManager.getURLContext cannot find the factory for this scheme: java
[8/20/12 12:01:00:286 EDT] 0000006b SystemErr     R     at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBe
an(AbstractAutowireCapableBeanFactory.java:1338)
[8/20/12 12:01:00:286 EDT] 0000006b SystemErr     R     at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean
(AbstractAutowireCapableBeanFactory.java:473)
[8/20/12 12:01:00:286 EDT] 0000006b SystemErr     R     at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory$1.run(Abstra
ctAutowireCapableBeanFactory.java:409)
[8/20/12 12:01:00:286 EDT] 0000006b SystemErr     R     at java.security.AccessController.doPrivileged(AccessController.java:252)
[8/20/12 12:01:00:286 EDT] 0000006b SystemErr     R     at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(A
bstractAutowireCapableBeanFactory.java:380)
[8/20/12 12:01:00:286 EDT] 0000006b SystemErr     R     at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFac
tory.java:264)
[8/20/12 12:01:00:286 EDT] 0000006b SystemErr     R     at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(Defau
ltSingletonBeanRegistry.java:222)
[8/20/12 12:01:00:286 EDT] 0000006b SystemErr     R     at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFacto
ry.java:261)
[8/20/12 12:01:00:287 EDT] 0000006b SystemErr     R     at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory
.java:185)
[8/20/12 12:01:00:287 EDT] 0000006b SystemErr     R     at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory
.java:164)
[8/20/12 12:01:00:287 EDT] 0000006b SystemErr     R     at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingle
tons(DefaultListableBeanFactory.java:423)
[8/20/12 12:01:00:287 EDT] 0000006b SystemErr     R     at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitializ
ation(AbstractApplicationContext.java:728)
[8/20/12 12:01:00:287 EDT] 0000006b SystemErr     R     at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicatio
nContext.java:380)
[8/20/12 12:01:00:287 EDT] 0000006b SystemErr     R     at org.springframework.web.context.ContextLoader.createWebApplicationContext(ContextLoader.j
ava:255)
[8/20/12 12:01:00:287 EDT] 0000006b SystemErr     R     at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.jav
a:199)
[8/20/12 12:01:00:287 EDT] 0000006b SystemErr     R     at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderLis
tener.java:45)
[8/20/12 12:01:00:287 EDT] 0000006b SystemErr     R     at scv.cais.cms.jdr.webservice.context.ScvContextLoaderListener.contextInitialized(ScvContex
tLoaderListener.java:21)
[8/20/12 12:01:00:287 EDT] 0000006b SystemErr     R     at com.ibm.ws.webcontainer.webapp.WebApp.notifyServletContextCreated(WebApp.java:1651)
[8/20/12 12:01:00:287 EDT] 0000006b SystemErr     R     at com.ibm.ws.webcontainer.webapp.WebAppImpl.initialize(WebAppImpl.java:414)
[8/20/12 12:01:00:287 EDT] 0000006b SystemErr     R     at com.ibm.ws.webcontainer.webapp.WebGroupImpl.addWebApplication(WebGroupImpl.java:88)
[8/20/12 12:01:00:287 EDT] 0000006b SystemErr     R     at com.ibm.ws.webcontainer.VirtualHostImpl.addWebApplication(VirtualHostImpl.java:169)
[8/20/12 12:01:00:287 EDT] 0000006b SystemErr     R     at com.ibm.ws.webcontainer.WSWebContainer.addWebApp(WSWebContainer.java:746)
[8/20/12 12:01:00:287 EDT] 0000006b SystemErr     R     at com.ibm.ws.webcontainer.WSWebContainer.addWebApplication(WSWebContainer.java:634)
[8/20/12 12:01:00:287 EDT] 0000006b SystemErr     R     at com.ibm.ws.webcontainer.component.WebContainerImpl.install(WebContainerImpl.java:424)
[8/20/12 12:01:00:287 EDT] 0000006b SystemErr     R     at com.ibm.ws.webcontainer.component.WebContainerImpl.start(WebContainerImpl.java:718)
[8/20/12 12:01:00:287 EDT] 0000006b SystemErr     R     at com.ibm.ws.runtime.component.ApplicationMgrImpl.start(ApplicationMgrImpl.java:1170)
[8/20/12 12:01:00:288 EDT] 0000006b SystemErr     R     at com.ibm.ws.runtime.component.DeployedApplicationImpl.fireDeployedObjectStart(DeployedAppl
icationImpl.java:1370)
[8/20/12 12:01:00:288 EDT] 0000006b SystemErr     R     at com.ibm.ws.runtime.component.DeployedModuleImpl.start(DeployedModuleImpl.java:638)
[8/20/12 12:01:00:288 EDT] 0000006b SystemErr     R     at com.ibm.ws.runtime.component.DeployedApplicationImpl.start(DeployedApplicationImpl.java:9
68)
[8/20/12 12:01:00:288 EDT] 0000006b SystemErr     R     at com.ibm.ws.runtime.component.ApplicationMgrImpl.startApplication(ApplicationMgrImpl.java:
769)
[8/20/12 12:01:00:288 EDT] 0000006b SystemErr     R     at com.ibm.ws.runtime.component.ApplicationMgrImpl.startApplicationDynamically(ApplicationMg
rImpl.java:1364)
[8/20/12 12:01:00:288 EDT] 0000006b SystemErr     R     at com.ibm.ws.runtime.component.ApplicationMgrImpl.start(ApplicationMgrImpl.java:2169)
[8/20/12 12:01:00:288 EDT] 0000006b SystemErr     R     at com.ibm.ws.runtime.component.CompositionUnitMgrImpl.start(CompositionUnitMgrImpl.java:445
)
[8/20/12 12:01:00:288 EDT] 0000006b SystemErr     R     at com.ibm.ws.runtime.component.CompositionUnitImpl.start(CompositionUnitImpl.java:123)
[8/20/12 12:01:00:288 EDT] 0000006b SystemErr     R     at com.ibm.ws.runtime.component.CompositionUnitMgrImpl.start(CompositionUnitMgrImpl.java:388
)
[8/20/12 12:01:00:288 EDT] 0000006b SystemErr     R     at com.ibm.ws.runtime.component.CompositionUnitMgrImpl.access$500(CompositionUnitMgrImpl.jav
a:116)
[8/20/12 12:01:00:288 EDT] 0000006b SystemErr     R     at com.ibm.ws.runtime.component.CompositionUnitMgrImpl$1.run(CompositionUnitMgrImpl.java:663
)
[8/20/12 12:01:00:288 EDT] 0000006b SystemErr     R     at com.ibm.ws.security.auth.ContextManagerImpl.runAs(ContextManagerImpl.java:5339)
[8/20/12 12:01:00:288 EDT] 0000006b SystemErr     R     at com.ibm.ws.security.auth.ContextManagerImpl.runAsSystem(ContextManagerImpl.java:5555)
[8/20/12 12:01:00:288 EDT] 0000006b SystemErr     R     at com.ibm.ws.security.core.SecurityContext.runAsSystem(SecurityContext.java:255)
[8/20/12 12:01:00:288 EDT] 0000006b SystemErr     R     at com.ibm.ws.runtime.component.CompositionUnitMgrImpl.startCompositionUnit(CompositionUnitM
grImpl.java:677)
[8/20/12 12:01:00:288 EDT] 0000006b SystemErr     R     at com.ibm.ws.runtime.component.CompositionUnitMgrImpl.startCompositionUnit(CompositionUnitM
grImpl.java:621)
[8/20/12 12:01:00:288 EDT] 0000006b SystemErr     R     at com.ibm.ws.runtime.component.ApplicationMgrImpl.startApplication(ApplicationMgrImpl.java:
1256)
[8/20/12 12:01:00:288 EDT] 0000006b SystemErr     R     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[8/20/12 12:01:00:289 EDT] 0000006b SystemErr     R     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:88)
[8/20/12 12:01:00:289 EDT] 0000006b SystemErr     R     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:55)
[8/20/12 12:01:00:289 EDT] 0000006b SystemErr     R     at java.lang.reflect.Method.invoke(Method.java:613)
[8/20/12 12:01:00:289 EDT] 0000006b SystemErr     R     at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:67)
[8/20/12 12:01:00:289 EDT] 0000006b SystemErr     R     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[8/20/12 12:01:00:289 EDT] 0000006b SystemErr     R     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:88)
[8/20/12 12:01:00:289 EDT] 0000006b SystemErr     R     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:55)
[8/20/12 12:01:00:289 EDT] 0000006b SystemErr     R     at java.lang.reflect.Method.invoke(Method.java:613)
[8/20/12 12:01:00:289 EDT] 0000006b SystemErr     R     at sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:275)
[8/20/12 12:01:00:289 EDT] 0000006b SystemErr     R     at javax.management.modelmbean.RequiredModelMBean.invokeMethod(RequiredModelMBean.java:1196)
[8/20/12 12:01:00:289 EDT] 0000006b SystemErr     R     at javax.management.modelmbean.RequiredModelMBean.invoke(RequiredModelMBean.java:1060)
[8/20/12 12:01:00:289 EDT] 0000006b SystemErr     R     at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerIntercepto
r.java:831)
[8/20/12 12:01:00:289 EDT] 0000006b SystemErr     R     at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:803)
[8/20/12 12:01:00:289 EDT] 0000006b SystemErr     R     at com.ibm.ws.management.AdminServiceImpl$1.run(AdminServiceImpl.java:1335)
[8/20/12 12:01:00:289 EDT] 0000006b SystemErr     R     at com.ibm.ws.security.util.AccessController.doPrivileged(AccessController.java:118)
[8/20/12 12:01:00:289 EDT] 0000006b SystemErr     R     at com.ibm.ws.management.AdminServiceImpl.invoke(AdminServiceImpl.java:1228)
[8/20/12 12:01:00:289 EDT] 0000006b SystemErr     R     at com.ibm.ws.management.application.AppManagementImpl._startApplication(AppManagementImpl.j
ava:1482)
[8/20/12 12:01:00:289 EDT] 0000006b SystemErr     R     at com.ibm.ws.management.application.AppManagementImpl.startApplication(AppManagementImpl.ja
va:1371)
[8/20/12 12:01:00:289 EDT] 0000006b SystemErr     R     at com.ibm.ws.management.application.AppManagementImpl.startApplication(AppManagementImpl.ja
va:1320)
[8/20/12 12:01:00:289 EDT] 0000006b SystemErr     R     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[8/20/12 12:01:00:290 EDT] 0000006b SystemErr     R     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:88)
[8/20/12 12:01:00:290 EDT] 0000006b SystemErr     R     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:55)
[8/20/12 12:01:00:290 EDT] 0000006b SystemErr     R     at java.lang.reflect.Method.invoke(Method.java:613)
[8/20/12 12:01:00:290 EDT] 0000006b SystemErr     R     at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:67)
[8/20/12 12:01:00:290 EDT] 0000006b SystemErr     R     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[8/20/12 12:01:00:290 EDT] 0000006b SystemErr     R     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:88)
[8/20/12 12:01:00:290 EDT] 0000006b SystemErr     R     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:55)
[8/20/12 12:01:00:290 EDT] 0000006b SystemErr     R     at java.lang.reflect.Method.invoke(Method.java:613)
[8/20/12 12:01:00:290 EDT] 0000006b SystemErr     R     at sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:275)
[8/20/12 12:01:00:290 EDT] 0000006b SystemErr     R     at javax.management.modelmbean.RequiredModelMBean.invokeMethod(RequiredModelMBean.java:1196)
[8/20/12 12:01:00:290 EDT] 0000006b SystemErr     R     at javax.management.modelmbean.RequiredModelMBean.invoke(RequiredModelMBean.java:1060)
[8/20/12 12:01:00:290 EDT] 0000006b SystemErr     R     at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerIntercepto
r.java:831)
[8/20/12 12:01:00:290 EDT] 0000006b SystemErr     R     at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:803)
[8/20/12 12:01:00:290 EDT] 0000006b SystemErr     R     at com.ibm.ws.management.AdminServiceImpl$1.run(AdminServiceImpl.java:1335)
[8/20/12 12:01:00:290 EDT] 0000006b SystemErr     R     at com.ibm.ws.security.util.AccessController.doPrivileged(AccessController.java:118)
[8/20/12 12:01:00:290 EDT] 0000006b SystemErr     R     at com.ibm.ws.management.AdminServiceImpl.invoke(AdminServiceImpl.java:1228)
[8/20/12 12:01:00:290 EDT] 0000006b SystemErr     R     at com.ibm.ws.management.remote.AdminServiceForwarder.invoke(AdminServiceForwarder.java:346)
[8/20/12 12:01:00:290 EDT] 0000006b SystemErr     R     at javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1458)
[8/20/12 12:01:00:291 EDT] 0000006b SystemErr     R     at javax.management.remote.rmi.RMIConnectionImpl.access$200(RMIConnectionImpl.java:100)
[8/20/12 12:01:00:291 EDT] 0000006b SystemErr     R     at javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.j
ava:1303)
[8/20/12 12:01:00:291 EDT] 0000006b SystemErr     R     at javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.jav
a:1391)
[8/20/12 12:01:00:291 EDT] 0000006b SystemErr     R     at javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:823)
[8/20/12 12:01:00:291 EDT] 0000006b SystemErr     R     at javax.management.remote.rmi._RMIConnectionImpl_Tie.invoke(Unknown Source)
[8/20/12 12:01:00:291 EDT] 0000006b SystemErr     R     at javax.management.remote.rmi._RMIConnectionImpl_Tie._invoke(Unknown Source)
[8/20/12 12:01:00:291 EDT] 0000006b SystemErr     R     at com.ibm.CORBA.iiop.ServerDelegate.dispatchInvokeHandler(ServerDelegate.java:669)
[8/20/12 12:01:00:291 EDT] 0000006b SystemErr     R     at com.ibm.CORBA.iiop.ServerDelegate.dispatch(ServerDelegate.java:523)
[8/20/12 12:01:00:291 EDT] 0000006b SystemErr     R     at com.ibm.rmi.iiop.ORB.process(ORB.java:523)
[8/20/12 12:01:00:291 EDT] 0000006b SystemErr     R     at com.ibm.CORBA.iiop.ORB.process(ORB.java:1575)
[8/20/12 12:01:00:291 EDT] 0000006b SystemErr     R     at com.ibm.rmi.iiop.Connection.doRequestWork(Connection.java:2992)
[8/20/12 12:01:00:291 EDT] 0000006b SystemErr     R     at com.ibm.rmi.iiop.Connection.doWork(Connection.java:2875)
[8/20/12 12:01:00:291 EDT] 0000006b SystemErr     R     at com.ibm.rmi.iiop.WorkUnitImpl.doWork(WorkUnitImpl.java:64)
[8/20/12 12:01:00:291 EDT] 0000006b SystemErr     R     at com.ibm.ejs.oa.pool.PooledThread.run(ThreadPool.java:118)
[8/20/12 12:01:00:291 EDT] 0000006b SystemErr     R     at com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1783)
[8/20/12 12:01:00:291 EDT] 0000006b SystemErr     R Caused by: javax.naming.ConfigurationException: NamingManager.getURLContext cannot find the f
actory for this scheme: java
[8/20/12 12:01:00:291 EDT] 0000006b SystemErr     R     at com.ibm.ws.naming.util.Helpers.checkForUrlContext(Helpers.java:1631)
[8/20/12 12:01:00:291 EDT] 0000006b SystemErr     R     at com.ibm.ws.naming.util.WsnInitCtx.lookup(WsnInitCtx.java:160)
[8/20/12 12:01:00:292 EDT] 0000006b SystemErr     R     at com.ibm.ws.naming.util.WsnInitCtx.lookup(WsnInitCtx.java:179)
[8/20/12 12:01:00:292 EDT] 0000006b SystemErr     R     at org.apache.aries.jndi.DelegateContext.lookup(DelegateContext.java:161)
[8/20/12 12:01:00:292 EDT] 0000006b SystemErr     R     at javax.naming.InitialContext.lookup(InitialContext.java:422)
[8/20/12 12:01:00:292 EDT] 0000006b SystemErr     R     at org.springframework.jndi.JndiTemplate$1.doInContext(JndiTemplate.java:155)
[8/20/12 12:01:00:292 EDT] 0000006b SystemErr     R     at org.springframework.jndi.JndiTemplate.execute(JndiTemplate.java:88)
[8/20/12 12:01:00:292 EDT] 0000006b SystemErr     R     at org.springframework.jndi.JndiTemplate.lookup(JndiTemplate.java:153)
[8/20/12 12:01:00:292 EDT] 0000006b SystemErr     R     at org.springframework.jndi.JndiTemplate.lookup(JndiTemplate.java:178)
[8/20/12 12:01:00:292 EDT] 0000006b SystemErr     R     at org.springframework.jndi.JndiLocatorSupport.lookup(JndiLocatorSupport.java:95)
[8/20/12 12:01:00:292 EDT] 0000006b SystemErr     R     at org.springframework.jndi.JndiObjectLocator.lookup(JndiObjectLocator.java:105)
[8/20/12 12:01:00:292 EDT] 0000006b SystemErr     R     at org.springframework.jndi.JndiObjectFactoryBean.lookupWithFallback(JndiObjectFactoryBean.j
ava:200)
[8/20/12 12:01:00:292 EDT] 0000006b SystemErr     R     at org.springframework.jndi.JndiObjectFactoryBean.afterPropertiesSet(JndiObjectFactoryBean.j
ava:186)
[8/20/12 12:01:00:292 EDT] 0000006b SystemErr     R     at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMe
thods(AbstractAutowireCapableBeanFactory.java:1369)
[8/20/12 12:01:00:292 EDT] 0000006b SystemErr     R     at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBe
an(AbstractAutowireCapableBeanFactory.java:1335)
[8/20/12 12:01:00:292 EDT] 0000006b SystemErr     R     ... 96 more 
```

使用 java 1.6 时没有出现此错误

这是我用于资源绑定的 web.xml 片段

```
 <resource-ref id="xxx-data-source">
            <description>XXX Datasource</description>
            <res-ref-name>jdbc/xxxDatasource</res-ref-name>
            <res-type>javax.sql.DataSource</res-type>
            <res-auth>Container</res-auth>
            <res-sharing-scope>Shareable</res-sharing-scope>
        </resource-ref> 
```

当我从数据源名称中删除 java: comp/env 前缀时，我能够绕过此错误

例如：我正在使用

```
jdbc.jdr.datasource=jdbc/XxxDatasource 
```

而不是

```
jdbc.jdr.datasource=java:comp/env/jdbc/XxxDatasource 
```

但我不能从所有地方（在某些罐子里）删除它。

以前有人遇到过这个问题吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-15T16:33:54.403

即使答案来晚了，我希望它可以帮助某人。

我也面临一个问题

```
javax.naming.ConfigurationException: NamingManager.getURLContext cannot find the factory for this scheme: java 
```

就我而言，它的出现是因为我在 web.xml 和 ibm-web-bnd.xmi 描述符中使用了 3.0 版。

当我使用 ibm-web-bnd.xml 描述符时，它起作用了。

所以对我来说，你似乎应该使用

*   对于 web-app 版本 <= 2.4 一个 ibm-bnd-web。**xmi**描述符
*   对于 web-app 版本 >= 2.5 一个 ibm-bnd-web。**xml**描述符

我还写了一篇关于我在这个问题上的经历的博客

[https://www.link-intersystems.com/blog/2014/06/15/how-to-fix-ibm-websphere-jndi-exception-cannot-find-the-factory-for-this-scheme-java/](https://www.link-intersystems.com/blog/2014/06/15/how-to-fix-ibm-websphere-jndi-exception-cannot-find-the-factory-for-this-scheme-java/)

# java - Java - 从 MySQL 数据库中获取数据

> ID：12041354
> 
> 赞同：8
> 
> 时间：2012-08-20T16:18:22.410
> 
> 标签：java, mysql, sql, database, jsp

我已经连接到一个 MySQL 数据库，它包含四个字段（第一个是 ID，后面的每个都包含 varchar 字符串）。

我正在尝试获取数据库的最后一行并检索字段的内容，以便我可以将它们设置为变量（一个 int 和三个字符串）并稍后使用它们。

到目前为止，我只有最低限度的连接，我从这里去哪里？如您所见，我试图编写一条 SQL 语句来获取最后一行，但从那里开始出现问题，我不知道如何将其拆分为单独的字段。

```
Class.forName("com.mysql.jdbc.Driver").newInstance();
Connection con = DriverManager.getConnection("jdbc:mysql://localhost/t", "", "");

Statement st = con.createStatement();
String sql = ("SELECT * FROM posts ORDER BY id DESC LIMIT 1;");
st.getResultSet().getRow();
con.close(); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-20T16:36:02.563

干得好 ：

```
Class.forName("com.mysql.jdbc.Driver").newInstance();
Connection con = DriverManager.getConnection("jdbc:mysql://localhost/t", "", "");

Statement st = con.createStatement();
String sql = ("SELECT * FROM posts ORDER BY id DESC LIMIT 1;");
ResultSet rs = st.executeQuery(sql);
if(rs.next()) { 
 int id = rs.getInt("first_column_name"); 
 String str1 = rs.getString("second_column_name");
}

con.close(); 
```

`rs.getInt`或者`rs.getString`你可以从开始`column_id`传递`1`，但我更喜欢传递`column_name`它的更多信息，因为你不必查看数据库`table`是`index`什么`column`。

**更新 ：** `rs.next`

> boolean next() 抛出 SQLException
> 
> 将光标从其当前位置向前移动一行。ResultSet 游标最初位于第一行之前；第一次调用 next 方法使第一行成为当前行；第二次调用使第二行成为当前行，依此类推。
> 
> 当调用 next 方法返回 false 时，光标位于最后一行之后。任何需要当前行的 ResultSet 方法调用都将导致抛出 SQLException。如果结果集类型为 TYPE_FORWARD_ONLY，则供应商指定他们的 JDBC 驱动程序实现是返回 false 还是在后续调用 next 时抛出 SQLException。
> 
> 如果当前行的输入流打开，则调用 next 方法将隐式关闭它。读取新行时会清除 ResultSet 对象的警告链。
> 
> 返回： 如果新的当前行有效，则返回 true；如果没有更多行，则返回 false 抛出：SQLException - 如果发生数据库访问错误或在关闭的结果集上调用此方法

[参考](http://docs.oracle.com/javase/7/docs/api/java/sql/ResultSet.html#next%28%29)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-20T16:21:36.220

这样的事情会做：

```
public static void main(String[] args) {

    Connection con = null;
    Statement st = null;
    ResultSet rs = null;

    String url = "jdbc:mysql://localhost/t";
    String user = "";
    String password = "";

    try {
        Class.forName("com.mysql.jdbc.Driver");
        con = DriverManager.getConnection(url, user, password);
        st = con.createStatement();
        rs = st.executeQuery("SELECT * FROM posts ORDER BY id DESC LIMIT 1;");

        if (rs.next()) {//get first result
            System.out.println(rs.getString(1));//coloumn 1
        }

    } catch (SQLException ex) {
        Logger lgr = Logger.getLogger(Version.class.getName());
        lgr.log(Level.SEVERE, ex.getMessage(), ex);

    } finally {
        try {
            if (rs != null) {
                rs.close();
            }
            if (st != null) {
                st.close();
            }
            if (con != null) {
                con.close();
            }

        } catch (SQLException ex) {
            Logger lgr = Logger.getLogger(Version.class.getName());
            lgr.log(Level.WARNING, ex.getMessage(), ex);
        }
    }
} 
```

你可以像这样迭代结果`while`：

```
while(rs.next())
{
System.out.println(rs.getString("Colomn_Name"));//or getString(1) for coloumn 1 etc
} 
```

还有许多其他很棒的教程，例如：

*   [http://www.vogella.com/articles/MySQLJava/article.html](http://www.vogella.com/articles/MySQLJava/article.html)
*   [http://www.java-samples.com/showtutorial.php?tutorialid=9](http://www.java-samples.com/showtutorial.php?tutorialid=9)

至于您使用的`Class.forName("com.mysql.jdbc.Driver").newInstance();`JDBC[连接 - Class.forName vs Class.forName().newInstance？](https://stackoverflow.com/questions/4640268/jdbc-connection-class-forname-vs-class-forname-newinstance)这显示了您可以如何使用`Class.forName("com.mysql.jdbc.Driver")`它，因为它不需要自己启动它

**参考：**

*   [http://zetcode.com/databases/mysqljavatutorial/](http://zetcode.com/databases/mysqljavatutorial/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-20T16:26:18.060

这应该工作，我想...

```
ResultSet results = st.executeQuery(sql);

if(results.next()) { //there is a row
 int id = results.getInt(1); //ID if its 1st column
 String str1 = results.getString(2);
 ...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-18T16:53:19.280

从 MySQL 表中获取数据的简单 Java 方法：

```
/*
 * CREDIT : WWW.CODENIRVANA.IN
*/

String Data(String query){
    String get=null;
    try{

Class.forName("com.mysql.jdbc.Driver").newInstance();
Connection con = (Connection)DriverManager.getConnection
("jdbc:mysql://localhost:3306/mysql","root","password");
Statement stmt = (Statement) con.createStatement();
ResultSet rs=stmt.executeQuery(query);
if (rs.next())
       {
get = rs.getString("");
        }

}
catch(Exception e){
JOptionPane.showMessageDialog (this, e.getMessage());
}
    return get;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-11-25T06:54:17.117

这是我现在所做的：

```
import java.sql.*;
import java.util.logging.Level;
import java.util.logging.Logger;

import com.sun.javafx.runtime.VersionInfo;  

public class ConnectToMySql {
public static ConnectBean dataBean = new ConnectBean();

public static void main(String args[]) {
    getData();
    }

public static void getData () {

    try {
        Class.forName("com.mysql.jdbc.Driver");
Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/mynewpage", 
 "root", "root");

 // here mynewpage is database name, root is username and password

Statement stmt = con.createStatement();
        System.out.println("stmt  " + stmt);
        ResultSet rs = stmt.executeQuery("select * from carsData");
        System.out.println("rs  " + rs);
        int count = 1;
        while (rs.next()) {
            String vehicleType = rs.getString("VHCL_TYPE");
            System.out.println(count  +": " + vehicleType);
            count++;

        }

        con.close();
    } catch (Exception e) {
        Logger lgr = Logger.getLogger(VersionInfo.class.getName());
        lgr.log(Level.SEVERE, e.getMessage(), e);

        System.out.println(e.getMessage());
    }

}

} 
```

上面的代码将为您提供您拥有的表格的第一列。

这是您可能需要在 MySQL 数据库中创建的表

```
CREATE TABLE
carsData
(
    VHCL_TYPE CHARACTER(10) NOT NULL,
); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-11-25T07:10:18.957

*   首先，下载 MySQL 连接器 jar 文件，这是今天最新的 jar 文件[[mysql-connector-java-8.0.21]](https://jar-download.com/artifacts/mysql/mysql-connector-java)。

*   将 Jar 文件添加到您的工作区 [构建路径]。

*   然后从 DriverManager 类创建一个新的 Connection 对象，这样您就可以使用这个 Connection 对象来执行查询。

*   为您的连接定义数据库名称、用户名和密码。

*   使用 resultSet 从数据库表中获取基于列名的数据。

示例代码在这里：

```
public class JdbcMySQLExample{

public static void main(String[] args) {

    String url = "jdbc:mysql://localhost:3306/YOUR_DB_NAME?useSSL=false";
    String user = "root";
    String password = "root";

    String query = "SELECT * from YOUR_TABLE_NAME";

    try (Connection con = DriverManager.getConnection(url, user, password);
        Statement st = con.createStatement();
        ResultSet rs = st.executeQuery(query)) {

        if (rs.next()) {

            System.out.println(rs.getString(1));
        }

    } catch (SQLException ex) {
          System.out.println(ex);

    } 
} 
```

# jquery - 使用 jQuery 和 JSF 解析 URL 以获取视频或网站的缩略图

> ID：12041356
> 
> 赞同：1
> 
> 时间：2012-08-20T16:18:23.697
> 
> 标签：jquery, jquery-ui, jsf, jquery-plugins, jsf-2

我正在构建一个社交应用程序，它需要包含与某些信息相关的上下文，因为这对用户来说会更好，就像在 Facebook 和 Google+ 中一样。有没有可以对网站或视频进行截图的jQuery插件或JSF插件？

我也在使用 jQuery 进行编码，如下所示，它并不完整。

## jQuery

```
var content = $("#wall").val();
URL objUrl = new URL(content);
InputStream is = objUrl.openStream();
DocumentBuilderFactory bdf = DocumentBuilderFactory.newInstance();
DocumentBuilder db = dbf.newDocumentBuilder();
Document doc = db.parse(new InputSource(is)); 
```

## XHTML 页面

```
<ui:composition>
  <h:form>
    <input name="current_img" id="current_img" type="hidden" />
    <input name="ajax_flag" id="ajax_flag" type="hidden" />
  </h:form>
  <div id="wrapper">
    <div style="border: solid 1px #B4BBCD;">
      <div id="fetched_data">
        <div id="loader"></div>
        <div id="ajax_content"></div>
      </div>
    </div>
    <div id="textareaWrap">
      <textarea id="wall"></textarea>
      <div id="sharebtn">
        <a class="button Share" style="" id="shareButton">Share</a>
      </div>
    </div>
  </div>
</ui:composition> 
```

# directx - HLSL 点精灵纹理坐标在 ATI 而不是 NVIDIA 上工作

> ID：12041358
> 
> 赞同：4
> 
> 时间：2012-08-20T16:18:39.510
> 
> 标签：directx, textures, nvidia, hlsl, ati

我真的坚持这个。我的 HLSL 用于渲染带有精灵表纹理坐标的点精灵，在所有 ATI 卡上都可以正常工作，但在任何 NVIDIA 卡上都不能。在 NVIDIA 卡上，传递的纹理坐标映射到整个精灵表而不是其中的一部分。奇怪，但它在 ATI 卡上运行良好。我错过了 ATI 卡独有的东西吗？

这是我的着色器

```
struct VS_INPUT
{
        float4 Position   : POSITION;
        float4 Color      : COLOR;
        float4 Texture    : TEXCOORD0;
    //float1 Psize    : PSIZE0;
};

struct VS_OUTPUT
{
        float4 Position   : POSITION;
        float4 Color      : COLOR;
        float2 Texture    : TEXCOORD0;
        float2 Texture_zw : TEXCOORD1;
    float1 Psize      : PSIZE;
};

float4x4 WorldViewProj;
texture Tex <string name = "sprite_coin_test.dds";>;
sampler2D s_2D;
float offset_x=0.0;
float offset_y=0.0;

sampler S0 = sampler_state
{
    Texture = (Tex);
    MinFilter = ANISOTROPIC; //LINEAR;
    MagFilter = ANISOTROPIC; //LINEAR;
    MipFilter = LINEAR;
};

VS_OUTPUT vs_main( in VS_INPUT In )
{
    VS_OUTPUT Out=(VS_OUTPUT)0;                      //create an output vertex

    Out.Position = mul(In.Position, WorldViewProj);  //apply vertex transformation
    Out.Texture  = In.Texture;
        Out.Texture_zw = float2(In.Texture.z, In.Texture.w);
        Out.Color    = In.Color;
    //Out.Psize    = In.Psize;
    Out.Psize=(Out.Position.z)*10.0;
        return Out;                         //return output vertex
}

float4 PS_Particle_main(float2 vPos: TEXCOORD0, float2 text_zw: TEXCOORD1) : COLOR 
{   
        vPos.x*=offset_x;
        vPos.y*=offset_y;

        vPos += float2(text_zw[0], text_zw[1]);    

        return tex2D(s_2D, vPos);
}

technique RenderVS
{   
    pass p0   
    {       
        AlphaBlendEnable        = true;     
        AlphaTestEnable     = false;        
        SrcBlend            = SRCALPHA;     
        DestBlend           = INVSRCALPHA;  

        POINTSPRITEENABLE       = true;     
        POINTSCALEENABLE        = true;
              POINTSIZE_MIN     = 1.0f;     
        POINTSIZE_MAX       = 400.0f;           
                    POINTSCALE_A        = 1.0f;
        POINTSCALE_B        = 1.0f;
        POINTSCALE_C        = 1.0f;
        ZWRITEENABLE        = false;

        Sampler[0]      = (S0);

        VertexShader = compile vs_1_1 vs_main();
        PixelShader = compile ps_2_0 PS_Particle_main();        

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T10:02:10.803

我有一段时间遇到同样的问题，这花了我很多时间。我没有找到任何关于这个问题的文档，但是通过在 ATI 和 NVIDIA 设备上的测试我发现了不同之处。使用点精灵 ATI 一切正常，它将纹理坐标正确插入到 TEXCOORD0。相比之下，NVIDIA 的做法几乎相同，但他们使用 TEXCOORD 插值器在所有字段中写入纹理坐标。因此，您通过纹理坐标传递给像素着色器的所有信息都将被覆盖。我通过使用 COLOR-interpolator 而不是 TEXCOORD-interpolator 解决了这个问题。很奇怪，但它对我来说很好:) 在你的情况下它会是：

```
struct VS_OUTPUT
{
    float4 Position   : POSITION;
    float4 Color      : COLOR0;
    float2 Texture    : TEXCOORD0;
    float2 Texture_zw : COLOR1;
    float1 Psize      : PSIZE;
}; 
```

# c++ - C++一次运行2个进程

> ID：12041363
> 
> 赞同：3
> 
> 时间：2012-08-20T16:19:15.367
> 
> 标签：c++

关于一次运行 2 个进程的 C++ 问题。

我有一个客户端-服务器模型类型的 C++ 代码。我的服务器将为来自客户端的每个连接分叉。这是一个也有提醒模块的系统。这个提醒模块需要在从 1000 倒计时到 0 时发送一封电子邮件：当它到达 0 时，它将执行其代码。

但是我的服务器已经在 while(1) 循环中运行。如何在不影响服务器监听连接的情况下一起调用这个提醒？

感谢所有帮助和建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T16:23:16.960

您正在寻找通常称为线程的内容。下面是一个使用 Boost.Thread 的例子：

```
#include <iostream>  
#include <boost/thread.hpp>  
#include <boost/date_time.hpp>  

bool worker_running = true;

void workerFunc() {
    while (worker_running) {
        boost::posix_time::seconds workTime(3);  

        // do something 

        boost::this_thread::sleep(workTime);  
    }
}  

int main(int argc, char* argv[])  
{  
    //before your while loop: 

    boost::thread workerThread(workerFunc);  

    //while loop here

    worker_running = false;           
    workerThread.join(); 

    return 0;  
} 
```

# jquery - 简单的切换功能问题

> ID：12041366
> 
> 赞同：0
> 
> 时间：2012-08-20T16:19:30.333
> 
> 标签：jquery

当用户单击 imgIcon 时，我试图切换 toggleTutorial 功能，但是，我什至无法触发该功能。我需要我的 showTutorial 变量是全局变量，但似乎 getScript 函数下的语句没有触发。这里有人可以帮助我吗？

谢谢

```
$(function() {
    var spreadsheet = ''
    var showTutorial = true;
    $('.helpImgIcon').click(function() {
        $.getScript('inc/tutorial.js', function() {
            if (showTutorial) {
                toggleTutorial(showTutorial);
            }
        });
        showTutorial = false;
        return false;
    });
    $('body').click(function() {
        $('.js-tutorialTooltips').remove();
        $('.helpImg').remove();
        showTutorial = true;
    })
})​ 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T16:22:37.717

`$.getScript`是异步的，所以`showTutorial`当它遇到回调时会是假的。

尝试将其更改为：

```
$('.helpImgIcon').click(function() {
    $.getScript('inc/tutorial.js', function() {
        if (showTutorial) {
            toggleTutorial(showTutorial);
            showTutorial = false;
        }
    });
    return false;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T16:23:37.157

多亏了 DOM，JavaScript 可能会遇到一些可怕的命名空间问题。我几乎总是随时命名我的变量，即

```
window.namespace = {}; //Object Literal for namespace
window.namespace.showTutorial = true; 
```

# postgresql - heroku 是否允许对其附加或独立数据库具有 root 权限？

> ID：12041369
> 
> 赞同：1
> 
> 时间：2012-08-20T16:19:41.213
> 
> 标签：postgresql, heroku

在我购买比 Heroku 上的共享数据库更好的东西之前，我想知道我是否能够，比如说在 postgresql 中创建自定义 CASTS？为此，我需要以具有管理员权限的用户身份登录（数据类型所有者，例如 bigint 所有者）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T16:59:44.780

为了我们所有客户的安全性和稳定性，我们不会在我们的任何数据库中为您提供超级用户角色。

虽然提供的角色确实拥有您连接到的架构和数据库，但它目前不拥有类型。这就是我所说的晦涩用例，因为隐式转换的替代方案更清晰并且达到了相同的目的。

在其他情况下超级用户权限是理想的，例如运行 pg_cancel_backend 或安装扩展的能力。我们已经分别通过[向后移植到 9.0 阵容（在 9.1 中默认可用）](https://postgres.heroku.com/blog/past/2012/3/1/postgresql_91_now_default)和[扩展白名单](https://postgres.heroku.com/blog/past/2012/8/2/announcing_support_for_17_new_postgres_extensions_including_dblink/)解决了这两种情况。

编辑 - 将文本类型与整数进行比较的示例。

对于隐式转换，可以使用`some_value::new_type`符号指定类型`some_string::integer`：：

```
del8a7mgo0cml=> create table cast_test (number integer, string text);
CREATE TABLE
del8a7mgo0cml=> insert into cast_test VALUES (1, '1');
INSERT 0 1
del8a7mgo0cml=> insert into cast_test VALUES (2, '1');
INSERT 0 1
del8a7mgo0cml=> insert into cast_test VALUES (2, '2');
INSERT 0 1
del8a7mgo0cml=> select * from cast_test;
 number | string 
--------+--------
      1 | 1
      2 | 1
      2 | 2
(3 rows)
del8a7mgo0cml=> select * from cast_test where number = string::integer;
 number | string 
--------+--------
      1 | 1
      2 | 2
(2 rows) 
```

# select - 使用共享文件的机器之间的低延迟通信

> ID：12041371
> 
> 赞同：3
> 
> 时间：2012-08-20T16:19:41.987
> 
> 标签：select, nfs, sshfs

我们想（连续）在一台 linux 机器上写入日志文件，并在另一台机器上连续读取它。我们正在寻找低延迟更新（这是用于实时绘图）和简单的设置。实现这一目标的最佳方法是什么？

我已经对 nfs、sshfs 和 tail -f 进行了修改，但更新的频率仅为 1Hz。我假设这些文件系统不支持 select 系统调用，因此以内部速率进行最高轮询。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T16:28:17.560

这听起来像是一个糟糕的架构选择。

是用于 RPC 吗？如果是这样，你为什么不创建一个网络服务？

如果只是为了传输数据，试试memcached。

# google-bigquery - BigQuery、SLA 和支持

> ID：12041372
> 
> 赞同：0
> 
> 时间：2012-08-20T16:19:52.517
> 
> 标签：google-bigquery

我正在评估[BigQuery](http://en.wikipedia.org/wiki/BigQuery)对于我们希望定期运行的某些数据处理是否是一个不错的选择。

我很欣赏 BigQuery 仍在大力开发中，而且改进和修复可能会经常发生。

我想知道如果发布打破了以前的工作流程，流程会是什么。我已经阅读了[SLA](http://en.wikipedia.org/wiki/Service-level_agreement)，但它们似乎更倾向于停机，而不是回归问题/错误。是否有 SLA 付费支持选项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T17:00:02.770

与大多数商业服务一样，Google 采用严格的构建和测试流程来确保质量。如果您有特定的支持要求，我们建议您[联系 Google 的 Cloud Platform 销售团队](http://cloud.google.com/contact.html)，讨论我们的首要产品。

# mysql - 在旧表的第一个单词上左连接表？

> ID：12041375
> 
> 赞同：0
> 
> 时间：2012-08-20T16:20:04.050
> 
> 标签：mysql, left-join

你如何在其他表的第一个单词上离开连接表？

这会从新表返回标题，但旧表为空，我知道标题中的第一个单词是完全匹配的

```
SELECT tb1.title as new_titles,tb2.title as old_title
FROM tb1.news_items
LEFT JOIN
tb2.news_items 
ON
tb1.title = SUBSTRING_INDEX(tb2.title, '', 1) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T16:28:41.897

这将为您提供第二张桌子上标题中的第一个单词

```
CASE CHARINDEX(' ', tb2.title, 1)
WHEN 0 THEN tb2.title
ELSE SUBSTRING(tb2.title, 1, CHARINDEX(' ', tb2.title, 1) - 1)
END
AS FirstWord 
```

所以查询会像

```
SELECT tb1.title as new_titles,tb2.title as old_title
    CASE CHARINDEX(' ', tb2.title, 1)
    WHEN 0 THEN tb2.title
    ELSE SUBSTRING(tb2.title, 1, CHARINDEX(' ', tb2.title, 1) - 1)
    END
AS FirstWord
FROM tb1.news_items
LEFT JOIN
tb2.news_items 
ON
tb1.title = FirstWord 
```

# windows-services - MSMQ 触发器调用 Windows 服务

> ID：12041386
> 
> 赞同：2
> 
> 时间：2012-08-20T16:21:17.937
> 
> 标签：windows-services, msmq

当队列中有消息时，我需要我的 Windows 服务来处理队列中的消息。

我在想最好设置一个 Windows 服务，当队列中有消息时，MSMQ 应该触发，触发对 Windows 服务的调用。

有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T17:23:36.960

这是一个过于宽泛的问题，但是您可以创建一个 Windows 服务来同步或异步地侦听队列、接收消息并在它们到达时对其进行处理。至于*如何*做到这一点，Visual Studio 提供的默认服务项目是一个好的开始。从那里您可以创建一个在服务启动时实例化的类，绑定到队列并调用`Receive`或`BeginReceive`（同步或异步）以获取消息并处理它们。

另一种选择是使用[激活服务](http://msdn.microsoft.com/en-us/library/ms752246.aspx)。从环境角度来看，这可能更复杂，您需要特定版本的 Windows 和 .NET 才能使用它。

最后是 MSMQ 触发器。这是一项与 MSMQ 本身一起（可选）安装的服务。它可以配置为监视队列并在消息到达时执行操作。这将是最简单的选项，但是如果您选择此选项，那么我建议您只创建一个普通的 EXE 而不是服务，并使用触发器来执行它。

[本文](http://blogs.msdn.com/b/darioa/archive/2006/06/28/queued-components-vs-msmq-triggers-vs-custom-listeners.aspx)介绍了每种方法的一些优缺点；我建议您在做出决定之前阅读它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T11:14:33.487

如果您愿意，您可以在 Windows 服务中托管一个 WCF ServiceHost，它会在收到消息时自动提取消息。不需要连接到 MSMQ。当消息出现时，WCF 会自动将消息拉入服务。

假设您已经在写入 MSMQ 私有队列“测试”。要编写正在运行的 Windows 服务，请执行以下操作，请原谅服务中方法准确性的示例：

```
namespace WcfService
{
  public class Order 
  { 
    public int ID { get; set; }
  }

  [ServiceContract]
  public interface IOrderService
  {
    [OperationContract(TransactionScopeRequired=true)]
    void ProcessOrder(Order order);
  }

  public class OrderService : IOrderService
  {
    public void ProcessOrder(Order order)
    {
      Debug.Print("Order ID: ", order.ID);
    }
  }
}

namespace Client
{
  public class WindowsService : IDisposable
  {
    private ServiceHost host = null;

    // TODO: Implement static void Main to initialize service

    // OnStart
    public void OnStart()
    {
      if(host == null)
        host = new ServiceHost( typeof ( OrderService ) );

      host.Open();
    }   

    public void OnStop()
    {
      host.Close();
    }

    public void Dispose()
    {
      // TODO: Implement Dispose() pattern properly
      if(host!=null) 
        host.Dispose();
    }
  }
} 
```

然后配置 Windows 服务从 MSMQ 读取

```
<?xml version="1.0"?>
<configuration>
    <system.serviceModel>
        <bindings>
            <netMsmqBinding>
                <binding name="readFromQueueBinding" exactlyOnce="false">
                    <security mode="None"/>
                </binding>
            </netMsmqBinding>
        </bindings>
        <services>
            <service name="WcfService.OrderService">
                <endpoint address="net.msmq://localhost/private/test" 
                          binding="netMsmqBinding" 
                          contract="WcfService.IOrderService" 
                          name="IOrderService_Msmq_Service" 
                          bindingConfiguration="readFromQueueBinding"/>
            </service>
        </services>
    </system.serviceModel>
</configuration> 
```

# matlab - 使用我的 matlab 代码强化学习中的 Windy gridworld 游戏问题的变体

> ID：12041391
> 
> 赞同：1
> 
> 时间：2012-08-20T01:18:18.520
> 
> 标签：matlab, reinforcement-learning

在强化学习中，一个典型的例子是有 [风的网格世界](http://webdocs.cs.ualberta.ca/~sutton/book/ebook/node64.html)

我面临着一个新变化的风网格世界，它还有一堵墙和随机风，我被这两个新东西困住了

![](../Images/a36f84a7766e5ac11195787ec48393ed.png)

图 1 显示了一个标准的网格世界，具有起始 (S) 和目标 (G) 单元格，但有两个不同之处：**代理无法越过一堵墙（由黑色单元格表示）**，以及向下和向左的侧风在网格的右边缘。每个单元格中可用的动作是国王的举动| 每个单元总共有 8 个动作。如果**有任何动作会将您带到网格世界之外或与墙壁发生碰撞，您最终会进入最近的单元格**（例如，在左上角的单元格中向东北移动会将您带到右侧的一个单元格）。在右侧区域，生成的下一个单元格由随机的“风”向左下移，其平均强度逐列变化。风的平均强度在每列下方给出，以向左下移的单元格数表示.

由于随机性，风有时会与每列给出的平均值相差 1（平均值为 0 时除外）。也就是说，三分之一的时间你会根据列下方指示的值准确地向下移动，三分之一的时间你会向下和向左移动一个单元格，另外三分之一的时间你会移动一个细胞小于平均值。例如，如果你在墙的一排并且在开口的中间并且你向上移动，那么有三分之一的时间你会在那个单元格以西的一排结束，三分之一的时间你会结束向西两列，在该单元格以南一列，三分之一的时间您最终在该单元格以北的同一列。风会影响你所在的牢房，而不是你要去的牢房。

用 = 0:1, = 0:9 和初始 Q(s; a) = 0 对所有 s 实现上述问题中的 Q 学习算法 2；一个。每个动作都会产生 rs = 1 的奖励，但立即导致目标单元格 (rg = 10) 的动作除外。使用： - 贪心动作选择方法 = 0:2。初始 Q(s,a) > 0 且初始 Q(s,a) < 0 的贪心动作选择方法。

**我的 matlab 代码可以工作。**

**我真正的问题**是 **函数 nextPos = GiveNextPos(curPos, actionIndex, windpowers, gridCols, gridRows)**，代理将在其中决定一个动作，然后进入下一步。但是影响下一步的因素很多，比如**随机**风**墙**

**所以第一个问题**是关于随机风的，我如何在matlab中编程说在1/3的机会中是3，在另外1/3的机会中是1......

**第二个问题**是关于撞墙？我是不是应该先计算国王的步行和风的下一步，然后用这个下一步的值来检查我是否撞墙？？？）

```
function WindyGridWorldQLearning()

    fprintf('WindyGridWorldQLearning\n'); 

    gamma = 0.9;
    alpha = 0.1;
    epsilon = 0.2;

    gridcols = 10; 
    gridrows = 7;
    windpowers = [0 0 0 0 1 1 2 2 1 1];
    fontsize = 16;
    showTitle = 1;

    episodeCount = 900;
    selectedEpisodes = [900];

    isKing = 1; 
    canHold = 0;

    start.row = 7;
    start.col = 1;
    goal.row = 1;
    goal.col = 1;

selectedEpIndex = 1;
 actionCount = 8; 

% initialize Q with zeros
Q = zeros(gridrows, gridcols, actionCount);

a = 0; % an invalid action
% loop through episodes
for ei = 1:episodeCount,
    %disp(sprintf('Running episode %d', ei));
    curpos = start;
    nextpos = start;

    %epsilon or greedy
    if(rand > epsilon) % greedy
        [qmax, a] = max(Q(curpos.row,curpos.col,:));
    else
        a = IntRand(1, actionCount);
    end

    while(PosCmp(curpos, goal) ~= 0)
        % take action a, observe r, and nextpos
        nextpos = GiveNextPos(curpos, a, windpowers, gridcols, gridrows);
        if(PosCmp(nextpos, goal) ~= 0), r = -1; else r = 10; end

        % choose a_next from nextpos
        [qmax, a_next] = max(Q(nextpos.row,nextpos.col,:));
        if(rand <= epsilon) % explore
            a_next = IntRand(1, actionCount);
        end

        % update Q:
        curQ = Q(curpos.row, curpos.col, a);
        nextQ = qmax; %Q(nextpos.row, nextpos.col, a_next);
        Q(curpos.row, curpos.col, a) = curQ + alpha*(r + gamma*nextQ - curQ);

        curpos = nextpos; a = a_next;
    end % states in each episode

    % if the current state of the world is going to be drawn ...
    if(selectedEpIndex <= length(selectedEpisodes) && ei == selectedEpisodes(selectedEpIndex))
        curpos = start;
        rows = []; cols = []; acts = [];
        for i = 1:(gridrows + gridcols) * 10,
            [qmax, a] = max(Q(curpos.row,curpos.col,:));
            nextpos = GiveNextPos(curpos, a, windpowers, gridcols, gridrows);
            rows = [rows curpos.row];
            cols = [cols curpos.col];
            acts = [acts a];

            if(PosCmp(nextpos, goal) == 0), break; end
            curpos = nextpos;
        end % states in each episode

        %figure;
        figure('Name',sprintf('Episode: %d', ei), 'NumberTitle','off');
        DrawWindyEpisodeState(rows, cols, acts, start.row, start.col, goal.row, goal.col, windpowers, gridrows, gridcols, fontsize);
        if(showTitle == 1),
            title(sprintf('Windy grid-world SARSA - episode %d - (\\epsilon: %3.3f), (\\alpha = %3.4f), (\\gamma = %1.1f)', ei, epsilon, alpha, gamma));
        end

        selectedEpIndex = selectedEpIndex + 1;
    end

end % episodes loop

function c = PosCmp(pos1, pos2)
c = pos1.row - pos2.row;
if(c == 0)
    c = c + pos1.col - pos2.col;
end

function nextPos = GiveNextPos(curPos, actionIndex, windpowers, gridCols, gridRows)
nextPos = curPos;
switch actionIndex
   case 1 % east
       nextPos.col = curPos.col + 1;
   case 2 % south
       nextPos.row = curPos.row + 1;       
       if(nextPos.row ==4 && nextPos.col <= 4 )   nextPos.row = curPos.row;  end     
   case 3 % west
       nextPos.col = curPos.col - 1;
       if(nextPos.row ==4 && nextPos.col <= 4 )   nextPos.col = curPos.col;  end 
   case 4 % north
       nextPos.row = curPos.row - 1;
       if(nextPos.row ==4 && nextPos.col <= 4 )   nextPos.row = curPos.row;  end 
   case 5 % northeast 
       nextPos.col = curPos.col + 1;
       nextPos.row = curPos.row - 1;
       if(nextPos.row ==4 && nextPos.col <= 4 )   nextPos.row = curPos.row;  end 
   case 6 % southeast 
       nextPos.col = curPos.col + 1;
       nextPos.row = curPos.row + 1;
       if(nextPos.row ==4 && nextPos.col <= 4 )   nextPos.row = curPos.row;  end 
   case 7 % southwest
       nextPos.col = curPos.col - 1;
       nextPos.row = curPos.row + 1;
       if(nextPos.row ==4 && nextPos.col <= 4 )   nextPos.row = curPos.row;  end 
   case 8 % northwest
       nextPos.col = curPos.col - 1;
       nextPos.row = curPos.row - 1;
       if(nextPos.row ==4 && nextPos.col <= 4 )   nextPos.row = curPos.row;  end 
   case 9 % hold
       nextPos = curPos;
   otherwise
      disp(sprintf('invalid action index: %d', actionIndex))
end

if(curPos.col > 4)    
    nextPos.row = nextPos.row - windpowers(nextPos.col);
    nextPos.col = nextPos.col - windpowers(nextPos.col);
end

if(nextPos.col <= 0), nextPos.col = 1; end
if(nextPos.col > gridCols), nextPos.col = gridCols; end

if(nextPos.row <= 0), nextPos.row = 1; end
if(nextPos.row > gridRows), nextPos.row = gridRows; end

function n = IntRand(lowerBound, upperBound)
n = floor((upperBound - lowerBound) * rand + lowerBound);

function DrawWindyEpisodeState(rows, cols, acts, SRow, SCol, GRow, GCol, windpowers, gridrows, gridcols, fontsize)
DrawGrid(gridrows, gridcols);
DrawTextOnCell('S', 0, SRow, SCol, gridrows, gridcols, fontsize);
DrawTextOnCell('G', 0, GRow, GCol, gridrows, gridcols, fontsize);

for i=1:length(rows),
    DrawActionOnCell(acts(i), rows(i), cols(i), gridrows, gridcols, fontsize);
end

for i=1:gridcols,
    [xc, yc] = FindColBaseCenter(i, gridrows, gridcols);
    text(xc, yc, sprintf('%d',windpowers(i)), 'FontSize', fontsize, 'Rotation', 0);
end

function DrawEpisodeState(rows, cols, acts, SRow, SCol, GRow, GCol, gridrows, gridcols, fontsize)
DrawGrid(gridrows, gridcols);
DrawTextOnCell('S', 0, SRow, SCol, gridrows, gridcols, fontsize);
DrawTextOnCell('G', 0, GRow, GCol, gridrows, gridcols, fontsize);

for i=1:length(rows),
    DrawActionOnCell(acts(i), rows(i), cols(i), gridrows, gridcols, fontsize);
end

function DrawGrid(gridrows, gridcols)
xsp = 1 / (gridcols + 2);
ysp = 1 / (gridrows + 2);

x = zeros(1, 2*(gridcols + 1));
y = zeros(1, 2*(gridcols + 1));
i = 1;
for xi = xsp:xsp:1 - xsp,
    x(2*i - 1) = xi; x(2*i) = xi;
    if(mod(i , 2) == 0)
        y(2*i - 1) = ysp;y(2*i) = 1-ysp;
    else
        y(2*i - 1) = 1 - ysp;y(2*i) = ysp;
    end
    i = i + 1;
end

x2 = zeros(1, 2*(gridrows + 1));
y2 = zeros(1, 2*(gridrows + 1));
i = 1;
for yi = ysp:ysp:1 - ysp,
    y2(2*i - 1) = yi; y2(2*i) = yi;
    if(mod(i , 2) == 0)
        x2(2*i - 1) = xsp;x2(2*i) = 1-xsp;
    else
        x2(2*i - 1) = 1 - xsp;x2(2*i) = xsp;
    end
    i = i + 1;
end

plot(x, y, '-');
hold on
plot(x2, y2, '-');
axis([0 1 0 1]);
axis off
set(gcf, 'color', 'white');

function DrawTextOnCell(theText, rotation, row, col, gridrows, gridcols, fontsize)
[xc, yc] = FindCellCenter(row, col, gridrows, gridcols);
text(xc, yc, theText,  'FontSize', fontsize, 'Rotation', rotation);

function DrawActionOnCell(actionIndex, row, col, gridrows, gridcols, fontsize)
rotation = 0;
textToDraw = 'o';
switch actionIndex
   case 1 % east
       textToDraw = '\rightarrow';
       rotation = 0;
   case 2 % south
       textToDraw = '\downarrow';
       rotation = 0;
   case 3 % west
       textToDraw = '\leftarrow';
       rotation = 0;
   case 4 % north
       textToDraw = '\uparrow';
       rotation = 0;
   case 5 % northeast 
       textToDraw = '\rightarrow';
       rotation = 45;
   case 6 % southeast 
       textToDraw = '\downarrow';
       rotation = 45;
   case 7 % southwest
       textToDraw = '\leftarrow';
       rotation = 45;
   case 8 % northwest
       textToDraw = '\uparrow';
       rotation = 45;

   otherwise
      disp(sprintf('invalid action index: %d', actionIndex))
end
DrawTextOnCell(textToDraw, rotation,  row, col, gridrows, gridcols, fontsize);

function [x,y] = FindCellCenter(row, col, gridrows, gridcols)
xsp = 1 / (gridcols + 2);
ysp = 1 / (gridrows + 2);
x = ((2*col + 1) / 2) * xsp;
y = 1 - (((2*row + 1) / 2) * ysp);
x = x - xsp/5;

function [x,y] = FindColBaseCenter(col, gridrows, gridcols)
row = gridrows + 1;
xsp = 1 / (gridcols + 2);
ysp = 1 / (gridrows + 2);
x = ((2*col + 1) / 2) * xsp;
y = 1 - (((2*row + 1) / 2) * ysp);
x = x - xsp/5; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-10T21:06:51.590

For the wind just generate a random number n, say between 0 and 1\. If you want 3 different behaviors each with a 1/3 chance, just have conditions for n < .33 , .33 < n < .66 ... etc.

I don't quite understand what you're saying with the wall, but you should check the action the agent will take and the effect the wind will have on it and then see if this results in you hitting a wall. If so take the appropriate action.

# visual-studio-2012 - VS2012，团队资源管理器和我的工作

> ID：12041392
> 
> 赞同：2
> 
> 时间：2012-08-20T16:21:31.477
> 
> 标签：visual-studio-2012

VS2012 的团队资源管理器窗口中的我的工作（视频）功能是否看起来[很](http://msdn.microsoft.com/en-us/library/ms181403.aspx)方便[。](http://channel9.msdn.com/Series/Visual-Studio-2012-Premium-and-Ultimate-Overview/Visual-Studio-Ultimate-2012-How-to-multi-task-with-My-Work)但是，我们使用 Subversion。

此功能是否与 TFS 紧密耦合？是否有一个扩展点允许工作状态（打开的窗口、断点等）在 TFS 之外的某个地方持久化？是否已经有非 TFS 实现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:36:08.103

是的，它肯定与 TFS 耦合——搁置集是 TFS 的一个特性。

最接近的 SVN 类比是搁置集是一个“分支”，但分支上没有版本历史记录 - 它只是一个放置待处理更改的地方，因此您可以暂时恢复到主干。然后，您可以将待处理的更改从“架子上”拿回并继续处理它们。

# android - 语音搜索权限

> ID：12041396
> 
> 赞同：8
> 
> 时间：2012-08-20T16:21:49.317
> 
> 标签：android, speech-recognition, android-permissions

在我的 ICS (Android 4.0.4) 平板电脑上运行[Google Voice Search](https://play.google.com/store/apps/details?id=com.google.android.voicesearch)会产生奇怪的行为，并出现以下警告：

```
W/PackageManager( 1571): Unknown permission com.google.android.voicesearch.SHORTCUTS_ACCESS in package com.google.android.googlequicksearchbox
W/PackageManager( 1571): Unknown permission com.google.android.voicesearch.AUDIO_FILE_ACCESS in package com.google.android.gm
W/RecognitionManagerService( 1571): no available voice recognition services found
I/ActivityManager( 1571): Start proc com.android.voicedialer for broadcast com.android.voicedialer/.VoiceDialerReceiver: pid=2130 uid=10033 gids={3002}
I/ActivityManager( 1571): No longer want com.android.voicedialer (pid 2130): hidden #16
I/ActivityManager( 1571): Force stopping package com.google.android.voicesearch uid=10074
W/PackageManager( 1571): Unknown permission com.google.android.apps.googlevoice.permission.AUTO_SEND in package com.google.android.voicesearch
D/BackupManagerService( 1571): Received broadcast Intent { act=android.intent.action.PACKAGE_ADDED dat=package:com.google.android.voicesearch flg=0x10000010 (has extras) } 
```

想知道为什么，我查看了[Manifest.permission](http://developer.android.com/reference/android/Manifest.permission.html)列表，但找不到任何提及：

*   快捷方式_访问
*   AUDIO_FILE_ACCESS
*   自动发送

这些权限是什么？我可以在哪里了解有关它们的更多信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T20:29:28.913

这些权限在 Voice Search APK 和 GMail APK 中定义。它们是私有权限，受 APK 签名保护。

它们用于限制对内部应用程序数据和私有 Intent 目标的访问，并且不打算对用户可见。

# android - 使用自编译的 Android 4.1 拒绝连接

> ID：12041398
> 
> 赞同：2
> 
> 时间：2012-08-20T16:22:00.853
> 
> 标签：android, android-emulator, android-source, android-build

我下载并编译了 Android 4.1 源代码（全英配置）。我在 VirtualBox 中运行 Ubuntu 12.04。但是，当我尝试运行模拟器时，我只会在模拟设备上看到黑屏。模拟器和模拟设备之间的网络连接似乎存在问题，如日志末尾的错误所示。我附上了 `emulator -debug all`下面的输出。任何有关导致连接问题的原因或如何让模拟器正常运行的帮助将不胜感激。谢谢。

日志：

```
emulator: autoconfig: -datadir out/target/product/generic/
emulator: Found target ABI=armeabi-v7a, architecture=arm
emulator: Found target API level: 15
emulator: using core hw config path: out/target/product/generic//hardware-qemu.ini
emulator: Probing skin directory: out/target/product/generic//skins/HVGA
emulator:     ignore bad skin directory out/target/product/generic//skins/HVGA
emulator: Probing skin directory: out/target/product/generic//development/tools/emulator/skins/HVGA
emulator:     ignore bad skin directory out/target/product/generic//development/tools/emulator/skins/HVGA
emulator: Probing skin directory: out/target/product/skins/HVGA
emulator:     ignore bad skin directory out/target/product/skins/HVGA
emulator: Probing skin directory: out/target/product/generic//skins/HVGA
emulator:     ignore bad skin directory out/target/product/generic//skins/HVGA
emulator: Probing skin directory: out/target/product/generic//development/tools/emulator/skins/HVGA
emulator:     ignore bad skin directory out/target/product/generic//development/tools/emulator/skins/HVGA
emulator: Probing skin directory: out/target/product/skins/HVGA
emulator:     ignore bad skin directory out/target/product/skins/HVGA
emulator: autoconfig: -skin HVGA
emulator: autoconfig: -skindir (null)
emulator: no skin-specific hardware.ini in (null)
emulator: adding binding BUTTON_CALL to F3
emulator: adding binding BUTTON_HANGUP to F4
emulator: adding binding BUTTON_HOME to HOME
emulator: adding binding BUTTON_BACK to ESCAPE
emulator: adding binding BUTTON_MENU to F2
emulator: adding binding BUTTON_MENU to PAGEUP
emulator: adding binding BUTTON_STAR to Shift-F2
emulator: adding binding BUTTON_STAR to PAGEDOWN
emulator: adding binding BUTTON_POWER to F7
emulator: adding binding BUTTON_SEARCH to F5
emulator: adding binding BUTTON_CAMERA to Ctrl-KEYPAD_5
emulator: adding binding BUTTON_CAMERA to Ctrl-F3
emulator: adding binding BUTTON_VOLUME_UP to KEYPAD_PLUS
emulator: adding binding BUTTON_VOLUME_UP to Ctrl-F5
emulator: adding binding BUTTON_VOLUME_DOWN to KEYPAD_MINUS
emulator: adding binding BUTTON_VOLUME_DOWN to Ctrl-F6
emulator: adding binding TOGGLE_NETWORK to F8
emulator: adding binding TOGGLE_TRACING to F9
emulator: adding binding TOGGLE_FULLSCREEN to Alt-ENTER
emulator: adding binding BUTTON_DPAD_CENTER to KEYPAD_5
emulator: adding binding BUTTON_DPAD_UP to KEYPAD_8
emulator: adding binding BUTTON_DPAD_LEFT to KEYPAD_4
emulator: adding binding BUTTON_DPAD_RIGHT to KEYPAD_6
emulator: adding binding BUTTON_DPAD_DOWN to KEYPAD_2
emulator: adding binding TOGGLE_TRACKBALL to F6
emulator: adding binding SHOW_TRACKBALL to DELETE
emulator: adding binding CHANGE_LAYOUT_PREV to KEYPAD_7
emulator: adding binding CHANGE_LAYOUT_PREV to Ctrl-F11
emulator: adding binding CHANGE_LAYOUT_NEXT to KEYPAD_9
emulator: adding binding CHANGE_LAYOUT_NEXT to Ctrl-F12
emulator: adding binding ONION_ALPHA_UP to KEYPAD_MULTIPLY
emulator: adding binding ONION_ALPHA_DOWN to KEYPAD_DIVIDE
emulator: keyset loaded from: /home/tobi/.android/default.keyset
emulator: /home/tobi/.android/emulator-user.ini: parsing as .ini file
emulator:    1: KEY='window.x' VALUE='464'
emulator:    2: KEY='window.y' VALUE='153'
emulator:    3: KEY='uuid' VALUE='1343139837397'
emulator: /home/tobi/.android/emulator-user.ini: parsing finished
emulator: skin name 'HVGA' aliased to '320x480'
emulator: found magic skin width=320 height=480 bpp=16

emulator: Using initial system image: out/target/product/generic/system.img
emulator: autoconfig: -initdata out/target/product/generic//userdata.img
emulator: Physical RAM size: 512MB

emulator: Found target ABI=armeabi-v7a
emulator: Auto-config: -qemu -cpu cortex-a8
emulator: <memoryFile>: parsing as .ini file
emulator: <memoryFile>: parsing finished
Content of hardware configuration file:
  hw.cpu.arch = arm
  hw.cpu.model = cortex-a8
  hw.ramSize = 512
  hw.screen = touch
  hw.mainKeys = yes
  hw.trackBall = yes
  hw.keyboard = no
  hw.keyboard.lid = no
  hw.keyboard.charmap = qwerty2
  hw.dPad = yes
  hw.gsmModem = yes
  hw.gps = yes
  hw.battery = yes
  hw.accelerometer = yes
  hw.audioInput = yes
  hw.audioOutput = yes
  hw.sdCard = yes
  hw.sdCard.path = sdcard.img
  disk.cachePartition = yes
  disk.cachePartition.size = 66m
  hw.lcd.width = 320
  hw.lcd.height = 480
  hw.lcd.depth = 16
  hw.lcd.density = 160
  hw.lcd.backlight = yes
  hw.gpu.enabled = no
  hw.camera.back = emulated
  hw.camera.front = none
  vm.heapSize = 48
  hw.sensors.proximity = yes
  hw.sensors.magnetic_field = yes
  hw.sensors.orientation = yes
  hw.sensors.temperature = yes
  kernel.path = prebuilts/qemu-kernel/arm/kernel-qemu
  kernel.parameters =  android.checkjni=1
  disk.ramdisk.path = out/target/product/generic/ramdisk.img
  disk.systemPartition.initPath = out/target/product/generic/system.img
  disk.systemPartition.size = 1g
  disk.dataPartition.path = out/target/product/generic//out/target/product/generic/userdata.img
  disk.dataPartition.size = 1g
  avd.name = <build>
.
QEMU options list:
emulator: argv[00] = "out/host/linux-x86/bin/emulator64-arm"
emulator: argv[01] = "-android-hw"
emulator: argv[02] = "out/target/product/generic//hardware-qemu.ini"
Concatenated QEMU options:
 out/host/linux-x86/bin/emulator64-arm -android-hw out/target/product/generic//hardware-qemu.ini
emulator: android_qemud_init
emulator: Registered QEMUD service boot-properties
emulator: registered 'boot-properties' qemud service
emulator: android_qemud_init
emulator: Registered QEMUD service hw-control
emulator: android_hw_control_init: hw-control qemud handler initialized
emulator: out/target/product/generic//hardware-qemu.ini: parsing as .ini file
emulator:    1: KEY='hw.cpu.arch' VALUE='arm'
emulator:    2: KEY='hw.cpu.model' VALUE='cortex-a8'
emulator:    3: KEY='hw.ramSize' VALUE='512'
emulator:    4: KEY='hw.screen' VALUE='touch'
emulator:    5: KEY='hw.mainKeys' VALUE='yes'
emulator:    6: KEY='hw.trackBall' VALUE='yes'
emulator:    7: KEY='hw.keyboard' VALUE='no'
emulator:    8: KEY='hw.keyboard.lid' VALUE='no'
emulator:    9: KEY='hw.keyboard.charmap' VALUE='qwerty2'
emulator:   10: KEY='hw.dPad' VALUE='yes'
emulator:   11: KEY='hw.gsmModem' VALUE='yes'
emulator:   12: KEY='hw.gps' VALUE='yes'
emulator:   13: KEY='hw.battery' VALUE='yes'
emulator:   14: KEY='hw.accelerometer' VALUE='yes'
emulator:   15: KEY='hw.audioInput' VALUE='yes'
emulator:   16: KEY='hw.audioOutput' VALUE='yes'
emulator:   17: KEY='hw.sdCard' VALUE='yes'
emulator:   18: KEY='hw.sdCard.path' VALUE='sdcard.img'
emulator:   19: KEY='disk.cachePartition' VALUE='yes'
emulator:   20: KEY='disk.cachePartition.size' VALUE='66m'
emulator:   21: KEY='hw.lcd.width' VALUE='320'
emulator:   22: KEY='hw.lcd.height' VALUE='480'
emulator:   23: KEY='hw.lcd.depth' VALUE='16'
emulator:   24: KEY='hw.lcd.density' VALUE='160'
emulator:   25: KEY='hw.lcd.backlight' VALUE='yes'
emulator:   26: KEY='hw.gpu.enabled' VALUE='no'
emulator:   27: KEY='hw.camera.back' VALUE='emulated'
emulator:   28: KEY='hw.camera.front' VALUE='none'
emulator:   29: KEY='vm.heapSize' VALUE='48'
emulator:   30: KEY='hw.sensors.proximity' VALUE='yes'
emulator:   31: KEY='hw.sensors.magnetic_field' VALUE='yes'
emulator:   32: KEY='hw.sensors.orientation' VALUE='yes'
emulator:   33: KEY='hw.sensors.temperature' VALUE='yes'
emulator:   34: KEY='kernel.path' VALUE='prebuilts/qemu-kernel/arm/kernel-qemu'
emulator:   35: KEY='kernel.parameters' VALUE='android.checkjni=1'
emulator:   36: KEY='disk.ramdisk.path' VALUE='out/target/product/generic/ramdisk.img'
emulator:   37: KEY='disk.systemPartition.initPath' VALUE='out/target/product/generic/system.img'
emulator:   38: KEY='disk.systemPartition.size' VALUE='1g'
emulator:   39: KEY='disk.dataPartition.path' VALUE='out/target/product/generic//out/target/product/generic/userdata.img'
emulator:   40: KEY='disk.dataPartition.size' VALUE='1g'
emulator:   41: KEY='avd.name' VALUE='<build>'
emulator: out/target/product/generic//hardware-qemu.ini: parsing finished
emulator: nand_add_dev: system,size=0x40000000,initfile=out/target/product/generic/system.img
emulator: mapping 'system' NAND image to /tmp/android-tobi/emulator-b5DFo1
emulator: rounding devsize up to a full eraseunit, now 40008000

emulator: nand_add_dev: userdata,size=0x40000000
emulator: mapping 'userdata' NAND image to /tmp/android-tobi/emulator-Jya97P
emulator: rounding devsize up to a full eraseunit, now 40008000

emulator: android_qemud_init
emulator: Registered QEMUD service boot-properties
emulator: registered 'boot-properties' qemud service
emulator: Adding boot property: 'dalvik.vm.heapsize' = '48m'
emulator: Adding boot property: 'qemu.sf.lcd_density' = '160'
emulator: Adding boot property: 'qemu.hw.mainkeys' = '1'
emulator: android_qemud_init
emulator: Registered QEMUD service gsm
emulator: android_qemud_init
emulator: Registered QEMUD service gps
emulator: Adding boot property: 'qemu.sf.fake_camera' = 'back'
emulator: android_qemud_init
emulator: Registered QEMUD service camera
emulator: android_camera_service_init: Registered 'camera' qemud service
emulator: IP address of your DNS(s): 127.0.0.1
emulator: nand_add_dev: cache,size=0x4200000
emulator: mapping 'cache' NAND image to /tmp/android-tobi/emulator-xvZxgQ
emulator: Initializing hardware OpenGLES emulation support
Failed to create Context 0x3005
emulator: Can't start OpenGLES renderer?
emulator: WARNING: Could not initialize OpenglES emulation, using software renderer.
emulator: Kernel parameters: qemu.gles=0 qemu=1 console=ttyS0 android.qemud=ttyS1 android.checkjni=1 ndns=1
emulator: qpa_audio_init: entering
emulator: qpa_audio_init: exiting
emulator: Trace file name is not set

emulator: autoconfig: -scale 1
emulator: android_qemud_init
emulator: Registered QEMUD service sensors
emulator: android_hw_sensors_init: sensors qemud service initialized
emulator: Found ro.adb.qemud build property: 1
emulator: ADB server has been initialized for port 5555\. Socket: 23
emulator: android_qemud_init
emulator: Registered QEMUD service adb
emulator: android_adb_service_init: Registered 'adb' qemud service
emulator: android_qemud_init
emulator: Registered QEMUD service adb-debug
emulator: Registered 'adb-debug' qemud service
emulator: control console listening on port 5554, ADB on port 5555
emulator: can't connect to ADB server: Connection refused
emulator: ping program: /media/Android/jellybean/out/host/linux-x86/bin/ddms
emulator: ping command: /media/Android/jellybean/out/host/linux-x86/bin/ddms ping emulator 20.0 "" "" ""
emulator: Error while connecting to socket '127.0.0.1:1970': 111 -> Connection refused
emulator: ASC 127.0.0.1:1970: Retrying connection. Connector FD = 22
emulator: User-config was not changed.
emulator: autoconfig: -datadir out/target/product/generic/
emulator: Found target ABI=armeabi-v7a, architecture=arm
emulator: Found target API level: 15
emulator: using core hw config path: out/target/product/generic//hardware-qemu.ini
emulator: Probing skin directory: out/target/product/generic//skins/HVGA
emulator:     ignore bad skin directory out/target/product/generic//skins/HVGA
emulator: Probing skin directory: out/target/product/generic//development/tools/emulator/skins/HVGA
emulator:     ignore bad skin directory out/target/product/generic//development/tools/emulator/skins/HVGA
emulator: Probing skin directory: out/target/product/skins/HVGA
emulator:     ignore bad skin directory out/target/product/skins/HVGA
emulator: Probing skin directory: out/target/product/generic//skins/HVGA
emulator:     ignore bad skin directory out/target/product/generic//skins/HVGA
emulator: Probing skin directory: out/target/product/generic//development/tools/emulator/skins/HVGA
emulator:     ignore bad skin directory out/target/product/generic//development/tools/emulator/skins/HVGA
emulator: Probing skin directory: out/target/product/skins/HVGA
emulator:     ignore bad skin directory out/target/product/skins/HVGA
emulator: autoconfig: -skin HVGA
emulator: autoconfig: -skindir (null)
emulator: no skin-specific hardware.ini in (null)
emulator: adding binding BUTTON_CALL to F3
emulator: adding binding BUTTON_HANGUP to F4
emulator: adding binding BUTTON_HOME to HOME
emulator: adding binding BUTTON_BACK to ESCAPE
emulator: adding binding BUTTON_MENU to F2
emulator: adding binding BUTTON_MENU to PAGEUP
emulator: adding binding BUTTON_STAR to Shift-F2
emulator: adding binding BUTTON_STAR to PAGEDOWN
emulator: adding binding BUTTON_POWER to F7
emulator: adding binding BUTTON_SEARCH to F5
emulator: adding binding BUTTON_CAMERA to Ctrl-KEYPAD_5
emulator: adding binding BUTTON_CAMERA to Ctrl-F3
emulator: adding binding BUTTON_VOLUME_UP to KEYPAD_PLUS
emulator: adding binding BUTTON_VOLUME_UP to Ctrl-F5
emulator: adding binding BUTTON_VOLUME_DOWN to KEYPAD_MINUS
emulator: adding binding BUTTON_VOLUME_DOWN to Ctrl-F6
emulator: adding binding TOGGLE_NETWORK to F8
emulator: adding binding TOGGLE_TRACING to F9
emulator: adding binding TOGGLE_FULLSCREEN to Alt-ENTER
emulator: adding binding BUTTON_DPAD_CENTER to KEYPAD_5
emulator: adding binding BUTTON_DPAD_UP to KEYPAD_8
emulator: adding binding BUTTON_DPAD_LEFT to KEYPAD_4
emulator: adding binding BUTTON_DPAD_RIGHT to KEYPAD_6
emulator: adding binding BUTTON_DPAD_DOWN to KEYPAD_2
emulator: adding binding TOGGLE_TRACKBALL to F6
emulator: adding binding SHOW_TRACKBALL to DELETE
emulator: adding binding CHANGE_LAYOUT_PREV to KEYPAD_7
emulator: adding binding CHANGE_LAYOUT_PREV to Ctrl-F11
emulator: adding binding CHANGE_LAYOUT_NEXT to KEYPAD_9
emulator: adding binding CHANGE_LAYOUT_NEXT to Ctrl-F12
emulator: adding binding ONION_ALPHA_UP to KEYPAD_MULTIPLY
emulator: adding binding ONION_ALPHA_DOWN to KEYPAD_DIVIDE
emulator: keyset loaded from: /home/tobi/.android/default.keyset
emulator: /home/tobi/.android/emulator-user.ini: parsing as .ini file
emulator:    1: KEY='window.x' VALUE='464'
emulator:    2: KEY='window.y' VALUE='153'
emulator:    3: KEY='uuid' VALUE='1343139837397'
emulator: /home/tobi/.android/emulator-user.ini: parsing finished
emulator: skin name 'HVGA' aliased to '320x480'
emulator: found magic skin width=320 height=480 bpp=16

emulator: Using initial system image: out/target/product/generic/system.img
emulator: autoconfig: -initdata out/target/product/generic//userdata.img
emulator: Physical RAM size: 512MB

emulator: Found target ABI=armeabi-v7a
emulator: Auto-config: -qemu -cpu cortex-a8
emulator: <memoryFile>: parsing as .ini file
emulator: <memoryFile>: parsing finished
Content of hardware configuration file:
  hw.cpu.arch = arm
  hw.cpu.model = cortex-a8
  hw.ramSize = 512
  hw.screen = touch
  hw.mainKeys = yes
  hw.trackBall = yes
  hw.keyboard = no
  hw.keyboard.lid = no
  hw.keyboard.charmap = qwerty2
  hw.dPad = yes
  hw.gsmModem = yes
  hw.gps = yes
  hw.battery = yes
  hw.accelerometer = yes
  hw.audioInput = yes
  hw.audioOutput = yes
  hw.sdCard = yes
  hw.sdCard.path = sdcard.img
  disk.cachePartition = yes
  disk.cachePartition.size = 66m
  hw.lcd.width = 320
  hw.lcd.height = 480
  hw.lcd.depth = 16
  hw.lcd.density = 160
  hw.lcd.backlight = yes
  hw.gpu.enabled = no
  hw.camera.back = emulated
  hw.camera.front = none
  vm.heapSize = 48
  hw.sensors.proximity = yes
  hw.sensors.magnetic_field = yes
  hw.sensors.orientation = yes
  hw.sensors.temperature = yes
  kernel.path = prebuilts/qemu-kernel/arm/kernel-qemu
  kernel.parameters =  android.checkjni=1
  disk.ramdisk.path = out/target/product/generic/ramdisk.img
  disk.systemPartition.initPath = out/target/product/generic/system.img
  disk.systemPartition.size = 1g
  disk.dataPartition.path = out/target/product/generic//out/target/product/generic/userdata.img
  disk.dataPartition.size = 1g
  avd.name = <build>
.
QEMU options list:
emulator: argv[00] = "out/host/linux-x86/bin/emulator64-arm"
emulator: argv[01] = "-android-hw"
emulator: argv[02] = "out/target/product/generic//hardware-qemu.ini"
Concatenated QEMU options:
 out/host/linux-x86/bin/emulator64-arm -android-hw out/target/product/generic//hardware-qemu.ini
emulator: android_qemud_init
emulator: Registered QEMUD service boot-properties
emulator: registered 'boot-properties' qemud service
emulator: android_qemud_init
emulator: Registered QEMUD service hw-control
emulator: android_hw_control_init: hw-control qemud handler initialized
emulator: out/target/product/generic//hardware-qemu.ini: parsing as .ini file
emulator:    1: KEY='hw.cpu.arch' VALUE='arm'
emulator:    2: KEY='hw.cpu.model' VALUE='cortex-a8'
emulator:    3: KEY='hw.ramSize' VALUE='512'
emulator:    4: KEY='hw.screen' VALUE='touch'
emulator:    5: KEY='hw.mainKeys' VALUE='yes'
emulator:    6: KEY='hw.trackBall' VALUE='yes'
emulator:    7: KEY='hw.keyboard' VALUE='no'
emulator:    8: KEY='hw.keyboard.lid' VALUE='no'
emulator:    9: KEY='hw.keyboard.charmap' VALUE='qwerty2'
emulator:   10: KEY='hw.dPad' VALUE='yes'
emulator:   11: KEY='hw.gsmModem' VALUE='yes'
emulator:   12: KEY='hw.gps' VALUE='yes'
emulator:   13: KEY='hw.battery' VALUE='yes'
emulator:   14: KEY='hw.accelerometer' VALUE='yes'
emulator:   15: KEY='hw.audioInput' VALUE='yes'
emulator:   16: KEY='hw.audioOutput' VALUE='yes'
emulator:   17: KEY='hw.sdCard' VALUE='yes'
emulator:   18: KEY='hw.sdCard.path' VALUE='sdcard.img'
emulator:   19: KEY='disk.cachePartition' VALUE='yes'
emulator:   20: KEY='disk.cachePartition.size' VALUE='66m'
emulator:   21: KEY='hw.lcd.width' VALUE='320'
emulator:   22: KEY='hw.lcd.height' VALUE='480'
emulator:   23: KEY='hw.lcd.depth' VALUE='16'
emulator:   24: KEY='hw.lcd.density' VALUE='160'
emulator:   25: KEY='hw.lcd.backlight' VALUE='yes'
emulator:   26: KEY='hw.gpu.enabled' VALUE='no'
emulator:   27: KEY='hw.camera.back' VALUE='emulated'
emulator:   28: KEY='hw.camera.front' VALUE='none'
emulator:   29: KEY='vm.heapSize' VALUE='48'
emulator:   30: KEY='hw.sensors.proximity' VALUE='yes'
emulator:   31: KEY='hw.sensors.magnetic_field' VALUE='yes'
emulator:   32: KEY='hw.sensors.orientation' VALUE='yes'
emulator:   33: KEY='hw.sensors.temperature' VALUE='yes'
emulator:   34: KEY='kernel.path' VALUE='prebuilts/qemu-kernel/arm/kernel-qemu'
emulator:   35: KEY='kernel.parameters' VALUE='android.checkjni=1'
emulator:   36: KEY='disk.ramdisk.path' VALUE='out/target/product/generic/ramdisk.img'
emulator:   37: KEY='disk.systemPartition.initPath' VALUE='out/target/product/generic/system.img'
emulator:   38: KEY='disk.systemPartition.size' VALUE='1g'
emulator:   39: KEY='disk.dataPartition.path' VALUE='out/target/product/generic//out/target/product/generic/userdata.img'
emulator:   40: KEY='disk.dataPartition.size' VALUE='1g'
emulator:   41: KEY='avd.name' VALUE='<build>'
emulator: out/target/product/generic//hardware-qemu.ini: parsing finished
emulator: nand_add_dev: system,size=0x40000000,initfile=out/target/product/generic/system.img
emulator: mapping 'system' NAND image to /tmp/android-tobi/emulator-UZrNgA
emulator: rounding devsize up to a full eraseunit, now 40008000

emulator: nand_add_dev: userdata,size=0x40000000
emulator: mapping 'userdata' NAND image to /tmp/android-tobi/emulator-4zxtnk
emulator: rounding devsize up to a full eraseunit, now 40008000

emulator: android_qemud_init
emulator: Registered QEMUD service boot-properties
emulator: registered 'boot-properties' qemud service
emulator: Adding boot property: 'dalvik.vm.heapsize' = '48m'
emulator: Adding boot property: 'qemu.sf.lcd_density' = '160'
emulator: Adding boot property: 'qemu.hw.mainkeys' = '1'
emulator: android_qemud_init
emulator: Registered QEMUD service gsm
emulator: android_qemud_init
emulator: Registered QEMUD service gps
emulator: Adding boot property: 'qemu.sf.fake_camera' = 'back'
emulator: android_qemud_init
emulator: Registered QEMUD service camera
emulator: android_camera_service_init: Registered 'camera' qemud service
emulator: IP address of your DNS(s): 127.0.0.1
emulator: nand_add_dev: cache,size=0x4200000
emulator: mapping 'cache' NAND image to /tmp/android-tobi/emulator-g1kmDf
emulator: Initializing hardware OpenGLES emulation support
Failed to create Context 0x3005
emulator: Can't start OpenGLES renderer?
emulator: WARNING: Could not initialize OpenglES emulation, using software renderer.
emulator: Kernel parameters: qemu.gles=0 qemu=1 console=ttyS0 android.qemud=ttyS1 android.checkjni=1 ndns=1
emulator: qpa_audio_init: entering
emulator: qpa_audio_init: exiting
emulator: Trace file name is not set

emulator: autoconfig: -scale 1
emulator: android_qemud_init
emulator: Registered QEMUD service sensors
emulator: android_hw_sensors_init: sensors qemud service initialized
emulator: Found ro.adb.qemud build property: 1
emulator: ADB server has been initialized for port 5555\. Socket: 23
emulator: android_qemud_init
emulator: Registered QEMUD service adb
emulator: android_adb_service_init: Registered 'adb' qemud service
emulator: android_qemud_init
emulator: Registered QEMUD service adb-debug
emulator: Registered 'adb-debug' qemud service
emulator: control console listening on port 5554, ADB on port 5555
emulator: can't connect to ADB server: Connection refused
emulator: ping program: /media/Android/jellybean/out/host/linux-x86/bin/ddms
emulator: ping command: /media/Android/jellybean/out/host/linux-x86/bin/ddms ping emulator 20.0 "" "" ""
emulator: Error while connecting to socket '127.0.0.1:1970': 111 -> Connection refused
emulator: ASC 127.0.0.1:1970: Retrying connection. Connector FD = 22
emulator: could not handle (sym=306, mod=0, str=(null))
emulator: User-config was not changed. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-27T11:45:40.337

几乎使用相同的配置：full-eng generic -4.1.2 arm 我让它在 emulator-arm 下工作

请看很多截图，liveusb_image ,live_iso_image 允许在 ubuntu-12.04 中模拟 cyanogenmod

[https://sourceforge.net/projects/toysbox/files/Android-CyanogenMod/](https://sourceforge.net/projects/toysbox/files/Android-CyanogenMod/)

# php - 坚持使用变量 php 进行 301 重定向

> ID：12041399
> 
> 赞同：0
> 
> 时间：2012-08-20T16:22:07.267
> 
> 标签：php, .htaccess

我正在尝试在我们的 .htaccess 文件中写入 301，但无法正常工作。我们的 url 如下所示……</p>

```
http://www.example.com/?cat=tree-category

http://www.example.com/?cat=food-category 
```

我们想将这些更改为

```
http://www.example.com/directory/listings/tree-category

http://www.example.com/directory/listings/food-category 
```

谁能帮忙，将不胜感激！

詹姆士

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T16:28:13.677

这应该这样做：

```
RewriteEngine On
RewriteCond %{REQUEST_URI}  ^/$
RewriteCond %{QUERY_STRING} ^cat=([a-zA-Z0-9\-]*)$
RewriteRule ^(.*)$ http://www.example.com/directory/listings/%1 [R=301,L] 
```

查看：[http ://www.simonecarletti.com/blog/2009/01/apache-query-string-redirects/](http://www.simonecarletti.com/blog/2009/01/apache-query-string-redirects/)

# c# - 在组合框中预选 Treeview 的值

> ID：12041401
> 
> 赞同：1
> 
> 时间：2012-08-20T16:22:20.840
> 
> 标签：c#, wpf, combobox, treeview

我正在寻找在组合框中实现树视图。基本上我希望它在折叠时显示为组合框，但在展开时显示为组合框内的树视图。当用户单击一个节点时，我希望它显示在折叠的组合框中。到目前为止，我已经完成了这项工作。

我遇到的问题是，加载此组合框时如何从 c# 显示默认值。请帮助大家，因为我的想法不多了:)

提前致谢。

数据模板

```
 <DataTemplate x:Key="TreeViewExpanded" >

        <StackPanel>
            <TreeView x:Name="DPointTree" Margin="5" ItemsSource="{Binding Datapoint}" 
                              Tag="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ComboBox}}}"
                              >
                <TreeView.ItemTemplate>
                    <HierarchicalDataTemplate ItemsSource="{Binding Field}">
                        <TextBlock Text="{Binding Name}"/>
                                <HierarchicalDataTemplate.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding}"/>
                                    </DataTemplate>
                                </HierarchicalDataTemplate.ItemTemplate>
                            </HierarchicalDataTemplate>
                </TreeView.ItemTemplate>
            </TreeView>
        </StackPanel>
        <DataTemplate.Triggers>
            <DataTrigger Binding = "{Binding Path=SelectedFieldName, Mode=TwoWay}" Value = "">
                <Setter Property = "Visibility"  Value = "Collapsed"/>
            </DataTrigger>
        </DataTemplate.Triggers>
</DataTemplate> 
```

这是 Xaml

```
 <ComboBox Name="cmbFieldName" Width="150" Background="White" ItemsSource="{Binding}" SelectedItem="{Binding SelectedFieldName , Mode=TwoWay}" >
            <ComboBox.ItemTemplateSelector>
                <local:TreeViewSelector/>
            </ComboBox.ItemTemplateSelector>
        </ComboBox> 
```

这是传递给它的 DataSet。

```
Datapoint _datapoint2 = new Datapoint();
        _datapoint2.Name = "Alpha";
        _datapoint2.FieldID.Add("Contains Elements");
        _datapoint2.Field.Add("1 Year");
        _datapoint2.Field.Add("2 Year");
        _datapoint2.Field.Add("3 Year"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T06:09:34.780

它不漂亮，但可以在树中选择一个节点

```
// in code behind after the tree is declared, e.g. after InitializeComponent();
SynchronizationContext.Current.Post(delegate
{
    // expand the tree to the selected node after loading
    treeView.ExpandAll(); // or if path is known treeView.ExpandPath(...);
    SynchronizationContext.Current.Post(delegate
    {
        treeView.GetContainerFromItem(root.Children[0]).IsSelected = true;
    }, null);
}, null); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T06:16:31.397

试试这个：

```
private void TreeView_Loaded(object sender, RoutedEventArgs e)
        {
            TreeView areaTreeView = sender as TreeView;

            // Expand the treeview
            if (areaTreeView != null)
            {
                ExpandCollapseTreeNodes(areaTreeView, true);
            }
        }

public static void ExpandCollapseTreeNodes(ItemsControl parentContainer, bool isExpanded)
        {
            foreach (Object item in parentContainer.Items)
            {
                TreeViewItem currentContainer = parentContainer.ItemContainerGenerator.ContainerFromItem(item) as TreeViewItem;
                if (currentContainer != null) // && currentContainer.Items.Count > 0
                {
                    //expand the item
                    currentContainer.IsExpanded = isExpanded;                    

                    //if the item's children are not generated, they must be expanded
                    if (isExpanded && currentContainer.ItemContainerGenerator.Status != GeneratorStatus.ContainersGenerated)
                    {
                        //store the event handler in a variable so we can remove it (in the handler itself)
                        EventHandler eh = null;
                        eh = new EventHandler(delegate
                        {
                            //once the children have been generated, expand those children's children then remove the event handler
                            if (currentContainer.ItemContainerGenerator.Status == GeneratorStatus.ContainersGenerated)
                            {
                                ExpandCollapseTreeNodes(currentContainer, isExpanded);
                                currentContainer.ItemContainerGenerator.StatusChanged -= eh;
                            }
                        });

                        currentContainer.ItemContainerGenerator.StatusChanged += eh;
                    }
                    //otherwise the children have already been generated, so we can now expand those children
                    else
                    {
                        ExpandCollapseTreeNodes(currentContainer, isExpanded);
                    }
                }
            }
        } 
```

# vim - 当名称中包含“build”时，vim xml 文件类型设置为“ant”

> ID：12041402
> 
> 赞同：0
> 
> 时间：2012-08-20T16:22:26.100
> 
> 标签：vim, file-type

当打开名称为“build”的 xml 文件时，我注意到 vim 将其文件类型设置为“ant”。可以禁用此行为吗？我希望我的所有 xml 文件都将文件类型设置为 xml。Kindle帮我解决了这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T16:36:08.750

Ant 文件类型检测器由下面调用

```
au BufNewFile,BufRead build.xml         setf ant 
```

要覆盖，只需将其更改为 ~/.vimrc 中的 xml

```
au BufNewFile,BufRead build.xml         setf xml 
```

[vimdoc](http://vim.dindinx.net/orig/html/filetype.txt.php#%3afiletype)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T16:35:02.113

这是在第 107 行`:e $VIMRUNTIME/filetype.vim`。它将名为“build.xml”的文件设置为 ant 的文件类型。您可以将此文件复制到您的`~/.vim`文件夹并对其进行编辑以将其注释掉。

# svg - SVG 元素的框模型属性（边距、填充）。他们受支持吗？

> ID：12041403
> 
> 赞同：4
> 
> 时间：2012-08-20T16:22:29.903
> 
> 标签：svg, margin, padding, css

是否有可能以某种方式将 html 框模型属性应用于 SVG 中的基本形状元素？例如应用于`margin`元素`<rect>`。我找到了不可能的解释：

> display、float 和 flow 属性以及所有的 margin、padding、border 和 background 属性可以应用于顶级 svg 元素，但不能应用于其中的子元素。

但也许有一些技术可以使它成为可能？我想创建`<rect>`带边距的元素。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-21T08:05:14.230

svg 中没有流布局，因此边距的概念必须以绝对值来完成（阅读：手动）。

更详细地解释您的用例？

# fonts - 网页设计 - 在服务器上包含字体或类似字体？

> ID：12041405
> 
> 赞同：1
> 
> 时间：2012-08-20T16:22:32.227
> 
> 标签：fonts

我遇到的一个问题是使用 CSS 的字体系列代码来更改我网站文本的字体。但是，问题是我需要的字体不是 Windows 原生的。我知道我可以下载字体并像那样查看它。但这对我的观众来说当然不是一个有效的解决方案。有什么方法可以在我的服务器上包含一个字体包，以便所有查看器（无论操作系统或拥有字体）都可以查看我选择的字体吗？任何帮助都会很棒！谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T21:25:23.143

谷歌字体是最好的方法！在样式表中使用 @import 是我得到它的方式！

# mysql - 如何在不进行完整索引扫描的情况下使用 group by 进行 sql 自联接

> ID：12041408
> 
> 赞同：1
> 
> 时间：2012-08-20T16:22:40.237
> 
> 标签：mysql, sql, group-by, self-join

如果这在其他地方有答案，请提前道歉 - 我确实努力寻找但找不到。

我有一个名为“item”的表，有点像这样：

```
itemid applicationid value
   1        1        3.00
   2        2        1.00
   3        2        2.00
   4        3        4.00
   5        3        1.00 
```

即一个应用程序可以有多个项目。还有更多的列，但没关系。我想根据申请总价值列出项目及其价值（以便我可以将项目价值计算为申请的比例）。

所以我有一个有点像这样的查询：

```
SELECT i.itemid, i2.applicationid, i.value, i2.totalvalue
FROM item i
JOIN (SELECT sum(value) AS totalvalue FROM item GROUP BY applicationid) i2
    ON i.applicationid = i2.applicationid
WHERE <some criteria that returns a hundred or so items>; 
```

给我

```
itemid applicationid value totalvalue
   1        1        3.00     3.00
   2        2        1.00     3.00
   3        2        2.00     3.00
   4        3        4.00     5.00
   5        3        1.00     5.00 
```

这可行，但是在项目表中有 100k 行时，它非常非常慢。我的探查器告诉我，问题在于有一个正在执行完整索引扫描的子查询。

我想知道使用 GROUP BY 的自联接是否会更快，但它不仅对第二个表进行分组，而且对所有内容进行分组。IE

```
SELECT i.itemid, i2.applicationid, i.value, sum(i2.value)
FROM item i
JOIN item i2 ON i2.applicationid = i.applicationid
WHERE <some criteria that returns a hundred or so items>
GROUP BY i2.applicationid; 
```

每个 applicationid 我只得到 1 行，而不是每个 itemid 1 行。

有什么方法可以重写我的原始查询以使其更快？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T17:54:12.243

您的查询没有子查询的连接条件，因此它在语法上不正确。您是否尝试过此查询：

```
SELECT i.itemid, i2.applicationid, i.value, i2.totalvalue
FROM item i JOIN
      (SELECT applicationid, sum(value) AS totalvalue
       FROM item
        GROUP BY applicationid
     ) i2
     on i.applicationid = i2.applicationid
WHERE <some criteria that returns a hundred or so items>; 
```

在某些数据库中，这可能作为相关子查询运行得更快，特别是如果您在 applicationid 上有索引：

```
SELECT i.itemid, i.applicationid, i.value,
       (select sum(value) from item i2 where i.applicationid = i2.applicationid
       ) as totalvalue
FROM item i JOIN
      (SELECT applicationid, sum(value) AS totalvalue
       FROM item
        GROUP BY applicationid
     ) i2
     on i.applicationid = i2.applicationid
WHERE <some criteria that returns a hundred or so items>; 
```

此外，这可能是您的 WHERE 标准再次减慢速度，具体取决于数据库。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-20T16:55:06.953

您可以尝试使用窗口函数来查看优化器是否很好地使用它们。我猜它会使用相同的执行计划，但值得一试。这是 SQL Server 的代码，它应该与 Oracle 类似。

```
SELECT i.itemid, i.applicationid, i.value, 
    sum(value) Over (Partition by i.applicationid) as totalvalue
FROM item i
WHERE <some criteria that returns a hundred or so items>; 
```

# google-docs-api - 如何检索用户的共享资源？

> ID：12041409
> 
> 赞同：0
> 
> 时间：2012-08-20T16:22:43.637
> 
> 标签：google-docs-api, google-drive-api

出于管理目的，尤其是取消配置过程，了解用户是否与其他用户共享了他的任何资源（文档、文件等）将很有用。

任何可以解决此任务的提示或代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T04:24:56.373

[`drive.permissions.list`](https://developers.google.com/drive/v2/reference/permissions/list)您可以使用以下请求检查授予用户对文件的哪些权限：

```
GET https://www.googleapis.com/drive/v2/files/{fileId}/permissions 
```

该响应为您提供有关哪些用户被授权与文件交互的信息，包括您可以选择存储在数据库中的用户的`id`, `name`, `role`, `type`...。

您可以使用[Google API Explorer进行测试](https://developers.google.com/apis-explorer/#s/drive/v2/drive.permissions.list)

# java - 为什么我的代码不能正常运行？(fileWriter, jTable)

> ID：12041412
> 
> 赞同：0
> 
> 时间：2012-08-20T16:22:53.083
> 
> 标签：java, swing, jtable, jfilechooser, filewriter

我的代码仍然存在一些问题。这次没有错误，只是无法正常运行！

这是代码： http: [//pastebin.com/nm633L1v](http://pastebin.com/nm633L1v)

什么不起作用（我认为）：

```
fileWriter
jTable 
```

第 3 方库：

```
OpenCSV 
```

文件选择器.FileFilter ：

只是要从我的代码中删除它。我认为没有必要了。

文件编写器：

这可能是 jTable 不显示 CSV 文件内容以供编辑的副作用，但当程序调用它时，它似乎不会保存或更新文件。

表：

这是之前抛出的所有错误，并且可能是我所有问题的真正 McFly。如果我确实在列中粘贴随机垃圾，则不显示输入 CSV 文件或保存表的内容。

我知道这是一堆不同的代码问题，但在我继续前进或将项目交给另一个人之前，这对我来说是一个问题，所以这里的任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T16:29:33.237

我不会浏览你所有的代码。我只是`FileFilter`快速浏览了一下。请注意，您可以使用 a[`FileNameExtensionFilter`](http://docs.oracle.com/javase/7/docs/api/javax/swing/filechooser/FileNameExtensionFilter.html)而不是实现自己的。

尽管我必须承认您的实现对我来说是正确的。不幸的是，没有显示您在文件选择器上设置过滤器的代码。

# project-management - Redmine 中子任务的用例是什么？

> ID：12041420
> 
> 赞同：4
> 
> 时间：2012-08-20T16:23:25.257
> 
> 标签：project-management, redmine

我阅读了[相关的问题](http://www.redmine.org/projects/redmine/wiki/RedmineIssues#Related-issues)和[子任务](http://www.redmine.org/projects/redmine/wiki/RedmineIssues#Subtasks)（包括[这个](http://www.redmine.org/issues/443)）。现在我对子任务的用例完全感到困惑。

如果我理解正确，子任务只是一种自动执行以下工作流程的相关问题：

*   父任务的完成百分比是子任务完成百分比的总和
*   父任务的截止日期是最后一个子任务的截止日期
*   父任务的花费时间是子任务花费时间的总和
*   父任务的优先级是子任务的最高优先级

如果没有这 4 个要点，子任务将与简单的“相关”没有什么不同（忽略一些 UI 差异）。正确的？

乍一看，我认为如果 S1 和 S2 是 T 的子任务，这意味着 S1 和 S2 是完成 T 的步骤。但显然这不是子任务背后的用例：

首先，因为在我的用例中，S1 和 S2 阻塞了 T，但子任务关系并不意味着这一点。

其次，因为在我的用例中，S1 和 S2 的优先级由 T 的优先级驱动，但对于子任务，T 的优先级由 S1 和 S2 驱动。

因此，我缺少的子任务必须有一个规范的用例。它是什么？

编辑：

为了让事情变得更加混乱，[这个问题](http://www.redmine.org/issues/5490)表明也许应该删除上述工作流程。如果发生这种情况，子任务与简单的“相关”有何不同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T15:28:34.927

我过去使用它的方式是，存在子任务以将更大的功能分解为可管理/可分配的块，这种方式比简单地使用 , 等进行关系更易于`blocked-by`管理`follows`。

Redmine/ChiliProject 中有很多功能是为了灵活性而存在的，即让用户或团队按照自己的方式管理项目，而不是试图将他们的工作流程或思维过程硬塞进围绕其他人的工作流程构建的盒子中。我认为子任务就是其中之一。它们对一些人有用，对另一些人无用，对更多人来说是彻头彻尾的危险。

# java - 经过 至

> ID：12041429
> 
> 赞同：1
> 
> 时间：2012-08-20T16:23:45.300
> 
> 标签：java, xslt, transform, href, transformer

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T16:42:49.520

**我通过设置全局`<xsl:param>`.**

在我使用`<xsl:param>`in one from 2`<xsl:template>`并尝试设置另一个的 href 之前`<xsl:template>`。

**[摘自关于 XSLT 参数用法的类似问题的答案：](https://stackoverflow.com/a/7379232/14419)**

> `<xsl:param>`可以在任何地方（作为 的子级`xsl:stylesheet`）在全局级别指定，或者如果它在模板内，则它必须是它的子级，并且必须在 的任何非子`xsl:param`级 之前`xsl:template`。
> 
> 这是允许模板或整个转换（在 global 的情况下`xsl:param`）分别从模板或整个转换的调用者/发起者接收不同数据的工具。

# java - 在 Spring 中编写自定义 PlaceholderResolver（如 PropertyPlaceholderConfigurerResolver）

> ID：12041432
> 
> 赞同：3
> 
> 时间：2012-08-20T16:23:54.727
> 
> 标签：java, spring, spring-el

我在 Web 应用程序中使用 MBean 来获取应用程序属性，很多人通常将这些属性放入属性文件中。MBean 将从数据库中写入和读取以实现持久性。

**我正在寻找一种方法来公开我的应用程序属性（从 (m) bean 到 Spring（例如 Spring EL、applicationContext.xml）。在很多应用程序中使用 PropertyPlaceholderConfigurerResolver 但因为我只有一个常规的 (m) Bean 我想将 bean 属性公开给 spring 表达式语言。**

我查看了 PropertyPlaceholderConfigurerResolver 以了解属性如何暴露给 Spring 表达式语言，但我不知道如何。

我想我需要编写一个自定义 PlaceholderResolver 来访问我的 MBean。我已经在谷歌上搜索了几个小时，所以我会很感激提示:)

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T18:47:23.707

我不熟悉 MBean，但我们的应用程序正在从数据库中获取应用程序设置，然后在我们的应用程序上下文中使用它们。我们只是扩展[PropertySourcesPlaceholderConfigurer](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/context/support/PropertySourcesPlaceholderConfigurer.html)，然后您只需要调用该`setPropertySources()`方法。在我们的构造函数中，我们有这样的东西：

```
MutablePropertySources propertySources = new MutablePropertySources();
Map<String, Object> propertiesFromDB = getPropertiesFromDB();
MapPropertySource propertySource = new MapPropertySource("propsFromDB", propertiesFromDB);
propertySources.addFirst(propertySource);
setPropertySources(propertySources); 
```

# c# - 给定 LINQ 查询，如何填充具有两列的 listView？

> ID：12041433
> 
> 赞同：2
> 
> 时间：2012-08-20T16:23:57.833
> 
> 标签：c#, linq, listview

我有一个包含文件的文件夹（此文件夹中的文件数量可能会有所不同）：

XXX_1.jpg
XXX_2.jpg
ZZZ_1.jpg
ZZZ_2.jpg
BBB_1.jpg
YYY_1.jpg

我想填充一个包含两列的列表视图：名称和计数。

在此示例中，listView 应如下所示：

XXX 2
ZZZ 2
BBB 1
YYY 1

我将如何构建一个 LINQ 查询以将名称和计数与文件夹中的项目分开，然后用文件的名称填充 listView + 它在目录中的次数？

我是这样开始的：

```
IEnumerable<string[]> groups = originalFiles
                                .GroupBy(policyName => policyName.Split('_')[0])
                                .Select(g => g.ToArray());

                foreach (var group in groups)
                {
                    //add group name + count in listView
                } 
```

我需要在某处添加 Count() 但我不太确定。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T16:39:17.057

尝试这个

```
var groups = orignalFiles.GroupBy(o => o.Split('_')[0])
                       .Select(o => new { 
                                           Name = o.FirstOrDefault().Split('_')[0], 
                                           Total = o.Count() 
                                        }); 
```

祝你好运 ！！

# mysql - 简单的 mysql 查询计数失败

> ID：12041436
> 
> 赞同：0
> 
> 时间：2012-08-20T16:24:04.150
> 
> 标签：mysql, sql, join

```
SELECT          
    count(t1.id) AS c1
FROM
    table2
    LEFT JOIN table1 AS t1 ON (t1.uid = table2.uid)
WHERE
    table2.mode = 'ls'
GROUP BY
    t1.id 
```

c1 = 6 -> 正确！

```
SELECT          
    count(t2.id) AS c2
FROM
    table2
    LEFT JOIN table1 AS t2 ON (t2.pid = table2.id)
WHERE
    table2.mode = 'ls'
GROUP BY
    t1.id 
```

c2 = 1 -> 正确！

```
SELECT          
    count(t1.id) AS c1,
    count(t2.id) AS c2
FROM
    table2
    LEFT JOIN table1 AS t1 ON (t1.uid = table2.uid)
    LEFT JOIN table1 AS t2 ON (t2.pid = table2.id)
WHERE
    table2.mode = 'ls'
GROUP BY
    t1.id 
```

c1 = 6 -> 正确！

**c2 = 6 -> 错误！**

**如何在一个查询中请求两个计数，而不会得到错误的结果？**

我需要在同一张表（table1）上计算两个不同的请求。

所以，我对这两个请求都使用了别名。(t1)。每个别名请求都可以单独工作。如果我在同一个查询中同时使用两者，我会得到错误的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T18:27:16.217

`count()` will get you the number of records that are returned by your query. Since if you removed the counts and replaced it with `*` you would have 6 rows both of those counts are giving you 6.

Is there any reason why you cant use two sub selects and return the result of each of those?

So:

```
SELECT subQ1.c1, subQ2.c2 FROM
    (SELECT count(t1.id) AS c1 FROM table2
        LEFT JOIN table1 AS t1 ON (t1.uid = table2.uid)
        WHERE table2.mode = 'ls') as subQ1, 
    (SELECT count(t2.id) AS c2 FROM table2
        LEFT JOIN table1 AS t2 ON (t2.pid = table2.id)
        WHERE table2.mode = 'ls') as SubQ2; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T17:47:33.823

我相信您对完整查询的问题是您按功能分组。您按 t.id 分组，因此 a1.id 将根据您拥有的行数有不同的计数。

我的意思是如果表 t 中有 6 行，那么 count 将为表 t 返回 6；而且由于表 a 上看起来存在 1 对 1 的关系，因此表 a 中有 6 个匹配行与表 t 中的 6 个匹配行。这样

t.id = a.id 1 = 1 2= 2 ...等等。

因此，您的计数是返回行数而不是您认为应该拥有的计数？我相信 sum 函数是你想在这里使用的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T16:32:30.270

你可以试试这个......但我不确定你想要做什么。

```
SELECT (...)
    count(CASE WHEN t1.uid = t3.uid THEN t1.id ELSE NULL END) AS CBanz,
    count(CASE WHEN ta1.pid = t3.id THEN a1.id ELSE NULL END) AS CBanz1
FROM
    t0
    LEFT JOIN (...)
    LEFT JOIN t1 ON (t1.uid = t3.uid)
    LEFT JOIN t1 AS a1 ON (a1.pid = t3.id)
WHERE (...) 
```

# titanium - 条纹和钛金属手机

> ID：12041437
> 
> 赞同：0
> 
> 时间：2012-08-20T16:24:17.770
> 
> 标签：titanium, titanium-mobile, stripe-payments

如何集成用于支付处理的条带 api，以允许人们通过我的钛移动应用程序支付服务费用。条纹网

我正在使用此代码开始： [https ://github.com/abh/node-stripe/blob/master/lib/main.js](https://github.com/abh/node-stripe/blob/master/lib/main.js)

如何确保信息已加密。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T17:42:09.867

首先，您需要确保您所销售的产品在物理上是站得住脚的，假设它是（并且您不销售任何形式的数字内容或应用程序中的功能），那么在 Titanium 中使用条带的最简单方法就是包装它在 web 视图中（您可以在本机代码中实现它，但这可能会让人厌烦）。

[假设您在资源目录中名为 index.html](https://stripe.com/docs/tutorials/forms)的文件中有此示例。

```
var webView = Ti.UI.createWebView({
    url : 'index.html    
});
win.add(webView); 
```

请注意，您需要让您的服务器支持 https 请求才能进行实际加密，您不应该自己加密（在代码中）。

完成此操作后，所有工作现在都在您的服务器上进行，以使用[Stripes 库处理付款，如文档中的此示例所示。](https://stripe.com/docs/tutorials/charges)

真的这是一个服务器工作，你所做的就是向服务器发送要处理的信息，除了作为网关之外，这里的 Titanium 并没有很多事情要做。

# python - 如何根据某些特定的 ABNF 规则使用 python 检查字符串？

> ID：12041439
> 
> 赞同：1
> 
> 时间：2012-08-20T16:24:29.627
> 
> 标签：python, regex, python-2.7

我需要检查一个字符串是否符合此规则：[http ://www.w3.org/TR/widgets/#zip-rel-path](http://www.w3.org/TR/widgets/#zip-rel-path)

```
Zip-rel-path   = [locale-folder] *folder-name file-name /
                 [locale-folder] 1*folder-name
locale-folder  = %x6C %x6F %x63 %x61 %x6C %x65 %x73
                 "/" lang-tag "/"
folder-name    = file-name "/"
file-name      = 1*allowed-char
allowed-char   = safe-char / zip-UTF8-char
zip-UTF8-char  = UTF8-2 / UTF8-3 / UTF8-4
safe-char      = ALPHA  / DIGIT / SP  / "$" / "%" / 
                 "'"    / "-"   / "_" / "@" / "~" /
                 "("    / ")"   / "&" / "+" / "," /
                 "="    / "["   / "]" / "."
UTF8-2         = %xC2-DF UTF8-tail
UTF8-3         = %xE0 %xA0-BF UTF8-tail / %xE1-EC 2( UTF8-tail ) /
                 %xED %x80-9F UTF8-tail / %xEE-EF 2( UTF8-tail )
UTF8-4         = %xF0 %x90-BF 2( UTF8-tail ) / %xF1-F3 3( UTF8-tail ) /
                 %xF4 %x80-8F 2( UTF8-tail )
UTF8-tail      = %x80-BF
lang-tag       = primary-subtag *( "-" subtag )
primary-subtag = 1*8low-alphasubtag         = 1*8(alphanum)
alphanum       = low-alpha  / DIGITlow-alpha      = %x61-7a 
```

完全符合上述规则的代码示例会有所帮助，我不熟悉 ABNF。我不需要解析 ABNF 的方法，我只需要由习惯或理解 ABNF 的人手动将上述规则翻译成带有正则表达式或任何其他方式的 python 代码。实际上，只需输入一个字符串并根据上述规则验证它最终作为一个输入字符串并在规则匹配与否时返回 true 或 false 的函数。所以用一个问题的形式来表达：这在 python 中会如何实现？

我从 UTF8 文档中看到，上述规则的大部分内容只是检查字符串是否为 utf8： [https ://www.rfc-editor.org/rfc/rfc3629](https://www.rfc-editor.org/rfc/rfc3629)

```
UTF8-char   = UTF8-1 / UTF8-2 / UTF8-3 / UTF8-4
   UTF8-1      = %x00-7F
   UTF8-2      = %xC2-DF UTF8-tail
   UTF8-3      = %xE0 %xA0-BF UTF8-tail / %xE1-EC 2( UTF8-tail ) /
                 %xED %x80-9F UTF8-tail / %xEE-EF 2( UTF8-tail )
   UTF8-4      = %xF0 %x90-BF 2( UTF8-tail ) / %xF1-F3 3( UTF8-tail ) /
                 %xF4 %x80-8F 2( UTF8-tail )
   UTF8-tail   = %x80-BF 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T16:31:59.123

您可能应该尝试[pyparsing](http://pyparsing.wikispaces.com/)。这是一个来自 pyparsing 网站的[快速示例](http://pyparsing.wikispaces.com/file/view/ebnf.py)，您可以轻松修改以适合您的目的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T09:31:18.603

我试图为你写一个解析器。

我同意批量是对 UTF-8 的测试，如果您已经在字符串中具有值，这是多余的（UTF-8 是文件系统上的编码，unicode 是*有效*UTF-8 的内部表示）。这确实极大地简化了事情。

据我了解，BNF 说：

*   **locale-folder**（可选）是字符串 'locale/' 后跟**lang-tag**
*   **lang-tag**的形式为 'en'、'en-us'、'en-123'、'en-us-1' 等等：
    *   至少一个记号，用'-'字符隔开
    *   每个标记为 1 到 8 个字符
    *   第一个标记可能只有小写字母
    *   以下标记是小写字母和数字的混合
*   在可选语言环境之后，您可以拥有：
    *   单个**文件名**或
    *   路径（一系列以“/”分隔的**文件夹名称）或**
    *   后跟**文件名的路径**
*   **文件夹名**和**文件名**是一种 unicode。每个字符要么
    *   AZ、az、0-9 或
    *   “$%'-_@~()&+,=[]”中的任何一个。
    *   *u007F以上*的任何字符（UTF8 二、三和四字节字符）

也就是说，这是一个简单的实现（为了调试，它捕获解析的输出。我这样做是为了调试，但如果你不需要它，请随意删除它）。路径中的错误会导致 ZipRelPath 构造函数引发 ValueError：

```
import re

class ZipRelPath:
    FILE_NAME_RE = re.compile(u"^[a-zA-Z0-9 \$\%\'\-_@~\(\)&+,=\[\]\.\u0080-\uFFFF]+$")
    LANG_TAG_RE  = re.compile("^[a-z]{1,8}(\-[a-z0-9]{1,8})*$")
    LOCALES      = "locales/"

    def __init__(self, path):
        self.path = path
        self.lang_tag = None
        self.folders = []
        self.file_name = None

        self._parse_locales()
        self._parse_folders()

    def _parse_locales(self):
        """Consumes any leading 'locales' and lang-tag"""
        if self.path.startswith(ZipRelPath.LOCALES):
            self.path = self.path[len(ZipRelPath.LOCALES):]
            self._parse_lang_tag()

    def _parse_lang_tag(self):
        """Parses, consumes and validates the lang-tag"""
        self.lang_tag, _, self.path = self.path.partition("/")
        if not self.path:
            raise ValueError("lang-tag missing closing /")
        if not ZipRelPath.LANG_TAG_RE.match(self.lang_tag):
            raise ValueError(u"'%s' is not a valid language tag" % self.lang_tag)

    def _parse_folders(self):
        """Handles the folders and file-name after the locale"""
        while (self.path):
            self._parse_folder_or_file()

        if not self.folders and not self.file_name:
            raise ValueError("Missing folder or file name")

    def _parse_folder_or_file(self):
        """Each call consumes a single path entry, validating it"""
        folder_or_file, _, self.path = self.path.partition("/")
        if not ZipRelPath.FILE_NAME_RE.match(folder_or_file):
            raise ValueError(u"'%s' is not a valid file or folder name" % folder_or_file)
        if self.path:
            self.folders.append(folder_or_file)
        else:
            self.file_name = folder_or_file

    def __unicode__(self):
        return u"ZipRelPath [lang-tag: %s, folders: %s, file_name: %s" % (self.lang_tag, self.folders, self.file_name) 
```

还有一组简短的测试：

```
GOOD = [
    "$%'-_@~()&+,=[].txt9",
    "my/path/to/file.txt",
    "locales/en/file.txt",
    "locales/en-us/file.txt",
    "locales/en-us-abc123-xyz/file.txt",
    "locales/abcdefgh-12345678/file.txt",
    "locales/en/my/path/to/file.txt",
    u"my\u00A5\u0160\u039E\u04FE\u069E\u0BCC\uFFFD/path/to/file.txt"
]
BAD   = [
    "",
    "/starts/with/slash",
    "bad^file",
    "locales//bad/locale",
    "locales/en123/bad/locale",
    "locales/EN/bad/locale",
    "locales/en-US/bad/locale",
    ]

for path in GOOD:
    print unicode(ZipRelPath(path))

for path in BAD:
    try:
        zip = ZipRelPath(path)
        raise Exception("Illegal path {0} was accepted by {1}".format(path, zip))
    except ValueError as exception:
        print "Incorrect path '{0}' fails with: {1}".format(path, exception) 
```

产生：

```
ZipRelPath [lang-tag: None, folders: [], file_name: $%'-_@~()&+,=[].txt9
ZipRelPath [lang-tag: None, folders: ['my', 'path', 'to'], file_name: file.txt
ZipRelPath [lang-tag: en, folders: [], file_name: file.txt
ZipRelPath [lang-tag: en-us, folders: [], file_name: file.txt
ZipRelPath [lang-tag: en-us-abc123-xyz, folders: [], file_name: file.txt
ZipRelPath [lang-tag: abcdefgh-12345678, folders: [], file_name: file.txt
ZipRelPath [lang-tag: en, folders: ['my', 'path', 'to'], file_name: file.txt
ZipRelPath [lang-tag: None, folders: [u'my\xa5\u0160\u039e\u04fe\u069e\u0bcc\ufffd', u'path', u'to'], file_name: file.txt
Incorrect path '' fails with: Missing folder or file name
Incorrect path '/starts/with/slash' fails with: '' is not a valid file or folder name
Incorrect path 'bad^file' fails with: 'bad^file' is not a valid file or folder name
Incorrect path 'locales//bad/locale' fails with: '' is not a valid language tag
Incorrect path 'locales/en123/bad/locale' fails with: 'en123' is not a valid language tag
Incorrect path 'locales/EN/bad/locale' fails with: 'EN' is not a valid language tag
Incorrect path 'locales/en-US/bad/locale' fails with: 'en-US' is not a valid language tag 
```

如果您的任何测试用例失败，请告诉我，我会看看是否可以修复它。

# javascript - 谷歌地图上的排序/z-indexing覆盖

> ID：12041442
> 
> 赞同：2
> 
> 时间：2012-08-20T16:24:53.567
> 
> 标签：javascript, google-maps, google-maps-api-3

我正在向Google 地图添加 2 个叠加层 - 一个[人口统计图层](https://developers.google.com/maps/documentation/business/demographics)和一个[融合表图层。](https://developers.google.com/maps/documentation/javascript/layers#FusionTables)问题是我需要对这些层进行排序，以便融合表层始终位于人口统计层之上。似乎我最后调用“setMap（map）”的任何一个都在顶部，但我有使用 setMap（null）和 setMap（map）打开或关闭人口统计图层的功能......但每当它被打开时使用 setMap(map)，它显示在 Fusion Tables Layer 的顶部。

```
if (checkbox.checked) {
  demolayer.setMap(map);  //added on top
} else {
  demolayer.setMap(null);
} 
```

除了确保在最后想要的图层上调用 setMap(map) 之外，还有其他方法可以订购叠加层吗？我试过 z-index 属性但没有运气。任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T16:26:43.830

你写了：

> 除了确保在最后想要的图层上调用 setMap(map) 之外，还有其他方法可以订购叠加层吗？

不是我见过的。解决方法是始终删除这两个图层并按照您希望它们显示的顺序添加它们。

您可能想要“加注”这些增强请求或添加一个新请求（我没有看到一般的“允许控制层的相对 z-index”增强请求）：

*   [http://code.google.com/p/gmaps-api-issues/issues/list?can=2&q=layer+z-index](http://code.google.com/p/gmaps-api-issues/issues/list?can=2&q=layer+z-index)
*   [http://code.google.com/p/fusion-tables/issues/list?can=2&q=z-index](http://code.google.com/p/fusion-tables/issues/list?can=2&q=z-index)

# ruby-on-rails - Rails - 正在创建杂散文件

> ID：12041446
> 
> 赞同：0
> 
> 时间：2012-08-20T16:25:09.547
> 
> 标签：ruby-on-rails

我正在开发模式下运行我的（相当复杂的）rails 应用程序。在我的根目录中，我看到正在创建三个文件（零长度）。使用在应用程序上下文中有意义的名称。这些名称几乎看起来像是调试输出的一部分。我正在使用 Rails.logger 进行调试。

那么-如何找到这些文件的创建者并将其删除？

我已经完成了明显的搜索，但是谁在 rails 环境中在根目录中创建文件？

谢谢，奥兹

# mysql - MySQL：缺少结果

> ID：12041448
> 
> 赞同：0
> 
> 时间：2012-08-20T16:25:18.317
> 
> 标签：mysql

一个简单的 MySQL 查询返回一个缺少结果的结果集。

```
SELECT users.uid, users.firstname, users.lastname, jobs_apps.read_app, jobs_apps.datetime
FROM jobs_apps 
JOIN users ON users.uid = jobs_apps.uid 
WHERE jobs_apps.job_id = '90' 
```

这将返回 29 行。如果我运行以下命令：

```
SELECT * FROM jobs_apps WHERE job_id = '90' 
```

我得到 31 行。

2 个缺失的结果在“read_app”中的值为 0 而不是 1。

这可能是什么原因造成的？

PS：我尝试运行原始查询并将 SELECT 子句更改为简单的“SELECT *”，但我仍然只得到 31 行中的 29 行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T16:29:25.270

`OUTER JOIN`在您的查询中尝试

IE;

```
SELECT users.uid, users.firstname, users.lastname, jobs_apps.read_app, jobs_apps.datetime
FROM jobs_apps 
RIGHT OUTER JOIN users ON users.uid = jobs_apps.uid 
WHERE jobs_apps.job_id = '90' 
```

希望这可以帮助 ：-）

# c# - 用于超链接识别的 Outlook 插件

> ID：12041453
> 
> 赞同：1
> 
> 时间：2012-08-20T16:25:54.423
> 
> 标签：c#, outlook-addin

您好，我正在为 Outlook 2010 创建一个附加组件（插件）。我有许多电子邮件中的 ID 号嵌入纯文本中，我想将这些电子邮件转换为网页的超链接。

我的问题是：

- Outlook API 是否支持在已编写的电子邮件中进行此文本替换（本质上是由超链接替换的常规单词）

-这样的东西已经存在了吗？

-这将是我的第一个 Outlook 插件，有什么好的教程，基本的设置资源吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T17:56:22.763

你当然可以做到这一点。我刚刚完成了我的第一个 Outlook 加载项，起初可能有点令人生畏，因为文档不是很好，但对你来说应该不会太难。您要考虑的主要问题是您是否希望此插件只运行一次并用超链接批量替换每个 ID 号，或者您是否希望它在新电子邮件发送后立即运行。 ..或两者。

如果答案是“只有新电子邮件”，请查看[我刚刚提出的问题](https://stackoverflow.com/questions/12040239/save-email-upon-send-in-outlook-add-in)，连同答案，您应该能够执行以下操作：

```
String content = msg.Body;
content = content.Replace("123456", "<a href=\"url\">123456</a>");
msg.Body = content; 
```

（你可能可以在一行中做到这一点）

如果您想浏览用户收件箱中的所有电子邮件，您将需要一个 foreach 循环来浏览该文件夹中的所有内容，并在每封电子邮件上运行上面的代码。

我建议从[这里](http://msdn.microsoft.com/en-us/library/cc668191)开始学习教程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T16:28:25.710

> Outlook API 是否支持在已编写的电子邮件中进行此文本替换（本质上是由超链接替换的常规单词）

是的，它确实。您可以用您喜欢的任何内容替换电子邮件的内容，这是有道理的，因为用户会将您的插件添加到信任中心。

不确定这样的东西是否已经存在，但对于教程，谷歌搜索应该有助于找到一些好的东西；）

# wpf - 如何在 WPF/Silverlight/XAML 中设置标题标签的样式？

> ID：12041454
> 
> 赞同：3
> 
> 时间：2012-08-20T16:25:55.523
> 
> 标签：wpf, silverlight, xaml

这似乎很简单，但我很难找到答案。

我有一个 WPF 窗口，需要为不同的区域使用标题和子标题。当然，我可以为每个元素包含 stlying 内联，但我真的很想保持样式分开。在语义上区分各种标题/子标题/“正常”标签类以便它们可以在单独的 XAML 文档中正确设置样式的正确方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-20T17:31:45.490

您可以为资源字典中所需的每个“标签类”设置样式，如下所示：

```
<Style x:Key="heading" TargetType="Label">
    <Setter Property="FontSize" Value="24" />
</Style>

<Style x:Key="subHeading" TargetType="Label">
    <Setter Property="FontSize" Value="16" />
</Style>

<Style x:Key="normal" TargetType="Label">
    <Setter Property="FontSize" Value="12" />
</Style> 
```

然后在您看来，您只需调用资源并按如下方式使用它：

```
<UserControl.Resources>
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary 
                Source="Resources/MyResources.xaml">
            </ResourceDictionary>
        </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
</UserControl.Resources>

<Grid>
    <Label Style="{StaticResource heading}" Content="This is a heading!" />
</Grid> 
```

# c# - 在自定义控件之外接收触摸事件

> ID：12041455
> 
> 赞同：1
> 
> 时间：2012-08-20T16:25:58.157
> 
> 标签：c#, wpf, events, touch

我正在 WPF 中开发一个自定义用户控件，并尝试接收我的控件之外的所有触摸事件（因此我可以实现“取消触摸”，用户通过点击其他地方来取消操作）。有什么好的方法可以做到这一点吗？显然，如果我使用 TouchDown 或其他事件，我只会在我的控件内收到触摸通知。

我尝试`PreviewTouchDown`从 接收事件`Application.Current.MainWindow`，但除了感觉有点脏之外，它也不能很好地工作 - 一旦我捕获这些事件，`SurfaceListBox`我的自定义控件内部就会停止工作（它不再识别触摸）。

有没有解决这个问题的好方法？简单地接收所有触摸事件就足够了，然后我可以检查它们是否在我的控制范围内。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T16:39:07.320

在 WPF 中，事件遍历元素树。以“预览”开头的事件是从上到下的事件，这意味着从父级到它包含的元素。在您的情况下，TouchDown 事件将从它起源的控件传播，然后它会冒泡向父母。PreviewTouchDown 将朝相反的方向行进：从父控件到控件。您在 Application.Current.MainWindow 中处理 PreviewTouchDown 事件的想法很好，如果这是您想要的，应该处理所有 PreviewTouchDown 事件。但是在您的情况下，如果您想检查事件是否源自您的自定义控件，您应该在 MainWindow 中捕获所有 TouchDown 事件并检查它们的 Source 属性，如下所示：

```
private void CommonClickHandler(object sender, RoutedEventArgs e)
{
  FrameworkElement feSource = e.Source as FrameworkElement;
  if(feSource.Name == "MyCustomControlName")
  {
      //cancel whatever you want to cancel
      e.Handled=true;
  }
} 
```

不要捕捉 PreviewTouchDown 事件，因为该事件将首先在 MainWindow 中弹出，稍后将一直到达您的控件。 [此](http://msdn.microsoft.com/en-us/library/ms742806.aspx)msdn 链接应该为您提供更多信息：http: [//msdn.microsoft.com/en-us/library/ms742806.aspx](http://msdn.microsoft.com/en-us/library/ms742806.aspx)

# active-directory - Active Directory memberof 属性不包含嵌套的安全组

> ID：12041459
> 
> 赞同：4
> 
> 时间：2012-08-20T16:26:15.320
> 
> 标签：active-directory

我正在使用的 AD 设置具有存储为（多个）安全组成员的用户。

我正在使用读取用户的 memberof 属性来计算访问权限的软件。

在 AD Explorer 中，我可以看到用户的 memberof 属性显示了他们所属的直接安全组，例如“课程 - 英语”。它不显示父母组，嵌套显示“所有学生”。

是否有这样做的原因或确保所有嵌套组都显示在 memberof 属性中的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T17:05:28.057

如果您使用的是 .NET 3.5 及更高版本，则应查看`System.DirectoryServices.AccountManagement`(S.DS.AM) 命名空间。在这里阅读所有相关信息：

*   [在 .NET Framework 3.5 中管理目录安全主体](http://msdn.microsoft.com/en-us/magazine/cc135979.aspx)
*   [System.DirectoryServices.AccountManagement 上的 MSDN 文档](http://msdn.microsoft.com/en-us/library/system.directoryservices.accountmanagement.aspx)

基本上，您可以定义域上下文并在 AD 中轻松找到用户和/或组：

```
// set up domain context
PrincipalContext ctx = new PrincipalContext(ContextType.Domain);

// find a user
UserPrincipal user = UserPrincipal.FindByIdentity(ctx, "SomeUserName");

if(user != null)
{
   var groups = user.GetAuthorizationGroups();

   // enumerate over groups
   foreach(GroupPrincipal gp in groups)
   {
      // do something here....
   }
} 
```

新的 S.DS.AM 使得在 AD 中与用户和组一起玩变得非常容易！

该`.GetAuthorizationGroups()`方法是我所知道的唯一一种会进行递归搜索的方法，例如，通过另一个组查找用户所属的组。.NET 3.5 之前的`DirectoryServices`东西不这样做——如果你需要的话，你必须完全*自己动手。*

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-20T17:05:57.993

`memberOf`属性不包含所有嵌套组信息的可能原因是该值是在加载属性时计算的[，如此链接中](http://msdn.microsoft.com/en-us/library/ms677943.aspx)所述：

> 请注意，此属性列出了在其成员属性中包含用户的组 - 它不包含嵌套前辈的递归列表。例如，如果用户 O 是组 C 的成员，并且组 B 和组 B 嵌套在组 A 中，则用户 O 的 memberOf 属性将列出组 C 和组 B，而不是组 A。
> 
> 这个属性没有被存储——它是一个计算的反向链接属性。

因此，为了支持这一点，每次 LDAP 查询返回`memberOf`属性时，您的 DC 将被迫加载所有嵌套组，这可能是很多多余的工作。

根据您使用的技术，几乎可以肯定有比加载所有组并列出所有组更好的方法来检查组成员身份。例如，[ADSI 有一个预先构建的函数](http://msdn.microsoft.com/en-us/library/aa706023%28v=vs.85%29)来检查用户是否是组的成员。

但是，对于纯 LDAP 解决方案，您可以使用[此答案](https://stackoverflow.com/a/6202683/274466)`LDAP_MATCHING_RULE_IN_CHAIN`中所示的（假设您有用户的 DN），例如，

```
(member:1.2.840.113556.1.4.1941:=CN=Administrator,OU=Users,DC=fabrikam,DC=com) 
```

这将获得管理员所属的所有组。但是请注意，此查询可能非常慢。为了提高性能，请考虑对结果进行分页或将搜索库限制为仅您有兴趣检查的组。

# ios - 应用程序在 uitableview 加载时崩溃

> ID：12041464
> 
> 赞同：0
> 
> 时间：2012-08-20T16:26:20.297
> 
> 标签：ios, uitableview

我的应用程序在应用程序加载时不断崩溃，罪魁祸首是这条线：

```
cell.textLabel.text = [[self.searchResults objectAtIndex:[indexPath row]] valueForKey:@"payment_frequency"]; 
```

我得到的错误是：

```
*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[__NSCFDictionary objectAtIndex:]: unrecognized selector sent to instance 0x8a538e0' 
```

self.searchResults 确实有 4 个对象，因为它是一个数组。每个对象如下：

```
 {
    50316462547c6dbdf2000005 =     {
    "created_at" = "2012-08-19T17:10:42-0500";
            id = 50316462547c6dbdf2000005;
            "payment_frequency" = "One Time";
            "user_id" = 1;
    };

    50316462547c6dbdf2000005 =     {
    "created_at" = "2012-08-19T17:10:42-0500";
            id = 50316462547c6dbdf2000005;
            "payment_frequency" = "One Time";
            "user_id" = 1;
    };

    50316462547c6dbdf2000005 =     {
    "created_at" = "2012-08-19T17:10:42-0500";
            id = 50316462547c6dbdf2000005;
            "payment_frequency" = "One Time";
            "user_id" = 1;
    };

    50316462547c6dbdf2000005 =     {
    "created_at" = "2012-08-19T17:10:42-0500";
            id = 50316462547c6dbdf2000005;
            "payment_frequency" = "One Time";
            "user_id" = 1;
    };

} 
```

这是完整的代码：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"SearchResultsViewCell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    cell.textLabel.text = [[self.searchResults objectAtIndex:[indexPath row]] valueForKey:@"payment_frequency"];

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T16:34:38.583

错误消息告诉您，您正在将 objectAtIndex: 发送到字典对象，而不是数组。

你有 ：

*   错误的声明或
*   内存问题（重用空闲内存）

# perl - 在 Perl 中取消引用字符串

> ID：12041465
> 
> 赞同：2
> 
> 时间：2012-08-20T16:26:27.547
> 
> 标签：perl

我在 Perl sub findfiles 中有一个子例程，我必须传递一个带引号的值**“*/*”**作为输入参数，因为它在没有引用的情况下抱怨，另一方面在我的子例程中我需要它不被引用（可能是！）问题是当我打印要检查的值时，我没有看到任何引用或任何东西，但可能有一些特殊的隐藏字符或我不知道的东西？当我直接使用 */* 时，我的代码可以正常工作，但当我将它作为输入参数传递时，我的代码不能正常工作你知道吗？

```
sub findfiles {

    $dirname=$_[0];
    my @temp = grep {-f} <$dirname>;
    print @temp;       

}
&findfiles("*/*"); doesnot work

but 
   sub findfiles {

    $dirname=$_[0];
    my @temp = grep {-f} <*/*>;
    print @temp;       

} 
```

做它的工作

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-20T16:46:59.800

使用您更新的代码，我可以看到您的错误所在。尽管

```
my @temp = grep {-f} <*/*>; 
```

作为一个`glob`

```
my @temp = grep {-f} <$dirname>; 
```

被解释为文件句柄上的[readline()](http://perldoc.perl.org/functions/readline.html)`$dirname`。

如果您想避免歧义，可以使用以下功能[`glob`](http://perldoc.perl.org/functions/glob.html)：

```
my @temp = grep -f, glob $dirname; 
```

您可能还对使用[File::Find](http://search.cpan.org/perldoc?File::Find)感兴趣，它以递归方式查找文件。

**注意：**如果您打开了警告，则可以避免此问题。根据经验，在 perl 中编码而不使用

```
use strict;
use warnings; 
```

...是一个非常糟糕的主意。这两个 pragma 将帮助您识别代码中的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T16:30:24.710

> 问题是当我打印要检查的值时，我没有看到任何报价

```
$test="*/*"
          ^string delimiter
       ^^^string
      ^string delimiter 
```

当您打印一个字符串（无论是来自字符串文字、标量或其他任何内容）时，您都会打印*字符串*。

分隔符不会被打印。他们只是告诉 perl 数据的边缘在哪里。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-20T17:06:09.117

你知道[`File::Find`](http://search.cpan.org/perldoc?File%3a%3aFind)吗？

```
use File::Find ();

File::Find::find( sub { say $File::Find::name if -f; } => $my_root ); 
```

或者[`File::Find::Rule`](http://search.cpan.org/perldoc?File%3a%3aFind%3a%3aRule)（见[`file`](http://search.cpan.org/perldoc?File%3a%3aFind%3a%3aRule#-X_tests)）呢？

```
say foreach File::Find::Rule->file->in( $my_root ); 
```

# android - Android ListView 背景颜色

> ID：12041470
> 
> 赞同：2
> 
> 时间：2012-08-20T16:26:44.223
> 
> 标签：android, listview, background

我希望中的每个偶数项目都`ListView`具有不同的颜色。为此，我使用了以下代码：

```
public void bindView(View row, Context ctxt, Cursor c) {
            ViewHolder holder = (ViewHolder) row.getTag();
            if (c.getPosition() % 2 == 0) {
                row.setBackgroundDrawable(getResources().getDrawable(
                        R.drawable.dark_item_background));
            }

            holder.populateFrom(c, mDbHelper);
        } 
```

但是在触摸事件之后该项目没有突出显示。请建议如何克服这个问题。

**更新**

作为 Gophermofur 的建议，我创建了一个选择器：

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">

    <item android:drawable="@drawable/list_activated_holo" android:state_activated="true"/>
    <item android:drawable="@color/item_back_color"/>

</selector> 
```

现在它适用于 Jelly Bean 而不适用于 Gingerbread。有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-05T01:49:30.767

> 现在它适用于 Jelly Bean 而不适用于 Gingerbread。有什么想法吗？

我不确定你的 drawable/list_activated_holo 是什么，但从它的名字来看，它听起来像是在使用 android Holo 主题——它只在 API 级别 14 中添加。http: [//developer.android.com/design/style /themes.html](http://developer.android.com/design/style/themes.html)

如果您想在运行低于 API 级别 14 的设备上使用颜色，您需要在自己的 values/colors.xml 中定义颜色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T16:45:38.040

列表视图中的项目实际上并未定义为纯色（黑色或白色），它们是使用选择器定义的，其中不同状态有多种颜色（正常 = 黑色，按下 = 橙色，聚焦 = 蓝色等）。

当您开始用纯色替换列表视图中项目的背景颜色时，它会覆盖该选择器，因此不同状态不再有不同的颜色。

通常列表视图选择器应用于整个列表，但是，您可以将其直接应用于项目的背景或选择器（我不确定，目前无法测试）。

查看这些链接以了解如何创建选择器 XML 文件：

[教程](http://geekjamboree.wordpress.com/2011/11/14/listview-selector-and-custom-background)

[所以问题](https://stackoverflow.com/questions/2038040/android-listview-selector-color)

# jquery - FlexSlider 不加载查询？

> ID：12041471
> 
> 赞同：0
> 
> 时间：2012-08-20T16:26:53.540
> 
> 标签：jquery, html, flexslider

我做对了，导入了滑块的所有图片\js\css，发布了 HTML，链接了图片，这就是它向我展示的内容：

[http://gyazo.com/d893652fb91023d1ebd5278383ae72e6.png](http://gyazo.com/d893652fb91023d1ebd5278383ae72e6.png)

我不知道怎么了？

www.justxp.plutohost.net/survive/index.html

我的 HTML：

[http://pastebin.com/FEK7AHBr](http://pastebin.com/FEK7AHBr)

弹性 CSS：

http://pastebin.com/ YSNQXQ53

谢谢

# c# - 构建复杂的 If 语句

> ID：12041473
> 
> 赞同：-1
> 
> 时间：2012-08-20T16:27:19.107
> 
> 标签：c#, winforms

我有三个`if`声明，它们显然正在处理不同的功能。我想将它们组合成一个函数，因此我必须组合`if`语句。但我被困在如何使用`||` `&&`and `()`。

我的功能是过滤器，用户可以填写任何文本框。在按钮单击事件上，代码将找到符合条件的那些。其中三个独立工作良好，但将它们组合起来非常困难。请多多包涵并帮助我，我只是一个非常新的程序员，完全没有背景。我被困了好几天。;(

我的过滤器快照：

![过滤器](../Images/432ff975be6d93be6ec57ecf199fd717.png)

第一的：

```
if (itemAuthor.ToLower() == txtComAuthor.Text.ToString().ToLower()) 
```

第二：

```
if ((!DateTime.TryParseExact(txtComStartDate.Text, "dd/MM/yy", provider, DateTimeStyles.AssumeLocal, out startDate)
      || DateTime.Parse(itemDate, provider, DateTimeStyles.AssumeLocal) >= startDate) &&
      (!DateTime.TryParseExact(txtComEndDate.Text, "dd/MM/yy", provider, DateTimeStyles.AssumeLocal, out endDate)
      || DateTime.Parse(itemDate, provider, DateTimeStyles.AssumeLocal) <= endDate)) 
```

第三：

```
if (txtComKeyword1.Text != (String.Empty) && itemDescription.ToLower().Contains(txtComKeyword1.Text.ToLower()) ||
    txtComKeyword2.Text != (String.Empty) && itemDescription.ToLower().Contains(txtComKeyword2.Text.ToLower()) ||
    txtComKeyword3.Text != (String.Empty) && itemDescription.ToLower().Contains(txtComKeyword3.Text.ToLower()) ||
    txtComKeyword4.Text != (String.Empty) && itemDescription.ToLower().Contains(txtComKeyword4.Text.ToLower())) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T16:36:18.913

是否使用|| 或 && 取决于您是否想要*至少一个条件为真*（使用 ||）或*所有条件都必须为真*（使用 &&）的含义。

如果您需要混合两种含义，请使用 () 使条件相互评估，例如

```
if ( (a && b) || (c && d)) 
```

表示如果*a 和 b 都为真* **，或者** *c 和 d 都为真*。

如果您为复合逻辑的每个部分定义单独的布尔值，它会使代码更易于阅读和维护。没有性能差异。

```
bool condition1 = !DateTime.TryParseExact(txtComStartDate.Text, "dd/MM/yy", provider, DateTimeStyles.AssumeLocal, out startDate);
bool condition2 = DateTime.Parse(itemDate, provider, DateTimeStyles.AssumeLocal) >= startDate);
bool condition3 = !DateTime.TryParseExact(txtComEndDate.Text, "dd/MM/yy", provider, DateTimeStyles.AssumeLocal, out endDate);
bool condition4 = DateTime.Parse(itemDate, provider, DateTimeStyles.AssumeLocal) <= endDate);

if ((condition1
      || condition2 &&
      (condition3
      || condition4) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T16:48:56.807

如果将这些子句中的每一个分解为函数并相应地划分复杂性，它将帮助您理解。从长远来看，较小的部分更易于使用，并且更易于维护。当您发展为程序员时，您最终将根本不会为此使用 if 语句，而是利用多态性的力量。

现在，先把事情分开。

```
public void btnAnalyze_onClick(){
    List<Item> results = new ArrayList<Item>();
    if(txtComAuthor.Text != String.Empty)
    { 
       List<Item> matched = filterByAuthor(txtComAuthor.Text);
       results.addRange(matched);
    }
    if(txtComStartDate.Text != String.Empty)
    {
       List<Item> matched = filterByStartDate(txtComStartDate.Text);
       results.addRange(matched);
    }
    // do the same for the others
    return results;
}

public List<Item> filterByAuthor(String desiredAuthorName){
      List<Item> matches = new ArrayList<Item>();
      //have your data access piece here, from DB/Excel/whatever.
      List<Item> candidates = ...
      foreach(Item candidate in candidates){
         if(candidate.ToLower() == desiredAuthorName){ 
            matches.add(candidate)
         }
       }
       return matches;
} 
```

有经验的程序员会意识到这里有很多重复，并且会适应违反 DRY 和性能的问题。没关系。它可以重构。对于新手来说，这将是最容易理解的风格。

如果您遵循这种风格，那么您需要在哪里进行过滤应该很明显。基本上，您需要将 foreach 循环中的 if 语句替换为您正在考虑的文本字段的条件。

但是你不应该需要将一堆子句添加在一起这样做，因为你已经更好地分解了一些东西。如果您仍然发现需要一些嵌套的 if，请将其进一步分解为更小的函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-20T16:37:39.937

如果对逻辑分组有疑问，请在每对操作周围加上括号。这样你就知道如何组合这些对了。

`if ((A && B) || (C && D))`将评估`(A && B)`和`(C && D)`段，然后将这些中间结果“或”在一起以产生最终值。

如需进一步阅读，请搜索布尔逻辑的交换、关联和分配属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T16:36:26.573

据我所知，您想同时评估所有 3 个，但简单地将它们添加到一个大行中将难以阅读或维护。我建议为您之前的每个 if 设置单独的 bool 值：

```
bool firstIf = (itemAuthor.ToLower() == txtComAuthor.Text.ToString().ToLower()); 
```

然后在一个语句中比较所有 3 个：

```
if (firstIf && secondIf && thirdif)
{
    Console.WriteLine("It works!");
} 
```

这样，如果需要，以后更容易进行更改，并且您仍然可以阅读代码。

# java - Toolkit.getDefaultToolkit().createImage() 与 ImageIO.read()

> ID：12041474
> 
> 赞同：8
> 
> 时间：2012-08-20T16:27:45.470
> 
> 标签：java, image, swing, jpeg, javax.imageio

我正在使用 Swing 创建一个 UI，我想在`JLabel`. 我使用的代码如下：

```
 JLabel label = new JLabel(new ImageIcon(ImageIO.read(new File("img.jpg")))); 
```

如果我使用`png`图像，这可以正常工作，但是当涉及到`jpg`（仅其中一些）时，我会得到一个偏红的图像（与我在 Paint.NET 中看到的不同）。我使用的图像是这个：[img.jpg](http://www.google.co.kr/logos/2012/field_hockey-2012-hp.jpg)

所以我尝试了（作为替代方案）：

```
Toolkit.getDefaultToolkit().createImage(new File("img.jpg").getAbsolutePath()); 
```

1.  有谁知道为什么会这样？它是不支持的特殊`JPEG`格式吗？
2.  我在这个论坛上读到大多数人推荐使用 ImageIO（例如[这里）。](https://stackoverflow.com/questions/8184040/how-can-i-get-height-and-width-of-an-image)为什么？

非常感谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-20T18:32:11.837

[正如这里](https://stackoverflow.com/a/3432532/230513)所讨论的，您的 JPEG 图像可能包含虚假的透明度信息。一个简单的权宜之计是在具有兼容颜色模型的缓冲区中渲染图像，如此[处所示](https://stackoverflow.com/a/2658663/230513)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-20T17:25:55.290

看起来您在 ImageIO.read 中发现了一个错误...（我可以重现红色，这绝对不是它应该的样子）。

你可以尝试

*   使用其他设置保存 JPEG 文件
*   使用其他程序打开/重新保存文件（希望获得更常见的 JPEG 编码）
*   或使用 Toolkit 方法（如果您不控制图像）。

Toolkit 方法的唯一问题是 getImage() 方法在调用后立即返回，并且加载发生在后台线程上，因此您无法立即开始使用 Image 对象。

# oracle - 在联合中使用时，Oracle 管道函数无法访问远程表 (ORA-12840)

> ID：12041476
> 
> 赞同：3
> 
> 时间：2012-08-20T16:28:01.150
> 
> 标签：oracle, plsql

我创建了一个返回表的流水线函数。我使用这个函数就像在另一个函数中的动态视图一样，在一个`with`子句中，来标记某些记录。然后，我根据各种条件在聚合查询中使用此查询的结果。我想要做的是`union all`这些聚合在一起（因为它们都使用相同的源数据，但在不同的层次结构级别显示聚合）。

当我为各个级别生成数据时，它工作正常。但是，当我尝试组合它们时，我收到 ORA-12840 错误：`cannot access a remote table after parallel/insert direct load txn`.

（我应该注意，我的函数和查询是通过数据库链接查看远程服务器上的表）。

有什么想法吗？

* * *

这是代码的一个想法：

```
function getMatches(criteria in varchar2) return myTableType pipelined; 
```

...这个函数基本上执行一些动态 SQL，它引用远程表作为引用游标并吐出结果。

然后分解查询类似于：

```
with marked as (
  select id from table(getMatches('OK'))
),
fullStats as (
  select    mainTable.id,
            avg(nvl2(marked.id, 1, 0)) isMarked,
            sum(mainTable.val) total
  from      mainTable
  left join marked
  on        marked.id = mainTable.id
  group by  mainTable.id
) 
```

第一个因素的原因是速度——如果我在连接中内联它，查询会非常缓慢——但无论哪种方式，它都不会改变任何导致异常的状态。

然后，说一个完整的概述，我会这样做：

```
select sum(total) grandTotal
from   fullStats 
```

...或通过以下方式进行概述`isMarked`：

```
select sum(total) grandTotal
from   fullStats
where  isMarked = 1 
```

这些单独工作正常（我的伪代码可能错误或过于简单，但你明白了），但只要我`union all`把它们放在一起，我就会得到 ORA-12840 错误:(

* * *

**编辑**根据要求，这是我的函数的混淆版本：

```
function getMatches(
    search in varchar2)
  return idTable pipelined
  as
    idRegex     varchar2(20) := '(05|10|20|32)\d{3}';
    searchSQL   varchar2(32767);

    type rc is ref cursor;
    cCluster rc;
    rCluster idTrinity;

    BAD_CLUSTER exception;
  begin
    if regexp_like(search, '^L\d{3}$') then
      searchSQL := 'select distinct null id1, id2_link id2, id3_link id3 from anotherSchema.linkTable@my.remote.link where id2 = ''' || search || '''';    
    elsif regexp_like(search, '^' || idRegex || '(,' || idRegex || || ')*$') then
      searchSQL := 'select distinct null id1, id2, id3 from anotherSchema.idTable@my.remote.link where id2 in (' || regexp_replace(search, '(\d{5})', '''\1''') || ')';
    else
      raise BAD_CLUSTER;
    end if;

    open cCluster for searchSQL;
    loop
      fetch cCluster into rCluster;
      exit when cCluster%NOTFOUND;

      pipe row(rCluster);
    end loop;

    close cCluster;
    return;

  exception
    when BAD_CLUSTER then
      raise_application_error(-20000, 'Invalid Cluster Search');
      return;
    when others then
      raise_application_error(-20999, 'API' || sqlcode || chr(10) || sqlerrm);
      return;
  end getMatches; 
```

它非常简单，专为对数据库访问受限的 API 设计，就复杂性而言（因此传递一个逗号分隔的字符串作为可能的有效参数）：如果您提供分组代码，它会返回链接的 ID（它是复合的，3 -字段键）；但是，如果您提供自定义代码列表，它只会返回这些代码。

我在 Oracle 10gR2 上；不确定具体是哪个版本，但我可以在我回到办公室时查看它：P

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T16:52:14.937

老实说，不知道问题出在哪里，但最简单的解决方法是 - 创建一个临时表并使用流水线函数中的值填充它，然后在 WITH 子句中使用该表。当然应该创建临时表，但我很确定你会得到严重的性能转变，因为动态采样不会在没有技巧的情况下应用于流水线函数。

ps 这个问题可以通过标记为 ( select /*+ INLINE */ id from table(getMatches('OK'))) 来解决，但肯定不是你要找的东西，所以我的建议得到了证实就像'插入/* + APPEND * /'里面'。

# android - 从 ActionbarSherlock 菜单打开上下文菜单

> ID：12041479
> 
> 赞同：2
> 
> 时间：2012-08-20T16:28:18.707
> 
> 标签：android, menu, actionbarsherlock

我修改了 ABS Fragment - Menu 示例，以便当按下操作栏上的菜单项（Home 或 Filter）之一时，它会打开一个带有上下文菜单的片段（menu1）。

但是，按下菜单项时不会出现 menu1。也不会发生错误。

你能帮我找到我缺少的东西吗？

```
public static class MenuFragment extends SherlockFragment {

     @Override
     public void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
         setHasOptionsMenu(true);
     }

     @Override
     public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {
         menu.add("Home").setShowAsAction(MenuItem.SHOW_AS_ACTION_IF_ROOM);

     }
} 
```

第二个片段：

```
 /**
      * Second fragment with a menu.
      */
public static class Menu2Fragment extends SherlockFragment {

     @Override
     public void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
         setHasOptionsMenu(true);
     }

     @Override
     public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {
         menu.add("Filter").setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS);

     }

     @Override
     public boolean onOptionsItemSelected(MenuItem item) 
     {
         int id = item.getItemId();
         Toast.makeText(getActivity(), "Option " + id+ " selected", Toast.LENGTH_SHORT).show();
         if (id == android.R.id.home) {
            // rbmView.toggleMenu();

         return true;
         } else {

             FragmentManager fm = getActivity().getSupportFragmentManager();
             FragmentTransaction ft = fm.beginTransaction();
             Fragment mFrag1 = fm.findFragmentByTag("menu1");
             if (mFrag1 == null) {
                 mFrag1 = new ContxtMenuFragment();
                 ft.add(mFrag1, "menu1");
                 ft.show(mFrag1);
             }
             ft.commit();  
             return super.onOptionsItemSelected(item);
         }
     }
} 
```

上下文菜单片段

```
public static class ContxtMenuFragment extends android.support.v4.app.Fragment {
         @Override
         public void onCreate(Bundle savedInstanceState) {
             super.onCreate(savedInstanceState);

         }
         @Override
            public void onCreateContextMenu(ContextMenu menu, View v,
                    ContextMenuInfo menuInfo) {
                // TODO Auto-generated method stub
                super.onCreateContextMenu(menu, v, menuInfo);
                CreateMenu(menu);  // http://mobiforge.com/designing/story/understanding-user-interface-android-part-4-even-more-views
            }

         @Override
            public boolean onContextItemSelected(android.view.MenuItem item) {
                // TODO Auto-generated method stub
                return super.onContextItemSelected(item);
    //              return MenuChoice(item);
            }

     public static boolean MenuChoice(android.view.MenuItem item) {
    //       switch (item.getItemId()) {
    //       case 0:
    //           Toast.makeText(ViewPagerActivity.this, "You clicked on Item 1", 
    //               Toast.LENGTH_LONG).show();
    //           return true;
    //       case 1:
    //           Toast.makeText(getActivity(), "You clicked on Item 2", 
    //               Toast.LENGTH_LONG).show();
    //           return true;
    //       case 2:
    //           Toast.makeText(getActivity(), "You clicked on Item 3", 
    //               Toast.LENGTH_LONG).show();
    //           return true;
    //       case 3:
    //           Toast.makeText(getActivity(), "You clicked on Item 4", 
    //               Toast.LENGTH_LONG).show();
    //           return true;
    //       case 4:
    //           Toast.makeText(getActivity(), "You clicked on Item 5", 
    //               Toast.LENGTH_LONG).show();
    //           return true;
    //       case 5:
    //           Toast.makeText(getActivity(), "You clicked on Item 6", 
    //               Toast.LENGTH_LONG).show();
    //           return true;
    //       case 6:
    //           Toast.makeText(getActivity(), "You clicked on Item 7", 
    //               Toast.LENGTH_LONG).show();
    //           return true;            
    //       }
       return false;
      }    

    public static void CreateMenu(ContextMenu menu) {
        // TODO Auto-generated method stub
         menu.setQwertyMode(true);
         android.view.MenuItem mnu1 = menu.add(0, 0, 0, "Item 1");
         {
             mnu1.setAlphabeticShortcut('a');
        //     mnu1.setIcon(R.drawable.alert_dialog_icon);            
         }
         android.view.MenuItem mnu2 = menu.add(0, 1, 1, "Item 2");
         {
             mnu2.setAlphabeticShortcut('b');
         //    mnu2.setIcon(R.drawable.ic_popup_reminder);            
         }
         android.view.MenuItem mnu3 = menu.add(0, 2, 2, "Item 3");
         {
             mnu3.setAlphabeticShortcut('c');
             mnu3.setIcon(R.drawable.icon);
         }
         android.view.MenuItem mnu4 = menu.add(0, 3, 3, "Item 4");
         {
             mnu4.setAlphabeticShortcut('d');                    
         }

} 
```

# objective-c - Objective C 将所有权设置为文件

> ID：12041482
> 
> 赞同：1
> 
> 时间：2012-08-20T16:28:28.963
> 
> 标签：objective-c, cocoa

我想更改文件权限和文件所有权（root o mobile） 我已经找到了如何成功设置权限（777）。但现在我正试图获得文件所有权。

这是我已经得到的，但它似乎不起作用：

```
NSMutableDictionary *dict2 = [[NSMutableDictionary alloc] init]; 
    [dict2 setObject:[NSString stringWithFormat:@"mobile"] forKey:NSFileOwnerAccountName]; 
    [dict2 setObject:[NSString stringWithFormat:@"mobile"] forKey:NSFileGroupOwnerAccountName];
    NSFileManager *fm2 = [NSFileManager defaultManager]; 
    NSError *error2; 
    [fm2 setAttributes:dict2 ofItemAtPath:omgPath error:&error2]; 
```

有人可以帮我弄这个吗？:)

这是权限的工作代码：

```
NSMutableDictionary *dict = [[NSMutableDictionary alloc] init]; 
    [dict setObject:[NSNumber numberWithInt:511] forKey:NSFilePosixPermissions]; 
    NSFileManager *fm = [NSFileManager defaultManager]; 
    NSError *error1; 
    [fm setAttributes:dict ofItemAtPath:omgPath error:&error1]; 
```

这是另一个大问题：

没有文件权限（如果文件没有权限）我不能使用 chown 命令，否则我会使用它。如果“所有者”的所有权是 root，我无法运行权限脚本。所以我必须让一个工作而不需要另一个。

所以设置所有权在没有权限的情况下不起作用设置权限仅在所有权是移动的而不是root时才起作用

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-27T22:52:27.293

由于某种原因，您的代码分段错误，我不确定确切的错误，但您的风格有点奇怪，例如，为什么您创建了一个可变字典而不是普通字典？当你只需要一个普通的字符串时，为什么要使用 NSStringWithFormat 呢？无论如何，我不确定哪个确切的问题导致了 seg 错误，但在这里它已修复：

```
NSDictionary *dict = [NSDictionary dictionaryWithObjectsAndKeys:
                          @"mobile",NSFileOwnerAccountName,
                          @"mobile",NSFileGroupOwnerAccountName,
                          nil];

NSError *error = nil;
[[NSFileManager defaultManager] setAttributes:dict ofItemAtPath:omgPath error:&error];
if(error){
    NSLog(@"Error settings permission %@",[error description]);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-28T00:20:30.503

只有超级用户可以设置文件的所有权。而且，一般来说，如果任务可以使用较低级别的 API 完成，则不应使用特权辅助工具中的 Cocoa，因为这样可以减少攻击风险。

如果方法失败，您应该检查通过引用返回的错误对象（这与 indiekiduk 的答案不同，您应该通过查看方法的布尔返回值来确定，而不是错误变量是否为`nil`）。它将解释失败的原因。

# ruby - 如何在不回溯的情况下避免树顶的左递归？

> ID：12041485
> 
> 赞同：3
> 
> 时间：2012-08-20T16:28:51.713
> 
> 标签：ruby, parsing, treetop, peg, left-recursion

在我正在研究的这个简单的表达式解析器中，我无法避免左递归。本质上，我想将方程“fx y”解析为两个表达式“fx”和“(fx)y”（带有隐式括号）。如何在避免左递归和回溯的同时做到这一点？是否必须有一个中间步骤？

```
#!/usr/bin/env ruby
require 'rubygems'
require 'treetop'
Treetop.load_from_string DATA.read

parser = ExpressionParser.new

p parser.parse('f x y').value

__END__
grammar Expression
   rule equation
      expression (w+ expression)*
   end
   rule expression
      expression w+ atom
   end
   rule atom
      var / '(' w* expression w* ')'
   end
   rule var
      [a-z]
   end
   rule w
      [\s\n\t\r]
   end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T00:07:41.357

您没有提供有关所需结果的足够信息。特别是，您是否希望“f(ab) y”解析为“(f(a(b))) y”？我假设您这样做...这意味着没有后跟左括号的函数具有元数。

所以你想说：

```
rule equation
  expression w* var / expression w* parenthesised_list
end
rule parenthesised_list
  '(' w* ( expression w* )+ ')'
end 
```

另一方面，如果您对 f 的元数有外部（语法）知识，并且您想精确地迭代“表达式”多次 - 例如在解析 TeX 时发生 - 那么您将需要使用语义谓词&{|s| ...} 在迭代表达式列表中）。请注意，传递给 sempred 块的参数不是 SyntaxNode（由于此序列子规则尚未成功，因此尚无法构造），而是序列中迄今为止累积的节点数组。块返回值的真实性决定了解析结果并可以停止迭代。

您可能会考虑使用的另一个工具是前瞻（！stuff_I_dont_expect_to_follow 或 &stuff_that_must_follow）。

您也可以在[http://groups.google.com/group/treetop-dev中提出此类问题](http://groups.google.com/group/treetop-dev)

# php - 带有 2 个 OR 语句和 1 个 AND 语句的 SQL 查询

> ID：12041488
> 
> 赞同：2
> 
> 时间：2012-08-20T16:29:17.803
> 
> 标签：php, mysql, database

我正在尝试运行这样的 SQL 查询：

```
$sql = mysql_query("select * from users where new_mail = 0 OR new_events = 0 and emailed = 1") or die(mysql_error());
while($r=mysql_fetch_array($sql))
{
    mysql_query("update users set emailed = 0 where username='{$r['username']}'") or die(mysql_error());
} 
```

然而，它似乎忽略了 OR 语句，只遵循 and 语句。所以它会继续并将 emailed 设置为 0，即使他们仍然有 new_mail 或 new_event。任何线索为什么？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-20T16:33:10.237

在 MySQL 中，`AND`运算符的[优先级](http://dev.mysql.com/doc/refman/5.1/en/operator-precedence.html)高于`OR`运算符。

要获得您想要的逻辑，请尝试以您希望评估它们的方式对参数进行分组：

```
$sql = mysql_query("select * from users where (new_mail = 0 OR new_events = 0) and emailed = 1") or die(mysql_error()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T16:34:16.267

```
$sql = mysql_query("select * from users where (new_mail = 0 OR new_events = 0) and emailed = 1") or die(mysql_error());
while($r=mysql_fetch_array($sql))
{
    mysql_query("update users set emailed = 0 where username='{$r['username']}'") or die(mysql_error());
} 
```

您可能需要在 where 子句中添加括号

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-20T16:35:40.817

在 OR 子句周围加上括号，将其从 AND 子句中分割出来。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-20T16:39:32.153

根据 MYSQL 的操作顺序，子句中`AND`的语句在语句之前评估，除非分组。我假设如果 new_mail 或 new_events 为 0 并且 emailed 设置为 0，您想要做的是让查询返回 true。`WHERE``OR`

如果是这样，您需要像这样对 OR 语句进行分组：

```
"SELECT * FROM users WHERE (new_mail = 0 OR new_events = 0) AND emailed = 1" 
```

如果您没有在该循环中执行任何其他操作，您还可以通过将`WHERE`子句直接应用于查询，将其简化为一个查询`UPDATE`。

```
$sql = "UPDATE users SET emailed = 0 WHERE (new_mail = 0 OR new_events = 0) AND emailed = 1"
mysql_query($sql) or die(mysql_error()) 
```

# c# - 为什么这个 DynamicMethod (ldarg.1, newobj, ret) 会触发 VerificationException？

> ID：12041490
> 
> 赞同：3
> 
> 时间：2012-08-20T16:29:22.940
> 
> 标签：c#, reflection, reflection.emit, dynamicmethod, verificationexception

我有一个将构造函数包装在动态工厂方法中的方法：

```
static Func<TArg1, TResult> ToFactoryMethod<TArg1, TResult>(this ConstructorInfo ctor)
    where TResult : class
{
    var factoryMethod = new DynamicMethod(
         name:           string.Format("_{0:N}", Guid.NewGuid()),
         returnType:     typeof(TResult), 
         parameterTypes: new Type[] { typeof(TArg1) });

    ILGenerator il = factoryMethod.GetILGenerator();
    il.Emit(OpCodes.Ldarg_1);
    il.Emit(OpCodes.Newobj, ctor);
    il.Emit(OpCodes.Ret);

    return (Func<TArg1, TResult>)
         factoryMethod.CreateDelegate(typeof(Func<TArg1, TResult>));
} 
```

但是，以下代码会`VerificationException`在`.Invoke(…)`:

```
ConstructorInfo ctor = typeof(Uri).GetConstructor(new Type[] { typeof(string) });
Func<string, Uri> uriFactory = ctor.ToFactoryMethod<string, Uri>();
Uri uri = uriFactory.Invoke("http://www.example.com"); 
```

如果我替换，则不会引发异常`ldarg.1`；`newobj <ctor>`，`ldnull`所以问题肯定是由这两条IL指令引起的。进一步的实验表明，错误在于`ldarg.1`。（对于上面的具体示例，我已将其替换为 a `ldstr <string>`。）

有人看到这些 IL 指令有什么问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T16:42:43.247

这个方法是静态的，所以它没有`this`参数 as `arg0`。改变`il.Emit(OpCodes.Ldarg_1);`对`il.Emit(OpCodes.Ldarg_0);`我来说很好。

# ruby - Ruby：STDIN.gets() 和 gets.chomp() 有什么区别？

> ID：12041492
> 
> 赞同：10
> 
> 时间：2012-08-20T16:29:29.093
> 
> 标签：ruby

Ruby`STDIN.gets()`和 和有什么区别？`gets.chomp()`他们不是都从用户那里检索原始输入吗？

附带问题：如果我想将他们的输入转换为整数，我会这样做吗

```
myNumb = Integer(STDIN.gets()) 
```

和

```
myNumb = Integer(gets.chomp()) 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-20T16:38:23.333

`gets`实际上是[Kernel#gets](http://www.ruby-doc.org/core-1.9.3/Kernel.html#method-i-gets)。它从作为参数传递的文件中读取，如果没有参数，则从标准输入中读取。如果您只想从标准输入中读取，那么您应该更加明确。

```
STDIN.gets
$stdin.gets 
```

至于转换，我通常使用[String#to_i](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-to_i)。它可以很好地处理换行符。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-02-20T13:22:42.060

因为如果 ARGV 中有东西，默认的 gets 方法会尝试将第一个文件视为文件并从中读取。在这种情况下，要从用户的输入（即标准输入）中读取，您必须明确使用它 STDIN.gets。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-20T16:33:32.703

做你在这里描述的最简单的方法是`Integer(gets)`，因为`Integer()`忽略了尾随的换行符，所以`chomp`没有必要。也不需要明确指定为接收者，因为如果脚本没有参数，`STDIN`这就是[Kernel#gets将执行的操作。](http://www.ruby-doc.org/core-1.9.3/Kernel.html#method-i-gets)

# html - 单个单元格宽度的 HTML 表格行高

> ID：12041498
> 
> 赞同：0
> 
> 时间：2012-08-20T16:29:57.700
> 
> 标签：html, html-table

我正在尝试创建一个可以具有可变行数的表格，并且每行都有 1 个单元格宽度。

但是，在某些情况下，我希望一行具有几行的高度（例如 3 行）。我已经尝试为此使用 rowspan ，但是它似乎将前面的行包装到同一行中（不是我想要的）。

有没有办法处理单个单元格宽度表？

编辑：添加示例

```
 <table border="1">
        <tr>
            <td height="3">big</td>
        </tr>
        <tr>
            <td>small</td>
        </tr>
        <tr>
            <td>small</td>
        </tr>
        <tr>
            <td>small</td>
        </tr>
        <tr>
            <td>small</td>
        </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T16:45:30.677

对于单列，它不可能用于行跨度。如果您尝试在一个单元格中使用多行`<br/>`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-21T13:41:34.330

我建议改用 CSS。

```
 <style>
     .big{
         height:100px;
     }

     .small{
        height:30px;
     }
 </style>

<table border="1">
        <tr>
            <td class="big">big</td>
        </tr>
        <tr>
            <td class="small">small</td>
        </tr>
        <tr>
            <td class="small">small</td>
        </tr>
        <tr>
            <td class="small">small</td>
        </tr>
        <tr>
            <td class="small">small</td>
        </tr>
</table> 
```

# java - 初学者 Java 项目建议

> ID：12041500
> 
> 赞同：2
> 
> 时间：2012-08-20T16:30:08.513
> 
> 标签：java

我以前从未使用过 Java 编码，我发现拥有一个实际项目可以提高学习过程。

所以，我正在寻找一些“按数字绘制”代码 Java 项目，它们是：

*   给菜鸟的
*   在线，以及
*   自由的。

它需要像乐高一样......例如，有一张你将要创建的图片，对组件的描述，以及如何完成项目的分步说明。是的，我用过谷歌，搜索过 stackoverflow，甚至在亚马逊上寻找食谱，但我似乎找不到我想要的。

为了把这个问题放到上下文中，我是一个初学者程序员，他做了一些修补，但希望变得更好。我开始在 Ubuntu 上用 Perl 学习计算机编程，但发现它太难快速（发现错误很难，而且很难对网络抓取进行编程），而且我没有从在线 Perl 社区找到太多帮助来推进我的项目（Perlmonks for例如，除非当我想自己学习如何做时，我花钱请人去做）。然后我的 Perl 代码项目被放弃了，我没有考虑用另一种语言来做。一年后，我拿起 AutoIt 来克服工作中痛苦和重复的 IE 任务。我在 AutoIt 上走得很远，发现社区很棒，随时准备提供帮助。我最终制作了一些我每天在工作中使用的不同程序。我试图在 AutoIt 中扩展到更复杂的网络抓取和自动化，但发现它随着 IE9 的发布而中断，并且在遇到广泛使用 JavaScript 的网站时非常难以编程。我将学习 C# 视为克服 AutoIt 中这些限制的一种方式，但发现我不能轻易跳入 C# 程序 IE 自动化任务。我真的受到了一个[关于成为数据科学家的视频](http://datascience101.wordpress.com/2012/05/02/the-first-ever-data-scientist/)，我现在正在尝试学习 Java，以完成[免费的在线算法和机器学习课程](http://www.coursera.org)，并最终掌握 OOP。我尝试过开始这些课程，但发现需要深入了解 Java。我从一门涵盖基础知识的免费 Java 课程开始，但在学习材料时发现如果没有要考虑的项目就很难学习。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T18:37:23.693

当我第一次学习 Java 时，我使用[了 JavaBat](http://javabat.com)，现在称为[CodingBat 。](http://codingbat.com)它适用于初学者，免费和在线。也许您可以从 String-1 的 helloName 开始并从那里开始构建。我会将它与其他资源一起使用，但这是练习不同概念的好方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T18:15:16.453

我强烈建议您在深入 Java 之前获得*非常强大的 Java 前基础。*原因是，Java 并不是一种容易掌握逻辑和一般概念的第一语言——语法可能很困难。查看可汗学院的视频。

这样做大约一个月，然后开始 Java 编码，完成 sun 教程。目标是每天至少编程 5 分钟（例如，在教程之外）。10分钟会经常发生。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T16:36:37.353

逐步升级到 java。

从这里开始[http://w3schools.com](http://w3schools.com)并学习与 HTML/JavaScript/Php 等相关的所有内容。然后接java。

虽然如果你确信你想从 java 开始，那么下载 netbeans IDE 并阅读他们的教程。他们很好。 [网豆](http://netbeans.org)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T17:59:46.887

从 Java 开始，我会向您推荐 Deitel 的 How to Program 书籍之一，代码解释充分且非常清晰，其中包括练习和完整项目，您可以在阅读本书时完成。

# c++ - c4930 可能的编译器错误

> ID：12041509
> 
> 赞同：4
> 
> 时间：2012-08-20T16:31:12.487
> 
> 标签：c++, visual-studio, warnings

我只是想在这里发布这个以确保我没有遗漏一些完全明显的东西（因此会觉得很傻）。这是我编写的一些代码的简化版本。

```
template <int NDIM, typename T = int>
class COORD {
public:
    COORD(T dim0) { m_data[0] = dim0; }
private:
    T m_data[NDIM];
};

template <class COORD>
class NODE {
public:
    NODE(const COORD& c = COORD()) : m_coord(c) {}
private:
COORD m_coord;
};

int main()
{
    const int VAL = 10;
    NODE< COORD<1> > n( COORD<1>( VAL ) ); // warning c4930???
    NODE< COORD<1> > n2( COORD<1>( 10 ) );
    COORD<1> c( VAL );
    NODE< COORD<1> > n3( c );
    return 0;
} 
```

语句“NODE<COORD<1> > n(COORD<1>(VAL));” 给出：

```
warning C4930: 'NODE<COORD> n(COORD<NDIM>)': prototyped function not called
(was a variable definition intended?)
    with
    [
        COORD=COORD<1>,
        NDIM=1
    ] 
```

但是，'n2' 和 'n3' 的 decl 编译得很好。这是 VC2008 和 VC2010，我还没有尝试过 VC2012。这段代码似乎在 GCC 4.5.3 上编译得很好。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-20T16:35:52.917

这被称为[“最令人头疼的解析”](http://en.wikipedia.org/wiki/Most_vexing_parse)。您可能认为您正在创建一个临时对象并使用它来初始化一个变量；但编译器将其解释为函数声明。具体来说，`n`是一个返回的函数`NODE<COORD<1>>`，它接受一个参数，该参数是一个指向一个函数的指针，该函数接受一个名为`VAL`（缺少类型说明符）的参数，并返回`COORD<1>`。

您可以通过添加括号来修复它，这样它就不会被解释为函数声明：

```
NODE< COORD<1> > n( ( COORD<1>( VAL ) ) );
                    ^                 ^ 
```

# actionscript-3 - 将 rsync 与空气应用程序一起使用

> ID：12041511
> 
> 赞同：0
> 
> 时间：2012-08-20T16:31:46.980
> 
> 标签：actionscript-3, flash-builder, rsync

我想在我的空中应用程序中包含一个备份功能。目标是从计算机复制目录以删除支持（例如 USB 磁盘）。由于主目录包含很多子目录，我认为使用 rsync 同步源和目标是一个好方法。

你为什么这么想，你知道如何用空气项目做到这一点。

感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T21:05:46.963

在 adobe air 中，您可以调用命令行。看看[这个](http://help.adobe.com/en_US/AIR/1.5/devappshtml/WS5b3ccc516d4fbf351e63e3d118676a5d46-8000.html)。这应该允许您使用 rsync。

# ubuntu - 除非明确指定 CAfile，否则 OpenSSL 无法获取本地颁发者证书

> ID：12041512
> 
> 赞同：12
> 
> 时间：2012-08-20T16:31:49.233
> 
> 标签：ubuntu, ssl, openssl, ssl-certificate, apple-push-notifications

我正在尝试从应用程序的 Ubuntu 服务器连接到 Apple 的推送通知服务。我已经成功生成了我正在使用的 pyAPNS 提供程序所需的组合 .pem 证书。但是，当我尝试使用 验证证书时`openssl verify`，我得到`error 20 at 0 depth lookup:unable to get local issuer certificate`. 如果我明确指定证书颁发机构（`openssl verify apns.pem -CAfile entrust_2048_ca.pem`），它会起作用，但我已经按照[此处](https://help.ubuntu.com/community/OpenSSL#SSL%20Certificates)的说明在系统上明确安装了 Entrust 证书，在“将证书导入系统范围的证书颁发机构数据库”下，据我所知[这个页面](http://www.madboa.com/geek/openssl/#verify-new)，一切都是应该的（证书在 /usr/lib/ssl/certs 中，并且有一个符号链接到它的哈希）。

如果我尝试使用以下方式连接到 APNS 本身，也会发生同样的情况`openssl s_client`：如果我明确指定 CAfile，它似乎可以连接，否则不会。PyAPNS 告诉我它无法连接到 APNS 服务器，我只能假设这是出于同样的原因。

如何让 OpenSSL 默认识别 Entrust 证书颁发机构，而无需每次都明确指定？我在某处错过了一步吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-20T17:25:34.333

OpenSSL 使用证书颁发者 DN 的哈希值在安装 CA 证书的默认目录中查找文件。

请参阅[OpenSSL`verify`文档](http://www.openssl.org/docs/apps/verify.html)：

> -CApath 目录
> 
> 受信任证书的目录。证书应该具有以下形式的名称：hash.0 或具有这种形式的符号链接（“散列”是散列的证书主题名称：请参阅 x509 实用程序的 -hash 选项）。在 Unix 下，c_rehash 脚本将自动创建指向证书目录的符号链接。

这些散列值将来自每个 CA 证书的主题 DN（因为目标是查找主题与证书颁发者匹配的 CA 证书以进行验证）。您可以`c_rehash`按照文档说明使用，也可以使用获取主题 DN 的哈希`openssl x509 -subject_hash -noout -in cacert.pem`并相应地重命名文件/链接。

要验证的证书的直接颁发者可能不是根 CA 证书：链中可能存在中间 CA 证书。您还需要确保使用了中间证书。

此外，还有两种不同的哈希格式（自 OpenSSL 1.0 版以来发生了变化），值得同时使用`-subject_hash_old`和建立链接`-subject_hash`，尽管默认情况下 OpenSSL 本身应该只使用其新格式。

# cakephp - CakePHP 2.1：德语变音符号的 Sluggable 行为

> ID：12041515
> 
> 赞同：1
> 
> 时间：2012-08-20T16:32:01.250
> 
> 标签：cakephp, cakephp-2.1, slug

我正在使用 Marino Iglesias 的 SluggableBehavior 在保存条目的同时生成 slug。现在，由于我的博客也会有一些德语帖子，所以 slugging 也应该适用于 ä,ü,ö 等元音变音。例如，“Schöne neue Welt”应该变成“schoene-neue-welt”。

现在，它变成了“sch-ne-neue-welt”。我彻底使用 utf-8 作为我的编码 - 文件、数据库、一切，所以这不应该是原因。

我不太明白代码中发生了什么，但是从我在代码中看到的内容来看，应该包括从 ö 到 oe 之间的转换。

有人处理过这种问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T16:48:03.637

任何较新的版本都不应该是问题。

试试这个： [https ://github.com/dereuromark/cakephp-tools/blob/master/Model/Behavior/SluggedBehavior.php](https://github.com/dereuromark/cakephp-tools/blob/master/Model/Behavior/SluggedBehavior.php)

我在所有项目中都使用它，没有问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T12:28:01.947

根据您的问题，我假设您使用的是与 Cake2 兼容的版本[CakePHP-Sluggable-Behaviour](https://github.com/pronique/CakePHP-Sluggable-Behavior) by [pronique](https://github.com/pronique)。

`translation`像这样将其添加到模型时，您可以传递一个选项。

```
var $actsAs = array(
  'Sluggable.Sluggable' => array(
    'translations' => 'utf-8',
  ),
); 
```

但这对我也不起作用。我为此提交了一个[错误报告](https://github.com/pronique/CakePHP-Sluggable-Behavior/issues/1)，并使用了 mark 已经推荐的行为。

# php - $_GET["q"] ... $q==1 echo "yadda yadda yadda!" ...回来未定义。使用 XAMPP 的本地主机

> ID：12041517
> 
> 赞同：0
> 
> 时间：2012-08-20T16:32:23.203
> 
> 标签：php, javascript, html, ajax

所以这个函数非常简单（对我来说不是那么多！），它采用 HTML 表单，在选择下拉选项时，它将选项值发送到 index.php 并得到一个响应，根据它改变的响应页面内容！但它不断返回“未定义”...我正在使用 XAMPP 从 localhost/index.php 运行网页。

```
 <div id="currentactivity">
      <table width="800" border="1">
      <tr><td colspan="2"><br /><center><h2>Dynamically change page content with Ajax &amp; PHP</h2></center></td>
      </tr>
      <tr>
      <td width="200">
      <form>
      <select name="Data" onChange="showData(this.value)">
      <option value="">Select page Content:</option>
      <option value="1">Page Content 1</option>
      <option value="2">Page Content 2</option>
      <option value="3">Page Content 3</option>
      <option value="4">Page Content 4</option>
      </select>
      </form>
      </td>
      <td><div id="showData">Use the select box to change page content</div></td>
      </tr>
      </table>
    </div> 
```

下面是 JavaScript 函数。（我目前让它通过一个外部 .js 脚本运行，但我已经直接从该部分尝试了该功能，它做了完全相同的事情！）

```
function showData(str)
{
if (str=="")
  {
  document.getElementById("showData").innerHTML="";
  return;
  }
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("showData").innerHTML=xmlhttp.resonseText;
    }
  }
xmlhttp.open("GET","index.php?q="+str,true);
xmlhttp.send();
} 
```

下面是我的 PHP 页面（是的，这是直接从教程网站上抄袭的！）

```
<?php
$q=$_GET["q"];

if ($q==1) {echo "Page Content 1 would be shown";}
if ($q==2) {echo "Page Content 2 would be shown";}
if ($q==3) {echo "Page Content 3 would be shown";}
if ($q==4) {echo "Page Content 4 would be shown";}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T16:39:52.610

这`xmlhttp.resonseText`应该是`xmlhttp.responseText`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T16:41:41.840

我相信以下html：

```
<select name="Data" onChange="showData(this.value)"> 
```

可能适用于某些但并非所有浏览器...我认为您应该改用它：

```
<select name="Data" onChange="showData(this.options[this.selectedIndex])"> 
```

# java - 这将是解析以下日志文 件的java正则表达式

> ID：12041518
> 
> 赞同：2
> 
> 时间：2012-08-20T16:32:24.767
> 
> 标签：java, regex, parsing

我需要在java中解析一个日志文件。日志文件包含有关呼叫事务的信息。我感兴趣的行以及其中的信息在日志行条目示例中以粗体标记。对于以下我需要提取的状态和电话号码：

> Aug 15 20:35:22 GMT 2012 tropo109.orl.voxeo.net TROPO 138595 0 e467547d3333724bdd52635bbb713e77 1 d607eb64fb3bfbfd273a55f4b121b903 SimpleOutgoingCall[+17877058826/null->+17877260664/null] : [ **TRANSFER** ,* *+17877260664* *]

从这条线上我需要获取电话号码和总通话时间。

> Aug 15 20:35:22 GMT 2012 tropo109.orl.voxeo.net TROPO 138595 0 e467547d3333724bdd52635bbb713e77 1 d607eb64fb3bfbfd273a55f4b121b903 Logging CDR {"call":{"SipSessionID":"ss_jzto5yd4jruv","SessionID":"e467547d3333724bdd52635bbb713e77","CallID": "d607eb64fb3bfbfd273a55f4b121b903","ParentSessionID":"none","ParentCallID":"none","DateCreated":"2012 年 8 月 15 日星期三 20:34:14 +0000","DateUpdated":"2012 年 8 月 15 日星期三 20 :34:14 +0000","AccountID":"138595","Called": "+ **17877260664** ","Caller":"+17877058826","PhoneNumberSid":"unknown","Disposition":"脚本结束" ，“地位”：”成功","开始时间":"2012 年 8 月 15 日星期三 20:34:14 +0000","结束时间":"2012 年 8 月 15 日星期三 20:35:22 +0000","持续时间":" **67950**","Flags":"out","RecordingDuration":"0","Network":"SIP","Channel":"VOICE","ApplicationId":"392671","ApplicationType":"groovy", "ServiceId":"1291899","StartUrl":"http://hosting.tropo.com/138595/www/outboud-web2ivr.groovy","BrowserIP":"10.6.69.109","PPID":"461 "}}

所以一般来说，我需要解析一个文件，并在不同的日志行条目中获取呼叫状态和持续时间。任何指针？

更新：我得到了获取第一部分的代码，关于如何获取第二部分的任何指针，并且只有一个编译表达式可以在日志条目行中找到 (phone,status) 或 (phone,callduration)？：

```
private static void matchParts( String aText ){

  Pattern pattern = Pattern.compile("(?:\\[(\\w(\\w)*),(\\+\\d{11})\\])");
  Matcher matcher = pattern.matcher(aText );
  String phone;
      String status;
  while (matcher.find()) {
         System.out.println("phone:" +matcher.group(3) + ", status: "+matcher.group(1) );
  }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T17:01:20.163

对我来说，第一个部分中“：”之后的日志部分看起来像一个 JSON 数组，而第二部分中 CDR 之后的部分日志部分看起来像一个 JSON 映射。您可以使用您选择的任何语言的简单 JSON 库来转换这些日志部分并以结构化方式访问所需的信息：http: [//json.org](http://json.org)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T21:42:30.923

对于第一个：

```
private static void matchParts(String line){
   Pattern pattern = Pattern.compile(": \\[(\\w+),\\*(\\+\\d{11})\\*]");
   Matcher matcher = pattern.matcher(line);
   String phone;
   String status;
   while (matcher.find()) {
      System.out.println("phone:" +matcher.group(2) + ", status: "+matcher.group(1) );
   }
} 
```

对于第二个：

```
private static void matchParts(String line){
   Pattern pattern = Pattern.compile("Called\":\"(\\+\\d{11}).*\"Duration\":\"(\\d+)");
   Matcher matcher = pattern.matcher(line);
   String phone;
   String status;
   while (matcher.find()) {
      System.out.println("phone:" +matcher.group(1) + ", duration: "+matcher.group(2) );
   }
} 
```

在查找正则表达式时，我使用这个非常方便的工具：[http ://www.regexplanet.com/advanced/java/index.html。](http://www.regexplanet.com/advanced/java/index.html)

**编辑：** 如果您正在寻找 1 个正则表达式，它可能是这样的：

```
Pattern.compile("\\[(\\w+),\\*(\\+\\d{11})\\*].*?Called\":\"(\\+\\d{11}).*?\"Duration\":\"(\\d+)", Pattern.MULTILINE); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T16:50:43.663

这都是一行还是多行？

如果第一个是多行，则：

```
String line = yourline
if(line.indexOf("SimpleOutgoingCall" != -1)
{
    String data = line.split(":")[1];
    String status = data.substring(1, data.indexOf(",")); 
} 
```

第二个看起来像前两个是不同的行，但是 {{ ... }} 块是一行“如果是这样：

```
String line = yourline
String data = line.split(",");
String called, duration;
for(int x = 0; x < data.length; x++)
{
    if(data[x].indexOf("Called") != -1)
        called = data[x].split(":")[1];
    if(data[x].indexOf("Duration") != -1)
        duration = data[x].split(":")[1];
} 
```

# python - 如何获得特定时间跨度的平均值

> ID：12041519
> 
> 赞同：1
> 
> 时间：2012-08-20T16:32:26.160
> 
> 标签：python, time, html, pandas, mean

我两周前开始学习，现在我有点卡住了。我有 2 个 TimeSeries，看起来像这样：

```
2011-01-09 00:00:00+00:00    7.430126
2011-01-09 01:00:00+00:00    6.793855
2011-01-09 02:00:00+00:00    6.675949
2011-01-09 03:00:00+00:00    6.756636
2011-01-09 04:00:00+00:00    6.875174
2011-01-09 05:00:00+00:00    5.432611
2011-01-09 06:00:00+00:00    6.059197
2011-01-09 21:00:00+00:00    5.338928
2011-01-09 22:00:00+00:00    5.259672
2011-01-09 23:00:00+00:00    5.247196
2011-01-10 00:00:00+00:00    5.889274
2011-01-10 01:00:00+00:00    6.133871
2011-01-10 02:00:00+00:00    6.111958
2011-01-10 03:00:00+00:00    5.873732
2011-01-10 04:00:00+00:00    5.627684
2011-01-10 05:00:00+00:00    5.265644
2011-01-10 06:00:00+00:00    5.505559
2011-01-10 21:00:00+00:00    3.835050
2011-01-10 22:00:00+00:00    3.879653
2011-01-10 23:00:00+00:00    4.034543
2011-01-11 00:00:00+00:00    4.844272
2011-01-11 01:00:00+00:00    4.670967
2011-01-11 02:00:00+00:00    4.584164
2011-01-11 03:00:00+00:00    4.786821 
```

这是风速测量的数据，我想将其与模型数据进行比较。更具体地说，我想比较夜间（21.00 - 6.00）的风速。所以我定义了一个函数：

```
def func(model, measure):
    return (model-measure).mean() 
```

此外，我在数据上创建了一个循环：

```
mean_night = []
start = 7
for a in night:
    mean_night.append(func(model, measure[start:(start+10)]))
    start = start+11
    if start>5378:
            break 
```

问题是我丢失了时间索引并且丢失了一些数据（例如 1 天或 1 周），所以我在使用 DateRange 重新索引它时遇到了麻烦。最后，它应该如下所示：

```
date    difference_means
2011-01-09    diff_1
2011-01-09    diff_2 
```

等等。我使用熊猫 0.7.1。谢谢你的支持！（对不起我的英语不好：P）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T20:08:28.723

pandas 0.8.1 对于每小时采样数据：

```
In [57]: import pandas

In [58]: import numpy

In [59]: index = pandas.date_range(start='2011-01-09', periods=240, freq='H')

In [60]: s = pandas.Series(np.random.randn(len(index)), index)

In [61]: s_night = s[(s.index.hour >= 21) | (s.index.hour <= 6)]

In [62]: def day_or_night(dates):
   ....:     r = []
   ....:     for date in dates:
   ....:         if (date.hour >= 21) | (date.hour <= 6):
   ....:             d = datetime.datetime(date.year, date.month, date.day)
   ....:             if (date.hour <= 6):
   ....:                 d = d - pandas.offsets.Day()
   ....:             r.append(d)
   ....:         else:
   ....:             r.append('day')
   ....:     return r
   ....:

In [63]: s_night.groupby(day_or_night(s_night.index)).mean()
Out[63]:
2011-01-08    0.652095
2011-01-09    0.004129
2011-01-10    0.457892
2011-01-11   -0.078547
2011-01-12    0.008087
2011-01-13    0.043568
2011-01-14    0.505970
2011-01-15    0.150971
2011-01-16    0.107265
2011-01-17    0.117811
2011-01-18   -0.191193 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T16:49:59.667

您应该升级到 0.8.1 并利用所有新的时间序列功能。请查看[http://pandas.pydata.org](http://pandas.pydata.org)获取文档。

在最新版本中，结帐功能喜欢`between_time`在特定时间范围内进行过滤。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T15:08:07.557

我终于找到了一个可行的解决方案：

```
hr = dr.map(lambda x: x.hour)
meantime = lambda x: x.replace(hour=0)

datra = pd.DateRange('2011/1/1', '2011/12/31', offset=pd.datetools.day)
rise = pd.TimeSeries(np.cos(((datra.map(lambda x: (x-datetime(x.year,1,1)).total_seconds() / 86400) + 10) / 183\. * np.pi)) * -2\. + 17., index=datra)
set = pd.TimeSeries(np.cos(((datra.map(lambda x: (x-datetime(x.year,1,1)).total_seconds() / 86400) + 10) / 183\. * np.pi)) * 2.5 + 5., index=datra)

i=0
def bias_night(liste, group):
while (i<546):
    if (i<364):
        z = group[dr[hr>unter11[i]]].combine_first(group[dr[hr<auf11[i+1]]]).groupby(meantime).mean()
        liste.append(z[i])
    else:
        z = group[dr[hr>unter11[i-365]]].combine_first(group[dr[hr<auf11[i-365+1]]]).groupby(meantime).mean()
        liste.append(z[i])
    i = i+1
t = group[dr[hr>unter11[364]]].combine_first(group[dr[hr<auf11[0]]]).groupby(meantime).mean()
liste.insert(364, t[364]) 
```

liste 是一个空列表， group 是我的 TimeSeries 之一。最后，我只需减去结果列表即可得到我想要的。

```
2011-01-09   -1.179578
2011-01-10   -0.978171
2011-01-11   -0.335977
2011-01-12    0.080671
2011-01-13   -0.324661
2011-01-14    0.012359
2011-01-15   -0.549079 
```

# android - 防止将自定义 mimetype 拖放到 EditText

> ID：12041523
> 
> 赞同：11
> 
> 时间：2012-08-20T16:32:41.563
> 
> 标签：android, drag-and-drop, android-edittext, mime-types

我有一个自定义 mime 类型，我打算用它在应用程序中拖放应用程序对象。这似乎有效，但我发现 EditText 字段也接受了放置操作。我不希望这种情况发生。

首先，我定义了这样的客户 mime 类型：

```
public static final String MIME_TYPE_MYNODE = "com.example.mockup/mynode"; 
```

然后，在我拥有的源对象的 onTouch 处理程序中：

```
 @Override
  //-----------------------------------------------------------------------------
  public boolean onTouch (View v, MotionEvent e)
  {
    ...
    else if (e.getAction() == MotionEvent.ACTION_MOVE)
    {
      String[] mimeTypes = {MIME_TYPE_MYNODE};
      ClipData data = new ClipData ("Task Tamer Note", mimeTypes, new ClipData.Item ("unused"));
      View.DragShadowBuilder shadow = new View.DragShadowBuilder(this);
      Object localState = v;
      startDrag (data, shadow, localState, 0);
      return false;
    }
  }
  ...
} 
```

当我在 EditText 小部件上“放置”时，它会将“未使用”插入文本区域。我怎样才能防止这种情况？谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-03-13T14:36:33.570

我遇到了同样的行为。我找到了原因，它位于 TextView 类中。

方法 onDragEvent(DragEvent event) 在这里被覆盖，如下所示。

```
@Override
public boolean onDragEvent(DragEvent event) {
    switch (event.getAction()) {
        case DragEvent.ACTION_DRAG_STARTED:
            return mEditor != null && mEditor.hasInsertionController();

        case DragEvent.ACTION_DRAG_ENTERED:
            TextView.this.requestFocus();
            return true;

        case DragEvent.ACTION_DRAG_LOCATION:
            final int offset = getOffsetForPosition(event.getX(), event.getY());
            Selection.setSelection((Spannable)mText, offset);
            return true;

        case DragEvent.ACTION_DROP:
            if (mEditor != null) mEditor.onDrop(event);
            return true;

        case DragEvent.ACTION_DRAG_ENDED:
        case DragEvent.ACTION_DRAG_EXITED:
        default:
            return true;
    }
} 
```

如果可以插入文本 => EditText，那么任何拖动都将在那里被处理和接受。View 类未使用 OnDragListener，因此无法通过以下方式阻止此行为

```
editText.setOnDragListener(null); 
```

此处的解决方案是将 EditText 子类化为此处并覆盖 onDragEvent() 方法：

```
 public class YourEditText extends EditText {

 ...
 // other stuff
 ...

 @Override
 public boolean onDragEvent(DragEvent event) {
    switch (event.getAction()) {
       case DragEvent.ACTION_DRAG_STARTED:
           if (event.getClipDescription().hasMimeType(ClipDescription.MIMETYPE_TEXT_PLAIN)) {
               return true;
           }
           return false;
       default:
           return super.onDragEvent(event);
    }
} 
```

}

现在 YourEditText 将只接受带有 MIMETYPE_TEXT_PLAIN 的拖动。如果您想完全禁用拖放，只需在此方法中返回 false `

```
@Override
public boolean onDragEvent(DragEvent event) {
    return false;    
} 
```

就是这样。希望它会有所帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-04T09:23:48.007

我遇到了类似的问题，因为我不希望布局接受放置操作。

通过 setOnDragListener 将拖动侦听器附加到您的编辑字段。

```
edtText.setOnDragListener(new MyDragListener()); 
```

检查 onDrag 事件中的目标视图是否是您的编辑文本。

```
class MyDragListener implements OnDragListener {

    @Override
    public boolean onDrag(View v, DragEvent event) {

      switch (event.getAction()) {
         case DragEvent.ACTION_DROP:
             //check whether it has been dropped onto your edit text
              if(v!=edtText)
                  //your code here
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-15T16:13:08.147

你可以写

```
edit.setEnabled(false);
edit.setFocusable(false); 
```

就在调用之后，并在之后恢复该特定控件`startDrag()`的旧值。`editText``DragEvent.ACTION_DRAG_ENDED`

但是，老实说，这是一种非常肮脏的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-09-27T15:11:41.717

> 如果拖动事件成功处理，则返回 true；如果拖动事件未处理，则返回 false。请注意， false 将触发 View 调用其 onDragEvent() 处理程序。

这是 onDrag(View v, DragEvent event) 文档中的声明。因此，如果您返回 false，则事件由 EditText 的 onDragEvent() 处理。因此，最简单的解决方案是：

```
editText.setOnDragListener(new OnDragListener() {

        @Override
        public boolean onDrag(View v, DragEvent event) {
            return true;
        }
    }); 
```

如果您想执行某些功能，请根据 Drag 事件指定它们将被执行。

# android - 如何从片段内控制 Activity FragmentTransaction？

> ID：12041524
> 
> 赞同：1
> 
> 时间：2012-08-20T16:32:42.547
> 
> 标签：android, android-layout, android-fragments, android-activity

我确定这个问题很基本，但我很新。现在我的主要活动下有一个 FragmentTransaction（见下文），我希望能够从这些片段之一中执行“替换”。我相信它会涉及 getActivity() 但我不太确定该怎么做？

如果有人能给我一个例子，那就太好了，在此先感谢:)

```
public void onTabSelected(Tab tab, FragmentTransaction ft) {
    {
        if(tab.getPosition()==0)
        {
        firstFragment frag = new firstFragment();
        ft.replace(android.R.id.content, frag);
        }
        else if(tab.getPosition()==1)
        {
        newsFragment frag = new newsFragment();
        ft.replace(android.R.id.content, frag);
        }
        else if(tab.getPosition()==2)
        {
        thirFragment frag = new thirFragment();
        ft.replace(android.R.id.content, frag);
        }
        else if(tab.getPosition()==3)
        {
        calendar frag = new calendar();
        ft.replace(android.R.id.content, frag);
        }
        else if(tab.getPosition()==6)
        {
        linksFragment frag = new linksFragment();
        ft.replace(android.R.id.content, frag);
        }
        else if(tab.getPosition()==5)
        {
        contactFragment frag = new contactFragment();
        ft.replace(android.R.id.content, frag);
        }
        }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T16:41:21.160

要使用片段事务，您可以这样做：

```
 FragmentManager fmu = getSupportFragmentManager();
                FragmentTransaction ftu = fmu.beginTransaction();
                RSSFragment rssfrag;
                ftu.replace(R.id.frame_fragment, rssfrag).commit(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T16:38:02.590

声明一个类变量 rootActivity，在你的 onCreate() 方法中实例化。

```
public class yourclass
Activity rootActivity;
public void onCreate(){
     super.onCreate();
     rootActivity = getActivity();
} 
```

# python - 使用 python 获取安装 python 的根目录/驱动器的系统独立方式

> ID：12041525
> 
> 赞同：52
> 
> 时间：2012-08-20T16:32:44.927
> 
> 标签：python, path, operating-system, cross-platform

对于 Linux，这会给我`/`，对于 C 驱动器上的 Windows，这会给我`C:\\`。注意python不一定安装在windows的C盘。

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2014-03-07T16:26:24.320

尝试这个：

```
import os

def root_path():
    return os.path.abspath(os.sep) 
```

在 Linux 上返回`/`

在 Windows 上，这将返回`C:\\`或当前驱动器是什么

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-08-20T16:38:36.113

您可以使用以下命令获取 Python 可执行文件的路径`sys.executable`：

```
>>> import sys
>>> import os
>>> sys.executable
'/usr/bin/python' 
```

然后，对于 Windows，驱动器号将是 splitdrive 的第一部分：

```
>>> os.path.splitdrive(sys.executable)
('', '/usr/bin/python') 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-08-20T16:48:58.790

这是您需要的：

```
import sys, os

def get_sys_exec_root_or_drive():
    path = sys.executable
    while os.path.split(path)[1]:
        path = os.path.split(path)[0]
    return path 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-05-25T21:41:40.703

使用[`pathlib`](https://docs.python.org/3/library/pathlib.html)（Python 3.4+）：

```
import sys
from pathlib import Path

path = Path(sys.executable)
root_or_drive = path.root or path.drive 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2021-01-31T02:09:53.740

根据 Eugene Yarmash 的回答，您可以在 Python >= 3.4 中使用该`PurePath.anchor`属性`[pathlib](https://docs.python.org/3/library/pathlib.html#pathlib.PurePath.anchor)`，即：

> 驱动器和根目录的串联

`sys.executable`用于获取 python 安装的位置，一个完整的解决方案是：

```
import sys
from pathlib import Path

root = Path(sys.executable).anchor 
```

这会导致在`'/'`POSIX（Linux、Mac OS）上，并且应该`'c:\\'`在 Windows 上为您提供（假设您的安装是 on `c:`）。您可以使用任何其他路径而不是`sys.executable`获取该其他路径所在的驱动器和根目录。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-02-27T16:04:05.077

这是一个跨平台的 PY2/3 兼容函数，它返回给定路径的根。根据您的上下文，您可以将 python 可执行路径、脚本所在的路径或对您的用例有意义的任何内容输入其中。

```
import os

def rootpath( path ):     
    return os.path.splitdrive(os.path.abspath( path ))[0] + os.sep 
```

所以对于 Python 解释器的根路径：

```
import sys

PY_ROOT_PATH = rootpath( sys.executable ) 
```

# iphone - 刷新 TabItem 中的视图

> ID：12041530
> 
> 赞同：0
> 
> 时间：2012-08-20T16:33:00.137
> 
> 标签：iphone, objective-c, ios, ios4

我的第一个选项卡中有一个视图，可以更改 DatageStorageController 中的数据。当我单击第二个选项卡时，它应该显示数据存储，但视图未更新。如何刷新视图？它不是一个 UITable 视图，只是一个视图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T18:00:43.133

我认为您正在将代码写入 viewDidLoad。您应该将此代码写入要更新的 viewWillAppear 中。在 ViewAppear 上。或第二种方法，您可以使用 tabbarcontroller 的委托方法

像

*   (void)tabBarController:(UITabBarController *)tabBarController didSelectViewController:(UIViewController *)viewController

使用此方法，您可以接收您选择的参数 viewController。

[viewController viewDidLoad];

这意味着您再次加载视图。您还调用 [viewController viewWillAppear];

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T17:48:53.327

好吧，您可以实现[UITabBarDelegate](http://developer.apple.com/library/ios/ipad/#DOCUMENTATION/UIKit/Reference/UITabBarDelegate_Protocol/Reference/Reference.html)协议并在“tabBar:didSelectItem”中更新您的控制器视图。但这种方法可能不是最干净的！应该以某种方式通知第二个控制器数据更改，以便他可以更新其视图。也许看看 KVO/KVC！

# actionscript-3 - Flash AS3 中的文本链接

> ID：12041542
> 
> 赞同：3
> 
> 时间：2012-08-20T16:34:04.657
> 
> 标签：actionscript-3, events, text

所以我自己为一些在 Dropbox 上工作的朋友制作了一个类似“wiki”的应用程序，这意味着所有文件都存储在本地并由每个人更新。

每个文件都是由闪存拉入的 .txt，然后使用简单的导航和搜索工具显示。

现在我正试图更进一步，并从他们的内容中链接文章。例子：

第 1 条被称为“苹果”。它的内容是：“苹果很好吃。” 第 2 条被称为“熊”。它的内容是：“熊经常吃苹果。”

现在，当用户打开第 2 条时，我希望他们能够单击“苹果”一词，然后打开第 1 条（“苹果”）。

我想知道如何创建在动态文本框中单击特定单词时触发的事件。不是整个动态文本框。

我曾想过创建可点击的单词形状的电影剪辑并将它们分层覆盖在单词上，但如果有更简单的选项可用，那就太麻烦了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T16:41:11.897

您可以使用文本框的[`htmlText`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/text/TextField.html#htmlText)属性来动态创建单词链接。然后使用[`TextEvent.LINK`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/text/TextField.html#event:link)事件来捕捉点击的单词。

在用内容填充文本框之前，只需遍历“关键字”列表并执行`.replace("keyword", '<a href="event:keyword">keyword</a>');`

因此，您的代码将类似于：

```
// get the file contents using whatever method you use
var contents:String = getFileContents("page2.txt");

// assuming you have your keywords in an array
var keywords:Array = ["Apples", "Pears"];
for each (var keyword:String in keywords) {
    // replace the current keyword with a version of itself wrapped in a link
    contents = contents.replace(keyword, '<a href="event:' + keyword + '">' + keyword + '</a>');
}

yourTextField.htmlText = contents;

// add an eventlistener for the click
yourTextField.addEventListener(TextEvent.LINK, linkClicked);
function linkClicked(e:TextEvent):void {
    // load the article for the clicked word =]
    loadPage(e.text);
} 
```

**更新**
如果您想忽略关键字的大小写，因此“apples”将匹配“Apples”（“aPpLeS”也将匹配），您需要使用正则表达式，以便您也可以保持单词原样在文中：

```
// build a |-separated list of keywords
var keywordList:String = "";
for each (var keyword:String in keywords) {
    keywordList += ((keywordList != "") ? "|" : "") + keyword;
}
// build the regex and replace each keyword in-place
var pattern:RegExp = new RegExp("(" + keywordList + ")", "gi"); // "i" for ignore-case =]
contents = contents.replace(pattern, '<a href="event:$1">$1</a>'); 
```

上面建立一个`|`-separated 关键字列表并进行单个替换（而不是每个关键字的替换）的原因是因为分隔列表将按顺序进行替换，并且不允许找到的关键字破坏插入的 HTML以前的关键字（例如，您有一个关键字“event” - 如果将其替换为 make ，HTML 会中断`<a href="<a href="event:event">event</a>:keyword1">keyword1</a>`）。

文本的原始大小写将与事件一起发送。您可以搜索所有现有关键字并将它们与传递给事件的关键字进行比较（将两者都转换为小写以`.toLowerCase()`进行比较），或者您可以制定一个规则，即主关键字*始终*为小写且没有担心每次都在列表中搜索。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-20T16:40:26.400

Flash TextField 有一个名为 htmlText 的属性，如果您使用它而不是常规的 text 属性，您可以将 html 放在您的文本字段中，允许您在特定的“链接”上使用 href 标记，就像 HTML 页面一样。

```
myTextField.htmlText = "<a href='http://blahblahblah.com/apples'>Apples</a>"; 
```

或者，如果您想留在闪存中并执行一个功能：

```
myTextField.htmlText = "<a href='event:myEvent'>Click Me.</a>"
myTextField.addEventListener(TextEvent.LINK, linkClickHandler);

function linkClickHandler(e:TextEvent):void {
    trace(e.text); // myEvent
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-20T16:41:56.420

您可以使用 htmlText 和链接事件来检测和重定向到不同的文章：

```
var link:String = "apples";

text.htmlText = '<a href="event:' + link+ '">' + link + '</a>'; 
text.addEventListener(TextEvent.LINK,linkEvent);

function linkEvent(event:TextEvent):void 
{   
    trace(event.text);
    if(event.text == "apples")
    {
       //do stuff
    }
} 
```

# mysql - 在 Play Framework/JPA/hibernate 中截断表？

> ID：12041547
> 
> 赞同：4
> 
> 时间：2012-08-20T16:34:29.083
> 
> 标签：mysql, hibernate, jpa, playframework, playframework-1.x

在 mysql 中，`DELETE FROM table`比`TRUNCATE TABLE table`

我相信 JPA 的`Entity.deleteAll()`运行删除。截断的正确方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-21T07:38:12.367

`TRUNCATE TABLE table`不是标准 SQL，因此一般不支持。为此，请直接执行查询：

`em().createNativeQuery("truncate table MyTable").executeUpdate();`

在 Play Model 类中（您可以在其中访问`EntityManager`with `em()`.

# jquery - 为什么 Asp.net Web Service(asmx) 不火？

> ID：12041548
> 
> 赞同：0
> 
> 时间：2012-08-20T16:34:29.133
> 
> 标签：jquery, asp.net, web-services, asmx

我正在使用 jquery ajax 使用 Asp.net 调用 Web 服务。但是我的 WebMethod 没有触发。为什么？

```
 $(document).ready(function () {
        $('#btnAdresBilgisi').click(function () {

            $.blockUI();
            $.ajax({
                type: "GET",
                url: "OnKayitWebService.asmx/HelloWorld",
                data: "{}",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: OnSuccess,
                error: AjaxFailed

            });
            $.unblockUI();
        });

        function AjaxFailed(response) {
            if (response.d) {
                alert("Güncelleme işlemi başarısızdır.", 'Bilgi');
            }

        }

        function OnSuccess(response) {
            if (response.d) {
                alert("Güncelleme işlemi başarılıdır.", 'Bilgi');
            }

        }
    }); 

[WebMethod]
public string HelloWorld() {
    return "hello";
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T16:37:48.427

你能试试这个吗..

```
 AjaxFailed = function(response) {
        if (response.d) {
            alert("Güncelleme işlemi başarısızdır.", 'Bilgi');
        }

    }

   OnSuccess = function(response) {
        if (response.d) {
            alert("Güncelleme işlemi başarılıdır.", 'Bilgi');
        }

    } 
```

# facebook - 如何使用 Java SDK 中的无摩擦请求功能获得 50 个随机 Facebook 朋友并为我的应用程序发送邀请？

> ID：12041549
> 
> 赞同：0
> 
> 时间：2012-08-20T16:34:29.273
> 
> 标签：facebook, facebook-graph-api, facebook-javascript-sdk, facebook-php-sdk

我需要随机获取 50 个 Facebook 朋友并将结果分配给`user_ids`此函数中使用的变量`sendRequestToRecipients()`。我想要做的就像在这个例子中：

![](../Images/bbf738bd35d48fcb6e0f476f479e9fdb.png)

Stack Overflow 上的所有示例都不起作用，我需要一些帮助才能使此功能正常工作。

这是我的代码：

```
<body>
    <div id="fb-root"></div>
    <script src="http://connect.facebook.net/en_US/all.js"></script>

      <input type="button"
        onclick="sendRequestToRecipients();return false;"
        value="Send Request to Users Directly"/>

    <input type="button"
      onclick="sendRequestViaMultiFriendSelector(); return false;"
      value="Send Request to Many Users with MFS"
    />
    </p>

    <script>
      FB.init({
        appId  : '398994226827517',
        status : true,
        oauth  : true,
        Xfbml  : true,
        cookie : true,
        frictionlessRequests : true
      });

   function sendRequestToRecipients() {
    var user_ids = document.getElementsByName("user_ids")[0].value;
    FB.ui({method: 'apprequests',
      message: 'sample message',
       to: 'user_ids'
    }, requestCallback);
  }

  function sendRequestViaMultiFriendSelector() {
    FB.ui({method: 'apprequests',
      message: 'sample message'
    }, requestCallback);
  }

  function requestCallback(response) {
    // Handle callback here
  }

</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-02T10:25:13.817

批准的消息需要一些更改，如下所示

```
FB.api('/me/friends', function(friend) {
    var user_ids = [];
    $(friend.data).each(function(index, element) {
        user_ids.push(element.id);
    });
  FB.ui({method: 'apprequests',
    message: 'sample message'
    to: user_ids
  });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T14:52:03.143

如前所述，这对用户来说真的很烦人，因为他无法选择他的朋友。

如果你真的想这样做，这应该工作：

```
FB.api('/me/friends', function(friend) {
  FB.ui({method: 'apprequests',
    message: 'Random Friends',
    to: 'friend[0].id,friend[1].id,friend[2].id'
  }, requestCallback);
}); 
```

它将选择前 3 个朋友（不是随机的，但更好）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T18:18:12.110

为什么有人想邀请随机朋友加入应用程序？如果您这样做，您的应用程序可能会因垃圾邮件而迅速关闭。让用户选择他们想邀请谁加入应用程序，不要试图强迫他们向可能对应用程序不感兴趣的随机朋友发送垃圾邮件。

如果您真的必须这样做，您可以根据[请求对话框文档](https://developers.facebook.com/docs/reference/dialogs/requests/)预先填写“to”参数，其中包含您希望应用程序用户向其发送请求的用户的 uid，文档中的示例是：

```
function sendRequestToRecipients() {
  FB.ui({method: 'apprequests',
    message: 'My Great Request',
    to: '499802820,499802852'
  }, requestCallback);
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-03-26T10:55:59.297

PHP：

```
<?php 
 $fql = "SELECT uid FROM user WHERE uid IN (SELECT uid2 FROM friend WHERE uid1=me()) order by rand() limit 20";

 $response = $facebook->api(array(
     'method' => 'fql.query',
     'query' =>$fql,
 ));
 $c="";
 $ids = "";
 foreach ($response as $key => $value) {
   $ids .= $c.$value['uid'];
   =',';
 } ?> 
```

JavaScript：

```
FB.ui({
    method       : 'apprequests',
    title        : '<?php echo $app->title;?>',
    message      : "<?php echo $app->img_description;?>",
    to: "<?php echo $ids;?>"
}, function (data) {}); 
```

# zend-framework - Zend 队列数据库异常

> ID：12041558
> 
> 赞同：0
> 
> 时间：2012-08-20T16:35:15.857
> 
> 标签：zend-framework, zend-db, zend-queue

我在框架外使用 Zend_Queue 和 DB 适配器，我有以下代码：

```
<?php

set_include_path(implode(PATH_SEPARATOR, array(
    realpath('../libs'),
    get_include_path(),
)));

require_once('Zend/Queue/Adapter/Db.php');

$options = array(
    'options' => array(
        'name' => 'myqueue',
        // use Zend_Db_Select for update, not all databases can support this
        // feature.
        Zend_Db_Select::FOR_UPDATE => true
    ),
    'driverOptions' => array(
        'host'      => 'localhost',
        'username'  => 'root',
        'password'  => 'password',
        'dbname'    => 'mydb',
        'type'      => 'pdo_mysql',
    )
);

// Create a database queue.
$queue = new Zend_Queue('Db', $options);

$queue->send('test'); 
```

我进去`'PDOException' with message 'SQLSTATE[HY093]: Invalid parameter number: no parameters were bound'`了`Zend\Db\Statement\Pdo.php:228`

任何想法我做错了什么？

$params 和语句是：

```
array(0) {
}
object(PDOStatement)#11 (1) {
  ["queryString"]=>
  string(67) "SELECT `queue`.`queue_id` FROM `queue` WHERE (queue_name=?) LIMIT 1"
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T20:08:14.010

事实证明 currentQueue 没有设置。您可以使用以下方法进行设置：

```
$queue->setOption($queue::NAME, 'your_queue_name'); 
```

来自 Zend/Queue.php，在 getName() 方法的 doc 块中...

```
 * Note: _setName() used to exist, but it caused confusion with createQueue
 * Will evaluate later to see if we should add it back in. 
```

# html - 响应式布局的固定边距？

> ID：12041560
> 
> 赞同：3
> 
> 时间：2012-08-20T16:35:18.037
> 
> 标签：html, css, responsive-design

简而言之，我正在研究具有列和行的响应式 Web 布局。每个列宽都设置为与预定义的总宽度相关：

> *列宽/总宽度=宽度%*

并且高度是固定的。

现在的问题是，我希望内容宽度是流动的，但边距和填充是固定宽度，如下所示。

![在此处输入图像描述](../Images/e598702d0ee6aeabd2341c748222c801.png)

![在此处输入图像描述](../Images/c2339cd2507d92ac85fafd14e3d3f5b6.png)

代码看起来像这样：

**HTML**

```
<body>
   <div id="left">Left</div>
   <div id="middle">Middle</div>
   <div id="right">Right</div>
</body> 
```

**CSS**

```
div {
   float: left;
   padding: 0.5em;
   box-sizing: border-box;
   width: 33.3333333333333%; height 5em; line-height: 5em; text-align: center;
}    

#left {
   background-color: red;
}

#middle {
   background-color: green;
}

#right {
   background-color: blue;
} 
```

[http://jsfiddle.net/langoon/Zxn8E/2/](http://jsfiddle.net/langoon/Zxn8E/2/)

我想到了一些解决方案，但似乎没有一个能满足我的要求：

1.  **将'box-sizing'设置为'margin-box'。**大多数浏览器不支持。
2.  **使用边框代替边距。**以后我可能想要那个边框并设置不同的样式。
3.  **将每个盒子嵌套在一个外部“div”中。**我更喜欢将要处理的 DOM 的元素数量保持在最低限度。
4.  **按照此处的建议设置负边距** [流体列布局，它们之间有固定的像素边距？](https://stackoverflow.com/questions/11539659/fluid-column-layout-with-fixed-pixel-margins-between-them). 似乎每行都需要一个包装“div”，这可能会给我带来问题。
5.  **JavaScript。**不，谢谢。

*我是想一边吃蛋糕一边吃，还是有办法做到这一点而没有缺点？*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T18:24:38.457

**使用 :before / :after**

我玩得很开心`:before`，`:after`用一个矩形覆盖了每个排水沟的一半：http: [//jsfiddle.net/PhilippeVay/Zxn8E/11/](http://jsfiddle.net/PhilippeVay/Zxn8E/11/)（注意结束标签的位置，以防止内联块元素之间出现任何空格）

兼容性： IE8+ 和 IE7 及更低版本不理解这些伪代码。

**使用灵活的盒子布局模块**

这个 CSS3 模块将让你有等宽的列，里面有排水沟，外面没有，这正是你想要实现的。几个月内语法改变了两次，没有任何问题，我还没有看过新的。
[caniuse.com 上的兼容性](http://caniuse.com/#feat=flexbox)（无 IE9-，无 Opera）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-19T14:50:55.100

我认为解决这个问题的最好方法是使用负边距和[box-sizing](http://caniuse.com/#feat=css3-boxsizing)属性。一个简单的例子：

## HTML：

```
<ul>
    <li><div class="red">Red</div></li>
    <li><div class="green">Green</div></li>
    <li><div class="blue">Blue</div></li>
</ul> 
```

## CSS：

```
ul
{
    list-style: none;
    margin: 0 0 0 -15px; /* Note the negative margin */
    padding: 0;
    overflow: hidden;
}

li
{
    float: left;
    width: 33.3333%;
    padding: 0 0 25px 15px;
    box-sizing: border-box;
}

/* Some decorations */
div { padding: 25px 0; color: white; text-align: center; }
div.red { background: red; }
div.green { background: green; }
div.blue { background: blue; } 
```

## 结果：

![在此处输入图像描述](../Images/5418abfea7d6bda8cf2b0ab1e896a61b.png)

## 现场演示

如果你想看到它的实际效果，我创建了一个[Fiddle](http://jsfiddle.net/MVFx6/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T17:31:33.557

尝试边界路线：

[http://jsfiddle.net/Zxn8E/3/](http://jsfiddle.net/Zxn8E/3/)

```
div {
    float: left;
    box-sizing: border-box;

    border-top:0.5em solid cyan;
    border-bottom:0.5em solid cyan;
    border-left:0.5em solid cyan;

    width: 33.3333333%; height 5em; line-height: 5em; text-align: center;
}    

div.last{ border-right:0.5em solid cyan; } 

<body>
  <div id="left">Left</div>
  <div id="middle">Middle</div>
  <div id="right" class="last">Right</div>
</body> 
```

# r - R：用最近点的值替换 NA

> ID：12041563
> 
> 赞同：6
> 
> 时间：2012-08-20T16:35:22.767
> 
> 标签：r

这是我试图在更大的数据库中解决和实现的问题的示例：

我在新世界中有一个稀疏的点网格，纬度和经度定义如下。

```
LAT<-rep(-5:5*10, 5)
LON<-rep(seq(-140, -60, by=20), each=11) 
```

我知道网格上某些点的颜色

```
COLOR<-(c(NA,NA,NA,"black",NA,NA,NA,NA,NA,"red",NA,NA,"green",NA,"blue","blue",NA,"blue",NA,NA,"yellow",NA,NA,"yellow",NA+
  NA,NA,NA,"blue",NA,NA,NA,NA,NA,NA,NA,"black",NA,"blue","blue",NA,"blue",NA,NA,"yellow",NA,NA,NA,NA,"red",NA,NA,"green",NA,"blue","blue"))
data<-as.data.frame(cbind(LAT,LON,COLOR)) 
```

我想要做的是将 COLOR 中的 NA 值替换为与该点最接近（在距离上）的颜色。在实际实现中，我并不太担心关系，但我认为这是可能的（我可能会手动修复它们）。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-20T17:02:09.220

是的。

首先，让你的数据框`data.frame`或所有东西都被强制转换为字符：

```
data<-data.frame(LAT=LAT,LON=LON,COLOR=COLOR) 
```

拆分数据框 - 您可能可以一次性完成此操作，但这会使事情变得更加明显：

```
query = data[is.na(data$COLOR),]
colours = data[!is.na(data$COLOR),]
library(FNN)
neighs = get.knnx(colours[,c("LAT","LON")],query[,c("LAT","LON")],k=1) 
```

现在将替换颜色直接插入`data`数据框中：

```
data[is.na(data$COLOR),"COLOR"]=colours$COLOR[neighs$nn.index]
plot(data$LON,data$LAT,col=data$COLOR,pch=19) 
```

但是请注意，距离是使用经纬度上的毕达哥拉斯几何计算的，这是不正确的，因为地球并不平坦。您可能必须先将坐标转换为其他坐标。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T17:22:43.850

我想出了这个解决方案，但 Spacedman 的似乎要好得多。请注意，我还假设地球在这里是平的:)

```
# First coerce to numeric from factor:
data$LAT <- as.numeric(as.character(data$LAT))
data$LON <- as.numeric(as.character(data$LON))

n <- nrow(data)

# Compute Euclidean distances:
Dist <- outer(1:n,1:n,function(i,j)sqrt((data$LAT[i]-data$LAT[j])^2 + (data$LON[i]-data$LON[j])^2))

# Dummy second data:
data2 <- data

# Loop over data to fill:
for (i in 1:n)
{
  if (is.na(data$COLOR[i]))
  {
    data$COLOR[i] <- data2$COLOR[order(Dist[i,])[!is.na(data2$COLOR[order(Dist[i,])])][1]]
  }
} 
```

# sql-server - 数据库事务和单独的查询

> ID：12041564
> 
> 赞同：0
> 
> 时间：2012-08-20T16:35:37.427
> 
> 标签：sql-server, transactions

我正在编写一个系统，用于将项目放入玩家的游戏库存中，我想知道单独的查询将如何影响 SQL Server 中正在运行的事务。例如：

1.  开始交易
2.  查询用户的钱及其在游戏中的状态（必须离线）
3.  将一些物品添加到其库存中。
4.  减少它的钱
5.  提交

但是整个游戏服务器有很多单独的查询和子系统，它们可以在没有交易的情况下运行……比如库存、金钱和玩家状态的更新。

交易究竟是如何运作的？我的意思是它就像 C++ 的关键部分一样，您需要一个对象来锁定（在这种情况下是我的过程），还是它也锁定单独的查询？更新时我需要将所有内容放入事务中吗？

由于我是所有与编程相关的自学成才的学习者，因此会遗漏一些东西。对不起。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T17:20:35.110

我理解它的方式，数据库中的事务是单个或一组查询，将以“全有或全无”的方式处理，或者更确切地说，如果其中一个查询不起作用，数据库将回滚到它们发生之前的状态。锁定不一定需要在每个事务期间使用，但在数据库更改至关重要并且应该在任何其他进程或查询有机会更改受锁定影响的数据之前发生时使用。

这里有[一篇文章](http://sqldbpool.com/2008/03/19/transactions-and-locks-in-sql-server/)可以更好地解释这一点：

# javascript - 使用 Uniform / jquery 更改 SELECT 的高度

> ID：12041567
> 
> 赞同：1
> 
> 时间：2012-08-20T16:35:46.293
> 
> 标签：javascript, jquery, html, css

我有这个问题，我想改变一些选择下拉列表框的高度。

目前这就是它们的样子 [http://i46.tinypic.com/2qstseo.gif](http://i46.tinypic.com/2qstseo.gif)

我希望他们更高，也更靠近。我不知道这是否可以使用 Uniform，但这是我的代码：

```
#uniform-resize span
{
    width:120px;
    height:60px;

} 
```

这是选择之一（它们非常大）：

```
<select id="resize">
    <option>January</option>
    <option>February</option>
    <option>March</option>
    <option>April</option>
    <option>May</option>
    <option>June</option>
    <option>July</option>
    <option>August</option>
    <option>September</option>
    <option>October</option>
    <option>November</option>
    <option>December</option>
</select> 
```

有任何想法吗？显然 height:60px; 不起作用。

非常感谢大家的支持，如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T15:52:58.403

你可以进去`uniform.default.css`修改一些部分，比如这个部分：

```
div.selector select {
  min-width: 190px;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 12px;
  border: solid 1px #fff;
} 
```

或者你可以尝试添加`!important`

```
#resize
{
    width:120px !important;
    height:60px !important;
} 
```

**编辑**： Uniform.js 正在使用这个精灵：[http](http://uniformjs.com/images/sprite.png) ://uniformjs.com/images/sprite.png所以我怀疑你真的可以改变选择元素的高度。

**编辑**：更改宽度：

```
.selector span{width:auto !important}
.selector select{width:auto !important}
.selector{width:auto !important} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T12:39:04.660

您需要编辑精灵图像或完全使用另一张图像（使用相同的布局），然后您需要覆盖 Uniform 的所有相关 CSS 部分，即具有此精灵图像位置和字体声明的那些部分。查看 Uniform 的其他主题 - 应有尽有。

顺便说一句：为了避免你以后的头疼，不要使用！important，而是干净地覆盖现有的 CSS 规则。在 uniform.default.css 之后加载的 CSS 文件中执行此操作，不要直接与 Uniform 的文件混淆！

# c# - 如何硬编码 WCF 客户端的默认设置（在类库中）

> ID：12041569
> 
> 赞同：0
> 
> 时间：2012-08-20T16:35:57.303
> 
> 标签：c#, visual-studio-2010, wcf

是否有一种简单的方法来硬编码设置并仅在引用类库的应用程序在其 app.config 中没有服务模型设置时应用它们？

从类库调用代码的客户端代码将是这样的：

```
ProgramUpdater programUpdater = new ProgramUpdater(@"path\\to\\my\\program"); 
if(programUpdater.HasUpdate()) 
{
    programUpdater.Update();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T16:58:02.813

实际上，当我在 Google 上进行一些额外搜索时，我认为我在一个问题中找到了一些合适的答案。

有趣的是，它没有出现在我最初的搜索中。

这是供将来参考：

[如何硬编码服务的默认 WCF 端点？](https://stackoverflow.com/questions/5584299/how-to-hard-code-a-default-wcf-endpoint-for-a-service)

# objective-c - 使 UIMenuController 不可选择

> ID：12041576
> 
> 赞同：2
> 
> 时间：2012-08-20T16:36:29.947
> 
> 标签：objective-c, ios, uimenucontroller

我正在开发一个 iPhone 应用程序，我想使用工具提示。我在过去看到过一些关于 iOS 工具提示的问题（[比如这个](https://stackoverflow.com/q/9731371)），其中解决方案是使用可可控件中的某些东西，但我试图避免我没有编写或不理解的代码。

苹果通过长按在他们的音乐应用程序中完成了我想要做的事情：

![愚蠢的朋克似乎不太可能让我对 SO 大发雷霆](../Images/3f2e436ca7e033c0d0c4be49d24cdeaa.png)

对我来说，这看起来很像 UIMenuController。已经[回答](https://stackoverflow.com/a/4079896)了设置 UIMenuController 的自定义文本。如何阻止弹出窗口被选中？我在想苹果只是拦截触摸事件并解雇它。也就是说，我不知道他们是怎么做到的。

目前，我让菜单项可选择的操作是一个空白方法，如下所示：

```
UIMenuItem *moreInfo = [[UIMenuItem alloc] initWithTitle:text
                                                  action:@selector(doNothing)]; 
```

有没有人对如何：

*   拦截触摸事件以防止选择
*   通过完全不同的方式实现这一目标

谢谢

# gitolite - gitweb 404 - 未找到项目

> ID：12041578
> 
> 赞同：1
> 
> 时间：2012-08-20T16:36:34.440
> 
> 标签：gitolite

我在 Ubuntu 12.04 服务器上安装了 git + gitolite + git-daemon + gitweb setup。问题是我总是得到 404 - 找不到项目。我添加了一个名为 git 的用户并配置了 gitolite。安装 git-web 后，将用户 www-data 添加到 gitolite 并将 project.list 的 chmod 设置为 g+r 并将存储库目录设置为 g+rx。

```
git@aranox~$ ls -al
total 44
drwxr-xr-x  6 git  git  4096 Aug 20 16:47 .
drwxr-xr-x 18 root root 4096 Aug 13 19:44 ..
-rw-------  1 git  git  1348 Aug 20 16:48 .bash_history
drwx------  2 git  git  4096 Aug 19 16:38 .cache
drwx------  8 git  git  4096 Aug 19 16:30 .gitolite
-rw-r--r--  1 git  git  4217 Aug 20 16:03 .gitolite.rc
-rw-r-----  1 git  git     0 Aug 20 16:05 projects.list
drwxr-x---  5 git  git  4096 Aug 19 16:49 repositories
drwx------  2 git  git  4096 Aug 20 16:05 .ssh
-rw-------  1 git  git   887 Aug 20 16:03 .viminfo 
```

现在我将 .gitolite.rc 中的 $REPO_UMASK 更改为 0077 这里我的 .gitolite.rc

```
# configuration variables for gitolite

# PLEASE READ THE DOCUMENTATION BEFORE EDITING OR ASKING QUESTIONS
# ( http://github.com/sitaramc/gitolite/blob/pu/doc/gitolite.rc.mkd )
#   ( or http://sitaramc.github.com/gitolite/doc/gitolite.rc.html )

# this file is in perl syntax.  However, you do NOT need to know perl to edit
# it; it should be fairly self-explanatory and easy to maintain

# ------------------------------------------------------------------------------
# DO NOT TOUCH THIS SECTION!
# ------------------------------------------------------------------------------

$GL_ADMINDIR=$ENV{HOME} . "/.gitolite";
$GL_CONF="$GL_ADMINDIR/conf/gitolite.conf";
$GL_KEYDIR="$GL_ADMINDIR/keydir";
$GL_CONF_COMPILED="$GL_ADMINDIR/conf/gitolite.conf-compiled.pm";

# DO NOT CHANGE THE NEXT FOUR LINES UNLESS YOU REALLY KNOW WHAT YOU'RE DOING.
# These variables are set automatically by the install method you choose.
#            (PACKAGE MAINTAINERS: PLEASE READ doc/packaging.mkd)
$GL_PACKAGE_CONF = "/usr/share/gitolite/conf";
$GL_PACKAGE_HOOKS = "/usr/share/gitolite/hooks";

# ------------------------------------------------------------------------------
# most often used/changed variables
# ------------------------------------------------------------------------------
$GL_WILDREPOS = 0;
$PROJECTS_LIST = $ENV{HOME} . "/projects.list";
# $WEB_INTERFACE = "gitweb";
# $GITWEB_URI_ESCAPE = 0;
$REPO_UMASK = 0027;

# ------------------------------------------------------------------------------
# variables with an efficiency/performance impact
# ------------------------------------------------------------------------------
$GL_BIG_CONFIG = 0;
$GL_NO_DAEMON_NO_GITWEB = 0;
# $GL_NICE_VALUE = 0;
# $BIG_INFO_CAP = 20;

# ------------------------------------------------------------------------------
# VARIABLES WITH A SECURITY IMPACT.  READ DOCS BEFORE CHANGING THESE!
# http://github.com/sitaramc/gitolite/blob/pu/doc/gitolite.rc.mkd#_variables_with_a_security_impact
# (or http://sitaramc.github.com/gitolite/doc/gitolite.rc.html#_variables_with_a_security_impact)
# ------------------------------------------------------------------------------
# $GL_ALL_READ_ALL = 0;
$GIT_PATH="";
$GL_GITCONFIG_KEYS = "";
$GL_NO_CREATE_REPOS = 0;
$GL_NO_SETUP_AUTHKEYS = 0;
# $GL_WILDREPOS_DEFPERMS = 'R @all';
$HTPASSWD_FILE = "";
$RSYNC_BASE = "";
$SVNSERVE = "";

# $UPDATE_CHAINS_TO = "hooks/update.secondary";
# $ADMIN_POST_UPDATE_CHAINS_TO = "hooks/post-update.secondary";
# $GL_ADC_PATH = "";
# $GL_GET_MEMBERSHIPS_PGM = "/usr/local/bin/expand-ldap-user-to-groups"
# $GL_HTTP_ANON_USER = "mob";
# $GL_REF_OR_FILENAME_PATT=qr(^[0-9a-zA-Z][0-9a-zA-Z._\@/+ :,-]*$);

# ------------------------------------------------------------------------------
# less used/changed variables
# ------------------------------------------------------------------------------
# $GL_ALL_INCLUDES_SPECIAL = 0;
# $GL_SLAVE_MODE = 0;
# $ENV{GL_SLAVES} = 'gitolite@server2 gitolite@server3';
# PLEASE USE SINGLE QUOTES ABOVE, NOT DOUBLE QUOTES
$GL_WILDREPOS_PERM_CATS = "READERS WRITERS";
# $GL_SITE_INFO = "XYZ.COM DEVELOPERS: PLEASE SEE http://xyz.com/gitolite/help first";
# $GL_HOSTNAME = "frodo";       # read doc/mirroring.mkd COMPLETELY before setting this

# ------------------------------------------------------------------------------
# rarely changed variables
# ------------------------------------------------------------------------------
$GL_LOGT="$GL_ADMINDIR/logs/gitolite-%y-%m.log";
# $GL_PERFLOGT="$GL_ADMINDIR/logs/perf-gitolite-%y-%m.log";

# ------------------------------------------------------------------------------
# variables that should NOT be changed after the install step completes
# ------------------------------------------------------------------------------
$REPO_BASE="repositories";

# ------------------------------------------------------------------------------
# DO NOT TOUCH ANY THING AFTER THIS LINE
# ------------------------------------------------------------------------------

# ------------------------------------------------------------------------------
# per perl rules, this should be the last line in such a file:
1;

# Local variables:
# mode: perl
# End:
# vim: set syn=perl: 
```

接下来更改了我的 /etc/gitweb.conf 的 $projectroot 和 $projects_list 并添加了一些配置。这是我的 gitweb.conf

```
# path to git projects (<project>.git)
$projectroot = "/home/git/repositories";

# directory to use for temp files
$git_temp = "/tmp";

# target of the home link on top of all pages
#$home_link = $my_uri || "/";

# html text to include at home page
#$home_text = "indextext.html";

# file with project list; by default, simply scan the projectroot dir.
$projects_list = "/home/git/projects.list";

# stylesheet to use
#@stylesheets = ("static/gitweb.css");

# javascript code for gitweb
#$javascript = "static/gitweb.js";

# logo to use
#$logo = "static/git-logo.png";

# the 'favicon'
#$favicon = "static/git-favicon.png";

# git-diff-tree(1) options to use for generated patches
#@diff_opts = ("-M");
@diff_opts = ();

# Enable PATH_INFO so the server can produce URLs of the
# form: http://git.cdwilson.us/project.git/xxx/xxx
# This allows for pretty URLs *within* the Git repository, where
# my Apache rewrite rules are not active.
$feature{'pathinfo'}{'default'} = [1];

$projects_list_description_width = 100;

# Enable blame, pickaxe search, snapshop, search, and grep
# support, but still allow individual projects to turn them off.
# These are features that users can use to interact with your Git trees. They
# consume some CPU whenever a user uses them, so you can turn them off if you
# need to. Note that the 'override' option means that you can override the
# setting on a per-repository basis.
$feature{'blame'}{'default'} = [1];
$feature{'blame'}{'override'} = 1;

$feature{'pickaxe'}{'default'} = [1];
$feature{'pickaxe'}{'override'} = 1;

$feature{'snapshot'}{'default'} = [1];
$feature{'snapshot'}{'override'} = 1;

$feature{'search'}{'default'} = [1];

$feature{'grep'}{'default'} = [1];
$feature{'grep'}{'override'} = 1;

$feature{'show-sizes'}{'default'} = [1];
$feature{'show-sizes'}{'override'} = 1;

$feature{'avatar'}{'default'} = ['gravatar'];
$feature{'avatar'}{'override'} = 1;

$feature{'highlight'}{'default'} = [1];
$feature{'highlight'}{'override'} = 1; 
```

最后在我的 apache 上创建了一个新的 vhost 条目

```
<VirtualHost 88.198.64.228:80>
        ServerName git.aranox.de
        ServerAlias www.git.aranox.de
        DocumentRoot /usr/share/gitweb
        ErrorLog /var/log/vhosts/git.aranox.de_error_log
        CustomLog /var/log/vhosts/git.aranox.de_access_log combined
        <Directory /usr/share/gitweb>
                Options +Indexes +ExecCGI +FollowSymLinks
                AllowOverride All
                Order allow,deny
                Allow from all
                AddHandler cgi-script .cgi
                DirectoryIndex gitweb.cgi
                RewriteEngine On
                RewriteCond %{REQUEST_FILENAME} !-f
                RewriteCond %{REQUEST_FILENAME} !-d
                RewriteRule ^.* /index.cgi/$0 [L,PT]
        </Directory>
</VirtualHost> 
```

我重新启动了 apache2 并且看起来不错，但仍然出现“未找到项目”错误。我使用谷歌并在stackoverflow上搜索，但仍然没有找到解决方案。一直以来我发现权限是错误的，但我可能会像这样。

感谢您提供任何解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T18:51:58.580

正如[OP Zack](https://stackoverflow.com/users/1029598/zack)提到的，`gitolite`将使用该`project.list`文件（也由 使用`gitweb`）以了解要解析的项目列表。

> 我的`projects.list`是空的。不知道为什么。
> 我手动添加了存储库，一切都很好。

这类似于这个问题“ [Gitweb document root with gitolite](https://serverfault.com/questions/419102/gitweb-document-root-with-gitolite) ”，在其中添加`project.list`也足够了。

* * *

原答案：

这里没有任何东西直接调用 gitolite，并且该`gitolite.rc`文件是 g2 (gitolite V2) 文件，而不是[g3 one](https://github.com/sitaramc/gitolite/blob/master/src/lib/Gitolite/Rc.pm#L308)。

因此，首先，请确保安装最新的 gitolite V3（[例如，请参阅此安装脚本](https://github.com/VonC/compileEverything/blob/master/gitolite/install_or_update_gitolite.sh)）。

其次，此设置不需要 git-daemon：只需要一个调用`gitweb.cgi`脚本的 Apache 服务器：请参阅[此`httpd.conf`配置文件](https://github.com/VonC/compileEverything/blob/master/apache/env.conf.tpl#L49-78)，摘录如下：

```
# GitWeb on @PORT_HTTP_GITWEB@
Listen @PORT_HTTP_GITWEB@
<VirtualHost @FQN@:@PORT_HTTP_GITWEB@>
ServerName @FQN@
ServerAlias @HOSTNAME@
SetEnv GIT_HTTP_BACKEND "@H@/usr/local/apps/git/libexec/git-core/git-http-backend"
DocumentRoot @H@/gitweb
Alias /git @H@/gitweb

<Directory @H@/gitweb>
  AddHandler cgi-script cgi
  DirectoryIndex gitweb.cgi 
```

gitweb 和 gitolite 之间的链接是通过一个 gitweb 钩子建立的：如果 gitweb 检测到存在一个`gitweb_config.perl`（比如[这个](https://github.com/VonC/compileEverything/blob/master/gitweb/gitweb_config.perl)），就在其他 gitweb 文件中，它会调用它。反过来，我让它调用一个[`gitweb.conf.pl`文件](https://github.com/VonC/compileEverything/blob/master/gitweb/gitweb.conf.pl.tpl)，其中包含一个名为函数的文件`export_auth_hook`，这是一个由 gitweb 调用的钩子（同样，如果它存在）。

```
$export_auth_hook = sub {
  my $repo = shift;
  my $user = $ENV{GL_USER};
  # gitweb passes us the full repo path; so we strip the beginning
  # and the end, to get the repo name as it is specified in gitolite conf
  return unless $repo =~ s/^\Q$projectroot\E\/?(.+)\.git$/$1/;

  # check for (at least) "R" permission
  my $ret = &access( $repo, $user, 'R', 'any' );
  my $res = $ret !~ /DENIED/;
  return ($ret !~ /DENIED/);
}; 
```

就是这样：根据 gitolite 配置，您的 gitweb 足以显示您可以访问的项目。
然而，这不是克隆/推送或提取 git repo 的方法，正如我在“ [Missing repos in gitweb](https://serverfault.com/a/419187/783) ”中解释的那样。

# java - 禁用webview输入字段重复java

> ID：12041582
> 
> 赞同：2
> 
> 时间：2012-08-20T16:36:45.270
> 
> 标签：java, android, html, cordova, webview

由于不同设备的性质，Android 似乎在当前焦点上添加了重复输入，css hack 似乎在某些设备上修复了它们，而不是在其他设备上，是否有一种方法可以通过 java 附加以阻止它添加本机html文档中的输入字段？

这似乎是确切的问题：

[禁用 Android 浏览器的输入覆盖？](https://stackoverflow.com/questions/9423101/disable-android-browsers-input-overlays)

然而，css 修复程序并不适用于所有设备......

# javascript - JavaScript：正则表达式 index.html 出 URL

> ID：12041585
> 
> 赞同：0
> 
> 时间：2012-08-20T16:37:19.250
> 
> 标签：javascript, regex

如何去除一组 URL 中的 index.html 部分，例如

```
http://google.de/test/images/index.html
http://google.de/test1/green/hot/greetings/index.html 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T16:38:23.857

为什么是正则表达式？只是`theUrl.replace('index.html','');`会做，不是吗？

如果您输入的子字符串多次出现，那么执行`theInput.split('index.html').join('');`. 当然，如果您的源字符串只包含两个或三个匹配项，则可以使用正则表达式：

```
theInput.replace(/index\.html/g,''); 
```

标志在哪里，意味着`g`所有匹配*项*都将被替换`global`

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T16:38:11.270

```
var i = url.lastIndexOf("/");
alert(url.substring(0, i)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T16:42:08.353

我不认为正则表达式是正确的工具。但是，如果您坚持，regex 当然可以做到这一点。像这样的东西适用于匹配：

```
/(index\.[^./?&#]+(?:$|[?&#])) 
```

将其替换为`\1`，您应该会很好。非常奇怪的文件扩展名可能有点问题，但我想不出任何问题。*

# php - 使用 PHP、mySQL 和 PDO 进行 LIKE 查询

> ID：12041589
> 
> 赞同：1
> 
> 时间：2012-08-20T16:37:33.280
> 
> 标签：php, mysql, pdo, backslash, apostrophe

我想`\'`在 MySQL 数据库中的表中匹配我的列，因为这些是数据未正确转义的条目。

我将 PHP 与 PDO 一起使用，这是相关代码：

```
$stmt = $db->prepare("SELECT * FROM table WHERE title LIKE :title");
$stmt->bindValue(':title',"%\\'%",PDO::PARAM_STR); 
```

问题是，这将标题与`\'`单个 '. 我尝试了等的各种组合`\\\\\'`，但没有什么能真正起到 match`\'`的作用，而不是 single `'`。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T18:13:46.277

事实证明，您实际上需要这样做：

```
$stmt->bindValue(':title',"%\\\\\\'%",PDO::PARAM_STR); 
```

那是 6 个反斜杠和一个撇号，然后匹配一个反斜杠和一个撇号。有人对此有解释吗？

PS：我不知道为什么以前只添加反斜杠不起作用，我试过了，好像我有双引号之类的。

# php - 无需重新加载页面即可更新帖子

> ID：12041590
> 
> 赞同：0
> 
> 时间：2012-08-20T16:37:37.840
> 
> 标签：php, mysql, ajax

我必须使用 php、MySql、javascript 或 jQuery 发布应用程序。我知道如何使用 ajax 将数据发送到数据库（无需重新加载页面），但我很感兴趣是否有人发布了一些如何为其他客户所知的内容（也无需重新加载页面）添加了一些数据。对于更简单的情况，例如在 stackoverflow 上，当添加了一些问题并写成`N question with new activity`. 我认为这个问题与 MySql 触发器有一些联系，但我不知道如何将触发器连接到 php。有任何有用的建议都会很满意，在此先感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T22:25:54.153

与 Mysql 对话的唯一层是 PHP。

PHP 在服务器端呈现。所以一旦在客户端，只有 HTML 和 JavaScript。这意味着如果你将使用 Mysql 触发器，它只会完成一半。

客户端/服务器端更有趣。正如上面评论中所回答的，COMET 是用于实现“实时更新”的技术的总称。[Stackoverflow 使用 web-sockets](https://meta.stackexchange.com/questions/125677/new-feature-real-time-updates-to-questions-answers-and-inbox)。

看到他们的最后一行说

```
Now for the gotchas - in order to use this feature you must have a browser that supports web sockets. 
```

对于服务器端，不需要使用 Mysql 触发器。不依赖于数据库实现的解决方案会好得多。一个简单的订阅/发布设计模式会很好。

# c# - 从 C# 显示关机对话框

> ID：12041592
> 
> 赞同：2
> 
> 时间：2012-08-20T16:37:39.890
> 
> 标签：c#, windows-8, system-shutdown

有没有办法从 c# 显示 Windows 关闭对话框？

![关机对话框](../Images/02657a13401af3dda9c58505c1fc267a.png)

我找到了一个可以与 System.Diagnostic.Process.Start 一起使用的命令

```
taskkill /im explorer.exe 
```

但不适用于 Windows 8

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T16:40:53.497

您可以使用[shutdown.exe](http://technet.microsoft.com/en-us/library/bb491003.aspx)而不是试图杀死资源管理器。：

```
shutdown.exe /i /t 0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T16:43:39.320

我没有尝试从 C# 进程中调用它，但`shutdown /i`为我在 Windows 8 上拉了一个 GUI。请注意，它不是相同的 UI。

# gwt - 替换 Gwt 单元表

> ID：12041593
> 
> 赞同：1
> 
> 时间：2012-08-20T16:37:40.187
> 
> 标签：gwt

我在网格中使用 GWT 单元表来维护数据行，我也需要在同一行中的列和其他行之间进行一些事件

例如：

如果我从第一列的组合框中选择了一些值，我需要禁用最后一列中的文本框。

我尝试了很多方法，但未能将这些列连接起来。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T18:21:50.023

CellTable 对于这些类型的交互非常尴尬。您必须在任何时候想要更改任何单元格时重新绘制整个表格。

所以：当第一个单元格发生变化时，更新第二个单元格的状态，并重新绘制表格。

如果可能，请为此界面使用除 CellTable 之外的其他东西，例如 Grid 或 FlexTable。

# ms-access - 打开表格，保存并在访问中立即关闭

> ID：12041596
> 
> 赞同：1
> 
> 时间：2012-08-20T16:38:08.337
> 
> 标签：ms-access

我试图设置一个表单，以便当我在一个表单中填写 ID 字段时，它会立即将记录保存在另一个表单中。

如果它打开保存并谨慎关闭，那就太好了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T18:32:08.073

如果您有第二种形式的代码，您可以从 VBA 代码中引用它，例如：

`Form_MyFormName.Visible = False`

此行将创建一个不可见的表单实例，然后您可以使用它来执行您需要的任何任务。然后像这样关闭表单：

`DoCmd.Close AcForm, "MyFormName"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T17:37:26.487

我相信您可以做到这一点 - Access 中的每个对象都可以在代码中引用，因此您可以使用 VBA 中的表单名称来调用它，执行与原始表单相关的必要更改，调用保存调用的表单，然后关闭。当然，如果主要表单依赖于您可以在次要表单中更改的数据 - 您将需要在次要表单更改之前和之后调用保存主要表单。

对通用答案感到抱歉，您在表单名称、字段名称等方面确实没有给我们太多帮助。但这个概念应该是合理的。

# c - GLUT 动画与 glTimerFunc

> ID：12041605
> 
> 赞同：1
> 
> 时间：2012-08-20T16:38:32.813
> 
> 标签：c, opengl, freeglut

我一直在用 freeglut（在虚拟机中的 Linux 上）尝试一些简单的绘图和动画。到现在为止，所有构建和工作的东西都很好。我最近的尝试是用`glTimerFunc`. 虽然它构建时没有任何错误`gcc stack.c -lGL -lglut -o stack`，但动画本身不起作用。我已经查看了我能找到的每个带有 glut 的动画示例，但没有发现我的代码有任何问题。谁能向我解释我的错误是什么？

（编辑：工作代码见下文）

```
#include <stdio.h>
#include <stdlib.h>
#include <GL/freeglut.h>

int dx = 0;

#define TIMERSECS 100

void animate(int value) {
  glutTimerFunc(TIMERSECS, animate, 1);
  if (dx > 0.5) {
    dx = -0.5;
  }
  else {
    dx += 0.1;
  }
  glutPostRedisplay();
}

void display(void) {
  glClear(GL_COLOR_BUFFER_BIT);

  glColor3f(0.0, 0.0, 0.5);

  glBegin(GL_POLYGON);
    glVertex2d(-0.5+dx, 0.5);
    glVertex2d(-0.5+dx, -0.5);
    glVertex2d(0.5+dx, -0.5);
    glVertex2d(0.5+dx, 0.5);
  glEnd();

  glutSwapBuffers();
}

void initialize(void) {
  glClearColor(1.0, 1.0, 1.0, 1.0);
  glShadeModel(GL_SMOOTH);
}

void main(int argc, char *argv[]) {

  glutInit(&argc, argv);
  glutInitWindowPosition(100, 100);
  glutInitWindowSize(500, 500);

  glutInitDisplayMode(GLUT_RGBA | GLUT_DOUBLE);
  glutCreateWindow(argv[0]);

  initialize();
  glutDisplayFunc(display);
  glutTimerFunc(TIMERSECS, animate, 0);
  glutPostRedisplay();

  glutMainLoop();
} 
```

编辑

@datenwolf：我查看了您这次更仔细地回答的[另一个问题，并从那里获取了一些代码，效果很好！](https://stackoverflow.com/questions/11072951/simple-2d-animation-in-glut)

这是新版本：

```
#include <stdio.h>
#include <stdlib.h>
#include <GL/freeglut.h>

int factor=100; // factor the animation is slowed down by

double dx = 0;

void animate(double speed);

static double ftime(void) {
    struct timeval t;
    gettimeofday(&t, NULL);

    return 1.0*t.tv_sec + 1e-6*t.tv_usec;
}

static double last_T;

static void idle(void) {
  const double now_T = ftime();
  const double delta_T = now_T - last_T;
  last_T = now_T;

  const double speed = delta_T * 60;

  animate(speed);

  glutPostRedisplay();
}

void animate(double speed) {
  if (dx > 1.5) {
    dx = -1.5;
  }
  else {
    dx += speed/factor;
  }
  glutPostRedisplay();
}

void display(void) {
  glClear(GL_COLOR_BUFFER_BIT);

  glColor3f(0.0, 0.0, 0.5);

  glBegin(GL_POLYGON);
    glVertex2d(-0.5+dx, 0.5);
    glVertex2d(-0.5+dx, -0.5);
    glVertex2d(0.5+dx, -0.5);
    glVertex2d(0.5+dx, 0.5);
  glEnd();

  glutSwapBuffers();
}

void initialize(void) {
  glClearColor(1.0, 1.0, 1.0, 1.0);
  glShadeModel(GL_SMOOTH);
}

void main(int argc, char *argv[]) {

  glutInit(&argc, argv);
  glutInitWindowPosition(100, 100);
  glutInitWindowSize(500, 500);

  glutInitDisplayMode(GLUT_RGBA | GLUT_DOUBLE);
  glutCreateWindow(argv[0]);

  initialize();
  glutDisplayFunc(display);
  glutIdleFunc(idle);
  glutPostRedisplay();

  glutMainLoop();
} 
```

Dankeschön für deine Hilfe！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T16:59:47.457

您不应将事件计时器用于动画。相反，您应该从空闲函数调用 glutPostDisplay 并测量调用显示函数之间的时间，并以此为基础动画时间。

# c# - 为什么我的属性的访问器被忽略？

> ID：12041611
> 
> 赞同：0
> 
> 时间：2012-08-20T16:39:00.193
> 
> 标签：c#, properties, getter

我已经声明了一个这样的属性：

```
private int? platypusLocalId;

public int? PlatypusLocalId
{
    get
    {
        return GetPlatypusLocalIDForPlatypusID(platypusID);
    }
} 
```

...期待任何对 platypusLocalId 的引用，例如：

```
Dictionary<int, string> duckBillPairs = GetAvailableDuckBillsForPlatypus(platypusLocalId); 
```

...调用访问者/获取者；但是，它没有被调用，因此当传递给 GetAvailableDuckBillsForPlatypus() 时 platypusLocalId 为空。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T16:40:41.703

检查您的情况 - 您正在`platypusLocalId`直接访问该字段，而不是该 property `PlatypusLocalId`。该字段将为空，因为您尚未分配它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-20T16:41:20.603

任何对 PlatypusLocalId 的引用都会调用 getter。但是，您使用的是 platypusLocalId（注意小写的 p），这意味着您正在直接访问私有字段。

属性不仅仅是神奇地使用 - 你必须调用它们！

# c++ - 在 VTable 的上下文中，虚拟方法调用和直接方法调用有什么区别？

> ID：12041614
> 
> 赞同：2
> 
> 时间：2012-08-20T16:39:06.047
> 
> 标签：c++

在 VTable 的上下文中，虚拟方法调用和直接方法调用有什么区别？在虚拟和直接调用的情况下如何解决方法参考？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T16:51:12.573

理论上，不存在这样的东西，C++ 标准没有定义它（定义了虚拟调用，但没有指定它们必须如何工作，不存在 VTable 这样的东西）。

实际上，虚拟调用*确实*在我所知道的每个编译器上都使用了一个 vtable。这是每个具有虚拟成员（每个类，**而不是**每个实例！）的类的一个地址表和每个实例一个指向该表的指针的内存开销。
虚拟调用——取决于架构——要么是从该表加载，然后是对加载地址的调用，要么是所谓的间接调用（这是相同的，但在一条指令中）。

直接调用只是对编译器知道的地址的普通函数调用（单指令）（共享库调用存在一些例外，它也可能使用间接甚至双重间接调用）。每当编译器 100% 确定对象的运行时类型时，或者当您通过范围解析 ( `operator::`) 明确告诉它时，这就是所使用的。

传统上，直接调用和间接调用之间的最大区别在于分支预测和流水线，这使得间接调用*更加*昂贵（10-15 倍），但最近的 CPU 在这两种情况下都同样出色地实现了这一点（现代 CPU 上有一个专用的间接调用缓存） CPU）。
我不会说差异不存在或可以忽略不计，但现在肯定不是什么大问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T16:46:52.940

定义了虚方法的类将向该类添加一个隐藏指针成员。指针指向所谓的 V 表，它是对应于类的虚方法的函数指针块。

从具有虚拟方法的类派生的每个类都继承此隐藏指针成员。但是，此外，每个这样的类都有自己的 V-table。因此，派生类的实例化会将这个指针初始化为它自己的 V 表。

这样，当使用虚方法调用基类上的虚方法时，当它查询 V 表指针时，该指针实际上指向派生类的表，这就是从基类调用虚方法实际上会调用派生类的实现。因此，当遇到虚拟方法时，编译器会使用此代码解析调用，该代码通过 V 表指针进行查找。

直接方法调用没有 V 表查找代码。编译器只需将调用解析为对应于方法的函数地址。

# sql-server - EF 与 NHibernate 与 Oracle

> ID：12041616
> 
> 赞同：0
> 
> 时间：2012-08-20T16:39:07.997
> 
> 标签：sql-server, oracle, entity-framework, nhibernate, orm

这不是另一个“圣战”问题。它是具体的，绝对可以回答的。

这个问题的基本假设是 NHibernate 和 Entity Framework 4.3 Code First 都不能很好地与 MS SQL SERVER 一起工作。

我注意到人们在将 Entity Framework 4.3 Code First 与 Oracle RDBMS 结合使用时遇到了问题。存在几个基本问​​题，并且尚无法实现无缝集成。

NHibernate 也是如此，或者当我使用 NHibernate 作为我的 ORM 框架时，我是否能够无缝地在 MS SQL 和 Oracle 数据提供程序之间切换？

更新：其他人在使用 EF 和 Oracle 时遇到的问题来自[这个](https://stackoverflow.com/questions/9871879/entity-framework-code-first-for-oracle)问题的答案。特别是该用户的问题尚未解决： [Oracle ODP.Net and EF CodeFirst - SaveChanges Error](https://stackoverflow.com/questions/9930487/oracle-odp-net-and-ef-codefirst-savechanges-error)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T21:22:47.100

切换数据库从来都不是 100% 无缝的。NH 更成熟，并且在 RDBMS 中工作得更好，但切换的复杂性取决于您如何使用它。

[请参阅我对使用 NHibernate 在同一 ASP.NET 应用程序中同时支持 Oracle 和 SQL Server 的建议的](https://stackoverflow.com/a/2626552/62024)回答

# git - 如何从 Git 存储库中删除文件，包括历史记录和以下重命名？

> ID：12041621
> 
> 赞同：3
> 
> 时间：2012-08-20T16:39:27.123
> 
> 标签：git

[这个问题与这个](https://stackoverflow.com/questions/2730411/git-remove-file-from-the-repository)问题非常相似，但需要注意的是我需要删除该文件的所有先前版本，包括重命名的版本。基本上我正在寻找在[这里找到](https://help.github.com/articles/remove-sensitive-data)的解决方案，但包括可能 6 个月前我将“Rakefile_test”重命名为“Rakefile”，并且“Rakefile_test”也必须从 Git 历史记录中删除。

澄清一下：我不知道哪些文件已被重命名或它们的旧名称是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T16:45:20.563

只需删除这两个文件（假设在重命名之前没有同名的*不同文件）：*

```
git filter-branch --index-filter 'git rm --cached --ignore-unmatch Rakefile Rakefile_test' \
  --prune-empty --tag-name-filter cat -- --all 
```

# oledb - VB.net SQL.ExecuteNonQuery

> ID：12041622
> 
> 赞同：0
> 
> 时间：2012-08-20T16:39:30.737
> 
> 标签：oledb, execute, oledbconnection

目前我正在尝试将以下内容更新到数据库中，但是它返回了以下错误消息：

> 没有为一个或多个必需参数指定值。<

但是我没有设置任何参数，所以不确定为什么我需要设置这个：

```
 Public Sub PerformUpdates()

    'Connect to Commands DB
    Dim UpdateConn = New OleDb.OleDbConnection(Conn_string)
    UpdateConn.Open()

    Dim UpdateSQL As String = ""
    'Try
    For Each Elm As TableCommands In CommandArray

        If (Elm.ID > 0) Then
            UpdateSQL = "UPDATE tblCommands " & _
                        "SET LastCountValue='100'" & _
                        " WHERE Table_Name='dbo_AgentScore'"

            Dim sql As New OleDb.OleDbCommand(UpdateSQL, UpdateConn)
            Dim i As Integer = sql.ExecuteNonQuery

        End If
    Next
    'End Try

End Sub 
```

任何人都可以在上面我出错的地方提供帮助吗？

非常感谢，

大卫奥康纳

# javascript - 未在 dojo 中以编程方式创建按钮

> ID：12041624
> 
> 赞同：0
> 
> 时间：2012-08-20T16:39:42.890
> 
> 标签：javascript, button, dojo

我正在使用 dojo 版本 1.6.1 并尝试创建一个按钮。但是，当我以编程方式创建按钮时，它不会正确显示。它给了我一个要点，然后是按钮的标签，然后是一个小按钮（奇怪！）。现在我是 dojo 的新手，我确信我错过了一些非常基本的东西。这是我的按钮代码： cript> dojo.require("dijit.dijit"); dojo.require("dijit.form.Button");

```
dojo.addOnLoad(function() {
    var button = new dijit.form.Button({
        label: "Click Me!"},"buttonNode");  
        button.startup();
}); 
```

我认为值得一提的是，萤火虫没有显示任何错误！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T22:35:49.883

由于 Dojo 显然在解析您的文档（它正在用许多时髦的 HTML 替换您的 <button>），听起来您只是忘记包含 CSS，或者在您的 body 标签（或包含按钮）。

首先确保你已经包含了一个主题，比如：

```
<style type="text/css">
    @import url("your_dojo_path/dijit/themes/claro/claro.css");
</style> 
```

和（因为我在这里使用 claro 主题）：

```
<body class="claro">...</body> 
```

# lotus-notes - 如何在按钮上的图标和标签之间获得空间？

> ID：12041625
> 
> 赞同：1
> 
> 时间：2012-08-20T16:39:49.257
> 
> 标签：lotus-notes, xpages

我正在开发我的第一个 xPages 应用程序。我想为我的一些按钮添加一个漂亮的小图标（来自 FamfamFam 集合），例如“新建”、“保存”、“取消”等。我将 GIF 图像添加为图像资源，并为按钮我想要图标。

一切正常，但按钮上的标签（文本）就在图标旁边。我希望它们间隔一些，也许是 4-6 像素。我宁愿不必在标签上添加空格，我相信有更好的方法，可能以某种方式使用 CSS。

有人知道这样做的好方法吗？

OneUI v2.1 设置为应用程序的主题，我使用的是 Domino Designer 8.5.3 和 Domino Server 8.5.3。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T18:40:37.517

您可以使用以下自定义 CSS 在图标右侧添加一些边距：

```
.lotusBtn img {
  margin-right: 10px;
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-21T20:30:58.727

要添加空间，我使用`<xp:text themeId="Text.Blank"></xp:text>`

Text.Blank 在我的主题资源中，具有以下控制块：

```
<control override="true">
    <name>Text.Blank</name>
    <property mode="override">
        <name>escape</name>
        <value>#{false}</value>
    </property>
    <property mode="override">
        <name>value</name>
        <value>&amp;nbsp;</value>
    </property>
</control> 
```

# excel - 创建一个主动修改访问数据库的 excel 电子表格

> ID：12041628
> 
> 赞同：0
> 
> 时间：2012-08-20T16:39:52.457
> 
> 标签：excel, vba, ms-access

我的客户想要在 Access 中存储基本的关系数据。到现在为止还挺好。但是，理想情况下，他希望我创建一个 Excel 电子表格，允许用户创建和修改数据类型，而无需使用 Access 软件或了解数据库。更具体地说，他想要一个单一的主电子表格，让人们可以管理多个不同“项目”的数据。每个项目都将具有基本属性和其他相关数据，例如从事该项目的员工，编号以使用相关数据完成项目等。我以前使用过数据库，它是关系数据库的一个简洁的教科书示例。我已经有一个数据模型，制作一个 Access 表单来填写它会很简单。

然而，事情是这样的：他希望在 Excel 电子表格中完全直观地创建新的属性和表格——就像单击“添加学生”按钮甚至添加新的数据类别一样简单。例如，将来，他可能会添加一个从事该项目的承包商的列表，如果能够有一个按钮，可以让您从本质上创建该新表，那就太好了。不过，不会有大量数据，而且我不确定参照完整性和规范化是否至关重要。例如，他创建的承包商列表不需要完美链接，这样每家公司在数据库中只出现一次。

所以我该怎么做？我可以使用宏在 Excel 电子表格中完成此操作吗？您能否在 Excel 中制作“创建新表”按钮，该按钮将（运行 VBScript 来）创建与每个项目关联的新数据库表，然后允许您对其进行格式化？我应该根本不用 Excel 并基本上编写一个 Visual Basic 程序吗？我熟悉一般编程和数据库，但我对 Excel、Access 和 Visual Basic 还很陌生。如果您能指出正确的方向——教程、示例、建议、一般概念等——将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T17:12:23.513

Excel本质上是用来分析数据的，而Access本质上是用来存储和处理关系数据的。现在，话虽如此，您尝试做的事情可能是可能的，但实际上并没有利用软件优化的功能。

此外，添加“要与每个项目关联的表”似乎不像是“关系方式”，就像一个简单问题的复杂解决方案。

也许您应该考虑一些替代方案：

*   如果数据量很小而且不是很复杂，是否真的需要 Access 或者您是否可以使用 Excel 进行数据存储和数据操作？
*   根据数据的结构，也许您可​​以在 Access 中创建视图或存储过程，并将其用作 Excel 中的链接表？
*   也许您可以在 Access 中开发您需要的一组表单并将其转换为独立的应用程序（无需在客户端计算机上安装 Access）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T19:31:07.717

对于输入数据的人，Access 的构建使他们根本不需要了解关系数据。如果您让他们在 Excel 中输入数据，您将不得不对其进行过多编码以在 Access 中为您提供相同的控制，否则您将冒着让他们自由形式数据的风险，以至于您将无法将其重新导入 Access .

除非有非常复杂的计算并且用户需要“调整”报告布局，否则请给他们一个数据输入表单。

请注意“我只是习惯于在 Excel 中执行此操作，我不想在 Access 中重新学习它”的概念。数据输入可以非常直观，从长远来看可以节省他们的时间。

似乎有一个所有者/经理了解 Excel，并希望能够在需要时在没有您的情况下更新它。

# sql - 无法连接到远程 SQL 服务器

> ID：12041629
> 
> 赞同：5
> 
> 时间：2012-08-20T16:39:54.193
> 
> 标签：sql, sql-server, sql-server-2008

我的一个客户给了我一个完全有资格`[servername].somedomain.net` 尝试通过 VPN 连接到他们的 SQL Server 实例的服务器名称。

所以我尝试使用他们给我的用户名和密码。没运气。我可以ping它但无法连接，我收到用户名和密码不正确的错误。

所以我登录到实际的服务器，验证我的登录是安全的并且有权限并且它出现在那里。`Workgroup\mylogin`并且看起来`workgroup\`实际上是一样的`somedomain.net\mylogin`。因为当我尝试添加时`somedomain.net\mylogin`，它诉诸于说它已经添加了`workgroup\mylogin`。

不知道这里还有什么要检查的。我给自己在 SQL Server 中的系统管理员角色。我可以ping服务器的IP。

我查看了他们如何对我进行身份验证，并且他们让我在 SQL Server 中的用户设置为使用 Windows Auth。好吧，我得到的错误是当我尝试在我的管理工作室中本地连接时尝试使用 Windows 身份验证时它不能信任跨域。我已连接到他们的 VPN，所以可能是什么问题？

他们现在无法尝试对其进行故障排除，我只是好奇如果可以的话，我还可以尝试自己尝试解决这个问题。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-20T19:23:45.687

基本上，当您无法连接到 SQL Server 时，问题可能是：

1.  网络问题，
2.  SQL Server 配置问题。
3.  防火墙问题
4.  客户端驱动问题
5.  应用程序配置问题。
6.  身份验证和登录问题。

**第 1 步：网络问题**

您可能能够在没有工作网络的情况下进行本地连接，但这是一种特殊情况。对于远程连接，需要稳定的网络。解决 SQL 连接问题的第一件事是确保我们所依赖的网络是可用且稳定的。请运行以下命令：

ping -a（对 IPv4 和 IPv6 使用 -4 和 -6） ping -a nslookup（多次输入本地和远程机器名称和 IP 地址）

小心查看返回结果的任何不匹配。如果您无法 ping 目标机器，则很有可能是网络中断或目标机器未运行。不过，目标计算机可能位于防火墙后面，而防火墙阻止了 ping 发送的数据包。默认情况下，Windows 防火墙不阻止 ping (ECHO) 数据包。网络上 DNS 配置的正确性对 SQL 连接至关重要。错误的 DNS 条目可能会导致以后出现各种连接问题。请参阅此链接，例如“无法生成 SSPI 上下文”错误消息、中毒 DNS。

**第 2 步：SQL Server 配置问题**

您需要确保目标 SQL Server 正在运行并且正在侦听适当的协议。您可以使用 SQL Server 配置管理器 (SCM) 在服务器计算机上启用协议。SQL Server 支持共享内存、命名管道和 TCP 协议（​​以及需要特殊硬件且很少使用的 VIA）。对于远程连接，必须启用 NP 和/或 TCP 协议。在 SCM 中启用协议后，请确保重新启动 SQL Server。

您可以打开错误日志文件以查看服务器是否成功侦听任何协议。错误日志文件的位置通常在：%ProgramFile%Microsoft SQL Server/MSSQLxx.xxx/MSSQL/Log 如果目标 SQL 实例是命名实例，您还需要确保 SQL Browser 在目标机器上运行。如果您无法访问远程 SQL Server，请让您的管理员确保所有这些都发生。

**第三步：防火墙问题**

SQL Server 机器（或客户端和服务器之间的任何位置）上的防火墙可能会阻止 SQL 连接请求。如果这是一个防火墙问题，一个简单的隔离方法是尽可能短时间关闭防火墙。长期解决方案是为 SQL Server 和 SQL Browser 设置例外。

对于 NP 协议，请确保文件共享在防火墙例外列表中。文件共享和 NP 都在下面使用 SMB 协议。对于 TCP 协议，您需要将 SQL Server 侦听的 TCP 端口置于异常中。对于 SQL 浏览器，请将 UDP 端口 1434 排除在外。同时，您也可以将 sqlservr.exe 和 sqlbrowser.exe 放入异常中，但不建议这样做。我们不受信任的机器之间的 IPSec 也可能会阻止一些数据包。请注意，防火墙不应该成为本地连接的问题。

**第 4 步：客户端驱动程序问题**

在这个阶段，您可以使用一些工具来测试您的连接。测试肯定需要在客户端机器上完成。

第一次尝试： telnet 如果启用了 TCP，您应该能够 telnet 到 SQL 服务器 TCP 端口。否则，请返回检查步骤 1-3。然后，使用 OSQL、SQLCMD 和 SQL Management Studio 测试 sql 连接。如果您没有这些工具，请从 Microsoft 下载 SQL Express，您可以免费获得这些工具。

OSQL（SQL Server 2000 附带的）使用 MDAC。OSQL（SQL Server 2005 和 2008 附带的一种）使用 SNAC ODBC。SQLCMD（随 SQL Server 2005 和 2008 提供）使用 SNAC OLEDB。SQL Management Studio（随 SQL Server 2005 和 2008 提供）使用 SQLClient。

可能的命令使用是： osql -E -SYour_target_machine\Your_instance for Windows Auth osql -Uyour_user -SYour_target_machine\Your_instance for SQL Auth

SQLCMD 也适用于此。此外，您可以对 TCP 使用“-Stcp:Your_target_machine, Tcp_port”，对 NP 使用“-Snp:Your_target_machine\Your_instance”，对共享内存使用“-Slpc:Your_target_machine\Your_instance”。您会知道它是否对所有协议或某些特定协议都失败。

在这个阶段，您应该不会再看到诸如错误 26 和错误 40 之类的一般错误消息。如果您在使用 NP 并且仍然看到错误 40（命名管道提供程序：无法打开与 SQL Server 的连接），请尝试以下步骤： a) 在您的服务器计算机上打开文件共享。b) 运行“net view \your_target_machine”和“net use \your_target_machine\your_share”（您也可以尝试从 Windows Explorer 映射网络驱动器）如果您在 b) 中遇到故障，很可能您有操作系统/网络配置问题，这不是特定于 SQL Server 的。请先在互联网上搜索以解决此问题。

您可以尝试使用 Windows 身份验证和 SQL 身份验证进行连接。如果所有工具的测试都失败了，很有可能是步骤 1-3 设置不正确，除非失败与登录有关，否则您可以查看步骤 6。

如果您使用某些工具成功，但使用其他工具失败，则可能是驱动程序问题。您可以在我们的论坛上发布问题并向我们提供详细信息。

您还可以使用“\windows\system32\odbcad32.exe”（Windows 附带）通过为各种驱动程序添加新的 DSN 来测试连接，但这仅适用于 ODBC。

**第五步：申请问题**

如果您成功执行了第 1-4 步，但仍然在应用程序中看到失败，则可能是您的应用程序中存在配置问题。在这里考虑几个可能的问题。a) 您的应用程序是否在与您在步骤 4 中进行测试的帐户相同的帐户下运行？如果没有，您可能希望在该帐户下尝试在步骤 4 中进行测试，或者如果可能的话，更改为您的应用程序的可用服务帐户。b) 您的应用程序使用哪个 SQL 驱动程序？c) 你的连接字符串是什么？连接字符串与您的驱动程序兼容吗？请查看[http://www.connectionstrings.com/](http://www.connectionstrings.com/)以供参考。

**第 6 步：身份验证和登录问题** 这可能是 sql 连接问题最困难的部分。它通常与您的网络、操作系统和 SQL Server 数据库的配置有关。对此没有简单的解决方案，我们必须逐案解决。sql_protocols 中已经有几个博客讨论了一些特殊情况，您可以查看它们，看看它们是否适用于您的情况。除此之外，要记住的事情： a) 如果您使用 SQL 身份验证，则必须启用混合身份验证。检查此页面以获取参考[http://msdn.microsoft.com/en-us/library/ms188670.aspx](http://msdn.microsoft.com/en-us/library/ms188670.aspx) b) 确保您的登录帐户对您在登录期间使用的数据库具有访问权限（OLEDB 中的“初始目录”）。

**参考：http:** [//blogs.msdn.com/b/sql_protocols/archive/2008/04/30/steps-to-troubleshoot-connectivity-issues.aspx](http://blogs.msdn.com/b/sql_protocols/archive/2008/04/30/steps-to-troubleshoot-connectivity-issues.aspx)

很抱歉这堵文字墙，我希望这里的一些东西可以帮助你解决你的问题！

问候。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T16:48:30.957

如果您想访问该服务器，您将需要来自该域的域帐户或使用 SQL 身份验证。我建议只使用 SQL 身份验证——如果他们允许的话，它会更直接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-01-27T10:19:14.220

我有同样的问题，其他机器可以连接到 sql server 但一台计算机没有连接并显示错误“网络相关或实例特定错误...”，当我在登录窗口中更改网络协议时问题得到解决SSMS，在从 TCP/IP 到命名管道的高级选项中。请看下面的截图。

[![连接到 SSMS 的服务器对话框 - 单击选项](../Images/b7e3aa03f933fb9732a4fc60d15b98a9.png)](https://i.stack.imgur.com/kNwMR.png)

[![在连接属性选项卡上的网络协议对话框中选择命名管道](../Images/7de592df4a10de65417781574892908b.png)](https://i.stack.imgur.com/9e22u.png)

请注意，您应该在同一个域中，并且您的凭据应该在服务器上有效。

# file-upload - PrimeFaces FileUpload：选择了多少个文件？

> ID：12041630
> 
> 赞同：1
> 
> 时间：2012-08-20T16:40:19.880
> 
> 标签：file-upload, primefaces

“多个文件”功能可以选择更多文件进行上传。每次传输后都会调用侦听器。但我根本不知道组件会上传多少文件。

在处理完所有选定的文件后，我想导航到下一页。任何建议都受到高度赞赏。

```
fileUploadListener="#{uploadBean.handleFileUpload}" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T12:43:07.023

也许不是一个好的解决方案，但您可以使用 p:fileUpload 中的 oncomplete 来触发隐藏按钮，该按钮会调用操作进行导航。

```
<p:fileUpload ... oncomplete="$('#btn').click()" /> 
```

和

```
<p:commandButton id="btn" action="#{myBean.actionToNavigate}" style="display:none;" /> 
```

# algorithm - 如何计算整数绝对值

> ID：12041632
> 
> 赞同：33
> 
> 时间：2012-08-20T16:40:28.450
> 
> 标签：algorithm, bit-manipulation

`if`如何在不使用条件的情况下计算整数绝对值。我想我们需要使用一些按位运算。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2012-08-20T17:00:31.323

与现有答案相同，但有更多解释：

让我们假设一个二进制补码数（因为这是通常的情况，你不会说别的），让我们假设 32 位：

首先，我们执行算术右移 31 位。这将所有`1`s 转换为负数或所有`0`s 转换为正数（但请注意，`>>`C 或 C++ 中的实际 - 运算符行为是为负数定义的实现，但通常也会执行算术移位，但让我们假设伪代码或实际的硬件说明，因为无论如何这听起来像是家庭作业）：

```
mask = x >> 31; 
```

所以我们得到的是`111...111`（-1）负数和`000...000`（0）正数

现在我们将它与 进行异或`x`，得到 NOT for `mask=111...111`(negative) 和 no-op for `mask=000...000`(positive) 的行为：

```
x = x XOR mask; 
```

最后减去我们的掩码，这意味着 +1 表示负数，+0/no-op 表示正数：

```
x = x - mask; 
```

因此，对于正数，我们执行 0 和减法 0 的异或运算，从而得到相同的数字。对于负数，我们得到`(NOT x) + 1`，这正是`-x`使用补码表示时。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-08-20T16:45:32.080

1.  将掩码设置为整数右移 31（假设整数存储为二进制补码 32 位值并且右移运算符进行符号扩展）。

    ```
    mask = n>>31 
    ```

2.  将掩码与数字异或

    ```
    mask ^ n 
    ```

3.  从步骤 2 的结果中减去掩码并返回结果。

    ```
    (mask^n) - mask 
    ```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-20T16:46:37.147

假设`int`是 32 位的。

```
int my_abs(int x)
{
    int y = (x >> 31);
    return (x ^ y) - y;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-11-22T11:19:33.463

也可以将上述操作执行为：

```
return n*(((n>0)<<1)-1); 
```

其中`n`是绝对需要计算的数字。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-09-04T15:09:41.477

在发现这个问题之前，我自己写了。

我的回答可能较慢，但仍然有效：

```
int abs_of_x = ((x*(x >> 31)) | ((~x + 1) * ((~x + 1) >> 31))); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-11-07T17:42:53.077

在 C 中，您可以使用联合对双精度数执行位操作。以下将在 C 中工作，可用于整数、浮点数和双精度数。

```
/**
* Calculates the absolute value of a double.
* @param x An 8-byte floating-point double
* @return A positive double
* @note Uses bit manipulation and does not care about NaNs
*/
double abs(double x)
{
    union{
        uint64_t bits;
        double dub;
    } b;

    b.dub = x;

    //Sets the sign bit to 0
    b.bits &= 0x7FFFFFFFFFFFFFFF;

    return b.dub;
} 
```

请注意，这假定双精度为 8 个字节。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-09-22T19:11:34.640

如果您不允许使用减号，您可以执行以下操作：

```
int absVal(int x) {
  return ((x >> 31) + x) ^ (x >> 31);
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-01-25T16:57:41.960

对于组装，最有效的方法是将值初始化为 0，减去整数，然后取最大值：

```
pxor mm1, mm1 ; set mm1 to all zeros
psubw mm1, mm0 ; make each mm1 word contain the negative of each mm0 word
pmaxswmm1, mm0 ; mm1 will contain only the positive (larger) values - the absolute value 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-05-12T08:43:18.900

在**C#**中，您可以在`abs()`不使用任何局部变量的情况下实现：

```
public static long abs(long d) => (d + (d >>= 63)) ^ d;

public static int abs(int d) => (d + (d >>= 31)) ^ d; 
```

> ***注意：关于*** `0x80000000 (int.MinValue)` ***和*** `0x8000000000000000 (long.MinValue)`***：***
> 
> 与此页面上显示的所有其他按位/非分支方法一样，这给出了单个非数学结果`abs(int.MinValue) == int.MinValue`（同样适用于`long.MinValue`）。这些表示结果值为负数的*唯一*情况，即[二进制补码](https://en.wikipedia.org/wiki/Two%27s_complement)结果的[MSB](https://en.wikipedia.org/wiki/Bit_numbering)为-- 并且也是唯一返回输入值不变的情况。我不相信这个重要的一点在这个页面的其他地方提到过。`1`

上面显示的代码取决于**xor***右侧*`d`使用的值，即*左侧*计算期间更新的值。对于**C#**程序员来说，这似乎很明显。他们习惯于看到这样的代码，因为**.NET**正式合并了一个强大的[内存模型](https://en.wikipedia.org/wiki/Memory_model_(programming))，该模型严格保证了正确的获取顺序。我提到这个的原因是因为在或***`d`*****`C``C++`人们可能需要更加谨慎。后者的内存模型更加宽松，这可能允许某些编译器优化发出乱序提取。显然，在这种情况下，获取顺序敏感性将代表正确性风险。********

 ********* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-11-04T00:27:05.633

如果您不想在右位移位时依赖符号扩展的实现，您可以修改计算的方式`mask`：

```
mask = ~((n >> 31) & 1) + 1 
```

然后按照前面的答案中已经证明的那样进行：

```
(n ^ mask) - mask 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2012-08-20T16:44:50.023

您使用的编程语言是什么？在 C# 中，您可以使用以下`Math.Abs`方法：

```
int value1 = -1000;
int value2 = 20;
int abs1 = Math.Abs(value1);
int abs2 = Math.Abs(value2); 
```********

# c# - Razor 视图没有看到 System.Web.Mvc.HtmlHelper

> ID：12041633
> 
> 赞同：72
> 
> 时间：2012-08-20T16:40:35.513
> 
> 标签：c#, razor, asp.net-mvc-4

我正在升级到 MVC4。我已按照[http://www.asp.net/whitepapers/mvc4-release-notes#_Toc303253806](http://www.asp.net/whitepapers/mvc4-release-notes#_Toc303253806)上的说明进行操作，但在我的 Razor 视图和布局中出现类似错误

*   'System.Web.WebPages.Html.HtmlHelper' 不包含 'BeginRouteForm' 的定义，并且没有扩展方法 'BeginRouteForm' 接受类型为 'System.Web.WebPages.Html.HtmlHelper' 的第一个参数（你是缺少 using 指令或程序集引用？）

我也有错误，如：

*   “当前上下文中不存在名称‘Viewbag’

当我将鼠标悬停在@Html 上时，我可以看到它的类型是 System.Web.WebPages.Html.HtmlHelper 而不是 System.Web.Mvc.HtmlHelper

不太确定还有哪些其他信息是相关的，但这是我所在的位置：

*   我还没有将 sln 中的类库等更新到 .net 4.5。
*   该项目是在 VS2010 中创建的，但我正在 VS2012 中进行迁移
*   该项目使用 VS2012、.Net 4.0、MVC 3 打开并运行正常

任何指针表示赞赏。

**编辑：** web.config 中的所有引用和文件升级为：

*   System.Web.Mvc，版本=4.0.0.0
*   System.Web.WebPages，版本=2.0.0.0
*   System.Web.Helpers，版本=2.0.0.0
*   System.Web.WebPages.Razor，版本=2.0.0.0

**编辑（2）：** 在我的 /views/web.config （或 /views/shared/web.config 如果我尝试下面的@Paul 的解决方案）的元素中，我有自己的基类型，它继承自 System.Web。 Mvc.WebViewPage ，包含库中的引用已更新为 MVC4 并转到定义将我带到 MVC4 dll。

新版本在这方面有什么变化吗？我在发行说明中看不到任何相关内容。

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2014-04-30T13:36:16.463

我在使用 Web 应用程序时遇到了这个问题——`.cshtml`当`System.Web.WebPages.WebViewPage`我需要`System.Web.Mvc.WebViewPage`.

首先，确保您的 ~/Views/web.config 文件具有正确的`pageBaseType`. 就我而言，我设置为`System.Web.Mvc.WebViewPage`.

```
<configuration>
  <system.web.webPages.razor>
    <pages pageBaseType="System.Web.Mvc.WebViewPage">
      <!-- ... -->
    </pages>
  </system.web.webPages.razor>
</configuration> 
```

然后，**重要**的是，如果上面已经很好，有些人发现这是关键：

1.  在解决方案上运行清洁
2.  卸载有问题的项目
3.  删除`.user`Visual Studio 在项目旁边生成的文件。
4.  重新加载包含问题的项目
5.  构建解决方案

**对于 VS2015**，`.user`和`.sln`文件已移动到`.vs`文件旁边创建的隐藏文件夹中`.sln`。但是，从下面的评论中，错误消息暗示我该工具完全使用了错误的 MVC 版本，删除此文件夹并不能解决问题。据我所知，没有已知的解决方案。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2014-02-02T19:31:01.663

我在更新到 MVC 5 时遇到了同样的问题，通过更新 Views 文件夹中的 web.config 解决了这个问题。

```
<system.web.webPages.razor>
<host factoryType="System.Web.Mvc.MvcWebRazorHostFactory, System.Web.Mvc, Version=5.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
<pages pageBaseType="System.Web.Mvc.WebViewPage">
  <namespaces>
    <add namespace="System.Web.Mvc" />
    <add namespace="System.Web.Mvc.Ajax" />
    <add namespace="System.Web.Mvc.Html" />
    <add namespace="System.Web.Optimization"/>
    <add namespace="System.Web.Routing" />
  </namespaces>
</pages> 
```

主机 -> factoryType 设置为 version:4.0.0.0 希望这对任何人都有帮助。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-04-13T02:28:06.370

我在这里尝试了所有解决方案，但没有一个对我有用。同样，我的网站运行良好，但我没有智能感知，并且在我认为 Visual Studio 无法识别的许多事物下出现红色波浪线，其中之一是`Html.BeginForm()`，以及与`ViewBag`.

我正在处理一个新的 MVC 5 项目。经过数小时比较 web.config 行后，我终于找到了为我解决的问题。

我的根目录中的 web.config 有以下行：

```
<system.web>
  <compilation debug="true" targetFramework="4.5" />

  <!-- ... -->
</system.web> 
```

我将之前的项目与不使用 MVC 5 的项目进行了比较，并复制了一个我注意到新项目缺少的块，如下所示：

```
<system.web>
  <compilation debug="true" targetFramework="4.5">
    <assemblies>
      <add assembly="System.Web.Abstractions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
      <add assembly="System.Web.Helpers, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
      <add assembly="System.Web.Routing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
      <add assembly="System.Web.Mvc, Version=5.1.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
      <add assembly="System.Web.WebPages, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
    </assemblies>
  </compilation>

  <!-- ... -->
</system.web> 
```

我将上面的块复制到根目录中我的新项目的 web.config 中，更改版本以匹配在我的项目引用中找到的每个程序集的数字（右键单击提到的每个引用并选择“属性”，给出“版本”在所选参考的属性窗口底部）。

`Html.BeginForm`实现上述操作后，我现在有了智能感知，并且在,`ViewBag.Title`等下面没有任何未知的红线。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-05-05T00:49:37.957

我已经运行了一个干净的项目，并安装或重新安装了所有东西，但仍然收到很多 Intellisense 错误，即使我的网站正在编译和运行良好。当我更改 Views 文件夹中 web.config 文件中的版本号时，Intellisense 终于为我工作了。就我而言，我在 Orchard 中编写了一个模块，该模块在 MVC 区域中运行，但我认为这将帮助任何使用最新版本的 MVC 的人。**这是Views 文件夹**中的我的 web.config

 **```
 <?xml version="1.0"?>
    <configuration>
      <configSections>
        <sectionGroup name="system.web.webPages.razor" type="System.Web.WebPages.Razor.Configuration.RazorWebSectionGroup, System.Web.WebPages.Razor, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
          <section name="host" type="System.Web.WebPages.Razor.Configuration.HostSection, System.Web.WebPages.Razor, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" />
          <section name="pages" type="System.Web.WebPages.Razor.Configuration.RazorPagesSection, System.Web.WebPages.Razor, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" />
        </sectionGroup>
      </configSections>

      <system.web.webPages.razor>
        <host factoryType="System.Web.Mvc.MvcWebRazorHostFactory, System.Web.Mvc, Version=5.1.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <pages pageBaseType="Orchard.Mvc.ViewEngines.Razor.WebViewPage">
          <namespaces>
            <add namespace="System.Web.Mvc" />
            <add namespace="System.Web.Mvc.Ajax" />
            <add namespace="System.Web.Mvc.Html" />
            <add namespace="System.Web.Routing" />
            <add namespace="System.Linq" />
            <add namespace="System.Collections.Generic" />
          </namespaces>
        </pages>
      </system.web.webPages.razor>

      <system.web>

        <!--
            Enabling request validation in view pages would cause validation to occur
            after the input has already been processed by the controller. By default
            MVC performs request validation before a controller processes the input.
            To change this behavior apply the ValidateInputAttribute to a
            controller or action.
        -->
        <pages
            validateRequest="false"
            pageParserFilterType="System.Web.Mvc.ViewTypeParserFilter, System.Web.Mvc, Version=5.1.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL"
            pageBaseType="System.Web.Mvc.ViewPage, System.Web.Mvc, Version=5.1.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL"
            userControlBaseType="System.Web.Mvc.ViewUserControl, System.Web.Mvc, Version=5.1.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
          <controls>
            <add assembly="System.Web.Mvc, Version=5.1.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL" namespace="System.Web.Mvc" tagPrefix="mvc" />
          </controls>
        </pages>
      </system.web>

      <system.webServer>
        <validation validateIntegratedModeConfiguration="false" />

        <handlers>
          <remove name="BlockViewHandler"/>
          <add name="BlockViewHandler" path="*" verb="*" preCondition="integratedMode" type="System.Web.HttpNotFoundHandler" />
        </handlers>
      </system.webServer>
    </configuration> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-08-20T16:47:29.670

您需要复制`Views/Web.config`到`/Shared`. 这将告诉 Razor 使用 MVC 基本类型和解析器。你可以在这里阅读更多：http: [//blog.slaks.net/2011/02/dissecting-razor-part-3-razor-and-mvc.html](http://blog.slaks.net/2011/02/dissecting-razor-part-3-razor-and-mvc.html)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-08-18T04:19:41.433

`Visual Studio 2013`从升级到后，我正在处理这个问题`Visual Studio 2015`在尝试了在这篇文章和其他类似的 SO 帖子中找到的大部分建议之后，我终于找到了问题所在。修复的第一部分是将我所有的东西更新到最新版本（如果你遇到错误，`NuGet`你可能需要这样做）之后，我不得不，因为你可能需要，修复列出的版本**意见**。这包括：`VS13``Nuget` **`Web.config`**

 **1.  `MVC`将版本及其子库修复到新版本（展开`References`然后右键单击`Sytem.Web.MVC`然后`Properties`获取您的版本）
2.  修复`Razor`版本。

我的看起来像这样：

```
<configuration>
  <configSections>
    <sectionGroup name="system.web.webPages.razor" type="System.Web.WebPages.Razor.Configuration.RazorWebSectionGroup, System.Web.WebPages.Razor, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
      <section name="host" type="System.Web.WebPages.Razor.Configuration.HostSection, System.Web.WebPages.Razor, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" />
      <section name="pages" type="System.Web.WebPages.Razor.Configuration.RazorPagesSection, System.Web.WebPages.Razor, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" />
    </sectionGroup>
  </configSections>

  <system.web.webPages.razor>
    <host factoryType="System.Web.Mvc.MvcWebRazorHostFactory, System.Web.Mvc, Version=5.2.3.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
    <pages pageBaseType="System.Web.Mvc.WebViewPage">
      <namespaces>
        <add namespace="System.Web.Mvc" />
        <add namespace="System.Web.Mvc.Ajax" />
        <add namespace="System.Web.Mvc.Html" />
        <add namespace="System.Web.Optimization"/>
        <add namespace="System.Web.Routing" />
      </namespaces>
    </pages>
  </system.web.webPages.razor>

  <appSettings>
    <add key="webpages:Enabled" value="false" />
  </appSettings>

  <system.web>
    <httpHandlers>
      <add path="*" verb="*" type="System.Web.HttpNotFoundHandler"/>
    </httpHandlers>
    <pages
      validateRequest="false"
      pageParserFilterType="System.Web.Mvc.ViewTypeParserFilter, System.Web.Mvc, Version=5.2.3.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"
      pageBaseType="System.Web.Mvc.ViewPage, System.Web.Mvc, Version=5.2.3.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"
      userControlBaseType="System.Web.Mvc.ViewUserControl, System.Web.Mvc, Version=5.2.3.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
      <controls>
        <add assembly="System.Web.Mvc, Version=5.2.3.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" namespace="System.Web.Mvc" tagPrefix="mvc" />
      </controls>
    </pages>
  </system.web>

  <system.webServer>
    <validation validateIntegratedModeConfiguration="false" />

    <handlers>
      <remove name="BlockViewHandler"/>
      <add name="BlockViewHandler" path="*" verb="*" preCondition="integratedMode" type="System.Web.HttpNotFoundHandler" />
    </handlers>
  </system.webServer>
</configuration> 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-02-12T01:54:10.250

Visual Studio 2017 用户更新：

如果您刚刚迁移到 Visual Studio 2017 并且您的项目是 MVC4，请确保返回 VS2017 安装程序并检查“ASP.NET 和 Web 开发”部分下的 MVC4 选项。它是一个可选组件，默认情况下未选中。

这解决了我的问题

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-04-28T16:44:56.080

在承包世界中，我经常使用使用旧图像的机器。在尝试了上述所有操作后，我决定将我的 VS 2013 更新到最新版本（更新 4）。90 分钟后重新启动，参考现在工作正常！希望这可以帮助！

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-09-10T19:15:16.867

徒劳地尝试了一切，我发现在我的情况下它不起作用，因为 Web Project csproj 文件中的属性值不正确。当我将**ToolsVersion**更改为**14**时，它与我当前的 IDE 版本（即 Visual Studio 2015）相匹配，一切都像一个魅力：

```
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="14.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition=
  ..... 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-01-07T14:53:59.487

对于那些在将项目从 VS 2013 迁移到 VS 2015 后遇到此问题的人，我能够通过从[https://visualstudiogallery.msdn.microsoft.com/c94a02e9-f2e9-安装 ASP.NET 工具更新来解决此问题4bad-a952-a63a967e3935/file/77371/6/AspNet5.ENU.RC1_Update1.exe?SRC=VSIDE&UPDATE=TRUE](https://visualstudiogallery.msdn.microsoft.com/c94a02e9-f2e9-4bad-a952-a63a967e3935/file/77371/6/AspNet5.ENU.RC1_Update1.exe?SRC=VSIDE&UPDATE=TRUE)。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-11-03T04:22:48.950

只是为了扩展 Matt DeKrey 的答案，只需删除 csproj.user 文件（无需重新创建解决方案）就可以为我解决问题。

我唯一的副作用是我需要将开始操作重置为使用特定页面。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-06-14T14:31:44.060

我在 MSDN 上使用了以下文章来解决这个问题（在这种情况下从 MVC 4 到 MVC 5）

[https://docs.microsoft.com/en-us/aspnet/mvc/overview/releases/how-to-upgrade-an-aspnet-mvc-4-and-web-api-project-to-aspnet-mvc- 5-and-web-api-2](https://docs.microsoft.com/en-us/aspnet/mvc/overview/releases/how-to-upgrade-an-aspnet-mvc-4-and-web-api-project-to-aspnet-mvc-5-and-web-api-2)

文章主要摘录如下：

## 主 Web.config（不是 Views 文件夹中的那个）

在运行时块中更新 System.Web.Mvc 到 5.0.0.0 ，System.Web.Helpers 到 3.0.0.0 和 System.Web.WebPages 到 3.0.0.0

```
<dependentAssembly>
  <assemblyIdentity name="System.Web.Helpers" publicKeyToken="31bf3856ad364e35" />
  <bindingRedirect oldVersion="1.0.0.0-3.0.0.0" newVersion="3.0.0.0" />
</dependentAssembly>

<dependentAssembly>
  <assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35" />
  <bindingRedirect oldVersion="1.0.0.0-5.0.0.0" newVersion="5.0.0.0" />
</dependentAssembly>

<dependentAssembly>
  <assemblyIdentity name="System.Web.WebPages" publicKeyToken="31bf3856ad364e35" />
  <bindingRedirect oldVersion="1.0.0.0-3.0.0.0" newVersion="3.0.0.0" />
</dependentAssembly> 
```

然后查找 appsettings 块并将 pages:Version 值更新为 3.0.0.0

```
<appSettings>
    <add key="webpages:Version" value="3.0.0.0" />
</appSettings> 
```

## 查看 Web.config

将主机 factoryType 块更新为 System.Web.Mvc 到 5.0.0.0

```
<system.web.webPages.razor>
   <host factoryType="System.Web.Mvc.MvcWebRazorHostFactory, System.Web.Mvc, Version=5.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
   <pages pageBaseType="System.Web.Mvc.WebViewPage">
      <namespaces>
         <add namespace="System.Web.Mvc" />
      </namespaces>
   </pages>
</system.web.webPages.razor> 
```

然后在页面块下将对 System.Web.Mvc 的任何引用更新为 5.0.0.0

```
 <pages
      validateRequest="false"
      pageParserFilterType="System.Web.Mvc.ViewTypeParserFilter, System.Web.Mvc, Version=5.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"
      pageBaseType="System.Web.Mvc.ViewPage, System.Web.Mvc, Version=5.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"
      userControlBaseType="System.Web.Mvc.ViewUserControl, System.Web.Mvc, Version=5.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
    <controls>
      <add assembly="System.Web.Mvc, Version=5.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" namespace="System.Web.Mvc" tagPrefix="mvc" />
    </controls>
  </pages> 
```

最后在配置块下更新 System.Web 对 3.0.0.0 的引用

```
<configuration>
  <configSections>
    <sectionGroup name="system.web.webPages.razor" type="System.Web.WebPages.Razor.Configuration.RazorWebSectionGroup, System.Web.WebPages.Razor, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
      <section name="host" type="System.Web.WebPages.Razor.Configuration.HostSection, System.Web.WebPages.Razor, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" />
      <section name="pages" type="System.Web.WebPages.Razor.Configuration.RazorPagesSection, System.Web.WebPages.Razor, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" />
    </sectionGroup>
  </configSections> 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-10-12T10:27:32.603

最近遇到了同样的问题，这就是我修复它的方法：在 Visual Studio 上打开有问题的项目，转到：

1.  *工具 -> NuGet 包管理器 -> 管理解决方案的 NuGet 包*。
2.  在打开的窗口中，选择**更新**。然后单击**全部更新**。

它将加载您项目中缺少的内容，并且一切都应该回到正轨。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-07-30T21:37:34.463

我自己刚开始研究这个问题，这就是我的情况。如果您的 Web 配置中有正确的值，那么它只是 MVC4 中的一个错误。 [http://connect.microsoft.com/VisualStudio/feedback/details/727729/viewbag-not-recognized-in-asp-net-mvc-4-project](http://connect.microsoft.com/VisualStudio/feedback/details/727729/viewbag-not-recognized-in-asp-net-mvc-4-project)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-02-23T21:30:33.903

我在 SO 中遇到了几个答案，最后我意识到我的错误是我拼错了“Html.TextBoxFor”。就我而言，我写的是“Html.TextboxFor”。我没有大写 TextBoxFor 中的 B。解决了这个问题，瞧。问题解决了。我希望这可以帮助别人。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-11-18T10:17:32.207

是的，我一直在尝试解决这个问题。我已经使用了有关此问题的各种 Stack Overflow 主题中的所有解决方案，但似乎没有一个有效。

我今天早上刚刚解决了这个问题。在为项目和视图修复 web.config 后，确保所有 .dll 版本都与您在引用文件夹中的内容匹配。您需要卸载项目，编辑 .csproj，然后更新该文件中的所有 .dll 版本。

```
System.Web.Helpers
System.Web.Mvc
System.Web.WebPages 
```

希望这会有所帮助，因为我终于解决了这个问题！没有更多的红色波浪线。

这也解决了我遇到的上下文菜单问题，我没有选择添加控制器、视图等。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2015-08-10T18:24:17.190

```
*<system.web>
<compilation debug="true" targetFramework="4.5">
    <assemblies>
        <add assembly="System.Web.Abstractions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Helpers, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Routing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Mvc, Version=5.1.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.WebPages, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
    </assemblies>
</compilation>* 
```

缺少此配置，添加它并设置适当版本的程序集

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-01-18T16:58:22.743

我的情况只发生在我创建了一个名为`BaseViewPage`覆盖该类的自定义类之后`WebViewPage`。我最初将以下内容添加到我的**Main** Web.confg 文件中：

```
<pages pageBaseType="ZooResourceLibrary.Web.Support.BaseViewPage"> 
```

与**查看**文件夹 web.config 文件相同：

```
<pages pageBaseType="ZooResourceLibrary.Web.Support.BaseViewPage"> 
```

我尝试了许多其他答案，但都没有成功，同时仍然允许我继续`BaseViewPage`上课。**我修复它的方法是仅从Main** Web.config 文件中删除该`pageBaseType`属性。将其保存在**View** web.config 中。

 ***** * *

## 回答 #19

> 赞同：0
> 
> 时间：2016-05-30T12:08:24.030

对我来说，这是一个愚蠢的部署错误：Web 项目可以有多个 web.config。它在开发人员的机器上工作，而不是在生产环境中，但我们没有意识到部署脚本只抓取了`Web.config`根目录下的文件，并没有复制`Web.config`文件`Views`夹中的文件。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2016-06-07T12:03:08.010

我也遇到过这个具体问题；尝试使用剃须刀标签时没有（或不正确）智能感知显示。我的具体问题是 VS2015 抱怨 Html.BeginForm 在当前上下文中不存在。

我在我的 MVC 项目中设置了区域，并设法将我的错误原因缩小到特定区域的 web.config 文件，而不是全局 web.config。

事实证明，对我来说这个问题的原因是我在 web.config 中添加了一个 SQL connectionString 到不工作的区域，这（我假设）导致解析错误，但是项目编译正确.

将 connectionString 移至全局 web.config 已解决该问题。希望这可能对其他人有用。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2015-10-02T20:23:53.390

作为主题的变体，我可以上下发誓我的 Views\Web.config 是正确的：

```
<host factoryType="System.Web.Mvc.MvcWebRazorHostFactory, System.Web.Mvc, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" /> 
```

但我实际上需要参考`Version=4.0.0.1`，而不是`Version=4.0.0.0`因为不久前推出的安全更新。

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2016-02-22T09:36:16.407

对我来说，解决方案是更改以下内容：

```
 <pages
        validateRequest="false"
        pageParserFilterType="System.Web.Mvc.ViewTypeParserFilter, System.Web.Mvc, Version=5.2.3.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"
        pageBaseType="System.Web.Mvc.ViewPage, System.Web.Mvc, Version=5.2.3.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"
        userControlBaseType="System.Web.Mvc.ViewUserControl, System.Web.Mvc, Version=5.2.3.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
      <controls>
        <add assembly="System.Web.Mvc, Version=5.2.3.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" namespace="System.Web.Mvc" tagPrefix="mvc" />
      </controls>
    </pages> 
```********

# javascript - 通过单击和拖动 div 使用 mousemove、mousedown 和 mouseup

> ID：12041634
> 
> 赞同：0
> 
> 时间：2012-08-20T16:40:38.770
> 
> 标签：javascript, jquery, client-side

我似乎无法让它工作，但我想要做的是能够将一些东西附加到我的鼠标上，然后当我 mousedown 取消绑定单击但然后重新绑定它以移动宽度和高度而不是顶部和左侧. 尝试如下：

```
$(document).mousemove(function(mouseEvent) {
    creationTagBool = true;
    n.show();
    n.css("left", mouseEvent.pageX);
    n.css("top", mouseEvent.pageY);
}).mousedown(function(mouseEvent) {
    if (creationTagBool) {
        $(this).unbind("mousemove");
        creationTagBool = false;
        //draggCon();
        n.css("width", mouseEvent.pageX - n.css("left"));
        n.css("height", mouseEvent.pageY - n.css("top"));
    }

}).mouseup(function(mouseEvent) {
    $(this).unbind("mousedown");
    draggCon();
});​ 
```

我实际上在想它应该做类似的事情：mousemove，mousedown 解除绑定然后重新绑定 mousemove，on mouseup 再次解除绑定 mousemove。

当我输入这个时，我在想这可能有效，所以我必须快速测试它。我的想法如下：

```
$(document).mousemove(function(mouseEvent) {
    creationTagBool = true;
    n.show();
    n.css("left", mouseEvent.pageX);
    n.css("top", mouseEvent.pageY);
}).mousedown(function(mouseEvent) {
    if (creationTagBool) {
        $(this).unbind("mousemove");
        creationTagBool = false;
        //draggCon();
        //n.css("width", mouseEvent.pageX - n.css("left"));
        //
        $(this).mousemove(function() {
            n.css("width", mouseEvent.pageX - n.css("left"));
            n.css("height", mouseEvent.pageY - n.css("top"));
        }).mouseup(function() {
            $(this).unbind("mousemove");
            draggCon();
        });
    }
});​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T18:46:59.290

错误是宽度高度和宽度，所以在运行它时，你需要有。mouseEvent.pageX + n.position().left 而不是 n.css("left")。

当我开始工作时，它似乎很好，虽然有点慢。我暂时没有点击并拖动事件，而是将其检查为 2 次点击。

# c# - c# 2010 正则表达式文件名匹配 + ftp 上传

> ID：12041635
> 
> 赞同：-1
> 
> 时间：2012-08-20T16:40:38.913
> 
> 标签：c#, regex, ftp, filenames

任务：我想上传一个文件到我的 ftp，但他的文件没有扩展名，也没有 trID 或任何东西，它只是“文件”，文件名是 abcd 后跟 19 位随机数字。

例子：

abcd9876543211234567892

abcd6662325999292112450

等等。

所以我想做的是添加一个正则表达式来查找以 abcd 开头的匹配文件名，然后在最后上传所有匹配的文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T16:49:36.853

我无法从这里访问您的链接。
然而，这应该是对静态方法的简单调用`RegEx.IsMatch`。
（我假设您要匹配以“abcd”开头的文件，并且后面也正好有 19 位数字）。

```
 // First get the list of filenames. I am using a string array for simplicity to denote input data.
    // I believe you are getting a collection from Directory.GetFiles
    string[] fileNames = { "abcd9876543211234567892", "abcd6662325999292112450"};
    string pattern = @"^abcd\d{19}$";
    foreach (string fileName in fileNames)
    {
        if (System.Text.RegularExpressions.Regex.IsMatch(fileName, pattern, System.Text.RegularExpressions.RegexOptions.IgnoreCase))
        {
            //Do your upload
        }
        else
        {
            //Ignore or Record that this file is not eligible for upload or whatever...
        }
    } 
```

如果您需要匹配以“abcd”开头的文件名，后跟只有数字或没有，然后将模式修改为`^abcd\d*$`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-20T16:50:21.873

$abcd\d+

使用此表达式针对 Directory.GetFiles 返回的所有字符串在您要查找图像的目录上运行正则表达式引擎并上传与此模式匹配的那些。

我不会发布代码，但一旦实施，它应该会给你一个可行的解决方案。

# mysql - 使用 3 个表进行查询优化

> ID：12041638
> 
> 赞同：0
> 
> 时间：2012-08-20T16:40:41.453
> 
> 标签：mysql, sql, database-design, indexing, query-optimization

希望优化此查询

```
SELECT gwt.z, gwt.csp, gwt.status, gwt.cd, gwt.disp, gwt.5d, gwt.6d, gwt.si, gwt.siad, gwt.prbd, 
  CONCAT(gwt.1, gwt.2, gwt.3, gwt.4, gwt.5, gwt.6, gwt.7, gwt.8, gwt.9), 
  group_concat(gws.res order by line_no), gwt.scm, gm.me, gwt.p, gwt.scd 
from gwt 
left outer join gws on gwt.csp = gws.csp 
left join gm on gwt.scm = gm.mid 
where gwt.zone = 1 
  and (status like '1%' or status like '2%' or status like '3%' or 
       status like '4%' or status like '5%' or status like '6%') 
group by gwt.csp 
```

使用 EXPLAIN，gwt 有 4110 行，gws 有 920k 行，gm 有 2800 行。

当我只查询 1% 之类的状态时，查询加载正常，但由于我添加了要显示的其他状态，因此出现超时错误。

![描述](../Images/4fb51e7ad45d8ad6a4a54eb512978d79.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T18:07:28.687

我建议以下。

确保每个表都有一个关于其主键的索引：

*   gwt.csp
*   gm.mid

对于 gwt，在 (zone, status) 上创建另一个索引并将连接条件更改为：

```
gwt.zone = 1 and status >= '1' and status < '7' 
```

这等效于您的列表，但它将允许执行引擎使用索引。

这可能足以修复查询。最后，您可以在 gws.csp 上放置一个索引，看看这是否加快了速度。

“csp”是一对一的关系吗？如果不是，您可能会遇到创建巨大结果集的查询的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T17:36:34.950

由于*gws*表的行数比其他表多两个数量级，因此这是需要关注的一个。如果你想设计你的索引来定位这个特定的查询，那么第一步很简单。也就是说，您需要在连接列 (gws.csp) 上添加一个索引，并确保在索引中包含所有选定的列 - gws.res 和 gws.line_no(?)。

以上应该可以显着提高查询速度。第二个问题是确保*gwt*表有一个索引，其*状态*为第一列。

# python - Python win32print 打印机状态混乱

> ID：12041648
> 
> 赞同：1
> 
> 时间：2012-08-20T16:41:30.160
> 
> 标签：python, windows, winapi, printing, wmi

我一直在使用 Python 的[win32print](http://docs.activestate.com/activepython/2.4/pywin32/win32print.html)模块来尝试获取有关打印机集的各种信息，例如驱动程序名称、作业计数、正在使用的端口、状态等。它大多是成功的，但是我遇到了很多麻烦使用 win32print 从 API 返回的状态码。

我一直在使用 win32print.GetPrinter 方法，它返回一个 PRINTER_INFO_ 字典，其中一个映射是 Status。但是，没有记录什么状态代码对应于什么打印机状态。似乎 0 是空闲的，1 是暂停的，但除此之外我不确定这意味着什么。

当我查找 windows 32 位 API 的常量值时，我找到[了这个页面](http://doc.pcsoft.fr/en-US/?6510001&name=valeur-des-constantes-api-windows-32-bits&q=Find%20out)，但我得到的状态代码似乎都与它不匹配。很多时候，我得到一个状态码，比如 1052800（从 Epson 打印机得到那个），它不在 win32api 常量的列表中。

我也尝试过使用 WMI 模块来做到这一点，但成功率更低。

我想获取打印机缺纸、打印机门打开、碳粉不足、卡纸等的打印机状态代码。有没有人有任何提示可以在哪里找到这些状态代码的含义，甚至是查找打印机状态的更好解决方案完全地？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T16:51:30.607

返回的状态是一个位掩码，例如[在此处](http://msdn.microsoft.com/en-us/library/cc244854(v=prot.10).aspx)描述。多个值可以进行或运算，因此您的值 1052800（十六进制 0x101080）表示打印机具有（所有）状态；

*   PRINTER_STATUS_USER_INTERVENTION
*   PRINTER_STATUS_NOT_AVAILABLE
*   PRINTER_STATUS_OFFLINE

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-22T09:32:32.130

我想分享我在 Windows 10 中检查打印机是否离线的经验。`PRINTER_INFO_2`from中的状态标志`win32print.GetPrinter`对我不起作用，因为对于所有已安装的打印机，它始终为 0。感谢[这个关于 C++ 的 stackoverflow 讨论](https://stackoverflow.com/questions/41437023/trying-to-determine-printer-status-always-returns-0-for-offline-online-printer)，我发现`PRINTER_ATTRIBUTE_WORK_OFFLINE`打印机属性中的标志可以表示打印机是否处于脱机状态。

```
handle = win32print.OpenPrinter(printer_name)   
attributes = win32print.GetPrinter(handle)[13]
print(f'{printer_name} is offline? :{(attributes & 0x00000400) >> 10}') 
```

[13] 是返回元组中的属性位置。[microsoft doc](https://docs.microsoft.com/en-us/windows/win32/printdocs/printer-info-2)
0x00000400 是`PRINTER_ATTRIBUTE_WORK_OFFLINE`. [微软文档](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-rprn/1625e9d9-29e4-48f4-b83d-3bd0fdaea787)

# php - PHP PDO 增量

> ID：12041649
> 
> 赞同：-1
> 
> 时间：2012-08-20T16:41:32.060
> 
> 标签：php, mysql, pdo

我有 2 个问题： 1.我的问题是，当我尝试增加值时，它会重置回 1 ；2.我可以将我的代码简化为一个MYSQL语句（switch ... case代码）

```
public static function process($nr,$id) // (x,y,z,a,b ?) (the column id)
{

$х=$y=$z=$a=$b=0;

  switch ($nr) {
    case '1':
        $х=1;
        break;

        case '2':
        $y=1;
        break;

        case '3':
        $z=1;
        break;

        case '4':
        $a=1;
        break;

        case '5':
        $b=1;
        break;

  }

$conn = new PDO( DBN, DB_USER, DB_PASS );
$sql = "UPDATE test_table SET b=+:b, a=+:a,z=+:z,y=+:y,х=+:х WHERE id = :id";
$st = $conn->prepare ( $sql );
$st->bindValue( ":id", $id, PDO::PARAM_INT);
$st->bindValue( ":х", $х, PDO::PARAM_INT);
$st->bindValue( ":y", $y, PDO::PARAM_INT);
$st->bindValue( ":z", $z, PDO::PARAM_INT);
$st->bindValue( ":a", $a, PDO::PARAM_INT);
$st->bindValue( ":b", $b, PDO::PARAM_INT);
$st->execute();
$conn = null;
print_r($st->errorInfo()); 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T17:10:31.013

```
UPDATE table_name SET column_name = column_name+1 WHERE id = ?; 
```

是增加任何数据库计数器的最佳方法，因为它是原子处理的，这意味着没有其他进程/线程可以意外插入先前读取的值，您 100% 确定每次调用函数/过程时都会增加该值。

如果你在 PHP 中做另一个——你会很糟糕——因为经典的竞争条件：

```
user1 -> read value // value=10
user2 -> read value // value=10
user1 -> write value++ // value becomes 11
user2 -> write value++ // value (AGAIN) becomes 11 but it should've been 12 
```

为更复杂的查询避免这种情况涉及使用事务和特定的隔离级别。但事实上，由单个语句形成的所有 SQL 查询都是原子的。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-08-20T16:53:40.383

为什么不 ？

```
public static function process($nr,$id) // (x,y,z,a,b ?) (the column id)
{
$param;
switch ($nr) {
    case '1':
        $param = "x=x+1";
        break;

    case '2':
        $param = "y=y+1";
        break;

    case '3':
        $param = "z=z+1";
        break;

    case '4':
        $param = "a=a+1";
        break;

    case '5':
        $param = "b=b+1";
        break;

}

$conn = new PDO( DBN, DB_USER, DB_PASS );
$sql = "UPDATE test_table SET $param WHERE id = :id";
$st = $conn->prepare( $sql );
$st->bindValue( ":id", $id, PDO::PARAM_INT);
$conn = null;
print_r($st->errorInfo()); 
```

这也是我所有的 SQL 解决方案，如果你问我，我有点笨拙：

```
public static function process($nr,$id) // (x,y,z,a,b ?) (the column id)
{
    $sql <<<'EOD'
        UPDATE test_table SET
            x = CASE WHEN :nr = 1 THEN x + 1 ELSE x END CASE,
            y = CASE WHEN :nr = 2 THEN y + 1 ELSE y END CASE,
            z = CASE WHEN :nr = 3 THEN z + 1 ELSE z END CASE,
            a = CASE WHEN :nr = 4 THEN a + 1 ELSE a END CASE,
            b = CASE WHEN :nr = 5 THEN b + 1 ELSE b END CASE
        WHERE id = :id
     EOD;

     $conn = new PDO( DBN, DB_USER, DB_PASS );
     $st = $conn->prepare( $sql );
     $st->bindValue( ":nr", $nr, PDO::PARAM_INT);
     $st->bindValue( ":id", $id, PDO::PARAM_INT);
     $conn = null;
     print_r($st->errorInfo());
} 
```

# c# - 使用 HtmlAgilityPack 替换节点抛出奇怪的错误

> ID：12041660
> 
> 赞同：3
> 
> 时间：2012-08-20T16:42:23.797
> 
> 标签：c#, html, parsing, html-agility-pack

我有一个网页显示用户可以编辑的表格。进行编辑后，我想将表格另存为 .html 文件，以后可以将其转换为图像。我通过覆盖渲染方法来做到这一点。但是，我想从最终版本中删除两个按钮和一个 DropDownList，以便我自己获取表格。这是我目前正在尝试的代码：

```
protected override void Render(HtmlTextWriter writer)
{
    using (HtmlTextWriter htmlwriter = new HtmlTextWriter(new StringWriter()))
    {
        base.Render(htmlwriter);
        string renderedContent = htmlwriter.InnerWriter.ToString();
        string output = renderedContent.Replace(@"<input type=""submit"" name=""viewReport"" value=""View Report"" id=""viewReport"" />", "");
        output = output.Replace(@"<input type=""submit"" name=""redoEdits"" value=""Redo Edits"" id=""redoEdits"" />", "");

        var doc = new HtmlDocument();
        doc.LoadHtml(output);

        var query = doc.DocumentNode.Descendants("select");
        foreach (var item in query.ToList())
        {
            var newNodeStr = "<div></div>";
            var newNode = HtmlNode.CreateNode(newNodeStr);
            item.ParentNode.ReplaceChild(newNode, item);
        }

        File.WriteAllText(currDir + "\\outputFile.html", output);

        writer.Write(renderedContent);
    }
} 
```

我在另一个关于用 HtmlAgilityPack 替换节点的SO[帖子中调整了这个解决方案：](https://stackoverflow.com/questions/6782500/htmlagilitypack-replace-node)

```
var htmlStr = "<b>bold_one</b><strong>strong</strong><b>bold_two</b>";
var doc = new HtmlDocument();
doc.LoadHtml(htmlStr);

var query = doc.DocumentNode.Descendants("b");
foreach (var item in query.ToList())
{
    var newNodeStr = "<foo>bar</foo>";
    var newNode = HtmlNode.CreateNode(newNodeStr);
    item.ParentNode.ReplaceChild(newNode, item);
} 
```

这是我要更改的渲染 HTML：

```
<select name="Archives" onchange="javascript:setTimeout(&#39;__doPostBack(\&#39;Archives\&#39;,\&#39;\&#39;)&#39;, 0)" id="Archives" style="width:200px;">
    <option selected="selected" value="Dashboard_Jul-2012">Dashboard_Jul-2012</option>
    <option value="Dashboard_Jun-2012">Dashboard_Jun-2012</option>
</select> 
```

对 Replace 的两个调用按预期工作并删除了按钮。但是这一行：

```
var query = doc.DocumentNode.Descendants("select"); 
```

正在抛出此错误：

```
Method not found: 'Int32 System.Environment.get_CurrentManagedThreadId()'. 
```

任何建议表示赞赏。

问候。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T07:38:15.907

似乎您在针对 .Net 或更低版本的项目中使用敏捷包的 .Net 4.5 版本，您只需将 Dll 的引用更改为为您的 Framework 版本编译的引用，或者将您的项目更改为 .Net 4.5 （如果您使用的是 VS 2012）。

# macos - OpenGL 3.2 不能在带有 GLFW 的 mac os x 上工作，不能绘制任何东西

> ID：12041664
> 
> 赞同：1
> 
> 时间：2012-08-20T16:42:52.567
> 
> 标签：macos, opengl, glfw

我正在使用 GLFW 和 GLEW 设置一个 OpenGL 3.2 Xcode 项目。我已将 GLFW 包含路径添加到标头路径，并将 libglfw.a 添加到项目中。我还添加了 cocoa 和 OpenGL 框架。然后我尝试使用这个示例代码：

主.cpp：

```
#include <stdio.h>
#include <string.h>
#include <GL/glew.h>
#include <GL/glfw.h>
#include "math3d.h"

GLuint VBO;

static const char* pVS = "                                                    \n\
#version 150                                                                  \n\
\n\
layout (location = 0) in vec3 Position;                                       \n\
\n\
void main()                                                                   \n\
{                                                                             \n\
gl_Position = vec4(0.5 * Position.x, 0.5 * Position.y, Position.z, 1.0);  \n\
}";

static const char* pFS = "                                                    \n\
#version 150                                                                  \n\
\n\
out vec4 FragColor;                                                           \n\
\n\
void main()                                                                   \n\
{                                                                             \n\
FragColor = vec4(1.0, 0.0, 0.0, 1.0);                                     \n\
}";

static void RenderScene()
{
    glClear(GL_COLOR_BUFFER_BIT);

    glEnableVertexAttribArray(0);
    glBindBuffer(GL_ARRAY_BUFFER, VBO);
    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);

    glDrawArrays(GL_TRIANGLES, 0, 3);

    glDisableVertexAttribArray(0);
    glfwSwapBuffers();
}

static void CreateVertexBuffer()
{
    Vector3f Vertices[3];
    Vertices[0] = Vector3f(-1.0f, -1.0f, 0.0f);
    Vertices[1] = Vector3f(1.0f, -1.0f, 0.0f);
    Vertices[2] = Vector3f(0.0f, 1.0f, 0.0f);

    glGenBuffers(1, &VBO);
    glBindBuffer(GL_ARRAY_BUFFER, VBO);
    glBufferData(GL_ARRAY_BUFFER, sizeof(Vertices), Vertices, GL_STATIC_DRAW);
}

static void AddShader(GLuint ShaderProgram, const char* pShaderText, GLenum ShaderType)
{
    GLuint ShaderObj = glCreateShader(ShaderType);

    if (ShaderObj == 0) {
        fprintf(stderr, "Error creating shader type %d\n", ShaderType);
        return ;
    }

    const GLchar* p[1];
    p[0] = pShaderText;
    GLint Lengths[1];
    Lengths[0]= strlen(pShaderText);
    glShaderSource(ShaderObj, 1, p, Lengths);
    glCompileShader(ShaderObj);
    GLint success;
    glGetShaderiv(ShaderObj, GL_COMPILE_STATUS, &success);
    if (!success) {
        GLchar InfoLog[1024];
        glGetShaderInfoLog(ShaderObj, 1024, NULL, InfoLog);
        fprintf(stderr, "Error compiling shader type %d: '%s'\n", ShaderType, InfoLog);
        return;
    }

    glAttachShader(ShaderProgram, ShaderObj);
}

static void CompileShaders()
{
    GLuint ShaderProgram = glCreateProgram();

    if (ShaderProgram == 0) {
        fprintf(stderr, "Error creating shader program\n");
        return;
    }

    AddShader(ShaderProgram, pVS, GL_VERTEX_SHADER);
    AddShader(ShaderProgram, pFS, GL_FRAGMENT_SHADER);

    GLint Success = 0;
    GLchar ErrorLog[1024] = { 0 };

    glLinkProgram(ShaderProgram);
    glGetProgramiv(ShaderProgram, GL_LINK_STATUS, &Success);
    if (Success == 0) {
        glGetProgramInfoLog(ShaderProgram, sizeof(ErrorLog), NULL, ErrorLog);
        fprintf(stderr, "Error linking shader program: '%s'\n", ErrorLog);
        return;
    }

    glValidateProgram(ShaderProgram);
    glGetProgramiv(ShaderProgram, GL_VALIDATE_STATUS, &Success);
    if (!Success) {
        glGetProgramInfoLog(ShaderProgram, sizeof(ErrorLog), NULL, ErrorLog);
        fprintf(stderr, "Invalid shader program: '%s'\n", ErrorLog);
        return;
    }

    glUseProgram(ShaderProgram);
}

int main(int argc, char** argv)
{
    glfwInit();
    glfwOpenWindowHint(GLFW_OPENGL_VERSION_MAJOR, 3);
    glfwOpenWindowHint(GLFW_OPENGL_VERSION_MINOR, 2);
    glfwOpenWindowHint(GLFW_OPENGL_PROFILE,GLFW_OPENGL_CORE_PROFILE);
    glfwOpenWindow(600, 600, 0, 0, 0, 0, 0, 0, GLFW_WINDOW);

    GLenum err = glewInit();
    if (GLEW_OK != err)
    {
        /* Problem: glewInit failed, something is seriously wrong. */
        fprintf(stderr, "Error: %s\n", glewGetErrorString(err));
    }

    CreateVertexBuffer();

    CompileShaders();
    glClearColor(1.0f, 1.0f, 0.0f, 1.0f);
   while (1)
   {
       RenderScene();
   }

    return 0;
} 
```

数学3d.h：

```
#ifndef GLFWTest_math3d_h
#define GLFWTest_math3d_h

struct Vector3f
{
    float x;
    float y;
    float z;

    Vector3f()
    {
    }

    Vector3f(float _x, float _y, float _z)
    {
        x = _x;
        y = _y;
        z = _z;
    }
};
#endif 
```

但什么都没有画出来，我只得到一个黄色的窗口。知道为什么会这样吗？我正在使用安装了 osx lion 的一年左右的 mac book pro

# java - 为什么我有时会在 Java 和 PHP 中得到不同的 SHA256 哈希？

> ID：12041666
> 
> 赞同：2
> 
> 时间：2012-08-20T16:42:57.277
> 
> 标签：java, php, sha256

所以我对 PHP 中的散列函数有一个奇怪的小问题。它只在某些时候发生，这让我感到困惑。本质上，我有一个 Java 应用程序和一个 PHP 页面，它们都计算相同字符串的 SHA256。两者之间没有任何问题，因为它们（通常）计算相同的哈希值。一个例外是每隔一段时间，PHP 的输出就会比 Java 的输出长一个字符。

我在 PHP 中有这段代码：

```
$token = $_GET["token"];
$token = hash("sha256", $token."<salt>");
echo "Your token is " . $token; 
```

99% 的时间，我得到了正确的哈希值。但每隔一段时间，我就会得到这样的东西（添加空间以显示差异）：

```
26be60ec9a36f217df83834939cbefa33ac798776977c1970f6c38ba1cf92e92 # PHP
26be60ec9a36f217df83834939cbefa33ac798776977c197 f6c38ba1cf92e92 # Java 
```

如您所见，它们几乎相同。但是出于某种原因，顶部的（由 PHP 计算）还有一个 0。我还没有真正注意到它的韵律或理由，但它确实难倒了我。我尝试过考虑诸如错误编码或错误返回值之类的事情，但没有一个能真正解释为什么除了那个字符之外它们几乎相同。

对此问题的任何帮助将不胜感激。

编辑：该空间仅位于底部以突出显示额外 0 的位置。实际的散列没有空格，并且确实是一个有效的散列，因为它与 Java 生成的散列相同。

EDIT2：对此感到抱歉。我用记事本++检查了长度，由于它与我的普通文本编辑器不同，我误读了1个长度。所以是的，上面的确实是正确的。这意味着这是我的 Java 代码中的一个错误。我将探索伊格纳西奥的答案并回复你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T16:57:33.067

顶部哈希是正确的长度；输出底部哈希是因为十六进制值在输出时未填充零（请注意，它是一个字节的 MSn）。因此，Java 程序中存在与哈希算法无关的错误。

```
>>> '%04x %02x%02x %x%x' % (0x1201, 0x12, 0x01, 0x12, 0x01)
'1201 1201 121' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T16:57:56.637

实际上，它是 SECOND 哈希，它的长度似乎不正确（63）。难道它是通过组装两个不同的令牌生成的，也许最后一个 - 应该是 16 个字符 - 删除了初始零？

# c++ - Eclipse Linux 库存“Hello World”-应用程序无法运行

> ID：12041668
> 
> 赞同：0
> 
> 时间：2012-08-20T16:43:01.503
> 
> 标签：c++, linux, eclipse, eclipse-cdt

我一直在 VS2010 中使用 C++ 进行开发，但现在我正在尝试将我的应用程序转换为在 Linux 下构建和运行。所以我在 Ubuntu linux 机器上安装了 Eclipse Indigo 和 CDT 包。

当我为 C++ 创建股票“Hello World”项目时，我收到了 *经典*的“Binary not found”错误消息。我已经梳理了互联网，但没有找到解决方案。

通过我的发现，我去了：

```
Project -> Properties -> C/C++ Build -> Tool Chain Editor 
```

并将`Current Toolchain`Linux GCC 更改为 MinGW GCC。但是重建项目后，我仍然有相同的错误消息。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T16:59:22.890

gcc 包不一定包含 C++ 编译器。尝试：

```
whereis g++ 
```

在命令行（或`g++ -v`）上检查是否已安装...

# jquery - 如何将滚动添加到这个具有加载动画的 div 上？

> ID：12041669
> 
> 赞同：0
> 
> 时间：2012-08-20T16:43:04.767
> 
> 标签：jquery, scroll, jquery-animate, position, overflow

我需要能够滚动的 div 是`timeView`div：我需要它在 timeholder div 中滚动，最好有一个自定义滚动条，但这不是必需的。我已经尝试过插件和 css 解决方案，但没有一个可用。我最好在 jquery 中寻找解决方案...

```
<aside class="timeContainer">
    <div class="timeHolder">
        <div class="timeView">

<!-- Year Markers -->            
                <div class="yearMarker">1943</div><div class="yearMarker">1944</div><div class="yearMarker">1945</div><div class="yearMarker">1946</div><div class="yearMarker">1947</div><div class="yearMarker">1948</div><div class="yearMarker">1949</div><div class="yearMarker">1950</div><div class="yearMarker">1951</div><div class="yearMarker">1952</div><div class="yearMarker">1953</div><div class="yearMarker">1954</div><div class="yearMarker">1955</div><div class="yearMarker">1956</div><div class="yearMarker">1957</div><div class="yearMarker">1958</div><div class="yearMarker">1959</div><div class="yearMarker">1960</div><div class="yearMarker">1961</div><div class="yearMarker">1962</div><div class="yearMarker">1963</div><div class="yearMarker">1964</div><div class="yearMarker">1965</div><div class="yearMarker">1966</div><div class="yearMarker">1967</div><div class="yearMarker">1967</div><div class="yearMarker">1969</div><div class="yearMarker">1970</div><div class="yearMarker">1971</div><div class="yearMarker">1972</div><div class="yearMarker">1973</div><div class="yearMarker">1974</div><div class="yearMarker">1975</div><div class="yearMarker">1976</div><div class="yearMarker">1977</div><div class="yearMarker">1978</div><div class="yearMarker">1979</div><div class="yearMarker">1980</div><div class="yearMarker">1981</div><div class="yearMarker">1982</div><div class="yearMarker">1983</div><div class="yearMarker">1984</div><div class="yearMarker">1985</div><div class="yearMarker">1986</div><div class="yearMarker">1987</div><div class="yearMarker">1988</div><div class="yearMarker">1989</div><div class="yearMarker">1990</div><div class="yearMarker">1991</div><div class="yearMarker">1992</div><div class="yearMarker">1993</div><div class="yearMarker">1994</div><div class="yearMarker">1995</div><div class="yearMarker">1996</div><div class="yearMarker">1997</div><div class="yearMarker">1998</div><div class="yearMarker">1999</div><div class="yearMarker">2000</div><div class="yearMarker">2001</div><div class="yearMarker">2002</div><div class="yearMarker">2003</div><div class="yearMarker">2004</div><div class="yearMarker">2005</div><div class="yearMarker">2006</div><div class="yearMarker">2007</div><div class="yearMarker">2008</div><div class="yearMarker">2009</div><div class="yearMarker">2010</div><div class="yearMarker">2011</div><div class="yearMarker">2012</div><div class="yearMarker">2013</div><div class="yearMarker">2014</div><div class="yearMarker">2015</div><div class="yearMarker">2016</div><div class="yearMarker">2017</div><div class="yearMarker">2018</div><div class="yearMarker">2019</div>

<!-- End Year Markers -->            

        </div>
    </div>    
</aside> 
```

` CSS：

```
.timeContainer { position: fixed; 
    width: 100px; 
    height: 90%; 
    margin: 2% 0% 5% 0%; 
    top: 0px; 
    right: 30px; 
    overflow:hidden;}

.timeHolder { position: absolute; 
    height: 80%;
    overflow-y: scroll;
    width: 120px;
    margin: 50px 0px 50px 0px; 
    top: 0px; 
    left: 0px;}

.timeView { position:relative; 
    width: 100px; 
    height: 28105px; 
    max-height: 28105px; 
    top: 0px; 
    left: 0px; 
    background-image : url(http://ccl.northwestern.edu/extensions/palette/rgb-color-scale-gradient.png);
 background-repeat:repeat-y; 
    background-position: top left; 
    z-index: 90;; 
}

.yearMarker { position:relative; 
    z-index: 91; 
    top:0px; 
    right: 0px; 
    width: 95px; 
    height: 365px; 
    text-align:right; 
    font-family:Verdana, Geneva, sans-serif; 
    font-weight:bold; 
    color: #000; } 
```

--------------------------下一期 ---------- ------

好的，我有这个准备好的动画，将 timeView div 移动到 2011 年（或 -24820 像素）

现在滚动位置现在设置在 2011 年的顶部，并且不会再向上滚动

这是初始化动画的脚本：

```
$('.timeView').animate({
              easing: 'easeInExpo',         
              top: '-=24820px', 
}, 10000); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T16:57:11.177

设置`top: '-=24820'`与文字滚动不同。如果您想对其进行动画处理，请为我相信的 scrollTop 属性设置动画。

```
$('#yourDiv').animate({
    scrollTop: -24820
}, 2000); 
```

类似的东西我不太确定语法，但实际上会滚动元素，这将允许您在之后正常鼠标滚动。基本上是 top<>scrollTop

**更新：**

如果您尝试正确的 div 会有所帮助：P。TimeView 不是正在滚动的 div。此外，请使用正的 scrollTop 值，因为这与向下滚动滚轮鼠标相同。您显然根本没有试图弄清楚这一点，您只是尝试将我的解决方案复制并粘贴到您的解决方案中。下次请尝试考虑所提供的解决方案如何适用于您的特定问题。无论如何，这里是：

```
$('.timeHolder').animate({         
    scrollTop: 24820,
}, 10000); 
```

# php - 两个时间之间的当前时间

> ID：12041672
> 
> 赞同：0
> 
> 时间：2012-08-20T16:43:21.863
> 
> 标签：php, time, strtotime

`$time1`这是我检测和之间的当前时间的代码`$time2`

```
$time1 = "1700";
$time2 = "0400";

if(intval($time1) > intval($time2))
{
    $open = strtotime("today " . $time1);
    $close = strtotime("tomorrow " . $time2);
}
else
{
    $open = strtotime("today " . $time1);
    $close = strtotime("today " . $time2);      
} 
```

好的，我想做的是模拟汽车商店的营业时间和关闭时间。基本上，汽车店的开闭时间是动态的。假设汽车商店在 1400 开门，早上 0400 关门。所以一个客户访问 0100 的网站，他应该能够看到汽车商店是开门的，而不是关门的。使用我的代码，当客户在 0100 访问时，汽车商店已关闭，因为计时器自动将其设为今天的 1400 时间。这个问题有什么解决办法吗？

我仍在学习，希望能指导我解决我的问题。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T17:04:31.817

使用 PHP 的`DateTime`对象：

```
<?php

$time1 = new DateTime("17:00");
$time2 = new DateTime("04:00");

if ($time2 < $time1) {
    $time1->modify("-1 day");
}

var_dump($time1, $time2); 
```

# c# - C# Excel 互操作排序范围，因此空白单元格到最后，带有数据的单元格向上

> ID：12041673
> 
> 赞同：2
> 
> 时间：2012-08-20T16:43:21.877
> 
> 标签：c#, excel, sorting, excel-interop

我有一个使用 C#-4.0 和 Excel.Interop 从 .dbf 转换的 Excel 97-2003 .xls 电子表格。数据根据 D 列按日期排序。

[http://www.tiikoni.com/tis/view/?id=af4cf69](http://www.tiikoni.com/tis/view/?id=af4cf69)

现在我需要按 G 列对所选范围（如图所示）进行排序，以便空白单元格位于所选范围的底部。

该图像正确显示它，但这只是因为从输入源检索到的数据以正确的顺序输入。如果数据没有按正确的顺序输入，那么空白单元格可能不会从一开始就位于 G 列的底部。

这就是我所拥有的，对每个 D 日期范围（一天）进行排序。

```
 Range incasariSortRange;
    Range sRange;
    int startDateRowIndex = 6; // index of row where a D date starts
    int endDateRowIndex = 6; // index of row where the same D date ends

    public void selectGroupRange()
    {
        for (int r = startDateRowIndex; r < rowIndex; r++)
        {
            if (worksheet.Cells[endDateRowIndex, 4].Value == worksheet.Cells[r, 4].Value)
            {
                endDateRowIndex = r;
            }
            else
            {
                incasariSortRange = worksheet.get_Range("B" + startDateRowIndex, "H" + endDateRowIndex);
                sRange = incasariSortRange.get_Range("G" + startDateRowIndex, "G" + endDateRowIndex);

                // Sort the first 'D' date range's row by wether the cells in column 'G' 
                //of that range have any values (to be the first ones) or not (to be the last ones).
                incasariSortRange.Sort(sRange, XlSortOrder.xlAscending,
                    Type.Missing, Type.Missing, XlSortOrder.xlAscending,
                    Type.Missing, XlSortOrder.xlAscending, XlYesNoGuess.xlNo, Type.Missing,
                    Type.Missing, XlSortOrientation.xlSortColumns, XlSortMethod.xlPinYin, XlSortDataOption.xlSortNormal,
                    XlSortDataOption.xlSortNormal, XlSortDataOption.xlSortNormal);

                // Set the start and end (date) row indexes to the same so the incasariSortRange will be one row only.
                startDateRowIndex = r; // set the start to a new date
                endDateRowIndex = r; // set the end to the same new date
            }
        }
    } 
```

'rowIndex' 是电子表格中最后一行数据之后的行的索引号。

但如此处所示，它对行进行排序，以便 G 列中的空白单元格到达所选范围的顶部。

[http://www.tiikoni.com/tis/view/?id=ea48320](http://www.tiikoni.com/tis/view/?id=ea48320)

我的第二个问题是，在进行此排序后，如何从所选范围中仅选择 G 列中的单元格不为空白的行？- 这样我就可以再次对它们进行排序。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T12:43:17.597

最后我设法做到了这样。

“数据组”是一组在 DATE 列中具有相同值的行，按天分组。“类型”并不真正相关，这只是因为在我的 DataSet.Table[0] 中有一个列，其中有两个可能的值，根据行中的值，该行将被写入工作簿中的第一个或第二个工作表。

“Incasari”是我用来排序的列。像这样，符号、数字、小写字母、大写字母，然后是空格或空字符串；并且该列只有符号、数字、小写字母和空格/空字符串。

```
var sortedDataGroup = datagroup.OrderBy(row =>
{
    var wrapper = new DataRowWrapper(row, type);

    if (wrapper.Incasari != null)
        return wrapper.ContCor.ToLower();
    else
        return "A"; // Capital letters are after lower case letters
}); 
```

这可能不是解决此排序问题的最佳方法，但我找不到更好的方法。

# javascript - 重新编码飞出菜单功能，使父LI的“粘性”

> ID：12041675
> 
> 赞同：1
> 
> 时间：2012-08-20T16:43:26.867
> 
> 标签：javascript, jquery, css, jquery-selectors

我需要一些帮助来弄清楚如何重新编码以下弹出式菜单功能：

```
var site = function() {
    this.navLi = $('#dnoa_nav li ul li').children('ul').hide().end();
    this.init();
};

site.prototype = {  
    init : function() {
        this.setMenu();
    },

    setMenu : function() {
        $.each(this.navLi, function() {
            if ( $(this).children('ul')[0] ) {
                $(this)
                .append('<span />')
                .children('span')
                .addClass('hasChildren')
            }
        });

        this.navLi.hover(function() {
            $(this).find('> ul').stop(true, true).slideDown('fast');
            },
            function() {
            $(this).find('> ul').stop(true, true).hide();       
        });
    }
}

new site(); 
```

您可以在[此处](http://www.dnmockups.com/test/)查看它的运行情况，看看它现在做了什么。一旦你看到它在行动，你就会发现一旦你选择了一个子 LI，我就无法让父 LI 保持“粘性”。例如：**Job Aides** > **Contacts** > **Approved Brokers** ... 我的意思是当子 LI 被鼠标悬停时，父 LI（**Job Aides** and **Contacts**）不会保持悬停状态（**Approved Brokers**）。

我希望脚本做的是在选择子 LI 时保持父 LI 处于悬停状态。看起来像这样：

![在此处输入图像描述](../Images/aa1625de2d3ac71c565351fbadb8a9b2.png)

关于我可以在上面粘贴的功能中调整什么的任何想法？非常感谢您！

***更新***

下面是我的 CSS 的副本（我希望我没有弄得一团糟）：

```
/* DNoA Nav menu */
.hasChildren {
position: absolute;
width: 11px; height: 24px;
background-image: url('/test/img/page/bkgd_navigation_subcell_hint.gif');
right : 0;
bottom: 0;
}

#dnoa_nav {
float: left;
margin: 0;
padding-top: 3px;
padding-left: 19px;
}

#dnoa_nav li a, #dnoa_nav li {
float: left;
}

#dnoa_nav li {
list-style: none;
position: relative;
font-family: "Lucida Grande","Lucida Sans Unicode",Arial,Verdana,sans-serif;
font-size: 14px;
font-weight: bold;
letter-spacing: 0.3px;
}

#dnoa_nav li a {
padding: 17px 16px;
text-decoration: none;
color: white;
}

#dnoa_nav li:hover a {
background-image: url('/test/img/page/bkgd_navigation_cell.jpg');
background-repeat: repeat;
}

/* DNoA Nav submenu */
#dnoa_nav li ul {
display: none;
position: absolute;
left: 0;
top: 100%;
padding: 0;
margin: 0;
}

#dnoa_nav li:hover > ul {
display: block;
}

#dnoa_nav li ul li {
_display: inline; /* for IE6 */
}

#dnoa_nav li ul li a {
background: #eeeeee;
padding-top: 8px;
padding-bottom: 10px;
border-bottom: 1px solid #CCCCCC;
border-left: 1px solid #CCCCCC;
border-right: 1px solid #CCCCCC;
width: 175px;
font-weight: normal;
color: #005CA9;
display: block;
}

#dnoa_nav li ul li, #dnoa_nav li ul li a {
float: none;
background-image: none !important;
}

#dnoa_nav li ul li:hover a {
background: #005ca9;
background-image: url('/test/img/page/bkgd_navigation_subcell_over.gif') !important;
background-repeat: repeat;
color: #FFFFFF;
}

/* DNoA Nav subsubmenu */
#dnoa_nav li ul li ul {
display: none;
position: absolute;
left: 93%;
top: 7px;
padding: 0;
margin: 0;
border-top: 1px solid #CCCCCC;
z-index: 9999;
}

#dnoa_nav li ul li:hover > ul {
display: block;
}

#dnoa_nav li ul li ul li {
_display: inline; /* for IE6 */
}

#dnoa_nav li ul li ul li a {
background: #f8f8f8;
padding-top: 8px;
padding-bottom: 10px;
border-bottom: 1px solid #CCCCCC;
border-left: 1px solid #CCCCCC;
border-right: 1px solid #CCCCCC;
width: 175px;
font-weight: normal;
color: #005CA9;
display: block;
}

#dnoa_nav li ul li ul li, #dnoa_nav li ul li ul li a {
float: none;
background-image: none !important;
}

#dnoa_nav li ul li ul li:hover a {
background: #005ca9;
background-image: url('/test/img/page/bkgd_navigation_subcell_over.gif') !important;
background-repeat: repeat;
color: #FFFFFF;
} 
```

谢谢，

伯克利

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T15:17:56.217

我终于得到了我想要的工作方式……基于 Stack Overflow 的人们帮助我指出了正确的方向这一事实：需要调整的是 CSS，而不是 jQuery 函数。我最终重新学习了 CSS 选择器以及如何使用“大于”符号（“>”）将允许 CSS 仅直接影响父 UL 的直接子 LI ......而不是级联到每个另一个孩子 LI 和 UL（这是我在设计最顶部的 UL 和 LI 时遇到的问题）。因此，对这些语句进行了编辑以使其工作：

```
#dnoa_nav li:hover a {
background-image: url('/test/img/page/bkgd_navigation_cell.jpg');
background-repeat: repeat;
} 
```

被编辑为：

```
#dnoa_nav li:hover > a {
background-image: url('/test/img/page/bkgd_navigation_cell.jpg');
background-repeat: repeat;
} 
```

和这个：

```
#dnoa_nav li ul li:hover a {
background: #005ca9;
background-image: url('/test/img/page/bkgd_navigation_subcell_over.gif');
background-repeat: repeat;
color: #FFFFFF;
} 
```

被编辑为：

```
#dnoa_nav li ul li:hover > a {
background: #005ca9;
background-image: url('/test/img/page/bkgd_navigation_subcell_over.gif');
background-repeat: repeat;
color: #FFFFFF;
} 
```

再次感谢您带领我学习 CSS 选择器，

伯克利

# java - 如何使用 Jsoup 解析相对 url？

> ID：12041676
> 
> 赞同：10
> 
> 时间：2012-08-20T16:43:29.540
> 
> 标签：java, url, jsoup

嗨，我对 Jsoup 有疑问。

我刮了一个页面，得到了很多网址。其中一些是相对网址，例如：`"../index.php"`, `"../admin"`, `"../details.php"`.

我`attr("abs:href")`用来获取绝对网址，但这个链接呈现为`www.domain.com/../admin.php`

我想知道这是否是一个错误。

有没有办法用jsoup获得真正的绝对路径？我该如何解决这个问题？

我也尝试过`absurl("href")`，但没有工作。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-07T23:35:58.160

还有一个不错的选择是使用 abs:href 或 abs:src 属性：

```
String relHref = link.attr("href"); // == "/"
String absHref = link.attr("abs:href"); // "http://jsoup.org/" 
```

这也有描述：http: [//jsoup.org/cookbook/extracting-data/working-with-urls](http://jsoup.org/cookbook/extracting-data/working-with-urls)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-03T23:21:03.757

如果`element`包含相对链接，您将获得如下绝对链接：`element.absUrl("href")`.

但是您必须在**之前为您的相对链接设置基本 URI**（例如`setBaseUri("http://www.myexample.com")`在您的`Document`or上调用`Element`）。

**确保你的基础 Uri 足够长！**

**好的：**

```
element.setBaseUri("http://www.example.com/abc/");
element.attr("href", "../b/here"); 
```

*返回：* `http://www.example.com/b/here`

**坏的：**

```
element.setBaseUri("http://www.example.com/abc/");
element.attr("href", "../../b/here"); 
```

*返回：* `http://www.example.com/../b/here`

--> 你的相对链接对于你的基础 uri 来说太长了！

# php - 将 php 文件加载到弹出窗口并将 php 变量发布到该弹出窗口（使用 onclick）

> ID：12041677
> 
> 赞同：1
> 
> 时间：2012-08-20T16:43:35.950
> 
> 标签：php, javascript, dom, popup

我正在尝试将 $GLABALS 变量发布到另一个 php 文件并让它在弹出窗口中打开并使用 $GLOBLAS 变量的值加载 printOnly.php 文件（它传递 $dom 使用的 xml 文件的名称。

目前它打开弹出窗口但找不到发布的变量的值，但它还将变量加载到现有的导航器窗口中，在该窗口中检索发布的变量的值没有问题。我希望主窗口保留在原始 php 页面上，并且只将表单中调用的文件加载到弹出窗口中。

在原始页面上，我有：

```
<form name ="printView" method ="post" action="printOnly.php" target="popUp" >
    <input type="hidden" name="toPopFile" value="'.$GLOBALS["file"].'" />
    <input type="image" value="submit"  class="button" title="print view" src="graphics/printview.png" align="middle" onclick="javascript:viewClick(\'printOnly.php\')" />
</form> 
```

在要加载到弹出窗口中的文件中，我有：

```
$file=basename($_POST['toPopFile']); // value to be retrieved which is the name of the xml file currently loaded in original php file

$dom = new domDocument;
if (file_exists($file)) {
    $dom->load($file);
    } else {
    exit('Error ! xml file not found.');
} 
```

这是从外部 .js 文件调用的 javascript 函数

```
var view;
function viewClick(url) {
  view= window.open(url,'view text','menubar=yes,scrollbars=yes,resizable=yes,width=640,height=700');
  view.focus();
} 
```

帮助！（保持简单，我可以鹦鹉学舌，但我并不总是明白我在做什么）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T17:03:01.737

您的表单已经使用了一种`POST`方法，所以我将从它开始。这意味着将您的`submit`按钮用作真正的 HTML 提交按钮（即删除`onclick`事件）。然后`onsubmit`在您的帖子中添加一个处理程序：

```
<form name="printView" method ="post" action="printOnly.php" target="popUp" onsubmit="popup(this);"> 
```

在您的 Javascript 中添加此函数以创建弹出窗口，然后将表单提交给它：

```
function popup(form) {
    window.open('', 'formpopup', 'view text','menubar=yes,scrollbars=yes,resizable=yes,width=640,height=700');
    form.target = 'formpopup';
} 
```

# java - 如何测量已经是.class文件的java程序的运行时间

> ID：12041682
> 
> 赞同：0
> 
> 时间：2012-08-20T16:44:00.203
> 
> 标签：java

我想测量编译成 .class 文件的程序的性能。我无法访问代码以向其添加秒表方法。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T16:47:50.863

你可以：

*   使用分析器

*   从另一个您可以编写的类中调用此 Java 代码。`.class`无需源代码即可访问文件内的 Java 方法

*   反编译`.class`文件，注入手表并编译回来

*   使用编译或加载时编织器和 AOP 将手表编织到现有类（本质上与上述相同）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T16:47:43.703

您可以使用 Java 分析器，例如 Java 发行版附带的称为 JVisualVM 的分析器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T17:02:46.403

这个类就像一个程序或库？

1.  图书馆：获取`System.nanoTime`或`System.currentTimeMillis`在此类的创建或运行方法之前以及之后。数学减法你能告诉它需要多长时间。
2.  程序/库：您可以反编译此类并将指令放入测量时间（如上）
3.  程序：您可以使用 JAMON API
4.  PROGRAM（例如SPRING）：使用AOP方法在创建对象之前和解构之后放置指令。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T16:48:50.233

在 Unix/Linux 系统上，您可以尝试该`time`命令。

```
time java myClassFile 
```

# c - 未加载远程 gdb 符号表

> ID：12041685
> 
> 赞同：0
> 
> 时间：2012-08-20T16:44:03.453
> 
> 标签：c, linux, gdbserver

我正在尝试启动远程 gdb 会话。这是我到目前为止所做的。

```
on target m/c.

$ > gdbserver :5555 --attach process_pid

on host from which I need to connect to 

$HOST > gdb
gdb > target remote target_ip:5555
gdb > 
```

但在此之后我无法插入任何断点，它说断点正在等待（未加载符号表）。但如果我继续，我的程序就会崩溃。

我在网上搜索，但我找不到任何关于此的内容。我将非常感谢您的帮助。谢谢。

# reverse-proxy - 如何在 Mac OS X Mountain Lion Server 中设置 Web 代理服务？

> ID：12041686
> 
> 赞同：3
> 
> 时间：2012-08-20T16:44:02.893
> 
> 标签：reverse-proxy, osx-mountain-lion, osx-server, webproxy

我正在尝试利用 Mac OS X Server 中的配置文件，而不是直接修改 Apache 的站点文件来为 eXist XML 数据库添加反向代理条目。映射应该是从 [http://example.com/exist] 到 [http://localhost:8080/exist]。

eXist 已启动并正在运行。

我添加了以下 plist 文件 /Library/Server/Web/Config/apache2/webapps/org.exist-db.plist

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">

<!-- See man pages for webapp.plist(5) and webappctl(8) for information about this example webapp.plist -->

<plist version="1.0">
     <dict>
         <key>includeFiles</key>
         <array>
             <!-- Include files are activated in virtual host when webapp is started -->
         </array>
         <key>launchKeys</key>
         <array>
             <!-- Launchd plists in /Applications/Server.app/Contents/ServerRoot/System/Library/LaunchDaemons are loaded when webapp is started -->
         </array>
         <key>name</key>
         <string>org.exist-db</string>
         <key>displayName</key>
         <!-- Name shown in Server app -->
         <string>eXist Open Source XML Database</string>
         <key>proxies</key>
         <!-- ProxyPass/ProxyPassReverse directives are activated when webapp is started --> 
         <dict>
             <key>/exist</key>
             <!-- Sets up a reverse proxy -->
             <dict>
                 <key>keysAndValues</key>
                 <string/>
                 <key>path</key>
                 <string>/exist</string>
                 <key>urls</key>
                 <!-- URLs comprise a proxy_balancer group -->
                 <array>
                     <string>http://localhost:8080/exist</string>
                 </array>
             </dict>
         </dict>
         <key>requiredModuleNames</key>
         <array>
             <!-- Apache plugin modules are enabled when webapp is started -->
             <string>proxy_module</string>
         </array>
         <key>requiredWebAppNames</key>
         <array>
             <!-- Required web apps are started when this webapp is started -->
         </array>
         <key>installationIndicatorFilePath</key>
         <!-- The presence of this file indicates web app is installed -->
         <string>/Users/cahlander/eXist-trunk</string>
         <key>sslPolicy</key>
         <!-- Determines webapp SSL behavior -->
         <integer>0</integer>
         <!-- 0: default, UseSSLWhenEnabled -->
         <!-- 1:          UseSSLAlways -->
         <!-- 2:          UseSSLOnlyWhenCertificateIsTrustable -->
         <!-- 3:          UseSSLNever -->
         <!-- 4:          UseSSLAndNonSSL -->
     </dict>
</plist> 
```

在本地服务器上运行，去[http://example.com:8080/exist](http://example.com:8080/exist)工作，但从不同的机器，去[http://example.com/exist](http://example.com/exist)没有。此外，“eXist Open Source XML Database”应该在高级设置中显示为 Web 应用程序。它不是。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T02:05:53.603

我已经解决了所有未解决的问题，但遇到了一个新问题。

仅将以下内容作为 org.exist-db.plist 添加到 /Library/Server/Web/Config/apache2/webapps

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">

<!-- See man pages for webapp.plist(5) and webappctl(8) for information about this example webapp.plist -->

<plist version="1.0">
    <dict>
        <key>includeFiles</key>
        <array/>
        <key>launchKeys</key>
        <array/>
        <key>name</key>
        <string>org.exist-db</string>
        <key>displayName</key>
        <!-- Name shown in Server app -->
        <string>eXist Open Source XML Database</string>
        <key>proxies</key>
        <!-- ProxyPass/ProxyPassReverse directives are activated when webapp is started -->
        <dict>
            <key>/exist</key>
            <!-- Sets up a reverse proxy -->
            <dict>
                <key>keysAndValues</key>
                <string/>
                <key>path</key>
                <string>/exist</string>
                <key>urls</key>
                <!-- URLs comprise a proxy_balancer group -->
                <array>
                    <string>http://localhost:8080/exist</string>
                </array>
            </dict>
        </dict>
        <key>requiredModuleNames</key>
        <array>
            <!-- Apache plugin modules are enabled when webapp is started -->
            <string>proxy_module</string>
        </array>
        <key>requiredWebAppNames</key>
        <array>
            <!-- Required web apps are started when this webapp is started -->
        </array>
        <key>startCommand</key>
        <string>/Users/cahlander/eXist-trunk/tools/wrapper/bin/exist.sh start</string>
        <key>stopCommand</key>
        <string>/Users/cahlander/eXist-trunk/tools/wrapper/bin/exist.sh stop</string>
        <key>installationIndicatorFilePath</key>
        <!-- The presence of this file indicates web app is installed -->
        <string>/Users/cahlander/eXist-trunk/VERSION.txt</string>
        <key>sslPolicy</key>
        <!-- Determines webapp SSL behavior -->
        <integer>0</integer>
        <!-- 0: default, UseSSLWhenEnabled -->
        <!-- 1: UseSSLAlways -->
        <!-- 2: UseSSLOnlyWhenCertificateIsTrustable -->
        <!-- 3: UseSSLNever -->
        <!-- 4: UseSSLAndNonSSL -->
    </dict>
</plist> 
```

它开始，但不会停止。该条目确实显示在高级设置中。它不会从 GUI 停止。

以下命令行条目将起作用，但在我停止并重新启动后确实出现了损坏。

sudo webappctl start org.exist-db

sudo webappctl stop org.exist-db

# bash - 将 SSH 中的私钥指定为字符串

> ID：12041688
> 
> 赞同：37
> 
> 时间：2012-08-20T16:44:22.423
> 
> 标签：bash, ssh

我可以使用 -i 选项通过 SSH 连接到服务器来指定私钥：

```
ssh -i ~/.ssh/id_dsa user@hostname 
```

我正在创建一个`id_dsa`从数据库中获取文本的脚本，但我不确定如何将该字符串提供给 SSH。我需要类似的东西：

```
ssh --option $STRING user@hostname 
```

其中`$STRING`包含 的值`id_dsa`。我需要知道`--option`是否有一个。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-04-19T10:42:38.030

尝试以下操作：

```
echo $KEY | ssh -i /dev/stdin username@host command 
```

该键不会出现在 PS 语句中，但由于 stdin 被重定向，它仅对单个命令或隧道有用。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-08-20T17:47:06.337

没有这样的开关——因为它会泄露敏感信息。如果有的话，*任何人都*可以通过执行一个简单的命令来获取您的*私钥。*`ps`

**编辑**：（因为在评论中添加了详细信息）

您确实应该将密钥存储到临时文件中。如果您不使用类似命令`mktemp`创建临时文件，请确保在写入文件之前正确设置权限。

~~确保您运行代理（或 OpenSSH 的代理）进程并使用`<whatever command you use to fetch it form the database> | ssh-add -`~~

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-05-21T00:06:43.757

将加密密钥作为字符串传递是不可取的，但为了这个问题，我会说我遇到了同样的情况，我需要在脚本中将密钥作为字符串传递。我也可以使用存储在文件中的密钥，但脚本的本质是使其非常灵活，包含本身的所有内容是一项要求。所以我曾经分配变量并传递它并按如下方式回显它：

```
#!/bin/bash
KEY="${ YOUR SSH KEY HERE INSIDE }"
echo "${KEY}" | ssh -q -i /dev/stdin username@IP 'hostnamectl'
exit 0 
```

注意： `-q`禁止所有警告

顺便说一句，上面脚本中的捕获点，因为我们使用 echo 它会打印再次不推荐的 ssh 密钥，以隐藏您可以使用 grep grep 一些肯定不会打印但仍然`stdin`会有的东西回声的值。所以最终的cmd可以修改如下：

```
#!/bin/bash
KEY="${ YOUR SSH KEY HERE INSIDE }"
echo "${KEY}" | grep -qw "less" | ssh -q -i /dev/stdin username@IP 'hostnamectl'
exit 0 
```

这对我有用。

# ruby - 使用 best_in_place 的 nil:NilClass 错误的未定义方法“备忘录”

> ID：12041692
> 
> 赞同：0
> 
> 时间：2012-08-20T16:44:59.897
> 
> 标签：ruby, ruby-on-rails-3, json, best-in-place

我为我的应用创建了一个简单的备忘录功能，并使用 best_in_place gem 成功实现了就地编辑。

我遇到的问题是使用就地编辑**创建**`undefined method`新备忘录，以下代码为 nil:NilClass` 返回备忘录

```
#partial for logged in users on homepage
<% provide(:title, current_user.name) %>
<h1>Hey
  <%= current_user.name %>
</h1>
<div class="row-fluid">
  <div class="span12">

    <div class="row-fluid">
      <div class="span6">
        <h2>Memos</h2>
        <ul id="memos" data-update-url="<%= sort_memos_url %>">
            <%# render @memos %>
      <% @memos.each do |memo| %>
        <%= content_tag_for :li, memo do %>
          <%= best_in_place memo, :memo %>
        <% end %>
      <% end %>
        </ul>
        <p><%# link_to "Add a memo", new_memo_path %></p>
    <p><%= best_in_place @memo, :memo, :path => new_memo_path, :nil => "Add a memo" %></p>
       </div>
      <div class="span6"><h2>Coming up...</h2></div>
    </div>
  </div>
</div>

#memos controller
  def index
   @memos = Memo.order("position")
  end

  def show
    @memo = Memo.find(params[:id])
  end

  def new
    @memo = Memo.new
  end

  def create
    @memo = Memo.new(params[:memo])
    if @memo.save
      redirect_to @memo, notice: "Successfully created memo."
    else
      render :new
    end
  end

  def edit
    @memo = Memo.find(params[:id])
  end

  def update
    @memo = Memo.find(params[:id])
    @memo.update_attributes(params[:memo])
    respond_with @memo
  end

  def sort
    params[:memo].each_with_index do |id, index|
      Memo.update_all({position: index+1}, {id: id})
    end 
    render nothing: true
  end

#home page controller
respond_to :html, :json

  def home
    if signed_in?
    @memos = Memo.order("position")
    end
  end

  def sort
    params[:memo].each_with_index do |id, index|
        Memo.update_all({position: index+1}, {id: id})
    end 
    render nothing: true
  end

  def help
  end
end 
```

我是 Rails 和一般编程的新手，所以我确信这是一个简单的修复，尽管如此，我似乎无法修复它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T21:03:44.310

看看（见 3.3.4）：

[http://guides.rubyonrails.org/layouts_and_rendering.html#using-partials](http://guides.rubyonrails.org/layouts_and_rendering.html#using-partials)

使用部分和变量，意味着您需要遵守特定的命名约定。如果您不这样做，那么您需要将变量（从调用视图）与它一起发送。

```
<%= render :partial => "form", :locals => { :zone => @zone } %> 
```

# ios - 为什么第二次在 iOS 上执行事件更快？

> ID：12041695
> 
> 赞同：0
> 
> 时间：2012-08-20T16:45:04.430
> 
> 标签：ios, performance, cocoa-touch

我没有任何支持这一点的核心数据，但通常，您会注意到，您玩过的任何应用程序或正在处理的应用程序，当应用程序首次加载时，执行诸如显示模态视图控制器之类的操作都很慢第一次，但以后的每一次，都非常快。对于我的应用程序，当我第一次呈现模态视图控制器时，大约需要 3 秒，但如果之后我一遍又一遍地执行此操作，则每次只需要不到一秒的时间。这是什么原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T16:49:53.493

缓存。在我的脑海中，图像经常被缓存，如果笔尖也被缓存，我不会感到惊讶。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T17:00:32.060

不，我在我的应用程序中没有注意到这一点。你看到的原因可能是一百种不同的事情，所以我们需要更多的数据来做出明智的答案。

建议您运行 Instruments，将时间窗口缩小到最初的 3 秒暂停，然后查看机器在此期间在做什么。多次运行它并查看 CPU、IO、内存，以及任何可能减慢它的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-20T17:01:43.260

这里有很多可能的解释。

*   有东西被缓存了。第一次，它必须从“磁盘”加载一些东西，第二次它已经在内存中。这可能是整个框架，也可能是操作系统本身的 NIB 或图形资源。
*   内存管理。iOS 没有足够的内存来满足第一次请求。iOS 花了一些时间清理内存，可能会退出后台应用程序。第二次，它已经可用了。
*   可能还有很多其他人。

# javascript - 对象类型滚动到？

> ID：12041696
> 
> 赞同：0
> 
> 时间：2012-08-20T16:45:06.090
> 
> 标签：javascript, html

我正在尝试将对象加载为文本/html，然后在加载后使用 scrollTo() 将其跳转到 200,200。无论我尝试什么，我都无法让它发生。

```
<html>
<object 
    type="text/html"
    id="stats" 
    width="1000" 
    height="300" 
    data="http://slashdot.org"
    onload="document.getElementById('stats').document.body.innerHTML.scrollTo(200,200)">
</object>
</html> 
```

我应该如何抓住物体有什么遗漏吗？

我以 slashdot.org 为例，该页面将位于同一个域中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T18:10:56.467

如果您加载的数据将在同一个域中 - 您可以使用：

```
onload="this.contentDocument.defaultView.scrollTo(200, 200)" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T16:47:13.913

查看您的 javascript 错误控制台。您无法滚动到`innerHTML`. 删除`innerHTML`并查看它是否有效。

# c# - 架构模型、DTO 等。MongoDB、MVC 等

> ID：12041699
> 
> 赞同：0
> 
> 时间：2012-08-20T16:45:28.150
> 
> 标签：c#, asp.net-mvc, mongodb, architecture

我正在推广一个从 sql 和其他数据源获取数据并存储在 mongo db 中的项目。

我有映射到文档的类，例如：

```
public class Event
{
    public virtual int Id { get; set; }
    public virtual int Name { get; set; }
    public virtual int Description { get; set; }
    public virtual IEnumerable<string> Attendees { get; set; }
} 
```

注意 - 标记为虚拟的属性，因为这些类也用于 nhibernate 映射（在某些情况下）

然后，我们有一个单独的用户类/集合：

```
public class User
{
    public virtual int Id { get; set; }
    public virtual int FirstName { get; set; }
    public virtual int LastName { get; set; }
} 
```

例如，在我的应用程序中，我有一个 EventController，它返回一个事件列表。我还希望“真正的”水合用户回来参加我的活动。

所以，目前，我在不同的项目/命名空间中有上述 2 个类 - 事件和用户。在这种情况下，它们位于 MyApp.DTOs 中

然后我有另一个名为 MyApp.Model 的命名空间

几乎重复的类

```
public class Event
{
    public virtual int Id { get; set; }
    public virtual int Name { get; set; }
    public virtual int Description { get; set; }
    public virtual IEnumerable<User> Attendees { get; set; }
}

public class User
{
    public virtual int Id { get; set; }
    public virtual int FirstName { get; set; }
    public virtual int LastName { get; set; }
} 
```

然后，为了让我的控制器保持精简，我有一个返回 Model.Event 的事件服务，并在其中封装了存储库/数据库逻辑：

获取事件文档 (DTOs.Event) 获取用户文档 (DTOs.User) 使用 automapper 创建 Model.User

我只是想知道是否有更好的方法，因为这会导致大量重复代码！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T21:49:25.633

不幸的是，为了使您的模型与您的域不同，您需要进行一些代码重复，尤其是在大多数情况下您的 DTO 与您的模型匹配时。

它主要是一种偏好，但我认为模型应该暴露给您的视图，并且与域或映射的 nh 对象无关。

# jsf-2 - 使用 WELD + Apache CODI 部署应用程序时出错

> ID：12041706
> 
> 赞同：0
> 
> 时间：2012-08-20T16:45:52.823
> 
> 标签：jsf-2, jboss7.x, codi, weld

我将 myfaces-extcdi-core-api-1.0.5.jar 和 myfaces-extcdi-core-impl-1.0.5.jar 添加到类路径中，将少数 bean 标记为 ConversationScoped，现在启动 JBoss 时出现以下错误7.1.0 服务器：（可能是什么原因？？？）

```
 =========================================================================

  JBoss Bootstrap Environment

  JBOSS_HOME: /mnt/data/work/bw-fla/codebase/suite/server/server_compiled

  JAVA: java

  JAVA_OPTS:  -server -XX:+TieredCompilation -Xms64m -Xmx512m -XX:MaxPermSize=256m -Djava.net.preferIPv4Stack=true -Dorg.jboss.resolver.warning=true -Dsun.rmi.dgc.client.gcInterval=3600000 -Dsun.rmi.dgc.server.gcInterval=3600000 -Djboss.modules.system.pkgs=org.jboss.byteman -Djava.awt.headless=true -Djboss.server.default.config=standalone.xml

=========================================================================

18:33:56,799 INFO  [org.jboss.modules] JBoss Modules version 1.1.1.GA
18:33:56,978 INFO  [org.jboss.msc] JBoss MSC version 1.0.2.GA
18:33:57,022 INFO  [org.jboss.as] JBAS015899: JBoss AS 7.1.0.Final "Thunder" starting
18:33:58,106 INFO  [org.xnio] XNIO Version 3.0.3.GA
18:33:58,122 INFO  [org.jboss.as.server] JBAS015888: Creating http management service using socket-binding (management-http)
18:33:58,134 INFO  [org.xnio.nio] XNIO NIO Implementation Version 3.0.3.GA
18:33:58,179 INFO  [org.jboss.remoting] JBoss Remoting version 3.2.2.GA
18:33:58,228 INFO  [org.jboss.as.logging] JBAS011502: Removing bootstrap log handlers
18:33:58,253 INFO  [org.jboss.as.configadmin] (ServerService Thread Pool -- 26) JBAS016200: Activating ConfigAdmin Subsystem
18:33:58,301 INFO  [org.jboss.as.clustering.infinispan] (ServerService Thread Pool -- 31) JBAS010280: Activating Infinispan subsystem.
18:33:58,389 INFO  [org.jboss.as.security] (ServerService Thread Pool -- 44) JBAS013101: Activating Security Subsystem
18:33:58,396 INFO  [org.jboss.as.webservices] (ServerService Thread Pool -- 48) JBAS015537: Activating WebServices Extension
18:33:58,412 INFO  [org.jboss.as.osgi] (ServerService Thread Pool -- 39) JBAS011940: Activating OSGi Subsystem
18:33:58,416 INFO  [org.jboss.as.naming] (ServerService Thread Pool -- 38) JBAS011800: Activating Naming Subsystem
18:33:58,443 INFO  [org.jboss.as.connector] (MSC service thread 1-1) JBAS010408: Starting JCA Subsystem (JBoss IronJacamar 1.0.7.Final)
18:33:58,535 INFO  [org.jboss.as.connector.subsystems.datasources] (ServerService Thread Pool -- 27) JBAS010403: Deploying JDBC-compliant driver class org.h2.Driver (version 1.3)
......
......
......
18:34:07,073 INFO  [org.jboss.weld.deployer] (MSC service thread 1-2) JBAS016008: Starting weld service for deployment test.ear
18:34:07,694 INFO  [org.apache.myfaces.extensions.cdi.core.api.provider.ServiceProvider] (MSC service thread 1-2) org.apache.myfaces.extensions.cdi.core.impl.provider.DefaultServiceProvider installed successfully.
18:34:07,705 INFO  [org.apache.myfaces.extensions.cdi.core.api.provider.ServiceProvider] (MSC service thread 1-2) org.apache.myfaces.extensions.cdi.core.impl.provider.DefaultServiceProviderContext installed successfully.
18:34:07,764 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-2) MSC00001: Failed to start service jboss.deployment.unit."test.ear".WeldService: org.jboss.msc.service.StartException in service jboss.deployment.unit."test.ear".WeldService: org.jboss.weld.exceptions.DefinitionException: Exception List with 1 exceptions:
Exception 0 :
java.lang.ClassCastException: org.apache.myfaces.extensions.cdi.core.impl.provider.DefaultServiceProviderContext cannot be cast to org.apache.myfaces.extensions.cdi.core.api.provider.ServiceProviderContext
    at org.apache.myfaces.extensions.cdi.core.api.provider.ServiceProvider.createServiceProviderContext(ServiceProvider.java:128)
    at org.apache.myfaces.extensions.cdi.core.api.provider.ServiceProvider.loadServices(ServiceProvider.java:121)
    at org.apache.myfaces.extensions.cdi.core.impl.util.ConfiguredArtifactUtils.getConfiguredValueResolvers(ConfiguredArtifactUtils.java:207)
    at org.apache.myfaces.extensions.cdi.core.impl.util.ConfiguredArtifactUtils.resolveFromEnvironment(ConfiguredArtifactUtils.java:121)
    at org.apache.myfaces.extensions.cdi.core.impl.util.CodiUtils.lookupFromEnvironment(CodiUtils.java:633)
    at org.apache.myfaces.extensions.cdi.core.impl.util.CodiUtils.lookupFromEnvironment(CodiUtils.java:512)
    at org.apache.myfaces.extensions.cdi.core.impl.util.ClassDeactivation.getClassDeactivator(ClassDeactivation.java:69)
    at org.apache.myfaces.extensions.cdi.core.impl.util.ClassDeactivation.isClassActivated(ClassDeactivation.java:50)
    at org.apache.myfaces.extensions.cdi.core.impl.activation.ActivationExtension.isActivated(ActivationExtension.java:149)
    at org.apache.myfaces.extensions.cdi.core.impl.activation.ActivationExtension.vetoAlternativeTypes(ActivationExtension.java:63)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at org.jboss.weld.util.reflection.SecureReflections$13.work(SecureReflections.java:264)
    at org.jboss.weld.util.reflection.SecureReflectionAccess.run(SecureReflectionAccess.java:52)
    at org.jboss.weld.util.reflection.SecureReflectionAccess.runAsInvocation(SecureReflectionAccess.java:137)
    at org.jboss.weld.util.reflection.SecureReflections.invoke(SecureReflections.java:260)
    at org.jboss.weld.introspector.jlr.WeldMethodImpl.invokeOnInstance(WeldMethodImpl.java:170)
    at org.jboss.weld.introspector.ForwardingWeldMethod.invokeOnInstance(ForwardingWeldMethod.java:51)
    at org.jboss.weld.injection.MethodInjectionPoint.invokeOnInstanceWithSpecialValue(MethodInjectionPoint.java:154)
    at org.jboss.weld.event.ObserverMethodImpl.sendEvent(ObserverMethodImpl.java:241)
    at org.jboss.weld.event.ObserverMethodImpl.sendEvent(ObserverMethodImpl.java:229)
    at org.jboss.weld.event.ObserverMethodImpl.notify(ObserverMethodImpl.java:207)
    at org.jboss.weld.manager.BeanManagerImpl.notifyObservers(BeanManagerImpl.java:569)
    at org.jboss.weld.manager.BeanManagerImpl.fireEvent(BeanManagerImpl.java:559)
    at org.jboss.weld.bootstrap.events.AbstractContainerEvent.fire(AbstractContainerEvent.java:60)
    at org.jboss.weld.bootstrap.events.AbstractDefinitionContainerEvent.fire(AbstractDefinitionContainerEvent.java:38)
    at org.jboss.weld.bootstrap.events.ProcessAnnotatedTypeImpl.fire(ProcessAnnotatedTypeImpl.java:41)
    at org.jboss.weld.bootstrap.BeanDeployer.addClass(BeanDeployer.java:93)
    at org.jboss.weld.bootstrap.BeanDeployer.addClasses(BeanDeployer.java:115)
    at org.jboss.weld.bootstrap.BeanDeployment.createBeans(BeanDeployment.java:171)
    at org.jboss.weld.bootstrap.WeldBootstrap.deployBeans(WeldBootstrap.java:336)
    at org.jboss.as.weld.WeldContainer.start(WeldContainer.java:82)
    at org.jboss.as.weld.services.WeldService.start(WeldService.java:76)
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811)
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:679)

    at org.jboss.as.weld.services.WeldService.start(WeldService.java:83)
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110) [rt.jar:1.6.0_24]
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603) [rt.jar:1.6.0_24]
    at java.lang.Thread.run(Thread.java:679) [rt.jar:1.6.0_24]
Caused by: org.jboss.weld.exceptions.DefinitionException: Exception List with 1 exceptions:
Exception 0 :
java.lang.ClassCastException: org.apache.myfaces.extensions.cdi.core.impl.provider.DefaultServiceProviderContext cannot be cast to org.apache.myfaces.extensions.cdi.core.api.provider.ServiceProviderContext
    at org.apache.myfaces.extensions.cdi.core.api.provider.ServiceProvider.createServiceProviderContext(ServiceProvider.java:128)
    at org.apache.myfaces.extensions.cdi.core.api.provider.ServiceProvider.loadServices(ServiceProvider.java:121)
    at org.apache.myfaces.extensions.cdi.core.impl.util.ConfiguredArtifactUtils.getConfiguredValueResolvers(ConfiguredArtifactUtils.java:207)
    at org.apache.myfaces.extensions.cdi.core.impl.util.ConfiguredArtifactUtils.resolveFromEnvironment(ConfiguredArtifactUtils.java:121)
    at org.apache.myfaces.extensions.cdi.core.impl.util.CodiUtils.lookupFromEnvironment(CodiUtils.java:633)
    at org.apache.myfaces.extensions.cdi.core.impl.util.CodiUtils.lookupFromEnvironment(CodiUtils.java:512)
    at org.apache.myfaces.extensions.cdi.core.impl.util.ClassDeactivation.getClassDeactivator(ClassDeactivation.java:69)
    at org.apache.myfaces.extensions.cdi.core.impl.util.ClassDeactivation.isClassActivated(ClassDeactivation.java:50)
    at org.apache.myfaces.extensions.cdi.core.impl.activation.ActivationExtension.isActivated(ActivationExtension.java:149)
    at org.apache.myfaces.extensions.cdi.core.impl.activation.ActivationExtension.vetoAlternativeTypes(ActivationExtension.java:63)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at org.jboss.weld.util.reflection.SecureReflections$13.work(SecureReflections.java:264)
    at org.jboss.weld.util.reflection.SecureReflectionAccess.run(SecureReflectionAccess.java:52)
    at org.jboss.weld.util.reflection.SecureReflectionAccess.runAsInvocation(SecureReflectionAccess.java:137)
    at org.jboss.weld.util.reflection.SecureReflections.invoke(SecureReflections.java:260)
    at org.jboss.weld.introspector.jlr.WeldMethodImpl.invokeOnInstance(WeldMethodImpl.java:170)
    at org.jboss.weld.introspector.ForwardingWeldMethod.invokeOnInstance(ForwardingWeldMethod.java:51)
    at org.jboss.weld.injection.MethodInjectionPoint.invokeOnInstanceWithSpecialValue(MethodInjectionPoint.java:154)
    at org.jboss.weld.event.ObserverMethodImpl.sendEvent(ObserverMethodImpl.java:241)
    at org.jboss.weld.event.ObserverMethodImpl.sendEvent(ObserverMethodImpl.java:229)
    at org.jboss.weld.event.ObserverMethodImpl.notify(ObserverMethodImpl.java:207)
    at org.jboss.weld.manager.BeanManagerImpl.notifyObservers(BeanManagerImpl.java:569)
    at org.jboss.weld.manager.BeanManagerImpl.fireEvent(BeanManagerImpl.java:559)
    at org.jboss.weld.bootstrap.events.AbstractContainerEvent.fire(AbstractContainerEvent.java:60)
    at org.jboss.weld.bootstrap.events.AbstractDefinitionContainerEvent.fire(AbstractDefinitionContainerEvent.java:38)
    at org.jboss.weld.bootstrap.events.ProcessAnnotatedTypeImpl.fire(ProcessAnnotatedTypeImpl.java:41)
    at org.jboss.weld.bootstrap.BeanDeployer.addClass(BeanDeployer.java:93)
    at org.jboss.weld.bootstrap.BeanDeployer.addClasses(BeanDeployer.java:115)
    at org.jboss.weld.bootstrap.BeanDeployment.createBeans(BeanDeployment.java:171)
    at org.jboss.weld.bootstrap.WeldBootstrap.deployBeans(WeldBootstrap.java:336)
    at org.jboss.as.weld.WeldContainer.start(WeldContainer.java:82)
    at org.jboss.as.weld.services.WeldService.start(WeldService.java:76)
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811)
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:679)

    at org.jboss.weld.bootstrap.events.AbstractDefinitionContainerEvent.fire(AbstractDefinitionContainerEvent.java:40)
    at org.jboss.weld.bootstrap.events.ProcessAnnotatedTypeImpl.fire(ProcessAnnotatedTypeImpl.java:41)
    at org.jboss.weld.bootstrap.BeanDeployer.addClass(BeanDeployer.java:93)
    at org.jboss.weld.bootstrap.BeanDeployer.addClasses(BeanDeployer.java:115)
    at org.jboss.weld.bootstrap.BeanDeployment.createBeans(BeanDeployment.java:171)
    at org.jboss.weld.bootstrap.WeldBootstrap.deployBeans(WeldBootstrap.java:336)
    at org.jboss.as.weld.WeldContainer.start(WeldContainer.java:82)
    at org.jboss.as.weld.services.WeldService.start(WeldService.java:76)
    ... 5 more

18:34:07,812 ERROR [org.jboss.as] (MSC service thread 1-2) JBAS015875: JBoss AS 7.1.0.Final "Thunder" started (with errors) in 11250ms - Started 578 of 713 services (52 services failed or missing dependencies, 80 services are passive or on-demand)
18:34:08,012 INFO  [org.jboss.as.server] (DeploymentScanner-threads - 2) JBAS015870: Deploy of deployment "test.ear" was rolled back with failure message {"JBAS014671: Failed services" => {"jboss.deployment.unit.\"test.ear\".WeldService" => "org.jboss.msc.service.StartException in service jboss.deployment.unit.\"test.ear\".WeldService: org.jboss.weld.exceptions.DefinitionException: Exception List with 1 exceptions:
Exception 0 :
java.lang.ClassCastException: org.apache.myfaces.extensions.cdi.core.impl.provider.DefaultServiceProviderContext cannot be cast to org.apache.myfaces.extensions.cdi.core.api.provider.ServiceProviderContext
    at org.apache.myfaces.extensions.cdi.core.api.provider.ServiceProvider.createServiceProviderContext(ServiceProvider.java:128)
    at org.apache.myfaces.extensions.cdi.core.api.provider.ServiceProvider.loadServices(ServiceProvider.java:121)
    at org.apache.myfaces.extensions.cdi.core.impl.util.ConfiguredArtifactUtils.getConfiguredValueResolvers(ConfiguredArtifactUtils.java:207)
    at org.apache.myfaces.extensions.cdi.core.impl.util.ConfiguredArtifactUtils.resolveFromEnvironment(ConfiguredArtifactUtils.java:121)
    at org.apache.myfaces.extensions.cdi.core.impl.util.CodiUtils.lookupFromEnvironment(CodiUtils.java:633)
    at org.apache.myfaces.extensions.cdi.core.impl.util.CodiUtils.lookupFromEnvironment(CodiUtils.java:512)
    at org.apache.myfaces.extensions.cdi.core.impl.util.ClassDeactivation.getClassDeactivator(ClassDeactivation.java:69)
    at org.apache.myfaces.extensions.cdi.core.impl.util.ClassDeactivation.isClassActivated(ClassDeactivation.java:50)
    at org.apache.myfaces.extensions.cdi.core.impl.activation.ActivationExtension.isActivated(ActivationExtension.java:149)
    at org.apache.myfaces.extensions.cdi.core.impl.activation.ActivationExtension.vetoAlternativeTypes(ActivationExtension.java:63)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at org.jboss.weld.util.reflection.SecureReflections$13.work(SecureReflections.java:264)
    at org.jboss.weld.util.reflection.SecureReflectionAccess.run(SecureReflectionAccess.java:52)
    at org.jboss.weld.util.reflection.SecureReflectionAccess.runAsInvocation(SecureReflectionAccess.java:137)
    at org.jboss.weld.util.reflection.SecureReflections.invoke(SecureReflections.java:260)
    at org.jboss.weld.introspector.jlr.WeldMethodImpl.invokeOnInstance(WeldMethodImpl.java:170)
    at org.jboss.weld.introspector.ForwardingWeldMethod.invokeOnInstance(ForwardingWeldMethod.java:51)
    at org.jboss.weld.injection.MethodInjectionPoint.invokeOnInstanceWithSpecialValue(MethodInjectionPoint.java:154)
    at org.jboss.weld.event.ObserverMethodImpl.sendEvent(ObserverMethodImpl.java:241)
    at org.jboss.weld.event.ObserverMethodImpl.sendEvent(ObserverMethodImpl.java:229)
    at org.jboss.weld.event.ObserverMethodImpl.notify(ObserverMethodImpl.java:207)
    at org.jboss.weld.manager.BeanManagerImpl.notifyObservers(BeanManagerImpl.java:569)
    at org.jboss.weld.manager.BeanManagerImpl.fireEvent(BeanManagerImpl.java:559)
    at org.jboss.weld.bootstrap.events.AbstractContainerEvent.fire(AbstractContainerEvent.java:60)
    at org.jboss.weld.bootstrap.events.AbstractDefinitionContainerEvent.fire(AbstractDefinitionContainerEvent.java:38)
    at org.jboss.weld.bootstrap.events.ProcessAnnotatedTypeImpl.fire(ProcessAnnotatedTypeImpl.java:41)
    at org.jboss.weld.bootstrap.BeanDeployer.addClass(BeanDeployer.java:93)
    at org.jboss.weld.bootstrap.BeanDeployer.addClasses(BeanDeployer.java:115)
    at org.jboss.weld.bootstrap.BeanDeployment.createBeans(BeanDeployment.java:171)
    at org.jboss.weld.bootstrap.WeldBootstrap.deployBeans(WeldBootstrap.java:336)
    at org.jboss.as.weld.WeldContainer.start(WeldContainer.java:82)
    at org.jboss.as.weld.services.WeldService.start(WeldService.java:76)
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811)
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:679)
"}}
18:34:08,085 INFO  [org.jboss.as.jpa] (MSC service thread 1-2) JBAS011403: Stopping Persistence Unit Service 'test.ear/test-modules-data-ejb.jar#test'
18:34:08,085 INFO  [org.jboss.as.jpa] (MSC service thread 1-3) JBAS011403: Stopping Persistence Unit Service 'test.ear/test-modules-data-ejb.jar#totem'
18:34:08,140 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015877: Stopped deployment test-modules-emucomp-ejb.jar in 130ms
18:34:08,141 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015877: Stopped deployment test-framework.jar in 130ms
18:34:08,142 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-2) JBAS015877: Stopped deployment test-modules-data-ejb.jar in 131ms
18:34:08,160 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-2) JBAS015877: Stopped deployment test-modules-jsfchain.war in 149ms
18:34:08,176 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-3) JBAS015877: Stopped deployment test.ear in 166ms
18:34:08,177 INFO  [org.jboss.as.controller] (DeploymentScanner-threads - 2) JBAS014774: Service status report
JBAS014777:   Services which failed to start:      service jboss.deployment.unit."test.ear".WeldService: org.jboss.msc.service.StartException in service jboss.deployment.unit."test.ear".WeldService: org.jboss.weld.exceptions.DefinitionException: Exception List with 1 exceptions:
Exception 0 :
java.lang.ClassCastException: org.apache.myfaces.extensions.cdi.core.impl.provider.DefaultServiceProviderContext cannot be cast to org.apache.myfaces.extensions.cdi.core.api.provider.ServiceProviderContext
    at org.apache.myfaces.extensions.cdi.core.api.provider.ServiceProvider.createServiceProviderContext(ServiceProvider.java:128)
    at org.apache.myfaces.extensions.cdi.core.api.provider.ServiceProvider.loadServices(ServiceProvider.java:121)
    at org.apache.myfaces.extensions.cdi.core.impl.util.ConfiguredArtifactUtils.getConfiguredValueResolvers(ConfiguredArtifactUtils.java:207)
    at org.apache.myfaces.extensions.cdi.core.impl.util.ConfiguredArtifactUtils.resolveFromEnvironment(ConfiguredArtifactUtils.java:121)
    at org.apache.myfaces.extensions.cdi.core.impl.util.CodiUtils.lookupFromEnvironment(CodiUtils.java:633)
    at org.apache.myfaces.extensions.cdi.core.impl.util.CodiUtils.lookupFromEnvironment(CodiUtils.java:512)
    at org.apache.myfaces.extensions.cdi.core.impl.util.ClassDeactivation.getClassDeactivator(ClassDeactivation.java:69)
    at org.apache.myfaces.extensions.cdi.core.impl.util.ClassDeactivation.isClassActivated(ClassDeactivation.java:50)
    at org.apache.myfaces.extensions.cdi.core.impl.activation.ActivationExtension.isActivated(ActivationExtension.java:149)
    at org.apache.myfaces.extensions.cdi.core.impl.activation.ActivationExtension.vetoAlternativeTypes(ActivationExtension.java:63)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at org.jboss.weld.util.reflection.SecureReflections$13.work(SecureReflections.java:264)
    at org.jboss.weld.util.reflection.SecureReflectionAccess.run(SecureReflectionAccess.java:52)
    at org.jboss.weld.util.reflection.SecureReflectionAccess.runAsInvocation(SecureReflectionAccess.java:137)
    at org.jboss.weld.util.reflection.SecureReflections.invoke(SecureReflections.java:260)
    at org.jboss.weld.introspector.jlr.WeldMethodImpl.invokeOnInstance(WeldMethodImpl.java:170)
    at org.jboss.weld.introspector.ForwardingWeldMethod.invokeOnInstance(ForwardingWeldMethod.java:51)
    at org.jboss.weld.injection.MethodInjectionPoint.invokeOnInstanceWithSpecialValue(MethodInjectionPoint.java:154)
    at org.jboss.weld.event.ObserverMethodImpl.sendEvent(ObserverMethodImpl.java:241)
    at org.jboss.weld.event.ObserverMethodImpl.sendEvent(ObserverMethodImpl.java:229)
    at org.jboss.weld.event.ObserverMethodImpl.notify(ObserverMethodImpl.java:207)
    at org.jboss.weld.manager.BeanManagerImpl.notifyObservers(BeanManagerImpl.java:569)
    at org.jboss.weld.manager.BeanManagerImpl.fireEvent(BeanManagerImpl.java:559)
    at org.jboss.weld.bootstrap.events.AbstractContainerEvent.fire(AbstractContainerEvent.java:60)
    at org.jboss.weld.bootstrap.events.AbstractDefinitionContainerEvent.fire(AbstractDefinitionContainerEvent.java:38)
    at org.jboss.weld.bootstrap.events.ProcessAnnotatedTypeImpl.fire(ProcessAnnotatedTypeImpl.java:41)
    at org.jboss.weld.bootstrap.BeanDeployer.addClass(BeanDeployer.java:93)
    at org.jboss.weld.bootstrap.BeanDeployer.addClasses(BeanDeployer.java:115)
    at org.jboss.weld.bootstrap.BeanDeployment.createBeans(BeanDeployment.java:171)
    at org.jboss.weld.bootstrap.WeldBootstrap.deployBeans(WeldBootstrap.java:336)
    at org.jboss.as.weld.WeldContainer.start(WeldContainer.java:82)
    at org.jboss.as.weld.services.WeldService.start(WeldService.java:76)
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811)
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:679)

18:34:08,206 ERROR [org.jboss.as.server.deployment.scanner] (DeploymentScanner-threads - 1) {"JBAS014653: Composite operation failed and was rolled back. Steps that failed:" => {"Operation step-2" => {"JBAS014671: Failed services" => {"jboss.deployment.unit.\"test.ear\".WeldService" => "org.jboss.msc.service.StartException in service jboss.deployment.unit.\"test.ear\".WeldService: org.jboss.weld.exceptions.DefinitionException: Exception List with 1 exceptions:
Exception 0 :
java.lang.ClassCastException: org.apache.myfaces.extensions.cdi.core.impl.provider.DefaultServiceProviderContext cannot be cast to org.apache.myfaces.extensions.cdi.core.api.provider.ServiceProviderContext
    at org.apache.myfaces.extensions.cdi.core.api.provider.ServiceProvider.createServiceProviderContext(ServiceProvider.java:128)
    at org.apache.myfaces.extensions.cdi.core.api.provider.ServiceProvider.loadServices(ServiceProvider.java:121)
    at org.apache.myfaces.extensions.cdi.core.impl.util.ConfiguredArtifactUtils.getConfiguredValueResolvers(ConfiguredArtifactUtils.java:207)
    at org.apache.myfaces.extensions.cdi.core.impl.util.ConfiguredArtifactUtils.resolveFromEnvironment(ConfiguredArtifactUtils.java:121)
    at org.apache.myfaces.extensions.cdi.core.impl.util.CodiUtils.lookupFromEnvironment(CodiUtils.java:633)
    at org.apache.myfaces.extensions.cdi.core.impl.util.CodiUtils.lookupFromEnvironment(CodiUtils.java:512)
    at org.apache.myfaces.extensions.cdi.core.impl.util.ClassDeactivation.getClassDeactivator(ClassDeactivation.java:69)
    at org.apache.myfaces.extensions.cdi.core.impl.util.ClassDeactivation.isClassActivated(ClassDeactivation.java:50)
    at org.apache.myfaces.extensions.cdi.core.impl.activation.ActivationExtension.isActivated(ActivationExtension.java:149)
    at org.apache.myfaces.extensions.cdi.core.impl.activation.ActivationExtension.vetoAlternativeTypes(ActivationExtension.java:63)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at org.jboss.weld.util.reflection.SecureReflections$13.work(SecureReflections.java:264)
    at org.jboss.weld.util.reflection.SecureReflectionAccess.run(SecureReflectionAccess.java:52)
    at org.jboss.weld.util.reflection.SecureReflectionAccess.runAsInvocation(SecureReflectionAccess.java:137)
    at org.jboss.weld.util.reflection.SecureReflections.invoke(SecureReflections.java:260)
    at org.jboss.weld.introspector.jlr.WeldMethodImpl.invokeOnInstance(WeldMethodImpl.java:170)
    at org.jboss.weld.introspector.ForwardingWeldMethod.invokeOnInstance(ForwardingWeldMethod.java:51)
    at org.jboss.weld.injection.MethodInjectionPoint.invokeOnInstanceWithSpecialValue(MethodInjectionPoint.java:154)
    at org.jboss.weld.event.ObserverMethodImpl.sendEvent(ObserverMethodImpl.java:241)
    at org.jboss.weld.event.ObserverMethodImpl.sendEvent(ObserverMethodImpl.java:229)
    at org.jboss.weld.event.ObserverMethodImpl.notify(ObserverMethodImpl.java:207)
    at org.jboss.weld.manager.BeanManagerImpl.notifyObservers(BeanManagerImpl.java:569)
    at org.jboss.weld.manager.BeanManagerImpl.fireEvent(BeanManagerImpl.java:559)
    at org.jboss.weld.bootstrap.events.AbstractContainerEvent.fire(AbstractContainerEvent.java:60)
    at org.jboss.weld.bootstrap.events.AbstractDefinitionContainerEvent.fire(AbstractDefinitionContainerEvent.java:38)
    at org.jboss.weld.bootstrap.events.ProcessAnnotatedTypeImpl.fire(ProcessAnnotatedTypeImpl.java:41)
    at org.jboss.weld.bootstrap.BeanDeployer.addClass(BeanDeployer.java:93)
    at org.jboss.weld.bootstrap.BeanDeployer.addClasses(BeanDeployer.java:115)
    at org.jboss.weld.bootstrap.BeanDeployment.createBeans(BeanDeployment.java:171)
    at org.jboss.weld.bootstrap.WeldBootstrap.deployBeans(WeldBootstrap.java:336)
    at org.jboss.as.weld.WeldContainer.start(WeldContainer.java:82)
    at org.jboss.as.weld.services.WeldService.start(WeldService.java:76)
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811)
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:679)
"}}}}
18:34:49,235 INFO  [org.jboss.as.logging] JBAS011503: Restored bootstrap log handlers
18:34:49,236 INFO  [org.apache.catalina.core.StandardContext] Container org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].[/] has not been started
18:34:49,237 INFO  [org.apache.coyote.http11.Http11Protocol] Pausing Coyote HTTP/1.1 on http--0.0.0.0-8080
18:34:49,242 INFO  [org.apache.coyote.http11.Http11Protocol] Stopping Coyote HTTP/1.1 on http--0.0.0.0-8080
18:34:49,250 INFO  [com.arjuna.ats.jbossatx] ARJUNA032018: Destroying TransactionManagerService
18:34:49,251 INFO  [com.arjuna.ats.jbossatx] ARJUNA032014: Stopping transaction recovery manager
18:34:49,270 INFO  [org.jboss.as] JBAS015950: JBoss AS 7.1.0.Final "Thunder" stopped in 45ms 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T22:39:14.087

1.  您必须添加 JSF 模块
2.  由于焊接问题，您不能使用单个模块。您必须使用[捆绑包](http://central.maven.org/maven2/org/apache/myfaces/extensions/cdi/bundles/myfaces-extcdi-bundle-jsf20/1.0.5/)

# ruby-on-rails-3 - Rails 生产单个 JS 文件没有预编译？

> ID：12041712
> 
> 赞同：0
> 
> 时间：2012-08-20T16:46:28.673
> 
> 标签：ruby-on-rails-3, http-status-code-404, production-environment

所以我有一个文件**jquery.tmpl.min.js**位于 app/assets/javascripts/ 下，无论出于何种原因，它都没有在我的生产服务器中找到。运行后`rake assets:precompile`它完成，没有任何错误。我所有的其他 javascript 资产都被正确编译并发送到浏览器。在我的开发服务器上找到这个 JS 文件时我没有任何问题。

我的 production.rb 文件中有以下几行：

```
config.serve_static_assets = true
config.assets.compile = true
config.assets.precompile += %w( *.js *.css ) 
```

错误信息：

```
ActionController::RoutingError (No route matches [GET] "/assets/jquery.tmpl.min.js"): 
```

**根据这个问题**编辑：** [https ://github.com/rails/rails/issues/3596](https://github.com/rails/rails/issues/3596)**

 **使用`javascript_include_tag`with 之类的东西`'jquery.ba-url.min'`不会附加 .js 扩展名。最初我有，但后来将其更改为包含 .js 扩展名。然而仍然没有骰子。

**编辑 2** 我尝试添加`//= require jquery.tmpl.min.js`到我的 application.js 但现在当我尝试预编译我的资产时它说它找不到文件。

**编辑 3** 尝试添加`//= require_tree`，但仍然找不到。这让我发疯！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T18:58:32.060

好的，我找到了答案。事实证明，**Edit 2**是我正在寻找的修复程序。问题是我对开发进行了编辑并使用 github 提交到我的生产服务器。但是我忘记将重命名的文件添加到提交中，所以我的所有提交最终都在删除生产服务器上的文件。**

# marklogic - Marklogic 大删除

> ID：12041714
> 
> 赞同：4
> 
> 时间：2012-08-20T16:46:31.130
> 
> 标签：marklogic

我想知道是否有人有删除 Marklogic 中数百万个文档的经验？目前我使用简单的 xqueries 来获取需要删除的文档 uri，然后我使用 corb 批处理整个操作。

一旦我有了 Uris 列表，是否有更快的方法来删除数百万个文档？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T19:13:36.370

有几种方法可以解决这个问题。第一个问题是如何检索文档 uri 的？最好的方法是使用 URI 词典和`cts:uris`or `cts:uri-match`。其次是你如何执行删除。您可以遍历找到的 uri，并调用`xdmp:document-delete`每个，但您可能会考虑跳过以上所有内容，并一起恢复`xdmp:collection-delete`。这似乎非常有效。它确实需要您分配一个唯一的集合标签，并且可以完全删除它。

！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-21T05:10:37.020

调用[`xdmp:spawn`](https://docs.marklogic.com/xdmp:spawn)or[`xdmp:spawn-function`](https://docs.marklogic.com/xdmp:spawn-function)可能比 corb 快一点，仅仅是因为它避免了网络往返。

如果文档是为它组织的，`xdmp:collection-delete`或者`xdmp:directory-delete`也可以更快。但理想情况下，每个集合或目录应该包含大约 1,000-100,000 个文档。

最后，如果你想摆脱一切，清除森林或数据库会快得多。导出您想要保留的内容（可能使用 XQSync）、清除数据库然后重新导入甚至会更快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-21T14:18:08.200

另请注意，如果您启用了目录创建，则删除速度会慢得多。如果您不需要目录（仅 WEBDAV 真正需要），我建议不要使用目录，那么删除速度会快得多。

# iphone - 用于企业分发的自动更新 iOS 应用程序

> ID：12041717
> 
> 赞同：8
> 
> 时间：2012-08-20T16:46:39.303
> 
> 标签：iphone, ios, mobile, cross-platform

是否可以为**企业分发**制作一个透明更新自身的**iOS**应用程序？说“更新”是指完全更新其逻辑。

 **这种方法的一种可能用法是远程维护的自助服务亭 (iPad)。

无法直接更新应用程序二进制文件，但我看到了一些可能性：

1.  具有单个 UIWebView 且逻辑在 HTML5 中实现的应用程序。但是我们不能使用可以在本机应用程序中使用的大多数硬件特定功能。
2.  一些允许使用本机应用程序功能并动态编译或解释的多平台框架（可能基于 HTML5）。
3.  越狱？

**这些真正的工作方法是什么？**

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-20T16:55:08.090

考虑获得[移动设备管理服务](http://www.apple.com/ipad/business/integration/mdm/)。那些很贵。

或者：

首先，启用无线分发。与苹果公司签订每年 300 美元的企业协议。使用应用程序的 IPA 存档和描述性 PLIST 建立一个网站。

然后在应用启动时编写一个 call-home HTTP 请求。您可以提取/解析描述最新版本的相同 PLIST；它有一个捆绑版本。将其与当前运行的包的版本进行比较。

当检测到新版本时，应用程序会关闭，并在下载页面上打开浏览器。以更柔和的方式，只是通知用户有可用的升级。

我从未尝试过直接链接到应用程序的下载包，但试一试。在一个完美的世界里，Safari 会打开并询问“你想下载 MyApp 吗？” 马上。在一个不那么完美的世界里，用户必须点击一个链接然后同意下载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-24T04:35:44.440

我认为这些天您正在寻找的是“Apple 部署计划”。

您批量购买的 iPad 会发送给人们，但您可以远程管理 - 这也意味着管理包括应用程序的远程更新。

我唯一不确定的是您是否可以远程启动应用程序，以便您可以更新和重新启动应用程序。

以下是为远程管理注册设备的指南：

[https://www.apple.com/business/docs/DEP_Guide.pdf](https://www.apple.com/business/docs/DEP_Guide.pdf)

该程序的一个古老但很好的摘要：

[http://www.speirs.org/blog/2014/2/27/understanding-apples-new-deployment-programs](http://www.speirs.org/blog/2014/2/27/understanding-apples-new-deployment-programs)

另请观看有关为企业管理 Apple 设备的 WWDC 视频：

[https://developer.apple.com/videos/wwdc/2015/?id=301](https://developer.apple.com/videos/wwdc/2015/?id=301)**

# c# - Sharepoint webpart 回发问题

> ID：12041718
> 
> 赞同：0
> 
> 时间：2012-08-20T16:46:40.630
> 
> 标签：c#, sharepoint, postback, web-parts

我创建了一个树视图 webpart，如果单击一个节点，它会修改一个 SPList，并清除并重新创建树视图。

因此，当我单击一个节点时，页面会刷新，然后出现树视图功能并编辑列表并重新创建树视图。那么问题是如果我要通过按 F5 来刷新页面，同样的事情会再次发生，即即使我没有单击节点，列表也会再次被修改。

我怀疑像树视图节点选择更改事件之类的东西再次被激活。

当我点击刷新时也会发生这种情况：

![在此处输入图像描述](../Images/51305bb605bcd1a2ae15528585919fa2.png)

是否以某种方式重新发送树单击标志或其他东西？刷新时如何清除它，以免尝试重新发送？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T17:02:26.950

有两种常见的方法可以防止用户刷新页面重复调用回发执行的操作：

1.  在他们正在运行的任何代码中，都会进行某种检查，看看他们是否已经完成了他们将要做的事情。有时这很容易（即他们单击删除了一个项目，但我看到它已被删除），有时这只是不可能或不切实际。

2.  在执行您不想重复的回发后，执行一个`Response.Redirect`（到另一个页面，甚至只是同一页面）。通过在他们点击刷新时这样做，他们的“最后一个动作”不会是过去，而是重定向的结果。当然，如果他们开始使用他们的历史“回去”，他们很容易最终重做你之前做过的任何动作。此操作过程并没有阻止他们有意（或恶意）复制操作，它只是允许他们点击“刷新”而不会意外复制操作。另请注意，这是有代价的。您将需要与客户端来回执行另一个操作，并且您需要重新生成整个页面（这可能会产生性能成本，

# php - 使用 PHPExcel 将数组中的数据转换为数据验证列表

> ID：12041722
> 
> 赞同：1
> 
> 时间：2012-08-20T16:46:53.183
> 
> 标签：php, phpexcel, validation

我有一个可以包含更多 50 个元素的一维数组，我想知道一种将它添加到 excel 单元格中的方法。我正在使用 PHPExcel，我知道我必须使用`PHPExcel_Cell_DataValidation::TYPE_LIST`它，但我没有找到将数组元素传递给 excel 单元格的方法。事实上，我想要的是计算我在这个数组中有多少元素，并在`A`列的单元格中设置与元素数量相同的下拉列表（数据验证列表）。

有人可以给我任何想法吗？

**编辑 - 再解释一点问题：**我有一个块名称列表，我正在尝试创建一个模板文件，用户可以下载该模板文件以更新新块的数据。如果他添加不同的块名称，它将创建一个新块，而不是更新，这就是为什么我想在工作表内“A”列的每个单元格中使用数据验证列表的原因。这样，用户可以选择已经存在的块名称（他不会混淆名称）。此外，他不需要拥有单元格中的所有块，因为他可以更新超过 50 个块的列表中的 2 个块的数据。（如果他有所有的块填充单元格，当他上传模板时，他也会上传他留空的块的数据......我想现在更容易理解我的问题了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T12:21:23.780

我刚刚解决了。我发现了问题：

```
 $blocksList = implode (", ", $blockNames);
    $objPHPExcel = new PHPExcel();
    $objPHPExcel->getProperties()->setCreator("lalala SAS")
                ->setTitle("Bulk Upload Template");
    //Data Validation list
    $objValidation = $objPHPExcel->getActiveSheet()->getCell('B3')->getDataValidation();
    $objValidation->setType(PHPExcel_Cell_DataValidation::TYPE_LIST);
    $objValidation->setErrorStyle(PHPExcel_Cell_DataValidation::STYLE_INFORMATION);
    $objValidation->setAllowBlank(true);
    $objValidation->setShowDropDown(true);
    $objValidation->setErrorTitle('Input error');
    $objValidation->setError('Value is not in list');
    $objValidation->setFormula1('"'.$blocksList.'"'); 
```

问题是我的 $blocksKist 太大，excel 公式只支持 255 个字符。这样，我会将我的添加`$blocksList`到另一张表中并从中读取。

# asp.net - ASP.net 中有没有一种方法可以使用 Jquery 从数据库中获取数据（不使用 Webservices/WebMethods）

> ID：12041724
> 
> 赞同：0
> 
> 时间：2012-08-20T16:47:02.393
> 
> 标签：asp.net, asp.net-ajax

ASP.net 中有没有一种方法可以使用 Jquery Ajax 方法从数据库中获取数据。我知道我可以通过创建 Web 服务轻松访问数据并使用 Ajax 从那里获取数据。我想知道的是，如何从访问数据库而不是创建 Web 服务的简单类方法中获取数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T17:01:39.580

一种方法是编写一个 HTTPHandler 并使用 Jquery 调用该处理程序来检索数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:42:51.810

看看这是一种超级简单（惰性）的方法，可以直接从你的 aspx.cs 文件中定义的公共方法返回：

[asp.net web表单json返回结果](https://stackoverflow.com/questions/5364343/asp-net-web-forms-json-return-result)

示例显示在方法之上放置`[WebMethod]`和属性允许您直接从 ajax 客户端请求调用。`[ScriptMethod(ResponseFormat = ResponseFormat.Json)]`值得考虑保护此方法，以防止来自其他地方的呼叫！

# mysql - “开”子句中的未知列

> ID：12041726
> 
> 赞同：-1
> 
> 时间：2012-08-20T16:47:09.517
> 
> 标签：mysql

我正在处理以下`SELECT`声明：

```
SELECT *
FROM table1
LEFT JOIN table2 ON table2.contentid = table3.id AND table2.tmplid = table1.id
WHERE table2.value = "test" 
```

我收到以下错误：

> 对数据库的查询执行失败 - 'on 子句'中的未知列 'table3.id' »

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T16:50:26.260

这是你的问题：

```
LEFT JOIN table2 ON table2.contentid = table3.id 
```

您的 ON 子句中不能有任何不属于联接的表（在本例中为 table3）。

你是不是这个意思：

```
SELECT *
FROM   table1
       LEFT JOIN table2
              ON table1.id = table2.tmplid
       LEFT JOIN table3
              ON table2.contentid = table3.id
WHERE  table2.value = "test" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T16:49:47.853

您正在引用`table3.id`未在任何地方的 sql 中定义的内容。你的意思是放`table1.id`？

如果你想引用 table3 你需要加入它：

```
SELECT *
FROM table1
LEFT JOIN table3
ON table1.id = table3.someid
LEFT JOIN table2 
ON table2.contentid = table3.id AND table2.tmplid = table1.id
WHERE table2.value = "test" 
```

# php - 远程上传宽度 curl/php

> ID：12041732
> 
> 赞同：1
> 
> 时间：2012-08-20T16:47:20.490
> 
> 标签：php, curl, upload

我有一个问题，我想将文件远程上传到文件工厂，...我成功登录并转到上传页面，但是当我发布字段时出现错误：“未发送文件数据”。有人可以帮忙吗...？

我的代码：

```
//user data
$email="somebody@yahoo.com";
$pass="somepass";
$cookie="cookie.txt";
//url data
$host="http://www.filefactory.com";
$logURL="http://www.filefactory.com/member/login.php";
//postdata
$logPOST="email=".urlencode($email)."&password=".urlencode($pass);
//login
$ch=curl_init();
curl_setopt($ch, CURLOPT_URL, $logURL);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_COOKIEJAR, $cookie);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $logPOST);

curl_exec($ch);
curl_close($ch);
//go to uploads section
$uploadRefferer="http://www.filefactory.com/u/local/?login=1";
$uploadURL="http://upload.filefactory.com/upload.php";
$filename="@test.png";
//try to upload file
$ch=curl_init();
curl_setopt($ch, CURLOPT_URL, $uploadURL);
curl_setopt($ch, CURLOPT_REFERER, $uploadRefferer);
curl_setopt($ch, CURLOPT_COOKIEFILE, $cookie);
curl_setopt($ch, CURLOPT_COOKIEJAR, $cookie);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, false);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_POSTFIELDS,ALL FIELDS THAT I NEED);
curl_exec($ch); 
```

文件 test.php 位于带有 cookie 和 index.php 的 samo 文件夹中（运行这个）...尝试在 localhost、服务器上，但不工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T17:26:02.297

这将完成工作：

```
curl_setopt($ch, CURLOPT_POSTFIELDS, Array(
   'redirect' => 1,
   'saveTo' => 0,
   'file' => $filename
)); 
```

# php - 脚本识别您在另一台服务器上登录的可能性？

> ID：12041734
> 
> 赞同：-1
> 
> 时间：2012-08-20T16:47:24.993
> 
> 标签：php

因此，如果您在一台服务器上登录，您可以使用一个脚本来提醒另一台服务器（相同域，不同服务器）并根据您登录的事实对 html 进行基本更改。html更改可能是，例如您现在已登录。

如果可能的话，人们将如何处理这样的脚本？

再一次，如果有人登录一个服务器上的站点，是否可以创建一个脚本来提醒（相同域和相同站点）其他服务器，所以当这个登录的人进入该页面时，html 将被更改，因为他们已登录。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T16:51:04.600

您可以尝试使用数据库驱动的会话，然后可能使用一些带有数据库查询的 if 语句？

有关更多详细信息，您可以从这里开始：http: [//php.net/manual/en/function.session-set-save-handler.php](http://php.net/manual/en/function.session-set-save-handler.php)

# iphone - 如何实现 uislider 以便它可以用作 AVQueueplayer 中的清理器

> ID：12041736
> 
> 赞同：1
> 
> 时间：2012-08-20T16:47:37.130
> 
> 标签：iphone, objective-c, ios, xcode, avqueueplayer

我已经使用 UISlider 实现了擦洗，问题是在播放歌曲时滑块不会自动启动，只有当我点击它时它才会开始移动，并且当下一首歌曲开始播放时它会自动移动。我希望滑块在歌曲开始播放时移动，这是我正在使用的代码，当我移动滑块时，歌曲必须快进的另一件事。我已经添加了我写的代码。谁能帮助我出来。谢谢

```
-(IBAction)slider:(id)sender

{
    CMTime interval = CMTimeMake(33, 1000);
    self.playbackObserver = [myPlayer addPeriodicTimeObserverForInterval:interval queue:dispatch_get_current_queue() usingBlock:^(CMTime time) {
        CMTime endTime = CMTimeConvertScale (myPlayer.currentItem.asset.duration, myPlayer.currentTime.timescale, kCMTimeRoundingMethod_RoundHalfAwayFromZero);
        if (CMTimeCompare(endTime, kCMTimeZero) != 0) {
            double normalizedTime = (double) myPlayer.currentTime.value / (double) endTime.value;
            self.timeSlider.value = normalizedTime;
        }
        Float64 currentSeconds = CMTimeGetSeconds(myPlayer.currentTime);
        int mins = currentSeconds/60.0;
        int secs = fmodf(currentSeconds, 60.0);
        NSString *minsString = mins < 10 ? [NSString stringWithFormat:@"0%d", mins] : [NSString stringWithFormat:@"%d", mins];
        NSString *secsString = secs < 10 ? [NSString stringWithFormat:@"0%d", secs] : [NSString stringWithFormat:@"%d", secs];
        currentTimeLabel.text = [NSString stringWithFormat:@"%@:%@", minsString, secsString];

    }];

} 
```

* * *

**编辑**

你能解释一下我哪里错了吗

```
-(IBAction)playButtonPressed:(UIButton *)sender
{
 CMTime interval = CMTimeMake(33, 1000);
    self.playbackObserver = [myPlayer addPeriodicTimeObserverForInterval:interval queue:dispatch_get_current_queue() usingBlock:^(CMTime time)
                             {
                                 CMTime endTime = CMTimeConvertScale (myPlayer.currentItem.asset.duration, myPlayer.currentTime.timescale, kCMTimeRoundingMethod_RoundHalfAwayFromZero);
                                 if (CMTimeCompare(endTime, kCMTimeZero) != 0) {
                                     double normalizedTime = (double) myPlayer.currentTime.value / (double) endTime.value;
                                     self.timeSlider.value = normalizedTime;

                                 }

                             }];
    [myPlayer play];

   }

-(IBAction)slider:(id)sender

{
        Float64 currentSeconds = CMTimeGetSeconds(myPlayer.currentTime);
        int mins = currentSeconds/60.0;
        int secs = fmodf(currentSeconds, 60.0);
        NSString *minsString = mins < 10 ? [NSString stringWithFormat:@"0%d", mins] : [NSString stringWithFormat:@"%d", mins];
        NSString *secsString = secs < 10 ? [NSString stringWithFormat:@"0%d", secs] : [NSString stringWithFormat:@"%d", secs];
        currentTimeLabel.text = [NSString stringWithFormat:@"%@:%@", minsString, secsString];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T17:39:02.363

当您点击 uislider 时，您的观察者将被调用。这就是为什么您必须先点击滑块的原因。将观察者移出`IBAction`并可能将其放入歌曲开始时运行的方法中。

```
-(IBAction)playButtonPressed:(UIButton *)sender
{
 CMTime interval = CMTimeMake(33, 1000);
    self.playbackObserver = [myPlayer addPeriodicTimeObserverForInterval:interval queue:dispatch_get_current_queue() usingBlock:^(CMTime time)
                             {
                                 CMTime endTime = CMTimeConvertScale (myPlayer.currentItem.asset.duration, myPlayer.currentTime.timescale, kCMTimeRoundingMethod_RoundHalfAwayFromZero);
                                 if (CMTimeCompare(endTime, kCMTimeZero) != 0) {
                                     double normalizedTime = (double) myPlayer.currentTime.value / (double) endTime.value;
                                     self.timeSlider.value = normalizedTime;

                                 }
                [self slider:nil];
                             }];
    [myPlayer play];

} 
```

或者您可以查看此答案[UISlider 值更改时会调用什么？](https://stackoverflow.com/questions/4093143/what-gets-called-when-a-uislider-value-changes)并将 valueChange 设置为观察者。

# jquery - .each() 循环在本地工作正常，但一旦上传到服务器就停止工作

> ID：12041741
> 
> 赞同：0
> 
> 时间：2012-08-20T16:48:00.990
> 
> 标签：jquery, xml, loops, each

我正在使用 jQuery 动态填充选择元素。选项标签的内容是从 xml 文档返回的（xml 文件本身实际上是一个 php 文件，但它是作为 xml 生成的）。据我所知，ajax 函数似乎可以工作，但不能正常工作的部分是遍历 xml 的 $.each 循环。真正让我抓狂的是，当在 MAMP 上本地运行时，它一切正常，但一旦上线，它就无法工作。文件结构在线与本地完全相同。

这是xml：

```
<classes>
    <name>MM1</name>
    <name>MM2</name>
    <name>MM3</name>
    <name>MM4</name>
    <name>PR1</name>
    <name>PR2</name>
    <name>PR3</name>
    <name>PR4</name>
</classes> 
```

这是jQuery：

```
var preview_div_top = $('<div class = "preview_div_top"/>');
var form = $('<form action = ""/>');

$.ajax(
{
    type: "GET",
    async: false,
    url: "xml/get_classes.php",
    dataType: "xml",
    success: function(xml)
    {
        var dropdown = '<select class = "class_list">';

        $(xml).find('name').each(function()
        {                       
            var theClass = $(this).text();
            dropdown += '<option value = "' + theClass + '">' + theClass + '</option>';
        });

        dropdown += '</select>';
        $(form).append(dropdown);
        $(form).append('<input type = "submit" class = "get_schedule_btn">');
    } // end success function           
}); // end AJAX

preview_div_top.append(form);
$('.preview .button').after(preview_div_top); 
```

当我将它放在真实的服务器上时，它才停止工作。谁能看到我做错了什么？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-20T16:53:58.287

您需要确保 JavaScript 包含的链接良好。在 Firefox 中使用 Chrome Debugger Net Panel 或 Firebug 扩展等工具。

# javascript - 维基百科搜索 API

> ID：12041747
> 
> 赞同：0
> 
> 时间：2012-08-20T16:48:47.947
> 
> 标签：javascript, html, wikipedia-api

我正在尝试编写维基百科搜索和返回脚本。我想要实现的是，当用户在我的文本框中输入搜索查询时，它会在维基百科中搜索该查询并返回结果。*很简单*。我在使用 Wikipedia API 时遇到问题，并且不完全理解。如果有人可以帮助我或知道对我有益的教程网站，我会很高兴的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T16:53:28.367

看看这个[教程](http://www.labnol.org/internet/tools/using-wikipedia-api-demo-source-code-example/3076/)。可能会有帮助。

# symfony-forms - 如何在 Symfony 2.1 中将 FOSUser Registration & Login 集成到另一个表单中？

> ID：12041751
> 
> 赞同：2
> 
> 时间：2012-08-20T16:49:15.510
> 
> 标签：symfony-forms, symfony-2.1, fosuserbundle

阅读并使用我所拥有的东西，我得出结论，我走在正确的道路上，只需像其他任何形式一样嵌入表单：

```
$builder->add('user', 'fos_user_registration', array(
    'label' => 'Sign up',
    'error_bubbling' => false
)); 
```

而且我一直认为我必须将我的验证组与 FOSUser 的验证组对齐？：

```
public function setDefaultOptions(OptionsResolverInterface $resolver)
{
    $resolver->setDefaults(array(
        'data_class' => 'ACME\ReviewBundle\Entity\Review',
        'flowStep' => 1,
        'validation_groups' => array('Registration', 'Profile')
    ));
} 
```

也许`Default`也有？：

```
 'validation_groups' => array('Default', 'Registration', 'Profile') 
```

* * *

但是，验证仍在通过，它在数据库级别失败，所以我猜我需要做其他事情来分配验证组？

* * *

除此之外，我也不确定这个处理是如何工作的，我可以从 FOSUser 表单处理程序和控制器中提取一部分，但这似乎有点湿，我想知道是否有更好的方法？让这一切都依赖于相同的逻辑会很好。

为了提供一些上下文，我正在使用 CraueFormFlow 并且我有一个用户需要能够启动或不启动的过程。如果他们未经身份验证，则该过程的后续步骤需要他们注册或登录。

我需要保留在身份验证之前收集的数据，据我所知，如果我可以将注册和登录表单嵌入到我的主表单中，这应该自然而然地发生。

注意：我关闭了电子邮件确认，所以这不是问题，并且应该可以使整个过程线性化，用户通过身份验证并提交他们的评论。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T08:43:09.137

原来我需要一个`@Assert`注释，否则验证不适用。

# agile - 如何使用 Code Collaborator 引用另一个文件中的一行？

> ID：12041754
> 
> 赞同：8
> 
> 时间：2012-08-20T16:49:32.293
> 
> 标签：agile, code-collaborator

在文件 foo.cc 的聊天框中，我想引用文件 bar.cc 中的特定行。

比如我`bar.cc:line 12`在我的代码协作聊天框中写了

在这种情况下，code-collab 只识别并允许跳转到`bar.cc`，但不允许跳转到该行。是否可以在 bar.cc 中编写对第 12 行的引用，这样当设计师在聊天框中单击它时，他们会立即跳转到文件中的该行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T14:38:14.850

阅读后，使用 Code collaborator 7 并与我们的服务器支持管理员交谈后，不支持此功能。

如果您希望在下一个版本的 code-collaborator 中看到这种类型的自动链接支持，请在以下 SmartBear 软件支持论坛帖子中投票：

[https://community.smartbear.com/t5/Collaborator-Feature-Requests/Reference-the-Line-of-Another-File-in-the-Same-Review/idi-p/100236](https://community.smartbear.com/t5/Collaborator-Feature-Requests/Reference-the-Line-of-Another-File-in-the-Same-Review/idi-p/100236)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-01T12:24:31.303

适用于所有版本的简单 hack：

在目标文件的指定行上添加注释（或只是绿色勾号）。

然后从“**审阅材料**”部分，在目标文件的指定行上复制链接地址。

现在您有了目标文件指定行的永久链接，您可以将其粘贴到任何地方（阅读：任何评论中的任何文件）以供参考。

# android - 来自texturepacker xml的动画精灵

> ID：12041756
> 
> 赞同：3
> 
> 时间：2012-08-20T16:49:37.923
> 
> 标签：android, andengine, texturepacker

一般是 android dev 和 andengine 的新手。尝试使用 AndEngineTexturePackerExtension 为精灵设置动画，但我不确定如何为动画精灵创建 tiledTextureRegion。以下是我从本论坛的指南和其他帖子中获得的我正在尝试的内容。我从 texturepacker 创建 xml、png 和 java

```
private TexturePackTextureRegionLibrary mSpritesheetTexturePackTextureRegionLibrary;
private TexturePack texturePack;

 try
         {
                 TexturePackLoader texturePackLoader = new TexturePackLoader(activity.getTextureManager());
                 texturePack = texturePackLoader.loadFromAsset(activity.getAssets(), "spritesheet.xml");
                 texturePack.loadTexture();
                 mSpritesheetTexturePackTextureRegionLibrary = texturePack.getTexturePackTextureRegionLibrary();
         }
         catch (TexturePackParseException e)
         {
                 // TODO Auto-generated catch block
                 e.printStackTrace();
         }

 TexturePackerTextureRegion textureRegion = mSpritesheetTexturePackTextureRegionLibrary.
                 get(spritesheet.00000_ID);

TiledTextureRegion tiledTextureRegion = TiledTextureRegion.create(texturePack.getTexture(),
                 textureRegion.getSourceX(), textureRegion.getSourceY(),
                 textureRegion.getSourceWidth() , textureRegion.getSourceHeight() ,
                 COLUMNS, ROWS);

AnimatedSprite sprite = new AnimatedSprite((activity.CAMERA_WIDTH - tiledTextureRegion.getWidth()) / 2,
                 (activity.CAMERA_HEIGHT - tiledTextureRegion.getHeight()) / 2,
                 tiledTextureRegion, activity.getVertexBufferObjectManager()); 
```

问题是我不明白 COLUMNS 和 ROWS 的值来自哪里？精灵表本身具有不均匀的行和列，因为它包括旋转的精灵等。所以我对这些值的来源感到困惑。任何有关使这项工作的帮助都将非常感谢

编辑：好的，如果我只使用纹理打包器中的基本算法而不是 MaxRects 算法，我可以让精灵表动画工作。但这并没有利用工作表中的所有空间，所以我宁愿使用 MaxRects 生成的精灵表让它工作。我在 xml 中看到它传递了一个 bool 来进行旋转或不旋转，所以有信息可以使这项工作我无法弄清楚如何。当一些纹理在工作表上旋转时，我如何使用纹理打包器纹理区域制作动画精灵

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T17:04:11.550

TexturePacker 不知道您的精灵有多少列和行，即使它们是否平铺也不知道，它只是将所有内容打包到一个精灵表中（例如 png 文件）。此外，它的目标不是从分离的 Sprites 创建 TiledSprites。

因此，为了从 spritesheet 中取回 TiledSprite（或 AnimatedSprite），**您必须知道**在放入 spritesheet 之前它有多少列和行（可以在某处硬编码），因为 TexturePacker 不会给你那个种信息。

我个人使用的 TextureRegionFactory 看起来像这样：

```
public class TexturesFactory {

    public static final String SPRITESHEET_DIR = "gfx/spritesheets/";
    public static final String TEXTURES_DIR = SPRITESHEET_DIR+"textures/";

    private TexturePack mTexturePack;
    private TexturePackTextureRegionLibrary mTextureRegionLibrary;

    /**
     * 
     * @param pEngine
     * @param pContext
     * @param filename
     */
    public void loadSpritesheet(Engine pEngine, Context pContext, String filename) {

        try {
            this.mTexturePack = new TexturePackLoader(
                    pEngine.getTextureManager(), TEXTURES_DIR).loadFromAsset(
                            pContext.getAssets(), filename);

            this.mTextureRegionLibrary = this.mTexturePack.getTexturePackTextureRegionLibrary();
            this.mTexturePack.getTexture().load();

        } catch (TexturePackParseException ex) {
            Log.e("Factory", ex.getMessage(), ex);
        }
    }

    public TextureRegion getRegion(int id) {
        return this.mTextureRegionLibrary.get(id);
    }

    public TiledTextureRegion getTiled(int id, final int rows, final int columns) {

        TexturePackerTextureRegion packedTextureRegion = this.mTextureRegionLibrary.get(id);

        return TiledTextureRegion.create(
                packedTextureRegion.getTexture(), 
                (int) packedTextureRegion.getTextureX(), 
                (int) packedTextureRegion.getTextureY(), 
                (int) packedTextureRegion.getWidth(), 
                (int) packedTextureRegion.getHeight(), 
                columns, 
                rows);
    }
} 
```

**编辑：**关于旋转的问题，在TexturePacker生成的xml里面有写，可以通过调用来获取

```
TexturePackerTextureRegion packedTextureRegion = this.mTextureRegionLibrary.get(id);
packedTextureRegion.isRotated() 
```

然后，您可以根据该值创建 tiledTextureRegion：

```
TiledTextureRegion.create(
                packedTextureRegion.getTexture(), 
                (int) packedTextureRegion.getTextureX(), 
                (int) packedTextureRegion.getTextureY(), 
                (int) packedTextureRegion.getWidth(), 
                (int) packedTextureRegion.getHeight(), 
                columns, 
                rows,
                packedTextureRegion.isRotated()); 
```

另外，我希望你清楚 TexturePacker 并不是用来创建平铺的精灵。在使用 TexturePacker**之前**，您必须创建您的平铺精灵（非常适合或行和列） 。

# javascript - 注入元素和 jQuery 脚本。如何让它们协同工作？

> ID：12041759
> 
> 赞同：0
> 
> 时间：2012-08-20T16:49:52.340
> 
> 标签：javascript, jquery

在我的脚本的某些事件中，我执行：

```
$('#myDiv').load('externalelem.php'); 
```

但是，众所周知，新元素不会受到页面完成时执行的功能的影响。像：

```
$(document).ready(function() {
    $('.ttip').tooltip();
} 
```

这些新注入的元素将没有工具提示。我试图：

*   在 load() 之后调用 tooltip()
*   在“externalelem.php”中调用 tooltip()

没有一个工作。有很多脚本受此问题影响。我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T16:50:49.887

只需在新元素添加到 后回忆您的提示功能`DOM`：

```
$('#myDiv').load('externalelem.php', function() {
    $('.ttip').tooltip();
}); 
```

您可以在此处阅读有关使用可选回调处理程序的更多信息：http: [//api.jquery.com/load-event/](http://api.jquery.com/load-event/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T16:52:19.150

使用jquery委托方法！这太棒了！

# jquery - 如何按比例调整溢出列表元素的大小并适合屏幕？

> ID：12041760
> 
> 赞同：0
> 
> 时间：2012-08-20T16:50:00.210
> 
> 标签：jquery, inline, autoresize, window-resize

## 我想做这个：

我有一个包含 N 个元素的内联列表。元素可以分别有不同的宽度，列表可以溢出屏幕。需要设置每个项目的宽度，以便所有元素都适合屏幕。

* * *

**问题：**

但是有一个问题。当你确实将窗口大小调整到最小，然后再次拉伸到初始宽度时，所有元素的宽度就等于——失去了原来的比例，不必要地在每个列表中可以写出各种宽度的文本。

[http://jsfiddle.net/v2pwww/42PdV/2/](http://jsfiddle.net/v2pwww/42PdV/2/)

**可能的解决方案：**

您可以记住数组中每个项目的宽度，并将窗口折叠后的宽度增加到存储在数组中的宽度。联系数组和列表项可以是 arr(N) 和 ul.list li:nth-child(N)。也许还有另一种解决方案。

*而且我不知道该怎么做，请帮助*:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T17:20:52.963

我不知道这是否正是您所追求的，但您可以使用属性来存储初始宽度。

```
 $(document).ready(function() {
    $('ul.list li').each(function(index) {
        $(this).attr("initial-width",$(this).innerWidth());
    }); 
```

然后代替

```
 $(this).innerWidth($(this).innerWidth() - res); 
```

采用

```
 $(this).innerWidth($(this).attr("initial-width") - res); 
```

# c# - windbg，.net 4，随机访问冲突，无法获得托管堆栈跟踪

> ID：12041764
> 
> 赞同：1
> 
> 时间：2012-08-20T16:50:32.197
> 
> 标签：c#, .net-4.0, windbg, access-violation, managed

我有一个非常奇怪的问题，正在尝试追踪它。.Net4 中的 Access_Violation。这是我个人认为可能导致异常的事情的一些背景信息。

1）我有一个监控文件的进程，获取文件并使用.net中的SqlBulkCopy将其转储到数据库中。

2）然后，它遍历数据库中的文件记录，完成后将它们标记为已处理，每组记录在多个线程中处理，因为每组可能需要一段时间。处理组后，它会标记通过存储过程处理的组中的那些记录。
2a) 这些组的处理是使用 SqlBulkCopy 并创建一堆用于创建要发送的通知的其他记录。有一堆数据需要添加/转换，因此，我发现 SqlBulkCopy 是迄今为止最快的方法，否则使用 E​​ntityFramework 将这么多数据放入数据库需要很长时间。

3）在从成功生成的通知数据创建通知的线程中，它可以在通知创建之前对部分数据进行加密。

4) 从数据库中删除旧数据。

注意：我的代码使用标准的 .Net4 库并且没有非托管调用。

这些进程都在以系统用户身份运行的 Windows 服务下运行。我试图尽可能详细地描述我的问题，因为似乎没有人遇到过类似的问题。

这是我尝试过但没有成功的事情。
1) 将服务作为控制台应用程序运行。
2）将文件的处理改为单个线程而不是多个线程。
3) 锁定一个对象，防止同时出现多个SqlBulkCopies。
4) 将 WinDbg 附加到进程以尝试捕获异常并找出它崩溃的位置（我无法捕获它）。我尝试使用 WinDbg，因为它看起来应该捕获异常......它没有，也许我错过了加载某些模块，或者告诉捕获/忽略某个异常

这是我的 WinDbg 命令（粗体）及其输出。我对WinDbg了解不多，所以这一切都只是在黑暗中拍摄。

提前感谢您的所有帮助，-Ed-

```
*This was done right after the service started so I could load the modules and ignore the first chance Access_Violation method*
(fd8.11bc): Break instruction exception - code 80000003 (first chance)
ntdll!DbgBreakPoint:
00000000`77310530 cc              int     3
0:014> **sxd av**
0:014> **.loadby sos clr**
0:014> **.load c:\debugstuff\psscor4.dll**
0:014> **g**
(fd8.c18): Break instruction exception - code 80000003 (first chance)
ntdll!DbgBreakPoint:
00000000`77310530 cc              int     3
0:006> **.reload**
Reloading current modules
................................................................
......................
0:006> **g**
(fd8.e24): Access violation - code c0000005 (first chance)
ntdll!NtTerminateProcess+0xa:
00000000`773115da c3              ret
0:009> **!clr**
No export clr found
0:009> **!clrstack**
OS Thread Id: 0xe24 (9)
Unable to walk the managed stack. The current thread is likely not a 
managed thread. You can run !threads to get a list of managed threads in
the process
0:009> **!threads**
ThreadCount:      10
UnstartedThread:  0
BackgroundThread: 9
PendingThread:    0
DeadThread:       0
Hosted Runtime:   no
                                           PreEmptive                                                   Lock
       ID  OSID        ThreadOBJ     State GC       GC Alloc Context                  Domain           Count APT Exception
XXXX    1   d10 000000000057ca00      a020 Enabled  0000000000000000:0000000000000000 00000000005659c0     0 MTA
XXXX    2  149c 0000000000582d40      b220 Enabled  00000000040ce9a0:00000000040d0958 00000000005659c0     0 MTA (Finalizer)
XXXX    3  1294 00000000005a9f30   100a220 Enabled  0000000000000000:0000000000000000 00000000005659c0     0 MTA (Threadpool Worker)
XXXX    7   cbc 000000001a396670   200b220 Enabled  0000000000000000:0000000000000000 00000000005659c0     1 MTA
XXXX    b  173c 000000001a3f22b0   8009220 Enabled  0000000000000000:0000000000000000 00000000005659c0     0 MTA (Threadpool Completion Port)
XXXX    6  1b2c 000000001a3f37e0   1009220 Enabled  0000000000000000:0000000000000000 00000000005659c0     0 MTA (Threadpool Worker)
XXXX    4   ca0 000000001a3f29c0   1009220 Enabled  0000000000000000:0000000000000000 00000000005659c0     0 MTA (Threadpool Worker)
XXXX    a   da0 000000001a3f5420   1009220 Enabled  0000000004120ba8:0000000004122ad8 00000000005659c0     0 MTA (Threadpool Worker)
XXXX    9   b9c 000000001a3f4d10   1009220 Enabled  0000000000000000:0000000000000000 00000000005659c0     0 MTA (Threadpool Worker)
XXXX    8  1194 000000001a3f4600   1009220 Enabled  0000000004134638:0000000004134b38 00000000005659c0     0 MTA (Threadpool Worker)
0:009> **~1**
        ^ Illegal thread error in '~1'
0:009> **~1s**
        ^ Illegal thread error in '~1s'
0:009> **~**
.  9  Id: fd8.e24 Suspend: 0 Teb: 000007ff`ffef6000 Unfrozen
0:009> **~**
.  9  Id: fd8.e24 Suspend: 0 Teb: 000007ff`ffef6000 Unfrozen
0:009> **~#s;~clrstack**
ntdll!NtTerminateProcess+0xa:
00000000`773115da c3              ret
            ^ Syntax error in '~#s;~clrstack'
0:009> **!eestack**
0:009> **~*k**

.  9  Id: fd8.e24 Suspend: 0 Teb: 000007ff`ffef6000 Unfrozen
Child-SP          RetAddr           Call Site
00000000`1a8fe088 00000000`772e418b ntdll!NtTerminateProcess+0xa
00000000`1a8fe090 000007fe`f9ee8552 ntdll!RtlExitUserProcess+0x9b
00000000`1a8fe0c0 000007fe`f9ee83e4 mscoreei!RuntimeDesc::ShutdownAllActiveRuntimes+0x14a
00000000`1a8fe3b0 000007fe`f2ef8787 mscoreei!CLRRuntimeHostInternalImpl::ShutdownAllRuntimesThenExit+0x14
00000000`1a8fe3e0 000007fe`f2ef980c clr!EEPolicy::ExitProcessViaShim+0x88
00000000`1a8fe430 000007fe`f327cd38 clr!SafeExitProcess+0xdc
00000000`1a8fe6e0 000007fe`f30e8114 clr!EEPolicy::HandleFatalError+0x129
00000000`1a8fecc0 000007fe`f2ecb33c clr! ?? ::FNODOBFM::`string'+0xd51f4
00000000`1a8fecf0 000007fe`f2ecb2f2 clr!CLRVectoredExceptionHandlerPhase2+0x2d
00000000`1a8fed40 000007fe`f2ecb1a1 clr!CLRVectoredExceptionHandler+0xaf
00000000`1a8fedb0 00000000`772da59f clr!CLRVectoredExceptionHandlerShim+0x95
00000000`1a8fede0 00000000`772d8e42 ntdll!RtlpCallVectoredHandlers+0xa8
00000000`1a8fee50 00000000`77311278 ntdll!RtlDispatchException+0x22
00000000`1a8ff530 000007fe`f2e35867 ntdll!KiUserExceptionDispatcher+0x2e
00000000`1a8ffaf0 000007fe`f30b5cab clr!WKS::gc_heap::background_sweep+0x5bd
00000000`1a8ffc50 000007fe`f2e33b56 clr! ?? ::FNODOBFM::`string'+0x9f252
00000000`1a8ffca0 00000000`76bf652d clr!WKS::gc_heap::gc_thread_function+0xd3
00000000`1a8ffcd0 00000000`772ec521 KERNEL32!BaseThreadInitThunk+0xd
00000000`1a8ffd00 00000000`00000000 ntdll!RtlUserThreadStart+0x1d
0:009> **analyze -v**
Couldn't resolve error at 'nalyze -v'
0:009> **!analyze -v**
Last event: fd8.e24: Exit process 0:fd8, code 80131506
  debugger time: Fri Aug 17 18:52:01.744 2012 (GMT-6)
0:009> **!analyze -f**
*******************************************************************************
*                                                                             *
*                        Exception Analysis                                   *
*                                                                             *
*******************************************************************************

Use !analyze -v to get detailed debugging information.

Event is not an exception

Failure could not be analyzed

Last event: fd8.e24: Exit process 0:fd8, code 80131506
  debugger time: Fri Aug 17 18:52:01.744 2012 (GMT-6)
0:009> **.exr 1**
Cannot read Exception record @ 0000000000000001
0:009> **.exr 0**
Cannot read Exception record @ 0000000000000000
0:009> **!dumpstack**
OS Thread Id: 0xe24 (9)
Child-SP         RetAddr          Call Site
000000001a8fe088 00000000772e418b ntdll!NtTerminateProcess+0xa
000000001a8fe090 000007fef9ee8552 ntdll!RtlExitUserProcess+0x9b
000000001a8fe0c0 000007fef9ee83e4 mscoreei!RuntimeDesc::ShutdownAllActiveRuntimes+0x14a
000000001a8fe3b0 000007fef2ef8787 mscoreei!CLRRuntimeHostInternalImpl::ShutdownAllRuntimesThenExit+0x14
000000001a8fe3e0 000007fef2ef980c clr!EEPolicy::ExitProcessViaShim+0x88
000000001a8fe430 000007fef327cd38 clr!SafeExitProcess+0xdc
000000001a8fe6e0 000007fef30e8114 clr!EEPolicy::HandleFatalError+0x129
000000001a8fecc0 000007fef2ecb33c clr! ?? ::FNODOBFM::`string'+0xd51f4
000000001a8fecf0 000007fef2ecb2f2 clr!CLRVectoredExceptionHandlerPhase2+0x2d
000000001a8fed40 000007fef2ecb1a1 clr!CLRVectoredExceptionHandler+0xaf
000000001a8fedb0 00000000772da59f clr!CLRVectoredExceptionHandlerShim+0x95
000000001a8fede0 00000000772d8e42 ntdll!RtlpCallVectoredHandlers+0xa8
000000001a8fee50 0000000077311278 ntdll!RtlDispatchException+0x22
000000001a8ff530 000007fef2e35867 ntdll!KiUserExceptionDispatcher+0x2e
000000001a8ffaf0 000007fef30b5cab clr!WKS::gc_heap::background_sweep+0x5bd
000000001a8ffc50 000007fef2e33b56 clr! ?? ::FNODOBFM::`string'+0x9f252
000000001a8ffca0 0000000076bf652d clr!WKS::gc_heap::gc_thread_function+0xd3
000000001a8ffcd0 00000000772ec521 KERNEL32!BaseThreadInitThunk+0xd
000000001a8ffd00 0000000000000000 ntdll!RtlUserThreadStart+0x1d 
```

我对 WinDbg 非常困惑，只是在黑暗中拍摄希望获得 CLR 堆栈跟踪，但从非托管代码的堆栈跟踪来看，WinDbg 事后抓住了它。

有人对原因和/或解决方法有任何想法吗？或者对从这里去哪里有任何见解？

在 Hans 发表评论之后，这是我对 !VerifyHeap 的结果以及它爆炸的堆转储。

```
0:000> !VerifyHeap
-verify will only produce output if there are errors in the heap
object 0000000002832a90: does not have valid MT
curr_object:      0000000002832a90
Last good object: 0000000002832a78
----------------
0:000> !do 0x2832a78
Free Object
Size:        24(0x18) bytes
0:000> dc 0x2832a78
00000000`02832a78  0055cd90 00000000 00000000 00000000  ..U.............
00000000`02832a88  0055cd90 00000000 000000b0 00000000  ..U.............
00000000`02832a98  000000a8 000007ff 00000000 00010000  ................
00000000`02832aa8  f2792140 000007fe 00453480 000007ff  @!y......4E.....
00000000`02832ab8  00000000 00010000 f2792140 000007fe  ........@!y.....
00000000`02832ac8  00453758 000007ff 00000000 00010000  X7E.............
00000000`02832ad8  f2792140 000007fe 00453a30 000007ff  @!y.....0:E.....
00000000`02832ae8  00000000 00010000 f2792140 000007fe  ........@!y.....
0:000> d
00000000`02832af8  004534f0 000007ff 00000000 00010000  .4E.............
00000000`02832b08  f2792140 000007fe 0045f2c0 000007ff  @!y.......E.....
00000000`02832b18  00000000 00010000 f2792140 000007fe  ........@!y.....
00000000`02832b28  004b1590 000007ff 000000d8 00000000  ..K.............
00000000`02832b38  ffffff28 ffffffff 00000000 000007ff  (...............
00000000`02832b48  00000000 00000000 f1db6728 000007fe  ........(g......
00000000`02832b58  00000064 00450053 0045004c 00540043  d...S.E.L.E.C.T.
00000000`02832b68  00560020 004c0041 00450055 00440020   .V.A.L.U.E. .D. 
```

# bash - Bash脚本，编辑后确认文件的好方法？

> ID：12041765
> 
> 赞同：2
> 
> 时间：2012-08-20T16:50:35.750
> 
> 标签：bash, file, edit

在脚本中，我一直在使用`wc`（字数）在对文件进行更改后检查文件。它有效，但我想知道是否有更好的方法来检查文件。例如，如果我使用`wc -m`并不小心在脚本中放入了一个空行。除非我抓住它并更改预期的输出，否则该脚本将失败`wc -m`。

```
cat <<-EOF > /etc/hosts

192.168.1.1

192.168.1.2

192.168.1.3

EOF

if [ "$(wc -m /etc/hosts" == "33 /etc/hosts" ] ; then

echo it worked

else 

echo it didnt work

fi 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T17:00:19.940

不会有任何普遍良好的验证。您的检查将特定于您认为文件应该是什么样子以及您认为文件应该如何更改。我建议的一件事是在更改文件之前备份文件，以便您可以进行相对检查而不是绝对检查。

# javascript - 等待jquery中getJSON完成的回调

> ID：12041769
> 
> 赞同：2
> 
> 时间：2012-08-20T16:51:01.027
> 
> 标签：javascript, jquery, callback, getjson

我有这样的事情：

```
<div id="content"></div> 
```

和JS：

```
function getData(id) {
    $.getJSON('url/to/jsondata',{id: id}, function(data) {
         /** append some data to div#content  **/
         $('#content').data('key', 'value');
     }); 
```

然后我想在脚本中获取#content 的数据：

```
$(document).ready(function() {
    getData(1); // run getData with some id
    console.log($('#content').data('key'));
}); 
```

问题是在 getJSON 完成回调后 console.log 没有运行，所以我在日志中得到一个未定义的值。哪个是让它工作的正确方法？感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T17:06:57.417

从 ajax 函数返回延迟对象并对其使用 always、done 或 fail 方法：

```
function getData(id) {
    return $.getJSON('url/to/jsondata',{id: id}, function(data) { //return this
         $('#content').data('key', data);
     });
}

$(document).ready(function() {
    getData('content').always(function() { //is returned as deffered object
        console.log($('#content').data('key')); //runs when ajax completed
    });
});​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T16:54:25.370

您已经在调用中定义了回调`getJSON`。要获得结果，请将您的 console.log 代码放在与`/** append some data to div#content **/`注释相同的函数中。

这是 getJSON 的 jQuery 文档，因此您可以查看哪个是正确的参数以及如何布置它：[http ://api.jquery.com/jQuery.getJSON/](http://api.jquery.com/jQuery.getJSON/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-20T16:54:47.677

您应该将日志调用放在回调函数中，如下所示：

```
function getData(id) {
    $.getJSON('url/to/jsondata',{id: id}, function(data) {
         /** append some data to div#content  **/
         $('#content').data('key', 'value');

         console.log($('#content').data('key'));
     }); 
```

# salesforce - Salesforce PageBlockTable 呈现项目的祖父母

> ID：12041773
> 
> 赞同：0
> 
> 时间：2012-08-20T16:51:08.057
> 
> 标签：salesforce, visualforce

我正在尝试在 Visualforce 页面的 pageblocktable 中显示自定义 Salesforce 对象的祖父母。

我可以按预期显示父级，即：

```
<apex:column headerValue="Related Item Parent">
    <apex:outputField id="ItemParent" value="{!item.Parent__c}" />
</apex:column> 
```

效果很好，并给了我一个很好的表格，其中包含一个“相关项目父项”列，该列完全按照我的需要链接到项目父项。

但是当我尝试更上一层楼时，Visualforce 页面编辑器会告诉我

> 无法从值绑定“{!item.Parent_ *c.Parent* _c}”中解析实体。只能与 SObject 字段一起使用。

无论如何，这可以使它起作用吗？我有点卡住了！！

下面是我的 pageBlockTable 的完整列表，如果删除了相关项目祖父母列，它可以正常工作。

```
<apex:pageBlockTable id="RelatedItems" value="{!contact.RelatedItems__r}" var="item">

    <apex:column headerValue="Related Item Name">
        <apex:outputField id="ItemName" value="{!item.Name}" />
    </apex:column>

    <apex:column headerValue="Related Item Parent">
        <apex:outputField id="ItemParent" value="{!item.Parent__c}" />
    </apex:column>

    <apex:column headerValue="Related Item Grandparent">
        <apex:outputField id="ItemGrandParent" value="{!item.Parent__c.Parent__c}" />
    </apex:column>

</apex:pageBlockTable> 
```

非常感谢任何人可以提供的任何帮助。

此致

皮特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T12:39:12.547

引用关系对象的字段时，您将需要使用`__r`后缀。例如，您可以使用`item.Parent__c`来引用父记录的 Id，但访问该记录上的任何字段都需要类似`item.Parent__r.Name`.

在这种情况下，您正在寻找`{!item.Parent__r.Parent__c}`（这将为您提供祖父母的 Id），甚至`{!item.Parent__r.Parent__r.Name}`（如果您希望访问祖父母记录上的字段）。

# sql - 如何获得按一列分组的总数？

> ID：12041778
> 
> 赞同：0
> 
> 时间：2012-08-20T16:51:37.563
> 
> 标签：sql, count

我有一个三列的表（除了id）：

*   话题
*   用户
*   ip

`Topic`不能为空，但其他两个可以。没有独特的限制。

所以数据的一个例子是这样的：

![在此处输入图像描述](../Images/584d1c14cce3bbbb48b9a520f9c0cf2b.png)

我想要得到的是 and 的独特组合`user`，`ip`并计算按主题分组的结果行：

![在此处输入图像描述](../Images/10367aed545956164cf3609e2b57176a.png)

# 编辑：

好的，第一个流行的答案是：

```
SELECT topic, COUNT(IP)
FROM MyTable
GROUP BY topic; 
```

但是我看到您忽略了用户列，为什么？也许我的例子不好:)

让我们添加一条新记录：

![在此处输入图像描述](../Images/de1f590aa3749b9e36ef08cd1e85a5bf.png)

运行上面的查询会给我们同样的结果，但它是错误的：

```
SELECT DISTINCT topic, user, ip FROM MyTable; 
```

它返回：

![在此处输入图像描述](../Images/d14af6ec33af7516809efdbb07eea587.png)

所以在这种情况下，总数将是：

![在此处输入图像描述](../Images/7f8eb9e034b8b50e7a79f84f78769852.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T16:55:26.780

尝试这个：

```
SELECT topic, COUNT(IP)
FROM MyTable
GROUP BY topic 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T16:55:27.627

对于您期望的结果，这是查询：

```
select topic, count(ip)
from YourTable
group by topic 
```

请注意，`COUNT`仅计算非空值。

**更新**

在您的版本和进一步澄清之后，您可以这样做：

```
select topic, count(*)
from (SELECT DISTINCT topic, user, ip FROM YourTable) sel
group by topic 
```

或这个：

```
select topic, count(distinct cast(ip as varchar) + '#' + cast(user as varchar))
from YourTable
group by topic 
```

在第二种方法中，查询可能必须根据您的 RDBMS（您没有指定）而有所不同。数据类型以及连接运算符/函数可能会发生变化。它背后的概念是你不能拥有两个不同`DISTINCT`的`COUNT`列，所以你必须将它们连接起来。该`#`字符只是为了确保`1#11`与 不同`11#1`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T16:55:47.010

```
SELECT Topic, COUNT(*) [Count]
FROM table
WHERE IP IS NOT NULL
GROUP BY Topic 
```

样本：

```
-- preparing the data
DECLARE @tbl TABLE (Topic int, [User] int, IP varchar(20))
INSERT INTO @tbl VALUES
(1,1,null),
(1,1,null),
(1,1,null),
(1,null,'127.0.0.1'),
(1,null,'127.0.0.1'),
(2,1,null),
(2,null,'127.0.0.1'),
(2,null,'127.0.0.1');

-- getting the resuls
SELECT Topic, COUNT(*) [Count]
FROM @tbl
WHERE IP IS NOT NULL
GROUP BY Topic 
```

## 对于已编辑的问题：

```
;WITH TMP AS
(
    SELECT DISTINCT topic, [user], ip
    FROM @tbl
) 
SELECT Topic, COUNT(*)
FROM TMP
GROUP BY Topic 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-20T16:57:04.847

不确定你是否可以这样做

```
select  topic, count(COALESCE(topic,'null') + COALESCE(ip,'null')) from table
group by COALESCE(topic,'null') + COALESCE(ip,'null') 
```

# android - 在 Android 上下载 html 源代码会使应用程序崩溃

> ID：12041786
> 
> 赞同：1
> 
> 时间：2012-08-20T16:52:29.920
> 
> 标签：android, html

我正在尝试将一些网站的代码下载到我的应用程序中，如下所示：

```
 public void wypned(final View pwn) throws IllegalStateException, IOException{
    HttpClient httpClient = new DefaultHttpClient();
    HttpContext localContext = new BasicHttpContext();
    HttpGet httpGet = new HttpGet("http://example.com");
    HttpResponse response = httpClient.execute(httpGet, localContext);
    String result = "";

    BufferedReader reader = new BufferedReader(new InputStreamReader(response.getEntity().getContent() ) );

    String line = null;
    while ((line = reader.readLine()) != null){
    result += line + "\n";
    }
} 
```

我得到的只是致命错误。LogCat 说：

```
Caused by: android.os.NetworkOnMainThreadException
 on Android 3.x and up, you can't do network I/O on the main thread 
```

有人可以告诉我如何解决吗？我试图用线程做一些事情，但没有成功。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T16:56:54.427

为此实现一个 asyncTask ：

```
public class MyAsyncTask extends AsyncTask<Void, Void, Result>{

                        private Activity activity;
                        private ProgressDialog progressDialog;

            public MyAsyncTask(Activity activity) {
                            super();
                this.activity = activity;
            }

            @Override
            protected void onPreExecute() {
            super.onPreExecute();
                progressDialog = ProgressDialog.show(activity, "Loading", "Loading", true);
            }

            @Override
            protected Result doInBackground(Void... v) {
            //do your stuff here
            return null;

            }

            @Override
            protected void onPostExecute(Result result) {
                progressDialog.dismiss();
                Toast.makeText(activity.getApplicationContext(), "Finished.", 
                        Toast.LENGTH_LONG).show();
            }

} 
```

从活动中调用它：

```
MyAsyncTask task = new AsyncTask(myActivity.this);
task.execute(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T16:55:21.493

所有网络操作（因为它们是阻塞的）都应该在一个单独的线程上完成。Android 开发指南建议这样做。

```
android.os.NetworkOnMainThreadException 
```

> 当应用程序尝试在其主线程上执行网络操作时引发的异常。
> 
> 这仅针对面向 Honeycomb SDK 或更高版本的应用程序抛出。允许以早期 SDK 版本为目标的应用程序在其主事件循环线程上进行网络连接，但非常不鼓励这样做。

为您的网络操作创建一个单独的线程，它基本上告诉您。

> 可能长时间运行的操作（如网络或数据库操作）或计算量大的计算（如调整位图大小）应在子线程中完成

[来源 1 来源](http://developer.android.com/reference/android/os/NetworkOnMainThreadException.html) [2](http://developer.android.com/guide/practices/responsiveness.html)

# iphone - 适用于 iOS 的 Facebook 开放图？

> ID：12041787
> 
> 赞同：0
> 
> 时间：2012-08-20T16:52:39.737
> 
> 标签：iphone, ios, facebook, facebook-graph-api, facebook-ios-sdk

我正在尝试在 facebook 的开放图形 API 中实现。我在 facebook 管理页面上创建了一个赞。

我使用与 Facebook 上的应用程序管理员相同的帐户登录设备。应用程序中有一个有效的令牌，我有正确的权限。我还在每个将要被喜欢的页面上添加了必要的标签。

这是试图发布的代码片段：

```
[appDelegate.facebook requestWithGraphPath:@"me/app_namespace:like" andParams:md andHttpMethod:@"POST" andDelegate:appDelegate]; 
```

我收到的错误消息是：

```
 code = 2500;
    message = "Unknown path components: /guidepal:like";
    type = OAuthException; 
```

问题可能是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T13:13:25.990

最好的办法是按照我在这个链接上的回答：[Facebook iOS SDK 3.0, implement like action on a url?](https://stackoverflow.com/questions/12112847/facebook-ios-sdk-3-0-implement-like-action-on-a-url)

如果您保存了访问令牌，它应该在较低的 facebook sdk:s 上工作得很好。

# javascript - 按 Youtube 订阅表格按钮

> ID：12041790
> 
> 赞同：0
> 
> 时间：2012-08-20T16:52:52.583
> 
> 标签：javascript

我尝试编写一个从 Youtube 订阅表单中按下订阅按钮的 JS 代码。

这是 Youtube 订阅表单的链接：[http ://www.youtube.com/subscribe_widget?p=aaaa](http://www.youtube.com/subscribe_widget?p=aaaa)

我试过这个：

```
document.getElementById("subscribe-button").getElementsByTagName("button")[0].click(); 
```

但它给了我这个错误：

```
/*
Exception: document.getElementById("subscribe-button") is null
@Scratchpad:1
*/ 
```

这是按钮的 HTML 代码：

```
<button role="button" id="subscribe-button" class="action-initiator yt-uix-button yt-uix-button-default" type="button" onclick="controller.subscribe(null);return false;"><span class="yt-uix-button-content">Subscribe </span></button> 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T17:03:12.020

```
document.getElementById("subscribe-button") IS the button. 
```

你可以立即调用 click()

# ruby-on-rails-3 - 太阳黑子的分面搜索

> ID：12041793
> 
> 赞同：2
> 
> 时间：2012-08-20T16:53:19.253
> 
> 标签：ruby-on-rails-3, sunspot, sunspot-rails

我正在尝试使用 Sunspot 实现多面搜索，但我一定做错了什么。

```
class Product < ActiveRecord::Base
  attr_accessible :category, :color, :condition, :item_no, :size
  searchable do
    text :color, :size
  end
end 
```

这是我的产品模型，我想在导航一侧有一个菜单，允许使用类别、颜色、条件等过滤结果。

在我的控制器中，我有：

```
 def index

    @search = Product.search do
      fulltext params[:search]
      facet :color
    end
    @products = @search.results

    respond_to do |format|
      format.html
      format.json { render json: @products }
    end
  end 
```

但我不断收到一条错误消息：

```
Sunspot::UnrecognizedFieldError 
No field configured for Product with name 'color' 
```

在我看来：

```
<div id="facets">
  <h3>Category</h3>
  <ul>
    <% for row in @search.facet(:color).rows %>
      <li>
        <% if params[:color].blank? %>
          <%= link_to row.value, :color => row.value %> (<%= row.count %>)
        <% else %>
          <strong><%= row.value %></strong> (<%= link_to "remove", :color => nil %>)
        <% end %>
      </li>
    <% end %>
  </ul>
</div> 
```

谁能指出我做错了什么？

非常感谢您的帮助！

更新：这是错误的一部分。

```
sunspot (1.3.3) lib/sunspot/query/restriction.rb:245:in `to_solr_conditional'
sunspot (1.3.3) lib/sunspot/query/restriction.rb:92:in `to_positive_boolean_phrase'
sunspot (1.3.3) lib/sunspot/query/restriction.rb:72:in `to_boolean_phrase'
sunspot (1.3.3) lib/sunspot/query/filter.rb:11:in `to_filter_query'
sunspot (1.3.3) lib/sunspot/query/scope.rb:5:in `block in to_params'
sunspot (1.3.3) lib/sunspot/query/scope.rb:5:in `map'
sunspot (1.3.3) lib/sunspot/query/scope.rb:5:in `to_params'
sunspot (1.3.3) lib/sunspot/query/common_query.rb:51:in `block in to_params'
sunspot (1.3.3) lib/sunspot/query/common_query.rb:50:in `each'
sunspot (1.3.3) lib/sunspot/query/common_query.rb:50:in `to_params'
sunspot (1.3.3) lib/sunspot/search/abstract_search.rb:37:in `execute'
sunspot_rails (1.3.3) lib/sunspot/rails/searchable.rb:329:in `solr_execute_search'
sunspot_rails (1.3.3) lib/sunspot/rails/searchable.rb:153:in `solr_search' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T17:34:36.073

这里缺少两件事。首先，您需要将颜色作为一个字段包含在内，其次，facet 方法告诉 sunspot（即 solr）返回结果集中存在的所有方面，但不通过该方面来确定查询范围。所以，你需要这样的东西：

```
searchable do
  text :color, :size
  string :color
end

@search = Product.search do
  fulltext params[:search]
  with(:color).all_of(params[:color]) unless params[:color].blank?
  facet :color
end 
```

# asp.net - 为实体框架创建数据库时出现 Mysql 语法错误

> ID：12041802
> 
> 赞同：2
> 
> 时间：2012-08-20T16:54:06.733
> 
> 标签：asp.net, mysql, entity-framework

我第一次玩asp.net。我想将它与 MySQL 数据库一起使用，因为这是我的托管服务提供的，我不想升级/更改服务。我正在使用visual web developer 2010 express。我从默认模板创建了一个 MVC 4 项目。该模板创建了 ASP.NET Simple Membership 对象，这是我正在尝试的工作。使用默认数据库连接字符串时，项目可以正确构建和运行。当我将 web.config 文件更改为指向 MySQL 时，当我尝试导航到帐户文件夹中的任何页面时出现以下错误。

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 2 行的“IDENTITY，RoleName nvarc”附近使用正确的语法

当我打开 MySQL 工作台并连接到本地服务器时，我注意到数据库已经创建。如果我删除数据库并再次运行应用程序，它将重新创建。我注意到它是否创建正确，或者是否创建了整个数据库但那里有一些东西。

显然，实体框架创建的 SQL 语法存在问题。我是否需要在 web.config 文件中添加一些内容来告诉它在创建查询时应该使用什么语法？

这两天我一直在寻找这个问题的答案。任何指向正确方向的帮助将不胜感激。

我正在使用 mysql 服务器版本 5.5.27。和连接器 6.5.4.0

这是我的 web.config 文件的 mysql 部分：

```
 <system.data>
    <DbProviderFactories>
      <remove invariant="MySql.Data.MySqlClient"/>
      <add name="MySQL Data Provider"
           invariant="MySql.Data.MySqlClient"
           description=".Net Framework Data Provider for MySQL"
           type="MySql.Data.MySqlClient.MySqlClientFactory, MySql.Data, Version=6.5.4.0, Culture=neutral, PublicKeyToken=c5687fc88969c44d" />
    </DbProviderFactories>
  </system.data>
  <connectionStrings>
    <add name="DefaultConnection" connectionString="Data Source=.\SQLEXPRESS;Initial Catalog=aspnet-MyWebPage-20120817115958;Integrated Security=SSPI" providerName="System.Data.SqlClient" />
    <add name="myDatabaseConnection" connectionString="server=localhost;Port=3306;uid=root;pwd=****;database=myDatabase;" providerName="MySql.Data.MySqlClient" />        
  </connectionStrings> 
```

编辑添加代码

```
 [AttributeUsage(AttributeTargets.Class | AttributeTargets.Method, AllowMultiple = false, Inherited = true)]
public sealed class InitializeSimpleMembershipAttribute : ActionFilterAttribute
{
    private static SimpleMembershipInitializer _initializer;
    private static object _initializerLock = new object();
    private static bool _isInitialized;

    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        // Ensure ASP.NET Simple Membership is initialized only once per app start
        LazyInitializer.EnsureInitialized(ref _initializer, ref _isInitialized, ref _initializerLock);
    }

    private class SimpleMembershipInitializer
    {
        public SimpleMembershipInitializer()
        {
            Database.SetInitializer<UsersContext>(null);

            try
            {
                using (var context = new UsersContext())
                {
                    if (!context.Database.Exists())
                    {
                        // Create the SimpleMembership database without Entity Framework migration schema
                        ((IObjectContextAdapter)context).ObjectContext.CreateDatabase();
                    }
                }

                WebSecurity.InitializeDatabaseConnection("LocalMySqlServer", "UserProfile", "UserId", "UserName", autoCreateTables: true);
            }
            catch (Exception ex)
            {
                throw new InvalidOperationException("The ASP.NET Simple Membership database could not be initialized. For more information, please see http://go.microsoft.com/fwlink/?LinkId=256588", ex);
            }
        }
    }
}

    public class UsersContext : DbContext
{
    public UsersContext()
        : base("LocalMySqlServer")
    {
    }

    public DbSet<UserProfile> UserProfiles { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T09:17:13.567

尝试修改 SMP 的源并删除特定于 ms sql server 的语法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-14T12:39:23.133

角色提供者仍默认为标准 ASP 角色，它在连接结束时需要一个 SQLServer DB，“身份”是“autoinc”的 SQLServerese。

您可以像这样在 web.config 中设置默认提供程序：-

```
<configuration>
  <system.web>
    <profile defaultProvider="MySQLProfileProvider"></profile>
    <roleManager defaultProvider="MySQLRoleProvider"></roleManager>
  </system.web>
</configuration> 
```

# google-maps-api-3 - 抑制具有多个层的融合表信息窗口

> ID：12041805
> 
> 赞同：0
> 
> 时间：2012-08-20T16:54:21.820
> 
> 标签：google-maps-api-3, google-fusion-tables

我有一个包含两个融合表图层的地图，并且正在使用`suppressInfoWindows`这样一个图层的信息窗口在用户单击另一图层的标记时不会保持打开状态。使用以下代码可以正常工作：

```
<script type="text/javascript">
var map;
var infowindow;

var layer;
var tableid = MY FUSION TABLE ID;

var layer2;
var tableid2 = MY FUSION TABLE ID;

function initialize() {

  map = new google.maps.Map(document.getElementById('map_canvas'), {
    center: new google.maps.LatLng(10, 30),
    zoom: 2,
    mapTypeId: google.maps.MapTypeId.ROADMAP
  });

 infoWindow = new google.maps.InfoWindow();

 google.maps.event.addListener(map, "click", function() { infoWindow.close(); });

 layer = new google.maps.FusionTablesLayer(tableid, {suppressInfoWindows:true});
 layer.setQuery("SELECT 'Country Geometry' FROM " + tableid);
 layer.setMap(map);
 google.maps.event.addListener(layer, "click", openIW);

 layer2 = new google.maps.FusionTablesLayer(tableid2, {suppressInfoWindows:true});
 layer2.setQuery("SELECT 'Site Location' FROM " + tableid2);
 layer2.setMap(map);
 google.maps.event.addListener(layer2, "click", openIW);

}

function openIW(FTevent) {
  // infoWindow.setContent(FTevent.infoWindowHtml);
  // infoWindow.setPosition(FTevent.latLng);
  infoWindow.setOptions(
    { 
     content: FTevent.infoWindowHtml,
     position: FTevent.latLng,
     pixelOffset: FTevent.pixelOffset
    });

  infoWindow.open(map);
}

</script> 
```

我现在如何将自定义 html 添加到信息窗口，而不是依赖 Fusion Tables 中的信息窗口设置？我在添加`suppressInfoWindows`选项之前使用的代码如下，但我不确定现在如何以正确的格式重新添加它。此外，是否可以为不同层上的信息窗口使用不同的 html 代码，或者两个层都必须使用相同的信息窗口？谢谢。

```
e.infoWindowHtml =  "<div id='SiteInfo' class='googft-info-window' style='font-family: sans-serif; width: 500px; height: 300px; overflow: auto;'>\
            <b>" + e.row['Site Name'].value + "</b><br />\
            </div></div>"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T17:21:12.527

请参阅我对您[最后一个问题](https://stackoverflow.com/questions/12015092/including-script-elements-in-a-custom-infowindow)的回答中的示例。

[包含 2 个图层、1 个信息窗口的地图示例](http://www.geocodezip.com/541559_Fusion_map_testA.html)

实施：

1.  抑制两个图层上的信息窗口
2.  编写代码以在单击任一图层时打开共享信息窗口。

# javascript - 这种情况下如何避免修改事件对象

> ID：12041811
> 
> 赞同：3
> 
> 时间：2012-08-20T16:54:41.420
> 
> 标签：javascript, jquery-ui, javascript-events, jquery

这个问题与这个[Autocomplete: first item 只有当用户在 tab key 上键入时才聚焦](https://stackoverflow.com/questions/12039219/autocomplete-first-item-focused-only-when-the-user-type-on-tab-key)。

为了使第一个项目仅在用户使用 jqueryUi 键入 tab 键时聚焦，可以制作类似[http://jsfiddle.net/uymYJ/8/](http://jsfiddle.net/uymYJ/8/) (1) 的内容。

这个实现的坏处是对事件对象的修改`event.keyCode = $.ui.keyCode.DOWN;`。
事实上，通过这种方式，它将影响此事件的所有其他侦听器：稍后运行的 keydown 事件的所有侦听器（包括所有委托的侦听器）将看到 event.keycode 为 $.ui.keyCode.ENTER。

我的问题是：
1）我的担忧是否`the modification of the event object`合理？如果不是为什么？
2）你能建议另一种方法来达到同样的结果吗？
3）@AaronDigulla 建议的一种选择是使用`document.createEvent()`. 在这种情况下使用此方法的正确方法是什么？我确实尝试了以下代码（3），但它不起作用。

PS：
这是关于自动完成的代码（2）。

* * *

(1)

```
$("#box").keydown(function(e){
    if( e.keyCode != $.ui.keyCode.TAB) return;

   e.keyCode = $.ui.keyCode.DOWN;
   $(this).trigger(e);

   e.keyCode = $.ui.keyCode.ENTER;
   $(this).trigger(e);

   $(this).siblings("input").select();
}); 
```

* * *

(2)

```
function (e) {
    var f = typeof e == "string",
        g = Array.prototype.slice.call(arguments, 1),
        h = this;
    return e = !f && g.length ? a.extend.apply(null, [!0, e].concat(g)) : e, f && e.charAt(0) === "_" ? h : (f ? this.each(function () {
        var d = a.data(this, c),
            f = d && a.isFunction(d[e]) ? d[e].apply(d, g) : d;
        if (f !== d && f !== b) return h = f, !1
    }) : this.each(function () {
        var b = a.data(this, c);
        b ? b.option(e || {})._init() : a.data(this, c, new d(e, this))
    }), h)
} 
```

* * *

(3)

```
$("#box").keydown(function(){

    e = document.createEvent('KeyboardEvent');
    e.initEvent("keydown", true, true);
    $(this).dispatchEvent(e);

    if( e.keyCode != $.ui.keyCode.TAB) return;

   e.keyCode = $.ui.keyCode.DOWN;
   $(this).trigger(e);

   e.keyCode = $.ui.keyCode.ENTER;
   $(this).trigger(e);

   $(this).siblings("input").select();
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T07:54:44.377

你是对的：事件将被修改，所有听众都会看到修改后的键码。

但更重要的问题是：这危险吗？

要回答这个问题，我们需要知道哪些侦听器绑定到该元素。当然，自动完成插件中的所有侦听器都旨在处理这种情况。对他们来说，这没问题。

当您将自己的事件绑定到小部件时，麻烦就开始了。

一种解决方案是创建新事件（使用`document.createEvent()`+ 复制所有重要属性）并发送克隆以避免修改原始事件。

一些链接：

*   [键盘事件和代码](http://www.w3.org/2002/09/tests/keys.html)（在您键入时显示事件的字段）
*   来自 Mozilla 开发者网络的[KeyboardEvent](https://developer.mozilla.org/en-US/docs/DOM/KeyboardEvent)
*   [jQuery.Event](http://api.jquery.com/category/events/event-object/)有帮助代码来创建和处理事件
*   [从动态 HTML 中理解键盘事件数据](http://www.webreference.com/programming/javascript/dhtmlref/chap6/2/6.html)：权威参考，2E。第 6 章：脚本事件

# iphone - 在应用程序中显示完全黑屏

> ID：12041817
> 
> 赞同：2
> 
> 时间：2012-08-20T16:55:23.307
> 
> 标签：iphone, ios

我的应用程序显示全屏 UIView，它是黑色的、不透明的、alpha=1。这应该会导致黑屏，对吧？嗯，确实如此，但只是某种程度。在正常光线下它看起来是黑色的，但是当我进入一个黑暗的房间时，我可以看到屏幕有点发光。当我锁定手机时，屏幕会完全变暗。

我希望我的应用程序在前台运行时屏幕完全变暗。

我意识到可能无法从应用程序中关闭屏幕背光，但我能做些什么来实现我想要的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T17:09:26.777

UIScreen 上的[亮度](https://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIScreen_Class/Reference/UIScreen.html#//apple_ref/occ/instp/UIScreen/brightness)属性允许您控制 iOS 设备的背光强度。

# java - 如何获取Jstree中的数据值

> ID：12041822
> 
> 赞同：0
> 
> 时间：2012-08-20T16:55:45.347
> 
> 标签：java, javascript, html, json, jquery-ui

我试图在 jstree 中获取所选节点的数据。我可以使用 data.rslt.obj.attr('id') 获取 ID 但是如果我想检索 user101 的电子邮件 ID，如何根据所选节点获取数据值？我试过data.rslt.obj.attr('data')，但无法实现，请指教。

```
{
   "state":"open",
   "data":"com",
   "attr":{
      "id":"test1",
   },
   "children":[
      {
         "state":"open",
         "attr":{
            "id":"testus1",
         },
         "data":{
            "title":"vls",
            "emailAddress":"vls@gmail.com"
         },
         "children":[
            {
               "state":"closed",
               "attr":{
                  "id":"testus2",
               },
               "data":{
                  "title":"vfg"
               },
               "children":[
                  null,
                  {
                     "state":"closed",
                     "attr":{
                        "id":"testus3",
                     },
                     "data":{
                        "title":"user19"
                     },
                     "children":[
                        {
                           "state":"closed",
                           "attr":{
                              "id":"user101",
                           },
                           "data":{
                              "title":"user101",
                              "emailAddress":"test1@csc.com"
                           }
                        },
                        {
                           "state":"closed",
                           "attr":{
                              "id":"testus11",
                           },
                           "data":{
                              "title":"testuser11",
                              "emailAddress":"test@csc.com"
                           },
                        }
                     ]
                  }
               ]
            },
            null
         ]
      },
      null
   ]
}

Regards,
Prabkar 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T17:08:47.047

我认为为了存储属性，您必须使用“元数据”属性，它可以将字符串、数组或对象作为值。我看到您为此使用了“数据”。您应该尝试使用“元数据”而不是“数据”。

请注意，您仍应使用以下语句来检索您在元数据中设置的属性。

```
data.rslt.obj.attr('data') 
```

# android - 在 Activity Junit 测试期间使用服务存根

> ID：12041824
> 
> 赞同：0
> 
> 时间：2012-08-20T16:55:52.580
> 
> 标签：android, unit-testing

我正在为启动服务的活动编写 Junit 测试：

```
startService(new Intent(this, MyClass.class)); 
```

为了测试的目的，我想`MyClass.class`用一个存根类*（MyStubClass.class）替换*

我对 SOF 进行了广泛的搜索，但找不到解决方案。是否可以在不向应用程序添加测试相关代码的情况下进行交换？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T20:47:55.370

评论上面的帖子，虽然我同意这篇文章所说的大部分内容，但我不确定我是否同意所有这些，甚至是否需要进行如此细粒度的区分。在我看来，我认为模拟是运行时的替换，而存根是未完成的工作或依赖于多态性而不是实际替换的特定于测试的实现。但是，我不是专家，所以对我的意见持保留态度。无论如何，当您用模拟版本替换一个类时，不需要在模拟实现中做任何花哨的事情。

无论如何，这是您要求的文档：http: [//jmockit.googlecode.com/svn/trunk/www/tutorial/StateBasedTesting.html#mocks](http://jmockit.googlecode.com/svn/trunk/www/tutorial/StateBasedTesting.html#mocks)

我使用 jmockit 来存根我不关心实现的接口，用不抛出异常的存根替换 Android 存根实现，有时用最小功能实现替换那些相同的存根。就我而言，我希望能够快速运行我的单元测试，这意味着在模拟器或物理设备之外运行它们。如果您有兴趣做这种事情，那么将模拟包与 Robolectric 之类的东西结合使用可以挽救生命。

# java - 当插图为零时，褪色不起作用

> ID：12041825
> 
> 赞同：1
> 
> 时间：2012-08-20T16:56:00.890
> 
> 标签：java, swing, transparency, paintcomponent, miglayout

```
 public class FadingLayer extends JPanel {

    public FadingLayer(JPanel panel) {
        // when set to "insets 0 0 0 0", shows the FadingPanel without fading.
        setLayout(new MigLayout("insets 1 0 0 0"));  
        add(panel,"dock center");
        setOpaque(false);
    }

    @Override
    public void paintComponent(Graphics arg0) {
        Graphics2D graphics = (Graphics2D) arg0;
        AlphaComposite alpha = AlphaComposite.getInstance(AlphaComposite.SRC_OVER, opacity);
        graphics.setComposite(alpha);
        graphics.setColor(getBackground());
        graphics.fillRect(0, 0, getWidth(), getHeight());
    }
} 
```

这是我放置一些褪色效果的面板。不透明度使用摇摆的 Timer 类更新。问题是当所有插入值都设置为 0 计时器工作但我只看到最终结果没有任何褪色效果。但是，即使其中一个插图设置为某个非零值，我也可以看到褪色效果。怎么了，求救？

**编辑：** 当面板（添加到`FadingPanel`）获取完整区域时会发生这种情况。那是什么时候`FadingPanel`设置为-->

```
 setLayout(new BorderLayout());
 add(panel,BorderLayout.CENTER); 
```

**或者**

```
setLayout(new MigLayout("insets 0 0 0 0"));
add(panel,"dock center"); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T21:12:17.660

SagarDabas的回答是正确的，我只是想发表一些评论

```
public void paintComponent(Graphics arg0) {
    Graphics2D graphics = (Graphics2D) arg0;
    AlphaComposite alpha = AlphaComposite.getInstance(AlphaComposite.SRC_OVER, opacity);
    graphics.setComposite(alpha);
    graphics.setColor(getBackground());
    graphics.fillRect(0, 0, getWidth(), getHeight());
} 
```

操作图形上下文时必须非常小心。上面的代码将影响在它之后绘制的所有组件（保留应用的 alpha 合成）

更好的方法是在开始之前复制图形。

```
public void paintComponent(Graphics arg0) {
    Graphics2D graphics = (Graphics2D) arg0.create();
    // paint as normal
    graphics.dispose();
} 
```

# c# - 如何对我的 WCF 客户端类进行单元测试？

> ID：12041827
> 
> 赞同：7
> 
> 时间：2012-08-20T16:56:09.153
> 
> 标签：c#, .net, visual-studio-2010, wcf, .net-4.0

我有一个与 WCF 服务交互的类库，并使用`app.config`文件进行配置。我想对这个类进行单元测试，但是当我运行单元测试时，我得到：

> 在服务模型客户端配置部分中找不到引用合同“FooService”的默认端点元素。这可能是因为没有为您的应用程序找到配置文件，或者因为在客户端元素中找不到与此合同匹配的端点元素

根据[这个答案](https://stackoverflow.com/a/2737593/546561)，我需要将`app.config`文件驻留在我的单元测试项目中，这确实解决了问题。但是我真的不想`app.config`每次更改文件时都必须将文件复制到单元测试中。

我想我可以添加一个链接到`app.config`，除了我使用[SlowCheetah](http://visualstudiogallery.msdn.microsoft.com/69023d00-a4f9-4a34-a6cd-7e854ba318b5)来处理`app.config`转换，所以我`app.config`是在编译时生成的。

我能做些什么来让它工作，还是我只需要放弃我`app.config`并处理代码中的配置？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T16:59:57.327

您可以在测试中模拟 WCF 服务。在对类进行单元测试时，可以注入不使用 WCF 服务的服务版本。这样，当测试运行时，他们不需要担心任何配置文件。这也将导致更好的测试。大概您想测试您的代码，而不是 WCF 服务本身。最好在你的测试中模拟它的行为，这样你就可以*只*测试你的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T17:16:07.970

创建一个客户端包装器，我之前做了同样的事情来做一个实现 IChannelLocator<T> 的 ChannelLocator<T> 并且在它下面主要包装了一个通道工厂的行为。

但是要非常小心，这个抽象不会泄漏下面的连接，ChannelFactory 的通道管理机制很复杂，应该仔细研究以避免泄漏客户端或服务器通道，这可能会使它们中的任何一个都没有响应。

记住这个模式：

```
try
{
  yourChannel.Close();
}
catch
{
  yourChannel.Abort();
} 
```

然后在您的单元测试中，您只需 Mock<IChannelLocator<T>> 并且您可以在代码中创建更多场景，例如您可以测试您的代码在客户端发出请求时如何响应并获取超时异常等。此外，这将使您的测试运行得非常快，并且无需配置即可在任何人的机器上运行，因为您的测试不再依赖于主动运行的服务。

如果那个正在运行的服务有一个错误导致单元测试失败，或者更糟的是不准确地通过，会发生什么？将依赖项包装在抽象层中进行测试需要做更多的工作，但完全值得。

# ruby - 弹性搜索/轮胎和关键字。为关键字列表匹配“或”的正确方法？

> ID：12041831
> 
> 赞同：1
> 
> 时间：2012-08-20T16:56:34.097
> 
> 标签：ruby, ruby-on-rails-3, elasticsearch

我有一个实体模型（在 Mongoid 中），我试图在它的关键字字段上搜索它，它是一个数组。我想做一个查询，在其中传入一组潜在的搜索词，任何匹配任何词的实体都将通过。

我还没有很好地工作。

但是，为什么我要问这个问题，是因为它更复杂。我也不想返回任何通过“ignore_project_ids”参数标记为“不返回”的实体。

所以，当我查询时，我得到 0 个结果。我正在使用 Bonsai.io。但是，我已将其移至我自己的 EC2 实例，以减少解决问题的复杂性/变量。

那么，我做错了什么？这是相关的代码位。

[https://gist.github.com/3405763](https://gist.github.com/3405763)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T18:05:56.643

您需要`terms`查询而不是`term`查询 - 术语查询只对相等性感兴趣，而`terms`查询要求字段匹配任何指定的值。

鉴于您似乎并不关心查询分数（您正在按另一个属性排序），您将通过使用过滤查询并将您的条件表达为过滤器来获得更快的查询

# sql-server - 无数据时左连接，否则内连接

> ID：12041834
> 
> 赞同：1
> 
> 时间：2012-08-20T16:56:44.317
> 
> 标签：sql-server, join, left-join, inner-join

我有一个视图**V**，它从几个表中选择数据。我还有一个表**T**，它定义了允许用户查看**V中哪种类型的数据。**

**对于用户来说，如果T**中没有数据，这意味着他可以从我的视图**V**中查看所有内容，但是如果**T**中有数据，那么我需要限制我的视图**V**的结果。

所以在我看来，我需要在 T 中执行**if**`V Left join T` nothing或在**T**`V INNER JOIN T`中执行if 。

 **但是我不太确定如何编写此查询以获得可能的最佳性能（就服务器执行而言），前提是视图**V**可能已经是一个不太快执行的查询。我应该首先从 B 中选择所有内容并将其存储在某个变量或临时表中吗？还是可以使用我至今未听说过的巧妙的 SQL 语法轻松完成所有事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T17:36:03.607

我建议不要关注问题的“内连接/外连接”部分，而是建议分两步进行。

首先，您的应用程序可以查询表“T”以确定用户的访问权限。然后，其次，使用“T”中的数据来确定用户在“V”中可以访问的内容。

如果您正在编写一个同时控制数据库层和业务层的服务器应用程序，那么首先编写一个过程来收集所有用户的权限设置，然后执行两个查询之一 - 特权查询或非特权查询，具体取决于T 的内容。

如果您必须在数据层中执行所有这些操作，请按以下步骤操作：

```
CREATE PROCEDURE myproc
    @current_user int
AS

-- Determine user's permission level
DECLARE @permission bit
SELECT @permission = permission FROM T WHERE t.user = @current_user

-- Use the appropriate query for this user
IF @permission IS NULL BEGIN
    SELECT * FROM V
END ELSE BEGIN
    SELECT * FROM V INNER JOIN T ON T.criteria=V.criteria
END 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T17:17:34.010

如果您有一个在 T 中包含所有行的“默认”用户，则只能通过内部连接来完成。否则，您将陷入以下困境：

```
select V.*
from V,
T
where (v.id = T.Id 
AND T.User = current_user)
OR NOT EXISTS (select 1 from T where T.user=current_user) 
```**

# javascript - JavaScript 数组原型的独特方法

> ID：12041837
> 
> 赞同：0
> 
> 时间：2012-08-20T16:57:04.377
> 
> 标签：javascript, performance, prototype

*澄清：*

正如一些人指出的那样，这看起来确实像*“这段代码可以吗”*之类的问题。我真正好奇的主要事情是：*该方法是如何`.hasOwnProperty`*工作的？
我的意思是：IE 的 JScript 引擎（至少<9）并不总是使用哈希表，所以我认为它只是迭代该对象的所有属性，然后检查它是否从另一个对象获取这些属性原型链更高。这是一个公平的假设吗？毕竟：在某种程度上，每个代码都被翻译成循环和分支，但是如果 IE 不做哈希表，那不意味着`.hasOwnProperty`只是一些糖，所以你不必编写循环吗？
我想我是从 DC 的一篇博客文章或视频中得到这个概念的，很可能他在谈论数组，以及它们在 JS 中是（或者更确切地说：可以是）的古怪事物。我找不到视频/博客帖子（？）自动取款机。鉴于 JS 数组经常被滥用，我认为你们中的许多人都会同意，我认为这个问题的答案可以作为一个不错的参考。这就是为什么我没有在codereview上发布它。

就目前的答案而言，由于我的问题是从错误的角度开始的（更关注代码而不是其背后的机制），所以让我老生常谈，感谢大家指出我没有指出的问题考虑到。

* * *

最近，我为我正在编写的一个脚本扩充了数组原型（暂时不要拍摄）。为了不重新发明轮子，我去搜索了一些其他人如何做的例子。

Strangly[这是很常见](http://www.jslab.dk/library/Array.unique)的，这显然是不必要的复杂。[作为替代方案](http://www.shamasis.net/2009/09/fast-algorithm-to-find-unique-items-in-javascript-array/)，我也发现了这一点，除了发帖者对他的*快速算法*相当沾沾自喜之外，我仍然觉得还有改进的余地。

我知道我现在可能会成为一个自鸣得意的聪明人，我的`unique`方法实际上是这样的：

```
Array.prototype.unique = function()
{
    'use strict';
    var i,obj,ret;
    ret = [];
    obj = {};
    for (i=0;i<this.length;i++)
    {
        if (!obj.hasOwnProperty(this[i]))
        {
            ret.push(this[i]);
            obj[this[i]] = i;
        }
    }
    return ret;
}; 
```

这样，就不需要第二个循环 AFAIK，是吗？当然，除非该`hasOwnProperty`方法非常慢，但不知何故我怀疑，在这种情况下：链只能回到 1 级，到`Object.prototype`.

我发布的第二个链接包含一些统计数据和速度比较，但众所周知，它们在现实世界中几乎没有任何意义。谁能指出我关于 JS 和基准测试的好文章的方向（除了[John Resig](http://ejohn.org)博客上的那篇？

所以，只是出于好奇：你们中有人发现这种方法有问题吗？*更多信息： Object.prototype: 不变，`undefined`is `undefined`，没有全局变量没有框架，并且这个方法不是盲目实现的（`if (!Array.prototype.unique){...}`）*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T19:10:38.173

这是一个正确考虑类型的实现，比简单的嵌套循环快得多，并保持原始数组的顺序：

```
Array.prototype.unique = function(){
    var r, o, i, j, t, tt;
    r = [];
    o = {};
    for(i = 0; i < this.length; i++){
       t = this[i];
       tt = o[t] = o[t] || [];
       for(j = 0; j < tt.length; j++)
           if(tt[j] === this[i])
               break;
       if(j == tt.length)
           r.push(tt[j] = t);
     }
     return r;
} 
```

我做了一个[JSPerf 来比较这些实现](http://jsperf.com/array-uniques/2)。

*   unique1 是嵌套循环。
*   unique2 是您链接到的快速算法。
*   unique3 是您的版本。
*   unique4 是我的。
    **添加**
*   unique5 是 Kooilnc 的答案
*   unique6 是 primvdb 的答案

虽然 unique2 是最快的，但它有它认为的问题`"1"`并且`1`是平等的。unique4 在速度方面排在第三位，但比 unique1 快得多，并且输出正确。所有四种变体实际上都给出了不同的输出：

```
=> [1, "1", 1, 2, 3, 4, 1, 2, 3, "2", "3", "4", "true", "true", true].unique1()
// ["1", 4, 1, 2, 3, "2", "3", "4", "true", true]

=> [1, "1", 1, 2, 3, 4, 1, 2, 3, "2", "3", "4", "true", "true", true].unique2()
// [1, "2", "3", "4", true]

=> [1, "1", 1, 2, 3, 4, 1, 2, 3, "2", "3", "4", "true", "true", true].unique3()
// [1, 2, 3, 4, "true"]

=> [1, "1", 1, 2, 3, 4, 1, 2, 3, "2", "3", "4", "true", "true", true].unique4()
// [1, "1", 2, 3, 4, "2", "3", "4", "true", true] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-20T18:38:57.517

尽管没有得到广泛支持，但您可以使用`Set`（来自 ECMAScript Harmony）。它是原生的，所以它不应该对性能产生太大影响（例如，不需要像那样寻找实际的索引`indexOf`）。主要优点是您可以无缝地使用它来跟踪您已经拥有的项目，包括对象，并且您可以考虑相同的对象：

```
Array.prototype.unique = function() {
    'use strict';
    var ret = [];
    var used = new Set();
    for (var i = 0; i < this.length; i++) {
        if (!used.has(this[i])) {
            ret.push(this[i]);
            used.add(this[i]);
        }
    }
    return ret;
};

var a = {};
var b = {};
[1, 2, 1, a, a, null, b].unique(); // [1, 2, a, null, b] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T18:22:25.407

看起来不错，但正如[Felix Kling](https://stackoverflow.com/users/218196/felix-kling)指出的那样，它仅适用于包含原语的数组。这个有点复杂，但适用于我认为的所有类型：

```
Array.prototype.unique = function(){
  'use strict';
  var im = {}, uniq = [];
  for (var i=0;i<this.length;i++){
    var type = (this[i]).constructor.name, 
    //          ^note: for IE use this[i].constructor!
        val = type + (!/num|str|regex|bool/i.test(type) 
               ? JSON.stringify(this[i]) 
               : this[i]);
    if (!(val in im)){uniq.push(this[i]);}
    im[val] = 1;
  }
  return uniq;
}
//testing
var test = [1,2,'string',[1,2,3],'string','1','2',
            {yada:'yada'},/[a-z]/i,2,1,1,2,[1,2,3],
            false, new Date(),/[a-b]/i,5,/[a-z]/i,'false']
   ,testunique = test.unique();
//=> testunique now
//   [1,2,string,[1,2,3],1,2,[object Object],
//    /[a-z]/i,false,Mon Aug 20 2012 20:20:11 GMT+0200,
//    /[a-b]/i,5,false] 
```

# asp.net - 如何为 CheckboxList Asp.net 上的每个项目添加一个事件

> ID：12041838
> 
> 赞同：0
> 
> 时间：2012-08-20T16:57:08.747
> 
> 标签：asp.net, .net, event-handling

如何为 CheckBoxList 上的每个项目添加一个事件，例如我想添加一个单击事件以检查已检查的项目。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T17:09:57.400

CheckBoxList 中的每个项目都是类型`System.Web.UI.WebControls.ListItem`并且*没有*定义事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-17T21:02:20.993

好的。所以我找到了这个问题/答案，但它并没有帮助我。虽然提供的答案是正确的，但有一种简单的方法可以使用 Repeater 控件构建类似于 CheckBoxList 的控件。

事实证明，您可以将Repeater 与带有CheckBox 的ItemTemplate 一起使用。我在这里有一个完整的解释：[http ://www.rhyous.com/2014/10/17/aspx-checkboxlist-alternative-that-allows-for-the-oncheckedchanged-event/](http://www.rhyous.com/2014/10/17/aspx-checkboxlist-alternative-that-allows-for-the-oncheckedchanged-event/)

我还在这个答案中复制了所需的数据：

**默认.aspx**

```
<%@ Page Title="Home Page" Language="C#" MasterPageFile="~/Site.Master" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="CheckBoxListExample._Default" %>

<%@ Import Namespace="CheckBoxListExample" %>
<%@ Import Namespace="CheckBoxListExample.Models" %>

<asp:Content ID="BodyContent" ContentPlaceHolderID="MainContent" runat="server">
    <div>
        <asp:Repeater ID="Repeater1" runat="server">
            <ItemTemplate>
                <asp:CheckBox ID="cb1" runat="server" AutoPostBack="true" OnCheckedChanged="RepeaterCheckBoxChanged"
                    Text="<%# ((CheckBoxViewModel)Container.DataItem).Name %>"
                    Checked="<%# ((CheckBoxViewModel)Container.DataItem).IsChecked %>" />
            </ItemTemplate>
        </asp:Repeater>
    </div>
</asp:Content> 
```

**默认.aspx.cs**

```
using System;
using System.Collections.Generic;
using System.Web.UI;
using System.Web.UI.WebControls;
using CheckBoxListExample.Models;

namespace CheckBoxListExample
{
    public partial class _Default : Page
    {
        private List<CheckBoxViewModel> _ViewModels;

        protected void Page_Load(object sender, EventArgs e)
        {
            if (!IsPostBack)
            {
                var _ViewModels = new List<CheckBoxViewModel>
                {
                    new CheckBoxViewModel {Name = "Test1", IsChecked = true},
                    new CheckBoxViewModel {Name = "Test2"},
                    new CheckBoxViewModel {Name = "Test3"}
                };
                Repeater1.DataSource = _ViewModels;
                Repeater1.DataBind();
            }
        }

        protected void RepeaterCheckBoxChanged(object sender, EventArgs e)
        {
            var cb = sender as CheckBox;
            if (cb == null) return;
            if (cb.Checked)
            {
                // Insert
            }
            else
            {
                // Delete
            }
        }
    }
} 
```

**复选框视图模型**

```
namespace CheckBoxListExample.Models
{
    public class CheckBoxViewModel
    {
        public string Name { get; set; }
        public bool IsChecked { get; set; }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T17:13:06.060

CheckBoxList 有点棘手。不要认为有一种直接的方法可以为每个项目添加点击事件，因为 ListItem 类没有任何事件。

您可以`AutoPostBack="true"`在 CheckBoxList 上设置并检查页面加载时选择了哪些项目，但您不会很容易知道最后点击的是哪个项目。

其他解决方案是摆脱 CheckBoxList 并仅创建 CheckBoxes 并将其上的单击事件设置为相同的事件方法。在那里你可以检查发件人。

ASPX：

```
<asp:CheckBox ID="CheckBox1" Text="A" OnCheckedChanged="CheckBox_Clicked" AutoPostBack="true" runat="server" />
<asp:CheckBox ID="CheckBox2" Text="B" OnCheckedChanged="CheckBox_Clicked" AutoPostBack="true" runat="server" />
<asp:CheckBox ID="CheckBox3" Text="C" OnCheckedChanged="CheckBox_Clicked" AutoPostBack="true" runat="server" /> 
```

后面的代码：

```
void CheckBox_CheckedChanged(object sender, EventArgs e)
{
   Console.WriteLine(((CheckBox)sender).Text);
} 
```

或者您可以制作自己的自定义 CheckBoxList 来处理项目上的点击事件。

# ios - iOS 遥控器 - 禁用下一首和上一首歌曲按钮

> ID：12041840
> 
> 赞同：0
> 
> 时间：2012-08-20T16:57:13.717
> 
> 标签：ios, iphone, mpmovieplayercontroller, remote-control

我正在编写一个使用远程控制功能（remoteControlReceivedWithEvent:) 的流媒体应用程序。

我可以按预期使用遥控器开始和停止歌曲。

但我似乎无法找到如何禁用主屏幕上的下一首和上一首歌曲按钮（双击主页并一直向左滑动）。

我在内部使用 MPMoviePlayerController。

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T20:41:59.533

据我所知，API 不允许您将按钮显示为禁用。我认为您能做的最好的事情就是在按下其中一个按钮时不采取任何行动。

我没有观察到任何其他将远程按钮显示为禁用的主要应用程序。

# google-apps-script - 如何让用户在提交表单之前查看答案？

> ID：12041841
> 
> 赞同：0
> 
> 时间：2012-08-20T16:57:20.703
> 
> 标签：google-apps-script

我用 UiApp 构建了一个表单来收集用户的信息。多个面板和文件上传相当复杂，所以我想让用户有机会在提交之前查看他们的输入。我希望在一个最终审核面板上显示他们的输入，然后让他们决定编辑信息并返回到较早的面板进行编辑。

以下是测试脚本。我得到的最远的是让它返回'textBox'而不是文本框的值。是否可以在脚本的 doGet 部分中获取值，或者我必须移动到 doPost 以访问这些值？

你会建议什么工作？感谢您的任何帮助！

```
function doGet(e){
var app = UiApp.createApplication();
var appPanel = app.createVerticalPanel();
var form = app.createFormPanel();
var panel1 = app.createHorizontalPanel();

var emailLabel = app.createLabel('Your Email');
var email = app.createTextBox().setName('email').setId('email');

app.add(form);

var button1 = app.createButton('Go to Review');

panel1.add(emailLabel);
panel1.add(email);
panel1.add(button1);
appPanel.add(panel1);
form.add(appPanel);

var panel2 = app.createHorizontalPanel().setVisible(false);
var reviewLabel = app.createLabel('Your Email:');
var reviewEmail = app.createLabel(email);

panel2.add(reviewLabel);
panel2.add(reviewEmail);
appPanel.add(panel2);

//
var reviewPageTwo = app.createClientHandler()
.forTargets(panel1).setVisible(false)
.forTargets(panel2).setVisible(true);

button1.addClickHandler(reviewPageTwo);

return app;
} 
```

更新 8.24.12 我包括生成的脚本。它包括审阅功能、引导用户返回编辑的按钮和提交按钮。（您需要替换电子表格 ID 才能使帖子生效。）

感谢大家的帮助！马丁

```
 function doGet(e){
var app = UiApp.createApplication();
var appPanel = app.createVerticalPanel();
var form = app.createFormPanel();
var panel1 = app.createHorizontalPanel().setId('panel1');

var emailLabel = app.createLabel('Your Email');
var email = app.createTextBox().setName('email').setId('email');
var syncChangeHandler = app.createServerHandler('syncText').addCallbackElement(form);

app.add(form);

var button1 = app.createButton('Go to Review');

panel1.add(emailLabel);
panel1.add(email);
panel1.add(button1);
appPanel.add(panel1);
form.add(appPanel);

var panel2 = app.createHorizontalPanel().setId('panel2').setVisible(false);
var reviewGrid = app.createGrid(3,3).setId('reviewGrid');
var reviewEmail = app.createLabel().setId('reviewEmail');
var reviewLabel = app.createLabel('Your Email:');
var submitButton = app.createSubmitButton('Submit');
var button2 = app.createButton('Edit Response');

panel2.add(reviewLabel);
panel2.add(reviewEmail);
panel2.add(button2);
panel2.add(submitButton);
appPanel.add(panel2);

//
var editResponse = app.createClientHandler()
.forTargets(panel1).setVisible(true)
.forTargets(panel2).setVisible(false);

button1.addClickHandler(syncChangeHandler);
button2.addClickHandler(editResponse);

return app;
}

function syncChangeHandler(e){
  var app = UiApp.getActiveApplication(); 

  app.getElementById('reviewEmail').setText(e.parameter.email);
  app.getElementById('panel1').setVisible(false);
  app.getElementById('panel2').setVisible(true);
  return app;
}

function doPost(e){
var ss = SpreadsheetApp.openById('*your spreadsheet id here*').getSheets()[0];
var range = ss.getRange(ss.getLastRow()+1, 1, 1,2);

var values = [[new Date(),e.parameter.email]];
range.setValues(values);

var app = UiApp.getActiveApplication();
var label = app.createLabel('Thank You!');
app.add(label);

return app;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T17:27:53.057

你在 doGet() 中有你的整个函数。doGet() 函数在您的 UI 首次加载时执行。所以，

```
var email = app.createTextBox().setName('email').setId('email'); 
```

实际上解析为一个文本框。当你这样做

```
var reviewEmail = app.createLabel(email); 
```

您试图将文本框作为参数传递给 createLabel，这是不允许的。因此这是行不通的。您必须在处理程序中处理对文本框的更改。

```
function doGet(){
var syncChangeHandler = app.createServerHandler('syncText').addCallbackElement(form);
var email = app.createTextBox().setName('email').setId('email');
...
var reviewEmail = app.createLabel().setId('reviewEmail');
...
}

function syncText(e){
  var app = UiApp.getActiveAplication(); 
  app.getElementById('reviewEmail').setText(e.parameter.email);
  return app;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T18:41:53.753

Srik 说的是真的（*当然 ;-)*），你确实不能分配这种类型的值的标签......我会做的（因为你在 doGet/doPost 结构中工作）只是创建第二个按钮除了触发处理程序的提交按钮之外，该处理程序会填充所有相应的 textBoxes ， listBoxes 或任何您拥有的值，这些值来自您已经在审查面板中的主表单（它的一种副本）有。为此，您需要将表单作为 callBackElement 添加到处理程序（doPost 方案不需要这样做）。

另一种选择可能是将此处理程序分别添加到所有小部件，使用“键向上”触发器或“值更改触发器”，以便审查面板始终实时更新，在这种情况下，“提交前审查面板”可以除了使其最终可见之外，无需用户采取进一步行动即可随时可见（尽管它也可以始终可见）。在这个选项中，处理函数更像是一个“同步器”。恐怕您在上传文件时会遇到一些困难（因为这只能在 doGet/doPost 结构中工作）。

# php - PHPExcel设置列宽

> ID：12041844
> 
> 赞同：7
> 
> 时间：2012-08-20T16:57:27.173
> 
> 标签：php, phpexcel

我正在使用 .csv 文件设置列宽

```
 $objPHPExcel->getActiveSheet()->getColumnDimension('A')->setWidth(50); 
```

但是我看不到A列的宽度有任何变化，我做错了什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2015-10-16T12:47:54.360

首先，禁用自动调整大小：

```
$objPHPExcel->getActiveSheet()->getColumnDimension('A')->setAutoSize(false); 
```

现在，您可以设置：

```
$objPHPExcel->getActiveSheet()->getColumnDimension('A')->setWidth("50"); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-20T17:01:19.077

假设您使用的是 CSV Writer。

CSV 文件不支持**任何**格式，仅支持数据，因此在编写 CSV 文件时无法应用列宽（即格式）

# wordpress - 在小部件类之外获取 Wordpress 小部件属性

> ID：12041847
> 
> 赞同：1
> 
> 时间：2012-08-20T16:57:39.520
> 
> 标签：wordpress, plugins, parameters, widget, params

我对 Wordpress 很陌生，我需要一些帮助。

我有这个小部件：

```
class MyWidget extends WP_Widget { 
       ...
       function widget($args, $instance) {
              ...
       }
} 
```

然后在小部件类之外，我有一个 javascript，我必须将小部件参数传递给它：

```
function MyWidget_load_scripts() {
    wp_enqueue_script(
            'my-scripts', plugins_url('assets/js/myscript.js', __FILE__), array('jquery')
    );

    wp_localize_script('my-scripts', 'params', $widgetParameters);
 }

 add_action('wp_enqueue_scripts', 'MyWidget_load_scripts'); 
```

如何获取小部件参数？

提前致谢

# xml - XMLStarlet - 对于每个 元素

> ID：12041849
> 
> 赞同：0
> 
> 时间：2012-08-20T16:57:55.097
> 
> 标签：xml, windows, parsing, xmlstarlet

我有以下 XML。

```
<application>
<name>Activity Monitor.app</name>
<path>/Applications/Utilities/Activity Monitor.app</path>
<version>10.8.0< /version></application>
<application>
<name>Adobe Flash Player Install Manager.app</name>
<path>/Applications/Utilities/Adobe Flash Player Install Manager.app</path>
<version>11.3.300.268</version></application> 
```

使用 XMLStarlet，我想得到以下输出：

```
<package name="Activity Monitor.app">
<attribute name="Path">/Applications/Utilities/Activity Monitor.app</attribute>
<attribute name="Ver">10.8.0</attribute >
<package name="Adobe Flash Player Install Manager.app">
<attribute name="Path">/Applications/Utilities/Adobe Flash Player Install Manager.app</attribute>
<attribute name="Ver">11.3.300.268</attribute> 
```

我试过命令：

```
xml sel -t  -v "computer/software/applications/application/path" -v "computer/software/applications/application/name" -v computer/software/applications/application/version 
```

但这只是列出所有应用程序，然后是所有路径，然后是所有版本。我是 XMLStarlet 新手，所以我将不胜感激任何/所有帮助！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T18:49:40.010

恐怕得到你想要的最简单的方法是编写一个类似于这个的 xsl 转换：

```
<?xml version="1.0" encoding="UTF-8"?>
 <xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
   <xsl:output method="xml" indent="yes"/>

   <xsl:template match="application">
     <package>
       <xsl:attribute name="name">
         <xsl:value-of select="name"/>
       </xsl:attribute>
       <xsl:apply-templates/>
     </package>
   </xsl:template>

   <xsl:template match="path|version">
     <attribute>
       <xsl:attribute name="name">
         <xsl:value-of select="name()"/>
       </xsl:attribute>
       <xsl:value-of select="text()"/>
     </attribute>
   </xsl:template>

   <xsl:template match="text()"/>

</xsl:stylesheet> 
```

然后，您可以使用 xmlstarlet 进行转换：

```
xml tr thetransformation.xsl source.xml 
```

我总是发现本教程对这样的事情很有帮助：http: [//zvon.org/xxl/XSLTutorial/Output/contents.html#id8](http://zvon.org/xxl/XSLTutorial/Output/contents.html#id8)

# javascript - 将字节转换为图像以在 HTML5 画布上绘图

> ID：12041851
> 
> 赞同：8
> 
> 时间：2012-08-20T16:57:56.313
> 
> 标签：javascript, image, byte, html5-canvas

任何人都知道我将如何将通过 websocket（从 C# 应用程序）发送的字节转换为图像？然后我想在画布上绘制图像。我可以看到两种方法：

*   以某种方式在画布上以字节形式绘制图像而不进行转换。
*   在javascript中以某种方式将字节转换为base64字符串，然后绘制。

这是我的函数，它接收用于绘图的字节：

```
function draw(imgData) {

    var img=new Image();
    img.onload = function() {
        cxt.drawImage(img, 0, 0, canvas.width, canvas.height);
    };

// What I was using before...
img.src = "data:image/jpeg;base64,"+imgData;

} 
```

我之前收到的图像已经转换为 base64 字符串，但是在得知发送字节的大小更小（小 30%？）之后，我更愿意让它工作。我还应该提到图像是 jpeg。

有人知道我会怎么做吗？谢谢您的帮助。:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T18:23:45.950

如果您的图像确实已经是 jpeg，您可以将接收到的数据转换为 base64 流。Firefox 和 Webkit 浏览器（我记得）有一定的功能，`btoa()`. 它将输入字符串转换为 base64 编码的字符串。它的对应物是`atob()`相反的。

你可以像下面这样使用它：

```
function draw(imgData){
    var b64imgData = btoa(imgData); //Binary to ASCII, where it probably stands for
    var img = new Image();
    img.src = "data:image/jpeg;base64," + b64imgData;
    document.body.appendChild(img); //or append it to something else, just an example
} 
```

如果您的目标浏览器（例如 IE）不是 Firefox 或 Webkit，您可以使用互联网上的多种转换功能[之一（很好](http://jsperf.com/btoa-vs-third-party-base64-encoder-5/2)，它还提供多个浏览器中的性能统计信息，如果您重新感兴趣:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-27T12:58:32.053

我最后使用了这个：

```
function draw(imgData, frameCount) {
    var r = new FileReader();
    r.readAsBinaryString(imgData);
    r.onload = function(){ 
        var img=new Image();
        img.onload = function() {
            cxt.drawImage(img, 0, 0, canvas.width, canvas.height);
        }
        img.src = "data:image/jpeg;base64,"+window.btoa(r.result);
    };
} 
```

在使用 btoa() 之前，我需要将字节读入字符串。

# javascript - 循环遍历 JavaScript 对象并记录它们的属性？

> ID：12041853
> 
> 赞同：0
> 
> 时间：2012-08-20T16:58:33.517
> 
> 标签：javascript, object

我想遍历一个对象数组，并为每个对象 console.log 其属性。假设我们不知道属性是什么。

代码看起来像这样。

```
qData = [object ,object, object, object, object];
for(props in qData){
  //display all of props object attributes
} 
```

我怎样才能输出他们的属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T17:01:53.987

你可以这样做：

```
var qData = [object, object, object, object, object];
for (var i = 0; i < qData.length; i++) {
    var obj = qData[i];
    for (var prop in obj) {
        console.log(prop + "=" + obj[prop]);
    }
} 
```

您首先遍历数组，然后对于每个数组元素，您遍历属性。请记住，您使用 迭代数组元素`for (var i = 0; i < array.length; i++)`并使用 迭代属性`for (props in array)`。

* * *

如果您只想要对象的直接属性（而不是父对象的任何可枚举属性），您可以使用：

```
var qData = [object, object, object, object, object];
for (var i = 0; i < qData.length; i++) {
    var obj = qData[i];
    for (var prop in obj) {
        if (obj.hasOwnProperty(prop)) {
            console.log(prop + "=" + obj[prop]);
        }
    }
} 
```

# java - 对象属性的 Java 值传递解决方法

> ID：12041854
> 
> 赞同：0
> 
> 时间：2012-08-20T16:58:46.583
> 
> 标签：java, pass-by-reference, pass-by-value, return-by-reference, return-by-value

在我的 Java 源代码的一种方法中，相同的代码块出现了很多次：

```
<some code>
<some code>
<block of code>
<some code>
<block of code>
<some code>
<some code>
<some code>
<block of code>
<some code>
<some code>
<block of code>
<some code>
etc.. 
```

这段代码的作用是找出对象的哪个属性应该是代码的目标。更具体地说，在块的开头我们有一个字符串“Object.property”，代码的任务是解析它，以便找出“Object”是什么类型的对象，以及“Object”的什么属性” “财产”是。当这完成并且块结束时，执行继续对所述对象的所述属性做一些事情。该属性可以用于比较，或者可以为其分配一些东西。

现在，我的问题是我想通过将这个块放在另一个方法中来稍微整理一下代码，然后我可以多次调用它。此外，如果我在这个块中发现了一个错误，我不需要经历每一次出现来修复它 - 只需一种方法。

所以这基本上是我想要做的：

```
<some code>
<some code>
property = parse();
<some code>
property = parse();
<some code>
<some code>
<some code>
property = parse();
<some code>
<some code>
property = parse();
<some code>
etc..

property parse(){
 <block of code>
 return property;
} 
```

现在，由于 Java 没有任何指针，我不能例如从这个新方法返回一个整数属性。将返回该整数的副本（按值传递），我的所有其余代码将处理属性的本地整数副本，而不是属性本身。如果仅在比较中使用该属性，这当然很好，但是当我的其余代码想要为它分配一些东西时，事情就不再起作用了。

是否有一种聪明而简单的解决方法，以便我可以缩短我的 Java 代码，并且在修改它时，我只需要修改代码的一部分？

编辑：

为了给你一些真实的代码，代码块可能看起来像这样，当它没有放在不同的方法中时，在它得到一个名为 toParse 的字符串（对于这个例子来说，它可能是“niceShirt.size”）：

```
String[] parts = toParse.split('\\.');
if(pantsList.containsKey(parts[0])){
    if(parts[1] == "size") pantsList.get(parts[0]).size += 1;
    if(parts[1] == "daysWorn") pantsList.get(parts[0]).daysWorn += 1;
}
if(shirtsList.containsKey(parts[0])){
    if(parts[1] == "size") shirtsList.get(parts[0]).size += 1;
    if(parts[1] == "daysWorn") shirtsList.get(parts[0]).daysWorn += 1;
}
if(shoesList.containsKey(parts[0])){
    if(parts[1] == "size") shoesList.get(parts[0]).size += 1;
    if(parts[1] == "daysWorn") shoesList.get(parts[0]).daysWorn += 1;
} 
```

现在因为这样的代码多次出现，我很想有一个这样的方法：

```
String[] parts = toParse.split('\\.');
if(pantsList.containsKey(parts[0])){
    if(parts[1] == "size") return pantsList.get(parts[0]).size;
    if(parts[1] == "daysWorn") return pantsList.get(parts[0]).daysWorn;
}
if(shirtsList.containsKey(parts[0])){
    if(parts[1] == "size") return shirtsList.get(parts[0]).size;
    if(parts[1] == "daysWorn") return shirtsList.get(parts[0]).daysWorn;
}
if(shoesList.containsKey(parts[0])){
    if(parts[1] == "size") return shoesList.get(parts[0]).size;
    if(parts[1] == "daysWorn") return shoesList.get(parts[0]).daysWorn;
} 
```

在我的其余代码中，我需要做的就是：

```
parse(toParse) += 1; 
```

..但这不起作用，因为 parse(toParse) 现在是一个副本，一个按值返回，所以它不会对对象的真实属性做任何事情。

我希望这有助于澄清问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T17:04:21.537

您可以将 getter 和 setter 包装在实现简单接口的匿名类的对象中：

```
interface PropertyInfo {
    Object get();
    void set(Object value);
} 
```

该`parse()`方法将根据从调用者传入的其他数据返回此接口的实现，该实现知道如何进行 get 并知道如何进行 set 操作：

```
private PropertyInfo parse(...) { // take some parameters
    // Find your getter and setter through reflection
    final Method getter = ...
    final Method setter = ...
    return new PropertyInfo() {
        public Object get() {
            // Use the getter
        }
        public void set(Object value) {
            // Use the setter
        }
    };
} 
```

当您需要在某个条件下使用该属性时，您可以使用以下内容：

```
PropertyInfo p = parse(...); // pass whatever needs to be parsed
if (p.get() == 123) ... 
```

当您需要设置属性时，您可以这样调用它：

```
PropertyInfo p = parse(...); // pass whatever needs to be parsed
p.set(123); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T17:04:36.143

使您的方法无效并让第一个参数成为“句柄”对象 - 一个具有整数字段的简单对象。该对象将按值传递，但它的值可以随心所欲地修改。

# android - 滚动 ListView 时的大量 GC（带有持有者模式）

> ID：12041855
> 
> 赞同：13
> 
> 时间：2012-08-20T16:58:59.360
> 
> 标签：android, garbage-collection, android-listview

这是一个与此类似的问题[，](https://stackoverflow.com/questions/5977718/lots-of-garbage-collection-in-a-listview)但该解决方案不起作用。

问题是滚动`ListView`非常缓慢，这是因为有很多 GC。我使用持有人模式（视图缓存），如下面的代码所示：

```
public View getView(int position, View convertView, ViewGroup parent) {

    ViewHolder holder;

    if (convertView == null) {
        convertView = mInflater.inflate(R.layout.eventrow, parent, false);

        holder = new ViewHolder();

        holder.title = (TextView) convertView.findViewById(R.id.eventTitle);
        holder.place = (TextView) convertView.findViewById(R.id.eventPlace);

        convertView.setTag(holder);
    } else {
        // Get the ViewHolder back to get fast access to the TextView
        // and the ImageView.
        holder = (ViewHolder) convertView.getTag();
    }

    // Bind the data efficiently with the holder.
    holder.title.setText(((EventItem) getItem(position)).getTitle());
    holder.place.setText(((EventItem) getItem(position)).getPlace_name());

    return convertView;
} 
```

我`cacheColorHint`从列表视图和行中删除了自定义选择器：

```
<ListView
android:id="@+id/android:list"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
/> 
```

这是日志的样子：

```
08-20 19:36:24.286: D/dalvikvm(12036): GC_EXTERNAL_ALLOC freed 364K, 46% free 3944K/7239K, external 1196K/1445K, paused 54ms
08-20 19:36:24.356: D/dalvikvm(12036): GC_EXTERNAL_ALLOC freed 228K, 49% free 3716K/7239K, external 1721K/1970K, paused 52ms
08-20 19:36:24.456: D/dalvikvm(12036): GC_EXTERNAL_ALLOC freed 5K, 49% free 3726K/7239K, external 2214K/2463K, paused 50ms
08-20 19:36:24.546: D/dalvikvm(12036): GC_EXTERNAL_ALLOC freed 2K, 49% free 3726K/7239K, external 2214K/2463K, paused 43ms
08-20 19:36:24.636: D/dalvikvm(12036): GC_EXTERNAL_ALLOC freed 2K, 49% free 3726K/7239K, external 2214K/2463K, paused 44ms
08-20 19:36:24.696: D/dalvikvm(12036): GC_EXTERNAL_ALLOC freed <1K, 49% free 3726K/7239K, external 2214K/2463K, paused 50ms
08-20 19:36:24.766: D/dalvikvm(12036): GC_EXTERNAL_ALLOC freed <1K, 49% free 3726K/7239K, external 2214K/2463K, paused 46ms
08-20 19:36:24.846: D/dalvikvm(12036): GC_EXTERNAL_ALLOC freed <1K, 49% free 3726K/7239K, external 2214K/2463K, paused 46ms
08-20 19:36:24.906: D/dalvikvm(12036): GC_EXTERNAL_ALLOC freed <1K, 49% free 3726K/7239K, external 2214K/2463K, paused 46ms
08-20 19:36:24.986: D/dalvikvm(12036): GC_EXTERNAL_ALLOC freed <1K, 49% free 3726K/7239K, external 2214K/2463K, paused 46ms
08-20 19:36:25.056: D/dalvikvm(12036): GC_EXTERNAL_ALLOC freed <1K, 49% free 3726K/7239K, external 2214K/2463K, paused 47ms
08-20 19:36:25.136: D/dalvikvm(12036): GC_EXTERNAL_ALLOC freed <1K, 49% free 3726K/7239K, external 2214K/2463K, paused 46ms
08-20 19:36:25.196: D/dalvikvm(12036): GC_EXTERNAL_ALLOC freed <1K, 49% free 3726K/7239K, external 2214K/2463K, paused 46ms
08-20 19:36:25.296: D/dalvikvm(12036): GC_EXTERNAL_ALLOC freed <1K, 49% free 3726K/7239K, external 2214K/2463K, paused 48ms
08-20 19:36:25.356: D/dalvikvm(12036): GC_EXTERNAL_ALLOC freed <1K, 49% free 3726K/7239K, external 2214K/2463K, paused 43ms
08-20 19:36:34.596: D/dalvikvm(12036): GC_EXTERNAL_ALLOC freed 7K, 49% free 3740K/7239K, external 2214K/2463K, paused 51ms
08-20 19:36:34.656: D/dalvikvm(12036): GC_EXTERNAL_ALLOC freed 1K, 49% free 3739K/7239K, external 2214K/2463K, paused 50ms
08-20 19:36:34.746: D/dalvikvm(12036): GC_EXTERNAL_ALLOC freed <1K, 49% free 3739K/7239K, external 2214K/2463K, paused 50ms 
```

**编辑：** 似乎问题（几乎）仅在第`ListFragment`一次膨胀时才出现。第一次向下滚动然后向上滚动。在那之后，GC 就不那么频繁了。但有时每次滚动时都会出现 GC。我看不出这里没有规律。 另外，我可以在 HTC Desire (2.3.7 MIUI) 上看到问题，但在 Sasmung Galaxy ACE (2.1) 上看不到**。**它只会变得更加混乱......

**不太令人满意的解决方案：** 当我使用

```
android:scrollingCache="false"
android:animationCache="false" 
```

在我的列表视图中似乎没问题。但是文档说，如果我理解得很好，那应该是完全不同的，所以我有点困惑。

**我在哪里犯错？怎样做才能有一个平滑的滚动列表视图？或者禁用会`scrollingCache`产生一些我现在看不到的负面影响？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T08:15:16.363

```
android:scrollingCache="false" 
```

是解决办法。

文档说：

> 设置为 true 时，列表在滚动期间使用绘图缓存。这使渲染速度更快，但使用更多内存。

现在这并没有给我们任何关于实现细节的提示。我有一个想法，无需投入数小时的代码分析。出于缓存目的，就像 Google 在他们自己的文档中推荐的那样，他们使用 Wea​​kReferences 或 WeakHashMaps。但是看起来 Dalvik VM 有点太急于杀死这些引用并导致它们每次都被重建。这解释了巨大的 GC 活动和缓慢的用户体验。

链接：关于由于 bug 导致的无用 Wea​​kReferences 的博客：http: [//chriswstewart.com/post/14199645893/improving-the-android-listview](http://chriswstewart.com/post/14199645893/improving-the-android-listview) Dalvik VM 错误讨论：[https ://groups.google.com/forum/#!topic/安卓开发者/66uw2t84rME](https://groups.google.com/forum/#!topic/android-developers/66uw2t84rME)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T15:46:48.030

确保 ListView 后面的任何内容都有背景和/或 windowBackground，我之前已经看到过这样的问题。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-12T13:35:31.480

尝试

```
listView.setCacheColorHint(0);

         &
protected void onDestroy() {
        System.gc();

        super.onDestroy();
    } 
```

# android - 以数字开头的包名称的规则是什么？

> ID：12041857
> 
> 赞同：13
> 
> 时间：2012-08-20T16:59:18.410
> 
> 标签：android, naming-conventions

Android 中的包命名约定是：

```
com.organizationName.appName 
```

但是如果 organizationName 或 appName 以数字或下划线开头，则它成为无效名称，因为 android 不接受以数字或下划线开头的单词。

例如：

`com.1organizationName.appName`是无效的

重命名这个包的约定是什么？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-20T17:19:32.233

在官方的[“Naming a Package”](http://docs.oracle.com/javase/tutorial/java/package/namingpkgs.html) java 文档中，有如下声明：

> 在某些情况下，互联网域名可能不是有效的软件包名称。如果域名**包含连字符或其他特殊字符**，如果包名**以数字或其他非法用作 Java 名称开头的字符开头**，或者如果包名**包含保留的 Java 关键字，则会发生这种情况，比如“int”。** 在这种情况下，***建议的约定是添加下划线***。

所以在你的情况下，它会是`com._1organizationname.appname`

编辑：刚刚在[Android 文档](http://developer.android.com/guide/topics/manifest/manifest-element.html#package)中找到了这个：

> 应用程序的完整 Java 语言样式的包名称。名称应该是唯一的。名称可以包含大写或小写字母（“A”到“Z”）、数字和下划线（“_”）。**但是，单个包名称部分只能以字母开头。**

所以显然它*不是*Java 风格的。不幸的是，在这种情况下，您最好的选择实际上是拼出数字，例如`com.oneorganizationname.appname`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T17:02:48.890

命名约定只是为了帮助您为 Play 市场创建一个唯一的包名称。如果您向后使用公司的网站地址（即 com.websitename.appname），那么 Play 市场中的其他应用不太可能拥有它。您可以为包命名任何您想要的名称，这样您就可以拼出数字以使其更容易（com.oneOrganizationName.appName）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-16T21:53:24.637

请参阅[**此处**](http://developer.android.com/guide/topics/manifest/manifest-element.html#package)有关清单中的“包”属性的信息：

> 应用程序的完整 Java 语言样式的包名称。名称应该是唯一的。名称可以包含大写或小写字母（“A”到“Z”）、数字和下划线（“_”）。但是，单个包名称部分只能以字母开头。为避免与其他开发人员发生冲突，您应该使用 Internet 域所有权作为您的包名称的基础（相反）。例如，Google 发布的应用程序以 com.google 开头。发布应用程序时，您也不应该使用 com.example 命名空间。
> 
> 包名称用作应用程序的唯一标识符。它也是应用程序进程的默认名称（参见元素的进程进程属性）和活动的默认任务亲和性（参见元素的 taskAffinity 属性）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-16T14:54:29.923

you can try **co.m_1organizationName.appName** or **co.m1organizationName.appName** this way your package will not be absurd and the address will be more meaningful.

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2012-08-20T18:00:44.367

您知道，注册一个新域名只需 5 美元。只需注册 oneorganizationName.com 并使用它。您知道它将是唯一的，您知道它将是一个有效的包名称，现在您知道网络钓鱼者和欺骗者不会为自己注册 oneorganizationName.com 来欺骗您的客户。

# php - Symfony2实体学说2不更新字段

> ID：12041859
> 
> 赞同：0
> 
> 时间：2012-08-20T16:59:26.057
> 
> 标签：php, symfony, entity, symfony-sonata

我有这个实体：

配置文件.php

```
/**
 * LoPati\BlogBundle\Entity\Profile
 *
 * @ORM\Table(name="profile")
 * @ORM\Entity
 * @Gedmo\TranslationEntity(class="LoPati\BlogBundle\Entity\ProfileTranslation")
 */
class Profile
{
    /**
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    protected $id;

    /**
     * @Gedmo\Translatable
     * @ORM\Column(name="name", type="string", length=255, nullable=true)
     */
    protected $name=null;

    /**
     * @var text $description
     * @Gedmo\Translatable
     * @ORM\Column(name="description", type="text", nullable=true)
     */
    protected $description=null;

    /**
     * @ORM\OneToMany(targetEntity="ProfileTranslation", mappedBy="object", cascade={"persist", "remove"})
     */
    protected $translations;

    /**
     * Required for Translatable behaviour
     * @Gedmo\Locale
     */
    protected $locale;

    public function __construct()
    {
        $this->translations = new ArrayCollection;
    }

    /**
     * Get id
     *
     * @return integer
     */
    public function getId()
    {
        return $this->id;
    }

    public function getLocale()
    {
        return $this->locale;
    }

    public function setLocale($locale)
    {
        $this->locale = $locale;
    }

    public function setName($name)
    {
        $this->name=$name;
    }

    public function getName()
    {
        return $this->name;
    }

    public function setDescription($description)
    {

    }

    public function getDescription()
    {
        return $this->description;
    }

    public function getTranslations()
    {
        return $this->translations;
    }

    public function addTranslation(ProfileTranslation $t)
    {

        $this->translations->add($t);
        $t->setObject($this);

        $this->name = $this->translations[0];
        $this->description = $this->translations[1];
    }

    public function removeTranslation(ProfileTranslation $t)
    {
        $this->translations->removeElement($t);
    }

    public function setTranslations($translations)
    {
        $this->translations = $translations;
        $this->name = $this->translations[0];
$this->description = $this->translations[1];
    }

    public function __toString()
    {
        return "hola";
    }

} 
```

和 ProfileTranslation.php

```
/**
 * @ORM\Entity
 * @ORM\Table(name="profile_translations",
 *     uniqueConstraints={@ORM\UniqueConstraint(name="lookup_unique_idx", columns={
 *         "locale", "object_id", "field"
 *     })}
 * )
 */
class ProfileTranslation extends AbstractPersonalTranslation
{
    /**
     * Convinient constructor
     *
     * @param string $locale
     * @param string $field
     * @param string $content
     */
    public function __construct($locale = null, $field = null, $content = null)
    {
        $this->setLocale($locale);
        $this->setField($field);
        $this->setContent($content);
    }

    /**
     * @ORM\ManyToOne(targetEntity="Profile", inversedBy="translations")
     * @ORM\JoinColumn(name="object_id", referencedColumnName="id", onDelete="CASCADE")
     */
    protected $object;

    public function __toString()
    {
        return $this->getContent();
    }
} 
```

我希望在编辑作为 ProfileTranslation 表的 arraycollection 时，还更新名称和描述字段，但形成 Profile Table，它是该集合的第一个元素。

它在我创建新配置文件时工作，但是当我编辑此配置文件时，只更新 ProfileTranslation 表而不是 Profile 表。

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T10:10:01.607

您的实现摒弃了一些过于经典的可翻译用途。

如果它适合你，你也许可以看看[TranslationFormBundle](https://github.com/a2lix/TranslationFormBundle)及其[演示。](https://github.com/a2lix/DemoTranslationBundle)

# regex - 正则表达式在描述中查找长度

> ID：12041862
> 
> 赞同：0
> 
> 时间：2012-08-20T16:59:42.130
> 
> 标签：regex, coldfusion

```
<cfset RegexToFindLength = "Length:.*?(\d*\.?\d+)\s*(""|")"/>

<cfset Description = "blah blah blah 2.5"""/>

<cfset size = #reMatch(RegexToFindLength, Description)# />

<cfdump var="#size#"> 
```

错误消息：ColdFusion 正在查看以下文本：）

希望从产品描述中提取长度：2.5"。

我已经在正则表达式中测试了上面的正则表达式并且它有效。但是当我尝试在 cfm 页面中使用它时，我得到了错误。

有人可以向我解释如何在 CF 中设置它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T17:53:51.703

你这里有几个问题。

1）你没有逃避你的双引号，所以你最终会关闭你的正则表达式字符串并混淆它。

就个人而言，当我必须在字符串中使用双引号时，如果可以的话，我倾向于使用单引号来定义字符串。

> ```
> <cfset RegexToFindLength = 'Length:.*?(\d*\.?\d+)\s*(""|")'/> 
> ```

2）您的`Description`变量没有您要搜索的字符串，因此不会匹配。我将其更改为以下内容以使其工作（注意用于定义字符串的单引号）：

> ```
> <cfset Description = 'Length:.:2.5""'/> 
> ```

3）（也许不是问题）`Size`没有被设置为数字。`rematch`返回一个字符串数组。您需要检查数组位置内字符串的长度或检查数组本身的长度 - 我不知道您到底想要做什么。

# php - 从 string 到 int 的转换不起作用

> ID：12041864
> 
> 赞同：-1
> 
> 时间：2012-08-20T16:59:44.133
> 
> 标签：php, int, type-conversion

我使用正则表达式从文档中获取值并将其存储在名为`$distance`. 那是一个字符串，但我必须将它放在数据库中表的 int 列中。

当然，通常我会去说

```
$distance=intval($distance); 
```

但它不起作用！我真的不知道为什么。

这就是我正在做的一切：

```
preg_match_all($regex,$content,$match);
$distance=$match[0][1];
$distance=intval($distance); 
```

正则表达式是正确的，如果我回显 $distance，它是例如“0” - 但我需要它是 0 而不是“0”。使用 intval() 总是会以某种方式将其转换为空字符串。

## 编辑 1

正则表达式是这样的：

```
$regex='#<value>(.+?)</value>#'; // Please, I know I shouldn't use regex for parsing XML - but that is not the problem right now 
```

然后我继续

```
preg_match_all($regex,$content,$match);
$distance=$match[0][1];
$distance=intval($distance); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T17:10:49.087

在零之前必须有一个空格，或者可能（已经在那里，做到了）一个 0xA0 字节。在您的正则表达式中使用“\d”以确保获得数字。

编辑：您可以使用

```
$value = (int)trim($value, " \t\r\n\x0B\xA0\x00"); 
```

[http://php.net/manual/en/function.trim.php](http://php.net/manual/en/function.trim.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T17:15:50.383

如果你愿意，`print_r($match)`你会看到你需要的数组是`$match[1]`：

```
$content = '<value>1</value>, <value>12</value>';

$regex='#<value>(.+?)</value>#';

preg_match_all($regex,$content,$match);

print_r($match); 
```

输出：

```
Array
(
    [0] => Array
        (
            [0] => <value>1</value>
            [1] => <value>12</value>
        )

    [1] => Array
        (
            [0] => 1
            [1] => 12
        )

) 
```

* * *

在这种情况下：

```
$distance = (int) $match[1][1];

var_dump($distance); 
```

输出：`int(12)`

* * *

或者，您可以使用`PREG_SET_ORDER`标志，即`preg_match_all($regex,$content,$match,$flags=PREG_SET_ORDER);`$match 数组具有以下结构：

```
Array
(
    [0] => Array
        (
            [0] => <value>1</value>
            [1] => 1
        )

    [1] => Array
        (
            [0] => <value>12</value>
            [1] => 12
        )

) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T17:13:48.270

为什么你的正则表达式中需要问号？尝试这个：

```
$regex='#<value>(.+)</value>#'; 
```

# google-apps-script - 电子表格 UI - 提示用户从 docs.google.com 打开或保存 userAppPanel

> ID：12041867
> 
> 赞同：-1
> 
> 时间：2012-08-20T16:59:59.337
> 
> 标签：google-apps-script

我的 UI 适合我（我是电子表格所有者和脚本创建者）。但是，当我与其他用户共享电子表格时，UI 不会完全显示，并且会提示他们打开或保存`userAppPanel`来自 docs.google.com 的电子表格。

我已将我的脚本完全缩减为以下内容，但仍然不走运：

```
function showDialog() {
    // Create the UI application
    var uiApp = UiApp.createApplication();

    // Provide the Popup with a title
    uiApp.setTitle('Parameter Collection Dialog');

    // Create an user instruction label
    var lblInstructions = uiApp.createLabel()
      .setText('Select a type of Person and Country');

    // Add the panel to the application
    uiApp.add(lblInstructions);

    // Show the application in the spreadsheet
    var spreadSheet = SpreadsheetApp.getActiveSpreadsheet();
    spreadSheet.show(uiApp);
} 
```

当脚本从脚本编辑器为每个尝试的用户运行脚本时，UI 工作 - 但是，当我将它连接到“打开电子表格”触发器时，脚本只适用于我 - 而没有其他人。

我已经接近完成我的要求，这是一个非常令人沮丧的最后一个障碍。

非常感谢

**更新：请参阅我的评论以获取解决方案，即使用 onOpen 函数而不是手动 onOpen 触发器。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-07T04:04:25.003

不幸的是，重命名函数 onOpen 的解决方法并不总是适用，例如当您需要该函数以某人（例如您自己）的身份运行时。如果您将其重命名为 onOpen()，它将在没有身份的情况下运行。我不能这样做，因为我需要对数据库进行身份验证。

这似乎证实了问题与触发脚本的人的身份有关。

你发布过问题吗？你能分享它的链接吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T09:11:49.483

感谢您确认斯里克。但是，我已经制定了一个解决方案：

我通过脚本编辑器手动将 showDialog 函数连接到 On Open 触发器。但是，如果您将 showDialog() 函数名称更改为 onOpen()，那么您不必手动将该函数连接到事件，因为 onOpen 是一个内置事件，它现在适用于所有用户（前提是他们是共享用户，并登录）。

我也会打开一个问题，因为我相信它应该双向工作。

希望我的解决方案也能帮助其他人:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T17:35:52.767

我试图重现这个问题并且能够轻松地做到这一点。这似乎是一个错误。[我建议您在问题跟踪器](http://code.google.com/p/google-apps-script-issues/issues/list)中打开一个问题并使用错误编号更新此线程。

# javascript - 防止菜单键显示上下文菜单

> ID：12041869
> 
> 赞同：3
> 
> 时间：2012-08-20T17:00:05.953
> 
> 标签：javascript, events, contextmenu

我知道[键盘菜单键](http://en.wikipedia.org/wiki/Menu_key)是`keyCode === 93`.

所以我有以下代码：

```
$(window).on("keydown", document, function(event){
    if (event.keyCode === 93)  {   //context menu
        console.log("context menu key", event);
        event.preventDefault();
        event.stopPropagation();
        return false;
    }
}); 
```

尽管事件**确实**触发了，并且`console`确实在 if 语句中记录了，**但**上下文菜单仍然显示，即使***两者*** `event.preventDefault();`都`event.stopPropagation();`出现在我的代码中。

有什么办法可以**防止**菜单显示？

摆弄演示：http: [//jsfiddle.net/maniator/XJtpc/](http://jsfiddle.net/maniator/XJtpc/)

* * *

对于那些不知道“菜单”键是什么的人：

![](../Images/e9e76cb7c531e6896ee763003304b83f.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T17:15:55.050

这有点愚蠢，但似乎有效：http: [//jsfiddle.net/XJtpc/2/](http://jsfiddle.net/XJtpc/2/) :)

```
$(function(){
    var lastKey=0;
    $(window).on("keydown", document, function(event){
        lastKey = event.keyCode;            
    });

    $(window).on("contextmenu", document, function(event){
        if (lastKey === 93){
            lastKey=0;
            event.preventDefault();
            event.stopPropagation();
            return false;
        }
    });
});
​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-04T17:44:29.850

我从@aquinas 的解决方案开始，但发现它可能比这更简单一些。

# 脚步

1.  注册`keydown`事件处理程序。`e.preventDefault`不需要。
2.  注册`contextmenu`事件处理程序，然后做`e.preventDefault()`

# 例子：

```
// JavaScript
// Register your `ContextMenu` key event handler
document.querySelector('body').onkeydown = (e) => {
  if (e.key === 'ContextMenu') {
    // Do something
  }
}

// Prevent `contextmenu` event default action
document.querySelector('body').oncontextmenu = (e) => e.preventDefault();

// jQuery
// Register your `ContextMenu` key event handler
$('body').on('keydown', (e) => {
  if (e.key === 'ContextMenu') {
    // Do something
  }
});

// Prevent `contextmenu` event default action
$('body').on('contextmenu', (e) => e.preventDefault()); 
```

# asp.net-mvc - 将 RouteValueDictionary 作为 QueryString 传递给 Html.Action

> ID：12041872
> 
> 赞同：0
> 
> 时间：2012-08-20T17:00:26.707
> 
> 标签：asp.net-mvc, asp.net-mvc-routing

我有一个看法：

```
@{
   RouteValueDictionary tRVD = new RouteValueDictionary(ViewContext.RouteData.Values);
   foreach (string key in sQS.Split('&'))
   {
       var itemArr = key.Split('=');
       tRVD[itemArr[0]] = itemArr[1];
   }
   tRVD["dtLastRequest"] = item.dtLastRequest;
   tRVD["uiSubscription"] = item.uiSubscription;
   tRVD["area"] = "";

}

@Html.Action("Count", "Search", tRVD) 
```

哪个生成具有 15 个键和值的 RouteValueDictionary，然后将其传递给操作“计数”，控制器“搜索”，正如我所想的那样？！

我不知道以前的程序员是谁写了这段代码，但是控制器的操作代码是完整的或者使用 Request.QueryString，但是现在，QueryString 是空的。

真的可以将 tRVD 作为 QueryString 传递给 Action“Count”吗？现在，我可以从以下位置获取值：

```
RouteData.Values 
```

有我的键和值，但我不想更改以前编码器的代码并将所有从 QueryString 重写为 RouteData。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T17:11:38.230

查询字符串是空的，因为`Count`实际上不是使用普通请求调用动作方法，在 URL 中指定动作的参数，而是直接在框架内，携带`RouteData`对象中的参数。

`RouteData`因此，正如您所写，您应该使用 访问参数。

# c# - 将 int 转换为 nvarchar 时出错

> ID：12041880
> 
> 赞同：4
> 
> 时间：2012-08-20T17:00:56.210
> 
> 标签：c#, sql, sqldatatypes

这个错误让我很困惑。我有一个带有两个输出参数的存储过程，定义如下

```
@agentNumber int OUTPUT,
@currentAgentNum int OUTPUT, 
```

然后使用下面的 SELECT 语句填充它们

```
SELECT @agentNumber = AgentNumber
FROM AgentIdentification
WHERE AgentTaxId = @ssn

SELECT @currentAgentNum = AgentNumber
FROM UniqueAgentIdToAgentId
WHERE AgentId = @agentId 
```

在数据库中，`AgentNumber`在两个表中都定义为`int`. 但是，当我在 C# 代码中调用此存储过程时，我得到一个 SQL 异常，说明：

> *将数据类型 int 转换为 nvarchar 时出错。*

如果我将输出参数的数据类型更改为`nvarchar`，代码将执行，但它只会返回整数的第一个数字。下面是如何在 C# 代码中定义变量

```
SqlParameter outNewAgentNumber = new SqlParameter("@agentNumber", "");//Output parameter - leave blank
SqlParameter outCurrentAgentNumber = new SqlParameter("@currentAgentNum", "");//Output parameter - leave blank

outNewAgentNumber.Direction = ParameterDirection.Output;
outCurrentAgentNumber.Direction = ParameterDirection.Output; 
```

我将这些参数添加到一个`SqlCommand`对象中，指定适当的数据库和`commandType`，然后用于`.ExecuteNonQuery()`调用该过程。同样，让我真正感到困惑的是错误消息指出我正在使用`nvarchar`数据类型，它只能（据我所知）指的是数据库端的某些东西。但是，正如我所说，我已经检查了两次/三次，并且两`AgentNumber`列都是`int`.

编辑

将 sqlParameter 声明更改为起始值 0 已解决此问题。我现在遇到了与其他两个参数相同的问题。

```
SqlParameter outOperator = new SqlParameter("@operator", "");//Output parameter - leave blank
SqlParameter outDate = new SqlParameter("@date", "");//Output parameter - leave blank 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T17:03:25.380

改变

```
SqlParameter outNewAgentNumber = new SqlParameter("@agentNumber", "");//Output parameter - leave blank 
SqlParameter outCurrentAgentNumber = new SqlParameter("@currentAgentNum", "");//Output parameter - leave blank 
```

到

```
SqlParameter outNewAgentNumber = new SqlParameter("@agentNumber", 0);//Output parameter - leave blank 
SqlParameter outCurrentAgentNumber = new SqlParameter("@currentAgentNum", 0);//Output parameter - leave blank 
```

在您的代码中，您最初将值指定为字符串，因为您向其传递了一个字符串，[该字符串在从 CLR 类型转换为 SQL Data Type 时映射到一个 varchar](https://stackoverflow.com/questions/1440620/which-sql-server-data-type-best-represents-a-double-in-c/1440631#1440631)。

一旦运行时将其视为字符串，它将在整个代码中保留相同的类型，因此如果您分配一个数字 (int) 值，它仍会将其视为字符串。诀窍是首先为其分配正确的数据类型。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-20T17:10:17.243

这两行是罪魁祸首：

```
SqlParameter outNewAgentNumber = new SqlParameter("@agentNumber", "");
SqlParameter outCurrentAgentNumber = new SqlParameter("@currentAgentNum", ""); 
```

通过将空字符串 ( `""`) 指定为第二个参数，ADO.NET 运行时假定它是一个字符串参数。而且由于您没有指定任何长度 - 它可能默认为一个字符长度（这就是它只返回第一个数字的原因）。

因此，我的建议是始终为您的 SQL 参数显式定义数据类型（如果它是字符串 - 还要定义长度！）：

```
SqlParameter outNewAgentNumber = new SqlParameter("@agentNumber", SqlDbType.Int);
outNewAgentNumber.Direction = ParameterDirection.Output;
outNewAgentNumber.Value = 0; 
```

或者

```
SqlParameter outNewAgentNumber = new SqlParameter("@agentNumber", SqlDbType.NVarChar, 50);
outNewAgentNumber.Direction = ParameterDirection.Output;
outNewAgentNumber.Value = ""; 
```

# c# - 通过网络将数据从 .Net 应用程序发送到 android 应用程序（套接字编程）

> ID：12041881
> 
> 赞同：0
> 
> 时间：2012-08-20T17:01:03.913
> 
> 标签：c#, android, sockets

我是套接字编程的新手。我想使用 C# 创建一个适用于 PC 的应用程序，一个适用于 android 手机的应用程序可以通过无线网络 (LAN) 与其他手机进行通信。

为了将数据发送到 android 应用程序，我在 PC 端使用此代码：

```
 private void sendButton_Click(object sender, EventArgs e)
    {
        try
        {
            Object objData = messageTextBox.Text;
            byte[] byData = System.Text.Encoding.ASCII.GetBytes(objData.ToString ());
            _socket.Send (byData);
        }
        catch(SocketException se)
        {
            MessageBox.Show (se.Message );
        }
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        try
        {
            _socket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
            _ipEndPoint = new IPEndPoint(IPAddress.Parse("192.168.1.18"), 2001);
            _socket.Connect(_ipEndPoint);
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.ToString());
        }
    } 
```

在 android 应用程序中，我想使用以下代码接收数据：

```
Handler myUpdateHandler = new Handler()
       {
            public void handleMessage(Message msg)
            {
                  Log.d(appTag, "setting textview");
                  TextView tv = (TextView) findViewById(R.id.messageText);
                  tv.setText(mClientMsg);              
            }
       };

class CommsThread implements Runnable
{
    public void run()
    {
        try
        {
            Socket s = null;
            try
            {
                ss = new ServerSocket(2001);
            }
            catch (IOException e)
            {
                Log.d(appTag, e.toString());
            }
            while (!Thread.currentThread().isInterrupted())
            {
                Message m = new Message();
                Log.d(appTag, "message m = new message()");

                try
                {
                    if (s == null) s = ss.accept();
                    BufferedReader in = new BufferedReader(new InputStreamReader(s.getInputStream()));

                    String line = null;
                    while ((line = in.readLine()) != null)
                    {

                        Log.d(appTag, line);

                        mClientMsg = line;
                    }

                    myUpdateHandler.sendMessage(m);
                }
                catch (IOException e)
                {
                    Log.d(appTag, e.toString());
                }
            }
        }
        catch (Exception e)
        {
            Log.d(appTag, e.toString());
        }
    }
} 
```

但是android应用程序不会收到任何数据。

谁能帮我解决我的问题？我在套接字编程方面非常菜鸟。

抱歉英语不好。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T17:05:24.983

如果您将阅读器更新为只阅读字符，然后将它们吐出，它会显示什么？例如

```
 try
            {
                if (s == null) s = ss.accept();
                BufferedReader in = new BufferedReader(new InputStreamReader(s.getInputStream()));

                char[] recvd = new char[1];
                while (in.read(recvd, 1, 1) != -1)
                {
                    String line = new String(recvd);
                    Log.d(appTag, line);

                    mClientMsg = line;
                }

                myUpdateHandler.sendMessage(m);
            }
            catch (IOException e)
            {
                Log.d(appTag, e.toString());
            } 
```

# mysql - SQL多行上的多个电话号码 - 如何将所有字段移动到1行

> ID：12041882
> 
> 赞同：0
> 
> 时间：2012-08-20T17:01:05.377
> 
> 标签：mysql, row, case

我需要将用户的 3 个电话号码组合成一行。最终结果看起来像这样

**联系方式 | 电话 | 移动 | 传真**

我的表格看起来像这样，电话号码按 phoneTypeId 分成自己的行

* * *

**contact_phone_link**
联系人 ID | 联系电话号码Id
3344 | 1

* * *

**联系人电话号码**
ID | 电话类型ID | 电话号码
123 | 1 | 555-555-5555

* * *

**phone_types**
id | 电话类型名称
1 | 电话
2 | 手机
3 | 传真

* * *

达纳感谢您的帮助，我越来越了解这一点。我看到它是如何分组和命名然后再次分组的。

我已经完成并调整了语法，但我仍然遇到“phone_link.phoneTypeId”的问题。我认为这是因为“contact_phone_link”不包含“phoneTypeId”。当 SELECT 部分和 JOIN 部分具有相同的变量名称（如“电话”）时，它也会挂起，所以我添加了 1。

告诉我，如果我离开了。

```
SELECT
    `ct`.`id` AS contact_id,
    `phone1`.`lineNumber` AS phone,
    `fax1`.`lineNumber` AS fax,
    `mobile1`.`lineNumber` AS mobile

FROM `cmd`.`contacts` AS ct

LEFT JOIN `cmd`.`contact_phone_link` AS `phone_link` ON (`phone_link`.`contactId` = `ct`.`id` AND `phone_link`.`phoneTypeId` = 1)
LEFT JOIN `cmd`.`contact_phone_numbers` AS `phone1` ON (`phone`.`id` = `phone_link`.`contactPhoneNumberId`)

LEFT JOIN `cmd`.`contact_phone_link` AS `fax_link` ON (`fax_link`.`contactId` = `ct`.`id` AND `fax_link`.`phoneTypeId` = 2)
LEFT JOIN `cmd`.`contact_phone_numbers` AS `fax1` ON (`fax`.`id` = `fax_link`.`contactPhoneNumberId`)

LEFT JOIN `cmd`.`contact_phone_link` AS `mobile_link` ON (`mobile_link`.`contactId` = `ct`.`id` AND `mobile_link`.`phoneTypeId` = 3)
LEFT JOIN `cmd`.`contact_phone_numbers` AS `mobile1` ON (`mobile`.`id` = `mobile_link`.`contactPhoneNumberId`)

WHERE (`ct`.`id` = 4160); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T17:14:09.363

我们需要创建一个`contactId`s 表并将数字加入其中：

```
SELECT
  idlist.contactId AS contactId,
  phones.phone AS phone,
  mobiles.mobile AS mobile,
  faxes.fax AS fax
FROM
  -- This builds the ID list
  (SELECT DISTINCT contactId
   FROM contact_phone_link
  ) AS idlist
LEFT JOIN
  -- This gets the landlines
  (SELECT
     contact_phone_link.contactId AS contactId,
     contact_phone_numbers.phoneNumber AS phone
   FROM contact_phone_link
     INNER JOIN contact_phone_numbers ON contact_phone_numbers.id=contact_phone_link.contactPhoneNumberId
   WHERE contact_phone_numbers.phoneTypeId=1
  ) AS phones ON phones.contactId=idlist.contactIs
LEFT JOIN
  -- This gets the mobiles
  (SELECT
     contact_phone_link.contactId AS contactId,
     contact_phone_numbers.phoneNumber AS mobile
   FROM contact_phone_link
     INNER JOIN contact_phone_numbers ON contact_phone_numbers.id=contact_phone_link.contactPhoneNumberId
   WHERE contact_phone_numbers.phoneTypeId=2
  ) AS mobiles ON mobiles.contactId=idlist.contactId
LEFT JOIN
  -- This gets the faxes
  (SELECT
     contact_phone_link.contactId AS contactId,
     contact_phone_numbers.phoneNumber AS fax
   FROM contact_phone_link
     INNER JOIN contact_phone_numbers ON contact_phone_numbers.id=contact_phone_link.contactPhoneNumberId
   WHERE contact_phone_numbers.phoneTypeId=3
  ) AS faxes ON faxes.contactId=idlist.contactId 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T17:14:20.563

下面编辑解决方案。

```
SELECT
    `ct`.`id` AS contact_id,
    `phone_sub_query`.`lineNumber` AS phone,
    `fax_sub_query`.`lineNumber` AS fax,
    `mobile_sub_query`.`lineNumber` AS mobile

FROM `cmd`.`contacts` AS ct

left join
    (select `phone_link`.`contactId`, `phone_number`.`lineNumber`
    from `cmd`.`contact_phone_link` AS `phone_link`
    join `cmd`.`contact_phone_numbers` AS `phone_number` ON (`phone_number`.`id` = `phone_link`.`contactPhoneNumberId`)
    where `phone_number`.`phoneTypeId` = 1) as `phone_sub_query` on `phone_sub_query`.`contactId` = `ct`.`id`

left join
    (select `phone_link`.`contactId`, `phone_number`.`lineNumber`
    from `cmd`.`contact_phone_link` AS `phone_link`
    join `cmd`.`contact_phone_numbers` AS `phone_number` ON (`phone_number`.`id` = `phone_link`.`contactPhoneNumberId`)
    where `phone_number`.`phoneTypeId` = 2) as `fax_sub_query` on `fax_sub_query`.`contactId` = `ct`.`id`

left join
    (select `phone_link`.`contactId`, `phone_number`.`lineNumber`
    from `cmd`.`contact_phone_link` AS `phone_link`
    join `cmd`.`contact_phone_numbers` AS `phone_number` ON (`phone_number`.`id` = `phone_link`.`contactPhoneNumberId`)
    where `phone_number`.`phoneTypeId` = 3) as `mobile_sub_query` on `mobile_sub_query`.`contactId` = `ct`.`id`

WHERE (`ct`.`id` = 4160); 
```

鉴于您的表结构，我认为可能需要使用子查询。我的解决方案实际上看起来更像@Eugene 现在的解决方案，但你想`left join`反对`inner join`. 我的子查询检查电话类型并发出 (a) 联系人 ID 和 (b) 线路号码。

让我知道这个是否奏效。我认为它应该更接近。

# wpf - 应用程序命令与自定义命令（通过中继模式）

> ID：12041883
> 
> 赞同：0
> 
> 时间：2012-08-20T17:01:13.993
> 
> 标签：wpf, command

有一个快速的理论问题 - 如果有人可以帮助回答：

WPF 提供的应用程序命令 - 它们在技术上是无用的（或不应该被利用）**，特别是在 MVVM 模式中**，因为在所有情况下都使用自定义命令（中继命令模式）。这就是我的阅读似乎表明的意思，但想对此有所了解。

[MSDN 文章](http://msdn.microsoft.com/en-us/library/system.windows.input.applicationcommands.aspx)

如果没有 - 也有人可以指出应用程序命令的快速代码示例及其在 MVVM 模式中的正确用法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T17:10:56.977

我不确定你到底在问什么；这`ApplicationCommands`是应用程序可能需要使用的一组常用命令，因此我不会说它们没用，但它们具有特定用途，在许多应用程序中可能没有用。就我个人而言，我从未使用过它们。

我想你会发现很多（包括我在内）使用 MVVM 模式编写 WPF 应用程序的人会使用[`DelegateCommand`](http://msdn.microsoft.com/en-us/library/gg431410%28v=PandP.40%29.aspx).

# c++ - 使用 C++ 套接字编程的最大 TCP 数据包大小

> ID：12041887
> 
> 赞同：2
> 
> 时间：2012-08-20T17:01:19.843
> 
> 标签：c++, sockets

我正在编写 C++ 套接字代码，我需要一些帮助！在我的程序中我不知道消息的大小，它可能会发送文件的一部分或它自己的文件，文件可能是一个巨大的文件，所以我应该指定数据包的最大大小，应该如果超过最大值，我将其划分为多个？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-20T17:06:53.943

使用时考虑“数据包”和“消息”永远不会有建设性，`TCP`因为：

*   网络引擎有自己的方法来决定最佳分段大小
*   段大小对应用程序代码**没有**影响：接收 TPC 在将数据传递给接收进程之前可以自由合并段

您应该按照设计的方式查看 TCP：按顺序可靠的**字节流**服务。因此，只需编写足够大的块，引擎及其无数规则就会处理它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T17:11:29.733

这个问题有点模糊，但这种方法似乎是普遍的。发送器应该发送接收器应该期望多少字节的指示。接收者应该期望看到这个指示，然后准备接收那么多字节。

就数据包大小而言，应用程序本身通常不关心字节在网络上的传递方式，但应用程序可能关心不调用`send`和`recv`系统调用的次数过多。这在并发服务器上尤为重要，因为效率是可伸缩性的关键。因此，您需要一个足够大的缓冲区以避免进行过多的系统调用，但又不能大到导致您长时间阻塞以等待数据流入内核缓冲区。匹配发送/接收套接字缓冲区大小通常就足够了，但这取决于其他因素，例如网络的带宽和延迟，接收器消耗数据的速度，以及您希望每个连接允许的时间片在并发期间处理。

# android - 如何在 Android 上构建 Flash 游戏？

> ID：12041895
> 
> 赞同：1
> 
> 时间：2012-08-20T17:01:43.203
> 
> 标签：android, air, flash-cs5

我有一个 .fla 游戏和你各自的 .swf，我想将 swf 转换为在 Android 平板电脑或智能手机上运行，​​我看了一些答案，但我找不到将 swf 构建到 Android 的实际方法使用 Adob​​e Flash CS5 专业版，我需要做什么？我有de Android SDK，但不知道，我看到可以用Adobe Air制作，但我不明白=/

抱歉，我是 Android 设备的新手。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T20:39:53.563

看看这个视频教程：

[http://www.youtube.com/watch?v=Jd4Wkv0dXiE](http://www.youtube.com/watch?v=Jd4Wkv0dXiE)

# ruby-on-rails - 验证导致测试失败

> ID：12041901
> 
> 赞同：0
> 
> 时间：2012-08-20T17:02:14.863
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有以下测试：

```
 test "should get create" do
   sign_in(FactoryGirl.create(:user))
    assert_difference('Inquery.count') do
      post :create, FactoryGirl.build(:inquery)
    end
    assert_not_nil assigns(:inquery)
    assert_response :redirect
  end 
```

我不断得到：

```
 2) Error:
test_should_get_create(InqueriesControllerTest):
ActiveRecord::RecordInvalid: Validation failed: Email has already been taken, License number has already been taken 
```

我不明白为什么我在这个特定的测试中得到这个错误，当我有一个非常相似的测试时：

```
 test "should get create" do
    sign_in(FactoryGirl.create(:user, admin: true))
    assert_difference('Event.count') do
      post :create, FactoryGirl.build(:event)
    end
    assert_not_nil assigns(:event)
    assert_response :success
  end 
```

这很好。明显的区别是 admin: true 行，但我怀疑这没有效果。

添加：

用户工厂.rb

```
 factory :user do
   first_name "John"
   last_name "Doe"
   email "example@example.com"
   password "foobar"
   password_confirmation "foobar"
   license_number '12345'
   state 'AZ'
   specialty 'Neurosurgery'
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T17:10:52.660

您`User`的验证失败，因为您的工厂正在为您的测试设置一个新用户，但您的数据库没有被清除。将您的工厂更改为如下所示，以便每次创建时 email 和 license_number 都是唯一的`User`：

```
factory :user do
  first_name "John"
  last_name "Doe"
  sequence(:email) { |n| "example#{n}@example.com" }
  password "foobar"
  password_confirmation "foobar"
  sequence(:license_number) { |n| "12345#{n}" }
  state 'AZ'
  specialty 'Neurosurgery'
end 
```

# batch-file - 要重命名的批次

> ID：12041902
> 
> 赞同：2
> 
> 时间：2012-08-20T17:02:23.020
> 
> 标签：batch-file, rename

我想将文件重命名为其父文件夹示例：

```
D:\Books\PDF\medical\001\99.jpg
D:\Books\PDF\medical\002\gg.jpg 
```

成为：

```
D:\Books\PDF\medical\001\001.jpg
D:\Books\PDF\medical\002\002.jpg 
```

我知道以前问过这个问题，但我无法理解。

如果可能的话，我想把它放进去`D:\Books\PDF\medical\`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T22:19:35.610

## 怎么做：

这很容易：

1) 在“D:\Books\PDF\medical\”中创建一个名为“myrename.bat”的新文本文件。

2）将以下内容粘贴到其中：

```
@echo off
pushd %~p1
for %%d in ("%CD%") do set "parentdir=%%~nd"
popd
move /Y %1 D:\Books\PDF\medical\"%parentdir%%~x1" > nul 
```

3) 从“D:\Books\PDF\medical\”，运行批处理文件，其第一个参数是要重命名的文件的名称。例如，在您的示例中，您将对文件“gg.jpg”执行以下操作：

```
myrename 002\gg.jpg 
```

这会将文件“99.jpg”重命名为“002.jpg”并将其移动到“D:\Books\PDF\medical\”。

## 这个怎么运作

批量`%~p1`返回第一个参数的相对路径，*即*剥离文件夹。例如，如果您运行`myrename Bla\002\gg.jpg`,`%~p1`将是`Bla\002`. `pushd`然后进入这个目录。

该`for`循环应该从当前路径中提取最后一个文件夹，由 给出`%CD%`，并将 的值`%CD%`分配给`%%d`。该表达式`%~nd`用于丢弃除最后一个文件夹名称之外的所有内容，获得的结果存储在变量 中`parentdir`。`popd`然后返回到原来的目录。

该`move`命令既重命名文件又移动它。新文件名是 的值`parentdir`和扩展名`%~x1`，即原始输入文件的扩展名。

希望这可以帮助。

# mongodb - 如何修改位于 MongoLab 中的集合中的字符串字段

> ID：12041904
> 
> 赞同：0
> 
> 时间：2012-08-20T17:02:37.343
> 
> 标签：mongodb, mongodb-.net-driver, mlab

我在 MongoLab 中有一个名为 CollectionA 的集合。

在此 collectionA 中的每个文档中，我想将字段（例如 Field1，它是字符串）值从“hello”修改为“hello world”

最有效的方法是什么？我应该从哪里进行更改（来自 ac# 控制台应用程序或 mongoLab 界面？）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T18:11:49.243

我实际上会使用交互式`mongo`外壳来执行此操作。使用 Web UI 中显示的连接详细信息连接到您的 mongolab 数据库。然后，使用带有“$set”运算符的“update”命令——按照[http://docs.mongodb.org/manual/reference/operator/set/中的示例行](http://docs.mongodb.org/manual/reference/operator/set/)

对于您的示例，它将是：

`db.collectionA.update( { Field1: "hello" }, { $set: { Field1: "hello world" } } );`

# c - 矩阵乘法分割错误？

> ID：12041905
> 
> 赞同：0
> 
> 时间：2012-08-20T17:02:41.803
> 
> 标签：c

需要帮助来确定程序不产生矩阵产品的原因。这个想法是：

输入 n,m,p 后跟 2 个矩阵；

第一个是“m”列矩阵的“n”行。第二个是“p”列矩阵的“m”行。

4

3

2

14 9 3

2 11 15

0 12 17

5 2 3

12 25

9 10

8 5

2个矩阵的输出产品

273 455

243 235

244 205

102 160

```
#include<stdio.h>;
#include<malloc.h>;

int main(void) {
    int r1, r2, c1, c2, i, j, e;
    int temp, **mat1, **mat2, **ansMat;

    /*Accepting row and column values of 1st matrix*/
    //Enter no. of rows for 1st matrix
    scanf("%d", &r1);
    //Enter no. of cols for 1st matrix
    scanf("%d", &c1);

    temp = c1;
    r2=temp;
    /*Accepting row and column values of 2nd matrix*/
    //Enter no. of cols for 2nd matrix
    scanf("%d", &c2);

    if (c1 != r2) {
        printf("\nIncorrect combination!\n");
        return 1;
    }

    //Allocate memory for matrix1(# of rows)
    mat1 = (int**) malloc(r1 * sizeof(int*));

    printf("Enter element of 1st matrix:\n");
    for (i = 0; i < r1; i++) {
        mat1[i] = (int*) malloc(c1 * sizeof (int));
        for (j = 0; j < c1; j++) {
            printf("\nEnter element matrix 1[%d][%d]:", i, j);
            scanf("%d", &mat1[i][j]);
        }
    }

    //Allocate memory for matrix2(# of rows)
    mat2 = (int**) malloc(r2 * sizeof (int*));

    printf("\nEnter elements of 2nd matrix:\n");
    for (i = 0; i < r2; i++) {
        mat2[i] = (int*) malloc(c2 * sizeof (int));
        for (j = 0; j < c2; j++) {
            printf("\n\tEnter element matrix 2[%d][%d]:", i, j);
            scanf("%d", &mat2[i][j]);
        }
    }

    //Print the first matrix
    printf("\nFirst Matrix:\n");
    for (i = 0; i < r1; i++) {
        for (j = 0; j < c1; j++) {
            printf("%d ", mat1[i][j]);
        }
        printf("\n");
    }

    //Print the second matrix
    printf("\nSecond Matrix:\n");
    for (i = 0; i < r2; i++) {
        for (j = 0; j < c2; j++) {
            printf("%d ", mat2[i][j]);
        }
        printf("\n");
    }

    //Allocate memory for solution matrix(# of rows)
    ansMat = (int**) malloc(r1 * sizeof (int*));

    //Allocate memory for solution matrix(# of columns)
    for (i = 0; i < c2; i++) {
        ansMat[i] = (int*) malloc(c2 * sizeof (int));
    }

    //Matrix multiplication
    for (i = 0; i < r1; i++) {
        for (j = 0; j < c2; j++) {
            ansMat[i][j] = 0;
            for (e = 0; e < r2; e++) {
                ansMat[i][j] += mat1[i][e] * mat2[e][j]);
            }
        }
    }
    //Print matrix solution
    for (i = 0; i < r1; i++) {
        for (j = 0; j < c2; j++) {
            printf("%d ", ansMat[i][j]);
        }
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T17:44:21.100

```
int temp, *mat1, *mat2, *ansMat; 
```

...

```
//Allocate memory for matrix1(# of rows)
mat1 = (int*) malloc(r1 * c1 * sizeof(int));

printf("Enter element of 1st matrix:\n");
for (i = 0; i < r1; i++) {
    for (j = 0; j < c1; j++) {
        printf("\nEnter element matrix 1[%d][%d]:", i, j);
        scanf("%d", &mat1[i*j]);
    }
} 
```

...

```
//Allocate memory for matrix2(# of rows)
mat2 = (int*) malloc(r2 * c2 * sizeof (int));

printf("\nEnter elements of 2nd matrix:\n");
for (i = 0; i < r2; i++) {
    for (j = 0; j < c2; j++) {
        printf("\n\tEnter element matrix 2[%d][%d]:", i, j);
        scanf("%d", &mat2[i*j]);
    }
} 
```

...

```
//Allocate memory for solution matrix(# of rows)
ansMat = (int*) malloc(r1 * c2 * sizeof (int));

//Matrix multiplication
for (i = 0; i < r1; i++) {
    for (j = 0; j < c2; j++) {
        ansMat[i*j] = 0;
        for (e = 0; e < r2; e++) {
            ansMat[i*j] += mat1[i*e] * mat2[e*j]);
        }
    }
} 
```

# ajax - 使用 Spring Webflow 2 进行 Ajax 验证

> ID：12041906
> 
> 赞同：1
> 
> 时间：2012-08-20T17:02:46.030
> 
> 标签：ajax, validation, spring-webflow, spring-webflow-2

我想知道是否有人可以提供帮助。我正在组装一个 Spring Webflow 应用程序，并试图弄清楚如何进行验证。

根据文档[http://static.springsource.org/spring-webflow/docs/2.0.x/reference/html/ch04s10.html](http://static.springsource.org/spring-webflow/docs/2.0.x/reference/html/ch04s10.html)我创建了一个符合 ${model}Validator 名称模式的验证器类并使用符合 validate${state} 的方法名称

```
// validation method for About You
public void validateAboutYou(QB2MotorQuote p_quote, ValidationContext p_ctx) {
    MessageContext messages = p_ctx.getMessageContext();

    // mandatory checks ...
    mandatoryChecks_AboutYou(p_quote, messages);

    // field format/content validation checks ...
    formatChecks_AboutYou(p_quote, messages);

} 
```

如上面的代码所示，我调用了 2 个方法来执行强制检查，然后是格式检查。

这工作正常 - 当页面被提交时，SWF 调用验证类 - 非常好:)

我现在想做的是通过 ajax 调用 formatChecks_AboutYou(p_quote, messages) 方法。当用户模糊每个字段时，我想触发一个 ajax 请求来验证该字段，从而拥有我所有的验证代码和规则服务器端。

我找不到任何关于如何使用 SWF 的文章。我用标准的 Spring MVC 应用程序做了一些非常相似的事情，我的控制器上有一个请求映射，专门用于 ajax 验证。这样做的好处是控制器已经引用了验证器，并且数据已经绑定到表单支持对象。

但我不确定如何使用 SWF 来解决这个问题。我暂时尝试了为 ajax 验证编写控制器的想法：

```
@Controller
public class AjaxController {

@Autowired
private QuoteValidator m_validator;

@RequestMapping(value="/AjaxValidate", method=RequestMethod.GET)
public String ajaxValidate(HttpServletRequest p_req, Model p_model) {

    // controller has access to validate via autowired m_validate
    // but the method signature I want to call is:
    //   formatChecks_AboutYou(QB2MotorQuote p_quote, MessageContext p_messages)
    // Don't know where to get a MessageContext from

    return "ajaValidate";
}
} 
```

我可以从客户端调用它没问题，但我怀疑数据会绑定到命令对象，而且我不确定从哪里获取 MessageContext 对象。

如果有人可以提供帮助，我将不胜感激；干杯

弥敦道

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T06:35:35.110

首先，您需要定义不过渡到任何地方并渲染片段的全局过渡

```
<transition on="forgotPassword">
   <evaluate expression="mybean.forgotPassword(flowRequestContext)" />
   <render fragments="forgotPassword"/>
</transition> 
```

validate 方法将在您转换到此时运行

```
private void validateForgotPassword(ValidationContext context) {
   String event = context.getUserEvent();
   Object formObject = null;
   String formName = null;
   GenericFormValidator formValidator = new GenericFormValidator(validator);
   if (StringUtils.equalsIgnoreCase(event, "forgotPassword")) {
      formObject = this.getForgotPasswordForm();
      formName = "forgotPasswordForm";
      formValidator.perform(context, formObject, formName, ForgotPasswordForm.DefaultValidationGroup.class);
   }
} 
```

你需要在瓷砖上定义你的块

```
<definition name="pages.guest.info" extends="master-layout">
    <put-attribute name="bodyId" value="guest-info" />
    <put-attribute name="body" value="/WEB-INF/jsp/pages/guest-info.jsp"/>

    <!-- specified for ajax reloading by webflow-->
    <put-attribute name="forgotUsernamePassword" value="/WEB-INF/jsp/pages/guest/chunks/request-login.jsp"/>
    <put-attribute name="forgotPassword" value="/WEB-INF/jsp/pages/guest/chunks/forget-password.jsp"/>

    <put-attribute name="jsPageBundle" value="/bundles/guest.js" />

    <put-list-attribute name="css" inherit="true">
        <add-attribute value="/bundles/module.guest.css" /> 
    </put-list-attribute>

    <put-list-attribute name="js" inherit="true">
        <add-attribute value="/js/pages/guest-flow.js" />
  </put-list-attribute>

</definition> 
```

希望这是一个起点。

# javascript - 获取随机jQuery对象的属性

> ID：12041910
> 
> 赞同：0
> 
> 时间：2012-08-20T17:02:58.433
> 
> 标签：javascript, jquery, html

我正在尝试使用以下代码在我的页面上获取图像的数据属性，但它不起作用

```
var rand_el = $('img').get(Math.floor(Math.random() * $('img').length)).attr('data-id'); 
```

但我只得到以下控制台日志：

> 未捕获的类型错误：对象`#<HTMLImageElement>`没有方法“attr”

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T17:04:59.680

[`get`](http://api.jquery.com/get/)返回一个 DOM 元素引用。用于[`eq`](http://api.jquery.com/eq/)将匹配元素集减少到指定索引处的元素，同时仍返回 jQuery 对象。

```
var rand_el = $('img').eq(Math.floor(Math.random() * $('img').length)).attr('data-id'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T17:05:25.673

该[`get`方法](http://api.jquery.com/get/)返回包装的 DOM 元素，而不是 jQuery 对象。然而[eq 方法](http://api.jquery.com/eq/)返回一个 jQuery 对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T17:07:24.297

发生这种情况是因为您有一个 javascript 对象而不是 jQ 对象。这应该适合你。

```
$($('img').get(Math.floor(Math.random() * $('img').length))).attr('data-id'); 
```

# c# - 在 Visual Studio 2010 中一键展开所有组

> ID：12041912
> 
> 赞同：0
> 
> 时间：2012-08-20T17:03:02.977
> 
> 标签：c#, visual-studio-2010, visual-studio

我有一个简单的问题。我们如何一键扩展所有组？以及如何使它们全部崩溃？

![在此处输入图像描述](../Images/e586a95cc61f15a3b78aedf27cde5b4a.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T17:06:46.963

切换所有大纲：Ctrl + M、L

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T17:06:58.760

如果按组是指区域/轮廓，则编辑 -> 轮廓菜单中有许多区域控件（也有方便的热键）。

您可能对“切换所有大纲” - Ctrl-M、Ctrl-L 或“折叠到定义” - Ctrl-M、Ctrl-O 感兴趣。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-20T17:07:08.820

我不知道一键式方法，但你可以

*   停止大纲*Ctrl-M, P*
*   切换所有大纲*Ctrl-M, L*
*   切换大纲展开 *Ctrl-M, M*

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-20T17:10:16.430

`CTRL`+ `M` `CTRL`+ `M`- 折叠/打开当前父区域

`CTRL`+ `M` `CTRL`+ `L`- 以递归方式折叠/打开文档中的所有区域（这意味着您可能只会在文档中获得一行 - 一个大的命名空间区域已折叠，否则您将看到整个页面代码未折叠

`CTRL`+ `M` `CTRL`+ `O`- 不递归地折叠所有区域

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-20T17:08:32.927

无法一键执行此操作。但是梅贝2。

折叠到定义：按住 Ctrl 键，按 M，然后按 O。
切换所有大纲：按住 Ctrl 键，按 M，然后按 L。

或者

只需转到大纲中的右键菜单。你有所有的选择。

# limesurvey - 如何避免limesurvey 发送“调查完成”邮件？

> ID：12041917
> 
> 赞同：0
> 
> 时间：2012-08-20T17:03:36.450
> 
> 标签：limesurvey

我们有一些调查，我们不想在用户完成调查后向他发送邮件。这可能吗？

我唯一的解决方案是将所有电子邮件模板清空。这阻止了石灰调查发送邮件。另一种解决方案是错误配置系统，使邮件永远无法发送。

但这两种解决方案都不令人满意。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T07:21:58.510

在最新的 LimeSurvey 2.0 中有一个新的调查设置，您可以在其中启用/禁用确认电子邮件。

# iphone - App Delegate 的生命周期 (iOS)

> ID：12041918
> 
> 赞同：2
> 
> 时间：2012-08-20T17:03:39.687
> 
> 标签：iphone, ios5, appdelegate

对不起，如果这是一个愚蠢的问题，但我正在调试我的应用程序中的一个悬空指针问题，我需要知道 - 应用程序是否有可能`resignActive`没有 first `enterBackground`？没有`becomeActive`第一`enterForeground`？

我的情况 - 我有管理所有应用程序请求/连接的类（称为“连接”）。只要应用程序还活着，它就必须可用，真的。

在我的`-didFinishLaunchingWithOptions`我初始化了一个 Connection 实例并设置了一些参数。在我`-applicationWillEnterBackground`的我暂停连接的行动。

而且，在我的`-applicationWillEnterForeground`检查中，连接实例是否仍然存在。如果是，只需恢复操作，否则创建一个新操作。

当我让应用程序运行一段时间（一个小时左右，无论是否返回主屏幕）时，应用程序都会因此错误而崩溃。

```
"2012-08-19 13:08:42.708 Picsilk[11108:707] *** -[Connection respondsToSelector:]: message sent to deallocated instance 0x24e120" 
```

'Connection' 类只是一个简单的 NSObject 子类，它管理一个 ASINetworkQueue 实例并处理我存储用户令牌和验证对我的 api 的请求的一些特定需求。

此类的一个实例由应用委托创建和管理。我的各种视图控制器使用应用程序委托来访问连接，它会自动处理队列（以及非排队请求）

当然，我缺少一些对我理解这个 SDK 非常简单和基本的东西，请帮忙。:]

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T19:23:50.570

`UIApplicationWillResignActiveNotification`当有来电或出现其他通知时，该应用程序可以接收到。所以，是的，有可能“应用程序在没有先进入背景的情况下退出活动”。

# java - 记录器正在为整个程序打印两次消息，有时甚至更多次

> ID：12041919
> 
> 赞同：1
> 
> 时间：2012-08-20T17:03:48.063
> 
> 标签：java, eclipse, logging, jboss, log4j

```
private static final Logger logger = Logger.getLogger(filename.class);

logger.debug("logger" + element); 
```

这条线打印了两次，甚至更多..

这打印为

```
logger 123
logger 123 
```

（在不同的线路上）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T17:13:24.517

我怀疑是否有多个记录器符合该类的条件（为这些合格记录器配置的附加程序应该相似）并且每个记录器都在打印消息。

查看您的 log4j 配置文件会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-22T16:01:42.550

尝试

```
BasicConfigurator.resetConfiguration() 
```

在使用 logger 的方法中*BasicConfigurator.configure()之后*

# hibernate - 在“一对多”关系中..我想从简历中删除一个学位我得到一个“事务回滚”异常

> ID：12041922
> 
> 赞同：0
> 
> 时间：2012-08-20T17:04:08.463
> 
> 标签：hibernate, jpa, annotations, ejb-3.0

在这些类（简历和学位）之间的“一对多”关系中。我的场景：CV 有 3 度..当我想从 CV 中删除一个度时，我得到一个“事务回滚”异常..

引起：java.sql.BatchUpdateException：无法删除或更新父行：外键约束失败（`consoftcv/cv_degrees`，CONSTRAINT `FKA278F3B18D2CAE7`FOREIGN KEY（`degrees_DegreeId`）REFERENCES `degrees`（`DegreeId`））

```
public void delete(Degrees e) 
{ 
   e = em.find(Degrees.class, e.getDegreeId()); 
   if (e != null) 
     em.remove(e); 
} 
```

我正在使用休眠，EJB ..有注释吗？谢谢

# hadoop - Apache Pig 不会将字符串解析为 int/long

> ID：12041923
> 
> 赞同：1
> 
> 时间：2012-08-20T17:04:10.777
> 
> 标签：hadoop, apache-pig, cloudera

我是 pig 新手，正在尝试对包含如下事件的文件执行一些基本分析：

```
1345477765  2012-08-20  08:49:24    servername  12.34.56.78 192.168.1.4 joebloggs   ManageSystem    Here's your message 
```

我尝试如下加载文件：

```
logs = LOAD '/path/to/file' using PigStorage AS (loggedtime:long, serverdate:chararray, servertime:chararray, servername:chararray, externalip:chararray, internalip:chararray, username:chararray, systemtype:chararray,  message:chararray); 
```

当我说明日志时，一切看起来都很好：

```
 Illustrate logs
    ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    | logs     | loggedtime:long      | serverdate:chararray    | servertime:chararray    | servername:chararray    | externalip:chararray        | internalip:chararray      | username:chararray    | systemtype:chararray            | message:chararray                                                                                                                         | 
    ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    |          | 1345477765 | 2012-08-20   | 08:49:24       | servername | 12.34.56.78 | 192.168.1.4 | joebloggs   | ManageSystem | Here's your message  | 
    --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 
```

此外，当描述它们时，一切都如我所料：

```
logs: {loggedtime: long,serverdate: chararray,servertime: chararray,servername: chararray,externalip: chararray,internalip: chararray,username: chararray,systemtype: chararray,message: chararray} 
```

但是，当我转储日志时，不包括记录时间。

```
dump logs;
(,2012-08-20,08:49:24,servername,12.34.56.78,192.168.1.4,joebloggs,ManageSystem,Here's your message) 
```

大概因此，我的过滤器不返回任何事件：

```
specificlog = FILTER logs BY loggedtime == 1345477765; 
```

希望我在这里遗漏了一些简单的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T18:48:00.773

我最终自己弄清楚了这一点。要解析为 long，我必须在数字末尾添加一个“L”。

例如，通过将我的源数据更改为以下内容，我能够使其正常工作。

```
1345477765L  2012-08-20  08:49:24    servername  12.34.56.78 192.168.1.4 joebloggs   ManageSystem    Here's your message 
```

希望这会帮助有同样问题的人。

# javascript - 如何仅将 target="_blank" 自动添加到外部链接？

> ID：12041935
> 
> 赞同：12
> 
> 时间：2012-08-20T17:05:20.240
> 
> 标签：javascript, jquery, django

我正在构建一个定制的、特定于行业的 cms（使用 django）。在后端，网站管理员可以指定一个内部链接，例如“/page1”或一个外部链接，用于整个网站的各种导航元素（全部`<a>`在呈现时使用）。问题是我希望在当前选项卡中打开内部链接，但应该使用外部链接`target="_blank"`打开新选项卡或窗口。

我怎样才能处理 html 来完成这个？

我更喜欢服务器端解决方案，但我不知道在 django 中预处理渲染模板的任何干净方法。因此，我认为最直接的方法可能是 javascript/jquery 解决方案：在每个页面加载时运行的脚本，它将 target="_blank" 属性添加到所有外部链接而不是内部链接。但我也不知道该怎么做。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-08-20T17:24:18.703

我一直在使用以下内容。不记得我最初在哪里找到它：

```
$.expr[':'].external = function(obj){
    return !obj.href.match(/^mailto\:/)
           && (obj.hostname != location.hostname)
           && !obj.href.match(/^javascript\:/)
           && !obj.href.match(/^$/)
}; 
```

这添加了一个`:external`jQuery 选择器，所以你可以这样做：

```
$('a:external').attr('target', '_blank'); 
```

使用自定义选择器的好处在于，如果您需要修改构成“外部”链接的内容，您可以在一处更改它，而不必担心其余代码。例如，在我的组织中，我们有某些不是“外部”的子域，但我们仍想在新窗口中打开。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-20T17:13:40.253

尝试类似的东西

```
for (var links = document.links, i = 0, a; a = links[i]; i++) {
        if (a.host !== location.host) {
                a.target = '_blank';
        }
} 
```

不要忘记在文档树中存在所有链接时运行脚本 -`window.onload`以防万一。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-20T17:25:22.400

你可以这样做：

```
$(document.body).on('mouseover', 'a[target!=_blank]:not(.local)', function (evt) {
    var a = $(this);
    var href = a.attr('href');
    var domain = href.match(/^https?:\/\/([^:\/]+)/);
    if (domain && domain[1] && domain[1] !== "yourdomain.com") {
        a.attr('target', '_blank');
    } else {
        a.addClass('local');
    }
}); 
```

这将在您单击每个链接时对其进行处理，并且不应多次处理每个链接。如果它需要是外部的，`target`将被设置为`_blank`并且它应该在新窗口中打开。[这是一个有效的 jsfiddle](http://jsfiddle.net/mU3Pm/11/)。

**更新**：我确定链接是否留在现场的方法非常粗糙。[这个答案](https://stackoverflow.com/a/12042162/777929)中的方法更彻底。我可能会用该测试替换我的简单正则表达式匹配。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-20T17:09:37.793

我建议你做那个服务器端。根据链接的位置修改页面的模板。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-12-17T10:00:09.540

由于来自@Chris Pratt 的公认答案不适用于例如 tel: links 和其他特殊情况，我只使用以下变体以免触及特殊链接：

```
(function($) {

    $.expr[':'].external = function(obj){
        return (obj.hostname != location.hostname) && obj.href.startsWith("http");
    };

    $('a:external').attr('target', '_blank');

}) (jQuery); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-04-11T14:28:47.450

你也可以这样做：

`$("a[href^='http://']").attr("target","_blank");`

或者

```
$('a').each(function() {
   var a = new RegExp('/' + window.location.host + '/');
   if(!a.test(this.href)) {
       $(this).click(function(event) {
           event.preventDefault();
           event.stopPropagation();
           window.open(this.href, '_blank');
       });
   }
}); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-05-02T15:38:15.597

代码略有变化，不会出错，在 !== 中附加 =

```
$.expr[':'].external = function(obj){
    return !obj.href.match(/^mailto\:/) && (obj.hostname !== location.hostname) && !obj.href.match(/^javascript\:/) && !obj.href.match(/^$/);
};
$('a:external').attr('target', '_blank'); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-05-30T20:44:33.810

另一个 JavaScript 解决方案：

```
(() => {
  (document.querySelectorAll('a')).forEach(link => {
    link.hostname !== location.hostname && link.setAttribute('target', '_blank');
  })
})(); 
```

# css - CSS3 多个立方体

> ID：12041937
> 
> 赞同：0
> 
> 时间：2012-08-20T17:05:23.190
> 
> 标签：css, css-transitions

我试图在一个容器中放置多个旋转立方体。将浮点值添加到立方体时，立方体的旋转会发生变化，因此**立方体会以略微倾斜的方向旋转**。

现在立方体正在旋转一个角度，看起来好像我是从侧面看它们。我希望它们在没有当前存在的倾斜的情况下沿 X 方向旋转（好像我直接在脸的前面）。

请在此处查看代码 - [http://codepen.io/iakshay/pen/iFhLH](http://codepen.io/iakshay/pen/iFhLH)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T18:25:04.853

The problem you have is that the center of your div simply is not where you expect it to be.

Your container has a width of 100% while your cubes only cover a few hundred pixels.

Depending on what you want to do (not clear from the question) either narrow your container or offset your cubes.

# html - 如何使用边框半径在 CSS3 中创建三角形

> ID：12041938
> 
> 赞同：10
> 
> 时间：2012-08-20T17:05:23.317
> 
> 标签：html, css, css-shapes

我正在使用border-radius 属性来实现圆角。但我不确定如何获得这种形状的圆角。我尝试从两侧给出相同的尺寸，但它们只是不给我确切的形状。我在这里错过了一些 CSS3 属性吗？

![在此处输入图像描述](../Images/5bbe2e85f91fe51d0fc409ba9f6f6f83.png)

只是想知道剪辑 css 属性是否是答案。

更新：

[http://jsfiddle.net/YWnzc/136/](http://jsfiddle.net/YWnzc/136/)

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-20T17:26:36.180

## 演示

```
#player {
  margin: 32px;
  position: relative;
  width: 400px;
  height: 250px;
  background-color: #222;
}

#inner {
  transform: rotate(45deg);
  background-color: silver;
  width: 100px;
  height: 100px;
  top: 20px;
  left: -50px;
  position: relative;
  border-radius: 20px;
}

#outer {
  position: absolute;
  top: 50px;
  left: 165px;
  width: 70px;
  height: 140px;
  overflow: hidden;
}
```

```
<div id="player">
  <div id="outer">
    <div id="inner"></div>
  </div>
</div>
```

这应该产生：

![在此处输入图像描述](../Images/ae4107443dacd94e5cbda13a3c903a49.png)

效果是通过创建一个正方形，用 CSS 变换旋转它，圆角，并用一个外框剪裁它来实现的。内部元件可以根据需要进行调整，因此它有些灵活。

[http://css3shapes.com/](http://css3shapes.com/)有一些很好的例子（注意页面底部的心脏）

## 备择方案

SVG 图像支持这种类型的形状，并且在所有现代浏览器中都受支持。简单的 SVG 可以手动编码为 XML，并且有各种免费/付费的编辑器可以使用它们。

另请参阅：[Raphaël，一个用于在 Web 上处理矢量图形的库](http://dmitrybaranovskiy.github.io/raphael/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-06-21T05:49:26.390

**具有边界半径的不同大小的三角形**

翻转或更改垂直对齐 fork translateY() 和 rotate()

```
/*triangle background large*/
.triangle-bg-lg, .triangle-bg-lg:before, .triangle-bg-lg:after { width: 25em; height: 25em; }

/*triangle background medium*/
.triangle-bg-md, .triangle-bg-md:before, .triangle-bg-md:after { width: 20em; height: 20em; }

/*triangle background small*/
.triangle-bg-sm, .triangle-bg-sm:before, .triangle-bg-sm:after { width: 15em; height: 15em; }

/*triangle background extra small*/
.triangle-bg-xs, .triangle-bg-xs:before, .triangle-bg-xs:after { width: 10em; height: 10em; }

/*triangle background extra extra small*/
.triangle-bg-xxs, .triangle-bg-xxs:before, .triangle-bg-xxs:after { width: 5em; height: 5em; }

/*common triangle style*/
.triangle-bg-lg,.triangle-bg-md, .triangle-bg-sm,.triangle-bg-xs,.triangle-bg-xxs {
    overflow: hidden;
    position: relative;
    margin:2em auto;
    border-radius: 20%;
    transform: translateY(50%) rotate(30deg) skewY(30deg) scaleX(.866);
} 
.triangle-bg-lg:before, .triangle-bg-lg:after,.triangle-bg-md:before, .triangle-bg-md:after, .triangle-bg-sm:before, .triangle-bg-sm:after,.triangle-bg-xxs:before, .triangle-bg-xxs:after{
    position: absolute;
    background: #ccc;
    pointer-events: auto;
    content: '';
}
.triangle-bg-xs:before, .triangle-bg-xs:after{
    background: #ccc;
    position: absolute;
    pointer-events: auto;
    content: '';
}
.triangle-bg-lg:before, .triangle-bg-md:before, .triangle-bg-sm:before, .triangle-bg-xs:before,.triangle-bg-xxs:before {
    border-radius: 20% 20% 20% 53%;
    transform: scaleX(1.155) skewY(-30deg) rotate(-30deg) translateY(-42.3%) 
            skewX(30deg) scaleY(.866) translateX(-24%);
}
.triangle-bg-lg:after, .triangle-bg-md:after,.triangle-bg-sm:after,.triangle-bg-xs:after,.triangle-bg-xxs:after {
    border-radius: 20% 20% 53% 20%;
    transform: scaleX(1.155) skewY(-30deg) rotate(-30deg) translateY(-42.3%) 
            skewX(-30deg) scaleY(.866) translateX(24%);
}
```

```
<div class="page-container">
    <div class="triangle-bg-lg"></div>
    <div class="triangle-bg-md"></div>
    <div class="triangle-bg-sm"></div>
    <div class="triangle-bg-xs"></div>
    <div class="triangle-bg-xxs"></div>
</div>
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T17:46:35.187

如果我正确理解了您的问题。我认为您可以使用以下内容：

CSS：

```
#box{   border-color: transparent transparent transparent #FFFFFF;
    border-style: solid;
    border-width: 50px 0 50px 75px;
    height: 0;
    left: -40px;
    margin: 40px;
    position: absolute;
    width: 0;
}
 #outerbox{  background:red;
    height: 300px;
    position: relative;
    width: 122px;
} 
```

HTML

```
<div id="outerbox"><div id="box"></div></div> 
```

现场演示

[http://jsfiddle.net/fsGQR//](http://jsfiddle.net/fsGQR/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-03T13:39:57.777

```
<!DOCTYPE html>
<html>
<head>
<style>

.trio {position:absolute;}
.trio .triangle {
    position: relative;
    background-color: #DB524B;
    text-align: left;
}
.trio .triangle:before,
.trio .triangle:after {
    content: '';
    position: absolute;
    background-color: inherit;
}
.trio .triangle,
.trio .triangle:before,
.trio .triangle:after {
    width:  3em;
    height: 3em;
    border-top-right-radius: 33%;
}

.trio .triangle {
    transform: rotate(-60deg) skewX(-30deg) scale(1,.866);
}
.trio .triangle:before {
    transform: rotate(-135deg) skewX(-45deg) scale(1.414,.707) translate(0,-50%);
}
.trio .triangle:after {
    transform: rotate(135deg) skewY(-45deg) scale(.707,1.414) translate(50%);
}
.trio .exclamation{
    color: #DB524B;
    position:absolute;
    font-size:50px;
    top:8px;
    left:15px;
    z-index:2;
}

.trio .triangle.tri-in {
    background-color: #fff;
    margin-top: -2.9em;
    margin-left: 1px;
}
.trio .tri-in,
.trio .tri-in:before,
.trio .tri-in:after {
    width:  2.9em;
    height: 2.9em;
    border-top-right-radius: 33%;
}
/* styles below for demonstration purposes only */
body { padding: 30%; }
</style>
</head>
<body>
<div class="trio">
<span class="exclamation">!</span>
<div class='triangle'></div>
<div class='triangle tri-in'></div>
</div>
</body>
</html> 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-12-14T00:12:45.170

这更好

CSS

```
.c1 {
    width:50px;
    height:50px;
    background-color:yellow;
    -webkit-transform:rotate(45deg);
    position: relative;
    top: -65px;
    left: 25px;
    z-index:-1;
    border: 2px solid rgba(0,255,0,.6);
}
.c2 {
    width: 50px;
    height: 72px;
    background-color: yellow;
    z-index: 10000;
    border: 2px solid rgba(0,255,0,.6);
    border-right: 0;
} 
```

HTML

```
<div class="c2">Hello</div>
<div class="c1"></div> 
```

演示：http: [//jsfiddle.net/YWnzc/237/](http://jsfiddle.net/YWnzc/237/)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2020-05-28T13:05:39.947

我用它来添加 trigle 到链接：

```
.review-box_left-link:after{
    content: '';
    position: absolute;
    width: 19px;
    height: 19px;
    background: #2195DB;
    border-radius: 2px;
    transform: rotate(-45deg);
    background: linear-gradient(to right bottom, white 0%,white 50%,#2195DB 50%,#2195DB 50%,#2195DB 100%);
} 
```

# java - Line2D Java - 获取y =值的坐标？

> ID：12041942
> 
> 赞同：0
> 
> 时间：2012-08-20T17:05:28.530
> 
> 标签：java, 2d, line, coordinate

给定一条由 (x1, y1) 和 (x2, y2) 定义的线段，找到线上 y = 某个值的位置。

我知道我可以获得直线方程，然后使用联立方程求解，但这是否可以使用 Line2D 或任何其他 Java 类？

任何建议或意见将不胜感激！

开尔文。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T17:22:59.077

对于这样的任务，我建议使用 apache commons math。

[http://commons.apache.org/math/apidocs/index.html](http://commons.apache.org/math/apidocs/index.html)

有多种方法可以做到这一点。一种方法是

```
org.apache.commons.math3.geometry.euclidean.twod.Line lineOne = new org.apache.commons.math3.geometry.euclidean.twod.Line(p,angle);

org.apache.commons.math3.geometry.euclidean.twod.Line horizontalLine = new org.apache.commons.math3.geometry.euclidean.twod.Line(new vector2d(0,yToSolveFor),pi/2);

Vector2D intersection=lineOne.intersect(horizontalLine);
intersection.getX(); // The answer 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T17:20:05.260

我认为 Java API 中没有任何东西可以实际计算交集。我认为最接近的方法是使用 Line2D 来测试线段是否与（垂直）线*y* = *k*相交以获得某个常数*k*：

```
Line2D line = new Line2D.Double(x1, y1, x2, y2);
if (line.intersectsLine(Double.MIN_VALUE, k, Double.MAX_VALUE, k)) {
    double x = (x2 - x1) * (k - y1) / (y2 - y1);
    // intersection is at (x, k)
} else {
    // intersection is outside extend of the line segment
} 
```

但是，只检查`y1 != y2`，计算交点，然后检查*x*坐标是否在 [x1, x2] 范围内可能会更有效。

# fullcalendar - 使用 fullcalendar 实现加载回调

> ID：12041943
> 
> 赞同：6
> 
> 时间：2012-08-20T17:05:32.633
> 
> 标签：fullcalendar

寻找如何实现加载回调的示例。

这是我目前使用的代码。只是不确定如何使用加载回调。

我需要将事件用作函数还是可以在此处使用的代码中添加一些内容？

谢谢

```
$('#calendar').fullCalendar({
    theme: true,
    header: {
            left: 'prev,next today',
            center: 'title',
            right: 'month,agendaWeek,agendaDay'
    },
    editable: true,

    events: {
            url: 'calendar/ajax.php',
            data: {
                uid: '<?=$_SESSION[$pageID]['owner_uid']?>',
                fbpageid: '<?=$pageID?>'
            },
            error: function() {
                alert('there was an error while fetching events!');
            }
        },

    eventMouseover: function(calEvent,jsEvent) {
        xOffset = 10;
        yOffset = 10;
        var left = (jsEvent.clientX + yOffset);
        if ( (jsEvent.clientX + 200 + yOffset) > $(window).width() ){
            left = (jsEvent.clientX - 200);
        }
        $("body").append(calEvent.tooltip);
        $("#p_"+calEvent.id)
                .css("top",(jsEvent.clientY - xOffset) + "px")
                .css("left",left + "px")
                .fadeIn("fast");
    },
    eventMouseout: function(calEvent,jsEvent) {

            $("#p_"+calEvent.id).fadeOut("fast");   
            $("#p_"+calEvent.id).remove();
    }
}); 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-20T18:42:05.583

以下是如何使用加载回调的示例：

```
loading: function(bool) {
  if (bool) 
    $('#loading').show();
  else 
    $('#loading').hide();
}, 
```

# shopify - 在 Shopify 中使用 webhook 和管理选项跟踪查询字符串

> ID：12041944
> 
> 赞同：1
> 
> 时间：2012-08-20T17:05:54.343
> 
> 标签：shopify

我被 Shopify 支持重定向到这里。对于我将要从事的一个项目，我有三个主要问题，我想看看其中一些事情的可能性有多大。

我们正在寻找与 Shopify 一起使用的插件，以通过使用链接缩短器来跟踪购买（查看哪个链接引用了哪些购买等）。即使在阅读了文档之后，我也有一些问题不是 100% 确定的。

我似乎遇到的第一个问题是跟踪链接缩短器在重定向后附加到 URL 的查询字符串。对于这项服务，他们使用“?visit_id={hash}”，我需要能够访问它——至少在订单后的“谢谢”页面上。我在文档中看到有“landing_page_ref”（http://wiki.shopify.com/Order#landing_site_ref）但考虑到我们的查询字符串是“visit_id”而不是可接受的参数之一，我将如何使用那个查询字符串？

最后，我有一个关于 webhook 如何与应用商店中的插件一起工作的问题。我知道我可以将 webhook 调用到任何我想要的地方，比如我的个人服务器，但是如果这个应用程序进入应用商店，我显然不想将所有东西都连接到我自己的服务器上。有没有办法让它在商店本身上运行，我应该使用哪个 URL？

最后，处理插件配置选项的首选方法是什么？有没有办法连接到管理后端，或者所有配置都必须在插件内的文件中？

谢谢，安德鲁

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T17:29:49.157

我会尽力为您解答这些问题。听起来您习惯于为 Wordpress 之类的东西构建插件 - Shopify 应用程序有点不同。

1.  您无法访问订单感谢页面上的任何内容。

    感谢页面/结帐流程通过一个您无权访问的安全 Shopify 页面 - 因此，如果您想了解有关您的 URL 缩短器附加到商店页面的信息，您需要在它们打开时检索它页面（使用 ScriptTag + Javascript 之类的东西来跟踪查询字符串），或者希望稍后检索它时它在 Order 中（使用 API 或 webhook）。

2.  Webhook 需要与您运行的服务器通信。

    他们将信息发送给您，然后您对其进行处理和处理。如果你想使用 webhook，你需要运行一个带有你的应用程序的服务器，以便 webhook 与之通信。

3.  您管理自己的配置。

    因为您正在运行自己的服务器来处理这些 webhook，所以您在那里处理插件的配置。我工作过的应用程序通常有自己的数据库来管理配置选项，以及管理它们的管理面板（这是用户在“管理应用程序”屏幕上单击“登录 [您的应用程序]”时访问的内容）。

您需要运行自己的服务器来托管您的 Shopify 应用。

# actionscript - 在影片剪辑中选择影片剪辑

> ID：12041949
> 
> 赞同：0
> 
> 时间：2012-08-20T17:06:14.410
> 
> 标签：actionscript, actionscript-2

如何在 acionscript 2 的影片剪辑中选择影片剪辑？我正在尝试将链接添加到六个影片剪辑，它们作为流在影片剪辑中：

```
var dots:XML = new XML();
dots.ignoreWhite = true;
dots.load('bigdot.xml');

dots.onLoad = function(success:Boolean){
    if(success){
        xmlNode = this.firstChild;
        url_array = [];
        for(i=0;i<6;i++){  

            url_array[i] = xmlNode.childNodes[i].childNodes[0].nodeValue;

        }
        var all:MovieClip = attachMovie("test","all",depth);

        trace(url_array);
    }else{
        trace("Could not load XML");
    }
}; 
```

正如您在创建“根”影片剪辑后看到的那样

```
var all:MovieClip = attachMovie("test","all",depth); 
```

其中包含我需要创建一个新循环的其他电影剪辑

```
 for(i=0;i<6;i++){

    } 
```

并为每个影片剪辑分配链接，但我不知道如何选择影片剪辑....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T21:36:24.983

如果您确保`MovieClip`要访问的父级的所有子级都具有按顺序编号的实例名称，则可以执行以下操作：

```
dots.onLoad = function(success:Boolean){
    if(success){

        // attach the MovieClip first and then we can use the reference 
        // to access the child clips when we loop over the XML
        var all:MovieClip = attachMovie("test","all",depth);

        var xmlNode = this.firstChild;
        var url;

        for(i=0;i<6;i++){  

            url = xmlNode.childNodes[i].childNodes[0].nodeValue;

            // Assumes children have instance names childClip_0 - childClip_5
            trace(all['childClip_' + i]);
        }
    }else{
        trace("Could not load XML");
    }
}; 
```

# css - 我无法将 CSS“背景大小”值添加到“背景”属性的值

> ID：12041951
> 
> 赞同：3
> 
> 时间：2012-08-20T17:06:18.513
> 
> 标签：css, background

> **可能重复：**
> [速记背景属性 (CSS3) 中的背景大小](https://stackoverflow.com/questions/7864448/background-size-in-shorthand-background-property-css3)

```
<!DOCTYPE html>
<meta charset="utf-8">
<title>An HTML5 Document</title>
<style>
    div {
        width: 500px;
        height: 400px;
        background: red url(https://www.google.com/images/logos/google_logo_41.png) 50% 50% cover no-repeat;
    }
</style>
<div></div>​ 
```

[http://jsfiddle.net/gu9fh](http://jsfiddle.net/gu9fh)

我想`background-size`用 value 定义一个 CSS 属性`cover`。但我不倾向于写一个单一的`background-size`属性。我想把它和`background`财产结合起来。但不显示背景。

如何将 CSS`background-size`值添加`cover`到`background`属性值？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T17:23:56.400

还没有注意到的是，并非所有浏览器（包括 Chrome）都支持新的 CSS3 背景简写。

为了获得更好的支持，您可能应该`background-size`单独使用该属性，因为大多数新浏览器都以这种方式支持它。

```
div {
    width: 500px;
    height: 400px;
    background: red url(https://www.google.com/images/logos/google_logo_41.png) no-repeat scroll 50% 50%;
    background-size: cover;
} 
```

上面的代码在 FireFox 和 Chrome 中都可以使用，而速记则不行。

有关演示和正确的属性排序，请参见下面的链接。

请参阅[Dev - Opera - 背景速记](http://dev.opera.com/static/dstorey/backgrounds/background-shorthand.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-20T17:13:40.127

使用速记属性时，`background-size`值必须`background-position`与`/`

更新：http: [//jsfiddle.net/5jJfQ/](http://jsfiddle.net/5jJfQ/)

请参阅此处的文档：http: [//www.w3.org/TR/2002/WD-css3-background-20020802/#properties7](http://www.w3.org/TR/2002/WD-css3-background-20020802/#properties7)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-20T17:14:07.660

参数的顺序为`background`关闭。*repeat*应该在*position*之前。然后正如 jrrdnx 指出的那样，*大小*和*位置*应由`/`

```
background: red url(https://www.google.com/images/logos/google_logo_41.png) no-repeat 50% 50%/cover; 
```

见：http: [//jsfiddle.net/gu9fh/5/](http://jsfiddle.net/gu9fh/5/)

和一个很好的参考：[http ://reference.sitepoint.com/css/background](http://reference.sitepoint.com/css/background)

**编辑：**正如 PJH 所指出的，Firefox 或 Safari 尚不支持*位置/大小的简写。*您只需要`background-size`自行设置。

```
background: red url(https://www.google.com/images/logos/google_logo_41.png) no-repeat 50% 50%;
background-size: cover; 
```

并更新了小提琴：http: [//jsfiddle.net/gu9fh/6/](http://jsfiddle.net/gu9fh/6/)

# kernel - numactl 只检测一个节点，它应该是两个

> ID：12041953
> 
> 赞同：1
> 
> 时间：2012-08-20T17:06:23.033
> 
> 标签：kernel, numa

我在 serverfault 中问过这个问题，但一周没有回复。

我有一个双 Xeon E5522 2.26Ghz CPU（一块主板上有两个四核 CPU）。据我所知，这是一个 NUMA 架构。这台机器正在运行带有 3.2 内核的 ubuntu 服务器 12.04。

```
fdyn@fdyn-0:~/dev/numa_test$ uname -a
Linux fdyn-0 3.2.0-23-generic #36-Ubuntu SMP Tue Apr 10 20:39:51 UTC 2012 x86_64    x86_64 x86_64 GNU/Linux 
```

内核应该是 numa-aware

```
fdyn@fdyn-0:~$ grep NUMA=y /boot/config-3.2.0-23-generic 
CONFIG_NUMA=y
CONFIG_AMD_NUMA=y
CONFIG_X86_64_ACPI_NUMA=y
CONFIG_ACPI_NUMA=y 
```

问题是“numactl”无法识别这两个节点，它将它视为一台大型 SMP 机器。

```
~$ numactl --hardware
available: 1 nodes (0)
node 0 cpus: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
node 0 size: 32756 MB
node 0 free: 31036 MB
node distances:
node   0 
  0:  10 
```

我需要整个环境都支持 NUMA，这样我就可以编写一个 numa 应用程序。¿ 忽略这一点是否安全？¿ 可以做些什么让 numactl 识别 2 个节点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T20:25:44.940

如评论中所述，NUMA 需要固件支持。根据主板的不同，这可能意味着您需要在 BIOS 设置工具中启用它。

某些硬件，尤其是 Apple 的 Mac Pro，没有相应的设置，并且 NUMA 控件在这些机器上不起作用。您也许可以在网上找到非官方的解决方法——如果幸运的话，Apple 不会锁定特定型号的寄存器 (MSR) 来启用它。您也许可以从 intel 找到有关 NUMA 的 MSR 文档，并使用`msr.ko`内核模块写入相关的 MSR。默认情况下，所有内存访问都在两个节点之间交错。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-13T03:54:34.477

你可以伪造 numa 节点，我在单处理器系统上做它来测试 numa 的东西

只需将参数传递给内核

numa=fake=2 将创建 2 个假 numa 节点

更多信息在这里： http: [//linux-hacks.blogspot.hk/2009/07/fake-numa-nodes-in-linux.html](http://linux-hacks.blogspot.hk/2009/07/fake-numa-nodes-in-linux.html)

# android - google play 中的所有快照应用程序如何在没有设备 root 的情况下工作？

> ID：12041962
> 
> 赞同：1
> 
> 时间：2012-08-20T17:06:57.247
> 
> 标签：android, root, google-play, snapshot

google play 中有许多应用程序`snapshot`，它们无需设备根即可工作。

我是 Android 开发的新手，所以我不知道什么可以做，什么不能做，以及它是如何完成的。

以下是您可以找到在没有设备根目录的情况下工作的应用程序列表的链接：-

[http://www.androidzoom.com/android_applications/screen+capture+no+root](http://www.androidzoom.com/android_applications/screen+capture+no+root)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T17:18:18.680

如果您阅读这些产品的描述，您会看到诸如“根据型号需要Rooting”之类的短语。那是因为您不应该能够以编程方式截取屏幕截图，尽管有根设备用户可能能够将其关闭，至少对于某些设备而言。

至少有一个此类应用程序使用的另一种技术是让开发人员计算机参与此过程，使用 DDMS 使用的 Android 机制以及用于截屏等。实际上，截屏的是电脑，而不是设备。

对于此类应用程序无需 root 和开发人员计算机即可运行的设备，这些应用程序的作者正在利用单个设备中的安全漏洞，就像恶意软件作者一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T17:21:38.223

检查这个[库](http://code.google.com/p/android-screenshot-library/)。

他们的页面似乎表明它可以在没有 root 的情况下截取屏幕截图。

> Android 屏幕截图库 (ASL) 能够以编程方式从 Android 设备捕获屏幕截图，而无需拥有 root 访问权限。相反，ASL 使用在后台运行的本机服务，每次设备启动时通过 Android 调试桥 (ADB) 启动一次。

编辑：有很多关于这个的帖子

[移动设备上的编程](https://stackoverflow.com/questions/3582603/programmatic-screencapture-on-mobile-device)
[屏幕捕获 Android 中的屏幕捕获](https://stackoverflow.com/questions/3733988/screen-capture-in-android)

# perl - 将非常大的 csv 文件与公共列合并

> ID：12041966
> 
> 赞同：3
> 
> 时间：2012-08-20T17:07:10.223
> 
> 标签：perl, unix, join, csv, awk

例如，我有两个 csv 文件，0.csv

```
100a,a,b,c,c
200a,b,c,c,c
300a,c,d,c,c 
```

和 1.csv

```
100a,Emma,Thomas
200a,Alex,Jason
400a,Sanjay,Gupta
500a,Nisha,Singh 
```

我希望输出像

```
100a,a,b,c,c,Emma,Thomas
200a,b,c,c,c,Alex,Jason
300a,c,d,c,c,0,0
400a,0,0,0,0,Sanjay,Gupta
500a,0,0,0,0,Nisha,Singh 
```

我如何在 Unix shell 脚本或 Perl 中做到这一点？我知道unix“加入”命令，它适用于小文件。例如，为了得到我的结果，我可以这样做

```
join -t , -a 1 -a 2 -1 1 -2 1 -o 0 1.2 1.3 1.4 1.5 2.2 2.3 -e "0" 0.csv 1.csv 
```

但这对我的目的来说是不可行的，因为我的实际数据文件有超过一百万列（总数据大小以千兆字节为单位），因此我的 unix 命令也将超过一百万个字符长。这可能是最令人头疼的问题，因为低效的代码很快就会陷入困境。

另请注意，只要缺少数据，我就需要占位符“0”。这使我无法简单地使用它

```
join -t , -a 1 -a 2 -1 1 -2 1 0.csv 1.csv 
```

也是初学者 Perl 程序员，所以一些细节真的很受欢迎。我更喜欢 perl 或 shell 脚本的解决方案，但实际上任何可行的方法都可以。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-04-04T07:42:14.937

如果您可以为每个文件添加标题，那么您可以使用[制表符](https://github.com/stefan-schroedl/tabulator)来解决问题。例子：

0.csv：

```
key,letter_1,letter_2,letter_3,letter_4
100a,a,b,c,c
200a,b,c,c,c
300a,c,d,c,c 
```

1.csv：

```
key,name_1,name_2
100a,Emma,Thomas
200a,Alex,Jason
400a,Sanjay,Gupta
500a,Nisha,Singh 
```

然后`tbljoin -lr -n 0 0.csv 1.csv`产生

```
key,letter_1,letter_2,letter_3,letter_4,name_1,name_2
100a,a,b,c,c,Emma,Thomas
200a,b,c,c,c,Alex,Jason
300a,c,d,c,c,0,0
400a,0,0,0,0,Sanjay,Gupta
500a,0,0,0,0,Nisha,Singh 
```

请注意（与纯 unix`join`命令相比），输入文件不需要排序；此外，您不必担心内存消耗，因为实现是基于 unix 排序的，并且将对大文件采用基于文件的合并排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T22:10:15.513

您也可以使用`awk`.

确定两个文件中最宽行的长度并将其保存到`max0`and `max1`：

```
awk -F, '
  ARGIND == 1 && NF > max0 { max0 = NF }
  ARGIND == 2 && NF > max1 { max1 = NF }
  END { print max0, max1 }
' 0.csv 1.csv | read max0 max1 
```

使用此 awk 脚本进行连接：

**foo.awk**

```
BEGIN { 
  max1--
  FS  = OFS = ","
}

ARGIND == 1 {
  A[$1] = $2

  # Copy columns from first file to key
  for(i=3; i<=NF; i++)
    A[$1] = A[$1] FS $i

  # Pad until we have max0 columns
  for( ; i<=max0; i++)
    A[$1] = A[$1] FS "0"
}

ARGIND == 2 {
  # Pad rows which are only in second file
  if(A[$1] == "") {
    A[$1] = 0
    for(i=3; i<=max0; i++)
      A[$1] = A[$1] FS "0"
  }

  # Copy columns from second file to key
  for(i=2; i<=NF; i++)
    A[$1] = A[$1] FS $i

  # Pad until we have max1 columns
  for( ; i<=max1; i++)
    A[$1] = A[$1] FS "0"
}

END { 
  for(key in A) {
    # Pad rows which are only in first file
    split(A[key], fields, ",")
    for(i=1; i <= max0+max1-length(fields)-1; i++)
      A[key] = A[key] FS "0"

    # Finally print key and accumulated column values
    print key, A[key]
  }
} 
```

运行：

```
awk -f foo.awk -v max0=$max0 -v max1=$max1 0.csv 1.csv | sort -n 
```

用 . 传递最宽的行值`-v`。输出来自散列并且未排序，因此`sort -n`在显示之前。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-23T18:11:43.690

当您处理大量数据并且两个源的大小大致相同时，合并连接是最佳选择。这是因为一旦对两个（每个）源都进行了排序，它就会使用恒定数量的内存。合并连接也是完全外部连接的一个不错的选择，它可以用 Perl 优雅地编写。

要使用以下 Perl 脚本，您必须在第一列中按字典顺序对两个文件进行排序，并且该键必须是唯一的。它还假设两个文件的每一行中的列数完全相同。

```
#!/usr/bin/perl

use strict;
use warnings;
use Text::CSV_XS;

die "Usage $0 file1.csv file2.csv" unless @ARGV > 1;

my ( $file1, $file2 ) = @ARGV;

open my $fh1, '<', $file1 or die "Can't open $file1: $!";
open my $fh2, '<', $file2 or die "Can't open $file2: $!";

my $csv = Text::CSV_XS->new( { binary => 1, eol => "\n" } );

my $r1 = $csv->getline($fh1) or die "Missing data in $file1";
my $r2 = $csv->getline($fh2) or die "Missing data in $file2";

# same amount of zeros as number of fields in each file
my @cols1 = (0) x ( @$r1 - 1 );
my @cols2 = (0) x ( @$r2 - 1 );

while ( $r1 || $r2 ) {    # there are some data

    # compare keys only if there are rows in both files
    # zero silences warnings in numeric comparisons below
    my $cmp = $r1 && $r2 && ( $$r1[0] cmp $$r2[0] ) || 0;

    # row is defined and has less or equal key than another one
    my $le1 = $r1 && $cmp < 1;
    my $le2 = $r2 && $cmp > -1;

    $csv->print(
        *STDOUT,
        [   $le1 ? $$r1[0] : $$r2[0],    # key
            ( $le1 ? @$r1[ 1 .. @cols1 ] : @cols1 ),    # first file fields
            ( $le2 ? @$r2[ 1 .. @cols2 ] : @cols2 )     # second file fields
        ]
    );

    #read next rows
    $r1 = $csv->getline($fh1) if $le1;
    $r2 = $csv->getline($fh2) if $le2;
} 
```

用法是`script.pl 0.csv 1.csv > result.csv`。如果`sort -u -d -t, -k1,1`未排序，则用于对文件进行排序。

该脚本在线性时间内工作（当已经排序时）并且仅使用内存来存储每个文件中的一行，即“恒定”大小。

您可以使用从脚本中对文件进行排序

```
$ENV{LC_ALL} = 'C';
open my $fh1, "( sed '1!d' $file1; sed 1d $file1 | sort -u -d -t, -k1,1 ) |"
    or die "Can't sort $file1: $!";
open my $fh2, "( sed '1!d' $file2; sed 1d $file2 | sort -u -d -t, -k1,1 ) |"
    or die "Can't sort $file2: $!"; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-10-23T08:20:15.857

[`csvkit`](https://csvkit.readthedocs.org/en/0.9.0/#)是一种处理 csv 文件并允许此类连接（以及其他功能）的工具。

见[`csvjoin`](https://csvkit.readthedocs.org/en/0.9.0/scripts/csvjoin.html)。它的命令行界面很紧凑，可以处理多种 csv 格式（tsv、其他分隔符、编码、转义字符等）

您要求的可以使用：

```
csvjoin --columns 0 0.csv 1.csv 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-20T18:36:48.947

如果您的文件足够小以适合 RAM，这应该很容易。您可以使用 Perl 读取文件、解析它们，然后使用公共行中的值作为散列键将行推入数组散列中。然后通过其键迭代散列的内容并打印出数组。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-08-20T18:37:07.277

这就是我想出的（perl）：

```
my $output={};

open FILE1, '</path/to/file1';
while (<FILE1>){
    chomp;
    my @values=split(/,/, $_);
    my $id=shift(@values);
    if($output->{$id}){
        my $temparray=$output->{$id};
        push (@$temparray, @values);
    }else{
        $output->{$id}=@values;
    }
}
close FILE1;
open FILE2, '</path/to/file2';
while (<FILE2>){
    chomp;
    my @values=split(/,/, $_);
    my $id=shift(@values);
    if($output->{$id}){
        my $temparray=$output->{$id};
        push (@$temparray, @values);
    }else{
        $output->{$id}=@values;
    }   
}
close FILE2; 
```

# c++ - 如何将子布局插入 QListWidgetItem？

> ID：12041970
> 
> 赞同：3
> 
> 时间：2012-08-20T17:07:30.817
> 
> 标签：c++, html, qt, user-interface

我想创建一个下载列表（如 firefox 下载列表） [（来源：][[cybernetnews.com](https://cybernetnews.com/wp-content/uploads/2007/08/firefox3downloadmanager1.jpg)][）][![](../Images/373b6c2d6fa43003122cc6d02f4316bb.png)](https://i.stack.imgur.com/5YSE5.jpg)

问题是我想制作这样的用户界面，但我真的不知道怎么做。我试图创建一个 QListWidget 但我只能设置文本和一个图标，我不能真正添加​​一个子布局。例如，我想要一个如下子布局：

```
QVBoxLayout
    QLabel
    QHBoxLayout
        QProgressBar
        QPushButton
        QPushButton
    QLabel

```

如何将这些子布局插入 QListWidgetItem？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T17:28:45.910

通常，您有 3 种不同的选择：

1.  使用 QML。我从未使用 QtQuick 开发过 smth，但它似乎提供了用于创建非常复杂的布局的工具。

2.  对列表项使用您自己的[项目委托](http://qt-project.org/doc/qt-4.8/qitemdelegate.html)。创建应该支持一些交互性的委托的任务相对困难，因为您应该自己重绘控件并根据用户操作发送信号。

3.  对列表中的每个项目使用`ListWidget`'s [`setItemWidget`](http://qt-project.org/doc/qt-4.8/qlistwidget.html#setItemWidget)。这实际上是最简单的方法（如我所见），但在*很*长的列表上可能会出现一些性能问题。在这种情况下，您只需创建具有预期布局的小部件并将其设置为每个项目。

# android - 必需的 Android 浏览器文本

> ID：12041972
> 
> 赞同：2
> 
> 时间：2012-08-20T17:07:41.803
> 
> 标签：android, android-browser

我有一些要求，我想在哪里使用 INTENT，在 Android 浏览器中输入什么 url 并将其显示在我的应用程序中。

为了您的好意，我已经检查了整个 stackoverflow 并且没有得到任何相关答案。

如果有人可以，请帮助我。如果您不理解我的问题，请不要投票。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T18:17:39.473

我认为您可以访问浏览历史记录，但不能直接访问 URL。为了访问历史记录，您需要添加`com.android.browser.permission.READ_HISTORY_BOOKMARKS`执行以下代码以获取历史记录的权限。

```
Cursor webLinksCursor = getContentResolver().query(Browser.BOOKMARKS_URI, Browser.HISTORY_PROJECTION, null, null, Browser.BookmarkColumns.DATE + " DESC");
int row_count = webLinksCursor.getCount();

int title_column_index = webLinksCursor.getColumnIndexOrThrow(Browser.BookmarkColumns.TITLE);
int url_column_index = webLinksCursor.getColumnIndexOrThrow(Browser.BookmarkColumns.URL);

if ((title_column_index > -1) && (url_column_index > -1) && (row_count > 0))
{
webLinksCursor.moveToFirst();
while (webLinksCursor.isAfterLast() == false)
{
    if (webLinksCursor.getInt(Browser.HISTORY_PROJECTION_BOOKMARK_INDEX) != 1)
    {
        if (!webLinksCursor.isNull(url_column_index))
        {
            Log.i("History" , "Last page browsed " + webLinksCursor.getString(url_column_index));
            break;
        }
    }
    webLinksCursor.moveToNext();
}            
}
webLinksCursor.close(); 
```

HISTORY_PROJECTION_BOOKMARK_INDEX 用于区分书签。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T06:52:26.477

您只能访问浏览历史记录，但不能直接访问 URL。为了访问历史记录，您需要添加权限 com.android.browser.permission.READ_HISTORY_BOOKMARKS 以执行以下代码以获取历史记录。

上面给出的代码非常正确。你可以用那个。如果有任何问题你可以再问我，然后我会告诉你一些其他的方法来达到同样的效果。首先使用此代码。

谢谢

# javascript - 使用浏览器的滚动条控制图像移动

> ID：12041977
> 
> 赞同：0
> 
> 时间：2012-08-20T17:07:56.623
> 
> 标签：javascript, jquery, image, scroll, controls

我想通过路径引导图像。浏览器向下滚动应使图像沿路径向下滚动，浏览器向上滚动应使图像回溯其路径。

这是我想要实现的示例：![在此处输入图像描述](../Images/6fc08e85ae40b8dc40ee4d955c43db81.png)

我想在用户向下滚动页面上的文章时引导该错误沿着路径向下滚动，并在用户向上滚动时使其回溯其路径（错误的头部将始终处于运动方向）。

如何使用 jQuery 和 javascript 实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T17:28:26.800

您需要计算您打算使用的路径，然后将一个函数绑定到滚动事件，该事件根据滚动的距离移动图像，例如：

```
$(window).on('scroll', function(e) {
    var S = $(this).scrollTop(),                // scrolled distance
        T = 10 + (S/24),                        // value for Top
        L = 10 + Math.abs(Math.sin(S/400)*50);  // value for Left

    $("img").css({top: T+'%', left: L+'%'});    //set CSS
});​ 
```

[**小提琴**](http://jsfiddle.net/8rAqL/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T17:32:05.510

我不相信您可以单独使用 javascript 或 jquery 直接捕获鼠标滚动。因为它适用于浏览器的一部分，并且在“窗口”内。但是，您可以捕获滚动事件。基于窗口的高度/宽度。需要通过 javascript 进行一些计算来构建一个可靠/稳定的方程，该方程适用于所有分辨率的所有浏览器。我不打算在这里详细介绍，因为您的问题相当模糊，并且没有提供要解决的问题，而不是听起来像是对答案的需求。

但是您可能想要做的本质是获取窗口/主体的宽度/高度。通过烟雾和镜子的一些诡计，或者在这种情况下是 HTML 和 CSS，并正确地将一堆层相互叠加，创建一个一英里长的页面，带有一个隐藏的滚动条，上面有 2 层一个充当您的“路径”，另一个充当您的图像。当从点 a 滚动到点 b 时，通过页面的滚动事件跟踪其中一英里长的页面。然后使用该组合与找到的宽度/高度进行调整，使其不会在任何给定点跑出屏幕（这就是你想要的）。

# java - 为什么在 JUnit 测试退出后恢复文件？

> ID：12041978
> 
> 赞同：0
> 
> 时间：2012-08-20T17:07:58.960
> 
> 标签：java, groovy, junit

我已经在基于 JUnit（我认为是 3.8.x）的 Groovy 中编写了一些单元测试，并且我注意到测试修改的文件在测试退出后会恢复。它们似乎在`tearDown()`调用方法后被重写，并恢复到它们之后的状态`setUp()`。有没有其他人看到过这种行为？可以禁用吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T17:10:04.153

JUnit 为每个方法创建一个新的 Test 实例，导致 setUp() 和 tearDown() 被多次调用。

# php - 使用 Zend 测试设置 PHPUnit

> ID：12041979
> 
> 赞同：6
> 
> 时间：2012-08-20T17:08:12.943
> 
> 标签：php, zend-framework, doctrine, phpunit, zend-test

我正在尝试将 PHPUnit 与 Zend Test 一起用于我的 Zend Framework 应用程序。我可以从命令行运行 PHPUnit 命令`phpunit --configuration phpunit.xml`。我已经尝试按照基于 Matthew Weier O'Phinney 的[博客文章的](http://mwop.net/blog/190-Setting-up-your-Zend_Test-test-suites.html)[教程](http://www.dragonbe.com/2009/11/unit-testing-with-zend-framework-18.html)进行操作。当 PHPUnit 尝试写入日志文件时出现错误。这是我的 phpunit.xml

```
<phpunit bootstrap="./Bootstrap.php" colors="true">
    <testsuite name="Zend Framework Tests">
        <directory>./</directory>
    </testsuite>
    <!-- Optional filtering and logging settings -->
    <filter>
        <whitelist>
            <directory suffix=".php">../library/</directory>
            <directory suffix=".php">../application/</directory>
            <exclude>
                <directory suffix=".phtml">../application/</directory>
            </exclude>
        </whitelist>
    </filter>
    <logging>
        <log type="coverage-html" target="./log/report" charset="UTF-8" yui="true" highlight="true" lowUpperBound="50" highLowerBound="80"/>
        <log type="testdox-html" target="./log/testdox.html"/>
    </logging>
</phpunit> 
```

我的测试引导程序：

```
<?php
//Set app paths and environment
define('BASE_PATH', realpath(dirname(__FILE__) . '/../'));
define('APPLICATION_PATH', BASE_PATH . '/application');
define('TEST_PATH', BASE_PATH . '/tests');
define('APPLICATION_ENV', 'testing');
//Set include path
set_include_path('.' . PATH_SEPARATOR . BASE_PATH . '/library' . PATH_SEPARATOR . get_include_path());
//Set the default timezone
date_default_timezone_set('America/Chicago');
?> 
```

还有我希望我的测试控制器扩展的 ControllerTestCase：

```
<?php
require_once 'Zend/Application.php';
require_once 'Zend/Test/PHPUnit/ControllerTestCase.php';

abstract class ControllerTestCase extends Zend_Test_PHPUnit_ControllerTestCase
{
    public $_application;

    public function setUp()
    {
        //Override the parent to solve an issue with not finding the correct module
        $this->bootstrap = new Zend_Application(
            APPLICATION_ENV, 
            APPLICATION_PATH . '/configs/application.ini'
        );
        parent::setUp();
    }
}
?> 
```

PHPUnit 尝试写入日志文件时出现的错误是： `Fatal error: Class 'Symfony\Component\Console\Command\Command' not found in C:\repositories\myfirstzend.com\includes\library\Doctrine\DBAL\Tools\Console\Command\ImportCommand.php on line 38`

关于我做错了什么的任何线索？我在 PHP 5.4、Windows 7、XAMPP 8.0 上，Pear 是最新的，我有最新的 PHPUnit。

**更新**如果我将我的 Bootstrap.php 更改为 Matthew Weier O'Phinney 博客中的以下内容：

```
<?php
/*
 * Start output buffering
 */
ob_start();

/*
 * Set error reporting to the level to which code must comply.
 */
error_reporting( E_ALL | E_STRICT );

/*
 * Set default timezone
 */
date_default_timezone_set('GMT');

/*
 * Testing environment
 */
define('APPLICATION_ENV', 'testing');

/*
 * Determine the root, library, tests, and models directories
 */
$root        = realpath(dirname(__FILE__) . '/../');
$library     = $root . '/library';
$tests       = $root . '/tests';
$models      = $root . '/application/models';
$controllers = $root . '/application/controllers';

/*
 * Prepend the library/, tests/, and models/ directories to the
 * include_path. This allows the tests to run out of the box.
 */
$path = array(
    $models,
    $library,
    $tests,
    get_include_path()
);
set_include_path(implode(PATH_SEPARATOR, $path));

/**
 * Register autoloader
 */
require_once 'Zend/Loader.php';
Zend_Loader::registerAutoload();

/**
 * Store application root in registry
 */
Zend_Registry::set('testRoot', $root);
Zend_Registry::set('testBootstrap', $root . '/application/bootstrap.php');

/*
 * Unset global variables that are no longer needed.
 */
unset($root, $library, $models, $controllers, $tests, $path); 
```

我继续从 Doctrine 收到有关 Symfony 的错误。我确保我也安装了 pear.symfony.com/Yaml。所以还是坏了。

如果我从我正在测试的应用程序的 app.ini 中删除 Doctrine 引用（这意味着它没有被加载），我仍然会收到错误消息。几乎感觉这三个部分（PHPUnit、ZF、Doctrine）中的每一个的加载器都在互相争斗。有没有解决的办法？

**第二次更新：**我将 PHPUnit 降级到 3.4.15，但我仍然遇到这个问题。我的下一步是从 PHP 5.4 升级到 5.3.x。

**第三次更新：**我现在在 PHP 5.3.10 上看到同样的错误。

如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T08:50:44.340

我错过了在您的引导程序中加载应用程序。

```
require_once 'Zend/Loader/Autoloader.php';
Zend_Loader_Autoloader::getInstance(); 
```

为了让您了解我的测试/bootstrap.php 中的内容（这是自 1.11.4 版以来由 zend 工具自动生成的）

```
<?php

// Define path to application directory
defined('APPLICATION_PATH')
    || define('APPLICATION_PATH', realpath(dirname(__FILE__) . '/../application'));

// Define application environment
defined('APPLICATION_ENV')
    || define('APPLICATION_ENV', (getenv('APPLICATION_ENV') ? getenv('APPLICATION_ENV') : 'testing'));

// Ensure library/ is on include_path
set_include_path(implode(PATH_SEPARATOR, array(
    realpath(APPLICATION_PATH . '/../library'),
    get_include_path(),
)));

require_once 'Zend/Loader/Autoloader.php';
Zend_Loader_Autoloader::getInstance(); 
```

正如 Zend Framework 手册所提到的，最好使用 PHPUnit 3.4.15，尽管我可以使用 PHPUnit 3.6.12 运行我的测试，因为我正在隔离我的测试以专注于我的业务逻辑而不是 Zend Framework 的逻辑。

我还将我的 phpunit.xml 修改为以下内容：

```
<phpunit bootstrap="./bootstrap.php" colors="true">
    <testsuite name="Application Test Suite">
        <directory>./application</directory>
    </testsuite>
    <testsuite name="Library Test Suite">
        <directory>./library</directory>
    </testsuite>

    <filter>
        <whitelist>
            <directory suffix=".php">../../library</directory>
            <directory suffix=".php">../../application</directory>
            <exclude>
                <directory suffix=".php">../../library/Zend</directory>
            </exclude>
        </whitelist>
    </filter>
</phpunit> 
```

我希望这可以解决您现在面临的许多问题。

此致，

米开朗基罗

# python - 在 PyQt 中正确定位弹出窗口小部件

> ID：12041980
> 
> 赞同：5
> 
> 时间：2012-08-20T17:08:15.740
> 
> 标签：python, popup, pyqt, css-position

他一直困扰着我，主要是因为移动小部件和诸如此类的方法组合有多少。本质上，我有一个简单的小部件，我希望能够在我的应用程序的特定区域弹出。问题是我似乎永远无法让它在我想要的地方弹出。此外，我想以一种方式设置它，我可以根据它是否弹出以指向应用程序左上角的小部件而不是底部的小部件来调整它的“指针”侧 -正确的。

理想情况下，我可以将弹出窗口放置在几乎靠近父小部件边缘的位置，并根据它的位置锚定它。这是我一直在尝试的。

```
from PyQt4.QtCore import *
from PyQt4.QtGui import *
import sys

class popup(QWidget):
    def __init__(self, parent = None, widget=None):    
        QWidget.__init__(self, parent)
        layout = QGridLayout(self)
        button = QPushButton("Very Interesting Text Popup. Here's an arrow   ^")
        layout.addWidget(button)
        self.move(widget.rect().bottomLeft())

class Window(QWidget):
    def __init__(self):
        QWidget.__init__(self)
        self.button = QPushButton('Hit this button to show a popup', self)
        self.button.clicked.connect(self.handleOpenDialog)
        self.button.move(250, 50)
        self.resize(600, 200)

    def handleOpenDialog(self):
        self.popup = popup(self, self.button)
        self.popup.show()

if __name__ == '__main__':
    app = QApplication(sys.argv)
    win = Window()
    win.show()
    sys.exit(app.exec_()) 
```

此代码生成一个随机位于小部件中间的按钮。在这个例子中，我想要得到的是在右上角显示其“枢轴”的按钮下方的弹出窗口，这样弹出按钮中的箭头将指向小部件的右下角。然而，它却在窗口的左上角弹出。在我玩弄 .move、.setGeometry 和玩 QRect 的过程中，我终其一生都无法弄清楚这一点。对能伸出援手的人表示极大的敬意。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-07-25T10:12:10.047

我知道这很旧，但我最近正在寻找这个，这是最好的答案；我有一个有用的补充（对于其他搜索这个食谱的人！）

我将它实现为一个 mixin，我认为它为您的对话框提供了更大的灵活性：

```
class PopupDialogMixin(object):  # will not work (with PySide at least) unless implemented as 'new style' class. I.e inherit from object
    def makePopup(callWidget):
        """
        Turns the dialog into a popup dialog.
        callWidget is the widget responsible for calling the dialog (e.g. a toolbar button)
        """
        self.setContentsMargins(0,0,0,0)
        self.setWindowFlags(QtCore.Qt.FramelessWindowHint | QtCore.Qt.Popup)
        self.setObjectName('ImportDialog')

        # Move the dialog to the widget that called it
        point = callWidget.rect().bottomRight()
        global_point = callWidget.mapToGlobal(point)
        self.move(global_point - QtCore.QPoint(self.width(), 0)) 
```

然后，您的自定义对话框将继承自`QtCore.QDialog`和`PopupDialogMixin`。这使您可以选择以“正常”方式使用对话框或使其成为弹出对话框。例如：

```
dlg = MyDialog(self)
dlg.makePopup(self.myButton) 
```

我认为将它作为一个 mixin 来实现有很多好处：

*   无需为您想要作为弹出窗口的每个自定义对话框编写“弹出”代码
*   保留对话框的“默认”行为 - 例如，如果您想在其他地方重用它作为“常规”对话框，您只需像往常一样使用它
*   无需将任何额外的东西传递`__init__`给`parent`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T18:07:50.353

给你 - 评论有点解释它背后的逻辑 - 因为问题是一个例子和关于定位，我保持其余代码相同除了弹出类，但只是提到它是一个令人讨厌的 - 你不应该导入 * （永远），但尤其是像 PyQt4.QtCore/QtGui 这样大的东西......

```
 from PyQt4.QtCore import *
    from PyQt4.QtGui import *
    import sys

    class popup(QWidget):
        def __init__(self, parent = None, widget=None):    
            QWidget.__init__(self, parent)
            layout = QGridLayout(self)
            button = QPushButton("Very Interesting Text Popup. Here's an arrow   ^")
            layout.addWidget(button)

            # adjust the margins or you will get an invisible, unintended border
            layout.setContentsMargins(0, 0, 0, 0)

            # need to set the layout
            self.setLayout(layout)
            self.adjustSize()

            # tag this widget as a popup
            self.setWindowFlags(Qt.Popup)

            # calculate the botoom right point from the parents rectangle
            point        = widget.rect().bottomRight()

            # map that point as a global position
            global_point = widget.mapToGlobal(point)

            # by default, a widget will be placed from its top-left corner, so
            # we need to move it to the left based on the widgets width
            self.move(global_point - QPoint(self.width(), 0))

    class Window(QWidget):
        def __init__(self):
            QWidget.__init__(self)
            self.button = QPushButton('Hit this button to show a popup', self)
            self.button.clicked.connect(self.handleOpenDialog)
            self.button.move(250, 50)
            self.resize(600, 200)

        def handleOpenDialog(self):
            self.popup = popup(self, self.button)
            self.popup.show()

    if __name__ == '__main__':
        app = QApplication(sys.argv)
        win = Window()
        win.show()
        sys.exit(app.exec_()) 
```

# python - numpy FloatingPointError：减法中遇到无效值 - 不可重现？

> ID：12041982
> 
> 赞同：6
> 
> 时间：2012-08-20T17:08:20.430
> 
> 标签：python, numpy

我`FloatingPointError: invalid value encountered in subtract`在一段测试代码中遇到。在代码本身没有进行任何更改的情况下开始引发异常，因此我在理解它时遇到了很多麻烦。

我的问题：是什么导致了`invalid value encountered in subtract`异常？为什么它在不同的 python+numpy 安装上会有不同的表现？

细节：

此 MWE*不会*引发`FloatingPointError`：

```
>>> import numpy as np
>>> np.__version__
 '1.6.1'
>>> x = np.arange(5,dtype='float64')
>>> y = np.ones(5,dtype='float64')
>>> x[2]=np.nan
>>> x-y
# array([ -1.,   0.,  nan,   2.,   3.]) 
```

然而，在一段代码的深处，我减去了两个`np.float64` `ndarray`对象，得到了一个浮点异常。导致异常的数组包含一些非常庞大和微小的数字（例如，1e307 和 1e-307）和一些`nan`s，但我没有对这些数字进行任何组合导致我自己进行异常测试。

更令人不安的是，我有大量的 Jenkins 测试运行与许多版本的 numpy、matplotlib、python 和 scipy 完全相同的代码，但没有一个会引发此异常。我在这一点上迷路了 - 我不知道是否有错误，或者如果有，如何追踪它。

如果您非常好奇，有问题的代码是[pyspeckit](http://pyspeckit.bitbucket.org)并且测试在`test_hr2421.py`.

编辑：跟进 - 我认为这个小片段：`np.seterr(invalid='raise')`在我正在导入的模块中被调用，特别是 pymc，并且拉取请求已经阻止了这个更改。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-08-22T19:58:19.500

Numpy 具有关于如何处理浮点错误的可配置行为。默认情况下，下溢错误会被忽略，而其他错误则会触发警告。对于每个类别，用户可以使用 更改此行为`numpy.seterr`。这些设置是全局的——这里没有命名空间；所以如果一个库调用`numpy.seterr(all='raise')`，那么这将影响整个程序，直到`numpy.seterr`再次调用。

您可以确认这确实是您的问题的原因

```
print(numpy.seterr()) 
```

应该输出类似

```
{'divide': 'warn', 'over': 'warn', 'under': 'ignore', 'invalid': 'warn'} 
```

如果其中一些类别具有 value `raise`，尤其是 key `'invalid'`，那么这将解释您正在观察的行为。

`numpy.seterr(invalid='warn')`您可以通过调用或来抑制此异常`invalid='ignore'`。有关可能的错误的完整列表，请通读[`numpy.seterr`](https://docs.scipy.org/doc/numpy/reference/generated/numpy.seterr.html).

您还可以使用上下文管理器临时更改行为：

```
In [12]: x = np.arange(-5, 5,dtype='float64')

In [13]: with np.errstate(divide="raise"):
    print(1/x)
   ....:     
---------------------------------------------------------------------------
FloatingPointError                        Traceback (most recent call last)
<ipython-input-13-881589fdcb7a> in <module>()
      1 with np.errstate(divide="raise"):
----> 2     print(1/x)
      3 

FloatingPointError: divide by zero encountered in true_divide

In [14]: with np.errstate(divide="warn"):
    print(1/x)
   ....:     
/home/users/gholl/venv/stable-3.5/bin/ipython3:2: RuntimeWarning: divide by zero encountered in true_divide

[-0.2        -0.25       -0.33333333 -0.5        -1\.                 inf
  1\.          0.5         0.33333333  0.25      ]

In [15]: with np.errstate(divide="ignore"):
    print(1/x)
   ....:     
[-0.2        -0.25       -0.33333333 -0.5        -1\.                 inf
  1\.          0.5         0.33333333  0.25      ] 
```

我倾向于将我的整个代码包装在一个`with np.errstate(all="raise")`块中，然后使用上下文管理器忽略特定条件，如果我确定问题不是隐藏错误 - 但通常是这样。

如果确实有一个库永久更改状态，我会向维护者提出问题或发送拉取请求，因为他们确实应该使用上下文管理器，因此他们的更改设置仅适用于他们的代码块，而不适用于程序的其余部分。

# java - ANDROID - 通过 tcp 套接字将屏幕截图从 java 发送到 android

> ID：12041986
> 
> 赞同：6
> 
> 时间：2012-08-20T17:08:40.753
> 
> 标签：java, android, image, sockets, tcp

我通过套接字进行了客户端-服务器聊天，效果很好。现在我想为服务器（Android 手机）添加一个选项，以从客户端（PC 应用程序）获取屏幕截图。创建屏幕截图工作正常，但从客户端到服务器的传输每次都失败。

**客户端/发件人：**

在我直接将图像写入输出流之前，但在服务器端出现错误，所以我尝试了这种方式，但它是一样的。

```
public class ClientScreenshotThread implements Runnable {

// - Software Init - //
private Socket transferSocket;
private BufferedImage screenshot;
private Robot robot;
private BufferedWriter outToServer;
private FileInputStream inStream;
private DataOutputStream outStream;

// - Var Init - //
private final int SERVER_TRANSFER_PORT = 65000;

private int screenWidth, screenHeight;

// -------------------------------------------------- //

public ClientScreenshotThread() {

}

@Override
public void run() {
    try {
        SocketAddress sockaddr = new InetSocketAddress(Client.SERVER_IP, SERVER_TRANSFER_PORT);
        transferSocket = new Socket();
        transferSocket.connect(sockaddr, 5000);     // 5sec Timeout

        Dimension dimension = Toolkit.getDefaultToolkit().getScreenSize();
        robot = new Robot();

        screenWidth = dimension.width;
        screenHeight = dimension.height;

        Rectangle screen = new Rectangle(screenWidth, screenHeight);

        screenshot = robot.createScreenCapture(screen);
        ImageIO.write(screenshot, "png", new File("/Users/chris/Downloads/screenshot.png"));

        File file = new File("/Users/chris/Downloads/screenshot.png");
        inStream = new FileInputStream(file);
        byte[] buffer = new byte[4096];

        // prepare server for receiving the screenshot
        outToServer = new BufferedWriter(new OutputStreamWriter(transferSocket.getOutputStream()));
        outToServer.write("#!<cmd>screenshot");
        outToServer.newLine();
        outToServer.flush();

        // send the screenshot to the server
        outStream = new DataOutputStream(transferSocket.getOutputStream());

        int n;
        int i = 0;
        while((n = inStream.read(buffer)) != -1) {
            i++;
            System.out.println(i + ". Byte[" + n + "]");
            outStream.write(buffer, 0, n);
            outStream.flush();
        }

    } catch(AWTException e1) {
        System.out.println("AWT: " + e1.getMessage().toString());
    } catch(IOException e2) {
        System.out.println("IO: " + e2.getMessage().toString());
    } finally {
        try {
            // close streams and socket
            inStream.close();
            outToServer.close();
            transferSocket.close();
        } catch(IOException e) {
            System.out.println(e.getMessage().toString());
        }
    }
}
} 
```

**服务器端/接收器：**

我总是在以下位置收到“NullPointerException”：

**bmp.compress(Bitmap.CompressFormat.PNG, 100, fileOutStream);**

```
public class ServerTransferThread implements Runnable {

// - Software Init - //
private ServerSocket serverTransferSocket;
private Handler handler;
private BufferedReader inFromClient;
private DataInputStream inStream;
private ByteArrayOutputStream content;
private FileOutputStream fileOutStream;

// - Var Init - //
private final String TAG = "xxx";

private final int SERVER_TRANSFER_PORT = 65000;

// -------------------------------------------------- //

public ServerTransferThread(Handler _handler) {
    this.handler = _handler;
}

@Override
public void run() {
    Log.d(TAG, "ServerTransferThread: run()");

    try {
        serverTransferSocket = new ServerSocket(SERVER_TRANSFER_PORT);

        while(ServerActivity.SERVER_STATE == true) {
            Socket socket = serverTransferSocket.accept();
            Log.d(TAG, "ServerTransferThread: accepted()");

            inFromClient = new BufferedReader(new InputStreamReader(socket.getInputStream()));
            Log.d(TAG, "ServerTransferThread: bufferedReader()");

            String message = "";
            if((message = inFromClient.readLine()) != null) {
                if(message.equals("#!<cmd>screenshot")) {
                    receiveScreenshot(socket);
                }
            }
        }
    } catch(IOException e) {
        Log.e(TAG, "ServerTransferThread 1: " + e.getMessage().toString());
    } finally {
        try {
            inFromClient.close();
            serverTransferSocket.close();
        } catch (IOException e) {
            Log.e(TAG, "ServerTransferThread 2: " + e.getMessage().toString());
        }
    }
}

private void receiveScreenshot(Socket socketX) {
    Log.d(TAG, "ServerTransferThread: receiveScreenshot()");

    try {
        handler.sendMessage(buildMessage("> Receiving screenshot.."));
        inStream = new DataInputStream(socketX.getInputStream());

        byte[] buffer = new byte[4096];
        content = new ByteArrayOutputStream();

        inStream = new DataInputStream(socketX.getInputStream());

        int n;
        while((n = inStream.read()) != -1) {     
            content.write(buffer, 0, n);     // HERE I "OUT OF MEMORY"
            content.flush();
        }

        File directory = new File(ServerActivity.APP_FOLDER_PATH);
        File screenshot = new File(ServerActivity.APP_FOLDER_PATH + "/" + "screenshot.png");

        if(!directory.exists())
            directory.mkdirs();

        if(!screenshot.exists()) {
            screenshot.createNewFile();
        }
        else {
            screenshot.delete();
            screenshot.createNewFile();
        }

        fileOutStream = new FileOutputStream(screenshot);
        Bitmap bmp = BitmapFactory.decodeByteArray(content.toByteArray(), 0, content.size());
        bmp.compress(Bitmap.CompressFormat.PNG, 100, fileOutStream);

        handler.sendMessage(buildMessage("> Screenshot received sucessfully!"));

    } catch(IOException e1) {
        Log.e(TAG, "ServerTransferThread 3: " + e1.getMessage().toString());
    } finally {
        try {
            inStream.close();
            content.close();
            fileOutStream.close();
            socketX.close();
        } catch (IOException e) {
            Log.e(TAG, "ServerTransferThread 4: " + e.getMessage().toString());
        }
    }
}

private Message buildMessage(String text) {
    Log.d(TAG, "ServerTransferThread: buildMessage()");

    Message msg = handler.obtainMessage();
    Bundle bundle = new Bundle();
    bundle.putString("MESSAGE", text);
    msg.setData(bundle);
    return msg;
} 
```

**这是我的 Logcat 输出：**

```
08-20 19:01:18.285: D/skia(5383): --- SkImageDecoder::Factory returned null
08-20 19:01:18.295: W/dalvikvm(5383): threadid=12: thread exiting with uncaught exception (group=0x40c6b1f8)
08-20 19:01:18.295: E/AndroidRuntime(5383): FATAL EXCEPTION: Thread-3051
08-20 19:01:18.295: E/AndroidRuntime(5383): java.lang.NullPointerException
08-20 19:01:18.295: E/AndroidRuntime(5383):     at net.api.speak.wifi.ServerTransferThread.receiveScreenshot(ServerTransferThread.java:114)
08-20 19:01:18.295: E/AndroidRuntime(5383):     at net.api.speak.wifi.ServerTransferThread.run(ServerTransferThread.java:58)
08-20 19:01:18.295: E/AndroidRuntime(5383):     at java.lang.Thread.run(Thread.java:856)
08-20 19:01:27.820: D/Speak WiFi(5383): Server: onDestroy()
08-20 19:01:27.830: E/Speak WiFi(5383): Server: Socket closed
08-20 19:01:27.830: E/Speak WiFi(5383): ServerThread: Socket closed 
```

* * *

**编辑：**经过一些麻烦，我找到了文件传输问题的最终解决方案！它是：

* * *

**最终服务器端：**

```
 int bytecount = 2048;
            byte[] buf = new byte[bytecount];

            OutputStream OUT = socket.getOutputStream();
            BufferedOutputStream BuffOUT = new BufferedOutputStream(OUT, bytecount);
            FileInputStream in = new FileInputStream(itemPath);

            int i = 0;
            while ((i = in.read(buf, 0, bytecount)) != -1) {
                BuffOUT.write(buf, 0, i);
                BuffOUT.flush();
            } 
```

**最终客户端：**

```
 FileOutputStream outToFile = new FileOutputStream(FileName);

        int bytecount = 2048;
        byte[] buf = new byte[bytecount];

        // Create an inputstream for the file data to arrive
        InputStream IN = socket.getInputStream();
        BufferedInputStream BuffIN = new BufferedInputStream(IN, bytecount);

        // Receiving file..
        int i = 0;
        int filelength = 0;       
        while((i = BuffIN.read(buf, 0, bytecount)) != -1) {
            filelength += i;
            outToFile.write(buf, 0, i);
            outToFile.flush();
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T17:26:00.200

NullPointerException 是因为`BitmapFactory.decodeByteArray`返回：解码的位图，如果图像无法解码，则返回 null。

服务器端（在 receiveScreenshot() 方法中），将 InputStream 字节写入 ByteArrayOutputStream 'content' 变量的部分不正确，因为`inStream.read()`应该是`inStream.read(buffer)`

Out of Memory 错误可以解释，因为`read()`方法一次只读取一个字节，然后对于每个字节，您总是写入一个 4096 字节的完整缓冲区。

**编辑：**一旦您在 fileOutputStream 中写入所有字节并且不想直接提供字节（因为在您的情况下它不起作用），要将 OutputStream 压缩为 png：

```
// Write bytes inside fileOutStream

Bitmap bmp = BitmapFactory.decodeFile(screenshot.getAbsolutePath());
bmp.compress(Bitmap.CompressFormat.PNG, 100, fileOutStream);
fileOutStream.close(); 
```

这应该可以满足您的需求，但是很遗憾解码文件，因为您应该已经知道里面的字节..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T17:18:16.570

您能否将接收到的字节直接写入 FileOutputStream。在智能手机等相当有限的设备上将 png 转换为位图有时会导致问题。

需要在接收端创建 Bitmap 对象吗？

如果没有，您可以执行以下操作：

```
InputStream is = socketX.getInputStream();
FileOutputStream outputFile = new FileOutputStream(screenshot);

int n;
while ((n = is.read(data, 0, data.length)) != -1) {
  outputFile.write(data, 0, n);
} 
```

我没有测试过代码。

# php - 如何确定 html 正文中的子字符串是否是超链接的一部分？

> ID：12041987
> 
> 赞同：0
> 
> 时间：2012-08-20T17:08:41.520
> 
> 标签：php

我一直在思考的奇怪问题。我有一个包含 HTML 的字符串，其中可能带有超链接。考虑下面的文字：

`Hello this is my EXAMPLE string of html here's a <tag> and here's another </tag>. Blah blah I'm going to hyperlink some stuff with <a href="http://www.example.com/> anchor text </a> and then finish my sentence.`

正如您在上面看到的，该短语`anchor text`是指向 的超链接的锚文本`example.com`。

我希望能够搜索类似`anchor`or的子字符串，`example`并确定每次出现是否是超链接的一部分，是否是锚文本、url 或`a`标签。

优选地，对于搜索项的每次出现，将返回一个带有真/假的数组。不区分大小写的搜索会很好，如果它返回匹配的事件会很好，所以我们会知道大小写等。上述示例的理想响应是这样的：

```
$array[0][0] = "EXAMPLE"
$array[0][1] = false
$array[1][0] = "example"
$array[1][1] = true 
```

每次出现的索引也可能是返回的有用信息。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T17:17:05.923

我认为您需要检查所有三种情况。

```
 #<a[^>]*>[^<>]*YOURTEXT[^<>]*</a># 
```

涵盖第一种情况，

```
 #<a[^>][^<>]*YOURTEXT[^<>]*>[^<>]*</a># 
```

将涵盖第二种和第三种情况。

或者，也许您最好使用更宽容的正则表达式进行检查，

```
 #<a[^<>]*>*[^<>]*YOURTEXT[^<>]*>*[^<>]*</a># 
```

然后使用 HTML 解析器验证找到的文本是否确实是有效的 A 标记。第一个测试将确保您的文本在捕获的片段中，第二个测试将确保该片段确实是一个超链接。

# javascript - 如何防止在初始化后更改某些小部件的选项？

> ID：12041989
> 
> 赞同：0
> 
> 时间：2012-08-20T17:09:07.197
> 
> 标签：javascript, jquery-ui-widget-factory

我目前正在使用 jQuery UI Widget Factory，不幸的是它[的文档很差](http://wiki.jqueryui.com/w/page/12138135/Widget%20factory)。

这是一个基本的小部件（用于测试的[jsfiddle](http://jsfiddle.net/Etyee/)）

```
(function($) {
    $.widget('ns.myWidget', {
        options: {
            min: 0,
            max: 100
        },
        _create: function() {
            console.log(this.options.min+', '+this.options.max);
        },
        _setOption: function(key, value) {
            switch(key) {
                case 'min':
                    console.log('min is now '+value);
                    break;
            }
            $.Widget.prototype._setOption.apply(this,arguments)
        },
        destroy: function() {
            $.Widget.prototype.destroy.call(this);
        }
    });
})(jQuery); 
```

我知道工厂的私有方法是伪私有的，它们仍然可以直接使用`.date()._privateMethod()`. 如您所见，我正在利用`_setOption()`来响应选项更改。

在我的示例中，我不希望`max`直接向用户公开（这意味着我不希望用户使用`.myWidget('option', 'max', value)`或更改它，`.myWidget({max: value})`但同时我想公开`min`.

所以总结一下：

*   我希望用户能够使用他们想要的任何选项来初始化（实例化）小部件（它已经实现并且正在工作）。
*   我**不**希望用户能够`max`在初始化后使用公共 API 进行更改（这意味着如果用户`max`通过直接使用`.data`或使用小部件的`.prototype`.

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T08:34:18.387

经过几个小时的挠头，我找到了它！在我的压倒一切`_setOption`中，我只需要忽略`max`.

```
_setOption: function (key, value) {
   switch (key) {
   case 'min':
      console.log('min is now ' + value);
      break;
   case 'max':
      return; //*
   }
   $.Widget.prototype._setOption.apply(this, arguments)
} 
```

* 退出此处将阻止调用`$.Widget.prototype._setOption`，因此不会更新选项。

# excel - 如何将 Excel 工作簿保存到磁盘？

> ID：12041993
> 
> 赞同：0
> 
> 时间：2012-08-20T17:09:41.737
> 
> 标签：excel, file-io, save, office-interop

我正在动态创建一个在创建时显示给用户的 Excel 文件，但是我现在还需要将文件保存到服务器上。

如何将其保存到特定文件夹？

我有以下代码

```
public void ExportMembers()
    {

        Microsoft.Office.Interop.Excel.Application xla = new Microsoft.Office.Interop.Excel.Application();

        Workbook wb = xla.Workbooks.Add(XlSheetType.xlWorksheet);

        Worksheet ws = (Worksheet)xla.ActiveSheet;

        ws.Cells[1, 1] = "Site Id";

       //I create the rest of the cells here

        xla.Visible = true; //this displays the excel spreadsheet to the user

        //client id code is here

                if (!System.IO.Directory.Exists("/Files/" + clientId + "/Excel"))
        { //if doesn't exist make folder

            System.IO.Directory.CreateDirectory("/Files/" + clientId);

            System.IO.Directory.CreateDirectory("/Files/" + clientId + "/Excel");

        }

 //save the xla as a file Here

    } 
```

如何将电子表格保存在服务器上？

任何帮助表示赞赏。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T17:16:36.563

请参阅 Microsoft.Office.Interop.Excel.Application 的 Save 方法

[http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel._application.save](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel._application.save)

# android - Android 的渐进式音频缓存库

> ID：12041994
> 
> 赞同：5
> 
> 时间：2012-08-20T17:09:44.777
> 
> 标签：android, android-mediaplayer

我现在正在使用 android MediaPlayer 类进行渐进式音频流，如下所示：

```
MediaPlayer mp = new MediaPlayer();
mp.setDataSource(audioUrl);
mp.prepare();
mp.start(); 
```

但是 MediaPlayer 类不提供任何缓存，我总是需要做这个例程：不必要的网络和电池浪费

所以，有人可以帮我找到一些可以提供缓存的库，因为我找不到任何东西。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T20:33:31.510

目前没有任何库（据我所知）为您进行缓存。您基本上需要创建一个代理来读取数据并将其写回媒体播放器。在代理中，您可以编写自己的缓存层。这并不简单，但它是目前缓存数据的唯一方法。[您可以在此处查看](http://code.google.com/p/npr-android-app/)NPR 中的代理示例（尽管它不缓存）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-26T11:33:40.703

看我的项目：

1.  [https://github.com/master255/ImmortalPlayer](https://github.com/master255/ImmortalPlayer)一个线程读取、发送和保存缓存数据。最简单的方法和最快的工作。复杂的逻辑 - 最好的方法！
2.  [https://github.com/master255/VideoViewCache](https://github.com/master255/VideoViewCache)带缓存的简单视频视图。两个线程用于播放和保存数据。逻辑不好，但是如果您需要，请使用它。

# iphone - 在 Objective-C 中获取 id 的字符串表示

> ID：12041997
> 
> 赞同：7
> 
> 时间：2012-08-20T17:10:00.290
> 
> 标签：iphone, objective-c, ios, macos, nsstring

如何获得`id`对象的最佳字符串表示？

以下是正确的吗？有没有更简单的方法？

```
id value;
NSString* valueString = nil;
if ([value isKindOfClass:[NSString class]]) {
    valueString = value;
} else if ([value respondsToSelector:@selector(stringValue)]) {
    valueString = [value stringValue];
} else if ([value respondsToSelector:@selector(description)]) {
    valueString = [value description];
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-20T17:21:22.317

该`description`方法是[`NSObject`协议](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Protocols/NSObject_Protocol/Reference/NSObject.html)的一部分，因此 Cocoa 中的任何对象都会响应它；因此，您可以发送`description`：

```
for( id obj in heterogeneousCollection ){
    [obj description];
} 
```

此外，`NSLog()`将发送`description`到作为参数传递给说明符的任何对象`%@`。

请注意，您不应将此方法用于日志记录/调试以外的目的。也就是说，您不应该依赖在框架版本之间具有特定格式的框架类的描述，而是开始做一些事情，比如根据另一个描述字符串构造对象。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-20T17:19:35.170

由于所有对象都继承自 NSObject，所以它们都响应 description 方法。只需在您的类中重写此方法即可获得所需的结果。

一些 Cocoa 类（如 NSNumber）中的描述方法在内部调用了 stringValue 方法。例如...

```
NSNumber *num = [NSNumber numberWithFloat:0.2f];
NSString *description1 = num.stringValue;
NSString *description2 = [num description];

NSLog("%@", description1);
NSLog("%@", description2); 
```

...具有相同的输出：

```
Printing description of description1:
0.2
Printing description of description2:
0.2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T17:49:26.757

我喜欢我的看起来不错：有时 Xcode 会删除换行符，有时则不会，所以 YMMV：

```
- (NSString *)description   // also used for comparison purposes
{
    NSMutableString *str = [NSMutableString stringWithCapacity:256];
#ifndef NDEBUG // so in Distribution build, this does not get included
    [str appendFormat:@"Address ID=\"%@\"\n", [self.privateDict objectForKey:kID]];
    [str appendFormat:@"  usrID:      %@\n", [self.privateDict objectForKey:kADuserID]];
    [str appendFormat:@"  first:      %@\n", [self.privateDict objectForKey:kADfirstName]];
    [str appendFormat:@"  last:       %@\n", [self.privateDict objectForKey:kADlastName]];
    [str appendFormat:@"  address:    %@\n", [self.privateDict objectForKey:kADaddress]];
    [str appendFormat:@"  suite:      %@\n", [self.privateDict objectForKey:kADsuiteApt]];
    [str appendFormat:@"  city:       %@\n", [self.privateDict objectForKey:kADcity]];
    [str appendFormat:@"  state:      %@\n", [self.privateDict objectForKey:kADstate]];
    [str appendFormat:@"  zip:        %@\n", [self.privateDict objectForKey:kADzipCode]];
    [str appendFormat:@"  phone:      %@\n", [self.privateDict objectForKey:kADphone]];
#endif
    return str;
} 
```