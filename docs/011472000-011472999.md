# StackOverflow 问答 11472000-11472999

# url - magento 自定义 url 重写为 cms 页面的 .html

> ID：11472000
> 
> 赞同：2
> 
> 时间：2012-07-13T13:59:44.740
> 
> 标签：url, magento, url-rewriting

我正在将电子商务网站移动到 magento 中，并希望保留尽可能多的索引链接。例如：关于页面的 url 是`domain.com/about.html`. Magento 将 url 写入`domain.com/about`. 如果我添加自定义重写并强制将 .html 重写到最后，我会收到 404 page not found 错误。

我正在尝试做的事情可能吗？我也尝试重新索引商店，但没有帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T14:48:01.333

如果您可以制作一个小模块，则可以使用`cms_controller_router_match_before`在类中调度的事件`Mage_Cms_Controller_Router`来处理`.html`CMS 页面的 URL 键中的后缀（当它出现在`condition`对象中传递的标识符中时将其删除）。

`.html`否则，您可以通过在 URL 键的末尾添加来获得几乎相同的结果。

# java - MapView空指针异常

> ID：11472002
> 
> 赞同：0
> 
> 时间：2012-07-13T13:59:57.293
> 
> 标签：java, android, google-maps

我一直在试图找出这个错误的原因：

```
>07-13 23:44:06.715: E/AndroidRuntime(2932): FATAL EXCEPTION: main
07-13 23:44:06.715: E/AndroidRuntime(2932): java.lang.NullPointerException
07-13 23:44:06.715: E/AndroidRuntime(2932):     at android.app.Activity.findViewById(Activity.java:1825)
07-13 23:44:06.715: E/AndroidRuntime(2932):     at com.example.usignasync.MainActivity.runOverlaysAgain(MainActivity.java:141) 
```

我的目标是在 GPS 的位置发生变化时重新加载一些地图叠加层，所以我设置并`onLocationChanged()`调用了 GPS `runOverlaysAgain()`，但是我不能调用在`findViewById`类之外使用的函数`Activity`。这是因为`onLocationChanged()`在使用 MapActivity 的类中`LocationListener`，并且`runOverlaysAgain()`在使用 MapActivity 的类中。所以基本上`findViewById`不能从中运行 `LocationListener`，我将如何解决这个问题？下面是`runOverlaysAgain()`第二行是错误中提到的第 141 行：

```
protected void runOverlaysAgain(){
    mapView = (MapView) findViewById(R.id.mapview);
    mapOverlays = mapView.getOverlays();    
    Log.d("A", Integer.toString(mapOverlays.size()));
    mapOverlays.clear();
        String latitude;
        String longitude;
        if(lastKnownLocation!=null){
        latitude =    GPSTracker.yourLocation.substring(3,GPSTracker.yourLocation.indexOf("Long"));
        longitude = GPSTracker.yourLocation.substring(GPSTracker.yourLocation.indexOf("Long")+4, GPSTracker.yourLocation.length());
        }
        else{
            latitude="92000";
            longitude ="92000";
        } 
```

很多重新声明只是我试图弄清楚发生了什么，没有占上风。它们可以被删除，并且将再次生成类似的错误。所以我需要做两件事，要么如何修复这个错误，要么如何在 onCreate() 之外创建 mapOverlays。

这是 XML：

```
<Button
    android:id="@+id/readWebpage"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:onClick="readWebpage"
    android:text="Load Webpage" >
</Button>
<com.google.android.maps.MapView
xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/mapview"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:clickable="true"
android:apiKey="0IhkxetuKVA3ujGbdU8kltq8tCDodiOrV-92Low"/>
<TextView
    android:id="@+id/TextView01"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:text="Example Text" >
    </TextView>
</LinearLayout> 
```

任何帮助表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:12:27.430

首先给予这个许可

然后在 res/layout/main.xml 中以这种方式声明 mapview

```
<?xml version="1.0" encoding="utf-8"?>
<com.google.android.maps.MapView
xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/mapview"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:clickable="true"
/> 
```

然后像这样在您的主要活动中调用地图视图

```
MapView mapView = (MapView) findViewById(R.id.mapview);
mapView.setBuiltInZoomControls(true); 
```

# asp.net-mvc-3 - 我应该如何处理这个 MVC3 / RavenDB 应用程序的搜索结果缓存？

> ID：11472003
> 
> 赞同：2
> 
> 时间：2012-07-13T13:59:57.293
> 
> 标签：asp.net-mvc-3, caching, ravendb

在我的简单 MVC3 应用程序中，用户可以对我的数据执行搜索，这些数据保存在 RavenHQ 的 RavenDB 数据库中。我知道 RavenDB 会主动缓存，但我想首先通过缓存搜索来避免对 RavenHQ 的 http 调用。每个用户可能会多次执行相同的搜索，并且不同的用户也可能会执行相同的搜索。数据不会比每周更频繁地更改。

搜索参数是搜索对象的属性。我尝试在操作（如下）上使用输出缓存但没有成功，这在搜索对象上有所不同。可能我需要单独更改搜索对象的每个属性，但这似乎不令人满意，因为我将来可能会添加更多属性。

你会如何处理这个问题？

1.  动作的输出缓存因 search.AccName 等而异。
2.  Web 应用程序中没有缓存，依赖 RavenDB 缓存。
3.  使用 HttpRuntime.Cache （但如果是，如何）？
4.  其他一些策略。

原谅代码格式，有一些问题。

```
public class AccItemSearch
{
    public string Location { get; set; }
    public string AccName { get; set; }
    public int? MinPrice { get; set; }
    public int? MaxPrice { get; set; }
} 

public class AccItemSearchResults
{
    public IEnumerable<AccItem> AccItems { get; set; }
    public AccItemSearch Search { get; set; }
}

public PartialViewResult Accommodation(AccItemSearch search)
{
    var accItems = new List<AccItem>();
    using (IDocumentSession session = MvcApplication.Store.OpenSession())
    {
        // fill accItems collection by querying the RavenDB database
    }
    return PartialView(new AccItemSearchResults 
    {
        AccItems = accItems.ToList(), Search = search
    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T07:55:14.623

RavenDB 对此具有内置支持，请参阅： [http ://ayende.com/blog/25601/ravenb-aggressive-caching-mode](http://ayende.com/blog/25601/ravendb-aggressive-caching-mode)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:21:33.467

由于您正在异步执行此操作方法，因此我将尝试使用 OutputCache 属性：

```
[OutputCache(VaryByParam = "*", Duration = 1800)]
public PartialViewResult Accommodation(AccItemSearch search)
{
    var accItems = new List<AccItem>();
    using (IDocumentSession session = MvcApplication.Store.OpenSession())
    {
        // fill accItems collection by querying the RavenDB database
    }
    return PartialView(new AccItemSearchResults 
    { 
        AccItems = accItems.ToList(), Search = search 
    });
} 
```

VaryByParam 应该告诉它根据搜索视图模型参数中的属性单独缓存。

# asp.net - 在单个 Web 部件上禁用输出缓存 (MOSS 2007)

> ID：11472005
> 
> 赞同：1
> 
> 时间：2012-07-13T14:00:07.017
> 
> 标签：asp.net, caching, sharepoint-2007, web-parts

我们在 Sharepoint 2007 上运行我们的外部网站，所有内容都从列表数据中提取并使用 C# Web 部件生成。

这是我的问题：我在主页上有一个 Web 部件，在每次页面加载时都会显示一个随机标题横幅。不幸的是，Sharepoint 似乎在缓存这个标头并每次都显示相同的图像，而不是随机化它。我知道这一点是因为 Web 部件对登录用户正常工作，并且我们告诉 SP 禁用登录用户的输出缓存。

我想为匿名用户启用输出缓存，但不知何故告诉 sharepoint 不要缓存这个特定的 web 部件。我知道有一种方法可以做到这一点，但似乎有很多不同的方法来处理缓存，我不知道哪一种会起作用。我应该注意，我已经尝试在 Web 部件代码中使用 PartCacheInvalidate 方法，但没有成功。有任何想法吗？

# reporting-services - SSRS 2008 R2 按需钻取到子报表

> ID：11472009
> 
> 赞同：4
> 
> 时间：2012-07-13T14:00:17.047
> 
> 标签：reporting-services, ssrs-2008, subreport, ssrs-tablix, ondemand

在 SSRS 2008 R2 中，我的印象是深入到子报表会按需查询数据。当我的报告被渲染时，情况并非如此。

具体来说，我有一个 Tablix，它最初加载按人分组的行。当有人单击该人员上的向下钻取图标时，子报表会显示更多与该人员相关的数据。这里的问题是，每个子报表都是在呈现主报表时最初加载的。这需要永远加载。但是，如果我删除子报告，仅出于测试目的，报告几乎会立即加载。

我尝试将子报表的可见性设置为最初隐藏，然后在用户向下钻取时显示，但它没有改变任何东西。

我在 stackoverflow 上阅读了一个类似的问题，但答案是改用 Drill-Throughs。不幸的是，这不是我的选择。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T14:35:02.377

延迟数据加载的唯一方法是实际使用新报表并通过钻取方法访问它。这是产品工作的方式，也是微软想要的方式。

您可以优化存储过程、限制每页的结果数量或使用钻取。

# android - 在android上保存未执行的网络操作

> ID：11472013
> 
> 赞同：0
> 
> 时间：2012-07-13T14:00:34.823
> 
> 标签：android, networking, service, storage

我有点问题。

我有一个正在运行的 android 应用程序，非常棒。我使用“cleanservice”将操作存储在 BlockingQueue 中，然后每分钟执行一次服务运行。现在，当用户想要关闭应用程序时，就会出现问题。当他想关闭时，我最后一次运行该服务以通过 Internet 发送所有操作。

但是当没有可用的互联网连接时，我所有排队的操作都会丢失。

如果无法发送，我需要一种方法来在关闭时存储这些操作（例如在 sharedpreferences 或文件中或......）。当我再次打开应用程序时，我可以检查是否有未执行的操作需要发送。

我发现[有](http://developer.android.com/guide/topics/data/data-storage.html#pref)几种存储数据的方法。但是最好的方法是什么？

```
if(!finaltry)
                processActionQueues(true, true);
            else{
                // We get here when we are logging off (shutting down) and our final try has failed to send the updates to the server
                // We are going to save the actions so we can send them when we log on again

            } 
```

我的操作来自这个界面：

```
public interface IWebServiceAction {
/**
 * Executes the action on the server.
 * Here you would typically do an http request to the webservice 
 * @param ctx
 * @return
 * @throws IOException
 * @throws AuthenticationException 
 */
boolean execute(Context ctx) throws IOException, AuthenticationException;
/**
 * Indicates whether this is an urgent action. If the action is
 * to be executed by the CleanService then it will execute it
 * immediately if the action is urgent.
 * Default = false
 * @return
 */
boolean isUrgent();
/**
 * If the user needs to be logged into the system before we can
 * execute the action then isPrivate is true.
 * Public actions that can be executed regardless of login are for
 * example the login action itself, or a check for updates.
 * Default = true
 * @return
 */
boolean isPrivate();

/**
 * Indicates whether this action requires that all previous actions are 
 * executed before we begin executing this one
 * @return
 */
boolean requiresQueueuToBeCompleted(); 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:29:00.627

You can set up an SQLite database and keep track of your actions by that. That would make your queue obsolete and your action are always already stored in case the app gets force closed.

Or simply store them serialized (JSON?) to sharedpreferences.

# c - 菜单选项导致程序失败。（C）

> ID：11472018
> 
> 赞同：1
> 
> 时间：2012-07-13T14:00:48.010
> 
> 标签：c, debugging, callstack

我正在开发一个基于文本的小游戏。

有时当用户按下“1”或戳程序停止时，用户有一些攻击选项：

```
 while(1)
    {
    if (round > 1) //First time no pause
        Sleep(500); //Cleans up timing... i like it

    score_round = 0;
    //This is so ugly fix it!
    printf("Round %d: \nChoose Your Attack:(1/2/.../D)\n\n1.Jab\t\tOr D to defend\n2.Cross\n3.Hook\n",round);
    action = getch();

    //Create the damage for each player
        if(action == '1')
        {
            UserAttack = rand() % (UserStats[0]-2);
            EnemyAttack = rand() % (EnemyStats[0]-3);
            break;
        }

        else if(action == '2')
        {
            UserAttack = rand()  %UserStats[0];
            EnemyAttack = rand() %EnemyStats[0];
            break;
        }

        else if(action == '3')
        {
            UserAttack = rand()  %(UserStats[0]+4);
            EnemyAttack = rand() %(EnemyStats[0]+2);
            break;
        }

        else if(action == 'D' || action == 'd')
        {
            UserAttack= 0;
            EnemyAttack = defense(); //Defense randomizes a number upto 3 if it is 1 the enemy attack is 1 point
            break;
        }

        else //Ensures the key pressed is a valid choice
        {
            system("cls");
            printf("INVALID ACTION PRESS ANY KEY TO RECHOOSE:"); getch(); //TODO: Pressing this clears the health screen!
            system("cls"); //Clears screen just in case
            continue;
        }
    } 
```

我运行了调试器，所有变量都很好，但是调用堆栈（我不知道返回了这个）

![调用堆栈](../Images/071f2f9f3da2d4e488c738631e37c2de.png)

如果您需要更多信息，请告诉我！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:23:25.193

您的 userstats 或enemystats 的值可能较低，从而导致表达式

```
EnemyStats[0]-3 
```

为零。这导致采用 mod 0 的东西，这很糟糕。

你可能会使用类似的东西

```
x ? y%x : x 
```

得到你想要的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T15:05:05.957

我认为 switch case 会是一个更好的选择，太多的 if 违反了代码的可读性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T00:59:46.207

我通过将 if(action == '1') {} 中的内容替换为

```
 if(UserStats[0]  <= 2) UserAttack  = rand() %2; //Ensure users strength is above 2
                else UserAttack = rand() % (UserStats[0]-2);

                if(EnemyStats[0] <= 3) EnemyAttack = rand() %2; //Ensures enemies strength is above 3
                else EnemyAttack = rand() % (EnemyStats[0]-3);
                break; 
```

感谢大家的帮助和支持！我确信有一种更简单的方法可以做到这一点，但我喜欢这种方式，因为它有助于我更好地理解代码以备将来使用！:)

# c++ - c++中的TCP/Ip网络通信

> ID：11472019
> 
> 赞同：0
> 
> 时间：2012-07-13T14:00:57.200
> 
> 标签：c++, sockets, tcp-ip

我正在尝试编写一个线程函数，通过 Tcp/ip 通过本地网络将系统信息发送到另一台计算机。我一直在使用套接字来实现这一点，到目前为止，这一切都很好。但我现在处于通常可以正常工作的地步，但大约 30% 的时间我收到错误消息，告诉我无法打开套接字。我将 activeSocket 库用于套接字。

```
#include "tbb/tick_count.h"
#include "ActiveSocket.h"

using namespace std;

CActiveSocket socket;
extern int hardwareStatus;

int establishTCP() {
 char time[11];
 int communicationFailed = 0;
 memset(&time, 0, 11);
 socket.Initialize();
 socket.SetConnectTimeout(0, 20);
 socket.SetSendTimeout(0, 20);
 return communicationFailed;
}

int monitor() {
 cout << "Monitor: init continious monitoring" << endl;
 int communicationFailed;
 tbb::tick_count monitorCounter = tbb::tick_count::now();
 while (!closeProgram) {
  tbb::tick_count currentTick = tbb::tick_count::now();
  tbb::tick_count::interval_t interval;
  interval = currentTick - monitorCounter;
  if (interval.seconds() > 2) {
   monitorCounter = tbb::tick_count::now();
   communicationFailed = 1;
   char buffer[256];
   sprintf(buffer, "%d;", hardwareStatus);

   establishTCP();

   char *charip = new char[monitoringIP.size() + 1];
   charip[monitoringIP.size()] = 0;
   memcpy(charip, monitoringIP.c_str(), monitoringIP.size());
   const uint8* realip = (const uint8 *) charip;
   int monitorCount = 0;
   cout << "Monitor: " << buffer << endl;
   while (communicationFailed == 1 && monitorCount < 2) {
    monitorCount++;
    if (socket.Open(realip, 2417)) {
     if (socket.Send((const uint8 *) buffer, strlen(buffer))) {
      cout << "Monitor: Succeeded sending data" << endl;
      communicationFailed = 0;
      socket.Close();
      } else {
       socket.Close();
       communicationFailed = 1;
       cout << "Monitor: FAILED TO SEND DATA" << endl;
      }
     } else {
       socket.Close();
       communicationFailed = 1;
       cout << "Monitor: FAILED TO OPEN SOCKET FOR DATA" << endl;
      }
     }
    if (monitorCount == 2) cout << "Monitor: UNABLE TO SEND DATA" << endl;
   }
  }
  return communicationFailed;
 } 
```

我认为我对这些功能做错了，问题不在接收数据的另一端。任何人都可以在此代码中看到任何可能导致失败的明显错误吗？我不断收到自己的 cout 消息`"Monitor: FAILED TO OPEN SOCKET FOR DATA"`

编辑：使用 telnet 一切正常，100% 的时间

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:23:09.227

You can use [netstat](http://en.wikipedia.org/wiki/Netstat) to check that the server is listening on the port and connections are being established. [Snoop](http://en.wikipedia.org/wiki/Snoop_%28software%29) is another good application in your Armour for finding out what is going wrong. Another possibility is to use `telnet` to see if the client can connect to that IP address and port. As to the code I will take a look at it later to see if something has gone awry.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T15:30:35.433

`socket` is a global variable. It might be re-used concurrently between two threads or sequentially inside one thread. In fact, the `while(~closeProgram)` loop indicates that you intend to use it sequentially.

Some [documentation for `CActiveSocket::Open`](http://sockets.carrierlabs.com/classCActiveSocket.html#5701a40f547abb0f71b7c94e998c0008) reads: "*Connection-based protocol sockets (CSocket::SocketTypeTcp) may successfully call Open() only once...*"

Perhaps your program fails when you call `.Open()` twice on the same object.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T08:09:29.697

I eventually found out the problem with my code. As the connection was unstable and working for 70% of the time it seemed to be a timeout issue. I removed the two timeout settings

```
socket.SetConnectTimeout(0, 20);
socket.SetSendTimeout(0, 20); 
```

Now it works perfectly fine, thanks for the troubleshooting tips though!

# python-2.7 - 在 Ubuntu 11.04 上安装 ocropus

> ID：11472021
> 
> 赞同：2
> 
> 时间：2012-07-13T14:00:58.697
> 
> 标签：python-2.7, shared-libraries, ocr, ubuntu-11.04

我需要在 Ubuntu 11.04 上安装 ocropus。

我经历了一个漫长而痛苦的过程，从项目的下载页面尝试 ocropus 0.3 和 0.4，但无济于事 - 我找不到让它找到它推荐的 tesseract 的方法。我在 Google 上工作并遇到了[http://code.google.com/p/ocropus/wiki/InstallTranscript](http://code.google.com/p/ocropus/wiki/InstallTranscript)页面。

伟大的。除非我发出命令：

```
hg clone $release https://ocropus.googlecode.com/hg/ ocropus 
```

我收到错误消息：

```
abort: unknown revision 'ocropus-0.4.4'! 
```

archlinux ocropus 包的维护者在[http://aur.archlinux.org/packages.php?ID=13444](http://aur.archlinux.org/packages.php?ID=13444)的帖子说

> 他们已经完全重构了 ocropus，同时他们还完全删除了旧存储库，因此无法访问旧的“稳定”版本。我建议至少暂时使用 ocropus-hg 包。

我想我会继续这个想法并发出命令：

```
hg clone https://ocropus.googlecode.com/hg/ ocropus #I deftly avoid any 
                                                              mention of the release 
```

结果是我得到一个文件夹，其中包含一个有趣的名为 ocroinst 的文件。我运行它，它说我需要运行以下命令：

```
sudo ./ocroinst packages #checks the dependencies
./ocroinst install       #installs ocropus
sudo ./ocroinst dl       #downloads models 
```

我很高兴，我发出了第一个命令，也就是我收到消息的时候：

> 包 libjpeg8-dev 不可用，但被另一个包引用。这可能意味着该软件包丢失、已过时或只能从其他来源获得 E：软件包 libjpeg8-dev 没有安装候选

我认为某个墨菲可能说得有道理。

情况是这样的：

（如果我错了请纠正我）

1.  Ubuntu 11.04 带有 libjpeg62-dev。ocropus 所需的版本是 libjpeg8-dev。

2.  Ocropus 需要 libtiff4-dev，而 libtiff4-dev 依赖于 libjpeg62-dev。因此我无法卸载 libjpeg62-dev。

3.  libjpeg62-dev 与 libjpeg8-dev 冲突。因此，我只能拥有 libjpeg8-dev 或 libjpeg62-dev 之一，而不能同时拥有两者。

4.  如果安装了 libjpeg8-dev，我将没有 libjpeg62-dev，这意味着我必须删除 libtiff4-dev，因此无法安装 ocropus。

5.  如果安装了 libjpeg62-dev，我将没有 libjpeg8-dev，因此我将无法安装 ocropus。

**笔记：**

（实验说明）

我已经在系统上安装了 libjpeg62-dev。我想我可以抓住机会，我直接将我能找到的每个 libjpeg8-dev 更改为*libjpeg-dev*，并运行了 3 个命令。

它安装了。没有错误。

这让我非常高兴，直到我运行命令

```
ocropus <image-file-name> 
```

我受到了迷人的欢迎：

```
ImportError: /usr/local/lib/python2.6/dist-packages/_iulib.so: undefined symbol: _ZN5iulib6dcloseEv 
```

越精致

```
ocropus book2pages out image* 
```

失败并出现同样的错误。[关于堆栈溢出](https://stackoverflow.com/questions/5134118/installing-ocropus-0-4-4)的帖子 表明这是由不正确的版本库引起的。

**问题：**

我应该如何进行？

提前致谢。

# sql - 是否可以在 dataset.xsd 中使用指令枢轴

> ID：11472026
> 
> 赞同：0
> 
> 时间：2012-07-13T14:01:29.807
> 
> 标签：sql, dataset, pivot

当我将此选择命令放入我的 dataset.xsd

```
 select *
from
  (
    select TR_DEB,TR_FIN, T_UNITE.LIBELLE as LibUnite, ZONE, MONTANT 
    from TARIF_COURANT
    LEFT JOIN T_UNITE ON TARIF_COURANT.UNITE = T_UNITE.NO_ID
    where NO_CLIENT = '440104239' and zone in (1,2,3,4,6)
  )as T
pivot
  (
    min(MONTANT) for ZONE in ([1],[2],[3],[4],[6]) 
  )as P ORDER BY P.TR_DEB 
```

它说数据集不能接受数据透视。还有其他方法吗？

我尝试放入 Store 程序，但我无法单击第一个选项。![看图片](../Images/b29479a65154f705bcc681cd169b0e0f.png)

提前谢谢你

# java - 这里如何排序以及大写字母和小写字母之间的比较？

> ID：11472027
> 
> 赞同：-1
> 
> 时间：2012-07-13T14:01:33.327
> 
> 标签：java, sorting, collections, scjp

```
public class BioDiesel {
            public static void main(String args[]) {
                LinkedList<String> list = new LinkedList<String>();
                list.add("BbB1");
                list.add("bBb2");
                list.add("bbB3");
                list.add("BBb4");
                Collections.sort(list);
                for (String str : list) {
                    System.out.print(str + ":");
                }
            }
} 
```

代码运行良好并按排序顺序显示结果。有人可以解释在上面提供的字符串元素的情况下如何执行排序吗？

输出是怎么来的：

```
BBb4:BbB1:bBb2:bbB3: 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:04:17.833

假设我正确理解了您的问题，这应该有效：

```
Collections.sort(list, String.CASE_INSENSITIVE_ORDER); 
```

[`String.CASE_INSENSITIVE_ORDER`](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#CASE_INSENSITIVE_ORDER)是一个比较器类，在比较字符串时忽略大小写。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:09:40.050

让我们从[以下文档`Collections.sort`](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#sort%28java.util.List%29)开始：

> 根据其元素的自然顺序，将指定列表按升序排序。

字符串的**自然顺序是什么？**[`String`可以告诉我们](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#compareTo%28java.lang.String%29)：

> 比较基于字符串中每个字符的 Unicode 值。

当然， 的 unicode 值`b`高于 的 unicode 值`B`。

如果你想要一个不区分大小写的排序，有[一种形式`sort`](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#sort%28java.util.List,%20java.util.Comparator%29)需要 a `Comparator`，并`String`有助于提供一个预制的[`CASE_INSENSITIVE_ORDER`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#CASE_INSENSITIVE_ORDER)比较器。

# binding - 将轨迹球绑定到 NPAPI

> ID：11472028
> 
> 赞同：-1
> 
> 时间：2012-07-13T14:01:46.103
> 
> 标签：binding, usb, npapi, hid, trackball

我想使用第二个指针设备（轨迹球）作为程序上特定功能的控件。这意味着我不想要轨迹球中的任何鼠标功能，我只想获取运动数据并以某种方式使用 NPAPI 将其输入我们的 Web 应用程序。有没有办法将鼠标/轨迹球绑定到不充当计算机鼠标/轨迹球的特定程序？

提前致谢！

更新：实际上问一个问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T23:01:27.497

据我所知以及我对 HID 设备工作原理的理解，没有办法做你想做的事。如果你能做到这一点，你可能可以通过一个 NPAPI 插件来做到这一点，但是没有办法告诉操作系统不要控制一个特定的指针设备而不是任何其他设备。

现在，如果你有一个特殊的 HID 轨迹球，它没有显示为常规的指针设备，那么你可以用它来做到这一点，但我从未听说过任何方式来控制可能的许多 HID 指针设备中的一个在 Windows、Linux 或 Mac 上。

可能有一种方法可以通过更改驱动程序的工作方式等来在 Linux 中破解某些东西，但我不知道。

# python - python打印一行，当且仅当找到x和y

> ID：11472029
> 
> 赞同：0
> 
> 时间：2012-07-13T14:01:48.823
> 
> 标签：python

我正在尝试打印包含特定关键字的行，并且它们都应该在同一行中才能打印出来。

这就是我解决问题的方式，我制作了 2 个变量并为它们分配了变量。其中之一是文件名，每次程序遍历列表时都会更改。

```
for files in myfiles:
       for lines in info:
             if dir_key and files in lines:
                      print lines
             else:
                 print "line not found" 
```

这行得通，但问题是，它还会打印出仅包含文件名的行。我如何确保它不会那样做？我试过了

```
if line.beginswith(dir_key) and line.endswith(file) 
```

但这没有产生任何结果。所以我切换到第一种方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T14:03:17.010

也许：

```
if dir_key in lines and files in lines: 
```

如果 dir_key 是一个字符串，那么只要不是一个空字符串，测试`if dir_key:`就会持续。所以你的总测试很可能相当于`True``dir_key``if True and (files in lines):`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T14:03:27.550

您现在所拥有的是检查[真实性](http://docs.python.org/library/stdtypes.html#truth-value-testing)，`dir_key`而不是`dir_key`在`lines`. 改变

```
if dir_key and files in lines:
#to
if dir_key in lines and files in lines: 
```

# excel - 删除MS excel中特定字符左侧的所有文本

> ID：11472031
> 
> 赞同：8
> 
> 时间：2012-07-13T14:01:54.980
> 
> 标签：excel, excel-formula

这是一个与excel相关的问题。我想删除字符串中特定字符或字符左侧的所有文本（所有字符）。

**例如：**

假设我在单元格中有一个字符串 **helloall welco metostackoverflow**

现在我想删除“堆栈”左侧的所有字符。意味着结果应该是**stackoverflow**（只有stackoverflow）

预先感谢您的支持。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-07-13T14:05:07.500

```
=RIGHT(input,LEN(input)-FIND("stack",input)+1) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-15T10:32:34.433

另一个公式：=MID(input,20,60)

这里第一个数字是 20，因为“helloall welco metostackoverflow”中的“s”是左起第 20 个字符，考虑到每个空格也是一个字符。第二个数字（此处为 60）是任何大于所需文本“stackoverflow”中字符数的数字。在“stackoverflow”中有 13 个字符。所以在给定的公式中，第二个数字可以是任何等于或大于 13 的正整数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-14T13:27:30.103

进行查找替换并使用通配符。

例如

查找：*堆栈替换：堆栈

结果将是“堆栈溢出”

# ruby-on-rails - Gmaps4rails：如何在服务器中向 json 添加自定义标记？

> ID：11472032
> 
> 赞同：0
> 
> 时间：2012-07-13T14:01:55.937
> 
> 标签：ruby-on-rails, json, gmaps4rails

在此之后是否可以向 json 添加自定义标记：

```
@json = @myObjects.to_gmaps4rails 
```

我想在那个 json 中再添加一个标记，而不是 myObject。实际上，在我的情况下，它将是代表用户位置的标记。我的控制器中有所有需要的信息，但是用另一个标记扩展该 json 的最简单方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-21T22:24:40.577

这里有两个解决方案：

*   一些字符串操作

*   解析 json => 哈希数组 => 将数据添加到数组 => 在数组上调用 to_json

# c# - linqpad 和自定义 IPrincipal 可序列化

> ID：11472033
> 
> 赞同：6
> 
> 时间：2012-07-13T14:02:00.443
> 
> 标签：c#, linqpad, serializable, iprincipal

我正在使用 LINQPad 测试代码（我必须说这是一个很棒的产品），但是现在当我尝试将 Thread.CurrentPrincipal 设置为自定义 IPrincipal 时遇到异常，该自定义 IPrincipal 标记有 SerializableAttribute 以下示例演示问题

```
void Main()
{
    Thread.CurrentPrincipal = new MyCustomPrincipal();
}

// Define other methods and classes here
[Serializable]
public class MyCustomPrincipal : IPrincipal
{
    public bool IsInRole(string role)
    {
        return true;
    }

    public IIdentity Identity 
    { 
        get
        {
            return new WindowsIdentity("RECUPERA\\m.casamento");
        }
    }
} 
```

当我在 LINQPad（C# 程序作为语言）中运行此代码时，出现以下异常

```
Type is not resolved for member 'UserQuery+MyCustomPrincipal,query_nhxfev, Version=0.0.0.0, 
Culture=neutral, PublicKeyToken=null' 
RuntimeMethodInfo: PluginWindowManager.get_Form () 
```

如果我删除 Serializable 属性一切正常。这似乎是一个与 LINQPad 使用的 AppDomain 体系结构相关的问题，并且该框架无法找到定义 MyCustomPrincipal 的程序集。另外，我相信将 MyCustomPrincipal 定义到另一个程序集中并将其放入 GAC 可以解决问题，但这不是我的选择。有人有想法吗？

谢谢，马可

**编辑**：我不知道它是否有帮助，但我在 SqlDependency.Start 上遇到了同样的问题：将 Serializable 放在 IPrincipal 上使框架抛出错误，抱怨它找不到定义类型的程序集校长。我已经解决了一个可耻的黑客：

```
System.Security.Principal.IPrincipal principal;
principal = System.Threading.Thread.CurrentPrincipal;

System.Threading.Thread.CurrentPrincipal = null;
try
{
    SqlDependency.Start(connectionString);
        m_SqlDependencyStarted = true;
}
catch (Exception ex)
{
    throw (ex);
}
finally
{
    System.Threading.Thread.CurrentPrincipal = principal;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T17:47:29.463

在黑暗中刺伤，但由于穿越集会，这可能是签署的事情吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T10:39:47.807

您可以使用的一个技巧是强命名包含自定义主体的程序集并将其放入全局程序集缓存中。这样任何应用程序都可以找到您想要的程序集，这不是一个理想的解决方案，因为您必须在之后再次删除它。如果您安装了 Visual Studio，无论如何要安装到 GAC 中，运行 VS 命令提示符并运行以下命令：

`gacutil -i nameofassembly.dll`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T19:26:41.030

这似乎是 LinqPad 中的序列化问题。我看到 Linqpad 的创建者 Joseph Albahari 在您的评论中证实了这一点。

底线：我们需要在 LinqPad 中对此进行修复。我不知道有什么解决办法。

# sql-server - 从一个主要作业顺序调用多个 SQL Server 代理作业的好方法？

> ID：11472035
> 
> 赞同：4
> 
> 时间：2012-07-13T14:02:26.807
> 
> 标签：sql-server, tsql, sql-server-2008-r2, sql-server-agent

我有几个应该按顺序运行的 SQL Server 代理作业。为了对应该执行的作业有一个很好的概述，我创建了一个主作业，它通过调用`EXEC msdb.dbo.sp_start_job N'TEST1'`. 立即完成（作业步骤 1），但我希望我的`sp_start_job`主要作业等到作业`TEST1`完成后再调用下一个作业。

所以我编写了这个小脚本，它在调用作业后立即开始执行（作业步骤 2），并强制主作业等到子作业完成：

```
WHILE 1 = 1
  BEGIN
    WAITFOR DELAY '00:05:00.000';

    SELECT *
    INTO   #jobs
    FROM   OPENROWSET('SQLNCLI', 'Server=TESTSERVER;Trusted_Connection=yes;',
           'EXEC msdb.dbo.sp_help_job @job_name = N''TEST1'',
           @execution_status = 0, @job_aspect = N''JOB''');

    IF NOT (EXISTS (SELECT top 1 * FROM #jobs))
      BEGIN
        BREAK
      END;

    DROP TABLE #jobs;

  END; 
```

这工作得很好。但我觉得更聪明和/或更安全（`WHILE 1 = 1`？）的解决方案应该是可能的。

我对以下事情感到好奇，希望您能给我一些见解：

*   这种方法有什么问题？
*   你能建议一个更好的方法来做到这一点吗？

（我也在[dba.stackexchange.com](https://dba.stackexchange.com/questions/20891/good-way-to-call-multiple-sql-server-agent-jobs-sequentially-from-one-main-job)上发布了这个问题，也是为了从少编程多 dba 的观点中获利。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T21:41:39.453

如果您选择轮询表，那么您需要查看 msdb.dbo.sysjobhistory 并等到[run_status](http://msdn.microsoft.com/en-us/library/ms174997%28v=sql.90%29.aspx)不是 4。不过仍然会很烦。

对于作业的最后一步（失败或成功），可能有一种不同的方法，在该过程已完成的“主”作业服务器上创建一个条目，然后您只需在本地查看。通过在集中式作业服务器上合并开始和停止，还可以更轻松地追踪“到底发生了什么”。

第三种也是更强大的方法是使用[Service Broker](http://msdn.microsoft.com/en-us/library/bb522893.aspx)之类的东西来处理进程之间的通信和信令。这将需要更多的设置，但它将是进程之间通信的最机制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T07:14:22.593

方法没有问题。我所做的只是有点像您的要求，并且由于其他一些原因，我使用了 msdb 中的 sysjobhistory 表来查看运行状态。

回到您的问题，请使用相同的方法参考 msdb.dbo.sp_start_job 存储过程，并且它已被一个默认 Microsoft BizTalk 作业“MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb”用于调用另一个相关的默认 biztalk 作业“MessageBox_Message_Cleanup_BizTalkMsgBoxDb”。甚至在 BizTalk 消息框中有一个存储过程来检查作业的状态。请参阅 BizTalk 消息框中的“int_IsAgentJobRunning”。

# html - 额外的边距/填充来自哪里？

> ID：11472037
> 
> 赞同：0
> 
> 时间：2012-07-13T14:02:42.423
> 
> 标签：html, css-float, margin, padding

**我现在有一个非常简单的布局：**

```
<div class="spacer">
<h1>Finalizing Your Account </h1>
</div>

<div class="greycont60 greycont">
<div class="minispacer"><h5>Almost done! Just a few things left...</h5></div>
</div>
<div class="greycont40 greycont"></div>
<div style="clear:both;"></div> 
```

**这是CSS：**

```
.minispacer {
background: #d9d9d9;
height:30px;
width: 300px;
padding-left:10px;
}

.greycont60 {
width: 56%;
float: left;
}

.greycont40 {
width: 36%;
float: right;
}

.spacer {
height:56px;
background:url(../images/bg2.png) repeat;
padding:0 10px;
margin-top:20px;
margin-bottom:10px;
}

.spacer h1 {
font-size:22px;
padding-top:4px;
color:#727272;
}

.greycont {
background-color:#e8e8e8;
padding:15px;
margin-bottom:10px;
} 
```

现在结果如下：

![在此处输入图像描述](../Images/36aab0c1c914e6441158da4d1a1ea3ca.png)

为什么他们的 MiniSpacer 酒吧有这么大的空间？我试图添加 1px 的顶部填充，突然酒吧做了一些疯狂的事情......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:06:46.257

尝试添加边距：0px；到您的**h5**标签。标题标签获得默认的顶部和底部边距。

谢谢，阿迪亚

# c++ - 非阻塞 getch()

> ID：11472043
> 
> 赞同：8
> 
> 时间：2012-07-13T14:03:09.567
> 
> 标签：c++, getch

我正在尝试在标准控制台中制作俄罗斯方块游戏。我需要非阻塞的 getch()，所以块可以在不按任何键的情况下掉落。如果没有按下任何键则返回 -1 的函数会很好，否则返回键码。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-13T14:24:33.733

这正是您想要的：

```
int getch_noblock() {
    if (_kbhit())
        return _getch();
    else
        return -1;
} 
```

基本上`kbhit()`完成确定是否按下键的工作。

假定 Windows 和 Microsoft Visual C++。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-13T14:08:43.260

它是特定于操作系统的，但您的库可能有一个名为 kbhit() 或类似的函数可以执行此操作

# python - 检测字符串开头的空格字符

> ID：11472047
> 
> 赞同：0
> 
> 时间：2012-07-13T14:03:12.593
> 
> 标签：python

如何检测字符串中的空格缩进？

我需要解析一个 CSS 文件：逐行解析。鉴于我有一行 CSS 样式：

```
strong, b { font-weight: normal; color: #000; } 
```

如何提取该空格并将其保存到变量中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:13:09.723

很难说出您想要什么，但是您可以使用正则表达式轻松地从字符串的开头拉出空格：

```
import re
def get_whitespace(your_string):
    return re.match(r'\s*',your_string).group()

print len(get_whitespace(' foo')) #1
print len(get_whitespace('bar'))  #0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T16:30:58.363

您可以在不使用正则表达式的情况下从字符串中获取前导空格：

```
whitespace = string[ : len(string) - len(string.lstrip())] 
```

# iphone - XCode 不接受我的 57x57 尺寸图标？

> ID：11472052
> 
> 赞同：4
> 
> 时间：2012-07-13T14:03:23.553
> 
> 标签：iphone, xcode, ipad, icons

我正在尝试使用 XCode 归档我的应用程序。我有 4 个不同的图标（57、72、114、144）。

当我将它们放入时它工作正常，但是当我在构建后尝试验证它时，我得到以下...

![在此处输入图像描述](../Images/679462a28ab0aac4eebaf11fd1a5f8f9.png)

如果我返回并尝试用 72px 图标替换 57px 图标，我会收到此消息。

![在此处输入图像描述](../Images/706383611c600e494dbee96840dbf76e.png)

为什么会这样？

这是 plist 中的值，这里没有手动做任何事情。

![在此处输入图像描述](../Images/a57e7d82a3803abd14b70a6ae0c9f6fa.png)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-13T14:15:57.370

## 这是[图标的苹果文档](https://developer.apple.com/LIBRARY/IOS/qa/qa1686/_index.html)

如果上面的链接过期了，我会附上屏幕截图，我知道这是无法看到的内容，[**这里是图片链接**](https://i.stack.imgur.com/tbN7R.png)。顺便说一句，您始终可以右键单击图像并复制图像位置并在新选项卡中打开它。

这是指定图标的方法 ![在此处输入图像描述](../Images/d8f2fbbdbee288b5dfcb24f1025eea6d.png)

![在此处输入图像描述](../Images/c1a52eea50b485a44d9dbabf7979c174.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-13T14:21:16.847

理论上，只要它们在 info.plist 中，您就可以为 iPad 命名任何您想要的名称。为了支持旧版本的 iOS，我总是以 apple recommand 的方式命名它们，这已经被 Inder Kumar Rathore 引用过。

看看[这里](http://developer.apple.com/library/ios/#qa/qa1686/_index.html)看看如何在 Info.plist 中添加图标文件

@PhlipK：你的 info.plist 看起来和我的很不一样，这就是我的样子。

看看我上面提到的链接并尝试编辑你的 info.plist 看看是否有效。

![在此处输入图像描述](../Images/e2cefbf10324ff361f11f166fe88930a.png)

# php - preg_replace 嵌入地图的自定义模式

> ID：11472055
> 
> 赞同：0
> 
> 时间：2012-07-13T14:03:31.283
> 
> 标签：php, preg-replace, expression

基本上我收到这个：

```
<iframe width='425' height='350' frameborder='0' scrolling='no' marginheight='0' marginwidth='0' src='https://maps.google.com.br/maps?f=q&amp;source=s_q&amp;hl=pt-BR&amp;geocode=&amp;q=R.+Alm%C3%A9ria,+242+-+Penha,+S%C3%A3o+Paulo+-+S%C3%A3o+Paulo&amp;aq=0&amp;oq=Rua++Almeria&amp;sll=-14.239424,-53.186502&amp;sspn=79.602428,135.263672&amp;t=h&amp;ie=UTF8&amp;hq=&amp;hnear=R.+Alm%C3%A9ria,+242+-+Penha,+S%C3%A3o+Paulo,+03654-000&amp;z=14&amp;ll=-23.524401,-46.518859&amp;output=embed'></iframe> 
```

我需要做的是将 width='' 引号或双引号内的任何值替换为另一个值。

我不擅长正则表达式，试图通过这个来学习似乎很复杂。

任何想法？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:07:04.380

不久前我回答了一个类似的问题->[如何使用 php 替换 iframe html 标记的宽度和高度？](https://stackoverflow.com/questions/11082137/how-to-replace-width-and-height-an-iframe-html-tag-using-php/11082246#11082246)

更好地使用`str_replace()`，它更容易，特别是如果您对正则表达式不满意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:46:20.753

想办法做到这一点，现在 425 和 350 可以是任何值，并用单引号或双引号引起来：

```
<?php

$embed = "<iframe width=\"425\" height=\"350\" frameborder='0' scrolling='no' marginheight='0' marginwidth='0' src='https://maps.google.com.br/maps?f=q&amp;source=s_q&amp;hl=pt-BR&amp;geocode=&amp;q=R.+Alm%C3%A9ria,+242+-+Penha,+S%C3%A3o+Paulo+-+S%C3%A3o+Paulo&amp;aq=0&amp;oq=Rua++Almeria&amp;sll=-14.239424,-53.186502&amp;sspn=79.602428,135.263672&amp;t=h&amp;ie=UTF8&amp;hq=&amp;hnear=R.+Alm%C3%A9ria,+242+-+Penha,+S%C3%A3o+Paulo,+03654-000&amp;z=14&amp;ll=-23.524401,-46.518859&amp;output=embed'></iframe><br /><small><a href='https://maps.google.com.br/maps?f=q&amp;source=embed&amp;hl=pt-BR&amp;geocode=&amp;q=R.+Alm%C3%A9ria,+242+-+Penha,+S%C3%A3o+Paulo+-+S%C3%A3o+Paulo&amp;aq=0&amp;oq=Rua++Almeria&amp;sll=-14.239424,-53.186502&amp;sspn=79.602428,135.263672&amp;t=h&amp;ie=UTF8&amp;hq=&amp;hnear=R.+Alm%C3%A9ria,+242+-+Penha,+S%C3%A3o+Paulo,+03654-000&amp;z=14&amp;ll=-23.524401,-46.518859' style='color:#0000FF;text-align:left'>Exibir mapa ampliado</a></small>";

var_dump($embed);

$new = preg_replace("/\bwidth='(.*?)'/", "width='100'", $embed);

$new2 = preg_replace("/\bheight='(.*?)'/", "height='100'", $new);

$new3 = preg_replace("/\bwidth=\"(.*?)\"/", "width='100'", $new2);

$new4 = preg_replace("/\bheight=\"(.*?)\"/", "height='100'", $new3);

var_dump($new4);

?> 
```

# linq - 实体框架linq中的动态表名

> ID：11472059
> 
> 赞同：0
> 
> 时间：2012-07-13T14:03:41.827
> 
> 标签：linq, entity-framework, entity-framework-4

我目前正在使用实体框架（.net 4）使用 LINQ 语句从第 3 方数据库中读取数据。不幸的是，在编译时我不知道我将从哪个表中读取 - 事实上，在我的应用程序编译后可以将新表添加到该数据库中。要读取的表名将作为字符串参数传递给我的方法。

如果在编译时不知道表名，应该如何处理这种情况？我什至无法将这些表添加到我的数据模型中，因为它们可能还不存在。虽然我喜欢 linq 的便利性，但我追求的是一种简单的方法。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T15:02:30.330

对于只能在运行时构建并且将返回不同形状类型的查询，您几乎被迫制作和执行您想要自己运行的 SQL。 `DataContext.ExecuteQuery(string query, params object[] parameters)`将成为你的朋友。

您可能已经这样做了，但我建议将这部分代码隔离到执行查询的代码的一部分，然后将结果放入强类型对象中，然后再将其公开给应用程序的其他区域。确保你也清理了表名。

# xcode - 从崩溃报告中提取构建标识符？

> ID：11472062
> 
> 赞同：0
> 
> 时间：2012-07-13T14:03:56.837
> 
> 标签：xcode, crash-reports

[技术问答 QA1765：如何将崩溃报告与构建匹配](http://developer.apple.com/library/ios/#qa/qa1765/_index.html)解释了如何使用`grep`.

```
$ grep -A=1 "Binary Images:" Example.crash
Binary Images:
   0xb6000 - 0xb7fff +Example armv7 <270a9b9d7a333a4a9f1aaf8186f81394> /var/mobile/Applications/28D4F177-D312-4D3B-A76C-C2ACB4CB7DAD/Example.app/Example 
```

但是，仅提取构建标识符的最佳方法是什么：`270a9b9d7a333a4a9f1aaf8186f81394`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:04:14.450

您链接到的技术问答指出：

> 崩溃报告的“二进制图像：”部分的第一行包含构建标识符，位于 <> 内。

所以，我会选择类似的东西：

```
grep -A 1 "Binary Images:" Example.crash | sed -n 's/.*<\([a-z0-9]\{32\}\)>.*/\1/p' 
```

# android - 无论如何使用之前的时间功能和等于？

> ID：11472063
> 
> 赞同：0
> 
> 时间：2012-07-13T14:04:03.983
> 
> 标签：android

我正在使用下面的代码：

```
endTimeEntryCal2.before(addTimeEntryCale) 
```

检查用户设置的时间是否早于当前时间，但我也希望它早于或等于这里是否有这样做，例如 before=();

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:06:32.623

这可以解决问题：

```
endTimeEntryCal2.compareTo(addTimeEntryCale) <= 0 
```

> [int compareTo（日历另一个日历）](http://developer.android.com/reference/java/util/Calendar.html#compareTo%28java.util.Calendar%29)
> 
> 比较两个日历的时间，表示从 1970 年 1 月 1 日 00:00:00.000 GMT（公历）开始的毫秒数。参数 anotherCalendar 与之比较的另一个日历
> 
> ***返回：***
> 0 如果两个日历的时间相等，
> -1 如果这个日历的时间在另一个之前
> 1 如果这个日历的时间在另一个之后。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:20:27.403

```
 long mills = cal.getTimeInMillis(); 
        long currentTime = System.currentTimeMillis(); 
        int x = (mills <= currentTime)?0:1; 

                    if(x == 1)
                     {
                      // Time Available
                      }else 
                          {
                       //Time passed
                          } 
```

# c# - 在 C# 中，为什么一次强制转换可以同时执行拆箱和枚举转换？

> ID：11472065
> 
> 赞同：11
> 
> 时间：2012-07-13T14:04:10.097
> 
> 标签：c#, enums, specifications, boxing, type-safety

通常，人们会期望并希望，首先需要**两次**强制转换才能将值类型拆箱，然后执行某种值类型转换为另一种值类型。这是一个例子：

```
 // create boxed int
  IFormattable box = 42;       // box.GetType() == typeof(int)

  // unbox and narrow
  short x1 = (short)box;       // fails runtime :-)
  short x2 = (short)(int)box;  // OK

  // unbox and make unsigned
  uint y1 = (uint)box;         // fails runtime :-)
  uint y2 = (uint)(int)box;    // OK

  // unbox and widen
  long z1 = (long)box;         // fails runtime :-)
  long z2 = (long)(int)box;    // OK (cast to long could be made implicit) 
```

正如您从我的笑脸中看到的那样，如果我只使用一个演员表，我很高兴这些转换将失败。毕竟，尝试在一次操作中将值类型拆箱为不同的值类型可能是一个编码错误。

`IFormattable`（界面没有什么特别之处；`object`如果您愿意，也可以使用该类。）

但是，今天我意识到这与枚举不同（当（并且仅当）枚举具有相同的基础类型时）。这是一个例子：

```
 // create boxed DayOfWeek
  IFormattable box = DayOfWeek.Monday;    // box.GetType() == typeof(DayOfWeek)

  // unbox and convert to other
  // enum type in one cast
  DateTimeKind dtk = (DateTimeKind)box;   // succeeds runtime :-(

  Console.WriteLine(box);  // writes Monday
  Console.WriteLine(dtk);  // writes Utc 
```

我认为这种行为是不幸的。真的应该说是必须的`(DateTimeKind)(DayOfWeek)box`。阅读 C# 规范，我看不出数字转换和枚举转换之间存在这种差异的理由。在这种情况下，感觉就像类型安全丢失了。

**您是否认为这是“未指定的行为”，可以在未来的 .NET 版本中改进（无需更改规范）？**这将是一个突破性的变化。

此外，如果任一枚举类型（`DayOfWeek`或`DateTimeKind`在我的示例中）的供应商决定将其中一个枚举类型的基础类型从其他类型更改为`int`其他类型（可能是`long`, `short`, ...），那么突然之间上面的一次性代码将停止工作，这看起来很愚蠢。

当然，枚举`DayOfWeek`并`DateTimeKind`没有什么特别之处。这些可以是任何枚举类型，包括用户定义的类型。

有点相关：[为什么拆箱枚举会产生奇怪的结果？](https://stackoverflow.com/questions/4026374/)（将 an`int`直接拆箱到枚举中）

**添加：**

好的，很多答案和评论都集中在如何“在幕后”处理枚举。虽然这本身很有趣，但我想更多地关注观察到的行为是否包含在 C# 规范中。

假设我写了类型：

```
struct YellowInteger
{
  public readonly int Value;

  public YellowInteger(int value)
  {
    Value = value;
  }

  // Clearly a yellow integer is completely different
  // from an integer without any particular color,
  // so it is important that this conversion is
  // explicit
  public static explicit operator int(YellowInteger yi)
  {
    return yi.Value;
  }
} 
```

然后说：

```
object box = new YellowInteger(1);
int x = (int)box; 
```

那么，C# 规范是否说明这是否会在运行时成功？就我而言，.NET 可能会将 a`YellowInteger`视为具有不同类型元数据（或其他任何名称）的 a，但是任何人都可以保证 .NET在拆箱时`Int32`不会“混淆” a`YellowInteger`和 a吗？`Int32`那么我可以在 C# 规范中的哪个位置查看是否`(int)box`会成功（调用我的显式运算符方法）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T14:09:50.497

当您使用：

```
IFormattable box = 42; 
long z2 = (long)(int)box; 
```

你实际上是在拆箱然后铸造。

但在你的第二种情况下：

```
IFormattable box = DayOfWeek.Monday; 
DateTimeKind dtk = (DateTimeKind)box; 
```

你根本不执行任何铸造。您只需将值拆箱即可。[枚举元素的默认基础类型是 int。](http://msdn.microsoft.com/en-us/library/sbbt4032%28v=vs.80%29.aspx)

**更新**以引用*真正的问题*：

您在评论中提到的[规范：](http://msdn.microsoft.com/en-us/library/aa691290%28v=vs.71%29.aspx)

```
The explicit enumeration conversions are:
...
From any enum-type to any other enum-type. 
```

这实际上是正确的。我们不能隐式转换：

```
//doesn't compile
DateTimeKind dtk = DayOfWeek.Monday; 
```

但我们可以显式转换：

```
DateTimeKind dtk = (DateTimeKind)DayOfWeek.Monday; 
```

您似乎找到了仍然需要这样做的情况。但与拆箱结合使用时，只需指定显式转换**即可省略拆箱**。

**更新 2**

有一种感觉，之前一定有人注意到了，去谷歌搜索“取消装箱转换枚举”，你猜怎么着？[Skeet 在 2005 年发表了关于它的博客（CLI 规范错误与拆箱和枚举）](http://msmvps.com/blogs/jon_skeet/archive/2005/11/09/75025.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-13T14:09:06.777

这是因为它们实际上在运行时被表示为它们的底层值类型。它们都是`int`，这与您的失败案例的情况相同 - 如果您在这种情况下更改枚举类型，这也会失败。

由于类型相同，因此操作只是将`int`.

您只能将值拆箱为它们的**实际**类型，因此在拆箱之前进行强制转换不起作用。

**更新**

如果您创建一些将`int`枚举相互转换的代码，您将看到生成的 IL 中没有转换操作。当您将枚举装箱并将其拆箱为另一种类型时，只有以下`unbox.any`操作：

> 将指令中指定的类型的装箱表示转换为其未装箱形式。

在这种情况下，它是每个枚举，但它们都是`int`.

**更新 2：**

我已经达到了能够解释这里发生的事情的极限，而无需我进行更深入的研究，但我发现了这个问题：

[枚举如何从 System.Enum 派生并且同时是整数？](https://stackoverflow.com/questions/4626394/how-is-it-that-an-enum-derives-from-system-enum-and-is-an-integer-at-the-same-ti)

它可能有助于解释如何处理枚举。

# php - 如何动态更改 CSS

> ID：11472067
> 
> 赞同：1
> 
> 时间：2012-07-13T14:04:11.783
> 
> 标签：php, javascript, jquery, html

我需要我的管理员能够更改/更新我网站的横幅。

这是横幅代码

```
<div class="containertop">This depends on the background of the div</div> 
```

这就是 CSS

```
.containertop
{
     width:1000px;
     height:300px;  
     **background:url(../images/1.png) no-repeat center;**
     margin: 0 auto;
     margin-top: 40px;
} 
```

我希望发生的事情与 Facebook 封面照片相同。上传新横幅时，CSS 将被更新（类似这样）。但是，当然，必须从数据库中获取新横幅。

所以我认为CSS会变成这样：

获取保存的横幅源，然后：

```
background:url(<?php echo $row['image']; ?>); 
```

但是我可以在 CSS txt 中连接到数据库（包括 'dbname.php'）吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T14:08:57.177

没有什么可以阻止您使用 PHP 生成的 CSS。这甚至很容易。

只需像这样启动您的 php 文件：

```
<?php
header("Content-Type: text/css"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T14:13:57.360

您可以在加载 php 文件时设置 containertop 背景。

```
<?php
echo "<style>.containertop{ background:url(../images/".$row['image'].") no-repeat center;}</style>"
?> 
```

这将设置从 db 获取的背景。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T14:17:00.583

我同意本。如果您在页面中制作了一个嵌入式 css 部分，则可以将 .containerTop css 代码放在那里。然后，将您的代码放入页面中。因此，在您的实际网页中，输入以下内容：

```
<style type="text/css">
.containertop{
width:1000px;
height:300px;  
background:url(<?php echo $row['image']; ?>);
margin: 0 auto;
margin-top: 40px;
}
</style> 
```

当然，您的后台 url 在重新加载之前不会更新。如果您决定这样做，请不要忘记将 .containerTop 定义从您现有的 css 中取出。说了这么多，我真的很喜欢dystroy的回答。非常好。我从没想过这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T14:15:21.417

好吧，您可以使用 jQuery 更改/覆盖 CSS 文件。

例子 -

```
$('.containertop').css('backgroud','url(images/change.jpg) repeat'); 
```

或者

```
$('.containertop').css('backgroud','url(<?php echo $images_url ?>) repeat'); 
```

# vba - 应用 ListTemplate 后 MS Word 崩溃

> ID：11472074
> 
> 赞同：1
> 
> 时间：2012-07-13T14:05:02.637
> 
> 标签：vba, excel, ms-word

我正在使用 Excel 2010 VBA 以编程方式生成 Word 2010 文档。
当我尝试将 ListTemplate 应用于我插入的段落之一（下面代码中的第 5 行）时，程序崩溃。

```
thisValue = tempSheet.Cells(i, 1).Value
.Content.InsertAfter thisValue
.Content.InsertParagraphAfter
Set thisRange = .Paragraphs(i).Range
thisRange.ListFormat.ApplyListTemplate ListTemplate:=ListGalleries(wdBulletGallery).ListTemplates(1) 
```

抛出的错误如下所示：

> 运行时错误“-2147023170 (800706be)”
> 自动化错误
> 远程过程调用失败。

整个过程：

```
Sub MoveDataToWord(ByRef tempSheet As Worksheet)

Dim wrdApp As Word.Application
Dim wrdDoc As Word.Document
Set wrdApp = CreateObject("Word.Application")
wrdApp.Visible = True
Set wrdDoc = wrdApp.Documents.Add
With wrdDoc
    For i = 1 To tempSheet.Cells.Find("*", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row
        thisValue = tempSheet.Cells(i, 1).Value
        .Content.InsertAfter thisValue
        .Content.InsertParagraphAfter
        Set thisRange = .Paragraphs(i).Range
        thisRange.ListFormat.ApplyListTemplate ListTemplate:=ListGalleries(wdBulletGallery).ListTemplates(1)
    Next i
End With
Set wrdDoc = Nothing
Set wrdApp = Nothing
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T15:50:25.863

ListGalleries 是 Word 应用程序中的一个对象。要访问它，我需要使用 wrdApp.ListGalleries。固定的代码行如下所示。

```
thisRange.ListFormat.ApplyListTemplate ListTemplate:=wrdApp.ListGalleries(wdBulletGallery).ListTemplates(1) 
```

# json - 数据表错误：“请求的未知参数”

> ID：11472075
> 
> 赞同：22
> 
> 时间：2012-07-13T14:05:06.333
> 
> 标签：json, spring-mvc, jackson, jquery-datatables

我是 DataTables jquery 插件的新手。在发现 IE 8 与 Javascript 存在性能问题后，我决定改变使用 DataTables 进行服务器端处理的方式。当我的 JSP 加载（我正在使用 Spring 3）时，我收到此错误消息：

```
DataTables warning (table id = 'results_table'): Requested unknown parameter '0' from the data source for row 0 
```

我四处搜索，发现该错误消息的许多原因归结为格式错误的 JSON，因此我找到了一种从 Spring 3 控制器函数输出我的 JSON 以查看它生成的 JSON 的方法，我更改了我的代码以获取它非常接近[DataTables](http://datatables.net/usage/server-side)网站所说的应该是什么样子。

仍然没有喜悦，仍然收到该错误消息。

我为 DataTables 找到的服务器端处理示例不包含用于指定客户端使用的列的代码，所以我认为我不需要它。我吗？

**以下是我的 results.jsp 的相关部分：**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >

<head>
    <title>ACME: search results in a nice DataTables.net Plugin</title>
</head>
<body>

<link rel="stylesheet" type="text/css" href="css/jquery.dataTables.css" />
<script language = "JavaScript" type = "text/javascript" src = "../nsd/js/jquery-1.7.js"></script>
<script language = "JavaScript" type = "text/javascript" src = "../nsd/js/jquery.dataTables.js"></script>

<script type="text/javascript">
$(document).ready(function() {
    $('#results_table').dataTable( {
        "bProcessing": true,
        "bServerSide": true,
        "sScrollX": "600px",
        "sServerMethod": "POST",
        "sAjaxSource": "/acme/resultstable",
    } );
} );
</script>

<form id="command" name="f" action="employee" method="post">

    <div id = "results">
        <table id = "results_table">
            <thead>           
                <tr>
                    <th>&nbsp;</th>
                    <th>ID</th>
                    <th>NO_PRINT</th>
                    <th>Full Name</th>
                    <th>Email Address</th>
                    <th>Phone Number</th>
                    <th>Organization</th>
                    <th>Organization Code</th>
                    <th>Position</th>
                    <th>Employee Type</th>
                </tr>
            </thead>
            <tbody>           
            </tbody>
        </table>

    </body>
</html> 
```

**这是我发送给它的 JSON 响应：**

```
{
  "sEcho" : 1,
  "iTotalRecords" : 1,
  "iTotalDisplayRecords" : 1,
  "aaData" : [ {
    "person_id" : "888888",
    "ID" : "999999",
    "no_print" : "&nbsp;",
    "fullname" : "Obama, Willard",
    "email_address" : "<a href = \"mailto:barry@whitehouse.gov\">barry@whitehouse.gov</a>",
    "current_phone_number" : "303-867-5309",
    "title" : "&nbsp;",
    "office" : "&nbsp;",
    "position" : "Contractor",
    "empl_code" : "CONT"
  } ]
} 
```

这是我用来通过 Jackson 发送 JSON 响应的 Spring 控制器函数。这包括输出我的 JSON 的代码，所以我可以看到它的样子。它输出到标准输出的 JSON 和我发送回 DataTables 的 JSON 是否不同？

```
@RequestMapping(value = "/resultstable", method = RequestMethod.POST)
public @ResponseBody LinkedHashMap resultstable(ModelMap model,                 
                                                HttpSession session,
                                                @RequestParam (required=true) int sEcho,   
                                                @RequestParam (required=true) int iDisplayStart,   
                                                @RequestParam (required=true) int iDisplayLength,    
                                                @RequestParam (required=true) int iColumns,
                                                @RequestParam (required=true) int iSortCol_0, 
                                                @RequestParam (required=false)String sSortDir_0,
                                                @RequestParam (required=true) String sSearch ) {

    /*
    **********************************************************************
    **  These come from the DataTables.net Jquery plugin on results.jsp
    **********************************************************************
    **  sEcho,          -  just send it back, used by DataTables for synching
    **  iDisplayStart   -  index of the record to start with, ie 3 for the 3rd of 100 records
    **  iDisplayLength  -  number of records to send back starting with iDisplayStart  
    **  iColumns        -  number of columns to be displayed in the table
    **  iSortCol_0      -  the number of thee column to be sorted on
    **  sSortDir_0      -  direction of sorting: asc or desc
    **  sSearch         -  from the search box, filter results further on this term 
    ********************************************************************** 
    */

    String nextView                   = "results";
    String usertype                   = (String)session.getAttribute("usertype");
    Search search                     = new Search(usertype);
    List<LinkedHashMap> records       = null;
    String results                    = null;
    int number_of_records             = (Integer)session.getAttribute("number_of_records_found");
    ResultsView rv                    = new ResultsView();
    ResultsScreenTableHolder rstrh    = null;
    SearchScreenDataHolder ssdh2      = (SearchScreenDataHolder)session.getAttribute("search_screen_data_holder");
    ObjectMapper mapper               = new ObjectMapper();

    logger.debug("started");

    logger.debug("sEcho,         == " + sEcho         );
    logger.debug("iDisplayStart  == " + iDisplayStart  );
    logger.debug("iDisplayLength == " + iDisplayLength );
    logger.debug("iColumns       == " + iColumns       );
    logger.debug("iSortCol_0     == " + iSortCol_0     );
    logger.debug("sSortDir_0     == " + sSortDir_0     );
    logger.debug("sSearch        == " + sSearch        );

    try {
        records = search.searchForAnEmployee(ssdh2,usertype,sSearch,"asc",
                                             iSortCol_0,iDisplayStart, 
                                             iDisplayLength);    

        LinkedHashMap lhm= new java.util.LinkedHashMap();
        lhm.put("sEcho", sEcho);
        lhm.put("iTotalRecords",number_of_records);
        lhm.put("iTotalDisplayRecords",9);
        lhm.put("aaData",records);

        // convert user object to json string, and save to a file
        mapper.writeValue(new File("c:\\Downloads\\rstrh.json.txt"), lhm);

        // display to console
        logger.debug("My JSON: " + mapper.defaultPrettyPrintingWriter().writeValueAsString(lhm));

    }
    catch (Exception e) {
        logger.debug("\n",e);
    }

    return lhm;       

}// end function 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-09-02T02:35:20.357

我也遇到了同样的警告，但原因不同。我的数据中**有空值**。JSON 格式是正确的，但 DataTables 不知道显示**null**的默认规则。解决方案是使用**sDefaultContent**属性。

示例 aaData：

```
aaData: [
  { "Field1": "Foo", "Field2":null },
  { "Field1": "Bar", "Field2":null },
] 
```

然后在 aoColumns 上，您可以使用如下属性：

```
aoColumns: [
  { "mData": "Field1", sDefaultContent: "n/a" },
  { "mData": "Field2", sDefaultContent: "" }
] 
```

这不是您当前的问题，但您将来可能会遇到此问题。

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-07-13T17:53:53.300

今天早上我遇到了同样的问题。您需要有`aoColumns`参数并`mDataProp` 在此使用 As ：

[https://gist.github.com/1660712](https://gist.github.com/1660712)

至少它解决了我的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-20T09:48:08.147

sDefaultContent 选项仅阻止显示警报框。数据表将找不到显示空值的规则。

更改表中的空值将消除此警告。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-06-24T18:03:05.793

如果它对任何人有帮助，我会遇到类似的错误，因为我的 mRender 函数名称中有句点：
`My.Namespace.MyFunction(data, row);`

这一行：
`var a = _fnSplitObjNotation( src );`

将其拆分为单独的对象，这显然会产生错误。

使用

`My_Namespace_MyFunction(data, row);`

此外，我在传递字符串函数名而不是 JavaScript 函数对象时注意到了这个错误。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-08-20T18:47:02.850

为避免此错误，您的表“th”列数应等于返回数据列（以数字为单位），在上述问题中为 aaData。

```
"aaData" : [ 
  [
   "person_id" : "888888",
   "ID" : "999999",
  ],
  [
   "person_id" : "8888889",
   "ID" : "9999990",
  ]
] 
```

这是从服务器端语言返回数据的正确格式。我以同样的方式解决了我的问题。

# c++ - 逐行解析缓冲数据

> ID：11472077
> 
> 赞同：1
> 
> 时间：2012-07-13T14:05:20.970
> 
> 标签：c++, file-io, stl

我想为 Wavefront OBJ 文件格式，纯文本文件编写一个解析器。示例可以在这里看到：people.sc.fsu.edu/~jburkardt/data/obj/diamond.obj。

大多数人使用旧的 scanf 逐行解析这种格式，但是我更愿意一次加载整个文件以减少 IO 操作计数。有没有办法逐行解析这种缓冲数据？

```
void ObjModelConditioner::Import(Model& asset)
{
    uint8_t* buffer = SyncReadFile(asset.source_file_info());

    delete [] buffer;
} 
```

或者将整个文件加载到一个字符串中并尝试解析它会更好吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-14T18:35:42.297

过了一会儿，我似乎找到了足够（和简单）的解决方案。由于我的目标是创建资产调节管道，因此代码必须能够有效地处理大量数据。数据可以一次读入`string`，一旦加载，`stringstream`就可以用这个字符串初始化。

```
std::string data;
SyncReadFile(asset.source_file_info(), data);

std::stringstream data_stream(data);
std::string line; 
```

然后我简单地打电话`getline()`：

```
while(std::getline(data_stream, line)) 
{        
    std::stringstream line_stream(line);
    std::string type_token;

    line_stream >> type_token;
    if (type_token == "v") {
        // Vertex position
        Vector3f position;
        line_stream >> position.x >> position.y >> position.z;
        // ...
    }
    else if (type_token == "vn") {
        // Vertex normal
    }
    else if (type_token == "vt") {
        // Texture coordinates
    }
    else if (type_token == "f") {
        // Face
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T14:20:22.487

这是一个将 char 数组拆分为字符串向量的函数（假设每个新字符串都以 '\n' 符号开头）：

```
#include <iostream>
#include <vector>

std::vector< std::string >split(char * arr)
{
    std::string str = arr;
    std::vector< std::string >result;
    int beg=0, end=0;//begining and end of each line in the array
    while( end = str.find( '\n', beg + 1 ) )
    {
        if(end == -1)
        {
            result.push_back(str.substr(beg));
            break;
        }
        result.push_back(str.substr(beg, end - beg));
        beg = end;
    }
    return result;
} 
```

这是用法：

```
int main()
{
    char * a = "asdasdasdasdasd \n asdasdasd \n asdasd";
    std::vector< std::string >result = split(a);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T14:35:41.043

如果您在 a `char[]`（或 a `unsigned char[]`）中获得了原始数据，并且您知道它的长度，那么只编写一个输入非常简单，不支持`streambuf`允许您创建 an`std::istream` 并`std::getline`在其上使用的 seek。只需致电：

```
setg( start, start, start + length ); 
```

在构造函数中。（不需要其他任何东西。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-14T11:09:18.467

这实际上取决于您将如何解析文本。一种方法是简单地将数据读入字符串向量。我假设您已经涵盖了诸如可扩展性/内存使用等问题。

```
std::vector<std::string> lines;
std::string line;
ifstream file(filename.c_str(), ios_base::in);
while ( getline( file, line ) )
{
    lines.push_back( line );
}
file.close(); 
```

这会将您的文件缓存在`lines`. 接下来你需要通过线路

```
for ( std::vector<std::string>::const_iterator it = lines.begin();
      it != lines.end(); ++it)
{
    const std::string& line = *it;
    if ( line.empty() )
         continue;

    switch ( line[0] )
    {
        case 'g':
            // Some stuff
            break;
        case 'v':
            // Some stuff
            break;
        case 'f':
            // Some stuff
            break;
        default:
            // Default stuff including '#' (probably nothing)
    }
} 
```

当然，这非常简单，很大程度上取决于您要对文件做什么。

您作为示例给出的文件大小几乎不可能导致 IO 压力（除非您使用一些非常轻量级的设备），但如果您一次读取多个文件，我想这可能是一个问题。

我认为您在这里关心的是最小化 IO，我不确定这个解决方案是否真的有那么大的帮助，因为您将迭代一个集合两次。**如果您需要返回并一遍又一遍地读取同一个文件，那么将文件缓存在内存中肯定会加快速度，**但也有同样简单的方法可以做到这一点，例如内存映射文件和使用普通文件访问。如果您真的很担心，请尝试分析这样的解决方案，而不是在从 IO 读取时直接处理文件。

# php - 查找不是引号的第一个指定字符

> ID：11472079
> 
> 赞同：1
> 
> 时间：2012-07-13T14:05:27.267
> 
> 标签：php, regex

我试图弄清楚如何在字符串中找到第一次出现的指定字符（比如说=）。这很容易，但我想要那个 = 的位置，只有当它不在引号中时。

例如，在这种情况下：

```
 foo = bar 
```

我想要第一个 = 的位置，但在这种情况下：

```
 "foo = bar" = baz 
```

我想要第二个=的位置。

我在这里发现了[类似的问题](https://stackoverflow.com/questions/1721921/how-could-i-find-all-whitespaces-excluding-the-ones-between-quotes)，但我需要位置，而不是拆分。而且我必须能够处理转义引号 \" 或 \' 所以我认为我将无法使用基于字符串的方法来解决这个问题。

我的一个想法是使用 lex。使用基于正则表达式的语法分析进行分析，它可以为我找到第一次出现的 =，但它似乎相当沉重:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T14:09:41.530

这应该可以通过正则表达式实现，因为引号不能嵌套，如下所示：

```
^([^="]|"(\\"|[^"])*")*(=) 
```

您需要找到最终匹配组的索引位置`(=)`。

演示：[http ://www.rubular.com/r/jt5CSIaOjo](http://www.rubular.com/r/jt5CSIaOjo)

# wpf - 双击功能区时禁用最小化或最大化

> ID：11472086
> 
> 赞同：3
> 
> 时间：2012-07-13T14:05:54.097
> 
> 标签：wpf, ribbon, double-click, minimize, maximize

我将功能区用于 WPF（2010 - Microsoft.Windows.Controls.Ribbon）。

当我双击选项卡（标题）时，如何禁用红色范围的最小化或最大化效果

![在此处输入图像描述](../Images/d0f084c4e0a38454aca2785cf7b30f97.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-13T21:23:03.990

**在功能区的SizeChanged**属性上使用此事件来抑制最小化。

```
/// <summary>
/// Disable the minimize functionality of the ribbon.
/// </summary>
/// <param name="sender"></param>
/// <param name="e"></param>
private void RibbonSizeChanged(object sender, SizeChangedEventArgs e)
{
    var ribbon = sender as Ribbon;
    if (ribbon != null)
    {
        ribbon.IsMinimized = false;
    }

    // Handled
    e.Handled = true;
} 
```

# ajax - 如何使用 DOJO AJAX 和 REST 解析 JSON

> ID：11472089
> 
> 赞同：3
> 
> 时间：2012-07-13T14:06:09.010
> 
> 标签：ajax, json, rest, dojo

我正在尝试使用 DOJO AJAX 向 REST 服务器发送请求，但是我得到一个空对象作为结果（控制台）：

You CLICKED = click clientX=34, clientY=13 JSON从服务器加载：null

这是我的代码：

```
// JavaScript Document

// load requirements for declarative widgets in page content
require([   "dojo/parser",
        "dojo/dom",
        "dojo/domReady!",
        "dijit/form/Button"
        ]);

// Start initializing
dojo.ready(function(){

dojo.connect (
                aBut1,
                "onClick",
                function(e){

                    console.log('You CLICKED = ', e);
                    dojo.xhrGet({
                                // The URL of the request
                                url: "http://sampleserver1.arcgisonline.com/ArcGIS/rest/services/Specialty/ESRI_StatesCitiesRivers_USA/MapServer/find",
                                // Handle the result as JSON data
                                handleAs: "json",
                                // content
                                content: {f:"json", searchText:"new", contains:"true", searchFields:"state_new", layers:"2", returnGeometry:"false" },
                                // The success handler
                                load: function(jsonData) {
                                    // Create a local var to append content to
                                    console.info("JSON loaded from server:  ", jsonData);

                                },
                                // The error handler
                                error: function() {
                                    console.log('JSON log Error');
                                }
                            });

                });

}); // End dojo.ready 
```

这是我想使用的 REST 网址：

[http://sampleserver1.arcgisonline.com/ArcGIS/rest/services/Specialty/ESRI_StatesCitiesRivers_USA/MapServer/find?searchText=new&contains=true&searchFields=state_name&sr=&layers=2&returnGeometry=false&f=json](http://sampleserver1.arcgisonline.com/ArcGIS/rest/services/Specialty/ESRI_StatesCitiesRivers_USA/MapServer/find?searchText=new&contains=true&searchFields=state_name&sr=&layers=2&returnGeometry=false&f=json)

我将此 URL 的结果保存在一个 json 文件中，AJAX 会读取该文件并返回一个包含 4 个项目的对象。它没有使用 REST URL。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:38:09.617

我相信您正在尝试使用 dojo.xhrGet 来访问不同的域，这是它无法做到的。

> 限制
> 
> dojo.xhrGet（以及同一行中的其他函数：dojo.xhrPost、dojo.xhrDelete、dojo.xhrPut）受浏览器的“同域”安全策略约束。这意味着他们只能建立与提供 HTML 页面的同一服务器的连接。如果您希望使用此 API 与发起页面的服务器以外的服务器通信，则必须在原始服务器上使用代理并让它转发请求。解决相同域限制的唯一其他解决方案是使用备用 IO 方法，例如 dojo.io.script。

[http://dojotoolkit.org/reference-guide/1.7/dojo/xhrGet.html](http://dojotoolkit.org/reference-guide/1.7/dojo/xhrGet.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:21:00.600

这没什么好说的。如果您使用`curl`向该 URL 发出请求会发生什么？

您使用的是 Dojo 1.7 吗？如果是这样，也许[Ajax 快速入门文档](http://dojotoolkit.org/reference-guide/1.7/quickstart/ajax.html#dojo-1-7-amd)可以提供帮助（我直接链接到 AMD 样式，因为如果可以的话，这可能是您应该使用的）。上还有更详细的[文档`xhrGet`](http://dojotoolkit.org/reference-guide/1.7/dojo/xhrGet.html#dojo-xhrget)。

# git - 远程文件资源管理器中的 Git Aptana 集成

> ID：11472093
> 
> 赞同：2
> 
> 时间：2012-07-13T14:06:28.503
> 
> 标签：git, aptana

仅当 git 项目检出到我的本地文件系统时，Aptana 才提供 Git 集成（右键单击 > 团队）。如果我正在处理托管在远程服务器上的 Git 存储库，则不会发生这种情况。我知道在远程存储库上工作并不理想，但是有没有办法让 Aptana 识别远程 git 存储库并拥有 git 命令也为他们启用？

# objective-c - 如何以编程方式从 iphone appliaction 访问电子邮件联系人？

> ID：11472097
> 
> 赞同：0
> 
> 时间：2012-07-13T14:06:33.647
> 
> 标签：objective-c, ios, email, abaddressbook

嗨，我想从用户电子邮件中检索所有电子邮件联系人，即 gmail 或 yahoo 或来自我的 iphone 应用程序的任何邮件，是否可能，给我解决方案，提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:17:54.217

[谷歌目标 C API](http://code.google.com/p/gdata-objectivec-client/)

以此为起点，您还可以通过以下方式获取他们的联系人：

[Apple 联系人文档](http://developer.apple.com/library/ios/#documentation/ContactData/Conceptual/AddressBookProgrammingGuideforiPhone/Introduction.html)

# xml - 我无法弄清楚这个错误解析 XML：找不到元素

> ID：11472098
> 
> 赞同：0
> 
> 时间：2012-07-13T14:06:35.023
> 
> 标签：xml, parsing

最后一行代码是我得到 Parsing XML 错误的地方。我相信这也是导致我的其他 5 个错误的原因。我是编码新手，所以我会尽力提供帮助解决这个问题所需的信息。

```
 <?xml version="1.0" encoding="utf-8"?>
        <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    >
<Button android:id="@+id/btnStart" android:layout_width="wrap_content"android:layout_height="wrap_content" android:text="Start AsyncTask"></Button>
<Button android:id="@+id/btnSend" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Send Message"></Button>
<TextView android:id="@+id/textStatus" android:textSize="24sp" android:layout_width="fill_parent" android:layout_height="wrap_content" android:text="Status Goes Here" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T14:46:36.543

这是我注意到的。

1.  元素没有结束标签`TextView`。
2.  在第一个元素中，属性和`Button`之间没有空格。`android:layout_width``android:layout_height`

# node.js - 来自节点的ajax响应

> ID：11472100
> 
> 赞同：0
> 
> 时间：2012-07-13T14:06:39.003
> 
> 标签：node.js, jquery

我正在调用一个 node'js 进程来抓取 twitter 并从数据中创建一个图表......

这是代码。

```
var http  = require('http');
var url   = require('url');
var exec  = require('child_process').exec;
var fs    = require('fs');

var filepath = 'filenamegraph.png';

http.createServer(function(req,res){
    var urlstr = url.parse(req.url,true);
    var twit = exec("php -f twitter-scraper.php "+urlstr.query.term ,function(error, stdout, stderr){
        var graphstring = stdout;
        var stream = fs.createWriteStream("graph.txt");
        stream.once('open', function(fd){  
            stream.write(graphstring, function(){
                exec('dot -T png -o filenamegraph.png graph.txt', function(){
                    fs.stat(filepath,function(err,stat){
                        res.writeHead(200,{'Content-Type':'image/png', 'Content-Length': stat.size });
                        fs.readFile(filepath,function(err,file_conts){
                            res.write(file_conts);
                            res.end();
                        });
                    });
                });
            });
        });
    });
}).listen(1337); 
```

所有这一切都是笨拙的多莉...

现在我称之为：

```
$.ajax({
    url: 'http://eavesdropper.dev:1337',
    data: { term : $.url.parse().params.term },
    success: function(data) {
        var res = $.parseJSON(data);
        console.log(res);
        $("body").append('<img src="filenamegraph.png" />');
    },
    error: function(jqXHR, textStatus, errorThrown) {
        console.log(jqXHR,'errror - ' + textStatus + " - " + errorThrown + ' ||');
    },
    complete: function(jqXHR, textStatus){
        console.log(jqXHR, textStatus)
    }
}); 
```

幕后的工作很好，但我明白了......

```
Object { readyState=0, status=0, statusText="error"} error - error - || 
```

不确定下一步是什么，因此非常感谢任何提示。

PS：直接在浏览器中运行脚本可以正确地处理图形，因此可以确定将数据返回给令人不安的 ajax 调用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T23:02:43.787

您的服务器正在提供新创建的图形文件的内容，但您的客户端所做的只是尝试解析内容，就好像它是 JSON（它显然不是，导致您的错误消息），然后插入一个`<img>`元素将导致浏览器从提供原始 HTML 的任何服务器请求“filenamegraph.png”。

It looks to me like you don't need to do an AJAX request at all; just append `<img src='http://eavesdropper.dev:1337/?your_params' />` and the browser will automatically get and display the generated image from your server.

# gwt - 将 GWT 小部件插入 div 元素

> ID：11472102
> 
> 赞同：7
> 
> 时间：2012-07-13T14:06:43.743
> 
> 标签：gwt, html

我正在使用一个 GWT 库 (gwt-openlayers)，它允许我创建一个包含任意 HTML 的地图弹出窗口，类似于 Google 地图。我需要这个 HTML 来包含一个 GWT Button 小部件。

我正在像这样动态创建一些 HTML 元素：

```
Element outerDiv = DOM.createDiv();
outerDiv.getStyle().setOverflow(Overflow.HIDDEN);
outerDiv.getStyle().setWidth(100, Unit.PCT);
outerDiv.appendChild(new HTML(mapPOI.getHtmlDetails()).getElement());
Button popupButton = new Button("View Property");
popupButton.getElement().getStyle().setFloat(com.google.gwt.dom.client.Style.Float.RIGHT);
outerDiv.appendChild(popupButton.getElement()); 
```

然后我通过调用获取这些元素的源 HTML

```
String src = outerDiv.toString(); 
```

并将这个 html 插入到我的地图标记中。现在我的地图标记显示内容正常，包括按钮。但是，按钮不会响应任何事件！据我所知，这是因为永远不会调用按钮 onAttach() 方法。

有一个更好的方法吗？

谢谢，

乔恩

**~~~~编辑~~~~**

我现在正在尝试一种新的方法，这似乎是查看其他类似帖子的公认方法。

首先，我正在创建我的 div：

```
String divId = "popup-" + ref;
String innerHTML = "<div id=\"" +divId + "\"></div>"; 
```

然后我将它添加到我的地图弹出窗口并显示它（将它添加到 DOM）。显示弹出窗口后，我得到如下元素并尝试在其周围包裹一个 HTMLPanel：

```
Element element = Document.get().getElementById(divId);
HTMLPanel popupHTML = HTMLPanel.wrap(element); 
```

我的 div 元素已成功检索。然而，`HTMLPanel.wrap(element);`并没有完成。原因是`wrap(..)`调用`RootPanel.detachOnWindowClose(Widget widget)`，其中包括以下断言：

```
assert !widgetsToDetach.contains(widget) : "detachOnUnload() called twice "
    + "for the same widget";
assert !isElementChildOfWidget(widget.getElement()) : "A widget that has "
    + "an existing parent widget may not be added to the detach list"; 
```

我放了一些断点，似乎第二个断言失败了！

有谁知道为什么会这样？这个断言失败真的会导致方法完全失败（不返回）吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-07-21T07:50:16.270

您的第一种方法很好，您只需要为您的按钮注册 onClick 事件，如下所示：

```
DOM.sinkEvents(popupButton.getElement(), Event.ONCLICK);
DOM.setEventListener(popupButton.getElement(), new EventListener() {
    @Override
    public void onBrowserEvent(Event event) {
        //implement the logic after click
    }
}); 
```

我已经检查过了，它可以 100% 工作！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T15:38:26.940

你可以尝试类似的东西

```
RootPanel.get("idOfYourMapMarker").add(popupButton); 
```

参见[RootPanel.get()](http://google-web-toolkit.googlecode.com/svn/javadoc/2.3/com/google/gwt/user/client/ui/RootPanel.html#get%28java.lang.String%29)

不幸的是，RootPanels`AbsolutePanels`对于布局来说不是很好，但如果你只需添加一个简单的按钮就可以工作。你也可以试试`RootLayoutPanel`这会给你一个 LayoutPanel （当你只想让事情流动时也不是很好）。您最终可能会创建一个为您执行布局的容器小部件，并将其添加*到*RootPanel。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-19T06:59:55.440

*SimplePanel*是一个 DIV。也许可以用它来代替？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T18:27:07.463

您添加了元素，但您也必须保留实际 GWT 小部件的层次结构。

**我没有看到一个干净的方法来做到这一点**，但你可以使用 jQuery 之类的东西来通过 ID 来获取按钮，并添加一个点击处理程序，它会调用原始的点击处理程序。

```
private static native void registerEvents(String buttonId, MyClass instance)/*-{
    var $ = $wnd.$;

    //check click
    $('#'+buttonId).live('click', function(e) {
        e.preventDefault();
        instance.@com.package.MyClass::handleButtonClick(Lcom/google/gwt/event/dom/client/ClickEvent;)(null);
    });
}-*/; 
```

在您的 onAttach 或构造函数中调用此 registerEvents()。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-21T10:31:11.197

我曾经遇到过类似的问题。`MapWidget`您可以按如下方式使用 gwt-openlayer ：

```
private MapWidget createMapWidget() {
    final MapOptions defaultMapOptions = new MapOptions();
    defaultMapOptions.setDisplayProjection(DEFAULT_PROJECTION);
    defaultMapOptions.setNumZoomLevels(TOTAL_ZOOM_LEVELS);

    MapWidget mapWidget = new MapWidget(MAP_WIDGET_WIDTH, MAP_WIDGET_HEIGHT, defaultMapOptions);

    map = mapWidget.getMap();

    return mapWidget;
} 
```

然后将其添加到任何面板，无论是垂直的还是水平的。

```
MapWidget mapWgt = createMapWidget();

VerticalPanel mainPanel = new VerticalPanel();
mainPanel.add(mapWgt);
...
... add whatever you want
... 
```

您最终可以将创建的`Panel`（包含`MapWidget`和 gwt 小部件）添加到`PopupPanel`. 此外，您现在应该能够将处理程序添加到 gwt 按钮。

# python - 网站抓取,机器人识别

> ID：11472103
> 
> 赞同：0
> 
> 时间：2012-07-13T14:06:44.523
> 
> 标签：python, authentication, urllib

是否有网站将其标识为正在访问它的脚本，尽管我假设更改了 User-Agent 标头并给出错误。

```
import urllib,urllib2
req_headers = {'User-Agent':'Mozilla/5.0'}
req = urllib2.Request(url,headers = req_headers)
html = req.open(url) 
```

如果是，那怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:14:12.083

首先，您的用户代理非常不完整，很容易被检测为假的。

我在回答[投票比赛中的作弊者时](https://stackoverflow.com/questions/2333054)描述了一些机器人检测技术。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:16:02.257

是的。对于初学者，在使用 Firebug 之类的工具浏览网页时，请查看完整的标题。您会注意到普通浏览器提供了很多信息，例如接受的语言，而`urllib`. 因此，网站可能会检查是否存在其他标头信息。

另一个技巧是在页面上包含一个 1x1 像素的图像，并检查客户端是否请求了图像文件。如果不是，那么客户端正在使用纯文本浏览器（如[lynx](http://lynx.browser.org/)）或者实际上是一个脚本。我认为 JavaScript 也可以用来寻找鼠标的存在。

一般来说，这是一场猫捉老鼠的游戏。一种替代方法`urllib`是[Selenium](http://seleniumhq.org/)。Selenium 将启动一个浏览器窗口。

# c - C程序在执行shellcode时挂起/挂起

> ID：11472105
> 
> 赞同：1
> 
> 时间：2012-07-13T14:06:46.973
> 
> 标签：c, shellcode

```
#include <stdio.h>
char shellcode[] = "some shellcode here";
int main (int argc, char **argv) {
    void (*sptr)();
    sptr = (void(*)()) (&shellcode);
    sptr();
    printf("must display this");
    return 0;
} 
```

在运行程序时，它执行 sptr() 并挂在那里，可能是因为 shellcode 在内存中运行。printf("..") 永远不会执行。我的问题是我希望程序执行 printf()。

请帮忙 ：）

**回复 Eric Finn 和 Alvin Wong**

我按照你们俩的指示进行了更改，我得到的错误是：

Microsoft Windows [版本 6.1.7600] 版权所有 (c) 2009 Microsoft Corporation。版权所有。

X:>"my program.exe" '»".¼' 不是内部或外部命令、可运行程序或批处理文件。必须显示此

char shellcode[] 有效。我之前已经编译成功了。

以下是带有恶意 shellcode 的原始代码，因此您的防病毒软件应该检测到它，只是为了验证你们的 shellcode 不是问题：

```
#include <stdio.h>
#include <stdlib.h>

char shellcode[] = "\xda\xd3\xd9\x74\x24\xf4\xbd\xe9\x6d\xf8\x29\x58\x33\xc9\xb1"
"\x58\x31\x68\x18\x83\xe8\xfc\x03\x68\xfd\x8f\x0d\xd5\x15\xc6"
"\xee\x26\xe5\xb9\x67\xc3\xd4\xeb\x1c\x87\x44\x3c\x56\xc5\x64"
"\xb7\x3a\xfe\xff\xb5\x92\xf1\x48\x73\xc5\x3c\x49\xb5\xc9\x93"
"\x89\xd7\xb5\xe9\xdd\x37\x87\x21\x10\x39\xc0\x5c\xda\x6b\x99"
"\x2b\x48\x9c\xae\x6e\x50\x9d\x60\xe5\xe8\xe5\x05\x3a\x9c\x5f"
"\x07\x6b\x0c\xeb\x4f\x93\x27\xb3\x6f\xa2\xe4\xa7\x4c\xed\x81"
"\x1c\x26\xec\x43\x6d\xc7\xde\xab\x22\xf6\xee\x26\x3a\x3e\xc8"
"\xd8\x49\x34\x2a\x65\x4a\x8f\x50\xb1\xdf\x12\xf2\x32\x47\xf7"
"\x02\x97\x1e\x7c\x08\x5c\x54\xda\x0d\x63\xb9\x50\x29\xe8\x3c"
"\xb7\xbb\xaa\x1a\x13\xe7\x69\x02\x02\x4d\xdc\x3b\x54\x29\x81"
"\x99\x1e\xd8\xd6\x98\x7c\xb5\x46\xc0\x0a\x45\xfe\x7d\x9a\x2b"
"\x97\xd5\x34\xf8\x10\xf0\xc3\xff\x0b\xcd\x34\xa8\xe4\x79\x9c"
"\x3d\x0a\xd2\x4a\xf8\x5c\xa3\x2d\x03\xb5\xb8\x79\xa7\x04\xf6"
"\x2f\x06\x0c\x0b\x81\xf9\xb8\x5b\x21\xfa\x38\x0f\x71\x92\x6f"
"\x26\xee\xa4\x70\xed\xfa\x1d\xd7\x3f\x2f\x0f\x8f\x3f\xcd\x90"
"\xcb\x12\x83\x82\x82\xc0\x73\x4b\xcf\xb0\x5d\xb0\xf0\xee\x2b"
"\x00\x64\x01\x77\xbc\x87\x76\xd0\xe9\x20\x2f\xb6\x38\xc8\xd7"
"\x3d\xbc\x01\x62\x01\x37\xb3\x26\xf6\xa8\x28\x51\x1d\x81\x46"
"\x65\x1d\xed\x69\x45\x98\x22\xf8\xdf\x5c\x43\x6a\x10\xe9\xe1"
"\x3c\x2f\xc7\x8c\x80\xa7\xe8\x40\x00\x38\x81\x60\x00\x78\x51"
"\x36\x68\x20\xf5\xeb\x8d\x2f\x20\x98\x1e\x83\x42\x78\xf7\x4b"
"\x55\xa7\xf7\x8b\x06\xf1\x9f\x99\x3e\x74\xbd\x61\xeb\x02\x81"
"\xea\xd9\x86\x06\x12\x21\x1d\xc8\x61\x40\x46\x0b\x61\xef\x88"
"\x74\x8d\x9d\x1f\xe9\x00\x31\x93\x82\x82\xb9\x7d\x3f\x24\x2f"
"\x82";

int main (int argc, char **argv) {

void (*sptr)();
    sptr = (void(*)()) (&shellcode);
    sptr();
    printf("must display this"); // instead of more lines i put this one
    return 0;
} 
```

*以上代码编译成功，运行完美*

*我将一些行更改为系统（shellcode）。它编译但不能正常运行*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T14:14:16.500

好的，因为`shellcode`实际上是机器代码而不是 shell 代码（根据您的最新编辑），所以答案是不同的。

当你声明`char shellcode[]`,`shellcode`是一个指向内存位置的指针。这意味着，而不是

```
sptr = (void(*)()) (&shellcode); 
```

你应该有

```
sptr = (void(*)()) (shellcode); 
```

此外，您希望代码位于二进制文件的可执行部分，而不是二进制文件的数据部分。这意味着你想要`char *shellcode = ...`而不是`char shellcode[] = ...`.

此外，您应该确保它`shellcode`是一个有效的编译 C 函数，其调用约定与调用它的代码相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T08:31:39.290

据我了解，您想运行一些“机器代码”（*不是*shellcode），并且无论代码如何运行，它都应该继续执行程序。

这是可能的，通过使用线程。

首先添加这些包括：

```
#include <windows.h>
#include <process.h> 
```

在您的代码中：

```
void (*sptr)(void*);                  // Type for `_beginthread`
sptr = (void(*)(void*)) (&shellcode); // PLEASE rename to `machinecode`
_beginthread(sptr,0,NULL);            // This starts your code in a new thread
Sleep(5000);                          // Wait for 5000 ms
printf("must display this"); 
```

当然，这*不是*多线程程序的正确方法，但是由于您的代码是“机器代码”，因此没有太多工作要做。

PS 当我尝试您的代码时，它最终到达“访问冲突”（分段错误）（并显示“x.exe 遇到问题”对话框），**并且我的防病毒软件没有检测到任何东西**（我需要切换到另一个一个？？），因此您可能需要查看代码或添加异常处理程序...

# javascript - 如何扩大孩子 100% 的身体宽度？

> ID：11472110
> 
> 赞同：3
> 
> 时间：2012-07-13T14:07:06.740
> 
> 标签：javascript, html, css

我有这样的事情：

```
<body>
    <div style="width:700px; margin:0 auto;">
        <div class="inner-div"></div>
    </div>
</body> 
```

有没有办法将具有“inner-div”类的子 div 扩展到身体宽度的 100%？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-13T14:14:54.543

这使得`inner-div`从左到右拉伸：

```
div.inner-div {
  position: absolute;
  left: 0;
  width: 100%;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-03-23T19:51:16.223

这是一篇旧帖子，但我在这里找到了更好的解决方案：[如果容器 div 较小，如何将子 div 扩展到 100% 屏幕宽度？](https://stackoverflow.com/questions/31391459/how-can-i-expand-a-child-div-to-100-screen-width-if-the-container-div-is-smalle)

所以在这种情况下

```
.inner-div {
  width: 100vw;
  margin-left: calc(-50vw + 50%);
}
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T14:14:59.323

我没有对此进行测试，但它*可能会*起作用：

为此，您需要 jQuery。

```
//I'm using a resize event in case the body with changes. At least i think that will work.
window.onresize = function(event) {
    var bWidth = $("body").width():
    $(".inner-div").width(bWidth);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-13T14:18:41.527

不是只有css。由于您为父级设置了 700px 的值，因此子级继承了它。但是你可以用 javascript 做到这一点。这里有 jquery：

```
$(window).bind("load resize", function(){
  $('.inner-div').width($('body').width());
}); 
```

即使您调整窗口大小，它也可以工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-11-27T11:19:10.197

让我稍微纠正一下。

您还需要为您的拉伸元素提供一些以像素/em 为单位的“最小宽度”值，并且（不是必需的，但很好的做法）也为 body 元素提供最小宽度。

IE：

```
body {
  min-width: 1000px;
}

.outer {
  width: 1000px;
  height: 200px;
  margin: auto;
}

.inner {
  position: absolute;
  min-width: 1000px;
  height: 100px;
  left: 0;
  right: 0;
} 
```

如果没有设置最小宽度并且您的 HTML/CSS 不是为响应式站点构建的，则在调整浏览器窗口大小时，您可能会在内部 DIV 元素处看到错误。属性“width: 100%”使元素总是拉伸到浏览器窗口大小的 100%。因此，如果浏览器视口变得小于内容并且出现滚动条，则内部 DIV 将保持在实际浏览器视口大小，从而导致在您滚动站点时外观似乎被破坏。

你可以在这里试试：http: [//jsfiddle.net/W4vum/](http://jsfiddle.net/W4vum/)

尝试将示例中“.inner”DIV 的“最小宽度”值从 1000px 更改为 100%，调整窗口大小并滚动到一侧，然后您会看到它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-13T14:16:19.010

如果将宽度 100% 指定给内部 div，它将适合外部 div 的宽度。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-13T14:16:51.190

一个如何用css做的小例子，所以在javascript中设置我猜想的属性是一样的：http: [//jsfiddle.net/u8mJW/](http://jsfiddle.net/u8mJW/)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-07-10T12:08:56.463

为了使这项工作在纯 CSS 中工作，所有父元素都必须是`position:static;` （或没有位置属性，因为静态是默认值）

之后你可以使用 Stefan 的代码

```
div.inner-div {
  position: absolute;
  left: 0;
  width: 100%;
} 
```

（更正了 Ricola3D 的小提琴：http: [//jsfiddle.net/u8mJW/23/](http://jsfiddle.net/u8mJW/23/)）

# android - 在 Rect android 上绘制平铺位图

> ID：11472117
> 
> 赞同：7
> 
> 时间：2012-07-13T14:07:23.167
> 
> 标签：android, bitmap, rect

我正在尝试沿矩形绘制位图，但我不知道该怎么做。有没有办法使用绘画属性或其他东西沿着 Rect 对象平铺位图？我已经看过了，但我找不到任何让它做我需要的东西，大多数平铺选项不会为特定实例平铺它，它们沿着整个屏幕平铺，所以使用该位图的所有内容都结束了有一个大的位图同时沿所有它们平铺，无需滚动或任何东西。

有任何想法吗？如果您需要更多信息，请告诉我，这是一个奇怪的问题，所以我知道我可能没有提到重要的事情。

威廉

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-13T15:00:25.540

有几种方法可以攻击它。我将在这里概述其中两个...

**单程：**

您可以在 Bitmap 周围定义一个[BitmapDrawable](http://developer.android.com/reference/android/graphics/drawable/BitmapDrawable.html)。将其 TileMode 设置为重复。通过 setBounds(rect) 给它一些界限，其中 rect 是您的 Rect 实例。

下面是一个使用 View onDraw 作为上下文的简短示例：

```
public class MyView extends View {
    Rect rect;
    Bitmap mBitmap;
    BitmapDrawable mDrawable;

    public MyView(Context context) {
        super(context);
        rect = new Rect(0, 0, 100, 100);
        mBitmap = loadBitmap();
        mDrawable = new BitmapDrawable(context.getResources(), mBitmap);
        mDrawable.setTileModeXY(TileMode.REPEAT, TileMode.REPEAT);
        mDrawable.setBounds(rect);
    }

    @Override
    protected void onDraw(Canvas canvas) {
        super.onDraw(canvas);
        mDrawable.draw(canvas);
    }

    public Bitmap loadBitmap() {
        // included only for example sake
        Paint paint = new Paint();
        paint.setColor(Color.RED);
        Bitmap bm = Bitmap.createBitmap(10, 10, Bitmap.Config.ARGB_8888);
        Canvas canvas = new Canvas(bm);
        canvas.drawRect(0,0,10,10, paint);
        paint.setStyle(Style.STROKE);
        paint.setColor(Color.BLUE);
        canvas.drawRect(0, 0, 9, 9, paint);
        return bm;
    }
} 
```

**笔记：**

您还可以在 xml 中定义 BitmapDrawable，而不是在代码中进行。

此外，如果您知道通过 getResources().getDrawable(resourceId) 加载的可绘制对象确实只是一个位图，则可以将其转换为 BitmapDrawable 并在那里设置 TileMode。啦啦：

```
public class MyView extends View {
    Rect rect;
    BitmapDrawable mDrawable;

    public MyView(Context context) {
        super(context);
        rect = new Rect(0, 0, 400, 240);
        mDrawable = (BitmapDrawable) context.getResources().getDrawable(R.drawable.ic_launcher);
        mDrawable.setTileModeXY(TileMode.REPEAT, TileMode.REPEAT);
        mDrawable.setBounds(rect);

        this.setBackgroundDrawable(context.getResources().getDrawable(R.drawable.ic_launcher));
    }

    @Override
    protected void onDraw(Canvas canvas) {
        super.onDraw(canvas);
        mDrawable.draw(canvas);
    }
} 
```

此示例显示背景被拉伸，并在其顶部绘制平铺版本。

**其他方式：**

在 x 和 y 方向上循环并将位图重复绘制到矩形中：

```
public class MyView extends View {
    Rect rect;
    Bitmap mBitmap;

    public MyView(Context context) {
        super(context);
        rect = new Rect(0, 0, 100, 100);
        mBitmap = loadBitmap();
    }

    @Override
    protected void onDraw(Canvas canvas) {
        super.onDraw(canvas);
        final int bmWidth = mBitmap.getWidth();
        final int bmHeight = mBitmap.getHeight();

        for (int y = 0, height = rect.height(); y < height; y += bmHeight) {
            for (int x = 0, width = rect.width(); x < width; x += bmWidth) {
                canvas.drawBitmap(mBitmap, x, y, null);
            }
        }
    }

    public Bitmap loadBitmap() {
        // included only for example sake
        Paint paint = new Paint();
        paint.setColor(Color.RED);
        Bitmap bm = Bitmap.createBitmap(10, 10, Bitmap.Config.ARGB_8888);
        Canvas canvas = new Canvas(bm);
        canvas.drawRect(0,0,10,10, paint);
        paint.setStyle(Style.STROKE);
        paint.setColor(Color.BLUE);
        canvas.drawRect(0, 0, 9, 9, paint);
        return bm;
    }
} 
```

我个人会选择第一个（BitmapDrawable）方法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-09-21T01:36:49.743

你可以像 BitmapDrawable 那样做：

用位图着色器定义画图，然后用该画图绘制矩形：

```
>     Paint paint = new Paint();
>     paint.setShader(new BitmapShader(bitmap, Shader.TileMode.REPEAT, Shader.TileMode.REPEAT));
>     
>     canvas.drawRect(destRect, paint); 
```

# xml - DTD 到 XSD 的转换

> ID：11472118
> 
> 赞同：0
> 
> 时间：2012-07-13T14:07:23.247
> 
> 标签：xml, xsd, dtd

我坚持从 DTD 进行以下转换：

```
<!ELEMENT contact (name+, ((email | phone+) | (email, phone+)), address?)> 
```

到 XSD：

```
<xs:element name="contact">
<xs:complexType>
  <xs:sequence>
    <xs:element maxOccurs="unbounded" ref="name"/>
    <xs:choice>
      <xs:choice>
        <xs:element ref="email"/>
        <xs:element maxOccurs="unbounded" ref="phone"/>
      </xs:choice>
      <xs:sequence>
<!-- Next line causes exception -->
        <xs:element ref="email"/>
        <xs:element maxOccurs="unbounded" ref="phone"/>
      </xs:sequence>
    </xs:choice>
    <xs:element minOccurs="0" ref="address"/>
  </xs:sequence>
</xs:complexType> 
```

我得到“元素‘电子邮件’的多重定义导致内容模型变得模棱两可。” 例外。我做错了什么？任何要克服的建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T16:42:21.660

DTD 内容模型不明确，因此转换器在模式中生成了不明确的内容模型。DTD 和 XSD 都禁止模棱两可的内容模型。

这里的“歧义”是一个技术术语，它意味着当在输入中找到一个“电子邮件”元素时，它无法判断该选择的哪个分支。有不同种类的歧义——有些可以通过前瞻来解决，有些则不能；但这在这里无关紧要。如果您将错误的 DTD 输入转换器，您将得到一个错误的模式。

在这种特殊情况下，消除歧义是微不足道的，只需将内容模型更改为

```
<!ELEMENT contact (name+, email, phone+, address?)> 
```

在更一般的情况下，消除歧义是计算机科学中一个困难（但已解决）的问题。

# php - 将 AS3 转换为 PHP 加密

> ID：11472123
> 
> 赞同：-4
> 
> 时间：2012-07-13T14:07:35.600
> 
> 标签：php, actionscript-3

我想知道是否有人可以将这个小代码从 as3 转换为 php。

```
function hashActiveLoginKey($password)
{
    var _loc_2:* = new MD5();
    var _loc_3:* = new ByteArray();
    _loc_3.writeUTFBytes("(LHny:TyGynR" + param1);
    var _loc_4:* = _loc_2.hash(_loc_3);
    var _loc_5:* = Hex.fromArray(_loc_4);

    return Hex.fromArray(_loc_4);
} // end function 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:13:33.210

在 PHP 中它将是：

```
return md5("(LHny:TyGynR" . $param1); 
```

# c# - 多个控制实例导致按钮干扰

> ID：11472125
> 
> 赞同：0
> 
> 时间：2012-07-13T14:07:59.437
> 
> 标签：c#, umbraco, webforms, custom-data-type

***一点背景：***

我一直在研究 Umbraco 的自定义数据类型。数据类型显示特定类型的节点列表，并允许用户从该列表中进行选择。我试图使这种数据类型可重用，这样我就不必为我希望列出的每种类型的节点创建一个单独的数据类型。我只需创建此数据类型的属性并设置要显示的节点类型。

数据类型是一个 UpdatePanel，其中包含一个复选框列表（用于每个要选择的节点）和一个用于在选择中添加/删除这些节点的按钮。

例如，如果我有一个帖子，我可以添加此数据类型并将其设置为列表类别，这允许我将帖子与类别列表相关联。如果我想再有这个数据类型的另一个实例，比如选择作者，我开始遇到问题。

***数据类型结构信息***

这应该提供有关如何构建此控件的更多详细信息。它使用[3 类方法](http://www.nibble.be/?p=50)来创建 umbraco 数据类型，因此我没有 .ascx 文件，只有一个 .cs 文件，它以编程方式将元素呈现到页面上。

通过遍历节点列表并呈现以下内容来呈现复选框：

```
<input type='checkbox' name='select_nodes' value='" + n.Id + "' /> 
```

然后我渲染两个按钮，一个用于将节点添加到选定节点列表中，另一个用于删除它们（我只是在此处显示添加）。这个按钮简单地获取 Form["select_nodes"] 的值，它包含一个逗号分隔的节点 ID 列表，并且对于每一个，将其添加到单独的节点列表中。

按钮添加如下：

```
public override void OnInit(EventArgs e)
{
    //Add Button
    btn_Add = new Button();
    btn_Add.CssClass = "btn_add";
    btn_Add.ID = "btnAdd" + Guid.NewGuid();
    btn_Add.Text = "Add >>";
    btn_Add.Click += new EventHandler(selectNodes);
    base.ContentTemplateContainer.Controls.Add(btn_Add);
} 
```

上面描述了这个控件的基本形式，希望能对设置提供更多的了解。

***问题***

在加载具有此数据类型的多个实例的节点时，如上例所示，由于重复的控制 ID 会发生错误，我通过将随机 guid 附加到 ID 来克服这个问题。现在的问题是选择/取消选择节点的按钮似乎不起作用。我假设这是由于这些按钮有多个实例，并且对触发哪个事件感到困惑？

有没有办法解决这个问题？为了避免跨控件的多个实例的干扰？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T15:41:16.230

以下是一些您可能会发现有用的资源：

*   [ASP.NET 提示：动态控件的黄金法则](http://geekswithblogs.net/shahed/archive/2008/06/26/123391.aspx)。
*   [使用 UpdataPanel 的自定义数据类型](http://our.umbraco.org/forum/developers/extending-umbraco/4370-Custom-Datatype-with-UpdataPanel)
*   [Tim Geyssens - 数据类型硕士](http://stream.umbraco.org/video/1533917/tim-geyssens-master-of)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T23:30:04.713

我认为问题是每次您的页面回发时都会再次生成您的控件，并且由于每次都会附加 Guid.NewGuid() ，因此它们最终会以不同的 ID 结束。当页面回发时，它会为您单击的按钮运行 findcontrol，然后从中获取事件处理程序，但如果按钮的 ID 已更改，它将找不到它并且随后找不到它的事件处理程序。

使这种情况起作用的最佳方法不是生成随机字符串以附加到控件名称，而是使用您可以在按钮创建的上下文中控制的已知常量。因此，如果它是列表项的按钮，您每次都将“li”附加到它，或者类似的东西。然后您知道在每次回发时您的控件都具有相同的名称 - 但对于它自己的实例来说仍然是唯一的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T18:54:35.290

***成功***

正如@Infotekka 在下面的评论中指出的那样：

> 我认为问题是每次您的页面回发时都会再次生成您的控件，并且由于每次都会附加 Guid.NewGuid() ，因此它们最终会以不同的 ID 结束。当页面回发时，它会为您单击的按钮运行一个 findcontrol，然后从中获取事件处理程序，但如果按钮的 ID 已更改，它将找不到它并且随后找不到它的事件处理程序

作为回应，我替换了：

```
btn_Add.ID = "btnAdd" + Guid.NewGuid(); 
```

和

```
btn_Add.ID = "btnAdd_" + targetDocType.ToLower(); 
```

继上面的示例之后，这会导致此控件/数据类型的一个实例具有添加/删除按钮，ID 为“btnAdd_Category”和“btnRemove_Category”，而在另一个实例中，ID 为“btnAdd_Author”和“btnRemove_Author”。

最初这并没有解决问题，但在进一步调查中，我有一个 LiteralControl，我将它添加到页面中以包含一些嵌入式 css，并且这个 id 也需要每个实例都是唯一的。

感谢@Infotekka 指出问题的根源，感谢@dludlow 提供链接！

@Infotekka，如果您将之前的评论作为答案发布，我可以将其标记为答案:)

# html - 语言属性与元标记字符集属性

> ID：11472129
> 
> 赞同：4
> 
> 时间：2012-07-13T14:08:08.797
> 
> 标签：html, character-encoding, web

w3c 指出使用`lang`属性为

> 协助搜索引擎
> 
> 辅助语音合成器
> 
> 帮助用户代理选择字形变体以获得高质量的排版
> 
> 帮助用户代理选择一组引号
> 
> 帮助用户代理做出关于连字、连字和间距的决定
> 
> 协助拼写检查和语法检查

但是我发现除了对文档进行编码之外`charset`，标签的属性没有任何用处`meta`

确实`charset`提供与属性相同的功能，`lang`例如***辅助语音合成器、搜索引擎***......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T14:18:46.120

更容易说出他们的共同点：没有。好吧，除了作为某种元数据和与国际化相关。

而正确的形式是`<meta charset="encoding name">`，如`<meta charset=utf-8>`。这不是关于语言，而是关于将文档中的字节解释为字符。已经为特定语言开发了一些编码，但编码和语言仍然是完全不同的概念。

`<meta charset="...">`是 HTML5 的简写

`<meta http-equiv="Content-Type" content="text/html;charset=...">`,[这里描述](http://www.w3.org/TR/html401/charset.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T14:20:28.583

元标记定义您使用的字符集/编码，如 UTF-8、ISO-8859-1 或类似的东西。而 html lang 标签定义了使用的语言，如 en-EN、de-DE 等。

# batch-file - 使用 NSIS 安装程序中的参数运行控制台应用程序

> ID：11472132
> 
> 赞同：2
> 
> 时间：2012-07-13T14:08:12.053
> 
> 标签：batch-file, nsis

我正在为我的项目创建一个安装程序。项目的部署需要一些对 NSIS 过于复杂的更改。

因此，为了方便起见，我用 C# 编写了一个控制台应用程序。此应用程序将使用某些参数进行所需的所有复杂更改。

我只是想问一下用我的安装程序中的一些参数调用这个控制台应用程序的方法是什么？

是否可以通过创建一些批处理文件或什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:12:45.927

`ExecWait '"$instdir\myapp.exe" /foo "hello world" /bar'`是基本方法。

如果要隐藏控制台窗口，请使用[nsExec](http://nsis.sourceforge.net/Docs/nsExec/nsExec.txt) ；如果需要更多控制，请使用[ExecDos](http://nsis.sourceforge.net/ExecDos_plug-in)或[ExecCmd ...](http://nsis.sourceforge.net/ExecCmd_plug-in)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:11:45.347

您有几个选项可以从 NSIS 执行程序，如此处所述：http: [//nsis.sourceforge.net/Docs/Chapter4.html#4.9.1.2](http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.1.2)

**Exec** : 执行指定程序并立即继续

**ExecShell** : 使用 ShellExecute 执行指定的程序

**ExecWait**：执行指定的程序，等待执行的进程退出

最后一个解决方案可能是您需要的。

# javascript - Sencha Touch - 跨域 (CORS) 问题

> ID：11472133
> 
> 赞同：0
> 
> 时间：2012-07-13T14:08:15.180
> 
> 标签：javascript, json, apache, sencha-touch, cors

我正在尝试从跨域 URL 加载数据点。不幸的是，我无法让它工作。据我所知，我已经设置了我的 Apache Linux 服务器来支持 CORS。我将以下内容添加到配置文件的标题中：

```
Header set Access-Control-Allow-Origin "*"
Header set Access-Control-Allow-Methods "GET,POST"
Header set Access-Control-Allow-Headers "X-Requested-With" 
```

这是我商店的当前设置：

```
 var myStore = Ext.create('Ext.data.Store',
    {
            fields: [{name: 'xTime', type: 'int'}, {name: 'yData', type: 'float'}, {name: 'target', type: 'string'}],
            proxy:
            {
                type: 'ajax',
                url: 'http://test.com/datapoints.json',
                useDefaultXhrHeader: false,
                reader: 'points'
            },
            autoLoad: true
    }); 
```

我只是想找出我在这里缺少什么？我正在使用 Safari 对其进行测试，到目前为止，我仍然收到“Access-Control-Allow-Origin”错误。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T19:18:48.427

您能否设置一个数据包嗅探器（例如 WireShark）来查看发送到服务器的实际 HTTP 请求。或者，配置您的服务器以记录请求/响应标头。我的猜测是请求不包含 Origin 标头，或者请求包含其他一些未包含在 Access-Control-Allow-Headers 方法中的请求标头。一个想法，尝试将 Content-Type 添加到 Access-Control-Allow-Headers 方法中；这是请求 JSON 数据时常用的一种。

# php - WordPress/PHP - 如何将变量移动到非 wordpress 文件？

> ID：11472134
> 
> 赞同：0
> 
> 时间：2012-07-13T14:08:16.083
> 
> 标签：php, wordpress

当我在其中执行此代码时，`functions.php`我得到了路径：

```
$upload_dir = wp_upload_dir();
echo $upload_dir['path'];

//Returns: /some/correct/path/ 
```

但我希望将此路径移动到我`uploads.php`无法执行的自定义脚本`wp_upload_dir();`。我显然也不能`include()`使用functions.php，因为它会执行位于那里的所有其他内容。

有什么棘手的方法可以将`$upload_dir`变量传递给`uploads.php`?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:11:55.753

您只需要加载**wp-load.php 即可**访问所有 wordpress 功能，只需执行以下操作：

```
<?php
   require( '../wordpress_install_root/wp-load.php' );
   $upload_dir = wp_upload_dir();
   echo $upload_dir['path'];
?> 
```

这是一个简单的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T14:12:28.063

只需在外部 php 文件的顶部包含以下内容：

```
$wp_url = str_replace('wp-content/plugins/YOUR_PLUGIN_NAME/includes', "", dirname(__FILE__));
include_once($wp_url . 'wp-load.php'); 
```

显然将 YOUR_PLUGIN_NAME 替换为您的插件名称。我在 Paypal 和其他支付网关调用的单个文件中使用它。

有些人还使用以下内容，但我从未让它正常工作，我不确定它是否已被弃用。

```
require_once('../../../../wp-blog-header.php'); 
```

# winapi - 内核和超线程

> ID：11472138
> 
> 赞同：0
> 
> 时间：2012-07-13T14:08:39.047
> 
> 标签：winapi, scalability, multicore, hyperthreading

我正在用 C 编写一个极其优化且 CPU 密集型的多线程代码，它在或多或少有限的时间空间内执行任务。在此期间，除了加载初始值和存储最终结果之外，它不会冒险离开其 L1 缓存。所以本质上这是一个并行化的代码，它为每个添加的核心线性扩展。这就是在非 HT 内核上发生的情况。

在我的带有 HT 的 2 核 i5 上（BIOS 不允许禁用它 - 无论如何这是一个不切实际的解决方案），从一个核心变为两个核心时，我得到了令人讨厌的令人沮丧的改进。我的假设是第一个线程单独运行在一个核心上，第二个线程与第一个共享核心。

Windows API 中有一些函数可以检索有关可用内核和 HT 的信息。但是我如何利用这些信息来确保每个核心的一个超线程上只有一个线程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:37:19.773

这篇文章可能会有所帮助：http: [//msdn.microsoft.com/en-us/magazine/cc300701.aspx#S11](http://msdn.microsoft.com/en-us/magazine/cc300701.aspx#S11)

请参阅“CPU 关联性”部分和“检测超线程”部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T17:57:20.040

无论您是否使用，操作系统都将使用 HT 逻辑内核，其结果是缓存的大小有效减半。您可以将线程固定到逻辑核心，但我怀疑它对您没有帮助。您的问题仅仅是 HT 的存在。您确实需要将其关闭。

# vb.net - 在子字符串中使用 .length (VB.NET)

> ID：11472141
> 
> 赞同：0
> 
> 时间：2012-07-13T14:08:43.400
> 
> 标签：vb.net, indexof, string-length

无法弄清楚为什么这不起作用。

我正在尝试分析包含“。”的可变长度字符串。在里面的某个地方，然后去掉“。” 以及它之前的所有字符。这是通过 Web 服务调用的。

调试时，它工作正常，直到它在下面的最后一行退出，并带有浏览器消息：“System.ArgumentOutOfRangeException：索引和长度必须引用字符串中的位置。参数名称：长度”

有人知道吗？

下面的 Code1 是从 eform 传递给 Web 服务的输入变量。

```
Dim CharNo As New Integer
CharNo = Code1.IndexOf(".")
MyCodebookValueStrip.o_Code1 = Code1.Substring(CharNo + 1, (Code1.Length - CharNo)) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T14:19:58.173

您对剩余字符串长度的计算不正确。你必须再减去一个：

```
Code1.Substring(CharNo + 1, Code1.Length - CharNo - 1) 
```

你也可以省略第二个参数，它会得到字符串的其余部分：

```
Code1.Substring(CharNo + 1) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T14:11:20.997

也许您可以尝试另一种非常简单的方法？

```
MyCodebookValueStrip.o_Code1 = Code1.Split(".").Last() 
```

如果您绝对确定该字符串确实包含句点。否则，使用：

```
MyCodebookValueStrip.o_Code1 = Code1.Split(".").LastOrDefault() 
```

如果您的字符串不包含句点，它将返回“Nothing”。

如果您的字符串包含多个句点，您将在字符串中的最后一个句点之后获得子字符串。但是您确实有其他的余地，例如：

```
"StringOne.StringTwo.StringThree".Split(".").First() 
```

会给你“StringOne”。

```
"StringOne.StringTwo.StringThree".Split(".").Last() 
```

会给你“StringThree”。

```
"StringOne.StringTwo.StringThree".Split(".").Skip(1).Take(1) 
```

会给你“StringTwo”。

您需要引用和导入 System.Linq 才能使用这些东西，这意味着您需要使用 .NET 3.5 或更高版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T14:15:27.400

```
 Dim output As String
   Dim Code1 As String = "test.txt"
   Dim charNo As Integer = Code1.IndexOf('.')
   If ((charNo <> -1) And (Code1.Length <> charNo + 1)) Then
      output = Code1.Substring(charNo, Code1.Length - charNo)
   Else
      output = ""
   End If 
```

以上对我来说完美无缺..可能是您从 IndexOf 方法中获得了 -1 的位置吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T14:19:27.160

问题是您要在起始索引 ( `CharNo + 1`) 上加一，但不会从长度中减去一。要纠正它，你应该写：

```
Code1.Substring(CharNo + 1, (Code1.Length - CharNo - 1)) 
```

但是，这是不必要的，因为您真正需要做的就是：

```
Code1.Substring(CharNo + 1) 
```

此外，您可能应该检查是否`CharNo + 1`小于长度，以防句点是文本中的最后一个字符：

```
If CharNo + 1 < Code1.Length Then
    MyCodebookValueStrip.o_Code1 = Code1.Substring(CharNo + 1)
Else
    MyCodebookValueStrip.o_Code1 = ""
End If 
```

但是，如果您要获取的是文件名的扩展名，那么您应该使用`Path`该类来正确（并且更容易）：

```
MyCodebookValueStrip.o_Code1 = Path.GetExtension(Code1) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-13T14:19:58.770

不应该是：

```
Code1.Substring(CharNo + 1, (Code1.Length - CharNo - 1)) 
```

因为`Code1.Length - CharNo`给了你一个额外的角色。

前任：

```
"abc.abcd" 
```

你想要最后 4 个字符，`length - charNo`结果是 5。因此错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-13T14:31:07.950

谢谢大家。我应该意识到它需要一个-1。这里有这么多正确的答案，我不确定我是否可以选择多个作为“接受的答案”。我会试一试。非常感谢。

# lua - 将lua字符串拆分为字符

> ID：11472143
> 
> 赞同：1
> 
> 时间：2012-07-13T14:08:51.140
> 
> 标签：lua

我只发现这与我正在寻找的内容有关：[按字符数拆分字符串，](https://stackoverflow.com/questions/7111068/split-string-by-count-of-characters)但这对我的意思没有用。

我有一个字符串变量，它是 3 个数字的数量（可以从 000 到 999）。我需要将每个数字（字符）分开并将它们放入表格中。

我正在为一个使用 lua 的游戏模组编程，它有一些额外的功能。如果你能帮助我使用：[http](http://wiki.multitheftauto.com/wiki/Split) ://wiki.multitheftauto.com/wiki/Split会很棒，但任何其他方式也可以。

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T14:15:12.227

**更正了OP想要问的内容：**

要将一个 3 位数的数字拆分为 3 个数字，那就更简单了：

```
s='429'
c1,c2,c3=s:match('(%d)(%d)(%d)')
t={tonumber(c1),tonumber(c2),tonumber(c3)} 
```

**“如何拆分由 3 位数字组成的长字符串”的答案：**

这是微不足道的。您可以查看[`gmatch`参考手册中的功能](http://www.lua.org/manual/5.1/manual.html#pdf-string.gmatch)：

```
s="123456789"
res={}
for num in s:gmatch('%d%d%d') do
    res[#res+1]=tonumber(num)
end 
```

或者如果你不喜欢循环：

```
res={}
s:gsub('%d%d%d',function(n)res[#res+1]=tonumber(n)end) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-14T06:58:23.657

我一直在寻找这样的东西，但要避免循环 - 并希望将它作为单线。[最终，我从lua-users wiki](http://lua-users.org/wiki/SplitJoin)找到了这个例子：Split Join ：

```
fields = {str:match((str:gsub("[^"..sep.."]*"..sep, "([^"..sep.."]*)"..sep)))} 
```

...这正是我想要的那种语法 - 一个班轮，返回一个表 - 除了，我真的不明白发生了什么`:/`尽管如此，经过一番摸索，我设法找到了正确的语法来分割用这个成语写成字符，显然是：

```
fields = { str:match( (str:gsub(".", "(.)")) ) } 
```

我想，发生的事情基本上是在每个字符 ' ' 周围加上`gsub`括号 ' ' - 这样就可以将它们视为一个单独的匹配单元，并将它们“提取”为单独的单元......但我仍然不明白为什么这件作品周围是否有额外的括号。`(.)``.``match``str:gsub(".", "(.)")`

我用 Lua5.1 对此进行了测试：

```
str = "a - b - c"
fields = { str:match( (str:gsub(".", "(.)")) ) }
print(table_print(fields)) 
```

...`table_print`来自[lua-users wiki：表序列化](http://lua-users.org/wiki/TableSerialization)；这段代码打印：

```
"a"
" "
"-"
" "
"b"
" "
"-"
" "
"c" 
```

# ios - 将音频与视频完美融合

> ID：11472144
> 
> 赞同：3
> 
> 时间：2012-07-13T14:08:53.043
> 
> 标签：ios, audio, video, avfoundation, avmutablecomposition

我一直在尝试使用`AVMutableComposition`and将音频与视频合并`AVExportSession`。除了音频和视频源的持续时间不同之外，一切都运行良好。

所以导出的电影有点滞后。无论如何调整或重新定义视频的速率，使其持续时间变得完全等于音频的持续时间？例如，如果音频持续 10 秒，视频持续 9 秒，我想以 9/10 的速度播放视频，所以它们同时结束。b

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T08:14:41.430

解决了

使用类似的东西：

```
[compositionVideoTrack scaleTimeRange:CMTimeRangeMake(kCMTimeZero,videoAsset.duration) toDuration:audioAsset.duration]; 
```

# python - 如何使用 python (requests/urllib3) 登录 facebook？

> ID：11472148
> 
> 赞同：2
> 
> 时间：2012-07-13T14:09:04.130
> 
> 标签：python, http, post, cookies, urllib

我正在尝试使用[http://docs.python-requests.org/en/latest/](http://docs.python-requests.org/en/latest/)自动登录 facebook。

```
s = requests.session()
params = {'email':'MYEMAILHERE','pass':'MYPASSHERE'}
r = s.post("https://www.facebook.com/login.php/", params = params)

print r.text 
```

但不是 fb 向我显示主页，而是向我显示“您的 cookie 已禁用”...页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T02:04:49.520

Michael Heimlich 制作了一个使用 python-requests 与 Facebook API 集成的项目：

[https://github.com/michaelhelmick/requests-facebook](https://github.com/michaelhelmick/requests-facebook)

不过，仍在等待适当的 REST 集成。

还有FacePy：[https ://github.com/jgorset/facepy](https://github.com/jgorset/facepy)

# unit-testing - Sinon.js（JS 模拟库）有哪些替代方案？

> ID：11472150
> 
> 赞同：5
> 
> 时间：2012-07-13T14:09:18.630
> 
> 标签：unit-testing, sinon

Sinon.js 有什么有价值的替代品吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T09:26:16.593

没有那么先进，但你可以看看[Jack](https://github.com/keronsen/jack)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-11-22T18:33:58.563

# Testdouble.js

还有一个名为[testdouble.js](https://github.com/testdouble/testdouble.js)的库。这是一种比 sinon.js 更面向对象的方法。

另外， testdouble 的[这篇文章](http://blog.testdouble.com/posts/2016-03-13-testdouble-vs-sinon.html)解释了 sinon.js 和 testdouble.js 之间的区别。

# 例子

```
var td = require('testdouble');

var fetch = td.function();
td.when(fetch(42)).thenReturn('Jane User');

fetch(42); // -> 'Jane User' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-31T18:43:32.730

我刚刚开始了一个名为 candy-wrapper 的新项目，在某些情况下它可能是 Sinon 的替代品： [https ://www.npmjs.com/package/candy-wrapper](https://www.npmjs.com/package/candy-wrapper)

以下是一些如何使用它的示例，如果有人对如何使它变得更好有任何见解，我会很乐意提供反馈：

```
var Wrapper = require("candy-wrapper");

// a simple test object
var myDrone = {
    name: "DJI",
    fly: function(direction) {
        return true;
    }
}

new Wrapper(myDrone, "name");
new Wrapper(myDrone, "fly");

myDrone.fly("north");
myDrone.fly("west");

// evaluating previous calls through the 'historyList' and 'Filters'
myDrone.fly.historyList.filterFirst().expectCallArgs("north"); // true
myDrone.fly.historyList.filterSecond().expectCallArgs("east"); // false
myDrone.fly.expectReportAllFailtures(); // throws an error about the "east" expecation failing

// modifying behavior using 'Triggers'
myDrone.fly.triggerOnCallArgs("east").actionReturn(false); // will return 'false' when called with "east"
myDrone.fly("east"); // false
myDrone.fly("west"); // true (the default return value)

// working with properties
myDrone.name.triggerOnSet().actionThrowException(new Error("do not set the name"));
myDrone.name = "Bob"; // throws Error: "do not set the name"
var ret = myDrone.name; // ret = "DJI" 
```

# join - PLSQL 批量收集到 UDT 并连接 1-N 个表？

> ID：11472151
> 
> 赞同：1
> 
> 时间：2012-07-13T14:09:21.450
> 
> 标签：join, plsql, user-defined-functions, user-defined-types

我正在尝试整理一些 PL/SQL 代码，尝试测试性能。能够做到这一点将使我们减少对数据库的调用，但我不确定如何填充我创建的返回类型。这是一个设计不佳的表结构，它展示了我想要完成的工作。

```
create table emp_group (
  gid number,
  gname varchar2(10)
);

create table emp (
  empID number,
  gid number,
  empname varchar2(10)
);

create or replace type t_emp_obj as object (
  empID number,
  gid number,
  empname varchar2(10)
);

create or replace type t_emp is table of t_emp_obj;

create or replace type t_group_emp as object
(
  gid number,
  gname varchar2(10),
  g_emps t_emp
);

insert into emp( empID, gid, empName ) values ( 1, 10, 'Rob' );
insert into emp( empID, gid, empName ) values ( 2, 10, 'Ken' );
insert into emp( empID, gid, empName ) values ( 3, 10, 'Dave' );
insert into emp( empID, gid, empName ) values ( 4, 10, 'Ron' );
insert into emp( empID, gid, empName ) values ( 5, 11, 'Joe' );
insert into emp_group( gid, gname ) values (10, 'DDP');
insert into emp_group( gid, gname ) values (11, 'DDD');
commit;

create or replace function f_test1 return t_emp as
  ret t_emp;
begin
  select t_emp_obj(empID, gid, empname) bulk collect into ret from emp;

  return ret;
end;

create or replace function f_test2 return t_group_emp as
  ret t_group_emp;
begin
  select t_group_emp(????) bulk collect into ret
  from emp, emp_group
  where emp.gid = emp_group.gid;

  return ret;
end; 
```

这是一个运行它的函数。

```
set serveroutput on size 10000

declare
  x t_emp;
begin
  x := f_test1;

  for r in (select * from table(cast(x as t_emp))) loop
    dbms_output.put_line(r.empID || ', ' || r.gid || ', ' || r.empname );
  end loop;

end; 
```

我们有两张表，一张是员工列表，一张是员工组列表。忽略 emp_group 和 emp 之间应该有一个连接表这样一个员工可以属于多个组的事实......演示代码。8)

我想以单个返回类型返回给定组 ID 的所有员工以及组行。返回的类型是 t_group_emp，它有一个 emp 行表。**f_test2 的语法是什么？**

1）这可能吗？

2) 我将如何构造 select 语句来填充返回的类型？在这里“批量收集”是正确的方法吗？我发现[这个页面](http://www.adp-gmbh.ch/ora/plsql/bc/index.html)是一个很好的起点。

3）这会表现得有多差？对语法进行排序后，我可以运行自己的数字，但总的来说，这是从具有 1-N 关系的多个表返回数据的好方法吗？

编写应用程序以使用返回的类型很容易，所以我并不担心。

编辑：我们正在使用 Oracle 10.3.something ...

编辑：这接近我想要的，但不完全是。

```
create or replace
function f_test2 return t_group as
  ret t_group;
begin
  select t_group_emp( emp_group.gid, emp_group.gname, t_emp( t_emp_obj( emp.empID, emp.gid, emp.empName ))) bulk collect into ret
  from emp, emp_group 
  where emp.gid = emp_group.gid;

  return ret;
end; 
```

以及一个贯穿那个的函数......

```
set serveroutput on size 10000

declare
  x t_group;
begin
  x := f_test2;

  for r in (select * from table(cast(x as t_group))) loop
    dbms_output.put_line( 'group ' || r.gid || ', ' || r.gname  );
    for s in (select * from table(cast(r.g_emps as t_emp))) loop
      dbms_output.put_line( 'emp ' || s.empID || ', ' || s.empname  );
    end loop;  
  end loop;

end; 
```

给出以下输出：

```
group 10, DDP
emp 1, Rob
group 10, DDP
emp 2, Ken
group 10, DDP
emp 3, Dave
group 10, DDP
emp 4, Ron
group 11, DDD
emp 5, Joe 
```

这很好，但我希望输出看起来像这样，以显示 1-N 关系。

```
group 10, DDP
emp 1, Rob
emp 2, Ken
emp 3, Dave
emp 4, Ron
group 11, DDD
emp 5, Joe 
```

我需要在 f_test2 函数中更改什么来实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-15T14:45:48.103

首先：我目前无法访问/使用 oracle 安装。我试过 SQL Fiddle，但这种问题似乎太复杂了（或者我太笨了，这太可能了:)）。所以我无法对此进行测试。

无论如何，您应该能够通过以下方式实现您的目标：

```
 select t_group_emp(g.gid, 
                     g.gname, 
                     cast(multiset(select e.empID, 
                                          e.gid, 
                                          e.empname 
                                     from emp e
                                    where e.gid = g.gid
                                  ) as t_emp
                         )
                    )
    from emp_group g 
```

别名可能不是必需的，这是我自动做的以减少打字。

# google-analytics - ?wtx=Y 出现在 Google Analytics 上

> ID：11472155
> 
> 赞同：0
> 
> 时间：2012-07-13T14:09:34.147
> 
> 标签：google-analytics

这不是一个典型的问题，但它与网络相关并且与客户网站有关。我已经对此进行了一些研究，并想检查一下这里是否有人遇到过这样的问题。

```
#1: /Fanuc-servo-motor-repair/?wtx=Y
#3: /?wtx=Y
#26: /yaskawa/?wtx=Y 
```

如您所见，这些 url 都以 ?wtx=Y 结尾。有谁知道这可能是什么原因造成的？当我无法弄清楚它来自我自己时，很难向客户解释。它是否与 Google AdWords 或 AdCenter(Bing/Yahoo) 之类的帐户有关？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T14:23:46.870

请注意，虽然这个答案没有解决参数的来源，但它可能有用。

在配置文件设置管理面板中，您可以将 Analytics 设置为忽略某些参数。这将阻止此“wtx”参数出现在您的报告中。

请参阅：[排除 URL 查询参数](http://support.google.com/analytics/bin/answer.py?hl=en&answer=1010249)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T00:46:09.060

它们是否托管在 Webvanta 上？- `wtx`是他们的分类参数。

请参阅：http: [//support.webvanta.com/support_article/615767](http://support.webvanta.com/support_article/615767)

（目前不考虑堆栈溢出的主题，网站管理员可能是最好的地方 - Google Analytics 问题在这两个地方都不是很好 - 需要一定水平的编程技能才能使中等复杂的 GA 安装正常工作，但是对报告的解释并不是 Stack Overflow 的主题——跨 Stack Exchange 标签可能是正确的答案）。

# java-me - LWUIT 位图字体无法正常工作？

> ID：11472156
> 
> 赞同：2
> 
> 时间：2012-07-13T14:09:39.297
> 
> 标签：java-me, lwuit, bitmap-fonts

当我`List`在模拟器中的 lwit 和索尼爱立信 k510i 中使用位图字体时，一切正常，但在 g900 中，如果字体大小大于 9 个字，则不显示？请帮我解决这个问题...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T12:03:59.017

使用位图字体时，您必须为不同的屏幕宽度使用不同的字体对象。

例如，如果 240*320 设备的字体大小为 12 表示，则将 360*640 的字体大小设置为 20。

没有其他解决方案可以解决此问题。

# html - 在 z 轴上有 3 个级别的 div 是不是很糟糕

> ID：11472162
> 
> 赞同：3
> 
> 时间：2012-07-13T14:09:47.187
> 
> 标签：html, css

作为设计的一般规则，在页面内容顶部有多个 div 是否被看不起？我有一个包含记录的表格和一个位于表格顶部的 div，该表格移动到该记录的垂直位置，该记录在单击时包含子记录。div 中的这些子记录本身也有一个级别的子记录，我希望将另一个 div 放在第一个显示有关它们的信息的顶部。会不会太荒谬了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T14:12:38.407

这完全取决于您，这取决于您的要求。只要设计适合您并且您对它的运作方式感到满意。没有具体的理由不鼓励这样做，除非它确实使 UI 变得混乱。

# java - 为 Android 项目选择 ORM（最低 API 级别 7）

> ID：11472166
> 
> 赞同：11
> 
> 时间：2012-07-13T14:10:01.650
> 
> 标签：java, android, database, sqlite, orm

我目前有一个应用程序，它的主要性能问题是使用由 JSON 响应组成的基于文件的数据库。

我想重写我的应用程序以使用 SQLite 数据库功能。
由于我很懒，我想使用某种 ORM。

到目前为止，我只找到了两个大的 ORM 库：

*   [ORMLite](http://ormlite.com/sqlite_java_android_orm.shtml)
*   [GreenDAO ORM](http://greendao-orm.com/)
*   [DB4O](http://java.dzone.com/articles/using-db4o-android-application)
*   [ActiveAndroid](http://www.activeandroid.com/)

我的主要目标是尽可能**提高处理数据的性能**

但我发现这些库有两个可能的问题。

*   ORMLite 使用**注解**，由于[这个错误](https://code.google.com/p/android/issues/detail?id=7811)，这是 pre-honeycomb 中的大**性能问题**

*   GreenDAO 正在使用某种代码生成器，这会减慢我的开发速度，因为我必须编写生成器，然后使用生成的代码。而且我不太喜欢这个主意。

*   DB4O 是 JPA，我一直认为它在内存使用上速度慢且重，因此不适合低端设备（记住 Android API v7）

* * *

**ad @ChenKinnrot**：
估计的负载应该足以考虑使用 ORM。
在我的情况下，它**大约有 25-30 个唯一表，并且至少有 10 个表连接（一次 2-4 个表）。大约 300-500 个唯一字段（列）**

* * *

所以我的问题是：

1.  **我应该在 Android 应用程序中使用 ORM/JPA 层吗？**
2.  **如果是这样，您会推荐我使用哪个库？**（也请添加一些论点）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T14:37:32.877

我使用过 ORMLite，一旦你掌握了它的窍门（几个小时），我发现它很简单，非常强大并且不会导致任何性能问题（在 Gingerbread 中测试过 HTC 欲望和 HTC Hero 的应用程序）。

我将在需要使用数据库的任何项目中再次使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T14:35:05.700

ORM 层很有吸引力。

然而，在实践中，我要么**自己**编写简单的 ORM，要么使用与 ORM 配合不佳的[Content Provider范式。](http://developer.android.com/reference/android/content/ContentProvider.html)

我已经查看了一些现有的 ORM 库（主要是 ORMLite 、[activeAnroid](https://www.activeandroid.com/)），但它们都把我吓跑了，因为它们似乎不太容易上手。

> “我们谈论的是 25-30 个唯一表，以及至少 10 个表连接。大约 300-500 个唯一字段（列）”

如果您对如何查询数据有固定且有限的模式，我建议您自己编写 ORM/sql。

我的 2 美分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-25T15:48:29.307

如果您担心应用程序的性能，我建议您使用 greenDAO。它将使您免于编写大量无聊的代码，因此代码生成应该不是问题。作为回报，它还会为您生成实体和数据库单元测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T14:25:43.947

我有一些知识要分享：ORM 的定义比编写自己的 sql 慢，假设是为了简化数据访问的编码，并提供一个通用的解决方案，generic = 运行速度比你编写查询慢，如果你很了解 sql .

真正的问题是你想要获得多好的性能，如果它是最好的，不要考虑任何数据映射框架，只有 sql 生成框架可以帮助你更快地编写东西，但让你完全控制一切。

如果您不想充分利用 sql db，请使用 orm，我对您提到的这种 orm 没有经验，所以我不能说选择什么。

而且你的数据库不是那么大和复杂，所以你用 orm 节省的时间不是问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-28T14:22:36.087

根据我的经验，使用 ORM 引擎给我带来了很多好处。但是，在某些情况下，我不得不处理性能问题。

我必须从数据库中加载大约 10 000 行，并且使用标准实现（我使用的是 ORMLite），大约需要 1 分钟才能完成（取决于设备 CPU）。

当您需要从数据库中读取大量数据时，您可以执行纯 SQL 并自己解析结果（在我的情况下，我只需要从表中查询 3 列）。ORMLite 还允许您检索原始结果。至此，性能提升了 10 倍。所有 10 000 行都在 5 秒或更短的时间内加载完毕！

# dojo - dijit.menu CSS 选择器

> ID：11472168
> 
> 赞同：0
> 
> 时间：2012-07-13T14:10:05.207
> 
> 标签：dojo

有人知道 dijit.MenuItem 标签的自定义 CSS 选择器吗？

这是添加 dijit.MenuItem 的 js：

```
dojo.forEach(basemapGallery.basemaps, function(basemap) {
        //Add a menu item for each basemap
        dijit.byId("bingMenu").addChild(new dijit.MenuItem({
            label: basemap.title,
            iconClass: basemap.title,
            onClick: function(){basemapGallery.select(basemap.id)}
        }));
}); 
```

这是静态html：

```
<td align="center" style="width: 50px;" valign="middle">
        <button id="dropdownButton" iconClass="btnImgBaseMap" title="Switch Basemap" dojoType="dijit.form.DropDownButton">                    
            <div dojoType="dijit.Menu" id="bingMenu">
                <!--The menu items are dynamically created using the basemap gallery layers-->
            </div>
        </button>
</td> 
```

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:20:59.993

向菜单添加自定义 css 类

```
var w = dijit.byId("bingMenu");
dojo.addClass(w.domNode, "myMenu"); 
```

并使用以下CSS

```
.dijitMenu.myMenu .dijitMenuItem .dijitMenuItemLabel {
  color: white;   
} 
```

这是一个例子：

[http://jsfiddle.net/cswing/GCBnF/](http://jsfiddle.net/cswing/GCBnF/)

如果您需要每个菜单项唯一的 css，则将自定义类添加到菜单项

```
var bingMenu = dijit.byId(...);
var w = new dijit.MenuItem({
        label: basemap.title,
        iconClass: basemap.title,
        onClick: function(){basemapGallery.select(basemap.id)}
    });
dojo.addClass(w.domNode, "bing");
bingMenu.addChild(w); 
```

并使用以下CSS

```
.dijitMenu.myMenu .dijitMenuItem.bing .dijitMenuItemLabel {
   color: white;   
} 
```

# c# - 如何通过 EXE 名称在 ms windows 注册表中找到应用程序安装路径

> ID：11472172
> 
> 赞同：0
> 
> 时间：2012-07-13T14:10:52.547
> 
> 标签：c#, .net

有没有明确的代码可以通过EXE名称找到应用程序安装路径？

我发现[了这一点](https://stackoverflow.com/questions/7231903/find-the-path-of-my-application-installed-in-registry)，但它完全有用。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T17:23:37.633

如果您知道要读取的值的注册表路径，则可以执行以下操作：

```
var key = Registry.LocalMachine.OpenSupKey("SOFTWARE\MyCompany\Data");
var value = key.GetValue("Location"); 
```

注册表访问代码位于 mscorelib.dll 中的 Microsoft.Win32 命名空间中。

每个注册表配置单元都有注册表属性，对于注册表项路径，您不需要包含注册表配置单元部分。

有关[Registry 类](http://msdn.microsoft.com/query/dev10.query?appId=Dev10IDEF1&l=EN-US&k=k%28MICROSOFT.WIN32.REGISTRY%29;k%28SOLUTIONITEMSPROJECT%29;k%28SOLUTIONITEMSPROJECT%29;k%28TargetFrameworkMoniker-%22.NETFRAMEWORK%2cVERSION%3dV4.0%22%29;k%28DevLang-CSHARP%29&rd=true)和[RegistryKey 类的更多信息](http://msdn.microsoft.com/query/dev10.query?appId=Dev10IDEF1&l=EN-US&k=k%28MICROSOFT.WIN32.REGISTRYKEY%29;k%28SOLUTIONITEMSPROJECT%29;k%28SOLUTIONITEMSPROJECT%29;k%28TargetFrameworkMoniker-%22.NETFRAMEWORK%2cVERSION%3dV4.0%22%29;k%28DevLang-CSHARP%29&rd=true)

# objective-c - 制作 UIBezierPath 的独立副本？

> ID：11472174
> 
> 赞同：9
> 
> 时间：2012-07-13T14:10:58.360
> 
> 标签：objective-c, cocoa, drawing, copy, uibezierpath

我有一个复杂的 UIBezierCurve ，我需要使用一些特定的线参数绘制一次，然后将其再次绘制为与其他线参数的叠加，但我还需要曲线的最后一部分比前一个略短。

为此，我想创建曲线`addLineToPoint:`，`moveToPoint:`直到最后一部分，然后复制该曲线并在原始曲线和复制曲线中以不同方式添加线的最终段。然后我抚摸原始曲线和复制的曲线。

问题是它不像我预期的那样工作。我通过以下方式创建曲线的副本：

```
UIBezierPath* copyCurve = [originalCurve copy]; 
```

之后我在 originalCurve 中所做的绘图也应用于 copyCurve，因此我无法为任何这些曲线进行独立绘图。

原件和副本之间存在这种联系的原因是什么，我该如何摆脱它？

编辑1：我发现的一个解决方案是通过以下方式创建副本：

```
UIBezierPath* copyCurve=[UIBezierPath bezierPathWithCGPath:CGPathCreateMutableCopy(originalCurve.CGPath)]; 
```

由于这工作正常，也许问题在于我得到的副本的不变性

```
[originalCurve copy] 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-07-13T14:37:35.637

使用 CGPath 创建一个新的相同路径。

```
path2 = [UIBezierPath bezierPathWithCGPath:path1.CGPath]; 
```

CGPath 属性文档指出：

> 此属性包含任何给定时间点的路径快照。获取此属性会返回一个不可变的路径对象，您可以将其传递给 Core Graphics 函数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-02-15T23:13:43.637

`copy()`从 Swift 4 开始对我来说效果很好。

```
let copiedPath = originalPath.copy() as! UIBezierPath
copiedPath.addLine(...) 
```

`originalPath`不会被修改。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-12-12T10:53:18.693

除了@jrturton 答案：-

**或者**，我们可以使用：-

```
 let  path = UIBezierPath(ovalIn: pathRect)
 let newPath = path.cgPath.copy(strokingWithWidth: strokeWidth, lineCap: .butt, lineJoin: .miter, miterLimit: 0) 
```

[![在此处输入图像描述](../Images/45e6073b2617af1f7971f083f7fdda77.png)](https://i.stack.imgur.com/rgIOL.png)

[参考](https://developer.apple.com/reference/coregraphics/cgpath/2427133-copy)

# ios - 这会导致被遗弃的记忆吗？

> ID：11472176
> 
> 赞同：0
> 
> 时间：2012-07-13T14:11:01.743
> 
> 标签：ios, ios5, memory-management, abandoned-memory

我正在查看内存中的堆镜头。这个功能似乎是遗弃记忆的罪魁祸首。

这是我的一个视图“MyView”的视图构建代码的一部分。

如果我使用此函数创建和销毁 'MyView' 100 次，则注释内存大小总是返回到它的基线。但是，如果我将此功能留在我的记忆中，则会不断增加。

据我所知，我不拥有函数中的任何内容。我究竟做错了什么？

```
-(void)drawPointAroundCircle:(CGPoint)centerpoint radius:(int)radius amount:(int)amount
{

    CGPoint pointarray[amount];
    float thetaarray[7]={270.0,315.0,0.0,45.0,135,180.0,225.0};
    int i=-1;
    UIGraphicsBeginImageContext(CGSizeMake(self.frame.size.width,self.frame.size.height));

    CGContextRef context=UIGraphicsGetCurrentContext();
    for (i=0; i<7; i++) {

        float x=cosf(D2R( thetaarray[i]))*radius;
        float y =sinf( D2R(thetaarray[i]))*radius;
        x=x+centerpoint.x;
        y=y+centerpoint.y;

        pointarray[i].x=x;
        pointarray[i].y=y;

        UIBezierPath *path=[UIBezierPath bezierPathWithArcCenter:CGPointMake(x, y) radius:2 startAngle:D2R(0) endAngle:D2R(360) clockwise:YES];

        CGContextSetFillColorWithColor(context, [UIColor grayColor].CGColor);      

        [path fill];
        [path closePath];
        }

    UIImage *bezierimage=UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    UIImageView *bezierImageView=[[UIImageView alloc]initWithImage:bezierimage];

    [self addSubview:bezierImageView];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:27:17.730

bezierImageview 应该在添加到子视图之前自动释放，或者在添加到子视图后释放。使用您当前的代码，该对象的保留计数永远不会低于 1。

这是假设非 ARC，但如果您使用 ARC，它就不会泄漏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:29:43.367

You are, in fact, "taking ownership" of something with this line:

```
UIImageView *bezierImageView=[[UIImageView alloc]initWithImage:bezierimage]; 
```

If you're not using Automatic Reference Counting (ARC), you should autorelease bezierImageView before the end of the method.

# c# - Funq 中使用的 Container 实例

> ID：11472179
> 
> 赞同：0
> 
> 时间：2012-07-13T14:11:12.790
> 
> 标签：c#, .net, lambda, funq

我正在观看 Funq 的截屏视频，但我不明白测试代码中包含以下 lambda 的内容：

```
var container = new Container();
container.Register<IBar>(c => new Bar()); 
```

声明：

```
public void Register<TService>(Func<Container, TService> factory) { ... } 
```

在 lambda 中，**new Bar()**充当**TService**，而**c**充当Register 方法中使用的 Func的**容器。**

在执行期间，这个 c 什么时候被删除？是不是一开始就创建的**容器**，因为我不明白一个Container的实例是什么时候传递给**Register**方法的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T14:26:42.827

> 在执行过程中，这个 c 是什么时候声明的？

你做到了，使用以下行：

```
var container = new Container(); 
```

Funq 实际上将一个实例传递给它自己给提供的委托。例如，这允许您执行以下操作：

```
container.Register<IBar>(c => 
{
    var bar = c.Resolve<Bar>();
    bar.SomeProperty = 5;
    return bar;
}); 
```

但是，将容器本身传递给委托它在 IMO 中毫无用处，因为该值在注册期间始终可用。例如，你也可以这样写：

```
container.Register<IBar>(unused => 
{
    var bar = container.Resolve<Bar>();
    bar.SomeProperty = 5;
    return bar;
}); 
```

换句话说，如果该`Register`方法接受 a`Func<T>`而不是 a会容易得多`Func<Container, T>`。前面的代码片段看起来像这样：

```
container.Register<IBar>(() => 
{
    var bar = container.Resolve<Bar>();
    bar.SomeProperty = 5;
    return bar;
}); 
```

# c# - 将可为空的数字转换为字符串

> ID：11472183
> 
> 赞同：6
> 
> 时间：2012-07-13T14:11:16.353
> 
> 标签：c#, type-conversion

我想将一个可为空的数字转换为一个**保持**空值的字符串。这就是我正在做的事情：

```
int? i = null;
string s = i == null ? null : i.ToString(); 
```

有没有更短的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-13T14:16:17.907

您可以编写一些扩展方法：

```
public static string ToNullString(this int? i)
{
   return i.HasValue ? i.ToString() : null;
} 
```

用法会更简单：

```
string s = i.ToNullString(); 
```

或通用版本：

```
public static string ToNullString<T>(this Nullable<T> value)
    where T : struct
{
    if (value == null)
        return null;

    return value.ToString();
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-13T14:18:37.570

您可以为此创建一个扩展方法：

```
public static string ToStringOrNull<T>(this Nullable<T> nullable) 
where T : struct {
  return nullable.HasValue ? nullable.ToString() : null;
} 
```

用法：

```
var s = i.ToStringOrNull(); 
```

**更新**

从 C# 6 开始，您可以使用更方便[的空条件运算符](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/operators/null-conditional-operators)：

```
var s = i?.ToString(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-12-15T15:14:45.950

我认为

```
string s = i?.ToString(); 
```

更短。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-10-25T12:03:35.690

我们也可以使用 System.Convert 即

```
int? i = null;
string s = Convert.ToString(i); // it gives null if i is null. 
```

正如已经提到的，我们也可以使用空条件运算符

```
string s = i?.ToString(); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-12-15T15:07:57.530

我需要十进制类型的 formatProvider 参数，因此删除了通用版本以专门用于十进制扩展，如下所示：

```
public static string ToStringOrNull(this Nullable<decimal> nullable, string format = null)        
{
    string resTmp = "";
    if (nullable.HasValue)
    {
        if (format != null)
        {
            resTmp = nullable.Value.ToString(format);
        }
        else
        {
            resTmp = nullable.ToString();
        }
    }
    else
    {
        resTmp = "";
    }
    return resTmp;
} 
```

# java - Java 类不会编译

> ID：11472184
> 
> 赞同：0
> 
> 时间：2012-07-13T14:11:18.203
> 
> 标签：java, httpconnection

我遇到了一些我似乎无法修复的错误......这是示例代码，所以我很困惑发生了什么。错误被注释到它们出现的行的一侧。

```
import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.net.URL;
import java.net.URLConnection;
import java.net.URLEncoder;

public class Connect {
    URL url;
    URLConnection urlConnection;
    DataOutputStream outStream;
    DataInputStream inStream;

    // Build request body
    String body = "fname=" + URLEncoder.encode("Atli", "UTF-8"); //Syntax error on token ";", { expected after this token

    // Create connection
    url = new URL("http://192.168.1.68/test/POST/post.php");
    urlConnection = url.openConnection();
    ((HttpURLConnection)urlConnection).setRequestMethod("POST");
    urlConnection.setDoInput(true);
    urlConnection.setDoOutput(true);
    urlConnection.setUseCaches(false);
    urlConnection.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");
    urlConnection.setRequestProperty("Content-Length", ""+ body.length());

    // Create I/O streams
    outStream = new DataOutputStream(urlConnection.getOutputStream());
    inStream = new DataInputStream(urlConnection.getInputStream());

    // Send request
    outStream.writeBytes(body);
    outStream.flush();
    outStream.close();

    // Get Response
    // - For debugging purposes only!
    String buffer;
    while((buffer = inStream.readLine()) != null) {
        System.out.println(buffer);
    }

    // Close I/O streams
    inStream.close();
    outStream.close();

} 
```

给出错误：

```
Syntax error, insert "}" to complete ClassBody 
```

有人看到我没有看到的明显的东西吗？

附带说明一下，如果 php 在运行此类时回显 html 代码，java 是否能够理解 html 代码？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-13T14:13:00.877

您不能将代码直接放在类主体中 - 您必须将其包装在成员函数中。

如果这是一个独立的程序，那么成员函数应该是：

```
public static void main(String[] args) {
    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:23:26.653

如果您希望在构造“Connect”实例时执行该代码，则应将其放在构造函数中。这也修复了您的所有错误。

```
import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.io.IOException;
import java.net.HttpURLConnection;
import java.net.URL;
import java.net.URLConnection;
import java.net.URLEncoder;

public class Connect {

    URL url;
    URLConnection urlConnection;
    DataOutputStream outStream;
    DataInputStream inStream;

    @SuppressWarnings("deprecation")
    public Connect() {
        // Build request body
        try {
            String body = "fname=" + URLEncoder.encode("Atli", "UTF-8");

            // Create connection
            url = new URL("http://192.168.1.68/test/POST/post.php");
            urlConnection = url.openConnection();
            ((HttpURLConnection) urlConnection).setRequestMethod("POST");

            urlConnection.setDoInput(true);
            urlConnection.setDoOutput(true);
            urlConnection.setUseCaches(false);
            urlConnection.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");
            urlConnection.setRequestProperty("Content-Length", "" + body.length());

            // Create I/O streams
            outStream = new DataOutputStream(urlConnection.getOutputStream());
            inStream = new DataInputStream(urlConnection.getInputStream());

            // Send request
            outStream.writeBytes(body);
            outStream.flush();
            outStream.close();

            // Get Response
            // - For debugging purposes only!
            String buffer;

            // DataInputStream.readLine is deprecated
            // use the BufferedReader class instead
            while ((buffer = inStream.readLine()) != null) {
                System.out.println(buffer);
            }

            // Close I/O streams
            inStream.close();
            outStream.close();
        } catch (IOException iOException) {
            // there are many methods that can throw errors in this code,
            // you should catch those errors
        }
    }
} 
```

# jquery - jquery 为多元素语法设置 css

> ID：11472187
> 
> 赞同：0
> 
> 时间：2012-07-13T14:11:41.493
> 
> 标签：jquery, css, syntax

我正在开发一个 Jquery 插件，并且必须在脚本内设置许多 css 值以使其灵活。

它看起来像这样：

```
...var loadingBarInsideFWidth = loadingBarWidth - 4;
var loadingBarInsideWidth;
$(holder).find('.round').css({
'width':setRoundWidth,
'height':setRoundWidth
});
$(holder).find('.pointer').css({
'width':setPointerWidth,
'height':setPointerWidth,
'left':rotCenter,
'top':rotCenter*2
});... 
```

以此类推，大约有 70 行代码。只是想问一下这样可以吗，还是有更好的方法？

谢谢

ps确保有一个外部css文件，所有这些值都是关于预加载器和一些导航元素的位置和大小相对于包含元素大小的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:14:29.980

您可以从 css 文件中添加所有这些样式...并将插件包含在 css 文件中...这样，您的插件也可以自定义其他人的外观和感觉，他们不会使用您的 javascript/jquery代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T14:17:24.703

我更喜欢将 CSS 和 JS 分开：将所有样式放入一个文件并按需动态加载。

如果这不是你想要的，你可以写：

```
(function(){
   // do some caching
   $holder = $(holder);

   function _css(elem,rules){
      $holder.find(elem).css(rules);
   }

    _css(".round",{'width':setRoundWidth, 'height':setRoundWidth});
})(); 
```

或者，为了进一步区分 - 将样式放入对象中并对其进行迭代。这使它更像“CSS”。

```
(function(){
   // do some caching
   $holder = $(holder);
   styles = {
       ".round":  { 'width' :setRoundWidth,
                    'height':setRoundWidth
                  },
       ".pointer":{ 'width' :setPointerWidth,
                    'height':setPointerWidth,
                    'left'  :rotCenter,
                    'top'   :rotCenter*2
                  }
   }
   for (var elem in styles){
      if (styles.hasOwnProperty(elem)) $holder.find(elem).css(styles[elem]);
   }
})(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T14:18:00.420

如果您将其应用于 DOM 内元素，则从 JS 添加 70 种 CSS 样式将导致大量重排/重绘。

如果您不想随插件提供专用的 CSS 表格，请考虑将样式直接写入动态 CSS 表格元素。

您可以通过 DOM 编写`<style>`标签并将样式放入其中，或劫持页面内链接样式表之一来实现此目的。请参阅[http://www.javascriptkit.com/domref/stylesheet.shtml](http://www.javascriptkit.com/domref/stylesheet.shtml)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T14:18:08.470

将您的 css 样式放入样式表中的类中。

然后在需要时将该类添加到您的元素中。

```
jQuery(".myElement").addClass("myClass"); 
```

# asp.net-mvc - 具有动态源的 MVC 3 WebGrid

> ID：11472188
> 
> 赞同：0
> 
> 时间：2012-07-13T14:11:42.447
> 
> 标签：asp.net-mvc, asp.net-mvc-3, webgrid, expandoobject

我有一个动态数据列表，其中包含由 PIVOT 函数创建的动态列数。一切或多或少都有效，但我想对某些列应用一些自定义格式。我想出了如何通过只取第一行并将其转换为这样来获取列列表：

```
var columns = Model.Comparisons.Select(x => x).FirstOrDefault() as IDictionary<string, object>; 
```

接下来，我决定通过循环“列”来创建我的列表，只要我直接通过动态字段名称引用“格式：”子句中的动态字段，它就可以工作，例如：

```
foreach (var c in columns)
{
    switch (c.Key)
    {
        case "Cost":
            cols.Add(grid.Column(
            columnName: c.Key,
            header: c.Key,
            format: (item) => Convert.ToDecimal(item.Cost).ToString("C")));
            break;
        default:
            cols.Add(grid.Column(columnName: c.Key, header: c.Key, format: item => item[c.Key]));
            break;
    }
} 
```

“默认”不会动态获取每条记录的值。我相信这与“item [c.Key]”与 item.Cost 有关。问题是我不想为每个字段编写不同的大小写，主要是因为我不提前知道它们，因为数据可能会发生变化。大约有 6 个字段将始终存在。但是我确实知道数据类型，这就是为什么我想在它们上放置自定义格式。

**编辑**

我设法通过编写扩展方法来解决这个问题。

```
public static class DynamicDataHelper
{
    public static WebGridColumn GetColumn(this HtmlHelper helper, string vendor)
    {
        return new WebGridColumn()
        {
            ColumnName = vendor,
            Header = vendor,
            Format = (item) => helper.ActionLink(
                (string)Convert.ToDecimal(item[vendor]).ToString("C"),
                "VendorSearch",
                "Compare",
                new { Vendor = vendor, mpn = item.MPN },
                new { target = "_blank" })
        };
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T21:32:04.477

我使用我编写的 Html Helper 编辑了我的帖子，它实际上将构建我遇到问题的自定义 WebGridColumn 对象。“供应商”从视图传入，然后在运行时解析。它工作得很好。

# iphone - 如何使 UIImagePickerController 相机不占用整个屏幕？

> ID：11472194
> 
> 赞同：0
> 
> 时间：2012-07-13T14:11:54.380
> 
> 标签：iphone, objective-c, sdk, uiimagepickercontroller, zbar-sdk

我有一个标签栏控制器。我希望始终在其中一个选项卡上打开相机，但在相机下方，您仍然可以看到其余选项卡。如何使相机不占用整个屏幕，而是位于标签栏上方？

（顺便说一下，我实际上并没有使用 UIIMagePickerController，而是 ZBarReader）谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T17:25:33.857

评论是对的：您是否尝试将其作为子视图添加到本身小于屏幕的超级视图中？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:15:53.273

据我所知，你不能。您应该使用`AVCaptureSession`- 查看[Erica Sadun iOS 5 Cookbook - Chapter 7](https://github.com/erica/iOS-5-Cookbook/tree/master/C07/05-Camera%20Helper)，它应该很容易。

# javascript - Jquery Javascript 属性未定义

> ID：11472196
> 
> 赞同：-1
> 
> 时间：2012-07-13T14:11:55.877
> 
> 标签：javascript

```
function dadosFormularios() {
    var dadosFormulario = {};
    var iterador = countForms;
    var i = 0;
    while (i < iterador) {
        dadosFormulario[i] = {};
        dadosFormulario[i]['a'] = $('#field\\[' + i + '\\]\\[a\\]').val();
        dadosFormulario[i]['b'] = $('#field\\[' + i + '\\]\\[b\\]').val();
        //alert(dadosFormulario[i]['a']);
        //alert(dadosFormulario[i]['b']);   
        i++;
    }
    var qstring = '';
    var tmp_qstring = [];
    var temp1, temp2;
    var aux_i = i + 1;
    alert(aux_i);
    for (var j = 0; j < aux_i; j++) {
        temp1 = dadosFormulario[j]['a'];
        alert(temp1);
        temp2 = dadosFormulario[j]['b'];
        //alert(temp1);
        tmp_qstring[j] = 'a' + j + '=' + temp1 + '&' + 'b' + j + '=' + temp2;
    }
    qstring = tmp_qstring.join('&');
    alert(qstring);
    window.location = 'dup1.php?' + qstring;
} 
```

当我点击一个按钮时，我调用了上面的函数，现在我正试图将对象数组的数据发送到另一个页面，正如您在代码中看到的那样。

我的问题是，当我设置`dadosFormulario[j]['a'];`或`dadosFormulario[j]['b'];`设置为 var 或直接在`tmp_qstring`ie中设置它们时，我遇到了麻烦`tmp_qstring[j]=dadosFormulario[j]['b'];`。在 chrome 控制台中，我收到错误：

> 未捕获的类型错误：无法读取未定义的属性“a”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T14:13:51.087

修复您的循环以使用：

```
j < i 
```

因为您的数组和迭代器变量`j`都是从零开始的。`i`当您的迭代器达到数组长度 - 1 （在您的情况下是长度）时，您必须停止迭代。这通常是`for`数组长度上的循环的情况。

如果您迭代直到`j <= i`您的迭代索引将超出数组的末端边界。

# jquery-ui - struts2 jquery插件将html包装到返回的id

> ID：11472198
> 
> 赞同：2
> 
> 时间：2012-07-13T14:11:56.830
> 
> 标签：jquery-ui, jquery, jquery-plugins, struts2

我在我的项目中使用 struts2-jquery 插件。我正在尝试使用`<sj:submit>`这样的标签提交表单：

```
<sj:submit id="caseSubmit"
           targets="result"
           formIds="mainForm"
           onCompleteTopics="caseSubmitted"
           button="true"/> 
```

此操作的 struts.xml 映射如下：

```
 <action name="submitAddCase" class="com.xxx.action.AddCaseAction">
    <result type="json">
           <param name="root">caseId</param>
    </result>
  </action> 
```

onComPleteTopics 代码

```
$.subscribe('caseSubmitted', function(event,data) {
    var indexPre = event.originalEvent.request.responseText.indexOf("<pre>")+5;
    var indexPreEnd = event.originalEvent.request.responseText.indexOf("</pre>");
    var id = event.originalEvent.request.responseText.substring(indexPre,indexPreEnd);
    $("#case_id").val(id);
}); 
```

我想要的是使用`caseId`返回的内容在同一页面上加载一些其他内容。但是， `event.originalEvent.request.responseText`返回`caseId`包裹在这样的 pre 标签中

```
<pre>154000</pre> 
```

这就是它在 Firefox 中的返回方式。在 chrome 中，它以另一种形式返回。如何在没有包装 html 的情况下获得 caseId 的原始值。现在我正在使用javascript的子字符串方法来获取它在chrome中不起作用的值，因为返回的格式不同

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T15:34:19.387

代替

```
$("#case_id").val(id); 
```

和

```
$("#case_id").val($(id).html()); 
```

# saas - SaaS 网站的定期付款

> ID：11472200
> 
> 赞同：0
> 
> 时间：2012-07-13T14:12:11.837
> 
> 标签：saas, recurring-billing

我正在进行一项开发，我最终希望将其作为 SaaS 网站交付。我目前在这种平台上没有经验，我正在寻找一些事情的指导，即：

1.  我应该看哪些供应商？
2.  我应该使用 API 还是将客户交给服务提供商？
3.  每月订阅..
4.  ..老实说，我从哪里开始？

我知道 PayPal 提供各种付款方式，并且我有使用 IPN 进行一次性付款的经验，但我想知道是否有更好的选择。

..对于一个基本上可以处理所有事情并且只在有人不付款/被拒绝时才通知我的提供商是否过于希望，就像 PayPal IPN 通知付款一样？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-24T04:04:29.097

Ruby gem ActiveMerchant 支持许多支付网关。如果不出意外，它至少可以作为一个选项列表来检查。[http://activemerchant.org/](http://activemerchant.org/)特别是这些文件的名称，[https://github.com/Shopify/active_merchant/tree/master/lib/active_merchant/billing/gateways](https://github.com/Shopify/active_merchant/tree/master/lib/active_merchant/billing/gateways)

请记住，您不想***存储信用卡信息***一旦这样做，财务合规认证就会对您造成伤害。许多支付网关会给你一个可以收费的“令牌”。

基本上，流程的工作方式如下：

*   客户通过 SSL（通常是 HTTPS）提供 CC 信息
*   您将该信息转发到您的网关，从不将其存储在磁盘上
*   他们给你一个“令牌”来为那张卡充电，你存储令牌。

已经建议使用 Stripe 和 Braintree。其他选项可能是 Square 和 Authorize.net

根据我的经验，支付网关通常不进行定期计费。基本上，您必须编写代码来提交费用。这会导致诸如“一个月有多长？”之类的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T20:42:32.620

另一种选择是[Braintree](https://www.braintreepayments.com/)，一家支持“非美国用户”的公司。我们现在面向位于欧洲和加拿大的各种规模的商家提供服务，您可以在全球 130 个国家/地区接受付款。我们提供您接受在线或移动支付所需的一切，包括支付网关、商家帐户和定期计费。披露：我在布伦特里工作

# android - 在 Android 中发出 HTTP 请求时显示加载对话框

> ID：11472204
> 
> 赞同：1
> 
> 时间：2012-07-13T14:12:17.750
> 
> 标签：android

为了学习 Android，我正在编写一个小应用程序。我要做的第一件事是通过远程 API 登录。

我想在拨打电话时显示一个“加载”对话框（以防他用户使用移动互联网）。对此的研究表明了两种可能的方法。

一种是使用**ProgressDialog**和扩展**Thread**的私有类，另一种是使用扩展**AsyncTask**的私有类。

哪个最适合/更适合这项任务？

我曾尝试使用 ProgressDialog 版本，但正在苦苦挣扎。我已将发出 http 请求的函数放在扩展的 Thread run() 方法中，但不确定如何将响应数据 (JSON) 传递回我的活动中。

任何和所有的帮助都感激不尽。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:20:07.557

最好的方法是使用 a`AsyncTask`和 a `ProgressDialog`。您应该扩展`AsyncTask`并实现您需要的所有方法：

*   `onPreExecute()`- 在这里你初始化你的`ProgressDialog`和`show()`它
*   `doInBackground()`- 在这里你做你的工作
*   `onPostExecute()``dismiss()`-在这里你调用`ProgressDialog`隐藏它
*   （可选）`onProgressUpdate()`- 在这里你可以改变你的进度，`ProgressDialog`如果它是确定的

类中有一个`get()`方法`AsyncTask`可以让您检索工作的结果。`AsyncTask`您也可以在和调用之间实现接口`Activity`以返回结果。希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:30:17.500

努力有回报 :) Egor 是对的，AsyncTask 是最好的方法。但是您必须知道 Activity 正在 UI 线程上工作，而线程不在。因此，共享事物的唯一方法是通过处理程序。这里有一个例子：

```
@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);         
    setContentView(R.layout.main);      
    progress = (ProgressBar) findViewById(R.id.progressBar1);       
    handler= new Handler();     
}

public void startProgress(View view) {
    // Do something long
    Runnable runnable = new Runnable() {
        @Override
        public void run() {
            for (int i = 0; i <= 10; i++) {
                final int value = i;
                try {
                    Thread.sleep(2000);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                handler.post(new Runnable() {
                    @Override
                    public void run() {
                        progress.setProgress(value);
                    }
                });
            }
        }
    };
    new Thread(runnable).start();
} 
```

# wpf - Windows 窗体的“StartPosition”属性的 WPF 等效项是什么？

> ID：11472205
> 
> 赞同：1
> 
> 时间：2012-07-13T14:12:23.363
> 
> 标签：wpf

在 Windows 窗体上，您具有`StartPosition`允许您指定窗体在启动时放置在屏幕上的位置的属性。

WPF 是否有等价物，如果有，它是什么？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T14:16:28.283

我想你正在寻找[`WindowsStartupLocation`](http://msdn.microsoft.com/en-us/library/system.windows.window.windowstartuplocation.aspx)：

> 将 WindowStartupLocation 设置为 Manual 会导致根据其 Left 和 Top 属性值定位窗口。如果未指定 Left 或 Top 属性，则它们的值由 Windows 确定。

```
<Window x:Class="WpfAppl.Window1" 
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    Title="WindowName" 
    Height="500" Width="500"
    WindowStartupLocation="Manual" 
    Left="0" Top="0">
</Window> 
```

# wmi - wmi 事件活动窗口/焦点窗口

> ID：11472216
> 
> 赞同：2
> 
> 时间：2012-07-13T14:12:55.963
> 
> 标签：wmi, wmi-query, wql

试图通过 WMI/WQL MS Reference Data 和 WMI Code Creator Event Classes 搜索，但找不到任何指示：

A）如果这是可能的 B）怎么做

理想情况下，我希望能够订阅具有最终用户更改 (UI) 窗口（任何 Windows 应用程序）性质的 WMI 事件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T18:40:50.013

您使用了错误的工具，没有与 Windows 应用程序的 UI 相关的 WMI 类或 WMI 事件。相反，您必须使用 Windows 消息和 WinAPI。

# java - 如何在Java中将excel文件转换为xml文件？

> ID：11472224
> 
> 赞同：-2
> 
> 时间：2012-07-13T14:13:19.350
> 
> 标签：java

> **可能重复：**
> [如何使用 java 将 Excel 转换为 XML？](https://stackoverflow.com/questions/1900647/how-to-convert-excel-to-xml-using-java)

我有一个文件，它是一个 .xls 文件的 excel 工作簿，它有大约 12 列和 1000 行，我想将该文件转换为 xml 文件，以便列标题将成为所有行的标签？

我想用Java编写这段代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:15:28.010

查看[用于 Microsoft 文档的 Java API](http://poi.apache.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:15:23.427

看看 jexcel api：[http ://www.andykhan.com/jexcelapi/](http://www.andykhan.com/jexcelapi/)

> 阅读电子表格时，可以“按原样”使用演示程序以合理的方式将 Excel 文件转换为 CSV 和 XML 格式。
> 
> java -jar jxl.jar -csv myspreadsheet.xls

# java - 在关闭 OutputStreamWriter 之前尝试杀死程序的后果

> ID：11472225
> 
> 赞同：1
> 
> 时间：2012-07-13T14:13:23.577
> 
> 标签：java, java.util.scanner, outputstream, javaplot

这是较大的图形程序（特别是 JavaPlot）的一部分。简而言之，我会尝试绘制一些图表；该图将出现在

```
out.write(comms); 
```

但是一旦它击中就关闭

```
out.close() 
```

我知道您需要关闭 OutputStreamWriter，因此我没有删除该行，而是创建了一个 Scanner，它一直等到用户按下“Q”，然后程序正常继续，关闭图形、OutputStreamWriter 和 Scanner

```
 OutputStreamWriter out = new OutputStreamWriter(proc.getOutputStream());
        out.write(comms);
        out.flush();

//added from here
        //waiting until input is given
        Scanner timeKiller = new Scanner(System.in);
        String check = timeKiller.nextLine();
        if(check != "q"){
            check = timeKiller.nextLine();  //<---waiting here. 
        }
        timeKiller.close();
//to here

        out.close(); 
```

我在做什么危险吗？如果有人通过关闭窗口来关闭图表，这不会杀死程序，对吗？这不会导致内存泄漏（对吗？），但是如果进程仍在运行并且他们多次运行该程序，它最终将开始成为问题。我怎样才能解决这个问题？就在我的脑海中，也许在窗口关闭时向窗口添加一个监听器，它会中断循环？还是我弄错了，这根本不是问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:42:48.713

如果您在最近一次写入后刷新了流/写入器，那么如果您在没有`close`先调用流的情况下退出应用程序，则不会丢失任何数据。如果您正在退出应用程序，JVM 将终止并且存储泄漏变得无关紧要。

另一方面，如果您在应用程序应该退出时没有导致应用程序退出，并且因此用户产生了多个实例，那么您将遇到大量 JVM 填满用户 PC 内存的问题。如果发生这种情况，与处理孤立的 JVM 相比，假设的泄漏流是微不足道的。

但是从您的问题中确实不清楚您实际上在做什么和/或打算做什么，所以我不能真正评论您的具体情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T14:50:00.703

该窗口有一个 setDefaultCloseOperation，您可以将其设置为 EXIT_ON_CLOSE，这将执行 System.exit(0)。

# python - 如何使用网格布局管理器在框架中的指定位置安排两个按钮？

> ID：11472227
> 
> 赞同：1
> 
> 时间：2012-07-13T14:13:32.337
> 
> 标签：python, grid, tkinter, tk

我已经开始学习 TK（来自 Python）。我觉得我可以使用网格布局管理器来显示小部件（这听起来很容易）但现在我觉得这是一个错误的决定。例如，我只是计划一个框架，里面有多个框架（类似向导的形式）。所以在那个表单的底部我想要两个按钮（下一个，上一个）。现在我想把它们放在底部框架的最右边，但是这样安排似乎很困难。

我尝试为两个按钮创建单独的内部框架，但无法得到我的结果。有人可以告诉我是否可以使用网格布局管理器实现这样的结果

```
from Tkinter import *
tk = Tk()
main_frame = Frame(tk)
main_frame.grid(row=0)
frame3 = Frame(main_frame, bg="orange", width=1000, height=100)
frame3.grid(row=1,column=0,columnspan=2)
frame3a = Frame(frame3)
frame3b = Frame(frame3)
frame3a.grid(row =0 ,column = 0)
frame3b.grid(row = 0, column = 1)
btn1 = Button(frame3a, text='Next', width = 10, command=next)
btn1.grid(padx=200, pady =40 )
btn2 = Button(frame3b, text='Previous', width = 10, command=prev)
btn2.grid(padx=00, pady =40 )
frame3.grid_propagate(False)
tk.mainloop() 
```

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T14:27:45.247

是的你可以。使用来自网格的更多行/列属性以及粘性属性。

阅读：[http ://effbot.org/tkinterbook/grid.htm](http://effbot.org/tkinterbook/grid.htm)

我假设您希望您的窗口看起来像这样（原始 ascii 传入）

```
+------------+------------+
|            |            |
|  FRAME     |    FRAME   |
|------------+------------|
|        FRAME  |PREV|NEXT|
+-------------------------+ 
```

为此，我会使用`pack`而不是`grid`. 我制作了一个底部框架并将其设置为按钮的高度，然后将它们都打包好：如果您想在底部放置其他垃圾，您可以使用网格管理器将框架推开。Pack 仅在包含按钮的框架中处于活动状态，但您可以使用 gridmanager 来移动按钮框架。

```
from Tkinter import * 
tk = Tk() 
main_frame = Frame(tk) 
main_frame.grid(row=0) 
frame1 = Frame(main_frame, bg="orange", width=500, height=100)
frame2 = Frame(main_frame, bg="blue", width=500, height=100)
frame3 = Frame(main_frame, bg="green", width=1000, height=50)
frame1.grid(row=1,column=1)
frame2.grid(row=1,column=2) 
frame3.grid(row=2,column=1,columnspan=2)
frame3.pack_propagate(0) # Keeps bottom frame from resizing
btn1 = Button(frame3, text='Next', width = 10) 
btn1.pack(side='right')  # sticks on side
btn2 = Button(frame3, text='Previous', width = 10) 
btn2.pack(side='right')  # sticks on side
tk.mainloop() 
```

# php - 无法更新数据库中的某些字段

> ID：11472231
> 
> 赞同：0
> 
> 时间：2012-07-13T14:13:39.590
> 
> 标签：php, mysql

我正在创建一个在线游戏，但在更新数据库中的某些字段时遇到问题。这是表单和php代码。

```
<form method='post'>
                <div style="float: left; width: 630px; color: white;">
                    <div style="float: left; width: 400px; background: #555; height: 20px;">
                        <?php
                        if ($row['Protected'] == 1)
                        {
                            ?>
                            <img src="images/pass.png"></img>
                            <input type="password" name="pass" placeholder="Password" style="height: 18px;" />
                            <?php
                        }
                        echo("<input type='submit' name='enter' style='background: #555; text-decoration: underline;' value='$row[Name]' />");
                        ?>
                    </div>
                    <div style="float: right; width: 229px; background: #555; margin-left: 1px; height: 20px;">
                        <?php
                        echo($row['NrPlayers']);
                        echo("/");
                        echo($row['MaxPlayers']);
                        echo(" Players");
                        ?>
                    </div>
                    <div style="clear: both;">
                        <?php
                        echo($row['Descr']);
                        ?>
                    </div>
                    <div style="background: #ccc; font-size: 13px; margin-bottom: 2px; color: black;">
                        <?php
                        echo($row['FName']);
                        echo(" ");
                        echo($row['LName']);
                        ?>
                    </div>
                    <input type="hidden" name="id" value="<?php$row['Id_Room']?>" />
                <input type="hidden" name="protect" value="<?php$row['Protected']?>" />
                <input type="hidden" name="password" value="<?php$row['Pass']?>" />
                <input type="hidden" name="nr" value="<?php$row['NrPlayers']?>" />
                </div>
            </form>
<?php
                if (isset($_POST['enter']))
                {
                    if ($_POST['protect'] == 1)
                    {
                        if ($_POST['pass'] == $_POST['password'])
                        {
                            $nr = $_POST['nr'] + 1;
                            mysql_query("upadte users set Id_Room = '$_POST[id]' where Id_User = '$_SESSION[id]'");
                            mysql_query("update rooms set NrPlayers = '$nr' where Id_Room = '$_POST[id]'");
                            header("Location: game.php");
                        }
                        else
                        {
                            ?>
                            <span style="color: red; text-align: center;">The password you entered is incorrect.</span>
                            <?php
                        }
                    }
                    else
                    if (($_POST['protect'] == 0))
                    {*/
                        $nr = $_POST['nr'] + 1;
                        mysql_query("upadte users set Id_Room = '$_POST[id]' where Id_User = '$_SESSION[id]'");
                        mysql_query("update rooms set NrPlayers = '$nr' where Id_Room = '$_POST[id]'");
                        header("Location: game.php");
                    }
                }
            ?> 
```

有两个更新和一个重定向。因此，更新不起作用，但重定向起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:54:45.727

第1步：

将表单提交到模板，然后从表单范围中转储所有值，以确保您从表单中获得所需的内容。

第2步：

使用一些测试值在 mysql work bench 或 php myAdmin 等查询编辑器中编写您的查询，以便您有工作查询。

第 3 步：

在 php 中编写生成查询的代码，但不要执行它，而是将其转储到屏幕上。这样做直到输出看起来像您在步骤 2 中设计的查询。

第4步：

完成页面并执行查询，注意拼写错误、语法错误和安全漏洞。然后从查询中转储结果。

您需要在当前代码中检查的内容：

```
mysql_query("upadte users set Id_Room = '$_POST[id]' where Id_User = '$_SESSION[id]'"); 
```

错别字 - 'upadte' ，内联替换 - Id_Room = '{$_POST['id']}'。

在发布大量代码并寻求帮助之前，请务必完成彻底的调试步骤。

# mysql - mysql join性能IF多个OR条件

> ID：11472232
> 
> 赞同：0
> 
> 时间：2012-07-13T14:13:42.757
> 
> 标签：mysql, performance, networking, join

我在一个mysql table1中保存一组节点，在另一个（table2）中保存一个边表。节点带有主键，边缘使用这个“外键”

```
**table1**
id label
1  node1
2  node2
3  node3

**table2**
FK_first FK_sec   rel
1        3        guardian
2        1        guardian
1        3        times 
```

我知道 db-design 并不完美，但它很简单......现在我想要每个节点的“rel”数量并执行如下查询：

```
SELECT 
  label, 
  COUNT( rel ) as freq
FROM
  `table1` 
  LEFT JOIN table2 ON (id=FK_first OR id=FK_second) 
GROUP BY label
ORDER BY freq DESC 
```

我有大约 1000 个节点和 2000 条边。使用 ON (id=FK_first ~~OR id=FK_second~~ ) 的查询，则查询速度更快（<1 秒）。另一个查询需要大约 6 秒，这很慢。我将不胜感激一些评论以加快速度:-)

1.  LEFT JOIN table2 ON (id=FK_first OR id=FK_second) ~6 sec
2.  LEFT JOIN table2 ON (id=FK_first) ~0.16 sec
3.  LEFT JOIN table2 ON (id=FK_second) ~0.16 sec

4.  LEFT JOIN table2 ON id IN (FK_first,FK_second) ~6 sec

```
解释1：
        id select_type table type possible_keys key key_len ref rows Extra
        1 SIMPLE table1 ALL NULL NULL NULL NULL 2571 使用临时；使用文件排序
        1 简单表 2 ALL FK_first,FK_second,FK_first_2 NULL NULL NULL 3858    

解释2：
id select_type table type possible_keys key key_len ref rows Extra
1 SIMPLE table1 index NULL PRIMARY 2 NULL 2571 使用索引；使用临时的；使用文件排序
1 简单表 2 参考 FK_first,FK_first_2 FK_first_2 4 table1.id 1

```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T15:00:18.247

尝试进行两次连接并将“OR”移动到 COUNT() 函数中：

对于每一行，这会在 FK1 上连接 table2 一次，然后在 FK2 上再次连接（如果它尚未通过 FK1 连接到该行。然后在 COUNT 中，我们指定只有连接的 rel 列为非空的行。

```
SELECT 
  label, 
  COUNT( table2A.rel || table2B.rel ) as freq
FROM
  `table1` 
  LEFT JOIN 
    table2 as table2A 
    ON id=table2A.FK_first
  LEFT JOIN 
    table2 as table2B 
    ON id=table2B.FK_second 
    AND  table2A.FKFirst != table2B.FKFirst
GROUP BY label
ORDER BY freq DESC 
```

# php - php IPC 脚本简单地退出

> ID：11472233
> 
> 赞同：-1
> 
> 时间：2012-07-13T14:13:43.193
> 
> 标签：php, message-queue, irc

我需要一个简单的 php IRC 机器人，它通过 POST 请求接收消息并将该消息发送到 irc 通道。为此，我改编了来自[PHP-IRC Bot Not sent message Help](https://stackoverflow.com/questions/4227518/php-irc-bot-not-sending-message-help)的机器人。然后我使用消息队列将 POST 消息从[IRC 相关帮助](https://stackoverflow.com/questions/4220905/irc-related-help)发送到机器人。

但是，当我通过 start.html 运行 php 脚本时，机器人甚至没有加入频道。irc.php ->

```
<?php
  $ircServer = "irc.freenode.net";
  $ircPort = "6667";
  $ircChannel = "##my-channel";

set_time_limit(0);

$ircSocket = fsockopen($ircServer, $ircPort, $eN, $eS);
$msg = $_POST['msg'];

if ($ircSocket)
{

fwrite($ircSocket, "USER EDI Normandy-SR2 Alliance Dr-Eva\n");
fwrite($ircSocket, "NICK Hit-Hi-Fit-Hai\n");
fwrite($ircSocket, "JOIN " . $ircChannel . "\n");
fwrite($ircSocket, "PRIVMSG $ircChannel :$msg\n");

 $queueKey = 123321;
 $queue = false;

 // Join the IPC queue
 $queue = msg_get_queue($queueKey);
 if(!$queue) echo "ERROR: Could not join IPC queue. Form data will not be received";

while(1)
{
while($data = fgets($ircSocket, 128))
{
echo nl2br($data);
flush();

$ex = explode(' ', $data);

if($ex[0] == "PING") fputs($socket, "PONG ".$ex[1]."\n");

 if (msg_receive($queue, 0, $msgType, 1024, $msgData, true, MSG_IPC_NOWAIT)) {
 //fwrite($ircSocket, "PRIVMSG $ircChannel :$msgData\n");
 echo "callback working";
 }

}

}
}
?> 
```

我是这样称呼这个脚本的。开始.html ->

```
<html><body>
    <h4>Start Bot</h4>
    <form action="irc.php" method="post">
      Command: <input type="text" name="msg" />
      <input type="submit" />
    </form>
</body></html> 
```

如果我删除消息队列的代码，机器人会加入频道。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T19:10:32.597

根据您的评论，您缺少扩展名。

如果您可以控制机器，则可以安装 php-sysvmsg 扩展。

如果没有，那么您最终可能不得不使用 tcp 或 udp 作为“ipc”或命名管道。

sysvmsg 的软件包名称：

*   RedHat/CentOS: yum install php-process
*   Debian：它已经包含在 php5-cgi 和 php5-cli
*   Zend 服务器/RedHat：yum install php-5.3-sysvmsg-zend-server
*   Zend 服务器/Debian：apt-get install php-5.3-sysvmsg-zend-server

# java - 刚启动 glassfish 服务器时如何自动运行程序？

> ID：11472234
> 
> 赞同：0
> 
> 时间：2012-07-13T14:13:48.497
> 
> 标签：java, glassfish-3

当我在 glassfish 服务器中启动或部署程序时，我希望我的 java web 应用程序自动运行程序。刚部署时，我的 Web 应用程序需要在 glassfish 中运行邮件程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T15:30:32.233

您可以设置一个 servlet 以在应用程序启动时运行，或者可能使用 @Singleton 注释，这取决于您是否希望涉及 EJB。或者，如果您使用的是 Spring，还有更多方法。您可以提供更多背景信息以获得更好的答案。

[servlet <load-on-startup> 值表示什么](https://stackoverflow.com/questions/809775/what-does-the-servlet-load-on-startup-value-of-0-zero-signify)

[http://java.sun.com/developer/technicalArticles/JavaEE/JavaEE6Overview_Part3.html#singles](http://java.sun.com/developer/technicalArticles/JavaEE/JavaEE6Overview_Part3.html#singles)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:32:36.977

您可以在数据库中设置一些标志类型属性并在运行程序后更改值。

# php - 将 Yii ActiveRecord 模型插入 mysql 表时出错

> ID：11472235
> 
> 赞同：4
> 
> 时间：2012-07-13T14:13:48.960
> 
> 标签：php, mysql, yii

我的网站上不时发生以下类型的错误。

```
2012/07/12 21:21:48 [error] [system.db.CDbCommand] Error in executing
SQL: INSERT INTO `seo_page` (`grouped`, `results_count`, `page`, `operation`, `subtype`, `type`, `state`, `zone`, `city`, `district`, `custom`, `property`, `date_add`, `date_upd`) VALUES (:yp0, :yp1, :yp2, :yp3, :yp4, :yp5, :yp6, :yp7, :yp8, :yp9, :yp10, :yp11, :yp12, :yp13) 
```

基本上代码可以正常工作，并且可以正确保存模型，我认为只有在尝试使用相同的主键同时进行两次插入时才会出现这种错误，或者它可能无法确保唯一性插入前的关键字字段。

用于在数据库中插入或更新关键字的脚本，代码如下：

```
static public function quickAdd($keyword) {
  if (strlen($keyword['name'])==0)
    return;
  $seo_keyword = SeoKeyword::model()->find("keyword=:keyword", array("keyword"=>$keyword['name']));
  if ($seo_keyword) {
//        return;
  } else {
    $seo_keyword=new SeoKeyword();
  }
  $seo_keyword->keyword=$keyword['name'];
  if (is_numeric($keyword['position'])) {
    $seo_keyword->position=$keyword['position'];
  }
  try {
    $seo_keyword->save();
  } catch (Exception $e) {

  }
  return $seo_keyword;
} 
```

mysql 表如下所示：

```
CREATE TABLE IF NOT EXISTS `seo_keyword` (
`id_seo_keyword` int(11) NOT NULL AUTO_INCREMENT,
`keyword` varchar(255) NOT NULL,
`position` int(11) DEFAULT NULL,
`date_add` datetime NOT NULL,
`date_upd` datetime NOT NULL,
PRIMARY KEY (`id_seo_keyword`),
UNIQUE KEY `keyword` (`keyword`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=2 ; 
```

我在其他表中也遇到了这种错误，它们都是有很多行的表，主要用于统计数据。

事实是我只能看到它无法插入，但没有错误，例如：主键问题，服务器忙或任何事情。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T14:10:31.480

尝试

```
var_dump($seo_keyword->getErrors()); 
```

后

```
$seo_keyword->save(); 
```

并查看实际问题是什么，以便插入查询失败。

# python - 为什么 float('3') 在 Python 2.6.8 中明显返回 TypeError？

> ID：11472239
> 
> 赞同：1
> 
> 时间：2012-07-13T14:13:56.763
> 
> 标签：python

我有（匿名）从 Python 2.6.8 中的值构造的哈希：

```
sys.stderr.write('#' + str(dictionary['Field 4']) + '#\n')
kpis_found.append(float(int(dictionary['Field 1']), 1) *
    max(float(dictionary['Field 2']), 1) *
    max(float(dictionary['Field 3']), 1) *
    max(float(dictionary['Field 4']), 1) *
    max(float(dictionary['Field 5']), 1)) 
```

我得到的输出是：

```
[Fri Jul 13 09:04:44 2012] [error] [client ::1] #3#
[Fri Jul 13 09:04:44 2012] [error] [client ::1] Traceback (most recent call last):
[Fri Jul 13 09:04:44 2012] [error] [client ::1]   File "/Users/jonathan/mirror/civic/google_maps/index.cgi", line 357, in <module>
[Fri Jul 13 09:04:44 2012] [error] [client ::1]     max(float(dictionary['Field 4']), 1) *
[Fri Jul 13 09:04:44 2012] [error] [client ::1] TypeError: float() takes at most 1 argument (2 given) 
```

据我所知，CSV 文件产生（通常）可转换为整数的字符串，或（偶尔）可转换为浮点数的字符串。如果我遇到 NULL，那应该更容易诊断。调试输出似乎确认有问题的字段是“3”。

这是如何得到 TypeError 的？我已经遍历括号以确保我没有计算

```
max(float(foo, bar)) 
```

而是计算

```
max(float(foo), bar) 
```

欢迎任何见解。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-13T14:17:27.213

```
float(int(dictionary['Field 1']), 1) 
```

很确定这是你的问题。你最终得到`float(<int_value>, 1)`.

这是用 Python 3.1.2 测试的，但是......

```
>>> float(1, 1)
Traceback (most recent call last):
  File "<pyshell#1>", line 1, in <module>
    float(1, 1)
TypeError: float() takes at most 1 argument (2 given) 
```

# sql - 需要案例陈述技巧

> ID：11472241
> 
> 赞同：0
> 
> 时间：2012-07-13T14:13:57.873
> 
> 标签：sql, sql-server, case

表格1

```
Mail              Special Quote (Y/N)

g@hotmail.com     Blank 
s@ho.com          Blank
sss@j.com         Blank 
```

表 2

```
Email Address     Dept

g@hotmail.com     Config 
s@ho.com          Finance
sss@j.com         Marketing 
```

现在我希望将表 1 更新为 Y，其中表 2 中匹配的电子邮件地址来自`Finance`or `Marketing`。

```
UPDATE TABLE 1 
Set Special Quote to be Y 
where in TABLE 2 the Dept is Finance or Marketing for the matching email address. 
```

可能只是大脑冻结，需要一些咖啡。

考虑在电子邮件地址上留下连接，然后为 Y 和 N 位添加一些 case 语句？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T14:17:37.633

不需要案例陈述。

```
update table1 set special_quote = 'Y'
where mail in ( select email_address from table2 where dept in ('Finance','Marketing' )) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T14:18:40.280

您非常接近，您需要加入邮件字段上的两个表，然后检查部门是否在财务/营销

```
UPDATE t1
SET t1.[Special Quote] = 'Y'
FROM Table1 t1
INNER JOIN Table2 t2
    ON t1.mail = t2.mail
WHERE t2.Dept in ('Finance','Marketing') 
```

这将仅更新包含的项目，如果您想更新 Y/N，那么您可以执行以下操作（请参阅[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/1a5b6/11)）

```
UPDATE t1
SET t1.sq = CASE WHEN t2.dept IS NOT NULL THEN 'Y' ELSE 'N' END
FROM  table1 t1
LEFT JOIN table2  t2
    ON t1.mail = t2.mail
    AND t2.Dept in ('Finance','Marketing') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T14:17:56.393

尝试以下操作：

```
UPDATE A
SET A.SpecialQuote = 'Y'
FROM Table1 A
INNER JOIN Table2 B
ON A.Mail = B.EmailAddress
WHERE B.Dept IN ('Finance','Marketing') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-13T14:18:03.503

我更像是 MySQL 用户，所以这可能是错误的，但请尝试以下操作：

```
UPDATE table1 SET specialquote = 'Y'
WHERE Mail IN (SELECT EmailAddress FROM table2 WHERE Dept IN ('Finance','Marketing')) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-13T14:18:41.470

你在正确的轨道上。这是语法：

```
update table1
    set SpecialQuote = 'Y'
    where mail in (select emailaddress from table2 where dept in ('Finance', 'Marketing') 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-13T14:19:13.390

更新 Table1 Set [Special Quote]='Y' from Table1 t1 join Table2 t2 on t1.[Email Address]=t2.[Email Address] where t2.dept in ('Finance','Marketing')

未经测试的样本，因此请理解该警告，但请相信它足以说明这一点。祝你好运！

**编辑**：根据下面的 OP 的“Y/N 更新”评论，更改如下......尽管还有其他几种微妙不同的方式可以完成同样的事情。希望这对您有所帮助。

```
Update Table1
   Set [Special Quote]=(case when t2.dept='Finance' 
                             then 'Y'
                             when t2.dept='Marketing'
                             then 'Y'
                             else 'N' 
                        end) 
  from Table1 t1
  join Table2 t2
    on t1.[Email Address]=t2.[Email Address] 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-13T14:20:14.303

```
create table #tbl1 (mail varchar(50),quote varchar(1))
create table #tbl2 (mail varchar(50),dept varchar(10))

insert into #tbl1 values ('a@a.com','')
insert into #tbl1 values ('b@b.com','')
insert into #tbl1 values ('c@c.com','')
insert into #tbl1 values ('d@d.com','')
insert into #tbl1 values ('e@e.com','')

insert into #tbl2 values ('a@a.com','config')
insert into #tbl2 values ('b@b.com','finance')
insert into #tbl2 values ('c@c.com','marketing')
insert into #tbl2 values ('d@d.com','other')
insert into #tbl2 values ('e@e.com','skivers')

update #tbl1
set quote = 'Y'
where mail in (SELECT mail FROM #tbl2 WHERE dept IN ('finance','marketing'))

select * from #tbl1

drop table #tbl1
drop table #tbl2 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-07-13T14:31:23.117

我喜欢使用[CTE](http://msdn.microsoft.com/en-us/library/ms190766%28v=sql.105%29.aspx)来帮助澄清查询的不同部分，所以这里有一种方法可以做到这一点。如果你不喜欢，还有其他的。

```
with getval as (
select mail,dept from test2
where dept in ('Marketing','Finance')
)

update test1
set quote = case when dept is NOT null then 'Y' else 'N' end 
from test1 t1
left outer join getval t2 on t1.mail = t2.mail 
```

无论如何，我使用左连接来获取所有记录，然后使用案例对部门出现的位置进行排序（意味着在 CTE 中找到了记录）。

或者...

```
update table1
set quote = case when dept is NOT null then 'Y' else 'N' end 
from table1 t1
left outer join table2 t2 on t1.email = t2.email and t2.dept in ('Marketing','Finance') 
```

这也应该有效。

# c# - .net 正则表达式匹配线

> ID：11472250
> 
> 赞同：5
> 
> 时间：2012-07-13T14:14:30.087
> 
> 标签：c#, .net, regex

为什么不`^.*$`匹配中的一行：

> 这是一些示例文本
> 
> 这是另一条线
> 
> 这是第三行

如何创建一个匹配整行的正则表达式，以便在找到下一个匹配项时它将返回下一行。

**换句话说，我想要**一个正则表达式，以便第一个匹配 = `This is some sample text`，下一个匹配 =`this is another line`等等......

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-13T14:18:16.203

^ 和 $ 匹配整个输入序列。您需要使用多行正则表达式选项来匹配文本中的各个行。

```
Regex rgMatchLines = new Regex ( @"^.*$", RegexOptions.Multiline); 
```

有关正则表达式选项的说明，请参见[此处](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regexoptions.aspx)。以下是关于 Multiline 选项的说明：

> 多行模式。更改 ^ 和 $ 的含义，使其分别匹配任何行的开头和结尾，而不仅仅是整个字符串的开头和结尾。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-13T14:17:27.477

使用正则表达式选项

```
Regex regex = new Regex("^.*$", RegexOptions.Multiline); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-13T14:17:26.013

您必须启用`RegexOptions.Multiline`并匹配行的开始`^`和`$`结束。否则，`^`将`$`匹配整个输入字符串的开始和结束。

# javascript - Nodejs 模块导出使用

> ID：11472261
> 
> 赞同：4
> 
> 时间：2012-07-13T14:15:06.720
> 
> 标签：javascript, node.js, mongodb

在一个示例应用程序中，我看到了一个带有如下代码的模块：

```
exports = mongoose = require('mongoose')
mongoose.connect(config.db.uri)
exports = Schema = mongoose.Schema 
```

有人能解释一下上面的代码是什么意思吗？在这三行之后，我可以看到可以从应用程序中的任何位置调用 mongoose 和 Schema 函数，但我无法理解其背后的逻辑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-10T03:08:33.713

> `exports = mongoose = require('mongoose')`

这将创建一个名为的变量`moongoose`并将其设置为等于`require('mongoose')`。

> `mongoose.connect(config.db.uri)`

这将启动与数据库的连接。

> `exports = Schema = mongoose.Schema`

`require('mongoose').Schema`无论出于何种原因，这都会使模块导出。

这可以更简单地写成：

```
var mongoose = require('mongoose')
mongoose.connect(config.db.uri)
exports = Schema = mongoose.Schema 
```

# javascript - 在 listitem id 中获取标签 id

> ID：11472262
> 
> 赞同：0
> 
> 时间：2012-07-13T14:15:11.833
> 
> 标签：javascript, html, jquery-mobile

我对 JQueryMobile、JavaScript 和 HTML 很陌生。在我的屏幕中，我有一个动态创建的元素列表，当您单击每个元素时，它应该会根据您单击的列表项的名称将您带到另一个屏幕。

我试图获取标签 ID、值、名称......但它不起作用......这是我每行的代码：

```
<li style='height:30px;' id='$object'>
    <a class='resume' id='$object' href='javascript:loadGraph(this);'>
        <span class='name' style='font-size:10pt;height:5px;' value='$object'>$object </span>
        <span class='data' style='background:$alarmColor;font-size:10pt;color:$alarmText;height:15px;'>$debitPrevMax</span>
    </a>
    <a class='info' id='$object' href='javascript:threshold(this)'>Alarm Info</a>
</li> 
```

该列表具有拆分按钮。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:21:54.857

> *“当我尝试访问 element.id 时，我得到了未定义”*

当你这样做...

```
href='javascript:threshold(this)' 
```

...`this`不是对元素的引用。这就是为什么`id`是`undefined`。

你需要`onclick=`改用。

```
onclick=':threshold(this)' 
```

* * *

此外，正如我在上面的评论中所说，*您**不能**在页面上有重复的 ID*。您可能只能获取第一个。

即使您没有将它们用于 DOM 选择，拥有重复项仍然不是一个好主意。

# xml - 用 xsl 中的变量连接 xml 节点

> ID：11472268
> 
> 赞同：1
> 
> 时间：2012-07-13T14:15:26.627
> 
> 标签：xml, xslt, path, concat

嗨，我需要将一个 xsl 节点路径与一个变量连接起来，以便在 xslt 中拥有一个动态节点路径。

我有这个节点：

```
<PRODOTTI>
  <ITEM STATO="2">
</PRODOTTI>
<STATI>
  <COD0>Errore</COD0>
  <COD1>In spedizione entro le prossime 12-24 ore</COD1>
  <COD2>In spedizione entro le prossime 24-48 ore</COD2>
 </STATI> 
```

在 xsl 我有

```
<xsl:variable name="stato_ordine" select="@STATO"/>
<xsl:variable name="ordine" select="concat(../../../TRADUZIONI/STATI/COD, $stato_ordine)" />
<xsl:value-of select="$ordine"></xsl:value-of> 
```

但在输出中我只得到“stato_ordine”值，而不是我需要完整的路径来获取节点值。

反正有这个吗？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T15:52:47.793

我想你想要`<xsl:value-of select="../../../TRADUZIONI/STATI/*[local-name() = concat('COD', $stato_ordine)]"/>`。

[编辑] 对于更有效的解决方案，您可以将键定义为`xsl:stylesheet`

```
<xsl:key name="k1" match="STATI/*[starts-with(local-name(), 'COD')]" use="substring(local-name(), 4)"/> 
```

然后做

```
<xsl:value-of select="key('k1', $stato_ordine)"/> 
```

应该足够了。

# objective-c - CoreLocation 对象，无法指定经度

> ID：11472271
> 
> 赞同：0
> 
> 时间：2012-07-13T14:15:28.220
> 
> 标签：objective-c, ios

我正在构建一个适用于 MapKit 的应用程序，我需要从谷歌地图获取坐标。

我做了一个函数来做这个（通过调试我知道我得到了好的坐标），但是当我尝试将它分配给我的事件对象的坐标时它会崩溃。

下面是代码，我已经清楚地评论了`// <----------------`它失败的地方......

AppDelegate.h

```
#import <UIKit/UIKit.h>
#import <MapKit/MapKit.h>
#import <CoreLocation/CoreLocation.h>
#import "MapViewController.h"
#import "Event.h"

@interface AppDelegate : UIResponder <UIApplicationDelegate, MKMapViewDelegate, CLLocationManagerDelegate>{
    CLLocationManager *locationManager;
}

//-(void)makeTestData:(int)amount;
-(void) addressLocation:(NSString*)adres:(Event*)event;

@property (strong, nonatomic) UIWindow *window;
//@property (strong, nonatomic) NSMutableArray *events;

@end 
```

AppDelegate.m

```
#import "AppDelegate.h"
#import "ListViewController.h"
#import "Event.h"
#import <RestKit/RestKit.h>

@implementation AppDelegate{
    NSMutableArray *events;

    /* for test data */
    NSMutableArray *titles;
}

@synthesize window = _window;
//@synthesize events;

-(void) addressLocation:(NSString*)adres: (Event*)event {
    NSString *urlString = [NSString stringWithFormat:@"http://maps.google.com/maps/geo?q=%@&output=csv&key=MYKEY", 
                           [adres stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]];
    NSString *locationString = [NSString stringWithContentsOfURL:[NSURL URLWithString:urlString]];
    NSArray *listItems = [locationString componentsSeparatedByString:@","];

    double latitude = 0.0;
    double longitude = 0.0;

    if([listItems count] >= 4 && [[listItems objectAtIndex:0] isEqualToString:@"200"]) {
        latitude = [[listItems objectAtIndex:2] doubleValue];
        longitude = [[listItems objectAtIndex:3] doubleValue];
    }
    else {
        //Show error
    }
    CLLocationCoordinate2D location;
    location.latitude = latitude;
    location.longitude = longitude;   // <----- Checked in debugging, coords are good

    event.coordinate.latitude = latitude;    // <----- can't assign the latitude here =/
    event.coordinate.longitude = longitude;  // <----- can't assign the longitude here =/

}

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{

    // START COMMUNICATOIN WITH REST INTERFACE
    //RKClient* client = [RKClient clientWithBaseURL:@"link"];
    //NSLog(@"I am your RKClient singleton : %@", [RKClient sharedClient]);
    // -------------------TEST OBJECTS
    //makeTestData(3);

    events = [NSMutableArray arrayWithCapacity:3];
    titles = [NSMutableArray arrayWithCapacity:3];
    [titles addObject:@"Gent Jazz Festival"];
    [titles addObject:@"Over blauw bloed en witte billenbijters - zoektocht in het Prinsenhof (zonder gids)"];
    [titles addObject:@"DuveltTent"];

    Event *event = [[Event alloc] init];
    event.title = [titles objectAtIndex:(rand()*100)%3];
    event.description = @"omminommie!!!";
    event.zone = @"fzfzefez";
    event.gemeente = @"Gent";
    event.plaats = @"";
    event.straat = @"Sint-Veerleplein";
    NSString *adres = [NSString stringWithFormat:@"%@, %@", event.gemeente, event.straat];
    [self addressLocation:adres:event];  //<---- This function fails, see above for def
    event.zone = @"blub";                
    [events addObject:event];            
... 
```

---- 编辑
就像上面的代码一样，它甚至没有编译并给出错误：

> 表达式不可赋值

当我`= location`按照上面的建议使用（我之前做过）时，我收到以下错误：

```
2012-07-13 17:14:20.608 Zone-It-new[565:707] -[Event setCoordinate:]: unrecognized selector sent to instance 0x283ab0
2012-07-13 17:14:20.621 Zone-It-new[565:707] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[Event setCoordinate:]: unrecognized selector sent to instance 0x283ab0'
*** First throw call stack:
(0x3748488f 0x35189259 0x37487a9b 0x37486a83 0x373e1650 0x6a319 0x6a5c9 0x31190cab 0x3118a7dd 0x31158ac3 0x31158567 0x31157f3b 0x33b9a22b 0x37458523 0x374584c5 0x37457313 0x373da4a5 0x373da36d 0x3118986b 0x31186cd5 0x6a097 0x6a03c)
terminate called throwing an exception 
```

这是我的 event.h 和 event.m

事件.h

```
#import <Foundation/Foundation.h>
#import <CoreLocation/CoreLocation.h>
#import <MapKit/MapKit.h>
#import <RestKit/RestKit.h>

@interface Event : NSObject <MKAnnotation>

// required property from mkanotation
@property (nonatomic, readonly) CLLocationCoordinate2D coordinate;

// Optional
@property (nonatomic, copy) NSString *title;
@property (nonatomic, copy) NSString *description;
@property (nonatomic, copy) NSString *zone;
@property (nonatomic, assign) NSString *gemeente;
@property (nonatomic, copy) NSString *straat;
@property (nonatomic, assign) int deelnemers;
@property (nonatomic, copy) NSDate *start;
@property (nonatomic, copy) NSDate *einde;
@property (nonatomic, copy) NSString *plaats;
@property (nonatomic, readonly) int id_nr;
@property (nonatomic, assign) int huisnummer;

@end 
```

事件.m

```
#import "Event.h"

@implementation Event

@synthesize coordinate, title, zone, gemeente, straat, deelnemers, start, einde, plaats, id_nr, huisnummer, description;

@end 
```

可能需要注意的重要一点是 ARC 已打开。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T15:23:50.720

您是否尝试将`coordinate`属性更改为`readwrite`？（`assign`将是一个不错的选择。）

# javascript - 如何在 html5 和 javascript 的画布图像中编辑像素并删除白色背景

> ID：11472273
> 
> 赞同：18
> 
> 时间：2012-07-13T14:15:43.273
> 
> 标签：javascript, html, canvas

如果我加载图像，如何循环遍历其所有像素并将白色像素（或我指定的任何颜色）变为透明？

我对如何做到这一点有一个想法，但循环过程应该像一个二维数组，所以它会涉及两个 for 循环。

我在想我会从第一行的第一个像素开始，向右迭代，如果它是白色像素，那么我把它变成透明的，然后向右移动 1 个像素，如果它不是白色的，那么我就停下来。然后在同一行，我从最左边的像素开始，检查，如果是白色，我把它变成透明的，然后向左移动 1 个像素，等等……

然后我向下移动 1 行并重复整个过程..

这样我就不会删除实际图像中的任何白色像素。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-07-13T14:23:44.027

它使用起来非常简单`getImageData`，`putImageData`只需注意图像越大，性能就会受到相当大的影响。您只需要确定当前像素是否为白色，然后将其 alpha 更改为 0。

**[现场演示](http://jsfiddle.net/loktar/BtbSM/)**

```
var canvas = document.getElementById("canvas"),
    ctx = canvas.getContext("2d"),
    image = document.getElementById("testImage");

canvas.height = canvas.width = 135;
ctx.drawImage(image,0,0);

var imgd = ctx.getImageData(0, 0, 135, 135),
    pix = imgd.data,
    newColor = {r:0,g:0,b:0, a:0};

for (var i = 0, n = pix.length; i <n; i += 4) {
    var r = pix[i],
            g = pix[i+1],
            b = pix[i+2];

        // If its white then change it
        if(r == 255 && g == 255 && b == 255){ 
            // Change the white to whatever.
            pix[i] = newColor.r;
            pix[i+1] = newColor.g;
            pix[i+2] = newColor.b;
            pix[i+3] = newColor.a;
        }
}

ctx.putImageData(imgd, 0, 0);​ 
```

还询问您是否可以使值有点模糊以检查。真的很简单，只要检查它是否在一定范围内。下面将白色转为纯白色透明。

```
 // If its white or close then change it
    if(r >=230 && g >= 230 && b >= 230){ 
        // Change the white to whatever.
        pix[i] = newColor.r;
        pix[i+1] = newColor.g;
        pix[i+2] = newColor.b;
        pix[i+3] = newColor.a;
    } 
```

**更多资源**

*   [使用画布进行像素操作](https://developer.mozilla.org/En/HTML/Canvas/Pixel_manipulation_with_canvas/)
*   [有关使用画布进行像素操作的更多信息](http://beej.us/blog/data/html5s-canvas-2-pixel/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2017-12-13T12:34:56.123

您可以使用图像处理框架来手动处理像素数据。

在[MarvinJ](https://www.marvinj.org)的情况下，给定一种颜色，您可以使用一行将所有像素设置为透明：

```
image.setColorToAlpha(0, 0); 
```

**输入图像**：

[![在此处输入图像描述](../Images/f3c45e477e2addfb1356edaefddce58d.png)](https://i.stack.imgur.com/NkNK0.png)

**结果：**

[![在此处输入图像描述](../Images/e346d1b3ff2750adc99f500ac41a5ec1.png)](https://i.stack.imgur.com/QTX3H.png)

**可运行示例：**

```
var canvas = document.getElementById("canvas");
image = new MarvinImage();
image.load("https://i.imgur.com/UuvzbLx.png", imageLoaded);

function imageLoaded(){
	image.setColorToAlpha(0, 0);	
	image.draw(canvas);
}
```

```
<script src="https://www.marvinj.org/releases/marvinj-0.8.js"></script>
<div style="width:400px; height:352px;  background-image: linear-gradient(45deg, #808080 25%, transparent 25%),
	linear-gradient(-45deg, #808080 25%, transparent 25%),
	linear-gradient(45deg, transparent 75%, #808080 75%), 
	linear-gradient(-45deg, transparent 75%, #808080 75%);
	background-size: 20px 20px;
	background-position: 0 0, 0 10px, 10px -10px, -10px 0px;">
<canvas id="canvas" width="400" height="352"></canvas>
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-26T01:57:34.643

Loktar 可能有一种“有效”的方法，但它的性能相当惨淡。如果您有很多图像，您不希望您的网站耗尽笔记本电脑/移动设备的电池，或者您只想要速度，这可能是一个问题。这是一种更有效的方法。单击“运行代码片段”按钮以进行演示。

```
'use-strict'
let fileInput = document.getElementById('fileInput'),
  theCANVAS = document.getElementById('theCanvas'),
  theCANVASctx = theCANVAS.getContext('2d'),
  imgTMP = document.getElementById('imgTMP'),
  rComponent = document.getElementById('r'),
  gComponent = document.getElementById('g'),
  bComponent = document.getElementById('b'),
  aComponent = document.getElementById('a'),
  transColor = "rgba(255, 255, 255, 1)",
  transCode = 0xffffffff;

let makeColorTransparent =
  function(canvasContext, transparentID, width, height) {
    // where all the magic happens
    let theImageData = canvasContext.getImageData(0, 0, width, height),
      theImageDataBufferTMP = new ArrayBuffer(theImageData.data.length),
      theImageDataClamped8TMP = new Uint8ClampedArray(theImageDataBufferTMP),
      theImageDataUint32TMP = new Uint32Array(theImageDataBufferTMP),
      n = theImageDataUint32TMP.length;
    theImageDataClamped8TMP.set(theImageData.data);

    imgDataLoop: while (n--) {
      // effciency at its finest:
      if (theImageDataUint32TMP[n] !== transparentID)
        continue imgDataLoop;
      theImageDataUint32TMP[n] = 0x00000000; // make it transparent
    }
    theImageData.data.set(theImageDataClamped8TMP);
    theCANVASctx.putImageData(theImageData, 0, 0);
  },
  downloadCanvas = function(downloadfilename) {
    theCanvas.toBlob(function(theIMGblob) {
      var thedataURL = URL.createObjectURL(theIMGblob),
        theAtagLink = document.createElement('a');

      theAtagLink.download = '(proccessed)' + downloadfilename;
      document.body.appendChild(theAtagLink);
      theAtagLink.href = thedataURL;
      theAtagLink.click();
    });
  };

fileInput.onchange = function(fileevent) {
  let efiles = fileevent.target.files,
    localTransColor = transColor,
    localTransCode = transCode;

  let cur = efiles.length,
    nextfile = function() {
      if (!cur--) {
        imgTMP.src = '';
        return;
      }
      let fr = new FileReader();
      console.log(efiles[cur]);
      fr.onload = function(dataevt) {
        fr.onload = null;
        let theArrayBuffer = dataevt.target.result,
          theblob = new Blob([theArrayBuffer]);
        imgTMP.src = URL.createObjectURL(theblob);
        imgTMP.onload = function() {
          imgTMP.onload = null;
          let theImagesWidth = imgTMP.naturalWidth,
            theImagesHeight = imgTMP.naturalHeight;

          theCANVAS.width = theImagesWidth;
          theCANVAS.height = theImagesHeight;

          theCANVASctx.fillStyle = localTransColor;
          theCANVASctx.clearRect(
            0,
            0,
            theImagesWidth,
            theImagesHeight
          );
          theCANVASctx.drawImage(imgTMP, 0, 0);
          makeColorTransparent(
            theCANVASctx,
            localTransCode,
            theImagesWidth,
            theImagesHeight
          );

          //now, download the file:
          downloadCanvas(efiles[cur].name);

          //Finally, procced to proccess the next file
          nextfile();
        };
      };
      fr.readAsArrayBuffer(efiles[cur]);
    };
  nextfile();
}

rComponent.oninput = gComponent.oninput =
  bComponent.oninput = aComponent.oninput =
  function() {
    rComponent.value = Math.max(0, Math.min(rComponent.value, 255));
    gComponent.value = Math.max(0, Math.min(gComponent.value, 255));
    bComponent.value = Math.max(0, Math.min(bComponent.value, 255));
    aComponent.value = Math.max(0, Math.min(aComponent.value, 255));
  };

rComponent.onchange = gComponent.onchange =
  bComponent.onchange = aComponent.onchange =
  function() {
    transColor = 'rgba(' +
      rComponent.value + ',' +
      gComponent.value + ',' +
      bComponent.value + ',' +
      aComponent.value / 255 + ',' +
      ')';
    // numberical equivelent of the rgba
    transCode =
      rComponent.value * 0x00000001 +
      gComponent.value * 0x00000100 +
      bComponent.value * 0x00010000 +
      aComponent.value * 0x01000000;
  };
```

```
<pre>rgba(<input type="number" value="255" max="255" min="0" step="1" id="r" maxlength="3" minlength="1" />,<input type="number" value="255" max="255" min="0" step="1" id="g" maxlength="3" minlength="1" />,<input type="number" value="255" max="255" min="0" step="1" id="b" maxlength="3" minlength="1" />,<input type="number" value="255" max="255" min="0" step="1" id="a" maxlength="3" minlength="1" />)</pre>

<input type="file" name="filefield" multiple="multiple" accept="image/*" id="fileInput" /><br />
<img id="imgTMP" />
<canvas id="theCanvas"></canvas>

<style>input[type=number]{width: 3em}#theCanvas {display: none}</style>
```

# java - java同步方法入口点线程是否足够安全？

> ID：11472276
> 
> 赞同：3
> 
> 时间：2012-07-13T14:15:50.703
> 
> 标签：java, multithreading, concurrency, thread-safety, shared-resource

我有一个 Singleton 类处理一种在 Hashmap 中具有不同对象的缓存。（键的格式直接链接到存储在映射中的对象类型 - 因此映射是 ）

地图上可能有三种不同的操作：添加、获取、删除。

我使用公共入口点方法（无密集访问）保护了对地图的访问：

```
public synchronized Object doAction(String actionType, String key, Object data){
  Object myObj = null;
  if (actionType.equalsIgnorecase("ADD"){
    addDataToMyMap(key,data);
  } else if (actionType.equalsIgnorecase("GET"){
    myObj = getDataFromMyMap(key);
  } else if (actionType.equalsIgnorecase("REM"){  
    removeDataFromMyMap(key);      
  }
  return myObj;
} 
```

笔记：

地图是私人的。方法 addDataToMyMap()、getDataFromMyMap() 和 removeDataFromMyMap() 是私有的。只有入口点方法是公共的，除了类本身的静态 getInstance() 之外别无其他。

您是否确认并发访问地图是线程安全的，因为除了通过该方法之外没有其他方法可以使用地图？

如果地图是安全的，我想这个原则可以应用于任何其他类型的共享资源。

非常感谢您的回答。

大卫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:21:01.753

我需要看看你的方法的实现，但这可能就足够了。但是我建议您使用 Java 的 Collection API 中的 Map，那么除非您共享其他实例，否则您不需要同步您的方法。

阅读：[http ://www.java-examples.com/get-synchronized-map-java-hashmap-example](http://www.java-examples.com/get-synchronized-map-java-hashmap-example)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T14:21:52.407

是的，只要唯一的入口点是 doAction，您的类将是线程安全的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T14:22:34.683

如果你的`cache`类是私有的`HashMap`，并且你有三个方法，并且所有方法都是私有的，如果你没有任何其他`public synchronized`实例变量，那么我认为你的缓存是.`static``public``thread-safe`

最好发布您的代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-13T14:33:20.420

这是完全安全的。只要所有线程都使用公共锁访问它，在这种情况下是对象，那么它就是线程安全的。（其他答案可能性能更高，但您的实施是安全的。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-13T14:21:44.450

您可以使用[Collections.synchronizedMap](http://docs.oracle.com/javase/6/docs/api/java/util/Collections.html#synchronizedMap%28java.util.Map%29)来同步对`Map`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-13T14:27:47.420

因为很难确定代码是否是线程安全的。您的示例中缺少的重要信息是：

1.  方法是否公开
2.  方法是否同步
3.  它的地图只能通过方法访问

我建议您研究[同步](http://docs.oracle.com/javase/tutorial/essential/concurrency/sync.html)以了解问题以及如何解决这些问题。探索[ConcurrentHashMap](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ConcurrentHashMap.html)类将提供有关您的问题的更多信息。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-13T14:30:15.023

您应该使用[ConcurrentHashMap](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/ConcurrentHashMap.html)。它提供比同步的 doAction 更好的吞吐量和比 Collections.synchronizedMap() 更好的线程安全性。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-07-16T13:42:03.327

这取决于您的代码。正如其他人所说，您可以使用 Collections.synchronizedMap。但是，这只会同步地图上的各个方法调用。因此，如果：

```
map.get(key);
map.put(key,value); 
```

在两个不同的线程中同时执行，一个会阻塞，直到另一个退出。但是，如果您的关键部分大于对地图的单个调用：

```
SomeExpensiveObject value = map.get(key);
if (value == null) {
   value = new SomeExpensiveObject();
   map.put(key,value);
} 
```

现在让我们假设密钥不存在。第一个线程执行，并返回一个空值。调度程序产生该线程，并运行线程 2，该线程也返回一个空值。它构造新对象并将其放入地图中。然后线程 1 恢复并执行相同的操作，因为它仍然有一个空值。

这是您希望在关键部分周围有一个更大的同步块的地方

```
SomeExpensiveObject value = null;

synchronized (map) {
  value = map.get(key);
  if (value == null) {
     value = new SomeExpensiveObject();
     map.put(key,value);
  }
} 
```

# android - 使用图形布局的Android Eclipse项目无法添加TextView或MultiLineView

> ID：11472281
> 
> 赞同：0
> 
> 时间：2012-07-13T14:16:03.383
> 
> 标签：android, eclipse, ide

我查看了其他几个相关的问题，一个答案甚至似乎解决了问题，但我错了。

问题是我得到：

```
C:\Documents and Settings\djordan\My Documents\SampleTest\AndroidManifest.xml 的解析器异常：文档中根元素之后的标记必须格式正确。

```

当我将新的 TextView 或 Multiline Text 视图项拖放到画布上时。所有其他文本字段都添加得很好。

编辑：粘贴错误的错误...更新。并增加了以下工作流程： 1\. 打开SDK，检查API 16是否安装。2\. 打开 Eclipse，创建新的 Android 项目 - 名称，目标/最小 API 16 3\. 在图形布局中，从文本字段中拖动“纯文本”或“多行文本”。4.查看上面的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:20:46.147

翻到xml页面，浏览一下，找到刚刚添加的textView。找到显示 android:textSize="18" 的属性并将其更改为 android:textSize="18dip" 应该可以解决它。该错误告诉您该属性的单位无效或未设置。

# python - 如何在 PySide/PyQt 中设置“只读复选框”

> ID：11472284
> 
> 赞同：4
> 
> 时间：2012-07-13T14:16:12.207
> 
> 标签：python, qt, pyqt, pyqt4, pyside

我正在尝试使用`QCheckBox`小部件显示布尔变量的值，并使用户无法更改显示的值。我不想禁用它，因为由此产生的灰色看起来不太好。我试图通过在用户单击`QCheckBox`. 但是，由于小部件的状态由`QAbstractButton`父类的“已检查”属性和`QCheckBox`类本身的“状态”属性描述，因此问题更加复杂。这引起了信号和槽的组合练习，我一直无法获得任何好的结果。

```
var_ctrl = QtGui.QCheckBox( 'some name' )

def rdslot1(state): 
    if state == QtCore.Qt.Checked:
        var_ctrl.setCheckState( QtCore.Qt.Unchecked )
    else:                               
        var_ctrl.setCheckState( QtCore.Qt.Checked )

def rdslot2(state): 
    if var_ctrl.isChecked():
        var_ctrl.setChecked(False)
    else:
        var_ctrl.setChecked(True)

# Signal/Slot combinations (only one should be active)
var_ctrl.stateChanged.connect( rdslot1 )
var_ctrl.toggled.connect( rdslot2 )
var_ctrl.stateChanged.connect( rdslot2 )
var_ctrl.toggled.connect( rdslot1 ) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-01T16:48:42.990

我参加聚会迟到了——看来你有一个可行的解决方案。为了将来参考，您可以使用的另一种方法是使用鼠标事件 - 这可以使您的所有信号按应有的方式工作：

```
from PyQt4 import QtGui, QtCore

class MyCheckBox(QtGui.QCheckBox):
    def __init__( self, *args ):
        super(MyCheckBox, self).__init__(*args) # will fail if passing **kwargs
        self._readOnly = False

    def isReadOnly( self ):
        return self._readOnly

    def mousePressEvent( self, event ):
        if ( self.isReadOnly() ):
            event.accept()
        else:
            super(MyCheckBox, self).mousePressEvent(event)

    def mouseMoveEvent( self, event ):
        if ( self.isReadOnly() ):
            event.accept()
        else:
            super(MyCheckBox, self).mouseMoveEvent(event)

    def mouseReleaseEvent( self, event ):
        if ( self.isReadOnly() ):
            event.accept()
        else:
            super(MyCheckBox, self).mouseReleaseEvent(event)

    # Handle event in which the widget has focus and the spacebar is pressed.
    def keyPressEvent( self, event ):
        if ( self.isReadOnly() ):
            event.accept()
        else:
            super(MyCheckBox, self).keyPressEvent(event)

    @QtCore.pyqtSlot(bool)
    def setReadOnly( self, state ):
        self._readOnly = state

    readOnly = QtCore.pyqtProperty(bool, isReadOnly, setReadOnly) 
```

以这种方式设置代码可以获得一些东西（您可能关心也可能不关心），但在开发自定义 Qt 小部件时会很有用：

1.  使用该事件会阻止信号发射，因此您仍然可以将其他插槽连接到单击和切换之类的东西。如果您正在寻找这些信号，然后只是打开/关闭值 - 那么侦听这些信号的其他小部件将被错误触发
2.  使用 isReadOnly/setReadOnly 保持类遵循 Qt 编码风格
3.  如果您将插件公开给 Qt 的设计器，创建 pyqtSignals 和 pyqtSlots 会有所帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T14:37:26.293

后来我想出了一个快捷方式，它可以简单地捕捉用户的点击并根据可指定的“可修改”属性处理它们。我做了这门课：

```
class MyQCheckBox(QtGui.QCheckBox):

    def __init__(self, *args, **kwargs):
        QtGui.QCheckBox.__init__(self, *args, **kwargs)        
        self.is_modifiable = True
        self.clicked.connect( self.value_change_slot )

    def value_change_slot(self): 
        if self.isChecked():
            self.setChecked(self.is_modifiable)
        else:
            self.setChecked(not self.is_modifiable)            

    def setModifiable(self, flag):
        self.is_modifiable = flag            

    def isModifiable(self):
        return self.is_modifiable 
```

它的行为就像一个 normal `QCheckBox`，默认情况下是可修改的。但是，当您调用 时`setModifiable(False)`，每次单击它时，它都会保持小部件的当前状态。诀窍是捕捉`clicked`信号，而不是`toggled`两者`stateChanged`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T15:08:50.320

尝试禁用复选框小部件，但使用小部件[调色板](http://qt-project.org/doc/qt-4.8/qpalette.html)或[样式覆盖其外观](http://qt-project.org/doc/qt-4.8/stylesheet-reference.html)

# cocos2d-iphone - cocos2d - 从 CCSprite 派生的 addchild 类

> ID：11472292
> 
> 赞同：0
> 
> 时间：2012-07-13T14:16:37.767
> 
> 标签：cocos2d-iphone

我是 cocos2d-iphone 的初学者。

我对游戏场景的 addchild 有疑问。

我制作了一个从 CCSprite 派生的简单类，并尝试显示该类。

但它没有用，我不知道有什么问题。

这是我的课程代码：

```
//myClass.h
#import "cocos2d.h"
@interface myClass:CCSprite{
}
@end

//myClass.m
#import "myClass.h"
@implementation myClass
-(id) init{
    if( self = [super initWithFile:@"title.png"] ){
        self.position = ccp(240, 240);
    }
    return self;
}
@end 
```

这是游戏场景的一部分：

```
//HelloWorldLayer.m
...
// this worked well.
// myClass* temp = [CCSprite spriteWithFile:@"title.png"];
// temp.position = ccp(240, 240);
// [self addChild:temp];

// but this won't work.
myClass* temp = [[myClass alloc] init];
[self addChild:temp];
... 
```

我应该怎么做才能解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T15:13:30.700

如果您检查代码，initWithFile 会调用调用 init 的 initWithTexture，因此您处于循环中，这就是问题所在。尝试创建另一个构造函数或类方法来创建您的精灵并设置位置。

例如

```
//myClass.h
#import "cocos2d.h"
@interface myClass:CCSprite{
}
-(id)initMy;
+(id)createMySprite;
@end

//myClass.m
#import "myClass.h"
@implementation myClass
-(id) initMy{
    if( self = [super initWithFile:@"title.png"] ){
        self.position = ccp(240, 240);
    }
    return self;
}
+(id)createMySprite {
    return [[[self alloc] initMy] autorelease];
}
@end 
```

# java - Android以编程方式将图像设置为TextView的背景

> ID：11472294
> 
> 赞同：3
> 
> 时间：2012-07-13T14:16:50.517
> 
> 标签：java, android, image, textview

我有一个应用程序需要以编程方式将图像放到后台，但它不起作用，代码是（来自 BankMenuParser 的 2 个方法）：

```
 public void getProviderFields(String file, String providerId) throws DocumentException, IOException {

        String xml = readFile(file);
        Document doc = DocumentHelper.parseText(xml);

        System.out.println("field name start");

        List list = doc.selectNodes("//root/operators/operator[@id='" + providerId + "']/fields/field/name");
        for (Iterator itr = list.iterator(); itr.hasNext();) {
//          Attribute attr = (Attribute) itr.next();
//          outList.add(attr.getValue());
            Element el = (Element) itr.next();
            Node elNode = (Node) itr.next();
//          elNode.getText();
            System.out.println("in array");
            System.out.println("field name: " + elNode.getText().toString());
        }
        System.out.println("field name end");
    }

public String getProviderImg(String file, String providerName) throws DocumentException, IOException {

    String xml = readFile(file);
    Document doc = DocumentHelper.parseText(xml);

    String img = doc.selectSingleNode("//root/menu/group/operator_id[@name='" + providerName + "']/@image").getText();

    return img;

}

public class Helpers {

    public static int getResourceId(Context context, String name, String resourceType) {
        return context.getResources().getIdentifier(name, resourceType, context.getPackageName());
    }

These methods called in Activity:

        Bundle menuExtras = getIntent().getExtras();

        BankMenuParser bmp = new BankMenuParser();
String img = bmp.getProviderImg("data/menu.xml", menuExtras.getString("provider_name"));
TextView textView = (TextView) findViewById(R.id.provider_logo);
int resid = Helpers.getResourceId(PaymentActivity.this, img, "drawable");
textView.setBackgroundResource(resid);
bmp.getProviderFields("data/provider_fields.xml", menuExtras.getString("provider_id")); 
```

我有兴趣将背景设置为 LogCat 中的图像，我看到的输出如下：

```
 07-13 13:27:36.178: I/System.out(677): mob_beeline.png 
```

因此，应该在所有可绘制对象中正确设置图像我有一个 mob_beeline.png 和 layers.xml 的内容：

```
<layer-list
    xmlns:android="http://schemas.android.com/apk/res/android">
    <item>
      <bitmap android:src="@drawable/mob_beeline"
        android:gravity="center" />     
    </item>    
</layer-list> 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-13T14:20:48.567

```
 textView.setBackgroundResource(R.drawable.mob_beeline); 
```

[看这里](http://developer.android.com/reference/android/view/View.html#setBackgroundResource%28int%29)

# android - 从动态创建的编辑文本字段中获取数据并在单击上传按钮后将它们发送到网络服务

> ID：11472299
> 
> 赞同：-1
> 
> 时间：2012-07-13T14:17:10.527
> 
> 标签：android, web-services, button, dynamic, upload

我正在尝试从 web 服务获取数据并根据 web 服务的响应创建动态自定义字段。然后用户将填写字段，然后单击上传按钮后，它将数据从动态自定义字段发送到网络服务，然后开始上传。我想知道如何从自定义字段中获取数据，因为它们是动态创建的，我无法访问它们。这是我的代码。这是我在从 web 服务获得响应后创建字段的图片，我需要您的帮助。

![在此处输入图像描述](../Images/ce830f1591bf4d5e61f8420d80ff7de9.png)

```
package com.isoft.uploader;

import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.Hashtable;
import java.util.List;

import org.json.JSONArray;
import org.json.JSONObject;
import org.ksoap2.SoapEnvelope;
import org.ksoap2.serialization.SoapObject;
import org.ksoap2.serialization.SoapSerializationEnvelope;
import org.ksoap2.transport.HttpTransportSE;

import android.app.Activity;
import android.app.AlertDialog;
import android.content.Intent;
import android.database.Cursor;
import android.net.Uri;
import android.os.Bundle;
import android.provider.MediaStore;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.LinearLayout;
import android.widget.LinearLayout.LayoutParams;
import android.widget.ScrollView;
import android.widget.TextView;

public class UploaderActivity extends Activity 
{
ArrayList <Response> WebData= new ArrayList<Response>();
public static final int SELECT_VIDEO=1;
public static final String TAG="UploadActivity";
String path="";
final String NAMESPACE = "http://tempuri.org/";
final String SERVICEURL = "http://192.168.10.177/androidws/isandroidws.asmx";
final String METHOD_NAME1="OzelVeriAlanlariniGetir";
final String METHOD_NAME="KullaniciGiris";
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    Button enter=(Button)findViewById(R.id.Enter);
    final EditText username=(EditText)findViewById(R.id.username);
    final EditText password=(EditText)findViewById(R.id.password);
    final  AlertDialog ad=new AlertDialog.Builder(this).create();
    enter.setOnClickListener(new View.OnClickListener() 
    {
        @Override
        public void onClick(View arg0) 
        {
            // TODO Auto-generated method stub
            //request code for Webservice
            SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME);
            //sending the username to the webservice
            request.addProperty("kullaniciAdi",username.getText().toString());
            //sending the password to the webservice
            request.addProperty("password",password.getText().toString());
            SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
            envelope.dotNet = true;
            //Putting the request in an envelope
            envelope.setOutputSoapObject(request);
            HttpTransportSE transport = new HttpTransportSE(SERVICEURL);
            Object response = null;
            try
            {
                 transport.call("http://tempuri.org/"+METHOD_NAME, envelope);
                 //getting the response from the webservice
                 response= envelope.getResponse();
            }
            catch(Exception exception)
            {
                exception.printStackTrace();
            }//end of catch
            if(response!=null && Integer.parseInt(response.toString()) != 0)
            {
                openGaleryVideo();
            }//end of if
            else
            {
                ad.setMessage("Lütfen Kullanıcı Adınızı ve Şifrenizi Kontrol Ediniz.");
                ad.show();  
            }//end of else
        }//end of onClick method    
    });//end of OnclickListener method
}//end of onCreate method
public void openGaleryVideo()
{
    Intent intent=new Intent();
    intent.setType("video/*");
    intent.setAction(Intent.ACTION_GET_CONTENT);
    startActivityForResult(Intent.createChooser(intent, "Select Video"),SELECT_VIDEO);
}//end of openGaleryVideo method

public String getPath(Uri uri)
{   
    String[] projection = { MediaStore.Video.Media.DATA};
    Cursor cursor = managedQuery(uri, projection, null, null, null);
    int column_index = cursor.getColumnIndexOrThrow(MediaStore.Video.Media.DATA);
    cursor.moveToFirst();
    return cursor.getString(column_index);
}//end of getPath method

//Response Class
public class Response
{
    int Id;
    String Name;
    String Type;
    String Value;
    String DefaultValue;
    int Flag;
    int Index;
}//end of Response class

//onActivityResult
@SuppressWarnings("unused")
public void onActivityResult(int requestCode, int resultCode, Intent data) 
{
    super.onActivityResult(requestCode, resultCode, data);
    if (resultCode == RESULT_OK)
    {
        if (requestCode == SELECT_VIDEO) 
        {
            Uri videoUri = data.getData();
            path=getPath(videoUri);
            ScrollView scroll = new ScrollView(this);
            LinearLayout layout=new LinearLayout(this);
            layout.setOrientation(LinearLayout.VERTICAL);
            layout.setLayoutParams(new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT)); 
            scroll.addView(layout,new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT));
            setContentView(scroll);             
            SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME1);
            SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
            envelope.dotNet = true;
            //İsteğimizi zarf'a koyuyoruz
            envelope.setOutputSoapObject(request);
            HttpTransportSE transport = new HttpTransportSE(SERVICEURL);
            final  AlertDialog adr=new AlertDialog.Builder(this).create();
            Object response1=null;
            try
            {
                 transport.call("http://tempuri.org/"+METHOD_NAME1, envelope);
                 //getting the response from the webservice
                 response1 =envelope.getResponse();
                 JSONArray jArray= new JSONArray(response1.toString());
                 for(int i=0;i<jArray.length();i++)
                 {
                     JSONObject json_data= jArray.getJSONObject(i);
                     Response result= new Response();
                     result.Id= json_data.getInt("Id");
                     result.Name= json_data.getString("Name");
                     result.Type= json_data.getString("Type");
                     result.Value=json_data.getString("Value");
                     result.DefaultValue=json_data.getString("DefaultValue");
                     result.Flag=json_data.getInt("Flag");
                     result.Index=json_data.getInt("Index");
                     WebData.add(i,result);
                 }//end of for loop     
            }//end of try 
            catch(Exception exception)
            {
                exception.printStackTrace();
            }//end of catch

            for(int j=0;j<WebData.size();j++)
            {
                TextView t= new TextView(this);
                t.setText(WebData.get(j).Name);
                layout.addView(t);
                if("Type"=="datetime")
                {
                    EditText datetime= new EditText(this);
                    datetime.setId(j);
                    SimpleDateFormat sdf = new SimpleDateFormat( "yyyy/MM/dd" ); 
                    datetime.setText(sdf.format( new Date()));
                    layout.addView(datetime);

                }//end of if

                else if("Type"=="int")
                {
                    EditText integer= new EditText(this);
                    layout.addView(integer);
                }//end of else if
                else
                {
                    EditText nvarchar= new EditText(this);
                    layout.addView(nvarchar);
                }//end of else 

            }//end of for loop
            Button button= new Button(this);
            button.setClickable(true);
            button.setText("Yükle");
            layout.addView(button);
            button.setOnClickListener(new View.OnClickListener() {

                @Override
                public void onClick(View arg0)
                {
                    // TODO Auto-generated method stub

                }
            });
        }//end of If request code
    }//end of If result code
}//end of onActivityResult
}//end of main 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T14:38:54.653

如果我理解正确，您的问题是从动态创建的字段中获取数据。`EditText`您可以通过保存在您的类中动态创建的来解决它。

这是您保存字段的代码（我没有检查语法）。我已经用 //BUBBLE 注释标记了更改的块。

```
package com.isoft.uploader;

import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.Hashtable;
import java.util.List;

import org.json.JSONArray;
import org.json.JSONObject;
import org.ksoap2.SoapEnvelope;
import org.ksoap2.serialization.SoapObject;
import org.ksoap2.serialization.SoapSerializationEnvelope;
import org.ksoap2.transport.HttpTransportSE;

import android.app.Activity;
import android.app.AlertDialog;
import android.content.Intent;
import android.database.Cursor;
import android.net.Uri;
import android.os.Bundle;
import android.provider.MediaStore;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.LinearLayout;
import android.widget.LinearLayout.LayoutParams;
import android.widget.ScrollView;
import android.widget.TextView;

public class UploaderActivity extends Activity 
{
  ArrayList <Response> WebData= new ArrayList<Response>();
  public static final int SELECT_VIDEO=1;
  public static final String TAG="UploadActivity";
  String path="";
  final String NAMESPACE = "http://tempuri.org/";
  final String SERVICEURL = "http://192.168.10.177/androidws/isandroidws.asmx";
  final String METHOD_NAME1="OzelVeriAlanlariniGetir";
  final String METHOD_NAME="KullaniciGiris";

  // BUBBLE
  private List<EditText> dynaFields = null;

  /** Called when the activity is first created. */
  @Override
    public void onCreate(Bundle savedInstanceState) 
    {
      super.onCreate(savedInstanceState);
      setContentView(R.layout.main);
      Button enter=(Button)findViewById(R.id.Enter);
      final EditText username=(EditText)findViewById(R.id.username);
      final EditText password=(EditText)findViewById(R.id.password);
      final  AlertDialog ad=new AlertDialog.Builder(this).create();
      enter.setOnClickListener(new View.OnClickListener() 
          {
          @Override
          public void onClick(View arg0) 
          {
          // TODO Auto-generated method stub
          //request code for Webservice
          SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME);
          //sending the username to the webservice
          request.addProperty("kullaniciAdi",username.getText().toString());
          //sending the password to the webservice
          request.addProperty("password",password.getText().toString());
          SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
          envelope.dotNet = true;
          //Putting the request in an envelope
          envelope.setOutputSoapObject(request);
          HttpTransportSE transport = new HttpTransportSE(SERVICEURL);
          Object response = null;
          try
          {
          transport.call("http://tempuri.org/"+METHOD_NAME, envelope);
          //getting the response from the webservice
          response= envelope.getResponse();
          }
          catch(Exception exception)
          {
            exception.printStackTrace();
          }//end of catch
          if(response!=null && Integer.parseInt(response.toString()) != 0)
          {
            openGaleryVideo();
          }//end of if
          else
          {
            ad.setMessage("Lütfen Kullanıcı Adınızı ve Şifrenizi Kontrol Ediniz.");
            ad.show();  
          }//end of else
          }//end of onClick method    
          });//end of OnclickListener method
    }//end of onCreate method
  public void openGaleryVideo()
  {
    Intent intent=new Intent();
    intent.setType("video/*");
    intent.setAction(Intent.ACTION_GET_CONTENT);
    startActivityForResult(Intent.createChooser(intent, "Select Video"),SELECT_VIDEO);
  }//end of openGaleryVideo method

  public String getPath(Uri uri)
  {   
    String[] projection = { MediaStore.Video.Media.DATA};
    Cursor cursor = managedQuery(uri, projection, null, null, null);
    int column_index = cursor.getColumnIndexOrThrow(MediaStore.Video.Media.DATA);
    cursor.moveToFirst();
    return cursor.getString(column_index);
  }//end of getPath method

  //Response Class
  public class Response
  {
    int Id;
    String Name;
    String Type;
    String Value;
    String DefaultValue;
    int Flag;
    int Index;
  }//end of Response class

  //onActivityResult
  @SuppressWarnings("unused")
    public void onActivityResult(int requestCode, int resultCode, Intent data) 
    {
      super.onActivityResult(requestCode, resultCode, data);
      if (resultCode == RESULT_OK)
      {
        if (requestCode == SELECT_VIDEO) 
        {
          Uri videoUri = data.getData();
          path=getPath(videoUri);
          ScrollView scroll = new ScrollView(this);
          LinearLayout layout=new LinearLayout(this);
          layout.setOrientation(LinearLayout.VERTICAL);
          layout.setLayoutParams(new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT)); 
          scroll.addView(layout,new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT));
          setContentView(scroll);             
          SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME1);
          SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
          envelope.dotNet = true;
          //İsteğimizi zarf'a koyuyoruz
          envelope.setOutputSoapObject(request);
          HttpTransportSE transport = new HttpTransportSE(SERVICEURL);
          final  AlertDialog adr=new AlertDialog.Builder(this).create();
          Object response1=null;
          try
          {
            transport.call("http://tempuri.org/"+METHOD_NAME1, envelope);
            //getting the response from the webservice
            response1 =envelope.getResponse();
            JSONArray jArray= new JSONArray(response1.toString());
            for(int i=0;i<jArray.length();i++)
            {
              JSONObject json_data= jArray.getJSONObject(i);
              Response result= new Response();
              result.Id= json_data.getInt("Id");
              result.Name= json_data.getString("Name");
              result.Type= json_data.getString("Type");
              result.Value=json_data.getString("Value");
              result.DefaultValue=json_data.getString("DefaultValue");
              result.Flag=json_data.getInt("Flag");
              result.Index=json_data.getInt("Index");
              WebData.add(i,result);
            }//end of for loop     
          }//end of try 
          catch(Exception exception)
          {
            exception.printStackTrace();
          }//end of catch

          // BUBBLE create a list with the exact size of input fields
          this.dynaFields = new ArrayList<EditText>(WebData.size());

          for(int j=0;j<WebData.size();j++)
          {
            //BUBBLE: instantiate and add the current field to the list and view
            EditText newField = new EditText(this);
            this.dynaFields.add (newField)
            layout.addView(newField);

            TextView t= new TextView(this);
            t.setText(WebData.get(j).Name);
            layout.addView(t);
            if("Type"=="datetime")
            {
              //BUBBLE
              newField.setId(j);
              SimpleDateFormat sdf = new SimpleDateFormat( "yyyy/MM/dd" ); 
              newField.setText(sdf.format( new Date()));

            }//end of if

          }//end of for loop
          Button button= new Button(this);
          button.setClickable(true);
          button.setText("Yükle");
          layout.addView(button);
          button.setOnClickListener(new View.OnClickListener() {

              @Override
              public void onClick(View arg0)
              {
              // TODO Auto-generated method stub

              }
              });
        }//end of If request code
      }//end of If result code
    }//end of onActivityResult
}//end of main 
```

简而言之，我创建了一个 ArrayList`EditText`

```
private List<EditText> dynaFields = null; 
```

然后列表在字段创建之前被实例化：

```
// BUBBLE create a list with the exact size of input fields
this.dynaFields = new ArrayList<EditText>(WebData.size()); 
```

最后，一旦创建了字段，我就将它们添加到列表和视图中：

```
// instantiate and add the current field to the list and view
EditText newField = new EditText(this);
this.dynaFields.add (newField)
layout.addView(newField); 
```

我在你的 if 语句中做了一些小的简化，所以我可以只使用一个 EditText 对象。

要获取组件，只需在 onClick 方法中遍历数组：

```
public void onClick(View arg0)
{
    TextField currText;
    for (currText : UploaderActivity.this.dynaFields) {
     // TODO: get the current EditText text and have fun!
    }    
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T14:49:39.493

创建时在 EditText 对象上设置标签（result.Id），然后浏览主布局，然后

```
int mainChildsCount = mainGroup.getChildCount();
for(int i=0;i<mainChildsCount;i++){
    View v = mainGroup.getChildAt(i);   
    if(v instanceof EditText){
        //recognize them here by their tags     
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T14:30:34.423

Take

```
int dynId = 1001; 
```

Now, when you are creating EditTexts dynamically, set their ids by using

```
.setId(dynId++); 
```

Then at the time of sending EditTexts' data to web-service; retrive values from EditTexts by getting them using ID you have seted at the time of creating.

At time of retriving, you can start retriving using 1001 and increment them by 1.

* * *

use this :

```
 String unm, pwd;

    YourComponent.setOnClickListener(new View.OnClickListener() {  //  OR  In  onClick

                @Override
                public void onClick(View arg0)
                {
                     unm = username.getText().toString();
                     pwd = password.getText().toString();
                }
            }); 
```

Now, use these `unm` and `pwd` strings.

You can get the components by their ID's

```
for (int i = 1001; i < 1001 + componentCount; i++) {
  View currView = getViewById (i);
  if (currView instanceof EditText) { 
      EditText currentComponent = (EditText) currView;
  }
} 
```

# linux - 在顶部保留一个进度条。Linux

> ID：11472304
> 
> 赞同：3
> 
> 时间：2012-07-13T14:17:26.917
> 
> 标签：linux, shell, unix, scripting, progress

好的，所以我只是想知道是否有一种方法可以在脚本运行时在顶部显示进度条，以告诉用户 x% 的过程已完成。还有一个内置在操作系统中的命令可以让我使用进度条还是我必须在代码中设计它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-15T21:22:12.163

There is `zenity`, a GTK application with GUI elements for scripts. It has a progress bar and much more.

The package `dialog` provides several UI elements for shell scripting. One of them is a `gauge`, a progress bar. Debian maintains a simplified version of `dialog` called `whiptail`.

There is also an X version of `dialog`: `Xdialog`, but I have never seen it myself.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-15T19:16:22.400

在您的脚本中包含一个百分比跟踪器，但会消耗更多资源......

例如，如果您要复制一堆文件：

` foreach $y (@files) {

```
$countline++;
$total = 1000;
$lastcount = $currentcount
$currentcount = $countline / $total

if ( $lastcount > $currentcount ) {
    $progress_display == 1
    $currentcount

    if ($progress_display == 1) {
            print ".";
    } 
```

} 打印 "\n"; `

# nhibernate - 查询结束 获取所有实现

> ID：11472307
> 
> 赞同：0
> 
> 时间：2012-07-13T14:17:28.320
> 
> 标签：nhibernate, interface, fluent-nhibernate, fluent-nhibernate-mapping

Nhibernate 有一个很好的特性，我偶然发现了这个特性：

```
public interface IInterface {}

public class Impl1 : IInterface {}

public class Impl2 : IInterface {}

ISession session = sf.OpenSession();
session.QueryOver<IInterface>().List(); 
```

这将获取我所有的`Impl1`ans`Impl2`对象（以防这些类被映射）。它们不需要映射为`SubClassMaps`，这使我得出结论 NHibernate 自己解决了实现类。

任何人都可以把这个文档的链接发给我吗？我不知道这个功能的名称和技术背景......

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:37:43.967

实际上，这只是 NH​​ibernate 进行[继承映射](http://www.nhforge.org/doc/nh/en/index.html#inheritance)的方式。

除了您描述的用法之外，您还可以使用基本类型在对象上定义子集合，并将任何继承类型的对象放入集合中。例如，您可以拥有另一个包含您的`IInterface`对象集合的实体：

```
public class MyEntity
{
    public IList<IInterface> MyCollection { get; set; }
} 
```

现在您可以将任何实现的对象`IInterface`放入`MyCollection`中，NHibernate 将保存它们（如果映射正确）：

```
Impl1 i1 = new Impl1();
Impl2 i2 = new Impl2();
MyEntity entity = new MyEntity();
entity.MyCollection.Add(i1);
entity.MyCollection.Add(i2);

session.Save(entity); 
```

但是，实际的数据库使用（生成的 SQL）取决于您定义的继承映射策略，因此请先熟悉它们。[您可以在官方文档](http://www.nhforge.org/doc/nh/en/index.html#inheritance)中阅读更多内容。

# django - Django Manager - 覆盖默认的 get_query_set 以设置默认的“GROUP BY”

> ID：11472313
> 
> 赞同：0
> 
> 时间：2012-07-13T14:17:39.307
> 
> 标签：django, django-queryset

我被遗留数据库困住了。我想修改默认查询集以便熟练使用数据库，为此我需要使用`GROUP BY`. 我知道我可以做到这一点，这让我得到了我所追求的 SQL：

```
query = Variant.objects.all().query
query.group_by = ['name']
return QuerySet(query=query, model=Variant) 
```

这将产生我所追求的查询集。所以我建立了一个查询集管理器来帮助我。问题是它返回了正确的值，但是当我计算它时它是错误的。

```
class VariantQuerySet(QuerySet):
    def group_by_name(self):
        self.query.group_by = ['name']
        return self.filter()

class VariantManager(models.Manager):

    def get_query_set(self):
        return VariantQuerySet(self.model, using=self._db) 
```

但是当我开始玩它时..

```
>>> Variant.objects.filter(project__name__icontains="zam")
[<Variant: RevA>, <Variant: RevA>, <Variant: RevA>, <Variant: revB>, <Variant: RevC_Fiendish>, <Variant: RevA>, <Variant: RevA_tapeout>]
>>> Variant.objects.filter(project__name__icontains="zam").count()
7
>>> Variant.objects.filter(project__name__icontains="zam").group_by_name()
[<Variant: RevA>, <Variant: revB>, <Variant: RevC_Fiendish>, <Variant: RevA_tapeout>] 
```

到目前为止，一切都很好。7 个未分组的项目，4 个分组。

```
>>> Variant.objects.filter(project__name__icontains="zam").group_by_name().count()
7 
```

那么为什么我的计数仍然停留在 7 - 它应该是 4？我认为 _result_cache 持有该值，所以我在方法中将其设置为 None 但没有运气。任何想法为什么这是错误的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T15:46:03.977

`.count()`实际上创建了一个新查询，将字段删除并替换为`COUNT(*)`. 实际上不可能按字段分组*并*在普通 SQL 中对分组表进行计数。基本上，您最初的查询在 SQL 中如下所示：

```
SELECT myapp_variant.id, myapp_variant.name, myapp_variant.etc, ...
FROM myapp_variant inner join myapp_project on myapp_variant.project_id = myapp_project.id
WHERE myapp_project.name='zam'
GROUP BY myapp_variant.name 
```

计数查询如下所示：

```
SELECT COUNT(*)
FROM myapp_variant inner join myapp_project on myapp_variant.project_id = myapp_project.id
WHERE myapp_project.name='zam' 
```

请注意，它不能再分组。如果是这样，您最终会得到以下结果集：

```
COUNT
-----
    4 
    1
    1
    1 
```

（在这种情况下，4 是 RevA 记录的数量，然后是其他每个记录的 1）

因为当您在聚合查询中*分组*时，您是在告诉 SQL 为每个分组列中的每个唯一值创建一行。4 种不同的变体名称，因此 4 条记录！这根本不是你想要的

您可以通过输出 Django 生成的查询来确认这是否是问题所在：

```
>>> print Variant.objects.filter(project__name__icontains="zam").group_by_name().query

>>> print Variant.objects.filter(project__name__icontains="zam").group_by_name().count().query 
```

这个问题实际上只有两种解决方案：

1.  重写 group_by_name 以便它不只是按字段分组，它实际上返回一个过滤的查询集，每个名称只有一条记录。更难做
2.  当您需要分组查询集的“计数”时，只需使用`len()`，如

    ```
    len(Variant.objects.filter(project__name__icontains="zam").group_by_name()) 
    ```

    或者，在模板中：

    ```
    {{ grouped_variants|length }} 
    ```

# python - 实体上的透明逻辑过滤器 - App Engine

> ID：11472314
> 
> 赞同：0
> 
> 时间：2012-07-13T14:17:39.990
> 
> 标签：python, google-app-engine, nodes

我不确定我是否可以轻松做到这一点，但我需要为与我的模型相关的每个查询自动在字段上添加过滤器。我在名为 Node 的模型中添加了一个布尔属性“active”。

例如

```
Node.query() 
```

应该返回字段 Node.active 设置为 True 的每个节点，并忽略 active 字段设置为 false 的节点，无需任何其他指令。

是否可以以任何方式或类似的方式覆盖该功能？我对 python 和应用程序引擎都不是很擅长，所以我不确定我真的能做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T23:50:55.013

您应该为您的 Node 类创建一个为您执行查询的类方法，然后始终使用它。例如

```
class Node(db.Model):
   # some properties and stuff

   @classmethod
   def active_nodes(cls):
       return cls.all().filter('active = ',True) 
```

然后始终使用 Node.active_nodes() 这是您始终使用的正式 api 的一部分。我广泛使用这种方法，而不是到处编写相同的（通常更复杂的查询）。

# python - 通过Python运行带有文件名变量的shell命令

> ID：11472325
> 
> 赞同：0
> 
> 时间：2012-06-05T18:09:12.543
> 
> 标签：python, shell

我有命名约定的文件

```
st009_out.abc1.dat
st009_out.abc2.dat
st009_out.abc3.dat 
..................
.................. 
```

我正在编写 Python 代码，我想使用文件中的数据来执行数学函数，并且需要从文件中提取第二列。我试过这样：

```
for k in range(1,10):
    file1=open('st009_out.abc'+str(k)+'.dat','r')
    ...........
    os.system("awk '{print $2}' st009_out.abc${k}.pmf > raj.dat") 
```

但这不起作用，因为它没有采用`k`shell 命令中的值。

我如何进步？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:17:50.473

尝试

```
os.system("awk '{print $2}' st009_out.abc"+str(k)+".pmf > raj.dat") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T19:40:11.183

您使用文件名两次，所以只设置一次

```
for k in range(1,10):
    name = 'st009_out.abc'+str(k)+'.dat'
    file1=open(name,'r')
    ...........
    os.system("awk '{print $2}' " + name  + " > raj.dat") 
```

或者更好地在 python 中重写 awk

# dom - Chrome 扩展在正文完成加载之前注入 javascript

> ID：11472331
> 
> 赞同：1
> 
> 时间：2012-07-13T14:18:16.047
> 
> 标签：dom, google-chrome-extension

我正在尝试创建一个 Chrome 扩展程序，在脚本执行之前阻止它。

脚本标签在 body 标签中，而不是在 head 中。

有可能这样做吗？

在 manifest.json 我设置了 content_scripts 是这样的：

```
"content_scripts": [
{
    "run_at": "document_start",
  "matches": ["http://website.it/*"],
  "js": ["dojob.js"]

}] 
```

我的脚本是这个：

```
var cont = 0;

document.addEventListener("DOMNodeInserted", function(event){
        if(cont==0){
            alert(document.getElementsByTagName("script")[0].src);
            document.getElementsByTagName("script")[0].src = "";
            cont++;
        }

}); 
```

但是脚本仍然运行...

我怎么不能让它工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-14T14:09:49.823

由于您的制作，`src=""`我认为 js 是外部的。如果是这种情况，那么您可以使用 beforeload 事件或 webrequest api 来阻止脚本的加载。

```
function doBeforeLoad(event){
    if (event.srcElement.tagName=="SCRIPT" && event.srcElement.src=='test.js') {
        event.preventDefault();
    }
}

document.addEventListener('beforeload', doBeforeLoad , true); 
```

[http://code.google.com/chrome/extensions/webRequest.html](http://code.google.com/chrome/extensions/webRequest.html)

# python - Python 动态数组分配，Matlab 风格

> ID：11472333
> 
> 赞同：2
> 
> 时间：2012-07-13T14:18:21.617
> 
> 标签：python, arrays, matlab, numpy, indexing

我正在尝试将我构建的一些 Matlab 库移动到 python 环境中。到目前为止，我面临的最大问题是基于索引规范的数组动态分配。例如，使用 Matlab，键入以下内容：

```
x = [1 2];
x(5) = 3; 
```

会导致：

```
x = [ 1     2     0     0     3] 
```

换句话说，我事先不知道 (x) 的大小，也不知道它的内容。必须根据我提供的索引动态定义数组。

在 python 中，尝试以下操作：

```
from numpy import *
x = array([1,2])
x[4] = 3 
```

会导致以下错误：IndexError: index out of bounds。解决方法是在循环中递增数组，然后将所需的值分配为：

```
from numpy import *
x = array([1,2])

idx = 4
for i in range(size(x),idx+1):
    x = append(x,0)

x[idx] = 3
print x 
```

它可以工作，但不是很方便，并且对于 n 维数组可能会变得非常麻烦。我虽然关于子类化 ndarray 以实现我的目标，但我不确定它是否会工作。有人知道更好的方法吗？

* * *

感谢您的快速回复。我不知道**setitem**方法（我对 Python 还很陌生）。我只是简单地覆盖了 ndarray 类，如下所示：

```
import numpy as np

class marray(np.ndarray):

    def __setitem__(self, key, value):

        # Array properties
        nDim = np.ndim(self)
        dims = list(np.shape(self))

        # Requested Index
        if type(key)==int: key=key,
        nDim_rq = len(key)
        dims_rq = list(key)

        for i in range(nDim_rq): dims_rq[i]+=1        

        # Provided indices match current array number of dimensions
        if nDim_rq==nDim:

            # Define new dimensions
            newdims = []
            for iDim in range(nDim):
                v = max([dims[iDim],dims_rq[iDim]])
                newdims.append(v)

            # Resize if necessary
            if newdims != dims:
              self.resize(newdims,refcheck=False)

        return super(marray, self).__setitem__(key, value) 
```

它就像一个魅力！但是，我需要修改上面的代码，以便**setitem**允许更改此请求后的维数：

```
a = marray([0,0])
a[3,1,0] = 0 
```

不幸的是，当我尝试使用 numpy 函数时，例如

```
self = np.expand_dims(self,2) 
```

返回的类型是 numpy.ndarray 而不是**main** .marray。如果将 marray 作为输入提供，关于如何强制执行 numpy 函数输出 marray 的任何想法？**我认为使用array_wrap**应该是可行的，但我永远找不到确切的方法。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T14:24:38.510

冒昧地从[自动扩展的动态列表](https://stackoverflow.com/questions/11265282/dynamic-list-that-automatically-expands/11265571#11265571)中更新我的旧答案。认为这应该做你需要/想要的大部分

```
class matlab_list(list):
    def __init__(self):
        def zero():
            while 1:
                yield 0
        self._num_gen = zero()

    def __setitem__(self,index,value):
        if isinstance(index, int):
            self.expandfor(index)
            return super(dynamic_list,self).__setitem__(index,value)

        elif isinstance(index, slice):
            if index.stop<index.start:
                return super(dynamic_list,self).__setitem__(index,value)
            else:
                self.expandfor(index.stop if abs(index.stop)>abs(index.start) else index.start)
            return super(dynamic_list,self).__setitem__(index,value)

    def expandfor(self,index):
            rng = []
            if abs(index)>len(self)-1:
                if index<0:
                    rng = xrange(abs(index)-len(self))
                    for i in rng:
                        self.insert(0,self_num_gen.next())
                else:
                    rng = xrange(abs(index)-len(self)+1)
                    for i in rng:
                        self.append(self._num_gen.next())

# Usage
spec_list = matlab_list()
spec_list[5] = 14 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-13T14:25:02.517

这不是你想要的，但是......

```
x = np.array([1, 2])

try:
    x[index] = value
except IndexError:
    oldsize = len(x)   # will be trickier for multidimensional arrays; you'll need to use x.shape or something and take advantage of numpy's advanced slicing ability
    x = np.resize(x, index+1) # Python uses C-style 0-based indices
    x[oldsize:index] = 0 # You could also do x[oldsize:] = 0, but that would mean you'd be assigning to the final position twice.
    x[index] = value

>>> x = np.array([1, 2])
>>> x = np.resize(x, 5)
>>> x[2:5] = 0
>>> x[4] = 3
>>> x
array([1, 2, 0, 0, 3]) 
```

由于 numpy 如何在后台线性存储数据（尽管在创建数组时可以指定它是以行为主还是以列为主），多维数组在这里非常棘手。

```
>>> x = np.array([[1, 2, 3], [4, 5, 6]])
>>> np.resize(x, (6, 4))
array([[1, 2, 3, 4],
       [5, 6, 1, 2],
       [3, 4, 5, 6],
       [1, 2, 3, 4],
       [5, 6, 1, 2],
       [3, 4, 5, 6]]) 
```

你需要这样做或类似的事情：

```
>>> y = np.zeros((6, 4))
>>> y[:x.shape[0], :x.shape[1]] = x
>>> y
array([[ 1.,  2.,  3.,  0.],
       [ 4.,  5.,  6.,  0.],
       [ 0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.]]) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T15:54:56.063

python dict 可以作为稀疏数组很好地工作。主要问题是初始化稀疏数组的语法不会那么漂亮：

```
listarray = [100,200,300]
dictarray = {0:100, 1:200, 2:300} 
```

但之后插入或检索元素的语法是相同的

```
dictarray[5] = 2345 
```

# php - 将用户生成的表单内容保存为服务器上的 PDF

> ID：11472340
> 
> 赞同：1
> 
> 时间：2012-07-13T14:18:46.143
> 
> 标签：php, html, pdf, pdf-generation

我有一些从表单生成的报告。我需要在提交时将此表单自动保存在服务器上。有什么办法吗？

我尝试研究这个主题，但谷歌只是抛出了用户必须输入 URL 并按提交或类似方法的链接。由于这个 pdf 应该在每次提交表单后自动生成并保存，我想最好的方法是调用服务等来生成 PDF，然后将其保存在服务器上。你能不能给我一个演练。在此先感谢。

我正在使用 PHP。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:49:02.410

这是来自 php.net 的 pdf 文档。这一切都在那里。祝你好运！ [PDF - 手册](http://us.php.net/manual/en/book.pdf.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:27:25.983

我即将踏上同样的旅程，因为我需要创建一个脚本以使用 PHP 将文档转换为 .pdf 文件。我还不是很了解它，但它似乎是可能的。试试这个链接的初学者... [http://www.sitepoint.com/generate-pdfs-php/](http://www.sitepoint.com/generate-pdfs-php/)

# javascript - 如何将表单数据发送到电子表格。大号

> ID：11472342
> 
> 赞同：0
> 
> 时间：2012-07-13T14:18:46.823
> 
> 标签：javascript, jquery

大家早上好，

我有一个做网站的表格，但表格只发送一个网站填写的信息：http: [//submit.jotformz.com/submit/21933800226649/](http://submit.jotformz.com/submit/21933800226649/)，我希望填写的数据应该保存在一个电子表格。xls，每次有人填写并发送新信息时，都会从第 10 行自动添加。

我的表格代码是这样的：

```
 <script src="http://max.jotfor.ms/min/g=jotform?3.0.3715" type="text/javascript"></script>
<script type="text/javascript">
   JotForm.init();
</script>
<link href="http://max.jotfor.ms/min/g=formCss?3.0.3715" rel="stylesheet" type="text/css" />
<link type="text/css" rel="stylesheet" href="http://jotformz.com/css/styles/nova.css?3.0.3715" />
<style type="text/css">
    .form-label{
        width:150px !important;
    }
    .form-label-left{
        width:150px !important;
    }
    .form-line{
        padding-top:12px;
        padding-bottom:12px;
    }
    .form-label-right{
        width:150px !important;
    }
    .form-all{
        width:690px;
        color:#555 !important;
        font-family:'Lucida Grande';
        font-size:14px;
    }
</style>

<form class="jotform-form" action="http://submit.jotformz.com/submit/21933800226649/" method="post" name="form_21933800226649" id="21933800226649" accept-charset="utf-8">
  <input type="hidden" name="formID" value="21933800226649" />
  <div class="form-all">
    <ul class="form-section">
      <li class="form-line" id="id_1">
        <label class="form-label-left" id="label_1" for="input_1"> Nome: </label>
        <div id="cid_1" class="form-input">
          <input type="text" class="form-textbox" id="input_1" name="q1_nome" size="20" />
        </div>
      </li>
      <li class="form-line" id="id_3">
        <label class="form-label-left" id="label_3" for="input_3"> Opções </label>
        <div id="cid_3" class="form-input">
          <div class="form-single-column"><span class="form-radio-item" style="clear:left;"><input type="radio" class="form-radio" id="input_3_0" name="q3_opcoes" value="Opção 1" />
              <label for="input_3_0"> Opção 1 </label></span><span class="clearfix"></span><span class="form-radio-item" style="clear:left;"><input type="radio" class="form-radio" id="input_3_1" name="q3_opcoes" value="Opção 2" />
              <label for="input_3_1"> Opção 2 </label></span><span class="clearfix"></span><span class="form-radio-item" style="clear:left;"><input type="radio" class="form-radio" id="input_3_2" name="q3_opcoes" value="Opção 3" />
              <label for="input_3_2"> Opção 3 </label></span><span class="clearfix"></span>
          </div>
        </div>
      </li>
      <li class="form-line" id="id_5">
        <label class="form-label-left" id="label_5" for="input_5"> Comentarios </label>
        <div id="cid_5" class="form-input">
          <textarea id="input_5" class="form-textarea" name="q5_comentarios" cols="40" rows="6"></textarea>
        </div>
      </li>
      <li class="form-line" id="id_4">
        <label class="form-label-left" id="label_4" for="input_4"> Idioma </label>
        <div id="cid_4" class="form-input">
          <select class="form-dropdown" style="width:150px" id="input_4" name="q4_idioma">
            <option>  </option>
            <option value="Portugues"> Portugues </option>
            <option value="Ingles"> Ingles </option>
          </select>
        </div>
      </li>
      <li class="form-line" id="id_2">
        <div id="cid_2" class="form-input-wide">
          <div style="margin-left:156px" class="form-buttons-wrapper">
            <button id="input_2" type="submit" class="form-submit-button">
              Enviar
            </button>
          </div>
        </div>
      </li>
      <li style="display:none">
        Should be Empty:
        <input type="text" name="website" value="" />
      </li>
    </ul>
  </div>
  <input type="hidden" id="simple_spc" name="simple_spc" value="21933800226649" />
  <script type="text/javascript">
  document.getElementById("si" + "mple" + "_spc").value = "21933800226649-21933800226649";
  </script>
</form> 
```

我只需要一些简单的东西..有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T15:18:43.263

如何在 PHP中[读取表单信息](http://www.tizag.com/phpT/forms.php/)

如何在 PHP 中将[信息写入 Excel 电子表格](http://www.lateralcode.com/excel-spreadsheets-php/)

# c# - 正则表达式排除除字母以外的所有字符

> ID：11472343
> 
> 赞同：3
> 
> 时间：2012-07-13T14:18:47.560
> 
> 标签：c#, regex

我是一个真正的正则表达式 n00b，所以我请求你的帮助：我需要一个正则表达式，只匹配字母和数字，排除标点、非 ascii 字符和空格。

“ilikestackoverflow2012”将是一个有效的字符串。

“ ***f### 你°§è*** ”无效。

“***你好世界***”无效

“ ***hello-world*** ”和“ ***hello_world*** ”无效

等等。

我需要它来使可能复杂的企业名称 url 友好。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:22:23.590

要验证字符串，您可以使用以下正则表达式`Regex.IsMatch`：

```
"^[0-9A-Za-z]+$" 
```

解释：

*   `^`是字符串[锚](http://www.regular-expressions.info/anchors.html)的开始。
*   `[...]`是一个[字符类](http://www.regular-expressions.info/charclass.html)。
*   `+`表示一个或多个。
*   `$`是字符串锚的末端。

* * *

> 我需要它来使可能复杂的企业名称 url 友好

然后你想替换不匹配的字符。`Regex.Replace`与以下正则表达式一起使用：

```
"[^0-9A-Za-z]+" 
```

解释：

*   `[^...]`是一个否定字符类。

代码：

```
string result = Regex.Replace(input, "[^0-9A-Za-z]+" , ""); 
```

在线查看它：[ideone](http://ideone.com/ZSDbb)

* * *

请注意，不同的企业名称可能会给出相同的结果字符串。例如，名称仅包含中文字符的企业都将给出空字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T14:22:50.753

```
^[0-9a-zA-Z]+$ 
```

匹配一个或多个不带空格或非字母字符的字母数字字符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-13T14:24:10.117

您可以使用下面的正则表达式。

`^[a-zA-Z0-9]+$`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-13T14:24:58.783

你不需要正则表达式。

```
string s = "......"
var isValid = s.All(Char.IsLetterOrDigit); 
```

-

> 我需要它来使可能复杂的企业名称 url 友好

你也可以使用`HttpUtility.UrlEncode`

```
var urlFriendlyString = HttpUtility.UrlEncode(yourString); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-13T14:22:03.467

尝试

```
^[a-zA-Z0-9]+$ 
```

[www.regexr.com](http://www.regexr.com)是一个很棒的资源。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-13T14:24:18.213

有什么问题`[:alnum:]`？这是一个posix标准。所以你的整个正则表达式将是：`^[:alnum:]+$`.

[正则表达式的维基百科文章](https://en.wikipedia.org/wiki/Regular_expression)包含大量示例和详细信息。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-07-13T14:25:08.713

试试这个：

```
var regex = new Regex(@"^[a-zA-Z0-9]+$");
var test = new[] {"ilikestack", "hello world", "hello-world", "###"};

foreach (var s in test)
   Console.WriteLine("{0}: {1}", s, regex.IsMatch(s)); 
```

**编辑：**如果你想要像@Andre_Miller 所说的那样，你应该使用与 Regex.Replace(); 相同的正则表达式；

```
Regex.Replace(s, @"[^a-zA-Z0-9]+", "") 
```

或者

```
var regex = new Regex(@"^[a-zA-Z0-9]+$");
regex.Replace("input-string-@#$@#"); 
```

# sql-server-2008 - 无法通过命令行实用程序登录到 SQL Server 2008

> ID：11472346
> 
> 赞同：2
> 
> 时间：2012-07-13T14:18:57.420
> 
> 标签：sql-server-2008

我已经安装了 SQL Server 2008 Management Studio 并且能够通过它登录到数据库。我还安装了 SQL 命令实用程序。但是，我无法通过命令实用程序登录。我收到以下错误：

```
C:\Users\Administrator>sqlcmd
HResult 0x274D, Level 16, State 1
TCP Provider: No connection could be made because the target machine actively re
fused it. 
```

> Sqlcmd：错误：Microsoft SQL Server Native Client 10.0：建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。检查实例名称是否正确以及 SQL Server 是否配置为允许远程连接。有关详细信息，请参阅 SQL Server 联机丛书。 Sqlcmd：错误：Microsoft SQL Server Native Client 10.0：登录超时已过期。

我尝试使用以下方式明确给出服务器名称、用户名和密码：

```
sqlcmd -S <hostname\database instance> -U <user> -P <pwd> 
```

这也无济于事。

我需要这个命令实用程序来处理我的自动化工作。请帮我！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:24:15.727

乍一看，在我看来，您的 SQL Server Management Studio 正在通过不同的网络库（例如 Named Pipes）进行连接，而 sqlcmd 客户端正在尝试通过 TCP 连接，而服务器并未在那里侦听（或者可能在非标准端口）。这就是您在后一种情况下收到 TCP 错误的原因。

# asp.net - 在 Entity Framework 4.0 中保存数据时出现异常

> ID：11472348
> 
> 赞同：0
> 
> 时间：2012-07-13T14:19:06.233
> 
> 标签：asp.net, entity-framework, c#-4.0

**例外**：

> 无法更新 EntitySet 'Audit_Log'，因为它有一个 DefiningQuery 并且元素中不存在支持当前操作的元素。

我是这样使用的

```
Audit_LogEntity ale = new Audit_LogEntity();`

MemoryStream ms = new MemoryStream();
NetDataContractSerializer serialize = new NetDataContractSerializer();

serialize.Serialize(ms, obj);            

Audit_Log al = new Audit_Log();
al.Object = ms.ToArray();
al.DateTime = DateTime.Now;
al.Page_Name = pagename;
al.Pageid = uniqueid;
al.UserId = userid;

ale.AddToAudit_Log(al);

ale.SaveChanges(); 
```

# symfony - 为什么在 Symfony2 中 $form->isValid() 返回 true，而其中一个约束返回 false？

> ID：11472351
> 
> 赞同：1
> 
> 时间：2012-07-13T14:19:22.363
> 
> 标签：symfony, symfony-forms

我有一个简单的类约束验证器，它在我的实体中被正确引用，当我基于实体验证我的表单时，我可以看到它被调用并返回**false**`$form->isValid()` ，但返回**true**。

知道为什么会这样吗？当然，任何返回 false 的约束都应该导致表单无效？

实体：

```
* @ACMEAssert\ExampleConstraint() 
```

ACME约束：

```
**
 * @Annotation
 */
class ExampleConstraint extends Constraint
{
    public function validatedBy()
    {
        return 'acme.example.validator.example';
    }

    public function getTargets()
    {
        return Constraint::CLASS_CONSTRAINT;
    }
} 
```

ACME验证器：

```
class ExampleValidator extends ConstraintValidator
{
    public function isValid($entity, Constraint $constraint)
    {
        return false;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:35:46.790

试试这个：设置错误消息（违规）：

```
$this->context->addViolation('bar', array(), null); 
```

# android - 打开/关闭调试的最佳方法

> ID：11472360
> 
> 赞同：1
> 
> 时间：2012-07-13T14:19:58.877
> 
> 标签：android, debugging

我的场景如下：我有一个远程服务，任何应用程序都可以通过 Messenger 与之通信。应用程序发送我定义的自定义事件。每个事件都定义了一个要执行的“动作”（类似于 Android 的`Intent`）。为了测试服务发送和处理的事件，我想设置一个新的事件动作（例如`EventAction.DEBUG`），但我不希望这个动作和处理它的代码出现在版本中，.

这就是我的想法：

*   使用`final static boolean`变量有条件地执行代码。由于硬编码变量，我不喜欢这个。
*   从配置文件中读取调试状态。这很慢，而且编译器也会生成代码来处理调试，因此会产生无用的比较。
*   在启动时将调试标志传递给应用程序。我忽略了如何在 Android 中做到这一点，或者即使这是可能的。另外我认为这也会使编译器生成调试代码。

您认为实现此行为的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T14:34:02.170

一个`final static`。ProGuard 将删除未使用的代码。

关于配置文件的值——如果它在运行时永远不会改变，它只是“无用的”，并且与应用程序的其余部分相比，比较并没有那么慢，真的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T14:44:08.023

Android 的 ADT 版本 17 及更高版本已包含一个 BuildConfig.DEBUG 变量，在导出已签名的 APK（用于发布）时该变量设置为 false。

# php - php中字符串的剩余单词

> ID：11472361
> 
> 赞同：1
> 
> 时间：2012-07-13T14:19:59.000
> 
> 标签：php, string, words

我有一段代码显示了我网页上的前 20 个单词。

```
$arrtext = explode( ' ', stripslashes( str_replace('\n',chr(10),str_replace('\r',chr(13),$row['text']))), $config['length_story'] + 1);

$arrtext[ $config['length_story'] ] = '';

$row['headtext'] = trim(implode( ' ', $arrtext)) . '...'; 
```

这很好用，但我也想显示剩余文本而不重复前 20 个单词，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:24:30.257

就个人而言，我会做这样的事情：

```
$story = $row['text']; // apply whatever here, `stripslashes`, `sre_replace`...
preg_match("/^((?:\S+\s+){20})(.*)$/",$story,$match);
if( $match)
    $result = Array($match[1],$match[2]);
else
    $result = Array($story,""); 
```

现在`$result`包含两个元素：第一个元素是故事的前20个字，第二个是后面的一切。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T14:27:06.510

无需重写任何内容，只需保存

```
$arrtext[ $config['length_story'] ] = ''; 
```

在覆盖它之前。它已经包含剩余的文本

```
$remaining = $arrtext[ $config['length_story'] ];
$arrtext[ $config['length_story'] ] = ''; 
```

# sql - SQL Server 备份（不是还原！）错误：媒体集有 2 个媒体系列，但只提供了 1 个。必须提供所有成员

> ID：11472366
> 
> 赞同：0
> 
> 时间：2012-07-13T14:20:20.457
> 
> 标签：sql, sql-server-2005, backup, database-backups

尝试备份数据库时遇到此错误：

> “媒体集有 2 个媒体族，但只提供了 1 个。必须提供所有成员。”

请注意，这是备份而不是恢复。

RESTORE 有很多关于此错误的主题，但我没有找到任何有关 BACKUP 的主题。

我在 Sql Server 2005 上使用这个 T.SQL：

```
backup database dtplog
TO DISK='e:\dtplog.bak' 
```

所以看起来 SQL Server 有某种设置，指定了该数据库的多个备份设备。

对于某些数据库，我没有收到此错误，但对于某些我有。

知道发生了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T11:01:34.727

这仅适用于所有数据库备份

```
DECLARE @name VARCHAR(50) -- database name  
DECLARE @path VARCHAR(256) -- path for backup files  
DECLARE @fileName VARCHAR(256) -- filename for backup  
DECLARE @fileDate VARCHAR(20) -- used for file name 

SET @path = 'C:\Backup\'  

SELECT @fileDate = CONVERT(VARCHAR(20),GETDATE(),112) 

DECLARE db_cursor CURSOR FOR  
SELECT name 
FROM master.dbo.sysdatabases 
WHERE name NOT IN ('master','model','msdb','tempdb')  

OPEN db_cursor   
FETCH NEXT FROM db_cursor INTO @name   

WHILE @@FETCH_STATUS = 0   
BEGIN   
       SET @fileName = @path + @name + '_' + @fileDate + '.BAK'  
       BACKUP DATABASE @name TO DISK = @fileName  

       FETCH NEXT FROM db_cursor INTO @name   
END   

CLOSE db_cursor   
DEALLOCATE db_cursor 
```

# asp.net-mvc-3 - 创建按钮单击功能在 mvc3 中不起作用？

> ID：11472384
> 
> 赞同：0
> 
> 时间：2012-07-13T14:21:22.043
> 
> 标签：asp.net-mvc-3, c#-4.0

大家好，我有一个表格，我有一个添加新项目链接...当我点击它时，它会将我带到一个创建页面，其中我有用于插入新记录的文本框和一个创建按钮..但我点击创建按钮它不工作任何人都可以帮助我我在哪里做错了这是我的代码

这是我的 create.aspx 页面：

```
 <%: ViewBag.Title="Create" %>

         <fieldset>
       <legend>Projects</legend>

  <div class="editor-label">
        <%: Html.LabelFor(model => model.projectName)%>
    </div>
    <div class="editor-field">
       <%:Html.EditorFor(model => model.projectName)%>
      <%: Html.ValidationMessageFor(model => model.projectName)%>
    </div>

    <div class="editor-label">
       <%:Html.LabelFor(model => model.Description)%>
    </div>
    <div class="editor-field">
       <%:Html.EditorFor(model => model.Description)%>
       <%:Html.ValidationMessageFor(model => model.Description)%>
    </div>
    <div class="editor-label">
    <%:Html.LabelFor(model=>model.status) %>
    </div>
    <div class="editor-field">
    <%:Html.EditorFor(model=>model.status) %>
    <%:Html.ValidationMessageFor(model=>model.status) %>
    </div>
    <p>
        <input type="submit" value="Create" />
    </p>
  </fieldset> 
```

这是我的控制器功能：

```
 public ActionResult Create()
    {
        return View();
    }
    [HttpPost]
    public ActionResult Create(ProjectModel model)
    {
        var modelList = new List<ProjectModel>();
        using (SqlConnection conn = new SqlConnection("Data Source=LMIT-0039;Initial Catalog=BugTracker;Integrated Security=True"))
        {
            conn.Open();                
            SqlCommand insertcommande = new SqlCommand("Sp_AddNewProject", conn);
            insertcommande.CommandType = CommandType.StoredProcedure;
            insertcommande.Parameters.Add("@ProjectName", SqlDbType.VarChar).Value = model.projectName;
            insertcommande.Parameters.Add("@Description", SqlDbType.VarChar).Value = model.Description;
            insertcommande.Parameters.Add("@Status", SqlDbType.VarChar).Value = model.status;
            insertcommande.ExecuteNonQuery();
        }
        return View( modelList);
    } 
```

当我单击aspx页面中的创建按钮时，它应该在我的控制器中创建方法.....我在这里做错了什么............

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T07:03:31.020

我把它放在我的 create.aspx 页面 BeginForm 语句中：

```
 <% using (Html.BeginForm()) { %>
      <form action=”/members/Create” method=”post”&gt;</form> 
```

并添加

```
[AcceptVerbs(HttpVerbs.Get)]
    public ActionResult Create()
{
    return View();
}
[AcceptVerbs(HttpVerbs.post)]
public ActionResult Create(ProjectModel model)
{
    var modelList = new List<ProjectModel>();
    using (SqlConnection conn = new SqlConnection("Data Source=LMIT-0039;Initial Catalog=BugTracker;Integrated Security=True"))
    {
        conn.Open();                
        SqlCommand insertcommande = new SqlCommand("Sp_AddNewProject", conn);
        insertcommande.CommandType = CommandType.StoredProcedure;
        insertcommande.Parameters.Add("@ProjectName", SqlDbType.VarChar).Value = model.projectName;
        insertcommande.Parameters.Add("@Description", SqlDbType.VarChar).Value = model.Description;
        insertcommande.Parameters.Add("@Status", SqlDbType.VarChar).Value = model.status;
        insertcommande.ExecuteNonQuery();
    }
    return View( modelList);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:30:20.447

您的视图中没有`form`。这是一个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T21:10:53.827

访问 MSDN 获取 BeginForm：http: [//msdn.microsoft.com/en-us/library/dd410596.aspx](http://msdn.microsoft.com/en-us/library/dd410596.aspx)

# python - 使用 Django 的隐藏字段流

> ID：11472387
> 
> 赞同：2
> 
> 时间：2012-07-13T14:21:34.227
> 
> 标签：python, django, django-forms, hidden-field

我正在尝试接收一个然后生成一个带有新字段的表单，并将我在之前收到的值作为隐藏变量`POST`传递。`POST`我在文档中进行了大量搜索，但似乎找不到任何连接此流程两侧的内容。我正在使用带有 Python 2.7 的 Django 1.4。

视图.py

```
from django.shortcuts import render_to_response
from gateway_interface.forms import newForm

def requestNewForm(request):
    if (request.method == "POST"):
        form = newForm(request)

        return render_to_response('myTemplate.html', {'form' : form}) 
```

表格.py

```
from django import forms
class newForm(forms.Form):
    def __init__(self, request):
        my_passed_variable = request.POST['pass_variable']

    a_new_variable = forms.CharField(max_length = 25)

    my_passed_variable = forms.CharField(widget = forms.HiddenInput()) 
```

我的模板.html

```
<form action="/myNextDjangoView/" method="post">
    <div class="fieldWrapper">
        I need this value: {{ form.a_new_variable }} <br>
    </div>

    {% for hidden in form.hidden_fields %}
        {{ hidden }}
    {% endfor %}
<input type="submit" value="Submit">
</form> 
```

我一定是在做一些根本错误的事情。如果我在模板中使用 for 循环，则页面上不会显示任何可见字段。我尝试过的任何方法都没有导致隐藏字段填充。

有什么建议么？也许我在某处错过了进口？有什么我需要导入`forms.py`以允许使用的`HiddenInput()`吗？

编辑 1：我已修改`forms.py`为如下所示：

```
form django import forms
class newForm(forms.Form):
    a_new_variable = forms.CharField(max_length = 25)
    my_passed_variable = forms.CharField(widget = forms.HiddenInput())

    def __init__(self, *args, **kwargs):
        super(newForm, self).__init__(*args, **kwargs) 
```

这并没有改变我的输出。我仍然得到相同的表单，没有显示字段（隐藏或可见）。我需要做的是使用初始化字典进行实例化。（我认为？）字典包含所有隐藏字段的名称和值。

```
initial_dict = { 'my_passed_variable' : request.POST.get('pass_variable') }
form = newForm(initial = initial_dict) 
```

编辑2：

使用初始化字典是朝着正确方向迈出的一步！我现在可以看到表单中的可见字段，但隐藏字段仍未填充。

视图.py

```
from django.shortcuts import render_to_response
from gateway_interface.forms import newForm

def requestNewForm(request):
    if (request.method == "POST"):
        initial_dict = { 'my_passed_variable' : request.POST.get('pass_variable') }
        form = newForm(initial = initial_dict)

        return render_to_response('myTemplate.html', {'form' : form}) 
```

编辑 3：

我已经让它工作了。感谢 Jordan Reiter 将我推向了正确的方向。事实证明，问题几乎完全是我的浏览器在`EDIT 1`上面之后的缓存。我切换到 Chrome 的隐身模式，一切正常。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T15:30:17.627

这段代码有一个明确的问题：

```
from django import forms
class newForm(forms.Form):
    def __init__(self, request):
        my_passed_variable = request.POST['pass_variable']

    a_new_variable = forms.CharField(max_length = 25)

    my_passed_variable = forms.CharField(widget = forms.HiddenInput()) 
```

首先，有两个具有相同名称的变量非常令人困惑（尽管其中一个`self.my_passed_variable`在整个表单中都可用，而另一个仅在表单中`my_passed_variable`可用`__init__`）。我不禁认为你试图以某种方式将这两个变量联系在一起，但你不是。最坏/最好的情况（如果您重写`my_passed_variable = request.POST['pass_variable']`为`self.my_passed_variable = request.POST['pass_variable']`），您正在用字符串覆盖表单字段对象的值。

其次，我假设你从`__init__`函数中剪掉了一堆代码。你错过了`super`实际上使它成为一种形式的东西。就目前而言，表单对象不会被正确实例化。

如果您正在尝试做我*认为*您正在尝试做的事情，那么您想以这种方式重写它：

```
from django import forms
class newForm(forms.Form):
    # first, I'm going to put the fields at the top, I think that's more standard
    a_new_variable = forms.CharField(max_length = 25)
    my_passed_variable = forms.CharField(widget = forms.HiddenInput())

    def __init__(self, request, *args, **kwargs):
        super(newForm, self).__init__(*args, **kwargs)
        self.fields['my_passed_variable'].initial = request.POST.get('pass_variable') # don't assume the variable is present! 
```

# c# - 拉绳 onclick 方法 C#

> ID：11472392
> 
> 赞同：2
> 
> 时间：2012-07-13T14:21:48.627
> 
> 标签：c#, onclick, drawstring

我有一些使用 DrawString 绘制的字符串

```
 for (int j = 0; j < dt.Rows.Count; j++)
        {
            e.Graphics.DrawString(Convert.ToString(dt.Rows[j]["ID"]), drawFont, drawBrush, new Point(Convert.ToInt32(dt.Rows[j]["XCord"]), Convert.ToInt32(dt.Rows[j]["YCord"])));
        } 
```

有没有办法为每个拉绳创建一个 onclick 事件？当您单击拉绳时，我希望创建一个新表单。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:24:57.723

不，当你用你渲染东西时，`Graphics`你不能将事件绑定到绘制的对象。

有两种解决方案，您可以在表单（`MouseClick`事件）上捕获鼠标点击并确定鼠标是否在渲染的字符串上（使用获取渲染区域`MeasureString`）。然而，这是不必要的困难和复杂。

相反，我建议在表单上动态生成一个控件。您可以生成一个`Button`，或者，如果您只喜欢表单上文本的样式，`Label`则可以将一个 EventHandler 绑定到他们的`MouseClick`事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T15:12:13.407

处理`MouseClick`容器的事件并通过行枚举找出文本的“矩形”并查看鼠标位置是否在其中：

```
void panel1_MouseClick(object sender, MouseEventArgs e) {
  if (e.Button == MouseButtons.Left) {
    foreach (DataRow dr in dt.Rows) {
      Point p = new Point(Convert.ToInt32(dr["XCord"]), Convert.ToInt32(dr["YCord"]));
      Size s = TextRenderer.MeasureText(dr["ID"].ToString(), panel1.Font);
      if (new Rectangle(p, s).Contains(e.Location)) {
        MessageBox.Show("Clicked on " + dr["ID"].ToString());
      }
    }
  }
} 
```

# python - 寻找例如使用 MediaFileUpload

> ID：11472401
> 
> 赞同：20
> 
> 时间：2012-07-13T14:22:18.113
> 
> 标签：python, google-app-engine, google-drive-api

有谁知道我在哪里可以找到上传本地文件和使用 MediaFileUpload 获取内容的完整示例代码？

我真的需要查看用于发布的 HTML 表单和接受它的代码。我正在拔头发，到目前为止只得到部分答案。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2016-05-24T21:12:48.117

我在试图找出 Google API 示例中的“MediaFileUpload”来自哪里时发现了这个问题，我最终弄明白了。这是一个更完整的代码示例，我用它来测试 Python 2.7。

您需要一个 JSON 凭证文件才能使此代码正常工作。这是您从 Google 应用/项目/事物中获得的凭据文件。

您还需要上传一个文件，我在示例中使用“test.html”。

```
from oauth2client.service_account import ServiceAccountCredentials
from apiclient.discovery import build
from apiclient.http import MediaFileUpload

#Set up a credentials object I think
creds = ServiceAccountCredentials.from_json_keyfile_name('credentials_from_google_app.json', ['https://www.googleapis.com/auth/drive'])

#Now build our api object, thing
drive_api = build('drive', 'v3', credentials=creds)

file_name = "test"
print "Uploading file " + file_name + "..."

#We have to make a request hash to tell the google API what we're giving it
body = {'name': file_name, 'mimeType': 'application/vnd.google-apps.document'}

#Now create the media file upload object and tell it what file to upload,
#in this case 'test.html'
media = MediaFileUpload('test.html', mimetype = 'text/html')

#Now we're doing the actual post, creating a new file of the uploaded type
fiahl = drive_api.files().create(body=body, media_body=media).execute()

#Because verbosity is nice
print "Created file '%s' id '%s'." % (fiahl.get('name'), fiahl.get('id')) 
```

在“body”哈希中使用的有效 Mime 类型列表可在 [https://developers.google.com/drive/v3/web/mime-types获得](https://developers.google.com/drive/v3/web/mime-types)

MediaFileUpload 的有效 mimetype 字符串列表（它们会尝试将您的文件转换为您在此处放置的任何内容）：

[https://developers.google.com/drive/v3/web/integrate-open#open_files_using_the_open_with_contextual_menu](https://developers.google.com/drive/v3/web/integrate-open#open_files_using_the_open_with_contextual_menu)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-03-12T04:49:58.420

Python 2.7，可恢复上传。

[https://github.com/googleapis/google-api-python-client/blob/master/docs/media.md](https://github.com/googleapis/google-api-python-client/blob/master/docs/media.md)

```
from __future__ import print_function
import pickle
import os.path
from googleapiclient.http import MediaFileUpload
from googleapiclient.discovery import build
from google_auth_oauthlib.flow import InstalledAppFlow
from google.auth.transport.requests import Request

# If modifying these scopes, delete the file token.pickle.
SCOPES = ['https://www.googleapis.com/auth/drive']

def main():
    """Shows basic usage of the Drive v3 API.
    Prints the names and ids of the first 10 files the user has access to.
    """
    creds = None
    # The file token.pickle stores the user's access and refresh tokens, and is
    # created automatically when the authorization flow completes for the first
    # time.
    if os.path.exists('token.pickle'):
        with open('token.pickle', 'rb') as token:
            creds = pickle.load(token)
    # If there are no (valid) credentials available, let the user log in.
    if not creds or not creds.valid:
        if creds and creds.expired and creds.refresh_token:
            creds.refresh(Request())
        else:
            flow = InstalledAppFlow.from_client_secrets_file(
                'credentials.json', SCOPES)
            creds = flow.run_local_server(port=0)
        # Save the credentials for the next run
        with open('token.pickle', 'wb') as token:
            pickle.dump(creds, token)

    service = build('drive', 'v3', credentials=creds)

    media = MediaFileUpload(
        'big.jpeg',
        mimetype='image/jpeg',
        resumable=True
    )
    request = service.files().create(
        media_body=media,
        body={'name': 'Big', 'parents': ['<your folder Id>']}
    )
    response = None
    while response is None:
        status, response = request.next_chunk()
        if status:
            print("Uploaded %d%%." % int(status.progress() * 100))
    print("Upload Complete!")

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T23:33:40.853

您不需要自己发布 JSON，客户端库会为您处理。

我们已经提供了完整的代码示例，可以在这里找到：[https ://github.com/gsuitedevs/python-samples](https://github.com/gsuitedevs/python-samples)

您还可以查看包含 Python 示例的 file.insert 参考文档：[https ://developers.google.com/drive/v2/reference/files/insert](https://developers.google.com/drive/v2/reference/files/insert)

如果这不能回答您想要的，也许您可​​以更详细地解释您想要实现的目标以及您当前的架构。

# asp.net - 如何在不使用其 id 标签的情况下修改单选按钮的属性

> ID：11472403
> 
> 赞同：1
> 
> 时间：2012-07-13T14:22:21.317
> 
> 标签：asp.net, vb.net

我需要通过一个循环并检查正确的单选按钮。我有多个以`rb`颜色命名的单选按钮，例如“rbGreen，rbRed，rbYellow ...”

这是我背后的代码：（listColors 是字符串列表）

```
 Private Sub selectColor(color As String)
    Dim i As Integer
    For i = 0 To listColors.Count - 1 
        If listColors(i) = color Then
            Dim rb As RadioButton = TryCast(Page.FindControl("rb" & color), RadioButton)
            rb.Checked = True
        End If
    Next i
End Sub 
```

在调试时，我得到一个错误，因为 rb 什么都不是......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:25:33.097

我的猜测是，有`RadioButton`问题的 s 实际上并不是 的一部分，`Page`而是基于 a`UserControl`或基于模板的控件（例如 a `Repeater`）的一部分。

如果是这样，那么您需要修改代码以使用`FindControl`包含相关`RadioButton`s 的控件的 。

如果这是在`UserControl`最简单的事情之内，那就是......

```
Me.FindControl("rb" & color) 
```

# java - 通过代码从当前运行的 JAR 中提取文件

> ID：11472408
> 
> 赞同：14
> 
> 时间：2012-07-13T14:22:31.023
> 
> 标签：java, file, jar, io, extract

我可以使用任何内置方法来允许用户从当前运行的 JAR 中提取文件并将其保存在他们的磁盘上吗？

提前致谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-09-08T02:27:57.420

```
File file = new File("newname.ext");
if (!file.exists()) {
     InputStream link = (getClass().getResourceAsStream("/path/resources/filename.ext"));
     Files.copy(link, file.getAbsoluteFile().toPath());
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-13T14:24:10.653

使用[`getResourceAsStream`(docs)](http://docs.oracle.com/javase/6/docs/api/java/lang/Class.html#getResourceAsStream%28java.lang.String%29)，之后你可以用它做任何你想做的事情。

对于两行，您可以使用[Commons IO 复制方法之一](https://commons.apache.org/proper/commons-io/javadocs/api-2.5/org/apache/commons/io/FileUtils.html#copyInputStreamToFile(java.io.InputStream,%20java.io.File))。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T14:26:19.440

我不确定您是否会知道您的类正在从哪个 jar 执行，但您可以尝试从 jar 中提取资源： [如何编写一个 Java 程序，该程序可以提取 JAR 文件并将其数据存储在指定目录（位置） ?](https://stackoverflow.com/questions/1529611/how-to-write-a-java-program-which-can-extract-a-jar-file-and-store-its-data-in-s)

# php - 带有标头功能的 HTTP 重定向不起作用

> ID：11472410
> 
> 赞同：0
> 
> 时间：2012-07-13T14:22:32.577
> 
> 标签：php, http-headers

`header("Location: …" );`似乎没有工作：

```
<?php
session_start();
if (isset($_SESSION['user'])){ 
?>
<html>
<head>
    <title>
    Admin Panel
    </title>
</head>
<body>

 </body
</html>
<?php
} else {
    header("Location: http://echo2.site40.net/cms/admin/login.php" );
 }
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:27:09.777

如果我完全复制粘贴代码，似乎可以工作......

在开始之前仍然寻找空白`<?php`

# php - PHP LINKQ 失败

> ID：11472414
> 
> 赞同：0
> 
> 时间：2012-07-13T14:22:45.180
> 
> 标签：php, linq

这行代码位于 Php Linq LinqToObjects 示例中：

```
$names = array("John", "Peter", "Joe", "Patrick", "Donald", "Eric");
echo 'elementAt(2): ' . from('$name')->in($names)->elementAt(2) . "\r\n"; 
```

并提出这个错误

```
Message: array_shift() expects parameter 1 to be array, string given
Filename: PHPLinq/LinqToObjects.php
Line Number: 669 
```

Php linkq 很旧（2009 年），在我的 5.3.2 版本中可能无法正常工作

我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T16:52:40.060

我通过更改 PHPLinq/LinqToObjects.php 第 669 行来修复它

```
if (count($result) > 0) {
    return array_shift($result);
    } 
```

白衣：

```
if (count($result) > 0) {
            if(is_array($result)){
        return array_shift($result);
            }else{
                return $result;
            }
    } 
```

无论如何，图书馆是不受支持的，记录也很差。

# asp.net - 表格内的UpdatePanel对齐问题

> ID：11472416
> 
> 赞同：0
> 
> 时间：2012-07-13T14:22:48.960
> 
> 标签：asp.net, html, asp.net-ajax, updatepanel

我在页面中间使用 UpdatePanel 控件进行地址类型单选按钮更改的部分回发。一切正常，但我正在努力解决对齐问题。UpdatePanel 内的控件与外部控件不对齐。我该如何解决这个问题？请告诉我。

```
<table id="tblEdit" class="cssclass1" cellpadding="3" runat="server">

    <tr>
        <td class="cssclass1" align="right">
            Title
        </td>
        <td>
            <telerik:RadTextBox ID="textbox1" runat="server" Width="280px" ReadOnly="true"
                BackColor="LightGray" />
        </td>
         <td align="right">
            <asp:Label CssClass="cssclass1" ID="LblFirstName" runat="server">First Name</asp:Label>
        </td>
        <td align="left">
            <telerik:RadTextBox ID="txtFirstName" runat="server" MaxLength="30">
            </telerik:RadTextBox>
            <asp:Image ID="Image1" ImageUrl="../../../images/requiredfield.gif" AlternateText="Required Field"
                runat="server"></asp:Image><asp:HiddenField ID="hfCaseEntityId" runat="server" />
        </td>
    </tr>
<tr>
<td colspan="4">

 <asp:UpdatePanel ID="UpdatePanel1" runat="server">
   <ContentTemplate>

    <tr>
        <td class="cssclass1" align="right">
            Address Type 
        </td>
        <td align="left">
            <asp:RadioButtonList ID="AddressType" runat="server" RepeatDirection="Horizontal" OnSelectedIndexChanged="AddressType_SelectedIndexChanged" AutoPostBack="true"  >
                <asp:ListItem Value="1" Selected="True">Home</asp:ListItem>
                <asp:ListItem Value="2">Work</asp:ListItem>
            </asp:RadioButtonList>
        </td>
        <td class="cssclass1" align="right">
        </td>
        <td align="left">
        </td>
    </tr>
    <tr>
        <td align="right">
            <asp:Label CssClass="cssclass1" ID="LblHomeStreet1" runat="server">Address</asp:Label>
        </td>

        <td align="left">
            <telerik:RadTextBox ID="txtHomeStreet1" runat="server" MaxLength="40" >
            </telerik:RadTextBox>
            <asp:Image ID="Image10" ImageUrl="../../../images/requiredfield.gif" AlternateText="Required Field"
                runat="server"></asp:Image>
        </td>
        <td align="right">
            <asp:Label CssClass="cssclass1" ID="LblHomeStreet2" runat="server">Street 2</asp:Label>
        </td>
        <td align="left">
             <telerik:RadTextBox ID="txtHomeStreet2" runat="server" MaxLength="40" Width="280px">
            </telerik:RadTextBox>
        </td>
    </tr>
    <tr>
        <td align="right">
            <asp:Label CssClass="cssclass1" ID="LblHomeCity" runat="server">City</asp:Label>
        </td>
        <td align="left">
            <telerik:RadTextBox ID="txtHomeCity" runat="server" MaxLength="30">
            </telerik:RadTextBox>
        </td>
        <td align="right">
            <asp:Label CssClass="cssclass1" ID="LblHomeState" runat="server">State</asp:Label>
        </td>
        <td align="left">
 <telerik:RadTextBox ID="txtHomeState" runat="server" MaxLength="30">
            </telerik:RadTextBox>
        </td>
    </tr>
      </ContentTemplate>
</asp:UpdatePanel>
</td>
</tr>
</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:27:07.380

您的 HTML 无效。您的第一行`<ContentTemplate>`是 a `<tr>`，但是，您似乎正试图在其中包含另一行`<table>`。您可能想查看内表上的 cellpading=0 和 cellspacing=0 。此外，您可以将 CSSClass 添加到 UpdatePanel 以进行任何其他格式化。

# javascript - 拉力赛：团队状态信息未获取所有需要的信息

> ID：11472420
> 
> 赞同：1
> 
> 时间：2012-07-13T14:22:54.590
> 
> 标签：javascript, rally

我一直在尝试根据迭代获取一些信息，例如用户名、显示名称、角色和容量。查询返回指定项目的部分结果，但不是所选迭代的全部结果。我不确定是什么原因造成的。你可以在下面找到我的工作。

```
function iterationSelected(dropdown, eventArgs) {

     console.log("Iteration Selected Callback");
     if(table != null){
        table.destroy();
     }

    var queryByUser = {
        key: "teamDataByUser", type: "User", 
        fetch: 'DisplayName,UserName',
        query: '(ObjectID > 0)'
    };
    rallyDataSource.findAll(queryByUser, queryTeamInformation);

}

function queryTeamInformation(results){
    console.log(results.teamDataByUser.length);
    for(var i=0;i<results.teamDataByUser.length;i++){
        console.log(results.teamDataByUser[i].UserName + " " + results.teamDataByUser[i].DisplayName);
    }

    console.log(iterationDropdown.getSelectedName());
    var queryByUserName = {
        key: "teamData", type: "UserIterationCapacity", 
        project: null,
        fetch: "Capacity,User,Role,EmailAddress,DisplayName,UserName",
        query: '((Iteration.Name = ' + '"' + iterationDropdown.getSelectedName() + '") AND (Project = /project/5564891653))'
    };
    rallyDataSource.findAll(queryByUserName, processResults);
    console.log("GH");

}

function processResults(results){
    rally.forEach(results.teamData, 
    function(teamData) {
        console.log(teamData._ref);

    });
    console.log(results.teamData.length);

        var tableDiv = document.getElementById('table');
        var config = { columns: 
             [{key: 'emailaddress', header: 'Team Member Email', width: 200}, 
             {key: 'displayname', header: 'Display name'},
             {key: 'username', header: 'User name'},
             {key: 'role', header: 'Role'},
             {key: 'cap', header: 'Capacity'}] };

        if(table != null){
            console.log("Got here");
            table.destroy();
        }
        table = new rally.sdk.ui.Table(config);
        for(var i=0;i<results.teamData.length;i++){

            var rowInfo = {'emailaddress': results.teamData[i].User.DisplayName, 'displayname': results.teamData[i].User.UserName, 'username': results.teamData[i].User.EmailAddress, 'role' : results.teamData[i].User.Role, 'cap' : results.teamData[i].Capacity}; 
            table.addRow(rowInfo);
        }

        table.display(tableDiv);

}

//========================================================================================================================
/*
 * Initializes all the page elements
 */
function initPage() {

    rallyDataSource = new rally.sdk.data.RallyDataSource('5410787910', '5948174836', 'false', 'true'); 

    var config = { label : "Select an iteration " };
    iterationDropdown = new rally.sdk.ui.IterationDropdown(config, rallyDataSource);
    iterationDropdown.display("aDiv", iterationSelected);
}
 rally.addOnLoad(initPage); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T01:08:43.290

好的 - 我写了一个例子，我认为它说明了到达你想去的地方需要什么。它通过在 queryConfig 数组中执行两个查询来做到这一点：一个用于用户，另一个用于 UserIterationCapacity，用于感兴趣的迭代。然后，在 processResults 函数中，代码构造了三个哈希：

*   `teamMembersByTeamName`：每个项目的团队成员字符串，hashkey：团队/项目名称
*   `myTeamList`：包含来自用户（第一个）查询的用户数据，为感兴趣的团队选择，hashkey：用户名
*   `userIterationCapacityByUser`: 包含来自第二个查询的 UserIterationCapacity 数据，hashkey: UserName

最后，代码通过 UserName 进行交叉遍历，为所有 TeamMember 重新构建容量数据，即使他们没有为感兴趣的 Sprint 定义容量。如果是这种情况，容量将显示为“N/A”。

您需要自定义`workspaceOID`、`projectOID`和`myTeamSlashProjectName`变量以使其在您的环境中工作。您可能想要自定义和调整 - 这只是一个粗略的代码示例。但希望足以说明这个概念。

```
 <!-- Copyright (c) 2012 Rally Software Development Corp. All rights reserved -->
    <html>
    <head>
       <title>Team Capacity Summary Example</title>
       <meta name="Name" content="App Example: Team Capacity Summary" />
       <meta name="Version" content="1.31" />
       <meta name="Vendor" content="Rally Labs" />

       <script type="text/javascript" src="https://rally1.rallydev.com/apps/1.31/sdk.js"></script>
       <script type="text/javascript">

       var rallyDataSource = null;
       var iterationDropdown = null;
       var selectedIteration = "Iteration 1";
       var workspaceOID = "12345678910";
       var projectOID = "12345678911";
       var myTeamSlashProjectName = "My Project";
       var table;

        function iterationSelected(dropdown, eventArgs) {
              var selectedItem = eventArgs.item;
              selectedIteration = eventArgs.value;
              runMainQuery();
        }

        function runMainQuery() {

            var queryConfig = [];

            var capacityQueryString = '((Iteration.Name = ' + '"' + 
                    selectedIteration + 
                    '") AND (Project.ObjectID = "' + 
                    projectOID +
                     '"))';
            console.log(capacityQueryString);

            queryConfig[0] = {
                key: "usercapacities", 
                type: "UserIterationCapacity", 
                fetch: "Capacity,User,Role,EmailAddress,DisplayName,UserName",
                query: capacityQueryString
            };

            queryConfig[1] = {
                type: "users",
                key:  "userdata",
                fetch: "UserName,EmailAddress,DisplayName,UserName,UserPermissions,Project,Role,Name,TeamMemberships,Project,Name"
            };          

            rallyDataSource.findAll(queryConfig, processResults);

        }

        function processResults(results) {      

            // Populate a hash of team members by team name 
            var teamMembersByTeamName= new Array();

            for (i=0;i<results.userdata.length;i++){
                myUser = results.userdata[i];
                myUserName = myUser.UserName;
                myEmailAddress = myUser.EmailAddress;
                myDisplayName = myUser.DisplayName;
                myRole = "N/A";

                if (myUser.TeamMemberships) {

                    myTeamMemberships = myUser.TeamMemberships;

                    for (j=0;j<myTeamMemberships.length;j++) {
                        thisTeam = myTeamMemberships[j];
                        thisTeamName = thisTeam.Name;

                        if (!(thisTeamName in teamMembersByTeamName)) {
                            teamMembersByTeamName[thisTeamName] = [];
                        }

                        var dataToPush = new Array();
                        dataToPush["UserName"] = myUserName;
                        dataToPush["EmailAddress"] = myEmailAddress;
                        dataToPush["DisplayName"] = myDisplayName;
                        dataToPush["Role"] = myRole;
                        dataToPush["Capacity"] = "N/A";

                        teamMembersByTeamName[thisTeamName].push(dataToPush);
                    }
                }
            }

            // Now populate a hash of User Capacities

            var userIterationCapacityByUser = new Array();

            for (i=0;i<results.usercapacities.length;i++) {
                thisCapacityObject = results.usercapacities[i];
                thisUserName = thisCapacityObject.User.UserName;
                if (!(thisUserName in userIterationCapacityByUser)) {

                    thisUser = thisCapacityObject.User;
                    thisCapacity = thisCapacityObject.Capacity;

                    userIterationCapacityByUser[thisUserName] = [];

                    var dataToPush = new Array();
                    dataToPush["UserName"] = thisUser.UserName;
                    dataToPush["EmailAddress"] = thisUser.EmailAddress;
                    dataToPush["DisplayName"] = thisUser.DisplayName;
                    dataToPush["Role"] = thisUser.Role;
                    dataToPush["Capacity"] = thisCapacity;

                    userIterationCapacityByUser[thisUserName].push(dataToPush);             
                }
            }

            // Setup and configure the table
            var tableDiv = document.getElementById('tableDiv');
            var tableConfig = { columns: 
                 [{key: 'emailaddress', header: 'Team Member Email', width: 200}, 
                 {key: 'displayname', header: 'Display name'},
                 {key: 'username', header: 'User name'},
                 {key: 'role', header: 'Role'},
                 {key: 'cap', header: 'Capacity'}] };

            if(table != null){
                table.destroy();
            }

            table = new rally.sdk.ui.Table(tableConfig);        

            // Finally cross-walk team membership by correlating the data from the two hashes
            // Grab team list of interest
            myTeamList = teamMembersByTeamName[myTeamSlashProjectName];

            for(i=0;i<myTeamList.length;i++) {

                myTeamMemberData = myTeamList[i];
                myUserNameFromTeamList = myTeamMemberData["UserName"];

                // User has capacity information - populate data from that result set
                if (myUserNameFromTeamList in userIterationCapacityByUser) {                
                    myUserDataArray = userIterationCapacityByUser[myUserNameFromTeamList];
                    myUserData = myUserDataArray[0];            
                } // User doesn't have capacity information - populate data from user query
                else {
                    myUserData = myTeamMemberData;
                }

                var myUserName = myUserData["UserName"];
                var myEmailAddress = myUserData["EmailAddress"];
                var myDisplayName = myUserData["DisplayName"];
                var myRole = myUserData["Role"];
                var myCapacity = myUserData["Capacity"];

                if (myDisplayName) { 
                    thisDisplayName = myDisplayName;
                } else {
                    thisDisplayName = "N/A";
                }

                var rowInfo = {
                    'emailaddress': myEmailAddress, 
                    'displayname': thisDisplayName, 
                    'username': myUserName,
                    'role' : myRole, 
                    'cap' : myCapacity};
                table.addRow(rowInfo);
            }

            var tableDiv = document.getElementById("tableDiv");     
            table.display(tableDiv);
        }

        function onLoad() {
          rallyDataSource = new rally.sdk.data.RallyDataSource('__WORKSPACE_OID__',
                                                       '__PROJECT_OID__',
                                                       '__PROJECT_SCOPING_UP__',
                                                       '__PROJECT_SCOPING_DOWN__');
          var config = {
                label : "Select an iteration ",
                defaultDisplayValue: selectedIteration
          };
          var iterationDropdown = new rally.sdk.ui.IterationDropdown(config, rallyDataSource);
          iterationDropdown.display("aDiv", iterationSelected);
        }

           rally.addOnLoad(onLoad);

        </script>
    </head>
      <body>
        <div id="aDiv"></div>
        <div id="tableDiv"></div>
    </body>
    </html> 
```

# twitter - 使用 Twitter Stream api 进行搜索

> ID：11472425
> 
> 赞同：2
> 
> 时间：2012-07-13T14:23:18.607
> 
> 标签：twitter, twitter-oauth, google-apps-script, google-sheets

我正在尝试使用 Twitter Stream Api 在 Google 电子表格中搜索一些主题标签。Twitter 搜索 API 没用，因为我也想统计转发次数。我的函数示例在这里。谁能解释一下我必须做什么才能工作得好..

```
function miniSearch(){
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sumSheet = ss.getSheetByName("Readme/Settings");
  // Authorize to Twitter
  var oauthConfig = UrlFetchApp.addOAuthService("twitter");
  oauthConfig.setAccessTokenUrl("https://api.twitter.com/oauth/access_token");
  oauthConfig.setRequestTokenUrl("https://api.twitter.com/oauth/request_token");
  oauthConfig.setAuthorizationUrl("https://api.twitter.com/oauth/authorize");
  oauthConfig.setConsumerKey(TWITTER_CONSUMER_KEY);
  oauthConfig.setConsumerSecret(TWITTER_CONSUMER_SECRET);
  // "twitter" value must match the argument to "addOAuthService" above.
  var options = {
    'method': 'POST',
    "oAuthServiceName" : "twitter",
    "oAuthUseToken" : "always"
  };

  var url = "https://stream.twitter.com/1/statuses/filter.json?track="+"twitterapi";
  var response = UrlFetchApp.fetch(url, options);
  var tweets = JSON.parse(response.getContentText());

  sumSheet.getRange('B8').setValue(tweets[0]["text"]);

} 
```

此函数返回错误代码 504；

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-15T11:13:32.237

我不认为 Google Apps 脚本可以保持持久的 HTTP 连接打开，这会导致 504（请参阅[Twitter Streaming APIs Doc](https://dev.twitter.com/docs/streaming-apis)）

[我在[这个 Google 电子表格模板 (TAGS v4.0)](https://docs.google.com/spreadsheet/ccc?key=0AqGkLMU9sHmLdHg1RnVkVnNLX3p0YlJYXzExdEVqWGc#gid=117)中有一个基本的转推计数器。filterUnique 公式使用此代码（伪代码从推文文本中删除任何链接，然后提取第一个 90% 的文本（考虑到任何旧式 RT+ 注释），然后如果不在唯一数组中，则向现有值添加或添加 1） ：

```
function filterUnique(tweets){
  var output = [];
  var temp = {};
  for (i in tweets){
    if (i>0){
      var tmp = tweets[i][0];
      var urlPattern = /(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;
      tmp = tmp.replace(urlPattern,"")
      tmp = tmp.substring(0,parseInt(tmp.length*0.9));
      if (temp[tmp] == undefined){
        temp[tmp] = [tweets[i][0],0];
      }
      temp[tmp] = [tweets[i][0],temp[tmp][1]+1]; 
    }
  }
  for (i in temp){
    output.push([temp[i][0],temp[i][1]]);
  }
  output.sort(function(a,b) {
    return  b[1]-a[1];
  });
  return output.slice(0, 12);
} 
```

]

# c# - 已发出TokenAuthentication AudienceUriMode =“从不”

> ID：11472428
> 
> 赞同：2
> 
> 时间：2012-07-13T14:23:25.663
> 
> 标签：c#, wcf, .net-4.0, migrate, ws-federation

我已将 wcf 3.5 迁移到 4.0，但出现以下错误：

“处理消息中的安全令牌时出错”

谷歌搜索将我带到这篇文章：

[http://blog.latamhub.com/?cat=3](http://blog.latamhub.com/?cat=3)

因此，我添加了以下行并解决了问题：

```
<issuedTokenAuthentication audienceUriMode=”Never”&gt;
</issuedTokenAuthentication> 
```

我不确定它有什么作用。我正在使用 wsFederationHttpBinding。有谁知道为什么它现在有效？

在 wcf 3.5 中是默认值，在 4.0 中不是？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T17:33:15.960

因为您使用的是 wsFederationHttpBinding，所以您需要为 SAML 安全令牌指定目标 uri。

如果没有看到服务模型代码，我无法告诉你为什么会发生这种情况。

您还应该为 Microsoft.IdentityModel 和 ADFS 启用跟踪

查看[http://msdn.microsoft.com/en-us/library/ms730908](http://msdn.microsoft.com/en-us/library/ms730908)

& [http://msdn.microsoft.com/en-us/library/ee517264.aspx](http://msdn.microsoft.com/en-us/library/ee517264.aspx)

有关联邦安全的更多信息。

# python - 从 Django 视图本身的聚合函数中检索数据

> ID：11472430
> 
> 赞同：0
> 
> 时间：2012-07-13T14:23:30.997
> 
> 标签：python, django, django-views

我有以下代码，我需要在 django 视图本身中检索平均数据。但是变量平均值始终没有定义。有任何想法吗？

```
cont_rating_tmp = EmployerReviewContractor.objects.filter(reviewed__id = cont.id).aggregate(average=Avg('avg_rate'))

cont.rate=average 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:42:13.453

您的查询返回一个字典。您可以通过以下方式获得价值：

```
cont_rating_tmp = EmployerReviewContractor.objects.filter(
                         reviewed__id = cont.id
                            ).aggregate(average=Avg('avg_rate')) 

cont.rate=cont_rating_tmp["average"] 
```

[我从django 聚合文档](https://docs.djangoproject.com/en/dev/topics/db/aggregation/)中复制了一个 saple ：

```
>>> from django.db.models import Max
>>> Book.objects.all().aggregate(Max('price'))
{'price__max': Decimal('81.20')}        <---  the result (a dictionary) 
```

# sql-server - 匹配值不在 DQS SQL Server 2012 的域值中

> ID：11472431
> 
> 赞同：2
> 
> 时间：2012-07-13T14:23:31.883
> 
> 标签：sql-server, data-quality, data-quality-services

我正在使用 SQL Server 2012 数据质量服务。我想将域值下不存在的任何值视为无效。例如，如果我在知识库中域管理下的域值选项卡中将“abc”、“def”的值列为正确，但外部的任何值都应视为无效。

我尝试设置使用“值不在”的域规则，然后手动输入值“abc”和“def”，但是当我清理域值为“xyz”的数据时没有得到无效结果. DQS 中是否有更好的方法可以让我将域值下列出的值之外的任何值视为无效？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T13:21:41.330

应该构造域规则，使得任何导致“真”布尔结果的输入值都被认为是域中的有效值。

因此，对于您的示例，域规则应该是“值在”而不是“值不在”。

# java - 如何让 Eclipse 识别最新的 Hadoop 库？

> ID：11472432
> 
> 赞同：0
> 
> 时间：2012-07-13T14:23:33.853
> 
> 标签：java, eclipse, hadoop, mapreduce, hdfs

这个问题更像是一个 Eclipse 问题，但是用过 Hadoop 的人可能知道答案。

去年，我在 Eclipse 中编写了一些 Hadoop MapReduce 作业。为了访问编译代码所需的库和包，我在 Apache 网站 ( [http://wiki.apache.org/hadoop/EclipsePlugIn](http://wiki.apache.org/hadoop/EclipsePlugIn) ) 上安装了一个 Eclipse 插件。不幸的是，该插件与最新版本的 Hadoop（2.0.0-alpha 版本）不兼容。我想知道是否有人在过去几个月内完成了编写 Hadoop 作业的工作，并且知道如何让 Eclipse 识别最新的 Hadoop（2.0.0-alpha）包。

该插件仍然适用于 Hadoop 0.20.203.0，但我希望能够使用最新版本。

我在 Windows 中运行 Eclipse。我尝试右键单击我的项目名称，`Properties`然后转到`Java Build Path`并最终选择我添加了目录和子目录中`Add External JARs` 的所有 JAR 。`hadoop-2.0.0-alpha/share/hadoop`起初，我认为这行得通，但是当我尝试使用 Hadoop 2.0.0-alpha API 独有的方法和构造函数时，代码无法编译。它所识别的库肯定比 Hadoop 0.20.203.0 中的库更新，但不如当前 Hadoop 的 alpha 版本更新。

有谁知道我该如何解决这个问题？

# java - 关于mysql中的查询语句

> ID：11472441
> 
> 赞同：3
> 
> 时间：2012-07-13T14:23:56.917
> 
> 标签：java, mysql, hibernate

我使用这段代码在 mysql 中进行分页（使用 Struts 2 + Hibernate）：

```
Query query=getSession().createQuery("from GovOffice");
query.setFirstResult(0);
query.setMaxResult(100);
List<GovOffice> list=query.list(); 
```

这将返回从第一条记录开始的 GovOffice 列表，每页显示 100 条记录。

假设我有 100,000 条记录，这个查询“来自 GovOffice”是否首先获取所有 100,000 条记录？通过 setFirstResult 和 setMaxReSult 它将限制从 100,000 到 100 条记录。如果这是真的，则意味着分页必须是无用的。

如果没有，有什么方法可以证明在我们调用之前查询不会从数据库中获取数据`query.list()`。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T14:30:41.330

`Query`的`setFirstResult`并`setMaxResult`使用数据库的潜在可能性。

在 MySQL 的情况下，它是[limit](http://dev.mysql.com/doc/refman/5.0/fr/select.html)。

所以，不，它不会获取所有记录，是的，它很有效。

源代码中的证明（[org.hibernate.dialect.MySQLDialect](http://grepcode.com/file/repository.jboss.org/maven2/org.hibernate/hibernate-core/3.3.1.GA/org/hibernate/dialect/MySQLDialect.java?av=f)）：

```
238 public String getLimitString(String sql, boolean hasOffset) {
239     return new StringBuffer( sql.length()+20 )
240         .append(sql)
241         .append( hasOffset ? " limit ?, ?" : " limit ?")
242         .toString();
243 } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-13T14:30:34.640

我认为文档清楚地表明，只会从数据库中检索最大结果。

[setMaxResults(int)](http://docs.jboss.org/hibernate/core/3.5/api/org/hibernate/Query.html#setMaxResults%28int%29)

在我看来，这相当于

```
SELECT * FROM GovOffice LIMIT 0, 100; 
```

# python - 在'\id'之后获取字符串中的第一个单词

> ID：11472442
> 
> 赞同：1
> 
> 时间：2012-07-13T14:24:09.273
> 
> 标签：python, regex

我将如何抓住`'\id '`字符串中的第一个单词？

细绳：

```
'\id hello some random text that can be anything' 
```

Python

```
for line in lines_in:
    if line.startswith('\id '):
        book = line.replace('\id ', '').lower().rstrip() 
```

我得到了什么

```
book = 'hello some random text that can be anything' 
```

我想要的是

```
book = 'hello' 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-13T14:26:29.627

一种选择：

```
words = line.split()
try:
    word = words[words.index("\id") + 1]
except ValueError:
    pass    # no whitespace-delimited "\id" in the string
except IndexError:
    pass    # "\id" at the end of the string 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-13T14:28:02.973

```
>>> import re
>>> text = '\id hello some random text that can be anything'
>>> match = re.search(r'\\id (\w+)', text)
>>> if match:
        print match.group(1) 
```

一个更完整的版本，它在之后捕获任何空格`'\id'`

```
re.search(r'\\id\s*(\w+)', text) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T14:27:35.677

你不需要正则表达式，你可以这样做：

```
book.split(' ')[0] 
```

但是有很多方法可以实现这一目标

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-13T14:29:47.243

如果单词和单词之间不必有空格`"\id"`，正则表达式就可以了。（如果空间有保证，则使用拆分方案）：

```
import re
match=re.search(r'\\id\s*(\w+)',yourstring)
if match:
   print match.group(1) 
```

或另一种方式（没有正则表达式）：

```
head,sep,tail=yourstring.partition(r'\id')
first_word=tail.split()[1] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-13T14:28:17.833

尝试`str.split(' ')`在您的字符串书上使用，它将按空格分隔并为您提供单词列表。然后就做`book = newList[0]`。

所以`book = book.split(' ')[0]`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-13T14:30:10.270

由于您已经检查了以 开头的行`"\id "`，因此只需拆分字符串，您将获得一个单词列表。如果你想要下一个，只需获取元素#1：

```
>>> line="\id hello some random text that can be anything"
>>> line.split()
['\\id', 'hello', 'some', 'random', 'text', 'that', 'can', 'be', 'anything']
    #0      #1  ... 
```

这样你的代码应该变成这样：

```
for line in lines_in:
    if line.startswith('\id '):
      book = line.split()[1] 
```

# backbone.js - 集合中的主干重置事件

> ID：11472443
> 
> 赞同：7
> 
> 时间：2012-07-13T14:24:09.997
> 
> 标签：backbone.js

Backbone 重置事件如何工作？据我所理解

1.  从集合中删除所有模型
2.  将新“获取”的模型添加到集合中
3.  触发重置事件

在我的情况下，每个模型都在 SVG 上绘制一些东西，所以我应该在从集合中删除模型之前调用 remove 函数。从集合中删除模型时会触发哪个事件？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-13T15:25:02.713

正如@Paul 所指出的，在`reset`. `reset`但是，您可以通过覆盖集合上的方法来提供自己的方法。例如，

```
var SVGCollection = Backbone.Collection.extend({
    reset: function(models, options) {
        options = options || {};

        if (!options.silent) {
            this.trigger('prereset', this, options);
        }

        Backbone.Collection.prototype.reset.call(this, models, options);
    }
}); 
```

和一个示例用法

```
var c = new SVGCollection([
    {id: 1},
    {id: 2}
]);
c.on('prereset', function() {
    console.log(c.pluck('id'));
});
c.on('reset', function() {
    console.log(c.pluck('id'));
});
c.reset({id: 3}); 
```

有关演示，请参见[http://jsfiddle.net/nikoshr/8vV7Y/](http://jsfiddle.net/nikoshr/8vV7Y/)

您还可以在每个模型上触发事件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-13T15:05:52.747

你是对`reset`的，在旧模型被删除并添加新模型后被解雇。

`reset`通过该方法从集合中删除模型时不会触发事件。

您可能必须在集合之外保留对旧模型的引用，然后在触发重置事件时，您将引用这些模型，以便您可以在 SVG 上为它们调用删除函数。

# node.js - 节点异步循环 - 为什么内存会增长并突然下降？

> ID：11472450
> 
> 赞同：0
> 
> 时间：2012-07-13T14:24:28.337
> 
> 标签：node.js, memory, asynchronous

我正在用 Node 编写一个使用异步循环的程序。目标是让这个程序在 Heroku 上运行更长时间。正如预期的那样，它在内存中增长。但是一旦内存使用量达到大约 57MiB，它就会回落到 22MiB（它开始的地方）。是什么导致内存使用量突然下降？

这是我的代码，如果它有帮助的话。`database.read`只是 的简化`http.request`。

```
var http = require("http");
var util = require('util');

var fnstraj = require("./predictors/fnstraj.js");
var database = require("./library/database.js");

var COUNT = 0;

////////////////
// Queue Loop //
////////////////
var worker = function() { 
    setTimeout(function() {
        COUNT++;

        console.log("Worker Clock: " + COUNT + ".");
        console.log(util.inspect(process.memoryUsage()));

        database.read('/queue/', function( results, error ) {
            if ( typeof error !== "undefined" && error ) {
                process.nextTick( worker );
            } else {
                var queue = results;

                database.read('/flights/', function ( results, error ) {
                    if ( typeof error !== "undefined" && error ) {
                        process.nextTick( worker );
                    } else {
                        var flights = results;

                        if ( !flights.error && typeof queue.rows[0] !== "undefined" ) {             
                            for ( flight in flights.rows ) {
                                if ( flights.rows[flight].doc._id === queue.rows[0].doc._id ) {     
                                    var thisFlight = flights.rows[flight].doc;

                                    console.log("Flight " + thisFlight._id + " started");

                                    thisFlight.duration = fnstraj.vertPred(thisFlight.launch.altitude, thisFlight.balloon.burst, thisFlight.balloon.radius, thisFlight.balloon.lift);

                                    fnstraj.predict(thisFlight, function() {
                                        database.remove('/queue/' + thisFlight._id);

                                        console.log("Flight " + thisFlight._id + " completed");

                                        process.nextTick( worker );
                                    });

                                    var found = true;
                                }
                            }

                            if ( !found ) {
                                process.nextTick( worker );
                            }
                        }
                    }
                });
            }
        });
    }, 25);
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:56:45.557

这与 V8 垃圾收集有关。您可以使用 node 的 '--gc_interval ' 选项对其进行调整，但请注意这是一个高级参数。

```
node --gc_interval <allocation count interval> 
```

这也可能与GC的堆压缩有关。这是收集所有先前释放的空间并最终返回给操作系统的过程。

如需更多调整，您可以使用 V8 特定选项进行试验：

```
node --v8-options 
```

# java - 在其类之外更改 java 对象

> ID：11472452
> 
> 赞同：1
> 
> 时间：2012-07-13T14:24:30.457
> 
> 标签：java, class, object

这是我的问题，我怎样才能在它的类之外更改一个对象，以便它保持在外部类中所做的更改？

下面是代码示例：

**主类：**

```
 public class Main {

        public static void main(String[] args)
        {
            Variable var = new Variable(1,2,3);
            Change.changeVar(var);
            System.out.println("" + var.geta() + "" + var.getb() + "" + var.getc());
        }
    } 
```

**变量类：**

```
public class Variable {

private int a;
private int b;
private int c;

public Variable(int a, int b, int c)
{
    this.a = a;
    this.b = b;
    this.c = c;
}

public int geta()
{
    return this.a;
}

public int getb()
{
    return this.b;
}

public int getc()
{
    return this.c;
} 
```

}

**换班：**

```
public class Change {

public static void changeVar(Variable var)
{
    Variable var2 = new Variable(4,5,6);
    var = var2;
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:31:13.597

```
public class Variable {

    private int a;
    private int b;
    private int c;

    public Variable(int a, int b, int c)
    {
        this.a = a;
        this.b = b;
        this.c = c;
    }

    public int geta()
    {
        return this.a;
    }

    public int getb()
    {
        return this.b;
    }

    public int getc()
    {
        return this.c;
    }

    // depending on your use case, setters might be more appropriate
    // it depends on how you want to control the changing of the vars
    public void update(int a, int b, int c) {
        this.a = a;
        this.b = b;
        this.c = c;
    }

}

public class Change {

    public static void changeVar(Variable var)
    {
        var.update(4,5,6);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T14:26:55.953

在你的例子中，没有。当 changeVar() 退出时，参数 var 被丢弃，而 main() 方法中的 var 保留其原始值。[通过参考](http://en.wikipedia.org/wiki/Evaluation_strategy#Call_by_reference)阅读。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T14:28:54.947

You cannot do it in a way that you described, because in Java variables are passed by values. However you can achieve the desired effect in a different way:

```
public class Variable {

    private int a;
    private int b;
    private int c;

    public Variable(int a, int b, int c)
    {
        this.a = a;
        this.b = b;
        this.c = c;
    }
    public int geta()
    {
        return this.a;
    }

    public int getb()
    {
        return this.b;
    }

    public int getc()
    {
        return this.c;
    }

    public void seta(int a) { this.a = a; }
    public void setb(int b) { this.a = b; }
    public void setc(int c) { this.a = c; }
}

public class Change {

    public static void changeVar(Variable var)
    {
        var.seta(4);
        var.setb(5);
        var.setc(6);
    }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T14:32:21.843

```
public static void changeVar(Variable var)
{
    Variable var2 = new Variable(4,5,6);
    var = var2;
} 
```

首先，你可以在Variable类中编写一些setter方法，然后你可以在上面的代码中调用这些setter方法，比如`var.setA(4)`...等等。`enter code here`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-13T14:27:06.137

您需要提供 setter 方法并在原始对象上调用它们：

```
public void seta(int newa) { this.a = newa; } 
```

然后你会说

```
public static void changeVar(Variable var)
{
    var.seta(4);
    //etc
} 
```

您只是重新指向局部变量引用`var`以指向您的新实例`var2`。它对传递给方法的原始实例的值没有影响。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-13T14:27:13.603

那样做？你不能。

您正在传递对实例的引用。但是，在函数内部，您使用新的引用。分配给新参考不会影响其他人。

# java - 错误：包 javax.servlet.http 不存在

> ID：11472455
> 
> 赞同：3
> 
> 时间：2012-07-13T14:24:49.453
> 
> 标签：java, servlets, compiler-errors, tomcat7

我正在尝试创建我的第一个 servlet，当我尝试编译我的代码时出现上述错误。我在 stackoverflow 上读到这是由于 SE JDK 不包含 servlet api。但是，我正在从命令行编译以下内容：

```
javac -classpath C:/Tomcat7/lib/servlet-api.jar; 
      -d ../classes com/example/web/BeerSelect.java. 
```

如您所见，我在命令行上引用了 servlet-api。请你能告诉我为什么我仍然收到这个错误。我正在使用tomcat 7

谢谢

* * *

**解决方案**

对于任何有兴趣的人..我找到了我的问题。这是 Windows 命令 shell 的问题，而且我在目录名称中有空格。我将tomcat应用程序保存为带有空格的“tomcat 7”。我试图用“tomcat7”来达到它 - 那是没有空格..以下行有效

```
javac -classpath .;C:/Tomcat7/lib/servlet-api.jar;
      -d ../classes com/example/web/BeerSelect.java 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T11:01:13.813

如果您使用的是 Maven，则应在范围内添加`servlet-api 2.5`依赖项（有关更多详细信息，请参见[此处](http://tshikatshikaaa.blogspot.com/2013/03/package-javaxservlethttp-does-not-exist.html)）。`provided`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T15:02:02.943

将正斜杠更改为反斜杠，删除 JAR 后的尾随分号，然后重试：

```
javac -classpath C:\Tomcat7\lib\servlet-api.jar -d ..\classes com\example\web\BeerSelect.java 
```

还要仔细检查所有路径，尤其是 servlet-api.jar。

# javascript - 字符串相似度

> ID：11472456
> 
> 赞同：3
> 
> 时间：2012-07-13T14:24:50.713
> 
> 标签：javascript, string, similarity

> **可能重复：**
> [javascript文本相似性算法](https://stackoverflow.com/questions/5042873/javascript-text-similarity-algorithm)

我想知道在 JavaScript 中是否有任何库来测量两个字符串的**相似性**（如“john”和“Johhn”）。在 postgresql 中，我使用的是[pg_trgm](http://www.postgresql.org/docs/9.1/static/pgtrgm.html)模块，它适用于三元组。我想知道 JavaScript 中有什么可用的。

迄今为止发现的唯一一个是[基于](http://andrew.hedges.name/experiments/levenshtein/)Levenshtein 距离的。

# iphone - 收听 iphone 通知？

> ID：11472458
> 
> 赞同：2
> 
> 时间：2012-07-13T14:24:56.673
> 
> 标签：iphone, ios, notifications

这可能是不可能的，但是有没有办法“收听” iphone 通知或检查来自应用程序的通知类型？有这方面的API吗？还是苹果不允许？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:27:27.617

是的你可以。看看[NSNotification](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSNotification_Class/Reference/Reference.html)

这里有[通知编程主题](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/Notifications/Introduction/introNotifications.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T15:05:23.593

如果你在谈论推送或本地通知，不，你不能。

这将是一个巨大的安全问题。

除非您谈论自己的推送通知专门发送到您的应用程序，否则请查看[UIApplicationDelegate](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIApplicationDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intfm/UIApplicationDelegate/application%3adidReceiveRemoteNotification%3a)

# php - 数组搜索在 php 中不起作用

> ID：11472460
> 
> 赞同：1
> 
> 时间：2012-07-13T14:24:58.897
> 
> 标签：php, arrays

我试图在数组中找到 picid 但它不起作用。当我回应它时，什么都没有出现。

这是我的代码

```
<?php $psql=mysql_query("select * from gallery where userId='$miid'");
$photo1 = array();

while($photo=mysql_fetch_assoc($psql)) { 
  $photo1[]=$photo;
  print_r($photo);
}

foreach($photo1 as $k => $v){
  if($v['picId']==$mipic){
    $pic="uploads/".$v['photo'];
    echo ">>>". $key=array_search($v['picId'],$photo1);
?>

 <a href="eg?next=<?php echo $photo[$k+1];?>">NEXT</a>
 <img src="<?php echo $pic; ?>" width="300px" height="300px">
 <a href="eg?previous=<?php echo $photo[$k-1];?>">PREVIOUS</a>
 <?php
  }
  }?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:28:54.700

array_search 不是递归的。`$v`存在于 中`$photo1`，而`$v['picId']`仅存在于 中`$v`。

这使得`$key=array_search($v['picId'],$photo1)`return `false`，当你回显它时，它将打印为空。

我不知道你为什么要使用`array_search`。为了检索下一个和上一个 picId，试试这个：

```
<a href="modules/gallery/miloader.php?next=<?php echo $photo1[$k+1]['picId'];?>">NEXT</a>
<img src="<?php echo $pic; ?>" width="300px" height="300px">
<a href="miloader.php?previous=<?php echo $photo1[$k-1]['picId'];?>">PREVIOUS</a> 
```

请注意，其中一个 href 是`modules/gallery/miloader.php`，而另一个是`miloader.php`. 因此，除非您实际上有两个不同的 miloader.php 文件（每个目录中都有一个），否则其中一个是错误的。

# object - 将对象/方法分配给变量或新的对象文字

> ID：11472466
> 
> 赞同：0
> 
> 时间：2012-07-13T14:25:15.147
> 
> 标签：object, variable-assignment, javascript

查看 Google 的书签气泡库代码，我发现了这个：

```
var google = google || {};
google.bookmarkbubble = google.bookmarkbubble || {}; 
```

有人可以解释他们在这里做什么以及为什么要这样做吗？既然 JS 是一种解释性语言，为什么你需要将相同的 google 对象分配给 google 变量？每次加载页面时，其中包含的脚本不会只执行一次吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:27:16.417

他们正在建立一个类似命名空间的对象。如果已经有一个`google`对象或`google.bookmarkbubble`对象，他们会确保不会替换它。例如，如果您添加了另一个 Google 库，它可能已经设置了一个`google`如下所示的对象：

```
{
    somelibrary: {
        ...
    }
} 
```

因此，如果他们只有：

```
var google = { bookmarkbubble: { ... } } 
```

这会破坏任何引用的代码`google.somelibrary`。同样，如果他们没有`var google = google || {};`并且您还没有`google`定义，那么`google.bookmarkbubble`将引发错误。

简而言之，此代码确保`google.bookmarkbubble`对象存在而不覆盖任何先前定义的`google`对象`google.bookmarkbubble`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T14:31:35.790

`var google = google || {};`是一种简写语法

```
if (!google) {
  google = {};
} 
```

这确保了第二次分配不会因为`google`至少是一个空哈希而失败。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T14:26:54.543

当一个库包含许多用户可能包含或不包含的文件时，通常会这样做。第一个库将初始化`google`为一个空对象（因为它的计算结果为空），随后的库将保留已添加到该对象的属性。

# javascript - 限制字母之间的空间

> ID：11472469
> 
> 赞同：-2
> 
> 时间：2012-07-13T14:25:25.367
> 
> 标签：javascript, html, css

> **可能重复：**
> [来自用户输入的字母阴影](https://stackoverflow.com/questions/11470932/letter-shadows-from-user-input)

用户输入他们的名字，它会被垂直打印两次。第二列应该像阴影。我正在尝试压缩第二列中的字母（id=letters2）或限制它们之间的空间。有谁知道如何做到这一点。另外，请在 MZFirefox 中查看代码，因为旋转效果仅适用于该浏览器。

```
<html> 
<head> 
<script src="raphael-min.js"></script> 
<script src="jquery-1.7.2.js"></script>  
<script type="text/javascript">   

function animate() {  

var txt = document.getElementById("words").value;
var area = txt;
var splittxt = txt.split("");

document.getElementById("letters").innerHTML = "";
document.getElementById("letters2").innerHTML = "";
var i;
for (i = 0; i < splittxt.length; i++) {
document.getElementById("letters").innerHTML = document.getElementById("letters").innerHTML + splittxt[i] + "<br>";
document.getElementById("letters2").innerHTML = document.getElementById("letters2").innerHTML + splittxt[i] + "<br>";
}
//displays how many symbols are in text box and what is in text box
document.getElementById("num").innerHTML= txt.length;          
document.getElementById("msg").innerHTML = txt;          

r.clear();      
// Make our pink rectangle 
ellipse = r.ellipse(40, 15, 30, 5).attr({"fill": "#969696", "stroke": "none"}); 
ellipse.glow({width:10});  
}      

</script>
<style type="text/css">
#letters
{
background-color:yellow;
width:25px;
float:left;
}

#letters2
{
letter-spacing:0px;
display:block;
-moz-transform: rotate(80deg);  
margin-left:90px;
margin-top:80px;
width:25px;
color:#DEDEDE;
}
</style>

</head> 

<body>  

Text: <input type="text" id="words" value="" /> 
<input type="button" value="Animate" onclick="animate()" /> 
<div id='msg'></div> 
<div id='num'></div>
<div id='letters'></div>
<div id="letters2"></div>
<div id="draw-here-raphael" style="height: 200px; width: 400px; margin-top:0px;"> 
</div> 
<div id="elps" style="margin-left:100px;"/>  

<script type="text/javascript"> //all your javascript goes here  
var r = new Raphael("draw-here-raphael");  

</script>

</body> 
</html> 
```

健康长寿·繁荣昌盛。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T15:20:45.743

您可以使用 CSS`line-height`属性来更改字母之间的间距。

这是我之前制作的一个 jsfiddle：jsfiddle.net/c7uDm

# joomla - 将批处理放在 joomla 中的位置

> ID：11472473
> 
> 赞同：0
> 
> 时间：2012-07-13T14:25:30.213
> 
> 标签：joomla, batch-processing

我有一个 Joomla 网站，我必须每天午夜运行一个批处理过程。问题是我不知道我应该把这个过程放在哪里。我以为我会制作一个新组件，但它不是一个组件。有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:34:20.163

您需要使用 CRON 作业，或查看[Joomla 扩展目录](http://extensions.joomla.org)以获取可能有用的信息。据我所知，在 Joomla 上的处理取决于用户显示页面以触发任何执行

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T16:02:08.927

如果是 Joomla 2.5+，您可以使用它`cron`来触发 Joomla 平台应用程序 - 就像您在`/cli/`目录中找到的应用程序一样。

很多扩展都可以做到这一点，最著名的可能是[Akeeba Backup](https://www.akeebabackup.com/documentation/akeeba-backup-documentation/native-cron-script.html)。

# php - 如何在亚马逊上获取一般产品性能报告？

> ID：11472477
> 
> 赞同：0
> 
> 时间：2012-07-13T14:25:37.137
> 
> 标签：php, amazon-web-services, amazon, amazon-mws

我正在使用亚马逊 MWS，我得到了我所有的产品销售报告。但我想知道是否有任何方法可以获得我不销售的任何产品 ASIN 的销售报告。这样我就可以找到要出售的潜在产品。 - 感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T14:03:06.243

据我所知，没有办法查看您不销售的任何产品的性能。

唯一的指标是 Amazon SalesRank，您可以通过[产品 API](https://developer.amazonservices.com/gp/mws/api.html?ie=UTF8&section=products&group=products&version=latest) (ItemLookup) 或通过抓取产品页面来获取它。

但是，如果您找到方法，将其发布在此处会很整洁。

**更新**：谢谢乔纳森，我更新了链接。Jonathan 指出，MWS 中有一个新的 Product API。使用它，伙计们;）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T16:28:13.037

浏览开发文档，我看不到一种方法来获取您不出售自己的物品的信息。

可能值得查看 Reports API 文档，并使用便笺簿来查找您可能可以使用的东西。

**更新：**正如产品广告 API 史蒂夫指出的那样。使用第 8 页上的销售排名优化产品匹配可能会有所帮助。

[https://images-na.ssl-images-amazon.com/images/G/01/mwsportal/doc/en_US/products/MWSProductsApiMigrationGuide。*V140057720.pdf* _](https://images-na.ssl-images-amazon.com/images/G/01/mwsportal/doc/en_US/products/MWSProductsApiMigrationGuide._V140057720_.pdf)

[https://developer.amazonservices.com/gp/mws/docs.html](https://developer.amazonservices.com/gp/mws/docs.html)

# ruby - 清理/清理 HTML，但使用 Ruby/Rails + Nokogiri + Sanitize 保留丢失 HTML 字符（？）

> ID：11472483
> 
> 赞同：0
> 
> 时间：2012-07-13T14:25:59.943
> 
> 标签：ruby, ruby-on-rails-3, nokogiri, hpricot, sanitize

我们使用了 Sanitize gem 和 HTMLEntities 的组合来清理用户输入的 HTML。Sanitize 宝石使用 Hpricot，但现在使用 Nokogiri。我需要让 Hpricot 退出应用程序。

这是两个测试字符串，每个字符串后跟我期望的输出：

测试字符串 1：

```
"SOME TEXT < '<span style='background-image: url(\"http://evil.ru/webbug.png\")'>MORE' & TEXT!!!</span>"

expected_text = "SOME TEXT < 'MORE' & TEXT!!!" 
```

第二个测试字符串（路径略有不同）：

```
'Support <i>odd</i> chars like " < \' ‽'

expected_text = 'Support <i>odd</i> chars like &quot; &lt; &#39; ‽' 
```

这是你解决的问题吗？你用了什么工具？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T18:48:35.087

You may want to try the Loofah gem:

```
Loofah.document("SOME TEXT < '<span style='background-image: url(\"http://evil.ru/webbug.png\")'>MORE' & TEXT!!!</span>").to_html
=> "SOME TEXT MORE' &amp; TEXT!!!" 
```

Loofah isn't handling the unicode character in the second example for some reason, but I'd be happy to look into it if you file a Github Issue on Loofah (full disclosure: I'm the author of Loofah and co-author of Nokogiri).

Some more links:

*   [http://rubydoc.info/github/flavorjones/loofah/master/frames](http://rubydoc.info/github/flavorjones/loofah/master/frames)
*   [https://github.com/flavorjones/loofah](https://github.com/flavorjones/loofah)

# computer-architecture - 字长和数据总线

> ID：11472484
> 
> 赞同：13
> 
> 时间：2012-07-13T14:26:00.303
> 
> 标签：computer-architecture

我**对 word size 的定义**感到困惑。我读到处理器的字长是它的数据总线宽度。就像一个 8 位处理器有一个 8 位宽的数据总线。我最近读到，虚拟地址空间的最大大小由字长决定，即如果字长为 n 位，则最大虚拟地址空间为 2^n -1。但我一直认为最大虚拟地址空间是由地址总线宽度决定的，即一个 n 位宽的地址总线最多可以寻址 2^n 个字节。那么，**什么是真的？**

此外，这是否与**指针**有关，因为 n 位数据总线只能承载 n 位地址。因此，最多可以通过指针访问 2^n 个字节。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-13T17:20:10.597

我首先要说，你的一些困惑可能来自几十年前事情更简单的事实，而你对术语的理解是基于这些更简单的机器。

> 我对字长的定义感到困惑。我读到处理器的字长是它的数据总线宽度。就像一个 8 位处理器有一个 8 位宽的数据总线。

当然不。数据总线与此完全无关。处理器的字长（从来不是一个精确的术语）最好松散地定义为算术的最大自然大小，通常是机器中寄存器的大小。这通常是数据路径的宽度（与数据总线明显不同）。数据路径就是 ALU 的宽度。字长通常与指针大小相同。

> 我最近读到虚拟地址空间的最大大小由字长决定，即如果字长为 n 位，则最大虚拟地址空间为 2^n -1。但我一直认为最大虚拟地址空间是由地址总线宽度决定的，即一个 n 位宽的地址总线最多可以寻址 2^n 个字节。那么，什么是真的？

不会。虚拟地址空间的大小仅由页表（和 TLB）的虚拟页号中的位数决定。在当前基于 amd64 的机器上，只有 48 位的虚拟地址可用。高 16 位是第 47 位的符号扩展。在当前的 amd64 机器上，物理地址大小为 52 位。这些物理地址位是在总线上发送的。尽管即使是“公共汽车”一词也确实不正确。几乎所有的链接都是点对点的（DDRx DRAM 是一个例外）并且使用分组格式（报头 + 有效负载）而不是地址线和数据线。

> 此外，这是否与指针有关，因为 n 位数据总线只能承载 n 位地址。因此，最多可以通过指针访问 2^n 个字节。

许多（几乎所有偶数）具有单独地址总线的机器使用比地址位数更窄的地址总线。这些位被简单地分割并使用多个时钟周期通过总线发送。DDRx DRAM 是另一个例子。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-13T14:37:06.493

> 虚拟地址空间的最大大小由字长决定

这曾经是正确的，但某些扩展是为了绕过这个限制（即物理地址扩展，或 PAE），它启用了诸如 36 位内存地址之类的东西。

除此之外，维基百科将一个词定义为：

> 特定处理器设计使用的自然数据单元

在几乎所有情况下，这在 32 位系统上是 32 位，在 64 位系统上是 64 位。您仍然会经常在 64 位系统上找到对 32 位字的引用（部分原因是 amd64 是 intel x86 的扩展而不是修订版）。此外，作为现代计算早期的遗留物，您经常会看到 32 位量称为 DWORD 或双字，而 64 位量称为 QWORD 或四字。

这是人们一直在争论的事情。我个人使用 word size == bus width 的定义。

# javascript - jQuery 覆盖 event.preventDefault()

> ID：11472487
> 
> 赞同：3
> 
> 时间：2012-07-13T14:26:17.567
> 
> 标签：javascript, jquery, jquery-events, preventdefault

我有一个表单，当提交时，它会通过通常的方式`e.preventDefault()`发送一个 ajax 请求。但是，如果这个ajax请求返回某个条件，我希望表单能够正常提交。我如何实现这一目标？

```
// Submit handler
$(".reserveer_form").submit(function(event){
  event.preventDefault();

  $.ajax({
    url: $(this).attr("action"),
    data: $(this).serialize(),
    success: function(data) {
      if($(".messagered",data).length > 0){
        var errors = $(".messagered",data);
        $(".gegevens").before(errors);
      } else {
          // SUBMIT THE FORM!
      } 

    }
  });

}) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-13T14:30:42.537

Invoke the native `submit` method on the form, so that it doesn't trigger the jQuery handler.

```
$.ajax({
    context: this, // <-- set the context.
    url: $(this).attr("action"),
    data: $(this).serialize(),
    success: function (data) {
        if ($(".messagered", data).length > 0) {
            var errors = $(".messagered", data);
            $(".gegevens").before(errors);
        } else {
            this.submit(); // <-- submit the form
        }
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T14:28:31.520

由于您的评论说您更改了表单变量，因此您可以`submit`通过检查相同的表单变量来启动处理程序。如果它被改变，只是`return true`。如果不是，请继续使用当前处理程序。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-13T14:30:24.613

You can use the [`submit()` method](https://developer.mozilla.org/en/DOM/form.submit) or forms:

```
$(".reserveer_form").submit(function(event){
  event.preventDefault();
  var form = this,
      $form = $(form);

  $.ajax({
    url: $form.attr("action"),
    data: $form.serialize(),
    success: function(data) {
      var errors = $(".messagered", data);
      if (errors.length > 0){
        $(".gegevens").before(errors);
      } else {
        form.submit();
      }
    }
  });
}) 
```

However, this seems to be a strange ajax request. First, you send the form (serialized, via ajax) to the server, and when the response contains no errors you send it again? The server would process it twice (and act twice, depending on your form). Also, the user does not get a message that his input is already processed - he clicks "submit", and it always takes a time until it is visibly submitted (where he even could change some input).

# c# - 在应用程序获得焦点之前不显示任务栏图标

> ID：11472491
> 
> 赞同：3
> 
> 时间：2012-07-13T14:26:32.357
> 
> 标签：c#, winforms

我有问题。我的应用程序在获得焦点之前不会显示在 Windows 7 任务栏中。我尝试了很多东西，包括：

```
this.TopMost = true;
this.ShowInTaskBar = true; 
```

在表单生命周期的不同阶段，但没有任何反应。FormBorderStyle 属性设置为 FixedSingle。该表单只有几个按钮和一个网络浏览器（从资源中获取一个 html 页面）。

我在 Windows 7 64 位上运行。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T00:03:41.980

我写的一个项目也有同样的问题。除非我强制 Windows 刷新它，否则任务栏中不会显示任何图标。

这是一个呼吁

```
this.MinimumSize = new Size(wid, len); 
```

在 Form_Load 这就是问题所在。

# wcf - 自承载 WCF 自定义绑定、二进制消息、无证书的 HTTPS 传输

> ID：11472494
> 
> 赞同：1
> 
> 时间：2012-07-13T14:26:43.530
> 
> 标签：wcf, https, ssl-certificate, custom-binding

我有一些在特定端口上使用 CustomBinding for HTTP 协议的自托管 WCF 服务。到目前为止，我使用 BinaryMessageEncodingBindingElement 和 HttpTransportBindingElement 没有问题。

现在我需要通过使用 HTTPS 但没有证书来保护更多安全。我切换到 HttpsTransportBindingElement 并将 RequireClientCertificate 设置为 false。

我没有在该端口上安装证书。我通过运行“netsh http show sslcert”进行了检查。

当我尝试将我的服务添加到 WPF 应用程序时出现跟随错误（使用 Chrome 浏览我得到“此网页不可用”）：

* * *

> 下载“https://localhost:8080/myhost/myservice.svc”时出错。
> 底层连接已关闭：发送时发生意外错误。
> 无法从传输连接读取数据：现有连接被远程主机强行关闭。
> 远程主机强制关闭现有连接
> 元数据包含无法解析的引用：“https://localhost:8080/myhost/myservice.svc”。
> 向“https://localhost:8080/myhost/myservice.svc”发出 HTTP 请求时出错。
> 这可能是由于在 HTTPS 情况下未使用 HTTP.SYS 正确配置服务器证书。
> 这也可能是由于客户端和服务器之间的安全绑定不匹配造成的。
> 底层连接已关闭：发送时发生意外错误。
> 无法从传输连接读取数据：现有连接被远程主机强行关闭。
> 远程主机强行关闭现有连接
> 如果在当前解决方案中定义了服务，请尝试构建解决方案并再次添加服务引用。

这是我的绑定：

```
private System.ServiceModel.Channels.Binding GetHttpBinding(String pName)
    {
        System.ServiceModel.Channels.BindingElementCollection elements = new System.ServiceModel.Channels.BindingElementCollection();

        System.ServiceModel.Channels.BinaryMessageEncodingBindingElement binaryMessageEncoding = new System.ServiceModel.Channels.BinaryMessageEncodingBindingElement();
        binaryMessageEncoding.MessageVersion = System.ServiceModel.Channels.MessageVersion.Default;
        binaryMessageEncoding.ReaderQuotas.MaxArrayLength = this._maxArrayLength;
        binaryMessageEncoding.ReaderQuotas.MaxBytesPerRead = this._maxBytesPerRead;
        binaryMessageEncoding.ReaderQuotas.MaxDepth = this._maxDepth;
        binaryMessageEncoding.ReaderQuotas.MaxNameTableCharCount = this._maxNameTableCharCount;
        binaryMessageEncoding.ReaderQuotas.MaxStringContentLength = this._maxStringContentLength;

        elements.Add(binaryMessageEncoding);

        if (this._applyHttps)
        {
            System.ServiceModel.Channels.HttpsTransportBindingElement transport = new System.ServiceModel.Channels.HttpsTransportBindingElement()
                {
                    MaxBufferSize = this._maxBufferSize,
                    MaxReceivedMessageSize = this._maxReceivedMessageSize,
                    AllowCookies = false,
                    BypassProxyOnLocal = false,
                    HostNameComparisonMode = HostNameComparisonMode.StrongWildcard,
                    MaxBufferPoolSize = this._maxBufferPoolSize,
                    TransferMode = TransferMode.Buffered,
                    UseDefaultWebProxy = true,
                    ProxyAddress = null,
                    RequireClientCertificate = false
                };
            elements.Add(transport);
        }
        else
        {
            System.ServiceModel.Channels.HttpTransportBindingElement transport = new System.ServiceModel.Channels.HttpTransportBindingElement()
                {
                    MaxBufferSize = this._maxBufferSize,
                    MaxReceivedMessageSize = this._maxReceivedMessageSize,
                };
            elements.Add(transport);
        }

        System.ServiceModel.Channels.CustomBinding custB = new System.ServiceModel.Channels.CustomBinding(elements);
        custB.Name = pName;
        custB.SendTimeout = new TimeSpan(0, 2, 0);
        return custB;
} 
```

* * *

我用这种方法配置服务主机：

```
private void ConfigureBinaryService(ServiceHost pHost, Type pType, String pServiceName)
    {
        pHost.AddServiceEndpoint(pType, this.GetHttpBinding(pType.Name), String.Empty);
        pHost.AddServiceEndpoint(pType, this.GetNetTcpBinding(pType.Name), String.Empty);

        pHost.Description.Endpoints[0].Name = pType.Name + "_BasicBin";
        pHost.Description.Endpoints[1].Name = pType.Name + "_TCP";

        pHost.OpenTimeout = new TimeSpan(0, 2, 0);
        pHost.CloseTimeout = new TimeSpan(0, 2, 0);

        System.ServiceModel.Description.ServiceMetadataBehavior metadataBehavior = pHost.Description.Behaviors.Find<System.ServiceModel.Description.ServiceMetadataBehavior>();
        if (metadataBehavior == null)
        {
            metadataBehavior = new System.ServiceModel.Description.ServiceMetadataBehavior();
            pHost.Description.Behaviors.Add(metadataBehavior);
        }
        if (this._applyHttps)
            metadataBehavior.HttpsGetEnabled = true;
        else
            metadataBehavior.HttpGetEnabled = true;

        metadataBehavior.MetadataExporter.PolicyVersion = System.ServiceModel.Description.PolicyVersion.Policy15;

        if (this._applyHttps)
            pHost.AddServiceEndpoint(System.ServiceModel.Description.ServiceMetadataBehavior.MexContractName
                , System.ServiceModel.Description.MetadataExchangeBindings.CreateMexHttpsBinding(), "mex");
        else
            pHost.AddServiceEndpoint(System.ServiceModel.Description.ServiceMetadataBehavior.MexContractName
                , System.ServiceModel.Description.MetadataExchangeBindings.CreateMexHttpBinding(), "mex");

        pHost.AddServiceEndpoint(System.ServiceModel.Description.ServiceMetadataBehavior.MexContractName
            , System.ServiceModel.Description.MetadataExchangeBindings.CreateMexTcpBinding(), this._NetTcpComm + @"/" + pServiceName + @"/mex");

        pHost.Description.Endpoints[2].Name = pType.Name + "_mex_BasicBin";
        pHost.Description.Endpoints[3].Name = pType.Name + "_mex_TCP";

        foreach (var item in pHost.Description.Endpoints[0].Contract.Operations)
            item.Behaviors.Find<System.ServiceModel.Description.DataContractSerializerOperationBehavior>().MaxItemsInObjectGraph = System.Int32.MaxValue;

        foreach (var item in pHost.Description.Endpoints[1].Contract.Operations)
            item.Behaviors.Find<System.ServiceModel.Description.DataContractSerializerOperationBehavior>().MaxItemsInObjectGraph = System.Int32.MaxValue;

        System.ServiceModel.Description.ServiceDebugBehavior debugBehavior =
            pHost.Description.Behaviors.Find<System.ServiceModel.Description.ServiceDebugBehavior>();
        if (debugBehavior == null)
        {
            debugBehavior = new System.ServiceModel.Description.ServiceDebugBehavior();
            pHost.Description.Behaviors.Add(debugBehavior);
        }
        debugBehavior.IncludeExceptionDetailInFaults = true;
    } 
```

当 this._applyHttps 为 false 时，浏览器和 WPF 项目中的引用都可以访问我的服务。

所以我在享受了你这么久的帮助后第一次寻求帮助，没有直接询问。我错过了什么？由于它不是托管在 IIS 下，我是否还需要一个证书才能安装在服务器端仅用于特定端口？

提前谢谢大家！如果有人已经回答了这个案例，我很抱歉没有找到它......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T11:03:34.647

所以就像我猜想的那样，我只需要为服务器端创建一个自签名证书，并使用 netsh 命令将其绑定到端口。客户端不需要证书，这意味着没有证书的准 HTTPS。

注意：我让它在我的电脑上工作。一旦在真实环境中部署并且我必须解决任何错误，我将尝试更新这篇文章。

而且我知道在某些时候我们会在客户端获得完整的证书。一次一块石头。

# django - 删除 Django Crispy 表单中的标签

> ID：11472495
> 
> 赞同：20
> 
> 时间：2012-07-13T14:26:47.480
> 
> 标签：django, forms, label, django-crispy-forms

有谁知道是否有正确的方法可以去除酥脆的标签？

我做到了这一点：

```
self.fields['field'].label = "" 
```

但这不是一个很好的解决方案。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2014-07-09T16:09:49.897

做就是了：

```
self.helper.form_show_labels = False 
```

删除所有标签。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2015-07-09T07:19:15.850

与 Boostrap 一起使用（[请参阅文档](http://django-crispy-forms.readthedocs.org/en/latest/form_helper.html?highlight=form_show_labels)）

在您的表格中：

```
from crispy_forms.helper import FormHelper
from django import forms

class MyForm(forms.Form):
    [...]
    def __init__(self, *args, **kwargs):
        super(MyForm, self).__init__(*args, **kwargs)
        self.helper = FormHelper()
        self.helper.form_show_labels = False 
```

在您的模板中：

```
<form method='POST' action=''>{% csrf_token %}
{% crispy form %}
<input type='submit' value='Submit' class='btn btn-default'>
</form> 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-07-17T13:26:44.813

您可以编辑`field.html`模板： [https ://github.com/maraujop/django-crispy-forms/blob/dev/crispy_forms/templates/bootstrap/field.html#L7](https://github.com/maraujop/django-crispy-forms/blob/dev/crispy_forms/templates/bootstrap/field.html#L7)

向您的表单添加一个`FormHelper`属性来控制标签呈现并在该模板中使用它`if`。自定义`FormHelper`属性尚未正式记录，因为我没有时间，但我在我给出的主题演讲中谈到了它们，这里是幻灯片： [https ://speakerdeck.com/u/maraujop/p/django-crispy-形式](https://speakerdeck.com/u/maraujop/p/django-crispy-forms)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-10-22T15:30:56.737

下面的解决方案可让您从常规控件或脆控件中删除标签。不仅标签文本消失，而且标签使用的空间也被删除，因此您最终不会看到空白标签占用空间并弄乱您的布局。

下面的代码适用于 django 2.1.1。

```
# this class would go in forms.py
class SectionForm(forms.ModelForm):
    # add a custom field for calculation if desired
    txt01 = forms.CharField(required=False)

    def __init__(self, *args, **kwargs):
        ''' remove any labels here if desired
        '''
        super(SectionForm, self).__init__(*args, **kwargs)

        # remove the label of a non-linked/calculated field (txt01 added at top of form)
        self.fields['txt01'].label = ''

        # you can also remove labels of built-in model properties
        self.fields['name'].label = ''

    class Meta:
        model = Section
        fields = "__all__" 
```

我不清楚 OP 对他展示的代码片段有什么问题，除了他没有将代码行放在正确的位置。这似乎是最好和最简单的解决方案。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-02-04T10:16:48.130

如果您只是从输入中删除一些标签，那么在模型定义中明确不要给出标签名称，即：

```
field = models.IntegerField("",null=True) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-11T12:41:16.663

**要删除所有标签：**

```
self.helper.form_show_labels = False 
```

**全部为 False 时**显示特定标签：

```
HTML('<span>Your Label</span>') 
```

**全部为真时**禁用特定字段的标签

 **```
self.fields['fieldName'].label = True 
```

**例子：**

```
 Row(
            HTML('<span> Upolad Government ID (Adhar/PAN/Driving Licence)</span>'),
            Column('IdProof',css_class='form-group col-md-12 mb-0'),
            css_class='form-row'
        ), 
```**

# android - com.google.android.gcm.GCMBaseIntentService 在哪里？

> ID：11472496
> 
> 赞同：10
> 
> 时间：2012-07-13T14:26:50.657
> 
> 标签：android, google-cloud-messaging

我在这里关注 GCM 教程[http://developer.android.com/guide/google/gcm/gs.html](http://developer.android.com/guide/google/gcm/gs.html)

在**Step 2**的第 5 点，它说：

> 添加以下意图服务： service android:name=".GCMIntentService"

此意图服务将由 GCMBroadcastReceiver（由 GCM 库提供）调用，如下一步所示。它必须是 的子类`com.google.android.gcm.GCMBaseIntentService`，必须包含公共构造函数，并且应该被命名`my_app_package.GCMIntentService`（除非您使用的子类`GCMBroadcastReceiver`覆盖了用于命名服务的方法）。

但是，我不能 subclass `com.google.android.gcm.GCMBaseIntentService`，导入无法解决。我该如何解决？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-13T14:34:39.877

您必须安装库：http: [//developer.android.com/guide/google/gcm/gs.html#libs](http://developer.android.com/guide/google/gcm/gs.html#libs)

> 在 SDK 管理器中，安装 Extras > Google Cloud Messaging for Android Library。这会在 YOUR_SDK_ROOT/extras/google/ 下创建一个 gcm 目录，其中包含以下子目录：gcm-client、gcm-server、samples/gcm-demo-client、samples/gcm-demo-server 和 samples/gcm-demo-appengine。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-10-27T02:28:41.243

`gcm.jar`从[这里](http://www.java2s.com/Code/Jar/g/Downloadgcmjar.htm)下载并将其放在`YOUR_PROJECT/app/libs`目录中，然后在文件中添加`compile files('libs/gcm.jar')`行`build.gradle`

# javascript - 为什么我的正则表达式实现不尊重时间？

> ID：11472502
> 
> 赞同：-3
> 
> 时间：2012-07-13T14:27:01.000
> 
> 标签：javascript, regex

html 模板在通过我的代码运行后以 {@bigfoot} 开头，它是 {*bigfoot}

看看第二个正则表达式是如何在第一个正则表达式之前完成的？为什么？

```
html = html.replace(new RegExp("{@" + prop + "}", "g"), object[prop]);
html = html.replace(new RegExp("@", "g"), "*"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T15:17:05.883

我创建了这个：http: [//jsfiddle.net/kxTs5/](http://jsfiddle.net/kxTs5/)，但我无法重现您的问题。

然后我创建了这个[http://jsfiddle.net/kxTs5/2/](http://jsfiddle.net/kxTs5/2/)；做到了:o)

在第二个例子中，我`prop`可能是一个错字，或者什么，但它指的是文本中不存在的东西，所以没有匹配，所以没有变化。

我建议您自由使用`console.log`以确保您尝试匹配您认为匹配的内容

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-13T14:33:51.507

第一个表达式不正确。

花括号在正则表达式中用于指定给定捕获模式的特定重复计数。

要匹配花括号，您应该转义它们。

```
html = html.replace(new RegExp("\\{@" + prop + "\\}", "g"), object[prop]); 
```

# php - PHP 5：从 XML 中返回最接近搜索值的 5 个结果

> ID：11472505
> 
> 赞同：0
> 
> 时间：2012-07-13T14:27:07.287
> 
> 标签：php, xml, xml-parsing

我有一个`XML`由第三方提供的，我无法控制它的格式。它看起来像这样：

```
<base>  
    <results index="1">  
        <quote vendor_name="Company X">  
            <quote_detail rate="3.375" price="-0.440">  
                <stuff>value</stuff>  
            </quote_detail>  
        </quote>  
    </results>  
    <results index="2">  
        <quote vendor_name="Company y">  
            <quote_detail rate="3.548" price="-0.230">  
                <stuff>value</stuff>  
            </quote_detail>  
        </quote>  
    </results>  
    <results index="3">  
        <quote vendor_name="Company Z">  
            <quote_detail rate="3.799" price="1.120">  
                <stuff>value</stuff>  
            </quote_detail>  
        </quote>  
    </results>  
</base> 
```

我需要做的是返回价格最接近于零的结果 (`vendor_name`和`rate`)`price`而不超过上下两个。理想的结果看起来像这样（中间的最接近零）：

1.  Z公司 / 3.875 / -1.375
2.  Y 公司 / 3.750 / -0.875
3.  公司 X / 3.375 / -0.440
4.  A公司 / 3.500 / 0.250
5.  B公司 / 3.375 / 1.125

我不确定执行此操作所需的逻辑或如何`XML`在运行所述逻辑时保留信息。有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:53:24.647

我只是为您提供一些链接以帮助您入门。

请查看[simpleXML](http://www.php.net/manual/en/book.simplexml.php)以使用 php 对象访问 xml 数据。您评论中的 XQuery Hint 也为您指明了这个方向。

在遍历您的结果时，您可以将奖品的绝对值保存在一个数组中，并使用[ksort](http://www.php.net/manual/de/function.ksort.php)对其进行排序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T15:04:41.757

您需要做的是从 XML 中解析出数据以便能够使用它。然后，一旦你有了数据，你就可以选择你需要的公司。

这是使用 PHP[`DOMDocument`](http://php.net/domdocument)类的主要工作解决方案。首先，首先将公司解析为一个数组：

```
$doc = new DOMDocument;
$doc->loadXML( $xml); // $xml = your string from above

$xpath = new DOMXPath( $doc);

$companies = array();
foreach( $xpath->query('//results') as $result) {
    $quote = $xpath->query( 'quote', $result)->item(0);
    $vendor_name = $quote->attributes->getNamedItem( 'vendor_name')->value;

    $quote_detail = $xpath->query( 'quote_detail', $quote)->item(0);
    $rate = $quote_detail->attributes->getNamedItem( 'rate')->value;
    $price = $quote_detail->attributes->getNamedItem( 'price')->value;

    $companies[] = array( 
        'vendor_name' => $vendor_name,
        'rate' => $rate,
        'price' => $price
    );
}

var_dump( $companies); 
```

现在，您有一个公司数组，类似于：

```
array(3) {
  [0]=>
  array(3) {
    ["vendor_name"]=>
    string(9) "Company X"
    ["rate"]=>
    string(5) "3.375"
    ["price"]=>
    string(6) "-0.440"
  }
  [1]=>
  array(3) {
    ["vendor_name"]=>
    string(9) "Company y"
    ["rate"]=>
    string(5) "3.548"
    ["price"]=>
    string(6) "-0.230"
  }
  [2]=>
  array(3) {
    ["vendor_name"]=>
    string(9) "Company Z"
    ["rate"]=>
    string(5) "3.799"
    ["price"]=>
    string(5) "1.120"
  }
} 
```

然后，对价格字段中的公司列表进行排序。

```
usort( $companies, function( $a, $b) { 
    if( $a['price'] == $b['price']) 
        return 0; 
    return $a['price'] < $b['price'] ? -1 : 1;
});

var_dump( $companies); 
```

您的示例数据已经排序，所以这最终什么都不做。但是，您需要一个排序数组才能确定哪些最接近于零。

从这里开始，您将不得不弄清楚如何选择您需要的 5 个元素。我认为这不仅仅是开始所需要的。

# javascript - asp中的新行：java脚本的中继器

> ID：11472511
> 
> 赞同：1
> 
> 时间：2012-07-13T14:27:25.790
> 
> 标签：javascript, asp.net, repeater

在我的 aspx 页面中，我有中继器来显示列表内容，我想添加新行并将其显示在中继器中而无需回发。我会尽快发送日期。我不想使用 AJAX

如何通过 JavaScript 向 asp:repeater 添加行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:31:38.450

最好的办法是使用诸如 firebug 之类的工具来检查代码，检索该行的 html，然后使用 javascript 重新创建该代码并将其附加到 DOM。肮脏但可行。使用类似 jquery 的东西会让你的工作更轻松。

我知道您不想使用 AJAX，但最干净的方法是使用 UpdatePanel，并且在服务器端使用部分 postabck

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:33:48.910

中继器只生成重复的 html，因此绝对可以使用 javascript 插入新的 html。正如@mellamokb 提到的那样，这些更改在服务器端是不可见的。

将客户端和服务器端渲染与 ASP.NET Webforms 混合使用通常是个坏主意。

在某种列表依赖于例如组合框的情况下，为ASPX 代码中的*所有选项呈现列表通常是一个更好的主意。*然后使用 javascript 隐藏除当前活动列表之外的每个列表。

# xcode - UIButton 在构建后更改位置

> ID：11472513
> 
> 赞同：1
> 
> 时间：2012-07-13T14:27:26.597
> 
> 标签：xcode, uibutton, uistoryboard

我的应用程序中的 UIView 遇到了一个奇怪的问题。我在 View 上放置了一些 UIButtons、UISlider 等。看起来像这样：

![故事板](../Images/fe2ec75f2c8a2d165f3a1ebfbb97231d.png)

但是，在模拟器和我的 iPhone 上，它看起来像这样： ![模拟器](../Images/eab5ce364b1ce8d47e52b46c547ea764.png)

“+1 分钟”按钮不再与其他控件对齐。

正确的 x 坐标是 236。当我检查调试器中的值时，我得到 243。我已经检查了具有正确值的情节提要文件。

为什么它只影响这个按钮？更重要的是我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T14:19:38.680

如果您使用过Interface Builder..那么肯定您必须在Interfacebuilder中更改自动调整大小..试试这个它可能会解决您的问题..

# sql - Oracle 将数据复制到另一个表

> ID：11472519
> 
> 赞同：40
> 
> 时间：2012-07-13T14:27:53.213
> 
> 标签：sql, oracle

在 Oracle 中，我将数据从备份复制到新表，它不起作用。

什么是正确的语法？

谢谢

```
select CODE, MESSAGE into EXCEPTION_CODES (CODE, MESSAGE)
from Exception_code_tmp 
```

错误是

```
**SQL Error: ORA-00905: missing keyword
00905\. 00000 -  "missing keyword"** 
```

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-07-13T14:29:03.293

你需要一个`INSERT ... SELECT`

```
INSERT INTO exception_codes( code, message )
  SELECT code, message
    FROM exception_code_tmp 
```

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2014-05-28T10:10:00.500

如果你想用数据创建表。首先创建表：

```
create table new_table as ( select * from old_table); 
```

然后插入

```
insert into new_table ( select * from old_table); 
```

如果要创建没有数据的表。您可以使用 ：

```
create table new_table as ( select * from old_table where 1=0); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-03-03T14:15:30.733

在单个命令中创建表并复制数据：

```
create table T_NEW as
  select * from T; 
```

* 这**不会**复制 PK、FK、触发器等。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-07-13T14:29:16.490

```
insert into EXCEPTION_CODES (CODE, MESSAGE)
select CODE, MESSAGE from Exception_code_tmp 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-07T14:38:11.817

```
create table xyz_new as select * from xyz where 1=0; 
```

[http://www.codeassists.com/questions/oracle/copy-table-data-to-new-table-in-oracle](http://www.codeassists.com/questions/oracle/copy-table-data-to-new-table-in-oracle)

# java - 跨类使用的 Java 枚举

> ID：11472521
> 
> 赞同：2
> 
> 时间：2012-07-13T14:28:12.540
> 
> 标签：java, class, enums, enumeration

我在声明可以在特定类的所有函数中使用的 DB 字段类型的枚举时遇到问题。使用以下代码，我得到“无法将 USERNAME 解析为变量类型”：

```
public class SQL_access {

    public enum DBfields { BLANK, USERNAME, ID, PASSWORD, FIRSTNAME, LASTNAME }; 

    public boolean loginValidate( String username, String password ){

        String DBuser, DBpass;
        PreparedStatement table = connectToTable( "firstsql", "users");
        ResultSet row = table.executeQuery();;

        while(row.next()){
            DBuser = row.getString(USERNAME);
            if(DBuser.equals(username)){
                DBpass = row.getString(PASSWORD);
                break;
            }
        }
    }
}; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-13T14:30:14.520

你需要使用`DBfields.USERNAME`.

更新：

为了与该`getString(String)`方法一起使用，您需要使用枚举的名称，例如：`Dbfields.USERNAME.name()`.

如果您仅将枚举用于 jdbc API 访问，则最好只使用 String 常量：

```
public static final String DBFIELD_USERNAME = "USERNAME"; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-13T14:38:47.590

您需要引用枚举类型：`DBfields.USERNAME`，或静态导入枚举，如：

```
import static mypackage.SQL_access.DBfields.*; 
```

此外，就您而言，这还不够。您需要将列名 -- a `String`-- 或列位置 -- an `int`-- 传递给`ResultSet`：

```
row.getString(DBfields.USERNAME.name()); 
```

像这样使用，您失去了枚举的主要优势，即它的静态特性，但如果您将这些值称为“包”，它在代码中的其他地方仍然有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T14:30:34.807

您应该使用`DBfields.USERNAME`.

有关更多信息，请参阅[Oracle 文档](http://docs.oracle.com/javase/tutorial/java/javaOO/enum.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-13T14:30:39.517

尝试使用 enum 类型限定枚举数：

```
 while(row.next()){
        DBuser = row.getString( DBfields.USERNAME);
        if(DBuser.equals(username)){
            DBpass = row.getString( DBfields.PASSWORD);
            break;
        }
    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-13T14:30:45.413

当你引用一个枚举时，它总是采用这种形式的 EnumName.Field。在您的示例中，您需要以下内容：

```
DBUser = row.getString(DBfields.USERNAME);  
DBpass=row.getString(DBfields.PASSWORD); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-13T14:33:24.370

要访问您的枚举使用`DBfields.USERNAME`，但这对您没有帮助，因为 row.getString() 需要一个 int 作为参数。您的枚举属于类型 DBFields 而不是 int。更好地使用`public static final int USERNAME = the int value here;`和调用`row.getString(USERNAME);`。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-13T14:31:40.300

**错误**的方式。您需要调用`enum`using `DBfields.PASSWORD`。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-07-13T14:35:29.660

你需要这样调用：`DBfields.PASSWORD`

# objective-c - 观察滚动视图的“拖动”属性，但没有收到任何通知

> ID：11472525
> 
> 赞同：6
> 
> 时间：2012-07-13T14:28:22.707
> 
> 标签：objective-c, cocoa-touch, uiscrollview, key-value-observing, uiscrollviewdelegate

我有一个自定义`UIView`添加到 a `subView`of a`UIScrollView`中，并且我希望在滚动`UIView`时自动重新定位。`UIScrollView`除了观察`UIScrollView's` `contentOffset`属性（工作正常），我还需要观察它的`dragging`属性：

```
[scrollView addObserver:self 
             forKeyPath:@"dragging" 
                options:NSKeyValueObservingOptionNew 
                context:NULL]; 
```

但是在`observeValueForKeyPath:ofObject:change:context`方法中，我没有收到任何`NSNotification`更改`dragging`属性的信息，这是什么问题？谢谢。

## 更新

由于我要`UIView`在多个中重用这个自定义`UIViewControllers`，我希望自定义视图本身处理重新定位逻辑，而不是在每个`UIViewController's` `UIScrollViewDelegate`方法中复制重新定位逻辑（就像`scrollViewDidScroll`事情一样）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T14:43:40.280

UIKit 通常不兼容 KVO。某些属性可能会生成更改通知这一事实是不可靠的——它没有记录在案，并且可能在未来的版本中发生变化等。

既然你需要重用这个重定位逻辑，为什么不把它分开呢？顺便说一句 - 您可以将它放在您的自定义视图类本身中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:30:35.937

或者你设置一个委托给你 UIScrollView 并实现`scrollViewDidScroll:`

# javascript - 三星智能电视 VOD 应用程序 - 如何从源切换到播放器并返回源

> ID：11472529
> 
> 赞同：3
> 
> 时间：2012-07-13T14:28:36.813
> 
> 标签：javascript, html, css, samsung-smart-tv

使用 2.5 SDK 为三星智能电视开发视频点播 (VOD) 应用程序，我几乎可以使用所有功能。

该应用程序应该在实时程序上运行，但屏幕为黑色（无源）然后我选择视频，播放器加载并且视频打开，当我退出应用程序时，源丢失......在我的 config.xml 我有以下

> > fullwidget itemtype="boolean" = y
> > 电影 itemtype="string" = y
> > srcctl itemtype="boolean" = y

除此之外，我在 onUnload 上调用 plugin.Stop()

有没有其他人遇到过这个问题，如果有，您是否设法解决了这个问题？

PS：当 srcctl = n 源出现在初始加载时，但 vod 加载时没有音频，只有在退出应用程序源时才源音频一起丢失。

检查如下所示的代码：

```
Main.onUnload = function(){
Player.deinit();
}
Player.deinit = function(){       
      if (this.plugin)
      {
            this.plugin.Stop();
      }
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T08:21:33.230

> 该应用程序应覆盖在直播节目上运行，但屏幕为黑色

因此，如果您听到源声音并且屏幕是黑色的，您可能需要检查您的主体背景是否设置为透明，因为三星中的视频和源在文档主体下播放。

当您在源流和 VOD 之间切换时，您可能需要更改 PL_WINDOW_SOURCE 参数。检查我的旧答案：

[三星 SmartTV overlay（新闻行情）应用程序](https://stackoverflow.com/questions/10102923/samsung-smarttv-ovelray-news-ticker-application/10137818#10137818)

[http://www.samsungdforum.com/Guide/View/Developer_Documentation/Samsung_SmartTV_Developer_Documentation_2.5/API_Reference/JavaScript_APIs/Device_API/Window/SetSource](http://www.samsungdforum.com/Guide/View/Developer_Documentation/Samsung_SmartTV_Developer_Documentation_2.5/API_Reference/JavaScript_APIs/Device_API/Window/SetSource)

# java - 从 jpa 生成具有有限字符长度的表

> ID：11472543
> 
> 赞同：0
> 
> 时间：2012-07-13T14:29:39.810
> 
> 标签：java, jpa, varchar, longtext

我想用 varchar(700) 在数据库中创建一个文本字段（我最多需要 700 个字符）。我试图这样定义它：

```
@Entity
@Table(name = "t_foo)
public class Foo {

@Column(unique = true, nullable = false)
@Id
private String idNational;

@Column(length=700)
private String comment; 
```

...

表生成具有以下属性：

```
idNational varchar(255) NOT NULL

comment longtext NULL 
```

我真的希望评论是 varchar(700)。是否有理由使它成为长文本？有没有办法让它变成varchar？也许这是一个简单的问题，但我还没有找到解决方案！我是否必须改为使用 DDL 创建表？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:42:22.910

你没有说你正在使用哪个数据库/版本，但它听起来像是一个 MySQL 版本，varchar 的最大长度为 255。最新版本支持更大的 varchars。

由于您指定的值 > 255，因此它使用的是 longtext。

MySQL 5.0.3 和更高版本支持长度为 65,535 的 varchars - 早期版本只有 255。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-13T14:41:28.910

这是 JPA 提供程序配置的问题。更好的解决方案是使用 DDL 创建表。

# powershell - Calling a batch file and waiting for it to finish

> ID：11472547
> 
> 赞同：3
> 
> 时间：2012-07-13T14:29:59.643
> 
> 标签：powershell, batch-file

I have a powershell script that could be VERY crudely represented by the following.

```
function startTask
{
    calls external batch script (runs for roughly 10 minutes)
    creates done1.txt
 }
function startTask2
{
    calls batch (runs for roughly 10 minutes)
    creates done2.txt
}
startTask
if done1.txt exists
startTask2
if done2.txt exists
write-host "done" 
```

The issue I am facing is that immediately after calling the first batch file the 2nd batch file gets called. Is there a way to have powershell be aware of when the batch file is done? Side note, I don't have access to the batch file so I am unable to edit it

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-13T21:29:43.637

我建议您只使用带有错误/退出代码的 try-catch，而不是从每个任务中编写文本文件：

一个例子：

```
## D:\Scripts\Temp\exit.ps1 ##
try{
    $null.split()
}
catch
{
    exit 34
}

exit 2
#############################

# launch powershell from cmd 
C:\> powershell -noprofile -file D:\Scripts\Temp\exit.ps1
C:\>echo %errorlevel%
34 
```

# macos - How to I securely request a required password from an AppleScript?

> ID：11472548
> 
> 赞同：0
> 
> 时间：2012-07-13T14:29:59.980
> 
> 标签：macos, applescript, sudo

I have a simple AppleScript (application) that runs a shell script:

```
do shell script "sudo killall -TERM java" 
```

which fails with "*sudo no tty present and no askpass program specified*".

The desired behavior here is to have the OS X [password dialog open](https://stackoverflow.com/q/7059655/656912) (hopefully with an offer to save in the Keychain for future use), but (I'm guessing) I'm missing a step that tells the script to launch the necessary "asker" (which surprisingly, doesn't happen by default).

I've [tried](https://stackoverflow.com/a/10668693/656912)

```
do shell script "ssh-askpass Sudo Password | sudo killall -TERM java" 
```

but get an error with that too.

What is the correct way to invoke the OS X password dialing from AppleScript?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T18:49:38.160

The preferred method is indeed:

```
do shell script "sudo killall -TERM java" with administrator privileges 
```

As you noted, this does not let you memorize the password in your keychain. This is deliberate -- the keychain is intended to save you from having to memorize passwords for services and such, not to defeat the local security policies (which is essentially what you're trying to do.

You might be able to fake it by using the `security` command to store & retrieve the password (see discussion & sample code at [MacScripter](http://macscripter.net/viewtopic.php?id=36818)). You can prompt for the password with `Tell application "System Events" to display dialog "Password:" default answer "" with hidden answer`, although I don't know a way to add the "remember in keychain" checkbox. This also raises some security issues, because I don't think there's a way to make a security policy that allows your script to access it without prompting the user for confirmation without also allowing other scripts similar access.

# python - Removing specific html tags with python

> ID：11472552
> 
> 赞同：1
> 
> 时间：2012-07-13T14:30:14.407
> 
> 标签：python, html

I have some HTML tables inside of an HTML cell, like so:

```
miniTable='<table style="width: 100%%" bgcolor="%s">
               <tr><td><font color="%s"><b>%s</b></td></tr>
           </table>' % ( bgcolor, fontColor, floatNumber)

html += '<td>' + miniTable + '</td>' 
```

Is there a way to remove the HTML tags that pertain to this minitable, and *only* these html tags?
I would like to somehow remove these tags:

```
<table style="width: 100%%" bgcolor="%s"><tr><td><font color="%s"><b>
and
</b></td></tr></table> 
```

to get this:

```
floatNumber 
```

where `floatNumber` is the string representation of a floating point number. *I don't want any of the other HTML tags to be modified in any way.* I was thinking of using string.replace or regex, but I'm stumped.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:43:20.117

如果您无法安装和使用 Beautiful Soup（否则首选 BS，正如@otto-allmendinger 建议的那样）：

```
import re
s = '<table style="width: 100%%" bgcolor="%s"><tr><td><font color="%s"><b>1.23</b></td></tr></table>'
result = float(re.sub(r"<.?table[^>]*>|<.?t[rd]>|<font[^>]+>|<.?b>", "", s)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T14:40:06.247

[**不要使用 str.replace 或正则表达式。**](https://stackoverflow.com/a/1732454/92493)

使用[Beautiful Soup](http://www.crummy.com/software/BeautifulSoup/)之类的 html 解析库，获取所需的元素和包含的文本。

最终的代码应该是这样的

```
from bs4 import BeautifulSoup

soup = BeautifulSoup(html_doc)

for t in soup.find_all("table"): # the actual selection depends on your specific code
    content = t.get_text()
    # content should be the float number 
```

# c - Displaying the elements of a singly linked list

> ID：11472557
> 
> 赞同：3
> 
> 时间：2012-07-13T14:30:17.173
> 
> 标签：c

I have written a simple program to traverse through the nodes of a linked list.

```
struct node
{
    int data;
    struct node *next;
}*start;
start=(struct node *)malloc(sizeof(struct node));
start->next=NULL;

int main(void)
{
    if(start==NULL)
    {
        printf("There are no elements in the list");
    }

    else
    {
        struct node *tmp;
        printf("\nThe elemnets are ");
        for(tmp=start;tmp!=NULL;tmp=tmp->next)
        {
            printf("%d\t",tmp->data);
        }
    }
    return 0;
} 
```

Whenever i am trying to print the elements of the linked list, however even though the list is empty, it gives the output

```
The elements are 5640144 
```

What am i doing wrong ? Am i declaring the start pointer correctly ?

Why do i need to do this (actually i was not doing this initially, but was asked to by one of my friends)

```
start=(struct node *)malloc(sizeof(struct node));
start->next=NULL; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T14:35:07.230

声明指向节点 ( `start`) 的指针实际上并不创建节点本身 - 您需`malloc()`要这样做。但是，`malloc()`不必费心用合理的值填充节点，这就是为什么你会在`data`. `start->data = 42;`之后试试`start->next = NULL;`。

编辑：请参阅 ArjunShankar 关于不`malloc()`从函数外部调用的评论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T14:45:08.553

目前它可能会给你确定的垃圾值，存在于分配的内存块中，就像你在分配的 start->next = NULL; 未为数据赋值，

请使用 0 的 memset，它将为整个结构初始化内存块为零或初始化结构的某些值。

如果你会使用 gcc ，它可能不会引发这个问题。我想你不会有这个问题。

struct 是全局的，而**start**是指向该结构的指针，在 malloc 的时候，你已经被分配了一个结构大小的内存，被初始化。如果您采用了全局结构变量，则不会遇到这样的问题，因为它在**bss**中进行了初始化。

```
#include <stdio.h>
#include <stdlib.h>
struct node
{
int data;
struct node *next;
}*start;

int main(void)
{
start=(struct node *)malloc(sizeof(struct node));
start->next = NULL;
start->data = 100;
//memset(start,0,sizeof(struct node));
if(start==NULL)
{
    printf("There are no elements in the list");
}
else
{
    struct node *tmp;
    printf("\nThe elemnets are ");
    for(tmp=start;tmp!=NULL;tmp=tmp->next)
    {
        printf("%d\n",tmp->data);
    }
}
return 0;
} 
```

# r - connecting all points (possible conbination) in scatter plot

> ID：11472563
> 
> 赞同：5
> 
> 时间：2012-07-13T14:30:29.200
> 
> 标签：r, plot, line, connect

Here is small dataset:

```
myd <- data.frame(PC1 = rnorm(5, 5, 2), 
PC2 = rnorm (5, 5, 3), label = c("A", "B", "C", "D", "E"))
plot(myd$PC1, myd$PC2)
text( myd$PC1-0.1, myd$PC2, lab = myd$label) 
```

I want connect all possible combination between line with straight (euclidean) distance, to produce some graph like this (preferrably in base graphics or ggplot2)

![enter image description here](../Images/c98e59d058383298aa0a133eb63cdb21.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-13T14:43:33.547

这是基本情节解决方案：

```
plot(myd$PC1, myd$PC2)
apply(combn(seq_len(nrow(myd)), 2), 2, 
      function(x) lines(myd[x, ]$PC1, myd[x, ]$PC2)) 
```

![在此处输入图像描述](../Images/79a2e51bc57b902d4d6e349173379425.png)

这是 ggplot2 解决方案：

```
ps <- data.frame(t(apply(combn(seq_len(nrow(myd)), 2), 2, 
                         function(x) c(myd[x, ]$PC1, myd[x, ]$PC2))))
qplot(myd$PC1, myd$PC2) +
  geom_segment(data = ps, mapping = aes(x = X1, xend = X2, y = X3,yend = X4)) 
```

![在此处输入图像描述](../Images/d610a654f71beb17a5d614da60df3d52.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T14:48:30.110

在 ggplot 中，您可以使用它`geom_segment`来绘制连接线。

但首先你必须用每条连接线的坐标构建一个数据框。用于`combn()`查找所有组合：

```
comb <- combn(nrow(myd), 2)
connections <- data.frame(
  from = myd[comb[1, ], 1:2],
  to   = myd[comb[2, ], 1:3]
)
names(connections) <- c("x1", "y1", "x2", "y2", "label") 
```

然后绘制：

```
library(ggplot2)

ggplot(myd, aes(PC1, PC2)) + 
  geom_point(col="red", size=5) + 
  geom_segment(data=connections, aes(x=x1, y=y1, xend=x2, yend=y2), col="blue") 
```

![在此处输入图像描述](../Images/35651d469b886ff6935ef5b623a16ed8.png)

# string - What is optimal algorithm to make all possible combinations of a string?

> ID：11472566
> 
> 赞同：2
> 
> 时间：2012-07-13T14:30:34.320
> 
> 标签：string, algorithm, permutation

I find other similar question too complicated.

I think it means if we are given pot then combinations will be pot opt top pot pto pot

so I wrote the following code:

```
#include<iostream>
#include<string.h>
using namespace std;

int main(){

    char s[10];
    char temp;
    cin>>s;
    char t[10];
    for(int i=0;i<3;i++)
    {
        for(int j=i;j<3;j++)
        {

            strcpy(t,s);
            temp=s[i];
            s[i]=s[j];
            s[j]=temp;

            cout<<s<<"\n";
            strcpy(s,t);
        }
    } 
```

Is there a better way ?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T14:59:24.917

这个问题本质上是一个 O(N!)（阶乘）复杂性问题。原因是对于每个潜在单词的每个位置，可以填充该位置的字符的可能性会递减，例如 4 个字母 a、b、c 和 d。

```
 -----------------
Positions: | 0 | 1 | 2 | 3 |
           -----------------

In position 0, there are 4 possibilities, a, b, c, or d

Lets fill with a

        -----------------
String: | a |   |   |   |
        -----------------

Now Position 1 has 3 possibilities of fill letters b, c, or d

Lets fill with b

        -----------------
String: | a | b |   |   |
        -----------------

Now Position 2 has 2 possibilities of fill letters c, or d

Lets fill with c

        -----------------
String: | a | b | c |   |
        -----------------

Now Position 1 has only 1 possibility for a fill letter: d

        -----------------
String: | a | b | c | d |
        ----------------- 
```

这仅适用于 1 个字符串，复杂性来自（在这种情况下）可以填充给定输出单词的字符位置的潜在可能性，因此：

```
4 * 3 * 2 * 1 = 4! 
```

这可以扩展到任意数量的输入字母，并且正好是 N！如果没有重复的字母。这也代表了您应该得到的单词数量。

执行此类操作的代码可能是（在 C 中测试和工作）：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define TRUE  1
#define FALSE 0

void printPermutations(int level, const char * inString, char * outString){

    unsigned int len = strlen(inString);
    char * unusedLetter;
    int j;

    if( 1 == len ){
        printf("%s%s\n", outString, inString);
    }else{
        unusedLetters = (char *)malloc(sizeof(char) * (len - 1));

        for(int startLetter = 0; startLetter < len; startLetter++){

            outString[level] = inString[startLetter];

            // setup the "rest of string" string
            j = 0;
            for(int i = 0; i < len; i++){ 
                if( i != startLetter ){        
                    unusedLetter[j] = inString[i];
                    j++;
                }
            }

            // recursive call to THIS routine
            printPermutations(level+1, unusedLetters, outString);
        }
    }
}

int main(int argc, char * argv[]){
    unsigned int len;
    char * outString;

    if(argc != 2) return 0;

    len = strlen(argv[1]);
    outString      = (char *)malloc(sizeof(char) * (len + 1));
    outstring[len] = '\0';

    printPermutations(0, argv[1], outString);

    return 0;
} 
```

从外部调用如下：

```
projectName abc 
```

使用“abc”的示例输出

```
abc
acb
bac
bca
cab
cba 
```

如果有重复的字母，让我们说 a、a、b、c

那么总会有重复的话。

在这些情况下，UNIQUE 结果词的数量应该是唯一字符的数量，因此对于上述情况，它将是 3！不是4！。

这样做的原因是，a 中的哪个填充给定位置并不重要，因此唯一性是由提供的唯一字母的数量给出的。这也是一个难题，在某种程度上我会说你应该生成 ALL N！首先是单词，然后运行第二个算法来搜索重复的单词并删除。可能有更聪明的方法可以即时生成独特的单词。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-13T20:04:15.997

以下解决方案是 O(N!)。这也考虑了重复：

```
 #include<stdio.h>
    void permute(char s[10],char *p);
    int count=0;

    main(){
        char s[10];
        int i;
        scanf("%s",s);
        permute(s,s);
        }

    //takes into account repetetion
    void permute(char s[10],char *p){
        char *swap,temp;
        if(*(p+1)==0) {
            count++;
            printf("%4d] %s\n",count,s);
        }
        else{
            for(swap=p;*swap;++swap){
                char *same;
                for(same=p;*same!=*swap;++same){};
                if(same==swap){
                temp=*swap;
                *swap=*p;
                *p=temp;
                permute(s,p+1);
                *p=*swap;/*restoring the original string*/
                *swap=temp;
                }
            }
        }
    } 
```

# css - percentage margin issue in chrome & IE

> ID：11472575
> 
> 赞同：0
> 
> 时间：2012-07-13T14:30:45.023
> 
> 标签：css, percentage

I have built a slider which expands to fit the window, and have `#prev` and `#next` pager buttons (which are highlighted in green). As the slider changes size I need to have these buttons positioned with a top margin as a percentage value. This is fine in Firefox but in Chrome and IE it doesn't read this margin. If I put it as a px value it works fine but obviously doesn't adjust to fit the slider size. Please advise...

[http://subzerostudio.com/Clients/perkinreveller/index.html](http://subzerostudio.com/Clients/perkinreveller/index.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:39:39.297

Chris，您可以定期修改**top值，而不是定期更改****margin-top**值。

 **由于您已将两个按钮定位为绝对按钮，因此最好使用 left 和 top 值而不是边距 - 坦率地说，因为一旦您可以自由使用 left、top、right、bottm 值，边距就没有多大意义CSS。

希望这对您有所帮助。我尝试在 Chrome 和 FF 中删除边距，之后它们看起来都一样。一旦你到达这个位置，你就可以修改**最高**值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T14:36:52.437

您可以尝试绝对定位按钮，“顶部”值为 50%，然后是按钮高度的负边距顶部（以像素为单位）。

如果您将按钮设置为相对较小且不会改变的固定尺寸，那么这将是可行的。

这似乎是 Flexi-SLider 的工作原理，也是目前领先的响应式滑块之一。

[http://flexslider.woothemes.com/](http://flexslider.woothemes.com/)**

# jquery - Adding Jquery autocomplete to a Html.EditorFor

> ID：11472579
> 
> 赞同：1
> 
> 时间：2012-07-13T14:31:04.547
> 
> 标签：jquery, asp.net-mvc, razor, jquery-autocomplete

I want to add an autocomplete (suggestion function) to an editor field in my create menu.

I have this basic razor view `@Html.EditorFor(model => model.Title)` and I want to add my autocomplete to this.

Previously I have used

```
<input type="text" name="q"  data-autocomplete="@Url.Action("QuickSearch", "Person")" />
<input  type="submit"  name="submit"  value="Find FullName" /> 
```

And I wondered how to implement this.

My Jquery searches for data-autocomplete

```
$(document).ready(function () {
    $(":input[data-autocomplete]").each(function () {
        $(this).autocomplete({ source: $(this).attr("data-autocomplete") });
   });
}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:47:08.507

你仍然可以做你以前做过的事情

```
@Html.TextBoxFor(model => model.Title, new { data_autocomplete="/link" }) 
```

请注意，这是`TextBoxFor`和不是`EditorFor`。还要注意`_`在`data_autocomplete`

我不确定这`Url.Action`部分。您可能必须通过手动插入 url 而不是使用 url.action 自己构建 url。

# mercurial - HG: How to push some (but not all) changes to 'stable' branch?

> ID：11472582
> 
> 赞同：3
> 
> 时间：2012-07-13T14:31:12.030
> 
> 标签：mercurial, tortoisehg

Say I do my new feature development either in **default**, or an entirely new branch made just for the feature for a web site project. When it comes time to push the feature out to the live website, I want to move it to the **live** branch, which I then `hg archive` to my apache directory.

Throughout everything, I want to be absolutely sure not to push other, unrelated changes that are not yet ready to be published to the **live** branch.

1.  Is this even a good idea? Or should I be doing something entirely different?

2.  If the code is in **default**, how do I push only the one thing I need and not everything to **live**? If I push just the latest changeset, is it smart enough to send the latest version of those files, or will it only do the changesets?

3.  If the code is in an entirely new branch, do I merge the whole branch into **live**? How do I get those changes back to my **default** branch so I see them there too?

4.  I was reading the "Task Based Management" section of the [Mercurial Kick Start](http://mercurial.aragost.com/kick-start/en/tasks/#merging-default-into-a-branch) guide and it mentions merging **default** into your branch. I found this very confusing and was wondering why you'd ever do this.

Thanks for any help you guys can provide.

[edit] I'm using TortoiseHG BTW [/edit]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T18:39:05.367

HG 现在有[Phases](http://mercurial.selenic.com/wiki/Phases)。将变更集的一个阶段更改为秘密，当您使用推送时，它不会被推送。您可以使用 TortoiseHG GUI 来完成。

除此之外，请注意，仅推送或拉取某些内容不会自动更改工作目录中的任何文件。它只提供一些额外的变更集。只有使用更新才能真正更改工作目录中的任何文件。（除非您将 hg 配置为自动更新）。

在您链接的示例中，默认分支中有一个错误修复。Bob 也想在他的分支中进行此修复，因此他将默认分支与他的分支合并。这只是一个查看分支如何工作的示例。您不必以完全相同的方式使用它。如果您刚刚开始 Mercurial 冒险，那么您最好只使用一个分支，直到您有充分的理由使用更多分支。

例如：3 个开发人员在同一个项目上工作，他们都只使用一个分支（默认）。1 位开发人员想要对代码进行重大重构。他想提交几个非常不稳定的变更集（许多“在工作中”）。在默认分支中这样做可能会让其他开发人员感到不安。这是创建分支的好理由。在他的版本足够稳定后，他会将他的分支合并为默认分支。当他在他的分支中进行开发时，他想与其他开发人员保持同步，因此他经常将默认值合并到他的分支中。在单独的分支中停留太久可能会导致合并困难。幸运的是，HG 中的合并非常快，所以要经常合并。

# c# - 以编程方式在 wpf 中填充网格：自动行高似乎不起作用

> ID：11472588
> 
> 赞同：2
> 
> 时间：2012-07-13T14:31:37.357
> 
> 标签：c#, .net, wpf, user-controls, grid

我正在用行以编程方式填充 WPF 网格。每行都分配有一个用户控件。此用户控件包含一个 Grid 本身，恰好有 1 行和 3 列。第 3 列可以包含一个 TextBox、一个 ComboBox 或 ListBox 中可变数量的 CheckBox。

虽然我已将用户控件中的行高和包含用户控件的网格设置为自动，但行的高度不会扩展。较低的复选框就消失了。我尝试了不同的东西，但还没有运气。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-06-03T08:18:26.243

要从 XAML 设置“自动”宽度或高度，您可以使用 double.Nan 代替“Value="Auto"”。

```
<DataGrid>
   <DataGrid.RowStyle>
      <Style TargetType="{x:Type DataGridRow}">
         <Setter Property="Height" Value="{x:Static sys:Double.NaN}"/>
      </Style>
   </DataGrid.RowStyle
</DataGrid> 
```

不要忘记添加

```
xmlns:sys="clr-namespace:System;assembly=mscorlib" 
```

在 XAML 的头部使用“sys”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T13:38:21.427

您可以在自己后面的代码中计算行高...

```
myGrid.RowHeight = myGrid.RenderSize.Height / myGrid.ItemsSource.Cast<MyRowDef>().Count(); 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-07-13T18:43:15.257

嗨试试这样

```
 <DataGrid>
        <DataGrid.RowStyle>
            <Style TargetType="{x:Type DataGridRow}">
                <Setter Property="Height" Value="Auto"/>
            </Style>
        </DataGrid.RowStyle>
    </DataGrid> 
```

在代码隐藏中

```
DataGrid dg=new DataGrid();
        Style style = new Style(typeof(DataGridRow));
        style.Setters.Add(new Setter(DataGridRow.HeightProperty,new GridLength(20, GridUnitType.Auto)));
        dg.RowStyle=style; 
```

我希望这将有所帮助。

# installation - 在 NSIS 中使用 MSIEXEC 安装.exe（程序根本不安装）

> ID：11472591
> 
> 赞同：-1
> 
> 时间：2012-07-13T14:31:40.627
> 
> 标签：installation, nsis

我尝试在 NSIS 脚本中安装程序 (.exe) 这是我的代码

```
;Install PDFXVIEWER
SetOutPath "$INSTDIR\PdfViewer"
File /r "file\PdfViewer\PDFXV.exe"  
ExecWait 'msiexec /i "file\PdfViewer\PDFXV.exe" /VERYSILENT /NORESTART /DIR="$INSTDIR\PdfViewer"' 
```

但是，在安装过程中，我弹出了一个 Windows 安装程序！：http: [//i.stack.imgur.com/g8Gdh.jpg](http://i.stack.imgur.com/g8Gdh.jpg)

并且根本没有安装该程序。

谁能指出我的错误？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T14:56:39.037

msiexec 用于安装 .msi 文件（请记住使用完整路径）。您应该能够正常执行.exe文件...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T21:54:34.903

`exec`文档：

> 请注意，指定的文件必须存在于目标系统上，而不是编译系统上。

`"file\PdfViewer\PDFXV.exe"`是编译计算机上的文件，而不是目标系统，你应该把它改成`"$INSTDIR\PdfViewer\PDFXV.exe"`

# c# - 将位图转换为单色

> ID：11472597
> 
> 赞同：10
> 
> 时间：2012-07-13T14:31:58.340
> 
> 标签：c#, image, bitmap, thermal-printer

我正在尝试将图像保存为单色（黑白，1 位深度），但我不知道该怎么做。

我从 png 开始并转换为用于打印的位图（它是热敏打印机，无论如何只支持黑色 - 如果我尝试将它们作为彩色/灰度发送，它对于大图像的速度非常慢）。

到目前为止，我的代码将其转换为位图非常简单，但它保留了原始颜色深度。

```
Image image = Image.FromFile("C:\\test.png");

byte[] bitmapFileData = null;
int bitsPerPixel = 1;
int bitmapDataLength;

using (MemoryStream str = new MemoryStream())
{
    image.Save(str, ImageFormat.Bmp);
    bitmapFileData = str.ToArray();
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-16T11:11:47.540

这是我放在一起的一些代码，它采用全彩色（24 位/像素）图像，并将其转换为 1 位/像素输出位图，应用标准 RGB 到灰度转换，然后使用 Floyd-Steinberg 将灰度转换为1 位/像素输出。

请注意，这绝不应该被视为“理想”的实现，但它确实有效。如果您愿意，可以应用许多改进。例如，它将整个输入图像复制到`data`数组中，而我们实际上只需要在内存中保留两行（“当前”和“下”行）来累积错误数据。尽管如此，性能似乎可以接受。

```
public static Bitmap ConvertTo1Bit(Bitmap input)
{
    var masks = new byte[] { 0x80, 0x40, 0x20, 0x10, 0x08, 0x04, 0x02, 0x01 };
    var output = new Bitmap(input.Width, input.Height, PixelFormat.Format1bppIndexed);
    var data = new sbyte[input.Width, input.Height];
    var inputData = input.LockBits(new Rectangle(0, 0, input.Width, input.Height), ImageLockMode.ReadOnly, PixelFormat.Format24bppRgb);
    try
    {
        var scanLine = inputData.Scan0;
        var line = new byte[inputData.Stride];
        for (var y = 0; y < inputData.Height; y++, scanLine += inputData.Stride)
        {
            Marshal.Copy(scanLine, line, 0, line.Length);
            for (var x = 0; x < input.Width; x++)
            {
                data[x, y] = (sbyte)(64 * (GetGreyLevel(line[x * 3 + 2], line[x * 3 + 1], line[x * 3 + 0]) - 0.5));
            }
        }
    }
    finally
    {
        input.UnlockBits(inputData);
    }
    var outputData = output.LockBits(new Rectangle(0, 0, output.Width, output.Height), ImageLockMode.WriteOnly, PixelFormat.Format1bppIndexed);
    try
    {
        var scanLine = outputData.Scan0;
        for (var y = 0; y < outputData.Height; y++, scanLine += outputData.Stride)
        {
            var line = new byte[outputData.Stride];
            for (var x = 0; x < input.Width; x++)
            {
                var j = data[x, y] > 0;
                if (j) line[x / 8] |= masks[x % 8];
                var error = (sbyte)(data[x, y] - (j ? 32 : -32));
                if (x < input.Width - 1) data[x + 1, y] += (sbyte)(7 * error / 16);
                if (y < input.Height - 1)
                {
                    if (x > 0) data[x - 1, y + 1] += (sbyte)(3 * error / 16);
                    data[x, y + 1] += (sbyte)(5 * error / 16);
                    if (x < input.Width - 1) data[x + 1, y + 1] += (sbyte)(1 * error / 16);
                }
            }
            Marshal.Copy(line, 0, scanLine, outputData.Stride);
        }
    }
    finally
    {
        output.UnlockBits(outputData);
    }
    return output;
}

public static double GetGreyLevel(byte r, byte g, byte b)
{
    return (r * 0.299 + g * 0.587 + b * 0.114) / 255;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-13T14:47:42.207

你想要的是一个很好的抖动算法，比如[Floyd-Steinberg](http://en.wikipedia.org/wiki/Floyd%E2%80%93Steinberg_dithering)或[Bayer ordered](https://stackoverflow.com/questions/4441388/bayer-ordered-dithering)。您可以自己实现二值化，也可以使用[AForge.NET](http://www.aforgenet.com/framework/samples/image_processing.html)之类的库为您完成（下载图像处理示例）。[您可以在此处](http://www.aforgenet.com/framework/docs/html/549e49e8-2934-ea5e-64a0-ecbdb23afb95.htm)找到二值化文档。

# c# - 在 wpf 中删除情节提要中的问题

> ID：11472603
> 
> 赞同：1
> 
> 时间：2012-07-13T14:32:21.757
> 
> 标签：c#, wpf, storyboard

```
<Window
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
x:Class="QWERTY.animation"
x:Name="Window"
Title="animation"
Width="640" Height="480">
<Window.Resources>
    <Storyboard x:Key="Animation">
        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(TextElement.FontSize)" Storyboard.TargetName="btn_1">
            <EasingDoubleKeyFrame KeyTime="0" Value="11"/>
            <EasingDoubleKeyFrame KeyTime="0:0:0.3" Value="10.667"/>
        </DoubleAnimationUsingKeyFrames>
        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(TextElement.FontWeight)" Storyboard.TargetName="btn_1">
            <DiscreteObjectKeyFrame KeyTime="0">
                <DiscreteObjectKeyFrame.Value>
                    <FontWeight>Normal</FontWeight>
                </DiscreteObjectKeyFrame.Value>
            </DiscreteObjectKeyFrame>
            <DiscreteObjectKeyFrame KeyTime="0:0:0.3">
                <DiscreteObjectKeyFrame.Value>
                    <FontWeight>Bold</FontWeight>
                </DiscreteObjectKeyFrame.Value>
            </DiscreteObjectKeyFrame>
        </ObjectAnimationUsingKeyFrames>
        <ColorAnimationUsingKeyFrames Storyboard.TargetProperty="(Panel.Background).(GradientBrush.GradientStops)[1].(GradientStop.Color)" Storyboard.TargetName="btn_1">
            <EasingColorKeyFrame KeyTime="0" Value="#FFEAF0ED"/>
            <EasingColorKeyFrame KeyTime="0:0:0.3" Value="#FF106285"/>
        </ColorAnimationUsingKeyFrames>
    </Storyboard>
</Window.Resources>

<Grid x:Name="LayoutRoot">
    <Button x:Name="btn_2" Content="B" Height="55" Margin="236,98,0,0" VerticalAlignment="Top" Click="btn_2_Click" HorizontalAlignment="Left" Width="72" />
    <Button x:Name="btn_1" Content="A" Height="55" Margin="115,98,0,0" VerticalAlignment="Top" HorizontalAlignment="Left" Width="72" Click="btn_1_Click">
        <Button.Background>
            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                <GradientStop Color="White" Offset="0"/>
                <GradientStop Color="#FFEAF0ED" Offset="0.9"/>
            </LinearGradientBrush>
        </Button.Background>
    </Button>
    <Button Content="Remove" HorizontalAlignment="Left" Margin="173,179,0,217" Width="75" Click="Button_Click" />
</Grid> 
```

```
The design will be like below 
```

![在此处输入图像描述](../Images/19dbe48917d76f9ec58c14863de52f80.png)

```
public partial class animation : Window
        {
    Storyboard SB;
    public animation()
    {
        this.InitializeComponent();         
    }

    public void Animate(string name)
    {
        SB = (Storyboard)(FindResource("Animation"));
        Storyboard.SetTargetName(SB.Children[0], name);
        Storyboard.SetTargetName(SB.Children[1], name);
        Storyboard.SetTargetName(SB.Children[2], name);
        SB.Begin();            
    }
    private void btn_1_Click(object sender, RoutedEventArgs e)
    {
        Button Btn_1 = (Button)sender;
        Animate(btn_1.Name);
    }

    private void btn_2_Click(object sender, RoutedEventArgs e)
    {
        Button Btn_2 = (Button)sender;
        Animate(Btn_2.Name);
    }

    private void Button_Click(object sender, RoutedEventArgs e)
    {
        SB.Remove();
    }
} 
```

它的输出将如下所示

![输出](../Images/4b2fa080569157fc9f5c9aab7c54e521.png)

上面的结果是我一个一个地点击了两个按钮之后。然后我点击了删除按钮，只有**按钮B**动画被删除了。但我想通过单击删除按钮来删除 **按钮 A 和按钮 B 动画**。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T16:20:53.163

一次只能将一个 TargetName 分配给 Storyboard。通过使用 SetTargetName，您将目标转移到新按钮。然后，当您单击删除时，您将删除您添加的最后一个。看看这个针对 SilverLight的[博客，但应该在这里申请。](http://blogs.msdn.com/b/silverlight_sdk/archive/2008/03/26/target-multiple-objects-properties-with-one-animation-silverlight.aspx)您唯一的其他选择是使用[`Style.Triggers`](http://msdn.microsoft.com/en-us/library/system.windows.style.triggers.aspx)您的动画并将其放入样式中。

从上面的链接：

> 在此示例中，可能不希望在一个矩形上停止动画，以便动画可以在另一个矩形上开始。也许您希望两个动画同时运行。但是，您不能使用同一个动画对象同时运行两个单独的动画，因为只有一个 TargetName。这并不意味着您又要为每个对象创建单独的 Storyboard。相反，您需要为每个想要同时（同步）运行的动画创建一个 Storyboard。

# django - 在 Django 管理页面中向用户的个人信息添加字段

> ID：11472606
> 
> 赞同：4
> 
> 时间：2012-07-13T14:32:37.997
> 
> 标签：django, django-admin, user-profile

我刚刚开始了一个 Django 项目（其中没有应用程序）。我激活了`admin`设置文件，可以访问 Django 管理页面。django页面有添加用户的栏目；在添加用户时，我只在个人信息下获得三个字段，但我需要存储更多关于用户的信息。我搜索了一下，发现我可以使用用户配置文件来完成此操作。我试过了，但我遇到了问题。

我的目标是在用户表中再添加三个字段：

1.  角色
2.  联系电话
3.  其他

我需要详细信息，例如：我需要编写哪个函数以及在哪里执行此操作。

我找到[了这个](http://blog.bripkens.de/2011/04/adding-custom-profiles-to-the-django-user-model/)，但我不知道我需要在哪里编写这些步骤。我将不胜感激对此进行更清晰的解释。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T14:47:33.497

Django 用户配置文件是您所需要的。您链接到的博客有明确的步骤。您可以查看 Django 文档。[http://www.turnkeylinux.org/blog/django-profile](http://www.turnkeylinux.org/blog/django-profile)也提供了很好的解释。基本上，您需要使用 User as ForeignKey 创建一个新模型，并在`settings.py`as中定义模型`AUTH_PROFILE_MODULE = "django_app.your_profile_modelname"`。创建配置文件并像任何其他模型一样保存它，然后使用`user.get_profile()`

添加几件事以回答您的以下问题：首先，不要将应用程序创建为目录。按照此处所述使用`startapp <appname> [destination]`。这将创建应用程序目录。其次，您必须将应用程序添加到`INSTALLED_APPS`项目的设置文件中，执行`syncdb`. 基本上，按照[Django 教程中的步骤编写您的第一个应用程序](https://docs.djangoproject.com/en/dev/intro/tutorial01/)。第三，`UserProfile`是一个单独的模型。它不是`User`. 它与 相关联，`User`因为您添加`User`为`ForeignKey`. 第四，为了能够在 admin 中查看用户配置文件模型，您完全可以[将任何其他模型添加到 admin 页面](https://docs.djangoproject.com/en/dev/ref/contrib/admin/)。在您的应用程序下创建一个文件名`admin.py`：

```
from django.contrib import admin
from myproject.app.models import UserProfile
admin.site.register(UserProfile) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T15:17:37.457

需要理解三个关键概念：

1.  `auth`除了真正适合用户登录的有限应用程序之外，Django 中没有内置的“配置文件”系统。您应该自己滚动。
2.  个人资料记录本身并没有什么神奇之处，它就像任何其他`User`作为外键的记录（或者，更准确地说，[根据 docs 是一对一的字段](https://docs.djangoproject.com/en/dev/topics/auth/#storing-additional-information-about-users)）。您可以通过创建自定义 django 应用程序（传统上称为`profiles`）和该应用程序的模型（传统上称为`UserProfile`，因为`Profile`不允许作为模型名称）来创建它。
3.  作为模型的唯一`UserProfile`区别是您将其指定为，`AUTH_PROFILE_MODULE`这意味着`.get_profile()`在`User`记录上调用它时可以访问它。就是这样。如果你这样设置`UserProfile`：

    ```
    def UserProfile(models.Model):
        user = models.OneToOneField(User, related_name='profile')
        other fields 
    ```

    那么您也可以访问个人资料`user.profile`而不是`user.get_profile()`某些人喜欢的个人资料。

再说一次，轮廓模型并没有什么神奇之处——它只是一个模型记录，就像任何其他模型记录一样。

如果您希望能够在更复杂的用户表单中编辑其他字段；最简单的方法可能是取消注册`User`，然后使用您的自定义`ModelAdmin`和表单类再次注册，但根据您的问题判断，您可能还没有达到那个级别。

# jquery - JQuery - 如何使表格中的单元格设置宽度和高度？

> ID：11472608
> 
> 赞同：-1
> 
> 时间：2012-07-13T14:32:53.297
> 
> 标签：jquery

每次我运行程序时，表格中的单元格的大小都会根据其中的字母而有所不同。我一直在摆弄 CSS，但没有运气，有人可以帮忙吗？

```
 var listOfWords = ["mat", "cat", "dog", "pit", "pot", "fog", "log", "pan", "can", "man", "pin", "gag", "sat", "pat", "tap", "sap", "tag", "gig", "gap", "nag", "sag", "gas", "pig", "dig", "got", "not", "top", "pop", "god", "mog", "cot", "cop", "cap", "cod", "kid", "kit", "get", "pet", "ten", "net", "pen", "peg", "met", "men", "mum", "run", "mug", "cup", "sun", "mud", "rim", "ram", "rat", "rip", "rag", "rug", "rot", "dad", "sad", "dim", "dip", "did", "mam", "map", "nip", "tin", "tan", "nap", "sit", "tip", "pip", "sip", "had", "him", "his", "hot", "hut", "hop", "hum", "hit", "hat", "has", "hug", "but", "big", "bet", "bad", "bad", "bed", "bud", "beg", "bug", "bun", "bus", "bat", "bit", "fit", "fin", "fun", "fig", "fan", "fat", "lap", "lot", "let", "leg", "lit"];

 var shuffledWords = listOfWords.slice(0).sort(function () {
   return 0.5 - Math.random();
   }).slice(0, 12);

var tbl = document.createElement('table');
   tbl.className='tablestyle';
   var wordsPerRow = 2;

for (var i = 0; i < shuffledWords.length; i += wordsPerRow) {
   var row = document.createElement('tr');

for (var j=i; j < i + wordsPerRow; ++ j) {
    var word = shuffledWords[j];

    for (var k = 0; k < word.length; k++){
        var cell = document.createElement('td');

        cell.textContent = word[k];
        // IF FIREFOX USE cell.textContent = word[j]; INSTEAD
        row.appendChild(cell);
       }
   }
   tbl.appendChild(row);    
}

document.body.appendChild(tbl); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T15:33:36.643

您是否弄乱了最小宽度、最大宽度和字母间距设置？在这里，我将其设置为 42px（只是任意的），并将所有列设置为相同。我相信你也许可以结合使用它来实现你想要的。（我不确定宽度是否也应该是动态的）所以这是你可以玩的。这里只是修改后的演示。

[演示](http://jsfiddle.net/e5BKq/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:38:57.647

> 我已经摆弄了CSS，但没有运气......

这正是 CSS 的用途。这是一个示例：[Live copy](http://jsbin.com/emahex) | [来源](http://jsbin.com/emahex/edit)

CSS：

```
#target td {
  width: 3em;
} 
```

HTML：

```
<table id="target">
  <tbody>
    <tr>
      <td>one</td>
      <td>two</td>
      <td>three</td>
    </tr>
    <tr>
      <td>four</td>
      <td>five</td>
      <td>six</td>
    </tr>
  </tbody>
</table> 
```

（您动态生成内容的事实并不重要。）

# objective-c - 如何（轻松）使用 vCard 更新 ABPerson 对象并保留其唯一 ID？

> ID：11472611
> 
> 赞同：1
> 
> 时间：2012-07-13T14:33:00.300
> 
> 标签：objective-c, macos, abaddressbook, abperson

AddressBook 框架提供了一个很好的方法来使用 vCard 初始化 ABPerson，通过使用该`initWithVCardRepresentation:`方法。

我想做的是用某个 vCard*更新联系人。*我不能使用`initWithVCardRepresentation:`，因为这会给我一个带有新 uniqueId 的新 ABPerson 对象，我想在这些更改之间保留 uniqueId。

做这样的事情有什么简单的方法？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T18:28:14.017

`initWithVCardRepresentation`仍然是将您的 vCard 转换为`ABPerson`.

只需使用它的结果在您的通讯簿中找到匹配的人，然后遍历 vCard 属性，将它们放入现有记录中。最后的保存将强化您的更改。

以下示例假定唯一的“键”为`last-name`, `first-name`。如果要包括未列出名称的公司或其他任何内容，则可以修改搜索元素，或者您可以通过获取 [AddressBook people] 来更改迭代方案，然后迭代人员并仅使用键值对的那些记录对匹配到您的满意。

```
- (void)initOrUpdateVCardData:(NSData*)newVCardData {
    ABPerson* newVCard = [[ABPerson alloc] initWithVCardRepresentation:newVCardData];
    ABSearchEleemnt* lastNameSearchElement
      = [ABPerson searchElementForProperty:kABLastNameProperty
                                     label:nil
                                       key:nil
                                     value:[newVCard valueForProperty:kABLastNameProperty]
                                comparison:kABEqualCaseInsensitive];
    ABSearchEleemnt* firstNameSearchElement
      = [ABPerson searchElementForProperty:kABFirstNameProperty
                                     label:nil
                                       key:nil
                                     value:[newVCard valueForProperty:kABFirstNameProperty]
                                comparison:kABEqualCaseInsensitive];
    NSArray* searchElements
      = [NSArray arrayWithObjects:lastNameSearchElement, firstNameSearchElement, nil];
    ABSearchElement* searchCriteria
      = [ABSearchElement searchElementForConjunction:kABSearchAnd children:searchElements];
    AddressBook* myAddressBook = [AddressBook sharedAddressBook];
    NSArray* matchingPersons = [myAddressBook recordsMatchingSearchElement:searchCriteria];
    if (matchingPersons.count == 0)
    {
        [myAddressBook addRecord:newVCard];
    }
    else if (matchingPersons.count > 1)
    {
        // decide how to handle error yourself here: return, or resolve conflict, or whatever
    }
    else
    {
        ABRecord* existingPerson = matchingPersons.lastObject;
        for (NSString* property in [ABPerson properties])   // i.e. *all* potential properties
        {
            // if the property doesn't exist in the address book, value will be nil
            id value = [newVCard valueForProperty:property];
            if (value)
            {
                NSError* error;
                if (![existingPerson setValue:value forProperty:property error:&error] || error)
                    // handle error
            }
        }
        // newVCard with it's new unique-id will now be thrown away
    }
    [myAddressBook save];
} 
```

# javascript - jQuery - 满足特定条件时如何调用ajax

> ID：11472612
> 
> 赞同：0
> 
> 时间：2012-07-13T14:33:04.370
> 
> 标签：javascript, jquery

我知道您可以使用该函数`setInterval`以固定的时间间隔调用您的 ajax 函数。我想要实现的是这样的：

```
while (true) //but obviously this while loop will block other code. I'd like it non-blocking
{   //if certain condition is met, call my ajax function.
} 
```

所以基本上代码应该静静地坐在后台，倾听。如果满足某些条件，则触发 ajax 调用。

在 jquery/javascript 中有可能吗？

编辑：对于条件：基本上，我将自动滚动一个大表的行（这是另一个问题，另一个帖子......），一旦它到达最后一行，满足条件，调用 ajax 从中获取数据服务器，重新填充表格，然后再次开始自动滚动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:39:43.293

在 Javascript 中，条件不会自行“满足”。

它（主要）是一种单线程语言，UI 线程只是坐在那里等待事件发生，作为响应，程序员提供的事件处理程序去做一些事情。只要他们在做事，UI 线程就无法再处理任何事件。

这就是为什么您永远不应该使用繁忙的循环，或者以其他方式占用 CPU 在紧密的循环中进行冗长的计算。

总而言之，您*永远*不需要*轮询*条件 - 当该条件变为 true 时应该很明显，因为*某些事件将被触发，允许它变为 true*。

然后，您应该能够*在该事件的处理程序中*触发您的 AJAX 请求。

* * *

**编辑**你现在已经澄清你想要在滚动到达表格末尾时执行此操作。

如上所述，（当然）有一个*事件*告诉您滚动了一些东西，它会告诉您滚动了多远。

看着`http://api.jquery.com/scroll/`

您需要为该事件注册一个处理程序，然后*在该处理程序中*触发您的 AJAX 调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:35:21.940

如果您有活动，当然可以。然后，您可以将处理程序附加到它。所以问题是：什么条件？

# java - 如何更改显示标签排序属性链接

> ID：11472616
> 
> 赞同：1
> 
> 时间：2012-07-13T14:33:25.240
> 
> 标签：java, displaytag

我在我的应用程序中使用显示标签。在那我需要根据列标题单击对表格内容进行排序。列标题具有链接导航。相反，我需要在单击表格列标题时提交表单。我们怎样才能实现它。

截至目前，我的应用程序像这样创建表格，

```
<display:table id="data" name="lstEntities"
                        sort="external" uid="row" htmlId="rowid" class="tborder"
                        excludedParams="*" style="width:100%"
                        pagesize="${pageCriteria.recordsPerPage}" partialList="true"
                        size="${pageCriteria.totalRecords}" export="false"
                        requestURI="prestigeBrandListMDA.action">
                        <display:column property="brandId" sortName="brand.brandId"
                            sortable="true" titleKey="table.title.brandId"
                            style="width:100px" />

<thead>
<tr>
<th class="sortable">
<a href="prestigeBrandListMDA.action?d-16544-p=1&amp;d-16544-o=2&amp;d-16544-n=1&amp;d-16544-s=brand.brandId">Sales Brand Id</a></th> 
```

相反，我需要如下链接

```
<thead>
<tr>
<th class="sortable">
<a href="#" onclick="javascript:submitform(prestigeBrandListMDA.action?d-16544-p=1&amp;d-16544-o=2&amp;d-16544-n=1&amp;d-16544-s=brand.brandId)">Sales Brand Id</a></th> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T09:56:00.823

是的，我使用 Jquery 来实现此功能。谢谢。我使用以下代码来实现它。

```
$('.sortable').each(function(event){ 
                var obj = $(this).find('a').attr('href'); 
                var urltext = 'javascript:submitform("'+contextPath+'/'+obj+'\")';  
                $(this).find('a').attr('href', urltext);
            }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T16:51:25.450

据我所知，使用 displaytag 无法做到这一点。使用 JQuery[就绪事件](http://api.jquery.com/ready/)动态更改链接。

# c# - 在与 websevice 下拉列表的 ajax 级联中，第二个下拉列表显示方法错误 500

> ID：11472618
> 
> 赞同：1
> 
> 时间：2012-07-13T14:33:36.430
> 
> 标签：c#, asp.net, cascadingdropdown

我有 2 个下拉菜单，第一个下拉菜单工作正常，显示数据库中的数据，但第二个下拉菜单显示错误 500。这是我的 web 服务代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Services;
using System.Configuration;
using System.Data.SqlClient;
using System.Collections.Specialized;
using AjaxControlToolkit;
using System.Data;

[WebService(Namespace = "http://tempuri.org/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
// To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. 
[System.Web.Script.Services.ScriptService]
public class CascadingDropdown : System.Web.Services.WebService
{
private static  string strconnection = ConfigurationManager.ConnectionStrings["ConnectionString"].ToString();
//private static string strconnection =  ConfigurationManager.AppSettings["ConnectionString"].ToString();
SqlConnection concategory = new SqlConnection(strconnection);

public CascadingDropdown()
{

    //Uncomment the following line if using designed components 
    //InitializeComponent(); 
}

[WebMethod]
public CascadingDropDownNameValue[] BindCategoryDetails(string knownCategoryValues, string category)
{

    concategory.Open();
    SqlCommand cmdcategory = new SqlCommand("select * from Categories", concategory);
    //create list and add items in it by looping through dataset table
    List<CascadingDropDownNameValue> categorydetails = new List<CascadingDropDownNameValue>();
    SqlDataReader drcategory= null ;
    drcategory=cmdcategory.ExecuteReader();
    while(drcategory.Read())
    {
         string    CategoryID = drcategory ["categoryID"].ToString();
         string    CategoryName = drcategory ["categoryName"].ToString();
         categorydetails.Add(new CascadingDropDownNameValue(CategoryName, CategoryID));
    }
    concategory.Close();
    return categorydetails.ToArray();
}
/// <summary>
/// WebMethod to Populate State Dropdown
/// </summary>
[WebMethod]
public CascadingDropDownNameValue[] BindProductDetails(string knownCategoryValues, string category)
{
    int categoryID;
    //This method will return a StringDictionary containing the name/value pairs of the currently selected values
    StringDictionary categorydetails = AjaxControlToolkit.CascadingDropDown.ParseKnownCategoryValuesString(knownCategoryValues);
    categoryID = Convert.ToInt32(categorydetails["Category"]);
    concategory.Open();
    SqlCommand cmdproduct = new SqlCommand("select * from Products where categoryID=@categoryID", concategory);
    cmdproduct.Parameters.AddWithValue("@categoryID", categoryID);        
    //create list and add items in it by looping through dataset table
    List<CascadingDropDownNameValue> productdetails = new List<CascadingDropDownNameValue>();      
     SqlDataReader drproduct= null ;
     drproduct=cmdproduct.ExecuteReader();       
    while(drproduct.Read())        {
         string    ProductID = drproduct ["categoryID"].ToString();
         string   ProductName = drproduct ["categoryName"].ToString();
         productdetails.Add(new CascadingDropDownNameValue(ProductName, ProductID));
    }
    concategory.Close();      
    return productdetails.ToArray();

} 
```

}

和aspx代码：

```
<%@ Page Language="C#" AutoEventWireup="true"  CodeFile="Default.aspx.cs" Inherits="_Default"  EnableEventValidation="false"%>
<%@ Register Namespace="AjaxControlToolkit" Assembly="AjaxControlToolkit" tagPrefix="ajax" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
<title></title>
</head>
<body>
<form id="form1" runat="server">
<div>

</div>

<asp:ScriptManager ID="ScriptManager1" runat="server">
</asp:ScriptManager>
<br />
<asp:DropDownList ID="ddlcategory" runat="server"></asp:DropDownList>
<ajax:CascadingDropDown ID="ccdCategory" runat="server" Category="category" 
    TargetControlID="ddlcategory" PromptText="Select Category" 
    LoadingText="Loading Categories" ServiceMethod="BindCategoryDetails" 
    ServicePath="CascadingDropdown.asmx">
</ajax:CascadingDropDown>
<asp:DropDownList ID="ddlproduct" runat="server">
</asp:DropDownList>
<ajax:CascadingDropDown ID="ccdProduct" runat="server" Category="product"
 TargetControlID="ddlproduct" PromptText="Select Product"
  LoadingText="Loading Products" ServiceMethod="BindProductDetails"
   ScriptPath="CascadingDropdown.asmx">
   </ajax:CascadingDropDown>
</form>
</body>
</html> 
```

如果还有什么你需要知道的告诉我。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T15:03:21.387

我认为错误发生在您将 CategoryID 分配给 ProductID 的情况下。在第二个下拉列表绑定代码中

```
 string    ProductID = drproduct ["categoryID"].ToString();
 string   ProductName = drproduct ["categoryName"].ToString(); 
```

上面的代码应该换成这个

```
string    ProductID = drproduct ["ProductID"].ToString();
string   ProductName = drproduct ["ProductName"].ToString(); 
```

# winapi - 如何检测两个文件是否在同一个物理磁盘上？

> ID：11472623
> 
> 赞同：2
> 
> 时间：2012-07-13T14:33:48.693
> 
> 标签：winapi, file-io, disk

我想并行化一些磁盘 I/O，但是如果我的文件在同一个磁盘上，这会严重*影响性能。*

请注意，驱动程序和实际磁盘之间可能存在各种过滤器驱动程序——例如，两个文件可能位于不同的虚拟磁盘 (VHD) 上，但位于同一个物理磁盘上。

如何检测两个`HANDLE`s 是否引用同一物理磁盘上的文件（或分区或其他）？

如果这是不可能的 - 下一个最佳/最接近的选择是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T22:32:43.343

这相当复杂，但第一步是从句柄中获取卷名。您可以使用[GetFinalPathNameByHandle](http://msdn.microsoft.com/en-us/library/windows/desktop/aa364962%28v=vs.85%29.aspx)函数在 Vista 或更高版本上执行此操作。如果您需要支持早期的 Windows 版本，可以使用[此示例](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366789%28v=vs.85%29.aspx)。

现在您有了文件名，您可以解析出驱动器号或卷名，并使用[该问题](https://stackoverflow.com/questions/3824221/volume-to-physical-drive)的已接受答案中解释的方法。

# asp.net - ASP.Net 中的神秘 URL 重新映射

> ID：11472628
> 
> 赞同：0
> 
> 时间：2012-07-13T14:34:05.747
> 
> 标签：asp.net, url-rewriting, isapi, remap

我正在开发一个旧版 ASP.Net Web 表单应用程序，该应用程序正在重新映射站点地图 URL。当我访问 www.mysite.com/sitemap.xml 时，它会重定向到 sitemap.aspx。

我在 web.config 文件中没有看到任何处理 URL 映射的内容，所以我不确定这可能会发生什么。我从不太熟悉这个特定应用程序的同事那里听说，ISAPI 重定向可能已经到位，但我不确定在哪里寻找它，从未处理过它。

有人知道要尝试什么吗？该站点是在 IIS 7.5 中运行的 ASP.Net 2.0。非常感谢。

# r - 从日期数据创建新变量

> ID：11472629
> 
> 赞同：0
> 
> 时间：2012-07-13T14:34:10.737
> 
> 标签：r, date

现在我的数据框如下

> 输入（头部（t.zoo））

```
structure(c(85.92, 85.85, 85.83, 85.83, 85.85, 85.87, 1300, 1300, 
1299.75, 1299.75, 1299.75, 1300), .Dim = c(6L, 2L), .Dimnames = list(
NULL, c("cl", "es")), index = structure(list(sec = c(0.400000095367432, 
0.900000095367432, 1.40000009536743, 1.90000009536743, 2.40000009536743, 
2.90000009536743), min = c(30L, 30L, 30L, 30L, 30L, 30L), hour = c(10L, 
10L, 10L, 10L, 10L, 10L), mday = c(6L, 6L, 6L, 6L, 6L, 6L), mon = c(5L, 
5L, 5L, 5L, 5L, 5L), year = c(112L, 112L, 112L, 112L, 112L, 112L
), wday = c(3L, 3L, 3L, 3L, 3L, 3L), yday = c(157L, 157L, 157L, 
157L, 157L, 157L), isdst = c(1L, 1L, 1L, 1L, 1L, 1L)), .Names = c("sec", 
"min", "hour", "mday", "mon", "year", "wday", "yday", "isdst"
), class = c("POSIXlt", "POSIXt"), tzone = c("", "EST", "EDT"
)), class = "zoo") 
```

我有两个问题，第一个是我想为第一列添加一个变量名，第二个是我想创建一个分类变量来帮助我指出 2010-06-06（因为有 3 个不同的日子）

我应该为日期数据做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T11:09:44.277

`zoo``data.frame`使用 from s 的对象有点不同。

“第一列”（如您所指）实际上不是一列，而是`index`您的对象的列。试试看`index(t.zoo)`它返回什么。这`index`确实应该具有独特的价值；在您的情况下，存在重复的值，这可能会影响您的计算。

转换为 a`data.frame`可以如下进行。我基于`index`from添加了单独的“日期”和“时间”变量`t.zoo`。

```
require(zoo) # Load the `zoo` package if you haven't already done so
t.df = data.frame(Date = format(index(t.zoo), "%Y-%m-%d"), 
                  Time = format(index(t.zoo), "%H:%M:%S"),
                  data.frame(t.zoo))
t.df
#         Date     Time    cl      es
# 1 2012-06-06 10:30:00 85.92 1300.00
# 2 2012-06-06 10:30:00 85.85 1300.00
# 3 2012-06-06 10:30:01 85.83 1299.75
# 4 2012-06-06 10:30:01 85.83 1299.75
# 5 2012-06-06 10:30:02 85.85 1299.75
# 6 2012-06-06 10:30:02 85.87 1300.00 
```

转换回`zoo`对象（保留新的“日期”和“时间”列，或您添加的任何其他列）可以这样完成：

```
zoo(t.df, order.by=index(t.zoo)) 
```

但是请注意，这会给您一个警告，因为您没有唯一的“order.by”值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T17:17:16.027

我不熟悉动物园类，所以下面的代码不是很好，但似乎工作。

```
yourdata<-as.matrix(yourdata)  
justdate <- substr(rownames(yourdata), 1, 10)
justtime <- substr(rownames(yourdata), 11, 19)  
row.names(yourdata) <- NULL  
yourdata<-as.data.frame(yourdata)  
yourdata[,"justdate"]<-justdate  
yourdata[,"justtime"]<-justtime  
yourdata[yourdata$justdate=="2012-06-06","newvariable"]<-1  
> yourdata  
  cl      es   justdate  justtime newvariable  
1 85.92 1300.00 2012-06-06  10:30:00           1  
2 85.85 1300.00 2012-06-06  10:30:00           1  
3 85.83 1299.75 2012-06-06  10:30:01           1  
4 85.83 1299.75 2012-06-06  10:30:01           1  
5 85.85 1299.75 2012-06-06  10:30:02           1  
6 85.87 1300.00 2012-06-06  10:30:02           1 
```

# sql - Oracle：IN 语句的格式字符串

> ID：11472630
> 
> 赞同：0
> 
> 时间：2012-07-13T14:34:15.607
> 
> 标签：sql, oracle

在 varchar2 字段（table1.field1）中，我有这样的内容：;number1;number2;.......;numberN;

我想在 IN 语句中使用这个值，比如：

```
SELECT * FROM table2 WHERE table2.field2 IN table1.field1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:39:33.763

如果 table2.field2 的值是像 number1
number2这样的字符串

然后试试这个：

```
SELECT * 
    FROM table2 
 WHERE EXISTS
    (
        SELECT 1
          FROM table1
         WHERE table1.field1 LIKE '%;' || table2.field2 || ';%'
    ) 
```

如果 table2 与 table1.field1 中的相似，请尝试以下操作：

```
SELECT * 
    FROM table2 
 WHERE field2 IN 
    (
        SELECT field1
          FROM table1
    ) 
```

# putty - C# 中的 PuTTY 用于文件传输

> ID：11472633
> 
> 赞同：0
> 
> 时间：2012-07-13T14:34:32.160
> 
> 标签：putty

任何人都可以用 C# 中的代码片段帮助我使用 PSCP (PuTTY) 传输方法将我本地机器上的文件传输到远程服务器吗？我非常感谢您的帮助。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T14:50:14.510

您可以使用支持 SCP 的库，例如[SSHNet](http://sshnet.codeplex.com/)或[WinSCP](http://winscp.net/eng/docs/library)。两者都提供了演示它们如何工作的示例和测试。

使用 SSH.Net，您可以使用以下代码（来自测试文件）上传文件：

```
using (var scp = new ScpClient(host, username, password))
{
    scp.Connect();
    scp.Upload(new FileInfo(filename), Path.GetFileName(filename));
    scp.Disconnect(); 
```

}

使用 WinSCP 库，代码如下所示（来自[示例](http://winscp.net/eng/docs/library#csharp)）：

```
SessionOptions sessionOptions = new SessionOptions {
            Protocol = Protocol.Sftp,
            HostName = "example.com",
            UserName = "user",
            Password = "mypassword",
            SshHostKey = "ssh-rsa 1024 xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx"
};

using (Session session = new Session())
{
    // Connect
    session.Open(sessionOptions);

    // Upload files
    TransferOptions transferOptions = new TransferOptions();
    transferOptions.TransferMode = TransferMode.Binary;

    TransferOperationResult transferResult;
    transferResult = session.PutFiles(@"d:\toupload\*", "/home/user/", false, transferOptions);

    // Throw on any error
    transferResult.Check();

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-25T06:39:18.617

使用.NET 库`SFTP`并`SCP`支持客户端可能是最佳选择。但这里有一个简单的使用方法`PSCP`：

```
Process cmd = new Process();
cmd.StartInfo.FileName = @"C:\PuTTY\pscp.exe";
cmd.StartInfo.UseShellExecute = false;
cmd.StartInfo.RedirectStandardInput = true;
cmd.StartInfo.RedirectStandardOutput = true;
string argument = @"-pw pass C:\testfile.txt user@10.10.10.10:/home/usr";
cmd.StartInfo.Arguments = argument;

cmd.Start();
cmd.StandardInput.WriteLine("exit");
string output = cmd.StandardOutput.ReadToEnd(); 
```

# java - Lucene 的 Eclipse/Java 源文件问题

> ID：11472641
> 
> 赞同：0
> 
> 时间：2012-07-13T14:34:52.453
> 
> 标签：java, eclipse

每次我在 Eclipse 中以调试模式运行以下代码时：

```
public static void main(String[] args) throws IOException{
    Index index = new Index();
    Thing t = new Thing();
    index.buildIndex(t);    
} 
```

我收到以下错误（在大量堆栈跟踪的末尾）：

'源附件不包含文件 URLClassPath.class 的源'

在第一行之后。

Index 类只使用默认构造函数，没有私有字段，只是在内存中构建事物索引的方法。

整个项目将在 Jboss 服务器上运行，但目前作为独立应用程序运行（在不同的运行配置下）。

应用程序加载器可以在 java 文件夹中找到 src.zip。

有没有其他人有类似的问题？这仅在我尝试调试时发生，而不是在我正确运行应用程序时发生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T17:17:11.830

我相信 Index 类来自 Lucene，当您调试 Eclipse 时会尝试找到它。您可以为您拥有的任何二进制版本获取正确的 Lucene 源，然后查找“Eclipse 附加源”。

# html - 为什么直接操作 Rails 表单参数哈希被认为是代码异味？

> ID：11472642
> 
> 赞同：0
> 
> 时间：2012-07-13T14:34:53.080
> 
> 标签：html, ruby-on-rails, ruby-on-rails-3, forms

我有一个带有父模型的 Rails 表单和另一个模型的可能多个子节点的嵌套属性。

子模型有一个属性，该属性在逻辑中作为数组进行操作，但使用 Rails 内置的序列化方法序列化为 YAML 字符串。

在表单中，我显示了数组的每个单独成员，以便用户可以有选择地删除成员。

当用户销毁所有成员时，就会出现问题。表单不会将参数的任何值传递给 Rails 控制器，当调用 UPDATE 操作时，它会忽略该属性，因为在表单参数哈希中没有它的键。这当然是复选框之类的已知问题，因此 Rails 自动为每个复选框放置 2 个复选框 HTML 元素，一个隐藏的仅在复选框被选中时处理。

我在这里处理的不是复选框，而是隐藏的输入文本字段。

我实现的解决方案是直接在控制器的 UPDATE 操作中操作 params 哈希，如下所示：

```
params[:series][:time_slots_attributes].each { |k,v| v[:exdates] ||= [] } 
```

这被认为是代码气味吗？

我是否应该添加一个额外的隐藏字段，该字段已禁用并且仅在用户删除最后一个成员时才启用？这个解决方案也很有效，但对我来说似乎很笨拙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T17:46:34.370

这在 NestedAttributes 模块中通过允许“_destroy”参数触发对该特定嵌套属性的销毁调用来处理：

[http://apidock.com/rails/ActiveRecord/NestedAttributes/ClassMethods/accepts_nested_attributes_for](http://apidock.com/rails/ActiveRecord/NestedAttributes/ClassMethods/accepts_nested_attributes_for)。

如果您不使用嵌套属性（您可能应该使用嵌套属性，在很多情况下它都非常简洁），那么是的，您必须自己手动处理一些东西，通过计算*应该*存在哪些值并做一些特殊的事情那些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T17:42:51.797

这远不是一个详尽的答案......但是在考虑了这个问题之后，我可以看到的一个问题是，如果构建利用相同 UPDATE 操作的未来表单，则会发生意外行为，这违反了最小意外原则。如果稍后构建第二个表单，它不希望更改 exdates 属性的值（因为它没有传递它们），则 UPDATE 操作无论如何都会将一个空数组写入该属性。

我决定通过添加一个具有真正布尔值的隐藏表单字段来解决此问题，然后在将所有时隙 exdates 设置为空数组之前检查该值。这样，如果未来的开发人员创建了一个利用系列控制器的 UPDATE 操作的新表单，他们将不会遇到将 exdates 设置为空数组的意外行为。如果他们想在他们的表单中处理 exdates，他们需要具有相同的隐藏表单字段和真值。这似乎是一个更简单的解决方案，然后为 exdates、migration 和 AR 关联添加一个类和表，并添加另一层嵌套属性，这样我不仅有父子属性，还有父子、子孙和孙子。

# wordpress - wordpress 添加页面

> ID：11472653
> 
> 赞同：0
> 
> 时间：2012-07-13T14:35:32.960
> 
> 标签：wordpress, plugins

我正在为 wordpress 编写插件，在这个插件中，管理员应该添加一些信息，例如 ===> 标题，数据库中的文本。

我希望将此信息添加为数据库中的 wordpress 页面。

我应该使用什么功能来完成这项任务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:41:59.803

您可以`wp_insert_post`使用[http://codex.wordpress.org/Function_Reference/wp_insert_post](http://codex.wordpress.org/Function_Reference/wp_insert_post)

页面只是 WP 中的一种帖子。

```
$post = array(
  'post_title' => 'my Title',
  'post_content' => 'my Text',
  'post_type' => 'page',

  'post_status' => 'publish',   
  'post_author' => 1
);

wp_insert_post( $post ); 
```

# matlab - MatLab BayesNetToolbox 参数学习

> ID：11472657
> 
> 赞同：1
> 
> 时间：2012-07-13T14:35:43.767
> 
> 标签：matlab, nan, bayesian-networks, dirichlet

我的问题特定于 MatLab 中 BayesNetToolbox 的“learn_params()”[函数](http://bnt.googlecode.com/svn/trunk/docs/usage.html#prior)。在用户手册中，“learn_params()”被声明为仅在完全观察输入数据的情况下才适合使用。我已经用部分观察到的数据集进行了尝试，其中我将未观察到的值表示为 NaN。

似乎“learn_params()”可以处理数据集中不出现的 NaN 和节点状态组合。当我应用狄利克雷先验来平滑 0 值时，我得到所有节点的“合理”MLE 分布。我已经复制了我执行此操作的脚本。

有人可以澄清我所做的事情是否有意义，或者我是否遗漏了什么，即“learn_params()”不能与部分观察到的数据一起使用的原因。

我测试的 MatLab 脚本在这里：

```
% Incomplete dataset (where NaN's are unobserved)
Age = [1,2,2,NaN,3,3,2,1,NaN,2,1,1,3,NaN,2,2,1,NaN,3,1]; 
TNMStage = [2,4,2,3,NaN,1,NaN,3,1,4,3,NaN,2,4,3,4,1,NaN,2,4];
Treatment = [2,3,3,NaN,2,NaN,4,4,3,3,NaN,2,NaN,NaN,4,2,NaN,3,NaN,4];
Survival = [1,2,1,2,2,1,1,1,1,2,2,1,2,2,1,2,1,2,2,1];
matrixdata = [Age;TNMStage;Treatment;Survival];
node_sizes =[3,4,4,2];

% Enter the variablesmap
keys = {'Age', 'TNM','Treatment', 'Survival'};
v= 1:1:length(keys);
VariablesMap = containers.Map(keys,v);

% create the dag and the bnet
N = length(node_sizes); % Instead of entering it manually
dag2 = zeros(N,N);
dag2(VariablesMap('Treatment'),VariablesMap('Survival')) = 1;
bnet21 = mk_bnet(dag2, node_sizes);
draw_graph(bnet21.dag);
dirichletweight=1;

% define the CPD priors you want to use
bnet23.CPD{VariablesMap('Age')} = tabular_CPD(bnet23, VariablesMap('Age'), 'prior_type', 'dirichlet','dirichlet_type', 'unif', 'dirichlet_weight', dirichletweight);
bnet23.CPD{VariablesMap('TNM')} = tabular_CPD(bnet23, VariablesMap('TNM'), 'prior_type', 'dirichlet','dirichlet_type', 'unif', 'dirichlet_weight', dirichletweight);
bnet23.CPD{VariablesMap('Treatment')} = tabular_CPD(bnet23, VariablesMap('Treatment'), 'prior_type', 'dirichlet','dirichlet_type', 'unif','dirichlet_weight', dirichletweight);
bnet23.CPD{VariablesMap('Survival')} = tabular_CPD(bnet23, VariablesMap('Survival'), 'prior_type', 'dirichlet','dirichlet_type', 'unif','dirichlet_weight', dirichletweight);

% Find MLEs from incomplete data with Dirichlet prior CPDs
bnet24 = learn_params(bnet23, matrixdata);

% Look at the new CPT values after parameter estimation has been carried out
CPT24 = cell(1,N);
for i=1:N
s=struct(bnet24.CPD{i}); % violate object privacy
CPT24{i}=s.CPT;
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T00:37:58.050

根据我对 BNT 文档的理解，您需要进行一些更改：

1.  缺失值应表示为空单元格而不是`NaN`值。
2.  该`learn_params_em`函数是唯一支持缺失值的函数。

我之前的回答是不正确的，因为我记错了哪些 BNT 学习函数支持缺失值。

# javascript - Javascript MySQL 插入返回什么

> ID：11472662
> 
> 赞同：1
> 
> 时间：2012-07-13T14:36:17.930
> 
> 标签：javascript, mysql, node.js

在我的脚本中，我像这样执行我的插入

```
sql ="INSERT INTO table (fields) VALUES ("values")
connection.query(sql, function(error, rows, fields) 
```

rows.InsertId 似乎包含一个插入的行，但我不知道它是插入的第一行还是最后一行

这是我正在使用的 mysql node.js 实现，文档仅说明了这一点。

[https://github.com/felixge/node-mysql](https://github.com/felixge/node-mysql)

# php - 从多个表中计算不同的用户 ID

> ID：11472663
> 
> 赞同：3
> 
> 时间：2012-07-13T14:36:20.223
> 
> 标签：php, mysql, sql, database

我有大约 5 个具有公共字段“userid”的表，我想计算所有这些表中不同的用户 ID。某些用户 ID 可能出现在其中大约 2 个表中。但我想一起计算 5 个表中不同用户 ID 的 UNION。我可以使用 ff 代码在一个表中计算不同的用户 ID。我希望能够从所有表格中计数。

```
//just count the nuber of distict userids in table1
    $query2 = ("SELECT COUNT(DISTINCT userid) FROM table1"); 
    $result2 = mysql_query($query2) or die(mysql_error()); 
    $row2 = mysql_fetch_row($result2); 
    echo "Number of users in table 1  = ".$row2[0] ."<br />";

**Table 1**
Id    userid    name   adresss

**Table 2**
Id  Title   Sex   userid

**Table 3**
Id   userid   amount

**Table 4**
Id  price  promotion  userid   productid

**Table  5**
Id  userid   category   tax   weight 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-13T14:38:52.830

用一个`UNION`

`UNION`与 a 相比，标准`UNION ALL`将从结果集中删除重复值。你的陈述看起来像

```
SELECT   COUNT(*)
FROM     (
           SELECT UserID FROM Table1
           UNION SELECT UserID FROM Table2
           UNION SELECT UserID FROM Table3
           UNION SELECT UserID FROM Table4
           UNION SELECT UserID FROM Table5
         ) AS UserIDs 
```

[来自 w3schools](http://www.w3schools.com/sql/sql_union.asp)

> 默认情况下，UNION 运算符仅选择不同的值。要允许重复值，请使用 UNION ALL。

# html - Outlook 2010 电子邮件呈现

> ID：11472673
> 
> 赞同：0
> 
> 时间：2012-07-13T14:37:23.187
> 
> 标签：html, css, email, outlook

我正在尝试在电子邮件中设置全局字体。Mail 是使用表格构建的以保持兼容性，但有一张表格不接受我的样式。我做了什么：

```
{literal}
<style>
    *,table, div, p, td, tr, #tabledetails, .tabledetails {
    margin: 0;
    font-family: Verdana, Arial, Helvetica, sans-serif !important;
    color: #000000;
    font-size: 12px;
    }
</style>
{/literal}

...

<table id="tabledetails" class="tabledetails" width="100%" border="0" cellspacing="0" cellpadding="4" style="font-family: Verdana, Arial, Helvetica, sans-serif !important; font-size: 12px !important;">...

<td class="left" style="font-family: Verdana, Arial, Helvetica, sans-serif !important; font-size: 12px !important;">{$order_values.products_quantity} x</td> 
```

因此，如您所见，我尽我所能来设置字体（而不是像 Outlook 喜欢做的那样使用 Times New Roman），但它仍然不起作用。我还能做什么？

---- 编辑 ----- 完成电子邮件 ----

```
<link href="{$_system_mail_css}" type="text/css" rel="stylesheet">
{literal}
<style>
*,table, div, p, td, tr, #tabledetails, .tabledetails {
    margin: 0;
    font-family: Verdana, Arial, Helvetica, sans-serif !important;
    color: #000000;
    font-size: 12px;
}
</style>
{/literal}

<table cellpadding="0" cellspacing="0" class="email_container" style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; text-align: justify;">
    <tr>
        <td colspan="3" class="email_toplogo">
        <div class="email_toplogo"><img src="{$_system_logo_url}" /></div>
        </td>
    </tr>
    <tr>
        <td class="email_table_left_bg" valign="top">
        <div class="email_table_left"></div>
        </td>
        <td class="email_table_center_bg" valign="top">
        <div class="email_content">
        <h1>Hallo {$order_data.delivery_firstname} {$order_data.delivery_lastname},</h1>
        <p>vielen Dank für Ihre Bestellung im Onlineshop von super cool company name i shouldnt tell anyone ;).
                      Wir werden Ihre Bestellung schnellstmöglich ausführen. Sie bekommen bei jeder Statusänderung Ihrer Bestellung eine automatisch generierte Email.</p>
                      <hr>
                 <P>Nachfolgend finden Sie Ihre Bestelldetails zur Kontrolle:</p>
        <p>{txt key=TEXT_ORDER_NUMBER}: {$order_data.orders_id}</p>
        <p>{txt key=TEXT_ORDER_DATE}: {$order_data.date_purchased}</p>
<p>E-Mail: {$order_data.customers_email_address}</p>
        <table cellpadding="0" cellspacing="0" style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px;">
        <tr>
        <td style="width: 250px;">
        <div class="shippingaddress">
        <h2>{txt key=TEXT_SHIPPING_ADDRESS}</h2>
        <p>{if $order_data.delivery_company}
        {$order_data.delivery_company}<br />
        {/if} {$order_data.delivery_firstname} {$order_data.delivery_lastname}<br />
        {$order_data.delivery_street_address}<br />
        {if $order_data.delivery_suburb} {$order_data.delivery_suburb}<br />
        {/if} {$order_data.delivery_postcode} {$order_data.delivery_city}<br />
        {if $order_data.delivery_state}{$order_data.delivery_state}
        {/if}{$order_data.delivery_country}<br />
        </p>
        </div>
        </td>
        <td>
        <div class="paymentaddress">
        <h2>{txt key=TEXT_PAYMENT_ADDRESS}</h2>
        <p>{if $order_data.billing_company} {$order_data.billing_company}<br />
        {/if} {$order_data.billing_firstname} {$order_data.billing_lastname}<br />
        {$order_data.billing_street_address}<br />
        {if $order_data.billing_suburb} {$order_data.billing_suburb}<br />
        {/if} {$order_data.billing_postcode} {$order_data.billing_city}<br />
        {if $order_data.billing_state}{$order_data.billing_state}
        {/if}{$order_data.billing_country}<br />
        </p>
        </div>
        </td>
        </tr>
        </table>
    {if $payment_info}<hr><h2>{txt key=TEXT_PAYMENT_INFOS}</h2>
        <p>{$payment_info}</p>{/if} 
        <hr>
<table id="tabledetails" class="tabledetails" width="100%" border="0" cellspacing="0" cellpadding="4" style="font-family: Verdana, Arial, Helvetica, sans-serif !important; font-size: 12px !important;">
            <tr class="headerrow">
                <td class="left">{txt key=TEXT_QTY}</td>
                <td class="left">{txt key=TEXT_ARTICLE}</td>
                <td class="left">{txt key=TEXT_PRODUCTS_MODEL}</td>
                <td class="right">{txt key=TEXT_SINGLE_PRICE}</td>
                <td class="right">{txt key=TEXT_TOTAL_PRICE}</td>
            </tr>
            {foreach name=aussen item=order_values from=$order_products}
            <tr class="{cycle values="contentrow1,contentrow2"}">
                <td class="left" style="font-family: Verdana, Arial, Helvetica, sans-serif !important; font-size: 12px !important;">{$order_values.products_quantity} x</td>
                <td class="left" style="font-family: Verdana, Arial, Helvetica, sans-serif !important; font-size: 12px !important;">{$order_values.products_name}</strong></td>
                <td class="left" style="font-family: Verdana, Arial, Helvetica, sans-serif !important; font-size: 12px !important;">{$order_values.products_model}</td>
                <td class="right" style="font-family: Verdana, Arial, Helvetica, sans-serif !important; font-size: 12px !important;">{$order_values.products_price.formated}</td>
                <td class="right" style="font-family: Verdana, Arial, Helvetica, sans-serif !important; font-size: 12px !important;">{$order_values.products_final_price.formated}</td>
            </tr>
            {$order_values.products_information.html_content}
            {/foreach}
            <tr>
                <td colspan="5" align="right" class="subtotal">
                <div align="right">
                <p>{txt key=TEXT_SUB_TOTAL}: {$total.product_total.formated}</p>
                {foreach name=aussen item=order_total_values from=$order_total_data}
                <p>{$order_total_values.orders_total_name}:
                {$order_total_values.orders_total_price.formated}</p>
                {/foreach} {foreach name=aussen item=tax_data from=$total.total_tax}
                <p>{txt key=TEXT_TAX} {$tax_data.tax_key}%:
                {$tax_data.tax_value.formated}</p>
                {/foreach}
                <p><span class="doubleline">{txt key=TEXT_TOTAL}: {$total.total.formated}</span></p>
                </div>
            </tr>
        </table>
        </div>
<hr>
        <div class="email_footer">{$_system_footer_html}</div>
        </td>
        <td class="email_table_right_bg" valign="top">
        <div class="email_table_right"></div>
        </td>
    </tr>
</table> 
```

---- 编辑 2 ---- 产品列表部分的生成代码

```
<table id="tabledetails" class="tabledetails" width="100%" border="0" cellspacing="0" cellpadding="4" style="font-family: Verdana, Arial, Helvetica, sans-serif !important; font-size: 12px !important;">
    <tr class="headerrow">
        <td class="left">Anzahl</td>
        <td class="left">Artikel</td>
        <td class="left">Art.Nr.</td>
        <td class="right">Einzelpreis</td>
        <td class="right">Gesamtpreis</td>
    </tr>
                <tr class="contentrow1">
        <td class="left" style="font-family: Verdana, Arial, Helvetica, sans-serif !important; font-size: 12px !important;">1.00 x</td>
        <td class="left" style="font-family: Verdana, Arial, Helvetica, sans-serif !important; font-size: 12px !important;">Mavic Rennradschuh Zxellium 2011 black / white / yellow mavic</strong></td>
        <td class="left" style="font-family: Verdana, Arial, Helvetica, sans-serif !important; font-size: 12px !important;">14207</td>
        <td class="right" style="font-family: Verdana, Arial, Helvetica, sans-serif !important; font-size: 12px !important;"><span class="price"> 220,00 EUR</span></td>
        <td class="right" style="font-family: Verdana, Arial, Helvetica, sans-serif !important; font-size: 12px !important;"><span class="price"> 220,00 EUR</span></td>
    </tr>
            <tr class="contentrow1">        <td class="right" valign="top"></td>        <td class="left" valign="top">                  <h3>                Schuhgröße:             </h3>                                           </td>       <td class="right" valign="top"></td>        <td class="right" valign="top"></td>        <td class="right" valign="top"></td>    </tr>       <tr class="contentrow1">        <td class="right" valign="top"></td>                        <td class="left" valign="top">                              42                              </td>                                       <td class="right" valign="top"> </td>                           <td class="right" valign="top">                                                                                                                                         </td>                               <td class="right" valign="top">                                                                                 </td>       </tr>   
                <tr>
        <td colspan="5" align="right" class="subtotal">
        <div align="right">
        <p>Zwischensumme: <span class="price"> 220,00 EUR</span></p>
                        <p>Nachnahme:
        <span class="price"> 3,60 EUR</span></p>
                        <p>DHL - versichert:
        <span class="price"> 0,00 EUR</span></p>
                        <p>inkl. MwSt. 19%:
        <span class="price"> 35,70 EUR</span></p>
                        <p><span class="doubleline">Gesamtsumme: <span class="price"> 223,60 EUR</span></span></p>
        </div>
    </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T15:00:47.367

在电子邮件呈现方面，Outlook 是个痛点。

唯一安全的做法是在`style="font-family: Verdana, Arial, Helvetica, sans-serif;"`每个段落和 div 中添加一个。我们都知道这很糟糕 - 但告诉微软......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-04T10:37:33.903

正如其他人所说，您需要将样式类扁平化为所有对象的内联样式。

我遇到了类似的问题，并编写了一个 C# 函数将样式展平到 HTML 中。

[使用带有 MVC 的 C# 将 CSS 扁平化为 HTML](https://stackoverflow.com/questions/21533536/flatten-css-into-html-using-c-sharp-w-mvc)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T15:05:30.500

仅在 html 电子邮件中使用内联样式。它将在某些电子邮件客户端中被删除。Gmail 就是一个例子。

您需要将此添加到每个`td`包含的文本中。

```
style="font-family: Verdana, Arial, Helvetica, sans-serif;" 
```

# c++ - 在 ATL 应用程序中使用集合

> ID：11472674
> 
> 赞同：0
> 
> 时间：2012-07-13T14:37:23.980
> 
> 标签：c++, collections, atl

如何在 ATL 应用程序中使用 std 集合作为向量和列表？如果不可能，除了使用[http://msdn.microsoft.com/en-us/library/15e672bd.aspx](http://msdn.microsoft.com/en-us/library/15e672bd.aspx)中描述的集合之外，我还能做什么？例如，我想将一些字符串存储在列表中

std::list<CString> 列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T15:34:56.850

你可以很高兴地使用它们，只是不能像 COM 那样跨越 COM 边界传递它们；不知道 stl 集合是什么。您可以使用指针将它们传递到进程内 COM 边界，但请注意在这种情况下您知道自己在做什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T16:57:27.623

是的，请务必这样做。STL 比大多数 ATL 类设计得更好（在异常安全性、通用性等方面）。

在收藏中存储时要小心`CCom[Qi]Ptr`，您的图书馆可能会抱怨地址操作符的重载。ATL 中有一个包装器。

但是，将集合公开为 COM 集合要困难得多。

# facebook - 试图将 URL 从 iFrame 传递到 SharePoint 网站 URL？

> ID：11472679
> 
> 赞同：1
> 
> 时间：2012-07-13T14:37:36.607
> 
> 标签：facebook, sharepoint, url, iframe

我有一个在嵌入 SharePoint 网站的 iFrame 中运行的应用程序。这样做的问题是应用程序内的导航不会导致 SharePoint 网站 URL 发生变化。因此，如果您要刷新整个页面，您将被送回应用程序的默认页面，而不是停留在应用程序的同一页面上。这是一个问题的原因是社交媒体的共享。我在应用程序中添加了一个 Facebook 共享按钮，但是当它拉取与整个站点的 URL 不匹配或引用的应用程序的 URL 时，它只是共享应用程序（这在视觉上不吸引人并且不允许你访问网站的其余部分）。

任何机构有任何建议或知道我可以去哪里寻求帮助？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T13:58:17.537

如果我理解正确，Facebook 的东西在 iframe 里面？

如果是这样，您可以： * 删除 iframe 并将应用程序与 SharePoint 更好地集成，或 * 更改应用程序，使其检测到它正在“单独”运行（使用 javascript 等），如果是，则重定向到“大”应用程序。

如果 Facebook 的内容位于 iframe 之外的 SharePoint 中，您可以编写一些 javascript 以某种方式更新 URL，以匹配应用程序的 URL。这要求 SharePoint 父应用程序和 iframe 应用程序在同一个域中运行 - 如果不是，这不是一个选项。

请注意，使用 JS 更改“父”URL 将重新加载页面，除非您只更改“#”部分之后的 URL（因此您可以执行以下操作：“http://sharepoint/iframe.aspx?aa=11&bb= 22#iframeUrl=http://uglyapplication/"

如果用户在浏览器中按“后退”/“前进”等，您可能还需要编写 JS 来相应地更新您的 iframe，因为像上面那样更改 URL 仍会在浏览器历史记录中添加一个“步骤”。

# ruby-on-rails - 编辑：如何每月向用户发送付款？

> ID：11472681
> 
> 赞同：0
> 
> 时间：2012-07-13T14:37:43.513
> 
> 标签：ruby-on-rails, paypal, recurring

我想每月使用 PayPal 自动向我的用户付款（分享利润）。

我阅读了很多关于 PayPal 和所有功能的信息。我需要配置发送付款取决于我的数据库中的一些统计数据。

我正在使用 Rails，将不胜感激所有帮助！

我可以重写或更改经常性账单 gem 中的某些内容来支付我的用户吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T14:44:00.533

为此目的，有几个调度 gem：

[https://www.ruby-toolbox.com/categories/scheduling](https://www.ruby-toolbox.com/categories/scheduling)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T14:41:46.073

如果您使用的是 paypal 等支付网关，它们支持重复计费。大多数支付服务都支持这一点。我不知道是否可以像您在问题中描述的那样设置计时器，但我绝对不会依赖它。性能如何？如果您的应用出现故障怎么办？

看看[activemerchant](http://activemerchant.org)和[这个](http://railscasts.com/episodes/289-paypal-recurring-billing)railscasts 插曲。也许[这个](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_ECRecurringPayments)贝宝文档也很有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-14T16:11:20.737

在 PayPal 产品系列中，请查看 Adaptive Payments。其中一项功能是能够执行所谓的**隐式付款**。从本质上讲，此功能使您能够以编程方式从自己的帐户中汇款，以支付给其他人。

您只需要编写脚本来确定收件人的电子邮件地址、您要发送的金额，并使用该信息进行 API 调用。

查看第 25 页： [https ://cms.paypal.com/cms_content/US/en_US/files/developer/PP_AdaptivePayments.pdf](https://cms.paypal.com/cms_content/US/en_US/files/developer/PP_AdaptivePayments.pdf)

虽然编写自己的 API 调用可能更容易（它基本上是 HTTP POST 请求，带有一些额外的标头），但您可以调整 ActiveMerchant 库来为您完成它。

# iphone - Cocos2d iphone 应用程序在实际 iphone 上运行异常

> ID：11472683
> 
> 赞同：0
> 
> 时间：2012-07-13T14:37:45.767
> 
> 标签：iphone, xcode, cocos2d-iphone, scaling

我有一个使用 Cocos2d 的简单应用程序，在模拟器上运行时所有图像都显示良好。但是，当我在 iphone 上运行它时，所有图像都被放大并且数量惊人，使游戏无法玩。

有没有人知道为什么会发生这种情况，以及如何解决它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T22:07:33.193

您需要考虑您的模拟器正在运行视网膜的可能性。可能您正试图在较旧的非视网膜设备上显示更高分辨率的图像。

您也可以在任何图像上添加后缀“-hd”，然后 cocos2d 会自动将其识别为更高分辨率。但是当你真正完成你的应用程序时，你会想要每个图像有 2 个副本，每个分辨率一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-22T16:53:12.337

我发现问题在于，当我使用 初始化精灵时`spriteWithFile`，它会将其设置为特定大小。当我稍后更改精灵纹理时，它保持了最后一张图像的大小，但具有不同的纹理。

# xml - 计算不同的值

> ID：11472686
> 
> 赞同：0
> 
> 时间：2012-07-13T14:37:55.980
> 
> 标签：xml, count, xquery

您能告诉我如何在 count(distinct-values()) 函数中的以下代码中添加逗号，以便它显示在 XQuery 输出中吗？这是代码

```
Manschaften

{
for $m  in /Fussballmeisterschaft/Manschaften 

return
Tabelle

    {$m  /Namen/text()}
    {$m  /Punkte/text()}
    {
    for $t in Fussballmeisterschaft/Tabelle
    where $t/Manschaft = $m/Namen
        return
        count( distinct-values ($t//../Manschaft/text()))
    }   
    </Tabelle>
}
/Manschaften 
```

这是输出

```
：
>      
     多特蒙德63
     拜仁慕尼黑 60
     沙尔克 0454
    门兴格拉德巴赫51
    汉诺威 9641
…………

```

球队名称后面的数字是积分。那么如何添加逗号或空格呢？

Thaankkkkkksssssss：P

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T17:52:01.270

`<Tabelle> {$m /Namen/text(),","} {$m /Punkte/text()}` 我做的 ！它在 Namen 和 Punkte 的宣言中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T18:53:37.100

您可以尝试更改：

```
count(distinct-values($t//../Manschaft/text())) 
```

至：

```
(count(distinct-values($t//../Manschaft/text())),',') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T14:53:11.547

```
{
  let $res := 
    for $t in Fussballmeisterschaft/Tabelle
    where $t/Manschaft = $m/Namen
    return count( distinct-values ($t//../Manschaft/text()))
  return fn:string-join($res, ', ')
} 
```

# jquery - jquery中的邮政编码验证

> ID：11472694
> 
> 赞同：1
> 
> 时间：2012-07-13T14:38:16.230
> 
> 标签：jquery, validation

```
$('#create_membership').click(function () {
    var zip = $('#zip').val();

    else if (zip == ''){
        errorMessage = "*Zipcode required!";
    }
    else if ((zip.length)< 5 || (zip.length)>5 ){
        errorMessage = "*zipcode should only be 5 digits";
    }
    else if ( zip =( "^[0-9]+$" )){
        errorMessage = "*zipcode should be numbers only";
    } 
```

我得到了第一个和第二个，即邮政编码的空和长度验证。但是对于第三种情况，号码验证不起作用。任何人都可以帮助我获得号码验证提前谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-13T14:46:21.783

这并不是真正的 jQuery 特定的，但是您有几个语法错误，并且您的验证逻辑可以大大简化：

```
$('#create_membership').click(function()
{
    var zip = $('#zip').val();

    var zipRegex = /^\d{5}$/;

    if (!zipRegex.test(zip))
    {
        // trigger error
    }
    else
    {
        // success!
    }
}); 
```

我应该注意，验证邮政编码不一定只是检查 5 个数字。我也会尝试在某个地方找到一个列表，并确保他们输入的是有效的美国邮政编码。此外，您可能还希望允许使用 4 位数的补充代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-13T14:42:31.657

您需要将正则表达式视为函数，否则您只是将值分配给“zip”。见下文：

```
$('#create_membership').click(function () {
  var zip = $('#zip').val();
  var reg = /^[0-9]+$/;
  else if (zip == ''){
  errorMessage = "*Zipcode required!";
  }
  else if ((zip.length)< 5 || (zip.length)>5 ){
  errorMessage = "*zipcode should only be 5 digits";
  }
  else if (!reg.test(zip)){
  errorMessage = "*zipcode should be numbers only";
  }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T14:42:50.050

您可以尝试这样的事情 -[如何使用 jQuery 在 HTML 输入框中只允许数字（0-9）？](https://stackoverflow.com/questions/995183/how-to-allow-only-numeric-0-9-in-html-inputbox-using-jquery)

如果你只想要正则表达式，试试这个 - [jquery: validate that text field is numeric](https://stackoverflow.com/questions/2405880/jquery-validate-that-text-field-is-numeric)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-20T05:27:06.160

号码验证

```
var data=$('#zip').val();
var len=data.length;
var c=0;
for(var i=0;i<len;i++)
{
  c=data.charAt(i).charCodeAt(0);
  if(c <48 || c >57)
  {
    $('.error').show();
    event.preventDefault();
    break;
  }
  else
  {
    $('.error').hide();
  }
} 
```

# python - 在 python 代码中使用 f2py 模块时的问题

> ID：11472696
> 
> 赞同：6
> 
> 时间：2012-07-13T14:38:32.157
> 
> 标签：python, compilation, fortran, compiler-flags, f2py

我有一个需要以下编译命令的 FORTRAN 代码

```
gfortran -c interp.f -ffixed-format -ffix-line-length-none 
```

我在 python 中使用 f2py 模块编译了相同的

```
from numpy import f2py

f2py.compile(open('interp.f').read(),modulename='interp',extra_flags='-ffixed-format -ffix-line-length-none',verbose=0) 
```

它无法编译模块。它在'-ffized-format'处给出了一个错误，说无效的文件格式''

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-22T23:13:31.400

既不`-ffixed-format`是，也不`-ffix-line-length-none`是有效的 gfortran 选项。考虑使用`-ffixed-form`and`-ffixed-line-length-none`代替。

# javascript - 如何使用 javascript 使用按钮填充表单列表

> ID：11472697
> 
> 赞同：0
> 
> 时间：2012-06-12T20:37:45.770
> 
> 标签：javascript

我编写了一个脚本，当你按下一个按钮（`accessories`）时，选择（`mylist`）填充一个数组（`accessoryData`），当你点击另一个按钮（`weapons`）时，另一个数组（`weaponData`）填充选择。但是，在代码的当前状态下，按下第二个按钮不会重新填充选择。这里有什么问题？

此外，如果有更有效的方法来做到这一点，那可能会有所帮助。

[完整代码](http://jsfiddle.net/StealingMana/WKNYn/2/)

```
function runList(form, test) {
    var html = "";
    var x;
    dataType(test);
    while (x < dataType.length) {
        html += "<option>" + dataType[x];
        x++;
    }
    document.getElementById("mylist").innerHTML = html;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T10:37:24.147

我相信您正在尝试制作一个`<select>`元素，即下拉菜单，但正确的标记是：

```
<select id="myList">
   <option value="1">Option 1</option>
   <option value="2">Option 2</option>
   <option value="n">Option n</option>
</select> 
```

您忘记关闭带有属性的`<option>`标签。`innerHTML`

使用原生***JS***方法：

```
//create the select element
var select = document.create('select');
//or use getElementById if it's already there

//Assuming your datatype is an Array of string
var opt;
for(var i=0; i<datatype.length; i++){
  //create the option element
  opt = document.create('option');
  opt.textContent = datatype[i]; //innerText works too
  //set the value attribute
  opt.setAttribute('value',i+1); //+1 or else it would start from 0
  //add the option to the select element
  select.appendChild(opt);
  //conversely use removeChild to remove
}

//at last add it to the DOM if you didn't fetch it from the DOM. 
```

# google-chrome - 从扩展中获取 Chrome 选项卡的窗口句柄？

> ID：11472708
> 
> 赞同：4
> 
> 时间：2012-07-13T14:39:20.460
> 
> 标签：google-chrome, google-chrome-extension, npapi, window-handles

我编写了一个 Chrome 扩展程序（也带有 NPAPI），它允许我的应用程序和 Chrome 相互通信。这一切都很好。

我现在要做的是能够将 Chrome 窗口的 HWND 绑定到特定的窗口 ID 和选项卡 ID。

当我在 Chrome 中（通过插件）时，我有选项卡 ID 和窗口 ID，我可以基于它进行大多数操作。

当我在 Chrome 之外（通过我的应用程序）时，我可以看到窗口结构并获取各种选项卡的 HWND。

有什么方法可以将它们可靠地联系在一起，以便我的应用程序可以告诉 Chrome 获取有关/来自特定选项卡的信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T15:55:06.613

如果您有 Spy++，您会看到站点标题与选项卡窗口标题保持一致。你绝对应该使用它。

要消除标题冲突，只需调用`chrome.tabs.query()`和`chrome.tabs.update()`从扩展名保存、更改和恢复选项卡的标题。然后使用`GetCurrentProcess()`and `EnumWindows()`/`WindowEnumProc()`获取子窗口层次结构并匹配您的自定义标题。您必须将其传递给 EnumWindowsProc 回调函数。

# c# - 与 EventHandler 相比，EventListener 是什么？

> ID：11472711
> 
> 赞同：4
> 
> 时间：2012-07-13T14:39:35.407
> 
> 标签：c#, event-listener

我该如何实施？它可以跨多个程序集工作吗？如果没有，我怎样才能让它工作？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-13T22:36:47.547

冒着不完全理解这个问题的风险，我想提供另一种可能的解释。

谈到类，Java 有一个[EventListener](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/EventListener.html)，.NET 有一个[EventHandler](http://msdn.microsoft.com/en-us/library/system.eventhandler.aspx)。两者都有相同的目的：事件处理。但是在实现上存在差异。可以说，.NET 的事件处理是对 Java 事件监听器的更高层次的抽象。

Java 的 EventListener 是“所有事件监听器接口都必须扩展的标记接口”（即 MouseListener）。.NET 的 EventHandler 是一个委托，是一个指向处理事件的方法的强类型指针。

更广泛地说，事件侦听器是实现事件处理接口的对象，而事件处理程序只是处理事件的方法。一般来说，事件侦听器实现了一个[观察者设计模式](http://en.wikipedia.org/wiki/Observer_pattern)，而事件处理程序隐藏了该模式的所有管道。因此，编写一个[事件监听](http://docs.oracle.com/javase/tutorial/uiswing/events/index.html)器比编写一个[事件处理程序](http://msdn.microsoft.com/en-us/library/aa645739%28v=vs.71%29.aspx)更复杂，而且往往更加口头化。

我建议阅读 Microsoft 的[Observer Design Pattern](http://msdn.microsoft.com/en-us/library/ee817669.aspx)以更好地理解它。

因此，要实现事件处理程序，您只需将委托分配给您要处理的对象的事件。IE

```
Button.Click += new EventHandler(MyButton_Click); 
```

其中 MyButton_Click 是一个具有 EventHandler 签名并实际处理事件的方法（它可能在您的类中或其他地方），即

```
private void MyButton_Click(object sender, EventArgs e)
{
    doSomething();
} 
```

为了在 Java 中使用事件监听器实现同样的效果，您可以编写如下内容（如果我犯了错误，请原谅我，因为我是从内存中编写的）：

```
public class MyClass
{
    Button myButton;

    MyClass()
    {
        ...
        myButton.addMouseListener(new ButtonHandler());
    }

    public class ButtonHandler implements MouseListener
    {
        public void mousePressed(MouseEvent e) {}
        public void mouseReleased(MouseEvent e) {}
        public void mouseEntered(MouseEvent e) {}
        public void mouseExited(MouseEvent e) {}

        public void mouseClicked(MouseEvent e)
        {
           doSomething("Mouse clicked", e);
        }
    }
} 
```

当然，有很多方法可以实现这种常见的观察者模式，包括在类本身、内部类、匿名类、适配器等中实现 EventListener 接口。但这应该说明这一点。

# database - 创建仅数据库模式的副本

> ID：11472720
> 
> 赞同：0
> 
> 时间：2012-07-13T14:40:08.787
> 
> 标签：database, sql-server-2005

我是 MS SQL 服务器的相对新手。我需要从具有相同模式的现有测试数据库创建一个测试数据库，并从生产中获取数据并填充新创建的空数据库。为此，我在 SSMS 中使用了生成脚本。但现在我需要在工作中定期这样做。请指导我如何在某个时间点自动创建空数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T20:34:12.947

您是否考虑过恢复备份？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T20:36:44.437

为了补充 Aaron 已经很好的答案，我多年来一直在使用[SQLDelta](http://sqldelta.com) - 我认为它非常好。

（除了是一个非常满意的客户外，我与 SqlDelta 没有任何联系）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T14:56:06.343

您将很难自动化生成脚本向导。我建议使用类似[Red-Gate 的 SQL 比较](http://www.red-gate.com/products/sql-development/sql-compare/)（[或任何](http://bertrandaaron.wordpress.com/2012/04/20/re-blog-the-cost-of-reinventing-the-wheel/)支持命令行的替代方法）。您可以创建一个新的空数据库，然后使用 SQL Server 代理的命令行编写比较/部署脚本。

另一个更棘手的选择是将架构和模块部署到`model`数据库。您可以使用 SQL 比较（或替代方法）保持同步，或者只关注架构/模块更改的部署，然后当您创建新数据库时，它将自动继承架构/模块的当前状态。这种方法的问题（除了取决于你保持`model`同步）是*所有*新数据库都将继承这个模式，因为[目前没有办法拥有多个模型](http://connect.microsoft.com/SQL/feedback/ViewFeedback.aspx?FeedbackID=322571)。

# c++ - Atan2 表 C++

> ID：11472722
> 
> 赞同：0
> 
> 时间：2012-07-13T14:40:20.047
> 
> 标签：c++

我正在尝试计算二维空间中两点的角度。它适用于以下内容：

```
double angle;
x = player->x - x;
z = player->z - y;

angle = atan2 (x, y);
angle *= (180.0 / M_PI);
if(angle < 0) angle += 360;
if(angle >= 360) angle -= 360;

return angle; 
```

但是我想使用表格来获得更好的结果：

```
x = player->x - x;
z = player->y - y;

return atanTable[x+32][y+32]; 
```

使用初始化：

```
int xp = -32;
int yp = -32;
for (int x = 0; x < 64; x++, xp++)
    for (int y = 0; y < 64; y++, yp++){
        double angle;

        angle = atan2 (xp, yp);
        angle *= (180.0 / M_PI);
        if(angle < 0) angle += 360;
        if(angle >= 360) angle -= 360;
        atanTable[x][y] = angle;
    } 
```

仅针对 x 和 y 的值 -32 到 32 计算角度。

但是，该表未正确制作。我得到的值只有 359 和 0 左右，而我应该得到 0 到 360 度的范围。

我是否以某种方式滥用了 atan2 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:43:35.790

您需要`yp`在第一个循环内重置，而不是在它之前。

```
int xp = -32;
for (int x = 0; x < 64; x++, xp++)
{
    int yp = -32; // Note, needs to be reset each time x changes.
    for (int y = 0; y < 64; y++, yp++)
    { 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T15:57:02.737

Nit：atan2() 总是返回 [-pi,pi] 中的角度。您的第二个 if 语句是多余的。这也可能是一个糟糕的设计：您经常希望稍后测试 [pi,2pi] 中的角度，这可以通过简单的 <0 来完成默认范围。基本上， atan2() 是你的朋友，这个函数存在的原因是为了让你免于对角度进行模块化数学的麻烦。

# javascript - Jquery Coin Slider - 根本不工作

> ID：11472724
> 
> 赞同：0
> 
> 时间：2012-07-13T14:40:31.143
> 
> 标签：javascript, jquery, html, slider

我正在尝试将[Coin Slider](http://workshop.rs/projects/coin-slider/)集成到我的页面中，并且我已经下载了最新的 Jquery 并将其附加到我的标题中，以及所有必要的 Coin-slider 文件。但是，该页面只是将图像堆叠起来，就好像我只是插入了标签一样。

所有文件的路径都是正确的。我尝试按照他在“如何安装”页面上的说明进行操作，但没有成功。它不适用于 IE8 或最新版本的 Chrome 或 Firefox。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="stylesheet" href="css/paradigm.css" type="text/css" />
<link rel="stylesheet" href="css/coin-slider-styles.css" type="text/css" />
<script type="text/javascript" src="js/coin-slider.min.js"></script>
<script type="text/javascript" src="js/coin-slider.js"></script>
<script type="text/javascript" src="js/jquery-1.7.2.js"></script>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Paradigm Solutions</title>
</head>
<body>
    <div id="container">
    <div id="header"></div>
    <div id="navbar"></div>
    <div id="leftMenu"></div>
    <div id="coin-slider">
        <a href="http://windows.microsoft.com/en-us/internet-explorer/products/ie/home/" target="_blank">
                <img src="http://www.vexite.com/images/2011/06/browser-war-illustration.jpg" alt="IESucks" />
                <span>
                    <b>Don't Use IE</b><br />
                    Internet Explorer is an inferior product that should be destroyed.
                </span>
            </a>

        <a href="http://windows.microsoft.com/en-us/internet-explorer/products/ie/home/" target="_blank">
                <img src="http://www.vexite.com/images/2011/06/browser-war-illustration.jpg" alt="IESucks" />
                <span>
                    <b>Don't Use IE</b><br />
                    Internet Explorer is an inferior product that should be destroyed.
                </span>
            </a>
    </div>

    </div>

<script type="text/javascript">
    $(document).ready(function() {
        $('#coin-slider').coinslider();
    });
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T14:44:11.707

更改您的脚本标签

```
<script type="text/javascript" src="js/coin-slider.min.js"></script>
<script type="text/javascript" src="js/coin-slider.js"></script>
<script type="text/javascript" src="js/jquery-1.7.2.js"></script> 
```

到

```
<script type="text/javascript" src="js/jquery-1.7.2.js"></script>
<script type="text/javascript" src="js/coin-slider.min.js"></script> 
```

coin-slider 依赖于 jQuery，因此它必须在之前加载......而且我建议你删除`js/coin-slider.js`as`js/coin-slider.min.js`并且`js/coin-slider.js`是相同的东西......这`.min`只是另一个的缩小版本

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T14:44:54.573

您的 javascript 文件包含的顺序非常重要。jQuery 应该始终是第一位的（正如在生产文档中显而易见的那样）。此外，您不需要包含两个硬币滑块。.min 就足够了：

```
<script type="text/javascript" src="js/jquery-1.7.2.js"></script>
<script type="text/javascript" src="js/coin-slider.min.js"> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T22:34:44.967

这个听起来很明显，但 coin-slider 包并不总是与 jQuery 一起打包，所以在链接之前确保你的 javascript 文件夹中有 jQuery c(:

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T14:56:39.483

它运作良好

```
<script type="text/javascript" src="jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="coin-slider.min.js"></script>

<link rel="stylesheet" href="styles.css" type="text/css" />
<link rel="stylesheet" href="coin-slider-styles.css" type="text/css" /> 
```

[检查此链接以获取代码](http://www.4shared.com/zip/1AK-AybV/coin-slider.html)

# ruby-on-rails - 从 Facebook Rails 应用程序上的照片创建 PDF

> ID：11472728
> 
> 赞同：0
> 
> 时间：2012-07-13T14:40:46.203
> 
> 标签：ruby-on-rails, canvas, heroku, pdf-generation, pdfkit

我正在使用 Rails 创建一个 Facebook 应用程序并托管在 Heroku 上，但在找到解决问题的理想方法时遇到了一些麻烦。我希望用户能够在屏幕上移动他们的照片，定位它们，然后将其下载为 PDF 或 PNG 文件以通过电子邮件发送或打印。我有应用程序获取用户的 Facebook 照片，他们可以将它们拖到 HTML5 Canvas 元素上以定位它们。然而，拿这幅画布并将其转换为可打印的东西是我遇到了死胡同的地方。

基本上我有一些我尝试过的想法：

**使用 toDataURL() 将 Canvas 转换为 PNG -**可以完美运行，但由于照片是外部的，因此 Canvas 很“脏”并且会引发安全问题。我曾考虑尝试将每个图像的像素复制到像素阵列，但我听说由于安全问题，这也可能不起作用。由于该应用程序正在处理人们的 Facebook 图片，我真的不想将它们存储在应用程序的服务器上。

**使用 PDFKit/wkhtmltopdf 使用 Rails 创建 PDF -**我已经尝试过了，但由于该应用程序是 Sinatra 应用程序（我认为），这让我很困惑。to_pdf 调用说“命令失败”会引发错误。我试过添加一个 config.middleware.use 行，但我不能 100% 确定把它放在哪里，而且似乎到处都没有说“config”是一个未定义的变量。一旦我在本地主机之外测试它，在 Heroku 上安装 wkhtmltopdf 似乎也会失败。

**使用 Prawn 使用 Rails 创建 PDF -**我尝试过 prawn，但它似乎与 PDFKit 有类似的问题，我对 Sinatra 应用程序的去向感到困惑。我敢肯定，我也读到人们也遇到了问题。

我是否错过了任何明显的解决方案，或者有什么我没有想到的？我想做的就是创建某种易于打印的文件，其位置完好无损，用户可以轻松下载和打印，但我遇到了很多问题，我不知道下一步该去哪里，我要去围成一圈。

如果有人对我如何解决这个问题有任何建议，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T15:56:57.547

听起来您的许多问题都与 Heroku 上无法访问的必要 PDF 二进制文件有关。在遵循[依赖隔离的十二因素方法](http://www.12factor.net/dependencies)之后， Heroku 特意提供了一个非常简单的系统。

如果您需要[在 Heroku 上运行自定义二进制文件，](http://www.ryandaigle.com/a/using-vulcan-to-build-binary-dependencies-on-heroku)我建议您查看一个名为 Vulcan 的工具，它可以编译与 Heroku 运行时兼容的二进制文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T18:29:04.890

如果大虾让您感到悲伤，只需使用其中一个 jquery 插件来打印您的 div 内容。如果您希望/需要 pdf 格式的图像，您甚至可以配置 pdf 打印机并打印文档而不是硬拷贝。

我在我的一个项目中使用[http://archive.plugins.jquery.com/project/jqPrint](http://archive.plugins.jquery.com/project/jqPrint)插件，它就像一个魅力。

# java - Base64 输入流转字符串

> ID：11472731
> 
> 赞同：0
> 
> 时间：2012-07-13T14:40:54.027
> 
> 标签：java, base64

我一直在尝试让输入流读取一个文件，该文件是纯文本，并且已经嵌入了一些图像和另一个文件，`base64`并在字符串中再次写入。但是保持编码，我的意思是，我想在字符串中有类似的东西：

```
/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIf
IiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7 
```

我一直在尝试使用`Base64InputStream`包中的类和更多内容，`org.apache.commons.codec`但我无法弄清楚。任何形式的帮助将非常感激。提前致谢！

**编辑**

使用阅读器的一段代码：

```
 BufferedReader br= new BufferedReader(new InputStreamReader(bodyPart.getInputStream()));
                        StringBuilder sb = new StringBuilder();
                        String line;
                        while ((line = br.readLine()) != null) {
                            sb.append(line);
                        }
                        br.close(); 
```

结果是：`.DIC;ÿÛC;("(;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ÿÀ@@"ÿÄ`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-04-27T12:30:22.810

您是否尝试过这样做：

`final byte[] bytes64bytes = Base64.encodeBase64(IOUtils.toByteArray(is)); final String content = new String(bytes64bytes);`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T14:49:13.450

可以使用文件其余部分的字符集读取包含一些 base64 数据的文本文件。

[Base64 编码](http://fr.wikipedia.org/wiki/Base64)是一种在有限的字符集中对字节进行编码的方法，几乎​​所有字符编码都没有变化，例如 ASCII 或 UTF-8。

Base64 不是字符集编码，在将文件读入字符串时，您不必指定您有一些 base64 编码数据。

因此，如果您的文本文件通常是 UTF-8（很可能），即使它包含 base64 编码流，您也可以毫无问题地读取它。只需使用基本阅读器，如果您不想解码，请不要使用 Base64InputStream。

使用阅读器打开文件时，必须[指定编码](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/InputStreamReader.html#InputStreamReader%28java.io.InputStream,%20java.nio.charset.Charset%29)。如果您不知道，我建议您使用可能的测试，`UTF-8`例如`US-ASCII`或`ISO-8859-1`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-19T12:43:45.507

[如果您有一个普通的 InputStream 对象，则可以使用 apache 公共库类Base64InputStream](http://commons.apache.org/proper/commons-codec/apidocs/org/apache/commons/codec/binary/Base64InputStream.html)构造函数直接从中获取 Base64 编码流

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T09:14:19.160

我找到了解决方案，受这篇文章的启发，[从 Java 中的 mimepart 获取图像的 base64 内容字符串](https://stackoverflow.com/questions/2764504/getting-base64-content-string-of-an-image-from-a-mimepart-in-java)

我认为这是一种愚蠢的对base64代码的解码和编码，但这是我发现解决这个问题的唯一方法。如果有人可以提供更好的解决方案，那也将不胜感激。

谢谢

# asp.net - .Net App 仅在用户访问根 url 时重定向用户进行身份验证

> ID：11472733
> 
> 赞同：1
> 
> 时间：2012-07-13T14:41:02.793
> 
> 标签：asp.net, .net, azure, wif, acs

我遇到了一个奇怪的问题。我有一个部署到 Azure 的 .Net 应用程序，它使用 Azure ACS 进行身份验证。虽然项目设置为 Web 应用程序，但我们主要提供静态 .html 和 .js 文件。问题是，只有当用户直接访问我们的根 URL 时，他们才会被重定向到通过 ACS 进行身份验证。

例如，我通过 Azure 模拟器在本地进行了此设置。如果用户访问 127.0.0.1:81/ 他们会被重定向登录，但如果他们直接访问 127.0.0.1:81/Index.html，他们能够加载页面而不会被重定向到 ACS。（尽管在页面加载到 .svc 服务期间随后的 .js 调用失败）

这是我的 web.config 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<!--
  For more information on how to configure your ASP.NET application, please visit
  http://go.microsoft.com/fwlink/?LinkId=169433
  -->
<configuration>
  <configSections>
    <section name="microsoft.identityModel" type="Microsoft.IdentityModel.Configuration.MicrosoftIdentityModelSection, Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
  </configSections>
  <location path="FederationMetadata">
    <system.web>
      <authorization>
        <allow users="*" />
      </authorization>
    </system.web>
  </location>
  <system.web>
    <httpRuntime requestValidationMode ="2.0"/>
    <authorization>
      <deny users="?" />
    </authorization>
    <authentication mode="None" />
    <compilation debug="true" targetFramework="4.0">
      <assemblies>
        <add assembly="System.Data.Entity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
        <add assembly="Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
      </assemblies>
    </compilation>
  </system.web>
  <connectionStrings>
    <add name="ExperienceBrowserEntities" connectionString="metadata=res://*/ExperienceBrowser.csdl|res://*/ExperienceBrowser.ssdl|res://*/ExperienceBrowser.msl;provider=System.Data.SqlClient;provider connection string=&quot;Data Source=tmbwb1mnyn.database.windows.net;Initial Catalog=ExperienceBrowser;Persist Security Info=True;User ID=ExperienceBrowserUser;Password=XXXXXXXX;MultipleActiveResultSets=True;Application Name=EntityFramework&quot;" providerName="System.Data.EntityClient" />
  </connectionStrings>
  <system.serviceModel>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" />
  </system.serviceModel>
  <appSettings>
    <add key="FederationMetadataLocation" value="https://appCentral.accesscontrol.windows.net/FederationMetadata/2007-06/FederationMetadata.xml" />
  </appSettings>
  <system.webServer>
    <modules>
      <add name="WSFederationAuthenticationModule" type="Microsoft.IdentityModel.Web.WSFederationAuthenticationModule, Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" preCondition="managedHandler" />
      <add name="SessionAuthenticationModule" type="Microsoft.IdentityModel.Web.SessionAuthenticationModule, Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" preCondition="managedHandler" />
    </modules>
  </system.webServer>
  <microsoft.identityModel>
    <service>
      <audienceUris>
        <add value="http://127.0.0.1:81/" />
      </audienceUris>
      <federatedAuthentication>
        <wsFederation passiveRedirectEnabled="true" issuer="https://appCentral.accesscontrol.windows.net/v2/wsfederation" realm="http://127.0.0.1:81/" requireHttps="false" />
        <cookieHandler requireSsl="false" />
      </federatedAuthentication>
      <applicationService>
        <claimTypeRequired>
          <!--Following are the claims offered by STS 'https://appCentral.accesscontrol.windows.net/'. Add or uncomment claims that you require by your application and then update the federation metadata of this application.-->
          <claimType type="http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name" optional="true" />
          <claimType type="http://schemas.microsoft.com/ws/2008/06/identity/claims/role" optional="true" />
          <!--<claimType type="http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier" optional="true" />-->
          <!--<claimType type="http://schemas.microsoft.com/accesscontrolservice/2010/07/claims/identityprovider" optional="true" />-->
        </claimTypeRequired>
      </applicationService>
      <issuerNameRegistry type="Microsoft.IdentityModel.Tokens.ConfigurationBasedIssuerNameRegistry, Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35">
        <trustedIssuers>
          <add thumbprint="D6DAB54F4A47E88FFF206E6796A3367DA6033B0C" name="https://appCentral.accesscontrol.windows.net/" />
        </trustedIssuers>
      </issuerNameRegistry>
      <certificateValidation certificateValidationMode="None" />
    </service>
  </microsoft.identityModel>
</configuration> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T19:17:48.440

认为您需要在 IIS 中添加要由 ASP.NET 处理的那些扩展。此答案不基于 Azure。我必须用常规的 IIS 和 ASP.NET 来做这件事。如果它在 Azure 中不起作用，请告诉我，我将删除答案。

“文件扩展名到 ASP.NET 的映射是在 Internet 信息服务 (IIS) 中完成的。默认情况下，.aspx 页面由 ASP.NET 运行，而 .htm 和 .html 页面则不是。”

[ASP.NET 网页语法概述](http://msdn.microsoft.com/en-us/library/k33801s3.aspx)

# jquery - 如何将多个值添加到本地存储数组？

> ID：11472736
> 
> 赞同：0
> 
> 时间：2012-07-13T14:41:12.423
> 
> 标签：jquery, local-storage

**我的问题**：下面的代码将一个值存储到 regId，当我再次单击按钮时，该值被覆盖。如何在 regId 中存储新值而不覆盖 regId 数组中的其他值？

```
$('.btn-joinContest').live('click', function(e){
if (Modernizr.localstorage) {
    var id = getUrlVars()["id"],
        regId = [ ],
        currentList = localStorage["contest"];

    if(currentList == null) {
        console.log('first click add to local storage');
        regId.push(id);
        localStorage['contest']=JSON.stringify(regId);  
    }
    else if (currentList.length === 0) {
        console.log('store contains empty value');
        regId.push(id);
        localStorage['contest']=JSON.stringify(regId);      
    } else {
        console.log('there is something in localstorage get it');
        regId = JSON.parse(currentList);
    // Search for a specified value within regId array and return its index
        // (or -1 if not   found).             
        if(jQuery.inArray(id, regId) > -1){
            console.log('id is already in array');
        } else {
            console.log('add current id to localstorage');
            regId.push(id);
            localStorage['contest']=JSON.stringify(regId);                  
        }             
    }
} else {
    console.log('this browser does not support localstorage')
}   
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T15:22:27.893

```
$('.btn-joinContest').live('click', function(e){
    id = 'Something new';
    currentList = localStorage["contest1"];
    var regId = [];
    console.log(currentList);
    if(currentList)
        regId = JSON.parse(currentList);
    regId.push(id);
    localStorage['contest1']=JSON.stringify(regId);      
});​​ 
```

像这样的东西会起作用吗？

[演示：](http://jsfiddle.net/GUbNG/)

# gwt - UiHandler 不适用于 SuggestBox SuggestionEvent

> ID：11472737
> 
> 赞同：0
> 
> 时间：2012-07-13T14:41:22.340
> 
> 标签：gwt, uibinder

我正在使用 SuggestBox 并尝试捕获用户选择建议时触发的 SuggestionEvent。我可以很容易地用普通的事件处理程序做到这一点：

```
itemInputBox.addEventHandler(new SuggestionHandler() {
            @Override
            public void onSuggestionSelect(SuggestionEvent event) {
                Window.alert(event.getSelectedSuggestion().getReplacementString());         
            }           
        }); 
```

这很好用，使用正确的替换字符串触发事件。但是，由于代码更加简洁，我喜欢尽可能使用 UiHandler。所以我尝试了以下方法：

```
@UiHandler("itemInputBox")
    void onSuggestionSelect(SuggestionEvent event) {
        Window.alert(event.getSelectedSuggestion().getReplacementString());
    } 
```

但这会导致以下错误：

```
[WARN] [jsonp] - Method 'getAssociatedType()' could not be found in the event 'SuggestionEvent'.

[ERROR] [jsonp] - Parameter 'SuggestionEvent' is not an event (subclass of GwtEvent). 
```

我有一个不同的 UiHandler 在同一个 SuggestBox 上正常工作，所以我有点困惑我哪里出错了：

```
@UiHandler("itemInputBox")
    void onKeyUp(KeyUpEvent event) {
            Window.alert("Key up event firing.");
    } 
```

我不明白为什么一个 UiHandler 正确触发，而另一个导致错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:55:13.283

SuggestionEvent 不扩展 GwtEvent，而是扩展 java.util.EventObject。

这就是它不适用于 UiBinder 的原因。我将在 GWT 贡献者列表中提出这一点，看看是否有特定的原因。现在我只是猜测在迁移到新的事件系统时它被遗忘了。

# marklogic - 数量元素范围指标对内存消耗的影响

> ID：11472740
> 
> 赞同：0
> 
> 时间：2012-07-13T14:41:42.467
> 
> 标签：marklogic

我有兴趣，元素范围指数如何影响系统性能？我的意思是那些很少使用的索引。也许我应该删除它们，或者它们不会影响 RAM 内存消耗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T23:12:43.750

所有范围索引都是内存映射的。如果它们不被使用，操作系统可能能够将它们分页，但无论哪种方式，只要有足够的可用内存空间，它们都不会影响性能。

您可以在管理 UI 中的林状态页面上准确查看林使用的内存量。或者您可以致电`xdmp:forest-status()`获取相同的信息。找出任何给定索引使用多少空间并不容易，但有时可能。

# java - 在eclipse中重启GAE

> ID：11472742
> 
> 赞同：1
> 
> 时间：2012-07-13T14:41:56.337
> 
> 标签：java, eclipse, google-app-engine

所以我正在使用 Java 学习 Google App Engine。修改文件时，我意识到我并不总是看到我的更改。我尝试单击红色按钮以在 Eclipse 中停止 Web 应用程序，然后重新启动应用程序，但是我没有看到更改。如果我在隐身模式下运行 chrome，甚至会发生这种情况。我对 IE 和 Firefox 也有同样的问题（由于我对 firebug 的偏好，我在开发时默认使用 firefox）。

有时我也会对一个项目感到恼火并开始一个新的谷歌应用引擎项目。然而，即使我关闭了项目，GAE 仍将运行第一个而不是第二个。更糟糕的是，当我删除根项目文件夹时，我仍然看到 index.html 页面，尽管我删除的项目的链接已损坏。

我在想有两个问题，一个是我的浏览器将这些文件存储在缓存中。另一个是我实际上并没有重新启动谷歌应用引擎。正确的程序只是在 Eclipse 中单击控制台中的红色方块，还是在命令行（在 Windows 中）上运行一些东西？

**简而言之，如果我想在 Eclipse 中停止 GAE 并重新启动它以查看我所做的任何更改，那么在 Windows 上执行此操作的最简单方法是什么？**

谢谢

编辑：

有传言说，将 Google Web Toolkit 添加到项目中会使我的 App Engine 启动显示在开发模式窗格中，在那里它很容易被杀死或重新启动。以这种方式处理这个问题是一个明智的想法吗？

[尝试这个触摸命令的想法，我希望有一种类似于 ruby​​ on rails](https://stackoverflow.com/questions/800701/how-do-i-restart-the-google-app-engine-java-server-in-eclipse?rq=1) [的命令行方式来重启服务器](https://stackoverflow.com/questions/10210625/how-to-rebuild-and-restart-the-gae-server-for-a-project)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T03:51:30.767

红色按钮将停止它。您不需要从命令行运行任何东西。

您应该做的是查看“开发模式”视图并确认没有任何运行。它在窗口--> 显示视图--> 其他--> 谷歌下。单击灰色箭头将显示打开的内容（运行与否）。此外，您可以按灰色 X 清除所有停止的实例。这应该确认是否有东西在运行。

另外，在运行 --> 运行配置 --> 服务器下查看。您可以选择设置端口，或自动设置。如果您尝试运行多个项目，如果第一个项目已经占用了端口，那么您的第二个项目可能无法启动。记住这一点。

至于您的浏览器将开发模式页面存储在缓存中，我认为它不能。事实上，如果您在实例中关闭正在运行的开发模式，您的浏览器页面应该会立即更新，反映它已失去连接的事实。如果没有，那么您肯定没有设法将其关闭。

好的，所以我说红色按钮会停止它，它会，但你必须得到正确的红色按钮。如果您有多个实例正在运行，请再次查看“开发模式”视图，只有一个红色按钮，您必须使用我提到的灰色箭头来关注您想要的开发模式实例。

它并没有那么复杂，你明天就会把它弄下来！![在此处输入图像描述](../Images/05b60cf68839767e7220113f2b9e2c64.png)

这里是开发。模式视图。你可以看到我有三个实例。第一个实际上正在运行，但由于出现错误而显示为红色。单击灰色灰色 X 将删除后两个未运行的实例并单击带有一个灰色 x 的文档图标（它没有变灰），将从当前运行的实例中清除日志并删除红色 x日志中没有错误。

知道了？

# macports - 安装 automake 时的 Macports 警告：警告：强制停用。尽管存在依赖关系，但继续进行

> ID：11472747
> 
> 赞同：3
> 
> 时间：2012-07-13T14:42:06.963
> 
> 标签：macports, automake

我刚刚安装了 MacPorts 并发出了命令：

```
sudo port install automake 
```

在整个过程中，我看到这条消息：

```
Warning: Deactivate forced.  Proceeding despite dependencies. 
```

这是什么意思？为什么会这样？这是否重要，如果是，我应该对此采取什么措施吗？

谢谢，gb

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T14:09:38.130

根据我自己的经验，这并不重要，在大多数情况下您不必对此做任何事情。这只是一个警告。

当软件包“A”的旧版本被卸载并被新版本替换，而另一个先前安装的软件包“B”依赖于它时，会显示此警告。这个包“B”是在考虑旧版本的包“A”的情况下构建的，如果新版本不兼容，可能会损坏。但是，对于大多数更新来说，这不是问题。

（升级软件包后，您会注意到 macports 会扫描您的文件以查找链接错误，我相信应该会检测到此类问题并自动修复它们。）

# asp.net-mvc - 将文本添加到操作链接

> ID：11472748
> 
> 赞同：1
> 
> 时间：2012-07-13T14:42:08.757
> 
> 标签：asp.net-mvc, twitter-bootstrap, html.actionlink

简单的问题：

使用`ActionLink`，如何创建这样的超链接？

```
<a href="/Test"  
      class="dropdown-toggle"  
      data-toggle="dropdown">  
      Test
      <b class="caret"></b></a> 
```

和

```
<a class="brand" href="/Home">
<img src="/images/w3r.png" width="111" height="30" alt="Fujiyama Logo" /></a> 
```

我正在尝试使用引导程序添加下拉列表。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:45:01.487

在这种情况下无需使用 ActionLink。ActionLink 用于基于 MVC 动作和控制器动态创建 URL。在这个例子中，HTML 本身应该没问题。

编辑：

要使用比带有操作链接的文本更复杂的内容，您可以执行以下操作。请对链接使用正确的操作和控制器：

```
<a href="@Url.Action("Test")"  
      class="dropdown-toggle"  
      data-toggle="dropdown">  
      Test
      <b class="caret"></b></a> 
```

和

```
<a class="brand" href="@Url.Action("Home")">
<img src="/images/w3r.png" width="111" height="30" alt="Fujiyama Logo" /></a> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-19T23:35:31.160

另一种可能性是使用[TwitterBootstrapMVC](https://www.twitterbootstrapmvc.com/Documentation/V2#dropdowns)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T02:53:36.403

我不确定`<b class="caret"></b>`您链接的部分，但至于属性的创建，您需要做的就是使用`HtmlHelper.ActionLink()`帮助程序扩展的 HtmlAttributes 参数。

```
@Html.ActionLink("Test", "Test", new { }, new Dictionary<string, object>() { { "class", "dropdown-toggle" }, { "data=toggle", "dropdown" } }) 
```

这假设您正在尝试创建一个带有文本的链接`Test`。此链接的执行将调用控制器`Test`上的操作。`home`

要创建图像链接，您可以按照上面的方法创建链接并修改 css 样式以包含背景图像（带有适当的填充）。您甚至可能想要使用`:before`伪标签。

有关详细信息，请参阅[http://dean-o.blogspot.com.au/2011/09/image-button-link-options-in-aspnet-mvc.html](http://dean-o.blogspot.com.au/2011/09/image-button-link-options-in-aspnet-mvc.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-27T13:26:04.963

您还可以查看[FluentBootstrap](http://www.fluentbootstrap.com)，它是针对 .NET 代码的 Twitter Bootstrap 的免费开源包装器（完整免责声明：我是开发人员）。

它可以让你像这样编写下拉列表：

```
using (var dropdown = Html.Bootstrap().Dropdown("Test").Begin())
{         
    @dropdown.DropdownLink("Test Link", "/Test")   
} 
```

它还与 ASP.NET MVC 集成以允许您通过操作和控制器或 T4MVC 指定链接以允许您使用`ActionResult`.

# objective-c - 选择太复杂无法使用 UIAlertView 时如何正确获取用户的选择

> ID：11472751
> 
> 赞同：2
> 
> 时间：2012-07-13T14:42:18.910
> 
> 标签：objective-c, ios, uiviewcontroller, delegates, nsobject

我一直在努力解决这个问题一段时间，所以任何帮助将不胜感激。

情况如下：我的应用程序有一个`UIViewController`名为`InitialViewController`. 此视图控制器有一个 UIButton，当按下该按钮时，它会创建一个`NSObject`名为`MyEngine`. 像这样的东西：

```
@interface InitialViewController : UIViewController <MyEngineDelegate>
...
@end

@implementation InitialViewController
...
-(IBAction)pressedButton:(id)sender {
    MyEngine *engine = [[MyEngine alloc] init];
    [engine start];
} 
```

在里面`start`，我以模态方式展示了一个 ViewController ( `ConflictViewController`) 来获得用户的选择：

```
@interface MyEngine : NSObject <ConflictViewControllerDelegate>
...
-(void) start;
@end

@implementation MyEngine
...
-(void) start {
        ConflictViewcontroller *cvc = [[ConflictViewController alloc] initWithNibName:@"ConflictViewController" bundle:nil];
        cvc.modalPresentationStyle = UIModalPresentationFormSheet;
        cvc.modalTransitionStyle = UIModalTransitionStyleFlipHorizontal;
        cvc.delegate = self;
        UIWindow *window = [(MyAppDelegate *) [[UIApplication sharedApplication] delegate] window];
        [[window rootViewController] presentModalViewController:cvc animated:YES];
}
@end 
```

`ConflictViewController`真的很简单。它只是等待用户做出决定，当用户按下按钮时，它会将消息发送到`delegate`，然后自行关闭。

```
-(IBAction)didSelectConflict:(id)sender {
    UISegmentedControl *seg = (UISegmentedControl*) sender;
    [self.delegate didResolveConflictChoice:seg.selectedSegmentIndex];
    [self dismissModalViewControllerAnimated:YES];
} 
```

我检查了每个连接，所有代表都正常工作。出了什么问题：当 MyEngine 在其实现中收到用户的选择时，`didSelectConflict:`它无法正常继续，因为它的所有属性都已消失`null`。

当`MyEngine`出现 时`ConflictViewController`，程序继续执行，当`start`完成时，它返回`pressedButton:`，当这个方法关闭时，`MyEngine`对象被释放。

我想知道是否有办法解决这个问题？有没有人以另一种方式做过这样的事情？The question here is: How to get the user's choice properly when the choice is too complex to use `UIAlertView`.

对不起，这个问题很长，我尽可能地简化了它。感谢您的宝贵时间，非常感谢任何链接、评论或任何形式的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T15:05:28.093

为什么要`MyEngine *engine`在 IBAction 中进行初始化，如果您希望使用 MyEngine 对象，为什么不在您的全局声明中`InitialViewController`并调用`[engine start]`IBaction。然后，当委托方法返回所选索引时，您可以将其应用于初始视图控制器中的全局 int 并继续前进。希望这是有道理的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:53:01.333

让你的方法开始为

```
-(void) startWithDelegate:(id)del {
        ConflictViewcontroller *cvc = [[ConflictViewController alloc] initWithNibName:@"ConflictViewController" bundle:nil];
        cvc.modalPresentationStyle = UIModalPresentationFormSheet;
        cvc.modalTransitionStyle = UIModalTransitionStyleFlipHorizontal;
        cvc.delegate = del;
        UIWindow *window = [(MyAppDelegate *) [[UIApplication sharedApplication] delegate] window];
        [[window rootViewController] presentModalViewController:cvc animated:YES];
} 
```

和

```
-(IBAction)pressedButton:(id)sender {
    MyEngine *engine = [[MyEngine alloc] init];
    [engine startWithDelegate:self];
} 
```

实施并`didResolveConflictChoice:`在`InitialViewController`那里获得代表电话。

**或者**，如果合适，您可以使用[UIActionSheet 。](http://eureka.ykyuen.info/2010/04/14/iphone-uiactionsheet-example/)

# security - Google Hangout：处理来自服务器的可见性

> ID：11472754
> 
> 赞同：0
> 
> 时间：2012-07-13T14:42:25.293
> 
> 标签：security, google-plus

我正在使用 Google Hangout 制作游戏，我需要控制哪些参与者可以与他人交流。

我想确保玩家无法通过调用 javascript 函数更改他可以看到的参与者列表。因为据我了解，每个参与者都可以改变他对其他参与者的可见性，我想阻止它。

所以我想知道是否可以在服务器端控制参与者之间的可见性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T15:23:32.493

简短的回答：没有。

中等答案：这真的取决于你需要什么，但可能不是。

更长的答案：听起来您想要对可见性和消息发送/状态共享进行更细粒度的控制，而不是 Hangout API 允许的。环聊 API 反映了参与者在今天的实际环聊中可以看到的内容 - 环聊中的其他所有人。共享状态与运行同一应用程序的所有其他环聊成员共享，并且可见性适用于环聊或同一应用程序中的所有用户。

如果你想限制或限制这一点（例如，如果人们被分成团队并且你想要一个“团队聊天”），你需要使用你自己的服务器来协调这种通信，至少在某种程度上。您的服务器要么需要实际进行团队成员之间的通信，要么分发每个团队将用作其共享状态的密码的共享密钥。

一个可能更棘手的解决方案可能是让每个团队运行不同的应用程序。由于每个应用程序只与在另一台参与者机器上运行的同一应用程序共享状态，并且只能列出运行同一应用程序的其他成员，因此在某些情况下这可能是一个有效的解决方案。

# c# - 在 UI 上拆分日期时间

> ID：11472759
> 
> 赞同：0
> 
> 时间：2012-07-13T14:42:38.787
> 
> 标签：c#, jquery, asp.net-mvc

在我的 ASP.NET MVC 应用程序中，我有一个名为“Date”的 ViewModel 属性，其格式为“5/18/2012 2:43:45 PM”。我想将其拆分为 UI 上的单独控件。

```
jQuery UI - Datepicker would show the date - DONE
Show three dropdowns next to the Datepicker that display hour,minutes and am/pm. 
```

我已将三个下拉菜单添加到 UI，但我很难理解如何根据 ViewModel 的“日期”属性返回的内容来设置这些值？换句话说，我如何拆分日期并将其显示在三个下拉列表中？

编辑：这是视图：

```
<div>           
            <%= Html.TextBoxFor(c => c.Scheduled, new { @Value = Model.Scheduled.Value.ToShortDateString(), @class = "datetime", style = "width:150px;" })%>                                      
                   <ol class="align">
                <li class="align" >
                    <select name="hour" >
                        <option value="1">1 </option>
                        <option value="2">2 </option>
                        <option value="3">3 </option>
                        <option value="4">4 </option>
                        <option value="5">5 </option>
                        <option value="6" >6 </option>
                        <option value="7">7 </option>
                        <option value="8">8 </option>
                        <option value="9">9 </option>
                        <option value="10">10 </option>
                        <option value="11">11 </option>
                        <option value="12">12 </option>                       
                    </select></li>                  
            </ol>        
            </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:51:28.573

如果“Date”属性的类型正确（DateTime），您应该能够调用 Date.Hour、Date.Minute，并使用 Date.ToString("tt") 来获取 am/pm。

假设 MVC3 带有剃刀......

```
<div id="time">
    Hour:<br/>
    <input type="text" value="@Model.Date.Hour" /><br/>
    Minute:<br/>
    <input type="text" value="@Model.Date.Minute" /><br/>
    AM/PM:<br/>
    <input type="text" value="@Model.Date.ToString("tt").ToLower()" />
</div> 
```

# php - PHP imagettftext 部分粗体

> ID：11472760
> 
> 赞同：5
> 
> 时间：2012-07-13T14:42:41.410
> 
> 标签：php, gd, imagettftext

我正在训练我的 PHP 技能来生成图像。我只需要一件不起作用的东西。我认为不可能按照我想要的方式，但应该有另一种方式。我已经拥有的代码是这样的：

```
<?php
$textSize = 10;
$text = addslashes("Wietse: Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed malesuada aliquet dolor, vitae tristique lectus imperdiet nec. Pellentesque et.");
$maxWidth = 448;

//Create image
$im = imagecreate(468, 60);

// Black background and White text
$bg = imagecolorallocate($im, 0, 0, 0);
$textColor = imagecolorallocate($im, 255, 255, 255);

// Split in multiple lines
$words = explode(' ', $text);
$lines = array();
$line = "";
foreach ($words as $word) {
    $box = imagettfbbox($textSize, 0, './arial.ttf', $line . $word);
    $width = $box[4] - $box[0];
    if($width > $maxWidth) {
        $line = trim($line);
        $line .= "\n";
    }
    $line .= $word . ' ';
}

// Write the text in the image
imagettftext($im, $textSize, 0, 10, $textSize + 10, $textColor, './arial.ttf', $line); // write text to image

// Output the image
header('Content-type: image/png');
imagepng($im);
imagedestroy($im);
?> 
```

这导致了这个图像：

![图片](../Images/48b6f10b6b16dd6d8babe98ee0ecd0a2.png)

它工作正常，但我的名字 Wietse 应该是 Bold。我认为不可能以简单的方式做到这一点，但它应该是可能的。我可以`imagettftext()`使用 Bold Arial 字体添加另一个，但是 Lorum ipsum 文本应该从名称旁边开始，第二行应该在与名称相同的 X 坐标上继续。就像现在一样。我还有一个愿望，但是我觉得太难了，因为这个文本可以有任何位置。但是，如果有人知道如何做到这一点，他就很棒。这是链接 ( [http://www.google.com](http://www.google.com) ) 有一个下划线。我不认为我需要提供更多信息。

特意感谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2016-02-01T21:32:30.057

几乎在每种字体中，此解决方案都可以使用。

如果您正在创建此文本：

```
imagettftext($jpg_image, 35, 0, $x, $y, $color, $font_path, $text2); 
```

如果你想要粗体，你应该添加这些：

```
imagettftext($jpg_image, 35, 0, $x, $y, $color, $font_path, $text2);
imagettftext($jpg_image, 35, 0, $x, $y+1, $color, $font_path, $text2);
imagettftext($jpg_image, 35, 0, $x, $y+2, $color, $font_path, $text2);
imagettftext($jpg_image, 35, 0, $x+1, $y, $color, $font_path, $text2);
imagettftext($jpg_image, 35, 0, $x+2, $y, $color, $font_path, $text2); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-13T17:43:44.330

我自己找到了一个解决方案，以粗体显示名称。我不想解释一切，因为我是提出这个问题的人，所以我只是给出带有结果图像的新代码。明天我会尝试给链接加下划线。如果有人知道答案，我会接受这个答案。请注意，我已经对代码进行了更多更改，这对于使代码正常工作并不是必需的。

编码：

```
<?php
$username = 'WietsedeVries';
$textSize = 10;
$text = addslashes("Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed malesuada aliquet dolor, vitae tristique http://www.google.com pellentesque et.");
$maxWidth = 448;

//Create image
$im = imagecreate(468, 60);

// Black background and White text
$bg = imagecolorallocate($im, 0, 0, 0);
$textColor = imagecolorallocate($im, 255, 255, 255);

// Write Bold Username in image
$usernameTotal = '@' . $username . ':';
imagettftext($im, $textSize, 0, 10, $textSize + 10, $textColor, './arialbd.ttf', $usernameTotal);

// Create white space with the width of the username
$usernameBox = imagettfbbox($textSize, 0, './arialbd.ttf', $usernameTotal);
$usernameWidth = $usernameBox[4] - $usernameBox[0];
$whiteSpace = '';
$whiteSpaceWidth = 0;
while($whiteSpaceWidth < $usernameWidth) {
    $whiteSpace .= ' ';
    $whiteSpaceBox = imagettfbbox($textSize, 0, './arial.ttf', $whiteSpace);
    $whiteSpaceWidth = $whiteSpaceBox[4] - $whiteSpaceBox[0];
}

// Split in multiple lines
$words = explode(' ', $text);
array_unshift($words, $whiteSpace);
$lines = array();
$line = "";
foreach ($words as $word) {
    $box = imagettfbbox($textSize, 0, './arial.ttf', $line . $word);
    $width = $box[4] - $box[0];
    if($width > $maxWidth) {
        $line = trim($line);
        $line .= "\n";
    }
    $line .= $word . ' ';
}

// Write the text in the image
imagettftext($im, $textSize, 0, 10, $textSize + 10, $textColor, './arial.ttf', $whiteSpace . ' ' . $line);

// Output the image
header('Content-type: image/png');
imagepng($im);
imagedestroy($im);
?> 
```

这导致了这个图像：

![图片](../Images/2088776549252989aaded00186bf51e4.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-10-10T08:31:42.943

尝试使用轮廓/描边。如何，请检查此代码。

```
function imagettfstroketext(&$image, $size, $angle, $x, $y, &$textcolor, &$strokecolor, $fontfile, $text, $px) {
    for($c1 = ($x-abs($px)); $c1 <= ($x+abs($px)); $c1++)
        for($c2 = ($y-abs($px)); $c2 <= ($y+abs($px)); $c2++)
            $bg = imagettftext($image, $size, $angle, $c1, $c2, $strokecolor, $fontfile, $text);
   return imagettftext($image, $size, $angle, $x, $y, $textcolor, $fontfile, $text);
}

$font_color = imagecolorallocate($im, 255, 255, 255);
$stroke_color = imagecolorallocate($im, 0, 0, 0);
imagettfstroketext($im, 60, 10, 300, 130, $font_color, $stroke_color, "wqy-microhei.ttc", "简体繁體", 2); 
```

结果：[http ://wmh.github.io/hunbook/_static/examples/gd-imagettftext/003.jpg](http://wmh.github.io/hunbook/_static/examples/gd-imagettftext/003.jpg)

去：[http ://wmh.github.io/hunbook/examples/gd-imagettftext.html](http://wmh.github.io/hunbook/examples/gd-imagettftext.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T17:41:08.620

为了获得最佳可视化效果，请使用`-$textColor`; 这将更好地显示文本。

# asp.net - 如何以红色显示负货币？

> ID：11472765
> 
> 赞同：1
> 
> 时间：2012-07-13T14:42:52.937
> 
> 标签：asp.net, .net, html, asp.net-mvc

我有以下html代码...

```
<%=String.Format("{0:C0}", item.currency)%> 
```

我需要货币格式，但我的负面显示是这样的......

```
($2,345) 
```

我希望格式为红色。我可以设置一个切换变量，但有没有更简单的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:58:24.963

在我的项目中，我想做同样的事情，但也将负值显示为“-$2345”而不是括号。

为了处理格式，我首先将以下内容添加到我的 BaseController 类（顾名思义，它是我所有控制器的基类）：

```
protected override void Initialize(System.Web.Routing.RequestContext requestContext)
{
    base.Initialize(requestContext);

    System.Globalization.CultureInfo modCulture = new System.Globalization.CultureInfo("en-US");
    modCulture.NumberFormat.CurrencyNegativePattern = 1;
    Thread.CurrentThread.CurrentCulture = modCulture;
} 
```

请参阅[http://msdn.microsoft.com/en-us/library/system.globalization.numberformatinfo.currencynegativepattern.aspx](http://msdn.microsoft.com/en-us/library/system.globalization.numberformatinfo.currencynegativepattern.aspx)。这处理了数字的格式。至于红色，我添加了一个名为“negative”的新css类：

```
.negative
{
    color: Red;
} 
```

然后在我的 .aspx 文件中：

```
<% if (item.currency < 0.0M)
{ %>
<span class="negative"><%=String.Format("{0:C}", item.currency)%></span>
<% }
else
{ %>
<span><%=String.Format("{0:C}", item.currency)%></span>
<% } %> 
```

将其放入 css 类的好处是，对于动态站点，如果它稍后变为正数（反之亦然，如果正值变为负数），我可以使用 jQuery 简单地从 span/div 添加或删除该类有问题并将文本设置为默认或红色。

# c# - MySQL 连接不会关闭

> ID：11472768
> 
> 赞同：2
> 
> 时间：2012-07-13T14:43:00.973
> 
> 标签：c#, mysql

这真的很简单，我要做的就是填充数据表，我将所有内容都包围在 using() 中，并且连接不会释放/关闭。请帮忙

```
DataTable loginTbl = MySQLProcessing.MySQLProcessor.StoreProcedureDTTable("Login", ParamArgs, "Login");

 public static DataTable StoreProcedureDTTable(string mysqlQuery, List<string> CommandArgs, string queryName)
    {

        DataTable DTTableTable = new DataTable();
        using (MySqlCommand MySQLCommandFunc = new MySqlCommand(mysqlQuery))
        {
            MySQLCommandFunc.CommandType = CommandType.StoredProcedure;
            foreach (string args in CommandArgs)
            {
                string[] splitArgs = args.Split('|');
                MySQLCommandFunc.Parameters.AddWithValue(splitArgs[0], splitArgs[1]);
            }
            using (MySqlDataAdapter DataDTTables = new MySqlDataAdapter(MySQLCommandFunc))
            {
                DataDTTables.SelectCommand.CommandTimeout = 240000;
                lock (_object)
                {
                    using (MySqlConnection con = new MySqlConnection(ConfigurationManager.ConnectionStrings["mysqlCon"].ConnectionString))
                    {
                        MySQLCommandFunc.Connection = con;
                        DataDTTables.Fill(DTTableTable);
                    }

                }
            }
        }
        DataTable catchConnectionTable = DTTableTable;
        DTTableTable.Dispose();
        return catchConnectionTable;
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T15:15:58.320

将 Pooling=False 添加到连接字符串

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T14:51:29.657

你有没有尝试过：

```
 using (MySqlConnection con = new MySqlConnection(ConfigurationManager.ConnectionStrings["mysqlCon"].ConnectionString))
      {
           con.open();
           MySqlDataAdapter DataDTTables = new MySqlDataAdapter(MySQLCommandFunc)
           DataDTTables.SelectCommand.CommandTimeout = 240000;
           MySQLCommandFunc.Connection = con;
           DataDTTables.Fill(DTTableTable);
           con.close();
     } 
```

?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-23T12:05:00.377

替代方法`Pooling=false`是[SqlConnection.ClearPool](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.clearpool%28v=vs.100%29.aspx)和[SqlConnection.ClearAllPools](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.clearallpools%28v=vs.100%29.aspx)方法。有关详细信息，请阅读：[SQL Server 连接池 (ADO.NET)](http://msdn.microsoft.com/en-us/library/8xx3tyca%28v=VS.100%29.aspx)

# java - 按下 Hold 键时停止声音

> ID：11472771
> 
> 赞同：0
> 
> 时间：2012-07-13T14:43:14.950
> 
> 标签：java, android

我想在用户按下按住键或电源键时停止媒体声音 我这样做

```
 public boolean onKeyDown(int keyCode, KeyEvent event) {
    if(keyCode == KeyEvent.KEYCODE_ENDCALL || keyCode == KeyEvent.KEYCODE_POWER){
        pauseSound();
    }
    return super.onKeyDown(keyCode, event);
} 
```

但是当按下电源或结束通话时，这个覆盖函数没有调用

任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T10:27:27.670

谢谢它解决了，出于安全原因，禁止使用 Ovveride EndCall & Power，我覆盖了“OnPause”（活动）并且效果很好，再次感谢

# ruby-on-rails - 使用 Devise、Doorkeeper 和 OAuth2 令牌的 API 和应用程序身份验证

> ID：11472776
> 
> 赞同：13
> 
> 时间：2012-07-13T14:43:23.763
> 
> 标签：ruby-on-rails, ruby-on-rails-3, api, oauth, devise

我有一个桌面应用程序和一个移动应用程序。我想对两个“设备”使用相同的 rails 应用程序。换句话说，我希望移动应用程序请求桌面应用程序上的内容。

我使用 Devise 进行身份验证（电子邮件 + 密码）。我已经在桌面应用程序上实现了 Doorkeeper，以便为我的移动应用程序生成 Oauth2 令牌。

以下是我的问题：

我的桌面应用程序控制器中有 before_filters 集以保护它们。

*   我不确定移动应用程序应如何与 Devise 共享 OAuth2 令牌以进行身份​​验证并访问我的受保护控制器？

事实上，现在应该由 Doorkeeper 使用`doorkeeper_for :all`代码检查我的控制器中的移动令牌。但要做到这一点，我必须无法设计保护`before_filter :authenticate_user!`......

我也应该在设计中保存 oauth 令牌吗？

我误解了移动应用程序应该如何使用设计和 OAuth2 协议进行身份验证？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-05-06T19:38:30.607

这是旧的，但还没有答案。

本质上，Devise 和 Doorkeeper 做同样的事情，Devise 使用会话（或令牌身份验证，如果您已启用）进行身份验证，而 Doorkeeper 使用在每个请求中发送的 OAuth 令牌进行身份验证。

您可能想要做的是将您的应用程序拆分为两个访问点，使用 Devise 进行常规桌面访问，并使用 Doorkeeper 进行 API。仅为常规桌面控制器启用设计路由，并仅为 api 控制器启用门卫路由。

在您的 API 应用程序控制器中，您可以将 current_user 覆盖为类似`User.find(doorkeeper_token.resource_owner_id) if doorkeeper_token`. 这也将匹配 Devise 的身份验证方式。

或者，如果您的 API 不必使用 OAuth，您可以使用 Devise 的 token_authenticable 配置，它提供与 OAuth 的承载令牌类似的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T08:20:44.243

我不确定我是否理解您的问题，但 Doorkeeper 完全锁定了您的控制器。`doorkeeper_for :all`如果您的控制器中有，则无法通过 Devise 身份验证进行访问。

您将需要一个单独的控制器来通过 OAuth2 共享您的数据，例如 API 控制器。然后您可以请求数据，例如通过`protocol://myapp:1234/ressource?access_token=thetoken`.

那是你要求的吗？否则请澄清:)

# java - 如何将值返回到Java中的变量中

> ID：11472777
> 
> 赞同：0
> 
> 时间：2012-07-13T14:43:24.123
> 
> 标签：java

如果我想将 myNum[x] 中的所有值放入一个变量中

```
int myNum[] = {1, 2, 22, 89, 56, 45};
int num = myNum.length;
int greater ;
for (int x = 0 ; x < num ; x++)
if (myNum[x] > 10) {
System.out.print(greater+"are than 10");
  } 
```

PS 仍在尝试在 Java 编程中立足

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:44:27.867

您只需将 myNum[x] 分配给更大的值。

```
 if (myNum[x] > 10) {
            greater=myNum[x];
            System.out.print(greater+"are than 10");
      } 
```

如果您的要求是全部保留`values >10`，那么应该是更大的`array/list`。这是列表的示例。

```
List<Integer> greater= new ArrayList<Integer>();

     if (myNum[x] > 10) {
                    greater.add(myNum[x]);
                    System.out.print(myNum[x]+"are than 10");
              } 
```

编辑

```
 if (myNum[x] > 10) {
            greater++;
            System.out.print(greater+"are than 10");
      } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:49:11.563

```
int myNum[] = {1, 2, 22, 89, 56, 45};
for (int x = 0 ; x < myNum.length; x++)
    if (myNum[x] > 10) {
        System.out.print(myNum[x] + " are than 10");    
    } 
```

您的代码的简化版本，

所以，我删除了一个额外的`int num = myNum.length;`和`int greater ;`

让我知道它是否不是您要找的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T14:47:47.867

这是你想要的吗？

```
int myNum[] = {1, 2, 22, 89, 56, 45};
int num = myNum.length;
int greater;
for (int x = 0; x < num; x++) {
    if (myNum[x] > 10) {
        greater = myNum[x];
        System.out.print(greater + "are than 10");
    }
} 
```

但是，您有一些冗余变量。代码可以简化：

```
int myNum[] = {1, 2, 22, 89, 56, 45};
for (int x = 0; x < myNum.length; x++) {
    if (myNum[x] > 10) {
        System.out.print(myNum[x] + "are than 10");
    }
} 
```

.... 或者您是否想实际存储每个单独的值？

```
int myNum[] = {1, 2, 22, 89, 56, 45};
List<Integer> values = new ArrayList<Integer>();
for (int x = 0; x < myNum.length; x++) {
    if (myNum[x] > 10) {
        System.out.print(myNum[x] + "are than 10");
        values.add(myNum[x]);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T14:54:46.900

我猜你想在一行上列出所有大于 10 的数字，所以输出 22、89、56、45 大于 10？（因为你使用的是）

如果你是一个简单的解决方案，那就是在 for 循环之前初始化一个更大的字符串，然后在 for 循环中连接它然后打印它。

所以

```
int myNum[] = {1, 2, 22, 89, 56, 45};
int num = myNum.length;
string greater = ""
for (int x = 0 ; x < num ; x++)
   if (myNum[x] > 10) {
    greater = greater + myNum[x]  # and what ever format you want between numbers
   }
}
System.out.print(greater+"are than 10"); 
```

使用 stringbuilder 或向量有更好的解决方案，但这是最基本的。

# java - 关于 Java 中的方法论和正确实践

> ID：11472778
> 
> 赞同：0
> 
> 时间：2012-07-13T14:43:24.013
> 
> 标签：java, enums, methodology

这可能是一个奇怪的问题，但是从方法论上讲，关于我如何在这里使用枚举（参见操作枚举）有什么问题吗？

[https://github.com/NicholasRoge/jrpgme/blob/master/src/roge/utils/Math.java](https://github.com/NicholasRoge/jrpgme/blob/master/src/roge/utils/Math.java)

就像我说的，这是一个奇怪的问题，但它看起来很……奇怪，对我来说。一天晚上我有了这个想法，结果很完美。

编辑：有人告诉我看解释器设计模式，所以我有。这正是我想要做的。罗弗。所以我可能会将我的代码切换到该模式。但是，我仍然非常欢迎您的意见。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T14:50:23.370

这有点不寻常，但这并没有错。实际上，它看起来像是一种清晰、简洁、简洁的操作符实现方式。这使它在我的书中成为一种很好的编程风格。

如果有问题，它们是在领域建模的问题级别，而不是`enum`类型的使用。

# regex - 如何让我的正则表达式只返回该行的第一个匹配项？

> ID：11472786
> 
> 赞同：0
> 
> 时间：2012-07-13T14:43:43.623
> 
> 标签：regex

我的数据包含这样的行：

```
55 511 00,"805, 809, 810, 839, 840",J223,201,338,116,16,200,115,6,P,S,"8,5","25,74",47,242,"55,7" 
```

我尝试过`,"(.*)",`作为正则表达式，但它捕获了太多的行。此表达式当前返回：

```
,"805, 809, 810, 839, 840",J223,201,338,116,16,200,115,6,P,S,"8,5","25,74", 
```

但我真正想要的只是第一个引用的字符串。有效的结果是：

*   `,"805, 809, 810, 839, 840",`
*   `805, 809, 810, 839, 840`

我怎样才能只捕获第一场比赛？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:46:31.640

您需要使`*` [懒惰而不是贪婪](http://www.regular-expressions.info/repeat.html#lazy)：

```
,"(.*?)", 
```

或匹配所有字符，但`"`：

```
,"[^"]*", 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T14:47:42.483

试试`"([^"]+)`。第 1 组将匹配`805, 809, 810, 839, 840`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T14:46:36.493

```
/"([^"]+)"/ 
```

会做的工作！“-s”之间的所有内容

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T14:47:28.697

你的正则表达式是贪婪的，**.***会得到一切，直到最后**“**

因此，要使其不贪心，请添加**?** 在括号部分的末尾：

```
,"(.*?)", 
```

一旦到达下一个“应该立即停止它**”**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-13T15:01:53.053

### 使用非贪婪匹配

有很多方法可以处理这个问题，但最简单和最通用的方法是在您的正则表达式引擎支持的情况下使用非贪婪匹配。如果没有，您必须构建一个更了解数据结构的表达式。

### 一些例子

这是一个使用 Perl 兼容的正则表达式来拆分输出的示例：

```
$ pcregrep -o '"(.*?)"' /tmp/foo | head -n1
"805, 809, 810, 839, 840" 
```

这是另一个使用纯 Perl 的示例：

```
$ perl -ne 'print "$1\n" if /(".*?")/' /tmp/foo
"805, 809, 810, 839, 840" 
```

这是使用 POSIX 扩展正则表达式的第三个示例，但它不支持非贪婪匹配。

```
$ egrep -o '("[^"]+")' /tmp/foo | head -n1
"805, 809, 810, 839, 840" 
```

您可能还需要考虑将输入拆分为字段，然后测试每个字段，直到找到匹配项。很大程度上取决于您可以使用的设施。

# sql - Postgres 类似于 SQL Server 中的 CROSS APPLY

> ID：11472790
> 
> 赞同：25
> 
> 时间：2012-07-13T14:44:04.623
> 
> 标签：sql, postgresql, postgresql-9.1, cross-apply, lateral

我需要将为 MS SQL Server 2005 编写的 SQL 查询迁移到 Postgres 9.1。在此查询
中替代的最佳方法是什么？`CROSS APPLY`

```
SELECT *
FROM V_CitizenVersions         
CROSS APPLY     
       dbo.GetCitizenRecModified(Citizen, LastName, FirstName, MiddleName,
BirthYear, BirthMonth, BirthDay, ..... ) -- lots of params 
```

`GetCitizenRecModified()`函数是表值函数。我不能放置这个函数的代码，因为它真的很大，计算起来很困难，我不能放弃它。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-07-13T15:22:19.560

在 Postgres **9.3**或更高版本中使用**`LATERAL`**连接：

```
SELECT v.col_a, v.col_b, f.*  -- no parentheses, f is a table alias
FROM   v_citizenversions v
LEFT   JOIN LATERAL f_citizen_rec_modified(v.col1, v.col2) f ON true
WHERE  f.col_c = _col_c; 
```

为什么`LEFT JOIN LATERAL ... ON true`？

*   [从函数返回的记录具有串联的列](https://stackoverflow.com/questions/25392371/record-returned-from-function-has-columns-concatenated/25392910#25392910)

* * *

对于**旧版本**，有一种非常简单的方法可以完成*我认为*您正在尝试使用 set-returning 函数（[`RETURNS TABLE`或`RETURNS SETOF record`OR`RETURNS record`](https://www.postgresql.org/docs/current/sql-createfunction.html)）：

```
SELECT *, (f_citizen_rec_modified(col1, col2)).*
FROM   v_citizenversions v 
```

该函数为外部查询的每一行计算一次值。如果函数返回多行，则结果行会相应地相乘。所有**括号在语法上都是**分解行类型所必需的。表函数可能看起来像这样：

```
CREATE OR REPLACE FUNCTION f_citizen_rec_modified(_col1 int, _col2 text)
  RETURNS TABLE(col_c integer, col_d text)
  LANGUAGE sql AS
$func$
SELECT s.col_c, s.col_d
FROM   some_tbl s
WHERE  s.col_a = $1
AND    s.col_b = $2
$func$; 
```

如果要应用`WHERE`子句，则需要将其包装在子查询或 CTE 中，因为列在同一级别上不可见。（无论如何，这对性能更好，因为您可以防止对函数的每个输出列进行**重复评估）：**

```
SELECT col_a, col_b, (f_row).*
FROM  (
   SELECT col_a, col_b, f_citizen_rec_modified(col1, col2) AS f_row
   FROM   v_citizenversions v
   ) x
WHERE (f_row).col_c = _col_c; 
```

还有其他几种方法可以做到这一点或类似的事情。这完全取决于你想要什么。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2016-03-08T16:49:48.170

死灵法：
PostgreSQL 9.3 中的新功能：

LATERAL 关键字

左 | 对 | 内部 JOIN **LATERAL**

`INNER JOIN LATERAL`相同`CROSS APPLY`
和`LEFT JOIN LATERAL`相同`OUTER APPLY`

示例用法：

```
SELECT * FROM T_Contacts 

--LEFT JOIN T_MAP_Contacts_Ref_OrganisationalUnit ON MAP_CTCOU_CT_UID = T_Contacts.CT_UID AND MAP_CTCOU_SoftDeleteStatus = 1 
--WHERE T_MAP_Contacts_Ref_OrganisationalUnit.MAP_CTCOU_UID IS NULL -- 989

LEFT JOIN LATERAL 
(
    SELECT 
         --MAP_CTCOU_UID    
         MAP_CTCOU_CT_UID   
        ,MAP_CTCOU_COU_UID  
        ,MAP_CTCOU_DateFrom 
        ,MAP_CTCOU_DateTo   
   FROM T_MAP_Contacts_Ref_OrganisationalUnit 
   WHERE MAP_CTCOU_SoftDeleteStatus = 1 
   AND MAP_CTCOU_CT_UID = T_Contacts.CT_UID 

    /*  
    AND 
    ( 
        (__in_DateFrom <= T_MAP_Contacts_Ref_OrganisationalUnit.MAP_KTKOE_DateTo) 
        AND 
        (__in_DateTo >= T_MAP_Contacts_Ref_OrganisationalUnit.MAP_KTKOE_DateFrom) 
    ) 
    */
   ORDER BY MAP_CTCOU_DateFrom 
   LIMIT 1 
) AS FirstOE 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-11-21T16:55:48.393

我喜欢 Erwin Brandstetter 的回答，但是，我发现了一个性能问题：运行时

```
SELECT *, (f_citizen_rec_modified(col1, col2)).*
FROM   v_citizenversions v 
```

f_citizen_rec_modified 函数将为它返回的每一列运行 1 次（乘以 v_citizenversions 中的每一行）。我没有找到这种效果的文档，但能够通过调试推断出来。现在问题变成了，我们如何才能获得这种效果（在 9.3 之前，横向连接可用）没有这种性能抢劫的副作用？

更新：我似乎找到了答案。重写查询如下：

```
select x.col1, x.col2, x.col3, (x.func).* 
FROM (select SELECT v.col1, v.col2, v.col3, f_citizen_rec_modified(col1, col2) func
FROM   v_citizenversions v) x 
```

关键区别是首先获取原始函数结果（内部子查询），然后将其包装在另一个选择中，将这些结果输出到列中。这是在 PG 9.2 上测试的

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-13T15:19:02.520

此链接似乎显示了如何在 Postgres 9.0+ 中执行此操作：

[PostgreSQL：参数化递归 CTE](http://explainextended.com/2010/12/24/postgresql-parametrizing-a-recursive-cte/)

它位于标题为“使用集合返回函数模拟 CROSS APPLY”部分的页面下方。请务必注意示例后的限制列表。

# objective-c - iOS - 执行一段代码 10 秒

> ID：11472791
> 
> 赞同：1
> 
> 时间：2012-07-13T14:44:04.983
> 
> 标签：objective-c, ios, nstimer

我想每 500 毫秒执行一段代码，总共 10 秒。我的代码使用此代码每半秒执行一次

```
[NSTimer scheduledTimerWithTimeInterval:0.5 target:self selector:@selector(getLevel:) userInfo:nil repeats: YES]; 
```

但我似乎无法弄清楚如何在 10 秒后停止它的执行。“重复”参数似乎不允许指定时间。有人可以指出我应该去哪里吗？

谢谢布赖恩

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T14:48:26.180

您需要`invalidate`在 scheduleTimerWithTimeInterval:target:selector:userInfo:repeats: 给您的 NSTimer 上发送消息。例如，在您的类的属性或 iVar 中分配该方法返回给您的 NSTimer，并在 10 秒后调用`invalidate`它。

例子：

。H：

```
@interface myClass{
NSTimer *myT;
}
[...] 
```

米：

```
[...]
{
    myT = [NSTimer scheduledTimerWithTimeInterval:0.5 target:self selector:@selector(getLevel:) userInfo:nil repeats: YES];

    [NSTimer scheduledTimerWithTimeInterval:10 target:self selector:@selector(stop) userInfo:nil repeats:NO];
}

-(void)stop{
    [myT invalidate];
}
[...] 
```

`NSTimer`如果您愿意，您可以通过实施某种标志来避免另一个，`finish`并跟踪您向该`getLevel`方法发送消息的次数，因为它是每 0.5 秒一次，这将是 20 次。

但我宁愿 2 个`NSTimer`对象，因为你知道它是 10 秒，而不管其他计时器如何，你可能决定改变它的频率，提高或降低它的频率......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T14:49:13.677

最好的办法是在你的类上创建一个属性。

```
@property (nonatomic, strong) NSTimer *timer;
@property (nonatomic, strong) int ticks; 
```

然后在你的 getLevel 选择器中调用这个：

```
if (ticks >= 20) [self.timer invalidate];
// 20 is 10 seconds * 500 milliseconds
ticks++; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T15:17:56.507

您可以采用的另一种方法是定义一个选择器，例如`-(void)stopTimer{}` 使计时器无效。然后，当您首先创建计时器时，请执行以下操作之一：

`[self performSelector:@selector(stopTimer) withObject:nil afterDelay:10.0];`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T14:51:24.483

您可以使用 invalidate 设置另一个计时器来停止它。只需在 ivar 或属性中保留此计时器的引用即可。

检查此[答案](https://stackoverflow.com/questions/5862743/pausing-an-nstimer)以获取更多信息。

# xcode - 通过命令行修改私钥的每个应用程序访问控制？

> ID：11472795
> 
> 赞同：8
> 
> 时间：2012-07-13T14:44:21.083
> 
> 标签：xcode, macos, security, command-line, keychain

我在包含私钥的钥匙链中有一个证书。我想将一个应用程序添加到该密钥的访问控制“白名单”中。我知道如何使用图形钥匙链工具来做到这一点，但我想通过命令行作为 Xcode 构建脚本的一部分来做到这一点。

据我所知，“安全”命令是在命令行操作钥匙链的方法，但我无法从手册页中弄清楚我将如何完成这项任务。

为了完整起见，这正是我想通过命令行在钥匙链工具中执行的操作：

1.  单击证书以显示其私钥。
2.  右键单击私钥并选择“获取信息”菜单项。
3.  单击“访问控制”选项卡。
4.  单击“+”按钮将应用程序添加到白名单。
5.  选择应用程序（在我的例子中是 Xcode）并单击“添加”。

我可能还对如何允许访问所有应用程序感兴趣。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-01T21:14:15.643

我认为在导入密钥*后*`security`没有任何方法可以做到这一点。但是，如果您是第一次导入密钥，则可以使用该标志：*`-T`*

 *```
 -T  Specify an application which may access the imported key 
     (multiple -T options are allowed) 
```

所以就我而言，我能够做到这一点：

```
security import my.key -P mypassword -T /usr/bin/pkgbuild 
```

一切正常！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-02-24T11:57:40.627

**免责声明**

老实说，这可能不是发布此内容的最佳位置……但我偶然发现了这个（以及其他几个）条目，它们或多或少存在相同的问题。另请参阅[https://stackoverflow.com/a/34388302/359100](https://stackoverflow.com/a/34388302/359100)。但是，由于我找到了一个解决方案，可以帮助其他尝试通过远程会话更改钥匙串中私钥的访问控制的人，我的解决方案可以帮助...

对我来说，通过 CLI 导入的 B/c*不起作用*（使用`-T`or `-A`）。关于从钥匙串的访问，我总是得到那个流行音乐。

顺便说一句：如果你知道这个属于哪里的更好的 SO 答案......请让我知道或将它移到那里......

**解决方案**

*在本地*机器上创建钥匙串。例如，将其命名为 apple-development[.keychain]。在那里添加您的私钥并分配必要的访问控制（最好：“允许所有......”）。现在将该钥匙串复制到您的远程 Mac 并通过钥匙串应用程序（文件/添加钥匙串...）将其添加到那里。对于 CI，您可能会执行以下操作：

```
security unlock-keychain -p YOUR-KEYCHAIN-PASSWORD "${HOME}/apple-development.keychain" 
```*

# wpf - ICollectionView 取消当前更改

> ID：11472798
> 
> 赞同：2
> 
> 时间：2012-07-13T14:44:30.187
> 
> 标签：wpf, icollectionview, currentitem

我正在寻找一种方法来根据单击的项目取消 CurrentChanging 事件。在我的应用程序中，我使用 ICollectionView 来保存我的视图模型列表，这些视图模型在 tabcontrol 中呈现为 tabitems。对于特定的视图模型，我需要在激活视图模型之前进行一些属性检查。为了做到这一点，我现在需要特定的视图模型将成为下一个当前项目。根据属性检查的结果，应该允许或取消当前项目的更改（仅针对特定视图模型）。我不想对所有其他视图模型进行属性检查。

有没有办法在设置之前访问下一个当前项目？

编辑：

另一个想法：在 currentchanged 事件中，我进行属性检查，并根据其结果，向父视图模型（包含视图模型列表）发送一条消息，以触发它将当前移动到第一个。我希望这会触发一个新的当前更改事件，但它不会。当前项始终是在第一个当前更改事件之前选择的视图模型。

那里发生了什么？

# c# - 嵌套的 WFC DataGrid 给出 NullReferenceException

> ID：11472800
> 
> 赞同：0
> 
> 时间：2012-07-13T14:44:36.650
> 
> 标签：c#, wpf, datagrid

我有一个三层深的树状对象结构，并试图在 DataGrid 中表示它。

我将在下面展示 XAML，但基本上有一个顶级 DataGrid，其 DataGridTemplateColumn 包含一个 ToggleButton。如果单击该按钮，它将显示第二个 DataGrid，它具有相同的设置。这应该允许您单击第二个网格中的 ToggleButton 并显示第三个（也是最后一个）DataGrid。

这是预期的结果：

![在此处输入图像描述](../Images/cd21428a1ee112407b21374f476d9162.png)

因此，您可以单击“目的地...”以显示“目的地”网格，然后单击“表达式...”以显示该详细信息。

两个按钮都使用相同的代码实现：

```
<DataGridTemplateColumn>
    <DataGridTemplateColumn.CellTemplate>
        <DataTemplate>
            <ToggleButton Content="Destinations..." ButtonBase.Click="ToggleButton_Click" />
        </DataTemplate>
    </DataGridTemplateColumn.CellTemplate>
</DataGridTemplateColumn> 
```

如果两个按钮都分配了它们的 Click 处理程序（相同的处理程序或不同的处理程序），当我单击“目的地...”时（甚至在目的地网格显示之前），我会收到 NullReferenceException。

但是如果我取出“Expressions...”按钮的处理程序，一切都显示得很好，但当然你不能扩展内部网格。

问题不在于我的对象，因为如果我只是离开网格的 RowDetailsVisibilityMode="Visible" 来自所有三个级别的数据都会反映在网格中。该问题似乎与使用内部网格上的 ButtonBase.Click 事件有关。

这是 XAML：

```
<Window x:Class="SPConvert.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Stored Procedure Converter" Height="425" Width="705">
    <Grid>
        <DataGrid Name="conversionsGrid" RowDetailsVisibilityMode="Collapsed" CanUserAddRows="False">
            <DataGrid.Columns>
                <DataGridTemplateColumn>
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <ToggleButton Content="Destinations..." ButtonBase.Click="ToggleButton_Click" />
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
            <DataGrid.RowDetailsTemplate>
                <DataTemplate>
                    <StackPanel DockPanel.Dock="Left">
                        <Label Content="Add destination paths" />
                        <DataGrid ItemsSource="{Binding Destinations}" RowDetailsVisibilityMode="Visible">
                            <DataGrid.Columns>
                                <DataGridTemplateColumn>
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <ToggleButton Content="Expressions..." ButtonBase.Click="ToggleButton_Click" />
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                            <DataGrid.RowDetailsTemplate>
                                <DataTemplate>
                                    <DataGrid ItemsSource="{Binding Expressions}" AutoGenerateColumns="True">
                                    </DataGrid>
                                </DataTemplate>
                            </DataGrid.RowDetailsTemplate>
                        </DataGrid>
                    </StackPanel>
                </DataTemplate>
            </DataGrid.RowDetailsTemplate>
        </DataGrid>
    </Grid>
</Window> 
```

**更新：** 我最初没有包含点击处理程序的代码，因为那里没有发生异常。调试时，我可以看到单击（目的地按钮）执行并返回一个有效行（并确认它是正确的行）。只要未分配内部按钮（表达式）的事件处理程序，该行就会扩展得很好。当它被分配时，我得到了错误。但请记住，永远不会单击“表达式”按钮，我可以在调试器中确认处理程序只执行一次。

这是点击处理程序的代码：

```
private DataGridRow FindClickedRow(DependencyObject dep)
{
    // dep is the DependencyObject that was clicked. We can then iterate up the visual tree to find the clicked row.
    while ((dep != null) && !(dep is DataGridRow))
        dep = VisualTreeHelper.GetParent(dep);
    return dep as DataGridRow;
}

private void ToggleButton_Click(object sender, RoutedEventArgs e)
{
    DataGridRow row = FindClickedRow(e.OriginalSource as DependencyObject);
    row.DetailsVisibility = (row.DetailsVisibility == Visibility.Collapsed)?Visibility.Visible:Visibility.Collapsed;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T09:33:04.673

此[链接](http://connect.microsoft.com/VisualStudio/feedback/details/553188/datagrid-in-wpf-4-raises-nullreferenceexception-when-declaring-event-handlers-on-templatecolumns-in-xaml-in-a-datatemplate)描述了您的问题。

简单地说，您不能附加到在 RowDetailsTemplate 中内联的事件表单模板。

第一个解决方案：将您的模板移动到 Control\Window 资源：

```
 <Window.Resources>
    <ResourceDictionary>
        <DataTemplate x:Key="innertemplate">
            <ToggleButton Content="Expressions..." ButtonBase.Click="ToggleButton_Click" />
        </DataTemplate>

        <DataTemplate x:Key="template">
            <StackPanel DockPanel.Dock="Left">
                <Label Content="Add destination paths" />
                <DataGrid ItemsSource="{Binding Destinations}" RowDetailsVisibilityMode="Visible">
                    <DataGrid.Columns>
                        <DataGridTemplateColumn CellTemplate="{StaticResource innertemplate}">

                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                    <DataGrid.RowDetailsTemplate>
                        <DataTemplate>
                            <DataGrid ItemsSource="{Binding Expressions}" AutoGenerateColumns="True">
                            </DataGrid>
                        </DataTemplate>
                    </DataGrid.RowDetailsTemplate>
                </DataGrid>
            </StackPanel>
        </DataTemplate>
    </ResourceDictionary>
</Window.Resources> 
```

并在网格中引用它：

```
RowDetailsTemplate="{StaticResource template}" 
```

第二种解决方案：将模板的内容移动到 UserControl 并将模板添加为：

```
 <DataGrid.RowDetailsTemplate>
            <DataTemplate>
                <local:YourControl /> 
```

`local`我的项目在哪里`xmlns:local="clr-namespace:WpfApplication1"`

# css - 使用 :before 伪属性的 CSS 间距

> ID：11472801
> 
> 赞同：0
> 
> 时间：2012-07-13T14:44:44.747
> 
> 标签：css

我有一张我正在尝试使用 :before 放置的图像。我希望图像位于该行的第一个字母上。如果你看现场，鸟的脚应该碰到字母“C”。它适用于小提琴，但不适用于现场。有什么帮助吗？

[http://imip.rvadv.com/index3.html](http://imip.rvadv.com/index3.html)

小提琴：http: [//jsfiddle.net/imakeitpretty/yV3kK/30/](http://jsfiddle.net/imakeitpretty/yV3kK/30/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:49:58.710

```
#chirp:before{
margin-bottom:-20px;
} 
```

目前，margin-bottom 设置为 -10px；

希望能帮助到你！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T14:50:34.233

您在 jsfiddle 和您的测试站点上使用不同的基础 css。

例如，字体系列已经不同，因此您无法真正比​​较两者。

无论如何，设置`margin-bottom`为`-20px`in`#chirp:before`可以解决您的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T14:59:19.637

考虑添加

```
.st-accordion ul li > a{
   line-height:27px;
   ...
} 
```

并更新以下内容：

```
#chirp:before {
    ...
    margin-bottom:0;
    ...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T14:51:13.113

您可以尝试将 :before 元素定位为绝对：

[http://jsfiddle.net/yV3kK/31/](http://jsfiddle.net/yV3kK/31/)

```
#chirp:before {
    content:url(http://imip.rvadv.com/images/chirp-bird.png);
    padding:0;
    display:block;
    width: 77px;
    height: 50px;
    position: absolute;
    top: -44px; 
    left: -35px;
}

#chirp{
    position:relative;    
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-13T14:51:55.530

对我来说似乎是个`line-height`问题。尝试将其设置为`36px`（与您的字体大小相同）。我不确定*为什么*会这样，但我怀疑文本的行高在您的网站和 JSFiddle 上是不同的。

# ios - 更新情节提要中的子视图文本视图

> ID：11472803
> 
> 赞同：0
> 
> 时间：2012-07-13T14:44:55.613
> 
> 标签：ios, storyboard

我正在使用故事板开发应用程序，并且嵌入了导航控制器。在子视图中，当按下按钮时，它会调用父视图控制器中的函数而不更改视图。

```
[self.delegate buttonPressed]; 
```

以及应该在子视图中更新 textview 文本的方法。childviewcontroller.textViewName.text=@"something"; 但是 textview 没有被更新。

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender{
[[segue destinationViewController] setDelegate:self];
} 
```

长话短说，如果我希望父视图控制器更改子视图控制器中文本视图的文本，那么在使用情节提要时应该如何设置它。谁能给我一些想法？不知道我解释清楚了没有。我对此还是有点陌生​​，并且在制作这个应用程序时正在学习。先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T15:46:57.277

这听起来令人困惑。如果您需要在父 VC 中触发一个函数，为什么不创建一个返回所需内容的类方法，然后在该子 VC 中执行类似的操作：

```
NSString *newText = [MyParentViewController getSomeData];
myTextView.text = newText; 
```

或者更好的是，将该类方法放在一个新类中，为您的 VC 获取数据。这将更符合面向对象的编程。

# c++ - 运行 Windows 筛选平台示例时出错

> ID：11472804
> 
> 赞同：3
> 
> 时间：2012-07-13T14:44:59.083
> 
> 标签：c++, windows, visual-studio, wfp

我正在尝试测试微软提供的 WFP（Windows 过滤平台）示例。测试时出现错误。

在构建时构建良好：带有以下消息：

> 构建开始：项目：包（包\包），配置：Win8 调试 Win32 ------ Inf2Cat 任务被跳过，因为没有要处理的 inf 文件
> 
> ========== 构建：1 成功，0 失败，5 最新，0 跳过 ==========

并且在运行 exe 文件时出现错误。作为：

> “无法验证文件的数字签名......”。

如何解决这个问题。

代码来自：[msdn](http://code.msdn.microsoft.com/windowshardware/Windows-Filtering-Platform-27553baa#content)

我正在使用带有 Visual Studio 2012 的 Windows 8 Release Preview 机器。

# memory-management - GL_STACK_OVERFLOW (0x503) 错误 Cocos2d

> ID：11472805
> 
> 赞同：0
> 
> 时间：2012-07-13T14:45:01.177
> 
> 标签：memory-management, opengl-es, cocos2d-iphone, removechild

所以我设置了它，所以当角色健康<100（出于测试目的）时，它会停止场景并进入游戏结束场景。

```
if (playerDataManager.playerHealth < 100) {
   [[CCDirector sharedDirector]  replaceScene:[CCTransitionFade transitionWithDuration:3 scene: [GameLogic scene]]];
} 
```

但是当玩家的生命值低于 100 时，它会进入新场景，但 FPS 从 60 急剧下降到 5。

我得到一个列表，`OpenGL error 0x0503 in -[EAGLView swapBuffers]`然后它像那样冻结大约 40 秒，然后 FPS 解冻并回到 60，我得到一个列表`2012-07-13 10:37:50.234 Tilegame[93513:10a03] cocos2d: removeChildByTag: child not found!`

然后我可以像往常一样继续使用该应用程序，返回主菜单，开始一个新游戏，然后重新创建错误。

```
#import "HelloWorldLayer.h"
#import "Menu.h"
#import "SimpleAudioEngine.h"
#import "LogCabinMap.h"
#import "LogShedMap.h"
#import "SaveData.h"
#import "pauseM.h"
#import "Player.h"
#import "GameLogic.h"

CCSprite *player;
CGPoint newPos;
int joyDegrees;

// HelloWorldLayer implementation
@implementation HelloWorldLayer

@synthesize tileMap = _tileMap;
@synthesize background = _background;
@synthesize buildings = _buildings;
@synthesize meta = _meta;
@synthesize player = _player;
@synthesize foreground = _foreground;
@synthesize numCollected = _numCollected;
@synthesize hud = _hud;

-(void) animateEnemy:(CCSprite*)enemy {
    //speed of the enemy
    ccTime actualDuration = .2;
    id actionMove;
    int distanceFromPlayer = ccpDistance(player.position, enemy.position);

    if (distanceFromPlayer < 200) { //Check whether enemy can "see" Ninja before moving towards him.
        //rotate to face the player
        CGPoint diff = ccpSub(player.position,enemy.position);
        float angleRadians = atanf((float)diff.y / (float)diff.x);
        float angleDegrees = CC_RADIANS_TO_DEGREES(angleRadians);
        float cocosAngle = -1 * angleDegrees;
        if (diff.x < 0) {
            cocosAngle += 180;
    }
        enemy.rotation = cocosAngle;

    actionMove = [CCMoveBy actionWithDuration:actualDuration
                                                   position:ccpMult(ccpNormalize(ccpSub(player.position,enemy.position)),10)];

} else {
            actionMove = [CCMoveBy actionWithDuration:actualDuration
                                     position:ccpMult(ccpNormalize(ccpSub(player.position,enemy.position)),0)];
}

id actionMoveDone = [CCCallFuncN actionWithTarget:self
                                         selector:@selector(enemyMoveFinished:)];
[enemy runAction:[CCSequence actions:actionMove, actionMoveDone, nil]];
}

// callback. starts another iteration of enemy movement.
- (void) enemyMoveFinished:(id)sender {
     CCSprite *enemy = (CCSprite *)sender;

    [self animateEnemy: enemy];
}

-(void)addEnemyAtX:(int)x y:(int)y {
    CCSprite *enemy = [CCSprite spriteWithFile:@"enemy1.png"];
    enemy.position = ccp(x, y);
    [self addChild:enemy];
    [self animateEnemy:enemy];
}

-(void)setViewpointCenter:(CGPoint) position {

    CGSize winSize = [[CCDirector sharedDirector] winSize];

    int x = MAX(position.x, winSize.width / 2);
    int y = MAX(position.y, winSize.height / 2);
    x = MIN(x, (_tileMap.mapSize.width * _tileMap.tileSize.width) 
        - winSize.width / 2);
    y = MIN(y, (_tileMap.mapSize.height * _tileMap.tileSize.height) 
        - winSize.height/2);
    CGPoint actualPosition = ccp(x, y);

    CGPoint centerOfView = ccp(winSize.width/2, winSize.height/2);
    CGPoint viewPoint = ccpSub(centerOfView, actualPosition);
    self.position = viewPoint;

}

-(id) init
{
    if( (self=[super init] )) {
        [[SimpleAudioEngine sharedEngine] preloadEffect:@"pickup.caf"];
        [[SimpleAudioEngine sharedEngine] preloadEffect:@"hit.caf"];
        [[SimpleAudioEngine sharedEngine] preloadEffect:@"move.caf"];
        //[[SimpleAudioEngine sharedEngine] playBackgroundMusic:@"TileMap.caf"];
        self.isTouchEnabled = YES;
        self.tileMap = [CCTMXTiledMap tiledMapWithTMXFile:@"TileMap.tmx"];
        self.background = [_tileMap layerNamed:@"Background"];
        self.foreground = [_tileMap layerNamed:@"Foreground"];
        self.buildings = [_tileMap layerNamed:@"Buildings"];
        self.meta = [_tileMap layerNamed:@"Meta"];
        _meta.visible = NO;

        CCTMXObjectGroup *objects = [_tileMap objectGroupNamed:@"Objects"];
        NSAssert(objects != nil, @"'Objects' object group not found");
        //NSMutableDictionary * padPoints = [objects objectNamed:@"pad"];
        NSMutableDictionary * padPoints;
        SaveData * SaveDataManager = [SaveData sharedSaveDataManager];

        for (int i = 0; i < 20; i ++) {
            for (padPoints in [objects objects]) {
                if ([[SaveDataManager.padArray objectAtIndex: i] intValue] == 1 ){
                    if ([[padPoints valueForKey:@"pad"] intValue] == i){
                        int x = [[padPoints valueForKey:@"x"] intValue];
                        int y = [[padPoints valueForKey:@"y"] intValue];
                        self.player = [CCSprite spriteWithFile:@"man.png"];
                        _player.position = ccp(x+16,y+16);
                        //[self addChild:_player];
                }
            }
        }
    }
    // iterate through objects, finding all enemy spawn points
    // create an enemy for each one
    NSMutableDictionary * spawnPoints;
    for (spawnPoints in [objects objects]) {
        if ([[spawnPoints valueForKey:@"Enemy"] intValue] == 2){
            int x = [[spawnPoints valueForKey:@"x"] intValue];
            int y = [[spawnPoints valueForKey:@"y"] intValue];
            [self addEnemyAtX:x+=16 y:y+=64];

        }
    }

    player = [CCSprite spriteWithFile:@"man.png"];

    player.position= _player.position;
    [_tileMap addChild:player z: 0];

   // [self addChild:player z:10];

    [self setViewpointCenter:player.position];
    [self addChild:_tileMap z:-1];
    [self scheduleUpdate];
    }
return self;
}

- (CGPoint)tileCoordForPosition:(CGPoint)position {
    int x = position.x / _tileMap.tileSize.width;
    int y = ((_tileMap.mapSize.height * _tileMap.tileSize.height) - position.y) /           _tileMap.tileSize.height;
    return ccp(x, y);
}

-(void)setPlayerPosition:(CGPoint)position {
    Player * playerDataManager = [Player playerSaveDataManager];
    CGPoint tileCoord = [self tileCoordForPosition:position];
    int tileGid = [_meta tileGIDAt:tileCoord];
    int x = player.position.x;
    int y = player.position.y;
    if (tileGid) {
        NSDictionary *properties = [_tileMap propertiesForGID:tileGid];
        if (properties) {
            NSString *collision = [properties valueForKey:@"Collidable"];
            if (collision && [collision compare:@"True"] == NSOrderedSame) {
                //[[SimpleAudioEngine sharedEngine] playEffect:@"hit.caf"];
                if (joyDegrees > 45 && joyDegrees < 135){

                    player.position = ccp(x,y-1);
                }
                if (joyDegrees > 135 && joyDegrees < 225){

                    player.position = ccp(x+1,y);
                }
                if (joyDegrees > 225 && joyDegrees < 315){

                    player.position = ccp(x,y+1);
                }
                if ((joyDegrees > 315 && joyDegrees < 360) || (joyDegrees > -1 && joyDegrees < 45)){
                                       player.position = ccp(x-1,y);
                }
                return;
            }
            NSString *collectable = [properties valueForKey:@"Collectable"];
            if (collectable && [collectable compare:@"True"] == NSOrderedSame) {
                [[SimpleAudioEngine sharedEngine] playEffect:@"pickup.caf"];
                [_meta removeTileAt:tileCoord];
                [_foreground removeTileAt:tileCoord];
                self.numCollected += 1;
                [_hud numCollectedChanged:_numCollected];
                playerDataManager.playerHealth -= 10;
            }
            NSString *Gate = [properties valueForKey:@"Gate"];
            if (Gate && [Gate compare:@"1"] == NSOrderedSame) {
                SaveData * SaveDataManager = [SaveData sharedSaveDataManager];
                //[SaveDataManager.padArray removeAllObjects];
                for (int i = 0; i < 20; i ++) {
                    [SaveDataManager.padArray replaceObjectAtIndex:i withObject:[NSNumber numberWithInt:0]];
                }
                [SaveDataManager.padArray replaceObjectAtIndex:1 withObject:[NSNumber numberWithInt:1]];  
                //[[CCDirector sharedDirector] replaceScene:[LogCabinMap scene]];
                [[CCDirector sharedDirector] pushScene:[LogCabinMap scene]];
            }
            if (Gate && [Gate compare:@"2"] == NSOrderedSame) {
                SaveData * SaveDataManager = [SaveData sharedSaveDataManager];
                //[SaveDataManager.padArray removeAllObjects];
                for (int i = 0; i < 20; i ++) {
                    [SaveDataManager.padArray replaceObjectAtIndex:i withObject:[NSNumber numberWithInt:0]];
                }
                [SaveDataManager.padArray replaceObjectAtIndex:1 withObject:[NSNumber numberWithInt:1]];
                //[[CCDirector sharedDirector] replaceScene:[LogShedMap scene]];
                [[CCDirector sharedDirector] pushScene:[LogShedMap scene]];
            }

        }
    }

    //[[SimpleAudioEngine sharedEngine] playEffect:@"move.caf"];
    player.position = position;
   }

-(BOOL) ccTouchBegan:(UITouch *)touch withEvent:(UIEvent *)event
{
     return YES;

}

-(void) update:(ccTime)deltaTime {
    [self setPlayerPosition:newPos];
    [self setViewpointCenter:player.position];
}

// on "dealloc" you need to release all your retained objects
- (void) dealloc
{
    // in case you have something to dealloc, do it in this method
    // in this particular example nothing needs to be released.
    // cocos2d will automatically release all the children (Label)
    self.tileMap = nil;
    self.background = nil;
    self.foreground = nil;
    self.buildings = nil;
    self.meta =nil;
    self.player = nil;
    player = nil;
    self.hud = nil;
    // don't forget to call "super dealloc"
    [super dealloc];
}
@end

@implementation HelloWorldHud
@synthesize background;
@synthesize background2;
@synthesize health;
@synthesize baseScaleFactor;

+(CCScene *) scene
{
    // 'scene' is an autorelease object.
    CCScene *scene = [CCScene node];

    // 'layer' is an autorelease object.
    HelloWorldHud *layer = [HelloWorldHud node];

    // add layer as a child to scene

    [scene addChild: layer z:2];
    HelloWorldLayer *hud = [HelloWorldLayer node];    
    [scene addChild: hud z:1];

    //layer.hud = hud;
    // return the scene
    return scene;
}

-(void)initJoystick {                         
    SneakyJoystickSkinnedBase *joystickBase = [[[SneakyJoystickSkinnedBase alloc] init]     autorelease];        
    joystickBase.backgroundSprite = [CCSprite spriteWithFile:@"JoyB.png"];                     
    joystickBase.thumbSprite = [CCSprite spriteWithFile:@"JoyS.png"]; 
    joystickBase.joystick = [[SneakyJoystick alloc] initWithRect: CGRectMake(0, 0, 128, 128)]; 
    joystickBase.position = ccp(55, 55);
    [self addChild:joystickBase];
    leftJoystick = [[joystickBase.joystick retain] autorelease];  
}

-(void) update:(ccTime)deltaTime { 
    Player *playerDataManager = [Player playerSaveDataManager];
    CGPoint scaledVelocity = ccpMult(leftJoystick.velocity, 100); 
    CGPoint newPosition = ccp(player.position.x + scaledVelocity.x * deltaTime, player.position.y + scaledVelocity.y * deltaTime); 

    if (leftJoystick.velocity.x == 0 && leftJoystick.velocity.y == 0 ){
        if (!playerDataManager.standStill) {
            [player stopAllActions];
            playerDataManager.walkUp = FALSE;
            playerDataManager.walkDown = FALSE;
            playerDataManager.walkRight = FALSE;
            playerDataManager.walkLeft = FALSE;
            playerDataManager.standStill = TRUE;
            [player runAction:playerDataManager.standAction];
        } 
    }
    if (leftJoystick.degrees > 45 && leftJoystick.degrees < 135){
        if (!playerDataManager.walkUp) {
            [player stopAllActions];
            playerDataManager.walkUp = TRUE;
            playerDataManager.walkDown = FALSE;
            playerDataManager.walkRight = FALSE;
            playerDataManager.walkLeft = FALSE;
            playerDataManager.standStill = FALSE;
            [player runAction:playerDataManager.walkUpAction];
        } 
    }
    if (leftJoystick.degrees > 135 && leftJoystick.degrees < 225){
        if (!playerDataManager.walkLeft) {
            [player stopAllActions];
            playerDataManager.walkUp = FALSE;
            playerDataManager.walkDown = FALSE;
            playerDataManager.walkRight = FALSE;
            playerDataManager.walkLeft = TRUE;
            playerDataManager.standStill = FALSE;
            [player runAction:playerDataManager.walkLeftAction];
        } 
    }
    if (leftJoystick.degrees > 225 && leftJoystick.degrees < 315){
        if (!playerDataManager.walkDown) {
            [player stopAllActions];
            playerDataManager.walkUp = FALSE;
            playerDataManager.walkDown = TRUE;
            playerDataManager.walkRight = FALSE;
            playerDataManager.walkLeft = FALSE;
            playerDataManager.standStill = FALSE;
            [player runAction:playerDataManager.walkDownAction];
        } 
    }
    if (((leftJoystick.degrees > 315 && leftJoystick.degrees < 360) &&     (leftJoystick.velocity.x != 0 && leftJoystick.velocity.y != 0 )) || ((leftJoystick.degrees > -1 && leftJoystick.degrees < 45) && (leftJoystick.velocity.x != 0 && leftJoystick.velocity.y != 0 ))){
        if (!playerDataManager.walkRight) {
            [player stopAllActions];
            playerDataManager.walkUp = FALSE;
            playerDataManager.walkDown = FALSE;
            playerDataManager.walkRight = TRUE;
            playerDataManager.walkLeft = FALSE;
            playerDataManager.standStill = FALSE;
            [player runAction:playerDataManager.walkRightAction];
        } 
    }

    float scaleFactor = playerDataManager.playerHealth/baseScaleFactor; 
    health.scaleX = playerDataManager.playerHealth/1;
    newPos = newPosition;
    joyDegrees = leftJoystick.degrees;
    if (playerDataManager.playerHealth < 100) {
       [[CCDirector sharedDirector]  replaceScene:[CCTransitionFade transitionWithDuration:3 scene: [GameLogic scene]]];
        [[CCDirector sharedDirector]  replaceScene: [GameLogic scene]];
    }
}

-(void) scroll:(ccTime)dt 
{
    //move 30*dt px vertically
    if (background.position.y<background2.position.y){
        background.position = ccp(background.contentSize.width/2, background.position.y - 225*dt);
        background2.position = ccp(background2.contentSize.width/2,     background.position.y+background.contentSize.height);
    }else{
        background2.position = ccp(background2.contentSize.width/2, background2.position.y- 225*dt);
        background.position = ccp(background.contentSize.width/2, background2.position.y+background2.contentSize.height);

    }

    //reset offscreen position
    if (background.position.y <-background.contentSize.height/2)
    {
        background.position =     ccp(background.contentSize.height/2,background2.position.y+background2.contentSize.height);
    }else if (background2.position.y < -background2.contentSize.height/2)
    {
        background2.position = ccp(background2.contentSize.height/2,     background.position.y+background.contentSize.height);
    }
}

-(id) init
{
    if ((self = [super init])) {
        CGSize size = [CCDirector sharedDirector].winSize;

        background = [CCSprite spriteWithFile:@"rain.png"];
        background2 = [CCSprite spriteWithFile:@"rain.png"];

        [background.texture setAliasTexParameters];
        [background2.texture setAliasTexParameters];

        //position background sprites
        background.position =     ccp(background.contentSize.height/2,background.contentSize.width/2);
        background2.position = ccp(size.width,0);

        //schedule to move background sprites
        //[self schedule:@selector(scroll:)];

        //adding them to the main layer

        //[self addChild:background z:-1];
        //[self addChild:background2 z:-1];

        [[CCSpriteFrameCache sharedSpriteFrameCache] addSpriteFramesWithFile:@"GUI.plist"]; 
        CCSpriteBatchNode *GUISpriteSheet = [CCSpriteBatchNode batchNodeWithFile:@"GUI.png"];
        [self addChild:GUISpriteSheet];

        CCSprite * healthBar = [CCSprite spriteWithSpriteFrameName:@"bar.png"];
        CCSprite * cap = [CCSprite spriteWithSpriteFrameName:@"cap.png"];
        CCSprite * endCap = [CCSprite spriteWithSpriteFrameName:@"endcap.png"];
        health = [CCSprite spriteWithSpriteFrameName:@"red.png"];
        healthBar.anchorPoint = ccp(0,1);
        health.anchorPoint = ccp(0,1);
        cap.anchorPoint = ccp(0,1);
        endCap.anchorPoint = ccp(0,1);
        healthBar.position = ccp(1 , size.height);
        healthBar.scaleX = 25;
        cap.position = ccp(0 , size.height);
        int width = [healthBar boundingBox].size.width;
        endCap.position = ccp(width , size.height);
        health.position = ccp(1, size.height-2);
        baseScaleFactor = width;
        health.scaleX = baseScaleFactor;
        [self addChild:healthBar];
        [self addChild:cap];
        [self addChild:endCap];
        [self addChild:health];
        CGSize winSize = [[CCDirector sharedDirector] winSize];
        label = [CCLabelTTF labelWithString:@"0" dimensions:CGSizeMake(50, 20)
                                  alignment:UITextAlignmentRight fontName:@"Verdana-Bold" 
                                   fontSize:18.0];
        label.color = ccc3(0,0,0);
        int margin = 10;
        label.position = ccp(winSize.width - (label.contentSize.width/2) 
                             - margin, label.contentSize.height/2 + margin);
        [self addChild:label];

        CCMenuItemFont * pause = [CCMenuItemFont itemFromString:@"Pause" target:self selector:@selector(pause:)];       
        CCMenu *menu = [CCMenu menuWithItems: pause, nil];
        pause.position = ccp(206,142);
        [self addChild:menu];

        CCSprite *pix = [CCSprite spriteWithFile:@"pix.png"];
        pix.position = ccp(size.width/2, size.height/2);
        //pix.scale = 50000;
    [self addChild:pix z:1];
        //[pix runAction:[CCTintTo actionWithDuration:10 red:255 green:0 blue:0]];
        //[pix runAction:[CCScaleTo actionWithDuration:15 scale:500]];

        pix.color = ccc3(255, 255, 255); 
        [self scheduleUpdate];

        [self initJoystick];

    }
    return self;
}

- (void)numCollectedChanged:(int)numCollected {
    [label setString:[NSString stringWithFormat:@"%d", numCollected]];
    // [label setString:[NSString stringWithFormat:@"%d", score]];
}

- (void) pause: (id) sender
{
    [[CCDirector sharedDirector] pushScene:[pauseM scene]];

}

- (void) dealloc
{

    self.background = nil;
    self.background2 = nil;
    self.health = nil;
    self.meta =nil;
    player = nil;

    // don't forget to call "super dealloc"
    [super dealloc];
}

@end 
```

上面是问题发生时正在运行的.m场景，下面是GameLogic.m

```
#import "GameLogic.h"
#import "Player.h"
#import "Menu.h"

@implementation GameLogic

+(id) scene
{
    CCScene *scene = [CCScene node];

    GameLogic *layer = [GameLogic node];

    [scene addChild: layer];

    return scene;
}

+(id) gameLogicSaveDataManager {
    static id gameLogicSaveDataManager = nil;
    if (gameLogicSaveDataManager == nil) {
        gameLogicSaveDataManager = [[self alloc] init];
    }
    return gameLogicSaveDataManager;
}

-(id) init
{

    if( (self=[super init] )) {
        CCSprite *bg = [CCSprite spriteWithFile:@"bg.jpg"];
        bg.anchorPoint = ccp(0,0);
        id fadeIn = [CCFadeIn actionWithDuration:3];

        [self addChild:bg];
        [bg runAction: fadeIn];   

        CCLayer *menuLayer = [[[CCLayer alloc] init] autorelease];
        [self addChild:menuLayer];
        CCMenuItemImage *home = [CCMenuItemImage
                                          itemFromNormalImage:@"bg.jpg"
                                          selectedImage:@"bg.jpg"
                                          target:self
                                          selector:@selector(home:)];
        CCMenu *menu = [CCMenu menuWithItems: home, nil];
        home.position = ccp(0,0);
        [menuLayer addChild: menu];
    }
    return self;
}

- (void) home: (id) sender
{
    [[CCDirector sharedDirector] replaceScene:[Menu scene]];

}

- (void) dealloc
{
    [super dealloc];
}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T21:44:23.070

OpenGL 错误 0x503 意味着`GL_STACK_OVERFLOW`，这意味着您将太多东西推送到 opengl 堆栈上。

`pushScene`我在您的代码中看到了几个实例，但在`pop`任何地方都没有任何实例。你不能无限期地推动东西而不弹出它们，否则你会得到这个错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T15:13:25.807

我们需要了解场景中当前运行的内容、分配方式以及释放方式。我们还需要知道新加载的场景 GameLogic 的相同信息。编辑您的问题并添加这些数据。

# c# - 通过数据库搜索 - 在 asp c# Visual Web Developer Express

> ID：11472807
> 
> 赞同：0
> 
> 时间：2012-07-13T14:45:02.783
> 
> 标签：c#, database, search, web

我想通过用户输入搜索一个特定的号码......这个 si 目前无法正常工作，但是即使我硬编码一个号码，它仍然不会接收任何内容。我不确定我做错了什么。请帮助我，这是相当紧急的。

谢谢你，文件在下面。

.cs 文件

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Data.OleDb;
using System.Data.SqlClient;

namespace SearchC
{
    public partial class _Default : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {

        }

        protected void SearchClick(object sender, EventArgs e)
        {
            string searchPAS = txtSearch.Text;
            using (var sqlconnection = new SqlConnection(Search)
            {
                string strQuery = "Select PAS_NO from P_DETAILS where PAS_NO = searchPAS";
                SqlCommand command = new SqlCommand(strQuery, sqlconnection) { CommandType = CommandType.Text };
                var ptnt = command.ExecuteScalar();
                txtPAS.Text = ptnt.ToString();
            }

        }
    }
} 
```

网络配置文件

```
<configuration>
  <connectionStrings>
    <add name="Search" connectionString="Data Source=dwh;User ID=***;Password=***;Unicode=True"
        providerName="System.Data.OracleClient" />
  </connectionStrings>

  <system.web>
    <compilation debug="true" targetFramework="4.0" />

    <authentication mode="Forms">
      <forms loginUrl="~/Account/Login.aspx" timeout="2880" />
    </authentication>

    <membership>
      <providers>
        <clear/>
        <add name="AspNetSqlMembershipProvider" type="System.Web.Security.SqlMembershipProvider" connectionStringName="ApplicationServices"
             enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="false" requiresUniqueEmail="false"
             maxInvalidPasswordAttempts="5" minRequiredPasswordLength="6" minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10"
             applicationName="/" />
      </providers>
    </membership>

    <profile>
      <providers>
        <clear/>
        <add name="AspNetSqlProfileProvider" type="System.Web.Profile.SqlProfileProvider" connectionStringName="ApplicationServices" applicationName="/"/>
      </providers>
    </profile>

    <roleManager enabled="false">
      <providers>
        <clear/>
        <add name="AspNetSqlRoleProvider" type="System.Web.Security.SqlRoleProvider" connectionStringName="ApplicationServices" applicationName="/" />
        <add name="AspNetWindowsTokenRoleProvider" type="System.Web.Security.WindowsTokenRoleProvider" applicationName="/" />
      </providers>
    </roleManager>

  </system.web>

  <system.webServer>
     <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>
</configuration> 
```

.aspx 文件

```
<%@ Page Title="Home Page" Language="C#" MasterPageFile="~/Site.master" AutoEventWireup="true"
    CodeBehind="Default.aspx.cs" Inherits="SearchC._Default" %>

<asp:Content ID="HeaderContent" runat="server" ContentPlaceHolderID="HeadContent">
</asp:Content>
<asp:Content ID="BodyContent" runat="server" ContentPlaceHolderID="MainContent">

    <table> 
            <tr> 
                <td> 
                    PAS NUmber
                </td> 
                <td> 
                     <asp:TextBox ID="txtSearch" runat="server"></asp:TextBox> 
                </td> 
            </tr> 
            <tr > 

                <td > 
                     <asp:Button runat="server" ID="btnSearch" OnClick="SearchClick" Text="Search"/> 
                </td> 
            </tr> 
             <tr > 

                <td > 
                     <asp:TextBox ID="txtPAS" runat="server"></asp:TextBox> 
                </td> 
            </tr> 
        </table>

</asp:Content> 
```

这就是我现在所拥有的......我不确定它为什么不工作，当我按下按钮时它只是闪烁，没有其他反应

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:49:59.917

您正在搜索字符串`searchPAS`而不是变量包含的内容。像这样更改您的查询以使用参数：

```
string strQuery = "Select PAS_NO from P_DETAILS where PAS_NO = @searchPAS";
SqlCommand command = new SqlCommand(strQuery, sqlconnection) { CommandType = CommandType.Text };
command.Parameters.AddWithValue("searchPAS", searchPAS);
var ptnt = command.ExecuteScalar();
txtPAS.Text = ptnt.ToString(); 
```

# video - 使用 mediaelementjs 删除 youtube 品牌徽标

> ID：11472808
> 
> 赞同：3
> 
> 时间：2012-07-13T14:45:05.060
> 
> 标签：video, youtube, mediaelement.js

我正在为视频使用 mediaelement.js 库，以在浏览器和设备之间提供相似的外观和感觉。mediaelement.js 有一个 youtube 包装器，它允许我们使用托管在 youtube 上的视频。当我用它来显示视频时，我看到 youtube 视频上有一个“youtube”标志。我尝试将moderatebranding=1 附加到url。当我向 src url 添加任何参数时，视频不会播放。是否有任何解决方案可以删除 youtube 品牌标识？

```
<video style="width:100%;height:100%" id="player1" preload="none">

<source type="video/youtube" src="http://www.youtube.com/watch?v=nOEw9iiopwI" >

</video>

<script>
    // declare object for video 

    var player = new MediaElementPlayer('#player1',{ features: ['playpause','progress','current','duration','tracks','volume'] }); 
</script> 
```

# python - 如何在 install_requires 中指定版本范围（setuptools、distribute）

> ID：11472810
> 
> 赞同：60
> 
> 时间：2012-07-13T14:45:09.987
> 
> 标签：python, setuptools

我想制作一个依赖于特定版本范围的包，例如`>= 0.5.0, < 0.7.0`. 是否可以`install_requires`选择，如果可以，应该怎么做？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-07-15T20:44:51.383

根据[文档](http://setuptools.readthedocs.io/en/latest/setuptools.html#declaring-dependencies)，您的语法应该可以正常工作。该文件指出：

> `setuptools`并`pkg_resources`使用通用语法来指定项目所需的依赖项。此语法由项目的 PyPI 名称组成，可选地后跟以逗号分隔的方括号中的“附加”列表，可选地后跟以逗号分隔的版本说明符列表。版本说明符是运算符 <、>、<=、>=、== 或 != 之一，后跟版本标识符。

该文档提供了一个简单的示例，如下所示：

```
docutils >= 0.3

# comment lines and \ continuations are allowed in requirement strings
BazSpam ==1.1, ==1.2, ==1.3, ==1.4, ==1.5, \
    ==1.6, ==1.7  # and so are line-end comments 
```

为了进一步扩展，如果你希望你的包需要一个`docutils`高于 0.3 但低于 0.5 的版本，这样的代码可以工作：

```
docutils >= 0.3, <=0.5 
```

两个附加说明。

1.  该文档还指出，冗余/重叠的依赖规范将在内部组合，因此`docutils >= 0.3, >=0.2`将组合成`docutils >= 0.3`.
2.  此外，请注意指定冲突的版本号，这[“没有意义，因此可能会产生奇怪的结果”。](http://peak.telecommunity.com/DevCenter/setuptools#declaring-dependencies)例如，我不知道你为什么会这样做，但不要使用这个：`docutils >= 0.3, <=0.2`因为这是不可能的。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-01-18T18:27:31.500

警惕非自愿的 Beta 测试。包维护者有时会在没有警告的情况下向普通受众发布不兼容、不完整或损坏的 a、b 和 c 版本。下次你在新的 virtualenv 中运行**setup.py**时，你可能会拉下其中一个毒鸡蛋，然后你的程序就会突然中断。

为了降低这种风险，*不要使用*样式`foo >=0.3, <0.4`声明，它具有纯数字上限。`<0.4`仍然承认版本 0.4a0、0.4a1、0.4b0、0.4c3 等。相反，当您编写 install_requires 时，请使用`<0.4a0`类似`foo >=0.3, <0.4a0`的**上限**。

当**setuptools**做了一些意想不到的事情时，尝试使用**verlib**来模拟你的版本比较。只要您的版本标准化且不矛盾，Verlib 就非常适合。这是一个示例，演示了规范化版本可能违反直觉的排序：

```
#!/usr/bin/env python

from verlib import NormalizedVersion as V

assert (V("0.7.9") < V("0.8a0") < V("0.8a1") < V("0.8b0") < V("0.8b1")
    < V("0.8b2") < V("0.8.0") < V("0.8.1a0") < V("0.8.1") < V("0.9")
    < V("1.0a3") < V("1.0b2") < V("1.0b20") < V("1.0c0") < V("1.0")
    < V("1.0.1"))

assert (V("0.7.9") < V("0.8.0a0") < V("0.8.0a1") < V("0.8.0b0")
    < V("0.8.0b1") < V("0.8.0b2") < V("0.8.0") < V("0.8.1a0") < V("0.8.1")
    < V("0.9") < V("1.0a3") < V("1.0b2") < V("1.0b20") < V("1.0c0")
    < V("1.0") < V("1.0.1"))

print "Version comparisons are sane." 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-05-14T22:30:34.690

OP 的问题中提到的符号`>= 0.5.0, < 0.7.0`, 已经有效。

而且，由于许多（如果不是大多数）库已经使用[语义版本控制](https://semver.org/)，因此根据定义，您可以将依赖项定义为`A>=1,<2`，如此[处所述](https://packaging.python.org/discussions/install-requires-vs-requirements/#install-requires)。他们甚至[为它实现了一个更简单的语法，这`A~=X.Y`](https://packaging.python.org/guides/distributing-packages-using-setuptools/#semantic-versioning-preferred)意味着它至少需要发布 XY，但也允许任何具有匹配 MAJOR 版本的更高版本。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-04-16T13:08:22.533

另一种方法是使用通配符。

这不适用于 >= 0.5.0, < 0.7.0，但如果您决定应该支持所有维护版本（例如 0.5.0 到 0.5.x），您可以使用

== 0.5.*

例如 docutils == 0.3.*

# c# - 如何解决上下文中不存在的响应/服务器？

> ID：11472811
> 
> 赞同：0
> 
> 时间：2012-07-13T14:45:16.663
> 
> 标签：c#, asp.net

我有这个 C# ASP.NET 4 网站。

我想在一个类中有一个通用方法，其中包含一个 Response.Redirect 或 Server.Transfer 到特定页面。

上下文中不存在 Response 和 Server 这两个名称。

如何解决这个问题？

* * *

至于@Maess 的评论，请考虑这样的事情（已编辑）：

**ASPX：**

```
<asp:Button onclick="MyClass.btnRedirect_Click" ID="btnMyButton" Text="MyButtonText" runat="server" /> 
```

**后面的代码：**

```
public static void btnRedirect_Click(object sender, EventArgs e)
{
    Response.Redirect("~/SomePage.aspx");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:52:22.987

You'll find these as properties within `HttpContext.Current`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T15:10:49.577

如果要在 HTTP/IIS 堆栈之外被调用，请不要直接引用任何涉及 HTTP/IIS 堆栈的内容。

您最好的选择可能是让您的类或方法接受委托或实现调用代码提供的接口的对象。当您准备好重定向时，使用 URI（或构建它的足够信息）调用该委托/接口方法，然后调用代码可以使用 server.transfer、response.redirect 或通过的单元测试进行响应。

```
public static void ButtonRedirect()
{
    MyClass foo = new MyClass(delegate(string s) { Server.Transfer(s); });
    foo.DoThings();
}

public class MyClass
{
    private Action<string> redirector;

    public MyClass(Action<string> redirectAction)
    {
        redirector = redirectAction;
    }

    public void DoThings()
    {
        //Doing stuff
        //Aha! this should redirect
        redirector("/go/to/here");
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T14:56:33.270

你可以使用`System.Web.HttpContext.Current`，但要小心。如果在调用这些方法时没有 HTTP 上下文，您将收到异常。

让这些类在构造函数中需要 HttpContext 或者在方法签名中拥有需要 HttpContext 的方法可能更安全。

例如，也许您有一个需要重定向的类，如您所提到的。您的方法签名可能如下所示：`public void CustomRedirect(HttpContext context)`然后在您的签名正文中，您将执行以下操作`context.Response.Redirect("...")`：基本上，您使类或方法依赖于具有 HttpContext。

# java - 将整个页面提取为图像 iTextPdf

> ID：11472812
> 
> 赞同：2
> 
> 时间：2012-07-13T14:45:23.437
> 
> 标签：java, pdf, itextsharp, itext

是否可以从现有的 pdf 文件中提取页面并通过 iTextPDF 库将整个页面保存为图像。

例如，如果我的 pdf 文件包含 2 页，则将生成 2 张图像，每张图像将是特定页面的快照。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T20:12:43.327

我使用了 PDF-Renderer 和 jpedal api，但是这些 api 生成的图像分辨率很差。

但我最终通过[PDFBox API](http://pdfbox.apache.org)实现了这一点。这个api还可以设置图像的分辨率。

# jquery - 用于 BB 的带有 jquery 和 jquerymobile 的 Phonegap

> ID：11472813
> 
> 赞同：1
> 
> 时间：2012-07-13T14:45:27.897
> 
> 标签：jquery, html, jquery-mobile, blackberry-webworks

我正在为 BlackBerry webworks、PhoneGap 1.9.、Jquery 和 jquery mobile 开发。PhoneGap 提供的示例在模拟器上运行良好，直到它包含应用程序停止响应的 jQuery 库。

添加代码以了解情况。有人可以使用相同的技术吗？

1)

```
<!DOCTYPE HTML>
<html>
<head>
<title>Prueba</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="css/jquery.mobile.structure-1.1.0.min.css" />
<script type="text/javascript" src="js/json2.js"></script>
<script type="text/javascript" src="js/cordova-1.9.0.js"></script>
<script type="text/javascript" src="js/jquery-1.7.1.min.js"></script>
<script type="text/javascript" src="js/jquery.mobile-1.1.0.min.js"></script>
</head>
<body>

<h3>Hello!</h3>
</body>
</html> 
```

=> 结果：崩溃

2) 在这篇文章中使用 jQuery 版本 1.6.4 (http://bugs.jquery.com/ticket/10608)

```
<!DOCTYPE HTML>
<html>
<head>
<title>Prueba</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="css/jquery.mobile.structure-1.1.0.min.css" />
<script type="text/javascript" src="js/json2.js"></script>
<script type="text/javascript" src="js/cordova-1.9.0.js"></script>
<script type="text/javascript" src="js/jquery-1.6.4.min.js"></script>
<script type="text/javascript" src="js/jquery.mobile-1.1.0.min.js"></script>
</head>
<body>

<h3>Hello!</h3>
</body>
</html> 
```

=> 结果：崩溃

3）没有jquery mobile

```
<!DOCTYPE HTML>
<html>
<head>
<title>Prueba</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="css/jquery.mobile.structure-1.1.0.min.css" />
<script type="text/javascript" src="js/json2.js"></script>
<script type="text/javascript" src="js/cordova-1.9.0.js"></script>
<script type="text/javascript" src="js/jquery-1.7.1.min.js"></script>
</head>
<body>

<h3>Hello!</h3>
</body>
</html> 
```

=> 结果：崩溃

4）没有jquery mobile

```
<!DOCTYPE HTML>
<html>
<head>
<title>Prueba</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="css/jquery.mobile.structure-1.1.0.min.css" />
<script type="text/javascript" src="js/json2.js"></script>
<script type="text/javascript" src="js/cordova-1.9.0.js"></script>
<script type="text/javascript" src="js/jquery-1.6.4.min.js"></script>
</head>
<body>

<h3>Hello!</h3>
</body>
</html> 
```

=> 结果：有效！

但我需要jquery mobile。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-15T20:35:23.870

问题不在于 jquery 移动文件（除非下载损坏），因为我在多个 Blackberry 项目中一直使用相同版本的 jquery。

考虑检查 cordova-1.9 和 json2.js 与 PhoneGap 1.9 和 Blackberry 的兼容性。

当然，在为 Blackberry 开发时只使用 WebWorks SDK 要简单得多，因为您可以使用更简单的方法来处理 Blackberry 的特性（并且在以后移植到其他平台时，您总是可以去掉 Blackberry 的部分）。看看：[https](https://developer.blackberry.com/html5/) ://developer.blackberry.com/html5/ （有很多有用的示例）

# regex - 如何忽略前面的管道符号？

> ID：11472815
> 
> 赞同：-2
> 
> 时间：2012-07-13T14:45:34.793
> 
> 标签：regex, bash, shell, awk, grep

如何在正则表达式中忽略行首的正斜杠和空格？

在下面的示例中，我需要忽略管道和空格，因为我使用的是 grep 和 awk

实际的命令给了我

命令

```
size=5.0G features='0' hwhandler='0' wp=rw
|-+- policy='round-robin 0' prio=1 status=active
| `- 3:0:0:3   sdh  8:112   active ready running    #Line 3
`-+- policy='round-robin 0' prio=1 status=enabled
  `- 4:0:0:3   sdl  8:176   active ready running    #Line 5 
```

通过做这个：

```
cmd | grep -E '[0-9]+:[0-9]+:[0-9]+:[0-9]+' | awk '{print $3}' 
```

我能够得到sdh，sdl。但问题是，我需要忽略“|” 预先，使第 3 行和第 5 行相同。请指教。

编辑 1 我需要获取两个信息

1) 编号

```
3:0:0:3
4:0:0:3 
```

2) 磁盘名称

```
sdh
sdl 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:51:30.627

不要试图让你的两行中的每一行都具有相同数量的字段，只需使用`-o`grep 选项来仅匹配你的正则表达式的部分行。然后你根本不需要这个`awk`命令。

```
cmd | grep -o -E '[0-9]+:[0-9]+:[0-9]+:[0-9]+' 
```

由于您实际上需要的不仅仅是原始问题中的内容：

```
cmd | grep -E '[0-9]+:[0-9]+:[0-9]+:[0-9]+' | sed 's/^| //' | awk '{print $2, $3}' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T15:24:10.367

做这一切`awk`：

```
gawk --re-interval '/[0-9:]{4}/ { sub("\\|", ""); print $2, $3 }' 
```

有关更精确的正则表达式，请参阅下面的 @CodeGnome 版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T15:23:52.137

您可能应该调整您的命令以减少正则表达式匹配器的麻烦。但是，您当然可以使用与 Perl 兼容的正则表达式来做到这一点。例如：

```
$ pcregrep -o '((\d:){3}\d)\s+\S+' << 'EOF'
size=5.0G features='0' hwhandler='0' wp=rw
|-+- policy='round-robin 0' prio=1 status=active
| `- 3:0:0:3   sdh  8:112   active ready running    #Line 3
`-+- policy='round-robin 0' prio=1 status=enabled
  `- 4:0:0:3   sdl  8:176   active ready running    #Line 5
EOF

3:0:0:3   sdh
4:0:0:3   sdl 
```

然后，您可以使用 IFS、awk 或其他一些机制拆分这两个字段，然后再将其提供给脚本的下一步。

# css - SVG 特定的 CSS 未在 Firefox 中加载

> ID：11472816
> 
> 赞同：0
> 
> 时间：2012-07-13T14:45:37.163
> 
> 标签：css, firefox, svg

我在我的 SVG 中使用以下 CSS：

```
line{
    stroke-linecap:round;
    stroke-width:4;
    stroke:url(#disabled); 
    fill:url(#disabled);
} 
```

在 Chrome 和 IE 中，这工作正常。但是，Firefox 不接受`stroke:url(#disabled);`and `fill:url(#disabled);`。所以这些元素是黑色的。我认为这`#`可能是导致它的原因（FF 过去曾遇到过[这个问题）](https://bugzilla.mozilla.org/show_bug.cgi?id=658949)。我能做些什么来解决这个问题？我已经尝试转义`#`以及将其替换为`&#35;`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T15:27:18.143

事实证明，这`#`是一条红鲱鱼。（这就是为什么转义它并没有改变任何东西的原因。）Firefox 试图`#disabled`相对于 CSS 文件而不是 SVG 文件进行定位。我通过完全跳过 CSS 类并使用 JavaScript 内联编辑 CSS 来解决它。

# javascript - 使用 javascript 引用表单元素

> ID：11472817
> 
> 赞同：0
> 
> 时间：2012-07-13T14:45:44.070
> 
> 标签：javascript, html

我不明白为什么我的 javascript 不起作用......虽然一切看起来都很好......

```
<form id = "lol" method="get" name="lol" action="" style="display:inline; vertical-align:middle">
    <table style="display:inline; vertical-align:middle">
        <tr>
            <td style="width:80%">
                xxx
            </td>
            <td>
                <select name="A">
                    <option value="xxx">xxx</option>
                    <option value="xxx">xxx</option>
                    <option value="xxx">xxx</option>
                </select>
            </td>
            <td>
                <input type="submit" value="Valider"/>
                <input type="hidden" name="B" value=""/>
                <input type="hidden" name="C" value=""/>
            </td>
        </tr>
    </table>
</form> 
```

还有我的 javascript：

```
<script>
var form=document.getElementById("lol");
form.elements['A'].value="xxx";
</script> 
```

找到了表单，但没有找到元素 A...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:51:35.760

您需要确保您的 JavaScript 代码在创建相关的 DOM 元素**后运行。**如果你这样做了，你的代码就可以工作。

您可以确保通过

1.  将代码放在文档中的元素之后（如下所示），或

2.  使用`load`或`ready`风格的事件。

[活生生的例子](http://jsbin.com/ofimon)

```
<form id = "lol" method="get" name="lol" action="" style="display:inline; vertical-align:middle">
  <table style="display:inline; vertical-align:middle">
      <tr>
          <td style="width:80%">
              xxx
          </td>
          <td>
              <select name="A">
                  <option value="xxx">xxx</option>
                  <option value="xxx">xxx</option>
                  <option value="xxx">xxx</option>
              </select>
          </td>
          <td>
              <input type="submit" value="Valider"/>
              <input type="hidden" name="B" value=""/>
              <input type="hidden" name="C" value=""/>
          </td>
      </tr>
  </table>
</form>
<script>
  var form=document.getElementById("lol");
  form.elements['A'].value="xxx";
</script> 
```

# php - 使用 $_POST 和 $_GET 变量的 PHP 最佳实践

> ID：11472818
> 
> 赞同：2
> 
> 时间：2012-07-13T14:45:45.083
> 
> 标签：php, postgresql, optimization

考虑到一个项目将由多个开发人员工作并且将不断更新和维护，考虑到可读性和安全性，以下两个代码中的哪一个可以被认为是 PHP 的最佳实践？如果我们从性能上讲，[第二个选项可能会好一点](https://developers.google.com/speed/articles/optimizing-php)，但是有一些方法可以解决这一点。

**选项1**

```
$user = $_POST['user'];
$pass = $_POST['pass'];

// Prevent SQL Injection and XSS
$user = anti_injection($user);
$pass = anti_injection($pass);

if(strlen($user) <= 8 && strlen($pass) <= 12)
{
    // SQL query
    $sql = "SELECT id 
            FROM users 
            WHERE username = '$user' AND password = '$pass';";
} 
```

**选项 2**

```
// Retrieve POST variables and prevent SQL Injection and XSS
$_POST['user'] = anti_injection($_POST['user']);
$_POST['pass'] = anti_injection($_POST['pass']);

if(strlen($_POST['user']) <= 8 && strlen($_POST['pass']) <= 12)
{
    // SQL query
    $sql = "SELECT id 
            FROM users 
            WHERE username = '" . $_POST['user']. "' AND password = '" . $_POST['pass'] . "';";
} 
```

**编辑 1**

我没有使用 MySQL，我的数据库是 PostgreSQL

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-13T14:51:53.993

# 也不要这样做。

我只能假设`anti_injection`是某种自定义过滤功能，这是一个 Bad Idea™。如果你*真的*想采用这些想法中的任何一个，你应该使用`mysql_real_escape_string`.

编写 SQL 查询时保持安全的**唯一方法是使用参数，例如通过 MySQLi。**无论如何，这些`mysql_*`功能已被弃用，因此您最好尽快迁移。

实际上`mysql_real_escape_string`并不是对注入攻击的万无一失的防御。考虑查询中的整数比较，例如`WHERE $var > 30`. 我可以成功注入`1=1 or 100`，`$var`并完全打破逻辑。

参数将数据与查询语言完全分离，完全降低了注入风险。服务器接收包含参数表示法的查询和要插入的一组值，因此它可以完全不同地处理查询语言和数据。

此外，您似乎以明文形式存储密码。[这是](http://www.telegraph.co.uk/technology/internet-security/9395475/Yahoo-hackers-leak-half-a-million-passwords.html) [个坏](http://www.zdnet.com/over-21000-plain-text-passwords-stolen-from-billabong-7000000842/) [主意。](http://thehackernews.com/2011/06/sony-pictures-hacked-and-database.html)您应该研究一种强大的密码存储哈希算法，例如 bcrypt，这使得从哈希中获取明文密码变得非常困难。

MD5 和 SHA1 不是密码存储的理想选择，因为它们的设计速度很快，这意味着攻击者甚至可以快速破解强加盐密码。现代 GPU 每秒可以实现 50 亿次 MD5 哈希。事实上，有人拥有专门的哈希破解设备，其中一些可以以[每秒 450 亿哈希的速度](http://3.14.by/forum/viewtopic.php?f=8&t=1371)破解 MD5 。

您还应该看看这些很棒的问题，它们完全涵盖了 SQL 注入攻击、密码存储和许多其他安全问题：

*   [基于表单的网站身份验证权威指南](https://stackoverflow.com/questions/549/the-definitive-guide-to-forms-based-website-authentication)
*   [如何防止 PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/best-way-to-stop-sql-injection-in-php)
*   [PHP 密码的安全哈希和盐](https://stackoverflow.com/questions/401656/secure-hash-and-salt-for-php-passwords)

**更新：**您提到您正在使用 postgres。您可以使用[PDO](http://php.net/manual/en/book.pdo.php)从 PHP 运行参数化查询，如此处[简要描述的](https://stackoverflow.com/questions/8011811/postgresql-lacking-support-for-parameterizd-queries)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-13T14:49:49.923

**这些选项都不是最佳实践**`anti_injection`，即使只是对于几乎可以肯定不会像宣传的那样工作的可疑人员。还有以下问题：

*   在验证之前修改您的输入数据
*   存储明文密码
*   手动构造 SQL 查询，而不是使用绑定参数

根据项目的范围，最后一个可能是可以接受的。

关于性能，第一个选项理论上会更快，因为它执行的数组索引更少。但是差异肯定会很小，以至于根本无法观察到。第一个选项也更具可读性并提供更好的抽象，所有这些都只需要可忽略不计的额外内存量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-13T14:49:54.480

两者都是错误的。您似乎将密码存储为纯文本，这只是自找麻烦。

另外，如果我的用户名是`"123456"`，我将无法登录，因为您会将其转义到`\"123456\"`“长度 <= 8”检查失败。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-13T14:51:09.533

如果您想要安全性和性能，我建议您使用 PDO。使用参数时不能进行 sql 注入。下面是一个示例，您需要“定义”mysql 参数才能使下面的工作。

这也允许数据库缓存您的查询，因为每次使用不同的参数执行时它都不会改变，这也会提高性能。

```
:p_user and :p_pass 
```

用于表示参数和

```
array ( ':p_user' => $user, ':p_pass' => $pass ' ) 
```

将参数设置为您需要传入的值。

您还应该考虑添加密码盐，并将该密码的 sha1 存储在数据库中，这样如果您的数据库遭到破坏，您的密码就不会清楚地暴露给黑客。

```
class users{ 
  function __construct() {
    define('MySQLHost', 'localhost');
    define('MySQLName', 'databasename');
    define('MySQLUser', 'username');
    define('MySQLPass', 'password');
    define('pwsalt', 'tScgpBOoRL7A48TzpBGUgpKINc69B4Ylpvc5Xc6k'); //random characters
  }

  static function GetQuery($query, $params)
  {
    $db = new PDO('pgsql:host='.MySQLHost.';dbname='.MySQLName.';', MySQLUser, MySQLPass);
    $cmd = $db->prepare($query);
    $cmd->execute($params);

    if($cmd->rowCount()==0)
      return null;
    return $cmd->fetchAll();
  }

  static function GetUser($user, $pass)
  {
    $query = "select id
      from `users`
      where username = :p_user and password = :p_pass";

    $rows = users::GetQuery($query, array(
      ':p_user' => $user,
      ':p_pass' => sha1($pass.pwsalt) //Append the salt to the password, hash it
    ));

    return $rows;
  }
}

$user = $_POST['user'];
$pass = $_POST['pass'];
if( strlen($user) <= 8 && strlen($pass) <= 12 )
{
  $result = users::GetUser($user, $pass);
  if($result != null)
    print 'Login Found';
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-13T16:11:14.603

虽然我同意其他海报，但不要试图“重新发明轮子”关于 SQL 安全性，问题似乎是关于性能以及如何使用超全局变量。

作为最佳实践，不要改变超全局变量（$_GET、$_POST、$_REQUEST、$_SYSTEM 等）。我想不出一个违反此规则会提高性能的示例，并且任何修改都会导致不确定性和路上的混乱。

所以在这种情况下，这两个选项都不正确。Option1 不必要地复制一个变量（根据 Google 性能文档，这是一个禁忌）。选项 2 改变了超全局变量，这违反了上面的准则。相反，请执行以下操作：

```
$user = anti_injection( $_POST['user'] );
$pass = anti_injection( $_POST['pass'] );

if( strlen($user) <= 8 && strlen($pass) <= 12 ) ... 
```

但是我要重申，“自制卫生”是一个可怕的前景，其他评论员已经对这一点进行了相当详尽的阐述。

# vb.net - HttpRequest.ServerVariables vs HttpRequest.UserAgent 属性 VB.net

> ID：11472820
> 
> 赞同：5
> 
> 时间：2012-07-13T14:45:49.737
> 
> 标签：vb.net, httprequest, user-agent

用于确定用户代理的这两个属性之间有什么区别（如果有的话）和优点/缺点？

```
Dim strUserAgt as String
userAgent = Request.userAgent 
```

对比

```
Dim strUserAgt as String = Request.ServerVariables("HTTP_USER_AGENT") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T14:50:59.680

来源：[如何在没有 ASP.NET 中的 BrowserType 对象的情况下确定服务器端代码中的浏览器类型](http://support.microsoft.com/kb/306576)

> 在 ASP.NET 中，您可以访问 Request.ServerVariables 集合或使用新的 Request.UserAgent 属性来检索 HTTP_USER_AGENT 标头值。

没有区别，两者都会检索相同的东西`HTTP_USER_AGENT header value`。

如果您想深入了解它，请检查[Request.ServerVariables Collection](http://msdn.microsoft.com/en-us/library/ms525396%28v=VS.90%29.aspx)和[IIS Server Variables 。](http://msdn.microsoft.com/en-us/library/ms524602%28v=vs.90%29.aspx)这些服务器变量集合值在某种程度上也取决于 IIS 版本。

# nuget - TFS 自动化构建 + nuget 包还原 + 不同解决方案中的共享项目

> ID：11472824
> 
> 赞同：0
> 
> 时间：2012-07-13T14:46:11.657
> 
> 标签：nuget

我有一个解决方案，其中包含具有 nuget 包还原的共享项目。我有第二个解决方案，它引用了第一个解决方案中的项目。

我正在尝试设置 TFS 来构建第二个解决方案，但它在共享解决方案中找不到项目的引用，因为第一个解决方案的包文件夹与第二个解决方案的位置不同。我已经在构建中包含了第一个解决方案，但现在该解决方案中不存在构建配置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:23:39.780

*首先，听起来好像共享项目可以自己打包，因此可以在这两个解决方案之间共享。*

但是，如果您真的不想这样做，您可以尝试使用以下 NuGet 命令行参数并调整 nuget.targets 文件，使它们都指向同一个包安装目录。（注意：您还必须手动更新项目引用以指向新的包位置）

> nuget.exe 安装**-o "d:\some\dir"**

您可以简单地修改 nuget.targets 文件中的元素，或者使用您自己的自定义值将此元素添加到 csproj 文件的 PropertyGroup 中。

> <属性组>
> 
> <PackageOutputDir>d:\some\dir</PackageOutputDir>
> 
> </属性组>

最后一点：客户端开发机器上的输出位置路径必须与 TFS 构建代理上的相同，否则它将不起作用。

# android - 如何在android的中心对齐标签文本

> ID：11472826
> 
> 赞同：2
> 
> 时间：2012-07-13T14:46:21.020
> 
> 标签：android

谁能告诉我如何在android的中心对齐标签文本？我已经放弃 `android:gravity="center"`了`LinearLayout`和`TabWidget`。它仍然无法正常工作。谁能告诉我该怎么做？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-16T11:09:33.473

用这个

```
 int tabCount = tabHost.getTabWidget().getTabCount();
     for (int i = 0; i < tabCount; i++) {
   final View view = tabHost.getTabWidget().getChildTabViewAt(i);
    if ( view != null ) {
    // reduce height of the tab
    view.getLayoutParams().height *= 0.66;

    //  get title text view
    final View textView = view.findViewById(android.R.id.title);
    if ( textView instanceof TextView ) {
        // just in case check the type

        // center text
        ((TextView) textView).setGravity(Gravity.CENTER);
        // wrap text
        ((TextView) textView).setSingleLine(false);

        // explicitly set layout parameters
        textView.getLayoutParams().height = ViewGroup.LayoutParams.FILL_PARENT;
        textView.getLayoutParams().width = ViewGroup.LayoutParams.WRAP_CONTENT;
    }
} 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T14:59:31.490

利用`android:layout_gravity="center"`

# android - Android TCP 智能手机到带有 USB 没有 wifi 的 PC

> ID：11472828
> 
> 赞同：2
> 
> 时间：2012-07-13T14:46:22.960
> 
> 标签：android

嗨，我已经管理了一些代码，但它不起作用

我想通过我的应用程序通过 USB 而不是通过**WIFI控制从 PC 向 Android 发送消息**

我试过这段代码

但这给了我错误

```
07-13 20:08:28.530: W/System.err(8990): java.net.ConnectException: localhost/127.0.0.1:383 - Connection refused 
```

我已经通过***adb完成了端口转发***

台式机

```
 import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.io.IOException;
import java.net.ServerSocket;
import java.net.Socket;

public class comunicate {

 public static void main(String[] args){
  ServerSocket serverSocket = null;
  Socket socket = null;
  DataInputStream dataInputStream = null;
  DataOutputStream dataOutputStream = null;

  try {
   serverSocket = new ServerSocket(383);
   System.out.println("Listening :8888");
  } catch (IOException e) {
   // TODO Auto-generated catch block
   e.printStackTrace();
  }

  while(true){
   try {
    socket = serverSocket.accept();
    dataInputStream = new DataInputStream(socket.getInputStream());
    dataOutputStream = new DataOutputStream(socket.getOutputStream());
    System.out.println("ip: " + socket.getInetAddress());
    System.out.println("message: " + dataInputStream.readUTF());
    dataOutputStream.writeUTF("Hello!");
   } catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
   }
   finally{
    if( socket!= null){
     try {
      socket.close();
     } catch (IOException e) {
      // TODO Auto-generated catch block
      e.printStackTrace();
     }
    }

    if( dataInputStream!= null){
     try {
      dataInputStream.close();
     } catch (IOException e) {
      // TODO Auto-generated catch block
      e.printStackTrace();
     }
    }

    if( dataOutputStream!= null){
     try {
      dataOutputStream.close();
     } catch (IOException e) {
      // TODO Auto-generated catch block
      e.printStackTrace();
     }
    }
   }
  }
 }
} 
```

手机版

```
package demo.app.org;

import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.io.IOException;
import java.net.Socket;
import java.net.UnknownHostException;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

public class DemoAppActivity extends Activity {

EditText textOut;
TextView textIn;

 /** Called when the activity is first created. */
 @Override
 public void onCreate(Bundle savedInstanceState) {
     super.onCreate(savedInstanceState);
     setContentView(R.layout.main);

     textOut = (EditText)findViewById(R.id.textout);
     Button buttonSend = (Button)findViewById(R.id.send);
     textIn = (TextView)findViewById(R.id.textin);
     buttonSend.setOnClickListener(buttonSendOnClickListener);
 }

 Button.OnClickListener buttonSendOnClickListener
 = new Button.OnClickListener(){

@Override
public void onClick(View arg0) {
 // TODO Auto-generated method stub
 Socket socket = null;
 DataOutputStream dataOutputStream = null;
 DataInputStream dataInputStream = null;

 try {
  socket = new Socket("localhost", 383);
  dataOutputStream = new DataOutputStream(socket.getOutputStream());
  dataInputStream = new DataInputStream(socket.getInputStream());
  dataOutputStream.writeUTF(textOut.getText().toString());
  textIn.setText(dataInputStream.readUTF());
 } catch (UnknownHostException e) {
  // TODO Auto-generated catch block
  e.printStackTrace();
 } catch (IOException e) {
  // TODO Auto-generated catch block
  e.printStackTrace();
 }
 finally{
  if (socket != null){
   try {
    socket.close();
   } catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
   }
  }

  if (dataOutputStream != null){
   try {
    dataOutputStream.close();
   } catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
   }
  }

  if (dataInputStream != null){
   try {
    dataInputStream.close();
   } catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
   }
  }
 }
}};
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:50:04.827

这不是通过wifi进行tcp通信的代码吗？我认为除了 logcat 之外，您无法通过 USB 与 android 进行通信。

# php - 在 RPC AMQP 调用后的某处调用 die() 或 exit() 后 HTTP 连接重置

> ID：11472831
> 
> 赞同：0
> 
> 时间：2012-07-13T14:46:33.283
> 
> 标签：php, rabbitmq, amqp

我有某种与数据库一起使用的内部 API，我正在通过 AMQP 调用该 API。当我进行同步（RPC）调用并尝试重定向之后，HTTP 连接会重置。我这样重定向：

header("位置：some_url"); 死;

我发现问题出在 die() 函数中。所以我使用 PHP5.3、Apache2、RabbitMQ 作为 AMQP 代理。我也在使用这个扩展[http://pecl.php.net/package/amqp](http://pecl.php.net/package/amqp)来使用 AMQP。这非常令人困惑，因为如果我删除 die() 连接一切正常。但是不可能删除它，因为[PHP: Utilizing exit(); 或者死（）; 在标头之后（“位置：”）；](https://stackoverflow.com/questions/8665985/php-utilizing-exit-or-die-after-headerlocation)

如果有人能给我线索，我将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T16:33:24.680

尝试调用[`flush()`](http://php.net/manual/en/function.flush.php)之前`die()`。

# c# - 如何更改 SQL 连接字符串数据源？

> ID：11472834
> 
> 赞同：1
> 
> 时间：2012-07-13T14:46:36.990
> 
> 标签：c#, sql, visual-studio-2010

我是 C# 和 SQL Server 的初学者。目前我正在开发一个程序，问题是我的数据库文件位于项目文件夹内的 DB 文件夹中。当我尝试在 SQL Server Management Studio 中分离数据库文件时，会出现错误：

```
"Data Source=localhost;Initial Catalog=test;Integrated Security=true" 
```

当我将数据源更改为此

```
"Data Source=db/test.mdf;Initial Catalog=test;Integrated Security=true" 
```

它给出了一个错误。我不知道如何将带有项目的数据库文件插入到 InstallShield 以创建安装文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:51:53.137

您可以使用 DATA-> 新数据源对话框设置连接。在那里，您将直观地设置所有参数。我认为这里的问题是未指定完整路径。路径也应该用引号引起来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T19:33:15.880

此外，每当您需要有关任何数据库的连接字符串的帮助时，[http://www.connectionstrings.com/](http://www.connectionstrings.com/)都是一个很好的参考。

# html - thead、tbody 和 tfoot 背景图像未在 chrome 中显示

> ID：11472836
> 
> 赞同：2
> 
> 时间：2012-07-13T14:46:40.737
> 
> 标签：html, css

```
table 
{
    margin: 0 auto;
    border-collapse: collapse;
}

thead 
{
    background: url('../images/theadimage.png') 365px bottom no-repeat;
}

tbody 
{
    background: url('../images/tbodyimage.png') 365px top repeat-y;
}

tfoot 
{
    background: url('../images/tfootimage1.png') 365px top no-repeat, url('../images/tfootimage2.png') 0px -8px repeat-x;
} 
```

这是在除 chrome 之外的所有浏览器中正确显示图像（奇怪）。如果我将 tbody 更改为 repeat-x，我会看到图像，但是当设置为 no-repeat 或 repeat-y 时，背景图像会完全消失。

我在这里想念什么？chrome有解决方案或解决方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-22T17:55:49.137

经过更多搜索后，我发现这是[Chrome 中的一个已知问题，](http://code.google.com/p/chromium/issues/detail?id=35697)对我有用并且在所有其他浏览器中仍然保持正确渲染的解决方法是将`td`元素渲染`th`为内联块，将`tr`元素渲染为块。将以下 CSS 添加到原始问题中提到的 CSS 是对我有用的解决方案。

```
table.problemTable tr {
    display: block;
}
table.problemTable td, table.problemTable th {
    display: inline-block;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T06:50:36.470

这是一个解决方案，您需要在 tfoot tr {} 而不是 tfoot {} 中指定样式。同样的方法适用于所有人。

**CSS**

```
tfoot{ background: url(tfoot.gif) no-repeat; width: 604px !important; // 604 is width of table}
tr {background: #e0e0e0;}
tfoot tr {background: url(tfoot.gif) no-repeat; width: 604px; display: table;} 
```

**HTML：**

```
<table><thead><tr><th>Header 1</th></tr></thead>
<tbody><tr><td>Body cell</td></tr></tbody>
<tfoot><tr><td>Footer Cell </tr></tfoot></table> 
```

希望这会帮助你......一切顺利

# magento - Magento：高级搜索以显示捆绑产品

> ID：11472837
> 
> 赞同：1
> 
> 时间：2012-07-13T14:46:44.277
> 
> 标签：magento, bundle, advanced-search

即使实际捆绑产品中搜索的属性条件为空白（未设置），我也希望能够在我的高级搜索结果中显示捆绑产品。例如：

**我有 3 个简单的产品：**

品牌：Acme

颜色：绿色

**和 1 个捆绑产品：**

品牌：Acme

颜色：--*空白--*

相关产品：以上 3 个产品。

我当前的高级搜索结果是 3 个简单产品，但即使颜色属性为空白，我如何也能让捆绑产品显示在我的结果中？由于“子”产品列出了颜色，我认为它也应该出现在搜索结果中，它确实出现在分层导航中。

# android - 在 Windows 中创建 Sprite 表

> ID：11472838
> 
> 赞同：0
> 
> 时间：2012-07-13T14:46:45.637
> 
> 标签：android

我正在使用 Wiengine 在 android 中制作游戏。为了更好地利用资源，我正在创建一个精灵表，但它可以在 MAC 操作系统中制作，任何人都可以指导我如何在 Windows 中制作精灵表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T10:51:29.147

我找到了我的问题的答案。有一个工具可用于 Windows 来制作精灵表。该工具被称为[纹理打包器](http://www.top4download.com/texturepacker/download-epnmqgth.html)

# python - 深思熟虑中的忙碌/等待光标

> ID：11472840
> 
> 赞同：0
> 
> 时间：2012-07-13T14:46:52.487
> 
> 标签：python, enthought

我正在使用 enthought 的 traitsui 包。我正在启动这样的 gui：

```
appui = TestBenchUI()
appui.configure_traits() 
```

自定义gui`TestBenchUI`源自`enthought.traits.api.HasTraits`. 一些 gui 操作需要一些时间才能完成，我希望 gui 显示等待/忙碌光标。我一直无法确定如何做到这一点。有人可以启发我吗？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T15:26:47.657

添加此导入：

`from enthought.pyface.api import GUI`

然后当你需要显示一个繁忙的光标时：

`GUI.set_busy()`

# php - 将 XML nodeValue 拉入 php 变量

> ID：11472841
> 
> 赞同：0
> 
> 时间：2012-07-13T14:47:05.087
> 
> 标签：php, xml, xpath, nodevalue

我正在尝试将此 XML 代码中的`<all>`/`<avg>`值分配给一个变量，以便我可以将其用于计算。但是当我这样做并尝试打印该值时，我得到一个空白屏幕。有人可以帮忙吗？

```
<stats>
    <type id="a">
        <buy>
            <volume>698299009</volume>
            <avg>17.94</avg>
            <max>18.45</max>
            <min>1.00</min>     
        </buy>
        <sell>
            <volume>16375234</volume>
            <avg>21.03</avg>
            <max>24.99</max>
            <min>20.78</min>        
        </sell>
        <all>
            <volume>714674243</volume>
            <avg>18.01</avg>
            <max>24.99</max>
            <min>1.00</min>     
        </all>
    </type>
</stats> 
```

我正在使用的php代码如下：

```
$xml = simplexml_load_file("values.xml");

$unit_value = $xml->xpath("/stats/type[@id='a']/buy/avg/")->nodeValue;

echo $unit_value; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T15:02:46.953

请参考[此处](http://php.net/manual/en/simplexmlelement.xpath.php)的文档，`$xml->xpath`应该返回数组。该文档还显示了如何访问文本节点的示例。以下是文档的摘录

```
<?php
  $string = <<<XML
   <a>
     <b>
       <c>text</c>
       <c>stuff</c>
     </b>
     <d>
       <c>code</c>
     </d>
  </a>
 XML;

 $xml = new SimpleXMLElement($string);

 /* Search for <a><b><c> */
 $result = $xml->xpath('/a/b/c');

 while(list( , $node) = each($result)) {
   echo '/a/b/c: ',$node,"\n";
 }

 /* Relative paths also work... */
 $result = $xml->xpath('b/c');

 while(list( , $node) = each($result)) {
   echo 'b/c: ',$node,"\n";
 }
?> 
```

产生输出为

```
/a/b/c: text
/a/b/c: stuff
b/c: text
b/c: stuff 
```

我想这正是您所需要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T15:16:53.300

[xpath](http://www.php.net/manual/en/simplexmlelement.xpath.php)返回一个 SimpleXMLElement 对象数组。所以你可以这样做：

```
$unit_value = $xml->xpath("//stats//type[@id='a']//buy//avg");
echo (string)$unit_value[0]; // cast to string not required 
```

[这里的工作示例](http://codepad.org/hZOuru8X)

或者如果您使用的是 PHP => 5.4，您可以这样做：

```
$unit_value = $xml->xpath("//stats//type[@id='a']//buy//avg")[0];
echo $unit_value; 
```

[这里的工作示例](http://codepad.viper-7.com/PlXTZ9)

# python - 在 Windows 上设置 Python 以不在 cmd 中键入“python”

> ID：11472843
> 
> 赞同：27
> 
> 时间：2012-07-13T14:47:08.260
> 
> 标签：python, windows, path, cmd

我必须如何配置，以便我不必键入`python script.py`，而只需`script.py`在 Windows 上的 CMD 中输入？

我将我的 python 目录添加到包含 python.exe 但脚本仍然无法正确运行的 %PATH% 中。

我用 django-admin.py 尝试过运行`django-admin.py startproject mysite`给了我 `Type 'django-admin.py help <subcommand>' for help on a specific subcommand.`在它前面使用 python 可以正确处理命令。

这里有什么问题？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-07-13T14:59:10.483

```
C:\> assoc .py=Python
C:\> ftype Python="C:\python27\python.exe %1 %*" 
```

或者无论相关路径是什么 - 您也可以使用 ftype 设置命令行参数。

* * *

为了使命令被识别而不必提供后缀 ( `.py`)，类似于它对`.exe`文件的工作方式，添加到（全局）变量`.py`的分号分隔列表中。`PATHEXT`

**预计 2017-07-27**

似乎这仍然吸引眼球，想为 Win10 用户提升一个有用的评论（来自@shadowrunner）：

*对我来说，让它在 Win10 下工作，实际命令是（注意引号的位置）：*

```
C:\> ftype Python="c:\Anaconda2\python.exe" "%1" %* 
```

**预计 2019-02-01**

谈论常青树！

首先，如果您是新安装 Python，我强烈建议您查看 @NunoAndré 的答案。

其次，为了澄清最近评论中的某些内容，请注意：您必须同时执行两个部分 (`assoc`和)，或者在命令`ftype`中使用预先存在的关联标签。`ftype`

默认情况下，至少对于 Windows 8.1 下的 Python 3.7，关联为`.py`is `Python.File`，因此执行`ftype`我上面写的命令将无法正常工作，除非先更改关联。或者，您可以只使用`ftype`并提供默认关联。由你决定。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-06-16T12:29:06.727

从 Python 3.3 开始，包括一个[用于 Windows 的启动器](https://docs.python.org/3.6/using/windows.html#python-launcher-for-windows)：（`py`以及`pyw`用于 GUI 或非 UI 应用程序）

> 这有助于定位和执行不同的 Python 版本。它允许脚本（或命令行）指示对特定 Python 版本的偏好，并将定位并执行该版本。
> 
> 与 PATH 变量不同，启动器将正确选择最合适的 Python 版本。它将更喜欢按用户安装而不是系统范围的安装，并按语言版本排序，而不是使用最近安装的版本。

默认情况下， Python 安装程序将 Python 的文件扩展名链接到`open`动词，因此您只需键入其名称（如果需要，还可以输入 args）即可运行 Python 文件。

*   `py`: `.py`,`.pyc`和`.pyo`( [byte-compiled](https://docs.python.org/3/distutils/apiref.html?highlight=pyc#distutils.util.byte_compile) ), and `.pyz`( [zip-compressed](https://docs.python.org/3/library/zipapp.html) )。
*   `pyw`:`.pyw`和`.pyzw`（zip 压缩）。

警告：[注意 python.exe 和 pythonw.exe 之间的区别](https://stackoverflow.com/questions/9705982/pythonw-exe-or-python-exe/30313091#30313091)

* * *

除其他优点外，Windows 启动器读取 'nix shebangs，因此您可以指定 Python 版本或`python.exe`'[命令行参数](https://docs.python.org/3/using/cmdline.html)

你可以检查这个运行这个脚本（假设 py3 作为默认）：

```
#! /usr/bin/python2.7 -i
import sys
print(sys.version) 
```

*   `myscript.py`: 运行`py`，启动`python2.7`并在完成后进入交互模式（`-i`测试和调试的绝佳选择）。
*   `myscript.py -3`: 运行`py`，启动`python3`并保持交互模式。
*   `python myscript.py`：使用默认的 python 运行时运行，没有交互模式。

* * *

您可以使用 更改此默认关联`ftype`，但我强烈建议：

*   Nirsoft 的[文件类型管理器](http://www.nirsoft.net/utils/file_types_manager.html)实用程序。
*   查看有关文件扩展名和关联的 msdn 文档：[实现自定义文件格式](https://msdn.microsoft.com/en-us/library/windows/desktop/ff521657(v=vs.85).aspx)。

您可以轻松地将其他动词（如`edit`, `test`, `debug`...）与这些文件相关联。

* * *

此外，您可以通过将 Python 的扩展添加到`PATHEXT`按首选项排序的环境变量中来省略 Python 的扩展以在终端中运行文件。（您必须重新打开终端才能使更改生效）。

`setx PATHEXT %PATHEXT%;.PYC;.PYZ;.PY`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-06-10T15:18:37.363

我也有同样的问题......我可以通过将 *.py 文件与 python 启动器重新关联来解决它。

1.  右键单击 *.py 文件并打开其属性。
2.  单击“打开方式...”部分的更改按钮
3.  选择更多应用程序 -> 在此 PC 上查找其他应用程序。
4.  然后浏览到您的 windows 文件夹（默认情况下：“C:\Windows”）
5.  选择“py.exe”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-07-20T20:56:11.023

我试过了：

```
C:\> assoc .py=Python
C:\> ftype Python="C:\tools\python\python.exe %1 %*" 
```

它对我不起作用。所以我做了一个 ftype 搜索：

```
ftype | find "Python"
Python="c:\tools\python\python.exe" %1 %*
Python.ArchiveFile="C:\Windows\py.exe" "%L" %*
Python.NoConArchiveFile="C:\Windows\pyw.exe" "%L" %* 
```

用稍微其他的 ftype 命令解决了我的问题：

```
ftype Python="c:\tools\python\python.exe" "%L" %* 
```

# asp.net-mvc-3 - Razor 部分视图前缀字段名称

> ID：11472847
> 
> 赞同：3
> 
> 时间：2012-07-13T14:47:21.770
> 
> 标签：asp.net-mvc-3, razor, partial-views

当使用 Razor 为具有子模型的复杂模型渲染表单时，我们通常会使用局部视图来渲染子模型。

简单示例模型：

```
public class BlogPost
{
    public string Content { get; set; }
    public List<Comment> Comments { get; set; }
}

public class Comment
{
    public string Content { get; set; }
} 
```

BlogPost.cshtml：

```
@model BlogPost

@Html.TextAreaFor(x => x.Content)

@for (int i = 0; i < Model.Comments.Count; i++)
{
    @Html.Partial('Comment', Model.Comments[i])
} 
```

评论.cshtml：

```
@model Comment

@Html.TextAreaFor(x => x.Content) 
```

**现在解决这个问题：**

假设我们想将所有字段的值发送到`BlogPost`作为参数的控制器操作。这些字段将被发布回控制器，如下所示：

Content=The+content+of+BlogPost&Content=The+first+Comment&Content=The+second+Comment

但是我们需要让 MVC 将它们正确映射到`BlogPost`视图模型，我们需要这个命名约定：

Content=The+content+of+the+BlogPost&Comments[0].Content=The+first+Comment&Comments[1].Content=The+second+Comment

如何以干净的方式实现这一目标？我们只能想到两种似乎都会影响设计的方法：

*   我们将`BlogPost`作为模型传递给局部视图，以便我们可以像这样定义文本区域`@Html.TextAreaFor(x => x.Comments[i].Content)`：但这意味着我们将用于注释的局部视图耦合到父视图模型 - 您可以考虑在不同的上下文中使用相同的局部视图的场景，如果局部视图依赖于父视图模型，这是不可能的。此外，`i`必须以某种方式将其传递给局部视图。
*   或者我们回退到用字符串明确定义每个字段的名称：`@Html.TextArea(ViewBag.Prefix + ".Content")`。

有没有办法告诉局部视图将某个前缀应用于*所有*字段名称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T16:29:50.640

奇科多罗，

如果您创建和 EditorFor 类型的模板`Comment`，mvc 将为您处理所有这些。但是，这只适用于数据库中已经存在行的情况。来自 SO 的示例：

[在剃须刀中提交父母和孩子](https://stackoverflow.com/questions/8416712/submiting-parent-children-in-razor)

如果您需要即时创建新行，那么您将不得不使用一些技巧来允许字段按要求操作。我使用了 steven sandersons 网站上的一篇文章，它允许您在运行时添加集合项目，并且仍然保留不显眼的验证等。请参阅这个 SO 问题和相关文章参考：

[编辑可变长度列表，带有表格的 ASP.NET MVC 3 样式](https://stackoverflow.com/questions/7153405/editing-a-variable-length-list-asp-net-mvc-3-style-with-table)

# sql - SQL 查询中的动态附加约束

> ID：11472849
> 
> 赞同：1
> 
> 时间：2012-07-13T14:47:31.017
> 
> 标签：sql, oracle

我有这个 SQL

```
SELECT devudp1.deviceoid,devudp1.valueType
  FROM DeviceUdpValues devUDP1 
 WHERE devudp1.udpname='TestUDP' 
   and <<either bdvalue or string value based on user selected value datatype>> 
```

在基于**devudp1.valueType**的查询中，我想在下面附加属性

如果 valueType 是 3，那么我想在上面的 select 子句中附加**devudp1.bdvalue ='10'**，否则应该附加**devudp1.bdvalue = 'Hello'**

所以上面的查询当 valueType 是 3 看起来像

```
SELECT devudp1.deviceoid,devudp1.valueType
  FROM DeviceUdpValues devUDP1
 WHERE devudp1.udpname='TestUDP'
   AND devudp1.bdvalue = '10' 
```

否则它看起来像

```
SELECT devudp1.deviceoid,devudp1.valueType
  FROM DeviceUdpValues devUDP1
 WHERE devudp1.udpname='TestUDP'
   AND devudp1.stringValue = 'Hello' 
```

谁能建议我如何将这个逻辑落实到位

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T14:53:39.367

尝试这个：

```
SELECT  devudp1.deviceoid,devudp1.valueType
  FROM  DeviceUdpValues devUDP1 
 WHERE  devudp1.udpname='TestUDP'
   AND  (
         (<USER-SELECTED-VALUE> = 3 AND devudp1.bdvalue ='10') OR
         (<USER-SELECTED-VALUE> <> 3 AND devudp1.stringvalue ='Hello') 
        ) 
```

# r - 月-年条形图，按年分面并填充；数据输入为 char 格式的日期

> ID：11472856
> 
> 赞同：5
> 
> 时间：2012-07-13T14:48:01.563
> 
> 标签：r, ggplot2

环境：Win 7 HP，R v2.15.1

我希望达到的目的：

*   绘制 y（数字）与 x（日期）
*   标签月-年缩写，按 mon+year 排序，las2 垂直对齐
*   按年份填充的颜色
*   按年分面网格

在阅读了这个论坛的不同主题后，我尝试了不同的方法，但无法得到我需要的东西。需要帮忙。附上样本数据和结果。

我的样本数据

```
x <- c("04-01-10","05-01-10","06-01-10","07-01-10","08-01-10","09-01-10","10-01-10","11-01-10","12-01-10","01-01-11","02-01-11","03-01-11","04-01-11","05-01-11","06-01-11","07-01-11","08-01-11","09-01-11","10-01-11","11-01-11","12-01-11","01-01-12","02-01-12","03-01-12","04-01-12","05-01-12","06-01-12")
y <- c(120,210,130,160,190,210,80,70,110,120,140,160,130,200,110,180,210,200,90,60,100,100,120,170,100,180,120) 
```

x 是日期（字符），格式为 mm-dd-yy

转换为数据框

```
MySample <- data.frame(x) ## convert to dataframe 
MySample$y <- y 
```

加载所需的库

```
require(lubridate) 
require(ggplot2) 
```

MySample 基图

1) 绘制 x 与 y

```
 ggplot(MySample, aes(MySample$x, MySample$y)) + 
        geom_bar(y=MySample$y,stat="identity") 
```

给了我基本情节结果

2) 绘制 x 与 y + 填充 = 年

```
 ggplot(MySample, aes(MySample$x, MySample$y, fill=year(MySample$x))) + 
        geom_bar(y=MySample$y,stat="identity") 
```

给了我填充，但 2010,2010.5,2011,2011.5,2012 有 5 个填充年份

我尝试了不同的方法，但遇到了一个或另一个错误。

3) 绘制 x vs y + fill=year + facet_grid(year)

```
 ggplot(MySample, aes(x, y, fill=year(x))) + 
        geom_bar(y=MySample$y,stat="identity") + 
        facet_grid(. ~ year(MySample$x)) 
```

获取：layout_base 中的错误（数据，cols，drop = drop）：至少一层必须包含用于构面的所有变量

4) 绘制 x vs y + fill=year + facet_grid(year) + labels-month (abbr)

```
 ggplot(MySample, aes(x, y, fill=year(x))) + 
        geom_bar(y=MySample$y,stat="identity") + 
        scale_x_date(labels=month(MySample$x,label=TRUE,abbr=TRUE)) 
```

获取：scale_labels.continuous(scale,major) 中的错误：中断和标签的长度不同

我被困住了，需要帮助才能继续前进。需要解决方案来满足以下要求：

1.  仅 3 个填充年 - 2010、2011、2012
2.  xlabels - %b%y 格式；按月-年顺序排序；las2 定位（垂直）
3.  facet_grid 按年份，在适当的 facet-grid 中只有当年的 xlabels 和 bar

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T20:38:58.217

回答你的3点：

1.  使用 scale_fill_gradient(breaks=unique(MySample$year))
2.  使用标准的内置日期系统而不是 lubridate。您可以使用 date_format 在 ggplot2 中指定格式。
3.  使用：+facet_grid(.~year, scales = "free")

以下代码将执行此操作：

```
MySample$date <- as.Date(MySample$x, "%m-%d-%y")
MySample$year <- year(MySample$date)

ggplot(MySample, aes(date, y, fill = year)) + 
  geom_bar(y=y,stat="identity") + 
  facet_grid(. ~ year, scales = "free") +
  scale_x_date(labels = date_format("%b/%y")) +
  scale_fill_gradient(breaks=unique(MySample$year)) 
```

# sharepoint-2010 - 如何在 Sharepoint 中为自定义列表设置自定义列的默认值？

> ID：11472857
> 
> 赞同：0
> 
> 时间：2012-07-13T14:48:13.393
> 
> 标签：sharepoint-2010, sharepoint-list

我有一个在 SharePoint 中用于新闻源的列表。我创建了一个名为 的自定义列`Page Article`，这是我在列表中创建项目所需的超链接类型。我正在使用修改后的列表视图，以便`Page Article`在提要中显示，以便人们可以单击它并转到文章。链接的名称也与列表中对象的标题相同。如何使用他们为列表对象制作的标题并将其设置为链接描述的默认值？

# sql - SQL Server 使用 LINQ 转换日期时间

> ID：11472861
> 
> 赞同：2
> 
> 时间：2012-07-13T14:48:33.217
> 
> 标签：sql, linq, entity-framework

我在 SQL 服务器中有我需要的查询，但我使用的是实体框架，并且希望使用 LINQ 获得相同的结果。这是SQL：

```
select convert(varchar, date_recorded, 12), MAX(outdoor_temp), MAX(wind_speed)
from weatherdata
group by convert(varchar, date_recorded, 12)
order by convert(varchar, date_recorded, 12) DESC ; 
```

这会将我的日期时间列转换为允许我正确分组的正确格式。基本上我需要能够将我的 SQL 日期时间转换为 yymmdd 格式。

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T09:38:47.663

```
class Program
    {
        static void Main(string[] args)
        {

            var entries = new List<Entry>()
                {
                    {new Entry { Date = DateTime.UtcNow, Outdoor_Temp = 10, Wind_Speed = 5 }},
                    {new Entry { Date = DateTime.UtcNow, Outdoor_Temp = 5, Wind_Speed = 10}},
                    {new Entry { Date = DateTime.UtcNow.AddDays(-1), Outdoor_Temp = 15, Wind_Speed = 7}}
                };

            (from e in entries 
             group e by e.Date.ToShortDateString() into g
             select 
                new 
                {
                    StringDate = g.Key,
                    MaxWind_Speed = g.Max(entry => entry.Wind_Speed),
                    MaxOutdoor_Temp = g.Max(entry => entry.Outdoor_Temp)
                }
             ).ToList().ForEach(Console.WriteLine);

        }

        public class Entry
        {
            public DateTime Date { get; set; }
            public int Outdoor_Temp { get; set; }
            public int Wind_Speed { get; set; }
            public override string ToString()
            {
                return string.Format("Date : {0}, Outdoor_Temp : {1}, Wind_Speed : {2}", Date, Outdoor_Temp, Wind_Speed);
            }
        }
    } 
```

# ruby - Sunspot Solr 自动完成功能不工作 Ruby on Rails 3.2.3

> ID：11472863
> 
> 赞同：5
> 
> 时间：2012-07-13T14:48:35.653
> 
> 标签：ruby, ruby-on-rails-3.2, sunspot-rails, sunspot-solr

我需要帮助让自动完成功能在我的 Solr 搜索栏上工作。我，使用这个[https://github.com/xponrails/sunspot_autocomplete](https://github.com/xponrails/sunspot_autocomplete)

按照步骤操作，它不起作用。

我卡在我的搜索栏上-如何将其添加到其中，同时保留参数 [:search]

其他人也有同样的问题，但删除了他们的代码，使其正常工作。

*它是否纯粹与 jquery-ui 自动完成有关？或者是否必须以某种方式安装插件 - 我不确定我是否正确安装了它。

谢谢你=）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T07:06:12.220

请找到自动完成的步骤。我将举一个自动完成项目的例子。

第 1 步：创建一个自动完成文本字段，例如 <%= text_field_with_auto_complete 'item', 'name' %>

第 2 步：然后调用名为 auto_complete_for_item_name 的方法。

setp 3：在该方法中，从表中获取所有行并将其保存在名为@items 的变量中。

第 4 步：然后使用此 @items 变量调用新方法。像渲染 :inline => "<%= auto_complete_result @items, 'name','med_item'%>"

第 5 步：在那个方法中放入这样的 content_tag("ul", items.uniq.join)

它将根据输入的密钥列出所有项目。

如果我错了请纠正我..

感谢和问候，

维吉·库马尔

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T14:19:28.350

i just tried it for my project and it worked fine with this steps

1.  all necessary `sunspot` gems were included and installed ([https://github.com/sunspot/sunspot/blob/master/README.md](https://github.com/sunspot/sunspot/blob/master/README.md))
2.  autocomplete gem was installed, of course, too (i used little different git path `gem 'sunspot_autocomplete', ">= 0.0.3", :git => 'git://github.com/xponrails/sunspot_autocomplete.git'` than proposed in manual)
3.  app was restarted after gems added
4.  sunspot generated solr `schema.xml` was modified (all necessary nodes were added inside blocks `<schema name="sunspot" version="1.0"> <types> *here* </types> </fields> *and here* <fields> </schema>`)
5.  solr was restarted after schema.xml modified
6.  checked if it started fine with correct! xml (what i mean pointed [here](https://stackoverflow.com/questions/12357220/autocomplete-in-solr-and-sunspot/12769325#12769325))
7.  necessary rows in `searchable do; ...; end` block for the model were included (it has to be text field and autocompelte field with unique name addressed to text field with `:using=>:[text field name]` syntax)
8.  model was reindexed after `searchable block` changes
9.  necessary javascript libraries were included into application.js (i had to copy all js files from gem to app asset folder)
10.  basic styles were included into application.css (same situation as with js files)
11.  assets need to be precompiled (if you try to get it to work in your production environment)
12.  correct `autocomplete_text_field` was added to view (i had to `.html_safe` it because it was rendered as raw text)
13.  app was restarted again

and it worked!

but i guess in one or more of this steps you missed something

if the all question is how to add the search field to template - you just need to add this row

`<%= autocomplete_text_field("uniq", "field", "http://localhost:8982/solr/", "uniq_field") %>` - assuming you have indexed `autocomplete :uniq_field, :using => :field` and pointed it to the live version of solr (`http://localhost:8982/solr/`)

if you share with me some code i can point you to something you missed

cheers!

# java - 避免缓存失败的操作

> ID：11472864
> 
> 赞同：2
> 
> 时间：2012-07-13T14:48:45.823
> 
> 标签：java, scala, caching, playframework-2.0

**编辑**
开始卡盘（抛出异常），然后没有“坏”数据要缓存。通过捕获异常，甚至包含在 Either[Why-Fail, Option[T]] 中，我只是为自己做更多的工作。异常是（理想情况下）异常，所以记录，抛出，然后继续......

**原始**
缓存很好，但缓存失败的操作很糟糕

```
Cache.orElse("directory.active") {
  Ok( dao.findAll(active = true) as json )
} 
```

DAO 数据库查找可能会失败（在这种情况下，数据库/查询失败时会返回一个空列表），这将导致缓存错误数据。

如何解决这个问题？我们只想运行一次查询，然后缓存进一步的请求。在 Scala 中，您可以进行惰性初始化，但这会产生永久缓存，这也是不可取的（需要在成员目录添加/编辑时清除缓存）。

假设这适用于任何平台：基本上需要执行一次操作并将其缓存*在成功的结果上*。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T22:07:43.200

我没有方便的缓存实现，所以无法测试这个，但是像这样的东西怎么样：

```
def getCache[A](key:String, result:()=>A)(invalidTest:A=>Boolean):Option[A] = {
  Cache.get(key).getOrElse {
    result match {
      case m:A if (!invalidTest(m)) => Cache.set(key,m);Some(m)
      case _ => None
    }
  }
}

getCache("directory.active", () => dao.findAll(active = true))(_.isEmpty) 
```

正如您所说，您可以轻松地使用 pimp Cache 来添加它，并对您放入缓存的类型进行默认有效性测试。

如果您想缓存 Action 结果（并且如果您总是返回 json，并且如果`as json`返回 Json 类型——抱歉，不是 Play 人），也许：

```
def getCache[A](key:String, result:()=>A)(invalidTest:A=>Boolean):SimpleResult[Json] = {
  Cache.get(key).getOrElse {
    result match {
      case m:A if (!invalidTest(m)) => Cache.set(key,Ok(m as json));Ok(m as json)
      case x:A => Ok(x as json)
      case _ => Ok(errorjson as json)
    }
  }
}

getCache("directory.active", () => dao.findAll(active = true))(_.isEmpty) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T15:55:55.933

感谢@brandon，我想出了一个对 Play[缓存实现的蛋糕和吃它太拉皮条](https://github.com/playframework/Play20/blob/master/framework/src/play/src/main/scala/play/api/cache/Cache.scala#L75)

```
def orElse[A,B](key: String, expire: Int = 0)
  (canFail: => B)(failOn: B => Boolean)(body: B => A)
  (implicit m: ClassManifest[A]): A = {

  PlayCache.getAs[A](key).getOrElse {
    canFail match {
      case x if(!failOn(x)) => // all good, cache away
        val tmp = body(x); set(key, tmp, expire); tmp
      case x => body(x) // never cache a failure
    }
  }
} 
```

然后像这样使用：

```
Cache.orElse("directory.active")(dao.findAll(active = true))(_.isEmpty) { 
  model=> Ok( directory.index(model) )
} 
```

这给我们带来的是选择性缓存可能失败的操作的能力，同时保留缓存注入 canFail 操作的 html 包装器的能力。在这种特殊情况下，findAll 查询返回@400 个成员记录并在 html 层生成一个 jQuery DataTable（生成 150KB），因此需要缓存整个操作。

# mapping - RestKit 使用指定的主键引用在默认关系中映射对象

> ID：11472865
> 
> 赞同：1
> 
> 时间：2012-07-13T14:48:46.090
> 
> 标签：mapping, restkit

我目前正在开发一个 iOS Messenger 应用程序，我想谈谈这两个类的关系：`MessengerConversation`和`MessengerMessage`.

假设我已经有一个本地 MessengerConversation 实例，它可以有许多与其`messages`关系属性相关的 MessengerMessage 实例，我想请求并映射以下 JSON 有效负载：

请求：GET /conversations/:conversationID/msgs
响应：

```
{
  "messages": [
    {
      ...
      "messageid": n,
      "content": "..."
      ...
    },
    ...
  ]
} 
```

由于响应 JSON 有效负载未指示传递的消息来自哪个对话。我使用以下方法将这个问题修复到我的`MessengerManager`类中（负责与共享的 RKObjectManager 实例交互）：

```
- (void)objectLoader:(RKObjectLoader *)objectLoader willMapData:(inout id *)mappableData {
    //
    // GETs Resource Paths.
    if ([objectLoader method] == RKRequestMethodGET) {

        if ([pathMatcherConversationsMessagesGET matchesPath:objectLoader.resourcePath tokenizeQueryStrings:NO parsedArguments:Nil]) {
            //
            // Get requested conversationID from the following resource path Pattern:
            // kMessengerManagerResourcePathMessages: /conversations/:conversationID/msgs
            NSNumber *currentConversationID = Nil;
            NSDictionary *arguments = Nil;

            BOOL isMatchingPattern = [pathMatcherConversationsMessagesGET matchesPattern:kMessengerManagerResourcePathConversationsMessagesGET 
                                                                    tokenizeQueryStrings:YES 
                                                                         parsedArguments:&arguments];

            if (isMatchingPattern) {
                currentConversationID = [arguments objectForKey:@"conversationID"];
                //
                // Get the original returned array of messages:
                NSArray *origMessagesArray = [*mappableData valueForKeyPath:@"messages"];
                NSMutableArray *reformattedData = [NSMutableArray arrayWithCapacity:[origMessagesArray count]];
                //
                // Create copies of objects adding the already knew reference.
                for (NSDictionary *origMessagesArrayObject in origMessagesArray) {
                    NSMutableDictionary *newMessagesArrayObject = [origMessagesArrayObject mutableCopy];
                    [newMessagesArrayObject setObject:currentConversationID forKey:@"conversationid"];
                    [reformattedData addObject:newMessagesArrayObject];
                }
                //
                // Replace the new objects instead of the response objects
                [*mappableData setObject:reformattedData forKey:@"messages"];
            }
        }
    }    
} 
```

所以一切正常。也就是说，所有从指定的 MessengerConversation（到 RKObjectLoader 资源路径）加载的 MessengerMessages 都被插入到想要的关系中。

现在真正的问题来了，因为我正在使用采用 RKObjectLoaderProtocol 的 MessengerManager 类，我可以实现该`objectLoader:willMapData:`方法。但是由于我的 View 类正在使用`RKFetchedResultsTableController`并且每个表控制器实例也是它的 RKObjectLoader 委托，我不知道在映射操作之前启用 RKFetchedResultsTableController 实例来更新接收到的 JSON 有效负载是最佳实践。

我要把它子类化吗？

是否有更好的方法将接收到的对象映射到由 RKObjectLoader 资源路径指定的预定义对象（例如：GET /conversations/2/msg，其中所有结果消息都应该映射到定义的 MessengerConversation 对象中，其主键值等于2)?

最好的问候，
皮瓦

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T14:57:46.843

你不需要这个方法。当您启动 RKObjectLoader 时，将您的 Conversation 对象设置为 targetObject 并制作相对于该对象的映射。例如：

```
RKManagedObjectMapping* cMapping = [RKManagedObjectMapping mappingForClass: [MessengerConversation class]];
RKManagedObjectMapping* mMapping = [RKManagedObjectMapping mappingForClass: [MessengerMessage class]];

//Configure mappings

[cMapping mapKeyPath: @"messages" toRelationship: @"messages" withObjectMapping: mMapping];

[mappingProvider setMapping cMapping forKeyPath: @""]; 
```

# css - Twitter Bootstrap 更改了字段集图例的渲染，为什么？

> ID：11472866
> 
> 赞同：8
> 
> 时间：2012-07-13T14:48:50.220
> 
> 标签：css, asp.net-mvc, asp.net-mvc-3, twitter-bootstrap

在这个 ASP.NET MVC 3 项目中，我刚刚开始尝试使用 Twitter Bootstrap，但我注意到它与`<fieldset>`图例的呈现相混淆。此处的图例渲染发生了什么，如何使其恢复正常？也就是说，我希望右行再次与左行垂直对齐。

左侧是标准图例渲染，预引导，右侧是受引导影响的渲染：

![普通图例](../Images/b4fb9112cc8dac053e92558ffb9e7fe0.png) ![Twitter 引导图例](../Images/7f49588fa8ce2a4d8ed0a2b82d0c20ee.png)

**更新：** 我至少找到了导致渲染中断的原因：Bootstrap 将图例的宽度属性更改为 100%，将边框底部属性更改为“1px 实心”。这会导致图例右侧的原始边框被删除，而在其下方出现一个边框。问题是这是如何工作的。也许 MVC 的 CSS (Site.css) 会干扰 Bootstrap 的 CSS？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-13T18:54:17.613

如果您切换样式表声明以使引导程序位于最后，则应该更正该问题，即：

```
<link href="@Url.Content("~/Content/Site.css")" rel="stylesheet" type="text/css" />
<link href="@Url.Content("~/css/bootstrap.min.css")" rel="stylesheet" type="text/css" /> 
```

**引导样式**

```
fieldset {
    padding: 0;
    margin: 0;
    border: 0;
}

legend {
    display: block;
    width: 100%;
    padding: 0;
    margin-bottom: 27px;
    font-size: 19.5px;
    line-height: 36px;
    color: #333;
    border: 0;
    border-bottom: 1px solid #E5E5E5;
} 
```

**默认 MVC Style.css 样式**

```
fieldset {
    border: 1px solid #DDD;
    padding: 0 1.4em 1.4em 1.4em;
    margin: 0 0 1.5em 0;
}

legend {
    font-size: 1.2em;
    font-weight: bold;
} 
```

最终结果应如下所示：

![在此处输入图像描述](../Images/edea4af746a6ce9dc3b7c358dbc5b524.png)

与相反的方式（最后声明的 MVC 默认样式）

![在此处输入图像描述](../Images/4c8e98f09e2a76e5574c53ee5231669a.png)

或者，完全摆脱 MVC 样式表并使用引导程序以及您需要的任何自定义样式。

# c++ - 具有多个客户端的 C++ Winsock 服务器？

> ID：11472867
> 
> 赞同：1
> 
> 时间：2012-07-13T14:48:52.873
> 
> 标签：c++, sockets, tcp, winsock, bittorrent

我编写了一个通过 TCP 连接与 Bittorrent 跟踪器对话的程序。我想扩展它的功能，通过 C++ 中的 winsock 同时与多个跟踪器通信。

我需要有多个插座吗？如果是这样，我是否需要为每个套接字初始化一个 WSADATA 结构？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:54:32.287

每个 TCP 连接需要一个套接字，即每个远程 IP/端口对一个。你只需要调用[`WSAStartup`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms742213%28v=vs.85%29.aspx)一次来初始化[winsock](http://msdn.microsoft.com/en-us/library/windows/desktop/ms741416%28v=vs.85%29.aspx)库。

# delphi - 在 Delphi/Lazarus 中设置提示窗口 (THintWindow) 的大小

> ID：11472874
> 
> 赞同：2
> 
> 时间：2012-07-13T14:49:08.180
> 
> 标签：delphi, freepascal, lazarus, hint

我正在尝试在 Lazarus 中进行自定义提示。到目前为止，我已经动态加载了提示中的文本，并自定义了字体、字体大小和字体颜色。我想限制提示窗口的宽度。有任何想法吗？这是我的代码。

```
type
  TExHint = class(THintWindow)
  constructor Create(AOwner: TComponent); override;

...

constructor TExHint.Create(AOwner: TComponent);
begin
  inherited Create(AOwner);
  with Canvas.Font do
  begin
    Name  := 'Hanuman';
    Size  := Size + 3;
  end;
  //Canvas.Width := ;
end; 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-14T10:11:45.990

我现在只有 Lazarus 源和记事本，但我会尝试向您解释如何[`THintWindow`](http://lazarus-ccr.sourceforge.net/docs/lcl/forms/thintwindow.html)使用它，因为它是最重要的理解：

*   如果您将类名分配给[`HintWindowClass`](http://lazarus-ccr.sourceforge.net/docs/lcl/forms/hintwindowclass.html)全局变量，那么您可以说*注册*提示窗口类以供应用程序全局使用。然后每次应用程序将显示提示时，它将使用您的提示窗口类并调用您的覆盖函数以及[`THintWindow`](http://lazarus-ccr.sourceforge.net/docs/lcl/forms/thintwindow.html)您未覆盖的基类中的函数。以下是如何*注册*提示窗口类以在应用程序范围内使用：

 **```
HintWindowClass := TExHint; 
```

*   为了获取提示窗口大小，应用程序[`CalcHintRect`](http://lazarus-ccr.sourceforge.net/docs/lcl/forms/thintwindow.calchintrect.html)在提示将要显示时调用该函数。要自己调整提示窗口大小，您需要覆盖此函数并
    返回您想要的边界矩形。如果您不覆盖它，则将[`CalcHintRect`](http://lazarus-ccr.sourceforge.net/docs/lcl/forms/thintwindow.calchintrect.html)使用基类（来自[`THintWindow`](http://lazarus-ccr.sourceforge.net/docs/lcl/forms/thintwindow.html)类）的函数，因此您应该覆盖它：

 **```
type
  TExHint = class(THintWindow)
  public
    constructor Create(AOwner: TComponent); override;
    function CalcHintRect(MaxWidth: Integer; const AHint: String;
      AData: Pointer): TRect; override;
  end;

constructor TExHint.Create(AOwner: TComponent);
begin
  inherited Create(AOwner);
  with Canvas.Font do
  begin
    Name := 'Hanuman';
    Size := Size + 3;
  end;
end;

function TExHint.CalcHintRect(MaxWidth: Integer; const AHint: String;
  AData: Pointer): TRect;
begin
  // here you need to return bounds rectangle for the hint
  Result := Rect(0, 0, SomeWidth, SomeHeight);
end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T18:25:21.600

您应该能够覆盖 CreateParams 并将宽度设置为您喜欢的任何值。

```
procedure TExHint.CreateParams(var Params: TCreateParams);
begin
  inherited CreateParams(Params);
  Params.Width := X; 
end; 
```

我没有对此进行测试，但它应该可以工作。****

# jquery - 在 jquery 中使用 .keypress 事件检测按下的输入按钮

> ID：11472881
> 
> 赞同：0
> 
> 时间：2012-07-13T14:49:34.440
> 
> 标签：jquery, asp.net, listbox, keypress, multi-select

我有一个 Web 应用程序，我在其中使用页面加载时数据库中的项目填充多选列表框。

我从列表框中获取所有被选中的项目，但它们是按照它们填充的顺序排列的。

我希望这些项目按照用户选择的顺序排列。

所以对于这个问题，我在列表框中找到了使用客户端`.click()`事件的解决方案，因为我检测到选择的项目并将其值保留在隐藏字段中。这也很好，但是当用户按下回车键插入鼠标单击以选择项目时，问题就来了。此时它不会触发 .click() 事件，所以我使用过 `onkeypress()`，`onkeyup()`但它根本不会触发

这是我的代码：

```
<script type="text/javascript">
    $(document).ready(function() {
        $(".chzn-results .active-result").click(function(event) {                                  
            var hdfld = document.getElementById("hdn_menuitems");
            if (hdfld.value == "") {
                hdfld.value = $(this).index();
            }
            else {
                hdfld.value = hdfld.value + "," + $(this).index();
            }                              
        });
        $(".chzn-results .active-result").keydown(function(event) {
            $(".chzn-results .active-result").keyup(function(event) {                               
                alert("Event");
                if(event.keyCode==13)
                {        
                    var hdfld = document.getElementById("hdn_menuitems");
                    if (hdfld.value == "") {
                        hdfld.value = $(this).index();
                    }
                    else {
                        hdfld.value = hdfld.value + "," + $(this).index();
                    }                        
                }
            });
        });    
</script> 
```

这是我的列表框：

```
<asp:ListBox ID="dr_menuitem" runat="server" class="chzn-select" style="width:575px;" SelectionMode="Multiple" >
    <asp:ListItem></asp:ListItem>
</asp:Listbox> 
```

我使用 [http://harvesthq.github.com/chosen/][1] 使用列表框

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T15:00:18.823

这样做： -

```
$('.chzn-results .active-result').keydown(function(e) {
    if (e.keyCode == 13)
    {
        var hdfld = $('#hdn_menuitems');
        if (hdfld.value == "")
            $(hdfld).val($(this).index());
        else
            $(hdfld).val(hdfld.value + "," + $(this).index());
    }
});​ 
```

# c# - Ninject - 创建自定义 NinjectWebServiceHost

> ID：11472883
> 
> 赞同：3
> 
> 时间：2012-07-13T14:49:41.643
> 
> 标签：c#, .net, wcf, web-services, ninject

我的 WCF 项目中有几个 Web 服务需要自定义`ServiceAuthorizationManager`才能对 OAuth 调用进行身份验证。为此，我创建了一个自定义`WebServiceHostFactory`. 我正在连接 Ninject 并且很难将其转换为`NinjectWebServiceHostFactory`. 这是我的代码：

```
public class MyServiceHostFactory : WebServiceHostFactory
{
    protected override ServiceHost CreateServiceHost(Type serviceType, Uri[] baseAddresses)
    {
        return new MyServiceHost(serviceType, baseAddresses);
    }
}

public class MyServiceHost: WebServiceHost
{
    public MyServiceHost(Type serviceType, Uri[] baseAddresses)
        : base(serviceType, baseAddresses)
    {
        Authorization.ServiceAuthorizationManager = new OAuthAuthorizationManager();
    }
} 
```

当我切换`WebServiceHost`到 a`NinjectWebServiceHost`时，它要求`IServiceBehavior`执行。`ServiceBehavior`我的Web 服务上有一个属性，`ServiceBehavior`我的`web.config`.

有没有人看到这一点并能够成功实施这样的事情？有没有更好的方法来为我的 2 个 Web 服务连接它？我不希望这影响我所有的 Web 服务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T03:51:40.420

我们前几天刚做了这个。我们发现实现一种新类型的 NinjectWebServiceHostFactory 为我们连接自定义 AuthorizationManager 更容易。

```
public class OAuthHostFactory : NinjectWebServiceHostFactory
{
    protected override ServiceHost CreateServiceHost(Type serviceType, Uri[] baseAddresses)
    {
        var host = base.CreateServiceHost(serviceType, baseAddresses);
        host.Authorization.ServiceAuthorizationManager = new OAuthAuthorizationManager();
        return host;
    }
} 
```

这使我们可以灵活地选择我们想要在哪些路由或 svc 上实现这个特定的工厂。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-13T18:05:17.183

我相信您必须创建一个自定义属性来自己实现[`IServiceBehavior`接口](http://msdn.microsoft.com/en-us/library/system.servicemodel.description.iservicebehavior.aspx)。

您的[`ApplyDispatchBehavior`方法](http://msdn.microsoft.com/en-us/library/system.servicemodel.description.iservicebehavior.applydispatchbehavior.aspx)实现将看起来像这样：

```
public void ApplyDispatchBehavior(ServiceDescription serviceDescription, 
    ServiceHostBase serviceHostBase)
{
    Type serviceType = serviceDescription.ServiceType;
    IInstanceProvider instanceProvider = new NinjectInstanceProvider(
        new StandardKernel(), serviceType);

    foreach(ChannelDispatcher dispatcher in serviceHostBase.ChannelDispatchers)
    {
        foreach (EndpointDispatcher endpointDispatcher in dispatcher.Endpoints)
        {
            DispatchRuntime dispatchRuntime = endpointDispatcher.DispatchRuntime;
            dispatchRuntime.InstanceProvider = instanceProvider;
        }
    }
} 
```

基本上，您正在创建一个自定义[`IInstanceProvider`接口](http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.iinstanceprovider.aspx)实现，该实现依赖于 Ninject 为[`DispatchRuntime`](http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.dispatchruntime.aspx).

[Peter De Rycke](http://pieterderycke.wordpress.com/)在他的[博客文章“使用 IoC 容器创建 WCF 服务实例”](http://pieterderycke.wordpress.com/2011/05/09/using-an-ioc-container-to-create-wcf-service-instances/)中进一步介绍了它（注意上面的代码取自那里）。

我想如果你仍然想使用 a `NinjectWebServiceHost`，你可以通过一个`IServiceBehavior`很像彼得上面概述的实现。

# database - 关于在 ASP.NET 中监控 Newsletter 发送成功的建议

> ID：11472895
> 
> 赞同：0
> 
> 时间：2012-07-13T14:50:22.497
> 
> 标签：database, vb.net, loops, shared-hosting, newsletter

所以，我一直在尝试各种不同的想法来尝试发送电子邮件通讯，并且几乎每一次都遇到障碍。

我目前正在使用共享托管环境，并且需要它在此环境中保持稳定。

我曾想创建一个定时的、计划的系统，将批处理作为后台服务发送，但在这种环境下我无法做到这一点，所以我现在只需将长时间超时的 AJAX 发布到 .NET 表单函数即可。

我有一个发送电子邮件的通用功能，并且正在循环访问我的数据库，如下所示

```
For Each email In list
    If Common.isValidEmail(email("email")) Then
        Try
            Common.sendEmail(email("email"), Common.tCase(email("email")), content, subject, "true", "newsletter", "customer")
         Catch ex As Exception
             errorList += email("id") & ","
         End Try
     Else
         Common.changeData("DELETE FROM mailingList WHERE id='" & email("id") & "'")
     End If
Next 
```

我在这里发现了两个潜在的错误情况，该`isValidEmail`函数检查电子邮件是否正确，然后我尝试发送邮件，如果失败，我将建立一个错误列表。

但是，如果服务中断，这并不好。

所以，我正在考虑通过在每个电子邮件地址的数据库行中添加一个“已发送”标志来修改它，但这需要为每个循环写入数据库，这会拼命减慢它吗？

然后任何时候它退出，我可以回到数据库并重新发送给没有被标记的用户。

有没有人有更好的想法？！

从长远来看，我希望这是一项后台服务，并且正在考虑将其迁移到 Azure，希望我可以在其中运行预定的后台服务，但现在，我需要一个共享环境的解决方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T15:16:29.667

是的，您将通过向数据库记录添加状态来显着提高解决方案的可靠性，该状态可以告诉您单个记录是否已作为该批次的一部分进行处理。这样，您可以设置一个过程，每隔一段时间调用您的函数，并且每次调用只发送 X 条消息。因此，如果您的主机限制您每小时可以发送多少封电子邮件，您现在可以通过调整每次呼叫发送多少封电子邮件以及您执行函数的频率来轻松控制它。

在处理每条记录时，您可能不需要关心更新每条记录的速度，因为发送 SMTP 消息通常比更新本地数据库要慢。如果您的数据库在产生影响的地方那么慢，那么您正在运行它的机器可能资源太少（即需要更多内存）而没有时间换一台更快的新机器。

# python - 在长时间运行的进程中重新加载全局 Python 变量

> ID：11472897
> 
> 赞同：1
> 
> 时间：2012-07-13T14:50:28.230
> 
> 标签：python, django, multithreading, memory, process

我有每天左右重新启动的 celery Python 工作进程。他们执行 Python/Django 程序。

我已经设置了某些准全局值，这些值应该在整个过程中保持在内存中。即，我有某些不经常更改的 MySQL 查询集，因此会在进程开始后立即评估一次并存储为 CONSTANT（一个不好的例子是 PROFILE = Profile.objects.get(user_id=5)）。

假设我想在 celery 进程中重置这个值而不执行一个全新的程序。

该值在许多不同的模块中被导入（和使用）。我假设我必须遍历 sys.modules 中导入 CONSTANT 并删除/重置密钥的每一个？那正确吗？

这似乎很hacky。我通常使用 Memcached 之类的外部服务来协调多个进程之间的内存，但每隔一段时间，我认为本地内存比通过网络调用 NoSQL 存储更可取。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T16:18:43.357

It's a bit hard to say without seeing some code, but importing just sets a reference, exactly as with variable assignment: that is, if the data changes, the references change too. Naturally though this only works if it's the parent context that you've imported (otherwise assignment will change the reference, rather than updating the value.)

In other words, if you do this:

```
from mypackage import mymodule
do_something_with(mymodule.MY_CONSTANT)

#elsewhere
mymodule.MY_CONSTANT = 'new_value' 
```

then all references to mymodule.MY_CONSTANT will get the new value. But if you did this:

```
from mypackage.mymodule import MY_CONSTANT

# elsewhere
mymodule.MY_CONSTANT = 'new_value' 
```

the original reference won't get the new value, because you've rebound MY_CONSTANT to something else but the first reference is still pointing at the old value.

# python - Scipy 衍生物

> ID：11472898
> 
> 赞同：8
> 
> 时间：2012-07-13T14:50:28.533
> 
> 标签：python, math, scipy

我对 Scipy 的导数函数有疑问。我昨晚用了它，得到了一些奇怪的答案。今天早上我再次尝试了一些简单的功能，得到了一些正确的答案和一些错误的答案。这是我的测试：

```
In [1]: def poly1(x):
...:     return x**2

In [3]: derivative(poly1, 0)
Out[3]: 0.0

In [4]: def poly2(x):
...:    return (x-3)**2

In [6]: derivative(poly2, 3)
Out[6]: 0.0

In [8]: def sin1(x):
...:     return sin(x)

In [14]: derivative(sin1, pi/2)
Out[14]: 5.5511151231257827e-17

In [15]: def poly3(x):
....:     return 3*x**4 + 2*x**3 - 10*x**2 + 15*x - 2

In [19]: derivative(poly3, -2)
Out[19]: -39.0

In [20]: derivative(poly3, 2)
Out[20]: 121.0

In [22]: derivative(poly3, 0)
Out[22]: 17.0 
```

我手动检查了 poly3 的值，-2 = 17, 2 = 95, 0 = 15。所以我使用的函数是错误的，还是函数有问题。谢谢

使用：Python 2.7.3、IPython 0.12.1、Numpy 1.6.1、Scipy 0.9.0、Linux Mint 13

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-13T14:57:02.657

正如文档`derivative`所说：

```
derivative(func, x0, dx=1.0, n=1, args=(), order=3)
    Find the n-th derivative of a function at point x0.

    Given a function, use a central difference formula with spacing `dx` to
    compute the n-th derivative at `x0`. 
```

你没有指定`dx`，所以它使用了默认的`1`，这里太大了。例如：

```
In [1]: from scipy.misc import derivative

In [2]: derivative(lambda x: 3*x**4 + 2*x**3 - 10*x**2 + 15*x - 2, -2, dx=1)
Out[2]: -39.0

In [3]: derivative(lambda x: 3*x**4 + 2*x**3 - 10*x**2 + 15*x - 2, -2, dx=0.5)
Out[3]: -22.5

In [4]: derivative(lambda x: 3*x**4 + 2*x**3 - 10*x**2 + 15*x - 2, -2, dx=0.1)
Out[4]: -17.220000000000084

In [5]: derivative(lambda x: 3*x**4 + 2*x**3 - 10*x**2 + 15*x - 2, -2, dx=0.01)
Out[5]: -17.0022000000003

In [6]: derivative(lambda x: 3*x**4 + 2*x**3 - 10*x**2 + 15*x - 2, -2, dx=1e-5)
Out[6]: -17.000000001843318 
```

或者，您可以增加订单：

```
In [7]: derivative(lambda x: 3*x**4 + 2*x**3 - 10*x**2 + 15*x - 2, -2, dx=1, order=5)
Out[7]: -17.0 
```

取数值导数总是有点麻烦。

# sql - 如何在 Visual Studio 2008 中向报表添加不同的总计？

> ID：11472900
> 
> 赞同：0
> 
> 时间：2012-07-13T14:50:41.053
> 
> 标签：sql, visual-studio-2008, reporting-services

我正在 Visual Studio 2008 中制作一份报告，该报告从一个 SQL 数据库中获取其数据集，该数据库以两种不同的方式分组，假设为`State`和`City`，而重要的列是`Deposits`。到目前为止，我已将数据放在一个表格中，并`Deposits`为每个城市添加了小计。是否可以为每个添加一个小计`State`，然后在报告末尾添加一个巨大的总计，将`Deposit`每个的总计`State`为一个数字？以下是表格外观的示例：

```
Alabama
Montgomery
            Deposits
            1000
            500
Subtotal:   1500

Springfield
            Deposits
            1000
            800
Subtotal:   1800

Total:      3300

Texas
Austin
            Deposits
            900
            500
Subtotal:   1400

Dallas
            Deposits
            800
            800
Subtotal:   1600

Total:      3000

Grand Total:6300 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T00:49:46.317

在您的 tablix 上创建两个级别的分组，第一个按州，第二个按城市。对于小计和总计，在组页脚和表格页脚中输入以下公式：

```
=Sum(Fields!Deposits.Value) 
```

Reporting Services 将为您完成所有工作。

# jquery - 使用 jQuery 准确地将 tabindex 设置为 div

> ID：11472902
> 
> 赞同：1
> 
> 时间：2012-07-13T14:50:43.923
> 
> 标签：jquery, html

我使用 jQuery 构建了一个控件：

```
<div class="my-control" />
...
$('.my-control').myControl(); // builds it up as a ui element 
```

目前它只是一堆 div、span、样式、鼠标行为等。它没有获得焦点或参与选项卡的选择。

我发现 tabindex 的使用在给予它焦点时很尴尬。很难知道赋予它什么价值。该控件需要检查文档的其余部分，注意其他可聚焦的控件，注意文档的其余部分何时更改等。

是否可以像往常一样说 focusable=true 并让它按文档位置计算标签顺序？

除了 tabindex，还有其他技术可以做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:57:00.487

`tabindex="0"`应该没事。

正如[HTML5 规范`tabindex`](http://dev.w3.org/html5/spec/editing.html#sequential-focus-navigation-and-the-tabindex-attribute)所指出的：

> **如果值为零**
> 
> 用户代理必须设置元素的 tabindex 焦点标志，应该允许使用顺序焦点导航到达元素，并且应该遵循平台约定来确定元素的相对顺序。

# java - 构造中的泛型：Java 无法识别我自己的类实现了接口

> ID：11472904
> 
> 赞同：2
> 
> 时间：2012-07-13T14:50:54.530
> 
> 标签：java, generics

我想`ThreadPoolExecutor`用这段代码实例化一个新的java：

```
public class ImageList {
    private LinkedBlockingQueue<Image> list;
    private final ThreadPoolExecutor executor;

    public ImageList() {
        executor = new ThreadPoolExecutor(2, 4, 100, TimeUnit.SECONDS, list);
    }
} 
```

哪里`Image`有以下标题：

```
public class Image implements Runnable, Serializable 
```

`BlockingQueue<Runnable>`但是，Java 抱怨找不到该类型的构造函数。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T14:55:00.897

构造函数需要一个`BlockingQueue<Runnable>`. 你把它传给`BlockingQueue<Image>`.

A`BlockingQueue<Image>`不是`BlockingQueue<Runnable>`. 实际上，您可以将任何类型的 Runnable 存储在 a 中`BlockingQueue<Runnable>`，但您只能将`Image`实例存储在 a 中`BlockingQueue<Image>`。

如果是，您可以执行以下操作：

```
BlockingQueue<Image> list = new BlockingQueue<Image>();
BlockingQueue<Runnable> list2 = list1;
list2.add(new Runnable() {...}); 
```

和繁荣！您`BlockingQueue<Image>`将包含除`Image`.

# facebook - Facebook 网站 API：登录并显示用户图像和名称。主动访问令牌错误

> ID：11472908
> 
> 赞同：2
> 
> 时间：2012-07-13T14:51:16.197
> 
> 标签：facebook, facebook-graph-api

我的问题是显示一个登录按钮并（一旦用户登录）显示他的个人资料图像、名称和“注销”链接。

在 facebook api 文档（这里[http://developers.facebook.com/docs/guides/web/#login](http://developers.facebook.com/docs/guides/web/#login)）我找到了这个例子：

```
 <html>
  <head>
   <title>My Facebook Login Page</title>
  </head>
  <body>

    <div id="fb-root"></div>
    <script>
      window.fbAsyncInit = function() {
        FB.init({
          appId      : 'YOUR_APP_ID', // App ID
          channelUrl : '//WWW.YOUR_DOMAIN.COM/channel.html', // Channel File
          status     : true, // check login status
          cookie     : true, // enable cookies to allow the server to access the session
          xfbml      : true  // parse XFBML
        });
        FB.api('/me', function(user) {
          if (user) {
            var image = document.getElementById('image');
            image.src = 'http://graph.facebook.com/' + user.id + '/picture';
            var name = document.getElementById('name');
            name.innerHTML = user.name
          }
        });
      };
      // Load the SDK Asynchronously
      (function(d){
         var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
         if (d.getElementById(id)) {return;}
         js = d.createElement('script'); js.id = id; js.async = true;
         js.src = "//connect.facebook.net/en_US/all.js";
         ref.parentNode.insertBefore(js, ref);
       }(document));
    </script>

    <div align="center">
      <img id="image"/>
      <div id="name"></div>
    </div>

  </body>
</html> 
```

那应该做我正在寻找的。我用我的 app_id 和我的域站点 (http://localhost/index.html) 替换了 'MY_APP_ID' 和 MY_DOMAIN.COM。我还添加了一个登录按钮，正如我在文档中找到的那样（有效并允许我登录），但没有显示图像或名称。我在控制台中编写了“用户”对象，它包含以下内容：

```
error: Object
   code: 2500
   message: "An active access token must be used to query information about the current user."
   type: "OAuthException" 
```

我应该如何使用这个“主动访问令牌”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T14:55:52.900

为了完成任何用户数据检索，每个 Facebook 应用程序都必须首先对用户会话进行身份验证，以确保该应用程序具有最终用户检索其数据的权限。

**参考**：[https ://developers.facebook.com/docs/authentication](https://developers.facebook.com/docs/authentication)

使用 Javascript SDK 检索他们的访问令牌，您应该能够开始检索他们的用户显示名称和图像。

**Facebook JS SDK**：[https ://github.com/facebook/facebook-js-sdk/](https://github.com/facebook/facebook-js-sdk/)

# javascript - 如何将 javascript 从父级加载到子级上下文中

> ID：11472916
> 
> 赞同：3
> 
> 时间：2012-07-13T14:51:29.080
> 
> 标签：javascript, html

我有一个包含 parent.js 的 HTML 页面。在该 html 中，将在运行时创建一个 iFrame。此 iframe 需要在其上下文中使用 parent.js。如果我有一个

```
function save() { ... } 
```

在 parent.js 中，我可以从 iframe.js 调用它，比如

```
parent.save(); 
```

但我需要在 iframe 上下文中调用它，比如

```
save(); 
```

所以我在 iframe html 中再次加载了 parent.js。这使得每次创建新 iframe 时都会加载 parent.js。

无论如何我可以将已经加载的 parent.js 重用到创建的每个 iframe 中吗？，比如

```
loadParentJS("parent.js"); 
```

在 iframe.js 中。这不应该向应用程序服务器发出另一个请求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T18:32:38.913

将您的代码封装在 parent.js 中的闭包中：

```
var loadParentJS = function(window) {
    window.save = function() {
      // code
    };

    window.other = function() {
      // code
    };

  // rest of your code...

};

loadParentJS(window); 
```

然后在你的 iframe 中，运行这个：

```
parent.loadParentJS(window); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T15:28:06.537

在您的 parent.js 文件中，在每个函数和变量前面加上`this.`，然后您应该能够利用 Javascript 闭包。

替换： 替换为`function save() { ... }` ：`this.save = function() { ... }`

替换： 替换为`var aVariable = "value";` ：`this.aVariable = "value";`

然后在您的 iframe 中，您需要将范围设置`this`为`parent`：

`this = parent`;

您对 parent.js（在全局 javascript 或 iframe javascript 中）中的函数或变量的所有调用将如下所示：

```
this.save();
alert(this.aVariable); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T15:27:50.127

简短的回答，不，你不能。IFrame 的内容作为单独的网页处理。更长的答案：您确定需要使用 IFrame 吗？它是干什么用的？你能避免吗？使用 IFrame 并不是一件坏事，只是它可能无法满足您的需求

您应该阅读一些有关跨域通信的信息。这将使您了解如何在您的网页和其中的 IFrame 之间进行通信

[跨域通信](http://css.dzone.com/articles/cross-domain-communication)

祝你好运

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T18:14:53.943

我想您可以将`document`or传递`window`给 save 函数来操作上下文。

* * *

例如，接受文档作为参数：

```
function save(doc) { doc.getObjectById("myform").submit(); } 
```

然后：

```
parent.save(document); 
```

* * *

或者接受窗口作为参数：

```
function save(win) { alert(win.myvariable) } 
```

接着：

```
parent.save(self); 
```

# c# - 从服务器向所有客户端发送信号器消息

> ID：11472920
> 
> 赞同：7
> 
> 时间：2012-07-13T14:51:34.310
> 
> 标签：c#, asp.net-mvc, signalr

这与[SignalR + 通过操作方法向集线器发布消息](https://stackoverflow.com/questions/7549179/signalr-posting-a-message-to-a-hub-via-an-action-method)有关，但我的问题有点不同：

我在使用集线器的信号器版本 0.5.2。在旧版本中，鼓励您在集线器上创建方法以向所有客户端发送消息，这就是我所拥有的：

```
public class MyHub : Hub
{
    public void SendMessage(string message)
    {
        // Any other logic here
        Clients.messageRecieved(message);
    }

    ...
} 
```

所以在 0.5.2 中，我想向所有客户端发送一条消息（比如从控制器的某个地方）。如何访问`MyHub`实例？

我看到引用的唯一方法是：

```
var hubContext = GlobalHost.ConnectionManager.GetHubContext<MyHub>();
hubContext.Clients.messageRecieved("hello"); 
```

这很好，但我想在我的集线器上调用该方法。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-13T15:37:49.040

您可以通过使用静态方法来做到这一点：

SignalR v.04-

```
public class MyHub : Hub
{
    internal static void SendMessage(string message)
    {
        var connectionManager = (IConnectionManager)AspNetHost.DependencyResolver.GetService(typeof(IConnectionManager));
        dynamic allClients = connectionManager.GetClients<MyHub>();
        allClients.messageRecieved(message);
    }

    ...
} 
```

SignalR 0.5+

```
public class MyHub : Hub
{
    internal static void SendMessage(string message)
    {
        IHubContext context = GlobalHost.ConnectionManager.GetHubContext<MyHub>();
        context.Clients.messageRecieved(message);
    }

    ...
} 
```

然后你可以这样称呼它：

```
MyHub.SendMessage("The Message!"); 
```

关于 SignalR API 的好文章：[http ://weblogs.asp.net/davidfowler/archive/2012/05/04/api-improvements-made-in-signalr-0-5.aspx](http://weblogs.asp.net/davidfowler/archive/2012/05/04/api-improvements-made-in-signalr-0-5.aspx)

**由 Paolo Moretti**在评论中提供

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-13T15:44:07.250

我有同样的问题，在我的例子中 addNotification 是客户端方法：

```
var hubContext = GlobalHost.ConnectionManager.GetHubContext<SignalR.NotificationsHub>();
hubContext.Clients.addNotification("Text here"); 
```

在您的客户端，您可以添加代码以在 addNotification 中调用您的集线器方法：

```
var notification = $.connection.notificationHub;
notification.addNotification = function (message) {
 notification.addServerNotification(message); // Server Side method
}

$.connection.hub.start(); 
```

中心：

```
 [HubName("notificationHub")]
    public class NotificationsHub : Hub
    {
        public void addServerNotification(string message)
        {
          //do your thing
        }
    } 
```

更新：一遍又一遍地阅读您的问题，我真的找不到这样做的理由。Hub方法通常是从客户端调用的，或者我误解了你，无论如何这里是一个更新。如果您想做服务器端的事情，然后通知客户端。

```
 [HttpPost]
  [Authorize]
  public ActionResult Add(Item item)
  {
      MyHubMethodCopy(item);
      var hubContext = GlobalHost.ConnectionManager.GetHubContext<SignalR.NotificationsHub>();
    hubContext.Clients.addNotification("Items were added");

  }

  private void MyHubMethodCopy(Item item)
  {
      itemService.AddItem(item);
  } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-07-11T03:25:17.983

# ASP.NET Core 2.x 和 3.x 的更新：

您可以在任何有依赖注入的地方轻松访问 Hub 实例：

```
public class HomeController : Controller
{
    private readonly IHubContext<MyHub> _myHubContext;

    public HomeController(IHubContext<MyHub> myHubContext)
    {
        _myHubContext = myHubContext;
    }

    public void SendMessage(string msg)
    {
        _myHubContext.Clients.All.SendAsync("MessageFromServer", msg);
    }
} 
```

如果它给你语法错误，请确保你有：

```
using Microsoft.AspNetCore.SignalR; 
```

并且您没有：

```
using Microsoft.AspNet.SignalR; 
```

# asp.net-mvc - 为什么我在 MVC 中使用 LINQ 时会收到此错误？

> ID：11472921
> 
> 赞同：-2
> 
> 时间：2012-07-13T14:51:34.823
> 
> 标签：asp.net-mvc, asp.net-mvc-3, linq, linq-to-sql, asp.net-mvc-2

我在模型文件夹的 linq 中有一个名为 Student 的表。当我运行我的应用程序并单击学生选项卡时，IE 上会出现此错误。我不知道为什么我会看到这个。

**编译器错误消息：**

> CS0012：“System.Data.Linq.DataContext”类型在未引用的程序集中定义。您必须添加对程序集“System.Data.Linq，Version=4.0.0.0，Culture=neutral，PublicKeyToken=b77a5c561934e089”的引用。

**源错误：**

> 第 27 行：
> 第 28 行：
> 第 29 行：公共类 _Page_Views_Student_Index_cshtml：System.Web.Mvc.WebViewPage> { 第 30 行：
> 第 31 行：#line hidden

**源文件：**

> c:\Windows\Microsoft.NET\Framework\v4.0.30319\Temporary ASP.NET Files\root\682ba75a\2833b27b\App_Web_index.cshtml.b4fd288c.t7qdtf0f.0.cs 行：29

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T15:15:11.570

您需要在项目中添加对 System.Data.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089 的引用。几乎就像错误所说的那样。

`You must add a reference to assembly 'System.Data.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.`

您可以通过右键单击项目并单击添加引用并导航到 System.Data.Linq 来执行此操作，也可以在 Web.Config 中手动执行此操作。

# asp.net-mvc - 多租户和插件的 ASP.NET MVC 模式？

> ID：11472926
> 
> 赞同：4
> 
> 时间：2012-07-13T14:51:43.003
> 
> 标签：asp.net-mvc, design-patterns, module

我试图了解如何在解决方案中创建一个作为 VS2010 项目存在的 ASP.NET MVC 站点，然后对于多个“租户”，我将创建一个从该站点继承的站点。这样可以灵活地将模块化功能添加到一个而不影响另一个，并且两者都可以从核心库优化中受益。

这是一个疯狂的想法吗？这种事情存在哪些模式？我为基于 web 的站点做了类似的事情（将 DLLS 添加为插件），但在 MVC 中没有。

A "tenant" is a business client. Each already has their own MSSQL database and seperate processing around them, each client is in its own silo. The databases are similar with a few features added here and there, they are versioned and deployed seperately, that whole process works well. A client has n logons. I want to develop a single "base site" that can then be used to give function to a tenant, and all activities are segerated for a tenant to a single database. Where things get ugly is how I can add a new component (say a forum) to one tenant site without mucking up the site experience for other tenants.

All ideas appreciated. Thanks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:00:18.863

我在开发多租户 Web 应用程序方面进行了大量工作。以下是帮助您入门的三个基本指针：

**安全**

TenantId 是登录凭据的一部分。这些存储在 Thread.CurrentPrincipal 中。这有效地将每个请求（线程）绑定到特定用户，从而绑定到租户。可以从任何代码轻松访问 Thread.CurrentPrincipal。

**数据库**

我们使用单个数据库来存储所有数据。在特定于一个租户（多租户）的表（实体）和不是（跨租户）的表之间进行了分离。多租户表有一个名为“TenantId”的列。在我们的实体模型中，我们确保这些实体继承自一个特殊的 IMultiTenant 接口。此接口包含 TenantId 字段的 C# 等效项。我们扩展了 Entity Framework 的架构，为多租户实体提供对 TenantId 的默认过滤。这确保了一个租户永远无法访问或修改另一个租户的数据。

**插件**

为了支持租户特定代码的实现，我们使用了一些依赖注入技巧。基于当前的 TenantId，我们的 DI 容器注入该接口的特定于租户的实现。

# design-patterns - 统一两个类，同时保留一些扩展能力。简单性与可重用性

> ID：11472936
> 
> 赞同：1
> 
> 时间：2012-07-13T14:52:19.797
> 
> 标签：design-patterns, code-reuse

注意：我的代码恰好在 C# 中，但我认为这对解决问题并不重要。

# 问题

我正在尝试减少我们拥有的两个旧类中的代码重复，它们都用于从 XML 加载查询。它们都有获取 XML 位置的构造函数，都有`Execute`接受 SQL 参数集合的方法，并且都提供了各种静态重载方法，以便快速轻松地运行带有单个命名参数或无参数或一个参数的查询具有非默认 SQL 连接对象。这些静态方法也接受 XML 位置作为参数，并在内部调用构造函数，依此类推，最后只返回 DataSet 的第一个 DataTable。

```
public static DataTable GetQuery(string queryName) { ... }
public static DataTable GetQuery(string queryName, string parameterName, string parameterValue) { ... }
public static DataTable GetQuery(string queryName, Hashtable parameters) { ... }
public static DataTable GetQuery(string queryName, Hashtable parameters, IConnection connection) { ... } 
```

等等。

两者的*区别*在于，一个在文件系统中查找 XML 文件，另一个查找嵌入在程序集中的 XML 文件。

# 可能的解决方案 1

我正在考虑将它们统一成一个，可以使用单独`IQuerySource`接口的不同实现，传递给构造函数或其他东西。但这意味着要么必须始终提前调用构造函数，要么每次`GetQuery`都需要将方法传递给对象。`IQuerySource`我试图避免这样的事情，因为这些`GetQuery`方法在客户端代码中*随处*使用，用于快速的小事情，例如`GetQuery("GetUserDetails","UserID",userId.ToString())`.

# 可能的解决方案 2

或者，我可以创建两个非常轻量级的类`FileQuery`和`DllQuery`，它们将位于统一类的顶部，并且它们总是会向下传递给构造函数和/或`FileQuerySource`方法。这将使客户端代码保持较小，但除了核心类之外，我不希望在另外两个地方维护所有现有重载的（略微更薄的）版本！`DllQuerySource``GetQuery``GetQuery`

# 可能的解决方案 3

另一种选择与上述类似，但公开统一类，以便您可以调用，例如，`DllQuery.Q.GetQuery("GetUserDetails","UserID",userId.ToString())`但是我不确定 DllQuery 如何拦截调用并确保统一类的 Q 实例始终获得正确的源工作。

另一个复杂性是，要从程序集中获取 XML，我们目前正在使用`System.Reflection.Assembly.GetCallingAssembly()`，因此无论在何处调用它都必须直接位于客户端代码的表面之下，否则我们将获得 Data 程序集而不是客户端程序集。

我知道这个问题可能有点主观，但我希望有一些易于理解和定义明确的设计模式或其他东西来解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T15:09:43.917

我认为这很受意见的影响，但我会这样做：

```
public interface IQuerySource
{
  // function GetXML(Assembly caller)
};

public class XmlQuery
{
  XmlQuery(IQuerySource source);
  // GetQuery functions
}

public class FileQuery : IQuerySource
{
  private FileQuery() {} // Only accessable through the Q property
  public static readonly XmlQuery Q = new XmlQuery(new FileQuery());

  // function GetXML(Assembly caller) for a file source
}

public class DllQuery : IQuerySource
{
  private DllQuery() {} // Only accessable through the Q property
  public static readonly XmlQuery Q = new XmlQuery(new DllQuery());

  // function GetXML(Assembly caller) for an assembly source
} 
```

# c++ - 您可以同步调用 AudioObjectSetPropertyData 吗？

> ID：11472937
> 
> 赞同：0
> 
> 时间：2012-07-13T14:52:22.720
> 
> 标签：c++, macos, osx-lion, osx-snow-leopard, core-audio

我正在使用 AudioObjectSetPropertyData 设置设备的采样率。

有没有办法让这个调用是同步的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T21:01:49.677

不太可能，因为在运行的采样流中插入或更改采样率转换器可能会导致严重的故障。一种可能的解决方案是并行运行您自己的采样率转换器，并在您想要的采样时间在转换器之间切换。在某些情况下可能需要交叉淡入淡出。

# objective-c - 旋转的 UIView 变得无响应

> ID：11472940
> 
> 赞同：0
> 
> 时间：2012-07-13T14:52:33.793
> 
> 标签：objective-c, uiview, uiviewcontroller, rotation, uiinterfaceorientation

我有一个 UIViewController 子类，它会在 UI 旋转时更改其框架（例如，最常见的是，框架大小相同，并且以横向和纵向为中心。）当视图旋转时，视图在视觉上会按预期更改其框架。但是最终在新框架区域中的控件（按钮、滚动视图等）不会响应触摸。唯一响应的控件是保留在原始框架中的控件（因此，如果视图向下和向左移动，右上角的控件或控件的一部分保持响应。）知道这里发生了什么吗？

这是更改框架的代码：

```
- (void) setLandscape:(bool)bLandscape {

    if( bLandscape )
        [self setFrame:m_landscapeFrame];
    else
        [self setFrame:m_portraitFrame];
} 
```

在直接处理旋转的更大视图控制器中：

```
- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration {

    bool bToLandscape= UIInterfaceOrientationIsLandscape(toInterfaceOrientation);

    [UIView beginAnimations:NULL context:nil];
    [UIView setAnimationDuration:duration];

    [m_pCurrentWindowViewController setLandscape:bToLandscape];

    // (Some unrelated stuff happens here...)

    [UIView commitAnimations];

} 
```

对我来说，这似乎是苹果的一个错误或至少是糟糕的设计 - 永远不应该有一个时间视图在视觉上处于一个位置而在控制方面处于另一个位置。但我只是在寻找一种方法来解决这种行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T22:30:26.467

我发现的最简单的解决方法是`didRotateFromInterfaceOrientation`在`willRotateToInterfaceOrientation`.

# android - 查找放置在 TextView 上的字母的坐标

> ID：11472944
> 
> 赞同：5
> 
> 时间：2012-07-13T14:52:56.687
> 
> 标签：android, android-layout

我有一个文本视图，其中包含覆盖一半屏幕的长文本，

在这个文本视图中，我在不同的位置有两个单词，我必须在其上方放置一个空白布局，这将使它具有玻璃效果。

我可以通过将 textview 放在 framelayout 中并将布局放在其上方来做到这一点。

问题是我将如何获得单词的坐标，因为文本可能排列在不同设备上的不同位置。

![在此处输入图像描述](../Images/cf6c497237f1460b088822674b027948.png)

我想在标记为白色的地方放置一个布局。有人可以帮忙吗 谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-15T05:53:45.417

这将对您有所帮助

> ```
> public void getLocationOnScreen (int[] location)
>     Since: API Level 1
> 
> Computes the coordinates of this view on the screen. The argument must be an
> array of two integers. After the method returns, the array contains the x and y
> location in that order.
> 
> Parameters
>    location   an array of two integers in which to hold the coordinates 
> ```

请参阅[此](http://www.devdaily.com/java/jwarehouse/android/test-runner/src/android/test/ViewAsserts.java.shtml)代码、[此](http://developer.android.com/reference/android/view/View.html#getLocationOnScreen%28int%5B%5D%29)链接以及[此](http://www.javadocexamples.com/java/awt/Component/getLocationOnScreen%28%29.html)链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-15T06:23:34.717

我不确定您是否可以直接从 TextView 获取文本的坐标 - 您应该在 TextView 类源代码中搜索。但是....如果您将文本视图渲染为位图，然后在位图中搜索文本的坐标（如果搜索的文本是蓝色的，应该很容易得到矩形！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-11-26T16:34:36.093

你真正想要的是一个 backgroundspan ：

```
span = new BackgroundColorSpan(Color.WHITE);
text.setSpan(span, start, end, Spanned.SPAN_EXCLUSIVE_EXCLUSIVE); 
```

# asp.net-mvc-3 - Telerik MVC 网格在运行时来自集合或字典的动态列

> ID：11472946
> 
> 赞同：6
> 
> 时间：2012-07-13T14:53:06.693
> 
> 标签：asp.net-mvc-3, data-binding, dynamic, telerik-grid

在花了最后几天搜索之后，我正式陷入困境。我正在将一个对象绑定到 Telerik MVC 3 Grid，但问题是它需要动态创建列（不是自动生成的）。其中三列是已知的，其他列是未知的，这是棘手的部分。基本上，它可以像这些例子：

已知列1 | 已知列2 | 未知列1 | 已知列 3 已知列 1 | 已知列2 | 未知列1 | 未知列2 | 未知列3 | 已知列 3 等

因为我将未知列放在列表中（我也尝试过字典，所以我可以获取列名），这对我来说在绑定时很复杂。我的代码如下：

模型（可以有0到数百行，但是这个模型在List类型的视图模型中，也可以有0到20加上动态添加的列）

```
public class VendorPaymentsGLAccount
{
    public string GeneralLedgerAccountNumber { get; set; }
    public string GeneralLedgerAccountName { get; set; }
    public string DisplayName { get { return string.Format("{0} - {1}", GeneralLedgerAccountNumber, GeneralLedgerAccountName); } }
    public Dictionary<string, double> MonthAmount { get; set; }
    public double Total { get { return MonthAmount.Sum(x => x.Value); } }
    public List<string> Columns { get; set; }
    public List<double> Amounts { get; set; }

    public VendorPaymentsGLAccount() { }
} 
```

查看（被注释掉的部分是试图使用字典）

```
<fieldset>
    <legend>General Ledger Account Spend History</legend>
    @if (Model.VendorPaymentsGLAccounts != null)
    {

            <br />
            @(Html.Telerik().Grid(Model.VendorPaymentsGLAccounts)
                    .Name("Grid")
                    .Columns(columns =>
                    {
                        columns.Bound(gl => gl.DisplayName).Title("General Ledger Account").Width(200).Filterable(false).Sortable(false);

                        //foreach (var month in Model.VendorPaymentsGLAccounts[0].MonthAmount)
                        //{
                        //    //columns.Bound(gl => gl.MonthAmount[month.Key.ToString()].ToString()).Title(month.Key.ToString()).Width(100).Filterable(false).Sortable(false);
                        //    //columns.Template(v => Html.ActionLink(v.VoucherID, "VoucherSummary", new { id = v.VoucherID, bu = v.BusinessUnitID, dtt = v.InvoiceDate.Ticks })).Title("Voucher").Width(100);
                        //    columns.Template(gl => Html.ActionLink(gl.MonthAmount[month.Key.ToString()].ToString(), "VoucherSummary")).Title(month.Key.ToString()).Width(100);
                        //}

                        for (int i = 1; i <= (Model.VendorPaymentsGLAccounts[0].Columns.Count() - 1); i++)
                        {
                            string colTemp = Model.VendorPaymentsGLAccounts[0].Columns[i - 1];
                            columns.Template(gl => gl.Amounts[i - 1]).Title(colTemp).Width(100);
                        }

                        columns.Template(gl => String.Format("{0:C}", gl.Total)).Title("Total");
                    })
                    .Sortable()
                    .Pageable()
                    .Filterable()
                    .Footer(true))
    }
    else
    {
        <br />
        @:There are no records that match your selected criteria.
    }
</fieldset> 
```

使用字典方法，我能够使用正确的标题文本正确生成列，但列的值（在我的测试中只有 2 列）是相同的。有人能帮忙吗？这似乎是一个奇怪的问题。只是想弄清楚如何正确地做到这一点。

更新：这是使用显示问题的字典方法的屏幕截图。列标题正确，但两个动态列的值相同。

![问题截图](../Images/89da064d60bede14941e653e768f736d.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-13T17:10:59.403

在 Telerik 网格控件中使用动态定义的列可能会很棘手。但在你的情况下，这主要是一个典型的闭包陷阱。

在以下循环中，编译器会将 的每个实例绑定`gl => gl.Amounts[i - 1]`到变量`i`并稍后对其进行评估：

```
for (int i = 1; i <= (Model.VendorPaymentsGLAccounts[0].Columns.Count() - 1); i++)
{
  string colTemp = Model.VendorPaymentsGLAccounts[0].Columns[i - 1];
  columns.Template(gl => gl.Amounts[i - 1]).Title(colTemp).Width(100);
} 
```

事实上，它是在循环完成后评估的。所以`i`总会有导致循环完成的值。

解决方法是使用临时变量：

```
for (int i = 1; i <= (Model.VendorPaymentsGLAccounts[0].Columns.Count() - 1); i++)
{
  string colTemp = Model.VendorPaymentsGLAccounts[0].Columns[i - 1];
  int columnIndex = i - 1;
  columns.Template(gl => gl.Amounts[columnIndex]).Title(colTemp).Width(100);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T19:02:58.920

我在运行时使用反射动态绑定列：

```
@model IEnumerable<object>
@using System.Collections
@using System.Collections.Generic
@using System.Reflection;

@(Html.Telerik().Grid(Model)
    .Name("Grid")
    .Columns(columns =>                    
        {
            Type t = Model.GetType().GetGenericArguments()[0];
            foreach (var prop in t.GetProperties())
            {
                if (IsCoreType(prop.PropertyType))
                {
                    columns.Bound(prop.PropertyType, prop.Name);
                }
            }
        })    
        .DataBinding(binding => binding.Ajax()                                        
            .Select("SelectMethod", "SomeController")                                    
        )    
    .Sortable()    
    .Pageable()
    .Filterable()
    .Groupable()
)

@functions{
    public bool IsCoreType(Type type)
    {
        if (type.IsGenericType && type.GetGenericTypeDefinition() == typeof(Nullable<>))
        {
            return IsCoreType(type.GetGenericArguments()[0]);
        }
        return !(type != typeof(object) && Type.GetTypeCode(type) == TypeCode.Object);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-07T22:12:21.413

我遇到了同样的问题，并且在谷歌上搜索了很多小时，并且从各种援助热线进行了很多尝试。但即便如此，解决起来也不是那么简单！

出于这个原因，并且在这里还有另一个工作示例，我还将提供我的解决方案！

**信息：**它只适用于我所在的**IList**模型。其他收藏也有问题！

```
@model IList<CBS.Web.Models.Equipment.EquipmentViewModel>
@(Html.Telerik().Grid(Model)
    .Name("Grid")

    .DataKeys(keys =>
    {
        keys.Add(m => m.ID);
    })

    .DataBinding(dataBinding =>
    {
        dataBinding.Ajax()
            // renders the grid initially
            .Select("EquipmentGrid", "Equipment");
    })                    

    .Columns(columns =>
    {
        // Equipment IDs
        columns.Bound(m => m.ID).Hidden(true);
        columns.Bound(m => m.Name).Title("Equipments").Width(200);

        // Every item (EquipmentViewModel) of the Model has the same Count of Fields
        for (int i = 0; i < (Model[0].Fields.Count()); i++)
        {
            // Name of the column is everytime same as in Model[0]
            string columnName = Model[0].Fields.ElementAt(i).FieldDefinition.Name;
            // Constructs i-counted columns, dynamically on how much
            // Fields are owned by an Equipment. But note, that all Equipment-items
            // in the Model must have the same Count and disposal of Fields! 
            columns.Template(m => m.Fields
                                    .Where(f => f.FieldDefinition.Name == columnName)
                                    .Where(f => f.EquipmentId == m.ID).First().Value)
                                    .Title(columnName)
                                    .Width(columnName.Length * 8); // * 8 was the optimal lenght per character
        }
    })

    .ClientEvents(events => events.OnRowSelect("onRowSelected"))

    .Selectable()
    .Resizable(resizing => resizing.Columns(true))
    .Pageable()
    .Scrollable()
    .Groupable()
    .Filterable()
) 
```

控制器：

```
public ActionResult EquipmentGrid(Guid id)
{            
    var belongingEquipments = _equipmentRepository.GetNotDeleted()
                                .OrderBy(e => e.Name).ToList()
                                .Where(e => e.RevisionId == id);

    List<EquipmentViewModel> equVMList = new List<EquipmentViewModel>();

    for (int i = 0; i < belongingEquipments.Count(); i++)
    {
        var equVM = new EquipmentViewModel
        {
            ID = belongingEquipments.ElementAt(i).ID,
            Name = belongingEquipments.ElementAt(i).Name,
            RevisionId = belongingEquipments.ElementAt(i).RevisionId,
            EquipmentTypeId = belongingEquipments.ElementAt(i).EquipmentTypeId,

            Fields = SortFields(belongingEquipments.ElementAt(i).Fields.ToList())
        };
        equVMList.Add(equVM);
    }

    return PartialView("EquipmentGrid", equVMList);
} 
```

楷模：

```
namespace CBS.Web.Models.Equipment
{
    public class EquipmentViewModel
    {
        public Guid ID { get; set; }
        public string Name { get; set; }

        public Guid RevisionId { get; set; }                            
        public Guid EquipmentTypeId { get; set; }

        public virtual ICollection<FieldEntity> Fields { get; set; }
    }
} 
```

字段定义

```
namespace CBS.DataAccess.Entities
{
    public class FieldDefinitionEntity : EntityBase
    {
        [Required]
        public virtual Guid EquipmentTypeId { get; set; }
        public virtual EquipmentTypeEntity EquipmentType { get; set; }

        [Required(AllowEmptyStrings = false)]
        public virtual string Name { get; set; }

        public virtual int Numbering { get; set; }

        [Required]
        public virtual Guid TypeInformationId { get; set; }
        public virtual TypeInformationEntity TypeInformation { get; set; }

        public virtual ICollection<FieldEntity> Fields { get; set; }
    }
} 
```

场地

```
namespace CBS.DataAccess.Entities
{
    public class FieldEntity : EntityBase
    {
        [Required]
        public virtual Guid EquipmentId { get; set; }
        public virtual EquipmentEntity Equipment { get; set; }

        [Required]
        public virtual Guid FieldDefinitionId { get; set; }
        public virtual FieldDefinitionEntity FieldDefinition { get; set; }

        public virtual string Value { get; set; }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-18T07:25:49.630

这是解决方法：

```
@(Html.Telerik().Grid(Model.Users)
    .Name("Grid")
    .Columns(columns => {
        columns.GenerateCustomColumns(columnSettings);          
       }).DataBinding(dataBinding => dataBinding.Ajax().Select("_getusers", "home"))
           .Scrollable(scrolling => scrolling.Enabled(true).Height("auto"))
           .Pageable(paging => paging.Enabled(true)
           .PageSize(10, new int[] { 5, 10, 20, 50, 100, 500 })
           .Position(GridPagerPosition.Both)
           .Total(Model.Users.Count)
           .Style(GridPagerStyles.PageSizeDropDown | GridPagerStyles.NextPreviousAndNumeric)
                           .PageTo(1))
           .Filterable(filtering => filtering.Enabled(true))
           .Reorderable(reordering => reordering.Columns(true))
               .NoRecordsTemplate(" ")
           .EnableCustomBinding(true) 
```

)

// 动态生成列的扩展方法

```
public static class TelerikMvcGridColumnHelper
{
    public static void GenerateCustomColumns<T>(this GridColumnFactory<T>   columns,List<GridCustomColumnSettings> settings) where T:class
    {
        if (settings != null)
        {
            settings.ForEach(column =>
            {
                var boundedColumn = columns.Bound(column.Member);
                if (column.ClientFooterTemplate != null)
                    boundedColumn.ClientFooterTemplate(column.ClientFooterTemplate);

                if (!string.IsNullOrEmpty(column.Width))
                    boundedColumn.Width(column.Width);

            });
        }

    }
} 
```

// 列设置类

```
public class GridCustomColumnSettings : GridColumnSettings
 {
    public string ClientFooterTemplate { get; set; }

 } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-13T05:59:45.040

我做了这个简单的方法。注意：以下解决方案也适用于 ajax 编辑模式（不仅仅是只读网格）：

当 ViewModel 是：

```
public class PriceSheetEditGridViewModel
{
    public IEnumerable<PriceSheetRowViewModel> Rows { get; set; }
    public IEnumerable<PriceSheetColumnViewModel> Columns { get; set; }
} 
```

公共类 PriceSheetColumnViewModel { public int Id { get; 放; } 公共字符串标题 { 获取；放; } }

```
public class PriceSheetRowViewModel 
    {

        public int RowNo { get; set; }
        public string Description { get; set; }
        public double?[] Prices { get; set; }

    } 
```

视图可以是这样的（view.cshtml 文件的一部分...）：

```
 ....
@model PriceSheetEditGridViewModel
...
                columns.Bound(o => o.Description ).Width(150);

                int i = 0;
                foreach (var col in Model.Columns)

{
                columns
                    .Bound(model => model.Prices).EditorTemplateName("PriceSheetCellPrice").EditorViewData(new { ColumnId = i })
                    .ClientTemplate("<span><#=Prices ? jsHelper.addCommas(Prices[" + i.ToString() + "]):null#></span>")
                    .Title(col.Title).Width(80);
                i++;
            }    

.... 
```

和`PriceSheetCellPrice.cshtml`编辑器模板文件（在 shared\editortemplates 文件夹中）：

```
 @model decimal?
@(Html.Telerik().NumericTextBox()
        .Name(ViewData.TemplateInfo.GetFullHtmlFieldName(string.Empty)+"["+ViewBag.ColumnId+"]")
                    .InputHtmlAttributes(new { style = "width:100%" })
})
        .EmptyMessage("")
        .DecimalDigits(0)
        .DecimalSeparator(",")
        .MinValue(0)
        .Value((double?) Model)
) 
```

# javascript - 如何为 HighCharts 中的堆栈柱形图格式化我的 json 数据

> ID：11472947
> 
> 赞同：2
> 
> 时间：2012-07-13T14:53:06.863
> 
> 标签：javascript, json, highcharts

这是我的json数据

```
var data = [
    {"unit":"a", "status":"Stopped / Idle", "val":21.2022222222222222},
    {"unit":"a", "status":"Working", "val":53.3066666666666667},
    {"unit":"a", "status":"Headland Turning", "val":0.04694444444444444444},
    {"unit":"a", "status":"Transport", "val":5.1425000000000000},
    {"unit":"b", "status":"Stopped / Idle", "val":334.7358333333333333},
    {"unit":"b", "status":"Working", "val":212.6386111111111111},
    {"unit":"b", "status":"Headland Turning", "val":26.2955555555555556},
    {"unit":"b", "status":"Transport", "val":0.00444444444444444444}
]; 
```

`unit`是类别

我希望数据可以按以下方式格式化，以便我可以插入`series`HighCharts 中的选项：

```
series: [{
                name: 'Stopped / Idle',
                data: [21.2022222222222222, 334.7358333333333333]},
            {
                name: 'Working',
                data: [53.3066666666666667, 212.6386111111111111]},
            {
                name: 'Headland Turning',
                data: [0.04694444444444444444, 26.2955555555555556]},
            {
                name: 'Transport',
                data: [5.1425000000000000, 0.00444444444444444444]}]
        }); 
```

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-13T16:06:19.123

```
var data = [
    {"unit":"a", "status":"Stopped / Idle", "val":21.2022222222222222},
    {"unit":"a", "status":"Working", "val":53.3066666666666667},
    {"unit":"a", "status":"Headland Turning", "val":0.04694444444444444444},
    {"unit":"a", "status":"Transport", "val":5.1425000000000000},
    {"unit":"b", "status":"Stopped / Idle", "val":334.7358333333333333},
    {"unit":"b", "status":"Working", "val":212.6386111111111111},
    {"unit":"b", "status":"Headland Turning", "val":26.2955555555555556},
    {"unit":"b", "status":"Transport", "val":0.00444444444444444444}
];
var seriesData = [];
var xCategories = [];
var i, cat;
for(i = 0; i < data.length; i++){
     cat = 'Unit ' + data[i].unit;
     if(xCategories.indexOf(cat) === -1){
        xCategories[xCategories.length] = cat;
     }
}
for(i = 0; i < data.length; i++){
    if(seriesData){
      var currSeries = seriesData.filter(function(seriesObject){ return seriesObject.name == data[i].status;});
      if(currSeries.length === 0){
          currSeries = seriesData[seriesData.length] = {name: data[i].status, data: []};
      } else {
          currSeries = currSeries[0];
      }
      var index = currSeries.data.length;
      currSeries.data[index] = data[i].val;
    } else {
       seriesData[0] = {name: data[i].status, data: [data[i].val]}
    }
} 
```

现在您已经`seriesData`并且`xCategories`可以使用类似的东西来实例化图表

```
 chart = new Highchart({chart: {renderTo: 'chart-div', 
                                   type: 'column'
                                  }, 
                           plotOptions: {column: {stacking: 'normal'}},
                           xAxis:{ categories: xCategories}, 
                           series: seriesData
                         }); 
```

编辑：这是 jsFiddle：http: [//jsfiddle.net/sujay/UMeGS/](http://jsfiddle.net/sujay/UMeGS/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T15:37:08.340

在 HighCharts 网站上，我导航到 Demo Gallery > HighChart demos 部分，然后单击页面左侧的 Stacked 列。从那里他们有一个指向[带有演示的 JSFiddle](http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/demo/column-stacked/)的链接，从那里我看到了与您相关的两段代码。

第一部分是`xAxis`HighChart 对象的属性。这是我将其更改为：

```
xAxis: {
  categories: ['Unit A', 'Unit B']
} 
```

这些将是您堆叠数据的每一列。

下一部分是`series`属性。这是您将要绘制到这些列中的数据传递的地方。它看起来像这样：

```
series: [{
  name: 'Stopped / Idle',
  data: [21.2022222222222222, 334.7358333333333333]
}, {
  name: 'Working',
  data: [53.3066666666666667, 212.6386111111111111]
}, {
  name: 'Headland Turning',
  data: [0.04694444444444444444, 26.2955555555555556]
}, {
  name: 'Transport',
  data: [5.1425000000000000, 0.00444444444444444444]                         
}] 
```

在此部分中，您指定特定类型数据的名称，然后指定您在`xAxis`属性中指定的每一列的值。

我很快就玩弄了一些选项，你可以用它做更多的事情，但这里是带有堆叠柱形图和你的数据[的 JSFiddle 。](http://jsfiddle.net/jasonmerino/H27rE/2/)

希望这可以帮助！

# jquery - Jquery - 一个自动动画滚动到页面底部的插件

> ID：11472949
> 
> 赞同：0
> 
> 时间：2012-07-13T14:53:11.797
> 
> 标签：jquery, plugins, scroll

我想知道你们中的一些人是否知道一个 jquery 插件，它可以自动动画滚动到页面底部。基本上可以做到这一点，但考虑到所有例外情况：

```
$bottom = 50;
function scroll() {
        $('html, body').animate({scrollTop:$bottom}, 4000, 'linear');
        $bottom = $bottom + 50;
        scroll();
}

scroll(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T14:57:18.857

[这是我最近在一个网站上使用的。](http://www.sycha.com/jquery-smooth-scrolling-internal-anchor-links)

只需在页面底部制作锚点，您应该会很好！

# html - 徘徊在分辨率之间

> ID：11472954
> 
> 赞同：1
> 
> 时间：2012-07-13T14:53:34.063
> 
> 标签：html, css, mobile, dynamic, resolution

我在不同的移动设备之间做了一些简单的样式设置，并且想知道根据分辨率进行更改的最佳方法是什么。

因为我的应用程序在低分辨率设备上看起来不错，但在高分辨率设备上字体很小，其他东西也很小。

我正在考虑根据分辨率使用一个样式表，但想知道这是否是最好的方法，或者是否有更好的方法来实现这种情况。

这些设备从新到旧都是黑莓，因此分辨率高低。

如果屏幕更大，是否还有只是扩大内容？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T14:58:16.367

您可以使用[媒体查询](http://www.w3.org/TR/css3-mediaqueries/)来定位 CSS 中的不同屏幕尺寸。

这是黑莓设备的列表[http://responsive.co.za/blackberry-specific-media-queries/](http://responsive.co.za/blackberry-specific-media-queries/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T14:55:55.270

您可以使用 CSS3 媒体查询来完成所有这些操作。

这里有一些资源

*   [http://brendanmckenzie.com/2012/06/there-is-no-mobile-framework](http://brendanmckenzie.com/2012/06/there-is-no-mobile-framework)
*   [http://css-tricks.com/snippets/css/media-queries-for-standard-devices/](http://css-tricks.com/snippets/css/media-queries-for-standard-devices/)
*   [http://html5boilerplate.com/mobile](http://html5boilerplate.com/mobile)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T15:33:30.860

您应该像他们说的那样创建媒体查询，但是如果您要为大量设备执行此操作和/或您的 css 文件变得很长，我会使用 if then 语句来执行此操作，这样每个设备就不必下载巨大的包含每个设备的所有媒体查询的 css 文件。

# javascript - Javascript 仅在带有警报时有效

> ID：11472961
> 
> 赞同：4
> 
> 时间：2012-07-13T14:54:11.823
> 
> 标签：javascript, alert

以下代码在播放器中加载 youtube 视频。

如果我删除两个“警报”，它就不再起作用了......

```
ytplayer = document.getElementById("ytPlayer");
alert('ok');
if (ytplayer) {
    alert('ok');
    loadVideo(url, start);
} 
```

有人能帮我吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-13T14:56:58.907

您可能在页面加载之前调用代码。随着警报，js 执行停止，允许页面加载。如果这是正确的，您需要查看`window.onload`回调或可能`document.ready`

```
window.onload = function(){
   // load the vid here
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T14:59:26.437

在页面完全加载后调用该函数。

```
window.onload = function() {
    loadVideo(url, start);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-17T14:16:33.227

我解决了以下问题：

```
ytplayer = document.getElementById("ytPlayer");

if (ytplayer) {
    setTimeout( function() { loadVideo(url, start); }, 1000);
} 
```

感谢您的回答。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-06-28T04:46:09.873

你用过 Ajax 请求吗？

如果是，那么把你的代码放在最后

```
AjaxObject.onreadystatechange = function () {
       if (AjaxObject.readyState == 4) {
           .
           .
           .
           .
           .

      // PUT HERE
        }
   } 
```

然后 IF NO 将您的代码放入函数中并返回 false 或 true

像这样

```
ytplayer = document.getElementById("ytPlayer");
alert('ok');
if (ytplayer) {
    //alert('ok');
    loadVideo(url, start);   
return true;     
} 
```

希望有帮助

# c# - 了解 Liskov 替换原则

> ID：11472962
> 
> 赞同：1
> 
> 时间：2012-07-13T14:54:13.223
> 
> 标签：c#, solid-principles

我试图通过反复阅读[维基百科](http://en.wikipedia.org/wiki/Liskov_substitution_principle)条目来确定我对上述原则的理解。

撇开仍然让我感到悲伤的协变和逆变的概念，维基百科还提到超类型的不变量必须保留在子类型和历史约束或历史规则中。基于这最后两个概念，我想出了这个小例子：

```
class Program
{
    static void Main(string[] args)
    {
        var fooUser = new FooUser();

        var fooBase = new FooBase("Serge");

        var fooDerived = new FooDerived("Serge");

        fooUser.Use(fooBase); //will print "Serge"
        fooUser.Use(fooDerived); //will print "New User"

        Console.ReadKey();
    }
}

public class FooUser
{
    public void Use(IFoo foo)
    {
        foo.DoSomething();
        Console.WriteLine(foo.Name);
    }
}

public interface IFoo
{
    string Name { get; }
    void DoSomething();
}

public class FooBase : IFoo
{
    public string Name { get; protected set; }

    public FooBase(string name)
    {
        Name = name;
    }

    public virtual void DoSomething()
    {
    }
}

public class FooDerived : FooBase
{
    public FooDerived(string name) : base(name)
    {
    }

    public override void DoSomething()
    {
        Name = "New Name";

        base.DoSomething();
    }
} 
```

所以我的问题是：基于上述两个概念，我是否违反了这个例子的原则？如果不是，为什么？

非常感谢您提前。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T15:46:16.783

要违反 LSP，您需要一个客户端类，该类对类接口做出一些假设。假设不能完全以正式的方式表达，有时它只是来自使用的上下文。

假设您有一个可枚举的类，它允许您添加元素。例如，客户端的假设可以是，如果它添加 N 个元素，则可以从集合中读取恰好 N 个元素。然后，您从您的集合中派生出一个集合，该集合在添加时会删除重复的元素。现在客户的期望是错误的，即使添加了 N 个元素，有时也可以读取 LESS THAN N 个元素。

对我来说，违反 LSP 需要一个定义一些期望的上下文。由于您的代码中没有任何期望，因此不会违反 LSP。

这种对上下文的需求还意味着两个类可能违反一个客户端上下文的 LSP，而相同的类可能不会在其他上下文中违反 LSP。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T15:05:01.263

您似乎没有在这里违反 LSP。我留下一个小窗口来怀疑，因为理论上我们对 的不变量一无所知`FooBase`，但是对这些结果进行合理的猜测不会看到明显的问题。

假设不变量很好，那么派生类允许值`Name`在基类不允许的对象生命周期内更改的历史原则很重要。如果不是因为一个小细节，这肯定会违反 LSP：`Name`有一个`protected`二传手。

受保护的设置器应该意味着作者`FooBase` *期望*派生类`Name`在对象的生命周期内更改值，即使基类没有碰巧这样做。`protected`将此与field进行对比，该字段`name`不能具有不同的访问级别来获取和设置其值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T15:06:02.153

这个例子还不够健壮，部分原因是 C# 没有一种简洁的方式来表达类不变量。或者，更确切地说，如果确实如此，我不知道。

我想说你没有违反不变量，因为 FooBase 没有保证 Name 不会改变或表示 Name 的允许值范围。恰恰相反——通过为 Name 包含一个受保护的设置器，FooBase 正在创建一个期望，即该值*可以*通过派生类的内部机制进行更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-16T13:16:57.813

LSP 违反本质上是违反，如果
1\. 超类型的不变量被子类型违反 OR
2\. 超类型的先决条件被子类型加强 OR
3\. Post 条件被 Sub 类型削弱。

上述三个条件必须在界面设计时通过正式的“契约式设计”预先确定。
在您的示例中， FooBase 没有定义任何扩展类要遵守的任何正式规则。
此外，名称设置器具有受保护的访问权限。因此，我不认为 LSP 被违反。

但

有时，如果针对测试用例分析 LSP 违规，也可能会有所帮助。

这个测试用例是否有意义：
fooUser.Use(fooBase); //将打印“Serge”
String nameDerived = fooUser.Use(fooDerived); //将打印“新用户”（假设返回名称）

断言（nameDerived 等于“Serge”）

如果存在这样的测试用例（作为规范所必需的），那么显然上述示例违反了 LSP。

在我的博客上更是如此：http: [//design-principle-pattern.blogspot.in/2013/12/liskov-substitution-principle.html](http://design-principle-pattern.blogspot.in/2013/12/liskov-substitution-principle.html)

# jsf-2 - 自动完成在某些情况下不起作用

> ID：11472963
> 
> 赞同：0
> 
> 时间：2012-07-13T14:54:16.760
> 
> 标签：jsf-2, primefaces

我正在使用带有 itemtip 选项的 primefaces 自动完成组件，在得到建议后，我选择了一个值作为示例姓氏，但我想在文本框中显示玩家的姓氏和名字，所以以这种方式尝试。

`itemLabel="#{p.lastName} #{p.firstName} "`与这两个有一些空间。

```
<p:autoComplete id="watermark" value="#{backingBean.object}"
                            size="40" completeMethod="#{backingBean.completeholder}"
                            var="p" 
                            itemLabel="#{p.lastName} #{p.firstName} " itemValue="#{p}" converter="player">
                            <f:facet name="itemtip">
                                <h:panelGrid columns="2" styleClass="cellsp-panel">
                                    <f:facet name="header">
                                        <p:graphicImage value="#{p.imagePath}" width="60"
                                            height="60" />
                                    </f:facet>

                                    <h:outputText value="LastName " style="font-weight:bold" />
                                    <h:outputText id="ln" value="#{p.lastName}" />

                                    <h:outputText value="FirstName " style="font-weight:bold" />
                                    <h:outputText id="fn" value="#{p.firstName}" />

                                </h:panelGrid>
                            </f:facet>
                            <p:ajax event="itemSelect" update="e,c">
                            </p:ajax>

                        </p:autoComplete> 
```

所以选择一个建议后，它会完美地显示玩家的姓氏和名字。但是一个问题被创建为 - 它在自动完成文本框中创建了一个空间，所以我需要使用退格键来删除这个空间，以便我可以搜索以获得建议。我该如何克服这个问题？

1.  我也在自动完成上使用水印，它仅在我使用像 itemLabel="#{p.lastName} 这样的单个 itemLabel 时才有效，否则它无法在自动完成中显示水印。

3.此外，当我使用不区分大小写的输入以便用户可以在不区分大小写的情况下进行搜索时，一旦我收到任何建议，并且仍然尝试键入一些密钥以进行进一步过滤，建议就会消失，如果我选择区分大小写，它会起作用默认方式。

1.  用户可以输入玩家的姓或名，但他仍然需要得到建议，我需要在以下方法中进行哪些修改？我已将姓氏与首字母存储为大写字母，因此我以这种方式使用 toUpperCase()

    public List completePlayer(String query) {
    列表建议 = new ArrayList();

    ```
     for(Player p : players) {  
            if(p.getlastName().startsWith(query.toUpperCase()))  
                suggestions.add(p);  
        }  

        return suggestions;  
    } 
    ```

我该如何克服这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T20:11:27.663

您的玩家比较正在解决这个问题：
Smith.startsWith("S") -> true
Smith.startsWith("SM") -> false

你想要的是：

```
if(p.getlastName().toUpperCase().startsWith(query.toUpperCase())) 
```

自动完成中的空间来自这一行：

```
itemLabel="#{p.lastName} #{p.firstName} " itemValue="#{p}" converter="player"> 
```

在结束引号之前，您在 itemLabel 中的 #{p.firstName} 之后有一个空格。

至于水印，我不知道。我从未尝试过使用自动完成功能。您能否包含您的 p:watermark 标记，以便我们查看它引用的内容？

# objective-c - 保存和加载数据

> ID：11472964
> 
> 赞同：1
> 
> 时间：2012-07-13T14:54:21.030
> 
> 标签：objective-c, xcode, nsuserdefaults

在我的游戏中，我使用 NSUserDefults 来保存用户高分。在我第一次完成游戏时，我的高分被设置为游戏分数，但每次之后游戏中的分数都会自动设置为高分。这里的奇怪之处在于，如果我的游戏得分为 0，那么我的高分将保持为最高分，但如果在某场比赛结束时，我的得分为 100 被设置为高分，但之后的比赛如果我的得分为 50，我的高分是设置为 50（虽然分数低于我的高分）。这是我的 viewdidload 代码：

```
 highScore = [[[NSUserDefaults standardUserDefaults] objectForKey:@"HighScore"] intValue ];
highScoreLabel.text = [NSString stringWithFormat:@"%d",highScore]; 
```

这是我的 checkIfHighscore 代码：

```
-(void)checkIfHighScore
{
    if(gameOverScore > highScore)
    {
        highScore = gameOverScore;
        [[NSUserDefaults standardUserDefaults] setObject:[NSNumber numberWithInt:highScore] forKey:@"HighScore"];
        [[NSUserDefaults standardUserDefaults] synchronize];

    }
    highScoreLabel.text = [NSString stringWithFormat:@"%d", highScore];
} 
```

问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T14:57:41.327

您的 highScore 加载表单`NSUserDefaults`将是`Object`type `id`，您应该将其转换为`NSNumber`，其次在您的`checkIfHighScore`方法中，您应该比较`highScore.intValue`，`gameOverScore`然后：

```
[[NSUserDefaults standardUserDefaults] setObject:[NSNumber numberWithInt:gameOverScore] forKey:@"HighScore"]; 
```

请注意您是如何混合数字对象和标量类型 ( `int`) 的，您不能使用`<`and`>`运算符，甚至不能`==`在 an`Object`和标量变量之间使用。

# apache - 用于普通 http tomcat 的 Apache ssl 前端提供不安全的内容

> ID：11472966
> 
> 赞同：2
> 
> 时间：2012-07-13T14:54:31.620
> 
> 标签：apache, tomcat, mod-proxy

我们已经将 Apache 设置为普通 http jboss(tomcat) 的 ssl 前端

```
<VirtualHost *:5555>
    ServerName my.server.com

    SSLEngine on
    SSLCertificateFile /x.crt
    SSLCertificateKeyFile /x.pem
    SSLProxyEngine on
    ...
    ...
    ProxyPass / http://my.server:8080/
    ProxyPassReverse / http://my.server.com:8080/
</VirtualHost> 
```

在我们的jsp中，我们有这样的东西：

```
<link href="/css/my.css" rel="stylesheet" type="text/css"> 
```

当我们从

```
https://my.server.com:5555 
```

告诉我们这个页面的浏览器有不安全的内容，因为它会从

```
http://my.server.com:5555/css/my.css 
```

我不想在 href 中使用绝对 URL。我可以以某种方式告诉tomcat使用来自apache的https而不在tomcat中设置ssl吗？或者是在 Apache 和 Tomcat 中设置 ssl 的最佳组合？

我已经尝试了 Dirk 指出的解决方案，但它仍然无法正常工作。

服务器.xml

```
<Connector port="8080" protocol="HTTP/1.1" enableLookups="false" proxyPort="5555" scheme="https" secure="true" /> 
```

我仍然收到有关不安全内容的错误。是因为 struts 1.1 没有使用 request.getScheme() 还是因为 Apache 和 Tomcat 之间的通信是纯 http 和 Apache 认为

```
<link href="/css/my.css" rel="stylesheet" type="text/css"> 
```

应该从下载

```
http://my.server.com:5555/css/my.css 
```

在将其发送回浏览器之前？

提前谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T15:24:13.700

我猜这个问题是你的（tomcat）服务器认为它仍然存在于 http 地址（你可以通过查看标题和 HTML 来确认）。

因此它在页面中包含对 http 地址的引用，而不知道请求来自 https 版本。

假设您想要所有流量 https（并且 http 路径被阻止和/或 tomcat 绑定到本地主机） - 您想要检查[http://tomcat.apache.org/tomcat-7.0-doc/proxy-howto.html](http://tomcat.apache.org/tomcat-7.0-doc/proxy-howto.html)如何告诉tomcat它不是生活在它可以看到的地址 - 而是在你从apache暴露给互联网的地址（即前门）。

你所追求的是proxyName、proxyPort以及scheme和secure。

[例如，请参见http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&cmd=displayKC&externalId=2007800](http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&cmd=displayKC&externalId=2007800)的选项 4 和 3 。

# oauth - SalesForce APEX 中 Crypto.generateMac() 的问题

> ID：11472970
> 
> 赞同：1
> 
> 时间：2012-07-13T14:54:40.570
> 
> 标签：oauth, salesforce, force.com

我们需要对使用 OAuth 1.0 的服务进行一些标注，并要求每个请求都使用 HMAC-SHA1 进行签名。

该服务没有任何 APEX 客户端 API。因此，我们必须手动完成。

很遗憾，

```
EncodingUtil.base64Encode(Crypto.generateMac('hmacSHA1', Blob.valueOf(data), Blob.valueOf(key))); 
```

返回与我们预期不同的字符串。我们将相同输入的输出与其他语言的库进行了比较。并且输出是不同的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T15:29:28.953

调用 OAuth 1.0 没有问题。这是用于签署您的请求的一些示例 Apex：

编辑：添加了附加代码

```
private Map<String,String> getUrlParams(String value) 
{
    Map<String,String> res = new Map<String,String>();
    if(value==null || value=='') 
    {
        return res;
    }
    for(String s : value.split('&')) 
    {
        List<String> kv = s.split('=');
        if(kv.size()>1) 
        {
            res.put(kv[0],kv[1]);
        }
    }
    return res;
}

private String createBaseString(Map<String,String> oauthParams, HttpRequest req) 
{
    Map<String,String> p = oauthParams.clone();
    if(req.getMethod().equalsIgnoreCase('post') && req.getBody()!=null && req.getHeader('Content-Type')=='application/x-www-form-urlencoded') 
        p.putAll(getUrlParams(req.getBody()));
    String host = req.getEndpoint();
    Integer n = host.indexOf('?');
    if(n > -1) 
    {
        p.putAll(getUrlParams(host.substring(n+1)));
        host = host.substring(0,n);
    }
    List<String> keys = new List<String>();
    keys.addAll(p.keySet());
    keys.sort();
    String s = keys.get(0)+'='+p.get(keys.get(0));
    for(Integer i=1; i<keys.size(); i++) 
        s = s + '&' + keys.get(i) + '=' + p.get(keys.get(i));

    return req.getMethod().toUpperCase() + '&' + EncodingUtil.urlEncode(host, 'UTF-8') + '&' + EncodingUtil.urlEncode(s, 'UTF-8');
}

public void sign(HttpRequest req) 
{
   nonce = String.valueOf(Crypto.getRandomLong());
   timestamp = String.valueOf(DateTime.now().getTime() / 1000);

   refreshParameters();

   String s = createBaseString(parameters, req);
   Blob sig = Crypto.generateMac('HmacSHA1', Blob.valueOf(s), 
      Blob.valueOf(consumerSecret+'&'+ (tokenSecret!=null ? tokenSecret : '')));

   signature = EncodingUtil.urlEncode(EncodingUtil.base64encode(sig), 'UTF-8');

   String header = 'OAuth ';
   for (String key : parameters.keySet()) 
   {
      header = header + key + '="'+parameters.get(key)+'", ';
   }
   header = header + 'oauth_signature="'+signature+'"';
   req.setHeader('Authorization',header);
} 
```

这可能会达到，但是否存在区分大小写的问题？注意我叫'HmacSHA1'而不是'hmacSHA1'

# image - 制作一个包含在一个大字符串中的链接数组

> ID：11472971
> 
> 赞同：0
> 
> 时间：2012-07-13T14:54:43.143
> 
> 标签：image, bash, shell, curl, wget

我有一个大字符串（来自网页的 html 代码）。

现在的问题是如何解析图像的链接。

我想制作一个包含该网页中图像的所有链接的数组。

我知道如何在 java 中执行此操作，但我不知道如何解析字符串并在 shell 中执行字符串操作。我知道有很多技巧，我想这很容易做到。

最后我想得到这样的东西

```
 #!/bin/bash

read BIG_STRING <<< $(curl some_web_page_with_links_to_images.com)

#parse the big string and fill the LINKS variable

    # fill this with the links to image somewhow (.jpg and .png only)
    #after the parsing the LINKS should look like this
    LINKS=("www.asd.com/asd1.jpg" "www.asd.com/asd.jpg" "www.asd.com/asd2123.jpg")

    #I need the parsing and to fill the LINKS variable with the links from the web page

    # get length of an array
    tLen=${#LINKS[@]}

    for (( i=0; i<${tLen}; i++ ));
    do
      echo ${LINKS[$i]}
    done 
```

谢谢，你的回复让我省了几天的挫败感

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T15:57:43.740

为什么不从正确的工具开始？解析 HTML 很困难，尤其是`sed`. 如果你有`mojo`来自 Mojolicious 项目的工具，你可以这样做：

```
mojo get http://example.com a attr href 
```

然后只需检查每行是否以`jpg`,`png`或其他结尾。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T15:07:53.100

很难提供比近似值更多的信息。让我们假设所有有趣的链接都是`href=""`属性，并且`href`每行最多有一个属性（而且链接也只有一行，实际上我不确定 URL 中是否允许换行。

假设您的源文件名为`test.html`.

以下应打印这些假设下的所有链接：

```
sed -n 's/.*\<href="\([^"]*\)".*/\1/p' test.html 
```

要了解它是如何工作的，您应该知道什么是正则表达式并阅读了关于 sed 的教程（特别是**s** ubstitute 命令的工作原理）

# c# - 设置文件系统权限

> ID：11472974
> 
> 赞同：2
> 
> 时间：2012-07-13T14:54:55.603
> 
> 标签：c#, .net-4.0

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.IO;
using System.Security.AccessControl;
namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            string Directoryd = "D:";
            string mydirectory = Directoryd + "\\" + "rs\\";
            if (!Directory.Exists(mydirectory))
            {
                Directory.CreateDirectory(mydirectory); 
            }
            DirectoryInfo di = new DirectoryInfo(mydirectory);
            DirectorySecurity ds = di.GetAccessControl();

            ds.AddAccessRule(new FileSystemAccessRule(@"*",FileSystemRights.FullControl,AccessControlType.Allow));
           di.SetAccessControl(ds);

        }
    }
} 
```

这是我的代码，当我执行此操作时，弹出窗口显示实际上，此代码是创建一个文件夹 rs 并将其权限设置为拒绝完全控制但在运行时出现错误消息 Some or all identity references could not be translate . 错误是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T15:01:47.723

您应该更改以下行：

```
 ds.AddAccessRule(new FileSystemAccessRule(@"*",FileSystemRights.FullControl,AccessControlType.Allow)); 
```

到：

```
 ds.AddAccessRule(new FileSystemAccessRule(@"Everyone",FileSystemRights.FullControl,AccessControlType.Allow)); 
```

此外，如果您查看以下[每个人组](http://social.msdn.microsoft.com/Forums/en-US/vbgeneral/thread/dc841874-b71b-4e1c-9052-06eb4a87d08f/)，则在下面有一个答案，建议您应该使用 SSID 而不是名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T15:00:03.303

尝试组“每个人”，而不是 *。

# php - 创建基本用户登录

> ID：11472980
> 
> 赞同：0
> 
> 时间：2012-07-13T14:55:22.430
> 
> 标签：php, forms, session, session-variables

我的代码有两种形式，为用户名和密码创建一个文本字段。php 脚本获取表单信息并将其发送到服务器以决定表单数据中的字符串是否与我想要的用户名和密码相对应。我还有一个注销按钮表单，该表单用于将用户注销的 logout.php 脚本。如果我单击注销按钮，它会将用户发送到我的 login.php 脚本并结束会话。如果我访问具有 logout.php 的站点，我无法让用户登录网站，也无法让用户访问 login.php 页面。这是我的代码：

登录php代码：

```
 <?php
               session_start();
               if($_SESSION['login'] == true)
               {
                header("Location:index.php");
               }
               else
               {
               if($_POST['username'] == 'username')
               {
                   if($_POST['pass'] == 'password')
                   {

                      $_SESSION['login'] = true;
                      header('Location:index.php');

                    }
               }
               }
       ?> 
```

登录表格：

```
 <form action="login.php" method="post">
        Username: <input type="text" name="username" /> </br>
        Password: <input type="password" name="pass" /> 
        <input type="submit" value="submit"/>
        </form> 
```

注销PHP代码：

```
 <?php 
     session_start();
     session_destroy();
     header('Location:index.php');
     ?> 
```

索引php代码：

```
 <?php
      session_start();
      if($_SESSION['login'] =! true || $_SESSION['login'] == "")
      {
          header('Location:login.php');
      }
    ?> 
```

索引表格代码：

```
 <form action="logout.php" method="post">
         <input type="submit" name="logout" value="logout" />
         </form> 
```

PHP 代码在显示任何内容之前列在 html 代码上方，因此某些表单操作会再次回调页面。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T15:08:10.697

您的主要问题是不正确的运算符`=!`-`index.php`正确使用`!=`“不等于”。查看更多： http: [//php.net/manual/en/language.operators.comparison.php](http://php.net/manual/en/language.operators.comparison.php)

您可以稍微清理一下 login.php 文件：

*登录.php*

```
session_start();
$redirect = false;
if($_SESSION['login'] == true) {
    $redirect = true;
} elseif (
    isset($_POST['username']) && 
    $_POST['username'] == 'username' && 
    $_POST['pass'] == 'password'
){
    $_SESSION['login'] = true;
    $redirect = true;
}
if ($redirect) {
    header("location:http://www.mydomain.com/index.php");
    die();
} 
```

您的登录表单很好，除了您`:`用于属性的地方。所有 HTML 元素属性都是`name="value"`-- 注意等号。所以你的表格：

```
<form action="login.php" method="post"> 
```

您在注销表单中正确设置了它。

您的目标之一是减少您使用的代码量。因此，如果您要多次执行相同的操作，您应该尝试将那段代码隔离为一个类、一个函数，或者只是在您包含的另一个文件中。为此，您可以将登录检查放在单独的文件中：

*安全.php*

```
session_start();
if(!isset($_SESSION['login']) || $_SESSION['login'] !== true) {
    header('location:http://www.mydomain.com/login.php');
    die();
} 
```

...然后用于`require_once`在您要求用户登录的任何页面上将其拉入：

*索引.php*

```
require_once('security.php');
// the rest of your index.php code here 
```

**文档**

*   PHP 比较运算符： http: [//php.net/manual/en/language.operators.comparison.php](http://php.net/manual/en/language.operators.comparison.php)
*   `require_once`- [http://php.net/manual/en/function.require-once.php](http://php.net/manual/en/function.require-once.php)
*   代码重用的一些基本技巧 - [http://www.techrepublic.com/article/10-tips-for-php-scripts-reuse-code-with-the-include-and-require-functions/5077715](http://www.techrepublic.com/article/10-tips-for-php-scripts-reuse-code-with-the-include-and-require-functions/5077715)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T15:03:40.517

登录表单的表单字段不好。

它应该是：

```
<form action="login.php" method="post">
    Username: <input type="text" name="username" /> </br>
    Password: <input type="password" name="pass" /> 
    <input type="submit" value="submit"/>
</form> 
```

我也认为你的布尔条件

```
if($_SESSION['login'] =! true || $_SESSION['login'] == "") 
```

应该

```
if($_SESSION['login'] != true || $_SESSION['login'] == "") 
```

试试看，如果不行，我们再看看。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T15:23:31.590

让我们再试一次:)

编辑：需要 die()（或 exit()），否则 PHP 会继续处理。

**登录.php**

```
if (empty($_SESSION['login']))
{
   // checking if username is transmitted and matching (same for password)
   if (   ( !empty($_POST['username']) && $_POST['username'] === 'username')
       && ( !empty($_POST['password']) && $_POST['password'] === 'password')
      )
   {
      $_SESSION['login'] = TRUE;
      header('Location:index.php');
      die();
   }      
}
else
{
 // if this matches, we are already loggged in.
 header('Location:index.php');
 die();
}

header('Location:login.php');
die(); 
```

**注销.php**

```
// check if Session exists, otherwise there is nothing to destroy
if (!empty($_SESSION))
{
unset($_SESSION);
}

header('Location:login.php');
die(); 
```

**索引.php**

```
 session_start();

  // if session doesn't exist we redirect to login
  if(empty($_SESSION['login']))
  {
      header('Location:login.php');
  } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T14:57:48.690

据我所知，您的“登录表单”不正确，您需要使用 '=' 而不是 ':'。（编辑：负评级是什么？）

此外，AFAIR Location 必须像`Location: http://www.example.com/index.php`

# python - 将 .py 文件编译为 .pyo 而不使用包装脚本

> ID：11472991
> 
> 赞同：12
> 
> 时间：2012-07-13T14:56:23.607
> 
> 标签：python

我正在研究将大量的 python 模块和包编译到 pyo 中。我知道这可以通过设置 PYTHONOPTIMIZE 环境变量或在启动时指定 -O 来实现。我想强制执行 pyo 而不是 pyc 以产生尽可能小的足迹。为了在我的部署模块中执行此操作，我必须创建一个包装脚本，该脚本使用 -O 选项启动实际脚本，因为需要在启动解释器之前指定环境变量。

有什么办法可以解决这个问题并以编程方式强制创建 pyo 吗？

亲切的问候，托尔斯滕

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-07-13T14:59:14.417

要预先*编译*所有模块，请运行以下命令：

```
python -O -m compileall /path/to/your/files 
```

[python`compileall`模块](http://docs.python.org/library/compileall.html)负责编译，开关[`-O`使其](http://docs.python.org/using/cmdline.html?highlight=#cmdoption-O)输出 .pyo 文件。

但是，您不能强制 Python 使用这些，除非`-O`为每次运行提供开关*或*设置[`PYTHONOPTIMIZE`环境变量](http://docs.python.org/using/cmdline.html?highlight=#envvar-PYTHONOPTIMIZE)。

请注意，所有 -O 标志所做的都是禁用`assert`语句并将`__debug__`标志设置为`False`（Python 将优化测试）。指定 -OO 并删除文档字符串。除非您使用过多的文档字符串大小或非常慢的调试代码，否则这些不会带来太大的速度差异或节省空间。

请参阅：[Python 优化（-O 或 PYTHONOPTIMIZE）有什么作用？](https://stackoverflow.com/questions/4777113/what-does-python-optimization-o-or-pythonoptimize-do)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2019-04-11T07:35:41.753

遗憾的是，从 3.5 版开始，编译优化只生成 .pyc 文件，而不生成 .pyo

> 在 3.5 版更改: legacy 参数只写出 .pyc 文件，而不是 .pyo 文件，无论 optimize 的值是什么。

来自[https://docs.python.org/3.6/library/compileall.html](https://docs.python.org/3.6/library/compileall.html)

# perl - 有人可以为我翻译这个写得很糟糕的 Perl 代码吗？

> ID：11472993
> 
> 赞同：3
> 
> 时间：2012-07-13T14:56:34.663
> 
> 标签：perl

我需要获得在这一点 Perl 代码中使用的算法，但我对 Perl 一无所知。通常这不是问题，因为我会研究语言，但是这个正则表达式的东西让我头疼！

有人可以对此进行伪代码吗？我只需要知道发生了什么，这样我就可以用其他东西来实现它，最好是 PHP 甚至 C++，但我会担心那部分。我只需要以某种方式破译这是在做什么：

```
$a = $ARGV[0];
$a =~ s/[^A-F0-9]+//simg;
@b = reverse split /(\S{2})/,$a;
$c = join "", @b;
$c .= "0000";
$d = hex($c) % 999999929;
print "$d\n"; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-13T15:26:44.827

有什么不好写的？它可以使用更好的 var 名称，但我不知道这是否可能（因为中间步骤似乎没有任何可命名的质量），只留下`split`. 伪代码几乎是一个字一个字的翻译。

```
$a = $ARGV[0];
$a =~ s/[^A-F0-9]+//simg;
@b = reverse split /(\S{2})/,$a;
$c = join "", @b;
$c .= "0000";
$d = hex($c) % 999999929;
print "$d\n"; 
```

应该

```
$a = $ARGV[0];                # Get a hex str from cmd line   E3:C9:D4
$a =~ s/[^A-F0-9]+//simg;     # Remove any non-hex digits     E3C9D4
@b = reverse $a =~ /(..)/sg;  # Extract "bytes"; reverse      D4, C9, E3
$c = join "", @b;             # Join them.                    D4C9E3
$c .= "0000";                 # Append two NULs               D4C9E30000
$d = hex($c) % 999999929;     # Convert from hex to number and modulus
print "$d\n";                 # Print the result (in decimal). 
```

稍微清楚一点：

```
$a = $ARGV[0];
$a =~ s/[^0-9A-Fa-f]+//g;
$a = join '', reverse $a =~ /(..)/sg;
$a .= "0000";
$a = hex($a);
$a %= 999999929;
print "$a\n"; 
```

* * *

这些片段中可能存在错误。在具有 32 位整数的 Perl 上，`hex`如果输入的十六进制数字超过四个，则会溢出。具有 64 位整数的 Perl 将处理 12 个十六进制数字。

* * *

您似乎已从[此处](http://social.msdn.microsoft.com/Forums/en-AU/vbgeneral/thread/a66f033e-2255-4678-9f79-a503c601d765)获取代码。这意味着将 MAC 地址作为输入，这意味着代码需要 64 位整数或[Math::BigInt](http://search.cpan.org/perldoc?Math::BigInt)才能工作。没有办法解决它，因为您想对 64 位值取模。

* * *

这是一种只适用于 64 位整数的 Perls 的简洁方法：

```
my $mac = $ARGV[0];
$mac =~ s/[^0-9A-Fa-f]+//g;
die length($mac) != 12;

# "123456789ABC" => 0xBC9A785634120000
my $hash = unpack('Q<', pack('H*', "0000$mac"));

$hash %= 999999929;
print "$hash\n"; 
```

为了可移植性，最好将 Math::BigInt 集成到早期版本中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T15:07:30.423

它正在寻找一组连接在一起的十六进制八位字节作为程序的第一个参数，并应用模数。

因此，如果程序被调用为：

```
$ myprog.pl A0B0
```

那么 in 的值`$c`将是`B0A00000`。因此， 的值`$d`应该是`0x396A6C8E`。

[这是由害怕pack](http://perldoc.perl.org/functions/pack.html)和 [unpack](http://perldoc.perl.org/functions/unpack.html)的人编写的一段特别糟糕的代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-13T15:07:31.093

```
$a = $ARGV[0]; # assign first command line arg to $a
$a =~ s/[^A-F0-9]+//simg; # delete non-hex from $a
@b = reverse split /(\S{2})/,$a; # split $a by 2 non-whitespace (saving them too) to array  @b and reverse it
$c = join "", @b; # join array @b to scalar $c
$c .= "0000"; # append 4 zeros to $c
$d = hex($c) % 999999929; # get modulo
print "$d\n"; # print it 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-13T15:14:04.260

```
$a = $ARGV[0]; #Read in the first argument on the command line
$a =~ s/[^A-F0-9]+//simg; #Substitute non hex numbers with nothing *
@b = reverse split /(\S{2})/,$a; #What is left in $a, split by 2 non-space characters
$c = join "", @b; # put the array b into $c
$c .= "0000"; 
$d = hex($c) % 999999929; #Convert $c to an integer and % with 999999929
print "$d\n"; 
```

*   simg = i：不区分大小写；g：全球；m：多行；s：单行；

简而言之，我们剥离第一个十六进制数，然后颠倒字节顺序（一次 2 个十六进制数）并对结果进行取模。

# php - 使用php在android上打开实时音频流

> ID：11472997
> 
> 赞同：3
> 
> 时间：2012-07-13T14:56:47.497
> 
> 标签：php, android, shoutcast

我们有shoutcast/icecast 音频流。我希望能够在我们的网站上提供一个链接，例如 mobiledroid.php，该链接将使用默认播放器打开。我[在另一个网站上](http://mobile.shoutcaststreaming.us/metal/)看到过这个，所以我知道这是可能的。

我假设它通过 php 文件使用 php 标头和流作为流？

* * *

使用 Brad 的说明，android 实际上提供了使用声音播放器打开的选项。好一个。

它也可以通过 PC 在 WMP 上播放，但不能在 android 上播放上述链接的播放方式

```
header("Content-type: audio/mpeg"); 
header("Transfer-Encoding: chunked"); 
header("Connection: close");

$sock = fsockopen($streamname,$port); //$streamname is the IP

fputs($sock, "GET $path HTTP/1.0\r\n"); //path in my case is /;stream.mp3
fputs($sock, "Host: $ip\r\n"); 
fputs($sock, "User-Agent: WinampMPEG/2.8\r\n"); 
fputs($sock, "Accept: */*\r\n"); 
fputs($sock, "Icy-MetaData:1\r\n"); 
fputs($sock, "Connection: close\r\n\r\n"); 

fpassthru($sock); 

fclose($sock); 
```

在android上，它说“对不起，这个播放器不支持这种类型的音频文件”

* * *

**更新 2：**

删除`"Transfer-Encoding"`将在 android 上播放，但由于直播流没有“Content-Length”，因此像往常一样需要很长时间才能以“Preparing”状态开始流式传输

`header("Transfer-Encoding: none");`也从上面的代码中删除：

引用布拉德：

> Android 2.3 及更高版本存在将 Transfer-Encoding 设置为“none”的问题。删除该硬设置的标头会将流放回分块传输编码。这适用于 Android 2.3+。最初我禁用了分块编码，因为 VLC 不支持它。Android 2.2 及更早版本似乎也不支持分块编码。

请注意，尽管它适用于 android，但大多数直播流需要很长时间才能开始。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-15T16:08:22.557

## 问题

传统上，您将提供一个播放列表文件，该文件将由您的浏览器保存，然后在任何配置为打开此类播放列表的播放器软件中打开。然后播放器将读取流的 URL，连接到它并开始流式传输。

在 Android 上，他们（出于某种疯狂的原因）选择不支持播放列表文件作为支持的媒体。因此，使用传统方法无法直接启动播放器。

## 解决方案

在 Android 上，如果您直接链接到 MP3 文件/流，而不是下载文件，默认操作似乎是打开媒体播放器并尝试流式传输。这意味着您可以轻松地直接链接到流的 URL（完全绕过播放列表步骤）。

有一个问题……使用 SHOUTcast 提供的流并不完全符合 HTTP。它们很接近，但并不完美。这里真正的挂断似乎是内容长度之一。通常，HTTP 服务器会发送`Content-Length`响应标头。对于流媒体，长度是未知的。有两种方法可以解决这个问题：

1.  使用分块传输编码。您可以通过设置以下标头来做到这一点：
    `Transfer-Encoding: chunked`
    然后，对流使用分块编码，一切顺利。
2.  不使用传输编码，并指定在资源传输完成时将关闭连接，并带有以下标头：
    `Transfer-Encoding: none`
    `Connection: close`

您的示例链接使用方法一。我也成功地使用了方法二。

一旦您的服务器正在使用有效的 HTTP，在 Android 上播放似乎是一件轻而易举的事。

## 执行

有几种方法可以实现此修复。您提到了一个 PHP 解决方案。如果 cURL 不起作用，您可以随时[`fsockopen()`](http://php.net/manual/en/function.fsockopen.php)或[`stream_socket_client()`](http://www.php.net/manual/en/function.stream-socket-client.php)直接建立 TCP 连接，并自己处理传入的流数据。从那里，您只需发送正确的响应标头并在数据进入时中继数据。请记住，每个连接的客户端都将运行一个 PHP 实例，并且每个实例也会连接到您的服务器。这并不理想，但取决于你有什么可用的，可能是你唯一的方法。