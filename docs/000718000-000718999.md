# StackOverflow 问答 000718000-000718999

# .net - Reflection.Emit - 从堆栈中访问最顶层但只有一个项目

> ID：718003
> 
> 赞同：9
> 
> 时间：2009-04-04T23:07:47.017
> 
> 标签：.net, reflection.emit

.NET 中有没有办法使用`Reflection.Emit`, 来访问堆栈中最顶层但只有一个的项目？因此，如果 A 是最上面的，然后是 B - 我想处理 B 然后是 A。在 A*上方*复制 B 会很好（因为当我到达第二个 B 时，我可以简单地“弹出”第二个 B）。

目前，我正在声明一个本地：

```
 LocalBuilder loc = il.DeclareLocal(typeof(Foo));
    il.Emit(OpCodes.Stloc, loc); // store and pop topmost stack item
    // work with (pop) previous stack item 
    il.Emit(OpCodes.Ldloc, loc); // push old topmost stack item 
```

是否有不需要显式本地的路线？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-05T03:05:00.787

我不这么认为。在 IL 中没有任何指令，如 swap 可以让你做你想做的事。为什么你认为使用本地人是令人反感的？如果 JIT 编译器足够好，这不会导致任何比在 IL 中使用假设交换操作更慢的机器代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T07:09:36.143

+1 获取 kvbs 答案，请参阅： http: [//www.codeproject.com/KB/msil/msilenhancement.aspx](http://www.codeproject.com/KB/msil/msilenhancement.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-05T07:18:47.180

与 kvb 所说的一致，您可以尝试一个小功能来进行一些重新排序。不确定它是否会更快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-25T04:24:19.223

我遇到了同样的问题。我想生成一个相当大的方法，并且我经常想“交换”以存储计算值。我对出现在 ildasm 中的大量当地人感到不满，并注意到 BeginScope/EndScope 没有任何帮助。我最终为我的方法的上下文创建了一个本地“交换”，并为每个交换操作重用它。它使生成的 IL 更干净；不确定它是否对性能有任何有意义的影响。

# database - 寻找开源图（如数据结构）数据库引擎

> ID：718007
> 
> 赞同：4
> 
> 时间：2009-04-04T23:08:44.877
> 
> 标签：database, open-source, graph-theory

我正在编写一个操作某种社交网络数据的应用程序，因此理想的底层数据结构是加权有向图。我想直接对数据进行操作（和搜索），而不是先将整个图形加载到内存中并在之后进行序列化。

这可以使用标准 SQL 数据库或键/值存储来模拟，但这会非常低效（对于我想使用的图遍历算法，例如最短路径等）。

由于谷歌搜索没有找到任何有用的结果，因此我有点想自己写，但我更愿意使用现有的解决方案（如果有的话，我错过了），而不是重新发明轮子。该项目是为了娱乐/个人研究，因此软件必须是开源的（并且最好能够在 Linux 下运行）。

那么，有没有符合上述描述的项目？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-05T00:55:51.877

如果您使用的是 Java，您可以尝试[http://neo4j.org/](http://neo4j.org/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T23:41:47.123

[ODBMS](http://en.wikipedia.org/wiki/Comparison_of_object_database_management_systems)怎么样？db40 具有 Java 和 .NET 实现，因此两者都在 Linux 上运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T23:19:52.933

您还可以将图形视为节点数组。每个节点存储其兄弟节点的列表。

因此，您可以简单地在图表中为每个节点存储 1 个文件。然后该文件的内容是它连接到的节点列表（自定向以来指向）。

然后你可以根据需要读入一个节点。

这使您可以执行诸如遍历整个树之类的操作，同时一次仅在内存中保留一个节点。

# programming-languages - 作为语言基准的微不足道的数学问题

> ID：718011
> 
> 赞同：4
> 
> 时间：2009-04-04T23:11:21.907
> 
> 标签：programming-languages, benchmarking

为什么人们坚持使用微不足道的数学问题，例如在斐波那契数列中寻找数字作为语言基准？这些通常不会针对相对论速度进行优化吗？首当其冲的瓶颈不是通常在 I/O、系统 API 调用、对字符串和结构的操作、处理大量数据、抽象的面向对象的东西等方面吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-04T23:15:52.193

这是对过去的回归，当时我们现在称之为基础数学的编译器技术仍在迅速发展。

现在，编译器的演变更侧重于为小众操作、64 位数学等开发新指令。

但是，在评估首次启动 Java 时热点编译器的效率以及评估 .NET 与 C/C++ 的效率时，您提到的微基准测试非常有用。

您关于 I/O 和系统调用可能是瓶颈的建议是正确的，至少对于某些问题来说是正确的。但我注意到您建议使用字符串操作。一个人无关紧要的微观基准是另一个人的关键绩效指标。

编辑：ps，我还记得使用 linpack 和其他微基准来比较 JVM 的版本，并比较 JVM 的供应商。从 v4 到 v5，性能有了很大的飞跃，我猜 JIT 编译器变得更有效了。此外，IBM 的 JVM 在 Windows-x86 上当时领先于 Sun。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-04T23:34:35.923

因为如果你想对语言/编译器进行基准测试，这些“数学问题”是生成代码“裸速”的良好指标。他们要么使用迭代解决方案，这是一个紧密的循环，表明编译器将指令推送到处理器的能力如何，要么他们使用递归解决方案，它表明它如何处理短函数的递归调用（内联、尾递归等）（尽管通常也使用 Ackermann 函数）。

通常，该语言的基准测试套件还包含对其他部分进行基准测试的测试 - 例如。gzip 压缩、文本搜索、对象创建、虚函数调用、异常抛出/捕获基准。

您注意到的其他事情，系统调用和 IO 通常不包括在内，因为

*   系统调用实际上并没有那么慢 - 应用程序不会在内核中花费大量时间，除非专门针对它们进行测试或程序出现严重问题

*   系统调用和 IO 性能不取决于语言，而是取决于操作系统和硬件

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-04T23:25:09.940

我认为一个简单的、完善的算法将消除基准有偏见（无论是通过无知还是恶意）偏向一种语言的可能性。用两种完全一样的语言编写复杂的程序是非常困难的。例如，在 c# 与 java 中测试多线程应用程序的效率之类的东西，需要熟练掌握多线程开发这两种语言的开发人员，并且仍然存在关于基准应用程序是否正确代表一般情况的问题，或者它是否歪曲只有一种语言可以很好地处理的特殊情况。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-05T03:54:49.980

回到当 eratosthanes 的筛子是 C 编译器的流行基准时，我认为如果编译器作者之一能够识别筛子代码并用预先计算的查找替换它会很有趣。

# c++ - 切换语句使用

> ID：718029
> 
> 赞同：2
> 
> 时间：2009-04-04T23:25:35.180
> 
> 标签：c++, c, windows, winapi

我应该使用这种形式的 switch 语句：

```
 switch(msg)
  {
    case WM_LBUTTONDOWN:
    {
           char szFileName[MAX_PATH];
           HINSTANCE hInstance = GetModuleHandle(NULL);
           GetModuleFileName(hInstance, (LPWCH)szFileName, MAX_PATH);
           MessageBox(hwnd, (LPCWSTR)szFileName, L"This program is:", MB_OK | MB_ICONINFORMATION);
    }
    break;

    case WM_CLOSE:
        DestroyWindow(hwnd);
    break;
    case WM_DESTROY:
        PostQuitMessage(0);
    break;
    default:
        return DefWindowProc(hwnd, msg, wParam, lParam);
  }
  return 0; 
```

或者为第一个案例常量创建一个函数？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-04T23:28:22.943

你如何拥有它并没有错，但它可能是调用函数的更简洁的代码，因此你可以将函数保持在合理的大小。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-05T00:36:54.807

Also, take a look at [message crackers](http://www.codeproject.com/KB/winsdk/msgcrackwizard.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-04T23:50:08.243

What you going to do when will hadle 20 or 50 window messages?
Maybe it right time for create map - events on functions ( fuctors ) and call them?
Or start to use rule - one message = one function call.

```
char szFileName[MAX_PATH];
HINSTANCE hInstance = GetModuleHandle(NULL);
GetModuleFileName(hInstance, (LPWCH)szFileName, MAX_PATH);
MessageBox(hwnd, (LPCWSTR)szFileName, L"This program is:", MB_OK | MB_ICONINFORMATION); 
```

Could you explain this strange trick with convetation (LPCWSTR)szFileName. Why you don't use array wchar_t instead casting? - you will have big problem with long paths ( path_length > MAX_PATH / sizeof( wchar_t ) )

One reccomendation - avoid to use casts in general and C-style casts in particulary.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-04T23:28:28.403

如果您要问是否应该将第一种情况下的代码转换为函数，那么肯定是的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-04T23:29:27.340

好吧，这取决于您还有多少其他案例。

Something as small as that, I would say it is not worth it to make it a function, but if your switch statement contains more cases, it will just get ugly, especially if a lot of the cases has multiple lines like that. Putting it into a function would clean it up and make your code look nicer.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-04T23:44:15.543

One of the most important things I'd say would be consistency. If you create a function for LBUTTONDOWN then create a function for everything. This way there is a predictable pattern for where to find stuff if it breaks.

Related to the topic at hand:

I personally find an if / else if pattern to work better, as it eliminates the problem of a forgotten break:

```
if (msg == WM_LBUTTONDOWN) {
    // your code here
    return 0;
} else if (msg == WM_DESTROY) {
    PostQuitMessage(0);
    return;
} else if (msg == WM_KEYDOWN) {
    if (wp == VK_F1) {
        DoSomething();
        return;
    }
}
return DefWindowProc(hWnd, msg, wp, lp); 
```

It's really up to you, in the end.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-05T07:24:21.647

I would probably declare a map and use functors for every message:

```
typedef std::map<UINT, boost::function<int (HWND, WPARAM, LPARAM) > > messageFuncs_t;
messageFuncs_t messageFuncs; 
```

Then, when the window class is created, just add a new function for each message:

```
messageFuncs[WM_LBUTTONDOWN] = &onMouseDownEvent; 
```

... And then implement the message loop thus:

```
messageFuncs_t::iterator fun = messageFuncs.find(msg);
if(fun != messageFuncs.end())
    return (*fun)(hWnd, wparam, lparam);
else
    return DefWindowProc(hWnd, msg, wp, lp); 
```

... Or whatever works. Then it's easy to add new messages, and the work for each is delegated to a function. Clean, concise, and makes sense.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-04T23:27:57.140

你错过了第一个**案例的****休息**时间。除此之外，我肯定会将该代码放在单独的函数中。

 *** * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-04T23:58:09.860

It's fine, but I generally don't like mixing styles and indentations. If I needed to bracket one case I'd probably bracket them all and keep the indentation consistent.

Also bb is right, you should use wchar_t array instead of char in that case.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-05T08:09:07.840

I'm writing fairly many Win32 message crackers such as these switches.

My rule of thumb is: Wiring up the behavior goes into the switch, behavior into a separate function. That usually means the switch contains the decision whether this command should be handled (e.g. testing for sender ID), and "prettyfying" the parameters.

So in that particular case, a separate function.

The original motivation is that I often end up triggering the behavior in other circumstances (e.g. "when no file name has been specified and the dialog is called with the `moon` parameter set to `full`, show the SaveAs dialog immediately").

# .net - 如何强制我的 WPF 主窗口在 XP 机器上具有 Vista 外观？

> ID：718031
> 
> 赞同：1
> 
> 时间：2009-04-04T23:27:15.007
> 
> 标签：.net, wpf, user-interface, windows-vista

我正在开发一个 WPF 应用程序，我想知道主窗口是否有可能具有 Vista 外观。MS Live Messenger 和谷歌的 Chrome 等一些应用程序已经做到了这一点。

有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-04T23:33:16.660

您可以加载“theaero.normalcolor.xaml”主题。

这是一篇相关的文章：

[强制 WPF 使用特定的 Windows 主题](http://arbel.net/blog/archive/2006/11/03/Forcing-WPF-to-use-a-specific-Windows-theme.aspx)

如果您还想更改窗口“家具”（标题栏等），请查看这篇文章：

[自定义窗口控件 - GlassWindow - 源代码](http://blog.pixelingene.com/?p=23)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T23:36:15.920

Live Messenger 和 Chrome 不使用 WPF；

我很确定在框架中没有办法做到这一点，也许您可​​以创建自己的控件或至少为现有控件创建主题，并记住 WPF 没有限制:)

# debugging - 最佳错误修复/错误查找策略 - 所有语言

> ID：718038
> 
> 赞同：1
> 
> 时间：2009-04-04T23:29:28.307
> 
> 标签：debugging, language-agnostic, error-handling

我在与其他一些更有经验的程序员一起冲浪时发现，他们在（他们的）代码中发现（他们的）错误时都有不同的策略。

而且我的意思不是理解编译器错误消息，而是理解错误消息发生的原因 - 立即通过遵循代码流并定位语义错误。这听起来太容易了。

问题是：东西往往会变得巨大。我无法遵循所有 3000 行代码并牢记所有内容，包括为 GUI 自动生成的代码。即使我将片段分开，重新开始并重新阅读所有内容仍然太过分了。

我只是想知道最常见的做法是什么让东西正常工作:)。如果你不明白为什么编译器会抛出错误信息，你会怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-04T23:42:48.603

我最好的策略是有多种策略。也就是说，我最好的策略是：

*   假设什么。任何你确信无疑的东西都是虫子藏身的岩石。如果你从不把石头翻过来，你就永远找不到虫子。
*   形成假设并检验它们。通过测试它们，我的意思是专门提出一个你可以执行的实验，如果（且仅当）你的假设是正确的，它将显示一个结果。如果它是错误的，则有所不同。
*   每隔几年就会花一个周末观看科伦坡的旧剧集。
*   不要被评论所吸引；只相信代码。
*   采取婴儿步骤。咬得比你能咀嚼的多就意味着你会窒息。
*   定义问题，直到它有一个锋利的尖端。很多时候，这会给你蝙蝠的解决方案。无论如何，你几乎没有机会解决你无法定义的问题。
*   确保您可以重现该问题。找到能重现它的最简单的案例。
*   找到最接近你的最简单的失败案例。
*   记录将回答问题的数据，而不仅仅是填满空间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-04T23:34:43.973

编译器错误不是错误，它们是你的朋友。所有程序员都害怕的时刻是他们的代码编译和链接没有错误，他们必须实际运行该死的东西。那是错误开始出现的时候。

编译器错误指定发生错误的实际行（通常为加或减一）。他们通过分析语法来做到这一点，他们不分析“代码流”或语义。作为程序员，你的任务是纠正语法；错误存在于语义中，只有在程序已编译并正在运行时才能对其进行调查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T23:40:12.727

如果您不明白编译器为何抛出错误消息，则需要将消息复制到 stackoverflow 或 Google 搜索框中。除了一些值得注意的例外，编译器是我们的朋友......我认为......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-05T08:04:05.137

将您的代码分成*有意义*的小部分。

关键是有意义的，你应该能够记住一个部分的作用，而无需再次阅读它的代码。

# javascript - CouchDB 视图出错

> ID：718039
> 
> 赞同：2
> 
> 时间：2009-04-04T23:31:04.967
> 
> 标签：javascript, ruby, views, couchdb

我一直在玩 CouchDB（和 RelaxDB rub​​y​​ 库），但是创建一个视图然后尝试访问它会导致一个令人讨厌的非特定错误。我退了一步，因为我认为 RelaxDB 可能与我正在使用的 CouchDB 版本（0.8.1）不兼容，但即使我创建了一个新数据库和等效视图并通过手动点击 URL 来调用它，它仍然没有工作。

```
[info] [<0.13529.0>] HTTP Error (code 500): {'EXIT',
                    {function_clause,
                     [{couch_httpd,handle_db_request,
                       [{mochiweb_request,#Port<0.9282>,'GET',
                         "/hello/_design/app/_view/Accounts_all?reduce=false",
                         {1,1},
                         {2,
                          {"accept",
                           {'Accept',"*/*"},
                           nil,
                           {"host",{'Host',"localhost:5984"},nil,nil}}}},
                        'GET',
                        {"hello",<0.157.0>,
                         ["_design","app","_view",
                          "Accounts_all"]}]},
                      {couch_httpd,handle_request,2},
                      {mochiweb_http,headers,4},
                      {proc_lib,init_p_do_apply,3}]}} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-05T03:55:56.170

我认为您正在使用 0.9 API 和 0.8 版本的软件。请参阅 wiki [Breaking Changes](http://wiki.apache.org/couchdb/Breaking_changes)文档。您需要正在访问`/hello/_view/app/Accounts_all`，或考虑升级到新发布的 CouchDB 0.9。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T23:50:03.517

检查日志文件以获取更具体的信息；IIRC 外部响应只是给 500 以防止将配置信息泄露给外人。如果这对您没有帮助，请编辑问题以包含您发现的内容，看看我们是否有任何人可以解决这个问题。

# python - 如何为 Python 安装 SimpleJson 包

> ID：718040
> 
> 赞同：37
> 
> 时间：2009-04-04T23:31:10.690
> 
> 标签：python, simplejson

[http://pypi.python.org/pypi/simplejson](http://pypi.python.org/pypi/simplejson)

我只是潜入 Python 世界，想做一个简单的 twitter 应用程序，需要安装 simplejson，但不知道如何设置它并让它工作..

我在 Windows 系统上

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-04-04T23:54:42.240

我会推荐[EasyInstall](http://pypi.python.org/pypi/setuptools#windows)，一个 Python 的包管理应用程序。

安装 EasyInstall 后，您应该能够转到命令窗口并键入：

```
easy_install simplejson 
```

这可能需要先将 easy_install.exe 放在您的 PATH 上，我不记得 EasyInstall 设置是否为您执行此操作（类似于`C:\Python25\Scripts`）。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2013-05-14T08:39:32.250

真正简单的方法是：

```
pip install simplejson 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-04-05T00:12:08.783

如果您安装了 Python 2.6，那么您已经有了 simplejson - 只需 import `json`; 这是同一件事。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-10-12T19:12:25.343

您可以像这样将 json 导入为 simplejson：

```
import json as simplejson 
```

并保持向后兼容性。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-09-09T08:16:35.143

下载源码，解压到目录，执行python setup.py install。

# ruby-on-rails - 社区引擎和小 mce：未定义的局部变量或方法错误

> ID：718053
> 
> 赞同：0
> 
> 时间：2009-04-04T23:41:42.803
> 
> 标签：ruby-on-rails, plugins, tinymce, rails-engines

我在加载主页时做了一些导致此错误的事情：

未定义的局部变量或方法`javascript_include_tiny_mce_if_used'

我基本上是在我的项目的开始。我正在使用 Rails 2.3，并解决了调试问题，并很好地加载了主页和其他用户配置文件。我正在使用 resource_controller 插件添加另一个用例，当此错误发生时，我无法找出来源。由于某种原因，似乎没有加载 CE 的 tiny_mce 插件，但是其他插件，包括 haml。

这是一个完整的堆栈跟踪：

```
/Users/dr/myapp/app/views/shared/_scripts_and_styles.html.haml:36:in `_run_haml_app47views47shared47_scripts_and_styles46html46haml_locals_object_scripts_and_styles'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_view/renderable.rb:34:in `send'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_view/renderable.rb:34:in `render'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_view/base.rb:301:in `with_template'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_view/renderable.rb:30:in `render'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_view/renderable_partial.rb:20:in `render'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/benchmarking.rb:26:in `benchmark'
/Users/dr/myapp/vendor/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/opt/local/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/Users/dr/myapp/vendor/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/benchmarking.rb:26:in `benchmark'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_view/renderable_partial.rb:19:in `render'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_view/template.rb:194:in `render_template'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_view/renderable_partial.rb:44:in `render_partial'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_view/partials.rb:184:in `render_partial'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_view/base.rb:262:in `render_without_haml'
/opt/local/lib/ruby/gems/1.8/gems/haml-2.0.9/lib/haml/helpers/action_view_mods.rb:12:in `render_without_active_scaffold'
/opt/local/lib/ruby/gems/1.8/gems/haml-2.0.9/lib/haml/helpers.rb:57:in `non_haml'
/opt/local/lib/ruby/gems/1.8/gems/haml-2.0.9/lib/haml/helpers/action_view_mods.rb:12:in `render_without_active_scaffold'
/Users/dr/myapp/vendor/plugins/active_scaffold/lib/extensions/action_view_rendering.rb:61:in `render'
/Users/dr/myapp/app/views/layouts/application.html.haml:12:in `_run_haml_app47views47layouts47application46html46haml'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_view/renderable.rb:34:in `send'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_view/renderable.rb:34:in `render'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_view/base.rb:301:in `with_template'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_view/renderable.rb:30:in `render'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_view/template.rb:194:in `render_template'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_view/base.rb:260:in `render_without_haml'
/opt/local/lib/ruby/gems/1.8/gems/haml-2.0.9/lib/haml/helpers/action_view_mods.rb:14:in `render_without_active_scaffold'
/Users/dr/myapp/vendor/plugins/active_scaffold/lib/extensions/action_view_rendering.rb:61:in `render'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_view/base.rb:347:in `_render_with_layout'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_view/base.rb:257:in `render_without_haml'
/opt/local/lib/ruby/gems/1.8/gems/haml-2.0.9/lib/haml/helpers/action_view_mods.rb:14:in `render_without_active_scaffold'
/Users/dr/myapp/vendor/plugins/active_scaffold/lib/extensions/action_view_rendering.rb:61:in `render'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/base.rb:1241:in `render_for_file'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/base.rb:937:in `render_without_benchmark'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/benchmarking.rb:51:in `render_without_active_scaffold'
/Users/dr/myapp/vendor/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/opt/local/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/Users/dr/myapp/vendor/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/benchmarking.rb:51:in `render_without_active_scaffold'
/Users/dr/myapp/vendor/plugins/active_scaffold/lib/extensions/action_controller_rendering.rb:13:in `render'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/base.rb:1317:in `default_render'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/base.rb:1323:in `perform_action_without_filters'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/filters.rb:617:in `call_filters'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/filters.rb:638:in `run_before_filters'
/Users/dr/myapp/vendor/plugins/community_engine/lib/localized_application.rb:22:in `set_locale'
/Users/dr/myapp/vendor/rails/activesupport/lib/active_support/callbacks.rb:178:in `send'
/Users/dr/myapp/vendor/rails/activesupport/lib/active_support/callbacks.rb:178:in `evaluate_method'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/filters.rb:186:in `call'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/filters.rb:635:in `run_before_filters'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/filters.rb:615:in `call_filters'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/filters.rb:610:in `perform_action_without_benchmark'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/Users/dr/myapp/vendor/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/opt/local/lib/ruby/1.8/benchmark.rb:308:in `realtime'
/Users/dr/myapp/vendor/rails/activesupport/lib/active_support/core_ext/benchmark.rb:17:in `ms'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/benchmarking.rb:68:in `perform_action_without_rescue'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/rescue.rb:160:in `perform_action_without_flash'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/flash.rb:141:in `perform_action'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/base.rb:523:in `send'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/base.rb:523:in `process_without_filters'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/filters.rb:606:in `sass_old_process'
/opt/local/lib/ruby/gems/1.8/gems/haml-2.0.9/lib/sass/plugin/rails.rb:19:in `process'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/base.rb:391:in `process'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/base.rb:386:in `call'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/routing/route_set.rb:433:in `call'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:88:in `dispatch'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:111:in `_call'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:82:in `initialize'
/Users/dr/myapp/vendor/rails/activerecord/lib/active_record/query_cache.rb:29:in `call'
/Users/dr/myapp/vendor/rails/activerecord/lib/active_record/query_cache.rb:29:in `call'
/Users/dr/myapp/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb:34:in `cache'
/Users/dr/myapp/vendor/rails/activerecord/lib/active_record/query_cache.rb:9:in `cache'
/Users/dr/myapp/vendor/rails/activerecord/lib/active_record/query_cache.rb:28:in `call'
/Users/dr/myapp/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb:361:in `call'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/vendor/rack-1.0/rack/head.rb:9:in `call'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/vendor/rack-1.0/rack/methodoverride.rb:24:in `call'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/params_parser.rb:15:in `call'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/rewindable_input.rb:25:in `call'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/session/abstract_store.rb:122:in `call'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/reloader.rb:9:in `call'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/failsafe.rb:11:in `call'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/vendor/rack-1.0/rack/lock.rb:11:in `call'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/vendor/rack-1.0/rack/lock.rb:11:in `synchronize'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/vendor/rack-1.0/rack/lock.rb:11:in `call'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:106:in `call'
/Users/dr/myapp/vendor/rails/railties/lib/rails/rack/static.rb:31:in `call'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/vendor/rack-1.0/rack/urlmap.rb:46:in `call'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/vendor/rack-1.0/rack/urlmap.rb:40:in `each'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/vendor/rack-1.0/rack/urlmap.rb:40:in `call'
/Users/dr/myapp/vendor/rails/railties/lib/rails/rack/log_tailer.rb:17:in `call'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/vendor/rack-1.0/rack/content_length.rb:13:in `call'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/vendor/rack-1.0/rack/chunked.rb:15:in `call'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/vendor/rack-1.0/rack/handler/mongrel.rb:61:in `process'
/opt/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:159:in `process_client'
/opt/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:158:in `each'
/opt/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:158:in `process_client'
/opt/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `run'
/opt/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `initialize'
/opt/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `new'
/opt/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:285:in `run'
/opt/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `initialize'
/opt/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `new'
/opt/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/lib/mongrel.rb:268:in `run'
/Users/dr/myapp/vendor/rails/actionpack/lib/action_controller/vendor/rack-1.0/rack/handler/mongrel.rb:34:in `run'
/Users/dr/myapp/vendor/rails/railties/lib/commands/server.rb:111
/opt/local/lib/ruby/vendor_ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require'
/opt/local/lib/ruby/vendor_ruby/1.8/rubygems/custom_require.rb:31:in `require'
script/server:3 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-06T01:14:00.513

堆栈跟踪对调查您的问题非常有帮助。此外，如果您正确使用具有小型独立提交的 SCM，您可能需要回顾一下您所做的导致问题的代码更改。恐怕没有细节，我无法提供更具体的答案。

# java - 获取 Java 中使用的调用名称

> ID：718057
> 
> 赞同：2
> 
> 时间：2009-04-04T23:43:29.180
> 
> 标签：java, command-line, args

我正在尝试找到一种复制此 C 功能的通用方法：

```
int main(int argc, char** argv){
    fprintf(2,"%s: error you did something wrong.\n", argv[0]);
    return 1;
} 
```

在爪哇。到目前为止，唯一的方法是将其硬编码到应用程序中，这很难看。我想得到类似的东西：

```
someObj.getClass().getSimpleName(); 
```

在我的静态主目录中，不参考我自己的课程。

这甚至可能吗？

## 编辑

我搜索了一个好小时并没有打开这个。

重复的问题，请参阅[Java 中的 $0（程序名称）？发现主要课程？](https://stackoverflow.com/questions/41894/0-program-name-in-java-discover-main-class)求答案

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-04T23:52:30.687

java 查找要在其中运行的类的方式`static void main()`是通过传递给 java 可执行文件（和类路径）的名称。因此，除非传递了正确的名称，否则不可能进行主运行。

*好吧，除非找到的 main 调用类似“FooBar.main()”或使用类加载器来找到它。

即使这样，由于 main 是静态的并且静态函数不是虚拟的，所以调用任何 main 都是因为 main 是在该类上调用的。因此，在您的代码中，名称（未将 args 传递给 main）只是该`main`函数所在的类的名称。

所以永远不会有错误，所以永远不需要找到名字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T00:01:13.520

我唯一能想到的是，你确定哪个线程是主线程，获取那个线程的堆栈跟踪，然后回到堆栈顶部并询问元素的类名和方法名，看看它是否是你想要什么。

不过，这很恶心。我会重新考虑最初的要求，看看是否没有更直接的方法来实现你想要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T00:09:19.663

我不认为这是可能的。最简单的打印方法是使用 MyClass.class.getSimpleName()，或者您可以创建（而不是抛出）一个 Throwable，打印堆栈跟踪，然后从那里开始。

# flash - 调试从非调试外部 swf 加载的内部 swf 的最佳方法是什么？

> ID：718066
> 
> 赞同：1
> 
> 时间：2009-04-04T23:51:01.330
> 
> 标签：flash, actionscript-3, debugging, actionscript, flexbuilder

我有一个需要附加 flex builder 调试器的 swf。我可以完全访问源代码，并且可以对这个 swf 进行调试构建。

但是，这个 swf 是由另一个 swf 的非调试版本加载的，我没有源代码，也无法使用它进行调试构建。

这可能吗？

我试过用两个非常简单的 swf 来模拟它，虽然当两者都是调试版本时它工作正常，但当外部 swf 是非调试版本时，虽然我可以让调试器连接，但我没有得到跟踪消息，断点不起作用，并且似乎锁定了 Flash 应用程序。

有什么想法吗？我有什么明显的遗漏吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T19:53:46.990

根据 Theo 的想法，您可能需要引用调试容器中的类。然后，只要您将非调试 swf 加载到同一个（或子）应用程序域中（并且非调试 swf 也是如此），那么您就可以闯入内部调试 swf。

您可以像这样引用类（这是一种气味，但即使是 Flex 在内部也这样做）：

```
import com.pkg.ClassToDebug; ClassToDebug;
import com.pkg.AnotherClassToDebug; AnotherClassToDebug;
// ... etc

package com.what.ever
{
    public class ApplicationClassInDebugContainer
    {
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T00:34:01.287

有趣的是，如果您编译一个几乎为空的 SWF，它只加载非调试 SWF（加载启用调试的 SWF）会发生什么？即 DEBUG > NON-DEBUG > DEBUG ...非调试级别是否取消其“孩子”的调试消息？

我认为您想要的是使用 flex 调试器进行堆栈跟踪等，但最好在您的 SWF 中使用自定义记录器，如果您希望有人远程调试在线版本等，这特别方便。谷歌有一些但是我想到的最新消息是[ThunderBold](http://code.google.com/p/flash-thunderbolt/wiki/ThunderBoltAS3)。

# sharepoint - 开发 SharePoint 应用程序需要什么？

> ID：718067
> 
> 赞同：2
> 
> 时间：2009-04-04T23:51:30.627
> 
> 标签：sharepoint, sharepoint-2007

我是一名 .NET 开发人员，习惯于编写标准的 WinForms 和 ASP.NET 应用程序。

几个月后，我将参与一个需要 Sharepoint 开发的项目。问题是……我对 Sharepoint 的态度为零，我不知道 Sharepoint 是如何工作的。

我需要哪些软件/工具才能学习和开发 Sharepoint 应用程序？我注意到有一个“SharePoint Server 2007”，我需要那个吗？Office 怎么样，我需要特殊版本的 Office 来为 Sharepoint 开发吗？

第二个问题是：这些东西如何连接和整合？Visual Studio、IIS、SharePoint Server、Office……？

对此的任何概述将不胜感激:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-05T00:11:29.657

几乎是以下内容的副本：

*   [SharePoint 开发环境设置](https://stackoverflow.com/questions/581050/sharepoint-development-environment-setup/581934)；
*   [为 SharePoint 创建开发环境。](https://stackoverflow.com/questions/11676/creating-a-development-environment-for-sharepoint);
*   [如何开始成为 .net 和 SharePoint 开发人员](https://stackoverflow.com/questions/182449/how-to-begin-as-a-net-and-sharepoint-developer)；和
*   [您使用什么设置进行 SharePoint (WSS/MOSS) 开发？](https://stackoverflow.com/questions/636813/what-setup-do-you-use-for-sharepoint-wss-moss-development).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T12:18:01.563

阅读[深入了解 Microsoft Windows SharePoint Services 3.0 (Pattison,Larson)](https://rads.stackoverflow.com/amzn/click/com/0735623201)。如果您已经熟悉 C# 和 ASP.NET，那么这本书是一本可以确保您了解如何开发 WSS/MOSS 应用程序**的书。**如果您想正确开发 SharePoint 解决方案/应用程序，这本书是**必备的。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T21:55:59.467

小心 Sharepoint Designer 它不是开发它是一个站点的更多定制......

如果您有更成熟的部署模型，那么您需要编写解决方案，请参阅 [http://technet.microsoft.com/en-us/library/cc262957.aspx](http://technet.microsoft.com/en-us/library/cc262957.aspx)

你的要求是什么__你应该写什么。我过去 2 年在 Sharepoint 的经验表明，这不是灵丹妙药。您很容易在性能、部署等方面遇到更多问题，因为您尝试将 Sharepoint 用于所有事情......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-06T20:07:45.310

我同意 Pete 对 Inside Microsoft Windows SharePoint Services 3.0 (Pattison,Larson) 一书的建议。我还推荐 Ted Pattison 教授的[The Great SharePoint Adventure](http://www.tedpattison.net/Courses/GSA401.aspx "伟大的 SharePoint 冒险")课程（如果/何时适合您）。我参加了这门课，它帮助填补了我知识上的许多空白。它紧跟他的书。

我还建议您也查看[SharePoint Designer](http://office.microsoft.com/en-us/sharepointdesigner/FX100487631033.aspx "SharePoint 设计器")（现在可以免费下载）。虽然不是编程工具，但它填补了 Web 界面和 Visual Studio 之间的空白。对于某些任务，这是最快的方法。

# c# - 我将如何在 Ruby 中编写这个 ftp 客户端肥皂消费者？

> ID：718084
> 
> 赞同：1
> 
> 时间：2009-04-05T00:05:27.613
> 
> 标签：c#, ruby

我有一个项目即将开始，我认为用 Ruby 编写它可能会很有趣。以下是基本要求：

1.  必须作为后台进程运行
2.  会跑一整天
3.  进程应该休眠 10 秒，然后检查 6 个不同的 ftp 服务器是否有新文件
4.  从 4 台服务器中，只需提取文件，然后 ftp 到我们网络上的另一台服务器
5.  从 2 个服务器，解析数据并发布到基于 .net soap 的 Web 服务
6.  将接收和发送的内容记录到每日日志文件或数据库中

我可以使用 linux 或 windows 服务器。你怎么看？这在 Ruby 中可行还是我应该坚持使用 .net？我可以为每个需要检查的服务器设置多个线程吗？我将如何将其作为服务运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T02:48:29.530

我会用 Windows Workflow Foundation 来做这件事。您可以轻松创建并行检查各种 FTP 服务器的工作流程。检查 FTP 服务器的整个活动可以重复（永远）执行，休眠 10 秒。您甚至可以使用跟踪功能在全局范围内进行日志记录，这样单个活动就不必这样做了。

工作流可以很容易地在服务中运行。只需在 Visual Studio 中创建一个服务，覆盖 OnStart 事件，并使用它来创建工作流主机（进行日志记录），然后启动工作流。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T01:31:41.570

您应该查看[Daemons](http://daemons.rubyforge.org) gem，它将在后台运行您的脚本并提供启动、停止和重新启动服务挂钩。您可以使用 Thread 类来设置线程。创建脚本后，使用[daemontools](http://cr.yp.to/daemontools.html)启动它们。它将监视并在出现故障时重新启动您的服务。

# javascript - innerHTML 的替代品？

> ID：718091
> 
> 赞同：48
> 
> 时间：2009-04-05T00:09:19.087
> 
> 标签：javascript, w3c, innerhtml

编辑：哇。这个问题现在已经 12 岁了。

正如有人所说，自 2016 年以来可以使用单线完成：[https ://stackoverflow.com/a/69322509/80907](https://stackoverflow.com/a/69322509/80907)

* * *

原本的：

我想知道是否有一种方法可以在不使用 innerHTML 的情况下更改 HTML 中任何内容的文本。

我问的原因是因为它有点被 W3C 反对。我知道这是吹毛求疵，但我只想知道，有没有办法？

编辑：人们似乎误解了我在这里问的内容：我想找到一种方法来有效地更改正在显示的文本。

如果我有：

```
<div id="one">One</a> 
```

innerHTML 允许我这样做：

```
var text = document.getElementsById("one");
text.innerHTML = "Two"; 
```

我屏幕上的文字也会改变。
我不希望追加更多文本，我希望更改已经存在的文本。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-04-05T00:20:32.303

推荐的方法是通过 DOM 操作，但它可能非常冗长。例如：

```
// <p>Hello, <b>World</b>!</p>
var para = document.createElement('p');
para.appendChild(document.createTextNode('Hello, '));

// <b>
var b = document.createElement('b');
b.appendChild(document.createTextNode('World');
para.appendChild(b);

para.appendChild(document.createTextNode('!'));

// Do something with the para element, add it to the document, etc. 
```

**编辑**

为了响应您的编辑，为了替换当前内容，您只需删除现有内容，然后使用上面的代码填充新内容。例如：

```
var someDiv = document.getElementById('someID');
var children = someDiv.childNodes;
for(var i = 0; i < children.length; i++)
    someDiv.removeChild(children[i]); 
```

但正如其他人所说，我建议改用 jQuery 之类的东西，因为并非所有浏览器都完全支持 DOM，而且那些确实有由 JavaScript 库在内部处理的怪癖。例如，jQuery 看起来像这样：

```
$('#someID').html("<p>Hello, <b>World</b>!</p>"); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-05T00:17:49.313

更好的方法是使用[`document.createTextNode`](https://developer.mozilla.org/en/DOM/document.createTextNode). 使用此函数而不是的主要原因之一`innerHTML`是所有 HTML 字符转义都会为您处理，而如果您只是设置`innerHTML`.

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-05T03:30:00.663

您可以通过操作 DOM 来获得相同的效果。更改文本最安全的方法是删除元素的所有子节点并用新的文本节点替换它们。

```
var node = document.getElementById("one");

while( node.firstChild )
    node.removeChild( node.firstChild );
node.appendChild( document.createTextNode("Two") ); 
```

删除子节点会删除元素的文本内容，然后再将其替换为新文本。

大多数开发人员避免使用 innerHTML 的原因是通过 DOM 访问元素是符合标准的。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-04-05T17:25:43.057

如果您只想更改纯文本，那么有一个更快的解决方案，它依赖于标准：

```
document.getElementById("one").firstChild.data = "two"; 
```

无论如何，请注意，innerHTML 将成为即将到来的 HTML 5 标准的一部分。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-11-28T12:07:39.710

简单的。

替换`text.innerHTML = 'two'`为`text.firstChild.nodeValue = 'two'`。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2017-03-07T21:18:59.777

也在寻找绕过的好方法，`element.innerHTML`我终于找到了解决方案：

```
HTMLElement.prototype.htmlContent = function(html)
{
    var dom = new DOMParser().parseFromString('<template>'+html+'</template>', 'text/html').head;
    this.appendChild(dom.firstElementChild.content);
}

//-- document.getElementById('my-id').innerHTML = string_of_html;
document.getElementById('my-id').htmlContent(string_of_html); 
```

另一种没有 <template> 标记的替代方案，而是循环：

```
HTMLElement.prototype.htmlContent = function(html)
{
    var dom = new DOMParser().parseFromString(html, 'text/html').body;
    while (dom.hasChildNodes()) this.appendChild(dom.firstChild);
} 
```

请记住，当innerHTML“替换”内容时，此方法实际上是“添加”内容......

这可能会有所帮助：

```
HTMLElement.prototype.clearContent = function()
{
    while (this.hasChildNodes()) this.removeChild(this.lastChild);
}

//-- document.getElementById('my-id').innerHTML = '';
document.getElementById('my-id').clearContent(); 
```

文档：[https ://github.com/swannty/escaping-innerHTML 性能：](https://github.com/swannty/escaping-innerHTML) [https](https://jsperf.com/escaping-innerhtml)
://jsperf.com/escaping-innerhtml

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-06T14:08:04.897

```
var who=document.getElementById('one'), txt='new text';
if(who.innerText) who.innerText=txt;
else if(who.textContent) who.textContent= txt; 
```

这对您来说可能与 innerHTML 一样令人反感，但它具有在某些情况下（IE）工作的优势，其中 innerHTML 或 appendChild 不能，如某些表格节点、样式和脚本元素的文本以及表单字段的值

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-02-08T19:55:58.207

insertAdjacentHTML() 是要走的路。阅读更多： [点击获取文档](https://developer.mozilla.org/en-US/docs/Web/API/Element/insertAdjacentHTML)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2021-09-25T01:38:48.153

这是一个非常古老的问题。

现在，情况发生了变化：

```
element.innerText = "Hi There!" 
```

单线。自 2016 年以来，每个浏览器都支持这一点。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-05T00:23:32.577

您可以按如下方式使用 DOM：

```
<html>
<body>
<div>before</div>
<script type="text/javascript">
var element = document.getElementsByTagName("div")[0];
alert(element.firstChild.nodeValue);
element.removeChild(element.firstChild);
element.appendChild(document.createTextNode('after'));
alert(element.firstChild.nodeValue);
</script>
</body> 
```

[但我认为很少有人这样做，](http://speckyboy.com/2008/04/01/top-10-javascript-frameworks-which-do-you-prefer/)而是使用[jQuery](http://jquery.com/)或[Prototype](http://www.prototypejs.org/)之类的框架或任何其他 javascript 框架。这是jQuery示例：

```
<html>
<head>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js"></script>
</head>
<body>
<div>before</div>
<script type="text/javascript">
var element = $("div");
alert(element.text());
element.text("after");
alert(element.text());
</script>
</body> 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-16T10:02:48.540

在我看来，CSS+HTML+JS 组合应该达到预期的效果：

```
.myelement:before {   
    content: attr(alt);
} 

...

<span class='myelement' alt='initial value'></span> 

...

element.setAttribute('alt', 'new value'); 
```

有谁知道这在实践中是否有效？

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-09-24T07:54:02.783

好吧，如果我正确理解了您的问题，这应该是一个答案。

```
var text = document.getElementById("one");
//text.innerHTML = "Two";
 text.childNodes[0].nodeValue="two"; 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-10-10T13:18:44.460

如果我要定期更新它，我有时会发现存储对文本节点的直接引用很有帮助。我做这样的事情：

```
var dynamicText = myDiv.appendChild(document.createTextNode("the initial text")); 
```

然后每当我需要更新它时，我都会这样做：

```
dynamicText.nodeValue = "the updated text"; 
```

这可以避免必须遍历 DOM 或添加或删除任何子项。

# asp.net-mvc - MVC ModelState 能否跨越多个控制器

> ID：718096
> 
> 赞同：0
> 
> 时间：2009-04-05T00:11:44.167
> 
> 标签：asp.net-mvc

我有一个场景，控制器 A 中的视图将其表单发布到控制器 B 中的操作，然后在该操作中验证数据，如果验证失败，则将错误添加到 ModelState，然后操作重定向回控制器 A 以便可以填充验证消息。

我遇到的问题是，当我返回控制器 A 时，视图似乎没有发现任何验证错误。ModelState 是否只存在于一个控制器的状态中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T00:24:12.200

Modelstate 本质上是视图数据，因此它的生命周期仅适用于请求。您需要的解决方法是将模型状态存储在`TempData`. [这里](http://www.jeremyskinner.co.uk/2008/10/18/storing-modelstate-in-tempdata-with-aspnet-mvc/)有一篇关于它的博客文章。

```
 using MvcContrib.Filters;

    [ModelStateToTempData]
    public class MyController : Controller {
      //
    ...
    } 
```

# .net - 在两组文本文件之间找到一个不同关键字的最快方法/算法

> ID：718098
> 
> 赞同：1
> 
> 时间：2009-04-05T00:12:09.577
> 
> 标签：.net, algorithm, diff

我有 4 个文本文件，其中 2 个包含其他 2 个文本文件没有的关键字。

找到在前 2 个文本文件中共享但在其他 2 个文件中不存在的“关键字”的最快方法/算法是什么？

我可以想到非常缓慢的方法，例如逐字逐句搜索，然后使用 IndexOf 等进行搜索。但听起来它会很慢。特别是如果文件数量增加。

Extra 1 :*关键字可以是单个单词，例如“apple”或句子“Have you seen the apple tree?”。只要其他两个文本文件不包含此关键字，就没有关系。但我认为性能更短会更好。*

额外 2 ：*这些文本文件实际上是简单的 HTML 源，因此预计会很大。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-05T00:16:51.267

如果您只有一个关键字（或关键短语），那么您最好只使用 indexOf() 或类似的简单现有函数调用。您的瓶颈不会是 CPU 甚至内存带宽，而只是磁盘速度。您的 CPU 搜索速度比磁盘可以提供的速度快 10 倍。

如果**内存中**已有文件并且需要快速扫描，那么正确的算法可能是[Boyer Moore](http://en.wikipedia.org/wiki/Boyer-Moore_string_search_algorithm)或 [KMP](http://en.wikipedia.org/wiki/Knuth-Morris-Pratt_algorithm)。但是一开始不要打扰它，尝试简单的 indexOf() 类型的原语，看看这对你来说是否真的太慢了​​。计算机速度很快，您可能会感到惊讶。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-05T00:37:40.093

这似乎是哈希表完美的事情。可以在 O(1) 时间内存储和检索哈希表条目，并且可以在这里非常有效地使用。我建议尝试以下算法：

1.  创建一个`Dictionary<string, int>`（这实际上是一个通用哈希表，从 .NET 2.0 开始可用）。这将用于跟踪每个关键字的出现（该值将充当位字段）。
2.  加载每个文本文件并读取所有关键字，为找到关键字的相应文本文件设置适当的位。例子：

    ```
    dict[keyword] |= (1 << curTextFileIndex); 
    ```

    在您的情况下，哪里`curTextFileIndex`会从 0 到 3 不等。

3.  遍历字典中的所有条目，寻找合适的值（位域）。在您的情况下，因为您正在寻找出现*在前两个*文件中而*不是最后*两个文件中的关键字，所以您要搜索的值是 0011 （或十进制的 3 ）。找到此条目，您就有了关键字。

除非我弄错了，否则此算法运行时间为 O(n)，其中 n 是所有文本文件中的关键字总数。老实说，我不认为你会变得更好。

希望有帮助。如果您需要更多详细信息，请告诉我...

**编辑**：嗯...我似乎错过了有关您的“关键字”可能包含多个实际单词的信息。如果已知这些“关键字”比某个（低）数量的单词短，那么我认为这个解决方案可能仍然可行，只需稍作修改。否则，您将需要一些更聪明的东西，它会出现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-05T00:29:16.667

首先，生成每个文件中的所有关键字。（我猜这是相当样板）

现在，为每个文件创建一个关键字集或哈希集（基本上，它允许您非常快速地检查字符串是否是集合的一部分）。（谷歌代码/详细信息，它们几乎适用于所有语言）

完成此操作后，您所要做的就是遍历每个可能的关键字并检查它是否恰好出现在 2 个文件中。由于您使用的是哈希集，因此每次查找只需要几个操作 - 所以总的来说，这应该很快。

# assembly - 如何将 NASM“推送字节”转换为 GAS 语法？

> ID：718105
> 
> 赞同：5
> 
> 时间：2009-04-05T00:19:50.107
> 
> 标签：assembly, stack, nasm, gnu-assembler

我正在将 NASM 源“移植”到 GAS，我发现了以下代码行：

```
push byte 0
push byte 37 
```

GAS 不允许“push byte”或“pushb”。

我应该如何将上面的代码翻译成 GAS 语法？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-05T01:20:48.710

`pushb`已从 GAS 中删除。您应该能够使用该`push`命令来获得相同的效果。更多信息在[这里](http://www.sourceware.org/ml/binutils/2000-05/msg00076.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-11-09T16:59:26.973

**1)** `push byte`在 NASM 2.11 64 位编译为与 just 相同`push`，除了如果推送的内容大于一个字节，它会拒绝编译：

```
push 0x0000
push 0x01
push 0x0001
push 0x10 
```

是相同的：

```
push byte 0x0000
push byte 0x01
push byte 0x0001
push byte 0x10 
```

但以下失败：

```
push byte 0x0100
push byte 0x1000
push byte 0x01000000
push byte 0x10000000 
```

所有这些都编译成`6a XX`指令的形式。

**2）** NASM和GAS根据操作数大小自动决定使用什么形式：

气体 2.25：

```
push $0x0000
push $0x01
push $0x0001
push $0x10
push $0x0100
push $0x1000
push $0x01000000
push $0x10000000 
```

编译为与 NASM 相同：

```
push 0x0000
push 0x01
push 0x0001
push 0x10
push 0x0100
push 0x1000
push 0x01000000
push 0x10000000 
```

转储：

```
 0:   6a 00                   pushq  $0x0
   2:   6a 01                   pushq  $0x1
   4:   6a 01                   pushq  $0x1
   6:   6a 10                   pushq  $0x10
   8:   68 00 01 00 00          pushq  $0x100
   d:   68 00 10 00 00          pushq  $0x1000
  12:   68 00 00 00 01          pushq  $0x1000000
  17:   68 00 00 00 10          pushq  $0x10000000 
```

因此，`push`在 GAS 中与`push byte`在 NASM 中相同，但没有错误检查。

**3） GAS中***确实*存在的修饰符`w`如下：

```
pushw $0 
```

编译为：

```
0:   66 6a 00                pushw  $0x0 
```

即，添加`0x66`前缀以切换 16 位操作。

NASM 的等价物是：

```
push word 0 
```

**4)**不同之处`mov`在于我们无法控制任意推送大小：它们都是将固定数量推送到堆栈。

我们可以控制指令编码的唯一参数是是否包含`0x66`前缀。

其余的由段描述符确定。请参阅[Intel 64 和 IA-32 架构软件开发人员手册 - 第 2 卷指令集参考 - 325383-056US 2015 年 9 月](https://web.archive.org/web/20151025081307/http://www.intel.com/content/dam/www/public/us/en/documents/manuals/64-ia-32-architectures-software-developer-instruction-set-reference-manual-325383.pdf)。

# open-source - 您是如何参与开源社区的？

> ID：718107
> 
> 赞同：10
> 
> 时间：2009-04-05T00:22:00.227
> 
> 标签：open-source

似乎加入项目的正常进程是贡献一段时间，赢得信任，然后被接受为社区成员（即拥有提交访问权限）。

现在，从某种意义上说，我显然已经知道如何参与的“最佳方式”；这不是我的问题；我希望达到的是：其他人是如何参与其中的？肯定不是每个人都走上了“找到一个项目并提交补丁”的路线——或者他们有吗？我碰巧在开源社区中不认识任何人，所以我很想知道......

也许您已经认识某个社区中的某个人并刚刚陷入其中？也许您对某些错误感到沮丧并因此开始定期贡献？也许你只是在 SourceForge 上发现了一个项目......

### 更新：

似乎最常见的原因只是搔痒，[引用 singpolyma](https://stackoverflow.com/questions/718107/how-did-you-get-involved-with-your-open-source-projects/718132#718132)的话：“寻找一个可以贡献的项目通常*不是*正确的方法。” 相反，您应该通过为您已经知道和使用的项目做出贡献来加入开源社区。

### 重要的：

请，请，请：请告诉我您的具体经历，请不要笼统的回答。此外，仅当您是项目成员或补丁贡献者时才回答。请不要就如何加入社区提供建议，这不是我正在寻找的答案。如果您想提供有关加入社区的建议，[请在此其他线程中回答](https://stackoverflow.com/questions/43649/how-to-get-involved-in-an-open-source-project)。

### 很棒的答案：

*   [Mark Harrison](https://sourceforge.net/projects/tcl/)谈到[Tcl](https://sourceforge.net/projects/tcl/)、[cx_Oracle](https://sourceforge.net/projects/cx-oracle/)、[kap](https://sourceforge.net/projects/kap/)和[orapig](http://code.google.com/p/orapig/)
*   [singpolyma](https://stackoverflow.com/questions/718107/how-did-you-get-involved-with-your-open-source-community/718132#718132)谈论[DiSo](http://code.google.com/p/diso/)和[Greasemonkey](http://www.greasespot.net/)
*   [Pax](https://stackoverflow.com/questions/718107/how-did-you-get-involved-with-your-open-source-projects/718138#718138)谈到因为他的妻子而为[GnuCash做出贡献](http://www.gnucash.org/)

### 有关的：

*   [如何参与开源项目](https://stackoverflow.com/questions/43649/how-to-get-involved-in-an-open-source-project)
*   [开源项目如何生存有毒的人（你也可以）](http://video.google.com/videoplay?docid=-4216011961522818645)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-05T00:41:41.583

### 我的个人轶事：

1.  当 Tcl 社区在 1991 年左右开始时，我就参与了它。邮件列表和后来的 usenet 新闻组对于与人们联系非常重要。我专门从事用户布道和教学，最终写了两本关于这个主题的书。其中之一在十年后仍在印刷：http: [//www.amazon.com/dp/0201634740](https://rads.stackoverflow.com/amzn/click/com/0201634740)

2.  现在我使用了很多 Python，并且非常喜欢 cx_Oracle 包。我再次活跃在邮件列表中，并贡献了一些补丁。

3.  我已经提供了几个我为工作而编写的软件包。通过将它们开源，我能够获得一些不错的贡献，而且由于它们当时不是我雇主的“秘密武器”，所以他们不介意共享代码。最受欢迎的两个包是

    [http://sourceforge.net/projects/kap/](http://sourceforge.net/projects/kap/)动力学应用处理器——这是我在中国互联网骨干网工作时构建的。

    [http://code.google.com/p/orapig/](http://code.google.com/p/orapig/) - OraPIG，Oracle Python 接口生成器 - 它生成 Python 代码来调用数据库中定义的 API，并包括一个 XML-RPC 数据库接口。

### 建议：

与其寻找要加入的项目，不如尝试为您已经使用的项目做出贡献。

跳入“核心”开发通常很困难，因为 (a) 在一个大项目中，这可能是一大块需要理解的代码，并且 (b) 可能有一群核心人员已经在研究它。

所以，假设你喜欢某个软件并想开始贡献，你可以开始在边缘工作。这里有几个具体的任务可以帮助你融入团队。

*   为错误编写一些测试用例以添加到回归测试套件中。
*   浏览错误数据库并找到要处理的错误。这可能是进入核心开发的最佳方式。
*   查看功能请求数据库，看看是否有您可以处理的小任务。
*   寻找“用户文档”请求......其中很多涉及编写您可以提供的示例代码。

祝你好运！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-05T00:50:47.050

人们通常参与的方式是：

*   您在日常工作中使用 FOSS 产品
*   您注意到问题或缺少的功能
*   你给维护者发邮件询问这个错误/缺失的特性是否真实
*   维护者说是的，这是一个错误/缺失的功能
*   您决定尝试修复/添加错误/功能
*   你发疯了
*   你向维护者提交补丁
*   维护者笑着面对或说“非常感谢！

如果你重复最后几个步骤几次，维护者可能会给你提交对项目的 RCS 存储库的访问权限，然后你真的会变得很危险。但最重要的是，由你来做某事，即编写一些代码——仅仅对项目“感兴趣”是不够的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-05T00:41:48.447

我加入了 DiSo 和 Greasemonkey。

我发现参与的最佳方式是在项目的早期参与，或者只是非常感兴趣。对于 DiSo 或我参与的各种 github 项目，是前者，我的 Greasemonkey 贡献是后者。

寻找一个可以贡献的项目通常不是正确的方法。使用东西并找出您想要构建/修复的内容，然后执行此操作。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-05T00:45:10.840

我在 GnuCash 上做了一些补丁工作，因为我的妻子最近在我们的孩子长大一点后重新开始了兼职工作。

我宁愿用热扑克挖掉我的眼睛，也不愿重新安装 Windows，但 GnuCash 缺少 [某个其他会计软件包] 所具有的东西，所以我告诉她我会添加它。

事实证明，他们拿走了我的补丁，并在将其放入之前将其改进了很多（最终补丁的 1% 可能是我的东西），但至少我们现在可以使用 GnuCash 而不是那些专有的东西。他们的反应也令人难以置信——从补丁提交到补丁可用只用了一周左右的时间，三周后它就在产品中了。

我也曾经研究过在 Linux 内核中为进程记帐打补丁，但所需的努力远远超过了我的需求:-)

我不会定期做出贡献，而是根据需要（找到你的痒并抓它）。有些人对此很感兴趣，但我宁愿把业余时间花在孩子身上，不幸的是，我的雇主不会付钱让我在其他地方做出贡献。

最后一点让我特别恼火，因为：

*   Linux 补丁会极大地帮助我们的产品（以及许多其他产品）。
*   是我们另一种产品的行为变化降低了我们产品的实用性。
*   从概念上讲，该解决方案相当简单（所需的工作是测试，因为问题将是高影响的[任务切换]并且非常普遍[每个使用 Linux 的人]）。
*   与我们最终实施的解决方法相比，编写补丁程序会更快。
*   解决方法是一个 kludge (p'tooee)。
*   现在，世界上没有人能从我们的补丁中受益（包括我们）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-05T00:57:08.020

我所做的很简单；我开了一个。

一位永久开发人员和另外两位在幕后捐赠代码的人加入了我的行列。该项目处于非常早期的阶段，因此没有多少用户下载它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-06T16:17:11.620

真正有助于开源项目的是拥有插件架构。
为例如贡献一个简单的插件要容易得多。一种文件格式，而不是尝试向 Linux 内核添加一些东西。这使得建立社区变得更快、更容易。

> **TODO：**请提供一个轶事。

# c# - 使用 LINQ 订购两个不同的 C# 列表

> ID：718115
> 
> 赞同：2
> 
> 时间：2009-04-05T00:32:18.767
> 
> 标签：c#, linq

我有两种彼此不同的 C# (3.5) 类型。我不控制它们，所以我不能让它们从一个通用类型继承或实现一个接口。但它们在“形状”上非常相似：

```
class A
{
string Name
string Data
}

class B
{
string Title
string OtherStuff
}

class C
{
string ID
string ExtendedData
}

List< A > myAList
List< B > myBList 
```

我想使用 LINQ 查询执行以下操作：

返回列表中的所有元素`myAList`并按or`myBList`排序（无论适用）结果必须是where or and or`Name``Title``List< C >``ID = Name``Title``ExtendedData = Data``OtherStuff`

想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-05T00:39:42.740

```
var myCList = (myAList.Select(a => new C
    { ID = a.Name, ExtendedData = a.Data })
    .Union(myBList.Select(b => new C
        { ID = b.Title, ExtendedData = b.OtherStuff }))
    .OrderBy(c => c.ID)
    .ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T00:40:48.713

```
var result = (
    from a in myAList
    select new C { ID = a.Name, ExtendedData = a.Data }
).Union(
    from b in myBList
    select new C { ID = b.Title, ExtendedData = b.OtherStuff } 
).OrderBy(e => e.ID).ToList(); 
```

# web-services - 您使用什么工具来创建 Web 服务的原型或模型？

> ID：718124
> 
> 赞同：2
> 
> 时间：2009-04-05T00:36:55.027
> 
> 标签：web-services, prototype, mocking

理想情况下，你会认为我疯了，我可以将一些基本逻辑编码到 bash 或 korn 脚本中，并将该功能开放给客户使用它们。Web 服务涉及很多管道，我想知道更有经验的开发人员使用哪些工具和技术来构建后端 Web 服务可能尚不可用的系统原型。bash 和 ksh 是否存在此类工具？什么语言最容易开发模型。顺便说一句，我正盯着一个 ecplipse IDE，对我正在看的东西感到有点反感。我刚刚安装并运行了 JBOSS……所有这些服务的核心都是通过端口到客户端的套接字连接……还是我弄错了？

顺便说一句：我目前正在阅读[这个](http://www.soapui.org/gettingstarted/mocking.html)。而我的厌恶也在增加。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T04:45:46.037

认真考虑其他一些脚本语言。我一直在使用 Python 和 Ruby 构建快速原型，并且对它们*非常*满意。

如果您可以自由选择，请考虑使用 REST 架构而不是 WSDL 和 SOAP 解决方案。RPC 有它的位置，但如果你能忍受 REST 的限制，生活会轻松很多。即使您不能，使用动态语言进行原型制作也会快得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T16:21:56.750

我和你一样厌恶日食。像 Python 这样的语言非常适合快速原型设计。如果您将它与众多 Web 框架之一（我建议使用 Python 的 Pylons 或 Django）结合起来，您可以快速完成的工作量是惊人的。

# c++ - C++ 跨平台库和绑定的最佳文件夹结构

> ID：718126
> 
> 赞同：54
> 
> 时间：2009-04-05T00:38:02.840
> 
> 标签：c++, cross-platform

我即将开始研究一个用 C++ 编写的跨平台库。以后，我打算实现其他语言的绑定，例如 Python、Java 等。该库需要在主要平台上可用：win32、Linux 和 Mac OSX。

虽然该应用程序实际上是一个库，但会捆绑一些基本的控制台程序用于演示和测试。

在开始在 Subversion 中存储内容之前，我想提出一个最佳的文件夹结构。

我正在考虑类似的事情：

```
/project                    //Top level folder

        /bin                //Binaries ready for deployment
            /linux_amd64    //Linux AMD64 platform
                  /debug    //Debug build - duplicated in all platforms
                  /release  //Release build - duplicated in all platforms
            /linux_i386     //Linux 32-bit platform
            /macosx         //Mac OS X
            /win32          //Windows 32-bit platform
                  /cygwin   //Windows 32-bit platform compiled with Cygwin
                  /vs.net   //Windows 32-bit platform compiled with Visual Studio .NET
            /win64          //Windows 64-bit platform

        /build              //Make and build files, IDE project files
            /linux_amd64    //Linux AMD64 platform
            /linux_i386     //Linux 32-bit platform
            /macosx         //Mac OS X
            /win32          //Windows 32-bit platform
            /win64          //Windows 64-bit platform

        /config             //Configuration files that accompany the binaries

        /data               //Data files that accompany the binaries

        /doc                //Documentation

        /lib                //External or third-party libraries
            /platforms      //Platform-specific code for ...
                      /linux_amd64    //Linux AMD64 platform
                      /linux_i386     //Linux 32-bit platform
                      /macosx         //Mac OS X
                      /win32          //Windows 32-bit platform
                      /win64          //Windows 64-bit platform
            /src            //Available library source code in subfolders

        /src                //Source code tree - this will contain main.cpp
            /bindings       //Bindings to other languages such as ...
                      /python
                      /java
            /h              //Header files
            /modules        //Platform-independent modules, components or subprojects
            /platforms      //Platform-specific code for ...
                      /linux_amd64 //Linux AMD64 platform-specific code
                      /linux_i386  //Linux 32-bit platform-specific code
                      /macosx
                      /win32       //Windows 32-bit platform-specific code
                      /win64       //Windows 64-bit platform

        /test               //Automated test scripts 
```

如果你有建议，我很想听听。我想知道是否有一种工具可以帮助创建这种结构。

我打算使用 CMake 和 Subversion。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-05T01:17:20.653

结构对我来说看起来不错，但有几点：

*   将 C++ 头文件和源文件分开到不同的目录是正常的，或者模块目录中可能存在您未显示的结构？
*   您可能希望目录将 *.obj 之类的中间文件放入
*   您将需要不同的目录来调试和发布输出文件
*   像 InnoSetup 这样的安装程序及其安装文件的目录可能很有用 - 你必须做出关于是否对这些进行版本控制的哲学决定

至于创建结构的工具，您只需要花几分钟编写 bash 脚本即可 - 值得在所有平台上使用相同的工具（如 bash）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-05T01:00:33.503

为什么二进制文件需要不同的平台文件夹？你打算在不同的平台下使用相同的文件系统构建这个源代码吗？

如果是，我认为您也需要编译器特定的文件夹。

为什么不使用不同的文件夹进行调试和发布构建，可能是 unicode 和非 unicode、单线程或多线程构建？

看看 bjam 或 Scons 做替代品。也许您不需要构建目录中的不同文件夹。

我认为如果“模块”目录中的所有模块都包含用于测试自我的“测试”目录会更好。

* * *

最后 - 看看 boost 库，这个 platofrm 独立的库，它有很好的结构。

还尝试从其他独立于平台的项目中获取想法。

***Boost文件夹结构：***

```
boost - root dir
- boost - library header lib ( for users )
- libs - library source dir ( one dir per lib )
    - build - library build files ( if they are needed )
    - doc - documentation files
    - example - sample programs
    - src - library source files
    - test - programs and srcipts for testing module
- bin - created by bjam build system
    - libs
        - <lib-name>
            for all compiled folders from libs [example|test|build]
                - <compiler-name>/<[static|dynamic]-link>/<[debug|release]>/<[threading mode]>
                    contain builded [obj|dll|lib|pdb|so|o|etc] files see detailed information in bjam build system

- doc
- tools 
```

如果您选择 bjam - 您将不会担心 build 和 bin 文件夹结构。

此外，您的 libs/src/ 目录可以包含所有平台文件的自己的目录和平台特定文件的几个目录。

我在你的文件夹结构中没有看到任何严重的问题，也许你会在开始编写项目原型时看到它们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-05T02:44:35.280

我最近发布了一个[关于](https://stackoverflow.com/questions/634816/c-header-files-put-them-in-one-directory-or-merged-in-a-tree-structure)仅在一个目录中打包标题的问题，决定使用少量包含目录。

你要迎合Win64吗？这将是一个越来越重要的目标。

不要*将*构建中间文件放在被签入 svn 的树下的任何位置。如果你这样做，取决于你的 svn 客户端工具，它们会产生很多噪音作为*不在存储库中的文件。*这使得很难看到您添加的*应该*在存储库中的文件。

相反，如果您的编译器允许，请将中间目录放在一侧。

否则，请确保将整个中间目录添加到 svn 排除属性中。一些 GUI 比其他的更容易（Windows 上的 Tortoise、Cornerstone 或 OS/X 上的版本）。

# asp.net - asp.net 和 jquery 对话框

> ID：718133
> 
> 赞同：0
> 
> 时间：2009-04-05T00:42:02.097
> 
> 标签：asp.net, jquery

有谁知道如何在 asp.net 页面中使用 jquery 模态对话框？ [http://jqueryui.com/demos/dialog/](http://jqueryui.com/demos/dialog/)

我尝试创建一个简单的 aspx 页面，粘贴示例中的代码（[http://jqueryui.com/demos/dialog/](http://jqueryui.com/demos/dialog/)），它几乎可以工作。对话框短暂显示然后消失。该页面似乎正在回发。我不知道如何停止它，以便模态对话框保持不变。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-11T21:25:44.487

我一直在使用[jqModal](http://dev.iceburg.net/jquery/jqModal/)进行模态对话框。我已将其设置为使用标准的 HTML 输入按钮来触发对话框，然后您可以将常规的 asp.net 按钮或其他控件放入隐藏的 div 中。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-05T05:16:21.813

I assume you have something like:

```
<asp:Button ID="popupButton" OnClientClick="showModalPopup();" Text="Click me" runat="server" /> 
```

I would try adding "return false;" to the OnClientClick property of your Button:

```
<asp:Button ID="popupButton" OnClientClick="showModalPopup(); return false;" Text="Click me" runat="server" /> 
```

Or if you don't need to access the button in code-behind, simply use a standard HTML button and set it's onclick event attribute:

```
<button onclick="showModalPopup();">Click me</button> 
```

# asp.net-mvc - Site.Master 和 ASP.NET MVC 的问题

> ID：718135
> 
> 赞同：0
> 
> 时间：2009-04-05T00:44:52.510
> 
> 标签：asp.net-mvc, master-pages

我正在尝试使我的网站母版页 ( `views/shared/site.master`) 具有强类型。

例如。Inherits="TestProject.Mvc.Views.Shared.Site"

我似乎无法完成这项工作。一旦我将 site.master 页面设置为强输入，Visual Studio 似乎“松散”了什么`<%= Html.XXX %>`。此外，当我尝试显示默认索引路由时，页面会引发错误。

SiteMasterViewData 类存在于 views/shared/ 文件夹中，并已通过...包含在母版页的顶部。

```
<%@ Import Namespace="TestProject.Mvc.Views.Shared"%> 
```

这可以做到吗？有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-05T01:10:07.457

该死的 - 找到了我自己的答案。

ASP.NET MVC v1 中的所有母版页。需要继承自：

```
<%@ Master 
    Language="C#" 
    Inherits="System.Web.Mvc.ViewMasterPage" %> 
```

所以如果你想强烈输入它，你可以这样做。

```
<%@ Master 
    Language="C#" 
    Inherits="System.Web.Mvc.ViewMasterPage<SiteMasterViewData>" %> 
```

HTH 的其他人 :)

# programming-languages - 按名称传递和按值结果语言传递

> ID：718140
> 
> 赞同：6
> 
> 时间：2009-04-05T00:45:24.677
> 
> 标签：programming-languages, parameter-passing

对于我的编程语言课程，我正在尝试使用按名称传递或按值结果传递的语言编写一些代码片段，最好是默认情况下，但任何支持其中任何一种的语言都可以。但是，我还没有找到支持其中任何一种的单一语言。有谁知道使用按值结果传递或按名称传递的语言？最好是命令式语言。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-05T01:14:36.417

关于评估策略的[维基百科文章](http://en.wikipedia.org/wiki/Evaluation_strategy)表明，fortran 支持按值调用结果。algol 68 支持按名称调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T00:57:42.637

我认为 C 宏是按名称传递的（当然**不是**C 语言本身）。恐怕我不知道任何按值结果传递的语言（老实说，我必须进行网络搜索才能找出它的含义！）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-05T01:27:32.907

如果你将一个变量传递给一个 fortran 函数并在那里修改它，你也会在调用程序中修改它：

伪代码：

```
int j = 1
print j
addOne(j)
print j 
```

会输出：

```
1
2 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-05T02:18:48.167

我认为 CLIPS 专家系统语言将通过名称传递。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-05T01:51:44.160

Java 和 C 都是按值传递的语言。

C 显然是一种按值传递的语言。

Java 总是被告知“基元通过值传递，对象通过引用传递”。但是由于java对象在任何时候都是一个引用，所以它实际上是一个引用值。

Java 语言规范说明了这一点：http: [//java.sun.com/docs/books/jls/second_edition/html/classes.doc.html#37472](http://java.sun.com/docs/books/jls/second_edition/html/classes.doc.html#37472)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-04-07T10:34:37.827

Algol 支持按名称传递，您可以[在此处找到一些解释](http://www.cs.sfu.ca/~cameron/Teaching/383/PassByName.html)

有人告诉我 Ada 支持按值/结果传递，但还没有尝试过。

# c# - 以枚举为键为通用字典编写自定义索引器

> ID：718147
> 
> 赞同：0
> 
> 时间：2009-04-05T00:55:53.343
> 
> 标签：c#

我有一个通用字典，以枚举为键，以 int 为值。

我不能对此使用索引器（错误是无法应用索引器）。

我如何编写自定义索引器来启用此功能？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T01:06:21.833

你能做到吗？

```
Dictionary<YourEnum, int> dic = new Dictionary<YourEnum, int>();

dic.ElementAt(index); 
```

但是，如果我不理解这个问题，您能否再详细说明一下...

# jquery - 在 jQuery 中使用 if 或 case 是否有替代方法？

> ID：718158
> 
> 赞同：1
> 
> 时间：2009-04-05T01:04:51.933
> 
> 标签：jquery

我有大约 10 张图片，当`:hover`每张图片都有一个`ajax.load`将被触发的时候。我即将做 10 `jquery.hover`，但有些事情告诉我有更好的解决方案。

我在想类似的东西

```
case 1 : load a
case 2 : load b
case 3 : load c
etc... 
```

我将如何在 jquery 中执行此操作？

了解必须加载 10 种不同的图片和 10 种不同的文字，`<div>`所以现在我正在做

```
$('#a).hover.load('file' #tx-a');
$('#b).hover.load('file' #tx-b');
$('#c).hover.load('file' #tx-c'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-05T01:17:45.270

这是一个简单的例子：

```
<p id="status">&nbsp;</p>
<img class="viewable" id="unique" src="foo.jpg"/><br/>
<img class="viewable" id="id" src="foo.jpg"/><br/>
<img class="viewable" id="for" src="foo.jpg"/><br/>
<img class="viewable" id="each" src="foo.jpg"/><br/>
<img class="viewable" id="element" src="foo.jpg"/><br/>

<script type="text/javascript">
  $(function() {
    var stuff = ['hello', 'world', 'you', 'look', 'nice'];

    $('.viewable').hover(
      // triggered when mouse moves onto element
      function() {
        var index = $('.viewable').index(this);

        // Replace this next line with a jQuery AJAX call. Pass the index 
        // as a parameter to whatever location you are pulling the text 
        // from, and have the AJAX callback stuff the text into the 
        // #status element. This is just a placeholder.
        $('#status').html('Hover IN, index ' + index + ' (' + stuff[index] + ')');
      },
      // triggered when mouse move off of element
      function() {
        // Optional: clear status element when mouse moves off image
        $('#status').html('&nbsp;');
      }
    );
  });
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T01:27:07.777

我肯定会建议为此使用某种共享功能。我会提出两个建议。

选项 1\. 设置一个插件，然后将所有 10 个绑定到插件。

```
(function($) {
  $.fn.loadImageOnHover = function(image) {
    return $(this).hover(function() {
        // load the image using ajax
      }, function() {
        // unload
      });
  };
})(jQuery);

$('#image1').loadImageOnHover('image.jpg');
$('#image2').loadImageOnHover('image2.jpg');
$('#image3').loadImageOnHover('image3.jpg');
$('#imageN').loadImageOnHover('image4.jpg'); 
```

选项 2\. 设置一个通用函数并使用 William Brendel 提到的属性、哈希或索引

```
$('.hoverImage').hover(function() {
  var image = this.hash.replace('#','');
  alert(image);
  // load via ajax
}, function() {
  // unload
});

<a href="#image1.jpg" class="hoverImage">Hover</a>
<a href="#image2.jpg" class="hoverImage">Hover</a>
<a href="#image3.jpg" class="hoverImage">Hover</a>
<a href="#imagen.jpg" class="hoverImage">Hover</a> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T01:10:55.957

在 jQuery 中，您可以一次将悬停事件绑定到所有这些事件

```
$("img").hover(function(e) {
    // triggered when mouse enters the element
    // here you can load picture by Ajax
}, function(e) { 
    // triggered when mouse leaves the element

    // unload picture or do whatever else ...
}); 
```

您可以通过以下方式获得对当前图像元素的引用`$(this)`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-05T01:22:19.317

您可以使用以下内容：

```
$('img').hover(function (e) { ... }, function (e) { ... }); 
```

每个`e`函数中的 分别代表 mouseover 和 mouseout 事件的事件对象。要找出它触发的图像，请使用`$(this)`.

有些人（包括我自己）在使用该`hover()`函数时遇到了问题，因为它并不总是正确地注册 mouseout 事件。也许这已在以后的版本中得到修复，但我通常会这样做`$('img').mouseover(...).mouseout(...)`以确保。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-05T16:22:32.070

基于以下工作：William Brendel，这是最终代码

```
<script type="text/javascript">
$(document).ready(function () {

    $('#equipe-gens img').hover(
      function() {
                    myID=$(this).attr('id');
                    $('#equipe-profile').load('equipedecourse.html #' + myID);
                    $('#'+myID).css('border','2px solid red');
                   },
      function() { 
                    $('#'+myID).css('border','2px solid #000000');
                    $('#equipe-profile').html("<h1>Profil</h1><p>Pour voir le profile des membre de l'équipe, sélectinnez-les</p>");
                   }
    );
  });
</script> 
```

# c# - 从 SSL + WatiN 下载网页图像

> ID：718160
> 
> 赞同：2
> 
> 时间：2009-04-05T01:07:26.667
> 
> 标签：c#, .net, unit-testing, watin

我一直在考虑这个问题，但似乎找不到解决方法：我在 WatiN 2.0 上运行了一些代码，它通过 SSL 隧道连接到一个站点，并且在执行某些任务之后（其中有没有其他可行的方法可以在不依赖浏览器的情况下实现自动化）应该能够从同一个 SSL 连接下载图像。图像是根据导航期间生成的某些状态动态提供的，并且不是通过与上述状态关联的 SSL 连接提供的，所以我真的需要坚持使用 WatiN + IE。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T03:58:50.470

如果我对您的理解正确，您正在尝试访问网页（通过多个步骤），然后在该页面上保存图像的副本（动态生成），对吗？

如果是这样，我认为 WatiN 没有内置的方法，但我偶然发现[了 WatiN 邮件列表存档中的一个线程，](http://sourceforge.net/mailarchive/forum.php?thread_name=57812bec0807240650y711588c9td91f47c7f90c4267%40mail.gmail.com&forum_name=watin-users)这可能会有所帮助。

基本上，看起来您可以使用 WatiN 动态生成一些 javascript 来针对您的页面运行并将图像复制到剪贴板，然后在测试代码中从剪贴板中获取图像。

希望对你有一些帮助...

# .net - WordPress 或社区服务器或 N2？

> ID：718162
> 
> 赞同：1
> 
> 时间：2009-04-05T01:09:37.583
> 
> 标签：.net, content-management-system, content-management

我正在创建一个网站，我想在其中发布技术文章。我正在寻找一个可以帮助我轻松发布代码、针对搜索引擎进行了优化并且易于使用和操作的系统。

目前，我没有任何在此开设论坛的计划，也许在将来。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-05T01:28:13.390

如果您想保留 .Net 后端，而不是完整的社区服务器，您可以尝试[BlogEngine.Net](http://www.dotnetblogengine.net/)。源代码在 c# 中可用，并且包含一个代码格式化插件。

如果您不在 Microsoft 服务器上托管，那么我可能会同意 Darth 的建议并使用 WordPress。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T13:04:07.443

现在，您还可以查看[DotNetNuke](http://www.dotnetnuke.com)（[Codeplex 下载](http://dotnetnuke.codeplex.com/)）。安装很简单，有一个社区可以帮助您解决任何问题。

只需添加一个页面并将您的代码粘贴到 text/html 模块中，瞧，完成。

当然，它不会以 pwerty 颜色格式化您的代码，但它会满足您的要求。这是 VB.NET 代码，因此如果在您的系统偏好范围内，则需要 IIS/SQL Server 组合。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-05T13:11:16.740

带有“wp-syntax”插件的 Wordpress 可以很好地突出显示代码。

它使用 GeSHi 突出显示，因此您只需执行以下操作：

```
<pre lang="PHP">
    // code
</pre> 
```

由于它基于 GeSHi，因此它支持更多，并且比 Google Code Prettify 更易于复制和粘贴。

关于 Wordpress 的“过时”性质，可以根据主题（即日期的重要性）以及通过更改永久链接来进行更改。例如“ [http://example.com/article/](http://example.com/article/) ”是可能的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-05T01:19:42.490

**WordPress**是很好的开始。它管理方便，易于设置和使用。几乎所有东西都有一大堆插件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-05T01:35:16.057

我是 Mediawiki 发布代码的粉丝（有一些不错的源代码突出显示插件），特别是因为代码文章通常不像 WordPress 上的博客文章那样具体日期。

# crystal-reports - 基于 SP 参数的 Crystal Reports 查表

> ID：718176
> 
> 赞同：0
> 
> 时间：2009-04-05T01:25:31.243
> 
> 标签：crystal-reports

我有一个报告，它显示来自存储过程的数据行。在报告的顶部，我想显示有关用于生成报告的参数的信息。我的问题是几个参数是外键关系的 ID，但在报告上我想显示描述而不是 ID。描述存储在查找表中，但我不知道如何在 Crystal 中进行此查找。

我正在使用水晶报表 2008。

**编辑：** 我想我可以使用子报告来做到这一点，但这有点像 PITA。如果有人知道另一种方式，我仍然会很感激。我也找到了 SQL 表达式公式，但 Crystal 不允许我使用它们，因为我的数据源是存储过程而不是表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T23:57:57.560

子报告是您最好的选择。或者，将参数描述添加到您的 sp 的结果集中。很遗憾您不能显示参数的值和描述。:(

我认为如果您尝试将查找表添加到报表并在记录选择中使用参数，它实际上会提示输入参数两次……一次用于查找表，另一次用于 sp。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T01:05:42.197

由于描述在您的结果集中，您可以调整显示公式中的空值：“参数：” & If isnull({1stDescription}) then "1st is null," else {1stDescription} & ", " & If isnull ({2ndDescription}) 则 "2nd 为空"，否则 {2ndDescription} & "、" & If isnull({3rdDescription}) 则 "3rd 为空"，否则 {3rdDescription} & "、" & 以此类推。这样你就不会因为子报告而减慢速度

# c# - MonoDevelop 在 windows 中

> ID：718187
> 
> 赞同：6
> 
> 时间：2009-04-05T01:37:41.680
> 
> 标签：c#, mono

是否有在 Windows 上运行的 Monodevelop 版本？如果是这样，我在哪里可以得到它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-09-09T19:30:26.707

MonoDevelop 从 2.2 开始正式支持 Windows。您可以查看[Monodevelop 2.2 中的新增](http://monodevelop.com/Download/What's_new_in_MonoDevelop_2.2)功能或下载最新[版本](http://monodevelop.com/Download)。

> 视窗支持
> 
> 现在正式支持 Windows
> 
> Windows 现在是官方支持的运行 MonoDevelop 的平台。许多 Windows 特定问题已得到修复，并且一些加载项（如调试和颠覆支持）已专门为 Windows 编写。
> 
> Windows 安装程序
> 
> 我们正在发布一个新的 Windows 安装程序，其中包含运行 MonoDevelop 所需的几乎所有内容。唯一的外部依赖项是 gtk#，它在单独的安装程序中提供。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-05T01:42:07.723

看起来您可以在 Windows 上构建并运行它，但我认为还没有可用的二进制*下载*。从文档中，[这里](http://monodevelop.com/FAQ#Does_MonoDevelop_work_on_Windows.3f)：

> MonoDevelop 可以在 Windows 上运行吗？
> 
> 是的。MonoDevelop 可以在 Windows 上的 Mono 上构建和运行，尽管它仍然不稳定并且某些功能可能不可用。我们目前正在开发即将推出的 Windows 安装程序。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-05T01:45:13.007

没有预编译的二进制文件，因此您必须从源代码构建。即便如此，在 Windows 上运行 MonoDevelop 似乎也存在一些稳定性问题（参见[此处](http://monodevelop.com/FAQ#Does_MonoDevelop_work_on_Windows.3f)）。

一些替代方案是[SharpDevelop](http://www.icsharpcode.net/OpenSource/SD/)和/或[Visual Studio Express](http://www.microsoft.com/express/product/)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-05T01:49:30.640

**更新：** MonoDevelop 2.2 及更高版本正式支持 Windows。您可以在这里获取最新版本：http: [//monodevelop.com/Download](http://monodevelop.com/Download)

* * *

目前还没有针对 windows 的 Monodevelop 官方发布。经过一番研究，MonoDevelop 似乎是作为 SharpDevelop 的一个端口开始的，SharpDevelop 是一个用于 Windows 的开源 .Net IDE。也许您可能想研究一下 SharpDevelop，看看它是否满足您的需求。

您可以在 SharpDevelop 网站上找到更多信息：

[http://www.icsharpcode.net/OpenSource/SD/](http://www.icsharpcode.net/OpenSource/SD/)

在 SharpDevelop 中编写应用程序时，您可以专门针对 Mono 框架（Visual Studio Express 无法做到这一点）。我应该在上面的回答中指出这一点。从网站：

> SharpDevelop 能够根据 Microsoft 的 .NET Framework、Microsoft 的 Compact Framework 或 Mono（Novell 赞助的 .NET Framework 的开源实现）的先前版本（如果已安装）编译您的代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-05T08:42:06.777

现在获得 MonoDevelop 最简单的方法是在[VirtualBox下运行](http://www.virtualbox.org/)[openSUSE Linux](http://www.opensuse.org)。真的没那么难。您将获得运行 Mono 和 MonoDevelop 的“真正的” linux 系统，而不会出现任何问题。希望这可以帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-05T01:51:18.387

当前没有可用于 Windows 的 MonoDevelop 的二进制文件。这是因为它没有经过测试并且非常有问题。即：在它崩溃之前，您可能不会再使用一两分钟。希望随着 MD 2.0 的推出，我们很快就会有时间来解决这个问题。

请注意，您不需要 MonoDevelop 来使用 Mono。您可以在 Mono 上使用从 Visual Studio 或 SharpDevelop 生成的相同二进制文件。

# encryption - 如何找到抽取的 LFSR 的多项式？

> ID：718190
> 
> 赞同：8
> 
> 时间：2009-04-05T01:41:57.507
> 
> 标签：encryption

我知道，如果你抽取线性反馈移位寄存器生成的序列，你会得到一个新的序列和一个新的多项式。例如，如果您使用多项式 x ⁴ +x+1 对 LFSR 生成的系列中的每五个元素进行采样，您将得到由 x ² +x+1 生成的系列。我可以通过蛮力找到第二个多项式（x ² +x+1），这对于低阶多项式来说很好。然而，对于高阶多项式，暴力破解所需的时间变得不合理。

所以问题是：是否有可能解析地找到抽取的多项式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T12:26:50.620

最近看了这篇文章，看到你的问题就想到了，希望对你有帮助.. :oÞ

给定 GF(q) 上的一个原始多项式，可以通过抽取从初始多项式获得的 LFSR 序列来获得另一个原始多项式。这在下面的代码中得到了演示。

> K := GF(7); C := PrimitivePolynomial(K, 2); C; D^2 + 6*D + 3 为了生成一个 LFSR 序列，我们必须首先将这个多项式乘以一个合适的常数，使尾随系数变为 1。
> 
> C := C * 系数(C,0)^-1; C; 5*D^2 + 2*D + 1 我们现在能够生成长度为 72 - 1 的 LFSR 序列。初始状态可以是 [0, 0] 以外的任何值。
> 
> t := LFSRSequence (C, [K| 1,1], 48); 吨；[ 1, 1, 0, 2, 3, 5, 3, 4, 5, 5, 0, 3, 1, 4, 1, 6, 4, 4, 0, 1, 5, 6, 5, 2, 6 , 6, 0, 5, 4, 2, 4, 3, 2, 2, 0, 4, 6, 3, 6, 1, 3, 3, 0, 6, 2, 1, 2, 5 ] 我们抽取按具有属性 gcd(d, 48)=1 的值 d 排序。
> 
> t := 抽取(t, 1, 5); 吨；[ 1, 5, 0, 6, 5, 6, 4, 4, 3, 1, 0, 4, 1, 4, 5, 5, 2, 3, 0, 5, 3, 5, 1, 1, 6 , 2, 0, 1, 2, 1, 3, 3, 4, 6, 0, 3, 6, 3, 2, 2, 5, 4, 0, 2, 4, 2, 6, 6] B := BerlekampMassey(t); 乙; 3*D^2 + 5*D + 1 为了得到对应的原始多项式，我们乘以一个常数使其成为单数。
> 
> B := B * 系数(B, 2)^-1; 乙; D^2 + 4*D + 5 IsPrimitive(B); 真的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-10T08:54:27.913

来自[这些注释](https://paginas.fe.up.pt/~hmiranda/cm/Pseudo_Noise_Sequences.pdf)：“m 序列 c 的 n>0 抽取，表示为 c[n]，其周期等于 N/gcd(N,n)，如果它不是全零序列，它的生成多项式 g^( x ) 的根是 g(x) 根的 n 次方"

# url - 虚拟主机 URL 长度限制？

> ID：718205
> 
> 赞同：0
> 
> 时间：2009-04-05T02:00:12.157
> 
> 标签：url, web-hosting

我正在设计一个与我的 iPhone 应用程序相关联的 Web 应用程序。它向网络服务器发送大量 URL（大约 15000 个）。我使用*的是*NearlyFreeSpeech.net，但它们只支持最多 2000 个字符的 URL。我想知道是否有人知道将支持非常大的 URL 的网络托管？谢谢，艾萨克

**编辑：**我的程序需要在 Safari 中打开一张图片。我可以通过两种方式做到这一点：

*   将其发送到 URL 中编码的 base64 并仅回显查询参数。
*   首先将它发布到我的应用程序中的服务器，然后服务器将在将照片存储在数据库中后发回一个唯一 ID，我会将其附加到我将在 Safari 中打开的 URL，该 URL 从数据库中检索照片并将其删除从数据库。

你看，我很懒，而且我知道 Mobile Safari 最多可以支持 URI 的 80 000 个字符，所以我认为这是一个不错的方法。如果这真的有什么问题，请告诉我。

**编辑：**我最终以正确的 POST 方式进行操作。谢谢。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-05T02:09:01.467

如果您要发送 15,000 个字符长的 URL，则很可能：

[替代文字 http://img16.imageshack.us/img16/3847/youredoingitwronga.jpg](http://img16.imageshack.us/img16/3847/youredoingitwronga.jpg)

改用 HTTP POST 之类的东西。

您遇到的限制并不是主机的问题 - 更重要的是 Web 服务器对 URL 的长度有限制。根据[此页面](http://www.boutell.com/newfaq/misc/urllength.html)，Apache 将您限制在 4k 左右的字符，而 IIS 默认将您限制在 16k。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-05T02:06:54.340

虽然它没有直接回答您的问题，并且没有官方的 URL 最大长度，但浏览器和服务器有实际限制 - 有关详细信息，请参阅[http://www.botell.com/newfaq/misc/urllength.html](http://www.boutell.com/newfaq/misc/urllength.html)。简而言之，由于 IE（至少正在使用的某些版本）不支持超过 2,083 个字符的 URL，因此保持在该长度以下可能是明智的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-05T03:06:17.273

如果您只需要在 Safari 中打开它，并且不需要涉及服务器，为什么不使用[`data:`URI](http://www.ietf.org/rfc/rfc2397.txt)呢？

通过网络发送长 URI 基本上从来都不是正确的做法。正如您所注意到的，一些 Web 主机不支持长 URI。一些代理服务器也可能会阻塞长 URL，这意味着您的应用可能不适用于这些代理背后的用户。如果您需要将您的应用程序移植到不同的浏览器，其他浏览器可能不支持那么长的 URI。

如果您需要将数据上传到服务器，请使用 POST。是的，这是一个额外的往返，但它会更可靠。

此外，如果您使用 GET 请求将数据上传到服务器，那么您很容易受到各种[跨站点请求伪造](http://en.wikipedia.org/wiki/CSRF)攻击；基本上，攻击者可以通过让用户点击链接（可能被[TinyURL](http://tinyurl.com/)或其他 URL 缩短服务隐藏，或者只是在他们不这样做时将其作为链接嵌入网页中）来欺骗用户上传，比如说，goatse 到他们的帐户'不要仔细查看他们点击的 URL）。

除了实际上不会更改服务器上任何内容的查询参数之外，您永远不应该使用 GET 向服务器发送数据。

# sql-server-ce - 在数据库中持久保存大字符串的最佳方法是什么？（SQL 紧凑型）

> ID：718215
> 
> 赞同：4
> 
> 时间：2009-04-05T02:21:32.950
> 
> 标签：sql-server-ce

有问题的字符串是（烹饪）食谱的描述字段，最大长度应该是 99% 的用户永远不会遇到的。nvarchar(4000) 似乎限制太多了。

SQL 表中的一列甚至是合适的位置吗？在这样的字段中存储如此（可能）大的值感觉不合适，但也许不是？

不确定这是否重要，但 .NET 3.5 很可能会使用 LINQ2SQL。

编辑：使用 VS Express 数据库资源管理器创建表，它告诉我 4000 是 nvarchar 的最大大小（似乎没有将 varchar 列为选项）。这只是 SQLCE 的一个限制，并表明我必须研究其他东西吗？

如果这确实是 SQLCE 的限制，是否有人有其他建议？对于一个宠物项目，我必须是免费的，最好是易于设置（最好对我和最终用户来说，但更重要的是它易于为最终用户设置）。数据库将是本地的，并且性能不是太大的问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-05T02:31:24.487

你对现有的食谱做过研究吗？varchar(4000) 会给你大约 400-500 个单词，我很确定在我拥有的许多食谱中没有多少食谱的描述比这更长。

VarBinary 将为您提供 8000 个字节，但如果您要使用 varbinary 在描述字段中进行任何搜索，则可能需要强制转换或其他会导致性能下降的操作。

最后，虽然我不是特别喜欢这样，但您可以将描述规范化到另一个表中，这将允许您设置一对多关系并使配方具有多个描述部分，您可以在界面中重新组合这些部分.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T09:22:27.010

不一定推荐，但提供，因为他们突然想到：

如果文本在存储后很少更改，您可以考虑创建一个存储“行”文本的新表，例如：

```
recipe_id integer,
line_number integer,
line_text nvarchar(80) 
```

或者，如果您不需要搜索食谱的文本，那么简单的压缩算法怎么样？[霍夫曼编码](http://en.wikipedia.org/wiki/Huffman_coding)在文本上相当有效，而且 CPU 密集度不高。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-18T17:06:04.037

另一种方法是将文本保存为文件，数据库仅存储文件名。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-28T17:07:20.933

ntext is your best bet as it can store half a million characters, if that's too small this could be combined with other solutions such as splitting up the row could be used.

[https://technet.microsoft.com/en-us/library/ms172424.aspx](https://technet.microsoft.com/en-us/library/ms172424.aspx)

You should keep in mind that there's a max database size of 4GB with SQL compact, so migrating to a different database type might be preferable if you intend on storing a lot of these records.

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-05T02:23:41.477

大多数 SQL 数据库都足够聪明，可以自动为大型 VARCHARS 和 TEXT 列执行此操作。与其在创建行时为大列分配空间，不如以这样一种方式存储每一行​​的数据，以便它只占用比实际内容稍多的空间（而不是最大大小）。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-05T02:28:30.310

我从未使用过 SQL CE，但看看它是否支持 VARCHAR(MAX) 数据大小。基本上，它在 800K 行大小限制范围之外存储大量文本（最多 2GB），但也允许您使用 '=' 和其他 WHERE 子句运算符（仅支持 LIKE 的 TEXT 数据类型）。

# javascript - 通知用户他们需要停止使用 IE6

> ID：718218
> 
> 赞同：1
> 
> 时间：2009-04-05T02:25:52.610
> 
> 标签：javascript, jquery, internet-explorer-6

是否有任何 jQuery 插件或模板可以让人们停止在他们的网站上使用 IE6？
我最近看到一个非常突兀和冒犯的插件，它“警告”了 IE6 的邪恶用户。我正在寻找可以向他们的客户展示的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-05T02:33:41.827

只需添加一个只有 IE6 用户才能看到的 div。

```
<!--[if IE 6]>
<div>
  Using IE 6 will curve your spine, please upgrade your version
  of Internet Explorer or download Firefox, Opera, Safari or Chrome.
</div>
<![endif]--> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-05T11:33:43.823

请记住，由于大公司的 IT 部门，许多 Web 用户使用 IE6 被“阻止”。

他们已经知道升级的必要性，而您的信息使他们进一步恶化。为什么让他们更痛苦？至少给一个温和的信息解释为什么你不能支持 IE6。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-05T02:34:43.247

您可以使用 CSS 自己编写代码。

在 HTML 中使用条件注释来为 IE6 使用特定的样式表

```
<!--[if IE6]>  whatever  <![endif]--> 
```

或者将消息放在一个层（div）中并使其仅对 IE6 可见：

```
display: none !important;
*display: block; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-05T03:04:53.797

我个人发现任何类型的消息告诉我使用特定的浏览器既傲慢又是开发人员/设计师懒惰的标志。

我的理由是，如果*我*能够以某种方式做出兼容的跨浏览器设计，为什么其他人不能呢？当您考虑作为 javascript 库或 JQuery 插件存在的“浏览器规范化器”时，它变得更加微不足道，它们基本上消除了细微的差异。

这是我的意思的一个[很好的例子。](http://devsnippets.com/article/15-jquery-plugins-to-fix-and-beautify-browser-issues.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-05T02:38:20.240

这个怎么样？在页面顶部放置一个礼貌的通知栏。（由[think2loud](http://think2loud.com/build-an-unsupported-browser-warning-with-jquery/)提供，请参阅此链接以获取完整的源代码、示例、css 等）。

```
function badBrowser(){
    if($.browser.msie && parseInt($.browser.version) <= 6){ return true;}

    return false;
}

function getBadBrowser(c_name)
{
    if (document.cookie.length>0)
    {
    c_start=document.cookie.indexOf(c_name + "=");
    if (c_start!=-1)
        { 
        c_start=c_start + c_name.length+1; 
        c_end=document.cookie.indexOf(";",c_start);
        if (c_end==-1) c_end=document.cookie.length;
        return unescape(document.cookie.substring(c_start,c_end));
        } 
    }
    return "";
}   

function setBadBrowser(c_name,value,expiredays)
{
    var exdate=new Date();
    exdate.setDate(exdate.getDate()+expiredays);
    document.cookie=c_name+ "=" +escape(value) + ((expiredays==null) ? "" : ";expires="+exdate.toGMTString());
}

if(badBrowser() && getBadBrowser('browserWarning') != 'seen' ){
    $(function(){
        $("<div id='browserWarning'>You are using an unsupported browser. Please switch to <a href='http://getfirefox.com'>FireFox</a>, <a href='http://www.opera.com/download/'>Opera</a>, <a href='http://www.apple.com/safari/'>Safari</a> or <a href='http://www.microsoft.com/windows/downloads/ie/getitnow.mspx'>Internet Explorer 7</a>. Thanks!&nbsp;&nbsp;&nbsp;[<a href='#' id='warningClose'>close</a>] </div> ")
            .css({
                backgroundColor: '#fcfdde',
                'width': '100%',
                'border-top': 'solid 1px #000',
                'border-bottom': 'solid 1px #000',
                'text-align': 'center',
                padding:'5px 0px 5px 0px'
            })
            .prependTo("body");

        $('#warningClose').click(function(){
            setBadBrowser('browserWarning','seen');
            $('#browserWarning').slideUp('slow');
            return false;
        });
    }); 
} 
```

# asp.net-mvc - 关于 ASP.NET MVC 和使用 HTTP-POST 的表单发布的问题

> ID：718219
> 
> 赞同：2
> 
> 时间：2009-04-05T02:26:36.243
> 
> 标签：asp.net-mvc, controller

我有一个标准的 ASP.NET MVC 表单帖子。

例如。

```
<% using (Html.BeginForm<CommentController>(c => c.Create())) { %>    
..
<% } %>

(and in the controller)

[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Create(Comment comment)
{ .. } 
```

现在，我怎样才能让我*忽略*对象中可能存在的某些值，例如`ID`或属性？`CreatedOn``Comment`

有没有办法可以定义**排除/黑名单**？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-05T02:41:04.120

将[BindAttribute](http://msdn.microsoft.com/en-us/library/system.web.mvc.bindattribute.aspx)与 Exclude 标记一起使用

```
public ActionResult Create( [Bind(Exclude="ID, CreatedOn")]Comment comment )
{
} 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-04-05T02:34:18.237

默认情况下，您在表单 HTML 中的任何输入都将随提交一起传递。

抱歉，我没有想到答案，但我会先研究一些可能的 jQuery 插件和/或一些 AJAX 过滤机制。

# iphone - 在 UIViewController 上使用 setDelegate: 是什么意思？

> ID：718221
> 
> 赞同：1
> 
> 时间：2009-04-05T02:28:50.123
> 
> 标签：iphone, cocoa-touch, objective-c

我最近在 UIApplicationDelegate 类中看到了一些代码，如下所示：

```
[rootViewController setDelegate:self]; 
```

在这里为 UIViewController 设置委托到底是什么意思？委托属性将触发什么类型的事件？

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2009-04-05T02:32:10.803

UIViewController 上没有 setDelegate 方法，所以它没有任何意义，只会触发“不响应选择器”异常。

# css - 为什么 a:hover 在 CSS 中会被覆盖？

> ID：718226
> 
> 赞同：5
> 
> 时间：2009-04-05T02:34:10.033
> 
> 标签：css, hyperlink, overriding, hover

如果我有这个 CSS：

```
a:link { color: blue; }
a:hover { color: red; }
#someID a:link { color: black; } 
```

ID 下的链接在悬停时始终显示为黑色。我知道使用 ID 具有更高的优先级，但是，我没有覆盖`:hover`选择器，只有`:link`选择器，所以悬停不应该显示为红色吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-05T02:51:56.713

`:link`即使您将鼠标悬停在链接上，伪类也适用于链接。由于带有 id 的样式更具体，它会覆盖其他样式。

`:hover`样式完全覆盖样式的唯一原因`:link`是它出现在样式表的后面。如果您按此顺序放置它们：

```
a:hover { color: red; }
a:link { color: blue; } 
```

样式在`:link`样式表的后面并覆盖`:hover`样式。当您将鼠标悬停在链接上时，该链接保持蓝色。

要使`:hover`样式适用于黑色链接，您必须使其至少与`:link`样式一样具体，并将其放在样式表中的后面：

```
a:link { color: blue; }
a:hover { color: red; }
#someID a:link { color: black; }
#someID a:hover { color: red; } 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-04-05T02:46:59.300

正如 W3Schools 中所解释的，存在顺序问题：

> 注意：a:hover 必须在 CSS 定义中的 a:link 和 a:visited 之后才能生效！！
> 
> 注意：a:active 必须在 CSS 定义中的 a:hover 之后才能生效！！

[http://www.w3schools.com/CSS/css_pseudo_classes.asp](http://www.w3schools.com/CSS/css_pseudo_classes.asp)

# php - 在 PHP 中，如何添加到零填充的数字字符串并保留零填充？

> ID：718229
> 
> 赞同：11
> 
> 时间：2009-04-05T02:37:31.913
> 
> 标签：php, variables, string-formatting, zero-pad

如果我在 PHP 中有一个变量，`0001`并且我在其中添加 1，则结果是 2 而不是`0002`.

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-05T02:39:58.660

```
$foo = sprintf('%04d', $foo + 1); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-05T04:28:48.573

它可能会帮助您了解 PHP 数据类型以及当您对各种类型的变量进行操作时它们如何受到影响。你说你有“PHP中的一个变量说0001”，但那个变量是什么类型的？可能是一个字符串“0001”，因为整数不能具有该值（它只是 1）。所以当你这样做时：

```
echo ("0001" + 1); 
```

...`+`操作员说，“嗯，这是一个字符串和一个整数。我不知道如何添加一个字符串和一个 int。但我知道如何将一个字符串转换为一个 int，然后将两个 int 加在一起，所以让我这样做，”然后它将“0001”转换为1。为什么？因为将字符串转换为整数的 PHP 规则表明字符串中任意数量的前导零都将被丢弃。这意味着字符串“0001”变为1。

然后`+`说，“嘿，我知道如何将 1 和 1 相加。它是 2！” 该语句的输出为 2。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-05T02:51:00.147

另一种选择是[str_pad()](http://php.net/str_pad)函数。

```
$text = str_pad($text, 4, '0', STR_PAD_LEFT); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-04-15T20:06:14.193

```
<?php
#how many chars will be in the string
$fill = 6;
#the number
$number = 56;
#with str_pad function the zeros will be added
echo str_pad($number, $fill, '0', STR_PAD_LEFT);
// The result: 000056
?> 
```

# database-design - 数据库设计：跟踪每个用户的大量属性。如此之多，以至于我可能会用完列（行存储空间）

> ID：718231
> 
> 赞同：8
> 
> 时间：2009-04-05T02:38:09.353
> 
> 标签：database-design

对于我所关心的问题，我将不胜感激。

我的数据库中有一个 [User] 表，其中包含您期望的基本内容，例如用户名、密码等...

这个应用程序要求我跟踪每个用户的大量属性。如此之多，以至于我可能会用完列（行存储空间）。

我很想添加一个包含 UserID、PropertyKey 和 PropertyValue 列的 UserProperties 表。这种方法非常符合要求。

我担心的是，如果每个用户都有 100 个属性，当数据库中有 100 万用户时，我们将有 100,000,000 个属性行。

我认为使用 UserID 上的聚集索引，访问仍然会非常快，并且您实际上存储的数据量与使用巨型列方法的数据量大致相同。

关于性能问题的任何想法或想法？更好的数据库设计的想法？

**更新：**

我一直在玩弄各种可能性，但有一件事一直困扰着我。我需要非常频繁地查询其中一些属性，更糟糕的是，这些查询可能涉及同时查找与多达 10 个这些属性的条件匹配的所有用户。

因此，我现在倾向于使用巨型列方法，但可能会将数据拆分到一个（或多个）单独的表中，形成以 UserID 为键的一对一关系。

我正在使用 LinqToSql，虽然我认为具有这么多列的表不优雅，但考虑到所有挑战和权衡，我认为它可能是正确的，但我仍然渴望听到其他意见。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-05T03:01:06.550

您所描述的是一个实体-属性-值数据库，它通常用于您所描述的情况，即与单个实体相关的稀疏数据。

EAV 表很容易搜索。问题不是查找行，而是查找相关行。

为不同的实体提供不同的表提供了域建模，但它们也提供了一种弱形式的元数据。在 EAV 中没有这样的抽象。（Java 与 EAV 的类比是声明所有函数的形式参数都是 Object 类型——所以你不会得到类型检查。）

我们可以很容易地查找属性键，但没有任何东西对这些属性键进行分组。

Wikipedia 上有一篇关于 EAV 的非常好的文章，但现在就阅读它——它主要是一位作者的作品，并且计划进行“改进”。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-05T05:44:52.163

我建议您考虑称为垂直分区的方法。这意味着您继续使用 UserID 键定义表，您可以将它们称为 User1、User2 等。当您达到数据库的最大行大小时启动一个新表。这种方法的好处是这些值仍然是真正的数据库属性。这将在处理这些数据时节省时间，例如数据绑定。

要回答的关键问题是：这些真的是属性吗？它们是否代表您必须收集的有关用户的信息结构。如果是这样，对它们建模的最佳方法是使它们成为列。您必须使用垂直分区的唯一原因是数据库的行大小限制。

另一方面，如果需要一个灵活的属性系统，那么一定要使用属性键/属性值系统。例如，如果允许用户动态定义自己的属性，那么您肯定需要键/值系统。但是，如果您了解数据的结构并为用户合法地识别了数百个属性，我会说键/值不是最好的方法。

作为旁注，我必须说您应该质疑具有大量属性的实体。它们可能是有效的，但您也很可能在概念级别上遗漏了一些实体。换句话说，可能所有这些属性都与用户本身无关，而是与与用户相关的某个其他实体有关。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-05T02:42:27.953

UserProperties 表方法是我对其建模的方式。正如您所建议的，用户 ID 上的聚集索引将意味着用户 ID 上的范围搜索将很快（即与单个用户相关的所有属性）。还可以在 UserID 和 PropertyKey 上为每个用户的单个键 2 值选择添加非聚集索引。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-05T02:42:48.467

我怀疑您会在用户表中拥有如此多的一对一数据值，以至于您会用完行空间。您应该只将一对多的值卸载到另一个表中，使用用户 ID 作为外键。我发现您的用户表不太可能需要这么多 VARCHAR() 字段，这些字段无法以某种方式从主值表转换为 FK。你维护什么样的用户属性？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-05T02:43:38.513

有什么方法可以对属性进行逻辑分组？您可能并不总是需要访问每个属性。此外，如果将它们按逻辑分组，则更容易理解可用的属性、新属性的适合位置等……

分组可以与用户具有一对一或一对多的关系......

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-05T02:46:37.350

我们已经在几个项目中实施了 UserProperties 策略。这是一种常见的模式，并且使用适当的索引，我们从未遇到过性能问题。

另一个优点是，如果需要管理用户访问，您可以拥有两个或更多属性表。例如，一般属性可能在 PublicUserProps 表中，而敏感信息（我不知道您在存储什么，但 ssn、工资信息等）可能在 ControlledUserProps 表中，只有某些用户会读取或编辑该表权利。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-05T02:50:27.217

我喜欢 Mitch Wheat 和你自己描述的元表方法。但是，如果您有一些字段会比其他字段更频繁地使用（例如姓名等），那么您可能会发现将这些字段放在 User 表中可能是有益的，然后将 user 表链接到 UserProperties。我想这一切都取决于您设计的确切细节。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-05T02:54:23.277

我能想到的几个选项：

*   位字段：您可以在其中存储许多值，并且可以根据需要添加更多字段，甚至可以使用单独的表
*   将最常见的设置放在用户表中，将每个用户可能没有的设置放在第二个表中
*   仅存储与默认设置不同的设置

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-05T02:59:16.807

鉴于规定的限制，我认为您真的别无选择！

好的，您可以将用户属性拆分到多个共享相同 UserId 作为主键（和聚集索引）的表中，但这可能会或可能不会提高性能

如果您只谈论 100 个属性，这可以由一张表处理（在 MS-SQL 中，最大为 1023 个非键列）；如果属性只是稀疏填充，那么用户属性表可能会更节省空间（只有您的分析器肯定知道）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-05T03:38:50.050

> 我认为使用 UserID 上的聚集索引，访问仍然会非常快，并且您实际上存储的数据量与使用巨型列方法的数据量大致相同。

我认为使用属性表，您最终会存储比您实际需要的更多的东西。即用户 id 的额外索引、属性键列，以及属性值需要能够处理通用性质的值，这使得优化变得困难。

我的建议是尝试将所有内容放在一张表中，然后用一些测试数据启动它。*如果*它不起作用，那么您可以采用多表解决方案甚至非数据库解决方案（毕竟它们不是灵丹妙药）。

# sql - 如何在 Linux 机器上练习我的 SQL Server、Sybase 和 Oracle 技能？

> ID：718239
> 
> 赞同：1
> 
> 时间：2009-04-05T02:43:25.673
> 
> 标签：sql, sql-server, oracle, sybase

我有一个linux盒子。当我有一个 Windows 机器时，我可以下载免费的非商业用途的 MS SQL Server。

如何在我的 linux 机器上运行 SQL Server、Sybase 或 Oracle 的免费个人副本？

我不需要任何永久数据库或任何大量存储空间。我只想（重新）熟悉这些不同的 SQL 方言，并将技术和时间与我安装的 MySQL 和 postgresql 进行比较。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-05T02:54:56.940

至少对于 Oracle，他们有他们的[Express Edition](http://www.oracle.com/technology/products/database/xe/index.html)，可以免费下载并且可用于 Linux。

对于 SQL Server，您必须将 Windows 作为单独的操作系统或在虚拟机（如 Virtual Box 或 VMWare）中获取。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-05T02:55:04.507

SQL Server 不在 Linux 上运行。 然而，[MySQL会并且很可能随您的 Linux 发行版一起提供。](http://www.mysql.com/)

Oracle 下载地址[在这里](http://www.oracle.com/technology/software/products/database/oracle11g/111060_linuxsoft.html)。

Sybase 来[了](http://www.sybase.com/linuxpromo)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-05T03:04:35.310

使用 Xen 或 VMWare 创建运行 Windows 或您喜欢的任何平台的新虚拟机。

如果您将 VM 设置为全屏，则它非常类似于本地运行。或者，通过 linux 远程桌面/RDP 客户端连接到您的虚拟机。

如果您有学生证，您可以通过 Microsoft Dreamspark 免费获得 Windows Server 2003 和 2008 + SQL Server 2005 和 2008 + VS 2005 和 2008 + 一堆其他好东西 --- [https://www.dreamspark.com/](https://www.dreamspark.com/)

请注意，您可能可以通过在当地社区学院注册随机课程（然后放弃）来获得学生证。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-07T04:45:32.603

**开始使用 Oracle 的最简单方法**

*   在此处获取免费的 vmware 播放器：

    [http://www.vmware.com/products/player/](http://www.vmware.com/products/player/)

*   还有这里的 vmware oracle 设备：

    [http://www.vmware.com/appliances/directory/62414](http://www.vmware.com/appliances/directory/62414)

运行此程序将为您提供已安装和配置的服务器。下载（也是免费的）客户端和开发人员工具，然后就可以了。

# .net - .net：如何调试 XmlSerializer.Deserialize 错误？

> ID：718243
> 
> 赞同：3
> 
> 时间：2009-04-05T02:46:40.720
> 
> 标签：.net, xml-serialization

在开发过程中，我不止一次看到这样的 xml 读取错误：

TestData.ReadFromXml: xml Deserialize error:There is an error in XML document (2, 2)..

(2, 2) 到底指的是什么？它是 xml 文件中的第 2 行吗？第 2 行，令牌 2，什么？

有没有我可以添加的调试选项来阐明问题？

编辑：这是前两行：

```
<?xml version="1.0" encoding="utf-8"?>
<TestSession xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"> 
```

那么它会抱怨第二行的'T'字符吗？这是我刚刚序列化的一个类，格式很好。反序列化时，我认为它不喜欢类中的某些内容……这可以解释为什么它在 TestSession 中的 T 处停止。如果它告诉你它不喜欢什么，那就太好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-07T19:21:36.383

它是 (line, character) 并且从 1 开始（不是基于 0）。

您应该检查`InnerException`以获取更准确的错误消息。看看你的例子，它可能是这样的：

```
"<TestSession> was not expected." 
```

您还可以通过应用`XmlRootAttribute`到您的班级来更改序列化名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T02:51:26.590

这是第 2 行，第 2 个字符。

我建议您在 Visual Studio 中打开 XML 文件，然后查看“错误”窗口，看看它是否有任何问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T02:54:26.910

尝试一些 xml 验证工具来验证您的 xml 文件/内容，做一个谷歌，你会找到一些。

# boost - 在 Boost Build 中链接 libexpat 的问题 - 用于构建 graphml

> ID：718269
> 
> 赞同：1
> 
> 时间：2009-04-05T03:08:31.870
> 
> 标签：boost, boost-build, graphml

在我的系统上，expat 位于

```
/usr/include/expat.h
/usr/include/expat_external.h
/usr/lib/libexpat.1.5.0.dylib
/usr/lib/libexpat.1.dylib
/usr/lib/libexpat.dylib
/usr/lib/libexpat.la

```

所以我导出了boost所需的变量来构建*graphml*

```
导出 EXPAT_INCLUDE=/usr/include
导出 EXPAT_LIBPATH=/usr/lib

```

然后我运行（其中 $DIR 和 $BOOST 生成我想要包含和库去的路径）

```
./configure --includedir=$DIR/$BOOST --libdir=$DIR/$BOOST/lib \
            --with-libraries=test,graph

```

我收到此错误：

```
ld：找不到 -lexpat collect2 的库：ld 返回 1 个退出状态

```

boost 说的是由以下行引起的：

```
g++ -dynamiclib -install_name "libboost_graph-mt-1_35.dylib" -L"/usr/lib"
    -o“bin.v2/libs/graph/build/darwin/release/macosx-version-10.4/threading-multi/libboost_graph-mt-1_35.dylib”
    “bin.v2/libs/graph/build/darwin/release/macosx-version-10.4/threading-multi/read_graphviz_spirit.o”
    “bin.v2/libs/graph/build/darwin/release/macosx-version-10.4/threading-multi/graphml.o”   
    -lexpat -isysroot /Developer/SDKs/MacOSX10.4u.sdk -mmacosx-version-min=10.4 -Wl,-dead_strip -no_dead_strip_inits_and_terms

```

我不明白为什么找不到带有`-L"/usr/lib"`和`-lexpat`作为参数的 expat 库？我的理解是 /usr/lib/libexpat.dylib 被完全引用为`-L"/usr/lib"`and `-lexpat`。

用于构建 graphml 的 Jamfile 在[这里](https://svn.boost.org/trac/boost/browser/trunk/libs/graph/build/Jamfile.v2)。如果`EXPAT_INCLUDE`并且`EXPAT_LIBPATH`未设置，则它会警告您（jamfile 的第 39-41 行）

> 警告：图形库不包含可选的 GraphML 阅读器。
> 注意：要启用 GraphML 支持，请设置 EXPAT_INCLUDE 和
> 注意：分别包含 Expat 标头和库的目录。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T03:14:45.520

**另一个更新：** 我在您的 EXPAT 所在列表中没有看到 .so 或 .a 文件……这看起来有点奇怪吗？通常它会为库名创建一个别名

例如 /usr/lib/libblah.so -> /usr/lib/libblaah.so.1.2

dynalib 是不是有点 Macintoshism（我不怎么用 Mac）

.la 是这个平台上的静态版本扩展名吗？

**更新：**

路径周围的引号似乎很麻烦... -L"/usr/lib"

尝试将其更改为 -L/usr/lib 和 -L /usr/lib

**较旧的东西：**

链接器在链接步骤中包含路径的指令是 -L。您需要查找一些要更新的链接器标志以包含 -L path_to_expat。我认为链接器不会关注 LD_LIBRARY_PATH。我不确定您阅读了哪些文档来设置 EXPAT_INCLUDE 或 EXPAT_LIBPATH。

# c# - 如何申请 标记到文本字段

> ID：718270
> 
> 赞同：0
> 
> 时间：2009-04-05T03:10:25.563
> 
> 标签：c#, sql, regex, string

我在 SQL Server 中有一个 varchar() 字段，在段落标记之间有一些回车/换行符。

我想把它变成格式正确的 HTML。

例如：

- - - - - 前 - - - - -

敏捷的棕色狐狸跳过了懒惰的狗。然后他觉得无聊，就去睡觉了。之后，他和他的朋友们一起玩。

第二天，他和他的朋友们举行了一个盛大的聚会。

* * *

- - - - - 后 - - - - - -

<p>敏捷的棕色狐狸跳过了懒惰的狗。然后他觉得无聊，就去睡觉了。之后，他和他的朋友们一起玩。</p>

<p>第二天，他和他的朋友们举行了一个盛大的聚会。</p>

* * *

这样做的正确方法是什么？显然，正则表达式将是一个很好的方法，但我无法弄清楚如何以一种理智的方式将字段的开头与 crlf （回车/换行）组合一起捕获。

那里有任何正则表达式天才吗？希望得到一些帮助。如果是的话，谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-05T03:26:48.580

这样的事情不需要正则表达式。纯字符串操作可以做到。（C# 中的示例）：

```
text = "<p>" + text.Replace("\r\n", "</p><p>") + "</p>"; 
```

（取决于换行符是否依赖于系统，您应该使用特定的字符串`"\r\n"`或属性`Environment.NewLine`。）

如果字符串最初来自用户输入，因此您无法完全控制它，则必须在放入段落标签之前对其进行正确的 html 编码，以防止跨站点脚本攻击。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-05T04:28:56.543

并且不要忘记添加 <p> 标记是不够的，您必须转义 HTML 中具有特殊含义的字符（< 变为 < 等等），否则最终可能会导致页面损坏甚至脚本注入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T05:50:47.750

如果文本已经用换行符分成段落，它可能很简单

```
text = Regex.Replace(text, ".+", "<p>$0</p>"); 
```

这假设段落之间没有 HTML 特殊字符（如 Thilo 所述）或额外的空白字符，如下所示：`"text\n \nmore text"`. 在添加标签之前，您可能需要处理类似的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-13T19:16:45.997

如果字符串最初来自用户输入，因此您无法完全控制它，则必须在将段落标签放入之前对其进行正确的 html 编码

```
yourString="p" + text.Replace("\r\n","<p></p>") + "</p>"; 
```

# java - 在 Java 中，如何以类似诅咒的方式在控制台中获取用户输入？

> ID：718273
> 
> 赞同：0
> 
> 时间：2009-04-05T03:13:30.953
> 
> 标签：java, syntax, formatting, input, console

我刚开始在学校为 cse142 学习 Java，但我对编程有所了解，因此在课堂上遥遥领先，并且一直在尝试自己的小项目。通常，如果我遇到问题，我只是解决它，因为我认为我还没有学到这一点，但是这个问题足以让我对此提出一个完整的线索。

我想在控制台生成以下输入/输出。

```
Window size? (x, y) : 250, 200 
```

250/200 将是用户输入，例如，起初你会看到

```
Window size? (x, y) : 
```

你输入“250”然后回车然后你看到

```
Window size? (x, y) : 250, 
```

在输入“200”并按回车后，你会得到

```
Window size? (x, y) : 250, 200 
```

然后它继续程序。

作为第二个问题，我想知道是否可以让用户输入一个方程。我正在考虑将他们键入的内容存储到字符串中，但这只是文本，需要转移到 Java 可运行方程中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-05T03:41:22.913

您可以使用 Scanner 类从用户那里获取输入，如下所示：

```
import java.util.Scanner;

public class test
{
    public static void main (String args[])
    {
        Scanner input = new Scanner(System.in);
        System.out.print("Window size? (x, y) : ");
        int xValue = input.nextInt();
        System.out.print("\nWindow size? (x, y) : " + xValue + " , ");
        int yValue = input.nextInt();
        System.out.print("\nWindow size? (x, y) : " + xValue + " , " + yValue);
    }
} 
```

更多关于扫描仪的信息：http: [//java.sun.com/j2se/1.5.0/docs/api/java/util/Scanner.html](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Scanner.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T13:32:37.877

我相信[jLine](http://jline.sourceforge.net/)可以做你想要的。它是 BSD 许可的，因此您可以完全自由地使用它。

从 jline 网站：

> 它的功能类似于 BSD editline 和 GNU readline。熟悉现代 shell（例如 bash 和 tcsh）的 readline/editline 功能的人会发现 JLine 的大多数命令编辑功能都很熟悉。

至于问题的第二部分（用户输入的方程式），请查看[beanshell](http://beanshell.org/)。出于您的目的，它很简单：

```
bsh.Interpreter i = new bsh.Interpreter();
String formula = "2 * 2;"
Object result = i.eval(formula); 
```

你可以用 beanshell 做更多*的事情；*该公式本质上可以是 Java 代码，您可以将所需的任何对象放入解释器的“上下文”中，以供正在评估的脚本访问。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T03:34:11.620

不幸的是，没有任何支持您尝试在 Java 中执行的操作。您可以通过 System.out 打印“窗口大小？（x，y）：”，并通过 BufferedReader/System.in 读取文本，但您无法控制由于用户输入而出现在控制台中的内容。如果您需要这种行为，请尝试查找 CURSES 库；我个人不能推荐任何人。

至于评估等式，您可以解析您读入的字符串（研究构建某种抽象语法树）。您还可以使用该字符串构造一个 .java 文件，并通过 Process 类调用 javac 和 java 来编译和运行它，通过 Process.getInputStream() 读取结果；这是一个非常讨厌的解决方案，但会接受所有单行 java 语句。这样的解决方案以安装的 JDK 为前提，单独的 JRE 不提供 javac。

# file-io - Fortran 90 打开文件

> ID：718274
> 
> 赞同：2
> 
> 时间：2009-04-05T03:14:32.650
> 
> 标签：file-io, fortran

我一直在使用“account.txt”处理关于银行账户交易（取款、存款、支票兑现和余额查询）的项目。我的 TA 说我必须使用临时文件。该临时文件将逐行读取以查找用户正在查找的内容。但是，我根本不理解这个临时的 OPEN 文件。有没有人解释那是什么，如果可能的话，你会附上它的例子吗？

**以下是项目说明：** 这个项目是关于编写一个在银行账户上执行交易的程序。您将获得一个包含银行所有账户的文件（该文件名为“account.txt”）。您的程序是为用户提供一个交互式菜单以在这些帐户上执行交易。您的程序需要在每次交易后更新帐户文件。用户可以对不可用的账户进行交易。您的程序需要在屏幕上打印错误消息并返回菜单。此外，您的程序需要打印交易是否成功。对于不成功的交易，您的程序将打印出交易失败的原因。

您的程序需要能够处理以下事务：

*   将钱存入账户
*   从账户中取款
*   支票兑现帐户
*   账户余额查询

一个储蓄账户可以兑现多少张支票是有限制的。限制为每月 2 次支票。每张超过限额兑现的支票将被罚款 0.25 美元。如果有足够的资金来兑现支票但没有罚款，则交易应该通过并且由此产生的余额将为零。

这是一个帐户的帐户文件中的格式（数据字段由一个空格分隔）：

```
Account type, S for saving, C for checking (1 character)
Account number of 5 digits
Last name of account holder (15 characters)
First name of account holder (15 characters)
Balance of the account in the form xxxxx.xxx
An integer field indicating how many checks have been cahsed this month (three digit)
An interest rate in the form of xx.xx (e.g. 10.01 = 10.01%)
For names with fewer than 15 characters, the data will be padded to have width of 15 characters. 
```

这是帐户文件的示例：

```
C 12345 Smith           John              100.000  10  0.00
S 45834 Doe             Jane             3462.340   0  0.30
C 58978 Bond            Jones              13.320   5  0.00 
```

*创建临时文件 FORTRAN 中有一种方法可以创建临时文件。使用：OPEN(UNIT = , STATUS = "SCRATCH", ...) 无需提供 (FILE = ””)。通过使用临时文件，您可以将帐户从帐户文件复制到临时文件。然后，当您将数据从临时文件复制回帐户文件时，执行必要的事务。如果交易失败，您的程序不应在这两个文件之间复制帐户。

请原谅我的英语，我是日本人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-05T05:29:52.870

有人说这样的声明：

```
OPEN (7, ACCESS = 'DIRECT',STATUS = 'SCRATCH') 
```

您可以创建一个临时文件——该文件只会在您关闭它之前存在，并且不会保存到磁盘上。这个文件不需要名称（它永远不会被名称引用），只需一个单元号（在我的示例 7 中）。

您可以使用此文件在交易期间临时保存帐户信息。您需要这个，因为当您将行插入到实际文件中时，您不想覆盖后续数据。所以他们说：

*   将所有内容复制到临时文件
*   如果事务成功，将数据复制回主文件，但
    *   省略要删除的行
    *   添加要插入的行

这有帮助吗？

# sql-server - 将数据库移动到生产服务器需要什么版本的 SQL Server？

> ID：718280
> 
> 赞同：4
> 
> 时间：2009-04-05T03:21:22.570
> 
> 标签：sql-server, backup

我刚刚在本地 Windows XP 机器上完成了 ASP.NET 的开发。我使用 Visual Studio 2008 和 SQL Server express 来开发站点。

我的问题是现在我想将 SQL Server 数据库从我的 XP 机器移动到我的生产服务器。

我一直在阅读 SQL Server express 无法导出我的数据库。它是否正确？导出我的 SQL Server Express 数据库以便我可以将其部署在我的生产服务器上的最佳方法是什么。

IE 我需要下载并安装完整版的 SQL Server 吗？如果是这样，什么版本最好。

这非常令人沮丧，因为我已经将信息添加到数据库中，并且如果可能的话，我不想丢失所有这些信息。

任何帮助将不胜感激...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-05T03:27:55.567

SQL Server Express 可以很好地做到这一点——它使用与更昂贵的版本相同的本机文件格式。您需要做的就是分离 db 文件，将其复制到生产环境，将生产服务器附加到复制的文件，然后您就很好了……嗯，大部分都很好。这不会涵盖某些内容，例如登录或维护作业，但所有数据、存储过程和索引都将在那里。

SQL Server Express 不会*将*您的数据库导出为 csv 之类的格式。甚至这也不完全正确。只是 express management studio 缺乏该功能：IIRC 如果将完整版的 sql server management studio 连接到 express server db，则可以使用 Export 功能。

更进一步，如果您*确实*需要从 management studio express 导出数据，您仍然可以设置查询窗口以将查询结果保存到文件并编写一组导出查询。

# javascript - 获取页面代码的URL嵌入在

> ID：718287
> 
> 赞同：0
> 
> 时间：2009-04-05T03:30:32.753
> 
> 标签：javascript, url

我有一段 javascript 代码。现在它强制用户手动输入他们想要插入的页面的 url。这有点麻烦。有没有办法可以自动获取页面的 url 并使每个人的生活更轻松？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-05T03:32:12.827

```
var url = window.location.href; 
```

[参考](https://developer.mozilla.org/en/DOM/window.location)

# orm - 在设计数据库模式时，代表子属性的表（在 OO 世界中）是否应该引用其父级？

> ID：718291
> 
> 赞同：0
> 
> 时间：2009-04-05T03:33:05.647
> 
> 标签：orm

自从我不得不使用关系数据库已经有一段时间了（我在我的个人项目中尽可能地避免它，并且在工作中我们使用对象数据库）所以我相当确定这是正确的方式，但我想确定一下。

从现有对象层次结构建模关系数据库时，通常情况下，非原始子属性应该放在它们自己的表中，并引用父对象的 ID（表行事物）。从 OO 的角度来看，这似乎有点倒退（显然我意识到关系与 OO 有很大不同），但我想这是表示一对多关系的唯一方法（感觉应该更准确地描述为多-一对一，因为一个父母没有引用许多孩子，而是许多孩子条目引用了一位父母）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-05T03:39:11.937

是的。

在一对多关系中，子节点指向父节点。

在多对多关系（以及与属性、三元关系等的一对多关系）中，您有关系表。

在一对一关系中，您可以合并表，或者任一实体都可以指向另一个。

虽然这绝不是唯一的方式，但它肯定是表示关系的唯一理智的方式。所有其他我能想到的打破[规范化](http://en.wikipedia.org/wiki/Database_normalization)的方法（事实上，我什至想不出另一种 1NF 方法，更不用说 3NF 了）。

# javascript - 在 jQuery 中从 ajax.success 调用对象的方法时出现问题

> ID：718295
> 
> 赞同：1
> 
> 时间：2009-04-05T03:35:03.240
> 
> 标签：javascript, jquery

```
function modifyDatabase(tabla, id, objData, callback, arrayCallback){
    $.ajax({
        url: 'modifyDatabase.php',
        type: "POST",
        dataType: "json",
        data: 'tabla='+tabla+'&id='+id+strData,
        success: function(data){            
            callback(data);
        },
    });
}

var obj = {
    set: function (data){
        alert(this.var1);
    },
    var1: 100
}

function modifyDatabase('', '', '', obj.set, ''); 
```

运行此程序时，我收到一条错误消息，告诉我 this.var1 未设置或未定义。如果我从其他地方（不是从异步响应）调用该方法，它工作正常。

似乎方法'set'不在'obj'内。

到底是怎么回事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-05T03:45:54.337

当您以这种方式传递对函数的引用时，它实际上并没有传递对对象的引用。一个快速的解决方法是创建一个匿名函数，通过闭包引用实际对象。以下是它为什么不起作用的一个很好的描述：http: [//bitstructures.com/2007/11/javascript-method-callbacks](http://bitstructures.com/2007/11/javascript-method-callbacks)

简而言之，您需要执行以下操作：

```
function modifyDatabase('', '', '', function(){obj.set();}, ''); 
```

# jquery - jquery tablesorter + ajax div 内容更新问题

> ID：718307
> 
> 赞同：5
> 
> 时间：2009-04-05T03:47:24.647
> 
> 标签：jquery, ajax, tablesorter

我的 tablesorter 和 ajax div 内容更新有问题。重新加载 ajax 后，所有 tablesorter 功能都将丢失。我已经尝试过 livequery，但它似乎并没有超出表格的第一个列表。

```
<script type="text/javascript">
    $(document).ready(function(){
        $(".tabs > ul").tabs();
        $("#sortabletable").tablesorter({
            headers: {
                4: { sorter: false },
                5: { sorter: false }
            },
            widgets:['zebra'],
            sortlist:[[0]]
        });
    });
    $("#sortabletable").livequery(function(){
       $(this).tablesorter({
            headers: {
                4: { sorter: false },
                5: { sorter: false }
            },
            widgets:['zebra'],
            sortlist:[[0]]                          
       });
    });

</script>

// The AJAX function...
function AJAX(){
   try{
       xmlHttp=new XMLHttpRequest(); // Firefox, Opera 8.0+, Safari
       return xmlHttp;
   }
   catch (e){
       try{
           xmlHttp=new ActiveXObject("Msxml2.XMLHTTP"); // Internet Explorer
           return xmlHttp;
       }
       catch (e){
           try{
               xmlHttp=new ActiveXObject("Microsoft.XMLHTTP");
               return xmlHttp;
           }
           catch (e){
               alert("Your browser does not support AJAX.");
               return false;
           }
       }
   }
}

// Timestamp for preventing IE caching the GET request (common function)
function fetch_unix_timestamp(){
   return parseInt(new Date().getTime().toString().substring(0, 10))
}

////////////////////////////////
//
// Refreshing the DIV TIMEDIV
//
////////////////////////////////

function events_listings(){

   // Customise those settings
   var seconds = 5;
   var divid = "tab01";
   var url = "events_listings.php";

   // Create xmlHttp
   var xmlHttp_one = AJAX();
     // No cache
   var timestamp = fetch_unix_timestamp();
   var nocacheurl = url+"?t="+timestamp;

   // The code...

   xmlHttp_one.onreadystatechange=function(){
       if(xmlHttp_one.readyState==4){
           document.getElementById(divid).innerHTML=xmlHttp_one.responseText;
           setTimeout('events_listings()',seconds*1000);
       }
   }
   xmlHttp_one.open("GET",nocacheurl,true);
   xmlHttp_one.send(null);
}

// Start the refreshing process
window.onload = function startrefresh(){
   setTimeout('events_listings()',seconds*1000);
}

////////////////////////////////
//
// Refreshing the DIV TIMEINWASHINGTON
//
////////////////////////////////
var formvar = "";
function view_job(temp){

   // Customise those settings
   var seconds = 8;
   var divid = "tab02";
   var url = "view_job.php";
   formvar = temp;

   // Create xmlHttp
   var xmlHttp_two = AJAX();

   // No cache
   var timestamp = fetch_unix_timestamp();
   var nocacheurl = url+"?t="+timestamp+"&"+formvar;
       // The code...
   xmlHttp_two.onreadystatechange=function(){
       if(xmlHttp_two.readyState==4){
           document.getElementById(divid).innerHTML=xmlHttp_two.responseText;
           setTimeout('view_job(formvar)',seconds*1000);
       }
   }
   xmlHttp_two.open("GET",nocacheurl,true);
   xmlHttp_two.send(null);
}

// Start the refreshing process
window.onload = function startrefresh(){
   setTimeout('view_job(formvar)',seconds*1000);
} 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-07-03T19:38:35.053

Instead of calling .tablesorter() again, you can trigger an update instead, without any of the overhead of calling .tablesorter():

```
("#table").trigger("update"); 
```

I've used this successfully in my own project. You can make the trigger() call in your :success handler.

HTH

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-05T04:30:35.447

加载结果后，您需要`$("#table").tablesorter()`再次对其进行重新排序。此外，与其手动编写 ajax 代码，不如使用`$.get`或`$.post`从 jquery

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-05T05:35:50.440

您最初的问题是 Live Query 只能检测到以 jQuery 调用开头的文档的更改。

直接设置 innerHTML 不会导致它触发。将该行更改为`$("#"+divid).html(xmlHttp_one.responseText)`可以解决您的问题。

I'm glad to hear that you found a solution! Be aware, however, that Live Query has to scan the document every time it is modified — which is convenient but comes with a big performance hit. It would be better to put the call to `tablesorter()` in your `jQuery.ajax(success:)` function.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-09-26T04:55:38.520

I had the same problem and found this method.

```
$("#table tbody tr").addClass("to-delete");
$("#table tbody").append(data);
$("#table").trigger("update");
$("#table").trigger("appendCache");
$("#table").trigger("sorton",[[[2,1],[0,0]]]);
$("#table tbody tr.to-delete").remove();
$("#table").trigger("update"); 
```

It's not very pretty but it works!

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-05T04:36:41.347

通过使用 jQuery .ajax 函数找到了解决方案。更容易，并且完美地工作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-29T16:58:32.910

As mentioned using the jquery AJAX call is the best way to go :P but I found the post to be a bit vague for newbies so here's the code that i used in my project:

```
 $('input.user').click(function() {
    var getContact = $(this).val();
    $.ajax({
        url: 'contact_table.php',
        data: 'userID='+getContacts,
        success: function(result) {
            $('#UserContactTable').append(result);
            $("#contact-list").tablesorter();
        }
    });
}); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-02-11T18:39:34.037

Use the ajaxStop function and the code will run after the ajax call is complete.

```
$("#DivBeingUpdated").ajaxStop(function(){ 
    $("table").tablesorter()
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-11T20:07:00.637

I am quite new in java/ajax programming, but have exactly the same problem - when I update the content of a div (using ajax) with my table, tablesorter does not function. If I load the table directly to the very first page (not into a div), tablesorter works perfectly.

So, I would be greatful if you can explain in more details how exactly you modified your code to solve it.

Thanks, Bojan

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-03-17T10:40:31.993

The answer is irrelevant to the question asked but it might help someone.

In case of loading table contents via AJAX call the function tablesorter() must be called after successful execution of AJAX call. Code that explains the same -->

```
 $(document).ready(function(){
        //once the document is loaded make the AJAX call to required url
        $.ajax({
            url : 'nutrition.xml',  //I have accessed nutrition.xml file
            type : 'GET',
            dataType : 'xml'    //return type is xml
        })
        .done(function(xml){
            //after successful call
            /*here i have created an html string but,
            one call also use appendTo() like : 
            $("<thead></thead>").appendTo("table"); and so on.. */

            var str = "<thead><tr><th>Name</th><th>Calories</th></tr></thead><tbody>";

            //loop through each element of xml filer
            $(xml).find('food').each(function(i){
                var name = $(this).find('name').text();
                var calories = $(this).find('calories').attr('total');
                //append to string
                str = str + "<tr><td>"+name+"</td><td>"+calories+"</td></tr>";
            });
            str = str + "</tbody>";
            //set html for <table>
            $("table").html(str);

            //the main part call tablesorter() once contents are set successfully
            $("table").tablesorter({debug: true}); 
        })
        .fail(function(xhr,status,errorThrown){
            //on ajax call failure
            alert("An error occurred while processing XML file.");
        });         
    }); 
```

The contents of nutrition.xml file :

```
<?xml version="1.0"?>
    <nutrition>
    <food>
        <name>Avocado Dip</name>
        <calories total="110" fat="100"/>
    </food>
    <food>
        <name>Bagels, New York Style </name>
        <calories total="300" fat="35"/>
    </food>
    <food>
        <name>Beef Frankfurter, Quarter Pound </name>
        <calories total="370" fat="290"/>
    </food>
    </nutrition> 
```

# iphone - 如何在 UIKIt 中构建自定义控件？

> ID：718308
> 
> 赞同：3
> 
> 时间：2009-04-05T03:47:59.637
> 
> 标签：iphone, cocoa-touch

我的 UIView 子类处理触摸事件并在触摸开始和跟踪发生时更新内部值。

我的视图控制器在屏幕上加载这个自定义视图。设置视图控制器以侦听自定义控件的值更改的最佳方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-05T03:59:38.377

你可以：

1.  在您的控制器中实现委托方法并从您的视图中调用它们，或者
2.  改为子类`UIControl`并将`UIControlEvent`s 发送到您的控制器

当值更改时（或者更确切地说，当用户与您的控件交互时）。

如果您的视图用于从用户那里获取某种形式的输入，那么子类`UIControl`化是一种更好的方法。

来自 iPhone 参考库：

> `UIControl`是控件的基类：用于将用户意图传达给应用程序的按钮和滑块等对象。

`UIView`因此，和之间最重要的区别`UIControl`是是否传达了用户意图。`UIView`用于显示信息，而`UIControl`用于收集用户输入。

**更新：**

如果您决定使用委托模式，您的代码可能如下所示：

在自定义视图的界面中，像这样定义委托：

```
@interface MyView : UIView {
    id delegate;
}
@property (assign) id delegate;
@end 
```

并`@synthesize`在实施中。

在您的视图控制器中，将控制器设置为委托：

```
MyView myView = [[MyView alloc] init];
[myView setDelegate:self]; 
```

然后，每当用户与视图交互时（例如在 中`touchesBegan`），可能会更改值，在视图中执行以下操作：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    // Possibly change the values
    if([delegate respondsToSelector:@selector(valuesChanged)]) {
        [delegate valuesChanged];
    }
} 
```

您可能还想查看Cocoa Fundamentals Guide 中的[Delegates and Data Sources](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/CocoaFundamentals/CommunicatingWithObjects/CommunicateWithObjects.html#//apple_ref/doc/uid/TP40002974-CH7-SW18)。

# boost - 在应用程序的 WDK 构建环境中使用 boost？

> ID：718309
> 
> 赞同：8
> 
> 时间：2009-04-05T03:48:37.013
> 
> 标签：boost, kernel, driver, iostream, wdk

我正在使用 Windows 驱动程序工具包 (WinDDK 6001.18001) 来构建我的用户空间应用程序，而不是 Visual Studio 2005。我采用这种方法是因为我们还必须构建驱动程序组件，所以我希望有一个单一的构建环境来构建一切. Microsoft 本身将这种方法用于多种产品。

在我开始使用 Boost 1.38.0 之前，这一切正常。我没有在内核模式组件中使用 C++，只是在用户空间应用程序中使用。在 C++ 代码中，使用 boost 库是很自然的。不幸的是，WDK 不同意。

我注意到的第一个错误是“#include <cstddef>”没有`ptrdiff_t`按照附件 D 的要求放入 std 命名空间。解决这个问题在`boost\lambda\detail\operator_return_type_traits.hpp`about中留下了几个错误，`error C2976: 'std::basic_string' : too few template arguments.`它似乎与 iostream 是多余的。

有没有人成功地将 Boost、iostream 和 WDK 组合在一起工作？

我的源文件：

```
TARGETNAME=foobar
TARGETTYPE=PROGRAM

USE_MSVCRT = 1
USE_STL = 1
USE_ATL = 1
ATL_VER = 30
STL_VER = 70
USE_NATIVE_EH = 1 
USE_IOSTREAM = 1

SUBSYSTEM_VERSION = 5.02

C_DEFINES = \
    -D_MT \
    -DWIN_32 \
    -DWIN32  \
    -D_WINDOWS \
    -DNT \
    -D_WIN32_DCOM \
    -DUNICODE \
    -D_UNICODE \
    -D_ATL_NO_DEBUG_CRT # because we are using USE_MSVCRT=1 

SOURCES=service.cpp

INCLUDES=\
    $(BOOST_INC_PATH)

TARGETLIBS=\
    $(SDK_LIB_PATH)\ole32.lib \
    $(SDK_LIB_PATH)\oleaut32.lib \
    $(SDK_LIB_PATH)\uuid.lib \

UMTYPE=console
UMBASE=0x400000 
```

服务.cpp：

```
#include <iostream>
#include <cstddef>

namespace std {
        typedef ::ptrdiff_t ptrdiff_t; // DDK C++ workaround
}

#include <boost/lambda/lambda.hpp>

int __cdecl main() {
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T07:22:10.463

Interesting question. Using STL as-is was a challenge in itself with the WDK. I have not ventured beyond. I can give this a try. Remember, the WDK has it's own compiler which is not the same as your VS2005/VS2008 complier (check the version numbers). It is highly likely there are a few bugs here and there.

Note, that `USE_MSVCRT=1` and `USE_STL=1` didn't gel well (at least for WDK 6001).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-07T11:58:30.067

Boost 可能已经包含解决您的问题的方法，但没有应用它，因为它无法识别您正在使用的编译器（可能是因为驱动程序很少使用 boost）。

尝试检查（并可能进行编辑）`boost/config/select_compiler_config.hpp`并`boost/config/compiler/visualc.hpp`确保启用了 MSVC 的编译器解决方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T17:40:04.973

我建议采用不同的方式，即使用[这个](http://www.hollistech.com/Resources/ddkbuild/ddkbuild.htm)(ddkbuild) 好工具从 VS200.x 编译驱动程序。

作为一个命令行人员并且在任何地方都使用 makefile，我发现构建实用程序对复杂的项目没有用。MS 构建实用程序有很多限制，我建议使用 VS 环境来编译你的项目。

我不确定 ddkbuild 中是否有 howto，但是直接将 ddkbuild.bat 集成到 VS 自定义构建选项中。

# ruby-on-rails - 使用 ImageMagick 对图片进行圆角处理

> ID：718314
> 
> 赞同：15
> 
> 时间：2009-04-05T03:56:22.877
> 
> 标签：ruby-on-rails, facebook, image-manipulation, imagemagick

在我的 Rails 应用程序中，我希望有一个类似 Facebook 的个人资料部分，其中上传的图像会自动缩略图和圆角。我正在使用该`convert`实用程序将图像缩小为缩略图，但是否也可以选择圆角？谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-09-24T21:17:36.117

**通用解决方案**

此解决方案适用于透明和非透明图片。添加 15 像素半径的圆角`original_picture.png`是 100x100 图片：

```
convert -size 100x100 xc:none -draw "roundrectangle 0,0,100,100,15,15" mask.png
convert original_picture.png -matte mask.png \
  -compose DstIn -composite picture_with_rounded_corners.png 
```

这个解决方案是由[PM](https://stackoverflow.com/users/233099/pm)在这里给出的：[https ://stackoverflow.com/a/1916256/499917](https://stackoverflow.com/a/1916256/499917)

**优雅的解决方案，不适用于透明图片**

此解决方案无需任何中间图片即可工作。多好！但这会破坏您原始图片的透明度。所以只有当你确定你的图片不透明时才使用。

假设您想要半径为 15px 的圆角：

```
convert original_picture.png \
  \( +clone  -alpha extract \
    -draw 'fill black polygon 0,0 0,15 15,0 fill white circle 15,15 15,0' \
    \( +clone -flip \) -compose Multiply -composite \
    \( +clone -flop \) -compose Multiply -composite \
  \) -alpha off -compose CopyOpacity -composite picture_with_rounded_corners.png 
```

为方便起见，以下是您通常会在 Ruby 或其他一些语言中执行的操作：

```
in_pic = "original_picture.png"
out_pic = "picture_with_rounded_corners.png"
radius = 15
cmd = "convert #{in_pic} \\( +clone  -alpha extract " +
        "-draw 'fill black polygon 0,0 0,#{radius} #{radius},0 fill white circle #{radius},#{radius} #{radius},0' " +
        "\\( +clone -flip \\) -compose Multiply -composite " +
        "\\( +clone -flop \\) -compose Multiply -composite " +
        "\\) -alpha off -compose CopyOpacity -composite #{out_pic}"
`#{cmd}` 
```

来源：[http ://www.imagemagick.org/Usage/thumbnails/#rounded](http://www.imagemagick.org/Usage/thumbnails/#rounded)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-05T04:32:46.970

Facebook 不会将图片修改为圆角。相反，他们使用 HTML 和 CSS 将此图像应用于每个用户图片： http: [//www.facebook.com/images/ui/UIRoundedImage.png](http://www.facebook.com/images/ui/UIRoundedImage.png)

如果你检查`UIRoundedImage.png`，你会发现每个“正方形”都由一个透明的中心和不透明的角组成，这些角与用户图片所在的背景相匹配。例如，如果用户图片位于白色背景上，则白色不透明圆角将覆盖在用户图片上。

仅使用特定部分的 CSS 技术`UIRoundedImage.png`称为“CSS sprites”。你可以在这里阅读更多关于它的信息：[http ://www.alistapart.com/articles/sprites/](http://www.alistapart.com/articles/sprites/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-05T04:04:54.463

以下是一些圆角示例：[http](http://www.imagemagick.org/Usage/thumbnails/#rounded_border) ://www.imagemagick.org/Usage/thumbnails/#rounded_border 。您需要创建某种蒙版（手动或使用绘图工具），然后将其覆盖到您的图像上。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-07T23:24:03.150

这是我使用 Perl 使用 ImageMagick 编写的圆角代码。它应该很容易移植到 Ruby：

[http://article.gmane.org/gmane.comp.video.graphicsmagick.apis/322](http://article.gmane.org/gmane.comp.video.graphicsmagick.apis/322)

# java - 17 年后修复 C++ 运行时可扩展性是否为时已晚？

> ID：718316
> 
> 赞同：9
> 
> 时间：2009-04-05T04:03:17.480
> 
> 标签：java, c++, objective-c, plugins, extensibility

1992 年到 1993 年的时间框架对于 C++ 来说是至关重要的。

在 '92/'93 时间框架内，我为 Aldus PageMaker 开发了一个插件架构，它是用 C++ 编码的。PageMaker 建立在一个名为 VAMP 的 C++ OOP 框架之上，这有助于其在 Mac OS 和 Windows 之间的可移植性。

所以我们尝试利用C++的特性来构建插件架构。由于所谓的脆基类问题，这被证明对于 C++ 类来说是非常有问题的。

我继续写了一篇发表在期刊上的论文，并在 OOPSLA '93 的反思研讨会上发表。你可以阅读我在这里展示的论文的 pdf 格式：

[C++ 可演化类的时不变虚拟成员函数调度](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.51.418) （页面到底部并单击*查看或下载*）

我还在波特兰举行的 Usenix 会议上与 Bjarne Stroustrup 取得了联系，并继续与他进行了几个月的对话，在那里他代表我提出了处理易碎基类问题的问题。（唉，当时认为其他问题更重要——例如，试图通过批准来阻止 RTTI。）

微软此时推出了适用于 Windows 平台的 COM/DCOM 系统，被视为解决该问题的可行方案。通过用于定义 COM 接口的抽象类，C++ 可以用作 COM 的实现语言。

然而，这些天来，开发人员避开了 COM/DCOM——尤其是基于 COM 的 ActiveX。（1994 年，我继续在 Microsoft 工作，并在这十年的剩余时间里使用 C++ 和 COM/DCOM。我得出的结论是，技术组合绝对是一条死胡同。我在这里参考了那段经历：[Building Effective Enterprise分布式软件系统](http://humbleblogger.blogspot.com/2006/08/building-effective-enterprise.html)）

与所有早期的 C++ 历史相比，Steve Job 的公司 NeXT 在 90 年代初期使用 Objective C 设计了一个插件架构，这是 NeXT Step 框架不可或缺的一部分。今天，它在苹果电脑和 iPhone 等重要平台上的 Mac OS X 中充满活力。

我提交了启用 Objective C 以更好地解决插件问题的方法。

Java 的拥护者将引用诸如垃圾收集之类的因素来解释为什么它比 C++ 更高效。我不会对此提出异议，但 Objective C 直到最近才使用 2.0 进行垃圾收集。在 iPhone 上垃圾收集仍然不可用。尽管如此，OS X 插件架构是完全可行的——这完全归功于 Objective C 风格的 OOP 与 C++ OOP 的优点。

有趣的是，Java 已被用于构建适用于任何平台或软件开发社区的最普遍的插件架构。Eclipse IDE 插件架构，现在几乎是传奇，就像这样的架构，几年前合并了 Equinox OSGi 模块管理层。十年来， J2EE 应用服务器一直支持 EJB 的*插件架构*。这些天来，所有值得注意的 J2EE 应用程序服务器都同样整合了 OSGi 来管理运行时可绑定模块。Spring 框架及其 Spring Bean 的运行时可绑定单元已经发展到超过了 J2EE——主要是在其用于管理 Spring Bean 的绑定的系统的强度上。

Java 社区仍在努力定义正式的模块管理标准，但即便如此，Java 平台支持的软件架构比任何其他编程平台都更普遍地包含插件功能。

尽管 Java 作为一门语言相对于 C# 存在弱点，并且 .NET 在其 .NET 汇编标准中已经具有更强大的模块实现，但 Java 在广泛使用的包含某种形式的插件的日常软件系统方面仍然领先数年建筑学。奇怪的是，Java 社区甚至没有意识到这是他们作为企业开发平台持续成功的基础。

我个人认为 C++ 脆弱的基类问题是它最致命的缺陷。

自从这个问题向 C++ 社区和 C++ 的创建者强调以来已经过去了 17 年，现在解决这个问题是否为时已晚？

# linux - Anyone tried to compile Intel xf86_video_intel for another OS

> ID：718324
> 
> 赞同：2
> 
> 时间：2009-04-05T04:12:16.957
> 
> 标签：linux, video, intel

Has anyone tried to compile Intel xf86_video_intel for another OS. This code is written for Linux. I am wondering if there is any experience with porting the code to another operating system? The code is located at:

[http://intellinuxgraphics.org/documentation.html](http://intellinuxgraphics.org/documentation.html)

Thanks, FM

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T13:27:19.297

最新的 Intel Linux 图形驱动程序非常依赖于 linux 内核的特性（内核模式设置是最近谈论最多的一种）。如果可能的话，移植驱动程序可能不是一项简单的任务。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-06T00:07:58.083

通常 Linux 图形代码是为 X 服务器编写的。X 可用于许多不同的平台/操作系统。有关详细信息，请参阅 ( [http://www.x.org/wiki/](http://www.x.org/wiki/) )。

# database-design - 数据库结构题

> ID：718329
> 
> 赞同：1
> 
> 时间：2009-04-05T04:19:14.320
> 
> 标签：database-design

我目前正在开发一个引用 Microsoft Business Contact Manager SQL Server 数据库插件的 Outlook 应用程序。db中的主Contact表有几个子表，它们与主表具有相同的键和少量的列；例如，一个包含 3 列的电子邮件地址表：contactID、EmailAddress 和 EmailDisplayAs。由于这种方法，您需要使用具有多个外部连接的视图来查看构成每个联系人记录的所有列。我从未见过具有这种结构的数据库；至少可以说似乎很乱。我很想看到关于为什么要采用这种方法的评论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-05T04:53:09.043

对于可选数据，基本上有两种通用方法：

1.  将它们包含在表格的可为空（即可选）列中；或者
2.  对包含属性逻辑分组的子表使用一对一关系。

我个人认为，除非您处理大量可选属性，否则您应该支持可为空的列。开销是如此之低以至于可以忽略不计 - 与进行大量连接相比尤其如此。另外，如果您通过一对一关系拥有子表，则您将再次存储主键（作为子表中的外键），因此可空列的任何存储开销实际上都更少。

但无论如何，仅此而已。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T04:30:48.207

一些原因可能是：

*   大多数查询仅针对初始数据集运行，通常可以加快查询速度
*   在初始开发之后添加了额外的表，并且 ALTER TABLE 命令可能非常昂贵
*   最初的意图是建立一种或另一种特定类型的联系，但来自父类型
*   给定父级需要多个子行（尽管这将是索引键而不是唯一/主键的情况，因此它可能不会飞）

我见过这样的结构实际上会加快速度的系统，因为较小的查询和较小的关联表保存在逻辑层的内存缓存中）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-05T04:39:25.910

这对我来说听起来像是基本的标准化。联系人是一个父实体，并且具有构成一对多关系的许多属性。新手设计师有时将这些存储在同一个表中，您会得到诸如 phone1、phone2、phone3、email1、email2 等列。

规范化允许有效地存储信息，并提供一种结构，您可以借此返回多属性记录（问题中的视图）。

所以我希望看到一个联系人表（主键为contactId）、电话表（外键为contactId）和电子邮件表（外键为contactId）。

如果您不熟悉规范化、主键和外键，我建议您阅读类似[Database Design for Mere Mortals 之](https://rads.stackoverflow.com/amzn/click/com/0201752840)类的书。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-05T05:02:16.277

正如其他人所指出的，这可能是良好的规范化，或者是对更快查询的优化（更小的表宽度意味着更多的行一次可以放入内存中意味着更快的查询）。

您仍然需要*插入/更新*到多个表，但如果您想要一种更简单的方法来*选择*数据，请编写一个使用主表中的左外连接来连接所有数据的视图。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-05T13:23:30.330

具有共享公共键的多个表的设计有时允许在不使用 NULL 标记的情况下省略数据。例如，如果 Outlook 表中的联系人没有已知的电子邮件地址，则可以简单地从您提到的表中省略一行。

虽然设计对您来说可能看起来很混乱，但将 NULL 标记保留在基表之外可以避免在 NULLS 存在时 SQL 使用的三值逻辑引起的许多混乱。这有时被称为 6NF。

如果您需要将它们全部视为通过外部连接连接的一个表，您可以创建一个视图。我有点惊讶没有内置这样的视图。

# sql-server-ce - 在 SQL Server CE 中表示时间跨度的最佳方式是什么？

> ID：718332
> 
> 赞同：27
> 
> 时间：2009-04-05T04:21:17.200
> 
> 标签：sql-server-ce, timespan

具体来说，我只需要 hours:minutes 但说我有一个 .NET TimeSpan 对象，我应该如何将它存储在 SQL(CE) 数据库中？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-04-13T18:39:23.723

我建议使用 long 来表示[刻度](http://msdn.microsoft.com/en-us/library/system.timespan.ticks.aspx)数。这就是[TimeSpan](http://msdn.microsoft.com/en-us/library/system.timespan.aspx)使用的内部表示。[这使您可以使用Timespan.FromTicks()](http://msdn.microsoft.com/en-us/library/system.timespan.fromticks.aspx)方法轻松地重构您的对象，并使用[Timespan.Ticks 属性](http://msdn.microsoft.com/en-us/library/system.timespan.ticks.aspx)输出到数据库。.NET 中的最小时间单位是滴答声，等于 100 纳秒

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-08-31T14:48:27.277

存储为 varchar。保存到 sql 使用`TimeSpan.ToString()`. 从 sql 读取为：

```
TimeSpanObj = TimeSpan.Parse(fieldValue) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-05T04:52:50.947

SQL CE 没有时间类型或用户定义类型，因此您可以选择 datetime 或表示分钟的 int。如果您需要存储的最大时间是 23:59 = 23 * 60 + 59 = 1439 = 从第 0 分钟开始的一天中的分钟数，则 smallint 是可容纳该范围的最小整数类型。

抵制将小时和分钟作为 tinyint 存储在单独列中的诱惑。这将使用与单个 smallint 相同的空间，但是每次计算时间都需要将小时乘以 60 并加上分钟，并且每次`order by`都需要两列而不是一列。

存储为分钟；在显示屏上，您可以将分钟分为小时和分钟

```
select floor( absminutes / 60 ) as hours, absminutes % 60 as minutes,
from some table
order by absminutes; 
```

如果您想将一天中的 1439 分钟与一小时中的 0-59 分钟区分开来，我会命名列`minutes`，或者（绝对分钟）​​。`absminutes`

要将数据库值转换为 Timespan 对象，请使用这样的 ctor`Timespan(int, int, int)`或`new TimeSpan( floor(absminutes / 60 ), absminutes % 60, 0)`（更好）`Timespan(long)`带有`new Timespan( absminutes * TimeSpan.TicksPerMinute )`.

要从 Timespan 对象插入或更新数据库，请将 absminutes 设置为`someTimespan.TotalMinutes % 1440`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-22T16:02:21.017

我目前正在考虑使用 SQL Time 来处理这个问题，但它不会工作 >= 24 小时。

好处包括易于阅读，易于在 SQL 和代码中使用，但缺点是您只有很短的时间跨度可以玩。

```
declare @delay table (DelayTime Time(3))
insert into @delay values ('00:10:00.000')
select getdate() as nowtime, getdate()+DelayTime as nowPlusTen from @delay 
```

和

```
SqlDataReader dr = cmd.ExecuteReader();
DelayTime = (TimeSpan) dr["DelayTime"]; 
```

# design-patterns - 图像编辑工具的高级设计模式

> ID：718342
> 
> 赞同：7
> 
> 时间：2009-04-05T04:29:01.520
> 
> 标签：design-patterns, oop, interface-design

我最近开始创建一个图像编辑工具来满足一个非常特殊的需求。对于将要使用它的人来说，这和我自己的娱乐一样多。但是，我很早就遇到了一些架构障碍。

像任何图像编辑器一样，用户将使用“工具”来绘制和操作图像。我的第一次尝试包括一个简单的界面：

```
public interface IDrawingTool
{
    void DrawEffect( Graphics g );
    // other stuff
} 
```

这（我认为）会很好而且很干净，并且可以轻松维护和扩展。只需添加接口对象并在运行时调用所选对象的 DrawEffect 方法。

这种方法的问题是不同的绘图工具不能干净地遵循一个界面。例如，钢笔工具只需要知道要绘制的点就可以工作。然而，矩形需要单击的第一个点以及当前位置。多边形工具需要跟踪多次鼠标点击。

我很难想出一个很好的方法来实现这一点。我现在能想到的最好的方法是为每个工具添加一个 switch 语句和一个 case，这意味着绘图逻辑将在 Canvas 类中，而不是由 Tool 类型的对象封装。因为这是实践，我想以正确的方式做到这一点。感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T04:41:38.527

好的，经验法则：如果您`switch`在代码草图中看到一条语句，则表明您需要改用多态性。因此，在这种情况下，您希望能够进行各种操作，并且您发现自己想要 a `switch`，因此您应该考虑“我怎样才能使用多态性来制作这个东西？”

现在，看看命令模式，你的对象是*动词*而不是*名词*。每个 Command 实现一个`doThis()`方法；当您构造对象时，您确定命令将做什么。

```
public interface Command {
   public void doThis(Graphics g);  // I don't promise returning 
                                    // void is the best choice
   // Would it be better to return a Graphics object?
}

public class DrawRectangle implements Command {
   public DrawRectagle( Point topLeft, Point btmRight) { // ...
   }
   public void doThis(Graphics g){ // ...
   }
} 
```

现在，考虑一下如果你想实现*undo*会怎么做？

### 更新

好的，让我们再扩展一下。使用这种模式的目的是确保客户*不需要*知道那么多，除非您在进行原始构造。所以对于这个例子，让我们考虑绘制一个矩形。当您选择矩形工具时，您将在按钮单击事件处理程序上有一些代码（顺便说一句，这都是伪代码）

```
 cmdlist = [] // empty list
 bool firstClick = true
 Point tl = br = new Point(0,0)
 onClick:
   if firstClick:
     get mouse position into tl
     firstClick = false
   else:
     get mouse position into br
     cmdlist.append(new DrawRectangle(tl, br))
     firstClick = true 
```

因此，现在当您选择矩形时，您将 DrawRectangle 对象添加到命令列表结构中。一段时间后，您浏览了列表

```
for cmd in cmdlist:
   cmd.doThis(Graphics g) 
```

这些事情就完成了。现在应该很明显，您将通过向 Command 添加“undoThis”方法来实现撤消。创建命令时，您必须构建代码，以便对象知道如何撤消自身。然后 undo 意味着只从列表中取出最后一个 Command 对象并执行它的 undoThis 方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T22:47:59.000

你如何设计你的界面有点复杂？让我们从一些代码开始，然后我将解释它应该如何工作。

```
public class AbstractDrawingTool {

    private Graphics g;

    void AbstractDrawingTool( Graphics g ) {
        this.g = g;
    }

    void keyDown(KeyEvent e);
    void keyUp(KeyEvent e);
    void mouseMove(MouseEvent e);
    void mouseClick(MouseEvent e);
    void drop();
    // other stuff
} 
```

这个想法是一旦用户开始使用特定的实现，就将用户输入传递给工具。这样，您可以使用相同的界面创建许多不同的绘图工具。例如，一个简单的 PointDrawingTool 只会实现 mouseClick 事件以在画布上放置一个点。PolygonDrawingTool 还将实现 keyUp 事件，以便在按下特定键（即退出键）时停止绘制线条。

一个特例是 drop 方法。它将被称为“删除”当前选定的工具。如果从工具栏或类似工具中选择另一个实现，就会发生这种情况。

您还可以将此定义与命令模式结合使用。在这种情况下，AbstractDrawingTool 的实现将负责创建 Command 接口的实例，并可能在操作完成后将它们放在堆栈上（即在画布上放置一个点）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T19:29:36.130

在尝试重新设计我的[映射软件](http://igorbrejc.net/kosmoshome)以支持 GDI+ 和 Cairo 图形库时，我遇到了类似的问题。我通过将绘图界面减少到一些常见的操作/基元来解决它，请参见下面的代码。

在此之后，您要绘制的“效果”是命令（如查理所说）。他们使用`IPainter`界面进行绘制。这种方法的好处是效果与 GDI+ 等具体的绘图引擎完全分离。这对我来说很方便，因为我可以通过切换到 Cairo 引擎将我的绘图导出到 SVG。

当然，如果您需要一些额外的图形操作，您将不得不扩展`IPainter`接口，但基本原理保持不变。在此处查看更多信息：http: [//igorbrejc.net/development/c/welcome-to-cairo](http://igorbrejc.net/development/c/welcome-to-cairo)

```
public interface IPainter : IDisposable
{
    void BeginPainting ();
    void Clear ();
    void DrawLines (int[] coords);
    void DrawPoint (int x, int y);
    void EndPainting ();
    void PaintCurve (PaintOperation operation, int[] coords);
    void PaintPolygon (PaintOperation operation, int[] coords);
    void PaintRectangle (PaintOperation operation, int x, int y, int width, int height);
    void SetHighQualityLevel (bool highQuality);
    void SetStyle (PaintingStyle style);
}

public class PaintingStyle
{
    public PaintingStyle()
    {
    }

    public PaintingStyle(int penColor)
    {
        this.penColor = penColor;
    }

    public int PenColor
    {
        get { return penColor; }
        set { penColor = value; }
    }

    public float PenWidth
    {
        get { return penWidth; }
        set { penWidth = value; }
    }

    private int penColor;
    private float penWidth;
}

public enum PaintOperation
{
    Outline,
    Fill,
    FillAndOutline,
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-09-05T16:52:15.777

您的确切问题在 Kent Beck 和 Ralph Johnson 的以下论文“Patterns Generate Architectures”中使用编辑器模式进行了描述和解决：

[https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.46.8603&rep=rep1&type=pdf](https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.46.8603&rep=rep1&type=pdf)

# c# - EDI equivalent in the .net world

> ID：718355
> 
> 赞同：4
> 
> 时间：2009-04-05T04:49:21.953
> 
> 标签：c#, .net, biztalk, edi

I work for a small company. Currently we are re-writing our legacy application in C#. There is one part of the application that uses EDI, and I don't know where to look for solutions in the .net world. I have heard about BizTalk but not sure as to if that is the solution. Also there is no BizTalk Express edition like SQL Server Express Edition. In one of the dotnet podcasts I heard a compelling case for Microsoft to put out a Developer Edition for BizTalk.

Can someone shed some more light on this issue?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-02-20T10:37:18.350

As Tim says, EDI is just a "standard" way of interpreting flat files. The various messaging formats are:

1.  **X12**
2.  **EDIFACT (ORDERS, INVOIC, DESADV...)**
3.  **TRADACOM (ORDHDR, ACKHDR, **INVFIL...)**

So you will need to read in the data and "map" the required fields. The best way to do this is with FileHelper:

[http://filehelpers.sourceforge.net/](http://filehelpers.sourceforge.net/)

you would need map the data to your specific BackOffice business rules. What we do here for **Inbound**

1.  Receive the file in its raw EDI state
2.  Unwrap it, as all EDI data should be wrapped (Due to VAN cost on MB-per-second)
3.  Double check we have all the required mandatory fields (PRE-PROCESSOR)
4.  Convert the raw EDI file to our Back Office proprierty file system ready to be processed.

Obiviously packages like BizTalk and SAP EDocs will do the PRE-PROCESSOR/Conversion routines for you, but if you want to develop this yourself, i would use FileHelpers mentioned above.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T05:22:44.933

EDI is simply a "standard" way to format text files with various business information like orders, invoices, bills of lading etc.

It is unlikely that there would be any specific .NET component for them, because although there is a "standard" defined for EDI it is interpreted slightly differently by every company that uses it.

The standard comprises "business rules", like "you should respond with an 810 document file when you recieve an 850 document file ... as well as the basic file formats of those documents.

[The Wikipedia article explains it pretty thoroughly ...](http://en.wikipedia.org/wiki/Electronic_Data_Interchange)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-27T16:21:26.597

[RDPCrystal EDI 库](http://rdpcrystal.com/products.html)

[Sparrow 技术 EDI 解析器](http://www.sparrow-technologies.com/ediparser.net.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-26T22:53:38.787

是的，[RDPCrystal EDI 库](http://rdpcrystal.com/products.html)可能就是您正在寻找的。

# c# - 如何使用 ADO.Net 最好地插入 350,000 行

> ID：718357
> 
> 赞同：6
> 
> 时间：2009-04-05T04:50:29.957
> 
> 标签：c#, .net, ado.net, csv, etl

我有一个包含 350,000 行的 csv 文件，每行大约有 150 列。

使用 ADO.Net 将这些行插入 SQL Server 的最佳方法是什么？

我通常这样做的方式是手动创建 SQL 语句。我想知道是否有任何方法可以将其编码为简单地将整个数据表插入 SQL Server？或者像这样的一些捷径。

顺便说一句，我已经尝试过用 SSIS 来做这件事，但是有一些数据清理问题我可以用 C# 处理，但用 SSIS 就不那么容易了。数据以 XML 开始，但为了简单起见，我将其更改为 CSV。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-05T05:20:01.303

创建一个实现 IDataReader 的类“CsvDataReader”。只需实现 Read()、GetValue(int i)、Dispose() 和构造函数：如果需要，您可以让其余部分抛出 NotImplementedException，因为 SqlBulkCopy 不会调用它们。使用 read 处理每行的读取，使用 GetValue 读取行中的第 i 个值。

然后使用所需的适当列映射将其传递给 SqlBulkCopy。

使用该方法，我获得了大约 30000 条记录/每秒的插入速度。

如果您可以控制源文件格式，请将其设为制表符分隔，因为它比 CSV 更容易解析。

编辑： http: [//www.codeproject.com/KB/database/CsvReader.aspx](http://www.codeproject.com/KB/database/CsvReader.aspx) - tx Mark Gravell。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-05T04:52:25.457

SqlBulkCopy（如果可用）。[这是使用C# 在 ADO.NET 2.0](http://dotnetslackers.com/articles/ado_net/SqlBulkCopy_in_ADO_NET_2_0.aspx)中使用 SqlBulkCopy 的非常有用的解释

我认为您可以将 XML 直接加载到 DataSet 中，然后将 SqlBulkCopy 映射到数据库和 DataSet。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-05T05:27:28.260

嘿，您应该恢复为 XML 而不是 csv，然后使用 openxml 将该 xml 文件加载到临时表中，清理临时表中的数据，然后最后处理这些数据。

我一直在使用这种方法来导入大量数据，其中我的 XML 文件大小恰好 > 500 mb，而 openxml 就像一个魅力。

与手动 ado.net 语句相比，它的运行速度会快得多，您会感到惊讶。

# http - Http protocol content-length

> ID：718361
> 
> 赞同：4
> 
> 时间：2009-04-05T04:53:12.943
> 
> 标签：http, http-headers

I am working on a simple download application. While making a request for the following file both firefox and my application doesn't get the content-length field. But if i make the request using wget server does send the content-length field. I did change wgets user agent string to test and it still got the content-length field.

Any ideas why this is happening?

wget request

```
---request begin---
GET /dc-13/video/2005_Defcon_V2-P_Zimmerman-Unveiling_My_Next_Big_Project.mp4 HTTP/1.0
User-Agent: test
Accept: */*
Host: media.defcon.org
Connection: Keep-Alive

---request end---
HTTP request sent, awaiting response... 
---response begin---
HTTP/1.0 200 OK
Server: lighttpd
Date: Sun, 05 Apr 2009 04:40:08 GMT
Last-Modified: Tue, 23 May 2006 22:18:19 GMT
Content-Type: video/mp4
Content-Length: 104223909
Connection: keep-alive 
```

firefox request

```
GET /dc-13/video/2005_Defcon_V2-P_Zimmerman-Unveiling_My_Next_Big_Project.mp4 HTTP/1.1
Host: media.defcon.org
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.4; en-US; rv:1.9.0.8) Gecko/2009032608 Firefox/3.0.8
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-us,en;q=0.5
Accept-Encoding: gzip,deflate
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Keep-Alive: 300
Connection: keep-alive
Referer: http://www.defcon.org/html/links/defcon-media-archives.html
Pragma: no-cache
Cache-Control: no-cache

HTTP/1.x 200 OK
Server: lighttpd
Date: Sun, 05 Apr 2009 05:20:12 GMT
Last-Modified: Tue, 23 May 2006 22:18:19 GMT
Content-Type: video/mp4
Transfer-Encoding: chunked 
```

**Update:**

Is there a header that I can send that will tell Lighthttpd not to use chunked encoding.My original problem is that I am using `urlConnection` to grab the file in my java application which automatically sends HTTP 1.1 request.

I would like to know the size of the file so i can update my percentage.

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-05T05:01:39.257

> GET /dc-13/video/2005_Defcon_V2-P_Zimmerman-Unveiling_My_Next_Big_Project.mp4 **HTTP/1.1**

Firefox is performing an HTTP 1.1 GET request. Lighthttpd understands that the client will support chunked-transfer encoding and returns the content in chunks, with each chunk reporting its own length.

> GET /dc-13/video/2005_Defcon_V2-P_Zimmerman-Unveiling_My_Next_Big_Project.mp4 **HTTP/1.0**

Wget on the other hand performs an HTTP 1.0 GET request. Lighthttpd, understanding that the client doesn't support HTTP 1.1 (and thus chunked-transfer encoding), returns the content in one single chunk, with the length reported in the response header.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-05T05:00:33.503

Looks like it's because of the [`chunked` transfer encoding](http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.6.1):

```
Transfer-Encoding: chunked 
```

This will send the video down in chunks, each with its own size. This is defined in HTTP 1.1, which is what Firefox is using, while `wget` is using HTTP 1.0, which doesn't support chunked transfer encoding, so the server has to send the whole file at once.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-16T20:46:26.447

无论使用哪个 HTTP 版本，我都遇到了同样的问题并找到了解决方案：

1.  首先使用`HEAD`对服务器的请求，该请求仅使用 HTTP 标头而没有内容正确响应。此标头正确包含`Content-Length:`要下载的文件所需的字节大小。
2.  继续`GET`请求下载文件（GET 响应的标头未能包含 Content-length）。

一个 Objective-C 语言示例：

```
NSString *zipURL = @"http://1.bp.blogspot.com/_6-cw84gcURw/TRNb3PDWneI/AAAAAAAAAYM/YFCZP1foTiM/s1600/paragliding1.jpg";

NSURL *url = [NSURL URLWithString:zipURL];

// Configure the HTTP request for HEAD header fetch
NSMutableURLRequest *urlRequest = [NSMutableURLRequest requestWithURL:url];
urlRequest.HTTPMethod = @"HEAD";  // Default is "GET"

// Define response class
__autoreleasing NSHTTPURLResponse *response;

// Send HEAD request to server
NSData *contentsData = [NSURLConnection sendSynchronousRequest:urlRequest returningResponse:&response error:nil];

// Header response field
NSDictionary *headerDeserialized = response.allHeaderFields;

// The contents length
int contents_length = [(NSString*)headerDeserialized[@"Content-Length"] intValue];

//printf("HEAD Response header: %s\n",headerDeserialized.description.UTF8String);
printf("HEAD:\ncontentsData.length: %d\n",contentsData.length);
printf("contents_length = %d\n\n",contents_length);

urlRequest.HTTPMethod = @"GET";

// Send "GET" to download file
contentsData = [NSURLConnection sendSynchronousRequest:urlRequest returningResponse:&response error:nil];

// Header response field
headerDeserialized = response.allHeaderFields;

// The contents length
contents_length = [(NSString*)headerDeserialized[@"Content-Length"] intValue];

printf("GET Response header: %s\n",headerDeserialized.description.UTF8String);
printf("GET:\ncontentsData.length: %d\n",contentsData.length);
printf("contents_length = %d\n",contents_length);

return; 
```

和输出：

```
HEAD:
contentsData.length: 0
contents_length = 146216

GET:
contentsData.length: 146216
contents_length = 146216 
```

（注意：此示例 URL 确实正确地提供了 GET 响应中的标头 Content-Length，但如果未能提供，则会显示这个想法）

# internet-explorer-7 - Why does IE7 fetch every favicon at startup?

> ID：718363
> 
> 赞同：0
> 
> 时间：2009-04-05T04:53:55.047
> 
> 标签：internet-explorer-7

I am trying to understand what IE7 is up to and why it takes forever to start up.

I've been using Fiddler 2 to monitor traffic and the content of headers. I'll start Fiddler 2, then fire up IE7\. And each time i do this I see that this browser always appears to chase down a favicon for every single site in my bookmarks. Worse it tries for both ICO and GIF format for each.

I can't understand this. Am I mis-configured or is this a well-known 'feature' ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T07:52:51.653

It is a "feature", because it shows the favicons as the icon for the entry in your favourites menu.

# .net - 使用 .NET(C#) 为 Adob e（Reader 和 PhotoShop）编写插件

> ID：718364
> 
> 赞同：3
> 
> 时间：2009-04-05T04:54:18.107
> 
> 标签：.net, plugins, adobe

我想用 .NET (C#)（特别是 Acrobat Reader 和 PhotoShop）为 Adob​​e 产品编写插件。要求是在“文件”菜单中添加一个新命令。因此，例如在 Acrobat Reader 中，我需要添加一个新的“文件 >> 打开我的文件”命令，该命令显示我的对话框以打开某些文件。

我听说过 Adob​​e Development Kit。Visual Studio 中是否有可以创建插件的项目类型或某些向导？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-04-01T19:49:50.580

一种更简单的方法是通过 COM 选项卡将 Photoshop COM .dll 添加到您的应用程序中。我是一个新手，我已经成功地做到了这一点。2 个简单的运行方法是 PhotoshopWebImageGallery 和 PdfPresentation 方法（为生成的 pdf 演示文稿获取输入文件夹和输出文件夹。还有一个“doJavaScript”方法可以使用 JavaScript 获取字符串。如果您使用 google Photoshop Javascript Scripting， Adobe 的手册应该是第一个条目。我还没有尝试过“doJavaScript”方法，但我已经看到了 ImageGallery，并且 PdfPresentation 方法有效！

这里有一些关于该主题的很好的链接，因为它与 JavaScript 相关。

1.  [在 Adob​​e](http://www.adobe.com/devnet/photoshop/scripting.html)
2.  [在破布](http://www.rags-int-inc.com)

运行这个网站的家伙刚刚给我发了一封电子邮件，告诉我今天遇到的一些 Photoshop 脚本问题！及时回复真是太好了！

从理论上讲，应该能够添加 Photoshop COM .dll、“doJavaScript”方法、提供的示例和“让某些事情发生”。看起来这有点老了，你现在可能已经把它拍下来了！如果是的话分享一些图像锐化方法！！！祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-05T07:31:00.943

Reader 没有特殊的 SDK。Acrobat Pro/Standard 和 Reader 只有一个。某些功能可能可用也可能不可用——取决于您的目标应用程序。

用于 Reader/Photoshop 的插件 SDK 附带示例。还有 Visual Studio 向导（至少对于 Acrobat 8​​ SDK——他们确实如此）。我假设你也会得到一个用于 Photoshop 的。请查看与 SDK 捆绑在一起的文档/示例。

SDK 本质上是 C/C++ API。因此，您需要使用 P/Invoke 或其他类似的 hack 从您的 .NET 应用程序中调用此本机代码。

# c# - C#：基类可以在静态函数中使用派生类的变量吗？

> ID：718372
> 
> 赞同：1
> 
> 时间：2009-04-05T05:05:36.220
> 
> 标签：c#

有没有让基类在 C# 中使用派生类的静态变量？像这样的东西：

```
class Program
{
    static void Main(string[] args)
    {
        int Result = DerivedClass.DoubleNumber();
        Console.WriteLine(Result.ToString());   // Returns 0
    }
}

class BaseClass
{
    public static int MyNumber;

    public static int DoubleNumber()
    {
        return (MyNumber*2);
    }
}

class DerivedClass : BaseClass
{
    public new static int MyNumber = 5;
} 
```

我试图让它返回 10，但我得到 0。

这是我使用它的地方：我有一个名为 ProfilePictures 的类和一个名为 GetTempSavePath 的静态函数，该函数将用户 ID 作为参数并返回临时文件的物理路径。路径基是一个名为 TempPath 的静态变量。由于我在多个项目中使用此类并且它们具有不同的 TempPath，因此我正在创建一个派生类，该类将该变量设置为项目的任何路径。

### 也可以看看

> [为什么我不能将 C# 方法声明为虚拟和静态？](https://stackoverflow.com/questions/248263/why-cant-i-declare-c-methods-virtual-and-static)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-05T06:01:38.770

除了已经指出的事实......静态变量被绑定或绑定到声明它们的特定类并且不能被覆盖。覆盖/多态需要实例才能工作。

你的问题可以通过改变设计来解决。

```
string ProfilePictures.GetTempSavePath(SomeType UserId, string sBasePath) 
```

如果它只需要这 2 个变量来计算返回值，则可以将其保留为实用程序/静态方法。现在您可以输入不同的基本路径..

现在从您的问题看来，您需要在多个项目（具有固定的基本路径）中使用此类，并对基本路径进行硬编码，这样您就不必为每次调用指定它。 **类型/类层次结构应该基于行为而不是数据来定义**。变量可以处理数据的变化。因此，我**建议将基本路径值保存为静态成员变量，该变量是从资源文件初始化的**（双击您的项目属性节点 > 设置 > 添加新设置文件 > 添加一个名为 BasePath 的新设置 - 字符串 - 应用程序范围 - VALUE = `C:\Users`）。现在您只需要为每个项目调整 app.config 文件，无需更改代码，无需硬编码，并且只需要一种类型。

```
public class PathHelper
{
  static string _sBasePath;
  static PathHelper()
  {
     _sBasePath = Properties.Settings.Default.BasePath;
  }

  static string GetTempSavePath(string sUserId)
  {
     // dummy logic to compute return value, replace to taste
     return Path.Combine(_sBasePath, sUserId.Substring(0, 4));
  }
} 
```

希望这是有道理的

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-05T05:19:16.453

问题是您要在派生类中重新声明静态变量。DerivedClass 中的 MyNumber 声明隐藏了基类中的声明。如果删除该声明，则派生类静态函数中对“MyNumber”的引用将引用基类变量。当然，如果您删除声明，则不能在派生类中使用静态初始化程序。

您可能需要考虑要求用户实例化 ProfilePictures 的实例，而不是为 GetTempSavePath 提供静态函数。这样，您可以覆盖 GetTempSavePath 方法以提供正确的 TempPath。或者，您可以简单地在派生类构造函数中设置静态路径值的值。

尽管可以对静态成员使用继承，但如果没有“this”指针，则不能依赖多态行为。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-05T05:23:52.137

静态成员不是虚拟的，因此您不能覆盖它们。

当您调用时，`DerivedClass.DoubleNumber`您实际上是在调用`BaseClass.DoubleNumber`，因为`DerivedClass`该类没有该方法。此外，无论您如何调用该方法`MyNumber`，都将始终使用该方法。`BaseClass.MyNumber`

您正在寻找的是可以在派生类中覆盖的虚拟属性。由于虚拟成员不能是静态的，因此需要使用类的实例。如果保留对实例的引用不切实际，则可以使用单例模式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-05T09:54:36.293

这有点工作：

```
public class ClassA
{
    protected static int num = 5;

    public static int GetNum()
    {
        return num;
    }
}

public class ClassB : ClassA
{
    static ClassB()
    {
        num = 6;
    }
} 
```

但是，请注意在实例化一个对象之前和之后调用 ClassB.GetNum() 时的区别。静态初始化程序在您创建至少一个之前不会运行，因此如果没有创建任何对象，您将获得 5，如果至少有一个对象，您将获得 6。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-05T05:11:11.217

提供一个返回类静态的虚拟方法。

```
class BaseClass
{
    public virtual int GetMyNumber() { return MyNumber; }
} 
```

您可能想改用虚拟属性...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-05T09:42:51.470

如果要封装整个对象的逻辑，也不建议使用过多的静态成员。例如，您的代码可以通过以下方式正确重写......这是最推荐的，

```
class Program
{
    static void Main(string[] args)
    {
        int Result = DerivedClass.Instance.DoubleNumber();
        Console.WriteLine(Result.ToString());   // Returns 0
    }
}

class BaseClass
{
    protected BaseClass(){} // this enforces that it can not be created

    public int MyNumber;

    public virtual int DoubleNumber()
    {
        return (MyNumber*2);
    }
}

public class DerivedClass : BaseClass
{
    // this also ensures that it can not be created outside
    protected DerivedClass(){
        MyNumber = 5;
    }

    // only way to access this is by Instance member...
    public static DerivedClass Instance = new DerivedClass();
} 
```

这就是我们访问配置值和 .Net 库提供的许​​多其他单实例静态对象的方式。

# php - 需要 PHP5 的示例 XML-RPC 客户端代码

> ID：718377
> 
> 赞同：10
> 
> 时间：2009-04-05T05:11:32.947
> 
> 标签：php, xml-rpc

需要有关如何为 XML-RPC 客户端使用 PHP（版本 PHP 版本 5.2.6）内置的 XML-RPC 库的教程或说明。服务器在 Python 中并且可以工作。

谷歌和 php.net 让我失望了。

## 更新：

根据 phpinfo，我安装了**xmlrpc-epi v. 0.51** 。我访问了[http://xmlrpc-epi.sourceforge.net/](http://xmlrpc-epi.sourceforge.net/)但左侧的 xmlrpc-epi-php 示例部分向我展示了 sf.net 的 404 版本。

## 更新2：

我将使用[http://phpxmlrpc.sourceforge.net/](http://phpxmlrpc.sourceforge.net/)并希望这对我有用。

## 更新3：

[http://phpxmlrpc.sourceforge.net/](http://phpxmlrpc.sourceforge.net/)上的代码很简单，我开始工作了。

不关闭问题。如果有人想加入超简单的解决方案，那就太好了！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-05T07:13:01.173

一个非常简单的xmlrpc客户端，我使用了一个cURL类，你可以从：[https ://github.com/dcai/curl/blob/master/src/dcai/curl.php](https://github.com/dcai/curl/blob/master/src/dcai/curl.php)

```
class xmlrpc_client {
    private $url;
    function __construct($url, $autoload=true) {
        $this->url = $url;
        $this->connection = new curl;
        $this->methods = array();
        if ($autoload) {
            $resp = $this->call('system.listMethods', null);
            $this->methods = $resp;
        }
    }
    public function call($method, $params = null) {
        $post = xmlrpc_encode_request($method, $params);
        return xmlrpc_decode($this->connection->post($this->url, $post));
    }
}
header('Content-Type: text/plain');
$rpc = "http://10.0.0.10/api.php";
$client = new xmlrpc_client($rpc, true);
$resp = $client->call('methodname', array());
print_r($resp); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-05-12T19:08:28.477

寻找相同的解决方案。这是一个超级简单的类，理论上可以与任何 XMLRPC 服务器一起工作。我在 20 分钟内完成了它，所以还有很多需要改进的地方，比如自省、更好的错误处理等。

```
file: xmlrpcclient.class.php

<?php

/**
 * XMLRPC Client
 *
 * Provides flexible API to interactive with XMLRPC service. This does _not_
 * restrict the developer in which calls it can send to the server. It also
 * provides no introspection (as of yet).
 *
 * Example Usage:
 *
 * include("xmlrpcclient.class.php");
 * $client = new XMLRPCClient("http://my.server.com/XMLRPC");
 * print var_export($client->myRpcMethod(0));
 * $client->close();
 *
 * Prints:
 * >>> array (
 * >>>   'message' => 'RPC method myRpcMethod invoked.',
 * >>>   'success' => true,
 * >>> )
 */

class XMLRPCClient
{
    public function __construct($uri)
    {
        $this->uri = $uri;
        $this->curl_hdl = null;
    }

    public function __destruct()
    {
        $this->close();
    }

    public function close()
    {
        if ($this->curl_hdl !== null)
        {
            curl_close($this->curl_hdl);
        }
        $this->curl_hdl = null;
    }

    public function setUri($uri)
    {
        $this->uri = $uri;
        $this->close();
    }

    public function __call($method, $params)
    {
        $xml = xmlrpc_encode_request($method, $params);

        if ($this->curl_hdl === null)
        {
            // Create cURL resource
            $this->curl_hdl = curl_init();

            // Configure options
            curl_setopt($this->curl_hdl, CURLOPT_URL, $this->uri);
            curl_setopt($this->curl_hdl, CURLOPT_HEADER, 0); 
            curl_setopt($this->curl_hdl, CURLOPT_RETURNTRANSFER, true);
            curl_setopt($this->curl_hdl, CURLOPT_POST, true);
        }

        curl_setopt($this->curl_hdl, CURLOPT_POSTFIELDS, $xml);

        // Invoke RPC command
        $response = curl_exec($this->curl_hdl);

        $result = xmlrpc_decode_request($response, $method);

        return $result;
    }
}

?> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-08-12T11:38:50.783

我编写了一个简单的面向对象的包装器，它使它变得如此简单：

```
    require_once('ripcord.php');
    $client = ripcord::xmlrpcClient($url);
    $score = $client->method($argument, $argument2, ..);

```

看[http://code.google.com/p/ripcord/wiki/RipcordClientManual](http://code.google.com/p/ripcord/wiki/RipcordClientManual)了解更多信息和下载链接。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-08-11T22:00:41.597

我在[http://code.runnable.com/UnEjkT04_CBwAAB4/how-to-create-a-xmlrpc-server-and-a-xmlrpc-client-for-php找到了这个解决方案](http://code.runnable.com/UnEjkT04_CBwAAB4/how-to-create-a-xmlrpc-server-and-a-xmlrpc-client-for-php)

webfaction api中的登录示例

```
// login is the method in the xml-rpc server and username and password
// are the params
$request = xmlrpc_encode_request("login", array('username', 'password'));

$context = stream_context_create(array('http' => array(
'method' => "POST",
'header' => "Content-Type: text/xml\r\nUser-Agent: PHPRPC/1.0\r\n",
'content' => $request
)));

$server = 'https://api.webfaction.com/'; // api url
$file = file_get_contents($server, false, $context);

$response = xmlrpc_decode($file);

print_r($response); 
```

你会看到类似的东西：

```
Array ( [0] => 5d354f42dcc5651fxe6d1a21b74cd [1] => Array ( [username] => yourusername [home] => /home [mail_server] => Mailbox14 [web_server] => Webxxx [id] => 123456 ) ) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-05T06:08:55.273

Wordpress 有 XML-RPC.php 文件，看看那个.. 它可能会有所帮助

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-30T00:38:46.113

此外，[fxmlrpc](https://github.com/lstrojny/fxmlrpc)（与`NativeSerializer`and一起使用时`NativeParser`）是`ext/xmlrpc`.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-12T11:59:46.523

从 php 官方链接[http://www.php.net/manual/en/ref.xmlrpc.php](http://www.php.net/manual/en/ref.xmlrpc.php)使用 steph 的示例（在底部）作为起点。他使用的是同一台服务器，并且易于设置。也就是说，如果您不想使用外部库或框架。但是，如果您这样做，请查看[http://framework.zend.com/manual/1.12/en/zend.xmlrpc.server.html](http://framework.zend.com/manual/1.12/en/zend.xmlrpc.server.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-11-02T15:18:38.867

用php编写的客户端和服务器：

[https://tldp.org/HOWTO/XML-RPC-HOWTO/xmlrpc-howto-php.html](https://tldp.org/HOWTO/XML-RPC-HOWTO/xmlrpc-howto-php.html)

# ruby-on-rails - How to access the variables defined in environment.rb in RoR?

> ID：718382
> 
> 赞同：2
> 
> 时间：2009-04-05T05:18:49.810
> 
> 标签：ruby-on-rails, ruby

I want to create a thread object in **environment.rb** and use it in some other action of some controller.

How should I do it?

Thanks in advance.

* * *

Actually, I want three processes to be running perpetually which are fetching some data and storing it in database. That's why I am using threads. Is there any other way to do so?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-05T06:01:27.600

To answer your initial question, constants declared in environment.rb are available throughout the entire codebase. Avoid doing so if you can, though; this can become configuration spaghetti pretty quickly.

More broadly, although Rails has been (from what I understand) thread-safe since version 2.2, threads are still quite uncommon - particularly in MRI - as a way to provide concurrent operation, and MRI's green threads are anyway not particularly helpful. Consider using a message queue like [Starling](http://www.rubyinside.com/starling-and-rudeq-persistent-ruby-queues-958.html) that spins up other Ruby processes to perform asynchronous work.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T05:42:19.503

Be very careful with this. To the best of my knowledge, rails is not thread-safe. And trying to use threads safely in the face of all the magic (excuse me, "meta programming") it does sounds risky as all get out.

Why do you want a thread object anyway?

In response to the comment, saying rails is thread safe [might not mean as much as you think](http://m.onkey.org/2008/10/23/thread-safety-for-your-rails). I's certainly be leery of counting on it at if I didn't need to.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T09:14:40.570

除了 Brian 所说的，考虑使用初始化程序（放入 config/initializers 以使其执行）。我认为它使意图比使用 environment.rb 更清楚。

# c# - 如何将 Windows 外观用于系统托盘上下文菜单？

> ID：718386
> 
> 赞同：5
> 
> 时间：2009-04-05T05:20:07.467
> 
> 标签：c#, .net, winforms

我正在使用`NotifyIcon`and `ContextMenuStrip`，我不想使用默认菜单的外观和感觉，该外观和感觉是通过使用`contextMenu.RenderMode = ToolStripRenderMode.ManagerRenderMode`or与 Windows（在我的情况下为 Vista）不同的控件一起提供的`contextMenu.RenderMode = ToolStripRenderMode.Professional`：

![替代文字](https://dl.getdropbox.com/u/477279/Stackoverflow/cm_professional.gif)

我不想这样使用`contextMenu.RenderMode = ToolStripRenderMode.System`：

![替代文字](https://dl.getdropbox.com/u/477279/Stackoverflow/cm_system.gif)

我只想使用标准的、正常的 Windows“外观”，就像在无数可能是非 .net 应用程序中看到的那样 *grumble*：

![替代文字](https://dl.getdropbox.com/u/477279/Stackoverflow/cm_windows-style1.gif) ![替代文字](https://dl.getdropbox.com/u/477279/Stackoverflow/cm_windows-style2.gif)

关于如何实现这一目标的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-06T05:42:59.697

在 Vista 上，当使用所有默认值时，它可以正确呈现（即，与 DropBox 在我的机器上呈现的方式相同）。

这是一个适合我的示例程序。试试看，如果它没有为您正确呈现，请尝试取消注释这两个注释行。

```
using System;
using System.Windows.Forms;
using System.Drawing;

public class AC : ApplicationContext
{
    NotifyIcon ni;
    public void menu_Quit(Object sender, EventArgs args)
    {
        ni.Dispose();
        ExitThread();
    }
    public AC()
    {
        ni = new NotifyIcon();
        ni.Icon = SystemIcons.Information;
        ContextMenu menu = new ContextMenu();
        menu.MenuItems.Add("Quit", new EventHandler(menu_Quit));
        ni.ContextMenu = menu;
        ni.Visible = true;
    }
    public static void Main(string[] args)
    {
        //Application.EnableVisualStyles();
        //Application.SetCompatibleTextRenderingDefault(false);
        AC ac = new AC();
        Application.Run(ac);        
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T06:15:02.110

**作为参考，这是获取带有 Windows 样式上下文菜单的通知图标的方法：**

1) 在控件工具箱中，右键单击所有 Windows 窗体 > 选择项目

2）勾选上下文菜单>确定

3) 右键单击​​所有 Windows 窗体 > 按字母顺序排序项目

4) 将新的 ContextMenu 拖入表单设计器

5）右键单击 ContextMenu1 > 属性 > 将其重命名为令人难忘的名称（为了将来参考，我已将我的重命名为`myNotifyIconContext`）

6) 在解决方案资源管理器中，展开 Form1.cs (etc) > 双击 Form1.Designer.cs

7) 找到您的通知图标 - 它看起来像这样：

```
// 
// notifyIcon1
// 
this.notifyIcon1.ContextMenuStrip = this.contextMenuStrip1;
this.notifyIcon1.Icon = ((System.Drawing.Icon)(resources.GetObject("notifyIcon1.Icon")));
this.notifyIcon1.Text = "My Notification Icon";
this.notifyIcon1.Visible = true; 
```

在这里，我以前有一个 ContextMenuStrip。

8）将第一行代码更改为（或添加）：

```
this.notifyIcon1.ContextMenu = this.myNotifyIconContext; 
```

瞧！

![在此处输入图像描述](https://i.stack.imgur.com/5FQ38.png)

# asp.net - 在 C# 中防止页面刷新

> ID：718394
> 
> 赞同：4
> 
> 时间：2009-04-05T05:28:12.003
> 
> 标签：asp.net, postback, refresh

刷新时重复的[Asp.Net 按钮事件再次触发？？？图形用户界面？](https://stackoverflow.com/questions/716187/asp-net-button-event-on-refresh-fires-again-guid/716252#716252)

你好，我是一个网站，当用户单击按钮和页面回发时，如果用户刷新页面或按 F5，则再次调用按钮方法。

任何人都知道一些方法来防止页面刷新而无需再次将页面重定向到同一页面？

像 if (page.isRefresh) 之类的东西......或者如果存在任何 javascript 解决方案更好。

这看起来可行....但是当我刷新它时它不会回发而是在文本框中显示之前的值

[http://www.dotnetspider.com/resources/4040-IsPageRefresh-ASP-NET.aspx](http://www.dotnetspider.com/resources/4040-IsPageRefresh-ASP-NET.aspx)

```
private Boolean IsPageRefresh = false;
protected void Page_Load(object sender, EventArgs e)
{        
    if (!IsPostBack)
    {
        ViewState["postids"] = System.Guid.NewGuid().ToString();
        Session["postid"] = ViewState["postids"].ToString();
        TextBox1.Text = "Hi";

    }
    else
    {
        if (ViewState["postids"].ToString() != Session["postid"].ToString())
        {
            IsPageRefresh = true;
        }
        Session["postid"] = System.Guid.NewGuid().ToString();
        ViewState["postids"] = Session["postid"];
    }
}
protected void Button1_Click(object sender, EventArgs e)
{
    if (!IsPageRefresh) // check that page is not refreshed by browser.
    {
        TextBox2.Text = TextBox1.Text + "@";

    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-05T07:30:28.837

感谢您的评论并为我的错误感到抱歉，我在以下位置找到了此代码： http: [//www.codeproject.com/KB/aspnet/Detecting_Refresh.aspx](http://www.codeproject.com/KB/aspnet/Detecting_Refresh.aspx) 这次经过测试；）

```
 private bool _refreshState;
    private bool _isRefresh;

    protected override void LoadViewState(object savedState)
    {
        object[] AllStates = (object[])savedState;
        base.LoadViewState(AllStates[0]);
        _refreshState = bool.Parse(AllStates[1].ToString());
        _isRefresh = _refreshState == bool.Parse(Session["__ISREFRESH"].ToString());
    }

    protected override object SaveViewState()
    {
        Session["__ISREFRESH"] = _refreshState;
        object[] AllStates = new object[2];
        AllStates[0] = base.SaveViewState();
        AllStates[1] = !(_refreshState);
        return AllStates;
    }

    protected void btn_Click(object sender, EventArgs e)
    {
        if (!_isRefresh)
            Response.Write(DateTime.Now.Millisecond.ToString());
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-05T06:01:13.857

您可以测试 Page.IsPostBack 属性以查看页面是否正在响应初始请求，或者它是否正在处理 PostBack，例如您的按钮单击事件。这里有更多信息：[IsPostBack 上的 w3schools](http://www.w3schools.com/aspnet/aspnet_events.asp)

不幸的是，这并不能解决您的问题，因为当用户单击按钮以及在按钮操作发生后刷新页面时，IsPostBack 将为真。

如果您正在执行诸如对某些数据执行 CRUD 之类的任务，您可以在完成处理后 Response.Redirect 将用户重定向回同一页面并解决此问题。它具有重新加载内容的附带好处（假设您将记录添加到现在将在页面中显示的数据库......）并防止刷新问题行为。唯一需要注意的是，他们仍然通过追溯历史来重新提交表格。

回发对于 Asp.net 来说是一个糟糕的实现选择，并且通常会毁掉我的 Webforms 平台。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-22T15:21:08.243

这并不能解决问题。

首先，在视图状态中存储令牌不是一个好主意，因为它可以被禁用。改用控制状态。虽然，HttpModule 是一个更好的解决方案。

总而言之，这无论如何都行不通。如果您打开另一个选项卡/窗口，则会话对于前一个选项卡/窗口将无效。因此制动它。每次首次加载页面时，您必须以某种方式存储唯一值。使用它来确定请求来自哪里，然后检查“刷新票”。如您所见，一个用户的对象可能会变得相当大，具体取决于发出的请求数量、存储此信息的位置和时间。

恐怕我还没有看到任何解决方案，因为它非常复杂。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-14T21:55:49.280

```
 bool IsPageRefresh ;

 if (Page.IsPostBack)
    {
        if (ViewState["postid"].ToString() != Session["postid"].ToString())
            IsPageRefresh = true;
    }
    Session["postid"] = System.Guid.NewGuid().ToString();
    ViewState["postid"] = Session["postid"]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-05-06T17:30:20.457

我尝试了很多方法，最终查找了触发回发/刷新时发送的表单数据...我发现创建的任何 VIEWSTATE 都有一个键，您可以比较这些键，例如...

我把它放在我的自定义主页上，以便像属性一样重用它

> ```
> public bool IsPageRefresh = false;
> protected void Page_Init(object sender, EventArgs e)
> {
>      if (IsPostBack)
>      {
>           var rForm = Request.Form;
>           var vw = rForm["__EVENTVALIDATION"].ToString();
>           var svw = Session["__EVENTVALIDATION"] ?? "";
>           if (vw.Equals(svw)) IsPageRefresh = true;
>                Session["__EVENTVALIDATION"] = vw;
>      }
> } 
> ```

# php - 如何获取文件的绝对路径

> ID：718399
> 
> 赞同：4
> 
> 时间：2009-04-05T05:31:22.540
> 
> 标签：php

说我有一个文件`/var/www/foo/test.php`

我如何从其中找出它的路径。我正在尝试创建一个“添加到包含路径”操作，为此我需要绝对路径。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-05T05:44:32.057

你可以使用魔法常数，`__FILE__`

[http://us2.php.net/manual/en/language.constants.predefined.php](http://us2.php.net/manual/en/language.constants.predefined.php)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-05T05:41:48.553

> **注意：**我保留了我的原始答案，但不要使用它。包含常数的解`__FILE__`是优选的。

您可以使用它`$_SERVER['DOCUMENT_ROOT']`来查找当前脚本的路径。如果您需要包含的 .php 文件的名称，请添加`$_SERVER["SCRIPT_NAME"]`，如下所示：

```
$_SERVER['DOCUMENT_ROOT'].$_SERVER["SCRIPT_NAME"]; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-05T08:57:56.913

```
realpath(dirname(__FILE__)) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-05T05:38:51.947

这将作为服务器变量提供：

```
$_SERVER["DOCUMENT_ROOT"]; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-05T05:39:38.230

```
this_file = $_SERVER["SCRIPT_NAME"]; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-05T05:45:22.570

尝试：

```
dirname(__FILE__); 
```

它将为您提供当前文件所在的目录。文件具有文件的完整路径：http: [//php.net/language.constants.predefined](http://php.net/language.constants.predefined)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-06T14:09:34.300

```
__FILE__ outputs exactly what you need. 
```

# asp.net-mvc - 尝试使用 ASP.NET MVC 上传文件

> ID：718400
> 
> 赞同：5
> 
> 时间：2009-04-05T05:32:27.170
> 
> 标签：asp.net-mvc, file-upload

我正在尝试使用 ASP.NET MVC 上传文件。

以下代码工作得很好：

```
// Read in the image data.
byte[] binaryData = null;
HttpPostedFileBase uploadedFile = Request.Files["ImageFileName"];
if (uploadedFile != null &&
    uploadedFile.ContentLength > 0)
    {
        binaryData = new byte[uploadedFile.ContentLength];
        uploadedFile.InputStream.Read(binaryData, 
                                      0,
                                      uploadedFile.ContentLength);
    } 
```

但我想做的是使用在*期货*`FileCollectionModelBinder`程序集中发现的新的。

 *我在[这里](http://msmvps.com/blogs/luisabreu/archive/2009/03/17/the-mvc-framework-working-with-uploaded-files.aspx)和[这里](http://www.hanselman.com/blog/ASPNETMVCBetaReleasedCoolnessEnsues.aspx)找到了这两篇博客文章，解释了该怎么做。我按照这些说明进行操作，但没有任何运气 ->`file`对象始终为`null`.

这是我的方法。

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Create([Bind(Include = "Subject, Content")]
                           Post post, 
                           HttpPostedFileBase file)
{
    UpdateModel(post);
    ...
} 
```

请注意我如何尝试上传文件并将一些帖子信息上传到 Post 对象。

任何人都可以提出任何建议吗？

作为记录，我已经在我的 global.asax.cs 中连接了 ModelBinder。我还确保表单是添加了 enctype 的帖子：-

```
<form method="post" enctype="multipart/form-data" action="/post/create"> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-05T13:45:27.033

没有血腥的方式:(

我想出了这个答案，这很蹩脚。

我必须让参数*NAME*与输入 type="file" 元素的 Id/Name 值相同！！！（不确定它是元素值之一还是两个元素值......我没有检查那一点）。

所以这就是答案。

### Html 输入元素。（注意 Id/Name 的值）

```
<input type="file" id="imageFileName" name="imageFileName" class="upload" /> 
```

### 控制器方法

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Create([Bind(Include = "Subject, Content")]Post post,
    HttpPostedFileBase imageFileName)
{
...
} 
```

亲！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-06T09:11:51.567

请记住，您还需要像这样打开表单：

```
<form enctype="multipart/form-data" ... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-10T22:56:47.620

不确定这是否与问题相关，但我刚刚找到了一种在复杂对象中为 HttpPostedFileBase 工作的模型绑定的方法。不幸的是，我不得不对 ASP.NET MVC 源代码进行更改，所以它并不适合所有人。

在 System.Web.Mvc.ValueProviderDictionary.PopulateDictionary() 中，值提供者填充了 Request.Form、Request.QueryString 和 RouteData 的内容 - 但不是 Request.Files。添加以下几行来“修复”这个问题（我说“修复”是因为 ASP.NET MVC 团队一开始没有这样做可能是有原因的）。

```
HttpFileCollectionBase files = ControllerContext.HttpContext.Request.Files;
if (files != null)
{
    string[] keys = files.AllKeys;
    foreach (string key in keys)
    {
        HttpPostedFileBase file = files[key];
        ValueProviderResult result = new ValueProviderResult(file, file.FileName, currentCulture);
        AddToDictionaryIfNotPresent(key, result);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-05T05:48:45.430

在过去的一周里，我一直在为我的 MVC 项目构建一个上传/文件管理器系统，我最初的尝试是使用多部分文件值发布额外的帖子数据。这对我的时间限制来说太难了。我现在的方法是创建可以“附加”文件/图像的“相应记录”（在我的情况下），然后在记录出现后上传（“附加”）文件/图像。

例如：1）创建事件记录，2）使用上传控件附加图像

我接收多部分帖子的操作使用了[Hanselman 帖子](http://www.hanselman.com/blog/ABackToBasicsCaseStudyImplementingHTTPFileUploadWithASPNETMVCIncludingTestsAndMocks.aspx)中的概念。

我不能说我已经尝试过文件的内置复杂类型绑定（HttpPostedFileBase），但我建议它比我目前的解决方案更复杂，因为通过阅读 Hanselman 上面写的帖子 - 我了解到中返回的文件集合`Request`只是一个松散类型的集合。

我建议坚持使用您的原始代码并尝试使其更安全以达到您的目的。

# java - VM options in project properties in netbeans

> ID：718402
> 
> 赞同：1
> 
> 时间：2009-04-05T05:35:09.770
> 
> 标签：java, netbeans, out-of-memory, size, heap-memory

I got a problem with the java heap space while using servlets in netbeans5.0 and got a solution to resolve it too,they asked to change the VM options of run category in the project properties.But,i couldnt find such option in my properties.Please do tell me what to do with this error. This is the picture of my project properties.

[alt text http://img390.imageshack.us/img390/4116/28257416.png](http://img390.imageshack.us/img390/4116/28257416.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-05T07:05:24.733

It it's netbeans that is short of memory then edit netbeans\etc\netbeans.conf and add/edit to the property netbeans_ default_options something like:

```
-J-Xms128m -J-Xmx128m -J-XX:PermSize=64m -J-XX:MaxPermSize=128m 
```

If it's your servlet container (tomcat) that is short of memory after many redeployments then right click on tomcat > properties > platform > vm options:

```
-Xms128m -Xmx128m -XX:PermSize=64m -XX:MaxPermSize=128m 
```

Feel free to experiment with the numbers. The above are semi-random.

# caching - 可以在 EJB3 中缓存远程无状态会话 bean 引用吗？

> ID：718411
> 
> 赞同：6
> 
> 时间：2009-04-05T05:42:35.663
> 
> 标签：caching, ejb-3.0, ejb, jndi, stateless-session-bean

我正在从 J2SE 应用程序调用远程无状态会话 bean，并希望缓存对会话 bean 的引用以降低查找成本。这个可以吗？

在 EJB2 中，ServiceLocator 模式通常用于缓存对远程资源的查找，但 EJB3 没有单独的 EJB Home（通常被缓存）和 Remote 对象。

谷歌搜索，一个常见的答案是使用 EJB3 注入，但由于我正在从 J2SE 客户端调用远程 EJB 服务器，所以我不能使用注入。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-05T05:51:38.013

是的，它们可以被缓存。但是我不知道如果你有一个缓存的引用并且服务器在它下面重新启动，会发生什么行为。您可以测试该场景，但行为可能因容器而异。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T21:28:47.947

如果服务器消失，您的引用将变得无效。

至于正常生命周期中的缓存，这应该没问题。多年来，我在 EJB2 和 EJB3 中都这样做了，从来没有遇到过问题。一般来说，我只有一个静态的“LookupServices”类，它只是查找房屋，或者如果它已经存在则返回现有的 - 并将其存储在地图中。

# php - 警告：分配条件

> ID：718415
> 
> 赞同：4
> 
> 时间：2009-04-05T05:44:01.277
> 
> 标签：php, mysql, coding-style, variable-assignment, conditional-statements

一直困扰着我的一件事是，在检查我的 PHP 脚本是否有问题时，我收到警告“bool-assign : Assignment in condition”，而且我得到了很多。

例如：

```
$guests = array();
$sql = "SELECT * FROM `guestlist`";
$result = mysql_query($sql);
while($row = mysql_fetch_assoc($result))
    $guests[] = $row['name']; 
```

是否有不同的方法将多行或所有行放入对象或数组中？或者这种方法没有问题？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-05T05:49:20.173

尝试这样做：

```
$guests = array();
$sql = "SELECT * FROM `guestlist`";
$result = mysql_query($sql);
while(($row = mysql_fetch_assoc($result)) !== false)
    $guests[] = $row['name']; 
```

我相信 PHP 因为`$row = mysql_fetch_assoc($result)`没有返回布尔值而发出警告。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-05T05:54:43.437

实际上，我相信这是警告，因为您可能会犯错误。通常在有条件的情况下，您的意思是：

```
if (something == something_else) 
```

但是很容易犯错就走：

```
if (something = something_else) 
```

所以它可能会警告你。如果 PHP 与 C 完全一样，您可以在语句周围使用一组括号来解决您的问题，如下所示：

```
while(($row = mysql_fetch_assoc($result))) 
```

我相信 Jeremy 的回答有点不对劲，因为 PHP 的类型很松散，而且通常不会理会这些区别。

# java - Scaling images/icons in Java

> ID：718419
> 
> 赞同：0
> 
> 时间：2009-04-05T05:45:08.403
> 
> 标签：java, png, svg, jpeg, image-conversion

A project I am working on needs to be resized when the monitor resolution changes. Due to legacy code and other issues, we do it by using a custom library which scales all the components to the appropriate sizes when the resolution changes.

However, when we scale some of the images/icons used in the project, they become blurry/fuzzy/aliased. Mostly because they are all raster gifs.

One solution we thought might work to mitigate this issue is to either use Vector images and convert them into raster images on the fly (and cache them for performance improvements).

What do you all think? Would this be a good way to go? Or are there better alternatives to my chosen method?

If this is a better way, then can someone give pointers to how to go about the svg conversion to say jpg or png(preferably). Available (and commercially usable) libraries?

Thanks

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-05T07:34:43.697

The algo's in java are pretty good. The fundamental problem sounds as if your original images/icons are already too small so scaling them up leaves you with artefacts. A real simple approach is to have the images sent along with the app to be at the larger size and only scale down. I would say a policy on images sizes (pixels height and width) is necessary as you seem to indicate that only some have problems.

Of course if you can go for vector graphics, you can scale infinitely and this may be a better long term investments depending upon your application and the likely hood of needing to support large output formats (not just screens but printing). It may well be fairly complex to approach things this way. (More information would be needed to help you further with the points in this para.)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T07:25:44.137

[Batik](http://xmlgraphics.apache.org/batik/) can convert svgs into pngs or jpegs

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T12:25:01.533

Metal（跨平台）PL&F 中的图标被绘制成一个缓冲图像，以便与它碰巧发现自己运行的任何机器融为一体。这是一种快速的技术，不会添加依赖项，也不需要学习任何额外的 API（或语言！）。`src.zip`在您的 Sun JDK 中查看。

# emacs - 当键入“（”时，使 M-( 成为 Emacs 中的默认行为

> ID：718428
> 
> 赞同：7
> 
> 时间：2009-04-05T05:51:01.293
> 
> 标签：emacs

如何使 M-( 成为输入开头 "(" 字符的默认行为？我希望 Emacs 在我输入 "(" 字符时自动在光标后插入结尾 ")"，无论它是否是 M- 的一部分组合键。另外，我想将此行为扩展到引号、子引号、方括号和大括号。键入 M-( 很痛苦，而且对于那些其他字符似乎没有任何可比的形式。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-05T05:56:01.450

我自己写的不多，但这是我抄袭某人的东西。代码进入您的 .emacs。

```
(setq skeleton-pair t)
(setq skeleton-pair-on-word t) ; apply skeleton trick even in front of a word.                                               
(global-set-key "[" 'skeleton-pair-insert-maybe)
(global-set-key "{" 'skeleton-pair-insert-maybe)
(global-set-key "(" 'skeleton-pair-insert-maybe)
(global-set-key "\"" 'skeleton-pair-insert-maybe) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-05T06:49:57.297

查看[paredit.el](http://www.emacswiki.org/cgi-bin/wiki/ParEdit)，它可以根据需要保持括号/大括号/引号平衡，并且还提供许多其他功能来协助 s-exp 操作。如果您要编写 Lisp 代码（正如您的名字所暗示的那样），您最终可能会想要使用这个库。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-05T05:57:08.250

"(" 绑定到`self-insert-command`而 M-'(' 是`insert-parenthesis`。您可以简单地通过使用`global-set-key`或`define-key`将 "(" 绑定到`insert-parenthesis`.

# objective-c - Creating URL query parameters from NSDictionary objects in ObjectiveC

> ID：718429
> 
> 赞同：90
> 
> 时间：2009-04-05T05:51:35.003
> 
> 标签：objective-c, nsurl

With all the URL-handling objects lying around in the standard Cocoa libraries (NSURL, NSMutableURL, NSMutableURLRequest, etc), I know I must be overlooking an easy way to programmatically compose a GET request.

Currently I'm manually appending "?" followed by name value pairs joined by "&", but all of my name and value pairs need to be manually encoded so NSMutableURLRequest doesn't fail entirely when it tries to connect to the URL.

This feels like something I should be able to use a pre-baked API for.... is there anything out of the box to append an NSDictionary of query parameters to an NSURL? Is there another way I should approach this?

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2014-10-23T23:22:19.387

在 iOS8 和 OS X 10.10 中引入的是`NSURLQueryItem`，可用于构建查询。从[NSURLQueryItem](https://developer.apple.com/Library/ios/documentation/Foundation/Reference/NSURLQueryItem_Class/index.html)上的文档：

> NSURLQueryItem 对象表示 URL 查询部分中项目的单个名称/值对。您可以使用带有 NSURLComponents 对象的 queryItems 属性的查询项。

要创建一个使用指定的初始化程序`queryItemWithName:value:`，然后将它们添加`NSURLComponents`到生成一个`NSURL`. 例如：

```
NSURLComponents *components = [NSURLComponents componentsWithString:@"http://stackoverflow.com"];
NSURLQueryItem *search = [NSURLQueryItem queryItemWithName:@"q" value:@"ios"];
NSURLQueryItem *count = [NSURLQueryItem queryItemWithName:@"count" value:@"10"];
components.queryItems = @[ search, count ];
NSURL *url = components.URL; // http://stackoverflow.com?q=ios&count=10 
```

请注意，问号和 & 号是自动处理的。`NSURL`从参数字典创建一个非常简单：

```
NSDictionary *queryDictionary = @{ @"q": @"ios", @"count": @"10" };
NSMutableArray *queryItems = [NSMutableArray array];
for (NSString *key in queryDictionary) {
    [queryItems addObject:[NSURLQueryItem queryItemWithName:key value:queryDictionary[key]]];
}
components.queryItems = queryItems; 
```

我还写了[一篇](http://masilotti.com/nsurlqueryitems)关于如何使用 和 构建 URL`NSURLComponents`的博文`NSURLQueryItems`。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-04-05T06:44:17.623

You can create a category for `NSDictionary` to do this -- there isn't a standard way in the Cocoa library that I could find either. The code that I use looks like this:

```
// file "NSDictionary+UrlEncoding.h"
#import <cocoa/cocoa.h>

@interface NSDictionary (UrlEncoding)

-(NSString*) urlEncodedString;

@end 
```

with this implementation:

```
// file "NSDictionary+UrlEncoding.m"
#import "NSDictionary+UrlEncoding.h"

// helper function: get the string form of any object
static NSString *toString(id object) {
  return [NSString stringWithFormat: @"%@", object];
}

// helper function: get the url encoded string form of any object
static NSString *urlEncode(id object) {
  NSString *string = toString(object);
  return [string stringByAddingPercentEscapesUsingEncoding: NSUTF8StringEncoding];
}

@implementation NSDictionary (UrlEncoding)

-(NSString*) urlEncodedString {
  NSMutableArray *parts = [NSMutableArray array];
  for (id key in self) {
    id value = [self objectForKey: key];
    NSString *part = [NSString stringWithFormat: @"%@=%@", urlEncode(key), urlEncode(value)];
    [parts addObject: part];
  }
  return [parts componentsJoinedByString: @"&"];
}

@end 
```

I think the code's pretty straightforward, but I discuss it in some more detail at [http://blog.ablepear.com/2008/12/urlencoding-category-for-nsdictionary.html](http://blog.ablepear.com/2008/12/urlencoding-category-for-nsdictionary.html).

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2011-12-07T19:04:09.663

我想使用 Chris 的答案，但它不是为*自动引用计数*(ARC) 编写的，所以我更新了它。我想我会粘贴我的解决方案，以防其他人遇到同样的问题。 **注意：**在适当的地方替换`self`为实例或类名。

```
+(NSString*)urlEscapeString:(NSString *)unencodedString 
{
    CFStringRef originalStringRef = (__bridge_retained CFStringRef)unencodedString;
    NSString *s = (__bridge_transfer NSString *)CFURLCreateStringByAddingPercentEscapes(NULL,originalStringRef, NULL, (CFStringRef)@"!*'\"();:@&=+$,/?%#[]% ", kCFStringEncodingUTF8);
    CFRelease(originalStringRef);
    return s;
}

+(NSString*)addQueryStringToUrlString:(NSString *)urlString withDictionary:(NSDictionary *)dictionary
{
    NSMutableString *urlWithQuerystring = [[NSMutableString alloc] initWithString:urlString];

    for (id key in dictionary) {
        NSString *keyString = [key description];
        NSString *valueString = [[dictionary objectForKey:key] description];

        if ([urlWithQuerystring rangeOfString:@"?"].location == NSNotFound) {
            [urlWithQuerystring appendFormat:@"?%@=%@", [self urlEscapeString:keyString], [self urlEscapeString:valueString]];
        } else {
            [urlWithQuerystring appendFormat:@"&%@=%@", [self urlEscapeString:keyString], [self urlEscapeString:valueString]];
        }
    }
    return urlWithQuerystring;
} 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2012-10-22T19:16:59.720

如果值是字符串，则其他答案效果很好，但是如果值是字典或数组，则此代码将处理该问题。

*需要注意的是，没有通过查询字符串传递数组/字典的标准方法，但 PHP 可以很好地处理此输出*

```
-(NSString *)serializeParams:(NSDictionary *)params {
    /*

     Convert an NSDictionary to a query string

     */

    NSMutableArray* pairs = [NSMutableArray array];
    for (NSString* key in [params keyEnumerator]) {
        id value = [params objectForKey:key];
        if ([value isKindOfClass:[NSDictionary class]]) {
            for (NSString *subKey in value) {
                NSString* escaped_value = (NSString *)CFURLCreateStringByAddingPercentEscapes(NULL,
                                                                                              (CFStringRef)[value objectForKey:subKey],
                                                                                              NULL,
                                                                                              (CFStringRef)@"!*'();:@&=+$,/?%#[]",
                                                                                              kCFStringEncodingUTF8);
                [pairs addObject:[NSString stringWithFormat:@"%@[%@]=%@", key, subKey, escaped_value]];
            }
        } else if ([value isKindOfClass:[NSArray class]]) {
            for (NSString *subValue in value) {
                NSString* escaped_value = (NSString *)CFURLCreateStringByAddingPercentEscapes(NULL,
                                                                                              (CFStringRef)subValue,
                                                                                              NULL,
                                                                                              (CFStringRef)@"!*'();:@&=+$,/?%#[]",
                                                                                              kCFStringEncodingUTF8);
                [pairs addObject:[NSString stringWithFormat:@"%@[]=%@", key, escaped_value]];
            }
        } else {
            NSString* escaped_value = (NSString *)CFURLCreateStringByAddingPercentEscapes(NULL,
                                                                                          (CFStringRef)[params objectForKey:key],
                                                                                          NULL,
                                                                                          (CFStringRef)@"!*'();:@&=+$,/?%#[]",
                                                                                          kCFStringEncodingUTF8);
            [pairs addObject:[NSString stringWithFormat:@"%@=%@", key, escaped_value]];
            [escaped_value release];
        }
    }
    return [pairs componentsJoinedByString:@"&"];
} 
```

**例子**

```
[foo] => bar
[translations] => 
        {
            [one] => uno
            [two] => dos
            [three] => tres
        } 
```

**foo=bar&translations[one]=uno&translations[two]=dos&translations[three]=tres**

```
[foo] => bar
[translations] => 
        {
            uno
            dos
            tres
        } 
```

**foo=bar&translations[]=uno&translations[]=dos&translations[]=tres**

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2014-06-30T10:23:01.053

我重构并转换为 AlBeebe 的 ARC 答案

```
- (NSString *)serializeParams:(NSDictionary *)params {
    NSMutableArray *pairs = NSMutableArray.array;
    for (NSString *key in params.keyEnumerator) {
        id value = params[key];
        if ([value isKindOfClass:[NSDictionary class]])
            for (NSString *subKey in value)
                [pairs addObject:[NSString stringWithFormat:@"%@[%@]=%@", key, subKey, [self escapeValueForURLParameter:[value objectForKey:subKey]]]];

        else if ([value isKindOfClass:[NSArray class]])
            for (NSString *subValue in value)
            [pairs addObject:[NSString stringWithFormat:@"%@[]=%@", key, [self escapeValueForURLParameter:subValue]]];

        else
            [pairs addObject:[NSString stringWithFormat:@"%@=%@", key, [self escapeValueForURLParameter:value]]];

}
return [pairs componentsJoinedByString:@"&"]; 
```

}

```
- (NSString *)escapeValueForURLParameter:(NSString *)valueToEscape {
     return (__bridge_transfer NSString *) CFURLCreateStringByAddingPercentEscapes(NULL, (__bridge CFStringRef) valueToEscape,
             NULL, (CFStringRef) @"!*'();:@&=+$,/?%#[]", kCFStringEncodingUTF8);
} 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-12-24T08:03:04.437

如果您已经在使用[AFNetworking](https://github.com/AFNetworking/AFNetworking)（就像我一样），您可以使用它的类`AFHTTPRequestSerializer`来创建所需的`NSURLRequest`.

`[[AFHTTPRequestSerializer serializer] requestWithMethod:@"GET" URLString:@"YOUR_URL" parameters:@{PARAMS} error:nil];`

如果您只需要工作的 URL，请使用`NSURLRequest.URL`.

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-04-26T22:23:33.907

这是**Swift** (iOS8+) 中的一个简单示例：

```
private let kSNStockInfoFetchRequestPath: String = "http://dev.markitondemand.com/Api/v2/Quote/json"

private func SNStockInfoFetchRequestURL(symbol:String) -> NSURL? {
  if let components = NSURLComponents(string:kSNStockInfoFetchRequestPath) {
    components.queryItems = [NSURLQueryItem(name:"symbol", value:symbol)]
    return components.URL
  }
  return nil
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2016-09-29T12:51:00.537

我接受了 Joel 的使用建议`URLQueryItems`并变成了 Swift Extension (Swift 3)

```
extension URL
{
    /// Creates an NSURL with url-encoded parameters.
    init?(string : String, parameters : [String : String])
    {
        guard var components = URLComponents(string: string) else { return nil }

        components.queryItems = parameters.map { return URLQueryItem(name: $0, value: $1) }

        guard let url = components.url else { return nil }

        // Kinda redundant, but we need to call init.
        self.init(string: url.absoluteString)
    }
} 
```

（该`self.init`方法有点俗气，但没有`NSURL`带有组件的初始化）

可以用作

```
URL(string: "http://www.google.com/", parameters: ["q" : "search me"]) 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-10-11T09:44:47.497

```
-(NSString*)encodeDictionary:(NSDictionary*)dictionary{
    NSMutableString *bodyData = [[NSMutableString alloc]init];
    int i = 0;
    for (NSString *key in dictionary.allKeys) {
        i++;
        [bodyData appendFormat:@"%@=",key];
        NSString *value = [dictionary valueForKey:key];
        NSString *newString = [value stringByReplacingOccurrencesOfString:@" " withString:@"+"];
        [bodyData appendString:newString];
        if (i < dictionary.allKeys.count) {
            [bodyData appendString:@"&"];
        }
    }
    return bodyData;
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-04-13T02:29:35.220

我有另一个解决方案：

[http://splinter.com.au/build-a-url-query-string-in-obj-c-from-a-dict](http://splinter.com.au/build-a-url-query-string-in-obj-c-from-a-dict)

```
+(NSString*)urlEscape:(NSString *)unencodedString {
    NSString *s = (NSString *)CFURLCreateStringByAddingPercentEscapes(NULL,
        (CFStringRef)unencodedString,
        NULL,
        (CFStringRef)@"!*'\"();:@&=+$,/?%#[]% ",
        kCFStringEncodingUTF8);
    return [s autorelease]; // Due to the 'create rule' we own the above and must autorelease it
}

// Put a query string onto the end of a url
+(NSString*)addQueryStringToUrl:(NSString *)url params:(NSDictionary *)params {
    NSMutableString *urlWithQuerystring = [[[NSMutableString alloc] initWithString:url] autorelease];
    // Convert the params into a query string
    if (params) {
        for(id key in params) {
            NSString *sKey = [key description];
            NSString *sVal = [[params objectForKey:key] description];
            // Do we need to add ?k=v or &k=v ?
            if ([urlWithQuerystring rangeOfString:@"?"].location==NSNotFound) {
                [urlWithQuerystring appendFormat:@"?%@=%@", [Http urlEscape:sKey], [Http urlEscape:sVal]];
            } else {
                [urlWithQuerystring appendFormat:@"&%@=%@", [Http urlEscape:sKey], [Http urlEscape:sVal]];
            }
        }
    }
    return urlWithQuerystring;
} 
```

然后你可以像这样使用它：

```
NSDictionary *params = @{@"username":@"jim", @"password":@"abc123"};

NSString *urlWithQuerystring = [self addQueryStringToUrl:@"https://myapp.com/login" params:params]; 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-06-09T07:01:33.697

Simple way of converting NSDictionary to url query string in Objective-c

Ex: first_name=Steve&middle_name=Gates&last_name=Jobs&address=Palo Alto, California

```
 NSDictionary *sampleDictionary = @{@"first_name"         : @"Steve",
                                     @"middle_name"          : @"Gates",
                                     @"last_name"            : @"Jobs",
                                     @"address"              : @"Palo Alto, California"};

    NSMutableString *resultString = [NSMutableString string];
            for (NSString* key in [sampleDictionary allKeys]){
                if ([resultString length]>0)
                    [resultString appendString:@"&"];
                [resultString appendFormat:@"%@=%@", key, [sampleDictionary objectForKey:key]];
            }
NSLog(@"QueryString: %@", resultString); 
```

Hope will help :)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-03-24T20:37:26.347

另一个解决方案，如果您使用[RestKit](https://github.com/RestKit/RestKit)`RKURLEncodedSerialization` ，那么调用的函数`RKURLEncodedStringFromDictionaryWithEncoding`正是您想要的。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-04-19T02:57:12.770

如果你已经在使用[AFNetwork](https://github.com/AFNetworking/AFNetworking)，你可以使用他们内置的序列化器来生成一个编码的 URL；

```
NSString *baseURL = @"https://api.app.com/parse";
NSDictionary *mutableParameters = [[NSMutableDictionary alloc] initWithObjectsAndKeys:@"true",@"option1", data, @"option2", token, @"token", @"3.0", @"app", nil];
NSURLRequest *request = [[AFHTTPRequestSerializer serializer] requestWithMethod:@"GET" URLString:baseURL parameters:mutableParameters error:nil];
NSString *urlPath = request.URL.absoluteString;
NSLog(@"%@", urlPath); // https://api.app.com/parse?option1=true&option2=datavalue&token=200%3ATEST%3AENCODE .... 
```

*笔记; 这是对上述答案的扩展。编辑队列已满，因此无法添加到现有答案中。*

# c# - C# Question: File Names

> ID：718431
> 
> 赞同：0
> 
> 时间：2009-04-05T05:52:05.143
> 
> 标签：c#

I have a file called o.FileName it has a unwanted ".crash" at the end of it, how can I remove it? I tryed "o.FileName = o.FileName - ".crash";" it didn't work because it was a string

Edit: What I want to do is open a file with a OpenFileDialog then if it has a .crash or a .crash.crash at the end of it remove it and save it

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-05T05:55:57.427

Was the 'o.' the object reference?:

```
o.Filename = o.Filename.Replace(".crash", ""); 
```

otherwise:

```
filename = filename.Replace(".crash", ""); 
```

To actually rename the physical file:

```
File.Move(originalFilename, renamedFilename); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-05T06:04:35.567

Check that the string actually ends with ".crash" using the [System.String.EndsWith()](http://msdn.microsoft.com/en-us/library/system.string.endswith.aspx) method. Drop the trailing ".crash" using [System.String.Replace()](http://msdn.microsoft.com/en-us/library/system.string.replace.aspx).

```
if(o.FileName.EndsWith(".crash"))
    o.Filename = o.Filename.Replace(".crash", ""); 
```

# c# - C#：将派生类作为参数传递

> ID：718443
> 
> 赞同：0
> 
> 时间：2009-04-05T06:02:56.163
> 
> 标签：c#, derived-class

我有一个计算图像大小的基类。我从中派生了一个类，并具有将在我的代码中使用的预定义图像大小。虽然我的工作有效，但我有一种强烈的感觉，就是我做得不好。

理想情况下，我只想将 DerviedClass.PreviewSize 作为参数传递给 GetWidth，而不必创建它的实例。

```
class Program
{
    static void Main(string[] args)
    {
        ProfilePics d = new ProfilePics();
        Guid UserId = Guid.NewGuid();

        ProfilePics.Preview PreviewSize = new ProfilePics.Preview();
        d.Save(UserId, PreviewSize);
    }
}

class ProfilePicsBase
{
    public interface ISize
    {
        int Width { get; }
        int Height { get; }
    }

    public void Save(Guid UserId, ISize Size)
    {
        string PicPath = GetTempPath(UserId);
        Media.ResizeImage(PicPath, Size.Width, Size.Height);
    }
}

class ProfilePics : ProfilePicsBase
{
    public class Preview : ISize
    {
        public int Width { get { return 200; } }
        public int Height { get { return 160; } }
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-05T06:32:54.157

在我看来，您想要一个更灵活的实现`ISize`- 拥有一个*始终*返回相同值的实现似乎毫无意义。另一方面，我可以看到您想要一种简单的方法来获取始终用于预览的大小。我会这样做：

```
// Immutable implementation of ISize
public class FixedSize : ISize
{
    public static readonly FixedSize Preview = new FixedSize(200, 160);

    private readonly int width;
    private readonly int height;

    public int Width { get { return width; } }
    public int Height { get { return height; } }

    public FixedSize(int width, int height)
    {
        this.width = width;
        this.height = height;
    }
} 
```

然后你可以写：

```
ProfilePics d = new ProfilePics();
Guid userId = Guid.NewGuid();

d.Save(userId, FixedSize.Preview); 
```

`FixedSize`这将重用您调用它时的相同实例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-05T06:27:26.900

有几种方法可以做到这一点，具体取决于您的需要。我会考虑做一个不同的界面，设置。像这样的东西。

```
public interface ISizedPics
{
    int Width {get; }
    int Height {get; }
    void Save(Guid userId)
}
public class ProfilePics, iSizedPics
{
    public int Width { get { return 200; } }
    public int Height { get { return 160; } }
    public void Save(Guid UserId)
    {
        //Do your save here
    }
} 
```

然后，完成此操作后，您实际上可以像这样使用它。

```
ISizedPics picInstance = new ProfilePics;
Guid myId = Guid.NewGuid();
picInstance.Save(myId); 
```

这只是一种方法，我喜欢这种方法，因为您可以轻松地围绕它创建一个工厂类，帮助您根据需要声明实例。

# java - 除了动态类型之外，是什么让 Ruby 比 Java“更灵活”？

> ID：718444
> 
> 赞同：3
> 
> 时间：2009-04-05T06:03:01.467
> 
> 标签：java, ruby, duck-typing, dynamic-languages

几乎从 Java 首次问世以来，我就一直在使用它，但在过去的五年中，我已经厌倦了完成即使是最简单的事情变得多么复杂。在我的精神科医生的推荐下，我开始学习 Ruby，呃，我的意思是我的同事（更年轻、更酷的同事——他们使用 Mac！）。无论如何，他们不断重复的一件事是，与 Java 等较旧、更受打击的语言相比，Ruby 是一种“灵活”的语言，但我真的不知道这意味着什么。有人可以解释是什么让一种语言比另一种语言“更灵活”吗？请。我有点理解动态类型的意义，并且可以看到这对简洁有什么好处。Ruby 语法非常漂亮。还有什么？动态类型是主要原因吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-05T06:22:42.463

这也是因为它是无类（在 Java 意义上）但完全面向对象（属性模式），因此即使未定义，您也可以调用任何方法，并且您仍然有最后机会动态响应调用，例如创建方法即时必要。此外，Ruby 不需要编译，因此您可以根据需要轻松更新正在运行的应用程序。此外，一个对象可以在其生命周期内的任何时候通过 mixins 突然从另一个类/对象继承，因此这是另一个灵活性点。无论如何，我同意孩子们的观点，这种称为 Ruby 的语言实际上与 Java 一样长，在很多方面都非常灵活和出色，但我仍然无法同意它是美丽的（语法方面），C 是更漂亮的恕我直言（我是括号的傻瓜），但美丽是主观的，

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-05T07:02:13.307

动态类型并没有接近覆盖它。举一个重要的例子，Ruby 在很多情况下使元编程变得容易。在 Java 中，元编程要么是痛苦的，要么是不可能的。

例如，以 Ruby 的常规方式声明属性：

```
class SoftDrink
  attr_accessor :name, :sugar_content
end
# Now we can do...
can = SoftDrink.new
can.name = 'Coke' # Not a direct ivar access — calls can.name=('Coke')
can.sugar_content = 9001 # Ditto 
```

这不是什么特殊的语言语法——它是 Module 类的一个方法，而且很容易实现。这是一个示例实现`attr_accessor`：

```
class Module
  def attr_accessor(*symbols)
    symbols.each do |symbol|
      define_method(symbol) {instance_variable_get "@#{symbol}"}
      define_method("#{symbol}=") {|val| instance_varible_set("@#{symbol}", val)}
    end
  end
end 
```

这种功能可以让您在表达程序方面有很多，是的，灵活性。

很多看起来像是语言特性的东西（在大多数语言中都是语言特性）只是 Ruby 中的普通方法。再举一个例子，这里我们动态加载我们将其名称存储在数组中的依赖项：

```
dependencies = %w(yaml haml hpricot sinatra couchfoo)
block_list %w(couchfoo) # Wait, we don't really want CouchDB!
dependencies.each {|mod| require mod unless block_list.include? mod} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-05T06:35:11.920

块，闭包，很多东西。我确信早上会出现一些更好的答案，但举个例子，这是我十分钟前写的一些代码 - 我有一组 schedule_collections，其中一些已经发生，其他已经作废、取消等. 我想返回一个只包含待处理的数组。我不确定等效的 Java 是什么，但我想它不是这种单行方法：

```
def get_all_pending
  scheduled_collections.select{ |sc| sc.is_pending? }
end 
```

同样的事情的一个更简单的例子是：

```
[0,1,2,3].select{|x| x > 1} 
```

这将产生 [2,3]

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-05T06:21:43.450

我喜欢的事

*   更少的代码来表达你的观点
*   传递代码块（Proc，lambdas）很有趣，并且可以产生更小的代码。例如`[1, 2, 3].each{|x| puts "Next element #{x}"}`
*   具有 PE​​RL 的脚本根源.. 非常适合分割例程的东西，例如使用正则表达式解析文件等。全部
*   Hash 和 Array 等核心数据结构类 API 做得很好。
*   元编程（由于其动态特性） - 创建自定义 DSL 的能力（例如，Rails 可以被称为用 Ruby 编写的 WebApps 的 DSL）
*   为几乎任何事物孕育宝石的社区。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-05T06:28:29.720

混合。更改 Ruby 类以添加新功能非常简单。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-05T06:29:01.107

**鸭子类型**是指类型被认为是由它们实现的方法等价的事实，而不是基于它们声明的类型。举个具体的例子，Ruby 中的许多方法都采用类似 IO 的对象来对流进行操作。这意味着对象必须实现足够多的函数才能作为 IO 类型对象传递（它必须听起来足够像鸭子）。

最后，这意味着您必须编写比 Java 更少的代码来做同样的事情。不过，动态语言的一切都不是很好。您或多或少地放弃了 Java（和其他强/静态类型语言）为您提供的所有编译时类型检查。Ruby 根本不知道您是否将错误的对象传递给方法。这会给你一个运行时错误。此外，在实际调用代码之前，它不会给您一个运行时错误。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-05T07:02:05.287

只是为了笑，这是语言灵活性的一个相当糟糕的例子：

```
class Fixnum
  def +(other)
    self - other
  end
end

puts 5 + 3
# => 2 
```

# c++ - 将外部库添加到 Qt Creator 项目中

> ID：718447
> 
> 赞同：121
> 
> 时间：2009-04-05T06:08:14.887
> 
> 标签：c++, winapi, qt, qt-creator

如何将外部库添加到 Qt Creator RC1（版本 0.9.2）构建的项目中？例如，`EnumProcesses()`需要`Psapi.lib`在构建的项目中添加win32功能。

* * *

## 回答 #1

> 赞同：221
> 
> 时间：2009-04-25T14:22:01.900

正确的方法是这样的：

```
LIBS += -L/path/to -lpsapi 
```

这样它就可以在 Qt 支持的所有平台上运行。这个想法是您必须将目录与库名称分开（没有扩展名，也没有任何“lib”前缀）。当然，如果您包含 Windows 特定的库，这真的没关系。

如果您想将 lib 文件存储在项目目录中，可以使用`$$_PRO_FILE_PWD_`变量引用它们，例如：

```
LIBS += -L"$$_PRO_FILE_PWD_/3rdparty/libs/" -lpsapi 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-04-05T07:37:43.797

你在使用`qmake`项目吗？[`LIBS`](https://doc.qt.io/qt-5/qmake-variable-reference.html#libs)如果是这样，您可以使用该变量添加外部库。例如：

```
win32:LIBS += path/to/Psapi.lib 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-11-19T11:11:31.927

> LIBS += C:\Program Files\OpenCV\lib

将不起作用，因为您在 Program Files 中使用空格。在这种情况下，您必须添加引号，因此结果将如下所示：**LIBS += "C:\Program Files\OpenCV\lib"**。我建议将库放置在非空白位置；-)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-04-21T16:27:45.810

您的意思是由于缺少其他包含路径而导致的错误。尝试添加它： INCLUDEPATH += C:\path\to\include\files\ 希望它有效。问候。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-12-26T10:30:13.410

要添加多个库文件，您可以编写如下：

> INCLUDEPATH *= E:/DebugLibrary/VTK E:/DebugLibrary/VTK/Common E:/DebugLibrary/VTK/Filtering E:/DebugLibrary/VTK/GenericFiltering E:/DebugLibrary/VTK/Graphics E:/DebugLibrary/VTK/GUISupport/ Qt E:/DebugLibrary/VTK/Hybrid E:/DebugLibrary/VTK/Imaging E:/DebugLibrary/VTK/IO E:/DebugLibrary/VTK/Parallel E:/DebugLibrary/VTK/Rendering E:/DebugLibrary/VTK/Utilities E :/DebugLibrary/VTK/VolumeRendering E:/DebugLibrary/VTK/Widgets E:/DebugLibrary/VTK/Wrapping
> 
> LIBS *= -LE:/DebugLibrary/VTKBin/bin/release -lvtkCommon -lvtksys -lQVTK -lvtkWidgets -lvtkRendering -lvtkGraphics -lvtkImaging -lvtkIO -lvtkFiltering -lvtkDICOMParser -lvtkpng -lvtktiff -lvtkzlib -lvtkjpeg -lvtkexpat -lvtkNetCDF -lvtkexoIIc -lvtkfreetype -lvtkHybrid -lvtkVolumeRendering -lQVTKWidgetPlugin -lvtkGenericFiltering

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-08-19T21:26:39.200

如果您想在客户的机器上部署您的应用程序，而不是只自己使用您的应用程序，我们发现该`LIBS+= -Lxxx -lyyy`方法即使没有问题也会导致混乱。

我们使用 Qt 为 Linux、Mac 和 Windows 开发应用程序。我们提供完整的独立应用程序。所以所有非系统库都应该包含在部署包中。我们希望我们的客户能够从同一个 U 盘为所有操作系统运行应用程序。出于平台兼容性的原因，USB 记忆棒必须格式化为不支持 (Linux) 符号链接的 FAT32。

我们发现这个`LIBS+= -Lxxx -lyyy`成语太像一个黑盒子了：

1.  我们不完全知道链接器找到的（静态或动态）库的文件路径是什么。这很不方便。我们的 Mac 链接器经常发现与我们认为应该使用的库不同的库。这在 OpenSSL 库中发生了好几次，Mac 链接器在其中找到并使用了它自己的 - 较旧的、不兼容的 - OpenSSL 版本，而不是我们请求的版本。

2.  我们不能让链接器使用符号链接到库，因为这会破坏部署包。

3.  我们想从库的**名称**中看出我们链接的是静态库还是动态库。

所以对于我们的特殊情况，我们只使用绝对文件路径并检查它们是否存在。我们删除所有符号链接。

首先，我们找出我们正在使用的操作系统并将其放入 CONFIG 变量中。并且，例如对于 64 位 Linux，则：

```
linux64 {
    LIBSSL= $$OPENSSLPATH/linux64/lib/libssl.a
    !exists($$LIBSSL): error ("Not existing $$LIBSSL")
    LIBS+= $$LIBSSL
    LIBCRYPTO= $$OPENSSLPATH/linux64/lib/libcrypto.a
    !exists($$LIBCRYPTO): error ("Not existing $$LIBCRYPTO")
    LIBS+= $$LIBCRYPTO
} 
```

因为我们知道它们的文件路径，所以所有依赖项都可以复制到部署包中。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-05-25T21:45:00.693

为了完整起见，我想补充一点，您还可以仅添加 LIBRARY PATH ，它将在其中查找依赖库（可能不会在您的代码中直接引用，但您使用的库可能需要它）。

为了比较，这将对应于 LIBPATH 环境所做的，但它在 Qt Creator 中有点晦涩，并且没有很好的文档记录。

我解决这个问题的方法如下：

```
LIBS += -L"$$_PRO_FILE_PWD_/Path_to_Psapi_lib/" 
```

本质上，如果您不提供实际的库名称，它会添加搜索依赖库的路径。语法差异很小，但这对于仅提供查找依赖库的 PATH 非常有用。有时提供每个路径单独的库只是一种痛苦，你知道它们都在某个文件夹中，Qt Creator 会选择它们。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-12-14T13:55:55.387

在 .pro 中：`LIBS += Ole32.lib OleAut32.lib Psapi.lib advapi32.lib`

在 .h/.cpp 中：`#pragma comment(lib,"user32.lib")`

```
#pragma comment(lib,"psapi.lib") 
```

# c++ - 在这种情况下我应该使用算法还是手动编码？

> ID：718451
> 
> 赞同：4
> 
> 时间：2009-04-05T06:15:50.733
> 
> 标签：c++, algorithm, stl, transform

好的，有人告诉我哪个会更好。我需要 |= 一个向量的元素与另一个向量。也就是说，我想

```
void orTogether(vector<char>& v1, const vector<char>& v2)
{
    typedef vector<char>::iterator iter;
    for (iter i = v1.begin(), iter j = v2.begin() ; i != v1.end(); ++i, ++j)
        *i |= *j;
} 
```

由于需要处理 2 个集合，我无法使用 for_each。我想我可以做类似的事情

```
struct BitWiseOr
{
    char operator()(const char& a, const char& b) {return a | b;}
};

void orTogether2(vector<char>& v1, const vector<char>& v2)
{
    transform(v1.begin(), v1.end(), v2.begin(), 
        v1.begin(), BitwiseOr());
} 
```

这是一个更有效的解决方案，即使顶部已经到位，但底部是分配？这正好在处理循环的中间，我需要尽可能快的代码。

编辑：为 BitwiseOr 添加（很明显？）代码。另外，我收到了很多关于不相关的评论，比如检查 v2 的长度和更改名称。这只是一个例子，真正的代码更复杂。

**好吧，我介绍了两者。orTogether2 比 orTogether 快得多，所以我将使用 transform 方法。**我很惊讶，orTogether2 在 MSVC9 发布模式下快了大约 4 倍。我运行了两次，第二次更改了顺序以确保它不是某种缓存问题，而是相同的结果。感谢大家的帮助。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-05T06:32:47.743

底部的将编译为与第一个有效的相同，您的 OR 函子肯定会被内联。因此，如果您需要添加更多灵活性或调试框架或其他任何东西，则第二个习惯用法会更加灵活。

由于第一个没有好处，请使用 transform 方法。一旦你养成了这种习惯，你甚至会停止考虑所有应用程序的显式循环选择，因为它是不必要的。第一种方法的**唯一**优点是更容易向对原始 C 更熟悉的初学者 C++ 程序员解释。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-05T06:34:46.740

拿起你的手表并测量

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-05T06:32:19.930

在我们了解如何`MyBitwiseOrObject`实施之前，确实没有太多选择。你为什么不做一些测试？

这里的问题`transform`是您需要有一个单独的仿函数并在命名空间范围内定义它（远离它的使用位置）。Lambda 解决了这个问题——你可能想看看 Boost Lambda Library。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-06T02:26:52.663

STL 提供的算法可以假设为

1.  正确的
2.  实施相当快
3.  有执行复杂性保证（如果标准规定）

因此，使用它们不会出错。事实上，STL 实现者可能能够专门针对某些问题使用基于模板规范的更快实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-05T16:30:27.307

你在预优化吗？你知道一个比另一个快吗？我怀疑它们非常接近相同。

也就是说，我会使用转换。让经过良好测试的库完成繁重的工作。保持你的代码简洁干净。您可能不知道 for-each 中到底发生了什么，但您可以相信库设计者做得很好。

# ruby - 有没有办法在 Ruby 中获取所有变量？

> ID：718454
> 
> 赞同：8
> 
> 时间：2009-04-05T06:16:49.310
> 
> 标签：ruby, variables

有没有办法在 Ruby 中找到所有以特定字符串开头的变量？例如，我的 ruby​​ 程序中有以下变量：

```
ret_d = 1
ret_d2 = 23 
```

有没有会返回的函数`["ret_d","ret_d2"]`？问题是我没有所有变量的集合。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-05T06:22:24.070

`Kernel#local_variables`应该做的伎俩。

```
>> ret_d = 1
=> 1
>> ret_d2 = 23
=> 23
>> local_variables
=> ["_", "ret_d", "ret_d2"]
>> local_variables.select{|v|v=~/^ret_/}
=> ["ret_d", "ret_d2"] 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-05T06:19:32.440

如果它们是局部变量，您可以使用`local_variables`. 不过，这听上去像是穷人的阵法。您可以考虑使用实际的数组。

# asp.net-mvc - 对我的控制器方法进行单元测试会导致 ViewName 为空？

> ID：718464
> 
> 赞同：27
> 
> 时间：2009-04-05T06:28:06.553
> 
> 标签：asp.net-mvc, unit-testing, controller

我正在对我的标准进行一些简单的 MS 单元测试，没有什么特别的控制器。

当我`ViewName`从返回的`ViewResult`对象中检查属性时，它是`""`（空的）。

我的印象`ViewName`是`View`（正如这篇 关于 ASP.NET MVC 控制器测试[的 MS 文章所建议的那样）。](http://www.asp.net/Learn/mvc/tutorial-07-cs.aspx)

顺便说一句，当我测试 ViewData 时，一切都在那里并且正确。

这是我的代码...

```
public ActionResult Index(int? page, string tag)
{
    if (page == null || page <= 0)
    {
        page = 1;
    }

    var viewData = new IndexViewData
                       {
                       ... my property setters, etc ...
                       };
    return View(viewData);
}

[TestMethod]
public void Index_Action_Should_Return_Index_View_For_Default_HomePage()
{
    // Arrange.
    var controller = PostController; // Wrapper, cause I use D.I.

    // Act.
    ViewResult viewResult = controller.Index(null, null) as ViewResult;

    // Assert.
    Assert.IsNotNull(viewResult);
    Assert.AreEqual("Index", viewResult.ViewName); // This is false/fails.

    var indexViewData = viewResult.ViewData.Model as IndexViewData;
    Assert.IsNotNull(indexViewData); // This is true.
} 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-04-05T14:07:06.387

ViewName 仅在您在 ViewResult 中设置时出现。如果您的视图名称与您的控制器名称匹配，那么我会检查以确保 ViewName 为空或空，因为这将是（IMO）正确的行为，因为您不想在视图上设置名称。我只在我打算返回的视图与操作不匹配时检查是否设置了 ViewName——例如，当返回“错误”视图时。

**编辑**：以下是 ViewResultBase.cs 中 ExecuteResult 的源代码（来自 RC1，我的 Macintosh 上没有 RTW 的源代码）。如您所见，它会检查 ViewName 是否已直接设置，如果没有，它会从控制器上下文的路由数据中的操作中提取它。这只发生在 ExecuteResult 中，它在控制器的操作完成后调用。

```
 public override void ExecuteResult(ControllerContext context) {
        if (context == null) {
            throw new ArgumentNullException("context");
        }
        if (String.IsNullOrEmpty(ViewName)) {
            ViewName = context.RouteData.GetRequiredString("action");
        }

        ViewEngineResult result = null;

        if (View == null) {
            result = FindView(context);
            View = result.View;
        }

        ViewContext viewContext = new ViewContext(context, View, ViewData, TempData);
        View.Render(viewContext, context.HttpContext.Response.Output);

        if (result != null) {
            result.ViewEngine.ReleaseView(context, View);
        }
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-12-06T23:15:52.157

我个人觉得 MVC2 提供的测试工具有些笨拙。我猜想已经存在更好的东西了，但我最终创建了一个简单的类来测试动作。我在一个由优秀的开源[Java MVC 框架 Stripes](http://www.stripesframework.org/display/stripes/Home)提供的类（称为`MockRoundTrip`.

这是在测试动作时用于获取动作目标页面的方法，称为`getTripDestination()`. 无论视图名称是否明确设置，它都会返回正确的结果

```
 //Get the destination page of the request, using Runtime execution pattern of MVC, namely
    //if no ViewName is explicitly set in controller, ViewResult will have an empty ViewName
    //Instead, current action name will be used in its place
    public string getTripDestination()
    {
       RouteData routeData = getRouteData();
       ViewResult viewResult = (result is ViewResult) ? (ViewResult)result : null;
       string tripDestination = (viewResult != null) ? viewResult.ViewName : "";

       return (tripDestination != "") ? tripDestination : (String)routeData.Values["action"];
    }

    private RouteData getRouteData()
    {
       HttpContextBase context = controller.ControllerContext.RequestContext.HttpContext;
       return RouteTable.Routes.GetRouteData(context);
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T22:33:41.323

viewname 由框架自动设置。但是当我们进行单元测试时，我们将框架短路，并且没有任何东西可以设置名称。

因此，我们的操作需要在单元测试时显式设置视图名称。如果我们真的非常想依赖约定，我们也可以检查 null 或 empty。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-15T09:59:14.327

[Controller.View()](https://msdn.microsoft.com/en-us/library/system.web.mvc.controller.view%28v=vs.118%29.aspx#M:System.Web.Mvc.Controller.View)的文档指出：

> View 类的此方法重载**返回具有空 ViewName 属性的 ViewResult 对象**。如果您正在为控制器操作编写单元测试，请考虑不采用字符串视图名称的单元测试的空 ViewName 属性。
> 
> 在运行时，如果 ViewName 属性为空，则使用当前操作名称代替 ViewName 属性。

因此，当期望一个与当前操作同名的视图时，我们可以测试它是一个空字符串。

或者，Controller.View(String) 方法将设置 ViewName。

# .net - What are Delay Signed Assemblies?

> ID：718475
> 
> 赞同：12
> 
> 时间：2009-04-05T06:36:57.127
> 
> 标签：.net, signing

Probably a simple question.. but I don't know what it is...

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-05T07:22:48.700

I found the answer [here](http://www.c-sharpcorner.com/UploadFile/vandita/delaysignassemblies08022006120501PM/delaysignassemblies.aspx).

> Delay signing is a process of generating partial signature during development with access only to the public key. The private key can be stored securely and used to apply the final strong name signature just before shipping the project.

I'll leave this question opened so if anybody has this question again, there will be no need to be crushed here and also for those who believes I did this to get rep score, you may down vote as much as you want, as I stated before, I don't care about this.

Thanks, Paulo

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-05T06:39:36.807

Delayed signing refers to a technique of partially signing assemblies while they are in development. Signing an assembly basically certifies that assembly by the manufacturer and prevents tampering and hi-jacking of that assembly. The signing is accomplished by using public key/private key encoding of parts ...

Stolen from [here](http://209.85.173.132/search?q=cache:-H5VpMnTkJ8J:searchwindevelopment.techtarget.com/expert/KnowledgebaseAnswer/0,289625,sid8_gci996687,00.html+computer+dictionary+delay+sign&cd=1&hl=en&ct=clnk&gl=us).

As I think your question was?

# c++ - 字符串文字

> ID：718477
> 
> 赞同：11
> 
> 时间：2009-04-05T06:40:36.633
> 
> 标签：c++

我对 C++ 中的字符串文字几乎没有疑问。

```
char *strPtr ="Hello" ;
char strArray[] ="Hello"; 
```

现在 strPtr 和 strArray 被认为是字符串文字。

根据我的理解，字符串文字存储在只读内存中，因此我们无法修改它们的值。

我们做不到

```
strPtr[2] ='a';
and strArray[2]='a'; 
```

以上两种说法都应该是非法的。编译器在这两种情况下都应该抛出错误。

编译器将字符串文字保存在只读内存中，因此如果我们尝试修改它们，编译器会抛出错误。

const 数据也被认为是只读的。

是否以相同的方式处理字符串文字和 const 数据？我可以使用字符串文字中的 const_cast 删除恒定性可以更改其值吗？

字符串文字究竟存储在哪里？（在程序的数据部分）

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-05T06:46:22.860

> 现在 strPtr 和 strArray 被认为是字符串文字。

不，他们不是。字符串文字是您在代码中看到的内容。例如，`"Hello"`. `strPtr`是*指向*文字的指针（现在在可执行文件中编译）。请注意，它应该是`const char *`；您不能合法地删除`const`每个 C 标准并在使用它时期望定义的行为。 `strArray`是一个包含文字副本的数组（在可执行文件中编译）。

> 以上两种说法都应该是非法的。编译器在这两种情况下都应该抛出错误。

不，不应该。这两种说法是完全合法的。由于情况，第一个未定义。但是，如果它们是指向`const char`s 的指针，那将是一个错误。

据我所知，字符串文字的定义方式可能与其他文字和常量相同。但是，有一些区别：

```
// These copy from ROM to RAM at run-time:
char myString[] = "hello";
const int myInt = 42;
float myFloats[] = { 3.1, 4.1, 5.9 };

// These copy a pointer to some data in ROM at run-time:
const char *myString2 = "hello";
const float *myFloats2 = { 3.1, 4.1, 5.9 };

char *myString3 = "hello";  // Legal, but...
myString3[0] = 'j';         // Undefined behavior!  (Most likely segfaults.) 
```

我这里对 ROM 和 RAM 的使用是一般性的。如果平台只有 RAM（例如大多数 Nintendo DS 程序），则 const 数据*可能*在 RAM 中。但是，写入仍然未定义。const 数据的位置对于普通的 C++ 程序员来说应该无关紧要。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-05T06:50:14.067

```
char *strPtr ="Hello" ; 
```

定义`strPtr`一个指向 char 的指针，该指针指向一个字符串字面`"Hello"`量——这个指针的有效类型是`const char *`. 不允许`strPtr`对指针进行修改（如果您尝试这样做，则调用 UB）。这是旧 C 代码的向后兼容功能。此约定在 C++0x 中已弃用。见附件 C：

> **更改：将字符串文字设为 const** 字符串文字的类型从“char 数组”更改为“const char 数组”。[...]
> 
> **基本原理：**这避免了调用不适当的重载函数，该函数可能期望能够修改其参数。
> 
> **对原始特征的影响：**改变定义明确的特征的语义。转换难度：简单的句法转换，因为字符串字面量可以转换为char*；(4.2)。最常见的情况由新的但已弃用的标准转换处理：
> 
> `char* p = "abc"; // valid in C, deprecated in C++`
> 
> `char* q = expr ? "abc" : "de"; // valid in C, invalid in C++`
> 
> **使用范围如何：**有正当理由将字符串文字视为指向潜在可修改内存的指针的程序可能很少见。

```
char strArray[] ="Hello"; 
```

声明的类型`strPtr`是 -- 它是一个未指定大小的字符数组，其中包含包含`Hello`空终止符的字符串，即 6 个字符。然而，初始化使它成为一个完整的类型，它的类型是 6 个字符的数组。通过修改`strPtr`是可以的。

> 字符串文字究竟存储在哪里？

实现定义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-05T09:35:16.743

较旧的 C 和 C++ 编译器纯粹基于低级编码，无法提供更高标准的数据保护，甚至无法强制执行，通常在 C 和 C++ 中，您可以编写任何您想要的东西。

如果您知道如何使用地址，您甚至可以编写代码来访问和修改您的 const 指针。

虽然 C++ 确实强制了一些编译级别的保护，但是在运行时没有保护。您当然可以访问自己的堆栈，并使用它的值来操作 const 指针中的任何数据。

这就是 C# 被发明的原因，因为无论您访问的是引用，它都是一个固定结构，管理所有数据保护规则，并且它具有无法访问和修改的隐藏指针。

主要区别在于，C++ 只能为您提供编译时保护，但 C# 甚至可以在运行时为您提供保护。

# c# - 使用 TCP 套接字在本地代理视频

> ID：718478
> 
> 赞同：3
> 
> 时间：2009-04-05T06:42:33.197
> 
> 标签：c#, .net, proxy

我一直对向媒体浏览器添加对视频播客的支持非常感兴趣。

我希望用户能够浏览可用的视频播客并从互联网上流式传输它们。这真的很容易，因为媒体播放器等会很乐意播放云中的文件。

问题是我想在本地缓存这些文件，因此同一集的后续观看将不涉及流媒体，而是播放本地文件。

所以...我在想，为什么不托管一个`HttpListener`，并且当媒体播放器要求它提供文件的位时，`HttpListener`下载并存储在本地。下次用户播放文件时，我们将在本地拥有文件的某些部分。

有谁知道`HttpListener`用于代理的示例代码？

**编辑**

这个想法只是代理简单的流媒体内容，如 MP3 或 Mov。赏金将用于实际实施。

这是我想要的 API：

```
// will proxy a uri on the local port, if cacheFile exists it will resume the 
// download from cacheFile.
// while the file is downloading it will be name cacheFile.partial, after the 
// download is complete the file will be renamed to cacheFile.
// Example usage: ProxyFile("http://media.railscasts.com/videos/176_searchlogic.mov", 8000, @"c:\downloads\railscasts\176_searchlogic.mov")
//
// Directly after this call http://localhost:8000 will be the proxy stream, it will be playable locally. 
void ProxyUri(Uri uri, int port, string cacheFile) 
```

**编辑 2**

`HttpListener`看起来很没有希望我可能需要在 TCP 套接字级别完成工作，因为`HttpListener`s 似乎需要程序以管理员身份运行，这将非常棘手。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-28T08:44:31.947

我以前没有做过任何事情`HttpListener`，所以我认为这将是一个很好的小练习，可以让自己跟上它的速度——事实证明。我将它实现为单个`ProxyListener`类，其构造函数采用`ProxyUri`您指定的函数的参数。一旦你获得了一个实例，你通过调用它的`Start`方法开始它的监听（并且可能下载）。完成后，调用`Cleanup`.

有一个或两个粗糙的边缘，但基本上它可以根据您的问题工作。为了对其进行测试，我将其构建为一个控制台应用程序，该应用程序具有一个`Program`类，该类接受由（uri、端口、文件名）组成的输入行，以空格分隔，创建`ProxyListener`实例并启动它们。您可以运行此控制台应用程序，输入合适的行，然后下载程序将启动（将进度打印到控制台）。同时，您可以启动 IE 并从指定端口获取文件，您将能够在下载器仍在工作时下载它。“上传者”进度也将打印到控制台。

我在这里粘贴它时遇到了一些麻烦，可能是由于大小（它不是那么大，但比您通常在这里看到的片段大 -`ProxyListener`课程不到 200 行）。听起来很有趣吗？如果是这样，我会将其发布到 pastebin 并使用链接更新此答案。

**更新：**作为[要点](https://gist.github.com/2f4df2dafc3ecfb0f450)发布。

请注意，您需要管理员权限才能运行该程序，因为`HttpListener`需要此权限。

**更新 2：**在某些情况下，运行`HttpListener`. 请参阅[此链接](http://msdn.microsoft.com/en-us/library/aa364673%28VS.85%29.aspx)和[此](http://urlreservation.codeplex.com/)链接。这个想法是，如果您可以在安装期间保留一个 URL 命名空间，那么如果监听该命名空间，用户就不必具有管理员权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T09:24:32.747

流不是为了保存而设计的，而且这些协议是非常定制的并且实现起来非常复杂，流会话会进行大量的验证和同步，这将是非常难以模仿的。当然，这不是一项不可能完成的任务，而是一项相当大的任务。只有其他方法是读取并将其保存为本地媒体文件，并将其用作参考。因为您可以使用 windows 媒体编码器来读取流和将流数据写入本地文件，但它仍然可能不允许您进行复制保护数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-24T07:45:03.043

您是否考虑过使用具有缓存功能的 HTTP 代理？

像：

*   `mod_proxy`Apache [httpd](http://httpd.apache.org/)和`mod_cache`
*   [乌贼](http://www.squid-cache.org/)

另请参阅[Web Cache](http://en.wikipedia.org/wiki/Web_cache) @ wikipedia

如果您希望您的应用程序具有这样的 Web 缓存组件，我建议您在 .Net 中查找 Web 缓存实现，而不是从头开始编写代码。

# latex - 在 LaTeX 中为网站生成波浪号的最佳方法是什么？

> ID：718479
> 
> 赞同：14
> 
> 时间：2009-04-05T06:43:54.847
> 
> 标签：latex, tilde

继[之前](https://stackoverflow.com/questions/682201/latex-tildes-and-verbatim-mode)关于该主题的问题之后，当您在 LaTeX 中生成网站时，生成包含波浪号的 url 的最佳方法是什么？`\verb`产生读不好的上波浪号，也不能很好地`$\sim$`复制/粘贴（当我这样做时添加一个空格）。解决方案？

看起来这应该是很容易解决的事情之一……如果没有，为什么不呢？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-05T06:50:02.600

我会看看[`url`包裹](http://www.ctan.org/tex-archive/help/Catalogue/entries/url.html)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-10-10T13:52:01.530

我知道这是一个老问题，但我最近想出了一些东西，尽管严重缺乏优雅，但效果很好。

```
\catcode`~=11 % make LaTeX treat tilde (~) like a normal character
\newcommand{\urltilde}{\kern -.15em\lower .7ex\hbox{~}\kern .04em}
\catcode`~=13 % revert back to treating tilde (~) as an active character 
```

现在您可以在 \url 标记内使用 \urltilde（即使在 .bib 文件中），并且：1) URL 将完美呈现；2) 点击 URL 将带您到正确的地址；并且，3）复制粘贴会将正确的地址放入剪贴板。

这是我发现满足所有这三个要求的唯一解决方案。我希望它可以帮助那里的人。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-02-14T08:22:04.960

url 包对我不起作用。hyperref 完成这项工作。

```
\usepackage{hyperref}
\url{http://website.com/~username/some_stuff/} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-02-16T17:51:35.690

我认为在这种情况下最好使用 URL 编码（例如，[参见 http://www.blooberry.com/indexdot/html/topics/urlencoding.htm](http://www.blooberry.com/indexdot/html/topics/urlencoding.htm)）。

这意味着用 %7E 替换链接中的波浪号。

也许它在最终文档中看起来不太好（读者会看到 %7E 而不是波浪号），但至少复制粘贴功能确实有效，我认为这是最重要的。

例如，对于链接 www.example.com/~someuser/somepage.htm，我使用以下代码：

```
{\tt http://www.example.com/\%7Esomeuser/somepage.htm} 
```

PS：这同样适用于所有带有空格或任何其他特殊字符的链接。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-06-14T02:54:44.463

我认为 $_{\widetilde{~}}$ 可以很好地解决波浪号问题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-12-18T04:48:57.933

我想建议使用`%7e`

```
\tt{http://example.com/\%7etest} 
```

tt 用于使其成为等空间。

它看起来有点不同，但它允许复制和粘贴。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-05T07:08:45.940

`\symbol{126}`将是另一种方式，但在默认字体中，它也会产生一个上标波浪号。一个丑陋的黑客（但不是在 LaTeX 中）将是使用

```
${}_{\textrm{\symbol{126}}}$ 
```

这会在数学模式下生成一个文本波浪号并为其添加下标。所以它出现在行的中间。似乎也适用于可点击的链接。您始终可以将其单独放入命令中:)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-05T07:42:38.933

诚然，我不是乳胶用户，但这个页面有帮助吗？

[http://www.cse.wustl.edu/~mgeorg/html/tildalatex.html](http://www.cse.wustl.edu/~mgeorg/html/tildalatex.html)

他们执行以下操作：

```
\def\urltilda{\kern -.15em\lower .7ex\hbox{\~{}}\kern .04em}
\def\urldot{\kern -.10em.\kern -.10em}
\def\urlhttp{http\kern -.10em\lower -.1ex\hbox{:}\kern -.12em\lower 0ex\hbox{/}\kern -.18em\lower 0ex\hbox{/}} 
```

这个使用方式是

```
{\tt mgeorg@cse\urldot wustl\urldot edu}
{\tt \urlhttp www\urldot cse\urldot wustl\urldot edu/\urltilda mgeorg} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-06-05T00:11:15.910

在与 LaTeXing 波浪号相关的问题上浪费了很多时间之后，我想我应该在这里记录我的结果，以防它对其他人有帮助。

tldr：为了避免排版正确的波浪号 ~ 字符的一些困难，我建议添加

```
 \usepackage[T1]{fontenc} 
```

在您的乳胶文件的序言中以获得更现代的字体编码版本。在现代 TeX 安装中，这会自动加载 Knuth 的 Computer Modern 字体的 T1 编码版本。

* * *

细节：

正如之前的海报所指出的那样，使用标准的 pdflatex/latex 和默认字体（原始的 OT1 编码的 Computer Modern），尝试渲染常规的波浪号字符存在困难，~，并且有各种不同程度的变通方法满意。一种解决方法是使用 textasciitilde 命令。例如，您可以使用它在 URL 中添加波浪号，例如：

```
 https://w3.pppl.gov/\textasciitilde{}hammett 
```

这给出了一个凸起的波浪号（用于在另一个字符上重音的波浪号），其他海报讨论了将其降低到更正常的波浪号的方法。如果在 Adob​​e Acrobat 中查看生成的 PDF 文件，这将按预期工作，但缺点是，如果使用 Mac 上的内置 Preview 应用程序查看 PDF（或者如果在 TeXShop 的预览器中查看，它使用相同的 Mac 库）渲染），那么这个 URL 链接在视觉上看起来是正确的[https://w3.pppl.gov/~hammett](https://w3.pppl.gov/%7Ehammett)，但如果你真的点击它，它只会被解释为

```
 https://w3.pppl.gov/ 
```

如果您尝试将预览中的整个 URL 剪切并粘贴到浏览器中，则 pdf 中的波浪号将替换为空白

```
 https://w3.pppl.gov/%20hammett 
```

所以它不起作用。（如果您粘贴到某些浏览器中，还会添加其他特殊字符）。（\url{...} 命令将正确显示带有波浪号的 URL，但会强制它使用固定间距的终端字体，并且有时您想在 URL 之外的某个地方使用波浪号。）

进一步调查，我了解到 Latex 放入 pdf 文件的字符不是常规的波浪号字符，而是“组合波浪号”

```
 COMBINING TILDE Unicode: U+0303, UTF-8: CC 83 
```

（以前称为“非间距波浪号”，表示它用于另一个字符的重音），这就是 Mac 的预览呈现的内容。这意味着从 Mac 的 Preview 剪切并粘贴到浏览器中会失败。

但是，Adobe Acrobat 以某种方式实现了一种解决方法，并且在显示 pdf 时将其转换为常规的“波浪号”

```
 TILDE Unicode: U+007E, UTF-8: 7E 
```

因此，将带有波浪号的 URL 从 Adob​​e 显示的 pdf 文件剪切并粘贴到 Web 浏览器中可以正常工作。

（我通过从 TeXShop 预览窗口复制渲染的波浪字符并将其粘贴到 Mac 菜单栏中的字符查看器应用程序中来确定这些 un​​icode 值。然后右键单击该字符以选择“复制字符信息”。字符查看器应用程序可以在 Mac 偏好设置、键盘中打开，然后选择“在菜单栏中显示键盘和表情符号查看器”。）

如果您通过添加使用 T1 编码的字体，这个问题就会消失

\usepackage[T1]{fontenc}

到你的乳胶文件序言。此外，如果您使用类似 Adob​​e Times 的字体

\usepackage{newtxtext}

然后波浪线会自动呈现在中间高度，不需要降低。（上面的命令只对常规文本使用 newtx 字体，而保持数学字体不变。我喜欢 newtxtext 因为它比 CM 稍微暗一些。但是对于数学我更喜欢保留 Knuth 的传统 Computer Modern CM 字体，因为 newtxmath 字体，像其他 Times 数学字体一样，以类似于希腊语 nu 的方式呈现数学斜体 v。）

PS：有关为什么使用 fontenc 包比 1970 年的原始编码更现代的方法总是好的更多信息，请参阅 (1) [https://www.texfaq.org/FAQ-why-inp-font](https://www.texfaq.org/FAQ-why-inp-font)，(2 ) [https://tex.stackexchange.com/questions/664/why-should-i-use-usepackaget1fontenc](https://tex.stackexchange.com/questions/664/why-should-i-use-usepackaget1fontenc)和 (3) [https://en.wikibooks.org/wiki/LaTeX/Fonts](https://en.wikibooks.org/wiki/LaTeX/Fonts)。

# asp.net-mvc - Timing an ASP.NET MVC Action

> ID：718486
> 
> 赞同：1
> 
> 时间：2009-04-05T07:00:16.103
> 
> 标签：asp.net-mvc

I want to try to time an ASP.NET MVC ActionMethod.

I was thinking a nice way to do this would be using a custom header.

Can I use an ActionFilterAttribute to do this? Has anyone done this, or is there any build in ASP.NET functionality to do this?

I'm just being kicked out of Starbucks and hoping someone will have an answer before I get home. Usually someone does :-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-05T12:43:31.580

你可以试试[Eqatec profiler](http://www.eqatec.com/tools/profiler)。免费 ：）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-05T13:03:43.747

我同意 asp.net 跟踪最适合这项工作。但是使用 ActionFilter 应该很有趣。

此代码未经测试。

```
public class TimingAttribute : ActionFilterAttribute
{
    Stopwatch stopwatch;

    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        stopwatch = new Stopwatch();
        stopwatch.Start();
        base.OnActionExecuting(filterContext);
    }

    public override void OnResultExecuted(ResultExecutedContext filterContext)
    {
        try
        {
            base.OnResultExecuted(filterContext);
        }
        finally
        {
            stopwatch.Stop();
            var ms = stopwatch.ElapsedMilliseconds;
            // your logging here. controller/action/request info could be extracted from filterContext
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T11:56:45.813

我同意 Cherian 的观点，即追踪将是最佳选择，因为它应该是最准确的。

我想如果我能猜出你对属性选项的想法是什么，我不得不假设你会使用反射来在方法执行时动态地启动和停止计时器。我想这会很酷……但它可能会增加开销，给出错误的读数。

# reporting-services - How to put a table in the report header?

> ID：718487
> 
> 赞同：0
> 
> 时间：2009-04-05T07:00:32.263
> 
> 标签：reporting-services, reportingservices-2005, ssrs-2008

I'm trying to generate a report that has a solid legend table on top.

I've tried to put it in the header section, so it wouldn't scroll down with the page but I can't put any table inside the header

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T07:28:56.470

评论：根据 Ed Harper，但也许使用矩形来包含文本框？

-- “评论需要 50 声望” 好的，我会用答案而不是评论来阻塞线程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T07:29:13.043

最接近的方法是将一系列文本框放在标题中，然后手动将它们排列到“表格”中。

假设您的图例不是数据驱动的，这应该不会太难 - 特别是如果您在布置字段时使用“格式”>“水平/垂直间距”>“删除”工具。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T14:56:32.813

如果您确实需要您的图例是数据驱动的，最好将您的图例放在主体中而不使用报告标题。

它仍然可以配置为在每个页面上显示等。

我发现这是数据驱动标题信息的最佳方法。

# c++ - strcpy 中的分段错误

> ID：718490
> 
> 赞同：6
> 
> 时间：2009-04-05T07:02:16.270
> 
> 标签：c++, c, undefined-behavior

考虑下面的程序

```
 char str[5];
    strcpy(str,"Hello12345678");
    printf("%s",str); 
```

运行此程序时会出现分段错误。

但是当 strcpy 替换为以下时，程序运行良好。

```
strcpy(str,"Hello1234567"); 
```

所以问题是当尝试复制到 str 任何其他长度超过 5 个字符的字符串时它应该崩溃。

那么为什么它不会因为“Hello1234567”而崩溃，而只会因为“Hello12345678”而崩溃，即长度为 13 或超过 13 的字符串。

该程序在 32 位机器上运行。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-04-05T07:14:39.220

您应该对三种类型的标准行为感兴趣。

1/*定义的行为*。这将适用于所有符合要求的实现。自由地使用它。

2/*实现定义的行为*。如前所述，它取决于实现，但至少它仍然是定义的。实现需要记录他们在这些情况下所做的事情。如果您不关心可移植性，请使用它。

3/*未定义的行为*。任何事情都有可能发生。我们的意思是*任何事情*，包括你的整个计算机崩溃成一个赤裸裸的奇点并吞噬自己，你和你的大部分同事。永远不要使用这个。曾经！严重地！不要让我过来。

将超过 4 个字符和一个零字节复制到 a`char[5]`是未定义的行为。

说真的，你的程序为什么会因为 14 个字符而不是 13 个字符而崩溃并不重要，你几乎肯定会覆盖堆栈上的一些非崩溃信息，并且你的程序很可能会产生不正确的结果。事实上，崩溃更好，因为至少它可以阻止你依赖可能的不良影响。

将数组的大小增加到更合适的大小（`char[14]`在这种情况下使用可用信息）或使用其他一些可以处理的数据结构。

* * *

*更新：*

由于您似乎非常关心为什么额外的 7 个字符不会导致问题，但 8 个字符会导致问题，让我们设想一下输入时可能的堆栈布局`main()`。我说“可能”，因为实际布局取决于编译器使用的调用约定。由于 C 启动代码`main()`使用`argc`and调用，因此在为 a 分配空间后`argv`，位于 开头的堆栈可能如下所示：`main()``char[5]`

```
+------------------------------------+
| C start-up code return address (4) |
| argc (4)                           |
| argv (4)                           |
| x = char[5] (5)                    |
+------------------------------------+ 
```

当您使用以下内容写入字节`Hello1234567\0`时：

```
strcpy (x, "Hello1234567"); 
```

to `x`，它会覆盖`argc`and`argv`但是，在从 回来时`main()`，没关系。专门`Hello`填充`x`、`1234`填充`argv`和`567\0`填充`argc`。如果您实际上没有尝试*使用* `argc`和/或`argv`之后，您会没事的：

```
+------------------------------------+ Overwrites with:
| C start-up code return address (4) |
| argc (4)                           |   '567<NUL>'
| argv (4)                           |   '1234'
| x = char[5] (5)                    |   'Hello'
+------------------------------------+ 
```

但是，如果您将`Hello12345678\0`（注意额外的“8”）写入`x`，它会覆盖返回地址的`argc`and`argv` *和*1 个字节，因此，当`main()`尝试返回 C 启动代码时，它会进入仙境：

```
+------------------------------------+ Overwrites with:
| C start-up code return address (4) |   '<NUL>'
| argc (4)                           |   '5678'
| argv (4)                           |   '1234'
| x = char[5] (5)                    |   'Hello'
+------------------------------------+ 
```

同样，这完全取决于编译器的调用约定。有可能不同的编译器总是将数组填充为 4 个字节的倍数，并且在您编写另外三个字符之前，代码不会在那里失败。即使是同一个编译器也可能在堆栈帧上分配不同的变量，以确保满足对齐要求。

这就是他们所说的未定义的意思：你不*知道*会发生什么。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-05T07:04:43.797

您正在复制到堆栈，因此它取决于编译器在堆栈上放置的内容，以及需要多少额外数据才能使您的程序崩溃。

一些编译器可能生成的代码会在缓冲区大小上只有一个字节时崩溃——它的行为是未定义的。

我猜大小 13 足以覆盖返回地址或类似的东西，当你的函数返回时它会崩溃。但是另一个编译器或另一个平台可能/将会以不同的长度崩溃。

此外，如果您的程序运行较长时间，如果不那么重要的内容被覆盖，您的程序可能会以不同的长度崩溃。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-05T08:00:31.277

对于 32 位 Intel 平台，解释如下。当您在堆栈上声明 char[5] 时，由于对齐，编译器实际上分配了 8 个字节。然后，函数通常具有以下序言：

```
push ebp
mov ebp, esp 
```

这会将 ebp 注册表值保存在堆栈上，然后将 esp 寄存器值移动到 ebp 以使用 esp 值访问参数。这导致堆栈上的 4 个字节被 ebp 值占用。

在结语中，ebp 被恢复，但它的值通常仅用于访问堆栈分配的函数参数，因此在大多数情况下覆盖它可能不会造成伤害。

所以你有以下布局（堆栈在 Intel 上向下增长）：8 字节用于数组，然后 4 字节用于 ebp，然后通常是返回地址。

这就是为什么您需要覆盖至少 13 个字节才能使程序崩溃的原因。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-05T07:24:55.310

[添加到上述答案：您可以使用Valgrind](http://valgrind.org/)等工具测试此类错误。如果您使用的是 Windows，请查看[此 SO thread](https://stackoverflow.com/questions/413477/is-there-a-good-valgrind-substitute-for-windows)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-05T07:05:36.543

这取决于“str”数组之后的堆栈上的内容。在复制那么多字符之前，您只是碰巧不会践踏任何关键的东西。

所以这将取决于函数中的其他内容、您使用的编译器以及可能的编译器选项。

13 是 5 + 8，说明 str 数组后面有两个非关键字，然后是关键字（可能是返回地址）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-05T07:05:56.103

这就是未定义行为 (UB) 的纯粹之美：它是未定义的。

你的代码：

```
char str[5];
strcpy(str,"Hello12345678"); 
```

写入 14 个字节/字符，`str`其中只能容纳 5 个字节/字符。这会调用 UB。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-05T07:42:18.327

问：那么为什么它不会因为“Hello1234567”而崩溃，而只会因为“Hello12345678”而崩溃，即长度为 13 或大于 13 的字符串。

*   因为行为是未定义的。使用 strncpy。有关更多信息，请参阅此页面[http://en.wikipedia.org/wiki/Strcpy](http://en.wikipedia.org/wiki/Strcpy)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-06T07:29:36.757

> 因为行为是未定义的。使用 strncpy。有关更多信息，请参阅此页面 [http://en.wikipedia.org/wiki/Strcpy](http://en.wikipedia.org/wiki/Strcpy) 。

strncpy 是不安全的，因为如果源字符串的长度 >= n，它不会添加 NULL 终止，其中 n 是目标字符串的大小。

```
char s[5];
strncpy(s,5,"test12345");
printf("%s",s); // crash 
```

我们总是使用 strlcpy 来缓解这种情况。

# php - 在不破坏动画的情况下调整动画 GIF 文件的大小

> ID：718491
> 
> 赞同：47
> 
> 时间：2009-04-05T07:02:39.217
> 
> 标签：php, image, imagemagick, animated-gif

我需要在不破坏动画的情况下调整动画 GIF 文件的大小。

我怎样才能使用 PHP 做到这一点？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-04-05T07:09:13.897

如果你有 imagemagick 访问权限，你可以这样做：

```
system("convert big.gif -coalesce coalesce.gif");
system("convert -size 200x100 coalesce.gif -resize 200x10 small.gif"); 
```

如果您没有 system() 访问权限，这很可能使用 imagemagick 插件

注意：这可能会通过较小尺寸的图像创建较大的文件大小，因为合并本质上会取消优化图像。

**更新：** 如果您没有 ImageMagick 访问权限，您应该能够使用以下步骤的组合来调整动画 gif 的大小（假设您有 GD 访问权限）：

1.  检测图像是否为动画 gif：[我可以使用 php 和 gd 检测动画 gif 吗？](https://stackoverflow.com/questions/280658/can-i-detect-animated-gifs-using-php-and-gd)（最佳答案）
2.  将动画 gif 拆分为单独的帧：[http ://www.phpclasses.org/package/3234-PHP-Split-GIF-animations-into-multiple-images.html](http://www.phpclasses.org/package/3234-PHP-Split-GIF-animations-into-multiple-images.html)
3.  调整各个帧的大小：[http ://www.akemapa.com/2008/07/10/php-gd-resize-transparent-image-png-gif/](http://www.akemapa.com/2008/07/10/php-gd-resize-transparent-image-png-gif/)
4.  再次将帧重新合成为动画 gif：[http ://www.phpclasses.org/package/3163-PHP-Generate-GIF-animations-from-a-set-of-GIF-images.html](http://www.phpclasses.org/package/3163-PHP-Generate-GIF-animations-from-a-set-of-GIF-images.html)

这绝对比 ImageMagick 路线密集得多，但在技术上应该是可行的。

如果你得到它的工作，请与世界分享！

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-08-28T09:26:36.923

试试~~GDEnhancer~~（使用[ImageCraft](https://github.com/coldume/imagecraft)）。它只需要GD库，它保留了gif动画

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-05T07:08:20.373

您需要将 gif 分解为帧、缩略图并重新组合。

看看[ImageMagick](https://secure.php.net/imagick)和[本教程](https://phpro.org/examples/Thumbnail-From-Animated-GIF.html)。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-03-13T17:55:55.823

我尝试了许多使用 Imagick PHP 模块调整动画 GIF 大小的示例，但没有一个对我有用。然后经过一段时间的调试，我终于发现了实际问题：动画在将图像保存到磁盘时丢失了，`$animation->writeImage($file_dst);`或者 `$animation->writeImages($file_dst, true);`

我已将其更改为 `file_put_contents($file_dst, $animation->getImagesBlob());` 大多数示例立即开始工作。

希望它可以帮助某人。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-02-22T06:20:41.023

[http://www.php.net/manual/en/imagick.coalesceimages.php](http://www.php.net/manual/en/imagick.coalesceimages.php)上的示例将调整您的 gif 大小，同时保留您的帧时间。大多数其他示例都没有这样做。

其他示例*重建*gif，而此示例允许您*修改*图像的帧。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-04-20T13:34:18.417

如果您安装了 ImageMagick，那么您可以使用一次调用`convert`：

```
system("convert big.gif -coalesce -repage 0x0 -resize 200x100 -layers Optimize small.gif"); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-03-22T13:52:07.777

我想我已经把这个放在包里了。

这个解决方案绝不是完美的，并且到处都包含一些蛮力，但我能够在我的基于 GD / PHP 的图像调整大小脚本中附加足够的功能来支持动画。

该解决方案很大程度上基于 László Zsidi 的优秀免费软件库 - [http://www.phpclasses.org/browse/author/283569.html](http://www.phpclasses.org/browse/author/283569.html)

您可以查看一个快速演示并从[http://forssto.com/gifexample/](http://forssto.com/gifexample/)下载源代码（直接链接： http: [//forssto.com/gifexample/gifanimresize.zip](http://forssto.com/gifexample/gifanimresize.zip)）

已知的问题：

*   透明度支持 - 这很容易附加到此解决方案中，但由于我没有立即需要它，所以我停在这里。

*   帧速率 - 由于某些未知原因，GifEncoder 类未能考虑指定的帧速率。我稍后需要调查一下。

*   我确实从我的一组测试中找到了一个 gif 文件，其中不知何故有不同大小的帧，并且动画无法正常工作。然后还有一些调试要做。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-07T10:35:00.297

只需创建 3 个文件夹名称 1.frame_output 2.images 3.resized_frame_output 并从以下链接下载 2 个编码器和解码器类 1.从[http://phpclasses.elib.com/browse/package下载类“GIFDecoder.class.php” /3234.html 2.从](http://phpclasses.elib.com/browse/package/3234.html)[http://phpclasses.betablue.net/browse/package/3163.html](http://phpclasses.betablue.net/browse/package/3163.html) 下载类“GIFEncoder.class.php”

然后运行脚本名称为“resize_animator.php”，创建一个上传html文件并享受脚本。

..将此脚本另存为.....index.php.......

```
<html>
<body>
<table width="500" border="0" align="center" cellpadding="0" cellspacing="1" bgcolor="#CCCCCC">
<tr>
<form action="resize_animator.php" method="post" enctype="multipart/form-data" >
<td>
<table width="100%" border="0" cellpadding="3" cellspacing="1" bgcolor="#FFFFFF">
<tr>
<td align="center"><font face="Tahoma">SELECT ANIMATED FILE</font> 
<input type="file" name="uploadfile" size="20" accept="image/gif"/>
</td>
</tr>
<tr>
<td align="center"><input type="submit" name="Submit" value="PROCESS ANIMATION" /></td>
</tr>
</table>
</td>
</form>
</tr>
</table>
</body>
</html> 
```

......................将此脚本保存为resize_animator.php............

```
 <?php

   require "GIFDecoder.class.php";
   include "GIFEncoder.class.php";
   $file_name= $_FILES['uploadfile']['name'];
   $file_ext = substr($file_name, -4);
   $file_size=($_FILES["uploadfile"]["size"] /1024 );
   if($file_ext=='.gif')
    {
 if($file_size > 0 && $file_size < 2000 )
  {
    session_start ( );
        $uploaded_file = $_FILES['uploadfile']['tmp_name'];
        $fp=file_get_contents($uploaded_file);

        if ( $fp )
            {
                $_SESSION['delays'] = Array ( );
                $gif = new GIFDecoder ( $fp );
                $arr = $gif->GIFGetFrames ( );
                $_SESSION [ 'delays' ] = $gif -> GIFGetDelays ( );

                for ( $i = 0; $i < count ( $arr ); $i++ )
                {
                        fwrite ( fopen ( ( $i < 10 ? "frame_output/$i$i_frame.gif" : "frame_output/$i_frame.gif" ), "wb" ), $arr [ $i ] );
                }
          }

        function resize_frames($newwidth,$newheight)
            {
                    $dir=opendir("frame_output/");
                    $i=0;
                    while($imgfile=readdir($dir))
                    {
                         if ($imgfile != "." && $imgfile!="..")
                             {
                                        $imgarray[$i]=$imgfile;
                                        $uploadedfile = "frame_output/".$imgarray[$i];
                                        $src = imagecreatefromgif($uploadedfile);
                                        list($width,$height)=getimagesize($uploadedfile);
                                        $tmp=imagecreatetruecolor($newwidth,$newheight);
                                        imagecopyresampled($tmp,$src,0,0,0,0,$newwidth,$newheight,$width,$height);
                                        $filename = "resized_frame_output/".$imgarray[$i];
                                        imagegif($tmp,$filename,100);
                                        imagedestroy($src);
                                        imagedestroy($tmp);
                                        $i++;
                            }
                    }
                    closedir($dir);

                if ( $dh = opendir ( "resized_frame_output/" ) )
                {
                    while ( false !== ( $dat = readdir ( $dh ) ) )
                    {
                        if ( $dat != "." && $dat != ".." )
                        {
                            $frames [ ] = "resized_frame_output/$dat";
                        }
                    }
                    closedir ( $dh );
                }

            $gif = new GIFEncoder   ( $frames,$_SESSION [ 'delays' ],0, 2, 0, 0, 0,"url" );
            $data = $gif->GetAnimation ( );

            $x='x';
            $y='_';
            $uploaded_file_name= $_FILES['uploadfile']['name'];
            $actual_file_name = substr($uploaded_file_name, 0, -4);
            $file_extention = substr($uploaded_file_name, -4);
            $new_name=$actual_file_name.$y.$newwidth.$x.$newheight.$file_extention ;

            //$output_image_name=$newwidth.$x.$newheight;
            fwrite ( fopen ( "images/$new_name", "wb" ), $data );
            //remove resized frames from folder
            //sleep for 1 second
            // usleep(2000000);
            $dir = 'resized_frame_output/';
            foreach(glob($dir.'*.*') as $v)
                {
                 unlink($v);
                }
        }  // end of function resize_frames

            $gif = new GIFEncoder   ( $frames,$_SESSION [ 'delays' ],0, 2, 0, 0, 0,"url" );
            $data = $gif->GetAnimation ( );

            $x='x';
            $y='_';
            $z='_p';
            $uploaded_file_name= $_FILES['uploadfile']['name'];
            $actual_file_name = substr($uploaded_file_name, 0, -4);
            $file_extention = substr($uploaded_file_name, -4);
            $new_name=$actual_file_name.$y.$newwidth.$x.$newheight.$z.$file_extention ;

            //$output_image_name=$newwidth.$x.$newheight;
            fwrite ( fopen ( "images/$new_name", "wb" ), $data );
            //remove resized frames from folder
            //sleep for 1 second
             //usleep(2000000);
            $dir = 'resized_frame_output/';
            foreach(glob($dir.'*.*') as $v)
                {
                 unlink($v);
                }
        }  // end of function resize_frames

            resize_frames(110,110);
            resize_frames(120,160);
            resize_frames(120,80);
            resize_frames(128,96);
            resize_frames(128,128);
            resize_frames(208,208);
            resize_frames(208,320);

            session_destroy();

            //usleep(200000);

            //remove resized frames from folder
            $dir = 'frame_output/';
            foreach(glob($dir.'*.*') as $v)
                {
                 unlink($v);
                }
      echo "<center><h1>Your Animation processing is compleated.</h1></center>";
      echo "<center><h2><a href=\"index.php\">BACK TO UPLOAD PAGE</h2></center>";
  }  //end of file size checker
else
 {
      echo "<center><h2>You Upload a unfit size image .Upload a file within 2000 KB</h2></center>";
      echo "<center><h2><a href=\"index.php\">BACK TO UPLOAD PAGE</h2></center>";
 }
   } //end of file extention checker
  else
  {
   echo "<center><h2>Uplaod a gif file!</h2></center>";
   echo "<center><h2><a href=\"index.php\">BACK TO UPLOAD PAGE</h2></center>";
  }
  ?> 
```

..........让我们享受............

取消注释 usleep 功能以查看这些文件夹中发生的工作。这不是必需的，但我使用它来查看功能。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-09-23T22:00:30.247

除了通过 ImageMagick 之外的所有答案都对我不起作用。在此之前的答案中的脚本都充满了错误。

即使安装 ImageMagick 也很难管理，所以这是我的经验。

以下是[如何](http://www.imagemagick.org/discourse-server/viewtopic.php?f=1&t=19439)在 Windows 7 和 xampp 1.7.4 上安装 ImageMagick。
*注意*：选择 64 位（对于 win7），安装时请勾选“添加到系统路径”选项。

然后按照： [http ://www.creativearmory.com/tutorials/resize-animated-gifs-with-php-and-imagemagick](http://www.creativearmory.com/tutorials/resize-animated-gifs-with-php-and-imagemagick)

在这篇文章中，我在脚本上浪费了几个小时，而 ImageMagick 和本教程在几分钟内就成功了。

还有一点需要注意：我的网络服务器默认有 ImageMagick，所以我猜大多数服务器也有它。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-03-11T18:53:08.350

如果您的服务器中没有 Imagemagick，您可能想试试这个：

[http://www.phpclasses.org/package/7353-PHP-Resize-animations-in-files-of-the-GIF-format.html](http://www.phpclasses.org/package/7353-PHP-Resize-animations-in-files-of-the-GIF-format.html)

该课程正在使用 GD 调整 GIF 动画的大小。首先解析帧，然后调整它们的大小，然后再次将它们编译成单个文件，而不会丢失其延迟时间、处理方法、颜色表等。

尝试一下，如果您发现错误或想要提出一些优化建议等，您可以使用课程论坛或在我网站的页面上发表评论。我会尽快回答。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-02-27T22:45:48.620

[GIF Animation Resizer](http://www.phpclasses.org/package/7353-PHP-Resize-animations-in-files-of-the-GIF-format.html)是一个简单的一类工具，可以解决问题。

**注意：**它使用一个临时文件夹来写出单独的帧。虽然它会为帧添加时间戳，但如果您打算在多个用户将同时调整 GIF 大小的服务器上使用它，则可能需要创建一个唯一文件夹。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-01-20T05:23:11.833

[Imagecraft](https://github.com/coldume/imagecraft)是一个可靠的 PHP GD 库和扩展，可以保存 GIF 动画，在多个图层中编辑和合成图像，并支持水印。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-05-09T11:19:52.933

我使用了这个功能：

```
function gifResize($file_origin,$file_dest,$percent){       
   $crop_w = 0;
   $crop_h = 0;
   $crop_x = 0;
   $crop_y = 0;
   $image = new Imagick($file_origin);
   $originalWidth = $image->getImageWidth();
   $originalHeight = $image->getImageHeight();
   $size_w = ($originalWidth*$percent)/100;
   $size_h = ($originalHeight*$percent)/100;
   if(($size_w-$originalWidth)>($size_h-$originalHeight)){
       $s = $size_h/$originalHeight;
       $size_w = round($originalWidth*$s);
       $size_h = round($originalHeight*$s);
   }else{
       $s = $size_w/$originalWidth;
       $size_w = round($originalWidth*$s);
       $size_h = round($originalHeight*$s);
   }       
   $image = $image->coalesceImages();

   foreach ($image as $frame) {
       $frame->cropImage($crop_w, $crop_h, $crop_x, $crop_y);
       $frame->thumbnailImage($size_h, $size_w);
       $frame->setImagePage($size_h, $size_w, 0, 0);
   }
   $imageContent = $image->getImagesBlob();
   $fp = fopen($file_dest,'w');
   fwrite($fp,$imageContent);
   fclose($fp); 
```

}

# python - 无法将 Python 代码放入 Joomla

> ID：718498
> 
> 赞同：0
> 
> 时间：2009-04-05T07:08:27.457
> 
> 标签：python, joomla

我有来自 Google 应用引擎的 Python 代码。我需要将它实施到 Joomla。

**如何将 Python 代码实现到 Joomla？**

**[在第一个答案后编辑]**

对我来说，我可以将代码放到模块位置就足够了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-05T07:17:23.177

Joomla 是基于 PHP 的，而 Google App Engine 是基于 Python 的（并且倾向于使用 Django）。您最好的选择是找到 Python 代码的替代品，找人翻译，或者学习 Python 并手动翻译。

虽然没有直接的 python 到 php 的转换。

编辑：但如果你真的想冒险，你可以在 PHP 项目中尝试 Python，该项目仍处于早期阶段，看起来是某人的副项目：[http ://www.csh.rit.edu/~jon/projects/pip /](http://www.csh.rit.edu/~jon/projects/pip/)

# c++ - C++ 中的堆栈损坏

> ID：718503
> 
> 赞同：19
> 
> 时间：2009-04-05T07:12:06.107
> 
> 标签：c++, stack, corruption

在 C++ 中，堆栈可能会以何种方式损坏。我猜的一种方法是通过访问超出其边界的数组来覆盖堆栈变量。有没有其他方法可以破坏它？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-04-05T07:17:46.403

1.  你可以有一个随机/未定义的指针，最终指向堆栈，然后写。
2.  汇编函数可能会错误地设置/修改/恢复堆栈
3.  宇宙波可以翻转堆栈中的位。
4.  芯片外壳中的放射性元素可能会翻转位。
5.  内核中的任何内容都可能出错并意外更改您的堆栈内存。

但这些并不是 C++ 特有的，它对堆栈一无所知。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-04-05T09:59:51.927

违反单一定义规则可能导致堆栈损坏。下面的示例看起来很愚蠢，但我已经多次看到它使用不同配置编译的不同库。

## 头文件.h

```
struct MyStruct
{
   int val;
#ifdef LARGEMYSTRUCT
   char padding[16];
#endif
} 
```

## 文件1.cpp

```
#define LARGEMYSTRUCT
#include "header.h"

//Here it looks like MyStruct is 20 bytes in size    

void func(MyStruct s)
{
   memset(s.padding, 0, 16); //corrupts the stack as below file2.cpp does not have LARGEMYSTRUCT declared and declares Mystruct with 4 bytes
   return; //Will probably crash here as the return pointer has been overwritten
} 
```

## 文件2.cpp

```
#include "header.h"
//Here it looks like MyStruct is only 4 bytes in size.
extern void func(MyStruct s);

void caller()
{
   MyStruct s;
   func(s); //push four bytes on to the stack
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-04-05T10:41:53.870

使用指向堆栈变量的指针是一个好方法：

```
void foo()
{
  my_struct s;
  bar(&s);
} 
```

如果 bar 保留指针的副本，那么将来任何事情都可能发生。

总结：当有指向堆栈的杂散指针时，就会发生堆栈损坏。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-05T07:16:18.763

C++ 标准没有定义栈/堆。此外，有许多方法可以在程序中调用未定义的行为——所有这些都可能破坏您的堆栈（毕竟是 UB）。简短的回答是——你的问题太模糊，没有有意义的答案。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-05T07:51:11.813

使用错误的调用约定调用函数。

（虽然这在技术上是特定于编译器的，而不是 C++ 的问题，但每个 C++ 编译器都必须处理这个问题。）

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2010-02-24T16:20:56.030

在析构函数中抛出异常是一个不错的选择。它会弄乱堆栈展开。

# database - Tips for optimising Database and POST request performance

> ID：718508
> 
> 赞同：0
> 
> 时间：2009-04-05T07:15:16.473
> 
> 标签：database, ajax, optimization, post, performance

I am developing an application which involves multiple user interactivity in real time. It basically involves lots of AJAX POST/GET requests from each user to the server - which in turn translates to database reads and writes. The real time result returned from the server is used to update the client side front end.

I know optimisation is quite a tricky, specialised area, but what advice would you give me to get maximum speed of operation here - speed is of paramount importance, but currently some of these POST requests take 20-30 seconds to return.

One way I have thought about optimising it is to club POST requests and send them out to the server as a group 8-10, instead of firing individual requests. I am not currently using caching in the database side, and don't really have too much knowledge on what it is, and whether it will be beneficial in this case.

Also, do the AJAX POST and GET requests incur the same overhead in terms of speed?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T07:17:44.470

Rather than continuously hitting the database, cache frequently used data items (with an expiry time based upon how infrequently the data changes).

Can you reduce your communication with the server by caching some data client side?

> The purpose of GET is as its name implies - to GET information. It is intended to be used when you are reading information to display on the page. Browsers will cache the result from a GET request and if the same GET request is made again then they will display the cached result rather than rerunning the entire request. This is not a flaw in the browser processing but is deliberately designed to work that way so as to make GET calls more efficient when the calls are used for their intended purpose. A GET call is retrieving data to display in the page and data is not expected to be changed on the server by such a call and so re-requesting the same data should be expected to obtain the same result.
> 
> The POST method is intended to be used where you are updating information on the server. Such a call is expected to make changes to the data stored on the server and the results returned from two identical POST calls may very well be completely different from one another since the initial values before the second POST call will be differentfrom the initial values before the first call because the first call will have updated at least some of those values. A POST call will therefore always obtain the response from the server rather than keeping a cached copy of the prior response.

[Ref](http://javascript.about.com/od/ajax/a/ajaxgp.htm).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T07:33:06.147

The optimization tricks you'd use are generally the same tricks you'd use for a normal website, just with a faster turn around time. Some things you can look into doing are:

*   Prefetch GET requests that have high odds of being loaded by the user
*   Use a caching layer in between as Mitch Wheat suggests. Depending on your technology platform, you can look into memcache, it's quite common and there are libraries for just about everything
*   Look at denormalizing data that is going to be queried at a very high frequency. Assuming that reads are more common than writes, you should get a decent performance boost if you move the workload to the write portion of the data access (as opposed to adding database load via joins)
*   Use delayed inserts to give priority to writes and let the database server optimize the batching
*   Make sure you have intelligent indexes on the table and figure out what benefit they're providing. If you're rebuilding the indexes very frequently due to a high write:read ratio, you may want to scale back the queries
*   Look at retrieving data in more general queries and filtering the data when it makes to the business layer of the application. MySQL (for instance) uses a very specific query cache that matches against a specific query. It might make sense to pull all results for a given set, even if you're only going to be displaying x%.
*   For writes, look at running asynchronous queries to the database if it's possible within your system. Data synchronization doesn't *have* to be instantaneous, it just needs to appear that way (most of the time)
*   Cache common pages on disk/memory in a fully formatted state so that the server doesn't have to do much processing of them

All in all, there are *lots* of things you can do (and they generally come down to general development practices on a more bite sized scale).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-10T15:26:19.437

您是否尝试过分析您的应用程序？

不确定您使用的是什么框架（如果有的话），但坦率地说，从您的问题来看，我怀疑您是否具备技术技能来关注这一点并找出事情在哪里放缓。

坦率地说，你不应该用复杂的方法来尝试解决你的问题，因为你并不真正了解问题是什么。这样做更有可能使情况变得更糟而不是更好。

我建议你做的是每一步都计时。您很可能会发现

1.  你有一两个非常长的运行位或
2.  由于 n+1 错误等原因，您正在运行大量查询

当您发现问题所在时，请修复它。如果您不知道如何，请再次发布。;-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-05T09:11:43.370

常见的调优技巧是： - 使用更多的索引 - 使用更少的索引 - 在文件系统、数据库、应用程序或内容上使用或多或少的缓存 - 在任何组件上提供更多带宽或更多 cpu 功率或更多内存 - 最大限度地减少开销在任何形式的交流中

当然，另一种选择是： 0 开发一组测试，最好是自动的，可以确定您的应用程序是否正常工作。
1 测量应用程序的“速度”。
2 确定它必须变得多快
3 确定性能问题的根源：
典型问题是：网络吞吐量、文件 i/o、延迟、锁定问题、内存不足、cpu 4 修复问题
5 确保它实际上更快
6确保它仍然正常工作（因此上面的测试）
7 返回到 1

# linq-to-sql - 这个 IQueryable 扩展方法不支持对 SQL 的翻译 :(

> ID：718517
> 
> 赞同：0
> 
> 时间：2009-04-05T07:23:22.647
> 
> 标签：linq-to-sql

我正在尝试执行以下 linq 2 sql 扩展方法：

```
public static PagedList<T> ToPagedListOrNull<T>(this IQueryable<T> value,
                                                int index,
                                                int pageSize)
    {
        return value.Count() == 0
        ? null
        : (value is PagedList<T> ? value as PagedList<T> : 
                                   new PagedList<T>(value, index, pageSize));
    } 
```

我不断收到以下错误：

> 方法“Boolean Contains(System.String)”不支持对 SQL 的转换。

我认为这`value.Count() == 0`有点错误..我认为。

有人能告诉我这是为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T07:26:38.817

您的查询是错误的，换句话说就是“价值”。

尝试单独测试以确保它有效。:)

# php - 如何在 PHP 中将我的按钮转换为超链接？

> ID：718518
> 
> 赞同：0
> 
> 时间：2009-04-05T07:24:01.880
> 
> 标签：php, html, button, hyperlink

我需要用超链接替换我网页上的按钮。我正在使用按钮调用 PHP 脚本。

我使用以下语句提取 id：

```
$id = $_POST['id']; 
```

HTML 代码：

```
<form id="test1" method="post" action="my.php?action=show">
  <input type="hidden" name="id" id="id" value="1" />
  <input type="submit" name="submit" value="Click" onclick="return display(1);" />
</form> 
```

这是我想出的：

```
 <a href="my.php?action=show&id='1'" onclick="return display(1);"> Click</a> 
```

我的代码有缺陷吗？有更好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-05T07:33:03.667

看起来不错，除了三点：

1.  使用`&amp;`而不是`&`.
2.  使用`id=1`而不是`id='1'`.
3.  使用`$_GET`而不是`$_POST`. 如果你想要向后兼容，你可以选择`$_REQUEST`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T08:00:37.657

您可以将链接发布在表单中：

```
<a href="#" onclick="if(display(1))document.getElementById('test1').submit();return false;"> Click</a> 
```

这样它就可以在不更改 PHP 代码的情况下工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T07:25:58.787

不 - 对我来说看起来不错，虽然 '1' 不需要用引号括起来，而且你需要在 PHP 的第一行中将 $_GET 更改为 $_POST。

# visual-studio - 如何将 Visual Studio 功能引入 Eclipse？

> ID：718521
> 
> 赞同：3
> 
> 时间：2009-04-05T07:25:19.770
> 
> 标签：visual-studio, visual-studio-2008, eclipse

Visual Studio 难民在这里。我不得不切换到 Eclipse 来编写几个 Java 应用程序，我真的很想念我所依赖的所有 VS2008 的优点。

我是 Eclipse 的新手，所以我可能根本找不到我需要的东西。考虑到这一点，我如何在 Eclipse 中复制以下内容。

1.  右键单击源代码选项卡，然后打开文件夹
2.  Love VS 的外部工具功能，允许您通过令牌对单个文件执行操作。无论如何要在 Eclipse 中执行此操作？
3.  编辑 XML 文件时的智能感知

最后，有人可以推荐一个好的新闻组或 Eclipse 专家常去的论坛（这里除外）吗？我在eclipse网站上真的找不到任何东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-05T07:33:10.157

1.  有可用的插件，例如[StartExplorer](http://www.eclipseplugincentral.com/Web_Links-index-req-viewlink-cid-1225.html)，[Eclipse Explorer](http://www.eclipseplugincentral.com/Web_Links-index-req-viewlink-cid-707.html)

2.  单击“运行”和“调试”旁边的“开始按钮+工具箱”下拉菜单，然后选择“打开外部工具对话框”。这使您可以运行任意工具。

3.  Intellisense for XML 通常由您使用的 XML 编辑器提供。如果 Eclipse 附带的 XML 插件对您来说不够用，请在 Eclipse Plugin Central 中查找 XML 插件。

# visual-studio-2008 - 如何为 Outlook 插件构建自动更新？

> ID：718526
> 
> 赞同：4
> 
> 时间：2009-04-05T07:29:38.717
> 
> 标签：visual-studio-2008, outlook, vsto, outlook-addin

我正在构建一个 Outlook 插件，我想知道当我们发布新版本（或至少通知用户访问我们的网站并下载/安装最新版本）时，是否有任何标准方法可以让插件自行更新？我一直在考虑的一种天真的方式就是每隔一段时间 ping 我们的服务器以检查更新，并显示一个消息框。谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-05T15:04:57.840

嘿，如果您使用的是 vs 2008（我猜您是），这很容易实现，因为 vs 2008 向 VSTO 添加了单击一次部署支持 - 检查下面的链接，它们应该可以帮助您实现这一点：

1) [http://www.codeproject.com/KB/office/Outlook_Add-in.aspx](http://www.codeproject.com/KB/office/Outlook_Add-in.aspx) - 这是msi + click一次的组合，这样您就不会遇到插件的安全问题（如果它使用注册表和其他点击一次的东西不允许）

2) [http://msdn.microsoft.com/en-us/library/cc136646.aspx](http://msdn.microsoft.com/en-us/library/cc136646.aspx)

3) [http://www.outlookcode.com/article.aspx?ID=42](http://www.outlookcode.com/article.aspx?ID=42)

# ruby-on-rails - 缓存 ActiveRecord 对象和关联

> ID：718527
> 
> 赞同：0
> 
> 时间：2009-04-05T07:29:49.620
> 
> 标签：ruby-on-rails, activerecord, caching

我希望能够将 ActiveRecord 模型的 10 个实例及其所有关联“深度克隆”到内存中，处理它们，更新内存中的对象，然后，当我完成后，选择一个来写回原来的在数据库中。

1.  我如何进行深度克隆（即*.clone*但也将所有关联克隆到关联树的底部）？到目前为止，我假设我将不得不在模型中编写自己的方法。

2.  在我准备好之前，如何确保所有克隆的实例都不会写回数据库？

如果可能的话，我想：-

1.  保留所有当前 ID，因为我的主要关联之一是*has_many ：通过*将一个模型的 ID 与另一个模型匹配

2.  仍然能够将每个克隆视为在数据库中（即*.find_by_id*等将起作用）

也许是一根棍子上的月亮？;)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T08:26:36.677

不是 100% 确定您要做什么...

只有调用 save 方法时，模型才会存储在数据库中。在现有模型中调用 save 将使用已更改的任何数据更新数据库。关联也可以保存，但它实际上取决于关联的类型，在大多数情况下，您可能还需要在这些模型上调用 save。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T08:36:25.153

嗬！有时，在你看到明显的答案之前，你需要先问一个愚蠢的问题。

我的问题是我不得不对关联的对象进行更改，并且当我稍后使用这些内存中的对象时它们没有出现，所以我认为我必须保存。然而，你是对的。实际发生的只是引用它们的变量超出了范围，因此我正在访问数据库中的变量。

我将回顾我的代码并检查是否是这种情况。

话虽如此，它并没有回答我关于“深度克隆”的问题......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-17T09:14:15.577

我已经使用 DefV 的深度克隆插件解决了我们的深度克隆问题：http: [//github.com/DefV/deep_cloning](http://github.com/DefV/deep_cloning)

到目前为止，它已经完成了我所要求的一切，尽管你发现你需要非常注意你的人际关系。幸运的是，我的测试显示这是一个问题，我目前正在解决它。我在尝试解决它时发现了这篇文章:)

不过看看这个插件，还是蛮方便的。

# xml - 根据内容选择子节点

> ID：718531
> 
> 赞同：13
> 
> 时间：2009-04-05T07:32:47.443
> 
> 标签：xml, xslt, xpath, nodes

XML 片段：

```
<AA>
  <BB>foo</BB>
  <CC>bar</CC>
  <DD>baz</DD>
  <EE>bar</EE>
</AA> 
```

如何选择其所有子节点作为`<AA>`其`bar`内容？在上面的示例中，我想选择`<CC>`and `<EE>`。我认为解决方案是这样的：

```
<xsl:template match="AA">
  <xsl:for-each select="???" />
</xsl:template> 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-04-05T14:54:26.557

**OP 问题的最简单解决方案之一是以下 XPath 表达式**：

```
*/*[.='bar'] 
```

**请注意，不涉及 XSLT 指令——这只是一个 XPath 表达式**，因此只能将问题标记为 XPath。

**从这里开始，可以以多种方式在 XSLT 中使用这个 XPath 表达式，例如在所有选定的节点上应用模板**。

例如，下面是一个 XSLT 转换，它采用 XML 文档并生成另一个文档，其中所有元素 -`<AA>`其内容不等于的子元素都将`"bar"`被删除：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

    <xsl:template match="node()|@*">
      <xsl:copy>
        <xsl:apply-templates select="node()|@*"/>
      </xsl:copy>
    </xsl:template>

    <xsl:template match="AA">
      <xsl:copy>
         <xsl:apply-templates select="*[. = 'bar']"/>
      </xsl:copy>
    </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于原始 XML 文档时**：

```
<AA>
    <BB>foo</BB>
    <CC>bar</CC>
    <DD>baz</DD>
    <EE>bar</EE>
</AA> 
```

**产生了想要的结果**：

```
<AA>
   <CC>bar</CC>
   <EE>bar</EE>
</AA> 
```

**请注意**：

在匹配模式中，我们通常不需要指定绝对 XPath 表达式，而只需指定一个相对表达式，因此完整的 XPath 表达式自然会简化为这种匹配模式：

```
*[. = 'bar'] 
```

# python - Changing the title of a Tab in wx.Notebook

> ID：718546
> 
> 赞同：3
> 
> 时间：2009-04-05T07:49:10.010
> 
> 标签：python, wxpython, wxwidgets, tabbed-interface

I'm experimenting with wxPython,

I have a tabbed interface (notebook) and each tab is basically a file list view (yes, I'm trying to make a file manager)

The file list inherits from wx.ListCtrl, and the tabbed interface inherits from wx.Notebook

I'm just starting .. and I had it so double clicking on a folder will cd into that folder, but I want to also change the title of the tab.

How do I do that?

I have the object that represents the file list and the title I want to set it to,

`[` **EDIT** `Notebook.SetPageText()` takes a number, so I can't pass the tab object directly to it `]`

my current approach is to cycle through the tabs until one of them matches my tab:

```
 for tab_id in range(self.GetPageCount()):
        if self.GetPage(tab_id) == tab:
            self.SetPageText(tab_id, title)
            break 
```

This seems rather naive though, isn't there a smarter approach?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-05T09:12:20.183

我不知道 wxPython，但我认为它包装了 C++ 类的所有方法。

wxNotebook *::GetSelection()*返回*wxNOT_FOUND*或所选页面的索引，然后可用于调用*wxNotebook::SetPageText()*。

或者使用*wxNotebook::GetPage()*和这个索引来检查它是否等于*tab*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T08:48:31.803

我认为做这样的事情会有所帮助：

```
 notebook.get_tab_label(notebook.get_nth_page(your_page_number)).set_text("Your text") 
```

如果您想始终引用当前选项卡，则必须连接“切换页面”信号，并将页面保存在变量中。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-05T08:08:05.783

As .GetPage returns a wx.Window, I think `tab.Label = title` should work.

# ruby - 不在 python 中编写 supybot 插件？

> ID：718551
> 
> 赞同：0
> 
> 时间：2009-04-05T07:57:30.443
> 
> 标签：ruby, irc

在 ruby​​ 中编写 supybot 插件的最佳方法是什么？还是其他语言（不是python）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T12:23:57.933

简短的回答是，你不能。Supybot 是用 Python 编写的，无法加载 Ruby/其他语言模块/文件。理论上你可以用 C/C++ 编写插件，Supybot 可能会尝试加载它们。但是您需要深入研究 Python API，因为 Supybot 代码没有绑定。

如果你更喜欢 Ruby 而不是 Python，你可以使用[rbot](http://www.ruby-rbot.org/)一个用 Ruby 编写的 IRC 机器人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-02-17T06:19:43.430

您可以通过[Rython在 Python 中使用 Ruby](http://pypi.python.org/pypi/rython/)

# python - App Engine - 尝试设置模型属性值时出现问题

> ID：718553
> 
> 赞同：1
> 
> 时间：2009-04-05T07:59:07.507
> 
> 标签：python, google-app-engine, bigtable

我对应用引擎很陌生，我第一次尝试在应用引擎数据库中设置一些文本。

这是我的代码：

```
def setVenueIntroText(text):
  venue_obj = db.GqlQuery("SELECT * FROM Venue").get()
  venue_obj.intro_text = text     # Works if I comment out
  db.put(venue_obj)               # These two lines 
```

这会引发某种异常 - 由于我的 django 1.02 设置，我无法分辨它是什么。

好的，我在下面的答案中给出了代码，在删除我的数据存储后它工作了，但我仍然不满意。

这是一个更新：

我已将我的代码修改为看起来对我有意义的东西。当我调用 getVenueIntroText 时，它不会抱怨 - 顺便说一句，我在数据库中没有任何项目。

当我调用 setVenueIntroText 时，出于某种原因它不喜欢我正在做的事情 - 如果有人知道原因，我真的很想知道 :)

这是我最近的尝试：

```
def getVenueIntroText():
  venue_info = ""
  venue_obj = db.GqlQuery("SELECT * FROM Venue").get()

  if venue_obj is not None:
      venue_info = venue_obj.intro_text

  return venue_info

def setVenueIntroText(text):
  venue_obj = db.GqlQuery("SELECT * FROM Venue").get()
  if venue_obj is None:
     venue_obj = Venue(intro_text = text)
  else:
     venue_obj.intro_text = text

  db.put(venue_obj) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T08:30:22.267

我认为这应该有效：

```
def setVenueIntroText(text):
  query = db.GqlQuery("SELECT * FROM Venue")
  for result in query:
    result.intro_text = text
    db.put(result) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T19:42:56.393

我认为主要问题是我看不到错误消息 - 我真的很愚蠢，我忘了在我的 settings.py 中输入 DEBUG = True

事实证明，我的 StringProperty 中需要一个 multiline=True

Django 正在为我捕捉我的异常。

# java - 如何将包含整数的 ArrayList 转换为原始 int 数组？

> ID：718554
> 
> 赞同：381
> 
> 时间：2009-04-05T07:59:29.657
> 
> 标签：java, arrays, arraylist, primitive-types

我正在尝试使用以下代码将包含 Integer 对象的 ArrayList 转换为原始 int[] ，但它会引发编译时错误。可以用Java转换吗？

```
List<Integer> x =  new ArrayList<Integer>();
int[] n = (int[])x.toArray(int[x.size()]); 
```

* * *

## 回答 #1

> 赞同：342
> 
> 时间：2014-05-15T21:01:55.707

如果您使用的是[java-8](/questions/tagged/java-8 "显示标记为“java-8”的问题")，还有另一种方法可以做到这一点。

```
int[] arr = list.stream().mapToInt(i -> i).toArray(); 
```

它的作用是：

*   `Stream<Integer>`从列表中获取
*   `IntStream`通过将每个元素映射到自身（身份函数）来获得一个，将`int`每个对象持有的值拆箱`Integer`（从 Java 5 开始自动完成）
*   `int`通过调用获取数组`toArray`

`intValue`您还可以通过方法引用显式调用，即：

```
int[] arr = list.stream().mapToInt(Integer::intValue).toArray(); 
```

`NullPointerException`还值得一提的是，如果您在列表中有任何`null`参考，您可以获得一个。这可以通过向流管道添加过滤条件来轻松避免，如下所示：

```
 //.filter(Objects::nonNull) also works
int[] arr = list.stream().filter(i -> i != null).mapToInt(i -> i).toArray(); 
```

例子：

```
List<Integer> list = Arrays.asList(1, 2, 3, 4);
int[] arr = list.stream().mapToInt(i -> i).toArray(); //[1, 2, 3, 4]

list.set(1, null); //[1, null, 3, 4]
arr = list.stream().filter(i -> i != null).mapToInt(i -> i).toArray(); //[1, 3, 4] 
```

* * *

## 回答 #2

> 赞同：256
> 
> 时间：2009-04-05T08:04:08.163

您可以转换，但我认为没有内置任何东西可以自动进行转换：

```
public static int[] convertIntegers(List<Integer> integers)
{
    int[] ret = new int[integers.size()];
    for (int i=0; i < ret.length; i++)
    {
        ret[i] = integers.get(i).intValue();
    }
    return ret;
} 
```

（请注意，如果其中一个`integers`或任何元素是，这将引发 NullPointerException `null`。）

编辑：根据评论，您可能希望使用列表迭代器来避免列表的讨厌成本，例如`LinkedList`：

```
public static int[] convertIntegers(List<Integer> integers)
{
    int[] ret = new int[integers.size()];
    Iterator<Integer> iterator = integers.iterator();
    for (int i = 0; i < ret.length; i++)
    {
        ret[i] = iterator.next().intValue();
    }
    return ret;
} 
```

* * *

## 回答 #3

> 赞同：83
> 
> 时间：2011-12-17T20:31:12.767

# 谷歌番石榴

[Google Guava](https://en.m.wikipedia.org/wiki/Google_Guava)通过调用[`Ints.toArray`](http://google.github.io/guava/releases/19.0/api/docs/com/google/common/primitives/Ints.html#toArray(java.util.Collection)).

```
List<Integer> list = ...;
int[] values = Ints.toArray(list); 
```

* * *

## 回答 #4

> 赞同：67
> 
> 时间：2009-04-05T09:00:32.240

Apache Commons 有一个 ArrayUtils 类，它有一个方法 toPrimitive() 可以做到这一点。

```
import org.apache.commons.lang.ArrayUtils;
...
    List<Integer> list = new ArrayList<Integer>();
    list.add(new Integer(1));
    list.add(new Integer(2));
    int[] intArray = ArrayUtils.toPrimitive(list.toArray(new Integer[0])); 
```

然而，正如 Jon 所展示的那样，您自己可以很容易地做到这一点，而不是使用外部库。

* * *

## 回答 #5

> 赞同：42
> 
> 时间：2011-04-02T20:56:34.497

我相信使用 List 的迭代器进行迭代是一个更好的主意，因为`list.get(i)`根据 List 的实现，性能可能会很差：

```
private int[] buildIntArray(List<Integer> integers) {
    int[] ints = new int[integers.size()];
    int i = 0;
    for (Integer n : integers) {
        ints[i++] = n;
    }
    return ints;
} 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2020-02-03T11:02:38.133

爪哇 8：

```
int[] intArr = Arrays.stream(integerList).mapToInt(i->i).toArray(); 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2020-02-16T13:52:16.693

## 数组.setAll()

```
 List<Integer> x = new ArrayList<>(Arrays.asList(7, 9, 13));
    int[] n = new int[x.size()];
    Arrays.setAll(n, x::get);

    System.out.println("Array of primitive ints: " + Arrays.toString(n)); 
```

输出：

> 原始整数数组：[7, 9, 13]

这同样适用于`long`or的数组`double`，但不适用于`boolean`, `char`, `byte`, `short`or的数组`float`。如果您有一个非常庞大的列表，那么`parallelSetAll`您甚至可以使用一种方法来代替。

对我来说，这很好而且很优雅，以至于我不想获得外部库也不想使用流。

**文档链接：** [`Arrays.setAll(int[], IntUnaryOperator)`](https://docs.oracle.com/javase/10/docs/api/java/util/Arrays.html#setAll(int%5B%5D,java.util.function.IntUnaryOperator))

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2010-02-01T20:14:28.760

使用[Dollar](http://bitbucket.org/dfa/dollar)应该很简单：

```
List<Integer> list = $(5).toList(); // the list 0, 1, 2, 3, 4  
int[] array = $($(list).toArray()).toIntArray(); 
```

我计划改进 DSL 以消除中间`toArray()`调用

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2020-04-02T19:20:46.527

这对我来说很好:)

可在[https://www.techiedelight.com/convert-list-integer-array-int/找到](https://www.techiedelight.com/convert-list-integer-array-int/)

```
import java.util.Arrays;
import java.util.List;

class ListUtil
{
    // Program to convert list of integer to array of int in Java
    public static void main(String args[])
    {
        List<Integer> list = Arrays.asList(1, 2, 3, 4, 5);

        int[] primitive = list.stream()
                            .mapToInt(Integer::intValue)
                            .toArray();

        System.out.println(Arrays.toString(primitive));
    }
} 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2020-09-23T13:29:40.200

**Arrays.setAll()**适用于大多数场景：

1.  整数列表到原始 int 数组：

    ```
    public static int[] convert(final List<Integer> list)
    {
       final int[] out = new int[list.size()];
       Arrays.setAll(out, list::get);
       return out;
    } 
    ```

2.  整数列表（由字符串组成）到原始 int 数组：

    ```
    public static int[] convert(final List<String> list)
    {
       final int[] out = new int[list.size()];
       Arrays.setAll(out, i -> Integer.parseInt(list.get(i)));
       return out;
    } 
    ```

3.  整数数组到原始 int 数组：

    ```
    public static int[] convert(final Integer[] array)
    {
       final int[] out = new int[array.length];
       Arrays.setAll(out, i -> array[i]);
       return out;
    } 
    ```

4.  原始 int 数组到 Integer 数组：

    ```
    public static Integer[] convert(final int[] array)
    {
       final Integer[] out = new Integer[array.length];
       Arrays.setAll(out, i -> array[i]);
       return out;
    } 
    ```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2010-04-30T13:22:41.257

让我感到困惑的是，只要像 Apache Commons 这样非常好的、使用良好的库已经解决了这个问题，我们就鼓励一次性的自定义方法。尽管解决方案即使不是荒谬也是微不足道的，但由于长期维护和可访问性而鼓励这种行为是不负责任的。

只需使用[Apache Commons](http://commons.apache.org/lang/api-2.4/org/apache/commons/lang/ArrayUtils.html#toPrimitive%28java.lang.Integer%5B%5D,%20int%29)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2013-08-29T10:32:24.340

如果您使用的是[Eclipse Collections](http://www.eclipse.org/collections/)，则可以使用该`collectInt()`方法从对象容器切换到原始 int 容器。

```
List<Integer> integers = new ArrayList<>(Arrays.asList(1, 2, 3, 4, 5));
MutableIntList intList =
  ListAdapter.adapt(integers).collectInt(i -> i);
Assert.assertArrayEquals(new int[]{1, 2, 3, 4, 5}, intList.toArray()); 
```

如果您可以将您的转换`ArrayList`为 a `FastList`，则可以摆脱适配器。

```
Assert.assertArrayEquals(
  new int[]{1, 2, 3, 4, 5},
  Lists.mutable.with(1, 2, 3, 4, 5)
    .collectInt(i -> i).toArray()); 
```

**注意：**我是 Eclipse 集合的提交者。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2015-08-13T15:10:13.510

您可以简单地将其复制到数组中：

```
int[] arr = new int[list.size()];
for(int i = 0; i < list.size(); i++) {
    arr[i] = list.get(i);
} 
```

不太花哨；但是，嘿，它的工作...

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2020-07-10T15:13:48.483

下一行你可以找到从 int[] -> List -> int[] 的转换

```
 private static int[] convert(int[] arr) {
        List<Integer> myList=new ArrayList<Integer>();
        for(int number:arr){
               myList.add(number);
            }
        }
        int[] myArray=new int[myList.size()];
        for(int i=0;i<myList.size();i++){
           myArray[i]=myList.get(i);
        }
        return myArray;
    } 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2021-04-26T16:53:35.300

爪哇 8

```
int[] array = list.stream().mapToInt(i->i).toArray();

OR 

int[] array = list.stream().mapToInt(Integer::intValue).toArray(); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-02-14T04:15:45.347

这个代码段对我有用，试试这个：

```
Integer[] arr = x.toArray(new Integer[x.size()]); 
```

值得一提的是 ArrayList 应该这样声明：

```
ArrayList<Integer> list = new ArrayList<>(); 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-03-14T06:25:20.780

一个非常简单的单行解决方案是：

```
Integer[] i = arrlist.stream().toArray(Integer[]::new); 
```

* * *

## 回答 #18

> 赞同：-4
> 
> 时间：2013-05-02T11:09:00.960

```
 List<Integer> list = new ArrayList<Integer>();

    list.add(1);
    list.add(2);

    int[] result = null;
    StringBuffer strBuffer = new StringBuffer();
    for (Object o : list) {
        strBuffer.append(o);
        result = new int[] { Integer.parseInt(strBuffer.toString()) };
        for (Integer i : result) {
            System.out.println(i);
        }
        strBuffer.delete(0, strBuffer.length());
    } 
```

* * *

## 回答 #19

> 赞同：-7
> 
> 时间：2011-09-14T19:26:06.903

```
Integer[] arr = (Integer[]) x.toArray(new Integer[x.size()]); 
```

`arr`正常访问`int[]`。

# c# - 如何创建相似或相关的文章模块

> ID：718561
> 
> 赞同：1
> 
> 时间：2009-04-05T08:05:08.100
> 
> 标签：c#, asp.net

我正在为我的客户创建新闻系统，他要求当他发表文章时，他希望在底部有一个列表，以显示与他发表的文章相似或相关的文章。

那么如果他不想手动放置，我该如何创建呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T14:47:35.573

我已经为一个客户实现了这个，但是它并不太复杂而且很简单（因为我的客户预算很低）

基本上我根据分数显示相关文章（分数越高，显示相关文章的机会就越大）

这个分数取决于几个简单的事情：

1) - 将任何文章的标签与数据库中的现有文章匹配（这具有最高乘数）所以如果 3 个标签匹配，我乘以 10，这样分数 = 30

2) - 删除常用词（如 a、the、how 等）后，将文章标题与数据库中现有文章的主题相匹配。我使用 sql server 自由文本来给我排名。我将这个排名乘以 5。所以如果 3 个单词匹配，则分数 = 15

然后我将上面 2 的分数相加，并以从高到低的顺序显示它们。

但这里有一点非常重要——我还允许我的客户明确指定相关文章。因此，如果我的客户明确指定了 2 篇文章，那么我将首先显示这 2 篇文章，然后运行我的算法以在列表中显示剩余 3 篇（总共 5 篇）

我知道它是一个简单的解决方案，不是 100% 完美，但我必须在考虑客户预算的情况下构建它。您总是可以为此添加更多因素（例如匹配内容、日期（最新到最旧的偏好）、受欢迎程度（评论和查看次数）等

希望这可以帮助...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T08:38:04.417

这是一篇关于如何为 SQL Server 2005 构建推荐引擎的文章：[http ://www.aspnetpro.com/newsletterarticle/2004/10/asp200410ri_l/asp200410ri_l.asp](http://www.aspnetpro.com/newsletterarticle/2004/10/asp200410ri_l/asp200410ri_l.asp)

推荐引擎可能需要做很多工作（尤其是在算法微调和维护方面），因此请确保您的客户正在为此付费，这不是最后一分钟“我们为什么不添加 X”的情况。

# c# - C#线程中断停止工作

> ID：718564
> 
> 赞同：2
> 
> 时间：2009-04-05T08:06:58.580
> 
> 标签：c#, multithreading, exception

我不知道为什么，但我不能再打断我自己的线程。

```
thread = new Thread(new ParameterizedThreadStart(this.doWork));
thread.Start(param);
...
thread.Interrupt();
//in doWork()
try {
...
}
catch (System.Threading.ThreadInterruptedException)
{
//it never hits here. it use to
} 
```

我搜索并且我的代码中没有任何捕获，这是唯一的捕获（System.Threading.ThreadInterruptedException）。那么发生了什么？使用调试器，我可以看到我的代码通过 thread.Interrupt(); 运行。如果我执行 thread.abort() 我将捕获 System.Threading.ThreadAbortException 异常。为什么它会捕获它而不是 ThreadInterruptedException？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-05T08:16:37.370

来自[BOL](http://msdn.microsoft.com/en-us/library/system.threading.thread.interrupt.aspx)：

> 中断处于 WaitSleepJoin 线程状态的线程。
> 
> 如果该线程当前没有被阻塞在等待、睡眠或加入状态，它将在下一次开始阻塞时被中断。
> 
> ThreadInterruptedException 在被中断的线程中抛出，但直到线程阻塞。如果线程从不阻塞，则永远不会抛出异常，因此线程可能会在不被中断的情况下完成

顺便说一句，您最好使用`BackgroundWorker`支持取消的类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T09:14:15.750

从[acidzombie24](https://stackoverflow.com/users/34537)的评论到另一个[答案](https://stackoverflow.com/questions/718564/c-thread-interruption-stopped-working/718571#718571)：

> 那么 .abort 是更好的选择吗？我想要做的是杀死线程但让它存在并调用一些函数而不是彻底死亡

像活动这样的东西会更好。

假设您希望能够分别向每个线程发出信号，在每个工作线程启动之前创建一个[AutoResetEvent](http://msdn.com/library/System.Threading.AutoResetEvent)并将其传递给线程。

当你想中断线程调用[Set](http://msdn.com/library/System.Threading.AutoResetEvent.Set)事件时。在工作线程中定期检查事件的状态：

```
if (theEvent.WaitOne(TimeSpan.Zero)) {
  // Handle the interruption.
} 
```

（通常：需要由需求定义：检查开销与中断延迟。）

要获得主中断，向所有工作人员发出信号，请使用[ManualResetEvent](http://msdn.com/library/System.Threading.ManualResetEvent)保持信号状态，并在检查时继续中断线程，直到显式[Reset](http://msdn.com/library/System.Threading.ManualResetEvent.Reset)。

# jquery - 在 jQuery 中调整 HTML 表格宽度

> ID：718565
> 
> 赞同：11
> 
> 时间：2009-04-05T08:07:06.690
> 
> 标签：jquery, html, resize, html-table

`table`在 jQuery 中单击事件后，我需要改变 a的宽度。

### HTML：

```
<table class="zebra" border=0> 
```

### 情况1：

```
$("table.zebra").css("width","600px"); 
```

### 案例二：

```
$("table.zebra").css("width","200px"); 
```

### CSS：

```
table.zebra{}
table.zebra tr.even td, table.zebra tr.even th { background-color:#FDD017; }
table.zebra tr.odd td { background-color:#FFF380; } 
```

这不会`table`像我想要的那样改变 's 的宽度。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-05T08:26:12.293

这应该可以解决问题。

```
<table class="zebra">
  <tr>
    <td>foo</td>
    <td>bar</td>
  </tr>
</table>

<script type="text/javascript">
  $(function() {
    $('table.zebra').attr('width', 500);
  });
</script> 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-05T08:08:39.433

试试这个：

```
$("table.zebra").width(200); 
```

参考：[http ://docs.jquery.com/CSS/width#val](http://docs.jquery.com/CSS/width#val)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-01-14T10:55:51.653

这应该可以解决问题

```
$("table.zebra").width('200px'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-09-08T11:00:39.910

这对我有用

```
 $('#MyModalID').find('.modal-dialog').css({
                width: '800px'
            }); 
```

# ruby-on-rails - 维护分页符

> ID：718570
> 
> 赞同：0
> 
> 时间：2009-04-05T08:15:51.023
> 
> 标签：ruby-on-rails, line-breaks

在我的 Rails 应用程序中，我有很多`text`在迁移文件中声明的数据。但是当我在视图中打印这些属性/字段时，所有的换行符都丢失了，我得到了一大块文本。如何维护换行符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-05T08:24:32.513

这是一个 HTML 问题。它的规则规定连续的空白被转换为单个空格。

Rails 有一个[`simple_format`](http://api.rubyonrails.org/classes/ActionView/Helpers/TextHelper.html#M001719)将文本块包装在

标签，这样你就可以得到你想要的分离

# c# - 涉及双精度和整数的错误 C# 代码

> ID：718577
> 
> 赞同：0
> 
> 时间：2009-04-05T08:25:39.470
> 
> 标签：c#, integer, double

```
 for (iy = 0; iy < h; iy++)
    {
        double angy = (camera.fov_y / h) * iy;
        for (ix = 0; ix < w; ix++)
        {
            double angx = (camera.fov_x / w) * ix;
            //output[ix,iy].r = (int)Math.Round(255 * (angy / camera.fov_y);
            //output[ix,iy].b = (int)Math.Round(255 * (angy / camera.fov_y); 
            double tr = (angx / camera.fov_x) * 255D;
            double tb = (angy / camera.fov_y) * 255D;
            Console.Write("({0},{1})",Math.Round(tr),Math.Round(tb));

            output.SetPixel(ix, iy, Color.FromArgb(Convert.ToInt32(tr), 0, Convert.ToInt32(tb)) );
            Console.Write(".");
        }
        Console.WriteLine();
    } 
```

任何人都可以看到该代码的任何直接问题吗？变量`tr`和`tb`始终评估为 0。

如果需要，我很乐意提供更多信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T08:31:37.490

您还没有给出其他变量的类型 - 特别是 和 的类型是`camera.fov_x`什么`camera.fov_y`？如果它们都是整数，则初始化的`angx`行将`angy`使用整数算术进行评估。

这可以通过强制转换操作数之一来解决：

```
double angy = ((double) camera.fov_y / h) * iy; 
```

和变量已经加倍了，这不是问题`fovy`。`fovx`

你能给出一个完整的例子，我们可以自己编译和测试吗？

编辑：Koistya Navin 的编辑太过分了。您只需要一个表达式的一个操作数是一个双精度数，就可以使用双精度算术计算整个事物。（但它必须是正确的表达式 - 如果你这样做`(a/b) * c`并转换`c`为双精度，则乘法将使用双精度算术完成，但 a/b 可能仍以整数形式完成。）

下面的清单进行了适当的更改，以确保在应该使用的任何地方都使用双重算术：

```
// Changed loops to declare the variable, for stylistic purposes
for (int iy = 0; iy < h; iy++)
{
    // Changed here - cast camera.fov_y
    double angy = ((double) camera.fov_y / h) * iy;
    for (int ix = 0; ix < w; ix++)
    {
        // Changed here - cast camera.fov_x
        double angx = ((double) camera.fov_x / w) * ix;
        //output[ix,iy].r = (int)Math.Round(255 * (angy / camera.fov_y);
        //output[ix,iy].b = (int)Math.Round(255 * (angy / camera.fov_y); 
        double tr = (angx / camera.fov_x) * 255D;
        double tb = (angy / camera.fov_y) * 255D;
        Console.Write("({0},{1})", Math.Round(tr), Math.Round(tb));

        output.SetPixel(ix, iy, Color.FromArgb(Convert.ToInt32(tr), 
                                               0,
                                               Convert.ToInt32(tb)) );
        Console.Write(".");
    }
    Console.WriteLine();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T08:27:50.353

### 不要忘记将整数转换为双精度数。例如：

```
for (iy = 0; iy < h; iy++)
{
    double angy = ((double) camera.fov_y / h) * iy;
    for (ix = 0; ix < w; ix++)
    {
        double angx = ((double) camera.fov_x / (double) w) * (double) ix;
        output[ix,iy].r = (int) Math.Round(255 * (angy / camera.fov_y);
        output[ix,iy].b = (int) Math.Round(255 * (angy / camera.fov_y);
        double tr = (angx / camera.fov_x) * 255D;
        double tb = (angy / camera.fov_y) * 255D;
        Console.Write("({0},{1})",Math.Round(tr), Math.Round(tb));
        output.SetPixel(ix, iy, Color.FromArgb(
            Convert.ToInt32(tr), 0, Convert.ToInt32(tb)) );
        Console.Write(".");
    }
    Console.WriteLine();
} 
```

### 快速参考：

```
 int * double = double
 int / double = double
 double * int = double
 double / int = double

 int * int = int
 int / int = int // be carefull here!

 1 / 10 = 0 (not 0.1D)
 10 / 11 = 0 (not 1)
 1D / 10 = 0.1D
 1 / 10D = 0.1D
 1D / 10D = 0.1D 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-06T10:44:04.247

它知道这不是您原始问题的一部分，但是使用 SetPixel(..) 效率不是很高，如果您打算在光线跟踪引擎中使用它可能会出现问题。

您可能想使用 LockBits() 方法，请参阅此[答案](https://stackoverflow.com/questions/190385/how-to-manipulate-images-at-pixel-level-in-c/190395#190395)和[此](https://stackoverflow.com/questions/541331/effective-way-of-making-negative-of-image-without-external-dlls/552013#552013)答案以了解更多详细信息。他们的另一种方法是使用“不安全”的 C# 代码访问数据，它允许您使用指向数据的指针。有关更多信息，请参阅[此问题](https://stackoverflow.com/questions/702188/can-this-code-be-optimised)，我通过使用“不安全”代码获得了 ~x2 加速。

# request - 你遇到过的最有趣的用户请求是什么？

> ID：718582
> 
> 赞同：37
> 
> 时间：2009-04-05T08:28:10.227
> 
> 标签：request

用户有时会提出程序员设计和实现的最有趣、最奇怪和最奇妙的要求。

今天我从老板那里读到一份备忘录，我们需要“能够轻松快速地导入任何 Excel 或访问数据，无论大小如何。”

在同一份备忘录中，我们要求“知道是否有人未经授权访问了系统”——就好像黑客要将他的电话卡夹在某个索引和外键之间一样。

我认为我的老板一直在看太多的“星际迷航”...... :)

你遇到过的最有趣的用户请求是什么？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-08-16T06:53:14.540

我的客户要求在他的网站上，当前的白色太正常了。我引用“我想要 Facebook 和 Google 的亮白色”

我想知道这是否可行：

main.css

```
body {
    background-color: #ffffff !glossy;
} 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-08-16T07:04:48.600

“日历真的很难用，因为每个月的天数都不一样。你能不能把它们改成一样的天数？”

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2009-10-09T21:38:23.717

客户：“我真的很喜欢我的网站和谷歌，但是当我的笔记本电脑没有互联网连接时，我需要它们。你能把它们刻录成光盘，这样我就可以离线使用它们了吗？”

我：“我可以制作您网站的离线版本，但它的功能有限。但我无法让 Google 离线使用。通过硬件和月度合同，可以通过数据卡按月付费在任何地方上网. 你必须通过 ATT 或 Sprint 或类似的方式每月支付大约 60 美元。

客户：“我开始对你的能力感到失望。”

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2009-04-05T08:32:30.890

“我们知道服务器有时会宕机，但我们希望它*永远不会*宕机”

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2009-08-02T14:06:59.083

“你能确保我们的销售额至少增长 131% 吗？这将使我们领先于去年。”

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2009-08-16T06:59:49.767

“在选中启用按钮单击的复选框后，我们需要该按钮是可单击的。”

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2009-10-09T21:45:31.910

以下发生在同一个人身上多次......

数据输入操作员（在远程站点）：你能修理我的终端吗？它不会打开。

我：你上次打电话遇到这个问题时它被拔掉了，你能检查一下吗？

数据输入操作员：已插入！

所以我开车去远程站点，我发现了什么？当然是不插电的终端！我插上它，它工作得很好。

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2010-08-21T00:32:59.553

项目经理：“我们需要你列出这个项目的所有未知风险。”

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2009-10-09T21:59:14.733

[替代文字 http://img360.imageshack.us/img360/1020/dilbert2030557071204cr8.gif](http://img360.imageshack.us/img360/1020/dilbert2030557071204cr8.gif)

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2009-08-25T03:31:19.697

我们的其中一个程序可以让普通人操纵一个相当复杂的视频分发系统。它使用视频源（VCR、DVD 播放器等）的代表性图片直观地指示后端发生的情况。这些图形非常详细；录像机上有一个小小的琥珀色显示屏，以 7 段 LED 字体显示“12:00”。一位用户要求我们让它闪烁。另一个要求我们让它显示当前时间。

*刘海头放在桌子上*

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2009-11-06T15:14:36.143

我的编程团队编写了一个与遗留会计系统接口的内部网。基本上，我们正在编写一个漂亮的 ASP.NET 前端来保护用户不必与终端系统交互。

无论如何，我们的一位测试人员注意到我们的登录代码可以接受任何密码，只要前 8 个字符是正确的。测试人员使用密码“Password”创建了一个用户，但应用程序将验证“Password1”、“PasswordMonkey”、“PasswordFakeFakeFakehahahah”。因此，我们的测试人员将此记录为缺陷。一些调查显示，遗留系统将密码存储在固定宽度的 8 个字符字段中，它只是悄悄地将查询截断为 8 个字符。快速测试表明，这个错误也存在于会计系统中，并且被忽视了 20 年。

我们无法修改遗留应用程序，因为它由第三方供应商维护，所以我写了一个快速`if (password.Length > 8) { return false; }`的结果——毕竟，超过 8 个字符的密码不可能是正确的。错误修复，QA 签字。

因此，当我们的应用程序投入生产时，我们会从我们的一位客户的总裁那里收到“**紧急！！用户无法登录到他们的帐户！！！** ”类型的消息。事实证明，州法律或公司政策要求所有密码长度至少为 12 个字符，并且在修复后没有用户能够使用我们的产品。

我们解释说，会计系统根本不存储超过 8 个字符的任何内容，如果用户只输入前 8 个字符，一切都会变得很美好。“不可接受！” 好的，那么我们可以在文本框上设置一个 maxlength，将输入限制为有效的字符范围。“笨蛋！以前工作得很好，现在修好了！” 我们的客户与我公司的总裁大吵一架，威胁我们如果不修复应用程序就更换供应商。

所以，我“修复”了应用程序注释掉了完整性检查并重新引入了这个错误。让 ASP.NET 前端的身份验证代码与终端后端的身份验证相同，这并不是一个不合理的要求，但故意重新调试应用程序确实令人不安。

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2010-04-01T16:47:48.713

看看这个名为[Clients From Hell的博客](http://clientsfromhell.tumblr.com/)

那里有一些非常“好”的。

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2009-08-16T07:32:29.453

“我刚刚删除了一条客户数据记录，你能从回收站恢复吗？”

有些人不明白，当一条记录被删除时，它就被删除了。这就是“删除”的意思，尤其是当他们没有要求我们构建“取消删除”功能时。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2010-07-06T10:08:11.610

“我希望没有人可以截取这个网页的截图。”

说真的，这是客户的需求。

然而，最变态的是，我真的找到了一个解决方案（一个让我更讨厌“Javascript”......）。

哦，解决方案是猴子证明的。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-08-16T07:29:07.870

客户：“你确定你推送了最后一个副本编辑吗？”

程序员：“是的，它是实时的，我对其进行了测试。”

客户：“我刚刚看了，它仍然显示旧的副本文本。”

程序员：“你试过清除浏览器缓存吗？”

客户：“那是什么？我该怎么做？你不能让网站帮我做吗？”

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2011-06-11T19:39:49.613

我们的一位客户将他的信用卡放入 FDD（软盘驱动器）以使用它；

# jquery - jquery淡出弹出窗口

> ID：718583
> 
> 赞同：3
> 
> 时间：2009-04-05T08:29:39.477
> 
> 标签：jquery, popupwindow

我正在使用 jquery 的 popupwindow 插件在弹出窗口中显示表单。提交后如何关闭此窗口？ [这](http://rip747.github.com/popupwindow/)是我正在谈论的链接。我可以在小狗窗口中打开一个链接。但提交后我希望它在其父窗口中打开。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-05T09:24:38.173

您可以在弹出页面中将行为附加到您的链接：

```
<a href="javascript: self.opener.location = 'http://somewhere.ltd/path/to/dir'; self.close();">
     Let's go Somewhere
</a> 
```

此外，我建议您以[不显眼的方式使用 Javascript，](http://en.wikipedia.org/wiki/Unobtrusive_JavaScript)而不是使用上面的简单行。

关于“淡出”操作；您不能使用 Javascript（无论如何）对操作系统窗口做这样的事情。

**更新：**假设表单具有 id 属性`theChildForm`并使用 jQuery：

```
$("#theChildForm").submit(function() {
     // TODO: Some data keeping jobs to be done
     // Pass the url if needed
     self.opener.location = 'http://somewhere.ltd/path/to/dir';
     self.close();
     // ...
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T08:32:22.620

使用[Ibox](http://www.ibegin.com/labs/ibox/)或[DHTML 窗口](http://www.dynamicdrive.com/dynamicindex8/dhtmlwindow.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T08:33:15.410

也许你应该使用这个属性：

```
window.opener 
```

opener 属性对应于打开窗口的窗口。当被子窗口访问时，它返回父窗口。

# jquery - 如何为 jQuery 内联 datePicker 设置默认日期？

> ID：718599
> 
> 赞同：5
> 
> 时间：2009-04-05T08:52:22.307
> 
> 标签：jquery, datepicker

我正在使用这个[jQuery 内联 datePicker](http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/inlineDatePicker.html)插件示例，但我不知道如何设置选择的默认日期。你有什么主意吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-08-31T21:37:42.790

```
$('.date-pick').datePicker({
    defaultDate: $.datepicker.parseDate("d m y", "31 8 2009")
}) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-03-16T08:43:17.977

您将需要使用该`dpSetSelected`方法。我已将其添加到下面示例页面的代码中：

```
$(function()
{
    $('.turn-me-into-datepicker')
        .datePicker({inline:true})
        .dpSetSelected('01/04/2010') // The string should be in Date.format
        .bind(
            'dateSelected',
            function(e, selectedDate, $td)
            {
                console.log('You selected ' + selectedDate);
            }
        );
}); 
```

如前所述，如果您[更改了 Date.format](http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/datePickerDateFormat.html) ，那么您将需要确保字符串采用您更改为的格式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-05T08:54:58.463

这里：[http ://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/datePickerDefaultToday.html](http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/datePickerDefaultToday.html)

```
$(function() {
     var date = new Date(); // replace with your date
     $('.date-pick').datePicker().val(date.asString()).trigger('change');
}); 
```

### 或者

在您的字段中设置日期：

```
<input class="date-pick" type="text" value="1/1/2009" /> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-03T05:43:45.840

您可以简单地设置该输入框的值，例如 $('#date-picker').val('22 Jun 2015');

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-19T17:58:16.450

```
$("selector").datepicker('setDate', 'today'); 
```

设置 UI 小部件和“输入”元素。

# c# - C# 字典<> 缺少键

> ID：718610
> 
> 赞同：2
> 
> 时间：2009-04-05T09:03:10.893
> 
> 标签：c#, .net, dictionary, delegates, keynotfoundexception

当我执行 val = dict["nonexistent key"] 时，我得到 System.Collections.Generic.KeyNotFoundException 有没有办法让我的字典以键作为参数调用成员函数来生成值？

-edit- 也许我应该更具体。我想自动调用一个成员函数来做它需要为该键创建正确的值。在这种情况下，它会在我的数据库中创建一个条目，然后将其独特的句柄返回给我。我将在下面发布我的解决方案。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-05T09:07:14.660

使用扩展方法：

```
static class DictionaryExtensions {
   public static TValue GetValueOrDefault<TKey, TValue>(this Dictionary<TKey,TValue> dic, TKey key, Func<TKey, TValue> valueGenerator) {
      TValue val;
      if (dic.TryGetValue(key, out val))
         return val;
      return valueGenerator(key);
   }
} 
```

您可以使用以下命令调用它：

```
dic.GetValueOrDefault("nonexistent key", key => "null"); 
```

或者传递一个成员函数：

```
dic.GetValueOrDefault("nonexistent key", MyMemberFunction); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-05T09:07:36.843

```
Object value;
if(dict.TryGetValue("nonexistent key", out value))
{
    // this only works when key is found..
}
// no exception is thrown here.. 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-06T09:46:54.167

顺便说一句，您所说的技术称为[记忆化](http://en.wikipedia.org/wiki/Memoization)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-05T10:07:38.883

TryGetValue() 很好。如果您不受性能限制或不需要该值，也可以使用 ContainsKey()。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-05T15:18:49.697

```
 string Q = "nonexistent key";
    string A = "";

    if(dict.containskey(Q))
    {
        A= dict[Q];
    }
    else
    {
       //handler code here
    } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-05T15:26:12.487

```
if(myDictionary.ContainsKey("TestKey") 
{       
  System.Print(myDictionary["TestKey"]); 
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-06T09:34:19.220

```
public class MyDictionary<K, V>
{
    Dictionary<K, V> o = new Dictionary<K, V>();
    public delegate V NonExistentKey(K k);
    NonExistentKey nonExistentKey;
    public MyDictionary(NonExistentKey nonExistentKey_)
    {   o = new Dictionary<K, V>();
        nonExistentKey = nonExistentKey_;
    }

    public V this[K k]
    {
        get {
            V v;
            if (!o.TryGetValue(k, out v))
            {
                v = nonExistentKey(k);
                o[k] = v;
            }
            return v;
        }
        set {o[k] = value;}
    } 
```

}

# javascript - CSS 注入：可能发生的最坏情况是什么？

> ID：718611
> 
> 赞同：29
> 
> 时间：2009-04-05T09:05:36.393
> 
> 标签：javascript, css, security

我们正在进行安全评估。

恶意用户有可能将任意 CSS 注入到另一个用户的网页中，尽管我们不确定它是否真的可以被利用。

我知道他可以完全改变页面外观，甚至根本不显示任何内容。这就是全部？可能发生的最坏情况是什么？JavaScript 可以嵌入到 CSS 中吗？他可以“窃取”其他用户的 cookie 吗？并启动另一个会话？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T17:06:42.127

是的以上所有。注入任意 CSS 会导致 javascript 执行。看着：

*   [XSS 备忘单](http://ha.ckers.org/xss.html)

可能发生的最糟糕的事情取决于环境。在某些情况下，窃取会话 cookie 并访问用户会话可能是最糟糕的事情（例如，银行、在线股票交易），您的情况可能并非如此。其他攻击示例包括获得对浏览器的控制权、获得对客户端计算机的访问权限等。

# java - Java中的日期算术，从今天开始加3个月

> ID：718617
> 
> 赞同：9
> 
> 时间：2009-04-05T09:10:53.543
> 
> 标签：java, date, calendar

我的计划是关于生成（生产）一个黑泽明并让客户生产它。

每次我们生成一个 Kurosawa 时，我们都必须打印它的 id、它的生产日期和有效期，即生产日期后的 3 个月。

我的问题是：*如何计算 3 个月后的日期？*

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-05T10:02:01.547

使用内置的[Java 日历 API](http://java.sun.com/javase/6/docs/api/java/util/Calendar.html)。

```
Calendar c = Calendar.getInstance();
c.add(Calendar.MONTH, 3); 
```

请参阅 API 以了解如何以您正在寻找的格式打印出日期。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-05T10:18:31.680

您还可以使用功能更强大且更易于使用的[Joda Time Library](http://joda-time.sourceforge.net/)：

```
DateMidnight productionDate = new DateMidnight();
DateMidnight expirationDate = productionDate.plusMonths(3);
System.out.println(expirationDate.toString("dd.MM.yyyy")); 
```

与内置的[Java 日历 API 相比，Joda Time 有很多优势。](http://java.sun.com/javase/6/docs/api/java/util/Calendar.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-01-26T06:46:29.323

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-05T09:58:40.090

我相信[Java 日历库](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Calendar.html)应该对您有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-05T18:07:46.810

如果您需要使用日期算术，JODA 会更好，因为 Calendar 喜欢时间戳。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-03-14T23:51:08.787

/ *java 类 Calendar 是抽象的。所以你需要使用 GregorianCalendar 类。*/

```
java.util.GregorianCalendar gC = new java.util.GregorianCalendar();

java.util.Date yourDate = new java.util.Date();
gC.setTime(yourDate); 
```

/*增加 3 个月*/

```
gC.add(java.util.Calendar.MONTH_OF_YEAR, 3); 
```

/*回到 1 周*/

```
gC.add(java.util.Calendar.WEEK_OF_YEAR, -1); 
```

# c# - 返回 IQueryable 或不返回 IQueryable

> ID：718624
> 
> 赞同：73
> 
> 时间：2009-04-05T09:15:58.287
> 
> 标签：c#, .net, linq-to-sql, iqueryable

我有一个将我的 LINQ to SQL Data Context 包装起来的存储库类。存储库类是包含所有数据层逻辑（以及缓存等）的业务线类。

这是我的 repo 界面的 v1。

```
public interface ILocationRepository
{
    IList<Location> FindAll();
    IList<Location> FindForState(State state);
    IList<Location> FindForPostCode(string postCode);
} 
```

但是为了处理 FindAll 的分页，我正在讨论是否公开 IQueryable<ILocation> 而不是 IList 以简化分页等情况的接口。

从数据仓库中公开 IQueryable 的优缺点是什么？

很感谢任何形式的帮助。

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2009-04-05T09:20:10.650

优点；可组合性：

*   来电者可以添加过滤器
*   来电者可以添加寻呼
*   调用者可以添加排序
*   ETC

缺点；不可测试性：

*   您的存储库不再是可正确进行单元测试的；你不能依赖a：它工作，b：它做**什么**；
    *   调用者可以添加一个不可翻译的函数（即没有 TSQL 映射；在运行时中断）
    *   调用者可以添加一个过滤器/排序，使其像狗一样执行
*   由于调用者希望`IQueryable<T>`是可组合的，因此它排除了不可组合的实现 - 或者它迫使您为他们编写自己的查询提供程序
*   这意味着您无法优化/分析 DAL

为了稳定性，我已经采取**不**公开`IQueryable<T>`或不公开`Expression<...>`我的存储库。这意味着我知道存储库的行为方式，并且我的上层可以使用模拟，而不必担心“实际的存储库是否支持这个？” （强制集成测试）。

我仍然在存储库中使用*etc*`IQueryable<T>` -但不是超出边界。我在[这里发布了关于这个主题的更多想法](http://marcgravell.blogspot.com/2009/02/pragmatic-linq.html)。将分页参数放在存储库界面上同样容易。您甚至可以使用扩展方法（在接口上）添加*可选*的分页参数，这样具体类只有 1 个方法可以实现，但调用者可能有 2 或 3 个重载可用。

 *** * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-05T09:20:28.480

**正如前面的答案所提到的，公开 IQueryable 可以让调用者访问 IQueryable 本身，这可能会变得危险。**

封装业务逻辑的首要职责是维护数据库的完整性。

您可以继续公开 IList 并且可能会更改您的参数如下，这就是我们正在做的......

```
public interface ILocationRepository
{
    IList<Location> FindAll(int start, int size);
    IList<Location> FindForState(State state, int start, int size);
    IList<Location> FindForPostCode(string postCode, int start, int size);
} 
```

如果 size == -1 则返回所有...

**另一种方式...**

如果您仍想返回 IQueryable，那么您可以在函数内返回 List 的 IQueryable.. 例如...

```
public class MyRepository
{
    IQueryable<Location> FindAll()
    {
        List<Location> myLocations = ....;
        return myLocations.AsQueryable<Location>;
        // here Query can only be applied on this
        // subset, not directly to the database
    }
} 
```

第一种方法比内存有优势，因为您将返回更少的数据而不是全部。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-05T09:17:35.117

我建议使用`**IEnumerable**`而不是`**IList**`，使用它您将拥有更大的灵活性。

这样，您将能够从 Db 中仅获取您真正要使用的那部分数据，而无需在存储库中完成额外的工作。

### 样本：

```
// Repository
public interface IRepository
{
    IEnumerable<Location> GetLocations();
}

// Controller
public ActionResult Locations(int? page)
{
    return View(repository.GetLocations().AsPagination(page ?? 1, 10);
} 
```

这是超级干净和简单。

# c# - 不可为空的类型

> ID：718630
> 
> 赞同：14
> 
> 时间：2009-04-05T09:20:20.587
> 
> 标签：c#

有没有办法在 C# 中创建一个不可为空的类型（如 DateTime 或 TimeSpan）。？

还有一种方法（可能是一个属性）来强制非空参数不会在不添加的情况下传递给方法和属性

```
if(arg1 == null)
{
   throw new ArgumentNullException("this attribute is null")
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-05T09:23:58.533

`DateTime`并且`TimeSpan`不可为空，因为它们是`struct`s 而不是`class`es。

至于你的第二个问题，在 C# 中没有标准的方法可以做到这一点。您可以使用 PostSharp，它是一个 AOP 框架，或者使用[Spec#](http://research.microsoft.com/SpecSharp)，它是一种全新的语言（C# 的扩展），它允许一些所需的行为。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-05T09:29:35.620

在 .NET 4.0 / C# 4.0 中，您通过代码合同引用的空值检查会更容易，这几乎可以满足您的需求。

结构已经是不可为空的，但不要疯狂地创建自己的结构——你很少需要它们（类**更**常见）。没有“不可为空的类”的真正概念；人们*提出了*语法更改，例如：

```
void Foo(string! arg1) {...} 
```

这将使编译器进行非空检查`arg1`- 但实际上，代码合同会执行此操作以及更多操作。您可以在 PostSharp 中做一些事情，但可能不值得这么麻烦。

关于不可空类的另一种想法（以及它们未实现的原因之一）；`default(T)`不可为空的类是什么？;-p 规范*要求*明确`default(T)`...

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-05T09:22:21.190

不可为空的类型是 ValueType，也就是结构。结构不能为空，因此示例如下：

```
public struct MyStruct {} 
```

没有内置方法可以确保不将 null 作为参数传递给方法（除非参数的类型是 ValueType）。我见过人们创建扩展方法来对参数是否为空进行更简单的（即更少的代码）断言，这可能是您的选择。另一方面，检查开始时很短；并且检查的意图非常明确。如果您使用自定义检查方法，情况可能并非如此。

C# 4.0 将为通过合同进行此类编程添加更好的选项，但尚不可用。正如在另一个答案中指出的那样，[PostSharp](http://www.postsharp.org/)是做你想做的事的一种选择。PostSharp 通过添加一个添加额外代码的编译后步骤来工作。

但是，有一些选项可以静态检查是否可以传递 null。例如，ReSharper 允许您使用 [NotNull] 属性装饰自己的方法参数，如果 ReSharper 可以确定参数可能为空，它将在编译时发出警告。当然，这只会警告您（可能）不好的编码实践，它不是运行时检查，不应该这样使用。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-08-24T13:51:23.410

你是对的：与 C++ 相比，这是 C# 的一个缺点。这是一种耻辱，因为我传递给函数的所有参数中有 95% 是非空指针。在 C++ 中，您可以添加经过编译器检查的文档，以指示确保哪些指针指向某物。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-03-23T17:48:42.133

除了提到的 AOP 解决方案之外，Enterprise Library 在他们的验证块中提供了这个。 [http://msdn.microsoft.com/en-us/library/ff953182(v=pandp.50).aspx](http://msdn.microsoft.com/en-us/library/ff953182(v=pandp.50).aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-05T09:23:29.113

结构（值类型）变量永远不会为空 - 这解释了您的 DateTime 案例。因此，如果您的方法参数是 C# 结构，您可以确定它们永远不会为空。
但是，如果您的方法参数是引用类型，它们可以为空。我认为在这种情况下，您不能像上面显示的那样取消空检查。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-07-24T00:13:57.107

至于第二个问题，这里有一个灵感来自`Nullable<T>`.

带有空检查参数的方法如下所示：

```
void Foo(NotNull<string> s)
{
    var x = $"{s}";
    var i = int.Parse(s);
} 
```

的使用`NotNull<T>`不限于方法参数。如果该语言将来有一些语法糖，那当然会很好，例如`Foo(string! s)`.

```
public struct NotNull<T> where T : class
{
    private T valueField;

    public NotNull(T value)
    {
        this.valueField = value;
        this.CheckNotNull(value);
    }

    public T Value => this.valueField;

    public static implicit operator T(NotNull<T> t)
    {
        return t.Value;
    }

    public static implicit operator NotNull<T>(T t)
    {
        return new NotNull<T>(t);
    }

    public override bool Equals(object other)
    {
        return this.Value.Equals(other);
    }

    public override int GetHashCode()
    {
        return this.Value.GetHashCode();
    }

    public override string ToString()
    {
        return this.Value.ToString();
    }

    private void CheckNotNull(T value)
    {
        if (value == null)
        {
            throw new InvalidOperationException($"Value cannot be null");
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-07-08T11:09:42.027

当然，您可以编写自己的不能为空的值类型（`enum`和）（除非设为可空）。`struct`

至于第二部分，你可以有一个泛型参数和一个只接受值类型的约束，这意味着参数不能为空——考虑到我们使用的绝大多数情况，这不是很有用`class`。

```
public static void Do<T>(T arg1) where T : struct
{
    //both struct and enum goes here.
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-05-07T06:45:53.330

根据 Anders Hejlsberg 在 Microsoft Build 2019 中的演讲，C# 8.0 将具有不可为空的类型。 [https://mybuild.techcommunity.microsoft.com/sessions/77385?source=sessions](https://mybuild.techcommunity.microsoft.com/sessions/77385?source=sessions)

# php - 我在哪里可以找到一些好的教程来学习面向对象的编程，尤其是 php？

> ID：718632
> 
> 赞同：1
> 
> 时间：2009-04-05T09:21:04.190
> 
> 标签：php, oop

我一直在寻求改善我的编程习惯，我听说 OO 是要走的路。此外，我更喜欢在线教程而不是书籍。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-05T09:48:55.713

学习如何使用类、方法和属性不足以使您成为一个优秀的面向对象程序员。另一个（通常更困难）的部分是理解如何以面向对象的方式解决问题。

这有点像国际象棋：即使您已经完美地记住了规则，但这并不意味着您自动成为一名优秀的国际象棋棋手。您仍然需要学习有关策略并收集大量经验。

我还没有找到一个关于如何成为一个优秀的面向对象程序员的好的网络教程。该主题太大，无法仅在几个网页中涵盖。您最好阅读有关该主题的书。它甚至不必特定于 php，大多数 OO 原则可以应用于许多不同的 OO 语言。

一旦你学习了 OO 编程的基础知识，我还建议阅读一本关于设计模式的书，比如 Gamma 等人的经典[设计模式](http://www.amazon.co.uk/Design-patterns-elements-reusable-object-oriented/dp/0201633612/ref=sr_1_1?ie=UTF8&s=books&qid=1238931499&sr=1-1)。或者更随意的[Head-First Design 模式](https://rads.stackoverflow.com/amzn/click/com/0596007124)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-05T10:07:48.787

以下是 PHP 人员自己提供的一些很好的教程。

*   [PHP 101（第 7 部分）：熊的必需品](http://devzone.zend.com/node/view/id/638)
*   [PHP的OO演进](http://devzone.zend.com/article/1717-The-OO-Evolution-of-PHP)
*   [使用对象创建应用程序](http://devzone.zend.com/article/1240-Using-Objects-to-Create-an-Application)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-05T11:17:04.160

*   [OO 技巧](http://www.ootips.org/)
*   [PHP 类](http://www.phpclasses.org/)
*   [PHP 中的 OOP](http://www.devarticles.com/c/a/PHP/Object-Oriented-Programming-in-PHP/)
*   当然还有[谷歌](http://www.google.com/search?q=object%20oriented%20programming%20using%20php&hl=en&safe=off&client=firefox-a&rls=org.mozilla:en-US:official&hs=qGl&start=70&sa=N&cts=1238930053986)！

*OO 不是依赖于语言的概念。*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-05T11:10:30.243

Неге 是一本很好的书，它在实践中展示了 OOP。您可以从网站下载资源并查看这本书的内容。

[http://objectorientedphp.com/](http://objectorientedphp.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-05T09:31:39.170

[PHP 类和对象](http://php.net/zend-engine-2.php)手册页是一个很好的起点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-05T09:46:41.070

[尽管陪审团对认证不感兴趣，但您可能比参加Zend 课程](http://www.zend.com/en/services/certification/php-5-certification/)做得更糟。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-05T10:26:21.927

不要对 Php 刻薄，因为快速完成工作非常好，但是面向对象的 Php 在我的书中不是一个特性，使用 Php 作为过程语言会更有效率，毕竟它就是为此而生的，与其他语言相比，OOP 相当差，同样我也不会将 OOP 与 Perl 一起使用，如果你想学习 OOP，我完全建议你使用 Ruby 或 Objective-C。

无论如何都无法链接，但请尝试使用谷歌搜索 OMG（对象管理组），他们的网站上有关于 OOP 的教程和信息

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-05T11:03:53.067

有些人推荐 Manning 的“ [PHP in action](https://rads.stackoverflow.com/amzn/click/com/1932394753) ”。

# fluent-nhibernate - NHibernate.MappingException：未知的实体类

> ID：718634
> 
> 赞同：0
> 
> 时间：2009-04-05T09:22:01.893
> 
> 标签：fluent-nhibernate

我正在尝试运行使用 FluentNHibernate 映射我的实体的测试。

我收到未知实体类错误。

我有一个域项目，在该项目的单独文件夹中包含我的实体和映射。

我的测试项目在 App.Config 中有 Nhibrenate 配置。

请问有什么想法？？？

马尔科姆

编辑：我有这个创建 ISessionFactory 的方法，但我认为这段代码不起作用，这就是为什么它根本无法识别我的映射存在。SessionFaboryCreator 是我的 AppConfig 的程序集，Recipe 是我的域对象所在的程序集。请HELLLLLLP！！！！

```
public static ISessionFactory Create()
        {
            Configuration cfg = new Configuration()
                .AddAssembly(typeof(SessionFactoryCreator).Assembly)
                .AddAssembly(typeof(Recipe).Assembly);

            return cfg.BuildSessionFactory();
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-05T09:26:56.950

如何将实体添加到 Hibernate 框架？您使用的是 AnnotationConfiguration 还是仅使用 Configuration？如果您使用注释，则必须将带注释的实体添加到框架中。否则，如果您使用 xml hibernate 映射，则语法可能会磨损（iirc）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-06T10:08:46.313

你读过[维基](http://wiki.fluentnhibernate.org)吗？您的示例没有显示将 Fluent NHibernate 连接到会话工厂建筑中，这就是它不起作用的原因。从[入门指南开始](http://wiki.fluentnhibernate.org/show/GettingStarted:+Introduction)。

# ruby-on-rails - Ruby on Rails 有哪些最酷的功能，为什么选择它？

> ID：718638
> 
> 赞同：6
> 
> 时间：2009-04-05T09:22:53.763
> 
> 标签：ruby-on-rails, ruby

在我问这个问题之前，我在 SO 上查看了“Ruby on Rails”的搜索结果。找不到太多，但以下（[在此页面上找到](https://stackoverflow.com/questions/142470/what-are-the-main-differences-between-the-popular-web-frameworks)）让我很开心

> 就个人而言，我开始使用 .html，转向 php，尝试了 ruby​​（讨厌它），发现了 Python / DJango.. 并且一直很开心。

现在这是交易。我个人还没有学习 Ruby on Rails 的打算，但这是我在 Uni 的小组演讲的主题（我的伙伴们选择了 RoR 主题）。对学生提出家庭作业类型的问题怀恨在心的人应该立即离开。

这个问题是为那些觉得它很棒的 RoR 人准备的。我希望找到那些声称 RoR 是最好的人（在 RoR 网站上可以找到令人惊叹的推荐的作者）。是什么让 RoR 如此出色？您希望今天的年轻人在他们离开大学获得学位之前了解它吗？尝试提出一些可以在他们心中扎根的建议，并在离开 Uni 后以 RoR 的方式引导他们。

您的回答不仅有助于我的演讲，而且可能成为许多人的启蒙之源。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-06T15:57:41.823

*   ActiveRecord 的动态查找器：

    ```
    Person.find_by_name_and_company_id('Jorge Luis Borges', 42) 
    ```

*   rjs，用 ruby​​ 编写 javascript：

    ```
    page['element_id'].insert_html :bottom, :partial => 'comment' 
    ```

*   ActiveRecord 的作用域

    ```
    class Shirt < ActiveRecord::Base
      named_scope :red, :conditions => {:color => 'red'}
      named_scope :dry_clean_only, :joins => :washing_instructions, :conditions =>  ['washing_instructions.dry_clean_only = ?', true]
    end 
    ```

调用 Shirt.red 将使用 "color = 'red'" 条件查询数据库，很酷的部分是，如果您组合多个范围，例如：

```
 Shirt.red.dry_clean_only 
```

它将只构建一个查询，其中包含满足两个范围所需的所有条件和连接。

*   ActiveRecord 的迁移，能够使用活动记录管理数据库结构和数据，就像在应用程序的代码中一样，使用最少的 sql。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-15T01:38:45.127

工具是关于解决问题的。无论您是在谈论木工车间还是程序员车间的工具都没有关系。Rails 给我留下深刻印象（现在仍然如此）的是，它是从用于构建现实世界 Web 应用程序的框架中提取出来的，并且在使用它来构建现实世界 Web 应用程序之后，人们对其进行了扩展或更改，并不断对其进行改进。这不仅仅是学术活动。

它解决的一些具体问题：

*   快速入门。如果您希望快速启动 Web 应用程序，那么您还有什么比指定现有目录结构（基于 MVC）的框架更好的选择，该框架具有大量代码生成器，并且已经为您预先做出选择组件，例如 JavaScript 库、测试支持、ORM 等。您可能不同意所有选择，但您可以假设它们并拥有适用于 80% 或更多项目的东西，如果您有偏好，以后可以换掉一些东西。

*   长期可维护性。迁移为您提供了在代码更改时向前移动数据的方法，这在任何实际应用程序中都会发生，但大多数框架根本没有考虑到这一点。将应用程序的所有部分分离到已经设置的目录层次结构中，其中包含用于测试、数据库、配置等的区域，这再次有助于项目的长期维护。

*   减少人为错误。配置文件为您提供了额外的人为错误机会。逻辑约定一旦学会就可以避免诸如经典的错误输入文件名或配置文件中的类名错误之类的错误。

*   承认不同的发展模式。Rails 已内置支持为开发、测试和生产设置不同设置的想法。真正的应用程序也有这种情况，但它们周围的框架通常不适应它，您最终不得不交换配置文件来实现相同的效果（参见上面的人为错误）。

*   良好做法。我上面提到的几件事包含并鼓励良好的编程实践（MVC、标准化项目布局等），但 Rails 通常明确地鼓励它们，而不仅仅是隐含的。为了证明这一点，您只需看看它对测试驱动开发的内置支持。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-05T10:41:12.607

三年前，我在博客中详细介绍[了我为什么喜欢 Rails ，但对我来说，第一个很酷的特性是它使开发 Web 应用程序变得简单而有趣。](http://www.johntopley.com/2006/06/08/going-on-the-rails/)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-05T10:06:00.633

举几个项目：

*   大型开发者社区（不是说 python 没有）
*   关于配置岩石的约定
*   可以与 JRuby/Warbler 一起使用，以使 rails 在 Java 应用程序服务器上运行。在尝试将 Enterprise 拖入 21 世纪时非常重要（Django 可以与 Jython 一起使用以处理应用程序服务器，但还不够成熟）。
*   MVC 框架有助于保持您的应用程序结构化。
*   脚手架和发电机让您的项目动起来。

Rails 并不试图成为开发 Web 应用程序的唯一方式，这不是本意。它满足了一组特定的需求。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-05T18:06:19.027

这不是与 Python 的比较——它是我喜欢的东西的一般列表。

*   我写的代码比用 Java 写的少得多
*   ...而且我做对的代码非常可读和可维护
*   我很少需要考虑一些代码在哪里或者如何处理一个常见的任务——它只是有它的位置（例如迁移是内置的）
*   您最终不会在一个项目中使用多种不同的技术（Java、EJB、Hibernate、JSP、SQL DDL、Ant、XML、taglibs）
*   解释而不是编译为您节省了大量的开发时间

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-15T00:56:38.893

对我来说，主要原因之一是它让 Web 编程重新获得乐趣。突然间，事情变得简单而触手可及。您不需要数月的代码处理，也不需要编写大量代码。你可以用几行代码做一些非常了不起的事情。

而且感觉很好:)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-05T18:17:07.347

老实说，我更喜欢 Django 的设计而不是 rails，但我更喜欢 ruby​​ 而不是 python。这是个人的事情，因为我知道很多人有相反的看法，但我发现 ruby​​ 是我用过的最优雅的语言之一。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-05T17:49:04.780

我使用 Rails 的主要动机是 ruby​​。在我发现 ruby​​ 之前，我接触了很多语言，但我从来没有觉得自己擅长任何一种语言。当我遇到红宝石时，一切都变得有意义。这是一门美丽的语言；易学难精。

我使用 rails 是因为它适合我作为 web 开发人员的需求并且功能非常丰富。

# model-view-controller - 计算值在 MVC 模式中属于哪里？

> ID：718649
> 
> 赞同：0
> 
> 时间：2009-04-05T09:34:46.480
> 
> 标签：model-view-controller

在我正在构建的应用程序中，我有一个用户的概念。

在应用程序中，用户有个人资料页面。

这些很简单。它们基本上就像 /profile?id=3 或其他什么，其中 3 是我想查看其个人资料的用户的用户 ID。

将 url_for_profile 方法添加到 User 模型是否有意义，或者我应该查看用户配置文件 URL 还是完全做其他事情？

有很多不同的方法都可以，但我很好奇这里什么被认为是最佳实践。

感谢您的建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T09:50:42.230

这取决于哪个层决定 url 是什么。

如果 url 是由模型层出于某种原因定义的（客户端-服务器应用程序需要偶尔引用网站），那么模型对象应该具有检索配置文件 url 的方法。

如果 url 纯粹是表示层的概念（模型只是提供用户数据本身的网站），那么它是由控制器层做出的决定。如果是这种情况，创建一个 UrlFactory 或类似的东西可能是有意义的，您可以向它提供用户 ID，它将生成相应的配置文件 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T10:12:51.350

还建议使用 url_for_profile ，因为明天如果您想缓存配置文件并且当用户数量变得非常高时，您可能需要对您的应用程序进行集群，那时这种方法会很有用。

尽管您可能会创建不同的视图，但隐式处理 url 可能会在较长时间内产生问题，随着项目和数据库的增长，理解和管理正在发生的事情变得太困难了。所以即使你正在创建一个新视图，你仍然应该有 url_for_profile，它可以用于集群。如果您注意到，microsoft 的每个链接都有这种格式... go.microsoft.com/linkID=XXXXXXX ，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T10:27:33.310

我在您的要求中看不到任何内容表明用户需要知道 URL 是什么。如果您实现此方法，则意味着您最终可能会得到诸如 Order.url_for_order 或 Cart.url_for_cart 之类的东西。如果您想更改指定 URL 的方式，则必须更改所有类。最好让系统中的所有对象都有一个 ID 和一个 View 帮助器类，该类具有如下方法： URLHelper.url_for_object(myobject)

您绝对需要做的是将模型中的对象与它们的定位方式隔离开来，并将定位留给您正在使用的 Web 框架。一般的最佳实践是每个类都指定一个 ID，并且 Web 基础设施中的处理程序取决于它呈现的类。它通过传递给它的 ID 检索类。

所以你看到依赖是一种方式。View 类依赖于底层模型，但模型不依赖于它的位置。如果您随后想要缓存对象，您可以在视图层实现这一点，同样，底层对象不知道或不依赖于它是否被缓存。

# algorithm - 如何在 O(n) 时间内遍历二叉树而不需要额外的内存

> ID：718650
> 
> 赞同：6
> 
> 时间：2009-04-05T09:35:12.190
> 
> 标签：algorithm, data-structures, binary-tree

给定一棵具有整数、左右指针的二叉树，如何在 O(n) 时间和 O(1) 额外内存（无堆栈/队列/递归）内遍历树？

[这个人](http://nandacumar.blogspot.com/2006/06/traversing-tree.html)给出了一个不是 O(n) 总时间的解决方案，它将当前路径编码为一个整数（因此适用于深度有限的树）。

我正在寻找经典的解决方案

（剧透）

对子节点中每个节点的父节点进行编码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-05T09:47:03.440

任何好的算法书都会有这个算法，例如看 Knuth（TAOCP I.2.3.1 遍历二叉树，练习 21）。但是，由于此算法会就地修改树，因此在多线程环境中必须*格外小心。*

您也可以使用线程树（参见 Knuth）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-07T06:05:51.880

主要思想类似于列表反转算法，基于指针（在人类目前已知的所有语言中）0 模式这一事实，有一个超级丑陋的技巧（从理论的角度来看，可能是作弊） 4 作为整数。

这个想法是，您可以将路径上的指针翻转到树下以指向上方。问题是——这就是你从列表反转算法转移的地方——当你回溯时，你需要知道是左指向上还是右指向上；此时我们使用 hack。

伪代码如下：

```
current = root->left
next = current
while (current != null) {
  next = current->left
  current->left = static_cast<int>(prev) + 1 // ugly hack.
  current = next
}
status = done
while (current != root or status != done) {
  if (status = done) {
     if (static_cast<u32>(current->left) %4 = 1) {
         next = static_cast<u32>(current->left) -1
         current->left = prev
         status = middle
     }
     else {
         next = current->right
         current->right = prev
         status = done
     }
     prev = current
     current = next
  }
  else if (status == left) {
     if (current->left) {
       prev = current->left
       current->left = static_cast<u32>(next) +1
       next = current
     }
     else
       status = middle
  }
  else if (status == right) {
     if (current->right) {
        prev = current->right;
        current ->right = next;
        next = current
     }
     else
       status = done
  }
  else {// status == middle
     work_on_node(current)
     status = right
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-06T03:17:28.423

那家伙的算法很有趣，但需要指出的是，它确实需要 O(log n) 额外*的*空间来遍历具有 n 个节点的二叉树。空间需求必须以位而不是字节来衡量——通常在使用 Big Oh 表示法时它们会合并为同一事物，但是像这样的案例指出了为什么区分很重要。

要了解这一点，请询问如何使用单个整数存储（在 32 位平台上）遍历具有超过 2^32-1 个节点的树。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-06T12:14:34.420

使用 O(1) 存储来记住“最后访问的节点”指针。您可以将其初始化为 0 或某个未知值。

要遍历树，请从根节点开始。查看节点的两个子节点。如果您的“最后访问节点”等于 RIGHT 节点，则进入父节点。如果“最后访问”等于 LEFT 节点，则跳到右节点。其他步骤到左侧节点。

重复直到你走完整棵树。唯一真正的聪明之处是使用一个变量来记住你来自哪里，以便决定下一步去哪里。这使得遍历具有确定性。

你最终会采取 O(n) 步骤。您将访问每个中间节点 3 次，每个叶子访问一次，所以您仍然是 O(N)。存储是 O(1)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-09-12T15:41:15.480

这是另一个解决方案

[http://sites.google.com/site/debforit/efficient-binary-tree-traversal-with-two-pointers](http://sites.google.com/site/debforit/efficient-binary-tree-traversal-with-two-pointers)

但我想知道是否有一种方法可以在像 Java 这样没有真正意义上的指针的语言中做到这一点。

# c++ - 当我将它添加到指针时，我可以安全地忽略溢出检查的最小偏移量是多少？

> ID：718651
> 
> 赞同：0
> 
> 时间：2009-04-05T09:35:15.857
> 
> 标签：c++, c, pointers, overflow

我是否可以期望用户空间程序中的任何“数据”指针与地址 0 和 0xffffffff... 保持安全距离，以便我可以安全地为指针添加一个小偏移量而不检查溢出？当 p 是指向常量字符缓冲区或动态分配字符串的 char 指针（在现代 >= 32 位操作系统上）时，我可以安全地假设 p + n 不会溢出的最大正 n 是多少？

为避免混淆：我说的是*溢出检查，而不是边界检查*。例如：如果您有一个指针 p 指向具有 m 个字符的字符串的开头，并且您想在正偏移量 i 处访问该字符，那么您需要检查 i < m 或者您可以间接检查 p + i < p + 米。但是，在后一种情况下，您还必须确保 p + i 不会溢出，即您必须确保 p + i >= p。

更新：好的，如果 i > m，p + i 不是有效的标准 C，无论 p + i 是否实际取消引用或是否溢出。但是，我真正感兴趣的问题是是否存在一个小的 n ，而 p + n*在实践中*不会溢出。回答这个问题显然需要一些关于现代操作系统如何组织地址空间的知识。

更新 2：听到任何一个特定平台已经很有趣了，即使它不是通用的。最好不是一些晦涩难懂的嵌入式。x86 或基于 Power 的 32 位 Win、Linux 和 Mac 将是最有趣的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-05T09:42:59.987

您可以安全地添加到指针（然后取消引用它）的唯一偏移量是将指针定位在您正在使用的内存块中的偏移量。此块必须已使用 new 或 malloc 分配，或者存在于堆栈中。

无论哪种方式，都可以保证内存存在（并且超过内存末尾的地址是一个合理的地址），否则如果您尝试错误，您将收到来自 new 的异常、来自 malloc 的 NULL 指针或未定义的行为在栈上分配。在任何情况下，您都不必检查溢出。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-05T09:42:38.210

严格来说，答案是 0，因为`p`可能已经指向数组末尾之后的一个，这就是标准所说的有效。

在特定的实现中，您可能能够摆脱一些量，但这完全是实现定义的。已经有硬件检查 CPU 指令中指针的操作，也许现在仍然存在：如果`p`指向一个 2 个整数的数组，这样做`p+3`会导致 CPU 执行指令失败。另一方面，在大多数当前的硬件上，你可以摆脱很多。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-05T11:23:32.523

根据您提供的信息，答案是 0。**根据 C++ 标准**，0 是唯一有效的答案。

如果您愿意冒险尝试未定义的行为（提示：不要），您必须向我们提供一些特定于平台的信息**，并**告别**任何**有关应用程序状态有效性的保证。您的应用程序可能仍在运行，但您依赖于操作系统和编译器编写者做出的任意且可能不断变化的决策。

如果我们知道您的平台的确切细节（主要是哪个 CPU、操作系统、哪个编译器），那么只要编译器或操作系统没有任何变化，就有可能给您一个*通常可行的答案。*

但似乎你正在以错误的方式处理这个问题。如果这对性能至关重要，就像您一直说的那样，请*对其进行安排，以免指针溢出成为问题*。

严格来说，向指针添加*任何*使其指向之前指向的同一块内存的指针是未定义的。它可能会起作用，或者它可能在某些架构上表现得非常时髦。它可能会在意想不到的时候溢出，它可能会导致一些硬崩溃。这就是为什么该语言只是说“不允许”，以及为什么当你没有告诉我们它正在运行的平台时，我们不能说在实践中会发生什么。

C++ 指针*不是内存地址*。这就是编译器通常实现它的方式，是的，但它们遵循不同的规则。根据 CPU 指令集，有些事情对于内存地址是合法的，而对于指针是不合法的。

但说真的，我最好的建议是：退后一步，检查如何避免*需要*检查溢出。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-05T10:21:24.807

在 C 中，指针算术和相对比较仅在“对象”中定义（不要与 C++ 对象混淆）。“对象”是一个变量（任何类型）或使用 malloc/calloc/realloc 分配的内存区域。您可以计算一个指向“过去”对象的指针，这将始终在符合标准的实现中工作。

从较低级别来看，指针通常实现为（无符号）整数。整数的大小足以容纳任何内存位置的地址。指针溢出的唯一方法是超出地址空间，而这在符合 C 标准的情况下是不可能的。

但是，如果您正在编写低级代码，并且忽略指针运算仅在对象内有效的限制，那么最好的方法是利用指针如何表示的知识。在大多数现代环境中，这与使用无符号整数算术检查溢出是一样的。

（例外情况是分段内存架构、8086 或 Multics 类型，以及我可能为了保持理智而从记忆中抑制的其他东西。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-05T09:46:39.680

在我看来，这似乎非常依赖于：

*   操作系统
*   底层硬件
*   编译器

作为一项规则，并且仅据我所知，堆栈是在线性地址空间的顶部分配的。考虑到您正在运行各种运行时库，您的实际数据很可能不在该空间的顶部运行。无论哪种方式，如果您超出分配的区域，`malloc`您将遇到其他麻烦，如果您超出堆栈帧，您也会遇到麻烦。最重要的是，我认为您不必担心从 0xffffffffffffffff 到 0x0 的环绕，但您仍然必须确保不会超出静态、自动或手动分配的内存的界限。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-05T16:59:27.393

对于地址溢出，我知道用于时间训练的有用技巧也适用于您的情况。

如果您的平台是 32 位，那么每个地址都是 32 位宽（无符号长型），您可以尝试以下宏：

> #define address_after(a,b) ((long)(b) - (long)(a) < 0))
> 
> #define address_before(a,b) address_after(b,a)

然后你可以安全地比较地址为 address_after(p+i, p+m) 只有当 |mi| < 0x7FFFFFFF（这是常见的情况）。这个宏很好地处理了溢出问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-05T09:43:23.450

这取决于两件事

*   架构
*   编译器

因此，唯一可以确定的方法是查阅编译器和架构的参考文档。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-05T09:51:45.723

通常内存分配应该以块为单位进行，例如，即使你想使用 1 个字节，最小分配也应该始终是 2 的幂，例如，MFC 中的 CString 使用 128 个字节或 64 个字节，通过这样做你肯定会浪费一些空间，但也会减少计算量。如果您的分配是基于块完成的，那么您可以使用块大小和当前指针值来使用最大偏移量以避免溢出。

# .net - dll从错误的文件夹复制到输出路径

> ID：718656
> 
> 赞同：1
> 
> 时间：2009-04-05T09:42:18.583
> 
> 标签：.net, visual-studio, dll, msbuild

我的解决方案中的所有项目都有一个用于发布版本的“..\Release”输出路径和用于调试版本的“..\Debug”。

除了一个之外，所有项目都运行良好。

每当我在 Release 中构建有问题的项目时，复制到“..\Release”的 dll 来自“obj\Debug”而不是“obj\Release”。这在 VS 和通过手动运行 MSBuild 构建时都会发生，但如果我先清理“obj\Debug”文件夹就不会发生这种情况。

这是我认为相关的构建日志的一部分：

```
17>Target CopyFilesToOutputDirectory:
17>  Task "Copy"
17>    Copying file from "obj\Release\XXXXX.dll" to "..\Release\XXXXX.dll".
17>    Command:
17>    copy /y "obj\Release\XXXXX.dll" "..\Release\XXXXX.dll"
17>  Done executing task "Copy".
17>  Task "Message"
17>    XXXXX -> C:\Dev\Service\Release\XXXXX.dll
17>  Done executing task "Message". 
```

关于为什么会发生这种情况的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-02-21T21:15:28.563

我意识到该线程已得到解决，但我遇到了这个相当令人沮丧的 VS 问题（错误？）。我的解决方法是简单地将 obj\release 引用路径添加到从错误路径复制文件的项目中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T10:42:14.977

您可能想根据参考检查路径；可能是您以某种方式在 obj 文件夹中引用了它。这在 csproj 中可能比在 IDE 中更容易看到（“提示路径”或其他东西）。

# typo3 - TYPO3 TCA - 如何在没有所有接口选项的情况下使用“内联”类型

> ID：718664
> 
> 赞同：3
> 
> 时间：2009-04-05T09:48:28.600
> 
> 标签：typo3, typo3-tca

我目前正在开发一个使用 t3blog 扩展的项目。在后端，创建新帖子时，您首先输入标题，然后您必须单击“新建”才能将内容添加到帖子中。

理想情况下，客户希望删除“新建”，或者至少让它默认创建一个新的内容。

我正在研究扩展的 TCA，发现它在哪里添加了该控件，现在我有点卡住了，因为我以前没有在 TCA 中破解过，有谁知道如何修改“内联”类型的行为通过 TCA？

这是添加控件的代码。

```
'content' => Array (
        'exclude' => 1,
        'label' => 'LLL:EXT:t3blog/locallang_db.xml:tx_t3blog_post.content',
        'config' => array (
            'type' => 'inline',
            'foreign_table' => 'tt_content',
            'foreign_field' => 'irre_parentid',
            'foreign_table_field' => 'irre_parenttable',
            'maxitems' => 100,
            'appearance' => array(
                'showSynchronizationLink' => 0,
                'showAllLocalizationLink' => 0,
                'showPossibleLocalizationRecords' => 0,
                'showRemovedLocalizationRecords' => 0,
                'expandSingle' => 1
            ),
            'behaviour' => array(
            ),
        )

    ), 
```

我想要做的是删除创建的“常规”选项卡，只有“文本”选项卡。

任何提示将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T22:30:05.657

我的理解是“内联”类型是指称为“ [IRRE](http://wiki.typo3.org/Irre) ”或内联关系记录编辑的东西，这是 TCA 中一种相对较新且功能强大（按 TYPO3 标准）的数据结构。您可能会发现[TYPO3 Core API 文档的这一部分](http://typo3.org/documentation/document-library/core-documentation/doc_core_api/4.2.0/view/4/2/#id4431730)作为参考很有用。

实际上，单击执行 Ajax 调用以在后台创建新的数据库记录。然而，据我所见（使用这个插件和其他插件，如 Powermail），我怀疑是否有一种方法可以跳过额外的点击而不做一些严重的黑客攻击/扩展 T3 核心本身。抱歉，我无法提供更多帮助，最近我自己也遇到了这个问题。希望SO上有其他TYPO3黑客尝试过这个......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T08:31:24.883

经过长时间的挠头后，昨天才设法解决了这个问题，方法如下：

将 TCA 修改为：

```
 'content' => Array (
        'exclude' => 1,
        'label' => 'LLL:EXT:t3blog/locallang_db.xml:tx_t3blog_post.content',
        'config' => array (
            'type' => 'inline',
            'foreign_table' => 'tt_content',
            'foreign_field' => 'irre_parentid',
            'foreign_table_field' => 'irre_parenttable',
            'maxitems' => 100,
            'appearance' => array(
                'showSynchronizationLink' => 0,
                'showAllLocalizationLink' => 0,
                'showPossibleLocalizationRecords' => 0,
                'showRemovedLocalizationRecords' => 0,
                'expandSingle' => 1,
                'collapseAll' => 0
            ),
            'behaviour' => array(
            ),
            't3blog' => true
        )

    ) 
```

然后我创建了一个新的空扩展。在 ext 目录中，创建了 ext_tables.php，其内容如下：

```
<?php
$TYPO3_CONF_VARS[TYPO3_MODE]['XCLASS']['t3lib/class.t3lib_tceforms_inline.php'] = t3lib_extMgm::extPath($_EXTKEY).'ux_inline.php'; 
```

在 ux_inline.php 里面：

```
<?php
class ux_t3lib_TCEforms_inline extends t3lib_TCEforms_inline
{
    public function renderForeignRecordHeader($parentUid, $foreign_table, $rec, $config, $isVirtualRecord = false)
    {
        if(isset($config['t3blog']) && $config['t3blog'])
        {
            $GLOBALS['TCA']['tt_content']['types']['text']['showitem'] = 'bodytext;;9;richtext:rte_transform[flag=rte_enabled|mode=ts_css];3-3-3';
            $GLOBALS['TCA']['tt_content']['columns']['CType']['exclude'] = 1;
            $GLOBALS['TCA']['tt_content']['columns']['header']['exclude'] = 1;

            return;
        }
        else
        {
            return parent::renderForeignRecordHeader($parentUid, $foreign_table, $rec, $config, $isVirtualRecord);
        }
    }

    public function getExpandedCollapsedState($table, $uid)
    {
        if(isset($_REQUEST['edit']['tx_t3blog_post']))
            return true;
        else
            return parent::getExpandedCollapsedState($table, $uid);
    }

    public function getLevelInteractionLink($type, $objectPrefix, $conf=array())
    {
            if(!isset($conf['t3blog']) || !$conf['t3blog'])
            {
                return parent::getLevelInteractionLink($type, $objectPrefix, $conf);
            }
            else
    {
        if((int) $conf['inline']['first'] > 0)
            return;
    }

    $nameObject = $this->inlineNames['object'];
    $attributes = array();
    switch($type) {
        case 'newRecord':
            $title = $GLOBALS['LANG']->sL('LLL:EXT:lang/locallang_core.xml:cm.createnew', 1);
            $iconFile = 'gfx/new_el.gif';
            // $iconAddon = 'width="11" height="12"';
            $className = 'typo3-newRecordLink';
            $attributes['class'] = 'inlineNewButton '.$this->inlineData['config'][$nameObject]['md5'];
            $attributes['onclick'] = "return inline.createNewRecord('$objectPrefix')";
            $attributes['style'] = "display: none;";
            if (isset($conf['inline']['inlineNewButtonStyle']) && $conf['inline']['inlineNewButtonStyle']) {
                $attributes['style'] = $conf['inline']['inlineNewButtonStyle'];
            }
            if (isset($conf['appearance']['newRecordLinkAddTitle']) && $conf['appearance']['newRecordLinkAddTitle']) {
                $titleAddon = ' '.$GLOBALS['LANG']->sL($GLOBALS['TCA'][$conf['foreign_table']]['ctrl']['title'], 1);
            }
            $icon = ($iconFile ? '<img'.t3lib_iconWorks::skinImg($this->backPath, $iconFile, $iconAddon).' alt="'.htmlspecialchars($title.$titleAddon).'" />' : '');
            $link = $this->wrapWithAnchor($icon.$title.$titleAddon, '#', $attributes);
            return '<div'.($className ? ' class="'.$className.'"' : '').'>'.$link.'</div>';
            break;
        case 'localize':
            $title = $GLOBALS['LANG']->sL('LLL:EXT:lang/locallang_misc.xml:localizeAllRecords', 1);
            $iconFile = 'gfx/localize_el.gif';
            $className = 'typo3-localizationLink';
            $attributes['onclick'] = "return inline.synchronizeLocalizeRecords('$objectPrefix', 'localize')";
            break;
        case 'synchronize':
            $title = $GLOBALS['LANG']->sL('LLL:EXT:lang/locallang_misc.xml:synchronizeWithOriginalLanguage', 1);
            $iconFile = 'gfx/synchronize_el.gif';
            $className = 'typo3-synchronizationLink';
            $attributes['class'] = 'inlineNewButton '.$this->inlineData['config'][$nameObject]['md5'];
            $attributes['onclick'] = "return inline.synchronizeLocalizeRecords('$objectPrefix', 'synchronize')";
            break;
    }
        // Create the link:

    }
} 
```

希望这会在未来对其他人有所帮助。

# asp.net-mvc - 使用 RedirectToAction 时，routeValue 丢失引用属性

> ID：718669
> 
> 赞同：5
> 
> 时间：2009-04-05T09:53:36.730
> 
> 标签：asp.net-mvc

所以如果我在第一个控制器中这样做：

```
 public class AController:Controller
    {
            public ActionResult ActionOne()
            {
                 MyObject myObj = new MyObject()
                 myObj.Name="Jeff Atwood";
                 myObj.Age =60;
                 myObj.Address = new Address(40,"Street");

                 return RedirectToAction("ActionTwo", "BController", myObj );

             }
    } 
```

在第二个控制器中，myObj 会正常显示，但 Address 将为空。

```
public class BController:Controller
        {
                public ActionResult ActionOne(MyObject obj)
                {
                     //obj.Address is null?

                 }
        } 
```

这是预期的吗？有什么办法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-05T10:16:48.203

您可以使用[TempData](http://msdn.microsoft.com/en-us/library/system.web.mvc.controllerbase.tempdata.aspx)来存储在两个请求之间可用的对象。在内部，默认实现使用 Session。

```
public class AController:Controller
{
    public ActionResult ActionOne()
    {
        MyObject myObj = new MyObject()
        myObj.Name = "Jeff Atwood";
        myObj.Age = 60;
        myObj.Address = new Address(40, "Street");
        TempData["myObj"] = myObj;
        return RedirectToAction("ActionTwo", "BController");

    }
}

public class BController:Controller
{
    public ActionResult ActionTwo()
    {
        MyObject myObj = TempData["myObj"] as MyObject;
        // test if myObj is defined. If ActionTwo is invoked directly it could be null
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-18T22:14:25.427

我遇到了同样的问题，没有明显的解决方案。虽然 TempData 派上用场很多，但不必全部使用它很好，因为它相当 hackish。

我发现的最佳解决方案是传递一个新的 RouteValueDictionary

```
 return RedirectToAction("ActionTwo", "BController", new { MyObject = myObj } ); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-30T01:39:42.360

我做了一些进一步的搜索，找到了 Jon Kruger 的博客。 [http://jonkruger.com/blog/2009/04/06/aspnet-mvc-pass-parameters-when-redirecting-from-one-action-to-another/](http://jonkruger.com/blog/2009/04/06/aspnet-mvc-pass-parameters-when-redirecting-from-one-action-to-another/)

.net MVC 框架不支持这个特性，但是人们已经添加了对 mvccontrib 的支持。不幸的是，我无法访问 mvccontrib.org。你能告诉我这个问题是否解决了吗？谢谢。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-05T10:02:35.853

地址是引用类型，我认为只有“字符串”和值类型（如 int、float 等）可以通过，因为请记住它们是在内部将字符串从控制器传递到另一个。

可能您可能需要实现一些序列化接口才能执行此操作（这取决于传输模式、xml、html 或内部使用的传输形式）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-30T01:08:24.963

我遇到了同样的问题。TempData 解决方案看起来不太好，因为它使单元测试变得困难。这是 Akash 指出的序列化问题吗？

# image - 雅虎邮件复选框

> ID：718673
> 
> 赞同：0
> 
> 时间：2009-04-05T09:59:34.643
> 
> 标签：image, checkbox

在 yahoo email 的 web 2.0 版本上，您可以选择一键选择所有电子邮件。我对雅虎如何制作绿色复选框感兴趣

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T12:41:35.737

您可以在大多数现代浏览器中设置表单元素的样式，最简单的方法可能是使用 jQuery： [http ://www.jquery.com](http://www.jquery.com)

有一些插件可以设置表单元素的样式，并添加“检查所有”功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T19:53:18.787

```
function checkAll(list, state)
{
    for (i = 0; i < list.length; ++i)
    {
      list[i].checked = state ;
    }
} 
```

你需要使用类似的东西

```
onClick="javascript:checkAll(document.myform.list, true)" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T10:10:01.717

我想他们使用 JavaScript 来切换复选框的状态：

```
var toggleCheckboxes = function(checkboxes, state) {
    for (var i = 0, l = checkboxes.length; i < l; i++)
        checkboxes[i].checked = state;
};
// usage:
var chks = document.getElementsByTagName('input');
// you could also filter this to only get inputs with "type=checkbox"
toggleCheckboxes(chks, true);
// true means we should check them. Use false to uncheck them. 
```

# .net - 线程安全的一次性计算最佳实践

> ID：718675
> 
> 赞同：1
> 
> 时间：2009-04-05T10:00:14.937
> 
> 标签：.net, multithreading, caching, locking

在我的类中需要一个需要计算和缓存的属性是很常见的。

通常我使用一个锁和一个布尔顶部检查它是否被处理。有时我在访问器中这样做。

这种方法对性能有何影响？有没有更好的方法。

我对此的常用方法的示例代码：

```
 Sub Main()
        Dim X AS New X()

        For i AS Integer = 0 To 50
            Dim Thr AS New Threading.Thread(ADdressOF X.ProcessData )
            Thr.Start()
        Next

    End Sub

Private Class X

    Private DataCached AS Boolean 
    Private ProcessedData AS String 
    Private Lock AS New Object()
    Public Function ProcessData() AS String

    Synclock Lock
        IF NOT DataCached Then
            DataCached = True
            ProcessedData = DoStuff()
        End If
    End Synclock

        Console.Writeline(ProcessedData)        
        Return ProcessedData
    End Function

    Function DoStuff() AS String 
        Threading.Thread.Sleep(1000)
        Console.Writeline("Processed")
        return "stuff"
    End Function

End Class 
```

**编辑 ：**

这是访问时需要计算的东西，因为它一直在变化。构造函数计算在这里没有帮助。（*示例是我正在做的一个非常简化的版本*）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-05T10:49:27.127

您可以通过双重检查优化来提高并发性：

```
If Not DataCached Then
    Synclock Lock
    If Not DataCached Then
        ProcessedData = DoStuff()
        DataCached = True ' Set this AFTER processing
    End If
End Synclock 
```

这将避免第一次初始化后的临界区。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-05T10:50:53.037

**从不**计算两次是否很重要？即如果两个线程*碰巧*同时要求它，并独立计算值，那是一个显示停止器吗？在大多数情况下，它不是 - 在这种情况下，只需检查`null`（因为它是一个字符串）：（C# 中的示例，道歉）：

```
 if(processedData == null) {
       processedData = DoStuff();
   }
   return processedData; 
```

所有*后续*`volatile`调用都应该看到新值（如果它隐藏在属性/方法中，我认为我们不需要）。

这具有无锁且简单的优点。

另一个技巧是使用嵌套类的静态属性：

```
string SomeValue {
   get {return MyCache.SomeValue;}
}
static class MyCache {
    public static readonly string SomeValue;
    static MyCache() {
         SomeValue = DoStuff();
    }
} 
```

这是惰性计算的，但是静态初始化器的规则意味着它保证只运行一次（不包括反射）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T10:07:39.100

这是唯一的方法，可能有其他一些系统库可以做到这一点，但最终该库也会在内部做同样的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-05T11:16:29.857

首先，我会将缓存移到包含业务逻辑的类之外，并保持业务逻辑纯净，并允许您独立于应用程序控制缓存。但这不是你的问题......

您无需提及您是否会承受更多的打击，可能会多次计算这些东西，直到缓存变热。简单的方法是：

```
if (Cache["key"] == null)
  Cache["key"] = obj.processData();

return Cache["key"]; 
```

缓存本身应该确保这是安全的。

如果您希望在填充缓存时显式阻止，那么您在上面的代码中已经有了这样做的语义，但是我建议进行此更改：

```
if (Cache["key"] == null) {
  Synclock blockIfProcessing
    if (Cache["key"] == null) 
       Cache["key"] = obj.processData();
  End Synclock
}

return Cache["key"]; 
```

基本上，一旦缓存变热，这会阻止您在每次调用时阻塞，并且会产生更好的性能并保护您免受潜在竞争条件的影响。

请记住，一旦你有两个不同的锁，你就会面临潜在的死锁（这远远超出了这个线程的范围）。

寻找 .Net 缓存解决方案。

# c++ - 使用 Boost MPI 发送文件？

> ID：718676
> 
> 赞同：3
> 
> 时间：2009-04-05T10:00:17.603
> 
> 标签：c++, boost, mpi

我可以使用 Boost MPI 将文件发送到其他计算机吗？我担心的是它针对非常小的消息进行了优化，而不是更大的消息（我需要一次发送 700 MB 或更多）。原因是无论如何我可能会在程序的其他部分使用 mpi，所以我认为不混合和匹配将是一个非常干净的解决方案。

已经完成了吗？你会推荐它吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-05T10:54:48.783

请记住，Boost MPI 要求您已经在要发送文件的系统上具有 MPI 实现（[OpenMPI](http://www.open-mpi.org/)、[MPICH2](http://www.mcs.anl.gov/research/projects/mpich2/)、[MVAPICH2](http://mvapich.cse.ohio-state.edu/overview/mvapich2/)等）。您需要将其中之一与 Boost MPI 一起使用。

还要记住，MPI 是为高性能集群设计的，大多数 MPI 实现都假设您拥有可靠的硬件。也就是说，如果您在 MPI 中编写了一个应用程序并且您的某个进程出现故障，那么它们很可能都会死掉。

如果您打算在您自己的网络上的本地环境中使用它，并且您打算主要运行批处理作业而不是持久服务，那么 MPI 可能是一个不错的选择。如果不是，那么请研究为更分散、更不可靠的环境设计的其他一些消息传递解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-05T10:13:41.910

MPI 是为高性能并行应用程序设计的，所以我绝对推荐它。（请记住，所有被接受的 Boost 库都经过了彻底的验证和测试

根据[参考文档，700mb 文件应该没有问题](http://www.boost.org/doc/libs/1_38_0/doc/html/mpi.html)

另一个（希望是有趣的）特性：“Boost.MPI 进程可以分布在许多不同的机器上，可能具有不同的操作系统和底层架构。”

# asp.net - 日期格式转换

> ID：718677
> 
> 赞同：2
> 
> 时间：2009-04-05T10:00:52.987
> 
> 标签：asp.net

我有约会

```
string date = calarc.SelectedDate.ToString("MM/dd/yyyy"); 
```

其中 calarc 是压延控制。

它返回 03-14-2009 格式的日期，但我希望它采用 03/14/2009 格式。

那么我该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-05T10:11:40.090

我认为您当前的文化正在搞乱格式。尝试

```
DateTime.Parse("2009-03-14").ToString(@"MM/dd/yyyy", CultureInfo.InvariantCulture) 
```

看起来“/”实际上是分隔符的语法（类似于 M、d、y 或任何其他）。这就是为什么它被替换为文化中指定的分隔符。这在[文档](http://msdn.microsoft.com/en-us/library/system.globalization.datetimeformatinfo.dateseparator(VS.71).aspx)中也有说明。

> 如果自定义模式包含格式模式“/”，则 DateTime.ToString 显示 DateSeparator 的值以代替格式模式中的“/”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T14:52:43.347

格式说明符中的 / 字符并不像您想的那样。它不是复制到字符串的文字字符，而是日期分隔符的说明符，在当前文化中是 - 字符。

要在格式中使用文字字符，只需在它们周围加上撇号：

```
string date = calarc.SelectedDate.ToString("MM'/'dd'/'yyyy"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T10:09:45.273

未经测试的代码行 -

```
string.Format("mm-dd-yyyy", calarc.SelectedDate); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-05T10:17:30.700

```
string.Format("{0:MM/dd/yyyy}",calarc.SelectedDate); 
```

# asp.net - ASP.NET 中的嵌套 Web 用户控件事件需要帮助

> ID：718692
> 
> 赞同：2
> 
> 时间：2009-04-05T10:15:41.390
> 
> 标签：asp.net, user-controls

场景：我的 asp 网页中有一个嵌套的 Web 用户控件，并且子用户控件中有一个按钮。

网页：引用一个名为“slot”的父控件，它可以动态加载

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Home.aspx.cs" 
 Inherits="light.Home" %>

<%@ Reference Control="~/UserControl/Slot.ascx" %> 
```

父用户控件：引用一个名为“ray”的子控件，它也动态加载

```
<%@ Control Language="C#" AutoEventWireup="true" CodeFile="Slot.ascx.cs"    
 Inherits="light.Slot" %>

<%@ Reference Control="~/UserControl/Ray.ascx" %> 
```

子用户控件：有一个名为“ButtonRay”的按钮，我希望它在其点击事件上运行。

```
<%@ Control Language="C#" AutoEventWireup="true" CodeFile="Ray.ascx.cs" 
 Inherits="light.Ray" %>

<div id="AddRay" runat="server">

<asp:Button ID="ButtonRay" runat="server" Text="Ray" 
onclick="ButtonRay_Click"/>

</div> 
```

**问题：按钮不会从服务器端触发其单击事件 (ButtonRay_Click)**

```
protected void ButtonComment_Click(object sender, EventArgs e)
{
    // this the code that i want to be executed
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T15:59:00.817

也许只有我一个人，但我从来没有见过这样引用和加载的控件。这是我会尝试以这种方式进行的操作（对我有用）：

在您的主页中，像这样注册您的 Slot 控件，而不是像以前那样引用它：

```
<%@ Register TagName="Slot" TagPrefix="cc" Src="~/Slot.ascx" %> 
```

然后将控件添加到您的页面：

```
<cc:Slot ID="SlotControl" runat="server" /> 
```

现在在 Slot.ascx 中，注册并包含 Ray 控件：

```
<%@ Register TagName="Ray" TagPrefix="cc" Src="~/Ray.ascx" %>

<cc:Ray ID="RayControl" runat="server" /> 
```

现在在您的 Ray 控件中，添加您的按钮：

```
<asp:Button ID="ButtonRay" Text="Ray" OnClick="ButtonRay_OnClick" runat="server" /> 
```

在 Ray.ascx.cs 代码隐藏中，添加您的事件处理程序：

```
protected void ButtonRay_OnClick(object sender, EventArgs e)
{

} 
```

当我在此方法上添加断点、运行应用程序并单击按钮时，OnClick 事件将按应有的方式捕获。我认为正在发生的事情是仅仅引用您的控件并不会连接事件。如果您正在动态加载控件，则必须使用`Page.LoadControl()`它才能正确连接。

如果您需要更多解释，请告诉我。

**编辑：**

我刚刚注意到您的按钮单击方法名称与您要求它调用的方法名称不同：您有 ButtonRay 按钮执行 ButtonRay_Click，但您的方法名称是 ButtonComment_Click。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-25T09:28:24.413

## 在 aspx Page.ie 中：Home.aspx.cs

覆盖受保护的无效 OnInit(EventArgs e)

```
{
    InitializeComponent();
    base.OnInit(e);
} 
```

私有按钮 GetButton()

```
{

    Button Btn = (Button)SlotControl.FindControl("RayControl").FindControl("ButtonRay");
    return Btn;
}

private void InitializeComponent()
{

    /*   For button Event Initialization */

    Button Btnclk = GetButton();

    Btnclk.Click += new EventHandler(Btnclk_TextChanged);

} 
```

void Btnclk_TextChanged（对象发送者，EventArgs e）

```
{ 
```

/* 在这里写你的代码........*/

```
 } 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-07-25T09:16:08.370

## 在 aspx 页面中。

覆盖受保护的无效 OnInit(EventArgs e) { InitializeComponent(); base.OnInit(e); } private Button GetButton() { Button Btn = (Button)SlotControl.FindControl("RayControl").FindControl("ButtonRay"); 返回 Btn；} private void InitializeComponent() { /* 用于按钮事件初始化 */

```
 Button Btnclk = GetButton();

    Btnclk.Click += new EventHandler(Btnclk_TextChanged); 
```

} void Btnclk_TextChanged（对象发送者，EventArgs e）

```
{ 
```

/* 在这里写你的代码........*/

}

# php - 如何像 WordPress 和 Drupal 一样使用 RewriteRule

> ID：718695
> 
> 赞同：1
> 
> 时间：2009-04-05T10:18:25.003
> 
> 标签：php, mod-rewrite

我有一个包含各种变量的包含脚本的网站。

以下是一些类型的 URL 和变量：

`Main page: index.php
Login page: login.php (redirects to index.php after login).
Logout page: logout.php (redirects to login after logout).
Profile page: index.php?id=profile
Users password page: index.php?id=profile&sub=password`

有些页面甚至在 URL 中有更多的变量。我想使用 RewriteRules 来获得这样的好 URL：

`url.com/my/site/ (base)
url.com/my/site/profile/ (profile page)
url.com/my/site/profile/password/ (password page)
url.com/my/site/profile/password/variable1/variable2/variable3/ (use variables in the URL)`

如何在 .htaccess 文件中执行此操作？该站点不是域上的根，而是几个文件夹。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-05T11:39:04.123

`.htaccess`规则适用于其容器目录及其所有子目录。这可能是一个很好的起点：

```
<IfModule mod_rewrite.c>
    # Removing .php file extension.
    RewriteEngine on
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME}\.php -f
    RewriteRule ^(.*)$ $1.php
</IfModule> 
```

或者您可能想从 url 中删除 index.php 的 GET 参数：

```
<IfModule mod_rewrite.c>
    # Removing GET parameters.  
    RewriteRule ^index/([^/\.]+)/?$ index.php?id=$1 [L]
</IfModule> 
```

# 阅读更多：

*   [使用 .htaccess 的 5 个有用的 URL 重写示例](http://roshanbh.com.np/2008/03/url-rewriting-examples-htaccess.html)
*   [通过 .htaccess 重写 URL](http://web-programming.suite101.com/article.cfm/url_rewriting_via_htaccess)
*   [mod_rewrite 备忘单](http://www.addedbytes.com/apache/mod_rewrite-cheat-sheet/)
*   和[谷歌](http://www.google.com/search?hl=en&safe=off&client=firefox-a&rls=org.mozilla%3Aen-US%3Aofficial&q=.htaccess%20mod_rewrite%20nice%20urls&btnG=Search&cts=1238931487633&aq=f&oq=)

# html - 拉伸右浮动div宽度？

> ID：718700
> 
> 赞同：7
> 
> 时间：2009-04-05T10:24:08.873
> 
> 标签：html, css

我有 2 个 float:left div，第一个是固定的，我希望第二个 div 拉伸剩余空间。

```
<div id="container">
 <div id="leftform"> </div>
 <div id="rightform"> </div>
</div> 
```

任何想法？谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-05T11:16:23.477

在 CSS2 中：

```
#container {display:table; table-layout:fixed;}
#leftform, #rightform {display:table-cell;}
#leftform {width:100px;} 
```

在 IE 黑客世界中：

```
#container {padding-left:100px;}
#leftform {float:left; width:100px; margin-left:-100px;} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T11:49:36.767

使用 javascript 函数使两者的高度相等。

```
//fixing column height problem using Prototype
Event.observe(window,"load",function(){                         
    if(parseInt($('leftform').getStyle('height')) > parseInt($('rightform').getStyle('height')))
        $('rightform').setStyle({'height' : parseInt($('leftform').getStyle('height'))+'px'});
    else
        $('leftform').setStyle({'height' : parseInt($('rightform').getStyle('height'))+'px'});
});//observe 
```

同样[的问题](https://stackoverflow.com/questions/692523/getting-actual-height-of-an-auto-heighted-element-in-ie)。

# c# - C#：帮助通过 NodeMouseClick 事件迭代树视图项

> ID：718704
> 
> 赞同：1
> 
> 时间：2009-04-05T10:27:59.067
> 
> 标签：c#

我创建了一段代码，它将显示一个适当的组框，该组框对应于被单击的树视图节点，就像首选项菜单表单一样。该代码完成了它应该做的事情，但我的问题是弄清楚如何制作它，以便在右键单击树视图中的另一个项目时不会调用另一个组框。

[详细的]

假设树视图中有 3 个节点。0) 一般；1) 声音；2) 关于；如果我单击节点 [1] 声音，它将显示适当的组框，但如果我右键单击树视图节点 [0] 常规，它将显示它的框架，一旦我抬起鼠标右键，焦点将恢复返回 [1]Sounds，但保留节点 0 的组框）常规。我怎么能防止这种情况发生？

[代码]

```
 private void tvFrames_NodeMouseClick(object sender, TreeNodeMouseClickEventArgs e)
    {
        // How would I make sure that it won't display a different groupbox if another treeview node
        // is currently being right clicked (temporarily selected before reverting back to previous focused node item)?
        if (e.Node != null)
        {
            switch (e.Node.Index)
            {
                case 0:
                    ShowGroupBox(groupboxZero);
                    break;

                case 1:
                    ShowGroupBox(groupboxOne);
                    break;

                case 2:
                    ShowGroupBox(groupboxTwo);
                    break;
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-05T10:44:01.260

我可以澄清一下吗？您只是希望此逻辑适用于左键单击，是吗？

```
 if (e.Button == MouseButtons.Left && e.Node != null)
    {
        switch(...) {
          ...
        }
    } 
```

此外 - 而不是硬编码索引号，您可以考虑`.Tag`针对节点设置 - 避免所有`switch`等：

```
 if (e.Button == MouseButtons.Left && e.Node != null)
    {
        GroupBox grp = e.Node.Tag as GroupBox;
        if(grp != null) ShowGroupBox(grp);
    } 
```

然后您需要做的就是`.Tag`首先设置 s ：

```
 someNode.Tag = groupboxZero;
    someOtherNode.Tag = groupboxOne;
    someThirdNode.Tag = groupboxTwo; 
```

（注意——这只是为了考虑；如果你的代码有效，并且你很高兴——不要改变它）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T10:51:28.947

最好的答案可能是根本不使用treeView1_NodeMouseClick，而是坚持使用标准的treeView1_AfterSelect。

您还有一个 BeforeSelect，它可能对保存数据或取消移动很有用。

# content-management-system - 开发我自己的 CMS

> ID：718705
> 
> 赞同：5
> 
> 时间：2009-04-05T10:29:19.627
> 
> 标签：content-management-system

为什么？！...也许这是您在阅读本主题的标题时的第一个想法。

有各种各样的开源 CMS 可以满足每个人的需求。我猜你是对的……事实上我非常同意。

但这个话题是为像我这样天真和固执的程序员准备的，他们真的很喜欢从头开始开发自己的 CMS 的想法。但是，我从哪里开始，在规划这个 CMS 时我的主要关注点应该是什么？

从头开始开发自己的 CMS 是否有任何好的教程、文章、书籍等？

如果不是，也许你们中的一些人已经尝试开发自己的 CMS……如果是这样，请分享好的和坏的经验。

提前致谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-05T10:36:59.717

如果您还没有这些问题的答案，那么您可能是从错误的项目类型开始的。CMS，即使是基本的 CMS，也可能是一个非常复杂的野兽，您需要考虑以下几点：

*   您的数据库将如何显示
*   您允许用户访问页面信息的灵活性如何（即，属性的可定制性如何）
*   人们将如何编辑页面数据
*   您将如何查看已发布的页面版本
*   您将如何支持版本控制
*   什么样的网站应该是 CMS 的目标

这些问题的答案将有助于决定数据库的外观、项目如何分解、如何处理想要制作页面的人等等。

我更建议您从查看开源 CMS 项目开始，并了解它们是如何进行的，这将在您创建自己的项目时为您提供更多想法。否则你很容易被选项淹没。

**编辑**- 只是想补充一下，我为开源 CMS（[Umbraco](http://umbraco.org)）做出了贡献，所以我熟悉 CMS 需要做什么，我不只是消极

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-05T11:04:31.570

是的，CMS 可以很大，但它们可以从小处着手，作为一个非常好的学习/有趣项目，真正的卖点是您可以自己使用它。如果我要构建另一个 CMS，这里有几件事我会/不会做。

1) 不要 100% 依赖 Xsl 来创建您的内容——这在 2001 年看起来是一个合理的选择，但我错了。

2) 不要尝试编写自己的 Javascript/Flash 富编辑控件 - 已经有太多好的控件了

3) 一定要创建一个做一些独特的 CMS - 就我个人而言，我喜欢一个可以让我创建连环画的 CMS - 去一个利基市场

4) 尽早制定一个好的服务器/数据库设计。

5) 就这么做吧……

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-14T18:03:37.467

对我来说听起来很有教育意义。尽管其他人有顾虑，但如果您有兴趣了解需要在 CMS 中解决的问题，那么学习一个问题的最佳方法是构建自己的，或者至少构建一些有趣的部分。我不会为我自己的存储库使用自制软件。但是，就像构建编译器和解释器帮助我更好地理解技术一样，CMS 也是如此。我不使用我为“实际工作”而构建的编译器或解释器，但我很高兴我构建了它们。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-08-09T18:19:20.260

我为自己和我的客户开发了自己的 cms。除非绝对必须，否则我讨厌使用别人的程序。此外，由于我不断开发新网站，使用自己的 cms 更方便，每次只需稍微调整一下。反正。怎么做？刚开始做某事。人们陷入困境是因为他们认为他们应该首先找出一个完美的结构等等。放松，它不会是完美的。稍后您可能需要进行一些更改。但在我的经验中，做错事并修复它仍然比等待完美解决方案的愿景来启发你更快。因此，只需坐下来开始逐页编写：添加页面、插入页面、更新页面……您将意识到在此过程中还需要什么。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-05T11:04:23.660

以小步骤进行，首先是一小部分功能，另一层，然后是更多。如果您尝试先定义所有需要的功能并尝试实现它，您可能会失败。逐步进行。不要忘记定期的代码审查和重构。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-05T10:51:30.650

一个非常重要的问题是，如果您希望它在很大程度上是服务器端还是客户端，这取决于您更接近 wiki 还是博客。还有什么语言和什么规模？如果您想继续研究新事物一段时间，这可能是学习新事物的好机会，但如果您只是想克服它，请使用您知道的语言。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-08-09T18:25:36.487

我将首先解决所有 CMS 都需要的一些常见问题，然后从那里开始构建。这里有几个：

*   **用户身份验证**您将需要能够处理将要编辑内容的客户端，可能还有其他用户。
*   **管理面板**- 您的客户将如何编辑内容？它需要灵活地支持许多不同的设置。
*   **编辑页面**- 大多数网站都有某种简单的静态页面，您将需要一些方法来存储/编辑它们。
*   **联合内容**- 大多数网站都有的另一件事，例如新闻提要或博客条目。

如果你做了所有这些，你就会有一个简单的 CMS 的开始。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-08-18T15:52:25.303

我建议您不要创建自己的 cms。您编写、完善、虚拟证明、编写文档、进行可用性测试、测试各种服务器、市场所花费的时间，除非您有一个团队并且资金充足，否则这是不值得的。

您还必须考虑其他事项，包括许可证、法律费用和更新系统。除了您的买家如何相信独资经营者将在附近提供更新之外。我谈到了这方面的丰富经验，因为我已经开发了自己的 CMS 多年，并且销售 cms 变得更加困难，因为 joomla、wordpress 和 drupal 的价格点是你无法完成的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-14T17:51:39.303

当我不得不决定雇用他/他们时，公司介绍中的一行“我在 2009 年建立了自己的 CMS”或类似的“使用我们自己的 CMS..”可能是我名单上的一个**很大的减号**.

也许不是您期望的那种答案，但如果我是您，我会考虑为现有的 CMS 开发一些真正的新模块。我个人赌的是 Drupal，但你可以找到很多其他的选择。

最好花时间，恕我直言。

# java - 生成所有 3*3 二维数组

> ID：718707
> 
> 赞同：1
> 
> 时间：2009-04-05T10:32:17.730
> 
> 标签：java, matrix

我将如何在 java 中编写一个函数来生成所有 3*3 多维数组，以使 1...9 之间的每个数字只出现一次？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-05T10:42:05.757

基本上，您正在寻找 series 的所有排列`[1, 2, ... 9]`，但请注意您将它们拆分为`3x3`.

很容易在数学上证明排列的数量是`9!`（阶乘 9）。

有许多算法可以生成排列。选择您认为最方便的一种。例如，[在 wikipedia 上](http://en.wikipedia.org/wiki/Permutation#Algorithms_to_generate_permutations)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T10:37:38.233

**注意：**根据 OP，这实际上不是作业。

你走了多远？这听起来像家庭作业，这很好，所以可能会有所帮助，但你应该向我们展示你做了多少。SO 是关于培养更好的程序员，所以向我们展示你能做什么，我们会提供帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T10:42:43.807

我会从小处着手，您将如何处理 2*2 阵列？手动进行 - 即开始写下所有可能的 2*2 数组。你怎么做呢？然后想想如何在代码中做到这一点。如果您以 2*2 的方式执行此操作，您应该能够通过肉眼看到您的结果是否看起来不错，这样您就会知道您是否走在正确的轨道上。

这基本上是一个排列问题，一旦你弄清楚了小数字，相同的解决方案应该可以扩展。

# xml - 以 XHTML 形式提供的页面上的 URL 存在问题

> ID：718708
> 
> 赞同：0
> 
> 时间：2009-04-05T10:34:01.563
> 
> 标签：xml, url, xhtml, hyperlink

当我尝试查看该页面时，我的应用程序中的以下 URL 链接在第二个等号上给了我一个 XML 解析错误。

```
<a href="http://www.example.com/admin/banning.php?do=banuser&u=3">Ban User</a> 
```

我认为问题在于 URL 中的 & 符号。如果我对 & 符号进行编码，解析错误就会消失，但 URL 不再起作用。有没有一种简单的方法可以让这样的 URL 在作为 XHTML 服务的页面中工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-05T10:36:08.597

对 & 符号进行编码是正确的方法。如果 URL 不起作用，则肯定有其他问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T09:21:43.580

您必须在任何 xhtml 文档中使用`&amp;`而不是`&`

# c - C：函数指针和typedef问题

> ID：718728
> 
> 赞同：9
> 
> 时间：2009-04-05T10:45:52.893
> 
> 标签：c, function-pointers, typedef

我有一个 C 函数，它以函数指针作为参数，它是一个析构函数，我将在程序结束时调用它。这是我的函数的原型：

```
int store_dest(void (*routine)(void *)); 
```

我想将此函数指针存储到具有其他一些信息的结构中。为了有一个很好的结构，我想有一个指向这个函数指针的 typedef。这是我的 typedef ：

```
typedef void (*my_destructor)(void *); 
```

这是我的结构：

```
typedef struct my_struct{
  my_destructor dest;
  other_info ...
} my_struct; 
```

在初始化步骤中，我想将“dest”字段设置为我的一个函数，这里是这个函数的原型：

```
void* my_dummy_dest(void* foo); 
```

当我尝试将结构的“dest”字段设置为“my_dummy_dest”时，会出现问题（实际上它只是一个警告，但我想抑制它）：

```
my_struct.dest = &my_dummy_dest; 
```

我收到“警告：来自不兼容的指针类型的赋值”

当我比较它们时也一样：

```
if (my_struct.dest == &my_dummy_dest) 
```

我收到“警告：不同指针类型的比较缺少强制转换”

但是当我用另一个例程设置“dest”字段时，我没有收到任何警告。我不明白为什么我有这些警告。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-05T10:52:42.003

您的虚拟析构函数被声明为返回 void**指针**，而不是 void。此声明与您的析构函数指针的 typedef 不匹配。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-05T10:53:22.547

typedef 应该是：

```
typedef void *(*my_destructor)(void *); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-05T10:53:29.130

因为 my_dummy_test 返回 void* 而不是 void。如果你想返回 void*，typedef 应该是

```
typedef void* (*my_destructor)(void *); 
```

# time-management - 你如何找到时间来提高你的编程技能？

> ID：718739
> 
> 赞同：18
> 
> 时间：2009-04-05T10:51:49.073
> 
> 标签：time-management

我是一名在印度工作的 Java/J2ee 程序员。我对编程充满热情，我不断努力通过阅读博客、解决 Project euler 问题、学习新技术、开发小型应用程序等来磨练我的编程技能；但我发现管理自己的时间非常困难。每天在办公室工作 12 小时让我压力山大，周末和家人一起度过。所以我每周几乎没有 5-6 小时的时间来真正从事我感兴趣的事情，这将有助于我提高。

您如何管理时间，以便找到时间来提高您目前的地位？

编辑：12 小时包括 1 小时的旅行和 1 小时的休息时间（午餐/咖啡）。实际上，我每天在办公室工作 10 小时，这是我的组织规定的。

-斯内哈尔

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-05T11:02:04.790

如果你花那么多时间在工作上，在我看来，剩下的时间你应该和你的家人和朋友一起度过，做你喜欢做的事情。

我希望工作 12 小时可以提高我的技能，但并不是每个人都幸运地拥有一份处于技术前沿的工作，而且据了解，有些程序员停留在旧的技术或方法中，让他们没有提升自己的空间.

所以问题变成了**“我如何在最短的时间内提升我的技能？”** . 答案是**最大化你的努力，为你带来真正的价值**。

*   阅读博客很好，其中许多都讲述了好故事。但是你能从他们那里获得良好的技术价值吗？
*   SO 是一个很好的资源，但如果您发现它浪费时间，请不要在上面花费太多时间。
*   ETC...

我会尝试从我的工作场所获得更多。例如，尝试在您的工作场所开展技术培训。建议你的上级研究一项新的、有趣的技术，它可能与你的领域相关，花几个小时在上面，然后和你的同事讨论一下——这对每个人都有好处。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-05T11:01:01.343

我认为你可以通过一个你真正喜欢的宠物项目来学习更多。这样你就可以在业余时间工作，同时玩得开心。它也是应用那些您没有机会在其他地方应用的新技术的好地方。

此外，考虑其他事情并在一段时间内完全忘记编程也会有所帮助，比如学习烹饪或园艺等。这有点让人耳目一新，下次你开始编程时，你就会有一个新鲜的大脑来破解。:)

至于时间，通常每天一个小时就足够了。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-05T12:01:37.780

在许多较富裕的国家，工作 12 小时也是现实。我不会把这归结为文化问题。

我生活在世界上生活水平最高的国家之一。我为资源行业创建软件。在这个行业中，无论您是卡车司机还是程序员，12 小时工作日通常是标准的。如果您在偏远地区工作，通常连续工作 8（或最多 14）12 小时，然后在家休息几天。

这完全适得其反并且非常不健康——我不会向任何人推荐它。但是，是的，您仍然可以设法学习东西。以下是我的建议：

*   如果您有一个不确定如何解决的问题，请阅读 MSDN、博客、stackoverflow 等，并真正尝试掌握解决问题的方法。然后尝试立即实施解决方案。**这对于加强您的学习至关重要。**如果您将实施留到 8 小时后，您可能会忘记所学的内容，最终只会浪费时间。

*   如果您没有需要解决的特别令人生畏的问题 - 尝试找出如何以更有效或更优雅的方式实现代码的至少一部分。例如，如果您有一个微不足道的任务，例如创建一些代码来使用 Web 服务，也许看看如何动态加载这个 Web 服务。

*   在您下班之前制定您的问题或疑问并在 Stackoverflow 上发布，这样当您回到工作岗位时，您希望有许多回复来指导您应对挑战。这让我想到了下一点：

*   趁着精力充沛和警觉，在早上进行学习。

所以这里是对我有用的步骤：

1.  找到我认为可以通过某种方式改进的代码的一小部分
2.  研究它（最多 30 分钟）
3.  立即实施它以获得强化学习的好处

现在，即使您可能只学到了一些看似微不足道的东西，但如果您每天都这样做，您的编程知识将逐渐增加，并且您可以在 30 分钟内解决想法的复杂性。

我发现 30 分钟是一个很好的窗口，因为它通常足够小，可以避免电话或同事的打扰。

如果我发现我想要达到的目标涉及超过 30 分钟的研究，一般我必须将其推到一边，等我没有工作的时候再看一遍。有些概念很难，在你 30 分钟的午休时间里不容易消化。对此没有人能做太多。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-07T11:49:14.160

1 小时旅行 - 收听软件工程播客。
1 小时午休时间——在你的宠物项目上工作时在你的办公桌前吃饭。

在您的公司内寻找另一个项目或找到一家新公司，让您可以从事有趣的事情，这样“工作”就变成了“娱乐”。

选择一份你喜欢的工作，你一生中将永远不需要工作一天。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-05T11:37:05.500

按重要性排序： 1\. 开始寻找每天工作时间不超过 10 小时的工作 2\. 加入一个开源项目并成为那里的贡献者 - 你会学得更快 3\. 告诉你的老板 Google 允许他们的员工将 20% 的时间用于其他项目。我敢肯定，你经常在办公室呆上 12 个小时，不是因为你总是在项目上落后，而是因为你团队中的“文化”，这通常是管理不善的结果。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-05T12:11:48.757

我通过使用耐克的商标来找到时间：**Just Do It**。你总会找到不学习的时间，但是一旦你强迫自己进入那种学习模式，你就会想继续这样做。

至于我使用的具体方法：

**病毒式**：我在[Twitter 上](http://www.twitter.com/gortok)关注与我的兴趣相匹配的人（即编程），我会点击他们提供的关于任何给定编程主题的链接。我会关注这些链接，尽我所能学习，然后我会关注那些页面上的链接；一直下去，直到我知道我不知道什么，并专门搜索它，或者继续前进。

第二步是**做**：我创建了一个[博客](http://blog.yapb.net)，详细介绍了我将所学知识付诸实践的努力。如果你花时间写下一些东西，你就会把它编入长期记忆（不是双关语）。

然后我所做的就是**冲洗、起泡和重复**。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-05T12:13:20.047

简短回答：加入您感兴趣的开源项目。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-05T11:03:42.867

在每个与工作相关的项目中，我经常会尝试一些新的想法。我只做少量，以减少项目完全失败的可能性……例如，在一个数字运算项目中，我使用了 SSE 指令集。或者我在这里和那里尝试一些有趣的模板技巧（我是一个 C++ 人），总是少量。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-05T11:34:21.840

每当我想学习新东西（新框架、新工具集等等）时，我通常会在与客户交谈时提出。

我告诉他，调查这个场地最终可能会为他节省一大笔钱，而且他通常同意花一些时间（比如 20 小时）。

有时候我是对的，其他时候，不是那么多。但我仍然有 20 个小时玩我的新玩具。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-05T12:16:19.760

工作12小时！？可怕的兄弟！
我正在使用打印机打印文章，并在死时间贪婪地运行无济于事时阅读它们！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-05T11:02:18.173

> 每天在办公室工作 12 小时让我压力山大

？？？

不要工作那么久。对于非个人的追求来说，这是一个愚蠢的小时数。特别是如果它不包括扩展技能的时间。

如果您不断尝试每周工作 60 小时，您的生活、健康和整体生产力都会受到影响。

如果公司定期要求/允许这些时间，请寻找更好的公司。

当您身体健康时，您的工作效率会大大提高 - 无论您是在学习新事物，还是只是应用所学知识 - 所以请尝试以下方法：

*   不要总是坐在办公桌前，在需要时休息一下，尤其是适当的午休（出去透透气！）
*   进行大量运动——至少，每天尝试两次良好的散步。
*   吃好，规律的饮食。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-05T11:28:46.893

我们是工匠，因此，当我们参与我们的工艺时，无论是用于个人还是专业用途，我们都应该每天改进它并磨练我们的技能。并不是说您与VB6之类的语言有关，我可以理解它会很困难。Java/J2EE 应该提供大量的改进机会。如果平台本身让您失望，那么您没有理由不能在 Groovy/Ruby/Lisp/ECMAScript 中添加一些代码或算法，然后在 Java 中实现。

我不知道有哪个体面的“老板”会拒绝要求他的员工在这里或那里花一点时间进行个人改进的请求。如果你处于这种情况，你需要改变这种情况。

当我年轻单身时，我经常每周工作 100 小时，因为我喜欢我正在做的事情。如果你被迫每天工作 12 小时而不享受它，没有取得任何个人成就，那么你就没有 12 小时的工作效率。你最好每天花 2 个小时玩两次，然后花 6 个小时来制作你需要的东西。您可能会发现，在 2 周内，您会生产更多。

最后归结为个人时间管理。你要对你的生活和你的家人负责。如果在这份工作结束时，你因为技能过时或达不到标准而无法被雇用，那么你就没有把你的责任放在心上，只关注短期问题。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-05T13:07:31.600

没有捷径。如果您想成为任何领域的专业人士，您将付出越来越多的努力，并且需要多年的努力。只有在你的情况下你能做的就是：在这 12 小时内努力提高效率。尝试做平行的事情。在等待某事时使用情况：在交通工具中，等公共汽车，等待医生......

我有一些我自己的技术要分享：

- 我有两个开放的视觉工作室，一个是我正在工作的项目，第二个是用于试验新东西的平面项目，例如 IronRuby 或数据结构算法或任何我还没有工作的东西。

-我在厕所看书:)。例如，我不是在电脑上阅读博文，而是打印出帖子并在厕所里阅读:)..是的，尽量不要在互联网上浪费太多时间，如果你比较一下你花了多少时间在浪费时间它以及你学到了多少……试着只关注你需要的东西。

-在回家和回来的公共汽车上，我正在收听播客：dotnetrocks、hanselminutes、alt.net 播客……

我试着用业余时间享受生活，见见我的朋友和家人，到外面去，尽可能多地在户外……反正没有时间，我为什么要打扰，我正在尝试我的最好的，就是这样！:)

干杯

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-04-06T10:45:50.530

如果你需要更多的时间，你应该学习如何少睡。

探索多相睡眠，[http ://en.wikipedia.org/wiki/Polyphasic_sleep](http://en.wikipedia.org/wiki/Polyphasic_sleep)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-04-06T10:49:47.820

12小时可怕吗？我在一个家庭拥有的组织工作，我的工作日通常是 14 小时。

幸运的是，我在工作中学习......有时当我感到无聊时，我只是坐在办公室里阅读 SO、书籍、博客或文章。

你不会发现我在抱怨。我喜欢我所做的工作，而且它有回报。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-04-13T07:11:08.110

我想提一下[43Folder 的 (10+2)+5](http://www.43folders.com/2005/10/11/procrastination-hack-1025)。它表面上是一种拖延技巧，但可以为您量身定制。在你的办公桌上放一本书或一篇文章。工作一会儿，然后读一会儿。它不会影响你的工作，但你可以阅读很多

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2011-05-06T16:16:50.017

我强烈建议您阅读以下有关“寻找时间”的文章：

[http://www.gutenberg.org/ebooks/2274](http://www.gutenberg.org/ebooks/2274)

这不应该花太长时间。现在研究“刻意练习”，这是心理学家安德斯·爱立信提出的一个概念。

把你新发现的时间与“刻意练习”结合起来，瞧！

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-02-28T09:42:42.733

如果您可以将旅行时间从 1 小时缩短到 20 分钟，您将获得 40 分钟/天和 2 小时/周。这意味着您必须尽可能地住在/居住在您的工作场所附近。

你绝对可以每周投入 2 小时来做一些富有成效的事情。

# asp.net - 在 asp.net 中跳过的删除功能

> ID：718741
> 
> 赞同：0
> 
> 时间：2009-04-05T10:52:51.410
> 
> 标签：asp.net, linq, .net-3.5

我正在尝试制作一个页面，允许我从数据库中删除求职者。我的页面工作正常，但是当我单击删除按钮时，它会重新加载页面，但不会删除申请人及其详细信息。我正在使用 linq。

这是我的代码

```
 <%@ Page Language="C#" AutoEventWireup="true" CodeFile="ApplicantManagement.aspx.cs" Inherits="AdminPanel_ApplicantManagement" MasterPageFile="../AdminMaster.master" Title="ApplicantManagement" EnableEventValidation="false" %>

<asp:Content ID="Content2" ContentPlaceHolderID="ContentPagePlaceHolder1" Runat="Server">
<div class="content"> 
    <div class="titleMain">Library -> Applicant Management
    </div>
    <h1><span></span>Applicant Management</h1>

    <div class="contentpage" >
        <p>On this page you add, update, delete the Job applicants.
        <b><asp:Label ID="ApplicantError" runat="server" Visible="false" /></b>

        <asp:Label ID="ApplicantMsg" runat="server" Visible="false" /> 
        <br />
        <table>
              <tr>
              <td>
                <asp:DropDownList ID="JobList" runat="server">
                </asp:DropDownList>
             </td>
             <td>
                <asp:Button ID="select" runat="server"  Text="Select"  onclick="btn_Select_Click"/>
             </td>
             </tr>
        </table>     

        <asp:ListView ID="lv_Applicant" runat="server" DataKeyNames="applicant_id" 
             EnableViewState="false" OnItemDeleting="lv_Applicant_ItemDeleting">             
        <LayoutTemplate>
               <table width="550" class="table">
                    <asp:PlaceHolder ID="itemPlaceholder" runat="server" />
                </table> 
                <asp:DataPager ID="ApplicantPager" runat="server" PageSize="5">
                    <Fields>
                        <asp:NextPreviousPagerField ShowFirstPageButton="false" ShowPreviousPageButton="true" ShowNextPageButton="false" />
                        <asp:NumericPagerField />
                        <asp:NextPreviousPagerField ShowFirstPageButton="false" ShowPreviousPageButton="false" ShowNextPageButton="true" ShowLastPageButton="false" />
                    </Fields>
                </asp:DataPager>
            </LayoutTemplate>
                <ItemTemplate>
                    <tr>
                        <td></td> 
                        <td><asp:Label ID="ApplicantID" runat="server" Text='<%# Eval("applicant_id") %>' Visible="false" />
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <b>Name</b>
                        </td>
                        <td>
                            <asp:Label ID="ApplicantName" runat="server" Text='<%# Eval("applicant_name") %>'/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <b>Address</b>
                        </td>
                        <td>
                            <asp:Label ID="ApplicantAddress" runat="server" Text='<%# Eval("applicant_address") %>'/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <b>Phone</b>
                        </td>
                        <td>
                            <asp:Label ID="ApplicantPone" runat="server" Text='<%# Eval("applicant_phone") %>'/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <b>Email</b>
                        </td>
                        <td>
                           <asp:Label ID="ApplicantEmail" runat="server" Text='<%# Eval("applicant_email") %>'/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                           <b>Education</b> 
                        </td>
                        <td>
                           <asp:Label ID="ApplicantEducation" runat="server" Text='<%# Eval("applicant_education") %>'/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                             <b>Experience</b>
                        </td>
                        <td>
                            <asp:Label ID="ApplicantExperience" runat="server" Text='<%# Eval("applicant_experience") %>'/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <b>Interests</b>
                        </td>
                        <td>
                           <asp:Label ID="ApplicantInterests" runat="server" Text='<%# Eval("applicant_interest") %>'/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <b>Other</b>
                        </td>
                        <td>
                            <asp:Label ID="ApplicantOther" runat="server" Text='<%# Eval("applicant_other") %>'/>
                        </td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>

                            <asp:Button ID="ApplicantButton2" runat="server" CommandName="Delete"
                              Text="Delete" Width="50" /><br /><br />
                        </td>
                    </tr>
                </ItemTemplate>      
        </asp:ListView> 
    </p></div>
</div>      
</asp:Content> 
```

和背后的代码：

```
using System;
using System.Collections;
using System.Configuration;
using System.Data;
using System.Linq;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Xml.Linq;

public partial class AdminPanel_ApplicantManagement : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        if (!Page.IsPostBack)
        {
            getApplicantListDDL();
        }

    }

    #region Getting the List
    protected void getApplicantListDDL()
    {
        using (CareersDataContext applist = new CareersDataContext())
        {
            var appList = from a in applist.team5_jobs
                             select new
                             {
                                 a.job_id,
                                 a.job_name
                             };
            JobList.DataSource = appList;
            JobList.DataTextField = "job_name";
            JobList.DataValueField = "job_id";
            JobList.DataBind();
            JobList.Items[0].Selected = true;
        }
    }
    #endregion

    protected void lv_Applicant_ItemDeleting(object sender, ListViewDeleteEventArgs e)
    {
        int ID = Int32.Parse(lv_Applicant.DataKeys[e.ItemIndex].Value.ToString());
        using (CareersDataContext applist = new CareersDataContext())
        {
            team5_job_applicant applicants = applist.team5_job_applicants.Single(al => al.applicant_id == ID);
            applist.team5_job_applicants.DeleteOnSubmit(applicants);
            applist.SubmitChanges();         
        }

        getApplicantList();
    }

    protected void getApplicantList()
    {
        string jobName = JobList.SelectedItem.ToString();
        using (CareersDataContext applist = new CareersDataContext())
        {
            var applicantListVar = from apl in applist.team5_job_applicants
                            where (apl.job_name == jobName)
                            select new
                            {
                                job_name = apl.job_name,
                                applicant_id = apl.applicant_id,
                                applicant_name = apl.applicant_name,
                                applicant_address = apl.applicant_address,
                                applicant_phone = apl.applicant_phone,
                                applicant_email = apl.applicant_email, 
                                applicant_education = apl.applicant_education,
                                applicant_experience = apl.applicant_experience,
                                applicant_interest = apl.applicant_interest,
                                applicant_other = apl.applicant_other
                            };

            lv_Applicant.DataSource = applicantListVar;
            lv_Applicant.DataBind();
        }
    }

    protected void btn_Select_Click(object sender, EventArgs e)
    {
        getApplicantList();
    }
} 
```

谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T14:09:02.967

尝试删除

```
EnableViewState=false" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T11:45:57.367

是因为您没有重新绑定事件，因为您只在 GET 而不是 POST 上填充列表（因此在按钮上连接您的事件 - 我看不到您的连接发生在哪里）？尝试删除 POstBack 测试以查看是否是这种情况。

# java - Java 面板

> ID：718742
> 
> 赞同：1
> 
> 时间：2009-04-05T10:53:16.730
> 
> 标签：java

是否可以在 Java 运行时向面板添加 500 多个组件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-05T10:55:58.097

可能——是的。

但是你到底为什么要做这样的事情呢？我认为一个面板没有任何理由拥有 500 个组件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-05T12:04:35.810

根据您在做什么，可能会有更好的选择。

例如，JTables 使用有限数量的 CellRenderer，它们在多个位置绘制自身，呈现多个组件的外观，同时显着减少内存使用（并提高性能）。

你能提供更多关于你的具体情况的信息吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-05T12:38:05.493

如果您使用重量级 (AWT) 组件，您可能会在某些平台上遇到麻烦。AWT 组件实现很可能正在使用操作系统/窗口系统资源。在某些平台上，这些可能会受到限制。回到过去，当应用程序试图创建两个多组件（例如，为树中的每个项目）时，即使 NT 4 也可能在整个系统中出现 GDI 问题。

在 Swing 中，尽管组件很轻，但组件却大得惊人。因此，对于列表、树和表格之类的东西，渲染器习惯用法是首选 - 请参阅 API 文档。

# jquery - 检查下拉列表中当前选择的选项是否是最后一个选项的最佳方法是什么？

> ID：718749
> 
> 赞同：10
> 
> 时间：2009-04-05T10:57:54.860
> 
> 标签：jquery, html-select

我有一个下拉列表，并且已将更改事件处理程序绑定到它。每当用户选择一个新选项时，我想知道它是否是列表的最后一个选项。

烦人的是，无论选择了哪个选项，下面代码段中的相关条件总是返回 true：

```
 sel.change(function() {
            //this always returns true!
            if(jQuery('#' + this.id + ' option').is(':last')) {
                alert('hello I am the last option');
                inputDiv.show();
                inputDiv.find("input").attr('disabled',false);
            } else {
                inputDiv.hide();
                inputDiv.find("input").attr('disabled',true);
            }
        }); 
```

即使我这样做，结果也是一样的：

```
if(jQuery('#' + this.id + ' option:selected').is(':last')) {
... 
```

我究竟做错了什么？如果你知道，为什么这些测试都评估为真？

编辑：找到解决方案：

```
if(jQuery('#' + this.id + ' option:last').is(':selected')) {
...
} 
```

有谁知道这样做的更好方法？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-05T17:30:40.940

看，没有膨胀！

```
 sel.selectedIndex == sel.length-1 
```

这就是[W3C 标准解决方案](http://www.w3.org/TR/DOM-Level-2-HTML/html.html#ID-94282980)。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-03-04T22:18:36.540

嘿，这是另一个……它是“jQuerish” :)

```
$("select option:last").is(":selected") 
```

# java - Java作文题

> ID：718751
> 
> 赞同：1
> 
> 时间：2009-04-05T10:59:05.030
> 
> 标签：java, inheritance, composition

关于组合和面向对象的问题：

我正在尝试为一个类实现更多功能（以 Java TreeMap 为例）。

```
public class TreeMap<K,V> 
   extends AbstractMap<K,V>
   implements NavigableMap<K,V>, Cloneable, Serializable 
```

使用组合是[这样做的方法](http://www.google.com/search?q=favour+composition+over+inheritance)，所以我必须首先创建一个可重用的转发类，它将包装类的功能，同时让它只这样做，以便它可以在其他地方使用未来。

```
public class ForwardingNavigableMap<K,V> implements NavigableMap<K,V>
{
 ...
} 
```

然后，我将继续创建一个包装类，该类继承新创建的 [可重用转发类](http://books.google.com/books?id=ka2VUBqHiWkC&pg=PA83&dq=reusable+forwarding+class&hl=en)，如下所示：

```
public class BetterTreeMap<K,V> extends ForwardingNavigableMap<K,V>
{
 /* some new cool features here */
} 
```

如果 TreeMap 包含我的类中需要的许多优良特性，那可能不是 NavigableMap 接口的一部分，会发生什么？然后我应该继续为 TreeMap 声明我自己的接口，并在我的可重用类中实现它吗？任何输入在这里表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-05T15:01:22.733

假设您不打算将其作为公共 API（这意味着您不将其发送给第 3 方并期望他们使用它），您可以执行以下操作。

鉴于您（可能）需要访问 TreeMap 特定的方法，但也可能稍后决定将继承更改为 TreeMap 以外的其他内容，只要您不编写任何依赖于作为 TreeMap 的类的代码（例如，从不除了“扩展 TreeMap”之外，请参阅 TreeMap），那么您可以安全地使用扩展。这将要求您编写一个提供 TreeMap 方法的接口。

如果您发现您不想起诉 TreeMap 并想稍后使用其他东西，因为您没有在任何地方引用 TreeMap 都可以。然后，您将剩下对 TreeMap 特定方法的所有调用……如果所有这些调用同时消失，而您不再从 TreeMap 扩展，那么您就可以开始了。如果他们不这样做，那么您将需要编写自己的来实现所需的方法。

如果您从 TreeMap 更改，要找出您需要什么，您将注释掉您放入接口中的所有方法，如果代码使用空接口编译，您就可以使用，如果不是，您需要添加缺少方法回到接口。如果您决定扩展的类没有提供您需要做的缺失方法（或者您确实必须从 TreeMap 扩展）。

另一种解决方案是提前确定您是否真的需要 TreeMap。我不确定我是否想在一个我不确定我的数据结构需要什么的项目中走得太远。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T18:12:26.517

将您自己的所有新方法放在一个新接口中，并创建一个也实现该接口的类。

就在这里

```
public class MyMap implements MyInterface, NavigableMap {
...
} 
```

然后你可以让这个类扩展你想要的类，但我认为最好让 MyMap 的私有成员属于 TreeMap 类，因为你只公开那些你真正想要的方法，而不是 TreeMap 额外拥有的所有方法。

编写转发方法需要大量工作，但例如 Eclipse 具有良好的重构功能，允许您自动生成它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-05T13:52:07.097

这里的问题是，在这个例子`TreeMap`中，它就像一个接口。您可以通过覆盖其所有转发方法来处理它。这不像是一个空的状态`TreeMap`。但是，这是一种脆弱的方法，因为不会处理新方法（或您错过的方法）。

也许您的课程不需要是`Map`. 您可以创建一个适合您的代码的接口，但一个`asMap`/ `asSortedMap`/`asNavigableMap`用于库和非特定代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-05T14:27:12.783

> 如果 TreeMap 包含我的类中需要的许多优良特性，那可能不是 NavigableMap 接口的一部分，会发生什么？

这是在这种情况下使用组合的问题。如果您发现自己制作了一堆包装器方法，它们除了在 TreeMap 上调用相同的方法之外什么都不做，那就是支持继承的论据。因此，如果您有大量看起来像的方法

```
public Set<K> keySet()
{
    return myTreeMap.keySet();
} 
```

您可能只想扩展 TreeSet 以免费获取其所有方法，然后覆盖您要更改的方法。

如果您正在设计的类在内部*使用*TreeMap，并且客户端程序不需要知道这一点，那么您应该使用组合。如果您的类*是*具有一些添加或更改功能的 TreeMap，则使用继承。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-05T11:07:37.317

最简单的方法是扩展现有的类

```
public class MyTreeMap<K,V> extends TreeMap<K,V> {
   // add your overridden or extra methods here.
} 
```

我建议你不要让事情变得比他们需要的更复杂。

如果这不合适，也许您可​​以解释您要达到的目标。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-05T11:08:24.273

如果这些很酷的新功能将在您将使用的其他数据结构上实现，那绝对是。

如果没有，尽量避免用无用的接口重载你的类。尽量减少杂乱。

# php - 解析 SQL 结果中的变量

> ID：718757
> 
> 赞同：0
> 
> 时间：2009-04-05T11:02:51.807
> 
> 标签：php, sql, variables

我目前正在使用 Paypal 结帐构建一个联盟计划（有点像 CJ）。当人们注册为附属公司（=从他们自己的网站上销售他们自己的产品）时，他们会收到 2 条 PHP 行，他们必须将这些行插入到他们的商店中。

在标题中：

```
<?php include 'http://www.mydomain.com/tracker/tracker.php?xyz='.$_GET[xyz]; ?> 
```

在 Paypal 按钮中：

```
<input type="text" name="notify_url" 
    value ="http://www.mydomain.com/ipn.php?xyz=<?php echo $_GET[xyz]; ?>" +
    style="width:1px; height:1px; border:0"> 
```

第一部分基本上设置 cookie，而第二部分将返回 URL 转发给 Paypal，这样当有人决定购买时，它就会返回给我们。我没有隐藏第二部分，因为我希望能够检查附属公司是否真的添加了代码。

这一切在简单的手写 PHP 中都可以正常工作，但是当这些附属公司使用数据库时，一切都会出错。然后，他们的脚本可能会回显类似 $row['paypal'] 的内容，它将逐字显示插入的行而不解析 $_GET。

我完全不知道这是如何解决的。如果可能的话，我想要一些我可以解决的问题，因为我不想惹恼我的附属公司，因为他们主要是非技术人员。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T15:14:01.983

> 他们收到 2 条 php 行，他们必须插入到他们的商店中。

这是难以置信的狡猾。[include()](http://de2.php.net/manual/en/function.include.php)从给定的 URL 中拖入代码**并执行它**。

我永远不会允许附属网络将 PHP 代码添加到我的应用程序中：这使外部站点可以完全控制我的应用程序和数据库。这在未加密的 HTTP 上运行尤其不可接受：任何中间人攻击都可能立即危及服务器。此外，如果您的 tracker.php 中存在跨站点脚本漏洞，则任何最终用户都可以完全破坏客户站点。

我强烈建议您找到一种不太安全的方式来将您的网络与第三方应用程序连接起来。

如果您只打算返回要在最终页面中显示的 HTML，而不是 PHP 代码，则可以使用[readfile()](http://de2.php.net/manual/en/function.readfile.php)或更常用的方法来执行此操作，即让会员插入客户端 <script> 标记指向您的网站。

```
<?php include 'http://www.mydomain.com/tracker/tracker.php?xyz='.$_GET[xyz]; ?> 
```

您还应该使用[urlencode()](http://de2.php.net/manual/en/function.urlencode.php)以便正确转义参数中的任何 URL 特殊字符。

```
value="http://www.mydomain.com/ipn.php?xyz=<?php echo $_GET[xyz]; ?>" 
```

在这里，您应该像任何时候将任何文本内容输出到 HTML 一样，使用 htmlspecialchars() 来编码 HTML 特殊字符。否则，您很容易受到跨站点脚本攻击。

目前，您的问题中并没有足够的信息来准确诊断您的一些附属公司做错了什么。更具体的例子将是有用的。但是从您到目前为止发布的内容来看，我对您系统最基本的安全性非常担忧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T16:10:52.237

感谢您精心回答bobince。

我理解你的观点，人们可能不喜欢在他们的页面上包含 php 文件。因此，我删除了第 1 部分并使用重定向 url 和 cookie 对其进行了更改。显然，在真实脚本中，我还可以防止 SQL 注入。

但是我的主要问题仍然存在。为了使用 Paypal 跟踪销售，我需要在网站上的 Paypal 按钮中添加一个输入字段。这看起来像这样：

```
<input type="text" name="notify_url" value
="http://www.artinthepicture.com/sellmyart/ipn.php?xyz=<?php echo $_GET['xyz'] ?>" style="width:1px; height:1px; border:0"> 
```

那里没有安全问题，因为不会发生任何奇怪的事情。主要问题是用户的代码可能会出现很多问题。例如，如果他们使用 mysql 数据库来建立他们的商店，他们可能会有一个单独的字段用于 paypal 按钮。现在，如果他们回显此 paypal 按钮，额外的输入字段将与上面完全相同。这是一个问题，因为 $_GET[xyz] 那时不会解析。

[编辑：由于排名低无法评论]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T11:19:04.827

抱歉，第二部分应该是：

```
<input type="text" name="notify_url" value ="http://www.mydomain.com/ipn.php?xyz=<?php echo $_GET[xyz]; ?>" style="width:1px; height:1px; border:0"> 
```

# networking - 获取从 NIC 发送和接收的累积字节数

> ID：718762
> 
> 赞同：2
> 
> 时间：2009-04-05T11:04:32.880
> 
> 标签：networking, windows-server-2008, prtg

是否有一种简单的方法（可能通过脚本）来获取从[Windows Server 2008](https://en.wikipedia.org/wiki/Windows_Server_2008)上的[NIC](https://en.wikipedia.org/wiki/Network_interface_controller)发送和接收的累积字节数？

例如，NIC 当前显示大约 18 MB 的发送数据和 765 MB 的接收数据。

由于我的服务器提供商没有提供查看每月带宽使用情况的简单方法，因此获取 NIC 数据似乎是最可靠的方法。

我知道我可以使用[PRTG](http://www.paessler.com/prtg)通过[SNMP](https://en.wikipedia.org/wiki/Simple_Network_Management_Protocol)获取当前使用数据，但它只是一个平均值，因为传感器每 60 秒检查一次。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-09T02:13:46.007

在 PowerShell (CTP2v3) 中，以下命令会有所帮助。（我有三个接口）。但是，一旦 NIC 重新启动，此信息将归零。

```
$computer = "LocalHost";
$namespace = "root\CIMV2";
$Tcpip_NI = Get-WmiObject -class Win32_PerfRawData_Tcpip_NetworkInterface -computername $computer -namespace $namespace;
$Tcpip_NI | Select BytesReceivedPersec, BytesSentPersec, BytesTotalPersec;

$netsh_interface_stats = netsh interface ip show interface;
$netsh_interface_stats | Select-string "In Octets";
$netsh_interface_stats | Select-string "Out Octets"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-05T11:08:00.173

有`netstat -e`帮助吗？它似乎无法区分 NIC，但您的维护接口流量也可能混入其中。

否则，这听起来像是[WMI](https://en.wikipedia.org/wiki/Windows_Management_Instrumentation)和[PowerShell](https://en.wikipedia.org/wiki/Windows_PowerShell)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-05T11:42:07.687

您可以使用[IronRuby](https://en.wikipedia.org/wiki/IronRuby)或[IronPython](https://en.wikipedia.org/wiki/IronPython)脚本并使用[System.Net.NetworkInformation](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.aspx)命名空间，尽管创建一个快速的 C# 或 VB.NET 控制台应用程序可能更容易。

您可能需要类[IPv4InterfaceStatistics](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.ipv4interfacestatistics_properties.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-11T17:02:05.933

只是一个简短的说明：

以下内容对我来说非常有效 - 请注意数字为负数，您需要为此建立一些逻辑。我在混合环境中运行，并且没有任何东西都可以使用 PowerShell，所以我的解决方案是使用[WMIC](https://en.wikipedia.org/wiki/Windows_Management_Instrumentation)：

```
wmic Win32_PerfRawData_Tcpip_NetworkInterface Get BytesReceivedPersec,BytesSentPersec,BytesTotalPersec 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-06T23:42:50.880

我为我自己的问题找到了一个现有的解决方案，[PRTG Network Monitor](http://www.paessler.com/prtg)版本 7。

它具有与[WMI](https://en.wikipedia.org/wiki/Windows_Management_Instrumentation)接口并获取网卡数据的传感器。非常好 ：）

# iphone - 圆形 UIScrollView

> ID：718767
> 
> 赞同：7
> 
> 时间：2009-04-05T11:09:44.397
> 
> 标签：iphone, objective-c, uiscrollview

我有一个`UIScrollView`图像。当用户到达最后一张图像并滑动手指以查看下一张图像时，我想显示第一张图像。同样，当用户在第一张图像并滑动前一张图像时，我想显示最后一张图像。简而言之，这将是一个循环的东西。

我该如何实施？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-05T12:45:29.173

您需要使用 contentOffset 和 contentSize。

每次有滚动事件时，您可以考虑检查用户是否处于说 currentLength - 1，如果是，则将图像动态添加到滚动视图。

这应该适用于 5，但如果您不发布早期图像，可能会给您带来内存方面的麻烦。

我认为此解决方案不适用于索引小于 0 的图像。

或者...假设您有图像 I1 到 I5。使用以下图像布局滚动视图： I5 I1 I2 I3 I4 I5 I1

自动滚动到 I1（I5 的高度），没有动画。

如果用户滚动到此标记之上，则将它们（无动画）自动滚动到第二个 I5 I1 对。如果用户试图在接近尾声的 I5 下方滚动，您可以将它们自动滚动回第一个 I5 I1 对。如果您在没有动画的情况下滚动并滚动到正确的高度，则会显示图像是无穷无尽的。

我不确定这是否会非常敏感，但它可能会产生您正在寻找的效果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-05T20:24:43.890

要实现的关键是 UIScrollView 对它重绘的内容非常智能。

您可以移动其子视图，只要屏幕上可见的视图不移动或更改，就不会重绘。您可以重置任何屏幕外子视图的框架（并在必要时调整 contentOffset）而不会导致重绘。

当然，启用分页会使这更容易，但我相信你也可以从 didScroll 做到这一点。

您应该生成 5 个视图，将它们添加为子视图，并将滚动视图的偏移量设置为五个视图的中心。随着 scrollView 滚动，您可以切换子视图 - 就像循环一样。无需删除并重新添加子视图，您只需重置框架即可。

这（在简单的层面上）也是 UITableView 的工作方式——它重用了一小部分单元格视图并不断重置内容偏移量。

# python - Python 中 compile() 的可逆版本

> ID：718769
> 
> 赞同：3
> 
> 时间：2009-04-05T11:12:02.783
> 
> 标签：python, metaprogramming

我正在尝试在 Python 中创建一个与 compile() 等效的函数，但也可以让我取回原始字符串。为了消除歧义，我们将这两个函数称为 comp() 和 decomp()。那是，

```
a = comp("2 * (3 + x)", "", "eval")
eval(a, dict(x=3)) # => 12
decomp(a) # => "2 * (3 + x)" 
```

返回的字符串不必*相同*（"2*(3+x)" 可以接受），但它必须基本相同（"2 * x + 6" 不会）。

这是我尝试过的*不起作用*的方法：

*   在 compile 返回的代码对象上设置一个属性。您不能在代码对象上设置自定义属性。
*   子类化代码，以便我可以添加属性。代码不能被子类化。
*   设置 WeakKeyDictionary 将代码对象映射到原始字符串。代码对象不能被弱引用。

这是有效的方法，但有问题：

*   将文件名的原始代码字符串传递给 compile()。但是，我失去了在其中实际保留文件名的能力，我也想这样做。
*   保留将代码对象映射到字符串的真实字典。这会泄漏内存，尽管由于编译很少见，但对于我当前的用例来说是可以接受的。如果必须的话，我可能可以定期通过 gc.get_referrers 运行密钥并杀死死掉的密钥。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-05T23:51:08.403

这是一个奇怪的问题，我最初的反应是，你最好完全做其他事情来完成你想做的任何事情。但这仍然是一个有趣的问题，所以这是我的破解之道：我将原始代码源设为代码对象的未使用常量。

```
import types

def comp(source, *args, **kwargs):
    """Compile the source string; takes the same arguments as builtin compile().
    Modifies the resulting code object so that the original source can be
    recovered with decomp()."""
    c = compile(source, *args, **kwargs)
    return types.CodeType(c.co_argcount, c.co_nlocals, c.co_stacksize, 
        c.co_flags, c.co_code, c.co_consts + (source,), c.co_names, 
        c.co_varnames, c.co_filename, c.co_name, c.co_firstlineno, 
        c.co_lnotab, c.co_freevars, c.co_cellvars)

def decomp(code_object):
    return code_object.co_consts[-1] 
```

* * *

```
>>> a = comp('2 * (3 + x)', '', 'eval')
>>> eval(a, dict(x=3))
12
>>> decomp(a)
'2 * (3 + x)' 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-05T12:39:41.170

我的方法是将代码对象包装在另一个对象中。像这样的东西：

```
class CodeObjectEnhanced(object):
    def __init__(self, *args):
        self.compiled = compile(*args)
        self.original = args[0]
def comp(*args):
    return CodeObjectEnhanced(*args) 
```

然后，无论何时需要代码对象本身，都使用 a.compiled，而无论何时需要原始代码，都使用 a.original。可能有一种方法可以让 eval 将新类视为普通代码对象，将函数重定向到调用 eval(self.compiled) 。

这样做的一个好处是原始字符串与代码对象同时被删除。不管你怎么做，我认为存储原始字符串可能是最好的方法，因为你最终会得到你使用的确切字符串，而不仅仅是一个近似值。

# visual-studio-2008 - Visual Studio 加载项 API 资源

> ID：718770
> 
> 赞同：5
> 
> 时间：2009-04-05T11:13:56.773
> 
> 标签：visual-studio-2008, api, visual-studio-addins

除了 MSDN，在哪里可以找到有关为 Visual Studio .net 2008 创建加载项的示例和 API 信息？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-05T11:56:13.643

1.  下载[Visual Studio SDK](http://www.microsoft.com/downloads/details.aspx?FamilyID=30402623-93ca-479a-867c-04dc45164f5b&DisplayLang=en)。
2.  转到[Visual Studio 可扩展性](http://msdn.microsoft.com/en-us/vsx/default.aspx)开发人员中心
3.  访问[Visual Studio 可扩展性论坛](http://social.msdn.microsoft.com/Forums/en-US/vsx/threads)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-05T11:19:56.913

[创建 Visual Studio 加载项](http://www.code-magazine.com/Article.aspx?quickid=0710082)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-05T11:59:59.190

书籍：[Visual Studio 可扩展性](http://www.wrox.com/WileyCDA/WroxTitle/Professional-Visual-Studio-Extensibility.productCd-0470230843.html)(Wrox)

![Visual Studio 可扩展性](https://media.wiley.com/product_data/coverImage/43/04702308/0470230843.jpg)

# java - 如何在 JTextArea 中显示日文字符

> ID：718776
> 
> 赞同：6
> 
> 时间：2009-04-05T11:17:51.210
> 
> 标签：java, swing, unicode

显示日文字符时 JTextArea 有奇怪的行为 - 我得到众所周知的空白矩形而不是汉字。最奇怪的是 JTextField 完美地显示它们（在这两种情况下我都使用“Tahoma”字体系列）。另外，如果我输入这段代码：

```
 Font f = new Font("123", Font.PLAIN, 12); // This font doesn't exists
    problemTextArea.setFont(f); 
```

...在我将日语字符串写入问题文本区域之前，它会显示汉字！

PS对不起我的英语。

**更新：** 我正在使用 Windows

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-06T12:27:51.500

问题是 JTextArea 使用与 JTextField 不同的默认字体。在我编写的必须支持多语言的应用程序中，我遇到了同样的问题。

出现问题的原因是 JTextArea 通常用于显示等宽字体，例如 Courier New。通常，Java 不包含用于显示 Kanji 的等宽图形字体的额外映射。

您的修复工作有效，因为没有名为“123”的字体，因此采用默认值（对话框）。“对话框”字体在内部映射到您平台的 font.properties 文件中的字体系列。这将与 JTextField 使用的字体相同。

我有以下修复，以确保在所有图形组件中使用相同的字体定义。您还可以找到 JTextArea 的特定键并进行更改。这样您就不必担心任何组件的字体，它们将通过对话框进行初始化。

```
Object fontDefinition = new UIDefaults.ProxyLazyValue("javax.swing.plaf.FontUIResource", null, new Object[] { "dialog", new Integer(Font.PLAIN), new Integer(12) });

java.util.Enumeration keys = UIManager.getDefaults().keys();
while (keys.hasMoreElements()) {
    Object key = keys.nextElement();
    Object value = UIManager.get(key);
    if (value instanceof javax.swing.plaf.FontUIResource) {
        UIManager.put(key, fontDefinition);
    }
} 
```

# c# - Visual Basic 6.0 的转换工具比较

> ID：718780
> 
> 赞同：15
> 
> 时间：2009-04-05T11:20:49.237
> 
> 标签：c#, vb.net, vb6, vb6-migration

这里有没有人使用以下任何一种（或任何其他工具）将您的 vb6 代码转换为 .net 语言？

[**Artinsoft 的升级伴侣**](http://www.artinsoft.com/pr_vbcompanion.aspx) （转换为 c# 和 vb.net）

[**vbmigration 合作伙伴**](http://www.vbmigration.com/) （转换为 vb.net）

它们的效果如何？您转换了多大的项目？

之后还有多少工作要做？您对生成的 .net 项目有多满意。支持是怎样的？是否有任何地方为此类工具的用户提供支持论坛，这两家供应商似乎都没有提供。

他们收取什么费用，他们的价格没有公布，我听说上述两个例子的不同来源的价格差异很大

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-19T13:59:25.437

我是 Code Architects 的总经理 Eugenio La Mesa。我阅读了一些关于我们的 VB 迁移合作伙伴和一般转换工具的评论，并认为我可能会添加一些有用的提示。

首先，我们的转换软件确实支持所有 VB6 图形属性和方法——唯一的例外是 DrawMode 和 ClipControls。我们甚至支持 AutoRedraw 属性和用户定义的 ScaleMode 坐标，因此将类似 CAD 的程序迁移到 VB.NET 非常适合我们的软件。www.vbmigration.com 上的代码示例部分包含许多图形密集型 VB6 应用程序示例，这些应用程序已轻松转换为 .NET。

其次，让我澄清一下我们的价格结构。我们出售两个不同版本的 VB 迁移合作伙伴：专业版可以转换 VB6 应用程序，最大。50,000 行代码，而企业版没有大小限制，并支持一些额外的高级功能，例如与源代码控制软件集成以及生成与原始 VB6 DLL 二进制兼容的 .NET 组件，这使您可以实现 N 层基于 COM 的应用程序的分阶段迁移。

专业版的价格为 399 英镑，是截至 2009 年 6 月 30 日 Microsoft UK 营销活动期间的特别促销活动，仅限英国和最多 50K 行代码 (LOC) 的应用程序。企业版的价格可能会有所不同，因为它取决于几个因素，包括要迁移的许可证数量和 LOC 数量。这解释了为什么您可能会看到不同的报价。此外，作为对经济形势的回应，我们最近略微降低了标价。我们还计划从主要产品中取出一些功能并单独提供它们，这将导致更灵活的价格结构。

老实说，对于具有 25-50K LOC 的应用程序，我们通常建议手动重写。事实上，我们的重点是企业市场领域，您经常会在其中找到具有数十万甚至数百万 LOC 的 VB6 应用程序。在这些情况下，手动重写很少是可行的选择：它需要太多熟练的 VB6/.NET 开发人员，需要的时间太长，或者成本太高。我们最近发布了一个与具有 650K LOC 的应用程序相关的案例研究；我们的一位客户目前正在迁移一个具有大约 1500 万个 LOC 的怪物应用程序！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-05T12:10:24.453

将 VB6“升级”到 .NET 是用词不当。你得到的只是 .NET 中的 VB6 代码；通常，您可以通过重构/重新架构获得更好的结果 - 例如，使用不同的类模型。例如，也许设计为可单元测试。或者使用 IoC。

如果你只是想让代码工作（并且你有信心可以测试它），那很好。

就个人而言，我会认真考虑更手动的端口。而且我有**很多**遗留的 VB6 代码，所以我知道其中的痛苦。

每次我们遇到这个问题时，我们都只是用 C# 重新编写了它——作为一种方法，它已经多次证明了自己。

实际上——我推荐[Brownfield 应用程序开发](http://www.manning.com/baley/)（Manning）——它可能会在你开始之前提供一些有价值的见解。

![棕地](https://www.manning.com/baley/baley_cover150.jpg)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-05T17:57:22.217

我想您已经看到了有关将 VB6 迁移到 VB.NET 的工具的[问题。](https://stackoverflow.com/questions/638152/best-development-tools-for-upgrading-from-vb6-0)

两家公司都在此 Microsoft UK[页面上发布了其](http://msdn.microsoft.com/en-gb/dd408373.aspx)**基本**产品的英国市场特别优惠价格。当然，您需要了解基本产品的限制和市场价格才能做出现实的判断，因此您可能确实需要联系他们:(

*   Artinsoft Upgrade Companion Developer Edition [199 英镑](http://www.artinsoft.com/visual-basic-upgrade-companion-developers.aspx)，最多可使用 50,000 行代码。**编辑**现在提供一个[免费版本](http://www.artinsoft.com/artinsoft-renews-its-efforts-to-ease-the-transition-from-microsoft-visual-basic-6-to-microsoft-net-framework.aspx)，最多可以执行 10,000 行代码。
*   Code Architects 的 Visual Basic 迁移合作伙伴专业版[399 英镑](http://www.vbmigration.com/campaignuk.aspx)。他们告诉我这也适用于多达 50,000 行代码。

内置的 Microsoft 升级向导是可悲的 -[据编写它的人说](http://www.devx.com/vb/Article/16822)- 他当然来自 Artinsoft，所以他想向你推销更好的东西。Microsoft UK 还[表示](http://msdn.microsoft.com/en-gb/dd408373)，Artinsoft 和 Code Architects 工具比内置的升级向导更好。

**编辑**：我联系了 Code Architects 以获得报价，他们的回复非常快。与经验更差的*Angry Hacker*提出的Stack Overflow[问题](https://stackoverflow.com/questions/264375/upgrading-a-large-vb6-app-to-net-opinions-on-vb-migration-partner)不同。但随后 Francesco Balena 突然出现在 Stack Overflow 上，在 12 小时内回答了他的问题，这更令人鼓舞。

 ** * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-06T13:14:55.927

问题是转换工具不支持 VB6 图形命令或 VB6 打印机型号。另外，在处理 ActiveX 控件时，您会遇到很多极端情况。我知道我们自己的 CAD/CAM 应用程序不会使用任何转换工具进行转换，因为 UI 中内置了许多调整，以使其与 VB6 表单引擎顺利工作。

这些是转换工具失败的地方，因为 WinForm 引擎需要它自己的调整。当我们的软件从 DOS 迁移到 VB3 时，也发生了同样的事情。有时无法替代手动转换。

话虽如此，您可以做一些事情来使转换变得相当容易。首先确保您的应用程序是分层构建的。这样，您可以一次转换一层，测试并继续。它还具有在每一步都为您提供可用软件的优势。我建议从顶层（表单）层开始，往下走。

确保以 VB6 为中心而非以 Basic 为中心的任何内容都位于接口后面。几年前 .NET 首次出现时，我创建了一个 Canvas 接口并使用 VB6 图形命令实现了它。我在 VB.NET 中使用相同的 Canvas 接口，但现在它使用图形对象。打印机也是如此。

几乎所有的代码都从我们的表单中移到表单调用的类中。表单本身实现了 UI 类使用的接口。当我们切换到 .NET 时，我们对表单如何与系统的其余部分交互有了一个精确的定义，并且表单转换变得相当容易。

所有这些步骤都在 VB6 中完成，并通过了我们正常的发布问答流程。然后我们开始转换。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-05T12:01:32.727

上面提到的任何一个工具我都没有用过，但是稍加准备，Visual Studio 中的升级工具就绰绰有余了。

您需要做的第一件事是从 Microsoft获得[Visual Basic 6 Code Advisor 。](http://msdn.microsoft.com/en-us/vbasic/ms789135.aspx)这对于让您的项目为迁移做好准备非常有帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-07T22:31:40.760

去年 vb 迁移伙伴专业版的报价为 2500 美元。我没买所以可以评论

# c# - isprefix 比在 C# 中比较两个字符串更昂贵吗？

> ID：718782
> 
> 赞同：1
> 
> 时间：2009-04-05T11:23:33.647
> 
> 标签：c#, string, comparison

我正在做一些比较两个字符串的计算。如果我知道它们的长度相同，调用 isprefix 或 If ("string"=="string") 是否更昂贵？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-05T11:35:27.110

为什么不测试？很容易使用 StopWatch 类进行比较，包括不同长度的字符串和不同的比较选项。

我希望核心没有显着差异，因为 IsPrefix 本质上是：

```
public bool IsPrefix(string comp, string prefix) {
  return Compare(comp, 0, prefix.Length, prefix, 0, prefix.Length);
} 
```

但是，由于应用的 I18N 级别，String 的 operator == 和 CompareInfo 类之间可能存在差异。

最后，您需要进行测量，但我预计 99% 的情况下，任何差异对整体应用程序性能都没有显着影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T12:00:36.007

我会假设相等运算符实际上比较了两个字符串哈希值，而不是实际内容（至少作为快速失败）

由于前缀匹配需要在哈希值比较之前创建子字符串，因此前缀匹配应该比完全相等匹配慢得多。

如果你有足够的字符串需要前缀匹配，你应该考虑实现一个 TRIE 结构（[http://paste.lisp.org/display/12161](http://paste.lisp.org/display/12161)）

# comments - 代码中的注释页眉和页脚真的有必要吗？

> ID：718783
> 
> 赞同：22
> 
> 时间：2009-04-05T11:23:57.577
> 
> 标签：comments

许多公司编码标准要求每个文件中都有一个大的注释页眉和页脚。就像是：

```
// MyFile.cpp
//
//  Copyright (c) 200x Company ABC
// 
//  This file is a copyrighted... blah blah blah
//

<... some code ...>

// Copyright (c) 200x Company ABC
//
//  Change history:
//     1.0  -  Blah
//     1.1  -  Blah, blah.. 
```

所以，问题是——我们为什么需要这个？是否真的有必要为文件内容主张版权，或者这是一种已成为标准的错误做法？有人在不需要这样的公司工作吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-05T11:29:52.630

首先，更改历史是没有意义的，为此使用您的 SCM。

版权声明不是严格要求的（版权是自动的）¹，但如果您正在发布源代码，那么可能包含它会被认为更安全²。完整的许可证声明在单独的文件中可能会更好，然后引用（这就是[Boost](http://www.boost.org/users/license.html#FAQ)所做的）。

¹ [维基百科](http://en.wikipedia.org/wiki/Copyright)有一个合理的总结，但你确实需要自己的法律建议。

²尤其是律师谨慎行事。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-05T11:29:24.660

我的公司不需要这个......并且更改历史记录的位置应该在源代码控制而不是代码文件中。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-05T12:00:02.823

我在一家非常大的软件公司工作，有许多奇怪的标准。

这**不是**其中之一。我们不需要在源代码中添加任何页眉或页脚。版权不需要在每个类文件上说明。更不用说由任何可用的源代码控制管理系统处理的修订。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-05T12:06:29.720

在我实习的公司里，我们在所有源文件中都使用了这些标准的注释标题——天哪，他们惹恼了我。每次我不得不阅读一个新的源代码文件时，我不得不向下滚动 1 或 2 个屏幕长度，因为每个文件都有所有更改历史。在我在那里的 6 个月里，我根本没有使用过变更历史，也从未见过任何人使用过。

我个人的意见是，您不应该放置很少需要的东西。当然，您需要在某个地方拥有更改历史记录之类的东西，但它应该在您可以查找的地方，以防您真正需要它。如果您坚持将其嵌入到源文件中，也许在页脚中？

标准的标题注释很痛苦，应该非常简约，甚至更好的是不存在。把那个巨大的 ASCII-art 扔到页脚或自述文件中，我不在乎，但请不要管我的标题 :)

如果你的搜索结果的前 800 像素填充了一些巨大的谷歌徽标和版权声明，你认为谷歌会成功吗？:P

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-05T14:43:57.500

有趣的是，Google[要求](http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml#File_Comments)在其 C++ 源上进行版权声明。这对我来说似乎总是多余的，特别是考虑到文件将（希望！）被备份并驻留在源代码管理中，以防发生版权战。我也不确定用作者的名字标记来源：其他人是否需要获得编辑/使用文件的权限？！

源代码管理绝对消除了对更改历史记录页脚的需要，以及我目睹的人们注释掉旧代码并将其留在那里的奇怪做法！好的 SCM 软件将让您浏览文件修订并提供版本比较。好问题 ：）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-05T12:26:53.680

标题中的更改历史要求可能是在他们拥有更改历史系统之前遗留下来的。我曾使用过手动进行评论的系统，并且会在源代码控制系统中创建虚假更改！

我目前工作的地方代码文件页眉或页脚不需要版权和更改历史记录。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-05T11:27:47.987

我在一家公司工作，我们不需要这个。我们对默认情况下所做的事情拥有版权，因此它只是源文件中不必要的文本噪音。

更改历史记录可能很有用，但非常有限。如果您尝试记录您更改的每个分号或运算符，它很快就会变旧。此外，更改历史不会为您提供有关特定作者到底更改了哪些内容的详细信息。而是谁来过这里并做了什么。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-05T11:28:31.230

无需要求版权（取决于司法管辖区）。您通常自动拥有您作品的版权。

对于合作中的代码，总是很高兴知道源文件上的内容和时间。

我从未见过没有某种页眉/页脚组合的内部代码。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-05T11:34:49.267

如果这涉及到企业标准，我们根本就没有。但是尽管如此，当该文件应该被分发或应该被其他设施使用时，我们在每个文件的开头添加了版权声明和联系数据。它有助于收集反馈。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-05T15:17:10.650

很多这些东西是历史宿醉。但这并不意味着它没有用。

*对文件*的更改进行评论是毫无意义的，该文件在多年前就不再是代码组织的单位。我把标题放在我的函数上，但那是为了解释函数/方法的目的（加上它使代码更容易扫描）。我还在这些函数头中放置了简明的更改历史……不是因为代码中的更改历史是必要的，而是因为 SCM 系统并不完美，而且我以前见过 SCM 数据库丢失。这就像备份一样——灾难只需要在你开始每天担心这些事情之前发生在你身上一次。

我的工作伙伴把我逼疯了，因为他们虔诚地依赖 SCM 来跟踪他们的变化，但也没有在 SCM*中*添加适当的评论。因此，当不可避免的管理问题发生后故障分析发生时，他们必须连续几个小时坐在那里，试图弄清楚*为什么*他们在三年前做出了特定的改变。

# c# - C#：重构方法以显示适当的 groupbox 并隐藏其他的更好的方法？

> ID：718784
> 
> 赞同：1
> 
> 时间：2009-04-05T11:26:44.760
> 
> 标签：c#

有没有更好的方法来重构以下方法，其目的是确保适当的组框与其他组框分开显示，就好像它们在列表中循环一样？是否可以将这一切重构为一个单独的 if 语句 +“没有其他关键字”？

```
 // DisplayGroupBox(grpSounds);
    void DisplayGroupBox(GroupBox GroupBoxControls)
    {
        grpSounds.Visible = false;
        grpAlerts.Visible = false;
        grpFilters.Visible = false;

        GroupBox.Visible = true;
    } 
```

已编辑：我的意思是在一个语句中重构以显示适当的 groupbox 而没有 else 语句。也许是一种使用 &&、|| 和此类运算符的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-05T11:47:34.210

我可能会保持原样。您可以将所有这些操作压缩到一行中，但该方法的意图不会那么清楚。我认为它的方式很好，再多的重构也不能真正让它变得更简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T11:48:26.317

如果您在一个集合中有您的分组框（即只需将 grpSounds、grpAlerts、grpFilters 添加到列表中），您可以这样做：

```
void DisplayGroupBox(GroupBox groupControlYouWantToDisplay)
{
    foreach(var box in listControls.Where(gb => gb != groupControlYouWantToDisplay)
       box.Visible = false;
    groupControlYouWantToDisplay.Visible = true;
} 
```

# java - jsp获取ip地址

> ID：718785
> 
> 赞同：2
> 
> 时间：2009-04-05T11:27:02.840
> 
> 标签：java, jsp

防止某人两次投票的最佳方法是什么？我如何获取用户的IP地址？如果他们在大型网络上怎么办？该网络上的每个人都会显示相同的IP吗？谢谢

* * *

更新： request.getRemoteAddr() 和 request.getRemoteHost() 返回服务器名称，而不是客户端的主机名和 ip。还有其他人有什么好主意吗？

* * *

好的，所以让我们忘记两次投票的事情。我只是想获取用户的IP地址？我尝试了 request.getRemoteAddr() 和 request.getRemoteHost() 并认为我正在获取服务器地址。我可以访问两个独立的网络并且获得相同的 IP 地址 :(

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-05T11:35:30.170

在您的 JSP 中，使用**request.getRemoteAddr()**。这将返回作为字符串发送请求的代理的 IP 地址。

此外，**request.getRemoteHost()**将尝试获取完全限定的主机名。但是，如果它无法解析名称，则 IP 地址将在**getRemoteAddr()**中返回。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-05T14:23:20.360

AFAIK 防止第二次投票的唯一方法是进行身份验证。显然这并不总是可能的，因此您必须降低单个用户投大量票的可能性。

*   通过源 IP 限制投票。使用[getRemoteAddr()](http://java.sun.com/products/servlet/2.3/javadoc/javax/servlet/ServletRequest.html#getRemoteAddr())允许，比如说……每小时投票一次？……每分钟？...这将取决于您期望获得多少投票。根据经验调整数量。
*   在每个投票投票的响应中植入一个[cookie](http://java.sun.com/products/servlet/2.3/javadoc/javax/servlet/http/HttpServletResponse.html#addCookie(javax.servlet.http.Cookie)) ，该 cookie在投票结束后过期。
*   通过检查和验证标头（如`Referer`和`User-Agent`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-05T11:38:12.627

如果用户位于[NAT 路由器](http://en.wikipedia.org/wiki/Network_address_translation)或[代理服务器](http://en.wikipedia.org/wiki/Proxy_server)之后，您将看到他们具有相同的 IP 地址。因此，这并不是让用户投票一次的最佳方式。

另一种方法是使用[cookie](http://en.wikipedia.org/wiki/HTTP_cookie)，但同样可以删除 cookie 并再次投票。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-03-15T15:45:50.643

要获取路由器/防火墙后面的客户端 IP，您可以使用 `request.getHeader("X-FORWARDED-FOR")`.

> X-Forwarded-For (XFF) HTTP 标头是一个事实上的标准，用于识别通过 HTTP 代理或负载平衡器连接到 Web 服务器的客户端的原始 IP 地址。 [http://en.wikipedia.org/wiki/X-Forwarded-For](http://en.wikipedia.org/wiki/X-Forwarded-For)

但请记住，此值可以由您和客户之间的代理更改。虽然它*应该*是正确的IP。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-05T11:37:57.917

您可以使用 request.getRemoteAddr() 获取 IP 地址。如果网络使用的是 NAT 路由器，所有用户都将获得相同的地址

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-08-21T05:17:59.237

在您的 JSP 页面中，只需使用以下表达式：`${pageContext.request.remoteAddr}`

# javascript - JavaScript 和可能的浏览器缓存问题

> ID：718792
> 
> 赞同：3
> 
> 时间：2009-04-05T11:30:26.280
> 
> 标签：javascript, html

我是 JavaScript 新手，遇到以下问题：

我会在一个单独的文件中编写 JS 代码，将该文件包含在 html 代码中。JS 代码运行良好。没问题。我会继续对 JS 代码进行一些更改，在浏览器窗口中单击“刷新”，有时会出现问题。我对 JS 代码所做的更改把事情搞砸了。代码没有按预期的方式工作。所以我开始寻找问题，但代码非常好。所以我清除了浏览器的缓存 - 仍然没有。我撤消了对 JS 代码的更改，一切正常。我把新代码放回去 - 在几次“刷新”点击之后 - 突然之间它起作用了。我在使用 Safari 4、Firefox 2.0 时遇到了这个问题。我没有尝试过其他浏览器。

我的问题是 - 我是否必须使用一些 JS 技术或仅从浏览器禁用浏览器缓存，或者有不同的问题？感谢您的时间和帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-05T11:41:56.800

如果您使用会破坏缓存的随机密钥引用您的 JS 文件：

例如：

```
var randomnumber=Math.floor(Math.random()*10000)
var scriptfile='http://www.whatever.com/myjs.js?rnd='+randnumber; 
```

如果没有别的，很适合调试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-05T15:30:58.900

当您重新加载/刷新网页时，大部分时间脚本都会从缓存中重新加载。您可以通过在单击刷新按钮的同时按住 shift 键来强制浏览器重新加载外部脚本文件。

如果这不起作用，您可能需要检查您和网页之间是否有代理服务器。如果是本地网页，shift 按钮应该可以解决问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-05T20:19:56.740

就个人而言，我使用 CTRL + F5 强制刷新。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-05T12:12:04.107

我发现当我调试一些 JS 时，我只是在另一个选项卡中打开了 javascript 的 URL。当我上传时，我首先切换到选项卡，点击刷新，然后测试代码。或者在 FireFox WebDeveloper 插件中启用缓存。

# css - 如何从无序列表创建兼容 IE6 的网格布局？

> ID：718793
> 
> 赞同：1
> 
> 时间：2009-04-05T11:31:42.003
> 
> 标签：css, internet-explorer-6

我想将 HTML 无序列表设置为看起来像网格。期望的结果是这样的：

[![Firefox 渲染的网格](https://i.stack.imgur.com/Ul7Ri.png)](https://i.stack.imgur.com/Ul7Ri.png)
[（来源：[georgebrock.com](http://georgebrock.com/misc/css-grid/firefox.png)）]

我有以下 HTML：

```
<ul class="grid">
  <li>First item. This is sometimes longer than the second item.</li>
  <li>2nd item</li>
  <li class="reset">Third item</li>
  <li>Fourth item</li>
</ul> 
```

由以下 CSS 设置样式：

```
ul.grid {
  /* Remove standard browser list styles */
  list-style:none;
  margin:0;
  padding:0;

  /* Add specific styles */
  width:13.5em; /* Clear internal floats (IE) */
  overflow:hidden; /* Clear internal floats (proper browsers) */
  background-color:#f00;
  border-bottom:0.5em solid #f00;
}

ul.grid li {
  display:inline; /* IE6 double margin float bug fix */
  width:5em;
  float:left;
  padding:0.5em;
  margin-left:0.5em;
  border-top:0.5em solid #f00;
  padding-bottom:1000.5em; /* } Balance height of items */
  margin-bottom:-1000em;   /* } */
  background-color:#fff;
}

ul.grid li.reset {
  clear:left;
} 
```

在 Firefox、Safari 等中，这会根据需要呈现。然而，在 IE 6 中，清除不会以相同的方式影响后续元素：

[![由 Internet Explorer 6 呈现的网格](https://i.stack.imgur.com/B2y3x.png)](https://i.stack.imgur.com/B2y3x.png)
[（来源：[georgebrock.com](http://georgebrock.com/misc/css-grid/ie6.png)）]

您可以在此处查看实时示例代码：http: [//georgebrock.com/misc/css-grid/](http://georgebrock.com/misc/css-grid/)

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-04T22:58:53.333

问题很老，但很有趣。无法找到 IE6，但在 IE7 中也存在同样的问题。对此没有真正的解决方案，但在 IE7 中，它可以通过使用宽度和使用相邻兄弟 (+) 组合器来实现。对于 IE6，每个列表元素都必须有新的类。所以，不是一个真正的网格，而是它`looks like a grid`：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <title>Test case: CSS grids</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <style type="text/css" media="screen">
            ul.grid {
                /* Remove standard browser list styles */
                list-style: none;
                margin: 0;
                padding: 0;

                /* Add specific styles */
                width: 220px; /* Clear internal floats (IE) */
                overflow: hidden; /* Clear internal floats (proper browsers) */
                border-bottom: 1px solid red;
            }

            ul.grid li {
                display: inline; /* IE6 double margin float bug fix */
                float: left;
                border: 1px solid red;
                padding: 5px;
                padding-bottom:1000.5em; /* } Balance height of items */
                margin-bottom:-1000em; /* } */
            }
            ul.grid li.reset {
                clear:left;
            }
            ul.grid li {
                width: 98px;
                border-left: 1px solid red;
                border-right: 1px solid red;
                padding-left: 5px;
            }
            ul.grid li + li {
                width: 98px;
                border-left: 1px solid red;
                border-right: 1px solid red;
                padding-left: 5px;
            }
            ul.grid li + li + li {
                width: 97px;
                border-left: 1px solid red;
                border-right: 0 none;
                padding-left: 5px;
            }
            ul.grid li + li + li + li {
                padding-left: 9px;
                border-left: 0 none;
                border-right: 1px solid red;
            }
            ul.grid li + li + li + li + li {
                width: 98px;
                border-left: 1px solid red;
                border-right: 1px solid red;
                padding-left: 5px;
            }
            ul.grid li + li + li + li + li + li {
                width: 98px;
                border-left: 1px solid red;
                border-right: 1px solid red;
                padding-left: 5px;
            }
            ul.grid li + li + li + li + li + li + li {
                width: 97px;
                border-left: 1px solid red;
                border-right: 0 none;
                padding-left: 5px;
            }
            ul.grid li + li + li + li + li + li + li + li {
                padding-left: 9px;
                border-left: 0 none;
                border-right: 1px solid red;
            }
            ul.grid li + li + li + li + li + li + li + li + li {
                width: 98px;
                border-left: 1px solid red;
                border-right: 1px solid red;
                padding-left: 5px;
            }
            ul.grid li + li + li + li + li + li + li + li + li + li {
                width: 98px;
                border-left: 1px solid red;
                border-right: 1px solid red;
                padding-left: 5px;
            }
        </style>
    </head>

    <body>

        <ul class="grid">
            <li class="reset">First item. This is sometimes longer than the second item.</li>
            <li>2nd item</li>
            <li class="reset">Third item</li>
            <li>Fourth item</li>
            <li class="reset">Fifth item</li>
            <li>Sixth item is maybe longer for a line.</li>
            <li class="reset">7th item</li>
            <li>Eight item is again longer</li>
            <li class="reset">9th item. This is sometimes longer than other.</li>
            <li>Tenth item</li>
        </ul>

    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T15:10:46.773

我更愿意为此使用表格，但如果您不能（例如，CMS 或第三方正在向您推送此标记）。

如果这不是一个选项，我会尝试使用 javascript 检查 DOM 以确定 2 个 LI 的最大高度，然后将另一个设置为该最大值。

像 jQuery 这样的库可以帮助解决这个问题。
请参阅： [在 IE 中获取自动高度元素的实际高度](https://stackoverflow.com/questions/692523/getting-actual-height-of-an-auto-heighted-element-in-ie)

# javascript - 使用 Firebug 调试 JavaScript 事件

> ID：718795
> 
> 赞同：22
> 
> 时间：2009-04-05T11:34:14.260
> 
> 标签：javascript, jquery, debugging, firebug

我需要为某个事件设置一个断点，但我不知道它在哪里定义，因为我有一大堆最小化的 JavaScript 代码，所以我无法手动找到它。

是否可以以某种方式将断点设置为例如具有 ID 的元素的单击事件`registerButton`，或者在某处找到绑定到该事件的函数？

我找到了 Firefox 插件**Javascript Deobfuscator**，它显示了当前执行的 JavaScript，这很好，但是我需要调试的代码是使用**jQuery**，所以即使是最简单的事件也会有大量的函数调用，所以我不能使用它任何一个。

有没有专门为**jQuery**制作的调试器？

有谁知道一些工具可以将*缩小的 JavaScript*转换回*格式化的*代码，比如`function(){alert("aaa");v=3;}`转回

```
function() {
   alert("aaa");
   v = 3;
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-05T13:22:25.527

好吧，这可能比它的价值麻烦多了，但看起来你有三件事要做：

1.  消除源。我喜欢[这个快速而肮脏的在线工具](http://jsbeautifier.org/)。只需粘贴您的代码并单击按钮。从来没有让我失望过，即使是最时髦的 JavaScript。

2.  *所有*jQuery 事件绑定器都被路由到`"jQuery.event.add"`（[这是未构建的源代码中的样子](https://github.com/jquery/jquery/blob/master/src/event.js)），因此您需要找到该方法并在那里设置断点。

3.  如果你已经走到这一步，你需要做的就是在断点处检查调用堆栈，看看谁调用了什么。请注意，由于您位于库的内部位置，因此您需要检查一些跳转（因为代码调用`"jQuery.event.add"`很可能只是其他 jQuery 函数）。

请注意，3) 需要 Firebug 用于 FF3。如果您像我一样喜欢使用 Firebug 为 FF2 进行调试，您可以使用古老的`arguments.callee.caller.toString()`方法来检查调用堆栈，`".caller`根据需要插入尽可能多的 "。

* * *

**编辑**：另外，请参阅[“如何使用 FireBug（或类似工具）调试 Javascript/jQuery 事件绑定”](https://stackoverflow.com/questions/570960/how-to-debug-javascript-jquery-event-bindings-with-firebug-or-similar-tool/571087#571087)。

您也许可以摆脱：

```
// inspect    
var clickEvents = jQuery.data($('#foo').get(0), "events").click;
jQuery.each(clickEvents, function(key, value) {
    alert(value) // alerts function body
}) 
```

上面的技巧会让你看到*你的*事件处理代码，你可以开始在*你的*源代码中寻找它，而不是试图在 jQuery 的源代码中设置断点。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-05T11:43:29.290

首先将缩小的 jquery 或您使用的任何其他源替换为格式化的。我发现的另一个有用的技巧是在 firebug 中使用分析器。探查器显示正在执行的函数，您可以单击其中一个并去那里设置断点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-07-31T11:20:51.037

只是一个更新：

[Google Chrome](http://www.chromium.org/getting-involved/dev-channel)（其中的*开发工具*）支持各种断点，以及**Event 上的 break**。

**所有**事件以及**设备方向**更改和**计时器**

您可以观看[一段视频](http://www.youtube.com/watch?v=N8SS-rUEZPg)，其中展示了**Google IO**的所有功能。

还有内置的**deminifier** / **unminimizer** / **prettifier**将帮助您在压缩的 javascript 文件上手动设置断点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-14T11:36:08.913

您可以做的是获得缩小的代码 - 您将可以访问它。根据 Crescent Fresh 的 (1) 选项或您喜欢的任何方法对代码进行分解。

然后下载并安装 Fiddler - 所有网络开发人员都应该安装这个令人难以置信的工具。

然后使用 Fiddler，您可以使用本地驱动器上的本地 unminified.js 拦截浏览器对 minified.js 文件的调用。

Fiddler 基本上会拦截浏览器对特定文件的请求，并可以为浏览器提供不同的文件。因此，您现在可以查看未缩小的代码。

简单的。

另一种选择是使用 Firefox 并在其上安装 Venkman 调试器 - 比 Firebug 恕我直言要好得多 - Venkman 调试器有一个“漂亮的打印”选项，可以在运行时直观地取消缩小缩小的代码。现在在任何你想要的地方坚持你的断点......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-29T10:03:57.277

另一个更新：现在有一个可以美化 JavaScript 的 firebug 扩展：

[https://addons.mozilla.org/en-US/firefox/addon/javascript-deminifier/](https://addons.mozilla.org/en-US/firefox/addon/javascript-deminifier/)

它在 Firefox 12.0 中非常适合我。

感谢这个[答案](https://stackoverflow.com/a/4823647/13153)发现它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-05T11:37:57.073

您可以`debugger`在 javascript 文件中的任何位置使用该命令。当解释器命中该语句时，如果调试器可用（如 Firebug），则它会被触发

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-05T11:56:38.840

找到该行并放置一个断点。然后重新加载站点/页面。然后firebug会在遇到断点时自动暂停语句的执行。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-15T10:07:29.380

这将完成这项工作。 [http://jsbeautifier.org/](http://jsbeautifier.org/) 您也可以在 Google 上搜索 javascript 美化器。

# opengl - GLSL中的快速排序？

> ID：718810
> 
> 赞同：6
> 
> 时间：2009-04-05T11:44:19.697
> 
> 标签：opengl, glsl, gpgpu, quicksort

我正在考虑使用 GLSL 着色器将大量处理移植到 GPU。我偶然发现的一个直接问题是，在其中一个步骤中，算法需要维护一个元素列表，对它们进行排序并取几个最大的元素（哪个数字取决于数据）。在 CPU 上，这只是使用 STL 向量和 qsort() 来完成，但在 GLSL 中我没有这样的设施。有没有办法解决这个缺陷？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-14T20:21:18.570

披露：我真的不知道 GLSL——我一直在使用具有不同编程语言的 AMD Stream SDK 进行 GPGPU 编程。

从您对 Bjorn 回答的评论中，我了解到您对使用 GPU 对庞大的数据库进行排序**不**感兴趣——比如创建反向电话簿或其他任何东西，但是相反，您有一个小数据集，每个片段都有自己的数据集种类。更像是尝试进行中值像素过滤？

我只能笼统地说：

对于小型数据集，排序算法真的无关紧要。虽然人们一直在担心哪种算法对于超大型数据库来说是最好的排序算法，但对于小 N 来说，使用快速排序、堆排序、基数排序、Shell 排序、优化冒泡排序、未优化冒泡排序、等等。至少它在 CPU 上并不重要。

GPU 是 SIMD 设备，因此它们希望每个内核都以锁步执行相同的操作。计算很便宜，但分支很昂贵，并且每个内核以不同方式分支的数据相关分支非常、非常、非常、昂贵。

因此，如果每个内核都有自己的小数据集进行排序，并且要排序的数据数量取决于数据，并且每个内核可能是不同的数字，那么您最好选择最大大小（如果可以的话），填充具有无穷大或一些大数的数组，并让每个内核执行完全相同的排序，这将是未优化的无分支冒泡排序，如下所示：

伪代码（因为我不知道 GLSL），9 分

```
#define TwoSort(a,b) { tmp = min (a, b); b = a + b - tmp; a = tmp; }
for (size_t n = 8; n ; --n) {
  for (size_t i = 0; i < n; ++i) {
    TwoSort (A[i], A[i+1]);
  }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-05T12:13:51.823

你看过这篇文章吗？ [https://developer.nvidia.com/gpugems/GPUGems2/gpugems2_chapter46.html](https://developer.nvidia.com/gpugems/GPUGems2/gpugems2_chapter46.html)

我不确定您是在寻找快速排序算法还是快速排序算法。文章中的算法使用归并排序...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-26T08:49:57.573

*我对GPU编程一无所知。*

我会使用堆排序而不是快速排序，因为您说您只需要查看前几个值。堆可以及时构建`O(n)`，但是获取top值是`log(n)`. 因此，如果您需要的值的数量明显小于元素的总数，您可以获得一些性能。

# sql-server - 在 SQLCLR 中使用可选参数

> ID：718817
> 
> 赞同：1
> 
> 时间：2009-04-05T11:48:50.357
> 
> 标签：sql-server, sqlclr

我在 MSSQL 2005 Server SQLCLR 中有一个存储过程。是否可以为它定义一个可选参数？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T11:53:15.820

想到的最快的（如果不是最简洁的）解决方案是使用带有默认值的可选参数的“shim”存储过程，该存储过程使用这些默认值调用内部存储过程，就像您对“可选”参数使用方法重载一样C# 3 及更早版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T00:34:45.490

只为你想要默认的值传入 Nulls 有什么问题吗？
当然，这可能并非在所有情况下都有效。
有时您可能想知道实际值是否确实为 Null，因此避免使用默认值。
如果是这种情况，那么我会求助于添加一个额外的“*默认*”参数。

```
[Microsoft.SqlServer.Server.SqlProcedure]
public static void MySproc(SqlInt32 pID, SqlBoolean UseDefault_pID)
{
    pID = (UseDefault_pID == SqlBoolean.True && pID == SqlInt32.Null)
        ? SomeDefaultPIDValue : pID;
} 
```

这样就不必编写额外的“*包装器*”存储过程来接收具有默认值的可选参数，然后调用您的 CLR 存储过程。

传入 Null 时使用默认值：UseDefault_pID = 1 传入 Null
时保留实际值：UseDefault_pID = 0

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-05T13:54:26.653

您可以将其作为 null 传递，然后执行以下操作：

```
create proc sp_find_person
 @fname varchar(30)
 @lname varchar(60)
as
begin
 select * from person a
 where (a.fname = @fname or @fname is null) 
   and (a.lname = @lname or @lname is null);
end
go 
```

将两个参数都传递为 null 将返回 person 的所有行。

传递带有值的@fname 和@lname null 将返回所有具有该@fname 的人。

传递带有值的@lname 和@fname null 将返回所有具有该@lname 的人。

使用非空值传递两者将找到具有指定 fname 和 lname 的所有人员。

# email - 为什么仍在使用 POP3 协议？

> ID：718820
> 
> 赞同：8
> 
> 时间：2009-04-05T11:49:30.697
> 
> 标签：email, imap, protocols, pop3

我仍在尝试了解电子邮件协议。似乎 IMAP 比 POP3 更强大。那么，为什么 POP3 协议能够幸存下来呢？GMail 等流行的电子邮件服务仍然支持它。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-05T11:51:20.693

因为 POP3 在服务器端不需要那么多存储空间。而且因为它更简单，更容易实现。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-05T13:02:20.023

我认为部分原因是 IMAP 通常用于将电子邮件保留在服务器上的情况，而 POP 几乎专门用于将电子邮件下载到本地计算机的情况，这是大多数 ISP 为其提供电子邮件设施的情况客户希望您做（以及大多数客户可能也希望做的事情，尽管随着他们更多地接触 Internet 以及 gmail 和 yahoo 等东西而变得更少）

电子邮件提供商可能更喜欢它的另一个原因是它可以进行轮询，就像 RSS 新闻阅读器一样。POP 客户端将打开与服务器的 TCP/IP 连接，对自身进行身份验证，请求任何电子邮件并进行所需的任何处理，然后关闭连接。

IMAP 客户端通常在它们运行的​​整个过程中与服务器保持一个或多个 TCP/IP 套接字打开，从而占用这些资源。ISP 更喜欢 POP 的另一个原因。

Google 邮件支持 POP 和 IMAP 协议。

（PS 我的意思并不是说我在尝试 ISP。我认为我在上面归因于他们的原因是非常务实和明智的。）

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-05T19:17:50.930

几个原因：

1.  POP3 确实需要少得多的服务器端存储。
2.  POP3 更容易实现。
3.  默认情况下，POP3 是私有的（它假定您希望在下载后从服务器上删除电子邮件）。
4.  最初，几乎所有 ISP 的存储限制都很小（因为它们是免费的大型存储电子邮件服务，现在这不那么重要了），因此删除您下载的电子邮件是必须的。
5.  （为了完整性——感谢 Evan）POP 客户端打开一个到服务器的 TCP/IP 连接，对自身进行身份验证，询问任何电子邮件并进行所需的任何处理，然后关闭连接。IMAP 客户端通常在它们运行的​​整个过程中与服务器保持一个或多个 TCP/IP 套接字打开，从而占用这些资源。
6.  POP 是一种实现起来要简单得多的协议，并且可以使用相同数量的资源处理更多的客户端。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-05T12:34:09.840

雅虎邮件仍然不提供 IMAP。我的猜测是，这是因为与 Outlook 相比，我更有可能使用他们的网站，这意味着我必须看到他们的广告。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-05T11:53:03.527

许多电子邮件服务（例如 ISP 提供的服务）仅提供有限大小的邮箱。这使得有必要将您的消息下载到您的计算机上，以便能够存储当今常见的大量电子邮件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-03-29T12:46:10.457

另一个原因是 POP3 提取器。您可能有一个中央 IMAP 邮箱，您想从您的所有其他帐户下载邮件以将所有邮件保存在同一个地方。这通常通过 POP3 提取器来完成，这些提取器会定期轮询您的其他邮箱并从那里将邮件加载到您的主邮箱中。

尽管确实存在 IMAP 提取器，但大多数提取器仍然仅支持 POP3，如果您的其他邮箱不支持 POP3，则使用提取器将其与主邮箱链接可能会遇到麻烦。

# asp.net - 如何自定义日历控件？

> ID：718833
> 
> 赞同：0
> 
> 时间：2009-04-05T11:58:01.223
> 
> 标签：asp.net

我正在使用日历控件显示日历。

每个日期都显示为链接按钮。

但我只想从当前日期开始最后 30 天（日期），以便为客户点击启用。在那些日子里，我将在 SelectionChanged 事件上编写一些代码。但目标是必须禁用其他日期才能点击。

他们不应该有链接按钮。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T12:53:12.557

尝试编写自定义日渲染函数并将其附加到   `**[DayRender](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.calendar.dayrender.aspx)**`   日历控件的事件。这应该很简单。

### 就像是：

```
<asp:Calendar ID="C1" runat="server" OnDayRender="Calendar1_DayRender" /> 
```

### 和

```
private void Calendar1_DayRender(object sender, DayRenderEventArgs e)
{
    if (e.Day.Date < BeginningOfDateRange ||
        e.Day.Date > EndOfDateRange)
    {
        e.Cell.BackColor = System.Drawing.Color.LightGray
        e.Day.IsSelectable = False
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T12:56:46.587

您可以处理日历控件的**DayRender 事件**来自定义显示的每一天的外观。日历控件显示的每一天都会调用此事件处理程序：

```
<asp:Calendar ID="Calendar1" runat="server" OnDayRender="Calendar1_DayRender">
</asp:Calendar> 
```

在代码隐藏中：

```
protected void Calendar1_DayRender(object sender, DayRenderEventArgs e)
{
    e.Day.IsSelectable = IsDateValid(e.Day.Date);
} 
```

其中**IsDateValid()**是您实施以检查是否应启用日期的方法。

# linq - LINQ to DataSets for MySQL 互操作

> ID：718835
> 
> 赞同：1
> 
> 时间：2009-04-05T11:59:37.693
> 
> 标签：linq, entity-framework, linq-to-dataset

我正在构建一个必须支持 MSSQL 和 MySQL 数据库的应用程序。为了避免存储过程等的重复，我正在考虑使用数据访问应用程序块从任一数据库中检索范围广泛、非常通用的数据集，然后使用与 DB 无关的 LINQ 代码进行更具体的数据访问。

我的另一个选择是使用实体框架，因为最新的 SQL/Connect 库显然支持它，但我最近看到了很多关于 EF 的坏消息，所以我有一些疑问。

哪条路线更好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T12:02:49.947

你考虑[过 DbLinq](http://code2code.net/DB_Linq/)吗？我相信这现在已经转移到谷歌代码项目，但它通过 LINQ-to-SQL (SQL Server) 的 DataContext 方法支持 MySQL。

有一段时间没有任何官方发布，但[repo 是活跃](http://code.google.com/p/dblinq2007/source/list)的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T12:08:41.993

我会选择实体框架。您还应该知道 Entity Framework v2 将于今年推出，它具有更酷的功能。

# seo - 人们对 rel="canonical" 有什么看法？有人在用吗？

> ID：718851
> 
> 赞同：1
> 
> 时间：2009-04-05T12:11:31.690
> 
> 标签：seo

我刚从山景城的朋友那里收到一份备忘录（日期为 2 月 29 日）。显然他们希望我们[开始使用另一个标签来指定规范 urls](http://googlewebmastercentral.blogspot.com/2009/02/specify-your-canonical.html)。

作为一个建立了大量网站的人，这显然引起了我的兴趣，但我很想知道是否有其他人开始使用它？有人打算吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-05T13:38:47.703

有趣的是 Wikipedia 打算将所有替代 URL 编入索引，例如`http://en.wikipedia.org/wiki/Python_language`具有规范的 URL `/wiki/Python_(programming_language)`。

它也可能对分页或排序的内容有用，例如`/foobar?sorby=date`canonical `/foobar`。

就个人而言，我只是更喜欢通过添加规则从索引中排除所有非首选版本的页面`robots.txt`（在谷歌的情况下很简单，因为它在那里接受正则表达式）和`<meta robots>`. 它节省了我的带宽，结果可能是一样的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T13:57:25.040

如果您有一个不区分大小写的 Web 服务器，这很有用，因为指向[http://my.site.com/foo.html](http://my.site.com/foo.html)和[http://my.site.com/FOO.html](http://my.site.com/FOO.html)的链接将被视为两个单独的文档搜索引擎（从而降低该文档的页面排名）

当然，您可以通过 301 重定向到小写版本来解决此问题，但使用 rel=canonical 意味着您的用户可以少发出 1 个 HTTP 请求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-05T14:28:10.830

我已经正确使用了 Content-Location 标头。我不会急于实施谷歌的新“标准”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-05T12:14:25.113

如果您有相同内容的多个版本（可能是打印视图或不同的排序顺序），那么它似乎非常方便。我已经在几页上使用了它——虽然还没有任何数据显示它的影响。

# wpf - WPF：在 TreeViewItem 中正确存储对象

> ID：718858
> 
> 赞同：5
> 
> 时间：2009-04-05T12:15:42.663
> 
> 标签：wpf, treeview, casting

要将对象（例如，类的实例）存储在 TreeViewItem 中，我当前将对象存储在`TreeViewItem`'s中`Header`，然后覆盖`ToString`该类的方法，以便它显示正确的字符串标题；然后，我在活动期间将对象放回原处。

* * *

这是实现这类事情的正确方法，还是有更好、更合适的方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-05T12:54:17.140

“正确”的方法是将`object`' `TreeView`s （或`TreeViewItem`'s）`Items`集合添加并使用 a`HierarchicalDataTemplate`来控制项目的呈现方式：

*个人.cs*：

```
public class Person
{
    private readonly ICollection<Person> _children = new ObservableCollection<Person>();

    public string Name { get; set; }

    public ICollection<Person> Children
    {
        get
        {
            return _children;
        }
    }
} 
```

*Window1.xaml.cs*：

```
public Window1()
{
    InitializeComponent();

    var people = new List<Person>();
    var kent = new Person() { Name = "Kent" };
    kent.Children.Add(new Person() { Name = "Tempany" });
    people.Add(kent);
    _treeView.ItemsSource = people;
} 
```

*Window1.xaml*：

```
<TreeView x:Name="_treeView">
    <TreeView.Resources>
        <HierarchicalDataTemplate DataType="{x:Type local:Person}" ItemsSource="{Binding Children}">
            <TextBlock Text="{Binding Name}"/>
        </HierarchicalDataTemplate>
    </TreeView.Resources>
</TreeView> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-09-18T23:40:16.657

我认为上面的“答案”并没有回答实际问题，实际上原始问题表明问题作者已经对问题有了非常有效的解决方案。但是，提供的“答案”仅显示了如何将子对象附加到 TreeViewItem 以及如何使用自定义方法随后呈现它。尽管这很有用，但此答案并未解决原始问题的实际性质。

在许多情况下，TreeViewItem 需要附加一个不属于 TreeViewItem 的项目列表的外部对象。当用户从 TreeView 中选择 TreeViewItem 时，这有助于访问附加的外部对象以用于特定于应用程序的目的。这个概念与将子对象添加到 TreeViewItem 的想法完全不同。

与问题作者最初实施的解决方案相反，解决此问题的另一种方法是子类化 TreeViewItem 类并添加自定义信息，例如附加对象。该原理在文章[http://msdn.microsoft.com/en-us/library/1330h6a4.aspx](http://msdn.microsoft.com/en-us/library/1330h6a4.aspx)中有说明。在实现了这个自定义 TreeViewItem 子类之后，这个子类可以添加到 TreeView 或 TreeViewItem 的 Items 列表中。当用户从 TreeView 中选择项目时，从选择返回的对象将是自定义子类，其中将包含子类定义的任何自定义信息。

使用自定义 TreeViewItem 子类而不是 TreeViewItem 的另一个优点是自定义行为可以由子类实现。例如，要在用户将鼠标悬停在项目上时显示自定义工具提示，子类可以为自己设置一个 ToolTip 对象，代码如下：

```
ToolTip tip = new ToolTip() { Content = "Tooltip display value" };
ToolTipService.SetToolTip(this, tip); 
```

# c++ - 找到“最干净”数据子集的方法，即具有最低可变性的子集

> ID：718866
> 
> 赞同：1
> 
> 时间：2009-04-05T12:22:17.530
> 
> 标签：c++, linear-regression, best-fit-curve

我试图在几个数据集中找到一个趋势。趋势涉及找到最佳拟合线，但如果我认为该过程对于任何其他模型都不会太不同（可能更耗时）。

有3种可能的场景：

1.  **所有数据都符合单一趋势且可变性低的**所有良好数据****
***   **所有或大部分数据表现出巨大可变性并且必须丢弃整个数据集的**所有不良数据。*******   **部分好数据**，其中一些数据可能很好，而其余数据需要丢弃。****

 ****> 如果具有极端可变性的数据的净百分比太高，则必须丢弃整个数据集。这意味着基本上只有这种类型的数据，并且不良数据的百分比各不相同：
> 
> 0% 坏 = 案例 1
> 100% 坏 = 案例 2
> 
> 我只寻找低可变性的连续部分；即我不在乎是否有一些符合趋势的个别点

我正在寻找的是一种对数据集进行分段并搜索指定趋势的智能方法。由于问题的性质，我不是在寻找最适合整体趋势的部分。我知道具有“更清洁”数据的小节最终将具有与整体（包含异常值）略有不同的趋势线属性。这正是我想要的，因为这部分数据最能反映实际趋势。

我精通 C++，但由于我试图使代码开源和跨平台，所以我坚持 ISO C++ 标准。这意味着没有 .NET，但如果您有 .NET 示例，如果您还可以帮助我将其转换为 ISO C++，我将不胜感激。我也有 JAVA、一些汇编和 fortran 的知识。

数据集本身并不庞大，但大约有 1.5 亿个，因此蛮力可能不是最好的方法。

提前致谢

* * *

我知道我有一些事情悬而未决，所以让我澄清一下：

*   每个数据集可以并且可能会有不同的趋势；即我不是在所有数据集中寻找相同的趋势。
*   程序用户将定义他们想要的合身程度
*   程序用户将定义子集在考虑趋势拟合之前必须有多连续
*   如果程序被扩展以允许任何类型的拟合（不仅仅是线性），用户将定义要拟合的模型——这不是一个优先事项，如果上述查询得到解决，那么我相信这个扩展会相对琐碎
*   The outliers come about as a result of the nature of the experiment and the data acquisition technique whereby data from "bad" sections must still be collected even though these areas are known to give outliers. The discarding of these outliers DOES NOT imply that the data is being manipulated to fit any trend (statistics disclaimer, hehe).

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-05T12:37:16.073

The RANSAC algorithm is one approach to what you're looking for if I understand you right. [http://en.wikipedia.org/wiki/RANSAC](http://en.wikipedia.org/wiki/RANSAC)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T13:54:44.420

You might use the term "outlier" in your searches. An outlier is a particular point of data that represents either a special condition not captured in the experiment design, or a statistical fluke (a point grabbed from the exstreams of the distribution in a data set too small to expect that too happen).

Outlier elimination carries some risk of biasing the result by your expectation.

# asp.net - ASP.NET 工作流调用外部方法

> ID：718870
> 
> 赞同：1
> 
> 时间：2009-04-05T12:27:07.423
> 
> 标签：asp.net, workflow

我不确定我是否遗漏了一些明显的东西，在 ASP.NET 中使用 Windows 工作流时，我真的不知道如何将工作流的输出返回到 ASP.NET 工作流。

我有我的工作流设置来处理外部事件，所以我的网页可以调用它，这很好，但我如何再次获取信息？我是否必须查询 Workflow 对象才能找到我想要的信息？这似乎是错误的......

我认为我可以做的是在工作流中使用 CallExternalMethod，但由于运行时中只能有一个工作流外部数据服务实例，我不确定如何将它“附加”到各个页面？

我发现的所有示例似乎都使用 Page Workflow 示例，其中工作流的输出（当它调用 CallExternalMethod 时）只调用静态重定向方法。例如，如果我不想重定向，而是将工作流的结果打印到页面，我如何“捕获”该信息以便可以在页面中使用？（假设运行时是从像示例这样的包装器中调用的，所以不能只做 Label1.Text = bla 因为无法访问该变量）。

编辑：还是使用工作流将任何内容持久保存到数据库并让 ASP.NET 应用程序从那里查询给定数据（因为实例 GUID 可以用作 PK？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T13:40:30.010

此链接包含有关将信息传入和传出工作流的信息：

[http://books.google.com/books?id=s5eVXpNmQxgC&pg=PA32&dq=pro+windows+workflow+foundation#PPA241,M1](http://books.google.com/books?id=s5eVXpNmQxgC&pg=PA32&dq=pro+windows+workflow+foundation#PPA241,M1)

关于网页：
网页和上面链接中的 WinForm 示例的唯一区别是您需要使用 MaualWorkflowSchedulerService（这会捐赠网页使用的线程，而不是为工作流运行时创建一个新线程）。

因此，假设您在单击按钮中调用 ExternalMethod 类似这样的内容（DataEvents 是您为 Handle / Call 外部方法添加到运行时的服务）：

```
 AddHandler DataEvents.DataReceived, AddressOf workflowEventsDataReceived    
    manualScheduler = WorkflowrunTime.GetService(GetType(Hosting.ManualWorkflowSchedulerService))
    DataEvents.OnGetDataReceived(New ExternalDataEventArgs(WorkflowInstance.InstanceId))
    manualScheduler.RunWorkflow(WorkflowInstance.InstanceId) 
```

然后，workflowEventsDataReceived 中的方法，它是工作流内部 CallExternalMethod 的目标（通过您添加到 WorkflowrunTime 的服务）将能够更新您想要的所有标签。

不确定其中是否清楚，但如果需要更多帮助，请告诉我，上周末我自己也遇到了同样的问题。

# regex - 用于提取 POP3 标头的正则表达式

> ID：718874
> 
> 赞同：0
> 
> 时间：2009-04-05T12:36:22.160
> 
> 标签：regex, pop3

我正在尝试解决如何使用此正则表达式提取 POP3 标头

^(?[a-zA-Z-]+)(?(?=:).+)$

收货人：yer@ner.com

该组还返回我想避免的 ':' 字符。我正在努力解决这个问题，但做不到。

需要集体智慧:-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T13:51:30.927

请注意，这不会处理包装的标头。实际上，该正则表达式将采用一个包装的标头，并将其添加到一个真正的标头中。特别是如果包装的标题在以下行中没有“：”。

在 Sergej Andrejev 的 Regex 的基础上，这个将处理不捕获换行的问题：

```
^([^:\s+]+):(.*)$ 
```

然而，最好的办法是逐行读取标题，并进行相应的解析。这很痛苦（因为我不得不为生产代码这样做），但它是最准确的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T12:40:26.720

我会选择类似的东西

```
/^([^:]+):(.*)$/ 
```

那么你会有

*   $1 - 标题名称
*   2 美元 - 价值

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-07T09:20:25.233

抱歉，复制了错误的代码：
^(\S+):\s((\s\S)*)
它适用于多行。

# ruby-on-rails - 用于创建 HTML 电子邮件的 CMS 类型应用程序？

> ID：718876
> 
> 赞同：2
> 
> 时间：2009-04-05T12:37:55.010
> 
> 标签：ruby-on-rails, email

对于我正在开发的新 SaaS 应用程序，我希望最终用户能够创建可以发送给客户的“促销*”*；他们将能够通过直接（蜗牛）邮件、电子邮件或 SMS 文本消息来做到这一点。

通常，这些促销活动将是带有大量漂亮图形之类的 HTML 电子邮件。我不希望我的用户了解太多 HTML（如果有的话）（理想情况下，他们会有人来制作这些宣传片，但我不能保证，因为我的目标是小型企业和组织，他们可能没有 -现场 IT 人员）。我的应用程序将保存这些促销活动并允许对其进行修改。为了让最终用户更轻松，我正在讨论使用某种模板系统，例如 Textile，因此他们不需要了解 HTML，但可以创建漂亮的促销活动。

现在，这基本上相当于一个 CMS，但没有那么全面或功能丰富。我会更好地使用某种 CMS 并对其进行调整以满足我的需要，还是我可以自己编写自己的内容，因为它的核心是功能较少的 CMS？我的应用程序将使用 Ruby on Rails 编写，但我并不真正熟悉该框架的任何优质 CMS 系统（而且许多 Rails 应用程序似乎不喜欢与其他应用程序一起玩）。我要做的是保存模板，然后让用户稍后选择它（连同他们想要发送它的人员列表），并告诉 ActionMailer 将所选模板呈现为消息的正文，同时提供将收到它的客户的名字/姓氏。这听起来并不难创造，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T20:17:54.950

[Radiant CMS](http://radiantcms.org/)具有您所描述的内容。它是在[MIT 许可](http://github.com/radiant/radiant/blob/f909ad100c6d6d17882db112df442c59607bf5b4/LICENSE)下发布的，因此只要您保留版权声明，您就可以使用他们的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-08T07:09:34.693

[Rails 电子邮件预览](https://github.com/glebm/rails_email_preview)（rails 引擎）具有舒适的墨西哥沙发 CMS 集成：

![rails-email-preview 截图](https://raw.github.com/glebm/rails_email_preview/master/doc/img/rep-show.png)

![rails-email-preview 编辑截图](https://raw.github.com/glebm/rails_email_preview/master/doc/img/rep-edit-sofa.png)

更多关于[github](https://github.com/glebm/rails_email_preview)和 wiki的信息

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-05T12:45:34.227

看看这里： http: [//www.campaignmonitor.com/](http://www.campaignmonitor.com/)（它可以集成到您的应用程序中）。

# .net - 如何使用 NHibernate 中的 Criteria API 进行自定义投影？

> ID：718887
> 
> 赞同：4
> 
> 时间：2009-04-05T12:44:44.887
> 
> 标签：.net, nhibernate, hibernate, hql, criteria

使用 HQL，我可以像这样使用动态实例化：

```
select new ItemRow(item.Id, item.Description, bid.Amount)
from Item item join item.Bids bid
where bid.Amount > 100 
```

现在我需要使用 Criteria API 动态创建我的查询。如何获得与使用 HQL 获得的相同结果，但使用 Criteria API？

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-15T13:22:12.313

您可以使用 AliasToBean 结果转换器。( [Doc 1.2](http://www.hibernate.org/hib_docs/nhibernate/1.2/reference/en/html/querysql.html#d0e9192) ) 它将每个投影分配给同名的属性。

```
session.CreateCriteria(typeof(Item), "item")
  .CreateCriteria("Bids", "bid")
  .SetProjection(Projections.ProjectionList()
    .Add(Projections.Property("item.Id"), "Id" )
    .Add(Projections.Property("item.Description"), "Description" )
    .Add(Projections.Property("bid.Amount"), "Amount" ))
  .Add(Expression.Gt("bid.Amount", 100))
  .SetResultTransformer(Transformers.AliasToBean(typeof(ItemRow)))
  .List(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T12:47:45.580

假设您使用的是 NHibernate 2.0.1 GA，以下是相关文档：

[http://nhibernate.info/doc/nh/en/index.html#querycriteria-projection](http://nhibernate.info/doc/nh/en/index.html#querycriteria-projection)

希望有帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T12:44:34.847

当您使用投影时，返回类型变为 Object 或 Object[] 而不是标准类型。你必须使用变压器。

这是一个简单的 ResultTransformer：

```
 private class ProjectionTransformer implements ResultTransformer {
        private String[] propertysList;
        private Class<?> classObj;

        /**
         * @param propertysList
         */
        public ProjectionTransformer(String[] propertysList) {
            this.classObj = persistentClass;
            this.propertysList = propertysList;
        }

        /**
         * @param classObj
         * @param propertysList
         */
        public ProjectionTransformer(Class<?> classObj, String[] propertysList) {
            this.classObj = classObj;
            this.propertysList = propertysList;
        }

        @SuppressWarnings("unchecked")
        public List transformList(List arg0) {
            return arg0;
        }

        public Object transformTuple(Object[] resultValues, String[] arg1) {
            Object retVal = null;
            try {
                retVal = Class.forName(classObj.getName()).newInstance();
                int dot = -1;
                for (int i = 0; i < resultValues.length; i++) {
                    if ((dot = propertysList[i].indexOf(".")) > 0) {
                        propertysList[i] = propertysList[i].substring(0, dot);
                    }
                    PropertyUtils.setProperty(retVal, propertysList[i], resultValues[i]);
                }
            } catch (Exception e) {// convert message into a runtimeException, don't need to catch
                throw new RuntimeException(e);
            }
            return retVal;
        }
    } 
```

以下是你如何使用它：

```
ProjectionList pl = (...)
String[] projection = new String[]{"Id","Description","Bid.Amount"};
crit.setProjection(pl).setResultTransformer(new ProjectionTransformer(projection)); 
```

我没有测试它的关系（例如：Bid.Amount）。

# html - 如何使 DIV 不换行？

> ID：718891
> 
> 赞同：202
> 
> 时间：2009-04-05T12:52:46.457
> 
> 标签：html, css, word-wrap, nowrap

我需要创建一个包含多个其他 DIV 的容器 DIV 样式。如果将浏览器窗口调整为窄，则要求这些 DIV 不会换行。

我试图让它像下面那样工作。

```
<style>
   .container
   {
      min-width: 3000px;
      overflow: hidden;
   }
   .slide
   {
      float: left;
   }
</style>
<div class="container">
   <div class="slide">something</div>
   <div class="slide">something</div>
   <div class="slide">something</div>
   <div class="slide">something</div>
</div> 
```

这在大多数情况下都有效。但是，在某些特殊情况下，渲染是不正确的。我在IE7的RTL中发现容器DIV更改为3000px宽度；它变得一团糟。

有没有其他方法可以使容器 DIV 不包装？

* * *

## 回答 #1

> 赞同：280
> 
> 时间：2011-04-01T16:06:14.953

尝试`white-space: nowrap;`在容器样式中使用（而不是`overflow: hidden;`）

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2012-09-17T18:01:21.913

如果我不想定义最小宽度，因为我不知道元素的数量，唯一对我有用的是：

```
display: inline-block;
white-space: nowrap; 
```

但仅在 Chrome 和 Safari 中：/

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2013-06-09T00:03:09.493

以下内容对我有用，**没有浮动**（为了视觉效果，我稍微修改了你的示例）：

```
.container
{
    white-space: nowrap; /*Prevents Wrapping*/

    width: 300px;
    height: 120px;
    overflow-x: scroll;
    overflow-y: hidden;
}
.slide
{
    display: inline-block; /*Display inline and maintain block characteristics.*/
    vertical-align: top; /*Makes sure all the divs are correctly aligned.*/
    white-space: normal; /*Prevents child elements from inheriting nowrap.*/

    width: 100px;
    height: 100px;
    background-color: red;
    margin: 5px;
}
```

```
<div class="container">
   <div class="slide">something something something</div>
   <div class="slide">something something something</div>
   <div class="slide">something something something</div>
   <div class="slide">something something something</div>
</div>
```

div 可以用空格分隔。如果您不想要这个，请使用`margin-right: -4px;`而不是`margin: 5px;`for `.slide`（它很丑​​，但[处理起来很棘手](https://css-tricks.com/fighting-the-space-between-inline-block-elements/)）。

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2017-04-19T16:05:20.747

你需要的组合是

```
white-space: nowrap 
```

在父母和

```
display: inline-block; // or inline 
```

对孩子们

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2015-08-12T14:51:59.327

这对我有用：

```
.container {
  display: inline-flex;
}

.slide {
  float: left;
}
```

```
<div class="container">
  <div class="slide">something1</div>
  <div class="slide">something2</div>
  <div class="slide">something3</div>
  <div class="slide">something4</div>
</div>
```

[https://css-tricks.com/snippets/css/a-guide-to-flexbox/](https://css-tricks.com/snippets/css/a-guide-to-flexbox/)

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-04-05T12:55:11.413

`overflow: hidden`应该给你正确的行为。我的猜测是因为你在封装的 s上`RTL`搞砸了。`float: left``div`

除了那个错误，你得到了正确的行为。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2020-04-02T09:47:57.157

使用`display:flex`和`white-space:nowrap`

```
p{
  display:flex;
  white-space:nowrap;
  overflow:auto;
}
```

```
<h2>Sample Text.</h2>

<p>Some example text that will not wrap..lla et dictum interdum, nisi lorem egestas odio, vitae scelerisque enim ligula venenatis dolor. Maecenas nisl est, ultrices nec congue eget, auctor vitae massa. Fusce luctus vestibulum augue ut aliquet. Mauris ante ligula, facilisis sed ornare eu, lobortis in odio. Praesent convallis urna a lacus interdum ut hendrerit risus congue. Nunc sagittis dictum nisi, sed ullamcorper ipsum d</p>

<h3>Then some other text</h3>
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-02-29T18:30:59.757

尝试`width: 3000px;`用于IE的情况。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-10-16T22:07:19.247

以上都不适合我。

就我而言，我需要将以下内容添加到我创建的用户控件中：

```
display:inline-block; 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-05T13:09:39.647

该`min-width`属性在 Internet Explorer 中无法正常工作，这很可能是您的问题的原因。

阅读[信息](http://blog.throbs.net/2006/11/17/IE7+And+MinWidth+.aspx)和 [修复许多 IE CSS 问题的精彩脚本](http://dean.edwards.name/IE7/)。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-09-03T21:08:08.837

您可以使用

```
display: table; 
```

为您的容器，因此避免`overflow: hidden;`. 如果您仅将其用于翘曲目的，它应该可以完成这项工作。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-06-13T08:56:46.917

```
<div style="height:200px;width:200px;border:; white-space: nowrap;overflow-x: scroll;overflow-y: hidden;">
   <p>The quick brown fox jumps over the lazy dog. The quick brown fox jumps over the lazy dog.The quick brown fox jumps over the lazy dog.The quick brown fox jumps over the lazy dog.
   The quick brown fox jumps over the lazy dog.The quick brown fox jumps over the lazy dog.The quick brown fox jumps over the lazy dog.The quick brown fox jumps over the lazy dog.
   The quick brown fox jumps over the lazy dog.
   The quick brown fox jumps over the lazy dog.The quick brown fox jumps over the lazy dog.The quick brown fox jumps over the lazy dog.The quick brown fox jumps over the lazy dog.
   The quick brown fox jumps over the lazy dog.The quick brown fox jumps over the lazy dog.</p>
</div> 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2015-04-27T11:55:34.550

标签用于对文档中的`<span>`内联元素进行分组。
[（资源）](http://www.w3schools.com/tags/tag_span.asp)

# c# - 使用 Microsoft Scripting Control 评估“If”表达式（通过 c#）

> ID：718893
> 
> 赞同：0
> 
> 时间：2009-04-05T12:53:52.897
> 
> 标签：c#, .net, vbscript, expression

我有一些使用 Microsoft Scripting Control 来评估某些表达式的 c# 代码：

```
using MSScriptControl; // references msscript.ocx

ScriptControlClass sc = new ScriptControlClass();
sc.Language = "VBScript";
sc.AllowUI = true;

try
{
    Console.WriteLine(sc.Eval(txtEx.Text).ToString());
}
    catch (Exception ex)
{
    Console.WriteLine(ex.Message);
} 
```

（txtEx 是一个简单的文本字段）

数值表达式：“6+4”、“cos(34)”、“abs(-99)”、“round(1.234, 2)”等都可以

布尔表达式：“真或假”、“1=2”都可以

但是我如何评估一个简单的“如果”呢？我试过“if(true, 2, 3)”、“iif(true, 2, 3)”、“if (true) then 2 else 3”和“if (true) then 2 else 3 endif”

有人可以帮我评估简单的条件表达式吗？非常感谢任何帮助！

相对湿度

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-05T13:18:07.753

尝试将您的 IF 表达式包装在一个函数中

```
Function test
   if (true) then
      return true
   else
      return false
   end if
End function 
```

将函数添加到控件，然后使用 Run

```
Result = ScriptControl.Run("Test") 
```

（上面的代码未经测试，但沿途的东西应该可以工作）

查看此链接以获取更多信息

[http://support.microsoft.com/kb/184740](http://support.microsoft.com/kb/184740)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T09:53:32.450

```
using MSScriptControl; // references msscript.ocx

ScriptControlClass sc = new ScriptControlClass();
sc.Language = "VBScript";
sc.AllowUI = true;

// VBScript engine doesn’t have IIf function
// Adding wraper IIF function to script control.
// This IIF function will work just as VB6 IIf function.
sc.AddCode(@"Function IIF(Expression,TruePart,FalsePart)
                If Expression Then
                    IIF=TruePart
                Else
                    IIF=FalsePart
                End IF
            End Function");
try
{
    //define x,y variable with value
    sc.AddCode(@"x=5
                y=6");
    //test our IIF 
    Console.WriteLine(sc.Eval("IIF(x>y,x,y)").ToString());
}
catch (Exception ex)
{
    Console.WriteLine(ex.Message);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-05T13:12:34.647

您应该考虑使用作为 Windows Workflow Foundation 一部分的表达式评估引擎。评估者和设计者都可以与 WF 分开使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-05T13:54:43.827

```
if (true) then return 2 else return 3 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-06T11:50:20.703

感谢您的提示！在 Brummo 的帮助下，经过更多的试验，这似乎可行：

txtEx 包含以下文本：

```
function test
  if (1=1) then 
    test = true
  else 
    test = false
  end if
end function 
```

然后

sc.AddCode(txtEx.Text);

和

```
object[] myParams = { };
Console.WriteLine(sc.Run("Test", ref myParams).ToString()); 
```

这并不理想，因为我真的想评估一个表达式，而不是构建、加载和评估一个函数。（如果评估，我很惊讶 IIF 不适用于简单的一行）。

# c++ - c++中sizeof运算符是如何实现的？

> ID：718896
> 
> 赞同：12
> 
> 时间：2009-04-05T12:55:03.427
> 
> 标签：c++, sizeof

有人可以指出 C++ 中 sizeof 运算符的实现以及有关其实现的一些描述。

sizeof 是不能重载的运算符之一。

所以这意味着我们不能改变它的默认行为？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-05T13:00:38.590

`sizeof`不是 C++ 中的真正运算符。它只是插入一个等于参数大小的常量的特殊语法。`sizeof`不需要或没有任何运行时支持。

**编辑：**你想知道如何通过定义来确定类/结构的大小吗？这方面的规则是[ABI](http://en.wikipedia.org/wiki/Application_binary_interface)的一部分，编译器只是实现它们。基本上规则包括

1.  原始类型的大小和对齐定义；
2.  各种指针的结构、大小和对齐方式；
3.  在结构中打包字段的规则；
4.  关于虚拟表相关内容的规则（更深奥）。

但是，ABI 是平台特定的，并且通常是特定于供应商的，即在 x86 和（例如）IA64 上，`A`下面的大小会有所不同，因为 IA64 不允许未对齐的数据访问。

```
struct A
{
    char i ;
    int  j ;
} ;

assert (sizeof (A) == 5)  ; // x86, MSVC #pragma pack(1)
assert (sizeof (A) == 8)  ; // x86, MSVC default
assert (sizeof (A) == 16) ; // IA64 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-05T12:58:05.213

[**http://en.wikipedia.org/wiki/Sizeof**](http://en.wikipedia.org/wiki/Sizeof)

基本上，引用[Bjarne Stroustrup 的 C++ FAQ](http://www.research.att.com/~bs/bs_faq2.html#overload-dot)：

> Sizeof 不能重载，因为内置操作，例如将指针递增到数组中隐式依赖于它。考虑：

```
X a[10];
X* p = &a[3];
X* q = &a[3];
p++;    // p points to a[4]
    // thus the integer value of p must be
    // sizeof(X) larger than the integer value of q 
```

> 因此，程序员不能在不违反基本语言规则的情况下赋予 sizeof(X) 新的不同含义。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-05T13:01:24.533

不，你不能改变它。你希望从看到它的实现中学到什么？

`sizeof`使用更基本的操作无法用 C++ 编写什么。它不是函数，也不是库头文件的一部分，例如`printf`，或`malloc`. 它在编译器内部。

编辑：如果编译器本身是用 C 或 C++ 编写的，那么您可以认为实现是这样的：

```
size_t calculate_sizeof(expression_or_type)
{
   if (is_type(expression_or_type))
   {
       if (is_array_type(expression_or_type))
       {
           return array_size(exprssoin_or_type) * 
             calculate_sizeof(underlying_type_of_array(expression_or_type));
       }
       else
       {
           switch (expression_or_type)
           {
                case int_type:
                case unsigned_int_type:
                     return 4; //for example
                case char_type:
                case unsigned_char_type:
                case signed_char_type:
                     return 1;
                case pointer_type:
                     return 4; //for example

                //etc., for all the built-in types
                case class_or_struct_type:
                {
                     int base_size = compiler_overhead(expression_or_type);
                     for (/*loop over each class member*/)
                     {
                          base_size += calculate_sizeof(class_member) +
                              padding(class_member);
                     }
                     return round_up_to_multiple(base_size,
                              alignment_of_type(expression_or_type));
                }
                case union_type:
                {
                     int max_size = 0;
                     for (/*loop over each class member*/)
                     {
                          max_size = max(max_size, 
                             calculate_sizeof(class_member));
                     }
                     return round_up_to_multiple(max_size,
                            alignment_of_type(expression_or_type));
                }
           }
       }
   }
   else
   {
       return calculate_sizeof(type_of(expression_or_type));
   }
} 
```

请注意，这是非常伪代码。有很多我没有包括在内的东西，但这是一般的想法。编译器可能实际上并没有这样做。它可能会计算一个类型（包括一个类）的大小并存储它，而不是每次编写时都重新计算`sizeof(X)`。例如，也允许指针根据它们所指向的内容而具有不同的大小。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-05T13:06:28.670

sizeof 做它在编译时所做的事情。运算符重载只是函数，它们在运行时执行它们所做的事情。因此，即使 C++ 标准允许，也无法重载 sizeof。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-05T13:08:29.133

sizeof 是一个编译时运算符，这意味着它是在编译时计算的。

它不能被重载，因为它已经对所有用户定义的类型都有意义——类的 sizeof() 是类定义的对象在内存中的大小，而变量的 sizeof() 是对象的大小变量名占用内存。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-05T14:58:26.313

除非您需要查看 C++ 特定大小的计算方式（例如 v-table 的分配），否则您可以查看 Plan9 的 C 编译器。这比尝试解决 g++ 简单得多。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-06-07T17:20:06.673

多变的：

```
#define getsize_var(x) ((char *)(&(x) + 1) - (char *)&(x)) 
```

类型：

```
#define getsize_type(type) ( (char*)((type*)(1) + 1) - (char*)((type *)(1))) 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-04-05T14:29:58.330

查看[Gnu C++ 编译器](http://gcc.gnu.org/)的源代码，了解实际情况是如何完成的。

# language-agnostic - 可以在我的应用程序中实现支持 php/asp 的内置服务器吗？

> ID：718901
> 
> 赞同：0
> 
> 时间：2009-04-05T13:00:32.930
> 
> 标签：language-agnostic

我有生成 php/html/asp 网站的应用程序，我希望能够让从应用程序中测试网站的可能性。有没有可能这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T13:24:57.457

测试网站是一项相当复杂的任务。虽然您当然可以编写 Web 服务器和测试引擎，但我不确定您为什么要这样做。我建议使用[IIS](http://www.iis.net/)（因为您需要 ASP）作为您的 Web 服务器并将[其配置为支持 PHP](http://php.iis.net/)。然后使用[WatiN](http://watin.sourceforge.net/)或[Selenium](http://seleniumhq.org/)或类似的东西来测试您的网站。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T16:21:20.123

我必须同意 tvanfosson 的观点。包括一个成熟的独立 Web 服务器，以及一个同时支持 ASP 和 PHP 的服务器，是一项艰巨的任务。大概可以做，但不知道你们有没有人手或资源去做。

您最好的希望可能是在您的应用程序中包含一个自配置的 Web 服务器。对于 PHP，您可以只使用带有 Zend 引擎的 Apache 之类的开源 Web 服务器。我不太确定如何将 ASP 解释器与您的软件一起分发。

但是，我认为更实用的解决方案是简单地做 Dreamweaver 和大多数其他 HTML 编辑器/Web 开发工具所做的事情。由于用户可能已经可以访问 Web 服务器，因此您可以让他们提供 SFTP/SCP 的登录信息，然后让应用程序将代码上传到远程或本地服务器进行测试。

# c# - ListView 中奇怪的寻呼机行为

> ID：718916
> 
> 赞同：2
> 
> 时间：2009-04-05T13:10:06.277
> 
> 标签：c#, .net, asp.net

我在页面上的 ListView 控件中有一个标准页面，并且寻呼机正在工作，但是为了移动到下一个项目列表，我需要在它实际移动到下一组项目之前单击两次寻呼机链接。

寻呼机的代码是：

```
 <asp:ListView ID="lv_LostCard" runat="server" DataKeyNames="request_id" EnableViewState="false">
        <LayoutTemplate>
               <table width="550" border="1" class="table">
                    <asp:PlaceHolder ID="itemPlaceholder" runat="server" />
                </table> 
                <asp:DataPager ID="lv_Books_Pager" runat="server" PageSize="10">
                    <Fields>
                        <asp:NextPreviousPagerField ShowFirstPageButton="false" ShowPreviousPageButton="true" ShowNextPageButton="false" />
                        <asp:NumericPagerField />
                        <asp:NextPreviousPagerField ShowFirstPageButton="false" ShowPreviousPageButton="false" ShowNextPageButton="true" ShowLastPageButton="false" />
                    </Fields>
                </asp:DataPager>
            </LayoutTemplate>
            <ItemTemplate>               
            </ItemTemplate>
    </asp:ListView> 
```

后面的代码是：

protected void Page_Load(object sender, EventArgs e) { if (!Page.IsPostBack) { getLostCardsList(); } }

```
 protected void getLostCardsList()
    {
        using(LostCardsManagementDataContext LostCard = new LostCardsManagementDataContext())
        {
            var getLostCardsList = from lc in LostCard.lostcard_request_cards
                                   select lc;
            lv_LostCard.DataSource = getLostCardsList;
            lv_LostCard.DataBind();
        } 
```

有人能告诉我发生了什么以及如何解决吗？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-11-02T13:14:25.647

我真诚地对listview有疑问。

我找到了与您的问题相关的解决方案，似乎没有其他方法可以解决此问题。您需要调用 OnPreRender 方法将源重新绑定到 listview。

```
protected void listview_PreRender(object sender, EventArgs e)
{
    getLostCardsList();//your method for binding
} 
```

请注意，**在您的页面呈现之前调用 PreRender 事件。更**清楚的是，如果您的页面有回发事件将再次呈现。这意味着您需要将数据存储到服务器集合（即会话）中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-24T13:58:39.080

PagePropertiesChanged 事件中的 DataBind。

```
private void listview_PagePropertiesChanged(object sender, System.EventArgs e)
{
    listview.DataBind();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T13:15:45.560

你在代码中绑定你的列表视图吗？确保您只在非回发时这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-05T14:56:38.937

您已关闭 ListView 上的视图状态。尝试重新打开视图状态。

# perl - mod_perl headers_in 不工作

> ID：718926
> 
> 赞同：4
> 
> 时间：2009-04-05T13:22:26.013
> 
> 标签：perl, apache, mod-perl

我在 Red Hat 5.2 上将 mod_perl 2 与 Apache 2.2.3 一起使用，并且我正在尝试访问请求标头，但是 Apache2::RequestRec [headers_in](http://perl.apache.org/docs/2.0/api/Apache2/RequestRec.html#C_headers_in_)方法（或者更确切地说，它的返回值）的行为方式与我不同预计。

代码片段：

```
$logger->warn('version ' . $mod_perl::VERSION);
$logger->warn('r ' . $r);
my $headers = $r->headers_in;
$logger->warn('headers ' . $headers);
my $accept = $headers->get('Accept');
$logger->warn('got $accept');
$logger->warn($accept); 
```

给出以下日志输出：

```
WARN version 2.000004
WARN r Apache2::RequestRec=SCALAR(0x2ae0598e9ef0)
WARN headers APR::Table=HASH(0x2ae06cad15a0) 
```

一旦尝试对 APR::Table 进行任何访问，执行似乎就会停止。APR::Table 的绑定接口具有相同的效果 -`get('Accept')`即将行更改为：

```
my $accept = $headers->{Accept}; 
```

给出完全相同的日志输出。

根据上面的链接文档：

> 该表从 PerlHeaderParserHandler 阶段开始可用

所以我希望我的代码在 PerlResponseHandler 阶段运行，能够访问标头。

有谁知道我做错了什么？

**编辑：**使用 Data::Dumper 并没有真正澄清问题。

代码：

```
use Data::Dumper;
$logger->warn(Dumper($r));
my $headers = $r->headers_in;
$logger->warn($headers);
$logger->warn(Dumper($headers));
$logger->warn('have dumped $headers'); 
```

输出：

```
WARN $VAR1 = bless( do{\(my $o = '47143456365192')}, 'Apache2::RequestRec' );

WARN APR::Table=HASH(0x2ae071b06fd0) 
```

因此，即使通过 Data::Dumper 尝试进入 $headers 似乎也会导致执行停止。

**编辑：**尝试设置其中一个标题也失败了。

```
$logger->warn('reset accept');
$r->headers_in->{'Accept'}= 'everything';
$logger->warn('post set accept'); 
```

停止日志输出

```
WARN reset accept 
```

观点。我也尝试了`set(Accept => 'everything')`替代方法，结果相同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T12:58:39.773

apache日志中是否有任何内容？如果您的代码停止执行，似乎应该在某处出现错误，说明原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T05:31:19.270

发现问题：

我需要添加

```
use APR::Table; 
```

某处。有点奇怪，它很高兴能够创建一个 APR::Table 对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-07T20:23:56.620

您是否尝试过在不将标头对象分配给 $header 的情况下获取 Accept 标头：

```
my $accept = $r->headers_in->get('Accept'); 
```

这适用于我在 PerlResponseHandler 阶段运行的代码。

# png - 如何将 SDL 表面保存为 PNG 并获得正确的颜色？

> ID：718933
> 
> 赞同：4
> 
> 时间：2009-04-05T13:27:45.593
> 
> 标签：png, colors, sdl

我编写了一个简单的补丁来将 PNG 保存功能添加到[SDL_Image 库](http://www.libsdl.org/projects/SDL_image/)。它也几乎可以工作。问题是，所有的颜色都乱七八糟地出来了，而且我对 C 的了解还不够多，无法找出问题所在。任何人都可以看看这个并帮我解决它吗？

用例：

1.  加载一个 256 色的 PNG 图像`IMG_LoadPNG_RW`。
2.  保存它`IMG_SavePNG_RW.`
3.  看看它们是否相同。

修补：

```
Index: IMG_png.c
===================================================================
--- IMG_png.c   (revision 4475)
+++ IMG_png.c   (working copy)
@@ -76,17 +76,25 @@
    png_infop (*png_create_info_struct) (png_structp png_ptr);
    png_structp (*png_create_read_struct) (png_const_charp user_png_ver, png_voidp error_ptr, png_error_ptr error_fn, png_error_ptr warn_fn);
    void (*png_destroy_read_struct) (png_structpp png_ptr_ptr, png_infopp info_ptr_ptr, png_infopp end_info_ptr_ptr);
+   png_structp (*png_create_write_struct) (png_const_charp user_png_ver, png_voidp error_ptr, png_error_ptr error_fn, png_error_ptr warn_fn);
+   void (*png_destroy_write_struct) (png_structpp png_ptr_ptr, png_infopp info_ptr_ptr);
    png_uint_32 (*png_get_IHDR) (png_structp png_ptr, png_infop info_ptr, png_uint_32 *width, png_uint_32 *height, int *bit_depth, int *color_type, int *interlace_method, int *compression_method, int *filter_method);
+   void (*png_set_IHDR) (png_structp png_ptr, png_infop info_ptr, png_uint_32 width, png_uint_32 height, int bit_depth, int color_type, int interlace_method, int compression_method, int filter_method);
    png_voidp (*png_get_io_ptr) (png_structp png_ptr);
    png_uint_32 (*png_get_tRNS) (png_structp png_ptr, png_infop info_ptr, png_bytep *trans, int *num_trans, png_color_16p *trans_values);
    png_uint_32 (*png_get_valid) (png_structp png_ptr, png_infop info_ptr, png_uint_32 flag);
    void (*png_read_image) (png_structp png_ptr, png_bytepp image);
+   void (*png_write_image) (png_structp png_ptr, png_bytepp image);
    void (*png_read_info) (png_structp png_ptr, png_infop info_ptr);
+   void (*png_write_info) (png_structp png_ptr, png_infop info_ptr);
+   void (*png_set_PLTE) (png_structp png_ptr, png_infop info_ptr, png_colorp palette, int num_palette);
+   void (*png_write_end) (png_structp png_ptr, png_infop info_ptr);
    void (*png_read_update_info) (png_structp png_ptr, png_infop info_ptr);
    void (*png_set_expand) (png_structp png_ptr);
    void (*png_set_gray_to_rgb) (png_structp png_ptr);
    void (*png_set_packing) (png_structp png_ptr);
    void (*png_set_read_fn) (png_structp png_ptr, png_voidp io_ptr, png_rw_ptr read_data_fn);
+   void (*png_set_write_fn) (png_structp png_ptr, png_voidp io_ptr, png_rw_ptr read_data_fn);
    void (*png_set_strip_16) (png_structp png_ptr);
    int (*png_sig_cmp) (png_bytep sig, png_size_t start, png_size_t num_to_check);
 } lib;
@@ -120,6 +128,20 @@
            SDL_UnloadObject(lib.handle);
            return -1;
        }
+       lib.png_create_write_struct =
+           (png_structp (*) (png_const_charp, png_voidp, png_error_ptr, png_error_ptr))
+           SDL_LoadFunction(lib.handle, "png_create_write_struct");
+       if ( lib.png_create_write_struct == NULL ) {
+           SDL_UnloadObject(lib.handle);
+           return -1;
+       }
+       lib.png_destroy_write_struct =
+           (void (*) (png_structpp, png_infopp))
+           SDL_LoadFunction(lib.handle, "png_destroy_write_struct");
+       if ( lib.png_destroy_write_struct == NULL ) {
+           SDL_UnloadObject(lib.handle);
+           return -1;
+       }
        lib.png_get_IHDR =
            (png_uint_32 (*) (png_structp, png_infop, png_uint_32 *, png_uint_32 *, int *, int *, int *, int *, int *))
            SDL_LoadFunction(lib.handle, "png_get_IHDR");
@@ -127,6 +149,13 @@
            SDL_UnloadObject(lib.handle);
            return -1;
        }
+       lib.png_set_IHDR =
+           (void (*) (png_structp, png_infop, png_uint_32, png_uint_32, int, int, int, int, int))
+           SDL_LoadFunction(lib.handle, "png_set_IHDR");
+       if ( lib.png_set_IHDR == NULL ) {
+           SDL_UnloadObject(lib.handle);
+           return -1;
+       }
        lib.png_get_io_ptr =
            (png_voidp (*) (png_structp))
            SDL_LoadFunction(lib.handle, "png_get_io_ptr");
@@ -155,6 +184,13 @@
            SDL_UnloadObject(lib.handle);
            return -1;
        }
+       lib.png_write_image =
+           (void (*) (png_structp, png_bytepp))
+           SDL_LoadFunction(lib.handle, "png_write_image");
+       if ( lib.png_write_image == NULL ) {
+           SDL_UnloadObject(lib.handle);
+           return -1;
+       }
        lib.png_read_info =
            (void (*) (png_structp, png_infop))
            SDL_LoadFunction(lib.handle, "png_read_info");
@@ -162,6 +198,27 @@
            SDL_UnloadObject(lib.handle);
            return -1;
        }
+       lib.png_write_info =
+           (void (*) (png_structp, png_infop))
+           SDL_LoadFunction(lib.handle, "png_write_info");
+       if ( lib.png_write_info == NULL ) {
+           SDL_UnloadObject(lib.handle);
+           return -1;
+       }   
+       lib.png_set_PLTE =
+           (void (*) (png_structp, png_infop, png_colorp, int))
+           SDL_LoadFunction(lib.handle, "png_set_PLTE");
+       if ( lib.png_set_PLTE == NULL ) {
+           SDL_UnloadObject(lib.handle);
+           return -1;
+       }
+       lib.png_write_end =
+           (void (*) (png_structp, png_infop))
+           SDL_LoadFunction(lib.handle, "png_write_end");
+       if ( lib.png_write_end == NULL ) {
+           SDL_UnloadObject(lib.handle);
+           return -1;
+       }
        lib.png_read_update_info =
            (void (*) (png_structp, png_infop))
            SDL_LoadFunction(lib.handle, "png_read_update_info");
@@ -197,6 +254,13 @@
            SDL_UnloadObject(lib.handle);
            return -1;
        }
+       lib.png_set_write_fn =
+           (void (*) (png_structp, png_voidp, png_rw_ptr))
+           SDL_LoadFunction(lib.handle, "png_set_write_fn");
+       if ( lib.png_set_write_fn == NULL ) {
+           SDL_UnloadObject(lib.handle);
+           return -1;
+       }
        lib.png_set_strip_16 =
            (void (*) (png_structp))
            SDL_LoadFunction(lib.handle, "png_set_strip_16");
@@ -472,7 +536,7 @@
            palette->colors[i].g = i;
            palette->colors[i].b = i;
        }
-       } else if (info_ptr->num_palette > 0 ) {
+       } else if (info_ptr->num_palette > 0 ) {
        palette->ncolors = info_ptr->num_palette; 
        for( i=0; i<info_ptr->num_palette; ++i ) {
            palette->colors[i].b = info_ptr->palette[i].blue;
@@ -505,18 +569,167 @@
    return(surface); 
 }

-#else
+static void png_write_data(png_structp ctx, png_bytep area, png_size_t size)
+{
+   SDL_RWops *src;

-/* See if an image is contained in a data source */
-int IMG_isPNG(SDL_RWops *src)
+   src = (SDL_RWops *)lib.png_get_io_ptr(ctx);
+   SDL_RWwrite(src, area, size, 1);
+}
+/* write a png file */
+int IMG_SavePNG_RW(SDL_Surface *surface, SDL_RWops *src)
 {
-   return(0);
-}
+    png_structp png_ptr;
+    png_infop info_ptr;
+   png_colorp palette = NULL;
+    int start;
+   int colorType;
+   int i;
+    const char *error;
+   SDL_Palette *sdlPalette;
+   png_uint_32 height = surface->h;
+   png_uint_32 width = surface->w;
+   png_bytep *volatile row_pointers;
+   int row;

-/* Load a PNG type image from an SDL datasource */
-SDL_Surface *IMG_LoadPNG_RW(SDL_RWops *src)
-{
-   return(NULL);
+   if ( !src ) {
+       /* The error message has been set in SDL_RWFromFile */
+       return -1;
+   }
+   start = SDL_RWtell(src);
+
+   if ( IMG_InitPNG() < 0 ) {
+       return -1;
+   }
+
+   /* Create and initialize the png_struct with the desired error handler
+    * functions.  If you want to use the default stderr and longjump method,
+    * you can supply NULL for the last three parameters.  We also check that
+    * the library version is compatible with the one used at compile time,
+    * in case we are using dynamically linked libraries.  REQUIRED.
+    */
+    png_ptr = NULL; info_ptr = NULL;
+
+   /* Create the PNG loading context structure */
+   png_ptr = lib.png_create_read_struct(PNG_LIBPNG_VER_STRING,
+                     NULL,NULL,NULL);
+   if (png_ptr == NULL){
+       error = "Couldn't allocate memory for PNG file or incompatible PNG dll";
+       goto done;
+   }
+
+    /* Allocate/initialize the memory for image information.  REQUIRED. */
+   info_ptr = lib.png_create_info_struct(png_ptr);
+   if (info_ptr == NULL) {
+       error = "Couldn't create image information for PNG file";
+       goto done;
+   }
+
+   /* Set error handling if you are using setjmp/longjmp method (this is
+    * the normal method of doing things with libpng).  REQUIRED unless you
+    * set up your own error handlers in png_create_read_struct() earlier.
+    */
+   if ( setjmp(png_ptr->jmpbuf) ) {
+       error = "Error reading the PNG file.";
+       goto done;
+   }
+
+   /* Set up the output control */
+    lib.png_set_write_fn(png_ptr, src, png_write_data);
+
+    /* Set the image information here.  Width and height are up to 2^31,
+     * bit_depth is one of 1, 2, 4, 8, or 16, but valid values also depend on
+     * the color_type selected. color_type is one of PNG_COLOR_TYPE_GRAY,
+     * PNG_COLOR_TYPE_GRAY_ALPHA, PNG_COLOR_TYPE_PALETTE, PNG_COLOR_TYPE_RGB,
+     * or PNG_COLOR_TYPE_RGB_ALPHA.  interlace is either PNG_INTERLACE_NONE or
+     * PNG_INTERLACE_ADAM7, and the compression_type and filter_type MUST
+     * currently be PNG_COMPRESSION_TYPE_BASE and PNG_FILTER_TYPE_BASE. REQUIRED
+     */
+   sdlPalette = surface->format->palette;
+   if (sdlPalette)
+   {       
+       colorType = PNG_COLOR_TYPE_PALETTE;
+   } else if (surface->format->Amask)
+   {
+       colorType = PNG_COLOR_TYPE_RGB_ALPHA;
+   } else
+   {
+       colorType = PNG_COLOR_TYPE_RGB;
+   }
+   lib.png_set_IHDR(png_ptr, info_ptr, surface->w, surface->h, surface->format->BitsPerPixel, colorType,
+       PNG_INTERLACE_NONE, PNG_COMPRESSION_TYPE_BASE, PNG_FILTER_TYPE_BASE);
+
+   /* set the palette if there is one.  REQUIRED for indexed-color images */
+   if (colorType == PNG_COLOR_TYPE_PALETTE)
+   {
+        palette = (png_colorp) malloc(sdlPalette->ncolors * sizeof(png_color));
+
+       for( i=0; i < sdlPalette->ncolors; ++i ) {
+           palette[i].blue = sdlPalette->colors[i].b;
+           palette[i].green = sdlPalette->colors[i].g;
+           palette[i].red = sdlPalette->colors[i].r;
+       }
+       lib.png_set_PLTE(png_ptr, info_ptr, palette, sdlPalette->ncolors);
+   }
+   else
+   { //not sure how to handle this
+//     sig_bit.red = true_red_bit_depth;
+//     sig_bit.green = true_green_bit_depth;
+//     sig_bit.blue = true_blue_bit_depth;
+       /* if the image has an alpha channel then */
+//     sig_bit.alpha = true_alpha_bit_depth;
+//     png_set_sBIT(png_ptr, info_ptr, sig_bit);
+   }
+
+    /* Write the file header information.  REQUIRED */
+    lib.png_write_info(png_ptr, info_ptr);
+
+    /* The easiest way to write the image (you may have a different memory
+     * layout, however, so choose what fits your needs best).  You need to
+     * use the first method if you aren't handling interlacing yourself.
+     */
+
+   row_pointers = (png_bytep*) malloc(sizeof(png_bytep)*height);
+   if ( (row_pointers == NULL) ) {
+       error = "Out of memory";
+       goto done;
+   }
+   for (row = 0; row < (int)height; row++) {
+       row_pointers[row] = (png_bytep)
+               (Uint8 *)surface->pixels + row*surface->pitch;
+   }
+
+    if (height > PNG_UINT_32_MAX/sizeof(png_bytep))
+   {
+       error = "Image is too tall to process in memory";
+       goto done;
+   }
+
+   /* Read the entire image in one go */
+   lib.png_write_image(png_ptr, row_pointers);
+
+   /* It is REQUIRED to call this to finish writing the rest of the file */
+   lib.png_write_end(png_ptr, info_ptr);
+
+done:  /* Clean up and return */
+   if ( png_ptr ) {
+       lib.png_destroy_write_struct(&png_ptr, &info_ptr);
+   }
+   if ( row_pointers ) {
+       free(row_pointers);
+   }
+   if (palette)
+   {
+       free(palette);
+   }
+   if ( error ) {
+       IMG_QuitPNG();
+       IMG_SetError(error);
+       return(-1);
+   } else {
+       IMG_QuitPNG();
+   }
+   return(0); 
 }

 #endif /* LOAD_PNG */
Index: SDL_image.h
===================================================================
--- SDL_image.h (revision 4475)
+++ SDL_image.h (working copy)
@@ -107,6 +107,8 @@

 extern DECLSPEC SDL_Surface * SDLCALL IMG_ReadXPMFromArray(char **xpm);

+extern DECLSPEC int SDLCALL IMG_SavePNG_RW(SDL_Surface *surface, SDL_RWops *src);
+
 /* We'll use SDL for reporting errors */
 #define IMG_SetError   SDL_SetError
 #define IMG_GetError   SDL_GetError 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-05T22:11:14.400

我设法让它工作。我需要调用 png_set_bgr() 来修复调色板。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-05T20:34:48.157

将 SDL 表面保存为 PNG 图像是一个在网络上反复解决的问题：http:
[//www.bishoujo.us/svn/renpy/trunk/module/](http://www.bishoujo.us/svn/renpy/trunk/module/)
[http://lists.libsdl.org/pipermail/sdl-libsdl .org/2006-May/055936.html](http://lists.libsdl.org/pipermail/sdl-libsdl.org/2006-May/055936.html)
[http://www.os4depot.net/index.php?function=showfile&file=development/example/sdlpngsavesurf.lha](http://www.os4depot.net/index.php?function=showfile&file=development/example/sdlpngsavesurf.lha)
[http://encelo.netsons.org/programming/sdl](http://encelo.netsons.org/programming/sdl)

与其寻求帮助来调试大量代码，不如将您的代码与其他实现进行比较并查看它们的不同之处，或者询问哪些其他实现最好使用，可能会更有效率。

顺便说一句，修补 SDL_image 库可能不如编写单独的依赖库来实现 PNG 保存的强大解决方案。这样下一次 SDL 升级就不会破坏您的代码。如果您正在考虑向 SDL 贡献补丁，那么提到的所有其他实现都可以追溯到几年前。我不认为 SDL_image 不包括 PNG 保存，因为没有人想要或能够对其进行编码。

# html - 布局的标记建议和一些更一般的问题

> ID：718934
> 
> 赞同：0
> 
> 时间：2009-04-05T13:30:38.487
> 
> 标签：html, css, xhtml

让我解释一下下面的基本布局：

```
|----------------------------|
| title banner               |
|                            |
|----------------------------|
| logut-row                  |
|----------------------------|
|      aN                    |
|    <<to be explained>>     |
|                            |
|                            |
|                            |
|                            |
|                            |
|                            |
|----------------------------|
| footer                     |
|----------------------------|

a1:
| Use entire width for text  |
| and images.                |

a2:
|nav- | con                  |
|iga- |                      |
|tion |                      |

a3:
|nav- | con1     | con2      |
|iga- |          |           |
|tion |          |           |

a4:
|nav- | con1  | con2  | con3 |
|iga- |       |       |      |
|tion |       |       |      | 
```

*   “标题横幅”将包含一个或两个图像，并且不可点击。
*   “logut-row”将包含文本和一些表单元素，使用户能够注销。
*   “页脚”将包含一些链接和一些文本。
*   上述所有三个部分将只有一列。
*   “a”可以是无列 (a1)、两列 (a2)、三列 (a3) 或四列 (a4)。
*   "conN" 是主要内容，其中 N 可以是空字符串或 1-3。
*   内容可以在 1-3 列中，并带有导航菜单列。还有一种特殊情况，没有导航菜单栏，只有一个栏。
*   列将是单独的部分。没有以 col1 开头的文本将在 col2 中继续。而是 col1 可能保存 text 而 col2 一些不相关的信息，例如最新新闻列表。

* * *

关于布局的问题：（Nr 4 最有趣）

1.  我们认为宽度可以固定在 1000 像素左右。评论？
2.  我们是否应该使用 em 指定宽度以使布局对于不同的字体宽度更具可伸缩性？
3.  由于该网站将在大约一年后推出，我们跳过对 IE6 的支持，而专注于 IE7、IE8、Firefox 3.x+ 和 Safari（版本待定）。评论？
4.  **关于标记和 CSS 的建议？**
5.  您会推荐哪个版本的 (X)HTML 和 CSS？为什么？
6.  你认为小屏幕设备的版本可以简单地基于自定义 CSS 还是需要布局标记的差异？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T13:44:33.400

关于 (6)，我们正在采取的策略（与许多其他策略一样）是为移动设备提供一个完全独立的界面，其中移动设备访问网站的可能性相当高。在移动用户可能想要访问该网站的情况下，我们会找出他们最可能想要的部分，并编写一个单独的应用程序来为这些功能提供最好的移动设备界面。我们主要针对 iPhone，因为它是我们看到访问我们网站的主要移动设备。

我们的重点是我所说的“上下文”数据——地图、“实时”数据等。这个想法是你可能有很多静态信息，但是当你在旅途中时需要这些信息, 比较小。感兴趣的是对到达那里很重要的数据（地图、天气、交通）或可能改变我是否去或如何到达那里的信息（关闭、可用性）。当然，这在很大程度上取决于您的用户群体以及他们对获取信息的偏好的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T13:45:38.123

1.  去吧 - 800x600 越来越少了。不过，考虑一下可调整大小的布局——恕我直言，比固定的 1000 左右更好。

2.  不 - 屏幕小但字体大的用户会获得 hor-scroll，这是一个很大的禁忌。

3.  IE7/8、FF3、Safari 3 和 Chrome。歌剧加分。

4.  [蓝图 CSS](http://blueprintcss.org)。重置 CSS。用于 JS 需求的 jQuery。

5.  4.0 过渡或 XHTML 1.0，如果您使用 XML 工具，CSS 1.0，以及可能从 2.0 开始的非关键增强。推理是，如果页面正确验证，执行 X 并不重要，并且您会丢失一些有用的过渡属性。

6.  可以简单地基于自定义 CSS。取决于您拥有多少移动用户、他们对您的重要性以及网站的性质。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-05T16:32:23.810

对于第 1 点，我建议将其固定为 960 像素宽 - 有关示例和好处，请参阅[960 网格系统](http://960.gs/)。该数字很好地划分为网格，并且应该可以在所有主要浏览器（+滚动条）中轻松地以 1024 x 768（或上网本中的 600-ish）分辨率工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-05T15:46:57.723

1.  在决定布局的尺寸时，我通常会咨询主要的高流量网站，如 Google.com、Yahoo.com、BBC.co.uk 等。它们通常是可接受的布局尺寸的体面指标。目前，谷歌新闻有一个自动调整为 100% 宽度的布局，但最小宽度为 765 像素。BBC.co.uk，OTOH，固定布局为 974px。您可能想对类似类型的网站进行自己的调查，但我目前正在处理的网站具有 800 像素的固定宽度。这是显示我们提供的内容类型的合理维度，不会疏远上网本/次笔记本电脑用户。
2.  不可以。网站的尺寸应该绝对指定，以像素为单位，或相对于屏幕/窗口大小。没有理由根据字体的高度（或宽度）来定义布局的宽度。仅仅因为使用更大的字体大小并不意味着用户的屏幕分辨率会自动增加。除非您使用的是固定宽度/等宽字体，您可以在其中定义每行文本上的字符数，否则使布局尺寸与类型尺寸成比例并没有多大意义——您的文本将自动环绕列反正宽度。
3.  就个人而言，我使用 YUI 或 jQuery 等框架来缩短开发时间。这些框架还很大程度上隐藏了不同浏览器之间的不一致。jQuery 掩盖了不同浏览器之间 ECMA 脚本实现的不一致。YUI 在很大程度上做同样的事情，但也提供了可在大多数主流浏览器上使用的高级 UI 组件和 CSS 重置。除此之外，我不再担心支持像 IE 这样的违反标准的浏览器。
4.  布局看起来很简单。如果您了解如何构建无表格布局（框模型、浮动、清除等）并将表示与内容分开，那么您应该很好。
5.  XHTML 1.0 是当前的 W3C 推荐。我不认为任何主流浏览器都支持 XHTML 2.0。IE 甚至还不完全支持 XHTML 1.0，所以最好写 HTML 兼容的 XHTML。大多数主流浏览器都完全支持 CSS1，而*主要*支持 CSS2。
6.  我们计划推出一个单独版本的网站，采用专门为移动设备量身定制的格式。正如 tvanfosson 所说，移动用户可能会对桌面用户的不同内容感兴趣。诸如横幅、照片和其他图像之类的东西将不得不被删除或缩小。导航界面和网站流程也必须改变。

# functional-programming - 函数式语言是飞行模拟器的好选择吗？Lisp 怎么样？

> ID：718935
> 
> 赞同：10
> 
> 时间：2009-04-05T13:31:04.633
> 
> 标签：functional-programming, lisp, simulation

我已经做了几年面向对象的编程，但我没有做过太多的函数式编程。我对飞行模拟器很感兴趣，并对 Lisp 的函数式编程方面感到好奇。飞行模拟器或任何其他现实世界的模拟器在面向对象的范式中对我来说很有意义。

以下是我的问题：

面向对象是代表现实世界模拟领域的最佳方式吗？

我知道 Common Lisp 有 CLOS（lisp 的 OO），但我的问题实际上是关于用函数式语言编写飞行模拟器。那么如果你打算用 Lisp 来写，你会选择使用 CLOS 还是用函数式的方式来写呢？

有人对用 lisp 或任何功能语言编写飞行模拟器有任何想法吗？

2012 年 11 月 8 日更新 - 对那些感兴趣的人有一个类似的 SO 问题 ->[函数式编程如何应用于模拟？](https://stackoverflow.com/questions/3431654/how-does-functional-programming-apply-to-simulations)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-05T14:32:44.643

将“Lisp”视为一种函数式语言是一个常见的错误。确实，最好将其视为一个语言家族，但现在人们说 Lisp 时，他们通常指的是 Common Lisp。

Common Lisp 允许函数式编程，但它本身并不是函数式语言。相反，它是一种通用语言。Scheme 是一个小得多的变体，在方向上更具功能性，当然还有其他变体。

至于你的问题，这是一个好的选择吗？这真的取决于你的计划。Common Lisp 在这类事情上特别有一些真正的优势。它在您通常在所谓的脚本语言中看到的级别上既具有交互性又具有内省性，使其开发速度非常快。同时它已编译并具有高效的编译器，因此您可以期待与其他高效编译器相同的性能（典型的 ime 是 c 的两倍）。虽然是一门大型语言，但它的设计比 c++ 之类的东西要一致得多，而且元编程功能可以为您的特定应用程序编写非常干净、易于理解的代码。如果你只看这些方面，普通的 lisp 看起来很神奇。

但是，也有缺点。社区很小，如果您正在寻找帮助，您将找不到很多人提供帮助。虽然内置库很大，但您不会找到那么多的 3rd 方库，因此您最终可能会从头开始编写更多的库。最后，虽然它绝不是一个有围墙的花园，但 CL 并没有像 python 那样与外部库的平滑集成。这并不意味着你不能调用 c 代码，有很好的工具可以做到这一点。

顺便说一句，CLOS 是我能想到的最强大的 OO 系统，但如果你来自主流的 c++/java/c#/etc，它是完全不同的方法。OO 背景（是的，它们不同，但除了单一与多重 inh 之外。没有那么多）一开始你可能会觉得它有点奇怪，几乎翻了个底朝天。

如果你走这条路，如果你自己用 CLOS 编写，你将不得不注意实际渲染管道的性能问题。类系统具有令人难以置信的运行时灵活性（即在运行时更新类定义不是通过猴子补丁等，而是通过实际更改类和更新实例）但是您为此付出了一些调度成本。

对于它的价值，我过去曾使用 CL 来研究需要数值效率的代码，即不同类型的模拟。这对我来说很有用。在那种情况下，我并不担心使用现有代码——它不存在，所以无论如何我都是从头开始编写几乎所有东西。

总之，它可能是这个项目的一个很好的语言选择，但不是唯一的。如果您不使用兼具高级方面和良好性能的语言（如 CL、OCaml 和其他一些语言），我肯定会考虑使用 lua 之类的语言或也许使用两级方法的可能性python（很多库）在一些 c 或 c++ 代码之上完成繁重的工作。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-05T15:49:26.253

如果您查看游戏或模拟器行业，您会发现很多**C++**以及一些添加的脚本组件。也可以有用其他语言编写的用于风景设计或相关任务的工具。但是在该领域中使用的 Lisp 很少。你需要成为一名优秀的黑客才能从 Lisp 中获得必要的性能，并能够访问或编写低级代码。你如何获得这个诀窍？尝试，失败，学习，尝试，减少失败，学习，......除了编写代码并进行试验之外别无他法。Lisp 对于优秀的软件工程师或那些有潜力成为优秀软件工程师的人非常有用。

主要障碍之一是**垃圾收集器**。要么你有一个非常简单的（然后你有随机暂停的性能问题），要么你有一个复杂的（然后你有一个问题让它正常工作）。只有少数适​​合的垃圾收集器存在——大多数 Lisp 实现都有很好的 GC 实现，但仍然没有针对实时或接近实时的使用进行调整。例外情况确实存在。使用 C++，您可以忘记 GC，因为通常没有。

使用垃圾收集器进行自动内存管理的另一种替代方法是不使用 GC 并“手动”管理内存。这被一些需要支持实时响应的（甚至是商业的）Lisp 应用程序使用（例如过程控制专家系统）。

在该地区开发的最近的东西是**Crash Bandicoot**来自顽皮狗的 Playstation I（后来的游戏是 Playstation II）的游戏（以及后来的游戏）。由于它们已被索尼收购，因此他们为 Playstation III 改用 C++。他们的开发环境是用 Allegro Common Lisp 编写的，它包括一个用于 Scheme（一种 Lisp 方言）变体的编译器。在开发系统上，代码被编译，然后在开发过程中下载到 Playstation。他们有自己的 3d 引擎（非常令人印象深刻，总是得到游戏杂志的好评）、增量关卡加载、针对许多不同演员的复杂行为控制等。所以 Playstation 确实在执行 Scheme 代码，但内存管理没有完成通过 GC（afaik）。他们必须自己开发所有技术——没有人提供基于 Lisp 的工具——但他们可以，因为他们是优秀的软件开发人员。从那以后，我再也没有听说过类似的项目。请注意，这不仅仅是用于脚本的 Lisp——它一直是 Lisp。

在 Scheme 方面，还有一个新的有趣的实现，称为[Ypsilon Scheme](http://www.littlewingpinball.net/mediawiki/index.php/Ypsilon)。它是为弹球游戏开发的——这也可能是其他游戏的基础。

在 Common Lisp 方面，有 Lisp 应用程序与飞行模拟器对话并控制它们的各个方面。有一些基于 SDL 的游戏库。有 OpenGL 的接口。还有类似“开放代理引擎”的东西。还有一些用 Common Lisp 编写的 3d 图形应用程序——甚至是一些复杂的应用程序。但在飞行模拟领域，现有技术很少。

关于 CLOS 与函数式编程的话题。可能一个都不会使用。如果您需要从系统中挤出所有可能的性能，那么 CLOS 已经有一些人们可能希望避免的开销。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-07T17:35:43.763

看看[函数响应式编程](http://en.wikipedia.org/wiki/Functional_reactive_programming)。Haskell 中有很多框架（不知道其他语言），其中大部分是基于箭头的。基本思想是表示随时间变化的值和事件之间的关系。因此，例如，您将编写（使用没有特定库的 Haskell 箭头符号）：

```
 velocity <- {some expression of airspeed, heading, gravity etc.}
   position <- integrate <- velocity 
```

第二行声明了位置和速度之间的关系。<- 箭头操作符是将所有东西联系在一起的一堆库调用的语法糖。

然后稍后你可能会说：

```
 groundLevel <- getGroundLevel <- position
   altitude <- getAltitude <- position
   crashed <- liftA2 (<) altitude groundLevel 
```

声明如果您的高度低于您所在位置的地面水平，那么您已经坠毁。就像这里的其他变量一样，“崩溃”不仅仅是一个值，它是一个随时间变化的值流。这就是为什么使用“liftA2”函数将比较运算符从简单值“提升”到流的原因。

IO 在这种范式中不是问题。输入是时变值，例如操纵杆 X 和 Y，而屏幕上的图像只是另一个时变值。在最顶层，您的整个模拟器是从输入到输出的箭头。然后调用“运行”函数，将箭头转换为运行游戏的 IO 动作。

如果你用 Lisp 编写这个，你可能会发现自己创建了一堆基本上重新发明箭头的宏，所以从一开始就找出箭头可能是值得的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-06T17:21:52.357

我对飞行模拟一无所知，你也没有特别列出它们包含的任何内容，所以这主要是关于用 Lisp 编写 FS 的猜测。

为什么不：

*   Lisp 擅长探索性编程。我认为，由于 FS 存在这么久，并且有免费和开源的示例，它不会从这种类型的编程中受益。

*   飞行模拟游戏大多（我猜）是用静态的、本地编译的语言编写的。如果您正在寻找纯粹的运行时性能，那么在 Lisp 中，这往往意味着类型声明和其他不太 Lispy 的构造。如果你用幼稚的方法没有得到你想要的性能，你优化的 Lisp 最终可能看起来很像 C，而 Lisp 在编写 C 方面不如 C。

*   我猜，很多 FS 都在连接像 OpenGL 这样的图形库，它是用 C 编写的。根据您的 FFI / OpenGL 绑定的方式，这可能再次使您的代码看起来像 C-in-口齿不清。你可能没有 Lisp 在 Web 应用程序（它包括生成纯文本的树结构，这是 Lisp 擅长的）中取得的巨大胜利。

为什么：

*   我看了一眼 FlightGear 源代码，我看到了很多结构样板——即使是直端口也可能最终只有一半大小。

*   他们到处使用字符串作为键（C++ 没有符号）。他们将 XML 用于半人类可读的配置文件（C++ 没有运行时阅读器）。在这里简单地切换到本机 Lisp 结构可能会以最小的努力获得巨大的胜利。

*   没有什么看起来很复杂，即使是“人工智能”。这只是保持一切井井有条的问题，而 Lisp 会在这方面做得很好，因为它会更短。

但是关于 Lisp 的巧妙之处在于它是多范式的。您可以使用 OO 来组织“对象”，并使用 FP 在每个对象内进行计算。我说只是开始写作，看看它会把你带到哪里。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-05T14:20:25.390

我不会说函数式编程特别适合飞行模拟。一般来说，函数式语言*对于*编写科学模拟非常有用，尽管这是一个稍微特殊的案例。真的，你可能会更好地使用标准的命令式（最好是 OOP）语言，比如 C++/C#/Java，因为它们往往拥有更好的物理库和图形 API，这两者你都需要非常使用沉重。此外，OOP 方法可能更容易表示您的环境。要考虑的另一点是（据我所知）当今市场上流行的飞行模拟器几乎完全是用 C++ 编写的。

本质上，我的理念是，如果没有特别好的理由需要使用函数式范例，那么就不要使用函数式语言（尽管没有什么可以阻止你在 OOP/混合语言中使用函数式构造）。我怀疑使用经过良好测试的 C++ API 和更常与游戏开发相关的语言（与飞行模拟有许多共同点）进行开发过程的痛苦会少得多。现在，如果您想在模拟器中添加一些复杂的 AI，Lisp 似乎是一个更明显的选择，尽管即使那样我也不会跳入其中。最后，如果您真的热衷于使用函数式语言，我建议您使用更通用的语言之一，例如 Python 甚至 F#（实际上都是混合的命令式函数式语言），

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-07T17:48:51.330

我首先会想到模拟的性质。

一些模拟需要像飞行模拟器一样的交互。我不认为函数式编程对于交互式（阅读：CPU 密集型/响应关键型）应用程序可能是一个不错的选择。当然，如果您可以访问 8 个与 Linux 连接在一起的 PS3，您就不会太在意性能。

对于像进化/遗传编程这样的模拟，你设置它并让'er rip，功能性语言可能比OO语言更好地帮助建模问题域。并不是说我是函数式编程方面的专家，但在我看来，递归编码的简便性和函数式语言中常见的惰性求值的想法似乎非常适合“让她撕开”类型的模拟人生。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-05T14:36:23.290

函数式语言存在一些问题，那就是它们不能很好地与状态相结合，但它们确实与过程相得益彰。所以在某种程度上可以说它们是面向行动的。这意味着您将浪费时间模拟飞机，您要做的是模拟飞行飞机的动作。一旦你冷静下来，你可能会让它发挥作用。

现在顺便说一句，恕我直言，haskell 不是很好，因为它对于“游戏”来说太抽象了，这种应用程序都是关于输入/输出的，但 Haskell 是关于避免 IO，所以它会成为一个 monad 的噩梦，你会反对这种语言。Lisp 是一个更好的选择，或者 Lua 或 Javascript，它们也是函数式的，但不是纯粹的函数式，所以你可以试试 Lisp。无论如何，在任何这些语言中，您的图形都将是 C 或 C++。

然而，一个严重的问题是文档很少，关于函数式语言和“游戏”的教程也很少，当然科学模拟在学术上是有记录的，但这些论文非常密集，如果你成功了，也许你可以写下你的经验，因为它是其他人现在是一个相当空旷的领域

# asp.net-mvc - 如何在 ASP.NET 中使用 Moq 测试 HTTP-Post？

> ID：718939
> 
> 赞同：5
> 
> 时间：2009-04-05T13:33:08.560
> 
> 标签：asp.net-mvc, unit-testing, moq

我有以下`Action Method`我正在尝试最小起*订量*测试。注意`AcceptVerbs`? 我需要确保我正在测试它。

这是方法。

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Create([Bind(Include = "Subject, Content")]Post post,
    HttpPostedFileBase imageFileName)
{
  ...
} 
```

这是我的起订量代码...

```
[TestMethod]
public void Create_Action_snip_sniop_When_Http_Post_Is_Succesful()
{
    // Arrange.
    var mock = new Mock<ControllerContext>();
    mock.SetupGet(m => m.HttpContext.Request.HttpMethod).Returns("POST");

    // Snip some other arrangements.

    var controller = PostController;
    controller.ControllerContext = mock.Object;

    // Act.
    var viewResult = controller.Create(post, image.Object) as ViewResult;

    // Assert.
    Assert.IsNotNull(viewResult);

    // TODO: Test that the request was an Http-Post. 
```

我需要做什么来验证请求是一个帖子？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-05T13:56:03.920

您的属性在作为单元测试运行时不会被调用，因为它通常由 ControllerActionInvoker 作为 Mvc“堆栈”的一部分调用。在这种情况下，我所做的是编写一个测试以确保将正确的属性应用于具有正确参数的操作。然后我相信框架会正确地完成它的工作。

这样做需要反思：

```
 public void Only_posts_are_allowed_to_my_action()
 {
       var method = typeof(MyController).GetMethod("MyAction");
       var attribute = method.GetCustomAttributes(typeof(AcceptVerbsAttribute),false)
                             .Cast<AcceptVerbsAttribute>()
                             .SingleOrDefault();

       Assert.IsNotNull( attribute );
       Assert.AreEqual( 1, attributes.Count() );
       Assert.IsTrue( attributes.Contains( HttpVerbs.Post ) );
 } 
```

# objective-c - NSArray 与 NSTableDataSource 中的自定义对象

> ID：718940
> 
> 赞同：0
> 
> 时间：2009-04-05T13:34:53.580
> 
> 标签：objective-c, macos, memory, memory-management

我正在尝试使 NSTableDataSource 兼容对象并将此对象作为数据源提供给 NSTableView，但是当表尝试显示数据时，它会崩溃。

```
@interface NSArrayDataSource : NSObject{
    NSArray* internalArray;
}
-(id) initWithArray: (NSArray*) objects;
-(int)numberOfRowsInTableView:(NSTableView *)aTableView;
-(id)tableView:(NSTableView *)aTableView objectValueForTableColumn:(NSTableColumn *)aTableColumn row:(int)rowIndex;
-(void)tableView:(NSTableView *)aTableView setObjectValue:(id)anObject forTableColumn:(NSTableColumn *)aTableColumn row:(int)rowIndex;
@end

@implementation NSArrayDataSource 

-(id) initWithArray: (NSArray*) objects{
    if(self = [super init])
    {
        internalArray = [[NSArray alloc] initWithArray:objects];
    }
    return self;
}

-(int)numberOfRowsInTableView:(NSTableView *)aTableView{
    return [internalArray count];
}

-(id)tableView:(NSTableView *)aTableView objectValueForTableColumn:(NSTableColumn *)aTableColumn row:(int)rowIndex{
    id obj = [internalArray objectAtIndex:rowIndex];
        // when I debug, I get same pointers with invalid data
        // each object has "name" message
        // this following line gives invalid pointer and
        // it crashes
    return [obj name];
}

-(void)tableView:(NSTableView *)aTableView setObjectValue:(id)anObject forTableColumn:(NSTableColumn *)aTableColumn row:(int)rowIndex{
}

@end 
```

谁能告诉我可能是什么问题？

现在我已经从我的班级中删除了所有的 release 和 dealloc 消息，所以没有对象被删除，当我传输数据时，我已经在所有地方完成了保留消息调用。

```
NSArrayDataSource* nsds = [[NSArrayDataSource alloc] initWithArray: myArray];
[tableView setDataSource:nsds]; 
```

我有一个疑问， NSArray 在创建新对象时是否确实为每个对象调用 [retain] 或者它只是存储指针值？

假设我的对象的名称是“SLProject”，那么当我调试时，在 init 方法中我可以正确看到调试窗口下的值，但在 tableView 委托方法中，internalArray 的调试器显示类型为“NSKVONotifying_SLProject”的对象并且它们指向无效数据，但是地址是正确的.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T14:10:26.677

在回答您关于`NSArray`对象创建的问题时，是的，每个对象`retain`在添加到数组时都会收到一条消息，在`release`删除时会收到一条消息。来自苹果文档：

> 通常，您添加到数组中的对象不会被复制。相反，每个对象在其 id 被添加到数组之前都会收到一条保留消息。当一个对象从数组中移除时，它会发送一条释放消息。

至于你的对象的`name`功能，它是如何实现的？如果您替换`[obj name]`为`[obj description]`这仍然会使您的应用程序崩溃吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T15:44:08.900

我的第一个怀疑是 SLProject 类的 -name NSString 属性没有被保留。了解调试日志中描述崩溃的消息会有所帮助，因为没有它我们只是在猜测。

至于你的类名上的“NSKVONotifying_”前缀，当你使用键值观察时，Cocoa 会在运行时创建你对象的子类。这是正常的，不太可能是您的问题的原因。

# wpf - 如何将事件处理程序附加到使用 WPF 中的数据绑定生成的项目？

> ID：718941
> 
> 赞同：2
> 
> 时间：2009-04-05T13:35:17.027
> 
> 标签：wpf, datatemplate, pixelsense

我正在为 MS Surface 单元开发并使用 a`ScatterView`来显示一些数据。下面的场景可能也适合正常`ListBox`（和`ListBoxItems`）。

当我对 进行数据绑定时`ScatterView`，WPF 会自动将 的内容`DataTemplate`与`ScatterViewItems`. 我想为`ScatterManipulationCompleted`(generated) 的事件附加一些事件处理程序`ScatterViewItem`，但不知道该怎么做。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-05T13:50:27.613

您可以`Style`在容器类型上设置 a 并指定`EventSetter`如下：

```
<surface:ScatterView>
    <surface:ScatterView.ItemContainerStyle>
        <Style TargetType="{x:Type surface:ScatterViewItem}">
            <EventSetter Event="ScatterManipulationCompleted" Handler="myHandler"/>
        </Style>
    </surface:ScatterView.ItemContainerStyle>
</surface:ScatterView> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-07T20:20:22.807

您应该利用路由事件。您可以在 ScatterView 级别监听此事件。

```
 <surface:ScatterView surface:ScatterViewItem.ScatterManipulationCompleted="OnManipulationCompleted"/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T13:55:07.027

正如经常发生的那样，我现在找到了答案。过去 20 小时左右我一直在看这个，只是在发布问题 5 分钟后才找到它:-(

任何方式：我找到并且现在对我有帮助的解决方案是使用 ScatterView 的 Loaded 事件。在处理程序中，我有以下循环：

```
 for (int i = 0; i < MiniBrowserContent.Items.Count; i++)
{
    ScatterViewItem svItem = (ScatterViewItem)(MiniBrowserContent.ItemContainerGenerator.ContainerFromIndex(i));
    svItem.ScatterManipulationCompleted += new ScatterManipulationCompletedEventHandler(svItem_ScatterManipulationCompleted);
} 
```

[阅读http://www.beacosta.com/blog/?p=7](http://www.beacosta.com/blog/?p=7)后，我想到了这一切

希望这对其他人有帮助。

再见，巴特

# git - git push 错误：pack-objects 死于奇怪的错误

> ID：718962
> 
> 赞同：5
> 
> 时间：2009-04-05T13:56:36.833
> 
> 标签：git

我一直在成功推动这个 repo 一段时间，它开始从任何地方给我以下错误，任何想法为什么会发生？

```
Ishaqs-Mac:source ishaq$ git push
Counting objects: 68, done.
Delta compression using 2 threads.
Compressing objects: 100% (50/50), done.
Connection to SERVER closed by remote host.
error: pack-objects died with strange error
error: failed to push some refs to 'SERVER:PROJECT.git' 
```

感谢您的时间和帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-05T19:54:02.497

不幸的是，错误消息不是很有帮助。但是您的问题不是来自 Git 包；而是来自 Git 包。第一条错误消息来自 OpenSSH，它能够访问远程服务器但无法登录：

```
Connection to SERVER closed by remote host. 
```

这不是密码问题（有不同的错误消息），但可能是权限问题（例如没有适当权限的组，我偶尔在 OSX 上看到）或无法识别的帐户名（在某些系统上报告密码问题）或超时。您可以尝试从命令行登录：

```
$ ssh username@servername 
```

发现你遇到了什么样的问题。您也可以尝试修复权限；OS X 似乎特别容易受到反复出现的权限问题和从奇怪的组运行。

旁注——由于您使用的是 Leopard，我建议您安装[SSHKeychain](http://www.sshkeychain.org/)，它管理 SSH 身份并将您的 SSH 密码短语自动存储在系统钥匙串中。它不会帮助您解决当前的问题，但可能会防止将来出现类似的问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-05T14:32:39.667

要检查的几点：

*   **推送端的磁盘空间**问题（如 $GIT_DIR 或 $TMP_DIR 中的“磁盘空间不足”？）

*   正确的问题（在哪个帐户下执行流程？）

*   特定于平台的问题：在 Mac OS 上，您可能会遇到[MacPort 配置问题](http://groups.google.com/group/github/browse_thread/thread/c5a0e06690e216e2)。

*   **推送端的 git 和远程站点上的 git 之间的版本差异**（例如，如果您尝试使用不了解子模块的 git 二进制文件在远程对等方上推送子模块，您可能会遇到一些麻烦，例如这个）

注意：由于是与[功能](http://www.gelato.unsw.edu.au/archives/git/0612/35982.html)[相关的错误消息`pack_object()`](http://www.gelato.unsw.edu.au/archives/git/0612/35982.html)，因此请检查是否`git pack`仍然有效。

```
static void pack_objects(int fd, struct ref *refs)
{
    for (;;) {
        int status, code;
        pid_t waiting = waitpid(pid, &status, 0);
        if (waiting < 0) {
            if (errno == EINTR)
                continue;
            return error("waitpid failed (%s)", strerror(errno));
        }
        if ((waiting != pid) || WIFSIGNALED(status) ||
            !WIFEXITED(status))
            return error("pack-objects died with strange error");
        code = WEXITSTATUS(status);
        if (code)
            return -code;
        return 0;
    }
} 
```

[**Note-bis：在推送到 GitHub**](http://support.github.com/discussions/feature-requests/157-fatal-bad-object-error-when-doing-simple-push)时，最近有一些出现此错误消息的案例（2009 年 1 月下旬）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-07T21:49:58.863

如果您碰巧使用了 gerrit 之类的代码审查工具，并且在尝试推送代码时遇到了这种情况，这可能是因为 java 程序通常在内存管理方面非常出色。而且你不会在互联网上找到任何可以帮助你的人，直到你绝望地决定杀死 gerrit 并重新启动它。然后*噗*，你的问题就消失了......直到几天后你需要再次重启 gerrit 来解决同样的问题。

Java 太棒了。

# scripting - 谁做带有浮动小数点的非十进制大数？

> ID：718966
> 
> 赞同：1
> 
> 时间：2009-04-05T13:58:25.643
> 
> 标签：scripting, floating-point, bignum, radix-point

Tcl 库 math::bignum 和 math::bigfloat 很好，两者之间的中间地带需要解决。即，位于不同基数并具有[小数点](http://en.wikipedia.org/wiki/Radix_point)的大数。

目前 math::bignum 只处理整数（afaict），而 math::bigfloat 不允许你为 math::bigfloat::fromstr 指定不同的基数（同上）。

有谁知道任何主要脚本语言（例如 Tcl、Perl、Python、Ruby、Lua）或不太主要的脚本语言（例如 newLISP）的库，它在不同的基数中实现 bignums 并处理小数点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:17:16.810

[bignumber.js](https://github.com/MikeMcl/bignumber.js)是一个 Javascript 库，用于处理以 2 到 36 为基数的小数点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T14:26:58.227

我找不到任何图书馆，但我没找太久。

但是您可以解决这个问题，就像您想要 64 位数据类型时所做的那样，但只有 32 位数据类型可用。使用您已经拥有的库，您应该能够像这样以 b 为基数表示一个数字：

```
 ABCDEF.GHIJKLMN 
```

可以拆分为两个大数 ABCDEF 和 GHIJKLMN。GHIJKLMN 实际上代表 GHIJLMN / pow(b, length(GHIJKLMN)) => GHIJKLM / pow(b, 8)。现在您可以覆盖您需要的运算符，这对于 +、-、*、/ 等应该是可能的。如果您需要更多诸如 sqrt、log 或 pow 之类的东西，这种解决方法将变得过于复杂，您真的应该寻找一个库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T06:01:36.507

最好的选择是使用 GMP (libgmp)。

没有运气，我自己已经为 .NET 版本寻找了很久很久。

# c++ - 将 COM 指针存储在结构中

> ID：718972
> 
> 赞同：0
> 
> 时间：2009-04-05T14:07:54.063
> 
> 标签：c++, com, struct, pointers

每次我尝试将 COM 指针存储到结构中时，我的程序都会崩溃，然后再尝试使用原始指针。我没有调试权限来准确判断问题所在。

```
pRend->cp = cpRT;

ID2D1SolidColorBrush *scBrush;
ERF(cpRT->CreateSolidColorBrush(D2D1::ColorF(D2D1::ColorF::CornflowerBlue), &scBrush)); 
```

它在 CreateSolidColorBrush 上崩溃。但是，如果我注释掉 pRend->cp = cpRT，它不会。顺便说一下，pRend->cp 和 cpRT 的类型为 ID2D1HwndRenderTarget *。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T01:16:17.620

而不是直接分配QI然后存储即，

```
pRend->cp = cpRT; 
```

应该替换为

```
cpRT->QueryInterface(&pRend->cp); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T14:11:45.987

目前尚不清楚在将其分配到结构和稍后在 CreateSolidColorBrush 中使用它之间存在多少代码。如果这是一个重要的时间量，那么您可能会遇到引用计数问题。

您是否在结构中存储原始指针？如果是这样，请将其切换到 CComPtr 并查看崩溃是否消失。

例如。如果您对 pRend 的值（称为 Render）具有以下类型定义，并且值 pRend 在调用 CreateSolidColorBrush 之前被销毁，您可能会看到此行为。

```
struct Render { 
  ID2D1HwndRenderTarget *pCt;
  ~Render() {
    pCt->Release();
  }
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T14:31:26.347

事实证明，我设法通过使用 malloc 分配 pRend 来阻止崩溃。这不是问题，因为当我不再需要它时，我会免费拨打电话。我对为什么调用 malloc 可以解决这个问题很感兴趣。我习惯于只做`Datatype * var;`然后只使用`var`. 那不好吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-05T14:34:46.477

这是一个智能指针。我*猜*你是在无意中调用 release 。特别是，它的地址运算符（一元 op&）被覆盖以调用 Release()。

看看如果将它分配给一个引用 ID2D1HwndRenderTarget*& 会发生什么。

显然，如果您分配给一个参考，您将无法重新安装它。

# c++ - 霍夫曼编码

> ID：718974
> 
> 赞同：7
> 
> 时间：2009-04-05T14:09:40.860
> 
> 标签：c++, compression, huffman-code

我正在尝试实现用于压缩的霍夫曼算法，这需要将可变长度的位写入文件。C++ 中是否有任何方法可以将 1 位粒度的可变长度数据写入文件？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-05T14:15:10.707

不，您可以写入文件的最小数据量是一个字节。

您可以使用[bitset](http://www.cplusplus.com/reference/stl/bitset/)使操作位更容易，然后使用[ofstream](http://www.cplusplus.com/doc/tutorial/files.html)写入文件。如果您不想使用 bitset，则可以在保存数据之前使用[按位运算符来操作数据。](http://www.learncpp.com/cpp-tutorial/38-bitwise-operators/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-05T14:25:32.523

您可以访问和保存的最小位数是 8 = 1 个字节。您可以使用位运算符 ^ & | 访问字节中的位。

您可以使用以下方法将第 n 位设置为 1：

```
my_byte = my_byte | (1 << n); 
```

其中 n 为 0 到 7。

您可以使用以下方法将第 n 位设置为 0：

```
my_byte = my_byte & ((~1) << n); 
```

您可以使用以下方式切换第 n 位：

```
my_byte = my_byte ^ (1 << n); 
```

更多细节[在这里](http://en.wikipedia.org/wiki/Bit_operators)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-05T15:14:25.807

klew 的答案可能是您想要的答案，但只是为 Bill 所说的添加一些内容，Boost 库有一个[dynamic_bitset](http://www.boost.org/doc/libs/1_38_0/libs/dynamic_bitset/dynamic_bitset.html)，我发现它在类似情况下很有帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-05T15:44:16.497

您需要的有关位旋转的所有信息都在这里：
[您如何设置、清除和切换单个位？](https://stackoverflow.com/questions/47981/how-do-you-set-clear-and-toggle-a-single-bit-in-c)

但是您可以放入文件中的最小对象是一个字节。
我会使用 dynamic_bitset ，每次大小大于 8 时，将底部的 8 位提取到一个字符中并将其写入文件，然后将剩余的位向下移动 8 位（重复）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-05T15:38:53.577

不，您将不得不打包字节。因此，您需要在文件中指定一个标头来指定文件中有多少元素，因为您可能有未使用的尾随位。

# c# - 在哪里可以找到 Windows API 常量列表

> ID：718975
> 
> 赞同：10
> 
> 时间：2009-04-05T14:10:23.353
> 
> 标签：c#, winapi, dll, constants

每次我与像 user32.dll 这样的 dll 交互时，我都需要像 MF_REMOVE 这样的常量。是否有所有常量或常量所有这些常量的 ac# 库的概述？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-05T14:26:12.537

您会在 win32 API 的 C 标头中找到所有常量。获取此信息的低技术方法是在 Visual Studio 或平台 SDK 的 headers 文件夹中简单地运行文本搜索。
这通常是这样的：

> C:\Program Files\Microsoft SDKs\Windows\v6.0A\Include\

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-12-11T21:01:36.723

这个在线工具[MagnumDb](http://www.magnumdb.com/)作为“幻数数据库”（免责声明：我写的）是一个完全免费的搜索引擎，包含 99% 的 Windows SDK 常量（大约 380000 个整数、枚举、guid、接口 id、clsid 等）。

您可以按名称或按值查询，使用通配符等，例如：[http ://www.magnumdb.com/search?q=MF_REMOVE](http://www.magnumdb.com/search?q=MF_REMOVE)

将为您提供此信息（名称、类型、值、十六进制值、SDK 头文件位置）：

```
MF_REMOVE   Int32   4096    0x00001000  %ProgramFiles(x86)%\Windows Kits\10\Include\10.0.16299.0\um\winuser.rh(1213,0) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-05T14:12:07.437

我想你会在那里找到所有你想要的关于 API 的东西： http: [//pinvoke.net/](http://pinvoke.net/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-05T14:13:06.297

试试[PInvoke 互操作助手](http://codeplex.com/clrinterop)。对于大多数常量，您只需输入它们的名称，它就会输出代表这些常量的 C# 或 VB.Net 代码。

该工具不限于常量。它还可以帮助处理类型定义、函数和函数指针。它还可以即时将大多数定义片段转换为托管代码。

[![](https://i.stack.imgur.com/iocxB.png)](https://i.stack.imgur.com/iocxB.png)
[（来源：[msdn.com](http://blogs.msdn.com/blogfiles/jaredpar/WindowsLiveWriter/MakingPInvokeEasy_E069/Pinvoke2_thumb.png)）]

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-02-13T00:29:39.970

Windows API functions for C # and VB With syntax, explanation and sample code

[http://www.pinvoke.net](http://www.pinvoke.net)

# java - 您如何更改 Nimbus 外观和感觉中的边距

> ID：718977
> 
> 赞同：3
> 
> 时间：2009-04-05T14:11:29.357
> 
> 标签：java, swing, nimbus

我正在尝试使用 Nimbus 外观和感觉，我不能简单地将其插入以替换其他外观，因为它在每个组件周围添加了一些外部填充。

所以，我想删除这个填充。这是可以更改的默认值[列表，但是以下代码没有任何更改。](http://jasperpotts.com/blogfiles/nimbusdefaults/nimbus.html)

```
UIManager.put("Button.contentMargins", new Insets(0, 0, 0, 0)); 
```

其他值按预期工作。

如何删除此填充？

**编辑**

我相信内容边距是指内部填充。

**编辑**

查看[源代码](http://kickjava.com/src/com/sun/java/swing/plaf/nimbus/ButtonPainter.java.htm)，外部填充似乎是硬编码的。我相信添加它是为了允许焦点选择属性。

这应该被认为是一个错误吗？没有其他 L&F 这样做，并且有了这个额外的填充，就不可能重用相同的布局（因为以前的布局都假设没有填充）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T06:40:14.380

我发现您必须在设置外观之后立即设置这些默认值（即，在您开始创建任何 UI 组件之前）：

```
尝试 {
    UIManager.setLookAndFeel("com.sun.java.swing.plaf.nimbus.NimbusLookAndFeel");
    UIManager.getLookAndFeelDefaults().put("Table.cellNoFocusBorder", new Insets(0,0,0,0));
    UIManager.getLookAndFeelDefaults().put("Table.focusCellHighlightBorder", new Insets(0,0,0,0));
    插图 buttonInsets = new Insets(3, 6, 3, 6);
    UIManager.getLookAndFeelDefaults().put("Button.contentMargins", buttonInsets);
}
捕获（异常 e）{
    e.printStackTrace();
}

```

另请注意，您需要将它们设置为“LookAndFeelDefaults”而不是“开发者”默认值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-10-06T10:05:55.180

通过调用 getDefaults() 强制 nimbus 首先创建默认值：

```
NimbusLookAndFeel laf = new NimbusLookAndFeel();
UIManager.setLookAndFeel(laf);
UIDefaults def = laf.getDefaults();
def.put("Button.contentMargins", new Insets(0,0,0,0));
def.put("DesktopIcon.contentMargins", new Insets(0,0,0,0));
def.put("Label.contentMargins", new Insets(0,0,0,0)); 
```

如果默认值没有首先初始化，UIManager.put() 不会将设置存储在 nimbus 默认值中。

# iphone - 适用于 iPhone 的开源 CoverFlow 库

> ID：718984
> 
> 赞同：54
> 
> 时间：2009-04-05T14:16:19.127
> 
> 标签：iphone, coverflow

是否有任何可用于 iPhone 的开源、类似 CoverFlow 的 API 或库？

我找到了一个按应用程序许可的实现，但是，我更愿意走开源路线。

此外，我对仅使用公共 API 的库感兴趣，因为使用非公共 API 可能会阻止应用在 App Store 中发布。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-08-03T17:47:04.387

您可能还想查看我在 iPhoneDevCamp 发布的库——OpenFlow。 [http://apparentlogic.com/openflow](http://apparentlogic.com/openflow)

它都是基于核心动画的，因此很容易理解并根据您的需求进行定制。AFOpenFlowView 是 UIView 的子类。

我包含了一个演示应用程序，并查看我个人网站上的博客条目以获取有关其使用的更多信息。fajkowski.com

如果您有任何问题或意见，请给我留言！-亚历克斯

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2011-05-08T11:28:53.360

demosthenese 还有另一个不错的开源实现。这是[链接](https://github.com/nicklockwood/iCarousel)。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2009-04-06T03:32:39.370

Chaosinmotion 的好人有以下可用：

[http://www.chaosinmotion.com/flowcover.html](http://www.chaosinmotion.com/flowcover.html)

它是 BSD 许可的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-05T15:06:33.313

Erica Sadun 的[The iPhone Developer's Cookbook](https://rads.stackoverflow.com/amzn/click/com/0321555457)的最后一章是关于 Cover Flow。您可以从 Google Code 上本书的示例存储库中获取源代码： [cookbooksamples](http://code.google.com/p/cookbooksamples/downloads/list)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-05T14:33:32.377

我不知道您上面描述的任何开源库。但是，如果您熟悉核心动画，那么实现您所描述的内容并不会太难。

查看以下链接以获取更多信息：

1.  [关于使用核心动画实现覆盖流的博客文章](http://bruji.com/articles/tag/cover-flow/)
2.  [Apple iPhone Dec Center 的核心动画参考指南](http://developer.apple.com/iphone/library/documentation/Cocoa/Conceptual/CoreAnimation_guide/Introduction/Introduction.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-19T23:46:35.463

《SAMS Teach Yourself Cocoa Touch Programming in 24 Hours》一书在 CoreAnimation 章节（完整实现）中向您展示了如何制作自己的。

# php - 为什么检查字符串是否为空的函数总是返回true？

> ID：718986
> 
> 赞同：238
> 
> 时间：2009-04-05T14:18:11.697
> 
> 标签：php, string, validation

我有一个函数 isNotEmpty 如果字符串不为空则返回 true，如果字符串为空则返回 false。我发现如果我通过它传递一个空字符串，它就不起作用。

```
function isNotEmpty($input) 
{
    $strTemp = $input;
    $strTemp = trim($strTemp);

    if(strTemp != '') //Also tried this "if(strlen($strTemp) > 0)"
    {
         return true;
    }

    return false;
} 
```

使用 isNotEmpty 验证字符串已完成：

```
if(isNotEmpty($userinput['phoneNumber']))
{
    //validate the phone number
}
else
{
    echo "Phone number not entered<br/>";
} 
```

如果字符串为空，否则不会执行，我不明白为什么，请有人对此有所了解。

* * *

## 回答 #1

> 赞同：333
> 
> 时间：2009-04-05T14:29:15.557

其实很简单的问题。改变：

```
if (strTemp != '') 
```

到

```
if ($strTemp != '') 
```

可以说，您可能还想将其更改为：

```
if ($strTemp !== '') 
```

因为`!= ''`如果您传递的是数字 0 以及由于[PHP 的自动类型转换](http://sldn.softlayer.com/01/2009/php-type-conversions-for-comparison/)而导致的其他一些情况，因为将返回 true 。

您**不应该**为此使用内置的[empty()](http://www.php.net/empty)函数；请参阅注释和[PHP 类型比较表](https://secure.php.net/manual/en/types.comparisons.php)。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-04-05T14:28:33.077

我总是使用正则表达式来检查空字符串，可以追溯到 CGI/Perl 时代，也使用 Javascript，所以为什么不使用 PHP，例如（尽管未经测试）

```
return preg_match('/\S/', $input); 
```

where`\S`代表任何非空白字符

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2012-01-10T19:42:40.277

PHP 有一个称为测试的内置函数`empty()` ，通过键入 `if(empty($string)){...}` Reference php.net 来完成：[php empty](http://php.net/manual/en/function.empty.php)

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2009-04-05T14:29:42.027

在`if`函数的子句中，您指的是一个`strTemp`不存在的变量。`$strTemp`不过确实存在。

但是 PHP 已经有一个`empty()`可用的函数；为什么要自己做？

```
if (empty($str))
    /* String is empty */
else
    /* Not empty */ 
```

来自 php.net：

> 返回值
> 
> 如果 var 具有非空且非零值，则返回 FALSE。
> 
> 以下内容被认为是空的：
> 
> ```
> * "" (an empty string)
> * 0 (0 as an integer)
> * "0" (0 as a string)
> * NULL
> * FALSE
> * array() (an empty array)
> * var $var; (a variable declared, but without a value in a class) 
> ```

[http://www.php.net/empty](http://www.php.net/empty)

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-04-05T17:30:25.120

PHP 将空字符串评估为 false，因此您可以简单地使用：

```
if (trim($userinput['phoneNumber'])) {
  // validate the phone number
} else {
  echo "Phone number not entered<br/>";
} 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2014-07-28T00:30:19.857

只需使用 strlen() 函数

```
if (strlen($s)) {
   // not empty
} 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2017-08-06T19:50:08.117

我只是编写自己的函数，[is_string](http://php.net/manual/en/function.is-string.php)用于类型检查，[strlen](http://php.net/manual/en/function.strlen.php)用于检查长度。

```
function emptyStr($str) {
    return is_string($str) && strlen($str) === 0;
}

print emptyStr('') ? "empty" : "not empty";
// empty 
```

[这是一个小测试repl.it](https://repl.it/JzKC)

编辑：您还可以使用[trim](http://php.net/manual/en/function.trim.php)函数来测试字符串是否也是空白的。

```
is_string($str) && strlen(trim($str)) === 0; 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-05-09T19:09:30.750

我需要在 PHP 中测试一个空字段并使用

```
ctype_space($tempVariable) 
```

这对我来说效果很好。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-05-14T05:33:36.773

那么这里是检查字符串是否为空的简短方法。

```
$input; //Assuming to be the string

if(strlen($input)==0){
return false;//if the string is empty
}
else{
return true; //if the string is not empty
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-06-20T06:22:15.810

您可以简单地转换为布尔值，不要忘记处理零。

```
function isEmpty(string $string): bool {
    if($string === '0') {
        return false;
    }
    return !(bool)$string;
}

var_dump(isEmpty('')); // bool(true)
var_dump(isEmpty('foo')); // bool(false)
var_dump(isEmpty('0')); // bool(false) 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2018-07-22T07:15:12.057

我知道这个线程已经很老了，但我只是想分享我的一个功能。下面的这个函数可以检查空字符串、最大长度的字符串、最小长度或精确长度。如果要检查空字符串，只需将 $min_len 和 $max_len 设置为 0。

```
function chk_str( $input, $min_len = null, $max_len = null ){

    if ( !is_int($min_len) && $min_len !== null ) throw new Exception('chk_str(): $min_len must be an integer or a null value.');
    if ( !is_int($max_len) && $max_len !== null ) throw new Exception('chk_str(): $max_len must be an integer or a null value.'); 

    if ( $min_len !== null && $max_len !== null ){
         if ( $min_len > $max_len ) throw new Exception('chk_str(): $min_len can\'t be larger than $max_len.');
    }

    if ( !is_string( $input ) ) {
        return false;
    } else {
        $output = true;
    }

    if ( $min_len !== null ){
        if ( strlen($input) < $min_len ) $output = false;
    }

    if ( $max_len !== null ){
        if ( strlen($input) > $max_len ) $output = false;
    }

    return $output;
} 
```

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2013-02-21T05:52:12.667

如果您有一个名为 serial_number 的字段并且想要检查为空，那么

```
$serial_number = trim($_POST[serial_number]);
$q="select * from product where user_id='$_SESSION[id]'";
$rs=mysql_query($q);
while($row=mysql_fetch_assoc($rs)){
if(empty($_POST['irons'])){
$irons=$row['product1'];
} 
```

这样，您可以使用另一个空函数检查循环中的所有文件

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2015-03-29T15:02:36.930

这是简短而有效的解决方案，正是您正在寻找的：

```
return $input > null ? 'not empty' : 'empty' ; 
```

* * *

## 回答 #14

> 赞同：-3
> 
> 时间：2014-12-23T13:25:22.930

您得到了答案，但在您的情况下，您可以使用

```
return empty($input); 
```

或者

```
return is_string($input); 
```

# windows - 如何批量重命名文件？

> ID：718987
> 
> 赞同：1
> 
> 时间：2009-04-05T14:19:12.757
> 
> 标签：windows, rename

我正在寻找一个脚本（Perl、Python 或批处理都可以），它将通过指定的文件树并重命名所有子文件。

例如，`Folder1>File1.anytype`变成`Folder1>Folder1File1.anytype`。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-05T15:37:08.357

您提到了一个批处理文件，这可能意味着您在 Windows 上（我假设您指的是 .bat 文件）。如果您使用的是 unix 系统，请试一试：

```
find . -mindepth 2 -type f -exec sh -c "mv {} \`dirname {}\`/\`dirname {} | sed 's/^\.//' | sed 's/\///g'\`\`basename {}\`" \; 
```

或者，这个 Python 3 程序可以解决问题（也应该在 Windows 上工作......）：

```
#!/usr/bin/env python3.0

import os
import sys 

def raise_error(e):
    raise e

def full_split(path):
    head, tail = os.path.split(path)

    if head:
        return full_split(head) + [tail]

    return [tail]

def main(args):
    if len(args) != 1:
         print("Please specify one target directory", file=sys.stderr)
         sys.exit(1)

    os.chdir(args[0])
    for dirpath, _, filenames in os.walk('.', onerror=raise_error):
        for f in filenames:
            old = os.path.join(dirpath, f)
            new = os.path.join(dirpath, ''.join(full_split(dirpath[2:]) + [f]))
            os.rename(old, new)

if __name__ == '__main__':
    main(sys.argv[1:]) 
```

之前的目录布局：

```
.:
ABC 定义

./ABC:
Foo2.bar Foo.bar

./定义：
Baz2.quux Baz.quux Ghi

./Def/Ghi：
Bar2.foo 酒吧.foo
```

之后的目录布局：

```
.:
ABC 定义

./ABC:
AbcFoo2.bar AbcFoo2.bar

./定义：
DefBaz2.quux DefBaz.quux Ghi

./Def/Ghi：
DefGhiBar2.foo DefGhiBar.foo
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T08:42:24.273

最好的批处理重命名器是[mmv](http://debaday.debian.net/2007/06/13/mmv-mass-moving-and-renaming-files/)。

另请参阅[如何进行批量重命名？](https://stackoverflow.com/questions/417916/how-to-do-a-mass-rename)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T17:54:55.390

您可以尝试批量重命名：http: [//batchrename.foryoursoft.com/](http://batchrename.foryoursoft.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T19:01:15.560

您可以通过在命令行中使用嵌套的 for 循环来实现此类重命名。虽然有点难看：

```
for /D %d in (*) do for %f in ("%d\*.*") do move "%f" "%d\%~nd%~nf" 
```

如果您希望将上述命令放在批处理脚本中，请重复每个 % 字符一次。

```
for /D %%d in (*) do for %%f in ("%%d\*.*") do move "%%f" "%%d\%%~nd%%~nf" 
```

要了解上述命令的作用，请咨询`FOR /?`命令行。

我觉得现在 Batch 太神秘了，我需要以某种方式保存 BAT 的智慧...... :-)

我在开玩笑:-).. 但是命令确实有效，我已经尝试过了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T19:18:11.277

在 Perl 中使用[File::Find](http://search.cpan.org/~nwclark/perl-5.8.9/lib/File/Find.pm)和[File::Copy非常简单](http://search.cpan.org/~nwclark/perl-5.8.9/lib/File/Copy.pm)

# .net - 如何抓取网站，客户端或服务器端？

> ID：718998
> 
> 赞同：1
> 
> 时间：2009-04-05T14:27:37.867
> 
> 标签：.net, asp.net, javascript

我正在创建一个小书签按钮，当用户在浏览器中单击此按钮时，它将抓取当前页面并从此页面获取一些值，例如价格、商品名称和商品图片。

这些字段将是可变的，这意味着获取这些值的逻辑对于每个域“amazon、ebay”将是不同的。

我的问题是：

*   我应该使用 javascript 来抓取这些数据然后发送到服务器吗？
*   或者只是将 URL 发送到我的服务器端，然后使用 .net 代码来抓取值？
*   什么是最好的方法？为什么它更好？优点缺点？

看看这个视频，你就会明白我到底想做什么[http://www.vimeo.com/1626505](http://www.vimeo.com/1626505)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-05T14:41:09.317

如果您想从另一个站点提取信息以在*您的*站点中使用（例如，用 ASP.NET 编写），那么您通常会在服务器端执行此操作，以便您拥有丰富的语言来处理结果（例如 C#）。您将通过 .NET 中的 WebRequest 对象来执行此操作。

客户端处理的主要用途是使用 Javascript 提取信息以显示在您的网站上。一个示例是天气频道提供的脚本，用于在您的网站上显示一个小天气框或用于非常简单的操作，例如将页面添加到收藏夹。

**更新**：Amr 写道，他正在尝试重新创建一些流行的屏幕抓取软件的功能，这需要一些非常复杂的处理。Amr，我会考虑创建一个使用 IE 浏览器对象来显示网页的应用程序 - 这很简单。然后，您可以拉取 InnerHTML（我认为，自从我实现基于 IE 对象的程序以来已经有几年了）来检索页面的内容并发挥您的作用。当然，您可以使用 WebRequest 对象（只需将浏览器对象中使用的 URL 传递给它），但这不会很有效，因为它会再次下载页面。

这就是你所追求的吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T14:59:07.403

如果您只想使用 JavaScript 来执行此操作，那么您可能会拥有一个相当大的书签，除非您知道将使用它的每个站点的确切布局（即使那样它也会很大）。

我看到的一种常见方法是在您自己的服务器上使用 Web 服务，您的书签（使用 JavaScript）将重定向到该服务器以及一些参数，例如您正在查看的页面的 URL。然后，您的服务器将抓取页面并解析 HTML 以获取您感兴趣的内容。

一个很好的例子是[“Import to Mendeley”](http://www.mendeley.com/import/)小书签，它将您正在访问的页面的 URL 传递到其服务器，然后从中提取有关页面上列出的科学论文的信息并将它们导入您的收藏。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T14:44:55.033

我会在服务器端抓取它，因为（我是 Java 人）我更喜欢静态语言而不是动态脚本语言，所以在后端维护逻辑对我来说会更舒服。另一方面取决于您要抓取多少项目以及这样做的逻辑有多复杂。也许这些值可以用 JavaScript 中的单个 id 选择器解析，然后服务器端处理可能会过度杀伤力。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-05T14:48:48.253

书签是每个定义的客户端，但您可以让客户端依赖于服务器，但您的示例没有提供足够的信息。你想对抓取的信息做什么？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-05T15:09:54.273

如果您在书签中包含抓取代码，如果您包含新功能或错误修复，您的用户将不得不更新他们的书签。在服务器端进行操作，您的所有用户都会立即获得新内容 :)**********