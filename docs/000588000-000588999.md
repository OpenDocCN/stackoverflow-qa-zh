# StackOverflow 问答 000588000-000588999

# c# - UpdateModel 不会正确转换布尔值

> ID：588000
> 
> 赞同：2
> 
> 时间：2009-02-25T21:38:32.453
> 
> 标签：c#, asp.net-mvc, updatemodel

我有一个名为 S2kBool 的自定义对象，可以与常规布尔对象相互转换。基本上，它允许我的应用程序以与处理 C# 布尔值相同的方式处理遗留数据库中的布尔值。然后问题是，当我尝试使用复选框设置 S2kBool 属性的值时，它失败了。

像这样的代码有效：

```
public class MyClass {
    public S2kBool MyProperty { get; set; }
}

MyClassInstance.MyProperty = true; 
```

但这几乎就像 UpdateModel 期待一个实际的 bool 类型，而不是一个可以转换为 bool 的对象。但是，我真的不能说，因为抛出的异常是如此模糊：

> 模型未成功更新。

我怎样才能解决这个问题？我需要自定义 ModelBinder 吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T02:00:46.300

您可以拥有一个额外的 bool 类型的 bool 属性，当设置它时会更改您的 S2kBool 属性的值。

```
public class MyClass {
    public S2kBool MyProperty { get; set; }
    public bool MyPropertyBool {
        get
        {
            return (bool)MyProperty;
        }
        set
        {
            MyProperty = value;
        }
    }
} 
```

然后，您只需在 html 表单中使用 MyPropertyBool ，modelbinder 就不会因为它的类型而吓坏了。

我将这种技术用于诸如 Password 和 HashedPassword 之类的属性，其中 Password 是 ModelBinder 绑定到的 html 表单中的属性，在 Password 的 setter 中，它将 HashedPassword 设置为它的哈希值，然后将其持久化到数据库或其他任何地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T16:58:30.573

虽然 Charlino 的解决方案很聪明并且会起作用，但我个人不喜欢仅仅为此目的而用额外的属性“弄脏”我的域实体的想法。我想你已经有了答案：自定义模型绑定器。就像是：

```
public class S2kBoolAttribute : CustomModelBinderAttribute, IModelBinder
{
    public override IModelBinder GetBinder()
    {
        return this;
    }

    public object BindModel( ControllerContext controllerContext, ModelBindingContext bindingContext )
    {
        ValueProviderResult result;
        return bindingContext.ValueProvider.TryGetValue( bindingContext.ModelName, out result )
            ? (S2kBool)result.ConvertTo( typeof( bool ) )
            : null;
    }
} 
```

然后你可以修改你的控制器动作看起来像：

```
public ActionResult Foo( [S2kBool]S2kBool myProperty ){
    myClassInstance.MyProperty = myProperty;
    SaveToLegacyDb(myClassInstance);
    return RedirectToAction("Bar");
} 
```

如果您在模型绑定器中投入更多的工作，您可以让它与全局注册的绑定器一起工作——但是我上面给您的实现应该可以在需要时用于挑选值。

# string - 如何在 Erlang 中将整数转换为字符串？

> ID：588003
> 
> 赞同：61
> 
> 时间：2009-02-25T21:38:51.267
> 
> 标签：string, erlang

我知道 Erlang 中的字符串使用起来成本很高。那么如何转换`"5"`为`5`?

有没有类似的东西`io:format("~p",[5])`会返回格式化的字符串而不是打印到流中？

* * *

## 回答 #1

> 赞同：157
> 
> 时间：2009-02-25T22:40:15.080

还有`integer_to_list/1`，它完全符合您的要求，没有丑陋。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-10-29T19:24:56.577

字符串是一个列表：

```
9> integer_to_list(123).  
"123" 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-02-25T21:48:24.347

以下可能不是最简洁的方法，但它有效：

```
1> lists:flatten(io_lib:format("~p", [35365])).
"35365" 
```

编辑：我发现以下功能很有用：

```
%% string_format/2
%% Like io:format except it returns the evaluated string rather than write
%% it to standard output.
%% Parameters:
%%   1\. format string similar to that used by io:format.
%%   2\. list of values to supply to format string.
%% Returns:
%%   Formatted string.
string_format(Pattern, Values) ->
    lists:flatten(io_lib:format(Pattern, Values)). 
```

**编辑2**（回应评论）：上面的函数来自一个小程序，我写了一段时间来学习Erlang。我正在寻找一个字符串格式化函数，并发现了违反直觉的行为`io_lib:format/2`，`erl`例如：

```
1> io_lib:format("2 + 2 = ~p", [2+2]).
[50,32,43,32,50,32,61,32,"4"] 
```

当时，我不知道@archaelus 提到的输出设备的“自动扁平化”行为，因此得出结论认为上述行为不是我想要的。

今天晚上，我回到了这个程序，并将对上述`string_format`函数的调用替换为`io_lib:format`. 这导致的唯一问题是一些 EUnit 测试失败，因为他们期待一个扁平的字符串。这些很容易解决。

我同意@gleber 和@womble 的观点，即使用此函数将整数转换为字符串是多余的。如果这就是您所需要的，请使用`integer_to_list/1`. 吻！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-26T09:46:49.533

顺便说一句，如果你需要处理浮点数的字符串表示，你应该看看Bob Ippolito 在[mochinum上所做的](http://mochiweb.googlecode.com/svn/trunk/src/mochinum.erl)[工作](http://bob.pythonmac.org/archives/2007/12/17/printing-floats-with-erlang/)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-03-09T04:52:08.600

列表：concat（[数字]）。也有效。

# math - 浮点数学被破坏了吗？

> ID：588004
> 
> 赞同：3561
> 
> 时间：2009-02-25T21:39:02.343
> 
> 标签：math, language-agnostic, floating-point, floating-accuracy

考虑以下代码：

```
0.1 + 0.2 == 0.3  ->  false 
```

```
0.1 + 0.2         ->  0.30000000000000004 
```

为什么会出现这些错误？

* * *

## 回答 #1

> 赞同：2682
> 
> 时间：2009-02-25T21:40:32.900

二进制[浮点](https://en.wikipedia.org/wiki/Double-precision_floating-point_format)数学是这样的。在大多数编程语言中，它基于[IEEE 754 标准](https://en.wikipedia.org/wiki/IEEE_754#Basic_and_interchange_formats)。问题的症结在于，数字以这种格式表示为整数乘以 2 的幂。不能精确表示分母不是 2 次方的有理数（例如`0.1`，即）。`1/10`

因为`0.1`在标准`binary64`格式中，表示可以完全写成

*   `0.1000000000000000055511151231257827021181583404541015625`十进制，或
*   `0x1.999999999999ap-4`在[C99 hexfloat 表示法](http://www.exploringbinary.com/hexadecimal-floating-point-constants/)中。

相反，有理数`0.1`，即`1/10`，可以完全写为

*   `0.1`十进制，或
*   `0x1.99999999999999...p-4`在 C99 hexfloat 表示法的类似物中，其中`...`表示 9 的无休止序列。

程序中的常数`0.2`和`0.3`也将近似于它们的真实值。碰巧最接近`double`的`0.2`大于有理数`0.2`，但最接近`double`的`0.3`小于有理数`0.3`。`0.1`和的总和`0.2`最终大于有理数`0.3`，因此与代码中的常数不一致。

浮点算术问题的一个相当全面的处理是[*每个计算机科学家都应该知道的关于浮点算术的知识*](http://download.oracle.com/docs/cd/E19957-01/806-3568/ncg_goldberg.html)。有关更易于理解的解释，请参阅[floating-point-gui.de](http://floating-point-gui.de)。

**旁注：所有位置（base-N）数字系统都精确地共享这个问题**

普通的旧十进制（以 10 为底）数字也有同样的问题，这就是为什么像 1/3 这样的数字最终会变成 0.333333333...

您刚刚偶然发现了一个数字 (3/10)，它恰好很容易用十进制系统表示，但不适合二进制系统。它也是双向的（在某种程度上）：1/16 是十进制的丑数（0.0625），但在二进制中它看起来就像十进制中的万分之一一样整洁（0.0001）** - 如果我们在在我们的日常生活中使用以 2 为底的数字系统的习惯，你甚至会看到这个数字并本能地理解你可以通过减半来达到那里，一次又一次地减半。

** 当然，浮点数在内存中的存储方式并不完全正确（它们使用一种科学记数法）。然而，它确实说明了二进制浮点精度错误往往会突然出现的一点，因为我们通常感兴趣的“现实世界”数字通常是十的幂 - 但仅仅是因为我们使用十进制数字系统 -今天。这也是为什么我们会说 71% 而不是“每 7 个中有 5 个”之类的东西（71% 是一个近似值，因为 5/7 不能用任何十进制数精确表示）。

所以不：二进制浮点数没有被破坏，它们只是碰巧和其他所有基于 N 的数字系统一样不完美:)

**旁注：在编程中使用浮点数**

在实践中，这个精度问题意味着您需要使用舍入函数将浮点数四舍五入到您感兴趣的小数位，然后再显示它们。

您还需要用允许一定容差的比较替换相等测试，这意味着：

不要做*_*`if (x == y) { ... }`

而是做`if (abs(x - y) < myToleranceValue) { ... }`.

其中`abs`是绝对值。`myToleranceValue`需要为您的特定应用程序选择 - 这与您准备允许多少“摆动空间”以及您要比较的最大数字可能是多少（由于精度问题的损失）有很大关系）。请注意您选择的语言中的“epsilon”样式常量。这些*不能*用作公差值。

* * *

## 回答 #2

> 赞同：673
> 
> 时间：2013-04-18T11:52:32.400

# **硬件设计师的观点**

我相信我应该为此添加硬件设计师的观点，因为我设计和构建浮点硬件。了解错误的来源可能有助于了解软件中发生的情况，最终，我希望这有助于解释浮点错误发生的原因并且似乎随着时间的推移而累积。

## 一、概述

从工程的角度来看，大多数浮点运算都会有一些错误，因为进行浮点计算的硬件只需要在最后一个单位的误差小于一半。*因此，许多硬件将停止在一个精度上，该精度只需要在单个操作*的最后一个位置产生小于一半的误差，这在浮点除法中尤其成问题。什么构成单个操作取决于该单元需要多少个操作数。大多数情况下，它是两个，但有些单元需要 3 个或更多操作数。因此，不能保证重复的操作会导致理想的错误，因为错误会随着时间的推移而累积。

## 2\. 标准

大多数处理器遵循[IEEE-754](http://en.wikipedia.org/wiki/IEEE_754-2008)标准，但有些使用非规范化或不同的标准。例如，IEEE-754 中有一种非规范化模式，它允许以牺牲精度为代价来表示非常小的浮点数。然而，下面将介绍 IEEE-754 的标准化模式，这是典型的操作模式。

在 IEEE-754 标准中，允许硬件设计人员使用任何 error/epsilon 值，只要它小于最后一个单位的二分之一，并且结果只需小于最后一个单位的二分之一一个操作的地方。这就解释了为什么当有重复操作时，错误会加起来。对于 IEEE-754 双精度，这是第 54 位，因为 53 位用于表示浮点数的数字部分（归一化），也称为尾数（例如 5.3e5 中的 5.3）。下一节将更详细地介绍各种浮点运算中硬件错误的原因。

## 三、除法舍入误差的原因

浮点除法错误的主要原因是用于计算商的除法算法。大多数计算机系统使用乘以逆来计算除法，主要在`Z=X/Y`,`Z = X * (1/Y)`. 除法是迭代计算的，即每个周期计算商的一些位，直到达到所需的精度，对于 IEEE-754 来说，这是最后一位误差小于一个单位的任何东西。Y的倒数表（1/Y）在慢除法中称为商选择表（QST），商选择表的位大小通常是基数的宽度，或位数在每次迭代中计算的商，加上一些保护位。对于 IEEE-754 标准，双精度（64 位），它将是除法器的基数加上几个保护位 k 的大小，其中`k>=2`. 因此，例如，一次计算 2 位商（基数 4）的除法器的典型商选择表将是`2+2= 4`位（加上一些可选位）。

**3.1 除法舍入误差：倒数的近似**

商选择表中的倒数取决于[除法](http://en.wikipedia.org/wiki/Division_%28digital%29)：慢除法如 SRT 除法，或快速除法如 Goldschmidt 除法；每个条目都根据除法算法进行修改，以尝试产生尽可能低的错误。但是，无论如何，所有倒数都是*近似值*的实际倒数并引入一些误差因素。慢除法和快除法都迭代计算商，即每一步计算商的一些位数，然后从被除数中减去结果，除法器重复这些步骤，直到误差小于一的二分之一单位排在最后。慢除法方法在每个步骤中计算商的固定位数并且通常构建成本较低，而快速除法方法计算每个步骤的可变位数并且通常构建成本更高。除法方法最重要的部分是它们中的大多数依赖于通过一个*近似*倒数的重复乘法，因此它们容易出错。

## 4\. 其他运算中的舍入误差：截断

所有操作中舍入误差的另一个原因是 IEEE-754 允许的最终答案截断的不同模式。有截断、向零[舍入、最近舍入（默认）、](http://en.wikipedia.org/wiki/Floating_point#Rounding_modes)向下舍入和向上舍入。所有方法都会在单个操作的最后一个位置引入小于一个单位的误差元素。随着时间的推移和重复的操作，截断也会累积地增加结果错误。这种截断误差在求幂中尤其成问题，它涉及某种形式的重复乘法。

## 5.重复操作

由于进行浮点计算的硬件只需要在单个操作的最后一个位置产生一个误差小于一半的结果，如果不注意，误差会随着重复操作而增长。这就是为什么在需要有界误差的计算中，数学家使用诸如在 IEEE-754[的最后一个位置使用舍入到最近的偶数](http://en.wikipedia.org/wiki/Floating_point#Rounding_modes)等方法，因为随着时间的推移，错误更有可能相互抵消出，和[区间算术](http://en.wikipedia.org/wiki/Interval_arithmetic)结合[IEEE 754 舍入模式的变化](http://en.wikipedia.org/wiki/IEEE_754-2008#Rounding_rules)预测舍入误差，并纠正它们。由于与其他舍入模式相比，它的相对误差较低，舍入到最接近的偶数（在最后一位）是 IEEE-754 的默认舍入模式。

请注意，默认的舍入模式，舍入到[最后一位最近的偶数](http://en.wikipedia.org/wiki/Floating_point#Rounding_modes)，保证一次操作的最后一位的误差小于一个单位的二分之一。单独使用截断、向上舍入和向下舍入可能会导致错误大于最后一位单位的二分之一，但小于最后一位单位，因此不建议使用这些模式，除非它们是用于区间算术。

## 6.总结

简而言之，浮点运算出错的根本原因是硬件截断和除法倒数截断的结合。由于 IEEE-754 标准对单个操作只要求最后一位的误差小于一个单位的二分之一，因此重复操作的浮点误差会累加起来，除非得到纠正。

* * *

## 回答 #3

> 赞同：575
> 
> 时间：2009-02-25T21:43:07.887

它的破坏方式与您在小学时学到的十进制（以 10 为基数）符号的破坏方式完全相同，仅针对以 2 为基础的符号。

要理解，请考虑将 1/3 表示为十进制值。不可能完全做到！同样，1/10（十进制 0.1）不能以 2 进制（二进制）精确表示为“十进制”值；小数点后的重复模式永远持续下去。该值不准确，因此您无法使用普通浮点方法对其进行精确数学运算。

* * *

## 回答 #4

> 赞同：356
> 
> 时间：2014-11-20T02:39:59.620

*这里的大多数答案都用非常枯燥的技术术语来解决这个问题。我想用普通人可以理解的方式来解决这个问题。*

想象一下，您正在尝试切比萨饼。你有一个机器人披萨切割机，可以将披萨片*精确地*切成两半。它可以将整个披萨减半，也可以将现有切片减半，但无论如何，减半总是准确的。

那个比萨刀的动作非常精细，如果你从一整块比萨开始，然后把它减半，然后每次将最小的切片继续减半，你可以减半*53 次*，直到切片太小，甚至无法达到高精度的能力. 那时，您不能再将那个非常薄的切片减半，而必须按原样包含或排除它。

现在，您将如何将所有切片以这样一种方式拼凑起来，加起来相当于披萨的十分之一 (0.1) 或五分之一 (0.2)？认真想想，然后努力解决。如果您手头有一个神话般的精密比萨刀，您甚至可以尝试使用真正的比萨饼。:-)

* * *

当然，大多数有经验的程序员都知道真正的答案，那就是无论你把它们切成多细，都无法用这些切片将披萨的十分之一或五分之一*拼凑起来。*你可以做一个很好的近似，如果你将 0.1 的近似值与 0.2 的近似值相加，你会得到一个很好的近似值 0.3，但它仍然只是一个近似值。

对于双精度数字（这是使您可以将披萨减半53倍的精度），该数字立即少于0.1，是0.099999999999999999999999999999167327315315313259468227272727248931893155555555555555555555555555555555555555555555太平洋。后者比前者更接近 0.1，因此数字解析器将在输入 0.1 的情况下支持后者。

（这两个数字之间的差异是我们必须决定包含的“最小切片”，它会引入向上的偏差，或者排除，它会引入向下的偏差。最小切片的技术术语是[ulp](https://en.wikipedia.org/wiki/Unit_in_the_last_place)。）

在 0.2 的情况下，数字都是相同的，只是放大了 2 倍。同样，我们支持略高于 0.2 的值。

请注意，在这两种情况下，0.1 和 0.2 的近似值都有轻微的向上偏差。如果我们添加足够多的这些偏差，它们会使数字越来越远离我们想要的，事实上，在 0.1 + 0.2 的情况下，偏差足够高，结果数字不再是最接近的数字为 0.3。

特别地，0.1 + 0.2是真的0.1000000000000000055511151231257827021181583404541015625 + 0.200000000000000011102230246251565404236316680908203125 = 0.3000000000000000444089209850062616169452667236328125，而最接近0.3数量实际上是0.299999999999999988897769753748434595763683319091796875。

* * *

PS 一些编程语言还提供比萨刀，可以[将切片精确地分成十分之一](https://en.wikipedia.org/wiki/Decimal_floating_point)。虽然这样的比萨刀并不常见，但如果您确实可以使用它，您应该在重要的是能够准确地获得十分之一或五分之一的切片时使用它。

[*（最初发布在 Quora 上。）*](http://qr.ae/mDcAq)

* * *

## 回答 #5

> 赞同：226
> 
> 时间：2009-02-25T21:41:23.273

浮点舍入错误。由于缺少 5 的素因子，0.1 在 base-2 中无法像在 base-10 中那样准确地表示。就像 1/3 需要无限位数以十进制表示，但在 base-3 中是“0.1”， 0.1 在 base-2 中采用无限位数，而在 base-10 中则没有。并且计算机没有无限量的内存。

* * *

## 回答 #6

> 赞同：140
> 
> 时间：2015-02-23T17:15:35.347

*我的答案很长，所以我把它分成三个部分。由于问题是关于浮点数学的，所以我把重点放在了机器的实际作用上。我还专门针对双精度（64 位）精度，但该参数同样适用于任何浮点运算。*

**前言**

一个[IEEE 754 双精度二进制浮点格式 (binary64)](http://en.wikipedia.org/wiki/Double-precision_floating-point_format)数字表示以下形式的数字

> 值 = (-1)^s * (1.m [51] m [50] ...m [2] m [1] m [0] ) [2] * 2 ^(e-1023)

64位：

*   第一位是[符号位](http://en.wikipedia.org/wiki/Sign_bit)：`1`如果数字为负数，`0`否则为¹。
*   接下来的 11 位是[指数](http://en.wikipedia.org/wiki/Exponentiation)，[偏移](http://en.wikipedia.org/wiki/Offset_binary)1023。换句话说，从双精度数中读取指数位后，必须减去 1023 才能获得 2 的幂。
*   剩下的 52 位是[有效](http://en.wikipedia.org/wiki/Significand)数（或尾数）。在尾数中，“隐含”`1.`始终被省略²，因为任何二进制值的最高有效位是`1`。

¹ - IEEE 754 允许有[符号零](http://en.wikipedia.org/wiki/Signed_zero)的概念-`+0`并且`-0`被区别对待：`1 / (+0)`是正无穷大；`1 / (-0)`是负无穷大。对于零值，尾数和指数位都为零。注意：零值（+0 和 -0）明确不归类为非正规²。

^(2 -)[非正规数](http://en.wikipedia.org/wiki/Denormal_number)不是这种情况，它的偏移指数为零（和隐含的`0.`）。非正规双精度数的范围是 d [min] ≤ |x| ≤ d [max]，其中 d [min]（可表示的最小非零数）为 2 ^(-1023 - 51) (≈ 4.94 * 10 ^(-324) )，d [max]（最大的非正规数，其尾数完全由`1`s 组成）为 2 ^(-1023 + 1) - 2 ^(-1023 - 51) (≈ 2.225 * 10 ^(-308) )。

* * *

**将双精度数转换为二进制**

存在许多在线转换器将双精度浮点数转换为二进制（例如在[binaryconvert.com 上](http://www.binaryconvert.com/convert_double.html)），但这里有一些示例 C# 代码来获得双精度数的 IEEE 754 表示（我用冒号分隔三个部分 ( `:`) ：

```
public static string BinaryRepresentation(double value)
{
    long valueInLongType = BitConverter.DoubleToInt64Bits(value);
    string bits = Convert.ToString(valueInLongType, 2);
    string leadingZeros = new string('0', 64 - bits.Length);
    string binaryRepresentation = leadingZeros + bits;

    string sign = binaryRepresentation[0].ToString();
    string exponent = binaryRepresentation.Substring(1, 11);
    string mantissa = binaryRepresentation.Substring(12);

    return string.Format("{0}:{1}:{2}", sign, exponent, mantissa);
} 
```

* * *

**切入正题：原始问题**

（TL；DR版本跳到底部）

[Cato Johnston](https://stackoverflow.com/users/62118/cato-johnston)（提问者）问为什么 0.1 + 0.2 != 0.3。

用二进制编写（用冒号分隔三部分），值的 IEEE 754 表示为：

```
0.1 => 0:01111111011:1001100110011001100110011001100110011001100110011010
0.2 => 0:01111111100:1001100110011001100110011001100110011001100110011010 
```

请注意，尾数由 的重复数字组成`0011`。这是计算出现任何错误的**关键**——0.1、0.2 和 0.3 不能用有限*数量的二进制位***精确地**表示为二进制，超过 1/9、1/3 或 1/7 可以精确地表示为*十进制数字*。

 **另请注意，我们可以将指数的幂减少 52，并将二进制表示中的点向右移动 52 位（很像 10 ^(-3) * 1.23 == 10 ^(-5) * 123）。^(然后，这使我们能够将二进制表示表示为它以 a * 2 p)形式表示的确切值。其中'a'是一个整数。

将指数转换为十进制，删除偏移量，并重新添加隐含`1`（在方括号中），0.1 和 0.2 是：

```
0.1 => 2^-4 * [1].1001100110011001100110011001100110011001100110011010
0.2 => 2^-3 * [1].1001100110011001100110011001100110011001100110011010
or
0.1 => 2^-56 * 7205759403792794 = 0.1000000000000000055511151231257827021181583404541015625
0.2 => 2^-55 * 7205759403792794 = 0.200000000000000011102230246251565404236316680908203125 
```

要添加两个数字，指数需要相同，即：

```
0.1 => 2^-3 *  0.1100110011001100110011001100110011001100110011001101(0)
0.2 => 2^-3 *  1.1001100110011001100110011001100110011001100110011010
sum =  2^-3 * 10.0110011001100110011001100110011001100110011001100111
or
0.1 => 2^-55 * 3602879701896397  = 0.1000000000000000055511151231257827021181583404541015625
0.2 => 2^-55 * 7205759403792794  = 0.200000000000000011102230246251565404236316680908203125
sum =  2^-55 * 10808639105689191 = 0.3000000000000000166533453693773481063544750213623046875 
```

由于总和不是 2 ^n * 1.{bbb} 的形式，我们将指数加一并移动小数点（*二进制*）得到：

```
sum = 2^-2  * 1.0011001100110011001100110011001100110011001100110011(1)
    = 2^-54 * 5404319552844595.5 = 0.3000000000000000166533453693773481063544750213623046875 
```

现在尾数中有 53 位（第 53 位在上一行的方括号中）。IEEE 754的默认[舍入模式](https://en.wikipedia.org/wiki/IEEE_754-1985#Rounding_floating-point_numbers)是“舍入*到最近*” - 即如果数字*x*介于两个值*a*和*b*之间，则选择最低有效位为零的值。

```
a = 2^-54 * 5404319552844595 = 0.299999999999999988897769753748434595763683319091796875
  = 2^-2  * 1.0011001100110011001100110011001100110011001100110011

x = 2^-2  * 1.0011001100110011001100110011001100110011001100110011(1)

b = 2^-2  * 1.0011001100110011001100110011001100110011001100110100
  = 2^-54 * 5404319552844596 = 0.3000000000000000444089209850062616169452667236328125 
```

请注意，*a*和*b*仅在最后一位不同；`...0011`+ `1`= `...0100`。在这种情况下，最低有效位为零的值为*b*，因此总和为：

```
sum = 2^-2  * 1.0011001100110011001100110011001100110011001100110100
    = 2^-54 * 5404319552844596 = 0.3000000000000000444089209850062616169452667236328125 
```

而 0.3 的二进制表示是：

```
0.3 => 2^-2  * 1.0011001100110011001100110011001100110011001100110011
    =  2^-54 * 5404319552844595 = 0.299999999999999988897769753748434595763683319091796875 
```

它与 0.1 和 0.2 之和的二进制表示仅相差 2 ^(-54)。

0.1 和 0.2 的二进制表示是 IEEE 754 允许的数字的*最准确*表示。由于默认的舍入模式，添加这些表示会产生一个仅在最低有效位上有所不同的值。

**TL;博士**

用 IEEE 754`0.1 + 0.2`二进制表示（用冒号分隔三部分）并将其与 进行比较`0.3`，这是（我已将不同的位放在方括号中）：

```
0.1 + 0.2 => 0:01111111101:0011001100110011001100110011001100110011001100110[100]
0.3       => 0:01111111101:0011001100110011001100110011001100110011001100110[011] 
```

转换回十进制，这些值是：

```
0.1 + 0.2 => 0.300000000000000044408920985006...
0.3       => 0.299999999999999988897769753748... 
```

差异正好是 2 ^(-54)，与原始值相比，约为 5.5511151231258 × 10 ^(-17) - 微不足道（对于许多应用程序）。

比较浮点数的最后几位本质上是危险的，因为任何阅读了著名的“[每个计算机科学家应该知道的关于浮点算术的知识](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)”（涵盖了这个答案的所有主要部分）的人都会知道。

大多数计算器使用额外的[保护数字](https://en.wikipedia.org/wiki/Guard_digit)来解决这个问题，这就是如何`0.1 + 0.2`给出`0.3`：最后几位被四舍五入。

* * *

## 回答 #7

> 赞同：136
> 
> 时间：2010-04-09T12:25:09.333

除了其他正确答案之外，您可能需要考虑缩放值以避免浮点运算问题。

例如：

```
var result = 1.0 + 2.0;     // result === 3.0 returns true 
```

... 代替：

```
var result = 0.1 + 0.2;     // result === 0.3 returns false 
```

该表达式在 JavaScript 中`0.1 + 0.2 === 0.3`返回`false`，但幸运的是浮点整数运算是精确的，因此可以通过缩放来避免十进制表示错误。

作为一个实际示例，为了避免精度至关重要的浮点问题，建议¹将货币处理为表示美分数量的整数：`2550`美分而不是`25.50`美元。

* * *

¹ Douglas Crockford：[**JavaScript：好的部分**：附录 A - 糟糕的部分（第 105 页）](http://books.google.com/books?id=PXa2bby0oQ0C&pg=PA105&dq=douglas+crockford+javascript+good+parts+dollar+values+can+be+converted&rview=1&cd=1#v=onepage&q=&f=false)。

* * *

## 回答 #8

> 赞同：65
> 
> 时间：2016-03-16T05:27:16.597

* * *

## 回答 #9

> 赞同：51
> 
> 时间：2009-02-25T21:42:49.353

浮点舍入误差。每个[计算机科学家都应该知道的关于浮点运算的知识](https://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)：

> 将无限多个实数压缩为有限位数需要近似表示。尽管整数有无限多，但在大多数程序中，整数计算的结果可以存储在 32 位中。相反，给定任何固定位数，大多数实数计算将产生无法使用那么多位精确表示的量。因此，浮点计算的结果必须经常四舍五入以适应其有限表示。这种舍入误差是浮点计算的特征。

* * *

## 回答 #10

> 赞同：43
> 
> 时间：2018-08-07T09:34:15.767

[In short](https://stackoverflow.com/questions/1089018/why-cant-decimal-numbers-be-represented-exactly-in-binary) it's because:

> Floating point numbers cannot represent all decimals precisely in binary

So just like 10/3 which [does not exist](https://www.exploringbinary.com/why-0-point-1-does-not-exist-in-floating-point/) in base 10 precisely (it will be 3.33... recurring), in the same way 1/10 doesn't exist in binary.

**So what? How to deal with it?** Is there any workaround?

In order to offer The **best solution** I can say I discovered following method:

```
parseFloat((0.1 + 0.2).toFixed(10)) => Will return 0.3 
```

Let me explain why it's the best solution. As others mentioned in above answers it's a good idea to use ready to use Javascript toFixed() function to solve the problem. But most likely you'll encounter with some problems.

Imagine you are going to add up two float numbers like `0.2` and `0.7` here it is: `0.2 + 0.7 = 0.8999999999999999`.

Your expected result was `0.9` it means you need a result with 1 digit precision in this case. So you should have used `(0.2 + 0.7).tofixed(1)` but you can't just give a certain parameter to toFixed() since it depends on the given number, for instance

```
0.22 + 0.7 = 0.9199999999999999 
```

In this example you need 2 digits precision so it should be `toFixed(2)`, so what should be the paramter to fit every given float number?

You might say let it be 10 in every situation then:

```
(0.2 + 0.7).toFixed(10) => Result will be "0.9000000000" 
```

Damn! What are you going to do with those unwanted zeros after 9? It's the time to convert it to float to make it as you desire:

```
parseFloat((0.2 + 0.7).toFixed(10)) => Result will be 0.9 
```

Now that you found the solution, it's better to offer it as a function like this:

```
function floatify(number){
           return parseFloat((number).toFixed(10));
        } 
```

Let's try it yourself:

```
function floatify(number){
       return parseFloat((number).toFixed(10));
    }

function addUp(){
  var number1 = +$("#number1").val();
  var number2 = +$("#number2").val();
  var unexpectedResult = number1 + number2;
  var expectedResult = floatify(number1 + number2);
  $("#unexpectedResult").text(unexpectedResult);
  $("#expectedResult").text(expectedResult);
}
addUp();
```

```
input{
  width: 50px;
}
#expectedResult{
color: green;
}
#unexpectedResult{
color: red;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<input id="number1" value="0.2" onclick="addUp()" onkeyup="addUp()"/> +
<input id="number2" value="0.7" onclick="addUp()" onkeyup="addUp()"/> =
<p>Expected Result: <span id="expectedResult"></span></p>
<p>Unexpected Result: <span id="unexpectedResult"></span></p>
```

You can use it this way:

```
var x = 0.2 + 0.7;
floatify(x);  => Result: 0.9 
```

As [W3SCHOOLS](https://www.w3schools.com/js/js_numbers.asp) suggests there is another solution too, you can multiply and divide to solve the problem above:

```
var x = (0.2 * 10 + 0.1 * 10) / 10;       // x will be 0.3 
```

Keep in mind that `(0.2 + 0.1) * 10 / 10` won't work at all although it seems the same! I prefer the first solution since I can apply it as a function which converts the input float to accurate output float.

* * *

## 回答 #11

> 赞同：35
> 
> 时间：2011-12-26T06:51:53.710

我的解决方法：

```
function add(a, b, precision) {
    var x = Math.pow(10, precision || 2);
    return (Math.round(a * x) + Math.round(b * x)) / x;
} 
```

*精度*是指在加法过程中要在小数点后保留的位数。

* * *

## 回答 #12

> 赞同：33
> 
> 时间：2016-02-02T23:49:41.243

### 不，没有损坏，但大多数小数必须近似

> *概括*

浮点运算*是*精确的，不幸的是，它与我们通常的以 10 为基数的数字表示不匹配，所以事实证明我们经常给它的输入与我们编写的内容略有不同。

即使是像 0.01、0.02、0.03、0.04 ... 0.24 这样的简单数字也不能完全表示为二进制分数。如果你数到 0.01, .02, .03 ...，直到你达到 0.25 才会得到以[2]为底的第一个分数。如果您尝试使用 FP，您的 0.01 会稍微偏离，因此将其中的 25 个添加到精确的 0.25 的唯一方法将需要涉及保护位和舍入的一长串因果关系。很难预测，所以我们举手说*“FP 不准确”，*但这不是真的。

我们不断地为 FP 硬件提供一些以 10 为底的看似简单但以 2 为底的重复分数。

> *这怎么发生的？*

当我们用十进制写时，每个分数（特别是每个*终止小数）*都是形式的有理数

           *一个 / (2 ^n x 5 ^m )*

在二进制中，我们只得到*2 ^n*项，即：

           *一个 / 2^个*

所以在十进制中，我们不能表示¹ / [3]。因为以 10 为底包含 2 作为质因数，所以我们可以写为二进制分数的每个数字*也*可以写为以 10 为底的分数。然而，我们写的以[10]为底的分数几乎都不能用二进制表示。在 0.01、0.02、0.03 ... 0.99 的范围内，我们的 FP 格式只能表示*三个*数字：0.25、0.50 和 0.75，因为它们是 1/4、1/2 和 3/4，所有数字仅使用 2 ^n项的素因子。

以[10]为底，我们不能代表¹ / [3]。但是在二进制中，我们不能做¹ / [10] *或* ¹ / [3]。

因此，虽然每个二进制分数都可以写成十进制，但反之则不然。事实上，大多数小数部分都以二进制形式重复。

> *处理它*

开发人员通常被指示进行*< epsilon*比较，更好的建议可能是舍入到整数值（在 C 库中：round() 和 roundf()，即保持 FP 格式）然后进行比较。舍入到特定的小数长度可以解决大多数输出​​问题。

此外，在实数运算问题（FP 是在早期、非常昂贵的计算机上发明的问题）中，宇宙的物理常数和所有其他测量只有相对少量的有效数字知道，所以整个问题空间无论如何是“不精确的”。FP“准确性”在这种应用程序中不是问题。

当人们尝试使用 FP 进行豆类计数时，整个问题就真正出现了。它确实适用，但前提是你坚持使用整数值，这会破坏使用它的意义。*这就是我们拥有所有这些小数部分软件库的原因。*

我喜欢[Chris](https://stackoverflow.com/users/13/chris-jester-young)的 Pizza 回答，因为它描述了实际问题，而不仅仅是关于“不准确”的通常挥手致意。如果 FP 只是“不准确”，我们可以*解决*这个问题，并且会在几十年前做到这一点。我们没有这样做的原因是因为 FP 格式紧凑且快速，它是处理大量数字的最佳方式。此外，它是太空时代和军备竞赛以及早期尝试使用小内存系统解决非常慢的计算机的大问题的遗产。（有时，单个*磁芯*用于 1 位存储，但这是[另一回事。](https://en.wikipedia.org/wiki/Magnetic-core_memory)）

> 结论

如果您只是在银行数豆子，那么首先使用十进制字符串表示的软件解决方案效果很好。但是你不能那样做量子色动力学或空气动力学。

* * *

## 回答 #13

> 赞同：32
> 
> 时间：2014-10-05T18:39:35.863

已经发布了很多好的答案，但我想再附加一个。

并非所有数字都可以通过**浮点数**/**双精度**数表示 例如，数字“0.2”将在 IEEE754 浮点标准中以单精度表示为“0.200000003”。

引擎盖下存储实数的模型将浮点数表示为

[![在此处输入图像描述](https://i.stack.imgur.com/BRvSp.png)](https://i.stack.imgur.com/BRvSp.png)

即使您可以`0.2`轻松输入，`FLT_RADIX`并且`DBL_RADIX`是 2；对于使用“二进制浮点算术的 IEEE 标准 (ISO/IEEE Std 754-1985)”的 FPU 计算机，不是 10。

所以要准确地表示这些数字有点困难。即使您在没有任何中间计算的情况下明确指定此变量。

* * *

## 回答 #14

> 赞同：31
> 
> 时间：2015-01-03T12:12:14.820

一些与这个著名的双精度问题相关的统计数据。

当使用 0.1（从 0.1 到 100）的步长添加所有值 ( *a + b ) 时，我们有***大约 15% 的精度误差机会**。请注意，错误可能会导致值稍大或稍小。这里有些例子：

```
0.1 + 0.2 = 0.30000000000000004 (BIGGER)
0.1 + 0.7 = 0.7999999999999999 (SMALLER)
...
1.7 + 1.9 = 3.5999999999999996 (SMALLER)
1.7 + 2.2 = 3.9000000000000004 (BIGGER)
...
3.2 + 3.6 = 6.800000000000001 (BIGGER)
3.2 + 4.4 = 7.6000000000000005 (BIGGER) 
```

当使用 0.1（从 100 到 0.1）的步长减去所有值（*a - b*其中*a > b ）时，我们有***大约 34% 的精度误差机会**。这里有些例子：

```
0.6 - 0.2 = 0.39999999999999997 (SMALLER)
0.5 - 0.4 = 0.09999999999999998 (SMALLER)
...
2.1 - 0.2 = 1.9000000000000001 (BIGGER)
2.0 - 1.9 = 0.10000000000000009 (BIGGER)
...
100 - 99.9 = 0.09999999999999432 (SMALLER)
100 - 99.8 = 0.20000000000000284 (BIGGER) 
```

*15% 和 34% 确实很大，所以当精度非常重要时，请始终使用 BigDecimal。使用 2 个十进制数字（步长 0.01）情况会更糟一些（18% 和 36%）。

* * *

## 回答 #15

> 赞同：19
> 
> 时间：2015-08-21T14:53:07.447

鉴于没有人提到这...

一些高级语言（例如 Python 和 Java）带有克服二进制浮点限制的工具。例如：

*   Python 的[`decimal`模块](https://docs.python.org/dev/library/decimal.html)和 Java 的[`BigDecimal`class](http://docs.oracle.com/javase/8/docs/api/java/math/BigDecimal.html)，它们在内部用十进制表示法（与二进制表示法相反）表示数字。两者都具有有限的精度，因此它们仍然容易出错，但是它们解决了二进制浮点运算的大多数常见问题。

    处理金钱时，小数非常好：10 美分加上 20 美分总是正好是 30 美分：

    ```
    >>> 0.1 + 0.2 == 0.3
    False
    >>> Decimal('0.1') + Decimal('0.2') == Decimal('0.3')
    True 
    ```

    Python 的`decimal`模块基于[IEEE 标准 854-1987](https://en.wikipedia.org/wiki/IEEE_854-1987)。

*   Python 的[`fractions`模块](https://docs.python.org/dev/library/fractions.html)和 Apache Common 的[`BigFraction`类](https://commons.apache.org/proper/commons-math/apidocs/org/apache/commons/math3/fraction/BigFraction.html)。两者都将有理数表示为`(numerator, denominator)`对，并且它们可能比十进制浮点算术提供更准确的结果。

这些解决方案都不是完美的（特别是如果我们查看性能，或者如果我们需要非常高的精度），但它们仍然解决了二进制浮点运算的大量问题。

* * *

## 回答 #16

> 赞同：18
> 
> 时间：2012-08-01T07:02:44.423

您是否尝试过胶带解决方案？

尝试确定何时发生错误并使用简短的 if 语句修复它们，这并不漂亮，但对于某些问题，它是唯一的解决方案，这就是其中之一。

```
 if( (n * 0.1) < 100.0 ) { return n * 0.1 - 0.000000000000001 ;}
                    else { return n * 0.1 + 0.000000000000001 ;} 
```

我在c#的一个科学模拟项目中遇到了同样的问题，我可以告诉你，如果你忽略蝴蝶效应，它会变成一条大肥龙，咬你一口**

* * *

## 回答 #17

> 赞同：18
> 
> 时间：2013-10-14T16:45:17.880

出现这些奇怪的数字是因为计算机使用二进制（以 2 为底）数字系统进行计算，而我们使用十进制（以 10 为底）。

大多数小数不能用二进制或十进制或两者精确表示。结果 - 四舍五入（但精确）的数字结果。

* * *

## 回答 #18

> 赞同：17
> 
> 时间：2015-12-21T11:15:49.590

这个问题的许多重复项中的许多都询问浮点舍入对特定数字的影响。在实践中，通过查看感兴趣的计算的确切结果而不是仅仅阅读它更容易了解它是如何工作的。某些语言提供了这样做的方法 - 例如在 Java中将 a`float`或`double`to转换为。`BigDecimal`

由于这是一个与语言无关的问题，因此需要与语言无关的工具，例如[Decimal to Floating-Point Converter](http://www.exploringbinary.com/floating-point-converter/)。

将其应用于问题中的数字，视为双打：

0.1 转换为 0.1000000000000000055511151231257827021181583404541015625，

0.2 转换为 0.200000000000000011102230246251565404236316680908203125，

0.3 转换为 0.299999999999999988897769753748434595763683319091796875，和

0.30000000000000004 转换为 0.3000000000000000444089209850062616169452667236328125。

手动添加前两个数字或在十进制计算器（如[Full Precision Calculator](https://www.mathsisfun.com/calculator-precision.html)）中显示实际输入的确切总和为 0.3000000000000000166533453693773481063544750213623046875。

如果四舍五入到相当于 0.3 的舍入误差将是 0.0000000000000000277555756156289135105907917022705078125。舍入到 0.300000000000000004 的等效值也会给出舍入误差 0.0000000000000000277555756156289135105907917022705078125。圆对平的决胜局适用。

回到浮点转换器，0.30000000000000004 的原始十六进制是 3fd3333333333334，它以偶数结尾，因此是正确的结果。

* * *

## 回答 #19

> 赞同：17
> 
> 时间：2016-03-18T00:38:44.017

Can I just add; people always assume this to be a computer problem, but if you count with your hands (base 10), you can't get `(1/3+1/3=2/3)=true` unless you have infinity to add 0.333... to 0.333... so just as with the `(1/10+2/10)!==3/10` problem in base 2, you truncate it to 0.333 + 0.333 = 0.666 and probably round it to 0.667 which would be also be technically inaccurate.

Count in ternary, and thirds are not a problem though - maybe some race with 15 fingers on each hand would ask why your decimal math was broken...

* * *

## 回答 #20

> 赞同：10
> 
> 时间：2015-10-05T15:55:03.597

可以在数字计算机中实现的那种浮点数学必然使用实数的近似值和对它们的运算。（*标准*版本有超过 50 页的文档，并有一个委员会来处理其勘误和进一步完善。）

这种近似是不同种类的近似的混合，由于其与精确度的特定偏差方式，每个近似都可以被忽略或仔细考虑。它还涉及许多硬件和软件级别的明显异常情况，大多数人会假装没有注意到。

如果您需要无限精度（例如，使用数字 π，而不是其众多较短的替代项之一），您应该编写或使用符号数学程序。

但是，如果您认为有时浮点数学在值和逻辑上是模糊的，并且错误会迅速累积，并且您可以编写您的需求和测试以实现这一点，那么您的代码可以经常通过你的 FPU。

* * *

## 回答 #21

> 赞同：10
> 
> 时间：2016-12-29T10:29:32.123

Just for fun, I played with the representation of floats, following the definitions from the Standard C99 and I wrote the code below.

The code prints the binary representation of floats in 3 separated groups

```
SIGN EXPONENT FRACTION 
```

and after that it prints a sum, that, when summed with enough precision, it will show the value that really exists in hardware.

So when you write `float x = 999...`, the compiler will transform that number in a bit representation printed by the function `xx` such that the sum printed by the function `yy` be equal to the given number.

In reality, this sum is only an approximation. For the number 999,999,999 the compiler will insert in bit representation of the float the number 1,000,000,000

After the code I attach a console session, in which I compute the sum of terms for both constants (minus PI and 999999999) that really exists in hardware, inserted there by the compiler.

```
#include <stdio.h>
#include <limits.h>

void
xx(float *x)
{
    unsigned char i = sizeof(*x)*CHAR_BIT-1;
    do {
        switch (i) {
        case 31:
             printf("sign:");
             break;
        case 30:
             printf("exponent:");
             break;
        case 23:
             printf("fraction:");
             break;

        }
        char b=(*(unsigned long long*)x&((unsigned long long)1<<i))!=0;
        printf("%d ", b);
    } while (i--);
    printf("\n");
}

void
yy(float a)
{
    int sign=!(*(unsigned long long*)&a&((unsigned long long)1<<31));
    int fraction = ((1<<23)-1)&(*(int*)&a);
    int exponent = (255&((*(int*)&a)>>23))-127;

    printf(sign?"positive" " ( 1+":"negative" " ( 1+");
    unsigned int i = 1<<22;
    unsigned int j = 1;
    do {
        char b=(fraction&i)!=0;
        b&&(printf("1/(%d) %c", 1<<j, (fraction&(i-1))?'+':')' ), 0);
    } while (j++, i>>=1);

    printf("*2^%d", exponent);
    printf("\n");
}

void
main()
{
    float x=-3.14;
    float y=999999999;
    printf("%lu\n", sizeof(x));
    xx(&x);
    xx(&y);
    yy(x);
    yy(y);
} 
```

* * *

Here is a console session in which I compute the real value of the float that exists in hardware. I used `bc` to print the sum of terms outputted by the main program. One can insert that sum in python `repl` or something similar also.

```
-- .../terra1/stub
@ qemacs f.c
-- .../terra1/stub
@ gcc f.c
-- .../terra1/stub
@ ./a.out
sign:1 exponent:1 0 0 0 0 0 0 fraction:0 1 0 0 1 0 0 0 1 1 1 1 0 1 0 1 1 1 0 0 0 0 1 1
sign:0 exponent:1 0 0 1 1 1 0 fraction:0 1 1 0 1 1 1 0 0 1 1 0 1 0 1 1 0 0 1 0 1 0 0 0
negative ( 1+1/(2) +1/(16) +1/(256) +1/(512) +1/(1024) +1/(2048) +1/(8192) +1/(32768) +1/(65536) +1/(131072) +1/(4194304) +1/(8388608) )*2^1
positive ( 1+1/(2) +1/(4) +1/(16) +1/(32) +1/(64) +1/(512) +1/(1024) +1/(4096) +1/(16384) +1/(32768) +1/(262144) +1/(1048576) )*2^29
-- .../terra1/stub
@ bc
scale=15
( 1+1/(2) +1/(4) +1/(16) +1/(32) +1/(64) +1/(512) +1/(1024) +1/(4096) +1/(16384) +1/(32768) +1/(262144) +1/(1048576) )*2^29
999999999.999999446351872 
```

That's it. The value of 999999999 is in fact

```
999999999.999999446351872 
```

You can also check with `bc` that -3.14 is also perturbed. Do not forget to set a `scale` factor in `bc`.

The displayed sum is what inside the hardware. The value you obtain by computing it depends on the scale you set. I did set the `scale` factor to 15\. Mathematically, with infinite precision, it seems it is 1,000,000,000.

* * *

## 回答 #22

> 赞同：7
> 
> 时间：2017-12-19T22:37:37.480

Another way to look at this: Used are 64 bits to represent numbers. As consequence there is no way more than 2**64 = 18,446,744,073,709,551,616 different numbers can be precisely represented.

However, Math says there are already infinitely many decimals between 0 and 1\. IEE 754 defines an encoding to use these 64 bits efficiently for a much larger number space plus NaN and +/- Infinity, so there are gaps between accurately represented numbers filled with numbers only approximated.

Unfortunately 0.3 sits in a gap.

* * *

## 回答 #23

> 赞同：7
> 
> 时间：2018-08-08T08:47:36.087

[Since Python 3.5](https://www.python.org/dev/peps/pep-0485/) you can use [`math.isclose()`](https://docs.python.org/3/library/math.html#math.isclose) function for testing approximate equality:

```
>>> import math
>>> math.isclose(0.1 + 0.2, 0.3)
True
>>> 0.1 + 0.2 == 0.3
False 
```

* * *

## 回答 #24

> 赞同：7
> 
> 时间：2020-08-03T15:03:24.803

Floating point numbers are represented, at the hardware level, as fractions of binary numbers (base 2). For example, the decimal fraction:

```
0.125 
```

has the value 1/10 + 2/100 + 5/1000 and, in the same way, the binary fraction:

```
0.001 
```

has the value 0/2 + 0/4 + 1/8\. These two fractions have the same value, the only difference is that the first is a decimal fraction, the second is a binary fraction.

Unfortunately, most decimal fractions cannot have exact representation in binary fractions. Therefore, in general, the floating point numbers you give are only approximated to binary fractions to be stored in the machine.

The problem is easier to approach in base 10\. Take for example, the fraction 1/3\. You can approximate it to a decimal fraction:

```
0.3 
```

or better,

```
0.33 
```

or better,

```
0.333 
```

etc. No matter how many decimal places you write, the result is never exactly 1/3, but it is an estimate that always comes closer.

Likewise, no matter how many base 2 decimal places you use, the decimal value 0.1 cannot be represented exactly as a binary fraction. In base 2, 1/10 is the following periodic number:

```
0.0001100110011001100110011001100110011001100110011 ... 
```

Stop at any finite amount of bits, and you'll get an approximation.

For Python, on a typical machine, 53 bits are used for the precision of a float, so the value stored when you enter the decimal 0.1 is the binary fraction.

```
0.00011001100110011001100110011001100110011001100110011010 
```

which is close, but not exactly equal, to 1/10.

It's easy to forget that the stored value is an approximation of the original decimal fraction, due to the way floats are displayed in the interpreter. Python only displays a decimal approximation of the value stored in binary. If Python were to output the true decimal value of the binary approximation stored for 0.1, it would output:

```
>>> 0.1
0.1000000000000000055511151231257827021181583404541015625 
```

This is a lot more decimal places than most people would expect, so Python displays a rounded value to improve readability:

```
>>> 0.1
0.1 
```

It is important to understand that in reality this is an illusion: the stored value is not exactly 1/10, it is simply on the display that the stored value is rounded. This becomes evident as soon as you perform arithmetic operations with these values:

```
>>> 0.1 + 0.2
0.30000000000000004 
```

This behavior is inherent to the very nature of the machine's floating-point representation: it is not a bug in Python, nor is it a bug in your code. You can observe the same type of behavior in all other languages ​​that use hardware support for calculating floating point numbers (although some languages ​​do not make the difference visible by default, or not in all display modes).

Another surprise is inherent in this one. For example, if you try to round the value 2.675 to two decimal places, you will get

```
>>> round (2.675, 2)
2.67 
```

The documentation for the round() primitive indicates that it rounds to the nearest value away from zero. Since the decimal fraction is exactly halfway between 2.67 and 2.68, you should expect to get (a binary approximation of) 2.68\. This is not the case, however, because when the decimal fraction 2.675 is converted to a float, it is stored by an approximation whose exact value is :

```
2.67499999999999982236431605997495353221893310546875 
```

Since the approximation is slightly closer to 2.67 than 2.68, the rounding is down.

If you are in a situation where rounding decimal numbers halfway down matters, you should use the decimal module. By the way, the decimal module also provides a convenient way to "see" the exact value stored for any float.

```
>>> from decimal import Decimal
>>> Decimal (2.675)
>>> Decimal ('2.67499999999999982236431605997495353221893310546875') 
```

Another consequence of the fact that 0.1 is not exactly stored in 1/10 is that the sum of ten values ​​of 0.1 does not give 1.0 either:

```
>>> sum = 0.0
>>> for i in range (10):
... sum + = 0.1
...>>> sum
0.9999999999999999 
```

The arithmetic of binary floating point numbers holds many such surprises. The problem with "0.1" is explained in detail below, in the section "Representation errors". See The Perils of Floating Point for a more complete list of such surprises.

It is true that there is no simple answer, however do not be overly suspicious of floating virtula numbers! Errors, in Python, in floating-point number operations are due to the underlying hardware, and on most machines are no more than 1 in 2 ** 53 per operation. This is more than necessary for most tasks, but you should keep in mind that these are not decimal operations, and every operation on floating point numbers may suffer from a new error.

Although pathological cases exist, for most common use cases you will get the expected result at the end by simply rounding up to the number of decimal places you want on the display. For fine control over how floats are displayed, see String Formatting Syntax for the formatting specifications of the str.format () method.

This part of the answer explains in detail the example of "0.1" and shows how you can perform an exact analysis of this type of case on your own. We assume that you are familiar with the binary representation of floating point numbers.The term Representation error means that most decimal fractions cannot be represented exactly in binary. This is the main reason why Python (or Perl, C, C ++, Java, Fortran, and many others) usually doesn't display the exact result in decimal:

```
>>> 0.1 + 0.2
0.30000000000000004 
```

Why ? 1/10 and 2/10 are not representable exactly in binary fractions. However, all machines today (July 2010) follow the IEEE-754 standard for the arithmetic of floating point numbers. and most platforms use an "IEEE-754 double precision" to represent Python floats. Double precision IEEE-754 uses 53 bits of precision, so on reading the computer tries to convert 0.1 to the nearest fraction of the form J / 2 ** N with J an integer of exactly 53 bits. Rewrite :

```
1/10 ~ = J / (2 ** N) 
```

in :

```
J ~ = 2 ** N / 10 
```

remembering that J is exactly 53 bits (so> = 2 ** 52 but <2 ** 53), the best possible value for N is 56:

```
>>> 2 ** 52
4503599627370496
>>> 2 ** 53
9007199254740992
>>> 2 ** 56/10
7205759403792793 
```

So 56 is the only possible value for N which leaves exactly 53 bits for J. The best possible value for J is therefore this quotient, rounded:

```
>>> q, r = divmod (2 ** 56, 10)
>>> r
6 
```

Since the carry is greater than half of 10, the best approximation is obtained by rounding up:

```
>>> q + 1
7205759403792794 
```

Therefore the best possible approximation for 1/10 in "IEEE-754 double precision" is this above 2 ** 56, that is:

```
7205759403792794/72057594037927936 
```

Note that since the rounding was done upward, the result is actually slightly greater than 1/10; if we hadn't rounded up, the quotient would have been slightly less than 1/10\. But in no case is it exactly 1/10!

So the computer never "sees" 1/10: what it sees is the exact fraction given above, the best approximation using the double precision floating point numbers from the "" IEEE-754 ":

```
>>>. 1 * 2 ** 56
7205759403792794.0 
```

If we multiply this fraction by 10 ** 30, we can observe the values ​​of its 30 decimal places of strong weight.

```
>>> 7205759403792794 * 10 ** 30 // 2 ** 56
100000000000000005551115123125L 
```

meaning that the exact value stored in the computer is approximately equal to the decimal value 0.100000000000000005551115123125\. In versions prior to Python 2.7 and Python 3.1, Python rounded these values ​​to 17 significant decimal places, displaying “0.10000000000000001”. In current versions of Python, the displayed value is the value whose fraction is as short as possible while giving exactly the same representation when converted back to binary, simply displaying “0.1”.

* * *

## 回答 #25

> 赞同：7
> 
> 时间：2021-09-16T00:28:18.790

The trap with floating point numbers is that they look like decimal but they work in binary.

The only prime factor of 2 is 2, while 10 has prime factors of 2 and 5\. The result of this is that every number that can be written exactly as a binary fraction can also be written exactly as a decimal fraction but only a subset of numbers that can be written as decimal fractions can be written as binary fractions.

A floating point number is essentially a binary fraction with a limited number of significant digits. If you go past those significant digits then the results will be rounded.

When you type a literal in your code or call the function to parse a floating point number to a string, it expects a decimal number and it stores a binary approximation of that decimal number in the variable.

When you print a floating point number or call the function to convert one to a string it prints a decimal approximation of the floating point number. It *is* possible to convert a binary number to decimal exactly, but no language I'm aware of does that by default when converting to a string*. Some languages use a fixed number of significant digits, others use the shortest string that will "round trip" back to the same floating point value.

* Python *does* convert exactly when converting a floating point number to a "decimal.Decimal". This is the easiest way I know of to obtain the exact decimal equivalent of a floating point number.

* * *

## 回答 #26

> 赞同：5
> 
> 时间：2018-12-20T18:27:35.127

Imagine working in base ten with, say, 8 digits of accuracy. You check whether

```
1/3 + 2 / 3 == 1 
```

and learn that this returns `false`. Why? Well, as real numbers we have

*1/3 = 0.333....* and *2/3 = 0.666....*

Truncating at eight decimal places, we get

```
0.33333333 + 0.66666666 = 0.99999999 
```

which is, of course, different from `1.00000000` by exactly `0.00000001`.

* * *

The situation for binary numbers with a fixed number of bits is exactly analogous. As real numbers, we have

*1/10 = 0.0001100110011001100... (base 2)*

and

*1/5 = 0.0011001100110011001... (base 2)*

If we truncated these to, say, seven bits, then we'd get

```
0.0001100 + 0.0011001 = 0.0100101 
```

while on the other hand,

*3/10 = 0.01001100110011... (base 2)*

which, truncated to seven bits, is `0.0100110`, and these differ by exactly `0.0000001`.

* * *

The exact situation is slightly more subtle because these numbers are typically stored in scientific notation. So, for instance, instead of storing 1/10 as `0.0001100` we may store it as something like `1.10011 * 2^-4`, depending on how many bits we've allocated for the exponent and the mantissa. This affects how many digits of precision you get for your calculations.

The upshot is that because of these rounding errors you essentially never want to use == on floating-point numbers. Instead, you can check if the absolute value of their difference is smaller than some fixed small number.

* * *

## 回答 #27

> 赞同：5
> 
> 时间：2019-04-22T01:02:32.437

Decimal numbers such as `0.1`, `0.2`, and `0.3` are not represented exactly in binary encoded floating point types. The sum of the approximations for `0.1` and `0.2` differs from the approximation used for `0.3`, hence the falsehood of `0.1 + 0.2 == 0.3` as can be seen more clearly here:

```
#include <stdio.h>

int main() {
    printf("0.1 + 0.2 == 0.3 is %s\n", 0.1 + 0.2 == 0.3 ? "true" : "false");
    printf("0.1 is %.23f\n", 0.1);
    printf("0.2 is %.23f\n", 0.2);
    printf("0.1 + 0.2 is %.23f\n", 0.1 + 0.2);
    printf("0.3 is %.23f\n", 0.3);
    printf("0.3 - (0.1 + 0.2) is %g\n", 0.3 - (0.1 + 0.2));
    return 0;
} 
```

Output:

```
0.1 + 0.2 == 0.3 is false
0.1 is 0.10000000000000000555112
0.2 is 0.20000000000000001110223
0.1 + 0.2 is 0.30000000000000004440892
0.3 is 0.29999999999999998889777
0.3 - (0.1 + 0.2) is -5.55112e-17 
```

For these computations to be evaluated more reliably, you would need to use a decimal-based representation for floating point values. The C Standard does not specify such types by default but as an extension described in a [technical Report](http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1312.pdf).

The `_Decimal32`, `_Decimal64` and `_Decimal128` types might be available on your system (for example, [GCC](http://en.wikipedia.org/wiki/GNU_Compiler_Collection) supports them on [selected targets](https://gcc.gnu.org/onlinedocs/gcc-4.2.4/gcc/Decimal-Float.html), but [Clang](http://en.wikipedia.org/wiki/Clang) does not support them on [OS X](http://en.wikipedia.org/wiki/OS_X)).

* * *

## 回答 #28

> 赞同：4
> 
> 时间：2017-12-22T16:39:07.813

Since this thread branched off a bit into a general discussion over current floating point implementations I'd add that there are projects on fixing their issues.

Take a look at [https://posithub.org/](https://posithub.org/) for example, which showcases a number type called posit (and its predecessor unum) that promises to offer better accuracy with fewer bits. If my understanding is correct, it also fixes the kind of problems in the question. Quite interesting project, the person behind it is a mathematician it [Dr. John Gustafson](http://www.johngustafson.net/). The whole thing is open source, with many actual implementations in C/C++, Python, Julia and C# ([https://hastlayer.com/arithmetics](https://hastlayer.com/arithmetics)).

* * *

## 回答 #29

> 赞同：4
> 
> 时间：2019-05-07T19:45:11.373

> It's actually pretty simple. When you have a base 10 system (like ours), it can only express fractions that use a prime factor of the base. The prime factors of 10 are 2 and 5\. So 1/2, 1/4, 1/5, 1/8, and 1/10 can all be expressed cleanly because the denominators all use prime factors of 10\. In contrast, 1/3, 1/6, and 1/7 are all repeating decimals because their denominators use a prime factor of 3 or 7\. In binary (or base 2), the only prime factor is 2\. So you can only express fractions cleanly which only contain 2 as a prime factor. In binary, 1/2, 1/4, 1/8 would all be expressed cleanly as decimals. While, 1/5 or 1/10 would be repeating decimals. So 0.1 and 0.2 (1/10 and 1/5) while clean decimals in a base 10 system, are repeating decimals in the base 2 system the computer is operating in. When you do math on these repeating decimals, you end up with leftovers which carry over when you convert the computer's base 2 (binary) number into a more human readable base 10 number.

From [https://0.30000000000000004.com/](https://0.30000000000000004.com/)

* * *

## 回答 #30

> 赞同：4
> 
> 时间：2020-08-20T15:38:53.507

Normal arithmetic is base-10, so decimals represent tenths, hundredths, etc. When you try to represent a floating-point number in binary base-2 arithmetic, you are dealing with halves, fourths, eighths, etc.

In the hardware, floating points are stored as integer mantissas and exponents. Mantissa represents the significant digits. Exponent is like scientific notation but it uses a base of 2 instead of 10\. For example 64.0 would be represented with a mantissa of 1 and exponent of 6\. 0.125 would be represented with a mantissa of 1 and an exponent of -3.

Floating point decimals have to add up negative powers of 2

```
0.1b = 0.5d
0.01b = 0.25d
0.001b = 0.125d
0.0001b = 0.0625d
0.00001b = 0.03125d 
```

and so on.

It is common to use a error delta instead of using equality operators when dealing with floating point arithmetic. Instead of

```
if(a==b) ... 
```

you would use

```
delta = 0.0001; // or some arbitrarily small amount
if(a - b > -delta && a - b < delta) ... 
```

* * *

## 回答 #31

> 赞同：2
> 
> 时间：2019-10-05T21:46:11.000

# I just saw this interesting issue around floating points:

Consider the following results:

```
error = (2**53+1) - int(float(2**53+1)) 
```

```
>>> (2**53+1) - int(float(2**53+1))
1 
```

We can clearly see a breakpoint when `2**53+1` - all works fine until `2**53`.

```
>>> (2**53) - int(float(2**53))
0 
```

[![Enter image description here](https://i.stack.imgur.com/wBcnd.png)](https://i.stack.imgur.com/wBcnd.png)

**This happens because of the double-precision binary: IEEE 754 double-precision binary floating-point format: binary64**

From the Wikipedia page for [Double-precision floating-point format](https://en.wikipedia.org/wiki/Double-precision_floating-point_format):

> Double-precision binary floating-point is a commonly used format on PCs, due to its wider range over single-precision floating point, in spite of its performance and bandwidth cost. As with single-precision floating-point format, it lacks precision on integer numbers when compared with an integer format of the same size. It is commonly known simply as double. The IEEE 754 standard specifies a binary64 as having:
> 
> *   Sign bit: 1 bit
> *   Exponent: 11 bits
> *   Significant precision: 53 bits (52 explicitly stored)
> 
> [![Enter image description here](https://i.stack.imgur.com/8nxM0.png)](https://i.stack.imgur.com/8nxM0.png)
> 
> The real value assumed by a given 64-bit double-precision datum with a given biased exponent and a 52-bit fraction is
> 
> [![Enter image description here](https://i.stack.imgur.com/t8ztO.png)](https://i.stack.imgur.com/t8ztO.png)
> 
> or
> 
> [![Enter image description here](https://i.stack.imgur.com/f4PNU.png)](https://i.stack.imgur.com/f4PNU.png)

*Thanks to @a_guest for pointing that out to me.*

# emacs - 如何突出显示 Emacs 中的 CVS 更改？

> ID：588005
> 
> 赞同：6
> 
> 时间：2009-02-25T21:39:06.740
> 
> 标签：emacs, highlight, cvs

我正在使用带有 cvs 的 emacs 并启用了 cvs 模式。我想逐行突出显示 CVS 中最新版本的更改。我已经在 intellij 中看到了这一点，其中有一个绿色指示表示添加的行，另一个指示表示已修改的行，第三个符号表示已删除的行。

emacs 是否有 cvs 高亮模式来显示最新版本 cvs 的更改？我不是在寻找可以`cvs diff`在新缓冲区中打开的类型功能，而是在我当前的缓冲区中指示哪些行已被修改的东西。

在下图中，左侧有一个蓝色矩形，Intellij 称之为“装订线”，表示代码与源代码管理中的不同。

[![智能示例](https://i.stack.imgur.com/0LG7q.gif)](https://i.stack.imgur.com/0LG7q.gif)
[（来源：[jetbrains.com](http://www.jetbrains.com/idea/features/screenshots/60/actions.gif)）]

我在 emacs 中寻找类似的功能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T11:45:57.593

您现在可以查看[diff-hl](https://github.com/dgutov/diff-hl)，它在左侧窗口边缘提供突出显示。

到目前为止，我只在一些现代 DVCS 上对其进行了测试，但如果您仍在使用 CVS，并且它不能正常工作，请提出问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T00:21:43.543

Here's another answer that doesn't do what you want either, but may be useful.

```
C-x v g 
```

runs the command `vc-annotate`.

That'll pop up a new buffer (I know, you didn't want one), but it'll have all the lines marked with who touched them when. And, bonus, they're color coded with a heatmap (red is most recent, blue is least), for easy identification of recent changes.

Of course the built-in version of vc-annotate doesn't scroll the buffer appropriately, so you'll want this advice:

```
(defadvice vc-annotate (around vc-annotate-and-scroll)
  "scroll buffer to view current line in the annotated buffer"
  (let ((pos (count-lines (point-min) (point))))
    ad-do-it
    (let ((orig-window (selected-window))
          (window (other-window-for-scrolling)))
      (select-window window)
      (goto-line pos)
      (select-window orig-window))))

(ad-activate 'vc-annotate) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T02:38:29.160

你想要，默认情况下`vc-diff`是打开的。`C-x v =`这为您提供临时缓冲区中的原始差异输出。缓冲区使用差异模式，它有一些巧妙的技巧......例如，您可以使用`C-c C-e`将差异作为补丁应用到另一个文件。在 diff 缓冲区中使用`describe-mode`(`C-h m`默认情况下) 来查找其他技巧。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T23:06:28.887

也许您喜欢[Ediff](http://www.delorie.com/gnu/docs/emacs/ediff.html#SEC_Top)，它似乎完全符合您的要求。

# wcf - WCF 服务在 computername.mydomain.local/service.svc 上运行，为什么？

> ID：588008
> 
> 赞同：1
> 
> 时间：2009-02-25T21:39:32.060
> 
> 标签：wcf, web-services, .net-3.0

我在 IIS7 上运行的 WCF 服务似乎可以在以下位置解决：

[http://computername.mydomain.local/service.svc](http://computername.mydomain.local/service.svc)

我的 web.config 没有引用任何网址。

可能是什么原因？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T21:45:18.707

它因为它获取您计算机的名称，您可以通过 IIS 配置更改它，也在 WSDL 文件中添加此引用

这是解决方案的[帖子](http://forums.asp.net/p/1096811/1659596.aspx)

# iphone - Instruments 可以在自动释放的对象上显示泄漏吗？

> ID：588013
> 
> 赞同：4
> 
> 时间：2009-02-25T21:40:26.100
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch

我很难理解实际泄漏发生在哪里以及它们不在我使用 Instruments 的应用程序中的哪里。我有自动释放的对象，之后没有保留..通过仪器显示为泄漏。还有一堆被列为泄漏的对象，它们并没有指向我自己编写的任何代码。也许这是一种多米诺骨牌效应，其中我的一个真正的泄漏导致 Apple 库中的东西泄漏，但我不愿意相信是这种情况。区分真正泄漏发生位置的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T22:00:57.313

根据我的经验，Instruments 不会对自动发布的项目给出误报。（这些仍然被自动释放池引用，所以没有神奇的区别）。

对于内存泄漏，确实可以通过多米诺骨牌效应，因为一个罪魁祸首会导致许多级联泄漏。在仪器中，每个泄漏都会有一个基于时间的标识，所以我建议您从第一次泄漏开始。

# emacs - ido-switch-buffer 和 bury-buffer

> ID：588018
> 
> 赞同：2
> 
> 时间：2009-02-25T21:40:57.160
> 
> 标签：emacs, buffer, elisp

我最近开始使用 ido-mode，总的来说，它非常好。但有一件事似乎特别坏，我想知道是否有一个设置（ha）埋在那里来修复它。

ido-switch-buffer 似乎并不关心隐藏的缓冲区。也就是说，如果我使用 bury-buffer，然后使用 ido-switch-buffer，第一个选择通常是我刚刚埋的那个。

有没有简单的方法解决这个问题？掩埋缓冲区的全部意义在于我不想很快再次看到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T07:30:19.970

根据文档 ( `C-h f bury-buffer`)

```
Put BUFFER-OR-NAME at the end of the list of all buffers.
There it is the least likely candidate for 'other-buffer' to return;
thus, the least likely buffer for C-x b to select by
default. 
```

所以，如果你使用`bury-buffer`缓冲区，它仍然可用（在列表的末尾），所以`ido-switch-buffer`找到它是正常的。

如果你不想看到那个缓冲区，你应该考虑关闭它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-30T20:01:00.817

我无法重现这个。据我所知，在 Emacs 23 上，ido-switch-buffer 以正确的顺序列出了缓冲区。

在任何情况下，您都可以尝试 iswitchb。它有点像 ido，只是更老且更特定于缓冲区切换。如果你喜欢它，你可以使用 iswitchb 进行缓冲区切换，使用 ido 进行其他所有操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-09T04:43:21.040

也无法重现这一点：当我埋藏缓冲区并`ido-switch-buffer`随后调用时，埋藏的缓冲区不在开关列表的前面。

我已经做了很多 ido 自定义（让它与 dired 等一起正常工作），但我的主要 ido 设置是：

```
(setq ido-show-dot-for-dired t)
(setq ido-default-file-method 'samewindow)
(setq ido-default-buffer-method 'samewindow)
(setq ido-confirm-unique-completion t)
(setq ido-max-dir-file-cache 20) 
```

我的`ido.el`版本是“*在 gnu.emacs.sources 上发布的 1.57 适用于 emacs 22.1* ”。

hth。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-30T15:05:19.660

FWIW，`switch-to-buffer`Emacs-24 中 (Cx b) 的默认补全行为已更改为使用子字符串匹配补全，因此其行为类似于 IDO，同时遵循“默认缓冲区不应该是我刚刚埋葬的那个”的原则”。您可以通过打开使其更加相似`icomplete-mode`（这不会改变完成行为本身，但会在 minibuffer 的末尾显示完成候选）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-11T01:31:37.460

使用`next-buffer`或`previous-buffer`

# svn - 如何在提交期间忽略特定的 Subversion 子目录

> ID：588024
> 
> 赞同：3
> 
> 时间：2009-02-25T21:42:29.557
> 
> 标签：svn

在我正在从事的当前项目中，有人决定将二进制文件作为源代码树的一部分签入。二进制文件位于源本身下方的目录中：

```
project/src             # Here is the location of the source code
project/src/more_src    # Some more source code lives here
project/src/bin         # Here are the binary files 
```

正如你所想象的那样，合并冲突总是因此而发生。这很烦人，因为我认为*任何*开发人员的机器都不应该提交二进制文件——这应该留给构建服务器。

我是 subversion 的命令行用户。我想忽略该`bin`目录，以便在我使用时`svn st`跳过`svn ci`这些目录（即使有待处理的更改）。

`more_src`不幸的是，由于目录，我不能使用 -N （非递归） 。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-25T22:08:10.650

**编辑**：颠覆 1.6 已发布。从发行说明：

> 在 Subversion 1.6 中，svn update 的 --set-depth 参数增加了一个新值——exclude。这个值告诉 Subversion 立即从工作副本中排除目标，直到另行通知。在 Subversion 1.6 之前，如果无法从工作副本中轻松删除目录。...

下面的所有东西现在都过时了。

* * *

您可以将工作副本中文件夹的深度限制在正确的位置，这样不需要的文件就不会显示为版本化文件。~~但是，您不能减少现有工作副本的深度。~~

1）像这样签出一个干净的工作副本（它将只包含根目录中的文件和空文件夹）：

> svn co --depth immediates repoURL /some/wc/path

2）现在对于您不想忽略的每个文件夹，使用

```
svn update --depth infinity /some/good/path 
```

如果包含要忽略的内容的文件夹不在工作副本的根目录中，您可以通过反复调用

```
svn update --depth immediates /some/path/to/make/deeper 
```

这种方法确实有一个缺点。如果要忽略的文件通过您自己的操作（例如构建）出现在您的工作副本中，它们将以 svn 状态显示为未版本控制的文件。您甚至可以 svn 添加它们并导致“文件已存在”提交错误。

* * *

**编辑：**显然你可以减少工作副本的部分深度，这要简单得多：

1.  正常项目结帐（或从现有工作副本开始）
2.  删除不需要的文件夹（正常文件系统删除，而不是 svn rm）。此时该文件夹已*丢失*，如果您进行正常更新，该文件夹将返回所有邪恶内容。
3.  带回文件夹

> svn update --depth empty /path/where/deleted/folder/was

现在您可以对整个项目进行 svn 更新，但不良内容不会返回。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T21:48:30.650

我将创建一个脚本或别名来直接通过一个命令处理子目录。

我有一个类似的场景，并且有一组这样的别名：

```
alias up-all='svn up ~/includes ~/scripts ~/htdocs/intra ~/htdocs/update' 
```

如果您在 Windows 上，您可以拼凑一些 .bat 或其他脚本并将它们放在您的路径中以实现相同的结果。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-10T16:37:07.747

通常您只想保留已明确发布的二进制文件，即测试部门使用的官方版本或二进制文件。所以提交每个新构建的二进制文件真的没有意义。

因此，真正解决您的问题的方法是重新设计您的 SVN 存储库。构建文件的目录不应受源代码控制，并且应使用 svn:ignore 属性忽略。这可以防止新构建的二进制文件被 SVN 注意到。其次，您可以创建一个单独的目录来存储您想要保留的二进制文件。当然，这个目录需要受版本控制。

现在您可以进行开发，而不必担心更改二进制文件。当您最终到达您确实想要保留这些二进制文件的阶段时，您只需将这些二进制文件复制到上面创建的单独目录中，从而覆盖旧的。SVN 现在会注意到文件已更改，您可以提交它们。

我在过去看到的另一种方法是首先从您的源代码树中创建一个 TAG。然后构建服务器（或您自己）检出此 TAG 并从检出的 TAG 构建二进制文件。之后，构建的二进制文件在该 TAG 之上提交。许多人认为你永远不应该在 TAG 之上提交，但它可能对你有用。您应该记住的唯一想法是，当您导出/签出该 TAG 时，您必须采用 HEAD 修订版，而不是 TAG 自己的修订版（即 HEAD-1）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T22:16:28.087

如果它们是受版本控制的，那么颠覆就是它的工作:)

wcoenen 的方法也应该在一些工作之后完成这项工作，另一种方法可能是执行 svn revert /project/src/bin 然后 svn ci 的脚本。

值得一提的是，这就是我们设置“部署”目录并始终忽略 bin 和 obj 目录输出的原因之一。这样，只有在某些发布版本上，二进制输出才会被复制（并添加到 svn）以进行部署。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-01T13:53:06.207

添加到上述内容的另一个重要说明（从[http://svnbook.red-bean.com/nightly/en/svn.advanced.props.special.ignore.html](http://svnbook.red-bean.com/nightly/en/svn.advanced.props.special.ignore.html)复制）：

Subversion 对可忽略文件模式的支持**仅**扩展到将未版本控制的文件和目录添加到版本控制**的一次性过程。**一旦对象在 Subversion 的控制之下，忽略模式机制**就不再适用**于它。换句话说，**不要期望 Subversion 仅仅因为该文件的名称与忽略模式匹配而避免提交您对版本化文件所做的更改**——Subversion 总是会注意到它的所有版本化对象。

# sql-server - SQL 问题：使用 CONTAINS() 不起作用，但 LIKE 工作正常

> ID：588025
> 
> 赞同：15
> 
> 时间：2009-02-25T21:42:40.213
> 
> 标签：sql-server, tsql, full-text-search

我在 SQL Server 数据库中有一个 Products 表，我不得不对使用全文索引的旧存储过程进行故障排除。出于我们的目的，假设 Products 表有两个字段 ID，Keywords。关键字字段填充以下内容：

> ROLAND SA-300 这款 Roland SA-300 处于完好状态！

当我运行以下语句时，我能够检索记录：

```
SELECT * FROM Products WHERE Keywords LIKE '%SA-300%' 
```

但是，当我运行以下任何语句时，我得到零结果：

```
SELECT * FROM Products WHERE CONTAINS(Keywords, ' SA-300 ')
SELECT * FROM Products WHERE CONTAINS(Keywords, 'SA-300')
SELECT * FROM Products WHERE CONTAINS(Keywords, '"SA-300"')
SELECT * FROM Products WHERE CONTAINS(Keywords, '"*SA-300*"') 
```

但我知道 CONTAINS() 函数正在工作，因为当我运行以下任何一个时都会得到结果：

```
SELECT * FROM Products WHERE CONTAINS(Keywords, ' Roland ')
SELECT * FROM Products WHERE CONTAINS(Keywords, 'Roland')
SELECT * FROM Products WHERE CONTAINS(Keywords, '"Roland"')
SELECT * FROM Products WHERE CONTAINS(Keywords, '"*Roland*"')
SELECT * FROM Products WHERE CONTAINS(Keywords, 'Roland') 
```

我需要弄清楚为什么 CONTAINS() 函数不适用于“SA-300”术语。我是全文索引的新手，因此不胜感激。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-25T22:06:03.183

两个想法：

(1) 连字符可能被视为分词 这些返回什么？

```
SELECT * FROM Products WHERE CONTAINS(Keywords, 'SA')
SELECT * FROM Products WHERE CONTAINS(Keywords, 'SA 300')
SELECT * FROM Products WHERE CONTAINS(Keywords, 'SA300') 
```

请参阅[另一个问题](https://stackoverflow.com/questions/1042/why-doesnt-sql-full-text-indexing-return-results-for-words-containing/1061)。

(2) 您是否尝试过重建全文索引？它可能已经过时了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-25T22:13:20.373

原来我需要重新构建我的全文索引。感谢@MichaelGG 和@JohnFx 的提示

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-28T02:54:49.900

啊! 谢谢@GregD。我们在查找“this*”或“never*”时没有找到字符串“this never ends”。原来**这两个**词都在noiseENG.txt 中。

看起来不可能在每个查询的基础上关闭它，但基于此： [SQL 2008: Turn off Stop Words for Full Text Search Query](https://stackoverflow.com/questions/8435602/sql-2008-turn-off-stop-words-for-full-text-search-query)

我跑了

```
ALTER FULLTEXT INDEX ON MyTable SET STOPLIST = OFF 
```

我们开始得到我们想要的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T22:08:05.190

你看过你的噪音词文件吗？在我的机器上，它位于 c:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\FTData\noiseENG.txt

您可以测试这一点的一种方法是用一个空格编辑您的特定噪声文件，以便它索引所有内容并再次尝试您的查询。我会在测试环境中而不是在生产环境中“测试”它。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-25T22:04:50.067

你能试一下吗

```
SELECT * FROM Products WHERE CONTAINS(Keywords, ' "SA-300" ') 
```

[我在msdn](http://msdn.microsoft.com/en-us/library/aa172870(SQL.80).aspx)上看到了您尝试执行的操作的示例。

# jquery - 打开 jQuery Accordion 的链接

> ID：588030
> 
> 赞同：10
> 
> 时间：2009-02-25T21:43:08.777
> 
> 标签：jquery, accordion

我正在尝试从外部链接打开手风琴 div。我看到了“navigation: true”选项，但我不确定如何实现它。你给每个 div 一个 id 并像这样调用链接吗？[http://domain.com/link#anchorid](http://domain.com/link#anchorid)

我是 jQuery 的新手，所以请耐心等待。如果有帮助，这是我正在使用的代码。

```
<script type="text/javascript">
    $(function(){
        $("#accordion").accordion({ header: "h2", autoHeight: false, animated: false, navigation: true });
         });
    </script>
<div id="accordion">

<div>
    <h2><a href="#">Services</a></h2>
    <div class="services">
    <p>More information about all of these services</p>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-25T23:27:25.530

导航选项不适用于面板激活。这是为了告诉用户他们在哪里。

使用简化的 html 代码：

```
<div id="accordion">

    <div>
        <h2><a href="#services">Services</a></h2>
        <p>More information about all of these services</p>
    </div>

    <div>
        <h2><a href="#about">About</a></h2>
        <p>About us</p>
    </div>

</div> 
```

您将唯一 ID 放在标题中的超链接中

然后是 jQuery（简化）：

```
<script type="text/javascript">
    $(function(){
        $("#accordion").accordion({ header: "h2", navigation: true });
     });
</script> 
```

“navigation : true”将使您能够访问 www.site.com/#about，从而选择“about”面板。对于激活，有几种方法。也许一种方法是获取一个查询字符串并将其放入 jQuery 中。

用 C#

```
$("#accordion").accordion("activate", '<%= Request.QueryString["id"] %>'); 
```

使用 PHP

```
$("#accordion").accordion("activate", '<?php echo $_GET['id']; ?>'); 
```

这将允许您指定通过 www.site.com?id=2 打开哪个面板

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-07-10T14:17:55.083

`navigation`许多这些答案引用的选项[在 jQuery UI 1.9中](http://jqueryui.com/upgrade-guide/1.9/#deprecated-navigation-and-navigationfilter-options)[**已弃用**](http://jqueryui.com/upgrade-guide/1.9/#deprecated-navigation-and-navigationfilter-options)，并在 1.10 中**删除。**给出的理由是：

> 默认情况下禁用此功能，这只是您可能希望确定在初始化时激活哪个面板的众多方法之一。因此，我们已经弃用了这一点，而只支持在手风琴之外处理逻辑并适当地设置活动选项。

因此，使用较新版本的 jQuery UI 的编码人员将需要编写自己的代码来处理此功能。

对于我的网站，我在标记`switch`之前使用 JavaScript 语句完成了此操作。`</body>`（我不是经验丰富的编码员，所以其他人应该随时改进这个答案。）

```
<script>
function switchToPanel(panel){
    var index = -1;
    switch (panel) {
        case "preschool":
            index = 0;
            break;
        case "kindergarten":
            index = 1;
            break;
        case "1st":
            index = 2;
            break;
        default:
            console.warn("Cannot switch to panel " + panel);
    }
    jQuery('#mathAccordion').accordion({active: index});
}

jQuery().ready(function() {
    if (window.location.hash) { //window.location.hash gets the anchor location out of the URL
        var target = window.location.hash.replace('#', ''); //remove the #
        switchToPanel(target);
    }
});
</script> 
```

这是相应的 HTML：

```
<div class="accordion" id="mathAccordion">
    <h1>Preschool</h1>
    <div class="accordionFold">Preschool content</div>
    <h1>Kindergarten</h1>
    <div class="accordionFold">Kindergarten content</div>
    <h1>1st Grade</h1>
    <div class="accordionFold">First grade content</div>
</div> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-03-24T14:49:17.903

哈，破解了。

使用 php 获取方法。但是，上面的有一个错误。$("#accordion").accordion("activate", '');

php 代码需要去掉引号。

现在可以享受美食了。

干杯

伊恩

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T21:51:51.423

使用服务器端语言，检查该#anchor 的查询并使用它来填写激活语句。

从我刚刚研究的东西中提取：

```
$("#search_forms").accordion("activate", "{$this->open_form}"); 
```

**编辑：**

我不能直接链接到手风琴方法简介，但这会让你接近：

[http://docs.jquery.com/UI/Accordion#methods](http://docs.jquery.com/UI/Accordion#methods)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-05T19:52:09.247

这对我有用...

```
var hash = window.location.hash;
$("#accordion").accordion("activate", hash); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-08-15T18:01:48.113

这对我有用。

```
<script>
$(function() {
    $( "#accordion" ).accordion({
        active: false,
        collapsible: true,
        heightStyle: "content",
        navigation: true,
        header: ".menuitem"
     });

    var hash = window.location.hash;
    var anchor = $('a[href$="'+hash+'"]');
    if (anchor.length > 0){
        anchor.click();
    }
});
</script> 
```

和html...

```
<div id="accordion">
        <h3 class="menuitem"><a href="#tab1">Tab1</a></h3>
        <div>
            More data....
        </div>
</div> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-11T15:01:12.683

```
$("a").click(function(event){
    var hash = window.location.hash;
    $("#accordion").accordion("activate", hash);
}); 
```

这适用于 jquery 1.8.3 和 jqueryui 1.9.1，但似乎不适用于 jqueryui 1.10.0

不知道为什么...

# sql-server - 具有多个数据库的视图的全文索引

> ID：588037
> 
> 赞同：3
> 
> 时间：2009-02-25T21:44:36.370
> 
> 标签：sql-server, full-text-search, full-text-indexing

MS SQL 能否支持连接（连接或联合）多个数据库的视图的全文索引？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T16:06:36.333

是的，一点没错。每个索引将被单独查询，结果将由引擎组合。

例如，如果您有：

*   带有全文索引的 DatabaseA、TableA、FieldA
*   DatabaseB、TableB、FieldB 带全文索引

而且您有一个视图，其中包含两个数据库中两个表的两个字段，当您查询该视图时它会正常工作。从 SQL Server 的角度来看，它们是否在同一个数据库中并不重要。

如果这与您的情况不符，请尝试发布有关您的挑战的更多详细信息。谢谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-08T14:23:52.743

一点都不。

您不能在没有索引的表或视图上创建全文索引。

您不能使用包含左/右连接或联合的聚集索引创建视图。

您可以对包含来自另一个数据库的数据的视图执行全文搜索，但前提是它包含单个表或内部连接表。

# javascript - window.onload 与 document.onload

> ID：588040
> 
> 赞同：819
> 
> 时间：2009-02-25T21:45:11.487
> 
> 标签：javascript, event-handling, dom-events

哪个得到更广泛的支持：`window.onload`或`document.onload`？

* * *

## 回答 #1

> 赞同：835
> 
> 时间：2009-02-25T21:46:45.787

## 他们什么时候开火？

[`window.onload`](https://developer.mozilla.org/en-US/docs/Web/API/GlobalEventHandlers.onload)

*   默认情况下，它会在整个页面加载时触发，**包括**其内容（图像、CSS、脚本等）。

在某些浏览器中，它现在接管了 DOM 的角色`document.onload`并在 DOM 准备就绪时触发。

`document.onload`

*   当 DOM 准备好时调用它，这可以**在**加载图像和其他外部内容之前。

## 他们的支持程度如何？

`window.onload`似乎得到了最广泛的支持。事实上，一些最现代的浏览器在某种意义上已经`document.onload`被`window.onload`.

浏览器支持问题很可能是许多人开始使用诸如[jQuery](http://jquery.com/)之类的库来处理准备好的文档检查的原因，如下所示：

```
$(document).ready(function() { /* code here */ });
$(function() { /* code here */ }); 
```

* * *

为了历史的目的。`window.onload`与`body.onload`：

> [不久前在codingforums](http://www.codingforums.com/archive/index.php/t-106229.html)`window.onload`上就over的使用提出了一个类似的问题`body.onload`。结果似乎是你应该使用的`window.onload`，因为将你的结构与动作分开是很好的。

* * *

## 回答 #2

> 赞同：299
> 
> 时间：2011-09-10T12:05:03.700

一般的想法是**window.onload**在文档的窗口**准备好呈现**时触发，而**document.onload**在**DOM 树**（由文档中的标记代码构建）**完成**时触发。

理想情况下，订阅[DOM 树事件](http://en.wikipedia.org/wiki/DOM_events)，允许通过 Javascript 进行屏幕外操作，**几乎不会产生 CPU 负载**。相反，当多个外部资源尚未被请求、解析和加载时，**`window.onload`**可能**需要一段时间才能触发。**

**►测试场景：**

要观察差异以及您选择**的浏览器如何****实现**上述**事件处理程序**，只需在文档的`<body>`-- 标记中插入以下代码。

```
<script language="javascript">
window.tdiff = []; fred = function(a,b){return a-b;};
window.document.onload = function(e){ 
    console.log("document.onload", e, Date.now() ,window.tdiff,  
    (window.tdiff[0] = Date.now()) && window.tdiff.reduce(fred) ); 
}
window.onload = function(e){ 
    console.log("window.onload", e, Date.now() ,window.tdiff, 
    (window.tdiff[1] = Date.now()) && window.tdiff.reduce(fred) ); 
}
</script> 
```

**►结果：**

这是 Chrome v20（可能是大多数当前浏览器）可观察到的结果行为。

*   没有`document.onload`事件。
*   `onload`在 中声明时触发两次，在 中声明时触发`<body>`一次`<head>`（然后事件充当`document.onload`）。
*   根据计数器的状态进行计数和操作允许模拟这两种事件行为。
*   或者，在 HTML-元素`window.onload`的范围内声明事件处理程序。`<head>`

**►示例项目：**

上面的代码取自[这个项目的](https://github.com/lsauer/KeyBoarder/tree/gh-pages)代码库（`index.html`和`keyboarder.js`）。

* * *

[有关窗口对象的事件处理程序](https://developer.mozilla.org/en-US/docs/DOM/window#Event_handlers)列表，请参阅 MDN 文档。

* * *

## 回答 #3

> 赞同：201
> 
> 时间：2016-06-28T11:57:27.233

**添加事件监听器**

```
<script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function(event) {
      /* 
        - Code to execute when only the HTML document is loaded.
        - This doesn't wait for stylesheets, 
          images, and subframes to finish loading. 
      */
  });
</script> 
```

* * *

# `Update March 2017`

## 1 香草 JavaScript

```
window.addEventListener('load', function() {
    console.log('All assets are loaded')
}) 
```

* * *

## 2 jQuery

```
$(window).on('load', function() {
    console.log('All assets are loaded')
}) 
```

* * *

祝你好运。

* * *

## 回答 #4

> 赞同：97
> 
> 时间：2016-07-22T02:49:12.703

根据[Parsing HTML documents - The end](https://www.w3.org/TR/html5/syntax.html#the-end) ,

1.  浏览器解析 HTML 源代码并运行延迟脚本。

2.  A在所有 HTML 都被解析并运行时`DOMContentLoaded`调度。`document`事件冒泡到`window`.

3.  浏览器加载延迟加载事件的资源（如图像）。

4.  一个`load`事件在`window`.

因此，执行顺序将是

1.  `DOMContentLoaded``window`捕获阶段的事件监听器
2.  `DOMContentLoaded`的事件监听器`document`
3.  `DOMContentLoaded``window`处于冒泡阶段的事件监听器
4.  `load`的事件监听器（包括`onload`事件处理程序）`window`

**永远不应调用其中的气泡`load`事件侦听器（包括`onload`事件处理程序） 。`document`**可能只调用捕获`load`侦听器，但由于加载了像样式表这样的子资源，而不是由于文档本身的加载。

```
window.addEventListener('DOMContentLoaded', function() {
  console.log('window - DOMContentLoaded - capture'); // 1st
}, true);
document.addEventListener('DOMContentLoaded', function() {
  console.log('document - DOMContentLoaded - capture'); // 2nd
}, true);
document.addEventListener('DOMContentLoaded', function() {
  console.log('document - DOMContentLoaded - bubble'); // 2nd
});
window.addEventListener('DOMContentLoaded', function() {
  console.log('window - DOMContentLoaded - bubble'); // 3rd
});

window.addEventListener('load', function() {
  console.log('window - load - capture'); // 4th
}, true);
document.addEventListener('load', function(e) {
  /* Filter out load events not related to the document */
  if(['style','script'].indexOf(e.target.tagName.toLowerCase()) < 0)
    console.log('document - load - capture'); // DOES NOT HAPPEN
}, true);
document.addEventListener('load', function() {
  console.log('document - load - bubble'); // DOES NOT HAPPEN
});
window.addEventListener('load', function() {
  console.log('window - load - bubble'); // 4th
});

window.onload = function() {
  console.log('window - onload'); // 4th
};
document.onload = function() {
  console.log('document - onload'); // DOES NOT HAPPEN
};
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2015-01-26T04:08:11.900

在 Chrome 中，window.onload 与 不同`<body onload="">`，而在 Firefox（35.0 版）和 IE（11 版）中它们是相同的。

您可以通过以下代码段进行探索：

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <!--import css here-->
        <!--import js scripts here-->

        <script language="javascript">

            function bodyOnloadHandler() {
                console.log("body onload");
            }

            window.onload = function(e) {
                console.log("window loaded");
            };
        </script>
    </head>

    <body onload="bodyOnloadHandler()">

        Page contents go here.

    </body>
</html> 
```

您将在 Chrome 控制台中看到“加载窗口”（首先出现）和“加载正文”。但是，您只会在 Firefox 和 IE 中看到“body onload”。如果你`window.onload.toString()`在 IE & FF 的控制台运行“”，你会看到：

> “函数加载（事件）{bodyOnloadHandler（）}”

这意味着赋值“window.onload = function(e)...”被覆盖。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2014-06-12T00:21:39.993

`window.onload`是和的`onunload`捷径`document.body.onload``document.body.onunload`

`document.onload`所有 html 标签上的`onload`处理程序似乎都被保留但从未触发

' `onload`'在文档中-> true

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2020-05-11T08:49:48.063

简而言之

*   `window.onload`IE 6-8不[支持](https://caniuse.com/#feat=mdn-api_globaleventhandlers_onload)
*   `document.onload`任何现代浏览器都不支持（从不触发事件）

```
window.onload   = () => console.log('window.onload works');   // fired
document.onload = () => console.log('document.onload works'); // not fired
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-02-25T21:47:20.980

window.onload 但是它们通常是相同的。同样 body.onload 在 IE 中变成了 window.onload。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-05-19T11:31:31.350

然而，Window.onload 是标准的——PS3 中的网络浏览器（基于 Netfront）不支持 window 对象，所以你不能在那里使用它。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2021-11-07T21:49:38.013

`document.load`未定义。那你们在说什么？

带有 的事件`document.addEventListener('load',cbFunc)`，`cbFunc`将永远不会被触发。

# sql-server - 为什么在 T-SQL 中做一个循环这么难

> ID：588050
> 
> 赞同：6
> 
> 时间：2009-02-25T21:47:39.373
> 
> 标签：sql-server, tsql

好的，我知道它可以做到，我经常这样做，但是为什么在 T-SQL 中做一个循环那么困难呢？我可以想到很多我想通过查询结果集解析并做一些没有循环就无法完成的事情的原因，但是设置和执行我的循环的代码超过 20 行。

我敢肯定其他人也有类似的看法，那么为什么我们仍然没有一种简单的方法来执行循环呢？

顺便说一句：我们终于在 SQL2008 中得到了一个 UPSERT（又名 MERGE），所以也许所有的希望都不会丢失。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-25T21:49:25.017

SQL 是一种基于集合的[声明性语言](http://en.wikipedia.org/wiki/Declarative_programming)；不是程序或[命令式语言](http://en.wikipedia.org/wiki/Imperative_programming)。T-SQL 试图跨越两者，但它仍然建立在基本基于集合的范式之上。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-25T21:52:30.157

> 我可以想到很多我想通过查询结果集解析并做一些没有循环就无法完成的事情的原因

对于绝大多数人，我可以向您展示如何在基于集合的操作中执行此操作，或者解释为什么应该在您的客户端代码中而不是在数据库中完成它。需要在 sql 中执行循环非常罕见。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-25T21:50:51.643

T-SQL 并非设计为一种命令式语言。它的设计是声明性的。它的声明性允许优化器分割各种任务并并行运行它们，并以其他方式以最有效的顺序执行操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T21:49:38.247

因为 SQL 是一种基于集合的语言。sql 的强大之处在于根据特定特征在较大的数据组中找到较小的组。为了处理这个任务，循环在很大程度上是不必要的。显然它是为了方便处理某些情况而添加的，但是该语言的预期用途使此功能无关紧要。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T21:53:12.357

几乎所有事情都可以根据设置完成，尝试使用数字表

为什么是 20 行？这就是你所需要的

```
select *,identity(int, 1,1) as Someid into #temp
from sysobjects

declare @id int, @MaxId int
select @id = 1,@MaxId = max(Someid) from #temp

while @id < @MaxId
begin
-- do your stuff here
print @id
set @id =@id + 1
end 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-25T21:53:59.810

这取决于你想在一个循环中做什么。使用 while 循环一点也不难：

```
declare @i int
set @i = 20
while @i>0 begin
... do some stuff
set @i = @i-1
end 
```

它只会在使用游标时变得很麻烦，无论如何都应该避免。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-26T15:17:15.823

您可以尝试使用用户定义的函数来完成大部分工作，而不是采用基于循环的方法。这将保留基于集合的 SQL 语言的意图。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-25T21:51:39.490

SQL 是基于 SET 的系统，而不是过程（循环）系统。通常，在 SQL 中使用循环被认为是不好的做法，因为与基于集合的等效项相比，它们的性能较差。

WHILE 是最常见的循环结构，CURSORS 也可以使用，但是有自己的问题（忘记释放/关闭）

... WHILE 的一个示例（您可能不需要它，但其他人可能需要它）

```
DECLARE @iterator INT
SET @iterator = 0

WHILE @iterator < 20
BEGIN
  SELECT * FROM table WHERE rowKey = @iterator
/*do stuff*/
  @iterator = @iterator + 1
END 
```

真正的问题是“你试图做的事情是什么，根本无法以基于集合的方式完成？”

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-02-25T21:51:39.160

我不是数据库专家，但我相信数据库事务的原子性质会使循环难以实现，因为事务是完整的，或者根本不应该发生。维护状态可能很烦人！

[维基百科关于原子性的文章](http://en.wikipedia.org/wiki/Atomicity)

# asp.net - 单元测试用户登录/注销

> ID：588051
> 
> 赞同：2
> 
> 时间：2009-02-25T21:47:41.247
> 
> 标签：asp.net, unit-testing, asp.net-membership, integration-testing

我对整个单元测试概念非常陌生，所以如果“单元测试”是错误的词，我很抱歉。我认为这实际上可能是一个“集成测试”？

无论如何，我正在使用 asp.net 的会员框架进行登录、注销、更改密码等。但是我做了一些额外的事情，比如更新身份验证票，在注册时向另一个表添加条目，在密码更改时刷新身份验证票， ETC。

为这些类型的案例编写测试的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T05:23:20.963

我看到两个主要选项：

*   如果您有身份验证票的包装器和存储库的接口，则可以有效地对所涉及的逻辑进行单元测试（不确定您如何使用 asp.net 成员框架，但无论如何您都可以将此逻辑移动到一个类您可以进行单元测试）。
    *   使用 watin 或 selenium 进行自动化的 Web 验收测试——这仍然会在您选择的测试框架（mstest、nunit 等）中编写

**更新 1：**我会同时对逻辑和 WAT 进行全面的单元测试，而不是冒烟测试。

# python - 关于python中for循环的问题

> ID：588052
> 
> 赞同：3
> 
> 时间：2009-02-25T21:47:41.883
> 
> 标签：python, for-loop

我想计算毕达哥拉斯三元组（下面的代码）并且我想无限地计算我如何在不使用三个 for 循环的情况下做到这一点？我可以以某种方式使用 for 循环吗？谢谢。

```
import math

def main():
    for x in range (10000, 1000):
        for y in range (10000, 1000):
            for z in range(10000, 1000):
                if x*x == y*y + z*z:
                    print y, z, x
                    print '-'*50

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-25T21:52:06.447

一般来说，你不能。三个变量，三个循环。

但这是一个特例，[没有人](https://stackoverflow.com/questions/588052/a-question-on-for-loops-in-python/588087#588087)指出。你可以用两个循环来解决这个问题。

此外，检查 y、z 和 z、y 也没有意义。

哦，还有`range(10000, 1000) = []`。

```
import math

for x in range(1, 1000):
  for y in range(x, 1000):
      z = math.sqrt(x**2 + y**2)
      if int(z) == z:
        print x, y, int(z)
        print '-'*50 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-25T21:55:26.967

您只需要两个循环 - 只需检查是否`math.sqrt(x*x+y*y)`是整数。如果是，你已经发现了一个毕达哥拉斯三元组。

我是 Python 新手，所以我不知道`range(10000, 1000)`它在哪里开始和停止？我问是因为您可以通过设置`y`start at范围`x`而不是修复它来将运行时间减半，因为加法是可交换的。

**编辑：** [这个答案](https://stackoverflow.com/questions/588052/a-question-on-for-loops-in-python/588067#588067)是我得到的，如果我知道更多的 Python，我会写什么。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-25T21:58:16.790

您可以将代码安排在一个主循环中，如下所示：

```
MIN = 10000
MAX = 10010
a = [MIN, MIN, MIN]
while True:
    print a
    for i in range(len(a)):
        a[i] = a[i] + 1
        if a[i] < MAX:
            break
        a[i] = MIN
        i += 1
    else:
        break 
```

而不是`print a`，您可以在那里进行毕达哥拉斯三元组测试。这将适用于任意数量的维度。

如果您真的想无限地执行此操作，则必须使用不同的迭代技术，例如[对角化](http://en.wikipedia.org/wiki/Diagonal_argument)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-26T01:04:36.060

这是一个使用迭代器的高效版本，它按顺序生成所有这样的三元组。这里的技巧是遍历所有 N 的总和为 N 的 (x,y) 对的集合。

```
导入数学
导入迭代工具

def all_int_pairs():
    “生成所有正整数对”
    对于 itertools.count(1) 中的 n：
        对于 xrange(1,n/2+1) 中的 x：
            产量 x,nx

对于 all_int_pairs() 中的 x,y：
    z = math.sqrt(x**2 + y**2)
    如果 int(z) == z:
        打印 x, y, int(z)
        打印'-'*50

```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-25T22:39:31.387

使用[xrange](http://docs.python.org/library/functions.html#xrange)而不是`range`应该使用更少的内存，特别是如果您想尝试大范围。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-25T22:58:04.103

这与 Can Berk Guder 的答案相同，但作为生成器完成，只是为了好玩。它在这里的嵌套循环并不是真的有用，但它通常可以是一个更清洁的解决方案。你的函数产生结果；您稍后会担心要检索多少。

```
import math

def triplets(limit):
    for x in range(1, limit):
        for y in range(x, limit):
            z = math.sqrt(x**2 + y**2)
            if int(z) == z:
                yield x, y, int(z)

for x, y, z in triplets(10):
    print x, y, z
    print "-" * 50 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-25T22:13:33.600

不是最有效的（Python 将构建一个包含十亿个元组的数组），但这是一个循环：

```
for x, y, z in [(x, y, z) for x in range(10000, 11000) for y in range(10000, 11000) for z in range(10000, 11000)]:
    if x*x == y*y + z*z:
        print y, z, x
        print '-'*50 
```

或者，正如[Christian Witts](https://stackoverflow.com/users/69893/christian-witts)所建议的，

```
for x, y, z in ((x, y, z) for x in xrange(10000, 11000) for y in xrange(10000, 11000) for z in xrange(10000, 11000)):
    if x*x == y*y + z*z:
        print y, z, x
        print '-'*50 
```

（假设 Python >= 2.4）使用[生成器](http://www.python.org/dev/peps/pep-0289/)而不是构建十亿元组数组。

无论哪种方式，您都不应该这样编写代码......您的嵌套循环的初始代码更清晰。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-25T23:13:41.040

使用相同的算法（有关更好的方法，请参阅其他答案），您可以使用 itertools.count 来获得一个永远运行的循环。

```
import itertools

for x in itertools.count(1):
    for y in xrange(1, x):
         for z in xrange(1, y):
              if x*x == y*y + z*z:
                  print x, y, z 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-25T21:55:15.453

除了已经发布的内容外，人们还期望三个集合的三个循环。其他任何事情都可能会变得非常混乱，并且不会提供额外的好处。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-26T02:52:46.863

无穷大至少需要三个循环。要使某些东西变得灵活，需要大量的循环。此示例是[Project Euler 问题 9](http://projecteuler.net/index.php?section=problems&id=9)及更多问题的解决方案。

```
#!/usr/bin/env python

def fcount(start=1):
    n = float(start)
    while True:
        yield n
        n += 1

def find_triples():
    for c in fcount():
        for b in fcount():
            if b > c:
                break
            for a in fcount():
                if a > b:
                    break
                if a ** 2 + b ** 2 == c ** 2:
                    yield (a, b, c)

def triples_by_sum(targetsum):
    for a, b, c in find_triples():
        if a + b + c == targetsum:
            yield a, b, c
        if c > targetsum:
            break

if __name__ == '__main__':
    # Finds multiple triples
    for a, b, c in triples_by_sum(252):
        print a, b, c
    # Finds single triples
    a, b, c = triples_by_sum(1000).next()
    print a, b, c
    # Goes forever
    for a, b, c in find_triples():
        print a, b, c 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-25T23:08:12.237

如果你想数到无穷大..

创建一个从零开始计数且永不停止的生成器函数，并在其上使用 for 循环

```
def inf():
   i = 0
   while True:
     yield i
     i = i + 1

for i in inf():
    print i  # or do whatever you want! 
```

不知道有没有这样的内置函数

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-08-04T07:22:53.783

改用 itertools.product 怎么样？

```
# range is [10000, 1000)
for x, y, z in itertools.product(range(10000, 1000, -1), repeat=3): 
    if x * x == y * y + z * z:
        print(y, z, x) 
```

稍微优化一下：

```
for x, y, z in itertools.product(range(10000, 1000, -1), repeat=3):
    if y >= x or z >= x or x >= (y + z) or z < y:
        continue
    if x * x == y * y + z * z:
        print(y, z, x) 
```

编辑：这里我只是给出一种使用方法，`product`而不是多个 for 循环。你可以在上面的帖子中找到更有效的方法。

# java - Java 中的@interface 默认声明用法

> ID：588056
> 
> 赞同：60
> 
> 时间：2009-02-25T21:48:44.427
> 
> 标签：java, annotations

我刚刚发现了这个功能。

使用“@interface”语法声明接口允许您设置默认值。

```
public @interface HelloWorld { 
     public String sayHello() default "hello world";
} 
```

这对我来说是新事物。假设如何使用该默认值。

我找不到对此的引用，因为在 Java 1.5 中添加“@”之前，www 中充满了 java 接口文档（是在 .5 还是在 .4？）

* * *

**编辑**

感谢您的回答[（我有点接近“注释”，因为我已经使用了标签）：P]

我知道我应该在几年前阅读该文件！！！...让我们看看...

> *许多 API 需要大量的样板代码。为了....*

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-02-25T21:51:45.307

你刚刚写了一个[注释](http://java.sun.com/j2se/1.5.0/docs/guide/language/annotations.html)。

特别是关于`default`语句：这是因为注解和接口不能有构造函数，所以这是为注解属性设置默认值的唯一方法。来自[Java 语言规范](http://java.sun.com/docs/books/jls/third_edition/html/interfaces.html#253974)：

> 注释类型元素可能具有为其指定的默认值。这是通过在其（空）参数列表后面加上关键字`default`和元素的默认值来完成的。
> 
> 在读取注释时动态应用默认值；默认值不会编译到注释中。因此，即使在更改之前编译的类中，更改默认值也会影响注释（假设这些注释缺少默认元素的显式值）。

我注意到[java.lang.annotation](http://java.sun.com/javase/6/docs/api/java/lang/annotation/package-summary.html)中的注释都没有使用默认值。

* * *

**用法：**`@HelloWorld`您有一个带有属性的注释`sayHello`。你可以把它放在这样的类上：

```
@HelloWorld(sayHello="Hi")
public class MyClass {
} 
```

因为你有一个默认值，你可以把

```
@HelloWorld
public class MyClass {
} 
```

（请注意，文档说，“在带有单个元素的注释中，元素应该命名为`value`”；我认为这样做的唯一原因是您可以直接编写`@HelloWorld("Hi")`而不必命名参数。）

如所写，您的注释可用于任何有效的程序元素（包括方法和变量声明）。您可以使用[`@Target`](http://java.sun.com/javase/6/docs/api/java/lang/annotation/Target.html)注释进行更改。

最后，设置[`RetentionPolicy`](http://java.sun.com/javase/6/docs/api/java/lang/annotation/RetentionPolicy.html)允许您决定注释是否应该被编译器丢弃、被 VM 丢弃或始终保留。

* * *

两个可能也很有趣的包：[javax.annotation](http://java.sun.com/javase/6/docs/api/javax/annotation/package-summary.html)和[javax.annotation.processing](http://java.sun.com/javase/6/docs/api/javax/annotation/processing/package-summary.html)。这里是一个使用注解处理进行源代码分析的例子[。](http://today.java.net/pub/a/today/2008/04/10/source-code-analysis-using-java-6-compiler-apis.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-25T21:53:01.577

那是您声明的[注释不是接口。](http://java.sun.com/j2se/1.5.0/docs/guide/language/annotations.html)它是在 Java 1.5 中添加的。

# sql - 加入整数与加入字符（或 varchars）

> ID：588059
> 
> 赞同：7
> 
> 时间：2009-02-25T21:50:40.193
> 
> 标签：sql, join

在 SQL 中，在 char（或 varchar）值上加入表，而不是在整数值上加入表，是否存在任何性能缺陷？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T21:58:54.527

加入 char 或 var char 通常会产生开销，而不是加入 int。在比较字符时，我知道两个因素：
- 必须考虑排序规则
- 字符字段有更多要比较的数据*

*（每个字符由 8 位表示，因此 10 个字符的值是 80 位长，而 int 是 32 位）

*（如果使用 NCHAR 或 NVARCHAR，则为每个字符 16 位）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T22:09:03.707

存在与连接列大小相关的性能*注意事项。*整数是 4 字节宽 - 因此任何大于 4 字节的 char 值都需要更多的磁盘 I/O、缓存空间等。显然，char(5) 不会有太大影响，但 char(4000) 会非常浪费. 如果您使用 unicode 类型，则将字符大小加倍。

通常这个问题出现在自然键和代理键的上下文中。在那个论点中，数据类型的大小并不是唯一的因素——因为您通常可以避免使用自然 (char) 键进行连接。

当然，任何一个都不太可能成为您的应用程序的瓶颈 - 所以设计时可以不受惩罚（至少在这个领域）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T21:54:26.360

不，没有（在 Oracle 中）。可以产生影响的是：
- 如果您的连接条件中的数据类型不同（隐式转换可能会降低性能）。因此，将 char 加入 varchar 可能很糟糕。
- 如果一个字段有索引，而另一个没有。
- 如果一列中的数据比另一列中的数据长得多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T21:58:09.147

char 或 varchar 将根据您的字符集存储为 ASCII 或 unicode。一个 int 将被存储为一些打包的形式。如果您采用 int 形式的数字，它将小于字符（字符串）形式的相同数字。存储为数字类型总是比存储为字符更高效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T21:56:09.213

不，只要您加入的表之间的数据类型相同，就可以了

# multithreading - libspe 与 libspe2？有什么不同？

> ID：588061
> 
> 赞同：1
> 
> 时间：2009-02-25T21:51:01.020
> 
> 标签：multithreading, sdk, cell, ps3

我一直在使用 PS3 中的 Cell 处理器进行一些实验，但我遇到了一个问题。似乎有两个版本的主 SPE 管理库，libspe 和 libspe2。它们之间有什么区别？据我所知，主要区别在于，在 libspe 中他们推出了自己的线程代码，而在 libspe2 中，您必须将 libspe 与 pthreads 库集成以实现多线程。有什么理由说一个比另一个好？两者之间获得/失去/改变了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T07:24:54.680

好的，所以看起来 libspe2 是要走的路。我在上面提到的线程几乎是主要区别，libspe2 提供了更灵活的线程模型。此外，从 SDK 2.1 开始不推荐使用 libspe，而 3.1 是当前版本，因此使用 libspe 启动任何新项目可能不是一个好主意。

IBM 站点上有一篇很好的文章，其中包含[示例](http://www.ibm.com/developerworks/library/pa-libspe2/)。

# social-networking - 谷歌纵横 API

> ID：588062
> 
> 赞同：6
> 
> 时间：2009-02-25T21:51:08.273
> 
> 标签：social-networking, google-latitude

谷歌纵横目前没有提供 API。

有谁知道未来提供的计划？

如果是这样，您能想到哪些适用于该技术的社交网络应用程序？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-07T22:38:46.550

现在有一个用于谷歌纵横的（原始）API；查看底部的链接

[http://www.google.com/latitude/apps/badge](http://www.google.com/latitude/apps/badge)

您可以检索为您提供（以 JSON 格式）指定用户的位置（纬度和经度）的 URL。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-05-19T21:29:28.510

Latitude API 今天刚刚发布。这是链接[http://code.google.com/apis/latitude/](http://code.google.com/apis/latitude/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-25T23:45:24.520

我还不知道任何计划，但如果 Google 不打算将 Latitude 带向类似于[Yahoo 的 Fire Eagle](http://fireeagle.yahoo.net/)提供的[支持 OAuth 的 API](http://fireeagle.yahoo.net/developer/documentation)的方向，我会感到非常惊讶。

已经有[几十个基于 Fire Eagle 构建的优秀应用程序](http://fireeagle.yahoo.net/gallery/all)可能会在 Latitude 上复制。理想情况下，Latitude 和 Fire Eagle 可以同意使用相同的协议，至少对于更新和位置查询等最常见的任务——这样，客户端应用程序可以编写为使用其中一个或两者，用户可以选择在哪里他们想存储他们的位置数据。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-12T08:54:18.770

[Google Geolocation](http://code.google.com/apis/gears/api%5Fgeolocation.html) API最近[发布了](http://radar.oreilly.com/2009/05/googles-sneaky-launch-of-latitudes-location-sharing-api.html)。

# visual-studio - 颠覆应该忽略哪些 Visual Studio 文件以最大程度地减少冲突？

> ID：588077
> 
> 赞同：73
> 
> 时间：2009-02-25T21:53:50.623
> 
> 标签：visual-studio, svn, version-control, tortoisesvn, svnignore

我支持许多使用 Subversion 对其工作进行版本控制的 .Net 开发人员，但我们遇到了许多问题，这些问题似乎与 Visual Studio 用于管理项目、进行调试等的附加文件有关。具体来说，这些文件似乎正在引起冲突，因为它们已经在 repo 中。我知道如何将它们弄出来以及如何处理它们，但我首先需要知道“它们”是什么。

那么，Subversion 可以忽略哪些文件/目录，为什么可以忽略它们？（又名。这些文件有什么作用？）

这是一个大型的、相当无组织的 ASP.Net 站点，并且通过该站点部署该站点。svn 更新，因此 IIS 需要在文件更改时动态编译（我认为就是这样）站点所需的文件需要留在 repo 中。

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2009-02-25T21:57:51.610

*   bin 和 obj 目录
*   *.user 文件 (MyProject.csproj.user)
*   *.suo 文件

此外，如果您使用的是 Visual Studio 2015，请使用 .vs 目录。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-02-25T22:28:38.447

我对这种全局忽略模式很幸运：

```
*bin *obj *suo *.user *.tmp *.TMP
*resharper* *Resharper* *ReSharper* *.Load *.gpState
拇指.db *.~m2
```

我正在运行 Resharper 插件，所以你可以忽略它。“.~m2”用于我的数据建模器创建的临时文件。

更新：感谢您的投票。我最近添加了 Mac、Dreamweaver、Python 和一些其他应该忽略的 Visual Studio 文件。

```
*.o *.lo *.la *.al .libs *.so *.so.[0-9]* *.a *.pyc *.pyo *.rej *~ #*# .#* .*.swp
*[Bb]in *obj *suo *resharp* *.user *.tmp *.TMP *Resharper*
*ReSharper* *.Load *.gpState *.NoLoad  *.~m2 *.dbmdl _notes *.cache
[Tt]est[Rr]esult [Bb]uild[Ll]og.* *.[Pp]ublish.xml *.[Cc]ache [Tt]humbs.db lint.db
*.docstates .apdisk [Ll]ogs .DS_Store *.bak *.vs 
```

别的，如果有人不小心签入了一个应该被忽略的文件夹或文件，那么你需要在 SVN 再次开始忽略它们之前从存储库中手动删除这些文件。这是因为已经在 repo 中的文件将覆盖任何忽略设置。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-11-08T21:19:22.283

旧线程，但我想补充一点，您可以使用来自 GitHub 的 gitignore 示例（在[此处](https://github.com/github/gitignore/blob/master/VisualStudio.gitignore)找到）作为一个很好的起点。

```
## Ignore Visual Studio temporary files, build results, and
## files generated by popular Visual Studio add-ons.
##
## Get latest from https://github.com/github/gitignore/blob/master/VisualStudio.gitignore

# User-specific files
*.suo
*.user
*.userosscache
*.sln.docstates
*.vcxproj.filters

# User-specific files (MonoDevelop/Xamarin Studio)
*.userprefs

# Build results
[Dd]ebug/
[Dd]ebugPublic/
[Rr]elease/
[Rr]eleases/
x64/
x86/
bld/
[Bb]in/
[Oo]bj/
[Ll]og/

# Visual Studio 2015 cache/options directory
.vs/
# Uncomment if you have tasks that create the project's static files in wwwroot
#wwwroot/

# MSTest test Results
[Tt]est[Rr]esult*/
[Bb]uild[Ll]og.*

# NUNIT
*.VisualState.xml
TestResult.xml

# Build Results of an ATL Project
[Dd]ebugPS/
[Rr]eleasePS/
dlldata.c

# DNX
project.lock.json
project.fragment.lock.json
artifacts/
**/Properties/launchSettings.json

*_i.c
*_p.c
*_i.h
*.ilk
*.meta
*.obj
*.pch
*.pdb
*.pgc
*.pgd
*.rsp
*.sbr
*.tlb
*.tli
*.tlh
*.tmp
*.tmp_proj
*.log
*.vspscc
*.vssscc
.builds
*.pidb
*.svclog
*.scc

# Chutzpah Test files
_Chutzpah*

# Visual C++ cache files
ipch/
*.aps
*.ncb
*.opendb
*.opensdf
*.sdf
*.cachefile
*.VC.db
*.VC.VC.opendb

# Visual Studio profiler
*.psess
*.vsp
*.vspx
*.sap

# TFS 2012 Local Workspace
$tf/

# Guidance Automation Toolkit
*.gpState

# ReSharper is a .NET coding add-in
_ReSharper*/
*.[Rr]e[Ss]harper
*.DotSettings.user

# JustCode is a .NET coding add-in
.JustCode

# TeamCity is a build add-in
_TeamCity*

# DotCover is a Code Coverage Tool
*.dotCover

# Visual Studio code coverage results
*.coverage
*.coveragexml

# NCrunch
_NCrunch_*
.*crunch*.local.xml
nCrunchTemp_*

# MightyMoose
*.mm.*
AutoTest.Net/

# Web workbench (sass)
.sass-cache/

# Installshield output folder
[Ee]xpress/

# DocProject is a documentation generator add-in
DocProject/buildhelp/
DocProject/Help/*.HxT
DocProject/Help/*.HxC
DocProject/Help/*.hhc
DocProject/Help/*.hhk
DocProject/Help/*.hhp
DocProject/Help/Html2
DocProject/Help/html

# Click-Once directory
publish/

# Publish Web Output
*.[Pp]ublish.xml
*.azurePubxml
# TODO: Comment the next line if you want to checkin your web deploy settings
# but database connection strings (with potential passwords) will be unencrypted
*.pubxml
*.publishproj

# Microsoft Azure Web App publish settings. Comment the next line if you want to
# checkin your Azure Web App publish settings, but sensitive information contained
# in these scripts will be unencrypted
PublishScripts/

# NuGet Packages
*.nupkg
# The packages folder can be ignored because of Package Restore
**/packages/*
# except build/, which is used as an MSBuild target.
!**/packages/build/
# Uncomment if necessary however generally it will be regenerated when needed
#!**/packages/repositories.config
# NuGet v3's project.json files produces more ignoreable files
*.nuget.props
*.nuget.targets

# Microsoft Azure Build Output
csx/
*.build.csdef

# Microsoft Azure Emulator
ecf/
rcf/

# Windows Store app package directories and files
AppPackages/
BundleArtifacts/
Package.StoreAssociation.xml
_pkginfo.txt

# Visual Studio cache files
# files ending in .cache can be ignored
*.[Cc]ache
# but keep track of directories ending in .cache
!*.[Cc]ache/

# Others
ClientBin/
~$*
*~
*.dbmdl
*.dbproj.schemaview
*.jfm
*.pfx
*.publishsettings
node_modules/
orleans.codegen.cs

# Since there are multiple workflows, uncomment next line to ignore bower_components
# (https://github.com/github/gitignore/pull/1529#issuecomment-104372622)
#bower_components/

# RIA/Silverlight projects
Generated_Code/

# Backup & report files from converting an old project file
# to a newer Visual Studio version. Backup files are not needed,
# because we have git ;-)
_UpgradeReport_Files/
Backup*/
UpgradeLog*.XML
UpgradeLog*.htm

# SQL Server files
*.mdf
*.ldf

# Business Intelligence projects
*.rdl.data
*.bim.layout
*.bim_*.settings

# Microsoft Fakes
FakesAssemblies/

# GhostDoc plugin setting file
*.GhostDoc.xml

# Node.js Tools for Visual Studio
.ntvs_analysis.dat

# Visual Studio 6 build log
*.plg

# Visual Studio 6 workspace options file
*.opt

# Visual Studio 6 auto-generated workspace file (contains which files were open etc.)
*.vbw

# Visual Studio LightSwitch build output
**/*.HTMLClient/GeneratedArtifacts
**/*.DesktopClient/GeneratedArtifacts
**/*.DesktopClient/ModelManifest.xml
**/*.Server/GeneratedArtifacts
**/*.Server/ModelManifest.xml
_Pvt_Extensions

# Paket dependency manager
.paket/paket.exe
paket-files/

# FAKE - F# Make
.fake/

# JetBrains Rider
.idea/
*.sln.iml

# CodeRush
.cr/

# Python Tools for Visual Studio (PTVS)
__pycache__/
*.pyc

# Cake - Uncomment if you are using it
# tools/ 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-25T22:06:33.853

*   *.bin
*   *.obj
*   *。可执行程序
*   *.dll
*   *.pch
*   *。用户
*   *.suo
*   *.tlb
*   TestResults（VSTS 单元测试目录）

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-25T21:59:05.803

*   'bin' 目录是一个好的开始（正如@Kevin 所说）。
*   你最好也忽略'obj'目录。
*   *.suo 和 *.user 最好不要在源代码控制之外。
*   *.VisualState.xml 也将是个人选择。
*   TestResults.xml（如果您使用的是 NUnit）

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-25T23:56:52.900

我认为更好的问题是*“**我应该向 Subversion 添加哪些文件？** ”*

AnkhSVN 2.0 Subversion 集成向您解决方案中的所有项目提出了这个问题。（这个问题是 SCC 规范的关键部分之一。）然后它只会建议添加这些文件。

*作为用户，您可以手动添加其他文件（或将建议的一些文件标记为忽略），但这种行为使得做正确的事情*变得非常容易。

大多数其他颠覆客户没有与真正了解应该添加和不应该添加什么的系统交谈的奢侈。（例如，TortoiseSVN 等外部客户端及其前端可以根据文件扩展名进行猜测）。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-26T00:05:00.150

这是我的 TortoiseSVN 全局忽略：

```
*.suo *.resharper *.sln bin obj *.user *.suo Debug Release *.pdb test.* _ReSharper*.* *.scc *.vssscc *.vspscc 
```

从 Microsoft Visual SourceSafe 转换时的最后 3 个帮助。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-25T21:57:40.457

[AnkhSVN](http://ankhsvn.net)在仅签入项目所需的文件方面做得很好。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-12-18T14:33:31.833

我也不会签入 .SDF 文件。它很大，如果丢失，Visual Studio 会重新创建它。据我所知，它是用于 Intellisense 的数据库。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-25T21:54:47.547

我可能会在 bin 目录中说任何内容。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-25T22:10:04.997

除了上面人们建议的那些之外，我经常不得不忽略***.cache**，因为出于某种原因，我不知道 Resharper 喜欢将它的 .cache 文件放在与我处理的代码相同的文件夹中。另外，我认为还没有人提到 *.pdb。

# asp.net - 是否有适用于 ASP.NET 的 JAWS 友好型日期选择器？

> ID：588080
> 
> 赞同：4
> 
> 时间：2009-02-25T21:54:39.247
> 
> 标签：asp.net, controls, accessibility, jaws-screen-reader

有谁知道与[JAWS](http://www.freedomscientific.com/products/fs/jaws-product-page.asp)配合得很好的 ASP.NET 日期选择器控件？除此之外，您是否有任何提示可以使 JAWS 用户更容易使用现有的 ASP.NET 日期选择器控件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T22:24:53.963

我怀疑您能否获得可访问的 ASP.NET 控件。如果我是你，我会研究控件的客户端版本。我在网上找到了这个基于 Javascript 的[可访问日期选择器日历。](http://www.websemantics.co.uk/tutorials/accessible_date_picker_calendar/)您可能需要进行一些调整才能使其在您的应用程序中运行。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-17T15:29:19.960

DateTimePicker 相当容易访问。尽管当用户单击下拉菜单时会弹出日历，但仍可以完全访问月/日/年，而无需使用下拉菜单中的“您选择”功能。您会注意到，如果您将焦点放在 DateTimePicker 下拉列表中，您将首先关注月份、下一个选项卡上的日期和下一个年份。我们的盲人用户可以使用上下箭头键更改每个值，使用左右箭头键在月/日/年之间切换以设置日期，而从不实际处理您选择的功能。

我发现的一个问题是 DateTimePicker 没有作用（至少在 MS VS 2008 中）。我想出的一个解决方法是向 DateTimePicker AccessibilityName/Description 添加说明。

希望这可以帮助！

# html - HTML/CSS 中的进度条

> ID：588083
> 
> 赞同：5
> 
> 时间：2009-02-25T21:55:15.190
> 
> 标签：html, css, progress-bar

```
 dd { 
    /*position: relative; /* IE is dumb */
    display: block;                 
    float: left;     
    width: 500px; 
    height: 16px; 
    margin: 0 0 2px; 
    background: url("white3.gif"); 
 }

 dd div.blue { 
    /*position: relative; */
    background: url("blue.gif"); 
    height: 16px; 
    width: 75%; 
    text-align:right; 
    display:block;
 } 
```

HTML：

```
<dd>
    <div class="blue" style="width:35%;"> 
</dd> 
```

这将创建一个白色条并用蓝色 35% 填充它。

现在我想用两个不同的值填充相同的进度条。例如，如果值 A 为 30%，值 B 为 40%，则将填充 70% 的条形图，但可以通过颜色差异看出每个条形的百分比。值 A 和 B 可以在条形图上以任何顺序出现，只要我能分辨出有两种不同的事物并“查看”每个事物占用了多少。

有什么建议么？

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-25T22:32:47.313

你在寻找这样的东西吗？

CSS：

```
div.dd { 
   /*position: relative; /* IE is dumb */
    display: block;                 
    float: left;     
    width: 500px; 
    height: 16px; 
    margin: 0 0 2px; 
    background: #fff; 
}

div.dd div.blue { 
    /*position: relative; */
    background: #00f; 
    height: 16px; 
    width: 75%; 
    text-align:right; 
    display:block;
    float: left;
}
div.dd div.red { 
    /*position: relative; */
    background: #f00; 
    height: 16px; 
    width: 75%; 
    text-align:right; 
    display:block;
    float: left;
} 
```

HTML：

```
<div class="dd">
    <div class="blue" style="width:35%;"></div>
    <div class="red" style="width:10%;"></div>
</div> 
```

我不确定你为什么使用 dd 标签（对我来说，这个标签会导致 div 呈现在 dd 标签下面，而不是在里面）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T21:57:48.507

我建议在其上放置另一个条并根据需要向左/向右移动。

如果条形图不应该拉伸视口的长度，则可以将它们放在具有溢出的 div 中：隐藏以保持错觉完好无损。

**编辑：**

我只是想明白为什么我想那样做而不是按照你的开始。当我之前做类似的事情时，它使用的是图像，改变宽度当然会破坏覆盖的图像。

仅使用纯色，我相信您可以仅使用尺寸就可以逃脱。但我仍然会使用 CSS 一层一层地叠加。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-12T17:16:00.327

```
<div class="progressbar">
   <div class="inner1" style="width: 30%; background-color: blue;"><b>Value A</b></div>
   <div class="inner2" style="width: 40%; background-color: red;"><b>Value B</b></div>
</div> 
```

然后是CSS：

```
.progressbar {
   background-color: #1e1e1e;
   color: white;
   height: 25px;
   width: 115px;
}
.inner1, .inner2 {
   height: 100%;
   /* Change width with javascript */
} 
```

如果您只想要进度条中的一个值，这里有一个[教程](http://meedouec.bitballoon.com/progress/v1.0.1/)。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-18T16:27:30.877

```
<div style="height: 5px; background-color: green; width: 100%;">
    <div id="progress_bar" style="height: 5px; background-color: red; width: 10%;"></div>
</div> 
```

在那之后：

```
$('#progress_bar').css('width', '30%'); 
```

# internet-explorer - 为 IE8 指定每页的兼容模式

> ID：588085
> 
> 赞同：1
> 
> 时间：2009-02-25T21:55:15.720
> 
> 标签：internet-explorer, browser

我对仅在 IE8 中出现的 Telerik RadWindow 有一个奇怪的问题。当我强制浏览器使用文档模式：IE7 标准时，它工作正常。我试图在每页的基础上为我的站点中的一页指定 IE7 兼容模式。使用

```
<head>
   <!-- Mimic Internet Explorer 7 -->
      <title>My Web Page</title>
      <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />
</head> 
```

根据 MSDN 文章，这应该可以，但它似乎对我不起作用。除了在整个站点中强制使用自定义 HTTP 响应标头之外的任何其他替代方案。我只需要修复这一页？

[http://msdn.microsoft.com/en-us/library/cc817574.aspx](http://msdn.microsoft.com/en-us/library/cc817574.aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T19:40:50.573

我正要发布一条关于此的消息，因为它似乎对我也没有任何作用。我刚刚升级到 IE8，我的 Web 应用程序中唯一出现问题的是标准的 Microsoft Report Viewer 控件。颇具讽刺意味的是 :-) 我原以为 Infragsitic NetAdvantage 控件会中断，因为它们在 CSS 和 JavaScript 上相当繁重，但它们看起来还不错。

因此，我将`<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /`> 行添加到我的报表查看器页面，但它似乎没有做任何事情。除非我将整个站点切换到兼容模式，否则它仍然会呈现错误。

干杯，罗布。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-12T14:54:12.677

尝试：

```
<meta http-equiv="X-UA-Compatible" content="IE=7" /> 
```

还需要确保它不在头部的其他标签下。

# php - 这是一种合理的缓存方法吗？

> ID：588088
> 
> 赞同：0
> 
> 时间：2009-02-25T21:55:50.697
> 
> 标签：php, caching, latex, content-management-system

作为CMS的一部分，我正在使用PHP将LaTeX渲染为png，我需要某种简单的缓存机制，因为服务器需要大约2秒来渲染png。我获取原始 TeX 并通过 md5 函数运行它，然后将散列与当前时间戳一起插入到数据库中，并使用 <hash>.png 作为文件名。每次访问图像时，时间戳都会更新。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T22:03:35.030

对于这种情况，我更喜欢使用磁盘上的临时目录。

根据要求：

```
if the file doesn't exist
    render it to the file
fpassthru() the file from disk 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T22:03:13.377

这听起来不错。如果您可以将 .png 的名称更改为数据库 ID 甚至哈希本身，以便图像也可以缓存在客户端。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T22:01:58.480

嗯，我认为这是一个很好的方法，但您可能希望在散列之前对 LaTeX 进行一些额外的处理。否则，空格的变化（可能还有评论和其他一些东西，取决于你的输入法）会导致不同的哈希值。

另外，更新时间戳的目的是什么？作为删除长时间未访问的 PNG 的批处理方法的一部分？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T22:06:54.163

如果 .png 在渲染后可能会发生变化，我想你也应该在 .png 更新时使用某种观察来解释这一点（检查线程，设置方法来更新最后修改的键，或其他东西： ) )

# safari - 在 Safari 中隐藏 textarea 调整大小句柄

> ID：588089
> 
> 赞同：103
> 
> 时间：2009-02-25T21:55:56.937
> 
> 标签：safari, webkit, css

我在我的应用程序中使用 textarea 组件，并动态控制它们的高度。当用户键入时，只要有足够的文本，高度就会增加。这在 IE、Firefox 和 Safari 上运行良好。

但是，在 Safari 中，右下角有一个“手柄”工具，允许用户通过单击和拖动来调整文本区域的大小。我还注意到 stackoverflow Ask a Question 页面中 textarea 的这个问题。该工具令人困惑，基本上会妨碍您。

那么，有没有办法隐藏这个调整大小的句柄？

（我不确定“句柄”是否是正确的词，但我想不出更好的词。）

* * *

## 回答 #1

> 赞同：191
> 
> 时间：2009-02-25T21:59:35.350

您可以使用 CSS 覆盖调整大小行为：

```
textarea
{
   resize: none;
} 
```

或者只是简单地

```
<textarea style="resize: none;">TEXT TEXT TEXT</textarea> 
```

有效属性为：both、horizo​​ntal、vertical、none

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T07:22:42.267

使用以下 CSS 规则为所有`TextArea`元素禁用此行为：

```
textarea {
    resize: none;
} 
```

如果您想为某些（但不是全部）`TextArea`元素禁用它，您有几个选项（感谢[此页面](http://www.electrictoolbox.com/disable-textarea-resizing-safari-chrome/)）。

要禁用属性设置为（即， ）`TextArea`的特定：`name``foo``<TextArea name="foo"></TextArea>`

```
textarea[name=foo] {
    resize: none;
} 
```

或者，使用 ID（即`<TextArea id="foo"></TextArea>`）：

```
#foo {
    resize: none;
} 
```

请注意，这仅与基于 WebKit 的浏览器（即 Safari 和 Chrome）相关，它们将调整大小句柄添加到`TextArea`控件。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2010-07-27T14:40:24.963

safari max-height max-width 机会也适用于 firefox 4.0 (b3pre)。顺便说一句，这里的好例子：[http ://www.alanedwardes.com/posts/safari-and-resizable-textboxes/](http://www.alanedwardes.com/posts/safari-and-resizable-textboxes/)

# methodology - 4D的开发方法论

> ID：588092
> 
> 赞同：2
> 
> 时间：2009-02-25T21:56:28.773
> 
> 标签：methodology

有人听说过“定义设计开发部署”吗？只是好奇是否有人知道或使用这种开发方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T22:06:01.357

是的，但对我来说这更像是一种营销方式。这是打包软件开发步骤的一种可爱方式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T22:07:48.280

它被称为“瀑布”方法，因此有点过时（90 年代初）。

# delphi - 将程序称为“延迟”的最佳方式是什么？

> ID：588102
> 
> 赞同：2
> 
> 时间：2009-02-25T21:58:36.117
> 
> 标签：delphi

有两个过程 A1 和 A2，它们都在其代码中调用函数 B：

```
function B: boolean;
begin
  // do other stuff
end;

procedure A1;
begin
  // do stuff
  if b then
    ...
  // do stuff
end;

procedure A2;
begin
  // do stuff
  if b then
    A1; // <- how to call A1 "delayed"?
  // do stuff
end; 
```

如果 A2 中的条件为真，则必须调用过程 A1，但这会在 A2 仍在运行时发生，这是我不希望的。

应该发生的是：如果 A2 中的条件为真，则 A2 应该完成，离开 A2 后应该调用过程 A1。

一个丑陋的解决方案是设置一个计时器，在确保 A2 完成的延迟后调用 A1。

但一定有更好的方法，对吧？

**编辑**：在我的情况下，A1 和 A2 是事件，所以它们不是由代码调用的，我不能在 A2 完成后从调用过程中调用 A1。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-25T22:24:47.943

鉴于您的限制，听起来您想在返回之前将`PostMessage`其作为最后一件事`A2`。`PostMessage`应该设置参数以便触发事件`A1`。唯一需要担心的是竞争条件，但我不确定这是否会成为 Windows 消息队列的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T09:32:46.543

我过去通过创建延迟方法调用单元来处理类似的问题。如果您只需要在一个地方使用它可能有点矫枉过正，但拥有它是一件有用的事情。

就我而言，我会写

```
procedure A2;
begin
  // do stuff
  if b then
    DelayedCall('A1' {identifier}, A1 {event}, 0 {ms delay}, [] {various function flags}); 
  // do stuff
end; 
```

内部 DelayedCall 将 A1 置于有序列表中（按到期时间排序）。计时器轮询列表（以可变频率取决于第一个事件的到期时间）并运行任何到期事件。

编写这不是一个非常复杂的函数，但它可能非常有用。

编辑：在提供的示例中，使用 PostMessage 会运行得更快。DelayedCall 直到 A2 完成后才会运行（除非 A2 在其中有 ProcessMessages 或 Sleep 调用），但它可能不会在 A2 完成后立即运行，具体取决于其他情况。但是，我自己经常在类似的场景中使用 DelayedCall。

Neither PostMessage or DelayedCall will happen immediately, they both need to wait till the message loop is checked

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T22:32:31.433

您可以使用布尔标志：如果 A2 正在运行，则设置“A1_should_run”，并检查 A2 末尾的标志。这个解决方案很简单，但有点难看，因为它给代码添加了非局部性，并且不能很好地适用于更复杂的情况。

您可以使用调用队列：A1 和 A2 始终通过被放置在队列中来运行，在这种情况下，您只需将 A1 加入队列即可。对于您的情况，此解决方案并不简单，但非常适用于更复杂的情况。

# java - 使用 Java 数据源是一项代价高昂的考验吗？

> ID：588103
> 
> 赞同：3
> 
> 时间：2009-02-25T21:58:53.370
> 
> 标签：java, database, performance, jdbc, connection-pooling

我的 Java（非 Web）应用程序可能必须创建大约 200 个**不同**数据源的连接池。是的，所有 200 个都连接到不同的数据库。*池中没有*200 个连接。

以下是一些困扰我的问题..

1) 我应该预见到主要的（性能等）问题吗？

2) 是否有任何可用的非商业 Java 工具可用。

3）我试图搜索网络，但并没有真正找到一个直接的答案。有没有人在这方面有指向网络上一些好的资源的链接？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T22:12:44.383

如果您正在编写桌面/控制台应用程序，您可以使用[Commons DBCP](http://commons.apache.org/dbcp/)来管理您的数据源和连接池。您可以在此处添加 Spring 以帮助管理数据源的配置。

如果你正在编写一个 webapp。您可以使用您的 servlet 容器来设置和管理数据源（通过 JNDI 检索它们）。

你的问题很模糊。我仍然不明白您需要所有这些数据源的上下文。

我的猜测是您需要在池中具有大量连接的一些数据源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T22:09:15.547

您是否需要同时访问所有数据源？如果没有，我将直接使用连接，而不需要在其中一个连接时进行池化，或者将连接池保守地配置为 0 作为最小打开连接。我要担心的唯一资源是打开的套接字。如果您保留大量打开的套接字，您可能会遇到操作系统限制甚至 TCP 限制。请注意，某些版本的 windows 限制每秒可以建立的新 tcp 套接字的数量。因此，当在 Windows 98 上运行您的应用程序同时建立大量连接时，应用程序的启动可能会变慢或在极端情况下可能会失败。毕竟我不会真正担心拥有 200 个数据源，除非它们有数千个。

# javascript - 完成 IE 失败 - jquery

> ID：588109
> 
> 赞同：1
> 
> 时间：2009-02-25T22:00:27.487
> 
> 标签：javascript, jquery, debugging, internet-explorer

我已经为此工作了几天，并且在让我的脚本在 IE 中工作方面取得了一些（尽管很少）进展。

FF 和 Chrome 完美无瑕。运行我的脚本时，IE7 和 8 都完全关闭。我得到的唯一错误是当我第一次加载页面时，我收到一条警告，指出它们是从谷歌加载的主 jquery.min.js 页面中的错误。我尝试了一些不同的 jquery.js，但它们都显示相同的错误。

我已经在这个地址 [http://ec2-75-101-196-181.compute-1.amazonaws.com/v2/](http://ec2-75-101-196-181.compute-1.amazonaws.com/v2/)

该错误在加载页面时启动，但要使其真正失败，请在搜索栏中输入一个位置，然后选择一个结果。

我已经尝试提取导致此问题的部分脚本（jQuery('li.show').click），甚至只用一个警报替换了整个函数（？），它仍然关闭了 IE。

你如何调试这样的东西？我正在使用调试栏和微软脚本调试器，但由于它们都显示主 jquery 文件中的错误，所以它不是很有帮助（我很确定 jquery 不是问题，它必须在我的脚本中）。

我完全迷路了。请帮忙...

更新 - - - - - - - - - - - - - - - - - - - - - - - - - --------------------------

我已经设法将其归结为 swfObject 的问题，并专门加载了 flash vars。

不幸的是还没有解决方案。播放器 URL 加载正常，

```
http://lads.myspace.com/videos/Main.swf

```

但是添加 flashvars 是完全杀死 IE flashvars 的原因

```
id=-1&pcc=en-US&cc=en-CA&el=http%3a%2f%2fwww.myspace.com%2findex.cfm%3ffuseaction%3duser.viewProfile%26vanity%3djuice&pertid=9415ef45e1d80df9d41f9d2094568ac2&pguid=6817783a34cf42dbbbf5a74054dba4ec&hash=MIGnBgorBgEEAYI3WAOCoIGYMIGVBgorBgEEAYI3WAMBoIGGMIGDAgMCAAECAmYDAgIAwAQI0PAkEoOZrEUEEC0WOKKPFRQTanAktS3u%252fiMEWNtTHsoXrencYJAt%252bXk1hSehTR7tN1iwI1a8vwmEFWmKkRWKkMUgXe2o9o3%252b2B5uxACclT4vkj9X2Q2CXR1cXjCq %252fNCONteEOFyIySkfGEfcZxZD%252frd8gOA%253d&skinid=17&skin=http%3a%2f%2flads.myspacecdn.com%2fvideos%2fartistInternational.xml&isus=false&on=1&afsongs=4&ayt=15&plid=18968&profid=96041003&ptype=4&artid=4791838&pmix=False&shuffle=False&ap=1&t=1&adp =1&mute=false&mt=audio&aftime=300&albid=0&songid=0&amix=false&sindex=-1&sseed=0&nopops=false&ovasin=false&nopomp=false&primarycolor=transparent&secondarycolor=transparent&logerr=false&stime=

```

我用于 swfObject 的代码是

```
参数={
                            flashvars: 变量
                            };
                    flashvars={};

                swfobject.embedSWF(swfUrl, 'player', '360', '240', '9.0', flashvars, params);

```

第二次更新------------------------------------------------ --------------

为了解决这个问题，我只是将 swf 插入到 IE 中的 iframe 中。以这种方式加载没有错误，但在 swfObject 中完成这一切会很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T22:07:32.757

你试过[DebugBar](http://www.debugbar.com/?langage=en)吗？也可以查看[IE 中的 Debugging js 在](https://stackoverflow.com/questions/170164/debugging-javascript-in-ie)SO 上的帖子。

我不确定你是否看到我的评论 - 摆脱日历弹出窗口，看看它是否解决了问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T22:17:00.537

最简单的方法是...

1.  从 Office 安装脚本编辑器
2.  在 Internet 选项/高级中启用调试
3.  Internet Explorer → 查看/脚本调试器/打开

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T22:18:14.807

谷歌浏览器也报错，先看看？

# linux - Linux终端输出重定向

> ID：588144
> 
> 赞同：3
> 
> 时间：2009-02-25T22:09:57.993
> 
> 标签：linux, bash, redirect

我想将 bash 脚本的输出重定向到文件。

脚本是：

```
#!/bin/bash
echo "recursive c"
for ((i=0;i<=20;i+=1)); do
time ./recursive
done 
```

但如果我这样运行它：

```
script.sh >> temp.txt 
```

只有 ./recursive 的输出会被捕获到文件中。

我想在文件中捕获 time 命令的输出。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-25T22:14:21.320

重定向`STDERR`到`STDOUT`：

```
script.sh >> temp.txt  2>&1 
```

或者如果使用`bash`4.0：

```
$ script.sh &>> temp.txt 
```

（感谢第二个表格去评论者 ehemient。我无法验证，因为我之前有一个`bash`。）

* * *

我的测试令人惊讶：

```
$ time sleep 1 > /dev/null 2>&1

real    0m1.036s
user    0m0.002s
sys     0m0.032s 
```

问题是重定向被包含在要计时的命令中。这是此测试的解决方案：

```
$ (time sleep 1) > /dev/null 2>&1 
```

我认为这不是您问题的一部分，但似乎值得一提。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-03-16T18:24:13.820

我更喜欢 &>> 方法，但这也是一个解决方案：

```
$ script.sh 2>&1 |tee -a temp.txt 
```

# c# - 引用所需的重载泛型方法

> ID：588149
> 
> 赞同：14
> 
> 时间：2009-02-25T22:12:06.147
> 
> 标签：c#, reflection, generics, methodinfo

给定

```
public Class Example
{

public static void Foo< T>(int ID){}

public static void Foo< T,U>(int ID){}

} 
```

问题：

1.  将其称为“重载的泛型方法”是否正确？
2.  如何在创建 MethodInfo 对象时指定这两种方法？

    ```
    Type exampleType = Type.GetType("fullyqualifiednameOfExample, namespaceOfExample");
    MethodInfo mi = exampleType.GetMethod("Foo", BindingFlags.Public|BindingFlags.Static, null, new Type[] {typeof(Type), typeof(Type) }, null); 
    ```

参数 4 导致编译器非常不满

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-25T22:29:01.677

我找不到一种使用 GetMethod 的方法来做你想做的事。但是您可以获取所有方法并遍历列表，直到找到您想要的方法。

请记住，您需要先调用 MakeGenericMethod，然后才能实际使用它。

```
var allMethods = typeof (Example).GetMethods(BindingFlags.Public | BindingFlags.Static);
MethodInfo foundMi = allMethods.FirstOrDefault(
    mi => mi.Name == "Foo" && mi.GetGenericArguments().Count() == 2);
if (foundMi != null)
{
    MethodInfo closedMi = foundMi.MakeGenericMethod(new Type[] {typeof (int), typeof (string)});
    Example example= new Example();
    closedMi.Invoke(example, new object[] { 5 });
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-26T00:37:37.017

以下是您的问题的答案以及示例：

1.  是的，尽管对于泛型方法，类型推断和重载方法解析确实需要注意两件事。在编译器尝试解析重载的方法签名之前，类型推断发生在编译时。编译器将类型推断逻辑应用于所有具有相同名称的泛型方法。在重载决策步骤中，编译器仅包括类型推断成功的那些泛型方法。 [更多在这里...](http://msdn.microsoft.com/en-us/library/twcad0zb(VS.80).aspx)

2.  请参阅下面的完整示例控制台应用程序代码，该代码显示了如何在创建 MethodInfo 对象时指定 Foo 方法的几个变体，然后使用 Extension 方法调用：

程序.cs

```
class Program
{
    static void Main(string[] args)
    {
        MethodInfo foo1 = typeof(Example).GetGenericMethod("Foo",
            new[] { typeof(string) },
            new[] { typeof(int) },
            typeof(void));

        MethodInfo foo2 = typeof(Example).GetGenericMethod("Foo",
            new[] { typeof(string), typeof(int) },
            new[] { typeof(int) },
            typeof(void));

        MethodInfo foo3 = typeof(Example).GetGenericMethod("Foo",
            new[] { typeof(string) },
            new[] { typeof(string) },
            typeof(void));

        MethodInfo foo4 = typeof(Example).GetGenericMethod("Foo",
            new[] { typeof(string), typeof(int) },
            new[] { typeof(int), typeof(string) },
            typeof(string));

        Console.WriteLine(foo1.Invoke(null, new object[] { 1 }));
        Console.WriteLine(foo2.Invoke(null, new object[] { 1 }));
        Console.WriteLine(foo3.Invoke(null, new object[] { "s" }));
        Console.WriteLine(foo4.Invoke(null, new object[] { 1, "s" }));
    }
} 
```

示例.cs：

```
public class Example
{
    public static void Foo<T>(int ID) { }
    public static void Foo<T, U>(int ID) { }
    public static void Foo<T>(string ID) { }
    public static string Foo<T, U>(int intID, string ID) { return ID; }
} 
```

扩展.cs：

```
public static class Extensions
{
    public static MethodInfo GetGenericMethod(this Type t, string name, Type[] genericArgTypes, Type[] argTypes, Type returnType)
    {
        MethodInfo foo1 = (from m in t.GetMethods(BindingFlags.Public | BindingFlags.Static)
                           where m.Name == name &&
                           m.GetGenericArguments().Length == genericArgTypes.Length &&
                           m.GetParameters().Select(pi => pi.ParameterType).SequenceEqual(argTypes) &&
                           m.ReturnType == returnType
                           select m).Single().MakeGenericMethod(genericArgTypes);

        return foo1;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-06T17:36:59.293

更好的：

示例尝试获得正确的重载`System.Linq.Enumerable.Select`

```
 private static MethodInfo GetMethod<T>(Expression<Func<T>> expression)
    {
        return ((MethodCallExpression)expression.Body).Method;
    }

    public static void CallSelect()
    {
        MethodInfo definition = GetMethod(() => Enumerable.Select(null, (Func<object, object>)null)).GetGenericMethodDefinition();
        definition.MakeGenericMethod(typeof(int), typeof(int)).Invoke(null, new object[] { new List<int>(), ((Func<int, int>)(x => x)) });
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-02-20T02:21:37.310

另一个找到`MethodInfo`你想要的方法是创建一个委托；

```
var methodInfo = new Action<int>(Example.Foo<object,object>).Method.GetGenericMethodDefinition(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T22:52:28.093

这是您需要的 Linq 单线：

```
MethodInfo mi = exampleType.GetMethods().First(m=>m.GetGenericArguments().Length == 2); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-22T18:25:17.813

我对您的 lambda 查询进行了一些修改。

当参数类型是泛型时，您必须这样做：

我加`pi.ParameterType.GetGenericTypeDefinition()`

和

```
(m.ReturnType.IsGenericType ? m.ReturnType.GetGenericTypeDefinition() : m.ReturnType) == returnType) 
```

这样，该方法工作得很好

```
MethodInfo foo1 = (from m in t.GetMethods(BindingFlags.Public | BindingFlags.Static)
                         where m.Name == name
                         && m.GetGenericArguments().Length == genericArgTypes.Length
                         && m.GetParameters().Select(pi => pi.ParameterType.IsGenericType ? pi.ParameterType.GetGenericTypeDefinition() : pi.ParameterType).SequenceEqual(argTypes) &&
                         (returnType==null || (m.ReturnType.IsGenericType ? m.ReturnType.GetGenericTypeDefinition() : m.ReturnType) == returnType)
                         select m).FirstOrDefault();
      if (foo1 != null)
      {
        return foo1.MakeGenericMethod(genericArgTypes);
      }
      return null; 
```

例子 ：

通过修改方法，我可以调用此扩展方法

```
public static IQueryable<T> FilterCulture<T>(this Table<T> t, IDatabaseFilter filter) 
```

像这样使用我的新助手

```
var QueryableExpression = MethodInfoHelper.GetGenericMethod(typeof(LinqFilterExtension), "FilterCulture", new Type[] { rowType }, new Type[] { typeof(Table<>), typeof(IDatabaseFilter) }, typeof(IQueryable<>)); 
```

我的助手的签名是

```
 public static MethodInfo GetGenericMethod(Type t, string name, Type[] genericArgTypes, Type[] argTypes, Type returnType) 
```

# c# - 此 BackgroundWorker 当前正忙，无法同时运行多个任务

> ID：588150
> 
> 赞同：55
> 
> 时间：2009-02-25T22:12:11.093
> 
> 标签：c#, backgroundworker

如果我单击一个启动后台工作程序两次的按钮，我会收到此错误。

```
This BackgroundWorker is currently busy and cannot run multiple tasks concurrently 
```

我怎样才能避免这种情况？

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2009-02-25T22:14:02.117

很简单：不要启动 BackgroundWorker 两次。

您可以使用该属性检查它是否已经在运行`IsBusy`，因此只需更改以下代码：

```
worker.RunWorkerAsync(); 
```

对此：

```
if( !worker.IsBusy )
    worker.RunWorkerAsync();
else
    MessageBox.Show("Can't run the worker twice!"); 
```

更新：

如果您确实需要同时启动多个后台任务，您可以简单地创建多个 BackgroundWorker 对象

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2009-03-21T01:20:00.247

为您要执行的每个操作创建一个新的 BackgroundWorker 对象。即，而不是：

```
BackgroundWorker worker = new BackgroundWorker();
worker.DoWork += new DoWorkEventHandler(worker_DoWork);
for (int i; i < max; i++) {
   worker.RunWorkerAsync(i);
} 
```

试试这个：

```
for (int i; i < max; i++) {
   BackgroundWorker worker = new BackgroundWorker();
   worker.DoWork += new DoWorkEventHandler(worker_DoWork);
   worker.RunWorkerAsync(i);
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-08-26T11:07:06.317

我会考虑对需要完成的任务进行排队。您将获得以下优势；

*   您不必处理后台任务因其他已在运行而无法启动的问题
*   通过为每个任务创建一个新的后台，您不必担心使用太多线程。
*   最后，队列*可以*让您确保后台任务的运行顺序与创建/请求的顺序相同。

这是一个示例实现：[http](http://thevalerios.net/matt/2008/05/a-queued-backgroundworker) ://thevalerios.net/matt/2008/05/a-queued-backgroundworker 。我不确定是否在线程安全中实现，一旦我弄清楚我正在使用的实现中的当前锁定问题，我将更新我的答案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-04-24T14:02:45.000

尽管 OP 最初询问的情况并非如此，但如果您在某种生产者-消费者模式中使用后台工作人员，这也可能由于竞争条件（现在发生在我身上，并寻找答案）而发生。

例子：

```
if (BckgrndWrkr == null)
{
    BckgrndWrkr = new BackgroundWorker(); 
    BckgrndWrkr.DoWork += DoWorkMethod;
    BckgrndWrkr.RunWorkerAsync();     
}
else if (!BckgrndWrkr.IsBusy)
{
    BckgrndWrkr.RunWorkerAsync();
} 
```

在这种情况下，有一个竞争条件：第一个实例实例化一个新的后台工作程序，第二个实例到达`else if`并启动后台工作程序，在第一个实例到达`if`块的 RunWorkerAsync 之前，它会抛出错误。

这可以通过向整个 if + if else 部分添加锁来避免。

# domain-driven-design - DDD：除电子商务示例外，如何将应用程序划分为限界上下文？

> ID：588163
> 
> 赞同：15
> 
> 时间：2009-02-25T22:15:04.363
> 
> 标签：domain-driven-design

我们这里有一个相当大的应用程序，我考虑对其进行一些重构以遵循 DDD 人员的指导。

目前，它的第一个问题是有界上下文和上下文映射。也许我只是不了解它，但在我看来，除法是不可能的。例如，我们到处都有用户对象，它是完全相同的用户对象：显示名称、ID 和角色。还有另一个例子：我们有 CatalogItem 对象来帮助我们对整个地方的其他实体进行分类。我们是否必须引入限界上下文依赖项？除了那个烦人的电子商务样本之外，这件事有什么指导吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-01-16T02:29:33.240

我发现，起初，有界上下文和聚合根似乎是 DDD 中最简单的概念。直到您真正开始实施具有现实世界问题的 DDD 应用程序。这里没有简单的答案。这完全取决于您的业务需求（可扩展性、可用性、延迟、一致性等）。“正确”的解决方案是平衡这些问题以最适合您的需求的解决方案。

根据您给出的示例，有几种选择：

*   一个大的有界上下文
*   具有重复数据的单独有界上下文（可能使用发布/订阅消息系统实现）
*   将用户和目录项拉入它们自己的有界上下文中，并让其他有界上下文通过服务访问它们

要记住的一件事是查询需求通常与“写作”需求非常不同。它通常可以简化您的应用程序设计，使其具有纯粹用于查询的单独有界上下文。如果这听起来可能适用，请查看 CQRS。

# c++ - 新的第二个参数，C++

> ID：588164
> 
> 赞同：5
> 
> 时间：2009-02-25T22:15:30.210
> 
> 标签：c++, new-operator

在一个例子中，我看到了这条线

```
Thing *pThing = new (getHeap(), getConstraint()) Thing(initval()); 
```

没有解释、函数体或类定义。第二个参数是什么意思？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-25T22:19:05.927

这是“放置`new`”语法的一个实例。它用于将附加参数传递给自定义内存分配函数。

而这：

```
Obj* pObj = new Obj; 
```

对应于通过`operator new`使用类型的单个参数`size_t`和 的值调用来分配新内存`sizeof(Obj)`，并在返回的内存位置构造一个新的 Obj 实例，

```
Obj* pObj = new (param1, param2) Obj; 
```

对应于`operator new`用三个参数调用一个，`sizeof(Obj)`然后是`param1`and `param2`，并在custom的返回值指向的内存中构造Obj实例`operator new`。

Custom`operator new`可以全局定义，也可以隐式定义为静态类成员，在这种情况下，只会考虑分配该类型或派生类型的类实例。

[此常见问题解答](http://www.parashift.com/c++-faq-lite/dtors.html#faq-11.14)中有更多方法和原因。

# viewstate - 无效的视图状态错误

> ID：588176
> 
> 赞同：18
> 
> 时间：2009-02-25T22:18:31.263
> 
> 标签：viewstate, scriptresource.axd

我收到关于 ScriptResource.axd 的无效视图状态错误。只是想知道你们中是否有人可以帮助我。错误是：

```
2009-02-24 09:46:30,021 [13] DEBUG ASP.global_asax [(null)] - 请求开始 - URL: /Web/ScriptResource.axd?d=E9hlvtsn8Gr1MyjysW1gFDFYr4CVwstY-sC22tRu5V8d7UyEYz3FhVYGrlhY87n2ihgInKhcQahErqMRQG_Tru5V8d7UyEYz3FhVYGrlhY87n2ihgInKhcQahErqMRG_G_ThKhcHKahErqC
2009-02-24 09:46:30,021 [13] 调试 ASP.global_asax [(null)] - Application_AuthenticateRequest 开始
2009-02-24 09:46:30,021 [13] 错误 ASP.global_asax [(null)] - 意外错误。用户显示站点错误页面。
System.Web.HttpException：无效的视图状态。
   在 System.Web.UI.Page.DecryptStringWithIV(String s, IVType ivType)
   在 System.Web.UI.Page.DecryptString(String s)
   在 System.Web.Handlers.ScriptResourceHandler.DecryptParameter（NameValueCollection 查询字符串）
   在 System.Web.Handlers.ScriptResourceHandler.ProcessRequestInternal（HttpResponse 响应，NameValueCollection 查询字符串，VirtualFileReader fileReader）
   在 System.Web.Handlers.ScriptResourceHandler.ProcessRequest（HttpContext 上下文）
   在 System.Web.Handlers.ScriptResourceHandler.System.Web.IHttpHandler.ProcessRequest（HttpContext 上下文）
   在 System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
   在 System.Web.HttpApplication.ExecuteStep（IExecutionStep 步骤，Boolean& completedSynchronously）
```

这发生在生产环境中。我无法在开发或测试环境中重现这一点。此外，这些页面只能由经过身份验证的用户访问。如果你能对这件事有所了解，那就太好了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-11-04T14:00:33.573

我认为这些错误在不同的浏览器上发生的原因不同，这就是很难追踪的原因。

**IE8 错误**

微软曾表示 IE8 中的错误会（在某些情况下）向服务器生成虚假请求，这些请求不会影响用户，但会导致在服务器端记录错误。

请参阅此处的讨论：[Bug IE8 – 4K dropped - “Invalid viewstate” when loading ScriptResource.axd](https://connect.microsoft.com/IE/feedback/ViewFeedback.aspx?FeedbackID=467062) *（编辑：链接现在出于某种原因需要登录，抱歉）*

...特别是 EricLaw-MSFT 的更新，他说：

> 值得一提的是，任何在 IE6/IE7 或 Firefox 中遇到问题的人都会遇到与下面描述的 IE8 问题无关的不同问题。

这篇博文还描述了这些错误：[IE8's Lookahead Downloader 中的错误](http://blogs.msdn.com/ieinternals/archive/2009/07/27/Bugs-in-the-IE8-Lookahead-Downloader.aspx)

他们说更改您设置 Content-Type 的方式将有助于解决一些错误，尽管不是全部 - 他们说这是由他们仍在研究的各种模糊环境引起的。

**更新：**截至 2010 年 4 月 1 日，这些 IE8 错误已通过 IE8 累积更新 (KB980182) 得到修复。
这篇文章：[IE8 Lookahead Downloader Fixed](http://blogs.msdn.com/ieinternals/archive/2010/04/01/IE8-Lookahead-Downloader-Fixed.aspx)提供了有关错误和其他可能/部分解决方法（例如[这个](https://stackoverflow.com/questions/588176/invalid-viewstate-error/1544402#1544402)）的更多详细信息，而不是等待世界上的每个人下载修复程序。

**其它浏览器**

还没弄明白，但其他浏览器也会产生这些错误，大概是出于不同的原因。

**网络农场**

此问题不仅限于在网络场上运行的站点，但如果您正在运行一个场，请查看[jesal 的这个答案，](https://stackoverflow.com/questions/480392/srcriptresource-axd/481026#481026)这可能会有所帮助

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T22:36:54.247

如前所述，如果您使用 Web Farm 并且机器密钥不同步，则可能会发生这种情况。

另一种可能性是组装日期在将来。这会导致各种晦涩难懂的问题，值得一试。也许您的服务器位于不同的时区？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-09T15:06:47.347

[MS 建议](https://connect.microsoft.com/IE/feedback/ViewFeedback.aspx?FeedbackID=467062)不要使用元标记声明您的字符集，而是将其设置为 HTTP 标头。

所以删除

`<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">`

并添加

`Response.AddHeader("Content-Type", "text/html; charset=utf-8");`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T22:30:33.403

我建议看看[这个](https://stackoverflow.com/questions/480392/srcriptresource-axd)......它基本上概述了一些可能发生这种情况的情况，具体取决于文档类型。我们有一个类似的问题，它似乎只是不规律地出现......对我们来说，这是我们的 XHTML doctype 和我们在页面上拥有的 javascript 之间的冲突。我们能够通过确保我们所有的 javascript 都正确地包装在标签中来解决它。

```
<script>
     mycode;
</script> 
```

会成为

```
<script>
// <![CDATA[
    mycode;
// ]]>
</script> 
```

这可能不是一个相同的问题，但如果您有一个 xhtml 文档类型，请查看您是否有非合法 XML 的未转义字符（例如“<”字符）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T23:50:49.683

我注意到 Firefox 3.1 Beta 会导致无效的视图状态错误。您可能需要查看日志以查看发生这些错误时正在使用的浏览器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-14T15:12:41.360

我遇到了同样的错误，它们实际上是在过去一两个月才开始的，它一直在我们的几个网站上发生，自 12 月以来我们没有改变任何一个。这让我觉得配置更改或 Windows 更新正在影响它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-25T22:31:49.377

如果接收 scriptresource.axd 请求的应用程序池的 machineKey 与为原始页面提供服务的应用程序池的 machineKey 不同，则可能会发生这种情况。如果您使用的是网络场，则很可能出现这种情况。如果应用程序池重新启动，它也可能发生在单个服务器上，因为将生成新的机器密钥。解决方案是在 web.config 中放置一个固定的 machineKey。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-06T20:43:08.017

视图状态有多大？一些代理服务器会截断大视图状态。

很容易滥用视图状态，因为它默认是打开的。如果您确实有一个大的视图状态，那么您可能想要查看在不需要它的控件上禁用视图状态。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-23T12:53:59.717

用户代理的相同错误：Mozilla/4.0（兼容；MSIE 7.0；AOL 9.0；Windows NT 6.0；Trident/4.0；GTB5；SLCC1；.NET CLR 2.0.50727；Media Center PC 5.0；.NET CLR 3.5.30729 ;.NET CLR 3.0.30618)

我尝试修改/删除 doctype 声明并在 // <![CDATA[ 中扭曲 javascript 并且仍然存在异常......

目前所有都来自同一个IP

# sql - SET NOEXEC ON 是如何工作的？

> ID：588177
> 
> 赞同：6
> 
> 时间：2009-02-25T22:18:33.120
> 
> 标签：sql, sql-server, tsql

我有以下代码：

```
-- start of code
set noexec off

declare @requiredVersion int
declare @currentVersion int

set @requiredVersion = 5
set @currentVersion = 4

if (@currentVersion < @requiredVersion)
begin
    print 'Please update your DB to version 5 before running this script.'
    set noexec on
end

go
-- print 'Dummy'
insert into tblFooBar(name) values ('AAA')
go

set noexec off
-- end of code 
```

请注意，数据库中不存在表“tblfoobar”。当我运行此代码时，会出现以下消息：

```
请在运行此脚本之前将您的数据库更新到版本 5。
消息 208，第 16 层，状态 1，第 1 行
无效的对象名称“tblFooBar”。

```

我期待将 noexec 设置为 ON 可能不会给出消息的“Msg 208”部分。

然后再次“set noexec on”编译代码，不执行它。试图将一些东西插入到一个不存在的表中是一个编译时错误——我猜。如果是这种情况，那么应该出现关于“丢失对象”的错误。

现在让我告诉你我观察到的奇怪行为。如果我从“-- Print 'dummy'”行中删除评论

```
-- start of code
set noexec off

declare @requiredVersion int
declare @currentVersion int

set @requiredVersion = 5
set @currentVersion = 4

if (@currentVersion < @requiredVersion)
begin
    print 'Please update your DB to version 5 before running this script.'
    set noexec on
end
go
print 'Dummy'
insert into tblFooBar(name) values ('AAA')
go 
```

并执行代码，我只收到以下消息。

> 请在运行此脚本之前将您的数据库更新到版本 5。

这次没有关于丢失表的消息。

有人可以向我解释这种行为吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T23:28:02.020

我不希望像您所做的那样在条件中使用“set noexec”是有效的，但实际上它似乎是有效的。

该行为似乎与它是 DDL 语句这一事实有关。如果您将插入替换为打印语句或简单的选择查询，脚本将按预期工作。

顺便说一句，如果我想做这样的事情，我使用以下方法：

```
    创建 proc tmproc_foobar 作为
       创建表 tblFooBar( 名称 nvarchar(20) )
    去

    如果存在（从类型 = 'U' 和名称 = 'tblFooBar' 的 sysobjects 中选择 1）
         执行 tmproc_foobar
    去

    删除 proc tmproc_foobar
    去

```

SQL Server 允许您使用不存在的对象创建存储过程，因此您可以创建过程，有条件地执行它，然后删除它。这就是我有一个长升级脚本的方式，它有条件地将任何丢失的对象添加到我的数据库中。

你也许可以适应这个。然后，您首先不需要 noexec，因为您避免了无效对象的整个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-10T16:34:03.117

我检查了上面的代码，它工作正常。它不会为丢失的对象提供任何错误消息。

```
set noexec off

declare @requiredVersion int
declare @currentVersion int

set @requiredVersion = 5
set @currentVersion = 4

if (@currentVersion < @requiredVersion)
begin
    print 'Please update your DB to version 5 before running this script.'
    set noexec on--> here we are setting NOEXEC on
end

go
-- print 'Dummy'
insert into tblFooBar(name) values ('AAA')
go

set noexec off
-- end of code 
```

由于 NOEXEC 已打开，因此下面的代码将被编译而不被执行，因此它不会通过任何错误消息。

# javascript - MSHTML - 自动单击 JavaScript 确认对话框

> ID：588179
> 
> 赞同：1
> 
> 时间：2009-02-25T22:18:53.573
> 
> 标签：javascript, dialog, mshtml, confirm

我正在尝试使用 MSHTML（在 C#.Net 3.1 WPF WebBrowser 控件中）自动解析/提交网页。我可以毫无问题地填写表格、单击按钮和浏览页面。

但是我不知道如何在单击“提交”按钮时出现的 JavaScript 确认对话框上自动单击“确定”按钮。

C#代码：

```
mshtml.IHTMLDocument2 doc = (mshtml.IHTMLDocument2)webBrowser.Document;
mshtml.IHTMLFormElement form = doc.forms.item("inputForm", 0) as mshtml.IHTMLFormElement;
mshtml.IHTMLElement btnSubmit = form.item("btnFormSubmit", null) as mshtml.IHTMLElement;
btnSubmit.click(); 
```

出现确认对话框（“您确定吗？”）。我想以某种方式向 MSHTML 文档发送“Enter”键以自动确认提交。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-17T12:30:01.333

我终于找到了如何在 WebBrowser 控件中抑制确认消息的方法。它实际上显示在 javascript 函数 showConfirm() 中。我在 Browser.Document 的标题顶部插入了虚拟函数 showConfirm()，它覆盖/抑制了原始函数 showConfirm()。代码很忙，但主要思想很清楚，而且效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T04:56:19.343

由于 WebBrowser 控件是一个黑盒子，您可能应该研究通过 Win32 API 获取对话框的句柄。从那里您可以调用“确定”按钮。抱歉，我不能说得更具体了，因为我以前从未做过这件事。不过，希望这足以让您朝着正确的方向进行研究。

# wcf - 使用 WCF 联合 RSS 1.0

> ID：588182
> 
> 赞同：0
> 
> 时间：2009-02-25T22:19:09.640
> 
> 标签：wcf, rss, feed

使用新的联合 API，是否有任何流畅的方式来阅读 RSS 1.0 提要？发现[http://www.clariusconsulting.net/blogs/kzu/comments/116679.aspx](http://www.clariusconsulting.net/blogs/kzu/comments/116679.aspx)解释了如何阅读 atom 0.3。我们真的需要创建自己的 xslt 来将提要从 RSS 1.0 转换为 RSS 2.0 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T22:31:58.953

SyndicationFeed 仅支持 Atom 1.0 和 RSS 2.0。

但是，您可以实现自己的了解 RSS 1.0 的 SyndicationFeed、SyndicationItem、SyndicationFeedFormatter 和 SyndicationItemFormatter。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T14:54:04.450

在 codeplex 上的 ASP.NET 的 RSS 工具包中找到了一个 XSLT，它可以从 RSS 1.0 转换为 RSS 2.0。使用它的方式与 Daniel Cazzulino 使用他前面提到的 Atom 0.3 转换器的方式相同

# apache - mod_rewrite 重复

> ID：588186
> 
> 赞同：0
> 
> 时间：2009-02-25T22:20:07.487
> 
> 标签：apache, mod-rewrite

我正在开发一个通过单个 PHP 页面（passthrough.php）传递所有 PHP 脚本的网站。

.htaccess 文件*应该*采用某些特殊目录并将它们转换为 GET 变量，因此控制器脚本知道如何处理它们。所以：

```
http://example.com/ajax/method.php 
```

变成

```
http://example.com/passthrough.php?path=method.php&mode=ajax 
```

和

```
http://example.com/ajax/json/method.php 
```

变成

```
http://example.com/passthrough.php?path=method.php&mode=ajax&output=json 
```

等等。这就是我的 .htaccess 文件中的内容：

```
RewriteRule ajax/(.*)$ $1?mode=ajax [QSA]
RewriteRule (xml|json)/(.*)$ $2?output=$1 [QSA]

RewriteRule (.*)\.php$ passthrough.php?path=$1 [QSA]
RewriteRule passthrough.php - [L] 
```

在我的第二个示例中，mod_rewrite 执行 ajax 规则，然后看起来它执行 passthrough.php 规则。然后，它看起来运行重写过程。现在 ajax 规则不适合，但是输出规则适合，所以应用了，然后 URL 最终被 passthrough.php 规则再次重写，这导致以下 GET vars：

路径：method.php/json/method.php/json/method 输出：json 模式：ajax

我的问题是：有没有办法让重写引擎一次性处理整个 URL？所以 url 以 /ajax/json/method.php 的形式出现，变为 /json/method.php?mode=ajax，然后是 /method.php?mode=ajax&output=json，然后是 /passthrough.php?mode=ajax&output=json&path =方法，一气呵成？它似乎是为每个匹配的规则运行一次 .htaccess，而不是解析 URL，根据下一个规则更改，根据下一个规则更改，等等。

我已经尝试使用几个标志，包括 [PT] 和 [S]，但它们的文档记录很差。可以通过编写将代码直接传递给直通脚本的特殊条件来解决该问题，但这并没有很好地解决，并且对我来说“感觉”不正确。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T22:36:31.597

试试这个：

```
RewriteRule ^passthrough\.php$ - [L]
RewriteRule !\.php$ - [L]
RewriteRule ^ajax/(.*) passthrough.php?path=$1&mode=ajax [L,QSA]
RewriteRule ^(xml|json)/(.*) passthrough.php?path=$2&output=$1 [L,QSA] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T22:37:35.133

老实说，我认为您在脚本中传递并解析它`PATH_INFO`是错误的。`passthrough.php`通过（ab）按您的方式使用 mod_rewrite，您正在为维护噩梦做好准备。

# javascript - jQuery：是否可以将字段/方法附加到 jQuery 包装器对象？

> ID：588188
> 
> 赞同：7
> 
> 时间：2009-02-25T22:20:36.050
> 
> 标签：javascript, jquery, plugins

我正在尝试编写一个插件，它将向 jQuery 包装器对象添加一些方法。基本上，我想像这样初始化它：

```
var smart = $('img:first').smartImage(); 
```

'smartImage' 插件会将 2 个方法附加到 'smart' 引用的对象上，因此我可以执行以下操作：

```
smart.saveState();
// do work
smart.loadState(); 
```

不幸的是，我不知道如何将这两种方法附加到包装对象。我的代码遵循典型的 jQuery 插件模式：

```
(function($)
{
    $.fn.smartImage = function()
    {
        return this.each(function()
        {
            $(this).saveState = function() { /* save */ }
            $(this).loadState = function() { /* load */ }
        }
    }
 } 
```

在我调用 smartImage() 之后，既没有定义“saveState”也没有定义“loadState”。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T22:29:08.667

您实际上是在 smartImage() 函数中返回一个 jQuery 对象。这是编写 jQuery 插件的正确方法，因此您可以将其与其他 jQuery 函数链接。

我不确定是否有办法做你想做的事。我会推荐以下内容：

```
(function($) {
     var smartImageSave = function() { return this.each(function() { } ); };
     var smartImageLoad = function() { return this.each(function() { } ); };

     $.fn.extend( { "smartImageSave":smartImageSave, 
                     "smartImageLoad":smartImageLoad });
 });

 var $smart = $("img:first");
 $smart.smartImageSave();
 $smart.smartImageLoad(); 
```

这是我熟悉并成功使用的一种技术。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-26T01:07:45.587

您不能以您演示的方式附加方法/属性，因为正如您所说，jQuery 对象只是它包含的任何 DOM 元素的包装器。您当然可以将方法/属性附加到它，但是当它们再次被 jQuery 选择时，它们将不会持续存在。

```
var a = $('.my-object');
a.do_something = function(){ alert('hiya'); }
a.do_something(); // This alerts.

var b = $('.my-object');
b.do_something(); // Freak-out. 
```

如果您希望在第二次恢复时在 jQuery 对象上存在方法，则需要将其分配给`jQuery.fn`. 因此，您*可以*定义辅助方法，将其分配给 jQuery.fn，并使用 jQuery 数据设置为您维护状态...

```
$.fn.setup_something = function()
{
    this.data('my-plugin-setup-check', true);
    return this;
}

$.fn.do_something = function()
{
    if (this.data('my-plugin-setup-check'))
    {
        alert('Tada!');
    }
    return this;
}

var a = $('.my-object').setup_something();
a.do_something(); // Alerts.
$('.my-object').do_something(); // Also alerts. 
```

我建议你看看[http://docs.jquery.com/Internals/jQuery.data](http://docs.jquery.com/Internals/jQuery.data)和[http://docs.jquery.com/Core/data#name](http://docs.jquery.com/Core/data#name)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-26T00:08:21.750

我不完全确定您为什么要以这种方式设计插件-您可能想考虑一下 jonstjohn 的建议的内容-但以下内容应该与您的要求相似：

```
jQuery.fn.extend({
    smartImage: function() {
        return {
            saveState: function() { /* save */ },
            loadState: function() { /* load */ }
        };
    }
}); 
```

# c# - WPF：翻译（移动）画布和监控每一步的最佳（可靠）方式

> ID：588190
> 
> 赞同：1
> 
> 时间：2009-02-25T22:21:12.163
> 
> 标签：c#, wpf, canvas, translation, timer

我曾尝试翻译（移动）画布，但我遇到了计时器问题。

我尝试了两种不同的方法：

第一种方法是`BeginAnimation`函数，第二种方法是`DispatcherTimer`刻度，但它们都非常不可靠。

我需要监控翻译的每一步。使用我尝试的第一种方法 ( `BeginAnimation`)，我在`Changed`事件中执行了碰撞检测逻辑，而使用第二种方法 ( `DispatcherTimer`)，我在`Tick`计时器事件中执行了碰撞检测逻辑。

问题是两者都非常不可靠。从某种意义上说，在我的碰撞检测逻辑中，画布应该在其属性 <= 0 时停止平移`TranslateTransform`（`Y`从技术上讲，如果它正在监视每一步，它应该每次都停在 0 处），但是我尝试了两种方法，它停止时会发生**变化。**例如，**有时它停在 0 处，有时停在 -1、-2、-3 处，有时甚至停在 -4 处**。

那么这些差异是怎么回事？为什么它不像它应该的那样监控每一步？

我可以做些什么来为这个画布设置动画并真正监控每一步？我的意思是每一步......它移动的每一个像素

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T09:32:16.713

您的问题是一切都是基于时间的，每次画布移动一个像素时您都不会收到回调，每次渲染帧时都会收到回调 - 系统甚至不会努力渲染帧一个恒定的速率。

最终结果就是你所看到的，有时你可以在移动 1/2 像素后得到回调，因为一切都很顺利，下一次移动两个像素时，因为 GC 在中间帧开始，之后的时间是 4像素移动是因为在后台运行的 Word 窃取了一些 CPU 周期来运行拼写检查程序。

这就是这些事情的工作方式，您可以处理它并为您的碰撞检测设置更高的容差，或者您可以在“虚拟时间轴”上运行屏幕外的模拟，您可以在不考虑现实的情况下以您想要的任何速度推进对象的屏幕动画。

我编写了对真实飞机进行模拟和碰撞检测的软件——我可以告诉你，这需要付出很多努力，为动画构建的任何框架都针对在屏幕上移动物体进行了优化，而不是你必须为高强度做的所有工作质量模拟，绝对不是为了准确的碰撞检测。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T23:36:24.387

您应该挂钩[CompositionTarget.Rendering](http://msdn.microsoft.com/en-us/library/system.windows.media.compositiontarget.rendering.aspx)事件。

当您挂钩此事件时，它会在每次即将渲染帧时触发，因此您可以根据自上次事件调用以来经过的时间来移动精灵。一旦您的精灵停止移动，您需要从事件中取消挂钩，因为只要有任何事件挂钩到事件中，WPF 就会尽可能快地渲染帧。

有关该事件以及如何使用它的更多信息，请尝试此[博客](http://work.j832.com/2007/06/re-compositiontargetrendering.html)条目，其中包含更多详细信息并包含您可以下载以查看的代码。

# asp.net - 如何指定目录中的哪个文件将加载 ASP.NET？

> ID：588197
> 
> 赞同：1
> 
> 时间：2009-02-25T22:23:53.653
> 
> 标签：asp.net, vb.net

基本文件夹结构：

```
<root>
---<admin>
------index.aspx
------[other files]
---index.aspx 
```

当我导航到 mywebsite.com/admin/ 时，我得到的只是一个目录列表。如何让它`index.aspx`自动加载？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-25T22:25:54.117

您必须更改 IIS 网站配置对话框中的默认文档列表。如果您无权访问它，请将 index.aspx 更改为 default.aspx。ASP.NET 安装在列表中设置了 default.aspx，这也是所有新的 VS Web 项目都以 Default.aspx 页面开头的原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T22:26:42.383

尝试将 index.aspx 重命名为 Default.aspx

# windows - 我的 winform 应用程序使用 xml 文件来存储数据，我应该将它们存储在哪里以便 Vista 用户可以写入它们？

> ID：588207
> 
> 赞同：2
> 
> 时间：2009-02-25T22:28:15.330
> 
> 标签：windows, xml, winforms

我的 winform 应用程序使用 xml 文件来存储数据，我应该将它们存储在哪里以便 Vista 用户可以写入它们？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-25T23:06:37.420

使用[`Environment.GetFolderPath`](http://msdn.microsoft.com/en-us/library/system.environment.getfolderpath.aspx)以独立于操作系统的方式获取最合适的文件夹。

特别是，您需要以下 SpecialFolder 值之一：

*   **`ApplicationData`**- 如果文件是漫游的，每个用户，并且仅供应用程序使用，不代表用户可能关心的文档。
*   **`LocalApplicationData`**- 如果文件是非漫游的，每个用户的，并且仅供应用程序使用，不代表用户可能关心的文档。
*   **`CommonApplicationData`**- 如果文件是漫游的，对所有用户都是通用的，并且仅供应用程序使用，不代表用户可能关心的文档。**注意：**在 Vista 上，这映射到**`C:\ProgramData`**，默认情况下对普通用户是只读的（因为更改其中的文件可能会影响管理员使用的程序的行为）。您可以显式更改应用程序子文件夹的权限，也可以选择其他选项之一。
*   **`MyDocuments`**- 如果文件是每个用户的并且代表文档。

Note that there's no `SpecialFolder` enum value like **`CommonDocuments`** that would represent machine-wide document store, even though there is a folder intended to serve like one (**`C:\Documents and Settings\All Users\Documents`** on XP and **`C:\Users\Public\Documents`** on Vista). You will have to find the OS version yourself and choose the appropriate folder if you want to write to these locations.

Internally `Environment.GetFolderPath` uses the Win32 API [`SHGetFolderPath`](http://msdn.microsoft.com/en-us/library/bb762181(VS.85).aspx). The enumeration used by `SHGetFolderPath` gives you the well-known locations for several other special folders (including Common Documents). You might use directly `SHGetFolderPath`; you can find it's [p/invoke definition](http://www.pinvoke.net/default.aspx/shell32/SHGetFolderPath.html) and the corresponding [CSIDL enum definition](http://www.pinvoke.net/default.aspx/shell32/CSIDL.html) on PInvoke.net.

You can also use the [`IsolatedStorage`](http://msdn.microsoft.com/en-us/library/3ak841sy.aspx). However, it is non-roamable, per-user, with limited quota and is not easily accessible to the user from Windows Explorer. As such, it is really a medium/low-trust equivalent to `SpecialFolder.ApplicationData`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-25T23:00:42.210

Environment.GetFolderPath 应该告诉你 Windows 希望你在哪里存储东西。

对于用户特定的数据，

```
Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData)); 
```

通常返回 C:\Users\%user%\AppData\Roaming

对于普通数据，

```
Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData)); 
```

通常返回 C:\ProgramData。

这也将在旧版本的 Windows 下做正确的事情；XP 通常会返回 C:\Documents and Settings\%user%\Application Data 和 C:\Documents and Settings\All Users\Application Data。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T23:01:35.810

尝试使用.Net Framework 中的[IsolatedStorage](http://msdn.microsoft.com/en-us/library/3ak841sy.aspx)。它会为你完成这项工作。

该框架可以为您管理这些位置，而不是管理驱动器、文件夹和文件等。它的目的是拥有一个您不必担心用户权限的区域。

以下代码序列直接来自 MSDN，但准确显示了您将如何使用这些文件。

* * *

```
using System;
using System.IO;
using System.IO.IsolatedStorage;

public class ReadingAndWritingToFiles{

   public static int Main(){

      // Get an isolated store for this assembly and put it into an
      // IsolatedStoreFile object.

      IsolatedStorageFile isoStore =  IsolatedStorageFile.GetStore(IsolatedStorageScope.User | IsolatedStorageScope.Assembly, null, null);

      // This code checks to see if the file already exists.

      string[] fileNames = isoStore.GetFileNames("TestStore.txt");
      foreach (string file in fileNames){
         if(file == "TestStore.txt"){

            Console.WriteLine("The file already exists!");
            Console.WriteLine("Type \"StoreAdm /REMOVE\" at the command line to delete all Isolated Storage for this user.");

            // Exit the program.

            return 0;
         }
      }

      writeToFile(isoStore);

      Console.WriteLine("The file \"TestStore.txt\" contains:");
      // Call the readFromFile and write the returned string to the
      //console.

      Console.WriteLine(readFromFile(isoStore));

      // Exit the program.

      return 0;

   }// End of main.

   // This method writes "Hello Isolated Storage" to the file.

   private static void writeToFile(IsolatedStorageFile isoStore){

      // Declare a new StreamWriter.

      StreamWriter writer = null;

      // Assign the writer to the store and the file TestStore.

      writer = new StreamWriter(new IsolatedStorageFileStream("TestStore.txt", FileMode.CreateNew,isoStore));

      // Have the writer write "Hello Isolated Storage" to the store.

      writer.WriteLine("Hello Isolated Storage");

      writer.Close();

      Console.WriteLine("You have written to the file.");

   }// End of writeToFile.

   // This method reads the first line in the "TestStore.txt" file.

   public static String readFromFile(IsolatedStorageFile isoStore){

      // This code opens the TestStore.txt file and reads the string.

      StreamReader reader = new StreamReader(new IsolatedStorageFileStream("TestStore.txt", FileMode.Open,isoStore));

      // Read a line from the file and add it to sb.

      String sb = reader.ReadLine();

      // Close the reader.

      reader.Close();

      // Return the string.

      return sb.ToString();

   }// End of readFromFile.
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T22:41:07.683

您希望您的应用程序数据是用户特定的吗？然后你应该考虑把它放在`C:\Users\%username%\%appname%\...` 否则，@Mike_G 建议简单地将它放在与你的应用程序相同的目录中并没有错。

编辑：除非，正如您的评论所指出的那样，`C:\Program Files\...`不可写，在这种情况下，我可能会考虑在所有情况下使其特定于用户（具有良好的默认值），除非我有充分的理由希望它合并在一个地方. 如果是这种情况，我会将其作为应用程序配置的一部分，并让用户确定他们想要（并且可以）保存数据的位置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T22:43:15.840

如果数据适用于所有用户，那么您可以尝试使用“共享文档”区域。在 XP 上，它位于 C:\Documents and Settings\All Users\Documents。我不确定 Vista，但它可能在 C:\Users 中。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-02-25T22:32:03.667

为什么不在应用程序目录中（安装应用程序的目录相同）？

# weblogic - WLST 最佳实践：Shell 与 MBean？

> ID：588214
> 
> 赞同：3
> 
> 时间：2009-02-25T22:30:47.100
> 
> 标签：weblogic, wlst

有没有使用 WLST 的管理员？

在我们的项目中，我们正在自动化我们的许多日常任务，例如部署和域设置。我们还在构建脚本，这些脚本将根据我们的基线配置、JDBC、JNDI 等创建域。

通过 WLST 提供的功能之一是通过类似 shell 的界面对 MBean 进行导航。在制作大型脚本时，这个 shell 接口更好还是直接调用域 MBean？

使用 WLST 的任何其他提示/最佳实践/陷阱？

真的有人用吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T09:51:14.830

交互模式非常适合获得有关函数行为的即时反馈。拥有整个启动、连接、会话初始化非常耗时，而 wlst 的交互模式避免了这种情况。

我发现的最大缺陷首先是 wlst-online 和 wlst-offline 之间的区别。其次，Wlst-env 和纯 Python-env 之间的区别。

我无法想象有人将他们的 WLS 设置扩展到 10 台以上的服务器，每台服务器拥有超过 100 个资源，而无需借助 WLST 来保持它的可管理性和一致性。

# php - 论坛结构 获取最后一个帖子

> ID：588221
> 
> 赞同：0
> 
> 时间：2009-02-25T22:32:08.580
> 
> 标签：php, sql

我的英语不是那么好。我基本上想显示最后一篇帖子在论坛上发布的日期。这是我的论坛shema：

```
 `forum_id` int(11) NOT NULL auto_increment
  `forum_name` varchar(255) NOT NULL
  `forum_description` text NOT NULL
  `forum_order` int(11) NOT NULL

  `thread_id` int(11) NOT NULL auto_increment
  `thread_title` varchar(255) NOT NULL
  `thread_text` text NOT NULL
  `thread_date` datetime NOT NULL
  `forum_id` int(11) NOT NULL default '0'
  `thread_author` int(11) NOT NULL

  `comment_id` int(11) NOT NULL auto_increment
  `comment_text` text NOT NULL
  `comment_thread_id` int(11) NOT NULL default '0'
  `comment_poster` int(11) NOT NULL default '0'
  `comment_date` datetime NOT NULL 
```

论坛.php

```
 $query = mysql_query("SELECT * FROM forums ORDER BY forum_order ASC");
   while ($row = mysql_fetch_assoc($query)) {

  <h3>Forum: <?php echo $row['forum_name'] ?><h3>
  <div>Desc: <?php echo $row['forum_description'] ?></div>
  <div>Last post: <?php echo $??['comment_date'] ?></div>
  <?php } ?> 
```

我将如何获得所有论坛的最后评论日期？也许在我存储最后评论日期的线程表中添加一个字段？也许更好的方法？不知道如何更好地解释这一点。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T22:36:05.387

您必须查询您的数据库。（您必须查看代码是如何制作的。）

```
SELECT comment_date FROM dates ORDER BY comment_date DESC LIMIT 1; 
```

（`LIMIT 1`告诉数据库只返回一个条目。）

然后打印该条目。（同样，您必须查看您的代码。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T23:02:37.820

就像是：

```
SELECT forums.*, max(comments.date) as last_comment
FROM forums 
LEFT OUTER JOIN threads ON forums.forum_id = threads.forum_id
LEFT OUTER JOIN comments ON threads.thread_id = comments.comment_thread_id
GROUP BY forums.forum_id
ORDER BY forum_order ASC 
```

# linq-to-sql - LINQ to SQL 异常：System.OutOfMemoryException

> ID：588223
> 
> 赞同：4
> 
> 时间：2009-02-25T22:32:33.947
> 
> 标签：linq-to-sql

不知道为什么我不断收到`OutOfMemory`异常。我正在使用带有 LINQ to SQL 的 ASP.NET MVC。这是一些堆栈跟踪：

> [OutOfMemoryException：引发了“System.OutOfMemoryException”类型的异常。]
> System.Runtime.CompilerServices.RuntimeHelpers._CompileMethod(IntPtr 方法) +0
> System.Reflection.Emit.DynamicMethod.CreateDelegate(Type delegateType) +7652553
> System.Data.Linq .SqlClient.ObjectReaderCompiler.Compile(SqlExpression 表达式, Type elementType)
> +442 System.Data.Linq.SqlClient.SqlProvider.GetReaderFactory(SqlNode 节点, Type elemType) +100
> System.Data.Linq.SqlClient.SqlProvider.System.Data.Linq .Provider.IProvider.Execute(Expression query) +253
> System.Data.Linq.Table 1 source, Expression`1 predicate) +301 WorkGrabber.Web.Models.WorkGrabberDataContext.GetJob(Int32 id) +233`1.System.Linq.IQueryProvider.Execute(Expression expression) +49
> System.Linq.Queryable.Single(IQueryable`
> 
> WorkGrabber.Web.Controllers.BidsController.New(Int32 jobId) +19

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T22:41:01.117

你的表情是什么？问题似乎源于这一行：

```
System.Reflection.Emit.DynamicMethod.CreateDelegate(Type delegateType) +7652553 
```

这个偏移量似乎很奇怪。我简直不敢相信普通的动态方法会有 7.5MB 的体积。

# asp.net-mvc - 为什么 Controller.RouteData.Route 为空？

> ID：588226
> 
> 赞同：1
> 
> 时间：2009-02-25T22:33:35.580
> 
> 标签：asp.net-mvc

我试图在我的应用程序调试期间显示一个小面板，其中包含各种杂项功能。我希望它包含的一件事是有关当前路线的信息。

我试图查看，`Controller.RouteData`但有些属性为空。

```
 RouteData.Route          - null
 RouteData.RouteHandler   - null
 RouteData.Values         - has expected values corresponding to the URL 
```

如何获得 'Route' 的值？

我确实看到了这篇关于[URL 调试](http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx)的帖子，但我认为这没有帮助，因为虽然我正在编写一个调试控制台，但我想要“运行时”值并且不想添加额外的抽象层。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-26T10:20:44.603

我知道这是一个老问题，但仍然......你想拥有路线变量吗？

那么你可能会通过

```
ViewContext.RouteData.GetRequiredString("controller") 
```

路由值的名称来自您定义所有变量的路由。

因此，您可以访问控制器、操作、ID，以及您在路由中拥有的任何内容。

# sql - SQL查找两行之间的差异

> ID：588229
> 
> 赞同：2
> 
> 时间：2009-02-25T22:34:37.653
> 
> 标签：sql, informix

我有一个 Informix 数据库，其中包含许多不同位置的测量温度值。每 15 分钟对所有位置进行一次测量，然后将时间戳加载到同一个表中。表如下所示：

```
locId dtg 温度
aaa 2009-02-25 10:00 15
bbb 2009-02-25 10:00 20
cc 2009-02-25 10:00 24
aaa 2009-02-25 09:45 13
cc 2009-02-25 09:45 16
bbb 2009-02-25 09:45 18
ddd 2009-02-25 09:45 12
aaa 2009-02-25 09:30 11
cc 2009-02-25 09:30 14
bbb 2009-02-25 09:30 15
ddd 2009-02-25 09:30 10

```

现在我想要一个查询，向我展示所有站点的最后两次测量之间的温度变化。而且，只有那些具有更新测量值的。例如，在上表中，不会包含位置 ddd。所以结果变成：

```
位置标识更改
2
bbb 2
cc 8

```

我已经尝试了很多，但我找不到任何好的解决方案。实际上，从网页询问大约 700 个位置，因此我认为查询需要相当有效。

真的很感激一些帮助！
//杰斯珀

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T22:59:45.690

```
set now = select max(dtg) from table;
set then = select max(dtg) from table where dtg < now;

select locID, old.temp-new.temp from 
      table as old join
      table as new 
      on old.locId = new.locID
where
      old.dtg = then and
      new.dtg = now; 
```

* * *

假设所有时间都是准确的

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-26T04:08:37.897

感谢uglysmurf 以SQL 格式提供数据。

使用 IDS (IBM Informix Dynamic Server) 版本 11.50，以下查询有效。

```
CREATE TEMP TABLE temps
(
    locId   CHAR(3),
    dtg     DATETIME YEAR TO MINUTE,
    temp    SMALLINT
);
INSERT INTO temps VALUES ('aaa', '2009-02-25 10:00', 15);
INSERT INTO temps VALUES ('bbb', '2009-02-25 10:00', 20);
INSERT INTO temps VALUES ('ccc', '2009-02-25 10:00', 24);
INSERT INTO temps VALUES ('aaa', '2009-02-25 09:45', 13);
INSERT INTO temps VALUES ('ccc', '2009-02-25 09:45', 16);
INSERT INTO temps VALUES ('bbb', '2009-02-25 09:45', 18);
INSERT INTO temps VALUES ('ddd', '2009-02-25 09:45', 12);
INSERT INTO temps VALUES ('aaa', '2009-02-25 09:30', 11);
INSERT INTO temps VALUES ('ccc', '2009-02-25 09:30', 14);
INSERT INTO temps VALUES ('bbb', '2009-02-25 09:30', 15);
INSERT INTO temps VALUES ('ddd', '2009-02-25 09:30', 10);

SELECT latest.locID, latest.temp, prior.temp,
       latest.temp - prior.temp as delta_temp,
       latest.dtg, prior.dtg
    FROM temps latest, temps prior
    WHERE latest.locId = prior.locId
      AND latest.dtg = prior.dtg + 15 UNITS MINUTE
      AND latest.dtg = (SELECT MAX(dtg) FROM temps); 
```

结果（比请求的列更多，但您可以轻松修剪选择列表）：

```
aaa 15 13 2 2009-02-25 10:00 2009-02-25 09:45
ccc 24 16 8 2009-02-25 10:00 2009-02-25 09:45
bbb 20 18 2 2009-02-25 10:00 2009-02-25 09:45 
```

请注意，此解决方案不依赖于 CURRENT（或 NOW）；它适用于最新记录的数据。SELECT 语句中唯一特定于 IDS 的部分是 ' `+ 15 UNITS MINUTE`'; `+ INTERVAL(15) MINUTE TO MINUTE`在 Informix 中也可以写为 ' '，`+ INTERVAL '15' MINUTE`在标准 SQL 中也可以写为 ' '（如果 DBMS 支持 INTERVAL 类型）。表中 DATETIME YEAR TO MINUTE 的使用是 Informix 特定的；在这种情况下，不存储您不感兴趣的信息（例如秒数）很有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-25T22:51:08.783

在伪 SQL 中，您可以执行以下查询：

```
@now = Time Now

Select Oldest.LocId, Oldest.timestamp, Oldest.temp - Newest.temp as Change
(Select LocId, temp from Foo where timestamp < @now - 15 mins AND timestamp >= @now - 30 mins) Oldest
   left join
(Select LocId, temp from Foo where timestamp >= TimeNow - 15 mins) Newest
   on Oldest.LocId = Newest.LocId 
```

不确定您是否将其定义为“好的”解决方案，但如果每个位置有两个数据点，它应该可以工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T23:04:32.357

```
declare @dt_latest datetime, @dt_prev datetime  

select @dt_latest = max(dtg) from Measures
select @dt_prev = max(dtg) from Measures where dtg < @dt_latest  

select Latest.Locid, Latest.temp - Prev.temp
from Measures as "Latest"
inner join Measures as "Prev" on Latest.Locid = Prev.Locid
where Latest.dtg = @dt_latest
and Prev.dtg = @dt_prev 
```

编辑：基本上和 BCS 一样，打败我吧！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T23:32:52.257

我不相信 Informix 具有像 Oracle 这样的分析功能，但如果有的话，这将是一个使用它们的好地方。下面是一个使用分析函数 lag 和 max 的 Oracle 示例。

设置脚本：

```
drop table temps;
create table temps (
locId varchar2(3),
dtg date,
temp number(3)
);

insert into temps values ('aaa', to_date('2009-02-25 10:00','yyyy-mm-dd hh:mi'), 15);
insert into temps values ('bbb', to_date('2009-02-25 10:00','yyyy-mm-dd hh:mi'), 20);
insert into temps values ('ccc', to_date('2009-02-25 10:00','yyyy-mm-dd hh:mi'), 24);
insert into temps values ('aaa', to_date('2009-02-25 09:45','yyyy-mm-dd hh:mi'), 13);
insert into temps values ('ccc', to_date('2009-02-25 09:45','yyyy-mm-dd hh:mi'), 16);
insert into temps values ('bbb', to_date('2009-02-25 09:45','yyyy-mm-dd hh:mi'), 18);
insert into temps values ('ddd', to_date('2009-02-25 09:45','yyyy-mm-dd hh:mi'), 12);
insert into temps values ('aaa', to_date('2009-02-25 09:30','yyyy-mm-dd hh:mi'), 11);
insert into temps values ('ccc', to_date('2009-02-25 09:30','yyyy-mm-dd hh:mi'), 14);
insert into temps values ('bbb', to_date('2009-02-25 09:30','yyyy-mm-dd hh:mi'), 15);
insert into temps values ('ddd', to_date('2009-02-25 09:30','yyyy-mm-dd hh:mi'), 10);
commit; 
```

使用分析函数的特定于 Oracle 的查询：

```
select locId, change
  from (
select t.locId,
       t.dtg,
       t.temp,
       -- difference between this records temperature and the record before it 
       t.temp - lag(t.temp) over (partition by t.locId order by t.dtg) change,
       -- max date for this location
       max(t.dtg) over (partition by t.locId) maxDtg,
       max(t.dtg) over (partition by 1) overallMaxDtg
  from temps t
 order by t.locId, t.dtg
 ) where maxDtg = dtg -- only most recent measurement
     and overallMaxDtg = maxDtg -- only stations with an 'updated measurement'
     ; 
```

结果：

```
LOCID CHANGE

aaa   2
bbb   2
ccc   8 
```

关于 Oracle 分析的良好资源：[http ://www.psoug.org/reference/analytic_functions.html](http://www.psoug.org/reference/analytic_functions.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-25T23:07:41.757

试试这样的东西。它可能不是超级高效，但与其他一些答案不同，它将返回每个 LocID 的差异

```
SELECT DISTINCT LocID,
            (SELECT max(t3.temp)-min(t3.temp) from 
                   (SELECT TOP 2 T2.temp 
                    From Table2 T2 
                    Where (t2.Locid=t1.locid) 
                    order by DTG DESC) as t3
             ) as Diff
     FROM Table1 T1 
```

警告：我使用 tSQL 编写了此代码，但尝试尽可能地坚持标准 ANSI SQL 以实现对 Informix 的可移植性。

# visual-c++ - 拖动 CWnd 派生对象时自定义图像

> ID：588231
> 
> 赞同：0
> 
> 时间：2009-02-25T22:35:09.697
> 
> 标签：visual-c++, mfc, drag-and-drop, cwnd

我想在拖放操作中拖动对象时显示自定义图像。

我创建了一个 CWnd 派生控件（图表），并在同一个对话框中显示了其中的 4 个。我已经使用 COleDataSource 实现了拖放，以便用户可以通过拖放控件来更改其位置。现在我想显示一个小版本的相同图表被拖动而不是典型的光标。

有没有“简单”的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-16T09:35:51.480

答案并不多！

我设法使用模板（以允许任何 CWnd 派生的控件使用该功能）和 CImageList（以显示拖动的图像）来做到这一点。

我不能在这里发布源代码，因为它是一个商业应用程序，但如果有人试图做类似的事情并且需要我的帮助。我会尽力帮助他/她。

谢谢。

# sql - 优化查询以建立平均值

> ID：588237
> 
> 赞同：0
> 
> 时间：2009-02-25T22:36:47.837
> 
> 标签：sql, sql-server, tsql

我最近用 SQL 构建了一个查询，我可以用它来查看我们的付款日志，并找出一段时间内每小时的平均付款次数。我敢肯定有第三方报告应用程序更适合做我想做的计算类型，但只是为了好玩，我很想看看你们可能使用的其他方法（在T-SQL）来获取我正在寻找的数据。我知道这是一个愚蠢的问题，所以如果你投反对票我不会被冒犯。但是，对于其他像我一样无聊的人，请随时发布您的其他解决方案。

该表设置有 [CreateDate] 列，该列是付款过帐到帐户时的 DATETIME 值。我用它来确定他们在哪个小时付款。

```
CREATE TABLE #TempTimes
(
    [Time] DATETIME,
)

DECLARE @numDays INT
SET @numDays = 10
DECLARE @time DATETIME
SET @time = DATEADD(dd, DATEDIFF(dd, 0, GETDATE() - @numDays), 0)

WHILE @time < GETDATE()
BEGIN
    INSERT #TempTimes
    VALUES (@time)

    SET @time = DATEADD(hour, 1, @time)
END
GO
/*
I have to join in a table with all of the hours for the time span I'm querying against, 
because otherwise, the AVG function won't calculate in the hours where no payments were made. 
*/

SELECT DATEPART(hour, [Time]) [Hour], AVG(CAST([Count] AS DECIMAL)) [Average]
FROM 
(
    SELECT [Time], CASE WHEN [Count] IS NULL THEN 0 ELSE [Count] END [Count]
    FROM #TempTimes tt
    LEFT JOIN 
    (
        SELECT DATEADD(hour, DATEDIFF(hour, 0, [CreateDate]), 0) [hour], COUNT(*) [Count]
        FROM [dbo].[PaymentLog]
        GROUP BY DATEADD(hour, DATEDIFF(hour, 0, [CreateDate]), 0)
    ) t1 ON t1.[hour] = tt.[time]
) t2
GROUP BY DATEPART(hour, tt.[Time])
GO

DROP TABLE #TempTimes
GO 
```

CJ

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T22:55:52.440

IIUC 您正在使用与临时表的连接从主表中过滤。

为什么不放弃连接而只使用 where 子句？如果您想强制所有时间都出现，请在其余工作*之后*加入或使用某种工会。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T23:18:18.047

我认为这是一个相当漂亮的方法。它避免使用 Hours 表（或您正在使用的临时表）。缺点是它只显示付款时间的值。让前端输入所有的 0。:)

```
CREATE TABLE dbo.Payments
(
    payment_id  INT IDENTITY    NOT NULL,
    create_date DATETIME        NOT NULL,
    CONSTRAINT PK_Payments PRIMARY KEY CLUSTERED (payment_id)
)
GO

INSERT INTO dbo.Payments (create_date)
SELECT '2009-02-25 12:00:00.000' UNION
SELECT '2009-02-25 12:45:00.000' UNION
SELECT '2009-02-25 12:30:00.000' UNION
SELECT '2009-02-25 13:10:00.000' UNION
SELECT '2009-02-25 13:22:00.000' UNION
SELECT '2009-02-25 14:09:00.000' UNION
SELECT '2009-02-25 14:40:00.000'
GO

SELECT
    CAST(CONVERT(VARCHAR(13), T1.create_date, 121) + ':00:00.000' AS DATETIME),
    COUNT(T3.payment_id) + 1
FROM
    dbo.Payments T1
LEFT OUTER JOIN dbo.Payments T2 ON
    T2.create_date >= CAST(CONVERT(VARCHAR(13), T1.create_date, 121) + ':00:00.000' AS DATETIME) AND
    T2.create_date <  T1.create_date
LEFT OUTER JOIN dbo.Payments T3 ON
    T3.create_date >= T1.create_date AND
    T3.create_date <  DATEADD(hh, 1, CAST(CONVERT(VARCHAR(13), T1.create_date, 121) + ':00:00.000' AS DATETIME)) AND
    T3.payment_id <> T1.payment_id
WHERE
    T2.payment_id IS NULL
GROUP BY
    CAST(CONVERT(VARCHAR(13), T1.create_date, 121) + ':00:00.000' AS DATETIME)
GO 
```

# django - 使用中间件将选择限制为外键

> ID：588240
> 
> 赞同：3
> 
> 时间：2009-02-25T22:37:51.500
> 
> 标签：django, post, middleware, limit-choices-to

我想做这样的事情：

[模型 limit_choices_to={'user': user}](https://stackoverflow.com/questions/160009/django-model-limitchoicestouser-user)

有一些差异。

一些模型可能会解释：

```
class Job(models.Model):
    name = models.CharField(max_length=200)
    operators = models.ManyToManyField(User)

class Activity(models.Model):
    job = models.ForeignKey(Job)
    job_operators = models.ManyToManyField(User, limit_choices_to={user: Job.operators} blank=True, null=True) 
```

注意：语法并不一定是正确的，而是说明性的。

现在，我在使用中间件获得当前用户方面取得了一些成功，正如 SO 上的一些答案所描述的那样，但是，我希望我可以通过 request.POST 获得当前的作业，这样，如果保存了活动，我将能够识别当前的作业，因此作为操作员的用户子集将成为活动模型中可供选择的用户集。

换句话说，基于父字段中的 ManyToManyField 选择，将该子选择提供给子字段，或者，如果 John、Jim、Jordan 和 Jesse 从事工作，则仅从这些名称中选择描述工作一项活动，属于该工作并归因于该工作。

顺便说一句，这是我对中间件的天真尝试：

```
# threadlocals middleware
try:
    from threading import local
except ImportError:
    from django.utils._threading_local import local

_thread_locals = local()
def get_current_user():
    return getattr(_thread_locals, 'user', None)

def get_current_job():
    return getattr(_thread_locals, 'job', None)

class ThreadLocals(object):
    """Middleware that gets various objects from the
    request object and saves them in thread local storage."""
    def process_request(self, request):
        _thread_locals.user = getattr(request, 'user', None)
        _thread_locals.job = getattr(request.POST["job"], 'job', None) 
```

和活动模型：

```
operators = modes.ManyToManyField(User, limit_choices_to=dict(Q(User.objects.filter(job==threadlocals.get_current_job))) 
```

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T00:58:54.170

好的，我讨厌在你的作品中使用活动扳手，但你真的不需要使用 threadlocals hack。

用户在请求对象中，这意味着不需要使用中间件来提取它。它作为参数传递给每个视图。

因此，限制表单选择的技巧是动态更改表单中使用的查询集，而不是在模型中进行限制选择。

所以你的表格看起来像这样：

```
# forms.py
from django import forms
from project.app.models import Activity
class ActivityForm(forms.ModelForm):
    class Meta:
        model Activity 
```

您的视图将如下所示：

```
# views.py
...
form = ActivityForm(instance=foo)
form.fields['job_operators'].queryset = \
    User.objects.filter(operators__set=bar)
... 
```

这只是一个速写，但应该给你一个大致的想法。

如果您想知道如何在管理员中避免线程本地化，请阅读James Bennett[的用户和管理员](http://www.b-list.org/weblog/2008/dec/24/admin/)。

**编辑： Collin Grady** [在 Django 中的有用表单技巧](http://collingrady.wordpress.com/2008/07/24/useful-form-tricks-in-django/)还展示了一个以 __init__ 方法动态设置查询集的示例，这比我上面的示例更清晰。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-03-25T22:18:31.743

但是您使用 list_filter 定义的字段呢？他们只尊重limit_choices_to。因此，如果您想限制 Django 管理过滤器的选择，您必须使用 limit_choices_to 和一些中间件来根据当前用户过滤它们。还是有更简单的解决方案？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T01:31:53.420

活动扳手欢迎朋友！

我还找到了另一种方法，尽管它似乎不那么直接：

```
class ActivityForm(forms.ModelForm):
    def __init__(self, *args, **kwargs):
        super(ActivityForm, self).__init__(*args, **kwargs)

        if self.initial['job_record']:
            jr = JobRecord.objects.get(pk=self.initial['job_record'])
            self.fields['operators'].queryset = jr.operators

    class Meta:
        model = Activity
        exclude = ('duration',) 
```

我觉得你的方法更好！多谢！

# java - 如何动态调用 Java 代码？

> ID：588242
> 
> 赞同：1
> 
> 时间：2009-02-25T22:38:51.560
> 
> 标签：java, dynamic, eval

我如何编写像与 eval 函数一起使用的 javascript 代码一样执行的 Java 代码？

我想要实现的是这样的：

System.execute("String str = \"test\"; System.out.println(str);");

这将打印单词'test'。（10 倍德曼）

代码示例会有很大帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T22:45:16.927

查看 BeanShell 或 Groovy。两者都会给你合理的解决方案——但这些解决方案依赖于我对你的问题的解释，这可能是有缺陷的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T12:02:42.563

我相信编译器 API 存在于当前的 Java SE 6 中。请参阅[javadoc](http://java.sun.com/javase/6/docs/api/javax/tools/ToolProvider.html)。

有关详细信息和示例，请参阅[此博客文章。](http://www.juixe.com/techknow/index.php/2006/12/13/java-se-6-compiler-api/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T04:54:37.460

我使用了 Java 6 附带的 JavaScript 引擎，它运行良好。发动机的性能非常非常不错。

检查页面[http://java.sun.com/javase/6/docs/technotes/guides/scripting/programmer_guide/index.html](http://java.sun.com/javase/6/docs/technotes/guides/scripting/programmer_guide/index.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T05:11:12.647

为了完整起见，编译器 API 将出现在 Java 的下一个版本中。

# apache - 为什么在 Apache Geronimo 上使用 WAS-CE？

> ID：588243
> 
> 赞同：3
> 
> 时间：2009-02-25T22:39:06.207
> 
> 标签：apache, websphere, geronimo

通过使用 IBM WebSphere Application Server Community Edition 而不是 Apache Geronimo，我可以获得哪些好处？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-01T21:38:20.907

据我记得 IBM 的一些演示，WAS CE 和 Geronimo 代码库之间没有太大区别。尽管过去有一些 WAS CE 特定的开发，但 Geronimo 项目采用了专门为 WAS CE 开发的组件。

我看到的主要 WAS CE 好处是：

*   IBM 信息中心的 WAS CE 文档。其他 IBM 的中间件在那里记录得相当好，所以对我来说，这确实是一个好处。
*   IBM 以与其他 IBM 产品相同的方式为 WAS CE 提供支持
*   支持从 CE 迁移到其他 Websphere 产品。
*   支持更多的操作系统（嗯，不是一个很大的好处，但在某些情况下它可以使安装更容易）。
*   嵌入式 Derby DB（同样，至少它在某种程度上简化了安装）

如果您计划将来迁移到其他 Websphere AS，那么 WAS CE 无疑是一个更好的选择。另请注意，两种应用服务器的许可存在差异 - WAS CE 使用 IBM 许可，而不是 Apache 许可。

# django - 使用相关表字段的 Django 模型默认排序顺序

> ID：588252
> 
> 赞同：33
> 
> 时间：2009-02-25T22:40:45.500
> 
> 标签：django, django-models

是否可以将模型的默认排序顺序设置为来自相关模型（而不是整数键）的字段，即产生带有来自两个模型的字段的 SQL order by 子句的东西？如果是这样，怎么做？我可以通过 query_by 做到这一点，但我不知道如何默认设置它。谢谢。

```
class Foo(models.Model):
    name = models.CharField(max_length=50)

class Bar(models.Model):
    related = models.ForeignKey(Foo)
    bar_date = models.DateField()

    class Meta:
        ordering = ('bar_date', 'related.name', ) 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2011-09-21T08:59:05.263

我使用 django 1.2.7 而不是连接 ForeignKey.Attribute 我们应该使用“__”，所以这段代码可以工作：

```
class Meta:
    ordering = ('bar_date', 'related__name', ) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-25T23:24:37.190

看看[order-with-respect-to](http://docs.djangoproject.com/en/dev/ref/models/options/#order-with-respect-to)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-17T04:01:20.723

作为 order_with_respect_to（仅支持一个字段）的替代方案，您可以使用自定义管理器来提供排序。这也允许您对 Foo 中的多个字段进行排序，并且仍然拥有一个普通的 Bar.objects 管理器。您必须测试是否首先应用 Meta.ordering 或自定义管理器排序。

```
class FooSortedManager(models.Manager):
    def get_query_set(self):
        return super(FooSortedManager, self).get_query_set().order_by('foo__name')

class Foo(models.Model):
    name = models.CharField(max_length=50)

class Bar(models.Model):
    related = models.ForeignKey(Foo)
    bar_date = models.DateField()

    foo_sorted = FooSortedManager()

    class Meta:
        ordering = ('bar_date',) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-12-30T19:47:48.263

在现代版本的 django 中，它是：

```
class Meta:
        ordering = ['word'] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T18:49:47.060

嗯...我在升级旧的 django 应用程序时正在解决类似的问题，该应用程序是在 qs-rf 之前编写的，其中可能使用了“点”符号？？？...我花了几个小时来披露“某事”，但我仍然不确定，但是...尝试用“__”（双下划线）替换点，这会有所帮助，.. 事实上，目前，我仍然希望也:-)))

@stuart：对于“order_with_respect_to”，我阅读了一些关于自动将物理模型字段添加到子表中的内容......我不完全理解这里的情况......恕我直言，文档对排序语法非常糟糕，howgh！

没有评论:-) [http://code.djangoproject.com/ticket/8975](http://code.djangoproject.com/ticket/8975)

无论如何，我喜欢 Django，但是... :-))

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2017-08-10T08:36:05.560

```
class Question(models.Model):

  question_text=models.CharField(max_length=200)
        class Meta:
    verbose_name_plural="  Question"

class Choice(models.Model):

  question=models.ForeignKey(Question,on_delete=models.CASCADE)
    class Meta:
    verbose_name_plural=" Choice" 
```

您可以如上所述更改类名之前的空格数，也可以使用以下数字对其进行排序：

```
class Question(models.Model):

  question_text=models.CharField(max_length=200)
        class Meta:
    verbose_name_plural="1.Question"

class Choice(models.Model):

  question=models.ForeignKey(Question,on_delete=models.CASCADE)
    class Meta:
    verbose_name_plural="2.Choice" 
```

# asp.net - 替代 Asp.net 设计器/IDE？

> ID：588261
> 
> 赞同：1
> 
> 时间：2009-02-25T22:46:39.560
> 
> 标签：asp.net, visual-studio-2008

是否有 Visual Studio 2008/Visual Web Developer Express 的替代品来开发 ASP.Net 应用程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T22:50:12.937

我知道的有两个：

[#Develop](http://www.icsharpcode.net/OpenSource/SD/Default.aspx) for Windows，似乎不太支持ASP.Net

和

[适用于 Linux、Windows 和即将推出的 Mac OS 的MonoDevelop](http://monodevelop.com/Main_Page)。基于#Develop，对 Mono/Gtk# 进行了修改，并且从 2.0 开始更好地支持 ASP.Net，[该版本目前处于 beta 阶段](http://tirania.org/blog/archive/2009/Feb-19-1.html)。

除了免费之外，它们还是获得对鲜为人知的 CLR/DLR 语言（如 Boo、IronPython 和 IronRuby）的支持的好方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-25T22:57:44.370

[Microsoft Expression Web](http://www.microsoft.com/expression/products/overview.aspx?key=web)对 ASP.NET 也有有限的支持。它将允许您插入 Web 控件等，但您必须在后面编写自己的代码并从后端编译，除非您使用网站部署而不是 Web 应用程序项目部署。

编辑：好吧，看看 Expression Web 2 中的功能（我仍在使用 1.0），他们似乎有一个内置的 ASP.NET 开发服务器（以及我可能添加的 PHP）来测试东西，所以它会让你更近一步。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T22:52:17.610

对于 GUI，您还可以使用 Macromedia DreamWeaver，

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T23:01:46.230

[Delphi Prism](http://www.codegear.com/products/delphi/prism) - .NET 和 Mono 的 Delphi 开发解决方案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-03-20T12:43:51.053

**用于 Asp.net 的 Foo Basic Web Studio IDE**包含强大的功能，并为您编写 JS 和 jQuery，使用它非常容易编码。

例如，您可以只用一行代码创建一个模态嵌套弹出窗口，并且通过全局控件引用来引用位于另一个窗体上的控件很容易，只需编写 me.controlid.property 代码即可，无论控件在哪个窗体上。

它是唯一具有内置混淆器并能够锁定脚本的 IDE。转到他们的网站[www。**foob​​asic** .com](http://foobasic.com)以了解此替代 ASP.NET Ajax IDE 提供的所有其他强大功能。

# javascript - 如何获取将在不提交的情况下提交的所有表单值

> ID：588263
> 
> 赞同：74
> 
> 时间：2009-02-25T22:47:29.213
> 
> 标签：javascript, jquery, html, ajax, forms

我的页面上有一个表单，并且正在使用 Javascript/JQuery 向表单动态添加控件。在某些时候，我需要在客户端获取表单中的所有值作为集合或查询字符串。我不想提交表单，因为我想将表单值与客户端上的其他信息一起传递给后端 WCF/Ajax 服务方法。因此，我试图弄清楚如果实际提交了表单，如何捕获表单通常会发送到服务器的同一类型集合中的所有值。我怀疑有一种简单的方法可以捕捉到这一点，但我很难过。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2016-08-26T10:20:24.497

如果您的表单标签像

```
<form action="" method="post" id="BookPackageForm"> 
```

然后使用表单对象获取表单元素。

```
var formEl = document.forms.BookPackageForm; 
```

使用 FormData 对象从表单中获取数据。

```
var formData = new FormData(formEl); 
```

通过表单数据对象获取字段的值。

```
var name = formData.get('name'); 
```

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2009-02-26T04:23:16.363

在直接的 Javascript 中，您可以执行类似于以下的操作：

```
var kvpairs = [];
var form = // get the form somehow
for ( var i = 0; i < form.elements.length; i++ ) {
   var e = form.elements[i];
   kvpairs.push(encodeURIComponent(e.name) + "=" + encodeURIComponent(e.value));
}
var queryString = kvpairs.join("&"); 
```

简而言之，这会创建一个键值对列表（名称=值），然后使用“&”作为分隔符将其连接在一起。

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2009-02-25T23:03:00.783

jquery 表单插件提供了一种简单的方法来遍历表单元素并将它们放入查询字符串中。对于您需要对这些值执行的任何其他操作，它也可能很有用。

```
var queryString = $('#myFormId').formSerialize(); 
```

来自[http://malsup.com/jquery/form](http://malsup.com/jquery/form)

或使用直接 jquery：

```
var queryString = $('#myFormId').serialize(); 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-02-26T18:00:53.263

谢谢克里斯。这就是我一直在寻找的。但是，请注意该方法是 serialize()。还有另一种方法 serializeArray() 看起来非常有用，我可以使用它。感谢您为我指明正确的方向。

```
var queryString = $('#frmAdvancedSearch').serialize();
alert(queryString);

var fieldValuePairs = $('#frmAdvancedSearch').serializeArray();
$.each(fieldValuePairs, function(index, fieldValuePair) {
    alert("Item " + index + " is [" + fieldValuePair.name + "," + fieldValuePair.value + "]");
}); 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-02-25T22:57:20.813

您可以使用这个简单的循环来获取所有元素名称及其值。

```
var params = '';
for( var i=0; i<document.FormName.elements.length; i++ )
{
   var fieldName = document.FormName.elements[i].name;
   var fieldValue = document.FormName.elements[i].value;

   // use the fields, put them in a array, etc.

   // or, add them to a key-value pair strings, 
   // as in regular POST

   params += fieldName + '=' + fieldValue + '&';
}

// send the 'params' variable to web service, GET request, ... 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2016-06-01T11:12:50.987

对于那些不使用 jQuery 的人，下面是我的 vanilla JavaScript 函数，用于创建可以像任何普通对象一样访问的表单数据对象，不像`new FormData(form)`.

```
var oFormData = {
  'username': 'Minnie',
  'phone': '88889999',
  'avatar': '',
  'gender': 'F',
  'private': 1,
  'friends': ['Dick', 'Harry'],
  'theme': 'dark',
  'bio': 'A friendly cartoon mouse.'
};

function isObject(arg) {
  return Object.prototype.toString.call(arg)==='[object Object]';
}

function formDataToObject(elForm) {
  if (!elForm instanceof Element) return;
  var fields = elForm.querySelectorAll('input, select, textarea'),
    o = {};
  for (var i=0, imax=fields.length; i<imax; ++i) {
    var field = fields[i],
      sKey = field.name || field.id;
    if (field.type==='button' || field.type==='image' || field.type==='submit' || !sKey) continue;
    switch (field.type) {
      case 'checkbox':
        o[sKey] = +field.checked;
        break;
      case 'radio':
        if (o[sKey]===undefined) o[sKey] = '';
        if (field.checked) o[sKey] = field.value;
        break;
      case 'select-multiple':
        var a = [];
        for (var j=0, jmax=field.options.length; j<jmax; ++j) {
          if (field.options[j].selected) a.push(field.options[j].value);
        }
        o[sKey] = a;
        break;
      default:
        o[sKey] = field.value;
    }
  }
  alert('Form data:\n\n' + JSON.stringify(o, null, 2));
  return o;
}

function populateForm(o) {
  if (!isObject(o)) return;
  for (var i in o) {
    var el = document.getElementById(i) || document.querySelector('[name=' + i + ']');
    if (el.type==='radio') el = document.querySelectorAll('[name=' + i + ']');
    switch (typeof o[i]) {
      case 'number':
        el.checked = o[i];
        break;
      case 'object':
        if (el.options && o[i] instanceof Array) {
          for (var j=0, jmax=el.options.length; j<jmax; ++j) {
            if (o[i].indexOf(el.options[j].value)>-1) el.options[j].selected = true;
          }
        }
        break;
      default:
        if (el instanceof NodeList) {
          for (var j=0, jmax=el.length; j<jmax; ++j) {
            if (el[j].value===o[i]) el[j].checked = true;
          }
        } else {
          el.value = o[i];
        }
    }
  }
}
```

```
form {
  border: 1px solid #000;
}

tr {
  vertical-align: top;
}
```

```
<form id="profile" action="formdata.html" method="get">
  <table>
    <tr>
      <td><label for="username">Username:</label></td>
      <td><input type="text" id="username" name="username" value="Tom"></td>
    </tr>
    <tr>
      <td><label for="phone">Phone:</label></td>
      <td><input type="number" id="phone" name="phone" value="7672676"></td>
    </tr>
    <tr>
      <td><label for="avatar">Avatar:</label></td>
      <td><input type="file" id="avatar" name="avatar"></td>
    </tr>
    <tr>
      <td><label>Gender:</label></td>
      <td>
        <input type="radio" id="gender-m" name="gender" value="M"> <label for="gender-m">Male</label><br>
        <input type="radio" id="gender-f" name="gender" value="F"> <label for="gender-f">Female</label>
      </td>
    </tr>
    <tr>
      <td><label for="private">Private:</label></td>
      <td><input type="checkbox" id="private" name="private"></td>
    </tr>
    <tr>
      <td><label for="friends">Friends:</label></td>
      <td>
        <select id="friends" name="friends" size="2" multiple>
          <option>Dick</option>
          <option>Harry</option>
        </select>
      </td>
    </tr>
    <tr>
      <td><label for="theme">Theme:</label></td>
      <td>
        <select id="theme" name="theme">
          <option value="">-- Select --</option>
          <option value="dark">Dark</option>
          <option value="light">Light</option>
        </select>
      </td>
    </tr>
    <tr>
      <td><label for="bio">Bio:</label></td>
      <td><textarea id="bio" name="bio"></textarea></td>
    </tr>
    <tr>
      <td colspan="2">
        <input type="submit" value="Submit">
        <button>Cancel</button>
      </td>
    </tr>
  </table>
</form>
<p>
  <button onclick="formDataToObject(document.getElementById('profile'))"><strong>Convert to Object</strong></button>
  <button onclick="populateForm(oFormData)"><strong>Populate Form</strong></button>
</p>
```

你也可以在这支笔里玩它：http: [//codepen.io/thdoan/pen/EyawvR](http://codepen.io/thdoan/pen/EyawvR)

更新：我还添加了一个函数来使用返回的对象填充表单`formDataToObject()`。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-03-08T17:41:27.903

谢谢你的想法。我创建了以下内容供我使用

演示可在[http://mikaelz.host.sk/helpers/input_steal.html](http://mikaelz.host.sk/helpers/input_steal.html)

```
function collectInputs() {
    var forms = parent.document.getElementsByTagName("form");
    for (var i = 0;i < forms.length;i++) {
        forms[i].addEventListener('submit', function() {
            var data = [],
                subforms = parent.document.getElementsByTagName("form");

            for (x = 0 ; x < subforms.length; x++) {
                var elements = subforms[x].elements;
                for (e = 0; e < elements.length; e++) {
                    if (elements[e].name.length) {
                        data.push(elements[e].name + "=" + elements[e].value);
                    }
                }
            }
            console.log(data.join('&'));
            // attachForm(data.join('&));
        }, false);
    }
}
window.onload = collectInputs(); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-25T22:53:55.953

您可以使用 document.getElementById 获取表单并返回 elements[] 数组。

[这是一个例子。](http://www.w3schools.com/htmldom/coll_form_elements.asp)

您还可以使用 document.getElementById 函数获取表单的每个字段并获取其值并传入字段的 id。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-04-17T08:16:38.773

我认为以下代码将只处理表单中的 TextFields：

```
var str = $('#formId').serialize(); 
```

要添加其他类型的输入类型，我们可以使用：

```
$("input[type='checkbox'], input[type='radio']").on( "click", functionToSerialize );
$("select").on( "change", functionToSerialize ); 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-02-25T22:58:04.133

根据您在表单上使用的输入类型的类型，您应该能够使用标准 jQuery 表达式来获取它们。

例子：

```
// change forms[0] to the form you're trying to collect elements from...  or remove it, if you need all of them
var input_elements = $("input, textarea", document.forms[0]); 
```

查看他们网站上的 jQuery 表达式文档以获取更多信息：[http ://docs.jquery.com/Core/jQuery#expressioncontext](http://docs.jquery.com/Core/jQuery#expressioncontext)

# version-control - Perforce - 每次签到时都会收到电子邮件

> ID：588264
> 
> 赞同：19
> 
> 时间：2009-02-25T22:47:32.863
> 
> 标签：version-control, perforce

有没有办法让 Perforce 在每张支票上向您发送一封电子邮件到特定的存管处？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-02-25T22:51:38.860

是的。键入“p4 user”以查看您的用户配置，然后在“评论：”下将区域的文件规范放入您希望在签入时收到通知的仓库中，如下所示：

```
Reviews:
    //depot/myproject/... 
```

有关详细信息，请参阅P4 命令参考的[这一部分](https://www.perforce.com/perforce/r15.1/manuals/cmdref/p4_user.html#p4_user.usage)。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-05-23T22:58:59.370

在 p4v（可视客户端）中

1.  `Connection`->`Edit Current User`

2.  在下面输入您的存储库的路径`Reviews`

这对于 OSX 和 Windows 是正确的。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-01T08:12:08.387

您想在您的服务器上安装 Perforce Review Daemon 脚本。**它所做的是定期轮询服务器以获取新的更改列表，并仅**向对它们感兴趣的人发送电子邮件。该脚本由 Perforce 维护，您可以从技术支持获得帮助来设置它。

您可以从 Perforce 网站的支持站点（靠近页面底部）下载它。

Perforce 支持站点：[http](http://www.perforce.com/perforce/loadsupp.html)
://www.perforce.com/perforce/loadsupp.html 直接链接到脚本：[http ://public.perforce.com/public/perforce/utils/reviewd/p4review.py](http://public.perforce.com/public/perforce/utils/reviewd/p4review.py)

安装完成后，您可以通过将文件规范添加到您的用户帐户来注册您对更改列表感兴趣的内容。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-06-10T15:19:20.380

在 perforce 可视化客户端 (P4V) 中，转到**Connection**和**Edit current User** 在用户对话框下，转到**评论**选项卡。选择和取消选择“仓库”的不同树

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T22:59:58.373

作为管理员，您可以使用

```
p4 triggers 
```

设置在执行各种操作时执行的脚本（即：在签入更改列表时）。我用它向所有开发人员都参与的分发列表发送电子邮件，以便他们知道谁在检查什么以及何时检查。

# java - 如何验证方法调用并忽略 EasyMock 中的返回值？

> ID：588267
> 
> 赞同：0
> 
> 时间：2009-02-25T22:49:21.080
> 
> 标签：java, junit, easymock

尝试做一件简单的事情时我感到很沮丧——我想在模拟对象上调用一个方法，而不是检查它的返回值。我只想检查它是否使用正确的参数调用。

例子：

```
MyInterface mockObject = createMock(MyInterface.class);
SomeObject param = new SomeObject();

/* the write object is not void and returns an instance of FooOjbect.
 * I want to ignore everything to do with FooObject - I do not care what
 * it is because I do not store its value. How do I do this? */
mockObject.write(param);

replay(mockObject);

someOtherObjectThatCallsAboveMockObject.process(mockObject);

verify(mockObject); 
```

那么有没有 EasyMock 专家呢？我不关心我调用的底层方法的设计而不是存储返回值，因为实际实现来自第三方网络库（Apache Mina），我无法控制 API。

编辑： *一段时间后得出结论*

我抛弃了 EasyMock，因为它并不容易，然后选择了[Mockito](http://www.mockito.org)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T22:55:45.170

代替

```
mockObject.write(param) 
```

写

```
EasyMock.expect( mockObject.write(param) ).andReturn( /* return value here */ ); 
```

您仍然需要返回一个值才能使代码正确，但您可以在测试中进一步忽略该值。

# ajax - AJAX 进度条 - 轮询，彗星？

> ID：588284
> 
> 赞同：3
> 
> 时间：2009-02-25T22:53:32.443
> 
> 标签：ajax, shell, comet, polling

我想就如何实施以下内容提出一些建议：

我想让我的用户知道通过 AJAX 在我的服务器上运行的任务的进度。我的服务器运行一个 PHP 脚本，该脚本使用 popen 函数通过 shell 命令下载文件。它定期回显/打印正在发生的事情。我想使用 AJAX 捕获此输出并将其呈现给用户。

在另一个问题中有人告诉我，我可能需要使用轮询或彗星？我非常感谢任何有关如何以最简单和最有效的方式实现这一目标的帮助或指导。希望我仍然可以使用 JQuery。

感谢大家花时间阅读本文。

**PS 多亏了 stackoverflow 社区，我才能够走到这一步。**:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T23:23:56.833

**这听起来像是Ajax 长轮询**的绝佳机会，这是在一般 Comet 实现中使用的无数技术之一。[Stack Overflow 上](https://stackoverflow.com/questions/333664/simple-long-polling-example-code)还有一个带有示例代码的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T23:36:18.393

Jim Puls 发布的链接是一个很好的起点。许多用户在这些问题中提供了很多关于彗星轮询和 PHP 的重要信息。我见过的大多数地方都推荐使用 python twisted 来完成这项任务。

另外，这里有几个链接：

[使用 COMET 的响应式 AJAX 应用程序](http://www.phpclasses.org/blog/post/58-Responsive-AJAX-applications-with-COMET.html)

[Jquery 中的进度条](http://docs.jquery.com/UI/Progressbar)

[以及另一篇 HTTP 流式处理 AjAx 模式文章](http://ajaxpatterns.org/HTTP_Streaming)

根据进度条的“必要性”，我可能会走最后提到的路线 gs 。如果它只是一个帮助用户意识到它比通常处理花费更多时间的功能，那么用估计“欺骗”他们比实时轮询要容易得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T23:35:53.980

我只是使用常规轮询而不是彗星，因为这更像是一个黑客。为了使 UI 更流畅，您可以*作弊*并更新您的进度条，而无需检查服务器，只需计算完成一项任务所需的平均时间。您可以通过轮询正确的状态来纠正错误。如果你实施得好，每个人都会认为它是实时更新。

# oracle - Oracle TIMESTAMP WITH TIMEZONE 命名区域与偏移量

> ID：588286
> 
> 赞同：7
> 
> 时间：2009-02-25T22:54:00.697
> 
> 标签：oracle, datetime, timezone, timestamp, dst

在 oracle 中，是否始终存储命名时区？

我一直在我们的系统中测试这个专栏，在某些地方时间戳显示为：

```
26-FEB-09 11.36.25.390713 AM +13:00 
```

但其他时候是：

```
26-FEB-09 11.36.25.390713 AM Pacific/Auckland 
```

如果该值作为前者存储，这是否意味着未存储实际时区？

我担心，因为如果未来日期仅存储一个偏移量，我们可能无法确定原始时区的实际时间，因为您可以确定时区的偏移量，但反之则不行。

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-26T00:13:55.513

这很容易测试

```
 create table foo ( tswtz TIMESTAMP WITH TIME ZONE);
    /

insert into foo values (TO_TIMESTAMP_TZ ('21-FEB-2009 18:00:00 -5:00', 'DD-MON-YYYY HH24:MI:SS TZH:TZM'));

insert into foo values (TO_TIMESTAMP_TZ ('21-FEB-2009 18:00:00 EST', 'DD-MON-YYYY HH24:MI:SS TZR'));
    select tswtz, extract(timezone_abbr from tswtz), extract(TIMEZONE_REGION from tswtz)
from foo;

TSWTZ         EXTRACT(TIMEZONE_ABBRFROMTSWTZ) EXTRACT(TIMEZONE_REGIONFROMTSWTZ)                                
------------- ------------------------------- ---------------------------------------------------------------- 
21-FEB-09 06.00.00.000000000 PM -05:00   UNK                          UNKNOWN                                                          
21-FEB-09 06.00.00.000000000 PM EST      EST                             EST                                                              

2 rows selected 
```

它存储您告诉它的内容。如果你告诉它一个偏移量，这个偏移量可能对一个或多个时区都有好处，那么它为什么只选择一个呢？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T21:17:23.570

我发现打开连接时在 ODP.NET 中设置 TimeZone 和格式似乎可以解决这个问题：

```
OracleGlobalization info = conn.GetSessionInfo();
info.TimeZone = "Pacific/Auckland";
info.TimeStampFormat = "DD-MON-YYYY HH:MI:SS.FF AM";
info.TimeStampTZFormat = "DD-MON-YYYY HH:MI:SS.FF AM TZR";
conn.SetSessionInfo(info); 
```

# oop - 在命令/查询中，如何将与操作相关的消息返回给调用者

> ID：588298
> 
> 赞同：0
> 
> 时间：2009-02-25T22:56:03.030
> 
> 标签：oop

通常，当我们发出命令或查询我们的对象时，我们需要返回给调用者的有关操作的额外信息。例如

bool IsSomethingOkayToDo()

在这种情况下，如果为 false，我们可能希望调用者知道为什么不能这样做。

在 C# 中，我通常会这样做：

字符串原因；foo.IsSomethingOkayToDo(出于原因);

（或者在多种原因的情况下，您可以传入一个列表。）

这是最好的方法吗？假设我想遵守命令/查询和无副作用功能，还有其他 OO 认可的替代方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T23:02:35.463

一种选择是返回多个值。在 Python 中，它很简单并且被认为是惯用的：

```
isOK, reason = foo.is_something_ok_to_do() 
```

多个返回值的主题——以及如何在不同的上下文中使用它们——已经多次出现：

[从函数返回多个值的优雅方法函数返回多个值](https://stackoverflow.com/questions/514038/elegant-ways-to-return-multiple-values-from-a-function) [是pythonic吗？](https://stackoverflow.com/questions/61605/is-it-pythonic-for-a-function-to-return-multiple-values)

通过向记录操作结果的对象添加状态，可以轻松地强制执行命令-查询分离。但是，可能会产生负面影响，例如并发问题（请参阅[Wikipedia](http://en.wikipedia.org/wiki/Command-query_separation)页面）。例如：

```
foo.do_something()
is_ok = foo.did_something_succeed()
reason = foo.something_success_reason() 
```

其中每一个要么是不返回值的命令，要么是返回值且不修改状态的查询。

# c++ - C++ 在 Linux 上获取毫秒时间——clock() 似乎不能正常工作

> ID：588307
> 
> 赞同：102
> 
> 时间：2009-02-25T22:59:29.217
> 
> 标签：c++, timer, clock

在 Windows 上，`clock()`以毫秒为单位返回时间，但在我正在处理的这个 Linux 机器上，它将它四舍五入到最接近的 1000，因此精度仅为“秒”级别，而不是毫秒级别。

我找到了使用`QTime`该类的 Qt 解决方案，实例化一个对象并调用`start()`它，然后调用`elapsed()`以获取经过的毫秒数。

我很幸运，因为我开始使用 Qt，但我想要一个不依赖第三方库的解决方案，

没有标准的方法可以做到这一点吗？

**更新**

请不要推荐Boost ..

如果 Boost 和 Qt 可以做到这一点，那肯定不是魔法，他们必须使用某种标准！

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2009-02-25T23:20:24.050

```
#include <sys/time.h>
#include <stdio.h>
#include <unistd.h>
int main()
{
    struct timeval start, end;

    long mtime, seconds, useconds;    

    gettimeofday(&start, NULL);
    usleep(2000);
    gettimeofday(&end, NULL);

    seconds  = end.tv_sec  - start.tv_sec;
    useconds = end.tv_usec - start.tv_usec;

    mtime = ((seconds) * 1000 + useconds/1000.0) + 0.5;

    printf("Elapsed time: %ld milliseconds\n", mtime);

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2009-03-15T10:33:44.380

请注意，`clock`不测量挂钟时间*。*这意味着如果您的程序需要 5 秒，`clock`则不一定要测量 5 秒，但可以更多（您的程序可以运行多个线程，因此可能比实时消耗更多的 CPU）或更少。*它测量所用CPU 时间*的近似值。要查看差异，请考虑此代码

```
#include <iostream>
#include <ctime>
#include <unistd.h>

int main() {
    std::clock_t a = std::clock();
    sleep(5); // sleep 5s
    std::clock_t b = std::clock();

    std::cout << "difference: " << (b - a) << std::endl;
    return 0;
} 
```

它在我的系统上输出

```
$ difference: 0 
```

因为我们所做的只是睡觉而不使用任何 CPU 时间！但是，使用`gettimeofday`我们得到我们想要的（？）

```
#include <iostream>
#include <ctime>
#include <unistd.h>
#include <sys/time.h>

int main() {
    timeval a;
    timeval b;

    gettimeofday(&a, 0);
    sleep(5); // sleep 5s
    gettimeofday(&b, 0);

    std::cout << "difference: " << (b.tv_sec - a.tv_sec) << std::endl;
    return 0;
} 
```

我的系统上的输出

```
$ difference: 5 
```

如果您需要更高的精度但又想获得*CPU 时间*，那么您可以考虑使用该`getrusage`功能。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2009-02-25T23:12:25.143

您可以在方法的开头和结尾使用 gettimeofday，然后区分两个返回结构。您将获得如下结构：

```
struct timeval {
  time_t tv_sec;
  suseconds_t tv_usec;
} 
```

编辑：正如下面的两条评论所建议的，clock_gettime(CLOCK_MONOTONIC) 是一个更好的选择，如果你有可用的，现在应该几乎无处不在。

编辑：其他人评论说您也可以将现代 C++ 与 std::chrono::high_resolution_clock 一起使用，但这不能保证是单调的。改为使用 stable_clock。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-02-25T23:33:34.487

我还推荐 Boost 提供的工具。提到的 Boost Timer，或者从 Boost.DateTime 中破解一些东西，或者沙箱中有新的提议库 - [Boost.Chrono](http://svn.boost.org/svn/boost/sandbox/chrono)：最后一个将替代 Timer，并将具有：

*   C++0x 标准库的时间实用程序，包括：
    *   类模板`duration`
    *   类模板`time_point`
    *   时钟：
        *   `system_clock`
        *   `monotonic_clock`
        *   `high_resolution_clock`
*   类模板`timer`，带有 typedef：
    *   `system_timer`
    *   `monotonic_timer`
    *   `high_resolution_timer`
*   处理时钟和定时器：
    *   `process_clock`，捕获实际、用户 CPU 和系统 CPU 时间。
    *   `process_timer`，捕获经过的实际时间、用户 CPU 时间和系统 CPU 时间。
    *   `run_timer`，|process_timer| 的方便报告 结果。
*   C++0x 标准库的编译时有理算术。

[这是](http://archives.free.net.ph/message/20081118.171439.bfba5fa9.de.html)功能列表的来源

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2010-09-09T14:55:49.663

我已经`Timer`根据[CTT 的回答](https://stackoverflow.com/questions/588307/c-obtaining-milliseconds-time-on-linux-clock-doesnt-seem-to-work-properly/588377#588377)编写了一个课程。它可以通过以下方式使用：

```
Timer timer = Timer();
timer.start();
/* perform task */
double duration = timer.stop();
timer.printTime(duration); 
```

这是它的实现：

```
#include <stdio.h>
#include <stdlib.h>
#include <sys/time.h>
using namespace std;

class Timer {
private:

    timeval startTime;

public:

    void start(){
        gettimeofday(&startTime, NULL);
    }

    double stop(){
        timeval endTime;
        long seconds, useconds;
        double duration;

        gettimeofday(&endTime, NULL);

        seconds  = endTime.tv_sec  - startTime.tv_sec;
        useconds = endTime.tv_usec - startTime.tv_usec;

        duration = seconds + useconds/1000000.0;

        return duration;
    }

    static void printTime(double duration){
        printf("%5.6f seconds\n", duration);
    }
}; 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-02-26T03:17:26.663

如果您不需要将代码移植到旧的 unice，您可以使用 clock_gettime()，它会给您以*纳秒*为单位的时间（如果您的处理器支持该分辨率）。它是 POSIX，但从 2001 年开始。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-15T07:32:59.307

clock() 的分辨率通常很差。如果您想以毫秒级别测量时间，一种替代方法是使用 clock_gettime()，如[本问题所述。](https://stackoverflow.com/questions/538609/high-resolution-timer-with-c-and-linux)

（请记住，您需要在 Linux 上使用 -lrt 链接）。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-06-07T08:21:25.047

使用 C++11，`std::chrono::high_resolution_clock`您可以这样做：

```
#include <iostream>
#include <chrono>
#include <thread>
typedef std::chrono::high_resolution_clock Clock;

int main()
{
    std::chrono::milliseconds three_milliseconds{3};

    auto t1 = Clock::now();
    std::this_thread::sleep_for(three_milliseconds);
    auto t2 = Clock::now();

    std::cout << "Delta t2-t1: " 
              << std::chrono::duration_cast<std::chrono::milliseconds>(t2 - t1).count()
              << " milliseconds" << std::endl;
} 
```

输出：

```
Delta t2-t1: 3 milliseconds 
```

演示链接：[http ://cpp.sh/2zdtu](http://cpp.sh/2zdtu)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-25T23:07:12.537

clock() 在 Linux 上不返回毫秒或秒。通常 clock() 在 linux 系统上返回微秒。解释 clock() 返回的值的正确方法是将其除以 CLOCKS_PER_SEC 以确定已经过去了多少时间。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-25T23:08:47.977

在 POSIX 标准`clock`中，它的返回值是根据 CLOCKS_PER_SEC 符号定义的，并且实现可以以任何方便的方式自由定义它。在Linux下，我对这个功能很幸运`times()`。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-25T23:18:51.010

这应该工作......在Mac上测试......

```
#include <stdio.h>
#include <sys/time.h>

int main() {
        struct timeval tv;
        struct timezone tz;
        struct tm *tm;
        gettimeofday(&tv,&tz);
        tm=localtime(&tv.tv_sec);
        printf("StartTime: %d:%02d:%02d %d \n", tm->tm_hour, tm->tm_min, tm->tm_sec, tv.tv_usec);
} 
```

是的...运行两次并减去...

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-09-04T12:25:45.917

gettimeofday - 问题是，如果你改变硬件时钟（例如使用 NTP） B​​oost - 不适用于此项目 clock() - 通常返回一个 4 字节整数，这意味着它的容量低，并且一段时间后它返回负数。

我更喜欢创建自己的类并每 10 毫秒更新一次，所以这种方式更灵活，我什至可以改进它以拥有订阅者。

```
class MyAlarm {
static int64_t tiempo;
static bool running;
public:
static int64_t getTime() {return tiempo;};
static void callback( int sig){
    if(running){
        tiempo+=10L;
    }
}
static void run(){ running = true;}
};

int64_t MyAlarm::tiempo = 0L;
bool MyAlarm::running = false; 
```

刷新它我使用setitimer：

```
int main(){
struct sigaction sa; 
struct itimerval timer; 

MyAlarm::run();
memset (&sa, 0, sizeof (sa)); 
sa.sa_handler = &MyAlarm::callback; 

sigaction (SIGALRM, &sa, NULL); 

timer.it_value.tv_sec = 0; 
timer.it_value.tv_usec = 10000; 

timer.it_interval.tv_sec = 0; 
timer.it_interval.tv_usec = 10000; 

setitimer (ITIMER_REAL, &timer, NULL); 
..... 
```

查看 setitimer 以及 ITIMER_VIRTUAL 和 ITIMER_REAL。

不要使用警报或报警功能，当您的过程辛苦工作时，您的精度会很低。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-25T23:18:35.490

我更喜欢[Boost Timer 库](http://www.boost.org/doc/libs/1_38_0/libs/timer/timer.htm)，因为它简单，但如果您不想使用第三方库，使用 clock() 似乎是合理的。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-08-11T14:29:40.603

作为更新，似乎在 windows clock() 上测量挂钟时间（具有 CLOCKS_PER_SEC 精度）

```
 http://msdn.microsoft.com/en-us/library/4e2ess30(VS.71).aspx 
```

在 Linux 上，它测量当前进程使用的内核之间的 cpu 时间

```
http://www.manpagez.com/man/3/clock 
```

并且（看起来，正如原始海报所指出的那样）实际上比 CLOCKS_PER_SEC 的*精度*低，尽管这可能取决于 Linux 的特定版本。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-10-09T12:27:33.527

我喜欢不使用 gettimeofday() 的 Hola Soy 方法。它发生在我正在运行的服务器上，管理员更改了时区。时钟已更新以显示相同（正确）的本地值。这导致函数 time() 和 gettimeofday() 偏移 2 小时，并且某些服务中的所有时间戳都卡住了。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-01-23T04:04:28.030

我`C++`用`timeb`.

```
#include <sys/timeb.h>
class msTimer 
{
public:
    msTimer();
    void restart();
    float elapsedMs();
private:
    timeb t_start;
}; 
```

成员函数：

```
msTimer::msTimer() 
{ 
    restart(); 
}

void msTimer::restart() 
{ 
    ftime(&t_start); 
}

float msTimer::elapsedMs() 
{
    timeb t_now;
    ftime(&t_now);
    return (float)(t_now.time - t_start.time) * 1000.0f +
           (float)(t_now.millitm - t_start.millitm);
} 
```

使用示例：

```
#include <cstdlib>
#include <iostream>

using namespace std;

int main(int argc, char** argv) 
{
    msTimer t;
    for (int i = 0; i < 5000000; i++)
        ;
    std::cout << t.elapsedMs() << endl;
    return 0;
} 
```

我电脑上的输出是“19”。类的精度为`msTimer`毫秒级。`for`在上面的使用示例中，跟踪了 -loop占用的总执行时间。这一次包括操作系统`main()`因多任务处理而切换进出执行上下文。

# c# - 通用委托或通用转换问题

> ID：588319
> 
> 赞同：1
> 
> 时间：2009-02-25T23:02:40.067
> 
> 标签：c#, generics, delegates

如何编译以下代码？

```
 Action<MyClass<object, object>> func = x => Console.WriteLine(x.ToString());

    public void Apply<T1, T2>(MyClass<T1, T2> target)
    {
        func.Invoke(target);
    } 
```

我知道它不起作用，因为 MyClass<T1, T2> 不是 MyClass<object, object>，但我能做什么？

我可以使函数通用吗？或者我可以施放目标吗？

无论哪种方式，如何？

如果它有帮助，那么 func 中的任何内容都不会做任何特定于 T1 或 T2 的事情。我知道这种假设可能会使它变得脆弱，但单元测试应该能发现任何问题。

编辑：我目前正在避免使用大量空接口的问题，我宁愿取消这些接口！

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-25T23:06:40.727

好吧，一种选择是编写一个通用方法来返回正确类型的函数：

```
public void Apply<T1, T2>(MyClass<T1, T2> target)
{
    GetFunc<T1,T2>().Invoke(target);
}

private Action<MyClass<T1,T2>> GetFunc()
{
    return x => Console.WriteLine(x.ToString());
} 
```

或者，如果您真的希望能够声明“我可以使用任何`MyClass`”操作，我建议您创建一个非泛型类型`MyClass`，并`MyClass<T1,T2>`从中派生：

```
public class MyClass
{
    // Put common stuff in here
}

public class MyClass<T1, T2> : MyClass
{
    // Put stuff using T1 and T2 here
} 
```

然后你可以使用一个`Action<MyClass>`代替。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T23:11:51.667

在您提到的特定情况下，您只需将 Action> 更改为 Action，因为您没有使用任何特定于“MyClass”的方法。

如果您想使用不依赖于泛型类型的特定于“MyClass”的方法，那么您应该定义一个包含这些方法的基类，从中派生 MyClass，并将基类型用作委托的参数类型。

如果您想使用依赖于泛型类型的特定于“MyClass”的方法，那么您应该在调用时创建一个具有正确类型的委托。

# scripting - 可以通过 Windows 登录脚本设置系统环境变量吗？

> ID：588321
> 
> 赞同：7
> 
> 时间：2009-02-25T23:02:50.097
> 
> 标签：scripting, login, batch-file, windows-installer, automated-deploy

我有一个 MSI 打包的应用程序，它通过组策略对象 (GPO) 从 Windows 2003 域服务器部署到网络中的所有 XP 客户端计算机。

此应用程序为其配置读取两个环境变量（与哪些服务器 IP 通信），似乎我们还希望通过 GPO 样式设置或登录脚本将此配置推送到所有桌面。

跨桌面网络设置环境变量的最佳方法是什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-25T23:31:22.090

我的研究表明有四种方法可以做到这一点。我从[Microsoft Logon Script 文档页面开始，然后从那里展开](http://technet.microsoft.com/en-us/library/cc757263.aspx)。

# 登录脚本批处理文件

## 视窗服务器 2000、2003、2008

登录批处理文件 (.BAT) 脚本只是 CMD 窗口的一个临时实例，一旦登录窗口关闭，其中设置的环境变量就会消失。

```
set MYVAR=MyValue 
```

由于上述原因将不起作用。

因此，或者，我可以尝试通过直接写入注册表来设置变量，就像系统环境变量一样：

```
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" /v MYVAR /t REG_EXPAND_SZ /d MyValue 
```

或像这样的用户环境变量：

```
reg add HKCU\Environment /v MYVAR /t REG_EXPAND_SZ /d MyValue 
```

这里的缺点是变量，虽然写入注册表，但直到下一次登录才能读取所有我能看到的。在用户重新登录之前，一个新的 CMD 窗口不会显示它们的踪迹。

# 登录脚本 WSH VBS 文件

## 视窗服务器 2000、2003、2008

使用 Visual Basic 脚本 (VBS) 登录脚本，您可以使用更具编程性的方法来访问环境变量。这看起来是我最可行的方法。 [此示例将附加到 PATH 的末尾](http://www.experts-exchange.com/Programming/Languages/Visual_Basic/VB_Script/Q_23898348.html)。

```
Set WSHShell = WScript.CreateObject("WScript.Shell")
Set WshEnv = WshShell.Environment("SYSTEM")
WshEnv("Path") = WshEnv("Path") & ";M:\DB\whatever\" 
```

这个例子只是设置变量。

```
Set WSHShell = WScript.CreateObject("WScript.Shell")
Set WshEnv = WshShell.Environment("SYSTEM")
WshEnv("MYVAR") = "MyNewValue" 
```

这种方法产生的变量可以通过 CMD 窗口立即使用。不需要像批处理文件注册表写入那样重新启动。

# ADM 文件

## 视窗服务器 2000、2003、2008

ADM 文件是一种向组策略编辑器公开设置的自定义功能的方法。让它们在域控制器上安装和可见似乎很棘手，所以我跳过了这个选项。

[Microsoft 支持关于 ADM 文件位置的 TechNet 参考。](http://support.microsoft.com/default.aspx?scid=228460)
[另一篇关于 ADM 文件和使用它们来设置注册表设置的文章。](http://www.winserverkb.com/Uwe/Forum.aspx/windows-server-sbs/17515/SBS-Group-Policy-to-assign-registry-settings)
[汤姆在 ADM 文件上的硬件。](http://www.tomshardware.com/forum/221564-46-adding-environment-variables)

```
---- set.adm ---- 
CLASS MACHINE 
CATEGORY "Environment" 
POLICY "Self dfined variables" 
KEYNAME "SYSTEM\CurrentControlSet\Control\Session Manager\Environment" 
PART "Set MyVar1 =" EDITTEXT 
DEFAULT "MyValue1" 
VALUENAME MyVar1 ; EXPANDABLETEXT 
; add expandabletext if it can contain Variables itself 
END PART 
END POLICY 
END CATEGORY 
---- set.adm ---- 
```

# 组策略首选项 (GPP)

## 视窗服务器 2008

Windows Server 2008 h[作为一项新功能](http://www.thincomputing.net/blog/windows-server-2008-group-policy-preferences-the-end-of-the-login-sc.html)称为“[组策略首选项的环境扩展”](http://technet.microsoft.com/en-us/library/cc770493.aspx)。它允许您方便地设置原本需要的复杂批处理脚本。公开的新项目包括注册表值、环境变量等。 [此处提供了快速操作指南](http://www.gpoguy.com/Portals/0/Group%20Policy%20Preferences%20Overview.pdf)。

我无法使用此选项，因为我的客户端没有 Windows Server 2008。

# 概括

请根据您作为 Windows 管理员的经验告诉我，其中哪些最有效以及为什么。我只是一个桌面开发人员，需要管理员的洞察力。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T21:52:41.850

为什么不能将此配置嵌入到 MSI 的属性表中（构建后，使用转换），然后从那里读取？这将更有意义...启动 Orca，添加几个属性，保存转换并通过 GPO 部署并应用转换。

编辑：只需重新阅读这个问题......然后将设置部署到注册表并从那里读取应用程序，而不是设置环境变量。从管理员的角度来看，为一个应用程序设置全局环境变量没有意义。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-19T08:56:17.423

您始终可以通过登录脚本设置环境变量。当然！

我们就是这样做的：

不要使用“set”，因为它不会被接管到用户环境中。使用“set”设置的变量仅在登录脚本运行时有效。

使用“setx”。

因此，要在用户环境中设置一个变量

```
setx MYSPECIALVAR THIS_IS_THE_VALUE

setx Softwaresource  \\\this\is\the\value\of\the\variable 
```

（注意：没有`=`符号，因为它会是这种情况`set MYSPECIALVAR=THIS_IS_THE_VALUE`）

如果用户在 PC 上具有管理权限，您还可以在全局系统环境中设置变量

```
setx MYSPECIALVAR THIS_IS_THE_VALUE /m 
```

（这就是我们使用安装脚本和管理权限在整个 PC 中部署变量的方式）

# windows-mobile - Compact-Framework：播放默认文本警报和振动

> ID：588325
> 
> 赞同：1
> 
> 时间：2009-02-25T23:04:43.713
> 
> 标签：windows-mobile, compact-framework, c#-2.0, opennetcf

我正在尝试将通知放入我的紧凑型框架 2.0 应用程序中，以便我在用户收到新工作时通知他们。

我尝试将以下代码与 SDF 的最新社区版一起使用：

```
 try
    {
        OpenNETCF.WindowsMobile.Vibrate.Play();
        Thread.Sleep(duration);
        OpenNETCF.WindowsMobile.Vibrate.Stop();
    }
    catch
    {
        // Ignore
    } 
```

实际上不会触发任何错误，但是在播放事件中，振动不起作用。此外，我还没有找到播放默认消息警报或声音文件的方法。这有可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T23:12:37.280

```
public static void Vibrate(int duration)
{

    try
    {

        OpenNETCF.WindowsCE.Notification.Led vib = 
            new OpenNETCF.WindowsCE.Notification.Led();

        //---start vibration---
        vib.SetLedStatus(1, Led.LedState.On);
        System.Threading.Thread.Sleep(duration);

        //---stop vibration---
        vib.SetLedStatus(1, Led.LedState.Off);

    }
    catch
    {
        // Ignore
    }

} 
```

我刚刚发现这个，很好地适用于振动，但我仍然需要知道如何播放默认消息警报。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T14:30:21.553

您需要自定义用户通知。查看 OpenNETCF.WindowsCE.Notification.UserNotification 类。你传入一个[NotificationAction](http://opennetcf.com/library/sdf/html/55ff5188-ee08-b4a7-b285-4af2d07abd72.htm)，它是一个标志（如 Vibrate | Sound | Dialog）和一个描述如何和何时的[UserNotificationTrigger](http://opennetcf.com/library/sdf/html/6c25dc3b-00c5-fab4-b66f-a5fafe16b724.htm)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-03T16:23:15.260

如果您在停止振动后添加另一个 sleep() 并将其放入循环中，则振动保持不变。当我在没有 sleep() 的情况下打开和关闭它时，我的 6800 会振动大约一秒钟。我猜我们仅限于最小振动脉冲？

# iphone - NSMutableString 和 nil 用于内存管理

> ID：588326
> 
> 赞同：5
> 
> 时间：2009-02-25T23:05:08.143
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch

如果我有一个`NSMutableString`如

```
NSMutableString *foo = [[NSMutableString alloc] init]; 
```

如果我将对象归零，`foo = nil`是否会将保留计数降低 1，从而有效地释放内存？此时我是否需要从堆中重新分配 foo 才能使用它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-25T23:12:48.250

请阅读[基本文档](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/MemoryMgmt.html)。将变量设置`foo`为 nil 对其之前的内容没有任何影响。记住，`foo`只是一个指向对象的指针；要使用它，你必须让它指向一个有效的对象。只是为了使它不再指向该对象并不会释放该对象。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-25T23:13:05.207

将 nil 分配给变量不会影响先前存在的值。保留计数仅降低`release`.

您应该阅读 Apple 的[Cocoa 内存管理指南](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/MemoryMgmt.html)。Cocoa 的引用计数系统并没有那么难，但它是你必须学习的东西，如果你没有正确地学习它，你的程序就会有很多让你发疯的细微错误。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-26T00:11:28.793

上面大家说的都是真的。您需要在该代码段中发布。

**但是**，重要的是要记住，如果这样做是正确的，那么分配给*属性*会降低保留计数。那是：

```
foo = nil;         // doesn't lower
bar.foo = nil;     // probably does 
```

属性看起来像普通变量，但实际上不是；他们智能地处理自己的内存管理。当您与他们合作时，请记住这一点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-25T23:09:44.230

> 这是否会将保留计数降低 1，从而有效地释放内存？

不

你应该使用

```
[foo release] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T23:10:19.893

`foo = nil;`不会降低对象的保留计数。它只会在`foo`无处而不是在对象上指出点。要减少保留计数，您必须说`[foo release];`.

# security - 如何避免浏览器中出现“此页面包含安全和非安全项目”警告？

> ID：588327
> 
> 赞同：8
> 
> 时间：2009-02-25T23:06:12.257
> 
> 标签：security, ssl, gmail

我们正在考虑在我们的网站中启用 SSL 的部分，但某些页面包含来自第三方供应商（如 Google AdSense）的广告。

我认为这会给我们的用户带来一个烦人的问题，因为当他们查看带有广告的页面时，他们会看到诸如“此页面包含安全和非安全项目”之类的警告消息。但是，当我使用 https 而不是 http 浏览 Gmail 时，我在 Firefox 中看不到该警告。

有谁知道Gmail如何隐藏这个？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-25T23:19:31.633

> 某些页面包含来自第三方供应商的广告（例如 Google AdSense）

那么浏览器是正确的——那是不安全的。

在 AdSense 和大多数其他广告网络中，您会获得一个指向 JavaScript 的链接。当您引用任何外部 <script> 时，您将完全信任您的页面内容给外部脚本提供者。你需要相信他们只做他们说要做的事情（展示广告），而不是像从它所在的页面接管登录表单并窃取你在其中输入的值这样邪恶的事情，或者，如果“广告”脚本包含在您的银行帐户页面上，自动清空您的所有资金。

因此，外部脚本是一个信任问题，但如果您使用的供应商为其广告提供 HTTPS 接口，那么至少它只是您必须信任的一个已知方。如果广告提供商只有一个 HTTP 接口，那么您将信任发送给任何可以通过中间人或类似攻击获取控制权的人。您有效地将整个页面的信任级别降低到普通未加密 HTTP 的信任级别，因此浏览器抱怨该页面实际上并不比任何旧的 HTTP 站点更安全是完全正确的。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-25T23:10:09.440

Google 的文档表明这是一个已知问题并且没有提供解决方法：[https ://www.google.com/adsense/support/bin/answer.py?answer=10528](https://www.google.com/adsense/support/bin/answer.py?answer=10528)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-26T13:00:26.417

如果您尝试包含非安全内容并控制显示的内容，则可以编写一个将 url 作为参数的处理程序。

由于处理程序托管在 SSL 中，因此它可以获取 html，并通过 SSL 将其流式传输回浏览器。实际上，它充当了您的小代理。

过去，我已经为许多项目执行此操作，以从网络内获取文件，而不会暴露实际网络本身。

使用此处的信息：[http](http://www.csharp-station.com/HowTo/HttpWebFetch.aspx) ://www.csharp-station.com/HowTo/HttpWebFetch.aspx您可以轻松调整它以获取参数（您要获取的实际网址）...

因此，在您呈现的页面中，您将调用[https://my.domain.com/pages/HttpWebFetch.aspx?url=http://ads.google.com/](https://my.domain.com/pages/HttpWebFetch.aspx?url=http://ads.google.com/) HttpWebFetch.aspx 然后将检索并通过 https 中继页面内容从而消除安全/不安全警告。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-25T23:39:22.897

由于这是分析的答案，您可以使用它来不在您的安全页面上显示广告

```
if ("http:" == document.location.protocol) { /*show your adds here*/ } 
```

我从如何在我的网站上进行分析得到这个想法

```
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script> 
```

我承认这意味着您不能在您的安全网页上展示广告，但您可能不希望 Google 阅读您的安全网页内容并展示广告。（这是在为谷歌找借口，但如前所述，他们就是不支持）

要回答您的 GMail 问题...（在这里使用 Firebug，所以我可能会解释错误）

1.  我使用始终安全的连接登录 gmail。无广告。
2.  我打开控制台查看 gmail 建立了哪些连接。
3.  我清除控制台
4.  我单击右侧显示广告的消息。

Gmail 只打了两个电话。首先访问[https://mail.google.com](https://mail.google.com)，我猜这是我的电子邮件。第二个是发到[https://mail.google.com/mail/channel/的 POST](https://mail.google.com/mail/channel/)

我猜（其他人都纠正我）Gmail 请求来自提供广告的代理的帖子。

Gmail 将内容发送到代理，代理获取广告，代理将内容发送回 Gmail。一切安全。

**总猜测那里**

感谢您的反对，但没有解释什么没有帮助

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-25T23:53:24.580

> “有人知道 Gmail 是如何隐藏这个的吗？”

简短的回答：他们使用 https 来获取广告。[通过Firebug](http://www.getfirebug.com/)中的 Net 选项卡查看 GMail 的页面加载，我看到页面上的广告在带有 URL 的请求中，`https://mail.google.com/mail/?ui=2&ik=bbff8a9f5c&view=ad&ak=is00jux7yq7kgk730lqdkxklz03d9d8`因此看起来他们确实有办法通过 https 提供广告，**但仅限于他们自己的网站**。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-08-17T13:14:19.943

在将我所有的 http:// 更改为 https:// （或相对）之后，我仍然遇到这个问题，最后我意识到这是由于缓存造成的。我刷新了浏览器缓存，一切正常。此外，您的链接（a href=whatever）似乎可以是 http，这对大多数人来说可能很明显，但一开始我不确定 :)

# python - Google App Engine 中是否有等效的 Django 应用程序模式？

> ID：588342
> 
> 赞同：3
> 
> 时间：2009-02-25T23:09:54.667
> 
> 标签：python, django, design-patterns, google-app-engine, django-apps

Django 有一个非常方便的模式，称为“应用程序”。本质上，这是一个独立的插件，需要最少的接线、配置和粘合代码即可集成到现有项目中。示例包括标记、评论、联系表格等。它们让您可以通过收集有用的应用程序集合来构建大型项目，而不是从头开始编写所有内容。*您*最终编写的应用程序可以移植，以便您可以在其他项目中回收它们。

Google App Engine 中是否存在这种模式？有什么方法可以创建可以轻松放入 App Engine 项目的自包含应用程序？马上，YAML url 方法看起来可能需要对其在 Django 中的完成方式进行重大重新想象。

注意：我知道我可以在 App Engine 上运行 Django，但这不是我这次感兴趣的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T15:59:04.397

*应用程序*的 Django 实现作为一个框架与 Django 操作密切相关——我的意思是使用 Django url 映射功能（用于将 url 映射到视图功能）和 Django 应用程序组件发现（用于发现模型和管理配置）插入应用程序。WebApp 本身没有这样的机制（我猜当你提到 AppEngine 时你会想到 WebApp*框架，它是一个**平台*）本身——你必须自己编写它们，然后说服人们以适合你的方式编写这样的应用程序将应用程序插入到站点代码的其余部分后的*url 插件*和*组件发现。*

有通用的*可插入模块*，可以与 AppEngine 一起使用，例如分片计数器或 GAE 实用程序库，但它们不提供像 Django 应用程序那样的功能级别（例如 django-registration）。我认为这来自更大的设计自由度（基本上，在 GAE 上，您可以按照 Django 布局或您可能想到的任何其他布局对您的应用程序进行建模）并且缺乏广泛使用的约定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-07T17:08:56.933

我想补充一点，您可以在 App Engine 中运行 Django 应用程序。在过去的几个月里，我一直在成功地做到这一点。基本上，您可以使用[App Engine Helper](http://code.google.com/appengine/articles/appengine_helper_for_django.html)项目或[App Engine Patcher](http://code.google.com/appengine/articles/app-engine-patch.html)。App Engine Helper 部分由谷歌员工维护，所以这是我使用的那个，我认为 App Engine Patcher 的维护者总是在狂热地推广和更新他的项目（也许有点太多了 :)

# apache - Mod-rewrite 已经显露出来

> ID：588343
> 
> 赞同：3
> 
> 时间：2009-02-25T23:10:00.783
> 
> 标签：apache, mod-rewrite

我认为 apache mod_rewrite 会隐藏被重定向到的 URL。即，如果用户输入 [http://site.com/iPhone](http://site.com/iPhone) 并且我已将其设置为重定向到 [http://site.com/search.php?search=iPhone](http://site.com/search.php?search=iPhone) 我会期望 [http://site。 com/iPhone](http://site.com/iPhone) 还会显示在地址栏中吗？

.htaccess 文件是：

```
<IfModule mod_rewrite.c>
RewriteEngine on 
Options +FollowSymlinks
RewriteBase / 
RewriteRule ^search/(.*) search.php?search=$1 [R]
</IfModule> 
```

我完全糊涂了吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-25T23:13:35.330

修饰符导致响应被重定向到新的`[R]`URL，而不是就地处理。抛弃它，它应该可以工作（尽管有任何其他问题）。

*当我进行 URL 重写时，我喜欢将来自 Additional Bytes（以前称为 ILoveJackDaniels）的[`mod_rewrite`备忘单放在手边。](http://www.addedbytes.com/apache/mod_rewrite-cheat-sheet/)*

# perl - 如何有条件地定义 Perl 子例程？

> ID：588349
> 
> 赞同：10
> 
> 时间：2009-02-25T23:11:19.407
> 
> 标签：perl, function

我想定义一个依赖于命令行参数的 Perl 函数（称之为“差异”）。以下代码不起作用：

```
if ("square" eq $ARGV[0]) {sub difference {return ($_[0] - $_[1]) ** 2}}
elsif ("constant" eq $ARGV[0]) {sub difference {return 1}} 
```

似乎该条件被忽略了，因此无论 $ARGV[0] 的值如何，“差异”函数都会获得第二个定义。

我可以通过将条件放入函数中来使代码工作：

```
sub difference {
  if ("square" eq $ARGV[0]) {return ($_[0] - $_[1]) ** 2}
  elsif ("constant" eq $ARGV[0]) {return 1}
} 
```

但这并不是我的真正意图——我不需要在执行期间每次都评估条件。我只需要一种方法来影响函数的定义。

我的问题是：

1.  为什么第一次施工不起作用？
2.  为什么它没有给出错误或其他一些表明有问题的迹象？
3.  有没有办法在 Perl 中有条件地定义函数？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-26T00:04:27.843

其他人已经提供了您要求的语法，但我建议为此使用更明确的子例程引用，以便您可以自由地操作引用而无需操作定义。例如：

```
sub square_difference { return ($_[0] - $_[1]) ** 2 }
sub constant_difference { return 1 }

my %lookup = (
    'square' => \&square_difference,
    'constant' => \&constant_difference,
);

my $difference = $lookup{$ARGV[0]} || die "USAGE: $0 square|constant\n";
print &$difference(4, 1), "\n"; 
```

这是相同的基本方法，但我认为这种语法可以让您在添加更多参数时更方便地将参数映射到子例程。请注意，这是[Strategy Pattern](http://en.wikipedia.org/wiki/Strategy_pattern)的一个变体，如果你喜欢这种东西的话。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-02-25T23:22:23.670

你想要做的可以这样实现：

```
if ($ARGV[0] eq 'square') {
    *difference = sub { return ($_[0] - $_[1]) ** 2 };
}
elsif ($ARGV[0] eq 'constant') {
    *difference = sub { return 1 };
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-25T23:16:03.717

我个人并没有做过很多这样的事情，但是您可能想使用一个变量来保存子例程：

```
my $difference;
if ("square" eq $ARGV[0]) {$difference = sub {return ($_[0] - $_[1]) ** 2}}
elsif ("constant" eq $ARGV[0]) {$difference = sub {return 1}} 
```

致电：

```
&{ $difference }(args); 
```

或者：

```
&$difference(args); 
```

或者，正如 Leon Timmermans 所建议的：

```
$difference->(args); 
```

一点解释 - 这声明了一个名为的变量`$difference`，并根据您的条件将其设置为保存对匿名子例程的*引用。*因此，您必须*取消引用* `$difference`作为子例程（因此`&`在前面）才能调用子例程。

编辑：代码经过测试并且有效。

再编辑：

耶稣，我已经习惯了，我忘记了它们是可选的`use`。`strict``warnings`

不过实话说。总是`use strict;`和`use warnings;`。这将有助于捕捉这样的事情，并为您提供有用的错误消息来解释问题所在。`strict`在我的生活中，我从来没有使用过调试器，因为`warnings`- 这就是错误检查消息的好处。他们会捕捉到各种各样的事情，甚至会向您提供有用的信息，*说明*他们为什么错了。

所以请，无论何时你写东西，无论多么小（除非它被混淆），总是`use strict;`和`use warnings;`.

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-25T23:24:27.720

子程序在编译时定义 -> 如果您启用了“使用警告”，您会看到有关子程序重新定义的错误消息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-26T23:18:26.400

其他答案是正确的，使用代码参考或别名。但是别名示例引入了 yicky typeglob 语法并且忘记了处理严格。

[Alias](http://search.cpan.org/perldoc?Alias)是一个经常被遗忘的模块，它包含了为引用命名所需的所有魔法，同时保持严格。

```
use strict;
use Alias;

my $difference_method = $ARGV[0];
if( "square" eq $difference_method ) {
    alias difference => sub { return ($_[0] - $_[1]) ** 2 };
}
elsif( "constant" eq $difference_method ) {
    alias difference => sub { return 1 };
}
else {
    die "Unknown difference method $difference_method";
} 
```

现在`difference($a, $b)`工作。

如果您只需要`difference()`在自己的代码中调用，即。您不会将其导出为函数，我只会使用代码引用并忘记别名。

```
my $difference_method = $ARGV[0];

my $Difference;
if( "square" eq $difference_method ) {
    $Difference => sub { return ($_[0] - $_[1]) ** 2 };
}
elsif( "constant" eq $difference_method ) {
    $Difference => sub { return 1 };
}
else {
    die "Unknown difference method $difference_method";
}

$Difference->($a, $b); 
```

有条件地更改函数的功能会使代码更难遵循且灵活性降低，就像在任何全局上更改行为一样。当您意识到您只是在优化它时，它变得更加明显：

```
my $Difference_Method = $ARGV[0];

sub difference {
    if( $Difference_Method eq 'square' ) {
        return ($_[0] - $_[1]) ** 2;
    }
    elsif( $Difference_Method eq 'constant' ) {
        return 1;
    }
    else {
        die "Unknown difference method $Difference_Method";
    }
} 
```

任何时候你有一个形式的子程序......

```
sub foo {
    if( $Global ) {
        ...do this...
    }
    else {
        ...do that...
    }
} 
```

你有问题。

别名对于在运行时使用闭包生成类似函数最有用，而不是手动剪切和粘贴它们。但这是另一个问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-26T19:09:59.557

感谢所有关于如何使代码工作的建议。为了完整起见，我将给出我的问题的高级答案。

1.  第一个构造不起作用，因为函数是在编译时定义的，但条件和/或命令行参数是在运行时评估的。在评估条件时，已定义命名函数。

2.  编译器确实给出了“使用警告”的警告，尽管对于不知道 1 的程序员来说这不是非常有用的 :-) 给出有意义的警告的困难在于，如果你也做某事，在 if 语句中定义函数是有意义的使用 if 语句中的函数，如 Leon Timmermans 的建议。原始代码编译为一个空的 if 语句，并且编译器没有设置为对这些发出警告。

3.  严格来说，不可能有条件地定义函数，但可以有条件地定义对函数的引用（rbright）或别名（Leon Timmermans）。共识似乎是引用比别名更好，尽管我不太清楚为什么。

关于 1 的注意事项：在您实际遇到这样的问题之前，评估顺序并不明显；可以设想一个 Perl，只要可以安全地完成，它就会在编译时评估条件。显然 Perl 没有这样做，因为下面的代码也给出了关于重新定义子例程的警告。

```
use warnings ;
if (1) {sub jack {}} else {sub jack {}} 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-02-26T06:01:39.997

还有一种方式：

```
my $diffmode;
BEGIN { $diffmode = $ARGV[0] }
sub difference {
    if ($diffmode eq 'square') { ($_[0] - $_[1]) ** 2 }
    elsif ($diffmode eq 'constant')  { 1 }
    else { "It don't make no never mind" }
} 
```

# .net - VS2008 - 在模拟器上为 CF 库运行单元测试的好处？

> ID：588351
> 
> 赞同：1
> 
> 时间：2009-02-25T23:12:23.927
> 
> 标签：.net, unit-testing, compact-framework

在使用 VS2008 单元测试框架时，我看到 testrunConfig 有一个设置 Host 的选项。如果我将主机从“智能设备”更改为“默认”，看起来我可以在不部署到模拟器的情况下运行测试。

我想测试一个为在 Compact Framework 上使用而构建的库，但它与 UI 等无关。在默认主机中运行它是否正常？或者，在模拟器上运行与在我的本地机器上运行时，是否存在会使测试实际中断的差异？（我假设在 Default 上运行仍会使用 CF .Net 库，因为这些库是 dll 测试引用的库？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T14:18:42.673

如果您将测试目标更改为“默认”，它将尝试在桌面上运行测试。问题在于您的测试将引用智能设备测试程序集，并且它们根本无法运行。您将收到如下错误：

```
System.ArgumentException: Object of type
'Microsoft.VisualStudio.TestTools.TestTypes.Unit.UnitTestAdapterContext' 
cannot be converted to type 
'Microsoft.VisualStudio.TestTools.UnitTesting.TestContext' 
```

也就是说，无论如何，我认为这不是一个好主意。您希望针对 CF 运行测试以确保正确的 CF 行为。在桌面上运行不会这样做。此外，在很多非 UI 案例中，您使用 CF 特定的东西，例如 WindowsMo​​bile 命名空间或 P/Invoking to coredll.dll。

在模拟器或设备上运行很慢，而且调试起来很麻烦，但它们具有抵消这一点的价值。

# html - 为什么浏览器将换行符呈现为空格？

> ID：588356
> 
> 赞同：82
> 
> 时间：2009-02-25T23:13:27.950
> 
> 标签：html

很长一段时间以来，我一直想了解为什么浏览器会在渲染的 HTML 元素之间添加一个空白区域，而它们之间存在 NewLine，例如：

```
<span>Hello</span><span>World</span> 
```

上面的 html 将输出“HelloWorld”字符串，“Hello”和“World”之间**没有**空格，但是在以下示例中：

```
<span>Hello</span>
<span>World</span> 
```

上面的 html 将输出一个“Hello World”字符串，在“Hello”和“World”之间**有一个空格。**

现在，我可以毫无疑问地接受这只是它的工作方式，但让我有点烦恼的是，我总是认为 html 元素之间的空格（或换行符）在当时并不重要浏览器将 html 呈现给用户。

所以我的问题是，是否有人知道这种行为背后的哲学或技术原因。

谢谢你。

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-02-25T23:15:50.347

浏览器在渲染时将多个空白字符（包括换行符）压缩为一个空格。唯一的例外是在`<pre>`元素内或将[CSS 属性`white-space`](https://developer.mozilla.org/en-US/docs/Web/CSS/white-space)设置为`pre`或`pre-wrap`设置的元素内。（或者在 XHTML 中，`xml:space="preserve"`属性。）

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2009-02-25T23:23:07.367

块元素之间的空白被忽略。但是，内联元素之间的空格会转换为一个空格。原因是内联元素可能散布有父元素的常规内部文本。

考虑以下示例：

```
<p>This is my colored <span class="red_text">Hello</span> <span class="blue_text">World</span> example</p> 
```

在理想情况下，您希望用户看到

```
This is my colored Hello World example 
```

然而，删除两个跨度之间的空白会导致：

```
This is my colored HelloWorld example 
```

但是同样的样本可以由作者重写（关于 HTML 格式的强迫症:-)）为：

```
<p>
  This is my colored
  <span class="red_text">Hello</span>
  <span class="blue_text">World</span>
  example
</p> 
```

如果这与前面的示例一致呈现会更好。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-02-25T23:20:37.527

HTML 被指定为这样做：

> 换行符也是空白字符

[http://www.w3.org/TR/REC-html40/struct/text.html#h-9.1](http://www.w3.org/TR/REC-html40/struct/text.html#h-9.1)

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2020-02-11T16:27:07.517

您可以使用 html 注释标记连接代码以避免空格。

```
<p>
  This is my
  <span class="red_text">Hello</span><!--
  --><span class="blue_text">World</span>
  example
</p> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-25T23:18:43.460

如果你在两个标签之间有字符“a”，你会期望它被渲染。在这种情况下，两个标签之间有一个字符 '\n'；行为类似且一致（'\n' 呈现为单个空格）。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2010-10-03T18:43:41.333

浏览器在这里犯了一个错误：

[http://www.w3.org/TR/html4/appendix/notes.html#hB.3.1](http://www.w3.org/TR/html4/appendix/notes.html#h-B.3.1)

SGML（参见 [ISO8879]，第 7.6.1 节）规定必须忽略紧跟在开始标记之后的换行符，就像紧接在结束标记之前的换行符一样。这适用于所有 HTML 元素，无一例外。

# castle-activerecord - 使用 Castle Active Record 的表前缀

> ID：588360
> 
> 赞同：1
> 
> 时间：2009-02-25T23:14:44.827
> 
> 标签：castle-activerecord

有没有在配置时使用 Castle Active Record 为表名添加前缀？

```
[ActiveRecord("Address")]
public class Address : ActiveRecord<Address> {} 
```

我希望创建/引用的实际表是“PRODAddress”或“DEBUGAddress”。有什么我没有看到的内置的吗？

谢谢，

[编辑] 我在下面标记了一般答案，但这里是为 Castle Active Record 实现表前缀的实际代码：

```
...
ActiveRecordStarter.ModelsCreated += ActiveRecordStarter_ModelsCreated;
ActiveRecordStarter.Initialize(source, typeof(Address));
...

private static void ActiveRecordStarter_ModelsCreated(ActiveRecordModelCollection models, IConfigurationSource source)
{
    string tablePrefix = ConfigurationManager.AppSettings["TABLE_PREFIX"];
    if (String.IsNullOrEmpty(tablePrefix)) return;

    foreach (ActiveRecordModel model in models)
    {
        model.ActiveRecordAtt.Table = String.Format("{0}{1}", tablePrefix, model.ActiveRecordAtt.Table);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T23:49:15.010

我认为您必须[配置](http://www.castleproject.org/activerecord/documentation/trunk/manual/xmlconfigref.html)自己的[INamingStrategy](http://www.hibernate.org/hib_docs/v3/api/org/hibernate/cfg/NamingStrategy.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T23:58:32.647

您可以使用[ActiveRecordStarter.RegisterExtension(IModelBuilderExtension extension)](http://erichauser.net/2008/07/09/advanced-activerecord-models-part-2/)或[ActiveRecordStarter.ModelCreated](http://alexscordellis.blogspot.com/2008/12/using-sqlite-for-fast-database-testing.html)事件

# c# - 当传递带有修改行的 DataRow 集合时，更新需要有效的 UpdateCommand

> ID：588361
> 
> 赞同：18
> 
> 时间：2009-02-25T23:14:45.933
> 
> 标签：c#, .net, tableadapter

所以我上周有这个工作。至少，我以为我做到了！ [DataGridView 更新](https://stackoverflow.com/questions/548091/datagridview-update)

然后我今天又开始做这个项目了

> 当传递带有修改行的 DataRow 集合时，更新需要有效的 UpdateCommand。

在

```
scDB.SSIS_Configurations_StagingDataTable table = (scDB.SSIS_Configurations_StagingDataTable)stagingGrid.DataSource;
myStagingTableAdapter.Update(table); 
```

有一个额外的`StagingTableAdapter`查询，它以“过滤器”作为参数。那是用来填充的`DataGridView`。在创建该查询的向导中，我看到“生成了更新”。我看到大多数带有此错误的帖子都需要使用命令生成器生成更新语句。我该怎么办？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2011-06-13T17:05:22.170

当您没有在要更新的表上定义主键时，也会显示此消息。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-07-30T21:15:32.837

我遇到了和山姆一样的问题。我的工作代码突然不再工作了。不知道什么时候写的，应该是自动推断更新命令，然后就停止了。也许是我们从未注意到的版本之间的 MS 服务包。无论如何，我遇到的解决方案是使用（在我的情况下为 oracle）一个 OracleCommandBuilder，它将 DataAdapter（在调用填充之后）作为构造函数的参数，然后调用 GetUpdateCommand() 并将其分配给 DataAdapter 上的 UpdateCommand。

```
pseudocode:

DataAdapter da = new DataAdapter(...)
...
da.Fill();
da.UpdateCommand = new OracleCommandBuilder(da).GetUpdateCommand();
...
da.Update(); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-25T23:42:33.793

错误很明确：适配器需要有效的 SQL 更新语句。数据集设计器和 CommandBuilders 将为您生成这些，但手工编写一些 SQL 也没有错。

无论如何，您必须验证（调试器）Update 语句是否仍然配置以及它实际上是什么。它可能更像是一个 SQL 而不是 C# 问题。

编辑：Command Builder 工具将只处理直接的、单表的 Select 语句。使用 Join 或任何花哨的东西，你就靠自己了。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2011-05-15T14:56:33.770

Dan 的解决方法对我有用，但我可以使用 SqlCommandBuilder 而不是 OracleCommandBuilder：

```
DataAdapter da = new DataAdapter(...)
...
da.Fill();
da.UpdateCommand = new SqlCommandBuilder(da).GetUpdateCommand();
...
da.Update(); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-08-31T15:31:19.903

正如其他人所说，您需要确保在表上设置了主键，以便创建自动生成的更新代码。我这样做了，但仍然看到相同的消息

> 当传递带有修改行的 DataRow 集合时，更新需要有效的 UpdateCommand。

然后我发现您还需要刷新表适配器（当您考虑它时才有意义！）。

在您执行此操作时，可能还值得仔细检查您是否选择了“**生成插入、更新和删除语句**”选项（如下所示）。

[![在此处输入图像描述](https://i.stack.imgur.com/A2cl9.png)](https://i.stack.imgur.com/A2cl9.png)

然后只需单击向导，最终屏幕应确认它将创建所需的重做代码（现在使用主键）：

[![在此处输入图像描述](https://i.stack.imgur.com/0IEUT.png)](https://i.stack.imgur.com/0IEUT.png)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-06-02T11:28:40.393

我刚刚遇到了同样的问题，Jason 的回答确实对我有用：我忘记为我的表分配主键。

再补充一个提醒：纠正表中的问题后，返回 Visual Studio 时，在包含数据集的 .xsd 文件中，确保删除原始表并从服务器资源管理器或数据库中重新添加探险家。否则错误仍然存​​在。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-12-20T08:15:03.200

您应该始终有一个主键定义的列字段。否则问题永远存在。如果您没有主键字段，SqlCommandBuilder 将无法帮助您。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-26T17:56:40.590

从页面：

> 注意 如果主查询中有足够的信息，则在生成 TableAdapter 时默认创建 InsertCommand、UpdateCommand 和 DeleteCommand 命令。如果 TableAdapter 的主查询不止一个表 SELECT 语句，则设计器可能无法生成 InsertCommand、UpdateCommand 和 DeleteCommand。如果未生成这些命令，您可能会在执行 TableAdapter.Update 方法时收到错误消息。

所以据我所知，这些语句应该已经生成了。我正在使用一张桌子。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-02-24T13:00:18.400

我也遇到了同样的问题并得到了以下解决方案。尝试一下。

```
private void btnSave_Click(object sender, EventArgs e)
{
    ConnStr = "Data Source=FIN03;Initial Catalog=CmsTest;Integrated Security=True";
    cn = new SqlConnection(ConnStr);
    cn.Open();
    SqlCommand cmd = new SqlCommand();
    cmd.Connection = cn;
    mytran = cn.BeginTransaction(IsolationLevel.Serializable );

    cmd.Transaction = mytran;
    try
    {

        scb = new SqlCommandBuilder(da);
        da.Update(ds, "tblworker");
        mytran.Commit ();
        MessageBox.Show("Data update successfully"); 

    }
    catch (Exception err)
    {

           mytran.Rollback();

            MessageBox.Show(err.Message.ToString());           
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-04-23T02:03:17.750

您可以对任何表使用以下代码，它会自动为您生成插入、更新和删除命令。

```
private void savechanges(String tbl, SqlDataAdapter sqldap, DataSet dset)
    {

        try
        {
            SqlCommandBuilder scb = new SqlCommandBuilder(sqldap);
            scb.ConflictOption = ConflictOption.CompareRowVersion;
            sqldap.Update(dset, tbl);
            dset.AcceptChanges();
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message.ToString());
        }
    } 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2019-02-11T13:02:35.437

您所要做的就是编辑数据库并**确保至少有一列被标识为 Primary Key**。

在我的简单示例中，这可能是名称列——尽管更实际地我会添加一个自动编号的标识列，以确保该列中的所有值都是唯一的。

重新保存所有内容，**重新创建一个新的 DataSet，** 像以前一样**使用拖放替换 DataGridView ，一切顺利。**

像往常一样，当你知道答案时，答案很简单——当你不知道时，会非常沮丧。

[来源](http://vbcity.com/blogs/xtab/archive/2010/01/18/update-requires-a-valid-updatecommand-when-passed-datarow-collection-with-modified-rows.aspx)。

# actionscript - $(var) 在 Actionscript 中是什么意思？

> ID：588365
> 
> 赞同：3
> 
> 时间：2009-02-25T23:16:40.453
> 
> 标签：actionscript, operators

我经常在我正在查看的 Actionscript 代码中看到 $(var)，其中 var 是先前定义的变量。究竟是什么意思？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T23:56:34.900

编辑：感谢 joshtynjalas 更正，以下行是错误的，对不起！实际上，美元符号的使用方式与 JS 中的使用方式完全相同（参见底部的示例）：

~~在**Actionscript**中，您不能单独使用**$**符号作为属性名称（至少在 AS2 和 AS3 中）。~~

不过，它可以与其他角色结合使用。开发人员碰巧使用它作为前缀来标识静态字段或常量（例如`private static var $boxHeight:int = 480`）。

仅供参考，这是 ECMA 脚本规范中的一句话：

> “该标准规定了与 Unicode 标准中给出的语法的一个不同之处：美元符号 ($) 和下划线 (_) 允许在标识符中的任何位置使用。美元符号仅用于机械生成的代码。”

我猜你把它和**Javascript**混在一起了，其中美元符号可以被认为是一个变量名。多亏了这一点，您可以将其分配为预定义函数的快捷方式引用。

```
function popup(value)
{
   alert(value)
}

$ = popup;

$("hello");
$("world"); 
```

**Prototype(.js)**广泛引入了这种做法，以抽象出相当痛苦的`getElementById(id_name);`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T23:34:30.753

是一个叫$的函数，[jQuery](http://docs.jquery.com/How_jQuery_Works)其实用的很多

# ubuntu - 为什么不使用 initdb 安装后 PostgreSQL 在 Ubuntu 上运行？

> ID：588367
> 
> 赞同：7
> 
> 时间：2009-02-25T23:17:40.500
> 
> 标签：ubuntu, installation, redhat

我很好奇为什么在第一次运行 psql 之前不必按照 postgresql 手册使用 initdb ？（我在 8.04.1 上安装了 8.3 版本）

Red Hat 需要 -c postgresql start 但不需要 init.db。

但是，在 FreeBSD 上，您必须运行 initdb。

为什么设置不一致？是否归结为 apt-get install、rpm -i 和 pkg_add 之间的区别？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T11:32:27.373

它不是启动脚本，而是在您安装的软件包中指定的安装后挂钩，它为您执行了额外的步骤。无论您使用 .deb 还是 .rpm 格式，打包程序都可以将任务设置为在所有文件安装后发生。

当您安装软件时，有些发行版会牵着您的手，有些发行版希望您更愿意自己做事情。对于为什么任何打包程序都以他们的方式做事，确实没有黄金答案。

Ubuntu 力求实现一键式轻松安装，而无需用户看到 shell。专门为系统集成商构建的其他发行版不会牵你的手。

欢迎来到围绕 Linux 内核的 31 种（以及更多）操作系统风格，或者专注于 BSD 内核的努力。

每个人都知道应该如何做。好的发行版假定您知道自己在做什么.. 除非他们当然想从 Microsoft 手中攫取桌面市场，在这种情况下，它们会成为握住您手的优秀桌面发行版。

大多数情况下，这是一个选择问题，这就是让整个现象如此酷的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T23:19:57.047

很可能只是那些系统打包的启动脚本在第一次运行时自动运行 initdb。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T23:21:32.487

几乎可以肯定，是的。不同风格的 Linux 和 Unix 有不同的软件打包方法；例如，FreeBSD 是基于 ports 系统（您可以从头开始编译，尽管其中大部分都预先构建了二进制包），而在主流 Linux 发行版中通常情况下您会发现一个完全预编译的为流行的东西准备了二进制包。

维护打包系统的不同人（“打包者”和其他，有时不那么亲切的昵称）对问题采取不同的方法，通常反映了父项目的精神。或者，可能只是一个打包者认为使用标准配置进行设置并代表您运行一些常见的初始化步骤是合理的，而一个更不干涉的打包者会将其留给最终用户，特别是如果软件以任何方式复杂或在部署之前需要任何考虑，例如系统服务。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-02-25T01:21:01.393

Debian（以及扩展，Ubuntu）相当巧妙地处理 PostgreSQL。查看`postgresql-common`包装以了解详细信息。简而言之，它支持安装多个（主要）版本的 postgres，以及运行每个版本的 postgres 的多个集群。要查看您拥有哪些集群，请尝试`pg_lsclusters`. 包维护者假设如果你第一次安装 pg 服务器包，你会想要为它初始化一个集群。例如，如果您安装`postgresql-9.1`，您将默认获得 9.1/main 集群 initdb 供您使用。

Linux 发行版之间的情况并不一致，因为发行版的全部意义在于为此类问题提供更好的解决方案。Debian 在这方面提供了一个很好的解决方案。但是，我建议您使用 postgresql PPA 并获取更新版本的 postgresql，尤其是因为您只是在安装东西。

我刚刚意识到我正在回答一个古老的问题。嘘。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T11:25:56.890

如果没记错的话，Ubuntu 的 PostgreSQL 软件包是从 Debian 派生的。可能是 Debian 的包装出于某种原因有这个位置。如果是这种情况，Debian 和它的所有衍生产品（如 Ubuntu）将描述相同的行为。仅当您尝试从存储库安装相应的软件时才会发生这种情况。如果您从 PostgreSQL 的站点获取源代码并对其进行编译，您将按照手册中的说明获取它。各种发行版遵循某些打包指南，并在打包某些软件方面采取某些立场。如果你想知道确切的细节，你可以戳 postgresql 包的包维护者了解原因。

# iptables - 您如何通过 ddwrt 从 vpn 连接进行端口转发？

> ID：588373
> 
> 赞同：-1
> 
> 时间：2009-02-25T23:19:17.407
> 
> 标签：iptables

我有一个 ddwrt 路由器 v24 并构建了一些东西。我可以用它连接到我的 vpn，给我一个没有问题的 ip (192.168.10.200)。我想将 8080/tcp 从 vpn ip/接口转发到我的内部局域网 10.0.0.50:80。

我已经尝试了几乎所有我能想到的 iptables 命令，但仍然没有运气。感觉问题在于事情不是从 ppp0 遍历到 lan 的。看起来这应该很简单，但事实并非如此。谢谢。

至今：

iptables -t nat -I PREROUTING -p tcp -d 192.168.10.200 --dport 8080 -j DNAT --to 10.0.0.50:80

iptables -I FORWARD -p tcp -d 10.0.0.50 --dport 80 -j ACCEPT

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T23:37:19.330

以防万一您进行了复制/粘贴：

--to 10.0.0.75:50 应该是 --to-destination 10.0.0.50:80

如果不; 那么：你能从路由器ping 10.0.0.50 吗？你能从 10.0.0.50 ping 路由器吗（即它是否有到 192.168.10.0/24 的路由？）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-30T09:13:30.983

您还需要一条规则来释放输出流量：

`iptables -t nat -A POSTROUTING -p tcp --dport 80 -d 10.0.0.50 -j SNAT --to-source 192.168.10.200`

将此规则放在`PREROUTING`和规则之间`FORWARD`。尝试在所有规则中使用`-A`（附加）参数而不是`-I`（插入）。

# iphone - 使 UITextField 背景闪烁

> ID：588385
> 
> 赞同：1
> 
> 时间：2009-02-25T23:22:52.547
> 
> 标签：iphone, uitextfield

如何使 UITextField 的背景颜色闪烁？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T23:44:55.177

创建一个切换背景颜色的函数。

```
-(void) flashBackground
{
  UIColor* color = _flashOn ? [UIColor colorRed] : [UIColor colorWhite];
  _textField.backgroundColor = color;
  [_textField setNeedsDisplay];
  _flashOn = !_flashOn;

} 
```

然后设置一个定时器来调用这个函数

```
[NSTimer scheduledTimerWithTimeInterval:0.1f target:self selector:@selector(flashBackground) userInfo: nil repeats: NO]; 
```

# c# - return 语句可以阻止 using 语句关闭与数据库的连接吗？

> ID：588396
> 
> 赞同：4
> 
> 时间：2009-02-25T23:27:50.973
> 
> 标签：c#, using-statement, dbconnection, temp-tables

当我创建临时表时，我收到一条错误消息，告诉我临时表已经存在。临时表对会话来说是唯一的，所以我的连接似乎没有正确关闭，我认为它可能与我在 using 语句中的 return 语句有关。

我有以下代码：

```
using (IDbConnection connection = dbConnectionHandler.CreateConnection())
{
   connection.Open();
   CreateATempTable();
   PopulateTempTable();
   DataSet ds = CallStoredProcThatUsesTempTable();
   return ds;
} 
```

我在几个地方使用这种代码来创建一个同名的临时表。

不幸的是，我收到以下错误：`There is already an object named '#MyTempTable' in the database`.

现在，我知道临时表对于会话是唯一的，因此一旦会话关闭，它就会消失。

我认为有三件事可能会导致这种情况......

1.  我需要调用 connection.Close()
2.  我需要将 return 语句放在我的 using 语句之外
3.  我需要在返回之前删除我创建的临时表

有谁知道它是哪一个？或者如果它是我没有想到的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-25T23:49:31.700

我在这里猜测，但请检查您的数据库连接池设置。尝试关闭池，看看是否有帮助。

通常，当您在 .NET 库级别关闭/处理连接时，不会关闭真正的数据库服务器连接。它只是返回到数据提供者内部的连接池，当程序请求另一个具有相同参数和凭据的连接时，它将被重用。我认为在返回池之前不会以任何方式重置数据库会话，除了打开的事务和一些基本参数。更昂贵的对象，如临时表，被单独留下。

您可以关闭池化（非常低效）。或者，您可以在尝试创建临时表之前检查它是否存在，如果存在则删除其内容。或者您可以在关闭连接之前删除临时表。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T23:32:43.380

我很确定将调用 connection.Dispose() （以及 connection.Close() ）。

您可以通过执行 1) 和 2) 并检查问题是否仍然存在来轻松验证这一点。解决方案可能是 3)，解释是连接池。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T23:30:25.633

除非发生电源循环或其他一些非常奇怪的角落案例处置将被调用。

如果您想要证明包装对象并在其中放置断点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T23:32:34.363

using 块在引擎盖下被转换为 try/catch/finally 块。是的，无论使用块内的返回如何，它都会处理。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T23:32:53.333

不，connection.Close 将始终被调用，因为内部*使用*将其放入 try/finally 块中。

您可能还需要考虑连接池。尝试将您的代码包装在 TransactionScope 中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-25T23:32:20.307

在不了解正在使用的数据库连接库的更多信息的情况下，我猜它不是前两个。`using`专门引入以在退出方法时更容易清理此类资源；它直接类似于`try...finally`Java 或类似的普通块。

换句话说，`return`将离开块并且`Dispose`将在连接上调用该方法，假设这种情况的合理实现，应该将该`Close`方法作为该过程的一部分来调用。

这里的关键点是“理智的实施”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-25T23:33:20.180

要回答您的问题：

1.  当调用连接的 Dispose 方法时，using 语句将隐式关闭连接。
2.  那应该不需要：[http ://aspadvice.com/blogs/name/archive/2008/05/22/Return-Within-a-C_2300_-Using-Statement.aspx](http://aspadvice.com/blogs/name/archive/2008/05/22/Return-Within-a-C_2300_-Using-Statement.aspx)
3.  尝试一下。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-25T23:41:30.567

如果对象的类是 IDisposable，即使 using 块中有 return 语句， using 语句也会释放该对象。

它是保持您的#temptable 的连接池，您可能希望手动删除该表。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-25T23:56:09.923

这是由连接池引起的。将您正在做的事情包装在事务中，并在最后回滚。或者，在填充 ds 后删除临时表。

# php - JSON 结构在 IE7 (JavaScript) 中不起作用

> ID：588413
> 
> 赞同：2
> 
> 时间：2009-02-25T23:33:39.663
> 
> 标签：php, javascript, json, internet-explorer-7

好的，我是 JSON 新手，所以如果我的问题有点无知，请原谅我 - 我已经把头撞到墙上太多了，需要一些专家建议。

我正在尝试获取一个简单的示例，其中 HTML 页面使用 jQuery 的 JSON/AJAX 函数调用示例 PHP 页面，该页面传回一个简单的 JSON 数据结构，然后页面使用 jQuery 编写其中一个元素页面的数据结构。在FF工作。在 IE7 中不起作用 arrrggghhhh！

HTML 代码（相关部分）：

```
<script language="javascript" type="text/javascript" src="jquery.js"></script>
<script language="javascript" type="text/javascript">
function testAJAX() {
  $.getJSON("test-ajax.php", function(json){
      $("#div1").html(json.var1[1]);
  });
}
</script>
</head>
<body>
<input type="button" value="test ajax" onclick="testAJAX();" />
<div id="div1"> </div>
</body> 
```

PHP 代码 (test-ajax.php):

```
<?php
include_once('./json.php'); 
$output = array('var1' => array('value1a', 'value1b', 'value1c'), 
                'var2' => array('value2a', 'value2b', 'value2c')); 

header("Content-type: text/plain");
echo json_encode($output);
?> 
```

json.php 具有我正在使用的 json_encode() 函数 - 我从[http://us2.php.net/manual/en/function.json-encode.php](http://us2.php.net/manual/en/function.json-encode.php)获得它。我使用它是因为我没有 PHP5，而且我的系统管理员不会安装任何对它的支持。直接在浏览器中查看 test-ajax.php 会打印出一个序列化的 JSON 结构，如下所示：

```
{"var1":["value1a","value1b","value1c"],"var2":["value2a","value2b","value2c"]} 
```

这似乎是一个有效的 JSON 结构。在我的 JavaScript 中，我试图`'value1b'`通过这样做来引用：`json.var1[1]`. FF 处理得很好。IE7 说这是未定义的。

我究竟做错了什么？如何像这样传输二维数组

```
array('var1' => array('value1a', 'value1b', 'value1c'), 
      'var2' => array('value2a', 'value2b', 'value2c')); 
```

通过 JSON/AJAX？或者这是不可能的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-26T15:17:25.217

好的，想通了。根本不是 JSON/JavaScript 问题，而是**缓存问题**。当我开发这个时，我必须在 test-ajax.php 不工作或生成不同的 JSON 结构时最初测试 IE7，然后我将 test-ajax.php 更改为我上面发布的内容，我更新了我的 JavaScript 但 IE7 是使用它最初从 test-ajax.php 收到的缓存版本。我对此进行了测试 - 如果我清除 IE7 中的缓存，它会起作用，然后如果我更改 JSON 结构中的值（但不是结构本身），IE7 将继续使用缓存的 JSON 结构。

**解决方案：**

我添加了

```
header("Cache-Control: no-cache, must-revalidate");
header("Expires: 0"); 
```

在我的 test-ajax.php 页面中，现在 IE7 在进行 AJAX 调用时正在正确检查服务器是否有更新版本的 test-ajax.php。

谢谢大家！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T23:47:27.260

尝试将以下行添加到 test-ajax.php 文件的末尾：

```
echo ';'; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T23:51:18.577

我没有立即发现任何问题，但这里有一些事情可以尝试

1.  得到[查尔斯](http://www.charlesproxy.com/)。查看来自 getJSON() 调用的请求/响应。内容是否按预期返回？响应的状态码是200，还是别的什么？
2.  确定 IE 是否完全知道 json 变量。修改您的代码以尝试这样的东西

（可能只想一次运行这些警报 1）

```
$.getJSON("test-ajax.php", function(json){
  alert( typeof json );
  alert( typeof json.var1 );
  alert( typeof json.var1[1] );
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-09-24T15:11:08.023

IE 和 ajax 的两个常见问题如下：

*   缓存（可以在上面找到解决方案）
*   空白空间！！（如果您的回报在 json 输出之前/之后有任何空白，这将在 IE 7 中失败）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-07-30T16:33:35.577

我在 IE 8 上遇到了同样的问题。解决方案是简单地使用 ajaxSetup 关闭缓存

```
$.ajaxSetup({
cache : false}); 
```

非常烦人，因为这在 FF 和 Chrome 中运行良好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-12-09T07:16:15.607

在 IE 中，您必须包含 json2.js 库，因为 IE 没有原生 JSON 解析。但是 Firefox 和 Chrome 有。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-25T23:58:22.180

如果您尝试访问这样的值，您会得到相同的结果吗？

```
json["var1"][1] 
```

...而不是这个：

```
json.var1[1] 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-04T04:42:54.083

在对对象文字属性使用保留字时，我遇到了问题。它在 Firefox 和 Safari 中运行良好，但在 IE 中运行良好。这是通常让我绊倒的一个：

```
{
    class : 'my-css-class'
} 
```

这是我首先要检查的。YMMV。

# git - 回滚远程 Git 存储库

> ID：588414
> 
> 赞同：112
> 
> 时间：2009-02-25T23:33:52.223
> 
> 标签：git

我有一个远程 Git 存储库，我需要将最后的提交回滚`n`到冷漠的状态。

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2009-02-25T23:51:17.237

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-02-26T00:43:21.730

elmarco is correct... his suggestion is the best for shared/public repositories (or, at least public branches). If it wasn't shared (or you're willing to disrupt others) you can also push a particular ref:

```
git push origin old_master:master 
```

Or, if there's a particular commit SHA1 (say 1e4f99e in abbreviated form) you'd like to move back to:

```
git push origin 1e4f99e:master 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2014-05-21T15:14:30.407

Fortunately I was in a position to use [Pat Notz's solution](https://stackoverflow.com/a/588615/1828051) which completely removed the unwanted commit. However, initially I got the error

```
error: failed to push some refs to 'ssh://git@gitrepo.git'
To prevent you from losing history, non-fast-forward updates were rejected* 
```

But adding the force (`-f`) option overwrite this error

```
git push -f origin 52e36b294e:master 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-06-13T08:00:19.620

If you have direct access to the remote repo, you could always use:

```
git reset --soft <sha1> 
```

This works since there is no attempt to modify the non-existent working directory. For more details please see the original answer:

[How can I uncommit the last commit in a git bare repository?](https://stackoverflow.com/questions/4624881/how-can-i-uncommit-the-last-commit-in-a-git-bare-repository/5627799#5627799)

# c++ - WinHttp/Windows SDK 的 C++ 编译问题

> ID：588420
> 
> 赞同：7
> 
> 时间：2009-02-25T23:35:23.670
> 
> 标签：c++, sdk

试图用 SDK 编译一个示例 http 类，并得到一些奇怪的链接错误......我确信它与缺少选项或目录有关......

如您所见，我不是 c++ 专家，但正在寻求任何帮助。

我包括了我的示例类。我也确实安装了 Windows SDK。如果您需要有关我的设置或任何其他信息，请询问。我希望有人将我指向一个有效的 WinHttp SDK 示例项目。

```
//START OF utils.cpp
#pragma once
#include "stdafx.h"

class http
{
public:
    http();
    ~http();

    std::string getText();

};
//END OF utils.cpp 
```

* * *

```
//START OF utils.cpp
#include "stdafx.h"
#include "utils.h"

http::http()
{
}

http::~http()
{
}

std::string http::getText()
{
    DWORD dwSize = 0;
    DWORD dwDownloaded = 0;
    LPSTR pszOutBuffer;
    BOOL  bResults = FALSE;
    HINTERNET  hSession = NULL, 
        hConnect = NULL,
        hRequest = NULL;

    // Use WinHttpOpen to obtain a session handle.
    hSession = WinHttpOpen( L"WinHTTP Example/1.0",  
        WINHTTP_ACCESS_TYPE_DEFAULT_PROXY,
        WINHTTP_NO_PROXY_NAME, 
        WINHTTP_NO_PROXY_BYPASS, 0 );

    // Specify an HTTP server.
    if( hSession )
        hConnect = WinHttpConnect( hSession, L"www.microsoft.com",
        INTERNET_DEFAULT_HTTPS_PORT, 0 );

    // Create an HTTP request handle.
    if( hConnect )
        hRequest = WinHttpOpenRequest( hConnect, L"GET", NULL,
        NULL, WINHTTP_NO_REFERER, 
        WINHTTP_DEFAULT_ACCEPT_TYPES, 
        WINHTTP_FLAG_SECURE );

    // Send a request.
    if( hRequest )
        bResults = WinHttpSendRequest( hRequest,
        WINHTTP_NO_ADDITIONAL_HEADERS, 0,
        WINHTTP_NO_REQUEST_DATA, 0, 
        0, 0 );

    // End the request.
    if( bResults )
        bResults = WinHttpReceiveResponse( hRequest, NULL );

    // Keep checking for data until there is nothing left.
    if( bResults )
    {
        do 
        {
            // Check for available data.
            dwSize = 0;
            if( !WinHttpQueryDataAvailable( hRequest, &dwSize ) )
                printf( "Error %u in WinHttpQueryDataAvailable.\n",
                GetLastError( ) );

            // Allocate space for the buffer.
            pszOutBuffer = new char[dwSize+1];
            if( !pszOutBuffer )
            {
                printf( "Out of memory\n" );
                dwSize=0;
            }
            else
            {
                // Read the data.
                ZeroMemory( pszOutBuffer, dwSize+1 );

                if( !WinHttpReadData( hRequest, (LPVOID)pszOutBuffer, 
                    dwSize, &dwDownloaded ) )
                    printf( "Error %u in WinHttpReadData.\n", GetLastError( ) );
                else
                    printf( "%s", pszOutBuffer );

                // Free the memory allocated to the buffer.
                delete [] pszOutBuffer;
            }
        } while( dwSize > 0 );
    }

    // Report any errors.
    if( !bResults )
        printf( "Error %d has occurred.\n", GetLastError( ) );

    // Close any open handles.
    if( hRequest ) WinHttpCloseHandle( hRequest );
    if( hConnect ) WinHttpCloseHandle( hConnect );
    if( hSession ) WinHttpCloseHandle( hSession );

    return "";
}
//END OF utils.cpp 
```

* * *

```
1>------ Build started: Project: winagent, Configuration: Debug Win32 ------
1>Compiling...
1>utils.cpp
1>Linking...
1>   Creating library C:\winagent\Debug\winagent.lib and object C:\winagent\Debug\winagent.exp
1>utils.obj : error LNK2019: unresolved external symbol __imp__WinHttpCloseHandle@4 referenced in function "public: class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > __thiscall http::getText(void)" (?getText@http@@QAE?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@XZ)
1>utils.obj : error LNK2019: unresolved external symbol __imp__WinHttpReadData@16 referenced in function "public: class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > __thiscall http::getText(void)" (?getText@http@@QAE?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@XZ)
1>utils.obj : error LNK2019: unresolved external symbol __imp__WinHttpQueryDataAvailable@8 referenced in function "public: class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > __thiscall http::getText(void)" (?getText@http@@QAE?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@XZ)
1>utils.obj : error LNK2019: unresolved external symbol __imp__WinHttpReceiveResponse@8 referenced in function "public: class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > __thiscall http::getText(void)" (?getText@http@@QAE?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@XZ)
1>utils.obj : error LNK2019: unresolved external symbol __imp__WinHttpSendRequest@28 referenced in function "public: class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > __thiscall http::getText(void)" (?getText@http@@QAE?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@XZ)
1>utils.obj : error LNK2019: unresolved external symbol __imp__WinHttpOpenRequest@28 referenced in function "public: class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > __thiscall http::getText(void)" (?getText@http@@QAE?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@XZ)
1>utils.obj : error LNK2019: unresolved external symbol __imp__WinHttpConnect@16 referenced in function "public: class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > __thiscall http::getText(void)" (?getText@http@@QAE?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@XZ)
1>utils.obj : error LNK2019: unresolved external symbol __imp__WinHttpOpen@20 referenced in function "public: class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > __thiscall http::getText(void)" (?getText@http@@QAE?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@XZ)
1>C:\winagent\Debug\winagent.exe : fatal error LNK1120: 8 unresolved externals
1>Build log was saved at "file://c:\winagent\Debug\BuildLog.htm"
1>winagent - 9 error(s), 0 warning(s)
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-25T23:42:41.577

如果您查看有关 WinHttp* 函数的 MSDN 参考资料，您会发现您需要与库 Winhttp.lib 链接。

打开项目设置，选择链接器选项，然后选择“输入”并将 WinHttp.lib 添加到“附加依赖项”列表中。

或者你可以把

```
#pragma comment(lib, "winhttp.lib") 
```

（如前所述）在您的源代码中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-25T23:39:12.273

您需要链接到 winhttp.lib

更改项目设置或将此行添加到您的 .cpp 文件

```
#pragma comment(lib, "winhttp") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T23:39:34.020

确保您链接到`Winhttp.lib`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T23:39:42.800

您尚未将 WinHttp 库添加到您的链接列表中。

# maven-2 - 解决 Maven 错误：项目“XYZ”在反应器中重复

> ID：588429
> 
> 赞同：12
> 
> 时间：2009-02-25T23:37:27.080
> 
> 标签：maven-2

我正在创建一个构建许多其他相关项目的多模块项目。其中一些项目也是多模块项目，在某些情况下它们构建相同的子项目。Maven 对我大喊大叫，但这是故意的，无论如何我都希望它能够构建。

有没有人解决这个问题？谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2018-02-09T12:39:36.847

当你有这样的结构时会发生这种情况：

```
+-- root-project-A
    `-- pom.xml
    +-- module-A
    |   `-- pom.xml
    +-- module-B
    |   `-- pom.xml
    +-- root-project-B
        `-- pom.xml
        +-- module-C
            `-- pom.xml 
```

并像这样配置你的模块：

```
|-- root-project-A
    `-- pom.xml
        <modules>
         <module>module-A</module>
         <module>module-B</module>
         <module>root-project-B</module> <!-- Error: project A reference project B -->
         <module>root-project-B/module-C</module> <!-- Error: project A reference project B -->
        </modules>

|-- root-project-B
    `-- pom.xml
        <modules>
         <module>module-C</module>
        </modules> 
```

项目 A 不能引用项目 B，因为 B 没有将 A 引用为父项。包裹必须是独立的

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-10T16:32:29.070

我认为你不应该那样做。（您可以尝试定义一个配置文件 - 比如说一个完整的构建配置文件，您可以确保每个模块只编译一次，另一个配置文件在您进行子构建时添加其他模块。）

但是您最好采用 maven 方式 - 每个项目都应仅包含来自其自己目录的目录作为模块，例如仅直接子目录。

Maven 有一些非书面的隐含假设，例如 - 总是从父目录中的 pom 继承子模块，例如继承树必须与您的目录树匹配，否则某些插件将无法工作，例如发布插件或某些报告插件。

简短的回答是 - 在 Maven 中，您的项目层次结构/树中不能有两次模块。

maven 中有很多错误的方法，因此必须坚持使用已知有效的方法——比如 pom 层次结构 == 目录结构。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2019-04-16T11:59:28.073

对我来说`<artifactId>`，他们的 pom 中的 2 个不同模块是相同的，这导致了这个错误。
一旦改变，它工作正常。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-10-21T16:15:40.867

在我的情况下，IntelliJ 放入`<module>parentModule/XYZ</module>`父父模块 pom.xml

所以用 Find All ( *CTRL+SHIFT+F* ) 'XYZ' 检查最终的错误

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-15T21:51:06.697

听起来您可能从多个项目构建的“相同子项目”是所有这些项目的依赖项。在你的目录树中将它移到一个很好的高级，并在所有需要它的项目 pom 中将它声明为依赖项。它将由您构建的第一个需要它的项目构建，其余的将看到您“去过那里，做过那个”并跳过它。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-26T17:20:13.877

您是否尝试过这些命令行选项之一？

```
-fae,--fail-at-end            Only fail the build afterwards; allow all
                              non-impacted builds to continue
-fn,--fail-never              NEVER fail the build, regardless of project
                              result 
```

# sql - 在 Oracle 的 to_char 中转义非格式字符的最佳方法是什么？

> ID：588430
> 
> 赞同：50
> 
> 时间：2009-02-25T23:39:06.330
> 
> 标签：sql, oracle, to-char

我正在尝试在 select 语句中打印日期，但我需要在输出中添加一个字母：

```
to_char(date_updated, 'YYYY-MM-DDTHH:mm:ss') 
```

Oracle 不喜欢 T。我只想像冒号和破折号一样输出 T。我可以用反斜杠或其他什么来逃避它吗？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2009-02-25T23:47:31.580

你只需要在它周围加上双引号：

```
to_char(date_updated, 'YYYY-MM-DD"T"HH:mm:ss') 
```

# 3d - 曲线拟合 3D 数据集

> ID：588438
> 
> 赞同：6
> 
> 时间：2009-02-25T23:42:07.163
> 
> 标签：3d, geometry, regression, curve-fitting

2D 数据的曲线拟合问题是众所周知的（LOWESS 等），但给定一组 3D 数据点，我如何将 3D 曲线（例如平滑/回归样条）拟合到该数据？

更多：我试图找到一条曲线，拟合向量 X、Y、Z 提供的数据，这些向量没有已知的关系。本质上，我有一个 3D 点云，需要找到一个 3D 趋势线。

更多：我为歧义道歉。我尝试了几种方法（我还没有尝试修改线性拟合），随机 NN 似乎效果最好。即，我从点云中随机选择一个点，找到它的邻居的质心（在任意球体内），迭代。连接质心以形成平滑样条曲线被证明是困难的，但获得的质心是可以通过的。

为了澄清问题，数据不是时间序列，我正在寻找最能描述点云的平滑样条曲线，即，如果我要将这个 3D 样条曲线投影到由任何 2 个变量形成的平面上，投影样条曲线 (到 2D 上）将是投影点云（到 2D 上）的平滑拟合。

IMG：我已经包含了一张图片。红点代表从上述方法获得的质心。

[3D 点云和局部质心 http://img510.imageshack.us/img510/2495/40670529.jpg](http://img510.imageshack.us/img510/2495/40670529.jpg)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T23:56:33.540

一个相关的问题在这里：

[简单的多维曲线拟合](https://stackoverflow.com/questions/529184/simple-multidimensional-curve-fitting)

一般来说，您可以从统计学习的角度来看待这样的问题。换句话说，您有一组以某种方式参数化的基函数（例如样条），然后您使用最小二乘法或其他一些回归技术来找到最佳系数。我碰巧喜欢[统计学习要素](https://rads.stackoverflow.com/amzn/click/com/0387952845)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T23:53:13.143

这取决于你的意思。如果你有一组点 f(x,y) -> z 并且你想找到一个能击中它们的函数，你可以做一个样条。

如果您有一个已知函数并且想要调整参数以最小化 RMS 误差，只需考虑 x,ya 复合对象 p（例如，就好像它是一个复数或 2 向量）并使用 2d 情况的模拟在 f(p) -> z 上。

如果您可以更具体地说明您要完成的工作，我可以更具体地提出建议。

——马库斯

因此，鉴于已编辑的问题陈述，我建议如下：

*   如果它是一个时间序列（通过您使用术语“趋势线”来暗示），我会将其视为三个参数函数（x(t)、y(t)、z(t)）并对每个函数进行 2d 拟合其中。
*   或者（但仍然假设一个有序系列），您可能希望找到一个线性拟合（一条穿过云中心的线），然后根据从点到的垂直投影添加某种（可能是极坐标）函数线。
*   如果它不是时间序列（由短语“未知关系”和“点云”暗示），则必须定义要适合它们的“曲线”。你要线吗？表面/歧管？您希望它是一个或两个变量的函数，还是独立于它们（例如，凸包）。它必须是平滑的、有限的程度，还是……？

真的，这个问题还是太开放了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-24T21:23:53.797

您可以尝试加法（即单索引模型），如 GAM [http://www-stat.stanford.edu/software/gam/index.html](http://www-stat.stanford.edu/software/gam/index.html)

这是一种贪婪的方法，非常可扩展，在几个 R 包中很好地实现

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-07T15:28:49.047

查尔斯·费弗曼（是的——菲尔兹奖得主）和博阿兹·克拉塔格（Boaz Klartag）有一个*非常*好的新作品：

*   [将 C^m 平滑函数拟合到数据 I](http://www.math.princeton.edu/facultypapers/Fefferman/FittingData_Part_I.pdf)，Ann。数学，169，没有。1, (2009), 315--346。

*   [将 C^m-Smooth 函数拟合到 Data II](http://www.math.princeton.edu/facultypapers/Fefferman/Fitting_Data_Part_II.pdf)中，出现在 Rev. Mat 中。伊比利亚美洲。

您可以在 Klartag 的[出版物页面上找到它们都是 pdf 文件](http://www.math.tau.ac.il/~klartagb/publications.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-02-25T16:36:06.567

我会尝试使用 Spacefilling Curve Heuristic。例如，按空间填充曲线访问点的顺序对点进行排序。您的问题的一种解决方案是通过按该顺序获取的点的样条曲线。要获得更短且更平滑的曲线（但从点到曲线的 RMS 距离更大），您可以强制样条仅通过每 k 个点。如果在选择每个第 k 个点之后，您可以改进曲线，您可以通过它们寻找更短的哈密顿路径（如旅行商问题，但针对开放路径）。您还可以调整样条结以减小 RMS 距离。在计算 RMS 距离时，我会使用空间填充曲线顺序来指示样条曲线的哪一部分可能最接近给定点。

# c# - 这段代码有多糟糕？

> ID：588441
> 
> 赞同：1
> 
> 时间：2009-02-25T23:42:17.290
> 
> 标签：c#, coding-style

我继承了一个用 C# 编写的在线测验应用程序，到处都是这些代码行。

那么这段代码有多糟糕呢？

我可能会遇到哪些潜在问题？

我该如何改进它？

### 编码：

```
strTestPasses += "<tr valign=\"top\"><td><b>Subject</b></td><td>" + ((Hashtable)((ArrayList)((Hashtable)MultipleTestPasses[i])["HasMultipleDataSet"])[j])["subject"] + "</td></tr>"; 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-25T23:50:27.457

我也讨厌这些“代码行”。当人们问我“你做过的最大的项目是什么”时，我会说“一行代码”。当其他人这样挑战我“你一天能写多少行代码？”时，我回复他们，“我的兄弟只有一个。但这是一条真正的路线'

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-26T00:17:12.523

要开始重构，我可以建议：

```
TestPassesBuilder.AppendFormat(
    "<tr valign='top'><td><b>Subject</b></td><td>{0}</td></tr>", 
    MultipleTestPasses[i]["HasMultipleDataSet"][j]["subject"]
  ); 
```

或者

```
TestPassesBuilder.AppendFormat(
    "<tr valign='top'><td><b>{0}</b></td><td>{1}</td></tr>",
    "Subject", 
    MultipleTestPasses[i]["HasMultipleDataSet"][j]["subject"]
  ); 
```

其中`TestPassesBuilder`当然是 StringBuilder 并且`MultipleTestPasses`已被转换为使用适当的通用集合类型，而不是 ArrayList/HashTable 可憎。第二个选项还将允许在某个时候将每一行的标题分解为一个变量。

对于下一步，应将 MultipleTestPasses 转换为真实对象。由于看起来他使用的是硬编码键，因此每个“键”实际上对应于类的一个属性。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-25T23:45:09.327

它通过了单元测试吗？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-25T23:44:26.067

这不是很好，但我见过更糟的。

为了不让任何人陷入昏迷或其他不愉快的情节，我将避免发布任何示例。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-25T23:47:07.853

同样，作为对主观问题的主观回答，它并不漂亮。再说一次，如果这是一个小型网站，那么以“快速而肮脏”的方式执行此操作可能比更合适的方式更容易，例如 C# / ASP -> XML -> XSLT -> HTML（或类似的东西）无论如何线 - 我在这里有点抓住稻草）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-26T00:03:28.640

你知道他们怎么说“......只有母亲才能爱......”

好吧，在这种情况下，只有编译器会喜欢。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-25T23:43:53.853

好吧，主观上，我会说它是丑陋的罪恶。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-25T23:45:32.133

HTML 包裹了 eww。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-25T23:51:32.820

实际上并没有那么糟糕。显然，程序员没想到有人会接管他的项目（缺乏专业经验），但将这些通用哈希表和数组列表重构为更有意义的东西应该不难。

同样在重构时，将字符串文字与**@**用于 html。

如果它是一个小项目，我个人并不关心他是否使用任何 html 模板。模板通常用于小型项目。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-26T00:22:25.040

在对代码库的大小和范围一无所知的情况下，我看到关于那行代码的两件事真正困扰着我。

1.  HTML 布局未与内容分离。
2.  The Subject should be returned from a descriptively named function.

I'd much prefer to see something like:

```
strTestPassesStringBuilder.Append(newTableRow("Subject", getSubject()); 
```

where the and valign options are controlled via CSS.

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-26T00:37:23.927

> ```
> ((Hashtable)((ArrayList)((Hashtable)MultipleTestPasses[i])["HasMultipleDataSet"])[j])["subject"] 
> ```

Oh... my eyes...

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-26T23:24:03.783

This is severly bad as it contains the following flaws :

*   string concatenation whereas a StringBuilder or a View template could be much better
*   View information (such as HTML) in a non-UI layer (probably)
*   Ambiguos business logic ("HasMultipleDataSets")
*   Untyped datasets (the column index value is string)
*   Too much on a single line of code

# objective-c - EXC_BAD_ACCESS 错误

> ID：588445
> 
> 赞同：2
> 
> 时间：2009-02-25T23:43:09.097
> 
> 标签：objective-c, iphone, cocoa-touch

我制作了一个应用程序，它应该一直运行，直到我停止它。它的基本作用是从连接的另一台设备获取一些数据，并定期使用 将这些数据发送到服务器`NSURLConnection`，并定期从服务器读取数据并使用 将这些数据可视化为图形`NSXMLParser`。

我运行仪器检查分配和泄漏。完全没有泄漏。内存监视器显示一致的 5.2 MB。Objectalloc 图是稳定的，objectallo 的净字节数约为 480000，#net 约为 6400。

大约 10~15 小时后坠毁。所以我在`malloc_error_break`. 现在`EXC_BAD_ACCESS`大约 12 小时后，我在调试器控制台上收到“”错误。

任何的想法？

一个可疑的部分是**发送**数据。

```
 - (void) sendDataToServerWithX:(float)x Y:(float)y{ 
NSAutoreleasePool *uiUpdatePool = [[NSAutoreleasePool alloc] init]; 
NSString *urlString = [[NSString alloc] initWithFormat:@"[http://www.url.com/save_data.php?user=user1&x=%f&y=%f](http://www.url.com/save_data.php?user=user1&x=%f&y=%f)", x, y];
NSURLRequest *theRequest=[NSURLRequest requestWithURL:[NSURL URLWithString:urlString] cachePolicy:NSURLRequestUseProtocolCachePolicy timeoutInterval:60.0];
NSURLConnection *theConnection=[[NSURLConnection alloc] initWithRequest:theRequest delegate:self];

if (theConnection) { NSLog(@"sending success"); } 
//else { }

NSLog( @"data sent.");

[urlString release];

[theConnection release];
[uiUpdatePool drain];
} 
```

另一个可疑的部分是**读取**数据：

```
 - (void) readCurrentDataFromServer: (NSTimer *) timer {

NSAutoreleasePool *uiUpdatePool = [[NSAutoreleasePool alloc] init]; 
XMLParser *parser = [[XMLParser alloc] initXMLParser];

NSURL *url = [[NSURL alloc] initWithString:aString];
NSXMLParser *readXmlParser = [[NSXMLParser alloc] initWithContentsOfURL:url];

[readXmlParser setDelegate:parser];
[readXmlParser parse]; 

(...) 

[parser release];

[url release];

[readXmlParser release];
[uiUpdatePool drain];
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-26T00:16:46.020

尝试在启用“Guard Malloc”（在 Xcode 的运行菜单中）的 iPhone 模拟器中运行它。这是一个特殊设置，旨在使隐藏的内存访问错误导致立即崩溃而不是隐藏一段时间。（它还会使您的应用程序变得非常缓慢并消耗比正常情况更多的内存，这就是它并不总是打开的原因。）不确定它是否会有所帮助，但它可能会有所帮助。

**更新**：以上说明适用于 Xcode 3。在 Xcode 4 中，通过单击工具栏中的方案名称，选择“编辑方案”，单击工作表源列表中的“运行”，选择“诊断”选项卡，打开 Guard Malloc，并选中“启用 Guard Malloc”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T00:12:06.937

如果你得到`EXC_BAD_ACCESS`了，那么你可能还会得到一个崩溃日志，这将帮助你找出崩溃的位置。可能会取消引用指向不在播放中的内存的指针-例如，不清楚您的`aString`或`url`变量来自何处。也不清楚您的应用程序是否有多个线程，在这种情况下，您的本地`NSAutoreleasePool`可能会发布您希望它没有发布的东西。一切都很难说。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-12-29T23:04:10.823

使用 Zombies 仪器对其进行分析也会有所帮助，因为它提供了有关引发错误的原因的详细反馈。例如一个已释放的数组。

# dojo - 以编程方式控制 Dojo 手风琴

> ID：588449
> 
> 赞同：0
> 
> 时间：2009-02-25T23:44:49.653
> 
> 标签：dojo, accordion

我的页面上有一个 dijit.layout.AccordionContainer，它在 html 中定义，并在 dojo 在加载时解析页面时创建。

然后，当用户与页面交互时，我使用 Ajax 检索数据并以编程方式填充容器（首先删除现有项目）。

为了简单地说明我的问题，这里有一些不起作用的代码：

```
 function doit() {
        var accordion = dijit.byId("accordionShell");
        accordion.getChildren().each(function(item) {
            accordion.removeChild(item);
        });
        for (i = 1; i < 5; i++) {
            var d = new dijit.layout.AccordionPane({title:'hello', content:'world'});
            accordion.addChild(d);
        }
    } 
```

这失败了，因为只有手风琴中的第一个项目是可见的。我认为其他人确实存在，但它们不可见，因此您无能为力。

我设法通过以下方式绕过它：

1.  始终确保手风琴中有 1 个项目（所以我从不移除第一个孩子）
2.  更改内容后调用accordian.layout()

因此，只要您总是想查看第一项，并且除了第一项之外实际上不展开任何内容，这段代码就“有效”：

```
 function doit() {
        var accordion = dijit.byId("accordionShell");
        var i = 0;
        accordion.getChildren().each(function(item) {
            if (i > 0) accordion.removeChild(item);
            i++;
        });
        for (i = 1; i < 5; i++) {
            var d = new dijit.layout.AccordionPane({title:'hello', content:'world'});
            accordion.addChild(d);
        }
        accordion.layout();

    } 
```

我正在使用 Dojo 1.2.0 - 有人知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T18:39:42.093

我每次都会创建一个新的 AccordionContainer，添加 AccordionPane 子项，然后执行以下操作：

```
oldAccordion.domNode.parentNode.replaceChild(
  newAccordion.domNode,
  oldAccordion.domNode
);

oldAccordion.destroyRecursive();
newAccordion.startup(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T23:51:51.273

如果我没记错的话……你应该这样做……

```
 pane1half = new dijit.layout.ContentPane({id: "pane1half", title: "hello", content: "world"}); 
```

87 手风琴.addChild(pane1half, 1);

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T23:50:28.127

我相信我发现了一个问题——accordian.removeChild() 是不够的。如果你破坏它，那么行为似乎是正确的。我不知道您是否必须两者都做，或者单独销毁是否就足够了。

因此，删除现有项目的代码变为：

```
accordion.getChildren().each(function(item) {
        if(i>0) {
            accordion.removeChild(item);
            item.destroy();
        }
        i++;
}); 
```

我正在通过在第一项中包含“帮助信息”来解决此限制...

# android - 在 Android 上打开 GL ES：如何使用 gluUnProject？

> ID：588454
> 
> 赞同：8
> 
> 时间：2009-02-25T23:45:32.053
> 
> 标签：android, opengl-es

我正在尝试将窗口坐标转换为对象坐标。GLU 类中有一个 gluUnProject，它需要当前的模型视图、投影矩阵和视口。

我的问题是如何获得这些矩阵？我试过 gl.glGetIntegerv (GL11.GL_MODELVIEW_MATRIX_FLOAT_AS_INT_BITS_OES, model, 0); 和 ((GL11) gl).glGetFloatv(GL11.GL_MODELVIEW_MATRIX, modelf, 0); 但第一个返回一个零数组，另一个只显示“方法未实现”错误。

gluUnProject 是否是用于此目的的正确方法（即窗口坐标-> 对象坐标）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-01T13:19:24.600

您无法获取矩阵，因为 Android 提供的是 GLES 1.0，而不是 GLES 1.1，因此不支持 1.1 的所有各种 glGet* 函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-09-18T02:47:50.833

您可以在 SDK 提供的示例中找到 MatrixGrabber。您可以使用 MatrixGrabber（内部跟踪矩阵）来获取模型视图和投影矩阵。

# winforms - 自定义选项卡控件未显示在 Visual Studio 表单设计视图中

> ID：588456
> 
> 赞同：3
> 
> 时间：2009-02-25T23:46:23.410
> 
> 标签：winforms, visual-studio-2008, tabcontrol

因此，我有一个现有项目，其中包含嵌套在面板和拆分器等中的自定义选项卡控件。

现在我需要通过设计视图向该选项卡控件的其中一个页面添加一些内容。

但是，当我查看有问题的表单时，标签控件无处可见（并且不在页面上当前控件的下拉列表中）。

选项卡控件位于设计器代码中，并在您运行时出现。

对这个可能是菜鸟的问题有什么建议吗？

**编辑**

好的，我可能应该提到这一点，但我想我忘记了——表单是继承的表单。此表单与继承表单的一些差异存在，但选项卡控件不存在

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T22:08:00.980

选项卡控件在基本形式中可能是 Private。尝试将选项卡控件的 Modifier 属性设置为 Protected 或 Public（来自基本窗体的设计器）。

如果控制字段是私有的，它将在继承表单的设计器中不可用，但它仍会在运行时显示。

**更新，作者提出的新问题**

如果没有人在文本编辑器中编辑 csproj 文件，我不知道它是如何发生的。但是这个例子展示了表单包含在 csproj 中的外观。

```
<Compile Include="MainForm.cs">
  <SubType>Form</SubType>
</Compile>
<Compile Include="MainForm.designer.cs">
  <DependentUpon>MainForm.cs</DependentUpon>
</Compile>
<EmbeddedResource Include="MainForm.resx">
  <DependentUpon>MainForm.cs</DependentUpon>
  <SubType>Designer</SubType>
</EmbeddedResource> 
```

此示例将导致您描述的行为。（已删除 DependentUpon-tags）。

```
<Compile Include="MainForm.cs">
  <SubType>Form</SubType>
</Compile>
<Compile Include="MainForm.designer.cs"/>
<EmbeddedResource Include="MainForm.resx">
  <SubType>Designer</SubType>
</EmbeddedResource> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T22:53:07.233

检查此[反馈文章](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=155050&wa=wsignin1.0)是否与您的问题相符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T14:37:59.487

您是否尝试过添加包含一些内容的选项卡？有时，当没有任何内容可供托管时，设计师不喜欢向您展示托管内容的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T22:13:22.373

所以..

我注意到 .designer、.resx 和表单类代码在 Visual Studio 中都被列为单独的文件（不会自动加入）。

我不知道是什么原因造成的，恢复源代码+项目没有帮助。

但是..我决定做我应该做的事，即分别保存 3 个文件，通过 Visual Studio 界面将它们全部删除，保存项目，将 3 个文件移回并将它们添加为现有项目，然后再保存和重建一切。毕竟这一切又好了……

如果有人知道为什么将三个文件分开，我会在那里奖励赏金:-)

也感谢以上所有反馈:-)

# ruby - 从工厂女孩那里返回模拟对象

> ID：588466
> 
> 赞同：1
> 
> 时间：2009-02-25T23:50:00.763
> 
> 标签：ruby, unit-testing, mocking, factory-bot, ruby-mocha

我在 JRuby rails 应用程序中使用 Mocha 和 Factory_girl。当我打电话给工厂时，我想返回已经完成一些模拟的对象。这是我正在尝试做的代码片段。

```
Factory.define :tweet_feed_with_tweets, :parent => :tweet_feed do |t|
  t.expects(:pull_tweets).returns([Factory.build(:status),Factory.build(:status)])
end 
```

因为我不希望我的单元和功能测试实际上从 twitter API 中提取，所以我想存根该方法，以便它返回我想要的。但是，这是行不通的。对象在没有任何存根的情况下返回。有没有办法在工厂女孩创建的对象返回给您之前实际执行存根？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-01-26T12:29:50.040

回调现在可用：

```
Factory.define :tweet_feed_with_tweets, :parent => :tweet_feed do |t|
  t.after_build do |tt|  
    tt.expects(:pull_tweets).returns([Factory.build(:status),Factory.build(:status)])
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T09:28:15.373

查看文档和源代码`factory_girl`，看起来生成给块的对象（`t`在您的示例中）是 a 的实例，`Factory`而不是您要构造的对象的实例（`tweet_feed_with_tweets`在您的示例中）。这意味着为`pull_tweets`on`t`方法设置期望值是在`Factory`实例上设置期望值，而不是在调用时将构造的对象上设置期望值`Factory(:tweet_feed_with_tweets)`。我认为这解释了为什么您的示例没有按预期工作。

我可能错了，但我看不到在`Factory.define`块内添加期望的方法。您可能已经想到了这一点，但我认为您最好在构建实例后在测试中添加期望：-

```
def test_should_do_something
  tweet_feed = Factory(:tweet_feed)
  tweet_feed.expects(:pull_tweets).returns([Factory.build(:status), Factory.build(:status)])
  # test stuff here
end 
```

如果您在多个地方需要它，您可以将其提取到一个方法中：-

```
def test_should_do_something
  tweet_feed = build_tweet_feed_with_tweets
  # test stuff here
end

private

def build_tweet_feed_with_tweets
  tweet_feed = Factory(:tweet_feed)
  tweet_feed.expects(:pull_tweets).returns([Factory.build(:status), Factory.build(:status)])
  return tweet_feed
end 
```

其他一些想法：-

1.  我认为无论如何，在这样一个隐蔽的地方设定期望可能是个坏主意。
2.  如果您要这样做，我会认为 using`stubs`比`expects`.
3.  `pull_tweets`将方法（和任何类似的方法）分离到一个`TwitterAPI`类中可能是值得的。这样一来，您需要在测试中设置期望值就不会那么糟糕了`TwitterAPI`。

我希望其中一些有所帮助。

# c# - 用于创建记录的 MVC 和 lambda

> ID：588478
> 
> 赞同：0
> 
> 时间：2009-02-25T23:52:34.907
> 
> 标签：c#, asp.net-mvc, lambda

我正在尝试将记录添加到数据库中。我的模型相当简单：一个带有与 Company 表关联的 companyId 字段的 Project 表。

这是我被卡住了..

```
var companyTemp = collection["company"];
var company = isspDB.Company.Where(co => co.companyId == 1).First(); 
```

我基本上需要的是：

```
var company = isspDB.Company.Where(co => co.companyId == collection["company"]).First(); 
```

但这不起作用，“......不接受'1'参数”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T23:59:00.633

我猜该集合包含一个字符串变量。尝试将 companyId 的字符串表示形式与此值进行比较，看看是否不起作用。或者，您可以从集合中解析出整数公司 ID 并进行比较。

```
var company = isspDB.Company
                    .Where( co => co.companyID.ToString() == collection["company"] )
                    .First(); 
```

# php - 将网页开发与网页设计分开

> ID：588483
> 
> 赞同：3
> 
> 时间：2009-02-25T23:54:11.440
> 
> 标签：php

我是网络开发的学生，我有一个关于业务的问题（放学后，找工作等）。

现在，我的大学教会了我几件事，而我自己也学到了几件事。我们经常使用 XHTML 1.1、CSS 2.1、Javascript（主要是表单检查）和 PHP，我们所有的代码都必须符合 W3C（在线验证器），否则我们甚至没有评分。就我自己而言，我已经对 jQuery 做了一些改动，明年我们将获得 ASP.NET 和 LINQ。我也对 MySQL 有过相当程度的了解，但我不认为自己是专家。

问题是，虽然我喜欢编写网站/应用程序并寻找新的东西和方法，但我在设计/“让它看起来很漂亮”方面的技能非常糟糕。

我想知道的是，在业务中，这如何影响工作机会？

我的意思是，给我一个 PSD 文件和必要的图像，我会给你你的工作站点，没问题。我将记录我的代码和所有内容。但是要自己想出外观......我发现很难决定使用哪种颜色来做某事，悬停效果应该是这样还是那样，我这样做时是否应该出现一个小箭头，等等等等等等

是否期望开发人员同时成为设计师？还是有些公司将其分开而其他公司则没有？

问题是，我对公司没有任何经验。我不知道他们如何实现他们网站的创建。因为作为学生，我们没有一个设计师团队告诉我们要做什么，我们必须自己做所有事情。幸运的是，院长已经说过设计不会影响成绩。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-26T00:03:26.007

不要担心设计。接下来是它。你做什么其实更重要；功能总是取代视觉存在。

我不相信你会因为缺乏设计技能而在找工作时遇到任何麻烦。他们会雇用其他人来制作图形。

我也相信，绝大多数优秀的程序员都是糟糕的设计师，这是众所周知的。见鬼，看看[Jon Skeet 网站](http://www.yoda.arachsys.com/csharp/)的设计吧！你还需要什么证据？！

最好的祝福...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T23:55:42.653

我会将您描述为 Web 开发人员。

网站布局属于平面设计领域。当然，情况并非总是如此。有一些才华横溢的人，两全其美，但很少见。我认为这些类型的人都可以成为大师，但不能两者兼而有之。

听起来您在 Web 开发方面很有天赋。坚持下去。在平面设计和网站布局方面，尽你所能。当您需要与平面设计师合作时，它将为您提供帮助。

在软件工程师的面试中，如果我被问及图形设计，那会引发危险信号。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T00:01:05.807

一些公司将职业分开。我为一些广告公司做网站和小型桌面应用程序，我无法布置两个不难看的按钮。通常我与本地设计师合作（他们无法理解一行代码，但这是另一个问题）。

但是随着时间的推移和经验的增加，我觉得我正在学习一些东西，有一次或两次我觉得同时拥有代码知识和设计品味会非常好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T00:03:23.540

我在一家小型网络开发公司工作，刚开始时我和你一模一样。没有一个关于如何进行设计的想法。幸运的是，我的工作是制作一个 PSD，然后把它变成一个网站。

不过，慢慢地，我想出了一些有助于设计的东西。如果你坚持下去，你也会的。随着时间的推移学到的一些小东西有很大帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-26T00:03:56.347

完全依赖公司。就个人而言，我是一个绝对糟糕的设计师，我知道这一点。因此，我只与设计师一起从事过工作（作为员工和自由职业者）。他们完全按照你说的做，设计网站并给我一个 PSD，我把它切片并实际运行。

但是，我有朋友在他们都做的公司工作，这取决于工作。职位发布或面试应该明确任何特定工作的方式，我不会提前担心太多。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-26T00:07:01.427

你是一名网络开发人员，不要害怕成为那样的人。两者都擅长真的很难，我认为一个好的 Web 开发人员应该擅长所有的代码，并且知道他们在设计方面的局限性。

你会发现你作为设计师的技能无论如何都会随着时间的推移而提高。作为一名开发人员，您可能永远不会想出令人惊叹的漂亮设计，但您会了解什么可行，什么不可行。

一个简单有效的设计总是比那些过于努力并最终看起来像狗早餐的东西要好。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-26T00:10:44.023

我不认为有一个明确的答案，所以我会提供一个意见。很难对“一些公司做什么”与“其他公司做什么”给出一个完整的答案。

许多使用 Silverlight 和 Windows Presentation Foundation（我可以用作示例的 Microsoft 产品）的公司肯定将设计与开发分开。这些工具是专门为此目的而设计的，因为认识到这些技能（设计和开发）只是不同的，而不是在一个人身上常见的。当像微软这样的公司投资这样的东西时，可能意味着很多人认为这是一个好主意。（好吧，我知道我只是为自己设置了一些不同的意见......）

您的帖子听起来像您关心您的职业发展。我的建议是你在某件事上变得优秀，或者在一些非常相关的事情上变得优秀。然后让你的事业从那里开始，追随你的幸福。你的技能足迹会自然增长。

干杯! 格雷格奥利弗 [MSFT]

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-26T00:12:41.723

有一个老生常谈的术语来描述同时也是设计师的 Web 开发人员：开发者（或占卜者）。这是[一个参考](http://www.builderau.com.au/news/soa/Diviner-A-new-role-between-the-developer-and-designer-/0,339028227,339281238,00.htm)。

就我个人而言，我认为你只需要成为一名开发人员和设计师，如果这是你自己的角色。如果您要开始自己的 Web 服务或去为没有资源聘请设计师的小公司工作，这将是必需的。

但实际上，你不能指望简单地成为一名设计师，而不像成为一名开发人员那样付出同样的努力。除非您有礼物，否则您不会随便拿起它。听起来你没有。我也不。

我发现开发人员类型可以擅长复制设计。如果您能找到一个非常适合您的开发项目的设计，您可能可以（高雅和恭敬地）​​复制基本设计或布局。事实上，你可以非常熟练地使用这种技术，而不必拥有真正艺术家的艺术眼光。

您不想做的一件事是在您并不真正知道自己在做什么的情况下花费大量时间进行设计。没有什么能更快地拖延你。专注于你最擅长的事情；您实际上可以按时有效地交付什么。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-26T00:14:30.813

我们曾经试图雇佣一个图形向导和网页设计师的组合……我们在任何一个类别中都有优秀的人，但没有人能同时做到足够的程度。优秀的程序员在他们的设计中极简主义，创造出具有逻辑布局的可爱的功能性网站。另一种方式......好看，但一团糟。

所以不用担心。Web Designer（XHTML、CSS、JavaScript）很好。

# reporting-services - 如何在 VS2003 中突出显示 rdl 项目的 xml 视图？

> ID：588497
> 
> 赞同：0
> 
> 时间：2009-02-25T23:59:59.913
> 
> 标签：reporting-services, visual-studio-2003, rdl

我过去从未使用过 Reporting Services，我注意到 Rdl 项目的 XML 视图在 VS2003 中没有提供语法高亮显示，它的所有纯文本

有人知道如何启用它吗？

谢谢，

奥斯卡

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T02:35:06.390

这不可能。早在 2002 年 VS2003 发布时，该功能就不存在了。

我建议您下载免费的 Visual Studio Express 版本之一。他们有一个很好的 XML 编辑器，带有语法高亮。

# java - Java：从向量中删除自定义对象

> ID：588503
> 
> 赞同：0
> 
> 时间：2009-02-26T00:04:18.983
> 
> 标签：java, collections, vector

我有`MyClass`，它存储两个整数，我有一个`Vector<MyClass>`被调用的`myVector`.

现在，我这样做：

```
...
myVector.add(new MyClass(1,1));
for(MyClass m : myVector)
    System.out.println(m);
System.out.println(myVector.size());

myVector.remove(new MyClass(1,1));
for(MyClass m : myVector)
    System.out.println(m);
System.out.println(myVector.size());
... 
```

这里的问题是对象没有被删除，正如我在打印 Vector 及其大小时看到的那样。我怎么能解决这个问题？

**编辑：**我可以看到它没有找到对象，我已经测试过`contains()`可以确定。我需要的是按价值进行比较。如果我可以重载`==`操作员，我可以做到，但我不知道如何解决这个问题。

**编辑2：**好的，`equals()`会做我想做的。但我不确定在 hashCode 方法中放什么。

**编辑 3：**我可以使用 contains() 找到它，但删除不会删除它。

我可以用它来删除它：

```
int position = myVector.indexOf(new MyClass(1,1));
myVector.remove(position); 
```

这与 remove(new MyClass(1,1) 相同，除了上面的代码有效而 remove() 无效。有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T00:12:24.050

你有两个选择：

*   `equals()`为 MyClass实现，或
*   删除您添加的相同对象实例

您的代码已修改以删除您添加的同一实例：

```
MyClass myClass = new myClass(1,1);
myVector.add(myClass );
for(myClass m : myVector)
  System.out.println(m);
System.out.println(myVector.size());

myVector.remove(myClass );
for(myClass m : myVector)
  System.out.println(m);
System.out.println(myVector.size()); 
```

我看到其他人提供了一个示例实现`equals()`——但你必须决定这是你想要的吗？很可能是这样。您可以选择上述两个选项中的哪一个适合该对象。

正如其他人所说，如果您实施，`equals()`那么您**必须**实施`hashCode()`. Eclipse 有一个不错的右键单击选项来实现`equals()`和`hashCode()`. 我见过有人实现的代码问题，`equals()`所以虽然这似乎是一个理论上的问题，但实际上并非如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T00:08:43.323

您正在尝试删除不同的 myClass，即使它包含与第一个相同的值。

如果您希望它们被视为相等，则需要覆盖 myClass 的 equals 方法以检查值是否相等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T00:11:16.767

您需要实现`.equals()`这两个对象才能考虑......好吧，相等。但请记住，合同`.equals()`基本上`.hashCode()`告诉您，`.hashCode()`无论何时实施，您都必须实施`.equals()`。

[Effective Java 第 3 章](http://java.sun.com/developer/Books/effectivejava/Chapter3.pdf)会告诉你更多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T00:18:10.417

[`grammar31`的回答](https://stackoverflow.com/questions/588503/removing-a-custom-object-from-a-java-vector/588522#588522)几乎没有错误；在这里修复它们：

```
@Override
public boolean equals(Object o) {
  if ((o == null) || (o.getClass() != myClass.class)) {
    return false;
  }
  myClass other = (myClass) o;
  return (other.a == this.a) && (other.b == this.b);
}

@Override
public int hashCode() {
  return a * 31 + b;
} 
```

这假设`myClass`有`int`成员`a`和`b`。

# jquery - 如何使用 jquery 将外部内容加载到 div（想想嵌入式灯箱）

> ID：588509
> 
> 赞同：1
> 
> 时间：2009-02-26T00:06:03.767
> 
> 标签：jquery, thickbox

使用Thickbox 很棒，它允许我将外部网站加载到thickbox 中，并且它们保留了它们的功能、外观等。我知道如何使用jquery 将简单内容加载到div 中，但我不知道如何将外部内容加载到div 中一个页面（最好通过 onload 事件）并让该 div 像Thickbox 一样工作，并在没有弹出Thickbox 窗口的情况下保留功能和外观。

所有站点都位于不同的子目录中，但具有相同的父目录。

我希望我解释得足够好。

我正在使用 jquery 1.3.1。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-09-24T08:43:47.240

使用 jQuery 加载功能很棒。

一个简单的代码示例是加载外部文件的 div 在`$('#result').load('simple/test.html');`哪里`#result`，simple/test.html 是要加载的 html 页面路径。

有关更多信息，请访问[http://api.jquery.com/load/](http://api.jquery.com/load/)并按照说明进行操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T00:52:37.820

就我个人而言，我会选择一个 iFrame，根据您的描述，我认为它会提供相同的功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T01:04:20.617

Thickbox （通常）*是*一个 iframe .. 如果内容来自外国网站（您无法控制的网站），iframe 几乎是您唯一的解决方案..

# ruby-on-rails - 第一个 Activerecord 模型缺少属性/方法

> ID：588511
> 
> 赞同：1
> 
> 时间：2009-02-26T00:07:16.777
> 
> 标签：ruby-on-rails, activerecord, passenger

我有一个非常奇怪的问题。我从数据库中获取了一组 Rails ActiveRecord 模型，但集合中的第一个模型没有模型属性/方法，只有标准的 ActiveRecord 基本方法。其余的具有所有属性。它只在我使用Passenger的生产debian服务器上执行此操作。它适用于 OS X 和 cygwin。

有任何想法吗？

谢谢，凯文

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T00:38:49.243

它可能是您的生产数据库中的错误数据。

我会调高您的日志级别（生产环境不记录 SQL 查询），找到正在生成的查询，然后打开您的生产数据库并运行查询并查看它返回的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T02:22:04.220

如果不进行一些调试，很难确定这一点，但我可能会考虑调查的一件事是线程问题。我相信 ActiveRecord 会在需要时动态定义这些方法，并且您可能会在访问第一个模型的过程中访问它。Ruby 的“require”语句可能会出现类似的问题——如果您在一个线程中需要某些东西，那么当您尝试在另一个线程中访问它时，该类可能还没有完全定义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T07:44:13.557

当您说*集合中的第一个模型没有模型属性/方法*时，是因为您`NoMethodError`在尝试调用其中一个时遇到异常吗？

`object.methods`在您尝试实际调用它们之前，模型对象没有属性方法（例如，在转储 的输出时）是正常的。当您尝试调用有问题的缺失方法之一时，将触发`ActiveRecord`的`method_missing`处理程序，并且如果方法名称与数据库中定义的列之一的名称匹配，则将动态创建该方法并且不会引发异常. 如果这没有发生，要么是因为对象属于错误的类（与您期望操作的模型不匹配），要么是因为插件或 gem 因`method_missing`处理链中的行为不端而干扰。

您可以将无属性对象实例的 self.class.name 等于的内容转储到日志（logger.info 或 logger.info，具体取决于您的日志级别）中吗？您还可以对安装在生产环境和本地安装的 gem（和相应版本）进行审计吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T19:12:50.070

问题是我不想为 SQL Server 2005 使用正确的 freetds 版本。我使用的旧协议版本不支持超过 30 个字符的列名，这就是它找不到我调用的属性的原因。它被截断了。在我的 freetds.conf 中更改它可以解决问题。感谢[Vlad](https://stackoverflow.com/users/66516/vlad-romascanu)提供的所有故障排除帮助。

# c# - 返回未知的通用列表

> ID：588524
> 
> 赞同：24
> 
> 时间：2009-02-26T00:11:58.527
> 
> 标签：c#, generics, types

并感谢您的帮助。

我将如何从一个未知的 Generic.List 类型的方法返回。

```
public void Main()
{
  List<A> a= GetData("A");   
}

public List<T> GetData(string listType)
{
   if(listType == "A")
   {
     List<A> a= new List<A>() 
     ...
     return a; 
   }
   else
   {
     List<B> b = new List<B>()
     return b;

   }
} 
```

在下面的示例中，我收到类似于以下内容的错误：无法转换`List<A>`为`List<T>`

这可能吗？错误发生在'return a;' 行代码。
另外，我需要做什么来确保在线上不会发生错误：

```
List<A> a= GetData("A"); 
```

谢谢，史蒂文

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-02-26T00:22:10.437

使用`IList`而不是`List<T>`.

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-26T00:38:52.723

限制为返回对象列表的替代方法是确保 A 和 B 从公共基类型派生或实现公共接口，然后返回该基类型或接口的列表。包括对通用方法的约束：-

```
List<ICommon> GetData<T>() where T: ICommon
{

} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-26T00:28:44.463

你不能直接返回`List<T>`这样的。

为什么？基本上是因为`List<A>`and `List<B>`(or `List<string>`vs `List<int>`which is the same thing)被认为是2个完全独立的不相关的类。
正如您不能`string`从声明为 return 的函数中返回 a 一样`int`，您也不能从声明为返回整数列表的函数中返回字符串列表。这里`<T>`有点红鲱鱼。你也不能编写一个同时返回字符串和整数的通用方法......

有关此类事情的更多信息，请参见[此处。](https://stackoverflow.com/questions/31693/differences-in-generics/31929#31929)

因此，您要做的就是返回两种类型都派生自的东西（它们“具有共同点”。）
正如[John Rasch 所说](https://stackoverflow.com/questions/588524/return-unknown-generic-listt/588551#588551)，您可以返回`IList`, （注意 NON 泛型，因此它只是`object`s 的列表）或简单地返回它作为一个`object`. 不幸的是，没有办法保留列表的类型。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-02-26T00:59:02.517

除非有特定原因无法提前指定实际类型，否则您可以将方法本身设为通用：

```
public void Main() {
    List<A> a = GetData<A>();
}

public List<TType> GetData<TType>() {
     List<TType> list= new List<TType>();
     ...
     return list; 
} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2018-08-28T12:36:08.300

您可以执行以下操作：

```
public void Main()
{
    List<int> a = GetData<int>();
    List<string> b = GetData<string>();
}

public List<T> GetData<T>()
{
    var type = typeof(T);
    if (type.IsGenericType && type.GetGenericTypeDefinition() == typeof(Nullable<>))
    {
        type = type.GenericTypeArguments[0];
    }

    if (type == typeof(int))
    {
        var a = new List<int> { 1, 2, 3 };
        return a.Select(v => v != null ? (T)Convert.ChangeType(v, type) : default(T)).ToList();
    }
    else if (type == typeof(string))
    {
        var b = new List<string> { "a", "b", "c" };
        return b.Select(v => v != null ? (T)Convert.ChangeType(v, type) : default(T)).ToList();
    }
} 
```

也许您可以根据需要对其进行修改。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-26T00:28:02.560

根据 Orion 在下面的回答进行编辑，添加 AnthonyWJones 建议的约束

你可能应该有一个 A 和 B 继承自的接口/抽象类

```
 public interface IMyInterface { }
    public class A : IMyInterface { }
    public class B : IMyInterface { }

    public List<IMyInterface> GetData<T>() where T : IMyInterface
    {
        List<IMyInterface> myList = new List<IMyInterface>();
        if (typeof(T) == typeof(A))
        {
            myList.Add(new A());
        }
        if (typeof(T) == typeof(B))
        {
            myList.Add(new B());
        }
        return myList;
    } 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-26T00:37:49.730

如果您直到运行时才知道所需的类型，那么泛型可能是该工作的错误工具。

如果您的函数基于参数显着改变行为（如更改返回类型），那么它可能应该是两个函数。

看起来这个函数不应该是通用的，实际上应该是两个函数。

```
public void Main() {
    List<A> a = GetDataA();
}

public List<A> GetDataA() {
     List<A> a= new List<A>() 
     ...
     return a; 
}
public List<B> GetDataB() {
     List<B> b= new List<B>() 
     ...
     return b; 
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-20T00:39:27.203

我最近不得不解决一个类似的问题，其中提出的解决方案都不令人满意；约束类型参数是不切实际的。相反，我**让方法的使用者决定如何处理数据**。例如，您可以编写返回强类型列表的通用版本的 String.Split()，只要您告诉它如何将子字符串转换为 T。

一旦您愿意将责任转移到调用堆栈上（并且可以轻松地传递 lambda），您就可以任意推广这种模式。例如，如果您 GetData() 的方式不同（正如某些响应显然假设的那样），您也可以将该函数提升到调用者的范围内。

演示：

```
static void Main(string[] args)
{
    var parseMe = "Hello world!  1, 2, 3, DEADBEEF";

    // Don't need to write a fully generic Process() method just to parse strings -- you could 
    // combine the Split & Convert into one method and eliminate 2/3 of the type parameters
    List<string> sentences = parseMe.Split('!', str => str);
    List<int> numbers = sentences[1].Split(',', str => Int32.Parse(str, NumberStyles.AllowHexSpecifier | NumberStyles.AllowLeadingWhite));

    // Something a little more interesting
    var lettersPerSentence = Process(sentences,
                                     sList => from s in sList select s.ToCharArray(),
                                     chars => chars.Count(c => Char.IsLetter(c)));
}

static List<T> Split<T>(this string str, char separator, Func<string, T> Convert)
{       
    return Process(str, s => s.Split(separator), Convert).ToList();
}

static IEnumerable<TOutput> Process<TInput, TData, TOutput>(TInput input, Func<TInput, IEnumerable<TData>> GetData, Func<TData, TOutput> Convert)
{
    return from datum in GetData(input)
           select Convert(datum);
} 
```

函数式编程大师可能会对这种探索打哈欠：“你只是编写了几次 Map。” 甚至 C++ 人也可能声称这是模板技术（即 STL transform() + functors）比泛型需要更少的工作的示例。但是作为主要使用 C# 的人，很高兴找到一个既保留类型安全又保留惯用语言使用的解决方案。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-09-06T18:18:27.440

我知道它为时已晚，但我带着同样的问题来到这里，这就是我使用接口解决问题的方式。以为我会为了他人的利益而发布它

```
 public interface IEntity
    {
        int ID
        {
            get;
            set;
        }
    }

public class Entity2:IEntity
    {
        public string Property2;

        public int ID
        {
            get
            {
                throw new NotImplementedException();
            }
            set
            {
                throw new NotImplementedException();
            }
        }
    } 
```

Entity1 也是如此。

现在在我的班级（我的业务层）我有这个方法

```
 public List<IEntity> GetEntities(Common.EntityType entityType)
           {
               List<IEntity> entities = new List<IEntity>();

               switch (entityType)
               {
                   case Common.EntityType.Accounts:
                       Entity1 entity1 = new Entity1();
                       entity1.Property1 = "AA";
                       entities.Add(entity1);

                       break;
                   case Common.EntityType.Brands:
                       Entity2 entity2 = new Entity2();
                       entity2.Property2 = "AA";
                       entities.Add(entity2);

                       break;
                   default:
                       break;
               }

 return entities;
       } 
```

从用户界面，我会这样称呼它

```
BusinessClass b = new BusinessClass();
        List<IEntity> a = b.GetEntities(Common.EntityType.Accounts); 
```

希望这可以帮助

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-12-05T10:48:20.293

一种解决方案是将数据封装在一个容器中，该容器将作为[访问者模式](https://en.wikipedia.org/wiki/Visitor_pattern)中的*客户端*工作。

首先是一些匹配模式的接口：

```
/// <summary>
/// The Client
/// </summary>
interface IDataContainer
{
    void AcceptDataProcessor(IDataProcessor dataProcessor);
}

/// <summary>
/// The Visitor.
/// </summary>
interface IDataProcessor
{
    void WorkOn<TData>(List<TData> data);
} 
```

然后是每个的实现：

```
class DataContainer<TData> : IDataContainer
{
    readonly List<TData> list;

    public DataContainer(List<TData> list)
    {
        this.list = list;
    }

    public void AcceptDataProcessor(IDataProcessor dataProcessor)
    {
        dataProcessor.WorkOn(list); // Here the type is known.
    }
}

class PrintDataProcessor : IDataProcessor
{
    public void WorkOn<TData>(List<TData> data)
    {
        // print typed data.
    }
} 
```

然后使用它：

```
public void Main()
{
    var aContainer = GetData("A");
    var bContainer = GetData("B");

    var printProccessor = new PrintDataProcessor();

    aContainer.AcceptDataProcessor(printProccessor); // Will print A data
    bContainer.AcceptDataProcessor(printProccessor); // Will print B data
}

public IDataContainer GetData(string listType)
{
    if (listType == "A")
        return new DataContainer<A>(new List<A>());
    if (listType == "B")
        return new DataContainer<B>(new List<B>());
    throw new InvalidOperationException();
} 
```

这个想法是`DataContainer`知道底层类型但不公开它。

*   它不会公开它，因此`GetData`可以包含任何类型的数据（但它被隐藏了）。
*   `DataContainer`知道底层类型，负责调用worker的好类型化方法：`dataProcessor.WorkOn(list);`

这是一个强大的模式，但在代码方面成本很高。

# sql-server - How could I generate a contextual text extract from text returned from a SQL Server Full-Text Index?

> ID：588528
> 
> 赞同：4
> 
> 时间：2009-02-26T00:12:48.027
> 
> 标签：sql-server, full-text-search

I'm experimenting with an idea using SQL Server's Full Text Indexing. It seems perfect for the task, but what my client wants is a very Google-like results summary, where the results display an extract of the text *around their search term*.

If I search for "house"...

> [My House Is a Very, Very, Very Fine House](http://fakelink)
> ...thanks for coming to visit our **house** today...don't you like this **house**...hey, why are you setting fire to my **house**?...

This isn't too hard if their search term is an exact match for what the search hit on. You could simply do some tedious parsing of the text to generate the extract.

But what happens with inflectionals and stemming? If I search for "walk," the query may hit on "walking," "walked," etc. I would need to know exactly *what* word inside the search result it hit on, so I would know from where to base my extraction.

This area seems ripe for some commercial product add-on, or perhaps there's an elegant way to do it that I'm not considering?

(And, yes, we are aware of the the GSA and the Google Mini. There are some subtle reasons why they might not work in this case, so we're trying SQL FTI first.)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T17:23:58.407

如果使用 SQL 2008，我想您可以使用 sys.dm_fts_parser - 发送您的最终搜索字符串（添加任何 FORMSOF 等）。这将返回一个单词列表，然后您可以使用它来突出显示页面上的文本（使用 jquery 插件进行突出显示，任何找不到的单词都不会被突出显示）

# html - 将 CSS 包含在正文中间有多糟糕？

> ID：588529
> 
> 赞同：14
> 
> 时间：2009-02-26T00:12:58.307
> 
> 标签：html, css

那么这个问题是在[这个问题之后出现的](https://stackoverflow.com/questions/584294/how-bad-is-it-to-put-javascript-outside-of-the-header)

原因几乎相同，为了保持东西更干净，调用有多糟糕（确保css不会与覆盖标签发生冲突）

放在 `<link rel="stylesheet" type="text/css" href="mycss.css">`身体中间？（如果有效）

因此，在某些情况下，我可以为特定模块包含特定的 css。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-26T00:21:06.213

虽然理论上你应该只将 CSS 放在`head`标签中，但在实践中这通常是不可行的，或者只是不值得痛苦。

如果您确实将其放在文档中间，则会发生以下两种情况之一：

*   浏览器将开始加载（并显示）您的页面，然后一旦它使用新的 CSS，现有内容将更改或移动

*   浏览器将需要更长的时间来显示您的内容。

第一件事似乎很糟糕，但通常不是问题。好吧，反正对我来说不是，因为 10 次中有 9 次，如果你把 CSS 放在页面中间，CSS 只是“为”后面的内容“构建”的，不会影响上面的东西，所以它们无论如何都不会移动或改变

因此，要回答您关于“它有多糟糕”的问题，我想说 - 一点也不差，只是要小心编写影响在 CSS 文件之前加载的页面部分的 CSS。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-26T00:16:27.737

`<link>`仅允许在文档的`<head>`部分中使用：[文档关系：LINK 元素](http://www.w3.org/TR/REC-html40/struct/links.html#edef-LINK)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-26T00:17:55.440

老实说，如果你在一个大项目中只做一次或几次，那么糟糕的布局可以节省你重新编写新解决方案的时间......去吧。你是对的，它有效。

你会得到答案，因为它是无效的，因为它是不正确的，如果你这样做太多次，我同意你应该重新考虑并解决真正的问题。但是一次？我说去吧；网络仍然是一个非常不完美的地方。

只是不要申请和我一起工作，我们不会忍受这里的废话。

**编辑：** 刚刚看了你的其他问题和你正在谈论的网站。如果这与您的周末项目有关，请以正确的方式进行。尽早并经常养成良好的习惯。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-26T00:52:37.900

它现在可能有效，但由于链接标签只允许在头部，因此不能保证它将来会有效；浏览器更新可能导致不再使用 css。

但话又说回来，也许不是。

无论如何，我绝对不会推荐它。

**编辑：**每个人都在抱怨 IE 不遵守标准，我们也不要作为开发人员开始这样做。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-26T00:16:40.577

样式表应包含在 head 标记中。否则，您可能会得到奇怪的渲染“轻弹”，具体取决于浏览器。如果您真的想使用每个模块的 css 样式表，您应该为模板的 head 标签提供挂钩。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-12-06T21:02:43.240

理论上 - 如果您需要将 css 样式加载到正文中，您可以使用 php include。但我不确定 - 如果它不起作用 - 尝试将你的 css 文件更改为 php：

样式.php：

```
<style>
body {}
</style> 
```

或使用 jquery 加载构造并创建新样式元素并将其附加到正文中。

# versioning - 是否有任何推广候选发布的规范？

> ID：588533
> 
> 赞同：5
> 
> 时间：2009-02-26T00:14:15.730
> 
> 标签：versioning, release-management

我想知道这一点，因为我刚刚意识到，我以前从未与提供过候选版本的公司打交道，而且我看到这些天越来越多地使用这个词，所以我想更清楚地了解他们影响。

对于以前为提供 RC 的公司实际工作过的任何人……是否有任何更正式的规范来说明候选版本的实际需要（例如 RC 和 Beta 之间的区别），或者它只是一个政策每个公司自己决定的事情？

如果您碰巧在一家拥有此类规范的公司工作，您能否提供一些示例，说明它所阅读的某些指南确实将版本提升为“候选发布版”。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-26T00:26:30.800

我看到 RC 这个词有两种用法：

1.  作为一个实际的发布候选。这是我们将要交付给客户的构建，除非我们找到一些阻碍。在发现主要错误之前不会进行新构建，然后旋转新构建并重新开始。通常在发货前存在 3-10 个这样的构建。
2.  作为“优于测试版”的构建。没有实际发布构建的意图，它只是介于 beta 和发布之间的一个临时检查点。通常，测试版没有新功能，只有稳定性。这就是微软近年来在 Windows 团队中使用该术语的方式（Windows 2000、Windows XP、Windows Vista）。

我更喜欢自己第一次使用。这更有意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T00:18:41.740

发布候选的经典定义是它可能是最终版本。只有在发现 showstopper 或召回类错误时才会生成新版本。

# java - close 是否会抛出 IOException？

> ID：588546
> 
> 赞同：28
> 
> 时间：2009-02-26T00:19:25.750
> 
> 标签：java, ioexception

在此处提供了一些答案并阅读了一些评论之后，似乎在实践中 IOException 永远不会在关闭文件 I/O 时抛出。

在任何情况下，在 Stream/Reader/Writer 上调用 close 实际上会引发 IOException？

如果真的抛出了异常，应该如何处理呢？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-26T00:24:19.230

我发现了两种情况：

*   当缓冲区中仍有数据要刷新时丢失网络连接。
*   当缓冲区中仍有数据要刷新时，让文件系统填满（或达到文件大小的用户限制）。

这两个示例都取决于缓冲区中仍有数据时发生的事情。Close 在文件关闭之前刷新缓冲区，因此如果将数据写入文件时出错，则会引发 IOException。

如果执行以下代码，将要在网络驱动器上创建的文件的名称传递给它，然后在按下回车键之前拔下网络电缆，这将导致程序在关闭时抛出 IOException。

```
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;
import java.io.Writer;

public class Test
{
    public static void main(final String[] argv)
    {
        final File file;

        file = new File(argv[0]);
        process(file);
    }

    private static void process(final File file)
    {
        Writer writer;

        writer = null;

        try
        {
            writer = new FileWriter(file);
            writer.write('a');
        }
        catch(final IOException ex)
        {
            System.err.println("error opening file: " + file.getAbsolutePath());
        }
        finally
        {
            if(writer != null)
            {
                try
                {
                    try
                    {
                        System.out.println("Please press enter");
                        System.in.read();
                    }
                    catch(IOException ex)
                    {
                        System.err.println("error reading from the keyboard");
                    }

                    writer.close();
                }
                catch(final IOException ex)
                {
                    System.err.println("See it can be thrown!");
                }
            }
        }
    }
} 
```

* * *

从 Java 7 开始，您可以使用 try-with-resources 来摆脱这种混乱（删除了`close()`操作的显式异常生成代码）：

```
private static void process(final File file) {
    try (final Writer writer = new FileWriter(file)) {
        writer.write('a');
    } catch (final IOException e) {
        // handle exception
    }
} 
```

这将自动神奇地处理异常，`close()`并在内部执行显式`null`检查。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-26T00:30:13.117

当它发生时，应该像其他任何事情一样处理它`IOException`，而不是像你经常看到的推荐的那样默默地忽略它。我猜，假设是，既然你已经使用了流，那么它是否被正确清理并不重要。

但是，正确清理很重要。如果一个`close()`操作确实引发了异常，它很可能涉及刷新一些输出、提交一些事务（在你认为是只读的数据库连接的情况下）等等——绝对不是应该忽略的事情。而且，由于这种情况很少见，因此您不会通过中止操作来显着损害应用程序的可靠性。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-02-26T00:24:12.710

对于文件，您可能不会在 close() 上看到经常抛出 IOException，但您肯定会在非文件 I/O 中看到它，例如关闭到网络的套接字。

[这是一个 Java 错误示例](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6204940)，其中关闭 UDP 套接字最终导致抛出 IOException。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-26T12:35:32.280

`FileInputStream.close`即使您的硬盘着火了，它也不会抛出异常。大概套接字输入是相同的。对于输出流，您也可能正在刷新。直到最近 [see timestamps]过去，如果抛出`BufferedOutputStream`，则无法关闭底层流。`flush`

（@MaartenBodewes 希望我指出，`FileInputStream.close`API 文档没有指定不抛出。在发帖时，习惯上省略提到这与 Sun JDK（现在称为 Oracle JDK 和 OpenJDK）有关的条款. 看起来，Android 曾经使用的一个名为 Apache Harmony 的不知名的重新实现可能有不同的行为。可能其他实现或 OpenJDK 版本也可能抛出。）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-26T10:09:34.097

检查调用 close 时会发生什么，异常隐藏如何影响您以及您可以做些什么：[博客文章](http://illegalargumentexception.blogspot.com/2008/10/java-how-not-to-make-mess-of-stream.html)。

# makefile - 为什么 GNU make 删除文件

> ID：588550
> 
> 赞同：16
> 
> 时间：2009-02-26T00:21:56.630
> 
> 标签：makefile, gnu-make

我有一个用于运行测试的略显老套的 makefile：

```
### Run the tests

tests := tests/test1 tests/test2 ...

test: $(tests)

$(tests): %: %.c
    gcc -o $@ $(testflags) $<
    $@ 
```

它有效，但它使 Make 做一些我以前从未见过的事情。我的测试目前已损坏，并导致总线错误。Make 给出以下输出：

```
gcc -o tests/test1 [flags blah blah] tests/test1.c
tests/test1
make: *** [tests/test1] Bus error
make: *** Deleting file `tests/test1' 
```

我对最后一行很好奇。我以前从未见过Make这样做。为什么Make会删除已编译的测试？

注意：我对这个示例进行了大量编辑以使其更简单。我可能引入了一些错误。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-26T00:23:18.640

因为目标可能没有正确构建。下次您`make`进行项目时，它将尝试重建目标。如果文件没有被删除，`make`就无法知道出了什么问题。 `make`无法知道失败来自测试而不是构建目标的过程。

* * *

在您的情况下是否需要这种行为取决于测试的性质。如果您计划修复测试以使其不会导致 a `Bus error`，则删除目标并不是什么大问题。如果您想稍后使用目标进行调试，则需要更改您的 make 过程。

不删除目标的一种方法是使用`.PRECIOUS`目标。

* * *

另一个可能是：

```
$(tests): %: %.c
    gcc -o $@ $(testflags) $<
    -$@ 
```

未经测试，但[文档](http://www.gnu.org/software/make/manual/make.html#Errors)表明目标不会被删除：

> 当没有告知 make 忽略的错误发生时，这意味着当前目标无法正确重新制作，任何其他直接或间接依赖于它的目标也不能正确重新制作。不会对这些目标执行进一步的命令，因为它们的先决条件尚未实现。

和：

> 通常，当命令失败时，如果它完全更改了目标文件，则该文件已损坏并且无法使用——或者至少它没有完全更新。然而文件的时间戳表明它现在是最新的，所以下次 make 运行时，它不会尝试更新该文件。情况与命令被信号杀死时的情况相同；请参阅中断。所以通常正确的做法是如果在开始更改文件后命令失败，则删除目标文件。如果 .DELETE_ON_ERROR 显示为目标，make 将执行此操作。这几乎总是你想做的，但这不是历史惯例；所以为了兼容性，你必须明确地请求它。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-26T00:24:45.643

避免这种行为的一种方法是将构建和测试执行分为两个步骤：

```
tests := tests/test1 tests/test2 ...

test: $(tests) runtests

$(tests): %: %.c
    gcc -o $@ $(testflags) $<

runtests: %.out: %
    $< | tee $@ 
```

（我的 make 语法可能有错误，任何人都可以更正它。）一般的想法是让测试运行生成一个输出文件，这样更容易`make`单独运行每个测试。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-26T00:33:58.117

这是 make 的默认行为。当命令返回错误代码（例如非零返回）时，make 目标将被删除。.PRECIOUS 和 .IGNORE makefile 指令可以改变这种行为。

# internet-explorer-6 - IE6定位

> ID：588555
> 
> 赞同：1
> 
> 时间：2009-02-26T00:23:23.650
> 
> 标签：internet-explorer-6

我已经将菜单（左）相对于包装器定位，每个浏览器都正确显示它，除了 ie6 for win，为什么？

我尝试 -50% 边距技巧 我尝试显示内联技巧 我尝试所有相对技巧 我尝试绝对技巧

**似乎没有任何效果**

帮助，有什么想法吗？

[链接](http://www.acecrodeo.com/new/02-saviez-vous.php)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T11:48:46.713

[这是来自positioniseverything.net](http://www.positioniseverything.net/explorer/doubled-margin.html)的完整解释

简而言之，解决方案是添加： display: inline; 到CSS

在我的情况下它工作！......太棒了！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T09:34:56.190

问题出在重置 css 道具中……我只是添加了一个很好的 ul 重置，现在一切都很好！谢谢

# perl - 我可以在我的主目录中安装预配置的 Perl 二进制包吗？

> ID：588559
> 
> 赞同：5
> 
> 时间：2009-02-26T00:24:30.917
> 
> 标签：perl, installation, compilation

我想在我的主目录中设置 Perl 5.10 以及当前机器上 /usr/local 中的古老 Perl。我不是这台机器的超级用户。

我找到了 require [5.10 HPUX perl](http://hpux.connect.org.uk/hppd/hpux/Languages/perl-5.10.0/)二进制包，它似乎可以工作，但由于某种原因，它似乎假设它在 /usr/local 中运行（@INC 错误消息证明了这一点）。除了 PERLLIB 之外是否还有其他变量，例如 PERLHOME 或我需要设置的东西，以便 Perl 不会在 /usr/local 目录中查找任何内容？

PS 我在[网上](http://ask.metafilter.com/81802/Installing-perl-in-a-user-folder)看到了在 ./Configure 步骤中编译和设置目录的建议，但是我一直很难在这个旧盒子上编译东西，所以我更喜欢使用预编译的 Perl，因为它似乎大部分都可以工作。

* * *

更新——Leon 回答了这个问题，所以基本上不可能从你的主目录正确运行 perl 二进制文件，除非它是在考虑到这一点的情况下编译的

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-26T23:30:40.583

你不会喜欢这个答案的。

Perl 将@INC 作为字符串存储在其二进制文件中。在出现`userelocatableinc`重新定位 Perl 的技术之前，是对二进制文件进行搜索和替换，以及在 Config.pm 中更改它们。这就是 ActiveState 发布可重定位 Perl 的方式。

字符串必须保持与以前相同的大小，用空字节填充任何额外的空间。ActiveState 将通过使用诸如“/xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxTMPPATHxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx”之类的前缀配置 Perl 来解决此问题。这也使得在二进制文件中查找变得非常明确。你没有这样的运气，所以它只有在当前路径短于你想要替换它们的路径时才会起作用。

但这太复杂了。只需使用 HP/UX 的源代码为自己编译 Perl，或者从 perl.org 获取常规源代码。Perl 有一个专门的 HP/UX 开发人员，所以一切都应该顺利进行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-26T00:28:40.017

这取决于您的`perl`二进制文件是否可重定位。这是一个编译时选项。这个命令的输出是什么？是否已定义？

```
perl -V:userelocatableinc 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-26T01:07:57.770

您可以在第一行中指向您想要的任何解释器路径：

```
!#/my/local/perl 
```

如果您不是在寻找跨机器的可移植性，您可以在脚本中手动设置@INC。我认为也有一种方法可以从环境中获取它，这可能更便携。

# java - 你如何处理生成的代码？

> ID：588564
> 
> 赞同：3
> 
> 时间：2009-02-26T00:26:27.947
> 
> 标签：java

处理生成代码的好策略是什么？我们的一个项目使用 Apache CXF 的*wsdl2java*工具为一组 wsdls 生成 JAX-WS 存根。这段代码应该如何处理？

我可以看到两个选项：

1.  生成一次存根并将它们存储在版本控制中。有了这个，您不必处理 IDE 类路径问题，因为您的树（或附近）中就有源文件。但是，除了有人想对生成的代码进行模仿之外，您在版本控制中还有很多额外的混乱

2.  每次构建时都会生成存根。这颠倒了 #1 的优点/缺点，因为开发人员现在必须处理运行构建脚本并将生成的 jars 添加到他/她的类路径中。

我们选择了#2，因为类路径相关问题的烦恼似乎超过了#1 中详述的问题。

其他人在做什么？有没有人有任何建议来简化这个过程？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-26T00:32:05.843

我的态度是生成的代码实际上不应该存储在版本控制中。必须有一个令人信服的理由才能这样做。我通常创建一个构建所有生成代码的 ant 任务“build-for-eclipse”。我运行它，刷新创建生成代码的目录，瞧，我可以走了。

目标是您拥有一个任何开发人员都可以执行的“一键式”琐碎任务，因此他们将在其 IDE 中拥有所有源代码（生成的而不是非生成的），但没有任何*输出*存储在源代码控制中。如果它是生成器的*输出*，那么根据定义它不是*source*。:-)

这应该可以安全地满足每个人的需求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T00:37:32.273

我已经尝试了两种方式，并决定不存储生成的代码作为一般规则。当存在细微的、微不足道的差异时，这可能是一个问题，并且看起来修订控制发生了变化，实际上没有什么重要的。此外，使用 #1，您最终可能会在存储库中放入大量垃圾，尤其是在生成的代码是二进制的情况下。大多数 repos 不存储二进制代码的差异，而是完整的副本。

即使在像您这样生成的内容是文本的情况下，我也倾向于不存储它，除非我绝对必须对其进行代码更改才能使其正常工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-26T00:39:32.813

我更喜欢选项#3，它具有 1 和 2 的优点，但没有缺点：永远不要将生成的文件提交到源代码控制中，但要创建一个全自动和可移植的构建过程（一个 shell 命令在每个工作站上运行它）。

在 SO（和“网络”）的其他地方有很多关于这两个方面的讨论。可以这么说：源代码控制是针对 SOURCE，而不是生成的代码或二进制文件，并且此类源代码包括自动化可重复构建的脚本。

您真正的问题取决于基于 IDE 的构建过程，这将不可避免地伤害您。让开发人员为构建配置他们的 IDE，但不要将农场押在它上面，也不要让它进入你的源代码控制系统。

最良好的祝愿。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T00:29:56.877

我想您会发现 J2EE/EJB 2.x 人群不得不处理与[XDoclet](http://xdoclet.sourceforge.net/)类似的问题。以我的经验，我已经看到它以两种方式完成——人们将生成的代码存储在版本控制中*，以及*在构建期间生成代码的人。

只要你有一个好的测试系统，我认为#1 更好。如果您有非常好的工具可以处理样式#2（如 Eclipse 的 Xdoclet 功能），那么就使用它。但请注意——如果您长时间构建和重建，＃2 通常可以填充 JVM 的永久生成，并且重新启动您的 IDE/JVM 通常会很痛苦。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T04:37:39.123

2号比任何一天都好。同样使用#2，您可以利用对代码生成器（在您的案例中为 Apache CXF）所做的改进。每次开始使用新的 CXF 版本时，您不必重新生成和签入。是的，有一个单击构建系统可以完成所有工作:-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-26T12:25:09.357

我们使用 Eclipse 作为主要的 IDE/工具。我们为每个生成的代码定义新的 Java 项目。例如，如果我在一个带有休眠和 Axis Web 服务的 Web 项目中工作。我们的工作区中有这样的结构：

projectWeb：这是主项目，一般是动态网页项目。所有的编码员都在这里工作:-)

projectORM：使用休眠工具生成的代码。

projectWS：使用 Java2WDSL 生成的代码。

projectWSClient：使用 WDSL2Java 生成的代码。

每个项目都处于修订控制 (SVN) 之下。我们使用 Maven 2 作为依赖/构建工具，生成代码的二进制文件作为 jars 保存到我们的 Maven 2 存储库中。在此之前，团队中的一个人（或更多人）负责处理生成的代码并在每一代之后对其进行测试（例如，当模型发生更改时）。

问候

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-01T18:37:29.360

大多数时候，我会选择选项#2。原因很明显，我已经看到其他人对这个选择的足够支持。

我的书中有一个例外。如果以下大部分/全部适用：（
*如“大部分”，你知道——这是一个思考标准，而不是一成不变的……）*

1.  存根代码需要很长时间才能重新生成 (*)
2.  没有有效的方法来提前确定源是否有变化（*a-la* MAKE），因此您必须每次都重建存根。
3.  存根代码预计很少更改（因为生成存根的源很少更改）
4.  存根代码中的任何更改通常都需要手动更改程序的其余部分

我通常会编写生成步骤的脚本（并在源代码管理中记录这些步骤），但只手动生成代理。

上述的典型例子是数据库 ORM 类和 Web 服务代理类。

**（“太长”是多少？这取决于；在高度交互的环境中，一分钟可能“太长”。正如我所说，这是您考虑的标准。在实际编程中，就像在现实生活中一样，你必须选择你的邪恶）。*

# java - 重载超类的方法

> ID：588566
> 
> 赞同：1
> 
> 时间：2009-02-26T00:26:40.740
> 
> 标签：java, polymorphism

我正在为 RTS 游戏构建 AI。（对于[Spring RTS 引擎](http://spring.clan-sy.com/)，如果有人感兴趣的话。）我设置它的方式主要由一组组件组成，这些组件通过触发的事件进行通信。每个组件都有一个方法 handleEvent(Event) 来接收其他组件触发的事件。

事件是一个接口。存在一个层次结构，每个子类都提供有关它们所代表的事件的更详细信息，可以使用特定于该类的 getter 方法来访问这些信息。例如，UnitGainedEvent 类实现了 Event 接口。这个类有一个子类 UnitFinishedEvent（对于任何好奇的人来说，它表示一个单元或建筑物的建造已经完成。）

不是每个组件都会对所有事件感兴趣，所以我想让组件简单地选择他们感兴趣的事件并只接收这些事件。此外，可能的事件集是可扩展的，因此让组件为每种事件类型指定方法不是一个有效的选项。最初我认为访问者模式可能会帮助我解决这个问题，但它失败了，因为它还需要一组固定的事件类型。（我不是 100% 确定我正确理解了模式。如果我错了，请纠正我。）

到目前为止，我发现的唯一解决方案是实现每个组件的 handleEvent(Event) 方法，如下所示：

```
public int handleEvent(Event event)
{
    if (event instanceof UnitGainedEvent)
    {
        UnitGainedEvent unitGainedEvent = (UnitGainedEvent) event;
        // things to do if I lost a unit
    }

    else if (event instanceof UnitLostEvent)
    {
        UnitLostEvent unitLostEvent = (UnitLostEvent) event;
        // things to do if I lost a unit
    }

    // etc.
} 
```

但是，我真的不喜欢将事件强制转换为特定的 Event 类。现在，记住方法重载可用于根据参数的运行时类型调用不同的方法，我很快想出了一个绝妙的解决方案，既简单又优雅：我可以创建一个带有空实现的基类 handleEvent(事件），并且简单地让子类通过创建方法handleEvent（UnitGainedEvent unitGainedEvent）来接收他们感兴趣的事件，例如。为了确保它可以工作，我设置了一个快速测试用例：

```
public class Main
{
    public static void main(String[] args)
    {       
        handleEvent(new UnitGainedEvent(null));
    }

    public static void handleEvent(Event event)
    {
        System.out.println("Handling generic Event");
    }

    public static void handleEvent(UnitGainedEvent event)
    {
        System.out.println("Handling UnitGainedEvent");
    }
} 
```

令我非常满意的是，这段代码实际上打印了“Handling UnitGainedEvent”。于是我着手实施。

我的 Component 基类看起来像这样：（嗯，不是真的。这是 Component 类剥离了与我想演示的问题无关的所有内容。）

```
public class Component
{
    public void handleEvent(Event event)
    {
        System.out.println("Handling Event");
    }
} 
```

这是一个子类的例子：

```
public class SomeComponent extends Component
{
    public void handleEvent(UnitGainedEvent unitGainedEvent)
    {
        System.out.println("Handling UnitGainedEvent");
    }   
} 
```

为了测试设置，我使用以下主类：

```
public class Main
{
    public static void main(String[] args)
    {
        Component component = new SomeComponent();
        component.handleEvent(new UnitGainedEvent(null));
    }
} 
```

所以我运行了代码，令我惊讶的是，结果是一个打印整齐的“处理事件”。有趣的是，如果我将组件变量的类型更改为 SomeComponent，它*会*打印出“Handling UnitGainedEvent”。由于某种原因，系统会盲目地调用 Component 类的 handleEvent(Event) 方法，而不是重载 SomeComponent 的 handleEvent(UnitGainedEvent)。（我很想听听 Sun 在这背后的推理，认为这与我的问题并不真正相关 - 不像他们会仅仅因为少数人会发现它是一个非常有用的功能而修复它。）

淘网告诉我其他人也遇到了同样的问题。从我找到的微不足道的信息来看，很少有人，但仍然有人，尽管我发现有关一般方法重载和覆盖的信息比我想知道的要多。但是，最后，我找不到解决方案。

现在，我的（相当明显的）问题是，有没有办法解决这个问题？如果做不到这一点，谁能想到或帮我找到另一个同样方便的解决方案？

编辑：我简直不敢相信我在十分钟后就有了答案。我很惊喜。:) 但是，到目前为止，大多数答案都以一种或另一种形式表明我为每种可能的事件类型制作了一种单独的方法。从技术上讲这是可能的，但这需要我回到代码中并在每次有人提出新的事件类型时添加一个新方法。我学到的是糟糕的编码实践。（另外，我已经有大约 20 多种事件类型，但我什至还没有完成。）相反，我宁愿使用涉及强制转换的解决方案，如上所述。至少这样我可以确保未知的事件类型被简单地忽略，让我可以自由地只处理那些我想使用它们的事件。然而，我真的希望有一个结合了两者优点的解决方案。没有铸造，

非常感谢，Loid Thanead

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T00:38:04.660

> 所以我运行了代码，令我惊讶的是，结果是一个打印整齐的“处理事件”。有趣的是，如果我将组件变量的类型更改为 SomeComponent，它会打印出“Handling UnitGainedEvent”。由于某种原因，系统会盲目地调用 Component 类的 handleEvent(Event) 方法，而不是重载 SomeComponent 的 handleEvent(UnitGainedEvent)。

重载并不是这样工作的。您需要在子类而不是超类上调用重载方法。由于您引用的是 Component 类型，Java 不知道您已经在子类中重载了该方法，它只知道您是否已**覆盖**它。

你真的需要通用的 handleEvent(Event) 类吗？您是否可以为特定的 Event 子类编写 handleEvent() 方法，而不需要 Event 超类的处理程序？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T00:39:29.960

在上面的示例中，您正在重载基类中的方法，但您没有覆盖它。`UnitGainedEvent`如果您在您的类中定义了一个抽象（或空）方法来处理它，它将按预期工作`Component`。

您可能需要考虑从不同的角度解决问题。您可以采取的一种方法是对各种听众进行类似于 Swing 中所做的事情。您可以对事件进行逻辑分组，并为这些事件提供多个侦听器。然后，您可以在每个组中提供一个适配器，以便客户端可以覆盖它们，只处理他们感兴趣的特定事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T00:40:08.350

看起来您正在寻找Java 不支持的[协变](http://en.wikipedia.org/wiki/Covariance_and_contravariance_(computer_science))参数（但是，协变返回类型是）。

为什么不使用[观察者模式](http://en.wikipedia.org/wiki/Observer_pattern)？如果组件总是对特定类型的事件感兴趣，您可以创建一个静态注册表并确保在触发该类型的事件时通知所有感兴趣的组件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T00:41:08.503

访问者模式是正确的解决方案。基本上你需要的是多次调度。您想根据组件类型和事件类型选择一种方法，这在 Java 中是不可能的。查看这篇维基百科文章了解更多信息：[ [http://en.wikipedia.org/wiki/Multiple_dispatch#Java][1]](http://en.wikipedia.org/wiki/Multiple_dispatch#Java][1])。

[1]：[http://多次](http://Multiple)调度

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T00:42:23.587

> 由于某种原因，系统会盲目地调用 Component 类的 handleEvent(Event) 方法，而不是重载 SomeComponent 的 handleEvent(UnitGainedEvent)。（我很想听听 Sun 在这背后的推理，认为这与我的问题并不真正相关 - 不像他们会仅仅因为少数人会发现它是一个非常有用的功能而修复它。）

编译器是“愚蠢的”。像这样改变你的代码，你会明白为什么它必须是：

```
公共类主
{
    公共静态无效主要（字符串 [] 参数）
    {
        组件组件 = new SomeComponent();
        事件事件 = foo();

        组件.handleEvent(事件);
    }
}

```

foo() 返回某种事件，不知道是什么。由于编译器无法知道返回的是什么子类，并且如果组件支持该方法，它所能做的就是使用它所知道的 - 组件类有一个带有事件的句柄事件。

对于您正在做的一些事情，您应该查看 java.util.Event 和 java.util.EventObject 类型。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-26T01:12:54.480

使用反射来获得你想要的效果。当您将事件分派给侦听器时，请查看其方法以找到最佳匹配（您希望编译器为您做的事情）。

您显然希望缓存调用目标，否则性能可能会变得很痛苦。

# c# - Why can't my software initialize hardware on a different motherboard?

> ID：588570
> 
> 赞同：0
> 
> 时间：2009-02-26T00:28:35.727
> 
> 标签：c#, hardware, usb, driver

I am not a developer, but I think that my question is interesting enough (and I am desperate enough) to post here on stackoverflow

My company uses a program written in C# to drive a kiosk PC that uses .Net 2.0 SP1 and a USB signature pad. The signature pad is a HID that uses the generic Microsoft HID driver.

We tried to install our software on a kiosk PC that uses a different brand of motherboard than we previously used. We moved from a Gigabyte board to an ASUS board. Other than the brand, the specs are identical, same north bridge, same south bridge, same CPU, same host controllers etc. Also, our install procedure is documented and hasn't changed in months.

On the new motherboard, the signature pad is recognized as a HID, installs without an issue, and the manufacturers software can run the device, but our software does not recognize that device is even connected. The only thing that has changed is the motherboard brand. The manufactures software that can initialize the device is not written in C#.

Any thoughts, suggestions, or solutions are welcome!!!!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T00:38:18.777

It's could possibly related to programing/but i am thinking its the hardware/driver issue.

You could try removing all drivers and reinstall new drivers under computer management.

Most new motherboards of a different model/brand require windows to be reinstalled.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T01:00:06.260

如果这不是硬件/驱动程序问题，那么可能会发生其他一些事情。

有点（很多）在黑暗中刺伤，但可能是信息亭软件可能有一个硬编码字符串或“魔术数字”埋在其中，旨在识别特定配置中的特定设备，特别是如果软件制造商将其设计为仅在一个特定的板和配置上工作。

这不应该发生，但在地球上，有时（过于频繁）会发生。很久以前，我一直在开发 POS 软件，为了强制供应商锁定硬件供应（不是我的想法），我做了这样的事情。

我会环顾四周，看看两个板上 HID 的硬件 ID 是什么，看看它们是否有任何不同。

可能最好的做法是联系软件提供商，但如果这不是一个选项，您也许可以深入了解程序的内部，以及使用反射器的任何硬编码设备标识符：[http://www .red-gate.com/products/reflector/](http://www.red-gate.com/products/reflector/)。

请注意，由于您不是开发人员，因此这可能看起来像希腊语（如果您精通希腊语，请插入您不理解的任何其他语言），并且解释这一切的含义超出了此答案的范围。但是要查找的是第一块板中 HID 的硬件 ID，或者链接到 USB 控制器的任何其他内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T00:36:50.293

Can you run some kind of debugger or logging on both boards and see what the status etc. is that the device is returning?

# php - Xdebug or ZendDebugger & Logging

> ID：588576
> 
> 赞同：2
> 
> 时间：2009-02-26T00:29:18.283
> 
> 标签：php, debugging, logging, xdebug, zend-debugger

Do any of the well-known PHP debuggers offer any method of logging stack traversal? Say I wanted to somehow store a log of every entry/exit of every class, class method, and function.

Is there any way to do this all on the server side (maybe some sort of plaintext client that could log every step-in/step-out automatically)?

Update: It looks like I would be looking for some sort of PHP-based DBGP client if working with Xdebug. The only thing I've found so far is a CLI client that I can access indirectly with PHP (assuming the PHP runtime user has access): [http://candyscript.com/projects/dbgp/](http://candyscript.com/projects/dbgp/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-03T20:35:05.313

我认为您所追求的可以使用 XDebug 与 KCachegrind(Linux/Unix) 或 WinCachegrind(Windows) 结合来实现。

我可能误解了您的问题，但要了解 KCachegrind 可以为您做什么，请查看以下内容：（ [来源：][[sourceforge.net](http://kcachegrind.sourceforge.net/html/pics/KcgShot3Large.gif)][）][![替代文字](https://i.stack.imgur.com/zrIuE.gif)](https://i.stack.imgur.com/zrIuE.gif)

在右侧，您可以看到调用图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-07T06:38:29.003

试试[PECL 上](http://pecl.php.net/package/xhprof)提供的[xhprof](http://mirror.facebook.net/facebook/xhprof/doc.html) ，它可以满足您的需求。

# xml - Creating Word or XML document with VBA

> ID：588585
> 
> 赞同：1
> 
> 时间：2009-02-26T00:33:06.713
> 
> 标签：xml, vba, xsd, ms-word

I need to create documents, (~150 reports, letters) mostly from pre-existing snippets and local databases, with VBA, in Word 2003\. I then need to change specific parts of those snippets, such as dates, phrases, user information, &c. There are also, obviously, some bits that I will generate in my program.

Currently, this same task is done (sort of) by some hideous legacy VBA. (Nested IFs and FORs, and over 200 textboxes all called TextBox#) It gets the job done SOMETIMES, and does so by sending instructions to the Word application (`Selection.MoveDown Unit:wdLine, Count:=1`, for example.) Consequently, generating even a simple letter takes 30 seconds, and locks up Office.

I'm perfectly able to do the same thing with ranges and bookmarks and improved logic, but my gut feeling is that this should be easy to do this with XML and that doing so will have advantages in the future, as these reports/letters are to be accessed, and likely read programmatically, many times by many different users and applications.

I have been reading about XML and the WordML schema, but feel like I'm missing something.

What I want the code to do on Submit is this:

1.  Grab predefined xml snippets (header, footer, etc.)
2.  Generate new strings and concatenate predefined XML strings
3.  Save as XML
4.  Change value of existing tags in XML file (date, username, etc)

I can do this.

The issues I have are:

*   I been having trouble getting my head around schema and namespaces. The data is already validated by the VBA code, so what do I need a schema for?

*   Is it better to create the document by creating one long concatenated string containing the XML for the entire document, bearing in mind in my model much of the XML would be from existing snippets, or to use the XML Dom and create it programmatically:

`20 Set oElementName = oDOM.createElement("Name")`

`30 oElement.appendChild oElementName`

`40 oElementName.Text = "This is the text of name"`

*   HOW DO I STYLE THE DOCUMENT? (This has been causing me the most trouble, conceptually.) I don't particularly want to reverse engineer it from the WordML that Word generates when it saves. I take it I need to convert it to HTML first? Can I create a stylesheet in Word so it automatically formats it?

Does any of this make sense? Should I just use ranges and bookmarks instead?

XML seems powerful to me, but it could be a twisted case of the hammer and nail problem, i.e. "I want to learn Hammer, so every problem looks like a nail, giving me a good reason to learn Hammer."

(I know I shouldn't be learning how to do things as I do them! But I'm just a mindless drone who complained enough about the quality of our document generation system that they said "Shut up and fix it then! Oh, you don't know any VBA? Well, we can't afford to send you on a course or anything, so learn as you go." It's been the best and worst 2 months of my working life.)

I appreciate you reading through all of that, if you did, and any help/advice you might have!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T01:04:58.027

我不知道您的任务情况，并且可能有充分的理由继续使用您的技术堆栈，但似乎应该重新考虑对 Office 2003 进行如此大的投资（150 份报告很大）。虽然微软说 VBA 不会消失，但我认为 Open XML SDK 有更光明的未来。

这是对 XML 标记的[精彩介绍。](http://openxmldeveloper.org/attachment/1970.ashx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T00:41:51.187

Okay, so I've found an answer to the styling part of my problems. (I always find these things shortly after I submit questions!)

And having read this it makes MUCH more sense to me!

From: [http://www.tkachenko.com/blog/archives/000024.html](http://www.tkachenko.com/blog/archives/000024.html)

```
<?xml-stylesheet type="text/xsl" href="style.xsl"?>
<chapter title="XSLT Programming">
    <para>It's <i>very</i> simple. Just ask <link
url="http://google.com">Google</link>.</para>
</chapter> 
```

Then XSLT stylesheet (quite big one due to verbose element-based WordML syntax):

```
<xsl:stylesheet version="1.0"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="http://schemas.microsoft.com/office/word/2003/2/wordml">
    <xsl:template match="/">
        <xsl:processing-instruction 
name="mso-application">progid="Word.Document"</xsl:processing-instruction>
        <w:wordDocument>
            <xsl:apply-templates/>
        </w:wordDocument>
    </xsl:template>
    <xsl:template match="chapter">
        <o:DocumentProperties>
            <o:Title>
                <xsl:value-of select="@title"/>
            </o:Title>
        </o:DocumentProperties>
        <w:styles>
            <w:style w:type="paragraph" w:styleId="Heading3">
                <w:name w:val="heading 3"/>
                <w:pPr>
                    <w:pStyle w:val="Heading3"/>
                    <w:keepNext/>
                    <w:spacing w:before="240" w:after="60"/>
                    <w:outlineLvl w:val="2"/>
                </w:pPr>
                <w:rPr>
                    <w:rFonts w:ascii="Arial" w:h-ansi="Arial"/>
                    <w:b/>
                    <w:sz w:val="26"/>
                </w:rPr>
            </w:style>
            <w:style w:type="character" w:styleId="Hyperlink">
                <w:rPr>
                    <w:color w:val="0000FF"/>
                    <w:u w:val="single"/>
                </w:rPr>
            </w:style>
        </w:styles>
        <w:body>
            <w:p>
                <w:pPr>
                    <w:pStyle w:val="Heading3"/>
                </w:pPr>
                <w:r>
                    <w:t>
                        <xsl:value-of select="@title"/>
                    </w:t>
                </w:r>
            </w:p>
            <xsl:apply-templates/>
        </w:body>
    </xsl:template>
    <xsl:template match="para">
        <w:p>
            <xsl:apply-templates/>
        </w:p>
    </xsl:template>
    <xsl:template match="i">
        <w:r>
            <w:rPr>
                <w:i/>
            </w:rPr>
            <xsl:apply-templates/>
        </w:r>
    </xsl:template>
    <xsl:template match="text()">
        <w:r>
            <w:t xml:space="preserve"><xsl:value-of 
select="."/></w:t>
        </w:r>
    </xsl:template>
    <xsl:template match="link">
        <w:hlink w:dest="{@url}">
            <w:r>
                <w:rPr>
                    <w:rStyle w:val="Hyperlink"/>
                    <w:i/>
                </w:rPr>
                <xsl:apply-templates/>
            </w:r>
        </w:hlink>
    </xsl:template>
</xsl:stylesheet> 
```

# macros - 如何寻址按钮？（OpenOffice 电子表格宏）

> ID：588588
> 
> 赞同：1
> 
> 时间：2009-02-26T00:36:10.637
> 
> 标签：macros, openoffice.org

我有一个在 OpenOffice 中启动宏的按钮。在宏中，我想更改按钮的名称。Excel的原始代码是

```
 ActiveSheet.Shapes("PunchButton").select
    Selection.Characters.Text = "Punch In" 
```

但第一行什么都不做。我已经检查了 OpenOffice 中的工作表，并且按钮的名称正确。我怎么去呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T01:54:05.600

[这里](http://www.oooforum.org/forum/viewtopic.phtml?t=74242)有一段代码显示了如何更改所有按钮的标签和状态，但您想要的按钮除外。

```
Sub clickCommandButton1
    oPage = Thiscomponent.Sheets.getByName("Sheet1").getDrawPage
    iCount = oPage.getCount
    For i = 0 to iCount - 1
        oEle = oPage.getByIndex(i)
        oControl = oEle.getControl()
        If oControl.DefaultControl = "com.sun.star.form.control.CommandButton" Then
            ' Found command button - change label of other buttons '
            If oEle.Name <> "CommandButton1" Then
                oControl.Label = "Inactive"
                oControl.Enabled = False
            End If
        End If
    Next
End Sub 
```

我会修改它以遍历所有按钮，但将内部 if 语句更改为 '=" 而不是 "<>" （如果不需要，请删除禁用）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T06:45:59.890

感谢 Pax，这是我的工作代码。不确定它有多强大，但对于有问题的工作表来说它是有效的。再次感谢，帕克斯。

```
sub testThis
    setButtonLabel("PunchButton", "hello")
    setButtonLabel("ReportButton", "hello")
end sub

sub setButtonLabel(controlName, label)
    oPage = ThisComponent.CurrentController.ActiveSheet.getDrawPage
    iCount = oPage.getCount
    For i = 0 to iCount - 1
        oControl = oPage.getByIndex(i).getControl
        If oControl.Name = controlName Then
            oControl.label = label
            exit sub
        End If
    Next
end sub 
```

# java - 打包 Java 控制台应用程序的最快方法

> ID：588593
> 
> 赞同：4
> 
> 时间：2009-02-26T00:37:20.697
> 
> 标签：java, console, classpath, packages

我在自定义包层次结构中构建了一组非常小的类，其中一个控制台应用程序类使用它们。在 JCreator 和命令提示符下一切正常。

我想构建第二个控制台应用程序来重复使用相同的包。

作为一个 Java 新手，最快、最肮脏的方法是什么？

我主要关心的是避免将包目录复制到新控制台应用程序的目录中。

使用JCreator，我将包目录添加到项目中并编译运行没有任何问题。但是当我尝试从命令行运行控制台应用程序时，它在包层次结构中找不到类。

在 Visual Studio 中，您只需添加一个引用...

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-26T00:44:03.443

您想要对这两个应用程序执行的操作是在 var 清单中创建一个带有 Main-class 定义的 jar 文件。[Java Tutorials](http://java.sun.com/docs/books/tutorial/deployment/jar/)中有很多关于这方面的信息，但它的要点只是你将使用 jar 工具创建一个 jar 文件，然后制作一个小包装器来运行它

```
java -jar myfile.jar 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T00:46:01.223

如果您不想从第一个应用程序中复制类文件，则需要设置从命令行运行 java 时使用的类路径以包含这些文件的位置。

确保您还包括新创建的类文件的位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T00:51:44.797

使用类似[process exlporer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)的工具，您应该能够看到 JCreator 用来启动您的应用程序的命令行。

（通常 IDE 还包含许多命令行参数，以便能够连接到您的应用程序并对其进行调试等）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T01:02:16.707

如果我没看错的话，你有一个我会调用 A 的类，它引用包 pkg 中的包，现在你希望创建一个新的类 B，它也使用 pkg 中的类。

一种选择是创建一个包含 pkg 中所有类的 pkg.jar 文件，然后创建单独的 jar 文件来保存 A 和 B。在 A.jar 和 B.jar 的清单文件中，您可以包含一个 Class-Path 元素包括 pkg.jar

然后，只要 pkg.jar 与 A.jar 或 B.jar 一起发送，它们就会各自引用 pkg.jar，而不必担心在命令行上指定类路径。

这里有一些细节：http: [//java.sun.com/docs/books/tutorial/deployment/jar/downman.html](http://java.sun.com/docs/books/tutorial/deployment/jar/downman.html)

# c# - How to produce a colored GUI in a console application?

> ID：588622
> 
> 赞同：4
> 
> 时间：2009-02-26T00:47:02.530
> 
> 标签：c#, c++, python, c, console-application

For the following questions, answers may be for C/C++, C#, or Python. I would like the answers to be cross platform if possible but I realize I will probably need `conio` or `ncurses`

1.  How do I output colored text?
2.  How would I do a GUI like `top` or `nethack` where certain things are "drawn" to certain spaces in the terminal?

If possible a small oneliner code example would be great.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T00:54:26.757

Yes, these are VT100 escape codes. The simplest thing is to use some flavor of Curses. Once, you choose a curses flavor it is pretty simple to do both 1 and 2.

Here's a HowTo on ncurses.

[http://web.cs.mun.ca/~rod/ncurses/ncurses.html](http://web.cs.mun.ca/~rod/ncurses/ncurses.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T00:53:24.217

Most terminal windows understand the ANSI escape sequences, which allow coloring, cursor movement etc. You can find a list of them [here](http://en.wikipedia.org/wiki/ANSI_escape_code).

Use of these sequences can seem a bit "old school", but you can use them in cases where curses isn't really applicable. For example, I use the folowing function in my bash scripts to display error messages in red:

```
color_red()
{
    echo -e "\033[01;31m$1\033[00m"
} 
```

You can then say things like:

```
color_red "something has gone horribly wrong!"
exit 1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T00:56:19.780

从这个角度来看，控制台在许多方面只是对经典终端设备的模拟。Curses 最初是为了支持在不同终端类型上执行通用操作的方式而创建的，其中用户可以选择实际使用的终端作为登录序列的一部分。这种遗产今天在 ncurses 中仍然存在。

ncurses 库提供调用函数以直接定位光标并发出文本，并且已知它适用于 Windows 控制台（运行 CMD.EXE 的地方），以及各种 *nix 平台等价物，例如 XTerms 等。如果你有这样的东西，它甚至可能通过串行线路与真正的 Dec VT100 一起工作......

VT100 及更高型号所理解的转义序列成为 ANSI 标准终端的基础。但你真的不想知道这一点。使用ncurses，你就不必了。

依靠 conio 不会让你跨平台，因为那是一个 DOS/Windows 特定的 API。

**编辑：**显然[ncurses](http://www.gnu.org/software/ncurses/)库本身并不容易建立在 mingw 上，至少从快速尝试谷歌搜索中可以看出。然而，一切都没有丢失，因为 ncurses 只是原始[curses](http://en.wikipedia.org/wiki/Curses_(programming_library))库的后代之一。

另一个是*PDCurses* [，](http://pdcurses.sourceforge.net/)它可以为 Windows 控制台以及 X11 和各种 *nix 平台编译和运行。

 *（我刚刚在 Wikipedia 上追逐参考资料时提醒我，curses 来自于编写游戏 rogue，它是 nethack 的祖先。它的一些代码也是从 vi 编辑器的光标管理模块“借来的”。所以探索在[nethack 源工具包](http://www.nethack.org/v343/download-src.html)中的想法可能根本不是一个疯狂的想法......）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T00:55:32.213

Not cross platform but for Windows / C# colour, see

[Color your Console text (C#)](http://www.daniweb.com/code/snippet134.html)

[c++](http://www.daniweb.com/code/snippet83.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T00:57:00.340

在 C# 中，您可以分别通过 Console.ForegroundColor 和 Console.BackgroundColor 属性设置文本颜色和背景颜色。有关有效颜色的列表，请参阅此[MSDN 文档](http://msdn.microsoft.com/en-us/library/system.consolecolor.aspx)。

# c - 自引用结构定义？

> ID：588623
> 
> 赞同：145
> 
> 时间：2009-02-26T00:47:05.573
> 
> 标签：c, recursion, struct, typedef

我写 C 的时间不长，所以我不确定我应该如何去做这些递归的事情......我希望每个单元格包含另一个单元格，但是我得到了一个错误“字段‘孩子’的类型不完整”的行。这是怎么回事？

```
typedef struct Cell {
  int isParent;
  Cell child;
} Cell; 
```

* * *

## 回答 #1

> 赞同：202
> 
> 时间：2009-02-26T00:52:27.230

显然 a`Cell`不能包含另一个`Cell`，因为它变成了一个永无止境的递归。

然而一个`Cell`CAN 包含一个指向另一个的指针`Cell`。

```
typedef struct Cell {
  bool isParent;
  struct Cell* child;
} Cell; 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-02-26T01:27:11.157

在 C 中，您不能引用您正在使用结构本身创建的 typedef。您必须使用结构名称，如以下测试程序中所示：

```
#include <stdio.h>
#include <stdlib.h>

typedef struct Cell {
  int cellSeq;
  struct Cell* next; /* 'tCell *next' will not work here */
} tCell;

int main(void) {
    int i;
    tCell *curr;
    tCell *first;
    tCell *last;

    /* Construct linked list, 100 down to 80\. */

    first = malloc (sizeof (tCell));
    last = first;
    first->cellSeq = 100;
    first->next = NULL;
    for (i = 0; i < 20; i++) {
        curr = malloc (sizeof (tCell));
        curr->cellSeq = last->cellSeq - 1;
        curr->next = NULL;
        last->next = curr;
        last = curr;
    }

    /* Walk the list, printing sequence numbers. */

    curr = first;
    while (curr != NULL) {
        printf ("Sequence = %d\n", curr->cellSeq);
        curr = curr->next;
    }

    return 0;
} 
```

尽管在标准中它可能比这复杂得多，但您可以将其视为编译器`struct Cell`在第一行`typedef`知道但`tCell`直到最后一行才知道:-) 这就是我记住该规则的方式。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-07-29T19:13:40.523

从理论的角度来看，语言只能支持自指结构，不能支持自包含结构。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-07-29T19:05:30.310

有一种解决方法：

```
struct Cell {
  bool isParent;
  struct Cell* child;
};

struct Cell;
typedef struct Cell Cell; 
```

如果你这样声明它，它会正确地告诉编译器 struct Cell 和 plain-ol'-cell 是相同的。所以你可以像平常一样使用 Cell。尽管如此，仍然必须在初始声明本身内部使用 struct Cell 。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-03-24T01:47:42.617

我知道这篇文章很旧，但是，为了获得您正在寻找的效果，您可能想尝试以下方法：

```
#define TAKE_ADVANTAGE

/* Forward declaration of "struct Cell" as type Cell. */
typedef struct Cell Cell;

#ifdef TAKE_ADVANTAGE
/*
   Define Cell structure taking advantage of forward declaration.
*/
struct Cell
{
   int isParent;
   Cell *child;
};

#else

/*
   Or...you could define it as other posters have mentioned without taking
   advantage of the forward declaration.
*/
struct Cell
{
   int isParent;
   struct Cell *child;
};

#endif

/*
    Some code here...
*/

/* Use the Cell type. */
Cell newCell; 
```

在上面代码片段中提到的两种情况中，您必须将您的子 Cell 结构声明为指针。如果您不这样做，那么您将收到“字段 'child' 的类型不完整”错误。原因是必须定义“struct Cell”，以便编译器知道在使用时要分配多少空间。

如果您尝试在“struct Cell”的定义中使用“struct Cell”，那么编译器还不知道“struct Cell”应该占用多少空间。但是，编译器已经知道指针占用了多少空间，并且（通过前向声明）它知道“Cell”是“struct Cell”的一种类型（尽管它还不知道“struct Cell”有多大）。因此，编译器可以在正在定义的结构中定义一个“Cell *”。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-05-24T18:43:17.337

另一种方便的方法是使用结构标记预先定义结构为：

```
//declare new type 'Node', as same as struct tag
typedef struct Node Node;
//struct with structure tag 'Node'
struct Node
{
    int data;
    //pointer to structure with custom type as same as struct tag
    Node *nextNode;
};
//another pointer of custom type 'Node', same as struct tag
Node *node; 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-12-23T10:19:30.910

让我们看一下 typedef 的基本定义。typedef 用于定义现有数据类型的别名，它是用户定义的或内置的。

```
typedef <data_type> <alias>; 
```

例如

```
typedef int scores;

scores team1 = 99; 
```

由于之前未定义的相同数据类型的成员，这里的混淆是自引用结构。因此，以标准方式，您可以将代码编写为：-

```
//View 1
typedef struct{ bool isParent; struct Cell* child;} Cell;

//View 2
typedef struct{
  bool isParent;
  struct Cell* child;
} Cell;

//Other Available ways, define stucture and create typedef
struct Cell {
  bool isParent;
  struct Cell* child;
};

typedef struct Cell Cell; 
```

但是最后一个选项增加了一些额外的行和单词，通常我们不想做（我们很懒，你知道；））。所以更喜欢视图2。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-10-24T13:10:23.137

包含对自身的引用的结构。这种情况在描述链接列表节点的结构中很常见。每个节点都需要对链中下一个节点的引用。

```
struct node
{
       int data;
       struct node *next; // <-self reference
}; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-12-11T17:28:27.770

以前的所有答案都很棒，我只是想深入了解为什么结构不能包含其自身类型的实例（不是参考）。

非常重要的是要注意结构是“值”类型，即它们包含实际值，因此当您声明一个结构时，编译器必须决定为它的实例分配多少内存，因此它会遍历其所有成员并添加增加他们的内存来计算结构的全部内存，但是如果编译器在内部找到相同结构的实例，那么这是一个悖论（即，为了知道结构 A 需要多少内存，您必须决定多少内存结构 A 需要！）。

但是引用类型是不同的，如果一个结构'A'包含一个对它自己类型的实例的'引用'，虽然我们还不知道分配了多少内存，但我们知道分配了多少内存给内存地址（即参考）。

高温高压

# .net - SqlConnection.RetrieveStatistics() 不填充集合（我确实将 StatisticsEnabled 设置为 true ）

> ID：588624
> 
> 赞同：0
> 
> 时间：2009-02-26T00:47:13.107
> 
> 标签：.net, asp.net

我开始学习学习 Ado.net 并且有点卡住了。

1）如果我通过 SqlConnection.StatisticsEnabled 属性启用连接统计，那么我应该能够检索有关 SqlConnection 实例执行的操作的各种信息（通过 RetrieveStatistics() ）。因此，在调用下面的代码之前，我已经打开了一个连接并从数据库中检索了一些值。这样，统计数据应该提供一些命令如何执行的信息。但是从集合中检索到的所有值都返回字符零（转换为字符串时）。知道为什么吗？

```
 ...
 sc.StatisticsEnabled = true;
 IDictionary statistic = sc.RetrieveStatistics();
 Label1.Text = statistic["BytesReceived"].ToString(); //Label1.Text displays 
                                                        character”0” 
```

2) 假设某台 PC 运行两台 Sql 服务器（MySql 服务器和 MS sql 服务器），您将使用什么名称（在连接字符串中）来指定两台服务器中的任何一台？

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T02:15:54.797

根据您提供的代码，我无法判断，但我的第一个想法是您没有打开连接。

至于你的第二个问题，如果你有两个连接字符串并且它们在同一个盒子上，我可能会说 [AppName]MySQLConnectionString 和 [AppName]MSSQLConnectionString

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T17:02:26.133

我无法回答您的统计问题，因为我从未使用过它们，但对于 ConnectionString，您需要使用不同的连接对象。

例如，您不能使用 SQLConnection 对象连接到 MySQL 数据库。您需要使用 MySQLConnection 对象（[链接](http://dev.mysql.com/downloads/connector/net/5.2.html)）。[您可以在此处](http://www.connectionstrings.com/mysql#34)获取有关不同连接字符串选项的信息。

您可以在一台计算机上拥有多个 SQL 服务器，这并不重要。它们都使用不同的 TCP 端口（SQL 1433、MySQL 3306）。

# java - 如何确定哪个菜单项称为 ActionListener？

> ID：588627
> 
> 赞同：0
> 
> 时间：2009-02-26T00:49:47.377
> 
> 标签：java, swing, events, menu, menuitem

我有一个 Java 程序，其中有一个带有任意数量项目的 JMenu（在这种情况下，当前加载到不同程序中的每个动态库都有一个菜单项）。我正在运行一个循环来将 JCheckBoxMenuItem 添加到菜单中，因为我不知道会有多少。

如何为这些菜单项设置一个动作侦听器，以了解哪个选项调用它？具体来说，我想为每个菜单项运行相同的功能，但使用不同的设置或参数（以及根据检查是切换还是解除切换再次使用不同的功能）。

有人能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T00:56:25.550

一定要仔细阅读：http: [//java.sun.com/docs/books/tutorial/uiswing/misc/action.html](http://java.sun.com/docs/books/tutorial/uiswing/misc/action.html)

简而言之，将 ActionListener 添加到 menuItems 中。在 actionPerformed 方法中，使用 event.getSource()。如果需要，您可以将 SAME ActionListener 添加到所有菜单项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T03:11:52.730

虽然 event.getSource() 肯定会让您知道事件来自哪个特定按钮，但它具有需要跟踪生成的按钮或窥探按钮的副作用。此外，您可能希望向用户显示与用于标识库的名称不同的库名称（可能包括版本信息）。使用按钮的“ActionCommand”属性可以提供一种分离这些问题的方法。因此，您需要在生成复选框菜单项和侦听器中更改代码。

```
ActionListener actionListener = ... // whatever object holds the method, possibly this
String[] libraries = ... // however you get your library names
JMenu parentMenu = ... // the menu you are adding them to

for (String s : libraries) {
  // prettyName is a method to make a pretty name, perhaps trimming off
  // the leading path
  JCheckBoxMenuItem child = new JCheckBoxMenuItem(prettyName(s), true);
  child.setActionCommand(s);
  parentMenu.acc(child);
} 
```

动作处理程序代码将是...

```
public void actionPerformed(ActionEvent evt) {
  // the 'current' selection state, i.e. what it is going to be after the event
  boolean selected = ((JCheckBoxMenuItem)evt.getSource()).isSelected();
  String library = evt.getActionCommand();
  ... process based on library and state here...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T00:54:18.940

event.getSource() 应该这样做。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T00:57:30.167

当您构建菜单时，您可以将`Action`对象传递给`JCheckBoxMenuItem`配置了您需要执行给定操作的任何选项（您也可以将对复选框的引用推到此处以检查状态）。这样，当实际执行操作时，您将不必进行任何类型的处理，因为将调用正确的操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T12:29:03.653

干净的方法是`ActionListener`为每个创建一个不同的。`EventObject.getSource`丑陋的。

# java - Java中有未处理的异常处理程序吗？

> ID：588634
> 
> 赞同：18
> 
> 时间：2009-02-26T00:52:50.550
> 
> 标签：java, exception, exception-handling

如果我在.NET 中没记错的话，可以为未处理的异常注册“全局”处理程序。我想知道Java是否有类似的东西。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-26T00:57:32.910

是的，有[`defaultUncaughtExceptionHandler`](http://java.sun.com/javase/6/docs/api/java/lang/Thread.html#getDefaultUncaughtExceptionHandler%28%29)，但只有在`Thread`没有[`uncaughtExceptionHandler`](http://java.sun.com/javase/6/docs/api/java/lang/Thread.html#getUncaughtExceptionHandler%28%29)集合时才会触发。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-26T06:39:27.660

是的

[http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Thread.UncaughtExceptionHandler.html](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Thread.UncaughtExceptionHandler.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T00:59:54.840

[是的，在ThreadGroup](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/ThreadGroup.html#uncaughtException(java.lang.Thread,%20java.lang.Throwable))中有一个“几乎”全局的此类处理程序。它不像您提到的那样具有全局性，但是您基本上可以实现相同的功能。

从 Java 5 开始，可以直接在[Thread 类](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Thread.html)上使用类似的功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T01:00:41.267

通常，像 Struts 和 Spring（以及 Servlet Spec、IIRC）这样的 Java 框架允许您设置全局异常处理程序。但是，这些机制特定于每个框架。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-05-28T08:24:19.847

.NET Java 中未处理的异常：

```
Thread.setDefaultUncaughtExceptionHandler(new
Thread.UncaughtExceptionHandler() {
  public void uncaughtException(Thread t1, Throwable e1) {
   // Exception handling code  
  }
}); 
```

从[这里偷的](https://rollbar.com/guides/java-exception-handling/)

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2009-02-26T00:57:02.460

假设它就像 C++ 中的 catch(...) 你会这样做：

```
尝试
{
   // 你的代码在这里
}
抓住（可投掷的前）
{
   // 任何类型的异常，即使虚拟机被花生呛到了
}

```

一般来说，这不是一个好主意，除非您正在处理第 3 方代码（您应该尝试始终在您自己的代码中抛出 Exception 的子类（而不是 RuntimeException） - 除非它表明应该通过单元处理的程序员错误测试。

# exception - .NET 异常资源管理器

> ID：588640
> 
> 赞同：2
> 
> 时间：2009-02-26T00:54:02.450
> 
> 标签：exception

有谁知道程序或插件或任何我能找出任何方法可能抛出的异常的东西？

如果我没记错的话，我认为 JAVA 有这个构建。编译器告诉你这个方法会抛出什么异常。

.NET 也一样吗？

谢谢

编辑：在搜索了更多之后，我希望有像对象资源管理器这样的工具，除了例外。您选择类或方法，它会在该级别列出该类引发的异常。提供的工具链接是一个很好的开始。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T00:57:49.917

我不知道这是否正是您正在寻找的，但是：

[http://www.red-gate.com/Products/Exception_Hunter/index.htm](http://www.red-gate.com/Products/Exception_Hunter/index.htm)

注意：我从未使用过该产品，我也不为 Red Gate 工作，我只记得以前看到过它的广告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T00:56:57.187

您可以在 Visual Studio 中使用智能感知查看此信息。当您在智能感知列表中突出显示方法名称时，其描述应在底部包含异常列表。通过正确注释您的方法和类来添加此信息。如果您使用的库不是框架的一部分，那么只有在库的开发人员适当地注释了他们的代码时，您才能获得此信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T02:30:42.843

.NET 不要求或允许每个方法声明它抛出的异常。我记得，感觉这会导致大多数开发人员简单地声明“抛出异常”。

# c# - 具有多个约束的通用方法

> ID：588643
> 
> 赞同：301
> 
> 时间：2009-02-26T00:55:07.580
> 
> 标签：c#, generics, .net-3.5

我有一个具有两个泛型参数的泛型方法。我试图编译下面的代码，但它不起作用。它是 .NET 限制吗？是否可以对不同的参数有多个约束？

```
public TResponse Call<TResponse, TRequest>(TRequest request)
  where TRequest : MyClass, TResponse : MyOtherClass 
```

* * *

## 回答 #1

> 赞同：470
> 
> 时间：2009-02-26T01:05:58.197

有可能做到这一点，你只是语法稍有错误。对于每个约束，您需要一个[`where`](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/where-generic-type-constraint "微软文档 |  哪里约束")而不是用逗号分隔它们：

```
public TResponse Call<TResponse, TRequest>(TRequest request)
    where TRequest : MyClass
    where TResponse : MyOtherClass 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2019-05-17T14:30:05.030

除了@LukeH 的主要回答还有另一种用法，我们可以使用多个接口而不是类。（一个类和n个接口）像这样

```
public TResponse Call<TResponse, TRequest>(TRequest request)
  where TRequest : MyClass, IMyOtherClass, IMyAnotherClass 
```

或者

```
public TResponse Call<TResponse, TRequest>(TRequest request)
  where TRequest : IMyClass,IMyOtherClass 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2019-02-16T14:43:16.027

除了@LukeH 的主要答案之外，我还遇到了依赖注入问题，我花了一些时间来解决这个问题。对于那些面临同样问题的人，值得分享：

```
public interface IBaseSupervisor<TEntity, TViewModel> 
    where TEntity : class
    where TViewModel : class 
```

这样就解决了。在容器/服务中，关键是 typeof 和逗号 (,)

```
services.AddScoped(typeof(IBaseSupervisor<,>), typeof(BaseSupervisor<,>)); 
```

这个[答案](https://stackoverflow.com/questions/43087821/how-to-add-a-generic-dependency-injection/43094684#43094684)中提到了这一点。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2021-04-08T15:55:01.333

每个约束都需要在自己的行上，如果单个通用参数有更多约束，则需要用逗号分隔。

```
public TResponse Call<TResponse, TRequest>(TRequest request)
    where TRequest : MyClass 
    where TResponse : MyOtherClass, IOtherClass 
```

根据评论编辑

# c# - 什么是 WPF，它与 WinForms 相比如何？

> ID：588660
> 
> 赞同：48
> 
> 时间：2009-02-26T00:58:36.527
> 
> 标签：c#, wpf, windows

我一直在研究 WPF，但我从来没有真正使用过它（除了 15 分钟，它提示了这个问题）。我查看了这篇[文章](https://stackoverflow.com/questions/193005/are-wpf-more-flashy-like-than-winforms)，但它实际上是关于 WPF 的“Flash”。那么 Windows 窗体应用程序和 WPF 应用程序有什么区别呢？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-02-26T01:04:29.120

WPF 是基于矢量图形的 UI 表示层，而 WinForms 不是。为什么这很重要/有趣？通过基于矢量，它允许表示层平滑地将 UI 元素缩放到任何大小而不会失真。

WPF 也是一个可组合的表示系统，这意味着几乎任何 UI 元素都可以由任何其他 UI 元素组成。这使您可以轻松地从更简单的 UI 元素构建复杂的 UI 元素。

WPF 还完全支持数据绑定，这意味着您可以将 UI 元素的任何属性绑定到 .NET 对象（或对象的属性/方法）、另一个 UI 元素的属性或数据。是的，WinForms 支持数据绑定，但方式更加有限。

最后，WPF 是“可换肤”或“可主题化”的，这意味着作为开发人员，您可以使用列表框，因为这些是您需要的行为，但有人可以“换肤”使其看起来完全不同。

想想一个图像列表框。您希望内容实际上是图像，但您仍然需要列表框行为。通过简单地使用列表框并将内容表示更改为包含图像而不是文本，这在 WPF 中是非常简单的。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-02-26T01:32:42.017

看待这个问题的一个好方法可能是从询问 Winforms 到底是什么开始。

Winforms 和 WPF 都是旨在使应用程序的 UI 层更易于编码的框架。这里真正的老人们可能会谈论如何编写“Hello, World”的 Windows 版本可能需要 4 页左右的代码。此外，那时的岩石要软得多，我们在编码时不得不与巨型蜥蜴作战。Winforms 库和设计器承担了许多常见任务并使它们更易于编写。

WPF 做同样的事情，但意识到这些常见任务现在可能包括更多视觉上有趣的东西，除了包括许多 Winforms 不一定认为是 UI 层的一部分的东西。WPF 支持命令、触发器和数据绑定的方式都是框架的重要组成部分，但其核心原因与 Winforms 最初存在的核心原因相同。

WPF 在此处的改进在于，您现在可以将控件的功能与其外观分开，而不是让您选择从头开始编写完全自定义的控件或强制您使用一组具有有限自定义功能的控件。描述我们的控件在 XAML 中的外观并将其与控件在代码中的工作方式分开的能力与 Web 程序员习惯使用的 HTML/代码模型非常相似。

一个好的 WPF 应用程序遵循与一个好的 Winforms 应用程序相同的模型；将尽可能多的东西保留在 UI 层之外。应用程序和数据层的核心逻辑应该是相同的，但是现在有更简单的方法可以让视觉效果更令人印象深刻，这可能就是为什么你在上面看到的大多数信息都涉及到更炫的视觉内容的原因。如果您想学习 WPF，您实际上可以像使用 Winforms 一样开始使用它，然后在掌握它们时重构其他功能。作为一个很好的例子，我强烈推荐 Scott Hanselman 关于 BabySmash 开发的系列博客文章，[从这里开始](http://www.hanselman.com/blog/IntroducingBabySmashAWPFExperiment.aspx)。这是一个很好的过程演练，无论是在代码上还是在思想上。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-26T01:03:59.010

为了回答您的问题，WPF 应用程序*是*一个 Windows 应用程序。WPF 是微软新的框架（实际上是.NET framework 3.0 的一个子系统），用于编写丰富的Windows 应用程序。它旨在最终替代 WinForms（尽管不可否认，采用率比 MS 希望的要慢得多）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-10-01T16:54:57.203

**WPF**代表Windows演示**基金会**。**_** 虽然 WinForms 技术依赖于 GDI/GDI+，但 WPF 直接构建在 DirectX 之上。这意味着您可以比使用 WinForms 做更多的事情，同时仍然使用 .NET Framework 类库。您可以构建丰富的用户界面、2D/3D 游戏、演示文稿等等。WPF 很像 Flash (swf) 电影，没有“电影”元素。WPF 基于 .NET，可用于构建支持 Web 的富客户端应用程序。

 *** * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-26T05:54:06.943

从这里开始，有几十个视频： http: [//www.windowsclient.net/learn](http://www.windowsclient.net/learn)

在这种情况下，营销手册非常好：

**“Windows Forms 是 .NET Framework 中的一组类，可以快速开发丰富的 Windows 客户端应用程序，具有用于用户界面控件和图形的强大、可扩展的库。您可以通过 WPF 将 WPF 合并到您的 Windows Forms 应用程序中- .NET 3.5 Framework 中的 Windows 窗体互操作性。"*

*“WPF 是 Microsoft .NET Framework 3.5 的一个组件，使您能够构建下一代 Windows 用户体验。WPF 支持 UI、媒体、文档、硬件加速、矢量图形、不同外形尺寸的可扩展性、交互式数据可视化、和卓越的内容可读性。"**

使用 WPF，您可以获得更好的图形支持，更强大和更灵活的数据绑定（如果您正在使用数据，请使用 WPF。）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-09-20T17:14:37.580

1.  WPF 本质上是一个用于为 Windows 平台创建图形用户界面的新 API。
2.  WPF 不仅仅是用于构建 Windows 客户端应用程序以及视觉上令人惊叹的用户界面的下一代演示系统。
3.  WPF 构建在 DirectX (Direct3D) 之上，而不是依赖于较旧的 GDI/GDI+ 子系统。
4.  WPF 是一个基于矢量图形的 UI 表示层，基于矢量，它允许表示层平滑地将 UI 元素缩放到任何大小而不会失真。
5.  WPF 是“可皮肤化”和“可主题化”的。这意味着 WPF 允许更改任何 UI 控件的外观。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-06-23T06:29:09.023

从实现的角度来看，主要区别之一是 WPF 使用严格执行的模型-视图-视图模型 MV-VM 体系结构，视图以自定义标记语言 XAML 定义，视图模型是具有可访问属性的类，以及该模型实际上是数据访问层。相比之下，WinForms 没有这种明确的分离——尽管按照惯例，不同的方面可能会被分组到不同的 C# 文件中，但它仍然是代码。在实践中，这使得 WPF 开发更像是 Web DOM 开发，WPF 框架在后台运行并作为中介。

# .net - 使用 DocumentViewer 控件时如何设置打印作业的名称？

> ID：588662
> 
> 赞同：2
> 
> 时间：2009-02-26T00:58:55.233
> 
> 标签：.net, wpf, xps, documentviewer

我使用 WPF DocumentViewer 控件来显示 XPS 文档，如下所示：

```
viewer.Document = xpsDocument.GetFixedDocumentSequence(); 
```

当单击文档查看器中的打印按钮时，一切打印正常，但是打印作业的名称是 System.Windows.Documents.FixedDocumentSequence，这不太理想。

如何设置打印作业的名称？

我知道使用 PrintDialog.PrintDocument() 可以让我设置名称，但我看不到如何使用 DocumentViewer 控件进行设置。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T01:43:31.490

我找到了解决方案。

将此添加到 XAML

```
<Window.CommandBindings>
    <CommandBinding Command="ApplicationCommands.Print" PreviewExecuted="CommandBinding_PreviewExecuted" Executed="CommandBinding_Executed" />
</Window.CommandBindings> 
```

这就是背后的代码

```
private void CommandBinding_PreviewExecuted(object sender, ExecutedRoutedEventArgs e)
{
    PrintDialog dialog = new PrintDialog();
    if (dialog.ShowDialog() == true)
    {
        dialog.PrintDocument(Document.DocumentPaginator, "Print Job Title");
    }
}

private void CommandBinding_Executed(object sender, ExecutedRoutedEventArgs e)
{
    //needed so that preview executed works
} 
```

有几点需要注意。如果未绑定 Exectued 事件，则不会发生 PreviewExecuted 方法。不知道为什么。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-15T16:48:46.360

我遇到了同样的问题，但是在我的情况下覆盖打印命令不起作用，所以我发现了另一个同样有效的解决方法

```
internal class MyDocumentViewer : DocumentViewer
{
    public string JobTitle { get; set; }

    protected override void OnPrintCommand()
    {
        PrintDialog dialog = new PrintDialog();
        if (dialog.ShowDialog() == true)
            dialog.PrintDocument(Document.DocumentPaginator, JobTitle);
    }
} 
```

# asp.net - 为什么 asp.net 下拉列表按钮颜色与窗口颜色相关联？

> ID：588672
> 
> 赞同：0
> 
> 时间：2009-02-26T01:03:17.343
> 
> 标签：asp.net, controls, drop-down-menu

ASP.NET 下拉列表控件有一个箭头，您可以单击它来下拉列表，该箭头的颜色与用户窗口的配色方案相关联。这对我来说不方便，我需要一个解决方法。但是，我想知道是否有人知道（或猜测）使下拉箭头与系统颜色相关联的策略？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T01:09:39.183

在幕后，Winforms 控件使用自 Windows 3.0 以来就存在的 Win32 控件（或者 3.0 仍然是 16 位？我不记得了）。幕后有很多遗产，而在过去，这样做似乎很有意义。实际上，我认为今天在平台的所有应用程序的用户界面之间强制保持某种程度的一致性仍然是有意义的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T01:15:47.580

实际上，您的下拉列表的样式取决于您的导航器。一些导航器对此提供了比其他导航器更多的支持。例如，与复选框相同的出现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T01:23:14.613

浏览器负责将表单输入标签转换为用户界面控件。Internet Explorer 和其他浏览器通过使用操作系统的用户界面控件来执行此操作。“一个网页想要一个`<select>`？我们已经掌握了这个控制权！”

然而，您可能遇到的问题是 Internet Explorer 对设置这些控件的样式支持非常差，尤其是`<select>`控件。FireFox 和 Chrome 等其他现代浏览器提供了更好的支持。

此时，IE 的唯一选择是 (a) 放弃`<select>`元素，转而采用某种基于 javascript 的组件，或者 (b) 等待 IE8 并希望它有更好的样式支持。由于很难找到`<select>`提供强大键盘支持的 javascript 实现，因此许多人`<select>`现在选择只使用 IE 中的丑陋框 - 牺牲了可用性和可访问性的风格。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T01:34:57.703

它与 ASP.NET 无关；您可以在 Mac 上查看同一个站点，它看起来会有所不同。这就是 windows 显示该类型元素的方式。如果您不喜欢它，那么您将不得不创建自己的。 [它已经完成了](http://www.obout.com/combobox/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-26T01:49:08.810

浏览器在不同程度上会从操作系统中获取用户的颜色设置，就像任何其他应用程序一样，因此在没有任何作者指定的设置的情况下，它们通常是默认设置。

请注意，一旦您开始调整 select 和其他表单元素的样式，您需要确保提供一套非常完整的样式规则，否则它很快就会在手推车中陷入困境，具体速度取决于浏览器。

# flash - 如何将 FLV 批量导入 Flash

> ID：588692
> 
> 赞同：2
> 
> 时间：2009-02-26T01:10:58.743
> 
> 标签：flash, actionscript-3

现在导入 FLV 并将其嵌入到影片剪辑的时间线中是一个相当缓慢的过程，因为它涉及到通过向导。有没有一种有效的方法来批量导入 FLV 并将每个 FLV 嵌入到单独的影片剪辑中？

（注意：我理解嵌入式 FLV 和其他选项的含义，但我们假设嵌入式 FLV 是这里唯一的选项）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T01:27:57.207

好的，鉴于您要导入它们。使用 JSFL 可以实现这样的事情。

JSFL 是一个在 Flash 创作环境中工作的 JavaScript 扩展系统。有一些方法可以将项目添加到时间线和库中。

这是[文档](http://help.adobe.com/en_US/Flash/10.0_ExtendingFlash/WS5b3ccc516d4fbf351e63e3d118a9024f3f-7fe8.html)，请查看 library.addnewitem 和 document.additem 方法。

这应该可以解决问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T18:37:31.833

不幸的是，我没有找到使 FLV 导入向导自动化的方法（wtf Adob​​e??）。

由于 Flash 中不支持 AppleScript（毕竟它有 JSFL），所以我得到的最远的结果是使用 Apple 的 UI 脚本，但我放弃了这一点，因为无法考虑导入不同视频所需的各种时间。

# c# - 代码复制的最佳实践 c#

> ID：588699
> 
> 赞同：3
> 
> 时间：2009-02-26T01:13:49.173
> 
> 标签：c#, code-duplication

我正在尝试以减少/避免代码重复的方式构造我的代码，但我遇到了一个有趣的问题。每次我的代码调用存储过程时，我都需要传递一些存储过程共有的变量：例如用户名、域、server_ip 和 client_ip。这些都来自 HttpRequest 对象或 system.environment 对象。

由于这些被传递给每个存储过程，我最初的想法是创建一个实用程序类，它是一个数据库包装器，并且每次都会初始化并传递它们，所以我不必在我的代码中这样做。问题是尽管 c# 类（在 App_Code 文件夹内）看不到 Httprequest 对象。当然，我可以将此作为参数传递给包装器，但这会破坏创建包装器的整个目的。我在这里错过了什么吗？

我意识到每次调用存储过程时重复 4 行代码并不是什么大不了的事，但我宁愿在早期阶段消除代码重复。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T02:02:01.087

将数据层设置为从包含这些值的 4 个属性的基类继承。使公共构造函数需要这 4 个属性。

然后在业务层做类似的事情——在构造函数中使用这 4 个属性的基类。

然后 UI 执行 new BusObj( Request["username"], ... ).method()

在数据层中，您可以有一个方法来构建具有这 4 个属性的 SQLParameter 数组，然后每个方法都可以向数组添加其他参数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-26T01:32:25.620

作为一般规则，无论编程语言如何，如果您可以眯起眼睛并且代码看起来相同，您应该从中创建一个函数/方法/消息并传递参数。

另一件事是，一旦你的方法采用大量参数（4 是一个很好的经验法则，但它肯定是逐个案例的基础），是时候让该方法接受一个对象作为参数了而不是单个参数。99.99999999999999999999% 的时间这样的对象应该是不可变的（没有可写的实例变量）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-26T01:18:18.867

HttpContext.Current 与您在 HttpRequest 中找到的信息相似，更重要的是在 App_Code 中可用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-26T01:29:56.547

这是一个你可能喜欢也可能不喜欢的奇怪想法：定义一个“配置文件”类和一个函数，该函数将配置文件扩展为采用公共参数的函数的参数。

```
class P {
    readonly string name;
    readonly string domain;
    public P(string name, string domain) {
        this.name = name; this.domain = domain;
    }
    public void inject(Action<string, string> f) {
        f(p.arg1, p.arg2);
    }
    public T inject<T>(Func<string, string, T> f) {
        return f(p.arg1, p.arg2);
    }
} 
```

它可能在您拥有 AddressOf 运算符的 VB.net 中工作得更好。我会非常谨慎地使用这种类型的东西，因为你很容易破坏可读性和封装性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-26T01:18:33.593

我会按照你现在的方式保留它。它更干净，更容易扩展/修改，更容易进行单元测试。

至于像其他人建议的那样使用 HttpContext ，我会说这是一个坏主意。一旦你开始在你的域中引入对 HttpContext 的依赖，就很难将其移除。如果以后你想在没有 HttpContext 的情况下使用你的模块怎么办？那么单元测试呢？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-26T01:19:13.000

尝试 System.Web.HttpContext.Current.Request 以获取当前请求。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-26T01:42:24.737

你可能正在滑下一个滑坡。DRY 的要点是不要在多个地方重复业务逻辑，因为需求的变化会导致需要在多个相似的地方更改代码。如果这 4 行是上下文相关的，那么您不必仅仅因为 4 行是相同的而重构。您还通过引用 httprequest 来破坏封装，因为您使用的是全局变量。作为你类的消费者，我必须知道我只能从 Web 应用程序调用你的实现细节。

话虽如此，如果您考虑到这一点并仍想继续，这里是此类信息的另一种选择。创建包含所需属性的自定义 SecurityPrincipal（实现 IPrincipal）并将其附加到线程。在用户登录时填写它们，然后您可以在请求期间的任何地方访问它。您的调用者仍需要确保已完成此操作，但至少它不是特定于平台的。

否则，为了获得最佳封装，请将具有您需要的属性的类传递给需要使用这些属性的每个对象的构造函数。

# c++ - STL 与自定义实用程序类的程序员生产力

> ID：588700
> 
> 赞同：1
> 
> 时间：2009-02-26T01:14:34.197
> 
> 标签：c++, stl

我在一个环境中工作，由于历史原因，我们正在使用大杂烩的自定义实用程序类，其中大部分是在 STL 出现之前编写的。我认为至少使用 STL 编写新代码是个好主意的原因有很多，但主要原因是我相信它可以提高程序员的工作效率。不幸的是，我不知道如何证明这一点。

是否有任何研究试图量化甚至只是暗示使用 STL 可以提高生产力？

**更新：**我想我应该更具体。我*不*主张重写现有代码，我*也不*担心新员工会获得良好的开端。前者是愚蠢的，后者本身不足以说服人们。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-26T01:31:59.833

没有研究表明 STL 仅仅因为它是 STL 就更有生产力。使用它带来的生产力收益是由于它是标准程序员熟悉它，并且因为代码已经编写和测试。

如果您的公司已经拥有员工熟悉的实用程序类，并且此实用程序代码在整个现有代码库中使用，那么切换到 STL 实际上可能会损害生产力。

也就是说，对于使用 STL 的新代码将是一个很好的举措。我不一定会从生产力的角度来争论这一点，而是从可维护性的角度来争论。如果您的代码早于 STL，听起来您公司的代码生命周期很长，并且很可能多年来由许多新程序员维护。

您可能还想提出使用 STL 作为每个人保持其 C++ 技能集的一种方式。虽然我不会拒绝不了解 STL 的 C++ 候选人，但我肯定会将其视为一个黑标。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-26T01:39:18.363

STL 如此“好”的原因仅仅是因为它已经存在了很长时间，并且实现已经看到了很多用户和眼睛。它们经过了很好的调试，并且算法已经被供应商很好地优化了。

STL 对于您商店中的新开发人员来说会更有效率，因为他们很可能已经熟悉它。您的自定义库将是外来的，并且可能缺少开发人员习惯使用的功能。不过，在新开发者的初始提升期之后，这并不是一个大问题。

没有真正迫切的理由仅仅因为它是转向 STL。如果您的应用程序中有非常有用的实用程序类，我建议您坚持使用它们，除非它们不适用于新代码。在新代码中将 STL 与您的自定义库混合会在某些时候导致兼容性问题，并且重构代码以使用所有 STL 会引入错误。无论哪种方式，您都会失去生产力。

编辑：“新”代码是指使用旧类库的现有应用程序中的新代码。

如果您正在开发不使用任何旧应用程序代码的新独立应用程序，我建议您使用 STL，因为它存在，大多数 C++ 开发人员都知道如何使用它并且它非常稳定（并且您可以从工具集供应商那里获得支持如果不是）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-26T14:49:50.697

我认为关键因素是开发团队的流动率。

如果团队是稳定的，并且他们已经在此代码上工作了 10 年，并且可能会在 10 年后，他们将使用他们熟悉的实用程序类来提高工作效率，并推动他们使用 STL 将导致生产力下降和错误。

如果团队周转很多，那么新开发人员可能会熟悉 STL，显然不会熟悉这个专有的实用类库，并且会更好地使用 STL。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-26T14:59:50.390

我能想到的使用 STL 提高生产力的唯一理由是可以轻松集成其他库 - Boost、Arabica、SOCI 等。它们都是为使用 STL 而设计的，而不是您的内部容器类。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-26T15:13:28.313

我也遇到过同样的情况。这取决于相关的实用程序类。我见过的许多自定义实用程序类都存在错误或设计不佳，并导致整个源代码出现错误和效率低下。在这种情况下，直接替换为 STL 等效项将改进代码库、提高生产力、减少错误并降低未来的维护成本。

有时，您可以通过将 STL 风格的迭代器改装到您的旧类来帮助弥合这两个世界之间的差距，但要小心使它们正确！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-26T02:35:12.070

如果本土实用程序以任何方式特定于您所做的工作的领域，情况可能正好相反。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-26T11:21:47.653

STL 有用的一个地方不是在 STL 提供的实际库等中，而是在 STL 使用的编码风格中。

在下面，需要进行 2 个主要测试：

```
struct DoSomething {
  bool operator ()(Container::value_type const & v) const
  {
    // ...
  }
};

void bar (Container const & c)
{
  std::for_each (c.begin (), c.end (), DoSomething ());
} 
```

第一个测试验证 'DoSomething::operator()' 做了它应该做的事情。第二个测试只需要验证是否调用了“DoSomething::operator()”。

与手写 for 循环相比，这种分离有助于提高生产力。对于上述情况，测试的数量是“要完成的事情”和对非空容器进行调用的测试的总和。在 for 循环的情况下，测试的数量是测试的乘积。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-08-15T11:04:55.083

我看到的原因是：

## 代码质量

STL 的编写者（无论是它的接口，还是您的编译器的实现）无疑比您公司中最好的开发人员要好得多。

他们的工作是制作一个可用的 STL，这意味着无论如何每个函数/方法/对象都经过大量测试。

## 代码的可维护性

随着营业额的增加，一些代码可能会变得缓慢而隐秘地无人维护。这意味着如果此代码中存在错误，或者如果发现其性能或界面缺乏（参见上面的“质量”），那么您将找不到任何人来熟练地改进它。

代码更改在其他地方将具有非零的代码回归概率，并且如果您的内部库没有经过单元测试，那么这种回归将在很长一段时间内未被检测到。

当有人试图纠正代码时发现他不明白为什么要这样做（因为宏，奇怪的前置条件， ETC..

## 结论

将两者结合起来，您会发现对于通用代码（即数组、字符串等），通过从内部库慢慢迁移到 STL 库并在需要时编写“转换器函数”会更好。

我认为这种迁移是代码维护的一部分，并且您应该尽可能缓慢地（即使用新代码或重构时）使用 STL 而不是内部通用库。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-26T01:31:42.017

由于您已经拥有实用程序类，因此无需使用 STL。当您发现需要开始将 STL 集成到您的实用程序库中时，它将很快成为一个可维护性问题。IMO，这将是生产力**损失**。

也就是说，STL 可能会提供许多实用程序库不提供的特性和实用程序。（特别有用的是 <algorithms> 标头，您可能可以立即开始使用它而不会对遗留代码产生很多问题。）如果您正在编写大量新代码，那么使用 STL（和 Boost，如果可以的话）要好得多) 而不是编写自己的实用程序类和算法。因此，这将是一项重大的生产力提升。

不过，我不知道有关该主题的任何研究。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-26T01:36:24.643

考虑雇用新的 C++ 程序员时的情况。她/他更有可能有 STL 课程的经验还是您自己的课程？如果您开始切换到 STL，您可能会在它们变得高效之前节省大量时间。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-26T01:41:23.413

目前，任何新雇用的员工都必须学习如何使用旧课程，这既费时又费钱。像其他人一样使用 STL 可以为您的公司节省资金，并使其在候选人群中保持吸引力。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-26T01:46:35.447

不幸的是，我认为没有办法证明批发替换这些自定义类是合理的。如果可能的话，一次将它们替换为一个类的 STL 组件。

这是一个维护和可读性问题。(1) 使用 STL 可以帮助维护人员一目了然地理解代码，而不是需要了解自定义实现的方式。(2) STL 有很好的文档记录并且很好理解——您的自定义类呢？(3) STL 经过严格审查。(4) STL 带有渐近运行时上限和下限。

祝你好运。

# silverlight - 在silverlight中居中图像的最简单方法？

> ID：588704
> 
> 赞同：0
> 
> 时间：2009-02-26T01:17:24.063
> 
> 标签：silverlight, silverlight-2.0

假设我有一个 3 行的网格。在中间行，我想放置一个图像，然后将它垂直和水平地居中。但是因为（我认为）Silverlight 在居中时使用元素的左上角，所以当我告诉它垂直/水平居中时，图像的左上角会居中。

我已经看到了两种方法：

*   修改事件中的图像位置
*   将图像的边距设置为非常大的数字（500）

有没有更简单的方法？似乎有点奇怪，您需要像这两种方法一样做一些骇人听闻的事情。我宁愿只告诉它它的锚在中心，然后告诉它居中。嗯，可能是一个很好的自定义控件。

**更新**：真正令人讨厌的事情是当我对页面进行了微小的更改以更改该图像的居中方式，而 FF3 显示的是旧版本的页面。这让我觉得它不起作用。然后我把它在 IE 中拉出来，它看起来是正确的。我刷新了 FF3 的缓存，它显示了正确的页面。该死的烦人。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T01:27:16.553

为什么这对你不起作用？

```
<Grid x:Name="LayoutRoot" Background="White">
    <Grid.RowDefinitions>
        <RowDefinition />
        <RowDefinition />
        <RowDefinition />
    </Grid.RowDefinitions>
    <Grid.ColumnDefinitions>
        <ColumnDefinition />
        <ColumnDefinition />
        <ColumnDefinition />
    </Grid.ColumnDefinitions>
    <Image Source="Butterfly.jpg"
           Height="50" Width="50"
           HorizontalAlignment="Center" VerticalAlignment="Center"
           Stretch="UniformToFill"
           Grid.Column="1" Grid.Row="1" />
</Grid> 
```

# ironpython - 如何让 Freebase Python 库在 IronPython 中工作

> ID：588710
> 
> 赞同：1
> 
> 时间：2009-02-26T01:20:17.443
> 
> 标签：ironpython, freebase

如何获取[Python 库以使用 Freebase API](http://code.google.com/p/freebase-python/)在[IronPython 2.0](http://www.codeplex.com/IronPython)下工作？

当我“导入 freebase.api”时，我得到“ImportError：没有名为 django.utils 的模块”。是什么赋予了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T01:43:39.103

您缺少 simplejson 模块。由于 easy_install 还不能与 IronPython 一起使用，最好的办法是使用 SVN 从他们的[Google Code 项目](http://code.google.com/p/simplejson/source/checkout)中获取最新的代码，或者[下载一个 zip 文件](http://apiguy.com/files/simplejson-2.0.9.zip)。

将您获得的所有文件放入 IronPython 安装目录下的 lib/site-packages/simplejson 文件夹中。

现在您将能够成功“导入 freebase.api”。

# c - 冲突类型在 C 中总是一个问题吗？

> ID：588711
> 
> 赞同：3
> 
> 时间：2009-02-26T01:20:23.853
> 
> 标签：c, namespaces

我在从 Java 迁移到 C 时遇到了越来越大的痛苦。我已经习惯了具有相同名称但采用不同参数的不同方法。在 C 中这会产生问题吗？

```
Cell makeCell(int dim, int iterations, Cell parent);

Cell makeCell(Cell parent); 
```

是否有一些快速的小工作可以解决这个问题，或者我应该保持僵硬的上唇并打电话给其中一个`_makeCell`或`makeCell2`同样荒谬的事情？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-26T01:27:54.883

在 C 中，您没有重载函数 - 具有相同名称但参数类型不同的函数（忽略`<tgmath.h>`C99 中的 Esoterica）。

必须为函数指定不同的名称。

或者使用支持重载函数名称的不同语言。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-26T01:41:27.940

正如您在 Java 或 C++ 中所理解的那样，C 中没有重载（尽管使用函数指针手动创建了重载，但如果您想要面向对象，请使用 C++，而不是 C 和 kludges :-)，所以您应该怀疑，称它们为不同的函数名称。

但不要称它们为 _makeCell 或 makeCell2，因为这不是描述性的。怎么样：

```
Cell makeCellFromDimensionAndIteration(int dim, int iterations, Cell parent);
Cell makeCell(Cell parent); 
```

第一个可以缩短，但要确保它仍然有意义。makeCell2 对阅读代码的人来说意义不大（包括六个月后的你自己）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-26T01:28:45.550

简单地说，C 中没有方法重载，我认为可以创建预处理器规则来根据参数的数量重命名方法，但我不知道该怎么做，它会给你更多的工作然后简单地使用不同的名称。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-26T03:27:31.553

欢迎来到 C 地狱。有一个大的扁平命名空间，没有重载，因此您需要约定来帮助您发明和管理名称。寻找灵感的好地方是 Dave Hanson 的[C Interfaces and Implementations](http://www.cs.princeton.edu/software/cii/)。

对于您的特定示例，我会建议以下内容：

```
Cell_T Cell_with_dim(int dim, int iterations, Cell_T parent);

Cell_T Cell_of_parent(Cell_T parent); 
```

（对这些建议不是很有信心，因为我很难猜测不同的重载应该做什么。）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-26T09:23:35.627

正如其他人提到的，没有办法创建两个同名的函数，你可以使用类似的东西：

```
Cell makeCell(Cell parent, int dim, int iterations); 
```

对于这两种情况，并通过一些“特殊值”来区分这两种情况。例如：

```
cell = makeCell(par,-1,-1); 
```

我看到的另一个选项是使用可变数量的参数：

```
Cell makeCell(Cell parent, ...); 
```

但是你有一个问题是确定已经传递了多少个参数，如果你不能通过查看“父级”来做到这一点，那么你基本上回到了前一种情况，因为你必须使用一个“特殊值”来指定如何有很多参数。

如果这是一种构造函数（顾名思义），我宁愿有两个函数：

```
Cell makeCell(Cell parent);
Cell setCell(Cell cell, int dim, int iterations); 
```

一个创建一个新的空单元格，另一个设置需要设置的内容。当然，这取决于“细胞”的性质，如果这对您来说是一个可行的选择。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-26T01:34:10.343

好吧，C 中没有函数重载，但是如果您想要或必须使用 C，您可以通过创建一个接受可变数量参数的函数来实现类似的目的。您可以从这里开始了解各种技术的信息，其中一些相当可移植：[http ://en.wikipedia.org/wiki/Stdarg.h](http://en.wikipedia.org/wiki/Stdarg.h)

不过，一般来说，我会警告不要在 C 中过于广泛地使用这个技巧。使用可变参数函数的最常见原因是实现函数`printf()`，而不是函数重载 kludges。但如果你想要它就在那里。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-26T01:54:48.233

如果您来自 Java，您可能会发现 C++ 比 C 更容易掌握。而且由于您使用的编译器几乎可以肯定是 C++ 编译器，为什么不试一试呢？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-26T09:37:51.943

这是一个常见问题，因为您不能在 C 中重载函数。只有[编译器可以](http://clang.llvm.org/docs/LanguageExtensions.html#overloading-in-c)（如在 tgmath.h 中）。看看`tgmath.h`GCC 已经为我今天的 hack-o-meter 服务了。他们找到了我认为正确的词

> ```
> /* This is ugly but unless gcc gets appropriate builtins we have to do
>  something like this. Don't ask how it works. */ 
> ```

人们发明了不同的方法来解决它。例如，OpenGL 参加了一门课程，其中包括参数类型并计入函数名称：

```
glVertex3f 
```

说这个函数需要 3 个浮点数。

# c++ - 使用 Visual Studios C++ 清单文件

> ID：588712
> 
> 赞同：31
> 
> 时间：2009-02-26T01:20:25.477
> 
> 标签：c++, visual-studio, dll, manifest

我编写了一些代码，利用开源库来完成一些繁重的工作。这项工作是在 linux 中完成的，使用单元测试和 cmake 来帮助将其移植到 Windows。需要让它在两个平台上运行。

我喜欢 Linux，我喜欢 cmake，我喜欢我可以自动生成 Visual Studios 文件。就像现在一样，在 Windows 上，一切都将编译，它将链接并生成测试可执行文件。

然而，为了达到这一点，我不得不与 windows 斗争了几天，学习所有关于清单文件和可再发行包的知识。

据我的理解：

在 VS 2005 中，Microsoft 创建了 Side By Side dll。这样做的动机是，以前，多个应用程序会安装同一个 dll 的不同版本，导致以前安装和工作的应用程序崩溃（即“Dll Hell”）。并排 dll 解决了这个问题，因为现在每个可执行文件/dll 都附加了一个“清单文件”，用于指定应该执行哪个版本。

这一切都很好。应用程序不应再神秘地崩溃。然而...

Microsoft 似乎在每次发布 Visual Studios 时都会发布一组新的系统 dll。另外，正如我之前提到的，我是一名试图链接到第三方库的开发人员。通常，这些东西作为“预编译的 dll”分发。现在，当使用一个版本的 Visual Studio 编译的预编译 dll 链接到使用另一个版本的 Visual Studio 的应用程序时会发生什么？

根据我在互联网上阅读的内容，发生了不好的事情。幸运的是，我从来没有走到那一步——在运行可执行文件时，我一直遇到“MSVCR80.dll not found”问题，因此我开始涉足整个清单问题。

我最终得出的结论是，让它工作的唯一方法（除了静态链接一切）是所有第三方库必须使用相同版本的 Visual Studios 编译 - 即不要使用预编译的 dll - 下载源代码，构建一个新的 dll 并改用它。

这是真的吗？我错过了什么？

此外，如果情况似乎如此，那么我不禁认为微软出于邪恶的原因故意这样做。

它不仅会破坏所有预编译的二进制文件，从而使使用预编译的二进制文件变得不必要地困难，如果您碰巧在一家使用第三方专有库的软件公司工作，那么每当他们升级到最新版本的视觉工作室时 - 您的公司必须现在做同样的事情，否则代码将不再运行。

顺便说一句，linux如何避免这种情况？虽然我说我更喜欢在它上面进行开发并且我了解链接的机制，但我没有维护任何应用程序足够长的时间来遇到这种低级共享库版本控制问题。

最后，总结一下：这种新的清单方案是否可以使用预编译的二进制文件？如果是，我的错误是什么？如果不是，微软真的认为这会使应用程序开发更容易吗？

更新 - 一个更简洁的问题：**Linux 如何避免使用 Manifest 文件？**

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-26T02:00:47.893

应用程序中的所有组件必须共享相同的运行时。如果不是这种情况，您会遇到奇怪的问题，例如在删除语句上断言。

这在所有平台上都是一样的。这不是微软发明的东西。

您可以通过了解运行时可能会反击的位置来解决这个“只有一个运行时”的问题。这主要是在您在一个模块中分配内存并在另一个模块中释放它的情况下。

```
a.dll
    dllexport void* createBla() { return malloc( 100 ); }

b.dll
    void consumeBla() { void* p = createBla(); free( p ); } 
```

当 a.dll 和 b.dll 链接到不同的 rumtime 时，这会崩溃，因为运行时函数实现了自己的堆。

您可以通过提供必须调用以释放内存的 destroyBla 函数轻松避免此问题。

您可能会在运行时遇到一些问题，但大多数都可以通过包装这些构造来避免。

以供参考 ：

*   不要跨模块边界分配/释放内存/对象
*   不要在你的 dll 接口中使用复杂的对象。（例如 std::string, ...）
*   不要跨 dll 边界使用复杂的 C++ 机制。（类型信息，C++ 异常，...）
*   ...

但这不是清单的问题。

清单包含模块使用的运行时的版本信息，并由链接器嵌入到二进制文件 (exe/dll) 中。当一个应用程序被加载并且它的依赖被解析时，加载器查看嵌入在 exe 文件中的清单信息，并使用 WinSxS 文件夹中相应版本的运行时 dll。您不能只将运行时或其他模块复制到 WinSxS 文件夹。您必须安装 Microsoft 提供的运行时。当您在测试/最终用户机器上安装软件时，可以执行 Microsoft 提供的 MSI 包。

因此，在使用您的应用程序之前安装您的运行时，您将不会收到“缺少依赖项”错误。

* * *

（更新为“Linux如何避免使用Manifest文件”问题）

**什么是清单文件？**

引入清单文件以将消歧信息放置在现有的可执行/动态链接库旁边或直接嵌入到该文件中。

这是通过指定启动应用程序/加载依赖项时要加载的 dll 的特定版本来完成的。

（您可以对清单文件执行其他几项操作，例如，可以将一些元数据放在此处）

**为什么这样做？**

由于历史原因，该版本不是 dll 名称的一部分。所以“comctl32.dll”在它的所有版本中都是这样命名的。（所以Win2k下的comctl32与XP或Vista下的comctl32不同）。要指定您真正想要的版本（并且已经测试过），请将版本信息放在“appname.exe.manifest”文件中（或嵌入此文件/信息）。

**为什么这样做？**

许多程序将它们的 dll 安装到 systemrootdir 上的 system32 目录中。这样做是为了允许为所有相关应用程序轻松部署共享库的错误修复。在内存有限的日子里，当多个应用程序使用相同的库时，共享库减少了内存占用。

这个概念被许多程序员滥用，当他们将所有的dll都安装到这个目录中时；有时会用较旧的共享库覆盖较新版本的共享库。有时库的行为会悄无声息地改变，从而导致相关应用程序崩溃。

这导致了“分发应用程序目录中的所有dll”的方法。

**为什么这很糟糕？**

当出现错误时，必须更新分散在几个目录中的所有 dll。(gdiplus.dll) 在其他情况下，这甚至是不可能的（Windows 组件）

**显式方法**

这种方法解决了上述所有问题。您可以将 dll 安装在程序员可能不会干预的中心位置。在这里可以更新 dll（通过更新 WinSxS 文件夹中的 dll）并且加载程序加载“正确”的 dll。（版本匹配由 dll-loader 完成）。

**为什么 Linux 没有这种机制？**

我有几个猜测。（这真的只是猜测......）

*   大多数东西都是开源的，因此重新编译错误修复对目标受众来说不是问题
*   因为只有一个“运行时”（gcc 运行时），所以运行时共享/库边界的问题不会经常发生
*   许多组件在接口级别使用 C，如果操作正确，这些问题就不会发生
*   在大多数情况下，库的版本嵌入在其文件名中。
*   大多数应用程序都静态绑定到它们的库，因此不会发生 dll-hell。
*   GCC 运行时保持非常 ABI 稳定，因此不会发生这些问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-26T15:09:08.357

如果第三方 DLL 将分配内存并且*您*需要释放它，那么您需要相同的运行时库。如果 DLL 有 allocate 和 deallocate 函数，就可以了。

如果第三方 DLL 使用`std`容器，例如`vector`等，您可能会遇到问题，因为对象的布局可能完全不同。

有可能让事情正常工作，但有一些限制。我遇到了上面列出的两个问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-26T16:40:01.273

如果第三方 DLL 分配了您需要释放的内存，则 DLL 违反了交付预编译 DLL 的主要规则之一。正是因为这个原因。

如果 DLL 仅以二进制形式发布，那么它还应发布与其链接的所有可再发行组件，并且其入口点应将调用者与任何潜在的运行时库版本问题（例如不同的分配器）隔离开来。如果他们遵守这些规则，那么你就不应该受苦。如果他们不这样做，那么您将遭受痛苦和折磨，或者您需要向第三方作者投诉。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T01:30:29.650

> 我最终得出的结论是，让它工作的唯一方法（除了静态链接一切）是所有第三方库必须使用相同版本的 Visual Studios 编译 - 即不要使用预编译的 dll - 下载源代码，构建一个新的 dll 并改用它。

或者（以及我们必须在我工作的地方使用的解决方案）是，如果您需要使用的所有第三方库都是使用相同的编译器版本构建（或作为构建可用），您可以“只”使用该版本。例如，“必须”使用 VC6 可能会很麻烦，但是如果有一个您必须使用的库并且它的源不可用，而这就是它的来源，那么您的选择就会很遗憾地受到限制。

……据我了解。:)

（我的工作不在 Windows 中，尽管我们不时从用户的角度与 Windows 上的 DLL 作斗争，但是我们确实必须使用特定版本的编译器并获取全部使用相同的编译器。谢天谢地，所有供应商都倾向于保持最新，因为他们多年来一直在提供这种支持。）

# javascript - jQuery SVG 与 Raphael

> ID：588718
> 
> 赞同：255
> 
> 时间：2009-02-26T01:21:54.303
> 
> 标签：javascript, jquery, svg, raphael

我正在使用 SVG 和 JavaScript/jQuery 开发交互式界面，我正在尝试在[Raphael](http://raphaeljs.com/)和[jQuery SVG](http://keith-wood.name/svgRef.html)之间做出决定。我想知道

1.  两者之间的取舍是什么
2.  发展势头似乎在哪里。

我不需要 Raphael 中的 VML/IE 支持，也不需要 jQuery SVG 的绘图能力。我主要对在 SVG 画布上创建、动画和操作单个项目的最优雅的方式感兴趣。

* * *

## 回答 #1

> 赞同：194
> 
> 时间：2010-03-04T19:01:31.207

我最近使用了 Raphael 和 jQuery SVG - 以下是我的想法：

## 拉斐尔

**优点：**一个很好的入门库，很容易用 SVG 快速做很多事情。写得很好，有据可查。大量示例和演示。非常可扩展的架构。非常适合动画。

**缺点：**是实际 SVG 标记之上的一个层，使得使用 SVG 做更复杂的事情变得困难 - 例如分组（它支持集合，但不支持组）。在编辑现有元素时效果不佳。

## jQuery SVG

**优点：**一个 jquery 插件，如果你已经在使用 jQuery。写得很好，有据可查。大量示例和演示。支持大多数 SVG 元素，允许轻松本地访问元素

**缺点：**架构不如 Raphael 可扩展。有些事情可以更好地记录（例如配置 SVG 元素）。在编辑现有元素时效果不佳。动画依赖于 SVG 语义——这不是很好。

## [SnapSVG](http://snapsvg.io/)作为 Raphael 的纯 SVG 版本

SnapSVG 是 Raphael 的继任者。它仅在支持 SVG 的浏览器中受支持，并且几乎支持 SVG 的所有功能。

## 结论

如果您要快速轻松地做某事，Raphael 是一个简单的选择。如果您要做更复杂的事情，我选择使用 jQuery SVG，因为我可以比使用 Raphael 更容易地操作实际标记。如果你想要一个非 jQuery 解决方案，那么 SnapSVG 是一个不错的选择。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2009-03-17T19:32:31.330

对于后人，我想指出我最终选择了 Raphael，因为干净的 API 和“免费”的 IE 支持，还因为[积极的开发](http://groups.google.com/group/raphaeljs)看起来很有希望（例如，事件支持刚刚在 0.7 中添加）。但是，我不会回答这个问题，我仍然有兴趣了解其他人使用 Javascript + SVG 库的经验。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2009-08-10T11:11:02.620

我是 Raphael 的忠实粉丝，开发势头似乎很强劲（上周晚些时候发布了 0.85 版）。另一个很大的优点是它的开发者[Dmitry](http://dmitry.baranovskiy.com/ "德米特里的主页") Baranovskiy目前正在开发一个 Raphael 图表插件[g.raphael](http://github.com/DmitryBaranovskiy/g.raphael/tree/master "GitHub 上的 g.raphael")，它看起来非常漂亮（在[Flickr](http://www.flickr.com/photos/dmitry-baranovskiy/sets/72157620525949908/ "Flickr 一组 g.raphael 样本")上有一些早期版本的输出示例） .

然而，为了在 SVG 库组合中加入另一个可能的竞争者，Google 的[SVG Web](http://code.google.com/p/svgweb/ "SVG Web Google 代码项目")看起来确实很有前途（尽管我不是 Flash 的忠实粉丝，它用于在不兼容 SVG 的浏览器中呈现）。可能值得一看，尤其是即将举行的[SVG Open 会议](http://www.svgopen.org/2009/ "SVG 公开会议")。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2010-08-08T05:48:59.520

Raphael 肯定更容易设置和开始，但请注意，在 SVG 中表达事物的方式在 Raphael 中是不可能的。如上所述，没有“组”。这意味着您无法实现坐标变换层。相反，只有一个坐标变换可用。

如果您的设计依赖于嵌套坐标变换，那么 Raphael 不适合您。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-12-30T21:17:48.667

哦，拉斐尔自 6 月以来取得了长足的进步。有一个新的图表库可以使用它，这些非常引人注目。Raphael 还支持完整的 SVG 路径语法，并结合了非常先进的路径方法。在我的站点（无耻插件）上查看 1.2.8+，然后从那里跳到 Dmitry 的站点。 [http://www.irunmywebsite.com/raphael/raphaelsource.html](http://www.irunmywebsite.com/raphael/raphaelsource.html)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-27T14:49:28.440

我认为这并非完全无关，但您是否考虑过画布？[Process JS](http://ejohn.org/blog/processingjs/)之类的东西可以使它更简单。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-11-11T19:18:05.127

您还应该看看 svgweb。它使用 flash 在 IE 中呈现 svg，并且可以选择在其他浏览器上呈现（在它支持比浏览器本身更多的情况下）。

[http://code.google.com/p/svgweb/](http://code.google.com/p/svgweb/)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-03-24T17:37:38.420

我将投票支持 Raphael - 跨浏览器支持、干净的 API 和一致的更新（到目前为止）使它成为一种乐趣。它也可以很好地与 jQuery 配合使用。处理很酷，但作为目前最前沿的东西的演示更有用。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2012-12-11T16:14:27.440

作为一个 Javascript 初学者，我发现 Rapahel 示例并不容易，我推荐 [http://cancerbero.mbarreneche.com/raphaeltut](http://cancerbero.mbarreneche.com/raphaeltut)，这是一个真正的分步教程。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2013-10-25T00:37:31.723

对于那些不关心 IE6/IE7 的人来说，编写 Raphael 的那个人专门为现代浏览器构建了一个 svg 引擎：**Snap.svg** .. 他们有一个非常好的网站，有很好的文档：[http ://snapsvg.io](http://snapsvg.io)

snap.svg 开箱即用再简单不过了，它可以操作/更新现有的 SVG 或生成新的 SVG。您可以在 snap.io 的 about 页面上阅读这些内容，但这里有一个简短的介绍：

**缺点**

*   要使用 snap 的功能，您必须放弃对旧浏览器的支持。Raphael 支持 IE6/IE7 等浏览器，快照功能仅支持 IE9 及更高版本、Safari、Chrome、Firefox 和 Opera。

**优点**

*   实现 SVG 的全部功能，如遮罩、剪辑、图案、完整渐变、组等。

*   使用现有 SVG 的能力：内容不必使用 Snap 生成即可与 Snap 一起使用，允许您使用任何常用设计工具创建内容。

*   使用简单、易于实现的 JavaScript API 提供完整的动画支持

*   处理 SVG 字符串（例如，通过 Ajax 加载的 SVG 文件），而无需先实际渲染它们，类似于资源容器或精灵表。

如果您有兴趣，请查看：http: [//snapsvg.io](http://snapsvg.io)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2011-10-23T22:53:32.567

因为这里还没有提到：您还应该看看[Dojox.drawing](http://dojotoolkit.org/reference-guide/dojox/drawing.html#dojox-drawing)，它也提供了很好的 SVG 绘图功能。它有一组非常令人印象深刻的功能。我只是用它开始一个项目，但在我看来，它（至少在功能方面）远远优于 Raphael 和 JQuerySVG。

该演示文稿说服我使用它而不是 Raphael/JQuerySVG： [http ://www.slideshare.net/elazutkin/dojo-gfx-svg-in-the-real-world-2114082](http://www.slideshare.net/elazutkin/dojo-gfx-svg-in-the-real-world-2114082)

参考： [http ://dojotoolkit.org/reference-guide/dojox/index.html](http://dojotoolkit.org/reference-guide/dojox/index.html)

Dojocampus 参考：http: [//docs.dojocampus.org/dojox/drawing](http://docs.dojocampus.org/dojox/drawing)

下载 Dojo（包括 Dojox）： [http ://dojotoolkit.org/download/](http://dojotoolkit.org/download/)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2013-08-04T23:47:15.737

您可能想要查看的另一个 svg javascript 库是 d3.js。[http://d3js.org/](http://d3js.org/)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2011-05-02T21:45:38.953

我更喜欢使用 RaphaelJS，因为它具有出色的跨浏览器功能。但是，某些 SVG 和 VML 效果无法使用 RaphaelJS（复杂渐变...）实现。

Google 还开发了自己的库以在 IE 中启用 SVG 支持：http: [//svgweb.googlecode.com/files/svgweb-2009-08-20-B.zip](http://svgweb.googlecode.com/files/svgweb-2009-08-20-B.zip)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-11-15T20:54:14.680

如果您不需要 VML 和 IE8 支持，请使用 Canvas（例如 PaperJS）。查看适用于 Windows 7 的最新 IE10 演示。它们在 Canvas 中有令人惊叹的动画。SVG 无法做任何接近它们的事情。整体 Canvas 可在所有移动浏览器上使用。SVG 在 Android 2.0-2.3 的早期版本中不起作用（据我所知）

是的，Canvas 不可扩展，但速度如此之快，以至于您可以更快地重绘整个画布，然后浏览器能够滚动视口。

从我的角度来看，微软的优化提供了将 Canvas 用作常规 GDI 引擎并实现图形应用程序的方法，就像我们现在为 Windows 所做的那样。

# javascript - 通过滚动使固定的工具提示消失

> ID：588719
> 
> 赞同：1
> 
> 时间：2009-02-26T01:22:09.107
> 
> 标签：javascript, scroll, messagebox, fixed

我正在尝试创建一个固定在网页底部的消息框，因此当用户滚动时，它会保持原样（简单的 css）。但是，当用户滚动到网页中的某个点时，我希望消息框消失。

例如，如果您的网站底部有一个注册表单，我想创建一个消息框，上面写着“向下滚动以注册”，当用户向下滚动到注册表单的顶部时，消息会消失，或者被表格掩盖。因此，当他们向上滚动时，该消息会重新出现。

这不是我的实现，而是对该概念的准确说明。

我没有任何使用 Javascript 开发的经验，但希望有一个现有的方法。不过我愿意学习，这是我想使用的东西。

有什么想法吗？还是开始学习的概念？

多谢你们！（我认为这可能是一种非常聪明的方法，可以突出显示如果用户不滚动整个页面可能会错过的某些内容。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T01:48:11.353

[`This`](http://www.rootspot.com/stackoverflow/scrollintoview.html)应该可以解决问题（在 IE7、Firefox、Chrome、Safari 中测试）。

它使用 jQuery 并在元素可见时立即显示。这是代码：

```
$(document).ready(function() {
    function isScrolledIntoView(elem) {
        var docViewTop = $(window).scrollTop();
        var docViewBottom = docViewTop + $(window).height();

        var elemTop = $(elem).offset().top;
        var elemBottom = elemTop + $(elem).height();

        return ((elemBottom >= docViewTop) && (elemTop <= docViewBottom));
    }
    // the element to look for
    var myelement = $('#formcontainer');
    // the element to hide when the above is visible
    var mymessage = $('#mymessage');
    $(window).scroll(function() {
        if(isScrolledIntoView(myelement)) {
            mymessage.hide();
        } else {
            mymessage.show();
        }
    });
}); 
```

如果您希望在隐藏消息之前整个元素可见，请将`isScrolledIntoView`上面的内容替换为：

```
function isScrolledIntoView(elem) {
    var docViewTop = $(window).scrollTop();
    var docViewBottom = docViewTop + $(window).height();

    var elemTop = $(elem).offset().top;
    var elemBottom = elemTop + $(elem).height();

    return ((elemBottom >= docViewTop) && (elemTop <= docViewBottom)
      && (elemBottom <= docViewBottom) &&  (elemTop >= docViewTop) );
} 
```

这两个功能的功劳归于[`this question.`](https://stackoverflow.com/questions/487073/jquery-check-if-element-is-visible-after-scroling)

# vb.net - 将文本输出为 GIF 或 PNG 以用于电子书

> ID：588726
> 
> 赞同：0
> 
> 时间：2009-02-26T01:25:52.890
> 
> 标签：vb.net, utf-8, image-conversion, mobipocket

我的目标是创建一本电子书，我可以用我的黑莓手机上的 Mobipocket 阅读器阅读它。问题是我的文本包含黑莓不支持的 UTF-8 字符，因此显示为黑框。

该电子书将包含一份英语和旁遮普语单词列表以供参考，例如：

```
bait          ਦਾਣਾ
baked       ਭੁੰਨਿਆ
balance     ਵਿਚਾਰ 
```

我的一个想法是将列表写入 HTML 表格，并将旁遮普语转换为 GIF 或 PNG 文件。然后将此 HTML 文件包含在电子书中。所有单词当前都存在于一个访问数据库中，但可以很容易地导出到另一种形式以输入到生成例程中。

**问题：**使用 VB、VBA 或 C#，编写例程创建图像然后在表格中输出包含英文单词和图像的 HTML 文件有多难

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T01:48:48.077

Python中有一些简单的库可以处理这类问题。但是我不确定是否有一个简单的 VB/C# 解决方案。

使用 python，您将使用[PIL 库](http://www.pythonware.com/products/pil/)和与此类似的代码（我在[此处](http://ask.metafilter.com/44736/How-to-convert-text-to-an-image)找到）：

```
# creates a 50x50 pixel black box with hello world written in white, 8 point Arial text
import Image, ImageDraw, ImageFont

i = Image.new("RGB", (50,50))
d = ImageDraw.Draw(i)
f = ImageFont.truetype("Arial.ttf", 8)
d.text((0,0), "hello world", font=f)
i.save(open("helloworld.png", "wb"), "PNG") 
```

如果您已经熟悉其他语言，Python 应该很容易上手，而且与 VB/C# 不同，它几乎可以在任何平台上工作。Python 还可以帮助您生成 HTML 以配合生成的图像。[这里](http://linuxgazette.net/issue19/python.html)有一些例子。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T06:23:47.387

使用 VB

```
Sub createPNG(ByVal pngString As String, ByVal pngName As String)

' Set up Font
Dim pngFont As New Font("Raavi", 14)

' Create a bitmap so we can create the Grapics object 
Dim bm As Bitmap = New Bitmap(1, 1)
Dim gs As Graphics = Graphics.FromImage(bm)

' Measure string.
Dim pngSize As SizeF = gs.MeasureString(pngString, pngFont)

' Resize the bitmap so the width and height of the text 
bm = New Bitmap(Convert.ToInt32(pngSize.Width), Convert.ToInt32(pngSize.Height))

' Render the bitmap 
gs = Graphics.FromImage(bm)
gs.Clear(Color.White)
gs.TextRenderingHint = TextRenderingHint.AntiAlias
gs.DrawString(pngString, pngFont, Brushes.Firebrick, 0, 0)
gs.Flush()

'Saving this as a PNG file
Dim myFileOut As FileStream = New FileStream(pngName + ".png", FileMode.Create)
bm.Save(myFileOut, ImageFormat.Png)
myFileOut.Close()
End Sub 
```

# visual-studio-2008 - 在 DataSource 上找不到 DataMember 属性 [ObjectName]

> ID：588740
> 
> 赞同：6
> 
> 时间：2009-02-26T01:29:47.733
> 
> 标签：visual-studio-2008, data-binding, business-objects

我有一个业务对象，它是子对象的组合。
我在 Visual Studio 2008 中使用数据绑定来绑定到 Windows 窗体上的控件。

但是我在表单的 InitializeComponent 方法中遇到了上述错误。

假设我有一个名为 ParentObject 的对象，其中包含一个通用列表 ChildListObject。ParentObject 也有 Child 对象，它本身有一个 Child 对象。（即ParentObject.ChildObject.ChildObject）

我设置了主要的绑定源：

```
BindingSource.Datasource = ParentObject 
```

我添加一个网格并设置它的绑定源：

```
GridBindingSource.Datasource = ParentObject 
```

并将 DataMember 设置为：

```
BindingSourceB.DataMember = "ChildListObject" 
```

现在，网格的数据源设置为 GridBindingSource：

```
Me.MyDataGridView.DataSource = Me.GridBindingSource 
```

还有其他控件绑定到 ParentObject 和 ParentObject.ChildObject 的属性

我已经在一个孤立的项目中对此进行了测试，它工作正常，所以我很难找出真正的错误是什么？过去可以工作的代码会突然停止工作。

我得到的错误是（如果我在上面的例子中使用对象的名称）：

> “在 DataSource 上找不到 DataMember 属性 ChildObject”

它失败了：

```
Me.MyDataGridView.DataSource = Me.GridBindingSource 
```

奇怪的是，如果我删除 <System.Diagnostics.DebuggerStepThrough()> 然后当它失败时继续它很好？？？但它在运行时仍然失败。

有没有人有任何想法可以为我指明正确的方向？我通过谷歌搜索发现的最接近的是它可能与生成的设计器代码的顺序混乱有关。正在运行的代码将突然停止工作。

* * *

这个问题似乎来来去去。如果我只是在引发错误后继续，程序会愉快地继续没有问题。可能是VS中的一个错误。但是在运行时错误仍然存​​在。

是什么导致了这个问题？如何阻止它发生？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-06-07T07:26:54.150

我对此进行了几次实验。如果您有一个 BaseForm 和 BindingSource，如果您从该 BaseForm 继承一个新的 InheritedForm，或者
如果您在 InheritedForm 上有与 BindingSource 相关的附加绑定源（由 BaseForm 继承），则问题仅在这种情况下发生，您有设计器错误。我没有设计器解决方案，但如果您只是忽略并继续，当您再次构建项目时一切都会正常，否则您将不得不通过代码设置数据成员。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-28T21:33:28.363

我发现的唯一解决方法是：

1.  从网格中删除所有列
2.  将所需的列添加回网格（这可以防止在下一步中删除列）
3.  删除网格数据源
4.  在表单加载事件中设置网格的数据源。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-05-30T07:32:25.437

只需将您的生成代码移动到`Form_Load`这样的事件中：

```
private void MainForm_Load(object sender, EventArgs e)
{
    Me.MyDataGridView.DataMember = "DataMember";
    Me.MyDataGridView.DataSource = "DataSource";
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T01:43:34.110

Datamember 应该是一个字符串，用于定义要显示的 List 的哪些属性。这里不需要。

这是有道理的：

```
BindingSourceB.Datasource = ParentObject.ChildList; 
```

如果您绑定到网格，则无需设置 Datamember。只需设置数据源，然后使用设计器配置网格。

GetType 可以帮助设计者。在设计器属性中，您应该将 BindingSourceB 设置为 ChildListObject 类型，然后执行我上面所做的操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-12T08:12:59.543

我有同样的问题

```
Private WithEvents _model As MyModel 
```

删除了`WithEvents`，一切又开始工作了

```
Private _model As MyModel 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-11-03T19:50:58.020

由于某种原因，在我手动打开表单的“设计器”之前，错误没有在错误窗口中注册。一旦我打开设计器任务，我就可以看到绑定错误等手动删除。

造成这种情况的原因是我从我的项目中删除了数据源，但我猜它并没有自动删除它们背后的所有代码。

# mysql - 外键可以引用非唯一索引吗？

> ID：588741
> 
> 赞同：49
> 
> 时间：2009-02-26T01:29:53.847
> 
> 标签：mysql, sql, foreign-keys

我认为外键意味着单行必须引用单行，但我正在查看一些绝对不是这种情况的表。Table1 的column1 对table2 的column2 有一个外键约束，但是table2 中有许多记录在column2 中具有相同的值。column2 上还有非唯一索引。这是什么意思？外键约束是否仅仅意味着至少一条记录必须存在正确的列中的正确值？我认为这意味着必须有一个这样的记录（不确定空值如何适合图片，但目前我不太关心这一点）。

更新：显然，这种行为是特定于 MySQL 的，这是我使用的，但我在最初的问题中没有提到它。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2010-02-01T19:15:31.707

来自[MySQL 文档](http://dev.mysql.com/doc/refman/5.6/en/innodb-foreign-key-constraints.html)：

> InnoDB 允许外键约束引用非唯一键。这是标准 SQL 的 InnoDB 扩展。

但是，在引用表的非唯一列上避免使用外键是有实际原因的。也就是说，在这种情况下，“ON DELETE CASCADE”的语义应该是什么？

[该文档进一步建议](http://dev.mysql.com/doc/refman/5.6/en/create-table-foreign-keys.html)：

> 未明确定义对非唯一键或包含 NULL 值的键的外键引用的处理 (...) 建议您使用仅引用 UNIQUE（包括 PRIMARY）和 NOT NULL 键的外键。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-26T01:36:28.107

你的分析是正确的；键不必是唯一的，约束将作用于匹配行的集合。通常不是有用的行为，但可能会出现您想要的情况。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-26T02:02:24.783

是的，您可以为任何表中的任何列创建外键。不过，大多数情况下，您会将它们创建为主键。

如果您确实使用了不指向主键的外键，那么出于性能考虑，您可能还希望为被引用的列创建一个（非唯一）索引。

取决于您使用的 RDBMS。我认为有些人会隐含地为您执行此操作，或者使用其他一些技巧。即时通讯。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-26T06:20:54.070

发生这种情况时，通常意味着两个外键正在相互链接。通常，包含该键作为主键的表甚至不在模式中。

示例：两个表 COLLEGES 和 STUDENTS 都包含一个名为 ZIPCODE 的列。

如果我们快速检查

```
SELECT * FROM COLLEGES JOIN STUDENTS ON COLLEGES.ZIPCODE = STUDENTS.ZIPCODE 
```

我们可能会发现这种关系是多对多的。如果我们的模式有一个名为 ZIPCODES 的表，主键为 ZIPCODE，那么真正发生的事情就很明显了。

但是我们的模式没有这样的表。然而，仅仅因为我们的模式没有这样的表并不意味着这样的数据不存在。在某个地方，在 USPO 的土地上，就有这样一张桌子。COLLEGES.ZIPCODE 和 STUDENTS.ZIPCODE 都是对该表的引用，即使我们不承认它。

这更多地与数据哲学有关，而不是构建数据库的实践，但它巧妙地说明了一些基本的东西：数据具有我们发现的特征，而不仅仅是我们发明的特征。当然，我们发现的可能是其他人发明的。ZIPCODE 肯定是这种情况。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-26T13:09:52.980

PostgreSQL 也拒绝了这一点（无论如何，即使有**可能**，也不代表这是一个好主意）：

```
essais=> CREATE TABLE Cities (name TEXT, country TEXT);
CREATE TABLE
essais=> INSERT INTO Cities VALUES ('Syracuse', 'USA');
INSERT 0 1
essais=> INSERT INTO Cities VALUES ('Syracuse', 'Greece');
INSERT 0 1
essais=> INSERT INTO Cities VALUES ('Paris', 'France');
INSERT 0 1
essais=> INSERT INTO Cities VALUES ('Aramits', 'France');
INSERT 0 1
essais=> INSERT INTO Cities VALUES ('Paris', 'USA');
INSERT 0 1

essais=> CREATE TABLE People (name TEXT, city TEXT REFERENCES Cities(name));
ERROR:  there is no unique constraint matching given keys for referenced table "cities" 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-10-17T15:12:08.367

死灵术。
正如其他人已经说过的那样，您不应该将非唯一键引用为外键。
但是你可以做的（没有删除级联危险）是添加一个检查约束（至少在 MS-SQL 中）。
这与外键并不完全相同，但至少它可以防止插入无效/孤立/死数据。

请参阅此处以供参考（您必须将 MS-SQL 代码移植到 MySQL 语法）：
[外键到非主键](https://stackoverflow.com/questions/18435065/foreign-key-to-non-primary-key/26427936#26427936)

**编辑：**
根据[Mysql CHECK Constraint](https://stackoverflow.com/questions/14247655/mysql-check-constraint)搜索不赞成票的原因，MySQL 并不真正支持 CHECK 约束。
出于兼容性原因，您可以在 DDL 查询中定义它们，但它们只是被忽略...

但是就像那里提到的，你可以创建一个`BEFORE INSERT`和`BEFORE UPDATE`触发器，它会在数据的要求不满足时抛出一个错误，这基本上是一样的，除了它是一个更大的混乱。

至于问题：

> 我认为外键意味着单行必须引用单行，但我正在查看一些绝对不是这种情况的表。

在任何健全的 RDBMS 中，都是如此。**这在 MySQL 中是可能的这一事实只是MySQL 是一个疯狂的 RDBMS 的**
另一个原因。 它可能很快，但在速度的祭坛上牺牲参照完整性和数据质量并不是我对质量 rdbms 的想法。 事实上，如果它不符合 ACID，那么它根本就不是一个（正常运行的）RDBMS。

 *** * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-26T02:21:49.167

我们在谈论什么数据库？在 SQL 2005 中，我无法创建引用没有唯一约束（主键或其他）的列的外键约束。

```
create table t1
(
  id int identity,
  fk int
);

create table t2
(
  id int identity,
);

CREATE NONCLUSTERED INDEX [IX_t2] ON [t2] 
(
    [id] ASC
);
ALTER TABLE t1 with NOCHECK
ADD CONSTRAINT FK_t2 FOREIGN KEY (fk)
    REFERENCES t2 (id) ;

Msg 1776, Level 16, State 0, Line 1
There are no primary or candidate keys in the referenced table 't2' 
that match the referencing column list in the foreign key 'FK_t2'.
Msg 1750, Level 16, State 0, Line 1
Could not create constraint. See previous errors. 
```

如果您真的可以做到这一点，您将有效地建立多对多关系，如果没有中间表，这是不可能的。我真的很想听到更多关于这个的信息......

另请参阅[此相关问题](https://stackoverflow.com/questions/278982/are-foreign-keys-indexed-automatically-in-sql-server)和答案。

# python - Python 守护进程打包最佳实践

> ID：588749
> 
> 赞同：24
> 
> 时间：2009-02-26T01:32:39.503
> 
> 标签：python, packaging, setuptools, distutils

我有一个我用 python 编写的工具，通常应该作为守护进程运行。打包此工具以进行分发的最佳实践是什么，特别是应如何处理设置文件和守护程序可执行文件/脚本？

相关地，是否有任何通用工具用于设置适合给定平台的启动时运行的守护程序（即Linux 上的*初始化*脚本、Windows 上的服务、OS X 上的启动）*？*

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-26T01:46:15.243

我发现帮助 init.d 脚本的最佳工具是“start-stop-daemon”。它将运行任何应用程序，监视运行/pid 文件，在必要时创建它们，提供停止守护进程的方法，设置进程用户/组 ID，甚至可以后台处理您的进程。

例如，这是一个可以启动/停止 wsgi 服务器的脚本：

```
#! /bin/bash

case "$1" in
  start)
    echo "Starting server"

    # Activate the virtual environment
    . /home/ali/wer-gcms/g-env/bin/activate

    # Run start-stop-daemon, the $DAEMON variable contains the path to the
    # application to run
    start-stop-daemon --start --pidfile $WSGI_PIDFILE \
        --user www-data --group www-data \
        --chuid www-data \
        --exec "$DAEMON"
    ;;
  stop)
    echo "Stopping WSGI Application"

    # Start-stop daemon can also stop the application by sending sig 15
    # (configurable) to the process id contained in the run/pid file
    start-stop-daemon --stop --pidfile $WSGI_PIDFILE --verbose
    ;;
  *)
    # Refuse to do other stuff
    echo "Usage: /etc/init.d/wsgi-application.sh {start|stop}"
    exit 1
    ;;
esac

exit 0 
```

您还可以看到一个如何将它与 virtualenv 一起使用的示例，我总是会推荐它。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-26T02:48:06.593

要回答您的问题的一部分，我所知道的没有任何工具可以在 Linux 系统上进行守护程序设置，更不用说 Windows 或 Mac OS X。

大多数 Linux 发行版现在似乎都`start-stop-daemon`在 init 脚本中使用，但在文件系统布局和打包方面仍然会有很大差异。使用 autotools/configure 或 distutils/easy_install 如果您的项目都是 Python，将大大有助于为不同的 Linux/BSD 发行版构建包。

Windows 是一个完全不同的游戏，需要[Mark Hammond 的 win32](http://starship.python.net/crew/mhammond/)扩展，也许还有[Tim Golden 的 WMI](http://timgolden.me.uk/python/wmi.html)扩展。

我不知道 Launchd，除了“以上都不相关”。

有关守护 Python 脚本的技巧，我会查看在现实世界中实际执行此操作的 Python 应用程序，例如在 Twisted 中。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-26T02:44:33.373

互联网上有很多片段可以用纯 python 编写守护程序（没有 bash 脚本）

[http://www.jejik.com/articles/2007/02/a_simple_unix_linux_daemon_in_python/](http://www.jejik.com/articles/2007/02/a_simple_unix_linux_daemon_in_python/) 看起来很干净......

如果你想自己写，
原理和bash daemon函数一样。

基本上：

**开始时：**

*   你分叉到另一个进程
*   打开一个日志文件以重定向您的标准输出和标准错误
*   将 pid 保存在某处。

**停止时：**

*   您将 SIGTERM 发送到 pid 存储在您的 pidfile 中的进程。
*   使用 signal.signal(signal.SIGTERM, sigtermhandler) 您可以将停止过程绑定到 SIGTERM 信号。

不过，我不知道有任何广泛使用的软件包可以做到这一点。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-05-17T08:31:26.767

检查 Ben Finney 的守护进程模块。他已经开始编写针对 python 3.X 的 PEP：

[http://www.python.org/dev/peps/pep-3143/](http://www.python.org/dev/peps/pep-3143/)

但是这里已经有一个实现：

[http://pypi.python.org/pypi/python-daemon/](http://pypi.python.org/pypi/python-daemon/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-12-26T04:03:37.267

对于您的要求，这不是灵丹妙药，但请查看[supervisord](http://supervisord.org/ "监督者")。它处理管理流​​程的所有有趣部分。我在大型生产环境中大量使用它。此外，它是用 Python 编写的！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-26T18:29:22.663

我不记得我在哪里下载了它......但这是我找到的最好的守护进程脚本。它运行良好（在 Mac 和 Linux 上）。（将其保存为 daemonize.py）

```
import sys, os
def daemonize (stdin='/dev/null', stdout='/dev/null', stderr='/dev/null'):
    # Perform first fork.
    try:
        pid = os.fork( )
        if pid > 0:
            sys.exit(0) # Exit first parent.
    except OSError, e:
        sys.stderr.write("fork #1 failed: (%d) %sn" % (e.errno, e.strerror))
        sys.exit(1)
    # Decouple from parent environment.
    os.chdir("/")
    os.umask(0)
    os.setsid( )
    # Perform second fork.
    try:
        pid = os.fork( )
        if pid > 0:
            sys.exit(0) # Exit second parent.
    except OSError, e:
        sys.stderr.write("fork #2 failed: (%d) %sn" % (e.errno, e.strerror))
        sys.exit(1)
    # The process is now daemonized, redirect standard file descriptors.
    for f in sys.stdout, sys.stderr: f.flush( )
    si = file(stdin, 'r')
    so = file(stdout, 'a+')
    se = file(stderr, 'a+', 0)
    os.dup2(si.fileno( ), sys.stdin.fileno( ))
    os.dup2(so.fileno( ), sys.stdout.fileno( ))
    os.dup2(se.fileno( ), sys.stderr.fileno( )) 
```

在您的脚本中，您只需：

```
from daemonize import daemonize
daemonize() 
```

您还可以指定重定向 stdio、err 等的位置...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-26T02:09:29.960

在 Linux 系统上，系统的包管理器（Gentoo 的 Portage、Ubuntu/Debian 的 Aptitude、Fedora 的 yum 等）通常负责安装程序，包括将 init 脚本放置在正确的位置。如果您想为 Linux 分发您的程序，您可能需要考虑将其捆绑成适合各种发行版包管理器的格式。

这个建议显然与没有包管理器的系统（我认为是 Windows 和 Mac）无关。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-01-11T10:02:48.340

这篇[博](http://jimmyg.org/blog/2010/python-daemon-init-script.html)文让我清楚地知道，实际上有两种常见的方法可以让你的 Python 程序作为守护进程运行（我没有从现有答案中清楚地知道这一点）：

> 有两种方法可以用 Python 编写像服务器这样的守护程序应用程序。
> 
> *   第一个是**在 Python 代码本身中处理所有启动和停止守护进程的任务**。最简单的方法是使用`python-daemon`最终可能会进入 Python 发行版的包。

[Poeljapon 的答案](https://stackoverflow.com/a/588891/50899)是第一种方法的示例，虽然它不使用`python-daemon`包，但链接到自定义但非常干净的 python 脚本。

> *   另一种方法是**使用操作系统提供的工具**。对于 Debain，这意味着编写一个使用该`start-stop-daemon` 程序的初始化脚本。

[Ali Afshar 的答案](https://stackoverflow.com/a/588780/50899)是第二种方法的 shell 脚本示例，使用`start-stop-daemon`.

我引用的博客条目有一个 shell 脚本示例，以及一些额外的细节，例如在系统启动时启动你的守护进程，以及在它因任何原因停止时自动重新启动你的守护进程。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-12-01T02:05:46.917

如果错了，请纠正我，但我相信问题是如何部署守护进程。将您的应用设置为通过 pip 安装，然后将 entry_point 设为`cli(daemon())`. 然后创建一个简单运行的初始化脚本`$app_name &`

* * *

## 回答 #10

> 赞同：-11
> 
> 时间：2009-02-26T01:52:47.520

“一般应该作为守护进程运行？”

从表面上看，这并没有多大意义。“一般”是不明智的。它要么是守护进程，要么不是。您可能想更新您的问题。

有关守护程序的示例，请阅读诸如 Apache 的 httpd 或任何数据库服务器（它们是守护程序）或 SMTPD 邮件守护程序之类的守护程序。

或者，也许，阅读一些更简单的东西，比如 FTP 守护进程、SSH 守护进程、Telnet 守护进程。

在 Linux 世界中，您将拥有应用程序安装目录、一些工作目录以及配置文件目录。

我们`/opt/ourapp`用于应用程序（它是 Python，但我们不安装在 Python 中`lib/site-packages`）

我们`/var/ourapp`用于工作文件和我们的配置文件。

我们可以使用`/etc/ourapp`配置文件——这将是一致的——但我们没有。

我们还没有使用`init.d`脚本进行启动。但这是最后一块，自动启动。现在，我们让系统管理员启动守护进程。

这部分基于[http://www.pathname.com/fhs/](http://www.pathname.com/fhs/)和[http://tldp.org/LDP/Linux-Filesystem-Hierarchy/html/Linux-Filesystem-Hierarchy.html](http://tldp.org/LDP/Linux-Filesystem-Hierarchy/html/Linux-Filesystem-Hierarchy.html)。

# c# - 如何删除字符串中的重复字符？

> ID：588774
> 
> 赞同：9
> 
> 时间：2009-02-26T01:43:48.010
> 
> 标签：c#

我必须实现一个函数，该函数将字符串作为输入并从该字符串中找到不重复的字符。

举个例子，如果我传递字符串 str = "DHCD" 它将返回 "DHC" 或 str2 = "KLKLHHMO" 它将返回 "KLHMO"

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-02-26T02:14:51.227

Linq 方法：

```
public static string RemoveDuplicates(string input)
{
    return new string(input.ToCharArray().Distinct().ToArray());
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-26T01:47:26.207

它会完成这项工作

```
string removedupes(string s)
{
    string newString = string.Empty;
    List<char> found = new List<char>();
    foreach(char c in s)
    {
       if(found.Contains(c))
          continue;

       newString+=c.ToString();
       found.Add(c);
    }
    return newString;
} 
```

我应该指出这是犯罪效率低下。

我想我在第一次修订时神志不清。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-26T01:48:26.673

对于任意长度的字节大小字符串（不适用于宽字符或其他编码），我会使用查找表，每个字符一位（256 位表为 32 个字节）。循环遍历您的字符串，仅输出未打开位的字符，然后为该字符打开位。

```
string removedupes(string s)
{
    string t;
    byte[] found = new byte[256];
    foreach(char c in s)
    {
        if(!found[c]) {
            t.Append(c);
            found[c]=1;
        }
    }
    return t;
} 
```

我不擅长 C#，所以我不知道使用位域而不是字节数组的正确方法。

如果您知道您的字符串将非常短，那么其他方法将提供更好的内存使用和/或速度。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-06T06:37:38.757

```
 void removeDuplicate()
    {
      string value1 = RemoveDuplicateChars("Devarajan");
    }

     static string RemoveDuplicateChars(string key)
    {
        string result = "";          
        foreach (char value in key)
            if (result.IndexOf(value) == -1)                   
                result += value;
        return result;
    } 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-26T01:49:11.943

对我来说这听起来像是功课，所以我将在高层次上进行描述。

*   遍历字符串，检查每个字符
*   检查你以前是否见过这个角色
    *   如果有，请将其从字符串中删除
    *   如果还没有，请注意您现在已经看到了该角色

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-09-26T17:03:48.120

这是在 C# 中。为简洁起见省略了验证。从给定字符串中删除重复字符的原始解决方案

```
 public static char[] RemoveDup(string s)
    {
        char[] chars = new char[s.Length];
        int unique = 0;
        chars[unique] = s[0];  // Assume: First char is unique
        for (int i = 1; i < s.Length; i++)
        {
            // add char in i index to unique array 
            // if char in i-1 != i index
            // i.e s = "ab" -> a != b
            if (s[i-1] != s[i]
            chars[++unique] = s[i];
        }
        return chars;
    } 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-03-15T18:03:15.600

我用java语言回答。
在这里张贴，以便您即使使用 Java 语言也能有所了解。算法将保持不变。

```
public String removeDup(String s)
  {
    if(s==null) return null;
    int l = s.length();
    //if length is less than 2 return string
    if(l<2)return s;
    char arr[] = s.toCharArray();

    for(int i=0;i<l;i++)
    {
      int j =i+1; //index to check with ith index
      int t = i+1; //index of first repetative char.

      while(j<l)
      {
        if(arr[j]==arr[i])
        {
          j++;

        }
        else
        {
          arr[t]=arr[j];
          t++;
          j++;
        }

      }
      l=t;
    }

    return new String(arr,0,l);
  } 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-05-09T22:29:18.763

第一个答案的修订版本，即：您不需要**ToCharArray()**函数即可。

```
public static string RemoveDuplicates(string input)
{
    return new string(input.Distinct().ToArray());
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-12-21T20:29:24.030

你可以使用 HashSet：

```
 static void Main()
    {
        string textWithDuplicates = "aaabbcccggg";

        Console.WriteLine(textWithDuplicates.Count());  
        var letters = new HashSet<char>(textWithDuplicates);
        Console.WriteLine(letters.Count());

        foreach (char c in letters) Console.Write(c);   
    } 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-08-04T18:34:58.407

```
 class Program
    {
        static void Main(string[] args)
        {
            bool[] doesExists = new bool[256];
            String st = Console.ReadLine();
            StringBuilder sb = new StringBuilder();
            foreach (char ch in st)
            {
                if (!doesExists[ch])
                {
                    sb.Append(ch);
                    doesExists[ch] = true;
                }
            }
            Console.WriteLine(sb.ToString());
        }
    } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-07-24T17:12:30.713

char *remove_duplicates(char *str) { char *str1, *str2;

```
if(!str)
    return str;

str1 = str2 = str;

while(*str2)            
{   
    if(strchr(str, *str2)<str2)
    {
        str2++;
        continue;
    }

    *str1++ = *str2++;      
}
*str1 = '\0';

return  str; 
```

}

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-10-24T15:54:41.573

```
char* removeDups(const char* str)
{
 char* new_str = (char*)malloc(256*sizeof(char));
 int i,j,current_pos = 0,len_of_new_str;
 new_str[0]='\0';

 for(i=0;i<strlen(str);i++)
{
 len_of_new_str = strlen(new_str);
for(j=0;j<len_of_new_str && new_str[j]!=str[i];j++)
   ;
  if(j==len_of_new_str)
   {
     new_str[len_of_new_str] = str[i];
     new_str[len_of_new_str+1] = '\0';
   }
}
  return new_str;
} 
```

希望这可以帮助

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-02-20T04:46:06.180

```
String str="AABBCANCDE";  
String newStr=""; 
for( int i=0; i<str.length(); i++)
{
 if(!newStr.contains(str.charAt(i)+""))
 newStr= newStr+str.charAt(i);
 }
 System.out.println(newStr); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-06-11T19:10:27.640

// 删除上下两个重复项

```
public static string RemoveDuplicates(string key)
    {
        string Result = string.Empty;
        foreach (char a in key)
        {
            if (Result.Contains(a.ToString().ToUpper()) || Result.Contains(a.ToString().ToLower()))
                continue;
            Result += a.ToString();
        }
        return Result;
    } 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-02-08T12:42:24.097

```
var input1 = Console.ReadLine().ToLower().ToCharArray();
var input2 = input1;
var WithoutDuplicate = input1.Union(input2); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-01-30T07:29:14.103

```
Console.WriteLine("Enter String");

string str = Console.ReadLine();

string result = "";
result += str[0]; // first character of string

for (int i = 1; i < str.Length; i++)
{
    if (str[i - 1] != str[i])
        result += str[i];
}

Console.WriteLine(result); 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-01-31T13:11:57.623

我喜欢 Quintin Robinson 的回答，只是应该有一些改进，比如删除 List，因为在这种情况下它不是必需的。另外，在我看来，大写字符（“K”）和小写字符（“k”）是一回事，所以它们应该算作一个。

所以我会这样做：

```
private static string RemoveDuplicates(string textEntered)
    {

        string newString = string.Empty;

        foreach (var c in textEntered)
        {
            if (newString.Contains(char.ToLower(c)) || newString.Contains(char.ToUpper(c)))
            {
                continue;
            }
            newString += c.ToString();
        }
        return newString;
    } 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-02-07T10:52:59.167

不确定它有多优化：

```
public static string RemoveDuplicates(string input)
{
    var output = string.Join("", input.ToHashSet());
    return output;
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2018-02-09T17:37:57.167

下面是从字符串中删除重复字符的代码

```
 var input = "SaaSingeshe";
        var filteredString = new StringBuilder();
        foreach(char c in input)
        {
            if(filteredString.ToString().IndexOf(c)==-1)
            {
                filteredString.Append(c);
            }
        }
        Console.WriteLine(filteredString);
        Console.ReadKey(); 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-09-05T08:22:50.737

> 命名空间演示{类程序{
> 
> ```
>  static void Main(string[] args) {
>      string myStr = "kkllmmnnouo";
>      Console.WriteLine("Initial String: "+myStr);
>     // var unique = new HashSet<char>(myStr);
>      HashSet<char> unique = new HashSet<char>(myStr);
>      Console.Write("New String after removing duplicates: ");
> 
>      foreach (char c in unique) 
>         Console.Write(c);   
>   }    } } 
> ```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-03-25T04:30:55.457

这对我有用

```
private string removeDuplicateChars(String value)
{
    return new string(value.Distinct().ToArray());
} 
```

# asp.net - jQuery 的 $() 函数总是使用 AJAX 返回“未定义”

> ID：588778
> 
> 赞同：0
> 
> 时间：2009-02-26T01:45:33.467
> 
> 标签：asp.net, jquery, ajax, pagerequestmanager

我注意到弹出显示在文本框中的文本更新之前显示，我猜 js 在页面渲染之前被调用......这将解释“未定义”弹出窗口......我如何确保在页面之后调用 js被渲染？

重写以使其尽可能简单：

```
<body>
<form id="form1" runat="server">
    <asp:ScriptManager ID="ScriptManager1" runat="server">
    </asp:ScriptManager>
    <asp:UpdatePanel ID="UpdatePanel1" runat="server">
        <ContentTemplate>
            <asp:TextBox ID="txtRcaNotes" runat="server" TextMode="MultiLine" Width="800px"></asp:TextBox><br />
            <asp:Button ID="btnDoneWithRcs" runat="server" OnClick="btnDoneWithRcs_Click" Text="Action Completed / Update Notes" />
        </ContentTemplate>
    </asp:UpdatePanel>
</form>

<script type="text/javascript">

        var prm = Sys.WebForms.PageRequestManager.getInstance();
            prm.add_endRequest(
            function(){doStuff();}
            );

        function doStuff()
        {
            $(document).ready(function() {
                                $('txtRcaNotes').hide(); 
                                alert($('txtRcaNotes').attr('id'));
                                });
        }

</script>
</body> 
```

代码背后：

```
protected void btnDoneWithRcs_Click(object sender, EventArgs e)
{
    txtRcaNotes.Text += "asdfadf";
} 
```

**文本框没有隐藏，ALERT() 返回“未定义”**

[![替代文字](https://i.stack.imgur.com/0x60B.jpg)](https://i.stack.imgur.com/0x60B.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T02:40:32.883

您只是缺少 id 选择器语法。尝试：

```
$('#<%= txtRcaNotes.ClientID %>').hide(); 
alert($('#<%= txtRcaNotes.ClientID %>').attr('id')); 
```

请注意`"#"`每个选择器之前的添加。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T02:32:08.037

您可以尝试的一件事是使用 Firebug 或其他一些 DOM 检查器，并在 AJAX 调用之前和之后检查 ASP.NET 生成的实际元素 ID，看看它们是否相同。

# json - IronPython“查找错误：未知编码：十六进制”

> ID：588792
> 
> 赞同：6
> 
> 时间：2009-02-26T01:50:24.920
> 
> 标签：json, import, ironpython

[当我尝试在IronPython 2.0](http://www.codeplex.com/IronPython)中“导入 simplejson”（或依赖它的东西）时，我得到“LookupError：未知编码：十六进制”。我该如何进行这项工作？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-26T01:53:16.273

解决方法是在尝试导入损坏的依赖项之前手动导入十六进制编解码器：

```
from encodings import hex_codec 
```

[IronPython](http://www.codeplex.com/IronPython/WorkItem/View.aspx?WorkItemId=20634)正在跟踪该问题，但到目前为止，他们声称这是标准 Python 库中的一个错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-07-23T01:13:41.997

谢谢，sblom。我认为 IronPython 工作人员说它是标准库中的一个错误（或者至少是 2.7 的 Freeze 工具）是正确的。`from encodings import hex_codec`如果未在脚本中明确写入，则“冻结”程序会出现问题。

很抱歉'necro-post'，但我觉得这个问题是相关的，至少在冻结工具方面。

# nhibernate - NHibernate 和字符串主键

> ID：588795
> 
> 赞同：2
> 
> 时间：2009-02-26T01:50:52.800
> 
> 标签：nhibernate, string, orm, primary-key

我们有一个使用字符串作为主键的遗留数据库。我想在遗留数据库之上实现对象，以更好地实现一些业务逻辑并为用户提供更多功能。

我在某些地方读过，在表上使用字符串作为主键是不好的。我想知道这是为什么？是因为区分大小写的问题吗？字符集？

... 为什么这对 NHibernate 来说特别糟糕？

...并跟进...如果字符串确实生成了错误的主键，是否值得用整数或 GUID 等替换数据库中的主键？（我们只涉及大约 25-30 张桌子）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-26T03:50:31.780

好的，我将对此进行尝试。我将给出几个快速警告 - 我不是数据库专家，我的经验是使用 Hibernate (Java) 而不是 NHibernate，但这里有。

我认为主键作为字符串的问题与用于在数据库中表示它们的 SQL 数据类型有关。由于在插入、查询等操作时始终使用主键，因此数据库引擎不得不花费大量时间来比较主键。如果您使用的是数字，它们只是存储为计算机非常擅长快速处理的字节。一旦你开始使用字符串，这些操作的成本（主要是比较）就会显着增加。即使数据库引擎使用非常简洁的策略来比较键，将字节作为字节而不是字符串进行比较仍然总是更快。

然而，在现代硬件上，这个问题已经比过去少了很多，而且有了索引，这个问题几乎消失了。

我不确定为什么这在 H​​ibernate（和 NHibernate）中真的很糟糕，但根据我的经验，因为我的应用程序有一个复杂的对象图，这些对象经常引用其他持久对象，通常作为列表或集合，引用都是使用另一个对象的 ID 存储的，并且由于我为级联保存、获取等制定的规则，这意味着主键一直在使用。Hibernate——我非常喜欢——倾向于完全按照它的指示去做，有时人们（尤其是我！）会告诉它做一些非常愚蠢的事情。结果，即使是看似简单的更新或查询最终也会生成相当复杂的 SQL。

所以 - 总而言之 - 字符串作为主键是不好的，因为对它们进行简单操作的成本和使用 Hibernate 可能会放大这一点。但在实践中，现代数据库引擎有很多巧妙的策略来确保性能影响不是那么糟糕。（Postgres - 可能还有其他 - 默认情况下为主键创建索引）

为了您的跟进 - 您应该更换钥匙吗？好吧，这取决于您的应用程序的性能。如果性能很关键，那么对于大容量和非常密集的应用程序来说，这可能是一个好主意，否则可能会带来最小的好处，缺点是不得不花时间更改所有表。您可以期望得到更好的结果，改进您与 NHibernate 一起使用的策略（即获取策略以及何时进行级联保存等）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T21:12:59.297

Andy K 似乎暗示字符串不存储为字节。那会很有趣！实际上，这完全取决于字符串 PK 的长度以及您使用的排序规则。它甚至可能比 bigint 或 int identity 更快，并且几乎肯定会比 Guids 更快。如果这些字符串是您无论如何都必须搜索的东西，那么无论如何您都需要一个索引（甚至可能是聚集索引），所以为什么不将它们设为 PK！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-06T17:32:46.227

使用字符串或字符会意外增加系统的大量[复杂性](http://en.wikipedia.org/wiki/Accidental_complexity)。考虑以下问题：

*   如何处理区分大小写；
*   如何处理填充。NHibernate 允许您插入一个较短的字符串，并且数据库会默默地向它添加填充，但它不会反映在您的持久实体中。尝试使用内存中的 ID 再次获取实体返回 null；
*   如何处理编码问题。C# 使用 unicode 字符串，您的数据库可能不会。你能告诉转换将如何处理吗？我不这么认为。
*   大多数数据库可以自动生成合成整数键，而无需额外的努力。使用字符串，您很可能“手动”创建它们。除非您将它们隐藏在工厂后面（在 DDD 意义上），否则生成的代码将使您的域模型混乱。

尽管**andy K**提到的性能开销可以因为索引而减少，但您仍然多次在内存中进行 ID 比较（哈希映射？）并且 DB 优化不适用于那里。

我一直在研究一个带有字符串主键且根本没有外键的遗留数据库的项目。我们不允许修改旧模式，因为旧版应用程序依赖于它的每个小方面。我觉得字符串主键比缺少的外键更能损害一致性，因为 NHibernate 非常优雅地处理了后者。

# apache-flex - Flex：如何在动态创建中访问组件的属性？

> ID：588798
> 
> 赞同：0
> 
> 时间：2009-02-26T01:52:20.377
> 
> 标签：apache-flex, properties, components

我有一个动态创建的组件。我想访问它的属性。

例如，我创建了一个 vbox，我想访问组件的文本字体或间隙

var MyVBox: VBox = 新 VBox; MyPanel.addChild(MyVBox);

应该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T07:48:00.333

所有属性和方法都使用“.”访问。（点）符号。

例子：

```
myVBox.width = 400; 
```

使用 setStyle() 方法设置样式。在你的情况下，那将是

```
myVBox.setStyle("fontFamily", "arial");
myVBox.setStyle("verticalGap", 20); 
```

查看[http://livedocs.adobe.com/flex/3/langref/](http://livedocs.adobe.com/flex/3/langref/)上的文档，了解每个组件的可用属性和样式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T02:09:26.607

使用 ActionScript 而不是 MXML 时要记住的是，样式属性不是作为对象上的属性访问的，而是通过 getStyle("propertyName") 方法访问的。例如，字体是一种样式。

# php - POST 和 Cookie 一样安全吗？

> ID：588803
> 
> 赞同：1
> 
> 时间：2009-02-26T01:53:18.347
> 
> 标签：php, security, session, cookies, swfupload

在实现基于[Flash 的上传器](http://swfupload.org/)时，我们遇到了一个问题：[Flash 没有提供正确的 cookie](http://swfupload.org/forum/generaldiscussion/383)。我们需要通过 POST 变量传递 PHP 会话 ID。

我们提出并实施了一个功能性解决方案，检查 POST PHPSESSID。

**发布会话 ID 是否与在 cookie 中发送会话 ID 一样安全？**

可能的原因：因为两者都在 http 标头中，并且客户端同样有可能伪造。反对的可能原因：因为伪造 POST 变量比伪造 Cookie 更容易。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-26T01:56:07.077

它和 cookie 一样安全——伪造 POST 和 cookie 一样容易。这些都是通过简单地在 cURL 中设置标志来完成的。

话虽如此，我认为您也有一个很好的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T01:57:47.853

如果您能够从活动内容中获取会话 ID 以便发布它，这可能意味着您的会话 cookie 没有标记为[HttpOnly](http://www.owasp.org/index.php/HTTPOnly)，我们的一位主机声称这是[防御跨站点脚本攻击的好主意](http://www.codinghorror.com/blog/archives/001167.html)。

相反，考虑一个基于 JavaScript 甚至基于刷新的上传器监视器，它应该与其他所有东西很好地集成，cookie 可以是 HttpOnly。

另一方面，如果您的站点不接受第三方内容，跨站点脚本攻击可能不会有任何问题；在这种情况下，POST 很好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-26T01:59:50.280

我认为通过 GET 发送它也可以正常工作，因为你在 HTTP 请求中伪造了任何东西（使用 curl 甚至 flash）。重要的是在你的 cookie/post/get 参数中加密了什么，以及它是如何在服务器端加密和检查的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T02:19:05.553

真的，如果您担心哪个更容易伪造，那么您担心的是错误的事情。简而言之，对于有经验的攻击者来说，两者都是微不足道的。您可能会通过选择一个而不是另一个来避开“脚本小子”，但这些人并不是您需要担心的人。您应该问自己的问题是“您对伪造身份的人有什么防御措施？” 它会发生。如果您的 id 未加密且容易猜到，那就有问题了。它会被黑客入侵。既然你问哪个更安全，我会说你很担心。

这里还有一点需要考虑，因为你的应用程序是 flash，它很容易被修改（就像 javascript HTML 代码一样），因为编译的代码在攻击者的机器上。他们可以查看二进制文件并弄清楚代码是如何工作的，以及它需要从服务器检索什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T02:03:45.390

POST 数据不是 HTTP 标头，但它作为 TCP 流的一部分发送，这使得它与 HTTP 标头一样易于读取/伪造。如果你拦截了一个 HTTP 请求，它看起来像这样：

```
POST /path/to/script HTTP/1.1
Host: yourdomain.com
User-Agent: Mozilla/99.9 (blahblahblah)
Cookie: __utma=whateverthisisacookievalue;phpsessid=somePHPsessionID

data=thisisthepostdata&otherdata=moredummydata&etc=blah 
```

正如其他人所说，POST 和 cookie（以及 GET 数据，即查询字符串）都很容易被欺骗，因为它们都只是同一个 HTTP 数据包中的文本。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-26T04:19:46.967

我只想重申 Cookie 和 Post 都同样不安全。

# vb.net - 如何将树控件绑定到 VB .NET 中的数据源？

> ID：588812
> 
> 赞同：1
> 
> 时间：2009-02-26T01:58:04.497
> 
> 标签：vb.net, visual-studio-2008, data-binding, treeview

**编辑**： [重复](https://stackoverflow.com/questions/372820/how-do-you-databind-to-a-system-windows-forms-treeview-control/373177#373177)

我是 .NET 的新手，我承担了一个小型工作项目，将现有的 VB6 产品转换为当前版本的 VB（要么就是那个，要么是学习 VB6！）。本产品是一个内部*桌面*应用程序（不是基于 Web 的）。

我需要创建一个新的树视图，它链接到一个特定的表。

表中的每一行都有一个父 id，它链接回表的主键，并定义节点层次结构。因此，需要在数据绑定中指出这种关系。

我可以在 Visual Studio 2008 中使用标准的树视图控件，还是需要一些额外的东西来完成这项工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T02:10:04.063

您可以使用定义节点的 XML 文件绑定树视图控件，也可以通过查询数据库来绑定它。这是[15 Seconds](http://www.15seconds.com/issue/041117.htm)中的一篇文章，其中包含有关使用 .NET TreeView 控件的非常详尽的教程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T03:10:00.143

根据[另一个问题](https://stackoverflow.com/questions/372820/how-do-you-databind-to-a-system-windows-forms-treeview-control)，这是不可能的，因为普通的树视图控件不支持数据绑定。

您需要以[编程方式填充](https://stackoverflow.com/questions/361661/populate-treeview-from-database)，或使用第三方组件（我过去曾将[Developer Express](http://devexpress.com/)与 C++/Delphi 组件一起使用，它们太棒了！）。

# g++ - 一个unix发行版上的静态链接可以工作，而另一个则不行吗？

> ID：588814
> 
> 赞同：5
> 
> 时间：2009-02-26T01:59:55.117
> 
> 标签：g++, unix

如果我在 ubuntu 中静态链接一个可执行文件，该可执行文件是否有可能在其他发行版（如 mint os）中不起作用？或软呢帽？我知道处理器类型会受到影响，但除此之外还有什么我需要注意的吗？对不起，如果这是一个愚蠢的问题。谢谢你的帮助

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-26T02:21:19.997

有一些极端情况，但在大多数情况下，您应该使用静态链接保持良好状态。想到的就是libnss。这个特定的库基本上不可能静态链接，因为它的工作方式（权限、身份验证、安全任务）。不过，只要 glibc 版本相似，您就应该可以解决这个问题。

如果您的程序需要使用内核的细微功能（例如卷管理器），那么您有非常​​小的机会让您的程序在各个发行版之间以静态链接方式工作，因为内核接口可能会略有变化。

大多数典型的应用程序，甚至讨论可移植性的那种应用程序，如网络服务、gui 应用程序、语言工具（如编译器/解释器）都不会有任何问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-26T02:05:18.020

如果您在一台计算机上静态链接一个程序，然后将其移动到另一台系统基本上以相同方式运行的计算机，那么它应该可以正常工作。这就是静态链接的意义所在；程序不依赖其他文件 - 它完全是独立的，所以只要它可以运行，它就会以与它在其“主机”系统上相同的方式运行。

这与动态链接形成对比，其中程序在运行时合并其他文件（库）的元素。如果您将动态链接的程序移动到另一个系统，其中它所依赖的库不同（或不存在），它将无法工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-26T02:07:48.390

在大多数情况下，您的可执行文件可以正常工作。只要您的可执行文件不依赖于任何不寻常的东西来运行，就不会有问题。（而且，如果它确实取决于存在的异常情况，那么即使您动态链接也会遇到同样的问题。）

为了不同 UNIX 环境之间的兼容性，静态链接通常比动态链接更安全，只要使用相同的 CPU。

要使静态链接的二进制文件失败，再次假设相同的处理器架构，您将不得不在使用 a.out 二进制格式的系统上进行链接之类的操作，并尝试在运行 ELF 的系统上执行它，在这种情况下，动态链接版本同样会失败。

那么为什么人们*不*经常静态链接呢？两个原因：

*   它使可执行文件更大，有时更大，并且
*   如果库中的错误已修复，您必须重新链接程序才能访问错误修复。如果在库中修复了严重的安全错误，您必须重新链接并重新分发您的 exe。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T03:35:24.030

On the contrary. Whatever your chances are of getting a binary to work across distributions or even OSes, those chances are maximized by static linking. Static linking makes an executable self-contained in terms of libraries. It can still go wrong if it tries to read a file that's not there on another system.

For even better chances of portability, try linking against dietlibc or some other libc. [An article at Linux Journal](http://m.linuxjournal.com/article/9940) mentions some candidates. A smaller, simpler libc is less likely to depend on things in the filesystem that differ from distro to distro.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-14T12:58:37.750

这里有两个兼容性问题：库版本和库库存。

你没有说你正在使用什么库。

如果您没有“-l”选项，那么唯一的“库”就是 glibc 本身，它用作内核的接口。Glibc 版本向上兼容。如果您在 glibc 2.x 系统上链接，您可以在 glibc 2.y 上运行，因为 y > x。开发商对此做出了坚定的承诺。

如果你有 -l 选项，静态链接总是安全的。如果您是动态链接的，则必须确保 (1) 库存在于目标系统上，并且 (2) 具有兼容的版本。您的里程可能会因目标发行版是否具有您需要的内容而异。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-26T04:19:40.040

只要您可以保证它只会在类似硬件上的类似操作系统版本上执行，如果它是静态链接的，您的程序就可以正常工作。因此，如果您为 2.6 Linux 构建并静态链接，您将可以在（几乎）所有 2.6 Linux 发行版上运行。

请注意，您不能静态链接 GLIBC 的某些部分，因此如果您使用它们，则无论如何都必须动态链接。在我调查时，从内存中，名称服务 (nss) 部分需要动态链接。

您不能静态链接（比如说）Linux 的程序，然后期望它在 BSD 或 Windows 上运行。BSD 和 Unix 不像 Linux 那样呈现或处理它们的系统调用。我撒了一个小谎，因为 BSD 有一个可以启用的 Linux 仿真层，但开箱即用它不会工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-26T03:46:19.713

出于上述原因，我会避免静态链接某些东西，除非你绝对**必须**。

话虽如此，它应该适用于相同架构的任何其他类似内核（即，如果您在运行 linux 2.4.x 的机器上静态链接，加载程序 VDSO 在 linux 2.6 上将有所不同，VDSO 是虚拟动态共享对象，内核向每个包含加载程序代码的进程公开的共享对象）。

其他陷阱包括 /etc 中的内容不是您想的那样，日志位于不同的位置，系统实用程序不存在或不同（ubuntu 使用 update-rc.d，RHEL 使用 chkconfig）等。

有时你别无选择。我正在编写一个程序，该程序与 LVM2 的基于字符串的 cmdlib 接口进行对话，以支持使用 execv().. 低，我需要支持的 30% 的发行版不包含该库，并且无法获取它。因此，在生成二进制包时，我必须链接到静态对象。

如果您使用 glibc，您可以确信 getpwnam() 和朋友之类的东西仍然可以工作.. 只需确保观看任何硬编码路径（更好的是，让它们在运行时可配置）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-25T10:25:52.510

不，它不会工作。分配独立性的静态链接是旧 Unix 时代的概念，不推荐使用。事实上，无论如何，你不能像静态库那样使用尽可能多的库。

遵循 Linux Standard Base 方式，这是您获得尽可能多的跨发行版可移植性的唯一机会。

如果您为 FreeBSD 和 Solaris 编程，LSB 也可以正常工作。

# c# - C#内存地址和变量

> ID：588817
> 
> 赞同：26
> 
> 时间：2009-02-26T02:01:36.300
> 
> 标签：c#, .net, memory-management

在 C# 中，有没有办法

1.  获取存储在引用类型变量中的内存地址？
2.  获取变量的内存地址？

编辑：

```
int i;
int* pi = &i; 
```

*   如何打印出 pi 的十六进制值？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-26T02:10:52.983

对于#2，`&`运算符的工作方式与 C 中的相同。如果变量不在堆栈上，您可能需要在`fixed`工作时使用语句将其固定，以便垃圾收集器不会移动它。

对于#1，引用类型更棘手：您需要使用 a `GCHandle`，并且引用类型必须是 blittable 的，即具有已定义的内存布局并且可以按位复制。

为了将地址作为数字访问，您可以从指针类型转换为`IntPtr`（定义为与指针大小相同的整数类型），然后从那里转换为`uint`或`ulong`（取决于底层机器的指针大小）。

```
using System;
using System.Runtime.InteropServices;

[StructLayout(LayoutKind.Sequential)]
class Blittable
{
    int x;
}

class Program
{
    public static unsafe void Main()
    {
        int i;
        object o = new Blittable();
        int* ptr = &i;
        IntPtr addr = (IntPtr)ptr;

        Console.WriteLine(addr.ToString("x"));

        GCHandle h = GCHandle.Alloc(o, GCHandleType.Pinned);
        addr = h.AddrOfPinnedObject();
        Console.WriteLine(addr.ToString("x"));

        h.Free();
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-26T02:45:08.363

数字 1 根本不可能，您不能拥有指向托管对象的指针。但是，您可以使用 IntPtr 结构来获取有关引用中指针地址的信息：

```
GCHandle handle = GCHandle.Alloc(str, GCHandleType.Pinned);
IntPtr pointer = GCHandle.ToIntPtr(handle);
string pointerDisplay = pointer.ToString();
handle.Free(); 
```

对于数字 2，您使用 & 运算符：

```
int* p = &myIntVariable; 
```

指针当然必须在不安全的块中完成，并且您必须在项目设置中允许不安全的代码。如果变量是方法中的局部变量，它是在堆栈上分配的，所以它已经固定了，但是如果变量是对象的成员，则必须使用`fixed`关键字将该对象固定在内存中，这样它就不会被垃圾收集器。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-12-10T16:14:15.800

要最正确地回答您的问题：

#1 是可能的，但有点棘手，只应出于调试原因进行：

```
object o = new object();
TypedReference tr = __makeref(o);
IntPtr ptr = **(IntPtr**)(&tr); 
```

这适用于任何对象，实际上返回指向内存中对象的内部指针。请记住，由于 GC 喜欢在内存中移动对象，因此地址可以随时更改。

#2 指针不是对象，因此不会从它们继承*ToString*。您必须像这样将指针转换为*IntPtr*：

```
Console.WriteLine((IntPtr)pi); 
```

# c++ - 通过 C++ 控制应用程序的监视器

> ID：588822
> 
> 赞同：0
> 
> 时间：2009-02-26T02:03:39.647
> 
> 标签：c++, winapi, monitor

我有一个应用程序可以在一天中以特定时间间隔打开 IE 浏览器窗口。我想控制浏览器窗口打开的监视器（例如，browser1在monitor1上打开，browser2在monitor2上打开，browser3在monitor1上打开，browser4在monitor2上打开）。有没有办法使用 C++（应用程序是用 C++ 编写的）来控制我打开浏览器窗口的监视器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T02:17:29.973

有各种第三方实用程序可以让用户控制它，但在启动 IE 后，您必须以编程方式使用 GetMonitorInfo / MoveWindow 之类的东西来定位它。

另一种方法是将 IE 控件嵌入到您选择的对话框或窗口中，然后您可以完全控制它。

# bash - Finding files ISO-8859-1 encoded?

> ID：588843
> 
> 赞同：2
> 
> 时间：2009-02-26T02:17:08.897
> 
> 标签：bash, encoding, utf-8

I have a bunch of files with a mixtures of encodings mainly ISO-8859-1 and UTF-8.

I would like to make all files UTF-8, but when trying to batch encode this files using iconv some problems arise. (Files cuts by half, etc.)

I supposse the reason is that iconv requires to know the 'from' encoding, so if the command looks like this

```
iconv -f ISO-8859-1 -t UTF-8 in.php -o out.php 
```

but 'in.php' if already UTF-8 encoded, that causes problems (correct me if I'm wrong)

Is there a way, that I can list all the files whose encoding is not UTF-8?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T02:28:14.207

You can't find files that are definitely ISO-8859-1, but you can find files that are valid UTF-8 (which unlike most multibyte encodings give you a reasonable assurance that they are in fact UTF-8). [moreutils](http://kitenet.net/~joey/code/moreutils/) has a tool `isutf8` which can do this for you. Or you can write your own, it would be fairly simple.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T02:29:16.047

It's often hard to tell just by reading a text file whether it's in UTF-8 encoding or not. You could scan the file for certain [indicator bytes](http://en.wikipedia.org/wiki/UTF-8#Description) which can never occur in UTF-8, and if you find them, you know the file is in ISO-8859-1\. If you find a byte with its high-order bit set, where the bytes both immediately before and immediately after it don't have their high-order bit set, you know it's ISO encoded (because bytes >127 always occur in sequences in UTF-8). Beyond that, it's basically guesswork - you'll have to look at the sequences of bytes with that high bit set and see whether it would make sense for them to occur in ISO-8859-1 or not.

The `file` program will make an attempt to guess the encoding of a text file it's processing, you could try that.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-08-09T13:39:45.480

with find it's quite simple

```
find . -print0 | xargs -0 file | grep 8859 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T12:27:44.233

> Is there a way, that I can list all the files whose encoding is not UTF-8?

Perhaps not so easily in bash alone, but it's a trivial task from eg. Python:

```
import os.path

for child in os.path.listdir(TARGETDIR):
    child= os.path.join(TARGETDIR, child)
    if os.path.isfile(child):
        content= open(child, 'rb').read()

        try:
            unicode(content, 'utf-8')
        except UnicodeDecodeError:
            open(child, 'wb').write(unicode(content, 'iso-8859-1')) 
```

This assumes that any file that *can* be interpreted as a valid UTF-8 sequence *is* one (and so can be left alone), whilst anything that isn't must be ISO-8859-1.

This is a reasonable assumption if those two are the only possible encodings, because valid UTF-8 sequences (of at least two top-bit-set characters in a particular order) are relatively rare in real Latin text, where we tend only to use the odd single accented characters here and there.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T02:22:40.600

What kind of content? XML? Then yes, if properly tagged at the top. Generic text files? I don't know of any a-priori way to know what encoding is used, although it might be possible, sometimes, with clever code. "Tagged" UTF-8 text files, by which I mean UTF-8 text files with a [Byte-Order mark](http://en.wikipedia.org/wiki/Byte-order_mark)? (For UTF-8, the three byte sequence "ï»¿") Probably. The Byte Order Mark characters will not *commonly* appear as the first three characters in a ISO-8859-1 encoded file. (Which [bobince](https://stackoverflow.com/users/18936/bobince) pointed out in a comment to this post, so I'm correcting my post.)

For your purposes, tools exist that can probably solve most of your question. Logan Capaldo pointed out one in [his answer](https://stackoverflow.com/questions/588843/finding-files-iso-8859-1-encoded/588861#588861).

But after all, if it were always possible to figure out, unambiguously, what character encoding was used in a file, then the `iconv` utility wouldn't need you to provide the "from" encoding. :)

# javascript - Internet Explorer 7 - Javascript“未定义”未测试

> ID：588845
> 
> 赞同：2
> 
> 时间：2009-02-26T02:17:33.437
> 
> 标签：javascript, internet-explorer, firefox, internet-explorer-7, cross-browser

我在 IE7 中遇到了一些 JS 的问题。我正在测试某个对象是否分配了一个类名（它可能是来自 DOM 的 HTMLElement 对象）。

现在，在 Firefox 中测试页面告诉我，是的，变量是未定义的（我下面的所有测试都执行 Alert().

在 IE 中，没有任何测试通过，变量在最后一个 IF 语句中被分配，并且在最后一个 Alert() 期间，IE 根据`fn_note.className`语句卡盘“className is null or not an object”错误。

这是代码：

```
 var fn_note;
        var kids = area.childNodes;
        for (var l = 0; l < kids.length; l++){
            //DEBUG check if the found var exists
            if (kids[l].className == null){
                //then the className var doens't exist
                alert ('the classsname for the following var is null: --'+kids[l]+'--');
            }
            if (kids[l].className == undefined){
                //then the className var doens't exist
                alert ('the classsname for the following var is undefined: --'+kids[l]+'--');
            }                    
            if (kids[l].className == ''){
                //then the className var doens't exist
                alert ('the classsname for the following var is an empty string: --'+kids[l]+'--');
            }
            if (typeof kids[l].className === 'undefined'){
                //then the className var doens't exist
                alert ('the classsname for the following var is NEW TYPEOF TEST: --'+kids[l]+'--');
            }                      

            if (kids[l].className == 'fn-note') { /* (/fn-note$/).test(kids[l].className) IE doesn't really like regex. por supuesto */
                //we have found the div we want to hide
                fn_note = kids[l];                       
            }
        }                    
        alert('the clicked on className is '+area.className+'name of the found div is '+fn_note.className); 
```

请让我知道我做错了什么。我知道它可能是基本的东西，但我只是看不到它 ATM。

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-26T02:32:06.193

我认为您从该属性中获得的不是字符串，而是“未定义”类型的对象。试试这个：

```
if (typeof(kids[l].className) == 'undefined') { 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T06:41:19.667

据我所知，您*真正想知道*的唯一一件事是 childNodes 集合中是否存在 className 'fn-note' 的 childNode。所以做一个更严格的测试：

```
for (var l = 0; l < kids.length; l++){
    if (kids[l] 
        && kids[l].className 
        && kids[l].className.match(/fn\-note$/i)) {
       fn_note =  kids[l];
    }
} 
```

这应该足够了（请注意转义正则表达式中的破折号）。

# linux-kernel - 如何在 /proc/driver 下创建 proc 条目？

> ID：588848
> 
> 赞同：6
> 
> 时间：2009-02-26T02:21:08.967
> 
> 标签：linux-kernel, kernel-module, procfs

我想在目录下创建一个文件`/proc/driver`。我想使用类似`proc_root_driver`（或提供的其他东西）的宏，而不是明确使用“驱动程序/模块名称”。我使用`create_proc_entry`：

```
struct proc_dir_entry *simpleproc_fops_entry;
simpleproc_fops_entry = create_proc_entry(MODULE_NAME, 0400, NULL /* proc_root_dir */); 
```

谷歌搜索后，我发现了使用的建议`proc_root_driver`，但是当我使用它时，我得到了错误

> 此函数中未声明 proc_root_driver

而且，`proc_root_driver`在 linux/proc_fs.h 中不可用。

我试图声明这样的结构：

```
struct proc_dir_entry proc_root;
struct proc_dir_entry *proc_root_driver = &proc_root; 
```

编译错误消失了，但文件没有出现在`/proc/driver`or下`/proc`。我怎样才能在其中创建一个条目`/proc`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-02T17:05:49.507

查看 proc_fs.h，proc_root_driver 定义为：

```
extern struct proc_dir_entry *proc_root_driver; 
```

只要启用 CONFIG_PROC_FS。如果您在配置内核时选择了 CONFIG_PROC_FS，您应该能够按照您自己的建议使用它，即：

```
#include <linux/proc_fs.h>
struct proc_dir_entry * procfile
procfile = create_proc_entry("myprocfile", 0400, proc_root_driver); 
```

如果这不起作用，请检查您是否设置了 CONFIG_PROC_FS。为确保，您可以使用 -E 选项编译源文件并检查 create_proc_entry 调用是否包含非 NULL 参数作为最后一个参数。如果它为 NULL，或者调用根本不存在，则不启用 CONFIG_PROC_FS。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-03-12T11:37:48.957

```
/* proc entries for ayyaz */

#include <linux/module.h>
#include <linux/kernel.h>
#include <linux/slab.h>
#include <linux/string.h>
#include <linux/timer.h>
#include <linux/major.h>
#include <linux/fs.h>
#include <linux/err.h>
#include <linux/ioctl.h>
#include <linux/init.h>
#include <linux/proc_fs.h>

#ifdef CONFIG_PROC_FS

/*====================================================================*/
/* Support for /proc/ayyaz */

static struct proc_dir_entry *proc_ayyaz;

DEFINE_MUTEX(ayyaz_table_mutex);

/*====================================================================*/
/* Init code */
static int ayyaz_read_proc (char *page, char **start, off_t off, int count,
                          int *eof, void *data_unused)
{
        int len, l, i;
        off_t   begin = 0;

        mutex_lock(&ayyaz_table_mutex);

        len = sprintf(page, "hello ayyaz here\n");
        mutex_unlock(&ayyaz_table_mutex);
        if (off >= len+begin)
                return 0;
        *start = page + (off-begin);
        return ((count < begin+len-off) ? count : begin+len-off);
}

static int __init init_ayyaz(void)
{
        if ((proc_ayyaz = create_proc_entry( "ayyaz_maps", 0, NULL )))
                proc_ayyaz->read_proc = ayyaz_read_proc;
        return 0;
}

static void __exit cleanup_ayyaz(void)
{
        if (proc_ayyaz)
                remove_proc_entry( "ayyaz", NULL);
}

module_init(init_ayyaz);
module_exit(cleanup_ayyaz);
#else
#error "Please add CONFIG_PROC_FS=y in your .config "
#endif /* CONFIG_PROC_FS */

MODULE_LICENSE("proprietary");
MODULE_AUTHOR("Md.Ayyaz A Mulla  <md.ayyaz@gmail.com>");
MODULE_DESCRIPTION("proc files for ayyaz"); 
```

编译此驱动程序。如果它编译成功，那么您将看到`/proc/ayyaz`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-20T13:00:49.290

```
#define PROC_ENTRY_NAME "driver/XX"
static struct proc_dir_entry *proc_XX;

static int XX_read_proc (char *page, char **start, off_t off, int count,
    int *eof, void *data_unused)
{
    return 0;
}
static int XX_write_proc (struct file *file, const char __user *buffer,
    unsigned long count, void *data)
{
    return 0;
}

static int __init XX_add_driver(void)
{
    if ((proc_flash = XX_entry(PROC_ENTRY_NAME, 0, NULL))) {
        proc_XX->read_proc = XX_read_proc;
        proc_XX->write_proc = XX_write_proc;
    }
...
}

static void __exit XX_remove(void)
{
    if (proc_flash)
        remove_proc_entry(PROC_ENTRY_NAME, NULL);

    return;
} 
```

然后就可以找到`/proc/driver/XX`入口了。

# security - CHMOD 和我服务器上目录的安全性

> ID：588855
> 
> 赞同：2
> 
> 时间：2009-02-26T02:22:58.557
> 
> 标签：security, sysadmin, chmod

我的服务器上有一个文件夹，我已将权限更改为 777（读取、写入和执行全部），以允许用户上传他们的图片。

所以我想知道，这其中涉及到哪些安全风险？

我已经实现了代码来限制可以上传的文件格式，但是如果有人找到目录的位置会发生什么，这会对我的服务器造成任何威胁吗？

他们可以开始上传他们想要的任何文件吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T12:26:30.807

当用户通过 web 表单和一些 PHP 脚本将文件上传到您的服务器时，服务器上的磁盘访问发生在运行 web 服务器的用户 id 下（通常是 nobody、www-data、apache、_httpd 甚至 root）。

请注意，无论是哪个用户上传文件，都会使用此*单个用户 ID 。*

只要没有本地用户通过其他方式（`ssh`例如）访问系统，将上传目录权限设置为`0777`不会有太大的不同——除了有人利用系统中其他地方的安全漏洞之外，没有人这些权限无论如何都适用，这样的攻击者可能只会使用`/tmp`.

最好只对文件或目录设置实际需要的权限。在这种情况下，这可能意味着：

```
drwxrws--- 5 www-data www-data          4096 Nov 17 16:44 upload/ 
```

我假设除了 Web 服务器之外的其他本地用户也想要访问这些文件，例如系统管理员或网页设计师。将这些用户添加到您的 Web 服务器运行所在的组中，他们不需要`sudo`或 root 权限来访问该目录。此外，这`+s`意味着其中的新文件和目录`upload/`将自动归同一组所有。

至于你的最后一个问题：仅仅因为攻击者知道目录在哪里，并不意味着他可以神奇地使文件出现在那里。仍然必须运行某种服务来接受文件并将它们存储在那里......所以不，将权限设置为`0777`并不会直接降低安全性。

尽管如此，在整个设置中，您无法通过文件权限解决“安全”和“安全性”的更多维度：

*   上传者仍然可以覆盖彼此的文件，因为它们都使用相同的用户 ID
*   有人可以将恶意 PHP 脚本上传到上传目录并从那里运行它，可能会利用您系统上的其他漏洞并获得 root 访问权限
*   有人可以使用您的服务器分发儿童色情内容
*   上传与 paypal.com 相似的网站后，有人可能会从您的服务器运行网络钓鱼站点

...而且可能还有更多。您可能已经在上传脚本中解决了其中一些问题，但话又说回来，在了解安全问题时，通常一开始就对 unix 文件权限及其应用位置的理解很重要，这表明您可能还没有准备好解决所有问题的可能问题。

有人看过你的代码！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T02:49:56.590

这些用户通过什么方式上传他们的照片？如果是通过网络，那么您只需要授予网络服务器或 CGI 脚本用户访问该文件夹的权限。

这里最大的危险是用户可以覆盖其他用户文件，或删除其他用户文件。没有访问此文件夹的任何人都无法写入（除非您有某种来宾/匿名用户）。

如果您需要一个每个人都可以在其中创建文件的目录，那么您想要的是模仿 /tmp 目录的权限。

$ chown root:根目录；chmod 777 目录；chmod +t 目录；

这样，任何用户都可以创建文件，但不能删除其他用户拥有的文件。

与其他人所说的相反，unix 系统中目录上的可执行位意味着您可以将该目录设为当前目录（cd 到它）。它与执行无关（执行目录是没有意义的）。如果您删除可执行位，则没有人可以“cd”到它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T02:30:12.097

如果不出意外，我会删除所有用户的可执行权限（如果不是所有者和组）。启用此功能后，有人可以上传看起来像图片但实际上是可执行文件的文件，这可能会造成无休止的损害。

除非您需要匿名访问，否则可能还删除所有用户的读写权限并将其限制为所有者和组。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-26T02:48:35.267

您不想打开可执行位。就 *nix 而言，可执行位意味着您可以实际运行该文件。因此，例如，php 脚本可以上传为 JPEG 类型，然后如果有人知道位置并且它在 web 目录中，他们就可以运行该脚本。

# c++ - 在 VisualStudio 2005 中“开始调试”需要很长时间

> ID：588857
> 
> 赞同：3
> 
> 时间：2009-02-26T02:23:56.590
> 
> 标签：c++, visual-studio, debugging, visual-studio-2005

我有一个包含 > 1000 个文件的大型项目。当我按下绿色的“播放”按钮开始调试时，一旦一切就绪，应用程序开始运行最多可能需要 5 分钟。

看起来 Visual Studio 正在加载和卸载各种 DLL，但它也只是偶尔无所事事。

从命令行运行只需几秒钟。

这是怎么回事？我怎样才能加快速度？

[编辑] 原来是我们的符号服务器。管理员在没有通知任何人的情况下杀死了它。多哈。

谢谢你们的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T02:52:52.337

一些想法和建议：

*   这可能是由 VS2005 执行的复杂**依赖**检查导致的，以确保没有组件发生更改并且必须在调试之前重新构建。有时调整解决方案中的项目间依赖关系会有所帮助。

*   您是否在 Visual Studio 中使用**源代码控制**集成？如果是这样，有时访问网络上其他地方的源代码控制存储库可能会导致 Visual Studio 像这样变慢。如果使用像 ClearCase 这样的源代码控制系统可以减少不必要的 LAN 通信（例如使用快照视图），请考虑这样做。

*   我还发现单独运行可执行文件（从 Visual Studio 外部）然后使用 VS2005**附加**到进程会快得多。这主要是我的工作方式，我发现它不那么令人沮丧。

*   要考虑的另一件事是您是否使用**符号服务器**来访问 Windows DLL 的调试符号。如果是这样，VS2005 有时可以在每次调试时尝试访问符号服务器。解决这个问题的方法是加载符号一次，然后在 Tools->Options->Debugging->Symbols 下取消选中符号服务器 URL。只要自您上次下载符号以来操作系统库没有更改，就没有理由每次都访问远程服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T02:47:40.773

听起来它可能正在为您可能不关心的各种 DLL 加载符号。您可以在选项中禁用这些。

如果没有，您会在“输出”窗口中看到什么？

# c++ - 带有文件镜像的 ramdisk

> ID：588859
> 
> 赞同：2
> 
> 时间：2009-02-26T02:25:30.953
> 
> 标签：c++, windows, filesystems, ramdisk

我想加快编译速度，所以我想我可以让我的文件在 ramdisk 上构建，但也可以自动刷新到文件系统，如果没有足够的 ram 则使用文件系统。

对于我正在编写的应用程序，我可能需要类似的东西，我希望将文件缓存在 ram 中并刷新到 FS 中。我有哪些选择？有没有这样的东西已经存在？（也许是保险丝？）该应用程序是一个玩具应用程序（目前），我需要反复编译 C++ 代码。众所周知，当有特定问题需要解决才能继续进行时，编译所需的时间越长。我们能做的越少。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T18:32:10.863

Ram-disks 在文件系统缓存中采用了渡渡鸟的方式。它可以做出比静态缓存更好的决策，它可以了解其他程序的 RAM 使用情况以及磁盘写入头的位置。懒惰的回写是免费的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T02:46:22.743

编译受 CPU 限制，而不是磁盘限制。如果您使用适当的构建标志使用所有 CPU 内核，则可以轻松地在典型 PC 上使它们饱和。除非你有某种超级计算机，否则我认为这不会加快速度。

对于 VS2008，这个标志是[`/MP`](http://msdn.microsoft.com/en-us/library/bb385193.aspx). 它也存在于[VS2005](http://blog.280z28.org/archives/2007/10/17/)上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-01-20T19:08:16.943

不确定它是否有助于回答大约 12 年前的问题，但刚才我正在寻找一些软件来同步文件系统或目录来做到这一点。这两个答案都是正确的，因为文件系统缓存将尝试预测您需要什么并在 RAM 中可用，并且通常构建软件有利于多线程，可能会最大化您的 CPU。但是现在我正在使用 Unity 进行构建，并且无法控制构建优化。

也就是说，虚拟 RAM 磁盘具有优势，因为这些文件始终位于 RAM 中，与必须处理资源和应用程序争夺磁盘访问权限的文件系统缓存 (FSC) 不同。

另一个区别是，当应用程序关闭文件句柄或强制同步时，FSC 将尝试尽快将该文件获取到磁盘，以避免出现问题（电源故障等）。我相信你可以改变 Linux 上的 FSC 行为。同步到 RAM 磁盘不会写入磁盘，这可能是您在评论中所说的性能差异的原因。

也就是说，我仍然需要寻找一些东西来自动同步我的两个文件系统！

# ios - 原子属性和非原子属性有什么区别？

> ID：588866
> 
> 赞同：1913
> 
> 时间：2009-02-26T02:31:34.370
> 
> 标签：ios, objective-c, properties, atomic, nonatomic

财产声明中的含义`atomic`和含义是什么？`nonatomic`

```
@property(nonatomic, retain) UITextField *userName;
@property(atomic, retain) UITextField *userName;
@property(retain) UITextField *userName; 
```

这三者在操作上有什么区别？

* * *

## 回答 #1

> 赞同：1795
> 
> 时间：2009-02-26T06:40:50.107

最后两个是相同的；“atomic”是默认行为（~~请注意，它实际上不是关键字；它仅通过缺少`nonatomic`~~--`atomic`被指定为最近版本的 llvm/clang 中的关键字）。

假设您正在 @synthesizing 方法实现，原子与非原子会更改生成的代码。如果您正在编写自己的 setter/getter，则 atomic/nonatomic/retain/assign/copy 只是建议性的。（注意：@synthesize 现在是 LLVM 最新版本中的默认行为。也不需要声明实例变量；它们也会自动合成，并且会`_`在其名称前添加一个前缀，以防止意外直接访问）。

使用“原子”，合成的 setter/getter 将确保始终从 getter 返回*整个值或由 setter 设置，而不管任何其他线程上的 setter 活动。*也就是说，如果线程 A 在 getter 的中间，而线程 B 调用 setter，则实际可行的值——很可能是一个自动释放的对象——将返回给 A 中的调用者。

在`nonatomic`中，没有做出这样的保证。因此，`nonatomic`比“原子”要快得多。

“原子”**不做**的是对线程安全做出任何保证。如果线程 A 同时调用 getter，而线程 B 和 C 使用不同的值调用 setter，则线程 A 可能会返回三个值中的任何一个——在调用任何 setter 之前的那个值或传递给 setter 的值中的任何一个在 B 和 C 中。同样，对象可能以 B 或 C 中的值结束，无法判断。

确保数据完整性——多线程编程的主要挑战之一——是通过其他方式实现的。

添加到此：

`atomicity`当多个依赖属性在起作用时，单个属性的属性也不能保证线程安全。

考虑：

```
 @property(atomic, copy) NSString *firstName;
 @property(atomic, copy) NSString *lastName;
 @property(readonly, atomic, copy) NSString *fullName; 
```

在这种情况下，线程 A 可以通过调用`setFirstName:`然后调用来重命名对象`setLastName:`。同时，线程 B 可能会`fullName`在线程 A 的两次调用之间进行调用，并将接收到新的名字和旧的姓氏。

为了解决这个问题，您需要一个*事务模型*。即某种其他类型的同步和/或排除允许一个人`fullName`在更新相关属性时排除访问。

* * *

## 回答 #2

> 赞同：363
> 
> 时间：2009-02-26T06:24:01.427

这在 Apple 的[文档](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/ObjectiveC/Chapters/ocProperties.html)中进行了解释，但以下是实际发生的一些示例。

~~请注意，没有“atomic”关键字，如果不指定“nonatomic”，则该属性是原子的，但显式指定“atomic”会导致错误。~~

如果您不指定“非原子”，则该属性是原子的，但如果您愿意，您仍然可以在最近的版本中明确指定“原子”。

```
//@property(nonatomic, retain) UITextField *userName;
//Generates roughly

- (UITextField *) userName {
    return userName;
}

- (void) setUserName:(UITextField *)userName_ {
    [userName_ retain];
    [userName release];
    userName = userName_;
} 
```

现在，原子变体有点复杂：

```
//@property(retain) UITextField *userName;
//Generates roughly

- (UITextField *) userName {
    UITextField *retval = nil;
    @synchronized(self) {
        retval = [[userName retain] autorelease];
    }
    return retval;
}

- (void) setUserName:(UITextField *)userName_ {
    @synchronized(self) {
      [userName_ retain];
      [userName release];
      userName = userName_;
    }
} 
```

基本上，原子版本必须锁定以保证线程安全，并且还会增加对象上的引用计数（以及自动释放计数以平衡它），以便保证调用者的对象存在，否则存在如果另一个线程正在设置该值，则可能是一种竞争条件，导致 ref 计数下降到 0。

实际上，这些事物的工作方式有很多不同的变体，具体取决于属性是标量值还是对象，以及保留、复制、只读、非原子等如何交互。一般来说，属性合成器只知道如何为所有组合做“正确的事情”。

* * *

## 回答 #3

> 赞同：174
> 
> 时间：2012-05-25T10:56:12.417

### 原子

*   是默认行为
*   将确保当前进程由 CPU 完成，然后另一个进程访问该变量
*   速度不快，因为它确保过程完全完成

### 非原子

*   不是默认行为
*   更快（对于合成代码，即对于使用@property 和@synthesize 创建的变量）
*   不是线程安全的
*   当两个不同的进程同时访问同一个变量时，可能会导致意外行为

* * *

## 回答 #4

> 赞同：141
> 
> 时间：2012-01-31T18:36:08.980

了解差异的最佳方法是使用以下示例。

假设有一个名为“name”的原子字符串属性，如果你`[self setName:@"A"]`从线程 A 调用`[self setName:@"B"]`，从线程 B 调用`[self name]`，从线程 C 调用，那么不同线程上的所有操作都将串行执行，这意味着如果一个线程正在执行一个 setter或 getter，然后其他线程将等待。

这使得属性“name”读/写安全，但如果另一个线程 D`[name release]`同时调用，则此操作可能会产生崩溃，因为这里不涉及 setter/getter 调用。这意味着一个对象是读/写安全的（ATOMIC），但不是线程安全的，因为另一个线程可以同时向对象发送任何类型的消息。开发人员应确保此类对象的线程安全。

如果属性“name”是非原子的，那么上面示例中的所有线程 - A、B、C 和 D 将同时执行，产生任何不可预知的结果。在原子的情况下，A、B 或 C 中的任何一个将首先执行，但 D 仍然可以并行执行。

* * *

## 回答 #5

> 赞同：119
> 
> 时间：2012-08-18T09:47:48.567

这个问题的其他优秀答案已经很好地定义了语法和语义。由于*执行*和*性能*都不是很详细，所以我将添加我的答案。

> 这3个之间的功能区别是什么？

我一直认为 atomic 作为默认值非常好奇。在我们工作的抽象级别，使用类的原子属性作为实现 100% 线程安全的工具是一种极端情况。对于真正正确的多线程程序，程序员的干预几乎肯定是必需的。同时，性能特征和执行还没有深入详细说明。多年来编写了一些大量多线程程序，我一直在声明我的属性，`nonatomic`因为原子对于任何目的都不明智。在讨论原子和非原子属性的细节[这个问题](https://stackoverflow.com/questions/12010211/use-of-atomic-properties-in-objective-c-any-side-effects)时，我做了一些分析，遇到了一些奇怪的结果。

**执行**

行。我想澄清的第一件事是锁定实现是实现定义和抽象的。路易斯`@synchronized(self)`在他的例子中使用了——我认为这是一个常见的混淆来源。*该实现实际上*并未使用`@synchronized(self)`; 它使用对象级*自旋锁*。Louis 的插图非常适合使用我们都熟悉的结构进行高级插图，但重要的是要知道它不使用`@synchronized(self)`.

另一个区别是原子属性将在 getter 中保留/释放您的对象。

**表现**

这是有趣的部分：在**无争议**（例如单线程）情况下使用原子属性访问的性能在某些情况下可能非常快。在不太理想的情况下，使用原子访问的开销可能是`nonatomic`. 而使用 7 个线程的**Contested**案例对于三字节结构（2.2 GHz [Core i7](https://en.wikipedia.org/wiki/Intel_Core#Core_i7) Quad Core，x86_64）慢了 44 倍。三字节结构是一个非常慢的属性的例子。

有趣的旁注：三字节结构的用户定义访问器比综合原子访问器快 52 倍；或合成非原子访问器速度的 84%。

有争议的案件中的对象也可以超过 50 次。

由于实施中的优化和变化的数量，很难在这些环境中衡量现实世界的影响。您可能经常听到类似“相信它，除非您分析并发现它是一个问题”之类的话。由于抽象级别，实际上很难衡量实际影响。从配置文件中收集实际成本可能非常耗时，并且由于抽象，非常不准确。同样，ARC 与 MRC 可以产生很大的不同。

因此，让我们退后一步，*不*关注属性访问的实现，我们将包括常见的嫌疑人，例如，并检查在*无争议*的情况下对getter`objc_msgSend`的许多调用的一些真实世界的高级结果（以秒为单位的值）：`NSString`

 **   MRC | 非原子| 手动实现的吸气剂：2
*   MRC | 非原子| 合成吸气剂：7
*   MRC | 原子| 合成吸气剂：47
*   弧 | 非原子| 合成吸气剂：38（注意：ARC 在此处添加参考计数循环）
*   弧 | 原子| 合成吸气剂：47

正如您可能已经猜到的那样，引用计数活动/循环是原子和 ARC 下的重要贡献者。您还会在有争议的案件中看到更大的差异。

虽然我很关注性能，但我还是说**语义优先！**. 同时，对于许多项目来说，性能是一个低优先级。但是，了解您使用的技术的执行细节和成本当然不会受到伤害。您应该根据自己的需要、目的和能力使用正确的技术。希望这将为您节省几个小时的比较时间，并帮助您在设计程序时做出更明智的决定。

* * *

## 回答 #6

> 赞同：96
> 
> 时间：2013-07-10T13:07:39.873

**原子** = 线程安全

**非原子**= 没有线程安全

## 线程安全：

如果实例变量在从多个线程访问时行为正确，则无论运行时环境对这些线程执行的调度或交错如何，并且调用代码部分没有额外的同步或其他协调，实例变量都是线程安全的。

## 在我们的上下文中：

如果一个线程更改了实例的值，则更改后的值可供所有线程使用，并且一次只有一个线程可以更改该值。

## 在哪里使用`atomic`：

如果要在多线程环境中访问实例变量。

## 含义`atomic`：

没有那么快，`nonatomic`因为`nonatomic`从运行时不需要任何看门狗工作。

## 在哪里使用`nonatomic`：

如果实例变量不会被多个线程更改，则可以使用它。它提高了性能。

* * *

## 回答 #7

> 赞同：75
> 
> 时间：2013-03-21T07:10:56.293

在阅读了这么多文章、Stack Overflow 帖子并制作了检查变量属性属性的演示应用程序后，我决定将所有属性信息放在一起：

1.  `atomic` // 默认
2.  `nonatomic`
3.  `strong = retain` // 默认
4.  `weak = unsafe_unretained`
5.  `retain`
6.  `assign` // 默认
7.  `unsafe_unretained`
8.  `copy`
9.  `readonly`
10.  `readwrite` // 默认

在*[**iOS 中的变量属性属性或修饰符一**](http://rdcworld-iphone.blogspot.in/2012/12/variable-property-attributes-or.html)*文中，您可以找到上述所有属性，这肯定会对您有所帮助。

1.  **`atomic`**

    *   `atomic`意味着只有一个线程访问变量（静态类型）。
    *   `atomic`是线程安全的。
    *   但是性能很慢
    *   `atomic`是默认行为
    *   非垃圾收集环境中的原子访问器（即使用保留/释放/自动释放时）将使用锁来确保另一个线程不会干扰正确设置/获取值。
    *   它实际上不是关键字。

    例子：

    ```
     @property (retain) NSString *name;

        @synthesize name; 
    ```

2.  **`nonatomic`**

    *   `nonatomic`表示多线程访问变量（动态类型）。
    *   `nonatomic`是线程不安全的。
    *   但它的性能很快
    *   `nonatomic`不是默认行为。我们需要`nonatomic`在属性属性中添加关键字。
    *   当两个不同的进程（线程）同时访问同一个变量时，可能会导致意外行为。

    例子：

    ```
     @property (nonatomic, retain) NSString *name;

        @synthesize name; 
    ```

* * *

## 回答 #8

> 赞同：70
> 
> 时间：2012-02-24T05:17:25.370

[我在这里](http://archive.atomicmpc.com.au/forums.asp?s=2&c=10&t=4594)找到了对原子和非原子属性的很好解释。以下是来自相同的一些相关文本：

> “原子”意味着它不能被分解。在操作系统/编程术语中，原子函数调用是不能被中断的——必须执行整个函数，并且在完成之前不会通过操作系统通常的上下文切换将其从 CPU 中换出。以防万一您不知道：由于 CPU 一次只能做一件事，因此操作系统会在很小的时间片内轮换对所有正在运行的进程的 CPU 访问，以产生*错觉*的多任务处理。CPU 调度程序可以（并且确实）在进程执行的任何时候中断进程——即使是在函数调用中间。因此，对于像更新共享计数器变量这样的操作，其中两个进程可能会尝试同时更新变量，它们必须“原子地”执行，即，每个更新操作必须全部完成，然后任何其他进程才能交换到中央处理器。
> 
> 所以我猜想在这种情况下原子意味着属性读取器方法不能被中断 - 实际上意味着方法读取的变量不能在中途改变它们的值，因为其他一些线程/调用/函数得到换到CPU上。

因为`atomic`变量不能被中断，所以它们包含的值在任何时候都是（线程锁）保证是**未损坏**的，尽管确保这个线程锁会使访问它们变慢。`non-atomic`另一方面，变量不做这样的保证，但确实提供了更快访问的奢侈。总而言之，`non-atomic`当您知道多个线程不会同时访问您的变量并加快速度时，请继续。

* * *

## 回答 #9

> 赞同：60
> 
> 时间：2009-02-26T02:41:49.930

## **原子：**

原子保证对属性的访问将以原子方式执行。例如，它总是返回一个完全初始化的对象，一个线程上的任何属性的获取/设置必须在另一个线程访问它之前完成。

如果您想象以下函数同时发生在两个线程上，您就会明白为什么结果不会很漂亮。

```
-(void) setName:(NSString*)string
{
  if (name)
  {
    [name release]; 
    // what happens if the second thread jumps in now !?
    // name may be deleted, but our 'name' variable is still set!
    name = nil;
  }

  ...
} 
```

**优点：** 每次都返回完全初始化的对象，使其成为多线程情况下的最佳选择。

**缺点：** 性能下降，执行速度稍慢

## **非原子：**

与 Atomic 不同，它不能确保每次都返回完全初始化的对象。

**优点：** 执行速度极快。

**缺点：** 在多线程的情况下垃圾值的机会。

* * *

## 回答 #10

> 赞同：52
> 
> 时间：2009-02-26T02:56:47.210

首先是最简单的答案：您的后两个示例之间没有区别。默认情况下，属性访问器是原子的。

非垃圾收集环境中的原子访问器（即使用保留/释放/自动释放时）将使用锁来确保另一个线程不会干扰正确设置/获取值。

有关更多信息以及创建多线程应用程序时的其他注意事项，请参阅 Apple 的 Objective-C 2.0 文档的“[性能和线程](https://web.archive.org/web/20100723161456/http://developer.apple.com/mac/library/documentation/Cocoa/Conceptual/ObjectiveC/Articles/ocProperties.html#//apple_ref/doc/uid/TP30001163-CH17-SW12 "性能和线程")”部分。

* * *

## 回答 #11

> 赞同：31
> 
> 时间：2012-11-22T11:20:22.197

原子意味着只有一个线程访问变量（静态类型）。Atomic 是线程安全的，但速度很慢。

非原子意味着多个线程访问变量（动态类型）。非原子是线程不安全的，但它很快。

* * *

## 回答 #12

> 赞同：15
> 
> 时间：2015-07-07T09:56:10.080

Atomic 是**线程安全**的，它很**慢**，并且可以**很好地保证（不保证）**无论有多少线程尝试访问同一区域，都只提供锁定的值。使用 atomic 时，在此函数内编写的一段代码成为临界区的一部分，一次只能执行一个线程。

它只保证线程安全；它不保证这一点。**我的意思是您为您的汽车聘请了一位专业的司机，但这并不能保证汽车不会发生事故。然而，概率仍然微乎其微。**

原子的 - 它不能被分解，所以结果是预期的。使用非原子 - 当另一个线程访问内存区域时，它可以修改它，所以结果是意想不到的。

代码对话：

Atomic 使属性线程的 getter 和 setter 是安全的。例如，如果你写过：

```
self.myProperty = value; 
```

是线程安全的。

```
[myArray addObject:@"Abc"] 
```

不是线程安全的。

* * *

## 回答 #13

> 赞同：13
> 
> 时间：2016-07-23T06:34:02.200

> 原子（默认）
> 
> Atomic 是默认值：如果您不键入任何内容，则您的属性是原子的。保证原子属性，如果您尝试从中读取，您将返回一个有效值。它不保证该值可能是什么，但您将获得良好的数据，而不仅仅是垃圾内存。这允许您做的是，如果您有多个线程或多个进程指向一个变量，则一个线程可以读取而另一个线程可以写入。如果它们同时命中，则保证读取器线程获得以下两个值之一：更改之前或更改之后。atomic 没有为您提供任何关于您可能获得哪些值的保证。Atomic 通常与线程安全混淆，这是不正确的。您需要以其他方式保证您的线程安全。
> 
> 非原子的
> 
> 另一方面，正如你可能猜到的那样，非原子只是意味着“不要做那些原子的事情”。你失去的是保证你总能拿回一些东西。如果您尝试在写入过程中读取，则可能会取回垃圾数据。但是，另一方面，你走得更快一点。因为原子属性必须做一些魔术来保证你会得到一个值，所以它们有点慢。如果它是您经常访问的属性，您可能需要下拉到非原子以确保您不会受到速度损失。

在此处查看更多信息：[https ://realm.io/news/tmi-objective-c-property-attributes/](https://realm.io/news/tmi-objective-c-property-attributes/)

* * *

## 回答 #14

> 赞同：12
> 
> 时间：2011-11-08T05:41:12.423

**没有这样的关键字“原子”**

```
@property(atomic, retain) UITextField *userName; 
```

我们可以像上面一样使用

```
@property(retain) UITextField *userName; 
```

*[如果我使用 @property(atomic,retain)NSString *myString ，](https://stackoverflow.com/questions/8036604)*请参阅 Stack Overflow 问题。

* * *

## 回答 #15

> 赞同：11
> 
> 时间：2013-09-27T09:43:38.620

**默认**值为，这`atomic`意味着无论何时使用该属性都会降低性能，但它是线程安全的。Objective-C 所做的是设置一个锁，因此只有实际线程可以访问该变量，只要执行了 setter/getter。

带有 ivar _internal 的属性的 MRC 示例：

```
[_internal lock]; //lock
id result = [[value retain] autorelease];
[_internal unlock];
return result; 
```

所以最后两个是相同的：

```
@property(atomic, retain) UITextField *userName;

@property(retain) UITextField *userName; // defaults to atomic 
```

另一方面，不会`nonatomic`向您的代码添加任何内容。因此，如果您自己编写安全机制，则只有线程安全。

```
@property(nonatomic, retain) UITextField *userName; 
```

*关键字根本不必写为第一个属性属性。*

**不要忘记，这并不意味着属性作为一个整体是线程安全的。只有setter/getter的方法调用是。但是，如果您使用一个 setter，然后同时使用一个带有 2 个不同线程的 getter，它也可能被破坏！**

* * *

## 回答 #16

> 赞同：10
> 
> 时间：2016-12-13T03:27:21.787

*   **-Atomic 意味着只有一个线程访问变量（静态类型）。**
*   **-Atomic 是线程安全的。**
*   **- 但它的性能很慢**

**如何申报：**

由于 atomic 是默认的，所以，

```
@property (retain) NSString *name; 
```

AND 在实现文件中

```
self.name = @"sourov"; 
```

假设与三个属性相关的任务是

```
 @property (retain) NSString *name;
 @property (retain) NSString *A;
 @property (retain) NSString *B;
 self.name = @"sourov"; 
```

所有属性并行工作（如异步）。

**如果您从线程A**调用“名称” ，

**和**

同时，如果你打电话

```
[self setName:@"Datta"] 
```

从线程**B**，

**现在如果 *name 属性是非原子的**，那么

*   它将为 A 返回值“Datta”
*   它将为 B 返回值“Datta”

*这就是为什么非原子被称为线程不安全的原因但是由于并行执行，它的性能很快*

**现在如果 *name 属性是原子的**

*   它将确保 A 的值“Sourov”
*   然后它将为B返回值“Datta”

***这就是为什么原子被称为线程安全***， ***这就是为什么它被称为读写安全***

这种情况下的操作将连续执行。 **并且性能缓慢**

**- 非原子意味着多线程访问变量（动态类型）。**

**- 非原子是线程不安全的。**

**- 但它的性能很快**

**-Nonatomic 不是默认行为，我们需要在属性属性中添加 nonatomic 关键字。**

For In Swift 确认 Swift 属性在 ObjC 意义上是非原子的。一个原因是您考虑每个属性的原子性是否足以满足您的需求。

参考：[https ://forums.developer.apple.com/thread/25642](https://forums.developer.apple.com/thread/25642)

更多信息请访问网站 [http://rdcworld-iphone.blogspot.in/2012/12/variable-property-attributes-or.html](http://rdcworld-iphone.blogspot.in/2012/12/variable-property-attributes-or.html)

* * *

## 回答 #17

> 赞同：9
> 
> 时间：2014-08-13T11:57:09.213

如果您在多线程代码中使用您的属性，那么您将能够看到非原子属性和原子属性之间的区别。非原子比原子更快，原子是线程安全的，而不是非原子的。

Vijayendra Tripathi 已经给出了一个多线程环境的例子。

* * *

## 回答 #18

> 赞同：9
> 
> 时间：2016-04-28T16:18:23.940

开始之前：您必须知道内存中的每个对象都需要从内存中释放，以便新的写入器发生。你不能像在纸上那样简单地写在上面。您**必须**先擦除（dealloc）它，然后才能在其上写入。如果此时擦除完成（或一半完成）并且**尚未**写入任何内容（或写入一半）并且您尝试阅读它可能会非常有问题！原子和非原子可帮助您以不同的方式处理此问题。

首先阅读[这个](https://stackoverflow.com/questions/21098494/atomic-properties-vs-thread-safe-in-objective-c)问题，然后阅读[Bbum 的答案](https://stackoverflow.com/a/589392/5175709)。另外，然后阅读我的总结。

* * *

**`atomic`将永远保证**

*   如果两个不同的人想同时读写，你的论文就不会烧毁了！--> 即使在竞态条件下，您的应用程序也永远不会崩溃。
*   如果一个人正在尝试写并且只写了8个字母中的4个，那么中间没有可以阅读，只有当所有8个字母都写完才能阅读-->不会发生read(get) '一个仍在写入的线程'，即如果有8个字节到要写入的字节，并且只写入了4个字节——到那个时候，你是不允许从中读取的。但是因为我说它不会崩溃，所以它会从*自动释放*对象的值中读取。
*   如果**在**写作之前你**已经**擦除了之前写在纸上的内容，然后有人想阅读，你仍然*可以*阅读。如何？您将从类似于 Mac OS 垃圾箱的内容中读取内容（因为垃圾箱尚未 100% 擦除......它处于不确定状态）---> 如果 ThreadA 在 ThreadB 已被释放写入时读取，您将得到来自 ThreadB 最终完全写入的值或从自动释放池中获取的值。

> 保留计数是 Objective-C 中管理内存的方式。创建对象时，它的保留计数为 1。当您向对象发送保留消息时，其保留计数加 1。当您向对象发送释放消息时，其保留计数减 1。当您向一个对象发送一条**自动释放消息**，它的保留计数在将来的某个阶段减 1。如果一个对象的保留计数减少到 0，它就会被释放。

*   Atomic**不**保证线程安全，尽管它对于实现线程安全很有用。线程安全与您编写代码的方式/正在读取/写入的线程队列有关。它只保证不可崩溃的多线程。

* * *

**什么？！多线程和[线程安全](https://stackoverflow.com/questions/261683/what-is-meant-by-thread-safe-code)有区别吗？**

是的。多线程意味着：多个线程可以同时读取一个共享的数据并且我们不会崩溃，但它不能保证您不是从非自动释放的值中读取。使用线程安全，可以保证您阅读的内容不会自动发布。默认情况下我们不将所有内容都设为原子的原因是，存在性能成本，并且对于大多数事情来说并不真正需要线程安全。我们代码的一些部分需要它，对于这几个部分，我们需要使用锁、互斥锁或同步以线程安全的方式编写代码。

* * *

**`nonatomic`**

*   因为没有像 Mac OS 垃圾箱这样的东西，所以没有人关心你是否总是得到一个值（<-- 这可能会导致崩溃），也没有人关心是否有人试图在你的写作中读到一半（尽管在内存中写一半与在纸上写一半有很大不同，在内存上它可能会给你一个疯狂的愚蠢价值，而在纸上你只能看到一半已经写的东西）--> 不保证不会崩溃，因为它不使用自动释放机制。
*   不保证读取完整的书面值！
*   比原子更快

* * *

总体而言，它们在两个方面有所不同：

*   是否因为有或没有自动释放池而崩溃。

*   允许在“尚未完成写入或空值”的中间读取，或者不允许并且仅在值*完全*写入时才允许读取。

* * *

## 回答 #19

> 赞同：9
> 
> 时间：2019-01-29T06:12:16.930

***原子性 原子性（默认）***

> Atomic 是默认值：如果您不键入任何内容，则您的属性是原子的。保证原子属性，如果您尝试从中读取，您将返回一个有效值。它不保证该值可能是什么，但您将获得良好的数据，而不仅仅是垃圾内存。这允许您做的是，如果您有多个线程或多个进程指向一个变量，则一个线程可以读取而另一个线程可以写入。如果它们同时命中，则保证读取器线程获得以下两个值之一：更改之前或更改之后。atomic 没有为您提供任何关于您可能获得哪些值的保证。Atomic 通常与线程安全混淆，这是不正确的。您需要以其他方式保证您的线程安全。

***非原子的***

> 另一方面，正如你可能猜到的那样，非原子只是意味着“不要做那些原子的事情”。你失去的是保证你总能拿回一些东西。如果您尝试在写入过程中读取，则可能会取回垃圾数据。但是，另一方面，你走得更快一点。因为原子属性必须做一些魔术来保证你会得到一个值，所以它们有点慢。如果它是您经常访问的属性，您可能需要下拉到非原子以确保您不会受到速度损失。使用权

礼貌[https://academy.realm.io/posts/tmi-objective-c-property-attributes/](https://academy.realm.io/posts/tmi-objective-c-property-attributes/)

**原子性属性（原子和非原子）没有反映在相应的 Swift 属性声明中，但是当从 Swift 访问导入的属性时，Objective-C 实现的原子性保证仍然有效。**

**所以——如果你在 Objective-C 中定义一个原子属性，它在被 Swift 使用时仍然是原子的。**

礼貌 [https://medium.com/@YogevSitton/atomic-vs-non-atomic-properties-crash-course-d11c23f4366c](https://medium.com/@YogevSitton/atomic-vs-non-atomic-properties-crash-course-d11c23f4366c)

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2015-10-23T15:41:25.653

atomic 属性确保保留完全初始化的值，而不管有多少线程在其上执行 getter 和 setter。

非原子属性指定合成访问器直接设置或返回一个值，不保证如果从不同线程同时访问相同的值会发生什么。

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2016-02-01T08:27:02.147

原子意味着一次只有一个线程可以访问变量（静态类型）。Atomic 是线程安全的，但速度很慢。

非原子意味着多个线程可以同时访问变量（动态类型）。非原子是线程不安全的，但它很快。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2016-12-09T04:58:38.057

事实是他们使用自旋锁来实现原子属性。代码如下：

```
 static inline void reallySetProperty(id self, SEL _cmd, id newValue, 
      ptrdiff_t offset, bool atomic, bool copy, bool mutableCopy) 
    {
        id oldValue;
        id *slot = (id*) ((char*)self + offset);

        if (copy) {
            newValue = [newValue copyWithZone:NULL];
        } else if (mutableCopy) {
            newValue = [newValue mutableCopyWithZone:NULL];
        } else {
            if (*slot == newValue) return;
            newValue = objc_retain(newValue);
        }

        if (!atomic) {
            oldValue = *slot;
            *slot = newValue;
        } else {
            spin_lock_t *slotlock = &PropertyLocks[GOODHASH(slot)];
            _spin_lock(slotlock);
            oldValue = *slot;
            *slot = newValue;        
            _spin_unlock(slotlock);
        }

        objc_release(oldValue);
    } 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2021-07-03T07:48:01.220

在一行中：

`Atomic`是线程安全的。`Nonatomic`是线程不安全的。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2016-02-13T13:34:35.600

如果您使用原子，则意味着线程将是安全且只读的。如果你使用的是非原子的，这意味着多个线程访问变量并且是线程不安全的，但是它执行得很快，做了一个读写操作；这是一种动态类型。

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2016-06-29T08:56:11.037

原子：通过使用 NSLOCK 锁定线程来确保线程安全。

非原子：不确保线程安全，因为没有线程锁定机制。

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2016-09-23T18:41:26.640

为了简化整个混淆，让我们了解互斥锁。

互斥锁，顾名思义，锁定对象的可变性。因此，如果对象被一个类访问，则没有其他类可以访问同一个对象。

在 iOS 中，`@sychronise`还提供了互斥锁。现在它以 FIFO 模式服务，并确保流不受共享同一实例的两个类的影响。但是，如果任务在主线程上，请避免使用原子属性访问对象，因为它可能会占用您的 UI 并降低性能。

* * *

## 回答 #27

> 赞同：-2
> 
> 时间：2018-08-04T11:26:43.123

**原子属性**：- 当分配有原子属性的变量意味着它只有一个线程访问并且它将是线程安全的并且从性能角度来看会很慢时，将具有默认行为。

**非原子属性**：-当分配有原子属性的变量意味着它具有多线程访问并且它不是线程安全的并且从性能角度来看会很快时，将具有默认行为并且当两个不同的线程想要同时访问变量时它会产生意想不到的结果。

# performance - ListBox 的 Silverlight 列表框性能问题

> ID：588867
> 
> 赞同：1
> 
> 时间：2009-02-26T02:31:59.610
> 
> 标签：performance, silverlight, listbox

我正在开发一个在列表框控件中显示项目的 Silverlight 应用程序，我遇到了一些性能问题。

列表框中的每个项目都是一个自定义堆栈面板，其中包含一些格式化文本等。

当我有一个包含 500 个或更少项目的列表时，列表框可​​以正常工作，但是加载超过这个会导致问题。在 1000 个项目时，Silverlight 将消耗 10% 的 cpu，即使我什么都不做，在 3000 个项目时，cpu 会持续使用 32-36%。

这是在双核机器上，在我测试过的旧机器上 cpu 使用率上升了很多。

这也会影响帧速率，我在 3000 项列表框中获得 6fps，这使应用程序变得迟缓。

有谁知道这可能是什么原因造成的？我的第一个想法是，silverlight 正在尝试渲染所有项目，即使这些项目不在屏幕上……这似乎是一致的，就好像我用它们的 Visability.Collapsed 插入项目一样，不存在额外的 cpu 开销。

PS：我在 windowless="true" 中运行，因为我需要在我的 silverlight 表单上显示一些 html。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T05:07:34.167

您应该使用 Silverlight 2 中的 DataGrid，因为它支持 UI 虚拟化。它已经过数百万个项目的测试，只会创建足够显示所需的视觉效果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T03:02:29.367

你的猜测基本正确。尽管 Silverlight 不会尝试*渲染*ListBox 中的所有 3000 个元素，但它仍然需要创建 3000 个 ListBoxItem 对象，这些对象依次在布局时进行测量和排列等，只是为了在渲染时对它们进行裁剪。当元素折叠时布局发生得更快（因为在这种情况下布局基本上没有什么可做的）。

WPF 有 VirtualizingStackPanel 可以解决这个问题，不幸的是 Silverlight 没有这个元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T05:17:33.770

+1 在这种情况下使用 Silverlight DataGrid，请确保您安装了[最新版本](http://www.microsoft.com/downloadS/details.aspx?FamilyID=084a1bb2-0078-4009-94ee-e659c6409db0&displaylang=en)，因为默认 Silverlight SDK 版本有一些错误。

另一种选择是使用[此处提供](http://www.devexpress.com/Products/NET/Controls/Silverlight/Grid/)的免费 Silverlight DataGrid 控件。它的功能之一也是 Virtual StackPanel Row Container，这意味着网格可以处理无限数量的行。

比较每个的性能，看看哪个最适合您的情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-04T17:00:29.220

只是一个观察 - Silverlight 4 看起来这不再是一个问题。将 100K 元素添加到数据模板列表框中是即时的，并且呈现也很好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-01T08:09:15.287

这对我有帮助：[Silverlight DeferredLoadListBox](http://dlaa.me/blog/post/10059428)。它由 Microsoft 员工 David Anson 编写。

`DeferredLoadListBox`派生自`ListBox`但具有更好的性能。

# java - Android InputStream Internet 断开连接

> ID：588876
> 
> 赞同：7
> 
> 时间：2009-02-26T02:37:49.707
> 
> 标签：java, android, http, inputstream, disconnect

在我的 Android 程序中，我有一些下载文件的代码。这很好用，但是由于在手机上，您可以随时断开连接，我需要更改它，以便在您完成一半并且有人打电话/您失去手机接收/等时重新连接并恢复下载。我无法弄清楚如何检测 InputStream 已停止工作。请看下面的代码：

```
InputStream in = c.getInputStream();

    byte[] buffer = new byte[8024];
    int len1 = 0;

    while ( (len1 = in.read(buffer)) > 0 ) {
        Log("-"+len1+"- Downloaded.");
        f.write(buffer,0, len1);
        Thread.sleep(50);
    } 
```

当我失去互联网连接时，我的日志显示：

```
Log: -8024- Downloaded.
Log: -8024- Downloaded.
Log: -8024- Downloaded.
Log: -8024- Downloaded.
Log: -6024- Downloaded. (some lower number) 
```

然后我的程序就挂在 while( (len1 = etc.) 上。我需要这样做，所以当互联网断开连接时，我等待互联网再次连接，然后恢复下载。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T02:44:04.823

看看这里：http: [//developer.android.com/reference/java/nio/channels/SocketChannel.html](http://developer.android.com/reference/java/nio/channels/SocketChannel.html)

编辑（基于评论）： [http ://www.jguru.com/faq/view.jsp?EID=72378](http://www.jguru.com/faq/view.jsp?EID=72378)

所以基于上面的想法....您可以将读数放在一个线程中并定期检查线程是否已停止读取数据（可能更新共享变量）。如果它已经终止了连接和线程并根据需要进行处理。

另一种选择是不使用 HTTPURLConnection 并处理您自己需要的位。

# .net - 为 VB6 桌面应用程序创建 .net dll 与 vb6 dll 的最佳实践？

> ID：588879
> 
> 赞同：0
> 
> 时间：2009-02-26T02:39:41.807
> 
> 标签：.net, dll, vb6

我正在尝试使用表单和一些 shell 方法创建另一个 dll 来调用外部 exe，同时允许我的主表单运行不受干扰的类似伪多线程的东西。所有这些有益健康的好处都在旧的 vb6 遗留应用程序中。

所以我试图决定是否应该使用 .net 来编写 dll 或 vb6 来编写 dll。这有关系吗，在我冒险之前我应该​​知道的最小/刻度是多少？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T13:13:33.750

如果您想要一个独立的表单，那么 ActiveX EXE 就足够了。独立表单是可以显示并且调用应用程序继续运行的表单。两人并没有阻止对方。在这种情况下，.NET DLL 是多余的。

如果您需要涉及传统多任务的东西，例如获取大量数据并对其进行处理，那么 .NET DLL 可能是更好的解决方案，因为多任务比 VB6 的 EXE->Active EXE 解决方案更直接.

根据您的其他问题，我认为创建一个全局多用途类，该类公开方法和参数以在您的 EXE 引用的 ActiveX EXE 中调用您需要的表单将是可行的方法。

更多细节将帮助我制定更好的答案。

评论后@EDIT

然后通过 ActiveX EXE 传输表单和对象将是正确的方法。然后您可以从原始 EXE 中引用 ActiveX EXE。

唯一的问题是您复制的内容是否真正独立。好消息是，通过留在 VB6 中，您将立即发现任何问题，而不用怀疑它是否是转换过程的产物。如果这是您的长期目标，稍后您可以专注于向 .NET 的转换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T09:05:01.023

我认为这与[您的其他问题有关](https://stackoverflow.com/questions/584987/what-is-the-best-practice-for-converting-a-vb6-standard-exe-to-a-activex-exe)吗？在这种情况下，您实际上并不需要 DLL - 我认为您误解了 RS Conley 的回答。希望这会有所帮助，马克

# wpf - WPF - 自定义画布上的用户控件大小

> ID：588880
> 
> 赞同：0
> 
> 时间：2009-02-26T02:39:44.680
> 
> 标签：wpf, layout, user-controls, canvas

我有一个自定义画布，可以在上面放置控件、移动控件和调整其大小。我需要能够至少从预先确定的大小开始，然后允许重新调整大小。

我的问题是我有一个似乎没有调整大小的用户控件。我在用户控件上设置了高度和宽度（在放置时工作）。但是当控件在画布上调整大小时，视觉大小保持不变（大小手柄正在改变）。当控件调整大小时，我可以看到 Height 属性发生变化（usercontrol.height）。但同样，控件的外观保持相同的大小。

我认为用户控件上的内部容器应该绑定到 usercontrol.height ，但这似乎没有帮助。（或者也许我没有绑定权）。

在同一个画布上，例如，如果放置的控件是 Image 控件，我可以在放置时设置显式高度，并且所有内容都可以调整大小。所以它似乎是 UserControl 的事情。

那么我需要对 UserControls 做些什么来调整视觉效果吗？我应该使用明确的高度和宽度来开始吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T09:36:50.557

正如您所发现的，WPF 布局系统可能会令人困惑。对布局和测量系统有扎实的了解是无可替代的。如果您打算进行大量 WPF 开发，那么值得花 20 分钟阅读[有关布局系统的这篇文章，然后在](http://msdn.microsoft.com/en-us/library/ms745058.aspx#LayoutSystem_Measure_Arrange)[Kaxaml](http://www.kaxaml.com)等迭代环境中试验一段时间，直到您感到舒服为止。

该系统非常合乎逻辑。一分钱很快就会下降。很抱歉间接回答，但我认为您的问题中没有足够的信息来真正解释发生了什么。

您还可以查看`HorizontalAlignment`and`VerticalAlignment`属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T03:18:29.517

不是 WPF 专家，但我相信您需要启用自动调整大小才能实现您正在寻找的场景。这是通过将控件的高度/宽度设置为 Double.NaN 来完成的，这实际上是说“我没有特定的大小”。完成此操作后，控件应根据控件的需要调整大小以占用可用空间。

# windows - Windows 服务器上非托管 VC++ 应用程序的内存消耗

> ID：588882
> 
> 赞同：2
> 
> 时间：2009-02-26T02:40:46.033
> 
> 标签：windows, visual-c++, memory

好的，所以我有一个在 Windows 2003 服务器上运行的非常大的多线程非托管 C++ 应用程序（服务器）。它为执行各种业务逻辑的 20-50 个并发用户托管会话...有时由于用户在客户端中打开大量窗口而导致对象/会话缓存之类的事情，它可能会使用大量内存（每个窗口都有一个单独的服务器“会话”。

我们经常看到消耗超过 5-600 MB 的物理内存和 5-600 MB 的虚拟内存。一旦达到这一点，我们似乎开始出现“内存不足”错误。

现在我知道 Windows 在需要释放物理内存时会启动页面错误，而且 win32 应用程序通常最多只能分配 4GB 的内存，实际上只有 2GB 可用应用程序对“用户模式”地址空间的实际使用，甚至在加载其他库后更少......我不确定“用户模式”内存使用情况是否是任务管理器上报告的内容。 ..

**所以无论如何我真正的问题是：**

**如何找出我的应用程序可以访问多少用户模式内存，以及在任何给定时间已使用多少（最好从应用程序外部，即某些 Windows 管理工具）？**

[编辑] 在查看 Process Explorer 和网站后，看起来“虚拟大小”的值是应用程序可以访问多少内存的值。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-26T05:30:24.487

听起来像是[Microsoft SysInternals 的免费实用程序 Process Explorer 的](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)一个案例：

[![替代文字](https://i.stack.imgur.com/rikuk.jpg)](https://i.stack.imgur.com/rikuk.jpg)
[（来源：[microsoft.com](http://i.technet.microsoft.com/bb896653.ProcessExplorer(en-us,MSDN.10).jpg)）]

**描述：**

> 有没有想过哪个程序打开了特定的文件或目录？现在你可以找出答案了。Process Explorer 向您显示有关哪些句柄和 DLL 进程已打开或加载的信息。
> 
> Process Explorer 显示由两个子窗口组成。顶部窗口始终显示当前活动进程的列表，包括其拥有帐户的名称，而底部窗口中显示的信息取决于 Process Explorer 所处的模式：如果它处于句柄模式，您将看到处理顶部窗口中选择的进程已打开；如果 Process Explorer 处于 DLL 模式，您将看到该进程已加载的 DLL 和内存映射文件。Process Explorer 还具有强大的搜索功能，可以快速显示哪些进程打开了特定的句柄或加载了 DLL。
> 
> Process Explorer 的独特功能使其可用于跟踪 DLL 版本问题或处理泄漏，并提供对 Windows 和应用程序工作方式的洞察。

* * *

如果您正在寻找有关终端服务器特定信息的更多信息，我一直在关注一个程序员的博客，该博客正在发布一个工具的测试版，我相信它会完全满足您的需求。它是一个改进的 TSAdmin。他称之为 TSAdminEx。

请参阅下面的屏幕截图，并[单击此处了解更多信息并获取测试版](http://www.remkoweijnen.nl/blog/2009/02/20/tsadminex-beta-release/)。这是免费软件，顺便说一句。

![替代文字](https://www.remkoweijnen.nl/blog/wp-content/uploads/2009/02/tsadminexprocesses-small.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-11T02:24:34.403

我知道您最好从应用程序外部要求，但我正在谷歌搜索如何从我自己的程序中找到此类信息，并偶然发现了您的帖子。因此，这是为了让那些希望从他们的计划中获得这些信息的人*受益*。

**非托管 C++**

```
#include <windows.h>
#include <stdio.h>
#include <psapi.h>

void PrintMemoryInfo( DWORD processID )
{
    HANDLE hProcess;
    PROCESS_MEMORY_COUNTERS pmc;

    // Print the process identifier.

    printf( "\nProcess ID: %u\n", processID );

    // Print information about the memory usage of the process.

    hProcess = OpenProcess(  PROCESS_QUERY_INFORMATION |
                             PROCESS_VM_READ,
                             FALSE, 
                             processID );
    if (NULL == hProcess)
        return;

    if ( GetProcessMemoryInfo( hProcess, &pmc, sizeof(pmc)) )
    {
        printf( "\tPageFaultCount: 0x%08X\n", pmc.PageFaultCount );
        printf( "\tYour app's PEAK MEMORY CONSUMPTION: 0x%08X\n", 
                  pmc.PeakWorkingSetSize );
        printf( "\tYour app's CURRENT MEMORY CONSUMPTION: 0x%08X\n", pmc.WorkingSetSize );
        printf( "\tQuotaPeakPagedPoolUsage: 0x%08X\n", 
                  pmc.QuotaPeakPagedPoolUsage );
        printf( "\tQuotaPagedPoolUsage: 0x%08X\n", 
                  pmc.QuotaPagedPoolUsage );
        printf( "\tQuotaPeakNonPagedPoolUsage: 0x%08X\n", 
                  pmc.QuotaPeakNonPagedPoolUsage );
        printf( "\tQuotaNonPagedPoolUsage: 0x%08X\n", 
                  pmc.QuotaNonPagedPoolUsage );
        printf( "\tPagefileUsage: 0x%08X\n", pmc.PagefileUsage ); 
        printf( "\tPeakPagefileUsage: 0x%08X\n", 
                  pmc.PeakPagefileUsage );
    }

    CloseHandle( hProcess );
}

int main( )
{
  PrintMemoryInfo( GetCurrentProcessId() );

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T13:52:02.037

你写了：

> 当您谈论 win32 应用程序可以访问多少内存时，他们特别将其称为“用户模式”内存，我不认为这是一个选项，或者至少我不知道它到底是什么列。

[看看这篇文章](http://blogs.technet.com/markrussinovich/archive/2008/07/21/3092070.aspx)（由 Process Explorer 的创建者 Mark Russinovich 博士撰写）。

*为了能够有效地管理您的 Windows 系统，您需要了解 Windows 如何管理物理资源（例如 CPU 和内存）以及逻辑资源（例如虚拟内存、句柄和窗口管理器对象）。了解这些资源的限制以及如何跟踪它们的使用情况使您能够将资源使用归因于使用它们的应用程序，有效地为特定工作负载调整系统大小，并识别泄漏资源的应用程序。*

# java - 使用 JDOM 重写 XML/DOM 树的问题 (ConcurrentModificationException)

> ID：588883
> 
> 赞同：1
> 
> 时间：2009-02-26T02:40:48.590
> 
> 标签：java, xml, dom, jdom

我需要遍历 JDOM 树并进行更改；目前，更改主要是添加新元素，但也可能包括重新排序元素或删除元素。所有工作都在同一个线程上完成，因此不存在并发问题。

事实证明这很困难，因为如果您尝试在遍历期间添加节点，JDOM 迭代器可能会抛出 ConcurrentModificationException。据我所知，JDOM 使用列表而不是直接链接 DOM 节点，这使得动态修改变得困难。

我已经看到了一些关于如何处理这个问题的建议，例如将添加推迟到遍历完成之后，或者动态构建一个新树，以便遍历的树保持不变。这些对我不起作用，因为我在修改树时需要一致的视图。

我开始怀疑 JDOM 在这里行不通。是否有任何其他 Java DOM 模型使这更容易？或者有没有办法在 JDOM 中做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T19:01:22.853

我想出了一个使用 JDOM 的简单解决方案。我没有直接使用 JDOM 迭代器，而是使用迭代器创建一个节点列表，然后使用这个列表进行遍历。由于此列表不是“实时”的，因此我的脚本可以修改树（并查看更改）而不影响遍历。遍历不会看到结构变化，但这应该不是问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T02:48:09.290

你有理由不能简单地做两次传球吗？

我熟悉的大多数算法在装饰树时不需要超过 2 次遍历（理想情况下，您的算法应该需要一个通道来进行初始装饰，并且可能需要第二个来解决装饰后的引用）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T04:49:24.803

由于您愿意使用其他模型，因此您可能会考虑 Elliotte Rusty Harold 的[XOM](http://www.xom.nu/) API。它坚如磐石，不允许您创建无效的 XML 结构。

# c++ - 为什么编译需要这么长时间？

> ID：588884
> 
> 赞同：17
> 
> 时间：2009-02-26T02:41:21.943
> 
> 标签：c++, c, performance, compilation, language-design

我正在设计一种编程语言，我在想的一个问题是为什么编程语言需要很长时间才能编译。假设 c++ 需要很长时间，因为它需要在每次编译文件时解析和编译头文件。但是我听说预编译的头文件需要很长时间？我怀疑 C++ 不是唯一有这个问题的语言。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-26T03:20:27.933

One C++ specific problem that makes it horribly slow is that, unlike almost any other language, you can't parse it independently of semantic analysis.

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-26T02:46:22.463

编译是一个复杂的过程，涉及很多步骤：

*   扫描/词法分析
*   解析
*   中间代码生成
*   可能是中间代码优化
*   目标机器代码生成
*   可选的机器相关代码优化

（撇开链接。）

当然，对于较长的程序，这将需要一些时间。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-26T03:21:13.830

Precompiled headers are *way* faster, as has been known at least since 1988.

The usual reason for a C compiler or C++ compiler to take a long time is that it has to #include, preprocess, and then lex gazillions of tokens.

As an exercise you might find out how long it takes just to run cpp over a typical collection of header files---then measure how long it takes to lex the output.

gcc -O uses a very effective but somewhat slow optimization technique developed by Chris Fraser and Jack Davidson. Most other optimizers can be slow because they involve repeated iteration over fairly large data structures.

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-02-26T02:51:21.500

语言设计*确实*对编译器性能有影响。C++ 编译器通常比 C# 编译器慢，这与语言的设计有很大关系。（这也取决于编译器实现者，[Anders Hejlsberg](http://en.wikipedia.org/wiki/Anders_Hejlsberg)实现了 C#，是最好的之一。）

尽管预编译的头文件通常会有所帮助，但 C++ 简单的“头文件”结构会导致其性能下降。C++ 是一种比 C 复杂得多的语言，因此 C 编译器通常更快。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-26T17:19:37.933

编译*不需要*花很长时间：[tcc](http://bellard.org/tcc/)编译 ANSI c 的速度足够快，可以用作*解释器*。

需要考虑的一些事情：

1.  扫描和解析过程的复杂性。大概需要长时间的前瞻会受到伤害，上下文（与上下文无关）语言也会受到影响。
2.  内部表示。构建和处理大型且功能强大的 AST 需要一些时间。大概你应该使用最简单的内部表示来支持你想要实现的特性。
3.  优化。优化很麻烦。您需要检查许多不同的条件。您可能想要多次通过。所有这一切都需要时间。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-26T02:47:58.293

它们花费的时间与花费的时间一样长，并且通常取决于您将多少无关的东西注入到编译单元中。我希望看到你更快地手动编译它们:-)

第一次编译文件时，您应该根本没有头文件。然后根据需要添加它们（并在完成时检查是否仍然需要它们）。

减少时间的其他方法是保持编译单元很小（在极端情况下，甚至到每个文件一个函数）并使用类似 make 的工具来确保您只构建需要的内容。

一些编译器（实际上是 IDE）在后台进行增量编译，因此它们（几乎）总是接近完全编译的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-02-18T06:58:10.523

我认为这里的其他答案错过了 C++ 编译速度慢的情况的一些重要部分：

*   `.obj`将/`.o`文件保存到磁盘，读回它们，然后链接它们的编译模型
*   一般链接，特别是坏的慢链接器
*   过于复杂的宏预处理器
*   任意复杂的图灵完备模板系统
*   嵌套和重复包含源文件，即使使用`#pragma once`
*   用户造成的碎片，将代码分成太多的文件（在极端情况下甚至到每个文件一个函数）
*   编译器中臃肿或低效的内部数据结构
*   过度膨胀的标准库，模板滥用

相比之下，这些不会减慢 C++ 编译速度：

*   扫描/词法分析
*   解析
*   中间代码生成
*   目标机器码生成

顺便说一句，优化是最大的减速之一，但它是这里唯一在某种程度上实际上是必要的减速，而且它完全是可选的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-08-12T07:13:46.487

运行 Idera RAD Studio（有免费版本）。它带有 C++ 和 Delphi。Delphi 代码的编译时间是 C++ 代码执行相同操作的时间的一小部分。这是因为 C++ 在过去的几十年里发展得非常可怕，没有太多考虑编译器的后果，因为它是由复杂的上下文决定的宏以及在某种程度上所谓的“.hpp”地狱。艾达也有类似的问题。Pascal 的 Delphi 方言从一开始就被设计为一种高效的编译语言。因此编译器和运行需要几秒钟而不是几分钟，从而使迭代调试变得快速而简单。调试编译语言的速度很慢是一个巨大的时间浪费，而且你知道什么是痛苦的！顺便说一句，安德斯在 M$ 偷走他之前也写过 Delphi！

# .net - 避免因工作流所做的更改而触发 OnWorkflowItem

> ID：588886
> 
> 赞同：1
> 
> 时间：2009-02-26T02:42:20.240
> 
> 标签：.net, workflow-foundation

我有一个响应列表项更改的状态机工作流程。工作流还会更新列表项；当工作流进行更改时，有什么方法可以避免触发 OnWorkflowItem 更改事件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T04:10:11.013

使用 List 项的 .SystemUpdate() 方法而不是 Update()。

*   奥辛

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T23:33:11.047

所以我找到了一个解决方法，但它非常难看，希望有人有更好的答案。

我没有让一个状态进行更新然后等待事件，而是将其拆分为两个状态。第一个状态更新列表项，捕获更改事件，然后转换到等待用户更改的第二个状态。

# php - 你能在 PHP 中“退出”一个循环吗？

> ID：588892
> 
> 赞同：129
> 
> 时间：2009-02-26T02:44:51.220
> 
> 标签：php, loops

我有一个循环在我的 PHP 代码中进行一些错误检查。最初它看起来像这样......

```
foreach($results as $result) {
    if (!$condition) {
        $halt = true;
        ErrorHandler::addErrorToStack('Unexpected result.');
    }

    doSomething();
 }

if (!$halt) {
    // do what I want cos I know there was no error
} 
```

这一切都很好，但它仍然循环通过，尽管在一个错误之后它不需要。有没有办法摆脱循环？

* * *

## 回答 #1

> 赞同：222
> 
> 时间：2009-02-26T02:47:16.347

您正在寻找[break](http://www.php.net/break)语句。

```
$arr = array('one', 'two', 'three', 'four', 'stop', 'five');
while (list(, $val) = each($arr)) {
    if ($val == 'stop') {
        break;    /* You could also write 'break 1;' here. */
    }
    echo "$val<br />\n";
} 
```

* * *

## 回答 #2

> 赞同：159
> 
> 时间：2009-02-26T02:58:57.270

如其他帖子所述，您可以使用 break 关键字。暗示但未解释的一件事是，关键字可以采用数值来告诉 PHP 要突破多少级。

例如，如果您有三个相互嵌套的 foreach 循环试图查找一条信息，则可以执行“break 3”以退出所有三个嵌套循环。这适用于“for”、“foreach”、“while”、“do-while”或“switch”结构。

```
$person = "Rasmus Lerdorf";
$found = false;

foreach($organization as $oKey=>$department)
{
   foreach($department as $dKey=>$group)
   {
      foreach($group as $gKey=>$employee)
      {
         if ($employee['fullname'] == $person)
         {
            $found = true;
            break 3;
         }
      } // group
   } // department
} // organization 
```

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2009-02-27T02:03:05.833

`break;`离开你的循环。

`continue;`跳过该循环其余部分的任何代码并继续下一个循环，只要条件仍然为真。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-02-26T02:45:53.337

您可以使用[break](http://ar2.php.net/break)关键字。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-01-10T02:14:20.393

```
$arr = array('one', 'two', 'three', 'four', 'stop', 'five');
foreach ($arr as $val) {
    if ($val == 'stop') {
        break;    /* You could also write 'break 1;' here. */
    }
    echo "$val<br />\n";
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-12-21T21:41:56.973

所有这些都是很好的答案，但我想再提出一个我认为更好的代码标准。您可以选择在循环条件中使用一个标志来指示是否继续循环并避免`break`一起使用。

```
$arr = array('one', 'two', 'three', 'four', 'stop', 'five');
$length = count($arr);
$found = false;
for ($i = 0; $i < $length && !$found; $i++) {
    $val = $arr[$i];
    if ($val == 'stop') {
        $found = true; // this will cause the code to 
                       // stop looping the next time 
                       // the condition is checked
    }
    echo "$val<br />\n";
} 
```

我认为这是更好的代码实践，因为它不依赖于所`break`使用的范围。相反，您定义了一个变量来指示是否中断特定循环。当您有许多可能是或可能不是嵌套或顺序的循环时，这很有用。

# url - SEO 和重复 URL

> ID：588911
> 
> 赞同：2
> 
> 时间：2009-02-26T02:52:12.730
> 
> 标签：url, seo, http-status-code-301

我正在更新网站的菜单系统并添加 SEO 网址。在一段时间内，我将有两个指向类似资源的 URL，但只有其中一个会呈现在菜单上。

我应该保留旧网址还是删除它们？如果我离开它们，那么谷歌结果将不会链接到 404 页面，但它们可能会被视为垃圾邮件。我应该重定向它们吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T03:06:04.023

绝对使用 301 永久重定向，这就是它的意义所在。只要可行，最好保留旧 URL（使用 301 重定向），这对那些仍然拥有旧 URL 书签或其他东西的人有利，Google 等将确切知道如何处理它们。我非常怀疑它们会被视为垃圾邮件。

# mysql - 从具有相同列的两个表中选择数据

> ID：588913
> 
> 赞同：5
> 
> 时间：2009-02-26T02:52:33.710
> 
> 标签：mysql

我有两个结构相同的表；一个包含永久数据，一个定期清除和重置。

我需要在两者上都使用相同的选择语句，就好像它们只是一张表一样

这是我尝试过的：

选择 * 从`a`,`b`其中 1;

其中`a`和`b`具有相同的结构；

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-26T02:55:47.213

您可能正在查看在查询中使用 UNION：

```
Select * from a
UNION
Select * from b 
```

注意：更好的做法是限定列名而不是使用 * 引用。如果您的两个表经历了架构更改，但您仍想拉回两个表共有的所有数据，这也将使查询仍然有用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-26T02:56:47.663

所以你想要一组包含两个表内容的结果？如果是这样，那么您需要执行以下操作：

```
select a.col1, a.col2 from a where...
UNION
select b.col1, b.col2 from b where... 
```

[mysql联合语法](http://dev.mysql.com/doc/refman/5.0/en/union.html)

# sql - 当结果集非常大且无法按索引排序时优化“ORDER BY”

> ID：588914
> 
> 赞同：2
> 
> 时间：2009-02-26T02:52:46.393
> 
> 标签：sql, optimization, limit, sql-order-by

当我不能使用索引来满足行的排序时，如何使具有小 LIMIT（即一次 20 行）的 ORDER BY 子句快速返回？

假设我想从表“节点”（下面简化）中检索一定数量的标题。顺便说一句，我正在使用 MySQL。

```
node_ID INT(11) NOT NULL auto_increment,
node_title VARCHAR(127) NOT NULL,
node_lastupdated INT(11) NOT NULL,
node_created INT(11) NOT NULL 
```

但我需要将返回的行限制为仅特定用户有权访问的行。许多用户可以访问大量节点。我在一个大查找表中预先计算了这些信息（试图让事情变得更容易），其中主键涵盖两列，并且行的存在意味着用户组可以访问该节点：

```
viewpermission_nodeID INT(11) NOT NULL,
viewpermission_usergroupID INT(11) NOT NULL 
```

因此，我的查询包含类似

```
FROM
  node
  INNER JOIN viewpermission ON
    viewpermission_nodeID=node_ID
    AND viewpermission_usergroupID IN (<...usergroups of current user...>) 
```

...而且我还使用 GROUP BY 或 DISTINCT 以便即使两个用户的“用户组”都可以访问该节点，一个节点也只会返回一次。

我的问题是，对于按创建或上次更新日期对结果进行排序的 ORDER BY 子句似乎无法使用索引，因为返回的行取决于另一个 viewpermission 表中的值。

因此 MySQL 需要找到*所有*符合条件的行，然后自己对它们进行排序。如果特定用户有一百万行，并且我们想查看最新的 100 行或按上次更新排序时的 100-200 行，则数据库需要确定用户可以看到哪些一百万行，排序这整个结果集本身，在它可以返回那 100 行之前，对吧？

有没有什么创造性的方法来解决这个问题？我一直在思考：

*   以某种方式将日期添加到查看权限查找表中，以便我可以建立一个包含日期和权限的索引。我猜这是一种可能。

**编辑：简化问题**

也许我可以通过这样重写来简化问题：

有什么方法可以重写此查询或为以下内容创建索引，以便可以使用索引进行排序（不仅仅是选择行）？

```
SELECT nodeid
FROM lookup
WHERE
  usergroup IN (2, 3)
GROUP BY
  nodeid 
```

(usergroup) 上的索引允许索引满足 WHERE 部分，但 GROUP BY 强制对这些行使用临时表和文件排序。(nodeid) 上的索引对我没有任何作用，因为 WHERE 子句需要一个以用户组作为第一列的索引。(usergroup, nodeid) 上的索引强制使用临时表和文件排序，因为 GROUP BY 不是可以变化的索引的第一列。

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T08:14:26.560

我可以回答我自己的问题吗？

我相信我发现，做我所描述的事情的唯一方法是让我的查找表为每个可能的用户组组合包含一个人可能希望成为其中成员的行。

要选择一个简化的示例，而不是这样做：

```
SELECT id FROM ids WHERE groups IN(1,2) ORDER BY id 
```

如果您需要使用索引来选择行并对其进行排序，则必须抽象该 IN(1,2) 以便它是常量而不是范围，即：

```
SELECT id FROM ids WHERE grouplist='1,2' ORDER BY id 
```

当然，除了使用字符串 '1,2' 之外，您还可以在其中有一个外键，等等。关键是，您不仅要为每个组，而且要为多个组的每个组合设置一行。

所以，有我的答案。

无论如何，对于我的应用程序，我觉得为每个节点维护所有可能的用户组组合的查找是不值得的。出于我的目的，我预测大多数节点对大多数用户都是可见的，所以我觉得简单地让 GROUP BY 使用索引是可以接受的，因为过滤并不那么需要它。

换句话说，我对原始查询采用的方法可能类似于：

```
SELECT
    <fields>
FROM
  node
  INNER JOIN viewpermission ON
    viewpermission_nodeID=node_ID
    AND viewpermission_usergroupID IN (<...usergroups of current user...>)
  FORCE INDEX(node_created_and_node_ID)
GROUP BY
  node_created, node_ID 
```

如果 GROUP BY 从索引的最左侧列开始并且它位于要处理的第一个非常量非系统表中，则可以使用索引。然后连接处理整个列表（已经排序），只有那些对当前用户不可见的（将是一小部分）被 INNER JOIN 删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T03:01:17.870

将您要订购的值复制到查看权限表并将其添加到您的索引中。

您可以使用触发器来维护另一个表中的该值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T03:05:33.743

```
select * from
(
select *
FROM  node  
INNER JOIN viewpermission 
ON    viewpermission_nodeID=node_ID    
AND viewpermission_usergroupID IN (<...usergroups of current user...>)
) a
order by a.node_lastupdated desc 
```

内部查询为您提供了过滤后的子集，据我所知，它比整个集合要小得多。只有较小的需要排序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T03:44:37.503

当你在同一个查询中使用`GROUP BY`和时，MySQL 会出现问题。`ORDER BY`这会导致文件排序，这可能是对性能的最大损失。

您可以通过使用非相关子查询而`DISTINCT`不是.`GROUP BY``JOIN`

```
SELECT * FROM node
WHERE node_id IN (
  SELECT viewpermission_nodeID
  FROM viewpermission
  WHERE viewpermissiong_usergroupID IN ( <...usergroups...> )
)
ORDER BY node_lastupdated DESC
LIMIT 100; 
```

无需`DISTINCT`对子查询进行排序或执行 a ，因为`IN (1, 1, 2, 3)`与`IN (1, 3, 2)`.

请注意，MySQL 在给定查询中每个表只能使用一个索引，因此它会尝试在 index on`node_id`和 index on之间做出最佳选择`node_lastupdated`。它不能同时使用两者，即使您制作了复合索引，在这种情况下也无济于事。

请记住使用 分析不同的解决方案[`EXPLAIN`](http://dev.mysql.com/doc/refman/5.1/en/using-explain.html)。

# php - ImageMagick/Imagick 使用原生 PHP API 将 PDF 转换为 JPG

> ID：588918
> 
> 赞同：12
> 
> 时间：2009-02-26T02:54:10.230
> 
> 标签：php, image, pdf, pdf-generation, ghostscript

我正在尝试将 PDF 文件转换为 PNG。它在命令行中运行良好（我确实安装了 GhostScript 8.64）。但是从PHP我遇到了一个问题：

代码：

```
$im = new Imagick($pdf_file); // this is where it throws the exception below 
```

输出：

```
Fatal error: Uncaught exception ‘ImagickException’ with message ‘Postscript delegate failed `23_1235606503.pdf’: No such file or directory @ pdf.c/ReadPDFImage/612′ in get_thumbnail.php:93
Stack trace:
\#0 get_thumbnail.php(93): Imagick->__construct(’…’) 
```

等等等等

我不确定我在这里做错了什么，但我怀疑这与我在某处的服务器配置有关。我正在运行：Apache 2.2.11 PHP 5.2.8 ImageMagick 6.4.8-9 GhostScript 8.64

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-26T17:05:15.253

终于想通了。GhostScript 可执行文件 ( `gs`) 不在 Apache 的环境路径中。它在`/usr/local/bin`. 虽然我尝试了几种方法来添加`/usr/local/bin`到路径中，但我没有成功。我最终`gs`在`/usr/bin directory`. 现在一切正常。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-12-21T22:46:32.323

我在 Stackoverflow 上没有“声誉”来添加上面的内联评论，但我必须执行一个额外的步骤才能在我的 Mac 上使用最新的 Sierra 更新。

当你输入命令时：

```
sudo ln -s /usr/local/bin/gs /usr/bin/gs 
```

在 Mac 上，您可能会收到错误消息“不允许操作”。

显然，Apple 更改了“bin”目录不可编辑，除非您禁用 SIP（​​系统完整性保护）。

因此，以下是执行此操作的步骤：

1.  通过重新启动计算机并按住“Command + R”直到屏幕上出现 Apple 标志，将 Mac 重新启动到恢复模式。
2.  单击实用程序 > 终端
3.  在终端窗口中，输入`crutil disable`并按“Enter”
4.  重新启动您的 Mac。

我刚刚完成了这些步骤，现在我的 Ghostscript 运行良好，我成功地将 PDF 转换为 JPG。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2009-03-25T19:04:52.540

我成功地做到了这一点。这是我用来进行转换的代码。我们正在商业上使用这个解决方案。我知道这个问题已经存在了一段时间，但它仍然可以帮助你。

```
//Convert PDF contract to image using ImageMagik and Ghostscript
// NOTE: This will need to be change if running on Linux
$source = $appDir."\\".$clientID."\\".$clientID.".pdf";
$dest = $appDir."\\".$clientID."\\".$clientID.".jpg";
//print("c:\\IM\\convert.exe $source $dest ");
exec("c:\\IM\\convert.exe $source $dest "); 
```

# xml - 嵌套 xml 命名空间的做法是什么？

> ID：588919
> 
> 赞同：2
> 
> 时间：2009-02-26T02:54:33.690
> 
> 标签：xml, namespaces, xsd

在编程语言中，我习惯

```
namespace foo
{
    namespace bar
    {
        void DoIt()
        {
        }
    }
}

int main()
{
    foo::bar::DoIt()
} 
```

在模式（xsd）中，我想在定义 complexTypes 时做类似的事情

```
<xsd:schema targetNamespace="http://www.stackoverflow.com/foo">
 <xsd:complexType name="bar1">
    ...
 </xsd:complexType>
 <xsd:complexType name="bar2">
 </xsd:complexType>
   ...
 <xsd:complexType name="foo1" type = "bar1">
   ...
 </xsd:complexType>
</xsd:schema> 
```

从概念上讲，我希望 bar1 和 bar2 嵌套在[http://www.stackoverflow.com/foo::bar](http://www.stackoverflow.com/foo::bar)命名空间中（:: 从 C++ 借来的）。我已经看到了似乎是为 bar 东西定义的完全第二个命名空间的示例。在这些示例中，bar 的内容将在第二个命名空间“ [http://www.stackoverflow.com/foo/bar](http://www.stackoverflow.com/foo/bar) ”中定义，如下例所示。这是我见过的最接近“嵌套”命名空间的地方。

所以我可以做的一件事是从不同的模式导入酒吧的东西

```
<xsd:schema targetNamespace="http://www.stackoverflow.com/foo"
  xmlns:bar = "http://www.stackoverflow.com/foo/bar">
<xsd:schema namespace="http://www.stackoverflow.com/foo/bar"
 <xsd:complexType name="foo1">
   <xsd:element name="bar1Instance" type="bar:bar1"/>
   ...
 </xsd:complexType>
</xsd:schema> 
```

部分原因是我只是想了解 XML 与 C++ 中的命名空间有何不同。XML 中有嵌套命名空间的概念，还是每个命名空间独立？嵌套命名空间的概念是如何实现或通常完成的？是不是像我上面的例子一样？命名空间是完全独立的还是有创建嵌套关系的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-26T04:41:54.463

在 XML 中，每个命名空间都是完全独立的。命名空间的实际字符串没有以任何有意义的方式解析。就是这样。XML 命名空间字符串通常是 URL，因为这使得人们不会意外地为不相关的模式选择相同的命名空间。

如果您使用 Google 搜索，您会发现“嵌套 XML 名称空间”的示例。这些示例不是在谈论您要问的内容，而不是在 C++（或 Java 或 C#...）命名空间的意义上。这些示例显示了使用多个名称空间的 XML 文档。

XML 命名空间字符串只是表示模式的不透明且唯一的字符串。如果两个命名空间字符串碰巧非常相似，那没有任何意义。

# c++ - How to easily apply a function to a collection in C++

> ID：588920
> 
> 赞同：0
> 
> 时间：2009-02-26T02:54:51.070
> 
> 标签：c++, templates, mapreduce

I'm storing images as arrays, templated based on the type of their elements, like `Image<unsigned>` or `Image<float>`, etc. Frequently, I need to perform operations on these images; for example, I might need to add two images, or square an image (elementwise), and so on. All of the operations are elementwise. I'd like get as close as possible to writing things like:

```
float Add(float a, float b) { return a+b; }
Image<float> result = Add(img1, img2); 
```

and even better, things like

```
complex ComplexCombine(float a, float b) { return complex(a, b); }
Image<complex> result = ComplexCombine(img1, img2); 
```

or

```
struct FindMax {
    unsigned currentMax;
    FindMax(): currentMax(0) {}
    void operator(unsigned a) { if(a > currentMax) currentMax = a; }
};

FindMax findMax;
findMax(img);
findMax.currentMax;  // now contains the maximum value of 'img' 
```

Now, I obviously can't exactly do that; I've written something so that I can call:

```
Image<float> result = Apply(img1, img2, Add); 
```

but I can't seem to figure out a generic way for it to detect the return type of the function/function object passed, so my `ComplexCombine` example above is out; also, I have to write a new one for each number of arguments I'd like to pass (which seems inevitable).

Any thoughts on how to achieve this (with as little boilerplate code as possible)?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T03:05:47.533

This is why the unary_function, binary_function, etc. types in he STL have the result_type typedefs. If you use std::ptr_fun, you can take advantage of this with Apply,

e.g.

```
template<typename Func, typename Arg, typename Result = Func::result_type>
Image<Result> Apply(Arg a1, Arg a2, Func f) {
        return Image<Result>(f(a1,a2));
} 
```

And do,

```
Apply(img1, img2, std::ptr_fun(&Add)); 
```

* * *

Ok, you caught me, I didn't test it. It is still possible, but more work without being able to directly use some of the STL functionality

```
#include <iostream>

template<typename T>
struct Image {
  T val_;
  Image(const T& val) : val_(val) {}
};

template<typename Arg1, typename Arg2, typename Result>
struct image_fun_adapter {
  Result (*f)(Arg1, Arg2);
  Image<Result> operator()(const Image<Arg1>& a1, const Image<Arg2>& a2) {
    return Image<Result>(f(a1.val_, a2.val_));
  }
};

template<typename Arg1, typename Arg2, typename Result>
image_fun_adapter<Arg1,Arg2,Result> image_fun_ptr(Result (*f)(Arg1,Arg2)) {
  image_fun_adapter<Arg1,Arg2,Result> rv;
  rv.f = f;
  return rv;
}

float Add(float a, float b) { return a + b; }

int main() {
  Image<float> a(1.0);
  Image<float> b(12.5);
  // this is the cute bit:
  Image<float> c = image_fun_ptr(&Add)(a,b);

  std::cout << c.val_ << std::endl;
  return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T03:18:13.963

Template specialization!

```
template<typename T>
T Add(const T &left, const T &right)
{
    return left + right;
}

template<typename T>
struct AddTwo
{
    T operator()(const T &left, const T &right)
    {
        return Add(left, right);
    }
};

// something like this (not exactly sure)
template<std::vector<typename V>>
std::vector<V> Add(const std::vector<V> &left, const std::vector<V> &right)
{
    assert(left.size() == right.size());

    std::vector ret(left.size());

    std::transform(left.const_begin(), left.const_end(), right.const_begin(), ret.begin(), AddTwo());

    return ret;
} 
```

# h.264 - 关于 H264 中的系统数据速率

> ID：588924
> 
> 赞同：1
> 
> 时间：2009-02-26T02:56:52.733
> 
> 标签：h.264, bitrate

我有一个引擎来检查 H264 视频是否符合 AVCHD 或 BDMV 规范，SPEC 提到 MAX 系统数据速率高达 24 Mbit/s，我想知道如何计算系统数据速率？这是否意味着整个文件的平均值？或者这意味着1秒的平均值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T03:14:35.547

最大值指定您永远不会超过 24Mbps，因此您永远不会在任何 42nS（大约）周期内发送超过一位。您可以通过简单的乘法将其缩放到您想要的任何时间范围，直到您在一秒钟内永远不会超过 24M 位（并且在构成那一秒的任何 24M 42nS 周期中，您仍然永远不会发送超过一位）。

当您计算任何时间段的平均值时，它必须低于指定的最大突发，但仅被视为平均值。我们这些 CATV 行业的人花了很多时间试图让传输系统表现得好像平均速率是一个恒定速率，因为如果你有一定的视频吞吐量（以比特为单位），你不想浪费任何一个。我们对视频进行“评级”，并在接收信号的数字机顶盒中使用自适应缓冲。

美国宽带有线系统上的单个 QAM256 通道将支持 40Mbps，通常支持 10 到 12 个标准清晰度信号，平均比特率约为 4Mbps。当不可预知性质的画面发生大量变化时，这些频道将突增至 9Mbps。可以想象，一场拳击比赛（有很多移动）比从他们的办公桌上阅读的网络新闻主播占用更多的带宽，所以我们也尝试匹配频道来填充这个可用带宽。

通常，我们只能在同一个 40Mbps 频道中安装 3 个高清频道，这些频道的平均比特率约为 12.5Mbps，正如您在上面提到的，限制为 24Mbps。

希望这可以帮助！

# c# - 从 TIF 文件中读取位图 - 适用于 WinForms 而不是 ASP.NET

> ID：588925
> 
> 赞同：0
> 
> 时间：2009-02-26T02:57:57.943
> 
> 标签：c#, asp.net, image

**找到编辑** *解决方案*：请参阅下面的帖子。

我们正在编写一个从扫描仪读取 TIF 文件的库。基本上，它是一个扫描仪。我们正在检查表单并从中读取值。

目前我们有一个 Windows 测试应用程序，我们给它一个文件路径作为字符串（“c:\testing\image.tif”）。它加载 tif，正确读取文档并解析值。

我们还有一个 ASP.NET Web 应用程序。我们有一个测试页面，它与 windows 应用程序完全一样，我们给它一个相同的字符串，我在同一个库的同一个类上调用同一个函数。但是，它不能正确读取表格。我们已经验证它确实加载了 tif 文件，并且实际上填充了数据（当我们在 Visual Studio 的即时窗口中检查 Bitmap 对象时，我们期望为白色/黑色的像素是白色/黑色）。

具体问题出在一个名为**DataMatrix**的库中，我们使用它来扫描文档上的条形码。这个函数应该返回`List<string>,`一个条形码，每个条形码都是图书馆在文档上找到的。在 Windows 应用程序中，此函数 (DataMatrixDecoder.DecodeBarcode(bitmap)) 正确返回 Count=1。使用 asp.net 应用程序时，返回 Count=0。

因为它是完全相同的图像文件，我无法想象问题出在 DataMatrix 中。我只能假设它与 ASP.NET 或其他东西有关。

这甚至不是我的项目，但我和另一个人正在帮助我们的同事解决这个问题，我们只是把头发拉出来。所有迹象都表明 ASP.NET 正在正确加载图像并将其从磁盘传递给“处理器”类（这是一个使用 DataMatrix 东西的类库，除了打开/处理文件到函数。）。

有没有人对它可能是什么有任何想法，或者我们可以检查不同的东西？

我什至不确定要提供什么样的信息，所以我试图把它全部说出来，如果你有任何问题，请问我很乐意详细说明任何事情。谢谢。

编辑：这是 ascx.cs 代码隐藏中的代码，在按钮单击事件中：

```
if (formReader.ReadTIFF(@"c:\testing\image.tif"))
{
    messages.Controls.Add(HtmlHelper.DivSuccess("Read successful."));
} 
```

然后`formReader`该类使用 . 打开文件`FileStream`，并使用它来创建`Bitmap`. ASP.NET 应用程序实际上并没有打开文件（我们通过`FormUpload`控件上传文件，但在遇到问题后我们将其归结为这一点）。这是最令人困惑的事情，它可以在 Windows 应用程序中运行，但不能来自该网站。ASP.NET 对该文件夹拥有完全权限，可以做任何想做的事情。它可以很好地打开图像，它从 FileStream 创建的位图是实际图像。

编辑：此外，ReadTIFF 函数现在将 FileStream 复制到 MemoryStream 中，确保从磁盘流式传输没有问题（整个文件都在内存中）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T04:24:14.863

您如何将文件路径传递给 Web 应用程序？
解码的函数可能会吞下一些异常。

使用反射器检查库（如果您还没有编写它）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T06:16:53.267

我同意。看来您的问题很可能与您尝试从中访问文件的目录上的用户权限有关。尝试为您的 Web 用户授予对源目录的完全访问权限。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T17:40:47.990

**发现编辑** *解决方案*：问题是打开的文件对话框正在更改 CurrentWorkingDirectory。该网站从未运行过的原因是因为`Environment.CurrentDirectory`设置不正确。当我手动将 CurrentDirectory 设置为网站的`bin`文件夹时，解析工作正常。

* * *

小更新。使用 Windows 应用程序，并通过 选择文件`OpenFileDialog`，将导致条码解码器失败。从技术上讲，我使用*完全相同的*字符串传递给解析器（“c:\testing\image.tif”），但是当我使用`OpenFileDialog`来获取字符串时，解码器失败了。这有什么线索吗？

更新：事实上，即使我不使用`OpenFileDialog`给我的字符串，如果我只是打开文件对话框*，*它也会失败。我不明白这个。这很简单。我真的需要调试 C++ DataMatrix 库。

# asp.net-mvc - 为什么 HtmlHelper 需要这个 HtmlHelper 助手的参数？

> ID：588933
> 
> 赞同：4
> 
> 时间：2009-02-26T03:03:47.193
> 
> 标签：asp.net-mvc

为什么需要用 HtmlHelper 助手的参数声明 HtmlHelper？

IE

```
public static string ScheduleEntries(this HtmlHelper helper, ...) 
```

我以前从未在 C# 中注意到这种语法，它叫什么？

谢谢

-马特

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-26T03:05:12.387

那是一种[扩展方法](http://msdn.microsoft.com/en-us/library/bb383977.aspx)。

它适用于 MVC 的方式是`Html`在视图中是 ViewPage 类上的 HtmlHelper 类型的属性。

# ruby - 使用 Ruby 企业版，gem 没有安装在我期望的位置

> ID：588934
> 
> 赞同：2
> 
> 时间：2009-02-26T03:04:10.627
> 
> 标签：ruby, rubygems, ruby-enterprise-edition

我刚刚安装了 Ruby Enterprise Edition 并正在为它安装一些 gem。Stock Ruby 1.8.6 也安装在服务器上。

我已经`/opt/ruby-enterprise-1.8.6-20090201/bin`在我`PATH`的头上添加了`/usr/bin`哪里`ruby`和`gem`住的地方。

`which gem`证实了这一点：

`/opt/ruby-enterprise-1.8.6-20090201/bin/gem`

但是，当我像这样安装 gem 时：

`gem install some_gem`

他们最终在`/usr/lib/ruby/gems/1.8/gems/`而不是`/opt/ruby-enterprise-1.8.6-20090201/lib/ruby/gems/1.8/gems/`.

但如果我使用`/opt/ruby-enterprise-1.8.6-20090201/bin/gem install some_gem`它*确实*会进入 REE 的 gem 目录。

我不明白。我必须更改一些配置选项吗？我*在*这里使用 sudo。也许这与它有关？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-26T04:46:47.277

这里有一个很好的解释：

[sudo 更改 PATH - 为什么？](https://stackoverflow.com/questions/257616/sudo-changes-path-why)

这假设您使用的是 Ubuntu。sudo 确实改变了 ubuntu 下的路径。

/usr/bin/ 中的 gem 可能是 /usr/bin/gem1.8 的符号链接。我所做的是将 ruby​​-enterprise 的 gem 符号链接到 /usr/bin/ree-gem，如下所示：

sudo ln -s /opt/ruby-enterprise-1.8.6-20090201/bin/gem /usr/bin/ree-gem

然后我只使用：

须藤 ree-gem 安装 some_gem

专门为 ree 安装 gem。如果您不使用 ruby​​ 1.8.6 ruby​​gem，则可以将 REE 的 gem 符号链接到 /usr/bin/gem：

sudo ln -s /opt/ruby-enterprise-1.8.6-20090201/bin/gem /usr/bin/gem

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T04:43:29.373

我用来解决类似问题的一个解决方案是为您的 REE gem 命令设置别名。

IE

```
alias reegem='/opt/ruby-enterprise-1.8.6-20090201/bin/gem' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-18T17:39:50.023

我在这里发布了我在 Ubuntu 上使用的解决方案： [http ://groups.google.com/group/emm-ruby/browse_thread/thread/d0c685bbd096823a#msg_effa7d6ad42c541c](http://groups.google.com/group/emm-ruby/browse_thread/thread/d0c685bbd096823a#msg_effa7d6ad42c541c)

除了 Ruby 企业版文档中描述的内容之外，还有一些额外的步骤可以让它工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-11T06:40:51.320

以下是对 REE 为何如此设置的解释： [http ://www.rubyenterpriseedition.com/documentation.html#_how_ree_installs_itself_into_the_system](http://www.rubyenterpriseedition.com/documentation.html#_how_ree_installs_itself_into_the_system)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-17T19:25:36.767

除了上面 Jack Chu 的有用符号链接，我可以建议：

sudo ln -s /opt/ruby-enterprise/bin/rake /usr/bin/ree-rake

所以你可以 sudo ree-rake gems:install

# wpf - 如何让 WPF 绑定发生在尚未显示的控件上？

> ID：588938
> 
> 赞同：0
> 
> 时间：2009-02-26T03:05:48.767
> 
> 标签：wpf, data-binding

我有一个自定义文本框控件，它会在其 TEXT 属性更改时引发路由事件。此文本属性是绑定到我们的视图模型对象上的属性的数据。

当我将此控件放在 TabControl 页面或 Expander 控件上时，似乎数据绑定仅在控件第一次可见时发生，因此在我切换到控件所在的选项卡之前，我从未收到任何路由事件或展开扩展器。

有什么方法可以在控件显示之前强制进行数据绑定？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T03:13:38.217

不太可能。WPF 是一个相当有效的框架，它不会做任何不必要的工作。这包括数据绑定等场景。为什么要为可能永远不会显示的控件执行集合？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T04:35:17.210

听起来您依靠数据绑定来生成路由事件是错误的方法。相反，您需要让您的模型或视图模型在文本被修改时生成一个事件，然后您从视图中的适当位置观看此事件。

# javascript - What is the Best way to do Browser Detection in Javascript?

> ID：588940
> 
> 赞同：4
> 
> 时间：2009-02-26T03:06:15.253
> 
> 标签：javascript, cross-browser, browser-detection

In one of my Web Development classes we where asked to create a script that detects NE4,NE6+,IE4,IE6+ Browsers that display a compatable CSS script for each browser.

he gave us an article to read about these and the article mentioned [this site](https://developer.mozilla.org/En/Browser_Detection_and_Cross_Browser_Support)

one of the students said this

> The best choice for javascript compatibility is to test for browser capabilities when you want to do something. One of the main reasons for this is that in the future, more and more browsers will be created.

Now my questions is this which way is the best way to detect the users browser object detection or using the Navigator Object?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-26T03:12:07.720

The standard way to detect what browser is used is to check the user agent supplied.

```
var BrowserDetect = {
    init: function () {
        this.browser = this.searchString(this.dataBrowser) || "An unknown browser";
        this.version = this.searchVersion(navigator.userAgent)
            || this.searchVersion(navigator.appVersion)
            || "an unknown version";
        this.OS = this.searchString(this.dataOS) || "an unknown OS";
    },
    searchString: function (data) {
        for (var i=0;i<data.length;i++) {
            var dataString = data[i].string;
            var dataProp = data[i].prop;
            this.versionSearchString = data[i].versionSearch || data[i].identity;
            if (dataString) {
                if (dataString.indexOf(data[i].subString) != -1)
                    return data[i].identity;
            }
            else if (dataProp)
                return data[i].identity;
        }
    },
    searchVersion: function (dataString) {
        var index = dataString.indexOf(this.versionSearchString);
        if (index == -1) return;
        return parseFloat(dataString.substring(index+this.versionSearchString.length+1));
    },
    dataBrowser: [
        {
            string: navigator.userAgent,
            subString: "Chrome",
            identity: "Chrome"
        },
        {   string: navigator.userAgent,
            subString: "OmniWeb",
            versionSearch: "OmniWeb/",
            identity: "OmniWeb"
        },
        {
            string: navigator.vendor,
            subString: "Apple",
            identity: "Safari",
            versionSearch: "Version"
        },
        {
            prop: window.opera,
            identity: "Opera"
        },
        {
            string: navigator.vendor,
            subString: "iCab",
            identity: "iCab"
        },
        {
            string: navigator.vendor,
            subString: "KDE",
            identity: "Konqueror"
        },
        {
            string: navigator.userAgent,
            subString: "Firefox",
            identity: "Firefox"
        },
        {
            string: navigator.vendor,
            subString: "Camino",
            identity: "Camino"
        },
        {       // for newer Netscapes (6+)
            string: navigator.userAgent,
            subString: "Netscape",
            identity: "Netscape"
        },
        {
            string: navigator.userAgent,
            subString: "MSIE",
            identity: "Explorer",
            versionSearch: "MSIE"
        },
        {
            string: navigator.userAgent,
            subString: "Gecko",
            identity: "Mozilla",
            versionSearch: "rv"
        },
        {       // for older Netscapes (4-)
            string: navigator.userAgent,
            subString: "Mozilla",
            identity: "Netscape",
            versionSearch: "Mozilla"
        }
    ],
    dataOS : [
        {
            string: navigator.platform,
            subString: "Win",
            identity: "Windows"
        },
        {
            string: navigator.platform,
            subString: "Mac",
            identity: "Mac"
        },
        {
               string: navigator.userAgent,
               subString: "iPhone",
               identity: "iPhone/iPod"
        },
        {
            string: navigator.platform,
            subString: "Linux",
            identity: "Linux"
        }
    ]

};
BrowserDetect.init(); 
```

[http://www.quirksmode.org/js/detect.html](http://www.quirksmode.org/js/detect.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-26T11:02:27.043

> 在我的一个 Web 开发课程中，我们要求创建一个检测 NE4、NE6+、IE4、IE6+ 的脚本

你的 Web 开发课程已经过时了，可笑可笑。

在 Netscape4 和 IE4 是通用浏览器的时代，通常需要嗅探浏览器类型并为它们提供不同的样式表和脚本，因为它们对样式和 DHTML 特性的支持非常不同。

这些天来，您必须担心的最低质量浏览器的基准浏览器是 IE6。几乎没有人使用比这更低的任何东西，因为 IE6 是随 XP 一起提供的，而使用未升级的 Win2K 和 Win9X 机器的机会微乎其微。当然，世界上没有人在使用 IE4 或糟糕的 Netscape 4。目前很少有网站可以使用它们。

由于 Web 标准，您可能想要定位的所有其他浏览器（IE7+、Firefox2+、Opera、Safari、Chrome、Konqueror）通常都足够接近互兼容性，您几乎不需要做太多的浏览器检测。IE6 确实需要一些注意，但通常如果您使用标准模式，您可以通过一些 CSS hack（特别是“* html”）和脚本中的一些功能嗅探来解决问题，而不必为其提供完全不同的内容。

> 现在我的问题是，哪种方式是检测用户浏览器对象检测或使用导航器对象的最佳方式？

对象/方法检测。

尽可能避免使用导航器对象；它通常出于兼容性目的而存在，并且扫描字符串以尝试找出浏览器名称很容易被用户代理字符串中的意外标记绊倒。

如果您需要专门检测 IE6（这是迄今为止最常见的需要检测和添加解决方法的浏览器），并且没有合适的能力嗅探方式，则最好使用[条件编译](http://msdn.microsoft.com/en-us/library/121hztk3(VS.85).aspx)而不是 navigator.userAgent 处理。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-26T03:10:14.683

The best way is to avoid using browser dependent code as much as possible, but where absolutely necessary, use code that has been proven correct written by people who know a lot more than you and I. I would suggest JQuery, as that's my library of choice, but there are plenty of others out there (YUI is popular, as is Scriptilicious, etc). Google JQuery to get started. Also, google 'John Resig at Google' to see if you can find a talk he did where he discusses some of the techniques he uses to detect browser capabilities. It's very clever, as it adapts as browsers fix their legacy issues.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-26T03:12:40.077

tho deprecated in 1.3.2 [jQuery.browser()](http://docs.jquery.com/Utilities/jQuery.browser) will return useful info ... also see [jQuery.support()](http://docs.jquery.com/Utilities/jQuery.support)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-26T03:11:09.690

The **best** way is to not detect it, but to use a cross-browser-compatible library like jQuery. This also has a lot of other advantages in terms of expressiveness.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-26T03:25:19.547

Honestly, if you're trying to detect the browser you're attacking the wrong problem. My advice would be to detect the features that you want to use and degrade based on that. For example, if you need to create an XMLHttpRequest something similar to the following will work:

```
 var xhr = null;
   if (typeof(XMLHttpRequest) !== 'undefined')
      xhr = new XMLHttpRequest(...);
   else if (typeof(ActiveXObject) !== 'undefined')
      xhr = new ActiveXObject('Microsoft.XMLHTTP');

   if (xhr != null)
      ...do something with it
   else
      throw "No XMLHttpRequest"; 
```

This approach allows your applications to grow as the browsers start to support more features. Obviously, it goes without saying that these sorts of checks should be abstracted away in a function somewhere so as not to litter your code with the same checks over and over again.

However, if you're able to use an Ajax library like JQuery, Prototype, Dojo, YUI, etc that's probably your best bet as they already have the abstractions built in.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-09-03T03:24:11.897

我构建了一个简单的 Firefox Mac User Agent Detect 来编写特定的 CSS。 [http://www.combsconsulting.com/code-firefox-mac-hack.html](http://www.combsconsulting.com/code-firefox-mac-hack.html)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-01-13T13:11:08.550

您需要使用 Conditionizr，它为此提供了强大的测试/检测插件：[http ://conditionizr.com](http://conditionizr.com)

例如：

```
conditionizr.add('safari', [], function () {
    return /constructor/i.test(window.HTMLElement);
}); 
```

# java - Adobe flex 与 Java 通信的最佳方式是什么？

> ID：588943
> 
> 赞同：4
> 
> 时间：2009-02-26T03:10:00.860
> 
> 标签：java, apache-flex, blazeds

我目前正在为学校开发一个项目，该项目将是一个 web 应用程序，其中 gui 将在 Adob​​e Flex 中编程，后端将在 java 中编程，可能作为在 Tomcat 中运行的 servlet ...

我主要从事后端工作，我小组中的另一个人负责 Flex 的工作。

他确信，要与 Java 代码进行通信，他需要跳过各种障碍。我的印象是您可能只查询 servlet 并将响应呈现到应用程序中？

我还没有真正找到关于 Flex 的任何好的文档（看起来也没有那么难），我只是想知道这是否像他所说的那样令人生畏。

任何资源/评论将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-26T03:13:00.450

Blaze 数据服务是要走的路。您在 web.xml 中注册了一个“MessageBroker”servlet，它充当其他服务的前端控制器。

[http://opensource.adobe.com/wiki/display/blazeds/BlazeDS/](http://opensource.adobe.com/wiki/display/blazeds/BlazeDS/)

[http://livedocs.adobe.com/blazeds/1/blazeds_devguide/](http://livedocs.adobe.com/blazeds/1/blazeds_devguide/)

[http://livedocs.adobe.com/blazeds/1/javadoc/](http://livedocs.adobe.com/blazeds/1/javadoc/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T03:21:30.133

正如悬崖.meyers 所说，BlazeDS 绝对是您想要的 Java 后端。它与 Flex 很好地集成在一起。

就 Flex 文档而言，Adobe 有[大量免费的在线视频教程](http://www.adobe.com/devnet/flex/videotraining/)，[官方的 Flex 语言参考](http://livedocs.adobe.com/flex/3/langref/index.html)也会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T03:31:19.937

还有一个交钥匙发行版，其中包含一个示例 war 文件，您可以将其部署到 Web 服务器以了解 Blaze 的某些功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-11T23:14:33.260

您可以使用[Red5](http://www.red5.org/)，它是 Adob​​e 的 FMS 的 100% Java 替代品。

# debugging - How do I debug an exe running through Windows Scheduler?

> ID：588946
> 
> 赞同：3
> 
> 时间：2009-02-26T03:11:14.510
> 
> 标签：debugging, windows-task-scheduler

I'm using Windows Scheduler to run an exe I have written.

How can I jump into a debug session when the scheduler starts my exe?

**Update 1.** I had thought of doing a Thread.Sleep and then Attach to Process. When I tried it, it says Debugger is already attached to process...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-26T03:17:42.137

You could just call **DebugBreak()** from within your program.

According to the [MSDN page](http://msdn.microsoft.com/en-us/library/ms679297(VS.85).aspx), DebugBreak does the following:

> Causes a breakpoint exception to occur in the current process. This allows the calling thread to signal the debugger to handle the exception.
> 
> To cause a breakpoint exception in another process, use the DebugBreakProcess function.

You can then attach your debugger at this point, and continue running the program.

The only problem with this solution is that you need to make the DebugBreak() in the code conditional, so that it won't break *every* time the program is run. Maybe you achieve this through an environment variable, registry setting, or a parameter which the scheduler passes in to the program to ensure that it breaks when it starts up.

### Example code

Here's some untested example code reading an environment variable:

```
int main()
{
    char *debugBreakChar = getenv("DEBUG_BREAK");
    int debugBreak = atoi(debugBreakChar);
    if (debugBreak)
    {
        DebugBreak();
    }

    // Rest of the program follows here
} 
```

Now all you need to do is set the environment variable as a system variable, and ensure that it's accessible from the same shell context as the scheduler (rebooting will achieve this):

```
set DEBUG_BREAK=1 
```

Now the program will break on startup, allowing you to attach a debugger. Changing the environment variable to 0, or un-setting it, will allow the program to run normally.

Environment variables are a bit fiddly in this regard, as they are context-based and you need to know that the scheduler runs from the same environmental context. Registry values are better than this, and you can read a registry value using [RegQueryValueEx](http://msdn.microsoft.com/en-us/library/ms724911(VS.85).aspx) in your code instead (you'll need to include windows.h to use this function).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T03:17:28.440

Attach to Process will work (from within Visual Studio), although you may need to add a sleep statement at the beginning of your code if it is a fast process so that you can attach before it starts your main logic.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T03:55:54.433

您可以在其下设置一个键，该键`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options`将在启动进程时将调试器附加到进程。[您可以在此知识库文章](http://support.microsoft.com/default.aspx?kbid=238788)中阅读如何执行此操作。

这种方法有几个问题：

*   [IFEO 调试不适用于纯托管调试](http://blogs.msdn.com/jmstall/archive/2006/02/16/ifeo_managed_debugging.aspx)。您需要使用[互操作调试](http://blogs.msdn.com/jmstall/archive/2005/01/28/362169.aspx)
*   您可能需要将调试器远程连接到另一个会话，具体取决于调度程序以哪个用户身份启动您的应用程序。

要使用 VS 进行调试，您需要在可执行文件的 IFEO 选项中实际指定**VSJitDebugger.exe**。您还必须指定要手动使用的调试引擎。[更多细节在这里](http://blogs.msdn.com/greggm/archive/2005/02/21/377663.aspx)。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-02-26T03:14:20.447

"Attach to Process" in Visual Studio's Debug menu.

# python - Stackless Python 的缺点是什么？

> ID：588958
> 
> 赞同：133
> 
> 时间：2009-02-26T03:17:18.300
> 
> 标签：python, python-stackless

我最近一直在阅读有关[Stackless Python](http://www.stackless.com/)的内容，与普通 cPython 相比，它似乎有很多优势。它具有无限递归、微线程、延续等所有很酷的特性，同时比 cPython 快（大约 10%，如果相信[Python wiki的话）](http://www.python.org/dev/implementations/)*并且*与它兼容（至少版本2.5、2.6和 3.0)。

所有这些看起来都好得令人难以置信。然而，[在 TANSTAAFL](http://en.wikipedia.org/wiki/TANSTAAFL)中，我没有看到 Python 社区对 Stackless 有太多热情，而且[PEP 219](http://www.python.org/dev/peps/pep-0219/)从未实现过。这是为什么？Stackless 的缺点是什么？Stackless 的衣橱里藏着什么骷髅？

（我知道 Stackless 不提供真正的并发，只是一种更简单的并发编程方式。它并没有真正困扰我。）

* * *

## 回答 #1

> 赞同：170
> 
> 时间：2009-02-26T12:47:49.740

我不知道 Wiki 上的“Stackless 快 10%”是从哪里来的，但话说回来，我从未尝试过衡量这些性能数字。我想不出 Stackless 做了什么来产生如此大的影响。

Stackless 是一个了不起的工具，它有几个组织/政治问题。

第一个来自历史。大约 10 年前，Christian Tismer 开始谈论最终成为 Stackless 的东西。他知道自己想要什么，但很难解释他在做什么以及为什么人们应该使用它。这部分是因为他的背景没有接受过关于协程等想法的 CS 培训，并且因为他的演示和讨论非常面向实现，这对于没有深入了解后续的人来说很难理解如何使用它作为解决方案他们的问题。

因此，最初的文档很差。有一些关于如何使用它的描述，其中最好的来自第三方贡献者。根据 PyCon 的调查数据，在 PyCon 2007 上，我发表了关于“[使用 Stackless ”的演讲，结果非常好。](http://dalkescientific.com/StacklessPyCon2007-Dalke.pdf)[Richard Tew 在收集这些、更新stackless.com](http://stackless.com)以及在新的 Python 版本出现时维护分发方面做得很好。[他是CCP Games](http://ccpgames.com/)的员工，EVE Online 的开发人员，该公司使用 Stackless 作为其游戏系统的重要组成部分。

CCP 游戏也是人们谈论 Stackless 时使用的最大的现实示例。Stackless 的主要教程是 Grant Olson 的《[Introduction to Concurrent Programming with Stackless Python](http://www.grant-olson.net/files/why_stackless.html)》，也是面向游戏的。我认为这给人们一种歪曲的想法，即 Stackless 是面向游戏的，而游戏更容易面向延续。

另一个困难是源代码。在最初的形式中，它需要对 Python 的许多部分进行更改，这让 Python 负责人 Guido van Rossum 保持警惕。我认为部分原因是对 call/cc 的支持后来被删除，因为“当有更好的高级表单时，它太像支持 goto”。我不确定这段历史，所以把这一段读作“Stackless 过去需要太多改变”。

后来的版本不需要更改，Tismer 继续推动将其包含在 Python 中。虽然有一些考虑，但官方立场（据我所知）是 CPython 不仅是 Python 实现，而且它是作为参考实现，它不包含 Stackless 功能，因为它不能由 Jython 实现或铁蟒。

绝对没有“*对代码库进行重大更改*”的计划。来自 Arafangion 的引用和参考超链接（见评论）大约来自 2000/2001。结构上的变化早就做了，就是我上面说的。现在的 Stackless 是稳定和成熟的，在过去几年中只对代码库进行了细微的调整。

Stackless 的最后一个限制 - Stackless 没有强烈的拥护者。Tismer 现在深入参与了[PyPy](http://pypy.org/)，它是 Python 的 Python 实现。他在 PyPy 中实现了 Stackless 功能，认为它比 Stackless 本身优越得多，并认为 PyPy 是未来的方向。Tew 维护着 Stackless，但他对宣传不感兴趣。我考虑过担任那个角色，但不知道如何从中获得收入。

如果您想在 Stackless 中进行培训，请随时[与我联系](http://mailto:dalke@dalkescientific.com)！:)

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2012-03-20T17:44:47.673

找到这个讨论花了很长时间。那时我不在 PyPy 上，但与 psyco 有 2 年的恋情，直到健康突然停止了这一切。我现在再次活跃并设计一种替代方法 - 将在 EuroPython 2012 上展示它。

大多数安德鲁斯的陈述是正确的。一些小的补充：

10 年前，Stackless 比 CPython 快得多，因为我优化了解释器循环。那时，圭多还没有为此做好准备。几年后，人们做了类似的优化，甚至更多更好的优化，这使得 Stackless 有点慢，正如预期的那样。

关于包容性：嗯，一开始我非常咄咄逼人，并坚信 Stackless 是要走的路。后来，当几乎有可能被纳入时，我对此失去了兴趣，宁愿让它保持这种状态，部分是出于沮丧，部分是为了保持对 Stackless 的控制。

像“其他实现无法做到”这样的论点对我来说总是很蹩脚，因为还有其他例子也可以使用这个论点。我想我最好忘记这一点，并与 Guido 保持良好的友谊，拥有自己的发行版。

与此同时，情况再次发生变化。我正在开发 PyPy 和 Stackless 作为扩展 有时稍后会谈到

干杯——克里斯

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-26T03:52:17.717

如果我没记错的话，Stackless 计划包含在官方 CPython 中，但是 stackless 的作者告诉 CPython 的人不要这样做，因为他计划对代码库进行一些重大更改——大概他希望稍后完成集成该项目更加成熟。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-26T03:47:02.707

我也对这里的答案感兴趣。我用 Stackless 玩了一点，看起来它会是标准 Python 的一个很好的可靠补充。

如果 Python 想要更改为不同的堆栈，PEP 219 确实提到了从 C 代码调用 Python 代码的潜在困难。需要有方法来检测和防止这种情况（以避免破坏 C 堆栈）。我认为这很容易处理，所以我也想知道为什么 Stackless 必须独立存在。

# asp.net - 包含非 ascii 国际语言字符的文件名

> ID：588967
> 
> 赞同：3
> 
> 时间：2009-02-26T03:21:11.770
> 
> 标签：asp.net, unicode, localization, internationalization, filenames

**有没有人有过生成文件名包含非 ascii 国际语言字符的文件的经验？**

**这样做是一件容易的事，还是充满危险？**

**日语/中文网络用户是否需要此功能？**

**文件扩展名也应该是国际语言字符吗？**

*信息：*我们目前在我们的网站上支持多语言，但我们的文件名始终是 ASCII。我们在 .NET 框架上使用 ASP.NET。这将用于国际用户可以为那里的文件选择通用格式和名称的情况。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-26T11:29:56.447

> 日语/中文网络用户是否需要此功能？

是的。

> 这样做是一件容易的事，还是充满危险？

有问题。如果您直接提供文件，或者在 URL 中包含文件名（例如：http://​www.example.com/files/こんにちは.txt -> http://​www.example.com/files/ %E3%81%93%E3%82%93%E3%81%AB%E3%81%A1%E3%81%AF.txt），你一般没问题。

但是，如果您使用脚本生成的文件名提供文件，则可能会遇到问题。问题在于标题：

```
Content-Disposition: attachment;filename="こんにちは.txt" 
```

我们如何将这些字符编码到文件名参数中？好吧，如果我们可以将其转储为 UTF-8，那就太好了。这将适用于某些浏览器。但不是 IE，它使用系统代码页从 HTTP 标头中解码字符。在 Windows 上，对于西方用户，系统代码页可能是 cp1252 (Latin-1)，对于日语用户可能是 cp932 (Shift-JIS)，或者其他完全不同的东西，但它永远不会是 UTF-8，你无法真正猜出它是什么将在发送标头之前。

乏味的一边：标准说应该发生什么？嗯，它不是真的。HTTP 标准 RFC2616 规定 HTTP 标头中的字节是 ISO-8859-1，这不允许我们使用日语。它继续说，非拉丁 1 字符可以通过 RFC2047 的规则嵌入到标头中，但 RFC2047 明确否认其编码词可以放入带引号的字符串中。通常在 RFC822 系列标头中，您将使用 RFC2231 规则将 Unicode 字符嵌入 Content-Disposition (RFC2183) 标头的参数中，并且 RFC2616 确实遵循 RFC2183 来定义该标头。但 HTTP 实际上并不是 RFC822 系列协议，而且它的标头语法与 822 系列也不完全兼容。总之，标准是一团糟，没有人知道该怎么做，当然不是那些根本不关注它的浏览器制造商。见鬼，他们甚至不能正确地得到 'filename="..."' 的 'quoted-string' 格式，更不用说字符编码了。

因此，如果您想动态地提供名称中包含非 ASCII 字符的文件，诀窍是避免发送“文件名”参数，而是将您想要的文件名转储到 URL 的尾部。

> 文件扩展名也应该是国际语言字符吗？

原则上是的，文件扩展名只是文件名的一部分，可以包含任何字符。

在 Windows 上的实践中，我知道没有使用过非 ASCII 文件扩展名的应用程序。

在东亚用户的系统上要注意的最后一件事是：你会发现他们有时会输入奇怪的非 ASCII 版本的拉丁字符。这些被称为全角和半角形式，旨在允许亚洲人键入与其表意（汉等）字符使用的方格对齐的拉丁字符。

在自由文本中这一切都很好，但是对于您希望解析为拉丁文本或数字的字段，接收到意外的“４２”整数或“.tｘt”文件扩展名可能会让您大吃一惊。要将这些“兼容字符”转换为纯拉丁文，请在对它们进行任何操作之前将您的字符串规范化为“Unicode 范式 NFKC”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T03:35:04.157

请参阅Wikipedia 上[的文件名限制概述。](http://en.wikipedia.org/wiki/File_name#Comparison_of_file_name_limitations)

您将不得不考虑您的文件将传输到哪里，并遵守最严格的规则集。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T03:46:38.230

根据我在日本的经验，文件名通常以日文保存，并带有标准的英文扩展名。将同样的方法应用于任何其他语言。

您将遇到的唯一问题是，在该字符集不受支持的环境中，人们通常只会看到一大堆带有扩展名的方块。显然，这对您的目标用户来说不是问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T03:28:57.027

一段时间以来，我一直在使用 Unicode 和印度语言。以下是我对您的问题的看法：

这简单。您将需要两件事： 在您的操作系统中启用 Unicode (UTF-8/16/32) 支持，以便您可以*键入*这些字符并获得与 Unicode 兼容的编辑器/工具，以便您的工具能够理解这些字符。

此外，由于您正在查看本地化的 Web 应用程序，因此您必须确保或至少通知您的访问者他/她需要一个使用相关编码的浏览器。

您的文件扩展名*不需要*是 i18-ned。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-03-18T13:05:18.943

我的两分钱：

1.  国际文件名的关键是使 URL 像**bobince**建议的那样：www.example.com/files/%E3%81%93%E3%82%93%E3.txt

2.  我必须为 IE7 制定特殊的例程，因为如果文件名超过 30 个字符，它会裁剪文件名。因此，文件将显示为“%d4y long file name.txt”，而不是“Your very long file name.txt”。然而有趣的是 IE7 实际上理解 header attachment;filename=%E3%81%93%E3%82%93%E3.txt 正确。

# math - 数学方程可能无限循环？

> ID：588973
> 
> 赞同：2
> 
> 时间：2009-02-26T03:25:27.737
> 
> 标签：math, simulation, montecarlo

我有以下问题，并且无法理解等式的一部分：

估计积分的蒙特卡罗方法基本上是，取大量随机样本并确定加权平均值。例如，f(x) 的积分可以从 N 个独立的随机样本 x [r]估计为

[替代文字 http://www.govtam.com/images/area.gif](http://www.goftam.com/images/area.gif)

对于 xr 在 [x1, x2] 范围内的均匀概率分布。由于每个函数评估 f(xr) 都是独立的，因此很容易将这项工作分配给一组进程。

我不明白 f(x [r] ) 应该做什么？它是否反馈到相同的方程中？那不是无限循环吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-26T03:29:19.113

它应该说 f(x [i] )

f() 是我们试图通过数值蒙特卡罗方法进行积分的函数，该方法通过评估从积分区域中随机选择的点来估计积分（及其误差）。

[参考](http://en.wikipedia.org/wiki/Monte_Carlo_integration)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-26T03:32:44.443

您的目标是计算`f`from`x1`到的积分`x2`。例如，您可能希望计算`sin(x)`from`0`到的积分`pi`。

使用蒙特卡洛积分，您可以通过在区间内随机采样点并在这些点处`[x1,x2]`进行评估来近似这一点。`f`也许你想称之为`MonteCarloIntegrate( f, x1, x2 )`.

所以不，`MonteCarloIntegrate`不会“反馈”到自身。它调用一个函数`f`，即您尝试进行数值积分的函数，例如`sin`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T03:40:12.880

替换`f(x_r)`为（阅读： f 在sub sub`f(x_r_i)`评估）。是从区间 中随机均匀选择的。`x``r``i``r_i``[x_1, x_2]`

关键是： on 下的面积`f`等于`[x_1, x_2]`区间on`(x_2 - x_1)`的平均值的倍数。那是`f``[x_1, x_2]`

```
A = (x_2 - x_1) * [(1 / (x_2 - x_1)) * int_{x_1}^{x_2} f(x)\, dx] 
```

方括号中的部分是`f`我们`[x_1, x_2]`将表示的平均值`avg(f)`。我们如何估计 的平均值`f`？通过在随机点对其进行采样并在这些随机点取评估`N`的平均值。`f`以机智：

```
avg(f) ~ (1 / N) * sum_{i=1}^{N} f(x_r_i) 
```

其中`x_r_1, x_r_2, ..., x_r_N`是从 [x_1, x_2] 中均匀随机选择的点。

然后

```
A = (x_2 - x_1) * avg(f) ~ (x_2 - x_1) * (1 / N) * sum_{i=1}^{N} f(x_r_i). 
```

这是考虑这个等式的另一种方法：`f`区间`[x_1, x_2]`上的面积与长度`(x_2 - x_1)`和高度等于 的平均高度的矩形的面积相同`f`。的平均高度`f`约为

```
(1 / N) * sum_{i=1}^{N} f(x_r_i) 
```

这是我们之前产生的价值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T03:43:49.330

是 x [i]还是 x [r]无关紧要——这是我们输入函数 f() 的随机数。

我更有可能编写如下函数（除了格式化）：

(x [2] -x [1] ) * 和(f(x [i] ))/N

这样，我们可以看到我们取 f(x) 的 N 个样本的平均值来获得函数的平均高度，然后乘以宽度 (x2-x1)。

因为，毕竟，积分只是计算曲线下的面积。（漂亮的图片在[http://hyperphysics.phy-astr.gsu.edu/Hbase/integ.html#c4](http://hyperphysics.phy-astr.gsu.edu/Hbase/integ.html#c4)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T03:44:26.350

x_r 是来自积分范围的随机值。

用 Random(x_1, x_2) 代替 x_r 将给出一个等效方程。

# scripting - How do I preserve variables in batch scripts when set in "for" loops?

> ID：588978
> 
> 赞同：2
> 
> 时间：2009-02-26T03:31:02.510
> 
> 标签：scripting, batch-file, dos

I need to set my classpath using all of the jars in a particular directory. Bash does it as follows:

```
CP_DELIMITER=;
for j in "$MY_HOME/javalib/*.jar"; do
    if [ "$CP" ]; then
        CP="$CP$CP_DELIMITER$j"
    else
        CP="$j"
    fi
done 
```

But "`for`" works differently in DOS, and essentially sends the command to the shell, but won't preserve the "set" on the variable

```
set CP=./
for %%j in (%MY_HOME%\javalib\*.jar) do (
    set $CP=%CP%;"%%j"
) 
```

When you ask for `$CP` outside the for, you only get the last jar file. If you echo inside, you can see that `%%j` does have all of the values.

Has anyone found a solution?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T03:38:36.317

You'll need to enable **delayed environment variable expansion** with `CMD.EXE /V` and use `!VAR!`:

```
set CP=./
for %%j in (%MY_HOME%\javalib*.jar) do ( set CP=!CP!;"%%j" ) 
```

# asp.net - 在 ASP.NET 中使用嵌入式标准 HTML 表单

> ID：588981
> 
> 赞同：10
> 
> 时间：2009-02-26T03:32:35.567
> 
> 标签：asp.net, html, forms

我有一个标准的 aspx 页面，我需要在其中添加另一个标准 HTML 表单并将其提交到另一个位置（外部站点），但是每当我按下提交按钮时，该页面似乎会回发而不是使用子表单操作网址。

下面是表单关系的模型。请注意，在实际部署中，表单将成为母版页布局的内容区域的一部分，因此表单需要独立于母版页表单提交。

```
 <html xmlns="http://www.w3.org/1999/xhtml" >
       <head runat="server">
          <title>Untitled Page</title>
       </head>
       <body>
           <form id="form1" runat="server">
           <div>
               <form id="subscribe_form" method="post" action="https://someothersite.com" name="em_subscribe_form" > 
                    <input type="text" id="field1" name="field1" />
                    <input id="submitsubform" type="submit" value="Submit" />
               </form>
           </div>
           </form>
       </body>
   </html> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-26T04:10:46.020

这是一个有趣的问题。理想情况下，您只需要其他用户提到的页面上的 1 个表单标签。您可能可以通过 javascript 发布数据而无需 2 个表单标签。

示例取自[此处](http://mentaljetsam.wordpress.com/2008/06/02/using-javascript-to-post-data-between-pages/)，根据您的需要进行修改。不是 100% 确定这是否对您有用，但我认为这就是您必须采用的方法。

```
<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
<title>Untitled Page</title>
<script type="text/javascript">

function postdata()
{
   var fieldValue = document.getElementById("field1").value;
   postwith("http://someothersite.com",{field1:fieldValue});
}

function postwith (to,p) {
  var myForm = document.createElement("form");
  myForm.method="post" ;
  myForm.action = to ;
  for (var k in p) {
    var myInput = document.createElement("input") ;
    myInput.setAttribute("name", k) ;
    myInput.setAttribute("value", p[k]);
    myForm.appendChild(myInput) ;
  }
  document.body.appendChild(myForm) ;
  myForm.submit() ;
  document.body.removeChild(myForm) ;
}

</script>
</head>
<body>
<form id="form1" runat="server">
<div>
           <div>
                <input type="text" id="field1" name="field1" />
                <asp:Button ID="btnSubmitSubscribe" runat="server" Text="Submit" OnClientClick="postdata(); return false;" />

       </div>

</div>
</form>
</body>
</html> 
```

如果 javascript 不是一个可行的选项 - 您可以使用 .Net 的 HttpWebRequest 对象在后面的代码中创建 post 调用。在后面的代码中看起来像这样（假设您的文本字段是一个 asp 文本框：

```
private void OnSubscribeClick(object sender, System.EventArgs e)
{
string field1 = Field1.Text;

ASCIIEncoding encoding=new ASCIIEncoding();
string postData="field1="+field1 ;
byte[]  data = encoding.GetBytes(postData);

// Prepare web request...
HttpWebRequest myRequest =
  (HttpWebRequest)WebRequest.Create("http://someotherwebsite/");
myRequest.Method = "POST";
myRequest.ContentType="application/x-www-form-urlencoded";
myRequest.ContentLength = data.Length;
Stream newStream=myRequest.GetRequestStream();
// Send the data.
newStream.Write(data,0,data.Length);
newStream.Close();
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-06-09T20:06:26.867

如果将 ASP.NET 按钮添加到表单，并将其 PostBackUrl 属性设置为外部站点，则所有表单数据都将发布到该 URL。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-08-08T10:37:46.013

这个问题有一个非常好的棘手的解决方案。

您可以在关闭导致问题的 asp.net 表单之前插入`</form>`标签。`<form>`不要忘记`<form>`在您的 html 表单后添加标签。它可能会导致编辑器给你一个异常，但不要担心，它会起作用的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-26T03:59:07.233

[根据 W3C，](http://www.w3.org/MarkUp/html3/forms.html)嵌套表单在 HTML 中是不可能的。您可以使用 JavaScript 或[jQuery](http://blog.avirtualhome.com/2008/10/01/how-to-create-a-nested-form/ "如何创建嵌套表单")来实现您的预​​期结果，正如 Peter 在名为 My Thoughts 的博客中所解释的那样。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-02-14T15:13:22.737

以我的经验，Appetere Web Solutions 拥有最好的解决方案。简单而优雅......而且它不是一个黑客。使用 PostBackUrl。

我刚刚尝试过，一切都按预期工作。我不想使用 Javascript，因为我不想将它包含在我的母版页中，用于每个使用它的页面。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-24T21:37:06.487

我和罗斯有同样的情况——除了我的输入类型都是“隐藏的”变量。

Cowgod 的回答让我想到了我的 .aspx 页面中的嵌套表单。我最终将我的第二个表单“取消嵌套”了主 .aspx 表单（

突然间，一切都按原样提交。这是黑客吗？

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-02-26T03:55:34.013

ASP.NET 允许您在一页上拥有多个表单，但只有一个可以是`runat=server`. 但是我认为你根本不能嵌套表单。

您可能必须制作一个新的母版页，一个没有表单标签的母版页，以便表单只能在该页上工作。这不是一个好的解决方案，除非您可以将表单放在母版页的表单之外，并使用 javascript 提交第二个表单，但这也好不到哪里去。对于您要实现的目标，确实没有好的解决方案，如果是这样，我想听听。我认为您不能从代码隐藏中进行 POST 调用，可以吗？我敢肯定有什么办法。但这可能是唯一的解决方案：来自代码。

# c# - 您如何检测主硬盘驱动器号，例如 C: 驱动器？

> ID：588990
> 
> 赞同：32
> 
> 时间：2009-02-26T03:39:07.033
> 
> 标签：c#

您如何检测主硬盘驱动器号，例如 C: 驱动器？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-02-26T03:45:31.120

尝试

```
Path.GetPathRoot(Environment.GetFolderPath(Environment.SpecialFolder.System)); 
```

这将返回（通常） C:\

但这取决于您如何定义“主”硬盘。这将为您提供安装 Windows 的驱动器。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-02-26T03:50:07.677

这应该可以工作（假设您想要 Windows 所在的驱动器）：

```
string rootDrive = Path.GetPathRoot(Environment.SystemDirectory); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-26T03:47:06.437

```
Environment.GetFolderPath(Environment.SpecialFolder.System).Substring(0,1) 
```

从[这里](https://www.neowin.net/forum/topic/579727-c-get-windows-drive/)参考。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-26T03:47:35.047

“SystemDrive”是您想要的 XP 环境变量。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-26T03:45:48.887

```
var d = Directory.GetDirectoryRoot(Environment.GetEnvironmentVariable("windir")); 
```

# sql - Create table 中的 CHECK 中的通配符作为字符串

> ID：588993
> 
> 赞同：0
> 
> 时间：2009-02-26T03:42:41.000
> 
> 标签：sql, string, character, wildcard

我创建了一个存储员工记录的信息表，它的 SQL 查询如下...

```
CREATE TABLE info1 (
   empid VARCHAR(8) PRIMARY KEY CONSTRAINT empchk 
      CHECK (empid IN ('kh\%' ESCAPE '\''),
   initials CHAR(6), fname CHAR(25) NOT NULL, 
   lname CHAR(25), 
   userstatus INTEGER NOT NULL, 
   designation CHAR(10) NOT NULL
); 
```

现在，正如你所看到的，约束在`empid`哪里`kh%`——据我所知——`%`意味着任何数量的以下字符（`8`当然限于）可以是任何东西，对吧？

我正在使用Java DB，奇怪的是它也将`%`符号作为字符串的一部分，所以如果我输入`khce0001`，它会说`empchk`违规，它只接受`kh%`

我应该怎么办？为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T04:23:50.387

这个 SQL 查询中的错误是我使用`IN`了而不是`LIKE`（我相信通配符检查），所以

*   我放弃了约束......

    ```
    ALTER TABLE info DROP CONSTRAINT empchk; 
    ```

*   并用...改变了桌子

    ```
    ALTER TABLE info ADD CONSTRAINT empchk CHECK (empid LIKE ('kh%')); 
    ```

*   因此正确的 SQL 查询应该是......

    ```
    CREATE TABLE info1 (
        empid VARCHAR(8) PRIMARY KEY CONSTRAINT empchk 
            CHECK (empid LIKE ('kh%')),
        initials CHAR(6), 
        fname CHAR(25) NOT NULL,
        lname CHAR(25), 
        userstatus INTEGER NOT NULL,
        designation CHAR(20) NOT NULL
    ); 
    ```

# html - 我如何让我的文本与此一起流动，而不是等到它清楚？[HTML]

> ID：588995
> 
> 赞同：0
> 
> 时间：2009-02-26T03:43:19.143
> 
> 标签：html, web

我试图让文本漂浮在我网页上的小图像周围，我已经尝试了我能想到的一切。我会在这里嵌入 html 和 css，但是我在做这件事时遇到了麻烦，对不起。

（当它被回答时我会编辑掉这个网址，所以我不会把它用作广告。）[删除]

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-26T03:46:45.063

基本上，你已经倒退了。

不是让图像内联并浮动`p`'，而是浮动图像，让`p`' 内联。确保图像仍然出现*在*文本之前......就像这样：

```
<img src="foo.png" style="float: left;">
<p>  
   this is some awesome text blah blah
</p> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T03:48:34.857

您需要将图像向左浮动，而不是段落。********