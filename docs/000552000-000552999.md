# StackOverflow 问答 000552000-000552999

# asp.net - ASP.NET 页面事件 - GridView 绑定后出现按钮单击事件

> ID：552000
> 
> 赞同：6
> 
> 时间：2009-02-16T01:30:02.447
> 
> 标签：asp.net, data-binding, events, page-lifecycle

我对页面事件顺序的理解是这样的：

> 页面：加载
> 
> 控制：DataBind（用于 GridView 或其他）
> 
> 控制：负载
> 
> 控制：单击（对于按钮）
> 
> 页面：预渲染
> 
> 控制：预渲染

（还有很多其他的——但这些是我感兴趣的）

这里要注意的重要一点是按钮的单击事件发生*在*gridview 的绑定事件之后。如果按钮导致数据发生更改，则 GridView 将显示旧数据。我可以在 PreRender 事件中重新绑定控件，但这看起来非常难看。

这一定是一个非常常见的模式（一个更新数据的按钮）。如何将它放在一起，以便 GridView在 Button 单击更改*后绑定到数据？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T04:08:09.087

答案在 Button Click 事件中，在数据更改后，在页面上调用 DataBind() 以使 GridView（以及其他任何需要它的东西）重新绑定。我不知道你能做到这一点。

谢谢 Ocdecio 和 Mufasa - 我会将您的回答标记为有帮助，但我还没有代表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T02:06:45.650

默认情况下，ASP.NET 会进行大量绑定和重新绑定。点击事件后重新绑定是正常的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T01:36:36.423

GridView 绑定之后出现按钮单击事件的唯一原因是您对页面进行了编程以执行该操作。我看不出在 PreRender 事件中绑定控件有什么问题，事实上这是在控件事件（例如 Button onclick）之后采取行动的唯一方法。

# asp.net-mvc - ASP.NET MVC-提交客户端创建的集合

> ID：552009
> 
> 赞同：1
> 
> 时间：2009-02-16T01:36:47.127
> 
> 标签：asp.net-mvc

我正在使用 javascript 将用户选择附加到列表中。当用户完成时，这是最好的方法：

1：为列表创建索引并作为模型提交给控制器？

2：创建隐藏元素并使用javascript附加值并作为actionlink提交？（不知道如何告诉 actionlink 这里的值）

3：仅将表单块包裹在隐藏元素周围并将字符串作为模型提交？

其他？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T23:25:04.737

首先，Scott Hanselman 有一篇关于模型绑定到数组、集合等的[好文章](http://www.hanselman.com/blog/ASPNETWireFormatForModelBindingToArraysListsCollectionsDictionaries.aspx)
。 在我看来，您不应该使用第二种方式，因为这将是一个漏洞（[CSRF 的描述](http://en.wikipedia.org/wiki/Cross-site_request_forgery)）。
为了使用集合绑定，您需要将表单包裹在列表周围并提交（注意，此表单将仅提交此列表中的选定值，但您可以在提交之前将它们全部选中）或创建值映射和通过 javascript 提交它（对于 jQuery - $.post(url, data, callback)）或将所有名称和值对添加到表单的某个隐藏元素并提交。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T02:02:57.407

我认为最简单的方法是将某种形式的列表放入隐藏字段（type=hidden），它将自动与表单一起提交，并以您提供的名称在服务器上访问。所以这里的主要推理是您将在服务器端处理这些数据的方式。

# c++ - 是否可以在没有 Visual Studio 的情况下使用 C++ 为 Windows 开发？

> ID：552019
> 
> 赞同：26
> 
> 时间：2009-02-16T01:43:07.860
> 
> 标签：c++, windows, visual-studio, winapi

我渴望从事实时 3D 图形工作。我几乎完全在 C++ 中工作，对 win32 有一点了解。实际上，我有任何理智的选择吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-16T01:49:42.947

您可以在没有 IDE 的情况下使用 MSVC 编译器。这可能是你最好的选择。它是一个很好的编译器，它是 Windows 开发的事实上的标准。

放弃 IDE 并简单地使用编译器肯定没有错。

我相信可以从 Code::Blocks IDE 中毫无问题地使用 MSVC 编译器。或者，从命令行调用编译器也是一种行之有效的方法。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-16T01:56:48.637

日食： http: [//www.eclipse.org/](http://www.eclipse.org/downloads/)

Code::Blocks 很酷： http: [//www.codeblocks.org/](http://www.codeblocks.org/)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-16T01:49:16.550

要看...

Cygwin/Mingwin 为您提供了一个编译器。Qt 或 wxWidgets 为您提供了一个易于使用且可移植的 GUI 工具包。

我同意这个问题。Visual Studio 是一头猪。它的调试器非常好，但剩下的就是一头猪（特别是来自工具通常不会试图锁定你的 OSS 背景）。

您还可以查看 nmake 并直接从命令行调用 VC++ 编译器工具。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-16T02:18:34.810

我们使用 VC++ 作为编译器/链接器，但使用[Jam](http://www.perforce.com/jam/jam.html)来驱动构建。实际的 Visual Studio 仅用作调试器。好处是，一旦我们设置 Jam 以在 Windows 中构建项目，只需极少的努力（通常**没有**）就可以让它在 Unix 上工作。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-16T04:01:34.517

[Zeus IDE](http://www.zeusedit.com)作为*MSVC*的替代品工作得很好。它甚至可以导入*MSVC*项目和解决方案文件。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-11-12T21:37:43.357

聚会有点晚了，但我想补充一点，在 2018 年终于开始出现一个可行的替代方案，足以承诺从 VS 对 Windows C++ 开发的垄断中解放出来：

*   [Sublime Text](https://www.sublimetext.com/)作为编辑器，带有以下插件：
    *   [EasyClangComplete](https://packagecontrol.io/packages/EasyClangComplete)，一个体面的（就像，*只是工作*）智能感知的替代品；
    *   [可选] [Clang Format](https://packagecontrol.io/packages/Clang%20Format)，提供比 MS 更灵活的源格式化体验；
*   [Clang-cl](https://releases.llvm.org/download.html)作为 Clang 编译器的包装器，旨在实现[最大的 MSVC 兼容性](https://clang.llvm.org/docs/MSVCCompatibility.html)。

不幸的是，标准库头文件仍然需要 Microsoft Build Tools，但与整个 VS 庞然大物相比，下载大小微不足道。好处是 Clang-cl 会自动选择它们，并且 Build Tools 并没有强制要求您让他们的可执行文件上线以*登录*并*激活您的免费许可证*！

将这一切设置为工作配置比将 VS 项目/解决方案拼凑在一起要复杂一些，但这是完全值得的。作为奖励，手动设置可以让您更好地了解 IDE 的底层原理。

要错过的一件事可能是出色的 VS 调试器......好吧，如果你准备好打破习惯，开源[x64dbg](https://x64dbg.com/)可能会来拯救，通过包含的 .pdb 文件查看和单步执行源代码的能力（是的, Clang[现在可以生成它们了！](http://blog.llvm.org/2017/08/llvm-on-windows-now-supports-pdb-debug.html)）。

**更新：**截至 2019 年，EasyClangComplete 的一个更好且面向未来的替代方案是通过[LSP](https://packagecontrol.io/packages/LSP)插件使用[Clangd 。](https://clang.llvm.org/extra/clangd/Installation.html)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-16T01:56:27.080

当然可以，但是使用 Microsoft 的 IDE 为 Microsoft 操作系统进行开发要容易得多。在罗马的时候...

[Eclipse](http://www.eclipse.org/cdt/)是一个不错的选择。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-16T01:58:21.257

[Code::Blocks](http://www.codeblocks.org/) IDE 带有 MinGW C++ 编译器并支持 wxWidgits 。IDE 非常简约，它可能是也可能不是您正在寻找的东西——我真的很喜欢它。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-04-26T21:25:47.950

我肯定会为此受到很多批评，但我发现 C++Builder 是一个比 MSVC 更容易开发 Windows C++ 应用程序的 IDE/编译器。它可能不是最便宜的解决方案，或者具有所有相同的花里胡哨，或者是最符合语言的（它的 32 位编译器还不支持 C++11，但它的 64 位编译器支持），但你真的不能击败了它的视觉 UI 设计师和第 3 方组件市场。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-16T01:44:30.650

很有可能，[Qt](http://www.qtsoftware.com/products)是你的朋友。[Qt Creator](http://www.qtsoftware.com/developer/qt-creator)也处于 RC 阶段，因此值得期待。在此之前，您可以将它与[Code::Blocks 之类的东西一起使用。](http://www.codeblocks.org/)Code::Blocks 本身就是一个很棒的环境，对 wxWidgets 也有很多支持。如果您只是在寻找 IDE 更改，如前所述，Code::Blocks 也可以使用其他 IDE 的编译器。

-约翰

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-16T01:49:25.880

我发现[Dev-C++非常有用，而且免费 :)](http://www.bloodshed.net/devcpp.html)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-16T03:47:32.757

SlickEdit（或许多其他支持 ctags 或类似东西的编辑器）构成了一个相当不错的“IDE”。

您可以将这些编辑器与 makefile（或其他构建工具）一起使用来驱动几乎任何您想要的编译器（MVCS、mingw、Comeau、Digital Mars 等等）。

几个雇主之前，这正是我们所做的。我们使用由 makefile 驱动的 MS 编译器，使用的主要编辑器是 SlickEdit。我们使用 Debugging Tools for Windows 软件包进行调试（我们所做的很多都是内核模式）。效果很好。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-07T14:13:30.680

[Wascana Desktop Developer](http://wascana.sourceforge.net/)是专为在 Windows 上开发而配置的 Eclipse CDT 发行版。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-07-03T14:49:01.637

我会推荐给[Notepad++](http://notepad-plus-plus.org/)、[MSBuild](http://msdn.microsoft.com/en-us/library/0k6kkbsd.aspx)和[Windows SDK](http://www.microsoft.com/en-us/download/details.aspx?id=8279)看看。您也可以使用[XBuild](http://mono-project.com/Porting_MSBuild_Projects_To_XBuild)，但那更具体。请注意，MSBuild 和 XBuild 只是自动化工具，因此您将在 Windows SDK 上花费更多时间。

# php - 包含包含的 PHP 安全性

> ID：552023
> 
> 赞同：2
> 
> 时间：2009-02-16T01:44:33.270
> 
> 标签：php

你会说这有多安全？

```
$pages = array("about", "help", "login");
$pagesWithId = array("shownews", "showuser", "showfile");

if (in_array($_GET['page'], $pages)) {
  include('includes/'.$_GET['page'].'.php');
  include('templates/'.$_GET['page'].'.html');
}

foreach ($pagesWithId as $page) {
    if (ctype_digit($_GET[$page])) {
    include('includes/'.$page.'.php');
    include('templates/'.$page.'.html');
}
} 
```

你看到任何潜在的威胁吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T01:48:01.000

它是安全的。

不安全的是允许某人构建任意 URL，然后您将其包含在内。

在这里，您将可能的替换限制为几个已知数量之一，因此它是安全的。

# objective-c - 非 Mac OS X 平台是否支持 Objective-C 2.0 异常处理？

> ID：552025
> 
> 赞同：3
> 
> 时间：2009-02-16T01:45:30.380
> 
> 标签：objective-c, multithreading, exception, gcc, garbage-collection

Objective-C 2.0 有一些新的增强：

*   垃圾收集
*   快速枚举：`for..in`
*   特性
*   线程同步：@synchronized(self)
*   @try/@catch/@finally/@throw 异常处理

我对使用 Objective-C 2.0 作为一种语言来编写跨多个操作系统平台的可移植代码很感兴趣——同时避免使用 OpenStep 或 GNUStep 等框架。

但是，虽然 Windows 上的 gcc 3.4.5 在使用 -fobjc-exceptions 编译时会解析使用 @try/@catch/@finally/@throw 异常处理的语法，但它仍然会产生这个错误：

```
error: storage size of '_stackExceptionData' isn't known 
```

在 Mac OS X v10.3 及更高版本以外的操作系统上是否支持 Objective-C 2.0 功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T11:41:00.977

来自[Cocotron 的引用通过 gcc 4.3.0 获得了一些 Objective-C 2.0 支持](http://www.cocotron.org/blog/2008/03/cocotron-gets-some-objective-c-20.html)：

> Johannes 最近的 Cocotron 补丁也完全启用了编译器中存在但需要运行时支持的 @try/@catch。

[www.cocotron.org](http://www.cocotron.org/)关于 Cocotron 是什么：

> Cocotron 是一个开源项目，它实现了一个类似于 Apple Inc. 的 Cocoa 文档中描述的 Objective-C API。这包括 AppKit、Foundation、Objective-C 运行时和支持 API，例如 CoreGraphics 和 CoreFoundation

因此，如果您对跨平台 obj-c 开发感兴趣， *Cocotron*可能对您很感兴趣......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T06:14:26.087

Apple 使用标准 GCC 的变体/分支，其中内置了 Objective-C 2.0 支持。据我所知，标准 GCC 中不存在任何 Objective-C 2.0 特性。

我不太确定异常处理，但不幸的是，您列出的其他功能在其他平台上不可用。

PS GNUstep（和 Cocoa）是 OpenStep 的一个实现，它是一个规范。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T07:31:47.383

有问题的特性需要编译器和运行时的支持，因此，当然可以构建一个支持语法的编译器（想到 LLVM/Clang），其中许多特性调用了 Objective-C 运行时，我的GNU 运行时的知识（以及在 Google 上的快速复查）没有必要的支持。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T11:48:09.073

作为 Étoilé 项目的一部分，有一个跨平台运行时，它支持 Objective-C 异常（以及`@synchronized`结果）和 AFAIK 属性：

[http://www.nabble.com/ANN:-New-Objective-C-Runtime-td13648692.html](http://www.nabble.com/ANN:-New-Objective-C-Runtime-td13648692.html)

顺便说一句，Objective-C 语言异常不是 Objective-C 2.0 的特性。自 Panther 以来，他们一直在 NeXT 运行时中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-10T12:28:47.540

[`@try/@catch/@finally/@throw`](http://gcc.gnu.org/onlinedocs/gcc/Objective_002dC-and-Objective_002dC_002b_002b-Dialect-Options.html#index-fobjc_002dexceptions-194)实际上早于 Objective-C 2.0。它是在 MacOSX 10.3 中引入的，而 Objective-C 2.0 是在 10.5 (Leopard) 中引入的。

# colors - 如何在 VIM 中使硬编码的字符串看起来令人发指？

> ID：552026
> 
> 赞同：4
> 
> 时间：2009-02-16T01:46:17.213
> 
> 标签：colors, vim

我受到[这个](http://secretgeek.net/6min_program.asp)（第 2 点）的启发，使我的硬编码字符串变得丑陋。

我怎样才能在 VIM 中做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-16T02:32:51.157

基于语言的文件存储在 中`$VIMRUNTIME/syntax`，每种语言一个`.vim`文件，因此您需要去那里进行更改。

例如，我的 C 文件存储在`C:\Program Files\Vim\vim70\syntax\c.vim`，如果您在末尾附近添加以下行，在 之前`let b:current_syntax = "c"`，您将获得所需的确切效果：

```
hi String guifg=#ff0000 guibg=#ffff00 
```

对于基于文本的 VIM，需要使用 ctermfg 和 ctermbg 选项，例如：

```
hi String ctermfg=Red ctermbg=Yellow 
```

我没有测试过这些，因为我现在只使用 gvim。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-16T01:59:12.453

在你的 .vimrc 中：

```
highlight String guifg=1 guibg=11 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T02:22:26.830

```
highlight clear String
highlight link String Error 
```

有点超过国际海事组织，所以你可能不想让它永久化。

# hardware - 软件业务：软件价格与所需硬件的最佳比例是多少？

> ID：552041
> 
> 赞同：-2
> 
> 时间：2009-02-16T02:01:08.143
> 
> 标签：hardware

当销售需要硬件的软件包时，通常是专用硬件（可能是虚拟机），买方通常必须购买将运行它的服务器。因此，总拥有成本（关注资本支出）除了软件之外还包括硬件。

例如，一个 3000 美元的错误跟踪包可能需要 1500 美元的服务器才能运行，总成本为 4500 美元。硬件是软件成本的 50%，或总成本的 1/3。

当然，对于开源包，比例是倒置的。

所以问题是：重要吗？硬件费用在什么时候会影响软件的销售？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T02:14:54.930

该比率取决于等式的哪一部分是商品部分。

如果您销售的软件旨在解决可以在任何服务器上运行的空中交通管制等复杂问题，您可能希望将其与硬件打包出售，但由于硬件是商品并且可以从其他供应商处获得，价格比将严重偏向软件。

另一方面，如果您是 OEM 并且您的目标是销售您的硬件，您可以使用该软件作为商品为您的产品带来更多价值。例如，您可以销售高端服务器机器并添加预配置的 LAMP 堆栈以使您的产品更好。在这种情况下，价格严重偏向于硬件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T02:19:27.227

为什么需要硬件？

如果硬件价格是您销售的一个重要突破点，也许可以提供一个托管解决方案并将价格纳入这项服务。

“软件即服务”可能真的可以帮助您为基础设施有限的客户进行一些销售。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T02:08:17.190

“通常” - 这是一个假设。

如果涉及服务或续订费用，成本可能不仅仅是硬件和软件。这也适用于开源，因为很多公司喜欢为赔偿和服务付费。

如果您购买硬件和操作系统，那么使用 Windows 或 Linux 的决定就会发挥作用。

我非常怀疑是否存在一个有意义的、固定的比率。不过，这是一个有趣的问题。您需要大量数据，但我没有看到它已被收集到一个地方。

我在下面的评论中有另一个想法值得浮出水面。还有一个越来越重要的考虑因素：功耗。一些企业数据中心无法在不淘汰旧服务器或通过其他方式降低功耗的情况下添加新服务器。能够在现有服务器上部署新的软件购买是一大优势。如果可以虚拟化，那就更好了。

所以它并不总是硬件和软件。必须考虑其他经济因素，例如电力成本。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-16T02:08:47.080

我发现硬件成本很少影响决策。

小公司可以重用服务器。

大公司已经支持服务器集群，并且越来越多地具有 VM 功能，因此他们可以轻松地将软件部署/重新部署到尽可能多的硬件上。

# php - 在 flex 和 php 之间传递变量

> ID：552045
> 
> 赞同：1
> 
> 时间：2009-02-16T02:02:59.060
> 
> 标签：php, mysql, apache-flex

我是 flex 开发的新手，我的问题是如何使用 php 在 flex 3 和 mysql 数据库之间传递变量？有人告诉我最好的方法是使用 AMFPHP，但这似乎是一种过度杀戮，或者可能不确定.. 有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T04:54:19.040

我会在 xml 上使用 json，因为 json 会传输更少的字节，而 php 的 json_encode($object) 又快又容易。

我会在 amfphp 上使用 json，因为 json 是通用的。例如，我可以通过返回 json 来为 flex 或 javascript 创建一个 web 服务。

你可以看看这篇[文章](http://www.5etdemi.com/blog/archives/2006/12/clearing-the-fud-on-amfphps-speed-versus-json-and-xml/)来比较 json、amfphp 和 xml。另外，这里有一个很好的关于 flex、php 和 json的[教程。](http://www.adobe.com/devnet/flex/articles/flex_php_json.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T08:09:04.303

AMFPHP 并没有真正被积极开发。现在最好的替代方法是使用 Zend_Amf [http://wadearnold.com/blog/?page_id=155](http://wadearnold.com/blog/?page_id=155)，Zend 和 Adob​​e 都支持它。

不要被 Zend Framework 组件的需要吓到。该框架是模块化的，您可以使用自己的自定义 php 类来访问数据，而无需经历 Zend 框架的学习曲线。

使用 AMF 的好处在于，由于它是二进制数据传输，因此速度非常快。

此外，如果您只想让您的 flex 应用程序通过 api 调用获取结果数据，那么使用 XML 甚至 JSON 是一个烦人的额外步骤。如果由于某种原因，您还需要处理将数据输出到 xml 或 json，可以通过扩展或创建将数据从数组和对象转换为 xml 或 json 的新控制器/服务轻松地将其添加到您的应用程序

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T02:50:16.730

有几个选择可供您选择。本质上，它归结为您希望如何处理 PHP 端的数据。

我会花时间研究的两个是简单的 XML（我的首选）和 AMFPHP。

XML：Flex 可以非常轻松地处理 XML 数据，甚至可以将其自动映射到 ActionScript 对象（通常，或使用[GoogleCode 上的 xobj 项目](http://xobj.googlecode.com)之类的东西，映射到类型化实例）。同样，在 PHP 代码中使用 XML 也有很多支持。

AMFPHP：AMFPHP 让您可以通过网络将类型化的 ActionScript 对象传递给您的 PHP 代码。AMFPHP 项目中包含一些工具，它也使在 PHP 端使用 MySQL 变得容易。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T13:51:44.720

如果您正在做一个简单的查询，我会将您的数据作为普通的 POST 数据传递。您可以使用 Flex 中的 HTTPService 组件来执行此操作。在 PHP 端，我将使用 XML 字符串进行响应，并将 HTTPService resultFormat 设置为“e4x”（用于 XML 的 Ecmascript），以便对结果数据进行类似对象的简单操作。

这是 HTTPService 的 livedocs 参考：http://livedocs.adobe.com/flex/3/html/help.html?content= [data_access_2.html](http://livedocs.adobe.com/flex/3/html/help.html?content=data_access_2.html)

对于更复杂的查询/操作，还可以选择使用带有 AMF 的 Flex RemoteObject 作为数据协议。在 PHP 端，您可以使用 zend 框架 AMF 组件进行通信。

这是 RemoteObject 的 livedocs 参考：http://livedocs.adobe.com/flex/3/html/help.html?content= [data_access_4.html](http://livedocs.adobe.com/flex/3/html/help.html?content=data_access_4.html)

Zend AMF 的下载页面：http: [//framework.zend.com/download/amf](http://framework.zend.com/download/amf)

# http - Weblogic 服务器：为什么在完成后发送响应

> ID：552047
> 
> 赞同：0
> 
> 时间：2009-02-16T02:07:24.183
> 
> 标签：http, weblogic, http-post

在使用数据包嗅探器分析流量时，我们看到在完成向该服务器的 http 发布*之前来自 weblogic 服务器的 http 响应。*

在这种情况下，服务器上的jsp页面基本上是一个静态页面，此时对post的内容没有任何逻辑可做。

但是为什么服务器会在帖子完成之前发送响应？

我找到了有关如何配置服务器以忽略使用 Http post 的拒绝服务攻击的 Weblogic 文档。也许这就是正在发生的事情？

我认识的人以前没有人见过这种行为。也许一些精通 weblogic 的人会知道发生了什么。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-16T09:27:42.580

I don't think that Weblogic is analyzing the JSP to determine whether it is static or not.

My guess is that either

1.  someone else was accessing the server at the same time
2.  you saw the answer to a previous request

[EDIT] To determine what is going on, I suggest to set a breakpoint in the JSP. If you still get an answer without hitting the breakpoint, something further up the stack must be intercepting the request (for example, a cache).

# .net - 使用 XSLT 输出一个空的 HTML textarea 元素

> ID：552048
> 
> 赞同：7
> 
> 时间：2009-02-16T02:07:39.003
> 
> 标签：.net, html, xslt, textarea

当尝试输出一个空的 textarea 元素时，.NET XSLT 处理器会将元素折叠为其短格式。而不是这个：

```
<textarea id="blah" name="blah"></textarea> 
```

我明白了：

```
<textarea id="blah" name="blah"/> 
```

这会导致许多 Web 浏览器（包括 IE 和 Firefox）将页面的其余部分呈现为文本区域的*内容*。**这很糟糕。**

如果我在中间放置一些东西，比如不间断的空格，我可以强制 XSLT 处理器输出开始和结束 textarea 标记。但这意味着我必须在客户端进行更多的解析和验证，以判断 textarea 何时“真正”为空。我还必须使用 JavaScript 删除多余的空格，这样用户就不会以空格开始他们的评论。

有谁知道强制 XSLT 处理器呈现开始和结束标签*而*不必插入虚拟内容的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T02:12:11.160

通过 Stackoverflow.com 上的类似问题找到您的[答案](https://stackoverflow.com/questions/336670/explicit-script-end-tag-always-converted-to-self-closing):-)

[这](http://msdn.microsoft.com/en-us/library/system.xml.xmlwritersettings.outputmethod.aspx)是 MSDN 的进一步解释。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T02:34:07.160

我必须使用虚拟内容，这是我使用的 xsl:template，在 textarea 中只有换行符。

```
<!-- This prevents empty textarea elements being rendered as singletons in the XHTML output by adding a newline character -->
<xsl:template name="xhtml-textarea-contents">
    <!-- what should be contained in the textarea -->
    <xsl:param name="contents" />

    <xsl:choose>
        <xsl:when test="$contents = ''"><xsl:text>&#x0A;</xsl:text></xsl:when>
        <xsl:otherwise><xsl:copy-of select="$contents" /></xsl:otherwise>
    </xsl:choose>
</xsl:template> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T02:42:36.187

Chris Ballance 有一个对我有用的答案。但值得注意的是，我一直在使用输出到流的 XslCompiledTransform 的重载，如下所示：

```
XslCompiledTransform transform = new XslCompiledTransform();
...
MemoryStream stream = new MemoryStream();
transform.Transform(reader, args, stream); 
```

为了传递正确的设置，我不得不改用接受 XmlWriter 的重载。

```
// using XmlWriter so I can pass the output settings along.
XmlWriter writer = XmlWriter.Create(stream, transform.OutputSettings);
transform.Transform(reader, args, writer); 
```

微软在那里使用了一种非常奇怪的设计模式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-01T10:20:29.593

如果您正在生成 xml 或 html，您可以在 textarea 中编写一个换行符，然后使用 jquery 将其删除。

这是一个使用 jQuery 的例子：

```
<textarea>&#160;<textarea>

<script>
 $(document).ready(function(){
    $('textarea').each(
      function(index){$(this).text('');}
     );
  });
</script> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-11-11T03:52:59.070

我在.net之外遇到过这个问题，这在两者中都是可重现的[对我来说] `<xsl:output method="xml">`（`<xsl:output method="xhtml">`我做出的假设`method="html"`不适用于我们的输出必须是格式良好的xml的场景）

为了避免 textarea 标签崩溃，我们必须在其中插入一些内容，但我们也必须避免篡改*实际*内容。以下：

```
<xsl:if test="not(normalize-space())"><xsl:comment></xsl:comment></xsl:if> 
```

产生正确的结果（即防止空`textarea`自闭合并且不引入人为内容）。我相信这种行为在[后模式验证信息集的节点构造](http://www.w3.org/TR/2013/PR-xpath-datamodel-30-20131022/#const-psvi-element)下的规范中提到了，其中空注释的字符串值将变为零长度字符串；然而，该文件的措辞对于轻松的下午阅读来说太 w3-ey 了。

更进一步（*如果它不篡改内容，我们真的需要`xsl:if`吗？*），这是防止某些标签崩溃的最终模板（我渴望遵循[身份转换](http://en.wikipedia.org/wiki/Identity_transform)模式）：

```
<xsl:template match="node()|@*">
    <xsl:copy>
        <xsl:apply-templates select="node()|@*"/>
    </xsl:copy>
</xsl:template>

<xsl:template match="textarea">
    <xsl:copy>
        <xsl:apply-templates select="node()|@*"/>
        <xsl:comment></xsl:comment>
    </xsl:copy>
</xsl:template> 
```

注意：浏览器的行为表明这种转换也应该应用于其他一些元素，比如段落。然而，拥有一个自关闭`<p/>`并不像拥有一个自关闭那样具有破坏性`<textarea/>`！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-16T05:05:51.377

我遇到了类似的问题，并且刚刚意识到如果将 XmlWriterSettings 的 ConformanceLevel 设置为 Fragment，它会消除一些 XslCompiledTransform 怪癖。

```
FileStream xmlFileStream = File.Create("file.xml");
XslCompiledTransform transform = new XslCompiledTransform();
transform.Load("transform.xsl");
XmlWriterSettings settings = new XmlWriterSettings();
settings.ConformanceLevel = ConformanceLevel.Fragment;
XmlWriter xmlWriter = XmlWriter.Create(xmlFileStream, settings);
transform.Transform(sourceXml, null, xmlWriter); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-06-23T05:14:03.007

这对我有用

```
<xsl:template name="fillTextArea">
  <xsl:param name="sourceStr" />
    <xsl:element name="textarea">
     <xsl:attribute name="value">
       <xsl:value-of select="$sourceStr"></xsl:value-of>
         </xsl:attribute>
         <xsl:attribute name="class">notes</xsl:attribute>
     </xsl:element>
</xsl:template> 
```

# sql - 如何按照用户的期望排序和显示字母和数字的混合列表？

> ID：552053
> 
> 赞同：3
> 
> 时间：2009-02-16T02:09:37.593
> 
> 标签：sql, database, alphanumeric, natural-sort

我们的应用程序有一个`CustomerNumber`字段。我们有数百个不同的人在使用该系统（每个人都有自己的登录名和自己的列表`CustomerNumber`）。单个用户最多可能有 100,000 个客户。许多人少于100个。

有些人只在他们的客户编号字段中输入实际数字，而另一些人则混合使用。系统允许 20 个字符，可以是 AZ、0-9 或破折号，并将这些字符存储在 VARCHAR2(20) 中。任何小写字母在存储之前都会变成大写字母。

现在，假设我们有一个简单的报告，其中列出了特定用户的所有客户，按客户编号排序。例如

```
SELECT CustomerNumber,CustomerName
FROM Customer
WHERE User = ?
ORDER BY CustomerNumber; 
```

这是一个幼稚的解决方案，因为只使用数字的人不想看到简单的字母排序（“10”在“9”之前）。

我不希望就他们的数据向用户提出任何不必要的问题。

我正在使用 Oracle，但我认为看到其他数据库的一些解决方案会很有趣。请包括您的答案适用于哪个数据库。

您认为实现这一点的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T02:55:51.787

可能您最好的选择是预先计算一个单独的列并将其用于订购并使用客户编号进行显示。这可能涉及将任何内部整数 0 填充为固定长度。

另一种可能性是对返回的结果进行排序后选择。

[Jeff Atwood 整理了一篇](https://blog.codinghorror.com/sorting-for-humans-natural-sort-order/)关于一些人如何计算人类友好排序顺序的博客文章。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T12:01:06.610

在 Oracle 10g 中：

```
SELECT  cust_name
FROM    t_customer c 
ORDER BY
    REGEXP_REPLACE(cust_name, '[0-9]', ''), TO_NUMBER(REGEXP_SUBSTR(cust_name, '[0-9]+')) 
```

这将按数字的第一次出现排序，而不是关于它的位置，即：

1.  `customer1 < customer2 < customer10`
    *   `cust1omer ? customer1`
    *   `cust8omer1 ? cust8omer2`

，其中 a`?`表示订单未定义。

这足以满足大多数情况。

要对 case 强制排序`2`，您可以添加一个`REGEXP_INSTR(cust_name, '[0-9]', n)`到`ORDER BY`列表`n`时间，强制在第`n`-th （`2nd`等`3rd`）组数字的第一次出现时排序。

要在 case 上强制排序`3`，您可以添加一个`TO_NUMBER(REGEXP_SUBSTR(cust_name, '[0-9]+', n))`到`ORDER BY`列表`n`时间，强制`n`-th 的顺序。一组数字。

在实践中，我写的查询就足够了。

您可以在这些表达式上创建一个基于函数的索引，但您需要通过提示强制执行它，并且`SORT ORDER BY`无论如何都会执行一次通过，因为`CBO`不信任函数基索引足以允许`ORDER BY`对它们进行索引。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T12:15:24.703

您可以有一个数字列 [CustomerNumberInt] 仅在 CustomerNumber 是纯数字时使用（否则为 NULL [1]），然后

```
ORDER BY CustomerNumberInt, CustomerNumber 
```

[1] 根据您的 SQL 版本如何处理 ORDER BY 中的 NULL，您可能希望将其默认为零（或无穷大！）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T23:51:04.640

我有类似的可怕情况，并开发了一个合适的可怕功能来处理它（SQLServer）

在我的情况下，我有一个“单元”表（这是一个学生的工作跟踪系统，所以在这种情况下，单元代表他们正在做的一门课程）。单位有一个代码，其中大部分是纯数字的，但由于各种原因，它被做成了一个 varchar，他们决定在一些前面加上最多 5 个字符。所以他们期望 53,123,237,356 可以正常排序，但也有 T53、T123、T237、T356

UnitCode 是一个 nvarchar(30)

这是函数的主体：

```
declare @sortkey nvarchar(30)

select @sortkey = 
    case
        when @unitcode like '[^0-9][0-9]%' then left(@unitcode,1) + left('000000000000000000000000000000',30-(len(@unitcode))) + right(@unitcode,len(@unitcode)-1)
        when @unitcode like '[^0-9][^0-9][0-9]%' then left(@unitcode,2) + left('000000000000000000000000000000',30-(len(@unitcode))) + right(@unitcode,len(@unitcode)-2)
        when @unitcode like '[^0-9][^0-9][^0-9][0-9]%' then left(@unitcode,3) + left('000000000000000000000000000000',30-(len(@unitcode))) + right(@unitcode,len(@unitcode)-3)
        when @unitcode like '[^0-9][^0-9][^0-9][^0-9][0-9]%' then left(@unitcode,4) + left('000000000000000000000000000000',30-(len(@unitcode))) + right(@unitcode,len(@unitcode)-4)
        when @unitcode like '[^0-9][^0-9][^0-9][^0-9][^0-9][0-9]%' then left(@unitcode,5) + left('000000000000000000000000000000',30-(len(@unitcode))) + right(@unitcode,len(@unitcode)-5)
        when @unitcode like '%[^0-9]%' then @unitcode
        else left('000000000000000000000000000000',30-len(@unitcode)) + @unitcode
    end 

return @sortkey 
```

写完之后我想朝自己的脸开枪，但是它可以工作并且在运行时似乎不会杀死服务器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-20T02:56:02.153

我在 SQL SERVER 中使用了它并且工作得很好：这里的解决方案是在前面用一个字符填充数值，这样所有的字符串长度都相同。

这是使用该方法的示例：

```
select MyCol
from MyTable
order by 
    case IsNumeric(MyCol) 
        when 1 then Replicate('0', 100 - Len(MyCol)) + MyCol
        else MyCol
    end 
```

100 应替换为该列的实际长度。

# python - Python 中的“接口”：是还是不是？

> ID：552058
> 
> 赞同：20
> 
> 时间：2009-02-16T02:15:17.503
> 
> 标签：python, documentation, interface, coding-style

因此，在静态领域花费了大量时间之后，我开始使用 Python 进行项目。我见过一些制作“接口”的项目，它们实际上只是没有任何实现的类。以前，我会嘲笑这个想法并忽略这些项目的那一部分。但现在，我开始接受这个想法。

我们很清楚，Python 中的接口看起来像这样：

```
class ISomething(object):
    def some_method():
        pass
    def some_other_method(some_argument):
        pass 
```

请注意，您没有将 self 传递给任何方法，因此需要覆盖该方法才能被调用。我认为这是一种很好的文档和完整性测试形式。

那么这里的每个人对这个想法有什么看法呢？我是否被我所做的所有 C# 编程洗脑了，还是这是个好主意？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-02-16T03:50:38.397

我不确定那是什么意思。接口（无论如何都是这种形式）主要是为了解决缺乏多重继承的问题。但是 Python 有 MI，那为什么不干脆做一个抽象类呢？

```
class Something(object):
    def some_method(self):
        raise NotImplementedError()
    def some_other_method(self, some_argument):
        raise NotImplementedError() 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-16T10:47:32.137

在 Python 2.6 及更高版本中，您可以改用[抽象基类](http://docs.python.org/library/abc.html)。这些很有用，因为您可以通过使用“isinstance”来测试某些东西是否实现了给定的 ABC。与 Python 中的往常一样，该概念并不像在严格的语言中那样严格执行，但它很方便。此外，还有一些很好的惯用方式来声明带有装饰器的抽象方法 - 有关示例，请参见上面的链接。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-16T02:40:12.870

在某些情况下，接口可能非常方便。 [Twisted](http://twistedmatrix.com/trac/)[相当广泛地使用](http://twistedmatrix.com/projects/core/documentation/howto/components.html)了Zope[接口](http://wiki.zope.org/Interfaces/FrontPage)，并且在我正在研究 Zope 接口的项目中工作得非常好。Enthought 的特性打包了最近添加的[接口](http://code.enthought.com/projects/traits/docs/html/traits_user_manual/advanced.html#id15)，但我对它们没有任何经验。

不过要小心过度使用——鸭子类型和协议是 Python 的一个基本方面，只有在绝对必要时才使用接口。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-02-16T02:46:40.733

蟒蛇式的方式是“请求宽恕而不是获得许可”。接口都是*关于*接收对对象执行某些操作的权限。Python 更喜欢这个：

```
def quacker(duck):
    try:
        duck.quack():
    except AttributeError:
        raise ThisAintADuckException 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-16T02:45:25.480

我认为接口不会向代码环境添加任何内容。

*   没有它们，方法定义的执行就会发生。如果一个对象期望有 like`Foo`和 have method `bar()`，但它没有，它会抛出一个`AttributeError`.
*   仅仅确保定义了接口方法并不能保证其正确性。无论如何，行为单元测试都需要到位。
*   编写一个“阅读或死亡”页面来描述您的对象需要与您插入的内容兼容的方法与在接口类中具有详细的文档字符串一样有效，因为您可能会有无论如何测试它。这些测试之一可以是所有兼容对象的标准，这些对象将检查每个基本方法的调用和返回类型。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-16T02:24:33.190

对我来说似乎有点不必要 - 当我编写这样的类时，我通常只制作`ISomething`没有方法的基类（你的），并在实际文档中提及哪些方法子类应该覆盖。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-16T02:58:27.087

您可以使用动态类型语言创建接口，但在编译时不会强制执行该接口。如果您忘记实现（或错误输入！）接口的方法，静态类型语言的编译器会警告您。由于您在动态类型语言中没有收到此类帮助，因此您的接口声明仅用作文档。（这不一定是坏事，只是你的接口声明与编写注释相比没有运行时优势。）

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-16T02:33:21.483

我即将对我的 Python 项目做类似的事情，我唯一要添加的是：

*   每个接口和所有抽象方法的超长、深入的文档字符串。
*   我会添加所有必需的参数，以便有一个明确的列表。
*   引发异常而不是“通过”。
*   为所有方法添加前缀，因此它们显然是接口的一部分 - interface Foo: def foo_method1()

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-16T23:48:49.670

我个人经常将接口与 Zope 组件架构 (ZCA) 结合使用。优点不是拥有接口，而是能够将它们与适配器和实用程序（单例）一起使用。

例如，您可以创建一个适配器，该适配器可以采用一个实现 ISomething 的类，但将其调整为某个接口 ISomethingElse。基本上它是一个包装器。

原来的类是：

```
class MyClass(object):
  implements(ISomething)

  def do_something(self):
      return "foo" 
```

然后想象接口 ISomethingElse 有一个方法 do_something_else()。适配器可能如下所示：

```
class SomethingElseAdapter(object):
    implements(ISomethingElse)
    adapts(ISomething)

    def __init__(self, context):
        self.context = context

    def do_something_else():
        return self.context.do_something()+"bar" 
```

然后，您将使用组件注册表注册该适配器，然后您可以像这样使用它：

```
>>> obj = MyClass()
>>> print obj.do_something()
"foo"
>>> adapter = ISomethingElse(obj)
>>> print adapter.do_something_else()
"foobar" 
```

这使您能够使用该类不直接提供的功能来扩展原始类。您可以在不更改该类的情况下执行此操作（它可能位于不同的产品/库中），并且您可以简单地通过不同的实现交换该适配器，而无需更改使用它的代码。这一切都是通过在初始化时注册组件来完成的。

这当然主要对框架/库有用。

我认为需要一些时间来适应它，但我真的不想再没有它了。但正如之前所说，你需要准确地思考哪里有意义，哪里没有意义。当然，它自己的接口也可以用作 API 的文档。它对于单元测试也很有用，您可以在其中测试您的类是否实际实现了该接口。最后但并非最不重要的一点是，我喜欢从编写界面和一些文档测试开始，以了解我实际上要编写的代码。

有关更多信息，您可以查看我[对它的小介绍，](http://mrtopf.de/blog/an-introduction-to-the-zope-component-architecture/)并对其 API 进行了[相当广泛的描述](http://www.muthukadan.net/docs/zca.html)。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-17T08:39:45.930

Glyph Lefkowitz（Twisted 名声）最近[写了一篇关于这个话题的文章](http://glyph.twistedmatrix.com/2009/02/explaining-why-interfaces-are-great.html)。我个人觉得不需要接口，而是 YMMV。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-07-30T20:32:01.460

你看过[PyProtocols 吗？](http://peak.telecommunity.com/PyProtocols.html)它有一个很好的接口实现，你应该看看。

# linux - 任何人都知道任何静态类型的脚本语言？

> ID：552061
> 
> 赞同：14
> 
> 时间：2009-02-16T02:18:38.447
> 
> 标签：linux, scripting, package, linux-from-scratch

我即将为一个爱好项目启动一个基于 LFS 的 linux 发行版。我计划做一些非常非标准的任务，其中大部分将涉及更改发行版中的几乎所有脚本。（主要是 init 脚本，但我也会编写一组简单的包管理器脚本。）因为我要远离规范，而且我从来都不是动态类型语言的粉丝（perl， python、bash 和其他都很好，但不是我的强项），我想知道是否有人知道实际上已经声明变量的解释语言。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-16T03:20:18.530

通常，静态类型语言是编译语言。我猜原因是，类型的静态分析相当昂贵，您必须深入了解您正在处理的所有代码。完成之后，不将所有信息写入文件感觉很浪费，这样您下次就不必再这样做了。所以你很快就会得到一种编译语言。

另一方面，将编译语言转换为“未编译”语言相当容易。您只是不将编译结果存储在任何地方，而是直接执行它们。我知道提供这种包装器的一种编译器是 GHC，即标准的[Haskell](http://haskell.org/)编译器。您可以添加`#!/usr/bin/runhaskell`到源文件中，然后直接执行它们。而且由于您打算远离规范，因此 Haskell 似乎是完美的选择；)。但预计脚本的启动时间会相当长，因为所有“编译时间”分析和优化都不是免费的。

Haskell 不是为 shell 脚本而设计的，它是一种函数式语言，所以如果你以前从未见过它，可能需要一些时间来适应它。但是它的语法开销很小，而且函数式语言的优势在于抽象，所以我不明白为什么你不能创建一个让 shell 脚本变得有趣的库。甚至还有一些[实验性的 Haskell shell](http://changelog.complete.org/archives/587-a-better-environment-for-shell-scripting)，但它似乎更像是一个概念验证而不是真正的解决方案。

一般来说，我会说所有类型分析的开销很大，但我建议你选择你最喜欢的静态类型编译语言并寻找一个像`runhaskell`执行用它编写的脚本的包装器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T02:35:04.537

[F#](http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/)提供了“类型安全、简洁、性能、表现力和脚本”的组合。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T03:31:00.830

快速谷歌。F3、javaFX脚本、Linden Scripting Language（第二人生的脚本），不像第一个答案的评论F#可以作为脚本语言 [http://blogs.msdn.com/chrsmith/archive/2008/09/12/脚本在 f.aspx](http://blogs.msdn.com/chrsmith/archive/2008/09/12/scripting-in-f.aspx)

Felix、Tuga、CFGScript、Talc、Angelscript，并且猜测不止是快速搜索。

道格拉斯

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-17T15:21:13.003

时髦的。默认情况下，它是动态的、鸭式的。而且还支持静态类型。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-16T21:01:16.500

查看您最喜欢的 shell 中的“排版”命令。bash 和 ksh93 都可以强制整数和字符串，使用引用（变量变量）等。使用 ksh93，您还可以进行浮点数学运算并使用具有属性的对象。静态类型并不能真正为您购买任何在 init 脚本和类似脚本中有用的东西。你主要是读取文件和运行系统命令——这是 shell 真正擅长的。花点时间阅读 O'Reilly 的“学习 Korn Shell”一书，然后再决定所有其他 Unix 的设计都很愚蠢……；）

# java - 如何向 Java HTMLDocument 提供 cookie？

> ID：552065
> 
> 赞同：0
> 
> 时间：2009-02-16T02:22:43.083
> 
> 标签：java, cookies, dom

我正在尝试将网站作为 HTMLDocument 阅读；并且该站点需要来自先前登录的 cookie，或对弹出对话框的响应。我认为提供必要的 cookie 是最容易完成的，但我还没有找到一种方法来做到这一点。打开和阅读文档的代码是：

```
URL url = new URL(suppliedURL);
URLConnection conn = url.openConnection();
InputStream is = conn.getInputStream();
InputStreamReader isr = new InputStreamReader(is);
BufferedReader br = new BufferedReader(isr);
HTMLEditorKit htmlKit = new HTMLEditorKit();
HTMLDocument htmlDoc = (HTMLDocument) htmlKit.createDefaultDocument();
HTMLEditorKit.Parser parser = new ParserDelegator();
HTMLEditorKit.ParserCallback callback = htmlDoc.getReader(0);
parser.parse(br, callback, true); 
```

检索到的文档包含错误信息，只能通过调用登录对话框或提供 cookie 来更正。

所以问题是：

1.  打开此页面时如何提供 cookie？

2.  如何将现有 IE cookie 中的信息复制到我提供的 cookie 中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T02:36:28.107

如何使用[Apache Commons HttpClient](http://hc.apache.org/httpclient-3.x/cookies.html)。

# android - Android - 如何在代码中设置首选项

> ID：552070
> 
> 赞同：44
> 
> 时间：2009-02-16T02:26:21.080
> 
> 标签：android, sharedpreferences, android-preferences

我有一个 Android 应用程序，其中我在 XML 文件中有我的偏好，它工作正常。我现在想使用代码设置其中一个首选项，而不是显示整个首选项屏幕，我该怎么做呢？

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2009-02-16T06:02:11.153

我假设首选项是指您的应用程序的首选项，而不是 Android 手机设置。

要在您的应用程序运行之间存储首选项，您需要执行以下操作

1.  创建一个 SharedPreferences 对象

    ```
    SharedPreferences settings = getSharedPreferences(String n, MODE_PRIVATE); 
    ```

    *字符串 n 标识您的偏好，第二个参数是它们将被访问的模式*

2.  实例化一个编辑器对象

    ```
    SharedPreferences.Editor editor = settings.edit(); 
    ```

    *注意：不要尝试 settings.editor.edit()，这不会产生持久对象，下面的代码也不起作用*

3.  将您的首选项写入缓冲区

    ```
    editor.put...(String, value) 
    ```

    *有许多put函数，putString，putBoolean等。String是key（“version”，“good run”），value是value（“1.5.2”，true）*

4.  冲洗缓冲区

    ```
    editor.commit(); 
    ```

    *这实际上写入了您的偏好设置。如果您的应用程序在此行之前崩溃，则不会写入首选项。还有一个记录在案的错误：commit() 应该返回一个指示成功或失败的布尔值。最后我检查它总是返回假。*

这些首选项将存储在手机上，并且只能由您的应用程序访问。

更多文档在[这里](http://developer.android.com/guide/topics/data/data-storage.html)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-12-01T17:04:33.197

我试过这个但没有奏效：

```
SharedPreferences settings = getSharedPreferences(String n, MODE_PRIVATE); 
```

试试这个：

```
SharedPreferences settings = PreferenceManager.getDefaultSharedPreferences(this); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-04-29T05:32:54.730

您可以使用以下代码在 sharedpreferences 中保存一些内容

```
public static void save(String valueKey, String value) {
    SharedPreferences prefs = PreferenceManager
            .getDefaultSharedPreferences(context);
    SharedPreferences.Editor edit = prefs.edit();
    edit.putString(valueKey, value);
    edit.commit();
    } 
```

阅读偏好：

```
public static String read(String valueKey, String valueDefault) {
    SharedPreferences prefs = PreferenceManager
            .getDefaultSharedPreferences(context);
   return prefs.getString(valueKey, valueDefault);
} 
```

# wpf - 将多个控件存储在数组中的最佳方法

> ID：552071
> 
> 赞同：1
> 
> 时间：2009-02-16T02:26:25.120
> 
> 标签：wpf, controls

我在 WPF 中有一个带有许多子控件的 UserControl，我想像数组一样对其进行索引。这些子控件与我不感兴趣的其他子控件位于同一网格控件中。

我希望能够以类似于以下方式索引这些控件：

```
someControl.Children[3]; 
```

不必避免我不感兴趣的控件。这是我所拥有的示例：

```
<Grid x:Name="gCalendar">
    // more crap here...

    <TextBlock Grid.Row="0" Grid.Column="7" TextBlock.TextAlignment="Center">Blah</TextBlock>

    <Internal:DayCalendarTime Grid.Row="1" Grid.Column="0" />
    <Internal:DayCalendarCore Grid.Row="1" Grid.Column="1"/>
    <Internal:DayCalendarCore Grid.Row="1" Grid.Column="2"/>
    <Internal:DayCalendarCore Grid.Row="1" Grid.Column="3"/>
    <Internal:DayCalendarCore Grid.Row="1" Grid.Column="4" />
    <Internal:DayCalendarCore Grid.Row="1" Grid.Column="5"/>
    <Internal:DayCalendarCore Grid.Row="1" Grid.Column="6"/>
    <Internal:DayCalendarCore Grid.Row="1" Grid.Column="7"/>
</Grid> 
```

我希望通过在它们周围放置某种包装控件来创建一个仅由 Internal:DayTimeCore 控件组成的数组。

这可能吗，还是我必须通过遍历网格的所有子节点并添加我感兴趣的类型来手动创建数组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T04:05:23.977

您可以将这些控件包装在另一个 Grid 控件中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T08:20:12.447

另一种非 WPF 方式，通过在控件集合后面创建代码

```
foreach(DayCalendarTime control in gCalendar.Children)
{ 
  controlCollection[i++] = control;
} 
```

# user-interface - 在长时间运行的流程和用户界面/业务逻辑分离期间给予用户反馈

> ID：552072
> 
> 赞同：1
> 
> 时间：2009-02-16T02:29:10.947
> 
> 标签：user-interface, hci

当一个长时间运行的进程正在执行时，向用户提供反馈是一种很好的做法，例如，更新进度条。

GUI 库的一些常见问题解答建议如下：

```
function long_running_progress()
    do_some_work()
    update_progress_bar()
    while finish
        do_some_work()
        update_progress_bar()
    end while
end function 
```

无论如何，我们知道将业务逻辑代码与用户界面代码分开是一种最佳实践。上面的示例是在业务逻辑函数中混合用户界面代码。

什么是在业务逻辑层中实现功能的好技术，其进度可以通过用户界面轻松跟踪而无需混合层？

欢迎任何语言或平台的答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-16T08:31:28.627

提供回调接口。业务逻辑每隔一段时间就会调用它的方法。用户层将更新进度或其他内容。如果你想允许取消——没问题，让回调方法有一个返回值，这将表明需要取消。无论线程数如何，这都将起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T02:33:31.437

如果您使用 MVC 范例，您可以让模型将其当前进度状态作为属性发布，控制器可以每 x 秒提取一次，然后将其放入视图中。这假设多线程，但我不确定你是否允许。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T08:26:51.477

出版是一个很好的方法。这完全取决于平台如何完成。但是，当涉及到**用户体验**时，还需要考虑以下几点：

*   如果您不知道任务执行了多长时间，请不要给用户一个进度条。还剩什么时间？半途而废是什么意思？最好使用沙漏功能（旋转轮、弹跳进度条等）。

*   查看进度的唯一有趣的事情是时间。半途而废是什么意思？你想知道你是否有时间喝那杯咖啡。如果您显示其他内容，您可能正在显示系统编程的工作原理。大多数用户不感兴趣或只是感到困惑。

*   长时间运行的进度应该始终支持用户转义，这是一种取消请求的方式。您不想长时间锁定用户。更好的是完全在后台处理长时间运行的请求，并在结果返回时让用户返回。

# python - 从“今天”或“昨天”和 Python 中安排时间的最佳方式是什么？

> ID：552073
> 
> 赞同：9
> 
> 时间：2009-02-16T02:30:50.820
> 
> 标签：python, datetime, parsing

Python 有很好的日期解析，但它是通过今天创建新日期并进行减法来识别日期时间（例如“今天下午 3:20”或“昨天上午 11:06”）的唯一方法吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-16T04:03:58.723

我非常喜欢并且我看到越来越多的人使用的库是[python-dateutil](http://labix.org/python-dateutil)但不幸的是，它和其他传统的大型日期时间解析器，[来自 Egenix 的 mxDateTime](http://www.egenix.com/products/python/mxBase/mxDateTime/)都无法解析“明天”这个词，尽管这两个库具有非常强大的“模糊”解析器。

我见过的唯一可以做到这一点的图书馆是[magicdate](http://pypi.python.org/pypi/magicdate/0.1.3)。例子：

```
>>> import magicdate
>>> magicdate.magicdate('today')
datetime.date(2009, 2, 15)
>>> magicdate.magicdate('tomorrow')
datetime.date(2009, 2, 16)
>>> magicdate.magicdate('yesterday')
datetime.date(2009, 2, 14) 
```

不幸的是，这只返回 datetime.date 对象，因此不包括时间部分，也无法处理“今天下午 3:20”的示例。

因此，您需要 mxDateTime 。例子：

```
>>> import mx.DateTime

>>> mx.DateTime.Parser.DateTimeFromString("Today 3:20 PM")
<mx.DateTime.DateTime object for '2009-02-15 15:20:00.00' at 28faa28>

>>> mx.DateTime.Parser.DateTimeFromString("Tomorrow 5:50 PM")
<mx.DateTime.DateTime object for '2009-02-15 17:50:00.00' at 2a86088> 
```

编辑：mxDateTime.Parser 仅在这些示例中解析时间并忽略“今天”和“明天”这两个词。因此，对于这种特殊情况，您需要使用 magicdate 的组合来获取日期和 mxDateTime 来获取时间。我的建议是只使用 python-dateutils 或 mxDateTime 并且只接受它们可以解析的字符串格式。

* * *

编辑 2：如评论中所述，python-dateutil 现在可以处理模糊解析。我还发现了为在 Chandler 中使用而开发的[parsedatetime](http://code.google.com/p/parsedatetime/)模块，它适用于这个问题中的查询：

```
>>> import parsedatetime.parsedatetime as pdt
>>> import parsedatetime.parsedatetime_consts as pdc
>>> c=pdc.Constants()
>>> p=pdt.Calendar(c)
>>> p.parse('Today 3:20 PM')
((2010, 3, 12, 15, 20, 0, 4, 71, -1), 3)
>>> p.parse('Yesterday 11:06 AM')
((2010, 3, 11, 11, 6, 0, 3, 70, -1), 3) 
```

供参考的是当前时间：

```
>>> import datetime
>>> datetime.datetime.now()
datetime.datetime(2010, 3, 12, 15, 23, 35, 951652) 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2009-02-16T03:36:16.153

我还没有完全掌握 Python 的速度，但是你的问题让我很感兴趣，所以我挖了一下。

使用日期减法[**`timedelta`**](http://docs.python.org/library/datetime.html#timedelta-objects)是迄今为止我发现的最常见的解决方案。

由于您的问题询问这是否是**唯一**的方法，所以我检查了 strftime 格式代码，看看您是否可以定义自己的。不幸的是没有。来自 Python 的[strftime 文档](http://docs.python.org/library/datetime.html#id1)：

> ...支持的全套格式代码因平台而异，因为 Python 调用平台 C 库的 strftime() 函数，并且平台变化很常见。
> 
> 以下是 C 标准（1989 版）要求的所有格式代码的列表...

无论如何，这不是一个确定的答案，但也许它会节省其他人找错树的时间。

# php - 如何创建多个游戏服务器？

> ID：552079
> 
> 赞同：0
> 
> 时间：2009-02-16T02:34:36.253
> 
> 标签：php, mysql

正如标题所说，如何创建多个游戏服务器？

我即将开发一款网络游戏，这是我的第一次。Flash 和数据库中的游戏由 php 和 mysql 处理。我对服务器有疑问。用户登录后，他们应该选择一个服务器。如何创建多个服务器供用户选择？将它分开还是使用1个集中式服务器更好？（假设游戏可能需要一次处理 1000 名玩家）。

如何创建不同的服务器？可以只使用 PHP 和 MySQL 完成吗？

（嗯，对不起我的英语不好..）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T02:49:17.250

如果这是您第一次开发在线游戏，我肯定会从一台服务器开始。使用现代系统，在一台服务器上同时处理 1000 名在线玩家应该是可能的。如果您需要扩展到更多玩家并且发现您遇到了性能限制，*那么*请调查多个服务器。

# text-editor - 如何更改 Textmate 包中的语言上下文？

> ID：552095
> 
> 赞同：1
> 
> 时间：2009-02-16T02:45:35.540
> 
> 标签：text-editor, textmate, textmatebundles, bundles

我想让我的 Textmate 包根据我正在编辑的内容使用正确的上下文。例如，我经常使用[YUI](http://developer.yahoo.com/yui)，所以我希望 HTML 包使用 YUI JS 包而不是标准的 JS 包，等等。

任何人都可以建议我应该在哪里编辑以实现这一目标。捆绑编辑提示的奖励积分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T09:09:55.167

我们在这里谈论的是*范围*。您必须编辑您的 Bundle 元素范围。

让我们来看看：

[替代文字 http://mtod.org/so/scope.png](http://mtod.org/so/scope.png)

现在，将范围编辑为更宽的范围，例如使用`source.js`代替`source.js.yui`. 这应该应用于 Bundle 中的每个片段、命令等。您可能可以直接对您的 Bundle 文件进行搜索和替换。

[替代文字 http://mtod.org/so/edit.png](http://mtod.org/so/edit.png)

就是这样。捆绑代码段在下面触发。

[替代文字 http://mtod.org/so/yui.png](http://mtod.org/so/yui.png)

# php - 安全性 - SQL

> ID：552108
> 
> 赞同：0
> 
> 时间：2009-02-16T02:55:02.383
> 
> 标签：php, mysql

嘿，下面是一个处理登录脚本的页面，我想知道是否有任何安全漏洞。我一直在阅读有关防止注射和其他人的文章，并希望确保我的代码是安全的。

它通过 ajax 提交并根据登录是否正确返回 JSON。

```
<?php
ob_start();
session_start();
include ("config.inc.php");
include ("jsonEncode.php");

// ausername and apassword sent from form
$ausername = '';
$apassword = '';
$ausername = mysql_real_escape_string(stripslashes($_GET['username']));
$apassword = mysql_real_escape_string(stripslashes($_GET['password']));

$sql    = "SELECT * FROM admin WHERE ausername='$ausername' AND apassword='$apassword' LIMIT 1";
$result = mysql_query($sql) or die(mysql_error());

$data   = mysql_fetch_array($result);
$count  = mysql_num_rows($result);

if($count==1){
    $_SESSION['ausername'] = $ausername;
    $_SESSION['apassword'] = $apassword;
    $_SESSION['admin_id']  = $data['a_id'];
    $a_id = $data['a_id'];
    $_SESSION['LastLogin'] = $data['last_login'];
    $query = "UPDATE admin SET last_login = Now() WHERE `a_id`= $a_id";
    mysql_query($query);
    //echo $query;
    $_SESSION['aloggedin'] = "1234";
    // valid
    $var = array('avalid' => 1, 'ausername' => $ausername, 'apassword' => $apassword);
    print php_json_encode($var);
}else{
    // invalid
    $var = array('avalid' => 0, 'ausername' => $ausername, 'apassword' => $apassword);
    print php_json_encode($var);
}
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T02:59:05.667

您可能希望在登录表单中使用 POST 方法而不是 GET，否则他们的密码将出现在 URL 中并且 URL 不是很安全（例如，它们可能会被添加到书签或作为推荐 URL 发送到另一台服务器）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T03:08:18.217

你不需要去掉斜线。除非您在填充这些列时还剥离斜杠，否则您实际上引入了一个安全漏洞——如果出于某种原因您对用户名字段没有唯一约束，和/或您在存储的用户名或密码字段，并且他们的密码只有斜杠不同，您可以让一个用户以另一个用户身份登录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T03:35:22.723

您应该使用绑定参数将用户数据放入 SQL，而不是字符串连接。

此外，您可能应该在数据库中存储密码散列 - 而不是原始明文密码。

最后，这不是安全问题，但在赋予它们新值之前立即将 $ausername 和 $apassword 设置为 '' 是完全没有意义的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T04:28:55.683

另外，不要将密码存储在会话中。php session 数据默认存储在操作系统的 tmp/temp 目录中，因此其他人可以查看数据。通常，我只会将用户名保留在会话中，并在需要时查询数据库。这样可以避免用户信息发生更改但会话未更新时的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-16T07:45:52.857

（我是MSSQL bod，所以不知道这些点是否与MySQL无关）

这与安全性无关，只是一般性观察以防万一：

不要使用 SELECT * - 列出您想要返回的列 - 看起来您只需要 a_id 和 last_login。将来您可能会在该表中添加一个带有他们的照片的 Blob，或者个人笔记等 - 它会在您过去执行 SELECT * 并且不需要图片的所有地方破坏性能。

我不会做 LIMIT 1 - 我很想知道此时是否有 DUP，并引发错误。

我会将 last_login 列放在与您的用户/密码表 1:1 链接的另一个表中。它是一个经常更改的项目，如果您决定在用户​​/密码表上引入一个审核表（即，每当它更改时存储旧值），具有一个经常更改的“信息”列会有点麻烦。

就我个人而言，我希望保持列命名约定和 SESSION / 变量之一相同。

admin_id / a_id, LastLogin / last_login

就个人而言，除非您以后需要它，否则我不会在会话中存储密码。我会存储一些东西来指示用户拥有的“权限”，然后用它来决定他们是否可以查看 PageX 或 PageY 等。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-16T11:39:42.997

上面所有的好答案。

只有一件事我想添加没有被提及...我倾向于获取帐户密码并进行 PHP 比较，而不是将密码放入查询中并查看该行是否存在。

# jquery - 在 jQuery 中使用“this”关键字的上下文

> ID：552110
> 
> 赞同：7
> 
> 时间：2009-02-16T02:57:10.897
> 
> 标签：jquery

***作为一个 jQuery 新手，我对使用this***关键字的不同上下文感到有些困惑。有时它指的是一个 DOM 元素，例如*this.id*，有时它指的是一个 jQuery 对象，例如*$(this).val()*。

[Remy Sharp 的博客文章](http://remysharp.com/2007/04/12/jquerys-this-demystified/ "这揭开了神秘面纱")很有帮助，但我想知道您将如何向新手解释差异。区别是严格的 jQuery 问题还是所有 Javascript 的共同点？

感谢到目前为止的所有回复 - 很棒的东西，我明天会选择一个答案。这是我后来发现的另一篇博客文章，它也很有帮助： [这是什么？迈克·阿尔苏普](http://www.learningjquery.com/2007/08/what-is-this)。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-16T03:22:24.783

在我看来，如果您不仔细阅读，Remy Sharp 的帖子会让人感到困惑。`this`永不改变的意思。在您给出的示例中，`this`. 作为事件中的 DOM 元素：

```
$('a').click(function() {
    alert(this.tagName);
}); 
```

并在事件中包装为 jQuery 对象：

```
$('a').click(function() {
    alert($(this).val());
}); 
```

如果您非常仔细地阅读上面的 2 个片段，您会发现它们的`this`含义永远不会改变。它总是引用 DOM 元素。不同之处在于它的使用方式。

在 jQuery 中，默认情况下，`this`指的是触发事件的 DOM 元素（不是 jQuery 对象）。在上面的第二个代码片段中，它**仍然**是同一个 DOM 元素，只是它通过包裹它被包裹在一个 jQuery 元素中`$()`。与 jQuery 构造函数的任何参数一样，传递`this`给构造函数会将其转换为 jQuery 对象。

我认为当 Remy 在与 jQuery 事件相同的文章中开始谈论 jQuery 插件时，就会出现混乱。jQuery 插件是人们很少编写和经常使用的东西。在编写 jQuery 插件时，您是在 jQuery 对象原型的上下文中工作的。在这种情况下，您使用这个词`this`来指代您正在编写的插件。在正常的用例中，您不会经常编写插件，所以这是一个不太常见的场景。当不在插件范围内时，不能使用`this`jQuery 对象来引用。

* * *

在 JavaScript 语言中，关键字`this`指的是 JavaScript 中对象的当前实例。在 JavaScript 原型中使用时，它指的是原型的实例。根据浏览器的不同，在使用非 jquery 事件模型时，`this`也指的是 DOM 元素。因为某些浏览器 (Internet Explorer)`this`在事件中不将 DOM 元素称为 DOM 元素，这使得处理事件变得困难。为了解决这个问题，jQuery 执行了一些 JavaScript 魔术，*总是*引用`this`触发事件的 DOM 元素。这是使用 JavaScript 框架而不是自己开发的（众多）原因之一。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-16T04:09:05.357

不要忘记，如果您不确定在任何给定上下文中的“this”是什么，您可以使用控制台在 Firebug 中对其进行诊断：

```
console.log("This is: " + this) 
```

如果您使用的是 jQuery（正如您之前提到的那样），您始终可以通过执行以下操作确保“this”仍然是一个 jQuery 对象：

```
this = $(this); 
```

然后，回到控制台，您可以通过在 Firebug 中记录“this”来查看 jQuery 对象是什么：

```
console.log("The jQuery This is: " + $(this)) 
```

最后，由于我们讨论的是 jQuery，因此在某些情况下“this”会发生变化。例如，当您在动画或fadeIn 或fadeOut 之后执行回调时。在这种情况下，“this”指的是接收效果的项目。

请记住，如果您不确定“this”是什么……请问 Firebug。萤火虫看到了一切。萤火虫知道一切。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T03:08:36.500

> 有时它指的是一个 jQuery 对象，例如*$(this).val()*。

`this`这里指的是一个DOM元素；$() 函数调用是将 DOM 元素包装在 jQuery 对象中。对于 jQuery 事件回调，`this`将（几乎？）总是引用 DOM 元素。在编写扩展 jQuery 的函数时，可以使用 $('select').myfunc() 调用的函数`this`将引用 jQuery 对象。

* * *

一般来说，在 JavaScript 中，`this`当函数作为对象的属性被调用时适用（看起来是方法的调用）。所以给定函数：

```
function foo() {
    doSomethingWith(this);
}

var obj1 = {'foo': foo};
var obj2 = {};
obj2.myFoo = foo;

obj1.foo(); // calls function foo(), with 'this' set to obj1
obj2.myFoo(); // calls function foo(), with 'this' set to obj2
foo();      // calls function foo(), with 'this' set to the global object
            // (which, in a browser, is the window object)
foo.apply(new Date()); // calls foo(), with 'this' set to a Date object 
```

因此，在 Javascript 中，函数中“this”所指的对象类型更多地取决于函数的调用方式，而不是函数的实际定义。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-01-22T02:16:20.693

[jQuery Proxy](http://api.jquery.com/jQuery.proxy/)可能会帮助您获得答案。您可以调用[jQuery](http://jquery.com/)函数并更改`this`范围所指的对象。

例如：

```
var me = {
  type: "zombie"
  ,test: function() {$('#result').html(this.type)}

};

$.proxy( me.test(), me ); //prints 'zombie' 
```

# wpf - 在 WPF 中，如何设置样式以使组合框具有焦点时不会突出显示？

> ID：552114
> 
> 赞同：1
> 
> 时间：2009-02-16T03:00:44.850
> 
> 标签：wpf, combobox, triggers, focus

我创建了一个要应用于组合框的 FlatCombo 样式。不能按我想要的方式工作的一件事是当 ComboBox 具有焦点时。我希望几乎没有迹象表明它有焦点。当前文本区域有蓝色突出显示。我假设这是从我的 3rd 方资源字典中提取的。如何调整我的本地样式，使其焦点显示的只是一条浅虚线？

谢谢，

戴夫

```
<UserControl.Resources>

    <Style x:Key="MyFocusVisual">
        <Setter Property="Control.Template">
            <Setter.Value>
                <ControlTemplate>
                    <Rectangle Margin="-1" StrokeThickness="1" Stroke="Black" StrokeDashArray="1 2"/>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <ControlTemplate x:Key="FlatCombo" TargetType="{x:Type ComboBox}">
    <ContentControl            
        Content="{TemplateBinding SelectionBoxItem}"            
        ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"            
        ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"            
        Margin="0,0,0,0"  Focusable="True"

        />
</ControlTemplate>

<Style TargetType="{x:Type ComboBox}" x:Key="DropDown">
    <Setter Property="OverridesDefaultStyle" Value="False" />
    <Style.Triggers>
        <MultiTrigger>
            <MultiTrigger.Conditions>
                <Condition Property="IsMouseOver" Value="False" />
                <Condition Property="IsFocused" Value="False"/>
            </MultiTrigger.Conditions>
            <Setter Property="Template" Value="{StaticResource FlatCombo}" />
        </MultiTrigger>
    </Style.Triggers>
</Style> 
```

```
 <ComboBox IsSynchronizedWithCurrentItem="True" x:Name="ComboBoxMinute" Width="Auto" 
              Height="Auto" HorizontalAlignment="Center" 
              Background="{Binding Path=Background, ElementName=TextBlockDate, Mode=Default}" 
              BorderBrush="{x:Null}" FontFamily="{Binding Path=FontFamily, 
              ElementName=TextBlockDate, Mode=Default}" 
              FontSize="{Binding Path=FontSize, ElementName=TextBlockDate, Mode=Default}" 
              Foreground="{Binding Path=Foreground, ElementName=TextBlockDate, Mode=Default}" 
              Padding="0,0,0,0" MaxDropDownHeight="200" Style="{StaticResource DropDown}" VerticalContentAlignment="Stretch" 
              VerticalAlignment="Center" FocusVisualStyle="{DynamicResource MyFocusVisual}"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T04:07:18.590

您应该将 OverridesDefaultStyle 设置为 True，而不是 false。您正在完全替换控件，因此将全部替换。

然而，看着你的代码，你说你希望它在集中时是平坦的；**然而，当控件没有**聚焦并且鼠标**不在**它上面时，您的触发器只会转到平面控件模板。那是你要的吗？

这里要考虑的另一个方面是，在可编辑组合的情况下，文本框将以蓝色突出显示文本，我认为这是目前无法更改的。

# asp.net - 在 ASP.Net 页面中启用页面级跟踪会回收我的应用程序池吗？

> ID：552115
> 
> 赞同：0
> 
> 时间：2009-02-16T03:02:27.607
> 
> 标签：asp.net

如果我在 asp.net 2.0 .aspx 页面上的指令中添加“trace=true”，它会回收我的应用程序池吗？

我知道我是否在 web.config 中启用跟踪，这将回收应用程序池。

网络服务器是 IIS 6.0。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-16T03:06:01.873

我相信它只会触发该页面的重新编译。编辑 aspx 文件不会触发应用程序重新启动。

为什么不测试一下看看呢？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T03:06:28.080

我不是100％肯定，但它不应该。对 web.config 文件的任何更改都会导致应用程序池重置，但页面级别的更改甚至不应该出现在指令中。

查看“为什么应用程序域回收？”部分 在这个[链接](http://blogs.msdn.com/tess/archive/2006/08/02/asp-net-case-study-lost-session-variables-and-appdomain-recycles.aspx)

从技术上讲，如果它是第 15 次重新编译，它可能会导致重置……但除此之外没有。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T03:10:24.217

好的 - 我刚刚在测试服务器上尝试过 - 在页面级别添加“trace = true”指令并没有回收应用程序池。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T06:24:31.060

它不会。仅当 Bin 目录中的 dll 更改或 web.config 文件更改时，应用程序池才会回收。如果您担心丢失会话信息，因为这在我看来与问题更相关，那么您可以使用 asp.net 会话状态提供程序，这样您的应用程序池可以在没有您的情况下随意回收多次失去你的会话。

# sql - 我应该对主键和外键使用 ENUM 吗？

> ID：552116
> 
> 赞同：7
> 
> 时间：2009-02-16T03:02:41.647
> 
> 标签：sql, mysql, enums

一位同事创建了一个架构，该架构使用一个`ENUM()`列作为查找表上的主键。该表将产品代码“FB”转换为名称“Foo Bar”。

这个主键然后在别处用作外键。目前，FK 也是一个`ENUM()`.

我认为这不是一个好主意。这意味着要连接这两个表，我们最终会进行四次查找。两张桌子，加上两张`ENUM()`。我对么？

我宁愿让 FK`CHAR(2)`减少查找。我还希望 PK 也`CHAR(2)`能完全减少它。

s的好处`ENUM()`是获得对值的约束。我希望有类似的东西：`CHAR(2) ALLOW('FB', 'AB', 'CD')`我们可以用于 PK 和 FK 列。

什么是：

1.  最佳实践
2.  您的偏好

这个概念也在其他地方使用。如果`ENUM()`的值更长怎么办？`ENUM('Ding, dong, dell', 'Baa baa black sheep')`. 现在，`ENUM()`从空间的角度来看，它很有用。如果有几百万行使用这些值，我应该只关心这个吗？在这种情况下，`ENUM()`可以节省存储空间。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-16T08:46:29.997

ENUM 应该用于定义给定字段的可能值范围。这也意味着您可能有多行对于​​该特定字段具有相同的值。

我不建议将 ENUM 用于外键类型的主键类型。

将 ENUM 用作主键意味着添加新键将涉及修改表，因为必须先修改 ENUM，然后才能插入新键。

我猜您的同事正试图限制谁可以插入新行并且行数是有限的。我认为这应该通过数据库级​​别或应用程序的适当权限设置来实现，而不是通过使用 ENUM 作为主键。

恕我直言，使用 ENUM 作为主键类型违反了[KISS 原则](http://en.wikipedia.org/wiki/KISS_principle)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-10T07:16:52.517

但是当你只被不同的 10 行或更少的行困住时，这不会成为问题

### 例如的

```
CREATE TABLE `grade`(
    `grade` ENUM('A','B','C','D','E','F') PRIMARY KEY,
    `description` VARCHAR(50) NOT NULL
) 
```

这张表很难得到一个**DML**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T03:30:13.140

我们对此进行了更多讨论，以下是我们的想法：

到处使用 CHAR(2)。对于PK和FK。然后使用 mysql 的外键约束来禁止为查找表中不存在的行创建 FK。

这样，给定查找表是`L`，以及两个引用表`X`和`Y`，我们可以在不查找 s 或表的情况下加入`X`，`Y`并且可以肯定*地*知道如果（何时）我们需要它有一行。`ENUM()``L``L`

我仍然对评论和其他想法感兴趣。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T03:30:18.367

拥有一个查找表和一个枚举意味着您一直在两个地方更改值。有趣...我们花了很多年时间使用枚举导致我们需要重新编译以添加值的问题。近年来，我们在很多情况下都不再使用枚举，而是使用查找表中的值。我喜欢查找表的最大价值是您无需编译即可添加或更改值。即使有数百万行，我也会坚持使用查找表，并且在您的数据库设计中保持智能

# javascript - Jquery切换窗口最小化

> ID：552118
> 
> 赞同：2
> 
> 时间：2009-02-16T03:03:19.947
> 
> 标签：javascript, jquery, browser, window

当您单击另一个 div 时，我有一个 div 会切换显示和显示。我如何修改我的代码，以便当用户最小化整个浏览器窗口时它会自动切换，从视图中隐藏 div，以便当用户取消最小化窗口时，div 不再可见。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T03:42:38.323

最小化窗口（或切换到另一个应用程序）应该触发[window.onblur](https://developer.mozilla.org/en-US/docs/Web/API/Window.onblur)事件。激活窗口应该触发[window.onfocus](https://developer.mozilla.org/en-US/docs/Web/API/Window.onfocus)

浏览器之间的实现细节可能略有不同，但默认javascript中似乎没有更好的方法（如果flash可以检测到窗口的最小化/最大化来触发必要的事件，你可以使用一些flash对象，但我不熟悉flash )

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T03:31:15.727

通过快速搜索，您似乎可以将事件附加到窗口调整大小事件，然后像往常一样从那里调用所需的切换功能。虽然我还没有实际测试过链接的样本......

$(window).bind('resize', function() { ....

[http://snipplr.com/view/6284/jquery--window-on-resize-event/](http://snipplr.com/view/6284/jquery--window-on-resize-event/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T03:32:49.250

在 JavaScript 中，无法检测窗口何时最小化。

您可以尝试检测窗口上的调整大小或模糊事件，但是这些事件可能由最小化以外的事物触发。

# git - 为 Git 克隆设置密码？

> ID：552121
> 
> 赞同：4
> 
> 时间：2009-02-16T03:04:57.943
> 
> 标签：git, git-clone

我想在我的存储库中输入密码，以便在从我的存储库克隆时询问密码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T03:24:01.160

要限制对存储库克隆的访问，您需要使用 ssh://... 协议，并仅向您希望访问的用户提供 ssh 访问权限。

您可能应该做的是查找各种“git 工作流程”问题和答案——它们描述了各种团队成员相互拉/推的方式。有很多方法可以做到这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-16T03:08:07.313

我推荐 gitosis 来管理私有仓库。

[在这里](http://scie.nti.st/2007/11/14/hosting-git-repositories-the-easy-and-secure-way)你有一个很好的教程

# syntax - 什么晦涩的语法毁了你的一天？

> ID：552130
> 
> 赞同：22
> 
> 时间：2009-02-16T03:09:31.367
> 
> 标签：syntax

您何时遇到过可能过时、从未使用过或只是简单地混淆了您一生都无法理解的语法。

例如，我从来不知道逗号是 C 中的实际运算符。所以当我看到代码时

```
if(Foo(), Bar()) 
```

我刚刚吹了一个垫圈，试图弄清楚那里发生了什么。

我很好奇其他语言中可能存在哪些从未尘埃落定的小角落。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-16T03:36:35.030

局部变量上的默认构造函数的 C++ 语法。起初我写了以下内容。

```
Student student();  // error
Student student("foo");  // compiles 
```

这让我花了大约一个小时阅读一条神秘的 C++ 错误消息。最终，一个非 C++ 新手路过，笑着指出了我的错误。

```
Student student; 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-02-16T05:15:44.353

这总是令人不安：

```
std::vector <std::vector <int> >
                              ^
                              mandatory space. 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-02-16T03:47:48.467

当使用`System.DirectoryServices`名称空间绑定到 ADAM（Active Directory 应用程序模式；我认为现在称为 AD LDS）时，我花了一整天的时间来调试这个简单的代码：

```
 DirectoryEntry rootDSE = new DirectoryEntry(
    "ldap://192.168.10.78:50000/RootDSE",
    login, 
    password, 
    AuthenticationTypes.None); 
```

当我运行代码时，我不断收到`COMException`错误 0x80005000，这有助于映射到“未知错误”。

我可以使用登录名和密码并通过 ADSI Edit 绑定到端口。但是这行简单的代码行不通。奇怪的防火墙权限？配置有问题？某些 COM 对象未正确注册？*为什么它不工作？*

答案？它是 LDAP://，而不是 ldap://。

这就是我们喝酒的原因。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-02-16T03:26:10.000

**C++**

```
class Foo
{
    // Lots of stuff here.
} bar; 
```

的声明`bar`非常难看。在 C 中更常见，但在 C++ 中尤其令人讨厌。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-02-16T03:46:42.603

Perl 的语法不久前给我带来了糟糕的一天：

```
%table = {
  foo => 1,
  bar => 2
}; 
```

如果没有适当的警告（在我使用的平台上不可用），这会创建一个单元素哈希，其中 key 作为给定的哈希引用和 value `undef`。注意 的 微妙使用`{}`，它创建了一个新的哈希引用，而不是`()`，它是一个用于填充`%table`哈希的数组。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-02-16T03:38:15.447

第一次看到 Python 的准三元运算符不是语法错误时，我感到很震惊：

```
X if Y else Z 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-02-16T03:19:43.667

这是愚蠢和常见的，但这种语法：

```
if ( x = y ) {
    // do something
} 
```

在过去的一年里，我用几种不同的语言抓住了我大约 3 次。我真的很喜欢 R 语言使用 <- 进行赋值的约定，如下所示：

```
x <- y 
```

如果 x = y 语法意味着 x == y，x <- y 意味着分配，我的大脑会在数学和编程之间进行更顺畅的转换。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-02-16T03:17:07.010

CS ？？操作员第一次看到它时就把我扔了一个循环。本质上，如果它不为空，它将返回 LHS，如果 LHS 为空，它将返回 RHS。

```
object bar = null;
object foo = bar ?? new Student();  // gets new Student() 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2009-02-16T03:41:34.347

C/C++ 的位向量语法。最糟糕的部分是试图简单地根据语法搜索它。

```
struct C {
  unsigned int v1 : 12;
  unsigned int v2 : 1;
}; 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-02-16T04:01:54.610

Powershell的函数调用语义

```
function foo() { 
  params ($count, $name);
  ...
}

foo (5, "name") 
```

对于那里的非powershellers。这会起作用，但不会像您期望的那样起作用。它实际上创建了一个数组并将其作为第一个参数传递。第二个参数没有明确的价值。正确的版本是

```
foo 5 "name" 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-02-16T04:53:23.737

第一次看到 C++ 中的函数指针时，我感到很困惑。更糟糕的是，因为语法没有关键词，所以很难查。为此，在搜索引擎中究竟输入了什么？

int (*Foo)(float, char, char);

我最终不得不问当地的 C++ 大师它是什么。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-02-16T05:56:09.797

VB（是的，是的，我必须使用它）“And”关键字 - 如：

```
If Object IsNot Nothing And Object.Property  Then 
```

在我确定对象不为 NULL 之后，请参阅该 Object.Property 参考？好吧，VB 的“And”关键字 * 不会 * 不会 * 阻止 * 进一步 * 评估，因此代码将失败。

然而，VB 确实有另一个关键字 - AndAlso：

```
If Object IsNot Nothing AndAlso Object.Property Then 
```

这将按您的预期工作，并且在运行时不会爆炸。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-11-21T23:23:01.243

C 的逗号运算符对我来说似乎不是很晦涩：我一直都看到它，如果没有，我可以在 K&R 的索引中查找“逗号”。

现在，三元组是另一回事......

```
void main() { printf("wat??!\n"); }  // doesn't print "wat??!" 
```

维基百科有一些很好的例子，来自真正令人困惑的：

```
// Will the next line be executed????????????????/
a++; 
```

到奇怪的有效：

```
/??/
* A comment *??/
/ 
```

甚至不要让我开始使用有向图。如果这里有人可以从记忆中完全解释 C 的有向图，我会感到惊讶。快，C 有哪些有向图，它们在解析中与三联图有何不同？

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-02-16T03:20:24.647

我曾经对一些声明对局部变量的引用但从未使用它的 C++ 代码感到非常困惑。就像是

```
MyLock &foo; 
```

（让我在语法上稍微松懈一下，我已经将近 8 年没有做过 C++了）

取出那个看似未使用的变量会使程序开始以与这个“未使用”变量无关的晦涩方式死亡。所以我做了一些挖掘，发现该类的默认 ctor 抓住了一个线程锁，并且 dtor 释放了它。这个变量在看似没有做任何事情的情况下保护代码免受同时更新。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-02-17T06:40:09.493

**Javascript：**这种语法...

```
for(i in someArray) 
```

... 用于循环遍历数组，或者我是这么认为的。一切正常，直到另一个团队成员掉入 MooTools，然后我的所有循环都被破坏了，因为`for(i in ...)`语法还覆盖了已添加到数组对象的额外方法。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2009-08-09T20:36:49.590

不得不将一些科学代码从旧的**FORTRAN**翻译成 C。一些毁了我一天的事情：

**打卡压痕。**每行的前 6 个字符保留用于控制字符、转到标签、*注释*等：

```
^^^^^^[code starts here]
c     [commented line] 
```

**Goto 风格的循环编号**（加上 6 个空格缩进）：

```
 do 20, i=0,10
          do 10, j=0,10
             do_stuff(i,j)

    10         continue
    20         continue 
```

现在想象有多个嵌套循环（即`do 20`to `do 30`），它们没有区分缩进来知道你所处的上下文。哦，终止语句在数百行之外。

**格式化语句**，再次使用 goto 标签。代码写入文件（有用的数字 1,2 等）。要将 a,b,c 的值写入文件，我们有：

```
write (1,51) a,b,c 
```

因此，这会在标有标签 51 的行使用格式语句将 a、b、c 写入文件 1：

```
51      format (f10.3,f10.3,f10.3) 
```

这些`format`行距它们被调用的地方有数百行。这因作者决定使用以下方式打印换行符而变得复杂：

```
write (1,51) [nothing here] 
```

小组中的一位讲师可靠地告诉我，我很容易下车。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-02-17T06:16:17.383

老歌：

在 PL/1 中没有保留字，因此您可以定义与语言关键字同名的变量、方法等。

这可以是有效的代码行：

```
IF ELSE THEN IF ELSE THEN 
```

（ELSE 是布尔值，IF 和 THEN 显然是函数。）

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-02-16T05:42:01.920

在启用 /clr 的 C++ 中这样的语法。尝试在 C++ 中创建托管字典对象。

```
gcroot<字典<System::String^, MyObj^>^> m_myObjs;

```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-02-17T05:50:27.243

不是很晦涩，但是每当我用一种语言编写太多代码，然后又回到另一种语言时，我就会开始弄乱后者的语法。当我意识到 C 中的“#if”不是注释（而是更致命的东西），并且 Python 中的行不需要以分号结尾时，我总是自嘲。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-02-16T03:46:12.697

Iif(condition, expression, expression) 是函数调用，而不是运算符。

条件的两边总是被评估。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-02-16T05:41:22.483

PHP 的三元运算符从左到右关联。有一天我在学习 PHP 时，这让我非常痛苦。在过去的 10 年中，我一直在使用 C/C++ 编程，其中三元运算符从右到左关联。

我仍然有点好奇为什么 PHP 的设计者选择这样做，而在许多其他方面，PHP 的语法与 C/C++ 相当接近。

编辑：现在我只在胁迫下使用 PHP。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-02-16T06:00:20.567

如果我必须读/写许多 HP 计算器中使用的某种[波兰符号，那总是会毁了我的一天……](http://en.wikipedia.org/wiki/Polish_notation)

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-11-21T22:36:48.560

**AT&T 汇编语法 >:(**

这种违反直觉、晦涩难懂的语法毁了我很多天，例如简单的 Intel 语法汇编指令：

```
mov dword es:[ebp-5], 1 /* Cool, put the value 1 into the 
                         * location of ebp minus five.
                         * this is so obvious and readable, and hard to mistake
                         * for anything else */ 
```

在 AT&T 语法中翻译成这个

```
movl $1, %es:-4(%ebp) /* huh? what's "l"? 4 bytes? 8 bytes? arch specific??
                       * wait, why are we moving 1 into -4 times ebp?
                       * or is this moving -4 * ebp into memory at address 0x01?
                       * oh wait, YES, I magically know that this is
                       * really setting 4 bytes at ebp-5 to 1! 
```

更多的...

```
mov dword [foo + eax*4], 123 /* Intel */
mov $123, foo(, %eax, 4)     /* AT&T, looks like a function call...
                              * there's no way in hell I'd know what this does
                              * without reading a full manual on this syntax */ 
```

和我的[最爱](http://blog.reverberate.org/2009/07/31/giving-up-on-att-style-assembler-syntax/)之一。

就好像他们采用了操作码编码方案并试图将其合并到编程语法中（阅读：scale/index/base），但也尝试在数据类型上添加一层抽象，并将该抽象合并到操作码名称中造成更大的混乱。我看不出任何人怎么能认真地用这个来编程。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2009-08-09T19:52:07.870

在对一些 C++ 代码执行维护时，我曾经发现有人做过这样的事情：

```
for (i=0; i<10; i++)
{
   MyNumber += 1;
} 
```

是的，他们有一个循环可以将数字加 1 10 次。

为什么它毁了我的一天？肇事者早就离开了，我不得不修复他们的模块。我想如果他们做这样的事情，天知道我还会遇到什么！

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-02-17T06:29:18.070

在用于诉讼文件审查的独立数据库软件 (Concordance) 的脚本语言 (Concordance Programming Language) 中，数组索引为 0，而（某些）字符串函数索引为 1。从那以后我再也没碰过它。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2010-09-30T13:55:04.140

GNU 扩展通常很有趣：

```
my_label:
  unsigned char *ptr = (unsigned char *)&&my_label;
  *ptr = 5; // Will it segfault?  Finding out is half the fun... 
```

成员指针的语法也让我很伤心，更多是因为我没有经常使用它，而不是因为它有什么真正棘手的地方：

```
template<typename T, int T::* P>
function(T& t)
{
  t.*P = 5;
} 
```

但是，真的，谁需要讨论 C++ 中晦涩的语法呢？通过运算符重载，您可以发明自己的！

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2009-08-09T19:45:18.337

[这](http://www.parashift.com/c++-faq-lite/ctors.html#faq-10.19). 我不止一次遇到过它。

# c++ - 如何在 C++ 中读取特定大小并存储未知类型的数据？

> ID：552131
> 
> 赞同：0
> 
> 时间：2009-02-16T03:09:40.070
> 
> 标签：c++, casting

我正在尝试从二进制文件中读取数据，然后存储在数据结构中以备后用。问题是我不想在读取和存储它时准确地确定它是什么类型。我只想存储有关它是什么类型的数据以及有多少这种特定类型的数据的信息（在该数据的前几个字节中很容易获得信息）

但是，我如何才能只读取一定数量的数据，而不管它是什么类型，并且以后仍然能够轻松地将这些数据转换（或类似的东西）为可读形式？

我的第一个想法是使用字符，因为我要查看的所有数据都将以字节为单位。

但如果我做了这样的事情：

```
ifstream fileStream;
fileStream.open("fileName.tiff", ios::binary);
//if I had to read in 4 bytes of data
char memory[4];
fileStream.read((char *)&memory, 4); 
```

但是，如果我后来想读这个并且知道它是双精度的，我怎么能转换这 4 个字节呢？

读取未知类型但知道大小供以后使用的数据的最佳方法是什么？火流。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T03:26:01.030

我认为 a`reinterpret_cast`会给你你所需要的。如果您有一个`char *`字节，您可以执行以下操作：

```
double * x = reinterpret_cast<double *>(dataPtr); 
```

查看[cplusplus.com 上的 Type Casting 以](http://www.cplusplus.com/doc/tutorial/typecasting.html)获得更详细的`reinterpret_cast`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T03:20:58.357

您可以将其复制到已知的数据结构中，这样以后的生活会更轻松：

```
double x;
memcpy (&x,memory,sizeof(double)); 
```

或者您可以将其称为强制转换值：

```
if (*((double*)(memory)) == 4.0) {
    // blah blah blah
} 
```

我相信 a`char*`是读取它的最佳方式，因为 char 的大小保证为 1 个单位（不一定是字节，但所有其他数据类型都是根据该单位定义的，因此，如果 sizeof(double ) == 27，你知道它将适合 char[27])。所以，如果你有一个已知的大小，这是最简单的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T03:33:18.873

您可以使用结构和匿名联合：

```
struct Variant
{
    size_t size;

    enum
    {
        TYPE_DOUBLE,
        TYPE_INT,
    } type;

    union
    {
        char raw[0];  // Copy to here. *

        double asDouble;
        int asInt;
    };
}; 
```

**可选**：创建类型 => 大小的表，以便您可以在运行时找到给定类型的大小。这仅在阅读时需要。

```
 static unsigned char typeSizes[2] =
    {
        sizeof(double),
        sizeof(int),
    }; 
```

用法：

```
Variant v;
v.type = Variant::TYPE_DOUBLE;
v.size = Variant::typeSizes[v.type];
fileStream.read(v.raw, v.size);

printf("%f\n", v.asDouble); 
```

您可能会收到有关类型双关语的警告。阅读：**这样做是不可移植的并且违反标准！** 再说一次，`reinterpret_cast`C 风格的铸造等也是如此。

*注意：第一次编辑，我没有阅读您的原始问题。我只有联合，而不是大小或类型部分。*

*这是我很久以前学到的一个巧妙的技巧。基本上，`raw`不占用任何字节（因此不会增加联合的大小），但提供指向联合中某个位置的指针（在本例中为开头）。在描述文件结构时非常有用：

```
struct Bitmap
{
    // Header stuff.
    uint32_t dataSize;

    RGBPixel data[0];
}; 
```

然后，您可以`fread`将数据放入一个`Bitmap`. =]

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T03:45:53.883

您可以将数据存储在一个类中，该类提供将其转换为可能的结果类型的函数，如下所示：

```
enum data_type {
  TYPE_DOUBLE,
  TYPE_INT
};

class data {
public:
  data_type type;
  size_t len;
  char *buffer;

  data(data_type a_type, char *a_buffer, size_t a_len)
      : type(a_type), buffer(NULL), len(a_len) {
    buffer = new char[a_len];
    memcpy(buffer, a_buffer, a_len);
  }
  ~data() {
    delete[] buffer;
  }

  double as_double() {
    assert(TYPE_DOUBLE == type);
    assert(len >= sizeof(double));
    return *reinterpret_cast<double*>(buffer);
  }

  int as_int() {...}
}; 
```

稍后你会做这样的事情：

```
data d = ...;
switch (d.type) {
case TYPE_DOUBLE:
   something(d.as_double());
   break;
case TYPE_INT:
   something_else(d.as_int());
   break;
...
} 
```

这至少是我做这些事情的方式:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-16T03:56:28.040

当心。在我知道的大多数环境中，双精度数是 8 个字节，而不是 4 个；`reinterpret_cast`根据后面的四个字节包含`memory`的内容，将其转换为双精度会导致垃圾。`memory`如果你想要一个 32 位浮点值，你可能想要一个浮点数（尽管我应该注意到 C++ 标准不需要它`float`并且`double`以任何方式表示，特别是不需要符合 IEEE-754）。

此外，除非您在代码中考虑字节序，否则您的代码将不可移植。我看到 TIFF 格式在其前两个字节中有一个字节序标记，它应该告诉您您是在读取大端还是小端值。

所以我会用以下原型编写一个函数：

```
template<typename VALUE_TYPE> VALUE_TYPE convert(char* input); 
```

如果您想要完全可移植性，请专门化模板并让它实际解释`input`. 否则，您可能会侥幸逃脱，例如

```
template<VALUE_TYPE> VALUE_TYPE convert(char* input) {
  return reinterpret_cast<double>(input);
} 
```

# performance - 为什么通过引用传递结构不是一种常见的优化？

> ID：552134
> 
> 赞同：33
> 
> 时间：2009-02-16T03:12:30.033
> 
> 标签：performance, optimization, compiler-construction, assembly, struct

直到今天，我一直认为体面的编译器会自动将 struct pass-by-value 转换为 pass-by-reference，如果结构足够大，后者会更快。据我所知，这似乎是一个不费吹灰之力的优化。[然而，为了满足我对这是否真的发生的好奇心，我在 C++ 和D](http://www.digitalmars.com/d/1.0)中创建了一个简单的测试用例，并查看了 GCC 和 Digital Mars D 的输出。两者都坚持按值传递 32 字节结构，而所有的有问题的函数是将成员相加并返回值，没有修改传入的结构。C++ 版本如下。

```
#include "iostream.h"

struct S {
    int i, j, k, l, m, n, o, p;
};

int foo(S s) {
    return s.i + s.j + s.k + s.l + s.m + s.n + s.o + s.p;
}

int main() {
    S s;
    int bar = foo(s);
    cout << bar;
} 
```

我的问题是，为什么编译器不会优化这样的东西以传递引用而不是实际将所有这些`int`s 推入堆栈？

注意：使用的编译器开关：GCC -O2（-O3 内联 foo().），DMD -O -inline -release。

编辑：显然，在一般情况下，按值传递与按引用传递的语义不会相同，例如是否涉及复制构造函数或在被调用者中修改了原始结构。然而，在许多现实世界的场景中，语义在可观察行为方面是相同的。这些是我要问的情况。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-02-16T03:29:26.577

不要忘记，在 C/C++ 中，编译器需要能够编译仅基于函数声明的函数调用。

鉴于调用者可能只使用该信息，编译器无法编译该函数以利用您正在谈论的优化。调用者不知道该函数不会修改任何内容，因此它不能通过 ref 传递。由于某些调用者可能由于缺乏详细信息而按值传递，因此必须假设按值传递来编译函数，并且每个人都需要按值传递。

请注意，即使您将参数标记为 ' `const`'，编译器仍然无法执行优化，因为函数可能会撒谎并丢弃 const （只要传入的对象是实际上不是const）。

我认为对于静态函数（或匿名命名空间中的函数），编译器可能会进行您所说的优化，因为该函数没有外部链接。只要函数的地址没有传递给其他例程或存储在指针中，它就不能被其他代码调用。在这种情况下，编译器可以完全了解所有调用者，所以我想它可以进行优化。

我不确定是否有（实际上，如果有的话，我会感到惊讶，因为它可能不会经常应用）。

当然，作为程序员（使用 C++ 时），您可以强制编译器通过`const&`尽可能使用参数来执行此优化。我知道你在问为什么编译器不能自动完成，但我想这是下一个最好的事情。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-16T03:21:29.370

问题是您要求编译器对用户代码的意图做出决定。也许我希望我的超大结构按值传递，以便我可以在复制构造函数中做一些事情。相信我，对于这种情况，有些人确实需要在复制构造函数中调用某些东西。切换到 by ref 将绕过复制构造函数。

让它成为编译器生成的决定将是一个坏主意。原因是它无法推理代码的流程。你不能看一个电话就知道它到底会做什么。您必须 a) 了解代码 b) 猜测编译器优化。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-16T03:19:30.267

一个答案是编译器需要检测被调用的方法不会以任何方式修改结构的内容。如果是这样，那么按引用传递的效果将不同于按值传递的效果。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-16T03:22:28.807

确实，如果某些语言的编译器可以访问被调用的函数并且可以假设被调用的函数不会更改，则它们可以这样做。这有时被称为全局优化，似乎某些 C 或 C++ 编译器实际上会优化诸如此类的情况 - 更有可能是通过内联此类微不足道的函数的代码。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-16T04:17:58.893

我认为这绝对是您可以实施的优化（在某些假设下，请参见最后一段），但我不清楚它是否会盈利。与其将参数压入堆栈（或通过寄存器传递它们，取决于调用约定），不如压入一个指针，通过该指针读取值。这种额外的间接将花费周期。它还要求传递的参数在内存中（所以你可以指向它）而不是在寄存器中。只有当被传递的记录有很多字段并且接收记录的函数只读取其中的几个时，这才是有益的。间接浪费的额外周期必须弥补没有通过推送不需要的字段而浪费的周期。

您可能会惊讶于反向优化，[参数提升](http://llvm.org/docs/Passes.html#argpromotion)，实际上是在 LLVM 中实现的。这会将引用参数转换为值参数（或聚合为标量），用于具有少量仅读取字段的内部函数。这对于通过引用传递几乎所有内容的语言特别有用。如果您按照此操作[消除死参数](http://llvm.org/docs/Passes.html#deadargelim)，您也不必传递未触及的字段。

值得一提的是，改变函数调用方式的优化只有在被优化的函数在被编译的模块内部时才能起作用（你可以通过在 C 中声明一个函数`static`并在 C++ 中使用模板来实现这一点）。优化器不仅要修复函数，还要修复所有调用点。这使得此类优化的范围相当有限，除非您在链接时执行它们。此外，当涉及复制构造函数时（正如其他海报所提到的），永远不会调用优化，因为它可能会改变程序的语义，这是一个好的优化器永远不应该做的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-16T03:26:16.130

按值传递的原因有很多，让编译器优化您的意图可能会破坏您的代码。

例如，如果被调用函数以任何方式修改结构。如果您打算将结果传递回调用者，那么您可以传递一个指针/引用或自己返回它。

您要求编译器做的是更改代码的**行为**，这将被视为编译器错误。

如果您想进行优化并通过引用传递，那么一定要修改某人现有的函数/方法定义以接受引用；这并不难做到。您可能会对自己造成的损坏感到惊讶而没有意识到这一点。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-16T03:33:55.660

从按值更改为按引用将更改函数的签名。如果函数不是静态的，这将导致其他编译单元的链接错误，这些编译单元不知道您所做的优化。
实际上，进行这种优化的唯一方法是通过某种链接后全局优化阶段。众所周知，这些很难做到，但一些编译器在某种程度上做到了。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-16T04:41:22.377

引用传递只是地址传递/指针传递的语法糖。所以函数必须隐式地取消引用一个指针来读取参数的值。取消引用指针可能比按值复制的结构副本更昂贵（如果在循环中）。

更重要的是，就像其他人提到的那样，按引用传递与按值传递具有不同的语义。`const`引用*并不*意味着引用的值不会改变。其他函数调用可能会更改引用的值。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-07-20T00:20:12.433

`struct`即使函数声明表明按值传递，有效地按引用传递*也是*一种常见的优化：只是它通常通过内联间接发生，因此从生成的代码中并不明显。

但是，要做到这一点，编译器需要知道*被调用者在**编译调用者时*不会修改传递的对象。否则，它将受到平台/语言 ABI 的限制，该 ABI 准确地规定了值如何传递给函数。

## 即使没有内联也*可能发生！*

尽管如此，即使在没有内联的情况下，一些编译器**也确实**实现了这种优化，尽管情况相对有限，至少在使用 SysV ABI（Linux、OSX 等）的平台上，由于堆栈布局的限制。考虑以下简单示例，直接基于您的代码：

```
__attribute__((noinline))
int foo(S s) {
    return s.i + s.j + s.k + s.l + s.m + s.n + s.o + s.p;
}

int bar(S s) {
    return foo(s);
} 
```

在这里，在语言级别`bar`调用`foo`具有 C++ 所需的按值传递语义。但是，如果我们检查[gcc 生成的程序集](https://godbolt.org/g/arWT4n)，它看起来像这样：

```
foo(S):
        mov     eax, DWORD PTR [rsp+12]
        add     eax, DWORD PTR [rsp+8]
        add     eax, DWORD PTR [rsp+16]
        add     eax, DWORD PTR [rsp+20]
        add     eax, DWORD PTR [rsp+24]
        add     eax, DWORD PTR [rsp+28]
        add     eax, DWORD PTR [rsp+32]
        add     eax, DWORD PTR [rsp+36]
        ret
bar(S):
        jmp     foo(S) 
```

请注意，`bar`只是直接调用`foo`，而不制作副本：`bar`将使用`s`传递给`bar`（在堆栈上）的相同副本。特别是*它不会*像语言语义所暗示的那样进行任何复制（忽略*as if*）。所以 gcc 已经完全按照您的要求进行了优化。但是 Clang 并没有这样做：它在它传递给`foo()`.

不幸的是，这可以工作的情况相当有限：SysV 要求这些大型结构在堆栈中的特定位置传递，因此只有当被调用者期望对象位于完全相同的位置时，才能进行这种重用。

这在`foo/bar`示例中是可能的，因为 bar 以`S`与 相同的方式将其作为第一个参数`foo`，`bar`并进行[尾调用](https://en.wikipedia.org/wiki/Tail_call)，`foo`避免了隐式返回地址推送的需要，否则会破坏重用堆栈参数的能力。

例如，如果我们简单地将 a 添加`+ 1`到对 的调用中`foo`：

```
int bar(S s) {
    return foo(s) + 1;
} 
```

这个技巧被破坏了，因为现在的位置与它所期望`bar::s`的位置不同，我们需要一个副本：`foo``s`

```
bar(S):
        push    QWORD PTR [rsp+32]
        push    QWORD PTR [rsp+32]
        push    QWORD PTR [rsp+32]
        push    QWORD PTR [rsp+32]
        call    foo(S)
        add     rsp, 32
        add     eax, 1
        ret 
```

这并不意味着调用者`bar()`必须完全微不足道。例如，它可以在传递它之前修改它的 s 副本：

```
int bar(S s) {
    s.i += 1;
    return foo(s);
} 
```

...并且优化将被保留：

```
bar(S):
        add     DWORD PTR [rsp+8], 1
        jmp     foo(S) 
```

原则上，这种优化的可能性在使用隐藏指针传递大型结构的 Win64 调用约定中要大得多。这为重用堆栈或其他地方的现有结构提供了更大的灵活性，以便在幕后实现传递引用。

## 内联

然而，除此之外，这种优化发生的*主要方式是通过内联。*

例如，在`-O2`编译时，所有 clang、gcc 和 MSVC[都不会复制 S 对象](https://godbolt.org/g/JJciQJ)¹。clang 和 gcc 都没有真正创建对象，只是或多或少地直接计算结果，甚至没有引用未使用的字段。MSVC 确实为副本分配了堆栈空间，但从不使用它：它只填写 only 的一个副本`S`并从中读取，就像传递引用一样（在这种情况下，MSVC 生成的代码比其他两个编译器差得多）。

请注意，即使`foo`被内联到`main`编译器中，*也会*生成该`foo()`函数的单独独立副本，因为它具有外部链接，因此可以被此目标文件使用。在此，编译器受*应用程序二进制接口*的限制：SysV ABI（用于 Linux）或 Win64 ABI（用于 Windows）根据值的类型和大小准确定义了必须如何传递值。大型结构由隐藏指针传递，编译器在编译时必须尊重这一点`foo`。它还必须尊重编译某些调用者`foo`何时 foo 无法看到：因为它不知道`foo`会做什么。

因此，编译器几乎没有什么窗口可以进行有效的优化，将按值传递转换为按引用传递，因为：

1）如果它可以*同时*看到调用者和被调用者（`main`在`foo`你的例子中），如果被调用者足够小，很可能会被内联到调用者中，并且随着函数变大并且不可内联，效果诸如调用约定开销之类的固定成本变得相对较小。

2) 如果编译器不能同时看到调用者和被调用者²，它一般要根据平台ABI 分别编译。由于编译器不知道被调用者将做什么，因此在调用站点没有优化调用的范围，并且在被调用者内部没有优化的范围，因为编译器必须对调用者做了什么做出保守的假设。

* * *

¹我的示例比您的原始示例稍微复杂一些，以避免编译器完全优化所有内容（特别是，您访问未初始化的内存，因此您的程序甚至没有定义的行为）：我填充了一些`s`字段`argc`这是编译器无法预测的值。

²编译器可以“同时”看到两者通常意味着它们要么在同一个翻译单元中，要么正在使用链接时间优化。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-16T04:06:21.323

好吧，简单的答案是结构在内存中的位置不同，因此您传递的数据也不同。我认为更复杂的答案是线程。

您的编译器需要检测 a) foo 没有修改结构；b) foo 不对结构元素的物理位置进行任何计算；并且 c) 调用者或调用者生成的另一个线程在 foo 完成运行之前不会修改结构。

在您的示例中，可以想象编译器可以做这些事情 - 但节省的内存无关紧要，可能不值得猜测。如果您使用具有 200 万个元素的结构运行相同的程序会发生什么？

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-16T05:31:49.090

编译器需要确保传入的结构（在调用代码中命名）没有被修改

```
double x; // using non structs, oh-well

void Foo(double d)
{
      x += d; // ok
      x += d; // Oops
}

void main()
{
     x = 1;
     Foo(x);
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-07-19T17:58:27.827

在许多平台上，大型结构实际上是通过引用传递的，但是调用者将被期望传递对副本的引用，该函数可以随意操作¹，或者被调用的函数将被期望复制它接收到一个引用然后对副本执行任何操作的结构。

虽然在许多情况下实际上可以省略复制操作，但编译器通常很难证明可以消除这些操作。例如，给定：

```
struct FOO { ... };

void func1(struct FOO *foo1);
void func2(struct FOO foo2);

void test(void)
{
  struct FOO foo;
  func1(&foo);
  func2(foo);
} 
```

编译器无法知道`foo`在执行期间是否会被修改`func2`(`func1`可能已经将其副本`foo1`或从它派生的指针存储在文件范围对象中，然后由`func2`) 使用。但是，此类修改不应影响收到的`foo`（即）副本。如果通过引用传递并且没有复制，则影响的操作将不正确地影响.`foo2``func2``foo``func2``foo``foo2`

请注意， even`void func3(const struct FOO);`没有意义：被调用者被允许丢弃`const`，并且正常的 asm 调用约定仍然允许被调用者修改保存按值副本的内存。

不幸的是，单独检查调用者或被调用函数足以证明可以安全地省略复制操作的情况相对较少，而且在许多情况下，即使检查两者都不够。因此，用 pass-by-reference 代替 pass-by-value 是一个困难的优化，其回报通常不足以证明困难是合理的。

* * *

脚注 1：例如，Windows x64[通过非常量引用传递大于 8 字节的对象](https://msdn.microsoft.com/en-us/library/zthk2dkh.aspx)（被调用者“拥有”指向的内存）。这根本无助于避免复制。动机是使所有函数 args 每个都适合 8 个字节，以便它们在堆栈上形成一个数组（在将寄存器 args 溢出到影子空间之后），使可变参数函数易于实现。

相比之下，x86-64 System V 对大于 16 字节的对象执行问题描述的操作：将它们复制到堆栈。（较小的对象被打包到最多两个寄存器中。）

# json - json.js 和 json2.js 的区别

> ID：552135
> 
> 赞同：89
> 
> 时间：2009-02-16T03:15:35.110
> 
> 标签：json

有人能告诉我这两个 JSON 解析器有什么区别吗？

[https://github.com/douglascrockford/JSON-js/blob/master/json.js](https://github.com/douglascrockford/JSON-js/blob/master/json.js)
[https://github.com/douglascrockford/JSON-js/blob/master/json2.js](https://github.com/douglascrockford/JSON-js/blob/master/json2.js)

我有一个 2007-04-13 的 JSON 文件（它有诸如 等方法`parseJSON`）。我在任何新版本中都没有看到这些方法。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-02-16T03:30:06.307

从他们的代码：

```
// Augment the basic prototypes if they have not already been augmented.
// These forms are obsolete. It is recommended that JSON.stringify and
// JSON.parse be used instead.

if (!Object.prototype.toJSONString) {
    Object.prototype.toJSONString = function (filter) {
        return JSON.stringify(this, filter);
    };
    Object.prototype.parseJSON = function (filter) {
        return JSON.parse(this, filter);
    };
} 
```

我猜 parseJSON 已经过时了，因此新版本（json2）甚至不再使用它了。但是，如果您的代码使用`parseJSON`很多，您可以在某处添加这段代码以使其再次工作：

```
 Object.prototype.parseJSON = function (filter) {
        return JSON.parse(this, filter);
    }; 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-02-16T03:30:21.737

[在这里](http://swik.net/json2)引用：

“JSON2.js - 去年年底，Crockford 悄悄发布了他的 JSON API 的新版本，取代了他现有的 API。重要的区别在于它使用了单个基础对象。”

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2012-05-31T18:20:06.760

我还注意到 json2 字符串化数组与 json2007 不同。

在 json2007 中：

```
var array = [];
array[1] = "apple";
array[2] = "orange";
alert(array.toJSONString()); // Output: ["apple", "orange"]. 
```

在 json2 中：

```
var array = [];
array[1] = "apple";
array[2] = "orange";
alert(JSON.stringify(array)); // Output: [null, "apple", "orange"]. 
```

# wpf - 组合框未正确绑定到 SelectedItem

> ID：552149
> 
> 赞同：5
> 
> 时间：2009-02-16T03:25:56.287
> 
> 标签：wpf, combobox, selectedvalue

我有两个项目。一个正在工作，另一个没有，但是它们之间的差异并不是我认为“应该”有任何重要性的。第一个项目是损坏的，这是我正在尝试修复的项目。第二个项目是我在第一个项目根本不起作用时创建的一个小示例项目。当然，样本工作得很好。

这是第一个项目的视图。我删除了一堆“MainWindowTabControlStyle”，因为它只是损坏的组合框。我有理由确定问题不在于样式，因为它是来自正在运行的项目的复制和粘贴。

```
<Grid> 
<TabControl Style="{DynamicResource MainWindowTabControlStyle}"> 
    <TabItem Header="Tab 1"/> 
    <TabItem Header="Tab 2"/> 
</TabControl>
</Grid> 

<Style x:Key="MainWindowTabControlStyle" TargetType="{x:Type TabControl}"> 
... 
    <ComboBox  
        HorizontalAlignment="Right"  
        VerticalAlignment="Top"  
        IsSynchronizedWithCurrentItem="True"  
        ItemsSource="{Binding Path=Subscriptions, Mode=Default}"  
        SelectedItem="{Binding Path=SelectedSubscription, Mode=OneWayToSource}"  
        ItemTemplate="{DynamicResource SubscriptionsItemTemplate}"/> 
... 
</Style> 

<DataTemplate x:Key="SubscriptionsItemTemplate"> 
    <StackPanel Orientation="Horizontal"> 
        <TextBlock Text="{Binding Path=DisplayName, Mode=Default}"/> 
    </StackPanel> 
</DataTemplate> 
```

这是设置为 MainWindow 的 DataContext 的视图模型。ViewModelBase 类与 Josh Smith 在本月 MSDN 文章中编写的代码完全相同。

```
public sealed class MainWindowViewModel : ViewModelBase 
{ 
    public MainWindowViewModel() 
    { 
    } 

    private ObservableCollection<Subscription> subscriptions; 
    public ObservableCollection<Subscription> Subscriptions 
    { 
        get 
        { 
            if (subscriptions == null) 
            { 
                subscriptions = new ObservableCollection<Subscription>(); 
                subscriptions.Add(new Subscription() { DisplayName = "ABC" }); 
                subscriptions.Add(new Subscription() { DisplayName = "XYZ" }); 
                subscriptions.Add(new Subscription() { DisplayName = "PDQ" }); 
            } 

            return subscriptions; 
        } 
        set { subscriptions = value; } 
    } 

    private Subscription selectedSubscription; 
    public Subscription SelectedSubscription 
    { 
        get { return selectedSubscription; } 
        set { selectedSubscription = value; } 
    } 
} 
```

当我从调试器运行项目时，第一个调用的想法是订阅集合的 getter。然后在 SelectedSubscription 上调用 setter（它为空）。之后，我可以更改组合框中的选定项目，直到我的脸变成蓝色并且 SelectedSubscription 属性的设置器不会再次更改。请务必注意，组合框确实包含正确的值。

在第二个项目中，代码是相同的，但首先调用的是 SelectedSubscription 属性的 setter（它为 null），然后调用 Subscriptions 集合的 getter，最后第二次调用 SelectedSubscription 的 setter，它具有与 Subscriptions 集合中的第一项匹配的值。

如果您有任何想法我愿意尝试，这颗小宝石花了我大约 5 个小时。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T03:43:39.270

可能改变

```
SelectedItem="{Binding Path=SelectedSubscription, Mode=OneWayToSource}" 
```

到

```
SelectedItem="{Binding Path=SelectedSubscription, Mode=TwoWay}" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T18:07:47.760

调试此问题的正确方法是获取工作项目并交替（修改它以匹配损坏的代码/确认它工作），直到它与损坏的项目相同或损坏。它中断的点告诉你问题出在哪里。修改损坏的项目通常是一个失败的原因。

作为第二点，我建议将 System.Diagnostics 命名空间添加到您的 XAML。它会使错误出现在 Visual Studio 输出窗口中。

```
xmlns:debug="clr-namespace:System.Diagnostics;assembly=WindowsBase" 
```

作为一个可能相关的点（因为目前还不清楚损坏的项目中的问题是什么），您可能会查看与[以下内容相关的 StackOverflow 问题](https://stackoverflow.com/questions/546119/combobox-controling-tabcontrol)（“Combobox controling Tabcontrol”）：

*   WPF,
*   组合框，
*   选项卡控件，和
*   使用 SelectedIndex 在它们之间进行绑定。

这个问题还没有解决方案，但这是一个更简单的问题。

最后，[Josh Smith 的 MSDN 代码](http://code.msdn.microsoft.com/mag200902MVVM/Release/ProjectReleases.aspx?ReleaseId=2026)非常庞大。如果不查看所有代码，很难弄清楚添加 ComboBox 所做的更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T16:07:40.643

很抱歉延迟发布答案。启动和运行 Open ID 存在某种问题。

这是一个非常奇怪的问题。

这个问题的解决方案根本不是来自窗口。在调用窗口的 show 方法之前，有另一个窗口作为对话框打开。在此对话框中有以下资源

```
<Window.Resources>
    <DropShadowBitmapEffect x:Key="DropShadowEffect" Noise="0" Opacity="0.45" ShadowDepth="5" Softness="0.25"/>
</Window.Resources> 
```

它被同一窗口中的两个文本块引用为“DynamicResource”。关闭对话框并使应用程序从出现问题的窗口启动后，发现问题是由对话框窗口引起的。当我在研究这个问题时，一位同事建议我将 DynamicResource 转换为 StaticResource，因为它没有理由成为动态的。

使用仅在对话窗口范围内可用的资源在对话窗口中进行的此更改修复了上述“主窗口”中描述的绑定问题。我猜奇怪的事情可能会发生。

# php - 在服务器上检测 HTTPS 与 HTTP 发回没有用的东西

> ID：552162
> 
> 赞同：5
> 
> 时间：2009-02-16T03:30:44.060
> 
> 标签：php, apache, ssl, https

非常类似于“ [Detecting https requests in php](https://stackoverflow.com/questions/452375/detecting-https-requests-in-php "在php中检测https请求") ”：

想让[https://example.com/pog.php](https://example.com/pog.php)转到[http://example.com/pog.php](http://example.com/pog.php)，反之亦然。

问题：

*   无法从 $_SERVER["HTTPS"] 读取任何内容，因为它不存在
*   服务器通过端口 80 发送两个请求，因此无法在 HTTPS 版本上检查 443
*   `apache_request_headers()`并`apache_response_headers()`寄回同样的东西
*   不能告诉负载均衡器任何东西或让它发送额外的东西
*   页面在两个 URL 调用上吐出的服务器反馈数据与会话 ID 完全相同。真可惜。

是否有任何页面方法来检测它是通过 SSL 还是非 SSL 调用的？

**编辑**：`$_SERVER["HTTPS"]`不存在，打开与否，无论您是通过 SSL 还是非 SSL 查看站点。出于某种原因，主机选择为所有加密的 HTTPS 请求提供服务，但在端口 80 下。因此，`$_SERVER["HTTPS"]`它永远不会打开，不存在，只是在该服务器点上没有有用的反馈。因此该参数始终为空。

（是的，这意味着它会在 FF 或 Chrome 中被标记为部分无效的 SSL 证书。但这部分并不重要。）

此外，从检测 URL 中可以得到的最大结果是斜杠。PHP 看不到请求是否`https`在`http`前面。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-16T05:24:48.357

**关键字——负载均衡器**

问题归结为负载均衡器正在处理 SSL 加密/解密，并且对 Web 服务器完全透明。

```
Request:  Client -> 443or80 -> loadbalancer -> 80 -> php
Response: PHP -> 80 -> loadbalancer -> 443or80 -> Client 
```

*这里真正的问题是“您是否可以控制负载均衡器配置？”*

* * *

**如果你这样做了，**有几种方法可以处理它。将负载均衡器配置为具有单独的 HTTP 和 HTTPS 服务定义。然后将 HTTP 流量发送到 Web 服务器的 80 端口，将 HTTPS 流量发送到 Web 服务器的 81 端口。（端口 81 不被其他任何东西使用）。

在apache中，配置两个不同的虚拟主机：

```
<VirtualHost 1.2.3.4:80>
   ServerName foo.com
   SetEnv USING_HTTPS 0
   ...
</VirtualHost>

<VirtualHost 1.2.3.4:81>
   ServerName foo.com
   SetEnv USING_HTTPS 1
   ...
</VirtualHost> 
```

然后，环境变量`USING_HTTPS`将是`1`| `0`，取决于哪个虚拟主机选择了它。这将`$_SERVER`在 PHP 的数组中可用。这不是很酷吗？

* * *

**If you do not have access to the Load Balancer configuration**, then things are a bit trickier. There will not be a way to definitively know if you are using HTTP or HTTPS, because HTTP and HTTPS are **protocols**. They specify how to connect and what format to send information across, but in either case, you are using HTTP 1.1 to make the request. There is no information in the actual request to say if it is HTTP or HTTPS.

But don't lose heart. There are a couple of ideas.

The 6th parameter to PHP's `setcookie()` function can instruct a client to send the cookie ONLY over HTTPS connections ([http://www.php.net/setcookie](http://www.php.net/setcookie)). Perhaps you could set a cookie with this parameter and then check for it on subsequent requests?

另一种可能性是使用 JavaScript 根据协议更新每个页面上的链接（添加 GET 参数）。

*（以上都不是防弹的）*

另一个务实的选择是将您的 SSL 放在不同的域上，例如`secure.foo.com`. 然后你可以求助于上面的 VirtualHost 技巧。

* * *

我知道这不是最简单的问题，因为我在白天处理它（负载平衡 Web 集群在 Cisco CSS 负载均衡器后面，带有 SSL 模块）。

最后，您始终可以认为您的 Web 应用程序应在需要时切换到 SSL 模式，并相信用户不会将其移回（毕竟，在线应用程序（通常）是他们的数据）。

希望它有点帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-17T00:44:50.893

> $_SERVER["HTTPS"] 不存在，无论是否打开，无论您是通过 SSL 还是非 SSL 查看站点。出于某种原因，主机选择为所有加密的 HTTPS 请求提供服务，但在端口 80 下。因此，$_SERVER["HTTPS"] 永远不会打开，不存在，只是没有关于该服务器点的有用反馈。因此该参数始终为空。

您必须确保提供商在您网站的 VHOST 条目中有以下行： `SSLOptions +StdEnvVars`. 该行告诉 Apache 在您的脚本 (PHP) 环境中包含 SSL 变量。

# apache-flex - Flex Grid控件中如何实现拖放？

> ID：552170
> 
> 赞同：0
> 
> 时间：2009-02-16T03:34:29.510
> 
> 标签：apache-flex, drag-and-drop, flex-mx

我有一个简单的 Grid 控件，其中包含一些我希望能够四处移动的按钮。下面的代码确实有效，但实际进行拖放需要付出很多努力，并且不清楚拖放会发生在哪里。我必须移动鼠标很多才能达到不拒绝丢弃的状态。我将不胜感激有关如何使其更加“用户友好”的任何建议。

```
 <?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="vertical" verticalAlign="middle" horizontalAlign="center" height="200" width="200">
    <mx:Script>
        <![CDATA[
import mx.containers.GridItem;
import mx.controls.Button;
import mx.core.DragSource;
import mx.events.*;
import mx.managers.DragManager;

private function dragInit(event:MouseEvent):void
{
    if(event.buttonDown)
    {
        var button:Button = event.currentTarget as Button;
        var dragSource:DragSource = new DragSource();
        dragSource.addData(button, 'button');
        DragManager.doDrag(button, dragSource, event);
    }
}

private function dragEnter(event:DragEvent): void
{
    var target:GridItem = event.currentTarget as GridItem;
    if (event.dragSource.hasFormat('button') && target.getChildren().length == 0)
    {
        DragManager.acceptDragDrop(target);
        DragManager.showFeedback(DragManager.MOVE);
    }
}

private function dragDrop(event:DragEvent): void
{
    var target:GridItem = event.currentTarget as GridItem;
    var button:Button = event.dragSource.dataForFormat('button') as Button;
    target.addChild(button);
}           
        ]]>
    </mx:Script>

    <mx:Grid>
        <mx:GridRow width="100%" height="100%">
            <mx:GridItem width="44" height="44" dragEnter="dragEnter(event)" dragDrop="dragDrop(event)">
            </mx:GridItem>
            <mx:GridItem width="44" height="44" dragEnter="dragEnter(event)" dragDrop="dragDrop(event)">
            </mx:GridItem>
            <mx:GridItem width="44" height="44" dragEnter="dragEnter(event)" dragDrop="dragDrop(event)">
                <mx:Button label="A" width="40" height="40" mouseMove="dragInit(event)"/>
            </mx:GridItem>
        </mx:GridRow>
        <mx:GridRow width="100%" height="100%">
            <mx:GridItem width="44" height="44" dragEnter="dragEnter(event)" dragDrop="dragDrop(event)">
            </mx:GridItem>
            <mx:GridItem width="44" height="44" dragEnter="dragEnter(event)" dragDrop="dragDrop(event)">
                <mx:Button label="B" width="40" height="40" mouseMove="dragInit(event)"/>
            </mx:GridItem>
            <mx:GridItem width="44" height="44" dragEnter="dragEnter(event)" dragDrop="dragDrop(event)">
            </mx:GridItem>
        </mx:GridRow>
        <mx:GridRow width="100%" height="100%">
            <mx:GridItem width="44" height="44" dragEnter="dragEnter(event)" dragDrop="dragDrop(event)">
                <mx:Button label="C" width="40" height="40" mouseMove="dragInit(event)"/>
            </mx:GridItem>
            <mx:GridItem width="44" height="44" dragEnter="dragEnter(event)" dragDrop="dragDrop(event)">
            </mx:GridItem>
            <mx:GridItem width="44" height="44" dragEnter="dragEnter(event)" dragDrop="dragDrop(event)">
            </mx:GridItem>
        </mx:GridRow>
    </mx:Grid>
    <mx:Style>
GridItem
{
    borderColor: #A09999;
    borderStyle: solid;
    borderThickness: 2;
    horizontal-align: center;
    vertical-align: center;
}
Grid
{
    borderColor: #A09999;
    borderStyle: solid;
    borderThickness: 2;
    horizontalGap: 0;
    verticalGap: 0;
    horizontal-align: center;
    vertical-align: center;
}
    </mx:Style>
</mx:Application> 

```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T11:44:21.970

看起来每个空网格项仅存在于您定义的边界上（我不确定这是为什么，可能是容器的已知功能）。如果您为每个 GridItem 添加一个 backgroundColor，则 dragEnter 将在整个区域上触发，而不仅仅是该边框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T11:27:52.290

不幸的是，您必须处理所有这些事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T14:06:53.730

为 Grid 组件定义背景颜色。之后，您可以将按钮放在 GridItem 的中间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-18T02:56:21.193

只需放入`backgroundColor`您的`GridItem`:)

# mysql - MySQL表，什么是INDEX？

> ID：552174
> 
> 赞同：2
> 
> 时间：2009-02-16T03:36:33.297
> 
> 标签：mysql, indexing

我知道 PRIMARY 键具有唯一值，那么 INDEX 呢？带 INDEX 的表列的作用是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-16T03:46:57.203

INDEX 列正是如此。它们被编入索引，以便更快地使用该列查找信息。MySQL 通常将索引存储在 B-Tree 或 R-Tree 中。如果您定期在特定列（或列组）上使用 where 子句，则使用索引的适当情况。

索引是数据库书籍中值得整章的主题，开始寻找更多信息的好地方可能是[mysql 参考手册](http://dev.mysql.com/doc/refman/5.1/en/mysql-indexes.html)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-16T03:50:55.040

MySQL 中的 INDEX 执行的功能与 INDEX 在书末执行的功能相同。当您执行以下查询时，它可以更快地查找您的信息：

```
SELECT * FROM MY-DB-WITH-INDEXES> WHERE <INDEX_FIELD=foo_bar> 
```

用于形成索引的列的良好选择总是会产生良好的数据库设计。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T03:49:16.293

请看[这个对数据库中索引的好描述](http://en.wikipedia.org/wiki/Index_(database))

# matlab - 如何使用Matlab在空间中的两点之间连接一条固定长度的曲线？

> ID：552184
> 
> 赞同：0
> 
> 时间：2009-02-16T03:43:33.063
> 
> 标签：matlab

我们在 3d 空间中有两个点 (x1,y1,z1) 和 (x2,y2,z2)。我们有一条**固定长度**的曲线，要在这些点之间连接（不是直线）。Matlab中的代码如何进行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T00:11:58.023

如果您试图最小化机器人关节处的弯曲角度，那么最佳曲线将是圆弧。

令 L 为圆弧的长度，d 为端点之间的距离，theta 为圆弧角度的*一半*，r 为圆弧的半径。然后：

d/L = sin(theta)/theta ==> 使用 Matlab 的求解器之一为 theta 数值求解

一旦你有了 theta，圆弧的半径就是：r = L / (2 * theta)

在这个 r 和 theta 的两个端点之间仍然有无限数量的弧。您必须使用其他一些标准来选择要使用的点的滚动角度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T05:40:03.283

在不知道您尝试使用蛇（即活动轮廓）的情况下，我能做的最好的就是建议这些链接：

*   [活动轮廓、可变形模型和梯度矢量流](http://iacl.ece.jhu.edu/projects/gvf/)。
*   [Bregler 和 Slaney](http://cobweb.ecn.purdue.edu/~malcolm/interval/1995-017/)的一些主动轮廓建模。
*   [Shawn Lankton 的主动轮廓分割](http://www.mathworks.com/matlabcentral/fileexchange/19567)。
*   [Eric Debreuve 的主动轮廓工具箱](http://www.mathworks.com/matlabcentral/fileexchange/11643)。

我遇到的大多数活动轮廓的应用似乎更多地用于二维图像分割，但希望这些链接能给你一些起点。

# cocoa - RBSplitView 已延迟重新加载自动保存的视图位置

> ID：552186
> 
> 赞同：2
> 
> 时间：2009-02-16T03:43:49.020
> 
> 标签：cocoa, user-interface

我真的很喜欢使用 RBSplitView，它是 NSSplitView 的开源替代品，但我的运输应用程序出现问题，并且在一个新项目中再次遇到它。

问题是我告诉 RBSplitView 通过给它一个自动保存名称来自动保存它的位置状态。当我的应用程序启动时，RBSplitView 似乎直到绘制窗口后一秒钟才尊重保存的状态。

我整晚都在尝试调试这种行为，但收效甚微。那里有人使用这个库并有一些建议吗？

您可以将此快速电影擦洗到工作中的问题：

[http://media.clickablebliss.com/billable/interface_experiments/rbsplitview_delayed_autosave_reload2.mov](http://media.clickablebliss.com/billable/interface_experiments/rbsplitview_delayed_autosave_reload2.mov)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T19:16:54.800

我仍然无法弄清楚为什么会发生这种情况，但我确实有一个解决方法。

首先，确保您的主窗口在启动时不可见，然后在应用程序委托中的 applicationDidFinishLaunching 结束时添加如下内容：

[mainWindow performSelector:@selector(makeKeyAndOrderFront:) withObject:self afterDelay: 0.1];

延迟是关键。如果您只是告诉窗口 makeKeyAndOrderFront：我仍然看到问题。但是，只要它有一个节拍的时间，它看起来不错。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T15:19:20.850

在我的使用 RBSplitView 的应用程序中，我有一个类似但略有不同的解决方法。在 applicationDidFinishLaunching: 中，我在拆分视图上调用 adjustSubviews，然后在包含它的窗口上调用 makeKeyAndOrderFront:。这似乎在拆分视图显示在屏幕上之前将其按顺序排列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T02:26:42.923

这可能会发生，因为 RBSplitView 实例需要等到它第一次将其框架设置为自动保存的值，而这恰好是在用户可以看到它之后。这个 0.0-delay 技巧只是将窗口的显示延迟到下一个 runloop，这使拆分视图有机会发挥它的魔力（和其他视图），因此当用户看到窗口时，它已经很漂亮和性感了。所以只需在 0.0 处进行延迟就可以了。

# c# - simple xml parsing

> ID：552187
> 
> 赞同：9
> 
> 时间：2009-02-16T03:45:33.510
> 
> 标签：c#, .net, xml, parsing

what is the simplest way to parse the lat and long out of the following xml fragment. There is no namespace etc.

It is in a string variable. not a stream.

```
<poi>
      <city>stockholm</city>
      <country>sweden</country>
      <gpoint>
        <lat>51.1</lat>
        <lng>67.98</lng>
      </gpoint>
</poi> 
```

everything I have read so far is waaaaay too complex for what should be a simple task e.g. [http://geekswithblogs.net/kobush/archive/2006/04/20/75717.aspx](http://geekswithblogs.net/kobush/archive/2006/04/20/75717.aspx)

I've been looking at the above link

Surely there is a simpler way to do this in .net?

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-16T03:59:55.847

Using Linq for XML:

```
 XDocument doc= XDocument.Parse("<poi><city>stockholm</city><country>sweden</country><gpoint><lat>51.1</lat><lng>67.98</lng></gpoint></poi>");

    var points=doc.Descendants("gpoint");

    foreach (XElement current in points)
    {
        Console.WriteLine(current.Element("lat").Value);
        Console.WriteLine(current.Element("lng").Value);
    }

    Console.ReadKey(); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-16T03:55:36.420

```
using System.IO;
using System.Xml;
using System.Xml.XPath; 
```

. . .

```
 string xml = @"<poi>      
                     <city>stockholm</city>  
                     <country>sweden</countr>
                        <gpoint>        
                            <lat>51.1</lat>        
                            <lng>67.98</lng>    
                        </gpoint>
                   </poi>";

    XmlReaderSettings set = new XmlReaderSettings();
    set.ConformanceLevel = ConformanceLevel.Fragment;

    XPathDocument doc = 
        new XPathDocument(XmlReader.Create(new StringReader(xml), set));

    XPathNavigator nav = doc.CreateNavigator();

    Console.WriteLine(nav.SelectSingleNode("/poi/gpoint/lat"));
    Console.WriteLine(nav.SelectSingleNode("/poi/gpoint/lng")); 
```

You could of course use xpath `SelectSingleNode` to select the `<gpoint>` element into a variable.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-16T10:10:17.377

Even simpler than Mitch Wheat's answer, since the fragment in question is a well-formed XML document:

```
using System.Xml;
using System.IO;

...

string xml = @"<poi>
                  <city>stockholm</city>
                  <country>sweden</country>
                  <gpoint>
                    <lat>51.1</lat>
                    <lng>67.98</lng>
                  </gpoint>
              </poi>";

XmlDocument d = new XmlDocument();
d.Load(new StringReader(xml));
Console.WriteLine(d.SelectSingleNode("/poi/gpoint/lat").InnerText);
Console.WriteLine(d.SelectSingleNode("/poi/gpoint/lng").InnerText); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-16T04:18:21.230

If you can use LINQ for XML you can read those two values straight forward like this:

```
var doc = XDocument.Parse("...");
var point = doc.Element("poi").Element("gpoint");
Console.WriteLine("Lat: {0}, Lng: {1}",
    point.Element("lat").Value,
    point.Element("lng").Value); 
```

If you need them as double you have to convert them:

```
double lat = Convert.ToDouble(point.Element("lat").Value,
                 CultureInfo.InvariantCulture); 
```

Don't forget to specify a culture that uses a dot for fractions. Otherwise this would yield 511.0 as latitude.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-01-10T17:32:47.593

Use XElement.Parse(string text) method to do this.

Example:

```
string xmlString = @"<poi>
              <city>stockholm</city>
              <country>sweden</country>
              <gpoint>
                <lat>51.1</lat>
                <lng>67.98</lng>
              </gpoint>
          </poi>";
        try
        {
            XElement x = XElement.Parse(xmlString);
            var latLng = x.Element("gpoint");

            Console.WriteLine(latLng.Element("lat").Value);
            Console.WriteLine(latLng.Element("lng").Value);
        }
        catch
        {
        } 
```

Hope this helps!

# c - printf 语句出错？（在 C 中）*更新*

> ID：552191
> 
> 赞同：1
> 
> 时间：2009-02-16T03:46:24.007
> 
> 标签：c, printf, if-statement

为澄清起见，我需要程序打印为 a 和 b 输入的数字，而不是实际的字母 a 和 b。
好的，这是根据你们的建议修改后的程序：

```
int main (int argc, char *argv[])  
{
   int a; /*first number input*/  
   int b; /*second number input*/  

   a = atoi(argv[1]); /*assign to a*/  
   b = atoi(argv[2]); /*assign to b*/  

   if (a < b)  
      printf("%s\n", a < b); /* a is less than b*/  
      else {  
         printf("%s\n", a >= b); /* a is greater than or equal to b*/  
      }  

   if (a == b)  
      printf("%s\n", a == b);  /* a is equal to b*/  
      else {  
         printf("%s\n", a != b); /* a is not equal to b*/  
      }  

   return 0;  
} /* end function main*/ 
```

大声笑，现在当我运行程序时，我被告知

```
8 [main] a 2336 _cygtls::handle_exceptions: 转储状态时出错   
分段故障

```

这是什么意思？（如果你现在还没有注意到我对这些东西很绝望，哈哈）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-16T03:49:50.287

您要求`printf()`打印布尔表达式的值（对于真和假，它们总是分别解析为 1 或 0）。

您可能希望您的代码看起来更像：

```
if (a < b)
     printf("%s\n", "a < b"); /* a is less than b*/
else {
     printf("%s\n", "a >= b"); /* a is greater than or equal to b*/
} 
```

将结果显示为字符串。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-16T03:50:26.383

这一行：

```
if (a = b) 
```

不应该

```
if (a == b) 
```

同样在这里：

```
printf("%d\n", a = b);  /* a is equal to b*/ 
```

应该

```
printf("%d\n", a == b);  /* a is equal to b*/ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T04:30:40.890

根据您的编辑，我认为您正在寻找这个：

```
#include <stdio.h>

int main (int argc, char *argv[]) {
    int a; /*first number input*/
    int b; /*second number input*/

    a = atoi(argv[1]); /*assign to a*/
    b = atoi(argv[2]); /*assign to b*/

    if (a < b)
        printf("%d < %d\n", a, b); /* a is less than b*/
    else
        printf("%d >= %d\n", a, b); /* a is greater than or equal to b*/

    if (a == b)
        printf("%d == %d\n", a, b);  /* a is equal to b*/
    else
        printf("%d != %d\n", a, b); /* a is not equal to b*/

    return 0;
} 
```

这段代码：

```
wfarr@turing:~$ ./foo 1 2
1 < 2
1 != 2 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T04:22:13.953

```
printf("%s\n", a == b); 
```

"%s" 打印一个字符串。a == b 不是字符串，它是一个布尔表达式，结果为 1（真）或 0（假）。

因此，您的 printf() 尝试打印字符，直到它找到一个空字节，从布尔表达式的位置开始......灾难。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-16T03:51:48.813

您的问题是，您试图用逻辑表达式代替整数。以上所有（a > b）...评估为真或假（a = b 将 b 的值分配给 a 除外）。如果您尝试返回较大的值，您应该做的是以下内容：

```
 printf("%d\n", a > b ? a : b) 
```

这表示如果 a 大于 b，则打印 a，否则打印 b。

编辑：我认为您真正要寻找的是打印出“a > b”等字样。在这种情况下，将它们放在 printf 中。当您将 %d 放入 printf 时，它会将指定的整数值代入字符串中的该位置。

我相信您想要以下内容：

```
 if(a > b)
        printf("a > b\n");
    else
        printf("b >= a\n"); 
```

那是对的吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-16T04:31:52.120

我假设你想要这样的东西......

> **输入：**
> 
> a = 5, b = 7
> 
> **输出：**
> 
> 5 < 7
> 
> 5 != 7

如果是这样，您需要打印整数 a 和 b，以及介于两者之间的字符串以显示关系。

```
if( a < b ) {
    printf( "%d < %d\n", a, b );
}
else {
    printf( "%d >= %d\n", a, b );
}

// follow similar pattern for the next if/else block.. 
```

# java - 支持 mark() 和 reset() 的轻量级 java.io.InputStream 实现

> ID：552198
> 
> 赞同：2
> 
> 时间：2009-02-16T03:47:57.217
> 
> 标签：java, inputstream, reset

再会，

目前，我们将 ByteArrayInputStream 用于可重置的 InputStream。我的问题是它消耗了大量内存（与其他一些 InputStream 实现不同，它加载了它在内存中表示的所有字节）。

那么我的问题是，有没有支持 mark() 和 read() 的 InputStream 更轻量级的实现？

我也尝试在 commons-io 中搜索，但我没有看到任何内容。

谢谢，弗兰兹

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-16T04:01:25.547

使用 BufferedInputStream 对你有用吗？在不知道原始数据来自哪里（例如，为什么你有一个 ByteArrayInputStream）的情况下开始回答你的问题有点困难。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-12-10T18:45:54.853

我在解析数据时最常使用 PushbackInputStream，并且需要返回并重新读取数据。这是一个解释：

[http://tutorials.jenkov.com/java-io/pushbackinputstream.html](http://tutorials.jenkov.com/java-io/pushbackinputstream.html)

如果您需要基于字符的流，还有一个 PushbackReader。

# html - 使用 CSS 将两个透明列居中

> ID：552202
> 
> 赞同：0
> 
> 时间：2009-02-16T03:50:36.697
> 
> 标签：html, css

所以，直截了当，这就是我想要的（减去质量差）......

[http://www.hbperspective.com/alt3/site.jpg](http://www.hbperspective.com/alt3/site.jpg)

这就是我所拥有的...

[http://www.hbperspective.com/alt3/](http://www.hbperspective.com/alt3/)

我试图让这两个透明列在图片中居中。有了这个 CSS 布局，我花了很长时间弄清楚如何做到这一点而不会引起各种其他问题。这是我的造型...

```
* {
    padding: 0;
    margin: 0;
}

body {
    background: #000000 url('background_div.png') repeat-y center top;
    color: #ffffff;
    font-family: Arial, Helvetica, sans-serif; 
    margin: 0 auto;
}

#wrapper {
    background: url('background_header_transparent.png') no-repeat center top;
    width: 100%;
    display: table;
    overflow: hidden;
}

.overlay {
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    width: 100%;
    background: #000000;
    filter:alpha(opacity=50);
    -moz-opacity:0.5;
    -khtml-opacity: 0.5;
    opacity: 0.5;
}

.container {
    float: left;
    position: relative;
    margin-top: 100px;
}

.content {
    position: relative;
    float: left;
}

#contentColumn{
    width: 540px;
}

#sidebarColumn {
    width: 190px;
    margin-left: 20px;
    float: left;
    display: inline;
}

#contentColumn .content {
    width: 500px;
    padding: 10px;
}

#sidebarColumn .content {
    width: 170px;
    padding: 10px;
}

* html #contentColumn .overlay { height: expression(document.getElementById("contentColumn").offsetHeight); }
* html #sidebarColumn .overlay { height: expression(document.getElementById("sidebarColumn").offsetHeight); } 
```

标记非常简单，可能更容易从提供的链接中查看。所以，就像我说的那样，我现在不确定该怎么做才能让它按照我想要的方式工作。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T03:53:38.607

```
div#container {
  width:500px; /* Same width as both columns */
  margin:auto; /* Will center the container */
}
  div#col1 {
    float:left; /* allows side-by-side columns */
    width:250px;
  }
  div#col2 {
    float:left;
    width:250px;
  }
div.clear {
  clear:both; /* Stops columns from extending past border of container */
}

<div id="container">
  <div id="col1"></div>
  <div id="col2"></div>
  <div class="clear"></div>
</div> 
```

为了获得额外的荣誉，请避免使用表达式 :) 相反，通过 jQuery 之类的框架，使用 javascript 执行任何需要的逻辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T03:54:54.533

创建 CSS 列有很多陷阱，我建议使用框架而不是自己滚动。有很多问题是浏览器的被告，除非您检查 IE、FF、Safari、Opera 等，否则您可能看不到这些问题。

一些好的框架是：

*   [YUI 网格](http://developer.yahoo.com/yui/grids)
*   [蓝图 CSS](http://code.google.com/p/blueprintcss/)
*   [块（新实验）](http://github.com/stubbornella/blocks/tree/master)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T04:04:17.897

在 CSS 中居中的规则：

1.  你要居中的东西必须分配一个宽度
2.  该块上的边距必须分配给 auto

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T04:46:42.397

我让它在你的 FF3 和 IE7 网站上使用

```
div#wrapper { 
    width:800px; 
    margin: auto; 
}
div#contentColumn 
{ 
    margin-left: 20px;
} 
```

如果您想修复徽标（请参见右上角），则立即在包装器内添加一个额外的容器 div，并将上述宽度/边距应用于容器（如 Jonathan Sampson 所建议的那样。）

# .net - 在无状态 REST Web 服务环境中实现验证码

> ID：552204
> 
> 赞同：4
> 
> 时间：2009-02-16T03:50:46.260
> 
> 标签：.net, wcf, client-side, captcha

我正在处理的项目是一段静态 HTML，其中包含一些将调用 REST Web 服务的内联 JavaScript，这是我使用 .NET 3.5 WCF 自己创建的。

JavaScript 将从用户那里获取一些详细信息，包括电子邮件地址，然后通过 Ajax 将这些详细信息发送到 Web 服务。然后，Web 服务会将详细信息存储在数据库中。

由于这是一个网络服务，我很确定它是无状态的。

但是，该项目的要求是前端 JavaScript 也应该做一个验证码，以防止垃圾邮件。

该站点本身只会运行几周（最多 6 周），我认为这不足以让任何潜在的攻击者认真考虑关闭该站点。

出于这个原因，我考虑制作一个完全客户端的验证码，因为传统的验证码需要有状态的会话。

但是，我很想知道在无状态环境中通常会实施哪些安全措施，或者是否有人认为我对客户端验证码验证是否足够有误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T03:59:15.443

您甚至可能不需要验证码。许多垃圾邮件客户端太笨了，无法执行 Javascript 之类的东西。您可以尝试将隐藏输入设置为 Javascript 中的某个值。

如果您的网站只上线几周，那么我怀疑有人会建立一个可以解决这个问题的客户端。

也就是说，它会在没有 Javascript 的情况下搞砸用户，所以我建议在屏幕上放置一条 Javascript 删除的消息。这将具有相同的输入字段，但作为带有标签的复选框，说明他们需要检查它以不被忽略。

# wpf - WPF WebBrowser 控件中的 SWF - 自动接受摄像头/麦克风访问？

> ID：552206
> 
> 赞同：0
> 
> 时间：2009-02-16T03:51:01.593
> 
> 标签：wpf, activex, flash

我有一个带有 WPF WebBrowser 控件的应用程序，它显示一个 Flash 文件。Flash 文件用于网络摄像头/麦克风聊天。目前，每次加载闪光灯时，它都会显示一个对话框，询问是否允许使用麦克风和摄像头。

我怎样才能假装点击允许按钮来停止用这个问题来骚扰用户？它显然不可能在 Flash 或 WebBrowser 中本机，但我认为我可以将事件/消息发送到 WebBrowser 控件中的 ActiveX 对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T04:02:37.697

您必须创作一个完整的、本机 ActiveX 控件。托管代码将被沙盒化，并且无法进行任何 P/Invoke 调用。

另外，我怀疑/想知道在受保护模式 IE7/8 的情况下，是否即使使用完整 ActiveX 控件 + SendKeys（或其他等效项）的技巧也会失败。

请注意，在非常基本的层面上，您正试图规避闪存的安全策略——归根结底，这只是一种糟糕的形式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-01T14:29:03.997

如果你有管理员权限，你可以在本地机器上共享这个文件，然后导航到它，这将要求用户的权限，我试过了，但这是在内部应用程序上，我可以完全访问所有基础设施，确保您使用 IP 地址、file://127.0.0.1//ShareFolderName/file.swf 进行导航，并且不要使用机器名称或 localhost

如果您在剪切该文件时没有任何问题，这应该会有所帮助

# c - 这两个版本的代码（指针算法和 unicode）有什么区别？

> ID：552212
> 
> 赞同：0
> 
> 时间：2009-02-16T03:55:53.017
> 
> 标签：c, unicode, pointers

我正在使用 GCC 在 64 位 Solaris 系统上调试一些开源代码，它将 2字节字符 ( ) 转换`wchar_t`为 4 字节字符 ( `wchar_t`)。因为 Solaris 像其他一些 Unix 一样将 wchar_t 定义为 4 字节，而不是像 Windows 中的 2 字节。

现在我解决了这个问题，通过将指针算法放在两行上，但我不确定原始代码有什么问题。有什么线索吗？

**原始代码**

```
int StringCopy2to4bytes(const unsigned short* src, int src_size, 
                         unsigned int* dst, int dst_size)
{
 int cp_size = 0;

 const unsigned short *src_end = NULL;
 const unsigned int   *dst_end = NULL;

 unsigned int c1, c2;

 src_end = src + src_size;
 dst_end = dst + dst_size;

 while (src < src_end)
 {
     c1 = *src++;
     if ((c1 >= UNI_SUR_HIGH_START) && (c1 <= UNI_SUR_HIGH_END))
     {
         if (src < src_end)
         {
             c2 = *src;
             if ((c2 >= UNI_SUR_LOW_START) && (c2 <= UNI_SUR_LOW_END))
             {
                c1 = ((c1 - UNI_SUR_HIGH_START) << UNI_SHIFT) + 
                      (c1 - UNI_SUR_LOW_START )  + UNI_BASE;

                ++src;
             }
         } 
         else 
             return -1;
     } 

     if (dst >= dst_end) return -2;

     *dst++ = c1;

     cp_size++;
 }

 return cp_size;
} 
```

**固定代码**

```
int StringCopy2to4bytes(const unsigned short* src, int src_size, 
                         unsigned int* dst, int dst_size)
{
 int cp_size = 0;

 const unsigned short *src_end = NULL;
 const unsigned int   *dst_end = NULL;

 unsigned int c1, c2;

 src_end = src + src_size;
 dst_end = dst + dst_size;

 while (src < src_end)
 {
     c1 = *src; //FIX
     ++src;

     if ((c1 >= UNI_SUR_HIGH_START) && (c1 <= UNI_SUR_HIGH_END))
     {
         if (src < src_end)
         {
             c2 = *src;
             if ((c2 >= UNI_SUR_LOW_START) && (c2 <= UNI_SUR_LOW_END))
             {
                c1 = ((c1 - UNI_SUR_HIGH_START) << UNI_SHIFT) + 
                      (c1 - UNI_SUR_LOW_START )  + UNI_BASE;

                ++src;
             }
         } 
         else 
             return -1;
     } 

     if (dst >= dst_end) return -2;

     *dst = c1; //FIX
     ++dst;

     cp_size++;
 }

 return cp_size;
} 
```

**编辑**：为了记录，代码不是我的，我只是在使用它，并且恰好在调试它，并不是说它有很大的不同，但是源代码相当大，所以我正在尝试修复它使用镊子，而不是重构所有东西，无论如何错误都是错误，我需要修复它并向作者发送错误消息。

常数是：

```
/* unicode constants */
#define UNI_SHIFT             ((int) 10 )
#define UNI_BASE              ((unsigned int) 0x0010000UL)
#define UNI_MASK              ((unsigned int) 0x3FFUL)
#define UNI_REPLACEMENT_CHAR  ((unsigned int) 0x0000FFFD)
#define UNI_MAX_BMP           ((unsigned int) 0x0000FFFF)
#define UNI_MAX_UTF16         ((unsigned int) 0x0010FFFF)
#define UNI_MAX_UTF32         ((unsigned int) 0x7FFFFFFF)
#define UNI_MAX_LEGAL_UTF32   ((unsigned int) 0x0010FFFF)
#define UNI_SUR_HIGH_START    ((unsigned int) 0xD800)
#define UNI_SUR_HIGH_END      ((unsigned int) 0xDBFF)
#define UNI_SUR_LOW_START     ((unsigned int) 0xDC00)
#define UNI_SUR_LOW_END       ((unsigned int) 0xDFFF) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T04:10:51.077

此处编写的代码仍然存在错误 - 当您结合 c1 和 c2 时，您需要使用 c2！也就是说，在以下几行：

```
c1 = ((c1 - UNI_SUR_HIGH_START) << UNI_SHIFT) +
      (c1 - UNI_SUR_LOW_START ) + UNI_BASE; 
```

第三次出现的 c1 实际上应该是 c2。

此外，将 src_end 指针初始化为 null 然后再初始化为 src + src_size 似乎很愚蠢。为什么不直接到达那里？

此外，如果保留字符串的开头，则 cp_size 可能是多余的；然后它将与 (dst - initial_dst) 相同。

* * *

测试代码 - 使用 c1 到 c2 修复 - 在 Solaris 10 上使用第一个代码示例，使用 GCC 4.3.3。显示了 32 位和 64 位编译的结果。Unicode 标准第 3 章中的表 3.4 中的数据（从技术上讲，Unicode 5.0 而不是 5.1.0，但我认为这并不重要）。

```
enum { NULL = 0 };
enum { UNI_SUR_HIGH_START = 0xD800, UNI_SUR_HIGH_END = 0xDBFF,
       UNI_SUR_LOW_START  = 0xDC00, UNI_SUR_LOW_END  = 0xDFFF,
       UNI_SHIFT = 10, UNI_BASE = 0x10000 };

int StringCopy2to4bytes(const unsigned short* src, int src_size, 
                         unsigned int* dst, int dst_size)
{
 int cp_size = 0;

 const unsigned short *src_end = NULL;
 const unsigned int   *dst_end = NULL;

 unsigned int c1, c2;

 src_end = src + src_size;
 dst_end = dst + dst_size;

 while (src < src_end)
 {
     c1 = *src++;
     if ((c1 >= UNI_SUR_HIGH_START) && (c1 <= UNI_SUR_HIGH_END))
     {
         if (src < src_end)
         {
             c2 = *src;
             if ((c2 >= UNI_SUR_LOW_START) && (c2 <= UNI_SUR_LOW_END))
             {
                c1 = ((c1 - UNI_SUR_HIGH_START) << UNI_SHIFT) + 
                      (c2 - UNI_SUR_LOW_START )  + UNI_BASE;    /* Fixed */

                ++src;
             }
         } 
         else 
             return -1;
     } 

     if (dst >= dst_end) return -2;

     *dst++ = c1;

     cp_size++;
 }

 return cp_size;
}

#include <stdio.h>
#include <stdlib.h>

int main(void)
{
    unsigned short w2_chars[] = { 0x004D, 0x0430, 0x4E8C, 0xD800, 0xDF02, 0x004D };
    unsigned int   w4_wanted[] = { 0x00004D, 0x000430, 0x004E8C, 0x010302, 0x00004D };
    unsigned int   w4_actual[5];
    int w2_len = 6;
    int w4_len = 5;
    int w4_actlen;
    int i;
    int failed = 0;

    w4_actlen = StringCopy2to4bytes(w2_chars, w2_len, w4_actual, w4_len);
    if (w4_actlen != w4_len)
    {
        failed = 1;
        printf("Length mismatch: got %d, wanted %d\n", w4_actlen, w4_len);
    }
    for (i = 0; i < w4_len; i++)
    {
        if (w4_actual[i] != w4_wanted[i])
        {
            printf("Mismatch: index %d: wanted 0x%06X, actual 0x%06X\n",
                   i, w4_wanted[i], w4_actual[i]);
            failed = 1;
        }
    }
    if (failed == 0)
        printf("No problem observed\n");
    return((failed == 0) ? EXIT_SUCCESS : EXIT_FAILURE);
}

$ gcc -m32 -O utf.c -o utf32 && ./utf32
No problem observed
$ gcc -m64 -O utf.c -o utf64 && ./utf64
No problem observed
$ 
```

我想知道您的编译器或您的测试用例出了什么问题。

* * *

这是 StringCopy2to4bytes() 函数的修订版本。它检测并报告原始没有的错误情况 - 即当代理对的第二个字不是有效的低代理代码点时，它返回状态 -3。

```
int StringCopy2to4bytes(const unsigned short *src, int src_size, 
                        unsigned int *dst, int dst_size)
{
    const unsigned short *src_end = src + src_size;
    const unsigned int   *dst_end = dst + dst_size;
    const unsigned int   *dst0    = dst;

    while (src < src_end)
    {
        unsigned int c1 = *src++;
        if ((c1 >= UNI_SUR_HIGH_START) && (c1 <= UNI_SUR_HIGH_END))
        {
            if (src >= src_end)
                return -1;
            unsigned int c2 = *src++;
            if ((c2 >= UNI_SUR_LOW_START) && (c2 <= UNI_SUR_LOW_END))
            {
               c1 = ((c1 - UNI_SUR_HIGH_START) << UNI_SHIFT) + 
                     (c2 - UNI_SUR_LOW_START )  + UNI_BASE;    /* Fixed */
            }
            else
                return -3;  /* Invalid second code point in surrogate pair */
        } 
        if (dst >= dst_end)
            return -2; 
        *dst++ = c1;
    }
    return dst - dst0;
} 
```

相同的测试代码产生相同的干净的健康清单。c2 的声明假定您使用的是 C99，而不是 C89。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T05:52:37.043

这闻起来像我们可能需要一些 () 在这里。

看看区别

1.  c1 = *src++;
2.  c1 = (*src)++;
3.  c1 = *(src++);

我真的很喜欢 ()，因为它们消除了程序员想要做什么的一些歧义。

/约翰

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T04:09:31.220

应该没有区别，++绑定高于*。

快速 test.c 也没有任何区别：

```
#include <stdio.h>

int main()
{
    int a[] = { 0, 1, 2, 3, 4, 5 };
    int * p = a;
    printf( "%d\n", *p );
    printf( "%d\n", *p++ );
    printf( "%d\n", *p );
    printf( "%d\n", *(p++) );
    printf( "%d\n", *p );
    return 0;
} 
```

给出：

```
0
0
1
1
2 
```

是什么让您认为新代码修复了问题？

**编辑：在微不足道的事情****中**找到编译器错误是极不可能的。上面的测试是使用 GCC 4.1.2 运行的。

**编辑2：**那里有一些类型不匹配。c1 是 unsigned int，*src 是 unsigned short。大小应该是 size_t，而不是 int。如果您修复这些问题，原始代码的问题是否仍然存在？

# android - Android BaseAdapter：位置不是真正的位置？

> ID：552247
> 
> 赞同：4
> 
> 时间：2009-02-16T04:13:55.250
> 
> 标签：android, listview, adapter, base

当我使用 a 的列表视图`BaseAdapter`离开屏幕时，每一行不再保持连续的位置。除了这个，我不知道还能怎么解释。

如果我的 BA/LV 在屏幕上显示 4 个项目，并且我添加了一个显示每一行的 TextView 的视图，它会显示 0、1、2、3 的行号（这是正确的）。但是，一旦我将列表向下滚动到底部的 4 项（第 5-8 项），它就会显示为 4,5,0,1?? 为什么？

**编辑：** 我确实发现如果我改变

`rv = (RowView) convertView`;

到

```
rv =  new RowView(mContext,(cursor.getString(2)),
                        (cursor.getString(5)),
                        cursor.getString(cursor.getColumnIndex(DBHelper.KEY_IMAGEFILENAME)),
                        cursor.getString(cursor.getColumnIndex(DBHelper.KEY_CITY)),position); 
```

它可以工作，但是它没有重新使用代码。所以，我想我是在正确的轨道上。我确实尝试了一些方便的方法，但这对我没有太大帮助，因为我需要在构造函数触发之前设置这些值。我是否需要创建一个新方法并在最后触发它？比如`addRow`方法？这也导致它滚动非常慢。

```
 @Override
               public void onCreate(Bundle bundle)
               {
                 super.onCreate(bundle);
                 //setContentView(R.layout.findlist);
                 //getListView().setEmptyView(findViewById(R.id.empty));
                 mDbHelper = new DBHelper(this);
                 mDbHelper.open();
                 cursor = mDbHelper.fetchAllLocations();
                 startManagingCursor(cursor);
                 mAdapter = new myListAdapter(this);
                 setListAdapter(mAdapter);

               }
    public class myListAdapter extends BaseAdapter {
            public String testing;
            public myListAdapter(Context c) {
                mContext = c;
                // TODO Auto-generated constructor stub
            }

            @Override
            public int getCount() {
                // TODO Auto-generated method stub
                return cursor.getCount();
            }

            @Override
            public Object getItem(int position) {
                // TODO Auto-generated method stub
                return position;
            }

            @Override
            public long getItemId(int position) {
                // TODO Auto-generated method stub
                return position;
            }

            @Override
            public View getView(int position, View convertView, ViewGroup parent) {

                 cursor.moveToPosition(position);
                 RowView rv;

                 if (convertView == null) {
                        rv = new RowView(mContext,(cursor.getString(2)),
                                (cursor.getString(5)),
                                cursor.getString(cursor.getColumnIndex(DBHelper.KEY_IMAGEFILENAME)),
                                cursor.getString(cursor.getColumnIndex(DBHelper.KEY_CITY)),position);
                    } else {
                        rv = (RowView) convertView;
                        try {
              // I KNOW THIS SECTION IS NOT RIGHT, BUT I HAVE BEEN MESSING IN HERE          
                        rv.setAddress(cursor.getString(2));
                        rv.setCity(cursor.getString(5));
                        rv.setFocusable(true);
                        rv.setClickable(true); }
                        catch (Exception e) {
                            rv = (RowView) convertView;
                            rv.setAddress(cursor.getString(2));
                            rv.setCity(cursor.getString(5));
                            rv.setFocusable(true);
                            rv.setClickable(true); 
                            Toast mToast;
                            mToast = Toast.makeText(FindList.this, "Error :" + e.toString() ,
                                    Toast.LENGTH_LONG);
                            mToast.show();
                        }
                    }

                 return rv;
            }

            public void addItems() {

                 //String[] from = new String[] { DBHelper.KEY_BUSINESSNAME, DBHelper.KEY_ADDRESS, DBHelper.KEY_CITY, DBHelper.KEY_GPSLONG, DBHelper.KEY_GPSLAT,  DBHelper.KEY_IMAGEFILENAME  + ""};
                 // create array of values of widgits
                 //to = new int[] { R.id.businessname, R.id.address, R.id.city, R.id.gpslong, R.id.gpslat, R.id.preview};
                 // Now create an array adapter and set it to display using our row from notes_row.xml

            }

        }

private class RowView extends LinearLayout {
        private TextView mAddress;
        private TextView mCity;
        public ImageView mArrow;
        public ImageView mPicture;
        public String mPathName;
        public String mDateTime;
        public RowView(Context context, String title, String words, String pathName, String city, int position) {
            super(context);

            this.setOrientation(HORIZONTAL);
            this.setVerticalGravity(16); //CENTER_VERTICAL 

            // Here we build the child views in code. They could also have
            // been specified in an XML file.

            //DISPLAY DELETE BUTTON
            Button mButton = new Button(context);
            mButton.setFocusable(false);
            mButton.setId(position);
            mButton.setBackgroundResource(R.drawable.delete3);
            addView(mButton, new LinearLayout.LayoutParams(
                    LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));

            TextView mTitle;
            mTitle = new TextView(context);
            mTitle.setText(Integer.toString(position));
            addView(mTitle, new LinearLayout.LayoutParams(
                    LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));

            this.setOrientation(HORIZONTAL);      

            try {
             Bitmap bm = Bitmap.createScaledBitmap(BitmapFactory.decodeFile(cursor.getString(cursor.getColumnIndex(DBHelper.KEY_IMAGEFILENAME))),100, 100, true);
                mPicture = new ImageView(context);
                mPicture.setImageBitmap(bm);    
           } catch (Exception e) { 
                 mPicture = new ImageView(context);
                 mPicture.setImageResource(R.drawable.noimage);
           }     

            addView(mPicture, new LinearLayout.LayoutParams(
                    LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));

            mArrow = new ImageView(context);
            mArrow.setBackgroundResource(R.drawable.arrowleft3);
            addView(mArrow, new LinearLayout.LayoutParams(
                    LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));

            currentPosition = position;
            Button button = (Button)findViewById(position);
            button.setOnClickListener(mCorkyListener);

        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-09-06T23:55:39.597

使用 convertView 时，您会得到一个以前使用过但不再显示的视图。您应该注意使用当前项目的值重置其所有属性。否则，您在 RowView 构造函数中设置的所有值都将与您第一次创建此视图时提供的值保持一致。

To better understand ListViews, you have to understand that it only uses a limited set of RowViews, just the number that is enough to fill the display and a few more that will be filled with your data just before having to display them.

# dll - 加载时和运行时动态链接之间的区别

> ID：552248
> 
> 赞同：8
> 
> 时间：2009-02-16T04:14:22.647
> 
> 标签：dll

加载时动态链接和运行时动态链接有什么区别？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-16T04:40:33.550

**加载时动态链接**

当可执行文件在构建时链接到 DLL 时，链接器将不会插入目标代码，而是会插入一个**存根**，该存根基本上表示该名称的*函数*位于该*DLL*中。

现在，当可执行文件运行时，可执行文件的一些位将丢失（即**函数存根**），因此在允许程序运行之前，程序加载器通过将这些丢失的函数替换为 DLL 文件的入口点来修复这些丢失的函数。

只有在所有存根都被替换（即解决）之后，可执行文件才被允许运行。

那就是加载时间动态链接。

**运行时动态链接**

在这种情况下，可执行文件没有链接到任何 DLL 库文件，因此它不会在 dll 中包含任何存根，因此程序加载器运行可执行文件没有问题。

但是从 DLL 中的内部访问函数的任务留给了可执行文件，并且可以使用**GetProcAddress** Windows API 来完成。

那是运行时动态链接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T04:18:21.183

你忘记了“作业”标签。

加载时链接意味着您要链接的 DLL 在您的应用程序启动时加载，无论您是否实际使用该 DLL 中的功能。动态链接意味着仅在实际需要时才加载 DLL 的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-24T15:10:08.753

加载时动态链接由操作系统在加载应用程序时执行。OS使用链接器放置在文件中的信息来定位dll的名称，然后搜索那些dll，如果找不到Dll，它就简单地终止并给出错误消息，否则，OS将DLL映射到进程的虚拟地址空间并增加 DLL 引用计数。

# javascript - 在 Rails 中进行 Javascript 测试的 Culerity 与 Selenium

> ID：552249
> 
> 赞同：6
> 
> 时间：2009-02-16T04:17:20.827
> 
> 标签：javascript, ruby-on-rails, cucumber, bdd, culerity

在我们将 Javascript 集成到我们的 RSpec 和 Cucumber 工作流程中的永恒追求中，我们正在评估[Culerity](http://github.com/langalex/culerity/tree/master)，并且暂时对此感到非常兴奋。

与 Selenium 相比，对 Culerity 有什么一般或特别的建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T12:40:24.443

我个人发现 Culerity 比 Selenium 更容易出错，也更易怒。我有几个失败的测试结果证明是 Celerity 的问题，而不是测试或应用程序的问题。浪费了很多时间：/

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-07T13:01:51.020

仅就文档而言，我会选择 Selenium：

[硒文档。](http://seleniumhq.org/documentation/)

[文化文件。](http://github.com/langalex/culerity/tree/master)

Culerity 是否有一个 Firefox 插件来记录测试脚本（确实让事情变得容易） 哪个有更好的记录？

我认为 Selenium 现在在这些方面做得更好。

# c++ - 从 XML 中提取特定数字属性的有效方法

> ID：552253
> 
> 赞同：1
> 
> 时间：2009-02-16T04:20:05.750
> 
> 标签：c++, xml, regex, performance

我工作的应用程序使用 XML 进行保存/恢复。这是一个示例片段：

```
<?xml version="1.0" standalone="yes"?>
<itemSet>
<item handle="2" attribute1="30" attribute2="blah"></item>
<item handle="5" attribute1="27" attribute2="blahblah"></item>
</itemSet> 
```

我希望能够**有效地预处理**我从配置文件中读取的 XML。特别是，我想从上面的示例配置中提取*句柄值。*

理想情况下，我需要一个函数/方法来传递不透明的 XML 字符串，并返回列表中的所有句柄值。对于上面的示例，将返回一个包含 2 和 5 的列表。

我知道有一个正则表达式会有所帮助，但这是最有效的方法吗？字符串操作的成本可能很高，而且我可能需要在配置文件中处理 1000 多个 XML 字符串。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T04:34:10.727

您正在寻找一种面向流的 XML 解析器，它一次读取 XML 中的每个节点，而不是将整个内容加载到内存中。

最著名的之一是[SAX - XML 的简单 API](http://sourceforge.net/projects/sax/)

这是一篇[很好的文章](http://www.xml.com/pub/a/1999/11/cplus/index.html?page=2)，描述了为什么要使用 SAX，并且还具体介绍了在 C++ 中使用 SAX。

您可以将 SAX 视为一种 XML 解析器，它只将最少的内容加载到内存中，因此可以很好地处理非常大的 XML 文档。与需要将整个文档加载到内存中的 Regex 或 DOM 方法相比。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T04:33:21.867

我猜想某种正则表达式将是您提高效率的最佳选择。这将比将 XML 解析为任何类型的结构构造更快，并且只要您可以一次提取所需的所有信息，它可能是最有效的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T05:02:47.613

很难击败类似的东西：

```
/* untested code */
using std::string;
size_t pos = 0;
vector<int> handles;
while ((pos = xmlstr.find("handle=\"", pos)) != string::npos) {
  handles.push_back(atoi(xmlstr.data() + pos + 7));
} 
```

`handles.reserve()`如果以适当的大小调用，或者如果`handles`是 a `deque`or ，这将更有效`list`，这取决于以后需要如何使用它。如果 xml 字符串格式不正确（`xmlstr.data()`不是以 null 结尾的，因此`atoi`可能会超出数组的末尾），则这是不安全的代码。它也不会检查这`handle`不是更长的属性名称的结尾，或者它是否实际上是一个属性。

对正则表达式使用正则表达式库`"\\bhandle=\"\\d+\""`可能会以几乎同样快的速度获得结果，并且出错的可能性更小。它仍然不能确认句柄是一个属性；你必须判断这是否可能是一个问题。

# sql - 在 SQL 中的两个字段之间设置约束

> ID：552263
> 
> 赞同：0
> 
> 时间：2009-02-16T04:23:58.037
> 
> 标签：sql

我有一个表，有两列 Enter_Time 和 Leave_Time，如何编写一个 CREATE TABLE 脚本来强制执行 Leave_Time > Enter_Time 约束？

编辑：使用 Microsoft Access

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T04:33:41.227

使用[PostgreSQL](http://www.postgresql.org/)：

```
CREATE TABLE foo (
  -- other columns...

  enter_time timestamptz NOT NULL,
  leave_time timestamptz NOT NULL,
  CONSTRAINT ck_interval CHECK (leave_time > enter_time)
); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T04:31:48.657

```
CREATE TABLE foo (
    Leave_Time DATETIME NOT NULL, 
    Enter_Time DATETIME NOT NULL, 
    CONSTRAINT CHK_TIMES CHECK (Leave_Time > Enter_Time)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T04:32:11.247

这取决于您的 SQL 数据库引擎。假设 Microsoft SQL Server：

```
CREATE TABLE [dbo].[Timecard](
    [id] [int] IDENTITY(1,1) NOT NULL,
    [EnterTime] [datetime] NULL,
    [LeaveTime] [datetime] NULL,
 CONSTRAINT [PK_Timecard] PRIMARY KEY CLUSTERED 
(
    [id] ASC
)WITH (PAD_INDEX  = OFF, IGNORE_DUP_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]

GO
ALTER TABLE [dbo].[Timecard]  WITH CHECK ADD  CONSTRAINT [CK_Timecard] CHECK  (([EnterTime]<[LeaveTime]))
GO
ALTER TABLE [dbo].[Timecard] CHECK CONSTRAINT [CK_Timecard] 
```

但是你的问题是*如何*写它......我只是为你写的。*我*的做法通常更有用：我使用 Microsoft SQL Server Management Studio Express（免费程序）并使用 GUI 创建了一个表和约束。然后我向它询问了 CREATE 脚本。这样我就不必成为一个 SQL 向导来编写上面的代码。

# asp.net-mvc - ASP.Net MVC：“字典中不存在给定的键”

> ID：552280
> 
> 赞同：1
> 
> 时间：2009-02-16T04:40:27.450
> 
> 标签：asp.net-mvc

我有一组用 MVC 构建的网站——每个网站本质上都是一个原始网站的克隆）。在其中一个网站上，我从这篇文章的标题中得到了错误（“字典中没有给定的键”）——它只出现在一个页面上。所有站点的代码都是相同的，包括正在运行的站点。每个站点都使用相同的设置进行安装（其中大多数站点在单个服务器上相互平行）。我无法在我的开发环境中复制它，所以不知道如何调试（我们的站点是通过 Nant 构建过程编译的，并且都设置为发布模式 - 所以没有可用的调试信息）。

当我查看错误的堆栈跟踪时，我注意到我们的代码在任何时候都没有被调用 - 这都是 ASP.Net 页面生命周期调用（具体来说，最后一个重要的函数是编译页面中称为“__RenderSearchContent”的方法。据我通过挖掘相关的控制器操作可以看出，没有代码使用 Dictionary 对象的实例。

在我看来，我错过了一些东西，但我不确定在哪里看 - 代码似乎不是问题，不*应该*有任何环境差异（虽然，这并非不可能 - 数据库，例如，是不同的安装，但具有相同的架构并且根据堆栈跟踪尚未使用）。

我怀疑的一个领域是我知道使用字典的路由-但可以肯定的是，如果是这种情况，其他站点会遇到同样的问题吗？

关于我可以在哪里找到这个问题的原因有什么建议吗？

任何帮助都感激不尽。

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T21:05:26.193

好的，所以问题不是我所期望的。如果每次发生这种情况我都有一*美元*...

基本上，问题出在引发错误的视图中。有一个数据项存在于其他网站中，但不是这个。我想这种类型的问题是强类型对象最理想的地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T05:11:46.703

检查导致问题的请求的查询（或表单）参数是否包含与控制器操作的参数名称对应的参数（或多个参数）。调用操作时，它应该在请求的参数中查找与操作参数名称匹配的命名参数。

# javascript - 在 Firefox 中使用 %20 设置 top.location.hash

> ID：552282
> 
> 赞同：2
> 
> 时间：2009-02-16T04:40:50.537
> 
> 标签：javascript, firefox, hash, swfaddress

在 Firefox 中，使用这个 javascript：

```
top.location.hash = "#here%20are%20spaces"; 
```

将浏览器 url 更改为：

```
http://mysite.com/#here are spaces 
```

我希望 Firefox 在浏览器 url 中将编码的空格显示为 %20 。

1.  这里发生了什么？为什么当我传递它时，firefox 没有将 url 设置为字符串？
2.  如何强制 firefox 使用编码字符更新 url？

*和...*

如果我添加将网址设置为

```
top.location.hash = "#here%20are%20spaces%"; 
```

它可以工作（！？），尽管末尾附加了额外的不需要的 % 。我不确定这是错误还是功能。关于如何进行的想法或参考？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T04:56:18.223

`%20`仅出于可读性目的，被替换为空白空间（在 Firefox 3 中）。你不应该担心它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T05:03:33.947

对于这个问题，它似乎仍然是一个活跃的[Firefox 错误](https://bugs.launchpad.net/ubuntu/+source/firefox-3.0/+bug/245521)（尽管在 Ubuntu 中报告了 Firefox，但也出现在其他操作系统中）....

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T05:06:18.043

Firefox 在地址栏中显示未编码的值，就像所有包含编码值的 URL 一样。尝试转到[一些带有特殊字符的网址](http://en.wikipedia.org/wiki/Mot%C3%B6rhead)，然后将其剪切并粘贴到记事本/...

您是否尝试过它是否仍然有效并且可以满足您的要求？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-07T19:25:36.937

这是一个安全预防措施。如果它不存在，则可以在地址栏中的 paypal.com 字符串中对看起来像“a”的字符进行编码。

# .net - 与平台无关的 .NET 位数 - 来自操作系统或调用应用程序？

> ID：552293
> 
> 赞同：1
> 
> 时间：2009-02-16T04:49:39.860
> 
> 标签：.net, 64-bit, 32-bit, platform-agnostic

我知道与平台无关的 .NET 应用程序“浮动”到操作系统的位数。但是，从非 .NET 应用程序调用的 .NET 程序集是一个库而不是可执行文件呢？

我们有一个 .NET DLL，它是 SQL Server 2005 的 CLR 扩展存储过程。目前它与平台无关。从在 64 位 Windows 上运行的 32 位 SQL Server 实例调用扩展存储过程时会发生什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T05:03:44.507

这取决于程序集的编译目标。如果您在项目构建选项中选择“任何 CPU”或“x86”，则 DLL 应作为 32 位实例运行。如果您选择“x64”，它将引发异常（内存中的 BadImageFormatException）。

在 Windows 下，32 位进程无法加载 64 位 DLL，因此 SQL Server 将在其进程内运行 32 位版本的 .net 运行时。因此，即使在 64 位机器上，您的 .net 程序集也将作为 32 位运行。

# jquery - 在 jQuery 中查找匹配的类名

> ID：552297
> 
> 赞同：13
> 
> 时间：2009-02-16T04:56:03.450
> 
> 标签：jquery

我在页面中有一系列图像缩略图。它们是使用 css sprites 创建的。

```
<div class="galleryImg1"></div>
<div class="galleryImg2 featured"></div>
<div class="galleryImg3"></div> 
```

我最初使用`id="galleryImg1"`但更改为使用`class="galleryImg1"`，因为图像可能出现在同一页面上的多个位置，我想避免重复的 id。

我有一个 jQuery 选择器来将点击事件附加到所有这些类。

```
$("[class^=galleryImg]").click(function() {
   // how do i get 'galleryImg2' and '2' here?
} 
```

我想知道是否有一种简单的方法可以找出以“galleryImg”开头的类名。我必须使用正则表达式还是有“更聪明”的方法？

（是的，如果我使用的是#ID 选择器，那么我可以说“this.id”，但如上所述，我不想使用 ID，因为我想显示同一图像的多个副本。）

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-16T05:13:26.717

据我所知，您将需要一个非常基本的正则表达式，如下所示：

```
$("[class^=galleryImg]").click(function(Event) {
    var id = this.className.match(/galleryImg(\d+)/)[1];
    console.log(id);
}); 
```

但是，如果您特别反对这一点，您可以使用类似这样的东西，它不会验证但会完成工作。

```
<div class="galleryImg1" image_id="1"></div>
<div class="galleryImg2 featured" image_id="2"></div>
<div class="galleryImg3" image_id="3"></div>

<script>
$("[class^=galleryImg]").click(function(Event) {
    var id = $(this).attr('image_id');
    console.log(id);
});
</script> 
```

因为我假设您可以完全控制您的 HTML，并且您知道 galleryImg 类将始终跟在 ID 后面，所以我认为这里的正则表达式根本不是邪恶的。放手去做！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-03-14T09:39:46.150

我所做的是这样的：

```
<div class="galleryImg 1"></div>
<div class="galleryImg 2 featured"></div>
<div class="galleryImg 3"></div>

<script>
$(".galleryImg").click(function(Event) {
    var Class = $(this).attr('class').split(" ");
    var id = Class[1]
});
</script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T05:05:00.480

您可以使用 Regex，但使用 split 和 indexof 将被更多程序员理解。同样对于如此简单的事情，最好避免使用正则表达式。

在事件处理程序中使用 jQuery 规范化的 Event 对象：

```
$("[class^=galleryImg]").click(function(Event) {
    var classAttribute=Event.target.className

    var classes=classAttribute.split(" ");

    for (var i=0;i<classes.length;i++)
    {
        if (classes[i].indexOf('targetClassNamePrefix')==0)
        {
            // This element has the required class, do whatever you need to.

        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-06-21T19:21:54.683

很惊讶没有人提到`data`属性作为解决方案。

更详细和更清晰，您可以为值添加任何您想要的内容。

```
<div class="galleryImg1" data-imagename="cat" data-caption="This is a cat"></div>
<div class="galleryImg2" data-imagename="img1"></div> 
```

使用[jQuery](https://api.jquery.com/jquery.data/)，您可以使用`$(ele).data('imagename')`

# asp.net - 关于使 Silverlight 内容可用于搜索引擎的任何建议？

> ID：552299
> 
> 赞同：2
> 
> 时间：2009-02-16T04:56:23.653
> 
> 标签：asp.net, silverlight, xaml, search

假设如下：

*   您有一些内容当前显示在 ASP.NET HTML 表中。
*   您想使用 Silverlight 来获得更好的用户体验。
*   重要的是信息在谷歌等中被索引。

你做什么工作？我知道 XAP（Silverlight 可执行文件）包含理论上可以被索引的 XAML。但谷歌会这样做吗？如果是这样，什么时候？如果提供的数据不在 XAML 中（也许它被存储为资源）怎么办？

我的第一个想法是尝试检测搜索引擎并提供 HTML 表格。但我对搜索引擎优化的有限了解让我怀疑谷歌是否会不赞成这种做法，并可能将该网站列入黑名单。而且我不确定无论如何尝试检测搜索引擎有多可靠。

有没有明确的正确方法来做到这一点，不会让你在谷歌上遇到麻烦？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T05:04:00.187

[通过以下链接SEO](http://silverlight.net/learn/whitepapers/seo.aspx)可以在银光中进行搜索引擎 优化

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T09:51:58.027

这是一篇很棒的文章，带有来自 Microsoft 软件架构师的“搜索引擎友好的 Silverlight 应用程序”幻灯片：

[http://www.nikhilk.net/Entry.aspx?id=200](http://www.nikhilk.net/Entry.aspx?id=200)

这篇关于“使用 ASP.Net 和 XSLT 的简单 Silverlight SEO”的 MSDN 博客文章也很有趣：

[http://blogs.msdn.com/synergist/archive/2007/10/03/simple-silverlight-seo-with-asp-net-and-xslt.aspx](http://blogs.msdn.com/synergist/archive/2007/10/03/simple-silverlight-seo-with-asp-net-and-xslt.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T10:06:18.400

[渐进增强](http://en.wikipedia.org/wiki/Progressive_Enhancement)。使用基本的 HTML 表格。使用 JavaScript 将表格替换为更丰富的界面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T10:07:55.867

由于 Silverlight 在浏览器/操作系统支持方面仍然非常有限，我建议不要在公共网页上使用它，或者至少也提供传统的替代方案，然后搜索引擎可以对其进行索引。

# .net - 程序在文件移动时终止

> ID：552301
> 
> 赞同：0
> 
> 时间：2009-02-16T04:58:38.577
> 
> 标签：.net, windows, debugging

我有一个 .Net 程序，作为其功能之一，它从用户指定的目录中获取一个文件，并将其放在另一个特殊的目录中，该目录通过 UNC（可能是也可能不是本地的）指定。我没有在这部分代码中打开任何这些文件。

我遇到了这个奇怪的错误，在 Windows Server 2003 SP2 VM 上，该程序在移动到本地文件夹时随机执行硬中止。它只是终止。没有例外，没有日志记录，而且它似乎不会在任何特定时刻发生。我无法在我的开发机器上重现这个问题，而且它似乎只发生在复制大约 1 兆字节左右的特定类型文件期间。还有其他格式使用非常相似的代码复制到不同的目录，都更小，而且工作正常。

为什么 Windows .Net 程序会像这样硬中止？我能做些什么来修复它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-17T05:06:29.097

你检查过事件日志吗？是否有防病毒程序弄乱它？它得到 DAP 了吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T04:16:34.737

我会改变一行。如果它只是将文件保存在本地会发生什么？在这张图片中它仍然失败吗？您可以将那部分代码复制并粘贴到您的问题中吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T05:02:40.610

我猜是**网络故障**，因为您提到“通过 UNC 指定（可能是本地的，也可能不是本地的）”。

如果这是一个选项，我会更改程序以添加文件复制操作的日志记录。

您是否尝试在尝试复制时执行“netstat”？这可以告诉您防火墙端口是否被阻止。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T07:24:19.850

.NET 运行时[将快速失败](http://msdn.microsoft.com/en-us/library/ms131100.aspx)并关闭应用程序，而不会进一步通知堆栈溢出。但是，这应该会在服务器的事件日志中生成一个条目。您是否在代码中使用了任何可能导致堆栈溢出的递归或分配大型数组等？

# wpf - 在样式中声明文本装饰，例如下划线、删除线

> ID：552303
> 
> 赞同：39
> 
> 时间：2009-02-16T04:59:26.280
> 
> 标签：wpf, xaml, text, styles

如何在样式定义中包含文本装饰，例如下划线、删除线等：

```
<Style x:Key="UnderlinedLabel">
     <Setter Property="Control.FontFamily" Value="Trebuchet MS" />
     <Setter Property="Control.FontSize" Value="14" />
     <!-- Next line fails -->
     <Setter Property="Control.TextDecorations" Value="Underline" />
</Style> 
```

我熟悉使用以下 XAML 为文本添加下划线：

```
<TextBlock>
   <Underline>
       Underlined text
   </Underline>
</TextBlock> 
```

然而文本装饰只是另一种风格，我希望能够像 FontWeight、FontSize 等声明性地定义它。

[更新]

我正在将此样式应用于标签控件。这是我的主要问题。看来您不能在标签中为文本加下划线。更改为 TextBlock（感谢 gix），一切都很好。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-02-16T05:09:43.963

可以使用`<Underline>...</Underline>`或将`TextDecorations`属性设置为 来为文本添加下划线`Underline`。您可以将后者包含在样式定义中：

```
<Style x:Key="Underlined">
    <Setter Property="TextBlock.TextDecorations" Value="Underline" />
</Style>

<TextBlock Style="{StaticResource Underlined}">
    Foo
</TextBlock> 
```

# c# - 如何在 ASP.NET 中实现 GZip 压缩？

> ID：552317
> 
> 赞同：81
> 
> 时间：2009-02-16T05:16:40.453
> 
> 标签：c#, asp.net, compression, gzip

我正在尝试为我的 asp.net 页面（包括我的 CSS 和 JS 文件）实现 GZip 压缩。我尝试了以下代码，但它只压缩了我的 .aspx 页面（从[YSlow](http://developer.yahoo.com/yslow/)找到）

```
HttpContext context = HttpContext.Current;
context.Response.Filter = new GZipStream(context.Response.Filter, CompressionMode.Compress);
HttpContext.Current.Response.AppendHeader("Content-encoding", "gzip");
HttpContext.Current.Response.Cache.VaryByHeaders["Accept-encoding"] = true; 
```

上面的代码只是压缩我的 .aspx 页面代码（标记），而不是作为外部文件包含的 CSS 和 JS 文件。请告诉我如何使用代码在 ASP.NET 中实现 GZip 压缩（因为我在无法访问 IIS 服务器配置的共享托管服务器上）。而且在上面的代码中，我没有得到最后两行，为什么使用它们以及这些行的目的是什么。请解释！

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2010-12-11T09:46:53.390

这是css和javascript文件的解决方案。将以下代码添加到 web.config 文件中的 <system.webServer> ：

```
<configuration>
  ...
  <system.webserver>
     ...
      <httpCompression>
        <scheme name="gzip" dll="%Windir%\system32\inetsrv\gzip.dll"/>
        <dynamicTypes>
          <add mimeType="text/*" enabled="true"/>
          <add mimeType="message/*" enabled="true"/>
          <add mimeType="application/javascript" enabled="true"/>
          <add mimeType="*/*" enabled="false"/>
        </dynamicTypes>
        <staticTypes>
          <add mimeType="text/*" enabled="true"/>
          <add mimeType="message/*" enabled="true"/>
          <add mimeType="application/javascript" enabled="true"/>
          <add mimeType="*/*" enabled="false"/>
        </staticTypes>
      </httpCompression>
      <urlCompression doStaticCompression="true" doDynamicCompression="true"/>
    ...
  </system.webserver>
  ...
<configuration> 
```

学分：[如何在 ASP.NET 和 GoDaddy 上进行 GZip](http://web.archive.org/web/20121224102802/http://jeeshenlee.wordpress.com/2010/08/01/how-to-gzip-on-asp-net-and-godaddy)

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-02-16T05:21:10.143

对于压缩 JS 和 CSS 文件，您实际上必须在 IIS 级别进行处理，因为这些文件是在没有 ASP.NET 运行时的情况下直接呈现的。

您可以在 IIS 中将 JSX 和 CSSX 扩展映射到 aspnet_isapi.dll，然后利用您的邮政编码，但 IIS 可能会为您做得更好。

content-encoding 标头告诉浏览器它需要在渲染之前解压缩内容。一些浏览器足够聪明，无论如何都可以根据内容的形状来解决这个问题，但最好直接告诉它。

Accept-encoding 缓存设置在那里，因此 gzip 压缩内容的缓存版本不会发送到仅请求 text/html 的浏览器。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2011-12-10T23:10:14.767

这可能对您尝试有用，它接受 deflate 和 gzip 压缩。

```
 void Application_PreRequestHandlerExecute(object sender, EventArgs e)
    {
        HttpApplication app = sender as HttpApplication;
        string acceptEncoding = app.Request.Headers["Accept-Encoding"];
        Stream prevUncompressedStream = app.Response.Filter;

        if (app.Context.CurrentHandler == null)
            return;

        if (!(app.Context.CurrentHandler is System.Web.UI.Page ||
            app.Context.CurrentHandler.GetType().Name == "SyncSessionlessHandler") ||
            app.Request["HTTP_X_MICROSOFTAJAX"] != null)
            return;

        if (acceptEncoding == null || acceptEncoding.Length == 0)
            return;

        acceptEncoding = acceptEncoding.ToLower();

        if (acceptEncoding.Contains("deflate") || acceptEncoding == "*")
        {
            // deflate
            app.Response.Filter = new DeflateStream(prevUncompressedStream,
                CompressionMode.Compress);
            app.Response.AppendHeader("Content-Encoding", "deflate");
        }
        else if (acceptEncoding.Contains("gzip"))
        {
            // gzip
            app.Response.Filter = new GZipStream(prevUncompressedStream,
                CompressionMode.Compress);
            app.Response.AppendHeader("Content-Encoding", "gzip");
        }
    } 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2010-01-17T01:02:10.780

它仅压缩 ASPX 文件的原因是您编写的代码仅嵌入在 ASPX 文件中。ASPX 文件是与其包含的任何链接内容分开的请求。因此，如果您的 ASPX 页面包含：

```
<img src="www.example.com\exampleimg.jpg" alt="example" /> 
```

这相当于从您的浏览器到资源的 2 个请求（除了 DNS 查找）：

1.  对于 aspx 页面和
2.  对于 aspx 页面包含的图像。

每个请求都有自己的响应流。您发布的代码仅附加到 ASPX 响应流，这就是为什么只有您的 ASPX 页面被压缩的原因。您发布的代码的第 1 行和第 2 行本质上是接管页面的正常响应流并注入一些“中间人”代码，在这种情况下，这些代码使用 GZip 流吃掉并压缩正常输出流，然后将其发送到线路中。

第 3 行和第 4 行正在设置响应标头。所有 http 请求和响应都有在内容之前发送的标头。这些设置了请求/响应，以便服务器和客户端知道正在发送什么以及如何发送。

在这种情况下，第 3 行通知客户端浏览器响应流是通过 gzip 压缩的，因此需要在显示之前由客户端浏览器解压缩。

第 4 行只是打开响应的 Accept-Encoding 标头。否则，响应中将不存在这一点。

您可以编写/获取可插入的模块，这些模块允许您压缩多种其他 MIME 类型，例如 *.js 和 *.css，但最好只使用 IIS 的内置压缩功能。

您还没有说您使用的是哪个版本的 IIS，但如果是 IIS 7.0，则需要在`<system.webserver>`web.config 文件的部分中包含以下内容：

```
<httpCompression> 
  <scheme name="gzip" dll="%Windir%\system32\inetsrv\gzip.dll" /> 
 <staticTypes>
         <add mimeType="text/*" enabled="true" />
      </staticTypes>
</httpCompression> 
<urlCompression doStaticCompression="true" /> 
```

..

理查德

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-31T17:54:21.413

在 IIS7 中，所有请求都转到 .net，因此您必须创建一个 HttpModule 将这些标头添加到所有响应中。

如果没有 IIS7，并且在共享主机上，您将必须创建一个处理程序来映射您未使用的 .net 文件扩展名（如 .asmx），并在 web.config 中指定 .asmx 文件转到设置的 HttpHandler将路径重写为 .jpg 或其他任何内容并在那里设置标题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-16T05:27:58.380

回答你的最后一个问题。这两行为发送回浏览器的响应设置 HTTP 标头。`Content-Encoding`告诉浏览器响应被编码为 gzip 并且需要被解码。最后一行添加`Accept-Encoding`到[Vary 标头](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.44)。有了这个，浏览器或代理可以确定响应是唯一的还是受某些其他标头的影响并调整它们的缓存。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-24T19:26:13.717

将 .aspx 扩展名添加到 .css 或 .js 文件。在文件中使用 <%@ Page ContentType="text/css" %> 或 javascript 以提供正确的 MIME 类型。& 使用 URL 重写从用户代理浏览器中隐藏它。内容编码响应标头附加 gzip 以表明 gzip 是用于执行压缩的方法。将响应标头设置为 Accept-Encoding 以使所有缓存都知道应该提供哪个页面（压缩或未压缩）取决于请求的 Accept-Encoding 标头。我在[https://stackoverflow.com/a/14509007/1624169对此进行了详细说明](https://stackoverflow.com/a/14509007/1624169)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-04-21T13:24:42.953

您可以将以下内容添加到`<system.webServer>`元素内的 web.config 文件中：

```
<urlCompression doStaticCompression="true" doDynamicCompression="true" /> 
```

注意：如果您使用的是旧版本的 IIS（低于 v7.5），您可能需要将 doDynamicCompression 设置为 false，因为该进程是 CPU 密集型的。这些问题在 IIS 7.5 中得到了解决。

参考：[https ://docs.microsoft.com/en-us/iis/configuration/system.webserver/urlcompression](https://docs.microsoft.com/en-us/iis/configuration/system.webserver/urlcompression)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-06-13T07:11:40.397

要么使用 web.config 文件

```
<system.webServer>
    <httpCompression>
        <scheme name="gzip" dll="%Windir%\system32\inetsrv\gzip.dll"/>
        <dynamicTypes>
            <add mimeType="text/*" enabled="true"/>
            <add mimeType="message/*" enabled="true"/>
            <add mimeType="application/javascript" enabled="true"/>
            <add mimeType="*/*" enabled="false"/>
        </dynamicTypes>
        <staticTypes>
            <add mimeType="text/*" enabled="true"/>
            <add mimeType="message/*" enabled="true"/>
            <add mimeType="application/javascript" enabled="true"/>
            <add mimeType="*/*" enabled="false"/>
        </staticTypes>
    </httpCompression>
    <urlCompression doStaticCompression="true" doDynamicCompression="true"/>
</system.webServer> 
```

或者你可以通过 IIS 来完成。对于压缩 JS 和 CSS 文件，您实际上必须在 IIS 级别进行处理，因为这些文件是在没有 ASP.NET 运行时的情况下直接呈现的。

您可以在 IIS 中将 JSX 和 CSSX 扩展映射到 aspnet_isapi.dll，然后利用您的邮政编码，但 IIS 可能会为您做得更好。

content-encoding 标头告诉浏览器它需要在渲染之前解压缩内容。一些浏览器足够聪明，无论如何都可以根据内容的形状来解决这个问题，但最好直接告诉它。

Accept-encoding 缓存设置在那里，因此 gzip 压缩内容的缓存版本不会发送到仅请求 text/html 的浏览器。

# java - 在Java中，防止实例方法返回后更改字段

> ID：552320
> 
> 赞同：4
> 
> 时间：2009-02-16T05:18:00.807
> 
> 标签：java

在我大学的一个软件开发课上，老师一直提到，在一次测验中，我们需要确保 getter 返回的字段需要“保护”。我猜她的意思是课堂以外的任何东西都不能改变它。她没有给出更多的解释。

例如：

```
class Foo {
    string[] bar = <some array contents>;

    public string[] getBar() {
        return bar;
    }
} 
```

任何调用 getBar 的代码都可以修改该数组中的元素。你如何防止这种情况发生？我假设对象本身应该能够修改数组，而不是对象之外的任何东西。

这不是家庭作业帮助，因为测验是几周前的事情。我只是想更好地理解Java，因为我的老师没有很好地解释。

更新：老师不会仅仅允许我们使用 protected 作为字段上的访问修饰符。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-16T05:19:25.313

您要么使用集合并将其包装在 Collections.unmodifiable*() 中，要么防御性地复制您的数组、集合或对象，如果它是**可变**的（数组总是如此）。

例如：

```
class Foo {
    private String[] bar = <some array contents>;

    public String[] getBar() {
        return bar == null ? bar : Arrays.copyOf(bar);
    }
} 
```

您需要注意的是这是一个浅拷贝（克隆也是如此）。不确定你的老师克隆的问题是什么。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-16T05:44:45.157

只是要添加到先前的答案之一，您要确保使用集合您没有使用 clone() 方法来实现您在此处尝试实现的目标。这只会创建集合的浅表副本，包含在集合副本中的所有对象引用仍然指向与原始对象相同的对象，例如，即使原始集合不能修改集合副本中的对象，仍然可以修改。如果您正在尝试这样做，请确保您正在制作返回集合的深层副本。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-16T05:22:16.007

我怀疑她的意思是字段本身的可见性应该是`protected`（或`private`），以便只能通过 getter 进行访问。对于集合，您可能还想按照@cletus 的建议进行操作，如果您不希望在类之外对其进行修改，则返回该集合的副本。 **编辑**根据您的编辑，她可能意味着两者。

```
class Foo {
    protected string[] bar = <some array contents>;

    public string[] getBar() {
        return bar;
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T05:43:16.223

为了保护该字段不被更改，您需要首先将其设为私有，并且不要提供任何其他更改该字段的方法的任何设置器。这样，没有人可以更改该变量的引用。

如果该字段是一个可变对象，那么它的值可以再次更改。为此，您需要在返回该对象之前进行深度克隆。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-16T06:14:12.980

我将添加到 cletus 的第一个建议 - 使 bar 不可变的最简单方法是使用 List 而不是数组并将其返回包装在 unmodifiableList 中。这样一来，类的客户就可以立即清楚地知道 bar 的内容不能被更改 - 抛出 UnsupportedOperationException。搞乱深度克隆可能会非常低效，具体取决于对象的复杂性，并且仍然返回一堆可变对象 - 只是对这些对象所做的任何更改都会被 Foo 忽略。

```
class Foo {
  private List<String> bar = new ArrayList<String>();
  public Collection<String> getBar() {
    return Collection.unmodifiableList(bar);
  }
} 
```

（还可能值得注意的是，使用 Java 5+ 中的泛型，列表的行为比过去更像一个数组）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-16T14:31:59.773

请告诉教授，所有非最终字段*必须*是*私有*的以保持封装。

受保护的允许您的子类或同一包中的其他类在您的类不知道的情况下修改该字段。

唯一应该直接接触非最终字段的类是定义它们的类。

（想想如果您想稍后在字段更改时触发一个事件会发生什么......只有在所有访问都通过 setter 时才能这样做......）

# php - PHP if (count($array)) 和 if ($array) 意思一样吗？

> ID：552323
> 
> 赞同：6
> 
> 时间：2009-02-16T05:20:25.497
> 
> 标签：php, arrays

在 PHP 中，这些总是返回相同的值吗？

```
//example 1

$array = array();

if ($array) {
   echo 'the array has items';

}

// example 2

$array = array();

if (count($array)) {
   echo 'the array has items';

} 
```

谢谢！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-16T05:27:43.857

从[http://www.php.net/manual/en/language.types.boolean.php](http://www.php.net/manual/en/language.types.boolean.php)，它说空数组被认为是 FALSE。

* * *

（引用）：当转换为布尔值时，以下值被视为 FALSE：

*   布尔值 FALSE 本身
*   整数 0（零）
*   浮点数 0.0（零）
*   空字符串和字符串“0”
*   **一个元素为零的数组**
*   具有零成员变量的对象（仅限 PHP 4）
*   特殊类型 NULL（包括未设置的变量）
*   从空标签创建的 SimpleXML 对象

* * *

自从

*   > 0 的 count() 不是 FALSE
*   填充的数组不是 FALSE

那么问题中说明的两种情况都将始终按预期工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-16T18:24:35.580

那些总是返回相同的值，但我发现

```
$array = array();

if (empty($array)) {
   echo 'the array is empty';
} 
```

更具可读性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T18:20:15.373

请注意，第二个示例（使用`count()`）要慢得多，在我的系统上至少慢了 50%（超过 10000 次迭代）。`count()`实际上计算数组的元素。我不是很肯定，但我想将数组转换为布尔值的工作方式很像`empty()`，一旦找到至少一个元素就会停止。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T05:30:20.777

他们确实会。如果数组非空，则将数组转换为 bool 将为您提供 true，并且数组的计数为 true 且具有多个元素。

另见：[http ://ca2.php.net/manual/en/language.types.boolean.php#language.types.boolean.casting](http://ca2.php.net/manual/en/language.types.boolean.php#language.types.boolean.casting)

# javascript - IE 6 在菜单上选择控件（组合框）

> ID：552326
> 
> 赞同：7
> 
> 时间：2009-02-16T05:24:01.697
> 
> 标签：javascript, xhtml, internet-explorer-6

在 IE 6 中，选择控件（组合框）显示在菜单顶部。我检查了一些 Javascript 菜单[mmmenu](http://www.leigeber.com/2008/11/drop-down-menu/)，但都在选择控制之下。它不能通过分配 Z-Index 来修复。有没有其他解决办法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-16T05:38:06.547

这是 IE6 的一个众所周知的错误，它试图将 div 绝对定位在选择控件的顶部。

有涉及 iframe 垫片的解决方法，但没有好的答案。iframe shim 答案是将 iframe 放置在您尝试放置在选择上方的任何 div 下方，iframe 的大小相同。不幸的是，这是一个巨大的痛苦。

我建议使用已经使用 iframe 垫片的 javascript 菜单系统，例如[YUI 菜单](http://developer.yahoo.com/yui/menu/ "唯菜单")（我假设是 jQuery）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-16T15:54:39.420

大多数主要的 javascript 库都可以轻松实现此问题的解决方案。我们使用jQuery，[bgiframe插件](http://plugins.jquery.com/project/bgiframe)非常好用，解决了问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-16T15:54:42.337

[丹尼尔](https://stackoverflow.com/questions/552326/ie-6-select-controlscombo-box-over-menu/552348#552348)绝对是对的。这是一个丑陋的问题。

但是，可能还有另一种解决方案。如果您正在使用弹出打开和关闭的多层菜单，则可以编写 JavaScript 代码，在打开弹出窗口时从字面上隐藏有问题的 SELECT 元素（将元素设置为具有隐藏可见性）。然后，当菜单关闭时，您可以取消隐藏相同的 SELECT 控件。

然后，您只需编写代码，在特定菜单打开之前检测哪些 SELECT 对象妨碍了它。这不是微不足道的代码，但绝对可以编写。然后我只需将整个代码块包装在一个条件中，以检查用户是否在 IE 上，因为不需要在 Firefox 或 Safari 上运行它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-16T05:36:31.683

问题是 SELECT 是 IE6 中的“窗口”元素，它们的 z-index 高于所有其他非“窗口”组件。如果您绝对必须在组合框上方有一些东西，您可能希望将其放在另一个窗口组件中，例如 IFRAME，并将组件的 z-index 设置为高于组合框的 z-index。

我必须承认，这不是一个很好的解决方案。

# python - 使用 urllib2.urlopen() 下载 .rar 文件时缺少第一行

> ID：552328
> 
> 赞同：0
> 
> 时间：2009-02-16T05:26:27.697
> 
> 标签：python, urllib2

好吧，这真的很奇怪。我有这个脚本，它基本上下载了一堆实现文件并提取它们。通常这些文件是 .zip 文件。今天我坐下来决定让它与 rar 文件一起工作，但我卡住了。起初我认为问题出在我的解压缩代码中，但它不存在。所以我做了：

```
f = urllib2.urlopen(file_location)
data = StringIO(f.read())
print data.getvalue() 
```

哎呀，我什至做了：

```
f = urllib2.urlopen(file_location)
print f.read() 
```

因为我只是想查看第一个块，结果是一样的——我缺少 .rar 文件的第一行。

如果我使用网络浏览器下载相同的文件，一切都很好，它没有损坏。

谁能解释一下这里到底发生了什么？它与文件类型有什么关系。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T06:10:34.533

当试图确定二进制数据字符串的内容时，使用[`repr()`](http://docs.python.org/library/functions.html#repr)or [`hex()`](http://docs.python.org/library/functions.html#hex)。例如，

```
>>> print repr(data)
'\x00\x01\x02\x03\x04\x05\x06\x07\x08\t'
>>> print [hex(ord(c)) for c in data]
['0x0', '0x1', '0x2', '0x3', '0x4', '0x5', '0x6', '0x7', '0x8', '0x9']
>>> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T05:36:53.710

数据是否可能包含“回车”字符（“\r”），以便在您尝试显示第一个块时被后续数据覆盖？这可以解释为什么您在输出中看不到第一个块，但不能解释为什么您以后无法对其进行解码。

# python - python类是如何工作的？

> ID：552329
> 
> 赞同：4
> 
> 时间：2009-02-16T05:26:35.357
> 
> 标签：python

我有一个来自boto框架的代码文件粘贴在下面，所有的打印语句都是我的，注释掉的那一行也是我的，其他的都属于作者。

我的问题是在实例化一个类时，python 中实例化和分配的顺序是什么？以下作者的代码是假设在创建类的实例时会存在'DefaultDomainName'（例如调用__init__（）），但这似乎并非如此，至少在我在python 2.5上的测试中操作系统

在类管理器 __init__() 方法中，我的打印语句显示为“无”。全局函数 set_domain() 中的打印语句在设置 Manager.DefaultDomainName 之前显示“None”，并在分配后显示“test_domain”的预期值。但是在调用 set_domain() 后再次创建 Manager 的实例时，__init__() 方法仍然显示“None”。

任何人都可以帮助我，并解释这里发生了什么。这将不胜感激。谢谢你。

```
 # Copyright (c) 2006,2007,2008 Mitch Garnaat http://garnaat.org/
#
# Permission is hereby granted, free of charge, to any person obtaining a
# copy of this software and associated documentation files (the
# "Software"), to deal in the Software without restriction, including
# without limitation the rights to use, copy, modify, merge, publish, dis-
# tribute, sublicense, and/or sell copies of the Software, and to permit
# persons to whom the Software is furnished to do so, subject to the fol-
# lowing conditions:
#
#
# The above copyright notice and this permission notice shall be included
# in all copies or substantial portions of the Software.
#
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
# OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABIL-
# ITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT
# SHALL THE AUTHOR BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, 
# WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
# IN THE SOFTWARE.

import boto
from boto.utils import find_class

class Manager(object):

    DefaultDomainName = boto.config.get('Persist', 'default_domain', None)

    def __init__(self, domain_name=None, aws_access_key_id=None, aws_secret_access_key=None, debug=0):
        self.domain_name = domain_name
        self.aws_access_key_id = aws_access_key_id
        self.aws_secret_access_key = aws_secret_access_key
        self.domain = None
        self.sdb = None
        self.s3 = None
        if not self.domain_name:
            print "1: %s" % self.DefaultDomainName
            print "2: %s" % Manager.DefaultDomainName
            self.domain_name = self.DefaultDomainName
            #self.domain_name = 'test_domain'
            if self.domain_name:
                boto.log.info('No SimpleDB domain set, using default_domain: %s' % self.domain_name)
            else:
                boto.log.warning('No SimpleDB domain set, persistance is disabled')
        if self.domain_name:
            self.sdb = boto.connect_sdb(aws_access_key_id=self.aws_access_key_id,
                                        aws_secret_access_key=self.aws_secret_access_key,
                                        debug=debug)
            self.domain = self.sdb.lookup(self.domain_name)
            if not self.domain:
                self.domain = self.sdb.create_domain(self.domain_name)

    def get_s3_connection(self):
        if not self.s3:
            self.s3 = boto.connect_s3(self.aws_access_key_id, self.aws_secret_access_key)
        return self.s3

def get_manager(domain_name=None, aws_access_key_id=None, aws_secret_access_key=None, debug=0):
    return Manager(domain_name, aws_access_key_id, aws_secret_access_key, debug=debug)

def set_domain(domain_name):
    print "3: %s" % Manager.DefaultDomainName
    Manager.DefaultDomainName = domain_name
    print "4: %s" % Manager.DefaultDomainName

def get_domain():
    return Manager.DefaultDomainName

def revive_object_from_id(id, manager):
    if not manager.domain:
        return None
    attrs = manager.domain.get_attributes(id, ['__module__', '__type__', '__lineage__'])
    try:
        cls = find_class(attrs['__module__'], attrs['__type__'])
        return cls(id, manager=manager)
    except ImportError:
        return None

def object_lister(cls, query_lister, manager):
    for item in query_lister:
        if cls:
            yield cls(item.name)
        else:
            o = revive_object_from_id(item.name, manager)
            if o:
                yield o 

```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-16T05:49:13.243

**一些python笔记**

当 python 执行**类**块时，它会在遇到该类时创建该类的所有“属性”。它们通常是类变量以及函数（方法）等。

所以“Manager.DefaultDomainName”的值是在类定义中遇到时设置的。此代码**只运行一次**- 再也不会运行。原因是它只是“定义”了名为“Manager”的类对象。

当实例化“Manager”类的对象时，它是“Manager”类的实例。（这可能听起来重复）。要完全清楚，价值：

```
self.DefaultDomainName 
```

不存在。按照类的规则，python 说“嗯，这个对象实例上不存在，我会看看类对象”。所以python实际上在以下位置找到值：

```
Manager.DefaultDomainName

# also referenced by
self.__class__.DefaultDomainName 
```

所有这些都说明了类属性“Manager.DefaultDomainName”只创建一次，只能存在一次，并且一次只能保存一个值。

* * *

在上面的示例中，对每个值运行内置函数 id()：

```
print "1: %s" % id(self.DefaultDomainName)
print "2: %s" % id(Manager.DefaultDomainName) 
```

您应该看到它们指的是完全相同的内存位置。

* * *

**现在，在（非）原始问题的答案中......** 我不知道仔细阅读上面的代码。我建议您尝试几种技术来找出它：

```
# Debug with pdb.  Follow every step of the process to ensure that you are 
# setting valeus as you thought, and that the code you thought would be 
# called is actually being called.  I've had many problems like this where 
# the error was in procedure, not in the actual code at hand.
import pdb; pdb.set_trace()

# check to see if id(Manager) is the same as id(self.__class__)

# in the set_domain() function:
# check to see what attributes you can see on Manager, 
# and if they match the attributes on Manager and self.__class__ in __init__ 
```

当你弄清楚时，请在这里更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T06:12:28.867

gahooa 说的。除此之外，我假设`boto.config.get(...)`返回`None`，大概是因为`default_domain`密钥未在`Persist`配置文件的部分中定义。

`boto.config`定义`boto/__init__.py`为`config = boto.pyami.config.Config()`（基本上）。`boto.pyami.config.Config`是标准的子类[`ConfigParser.SafeConfigParser`](http://docs.python.org/library/configparser.html)，它在 指定的位置查找配置文件`boto.pyami.BotoConfigLocations`，默认为包含`/etc/boto.cfg`和的列表`$HOME/.boto`。如果您在其中任何一个位置都没有配置，则不会有默认域名。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T07:23:28.727

感谢大家的帮助。我想出了我所缺少的：

`__init__()`我正在使用的 boto 类的类定义包含 Manager 的类变量，如果没有将 Manager 传递给这些类，则这些变量又用作默认值。我什至没有想到在导入包含这些类的模块时，这些类变量将使用 import 语句进行评估。

因此，这些类变量 Managers 的 self.domain_name 值是在我调用之前从 DefaultDomainName 设置的`set_domain()`，并且由于我没有像 ruds 指出的那样设置配置文件，因此该值是 None。

所以，我必须稍微修改一下我的代码，但感谢大家帮助 python 新手。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T06:49:19.683

当您加载模块时，python 会逐行执行每个代码。由于代码被执行，类变量都应该在加载时设置。很可能您的 boto.config.get 函数刚刚返回 None。换句话说，是的，所有类变量都在实例变量之前分配。

# windows - 通过 USB 端口发送和接收数据

> ID：552330
> 
> 赞同：4
> 
> 时间：2009-02-16T05:27:17.837
> 
> 标签：windows, usb, windows-vista

我想通过 USB 端口向设备发送/接收数据（来自我的 vista pc）。是否有免费/便宜的图书馆可以做到这一点，以及这个项目的参与程度（不考虑发送或接收的内容）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T05:38:16.140

你没有具体说明这里发生了什么。设备是否已经存在？它已经是 USB 设备了吗？

如果您已经有 USB 设备，那么制造商应该能够提供帮助。

如果您正在构建设备，那么您可能想要查看类似 USB 到串行适配器（通常根本不需要特殊驱动程序）或[FTDI](http://www.ftdichip.com/)的东西- 它们制造了许多易于使用的 USB 芯片，通常不需要，或者在windows下自带合适的驱动。我曾多次使用他们的芯片，他们从未给我带来任何麻烦。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T05:32:13.770

[libusb-win32](http://libusb-win32.sourceforge.net/#about)也许？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T07:22:33.863

Code 项目中的这篇[文章](http://www.codeproject.com/KB/system/HIDAche.aspx)对您来说可能是一个好的开始。首先，您需要构建您的设备。您可以使用带 USB 端口的微控制器，也可以使用串行转 USB 芯片组（如已经建议的 FTDI）。

您应该避免编写自己的 USB 库驱动程序。CodeProject 中的文章使用了 HDI 驱动程序，该驱动程序已经存在于您的设备中。它使用 PIC 微控制器，但我个人最喜欢的是 AVR。使用 AVR，您有以下选择：

*   [AVR-USB](http://www.obdev.at/products/avrusb/index.html)：在固件中实现 USB 堆栈。驱动程序，适用于所有平台的示例。任何 AVR micro 都可以使用。您可能需要自己构建硬件。
*   [爱特梅尔的 USB 系列](http://www.atmel.com/products/AVR/usb/)。这些是带有 USB 端口的微控制器。提供驱动程序和准备购买的套件。其他制造商（如 Microchip 的 PIC 系列）也有类似的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-12T18:38:46.877

在不了解您的情况的情况下，假设您可以控制设备的 USB 协议和驱动程序，我建议您使用[WinUSB](http://msdn.microsoft.com/en-us/library/windows/hardware/ff540196%28v=vs.85%29.aspx)。

它比 libusb-win32 好很多，因为它是 Windows 的原生部分，并且支持异步通信。另外，libusb-win32 只支持 libusb-0.1 API，它真的很老了。

# java - Microsoft Intellimouse 滚轮无法在 Vista 上与 Netbeans 6.5 一起使用

> ID：552332
> 
> 赞同：2
> 
> 时间：2009-02-16T05:27:54.293
> 
> 标签：java, ide, netbeans, windows-vista, hardware

我将不胜感激这个问题的任何帮助，我花了几个小时试图自己诊断它无济于事，并且在将它发布到 Netbeans 用户列表和错误列表时没有收到任何回复。

Netbeans 是一个出色的 IDE，自从几个月前从 Eclipse 切换过来后，我就喜欢上了它。我在 Unix 和 Win32 上使用 Java，在两者上使用 PHP，在 Linux 上使用 C（在 Windows 上也使用 Visual Studio）。问题是我现在编码时太习惯于使用滚轮了，它不适用于 Netbeans。

我正在使用 Microsoft 无线激光鼠标 6000 在 Vista (sp1) 上运行 Netbeans 6.5。滚轮无法在任何窗口中工作，并且笔记本电脑触控板上的鼠标手势也不起作用（不太重要）。我的平台详细信息是：

> ```
> 软件：
> 远景 Sp1
> 产品版本：NetBeans IDE 6.5（内部版本 200811100001）
> 爪哇：1.6.0_03；Java HotSpot(TM) 客户端虚拟机 1.6.0_03-b05
> 系统：在 x86 上运行的 Windows Vista 6.0 版；CP1252; en_AU (nb)
> 
> 硬件：
> 鼠标：微软无线激光鼠标 6000
> 
> 驾驶员首次尝试：
> 鼠标驱动程序：HID 兼容鼠标
> 驱动程序提供商：微软
> 日期：21/06/2006
> 驱动程序版本：6.0.6001.18000
> 
> 驾驶员第二次尝试：
> 鼠标驱动程序：微软无线 USB 鼠标
> 驱动程序提供商：微软
> 日期：26/11/2008
> 驱动程序版本：6.31.230.0
> 
> ```

我发现一个非常古老的错误报告说问题是因为微软默认开始启用平滑滚动，这意味着输入 API 会吐出更小的滚动值 - 但无论我旋转多少轮子，文档都不会移动。

我还尝试回滚驱动程序，重新安装和最新的驱动程序等。希望有任何关于这个问题的指示，我相信其他人也在经历它，因为我在网上找到了很多关于相同问题的参考，但没有解决方案.

我尝试了我拥有的另一只罗技鼠标（MX5000），它的滚轮也不起作用。我为两个额外的鼠标按钮分配了向上翻页和向下翻页快捷方式，但它并不相同。请在 Vista 上使用 Netbeans 的人可以帮我解决这个问题，这让我很生气！

有趣的是，这个鼠标和滚轮在 Linux 上与 Netbeans 配合得很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-04T16:12:39.947

你这是Netbeans的问题吗？您是否尝试过在任何其他 Java 应用程序中使用滚轮？

我问是因为[Java 中有一个](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6524352)与滚轮相关的错误，某些鼠标无法正常工作。现在已修复。

更新用于运行 Netbeans 的 JVM 可能是值得的，因为您看到的问题可能是由这个现已修复的 bug 引起的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T01:06:49.760

我所能做的只是部分确认你所报告的内容。

我在我的 Vista Ultimate 笔记本电脑上运行 Microsoft Intellimouse - 无线光学鼠标 2.0。我可以确认鼠标滚轮在我尝试过的每个适用应用程序中都能正常工作——Netbeans 6.5 除外。我还有一个带鼠标滚轮的罗技光学无线 4 键鼠标，我不确定型号。它在我的 OpenSUSE 11.1 Linux 笔记本电脑上。我可以确认鼠标滚轮在我尝试过的每个适用应用程序中都能正常工作——包括 Netbeans 6.5。当我将 Logitech 鼠标切换到 Vista 框时，一切正常——包括 Netbeans 6.5。当我将 Microsoft 鼠标切换到 Linux 框时，一切正常——包括 Netbeans 6.5。当我将它们切换回来时，旧的行为仍然存在——微软鼠标滚轮不适用于 Vista 上的 Netbeans 6.5，

# oop - OOP vs 函数式编程 vs 过程式

> ID：552336
> 
> 赞同：248
> 
> 时间：2009-02-16T05:31:21.243
> 
> 标签：oop, functional-programming, paradigms, procedural-programming

这些编程范式之间有什么区别，它们是否更适合特定问题，或者是否有任何用例偏爱其中一种？

架构示例赞赏！

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2009-02-16T07:18:26.277

它们都有各自的优点——它们只是解决相同问题的不同方法。

在纯粹的程序风格中，数据往往与对其进行操作的函数高度解耦。

在面向对象的风格中，数据往往带有一组函数。

在函数式风格中，数据和函数倾向于彼此有更多的共同点（如在 Lisp 和 Scheme 中），同时在函数的实际使用方式方面提供更多的灵活性。算法也倾向于根据递归和组合而不是循环和迭代来定义。

当然，语言本身只会影响首选哪种风格。即使是在像 Haskell 这样的纯函数式语言中，你也可以用过程式的风格来编写（尽管这是非常不鼓励的），甚至在像 C 这样的过程式语言中，你也可以用面向对象的风格来编程（比如在 GTK+ 和EFL API）。

需要明确的是，每种范式的“优势”仅仅是对算法和数据结构的建模。例如，如果您的算法涉及列表和树，那么函数式算法可能是最明智的。或者，例如，如果您的数据是高度结构化的，那么将其组合为对象（如果这是您的语言的本机范式）可能更有意义 - 或者，它可以很容易地编写为 monad 的功能抽象，即是 Haskell 或 ML 等语言的原生范例。

您选择使用哪个对您的项目和您的语言支持的抽象更有意义。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-02-16T06:49:42.477

我认为现在可用的库、工具、示例和社区完全胜过范式。例如，ML（或其他）可能是最终的通用编程*语言*，但如果你不能为你正在做的事情获得任何好的库，那你就完蛋了。

例如，如果您正在制作视频游戏，那么 C++ 中有更多好的代码示例和 SDK，因此您可能会更好。对于小型 Web 应用程序，有一些很棒的 Python、PHP 和 Ruby 框架可以帮助您快速运行。由于编译时检查以及企业库和平台，Java 是大型项目的绝佳选择。

过去的情况是，不同语言的标准库非常小并且很容易复制 - C、C++、Assembler、ML、LISP 等。具有基础知识，但在标准化事物时往往会退缩像网络通信、加密、图形、数据文件格式（包括 XML），甚至像平衡树和哈希表这样的基本数据结构都被遗漏了！

Python、PHP、Ruby 和 Java 等现代语言现在带有一个更体面的标准库，并且有许多可以轻松使用的优秀第三方库，这在很大程度上要归功于它们采用命名空间来防止库相互冲突，和垃圾收集以标准化库的内存管理方案。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-02-17T17:30:26.203

这些范式不必相互排斥。如果你看python，它支持函数和类，但同时，一切都是对象，包括函数。您可以在一段代码中混合和匹配功能/oop/程序样式。

我的意思是，在函数式语言中（至少在 Haskell 中，我研究过的唯一一个）没有语句！函数中只允许有一个表达式！！但是，函数是一等公民，您可以将它们作为参数传递，以及许多其他能力。他们可以用几行代码做强大的事情。

在像 C 这样的过程语言中，传递函数的唯一方法是使用函数指针，仅此一项并不能实现许多强大的任务。

在 python 中，函数是一等公民，但它可以包含任意数量的语句。所以你可以有一个包含过程代码的函数，但你可以像函数式语言一样传递它。

OOP 也是如此。像 Java 这样的语言不允许您在类之外编写过程/函数。传递函数的唯一方法是将其包装在实现该函数的对象中，然后传递该对象。

在 Python 中，您没有此限制。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-02-16T10:47:43.323

对于 GUI，我会说面向对象的范式非常适合。窗口是一个对象，文本框是对象，确定按钮也是一个。另一方面，像字符串处理这样的东西可以用更少的开销完成，因此使用简单的程序范例更直接。

我认为这也不是语言的问题。您可以用几乎任何流行的语言编写函数式、过程式或面向对象的语言，尽管在某些语言中可能需要付出一些额外的努力。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-16T08:40:12.100

为了回答您的问题，我们需要两个要素：

1.  了解不同架构风格/模式的特点。
2.  了解不同编程范式的特点。

软件架构风格/模式列表显示在 Wikipeida上的[软件架构文章中。](http://en.wikipedia.org/wiki/Software_architecture)您可以在网络上轻松地研究它们。

简而言之，Procedural 适用于遵循过程的模型，OOP 适用于设计，Functional 适用于高级编程。

我认为你应该尝试阅读每个范式的历史，看看人们为什么创造它，你可以很容易地理解它们。

在了解它们之后，您可以将架构样式/模式的项目链接到编程范式。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-16T13:58:31.087

我认为它们通常不是“对抗”的，但你可以将它们结合起来。我也认为，很多时候，你提到的词只是流行语。很少有人真正知道“面向对象”是什么意思，即使他们是它最狂热的宣扬者。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-20T12:09:54.827

我的一个朋友正在使用[NVIDIA CUDA](http://www.nvidia.com/object/cuda_home.html)编写一个图形应用程序。应用程序非常适合 OOP 范式，并且可以将问题巧妙地分解为模块。但是，要使用 CUDA，您需要使用不支持[继承](http://en.wikipedia.org/wiki/Inheritance_(computer_science))的C。因此，你需要聪明。

a) 你设计了一个巧妙的系统，在一定程度上模拟继承。可以办到！

i) 你可以使用一个[钩子系统](http://en.wikipedia.org/wiki/Hooking)，它期望父 P 的每个子 C 对函数 F 有一定的覆盖。你可以让子注册他们的覆盖，这些覆盖将在需要时被存储和调用。

ii）您可以使用结构[内存对齐](http://en.wikipedia.org/wiki/Packed)功能将孩子转换为父母。

这可能很简洁，但要提出面向未来的可靠解决方案并不容易。您将花费大量时间来设计系统，并且无法保证您不会在项目中途遇到问题。实现[多重继承](http://en.wikipedia.org/wiki/Multiple_inheritance)更加困难，如果不是几乎不可能的话。

b）您可以使用一致的命名策略并使用[分而治之](http://en.wikipedia.org/wiki/Divide_and_conquer_algorithm)的方法来创建程序。它不会有任何继承，但因为您的函数很小、易于理解且格式一致，所以您不需要它。您需要编写的代码量增加了，很难保持专注并且不屈服于简单的解决方案（黑客）。但是，这种忍者编码方式是C编码方式。在低级自由和编写好的代码之间保持平衡。实现这一点的好方法是使用函数式语言编写原型。例如，[Haskell](http://www.haskell.org/)非常适合用于原型算法。

我倾向于方法b。我使用方法 a 编写了一个可能的解决方案，老实说，使用该代码感觉非常不自然。

# gwt - GWT 组合最佳实践

> ID：552341
> 
> 赞同：8
> 
> 时间：2009-02-16T05:34:06.650
> 
> 标签：gwt, composite

我正在学习 GWT 并且已经开始掌握它。我正处于我的代码变得一团糟的地步，所以我要回去并将其中的合理部分分解为复合材料。我遇到的第一个问题是我的工具支持未能为新的 Composite 类提供 initWidget() 方法。它确实包含一个默认构造函数。
目前，我只是简单地`initWidget()`通过调用`super(initWidget(w))` My project compiles 并按预期运行来填充我的重写方法，尽管我觉得好像我必须遗漏一些东西。

重写 init 时我应该记住什么，如果我需要在构造函数中放置什么。还有什么我需要知道的，或者在此之后它只是归结为普通的旧 Java 吗？

澄清 - 我想到这个问题可能有不同的答案，具体取决于您是打算将所述`Composite`类作为库的一部分发布还是仅仅作为独立应用程序的一部分发布。我目前特别无意开发外部有用的组件（主要是因为我对这项特殊技术非常陌生。）

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-17T20:04:34.333

我不确定我是否理解你想要做什么。但是对于我编写的所有 Composite，我从未覆盖 initWidget 方法。因为 Composite 本身不需要用构造函数初始化，即不需要调用 super() 我扩展复合的小部件的构造函数看起来像：

```
public mywidget() {
  SomePanel p = new SomePanel();
  ....
  initWidget(p);
} 
```

作为最佳实践，imo，只有扩展 Composite 的小部件才应将其称为“自己的”initWidget。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T08:45:09.123

“ [GWT 会议：构建库的最佳实践](http://web.archive.org/web/20091027034401/http://www.pathf.com/blogs/2007/12/gwt-conferenc-9/)”提供了一些技巧。您还应该查看 GWT 的源代码和 GWT 库之一的源代码（如[gwt-ext](http://code.google.com/p/gwt-ext/)）

[编辑] 我刚刚看到另一个选项：[suco](http://code.google.com/p/suco/)。从描述：

> 一个微型库，有助于保持 GWT 客户端代码的清洁和模块化。

# powershell - powershell exchange 2003：查询 ActiveDirectory 以获取 activesync、office 和描述？

> ID：552347
> 
> 赞同：0
> 
> 时间：2009-02-16T05:37:23.960
> 
> 标签：powershell, windows-server-2003, exchange-server

我正在使用 powershell 来提取 Exchange 2003 用户的列表，并基于用户的邮箱“LegacyDN”，我希望使用 LDAP 查询来提取他们的 activesyncenabled 属性（msExchOmaAdminWirelessEnable）、描述和办公室；但是，它似乎并没有出现在我身上。有任何想法吗？

这是我查询 AD 属性的方式：

```
$allusers = get-wmiobject -class exchange_mailbox -namespace root\microsoftexchangev2 -computername srv02 | select mailboxdisplayname, legacyDN 

foreach ($user in $allusers) 
{
$obj = new-object psobject 
$exchangever = "2003" 

$tmp = [adsi]("LDAP://" + $user.legacydn) 

$obj | add-member -membertype noteproperty -name "Display Name" -value $user.mailboxdisplayname
$obj | add-member -membertype noteproperty -name "Office" -value $tmp.physicaldeliveryofficename 
$obj | add-member -membertype noteproperty -name "Description" -value $tmp.description 
$obj | add-member -membertype noteproperty -name "Activesync" -value $tmp.msExchOmaAdminWirelessEnable 

$allusersemail += $obj 

}

$alluseremail | export-csv \\srv02\logs\test.csv 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T11:31:01.910

这是一种方法：

$search = System.DirectoryServices.DirectorySearcher

$search.filter = "(&(homeMDB=*)(objectcategory=user)(objectclass=user))"

$props = "mailNickName","displayName","physicaldeliveryofficename","description","msExchOmaAdminWirelessEnable"

$道具 | foreach { [void]$search.PropertiesToLoad.Add($_) }

$users = $search.findAll()

foreach($u in $users)

{

$DisplayName = @{name="DisplayName";表达式={$u.properties.item("DisplayName")}}

$Office = @{name="Office";表达式={$u.properties.item("physicaldeliveryofficename")}}

$Description = @{name="Description";表达式={$u.properties.item("Description")}}

$Activesync = @{name="Activesync";表达式={$u.properties.item("msExchOmaAdminWirelessEnable")}}

$u | 选择 $DisplayName,$Office,$Description,$Activesync

}

# git - Git hook 发送关于 repo 更改的电子邮件通知

> ID：552360
> 
> 赞同：104
> 
> 时间：2009-02-16T05:46:07.947
> 
> 标签：git, githooks

如何配置适当的 Git 挂钩，以便在将一组更改推送到上游存储库时发送摘要电子邮件？

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2009-02-16T05:49:11.717

另一种更现代的方法是使用[git-multimail](https://github.com/git-multimail/git-multimail)，如下面的[Chords](https://stackoverflow.com/questions/552360/git-push-email-notification/552362?noredirect=1#comment29250514_552362)建议的那样。

* * *

*这就是你在 2009 年的做法。*

您可以在 $GITDIR/hooks 中的 post-receive 挂钩中添加类似的内容，或使用源代码的 contrib 目录中的脚本[（](http://source.winehq.org/git/tools.git/?a=blob;f=git-notify;hb=HEAD)[可在此处获得）](http://git.kernel.org/?p=git/git.git;a=blob;f=contrib/hooks/post-receive-email;h=60cbab65d3f8230be3041a13fac2fd9f9b3018d5;hb=HEAD)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-04-25T19:58:52.467

这是我找到的最简单的解决方案：

1) 在 github.com 上登录您的 gitHub[帐户](http://github.com)

2）在主选项卡中单击**设置**

3) 从主导航中选择**Service Hooks**

4) 从可用的挂钩中选择电子邮件

**5）在字段地址**中填写您的电子邮件地址

 **6）选中复选框**从作者发送**

7) 选中复选框**激活**

8) 点击**更新设置**

可选：您可以单击**Test Hook**进行测试，检查您的收件箱，您应该会收到电子邮件。

还有按照流程制作的图片：

![在此处输入图像描述](https://i.stack.imgur.com/UnLtq.jpg)

![在此处输入图像描述](https://i.stack.imgur.com/zGfIt.jpg)

![在此处输入图像描述](https://i.stack.imgur.com/meutG.jpg)

![在此处输入图像描述](https://i.stack.imgur.com/aCfmo.jpg)

现在，对于**总决赛**，我得到了在我身边经过测试和批准的答案。

**当 gitHub 的 Service Hooks->Email 最多只允许 2 个收件人时，如何向所有开发团队成员发送电子邮件 }**。

答案是**Service Hook->Email @ GitHub && Google groups的组合**

1.  首先登录到您的谷歌帐户
2.  转到[Google Groups](https://groups.google.com)，然后在顶部单击**Create Group**
3.  输入组名、组电子邮件地址（将复制/粘贴到 GitHub 服务挂钩->电子邮件地址）、组描述
4.  在点击顶部的创建按钮之后，您的新组现在应该被创建
5.  之后在左侧菜单中点击**邀请成员**并输入队友的电子邮件地址
6.  之后点击**发送邀请**（当您的成员接受邀请时），他们现在正式成为该组的成员
7.  在左侧的菜单中单击**All Members并检查名为****Delivery**的第 4 列，每个团队成员都应该有选项 **All Email**。
8.  在那之后，我想**感谢 Clement Escoffier 先生**，请遵循他的指导方针[@Clement Escoffier::Send Github 向 Google Group 提交](http://www.dynamis-technologies.com/blog/send-github-commits-to-a-google-group/#comment-35)关于如何完成它的承诺。{谢谢克莱门特:)}
9.  如果此处的链接不可用，则为我的 gDocs @ [PDF 版本的 Clements 指南的另一个链接](https://docs.google.com/file/d/0B8JbMMVJ5rsVSGRqVk11bFZ6MVE/edit?usp=sharing)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2010-05-28T05:43:33.203

这是我每次推送到存储库时向用户发送电子邮件通知的方式。

[设置 Git 提交电子邮件通知](https://www.systutorials.com/1473/setting-up-git-commit-email-notification/)

它基于安迪·帕金斯的剧本。我将其更改为使用 SMTP 发送电子邮件。当然也可以使用gmail的SMTP。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-12-29T20:42:10.647

[Robin Sommer](http://www.icir.org/robin "罗宾·萨默")的[git-notifier](http://www.icir.org/robin/git-notifier/ "git 通知程序")也生成了以下格式的非常好的摘要：

```
Subject: [git/git-notifier] master: Adding www target to Makefile. (7dc1f95)

Repository : ssh://<removed>/git-notifier

On branch  : master

>---------------------------------------------------------------

commit 7dc1f95c97275618d5bde1aaf6760cd7ff6a6ef7
Author: Robin Sommer <robin@icir.org>
Date:   Sun Dec 19 20:21:38 2010 -0800

    Adding www target to Makefile.

>---------------------------------------------------------------

 Makefile |    6 ++++++
 1 files changed, 6 insertions(+), 0 deletions(-)

diff --git a/Makefile b/Makefile
index e184c66..9c9951b 100644
--- a/Makefile
+++ b/Makefile
@@ -5,6 +5,8 @@ VERSION   = 0.1

 DISTFILES = git-notifier README COPYING

+WWW = $(HOME)/www/git-notifier
+
 all:

 dist:
@@ -13,3 +15,7 @@ dist:
    cp $(DISTFILES) git-notifier-$(VERSION)
    tar czvf git-notifier-$(VERSION).tgz git-notifier-$(VERSION)
    rm -rf git-notifier-$(VERSION)
+
+www: dist
+   rst2html.py README >$(WWW)/index.html
+   cp git-notifier-$(VERSION).tgz $(WWW) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-11-13T11:38:21.167

设置 hooks.showrev 没有明显区别？：-/

样本配置：

```
# less users/cj.git/config 
[core]
        repositoryformatversion = 0
        filemode = true
        bare = true
[hooks]
        mailinglist = cj@yoga.ee
        showrev = "git show -C %s; echo"
        emailprefix = "[sabu gitosis server] " 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-11-12T20:04:40.670

我设法做到了这一点，但不得不选择使用 contrib 脚本，而不是 Alexandre Julliard 的其他（perl）脚本。它看起来更漂亮，更可配置，但是使用后缀我没有可以接受“-s”的邮件命令？这是我的方式：

[http://pastie.textmate.org/695323](http://pastie.textmate.org/695323)

显示更多信息会很好，比如完整的补丁、gitweb 链接和提交图，但是这个脚本只能做第一个 - 如果我玩 hooks.showrev 似乎。

无论如何，欢呼并感谢您的建议！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-09T13:01:10.063

如果您使用 Windows，[scm-notifier](https://github.com/pocorall/scm-notifier)会很有帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-12-17T20:56:16.937

不完全是一个完整的答案，因为它是 Github 特定的，但如果你碰巧使用 Github，配置“服务挂钩”非常容易。
对于您希望监控的每个存储库，输入 Settings / Service Hooks。
有很多可用的集成，例如 Trac、Twitter、Amazon SNS、Jira、Asana、Bugzilla、FogBugz、IRC、Jabber、Pivo​​tal Tracker、Trello 和电子邮件……
只需选择电子邮件并使用群组电子邮件地址提供。
我们使用电子邮件通知来同步我们的开发人员。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-01-13T22:50:12.950

如果您使用 GitLab，您可以为此使用“Email-on-push”项目服务，它可以在项目设置中的服务下找到。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-08-13T09:08:17.757

您可以使用预提交：

```
#!/usr/bin/env ruby

require 'mail'

Mail.defaults do
  delivery_method :smtp,
    address: 'smtp.gmail.com',
    port: 587,
    user_name: '...',
    password: '...',
    authentication: 'plain',
    enable_starttls_auto: true
end

changes=`git diff --cached --unified=0 Gemfile Bowerfile`

unless changes.empty?
  Mail.deliver do
    from     '...'
    to       '...'
    subject  '[PROJECT] Plese confirm team can use libraries'
    body     changes
  end
end 
```

安装：

```
cd project
cp pre-commit .git/hooks
chmod +x .git/hooks/pre-commit
gem install mail 
```

测试：

```
echo "# some change" >> Gemfile && git commit -m 'some change' Gemfile 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-06-10T11:55:36.917

在您的存储库下的**GitLab**中：

1.  点击设置。
2.  当设置在那里展开时，您将看到**Integrations**。点击它。

推送时打开一个新页面**电子邮件**

3.  找到并选择**从提交者发送**。
4.  此外，在最后一个字段中输入以逗号分隔的**收件人。**

还有一个**禁用代码差异**的选项，它排除了通知正文中可能敏感的代码差异。它是可选的。

更多详情：点击[这里](https://docs.gitlab.com/ee/user/project/integrations/emails_on_push.html#:~:text=From%20the%20Integrations%20page%20select,a%20push%20event%20is%20received.)

# bash - 在 Bash 中仅隐藏 $-sign 输入之前的文本？

> ID：552369
> 
> 赞同：0
> 
> 时间：2009-02-16T05:56:52.243
> 
> 标签：bash

我在 .bashrc 中有这个；

> PS1='$'

但是，我仍然在终端中看到这个：

> mas-macbook:some/path mas$

我想

> $

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T06:29:00.543

`PS1`在您访问文件之前很久就应该已经导出了`.bashrc`，至少对于登录 shell。在这种情况下，设置`PS1`应该简单地覆盖该值（而不是其导出状态）。

要记住的一件事是 bash 本身不会`.bashrc`为登录 shell 运行您的文件。实际的执行顺序是：

*   `/etc/profile`， 如果有。
*   第一个`~/.bash_profile`,`~/.bash_login`或`~/.profile`.

我相当肯定，如果你想`.bashrc`运行一个登录 shell，它必须来自上述之一。

例如，`/etc/profile`可能调用`/etc/profile.local`或目录中的所有脚本`/etc/profile.d/`。同样，`.bash_profile`如果存在，我的调用如下：

*   /etc/bash.bashrc
*   ~/.bashrc

使用以下代码段：

```
if [ -e /etc/bash.bashrc ] ; then
    source /etc/bash.bashrc
fi
if [ -e "${HOME}/.bashrc" ] ; then
    source "${HOME}/.bashrc"
fi 
```

当我在我的 中更改`PS1`并回显“ `hello`” `.bashrc`，但在其中注释掉它的来源`.bash_profile`时，登录时提示不会更改（也不会打印字符串）。当我取消注释采购时，我会同时打印字符串和当我登录时提示发生了变化。

为确保`.bashrc`您的登录 shell 被调用，请将该`echo hello`语句放在 set 之后`PS1`，然后登录以检查。

如果它在您登录**时**被调用，您可以`export -p`从您的 shell 中执行“”以获取所有导出变量的列表 - 确保 PS1`declare -x`前面有一个“”。如果没有，只需更改您`.bashrc`的导出它：

```
export PS1='$' 
```

如果它已经被导出，那么在你的`set`声明之后有一些东西正在改变它。在这种情况下，您需要实际查看登录执行路径，以查看调用了什么，然后才能获得控制权。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T05:58:16.950

我认为您需要`export`关键字：

```
export PS1='$' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T06:24:31.413

您可能必须转义 $ 符号。这适用于我的系统... PS1="\$"

如果这不起作用，请运行命令“echo $PS1”并让我们知道结果。您可能还必须发送 .bashrc 文件 - 您可能在包含全局 /etc/bashrc 文件之前设置了 PS1 变量。如果是这种情况，全局文件将覆盖该变量。在包含 /etc/bashrc 文件后，您必须设置 PS1 变量。

# .net - 为什么我们仍然在 .NET 中使用 DataSet？

> ID：552371
> 
> 赞同：17
> 
> 时间：2009-02-16T05:58:01.133
> 
> 标签：.net, orm, dataset

DataSets 是 .NET 1.0 中的大事之一，即使现在使用 .NET 3.5，我仍然发现自己不得不使用它们....尤其是当我必须调用一个返回数据集的存储过程时，我最终得到了手动转换为对象以使其更易于使用。

我从来没有真正喜欢过 DataSet，并且发现它们使用起来很烦人……因此，我倾向于将我对它们的了解保持在最低限度（可能是一件非常糟糕的事情！）。我也更喜欢将它们快速转换成一个对象或对象列表，这样我就可以在我的代码中轻松地操作它们。

数据集是否按日期通过了使用？随着 NHibernate 等 O/R 映射器的出现，我想知道 DataSet 是否会消亡，或者它们还有一席之地吗？目前，我在是否应该留出时间重新访问 DataSet 并学习如何正确使用它们或 100% 落后于 O/R 映射器并完全放弃 DataSet 之间犹豫不决。

数据集是否提供 NHibernate 和 LINQ 等技术无法提供的任何东西？如果不是，那我们为什么还要使用它们？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-23T22:56:45.230

无论好坏，答案都是简单。当 2.0 框架出现并且 TableAdapter 被包含在流程中时，让您的基本 CRUD 类型的应用程序，甚至是显示数据的首页滚动变得非常容易。只需连接到您的服务器，将您的表拖过来，结构就到位了，包括外部/主/唯一键引用。需要对此数据执行更新？使用向导，指定您现有的过程，或让向导为您生成即席/存储过程。

大功告成，将其连接到 GridView，您可以快速做很多事情：重新查询、重新查询、在断开连接时编辑多条记录，以及单个或批量更新。当您在处理想要快速完成的项目时，这种便利是很难放弃的。另外，如果您需要这种本机“DataTable”格式的东西，那么对于 XML 恶作剧来说会很方便，因为 DataSet 模型在底层使用 XML 来处理很多东西。

我承认我还没有检查过最新版本的 ORM，而且我不确定是否有一个 LINQ 向导可以在几次点击中完成这项工作。而且大多数人在适应新技术方面有点慢，所以很容易看出它是如何被大量使用的。

看到新的动态数据服务站点/项目是基于 LINQ to SQL 或 LINQ to EF 构建的，我认为潮流可能最终会转向更新的模型。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-16T06:08:42.980

我认为数据集最大的问题是它们基本上鼓励你在内存中创建一个 dbms。我喜欢 Linq/entities 满足您的数据需求的方式，它们依赖于标准的 .Net 集合类和泛型来工作。

也就是说，我不会放弃能够在内存中动态读取无类型数据和应用关系等的能力，这仍然是非常强大的功能，具体取决于您的情况。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-16T06:09:34.973

我从来没有正确使用过 DataSet（连接到 SQL Server），但它曾经对特定需求很有用。我发现 DataSet 和 DataView 是非常方便且实用的基类，用于实现数据/BLL 层，直到我可以将一些经过深思熟虑的东西放在适当的位置。如果没有别的，您应该注意很多功能。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-07T07:22:26.927

喜欢数据集的 3 个理由：

*   对于winforms，它们支持数据绑定/过滤，大多数orms不支持
*   许多第 3 方工具（尤其是报告工具）内置了对数据表/集的支持，而不是对普通对象的支持。
*   在调试时，您可以右键单击已填充的表格并查看内容。这是一个真正的节省时间。

总而言之，它们具有很多功能。我不喜欢适配器。我通常编写自己的数据库适配器。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-16T06:03:50.027

我认为我在同一条船上：我很少使用数据集，而且我当然不会声称自己是适配器模型方面的专家（我认为“ `Fill`”是我在生产中真正使用过的唯一方法） - 但他们偶尔会有一些用途。例如，如果您需要执行一些特别的 SQL 代码，无法预测模式（因此 ORM 无济于事），并且不想`IDataReader`为了一个简单的小数据集而弄乱 etc。

除此之外（即大部分时间），我更喜欢标准类——ORM 或手册。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-16T07:32:55.070

DataSet 最广为人知的用途是创建数据库的内存副本。我发现我从来没有用过它，即使是 .NET 1.0。断开连接的模型在多用户环境中总是不合适的。

如果您完全忽略关系数据库，数据集仍然有用途：

*   如果您正在编写一个将数据加载和保存到文件中的表单应用程序，您可以定义一个类型化的 DataSet，然后使用 XmlDataDocument 类加载和保存它。

*   Crystal Reports 可以通过读取内存中的数据集来生成报告。您可以仅为一个特定报表创建一个类型化的 DataSet，并使用 .NET 语言编写复杂的业务逻辑来填充此 DataSet。这使您免于使用 Crystal Reports 功能实现业务逻辑（这可能是一项非常困难的任务）

*   您可以使用一行代码将 DataGridView 附加到 DataSet 以获得糟糕的用户界面，但这可能会完成您需要的工作。适合内部测试工具之类的东西。（不足以运送给客户）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-23T22:45:25.163

我发现这些表（不是那么多）非常好，它们肯定不会像项目列表或某种历史数据那样在很长一段时间内发生变化。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-07T08:14:28.227

我将 Typed DataSets 用于一个非常低杠杆的 orm。我知道它没有一半好，但试着向大人物解释一下。
所以不要改变世界并引入一些非微软的 oss 工具（或者最终从 .net2.0 迁移到 3.5，并使用 l2s 或 ef） ，我只是使用一个数据集来保存我的查询结果，并在需要的地方轻松地将它们绑定到网格、文本框和组合框。我发现以后可以使用类似的东西

```
MyDataSet.MyDataTableRow row = // whatever
if (row.Price > 100) // do something 
```

很有用。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-02-05T07:12:07.623

对于专业程序员。他们使用 DataSet 是因为 DataSet 对象旨在鼓励将乐观并发用于长时间运行的活动，例如远程处理数据和与数据交互。

# flash - ActionScript 3：如何从 URL 获取主机名？

> ID：552382
> 
> 赞同：4
> 
> 时间：2009-02-16T06:04:58.107
> 
> 标签：flash, actionscript-3

我正在尝试设置 XML 文件的路径，该路径在本地或服务器上运行时会有所不同。

如何确定 Flash 是否在本地运行？（我正在考虑检查 URL 是否包含“ [http://localhost](http://localhost) ”，但是如何获取窗口 URL？）

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-16T06:26:16.510

您可以通过外部 API 向外部窗口（容器）询问此信息

```
if (flash.external.available) // An external window is not always available
{
    var win:* = flash.external.call("window.location"); // evaluate window.location
    // depending on browser there are several properties like 'host' you can use
    // to get the actual hostname
    // e.g. win.host == "localhost"
} 
```

如果上述方法不起作用，您需要创建一个包装函数以从 JavaScript 返回该 window.location 对象。请注意，win 对象上可用的属性完全由浏览器设置，并且因浏览器而异。这也意味着 Flash 播放器（如果您在浏览器环境之外运行由 Flash 播放器托管的电影，您将不会知道 window.location 属性，这在您部署电影时有效，但在调试时无效）

在这里查看更多信息

*   [http://developer.mozilla.org/en/DOM/window](http://developer.mozilla.org/en/DOM/window)
*   [http://www.google.se/search?hl=en&q=flash.external.ExternalInterface](http://www.google.se/search?hl=en&q=flash.external.ExternalInterface)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-16T13:13:49.930

`url`如果您的应用程序是 Flex 应用程序，您可以通过应用程序对象的属性检索主 SWF 文件的 URL 。这可以从控制器树中的任何地方通过 访问`parentApplication.url`，或者，如果对象不是控制器树的一部分，则`Application.application.url`。

对于普通的 AS3 项目，您需要访问`loaderInfo`主精灵的属性，例如，`_root.loaderInfo.url`将为您提供相同的信息。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-16T08:52:14.567

mokee 是正确的，因为您需要指定在本地运行时访问 XML 的相对路径。您也应该在服务器上的某处匹配此文件夹结构。但是，通常需要在此相对路径前面附加不同的基本路径以指向这些文件夹的特定版本。例如，我们的代理机构经常有几种不同的环境。dev 构建、测试服务器、不同的实时环境。您不想对这些进行硬编码，而且您需要一些方法来确定实际使用的是哪个。

这个问题的解决方法通常是传入一个basePath作为[FlashVar](http://kb.adobe.com/selfservice/viewContent.do?externalId=tn_16417)

看看这个关于如何将 FlashVar 传递到您的 swf 的解决方案

[http://blogs.adobe.com/pdehaan/2006/07/using_flashvars_with_actionscr.html](http://blogs.adobe.com/pdehaan/2006/07/using_flashvars_with_actionscr.html)

在您的服务器上设置一个指向 basePath 的 flash var。就像是

```
FlashVars="basePath=http://www.yourdomain.com/flash" 
```

然后在 actionscript 中，您可以检查此 basePath 是否存在。如果没有，那么您知道您在本地运行，因此您只使用您设置的在本地运行的相对路径。如果有 basePath，则将其添加到您的相对路径的前面，并使用此 URL 加载 xml。

这样做很常见，而且效果很好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T08:04:59.783

将路径设置为 XML 绝对相对路径：'/temp/data.xml'。[就像它会在“ http://yourhost.com/temp/data.xml](http://yourhost.com/temp/data.xml) ”中搜索 XML 。

如果它设置为“temp/data.xml”，它将始终相对于 SWF 搜索它。

如果你很高兴并且你知道，data.xml。

# mobile - 用于将小区编号与提供者关联的 API

> ID：552384
> 
> 赞同：3
> 
> 时间：2009-02-16T06:06:01.427
> 
> 标签：mobile, cellular-network

给定美国的手机号码（尽管其他国家也可以），**我该如何确定提供者？**是否有任何您知道的 Web 服务或 ETL 转储可用于获取此信息？

理想情况下，该组件将接受手机号码并返回服务提供商。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T06:38:37.323

[MX Telecom](http://www.mxtelecom.com/us/cl)看起来最有前途。他们有一个详细的 XML 接口[here](http://www.localcallingguide.com/xmlquery.php)。

另一个[不错的](http://www.telcodata.us/telcodata/telco?npa=303&exchange=949)（付费获取 CSV 文件）

[这](http://en.wikipedia.org/wiki/Mobile_number_portability#Number_Lookup_Services)是其他服务提供商的列表。

在本地号码携带之前，您可以通过区号后的3位数字来确定运营商。这不再适用于在更换运营商时“随身携带号码”的人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T08:15:50.850

我不知道其他国家。[这是](http://www.crankup.net/mobile-phone-number-codes-india-only)印度手机的代码列表。我不知道有任何可用的网络服务。但这可以存储在数据库中并被引用。

# flash - ActionScript 3：如何自动展开 DynamicText？

> ID：552397
> 
> 赞同：1
> 
> 时间：2009-02-16T06:15:54.770
> 
> 标签：flash, actionscript-3

当文本（动态分配）太长时，如何使 DynamicText 跨越 2 行。

我想保持宽度，但高度应该自动调整。

先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T08:28:47.150

```
yourTextField.multiline = true; 
```

如果 TextField 的尺寸不足以容纳您可能还想使用的额外文本：

```
yourTextField.autoSize = TextFieldAutoSize.LEFT; 
```

这将扩展您的 TextField 的高度（但不是宽度，因为多行已设置为 true）

# c# - 在 .NET 中进行文本转语音有哪些好的资源？

> ID：552398
> 
> 赞同：5
> 
> 时间：2009-02-16T06:16:46.983
> 
> 标签：c#, .net, text-to-speech

任何人都可以帮助我使用 C# 中的文本到语音引擎吗

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-16T06:20:30.453

微软语音 SDK

[http://msdn.microsoft.com/en-us/library/aa920210.aspx](http://msdn.microsoft.com/en-us/library/aa920210.aspx)

只是为了简单的t2s，应该很简单，比如

```
SpVoice objSpeech = new SpVoice();
objSpeech.Speak("Hello world",SpeechVoiceSpeakFlags.SVSFlagsAsync);
objSpeech.WaitUntilDone(Timeout.Infinite); 
```

# facebook - 如何控制 Facebook 应用程序的画布页面的宽度？

> ID：552399
> 
> 赞同：2
> 
> 时间：2009-02-16T06:18:54.733
> 
> 标签：facebook

我正在开发一个简单的 Facebook 应用程序，而我正在使用 iFrame 的画布页面。我需要使 iframe 的宽度更宽以适合我的网站。有没有办法控制这一点，我需要做些什么来支持它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-27T09:21:37.777

有两种支持的画布页面尺寸（760 像素和 646 像素）。这些可以在您的应用程序的开发人员设置中进行设置。

你不能让你的画布页面更宽，但是你可以通过制作你的应用程序和 FBML 应用程序来使其更窄，然后将你的内容放在一个 fb:iframe 标签内，并缩小宽度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T07:41:25.423

这是 fb 开发人员在[canvas](http://wiki.developers.facebook.com/index.php/Canvas)上的 wiki 条目。他们在画布标签中设置它的宽度。
例如`<canvas id="Canvas1" width=200 height=270></canvas>`

[iFrame](http://wiki.developers.facebook.com/index.php/Fb:iframe)的 fb 标记

# java - 如何在不重启服务器的情况下编译单个/多个 java 文件？是否有任何相同的 Eclipse 插件？

> ID：552402
> 
> 赞同：6
> 
> 时间：2009-02-16T06:21:35.850
> 
> 标签：java, compilation, eclipse-plugin

我想在我的应用程序中编译多个 java 文件而不重新启动 Weblogic 和 Tomcat。否则，这需要很多时间。为此，我[在 Eclipse 中获得了一个 Hotswap 插件](http://www.eclipse-plugins.info/eclipse/plugin_details.jsp?id=620)，但这并不是在所有情况下都有效。它说它适用于单个文件编译。即使我使用它，它也不是在所有情况下都有效。

有没有其他方法可以做到这一点，或者是否有任何其他插件/脚本/软件可以帮助我？

如果有一些开源的，那将非常有帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-16T07:05:00.847

一件事是编译类，但您还需要 JAVA VM 重新加载类并使用它们，这称为热交换。为了获得最佳可用的类热交换，您需要[javarebel](http://www.zeroturnaround.com/javarebel/)之类的东西。与常规的 SUN JVM 相比，它允许您热重载更多[类型的代码更改。](http://www.zeroturnaround.com/javarebel/features/)如果您以分解模式运行部署，您就可以自由自在，并且可以在一秒钟左右的时间内测试任何代码更改。我们是相当受测试驱动的，所以我只在组装整个应用程序的那个短暂阶段使用 javarebel，但它工作得非常好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T14:37:46.187

Java HotSpot VM 会自动执行此操作，但并非在所有情况下...

首先，您必须运行“调试”会话，而不是“运行”会话。

接下来，一些更改将强制重启。基本思想是，如果类的接口发生变化（方法 sigs，而不是实际的 Java 接口），VM 不能替换内联的类内容。

你不应该为此需要一个插件，只需要一个最近的虚拟机。

这发生在几种情况下，例如

*   添加方法
*   删除方法
*   更改方法签名
*   更改类层次结构（超类、实现的接口）

如果您在类中引入错误，也会发生这种情况。（对于不匹配的花括号等错误）

当你保存一个 Java 文件时，eclipse 会编译它。如果出现错误，eclipse 会插入一个异常 throw 来指示存在未解决的编译错误。（这样做是为了让您在运行时不仅会看到最后一次成功的编译，而且很明显您有编译器错误）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T06:42:55.050

我不知道 Eclipse，但我确实使用过 Netbeans。Netbeans 在这方面做得很好。最新版本甚至可以选择在您保存 java 文件时自动重新编译。

我知道这并不能完全回答你的问题。您可能可以同时使用 Netbeans 和 Eclipse，具体取决于您正在处理的项目的哪一部分。

编辑：使用 Tomcat，您可以重新加载网络应用程序。这只有在 Tomcat 正在查看新类时才真正有用。如果您的项目首先编译到构建目录，然后从中创建 WAR，您可以进入 Tomcat 并安装 Web 应用程序，而不是指向构建目录中的 WAR 点。

在 Tomcat 中，您可能必须在 tomcat/conf/Catalina/localhost 下放置一个站点配置文件。该文件的内容如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<Context docBase="C:/Projects/MyWebApp/build/web" path="/MyWebApp"/> 
```

此处重新加载说明： [http ://www.cs.ucl.ac.uk/teaching/java/tomcatfaq.html#changeservlet](http://www.cs.ucl.ac.uk/teaching/java/tomcatfaq.html#changeservlet)

如果你这样做几次，尽管 Tomcat 会耗尽内存。这是因为一个叫做 PermGenSpace 的东西。如果您想了解更多信息，请阅读它。解决方案是增加 JVM 内存、PermGenSize（带 -XX:MaxPermSize），最后偶尔重启 Tomcat。

EDIT2：如果重新加载应用程序导致您被注销，您可以通过将“实现可序列化”添加到您的某些类来轻松地让容器将您的会话数据序列化到磁盘。那么你应该不需要在重新加载应用程序后登录。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T14:03:56.377

我同意在开发的时候一直在重新部署是非常繁琐的。

我建议您研究一下 MyEclipse，它有一个非常好的热部署机制，可以很好地与 Tomcat 配合使用，而且价格实惠，并且有 30 天的试用期。

Eclipse 中用于重新部署到服务器的现有 Java EE 机制远没有那么快。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-16T10:27:56.693

我想我真的不明白问题出在哪里。这就是我所做的，更改几乎是瞬间加载的。我有一个 Ant 脚本，它为我编译 .java 和 .jsp 文件，将它们放在 webapps 下的适当目录中，并在必要时更改 web.xml 文件（或至少触摸它以通知 tomcat 更改）。如果您在使用 Ant 时需要帮助，我很乐意提供帮助。顺便说一句，我不使用 WAR 文件在我的测试机器上进行部署。我猜那会慢很多。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-07T15:16:23.410

如果您阅读此页面，则非常容易完成：请参阅[http://blog.redfin.com/devblog/2009/09/how_to_set_up_hot_code_replacement_with_tomcat_and_eclipse.html](http://blog.redfin.com/devblog/2009/09/how_to_set_up_hot_code_replacement_with_tomcat_and_eclipse.html) 谢谢 Dan Fabulich

# perl - 如何根据扩展名过滤文件名？

> ID：552414
> 
> 赞同：4
> 
> 时间：2009-02-16T06:36:35.330
> 
> 标签：perl, list, filter

以下脚本将所有文件和目录存储在数组中`@file_list`。

如何仅过滤具有`.lt6`扩展名的文件，仅此而已？

```
opendir (CURRDIR, $localdir);
@file_list = grep !/^\.\.?$/, readdir CURRDIR;
print STDOUT "Found Files: @file_list\n"; 
```

干杯

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-16T06:52:31.627

尝试这个：

```
grep(/\.lt6$/i, readdir(CURRDIR)) 
```

我已经用过很多次了。它有效，尽管现在我更喜欢使用[File::Next](http://search.cpan.org/dist/File-Next/)来处理这类事情。

例子：

```
use File::Next;

my $iter = File::Next::files( { file_filter => sub { /\.lt6$/ } }, $localdir )

while ( defined ( my $file = $iter->() ) ) {
    print $file, "\n";
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-16T06:53:17.007

别忘了`closedir()`。

您`grep`应该寻找：

```
my(@file_list) = grep /\.lt6$/, readdir CURRDIR; 
```

假设您的其余语法大致正确。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T21:54:09.993

您可以使用[File::Find::Rule](http://search.cpan.org/perldoc?File::Find::Rule)；

```
use File::Find::Rule;

print "FOUND:\n    "
    , join( "\n    "
          , File::Find::Rule->file->name( '*.lt6' )->in( $path )
          )
    , "\n"
    ; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-17T17:43:08.027

```
my @file_list = glob "$localdir/*.lt6"; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-16T09:21:40.613

```
opendir (CURRDIR, $localdir);
@file_list = grep m/\.lt6$/, readdir CURRDIR;
closedir CURRDIR;
print STDOUT "Found Files: @file_list\n"; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-16T19:07:15.807

为了增加一点多样性，您还可以执行以下操作：

```
opendir(DIR, $path) || die qq([ERROR] Cannot opendir "$path" - $!\n);
my(@txt) = grep(m{\.txt$}, readdir DIR);
rewinddir DIR;
my(@lt6) = grep(m{\.lt6$}, readdir DIR);
rewinddir DIR;
my(@dirs) = grep(-d "$path/$_", readdir DIR);
closedir DIR; 
```

等等。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-02-17T18:10:51.690

转到命令提示符

光盘\

目录 /s *.lt6 > mydir.txt

# javascript-events - window.onbeforeunload 检测是 POST 还是 GET

> ID：552415
> 
> 赞同：3
> 
> 时间：2009-02-16T06:36:57.030
> 
> 标签：javascript-events

在 window.onbeforeunload 事件中，有没有办法检测新请求是 POST（在同一页面上）还是 GET（转到页面）？看到新的 document.location 也很棒。

```
window.onbeforeunload = winClose;
function winClose() {
    //Need a way to detect if it is a POST or GET
    if (needToConfirm) {       
        return "You have made changes. Are you sure you want?";
    }
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-07-23T19:26:42.623

这就是我刚刚做到的：

```
$(document).ready(function(){
  var action_is_post = false;
  $("form").submit(function () {
    action_is_post = true;
  });

  window.onbeforeunload = confirmExit;
  function confirmExit()
  {
    if (!action_is_post)
      return 'You are trying to leave this page without saving the data back to the server.';
  }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T06:54:59.297

听起来像是您需要附加到表单或特定链接的内容。如果事件是由链接引发的，并且有一个充满变量的请求字符串，它将充当 GET。如果是表单，则必须检查 METHOD，然后根据表单本身中提交的数据计算 URL。

```
<a href="thisPage.php">No method</a>
<a href="thisPage.php?usrName=jonathan">GET method</a>
<form method="GET" action="thisPage.php">
  <!-- This is a GET, according to the method -->
  <input type="text" name="usrName" value="jonathan" />
</form>
<form method="POST" action="thisPage.php">
  <!-- This is a POST, according to the method -->
  <input type="text" name="usrName" value="jonathan" />
</form> 
```

所以检测不会发生在 window 方法中，而是发生在你的链接的 click 方法和表单提交中。

```
/* Check method of form */
$("form").submit(function(){
  var method = $(this).attr("method");
  alert(method);
});

/* Check method of links...UNTESTED */
$("a.checkMethod").click(function(){
  var isGet = $(this).attr("href").get(0).indexOf("?");
  alert(isGet);
}); 
```

# c# - 如果您不控制所涉及的类型，您将如何将“switch on Type”重构为多态？

> ID：552421
> 
> 赞同：8
> 
> 时间：2009-02-16T06:39:15.060
> 
> 标签：c#, generics, oop, reflection

我正在用 C# 编写一个[微格式](http://microformats.org)解析器，并且正在寻找一些重构建议。这可能是我一段时间以来在 C# 中尝试的第一个“真正的”项目（我在日常工作中几乎完全使用 VB6 进行编程），所以我觉得这个问题可能会成为系列中的第一个 ;-)

让我提供一些关于我到目前为止所拥有的背景，以便我的问题（希望）有意义。

现在，我只有一个班级`MicroformatsParser`，正在做所有的工作。它有一个重载的构造函数，可以让你传递一个`System.Uri`或一个`string`包含 URI 的：在构造时，它会在给定的 URI 处下载 HTML 文档并将其加载到`HtmlAgilityPack.HtmlDocument`类中以便于操作。

基本的 API 是这样工作的（或者，一旦我完成了代码......）：

```
MicroformatsParser mp = new MicroformatsParser("http://microformats.org");
List<HCard> hcards = mp.GetAll<HCard>();

foreach(HCard hcard in hcards) 
{
    Console.WriteLine("Full Name: {0}", hcard.FullName);

    foreach(string email in hcard.EmailAddresses)
        Console.WriteLine("E-Mail Address: {0}", email);
} 
```

这里使用泛型是有意的。我的灵感来自 Firefox 3 中的 Microformats 库（和 Ruby `mofo`gem）的工作方式。这里的想法是解析器完成繁重的工作（在 HTML 中查找实际的微格式内容），而微格式类本身（`HCard`在上面的示例中）基本上提供了告诉解析器如何处理它找到的数据的模式。

该类的代码`HCard`应该使这一点更清楚（注意这不是一个完整的实现）：

```
[ContainerName("vcard")]
public class HCard
{
    [PropertyName("fn")]
    public string FullName;

    [PropertyName("email")]
    public List<string> EmailAddresses;

    [PropertyName("adr")]
    public List<Address> Addresses;

    public HCard()
    { 
    }
} 
```

解析器使用此处的属性来确定如何使用 HTML 文档中的数据填充类的实例。当您调用时，解析器会执行以下操作`GetAll<T>()`：

*   检查类型`T`是否具有`ContainerName`属性（并且它不是空白的）
*   在 HTML 文档中搜索具有`class`与`ContainerName`. 将这些称为“容器节点”。
*   对于每个容器节点：
    *   使用反射创建类型的对象`T`。
    *   通过反射获取类型的公共字段 (a `MemberInfo[]`)`T`
    *   对于每个字段的`MemberInfo`
        *   如果字段有`PropertyName`属性
            *   从 HTML 中获取对应的微格式属性的值
            *   **将在 HTML 中找到的值注入到字段中（即`T`在第一步创建的类型的对象上设置字段的值）**
            *   将类型的对象添加`T`到`List<T>`
    *   返回`List<T>`，它现在包含一堆微格式对象

我正在尝试找出一种更好的方法来实现**粗体**中的步骤。问题在于，`Type`微格式类中给定字段的属性不仅决定了要在 HTML 中查找的节点，还决定了如何解释数据。

例如，回到`HCard`我上面定义的类，`"email"`属性绑定到`EmailAddresses`字段，即`List<string>`. 解析器在 HTML 中找到`"email"`父`"vcard"`节点的所有子节点后，必须将它们放在一个`List<string>`.

更重要的是，如果我希望我`HCard`能够返回电话号码信息，我可能希望能够声明一个新的类型字段`List<HCard.TelephoneNumber>`（它将具有自己的`ContainerName("tel")`属性）来保存该信息，因为其中可以有多个`"tel"`元素HTML，并且`"tel"`格式有它自己的子属性。但现在解析器需要知道如何将电话数据放入`List<HCard.TelephoneNumber>`.

同样的问题适用于`Float`S、`DateTime`S、`List<Float>`S、`List<Integer>`S 等。

显而易见的答案是让解析器打开字段类型，并为每种情况进行适当的转换，但我想避免一个巨大的`switch`声明。请注意，我不打算让解析器支持所有可能`Type`的存在，但我希望它能够处理大多数标量类型及其`List<T>`版本，以及识别其他微格式类的能力（以便微格式类可以由其他微格式类组成）。

关于如何最好地处理这个问题的任何建议？

由于解析器必须处理原始数据类型，我认为我不能在类型级别添加多态性......

我的第一个想法是使用方法重载，所以我会有一系列`GetPropValue`重载，如`GetPropValue(HtmlNode node, ref string retrievedValue)`,`GetPropValue(HtmlNode, ref List<Float> retrievedValue)`等，但我想知道是否有更好的方法来解决这个问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-16T07:16:32.787

Mehrdad 的方法基本上是我建议开始的方法，但作为潜在更多的第一步。

您可以对单一类型（字符串、原语等）使用简单的`IDictionary<Type,Delegate>`（每个条目实际上是从`T`到`Func<ParseContext,T>`- 但不能用泛型表示），但随后您还需要检查列表、映射等。你赢了'不能使用地图来做到这一点，因为您必须为每种类型的列表都有一个条目（即，单独的条目`List<string>`等`List<int>`）。泛型使这变得非常棘手 - 如果您乐于将自己限制*在*某些具体类型，例如`List<T>`您将使自己更容易（但不太灵活）。例如，检测`List<T>`很简单：

```
if (type.IsGenericType && type.GetGenericTypeDefinition() == typeof(List<>))
{
    // Handle lists
    // use type.GetGenericArguments() to work out the element type
} 
```

检测一个类型是否`IList<T>`为某些实现`T`（然后发现`T`）可能会很痛苦，特别是因为可能有多个实现，并且具体类型本身可能是也可能不是通用的。如果您真的需要成千上万的开发人员使用的非常灵活的库，那么这项努力可能是值得的——但否则我会保持简单。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-16T07:05:23.187

您可以构建一个将字符串映射到委托的字典，而不是大型 switch 语句，并在您想要使用适当的方法进行解析时查找它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T07:51:06.197

这与我的序列化引擎 ( [protobuf-net](http://code.google.com/p/protobuf-net/) ) 面临的问题非常相似。我只是将其分解为常见的逻辑集 -`IList<T>`等等（尽管有一个大的逻辑/类型测试来处理各种原语）。我使用的方法是：只做一次......构建一个基于接口/基类的模型，可以处理不同类型的属性，并从那里开始工作。我在通用缓存类的静态初始化程序中执行此操作 - 即`Foo<T>`；当 T 为 时`HCard`，我预先计算一个模型（即，我为每个属性创建一个可以解析/呈现该属性并存储它们的对象），让我`HCard`以后无需再考虑就可以进行处理。

我并不是说它是地球上最好的代码，但它似乎工作正常。

# python - 在 Python 2.5 中使用 Python 2.6 子进程模块

> ID：552423
> 
> 赞同：10
> 
> 时间：2009-02-16T06:41:55.817
> 
> 标签：python, subprocess, python-2.5

我想使用 Python 2.6 的子进程版本，因为它允许[Popen.terminate()](http://docs.python.org/library/subprocess.html#subprocess.Popen.terminate)函数，但我坚持使用 Python 2.5。在我的 2.5 代码中是否有一些相当干净的方法来使用模块的较新版本？某种`from __future__ import subprocess_module`？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-16T22:43:43.167

我知道这个问题已经得到了回答，但是对于它的价值，我已经`subprocess.py`在 Python 2.3 中使用了 Python 2.6 附带的那个，它运行良好。如果您阅读文件顶部的评论，它会说：

> `# This module should remain compatible with Python 2.2, see PEP 291.`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-16T07:39:07.177

真的没有一个很好的方法来做到这一点。subprocess 是[在 python 中实现的](http://svn.python.org/view/python/trunk/Lib/subprocess.py?rev=69620&view=markup)（而不是 C），因此您可以想象将模块复制到某处并使用它（当然希望它不使用任何 2.6 的优点）。

另一方面，您可以简单地实现子进程声称要做的事情，并编写一个在 *nix 上发送 SIGTERM 并在 Windows 上调用 TerminateProcess 的函数。以下实现已经在 linux 和 Win XP vm 上进行了测试，您需要[python Windows 扩展](http://sourceforge.net/projects/pywin32/)：

```
import sys

def terminate(process):
    """
    Kills a process, useful on 2.5 where subprocess.Popens don't have a 
    terminate method.

    Used here because we're stuck on 2.5 and don't have Popen.terminate 
    goodness.
    """

    def terminate_win(process):
        import win32process
        return win32process.TerminateProcess(process._handle, -1)

    def terminate_nix(process):
        import os
        import signal
        return os.kill(process.pid, signal.SIGTERM)

    terminate_default = terminate_nix

    handlers = {
        "win32": terminate_win, 
        "linux2": terminate_nix
    }

    return handlers.get(sys.platform, terminate_default)(process) 
```

这样你只需要维护`terminate`代码而不是整个模块。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T07:57:50.160

虽然这不能直接回答您的问题，但可能值得了解。

Imports from`__future__`实际上只会更改编译器选项，因此虽然它可以将 with 转换为语句或使字符串文字生成 unicode 而不是 strs，但它不能更改 Python 标准库中模块的功能和特性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-19T21:21:16.180

我遵循了关于在 python 2.5 中使用 python 2.6 subprocess.py 的 Kamil Kisiel 建议，并且效果很好。为了使它更容易，我创建了一个 distutils 包，您可以轻松安装和/或包含在 buildout 中。

要在 python 2.5 项目中使用来自 python 2.6 的子进程：

```
easy_install taras.python26 
```

在你的代码中

```
from taras.python26 import subprocess 
```

在扩建中

```
[buildout]
parts = subprocess26

[subprocess26]
recipe = zc.recipe.egg
eggs = taras.python26 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-21T05:57:12.030

以下是在 Windows 上结束进程的一些方法，直接取自 [http://code.activestate.com/recipes/347462/](http://code.activestate.com/recipes/347462/)

```
# Create a process that won't end on its own
import subprocess
process = subprocess.Popen(['python.exe', '-c', 'while 1: pass'])

# Kill the process using pywin32
import win32api
win32api.TerminateProcess(int(process._handle), -1)

# Kill the process using ctypes
import ctypes
ctypes.windll.kernel32.TerminateProcess(int(process._handle), -1)

# Kill the proces using pywin32 and pid
import win32api
PROCESS_TERMINATE = 1
handle = win32api.OpenProcess(PROCESS_TERMINATE, False, process.pid)
win32api.TerminateProcess(handle, -1)
win32api.CloseHandle(handle)

# Kill the proces using ctypes and pid
import ctypes
PROCESS_TERMINATE = 1
handle = ctypes.windll.kernel32.OpenProcess(PROCESS_TERMINATE, False, process.pid)
ctypes.windll.kernel32.TerminateProcess(handle, -1)
ctypes.windll.kernel32.CloseHandle(handle) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-16T07:38:05.400

好吧，Python 是开源的，您可以自由地从 2.6 中获取该 pthread 函数并将其移动到您自己的代码中，或者将其用作实现您自己的代码的参考。

出于显而易见的原因，没有办法拥有可以导入部分较新版本的 Python 混合体。

# architecture - 实现模块化架构的 RFC

> ID：552424
> 
> 赞同：0
> 
> 时间：2009-02-16T06:42:29.950
> 
> 标签：architecture, service, high-availability

寻找关于 Web 应用程序模块化的意见。无论语言如何，大多数应用程序都已经有一个后端数据库，并支持与它们各自的 Web 应用程序服务器（Apache、IIS、Lighttp 等）捆绑，但是我处理过的很多开发人员在使用 Memcached 或任何东西时都遇到了问题在 Web 应用程序的直接进程空间之外。

Web 应用程序的模块化是否像我认为的那样是一件好事，或者我是否缺少某些东西，导致从高级开发人员到 CTO 的每个人都不愿将业务逻辑的特定部分移出 Web 前端并进入专门的后端服务？

例如，几年前，我在一个非常高流量的网站的项目设计会议上被击落，当时我建议我们将流程密集型 ACL 逻辑从前端框架中剥离出来，并将其变成一个半集群化的服务应用程序。后端。对我来说，好处是代码的更清晰的分离以及通过使用 REST/JSON 作为 PHP 和 Python 之间的桥梁在多个地方重用 ACL 逻辑的能力。

不同意我的想法的开发人员认为它“太复杂了”，但我就是不明白怎么做？我的论点是，就像表示层可以有标签汤一样，也可以而且经常有代码的逻辑汤，它们如此紧密地结合在一起，以至于如果出现问题，执行“外科手术”修复可能几乎是不可能的。

因此，为了缩短它，将大型应用程序分解为独立但协作的进程（不是线程或子请求）的缺点和优点是什么。MySQL、Memcache、类似的服务流程都很棒……但为什么不呢？走这条路怎么“太复杂”了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T06:54:50.670

嗯，有时“太复杂”意味着“我不想在我的舒适区之外思考”。

基本概念听起来不错——您在这里谈论的是相当合理的面向服务的架构。

现在，就利弊而言，反对它的第一件事是你*确实*必须让人们在他们的舒适区之外思考。一个更具技术性的问题是您需要保留实际上是会话状态的内容。假设您从身份验证服务中获取身份验证令牌；该令牌如何与正确的用户会话保持关联。

另一个问题是它可能更难调试，因为它发生得更加动态。

不过，在专业方面，如果您能够满足会话状态问题，您将获得一个高度可扩展的架构；如果您需要更多服务，您可以扩大服务器或简单地添加另一台服务器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T07:08:44.397

我喜欢将核心服务器/业务逻辑功能与 Web 应用程序代码分离。这是出于几个不同的原因：

1.  您可以更好地控制业务逻辑。将无法将其与 GUI 代码混合并造成混乱。您希望将所有业务逻辑分开，以便以后可以创建一个 API 来调用代码功能，而不希望没有业务逻辑进入 GUI 代码。
2.  从一开始，您就必须设计一个好的 API，您必须自己使用它来从客户端与您的服务器进行通信。客户端可以是 Web 界面，也可以是远程用户。
3.  稳定。GUI Web 代码很容易写错并消耗太多内存，从而导致整个应用程序瘫痪。
4.  要进行扩展，您可以将这些单独的组件移动到不同的服务器。如果您使用的是已经允许集群扩展的缓存系统，那么只需添加更多缓存服务器即可。
5.  我发现应用程序更新最常针对 GUI 代码进行，因此大部分时间不必关闭核心服务。
6.  安全。您可以确定安全代码是在服务器代码中实现的，因此如果有人使用您的 API，他们将无法绕过任何进入 GUI 代码的安全代码。

我们的系统有一个作为 Java 应用程序实现的核心“引擎”服务。Web 应用程序也是用 Java 编写的，并且（当前）通过 RMI 进行通信。我们的站点/应用程序正在增长，我们还没有开始使用像 memcached 或 JCS 这样的缓存服务。

# powershell - PowerShell Exchange 2003 任务：有没有办法查询是否启用了 ActiveSync？

> ID：552431
> 
> 赞同：0
> 
> 时间：2009-02-16T06:48:34.710
> 
> 标签：powershell, active-directory, activesync, exchange-server-2003

在运行 Exchange 2003 的 Windows 2003 Server 上使用 Quest PowerShell，是否可以查询用户的 ActiveSync 或 OMA 是启用还是禁用？

* * *

编辑：这可以说是2008 年 12 月 3 日[您自己的问题的重复。](https://stackoverflow.com/questions/338428/exchange-powershell-is-there-a-way-to-query-who-are-activesyncbb-users)

编辑：该问题涉及 Exchange 2007。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-16T11:26:54.027

试试这个代码：

```
function Get-OmaAdminWirelessEnable($obj)
{
    switch($obj)
    {
        $null {"N/A"; break}
        0 {"Enabled"}
        1 {"ActiveSync is Disabled"; break}
        2 {"OMA is Disabled"; break}
        4 {"Disable Always Up-To-Date (AUTD)"; break}
        7 {"All ActiveSync Features disabled"; break}
        default {"Unknown"}
    }
}
$oma = @{name="OMA";expression={ Get-OmaAdminWirelessEnable 
$_.msExchOmaAdminWirelessEnable }}
Get-QADUser -sizeLimit 0 -IncludedProperties msExchOmaAdminWirelessEnable | 
select name,$oma 
```

# java - Eclipse RCP：操作 VS 命令

> ID：552435
> 
> 赞同：25
> 
> 时间：2009-02-16T06:51:12.440
> 
> 标签：java, eclipse, command, action, rcp

Eclipse RCP 上下文中的操作和命令有什么区别？我知道它们都对菜单条目做出了贡献，但哪个更好？为什么？

在我阅读的所有在线资源中，我无法深入了解两者之间的差异。我实际上并没有尝试使用它们，只是想从更高层次的角度了解它们。

谢谢

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-02-16T07:01:52.197

您是否阅读过 eclipse wiki[常见问题解答 命令和操作之间的区别是什么？](http://wiki.eclipse.org/FAQ_What_is_the_difference_between_a_command_and_an_action%3F)

> 您可能已经了解 Actions 和 Commands 基本上做同样的事情：它们会导致执行某段代码。它们主要由用户界面中的人工制品触发
> 
> **Actions**的主要关注点是**表现形式和代码都存储在 Action 中**。
> 尽管 Action Delegates 中有一些分离，但它们仍然与底层操作相关联。选择事件被传递给操作，以便它们可以根据当前选择更改其启用状态（以编程方式）。这不是很优雅。此外，要将操作放在某个工作台部件上，您必须使用多个扩展点。
> 
> **命令**几乎可以解决所有这些问题。基本思想是**命令只是一些要执行的代码的抽象思想。代码的实际处理是由 handlers 完成的**。处理程序由工作台的特定状态激活。该状态由平台核心表达式查询。这意味着我们只需要一个全局 Save 命令，该命令的行为会根据当前活动的处理程序而有所不同。

![命令的属性](https://i.stack.imgur.com/zyeAz.gif)

本文详细[介绍](http://blog.eclipse-tips.com/2009/01/commands-part-1-actions-vs-commands.html)了差异

**行动**：

*   **UI 和处理总是捆绑在一起**的。没有办法彼此分开
*   虽然动作可以贡献给工作台的不同部分（弹出菜单/工具栏），但它们都是**不同的扩展点**，因此您最终会在多个位置复制 XML。最糟糕的是，并非所有扩展点都期望相同的配置。
*   在多个地方指定操作是一场**维护噩梦**。如果你必须改变一个动作的图标，你需要改变所有的地方。
*   在 plugin.xml 中复制 Actions 的另一个问题是，**将在内存中创建相同 Actions 的多个实例**。

命令涉及更多扩展点，但是：

*   处理程序可以与命令分开声明。这允许对**同一命令进行多个处理程序声明**。
*   对所有处理程序的**activeWhen**进行评估，并选择对最具体的条件返回 true 的处理程序。所有这些事情都是**在没有将你的处理程序加载到内存中的情况下完成的。即使没有加载你的插件**！
*   定义参数就是返回显示名称和 id 的映射。名称将显示在键绑定页面中，并且 id 将用于在按下键序列时调用命令。
*   定义一个 IExecutionListener，它只是命令执行的观察者，因此它既不能否决它也不能对事件进行任何更改

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-16T07:36:05.517

只是添加到 VonC 的出色答案，如果您的应用程序相对较小，命令可能有点矫枉过正。它们相对更难设置，当您拥有多个视角、编辑器和视图时，它们最闪耀。

对于简单的事情，我会采取行动。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-06-14T08:09:59.200

请记住，以后版本的 Eclipse 可能会弃用 Action。我建议您从一开始就使用 Command 。

# c# - 为什么我的 .NET 应用程序中出现 System.Security.Permissions.SecurityPermission 错误？

> ID：552436
> 
> 赞同：0
> 
> 时间：2009-02-16T06:51:29.367
> 
> 标签：c#, .net, exception, .net-3.5, text-to-speech

我正在尝试使用 C# 在 .NET 3.5 中开发文本转语音编辑器。我遇到了以下异常：`System.Security.Permissions.SecurityPermission`.

如何处理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T07:17:08.447

系统表示有人试图做一些根据当前政策不允许的事情。需要更多信息才能在此处提供好的建议：

1）异常消息的全文是什么？有[十几种情况](http://msdn.microsoft.com/en-us/library/system.security.permissions.securitypermissionflag.aspx)会导致 SecurityPermission，所以这很重要。具体来说，有一个标志字段指示安全违规的确切性质。

2）环境是什么？文件是存储在本地还是网络共享？在 3.5 SP1 之前，从网络共享运行的应用程序始终是部分信任的。您是否安装了 .NET 3.5 SP1？

# c# - 将 C# 类库导入 Visual C++

> ID：552446
> 
> 赞同：0
> 
> 时间：2009-02-16T06:56:14.410
> 
> 标签：c#, c++, dllimport

我有一个 C# 类库，其中包含需要与外部应用程序一起使用的方法。不幸的是，这个外部应用程序只支持 C/C++ 中的外部 API。

假设我在这个 C# 库中有一个 takeIntReturnDoubleArray 方法，它接受一个整数并返回一个双精度数组。我需要做的就是有一个 C++ 方法，它接受一个整数，调用 C# 库并将一个双精度数组返回给调用应用程序。

所以本质上，C++ 库只是充当 C# 包装器和外部应用程序之间的中介。

是否有捷径可寻？我是否必须在 C# 方面做一些特别的事情才能轻松地将其导入 C++？我看过一些关于使用#import 语句的讨论，但我真的不知道我在使用 C++ 时在做什么。

我应该在这里采取什么方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T07:02:07.093

您在这里有两个主要选择：

1.  C++\CLI - 这允许您在同一个源文件中同时拥有托管和非托管代码。然后托管部分可以调用 C# 代码。
2.  COM Interop - 将您的 .NET 类型公开为 COM 接口和匹配的 coclass，您可以轻松地从非托管 C++ 中使用它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T07:01:51.090

COM Interop 是解决此问题的一种方法。对于要公开给 C++ 应用程序的 C# 库函数，您必须有一个 COM 层。这（[http://msdn.microsoft.com/en-us/library/aa302324.aspx#usingframeworktools_topic10](http://msdn.microsoft.com/en-us/library/aa302324.aspx#usingframeworktools_topic10)）可能很有趣。

# perl - *PIPER 在 Perl 中是什么意思？

> ID：552453
> 
> 赞同：2
> 
> 时间：2009-02-16T07:04:29.023
> 
> 标签：perl, filehandle, typeglob

我需要一些帮助来理解以下 Perl 代码片段。我有以下两个问题。

1\. 本地是什么`*PIPER`意思？尽管在`local *`语法对我来说是新的之前我已经完成了一些 Perl 编程。是指针吗？

2\. 目的是什么

```
curl http://www.somesite.net/cgi-bin/updateuser.cgi? -d "userid=$userid&password=$password\" -s |"; ? 
```

谢谢你 ：）

```
local *PIPER;

$http_query = "curl http://www.somesite.net/cgi-bin/updateuser.cgi? -d \"userid=$userid&password=$password\" -s |";

open(PIPER,$http_query) or die "sorry";

while(<PIPER>)
{
   $rets = $_;

}

close(PIPER);

return $rets; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-16T07:09:46.577

1) " `*PIPER`" 是一个类型团。它是“ `$PIPER`”、“ `@PIPER`”和“ `%PIPER`”（然后是一些）合而为一。他们将所有`*PIPER`名称声明为您拥有的代码片段的本地名称。

2）这是一个shell命令。它以 a 结尾，`|`这意味着该命令正在运行，并且它的输出作为 filehandle 的输入被输入`PIPER`。然后程序用 逐行读取`while(<PIPER>)`，但你已经知道了。

我不太了解`curl`，但我知道它是一个用于在 Internet 上进行操作的命令行程序。只是随机刺伤，您的代码似乎正在访问网站的 CG​​I 脚本并向其发送一些信息。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-16T23:08:10.610

正如其他人所指出的，`*PIPER`它是一个 typeglob，因此您可以动态地确定 PIPER 文件句柄的范围。不过那是古老的 Perl。改用词法文件句柄：

```
子富{
    我的 $http_query = "...";

    打开我的（$piper），$http_query 或死“对不起”；

    尽管（）
        {
        $rets = $_;
        }

    返回$rets；
    }

```

不过，您无需执行任何操作即可将 POST 请求发送到服务器。[您可以使用LWP](http://search.cpan.org/dist/libwww-perl)在 Perl 中完全做到这一点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-16T07:22:46.280

`local *PIPER;`正在声明`PIPER`文件句柄是本地的。由于文件句柄没有自己的类型符号，因此它们需要被 typeglobs 捕获才能声明为本地的。

`curl`类似于`wget`; 它用于传输 URL。有关`man curl`更多详细信息，请参阅，但`-d`开关（数据）在 POST 操作中将以下字符串作为数据传递，并且`-s`开关（静默）抑制错误输出和进度表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T07:32:34.430

2) 这个 curl 的实际调用会发送一个带有文本“userid=$userid&password=$password”的 HTTP POST 请求到 [http://www.somesite.net/cgi-bin/updateuser.cgi](http://www.somesite.net/cgi-bin/updateuser.cgi)？并输出来自服务器的响应（到管道）。-s 标志从任何内容中去除输出，除了来自服务器的内容（例如错误消息或进度表）。

# sql-server-2008 - 为什么 SQL Server 2008 Management Studio Intellisense 不工作？

> ID：552458
> 
> 赞同：179
> 
> 时间：2009-02-16T07:06:13.323
> 
> 标签：sql-server-2008, intellisense

我被逼疯了，试图弄清楚为什么 Intellisense 根本无法工作。我使用的服务器是本地的，是 2008，数据库设置为 2008 兼容性，Intellisense 在我能找到的每个菜单中都打开，但即使使用 CTRL-J 也不会弹出成员列表。

有没有人经历过这样的事情并找到解决方法？除非我有 Intellisense 工作，否则我真的无法让自己开始工作。

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2011-12-13T17:10:15.450

我知道这篇文章很旧，但是如果有人仍在搜索并且即使在重新安装、应用累积更新或其他方法后仍未找到解决智能感知问题的方法，那么我希望我能提供帮助。

我已应用 SQL 2008 R2 Service Pack 1，您可以在此处下载

[http://www.microsoft.com/download/en/details.aspx?id=26727](http://www.microsoft.com/download/en/details.aspx?id=26727)

**32位**：SQLServer2008R2SP1-KB2528583-x86-ENU.exe

**64位**：SQLServer2008R2SP1-KB2528583-x64-ENU.exe

我已经应用了这个 SP1，现在我的智能感知又可以工作了。我希望这有帮助！（：

* * *

## 回答 #2

> 赞同：87
> 
> 时间：2011-05-03T09:58:14.330

Visual Studio 2010 SP1 破坏了 SSMS 2008 R2 的 IntelliSense。有一个关于这个的[连接](https://connect.microsoft.com/SQLServer/feedback/details/650569/ssms-2008-r2-is-losing-intellisense-after-installing-visual-studio-2010-sp1)，幸运的是也有一个[解决方法](http://support.microsoft.com/kb/2531482)。

（*简而言之*，您需要通过请求 *或请求*[为 SQL Server 2008 R2 安装累积更新包 7](http://support.microsoft.com/kb/2507770)`SQLServer2008R2_RTM_CU7_2507770_10_50_1777_x86`

 *`SQLServer2008R2_RTM_CU7_2507770_10_50_1777_x64`

来自[此修补程序请求页面](http://support.microsoft.com/hotfix/KBHotfix.aspx?kbnum=2507770&kbln=en-us)。）

**编辑**：正如@Paul Lemke 所指出的，可能需要获得最新的 CU 包。[此博客](http://blogs.msdn.com/b/sqlreleaseservices/)包含 SQL Server 版本。（在撰写本文时，最新的是[CU14](http://support.microsoft.com/kb/2703280)）

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2011-07-18T10:46:18.687

对于 SQL Server 2008 R2，安装[累积更新 7](http://support.microsoft.com/hotfix/KBHotfix.aspx?kbnum=2507770&kbln=en-us)将解决该问题。你需要的文件是

`SQLServer2008R2_RTM_CU7_2507770_10_50_1777_x86`
*或者*
`SQLServer2008R2_RTM_CU7_2507770_10_50_1777_x64`

我还必须先卸载并重新安装 SQL Server 2008（它没有修复它，但 CU 修复了它）。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-04-16T14:32:14.657

无需重新安装。

单击设置文件。然后转到维护并单击修复。这应该可以纠正智能感知问题。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2011-01-21T18:36:53.780

我只是有同样的问题。我发现在我使一些数据库脱机并执行 Intellisense 刷新 (Ctrl-Shift-R) 后，Intellisense 停止工作。我让离线数据库重新上线，再次刷新（Ctl-Shft-R），瞧！Intellisense 又开始工作了。

多么糟糕的设计。当数据库存在但处于脱机状态时，Intellisense 列表的数量可能会阻塞。感谢微软。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2011-07-06T23:37:16.880

我不想不按顺序推荐产品，因为让 Intellisense 运行可能是最好的选择，但几个月来我一直在为 Management Studio 上该死的没有智能感知而苦苦挣扎。重装、CU7更新、刷新缓存、祭鸡祭神；没有任何帮助。

当我发现 SqlComplete 时，我正要为 RedGate 的 SqlPrompt（非常昂贵，195 美元）买单。

[http://www.devart.com/dbforge/sql/sqlcomplete/?gclid=CN2xs_Lw7akCFcYZHAodpicXXw](http://www.devart.com/dbforge/sql/sqlcomplete/?gclid=CN2xs_Lw7akCFcYZHAodpicXXw)

有一个基本的免费版本，完整版只需 50 美元！

我是一名数据库架构师，虽然我能记住命令，但自动完成为我节省了大量时间。如果您遇到困难并且无法让 Intellisense 工作，请尝试 SqlComplete。它为我节省了几个小时的麻烦。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2012-02-11T05:39:12.780

我最近写了一篇关于 IntelliSense 故障排除的技巧。标题说的是 SQL Server 2012，但大多数技术也可以应用于早期版本的 Management Studio。

*   [SQL Server Management Studio 中的 IntelliSense 疑难解答](http://www.mssqltips.com/sqlservertip/2591/troubleshooting-intellisense-in-sql-server-management-studio-2012/?utm_source=AaronBertrand)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-17T18:35:08.433

我最终通过重新安装 SQL Server 2008 来修复它。这根本不是最佳的，但如果有人遇到类似的问题，一定要知道这条路线可能会奏效。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-02-22T23:13:11.267

我尝试了所有修复 - 使数据库脱机然后使其联机，安装累积更新 10，修复 SQL Server 安装，刷新本地缓存，更改 SQL Server Management Studio 上所需的设置，但一切都是徒劳的。最后安装正确的服务包（SP1）对我有用！

按照下面的链接，下载 SQLServer2008R2SP1-KB2528583-x86-ENU.exe（或用于 x64 位 SQL Server 实例的 x64 文件）

[http://www.microsoft.com/download/en/details.aspx?id=26727](http://www.microsoft.com/download/en/details.aspx?id=26727)

最后我启用了智能感知！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-08-17T16:04:57.473

我在这里发布这个，因为我相信更多的人会遇到这个问题。我安装了 Microsoft Visual Studio 2010 Service Pack 1 (KB2565057) 的安全更新，并在 SQL Server Management Studio 2008（不是 R2）中丢失了 Intellisense。

SP的卸载恢复了Intellisense ..你不只是喜欢微软吗？？？？

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-09-06T09:15:56.160

找到这个线程后，我发现我的 Intellisense 只是在使数据库脱机后才崩溃，并且实例上的任何脱机数据库都会杀死 Intellisense。

在[此线程](http://connect.microsoft.com/SQLServer/feedback/details/566786)中，解释说要恢复 Intellisense，您必须

*   使必要的数据库脱机，然后
*   重启服务器实例，最后
*   刷新 Intellisense 缓存。

这个过程对我有用，Intellisense 现在又可以工作了。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-06T17:12:25.403

我也有同样的问题。在网上到处搜索，找不到解决方案。我确实安装了 Redgate 的 SQL Prompt，其功能类似于 Intellisense，所以可能存在冲突。从那以后，我已经停止了 Prompt 的运行，但现在根本没有智能感知。使用 SQL Server 2008 会关闭 SQLCMD 模式，一点运气都没有。这种情况以前发生过，重新安装 SQL Server 是我唯一可以开始工作的事情。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-08-16T19:37:36.627

同样的问题，但只是重新安装 SQL Management Studio 2008 R2 Service Pack 1 对我有用。我独自离开了我的数据库引擎。数据库引擎不是问题，只是 SQL Management Studio 被 Visual Studio SP1 淹没了。

安装人员在这里...

[http://www.microsoft.com/download/en/details.aspx?displaylang=en&id=26727](http://www.microsoft.com/download/en/details.aspx?displaylang=en&id=26727)

我安装了**SQLManagementStudio_x86_ENU.exe**（我的机器为 32 位）。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-06-15T17:19:40.440

在尝试接受的答案时，我收到安装错误：检测到以前的安装、补丁或修复失败等等等等。

为了解决这个问题，在我的注册表中，我将以下键中的所有 DWORD 值更改为 1：（一如既往地小心修改注册表并 在更改任何内容之前[创建键的备份）](http://antivirus.about.com/cs/tutorials/ht/regkey.htm "创建密钥的备份")

HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\100\ConfigurationState HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSAS10_50.MSSQLSERVER\ConfigurationState HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSRS10_50.MSSQLSERVER\ConfigurationState HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL10.SQLEXPRESS\ConfigurationState HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQL10_50.MSSQLSERVER\ConfigurationState

请参阅我关于[在 SSMS 中修复 Intellisense 问题的](http://www.someguyssite.com/technology/intellisense-not-working-in-sql-server-management-studio/ "修复 SSMS 智能感知")完整帖子。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-08-10T13:49:42.667

这是来自 MS 的官方消息。

[http://support.microsoft.com/kb/2531482](http://support.microsoft.com/kb/2531482)

他们的解决方法和上面一样，安装 SQL Server 2008 R2 更新版本为 10.50.1777.0。

[http://support.microsoft.com/kb/2507770](http://support.microsoft.com/kb/2507770)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-06-25T17:29:53.990

我做了以上所有，最终放弃了。最后一个办法是我发现了 devArt 的 SQL Complete Express 的第三方 SQL Intellisense 插件。

它是 Intellisense 以及更多功能。Intellisense 回来了，一切都很好。

支持 SSMS 2005 - 2012 还包括 Visual Studio 加载项。

[SQL 完成](http://www.devart.com/dbforge/sql/sqlcomplete/download.html)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-09-26T12:59:24.900

对于 SQL Server 2008 R2，安装累积更新 7 将解决该问题。你需要的文件是

**SQLServer2008R2_RTM_CU7_2507770_10_50_1777_x86** 或 **SQLServer2008R2_RTM_CU7_2507770_10_50_1777_x64**

我还必须先卸载并重新安装 SQL Server 2008（它没有修复它，但 CU 修复了它）。

这是来自 MS 的直接链接，我得到了它的[修补程序](http://hotfixv4.microsoft.com/SQL%20Server%202008%20R2/nosp/SQLServer2008R2_RTM_CU7_2507770_10_50_17/10.50.1777.0/free/431249_intl_i386_zip.exe)

# linq-to-sql - 实现 IEnumerable

> ID：552462
> 
> 赞同：4
> 
> 时间：2009-02-16T07:11:28.477
> 
> 标签：linq-to-sql, generics

我正在使用 LINQ，并且很难理解如何在跨表查询时使新的“域模型”类在 LINQ 中工作。我在 .NET 3.5 中使用 Linq to SQL 和 C#。

假设我想要一个扩展客户端类：

```
public class ExtendedClient 
{
    public int ID { get; set; }
    public string Name { get; set; }
    public string strVal { get; set; }
} 
```

在我的数据层中，我想从两个表中填充它（dc 是我的 DataContext）：

```
public ExtendedClient getExtendedClient(int clientID)
{
    var c = dc.GetTable<tClient>();
    var cs = dc.GetTable<tClientSetting>();
    var q = from client in c
            join setting in cs
            on client.ClientID equals setting.ClientID
            where client.ClientID == clientID
            select new ExtendedClient { client, setting.strValue };
    return q;   
} 
```

我试图返回表 tClient 中的行加上 tClientSetting 中的一个额外列。

我得到的烦人错误是：无法使用集合初始化程序初始化类型“ExtendedClient”，因为它没有实现“System.Collections.IEnumerable”，并且无法将类型“System.Linq.IQueryable”隐式转换为“ExtendedClient”。存在显式转换（您是否缺少演员表？）

我意识到这是一个基本错误，但我无法确定如何最好地实现 IEnumerable，因为我找不到示例。

*每次*我想要一个专门的对象时都必须这样做吗？提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-16T07:25:41.267

```
public ExtendedClient getExtendedClient(int clientID)
{
    var c = dc.GetTable<tClient>();
    var cs = dc.GetTable<tClientSetting>();
    var q = from client in c
            join setting in cs
            on client.ClientID equals setting.ClientID
            where client.ClientID == clientID
            select new ExtendedClient { ID = client.ClientID, Name = client.Name, strVal = setting.strValue };
    return q.Single();
} 
```

*每次您需要**返回**一个专门的对象*时，您都必须做类似的事情。如果您不需要返回它，则不必指定类型，也不需要特殊的类。您可以使用匿名类型：

```
from client in c
join setting in cs
on client.ClientID equals setting.ClientID
where client.ClientID == clientID
select new { ID = client.ClientID, Name = client.Name, strVal = setting.strValue }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T08:07:55.080

为什么要为此使用特殊类型？

我认为`client.Settings.strValue`如果您设置 Client-Settings 关系以创建属性`Client.Settings`（而不是`Settings.Client`），您可以这样做。据我记得这样的配置在 LINQ 中是可能的。

# filter - DataView.RowFilter，多列上的多个可能值

> ID：552465
> 
> 赞同：0
> 
> 时间：2009-02-16T07:13:50.390
> 
> 标签：filter, dataview

我有一个数据视图，其中有趣的列是长度、高度、颜色 1 和颜色 2，其中颜色 1 和颜色 2 可以是黄色、红色、蓝色、黑色、白色或绿色中的任何一种。在我得到具有一定长度和高度但只有红色、蓝色和绿色颜色的行的情况下，应用过滤器的最佳方法是什么？

当可能的颜色增加时，下面的过滤器感觉有点“难看”：

`"length > 10 AND height > 10 AND (color1 = 'red' OR color1 = 'blue' OR color1 = 'green') AND (color2 = 'red' OR color2 = 'blue' OR color2 = 'green')"`

或者这是唯一/最简单的方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-16T07:16:44.533

不幸的是，这是“SQL 风格”查询的本质 :)

该`IN`子句可能会使该查询更简单：

```
"length > 10 AND height > 10 AND color1 IN ('red', 'blue', 'green') AND color2 IN ('red', 'blue', 'green')" 
```

# c# - 样式表在一个网页中不起作用

> ID：552466
> 
> 赞同：0
> 
> 时间：2009-02-16T07:15:57.217
> 
> 标签：c#, asp.net, master-pages, stylesheet

母版页中的样式表不适用于 asp.net 应用程序的一个网页，但它适用于另一个网页。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T01:22:02.217

如果您从母版页引用 css 文件，您应该确保它具有绝对路径，这样它就可以在任何地方工作。例如：

```
<head runat="server">
    <link type="text/css" rel="stylesheet" href="~/_styles/mystylesheet.css" />
</head> 
```

这里要注意的重要一点是，head 标签具有 runar="server" 属性，并且我使用波浪号（“~”）指定完整的虚拟路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T07:35:18.030

没有包含它的样式元素吗？它是否被覆盖（它们是级联样式表）？它有正确的 CSS 包含语句吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T07:42:32.300

您的页面是否位于不同级别的文件夹中？

例如，

> ..\main.css
> 
> ..\folder1\MasterPage.master
> 
> ..\folder1\css_working.aspx
> 
> ..\folder1\folder2\css_not_working.aspx

在这种情况下，您应该在 masterpage 中将您的 CSS 定义为：

```
<link rel="stylesheet" type="text/css" href="../main.css" /> 
```

并将您的页面提升到相同的水平，就像这样：

> ..\main.css
> 
> ..\folder1\MasterPage.master
> 
> ..\folder1\css_working.aspx
> 
> ..\folder2\css_not_working.aspx

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-19T06:22:34.010

如果您使用更新面板，则在某些情况下 AJAX 工具包控件的样式可能会丢失。要解决此问题，您需要将 hte 类项的全名放入样式表中，而不是让 hte 工具包处理此问题。

还要确保在可能的情况下使用相对 url，这样如果文件移动它就不会丢失它的映射。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-19T06:28:55.573

使用[Firebug](https://addons.mozilla.org/en-US/firefox/addon/1843 "萤火虫")或[Debug Bar](http://www.debugbar.com/?langage=en "调试栏")，这些工具将向您显示每个元素上使用的所有样式，因此您可以看到它正在使用哪些样式表，哪些没有。

此外，当您构建时，请检查有关它无法引用的样式表的任何警告等。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-03T19:29:09.623

这可能是文件夹的权限问题...如果您拒绝用户=“？” 在您的网络配置中.. 确保您拥有样式表的文件夹中有允许用户

# .net - 如何在不加载图像的情况下在 .NET 中可靠地获取图像尺寸？

> ID：552467
> 
> 赞同：24
> 
> 时间：2009-02-16T07:15:58.183
> 
> 标签：.net, image

我知道如何获取图像的大小 (x,y)

```
Image.FromFile("cat.jpg").Size 
```

但是这需要从内存中加载图像。

当我在 Windows 资源管理器中查看图像时，它会显示大小。

*   我如何访问该大小？
*   所有图像都可靠吗？Windows 资源管理器是否需要先“看到”该图像才能使用该大小。如果我从未打开文件夹，我不想将我的图像上传到服务器并且没有可用的元数据。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-02-16T08:44:23.433

您可以只使用[`Image.FromStream(Stream, bool, bool)`](http://msdn.microsoft.com/en-us/library/21zw9ah6.aspx)“false”第二个和第三个参数来避免将文件加载到内存中。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-16T07:38:04.340

如果您想在不加载图像的情况下获取图像尺寸（宽度和高度），您需要自己读取 jpeg 文件的某些部分，如下所示。

这是适合您的开箱即用方法:)

```
public static Size GetJpegImageSize(string filename) {
    FileStream stream=null;
    BinaryReader rdr=null;
    try {
        stream=File.OpenRead(filename);
        rdr=new BinaryReader(stream);
        // keep reading packets until we find one that contains Size info
        for(; ; ) {
            byte code=rdr.ReadByte();
            if(code!=0xFF) throw new ApplicationException(
                    "Unexpected value in file "+filename);
            code=rdr.ReadByte();
            switch(code) {
                // filler byte
                case 0xFF:
                    stream.Position--;
                    break;
                // packets without data
                case 0xD0: case 0xD1: case 0xD2: case 0xD3: case 0xD4: 
                case 0xD5: case 0xD6: case 0xD7: case 0xD8: case 0xD9:
                    break;
                // packets with size information
                case 0xC0: case 0xC1: case 0xC2: case 0xC3:
                case 0xC4: case 0xC5: case 0xC6: case 0xC7:
                case 0xC8: case 0xC9: case 0xCA: case 0xCB:
                case 0xCC: case 0xCD: case 0xCE: case 0xCF:
                    ReadBEUshort(rdr);
                    rdr.ReadByte();
                    ushort h=ReadBEUshort(rdr);
                    ushort w=ReadBEUshort(rdr);
                    return new Size(w, h);
                // irrelevant variable-length packets
                default:
                    int len=ReadBEUshort(rdr);
                    stream.Position+=len-2;
                    break;
            }
        }
    } finally {
        if(rdr!=null) rdr.Close();
        if(stream!=null) stream.Close();
    }
}

private static ushort ReadBEUshort(BinaryReader rdr) {
    ushort hi=rdr.ReadByte();
    hi<<=8;
    ushort lo=rdr.ReadByte();
    return (ushort)(hi|lo);
} 
```

这不是我的代码，在代码项目中得到了这个例子。我将其复制并保存到我的实用程序片段中，但不记得链接了。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-10-15T15:21:52.303

[阅读图像标题以获取宽度和高度](http://www.codeproject.com/KB/cs/ReadingImageHeaders.aspx)一文提供了几种解决方案的可能性：

*   多线程
*   读取文件标题，如果缺少标题，则恢复为完整图像加载
*   为图像属性创建自己的索引

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-16T07:29:35.390

这样做通常涉及实际打开文件并仅读取其标题（前几个字节）以查找其格式和大小。您无需阅读整个文件即可了解其大小。有时大小甚至在文件中的特定偏移量中，因此查找大小仅读取 8 个字节。

您可以使用[filemon.exe](http://technet.microsoft.com/en-us/sysinternals/default.aspx)实际找出 Windows 资源管理器本身查找大小的方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-10-15T15:33:05.207

从我的头顶 -`LoadImage()`有一个指定进度回调的覆盖。也许您可以在读取标题后使用它来取消加载？

# c# - 何时使用属性而不是属性？

> ID：552472
> 
> 赞同：12
> 
> 时间：2009-02-16T07:17:07.667
> 
> 标签：c#

是否存在应该在类而不是属性上使用自定义属性的特定情况？我知道属性是可取的，因为它们的可发现性和性能，但是属性......我什么时候应该**使用**它们？

更新：

[这](http://blogs.msdn.com/ericlippert/archive/2009/02/02/properties-vs-attributes.aspx)是 Eric Lippert 关于此决定的帖子。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-16T07:22:28.480

Eric Lippert 有一篇[很棒的博客文章](http://blogs.msdn.com/ericlippert/archive/2009/02/02/properties-vs-attributes.aspx)正好解决了这个决定。

他的总结是：

> 简而言之：使用属性来描述你的机制，使用属性来建模领域。

我还要补充一点，属性值实际上是静态的——换句话说，它是类型描述的一部分，而不是类型的任何实例。

当某些基本类型的每个实例都必须具有属性（例如描述）但不同的具体派生类型希望基于每个类型而不是每个实例指定描述时，可能会出现一个棘手的问题。你经常会得到总是返回常量的虚拟属性——这并不是非常令人满意。我怀疑 Delphi 的类引用*可能*在这里有所帮助......不确定。

编辑：举一个机制的例子，如果你装饰一个类型来说明它来自数据库中的哪个表，那就是描述数据传输机制，而不是说明正在传输的数据模型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T07:29:41.957

有两个用例：

1) 使用其他人定义的自定义属性，例如可以在 Main 方法上使用的 System.LoaderOptimization 属性。这些属性用于指导 CLR、WPF、WCF 或调试器等平台代码以某种方式运行代码，有时非常有用。阅读有关各种平台主题的书籍是了解何时以及如何使用这些属性的好方法。

2）创建自己的自定义属性并使用它来装饰类（或方法、属性等）。除非您还有使用反射来注意这些属性用法并以某种方式更改行为的代码，否则这些无效。应该尽可能避免这种用法，因为性能非常差，比访问类的静态成员大几个数量级。

# sql - SQL 性能 - 更好地插入和引发异常或检查是否存在？

> ID：552477
> 
> 赞同：5
> 
> 时间：2009-02-16T07:20:22.900
> 
> 标签：sql, performance, exception, duplicates

我正在考虑对我的代码中特别重要的部分进行优化。它的任务是将统计数据插入表中。其他程序对这些数据的影响相当大。否则我会考虑使用 SQL 批量插入等。

所以我的问题是...

**是否可以尝试插入一些数据，知道它可能（不太经常）为重复行抛出 SqlException？**

异常对性能的影响是否比插入前检查每一行更糟糕？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-16T07:30:06.607

首先，我的建议是在正确性方面犯错，而不是在速度方面犯错。当您完成项目并且分析显示您在插入行之前检查是否存在*大量时间，**然后才对其进行*优化。

其次，我认为如果所有 RDBMS 中都有重复项，则存在插入和跳过的语法，所以这首先应该不是问题。我尽量避免将异常作为正常应用程序流程的一部分，并将它们留给真正的例外情况。也就是说，不要指望数据库中的异常来解决代码中的逻辑问题。在您的端（代码）上保持尽可能多的一致性，并让 DB 异常仅指示真正的错误。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-16T07:37:57.617

在纯粹的性能级别上，插入数据并处理错误会更快，尤其是在错误不常见的情况下。运行选择查询以检查重复项、处理该结果，如果成功则插入，这将比插入和处理偶发错误慢得多。如果它引发异常，那么会慢一些，因为在大多数语言中异常处理都很慢，但是处理异常将比任何语言的 SQL 查询快很多倍。

正如 Assaf 所说，通常还有一种方法可以显式处理重复项，这样您就可以完全避免该错误。这将进一步提高性能，并允许您明确表明您正在以特定方式处理重复项。

是否使用存储过程取决于您 - 它可以以在数据库中添加更多逻辑为代价来提高性能。这是你必须做出的决定。我对此有过不好的经历，但这取决于 RDBMS 和您使用的语言。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T09:01:56.823

我看不到存储过程会加速单例插入，除非涉及其他处理。不过可能会带来其他好处 - 将所有逻辑保持在一个位置等。

如果有重复等，我个人会插入并捕获错误。

如果您执行 IF NOT EXISTS 检查，然后有条件地 INSERT，则事务需要持有一个锁的时间间隔，这可能会增加表上的阻塞。

对于繁忙的插入表，值得检查表的碎片程度。如果您在 Identity / Auto-number 列上使用聚集 PK 插入，则所有插入都在一端（并且索引可以具有 100% 的填充因子），但如果插入在整个聚集索引中是随机的，那么您可能会出现页面拆分等问题。

一个相关的问题是表上的统计信息可能很快就会过时，这可能会影响使用缓存查询计划等的查询的性能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T07:28:27.077

我认为最好使用存储过程，并使用 IF

IF (SELECT COUNT(*) FROM X WHERE Y=Z)=0 INSERT INTO (X) VALUES('XX')....

你可以添加一个 ELSE 条件......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-16T07:25:12.937

是的，我会一直检查。例如电子邮件地址或 IP 地址。

如果您担心性能，请使用存储过程来处理重复的逻辑。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-16T08:26:51.837

可能与这里的问题不太相关。

但是我在一个项目中工作，在以编程方式删除表之前，它用于检查表是否存在。

当我们开始优化代码时，我们将其更改为处理特定的异常，而不是在删除之前检查表是否存在。

而且我们有一些相当大的时间改进，因为我们在流程中多次使用存在性检查。

有了这种思路，我认为处理异常而不是另一个数据库查询进行检查的成本更低。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-10-13T14:31:26.333

在高负载并发环境中，检查东西是否存在是不够的，因为会有竞争条件并且行将被插入到其他存在检查之间。所以你要么必须做一个检查后锁定（它本身很容易出现竞争条件），要么再次处理异常以防其他数据能够潜入。

# c# - 无法加载文件或程序集错误

> ID：552490
> 
> 赞同：7
> 
> 时间：2009-02-16T07:28:31.213
> 
> 标签：c#, winforms, dependencies

谁能帮我找出问题所在。我正在尝试在 Visual Studio 中启动 C# winformsa 应用程序，但我不断收到此错误：

**无法加载文件或程序集，Foo.dll version1.93343 或其依赖项之一系统找不到指定的文件**

与 2005 年相比，C# 2.0

任何帮助

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-16T09:23:26.600

通常它是关于您的参考资料之一，可能在依赖关系树的深处。我通常做的是，启动 Sysinternals Process Monitor ( [http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx) )，按进程名称过滤，然后运行应用程序。在这一点上，筛选未找到的文件并找到有问题的缺失引用通常相当容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T07:46:40.077

启动[Fuslogvw.ex](http://msdn.microsoft.com/en-us/library/e74a18c4(vs.71).aspx) e 并检查找不到哪个程序集（或引用）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T07:37:31.410

这是关键部分：“或其依赖项之一”

我经常发现无法加载的程序集dll文件看起来很好。但是，它的一个依赖项（另一个程序集 dll）不存在或已被移动。

当 CLR 加载程序集时，它还将检查所有程序集依赖项是否存在。在 XCopy 部署中，这通常意味着您需要与应用程序 exe 位于同一目录中的所有依赖项程序集。

尝试将 winforms 可执行文件加载到[Reflector](http://www.red-gate.com/products/reflector/)中，然后在“yourApp.exe”下展开 References 节点以查看其他引用类型是什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T07:30:59.613

您必须在某处引用 Foo.dll 并且无法找到它（duh）。您是否在解决方案窗口中看到参考？您可以右键单击它并选择“属性”以查看路径。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-16T07:34:12.820

您是否在 Visual Studio 的解决方案资源管理器中看到参考上的感叹号？

如果是这样，那么您需要将其删除然后重新添加。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-04T09:49:27.837

值得检查您的全局 web.config 没有对该程序集的引用

# .net - 需要通过webservice在ASP.Net中生成图片

> ID：552500
> 
> 赞同：3
> 
> 时间：2009-02-16T07:34:12.570
> 
> 标签：.net, asp.net, web-services

对于我正在开发的新 asp.net 应用程序，我想在运行时使用 web 服务（返回字节）生成图像，并使用 Javascript 将其显示为图像（这样我就可以拥有 ajax 功能。

任何想法如何做到这一点？

或者关于如何在运行时生成图像并使用 Ajax（不得回发）在我的网页上显示它的任何想法，而无需将图像保存到硬盘驱动器上的任何位置？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-16T07:56:51.097

而不是让 Web 服务放置一个带有处理输入参数的查询字符串参数的 ASHX 页面。确保 Response.Content 类型为 image/png

此 ASHX 页面将动态生成图像流并将其发送到请求的图像对象。这样就没有图像文件保存在服务器上。

[这是 ASHX 完整代码的链接。](http://www.developerfusion.com/code/5223/using-ashx-files-to-retrieve-db-images/)

完成此操作后，在 JavaScript 中通过 DOM 访问图像对象并设置/更改 SRC 属性。

```
function ChangeImage(param1, param2)
{
  var url = "http://someserver/somepage.ashx?param1=" + param1 + "&param2=" + param2;
  var image1 = document.getElementById("MyImage");
  image1.src = url;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T07:43:00.990

这是让 ashx 文件为您返回图像的代码。

现在，将以下处理程序信息添加到您的 web.config

```
<httpHandlers>
  <add verb="*" path="ImageGenerator.ashx" type="MyHandlers.HttpImageHandler, MyHandlers" />
</httpHandlers> 
```

这是[Allen Guest 博客中的一些代码](http://geekswithblogs.net/aguest/Default.aspx)

图像生成器.ashx

```
namespace MyHandlers
{
      public class HttpImageHandler : IHttpHandler
      {
        private string GetExtension(string url)
        {
          string extension = "";
          if (null != url)
          {
            int indexSeperator = url.LastIndexOf(".");
            if (indexSeperator > -1)
              extension = url.Substring(indexSeperator + 1, url.Length - indexSeperator - 1).ToUpper();
          }
          return extension;
        }

        private string GetContentType(string url)
        {
          switch (GetExtension(url))
          {
            case "JPG" :
            case "JPEG" :
              return "image/jpg";
            case "PNG" :
              return "image/png";
            case "GIF" :
              return "image/gif";
            default :
              return "";
          }
        }

        private ImageFormat GetImageFormat(string url)
        {
          switch (GetExtension(url))
          {
            case "JPG" :
            case "JPEG" :
              return ImageFormat.Jpeg;
            case "PNG" :
              return ImageFormat.Png;
            case "GIF" :
              return ImageFormat.Gif;
            default :
              return ImageFormat.Bmp;
          }
        }

        private Image GetImage(string url)
        {
          HttpWebRequest wReq = (HttpWebRequest)WebRequest.Create(url);
          HttpWebResponse wRes = (HttpWebResponse)(wReq).GetResponse();
          Stream wStr = wRes.GetResponseStream();
          return Image.FromStream(wStr);
        }

        #region IHttpHandler Members
        public void ProcessRequest(HttpContext context)
        {
          string url = context.Request.QueryString["imageUrl"];
          if (null != url)
          {
            context.Response.Clear();
            context.Response.ContentType = GetContentType(url);
            Image img = GetImage(url);
            img.Save(context.Response.OutputStream, GetImageFormat(url));
          }
          context.Response.End();
        }

        public bool IsReusable
        {
          get { return false; }
        }
        #endregion
      }
} 
```

通过将图像作为 imageUrl 参数传递来对 ashx 文件进行 javascript 调用。你完成了

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T07:57:35.777

我建议您实现 HttpHandler，而不是使用 Web 服务。

我为此使用 Web 服务，您的 java 脚本代码必须从接收到的二进制数据创建一个图像，如果不是很困难，那将是笨拙的。

创建 httphandler 很简单，只需创建一个实现 IHttpHandler 接口的类，然后将其注册到您的 web.config 文件中。

如果你用谷歌搜索，你应该找到很多关于这个的资源。

至于显示图像，您可以像这样使用常规的 img-tag：

```
<img src="yourhttphandler.ashx?id=1" /> 
```

要更新它，您只需为 src 属性设置一个新值：

```
yourimage.src = "yourhttphandler.ashx?id=2"; 
```

# c++ - 交叉编译 c++ 到 iphone arm

> ID：552509
> 
> 赞同：8
> 
> 时间：2009-02-16T07:38:26.943
> 
> 标签：c++, iphone, g++, arm, cross-compiling

我浏览了（过时的）文章，这是谷歌上关于[ARM 交叉编译](http://www.ailis.de/~k/archives/19-ARM-cross-compiling-howto.html)的第一个热门文章。我还看过关于将[OpenCV 编译到 iPhone](http://lambdajive.wordpress.com/2008/12/20/cross-compiling-for-iphone/)的文章以及那里的一般交叉编译说明。我的问题是我可以像在后一篇文章中那样在 iPhone 开发人员包（我已经安装）中调用显然已经配置的 gcc/g++ 吗？很多 OpenCV 的东西对我的需求来说似乎是多余的。

如果可以，电话会是什么样子？我应该创建一个 Makefile 来让事情变得更容易吗？

另外，我需要 -lncurses 库。我可以像往常一样调用它们，还是我需要指定它的路径，因为我没有调用默认的 gcc/g++？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T08:02:26.857

如果您使用的是官方 SDK，为 iPhone 编译 C++ 就像在项目中包含 cpp 文件并点击“构建”一样简单。当然，您仍然可以进入并调整编译器开关——嗯，大部分都是。

至于 ncurses，我不确定你为什么要使用它——但你应该有的唯一限制是你不能链接到动态库——所以你必须链接目标代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-04T04:57:47.143

[一个脚本，您可以将其用作交叉编译库以进行 iOs 开发的基础。](http://robertcarlsen.net/2009/07/15/cross-compiling-for-iphone-dev-884)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T09:19:15.190

不幸的是，[n]curses 包对 iPhone 没有任何好处。
[n]curses 旨在与终端窗口一起使用。这只是不适用于 iPhone，您需要学习如何使用 Coco 开发 GUI 界面。

# regex - 如何根据文件名将文件排序到目录？

> ID：552512
> 
> 赞同：0
> 
> 时间：2009-02-16T07:40:44.287
> 
> 标签：regex, perl, string-parsing

我有大量的文件要按照一些糟糕的约定对所有文件进行排序。
这里有些例子：

(4)_mr__mcloughlin____.txt
12__sir_john_farr____.txt
(b)mr__chope____.txt
dame_elaine_kellett-bowman____.txt
dr__blackburn__.txt

这些名字应该是不同的人（说话者）。另一个 IT 部门的某个人使用一些脚本从大量 XML 文件中生成了这些文件，但正如您所见，命名非常愚蠢。

我需要为每个人使用多个文本文件对数以万计的这些文件进行排序；每个都有一些愚蠢的东西使文件名不同，无论是更多的下划线还是一些随机数。它们需要按扬声器分类。

使用脚本来完成大部分工作会更容易，然后我可以返回并合并应该使用相同名称或其他名称的文件夹。

我有很多方法可以考虑这样做。

*   解析每个文件中的名称并将它们分类到每个唯一名称的文件夹中。
*   从文件名中获取所有唯一名称的列表，然后查看此简化的唯一名称列表中的相似名称，并询问它们是否相同，一旦确定这一点，它将相应地对它们进行排序。

我打算使用 Perl，但如果值得的话，我可以尝试一门新语言。我不确定如何将目录中的每个文件名一次读入一个字符串以解析为实际名称。我也不完全确定如何在 perl 中使用正则表达式进行解析，但这可能是可搜索的。

对于排序，我只是要使用 shell 命令：

```
`cp filename.txt /example/destination/filename.txt` 
```

但只是因为这就是我所知道的，所以这是最简单的。

我什至不知道我要做什么的伪代码想法，所以如果有人知道最佳的动作顺序，我会全神贯注。我想我正在寻找很多帮助，我愿意接受任何建议。非常感谢任何可以提供帮助的人。

B.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-16T09:05:44.677

我希望我能正确理解您的问题，恕我直言，这有点模棱两可。这段代码未经测试，但应该做我认为你想要的。

```
use File::Copy;

sub sanatize {
    local $_ = shift;
    s/\b(?:dame|dr|mr|sir)\b|\d+|\(\w+\)|.txt$//g;
    s/[ _]+/ /g;
    s/^ | $//g;
    return lc $_;
}

sub sort_files_to_dirs {
    my @files = @_;
    for my $filename (@files) {
        my $dirname = sanatize($filename);
        mkdir $dirname if not -e $dirname;
        copy($filename, "$dirname/$filename");
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T07:58:22.420

我有一段时间没有使用 Perl，所以我打算用 Ruby 来写这个。我将评论它以建立一些伪代码。

```
DESTINATION = '/some/faraway/place/must/exist/and/ideally/be/empty'

# get a list of all .txt files in current directory
Dir["*.txt"].each do |filename|
  # strategy:
  # - chop off the extension
  # - switch to all lowercase
  # - get rid of everything but spaces, dashes, letters, underscores
  # - then swap any run of spaces, dashes, and underscores for a single space
  # - then strip whitespace off front and back
  name = File.basename(filename).downcase.
         gsub(/[^a-z_\s-]+/, '').gsub(/[_\s-]+/, ' ').strip
  target_folder = DESTINATION + '/' + name

  # make sure we dont overwrite a file
  if File.exists?(target_folder) && !File.directory?(target_folder)
    raise "Destination folder is a file"
  # if directory doesnt exist then create it
  elsif !File.exists?(target_folder)
    Dir.mkdir(target_folder)
  end
  # now copy the file
  File.copy(filename, target_folder)
end 
```

无论如何，这就是想法 - 我已确保所有 API 调用都是正确的，但这不是经过测试的代码。这看起来像你想要完成的吗？这可能有助于您在 Perl 中编写代码吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T08:15:25.593

所有当前文件都在同一个目录中吗？如果是这种情况，那么您可以使用 'opendir' 和 'readdir' 一个一个地读取所有文件。使用文件名作为键构建散列（删除所有 '_' 以及括号内的任何信息），这样你就得到了这样的东西 -

```
(4)_mr__mcloughlin____.txt -> 'mr mcloughlin'
12__sir_john_farr____.txt -> 'sir john farr'
(b)mr__chope____.txt -> 'mr chope'
dame_elaine_kellett-bowman____.txt -> 'dame elaine kellett-bowman'
dr__blackburn______.txt -> 'dr blackburn' 
```

将散列的值设置为到目前为止出现的名称实例数。所以在这些条目之后，你应该有一个看起来像这样的哈希 -

```
'mr mcloughlin' => 1
'sir john farr' => 1
'mr chope' => 1
'dame elaine kellett-bowman' => 1
'dr blackburn' => 1 
```

每当您在哈希中遇到新条目时，只需使用键名创建一个新目录。现在您所要做的就是将更改名称的文件（使用相应的哈希值作为后缀）复制到新目录中。因此，例如，你们中的一些人偶然发现了另一个条目，其内容为“mr mcloughlin”，然后您可以将其复制为

```
./mr mcloughlin/mr mcloughlin_2.txt 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-16T18:54:48.440

我会：

1.  定义名称中的重要内容：

    *   `dr__blackburn`不同于`dr_blackburn`? _
    *   `dr__blackburn`不同于`mr__blackburn`? _
    *   前导数字有意义吗？
    *   前导/尾随下划线有意义吗？
    *   等等
2.  提出将名称转换为目录的规则和算法（Leon's 是一个很好的开始）

3.  读入名称并一次处理一个

    *   我会使用 opendir 和递归的某种组合
    *   我会在您处理它们时复制它们；Leon 的帖子又是一个很好的例子
4.  如果将来需要维护和使用此脚本，我肯定会为每个正则表达式路径创建测试（例如使用[http://search.cpan.org/dist/Test-More/](http://search.cpan.org/dist/Test-More/)）；当你发现新的皱纹时，添加一个新的测试并确保它失败，然后修复正则表达式，然后重新运行测试以确保没有损坏

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-16T08:12:13.820

您可以使用类似的东西拆分文件名

```
@tokens = split /_+/, $filename 
```

的最后一个条目`@tokens`应该是`".txt"`所有这些文件名，但倒数第二个条目应该是相似的，因为同一个人的名字在某些地方拼写错误（或者“Dr. Jones”更改为“Brian Jones”）。您可能希望使用某种[编辑距离](http://en.wikipedia.org/wiki/Edit_distance)作为相似性度量来比较`@tokens[-2]`各种文件名；当两个条目的姓氏足够相似时，它们应该提示您作为合并的候选者。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-16T21:44:52.153

正如您提出的一个*非常笼统*的问题，只要我们有更好的规则编纂，任何语言都可以做到这一点。我们甚至没有*细节*，只有一个“样本”。

所以，盲目地工作，看起来需要人工监控。所以这个想法是一个*筛子*。您可以反复运行和检查并再次运行并反复检查，直到您将所有内容分类为一些小的手动任务。

下面的代码做***了很多假设***，因为你几乎把它留给了我们来处理。其中之一是样本是所有可能的姓氏的列表；如果还有其他姓氏，请添加它们并再次运行它。

```
use strict;
use warnings;
use File::Copy;
use File::Find::Rule;
use File::Spec;
use Readonly;

Readonly my $SOURCE_ROOT    => '/mess/they/left';
Readonly my $DEST_DIRECTORY => '/where/i/want/all/this';

my @lname_list = qw<mcloughlin farr chope kelette-bowman blackburn>;
my $lname_regex 
    = join( '|'
          , sort {  ( $b =~ /\P{Alpha}/ ) <=> ( $a =~ /\P{Alpha}/ )
                 || ( length $b ) <=> ( length $a ) 
                 || $a cmp $b 
                 } @lname_list 
          )
    ;
my %dest_dir_for;

sub get_dest_directory { 
    my $case = shift;
    my $dest_dir = $dest_dir_for{$case};
    return $dest_dir if $dest_dir;

    $dest_dir = $dest_dir_for{$case}
        = File::Spec->catfile( $DEST_DIRECTORY, $case )
        ;
    unless ( -e $dest_dir ) { 
        mkdir $dest_dir;
    }
    return $dest_dir;
}

foreach my $file_path ( 
    File::Find::Rule->file
        ->name( '*.txt' )->in( $SOURCE_ROOT )
) {
    my $file_name =  [ File::Spec->splitpath( $file_path ) ]->[2];
    $file_name    =~ s/[^\p{Alpha}.-]+/_/g;
    $file_name    =~ s/^_//;
    $file_name    =~ s/_[.]/./;

    my ( $case )  =  $file_name =~ m/(^|_)($lname_regex)[._]/i;

    next unless $case;
    # as we next-ed, we're dealing with only the cases we want here. 

    move( $file_path
        , File::Spec->catfile( get_dest_directory( lc $case )
                             , $file_name 
                             )
        );
} 
```

# javascript - 如何防止 HttpWatch 404ing javascript 单行注释

> ID：552513
> 
> 赞同：0
> 
> 时间：2009-02-16T07:41:01.573
> 
> 标签：javascript, httpwatch

如何防止 HttpWatch 将 javascript 单行注释解释为对缺失资源的调用，从而导致 404 错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T08:34:52.333

也许你应该问 HttpWatch 的人？这与javascript无关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T11:38:27.647

HttpWatch 不解释 javascript - 它只记录浏览器生成的 HTTP 流量。您看到的任何 404 错误都只是由 HttpWatch 报告的，而不是由它生成的。

如果您可以提供来自 HttpWatch 的 .hwl 文件或发生这种情况的公共 URL，我们将查看生成 404 的原因。

您可以通过 support@simtec.ltd.uk 直接联系我们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T09:00:39.867

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T14:20:20.963

原始发帖人可能指的是出现在 HttpWatch 日志中的无效 URL [http://:/ 。](http://:/)这是尝试在 IE 中模拟 DOMContentLoaded 事件的 javascript 库中常用技术的副作用：

[http://blog.httpwatch.com/2007/11/20/error_internet_invalid_url-httpwatch/](http://blog.httpwatch.com/2007/11/20/error_internet_invalid_url-httpwatch/)

# php - 使用php压缩大文件

> ID：552516
> 
> 赞同：5
> 
> 时间：2009-02-16T07:42:08.310
> 
> 标签：php, zip, large-files

我有一个 php 表单，其中有一堆复选框，所有这些复选框都包含指向文件的链接。一旦用户点击他们想要的复选框（文件），它就会压缩文件并强制下载。

我有一个简单的 php zip 强制下载工作，但是当其中一个文件很大或者如果有人说选择整个列表进行压缩和下载时，我的服务器就会出错。

我知道我可以增加服务器大小，但是还有其他方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T08:57:07.940

如果你真的需要它来通过 PHP，最好的办法是使用流。对于流，内存要求非常低，并且不会随着内容的大小而增长。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-05-26T08:28:52.133

该线程可能对[LAMP 有所帮助：如何为用户即时创建 .Zip 大文件，而不会出现磁盘/CPU 抖动](https://stackoverflow.com/questions/4357073/on-the-fly-zipping-streaming-of-large-files-in-php-or-otherwise)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T08:12:14.553

是您的服务器内存不足还是不允许您将最终结果发送给客户端？如果它只是内存不足，请改为在文件系统上运行压缩。您可以在 PHP 中执行系统命令

```
system("...command..."); 
```

所以你可以根据用户的选择，将选中的文件聚合到一个临时目录（使用系统调用进行文件复制），然后压缩临时目录（使用系统调用调用pkzip），然后让PHP将临时文件发送到客户端，之后您的 PHP 脚本可以将其删除。

这样，压缩不会消耗 PHP 应用程序中的内存。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T08:53:33.440

您可以在 web 服务器/php 级别打开 gzip 并跳过 PHP 脚本中的压缩。然后只需在两次调用之间输出正确的 zip 文件头即可`readfile()`。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-16T07:52:52.010

根据内容的动态程度以及您拥有的组合数量，您可以简单地为每个组合预先构建一个 zip 文件，然后将其返回给用户。不过，这可能会很快过时，因为有 5 个选项，您必须维护 32 个不同的档案。

# python - Django 模型返回 NoneType

> ID：552521
> 
> 赞同：3
> 
> 时间：2009-02-16T07:44:23.093
> 
> 标签：python, django, django-views

我有一个模型产品

它有两个字段大小和颜色等

```
colours = models.CharField(blank=True, null=True, max_length=500)
size = models.CharField(blank=True, null=True, max_length=500) 
```

在我看来我有

```
current_product = Product.objects.get(slug=title)
if len(current_product.size) != 0 :
    current_product.size = current_product.size.split(",") 
```

并得到这个错误：

“NoneType”类型的对象没有 len()

什么是 NoneType，我该如何测试它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-16T07:50:32.283

`NoneType`是`None`值的类型。您想将第二个片段更改为

```
if current_product.size: # This will evaluate as false if size is None or len(size) == 0.
  blah blah 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T07:51:15.337

NoneType 是 Python 的 NULL-Type，意思是“无”、“未定义”。它只有一个值：“无”。创建新模型对象时，其属性通常初始化为 None，您可以通过比较来检查：

```
if someobject.someattr is None:
    # Not set yet 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-14T11:05:55.280

我可以用这个错误代码示例来最好地解释 NoneType 错误：

```
def test():  
    s = list([1,'',2,3,4,'',5])  
    try:  
        s = s.remove('') # <-- THIS WRONG because it turns s in to a NoneType  
    except:  
        pass  
    print(str(s)) 
```

`s.remove()`返回什么也称为 NoneType。正确的方法

```
def test2()  
    s = list([1,'',2,3,4,'',5])  
    try:  
        s.remove('') # <-- CORRECTED  
    except:  
        pass  
    print(str(s)) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-16T07:54:08.763

我不了解 Django，但我假设您执行此操作时涉及某种 ORM：

```
current_product = Product.objects.get(slug=title) 
```

此时，您应该始终检查是否返回 None （'None' 与 Java 中的 'null' 或 Lisp 中的 'nil' 相同，只是在 Python 中'None' 是一个对象）。这通常是 ORM 将空集映射到编程语言的方式。

**编辑：** 哎呀，我只是看到`current_product.size`它`None`不是`current_product`。如前所述，我不熟悉 Django 的 ORM，但这似乎很奇怪：我希望`current_product`是`None`或`size`有一个数值。

# javascript - 从外部 js 文件加载

> ID：552524
> 
> 赞同：2
> 
> 时间：2009-02-16T07:46:54.973
> 
> 标签：javascript, onload

我正在编写一个 js 脚本，人们将通过在 HTML 正文部分的标题或末尾添加一行代码来将其添加到他们的网站中。

我的问题是如何在外部 js 文件上进行 onload。下面的代码会起作用吗？它不可能在文档加载后运行并错过 onload 事件吗？

```
function c_onload () {  alert ('onload'); }

if (window.attachEvent) {window.attachEvent('onload', c_onload);}
else if (window.addEventListener) {window.addEventListener('load', c_onload, false);}
else {document.addEventListener('load', c_onload, false);} 
```

（我不能使用 Jquery 或任何其他库）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T10:21:35.757

你的最后一个`else`子句是什么

```
else {document.addEventListener('load', c_onload, false); 
```

为了？这是相当没用的，恕我直言。

以下应该是一个跨浏览器的解决方案：它首先检查`addEventListener()`，然后`attachEvent()`回退到`onload = ...`

```
function chain(f1, f2) {
    return typeof f1 !== 'function' ? f2 : function() {
        var r1 = f1.apply(this, arguments),
            r2 = f2.apply(this, arguments);
        return typeof r1 === 'undefined' ? r2 : (r1 && r2);
    };
}

function addOnloadListener(func) {
    if(window.addEventListener) 
        window.addEventListener('load', func, false);
    else if(window.attachEvent)
        window.attachEvent('onload', func);
    else window.onload = chain(window.onload, func);
} 
```

此外，kgiannakakis 所说的

> 原因是浏览器处理 onLoad 事件的方式不同。

并非如此：所有主要浏览器都以相同的方式处理，即在加载外部资源（**包括您的外部脚本**`window.onload`）之后执行侦听器函数。问题在于- 这就是 , 和其他任何人编造出来的黑客攻击的地方。**`DOMContentLoaded``doScroll()``defer``onreadystatechange`**

 *** * *

根据您的目标受众，您可能想要删除后备代码，甚至专门使用它。我的投票赞成放弃它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T08:35:11.987

恐怕如果你不能使用 jQuery 或其他一些库，你需要重现它们的大量功能。原因是浏览器处理 onLoad 事件的方式不同。

推荐你下载jQuery的代码，看看documentready函数是怎么实现的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T08:24:33.510

[onLoad](http://www.w3schools.com/jsref/jsref_onload.asp)事件应该在加载它所附加的元素时运行。但是有些浏览器*将此误解为“加载前”或“加载期间的某个时间”，因此确保在加载所有 html 后运行某些内容的最安全选项是在 HTML 源代码的底部添加对函数的调用，如下所示：

```
 ...
        <script type="text/javascript">
            c_onload();
        </script>
    </body>
</html> 
```

（* 至少某些版本的 Safari for Windows 我确实相信有这个问题）

# sql - 我不应该在 Sql Server 中使用 NVARCHAR 有什么原因吗？

> ID：552529
> 
> 赞同：6
> 
> 时间：2009-02-16T07:50:05.543
> 
> 标签：sql, sql-server, varchar, nvarchar

我现在正在设计一个数据库方案，我认为为了安全起见，我应该将 nvarchar 用于我的文本列的数据类型（用于 unicode 支持）。虽然我不期望非英语文本，但我认为最好从一开始就支持它以防万一。

我有什么理由坚持使用普通的varchar？表现？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-16T07:54:07.733

在当今的 i18n 世界中，nvarchar 很有意义。*varchar 对于指定*为非 unicode的数据可能有意义（也许您有一些要求为 ASCII 的系统字段）。

默认情况下，我会使用 nvarchar 来表示名称、描述、地址等。

`varchar`更小，因此`varchar`over可能会节省一些 IO `nvarchar`（但请注意，代码页也成为一个更大的问题）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-16T07:59:58.670

另外，请参阅此问题：[VARCHAR 与 NVARCHAR 性能。](https://stackoverflow.com/questions/35366/varchar-vs-nvarchar-performance)

就个人而言，我说坚持使用 varchar（正如我在这个帖子中回答的那样）。有一个重要的性能开销。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T09:33:36.700

我们几乎对所有事情都使用 VARCHAR，而 NVARCHAR 只是非常非常偶尔。

产品代码不需要 NVarchar - 我们不允许在其中包含 AZ、0-9 和“_”以外的任何内容......

它是存储空间的两倍，但每个索引页（和每个数据页）只有一半的条目，一半的内存缓存被“浪费”，更多的 CPU 周期来比较数据，等等。

IME 常用的外国口音只能在 Varchar（即 LATIN-1）中找到。我们没有计划制作中文或其他替代字符集，并且当我们能够通过从第一天开始使用 NVarchar 来处理该字符集时，我们最不担心 - 从右到左或垂直对齐文本？:(

如果您允许使用 NVarchar 作为名称，您将如何从键盘输入扩展字符？如果您导入数据（因此它已经是 NVarchar），您将如何使用标准 QWERTY 键盘搜索该客户。国际化应用程序涉及很多很多，所以我的观点是“通过使用 NVarchar 来允许它”是没有意义的。

但是我又去很多地方有 NVarchar ......而且大多数列也是 50 个字符宽......他们必须知道一些我不知道的关于邮政编码的人口增长和扩张计划！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T07:52:47.877

是的，性能，尺寸。nvarchar 占用更多字节，我认为它是双倍的（如果我错了，请纠正我），这是因为 unicode 支持。因此，如果您不需要 unicode 支持，请使用常规 varchar。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-16T23:18:44.813

如前所述，权衡是面向未来与性能。以我的经验，SQL Server 在 CPU 和内存限制较低的情况下表现相当不错，但是给它一个缓慢的磁盘 I/O 并且它真的可以突突。

如果您没有双字节字符集（即汉字）的计划，请坚持使用 VARCHAR(MAX)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-22T07:44:18.560

通常来说，一般来说; 从约束最少的最昂贵的数据类型开始。将其投入生产。如果性能开始成为问题，请找出这些 nvarchar 列中实际存储的内容。里面有没有不适合 varchar 的字符？如果没有，请切换到 varchar。在你知道痛苦在哪里之前，不要尝试预先优化。我的猜测是 nvarchar/varchar 之间的选择不会在可预见的未来减慢您的应用程序的速度。在应用程序的其他部分中，性能调整将为您带来更多收益。

# localization - 浏览器语言：自动检测与用户选择？

> ID：552536
> 
> 赞同：8
> 
> 时间：2009-02-16T07:53:49.980
> 
> 标签：localization, locale, cultureinfo, web-applications, browser-detection

我正在设计一个本地化的网络应用程序。我倾向于自动检测浏览器语言设置。但我注意到一些受人尊敬的网站要求用户选择一种语言。您是否仅通过自动检测用户语言（根据实际经验）知道任何可用性问题？

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-16T08:32:02.293

*   给我一个选择
*   记住我的选择
*   默认使用自动检测
*   轻松过渡

在许多情况下，我更喜欢甚至需要“原版”而不是本地版本，糟糕的翻译或不同的内容是主要原因。

如果您注册了多个域，您可以根据以下情况进行自动检测：当 foo.com 将我重定向到 foo.de，或者以其他方式向我显示德语界面时，它会主动忽略我去 foo.com 的选择。

MSDN*确实*坚持向我展示糟糕的自动翻译，并且总是让我单击以转到可读、可理解的英语翻译（这是一个进步：当他们介绍它时，更改语言的默认选择类似于南非荷兰语）。

使转换变得容易：即，可以很容易地以不同的语言转到当前页面的对应部分。当我将“.com”更改为“.de”时，亚马逊通常会成功，但它无法引导我找到该项目的德语翻译。这并不总是可行的，因为这需要每个本地视图具有相同的结构和 1:1 的页面映射。但通常，您必须根据项目的其他约束来权衡上述要求。

[编辑] MSDN 现在变得更好了 :)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-16T08:20:35.470

如果翻译不可用，我建议自动检测语言并以这种语言或默认语言（可能是英语）显示网站。此外，在您的页面顶部或底部向用户展示选择的语言。语言名称应以目标语言书写。

**不要那样**做：英语、德语、意大利语。

**但是：**英语、德语、意大利语。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T08:10:05.043

显然存在可用性问题，您可能会检测到用户不理解的语言。你打算怎么做检测？不要以为每个人都将浏览器设置为正确的语言。IP 地址也是用户语言的一个非常糟糕的指标。

实际例子：YouTube 试图说服我一个星期左右使用日文版，虽然我看不懂日文。不是很有帮助。当我只想阅读英文文档时，Microsoft 还决定为我提供文档的自动翻译版本。

所以不要试图告诉你的用户他们应该喜欢哪种语言，让他们自己决定。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-16T08:17:25.837

我真的很讨厌不可配置的自动检测，因为很多应用程序的翻译并不完美。我宁愿阅读完美的英语而不是糟糕的俄语。例如，有些术语翻译得不合理，试图翻译所有内容，使本地化版本隐约可笑。

此外，一些应用程序无法足够快地翻译新功能，从而导致混合语言。

所以我总是喜欢有一个选择，并选择应用程序作者的本地版本——最好的语言（除非它是我不知道的语言）。

更新：超出荒谬的一种情况是 DB2（或其客户端工具，不确定），它迫使我安装俄罗斯版本，但此版本中的所有错误都显示为“????????? ?? ??? ??”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-16T08:02:06.653

是的：在工作中，我们部署了使用“英语”语言的 Windows XP（因为我们有全球站点，并且只有一种 Windows 可以部署，在语言方面只有一种设置）。

然而，所有应用程序都必须以法语运行。单独的自动检测功能不足以正确显示标签。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-16T08:04:06.197

我同意自动检测是不够的。

没有多少用户知道选择语言的设置。因此，这些设置通常是默认设置，因此不正确（对于非英语用户）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-16T08:04:07.943

有时，当您试图通过电话向用户描述某事并且您位于不同的位置时，当您同时查看相同的 URL 但看到不同的结果时会非常烦人。您甚至可以在 URL 中包含类似于 wikipedia 的语言（例如 en.wikipedia.org）。

有时，由于计算机上的语言设置，用户会在朋友的计算机上尝试访问网站，但不会以他们的首选语言看到它。

我认为最好的解决方案是允许用户覆盖设置，但默认为自动检测语言。

# php - 为什么有些程序只用 C++ windows 编写，而有些则不是？

> ID：552540
> 
> 赞同：1
> 
> 时间：2009-02-16T07:55:55.810
> 
> 标签：php, c++, cross-platform

这是我一直想知道的事情。

以 Notepad++ 为例。Wikipedia 告诉我它是用 C++ 编写的，并且仅适用于 Windows。

现在以 PHP 为例。Wikipedia 告诉我这也是用 C++ 编写的，但也可以在其他操作系统上运行。

但是我看到更多的语言，然后只是用于 PHP 的 C++ ......这是怎么做到的？他们是否在 C++ 中编写了一些新代码，看看它是否有效，然后弄清楚如何在 Perl 中执行它，或者会发生什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-16T08:03:46.713

这取决于您是否使用平台特定的库。Notepad++ 是一个桌面应用程序，它需要一个 GUI 工具包。尽管有 Qt 和 wxWidgets 等跨平台 C++ 库，但 Notepad++ 可能使用的是 Microsoft 的特定技术。因此它不能移植到其他平台。

另一方面，PHP 是一种 WEB 脚本技术，因此不需要 GUI 库。此外，与 Notepad++ 相比，在许多平台上运行 PHP 的兴趣要大得多。这是开发人员使 C++ 代码跨平台的动力。

避免使用特定于平台的库并不是 C++ 跨平台应用程序唯一需要的东西。这通常意味着针对最小公分母进行编码，并为每个支持的平台保留不同的代码分支。尽管 C++ 是一种跨平台语言，但每个系统都有其自身的复杂性。事实上，如果要使用不同的编译器，同一平台上的代码也可能不同。尝试下载开源应用程序的 C++ 源代码，例如 PHP。您会注意到所有平台的大部分代码都是相同的，但也会有不同的位。有时使用预处理器指令，在其他地方涉及完全不同的源文件。

因此，创建一个真正的跨平台 C++ 应用程序是一项艰巨的工作，而且通常是在有强烈的动机和很多人参与的情况下创建的。像 Notepad++ 这样的单人应用程序真的不能跨平台。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-16T08:03:03.283

通常在单一平台上运行的程序会利用操作系统的一些功能（例如处理窗口、按钮、服务的系统调用）。显然代码是严格依赖于系统的，不能在其他环境中工作。对于跨平台软件，您可以遵循几种方法，其中一些是：

*   您独立于操作系统和您脚下的东西进行编程（因此您不使用操作系统设施、框架等）。
*   您使用以这种方式编程的库和工具进行编程，因此可以在多个操作系统下工作（例如，您使用跨平台的 Qt 或 wxWindows 来管理窗口和界面）。
*   您构建了多个版本的代码，以处理它将运行的各种架构的特殊性。通过这种方式，您可能会获得更高的性能和“更好”的软件，因为代码针对其自身的架构进行了优化，但可能非常难以维护。

我认为大多数语言都以第一种方式工作，但有时它们可​​以使用操作系统调用来获得一些性能（在这种情况下，您将拥有例如用于 Windows 的 PHP，用于 MacOS 的 PHP，......）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-16T08:09:22.470

与 Java 和 C# 等一些现代语言不同，C++ 语言仅提供基本功能。它没有处理用户界面、线程、网络交互、密码学甚至读取 XML 的标准方法。相反，对这种功能的支持由操作系统决定。Windows 提供了一个广泛的 API 集，称为 Win32，为 Windows 编写的应用程序可以利用它。在 Linux 和其他操作系统之上也有类似的 API。每当作者利用特定操作系统的库时，他们都会这样做，以使他们的程序无法在其他操作系统上运行。

通过抽象出与操作系统交互的项目，可以编写一个跨操作系统工作的 C++ 程序，但这并不简单，而且不经常这样做。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T08:00:55.330

C++ 是一种天生的跨平台语言；只是有许多用 C++ 编写的库使用特定于特定平台的功能，因此这些程序仅限于该平台。避免那些特定于平台的特性，你就拥有了一个可以在大多数平台上编译而没有太多麻烦的 C++ 程序。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-16T08:40:06.127

Notepad++ 只是 Windows，因为 Notepad++ 是 Windows Notepad 的替代品，Windows Notepad 是出了名的糟糕。在任何自尊的操作系统上，没有人会使用名称中带有“记事本”的编辑器；>。

Notepad++ 的核心是[Scintilla 文本编辑器组件](http://www.scintilla.org/)，它是跨平台的（Linux、OS X 和 Windows），用于跨平台和特定平台的[应用程序](http://www.scintilla.org/ScintillaRelated.html)。核心视图逻辑是共享的，与用于与窗口系统和图形上下文接口的抽象类。应用程序采用跨平台组件并将其绑定到操作系统特定的窗口和图形上下文。我在 Linux 和 Windows 上最喜欢的编辑器是[SciTE](http://www.scintilla.org/SciTE.html)，它是一个非常快速的轻量级包装器，带有 Lua 脚本；还有[Komodo](http://www.activestate.com/komodo_edit/)将 Scintilla 编辑器组件包装在[Mozilla XUL](https://developer.mozilla.org/en/XUL)容器中 - 另一个跨平台 C++ 堆栈。

使应用程序跨平台是有一定成本的；只有在这些平台上有潜在用户时，才值得投资。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-16T10:33:58.987

> 现在以 PHP 为例。Wikipedia 告诉我这也是用 C++ 编写的，但也可以在其他操作系统上运行。

PHP 是用 C 编写的，只是为了使其在更多平台上可用。甚至有规则只做 C 风格的注释，而不是 C++ //。

请参阅[PHP 编码标准](http://cvs.php.net/viewvc.cgi/php-src/CODING_STANDARDS)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-16T10:56:39.747

除了特定于平台的库和 API 之外，C 和 C++ 也不是真正的跨平台语言（这是有充分理由的）。他们故意留下许多未指定的细节，例如类型长度、字节顺序、结构中的变量对齐以及新分配的内存是否已初始化。

这允许您编写与您的 CPU 一样快的（特定于平台的）代码，但这也意味着如果您希望您的代码具有可移植性，则需要一些额外的工作和测试——许多人针对 Windows /x86 平台可能会跳过。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-16T16:04:35.370

其他人评论了 GUI 和仅存在于主要平台子集上的其他库的使用。

另一个因素是开发商。许多开发人员（或软件公司）只有专业知识、访问权限、客户需求或需要使用单个平台，因此他们不会花费额外的精力来使他们的软件跨平台。例如，如果一家公司在每个人的办公桌上都有一台 Windows PC 和开发人员工具，内部没有 Linux 或 Mac 机器可供开发或测试，也没有其他平台专家的开发人员，也没有需要不同平台的大客户，他们很难证明不只是继续使用仅限 Windows 的软件包。如果他们后来改变主意，当他们拥有专业知识、设备或额外要求时，他们可能会发现修复一个已被允许变得非常依赖平台的大型代码库为时已晚。

平台独立性需要真正的努力，每一步。如果你从第一天开始就有计划，使用跨平台库（如 Qt、boost、OpenGL 等，小心避免 MFC、DirectX 等），并定期在所有平台上构建和测试，可能只有 10 个-20% 更多的努力来制作一个好的跨平台应用程序。但是，如果您从一个已经开发了很长时间的单平台应用程序开始，使其跨平台可以像从头开始编写一样花费大量的精力，而且如果新平台具有相对的您所在行业的市场份额很小，或者如果您的开发人员讨厌从事此工作。

# jakarta-ee - 关于类别识别

> ID：552545
> 
> 赞同：0
> 
> 时间：2009-02-16T07:58:20.860
> 
> 标签：jakarta-ee

我想获取所有对象的列表（用户定义的类和在我的程序中使用的预定义类。谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T08:43:20.207

如果您指定`-verbose:class`，则有关加载的每个类的信息将写入标准输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T08:57:56.160

分析或使用`verbose`标志是个好主意。但是，如果您需要以编程方式获得这些结果，您将需要一种不同的方法。

*在我*看来，唯一的方法是编写你自己的类加载器——简单地继承基本的类加载器——并扩展它，以便它将所有加载的类保存在一个列表或其他内容中。

请注意，这确实会影响性能，并确保您仔细检查是否真的需要它。

如果不是以编程方式，只需使用提到的其他方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T08:04:47.897

实现这一点的最佳方法是通过分析器运行您的应用程序。不幸的是，我不是 Java 世界的永久居民（甚至不是访客 :-)），所以我无法向您推荐最好的工具。但是，在您最喜欢的搜索引擎上快速搜索“java profiler”会产生一个[列出大量开源分析器](http://java-source.net/open-source/profilers)的页面。

希望有帮助。

# cocoa - 如何在显示 swf 文件的 webview 中显示另一个 swf 文件？

> ID：552554
> 
> 赞同：0
> 
> 时间：2009-02-16T08:01:17.857
> 
> 标签：cocoa

我想在显示 swf 文件的 webview 中显示另一个 swf 文件，并且我可以获得显示 swf 文件的路径，但是当我将另一个 swf 文件拖放到显示 swf 文件的 webview 时，swf 文件不能打开了，为什么？还有一些我忘记的 webview 委托方法？有人可以告诉我吗？谢谢！

我遵循了这个示例代码：/Developer/Examples/Webket/MiniBrowser

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T05:07:21.083

您需要继承 WebView，并为该视图实现拖动目标方法。

# iphone - 永久忽略警告

> ID：552555
> 
> 赞同：5
> 
> 时间：2009-02-16T08:01:31.337
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch, xcode

我有一个编译时带有一些警告的项目。这是一个 iPhone 项目，在 NSDate 上使用了一些方法，这些方法看似不是 iPhone SDK 的标头，但仍然可以完美地工作。当我调用这些方法时，我会收到如下警告：

[NSDate 警告 http://beautifulpixel.com/assets/NSDate_Warnings-20090215-235727.png](http://beautifulpixel.com/assets/NSDate_Warnings-20090215-235727.png)

那么我如何永久地使警告静音，以便告诉 XCode “没关系，真的。”

或者我该如何纠正警告？这段代码在设备上运行良好，Apple 已经批准了使用这些相同方法的应用程序，所以我肯定可以让 XCode 了解这些方法确实存在。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-16T10:32:35.903

我强烈建议您不要使用这些方法。仅仅因为它们是在 Mac OS X 的 Foundation 框架中声明的，并不能阻止它们成为 iPhone 上的私有 API。Apple 完全有权从商店中停止您的应用程序。同样，没有什么可以阻止 Apple 为 iPhone OS 2.2.2 或更高版本稍微整理 Foundation 并删除这两种方法，从而破坏您的应用程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-16T08:16:12.347

您可以在 .m 文件的早期编写一个简短的接口扩展名来抑制这些警告

例子：

```
@interface NSDate (SuppressSomWarnings)
- (void)dateWithNaturalLanguageString:(NSString*)_str;
@end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T08:22:52.640

很奇怪，当我键入相同的两行时，我没有收到任何警告......您是否将标题和框架正确导入到您的项目中？

我看到它们是在 Foundation.framework 中的 NSCalendateDate.h 中定义的。

如果做不到这一点，您可以尝试将接口定义直接包含到您的代码中，例如，在您的 .m 文件的顶部，以查看是否可以消除警告。（请参阅我写这篇文章时出现的 epatel 的回答！）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T08:35:15.403

您是否配置了正确的 SDK？您可能喜欢最新版本，但使用旧的头文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-16T17:48:10.083

您的代码可能在模拟器中运行，但它在手机上运行吗？

该模拟器使用 OS X Foundation 框架，它是 iPhone 上可用的超集。

# c# - 'if' 没有 'else' C#

> ID：552571
> 
> 赞同：0
> 
> 时间：2009-02-16T08:12:06.130
> 
> 标签：c#

我正在使用 C# 1.1 进行编码。

我想要一种方法来找出所有没有“else”子句的“If”子句。有什么简单的方法吗？

我问这个问题是因为我从我的客户那里得到了一个项目源文件，其中有许多没有 ELSE 子句的 IF 子句。这导致了很多错误。所以，我想扫描我的源文件，看看是否有没有 ELSE 子句的 IF 子句。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T08:19:41.167

如果没有漂亮的工具可用：

1.  如果在所有文件中搜索单个单词。获取带有文件名和行号的文件。
2.  在所有文件中搜索单个单词 else。获取带有文件名和行号的文件。
3.  在第一个文件中，每行添加“if”，在第二个文件中添加“else”
4.  合并文件
5.  对文件名、行号、（if/else）进行排序
6.  删除所有 if 后跟 else。

你现在有一个几乎所有没有 else 的 if 的列表。

这种方法会产生一些误报，因为它没有考虑注释代码。但如果没有可用的工具，这是一个公平的选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T08:24:19.643

没有简单的方法。

**使用ctrl+shift+F**在项目范围内搜索**if**语句。然后快速双击结果。

 **或者也许你可以使用**查找选项/使用/正则表达式**，但我认为这不是一个好的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T08:37:47.690

我认为您可能需要使用堆栈，因为 if 可能在另一个 if 中。每次找到 if 时，将其压入堆栈。现在寻找短语的结尾。这意味着要么 ; 或匹配的花括号。之后，检查其他。弹出堆栈。

# sql - 为职位列表网站设计数据库模式？

> ID：552576
> 
> 赞同：2
> 
> 时间：2009-02-16T08:14:40.727
> 
> 标签：sql, sql-server

对于一个学校项目，我正在用 ASP.NET MVC 制作一个简单的职位列表网站（我们必须选择框架）。

我已经考虑了一段时间，这是我的初始架构：

> **JobPostings**
> +---JobPostingID
> +---UserID
> +---Company
> +---JobTitle
> +---JobTypeID
> +---JobLocationID
> +---Description
> +---HowToApply
> + ---CompanyURL +
> ---徽标网址
> 
> **JobLocations**
> +---JobLocationID
> +---City
> +---State
> +---Zip
> 
> **JobTypes**
> +---JobTypeID
> +---JobTypeName

*注意：用户 ID 将链接到由 MembershipProvider 生成的成员表。*

现在，我对关系数据库和 SQL*非常*陌生，所以对我轻描淡写。

取名呢？它应该只是 JobPostings 表下的“Description”，还是应该是“JobDescription”（与该主表中的其他列相同）。它应该是“JobPostingID”还是只是“ID”？

一般提示也值得赞赏。

编辑：我们的项目的 JobTypes 是固定的，将有 15 个工作类别。我把它做成了一个社区维基来鼓励人们发帖。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T08:22:26.107

一些想法：

*   除非您事先知道工作类型的列表是有限的，否则不要将其拆分为单独的表格；
*   只需使用“ID”作为每个表的主键（我们已经知道它是 JobLocationID，因为它在 JobLocations 表中......）；
*   我会从 JobPostings 的字段中删除“工作”前缀，因为它有点多余。

您可以包含大量特定于域的信息，例如工资范围和申请人详细信息，但我不知道您应该在这方面走多远。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T08:59:38.560

对我来说看起来不错，我建议还将 Created、LastModified 和 Deleted 列添加到用户可更新的表中，以便将来进行校对。

确保您在架构中也明确定义了主键和外键。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T19:27:56.350

[作业模式 http://gfilter.net/junk/JobSchema.png](http://gfilter.net/junk/JobSchema.png)

我将公司从职位发布中拆分出来，因为这样可以更轻松地维护公司。

我还添加了一个 XREF 表，可以存储公司和位置之间的关系。您可以为每个公司办公室设置一行，并有一种非常简单的方法来查找“该公司的替代工作地点”。

这应该是一个有趣的项目......祝你好运。

编辑：我会添加 Created 和 LastModifiedBy（指的是 UserID）。这些是一般家政服务的好柱子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T16:03:41.677

> 取名呢？它应该只是 JobPostings 表下的“描述”，还是应该是 JobDescription（与该主表中的其他列相同）。它应该是“JobPostingID”还是只是“ID”？

就个人而言，我按照您的建议指定带有前缀的通用字段，如“ID”和“描述”。当您稍后编写查询时，它避免了对 id/description 适用于什么的混淆（并为您节省了别名的麻烦）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-16T19:18:11.100

我建议将要存储在 JobLocations 中的数据折叠回主表中。可以有一个州表和一个国家表，但我怀疑你是否想要一个包含每个城市/州/国家对的表，你真的没有从中获得任何好处。如果有人进入并编辑他们的位置会发生什么？您必须检查以确保没有其他工作列表指向该位置并对其进行编辑，否则创建一个新位置并指向该位置。

我通常的模式是地址和城市作为带有记录的文本和状态表的 FK。

# c# - 如何从 TabControl 隐藏 TabPage

> ID：552579
> 
> 赞同：165
> 
> 时间：2009-02-16T08:15:36.310
> 
> 标签：c#, winforms, tabcontrol, tabpage

如何在 WinForms 2.0 中从 TabControl 中隐藏 TabPage？

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2009-02-16T08:20:23.660

不，这不存在。您必须删除选项卡并在需要时重新添加它。或使用不同的（第 3 方）选项卡控件。

* * *

## 回答 #2

> 赞同：111
> 
> 时间：2011-12-22T10:58:58.863

隐藏标签页的代码片段

```
private void HideTab1_Click(object sender, EventArgs e)
{
    tabControl1.TabPages.Remove(tabPage1);
} 
```

显示标签页的代码片段

```
private void ShowTab1_Click(object sender, EventArgs e)
{
    tabControl1.TabPages.Add(tabPage1);
} 
```

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2015-02-13T04:30:53.433

我意识到这个问题很旧，接受的答案很旧，但是......

至少在 .NET 4.0 ...

要隐藏选项卡：

```
tabControl.TabPages.Remove(tabPage); 
```

把它放回去：

```
tabControl.TabPages.Insert(index, tabPage); 
```

`TabPages`效果比这个好得多`Controls`。

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2009-02-16T08:20:56.437

Tabpages 上没有实现 Visiblity 属性，也没有 Insert 方法。

您需要手动插入和删除标签页。

这是相同的解决方法。

[http://www.dotnetspider.com/resources/18344-Hiding-Showing-Tabpages-Tabcontrol.aspx](http://www.dotnetspider.com/resources/18344-Hiding-Showing-Tabpages-Tabcontrol.aspx)

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2012-09-22T13:06:19.957

## 变体 1

为了避免视觉klikering，您可能需要使用：

```
bindingSource.RaiseListChangeEvent = false 
```

或者

```
myTabControl.RaiseSelectedIndexChanged = false 
```

删除标签页：

```
myTabControl.Remove(myTabPage); 
```

添加标签页：

```
myTabControl.Add(myTabPage); 
```

在特定位置插入标签页：

```
myTabControl.Insert(2, myTabPage); 
```

不要忘记撤消更改：

```
bindingSource.RaiseListChangeEvent = true; 
```

或者

```
myTabControl.RaiseSelectedIndexChanged = true; 
```

## 变体 2

```
myTabPage.parent = null;
myTabPage.parent = myTabControl; 
```

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2014-08-07T21:04:11.007

到目前为止提供的解决方案太复杂了。阅读最简单的解决方案：http: [//www.codeproject.com/Questions/614157/How-to-Hide-TabControl-Headers](http://www.codeproject.com/Questions/614157/How-to-Hide-TabControl-Headers)

您可以使用此方法使它们在运行时不可见：

```
private void HideAllTabsOnTabControl(TabControl theTabControl)
{
  theTabControl.Appearance = TabAppearance.FlatButtons;
  theTabControl.ItemSize = new Size(0, 1);
  theTabControl.SizeMode = TabSizeMode.Fixed;
} 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2014-12-03T19:53:49.807

我将@Jack Griffin 的答案和@amazedsaint 的答案（[分别是dotnetspider 代码片段](http://www.dotnetspider.com/resources/18344-Hiding-Showing-Tabpages-Tabcontrol.aspx)）组合成一个**TabControlHelper**。

**TabControlHelper**允许您：

*   显示/隐藏所有标签页
*   显示/隐藏单个标签页
*   保留标签页的原始位置
*   交换标签页

* * *

```
public class TabControlHelper
{
    private TabControl _tabControl;
    private List<KeyValuePair<TabPage, int>> _pagesIndexed;
    public TabControlHelper(TabControl tabControl)
    {
        _tabControl = tabControl;
        _pagesIndexed = new List<KeyValuePair<TabPage, int>>();

        for (int i = 0; i < tabControl.TabPages.Count; i++)
        {
            _pagesIndexed.Add(new KeyValuePair<TabPage, int> (tabControl.TabPages[i], i ));
        }
    }

    public void HideAllPages()
    {
        for (int i = 0; i < _pagesIndexed.Count; i++)
        {
            _tabControl.TabPages.Remove(_pagesIndexed[i].Key);
        }
    }

    public void ShowAllPages()
    {
        for (int i = 0; i < _pagesIndexed.Count; i++)
        {
            _tabControl.TabPages.Add(_pagesIndexed[i].Key);
        }
    }

    public void HidePage(TabPage tabpage)
    {
        if (!_tabControl.TabPages.Contains(tabpage)) return;
        _tabControl.TabPages.Remove(tabpage);
    }

    public void ShowPage(TabPage tabpage)
    {
        if (_tabControl.TabPages.Contains(tabpage)) return;
        InsertTabPage(GetTabPage(tabpage).Key, GetTabPage(tabpage).Value);
    }

    private void InsertTabPage(TabPage tabpage, int index)
    {
        if (index < 0 || index > _tabControl.TabCount)
            throw new ArgumentException("Index out of Range.");
        _tabControl.TabPages.Add(tabpage);
        if (index < _tabControl.TabCount - 1)
            do
            {
                SwapTabPages(tabpage, (_tabControl.TabPages[_tabControl.TabPages.IndexOf(tabpage) - 1]));
            }
            while (_tabControl.TabPages.IndexOf(tabpage) != index);
        _tabControl.SelectedTab = tabpage;
    }

    private void SwapTabPages(TabPage tabpage1, TabPage tabpage2)
    {
        if (_tabControl.TabPages.Contains(tabpage1) == false || _tabControl.TabPages.Contains(tabpage2) == false)
            throw new ArgumentException("TabPages must be in the TabControls TabPageCollection.");

        int Index1 = _tabControl.TabPages.IndexOf(tabpage1);
        int Index2 = _tabControl.TabPages.IndexOf(tabpage2);
        _tabControl.TabPages[Index1] = tabpage2;
        _tabControl.TabPages[Index2] = tabpage1;
    }

    private KeyValuePair<TabPage, int> GetTabPage(TabPage tabpage)
    {
        return _pagesIndexed.Where(p => p.Key == tabpage).First();
    }
} 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2015-09-04T05:42:39.970

```
private System.Windows.Forms.TabControl _tabControl;
private System.Windows.Forms.TabPage _tabPage1;
private System.Windows.Forms.TabPage _tabPage2;

...
// Initialise the controls
...

// "hides" tab page 2
_tabControl.TabPages.Remove(_tabPage2);

// "shows" tab page 2
// if the tab control does not contain tabpage2
if (! _tabControl.TabPages.Contains(_tabPage2))
{
    _tabControl.TabPages.Add(_tabPage2);
} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2014-01-20T08:12:55.910

创建一个新的空类并在其中过去：

```
using System.Windows.Forms;

namespace ExtensionMethods
{
    public static class TabPageExtensions
    {

        public static bool IsVisible(this TabPage tabPage)
        {
            if (tabPage.Parent == null)
                return false;
            else if (tabPage.Parent.Contains(tabPage))
                return true;
            else
                return false;
        }

        public static void HidePage(this TabPage tabPage)
        {
            TabControl parent = (TabControl)tabPage.Parent;
            parent.TabPages.Remove(tabPage);
        }

        public static void ShowPageInTabControl(this TabPage tabPage,TabControl parent)
        {
            parent.TabPages.Add(tabPage);
        }
    }
} 
```

2- 在表单代码中添加对 ExtensionMethods 命名空间的引用：

```
using ExtensionMethods; 
```

3- 现在您可以使用`yourTabPage.IsVisible();`它来检查它的可见性、`yourTabPage.HidePage();`隐藏它和`yourTabPage.ShowPageInTabControl(parentTabControl);`显示它。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2013-01-16T16:49:56.560

您可以将标签页的父级设置为 null 以进行隐藏并显示仅将标签页父级设置为 tabcontrol

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-11-14T04:41:33.547

```
 public static Action<Func<TabPage, bool>> GetTabHider(this TabControl container) {
        if (container == null) throw new ArgumentNullException("container");

        var orderedCache = new List<TabPage>();
        var orderedEnumerator = container.TabPages.GetEnumerator();
        while (orderedEnumerator.MoveNext()) {
            var current = orderedEnumerator.Current as TabPage;
            if (current != null) {
                orderedCache.Add(current);
            }
        }

        return (Func<TabPage, bool> where) => {
            if (where == null) throw new ArgumentNullException("where");

            container.TabPages.Clear();
            foreach (TabPage page in orderedCache) {
                if (where(page)) {
                    container.TabPages.Add(page);
                }
            }
        };
    } 
```

像这样使用它：

```
 var hider = this.TabContainer1.GetTabHider();
    hider((tab) => tab.Text != "tabPage1");
    hider((tab) => tab.Text != "tabpage2"); 
```

选项卡的原始顺序保存在一个完全隐藏在匿名函数中的列表中。保留对函数实例的引用，并保留原始的 Tab 键顺序。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-01-10T20:04:39.977

微软+1 :-)。
我设法做到了这一点：（
假设您有一个`Next`显示下一个 TabPage 的按钮 -`tabSteps`是 Tab 控件的名称）
在启动时，将所有标签页保存在适当的列表中。
当用户按下`Next`按钮时，删除选项卡控件中的所有 TabPages，然后使用适当的索引添加：

```
int step = -1;
List<TabPage> savedTabPages;

private void FMain_Load(object sender, EventArgs e) {
    // save all tabpages in the list
    savedTabPages = new List<TabPage>();
    foreach (TabPage tp in tabSteps.TabPages) {
        savedTabPages.Add(tp);
    }
    SelectNextStep();
}

private void SelectNextStep() {
    step++;
    // remove all tabs
    for (int i = tabSteps.TabPages.Count - 1; i >= 0 ; i--) {
            tabSteps.TabPages.Remove(tabSteps.TabPages[i]);
    }

    // add required tab
    tabSteps.TabPages.Add(savedTabPages[step]);
}

private void btnNext_Click(object sender, EventArgs e) {
    SelectNextStep();
} 
```

*更新*

```
public class TabControlHelper {
    private TabControl tc;
    private List<TabPage> pages;
    public TabControlHelper(TabControl tabControl) {
        tc = tabControl;
        pages = new List<TabPage>();
        foreach (TabPage p in tc.TabPages) {
            pages.Add(p);
        }
    }

    public void HideAllPages() {
        foreach(TabPage p in pages) {
            tc.TabPages.Remove(p);
        }
    }

    public void ShowAllPages() {
        foreach (TabPage p in pages) {
            tc.TabPages.Add(p);
        }
    }

    public void HidePage(TabPage tp) {
        tc.TabPages.Remove(tp);
    }        

    public void ShowPage(TabPage tp) {
        tc.TabPages.Add(tp);
    }
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-03-01T13:32:29.020

好吧，如果您不想弄乱现有代码而只想隐藏选项卡，则可以修改编译器生成的代码以注释将选项卡添加到选项卡控件的行。

例如：以下行将名为“readformatcardpage”的选项卡添加到名为“tabcontrol”的 Tabcontrol

this.tabcontrol.Controls.Add(this.readformatcardpage);

以下将阻止将选项卡添加到选项卡控件

//this.tabcontrol.Controls.Add(this.readformatcardpage);

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-01-14T19:04:01.440

```
TabPage pageListe, pageDetay;
bool isDetay = false;

private void btnListeDetay_Click(object sender, EventArgs e)
{
    if (isDetay)
    {
        isDetay = false;
        tc.TabPages.Remove(tpKayit);
        tc.TabPages.Insert(0,pageListe);
    }
    else
    {
        tc.TabPages.Remove(tpListe);
        tc.TabPages.Insert(0,pageDetay);
        isDetay = true;
    }
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-11-06T12:34:08.320

作为一种廉价的解决方法，我使用了一个标签来掩盖我想隐藏的标签。

然后我们可以使用标签的可见属性作为替代。如果有人确实走这条路，请不要忘记处理键盘敲击或可见性事件。您不希望左右光标键暴露您要隐藏的选项卡。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-03-08T18:37:07.690

不确定“Winforms 2.0”，但这是经过尝试和证明的：

[http://www.mostthingsweb.com/2011/01/hiding-tab-headers-on-a-tabcontrol-in-c/](http://www.mostthingsweb.com/2011/01/hiding-tab-headers-on-a-tabcontrol-in-c/)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-05-14T18:23:32.547

在 WPF 中，这很容易：

假设您已经给 TabItem 一个名称，例如，

```
<TabItem Header="Admin" Name="adminTab" Visibility="Hidden">
<!-- tab content -->
</TabItem> 
```

您可以在表单后面的代码中包含以下内容：

```
 if (user.AccessLevel == AccessLevelEnum.Admin)
 {
     adminTab.Visibility = System.Windows.Visibility.Visible;
 } 
```

应该注意的是，已经创建了一个`User`名为的对象，它的属性设置为用户定义的枚举值之一……无论如何；这只是我决定是否显示选项卡的条件。`user``AccessLevel``AccessLevelEnum`

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2013-11-07T01:10:05.677

我也有这个问题。tabPage.Visible 没有如前所述实现，这是一个很大的帮助（+1）。我发现您可以覆盖控件，这将起作用。有点 necroposting，但我想在这里为其他人发布我的解决方案......

```
 [System.ComponentModel.DesignerCategory("Code")]
public class MyTabPage : TabPage
{
    private TabControl _parent;
    private bool _isVisible;
    private int _index;
    public new bool Visible
    {
        get { return _isVisible; }
        set
        {
            if (_parent == null) _parent = this.Parent as TabControl;
            if (_parent == null) return;

            if (_index < 0) _index = _parent.TabPages.IndexOf(this);
            if (value && !_parent.TabPages.Contains(this))
            {
                if (_index > 0) _parent.TabPages.Insert(_index, this);
                else _parent.TabPages.Add(this);
            }
            else if (!value && _parent.TabPages.Contains(this)) _parent.TabPages.Remove(this);

            _isVisible = value;
            base.Visible = value;
        }
    }

    protected override void InitLayout()
    {
        base.InitLayout();
        _parent = Parent as TabControl;
    }
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2014-04-02T14:14:01.117

我使用了相同的方法，但问题是当标签页从标签页控件 TabPages 列表中删除时，它也会从标签页控件列表中删除。并且在处理表单时不处理它。

所以如果你有很多这样的“隐藏”标签页，你会[得到 windows 处理配额超出错误](http://social.msdn.microsoft.com/Forums/en-US/87b80c7c-d931-41cc-ad3f-967135b1e290/loading-of-the-imagelist-throws-exception?forum=winforms) ，只有重新启动应用程序才能修复它。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2014-09-01T06:06:19.633

如果你在谈论 AjaxTabControlExtender 然后设置每个选项卡的 TabIndex 并根据需要设置 Visible 属性 True/False。

myTab.Tabs[1].Visible=true/false;

* * *

## 回答 #21

> 赞同：-2
> 
> 时间：2013-02-25T08:55:40.240

```
// inVisible
TabPage page2 = tabControl1.TabPages[0];
page2.Visible= false; 
```

```
//Visible 
page2.Visible= true; 
```

```
// disable
TabPage page2 = tabControl1.TabPages[0];
page2.Enabled = false; 
```

```
// enable
page2.Enabled = true; 
```

```
//Hide
tabCtrlTagInfo.TabPages(0).Hide()
tabCtrlTagInfo.TabPages(0).Show() 
```

复制粘贴试试看，上面的代码已经在vs2010中测试过了，可以的。

* * *

## 回答 #22

> 赞同：-2
> 
> 时间：2015-05-13T12:31:46.573

隐藏 TabPage 并删除标题：

```
this.tabPage1.Hide();
this.tabPage3.Hide();
this.tabPage5.Hide();
tabControl1.TabPages.Remove(tabPage1);
tabControl1.TabPages.Remove(tabPage3);
tabControl1.TabPages.Remove(tabPage5); 
```

显示 TabPage 并显示标题：

```
tabControl1.TabPages.Insert(0,tabPage1);
tabControl1.TabPages.Insert(2, tabPage3);
tabControl1.TabPages.Insert(4, tabPage5);
this.tabPage1.Show();
this.tabPage3.Show();
this.tabPage5.Show();
tabControl1.SelectedTab = tabPage1; 
```

# windows - 通过 Windows 套接字发送大于 1 MB 的大数据，即使用发送函数

> ID：552612
> 
> 赞同：4
> 
> 时间：2009-02-16T08:29:47.460
> 
> 标签：windows, sockets

我希望通过 Windows 套接字发送 API 发送大于 1 MB 的大消息。有没有一种有效的方法可以做到这一点，我不想循环然后分块发送数据。我在某处读到您可以增加套接字缓冲区的大小，这可能会有所帮助。任何人都可以详细说明这一点。任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T09:15:29.380

您应该并且实际上必须循环以分块发送数据。

如 Beej 的网络指南中所述：

> “send() 返回实际发送的字节数——这可能小于你告诉它发送的字节数！看，有时你告诉它发送一整块数据，它就是无法处理它。它'我会尽可能多地发送数据，并相信您稍后会发送其余的数据。”

这意味着即使您将数据包大小设置为 1MB，send() 函数也可能不会发送所有数据，并且您被迫循环，直到您调用 send() 发送的总字节数总和您正在尝试发送。事实上，数据包的大小越大，send() 就越有可能不会全部发送出去。

除此之外，您不想发送 1MB 数据包，因为如果它们丢失，您将不得不重新传输整个 1MB 数据包，而如果您丢失了 1K 数据包，重新传输它没什么大不了的。

总之，你必须循环你的 send() 调用，而接收者甚至也必须循环他们的 recv() 调用。您可能需要在每个数据包前面添加一个小标头，以告知接收器正在发送多少字节，以便接收器可以循环适当的次数。

我建议您查看 Beej 的网络指南，了解有关 send() 和 recv() 以及如何处理此问题的更多详细信息。可在[http://beej.us/guide/bgnet/output/print/bgnet_USLetter.pdf找到](http://beej.us/guide/bgnet/output/print/bgnet_USLetter.pdf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T08:35:35.730

为什么不想分块发送呢？

这是 99% 的情况下的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T08:54:11.833

是什么让您认为分块发送效率低下？无论如何，操作系统可能会分块大的“发送”调用，并可能合并小的调用。

同样，在接收端，客户端无论如何都应该循环，因为不能保证一次性获取所有数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T08:39:26.923

无论如何，Windows 套接字子系统都没有义务发送您提供的整个缓冲区。您不能强制它，因为某些网络级协议对数据包大小有上限。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T13:20:35.233

实际上，您实际上可以分配一个大缓冲区并使用 Winsock 在一次调用中发送。如果您没有弄乱套接字缓冲区的大小，则通常会将缓冲区复制到内核模式以进行发送。

但是，理论上它可能会返回而不发送所有内容，因此您确实应该循环以确保正确性。但是，您发送的块应该很大（64k 或近似值）以避免重复的内核转换。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-08-19T03:34:14.067

如果你想做一个循环，你可以使用这个 C++ 代码：

```
#define DEFAULT_BUFLEN 1452    
int SendStr(const SOCKET &ConnectSocket, const std::string &str, int strlen){
        char sndbuf[DEFAULT_BUFLEN];
        int sndbuflen = DEFAULT_BUFLEN;
        int iResult;
        int count = 0;
        int len;
        while(count < strlen){
            len = min(strlen-count, sndbuflen);
            //void * memcpy ( void * destination, const void * source, size_t num );
            memcpy(sndbuf,str.data()+count,len);
            // Send a buffer
            iResult = send(ConnectSocket, sndbuf, len, 0);
            // iResult: Bytes sent
            if (iResult == SOCKET_ERROR){
                throw WSAGetLastError();
            }
            else{
                if(iResult > 0){
                    count+=iResult;
                }
                else{
                    break;
                }
            }
        }
        return count;
    } 
```

# c# - 如何从 CrystalReport 调用 StoredProcedure？

> ID：552613
> 
> 赞同：1
> 
> 时间：2009-02-16T08:29:48.757
> 
> 标签：c#, .net, stored-procedures, crystal-reports

我想从水晶报表中调用存储过程并将检索到的值分配给报表中的字段？

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-07T15:15:58.937

要从水晶报表中调用存储过程，

将报表的数据源设置为存储过程（数据库专家向导）。该程序必须满足这些要求

1-您必须创建一个定义 REF CURSOR（将被检索的字段类型）的包。

2- 过程必须有一个 REF CURSOR 类型的参数。这是因为 CR 使用此参数来访问和定义存储过程返回的结果集。

3- REF CURSOR 参数必须定义为 IN OUT（读/写模式）。

4- 参数只能是输入 (IN) 参数。CR 不适合与 OUT 参数一起使用。

5- REF CURSOR 变量必须在过程中打开并分配其查询。

6-存储过程只能返回一个记录集。此记录集的结构不得根据参数进行更改。

7-存储过程不能调用另一个存储过程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-18T13:12:59.977

尝试**Database Expert ->（左树）当前连接 -> 添加命令**

在**将命令添加到报告**屏幕中，输入如下内容：

```
EXEC dbo.StoredProcedure (param1, param2 ...) 
```

在同一屏幕中，您可以为此查询指定参数。

因此，将创建基于查询命令的新数据源。您可以将其用作普通数据源并将字段值放置在报表区域中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T19:32:22.110

只需像添加表格或视图一样添加它。参数（如果有）将添加到您的报告中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-10T03:51:18.027

执行 dbo.StoredProcedure 参数 1，参数 2，...

不输入括号。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-11-02T04:54:17.093

将一些参数从 Crystal Report 传递到 DB 包。

在 Crystal Report 中创建新的“Command”，其参数“Name”与 Crystal Report 其他“Command”中存在的参数“Name”相同，即可正常存储过程。

例如：您正在使用“sum”函数并收到结果，并且您希望存储过程以将此数字转换为您的语言中的“阅读方式/发音”，并且在您的数据库中之前存在此函数。我们开始做吧。

# javascript - 将javascript注入FireFox

> ID：552614
> 
> 赞同：2
> 
> 时间：2009-02-16T08:30:04.760
> 
> 标签：javascript, firefox

我想创建一个句柄，通过它我可以将 javascript 注入 Firefox。

我可以用 IE 很容易地做到这一点，但 Firefox 是一个不同的故事......

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T08:32:18.920

您可以使用[油脂猴扩展](https://addons.mozilla.org/en-US/firefox/addon/748)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T00:01:37.800

你到底想做什么：

*   手动在自己的浏览器中插入 JS？
*   某些网站会自动在浏览器中插入 JS？
*   当他们访问您的网站时，在其他浏览器中插入 JS？

也许您可以描述一下您是如何使用 IE 进行操作的。一旦我们知道您想要达到的目标，我们可能会回答您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-16T10:13:56.583

这就是我使用 Firebug 扩展以手动方式执行此操作的方式。

1.  安慰。
2.  在右侧找到一个小三角形，即“命令编辑器”，按下它。
3.  粘贴代码。
4.  跑

编码：

```
var b = document.createElement("div");
b.innerHTML = "<button onclick='jarektest();'>text</button>";
document.body.appendChild(b);

// short code typed inline
var s = document.createElement("script");
s.innerHTML = "function jarektest() { alert(document.body.innerHTML); }";
document.body.appendChild(s);

// longer piece, taken from other file
var s2 = document.createElement("script");
s2.src = "file:///J:/lang/js/hello.js";
document.body.appendChild(s2); 
```

# python - python ide vs cmd 行检测？

> ID：552627
> 
> 赞同：0
> 
> 时间：2009-02-16T08:35:37.447
> 
> 标签：python

在我使用的两个 IDE 中编程时，当我使用 raw_input 时会发生不好的事情。但是在命令行上它完全按照我的预期工作。通常，此应用程序在 cmd 行中运行，但我喜欢在 IDE 中编辑和调试它。有没有办法检测我是否在 IDE 中执行了应用程序？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-16T08:39:45.567

```
if sys.stdin.isatty():
   # command line (not a pipe, no stdin redirection)
else:
   # something else, could be IDE 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T13:30:24.213

我强烈建议（并且您之前已被告知）使用一个好的 IDE 和一个好的调试器，而不是修改您的代码来修复最初不应该被破坏的东西。

我应该因为没有回答这个问题而被否决，但请考虑这个建议，以确保您未来的理智。

我个人会推荐[Winpdb 调试器](http://winpdb.org/)和[PIDA IDE](http://pida.co.uk)

# mysql - MySQL 中的 SQL Server 的 @@error 是否有等价物

> ID：552628
> 
> 赞同：3
> 
> 时间：2009-02-16T08:36:24.183
> 
> 标签：mysql, database, error-handling

我想对生产数据库运行更新查询，并且作为优秀的小开发人员，我正在努力使其尽可能安全。我正在寻找执行以下操作

```
BEGIN TRANSACTION
    UPDATE table_x SET col_y = 'some_value'
    .
    .
    .
IF (@@error <> 0)
BEGIN
    ROLLBACK
END
ELSE
BEGIN
    COMMIT
END 
```

以上应该在 SQL Server 中工作，但我需要它来处理 MySQL 数据库。

编辑：对不起，有超过 1 条语句要执行。是的，我知道不需要在事务中包装单个查询。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T09:02:29.147

```
BEGIN;
UPDATE foo SET bar = 3;
UPDATE bar SET thing = 5;
COMMIT; 
```

如果发生错误，整个事务将自动回滚。`ROLLBACK`如果您的应用程序中的某些内容表明需要回滚，您实际上只需要执行。

* * *

可以在 MySQL 中的过程或复合语句中显式处理错误，但我不建议沿着这条路线走。请参阅此操作指南[文章](http://www.databasejournal.com/features/mysql/article.php/3554616/MySQL-Stored-Procedures-Part-3.htm)和[DECLARE HANDLER 的文档](http://dev.mysql.com/doc/refman/5.0/en/declare-handler.html)。您还必须[找到您要处理的特定错误代码](http://dev.mysql.com/doc/refman/5.0/en/error-messages-server.html)，或者您可以使用一般`SQLEXCEPTION`条件。您还需要查看[复合语句](http://dev.mysql.com/doc/refman/5.0/en/begin-end.html)和[定义存储程序](http://dev.mysql.com/doc/refman/5.0/en/stored-programs-defining.html)。

无论如何，根据文档，您可以执行以下查询之类的操作，但老实说，它与我上面之前的答案没有什么不同。它也会让任何使用 MySQL 的人（包括我自己）看起来*很奇怪。*

```
BEGIN
  DECLARE EXIT HANDLER FOR SQLEXCEPTION ROLLBACK;
  START TRANSACTION;
    UPDATE foo SET bar = 3;
    UPDATE bar SET thing = 5;
  COMMIT;
END; 
```

* * *

老答案：

如果您正在执行单个查询，这没有任何意义。只需执行查询；如果发生错误，什么都不会发生——您的事务将自动回滚。

原因是，默认情况下，所有单个查询都包装在“隐藏”事务中，在 MySQL 中称为“自动提交”模式。典型的替代方法是显式使用事务——一旦你执行“BEGIN”，你就开始了一个事务。一旦您提交或回滚，您将回到自动提交模式。

因此，在 MySQL 中使用事务的唯一原因是如果您想在发生错误（或其他一些外部事件）时回滚到特定状态。在 MySQL 中，如果发生错误，事务总是会中止。

最后，可以完全关闭此行为，然后您必须始终明确地使用事务。我相信“BEGIN”是从您上次提交或回滚时隐含的，但您必须 COMMIT 或 ROLLBACK 您运行的任何查询。

有关更多信息，请参阅MySQL 手册中[的 InnoDB 事务模型](http://dev.mysql.com/doc/refman/5.0/en/innodb-transaction-model.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T09:50:46.487

```
CREATE PROCEDURE prc_test()
BEGIN
  DECLARE EXIT HANDLER FOR SQLEXCEPTION
  BEGIN
    ROLLBACK;
  END;
  START TRANSACTION;
    INSERT
    INTO t_test VALUES ('test', 'test');
    INSERT
    INTO no_such_table
    VALUES ('no');
  COMMIT;
END;

CALL prc_test();

SELECT *
FROM t_test;

0 rows fetched. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T09:01:44.577

我不认为这是必要的，因为存在隐式提交/回滚的概念。

来自[MySQL 文档](http://dev.mysql.com/doc/refman/5.1/en/innodb-implicit-commit.html)：

> 默认情况下，MySQL 在启用自动提交模式的情况下为每个新连接启动会话，因此如果该语句没有返回错误，MySQL 会在每个 SQL 语句之后执行提交。如果语句返回错误，则提交或回滚行为取决于错误。请参阅第 13.6.13 节，“InnoDB 错误处理”。

# c# - c# 从静态函数中打印类名

> ID：552629
> 
> 赞同：35
> 
> 时间：2009-02-16T08:36:59.910
> 
> 标签：c#, static

是否可以从静态函数中打印类名？

例如...

```
public class foo
{

    static void printName()
    {
        // Print the class name e.g. foo
    }

} 
```

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-05-02T00:42:52.187

`YourClass`您有三个选项可以在静态函数中获取该工作的类型（以及名称） ：

1.  `typeof(YourClass)`- 快速（0.043 微秒）

2.  `MethodBase.GetCurrentMethod().DeclaringType`- 慢（2.3 微秒）

3.  `new StackFrame().GetMethod().DeclaringType`- 最慢（17.2 微秒）

如果`typeof(YourClass)`不希望使用，那么`MethodBase.GetCurrentMethod().DeclaringType`绝对是最好的选择。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-02-16T08:41:37.573

```
Console.WriteLine(new StackFrame().GetMethod().DeclaringType); 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-16T08:50:48.767

虽然 StackTrace 的答案是正确的，但它们确实有开销。如果您只是想安全地避免更改名称，请考虑`typeof(foo).Name`. 由于静态方法不能是虚拟的，这通常应该没问题。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-16T10:03:39.840

一个（更清洁的，IMO）替代方案（仍然慢得要命，如果我在生产代码库中看到这个我会畏缩）：

```
Console.WriteLine(MethodBase.GetCurrentMethod().DeclaringType); 
```

顺便说一句，如果你这样做是为了记录，一些记录框架（例如 log4net）具有内置的能力。是的，它们在文档中警告你这是一个潜在的性能噩梦。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-11-29T15:51:01.400

从 C# 6.0 开始，存在一种更简单、更快捷的方法来获取类型名称作为字符串，而无需在代码中键入字符串文字，使用以下[`nameof`](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/nameof)关键字：

```
public class Foo
{
    static void PrintName()
    {
        string className = nameof(Foo);
        ...
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-16T08:38:47.907

[StackTrace](http://msdn.microsoft.com/en-us/library/system.diagnostics.stacktrace.aspx)类可以做到这一点。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-02-16T10:09:50.857

由于静态方法不能被继承，所以当你编写方法时你会知道类名。为什么不直接硬编码呢？

# c++ - 我有一个指向对象的指针。如何调用需要引用的函数？

> ID：552638
> 
> 赞同：0
> 
> 时间：2009-02-16T08:42:55.603
> 
> 标签：c++, pointers, reference

我有一个引用对象的函数：

```
void move(Ball& ball); 
```

我有另一个函数调用'move（）'，它有一个指向球的指针：

```
void foo(Ball* ball){
 //call move()
} 
```

应该怎么`foo()`传球给`move()`？

应该是这样的：

```
move(*ball); 
```

或者：

```
move(ball); 
```

或者：

```
move(&ball); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-16T08:44:05.103

第一个，move(*ball)。

第二个，move(ball) 尝试传递指针，第三个，move(&ball) 尝试将指针传递给指针。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-16T08:49:05.543

移动（*球）；

这就是为什么。您可以将引用视为基本上将指针指向它所传递的对象。因此，您需要对象本身，而不是指针。如果您调用 move(ball) 您将引用（指针）指针，而不是对象。相反， move(*ball) 取消引用指针，然后引用获取该取消引用对象的指针。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-16T08:48:25.560

使用指针上的 * 运算符取消引用它，从而获得一个 Ball 对象。由于您实际上是将参数传递给接受 Ball& （因此是 Ball 引用）的函数，因此只会传递引用，而不是整个对象。正确的用法是：

```
move(*ball); 
```

但我建议您以“说明”它们的性质的方式命名变量，这样**`ballPtr`**或**`ball_ptr`**会更合适，并且您永远不会忘记取消引用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-30T12:51:44.410

第一个是正确的，即 move(*ball) ball 是指向对象的指针，您需要在取消引用它之后取消引用它由球指针指向的对象。

# apache - Apache mod_rewrite 和 PHP ?argument=something

> ID：552641
> 
> 赞同：0
> 
> 时间：2009-02-16T08:44:16.630
> 
> 标签：apache, mod-rewrite

我试图让我网站上的所有 HTML 和 PHP 文件通过 index.php 重定向，以便它们可以应用通用框架，这是我编写的模板解决方案，我发现它非常优雅。任何人，我的 PHP 文件都有问题，特别是那些后面有参数的文件。

我对 PHP 文件的常规规则如下：

```
RewriteCond %{REQUEST_URI} !index.php$
RewriteRule ^(.+).php$ index.php?page=$1&type=1 [NC,L] 
```

这适用于任何没有参数的页面，但是您可以看到任何具有

```
?argument=something 
```

最终为：

```
index.php?page=path/to/page?argument=something&type=1 
```

这根本不是一个可行的解决方案。现在，在这里困扰我的是规则末尾的 $，如果 .php 之后有任何内容，那不应该导致它失败吗？

Anywho，我尝试将规则重写为：

```
RewriteRule ^(.+).php\?(.+)$ index.php?page=$1&type=1&$2 [NC,L] 
```

但这根本不会触发。似乎 mod_rewrite 中使用的正则表达式风格与我习惯使用的有很大不同，所以我确信这些是我犯的简单错误，但我似乎无法找到适合*这种*正则表达式风格的文档除了最基本的例子。

谁能告诉我我做错了什么？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-16T08:47:50.320

在您的规则中尝试 qsa，它代表“查询字符串追加” - 然后 mod_rewrite 会将原始 URL 中的任何查询字符串附加到重写的 URL

```
RewriteCond %{REQUEST_URI} !index.php$
RewriteRule ^(.+).php$ index.php?page=$1&type=1 [NC,L,qsa] 
```

RewriteRule 与查询字符串不匹配，这就是您的第二次尝试无效的原因。[这是手册](http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html)中的相关说明

> 模式不会与查询字符串匹配。相反，您必须使用带有 %{QUERY_STRING} 变量的 RewriteCond。但是，您可以在包含查询字符串部分的替换字符串中创建 URL。只需在替换字符串中使用问号，即可指示应将以下文本重新注入到查询字符串中。当您想删除现有的查询字符串时，只用问号结束替换字符串。要将新查询字符串与旧查询字符串组合，请使用 [QSA] 标志。

# sql-server - 在多个数据库服务器上执行并行查询（运行 Microsoft SQL Server）

> ID：552645
> 
> 赞同：4
> 
> 时间：2009-02-16T08:46:06.533
> 
> 标签：sql-server, database

是否可以配置多个数据库服务器（都托管同一个数据库）以同时执行单个查询？

我不是要同时使用多个 CPU 执行查询——我知道这是可能的。

**更新**

我的意思是这样的：

*   有两个2服务器：*Server1*和*Server2*
*   服务器主机数据库*Foo和**Foo*的两个实例都是相同的
*   我连接到 Server1 并提交一个复杂的（大量连接、大量计算）查询
*   *Server1*决定应该在*Server2*上进行一些计算，并且也应该从该服务器读取一些数据 - 查询的适当部分被发送到*Server2*
*   两台服务器都读取数据并执行必要的计算
*   最后，将*Server1*和*Server2*的结果合并并返回给客户端

所有这些都应该**自动**发生，无需显式引用*Server1*或*Server2*。我的意思是这样的并行查询执行 - 有可能吗？

**更新 2**

感谢您的提示，John 和 wuputah。

我正在研究提高MOSS 数据库后端可用性和容量的**替代方案。**所以我正在寻找某种开箱即用的 SQL Server 负载平衡解决方案，它对**应用程序是透明的**，因为我**无法**以任何方式修改应用程序。**我猜 SQL Server 没有这样的功能**（据我所知，Oracle 确实有——它是 wuputah 提到的 RAC）。

**更新 3**

引用[SQL Server 群集的重要提示](http://technet.microsoft.com/en-us/magazine/2007.03.sqlclusters.aspx)文章：

> 让我们从揭穿一个常见的误解开始。您使用 MSCS 集群来实现高可用性，而不是负载平衡。此外，SQL Server 没有任何内置的自动负载平衡功能。您必须通过应用程序的物理设计进行负载平衡。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T11:48:24.583

您真正在谈论的是集群解决方案。看起来[SQL Server](http://technet.microsoft.com/en-us/magazine/2007.03.sqlclusters.aspx)和[Oracle](http://en.wikipedia.org/wiki/Oracle_RAC)对此有解决方案，但我对它们一无所知。我猜想它们的购买和实施成本会很高。

可能的替代建议如下：

*   使用主从复制，并从从属执行复杂的读取查询。所有写入都必须发送到主服务器，然后发送到从服务器，因此事情保持同步。这有助于事情进展得更快，因为从站只需要担心来自主站的写入，这些写入已经代表从站预先确定（没有死锁等）。如果您希望使用多台服务器，这是我要开始的第一个地方。
*   使用主-主复制。这意味着来自两台服务器的所有写入都会相互发送，因此它们保持同步（至少在理论上）。这具有作为主从的一些好处，但您不必担心写入到一台服务器而不是另一台服务器。主-主复制更常见的用途是用于故障转移支持；主从确实更适合性能。
*   使用 John Sansom 谈到的功能。我对此了解不多，但似乎它的基础是将您的数据库拆分为不同服务器上的表，这将有一些好处和缺点。最大的问题是，由于两个系统不能共享内存，它们将不得不通过网络共享大量数据来计算复杂的连接。

希望这可以帮助！

* * *

重新更新 1：

如果你不能修改应用程序，有希望，但可能有点复杂。如果要设置主从复制，则可以设置代理以将读取查询发送到从属服务器并将查询写入主服务器。我已经看到使用 MySQL 完成此操作，但没有使用 SQLServer。除非您想自己编写代理，否则这有点问题。

这已[在 SO 上讨论过](https://stackoverflow.com/questions/434982/mirroring-vs-replication/435043#435043)，因此您可以在那里找到更多信息。

* * *

重新更新 2：

微软的集群可能不是为性能而设计的，但这是微软的错。这仍然是您在这里谈论的复杂程度。如果他们说这无济于事，那么您的选择仅限于上述那些以及您对应用程序所做的事情（如分片、拆分为多个数据库等）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T09:03:33.543

是的，我相信这是可能的，好吧，让我解释一下。

您需要调查和研究分布式查询的使用。分布式查询跨多个服务器运行，通常用于引用未存储在本地的数据。

[http://msdn.microsoft.com/en-us/library/ms191440.aspx](http://msdn.microsoft.com/en-us/library/ms191440.aspx)

例如，服务器 A 可能保存我的客户表，服务器 B 保存我的订单表。可以使用分布式查询来运行同时引用服务器 A 和服务器 B 的查询，每个服务器管理其本地数据的处理（这可以结合使用并行性）。

现在理论上，您可以在每台服务器上存储完全相同的数据并专门设计您的查询，以便在某些服务器上只引用某些表，从而分配查询负载。然而，就 CPU 而言，这不是真正的并行处理。

如果您的预期目标是分配应用程序的处理负载，那么 SQL Server 的典型方法是使用复制在多个服务器之间分配数据处理。此方法也不应与并行处理相混淆。

[http://databases.about.com/cs/sqlserver/a/aa041303a.htm](http://databases.about.com/cs/sqlserver/a/aa041303a.htm)

我希望这会有所帮助，但当然，请随时提出您可能有的任何问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T12:28:06.763

有趣的问题，但我正在努力解决这对多用户系统有益的问题。

如果我是唯一一个在 Server1 上完成一半查询而在 Server2 上完成另一半查询的用户，听起来很酷:)

如果有两个并发用户（可以说具有相同难度的查询），那么我很难看到这有帮助:(

I could have identical data on both servers and load balancing - so I get Server1, my mate gets Server2 - or I could have half the data on Server1 and the other half on Server2, and each will be optimised, and cache, just their own data - spreading the load. But whenever you have to do a merge to complete a query the limiting factor becomes the pipe-size between them.

Which is basically Federated Database Servers. Instead of having all my Customers on one server and all my Orders on the other I could, say, have my USA customers and their orders on one, and my European customers/orders on the other, and only if my query spans both is there any need for a merge step.

# php - 任何人都知道 PHP 系统命令行 zip 的一个很好的例子

> ID：552652
> 
> 赞同：2
> 
> 时间：2009-02-16T08:49:31.283
> 
> 标签：php, command-line, zip

这是另一个基于给我的答案的问题。

我需要的是能够根据网络用户选择的内容对大文件进行系统命令行 zip，然后提示它们或强制下载。这可以做到吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T09:48:22.203

这绝对可以做到——实际上有很多不同的方法可以做到这一点。一种方法是使用 PHP Zip 扩展 ( [http://www.php.net/manual/en/book.zip.php](http://www.php.net/manual/en/book.zip.php) ) 来制作文件存档。然后，要让用户下载文件，您需要设置下载页面的标题，如下所示：

```
header("Cache-Control: public");
header("Content-Description: File Transfer");
header("Content-Disposition: attachment; filename=$file");
header("Content-Type: application/zip");
header("Content-Transfer-Encoding: binary"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T10:36:56.017

您可能希望将 phpMyAdmin 的实现称为仅 PHP 实现的示例。[在phpmyadmin.net](http://www.phpmyadmin.net/)下载它并查看`libraries/zip.lib.php`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T09:03:43.870

How about [gzip](http://www.gzip.org/)?

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T11:07:55.787

为什么不使用 zip/unzip linux 实用程序？在 linux 命令行中运行 'zip --help' 以获取详细信息

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-16T21:41:01.833

我会推荐使用精彩（简单）的 PCLZip 库： [http ://www.phpconcept.net/pclzip/index.en.php](http://www.phpconcept.net/pclzip/index.en.php)

然后，您可以发送带有上述标题的文件。

# git - 如何在没有 Git 的情况下将 Git SHA1 分配给文件？

> ID：552659
> 
> 赞同：141
> 
> 时间：2009-02-16T08:53:23.490
> 
> 标签：git, sha1

据我了解，当 Git 将 SHA1 哈希分配给文件时，此 SHA1 根据其内容对文件是唯一的。

因此，如果文件从一个存储库移动到另一个存储库，则该文件的 SHA1 保持不变，因为其内容没有更改。

Git 如何计算 SHA1 摘要？它是否对完整的未压缩文件内容执行此操作？

我想模拟在 Git 之外分配 SHA1。

* * *

## 回答 #1

> 赞同：259
> 
> 时间：2009-02-16T09:25:54.410

这就是 Git 计算文件（或者，用 Git 术语，“blob”）的 SHA1 的方式：

```
sha1("blob " + filesize + "\0" + data) 
```

因此，您无需安装 Git 即可轻松自行计算。请注意，“\0”是 NULL 字节，而不是两个字符的字符串。

例如，一个空文件的哈希：

```
sha1("blob 0\0") = "e69de29bb2d1d6434b8b29ae775ad8c2e48c5391"

$ touch empty
$ git hash-object empty
e69de29bb2d1d6434b8b29ae775ad8c2e48c5391 
```

另一个例子：

```
sha1("blob 7\0foobar\n") = "323fae03f4606ea9991df8befbb2fca795e648fa"

$ echo "foobar" > foo.txt
$ git hash-object foo.txt 
323fae03f4606ea9991df8befbb2fca795e648fa 
```

这是一个 Python 实现：

```
from hashlib import sha1
def githash(data):
    s = sha1()
    s.update("blob %u\0" % len(data))
    s.update(data)
    return s.hexdigest() 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2010-02-24T11:32:15.817

一点好东西：在外壳中

```
echo -en "blob ${#CONTENTS}\0$CONTENTS" | sha1sum 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-07-31T15:33:51.977

如果您没有安装 git，您可以创建一个 bash shell 函数来轻松计算它。

```
git_id () { printf 'blob %s\0' "$(ls -l "$1" | awk '{print $5;}')" | cat - "$1" | sha1sum | awk '{print $1}'; } 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-16T09:24:43.443

查看[*git-hash-object*](http://www.kernel.org/pub/software/scm/git/docs/git-hash-object.html)的手册页。您可以使用它来计算任何特定文件的 git 哈希。我*认为*git 不仅仅是将文件的内容提供给哈希算法，但我不确定，如果它确实提供了额外的数据，我不知道它是什么。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-02-23T17:29:12.467

```
/// Calculates the SHA1 for a given string
let calcSHA1 (text:string) =
    text 
      |> System.Text.Encoding.ASCII.GetBytes
      |> (new System.Security.Cryptography.SHA1CryptoServiceProvider()).ComputeHash
      |> Array.fold (fun acc e -> 
           let t = System.Convert.ToString(e, 16)
           if t.Length = 1 then acc + "0" + t else acc + t) 
           ""
/// Calculates the SHA1 like git
let calcGitSHA1 (text:string) =
    let s = text.Replace("\r\n","\n")
    sprintf "blob %d%c%s" (s.Length) (char 0) s
      |> calcSHA1 
```

这是 F# 中的解决方案。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-09-20T21:03:22.457

完整的 Python3 实现：

```
import os
from hashlib import sha1

def hashfile(filepath):
    filesize_bytes = os.path.getsize(filepath)

    s = sha1()
    s.update(b"blob %u\0" % filesize_bytes)

    with open(filepath, 'rb') as f:
        s.update(f.read())

    return s.hexdigest() 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-04-01T01:04:38.773

在 Perl 中（另请参见[http://search.cpan.org/dist/Git-PurePerl/](http://search.cpan.org/dist/Git-PurePerl/)上的 Git::PurePerl ）

```
use strict;
use warnings;
use Digest::SHA1;

my @input = &lt;&gt;;

my $content = join("", @input);

my $git_blob = 'blob' . ' ' . length($content) . "\0" . $content;

my $sha1 = Digest::SHA1->new();

$sha1->add($git_blob);

print $sha1->hexdigest(); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-08-06T09:29:21.953

在 Perl 中：

```
#!/usr/bin/env perl
use Digest::SHA1;

my $content = do { local $/ = undef; <> };
print Digest::SHA1->new->add('blob '.length($content)."\0".$content)->hexdigest(), "\n"; 
```

作为 shell 命令：

```
perl -MDigest::SHA1 -E '$/=undef;$_=<>;say Digest::SHA1->new->add("blob ".length()."\0".$_)->hexdigest' < file 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-06-27T18:49:06.530

使用 Ruby，您可以执行以下操作：

```
require 'digest/sha1'

def git_hash(file)
  data = File.read(file)
  size = data.bytesize.to_s
  Digest::SHA1.hexdigest('blob ' + size + "\0" + data)
end 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-09-06T15:12:02.727

一个小 Bash 脚本应该产生与以下内容相同的输出`git hash-object`：

```
#!/bin/sh
( 
    echo -en 'blob '"$(stat -c%s "$1")"'\0';
    cat "$1" 
) | sha1sum | cut -d\  -f 1 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-06-17T13:10:54.440

您也可以在文件上应用相同的

```
$ echo "foobar" > foo.txt
$ echo "$(cat foo.txt)"|(read f; echo -en "blob "$((${#f}+1))"\0$f\n" )|openssl sha1
323fae03f4606ea9991df8befbb2fca795e648fa 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-06-28T08:57:50.770

在 JavaScript 中

```
const crypto = require('crypto')
const bytes = require('utf8-bytes')

function sha1(data) {
    const shasum = crypto.createHash('sha1')
    shasum.update(data)
    return shasum.digest('hex')
}

function shaGit(data) {
    const total_bytes = bytes(data).length
    return sha1(`blob ${total_bytes}\0${data}`)
} 
```

* * *

## 回答 #13

> 赞同：-4
> 
> 时间：2013-10-12T17:57:35.560

有趣的是，Git 显然会在数据的末尾添加一个换行符，然后才会对其进行哈希处理。一个只包含“Hello World！”的文件 得到一个 980a0d5... 的 blob 散列，与这个相同：

```
$ php -r 'echo sha1("blob 13" . chr(0) . "Hello World!\n") , PHP_EOL;' 
```

# yagni - 什么时候违反 YAGNI？

> ID：552663
> 
> 赞同：10
> 
> 时间：2009-02-16T08:56:07.350
> 
> 标签：yagni

**YAGNI** “原则”指出，您不应该在需要之前专注于提供功能，因为无论如何“您不会需要它”。

无论如何，我通常倾向于在任何规则之上使用常识，但有时我觉得如果你有充分的理由，过度设计或未来证明某些东西是有用的，即使你可能永远不会使用它。

我现在手头的实际情况或多或少是这样的：

我有一个必须通过简单的**专有通信协议**（OSI 4 级）运行的应用程序。该协议具有一组理想的特性（例如遵循 NORM 规范），这些特性为应用程序提供了鲁棒性，但并非严格要求（UDP 多播可以执行可接受的）。

还有一个事实是，该应用程序将来可能（但不一定）被其他无法访问专有解决方案的客户使用，因此需要另一个解决方案。事实上，我知道该应用程序的另一个客户的可能性很高。

那么，你的想法是什么？我应该只为专有协议进行设计，然后将重构、接口提取等留到我真正需要的时候，还是应该**现在**就考虑（不是那么远）未来进行设计？

**注意：**为了清楚起见，我有兴趣听到对一般问题（何时违反 YAGNI）的各种意见，但我真的很想对我目前的困境提出一些建议或想法:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-16T09:22:15.557

YAGNI 应用于代码的原因是更改成本低。使用良好、重构良好的代码在以后添加功能通常很便宜。这与说构造不同。

在协议的情况下，稍后添加更改通常并不便宜。旧版本中断，它可能导致通信失败，以及一个 N^2 测试矩阵，因为您必须针对每个其他版本测试每个版本。将此与单个代码库进行比较，其中新版本只需要自己工作。

所以在你的情况下，对于协议设计，我不推荐 YAGNI。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-16T09:13:45.030

恕我直言

*   我会说先去 YAGNI。**使用“最简单的**方法”让它在没有 NORM 规范的情况下工作。
*   接下来比较未来进行“设计更改”的成本是否**明显高于**现在进行更改。您当前的解决方案是**可逆**的吗？如果您明天或几个月后可以轻松进行更改，请不要现在进行。如果您现在不需要做出不可逆转的设计决定.. 延迟到最后一个负责任的时刻（以便您有更多信息来做出更好的决定）

如果您非常确定地*知道*某事即将出现并在以后添加它会很痛苦，那么要关闭它，不要成为鸵鸟……为它设计。
*例如，我知道在产品发货之前需要诊断日志。一个月后添加日志代码将比今天在我编写每个函数时添加它更加努力......所以这将是我会覆盖 YAGNI 的情况，即使我现在不需要日志。*

另见：T. & M. Poppendieck 的精益书籍更能解释上述第 2 条的困境。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-16T09:02:33.997

很好地构建程序（抽象等）并不是 YAGNI 所适用的。你总是想很好地组织你的代码。

澄清一下，我认为您目前的困境是由于过度应用 YAGNI 造成的。以这样一种方式构建您的代码，以便您拥有一个可重用的库来使用此协议，这只是一种良好的编程实践。YAGNI 不适用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-16T08:57:06.460

我认为当你想学习一些东西时，YAGNI 可能是不合适的 :) YAGNI 对专业人士有好处，但不适合学生。当你想学习时，你总是需要它。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-16T09:18:44.067

我认为这非常简单明了：

*当您完全确定****您将需要它***时违反 YAGNI

 *** * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-16T09:02:07.930

我不会担心的。你意识到“YAGNI”的事实意味着你已经在务实地思考。

我想说，不管这里发布了什么，从统计上讲，你比没有以同样方式分析他们的实践的人更有可能提出更好的代码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-16T13:58:44.473

我同意 Gishu 和 Nick 的观点。

稍后设计协议的一部分通常会导致诸如“该死，我应该这样做，现在我不得不使用这种丑陋的解决方法”这样的想法

但这也取决于谁将与此协议交互。
**如果您的控制两端，并且它们将同时更改版本**，您可以随时重构协议，就像使用普通代码接口一样。

关于稍后进行额外的协议功能实现，我发现实现该协议有助于验证其设计，因此您可能至少想做一个简单的非生产代码示例来测试它，如果您需要设计正式。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-06T03:27:37.307

在某些情况下，违背 YAGNI 的直觉是有意义的。

这里有几个：

**遵循编程约定。**尤其是基类和接口契约。例如，如果您继承的基类提供 GetHashCode 和 Equals 方法，则覆盖 Equals 但不覆盖 GetHashCode 会破坏开发人员在覆盖 Equals 时应遵循的平台记录规则。即使您发现实际上不会调用 GetHashCode，也应遵循此约定。不覆盖 GetHashCode 是一个错误，即使没有当前的方法来激发它（除了人为的测试）。该平台的未来版本可能会引入对 GetHashCode 的调用。或者，另一个查看过文档（在本例中为您所继承的基类的平台文档）的程序员可能会理所当然地期望您的代码在不检查您的代码的情况下遵守。

**支持定制。**特别是不会修改您的源代码的外部开发人员。您必须在代码中找出并实现合适的扩展点，以便这些开发人员可以实现您从未想过的各种插件功能。不幸的是，您将添加一些外部开发人员最终很少使用的可扩展性功能，这对课程来说是很正常的。（如果可以提前与所有外部开发人员讨论可扩展性要求或使用频繁的开发/发布周期，那很好，但这并非对所有项目都可行。）

**断言、调试检查、故障保护等。**这些代码实际上并不是您的应用程序正常工作所必需的，但它有助于确保您的代码现在和将来在进行修订时正常工作。

# c# - 如何直接在记事本上显示来自 StreamReader 的内容？

> ID：552671
> 
> 赞同：0
> 
> 时间：2009-02-16T09:01:49.023
> 
> 标签：c#, streamreader, notepad

有没有办法直接在记事本窗口中显示内存中的内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T09:08:48.570

我假设我理解你的问题。如果该文件已经存在于机器上，您可以执行以下操作：

```
System.Diagnostics.Process.Start( "notepad.exe", "[PATH]\[FILE].txt"); 
```

如果没有，则将文件保存在本地，然后运行上述代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T09:08:03.267

双击该文件，确保关联设置为记事本。

如果您希望记事本显示它而不将其保存到磁盘，您可以打开一个记事本实例，获取窗口句柄，然后将文本直接写入其中。您将需要使用 Windows 用户 API 来执行此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T09:27:50.940

完成此操作的最简单方法是保存文件并在记事本中打开它，但至少还有两种其他方法。

1.  打开记事本，然后将您想要的内容复制到剪贴板，然后使用 DDE 强制记事本进行粘贴。这很糟糕，因为它可能会覆盖用户可能在剪贴板中所做的事情。
2.  第二种方法涉及获取记事本编辑控件的窗口句柄，然后对窗口执行 WM_SETTEXT。但是，这不会跨越权限边界（例如对于以管理员身份运行但记事本以普通用户身份运行的应用程序）。这还涉及降低到本机级别并执行 P/Invokes。不完全是一个简单的方法。

坦率地说，将其保存到文件并加载它是最简单的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T09:18:11.837

为什么需要记事本来显示一些内容（在内存中）？

如果你使用的是winforms，你可以把它放在一个文本框中。
抱歉，如果我没有正确理解您的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-16T09:23:46.647

我想补充一下 MrEdmundo 的回答，即[独立存储](http://www.google.be/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Fmsdn.microsoft.com%2Fen-us%2Flibrary%2F3ak841sy(VS.80).aspx&ei=gzCZSdWIM8-n-gbynciOCQ&usg=AFQjCNFhdAspR8wKUGaXdjS3j9I_WqBCMA&sig2=IVo0nGlRijCc0IQsd5I6fQ)是存储记事本临时 txt 文件的正确位置。

# winforms - winforms 应用指南

> ID：552680
> 
> 赞同：0
> 
> 时间：2009-02-16T09:04:19.157
> 
> 标签：winforms, menu

我想开始创建一个左侧有一个菜单的应用程序（树中的一些项目），当我单击这些项目时，我想在表单的右侧打开不同的页面。有人可以指导我正确地做到这一点吗？我不想在内存中有大量数据，而只是将这些页面一个接一个地显示。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T09:39:05.097

一种方法是将树视图[停靠](https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-6165908.html)在左侧，并将面板停靠以填充。然后，在树的[SelectedNodeChanged](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.treeview.selectednodechanged.aspx)事件上，您可以将表单加载到面板中。每次更改节点时请务必清除旧表单。

页面是指网页吗？如果是这样，请查看[WebBrowser](http://frazzleddad.blogspot.com/2007/07/working-with-webbrowser-control-in.html)控件。

# encryption - Compact Framework - 获取存储卡序列号

> ID：552681
> 
> 赞同：4
> 
> 时间：2009-02-16T09:05:23.663
> 
> 标签：encryption, compact-framework, .net-2.0, c#-2.0

大家早，

我将如何在我的移动设备上获取存储/SD 卡的序列号？我在 Compact Framework V2.0 上使用 C#.Net 2.0。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T19:49:40.073

智能[设备框架提供了一种](http://blog.opennetcf.com/ctacke/2009/03/31/GettingAnSDCardSerialNumberInTheCompactFramework.aspx)获取 SD 卡序列号和制造商 ID 的机制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T09:45:26.610

我不在一台可以为您获取语法的机器上，但我相信您可以使用 System.IO 命名空间来获取基于 IO 的属性。

首先获取一个 DirectoryInfo 到存储卡。（我不是 100% 了解这里的代码，您可能需要测试，如果我可以使用我的机器，我会更新它）

```
public DirectoryInfo GetStorageCard() {
    DirectoryInfo deviceRoot = new DirectoryInfo("/");
    foreach (DirectoryInfo dir in deviceRoot.GetDirectories()) 
       if (dir.Attributes == FileAttributes.Directory & dir.Attributes = FileAttributes.Temporary)
return dir;
} 
```

然后检查代码返回的 DirectoryInfo 上的所有属性。由于调试的乐趣，您应该能够查看序列号是否是可用属性之一。

如果没有，您可能需要寻找一些更不受管理的东西。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T10:04:53.800

您需要使用一些非托管 API。具体来说，[DeviceIoControl](http://msdn.microsoft.com/en-us/library/ms898288.aspx)使用[IOCT_DISK_GET_STORAGEID](http://msdn.microsoft.com/en-us/library/ms901392.aspx)的“控制代码” 。反过来，这将返回一个[STORAGE_IDENTIFICATION](http://msdn.microsoft.com/en-us/library/aa448149.aspx)结构。

这里有点棘手，因为 STORAGE_IDENTIFICATION 使用属性 (dwSerialNumOffset) 来指定从结构开头的（内存）偏移量，这很难转化为互操作调用。

**编辑：**在 MSDN 论坛上找到了一个[VB.NET 实现](http://social.msdn.microsoft.com/Forums/en-US/netfxcompact/thread/3b8c521d-a19a-423b-8e39-488d13b0e4db/)

# visual-c++ - How can I switch off exception handling in MSVC?

> ID：552695
> 
> 赞同：24
> 
> 时间：2009-02-16T09:13:04.783
> 
> 标签：visual-c++, exception-handling

Does anybody know how to switch off exception handling option in MSVC? I tried to set the option 'Enable C++ exceptions' to 'NO' and I got warning: warning C4530: C++ exception handler used, but unwind semantics are not enabled. Specify `/EHsc`.

I would like to switch off the exception handler, too, but I don't know how.

In my application I basically need more speed than stability, therefore I chose switching off the exception handling. I do not have any `try`/`catch` blocks, but I do use STL. When I switch the option 'Enable C++ exceptions' to 'NO' is there any way how to get rid of those warnings?

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-07-08T01:23:24.213

您很可能包含一个或多个包含 try/catch 的标准 C++ 标头。最典型的情况是`<iostream>`- 您将在一个文件中收到此错误，该文件由仅包含该文件的单行组成。任何其他流标头也可以，语言环境也可以。

如果您仔细查看错误消息，它应该引用两个文件名，而不是一个 - 您的文件和包含错误的文件。例如，在我的示例案例中`#include <iostream>`，我得到了这个：

```
except.cpp
C:\Program Files\Microsoft Visual Studio 9.0\VC\INCLUDE\xlocale(342) : warning C4530: C++ exception handler used, but unwind semantics are not enabled. Specify /EHsc 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-12-18T18:27:15.330

如果您真的不希望 STL 中的异常会链接到您的程序，`_HAS_EXCEPTIONS=0`请在整个项目中定义。`/EHsc`如果您不打算添加异常处理，则比编译代码要好。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-16T10:07:53.670

该警告意味着您告诉编译器您不会使用异常，但`try {} catch() {}` 代码中有一个块。它通知您，尽管您有该块，但如果抛出异常，则不会执行任何析构函数。关闭异常意味着——编译器不会在异常情况下展开堆栈时生成用于自动销毁的代码。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-03-24T12:56:50.420

在 Visual Studio 中，`/EH`可在配置属性 ➔ C/C++ ➔ 代码生成 ➔ 启用 C++ 异常中找到。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-16T09:30:00.187

关闭异常非常困难，因为您在这里处理的是 C++。它实际上与关闭 NULL 指针属于同一类 - 例如，您将如何处理内存分配失败？

也就是说，/EH 指定了您想要*的*异常处理模型，并且“无”不是一个选项。您可以选择 /EHa、/EHs、/EHac 和 /EHsc - [a] 同步，支持或不支持抛出外部“C”函数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-16T09:25:17.687

Do you still have try/catch block(s) in your code?

The first thing to do when you get stuck is look up the error on MSDN and/or Google for it. That usually helps. This is what MSDN says:

> When the /EHsc option has not been enabled, an object with automatic storage in the frame, between the function doing the throw and the function catching the throw, will not be destroyed. However, an object with automatic storage created in a try or catch block will be destroyed. [...]

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-10-02T07:08:16.023

使用 MSVC aka CL 可以简单地使用 /kernel 开关或没有任何 /EH 开关。Windows C/C++ MSVC 版本总是有[SEH](https://en.wikipedia.org/wiki/Microsoft-specific_exception_handling_mechanisms#SEH)。SEH 内置在 Windows 中。

如果`#if _HAS_EXCEPTIONS == 0`，MS STL 将简单地切换到 SEH。

那是标准的C++吗？不它不是。将缺少三个关键字：try、throw 和 catch。你需要了解 SEH。

那么这是一件“好事”吗？对于 Windows 低级 C++，SEH 是个好东西。

ps：不建议`/kernel`在内核开发之外使用switch。

# asp.net-mvc - How best to work with the Expires header in ASP.NET MVC?

> ID：552710
> 
> 赞同：7
> 
> 时间：2009-02-16T09:21:16.637
> 
> 标签：asp.net-mvc, outputcache

I want to be able to set a long expires time for certain items that a user downloads via GET request.

I want to say 'this is good for 10 minutes' (i.e. I want to set an Expires header for +10 minutes). The requests are fragments of HTML that are being displayed in the page via AJAX and they're good for the user's session. **I don't want to go back to the server and get a 304** if they need them again - I want the browser cache to instantly give me the same item.

I found an article which is almost a year old about [MVC Action filter caching and compression](http://weblogs.asp.net/rashid/archive/2008/03/28/asp-net-mvc-action-filter-caching-and-compression.aspx). This creates a custom ActionFilter to change the expires header. I'm already using the compression filter which works great for some custom css I am generating (94% compression rate!).

I have two main concerns :

1) Do I really have to use this method. I'm fine with it if I do, but is there really no functionality in MVC or the OutputCache functionality to do this for me? In 'traditional' ASP.NET I've always just set the Expires header manually, but we cant do that anymore - at least not in the controller.

2) If I do use this filter method - is it going to interfere with the OutputCache policy at all - which I want to be able to control in web.config. I'm kind of thinking the two are mutually exclusive and you wouldn't want both - but I'm not completely sure.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T14:25:10.697

1.  不，您不必*使用*此方法。但是，我认为这可能是最好的选择方法，因为它使控制器更具可测试性和更少的网络感知。另一种方法是在 Controller 中手动设置标头，如下所示：

    Response.AddHeader("Expires", "Thu, 01 Dec 1994 16:00:00 GMT");

2.  好吧，OutputCache 属性控制操作何时运行，以及何时返回缓存的 HTML。Expires 告诉浏览器何时重新获取 HTML。所以我不会说它们是相互排斥的，但它们肯定是同一枚硬币的两个方面，你认为你*可能*不需要两者都是正确的。我建议查看[HTTP 规范](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)以确定最适合您的应用程序的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-05-10T10:14:57.850

**Response.Expires** 此属性指定缓存在浏览器中的页面过期前的分钟数，即。如果用户在指定的分钟数之前返回到同一页面，则显示该页面的缓存版本。

**Response.ExpiresAbsolute** 使用此属性，我们可以设置浏览器中缓存的页面过期的日期和/或时间。

[http://forums.asp.net/t/1532229.aspx](http://forums.asp.net/t/1532229.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-12T18:44:19.077

听起来您只需要因用户而异：

[http://aspadvice.com/blogs/ssmith/archive/2007/10/29/VaryByCustom-Caching-By-User.aspx](http://aspadvice.com/blogs/ssmith/archive/2007/10/29/VaryByCustom-Caching-By-User.aspx)

```
[OutputCache(Duration="10", VaryByCustom="username")] 
```

全球.asax：

```
public override string GetVaryByCustomString(HttpContext context, string key)
{
    switch(key)
    {
        case "username":
            return context.User.Identity.Name;

        // Other VaryByCustom strategy implementations can go here.
    }

    return string.Empty;
} 
```

# mysql - 从 MS SQL 服务器到 MySQL 时我需要知道什么

> ID：552711
> 
> 赞同：3
> 
> 时间：2009-02-16T09:21:22.983
> 
> 标签：mysql, sql-server, database

我一直在尝试专攻 MS SQL 服务器技术，但最近我的工作要求我更多地了解 MySQL。是否有任何 MS SQL DBA 或开发人员必须这样做，如果是，他们最大的挑战是什么？目前，对我来说：

*   缺乏像样的IDE
*   没有像 ssis 这样简单的 ETL 工具

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T09:46:56.917

作为设计 MySQL 数据库的 IDE，我建议使用[MySQL Workbench](http://dev.mysql.com/downloads/workbench/5.1.html)。

我认为从 MSSql 迁移到 MySQL 的最大问题之一是告别事务，向[自动提交](http://www.oreillynet.com/databases/blog/2007/02/mysql_transactions_and_autocom.html)问好。

[这是](http://www.tometasoftware.com/MySQL-5-vs-Microsoft-SQL-Server-2005.asp)MySQL 5.0 和 MSSql 2005 之间的一个小比较（有点过时了......）

[这](http://dev.mysql.com/tech-resources/articles/migrating-from-microsoft.html)就是 MySQl 所说的......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T10:26:25.247

在我看来，这两种技术的最大区别在于底层的数据库引擎有着根本的不同。

这会产生影响，尤其是对于企业级系统，因为用于优化和设计 SQL Server 平台的性能调整技术和最佳实践设计原则不一定会转化为 MySQL。

如果您已经对 SQL Server 数据库引擎有深入的了解，那么我希望通过查看可用于驱动 MySQL 引擎的不同数据库驱动程序（例如 INODB 和 MyIsam 等）来发展对 MySQL 的这种理解水平.

关系数据库管理的基本原理当然保持不变，即您正在使用表、索引和键等，因此您不是从绝对的起点开始。如果您熟悉使用 T-SQL 来导航您的数据库结构和表，那么将其移植到 MySQL 命令提示符是一个非常平滑的过渡。

如果您经常使用 SQL Server Management Studio (SSMS) 来管理您的数据库，您可能会发现像 Navicat 这样的 GUI 工具很合您的意。

据我所知，没有像 SSIS 这样的集成 ETL 平台来补充 MySQL，因为它只关注核心数据库引擎。Microsoft SQL Server 被认为是企业数据库套件，因此包含补充数据库引擎的附加组件，例如 Reporting Services、Analysis Services、SSIS 和 Notification Services 等。

我希望这可以帮助您寻求使用新技术。学习新事物是一个很大的问题。

干杯，约翰

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T10:35:15.257

我最后一次检查 MySql 中没有 UNIQUEIDENTIFIER 数据类型。这可能成为迁移中的一个困难部分，因为许多应用程序都是基于大量使用 Guid 编写的。

我没有关注 MySql 的发展，可能是这种数据类型已经存在。

# asp.net - 是否可以在 Apache 2.x 下使用 ASP.NET 2.0 或 ASP.NET 3.5？

> ID：552716
> 
> 赞同：1
> 
> 时间：2009-02-16T09:22:39.643
> 
> 标签：asp.net, apache

我知道，以下博客中有一个解决方案：

[http://weblogs.asp.net/israelio/archive/2005/09/11/424852.aspx](http://weblogs.asp.net/israelio/archive/2005/09/11/424852.aspx)

有没有人试图让它在生产环境下工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T09:29:36.413

您链接到的 url 提到了一个不再维护的旧模块，并且不适用于 Apache 2.2（根据该帖子的评论）。页面下方的评论表明[更新的模块](http://sourceforge.net/projects/mod-aspdotnet/)适用于 Apache 2.2（有些人甚至将它与 MagicAjax 等 3rd 方组件一起使用，但细节很粗略。另请注意[错误列表](http://sourceforge.net/tracker/?atid=871785&group_id=175077&func=browse)，以及自那以后它没有更新的事实2007 年年中。还请注意，所有帖子都与 WAMP 相关——我没有从 LAMP 环境中看到任何帖子。

我会推荐 Mono for .Net 2.0 - 对于 3.5，您目前仅限于 IIS。实现这一点的一个好方法是详细的[@DoTheWeb](http://www.dotheweb.net/lama/)。

# c# - 无法让 Log4Net 在我们的 WCF 应用程序中工作

> ID：552718
> 
> 赞同：6
> 
> 时间：2009-02-16T09:23:41.497
> 
> 标签：c#, iis-6, web-config, log4net

我们正在尝试使用 Log4Net 从我们的 IIS 6 部署的 WCF 应用程序中记录。我们正在尝试登录文件，但似乎无法创建要创建的日志文件，更不用说查看其中的日志输出了。out web.config 的相关部分是：

```
<sectionGroup name="common">
    <section name="logging" type="Common.Logging.ConfigurationSectionHandler, Common.Logging" />
</sectionGroup>
...
<common>
    <logging>
        <factoryAdapter type="Common.Logging.Simple.TraceLoggerFactoryAdapter, Common.Logging">
            <arg key="level" value="INFO" />
            <arg key="showLogName" value="true" />
            <arg key="showDataTime" value="true" />
            <arg key="dateTimeFormat" value="yyyy/MM/dd HH:mm:ss:fff" />
        </factoryAdapter>
    </logging>
</common>

<log4net>
    <appender name="FileAppender" type="log4net.Appender.RollingFileAppender">
        <param name="File" value="c:\logs\ApplicationInfoTest.log" />
        <threshold value="INFO" />
        <param name="AppendToFile" value="true" />
        <param name="DatePattern" value="ddMMyyyy" />
        <param name="MaxSizeRollBackups" value="10" />
        <param name="MaximumFileSize" value="10MB" />
        <param name="RollingStyle" value="Size" />
        <param name="StaticLogFileName" value="true" />
        <layout type="log4net.Layout.PatternLayout">
            <param name="Header" value="\r\n\r\n---------------------------------------------\r\n" />
            <param name="Footer" value="\r\n---------------------------------------------\r\n\r\n" />
            <param name="ConversionPattern" value="%d [%t] %-5p - %m%n" />
        </layout>
    </appender>
    <root>
        <level value="INFO" />
        <appender-ref ref="FileAppender" />
    </root>
  </log4net> 
```

使用此配置，我们可以在使用 DebugView 时从应用程序中看到 INFO 级别的日志记录，但很明显，这是来自片段而不是
片段。

是否有我们未能在 web.config 中设置的内容？我们为要写入的日志创建的目录是否存在权限问题？

请指出我们明显的错误。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-16T18:33:22.813

我还必须将此行添加到我的应用程序的 AssemblyInfo.cs 文件中，以使 log4net 正常工作。

```
// LOG 4 net config
[assembly:log4net.Config.XmlConfigurator(Watch=true)] 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-16T09:27:23.877

使用[SysInternals 的 ProcessMonitor](http://live.sysinternals.com/tools/procmon.exe)找出权限被拒绝的位置

（可能您可以通过附加调试器并捕获异常来确定相同的信息，而不是在 Just My Code 中）

您确定运行服务的进程对您尝试写入的文件夹具有权限吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-03-10T07:53:39.997

尝试 XmlConfigurator.Configure()

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-14T10:12:22.243

您是否为 log4net 配置了配置部分？我在你的代码片段中没有看到

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-26T19:56:03.807

我将首先将 WCF 服务作为控制台应用程序运行 - 这样您可以指定应用程序运行的用户帐户，并查看问题是您的配置问题还是通过 IIS 运行服务的权限问题。

如果您不确定如何将服务作为控制台应用程序运行，请查看[http://www.jacopretorius.net/2009/08/running-windows-service-inside-console.html](http://www.jacopretorius.net/2009/08/running-windows-service-inside-console.html)

# java - Is there a SIMPLE example of How to use buckminster

> ID：552722
> 
> 赞同：6
> 
> 时间：2009-02-16T09:25:03.990
> 
> 标签：java, eclipse, build, build-process, buckminster

I don't understand buckminster at all. Lets say I have a project, and it needs log4j and junit4\. How do I get started, what do I need to do, to specify the dependencies and have the dependencies added to my classpath in eclipse. Is there any tutorial which shows how its done?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-16T21:22:10.693

我发现 buckminster 非常出色，但文档却很*糟糕*（我知道，我知道，我应该做出贡献）。

我一直在寻找构建 RCP 产品的东西。我不会谈论太多，但我会说什么对我有用：

*   “[网络研讨会](http://live.eclipse.org/node/427)”大致向我展示了我能做什么，我发现自己要回到它开始几次。
*   尝试将您的项目签出到您的工作区中。这涉及：
    1.  在 Eclipse 安装上安装 buckminster
    2.  创建一个小的 CQUERY 文件，它是 3 行 XML 告诉 buckminster 要检查的内容。
    3.  为您的项目创建 RMAP 文件。我发现这个[dogfood2.rmap](http://www.eclipse.org/buckminster/samples/rmaps/dogfood2.rmap)很有帮助。

值得庆幸的是，我能够完全忽略 CSPEC 文件，因为它们可以从现有的元数据中推断出来（即来自`MANIFEST.MF`, `plugin.xml`,`.product`文件。我认为它可以用于`.project`and`.classpath`文件，但我不_k_now）。同样，我现在会忽略 BOM 文件。

一旦我成功地实现了一个工作空间，我就可以继续尝试无头地复制它。

我发现这篇[文章](http://wiki.eclipse.org/Sample_headless_configuration_(Buckminster))对于为 Buckminster 创建适合作为我们持续集成的一部分进行部署的安装很有用。

此时，我对用于构建产品的 Eclipse 项目之间的关系进行了长时间的思考。我们选择了一棵树（原文如此），它有两个主要分支——产品分支和测试分支：

*   cquery 指向一个`build.feature`
*   `build.feature`指向 a`product`和 a `test.product`。
*   `product`指向特征`foo.feature`, `foo.ui.feature`, `bar.feature`, `bar.ui.feature`. 这些特性中的每一个都指向插件或特性。
*   `test.product`指向`foo.test.feature`, `foo.ui.test.feature`, `bar.test.feature`, `bar.ui.test.feature`. 这些功能中的每一个都指向可以运行产品插件的测试片段。

通过“指向”，我的意思是功能或 cquery 将其指定为依赖项。（我似乎无法让`Require-Bundle`清单文件中的标题正常工作，所以将所有内容都放在`feature.xml`.

我发现在这个阶段玩命令行非常有帮助。我发现最有用的`resolve`and命令。`build`我还发现在这里设置[输出属性](http://www.nabble.com/how-to-change-buckminster.temp-property--td21448059.html)很有用。

一旦我可以成功构建（即编译）所有内容，接下来就是将其打包为产品​​。将`perform`命令用于从 .product 文件生成的推断 CSPEC 文件中指定的操作 ( `create.*.product`) 几乎不直观，但它有助于使已知的良好产品能够作为产品从 IDE 中导出。

我做的最后一件事是找到`setenv`（我认为）命令，它帮助设置用于编译代码的 Java 版本。您可以设置少量属性，但这是我需要的。

[我最近也发现了](http://eclipse-projects.blogspot.com/2006/05/buckminster-for-monkey.html)[其他](http://developer.capeclear.com/7.5.1/help/index.jsp?topic=/com.capeclear.eclipse.studiohelp/studio/automation-ant.html)[链接](http://dev.eclipse.org/newslists/news.eclipse.technology.buckminster/msg00516.html) ，看起来很有帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-07-02T12:23:17.543

现在正在制作新的 Buckminster 文档。第一个“粗略”包含介绍（基于 Eclipse '09 谈话）、完全解释的 RMAP 和 CQUERY、属性和版本的详细信息。这些章节大约有 70 页，并且已接近完成。更多章节和示例要遵循。希望每周提供一份新的草稿。

你可以在这里得到它：http: [//www.eclipse.org/downloads/download.php?](http://www.eclipse.org/downloads/download.php?file=/tools/buckminster/doc/BuckyBook.pdf) file= /tools/buckminster/doc/BuckyBook.pdf (6MB)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-17T14:01:53.863

来自：[http ://wiki.eclipse.org/index.php/Introduction_to_Buckminster#Getting_Started](http://wiki.eclipse.org/index.php/Introduction_to_Buckminster#Getting_Started)

你好世界：[http://wiki.eclipse.org/index.php/Hello_XML_World_Example_(Buckminster)](http://wiki.eclipse.org/index.php/Hello_XML_World_Example_%28Buckminster%29)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T10:13:36.560

为了快速开始构建，我推荐[使用 Buckminster 和 Hudson 构建的 Headless Eclipse RCP](http://www.ralfebert.de/blog/eclipsercp/rcp_builds/)教程，尽管它不涉及物化。

正如 Henrik 提到的[bucky book](http://www.eclipse.org/downloads/download.php?file=/tools/buckminster/doc/BuckyBook.pdf)又名“权威指南”提供了很好的深度文档，从概念概述到 xml 规范。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-09-28T20:50:55.013

除了上面的建议之外，我还推荐[开发插件 - 与 Jenkins 持续集成中](http://wiki.idempiere.org/en/Developing_Plug-Ins_-_Continous_Integration_with_Jenkins)关于[准备插件](http://wiki.idempiere.org/en/Developing_Plug-Ins_-_Continous_Integration_with_Jenkins#Preparing_your_Plug-Ins)的部分作为一个相对简单的演练。

# linux - 如何在 bash 中检查文件是否创建时间超过 x 时间？

> ID：552724
> 
> 赞同：113
> 
> 时间：2009-02-16T09:25:38.187
> 
> 标签：linux, bash, command-line

我想在 linux bash 中检查一个文件是否是在 x 之前创建的。

假设文件名为 text.txt，时间为 2 小时。

```
 if [ what? ]
 then
     echo "old enough"
 fi 
```

* * *

## 回答 #1

> 赞同：155
> 
> 时间：2009-02-16T09:36:08.767

仅用于修改时间

```
if test `find "text.txt" -mmin +120`
then
    echo old enough
fi 
```

您可以`-cmin`用于更改或`-amin`访问时间。正如其他人指出的那样，我认为您无法跟踪创建时间。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2012-03-08T00:46:27.270

我一直喜欢用`date -r /the/file +%s`它来找出它的年龄。

您还可以`touch --date '2015-10-10 9:55' /tmp/file`在任意日期/时间获得极其精细的时间。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2009-09-09T19:18:29.167

使用`stat`来计算文件的最后修改日期，计算当前时间和 bashisms 的自由使用，可以根据文件的最后修改时间¹`date`进行您想要的测试。

```
if [ "$(( $(date +"%s") - $(stat -c "%Y" $somefile) ))" -gt "7200" ]; then
   echo "$somefile is older then 2 hours"
fi 
```

虽然代码的可读性不如`find`方法，但我认为它是一种更好的方法，然后运行`find`查看您已经“找到”的文件。此外，日期操作很有趣；-)

* * *

1.  正如菲尔正确指出的那样，没有记录创建时间，而是使用`%Z`而不是`%Y`下面来获取“更改时间”，这可能是您想要的。

**[更新]**

对于 mac 用户，使用`stat -f "%m" $somefile`而不是上面的 Linux 特定语法

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-02-16T09:33:04.610

不存储创建时间。

存储的是三个时间戳（通常，它们可以在某些文件系统或某些文件系统选项上关闭）：

*   上次访问时间
*   上次修改时间
*   上次更改时间

对文件的“更改”被视为权限更改、重命名等。而修改只是内容。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2011-03-25T10:15:35.623

尽管 ctime 在*技术上*不是创建时间，但它经常是。

由于 ctime 它不受文件内容更改的影响，因此通常仅在创建文件时更新。是的 - 我可以听到你们都在尖叫 - 如果您更改访问权限或所有权，它也会更新......但通常这是一次完成的事情，通常在您将文件放在那里的同时。

就个人而言，我总是将 mtime 用于所有事情，我想这就是您想要的。但无论如何......这里是 Guss 的“没有吸引力”的 bash 的重演，具有易于使用的功能。

```
#!/bin/bash
功能年龄（）{
   本地文件名=$1
   本地更改=`stat -c %Y "$filename"`
   现在本地=`日期+%s`
   本地经过

   让过去=现在改变
   回声 $elapsed
}

文件="/"
echo $file 的年龄是 $(age "$file") 秒。

```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2013-05-06T13:06:38.120

找到一个很好，但我认为你可以使用另一种方式，特别是如果你现在需要文件旧多少秒

`date -d "now - $( stat -c "%Y" $filename ) seconds" +%s`

使用 GNU 日期

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-02-16T09:33:29.710

考虑工具“stat”的结果：

```
 File: `infolog.txt'
  Size: 694         Blocks: 8          IO Block: 4096   regular file
Device: 801h/2049d  Inode: 11635578    Links: 1
Access: (0644/-rw-r--r--)  Uid: ( 1000/     fdr)   Gid: ( 1000/     fdr)
Access: 2009-01-01 22:04:15.000000000 -0800
Modify: 2009-01-01 22:05:05.000000000 -0800
Change: 2009-01-01 22:05:05.000000000 -0800 
```

您可以在此处查看访问/修改/更改的三个日期。没有创建日期。您只能真正确定文件内容何时被修改（“修改”字段）或其 inode 更改（“更改”字段）。

两个字段何时更新的示例：

如果有人将额外信息连接到文件末尾，“修改”将被更新。

如果有人通过 chmod 更改了权限，“更改”将被更新。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-01-08T10:23:01.690

我用

```
file_age() {
    local filename=$1
    echo $(( $(date +%s) - $(date -r $filename +%s) ))
}

is_stale() {
    local filename=$1
    local max_minutes=20
    [ $(file_age $filename) -gt $(( $max_minutes*60 )) ]
}

if is_stale /my/file; then
    ...
fi 
```

# c# - C#：Swap 方法的良好/最佳实现

> ID：552731
> 
> 赞同：12
> 
> 时间：2009-02-16T09:29:23.137
> 
> 标签：c#, sorting, shuffle

我读过这篇[关于洗牌的文章](http://www.codinghorror.com/blog/archives/001015.html)，在许多洗牌和排序算法中，您需要交换列表或数组中的两个项目。但是一个好的高效的 Swap 方法是什么样的呢？

让我们说 a`T[]`和 a `List<T>`。您将如何最好地实现一种在这两个项目中交换两个项目的方法？

```
Swap(ref cards[i], ref cards[n]);   // How is Swap implemented? 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-16T09:34:36.620

好吧，您发布的代码 ( `ref cards[n]`) 只能与数组（而不是列表）一起使用 - 但您可以简单地使用（其中`foo`和`bar`是两个值）：

```
static void Swap(ref int foo, ref int bar) {
    int tmp = foo;
    foo = bar;
    bar = tmp;
} 
```

~~或者可能（如果你想要原子）：~~

 ~~```
Interlocked.Exchange(ref foo, ref bar); 
```~~  ~~不过，就我个人而言，我认为我不会打扰交换方法 - 直接进行即可；这意味着您可以使用（对于列表或数组）：

```
int tmp = cards[n];
cards[n] = cards[i];
cards[i] = tmp; 
```

如果您真的想编写一个适用于列表**或**数组的交换方法，则必须执行以下操作：

```
static void Swap(IList<int> list, int indexA, int indexB)
{
    int tmp = list[indexA];
    list[indexA] = list[indexB];
    list[indexB] = tmp;
} 
```

（使这个通用化是微不足道的） - 但是，在数组上工作的原始“内联”版本（即不是方法）会更快。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-16T09:37:12.807

一个好的交换是你不交换内容的地方。在 C/C++ 中，这类似于交换指针而不是交换内容。这种交换方式很快并且带有一些异常保证。不幸的是，我的 C# 太生锈了，无法将其放入代码中。对于简单的数据类型，这种风格并没有给你太多。但是，一旦您习惯并且必须处理更大（更复杂）的对象，它就可以挽救您的生命。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-12-20T03:41:30.500

那这个呢？它是交换方法的通用实现。Jit 将为您的封闭类型创建一个编译版本，因此您不必担心性能！

```
/// <summary>
/// Swap two elements
/// Generic implementation by LMF
/// </summary>
public static void Swap<T>(ref T itemLeft, ref T itemRight) {
    T dummyItem = itemRight;
    itemLeft = itemRight;
    itemRight = dummyItem;
} 
```

HTH 洛伦佐

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-01-26T02:29:56.630

11 年后，我们有了元组......

```
(foo, bar) = (bar, foo); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-01-03T22:17:08.580

采用：

```
void swap(int &a, int &b)
{
    // &a != &b
    // a == b OK
    a ^= b;
    b ^= a;
    a ^= b;
    return;
} 
```

我没有意识到我在 C# 部分。这是 C++ 代码，但它应该具有相同的基本思想。我相信 ^ 在 C# 中也是 XOR。看起来`&`你可能需要“ref”（？）。我不确定。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-09-02T22:09:26.330

您现在可以使用元组来完成此交换，而无需手动声明临时变量：

```
static void Swap<T>(ref T foo, ref T bar)
{
    (foo, bar) = (bar, foo)
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2014-01-20T15:16:53.480

对于任何想知道的人，也可以使用扩展方法（.NET 3.0 和更高版本）进行交换。

一般来说，似乎不可能说扩展方法“this”的值是 ref，因此您需要返回它并覆盖旧值。

```
public static class GeneralExtensions {
    public static T SwapWith<T>(this T current, ref T other) {
        T tmpOther = other;
        other = current;
        return tmpOther;
    }
} 
```

然后可以像这样使用此扩展方法：

```
int val1 = 10;
int val2 = 20;    
val1 = val1.SwapWith(ref val2); 
```

# visual-studio-2008 - VS2008 在多个项目中使用强名称键

> ID：552735
> 
> 赞同：1
> 
> 时间：2009-02-16T09:30:47.563
> 
> 标签：visual-studio-2008, signing

首先，我是使用 SNK 签署程序集的新手，所以这可能是一个愚蠢的问题。

我有几个项目的解决方案，其中一些应该签署。我使用 VisualStudio 的向导创建了一个 SNK，并将其存储在解决方案文件夹中，该文件夹在所有项目之间共享。

现在，当尝试在其“属性”页面中签署项目时，VS 要求我创建一个新的 SNK 或选择一个现有的 SNK。我选择了我之前创建的那个。SNK 现在已复制（未链接）到项目文件夹中。

这样，我最终会为每个已签署的项目创建一个单独的 SNK。这真的是设计使然吗？

可以手动添加 SNK 作为项目的链接，但是 SNK 没有显示在选择框中，所以我猜 VS 不喜欢这个想法。

我想知道的主要原因是因为在 TestRunConfig 中似乎只能选择一个 SNK。这感觉很奇怪，因为我可能为每个项目使用不同的 SNK（毕竟，显然 VS 希望我为每个项目使用不同的 SNK）。

在 MSDN 中挖掘了几个小时后，我发现它没有任何帮助。如果您能指出我的错误或将我重定向到实际解释这里发生的事情的页面，我会很高兴。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T09:34:48.053

将 SNK 链接到项目中，然后在设置的 Signing 选项卡上选择它实际上是这样做的方法。

链接SNK后是否打开和关闭了设置？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-24T21:09:34.847

通过下拉菜单访问的“[添加为链接](http://www.platinumbay.com/blogs/dotneticated/archive/2008/07/10/using-a-single-strong-name-key-across-multiple-projects.aspx)”功能是我希望我很久以前就知道的！

# c# - NHibernate 中的子表

> ID：552736
> 
> 赞同：3
> 
> 时间：2009-02-16T09:31:03.117
> 
> 标签：c#, nhibernate

在 NHibernate 中有什么方法可以使用以下实体

```
public class Person
{
    public virtual int Id { get; set; }
    public virtual string Name { get; set; }
    public virtual IList<Pet> Pets { get; set; }
}

public class Pet
{
    public virtual int Id { get; set; }
    public virtual string Name { get; set; }
} 
```

并且不必为了保存子宠物而在 Person 上创建“特殊” AddPet 方法。

```
public void AddPet(Pet p)
{
    p.Person = this;
    Pets.Add(p);
}

_session.SaveOrUpdate(person); 
```

不保存 Pets，因为 Pet 没有 Person 参考。

如果我更新 Pets 以包含此参考。

```
public class Pet
{
    public virtual int Id { get; set; }
    public virtual string Name { get; set; }
    public virtual Person Person { get; set; }
} 
```

在新宠物上，我仍然必须设置 Person 这对我来说似乎有点矫枉过正而且也很危险，因为人们仍然可以调用

```
person.Pets.Add(new Pet()) 
```

我能想到的唯一其他选项是在添加子实体时设置父引用的自定义列表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-24T04:41:12.243

我稍微修改了您的示例（与此处的许多建议一致）：

```
public class Person
{
    private IList<Pet> pets;

    protected Person()
    {}

    public Person(string name)
    {
        Name = name;
        pets = new List<Pet>();
    }

    public virtual Guid Id { get; set; }
    public virtual string Name { get; set; }
    public virtual IEnumerable<Pet> Pets
    {
        get { return pets; }
    }

    public virtual void AddPet(Pet pet)
    {
        pets.Add(pet);           
    }
}

public class Pet 
{
    protected Pet()
    {}

    public Pet(string name)
    {
        Name = name;
    }

    public virtual Guid Id { get; set; }
    public virtual string Name { get; set; }
}

public class PersonMap : ClassMap<Person>
{
    public PersonMap()
    {
        Id(x => x.Id).GeneratedBy.GuidComb();
        Map(x => x.Name);
        HasMany(x => x.Pets).Cascade.AllDeleteOrphan().Access.AsLowerCaseField();
    }
}

public class PetMap : ClassMap<Pet>
{
    public PetMap()
    {
        Id(x => x.Id).GeneratedBy.GuidComb();
        Map(x => x.Name);
    }
} 
```

以下测试：

```
 [Test]
    public void CanSaveAndRetrievePetAttachedToPerson()
    {
        Person person = new Person("Joe");
        person.AddPet(new Pet("Fido"));

        Session.Save(person);

        Person retrievedPerson = Session.Get<Person>(person.Id);
        Assert.AreEqual("Fido", retrievedPerson.Pets.First().Name);
    } 
```

通过。

请注意，这是使用 Fluent NHibernate 进行映射和会话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T10:28:24.260

[C# 反射和泛型](https://stackoverflow.com/questions/552805/c-reflection-generics)

也许可以使用这种方法？

不会为孩子的孩子工作，但对亲子来说非常好。

```
protected static void SetChildReferences(E parent)
{
    foreach (var prop in typeof(E).GetProperties(BindingFlags.Public | BindingFlags.Instance))
    {
        if (!prop.CanRead) continue;

        Type listType = null;
        foreach (Type type in prop.PropertyType.GetInterfaces())
        {
            if (type.IsGenericType &&
                type.GetGenericTypeDefinition() == typeof(ICollection<>))
            {
                listType = type.GetGenericArguments()[0];
                break;
            }
        }

        List<PropertyInfo> propsToSet = new List<PropertyInfo>();
        foreach (PropertyInfo childProp in 
            (listType ?? prop.PropertyType).GetProperties(BindingFlags.Public | BindingFlags.Instance))
        {
            if (childProp.PropertyType == typeof(E))
                propsToSet.Add(childProp);
        }

        if (propsToSet.Count == 0) continue;

        if (listType == null)
        {
            object child = prop.GetValue(parent, null);
            if (child == null) continue;
            UpdateProperties(propsToSet, child, parent);
        }
        else
        {
            ICollection collection = (ICollection)prop.GetValue(parent, null);
            foreach (object child in collection)
            {
                if (child == null) continue;
                UpdateProperties(propsToSet, child, parent);
            }
        }
    }
}

protected static void UpdateProperties(List<PropertyInfo> properties, object target, object value)
{
    foreach (PropertyInfo property in properties)
    {
        property.SetValue(target, value, null);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T20:30:39.327

如果你不存储关系，你怎么知道一个人在数据库中有哪些宠物？

我会包括

```
public void AddPet(Pet p) 
```

在 Person 对象中，并有一个

```
IEnumerable<Pets> Pets { get; } 
```

公共财产。List 属性将受到保护。这样 person.Pets.Add(new Pet()) 就不会发生并且你很安全。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T07:18:13.577

这不是 NHibernate 问题，而是域模型问题。NHibernate 不负责建立您的域的引用和反向引用。

我同意 gcores，将列表设为受保护或私有。找到一种方法以一致的方式将您的对象链接在一起。如果它不像实现 add 方法那么简单，请考虑单独的服务类或工厂。（如果它更复杂，试试 Spring.Net 之类的东西。）

顺便说一句，NHibernate 可能存储了宠物，但没有写入正确外键的信息。所以它存储了从未出现在任何人的宠物列表中的孤儿宠物。

# python - 如何在 Python 中分析内存使用情况？

> ID：552744
> 
> 赞同：304
> 
> 时间：2009-02-16T09:34:43.827
> 
> 标签：python, memory, profiling

我最近对算法产生了兴趣，并开始通过编写一个简单的实现然后以各种方式对其进行优化来探索它们。

我已经熟悉用于分析运行时的标准 Python 模块（对于大多数事情，我发现 IPython 中的 timeit 魔术函数就足够了），但我也对内存使用感兴趣，因此我也可以探索这些权衡（例如，缓存先前计算值的表与根据需要重新计算它们的成本）。是否有一个模块可以为我分析给定函数的内存使用情况？

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2009-02-16T10:00:24.780

这个已经在这里回答了：[Python memory profiler](https://stackoverflow.com/questions/110259/python-memory-profiler)

基本上你会做这样的事情（引自[Guppy-PE](http://guppy-pe.sourceforge.net/#Heapy)）：

```
>>> from guppy import hpy; h=hpy()
>>> h.heap()
Partition of a set of 48477 objects. Total size = 3265516 bytes.
 Index  Count   %     Size   % Cumulative  % Kind (class / dict of class)
     0  25773  53  1612820  49   1612820  49 str
     1  11699  24   483960  15   2096780  64 tuple
     2    174   0   241584   7   2338364  72 dict of module
     3   3478   7   222592   7   2560956  78 types.CodeType
     4   3296   7   184576   6   2745532  84 function
     5    401   1   175112   5   2920644  89 dict of class
     6    108   0    81888   3   3002532  92 dict (no owner)
     7    114   0    79632   2   3082164  94 dict of type
     8    117   0    51336   2   3133500  96 type
     9    667   1    24012   1   3157512  97 __builtin__.wrapper_descriptor
<76 more rows. Type e.g. '_.more' to view.>
>>> h.iso(1,[],{})
Partition of a set of 3 objects. Total size = 176 bytes.
 Index  Count   %     Size   % Cumulative  % Kind (class / dict of class)
     0      1  33      136  77       136  77 dict (no owner)
     1      1  33       28  16       164  93 list
     2      1  33       12   7       176 100 int
>>> x=[]
>>> h.iso(x).sp
 0: h.Root.i0_modules['__main__'].__dict__['x']
>>> 
```

* * *

## 回答 #2

> 赞同：141
> 
> 时间：2017-08-14T16:31:27.747

Python 3.4 包含一个新模块：[`tracemalloc`](https://docs.python.org/3/library/tracemalloc.html). 它提供了有关哪些代码分配了最多内存的详细统计信息。这是一个显示分配内存的前三行的示例。

```
from collections import Counter
import linecache
import os
import tracemalloc

def display_top(snapshot, key_type='lineno', limit=3):
    snapshot = snapshot.filter_traces((
        tracemalloc.Filter(False, "<frozen importlib._bootstrap>"),
        tracemalloc.Filter(False, "<unknown>"),
    ))
    top_stats = snapshot.statistics(key_type)

    print("Top %s lines" % limit)
    for index, stat in enumerate(top_stats[:limit], 1):
        frame = stat.traceback[0]
        # replace "/path/to/module/file.py" with "module/file.py"
        filename = os.sep.join(frame.filename.split(os.sep)[-2:])
        print("#%s: %s:%s: %.1f KiB"
              % (index, filename, frame.lineno, stat.size / 1024))
        line = linecache.getline(frame.filename, frame.lineno).strip()
        if line:
            print('    %s' % line)

    other = top_stats[limit:]
    if other:
        size = sum(stat.size for stat in other)
        print("%s other: %.1f KiB" % (len(other), size / 1024))
    total = sum(stat.size for stat in top_stats)
    print("Total allocated size: %.1f KiB" % (total / 1024))

tracemalloc.start()

counts = Counter()
fname = '/usr/share/dict/american-english'
with open(fname) as words:
    words = list(words)
    for word in words:
        prefix = word[:3]
        counts[prefix] += 1
print('Top prefixes:', counts.most_common(3))

snapshot = tracemalloc.take_snapshot()
display_top(snapshot) 
```

结果如下：

```
Top prefixes: [('con', 1220), ('dis', 1002), ('pro', 809)]
Top 3 lines
#1: scratches/memory_test.py:37: 6527.1 KiB
    words = list(words)
#2: scratches/memory_test.py:39: 247.7 KiB
    prefix = word[:3]
#3: scratches/memory_test.py:40: 193.0 KiB
    counts[prefix] += 1
4 other: 4.3 KiB
Total allocated size: 6972.1 KiB 
```

### 什么时候内存泄漏不是泄漏？

当内存在计算结束时仍被保留时，该示例非常好，但有时您的代码会分配大量内存然后将其全部释放。从技术上讲，这不是内存泄漏，但它使用的内存比您想象的要多。当所有内存都被释放时，如何跟踪内存使用情况？如果是您的代码，您可能可以添加一些调试代码以在其运行时拍摄快照。如果没有，您可以在主线程运行时启动一个后台线程来监控内存使用情况。

这是前面的示例，其中代码已全部移至`count_prefixes()`函数中。当该函数返回时，所有内存都被释放。我还添加了一些`sleep()`调用来模拟长时间运行的计算。

```
from collections import Counter
import linecache
import os
import tracemalloc
from time import sleep

def count_prefixes():
    sleep(2)  # Start up time.
    counts = Counter()
    fname = '/usr/share/dict/american-english'
    with open(fname) as words:
        words = list(words)
        for word in words:
            prefix = word[:3]
            counts[prefix] += 1
            sleep(0.0001)
    most_common = counts.most_common(3)
    sleep(3)  # Shut down time.
    return most_common

def main():
    tracemalloc.start()

    most_common = count_prefixes()
    print('Top prefixes:', most_common)

    snapshot = tracemalloc.take_snapshot()
    display_top(snapshot)

def display_top(snapshot, key_type='lineno', limit=3):
    snapshot = snapshot.filter_traces((
        tracemalloc.Filter(False, "<frozen importlib._bootstrap>"),
        tracemalloc.Filter(False, "<unknown>"),
    ))
    top_stats = snapshot.statistics(key_type)

    print("Top %s lines" % limit)
    for index, stat in enumerate(top_stats[:limit], 1):
        frame = stat.traceback[0]
        # replace "/path/to/module/file.py" with "module/file.py"
        filename = os.sep.join(frame.filename.split(os.sep)[-2:])
        print("#%s: %s:%s: %.1f KiB"
              % (index, filename, frame.lineno, stat.size / 1024))
        line = linecache.getline(frame.filename, frame.lineno).strip()
        if line:
            print('    %s' % line)

    other = top_stats[limit:]
    if other:
        size = sum(stat.size for stat in other)
        print("%s other: %.1f KiB" % (len(other), size / 1024))
    total = sum(stat.size for stat in top_stats)
    print("Total allocated size: %.1f KiB" % (total / 1024))

main() 
```

当我运行该版本时，内存使用量从 6MB 下降到 4KB，因为该函数在完成时释放了所有内存。

```
Top prefixes: [('con', 1220), ('dis', 1002), ('pro', 809)]
Top 3 lines
#1: collections/__init__.py:537: 0.7 KiB
    self.update(*args, **kwds)
#2: collections/__init__.py:555: 0.6 KiB
    return _heapq.nlargest(n, self.items(), key=_itemgetter(1))
#3: python3.6/heapq.py:569: 0.5 KiB
    result = [(key(elem), i, elem) for i, elem in zip(range(0, -n, -1), it)]
10 other: 2.2 KiB
Total allocated size: 4.0 KiB 
```

现在这是一个受[另一个答案](https://stackoverflow.com/a/10117657/4794)启发的版本，它启动了第二个线程来监视内存使用情况。

```
from collections import Counter
import linecache
import os
import tracemalloc
from datetime import datetime
from queue import Queue, Empty
from resource import getrusage, RUSAGE_SELF
from threading import Thread
from time import sleep

def memory_monitor(command_queue: Queue, poll_interval=1):
    tracemalloc.start()
    old_max = 0
    snapshot = None
    while True:
        try:
            command_queue.get(timeout=poll_interval)
            if snapshot is not None:
                print(datetime.now())
                display_top(snapshot)

            return
        except Empty:
            max_rss = getrusage(RUSAGE_SELF).ru_maxrss
            if max_rss > old_max:
                old_max = max_rss
                snapshot = tracemalloc.take_snapshot()
                print(datetime.now(), 'max RSS', max_rss)

def count_prefixes():
    sleep(2)  # Start up time.
    counts = Counter()
    fname = '/usr/share/dict/american-english'
    with open(fname) as words:
        words = list(words)
        for word in words:
            prefix = word[:3]
            counts[prefix] += 1
            sleep(0.0001)
    most_common = counts.most_common(3)
    sleep(3)  # Shut down time.
    return most_common

def main():
    queue = Queue()
    poll_interval = 0.1
    monitor_thread = Thread(target=memory_monitor, args=(queue, poll_interval))
    monitor_thread.start()
    try:
        most_common = count_prefixes()
        print('Top prefixes:', most_common)
    finally:
        queue.put('stop')
        monitor_thread.join()

def display_top(snapshot, key_type='lineno', limit=3):
    snapshot = snapshot.filter_traces((
        tracemalloc.Filter(False, "<frozen importlib._bootstrap>"),
        tracemalloc.Filter(False, "<unknown>"),
    ))
    top_stats = snapshot.statistics(key_type)

    print("Top %s lines" % limit)
    for index, stat in enumerate(top_stats[:limit], 1):
        frame = stat.traceback[0]
        # replace "/path/to/module/file.py" with "module/file.py"
        filename = os.sep.join(frame.filename.split(os.sep)[-2:])
        print("#%s: %s:%s: %.1f KiB"
              % (index, filename, frame.lineno, stat.size / 1024))
        line = linecache.getline(frame.filename, frame.lineno).strip()
        if line:
            print('    %s' % line)

    other = top_stats[limit:]
    if other:
        size = sum(stat.size for stat in other)
        print("%s other: %.1f KiB" % (len(other), size / 1024))
    total = sum(stat.size for stat in top_stats)
    print("Total allocated size: %.1f KiB" % (total / 1024))

main() 
```

该`resource`模块可让您检查当前内存使用情况，并保存峰值内存使用情况的快照。队列让主线程告诉内存监视器线程何时打印其报告并关闭。当它运行时，它会显示调用正在使用的内存`list()`：

```
2018-05-29 10:34:34.441334 max RSS 10188
2018-05-29 10:34:36.475707 max RSS 23588
2018-05-29 10:34:36.616524 max RSS 38104
2018-05-29 10:34:36.772978 max RSS 45924
2018-05-29 10:34:36.929688 max RSS 46824
2018-05-29 10:34:37.087554 max RSS 46852
Top prefixes: [('con', 1220), ('dis', 1002), ('pro', 809)]
2018-05-29 10:34:56.281262
Top 3 lines
#1: scratches/scratch.py:36: 6527.0 KiB
    words = list(words)
#2: scratches/scratch.py:38: 16.4 KiB
    prefix = word[:3]
#3: scratches/scratch.py:39: 10.1 KiB
    counts[prefix] += 1
19 other: 10.8 KiB
Total allocated size: 6564.3 KiB 
```

如果您使用的是 Linux，您可能会发现比该模块[`/proc/self/statm`](https://stackoverflow.com/a/53475728/4794)更有用。`resource`

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2015-11-10T14:13:21.160

如果您只想查看对象的内存使用情况，（[回答其他问题](https://stackoverflow.com/a/33631772/1587329)）

> 有一个名为[Pymler](https://pypi.python.org/pypi/Pympler)的模块，其中包含该`asizeof` 模块。
> 
> 使用如下：
> 
> ```
> from pympler import asizeof
> asizeof.asizeof(my_object) 
> ```
> 
> 与 不同`sys.getsizeof`的是，它**适用于您自己创建的对象**。
> 
> ```
> >>> asizeof.asizeof(tuple('bcd'))
> 200
> >>> asizeof.asizeof({'foo': 'bar', 'baz': 'bar'})
> 400
> >>> asizeof.asizeof({})
> 280
> >>> asizeof.asizeof({'foo':'bar'})
> 360
> >>> asizeof.asizeof('foo')
> 40
> >>> asizeof.asizeof(Bar())
> 352
> >>> asizeof.asizeof(Bar().__dict__)
> 280 
> ```

```
>>> help(asizeof.asizeof)
Help on function asizeof in module pympler.asizeof:

asizeof(*objs, **opts)
    Return the combined size in bytes of all objects passed as positional arguments. 
```

* * *

## 回答 #4

> 赞同：37
> 
> 时间：2013-03-16T11:19:27.570

**披露：**

*   仅适用于 Linux
*   报告当前进程整体使用的内存，而不是内部的单个*函数*

但很好，因为它很简单：

```
import resource
def using(point=""):
    usage=resource.getrusage(resource.RUSAGE_SELF)
    return '''%s: usertime=%s systime=%s mem=%s mb
           '''%(point,usage[0],usage[1],
                usage[2]/1024.0 ) 
```

`using("Label")`只需在您想查看发生了什么的地方插入即可。例如

```
print(using("before"))
wrk = ["wasting mem"] * 1000000
print(using("after"))

>>> before: usertime=2.117053 systime=1.703466 mem=53.97265625 mb
>>> after: usertime=2.12023 systime=1.70708 mem=60.8828125 mb 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2018-03-14T07:05:17.530

下面是一个简单的函数装饰器，它允许跟踪进程在函数调用之前、函数调用之后消耗了多少内存，以及有什么区别：

```
import time
import os
import psutil

def elapsed_since(start):
    return time.strftime("%H:%M:%S", time.gmtime(time.time() - start))

def get_process_memory():
    process = psutil.Process(os.getpid())
    mem_info = process.memory_info()
    return mem_info.rss

def profile(func):
    def wrapper(*args, **kwargs):
        mem_before = get_process_memory()
        start = time.time()
        result = func(*args, **kwargs)
        elapsed_time = elapsed_since(start)
        mem_after = get_process_memory()
        print("{}: memory before: {:,}, after: {:,}, consumed: {:,}; exec time: {}".format(
            func.__name__,
            mem_before, mem_after, mem_after - mem_before,
            elapsed_time))
        return result
    return wrapper 
```

[这是我的博客](http://ihorbobak.com/index.php/2018/02/22/python-process-memory-profiling/)，其中描述了所有细节。（[存档链接](http://web.archive.org/web/20180416235121/http://ihorbobak.com/index.php/2018/02/22/python-process-memory-profiling/)）

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2018-11-14T13:42:59.383

由于在我看来，已接受的答案和投票率第二高的答案存在一些问题，因此我想再提供一个答案，该答案与 Ihor B. 的答案密切相关，并进行了一些小而重要的修改。

此解决方案允许您通过使用函数包装函数调用并调用它，*或者**通过*使用装饰器装饰您的函数/方法来运行分析。`profile`*`@profile`*

 *第一种技术在您想要分析一些第三方代码而不弄乱其源代码时很有用，而第二种技术有点“干净”并且当您不介意修改函数/方法的源代码时效果更好想要简介。

我还修改了输出，以便您获得 RSS、VMS 和共享内存。我不太关心“之前”和“之后”的值，而只关心增量，所以我删除了那些（如果你要与 Ihor B. 的答案进行比较）。

# 分析代码

```
# profile.py
import time
import os
import psutil
import inspect

def elapsed_since(start):
    #return time.strftime("%H:%M:%S", time.gmtime(time.time() - start))
    elapsed = time.time() - start
    if elapsed < 1:
        return str(round(elapsed*1000,2)) + "ms"
    if elapsed < 60:
        return str(round(elapsed, 2)) + "s"
    if elapsed < 3600:
        return str(round(elapsed/60, 2)) + "min"
    else:
        return str(round(elapsed / 3600, 2)) + "hrs"

def get_process_memory():
    process = psutil.Process(os.getpid())
    mi = process.memory_info()
    return mi.rss, mi.vms, mi.shared

def format_bytes(bytes):
    if abs(bytes) < 1000:
        return str(bytes)+"B"
    elif abs(bytes) < 1e6:
        return str(round(bytes/1e3,2)) + "kB"
    elif abs(bytes) < 1e9:
        return str(round(bytes / 1e6, 2)) + "MB"
    else:
        return str(round(bytes / 1e9, 2)) + "GB"

def profile(func, *args, **kwargs):
    def wrapper(*args, **kwargs):
        rss_before, vms_before, shared_before = get_process_memory()
        start = time.time()
        result = func(*args, **kwargs)
        elapsed_time = elapsed_since(start)
        rss_after, vms_after, shared_after = get_process_memory()
        print("Profiling: {:>20}  RSS: {:>8} | VMS: {:>8} | SHR {"
              ":>8} | time: {:>8}"
            .format("<" + func.__name__ + ">",
                    format_bytes(rss_after - rss_before),
                    format_bytes(vms_after - vms_before),
                    format_bytes(shared_after - shared_before),
                    elapsed_time))
        return result
    if inspect.isfunction(func):
        return wrapper
    elif inspect.ismethod(func):
        return wrapper(*args,**kwargs) 
```

# 示例用法，假设上面的代码保存为`profile.py`：

```
from profile import profile
from time import sleep
from sklearn import datasets # Just an example of 3rd party function call

# Method 1
run_profiling = profile(datasets.load_digits)
data = run_profiling()

# Method 2
@profile
def my_function():
    # do some stuff
    a_list = []
    for i in range(1,100000):
        a_list.append(i)
    return a_list

res = my_function() 
```

这应该会产生类似于以下的输出：

```
Profiling:        <load_digits>  RSS:   5.07MB | VMS:   4.91MB | SHR  73.73kB | time:  89.99ms
Profiling:        <my_function>  RSS:   1.06MB | VMS:   1.35MB | SHR       0B | time:   8.43ms 
```

## 一些重要的最后说明：

1.  请记住，这种分析方法只是近似的，因为机器上可能会发生许多其他事情。由于垃圾收集和其他因素，增量甚至可能为零。
2.  由于某些未知原因，非常短的函数调用（例如 1 或 2 毫秒）显示为内存使用量为零。我怀疑这是硬件/操作系统（在带有 Linux 的基本笔记本电脑上测试）对内存统计信息更新频率的一些限制。
3.  为了使示例简单，我没有使用任何函数参数，但它们应该按预期工作，即 `profile(my_function, arg)`分析`my_function(arg)`

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2020-04-28T04:18:46.730

> 使用 memory_profile 计算代码块/函数的内存使用情况的简单示例，同时返回函数的结果：

```
import memory_profiler as mp

def fun(n):
    tmp = []
    for i in range(n):
        tmp.extend(list(range(i*i)))
    return "XXXXX" 
```

> 在运行代码之前计算内存使用量，然后计算代码期间的最大使用量：

```
start_mem = mp.memory_usage(max_usage=True)
res = mp.memory_usage(proc=(fun, [100]), max_usage=True, retval=True) 
print('start mem', start_mem)
print('max mem', res[0][0])
print('used mem', res[0][0]-start_mem)
print('fun output', res[1]) 
```

> 在运行函数时计算采样点的使用情况：

```
res = mp.memory_usage((fun, [100]), interval=.001, retval=True)
print('min mem', min(res[0]))
print('max mem', max(res[0]))
print('used mem', max(res[0])-min(res[0]))
print('fun output', res[1]) 
```

> 学分：@skeept

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2017-08-22T08:57:49.243

也许它有帮助：
<[查看更多](https://stackoverflow.com/a/5376616/1262058)>

```
pip install gprof2dot
sudo apt-get install graphviz

gprof2dot -f pstats profile_for_func1_001 | dot -Tpng -o profile.png

def profileit(name):
    """
    @profileit("profile_for_func1_001")
    """
    def inner(func):
        def wrapper(*args, **kwargs):
            prof = cProfile.Profile()
            retval = prof.runcall(func, *args, **kwargs)
            # Note use of name from outer scope
            prof.dump_stats(name)
            return retval
        return wrapper
    return inner

@profileit("profile_for_func1_001")
def func1(...) 
```

# c# - 使用 log4net 记录错误/异常

> ID：552749
> 
> 赞同：0
> 
> 时间：2009-02-16T09:35:52.093
> 
> 标签：c#, asp.net, log4net

我正在尝试通过 log4net 将所有异常记录到 sql server 数据库中，我在这里看到了一些解释如何正确配置 web.config 文件的帖子，但我的问题是：记录异常是否足够（应用程序将自动记录，但在这种情况下它不适用于我的应用程序），还是我必须将记录器从代码隐藏调用到 try/catch 语句？

任何建议将不胜感激！

非常感谢， 爱普罗斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T12:42:13.860

您可以在 global.asax 中使用 Application_Error。当发生 unhandler 错误时调用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-02T14:39:51.040

[This](https://stackoverflow.com/questions/1367967/log4net-log-all-application-errors/1368089#1368089) might help.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T09:41:27.320

没有什么可以自动捕获的，您需要连接未处理的异常来进行日志记录（就像您连接它以执行任何其他全局异常管理一样）。

# php - 如何使 .php 文件在 microsoft sharepoint 中工作？

> ID：552752
> 
> 赞同：2
> 
> 时间：2009-02-16T09:36:34.947
> 
> 标签：php, sharepoint

您好我刚刚上传了一些 .php 文件到我的共享点站点。但是当我转到这些页面时，它不是显示页面，而是显示实际的脚本。我该如何解决这个问题。先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T09:51:31.743

SharePoint 在 Microsoft IIS 和 ASP.NET 之上运行，不包含 PHP 引擎。PHP 文件在 SharePoint 眼中只是一个文本文件。您可以使用 PHP 引擎配置 IIS，但它与 SharePoint 无关。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T21:42:19.117

我不会在 SharePoint 中安装 PHP 引擎，因为 SharePoint 配置如此复杂，我喜欢将 SharePoint 保留给它自己。而是为其自己的网站安装，然后使用页面视图将其显示在 SharePoint 页面上。

# silverlight-2.0 - Silverlight 可以启动页面刷新吗？

> ID：552756
> 
> 赞同：19
> 
> 时间：2009-02-16T09:38:21.307
> 
> 标签：silverlight-2.0

更新：另一个标题可能是：如何从我的 silverlight 2.0 应用程序调用 javascript。

这是给所有 Silverlight 专家的一个快速问题。

我有一个显示秒表倒计时的 Silverlight 应用程序。该应用程序托管在 ASP.Net Web 应用程序中，我想要它做的是当秒表达到零时，该应用程序会强制刷新托管页面的服务器页面。

这可能吗？

如果是这样，代码片段的任何机会？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-06-18T08:08:18.500

为什么不干脆留在 Silverlight 一边打电话

```
System.Windows.Browser.HtmlPage.Document.Submit(); 
```

对我来说是一种享受。整个页面重新加载，Silverlight 控件重新启动。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-02-16T11:23:33.080

[显然](http://timheuer.com/blog/archive/2008/03/09/calling-javascript-functions-from-silverlight-2.aspx)您可以使用 Silverlight 调用 JS 脚本

```
HtmlPage.Window.CreateInstance 
```

或者

```
HtmlPage.Window.Invoke 
```

[刷新](http://www.quackit.com/javascript/javascript_refresh_page.cfm)页面的 JavaScript是

```
location.reload(true) 
```

不过，我不是 Silverlight 或 JavaScript 专家，所以不确定它是否适用于所有浏览器，甚至根本不适用。

**编辑：**

斯科特用他的最终解决方案对此答案发表了评论。

他需要在 ASP.Net 页面上创建一个名为 reload() 的 JavaScript 客户端函数，该函数执行 location.reload(true)。然后从他的 C# 代码中重新加载是一件简单的事情：

```
HtmlPage.Window.Invoke("reload"); 
```

正如@R4cOON 建议的那样，您还可以使用：

```
System.Windows.Browser.HtmlPage.Document.Submit(); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-02T21:30:08.093

Just a quick note on why `HtmlPage.Window.Invoke("location.reload(true);");` doesn't work: it appears from my quick testing that the way Silverlight implements Invoke is to look up a property with the given name on the specified JavaScript object and call it. So this code would say, "Find a property on the window object named 'location.reload(true);' and call it with zero arguments." There is, instead, a `GetProperty` method that will let you get the window's `location` property and invoke `reload` on that with the parameter `true`. The final code looks like this:

`((ScriptObject)HtmlPage.Window.GetProperty("location")).Invoke("reload", true);`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-11-03T00:04:40.300

在我的情况下，我不想做 asp.net 类型的回发并丢失我的 Silverlight 页面上下文，所以我通过导航到它来刷新我的页面。这样，我在导航栏中所做的语言更改就会反映在我的页面或视图中，因为它们来自 2008 模板。

this.ContentFrame.Navigate(new Uri("", UriKind.Relative));

In this case I was on my home page. "" means home page if you examine the Silverlight templated navigation solution.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-16T09:45:47.917

Silverlight 应用程序可能会调用页面上的 javascript，这反过来可能会强制您的页面刷新。所以是的，这绝对是可能的！

# nhibernate - 使用 NHibernate 映射 items-itemtags-tags 表

> ID：552758
> 
> 赞同：0
> 
> 时间：2009-02-16T09:39:11.147
> 
> 标签：nhibernate, hibernate, nhibernate-mapping

假设我有这个数据库设计：

```
Items
  Id
  Name
  Desc

ItemTags
  ItemId
  TagId

Tags
  Id
  Tag 
```

我想把它映射到下面的类

```
class Item
  int Id
  string Name
  string Desc
  IList<string> Tags 
```

请注意，我不想声明 Tag 类，我只想让 Item 类有一个表示标签的字符串列表。

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-16T09:45:55.377

你为什么不想要一个 Tag 类？它将是强类型的并且更容易实现......参考：

> IList<标签>标签；

重写 ToString() 以编写“Tag”属性，如果这样可以使它更好..

# http - 服务不可用 - IIS

> ID：552759
> 
> 赞同：1
> 
> 时间：2009-02-16T09:41:20.457
> 
> 标签：http, iis, logging

我的问题是有时网络服务器上的 CPU 使用率会达到 100%（由 W3wp.exe 引起）

届时网站将变为“服务不可用”

问：我在哪里可以从 IIS/HTTPERR 日志中查看网站变为“服务不可用”的位置？

我可以使用 Log Parser 来确定发生这种情况的时间吗？如果是，有什么疑问吗？

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T10:05:58.540

您可以为该进程创建一个用户转储文件，并使用调试诊断工具来分析发生了什么。该工具是**IIS 诊断工具包的一部分（**[在此处](http://www.iis.net/downloads/default.aspx?tabid=34&g=6&i=1286)下载和描述）。它位于文件夹中`C:\Program Files\IIS Resources\DebugDiag`。

这篇支持文章详细解释了如何做到这一点：

[如何使用调试诊断工具解决 IIS 中进程的高 CPU 使用率问题](http://support.microsoft.com/?scid=kb%3Ben-us%3B919791&x=7&y=17)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T10:44:48.057

不知道这是否值得深思，但这就是我们所做的：

当我们的页面渲染超过某个可接受的阈值时，我们将服务器标记为“忙碌”，并且所有未来的**新**会话都被拒绝“服务器忙碌” - 这让打开会话的人完成，减轻负载，并释放资源以创建新的要恢复的会话

为此，我们记录每分钟的平均任务持续时间，并检查过去五分钟的平均值是否超过阈值 - 然后设置忙碌标志。当 5 分钟移动平均线再次低于阈值时，该标志将在下一次重新计算（这是计划为一分钟间隔的任务）时清除。

# javascript - 从节点 XSLT 中删除所有 \n\r 字符？

> ID：552762
> 
> 赞同：3
> 
> 时间：2009-02-16T09:41:41.173
> 
> 标签：javascript, xml, xslt, xpath

想知道你能不能帮帮我？我在 xml 中有节点，如下所示

> $LOG: 08880xbpnd $
> fhdsafidsfsd
> df
> sd
> fsd
> f
> sd
> fsd

我想知道是否有让所有文本继续到一行，以便可以将其传递给 javascript 函数？所以结果会是这样

> $LOG: 08880xbpnd $fhdsafidsfsddfsdfsdfsdfsd

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-16T14:35:29.703

**不幸的是，该[`normalize-space()`](http://www.w3.org/TR/xpath#function-normalize-space)函数（在 andynormancx 的答案中使用）不仅仅是删除换行符**。

它删除所有前导和尾随空格，并**用单个空格字符替换任何内部连续空格组**。

在许多情况下，我们只想删除一种类型的空白字符（如在当前情况下——新行（CR+LF 在 XML 解析器读取时自动规范化为仅 LF）。

**正确且安全的方法是使用标准 XPath[`translate()`](http://www.w3.org/TR/xpath#function-translate)函数**：

```
translate(., '&#xA;', '') 
```

返回从删除任何换行符的当前节点的字符串值获得的字符串。

**这是一个例子**：

```
<xsl:stylesheet version="1.0" 
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

  <xsl:template match="node()|@*">
    <xsl:copy>
      <xsl:apply-templates select="node()|@*"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="text()">
    <xsl:value-of 
     select="translate(.,'&#xA;','')"/>
  </xsl:template>
</xsl:stylesheet> 
```

**在此源 XML 文档上应用上述转换时**：

```
<t>
$LOG: 08880xbpnd $
"embedded    blanks    must    stay"
df
sd
fsd
f
sd
fsd
</t> 
```

**根据需要，结果仅在一行上，并且所有嵌入的空格都保持不变**：

```
<t>$LOG: 08880xbpnd $"embedded    blanks    must    stay"dfsdfsdfsdfsd</t> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-16T09:46:09.773

[normalize-space()](http://msdn.microsoft.com/en-us/library/ms256063(VS.85).aspx) XPath 函数应该做你想做的事。

# c# - c#中的for和while循环

> ID：552766
> 
> 赞同：23
> 
> 时间：2009-02-16T09:44:32.790
> 
> 标签：c#, for-loop, while-loop

```
for (i=0 ; i<=10; i++)
{
    ..
    ..
}

i=0;
while(i<=10)
{
    ..
    ..
    i++;
} 
```

在 for 和 while 循环中，哪一个更好，性能明智？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-02-16T09:48:26.133

（更新）实际上-在一种情况下`for`构造效率更高；在数组上循环。*只要您* `arr.Length` *在条件中*使用，编译器/JIT 就会对此场景进行优化：

```
for(int i = 0 ; i < arr.Length ; i++) {
    Console.WriteLine(arr[i]); // skips bounds check
} 
```

在这种非常特殊的情况下，它会跳过边界检查，因为它已经知道它永远不会越界。有趣的是，如果您“提升”`arr.Length`以尝试手动优化它，您可以防止这种情况发生：

```
int len = arr.Length;
for(int i = 0 ; i < len ; i++) {
    Console.WriteLine(arr[i]); // performs bounds check
} 
```

但是，对于其他容器（`List<T>`等），提升作为手动微优化是相当合理的。

（结束更新）

* * *

两者都不; 无论如何，一个 for 循环在引擎盖下被评估为一个 while 循环。

例如，ECMA 334（明确分配）的 12.3.3.9 规定了一个 for 循环：

```
for ( for-initializer ; for-condition ; for-iterator ) embedded-statement 
```

本质上是等价的（从**定义赋值**的角度来看（与说“编译器必须生成这个 IL”不太一样））为：

```
{
    for-initializer ;
    while ( for-condition ) {
        embedded-statement ;
        LLoop:
        for-iterator ;
    }
} 
```

> 将针对 for 语句的 continue 语句转换为针对标签 LLoop 的 goto 语句。如果从 for 语句中省略了 for-condition，则对明确赋值的求值会继续进行，就好像在上述扩展中 for-condition 被替换为 true。

现在，这并不意味着编译器必须做完全相同的事情，但实际上它几乎可以......

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-16T09:49:28.080

我会说它们是相同的，无论如何你都不应该做这样的微优化。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-16T09:52:42.380

性能将是相同的。但是，除非您需要访问`i`循环外的变量，否则您应该使用`for`循环。这会更干净，因为`i`只会在块内有范围。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-18T18:41:40.700

程序效率来自适当的算法、良好的对象设计、智能程序架构等。

用 for 循环和 while 循环减少一两个循环永远不会使慢速程序变快，或使快速程序变慢。

如果您想在本节中提高程序性能，请找到一种方法来部分展开循环（请参阅[Duff 的设备](http://en.wikipedia.org/wiki/Duff%27s_device)），或者提高循环内完成的操作的性能。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-16T09:48:34.447

没有一个。它们是等价的。您可以认为“for”循环是编写 while 循环的更紧凑的方式。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-16T09:51:28.763

是的，它们是等效的代码片段。

# eclipse - Eclipse 3.4 包资源管理器问题

> ID：552779
> 
> 赞同：1
> 
> 时间：2009-02-16T09:47:28.117
> 
> 标签：eclipse, eclipse-3.4, package-explorer

是否可以这样做：假设我的包资源管理器中有很多项目。我想提出不同的看法。例如，我不经常使用的项目的视图，我的主要事物，常见事物。基本上我想清理我的包资源管理器，以便更好地了解我所有的东西。目前一切都在我的脑海中，所有项目都挤满了包资源管理器。有没有类似或推荐的方法来做到这一点。或者让我们说一下你如何在包资源管理器中组织你的东西。

谢谢。

库库

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-16T09:50:06.207

使用不同的**工作空间**。因此，您可以将一个工作区用于项目 1、2 和 5，将第二个工作区用于项目 3、4 和 6。

您可以通过**File --> Switch workspace --> Other**创建一个新的工作空间。然后您可以选择一个新文件夹并从当前工作区复制设置。

否则，您可以使用**Working Sets**。只是和他们一起玩。

祝你好运！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-16T10:06:32.330

这可以通过工作集来完成。

在 pacakge explorer 中，右上角有一个向下的三角形。单击它，然后在菜单中选择“顶级元素 -> 工作集”。

然后，您只需定义不同的工作集，并可以通过拖放将项目移入其中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-16T10:38:38.557

除了使用不同的**工作区**或**工作集**之外，还有**Mylyn**，它可以隐藏与当前任务无关的内容。

# namespaces - Squeak 是否支持命名空间？

> ID：552786
> 
> 赞同：6
> 
> 时间：2009-02-16T09:49:08.190
> 
> 标签：namespaces, smalltalk, squeak

因此，我正在考虑将 Smalltalk/Squeak 用于几个爱好/学术兴趣项目，并在尝试阅读该语言时遇到了这篇[不错的文章](http://www.chronos-st.org/Smalltalk-Getting-the-Message.html)。然而，这一段让我有点傻眼：

> “不幸的是，在 Smalltalk 中提供或处理模块/包完全缺乏标准化。一些方言为模块/包提供了非常强大、全面的支持（包括版本控制和编程团队的分布式访问），而其他方言提供很少或在这方面什么都没有。一些方言提供了多个可共享命名空间的健壮实现，而另一些则没有。唯一的共同点是，当提供模块/包或命名空间时，它们被实现为具体对象，方式与类和方法被实现为具体对象。”

所以，我尝试用谷歌搜索它，这显示在 Squeak wiki 上： [http](http://wiki.squeak.org/squeak/734) ://wiki.squeak.org/squeak/734 。有谁知道这（或类似的东西）现在是否是标准发行版的一部分？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-16T15:12:35.263

正如 Mue 所说，在 Squeak 社区中，这并不是一个大问题。前缀是“足够好”。前段时间我努力做的更好，仍然保持着 Smalltalk 的独特感觉：

[http://swiki.krampe.se/gohu/32](http://swiki.krampe.se/gohu/32)

...但即使很多人认为它很好，但它并没有流行起来。虽然代码或多或少有效，但还有其他几种方法 - 不幸的是，它们中的大多数只是从较小的语言中复制了一些愚蠢的方法，从而破坏了 Smalltalk 的感觉。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T11:54:23.180

命名空间今天不是 Squeak 的一部分。但普遍的约定是给自己项目的所有类加上两个或三个字母的前缀。这不像真正的命名空间那样节省，但它是轻量级、简单且有效的。**+微笑+**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-09-03T11:39:17.377

Google Summer of Code 支持名为[Environments](http://www.squeaksource.com/Environments.html)的命名空间项目。Chris Cunnington[目前正在调查](http://permalink.gmane.org/gmane.comp.lang.smalltalk.squeak.general/150899)它，但他说它看起来很有希望。

除了名称之外，没有必要相关，Squeak 4.5 使用 Colin Putney 的 Environments 包再次解决了这个问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T21:55:53.183

听起来你应该看看[Newspeak](http://newspeaklanguage.org/)。

# c# - Main 类中的“string[] args”是做什么用的？

> ID：552796
> 
> 赞同：62
> 
> 时间：2009-02-16T09:52:31.740
> 
> 标签：c#

在 C# 中，Main 类具有 string[] args 参数。

这是做什么用的？它在哪里使用？

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2009-02-16T10:01:15.137

来自[MSDN 上的 C# 编程指南](http://msdn.microsoft.com/en-us/library/cb20e19t.aspx)：

**Main 方法的参数是一个字符串数组，表示命令行参数**

所以，如果我有这样的程序（MyApp.exe）：

```
class Program
{
  static void Main(string[] args)
  {
    foreach (var arg in args)
    {
      Console.WriteLine(arg);
    }
  }
}
```

我从命令行开始是这样的：

```
MyApp.exe Arg1 Arg2 Arg3
```

Main 方法将传递一个包含三个字符串的数组：“Arg1”、“Arg2”、“Arg3”。

如果您需要传递包含空格的参数，请将其用引号括起来。例如：

```
MyApp.exe "Arg 1" "Arg 2" "Arg 3"
```

当您需要在运行时将信息传递给应用程序时，通常会使用命令行参数。例如，如果您正在编写一个将文件从一个位置复制到另一个位置的程序，您可能会将这两个位置作为命令行参数传递。例如：

```
Copy.exe C:\file1.txt C:\file2.txt
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-02-16T10:52:51.643

除了其他人的回答之外，您应该注意，如果您的应用程序不使用命令行参数，则参数在 C# 中是可选的。

此代码完全有效：

```
internal static Program
{
    private static void Main()
    {
        // Get on with it, without any arguments...
    }
} 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-16T09:53:33.047

用于传递命令行参数。例如`args[0]`会给你第一个命令行参数，如果有的话。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2017-08-18T08:46:08.670

除了其他答案。您应该注意到这些参数可以为您提供拖放到文件上的文件路径`.exe`。即，如果您将任何文件拖放到文件上，`.exe`则应用程序将启动，并且`arg[0]`将包含拖放到其上的文件路径。

```
static void Main(string[] args)
{
    Console.WriteLine(args[0]);
} 
```

这将打印放置在文件上的文件的路径`.exe`。例如

> C:\Users\ABCXYZ\source\repos\ConsoleTest\ConsoleTest\bin\Debug\ConsoleTest.pdb

因此，遍历`args`数组将为您提供所有被选择并拖放到`.exe`控制台应用程序文件中的文件的路径。看：

```
static void Main(string[] args)
{
    foreach (var arg in args)
    {
        Console.WriteLine(arg);
    }
    Console.ReadLine();
} 
```

上面的代码示例将打印所有拖放到上面的文件名，请参阅我正在将 5 个文件拖到我的`ConsoleTest.exe`应用程序上。

[![5 文件被放置在 ConsoleTest.exe 文件中。](https://i.stack.imgur.com/AyQar.png)](https://i.stack.imgur.com/AyQar.png) 这是我之后得到的输出： [![输出](https://i.stack.imgur.com/2Z4qo.png)](https://i.stack.imgur.com/2Z4qo.png)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-16T09:58:31.070

args 参数存储用户在运行程序时提供的所有命令行参数。

如果您像这样从控制台运行程序：

> program.exe有4个参数

您的 args 参数将包含四个字符串：“there”、“are”、“4”和“parameters”

以下是如何从 args 参数访问命令行参数的示例：[示例](http://www.c-sharpcorner.com/UploadFile/mahesh/CmdLineArgs03212006232449PM/CmdLineArgs.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-16T09:54:58.147

您一定见过一些从命令行运行并让您向它们传递参数的应用程序。如果您用 C# 编写一个这样的应用程序，则该数组将`args`用作上述参数的集合。

这是您处理它们的方式：

```
static void Main(string[] args) {
    foreach (string arg in args) {
       //Do something with each argument
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-16T09:57:04.770

这是传递给程序的命令行开关数组。例如，如果您使用命令“ `myapp.exe -c -d`”启动程序，`string[] args[]`则将包含字符串“-c”和“-d”。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-07-28T03:39:47.617

它是您发送给程序的参数/参数（因此是 args）的数组。例如`ping 172.16.0.1 -t -4`

这些参数作为字符串数组传递给程序。

`string[] args`// 包含参数的字符串数组。

# c# - C# 反射和泛型

> ID：552805
> 
> 赞同：0
> 
> 时间：2009-02-16T09:56:30.513
> 
> 标签：c#, generics, reflection

有一个复杂的反思问题。给定下面的代码，您将如何实现伪，以便给定 Parent 的实例，它将枚举类型 Properties 查找具有与 Parent 相同类型的 Property 的子对象，并将引用设置为提供的 p。希望这是有道理的。我也需要它来处理通用列表。请参阅下面的示例对象图。运行此之后，子 Pet 实例中的每个 Person 都将成为 Parent 实例。

```
 public class ChildSetter<Parent>
    {
        public void Set(Parent p)
        {

            //pseudo 
            //var parentName = p.GetType().Name;
            //foreach (var property in p.Properties)
            //{
            //   if (!property.IsList)
            //   {
            //      if (property.ContainsProperty(parentName))
            //          property.Properties[parentName] = p;
            //   }
            //   else
            //   {
            //      if (property.ListType.ContainsProperty(parentName))
            //      {
            //          foreach (var item in property)
            //          {
            //              item.Properties[parentName] = p;
            //          }
            //      }
            //   }
            //}
        }
    }

public class Person
{
    public Pet Pet { get; set; }
    public IList<Pet> Pets { get; set; }

}

public class Pet
{
    public Person Person { get; set; }
} 
```

此代码的非通用示例如下：

```
 public void Set(Person p)
    {
        p.Pet.Person = p;
        foreach (var pet in p.Pets)
        {
            pet.Person = p;
        }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T10:15:02.903

我还没有测试过，但是怎么样：

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.Reflection;

static class Program
{
    static void Main()
    {
        ...
    }
    public static void SetParent<T>(T root)
    {
        foreach (PropertyInfo prop in typeof(T).GetProperties
            (BindingFlags.Public | BindingFlags.Instance))
        {
            if (!prop.CanRead) continue;

            Type listType = null;
            foreach (Type interfaceType in prop.PropertyType.GetInterfaces())
            {
                if (interfaceType.IsGenericType &&
                    interfaceType.GetGenericTypeDefinition() == typeof(IList<>))
                { // IList<T> detected
                    listType = interfaceType.GetGenericArguments()[0];
                }
            }

            List<PropertyInfo> propsToSet = new List<PropertyInfo>();
            foreach (PropertyInfo childProp in (listType ?? prop.PropertyType).GetProperties(
                BindingFlags.Public | BindingFlags.Instance))
            {
                if (childProp.PropertyType == typeof(T)) propsToSet.Add(childProp);
            }

            if(propsToSet.Count == 0) continue; // nothing to do
            if (listType == null)
            {
                object child = prop.GetValue(root, null);
                if (child == null) continue;
                foreach (PropertyInfo childProp in propsToSet)
                {
                    childProp.SetValue(child, root, null);
                }
            }
            else
            {
                IList list = (IList)prop.GetValue(root, null);
                foreach (object child in list)
                {
                    if (child == null) continue;
                    foreach (PropertyInfo childProp in propsToSet)
                    {
                        childProp.SetValue(child, root, null);
                    }
                }
            }
        }
    }
} 
```

# php - Mysql Real Escape String 和普通字符串

> ID：552818
> 
> 赞同：0
> 
> 时间：2009-02-16T10:03:28.280
> 
> 标签：php, flash, actionscript-3, variables

**“我正在使用 flash as3、php 和 mysql”**

有什么区别：

```
$username =      $_POST['username'];
$password = md5( $_POST['password']); 
```

和

```
$username = mysql_real_escape_string(     $_POST['username']);
$password = mysql_real_escape_string(md5( $_POST['password'])); 
```

我正在从 Flash AS3 向 php 发送和检索变量，然后再次返回到 AS3。前一个（没有 mysql_real_escape_string）工作正常。但后者在闪存中出现错误。错误消息是：“参数文本必须为非空。”

我试过“echo”（显示）这两个结果，结果是一样的。很奇怪..有人知道吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T23:32:04.187

请记住 mysql_real_escape_string() 需要一个打开的数据库连接才能正常工作；如果你在使用 mysql_connect 之前调用它，它不会有预期的效果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T10:11:09.213

`mysql_real_escape_string`如果您想在查询中使用字符串，然后由`mysql_query`函数执行，您只需要。此外，如果您无法确保此字符串不包含某些可能违反您预期查询完整性的字符，则您只需要此功能。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T10:45:10.333

为了更清楚其他答案的正确状态：

如果您想将此变量传递给闪存，我可能可以使用您的第一个版本。如果你想在数据库查询中使用这个变量，那么使用你的第一个版本是不行的。

意义：

**好的**

```
<param name="FlashVars" 
value="vGetData=./your/path/yourData.php?params=<?php echo $username; ?>" /> 
```

**不好**

```
$query = "SELECT something FROM users WHERE username=".$username; 
```

我假设您首先授权用户，然后将数据发送到闪存。如果是这样，似乎没有问题。对？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-16T11:34:26.020

错误消息可以帮助您。阅读它们。

> *错误消息是：“参数文本必须为非空。”*

这似乎表明您的用户名或密码字符串为空（空），`mysql_real_escape_string`或者（更有可能）您的`md5`函数拒绝接受空字符串作为输入。首先测试一个空字符串，你应该没问题。

此外，MD5 哈希仅包含字母数字字符，所有这些字符几乎可以在任何地方安全使用。您不需要传递它们，`mysql_real_escape_string`因为散列过程已经清理了输入。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-16T10:16:25.130

第一个表单将完全按照您的想法进行：将提交的值和 MD5 放入您的变量中。

第二种形式也将转义任何“危险”字符（如果有的话）。尝试使用包含引号的用户名，您将得到它。

# c++ - 为什么这段代码在 Windows 7 Beta 上会丢失句柄？

> ID：552822
> 
> 赞同：4
> 
> 时间：2009-02-16T10:05:17.857
> 
> 标签：c++, windows, multithreading, memory-leaks

我正在寻找旧的 c++ 应用程序中的一些随机崩溃。使用 sysinternals 进程资源管理器，我注意到应用程序丢失了句柄，并提取了确切的情况，程序丢失句柄到一段非常短的代码。

```
DWORD WINAPI MyTestThread( void*  PThread)
{
 _endthreadex(0);
 return 0;
}

int WINAPI WinMain( HINSTANCE, HINSTANCE, LPSTR  PParameter, int)
{
 for (int i=0;i<10000;i++)
 {
   unsigned int threadID;
   HANDLE hThread= (HANDLE)_beginthreadex( (void*)NULL, (unsigned int)32768, (unsigned int (__stdcall *)(void *))MyTestThread, (void*)NULL, (unsigned int)0, &threadID);
   WaitForSingleObject((HANDLE)hThread, 1000);
   CloseHandle((HANDLE)hThread);
 }
 return 0;
} 
```

我的问题：我无法弄清楚这段代码有什么问题。它在每次迭代中恰好丢失 5 个句柄，但对我来说看起来还可以。
有趣的是：它似乎不会在 windows vista 上丢失句柄，但如果这应该是 windows 7 中的一个错误，我会感到非常惊讶。

[更新] 我尝试改用 _beginthread/_endthread 和 CreateThread/ExitThread，这两个也失去了 5 个句柄，就像 _beginthreadex 一样。

[第二次更新] 代码确实按预期运行。所有返回值都很好。就像没有明天一样，它“只是”失去了句柄。

[第 3 次更新]**大**的新信息 如果使用 /clr 编译，代码只会丢失句柄！而且，如果我在每次迭代中调用 GC::Collect() 句柄将被回收！
那么，我如何找到那里正在收集哪些 clr-objects？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T15:22:18.203

检查链接到您的 exe 的某些 DLL 是否在其 DLLMain 中为响应 DLL_THREAD_ATTACH 通知而做一些奇怪的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T11:20:04.883

您是否检查过功能是否成功？返回值并`GetLastError()`可以给出一些提示出了什么问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T12:39:10.107

来自[http://msdn.microsoft.com/en-us/library/kdzttdcb.aspx](http://msdn.microsoft.com/en-us/library/kdzttdcb.aspx)

“如果成功，这些函数中的每一个都会返回新创建的线程的句柄；但是，如果新创建的线程退出太快，_beginthread 可能不会返回有效的句柄（参见备注部分中的讨论）。_beginthread 返回 -1L on错误，在这种情况下，如果线程过多，errno 设置为 EAGAIN，如果参数无效或堆栈大小不正确，则设置为 EINVAL，或者在资源（例如内存）不足的情况下设置为 EACCES。_beginthreadex 返回 0出现错误时，设置 errno 和 _doserrno。"

你的线程确实退出有点快，不是吗。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T10:57:17.527

你试过用 Win32 的 CreateThread 测试这个吗？这可能会将问题缩小到 CRT。

# c# - FileStream.Write() 抛出 OutOfMemoryException 的可能原因？

> ID：552828
> 
> 赞同：3
> 
> 时间：2009-02-16T10:08:11.297
> 
> 标签：c#, .net, garbage-collection, filestream, out-of-memory

我有 10 个线程将数千个小缓冲区（每个 16-30 字节）写入随机位置的大文件。一些线程在 FileStream.Write() 操作上抛出 OutOfMemoryException。

是什么导致 OutOfMemoryException ？要找什么？

我正在使用这样的 FileStream（对于每个书面项目 - 此代码从 10 个不同的线程运行）：

```
using (FileStream fs = new FileStream(path, FileMode.OpenOrCreate, FileAccess.Write, FileShare.ReadWrite, BigBufferSizeInBytes, FileOptions.SequentialScan))
{
 ...
 fs.Write();
} 
```

我怀疑在 FileStream 中分配的所有缓冲区都没有被 GC 及时释放。我不明白的是，为什么 CLR 不只是运行 GC 循环并释放所有未使用的缓冲区，而不是抛出？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T11:30:28.510

如果您的代码显示有 10 个线程正在打开文件，那么您在任何时候最多有 10 个未处理的 FileStream 对象。是的，FileStream**确实**有一个内部缓冲区，您在代码中使用“BigBufferSizeInBytes”指定其大小。你能透露一下确切的价值吗？如果这足够大（例如~100MB），那么它很可能是问题的根源。

默认情况下（即，当您在构造时未指定数字时），此缓冲区为 4kB，这对于大多数应用程序来说通常都很好。一般来说，如果您真的关心磁盘写入性能，那么您可能会将这个增加到 100kB，但不会更多。

但是，对于您的特定应用程序，这样做没有多大意义，因为在 Dispose() FileStream 对象之前，所述缓冲区永远不会包含超过您写入其中的 16-30 个字节。

为了回答您的问题，只有在GC 运行**后**无法分配请求的内存时才会引发 OutOfMemoryException 。同样，如果缓冲区真的很大，那么系统可能会剩下大量内存，而不是一个**连续的**块。这是因为大对象堆永远不会被压缩。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T08:26:29.500

我已经提醒过人们几次了，但是[大对象堆](http://www.simple-talk.com/dotnet/.net-framework/the-dangers-of-the-large-object-heap/)可以相当巧妙地抛出该异常，当您似乎有足够的可用内存或应用程序运行正常时。

当我几乎完全按照您在此处描述的内容时，我经常遇到这个问题。

您需要发布更多代码才能正确回答此问题。但是，我猜它也可能与潜在的万圣节问题[（Spooky Dooky）](http://blogs.msdn.com/mikechampion/archive/2006/07/20/672208.aspx)有关。

您正在读取的缓冲区也可能是问题（再次与大对象堆相关），您需要提供更多关于循环中发生的事情的详细信息。我刚刚确定了最后一个几乎相同的错误（我正在执行许多并行哈希更新，这些更新都需要在读取输入文件时保持独立状态）......

哎呀！刚刚滚动并注意到“BigBufferSizeInBytes”，我再次倾向于大对象堆......

如果我是你，（由于缺乏上下文，这非常困难），我会提供一个小的调度“mbuf”，你可以在其中复制进出，而不是让所有分散的线程单独读取你的大背景数组...（即很难不使用非常微妙的代码语法导致不恰当的分配）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-24T08:42:16.270

我正在经历类似的事情，想知道您是否曾经确定过问题的根源？

我的代码在文件之间进行了很多复制，在不同的字节文件之间传递了很多兆。我注意到虽然进程内存使用率保持在合理范围内，但系统内存分配在复制过程中飙升得太高 - 比我的进程使用的要多得多。

我已将问题追溯到 FileStream.Write() 调用 - 当这条线被取出时，内存使用似乎按预期进行。我的 BigBufferSizeInBytes 是默认值（4k），我看不到这些可以收集的任何地方......

您在查看问题时发现的任何内容都将不胜感激！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T10:23:48.247

缓冲区通常不在 FileStream 中分配。也许问题在于“编写数千个小缓冲区”这一行 - 你真的是那个意思吗？通常，您会多次重复使用缓冲区（即在不同的读取/写入调用中）。

另外 - 这是一个文件吗？单个 FileStream 不能保证是线程安全的......所以如果你不做同步，期待混乱。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-16T10:27:21.517

这些限制可能来自底层操作系统，而 .NET Framework 无力克服这些限制。

我无法从您的代码示例中推断出您是同时打开很多这些 FileStream 对象，还是按顺序快速打开它们。您使用 'using' 关键字将确保文件在 fs.Write() 调用后关闭。关闭文件不需要 GC 周期。

FileStream 类确实适用于对文件的顺序读/写访问。如果您需要快速写入大文件中的随机位置，您可能想看看使用虚拟文件映射。

更新：似乎 .NET 直到 4.0 才正式支持虚拟文件映射。您可能想查看此功能的第三方实现。

戴夫

# c# - 从 Lucene 查询中获取查询词以突出显示

> ID：552829
> 
> 赞同：4
> 
> 时间：2009-02-16T10:08:22.357
> 
> 标签：c#, lucene.net, highlighting, full-text-search

我的 Lucene 查询通常包含一堆 AND 组合字段。是否可以再次从 Query 对象中获取查询的字段？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T15:29:10.563

您的意思是提取术语或字段名称吗？由于您已经知道您正在处理 BooleanQuery，因此要提取字段，您可以简单地迭代 BooleanQuery.getClauses() 返回的 BooleanClause 数组，将每个子句重写为其基本查询 (Query.rewrite) 并递归应用，直到您有一个 TermQuery在你的手上。

如果您确实是指术语提取，我不确定 Lucene.NET，但在 Java Lucene 中，您可以使用 org.apache.lucene.search.highlight.QueryTermExtractor; 你将一个（重写的）查询传递给它的一个 getTerms 重载并获得一个 WeightedTerms 数组。

据我记得，使用这种技术的缺点是：

*   由于它在内部使用了一个术语集，因此它不会处理同一标记的多个实例，例如“梦中之梦”
*   它仅支持基本查询类型（TermQuery、BooleanQuery 和任何其他支持 Query.extractTerms 的查询类型）。我相信我们已经在内部将它用于 SpanNearQuery 和 SpanNearOrderedQuery 实例，但我可能错了。

无论哪种方式，我希望这足以让你开始。

# c# - 如何控制 WebService 的构建

> ID：552830
> 
> 赞同：0
> 
> 时间：2009-02-16T10:08:23.557
> 
> 标签：c#, .net, asp.net

我想控制 ASP.NET 中 WebService 实例的构造。

这就是我到目前为止所做的：我创建了一个 .ASMX 文件并将其指向一个类，该类像往常一样附加了 WebServiceBinding 和 WebMethod 属性。当我浏览到 .ASMX 文件时，ASP.NET 会自动为我创建一个 Class 的实例。

是否有可能以某种方式劫持 ASP.NET 的对象工厂并自己创建实例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T10:31:27.107

您可以编写自定义处理程序 (.ashx) 并以这种方式手动执行。

[http://msdn.microsoft.com/en-us/library/ms227675(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms227675(VS.85).aspx)

# git - 致命文件系统错误后如何恢复 Git？

> ID：552832
> 
> 赞同：3
> 
> 时间：2009-02-16T10:09:41.247
> 
> 标签：git, backup, restore

在主服务器上出现文件系统错误后，恢复 git 存储库的最快路径是什么？

想象一下，你的 OSS 项目的中心服务器出现故障，恢复后两天的所有提交都丢失了。你怎么把那些拿回来？仅在所有客户端上调用“git push”就足够了吗？或者还有什么我必须考虑的吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-16T10:36:16.627

每个存储库也是“主存储库”（仅按照约定是“主存储库”）的备份，因此`git push`来自最近执行`git fetch`或`git pull`应该是所有存储库的存储库 - 当然，直到它的状态。您只需要处理钩子等，但是如果您说只有最后两天的提交丢失了，那么这些提交可能无论如何都不会受到伤害。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T10:40:57.163

A`git pull`然后 a`git push`应该足够了。

或者，`git push -f`将强制使用您的本地副本更新服务器，但这可能会给其他人带来问题（如果有多个提交者）。

如果您遇到任何进一步的问题或错误，请告诉我们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T16:33:28.110

我认为在服务器上创建一个新的 repo 可能会更好：

```
% ssh user@server
% mv /path/to/repo /path/to/repo.old
% mkdir /path/to/repo
% cd /path/to/repo
% git init --bare 
```

然后从您拥有的所有不同克隆中推送。我的想法是，这将避免旧存储库中可能存在任何损坏的文件，并且根本不应该有任何损失，前提是您都在自己的克隆上工作，并且没有人在服务器存储库中乱搞。

# xml - 从符合特定架构的 SQL Server 数据创建 XML

> ID：552835
> 
> 赞同：0
> 
> 时间：2009-02-16T10:10:17.203
> 
> 标签：xml, sql-server-2005, xsd

我有一个 SQL Server 2005 表中的数据，我需要使用接收 XML 片段的 SOAP Web 服务将其插入到应用程序中。我正在为此寻找不同的选项，我想知道是否有可能让 SQL Server 向我返回符合特定模式的 XML。如果可能，我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-16T10:31:03.223

自从我这样做以来已经有一段时间了，但是在[FOR XML](http://msdn.microsoft.com/en-us/library/ms345137(SQL.90).aspx)上存在一个显式选项，并且自动通常可以通过适当的别名来完成任务，但是为了最大限度地抽象，我相信当我上次这样做时，我们使用了**XSLT 转换来塑造SQL 将 XML 输出**到所需的输出模式，这是我将再次采用基准测试的方法。XSLT 正是为此类任务而设计的，并且更容易更改生产数据库。

2k5 的部分 USP 是它改进了 XML 处理，您应该找到[许多](http://www.programmersheaven.com/2/SQL-server-2005-school-lesson-5)可用于任何给定任务的选项。

# visual-studio - Tortoise SubWCRev.exe 预构建事件

> ID：552838
> 
> 赞同：10
> 
> 时间：2009-02-16T10:11:17.857
> 
> 标签：visual-studio, command-line, ide, visual-studio-2005, dos

我在 Visual Studio 2005 中将以下命令作为预构建事件运行，它运行良好：

```
SubWCRev.exe "C:\work\subversion\aviOffline .Net\trunk" 
"c:\test.tmpl" 
"c:\testout.txt"C:\work\subversion\aviOffline .Net\trunk" 
```

因此，我将命令更改为使用内置的 Visual Studio 宏以获得更好的可维护性，但它失败了。它似乎在 $(SolutionDir) 宏上失败，因为它附加了一个尾随反斜杠，而 SubWCRev.exe 似乎不喜欢尾随反斜杠？

```
"SubWCRev.exe" "$(SolutionDir)" "c:\test.tmpl" "c:\testout.txt" 
```

是否有 dos 命令或其他方法可以删除尾随反斜杠？

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-16T10:29:09.297

我会尝试放一个尾随点：

```
"$(SolutionDir)." 
```

# coldfusion - “双重检查锁定”在 ColdFusion 中有效吗？

> ID：552839
> 
> 赞同：0
> 
> 时间：2009-02-16T10:12:25.500
> 
> 标签：coldfusion, locking, double-checked-locking

我在我的 CF 应用程序中使用了双重检查锁定版本（在我知道双重检查锁定是什么之前）。

本质上，我检查对象的存在。如果它不存在，我会锁定（通常使用命名锁）并在尝试创建对象之前再次检查是否存在。我认为这是一种停止创建多个对象并停止在系统中过度锁定的巧妙方法。

这似乎可行，因为没有过多的锁定并且不会创建对象重复项。但是，我最近了解到[Double Checked Locking 在 Java 中不起作用](http://www.cs.umd.edu/~pugh/java/memoryModel/DoubleCheckedLocking.html)，我不知道这在 CF 中是否成立，因为 CF 线程和锁与本机 Java 线程和锁并不完全相同。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-16T22:16:50.563

补充一下 Ben Doom 关于 Java 的说法，这是 ColdFusion 中相当标准的做法，特别是在设置应用程序变量的应用程序初始化例程中。

在没有至少一个锁的情况下，您会让对您的 Web 应用程序的初始点击都同时初始化应用程序变量。这假设您的应用程序足够忙以保证这一点。仅当您的应用程序在您的应用程序首次启动时很忙时，才会存在危险。

第一个锁确保一次只有一个请求初始化您的变量。

第二个锁，嵌入在第一个中，将检查以确保在初始化代码末尾定义的变量存在，例如 application.started。如果存在，则将用户踢出。

双锁定模式在繁忙的站点上拯救了我的皮肤，但是，对于非常繁忙的站点，完成应用程序初始命中的请求队列可能会爬得太高、太快，并导致服务器崩溃。这个想法是，请求正在等待第一个命中，这很慢，然后第二个闯入第一个 cflock，并很快被拒绝。队列中有成百上千的请求，每毫秒都在增长，它们都汇集到第一个 cflock 块。解决方案是在第一个 cflock 上设置一个非常低的超时，而不是抛出（或捕获和躲避）锁定超时错误。

最后一点，我描述的这种行为已被您的 Application.cfc 的 ColdFusion 7 的 onApplicationStart() 方法弃用。如果您正在使用 onApplicationStart()，那么您根本不应该为您的应用程序初始化例程锁定。Application.cfc 已经很好地锁定了。

总而言之，是的，双重检查锁定在 ColdFusion 中有效。在某些特定情况下它会有所帮助，但要正确操作。我不知道它为什么与 Java 的线程模型相反的原理图，很可能它是在您的 ColdFusion 服务器的后台手动检查某种查找表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T14:10:44.397

Java 是线程安全的，所以并不是说你的锁不起作用，而是它们不是必需的。基本上，在 CF 6+ 中，需要锁来防止竞争条件或创建/更改存在于 Java 控制之外的对象（例如文件）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T14:36:21.557

打开另一罐蠕虫...

为什么不使用依赖注入库（例如 ColdSpring）来跟踪您的对象并防止循环依赖。

# c# - 向 MS 语言团队建议语言增强功能的最佳地点在哪里？

> ID：552844
> 
> 赞同：3
> 
> 时间：2009-02-16T10:15:29.423
> 
> 标签：c#, vb.net, forum, language-enhancement

和标题说的差不多。。

我想知道建议语言增强的地方在哪里。

VB 和 C# 语言团队闲逛的地方？

这些语言的未来的中心思想库？

类似的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-16T10:20:46.023

[Microsoft Connect Visual Studio 区域](http://connect.microsoft.com/VisualStudio)可能是您最好的选择。它是所有 Visual Studio、.NET 和语言的错误/建议存储库。

# symfony1 - 如何在 Symfony 中创建动态菜单

> ID：552846
> 
> 赞同：3
> 
> 时间：2009-02-16T10:16:30.387
> 
> 标签：symfony1, menu

虽然我确实发现 PHP Symfony 框架在很多方面都很棒，但我发现很难为网站创建易于扩展的动态菜单。

我想知道其他 Symfony 开发人员是如何处理这个问题的。我将举一个简单的例子来说明我在问什么。

如果去 www.fool.com 你会看到他们有一个典型的菜单设置。一个类别列表，其中一个是活动的类别，以某种方式用 CSS 突出显示。

什么是在 Symfony 项目中动态创建它的好方法。在模块之间传递某种类型的变量。我还没有找到一个优雅的解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-20T03:34:26.153

通常，我只是手动构建一组我希望出现在菜单中的模块/操作组合。从动态源（如配置文件或数据库）获取此信息相当容易：

```
$this->menu = array(
    'Home' => array('default', 'index'),
    'About Us' => array('default', 'aboutUs'),
    'Products' => array('products', 'index')
); 
```

然后，我使用控制器的 getActionName 和 getMethodName 方法来确定我的菜单中的哪一项是当前项：

```
$this->current = array_search(array($this->getModuleName(), $this->getActionName()), $this->menu); 
```

然后我可以从模板中迭代 $menu 来构建菜单。我可以将这些项目与 $current 进行比较，以确定是否应该在菜单项的 <li> 上设置“当前”类。

你给出的傻瓜网例子有点复杂，因为它有两个层次。在这种情况下，您可能希望从数据库中生成菜单树，可能利用 Propel 的嵌套集支持。

# c++ - 如何将 BGL 有向图用作无向图（用于布局算法）？

> ID：552854
> 
> 赞同：3
> 
> 时间：2009-02-16T10:22:40.577
> 
> 标签：c++, boost, boost-graph

我正在使用 Boost.Graph 处理有向图（实际上是双向图）。我想使用现有的布局算法（Kamada-Kawai 或 Fruchterman-Reingold），但它们只接受无向图作为参数。

使用这些布局算法的最简单方法是什么？更一般地说，诱使算法认为有向图实际上是无向的正确方法是什么？

谢谢，贝努瓦

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T14:40:27.867

您确定 Fruchterman-Reingold 算法只接受无向图吗？我尝试使用双向图而不是无向图来运行[Boost 文档](http://www.boost.org/doc/libs/1_38_0/libs/graph/doc/fruchterman_reingold.html)中的小示例，它编译并运行得很好。

* * *

为了回答您的问题，我不确定 BGL 中是否有任何工具可以将有向图转换为无向图。我找到的唯一解决方案是创建一个新图形并添加原始图形的所有边：

```
typedef adjacency_list<vecS, vecS, bidirectionalS> BidirectionalGraph;
typedef adjacency_list<setS, vecS, bidirectionalS> UndirectedGraph;
// UndirectedGraph uses a set to avoid parallel edges

BidirectionalGraph bdg;
// use bdg

// create an undirected graph with the edges of the first one
typedef graph_traits<BidirectionalGraph>::vertex_iterator vi_beg, vi_end;
tie(vbeg, vend) = vertices(bdg);

UndirectedGraph ug(std::distance(vbeg, vend));

typedef graph_traits<BidirectionalGraph>::edge_iterator ei, ei_end;

for (tie(ei, ei_end) = edges(bdg) ; ei != ei_end ; ++ei)
{
    add_edge(source(*ei,bdg), target(*ei,bdg), ug);
} 
```

但是，我想这个解决方案在处理巨大的图表时可能会引发一些性能问题。可能有更好的方法来实现你的目标，但我不是 BGL 专家，所以我只能给你:-)！

* * *

正如 Benoît 在评论中指出的那样，BGL 提供了一个`copy_graph`将图的所有顶点和边复制到另一个的函数。因此，上面的代码可以归结为：

```
#include <boost/graph/copy.hpp>

Bidirectional bdg;
// use bdg

// create an undirected graph with the vertices and edges of the first one
UndirectedGraph g;
copy_graph(bdg, g); 
```

# c# - 如果它们已经是私有变量，我应该将它们标记为私有变量吗？

> ID：552857
> 
> 赞同：4
> 
> 时间：2009-02-16T10:24:28.870
> 
> 标签：c#, .net, default, declaration

据我所知，在 C# 中，所有字段默认都是私有的，如果没有另外标记的话。

```
class Foo
{
  private string bar;
}

class Foo
{
  string bar;
} 
```

我猜这两个声明是相等的。

所以我的问题是：我应该将私有变量标记为什么，就`private`好像它们已经是私有的一样？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-16T10:32:10.677

现在; 无论如何，字段几乎总是应该是私有的，所以你是否应该打扰是一个边缘情况。

对于更广泛的主题，我记得 Eric Lippert 的评论 - 基本上是说给定一个方法/类/任何东西：

```
void Foo() {}
class Bar {} 
```

然后不清楚它们是否是故意的私有/内部，或者开发人员是否考虑过，并*决定*它们应该是私有/内部/什么的。所以他的建议是：告诉读者你是故意而不是偶然做事——让它明确。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-16T10:33:21.080

关于这件事，我已经有一段时间了。我曾经主张让它隐含，但现在我认为我倾向于让它变得明确。

**隐含的原因：**

*   这意味着非私人成员（或任何比默认访问权限更多的成员）有更大的差异；这突出了阅读代码时的区别

**明确说明的原因：**

*   一些开发人员可能不知道默认值：明确表示*每个人都清楚*
*   它表明您已经主动做出了决定，而不是仅仅将其保留为默认值

后面这几点[基本上是 Eric Lippert](http://csharpindepth.com/ViewNote.aspx?NoteID=54)在我们前段时间讨论时提出的。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-16T10:29:31.417

是的，它们是平等的，但我喜欢将私有变量标记为**私有**，我认为它可以提高阅读能力。

我也对私人成员使用这种通用符号，它非常有用：

```
private string _bar; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-16T10:29:12.057

这纯粹是一个编码标准问题，但是，为了它的价值，我总是明确地将私有成员标记为私有。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-16T10:48:04.197

如果您定期在 Java 和 C# 之间切换，我想明确指定访问修饰符将非常重要。例如在 Java 中

```
void myMethod()
{

} 
```

包中的任何类都可以访问该方法。在 C# 中，它显然是类和内部类私有的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-16T10:52:57.507

不要让人猜测，不要让他们做出错误的假设，也不要认为更少的字符以任何方式等同于清晰。

没有充分的理由*不*明确说明这一点，恕我直言，C# 支持它是一个错误（特别是如果他们愿意做他们所做的事情来切换语句）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-16T11:57:36.540

在某些极端情况下，显式使用 private 可以提高可读性。

例子：

```
 /*
        Tomorrow when we wake up from bed,
        first me and Daddy and Mommy, you, eat
        breakfast eat breakfast like we usually do,
        and then we're going to play and
        then soon as Daddy comes, Carl's going
        to come over, and then we're going to
        play a little while. And then Carl and
        Emily are both going down to the car
        with somebody, and we're going to ride
        to nursery school [whispered], and then
        when we get there, we're all going
        to get out of the car...
        */

        int spam;

        /*
        Does this style look at all familiar?
        It should!
        */ 
```

查看此片段，您可能不确定您是在方法范围内还是在类范围内。

在字段名称 ( ,或) 中使用其中一个`private`或下划线将消除混淆。`private int spam;``int spam_;``int _spam;`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-16T10:28:52.807

由你决定。做最好的可读性或对您的情况有意义的事情。我将它们标记为私有只是为了说明清楚。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-16T10:32:28.663

我认为为了可读性，最好是明确的。

作为一个方面，您可能希望查看一个名为**Code Style Enforcer** ( [http://joel.fjorden.se/static.php?page=CodeStyleEnforcer](http://joel.fjorden.se/static.php?page=CodeStyleEnforcer) ) 的 Visual Studio 插件，它使用 dxCore 扩展来提供真实-您的代码遵守编码标准的时间反馈（完全可定制）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-16T10:37:25.127

我个人更喜欢明确标记默认的私有和默认公共字段。您可能很了解默认设置，但只要您快速扫描代码，您的大脑就会喜欢冗长。

# perl - 如何为具有不同数量值的 DBI 插入编写子例程？

> ID：552866
> 
> 赞同：3
> 
> 时间：2009-02-16T10:28:06.913
> 
> 标签：perl, insert, dbi

我正在做很多插入查询，我认为最好为它编写一个子例程。类似的东西`insertRow($table, @stuff_to_insert)`。`@stuff_to_insert`但是，当涉及到1-5 个参数时，如何使子例程动态化？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T10:51:31.287

最好的解决方案可能是使用 ORM 系统，例如[DBIx::Class](http://search.cpan.org/dist/DBIx-Class/)。它们使处理 SQL 变得更加容易。

如果您选择继续使用原始 DBI，我建议您使用如下准备好的语句：

```
my $query = sprintf 'INSERT INTO %s VALUES(%s)', dbh->quote_identifier($table), join ',', ('?') x $columns;

my $sth = $dbh->prepare($query);

for my $row (@rows) {
    $sth->execute(@{$row});
} 
```

这将是速度和鲁棒性的好处。

您可以将其全部封装在一个子程序中，但 ORM 无论如何可能提供更好的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T10:36:01.637

就像是：

```
sub insertRow
{
    my $table = shift;
    my $placeholders = join(',', map { "?"; } @_); 
    $dbh->do("INSERT INTO $table VALUES ($placeholders)", undef, @_);
} 
```

编辑：您需要添加`undef`为参数。Leon Timmermans 建议不要使用原型

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T10:49:22.650

只需传递对参数数组的引用。然后在 insertRow 中，遍历该数组以获取参数...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T11:13:14.387

它的参数传递部分很容易：

```
sub foo {
  my $table = shift;
  my @stuff_to_insert = @_;

  # Do stuff here
} 
```

不管你传入一个参数，还是五个，或者五十个参数，它们都会进入`@stuff_to_insert`.

至于运行实际查询，请采纳 Leon 的建议并使用准备好的语句。（ORM 可能很方便，但是，IMO，它们被高估了，在简单的情况下严重过度杀伤。）

# sql - 如何将数据从远程系统复制并验证到 SQL Server

> ID：552876
> 
> 赞同：1
> 
> 时间：2009-02-16T10:29:47.533
> 
> 标签：sql, sql-server, ssis, replication, integration

我手头的任务是为数据库创建某种逻辑。今天有一个 IBM MQ 系列设置，可以从几个远程系统复制数据。目前它在远程系统中发生变化并将数据转储到 SQL Server 2005 数据库中的临时表中。

我想根据一些简单的验证逻辑（必填字段和数据格式）和数据层次结构的一些更高级的检查来验证数据。正在导入的数据是分层的，其中一些数据之间存在父子关系。分层验证应检查暂存表和生产表中当前可用的数据，以确保在导入完成后存在有效的层次结构。

如果记录验证失败，应该以某种方式记录失败并且不应该导入失败的记录，但应该导入剩余的记录。如果当前生产表中的记录具有相同的 id，则应将其替换为新记录。在数据出现在临时表中之后，应尽快从临时表传输数据。

据我所知，生产表中的记录总数不会超过100万条，每批更新项目的可能数量最多为几千行。

我的问题是什么解决方案最适合导入数据？

我想到了几个可能的解决方案：

开始转移的方式：

*   定期轮询临时表并在插入新数据时启动某种传输过程的 Windows 服务。
*   将新数据插入表中时，使 MQ 启动传输过程
*   安排 SSIS 作业定期运行

验证和传输数据的方法：

*   创建 SSIS 作业
*   创建存储过程
*   自定义 .NET 代码

我主要担心的是，生产表中的层次结构必须始终保持不变，并且数据应该在出现在暂存表中后不久就可以在生产表中使用。我不能确定临时表中是否始终有完整的层次结构可用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-16T11:09:21.213

我们对此类工作使用封闭流程。

从远程系统获取数据到暂存表中，导入到产品表中。

如果任何东西都可以随意插入到临时表中，并且有子表，那么您可能会在临时表中创建所有子记录之前导入到生产数据库中。

如果您可以自由地将列添加到暂存表（远程端将忽略），或者如果暂存表具有唯一/非重复的 IDENTITY 或 GUID，那么您可以创建一个并行表。

理想情况下，在暂存表中创建行的例程将使用批次编号，然后在成功时创建“批次编号完成”记录。所以你有一个信号量来阻止你导入，直到所有关联的记录都进来。

（它们可以插入到事务块中，但您必须确信插入到暂存表中的所有进程都遵守了这一点）。

给定 IDENTITY / GUID，我将创建一个 1:1 的“错误表”来存储任何描述导入失败的消息。

您可以选择将失败的行移动或复制到单独的故障暂存表中，这样主暂存表就不会被阻塞，并且更容易确保故障被整理出来（我认为是由人）。

说了这么多，这里对我们的具体流程做一个更详细的描述：

为了最小化带宽和更新（即减少阻塞和最小化不必要的事务日志条目等），我们执行以下操作：

在源机器上保存正在传输的表的副本。这有用于更新和操作的附加列（更新或删除标志 - 更新包括插入，并且插入可能在目标获得该行之前再次更新......）

插入到这个表中，**新**的行都可以

仅当至少一列存在差异时才会更新此表 - 因此可以（如果相当 CPU 密集型）将整个源表与暂存表进行比较以找出发生了什么变化。更新设置已更新列。（注意时钟何时返回）

如果在源表中找不到它们，我们会定期标记 stagin 表行 Action=Deleted。

数据从 Source 复制到 Destination 上的相同表，其中 Updated-on 是在最后一次传输之后。

在目标服务器上，检查数据并将其导入生产的例程仅在更新日期工作（处理自上次更新日期以来的所有内容）

所有临时表都在一个单独的数据库中，该数据库具有最少的日志记录——如果数据库恢复，数据库将自动从“上次更新日期”刷新，因此我们的目标是最小化事务日志。我们不会将临时表存储在生产数据库中（它将具有完整的事务日志记录），以避免 TLogs 膨胀

同样，如果这些过程是连续的，这样它们就不会同时发生，这将很有帮助，否则需要某种批次编号来防止传输存在父/子表的部分完成的批次。

我们以 Source 数据库的方式传输数据，只在 Destination 端进行数据操作。这样做的原因是，如果数据操作错误，并且我们修复了它，我们只需要在目标端重新运行它 - 源数据都存在于目标端的临时表中。如果我们在源端进行操作，我们也必须再次重新传输所有数据。

对于调试，在暂存表中具有更新日期是有帮助的。我们经常得到“为什么这不同”并且看到更新后告诉我们目标端的操作是否有问题（即我们有显示预期源数据的最近数据）或源端（没有找到最近的数据！ )

# debugging - 适用于 Mobile 5.0 的应用程序验证程序无法连接到我的 WM 6.0 设备

> ID：552878
> 
> 赞同：1
> 
> 时间：2009-02-16T10:30:14.723
> 
> 标签：debugging, windows-mobile

我正在尝试将 Application Verifier for Mobile 5.0 连接到 Windows Mobile 6.0 Professional 设备，但我失败了。这甚至可能吗？

此设备上的 ActiveSync 和 VS2005 调试工作正常。

我已将应用程序验证程序传输和启动服务器设置为 Microsoft ActiveSync，如果单击测试按钮，它会显示“与设备的连接已建立”，但如果我尝试连接到设备，则会显示：“无法启动设备 EXE”。

你能告诉我如何连接到这个设备吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-07T19:05:34.373

听起来 appverif_client.exe 尚未复制到设备。

查看 [http://windowsteamblog.com/blogs/windowsphone/archive/2009/07/26/windows-mobile-application-verifier.aspx](http://windowsteamblog.com/blogs/windowsphone/archive/2009/07/26/windows-mobile-application-verifier.aspx)

有关使其正常工作的最新信息和工具。它还包括一些关于使其正常工作的额外指示。

# git - 通过 Git 推送服务器？

> ID：552880
> 
> 赞同：1
> 
> 时间：2009-02-16T10:31:16.890
> 
> 标签：git

我尝试了以下命令失败：

```
git push 12.12.12.123:/proj.git master 
```

它询问我的密码，但每次都拒绝它。

我使用以下命令来设置 Git：

```
git --bare update-server-info
chmod a+x hooks/post-update 
```

最后一个命令给了我这个错误：

```
chmod: Cannot access 'hooks/post-update':No such file or directory 
```

我正在阅读[教程](http://www-cs-students.stanford.edu/~blynn/gitmagic/ch06.html#_git_over_ssh_http)。

**[编辑]**

尝试推送后收到以下错误消息：

```
bash: git-receive-pack: command not found
fatal: The remote end hung up unexpectedly 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T10:46:32.593

你需要在你的仓库中做 git init

[http://www.kernel.org/pub/software/scm/git/docs/git-init.html](http://www.kernel.org/pub/software/scm/git/docs/git-init.html)

这是很好的快速教程：http: [//toolmantim.com/articles/setting_up_a_new_remote_git_repository](http://toolmantim.com/articles/setting_up_a_new_remote_git_repository)

这一次有点长

简而言之，设置 git：

```
$ ssh myserver.com
Welcome to myserver.com!
$ mkdir /var/git/myapp.git && cd /var/git/myapp.git
$ git --bare init
Initialized empty Git repository in /var/git/myapp.git
$ exit
Bye! 
```

你需要 ssh://12.12.12.123:/proj.git master

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T10:58:43.313

您可能还需要将您的用户名添加到 git 命令中，例如 masi@1.2.3.4:/proj.git。我认为这就是您收到密码错误的原因。

我不相信 ssh:// 是必要的。

# sql-server-2005 - 检查 SQL Server 2005 中表的使用历史记录

> ID：552886
> 
> 赞同：1
> 
> 时间：2009-02-16T10:32:55.917
> 
> 标签：sql-server-2005

有没有办法通过更新、删除或选择来检查表访问的统计信息？我试图为数据库清理找到过时的未使用表。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T10:36:54.660

是的 - 您可以创建一个跟踪，MSDN - [SQL Server 2005 中的数据访问跟踪](http://msdn.microsoft.com/en-us/library/aa964124(SQL.90).aspx)。

或者，如果您知道什么在访问它们（例如，通过存储过程），您可以在其中留下跟踪信息（将行添加到表中），然后您可以看到实际正在运行的内容。这不是万无一失的——你证明是负面的，因为你会发现很难抓住偶尔的打击。

我们使用的一种方法是重命名表，例如重命名为“zzz_OldName”，然后将它们留在那里一段时间，定期修剪模式的那个区域。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T10:39:39.677

据我所知，Sql Server 中没有此类数据的内置统计信息。虽然可以使用 Sql Profiler 来获取一段时间内的使用数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T11:12:05.607

您可以检查您的 DMV（[动态管理视图](http://www.codeproject.com/KB/database/Dynamic_Management_Views.aspx)）。如果您的表都有一个主键，则有一个主键索引，如果该索引从未被读取，则您的表根本没有被使用。

但请注意：这些是*动态*管理视图 - 每次 SQL Server 启动时它们都会重置为 0。您可能希望查看 SQL Server 2008 [Performance DATA Collector](http://blogs.msdn.com/sqlrem/archive/2008/01/17/performance-studio-for-sql-server-2008-revealed.aspx)或 SQL Server 2005 的[SQL DMV Stats](http://www.codeplex.com/sqldmvstats)项目，以便在删除表之前在较长时间内捕获 DMV 数据 :-)

马克

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T11:15:09.717

还可以在表上放置一个触发器以将 TableName + GetDate() 存储在“WasFoundToBeUsedAfterAll”表中

您可能希望 UpSert 已经存在的任何行，并且可能仅在现有 Date 已经 24 小时或更长时间的情况下，而不是插入多行 - 这只会成为一个维护问题！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-02-04T07:45:22.940

```
-- shows table accesses since last MSSQL reboot via index stats.
-- NULL columns imply table wasnt accessed since the last restart.
SELECT 
  t.name AS 'Table', 
  Count(i.user_seeks) as 'Indexes',
  SUM(i.user_seeks + i.user_scans + i.user_lookups) 
    AS 'Total accesses',
  SUM(i.user_seeks) AS 'Seeks',
  SUM(i.user_scans) AS 'Scans',
  SUM(i.user_lookups) AS 'Lookups',
  SUM(i.user_updates) AS 'Updates'
FROM 
  sys.dm_db_index_usage_stats i RIGHT OUTER JOIN 
  sys.tables t ON (t.object_id = i.object_id)
GROUP BY 
  i.object_id, 
  t.name
ORDER BY [Total accesses] DESC 
```

# javascript - 种类 使用 jQuery 的元素

> ID：552888
> 
> 赞同：9
> 
> 时间：2009-02-16T10:33:30.393
> 
> 标签：javascript, jquery, sorting

我的网站上有如下 HTML：

```
<div class="groups">
  <div class="group">
    Group 1 priority:
    <select>
      <option value="1.0">1</option>
      <option value="2.0" selected="selected">2</option>
      <option value="3.0">3</option>
    </select>
  </div>
  <div class="group">
    Group 2 priority:
    <select>
      <option value="1.0">1</option>
      <option value="2.0">2</option>
      <option value="3.0" selected="selected">3</option>
    </select>
  </div>
  <div class="group">
    Group 3 priority:
    <select>
      <option value="1.0" selected="selected">1</option>
      <option value="2.0">2</option>
      <option value="3.0">3</option>
    </select>
  </div>
</div> 
```

我正在寻找一种方法，根据下拉列表中选择的内容，使用 jQuery 对这些组在浏览器中出现的顺序进行排序。当用户在任何下拉列表中或在页面加载时选择新值时，它应该使用。

解决这个问题的最简单方法是什么？

如果可以以任何方式使用可排序的东西，我有可用的 jQuery UI。我找不到使用它的方法。

**更新**： <div class="group"> 中的其他数据应该跟随下拉列表移动到哪里。组的数量从 0 到 20 不等。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T10:52:16.887

**编辑：**这是一些应该做你所追求的代码。这里`select_1`,`select_2`等应该是下拉列表的 ID。`getDropdown()`应该是一个函数，它使用您选择的方法（`document.getElementById().options.selectedIndex,`、jquery 等）返回给定下拉 ID 的选定值

```
<div id="parent">
    <div id="child1">
        ..content
        <select id="select_1">...content</select>
    </div>

    <div id="child2">
        ..content
        <select id="select_2">...content</select>
    </div>

    <div id="child3">
        ..content
        <select id="select_3">...content</select>
    </div>
</div> 
```

* * *

```
 function sortValues()
    {
        /*Save the contents of each div in an array 
          so they can be looped through and 
          re inserted later*/
        var content=[$("#child1").html(),$("#child2").html,$("#child3").html()];

        //Get the value of all dropdowns and sort them
        var sortedArray=[getDropdown("select_3"),getDropdown("select_2"),getDropdown("select_3")];
        var sortedContent=new Array();
        sortedArray.sort();

        /*Loop through all the sorted values, 
         compare the value of each dropdown
         against the sorted value and use that 
         to determine the new arrangement of the divs
         */
        for (x=0; x< sortedArray.length; x++)
        {
            for (y=0; y<=content.length; y++)
            {
                if (getDropdown("dropdown_" + (y+1))==sortedArray[x])
                {
                    sortedContent[x]=content[x];
                               //This will prevent the same div from being assigned again:
                    $("#select_" + (y+1)).remove(); 
                    break;
                }

            }

        }
        /* Empty the parent div so new divs can be inserted.
           You can also do a fadeout/fadeIn of the div here
         */

        $("#parent").empty();       

        for (x=0; x< sortedContent.length; x++)
        {
            $("#parent").append(sortedContent[x]);
        }
    } 
```

# linux - 您如何看待新的 Debian 发布周期？

> ID：552890
> 
> 赞同：-7
> 
> 时间：2009-02-16T10:34:28.783
> 
> 标签：linux, unix, debian, release-cycle

我很惊讶 Lenny 已经晋升为“稳定版”——在我的一些客户中，有些担心 Debian 会想与 Ubuntu 竞争桌面并忘记它对服务器的投入。

4.0 Etch 和 5.0 Lenny 之间的“仅”2 年在 Debian 时间尺度上是史无前例的。版本膨胀？是因为 SPARC-32 支持被放弃了吗？否则 4.0 Etch 和 Lenny 之间的变化似乎并不比 3.0 Woody 到 3.1 Sarge（相隔 3 年）大。

Woody 的支持时间最长（整整 4 年），然后 3.1 和 4.0 的支持时间都下降到不到 3 年（我认为仍然相当不错）。

Lenny 还没有决定，但我想在做出下一个服务器发行版决定之前了解这一点。

您对此有何看法？

参考： - [http://en.wikipedia.org/wiki/Debian#Releases](http://en.wikipedia.org/wiki/Debian#Releases) - [http://en.wikipedia.org/wiki/File:Debian_releases.svg](http://en.wikipedia.org/wiki/File:Debian_releases.svg)

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-03-03T15:14:58.707

> 4.0 Etch 和 5.0 Lenny 之间的“仅”2 年在 Debian 时间尺度上是史无前例的。版本膨胀？是因为 SPARC-32 支持被放弃了吗？否则 4.0 Etch 和 Lenny 之间的变化似乎并不比 3.0 Woody 到 3.1 Sarge（相隔 3 年）大。

在一个透明开发很正常的世界里，“major.minor”风格的版本号在很大程度上是没有意义的。Linus 和 Ubuntu 和 Fedora 的人似乎也是这么想的。

如果您对 Debian 为您的服务器感到满意，请不要切换，只需 (apt-get) 升级即可。

顺便说一句，看到维基百科上那张毫无意义的图表，我的大脑很疼。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-16T10:39:04.407

问题出在哪里？Etch 将在一年后得到支持，将其升级到 Lenny 只需键入几条命令即可。

Debian 似乎仍然是最严肃的服务器发行版。~~[它是 Ubuntu 的基石](http://www.ubuntu.com/community/ubuntustory/debian)。~~

# apache-flex - 禁用 Flex DataGrid 中的行

> ID：552904
> 
> 赞同：2
> 
> 时间：2009-02-16T10:39:14.030
> 
> 标签：apache-flex, actionscript-3, actionscript, flex3

除非我在这里遗漏了一些明显的东西，否则无法禁用 DataGrid 中的一行或多行。我希望 DataGrid 或 List 组件上有 disabledRows 或 disabledRowIndidices 属性，但这似乎不存在。

我找到了一个“rendererArray”属性，其范围为 mx_internal，包含数据网格中所有单元格的所有 itemrenderer。所以我可以检查渲染器中数据的类型和值，并启用或禁用同一行的所有单元格，但这感觉太像黑客了。

有什么建议么？

**编辑**：我意识到禁用一行可能意味着不同的事情。在我的情况下，这意味着即使数据网格的可编辑属性设置为 true，也无法编辑该行。然而，这也可能意味着无法选择一行，但这不是我想要的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-08T02:53:05.057

为此，您需要该行的一些数据来表示它是不可编辑的。然后当“itemEditBeginning”然后检查数据或行索引以启用/禁用 event.preventDefault 的默认行为...

```
public function preventEditing(event:DataGridEvent):void
{   
    var status : Boolean = ArrayObjs[rowIndex].isYourCondition;

    if (status == true)
    {
        event.preventDefault();
    }
} 
```

另一种选择是为您的数据单元格制作自定义 ItemRenderer，但不要认为这是您想要的，因为您需要为每个单元格制作它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T18:56:39.410

实际上这最好通过“itemEditBeginning”来完成。在这里寻找一个好的教程：[链接文本](http://www.adobe.com/devnet/flex/articles/itemeditors_pt2.html?devcon=f1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T06:17:27.550

Alex Harui 在此处提供了一个很好的示例，源代码[http://blogs.adobe.com/aharui/2007/06/disabling_list_selection.html](http://blogs.adobe.com/aharui/2007/06/disabling_list_selection.html) 这是一个有点冗长的解决方案，但涵盖了鼠标和键盘与数据网格的交互。我同意你的看法，令人惊讶的是没有“内置”方法来做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-13T19:15:42.830

只需为 DataGrid 的“itemEditBegin”设置一个函数，执行如下操作：

```
protected function validateEdition(event:DataGridEvent):void{
    if([EDITION CRITERA NOT MET]){
          event.preventDefault();
    }
}

<mx:DataGrid id="grid" itemEditBegin="validateEdition(event)" editable="true">
      <mx:columns>
         [[YOUR COLUMN CONFIGURATION]]
      </mx:columns>
</mx:DataGrid> 
```

event.preventDefault() 将阻止 DataGrid 将 ItemRenderer 切换到 ItemEditor 以便停止不符合条件的行的版本。您的 DataGrid 必须是可编辑的，它才能工作。

这应该可以解决问题。

# javascript - scriptaculous draggables：拖动元素时需要取消onClick动作

> ID：552905
> 
> 赞同：1
> 
> 时间：2009-02-16T10:39:19.850
> 
> 标签：javascript, dom-events, draggable, scriptaculous

感谢三个出色的答案，它们都确定了我使用“onclick = ...”而不是“observe（“click”，...”）的问题

但是，Accepted Answer 的奖项必须授予 Paolo Bergantino，因为它使用了添加类名来标记拖动元素的机制，这为我节省了更多的工作！

* * *

在我的 HTML 中，我有一个表格，每行都有一个图像链接。

```
<table class="search_results">
  <tr>
     <td class="thumbnail"><a href="..."><img src="..." /></a></td>
... 
```

包含的 Javascript 文件包含使图像可拖动的代码：

```
$$( ".thumbnail a img" ).each(
  function( img )
  {
    new Draggable( img, {revert:true} );
  }
); 
```

和一个简单的处理程序来检测拖动的结束

```
Draggables.addObserver({
  onEnd:function( eventName, draggable, event )
  {
    // alert ( eventName ); // leaving this in stops IE from following the link
    event.preventDefault(); // Does Not Work !!!
    // event.stop(); // Does Not Work either !!!
  }
}); 
```

我的想法是，当单击图像时，应该遵循链接，但是当它被拖动时，应该会发生其他事情。

事实上，当图像被拖动时，处理程序被调用，但链接仍然被跟踪。

我想我取消了错误的活动。

拖动元素后如何防止链接被跟踪？

* * *

编辑：`event.stop`在尝试了 graystate 的建议后添加

* * *

我现在有一个适用于 FireFox、Apache 等的基本解决方案。请参阅下面我自己的答案。

但我仍在寻找 IE7（希望是 IE6）的解决方案。

在 IE 中拖动图像的另一个问题是，当工具提示出现时，图像与鼠标指针分离，您必须释放鼠标并再次单击图像才能重新获得拖动。所以我也在寻找任何可能有助于解决这个问题的想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T11:40:13.833

```
// for keeping track of the dragged anchor
var anchorID = null;

// register a click handler on all anchors
$$('.thumbnail a').invoke('observe', 'click', function(e) {
    var a = e.findElement('a');
    // stop the event from propagating if this anchor was dragged
    if (a.id == anchorID) {
        e.stop();
        anchorID = null;
    }
});

$$('.thumbnail a img').each(function(img) {
    new Draggable(img, { revert:true });
});

Draggables.addObserver({
    onStart: function(eventName, draggable, e) {
        // store the dragged anchor
        anchorID = e.findElement('a').id;
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T11:30:04.407

好的，我发现的方式是使用“拖动状态”变量，类似于您之前的帖子，但它适用于 IE7 和 FF。

使用 Prototype，您可以为要拖动的 html 元素的 click 事件添加一个观察者函数，告诉 in there `event.stop();`。此操作扩展（即原型化）要传递给处理函数的事件对象，从而丰富它的所有 Prototype 附加方法，并使其能够调用该`stop()`方法而无需担心它运行到的浏览器，因为 Prototype 管理这方面给你。

这是我的示例的代码：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
      <script type="text/javascript" src="lib/prototype.js"></script>
      <script type="text/javascript" src="src/scriptaculous.js"></script>
    <title>Draggables Test</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  </head>
  <body>
    <div id="dragme"><a href="http://www.google.it">Ok, you can drag this one.</a></div>
    <script type="text/javascript">
        function processIt(event) {
            if ( isDragging ) {
                event.stop();
            }
            isDragging = false;
        }

        new Draggable('dragme', { revert: false });
        var isDragging = false;

        $('dragme').observe('click', processIt );
        Draggables.addObserver({
            onDrag:function( eventName, draggable, event ) {
                isDragging = true;
            }
        });
        </script>
  </body>
</html> 
```

不同之处在于，在您的原始示例中，您将事件视为标准 DOM 事件（请参阅[此处](http://wiki.github.com/madrobby/scriptaculous/draggables-object)的参数规范，页面底部），这对于 FF 是可以的，但对于 IE 则完全不行，因为它处理事件稍微（但绝对）不同的方式。最重要的是，您在处理程序中处理的`onEnd:`事件不是*单击*事件，而是*onend*事件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T12:18:51.510

```
<script>
document.observe("dom:loaded", function() {
    $$( ".thumbnail a img" ).each(function(img) {
        new Draggable(img, {
            revert: true,
            onEnd: function(draggable, event) {
                $(draggable.element).up('a').addClassName('been_dragged');
            }
        });
    });

    $$(".thumbnail a").each(function(a) {
        Event.observe(a, 'click', function(event) {
            var a = Event.findElement(event, 'a');
            if(a.hasClassName('been_dragged')) {
                event.preventDefault();
                // or do whatever else
            }
        });
    });
});
</script> 
```

在 Firefox、IE 上为我工作。它有点使用你的“标记”想法，但我认为用类标记已经拖动的元素比 javascript 变量更优雅。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T11:07:35.943

经过一些实验，我想出了以下修复方法。

但我对它不太满意，因为它看起来有点乱，而且**在 IE7 中不起作用。**

编辑

还尝试了“ev.stop”和“return false”作为 ev.preventDefault 的替代方案。所有都给出相同的结果，在除 IE 之外的所有浏览器中工作。

取消注释警报证明即使在 IE 中也正在执行 preventDefault

将 onEnd 处理程序更改为 onDrag 处理程序，以避免处理程序调用顺序的潜在问题。

```
$$( ".thumbnail a img" ).each(
  function( img )
  {
    new Draggable( img, {revert:true} );
  }
);

var drag_occurred = false;
$$( ".thumbnail a" ).each(
  function( tag )
  {
    tag.onclick = function( ev )
    {
      if ( drag_occurred )
      {
        // alert( "!" );
        ev.preventDefault();
      }
      drag_occurred = false;
    }
  }
);

Draggables.addObserver({
  onDrag:function( eventName, draggable, event )
  {
    drag_occurred = true;
  }
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T08:00:58.007

我现在无法对此进行测试，但正如我所见，您正在制作`<img>`可拖动的元素，但您正在观察`<a>`元素上的点击，所以问题可能是点击事件冒泡到执行其默认值的链接行动。

Prototype 有一个`stop()`事件方法，除了阻止默认操作外，还取消事件冒泡 - 你可以在 onEnd 函数中尝试，而不是`preventDefault()`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-23T18:39:57.857

尝试这样做

```
$$( ".thumbnail a" ).each(
  function( tag )
  {
    tag.onclick = function( ev )
    {
      if ( drag_occurred )
      {
        ev.cancelBubble = true;
        if (ev.stopPropagation) ev.stopPropagation();
      }
      drag_occurred = false;
    }
  }
); 
```

# sql - LINQ 中的 count VS select - 哪个更快？

> ID：552909
> 
> 赞同：11
> 
> 时间：2009-02-16T10:41:49.687
> 
> 标签：sql, linq, performance, iqueryable

我在`IQueryable<T>`整个应用程序中使用接口，并将数据库上的 SQL 执行推迟到像这样的方法`.ToList()`

我有时需要找到某些列表的计数 - 而无需使用正在计数的列表中的数据。根据我的 SQL 经验，我知道 SQL COUNT() 对数据库的工作量远低于返回所有行的等效 SELECT 语句。

`IQueryable<T>`所以我的问题是：从'`Count()`方法返回计数比将 ' 渲染`IQueryable<T>`到列表并调用列表的方法在数据库上的工作会更少`Count()`吗？

我怀疑它会`ToList()`触发 SELECT sql，然后在单独的查询中计算行数。我希望`Count()`on`IQueryable<T>`只是为 sql COUNT() 查询呈现 sql。但我不确定。你知道吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-16T10:46:34.527

调用`ToList()`将返回一个包含所有数据的正版`List<T>`，这意味着获取所有数据。不好。

调用`Count()`确实应该呈现 SQL 以在数据库端进行计数。好多了。

但是，检查这一点的最简单方法是在您的数据上下文中启用日志记录（或您的特定提供者的任何等效项）并查看实际发送的查询。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-18T02:46:10.310

我不确定这是否是一个硬性规定，但您添加到 Iqueryable 的 linq 方法将被添加到 linq 表达式树中 - 除非它们是实际导致树被评估的方法之一（如 ToList 和 Single ETC）。在 LinqToSql 的情况下，您会知道它是否无法将某些内容转换为 SQL 语句，因为您会收到一个运行时异常，说明该方法不受支持。

例如

```
var something = dbContext.SomeTable
  .Select(c => c.col1 == "foo")
  .Distinct()
  .ToList()
  .Count() 
```

在上面，Select() 和 Distinct() 包含在传递给服务器的 sql 查询中，因为它们被添加到 Iqueryable 中。Count() 只是作用于 sql 查询返回的列表。所以你不想那样做:-)

在您的情况下， Count() 肯定会比 Select() 更快，因为生成的 sql 语句确实会合并计数，因此服务器只需要返回一个数字而不是行列表。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2011-05-15T05:35:07.413

如果您使用的是 SQL Server，Count() 仍然非常昂贵，因为它会导致表扫描（或索引扫描，请参阅对主要答案的评论）。而且，默认情况下，Linq 不使用读取未提交的隔离级别，由于锁定，这使事情变得更糟。

如果您可以接受结果是脏结果和总行数的近似值，那么以下代码将比使用 Count() 快得多。以我的经验，此代码返回的值与真实的行数很少不同。

```
/// <summary>A very fast method for counting rows in a table.</summary>
public static long FastRowCount(DataContext context, string tableName)
{
    const string template = "SELECT rowcnt FROM sys.sysindexes WHERE id = OBJECT_ID('{0}') AND indid < 2";
    string query = string.Format(template, tableName);
    return context.ExecuteQuery<long>(query).Single();
} 
```

# math - 如何找到有向距离的符号？

> ID：552916
> 
> 赞同：3
> 
> 时间：2009-02-16T10:47:14.447
> 
> 标签：math, geometry

我在 3D 空间的有向线 AB 上有 2 个点 P 和 Q。它们可以在线上的任何位置，即不一定在 A 和 B 之间。

毕达哥拉斯显然给了你距离，但是我如何计算从 P 到 Q 的有向距离的符号？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-16T10:59:27.367

取**AB**和**PQ**的**[点积](http://en.wikipedia.org/wiki/Dot_product)**。正=> 同方向，负=> 反方向。

 ***** * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-16T11:02:29.200

将 QP 和 BA 的差值视为向量**AB**和**PQ**，符号由向量的点积的符号给出。

符号（有符号距离）=符号（**PQ** · **AB**）

在哪里

[x,y,z] · [ p,q,r ] = x✕p + y✕q + z✕r

如果您通过将向量**AB**除以其大小（点积与其自身的 sqrt ）来归一化向量 AB，

**N** = **AB** / | **AB** |

那么沿 AB 方向的有符号距离将是

有符号距离 = **PQ** · **N**

这意味着如果 A 和 B 不变，您只需要执行一次 sqrt。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T10:52:40.473

对于每个维度 (x,y,z)，对于 A->B，它将增加、减少或恒定。这可以通过做 BA (xB-xA, yB-yA, zB-zA) 找到。为您的积分计算 QP 的等效值。如果 x（或 y 或 z）中的符号与 BA 中的符号相同，则方向与 AB 相同，否则方向不同。

您只需要查看 x、y 或 z 中的 1 个，但如果 AB 在 x、y 或 z 中是常数，则您需要选择另一个维度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T10:52:44.763

听起来你在问向量。我不知道你是否研究过它们，但它们是既有大小又有方向的量。

如果您在空间中的两个点是 (p1, p2, p3) 和 (q1, q2, q3)，您可以在 3D 空间中形成从 P 指向 Q 的向量，如下所示：

V = (q1-p1)*i + (q2 - p2)*j + (q3 - p3)*k

其中 (i, j, k) 分别是 x、y 和 z 方向上大小为 1 的向量。

从P到Q的幅度（例如，距离）是分量平方和的平方根。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-16T10:54:02.217

这些点在线 AB 上，您需要从 P 到 Q 的距离。

该线从 A 指向 B，因此您可以定义一个 alpha，使得：

```
Point = alpha (B-A) + A 
```

求 P 和 Q 的 alpha，如果 P 的 alpha 大于 Q 的 alpha，则符号为负。

# c# - 如何发现 Socket.Select() 报错的原因

> ID：552921
> 
> 赞同：4
> 
> 时间：2009-02-16T10:49:37.080
> 
> 标签：c#, sockets

我打电话`Bind()`，然后`Listen()`在 System.Net.Sockets.Socket 上。这些调用都不会引发异常。

后来，我打电话给：

```
Socket.Select(myreadlist,mywritelist,myerrorlist,0); 
```

myreadlist 和 myerrorlist 包含有问题的套接字。Select 通过将套接字留在 errorList 中而不是将其从列表中删除来报告我的套接字有错误。在程序中没有任何地方抛出 SocketException。

我似乎无法弄清楚我应该问系统的正确方式：“好的，那么*出了什么*问题？”

有人知道吗？

谢谢，卢卡斯

编辑：为 select 添加第 4 个参数 = 0 + 更好地解释了 select() 如何告诉我发生了错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T11:58:54.150

我不知道 C#，但我知道 UNIX 套接字。我的第一个想法是在选择读取之前您没有在套接字上调用 accept() 但是（这证明我对套接字的了解比我想象的要少）您可以在侦听状态下选择以查看哪些套接字可以被接受。哦，好吧，我们生活和学习，即使在我高龄的时候:-)

无论如何，参考[这里](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.select(VS.71).aspx)的 MSDN 文档，通过谷歌找到 ("c#" socket bind listen select)，它指出：

`If you receive a SocketException, use SocketException.ErrorCode to obtain the specific error code. Once you have obtained this code, you can refer to the Windows Socket Version 2 API error code documentation in MSDN for a detailed description of the error.`

这些错误代码似乎记录[在此处](http://msdn.microsoft.com/en-us/library/ms740668(VS.85).aspx)，可通过 Google 搜索找到（MSDN 中的 Windows Socket Version 2 API 错误代码文档）。

我提到了谷歌搜索词，以防 MSDN 移动他们的页面。我会从捕获的异常中输出错误代码，然后在第二个链接的列表中查找它以获取失败的实际原因。一旦我们知道了这一点，我们可能会为您提供进一步的帮助（或者它可能会变得非常明显，以至于您不需要再次询问我们:-)。

一件看起来不协调的事情：调用的原型有第四个参数，如果没有活动则等待的微秒数。您在问题中的代码没有那个。现在，正如我所说，我对 C# 知之甚少，所以它可能默认为某些东西（或者你可能只是不小心把它从问题中排除了）。

但是，如果您使用 -1（或默认为 -1），我会注意一个已知的错误：有关详细信息，请参见[此处](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=286646)，但这基本上意味着 -1 立即返回，而不是永远等待。解决方法是使用 -2 给您一个小时左右的时间，但您仍然必须考虑到它可能会返回的事实，即使没有任何活动。

如果它**没有**抛出异常，而只是在 中设置错误指示`myerrorlist`，那将是一个更棘手的问题。我看不到任何文档显示如何轻松解决它，但我会看看这些可能性。

*   您可以调用 WSA 函数（例如`WSAGetLastError()`）来解决这个问题。我不确定这在 C# 中有多容易。您可以尝试`accept()`错误的套接字，看看它是否会给您一个异常，详细说明为什么它是一个问题。
*   该类`Socket`有一个`Handle`成员，它是套接字的操作系统句柄。可以通过遵循它来提取错误信息。
*   您是否考虑过使用线程进行连接处理并完全绕过使用`select()`（即，仅使用`accept()`但来自多个线程）？

我发现的另一件事与套接字调试有关。[此页面](http://msdn.microsoft.com/en-us/magazine/cc300760.aspx)底部有一个部分显示如何进行网络跟踪。.NET 2 显然不支持这一点，`select()`但在最新版本中可能已经改变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T13:30:29.593

Select() 调用的文档是这样说的：

> 如果您对 Connect 进行了非阻塞调用，则 checkerror 参数会标识未成功连接的套接字。

SelectError 模式中 Poll() 方法的文档（它建议使用它来确定单个套接字的状态）说：

> 如果处理没有阻塞的 Connect 并且连接失败，则为 true；- 或 - 如果 OutOfBandInline 未设置且带外数据可用，则为 true；否则，返回 false。

基于此，我想说这是套接字指示错误状态而之前没有引发异常的仅有的两种情况。你没有提到调用 Connect()，但如果你这样做了，我会验证它实际上是在建立连接。带外数据非常罕见，但也许你的另一端套接字正在做一些奇怪的事情。

# asp.net - ASP.NET 找到具有相同 ID 'x' 的多个控件。查找控件

> ID：552922
> 
> 赞同：5
> 
> 时间：2009-02-16T10:50:03.303
> 
> 标签：asp.net, dynamic, controls, unique

收到以下错误

找到具有相同 ID 'ltlItemCode' 的多个控件。FindControl 要求控件具有唯一的 ID。

此错误不会在页面加载时发生，但是当我更改具有 AutoPostBack="true" 的下拉列表的值时。

代码是

```
 //Number of Services
    numberofServices = Int32.Parse(DCCFunctions.GetNumServicesPerRoom(roomId.ToString()));
    additionalServices = new UserControls_AdditionalService[numberofServices - 1];

    String htmlTable = String.Empty;
    Int32 cell = 1;
    Int32 rows = numberofServices;
    Int32 cols = 4;

    TableHeaderRow h = new TableHeaderRow();
    TableHeaderCell hc1 = new TableHeaderCell();
    hc1.Text = "Item Description";
    h.Cells.Add(hc1);
    TableHeaderCell hc2 = new TableHeaderCell();
    hc2.Text = "Item Price";
    h.Cells.Add(hc2);
    TableHeaderCell hc3 = new TableHeaderCell();
    hc3.Text = "Item Quantity";
    h.Cells.Add(hc3);
    TableHeaderCell hc4 = new TableHeaderCell();
    hc4.Text = "Item Sub Total";
    h.Cells.Add(hc4);
    Table1.Rows.Add(h);

    // Open database connection
    DBConnection conn = new DBConnection();

    // Retrieve details
    SqlCommand sqlGetDetails = conn.SetStoredProcedure("spGetAdditionalServicesDetails");
    DBConnection.AddNewParameter(sqlGetDetails, "@roomId", ParameterDirection.Input, SqlDbType.Int, roomId);

    try
    {
        conn.Open();

        SqlDataReader reader_list = sqlGetDetails.ExecuteReader();
        if (reader_list.HasRows)
        {
            while (reader_list.Read())
            {
                //returnVal = reader_list["Num"].ToString();
                htmlTable += "&lt;tr>" + Environment.NewLine;
                TableRow r = new TableRow();

                additionalServices[cell - 1] = (ASP.usercontrols_additionalservice_ascx)LoadControl("~/UserControls/AdditionalService.ascx");

                Literal ItemCode = (Literal)additionalServices[cell - 1].FindControl("ltlItemCode") as Literal;
                ItemCode.Text = reader_list["itemDescription"].ToString();

                Literal ItemPrice = (Literal)additionalServices[cell - 1].FindControl("ltlItemPrice") as Literal;
                ItemPrice.Text = "&euro;" + reader_list["unitPrice"].ToString();

                Literal ItemTotal = (Literal)additionalServices[cell - 1].FindControl("ltlTotalPrice") as Literal;
                ItemTotal.Text = "&euro;" + "0";

                TableCell ItemCodeCell = new TableCell();
                ItemCodeCell.Controls.Add((Literal)additionalServices[cell - 1].FindControl("ltlItemCode") as Literal);

                TableCell ItemCodePriceCell = new TableCell();
                ItemCodePriceCell.Controls.Add((Literal)additionalServices[cell - 1].FindControl("ltlItemPrice") as Literal);

                TableCell ItemCodeTotalCell = new TableCell();
                ItemCodeTotalCell.Controls.Add((Literal)additionalServices[cell - 1].FindControl("ltlTotalPrice") as Literal);

                TableCell c = new TableCell();
                DropDownList qtyList = (DropDownList)additionalServices[cell - 1].FindControl("qtyList") as DropDownList;
                qtyList.Items.Add(new System.Web.UI.WebControls.ListItem("Select Quantity...", "0"));
                qtyList.DataBind();

                for (Int32 count = 1; count < 101; count++)
                {
                    qtyList.Items.Add(new System.Web.UI.WebControls.ListItem(count.ToString(),count.ToString()));
                }
                //c.ColumnSpan = 5;
                c.Controls.Add((DropDownList)additionalServices[cell - 1].FindControl("qtyList") as DropDownList);

                r.Cells.Add(ItemCodeCell);
                r.Cells.Add(ItemCodePriceCell);
                r.Cells.Add(c);
                r.Cells.Add(ItemCodeTotalCell);
                //r.Controls.Add(additionalServices[cell - 1]);
                //cell += 1;

                // Add the row
                Table1.Rows.Add(r);
            }
        }
        reader_list.Close();
    }
    catch (Exception ex)
    {
        M1Utils.ErrorHandler(ex);
    }
    finally
    {
        conn.Close();
    }` 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T14:39:30.333

```
 ItemCodeCell.Controls.Add((Literal)additionalServices[cell - 1].FindControl("ltlItemCode") as Literal); 
```

我猜这就是问题所在，看起来你一遍又一遍地添加相同的控件，但我不确定。尝试更改新添加的文字的 .ID。

另外，我以前从未使用过[“EnsureID()”](http://msdn.microsoft.com/en-us/library/system.web.ui.control.ensureid.aspx)，但似乎它可能会有所帮助。类似的东西

```
 Literal duplicateLiteral = (Literal)additionalServices[cell - 1].FindControl("ltlItemCode") as Literal;
duplicateLiteral.EnsureID();
ItemCodeCell.Controls.Add(duplicateLiteral); 
```

不过这可能行不通，因为它看起来会一遍又一遍地插入重复的文字的相同副本，尽管我不确定。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-21T20:51:23.783

我同意您似乎正在反复添加相同的控制，这会导致命名冲突。看起来您可能以错误的顺序将控件添加到其他控件的控件集合中。例如，您按以下顺序添加：

```
TableHeaderRow h = new TableHeaderRow();    
TableHeaderCell hc1 = new TableHeaderCell();    
hc1.Text = "Item Description";    
h.Cells.Add(hc1);    
TableHeaderCell hc2 = new TableHeaderCell();    
hc2.Text = "Item Price";    
h.Cells.Add(hc2);    
TableHeaderCell hc3 = new TableHeaderCell();    
hc3.Text = "Item Quantity";    
h.Cells.Add(hc3);    
TableHeaderCell hc4 = new TableHeaderCell();    
hc4.Text = "Item Sub Total";    
h.Cells.Add(hc4);    
Table1.Rows.Add(h); 
```

当你真的应该按这个顺序添加时：

```
TableHeaderRow h = new TableHeaderRow();   
Table1.Rows.Add(h); 
TableHeaderCell hc1 = new TableHeaderCell();
h.Cells.Add(hc1);   
hc1.Text = "Item Description";      
TableHeaderCell hc2 = new TableHeaderCell();
h.Cells.Add(hc2);    
hc2.Text = "Item Price";       
TableHeaderCell hc3 = new TableHeaderCell();
h.Cells.Add(hc3);    
hc3.Text = "Item Quantity";      
TableHeaderCell hc4 = new TableHeaderCell();
h.Cells.Add(hc4);    
hc4.Text = "Item Sub Total"; 
```

作为一项规则，我总是尝试尽快将新控件添加到父控件集合中，以确保任何子控件都继承正确的 UniqueID。如果在将 X 添加到父 Controls 集合之前创建新的 Control X 并开始添加到 X.Controls，则子控件可能不会继承正确的 UniqueID。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T10:34:59.633

我不认为 EnsureID 会解决您的问题，因为这只会为还没有的控件创建一个 ID。

正如艾伦指出的那样，您一遍又一遍地添加相同的控制。您需要创建新控件，这将为您提供新的 ID。您还为已引用的控件调用 FindControl...？如果需要，从现有控件中复制数据，但不要重复添加现有控件。对于文字，可能唯一有价值的是文本？因此，将您的代码更改为：

```
Literal ItemCode = (Literal)additionalServices[cell - 1].FindControl("ltlItemCode") as Literal;
ItemCode.Text = reader_list["itemDescription"].ToString();

Literal ItemCode2 = new Literal();  //create a new control
ItemCode2.Text = ItemCode.Text;     //copy the data you need

TableCell ItemCodeCell = new TableCell();
ItemCodeCell.Controls.Add(ItemCode2);  // add new control 
```

# iphone - iPhone OS 版本 AppStore 部署

> ID：552928
> 
> 赞同：1
> 
> 时间：2009-02-16T10:52:16.933
> 
> 标签：iphone, xcode, app-store

我的问题与不同版本的 iphone 请求应用程序时的 iphone appstore 部署处理部署有关。此外，是否必须为每个版本（即 2.0、2.1 和 2.2）提交构建。我已经为 Windows mobile 开发并根据他们使用的 windows mobile 平台将用户重定向到某个 url。在那里，他们只需下载并运行一个 cab 文件。

只是想弄清楚 App Store 部署过程是如何工作的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-16T11:06:53.667

它的工作方式是提交使用 SDK 版本 X 构建的应用程序。如果应用程序在他们的手机上运行 >= X，用户将只能下载 (iPhone) 或同步 (iTunes) 应用程序。

有几件事要记住；

1.  有许多固件升级的实例会破坏应用程序。因此，最好使用最新版本的 SDK 进行测试。
2.  在某些时候，Apple 很可能会将旧的 SDK 列入“黑名单”，并要求应用程序至少使用某个版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-22T01:44:27.057

您可以使用最新的 SDK（例如 2.2.1）来针对任何早期操作系统的手机，只要您不使用仅在更高版本的操作系统上可用的 API。

```
target OS   app generally works on
---------   ----------------------
2.0         2.2.1, 2.2, 2.1, 2.0
2.1         2.2.1, 2.2, 2.1
2.2         2.2.1, 2.2
2.2.1       2.2.1 
```

但是，如果您使用早期手机操作系统上不存在的 API，那么它将无法工作。例如，此页面上的 API 不适用于 OS 2.1（您需要登录才能查看该页面的内容。）：http: [//developer.apple.com/iphone/library/releasenotes/Miscellaneous/iPhone22APIDiffs/iPhone21_iPhone22_APIDiffs .html](http://developer.apple.com/iphone/library/releasenotes/Miscellaneous/iPhone22APIDiffs/iPhone21_iPhone22_APIDiffs.html)

# nhibernate - 奇怪的 NHibernate 异常

> ID：552933
> 
> 赞同：0
> 
> 时间：2009-02-16T10:52:59.643
> 
> 标签：nhibernate, nhibernate-mapping

当我尝试创建 SessionFactory 时，我遇到了一个奇怪的 NHibernate 异常。我已将异常'无法将'NHibernate.Mapping.Bag'类型的对象转换为'NHibernate.Mapping.IKeyValue'的异常范围缩小到公司对象上的以下映射：

```
<bag name="Images" cascade="none">
  <key column="CompanyId" property-ref="Images"/>
  <one-to-many class="GwDbImage"/>
</bag> 
```

这是 GwDbImage 的映射：

```
<class name="GwDbImage" table="Images" >
<id name="ImageId">
  <column name="ImageId" sql-type="int" not-null="true"/>
  <generator class="native"/>
</id>

<property name="FileName"  /> 
```

Company对象上Images的定义如下：

```
public virtual IList<GwDbImage> Images { get; set; } 
```

我知道这很模糊，但有人知道出了什么问题/指出我正确的方向吗？

谢谢

乔恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-16T10:57:11.867

您将 Images 属性声明为 IDictionary 而 bag 应声明为 IList

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T11:07:42.090

为什么要指定 property-ref 属性？你的情况有必要吗？您是否在相关表中加入了除您的 PK 之外的另一列？

# artificial-intelligence - 感知器可以用来检测手写数字吗？

> ID：552940
> 
> 赞同：9
> 
> 时间：2009-02-16T10:55:09.950
> 
> 标签：artificial-intelligence, ocr, neural-network, pattern-recognition, perceptron

假设我有一个小位图，其中包含一个手写数字（0..9）。

是否可以使用（两层）感知器检测数字？

除了使用神经网络之外，还有其他方法可以从位图中检测单个数字吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-16T11:02:38.670

这是一个巨大的手写数字数据库的链接。头版还包含许多不同方法的相关性能数据，包括 2 层神经网络。这应该给你一个好的开始： [MNIST 数字数据库和性能](http://yann.lecun.com/exdb/mnist/)

您可能还想查看[Geoff Hinton 在 Restricted Boltzmann Machines 上的工作](http://www.cs.toronto.edu/~hinton/MatlabForSciencePaper.html)，他说它的性能相当不错，并且在他的网站上有一个很好的解释性讲座（非常值得一看）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-16T11:27:30.717

将位图的每个像素直接输入到神经网络中需要大量的训练，并且不能很好地处理图像的缩放或旋转。

为了帮助神经网络进行良好的分类，您需要执行一些预处理步骤。

*   标准化图像：
    *   调整对比度和亮度，使图像的直方图与参考图像匹配。
    *   模糊图像，去除噪点。
    *   使用一些阈值将其转换为黑白。
    *   找到形状的边界框，缩放到预定义的大小。
*   计算可用于区分一个数字和另一个数字的图像的各种特征：
    *   图像的[欧拉数](http://en.wikipedia.org/wiki/Euler_number_(topology))——告诉你形状中有多少个“孔”（例如数字 8 的两个孔）。
    *   白色像素的数量（数字的面积）
    *   白色像素坐标组的[主成分](http://en.wikipedia.org/wiki/Principal_components_analysis)——告诉你形状有多“拉长”。
    *   ...您可以想到的其他功能往往具有相似数字的相似值。

主成分也可用于对形状的旋转进行归一化，从而使最长轴是垂直的。

这些特征是您输入神经网络进行分类的内容，而不是像素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T11:03:05.970

这是一个[Matlab 示例程序](http://www.sfu.ca/~vwchu/digitrecognition.html)，它使用经过训练的神经网络来检测单个数字（图像大小固定为 28*28）。

# c++ - WSACleanUp 导致异常

> ID：552948
> 
> 赞同：0
> 
> 时间：2009-02-16T10:59:27.367
> 
> 标签：c++, sockets, wsastartup, windows-socket-api, wsacleanup

我的应用程序可以在串行和套接字连接之间切换，但不能同时打开。因此，当我尝试在 Socket 和 Serial 之间切换时，我删除了 Socket 连接。

[基于套接字的对象使用一个名为 UsesWinsock 的私有类（在这里向Len Holgate](https://stackoverflow.com/users/7925/len-holgate)大声喊叫，因为它基本上是他的代码（实际上是 RAII，但我从未将它应用于 WSA，直到我看到他这样做））。这只是调用 WSAStart 和 WSACleanUp。

当 WSACleanUp 被调用时，它会进入 NTDLL 和汇编程序。@err,hr 给我“传递给系统调用的数据区域太小”作为 HRESULT。

我尝试过移动代码：按照继承顺序移动类会导致破坏序列发生变化，并且实际上破坏了函数，因此它们是破坏序列中最后被调用的东西。都没有奏效。

我很确定我已经释放了所有分配的东西（只有 1 个套接字和几个事件）并且我被卡住了 - 这对我来说是一个相当重要的问题。

[谷歌返回 4 个结果没有帮助解决我的问题](http://www.google.com/search?hl=en&q=%22The+data+area+passed+to+a+system+call+is+too+small%22+WSACleanUp&btnG=Search)。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T11:17:22.347

那么，您是否按原样使用我的 UsesWinsock 类？也就是说，你是说它坏了吗？如果是这样，直接给我发电子邮件可能是解决问题的更有效方法；）

我注意到我的代码实际上并没有检查 dtor 中 WSACleanUp() 的返回码，所以，我假设您正在检查它，它是 SOCKET-ERROR 并且 WSAGetLastError() 正在报告 ERROR-INSUFFICIENT-BUFFER ？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T19:26:56.250

如果您在 Windows 调试器中使用 wt“跟踪和监视数据”命令，我很想知道您会发现什么：

在 WSACleanup 的开头设置断点：

```
bp ws2_32!wsacleanup

```

一旦命中，发出跟踪命令：

```
重量 -oa -oR @$ra

```

并注意对 ntdll!RtlSetLastWin32Error 的调用

你也可以在这里发布调查结果，看看它们会很有趣。

# apache-flex - Flex DateChooser：如何覆盖“今天”日期？

> ID：552950
> 
> 赞同：3
> 
> 时间：2009-02-16T11:00:16.913
> 
> 标签：apache-flex

默认情况下，Flex DateChooser 突出显示“今天”日期。我假设它从操作系统获得这个日期。有没有办法告诉 DateChooser '今天' 日期应该是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T11:15:32.367

通过查看`mx.controls.CalendarLayout`（内部使用`DateChooser`）的源代码：

```
// Determine whether this month contains today.
var today:Date = new Date();
var currentMonthContainsToday:Boolean = (today.getFullYear() == newYear && today.getMonth() == newMonth); 
```

看来你对此没有影响。当然，您可以扩展/替换`DateChooser`and`CalendarLayout`类，并覆盖相关函数。

# jquery - 如何使我的 jquery 可拖动/可放置代码更快？

> ID：552951
> 
> 赞同：13
> 
> 时间：2009-02-16T11:00:46.833
> 
> 标签：jquery, browser, performance

我使用 JQuery 使表格中的元素可拖动。（在此之前我从未使用过 JQuery）。它工作正常，但速度*很*慢。例如，从我单击并按住一个项目的那一刻起，到光标发生变化的那一刻，大约是 2 秒。这是在 Firefox 3.0.6 上。一旦项目被拖动，在我放开鼠标按钮和明显发生下降之间会有更短但仍然明显的延迟（我估计大约半秒）。

我怀疑它这么慢的原因是因为表很大（6 列和大约 100 行），但在我看来它并不大，我想知道我正在做的事情是不是很愚蠢让它这么慢。例如，我想知道每次拖动某些东西时是否将 JQuery 代码毫无意义地应用于表中的每个元素。不过，我不知道为什么会这样。

如果有帮助，这是我的代码（请注意，我已经取消了光标调用，因为我担心它可能会减慢速度）。

```
<script type='text/javascript'>
  $(document).ready
  (
    function()
    {
      $('.draggable_div').draggable
      (
        {
          start: function(event, ui)
          {
            $(this).css('background-color','#ddddff');
          }
        }
      );
      $('.draggable_td').droppable
      (
        {
          over: function(event, ui)
          {
            $(this).css('background-color', '#ccffcc');
          },
          out: function(event, ui)
          {
            $(this).css('background-color', null);
          },
          drop: function(event, ui)
          {
             // snip: removed code here to save space. 
          }
        }
      );
    }
  );
</script> 
```

HTML 表是这样的（由 PHP 生成）：

```
<table id='main_table' border=0>
<tr>
  <th width=14.2857142857%>0</th>
  <th width=14.2857142857%>1</th>
  <th width=14.2857142857%>2</th>
  <th width=14.2857142857%>3</th>
  <th width=14.2857142857%>4</th>
  <th width=14.2857142857%>5</th>
  <th width=14.2857142857%>6</th>
</tr>
<tr>
  <td class=draggable_td id='td:0:0:'>
  <div class=draggable_div id='div:0:0:1962'>
    content
  </div>
  </td>
  <td class=draggable_td id='td:0:1:1962'>
  <div class=draggable_div id='div:0:1:14482'>
    content
  </div>
  </td>
  <!-- snip: all the other cells removed for brevity -->
</tr>
<!-- snip: all the other rows removed for brevity -->
</table> 
```

（注意：它似乎在 IE 7 中根本不起作用，所以也许我在这里做错了什么......）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-19T22:32:11.390

如此多的放置目标的存在似乎使性能如此缓慢。如果可能，尝试将表格设置为单个放置目标，并根据放置事件中的位置数据计算目标表格单元格。

不幸的是，您还将失去在 dragOver 和 dragOut 事件上将样式应用于单个单元格的能力。

编辑：另一个建议是在所有 tds 上禁用 droppable，并在鼠标悬停 tr 时，启用特定 tr 中存在的 tds 的 droppables（并在鼠标移出 tr 时禁用它们）。听起来像一个黑客，但值得一试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T00:47:25.753

我不认为它与 addClasses ？ *如果设置为 false，将阻止添加 ui-droppable 类。当在数百个元素上调用 .droppable() init 时，这可能需要作为性能优化。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T04:37:19.333

第一步，仔细检查您使用的是最新版本的 jQuery。我记得，他们最近开始使用更快的浏览器 api（如果可用）来获取显示中 dom 元素的位置。我认为这在 John Resig 最近的一次演示中提到了，拖放是性能改进的主要演示。

# c++ - Linux 应用程序中记录器的建议

> ID：552956
> 
> 赞同：3
> 
> 时间：2009-02-16T11:04:05.670
> 
> 标签：c++, linux, logging

我正在构建一个 C++ Linux 应用程序，我需要记录它的活动。创建日志的现有 Linux 工具有哪些？你会推荐什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-16T11:05:49.893

历史上的一个是 syslog(3)。从 C:

```
#include <syslog.h>
openlog("myprogram", LOG_PID, LOG_LOCAL0);
syslog(LOG_INFO, "data %d %s", 3, "example"); 
```

来自 Perl：

```
use Sys::Syslog;
openlog "myprogram", "pid", "local0";
syslog 'info', 'data %d %s', 3, 'example'; 
```

从外壳：

```
logger -p local0.info -t myprogram -- data 3 example 
```

syslogd 守护进程可以配置为将日志文件放在不同的位置（文件、tty、其他机器），具体取决于设施（此处`LOG_LOCAL0`）和优先级（此处`LOG_INFO`）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-16T11:17:42.113

[log4cxx](http://logging.apache.org/log4cxx/index.html)怎么样？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T11:32:32.013

除了 Alex 所说的之外，您为什么需要 Linux 特定的记录器？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-21T05:24:45.437

我建议您试用 c-log，这是一个用于 C/C++ 语言的快速、稳定且线程安全的日志库（记录器），[https://github.com/0xmalloc/c-log](https://github.com/0xmalloc/c-log)。

# php - SimpleXMLElement 在 addChild 和 addAttribute 中处理文本值的基本原理

> ID：552957
> 
> 赞同：43
> 
> 时间：2009-02-16T11:04:23.533
> 
> 标签：php, xml

这不是一种不一致的行为吗？(PHP 5.2.6)

```
<?php

$a = new SimpleXMLElement('<a/>');

$a->addAttribute('b', 'One & Two');
//$a->addChild('c', 'Three & Four'); -- results in "unterminated entity reference" warning!
$a->addChild('c', 'Three &amp; Four');
$a->d = 'Five & Six';

print($a->asXML()); 
```

渲染：

```
<?xml version="1.0"?>
<a b="One &amp; Two">
    <c>Three &amp; Four</c>
    <d>Five &amp; Six</d>
</a> 
```

在 bugs.php.net，他们拒绝所有关于此的提交，称这是一项功能。为什么会这样？顺便说一句，文档中没有关于 SimpleXMLElement 转义文本值的差异。

谁能说服我这是最好的 API 设计决策？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-02-16T23:35:48.500

为了确保我们在同一页面上，您有三种情况。

1.  使用 addAttribute 将 & 符号插入到属性中

2.  使用 addChild 将 & 符号插入元素

3.  通过属性重载将 & 符号插入元素

2和3之间的差异让你感到困惑。为什么 addChild 不会自动转义 & 符号，而向对象添加属性并设置其值**会**自动转义 & 符号？

基于我的直觉，并受到[这个错误](http://bugs.php.net/bug.php?id=45253&edit=1)的鼓舞，这是一个深思熟虑的设计决定。属性重载 ($a->d = 'Five & Six';) 旨在成为“我的转义符”的做事方式。addChild 方法的意思是“添加我告诉你添加的内容”方法。因此，无论您需要哪种行为，SimpleXML 都能满足您的需求。

假设您有一个文本数据库，其中所有 & 符号都已转义。自动转义在这里对你不起作用。那就是您要使用 addChild 的地方。或者假设您需要在文档中插入一个实体

```
$a = simplexml_load_string('<root></root>');
$a->b = 'This is a non-breaking space &nbsp;';
$a->addChild('c','This is a non-breaking space &nbsp;');    
print $a->asXML(); 
```

这就是那个 bug 中的 PHP 开发人员所提倡的。addChild 的行为旨在提供“更简单，更强大”的支持，当您需要在文档中插入 & 符号而不对其进行转义时。

当然，这确实给我们留下了我提到的第一种情况，addAttribute 方法。addAttribute 方法**会**转义 & 符号。因此，我们现在可以将不一致声明为

1.  addAttribute 方法对 & 符号进行转义
2.  addChild 方法**不会**转义 & 符号
3.  这种行为有些不一致。用户期望 SimpleXML 上的**方法**以一致的方式转义是合理的

这暴露了 SimpleXML api 的真正问题。这里的理想情况是

1.  元素对象上的属性重载转义 & 符号
2.  属性对象上的属性重载转义 & 符号
3.  addChild 方法不会转义 & 符号
4.  addAttribute 方法不会转义 & 符号

但是这是不可能的，因为 SimpleXML 没有属性对象的概念。addAttribute 方法是（似乎是？）添加属性的唯一方法。因此，事实证明（似乎？）SimpleXML 无法使用实体创建属性。

所有这些都揭示了**简单**XML 的悖论。这个 API 背后的想法是提供一种与复杂事物交互的简单方式。

团队本可以添加一个 SimpleXMLAttribute 对象，但这增加了一层复杂性。如果您想要一个多对象层次结构，请使用 DomDoument。

团队本可以在 addAttribute 和 addChild 方法中添加标志，但标志会使 API 更加复杂。

真正的教训在这里？也许就是这么简单就很难，而在最后期限内简单就更难了。我不知道是不是这样，但是对于 SimpleXML，似乎有人从一个简单的想法开始（使用属性重载使 XML 文档的创建变得容易），然后随着问题/功能请求的出现进行调整.

实际上，我认为这里真正的教训是只使用 JSON ;)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-09-28T12:51:27.320

这是我的解决方案，尤其是这解决了添加多个具有相同标签名的孩子

```
$job->addChild('industrycode')->{0} = $entry1;
$job->addChild('industrycode')->{0} = $entry2;
$job->addChild('industrycode')->{0} = $entry3; 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2010-04-15T13:33:34.600

“假设你有一个文本数据库，其中所有的 & 符号都已经被转义了。”

如果你这样做，那你就错了。数据应该以最准确的形式存储，而不是针对您当前使用的任何类型的输出。如果您实际上在数据库中存储（有效）HTML 的 blob，情况会更糟。使用 addChild() 并再次获取数据会破坏您的 HTML；没有任何明智的图书馆表现出如此可怕的不对称性。

addChild() 不为您编码文本是完全违反直觉的。API 中不能保护您免受此影响的意义何在？如果您在其中一个值中使用双引号，这就像 json_encode() barfing。

无论如何，回答最初的问题：显然，我也认为这不是一个好的决定。我确实认为这与 PHP 的许多设计决策是一致的，即实现某人关于什么是“更快”的想法，而不是正确的。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-16T14:55:49.983

**如前一个答案所述，转义字符的要求在字符数据`&`和[标记](http://www.w3.org/TR/REC-xml/#syntax)`<`部分中提供，而不是在属性值规范化部分中提供**。

**[引用 XML Spec](http://www.w3.org/TR/REC-xml/#syntax)。**：

“与符号 (&) 和左尖括号 (<) 不得以其文字形式出现，除非用作标记分隔符，或者在注释、处理指令或 CDATA 部分中。如果在其他地方需要它们，它们必须分别使用数字字符引用或字符串`&amp;`和“进行转义`&lt;`”

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-11-08T03:07:13.383

Alan Storm 对这个问题有很好的描述，但是对于他描述的悖论有一个简单的解决方案。addChild() 方法可以有一个可选的布尔参数，用于确定是否自动转义字符。所以，我仍然相信这只是一个（非常）糟糕的设计选择。

addChild() 方法的文档没有提供任何参考，因此问题更加复杂（尽管正在讨论中）。此外，该方法转义*了一些*字符（即小于和大于符号）。这将误导使用该方法的开发人员相信它通常会转义字符。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-16T11:13:13.527

我相信这是由XML 规范要求 的[属性值规范化引起的。](http://www.w3.org/TR/REC-xml/#AVNormalize)

# c++ - 通过 IE 控件禁用 IE 脚本调试

> ID：552960
> 
> 赞同：1
> 
> 时间：2009-02-16T11:06:14.183
> 
> 标签：c++, debugging, internet-explorer, screen-capture

呜呜；知道如何提出问题总是最难的，所以我再解释一下。

我正在使用 CAxWindow 在内部创建一个 IE 窗口并通过字符串类参数传入 URL：

```
CAxWindow wnd;
m_hwndWebBrowser = wnd.Create(m_hWnd, rect, m_URI, WS_CHILD|WS_DISABLED, 0); 
```

它是任何人都可以从他们的“内部”基于 javascript 的应用程序中获取图像的自动化实用程序的一部分；问题是有些人试图从他们的应用程序中获取有很多错误的图像；错误触发 IE 调试窗口，我的捕获实用程序等待输入。

最初我以为我可以通过 Windows 中的 IE 禁用调试功能，但是 Apache 运行的进程，因此我的应用程序是通过 SYSTEM 帐户；不知道如何在不破解注册表的情况下更改调试选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T15:08:02.403

将您的应用与[detours](http://research.microsoft.com/en-us/projects/detours/)或其他 API 挂钩库、`RegQueryValue`advapi32 中的挂钩函数链接，并在 IE 查询注册表键值时返回“yes” `"HKCU\Software\Microsoft\Internet Explorer\Main\Disable Script Debugger"`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T14:33:20.973

是否可以将所有内容都包装在该 URL 的 CAxWindow 中显示的 JavaScript 代码中的 try / catch 中？希望这将使您消除所有错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T13:27:35.100

我在 CodeProject 上发现了一些类似的项目......

[http://www.codeproject.com/KB/shell/popupblocker.aspx?fid=15235&df=90&mpp=25&noise=3&sort=Position&view=Quick&fr=51&select=646577](http://www.codeproject.com/KB/shell/popupblocker.aspx?fid=15235&df=90&mpp=25&noise=3&sort=Position&view=Quick&fr=51&select=646577)

[http://www.codeproject.com/KB/shell/popupblocker2.aspx?df=100&forumid=15709&fr=51&select=548519#xx548519xx](http://www.codeproject.com/KB/shell/popupblocker2.aspx?df=100&forumid=15709&fr=51&select=548519#xx548519xx)

还有一篇关于 Web 浏览器定制的 MSDN 文章：

[http://msdn.microsoft.com/en-us/library/aa770041(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa770041(VS.85).aspx)

我发现我追求的是两个接口：IOleCommandTarget和IDocHostUIHandler；我需要重写 UI 处理程序并解释脚本异常消息并以“false”响应以表明我不关心错误；

不幸的是，我花了太多时间让我的头回到 COM 并试图设置他们的糟糕的系统，但我无法完成它，并且在与我的老板讨论了花更多时间试图让这个工作或只是在 IE 中禁用调试；我们选择了后者。

3个字；我讨厌 COM :-p（笑脸不算数）

我认为我所走的道路可以解决我遇到的问题，我的回答可以作为“答案”做出贡献；对不起，如果这不是你要找的。

# web-services - 如何在 Microsoft CRM 4.0 中添加和使用 Web 服务？

> ID：552961
> 
> 赞同：1
> 
> 时间：2009-02-16T11:06:25.197
> 
> 标签：web-services, dynamics-crm, dynamics-crm-4

我有我的自定义网络服务。我想在“创建帐户”表单中使用它。我正在使用“ **RemoteCommand** ”js 库来使用它。但我无法引用我的 Web 服务，因为“RemoteCommand”在“ **AppWebServices\MyService.asmx** ”中查找我的 Web 服务。如何自定义此路径？是否存在将我的 Web 服务集成到 Microsoft CRM 4.0 中的任何其他方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-04-02T21:45:40.837

`RemoteCommand`不是公共 SDK 的一部分。

了解如何在表单脚本中[访问 Web 服务。](http://msdn.microsoft.com/en-us/library/cc150839.aspx)

# java - 我可以将属性注入 JPA 实体侦听器吗

> ID：552968
> 
> 赞同：5
> 
> 时间：2009-02-16T11:10:52.677
> 
> 标签：java, jpa, jboss, ejb

我可以对此进行原型设计，看看会发生什么，但我很懒惰。我希望能够将 EJB3 注入到我的 JPA 实体侦听器中，以便它可以在 PrePersist 操作期间访问 EJB 的功能。那可能吗？如果不是......那么在 JBoss 下，监听器是创建一次，还是每次方法调用创建一次？我想我想了解每次调用在进行 JNDI 查找等方面的轻量级

任何人都知道有关这些主题的良好信息来源，因为我的简短谷歌搜索没有发现任何问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T01:25:23.313

您将不得不求助于 JNDI 查找来从您的 EntityListener 访问其他 EJB。我从未见过直接注入它们的方法——我认为这是因为 EntityListener 的语义。

*以下内容来自我使用 JBoss 4.0.x 和 4.2.x 的经验。*

例如，考虑@PostPersist——在执行插入语句**之后调用。**有两个问题需要考虑：

*   如果您打开另一个会话来查询它（即使使用 JNDI 查找），数据库将不会反映当前实体。**不能保证**事务会因为会话被刷新而被提交。您也不会拥有自动生成的主键。

*   除了更新托管字段或在提交之前验证数据完整性（与数据库触发器不同）之外，实体侦听器似乎没有任何用途，这严重限制了它们的实用性。具体来说，在 JBoss 中，您甚至无法查找当前的安全上下文来记录谁在进行更改。太糟糕了。

关于存在多少实体侦听器，我在 JBoss 4.2.x 中的经验是**只有一个实例存在**，并且方法是在容器线程的上下文中调用的。*但是，这在集群设置中可能并非如此。*无论哪种方式，我都建议您**不要**在任何实体侦听器中缓存您的引用——尚不清楚 JBoss 究竟会对它们做什么（钝化它们？我希望不会，但你永远不知道！）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T01:27:25.197

你用的是弹簧吗？如果是这样，您可以使用[@Configurable](http://static.springframework.org/spring/docs/2.5.x/reference/aop.html)并让该方面为您注入您的依赖项。

# java - 如何构建存储图片的对象？

> ID：552970
> 
> 赞同：1
> 
> 时间：2009-02-16T11:11:17.293
> 
> 标签：java

如果您正在构建一个对象来存储照片（对于像 photoshop 这样的程序），您将如何设计它？你会考虑哪些属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T11:14:56.567

我会考虑的主要事情之一是照片是否真的需要存储在对象中，或者您是否只需要指向文件、URL 或数据库的链接。照片往往会占用大量内存，因此在您真正需要显示之前将其保留在内存之外可能是一个不错的设计。

除此之外，我会考虑某种任意标记机制，并查看 JPEG 中已经存在的标记机制。

您可能想查看[EXIF](http://en.wikipedia.org/wiki/Exchangeable_image_file_format)，这是一种标签标准，以获得一些关于属性的想法。但是，新的结构一直在发明，因此与其为每种可能性都提供一个属性，更通用的基于 Map 的结构可能更适合您的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T11:28:31.930

您应该考虑像素格式（多少位以及如何分配它们）和配色方案（RGB、RGBA、CYMK、...）。您还应该考虑是否将其完全存储在一个对象中，或者是否最好将其保存在磁盘上并在需要时进行交换（通常您不会在 Photoshop 之类的程序中显示整个图像），因为图像可以相当大的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T11:28:38.343

正如@Nick 建议的那样，您打算存储的某些信息可能已经可以通过 EXIF 标签信息获得，具体取决于您的文件格式。除此之外，在详细说明所述图像的属性之前，识别使用图像对象的上下文会很有帮助。

但是，我想到了一些通用的图像属性：

*   标题
*   关键字/搜索字符串
*   描述
*   作者信息
*   创建日期
*   文件格式
*   宽度
*   高度
*   位置/来源/网址
*   以 dpi 为单位的分辨率（水平/垂直）
*   位深
*   层数
*   颜色计数

...等等。

# linux - top 命令的 CPU 使用率计算

> ID：552976
> 
> 赞同：6
> 
> 时间：2009-02-16T11:14:29.750
> 
> 标签：linux, cpu, gnu-coreutils, top-command

我正在尝试使用 GNU coreutil top 的公式来计算 CPU 使用率的百分比。但是 top 使用一些 half_total 来计算百分比，即在百分比上增加 0.5。

在 top 的[source](http://downloads.sourceforge.net/unixtop/top-3.8beta1.tar.gz?modtime=1210117842&big_mirror=0)的 utils.c 中，以下行（在 3.8 beta1 中，在行号：459 中）：-

*out++ = (int)((*diffs++ * 1000 + half_total) / total_change);

这转换为： ( (*diffs++ * 1000) / total_change ) + 1/2 所以，它总是给出一个数字，即：“10 倍百分比，加上 0.5”。所以如果百分比是 x，它将返回 10x+0.5。

谁能解释这个平均值是如何计算的？或者至少有一些我可以得到帮助的指针？

PS：为什么我们不能只用`(*diffs++/total_change) * 100`得到所需的百分比？

Top的源代码位于：- [http://downloads.sourceforge.net/unixtop/top-3.8beta1.tar.gz?modtime=1210117842&big_mirror=0](http://downloads.sourceforge.net/unixtop/top-3.8beta1.tar.gz?modtime=1210117842&big_mirror=0)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-16T11:18:17.557

这是对整数值进行**舍入**的方法，因为除法会丢弃小数部分。

当您添加除数的一半时，这相当于浮点除法，如果小数部分为 0.5 或更大，则四舍五入。

# wcf - 将 WCF .svc 文件转换为 .asmx 文件

> ID：552977
> 
> 赞同：1
> 
> 时间：2009-02-16T11:14:41.293
> 
> 标签：wcf, web-services, asmx, visual-c++

我有一个 WCF 服务。我有一个只能读取*.asmx 文件*的外部软件。是否可以*在相应的 .asmx 中转换我的 .svc 文件*？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T18:19:26.630

“只读取 .asmx 文件的软件”没有意义。没有软件读取 .asmx 文件或 .svc 文件 - 这两种类型都在服务器上进行解释，并且永远不会返回给客户端。

我认为您需要更深入地了解这个外部软件真正想要什么。如果它关心 URL 中的文件类型，那将完全是脑死亡！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T11:24:09.727

我认为从 wcf 转换为 asmx 并不是很直接，因为您基本上会回到技术上。我想最简单的选择是编写一个 asmx webservice，它公开与 wcf 服务相同的方法并充当 wcf 服务的代理。

这样，您的外部软件可以调用 asmx 服务，而且任何新的东西都可以使用 wcf 服务。这样，您可以将逻辑保存在一个地方，但两者都可以从更新等中受益。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-12-18T06:13:17.950

为什么要转换，保留 wcf(.svc) 和 Web 服务 (.asmx) 只需按照步骤操作即可。

1.  转到您的 WCF 项目，右键单击并添加新项目并选择 Web 服务 (.asmx) 文件并展开该新文件并删除内部文件并保留 .asmx 文件。
2.  打开那个 .asmx 文件，你会发现 `<%@ WebService Language="C#" Debug="true" Class="{full name of web service class}" %>`

将其替换为

```
<%@ WebService Language="C#" Debug="true" Class="full name of wcf class(.cs file not interface)" %> 
```

3.  最后一步在接口上添加服务合同、Web 服务和 Web 服务绑定属性，如下所述

    [ServiceContract(Namespace = "namespacename")] [WebService(Name = "wcf class name")] [WebServiceBinding(Name = "wcf class name", ConformsTo = WsiProfiles.BasicProfile1_1, EmitConformanceClaims = true)]

并在界面的每个方法声明上添加 web 方法属性。

就是这样，现在您可以公开文件 .asmx 文件用于 Web 服务客户端 .svc 用于 WCF 客户端

谢谢你

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-29T10:45:17.693

如果服务很小，那也不是很难。

可以用 WCF 和 ASMX 属性来装饰一个类。然后在 ASMX 文件和 WCF 文件中引用该类。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-02T02:21:50.623

我猜外部软件实际上是在读取由 asmx 文件生成的 WSDL，并且不支持公开的协议。一定要检查这个软件有什么级别的 SOAP 支持，并相应地调整你的 wcf 服务。

# javascript - 得到一个类似的字符串放电其余的

> ID：552979
> 
> 赞同：0
> 
> 时间：2009-02-16T11:15:04.413
> 
> 标签：javascript, regex

想知道你是否可以用一些 Javascript 帮助我。我有一个字符串是日志消息，我想从这个日志中抓取一个部分并自行显示

例如（请记住，日志部分不区分大小写，任何字母都可以是任何大小写，也可以放在字符串的任何位置）

**$LOG: 08880xbpnd $ fhdsafidsfsd df sd fsd f sd fsd**

那是原始日志，我想抓住 08880xbpnd 并摆脱其余的？这怎么能在javascript中完成？

编辑

如果这有任何帮助，我在 perl 中有这个正则表达式，它可以在其他地方抓取日志

/(?i)\$LOG:\s*(none|(temp(GD|MD)(.\d{1,2}){4}))\s*\$/

基本上在 $LOg: 和 $ 之间有什么我想抓取并排除任何介于两者之间的空白空间可以是任何值或高于

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T11:59:31.107

我会使用这个正则表达式：

```
/\$LOG:([^$]+)\$/i 
```

所以：

```
"$LOG: 08880xbpnd $ fhdsafidsfsd df sd fsd f sd fsd".match(/\$LOG:([^$]+)\$/i) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T11:59:12.700

这对我有用：

```
<script type="text/javascript">
  // Call the function with a sample input string.
  GetMyLog("$LOG: 08880xbpnd $ fhdsafidsfsd df sd fsd f sd fsd");

  function GetMyLog(fullString)
  {
    // Create a Regex object. We want to capture all word-like characters within the $LOG and ending $
    // This assumes that there will not be any more "$" characters in the trailing string.
    var reg = /\$LOG:\s*([\w]+)\s*\$/;

    // If the match attempt was successful, we need to get the second value in the array returned by the match.
    if (fullString.match(reg))
    {
      alert(reg.exec(fullString)[1]);
    }
  }
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T11:55:01.883

马修，

以下正则表达式应该为您提供**$LOG:**和**$**反向引用**\1之间的任何内容**

```
\$LOG:(.*?)\$ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T12:04:48.613

我不会使用正则表达式，您的情况很简单，也许使用子字符串可以提高速度。

尝试使用这样的东西：

```
function getToken(logline, startTag, endTag) {
  return logline.substring(startTag.length,logline.indexOf(endTag,1));
} 
```

回应评论的新版本：

```
function getToken(logline, startTag, endTag) {
  result =""; 
  if ( logline.indexOf(startTag)>=0) 
    result= logline.substring(startTag.length,logline.indexOf(endTag,1));
  return result;  
} 
```

# java - 如何为所有经过身份验证的用户授予访问权限？

> ID：552982
> 
> 赞同：0
> 
> 时间：2009-02-16T11:16:24.707
> 
> 标签：java, spring-security

需要使用 Spring Security 向没有任何角色的用户授予访问权限。必须授予任何人如何处理身份验证才能访问任何 URL。那么我可以通过这样的方式做到这一点，或者可能是其他方式吗？

```
<http auto-config='true'>
  <intercept-url pattern="/**" access="ALL" />
  <intercept-url pattern="/login.jsp" filters="none" />
  <form-login login-page="/login.jsp" />
</http> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-16T12:44:36.740

您可能正在寻找 IS_AUTHENTICATED_FULLY 或 IS_AUTHENTICATED_REMEMBERED 或 IS_AUTHENTICATED_ANONYMOUSLY

还要检查[http://www.acegisecurity.org/acegi-security/apidocs/org/acegisecurity/vote/AuthenticatedVoter.html](http://www.acegisecurity.org/acegi-security/apidocs/org/acegisecurity/vote/AuthenticatedVoter.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T16:18:55.157

实际上，您只需要创建自己的 AccessDecisionManager 和自己的 AccessDecisionVoter(s) 并将它们传递到块中，如下所示：

```
<http .... access-decsion-manager="myAccessManager">
  .....
</http>

<bean id="myAccessManager" class="org.springframework.security.vote.AffirmativeBased">
   <property name="decisionVoters">
      <list>
         <bean id="myVoter" class=[some subclass of AccessDecisionVoter] />
      </list>
   </property>
</bean> 
```

这不是 100% 的解决方案，但它应该让您走上正确的道路。Spring Security 中的“自动配置”设置在后台创建了很多这样的类，如果没有其他可用的正确类的 bean，则会自动加载它们。

# .net - 我们在 WinForm 的被动视图中在哪里实例化视图和演示者？

> ID：552983
> 
> 赞同：3
> 
> 时间：2009-02-16T11:16:25.347
> 
> 标签：.net, winforms, mvp

我是被动视图的新手，我想知道我们是否有关于 WinForm 应用程序的主表单和详细表单。因此，当用户单击主按钮时，它将显示详细信息表单。我们在哪里实例化视图和演示者？我不认为，我们在表单后面的代码中实例化。但是如果我们在presenter的方法上实例化，这意味着我们将我们的presenter与表单视图耦合起来。是否有用于构建 WinForm 应用程序 .Net 的被动视图的好的示例或框架？

# opengl - 黄色三角形应该是 3 种颜色的 OpenGL

> ID：552987
> 
> 赞同：1
> 
> 时间：2009-02-16T11:19:05.433
> 
> 标签：opengl, 3d, geometry

这可能是一个愚蠢的错误，但我看不到？！我有定义几何的类和渲染该几何的类。现在它是每个顶点的基本三角形和颜色。

这是定义所述几何对象数据的代码：

```
CGeometry* g = new CGeometry();
g->vertexes = new double[3*3];

g->vertexes[0] = 0;
g->vertexes[1] = 0;
g->vertexes[2] = 0;

g->vertexes[3] = 100;
g->vertexes[4] = 100;
g->vertexes[5] = 0;

g->vertexes[6] = 100;
g->vertexes[7] = 0;
g->vertexes[8] = 0;

g->colors = new double[12];

g->colors[0] = 1;
g->colors[1] = 1;
g->colors[2] = 0;
g->colors[3] = 1;

g->colors[4] = 1;
g->colors[5] = 0;
g->colors[6] = 1;
g->colors[7] = 0;

g->colors[8] = 0;
g->colors[9] = 1;
g->colors[10] = 1;
g->colors[11] = 0; 
```

这是呈现所述数据的代码：

```
CGeometry* g = object->geometry;

int j = object->endIndex - object->startIndex;
double* vertexes = g->vertexes;
double* colors = g->colors;

glBegin(GL_TRIANGLES);
{
    for(int i = 0; i < j; i++){
        int coord = object->startIndex+i;
        int colorind = coord*4;

        double r,g,b,a;
        r = colors[colorind];
        g = colors[colorind+1];
        b = colors[colorind+2];
        a = colors[colorind+3];

        glColor4d(  r,g,b,a);
        glVertex3d( vertexes[coord*3],
                    vertexes[coord*3+1],
                    vertexes[coord*3+2]);
    }
}
glEnd(); 
```

然而，无论我放什么，我的三角形总是黄色的，或者颜色数组中第一种颜色的值。我已经进入调试器并检查了每个单独循环迭代的值，并且 rgb 和变量的值确实相应地发生了变化，并且并不总是黄色，但结果是一个黄色三角形。

但是，如果我从 neheGL 教程中获取以下内容：

```
glClearColor(0.1f,0.1f,0.1f,1);
glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); // Clear Screen And Depth Buffer
glLoadIdentity();                                   // Reset The Current Modelview Matrix
//glTranslatef(1.5f,0.0f,0.0f);                     // Move Left 1.5 Units And Into The Screen 6.0
glBegin(GL_TRIANGLES);                              // Drawing Using Triangles
    glColor3f(1.0f,0.0f,0.0f);                      // Set The Color To Red
    glVertex3f( 0.0f, 1.0f, 0.0f);                  // Top
    glColor3f(0.0f,1.0f,0.0f);                      // Set The Color To Green
    glVertex3f(-1.0f,-1.0f, 0.0f);                  // Bottom Left
    glColor3f(0.0f,0.0f,1.0f);                      // Set The Color To Blue
    glVertex3f( 1.0f,-1.0f, 0.0f);                  // Bottom Right
glEnd();                                            // Finished Drawing The Triangle
glTranslatef(160.0f,0.0f,0.0f);                     // Move Right 3 Units
glColor3f(0.5f,0.5f,1.0f);                          // Set The Color To Blue One Time Only
glBegin(GL_QUADS);                                  // Draw A Quad
    glVertex3f(-1.0f, 1.0f, 0.0f);                  // Top Left
    glVertex3f( 1.0f, 1.0f, 0.0f);                  // Top Right
    glVertex3f( 1.0f,-1.0f, 0.0f);                  // Bottom Right
    glVertex3f(-1.0f,-1.0f, 0.0f);                  // Bottom Left
glEnd(); 
```

我得到一个很好的混合三角形，每个顶点有 3 种颜色

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-16T13:52:10.290

实际上，我想我明白了：您只看到三角形左下角的一小部分。您需要离开它才能完全查看它：您的坐标太大。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T11:33:50.780

第二种和第三种颜色的 alpha 值设置为零，因此它们是完全透明的。第一种颜色的 alpha=1 并且是在生成的三角形中唯一可以看到的颜色...

# visual-studio-2005 - 如何强制报表查看器以打印预览模式显示

> ID：552988
> 
> 赞同：10
> 
> 时间：2009-02-16T11:19:06.383
> 
> 标签：visual-studio-2005, .net-2.0, reportviewer, rdlc

在 Visual Studio 2005 中，如何在打印预览模式下直接在 ReportViewer 控件中显示报表？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-16T11:50:39.413

使用`SetDisplayMode()`方法：

```
MyReportViewer.SetDisplayMode(DisplayMode.PrintLayout); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-27T02:44:32.280

在 Windows 窗体应用程序中，如果您在 reportviewer 的 RenderingComplete 事件中调用 SetDisplayMode 方法，可能会导致 StackOverflowException。调用该方法的位置不正确。

# asp.net - ASP 输出包围 标签？

> ID：552989
> 
> 赞同：0
> 
> 时间：2009-02-16T11:19:14.310
> 
> 标签：asp.net

简单地，

在 Visual Studio 中创建新的 aspx 页面时，它会自动添加如下标签：

```
<form id="form1" runat="server"> 
```

是否需要这些表单标签来包装页面的整个 HTML 输出？例如：

```
<body>
<form id="form1" runat="server">
HTML GOES HERE
</form>
</body> 
```

还是可以将它们放在您需要实际表格的地方？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-16T11:24:13.033

只需将表单标记放置在任何 ASP.NET 服务器控件周围。如果它们只存在于实际形式中，或者您没有使用任何形式，那么可以这样做。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-16T11:26:39.750

简单/简单的答案是 - 如果您想使用 .NET 服务器控件，那么它们需要在`<form runat="server">`块内。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T11:27:33.447

提供您想要发回服务器的所有内容都在表单标签内（包括视图状态、隐藏字段、普通 html 表单控件），然后您可以将 html 放在它们的上方和下方。但对于初学者，我建议您将所有 html 放在它们之间以保持简单。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T11:27:40.047

此外，它必须是页面上*唯一*的表单。如果您确实需要使用单个表单，请使用按钮的 PostbackUrl。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-16T11:28:21.633

基本上是的，但在极端情况下没有。ASP.NET 使用表单元素来处理诸如视图状态、会话、客户端绑定之类的事情。这也是为什么一个页面上不能有两个表单的原因。

# google-search-appliance - 是否实时添加了 Google Search Appliance 供稿？

> ID：552993
> 
> 赞同：0
> 
> 时间：2009-02-16T11:21:08.923
> 
> 标签：google-search-appliance

使用内容馈送将文档馈送到 Google Search Appliance 后多久可以在搜索结果中看到该文档？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T15:58:38.667

好吧，根据我自己的经验，它似乎在 1 到 10 分钟之间变化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-05-31T15:28:48.260

我通常会在大约 5 分钟后看到我的出现，但有时可能是一个小时。这取决于您的提要进入时 GSA 正在处理什么。如果它正在抓取其他页面，则可能需要一段时间。这是我们无法控制的事情之一。如果让事情更快地显示很重要，请尝试将您的网站抓取和数据馈送安排在不同的时间。

# delphi - Delphi动态创建子菜单

> ID：552995
> 
> 赞同：3
> 
> 时间：2009-02-16T11:22:01.867
> 
> 标签：delphi, event-handling, menu

我有一个弹出菜单，我希望其中一个项目打开一个带有动态创建列表的子菜单（它是用户定义的标志列表）。这是我创建菜单项的方式（`FlagAs`是我想要将子菜单附加到的菜单项）：

```
lNewMenuItems: array[0..flagCount] of tMenuItem;

for I := 0 to flagCount do
begin
  { Create a new menu item }
  lNewMenuItems[I] := tMenuItem.Create(FlagAs);
  lNewMenuItems[I].Caption := FlagNames[I];
  lNewMenuItems[I].Tag := I; { Tag with the flag number }
  lNewMenuItems[I].OnClick := miFlagClick;
end;

FlagAs.Add(lNewMenuItems); 
```

`miFlagClick`处理程序只是切换其发送者的检查状态：

```
procedure TMyForm.miFlagClick(Sender: TObject);
begin
  (Sender as tMenuItem).Checked := not (Sender as tMenuItem).Checked;
end; 
```

这些项目被完美地添加，但是当我点击它们时它们不会被检查。事件处理程序被称为**EDIT: 并且 Sender 是正确的菜单项，但是下次我打开菜单时不会出现复选标记。**

我究竟做错了什么？还是我以错误的方式创建菜单？（注`flagCount`将来可能会改变，但在代码中定义为常量）

**编辑：以上确实有效 - 请参阅下面的答案**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T11:43:31.693

我在 Delphi 2009 中尝试了以下操作，效果很好：

```
procedure TForm5.FormCreate(Sender: TObject);
var
  i : Integer;
  mis : array[0..3] of TMenuItem;
begin
  for i := 0 to 3 do begin
    mis[i] := tMenuItem.Create(SubMenu);
    NewMenu(mis[i]);
  end;
  SubMenu.Add(mis);
end;

procedure TForm5.NewMenu(var mi: TMenuItem);
begin
  mi.Caption := 'Test';
  mi.OnClick := TestClick;
end;

procedure TForm5.TestClick(Sender: TObject);
begin
 (Sender as tMenuItem).Checked := not (Sender as tMenuItem).Checked;
end; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T01:44:27.677

顺便说一句（我知道你已经找到原因了）

你为什么使用 lNewMenuItems: array[0..flagCount] of tMenuItem; 而不是使用单个变量？

另外，是否有理由不使用 AutoCheck 属性？

```
 var
    NewMenuItem: TMenuItem;
    I : Integer;
  begin
    for I := 0 to flagCount do
    begin
      { Create a new menu item }
      NewMenuItem := TMenuItem.Create(FlagAs);
      NewMenuItem.Caption := FlagNames[I];
      NewMenuItem.Tag := I; { Tag with the flag number }
      // NewMenuItem.OnClick := miFlagClick;
      NewMenuItem.AutoCheck := True;
      FlagAs.Add(NewMenuItem);
    end;
  end; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T11:46:15.007

这是我的错误——我的另一部分代码正在修改`Checked`我忘记的状态。我现在觉得很傻。对不起，浪费时间...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T11:48:52.117

您是否可能有一个附加到 FlagAs 的事件处理程序来清除您检查的标志？

# python - python退出阻塞线程？

> ID：552996
> 
> 赞同：2
> 
> 时间：2009-02-16T11:22:48.543
> 
> 标签：python, multithreading, raw-input

在我的代码中，我循环`raw_input()`查看用户是否已请求退出。我的应用程序可以在用户退出之前退出，但我的问题是应用程序仍然存在，直到我输入从阻塞功能返回的键`raw_input()`。我可以`raw_input()`通过发送虚假输入来强制返回吗？我可以终止它所在的线程吗？（它拥有的唯一数据是一个名为 的变量`wantQuit`）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-16T14:47:54.120

你为什么不把线程标记为守护进程？

从[文档](http://docs.python.org/library/threading.html#id1)：

> 可以将线程标记为“守护线程”。这个标志的意义在于，当只剩下守护线程时，整个 Python 程序就退出了。初始值继承自创建线程。该标志可以通过 daemon 属性设置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T13:24:52.883

您可以使用非阻塞函数来读取用户输入。
此解决方案是特定于 Windows 的：

```
import msvcrt
import time

while True:
    # test if there are keypresses in the input buffer
    while msvcrt.kbhit(): 
        # read a character
        print msvcrt.getch()
    # no keypresses, sleep for a while...
    time.sleep(1) 
```

在 Unix 中做类似的事情，它一次读取一行，不像 windows 版本读取 char by char （感谢 Aaron Digulla 提供到 python 用户论坛的链接）：

```
import sys
import select

i = 0
while i < 10:
    i = i + 1
    r,w,x = select.select([sys.stdin.fileno()],[],[],2)
    if len(r) != 0:
        print sys.stdin.readline() 
```

另见：[http ://code.activestate.com/recipes/134892/](http://code.activestate.com/recipes/134892/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T13:40:38.120

你可以使用这个包装你的函数的超时函数。这是来自的食谱：[http ://code.activestate.com/recipes/473878/](http://code.activestate.com/recipes/473878/)

```
def timeout(func, args=(), kwargs={}, timeout_duration=1, default=None):
    '''This function will spwan a thread and run the given function using the args, kwargs and 
    return the given default value if the timeout_duration is exceeded 
    ''' 
    import threading
    class InterruptableThread(threading.Thread):
        def __init__(self):
            threading.Thread.__init__(self)
            self.result = default
        def run(self):
            try:
                self.result = func(*args, **kwargs)
            except:
                self.result = default
    it = InterruptableThread()
    it.start()
    it.join(timeout_duration)
    if it.isAlive():
        return it.result
    else:
        return it.result 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T14:18:26.390

[Python 邮件列表](http://bytes.com/topic/python/answers/36171-need-function-like-raw_input-but-time-limit)中有一篇文章解释了如何为 Unix 执行此操作：

```
# this works on some platforms:

import signal, sys

def alarm_handler(*args):
    raise Exception("timeout")

def function_xyz(prompt, timeout):
    signal.signal(signal.SIGALRM, alarm_handler)
    signal.alarm(timeout)
    sys.stdout.write(prompt)
    sys.stdout.flush()
    try:
        text = sys.stdin.readline()
    except:
        text = ""
    signal.alarm(0)
    return text 
```

# c++ - 如何在 C++ 中读取来自网络摄像头的输入？

> ID：552999
> 
> 赞同：7
> 
> 时间：2009-02-16T11:23:57.620
> 
> 标签：c++, video, stream, webcam

是否可以像从流对象中一样从 C++ 中的**通用网络摄像头读取数据？**是否有适用于所有网络摄像头的通用 API 或标准？

我说的是 *nix 环境中的 C++。

提前致谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-16T12:05:33.573

对于 Linux，[V4L](http://linuxtv.org/v4lwiki/index.php/Main_Page)。AFAIR，BSD 使用相同的代码库。其他的我就不知道了。。。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-16T12:12:04.510

在 Linux 中，使用[Video4Linux](http://linuxtv.org/wiki/index.php/Main_Page)支持网络摄像头。查看[用户空间 API](http://v4l2spec.bytesex.org/spec/book1.htm)和[Video4Linux 介绍](http://lwn.net/Articles/203924/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T11:48:59.057

您可能想检查网络摄像头是否与 TWAIN 兼容并使用它们的 api 来做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T11:50:36.433

首先找出网络摄像头是否流式传输视频？通常，他们会将视频流式传输到特定端口。然后，您可以在该端口上用 C++ 打开一个 Socket 并获取视频数据。大多数网络摄像头应该能够做到这一点。

这里的主要内容是您需要了解网络摄像头使用什么视频格式以及如何处理它。Silverlight 或 DirectX 会有所帮助，因为它们可以直接监听特定端口，但您没有提到您使用的是哪个操作系统。

如果网络摄像头没有流式传输，它至少应该具有将视频保存到文件的功能。在这种情况下，还要找出视频格式，这应该有助于您决定使用哪个 API。*****~~*********