# StackOverflow 问答 10820000-10820999

# asp.net-mvc-3 - ASP MVC 3 注销

> ID：10820008
> 
> 赞同：1
> 
> 时间：2012-05-30T16:03:47.360
> 
> 标签：asp.net-mvc-3, security, caching

我在 asp.mvc 中注销时遇到问题。用户可以按返回按钮，他将看到最后访问的页面。

我进行了一些搜索并找到了这样的解决方案：

```
this.Response.Cache.SetExpires(DateTime.UtcNow.AddYears(-1));
this.Response.Cache.SetCacheability(HttpCacheability.NoCache);
this.Response.Cache.SetNoStore(); 
```

但我应该将它添加到每个页面以使其正常工作。

是否有某种方法可以禁用 mvc 应用程序中所有控制器的所有 GET 请求的缓存，然后为其中一些控制器启用它，例如使用属性或自定义过滤器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T16:52:22.877

让它在全球范围内工作并不多。我们过去所做的是创建一个派生自 ActionFilter 的类，然后将其作为全局操作过滤器添加到 global.asax 中。另请注意，实际上强制所有浏览器重新加载并非易事。即使是下面的代码也并不总是适用于 Safari，这通常必须通过 body 标签或类似的空加载来欺骗。

```
 using System;
 using System.Collections.Generic;
 using System.Text;
 using System.Web.Mvc;

 /// <summary>
 /// Action filter that instructs the page to expire.
 /// </summary>
 public class PageExpirationAttribute : ActionFilterAttribute
 {
    /// <summary>
    /// The OnActionExecuted method.
    /// </summary>
    /// <param name="filterContext">The current ActionExecutedContext. </param>
    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
       base.OnActionExecuting(filterContext);

       filterContext.HttpContext.Response.ClearHeaders();
       filterContext.HttpContext.Response.AppendHeader("Cache-Control", "no-cache, no-store, must-revalidate, post-check=0, pre-check=0, max-age=0");
       filterContext.HttpContext.Response.AppendHeader("Pragma", "no-cache");
       filterContext.HttpContext.Response.AppendHeader("Keep-Alive", "timeout=3, max=993");
       filterContext.HttpContext.Response.AppendHeader("Expires", "Mon, 26 Jul 1997 05:00:00 GMT");
    }
 } 
```

如果您希望能够排除某些页面，可以创建另一个属性，您可以将其应用于控制器或方法。您的 OnActionExecuting() 可以检查该属性是否存在：

```
[AttributeUsage(AttributeTargets.Class | AttributeTargets.Method, AllowMultiple = false, Inherited = true)]
public sealed class AllowCachingAttribute : Attribute 
{ 
} 
```

添加到 OnActionExecuting 的近似代码

```
using System;
 using System.Collections.Generic;
 using System.Text;
 using System.Web.Mvc;

 /// <summary>
 /// Action filter that instructs the page to expire.
 /// </summary>
 public class PageExpirationAttribute : ActionFilterAttribute
 {
    /// <summary>
    /// The OnActionExecuted method.
    /// </summary>
    /// <param name="filterContext">The current ActionExecutedContext. </param>
    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
       base.OnActionExecuting(filterContext);

       bool skipCache = filterContext.ActionDescriptor.IsDefined(typeof(AllowCachingAttribute), true)
                || filterContext.ActionDescriptor.ControllerDescriptor.IsDefined(typeof(AllowCachingAttributee), true);

       if (!skipCache)
       {

       filterContext.HttpContext.Response.ClearHeaders();
       filterContext.HttpContext.Response.AppendHeader("Cache-Control", "no-cache, no-store, must-revalidate, post-check=0, pre-check=0, max-age=0");
       filterContext.HttpContext.Response.AppendHeader("Pragma", "no-cache");
       filterContext.HttpContext.Response.AppendHeader("Keep-Alive", "timeout=3, max=993");
       filterContext.HttpContext.Response.AppendHeader("Expires", "Mon, 26 Jul 1997 05:00:00 GMT");
       }
    }
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T16:12:41.210

您可以创建一个实用程序类并添加一个执行上述代码的公共静态方法，然后调用它。然后在控制器的方法中，调用实用程序方法。我将提供一些代码：

```
namespace App
{
    public class Utility
    {
        public static void SetResponsAttributes(HttpResponseBase theResponseObject)
        {
            if (theResponseObject == null) return;

            theResponseObject.Cache.SetExpires(DateTime.UtcNow.AddYears(-1));
            theResponseObject.Cache.SetCacheability(HttpCacheability.NoCache);
            theResponseObject.Cache.SetNoStore(); 
        }
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T16:22:48.757

为什么不设置一个会话标志来指示登录指示器并将整个视图内容包装在一个 if 块中。在注销时放弃会话。

# android - 在 SharedPreferences 中存储“JSON.stringify”数据是不是很糟糕？

> ID：10820013
> 
> 赞同：3
> 
> 时间：2012-05-30T16:04:12.177
> 
> 标签：android, sharedpreferences

我无法在 SQLite 和 SharedPreferences 之间进行选择。

我可以用

```
JSON.parse(SharedPreferences.getString("data","qweqwe"); 
```

和

```
s.putString(key,JSON.stringify(JSONObject)); 
```

或者创建一个新的大类来将我的（文本）数据存储在 SQLite 中。（PS：JSON.* 是我自己的课）

什么会更快，更好？

我知道 SharedPreferences 适用于“键值”数据，SQLite - 适用于大量结构化数据。但在我的情况下，在 SP 中存储 JSON 格式的数据并通过密钥访问会更容易。主要问题 - 它会更慢还是更快？优点和缺点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T17:49:14.003

一方面，这是一个稍微主观的问题（而不是最适合stackoverflow）。另一方面，从字面上看你的问题标题，客观答案是“不，还*不错*”。

然而，这种推理有点主观，因为它“取决于”情况。

该类`SharedPreferences`实际上是存储在应用程序的私有（内部）存储中的文件的包装器/帮助器 - 据我了解，它是一个 XML 文件。基于这个事实，再次问自己......“将 JSON 格式的字符串保存在 XML 文件中是不是很糟糕”？

正如您在问题的评论中提到的那样，使用 SQLite 数据库将意味着编写额外的代码，而优点`SharedPreferences`是给定的首选项文件可以通过任何扩展的 Android 类的名称访问，`Context`包括`Application`,`Activity`和`Service`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T03:33:25.687

我考虑了这一点并进行了一些练习。

因此，使用 SQLite（在我的情况下）比在 SharedPreferences 中使用 JSON 格式的字符串更好，因为我只能更新表中的一两行。使用 SharedPreferences 我必须：

1.  采用`new JSONObject(sharedPreferences.getString("json_string","qweqwe");`
2.  对对象的一些操作
3.  编辑我的 SharedPreferences。
4.  ~~根据你的口味调味~~
5.  将我的 JSONObject().toString() 放回 SharedPreferences。就是这样。

恕我直言，设备更复杂。~~因为不能调味~~

如果我不需要更新数据的个别部分，我宁愿使用 SharedPreferences，因为对于我不需要更新的静态数据，它更快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T17:45:15.793

到目前为止，我已经在几个项目中使用了这种方法，没有任何问题。但是使用 SQLite 数据库肯定有几个优点。特别是 SQLite 的版本控制/升级功能，以及强大的 SQL 查询语言。如果您需要将数据迁移到新的存储结构，SQLite 框架中的 upgrade 和 onUpgrade 回调会非常有用。

如果您保持简单，首选项中的 JSON 可以非常快速且非常容易实现。在安全性方面，首选项比数据库更“公开”，因为它们只是存储在 xml 中，但最终 SQLite 数据库的数据库文件以相同的方式存储，并且在入侵期间也可以读取。

使用 JSON/SharedPreferences 时我还没有遇到任何性能问题，但我也没有进行任何分析来测试它。我的心态一直是保持代码简单而不是过早地优化——如果出现性能问题，那就在那时进行分析工作。

最终，我会说以这种方式使用 SharedPreferences 本身并没有错。

# coffeescript - 查询对象数组

> ID：10820015
> 
> 赞同：15
> 
> 时间：2012-05-30T16:04:15.893
> 
> 标签：coffeescript

有人对如何在咖啡脚本中查询哈希数组有指导吗？

例如，我有一个哈希数组，每个都有一个“名称”和“设置”：

```
[
  {"name":"color", "setting":"red"},
  {"name":"scale_min", "setting":"15"},
  {"name":"scale_type", "setting":"linear"},
  {"name":"x_axis_label", "setting":"Weeks"}
] 
```

我想在这个数组中找到哈希“名称”为“x_axis_label”的元素

我怎样才能用coffeescript轻松做到这一点？

我需要某种`value_for_key_in_object(key, object)`功能，并想知道是否会成为词典的一部分...

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-05-30T16:14:20.420

我只是快速破解了这个：

```
data = [{"name":"color","setting":"red"},{"name":"scale_min","setting":"15"},{"name":"scale_type","setting":"linear"},{"name":"x_axis_label","setting":"Weeks"}]

find = (i for i in data when i.name is 'x_axis_label')[0]

alert(find.setting) 
```

[演示](http://coffeescript.org/#try:data%20=%20%5B%7B%22name%22:%22color%22,%22setting%22:%22red%22%7D,%7B%22name%22:%22scale_min%22,%22setting%22:%2215%22%7D,%7B%22name%22:%22scale_type%22,%22setting%22:%22linear%22%7D,%7B%22name%22:%22x_axis_label%22,%22setting%22:%22Weeks%22%7D%5D%0A%0Afind%20=%20%28i%20for%20i%20in%20data%20when%20i.name%20is%20%27x_axis_label%27%29%5B0%5D%0A%0Aalert%28find.setting%29)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-30T18:11:20.060

如果您要反复执行此操作，总是寻找名称等于某物的东西，那么您最好将其从映射数组转换为键为名称的映射。

```
data = [
  {"name":"color","setting":"red"}
  {"name":"scale_min","setting":"15"}
  {"name":"scale_type","setting":"linear"}
  {"name":"x_axis_label","setting":"Weeks"}
]

myMap = {}
for row in data
  myMap[row.name] = row.setting

alert(myMap['x_axis_label']) 
```

[演示](http://coffeescript.org/#try:data%20=%20%5B%0A%20%20%7B%22name%22:%22color%22,%22setting%22:%22red%22%7D%0A%20%20%7B%22name%22:%22scale_min%22,%22setting%22:%2215%22%7D%0A%20%20%7B%22name%22:%22scale_type%22,%22setting%22:%22linear%22%7D%0A%20%20%7B%22name%22:%22x_axis_label%22,%22setting%22:%22Weeks%22%7D%0A%5D%0A%0AmyMap%20=%20%7B%7D%0Afor%20row%20in%20data%0A%20%20myMap%5Brow.name%5D%20=%20row.setting%0A%0Aalert%28myMap%5B%27x_axis_label%27%5D%29)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-06-03T09:07:52.937

我总是更喜欢“多语言”解决方案而不是“惯用”解决方案。因此你可以使用`Array.filter`

```
data = [{"name":"color","setting":"red"},{"name":"scale_min","setting":"15"},{"name":"scale_type","setting":"linear"},{"name":"x_axis_label","setting":"Weeks"}]
find = (data.filter (i) -> i.name is 'x_axis_label')[0]
alert find.setting 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-05-30T16:42:04.590

如果你碰巧在使用 Underscore.js，你可以使用[`find`](http://documentcloud.github.com/underscore/#find)：

```
xAxisLabel = _.find data, (datum) -> datum.name is 'x_axis_label' 
```

# sencha-touch-2 - Sencha Touch 2：面板中不显示列表

> ID：10820016
> 
> 赞同：6
> 
> 时间：2012-05-30T16:04:21.820
> 
> 标签：sencha-touch-2

我正在 Sencha Touch 2 中开发一个 MVC 应用程序，并且无法在嵌套的`panel`.

应用程序的结构有一个主视图，它是一个选项卡面板。选项卡面板中的一项是已定义面板，`xtype: 'homepanel'`.

此面板中的一个项目`xtype: 'newslist'`是链接到相应商店和模型文件的列表。

**除非**我将其父级更改`homepanel`为类型，否则该列表不会显示`Ext.navigation.View`。

我在`homepanel`'的定义中遗漏了什么`panel`会阻止列表的显示？

```
Ext.define('ACSO.view.Home', {
    extend: 'Ext.Panel', //<--works if Ext.navigation.View
    xtype: 'homepanel',
    requires: [
        'Ext.TitleBar',
        'ACSO.view.NewsList'
    ],

    config: {
        title: 'Home',
        iconCls: 'home',
        cls: 'home',

        scrollable: true,
        styleHtmlContent: true,

        items: [{
            xtype: 'newslist'
        }]
    }
}); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-30T16:19:11.497

您的面板没有布局。

我建议您尝试在面板配置中添加以下内容：

```
layout:'fit' 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T16:38:55.083

尝试添加`layout: 'card'`到面板的配置中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T06:18:41.107

`Layout: fit`不适合我。但是，添加`layout: 'card`到父`Ext.Panel`级有效！

中的 UI 组件`Ext.Panel`不再通过`display: none !important;`.

# iphone - 如何在iphone上存储信用卡信息？

> ID：10820017
> 
> 赞同：5
> 
> 时间：2012-05-30T16:04:25.800
> 
> 标签：iphone, ios, security

我需要在 iPhone 应用程序中存储信用卡号。如何安全地存储数据。我看过钥匙扣。除此之外，还有什么我可以使用的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T16:55:11.760

如上所述，您应该首先调查其合法性，尤其是在 Apple 对应用商店中的内容进行限制的情况下。

也就是说，我之前不得不加密敏感信息，并决定使用 AES-256 加密。由于用户名、密码和个人数据是通过网络发送的，因此这是必要的。我为此使用了 FBEncrypt——它是 CCCrypt 的一个很好的包装器。

[https://github.com/dev5tec/FBEncryptor](https://github.com/dev5tec/FBEncryptor)

这将允许您进行 base-64 编码和 AES-256 编码等，非常方便。如果您真的需要它，请检查它！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T16:14:31.890

如前所述，这个问题很难回答。由需求的作者决定所需的安全级别。他们可能希望就泄露数据可能产生的责任（如果有的话）获得一些法律建议。

一旦您了解了适当的保护级别，您就可以开始评估解决方案。钥匙串很好，但有很多可用的加密选项。

除了如何存储号码之外，您可能希望得到答案的问题包括：

*   公开号码需要什么身份验证？
*   公开号码的预期生命周期是什么？
    *   号码可以暴露多久？
    *   如何从内存中清除该号码？
*   暴露的号码怎么用？
    *   号码可以显示给用户吗？
    *   您是否允许将号码复制到剪贴板？

如果你想认真保护信息（任何信息），你需要做一些认真的设计工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T18:26:56.460

您需要对此进行非常认真的研究，并且在未经您彻底研究和确认的情况下，不一定接受本网站上的人所说的话。

存储诸如信用卡信息之类的信息不是您应该仅根据本网站 IMO 上的响应来实施的事情。

如果你是认真的，你需要阅读、理解和应用“黑客和保护 iOS 应用程序”一书中的材料，以了解危险是什么以及如何减轻它们，以及人们所说的安全技术实际上是如何不安全的就像您认为的那样安全。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-12T10:24:31.537

对于这种情况，加密和 SSL/HTTPS 的使用似乎已经足够了。如果您不熟悉主题，这里有很好的一般指南：[移动应用程序开发技巧：如何确保数据安全](http://cases.azoft.com/data-security-in-mobile-app-development/)

有很多实现，例如你可以使用上面提到的 AES256 算法：

1.  当应用第一次保存信用卡号时，会生成一个随机的 masterKey 和初始化向量 (IV)。稍后使用它们进行加密。
2.  masterSalt 在本地生成并保存。
3.  使用plainPassword 和masterSalt，计算哈希（PBKDF2）。
4.  使用 AES256 算法，计算的哈希用于加密 MasterKey 和 IV。
5.  加密的 MasterKey 和 IV 保存在本地。
6.  使用 plainPassword 和 masterSalt 哈希 (PBKDF2) 解密 MasterKey 和 IV。
7.  现在，使用 AES256 算法使用 MasterKey 和 IV 加密数据。

# date - 使用 Groovy 计算两个日期之间的月差

> ID：10820022
> 
> 赞同：2
> 
> 时间：2012-05-30T16:04:42.487
> 
> 标签：date, time, groovy, datediff

我需要计算两个日期之间的月差。

```
start = new Date(112, 4, 30) // Wed May 30 00:00:00 CEST 2012
end = new Date(111, 9, 11)   // Tue Oct 11 00:00:00 CEST 2011

assert 8 == monthsBetween(start, end) 
```

使用[Joda-Time](http://www.joda.org/joda-time/)很容易通过以下方式实现这一目标：

```
months = Months.monthsBetween(start, end).getMonths() 
```

如何在不使用其他库的情况下以 Groovy 的方式实现这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-30T16:30:22.990

```
monthBetween = (start[Calendar.MONTH] - end[Calendar.MONTH]) + 1
yearsBetween = start[Calendar.YEAR] - end[Calendar.YEAR]
months = monthBetween + (yearsBetween * 12) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-25T15:11:47.930

如果您想按月份名称而不是几天和几周来获得月份的差异，您可以这样做。

例如：2013 年 12 月 7 日与 2014 年 1 月 21 日的差值为 1

```
Date dateFrom = Date.parse("yyyy-MM-dd", "2013-12-07")
Date dateTo = Date.parse("yyyy-MM-dd", "2014-01-21")

def diffMonths = { Date start, Date end ->
    int diffYears = (start[Calendar.YEAR] - end[Calendar.YEAR]) * 12 
    int diffMonths = start[Calendar.MONTH] - end[Calendar.MONTH] 
    return diffYears + diffMonths
}

println diffMonths(dateTo, dateFrom) 
```

以下将输出 1

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T16:46:23.543

```
(start[Calendar.MONTH]-end[Calendar.MONTH]+1)+((start[Calendar.YEAR]-end[Calendar.YEAR])*12) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-31T07:53:53.240

只是为了好玩（因为它可能不太可读，并且使用更多资源），您还可以这样做：

```
months = (start..end).collect { [ it[ Calendar.YEAR ], it[ Calendar.MONTH ] ] }
                     .unique()
                     .size() 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-31T16:16:31.103

我同意@JonSkeet：你应该继续使用 Joda-Time。IMO、Joda-Time 和 Groovy 非常适合彼此。

您能找到的最接近的（我能找到的）是使用[Groovy JDK](http://groovy.codehaus.org/groovy-jdk/)中的其他 Date 方法来执行此操作：

```
int differenceInDays = start - end 
```

它以天为单位计算两个日期之间的差异。这让您自己将日子转换为月份，这很糟糕。

坚持使用 Joda-Time。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-12-23T09:28:59.797

正如 Jon Skeet 所提到的，您最好使用 Joda-Time，然后围绕这个主题展开思考。

请注意，Joda-Time 返回两个日期之间的**整月数**，包括正确处理夏令时。

# sql - SQL Server 存储过程恢复到前一个

> ID：10820024
> 
> 赞同：0
> 
> 时间：2012-05-30T16:04:56.173
> 
> 标签：sql, sql-server, stored-procedures

我的数据库中有一个存储过程，它不断恢复到旧的，我`Alter`使用 Management Studio 存储过程，但是一段时间后，出乎意料的是，存储过程更改为之前的存储过程`Alter`！在过去的几个小时里，这种情况发生了好几次！

我确定程序内部没有任何地方或手动更改存储过程。我检查了所有代理作业，只有一个`Maintenance job`用于每小时备份，另一个用于`Replication`，但是`Replication Schema Changes`设置为`false`，并且存储过程**未**在列表中定义`Publication Articles`

这种行为还有其他可能的原因吗？我是否需要在 SQL Server 数据库中手动设置检查点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-30T16:49:21.460

您可以创建一个 DDL 触发器来记录`ALTER_PROCEDURE`如下事件：

```
CREATE TABLE dbo.AlterLog(EventType VARCHAR(50)
, ObjectName VARCHAR(256)
, ObjectType VARCHAR(25)
, TSQLCommand VARCHAR(MAX)
, LoginName VARCHAR(256)
);
GO

CREATE TRIGGER AlterProcs
ON DATABASE
FOR ALTER_PROCEDURE
AS

SET NOCOUNT ON; 

DECLARE @data XML
SET @data = EVENTDATA()

INSERT INTO dbo.AlterLog(EventType, ObjectName, ObjectType, TSQLCommand, LoginName)
VALUES(@data.value('(/EVENT_INSTANCE/EventType)[1]', 'varchar(50)'), 
@data.value('(/EVENT_INSTANCE/ObjectName)[1]', 'varchar(256)'), 
@data.value('(/EVENT_INSTANCE/ObjectType)[1]', 'varchar(25)'), 
@data.value('(/EVENT_INSTANCE/TSQLCommand)[1]', 'varchar(max)'), 
@data.value('(/EVENT_INSTANCE/LoginName)[1]', 'varchar(256)')
)
GO 
```

# tcl - tcl - 如何找到加载包的路径？

> ID：10820025
> 
> 赞同：9
> 
> 时间：2012-05-30T16:04:59.990
> 
> 标签：tcl, packages

如何`tcl`找到加载的包的路径？

```
% tclsh
% package require csv 
```

我想找出`csv`加载的路径。

在python中，可以使用[找到模块的路径](https://stackoverflow.com/questions/247770/retrieving-python-module-path)

```
>>> import os
>>> print os.__file__
'/a/b/python2.2.1/linux26_x86_64/lib/python2.2/os.pyc' 
```

我正在寻找类似的命令`tcl`

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-30T17:37:11.677

事情没那么简单：Tcl 中的包似乎比 Python 中的包更抽象。

首先，有两种包：“经典”和[“模块”](http://wiki.tcl.tk/12999)，它们具有不同的底层机制来查找响应`package require ...`命令加载的内容。

接下来，这两种包都可以做任何他们想做的事情来提供他们的功能。这意味着它们可以是（但不限于）：

*   纯 Tcl 包，`source`只需要一个 Tcl 文件或任意数量的文件。
*   用 C 或其他编译语言实现的包，以动态库的形式在`load`需要包时获取。
*   以上的组合，当有一个 C 库和一层 Tcl 代码围绕它时（通常提供帮助/便利命令）。

因此，这个问题本身没有什么意义，因为只有一个*模块*由一个独立的文件表示，但“经典”包可以自由地按照他们认为合适的方式实现自己。

另一方面，每个包通常会（使用一种或另一种方式）向包子系统提供某些信息，这些信息可以使用`package ifneeded`命令检索（和解析）。例如，在我的带有 ActiveState Tcl 8.5.x 的 Windows 系统上，我有：

```
% package require csv
0.7.2
% package ifneeded csv 0.7.2
package provide csv 0.7.2;source -encoding utf-8 {C:/Program Files/Tcl/lib/teapot/package/tcl/teapot/tcl8/8.3/csv-0.7.2.tm} 
```

请注意，`package ifneeded`返回的只是一个*Tcl 脚本*，该脚本旨在用于`eval`加载包，因此对该信息的解析必然是固有的临时和脆弱的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-03-26T23:16:24.293

对于 Tcl 包，您可以通过以下命令查看所有可加载路径目录的列表：

```
join $::auto_path \n 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-24T16:01:28.817

本手册涉及 auto_path 和其他可加载库变量：[https://www.systutorials.com/docs/linux/man/n-auto_path/](https://www.systutorials.com/docs/linux/man/n-auto_path/) 可以在 tclsh 中添加新的或缺少的可加载包搜索目录： lappend auto_path /new_directoty

# netty - 尝试从 master 分支编译 netty 时出错

> ID：10820027
> 
> 赞同：0
> 
> 时间：2012-05-30T16:05:02.320
> 
> 标签：netty

我做了 git clone git://github.com/netty/netty.git

然后

mvn install -Dcheckstyle.skip

-Dcheckstyle.skip 是因为之前的错误与样式检查有关。

现在我在缓冲区模块上遇到编译错误，

注意：我使用的是 JDK 1.7（从[http://www.oracle.com/technetwork/java/javase/downloads/jdk-7u4-downloads-1591156.html](http://www.oracle.com/technetwork/java/javase/downloads/jdk-7u4-downloads-1591156.html)下载并安装的 Mac OSX 64 位版本）和 maven 3.0.4

控制台输出：

[INFO] 构建 Netty/Buffer 4.0.0.Alpha1-SNAPSHOT

[信息] --------------------------------------------- -------------------------

...

[INFO] 编译 23 个源文件到 /Users/jars/workspace/rhyboo-sources/netty/buffer/target/classes

[信息] --------------------------------------------- --------------

[错误] 编译错误：

[信息] --------------------------------------------- --------------

[错误] 引导类路径未与 -source 1.6 /Users/jars/workspace/rhyboo-sources/netty/buffer/src/main/java/io/netty/array/ObjectArray.java 一起设置：[4,36]错误：找不到符号

[错误] 类 AbstractArray /Users/jars/workspace/rhyboo-sources/netty/buffer/src/main/java/io/netty/array/ObjectArray.java:[12,21] 错误：找不到符号

[错误] E 扩展类 ObjectArray /Users/jars/workspace/rhyboo-sources/netty/buffer/src/main/java/io/netty/array/ObjectArray.java 中声明的对象：[10,4] 错误：方法确实不覆盖或实现超类型的方法

是否有与编译和运行netty示例相关的文档？或者然后在eclipse上导入项目？

在此先感谢，netty 看起来是一个了不起的 nio 客户端服务器框架。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T04:01:21.280

Netty 项目的负责人之一（可能是 Trustin）忘记上传 AbstractArray 类。我会让他知道的，所以它应该很快就会修复。

我不知道他为此写了什么，否则我会自己制作并使用拉取请求。目前，我正在修复所有 checkstyle 审计错误。

祝 Netty 好运！修复后我会通知你 - API 发生了很大的变化，所以有些东西坏了。

PS：如果您不想要最新的更改，您可以随时切换到“标签”之一 - 我认为您只需像常规分支一样检查它们。

~克鲁兹

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T09:55:20.903

我们目前正在 master 进行大量重构，并且构建已损坏。它应该在本周末之前修复，但现在，请使用分支“3”。

# apache - 强制 tomcat 使用 www.domain.com 而不是 domain.com

> ID：10820029
> 
> 赞同：2
> 
> 时间：2012-05-30T16:05:06.230
> 
> 标签：apache, tomcat

目前我正在使用 Apache 的 mod_rewrite 将所有 html 请求重定向到 http(s)://www.domain.com/blah 而不是 http(s)://domain.com/blah。

一切正常，除非我在 domain.com:8080 连接到 tomcat。我所做的只是天真地将相同的 .htaccess 文件放入我的 /opt/tomcat-7/webapps/ROOT 目录，但它似乎不起作用。

我实际上希望我在上面尝试过的事情上偏离了轨道，并且有一种方法可以随时将 domain.com:8080 重写为 www.domain.com:8080 而无需将新的 .htaccess 文件放入每个 webapp 目录，但如果不是，我在上面做错了什么？

我已经在 Google 上搜索了其他与 tomcat 有此问题的人，但无济于事。

作为记录，我的 .htaccess 文件是：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} !^$
RewriteCond %{HTTP_HOST} !^www\. [NC]
RewriteCond %{HTTPS}s ^on(s)|
RewriteRule ^ http%1://www.%{HTTP_HOST}%{REQUEST_URI} [R=301,L] 
```

干杯，本。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T11:44:57.963

Tomcat 不会对 .htaccess 文件做任何事情：那是 Apache httpd 的事情。

你有几个选择，在这里：

1.  编写一个过滤器，检查用于访问您的 web 应用程序的主机名，如果它没有必要的“www”，则进行重定向。字首。
2.  在您的 conf/server.xml 文件中放置两个 <Host>：一个具有主机名“blah.com”，另一个具有主机名“www.blah.com”，其中“blah.com”是默认值。然后，仅将您的 webapp 部署到“www.blah.com”，并将一个简单的 webapp 部署到“blah.com”，将所有内容重定向到所需的主机名。如果有帮助，您可以使用[http://www.tukey.org/urlrewrite/](http://www.tuckey.org/urlrewrite/)为您完成真正的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-12T16:02:29.373

我更喜欢 christopher 指出的第二种方法，因为它可以减轻主应用程序的负担。

在 tomcat 中的 webapps 文件夹旁边创建一个新的**webapps2文件夹以重定向到主应用程序。**创建一个 ROOT 应用，不需要 index.jsp。

```
webapps2
     |
     |--ROOT 
         |---WEB-INF
            |
            |-----lib
            |      |----urlrewritefilter-4.0.3.jar 
            |
            |---web.xml
            |---urlrewrite.xml 
```

**在server.xml**中添加主机

 **```
<Host name="www.domain.com"  appBase="webapps"
        unpackWARs="true" autoDeploy="true">
      ...
</Host>
<Host name="domain.com"  appBase="webapps2"
        unpackWARs="true" autoDeploy="true">
      <Context path="" docBase="ROOT"/>
</Host> 
```

**urlrewrite.xml**的结构

 **```
<urlrewrite>
    <rule>
        <name>seo redirect</name>
        <condition name="host" operator="notequal">^www.domain.com</condition>
        <condition name="host" operator="notequal">^localhost</condition>
        <from>^/(.*)</from>
        <to type="permanent-redirect" last="true">http://www.domain.com/$1</to>
    </rule>
</urlrewrite> 
```

**在/etc/hosts**文件中添加域和子域

```
1.23.45.67 www.domain.com
1.24.53.57 www.domain.com 
```****

# java - 用Java制作一个简单的计时器

> ID：10820033
> 
> 赞同：7
> 
> 时间：2012-05-30T16:05:39.943
> 
> 标签：java, timer

我似乎无法弄清楚如何在 java 中制作一个简单的计时器。我需要它做的只是显示时间，真的。所以只是一个开始方法，它一直在计数，比如 0:00、0:01、0:02 等。我已经看到了一些其他类似的论坛帖子，但所有代码对于我的水平来说都有点复杂理解; 我对java有点陌生。但是做一个只执行这样一个基本功能的计时器应该不难吧？如果有人可以提供帮助，将不胜感激:)

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-01-14T17:06:28.423

这并不难。但是，我要提醒您，我在堆栈溢出方面看到了一些非常混乱的答案，在某些情况下，编码习惯非常糟糕，所以要非常小心。首先让我回答这个问题。

如果程序员在实现计时器时犯的最大错误似乎是认为他们需要一些东西来跟踪当前时间。也就是说，他们编写了某种循环，每秒增加一个变量或一些类似的傻事。您无需编写代码来跟踪时间。该功能`System.currentTimeMillis()`将为您完成此操作，并且非常准确。

定时器代码将涉及许多程序员混淆的两个方面：

1.  时间的计算
2.  刷新显示

计算显示时间所需要做的就是记录计时器开始的时间：

```
long startTime = System.currentTimeMillis(); 
```

稍后，当您想要显示时间量时，只需从当前时间中减去它即可。

```
long elapsedTime = System.currentTimeMillis() - startTime;
long elapsedSeconds = elapsedTime / 1000;
long secondsDisplay = elapsedSeconds % 60;
long elapsedMinutes = elapsedSeconds / 60;
//put here code to format and display the values 
```

程序员犯的最大错误是认为他们需要一个变量来保存当前时间，然后编写代码以每秒递增该变量，例如他们维护的称为“elapsedSeconds”的东西。问题是您可以安排每秒调用一次代码，但不能保证准确地调用该代码的时间。如果系统很忙，则调用该代码的时间可能会比第二个稍晚一些。如果系统非常繁忙（例如从故障磁盘中获取页面），它实际上可能会延迟几秒钟。使用 Thread.sleep(1000) 函数每秒循环的代码会发现错误会随着时间的推移而累积。如果 sleep 有一次延迟返回 300 毫秒，则该错误会复合到您计算现在的时间中。这都是完全没有必要的，因为操作系统*具有告诉您当前时间的功能*。

无论您每秒运行此代码、每秒运行 100 次还是每 3.572 秒运行一次，上述计算都是准确的。关键是`currentTimeMillis()`无论何时调用此代码，它都是时间的准确表示——这是一个重要的考虑因素，因为不能保证线程和计时器事件在特定时间是准确的。

计时器的第二个方面是刷新显示。这将取决于您用于显示的技术。在 GUI 环境中，您需要安排绘制事件。您希望这些绘制事件在预期显示更改的时间之后立即出现。但是，这很棘手。您可以请求绘制事件，但可能有数百个其他绘制事件排队等待处理。

一种懒惰的方法是每秒安排 10 个绘制事件。因为时间的计算不依赖于在特定时间点被调用的代码，而且如果你用相同的时间重新绘制屏幕也没关系，这种方法或多或少保证了显示的时间在大约 1/10 秒内显示正确的时间。这似乎有点浪费，因为 10 次中有 9 次是在绘制屏幕上已有的内容。

如果您正在编写一个带有某种动画（如游戏）的程序，该程序每秒刷新屏幕 30 次，那么您无需执行任何操作。只需将计时器显示调用合并到您的常规屏幕刷新中即可。

如果绘制事件很昂贵，或者如果您正在编写一个执行终端样式输出的程序，您可以通过计算显示更改之前的剩余时间来优化事件的调度：

```
long elapsedTime = System.currentTimeMillis() - startTime;
long timeTillNextDisplayChange = 1000 - (elapsedTime % 1000); 
```

变量 timeTillNextDisplayChange 保存您需要等待的毫秒数，直到计时器的秒部分发生变化。然后，您可以安排在那个时候发生绘制事件，可能会调用`Thread.sleep(timeTillNextDisplayChange)`并在睡眠之后执行输出。如果您的代码在浏览器中运行，您可以使用此技术在正确的时间更新页面 DOM。

请注意，此显示刷新计算中没有任何内容会影响计时器本身的准确性。线程可能会延迟 10ms 甚至 500ms 从睡眠中返回，并且不会影响计时器的准确性。每次通过时，我们都会从 currentTimeMillis 计算等待时间，因此一次调用迟到不会导致稍后的显示迟到。

这是精确计时器的关键。不要指望操作系统会在您要求时调用您的例程或发送绘图事件。当然，通常，对于现代机器，操作系统的响应速度非常快且准确。这发生在您没有运行太多其他东西并且计时器似乎工作的测试情况下。但是，在生产中，在罕见的压力情况下，您不希望您的计时器因为系统繁忙而“漂移”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-05T07:06:17.797

为了根据您的需要创建一个简单的计时器，为此编写代码非常容易。我已经编写了以下代码供您参考。如果你愿意，你可以加强它。

导入 java.util.concurrent.TimeUnit；公共类 PerfectTimer {

```
public static void main(String[] args) throws InterruptedException 
{
    boolean x=true;
    long displayMinutes=0;
    long starttime=System.currentTimeMillis();
    System.out.println("Timer:");
    while(x)
    {
        TimeUnit.SECONDS.sleep(1);
        long timepassed=System.currentTimeMillis()-starttime;
        long secondspassed=timepassed/1000;
        if(secondspassed==60)
        {
            secondspassed=0;
            starttime=System.currentTimeMillis();
        }
        if((secondspassed%60)==0)
        displayMinutes++;

    System.out.println(displayMinutes+"::"+secondspassed);
    }

} 
```

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-24T01:40:33.673

您可以使用`Timer`class from`java.util`或其他更复杂的方式，即使用 Threads。Timer 也有线程动作，但使用起来很容易理解。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-12-02T07:05:55.997

如果您想更新主线程中的某些内容（例如 UI 组件），最好使用 Handler

```
 Handler h = new Handler();
        h.postDelayed(new Runnable() {
            @Override
            public void run() {
                //do something
            }
        }, 20); 
```

20 - 在MS做某事的延迟。并循环运行。

# c++ - Qt - 控制外部进程

> ID：10820034
> 
> 赞同：0
> 
> 时间：2012-05-30T16:05:41.447
> 
> 标签：c++, windows, qt

目前我正在像这样在 Qt 中启动一个外部进程（顺便说一句，我使用的是 Windows 机器）：

```
 QProcess *myProcess = new QProcess();
 myProcess->setWorkingDirectory("C:/working/dir");
 myProcess->start("C:/working/dir/program.exe"); 
```

一切正常。

我需要的是能够以最小化状态启动该程序。这可能吗？如果是这样，请帮忙。

谢谢。

ps 如果您需要更多信息，请告诉我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T16:11:03.733

AFAIK Qt 没有此类功能，但也许您可以使用 Windows START 启动器。尝试：

`myProcess->start("START C:/working/dir/program.exe /MIN");`

它还有其他选项，包括`/MAX`和`/WAIT`

[http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/start.mspx?mfr=true](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/start.mspx?mfr=true)

# ios - iOS 在显示之前是如何设置 UIViewController 的视图框架的？

> ID：10820037
> 
> 赞同：4
> 
> 时间：2012-05-30T16:05:55.827
> 
> 标签：ios, uiview, uiviewcontroller

我不熟悉 iOS UIViewController 的详细实现。我有以下代码来创建一个新的 UIViewController 并显示它，但是我在*initWithFrame*方法中设置的框架不起作用，控制器的视图总是全屏（320 * 480）。

```
UIViewController *viewController = [[UIViewController alloc] init];

// view
UIView *view = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 140, 130)];
viewController.view = view;
[view release];
AppController *app = (AppController*)[[UIApplication sharedApplication] delegate];

UINavigationController *nav = [app navController];
[nav pushViewController:viewController animated:YES];
 [viewController release]; 
```

我在苹果开发者文档中搜索相关想法，但我没有发现任何有用的东西。UIViewController 在显示之前是如何处理它的 view frame 属性的？我在哪里可以找到有用的文档。

谢谢你。

* * *

更新：其实代码来自cocos2d-iphone DirectorTest：[https ://github.com/cocos2d/cocos2d-iphone/blob/release-2.0-rc1/tests/DirectorTest.m#L143](https://github.com/cocos2d/cocos2d-iphone/blob/release-2.0-rc1/tests/DirectorTest.m#L143)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T16:30:59.150

你错了——你真的需要阅读（并理解）苹果的`UIViewController`文档：

[查看控制器目录](http://developer.apple.com/library/ios/#DOCUMENTATION/WindowsViews/Conceptual/ViewControllerCatalog/Introduction.html#//apple_ref/doc/uid/TP40011313)

[查看控制器编程指南](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/Introduction/Introduction.html#//apple_ref/doc/uid/TP40007457)

[查看控制器参考](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIViewController_Class/Reference/Reference.html)

如果您在代码中为视图控制器创建视图，则应该在视图控制器的`loadView`方法中进行。

直接来自 Apple 的文档：

> **以编程方式创建视图**
> 
> 如果您更喜欢以编程方式创建视图…… ***您可以通过覆盖视图控制器的 loadView 方法来实现***。您对此方法的实现应执行以下操作：
> 
> 创建一个根视图对象。根视图包含与您的视图控制器关联的所有其他视图。您通常会为此视图定义框架以匹配应用程序窗口的大小，而应用程序窗口本身应填满屏幕。但是，框架会根据视图控制器的显示方式进行调整。请参阅“视图控制器视图大小调整”。</p>
> 
> 您可以使用通用 UIView 对象、您定义的自定义视图或任何其他可以缩放以填充屏幕的视图。
> 
> 创建额外的子视图并将它们添加到根视图。对于每个视图，您应该执行以下操作：
> 
> 创建并初始化视图。对于系统视图，您通常使用 initWithFrame: 方法来指定视图的初始大小和位置。使用 addSubview: 方法将视图添加到父视图。将根视图分配给视图控制器的视图属性。

# c# - Ajax.BeginForm 中的 LoadingElementId 不显示加载图像

> ID：10820042
> 
> 赞同：6
> 
> 时间：2012-05-30T16:06:12.720
> 
> 标签：c#, asp.net-mvc-3

我有一个 MVC3 应用程序，我需要添加 ajax 加载图像。我把它放在我的视野中

```
 @using (Ajax.BeginForm(
      "LogOn","Account",
      new AjaxOptions { LoadingElementId = "div_loading" })) 
```

这是我在同一视图上的非常简单的 div：

```
 <div id="div_loading" style="display:none;">
   <img src="@Url.Content("~/Content/Images/loading.gif")" alt="" />
 </div> 
```

当我单击提交按钮将表单发回时，loading.gif 永远不会出现。我的代码运行良好，但没有显示加载指示器。并且图像的名称正确且位于正确的位置。有谁知道为什么？

**更新** 显然，这与 Telerik 应用程序有关。如果我创建一个常规的 MVC3 应用程序，它可以工作。当我创建 Telerik MVC3 应用程序时，它不起作用。有其他人在 Telerik 遇到过这种情况吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-30T16:41:39.753

你也可以试试这个：[这里](https://stackoverflow.com/questions/6567488/mvc3-ajax-actionlink-and-delaying-loadingelementid-from-showing)

```
function AjaxBegin()
{
    $('#div_loading').show();

}
function AjaxComplete()
{
    $("#div_loading").hide();
}
function AjaxFailure(ajaxContext)
{
    var response = ajaxContext.responseText;
    alert("Error Code [" + ajaxContext.ErrorCode + "] " + response);
}

AjaxOptions:

OnFailure = "AjaxFailure";
OnBegin = "AjaxBegin";
OnComplete = "AjaxComplete"; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-30T16:15:59.507

我更喜欢避免在我所做的每个 ajax 调用中附加加载 iamge。

这里的最佳答案是每当 ajax 发出发送调用时显示 ajax 微调器（加载图像）的解决方案：

[等待ajax时显示微调器](https://stackoverflow.com/questions/10733939/display-spinner-while-waiting-for-an-image-to-display-from-an-action/10734016#10734016)

它具有您需要的功能。只需使用 javascript 将图像的显示附加到 ajax 调用。

它应该是这样的：

```
<script type="text/javascript">
        $(document).ready(function () {
            BindSpinner();
        });

        function BindSpinner() {
            $("#div_loading").bind("ajaxSend", function () {
                $(this).show();
            }).bind("ajaxStop", function () {
                $(this).hide();
            }).bind("ajaxError", function () {
                $(this).hide();
            });
        };
    </script> 
```

这样做是在 ajax 发送时显示 div，并在 ajax 停止或页面上所有调用出错时隐藏它。如果您将此脚本和 div 放在您的 _layout 中，它将为您网站上的每个 Ajax 调用执行此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T16:26:43.740

你可能想试试这个。我从[这里的 SO 问题中得到它](https://stackoverflow.com/questions/1440151/asp-net-mvc-ajax-form-loadingelementid)

```
<div id="div_loading" style="visibility:hidden;">
   <img src="@Url.Content("~/Content/Images/loading.gif")" alt="" />
</div> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-07-18T14:18:41.383

我遇到了同样的问题，并且能够通过更改要隐藏/显示的元素的名称来解决它。我使用驼峰格式：“myDivToBeHidden”

该元素需要将“display”属性设置为“none”。

# javascript - Javascript 字符编码

> ID：10820046
> 
> 赞同：4
> 
> 时间：2012-05-30T16:06:30.973
> 
> 标签：javascript, html, character-encoding

在一个外部 javascript 文件中，我有一个函数用于将文本附加到表格单元格（在添加了 javascript 文件的 HTML 文档中），文本有时可以包含芬兰语字符（例如 ä）。该文本作为参数传递给我的函数：

```
content += addTableField(XML, 'Käyttötarkoitus', 'purpose', 255); 
```

问题是诸如“ä”之类的变音符号被转换为其他一些虚假字符，例如“�”。我在浏览器中查看 HTML 文档时看到了这一点。这显然是不可取的，而且也很奇怪，因为 HTML 文档的字符编码是 UTF-8。

我怎么解决这个问题？

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T16:11:41.350

包含的文件`content += addTableField(XML, 'Käyttötarkoitus', 'purpose', 255);`未以 UTF-8 编码保存。

我不知道您使用的是什么编辑器，但您可以在设置或保存对话框中找到它。

例子：

![](../Images/616e1465eb0d6858a83d8ce84d3b18b2.png)

如果你不能让它工作，你总是可以在 javascript 中写出文字代码点：

```
content += addTableField(XML, 'K\u00E4ytt\u00f6tarkoitus', 'purpose', 255); 
```

信用：三重奏

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T17:30:41.277

要检查服务器宣布的字符编码，您可以使用 Firebug（在 Info 菜单中，有一个用于查看 HTTP 标头的命令）。或者，您可以使用[Web-Sniffer](http://web-sniffer.net)等在线服务。

如果外部 .js 文件的标头指定了 charset 参数，则需要使用该编码，除非您可以更改相关的服务器设置（可能是 .htaccess 文件）。

如果它们缺少字符集参数，您可以在`script`元素中指定编码，例如`<script src="foo.js" charset="utf-8">`.

声明的编码当然应该与实际编码匹配，您通常可以在保存文件时选择（如果需要，使用“另存为”命令）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T16:15:06.700

HTML 文件/文档的字符编码与任何外部资源无关。

您将需要使用 UTF8 字符编码提供脚本文件。如果它是这样保存的，那么您的服务器配置是伪造的。

# hadoop - AWS Elastic Map Reduce：输出到 SimpleDB

> ID：10820050
> 
> 赞同：2
> 
> 时间：2012-05-30T16:06:48.717
> 
> 标签：hadoop, amazon-simpledb, elastic-map-reduce

将 Elastic Map Reduce 输出导入 SimpleDB 的最有效方法是什么？

我知道我可以将结果输出到 S3，下载它们，然后让脚本解析结果并插入 SimpleDB。

但是有没有一种更简单/更快的方法可以直接将 EMR 输出插入 SimpleDB（出于时间和效率的原因）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T20:57:49.810

请参阅 Amazon 以下入门文档的第 12 页，其中有一节关于“将数据存储到 Amazon SimpleDB”： [http ://awsmedia.s3.amazonaws.com/pdf/introduction-to-amazon-elastic-mapreduce.pdf](http://awsmedia.s3.amazonaws.com/pdf/introduction-to-amazon-elastic-mapreduce.pdf)

# jquery - 如何正确编码 Joomla MVC 组件以执行 jQuery AJAX GETS/POSTS？

> ID：10820052
> 
> 赞同：2
> 
> 时间：2012-05-30T16:06:58.820
> 
> 标签：jquery, joomla

所以，我有这个壮观的 Joomla 组件，完成后，它将带来世界和平，解决世界饥饿问题。我所要做的就是合并通过 jquery .ajax 调用调用的代码。我目前将它们放在外部位置，以便 AJAX 调用可以访问它们，但不清楚如何正确地将它们放置在 Joomla 组件结构中。

我已经完成了研究，相信我，但只发现了很多关于“你可以试试这个或那个”的讨论。大概是因为 Joomla 依赖于 mootools，所以 Jquery 通常不在讨论范围内，但是我们内部有这个很棒的 jQuery 例程库，我想以*正确的方式*利用它。

在我看来，必须为每个调用创建一个视图，这似乎需要很多不必要的工作/开销来完成它。（比如要求飞行员与乘客一起办理登机手续）。在我看来，这不应该这么困难，所以我对我错过了什么感到困惑，或者为什么似乎没有一个直接的答案。

**UPDATE WITH SOLUTION** 接受 Soren 的回答，因为它直接回答了问题，虽然我没有指定 Joomla 1.5，但我能够快速调整他的回答以适应工作。

不过值得一提的是 Greg P - 他的回答开辟了一个我没有考虑过的其他可能性的*世界，这些可能性是我对其他项目/挑战的快速解决方案。*

*这是我能够使用 AJAX从*我的组件成功调用到我的组件的 url *，*以及我为使其工作而添加的内容。

```
index.php?option=com_mycomponent&format=raw&controller=ajax.raw&task=myfunction 
```

**组件\com_mycomponent\controllers\ajaxraw.php**

```
<?php
    defined('_JEXEC') or die( 'Restricted access' );
    jimport('joomla.application.component.controller');
    class MycomponentControllerAjaxraw extends JController
    {
        function myfunction()
        {
            echo json_encode("SomethingOrOther");
        }
    }
?> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T12:26:05.097

您应该进行 Ajax 调用

```
index.php?option=com_yourcomponent&task=ajax.function_name&format=raw 
```

然后，您需要创建一个名为 ajax.raw.php 的新控制器，并在其中编写名称与 URL 中的“function_name”匹配的函数，它们将在调用 URL 时执行。

在那些你可以使用模型 $this->getModel(); 和视图等在需要时，甚至懒惰并将您的逻辑直接放在控制器中。

如果您没有组件，请尝试使用[Joomla 组件创建器](http://www.notwebdesign.com/joomla-component-creator/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T16:15:20.407

我不知道这是否是“官方”的做法，但它对我来说肯定是干净和快速的。我只是将核心 Joomla 文件包含在组件文件夹中的单个文件中，然后将该核心用于我的 jQuery 调用 - 无需模板、MVC 或 CMS 开销。对于 Joomla 1.5，只需要 2 个文件：joomla_platform.php 用于加载基于 Joomla 的 index.php 的 Joomla 的内容，另一个用于使用它并将某些内容返回给 jQuery。[请参阅http://api.joomla.org](http://api.joomla.org)上的文档。

```
From index.php
require_once ( JPATH_BASE .DS.'includes'.DS.'defines.php' );
require_once ( JPATH_BASE .DS.'includes'.DS.'framework.php' ); 
```

**编辑：**这是我如何做到这一点的淡化版本：

不过，我想警告一下是有必要的。我在内部使用它，所以不用担心，但我返回配置的示例只是向您展示如何获取配置，***我不会将此示例输出用于一般用途***。此处的检查确保管理员用户已登录，但您可以随意调整它。

我还应该提到，这不需要组件或 jQuery 来工作。我使用相同的 2 个文件来编写快速的独立页面，这样我就不必为了利用 Joomla 平台而编写整个组件。显示的 index.php 可以很容易地输出标准 HTML 而不是 json 编码输出来显示普通网页。它绕过了我认为的框架和 CMS 的大部分用处，但有时您不需要所有特定的开销。

**组件\com_mycomponent\平台\joomla_platform.php：**

```
<?php
    /* If not already done, initialize Joomla framework */
    if (!defined('_JEXEC')) {
        define( '_JEXEC', 1 );
        //        define('JPATH_BASE', dirname(__FILE__) );
        define ('JPATH_BASE', "c:\\wamp\\www\\");
        define( 'DS', DIRECTORY_SEPARATOR );
        /* Required Files */
        require_once ( JPATH_BASE .DS.'includes'.DS.'defines.php' );
        require_once ( JPATH_BASE .DS.'includes'.DS.'framework.php' );
        /* To use Joomla's Database Class */
        require_once ( JPATH_BASE .DS.'libraries'.DS.'joomla'.DS.'factory.php' );
        require_once ( JPATH_LIBRARIES.DS.'joomla'.DS.'import.php'); // Joomla library imports.
        /* Create the Application */
        global $mainframe;
        $mainframe =& JFactory::getApplication('site');
    }
?> 
```

**组件\com_mycomponent\平台\index.php：**

```
<?php
    require_once('joomla_platform.php');
    $config = new JConfig();
    $db = &JFactory::getDBO();
    $user =& JFactory::getUser();
    //Make sure a logged in user is doing the request (not mandatory, but safer)
    //if(!$user->id) {
    //  die("Not logged in");
    if($user->gid < 23) {
        die('Administrators only!');
    } else {
        $query = "SELECT * FROM jos_users ORDER BY id DESC LIMIT 1 /* Get the last registered user */";
        $db->setQuery($query);
        $row = $db->loadAssoc();
        //echo json_encode($row);                       // Return only the SQL result
        //echo json_encode(get_object_vars($user));     // Return only the user object
        //echo json_encode(get_object_vars($config));   // Return only the config object
        echo json_encode(
        array_merge(                                    // Merge the arrays, and return them all
            $row,
            get_object_vars($user),
            get_object_vars($config)
            )
        );
    }
?> 
```

**在 php 文件中使用 jQuery 示例：**

```
$.ajax({
    type: "GET",
    url: "components/com_mycomponent/platform/index.php",
    dataType: "json",
    success: function(joomla) {
        alert('Joomla Platform info appended to myDiv for '+joomla.sitename);
        $.each(joomla, function(key, value) {
            $('#myDiv').append(key + ' : ' + value + '<br/>')
        });
    },
    error:function (xhr, ajaxOptions, thrownError){
        alert("Joomla Platform Error Status: " + xhr.status + " Thrown Errors: "+thrownError);
    }
}); 
```

# magento - 获取 Paypal Express [Magento] 的完整账单地址

> ID：10820055
> 
> 赞同：0
> 
> 时间：2012-05-30T16:07:15.380
> 
> 标签：magento, paypal, magento-1.4

paypal 模块尝试将 Paypal 返回的帐单信息（通常没有）映射到用户在结帐过程中输入的帐单信息。我喜欢在 NVP.php 模型中执行此操作的代码。

```
/**
     * Create billing and shipping addresses basing on response data
     * @param array $data
     */
    protected function _exportAddressses($data)
    {
        $address = new Varien_Object();
        Varien_Object_Mapper::accumulateByMap($data, $address, $this->_billingAddressMap);
        $address->setExportedKeys(array_values($this->_billingAddressMap));
        $this->_applyStreetAndRegionWorkarounds($address);
        $this->setExportedBillingAddress($address);

        // assume there is shipping address if there is at least one field specific to shipping
        if (isset($data['SHIPTONAME'])) {
            $shippingAddress = clone $address;
            Varien_Object_Mapper::accumulateByMap($data, $shippingAddress, $this->_shippingAddressMap);
            $this->_applyStreetAndRegionWorkarounds($shippingAddress);
            // PayPal doesn't provide detailed shipping name fields, so the name will be overwritten
            $shippingAddress->addData(array(
                'prefix'     => null,
                'firstname'  => $data['SHIPTONAME'],
                'middlename' => null,
                'lastname'   => null,
                'suffix'     => null,
            ));
            $this->setExportedShippingAddress($shippingAddress);
        }
    }

    /**
     * Adopt specified address object to be compatible with Magento
     *
     * @param Varien_Object $address
     */
    protected function _applyStreetAndRegionWorkarounds(Varien_Object $address)
    {
        // merge street addresses into 1
        if ($address->hasStreet2()) {
             $address->setStreet(implode("\n", array($address->getStreet(), $address->getStreet2())));
             $address->unsStreet2();
        }
        // attempt to fetch region_id from directory
        if ($address->getCountryId() && $address->getRegion()) {
            $regions = Mage::getModel('directory/country')->loadByCode($address->getCountryId())->getRegionCollection()
                ->addRegionCodeFilter($address->getRegion())
                ->setPageSize(1)
            ;
            foreach ($regions as $region) {
                $address->setRegionId($region->getId());
                $address->setExportedKeys(array_merge($address->getExportedKeys(), array('region_id')));
                break;
            }
        }
    } 
```

有没有人成功地修改了这个过程以获取更完整的计费信息。我们需要能够向使用 Paypal 付款的客户发送“已付款”发票，因此我们需要捕获此信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T11:23:14.867

我已经破解了该问题的解决方法。这不是最干净的方式，但我可以在使用 PayPal 付款后将帐单地址数据保存在订单中。我花了 2 天的时间研究它，最后我只编写了几行代码。我用评论 #103 标记了我的解决方法。

类 Mage_Paypal_Model_Api_Nvp 的重写方法：

```
 protected function _importAddresses(array $to)
{
    // Original Code
    //$billingAddress  = ($this->getBillingAddress()) ? $this->getBillingAddress() : $this->getAddress();
    // Workaround #103
    if ($this->getBillingAddress())
    {
        $billingAddress = $this->getBillingAddress();
    }
    else
    {
        $chkout = Mage::getSingleton('checkout/session');
        $quote = $chkout->getQuote();
        $billingAddress = $quote->getBillingAddress();
        $billingAddress->setData($billingAddress->getOrigData());
        $session = Mage::getSingleton("core/session",  array("name"=>"frontend"));
        $session->setData("syn_paypal_original_billing_address", serialize($billingAddress->getOrigData()));
    }

    $shippingAddress = $this->getAddress();

    $to = Varien_Object_Mapper::accumulateByMap($billingAddress, $to, array_flip($this->_billingAddressMap));
    if ($regionCode = $this->_lookupRegionCodeFromAddress($billingAddress)) {
        $to['STATE'] = $regionCode;
    }
    if (!$this->getSuppressShipping()) {
        $to = Varien_Object_Mapper::accumulateByMap($shippingAddress, $to, array_flip($this->_shippingAddressMap));
        if ($regionCode = $this->_lookupRegionCodeFromAddress($shippingAddress)) {
            $to['SHIPTOSTATE'] = $regionCode;
        }
        $this->_importStreetFromAddress($shippingAddress, $to, 'SHIPTOSTREET', 'SHIPTOSTREET2');
        $this->_importStreetFromAddress($billingAddress, $to, 'STREET', 'STREET2');
        $to['SHIPTONAME'] = $shippingAddress->getName();
    }
    $this->_applyCountryWorkarounds($to);

    return $to;
} 
```

并覆盖 Mage_Paypal_Model_Express_Checkout 中的方法：

```
 public function returnFromPaypal($token)
{
    $this->_getApi();
    $this->_api->setToken($token)
        ->callGetExpressCheckoutDetails();

    // import billing address
    $billingAddress = $this->_quote->getBillingAddress();
    $exportedBillingAddress = $this->_api->getExportedBillingAddress();

    // Workaround #103
    $session = Mage::getSingleton("core/session",  array("name"=>"frontend"));
    $dataOrg = unserialize($session->getData("syn_paypal_original_billing_address"));
    if (true === is_object($billingAddress))
    {
        foreach ($exportedBillingAddress->getExportedKeys() as $key) {
            if (array_key_exists($key, $dataOrg))
            {
                $billingAddress->setData($key, $dataOrg[$key]);
            }
        }
        $this->_quote->setBillingAddress($billingAddress);
    }

    // import shipping address
    $exportedShippingAddress = $this->_api->getExportedShippingAddress();
    if (!$this->_quote->getIsVirtual()) {
        $shippingAddress = $this->_quote->getShippingAddress();
        if ($shippingAddress) {
            if ($exportedShippingAddress) {
                foreach ($exportedShippingAddress->getExportedKeys() as $key) {
                    $shippingAddress->setDataUsingMethod($key, $exportedShippingAddress->getData($key));
                }
                $shippingAddress->setCollectShippingRates(true);
            }

            // import shipping method
            $code = '';
            if ($this->_api->getShippingRateCode()) {
                if ($code = $this->_matchShippingMethodCode($shippingAddress, $this->_api->getShippingRateCode())) {
                     // possible bug of double collecting rates :-/
                    $shippingAddress->setShippingMethod($code)->setCollectShippingRates(true);
                }
            }
            $this->_quote->getPayment()->setAdditionalInformation(self::PAYMENT_INFO_TRANSPORT_SHIPPING_METHOD, $code);
        }
    }
    $this->_ignoreAddressValidation();

    // import payment info
    $payment = $this->_quote->getPayment();
    $payment->setMethod($this->_methodType);
    Mage::getSingleton('paypal/info')->importToPayment($this->_api, $payment);
    $payment->setAdditionalInformation(self::PAYMENT_INFO_TRANSPORT_PAYER_ID, $this->_api->getPayerId())
        ->setAdditionalInformation(self::PAYMENT_INFO_TRANSPORT_TOKEN, $token)
    ;
    $this->_quote->collectTotals()->save();
} 
```

# emacs - Emacs - 取消定义前缀键

> ID：10820058
> 
> 赞同：3
> 
> 时间：2012-05-30T16:07:30.073
> 
> 标签：emacs, elisp

我以某种方式设法将“M”（大写 em）键定义为 sqlplus-mode 中的前缀键，这阻止了我输入 M。

如何在此模式下取消设置此前缀键？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T16:54:16.487

短期修复：

```
M-x local-set-key M self-insert-command 
```

长期修复，在您的 .emacs 文件中找到定义它的位置。@tripleee 的评论听起来确实像是出了问题的可能候选人。

# algorithm - 如何优化倒排索引和关系数据库的“文本搜索”？

> ID：10820060
> 
> 赞同：12
> 
> 时间：2012-05-30T16:07:33.157
> 
> 标签：algorithm, architecture, full-text-search, search-engine, inverted-index

# 2020-02-18 更新

我再次遇到了这个问题，虽然接受的答案保持不变，但我想分享我现在如何优化它（再次不使用第三方库或工具 - 即从头开始重新发明轮子，就像原始问题中提到的那样） .

为了简化和优化这个系统，我将在域逻辑层上使用**Trie（前缀树）**而不是**“倒排索引映射”**，并完全摒弃**“表查询”** SQL 表的不良做法。我将举例说明：

*   假设该应用程序的一些用户已经在数据库中添加了几个对象：*w、wo、woo、wood 和 woodx*。
*   这些对象（字符串/标签）将由内存中的 Trie 表示，每个 Trie 节点将包含该对象在树中所在级别的数据库发布 ID（Think *Associative Array*）。
*   当用户查询一个词时，我们在 Trie 中搜索该词并在途中累积所有相关的 ID，从搜索的词开始向下移动（**即按顺序从那里*遍历***）。我们从这些 ID 中检索所有需要的对象数据（无论是来自缓存还是数据库）。

**这是一张图片来说明：** [![特里](../Images/3dad66e140261eb0ec739b6a0a0869ca.png)](https://i.stack.imgur.com/j0uso.jpg)

*   接下来，如果用户向数据库中添加一个新词，例如“ **woodxe** ”，则 Trie 会相应更新。
*   当用户查询“ **woodx** ”时，会发生与之前相同的过程，并且会累积一个新的ID（“ **woodxe** ”的发布ID）
*   英语词典中有一个以特定字母序列开头的有限单词列表，因此向下移动并获取所有子节点仍然是一个 O(1) 复杂度的有限过程。例如，如果您在 Trie 上以“wood”开头，则在英语词典中以“wood”为前缀的子节点列表是一个有限常数。无论您将所有这些子节点返回给用户、定义限制（延迟加载/分页）还是仅显示前 10 个点击，都是个人架构偏好。

**这是一张图片来说明（检查绿色添加的内容）** [![特里 - 续](../Images/ef8a5876d296d57dcee3df4867753293.png)](https://i.stack.imgur.com/zTk54.jpg)

*   当用户的查询是多字串时，例如：“木家具”，每个字都被单独解析/添加到 Trie 中，并且每个字都有相应的匹配 ID 列表。

## *Trie* 如何改进以前的架构？

*   “表查询”很麻烦、不好的做法，而且开销很大，而且与数据库成正比增长；现在已删除。
*   我们拥有的“倒排索引映射”产生了额外的内存开销，并且无法通过新词轻松扩展（如上面的“woodx”示例）。有人可能会争辩说，查询一个 Hashmap 是 O(1)，但是在内存中有几个大的 hashmap 实际上会在一定程度上减慢速度，并且被认为是糟糕的工程设计。
*   trie 的搜索复杂度为 O(m)，其中 m 是提供的字母表中的字符数。**由于用户查询的是纯粹使用英文字母的单词，因此最大的子树将等于可用的最大英文单词（常数，即 O(1)）。此外，如前所述，英语词典中以定义的单词前缀开头的子节点的数量也是一个常数，因此遍历所有组合是 O(1)。所以总的来说这是一个 O(1) 操作。**
    *   所以查询 Trie = Get key from Hashmap = O(1) 一样快。
    *   最重要的是，在这个系统中尝试的好处是：
        *   比在内存中运行多个倒排索引哈希映射的内存开销更小
        *   集中查询树
        *   易于扩展，添加到数据库的新词只需要在内存中的现有 Trie 中添加几个新节点。即，不再有数据库增长和搜索查询数量增加的问题（可扩展性噩梦）。

* * *

# 2015-10-15 更新

早在 2012 年，我正在构建一个个人在线应用程序，实际上我想重新发明轮子，因为我天生好奇，为了学习目的并提高我的算法和架构技能。我本可以使用 apache lucene 和其他的，但是正如我所提到的，我决定构建自己的迷你搜索引擎。

**问题：**那么，除了使用可用的服务（如 elasticsearch、lucene 等）之外，真的没有办法增强这种架构吗？

* * *

# 原始问题

我正在开发一个 Web 应用程序，用户在其中搜索特定的标题（例如：book x、book y 等），这些数据位于关系数据库 (MySQL) 中。

我遵循的原则是，从数据库中获取的每条记录都缓存在内存中，这样应用程序对数据库的调用就更少了。

我开发了自己的迷你搜索引擎，具有以下架构：
![架构图](../Images/2de783ac520c5b3c19c9b33462233a0c.png)
这是它的工作原理：

*   a) 用户搜索记录名称
*   b）系统检查查询以什么字符开头，检查是否有查询：获取记录。如果不存在，则添加它并使用两种方式从数据库中获取所有匹配记录：
    *   表“查询”（这是一种历史表）中已经存在的任一查询，因此根据 ID 获取记录（快速性能）

    *   或者，否则使用**Mysql LIKE %% 语句**来获取记录/ID（然后将用户使用的查询连同它映射到的 ID 一起保存在历史表查询中）。
        -->然后它将记录及其ID添加到 **缓存**中，并且仅将ID添加到倒排索引映射中。
*   c) 结果返回到 UI

该系统工作正常，但是我有**两个**主要问题，我找不到一个好的解决方案（过去一个月一直在尝试）：

**第一个问题：**
如果您检查点 (b) ，没有找到查询“历史”并且它必须使用**Like %%**语句的情况：**当**查询匹配数据库中的大量记录（而不是一个或二）：

*   从 Mysql 获取记录需要一些时间（这就是我在特定列上使用 INDEXES 的原因）
*   然后是时候保存查询历史了
*   然后是时候向缓存和倒排索引图添加记录/ID

**第二个问题：**
应用程序允许用户自己添加新记录，其他登录到应用程序的用户可以**立即使用这些记录。**
然而，为了实现这一点，必须更新倒排索引映射和表“查询”，以便在任何旧查询与新词匹配的情况下。例如，如果要添加**新**记录“woodX”，旧查询“wood”仍然会映射到它。因此，为了将查询“wood”重新连接到这个新记录，这就是我现在正在做的事情：

*   新记录“woodX”被添加到“记录”表中
*   然后我运行一个**Like %%**语句来查看表“查询”中哪个**已经存在的**查询映射到该记录（例如“wood”），然后将此查询与新记录 id 添加为新行： [ wood, new ID]。
*   然后在内存中，更新倒排索引 Map 的“wood”键的值（即列表），将新的记录 ID 添加到这个列表中

--> 因此，现在如果远程用户搜索“wood”，它将从**内存**中获取：wood 和 woodX

这里的**问题**也是**时间消耗**。将所有查询历史（在表查询中）与新添加的单词匹配需要很长时间（匹配的查询越多，时间越长）。那么内存中的更新也需要很多时间。

我正在**考虑解决这个时间问题，****首先**将所需的结果返回给用户，然后让应用程序使用所需的数据发布一个**ajax**调用以实现所有这些更新任务。但我不确定这是一种不好的做法还是一种不专业的做事方式？
所以在过去的一个月里（再多一点），我试图为这个架构考虑最好的优化/修改/更新，但我不是文档检索领域的专家（实际上它是我构建的第一个迷你搜索引擎）。

对于我应该做些什么来实现这种架构，我将不胜感激任何反馈或指导。
提前致谢。

**PS：**

*   它是一个使用 servlet 的 j2ee 应用程序。
*   我正在使用 MySQL innodb（因此我不能使用全文搜索选项）

* * *

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-10-15T11:45:01.807

我不得不说，我认为你的设计不太适合这个问题。你现在看到的问题就是这样的后果。除此之外，您当前的解决方案无法扩展。

这是一个可能的解决方案：

1.  重新设计您的数据库，使其仅包含权威数据，但不包含派生数据。所以所有缓存条目都必须从 MySQL 中消失。

2.  仅在应用程序内存中的请求期间保留数据。这使您的应用程序设计更加简单（想想竞争条件），并使您能够扩展到合理数量的客户端。

3.  引入缓存层。我强烈建议使用已建立的产品，而不是自己构建。这使您摆脱了应用程序中所有自定义构建的缓存逻辑，甚至可以更好地完成工作。

您可以查看 Redis 或 Memcached 的缓存层。我认为 LRU 策略应该适合这里。根据您的查询变得多么复杂，像 Lucene 这样的专用索引搜索机制也可能有意义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-10-15T16:53:49.047

我强烈推荐 Sphinx 搜索服务器，它在全文搜索中得到了最佳优化。访问[http://sphinxsearch.com/](http://sphinxsearch.com/)。

它旨在与 MySQL 一起使用，因此它是您当前工作空间的补充。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-10-14T12:53:23.580

我不假装有解决方案，但这是我的想法。首先，我喜欢你的耗时查询 LIKE%% ：我会在 MySQL 中执行一个仅限于几个答案的查询，比如十几个，然后将其返回给用户，然后等待用户是否想要更多匹配的记录，或者启动在后台进行完整查询，具体取决于您将来搜索的索引需求。

更一般地说，我认为将所有内容存储在内存中可能会导致有一天内存消耗过多。虽然搜索引擎在将所有内容保存在内存中时会变得越来越快，但您必须在添加或更新数据时使所有这些缓存保持最新，这肯定会花费越来越多的时间。

这就是为什么我认为我一天在“开源论坛软件”（我不记得它的名字）中看到的解决方案对于帖子中的文本搜索来说还不错：每次插入数据时，一个名为“Words”的表" 跟踪每个现有单词，另一个表（比如说“WordsLinks”）记录每个单词和它出现的帖子之间的链接。这种解决方案有一些缺点：

*   数据库中的每次插入、删除、更新都要慢很多
*   搜索引擎的数据选择必须预先考虑：如果您选择保留您从未保留的两个字母单词，那么对于已经记录的数据来说已经太迟了，除非您启动完整的数据重新处理。
*   您必须注意 DELETE 以及 UPDATE 和 INSERT

但我认为有一些很大的优势：

*   计算时间可能与“内存解决方案”（最终）相同，但它是在每个数据库的 Create/Update/Delete 中划分的，而不是在查询时。
*   寻找一个完整的词，或者“以”开头的词是瞬时的：当被索引时，在“词”表中搜索是二分法的。并且“WordLinks”表查询速度非常快，无论是使用索引。
*   同时查找多个单词可能很简单：为每个找到的单词收集一组“WordLinks”，并对它们执行交集以仅保留所有这些组共有的“数据库 ID”。例如单词“tree”和“leaf”，第一个可以给出表格记录{1,4,6}，第二个可以给出{1,3,6,9}。因此，对于交集，只保留公共部分很简单：{1, 6}。
*   单列表中的“Like %%”可能比不同表的不同字段中的许多“Like %%”更快。每个数据库引擎都处理一些缓存：“Words”表可能足够小，可以保存在内存中
*   我认为如果数据变得庞大，性能和内存问题的风险很小。
*   由于每次搜索都很快，您甚至可以查找同义词。例如，如果用户没有找到“以太网”的任何内容，则搜索“网络”。
*   您可以应用规则，例如拆分骆驼大小写单词以从“woodX”生成例如 3 个单词“wood”、“X”、“woodX”。每个“词”的存储和查找都非常轻巧，因此您可以做很多事情。

我认为您需要的解决方案可能是多种方法的混合：例如，您可以保持轻量级的 UPDATE、INSERT、DELETE，并从 TRIGGER 启动“Words”和“WordsLinks”馈送。

只是为了轶事，我看到我公司开发的一个软件，它决定将“一切”（！）保留在内存中。它使我们向客户推荐购买具有 64GB RAM 的服务器。有点贵。它解释了为什么当我看到最终可能导致内存填充的解决方案时，我会非常谨慎。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-10-15T17:17:55.767

我确信这可以在 MySQL 中实现，但仅使用现有的面向搜索的数据库（如[Elasticsearch](https://www.elastic.co/products/elasticsearch) ）会少很多努力。它使用 Lucene 库来实现倒排索引，拥有丰富的文档，支持水平缩放，相当简单的查询语言等等。我想要做到这一点已经做了很多工作，处理缓存、竞争条件、错误、性能问题等将是更多的工作，以使解决方案成为“生产级”。

# c++ - 错误 C2227：“->”左侧“函数名”模板类错误

> ID：10820061
> 
> 赞同：2
> 
> 时间：2012-05-30T16:07:33.553
> 
> 标签：c++, templates

编辑：谢谢你们！

我目前正在创建一个模板资源管理器类，它在实际代码中没有显示任何错误，但是当我编译时，我遇到了其中一些

错误 C2227：“->getHandle”左侧必须指向类/结构/联合/通用类型

```
template <class T>
unsigned int ResourceManager<T>::add(string& name, string& path)
{
    T* resource = getResource(name, path);

    if (resource != nullptr)
    {
        resource->incrementCount();    // doesn't like 
        return resource->getHandle();  // these lines calling member functions
    }
    else
        unsigned int handle;
        bool freeHandle = false;

        if (!m_freeHandles.empty())
        {
            handle = m_freeHandles.top();
            m_freeHandles.pop();
            freeHandle = true;
        }
        else
        {
            handle = m_resourceList.size();
            freeHandle = false;
        }

        T* newResource = new T(handle, name, path);

        if (!freeHandle)
            m_resourceList.push_back(newResource);
        else
            m_resourceList[handle] = newResource;

        return newResource->getHandle();
    }
    return -1;
} 
```

对于每个资源，我都有一个基类 Resource ，它看起来像

```
class Resource
{
public:

Resource(unsigned int handle, string& name, string& path);
Resource(string& name, string& path);
virtual ~Resource();
string getFileName() { return m_filename; }
void setFileName(string filename) { m_filename = filename; }
string getFilePath() { return m_filepath; }
void getFilePath(string filePath) { m_filepath = filePath; }
string getName() { return m_name; }
void getName(string name) { m_name = name; }
unsigned int getHandle() { return m_handle; }
void setHandle(unsigned int handle) { m_handle = handle; }
void incrementCount() { m_referenceCount++; }
void decrementCount() { m_referenceCount--; }
int getReferenceCount() { return m_referenceCount; }

protected:

string m_filename;
string m_filepath;
string m_name;
unsigned int m_handle;
int m_referenceCount;
}; 
```

我正在从中获取各种资源，我使用这些资源......

```
// just an abbreviated example
class Model : public Resource
{ };

ResourceManager<Model*> modelResourceManager;
modelResourceManager.add("model.obj", "models/"); 
```

我在这里缺少什么吗？我在 ResourceManager.h 中包含了“Resource.h”，甚至包含了特定的实现，例如“model.h”，但我仍然收到此错误。

这可能是非常微不足道的，我一直盯着这个太久了，但我们将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T16:10:38.027

`resource`是 a `T*`，但在你的情况下`T`是`Model*`，所以`resource`是 type `Model**`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-30T16:10:47.480

您正在`modelResourceManager`使用设置为的模板参数进行实例化`Model*`。也就是说，`T`将`Model*`在您的模板化代码中，因此`resource`and `newResource`（它们是`T*`）将是`Model**`- 即，指针到指针到 - `Model`。

所以`resource->`无效。`(*resource)->`将会; 或者您可能打算`Model`用作模板参数。

# java - 可执行的 JAR 文件不会运行

> ID：10820062
> 
> 赞同：-2
> 
> 时间：2012-05-30T16:07:38.943
> 
> 标签：java, jar, nullpointerexception, executable-jar

> **可能重复：**
> [无法使用 java -jar 命令执行 jar 文件](https://stackoverflow.com/questions/8192647/failing-to-execute-the-jar-file-using-java-jar-command)

我在 NetBeans 中处理一个项目，并且能够在没有任何错误的情况下进行编译，但是当我尝试通过双击运行 sample.jar 文件时，我得到的只是来自 JVM 的错误：

> 发生Java异常

所以我尝试使用从命令提示符运行

```
prompt>java -jar sample.jar 
```

我收到以下错误

```
Exception in thread "main" java.lang.NullPointerException
    at sun.launcher.LauncherHelper.checkAndLoadMain(Unknown Source) 
```

有人能帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T16:13:11.153

您必须在 jar 文件中创建一个指示默认主类的清单文件，然后将清单文件添加到 jar 文件中。

[请参阅http://docs.oracle.com/javase/7/docs/technotes/guides/jar/index.html](http://docs.oracle.com/javase/7/docs/technotes/guides/jar/index.html)上有关 Oracle jar 工具的文档

# spring-mvc - SetLocale 在 jsp 站点中无法以德语格式化货币

> ID：10820068
> 
> 赞同：7
> 
> 时间：2012-05-30T16:08:23.920
> 
> 标签：spring-mvc, jstl, jsp-tags, currency-formatting

我对 jstl 标签库感到困惑：

我想将数字格式化为具有德国风格的货币......但我尝试的一切都没有奏效......

我找到了以下示例，但输出相同-.-

```
<%@page contentType="text/html" pageEncoding="UTF-8"%>
<%@taglib uri="http://java.sun.com/jsp/jstl/core"
      prefix="c" %>
<%@taglib uri="http://java.sun.com/jsp/jstl/fmt"
      prefix="fmt" %>

<html>
<head>
    <title>format number</title>
</head>
<body>
    <c:set var="val" value="40.52" />
    <p> Currency in USA
    <fmt:setLocale value="en_US"/>
    <fmt:formatNumber value="${val}"
              type="currency" />
    </p>

    <p>Currency in Germany
    <fmt:setLocale value="de_DE"/>
    <fmt:formatNumber value="${val}"
              type="currency"/>
    </p>
</body>
</html> 
```

这就是输出：

```
Currency in USA $40.52

Currency in Germany $40.52 
```

那里出了什么问题？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-11T16:22:59.320

太棒了，偶然我得到了解决问题的方法：

诀窍是将`setLocale`标签的范围参数设置为 session :D 然后它就可以工作了 ^^ sweet :)

所以正确的代码片段如下所示：

```
<c:set var="val" value="40.52" />
<p> Currency in USA
<fmt:setLocale value="en_US" scope="session"/>
<fmt:formatNumber value="${val}"
          type="currency" />
</p>

<p>Currency in Germany
<fmt:setLocale value="de_DE" scope="session"/>
<fmt:formatNumber value="${val}"
          type="currency"/> 
```

好的，我真的不知道它为什么会起作用，但这里有一些关于我的项目设置的更多信息：

*   Spring 3 框架（MVC，安全使用）
*   以及标准应用程序和 servlet 设置
*   每件事都在 tomcat 7 中运行，所以我使用 JSP 2.2

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-22T22:38:26.943

我有同样的问题。但我认为这与属性文件有关。我有 2 个属性文件，text.properties 和 text_sv.properties，当初始语言环境不是“sv”时，我可以在我的 jsp 文件中的任何位置使用 fmt:setLocale 更改它。但是当初始语言环境是 'sv' 时， fmt:setLocale 什么也没做。会话不起作用..

# python - 这个函数的Pythonic等价物？

> ID：10820069
> 
> 赞同：4
> 
> 时间：2012-05-30T16:08:32.007
> 
> 标签：python

我有一个从另一种语言移植的功能，你能帮我把它变成“pythonic”吗？

这里以“非pythonic”方式移植的函数（这是一个人为的例子 - 每个任务都与一个项目或“无”相关联，我们需要一个不同项目的列表，不同的意思是没有重复的 .identifier属性，从任务列表开始）：

```
@staticmethod
def get_projects_of_tasks(task_list):

    projects = []
    project_identifiers_seen = {}

    for task in task_list:

        project = task.project

        if project is None:
            continue

        project_identifier = project.identifier

        if project_identifiers_seen.has_key(project_identifier):
            continue

        project_identifiers_seen[project_identifier] = True
        projects.append(project)

    return projects 
```

我什至还没有特别开始使它“pythonic”不要从错误的脚开始（例如列表理解与“如果project.identifier不是None，filter（）基于谓词查找基于字典的标识符注册表，使用 set() 去除重复项等）

编辑：

根据反馈，我有这个：

```
@staticmethod
def get_projects_of_tasks(task_list):

    projects = []
    project_identifiers_seen = set()

    for task in task_list:

        project = task.project

        if project is None:
            continue

        project_identifier = project.identifier

        if project_identifier in project_identifiers_seen:
            continue

        project_identifiers_seen.add(project_identifier)
        projects.append(project)

    return projects 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-30T16:16:52.290

这段代码没有什么不符合 Python 的。一些可能的改进：

*   `project_identifiers_seen`可以是集合，而不是字典。
*   `foo.has_key(bar)`拼写更好`bar in foo`
*   我怀疑这是`staticmethod`一类。通常不需要 Python 中的类，除非您实际上是在进行数据封装。如果这只是一个普通功能，请将其设为模块级功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-30T16:18:49.773

```
def get_projects_of_tasks(task_list):
    seen = set()
    return [seen.add(task.project.identifier) or task.project #add is always None
            for task in task_list if 
            task.project is not None and task.project.identifier not in seen] 
```

这是有效的，因为 (a)`add`返回`None`（并`or`返回评估的最后一个表达式的值）并且 (b) 映射子句（第一个子句）仅在 if 子句为 时才执行`True`。

没有理由将它放在列表理解中 - 您也可以将其设置为循环，实际上您可能更喜欢这样做。这种方式的优点是很明显您只是在构建一个列表，以及其中应该包含的内容。

我没有用过`staticmethod`，因为很少需要它。要么将其作为模块级函数，要么将`classmethod`.

* * *

另一种方法是生成器（感谢@delnan 指出这一点）：

```
def get_projects_of_tasks(task_list):
    seen = set()
    for task in task_list:
        if task.project is not None and task.project.identifier not in seen:
           identifier = task.project.identifier
           seen.add(identifier)
           yield task.project 
```

这消除了对理解的副作用（这是有争议的）的需要，但保持清楚正在收集的内容。

为了避免另一个 if/continue 构造，我留下了对`task.project.identifier`. 这可以通过使用 Promise 库方便地消除。

* * *

此版本使用承诺来避免重复访问 task.project.identifier 而无需包含 if/continue：

```
from peak.util.proxies import LazyProxy, get_cache # pip install ProxyTypes

def get_projects_of_tasks(task_list):
    seen = set()
    for task in task_list:
        identifier = LazyProxy(lambda:task.project.identifier) # a transparent promise
        if task.project is not None and identifier not in seen:
           seen.add(identifier)
           yield task.project 
```

这对 AttributeErrors 是安全的，因为在检查`task.project.identifier`之前从未访问过。`task.project`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-30T16:21:24.990

关于什么：

```
project_list = {task.project.identifier:task.project for task in task_list if task.project is not None}
return project_list.values() 
```

对于 2.6- 使用 dict 构造函数：

```
return dict((x.project.id, x.project) for x in task_list if x.project).values() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-30T16:30:20.510

有人说[EAFP](http://docs.python.org/glossary.html#term-eafp)是 pythonic，所以：

```
@staticmethod
def get_projects_of_tasks(task_list):

    projects = {}

    for task in task_list:
        try:
            if not task.project.identifier in projects:
                projects[task.project.identifier] = task.project
        except AttributeError:
            pass

    return projects.values() 
```

当然，明确的检查也不会错，如果许多任务没有项目，当然会更好。

如果项目的顺序很重要，那么只需一个 dict 来跟踪看到的标识符和项目就足够了，那么[`OrderedDict`](http://docs.python.org/library/collections#collections.OrderedDict)(python2.7+) 可能会派上用场。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-30T21:31:37.387

已经有很多好的答案了，而且，事实上，你已经接受了一个！但我想我会再添加一个选项。许多人已经看到，您的代码可以使用生成器表达式或列表推导式变得更加紧凑。我将建议使用生成器表达式进行初始过滤的混合样式，同时`for`在最终过滤器中保持循环。

这种风格相对于原始代码风格的优势在于，它通过消除`continue`语句来简化控制流程。这种风格相对于单一列表推导的优势在于它`task.project.identifier`以自然的方式避免了多次访问。它还`seen`透明地处理可变状态（集合），我认为这很重要。

```
def get_projects_of_tasks(task_list):
    projects = (task.project for task in task_list)
    ids_projects = ((p.identifier, p) for p in projects if p is not None)

    seen = set()
    unique_projects = []
    for id, p in ids_projects:
        if id not in seen:
            seen.add(id)
            unique_projects.append(p)
    return unique_projects 
```

因为这些是生成器表达式（括在括号中而不是方括号中），所以它们不会构建临时列表。第一个生成器表达式创建一个可迭代的项目；您可以将其视为`project = task.project`一次在所有项目上执行原始代码中的行。第二个生成器表达式创建一个可迭代的`(project_id, project)`元组。最后的`if`子句过滤掉了`None`值；仅在通过过滤器`(p.identifier, p)`时才评估。`p`这两个生成器表达式一起消除了前两个`if`块。其余代码与您的基本相同。

[还要注意Marcin/delnan](https://stackoverflow.com/a/10820225/577088)的极好的建议，即您使用`yield`. 这进一步减少了代码的冗长，将其归结为基本要素：

```
def get_projects_of_tasks(task_list):
    projects = (task.project for task in task_list)
    ids_projects = ((p.identifier, p) for p in projects if p is not None)

    seen = set()
    for id, p in ids_projects:
        if id not in seen:
            seen.add(id)
            yield p 
```

唯一的缺点 - 如果这不明显 - 是如果您想永久存储项目，您必须将生成的迭代传递给`list`.

```
projects_of_tasks = list(get_projects_of_tasks(task_list)) 
```

# wordpress - 多站点相关帖子

> ID：10820071
> 
> 赞同：1
> 
> 时间：2012-05-30T16:09:01.783
> 
> 标签：wordpress

我目前一直在使用此代码根据与该帖子关联的标签为我的每个博客帖子输出相关帖子。

```
<?php

    $orig_post = $post;

    global $post;

    $tags = wp_get_post_tags($post->ID);

    if ($tags) {

    $tag_ids = array();

    foreach($tags as $individual_tag) $tag_ids[] = $individual_tag->term_id;

    $args=array(
        'tag__in' => $tag_ids,
        'post__not_in' => array($post->ID),
        'posts_per_page'=>5, // Number of related posts that will be shown.
        'caller_get_posts'=>1
         );

    $my_query = new wp_query( $args );
    if( $my_query->have_posts() ) {
    while( $my_query->have_posts() ) {
    $my_query->the_post(); ?>

    <div class="brelated">
        <?php get_the_image(array(
    'custom_key' => array('post_thumbnail','thumbnail'),
    'default_size' => 'thumbnail',
    'default_image' => $defthumb,
    'image_scan' => true,
    'image_class' => 'single',
)); ?>
<a href="<? the_permalink()?>" rel="bookmark" title="<?php the_title(); ?>"><?php the_title(); ?></a>
    </div>
    <? }
       }
       }
    $post = $orig_post;
    wp_reset_query(); ?>
    </div> 
```

但是，我想根据这些标签在我的多站点安装中包含来自另一个博客的相关帖子。

有什么方法可以使用类似的代码来使用 switch_to_blog() 函数来实现这一点。到目前为止，我几乎没有成功。我不是程序员，但我对 WordPress 代码的工作原理非常了解。

# ruby - 在 RhoMobile 应用程序中包含预种子数据库？

> ID：10820077
> 
> 赞同：1
> 
> 时间：2012-05-30T16:09:36.417
> 
> 标签：ruby, database, sqlite, rhomobile, rhodes

所以我打算按照[这里的建议](https://stackoverflow.com/questions/7836527/rhomobile-initial-database)`Rho::RhoUtils.load_offline_data`使用该方法来播种我的应用程序的数据库

我想知道的是我应该在哪里调用这个方法？理想情况下，我希望在构建应用程序时可以使用种子数据库。因此，例如，与其在第一次应用程序时播种数据库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T10:21:03.027

看起来它是为[AppApplication 初始化方法而设计的](http://docs.rhomobile.com/rhodes/application#appapplication-class)

# c# - 引发事件或返回布尔值？

> ID：10820078
> 
> 赞同：1
> 
> 时间：2012-05-30T16:09:41.527
> 
> 标签：c#

我想知道哪个是打印功能最实用的选项。假设我有一台打印机和这样的打印方法。

```
 printerEngine.Print("StuffToPrint",Printer,Qty); 
```

如果某些事情失败了，我应该返回一个布尔值（在这种情况下为 false）或引发一个 PrintingFailed 事件。

打印失败事件允许我添加更多关于它失败原因的上下文，但我不确定最佳的继续方式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T16:11:08.637

另一个明显的选择是抛出异常，就像你试图写入文件或类似的东西一样。

该异常可以包含尽可能多的详细信息，您可以让它在堆栈中冒泡到最合适的位置来处理它。

如果该`Print`方法是异步的，您可能希望考虑返回 a`Task`并让它*指示*成功、失败、完成等（假设您使用的是 .NET 4）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-30T16:12:50.517

您可能希望因异常而失败，因为发生了一些异常导致您的打印作业失败。您可以在异常中包含尽可能多的详细信息并在需要的地方进行处理。仅当您预期会导致工作失败的事情发生时，才可能使用布尔值。

看看Eric Lippert 关于异常处理的[这篇](http://blogs.msdn.com/b/ericlippert/archive/2008/09/10/vexing-exceptions.aspx)博客文章，它是一个很好的指南。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-30T16:11:56.287

这取决于，您是想向用户提供失败的原因，还是将其记录到某种日志中？如果你想做其中任何一个，然后引发事件。

如果您不想执行这些操作并且只想确定它是否失败，只需使用`bool`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-30T16:17:21.690

添加一个bool返回值太简单了，无法开始枚举所有可能发生的问题。你可以有一些预先准备好的错误代码......但这仍然没有提供任何你需要的上下文。

一个事件是好的。它允许您返回丰富的信息。但是这两种方法都需要完全不同的编程模型。异常可以在调用它的同一个堆栈线程上处理。一个事件可能在完全不同的上下文中被调用。您可能没有可用的所有信息来正确处理使用异常可能遇到的故障。因此，权衡取舍取决于您。

# javascript - createElement() 与 innerHTML 什么时候使用？

> ID：10820079
> 
> 赞同：9
> 
> 时间：2012-05-30T16:09:41.637
> 
> 标签：javascript

我在 sql 表中有一些数据。我通过 JSON 将它发送到我的 JavaScript。

从那里我需要将其组合成 HTML，以便通过 2 种方式中的一种方式向用户显示。

*   通过编写 html 字符串并插入到持有元素的 .innerHTML 属性中
*   通过对我需要的每个元素使用 createElment() 并直接附加到 DOM

以下两个问题都没有给出可量化的答案。

从第一个链接中的第一个答案开始，第三个原因（前两个原因不适用于我的环境）

> 在某些情况下可能会更快

有人可以建立一个基本案例，说明 createElement() 方法何时更快，为什么？

这样，人们就可以根据他们的环境对使用哪个做出有根据的猜测。

就我而言，我不担心保留现有的 DOM 结构或事件侦听器。只是效率（速度）。

我没有使用关于我提供的第二个链接的库。但它是为那些可能的人准备的。

* * *

***研究/链接***

[createElement 相对于 innerHTML 的优势？](https://stackoverflow.com/questions/2946656/advantages-of-createelement-over-innerhtml)

[JavaScript：使用 innerHTML 或（大量）createElement 调用来添加复杂的 div 结构会更好吗？](https://stackoverflow.com/questions/737307/javascript-is-it-better-to-use-innerhtml-or-lots-of-createelement-calls-to-ad)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T16:15:40.453

向 DOM 添加*n*次所花费的时间比向 DOM 添加一次要多*n倍。*(:P)

这是我个人遵循的逻辑。

因此，例如，当它要创建一个 SELECT 元素并向其添加几个选项时，我更喜欢使用 innerHTML 一次添加所有选项，而不是使用 createElement 调用*n*次。

这有点像将 BATCH 操作与“一对一”进行比较……只要您可以分解，就应该这样做！

编辑：阅读评论我知道有一个特性（DOM DocumentFragment）可以让我们节省这样的开销，同时利用 DOM 封装。在这种情况下，如果性能真的有可比性，我绝对不会怀疑并选择了 DOM 选项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-31T04:33:22.570

我以为我在某处读到 createElement 和 appendElement 更快。这是有道理的，考虑到 document.write() 和 innerHTML 必须解析一个字符串，*并*创建和附加元素。我写了一个快速测试来确认这一点：

```
<html>
<body>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>
function inner() {

    var test = '';
    for (var i=0; i<10000; i++) {
        test += '<p><a href="../" target="_blank">bogus link</a> with some other <strong>stuff</strong></p>';
    }

    console.time('innerHTML');
    document.getElementById('test').innerHTML = test;
    console.timeEnd('innerHTML');
}

function jq() {
    var test = '';
    for (var i=0; i<10000; i++) {
        test += '<p><a href="../" target="_blank">bogus link</a> with some other <strong>stuff</strong></p>';
    }

    console.time('jquery');
    jQuery('#test').html(test);
    console.timeEnd('jquery');
}

function createEl() {
    var dest = document.getElementById('test');

    console.time('createel');
    //dest.innerHTML = '';//Not IE though?
    var repl = document.createElement('div');
    repl.setAttribute('id','test');
    for (var i=0; i<10000; i++) {
        var p = document.createElement('p');
        var a = document.createElement('a');
        a.setAttribute('href','../'); a.setAttribute('target','_blank');
        a.appendChild(document.createTextNode("bogus link"));
        p.appendChild(a);
        p.appendChild(document.createTextNode(" with some other "));
        var bold = document.createElement('strong');
        bold.appendChild(document.createTextNode("stuff"));
        p.appendChild(bold);
        repl.appendChild(p);
    }
    dest.parentNode.replaceChild(repl,dest);
    console.log('create-element:');
    console.timeEnd('createel');
}
</script>
<button onclick="inner()">innerhtml</button>
<button onclick="jq()">jquery html</button>
<button onclick="createEl()">Create-elements</button>
<div id="test">To replace</div>
</body>
</html> 
```

在这个例子中，写出 HTML 的 createElement - appendChild 方法比 innerHTML/jQuery 快得多！

# deployment - 将 MVC3 webapp 发布到 Azure：忙碌 - 骑自行车

> ID：10820083
> 
> 赞同：0
> 
> 时间：2012-05-30T16:10:01.337
> 
> 标签：deployment, azure

我有一个包含 Bing Translate API 的 MVC3 Web 应用程序。在模拟器上一切正常，但是当我将它部署到 Windows Azure 时，我一次又一次地遇到这个问题（我重试了两次以上）：

```
Instance 0 of role Website is busy
Instance 0 of role Website is cycling 
```

它停止骑自行车很长时间。在门户中，我看到了这条消息：

`Waiting for role to start... System is initializing`

我已经选择了“ `Add deployable assemblies`”，并检查了所有引用是否为真`Copy Local = true` 我还检查了我的帐户存储的连接字符串，我将我的项目设置为通过帐户存储在云上工作。

这里是我的必应翻译 API 的 web.config

```
<system.serviceModel>
    <bindings>
      <basicHttpBinding>
        <binding name="BasicHttpBinding_LanguageService" closeTimeout="00:25:00"
          openTimeout="00:25:00" receiveTimeout="00:25:00" sendTimeout="00:25:00"
          allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
          maxBufferSize="65536" maxBufferPoolSize="524288" maxReceivedMessageSize="65536"
          messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered"
          useDefaultWebProxy="true">
          <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
            maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <security mode="None">
            <transport clientCredentialType="None" proxyCredentialType="None"
              realm="" />
            <message clientCredentialType="UserName" algorithmSuite="Default" />
          </security>
        </binding>
      </basicHttpBinding>
    </bindings>
    <client>
      <endpoint address="http://api.microsofttranslator.com/V2/soap.svc"
        binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_LanguageService"
        contract="BingTranslator.LanguageService" name="BasicHttpBinding_LanguageService" />
    </client>
  </system.serviceModel> 
```

我已经搜索了很长时间，但没有什么对我有用。请给我你的帮助。此致

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T18:42:09.010

我可以告诉您如何将这些错误转换为一些信息：

**案例一：**您的状态在 Web 角色中循环：

1.  Web角色开始
2.  Web角色忙
3.  Web角色单车
4.  Web角色未知状态
5.  Web角色重启

这可能是一个特定于角色的问题，您最好的办法是对您的实例进行 RDP 并查找几件事，即潜在异常的 Azure 诊断日志、事件日志、Azure BootStrapper 日志、IIS 配置器日志等。这将帮助您找到问题比任何其他方法都快，除非您可以从 Azure 存储中获取包含有关潜在问题的所有详细信息的 Azure 诊断日志。

**案例二：**您的状态在 Full Machine 中循环：

1.  开始...
2.  正在初始化...
3.  Web角色开始
4.  Web角色忙
5.  Web角色单车
6.  Web角色重启

这可能是 VM 本身正在循环的特定于机器的问题，这是联系 Windows Azure 支持团队为您调查的好人选。

# openldap - 是否有 openldap 核心架构参考？

> ID：10820087
> 
> 赞同：0
> 
> 时间：2012-05-30T16:10:09.680
> 
> 标签：openldap

我正在寻找 openldap common core schemas 参考，虽然我找到[了这个参考](http://www.zytrax.com/books/ldap/ape/)，但我已经非常谨慎地警告我（在某些情况下受到侮辱）不要依赖这个来源来确保准确性。所以我将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T22:24:36.900

不知道为什么骂人。我一直认为该来源可靠。然而，core.schema 的引用是源代码中引用的 RFC。

# asp.net - Windows Server 2003 上的 IIS 6 RAM 分配

> ID：10820089
> 
> 赞同：0
> 
> 时间：2012-05-30T16:10:10.207
> 
> 标签：asp.net, .net, iis, memory, iis-6

我有我的 IIS 6 运行我的网站。它位于具有 4GB RAM 的 Windows Server 2003 上。在用户提交表单（数学统计资料）后，我运行 SQL 密集型代码。这个过程不是线程化的（应该是线程化的，特别是如果 2 个或更多用户运行相同的东西？）。但是我的进程似乎只消耗了几 GB 的内存并且服务器爬行。如何让我的 IIS 进程使用几乎所有的内存？

我在其他网站上看到它的 2GB 或 3GB 是使用 boot.ini 分配的。但是进程使用内存还有另一种方式吗？如果我使它成为多线程，每个线程都会有一个进程吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T20:23:03.737

如果 IIS 仍有可用内存，则不需要更多。即使你给它更多的内存，它也会表现得更好。很高兴看到一些内存没有被使用，并且可以作为 IIS 用于其他进程。如果你想做多线程，这取决于你在使用更多内存时并行执行的操作，以及是否获得任何性能。

这里的基本内容是从您的要求开始，看看您可以使用哪些峰值。然后进行性能测试，看看您的机器是否可以处理该负载。为了确保您可以处理更多，请进行其他测试，以查看您的机器可以处理的窥视负载。然后你就会知道你是否需要投入更多的时间。

检查你的数据库服务器，看看你的瓶颈是否不在那台机器上，大多数开发人员忘记优化和维护他们的数据库。

# ruby-on-rails - 由于未能安装 gems，Heroku 推送被拒绝

> ID：10820091
> 
> 赞同：1
> 
> 时间：2012-05-30T16:10:24.903
> 
> 标签：ruby-on-rails, heroku, bundler

```
C:\documents\projects\AJP\app>bundle update
Fetching gem metadata from http://rubygems.org/.......
Using rake (0.8.7)
Using abstract (1.0.0)
Using activesupport (3.0.7)
Using builder (2.1.2)
Using i18n (0.5.0)
Using activemodel (3.0.7)
Using erubis (2.6.6)
Using rack (1.2.5)
Using rack-mount (0.6.14)
Using rack-test (0.5.7)
Using tzinfo (0.3.33)
Using actionpack (3.0.7)
Using mime-types (1.18)
Using polyglot (0.3.3)
Using treetop (1.4.10)
Using mail (2.2.19)
Using actionmailer (3.0.7)
Using arel (2.0.10)
Using activerecord (3.0.7)
Using activeresource (3.0.7)
Using bundler (1.1.4)
Using thor (0.14.6)
Using railties (3.0.7)
Using rails (3.0.7)
Using acts-as-taggable-on (2.3.1)
Using annotate (2.4.0)
Using diff-lcs (1.1.3)
Using factory_girl (1.3.3)
Using factory_girl_rails (1.0)
Using faker (0.3.1)
Using gravatar_image_tag (1.0.0.pre2)
Using jquery-rails (1.0.19)
Using nested_form (0.2.0)
Using nokogiri (1.5.2)
Using pg (0.11.0)
Using rspec-core (2.5.2)
Using rspec-expectations (2.5.0)
Using rspec-mocks (2.5.0)
Using rspec (2.5.0)
Using rspec-rails (2.5.0)
Using webrat (0.7.1)
Using will_paginate (3.0.3)
Your bundle is updated! Use `bundle show [gemname]` to see where a bundled gem is installed.

C:\documents\projects\AJP\app>git st
# On branch master
nothing to commit (working directory clean)

C:\documents\projects\AJP\app>git ls-files
.gitignore
.settings/org.eclipse.core.resources.prefs
Gemfile
Gemfile.lock
README
... 
```

已经运行了`bundle install`和`bundle update`。另请注意，`Gemfile`和`Gemfile.lock`文件在提交的文件中。

但是之后：

```
C:\documents\projects\AJP\app>git push heroku master
Enter passphrase for key '/c/Users/AJames/.ssh/id_rsa':
Counting objects: 46, done.
Delta compression using up to 2 threads.
Compressing objects: 100% (31/31), done.
Writing objects: 100% (31/31), 4.46 KiB, done.
Total 31 (delta 24), reused 0 (delta 0)

-----> Heroku receiving push
-----> Ruby/Rails app detected
-----> Detected Rails is not set to serve static_assets
       Installing rails3_serve_static_assets... done
-----> Configure Rails 3 to disable x-sendfile
       Installing rails3_disable_x_sendfile... done
-----> Configure Rails to log to stdout
       Installing rails_log_stdout... done
-----> Gemfile detected, running Bundler version 1.0.7
       Unresolved dependencies detected; Installing...
       Using --without development:test
       Windows Gemfile.lock detected, ignoring it.
       You have modified your Gemfile in development but did not check
       the resulting snapshot (Gemfile.lock) into version control

       You have added to the Gemfile:
       * source: rubygems repository http://rubygems.org/
       * rails (= 3.0.7)
       * pg (= 0.11.0)
       * gravatar_image_tag (= 1.0.0.pre2)
       * will_paginate
       * rake (= 0.8.7)
       * jquery-rails
       * nested_form
       * acts-as-taggable-on
       * rspec-rails (= 2.5.0)
       * annotate (= 2.4.0)
       * faker (= 0.3.1)
       * rspec (= 2.5.0)
       * webrat (= 0.7.1)
       * factory_girl_rails (= 1.0)
       FAILED: http://devcenter.heroku.com/articles/bundler
 !     Heroku push rejected, failed to install gems via Bundler

To git@heroku.com:ajpxvb.git
 ! [remote rejected] master -> master (pre-receive hook declined)
error: failed to push some refs to 'git@heroku.com:ajpxvb.git' 
```

请问有什么想法吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T16:25:09.520

我在 Heroku 输出中注意到的一件事是：“检测到 Windows Gemfile.lock，忽略它。”

我阅读了[关于 Bundler 的 Heroku 开发中心文章，](https://devcenter.heroku.com/articles/bundler)其中提到了以下内容：Gemfile.lock

> 如果 Gemfile 的平台部分包含 Windows 条目，例如 mswin 或 mingw，则 Gemfile.lock 文件将被忽略。

您的 Gemfile 是否偶然包含上述部分，如果是，如果您删除/注释掉平台部分（只是为了测试）会发生什么？

# spring - EmptyResultDataAccessException：未找到用于 JPA 合并查询的实体

> ID：10820092
> 
> 赞同：0
> 
> 时间：2012-05-30T16:10:25.743
> 
> 标签：spring, hibernate, jpa

我正在使用 Spring 3 和 Hibernate 3.5 和 JPA 编写一个 Web 应用程序。

我正在使用以下代码：

```
Buy buy = buyDAO.find(buyId);
buy.setNum(getNum());
buyDAO.merge(buy); 
```

返回一个实体（我在调试中`find`看到它）但`buyDAO.merge`抛出上述异常。

我知道只有当我使用`query.getSingleResult()`并且数据库中没有用于我的查询的行时才会引发此异常。

我真的对此感到困惑，我尝试了我知道的每一个技巧。我将这些行移到了另一种方法，我尝试使用交易购买没有任何效果。

# automation - 在我的 Microsoft Lync 视频聊天应用程序中出现 COMException

> ID：10820094
> 
> 赞同：0
> 
> 时间：2012-05-30T16:10:29.347
> 
> 标签：automation, lync, comexception

我正在尝试在 Visual Studio 中开发一个与另一个人进行简单视频聊天的基本应用程序。一切正常，我能够成功打开视频聊天。但是，我已经安装了带有 UI 抑制的 Lync，并且该应用程序将无法运行。检查 InnerException 我可以看到程序正在抛出 COMException "Exception from HRESULT: 0x80C8000B"

通过消除过程，我发现注释掉该行`auto = LyncClient.getAutomation()`可以让应用程序运行，尽管应用程序的功能已经消失。

在我进行了所有在线搜索之后，我无法确定是什么原因导致这一行中断，而且我知道我需要那行代码才能继续前进。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T08:40:49.320

在 UI 抑制模式下运行时，您无法使用自动化。

抑制模式需要在客户端的机器上安装 Lync，但您随后需要使用 Lync SDK 来完成客户端为您执行的许多操作，例如登录（非同小可）。但是，SDK 的自动化部分是标准 Lync UI 的链接，这就是您无法使用它的原因。

您也无权访问构成 Lync 客户端的任何 UI 控件……除了`VideoWindow`控件之外 - 这很可能对您有用。

这里有一篇关于理解 UI 抑制模式的好文章：http: [//msdn.microsoft.com/en-us/library/hh345230.aspx](http://msdn.microsoft.com/en-us/library/hh345230.aspx)

此外，使用 UI 抑制模式时如何登录 Lync 的一个很好的示例：http: [//msdn.microsoft.com/en-us/library/hh378603.aspx](http://msdn.microsoft.com/en-us/library/hh378603.aspx)

还有一件事：如果您可以访问它，在[这本书 Lync](http://amzn.to/KeH4so)第 5 章中实际上有一个在 WPF 中生成 UI Suppression AV kiosk 应用程序的端到端示例 - 这可能正是您正在寻找的。

# android - android avd 没有指定协议

> ID：10820095
> 
> 赞同：0
> 
> 时间：2012-05-30T16:10:35.817
> 
> 标签：android, avd

我是android开发的新手我想设置一个虚拟仿真android设备，但是有这样一个问题，这有什么问题？谢谢

```
[root@goeland MyFirstApp]# android avd
No protocol specified
Exception in thread "main" org.eclipse.swt.SWTError: No more handles [gtk_init_check() failed]
at org.eclipse.swt.SWT.error(Unknown Source)
at org.eclipse.swt.widgets.Display.createDisplay(Unknown Source)
at org.eclipse.swt.widgets.Display.create(Unknown Source)
at org.eclipse.swt.graphics.Device.<init>(Unknown Source)
at org.eclipse.swt.widgets.Display.<init>(Unknown Source)
at org.eclipse.swt.widgets.Display.<init>(Unknown Source)
at org.eclipse.swt.widgets.Display.getDefault(Unknown Source)
at org.eclipse.swt.widgets.Shell.<init>(Unknown Source)
at org.eclipse.swt.widgets.Shell.<init>(Unknown Source)
at com.android.sdkuilib.internal.repository.sdkman2.AvdManagerWindowImpl1.createShell(AvdManagerWindowImpl1.java:160)
at com.android.sdkuilib.internal.repository.sdkman2.AvdManagerWindowImpl1.open(AvdManagerWindowImpl1.java:131)
at com.android.sdkuilib.repository.AvdManagerWindow.open(AvdManagerWindow.java:110)
at com.android.sdkmanager.Main.showAvdManagerWindow(Main.java:367)
at com.android.sdkmanager.Main.doAction(Main.java:300)
at com.android.sdkmanager.Main.run(Main.java:120)
at com.android.sdkmanager.Main.main(Main.java:103) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T01:57:22.970

`android`在尝试通过 SSH 调用而不转发 X（带有`-x`标志）时，我遇到了同样的错误。

因此，如果您遇到此问题并且您通过 访问远程计算机`ssh user@remotemachine`，则需要使用 转发 X11 `ssh -X user@remotemachine`。

如果这不是您的问题并且您仍然遇到问题，您能否提供更多信息来帮助我们帮助您？否则，您能否回馈并分享您是如何修复它的？

# c++ - 链接器错误未定义引用（调用时我定义的所有函数）

> ID：10820097
> 
> 赞同：0
> 
> 时间：2012-05-30T16:10:38.993
> 
> 标签：c++, function, reference, linker, call

几天前我写了这个程序作为一种概念验证。现在我知道它有效，我正在尝试清理代码并使事情变得更好。与我编写的原始程序和它的新版本相比，最大的变化是我将不止一次使用的任何东西变成了一个函数。我遇到的问题是对于我调用任何函数的每个地方，我都会收到链接器错误。我相信程序现在已经完成，除了这个错误。

最棘手的一点是昨晚——在我遇到这个错误并处理另一个与之相关的错误之前`char*`......`char`我设法修复了我的错误并且我的代码运行良好，即使是一个函数当时写的。当我今天开始研究它时，我不知何故发现我不知何故失去了那个进步并去重新修复它。一旦我再次修复了错误 - 据我所知，我以完全相同的方式进行了修复 - 每次调用函数时以及在编写并调用它们时的每个新函数时，都会出现此链接器错误`main()`。

这是代码：

```
//******************************************************************************
// David Ewing
// This program is an improvement on the original Cypher program which cyphered
// upto 255 characters of inputed text according to a provided keyphrase. This
// version seeks to improve the flow of the code and allow for a larger input of
// text.
//******************************************************************************

#include <iostream>

using namespace std;

// Declair global variables
char keyphrase[8192];
char alphabet[] = "abcdefghijklmnopqrstuvwxyz";
char cypherAlphabet[8192];
char sourceText[8192];
char cypherText[8192];
int sizeKeyphrase;
int sizeCypherAlphabet;
int sizeSourceText;
// ...Counters
int counter1;
int counter2;
int counter3;

// Declair functions
void cypher (char, int);
void eliminateDuplicates (char, int);
int getSize(char);
void handleSpaces (char, bool);
void reduceCase (char, int);

//******************************************************************************
// MAIN
//******************************************************************************

int main( void )
{
    // Describe program
    cout << "This program cyphers whatever text the user wishes according to a " << endl;
    cout << "keyphrase that the user provides." << endl << endl;

    // Retrieve keyphrase
    cout << "Please enter the keyphrase that you would like to use for your cypher." << endl;
    cout << "The keyphrase may include spaces, repeated letters, and capitals, but " << endl;
    cout << "they will be removed before it is applied to the provided text." << endl;
    cout << "Enter \"DONE\" when you have finished typing your keyphrase." << endl;

    // Call function to remove spaces from keyphrase
    handleSpaces (keyphrase[8192], false);

    // Call function to get size of keyphrase
    sizeKeyphrase = getSize (keyphrase[8192]);

    // Call function to remove repeated letters from keyphrase
    eliminateDuplicates (keyphrase[8192], sizeKeyphrase);

    // Call function to normalize case of keyphrase
    reduceCase (keyphrase[8192], sizeKeyphrase);

    // Apply keyphrase to alphabet
    strcpy (cypherAlphabet, keyphrase); // Copy the keyphrase to the beginning of cypherAlphabet
    strcat (cypherAlphabet, alphabet); // Add the rest of the alphabet after the keyphrase to cypherAlphabet

    // Call function to get size of cypherAlphabet
    sizeCypherAlphabet = getSize (cypherAlphabet[8192]);

    // Call function to remove repeated letters from cypherAlphabet
    eliminateDuplicates(cypherAlphabet[8192], sizeCypherAlphabet);

    // Retrieve sourceText
    cout << endl << "Please enter the text which you wish to be cyphered. Capitals will be" << endl;
    cout << "removed but punctuation and any other non-alphanumeric characters will" << endl;
    cout << "be ignored." << endl;
    cout << "Enter \"DONE\" when you have finished typing your text." << endl;

    // Call function to take input for sourceText and to handle spaces
    handleSpaces(sourceText[8192], true);

    // Call function to get size of sourceText
    sizeSourceText = getSize (sourceText[8192]);

    // Call function to normalize case of sourceText
    reduceCase(sourceText[8192], sizeSourceText);

    // Cypher sourceText
    cypher(sourceText[8192], sizeSourceText);

    // Display cypherText
    cout << endl << "Your cyphered text is as follows:" << endl;
    cout << cypherText << endl << endl;

    // Pause program
    system ("pause");

    // End program
    return 0;

} // End main

//******************************************************************************
// CYPHER
//******************************************************************************
void cypher (char text[8192], int size)
    {
         // Declare counters
         counter1 = 0;
         counter2 = 0;

     // Search alphabet for address of each letter
     while (counter1 < size)
     {
           counter2++;
           if (sourceText[counter1] == alphabet[counter2-1])
           {
                             cypherText[counter1] = cypherAlphabet[counter2 - 1];
                             counter1++;
                             counter2 = 0;
           } // End if

           if (counter2 > 25) // If all the letters in the alphabet are checked
           {
                 cypherText[counter1] = sourceText[counter1]; // give up on the letter, transcribing it over
                 counter1++; // and continue with the rest of the soureText
                 counter2 = 0; // Allows for punctuation, spaces, strange symbols, etc.
           } // End if
     } // End while

} // End cypher

//******************************************************************************
// ELIMINATE DUPLICATES
//******************************************************************************
void eliminateDuplicates (char text[8192], int size)
{
     // Initialize counters
     counter1 = 0;
     counter2 = 1;
     counter3 = 1;

     // Initialize flag
     //bool flag = false;

     while (counter1 < size)
    {
          if (text[counter1] == text[counter1+counter2] && text[counter1] != NULL)
          {
                         // Delete text[i+j]
                         for (counter3 = 1; counter3 < size; counter3++)
                         {
                             text[counter1+counter2+counter3-1] = text[counter1+counter2+counter3]; // Shift array left at repeated letter. Final value is doubled.
                             //if (counter3 == size - 1)
                             //{
                             //      flag = true;
                             //} // End if
                         } // End for
          } // End if
          else if (counter2 == size)
          {
              counter1++;
              counter2 = 1; // Reset counter
              //flag = false; // Reset flag
          } // End else if
          else
          {
              counter2++;
              //flag = false;
          } // End else

    } // End while

} // End eliminateDuplicates

//******************************************************************************
// GET SIZE
//******************************************************************************
int getSize (char text[8192])
{
    int size = 0; // Declair counter/result variable
    while (text[size] != NULL)
    {
          size++;
    } // End while

    return size;

} // End getSize

//******************************************************************************
// HANDLE SPACES
//******************************************************************************
void handleSpaces (char text[8192], bool includeSpaces)
{
     // Declare temporary input holder
     char temp[8192];

     // Initialize flag
     bool flag = false;

     cin >> text;
     while (flag == false)
     {
           cin >> temp;
           if (strcmp(temp, "DONE"))
           {
                            if (includeSpaces == true)
                            {
                                              strcat(text, " "); // Add space after last word
                            } // End if

                            strcat(text, temp); // Add the next word to the last

           } // End if
           else
           {
               flag = true;
           } // End else

     } // End while

} // End handleSpaces

//******************************************************************************
// REDUCE CASE
//******************************************************************************
void reduceCase (char text[8192], int size)
{
     // Declare counter
     int counter1 = 0;
     while (counter1 < size)
     {
           sourceText[counter1] = tolower(sourceText[counter1]); // Use tolower for each item in the array
           counter1++;
           } // End while

} // End reduceCase 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T16:15:00.340

声明和定义不同：

### 宣言：

```
void cypher (char, int); 
```

### 定义：

```
void cypher (char text[8192], int size) 
```

只是一个例子。

另外，调用是错误的：

```
cypher(sourceText, sizeSourceText); 
```

代替

```
cypher(sourceText[8192], sizeSourceText); 
```

当你写：

```
void cypher (char text[8192], int size) 
```

这意味着该函数将数组作为参数。

当你用

```
cypher(sourceText[8192], sizeSourceText); 
```

这意味着您正在使用`8192`该`char`数组中位置的字符调用该函数。

# mysql - Mysql：根据不同活动对表的值进行总和

> ID：10820101
> 
> 赞同：1
> 
> 时间：2012-05-30T16:10:54.200
> 
> 标签：mysql, sql, phpexcel

现在我有 3 个表，第一个用于用户，第二个用于用户组，第三个用于积分（还有其他的，如果你想要一个，我可以为你创建它：P）。

表用户： `user_id | fname | active`

表用户组： `id | group_id | user_id | active`

表 user_points： `id | point_type | point_units | active`

组中的每个用户都可以为不同的活动赚取积分。所以，我想显示用户在不同活动中获得的积分，最后是总计。

这是我到目前为止的查询：

```
SELECT 
    u.user_id AS `ID`,  
    u.fname AS `Name`,  
    SUM(case when up.point_type = 'Referrals' then up.point_units else 0 end) AS `Referrals`, 
    SUM(case when up.point_type = 'Email' then up.point_units else 0 end) AS `Email`, 
    SUM(case when up.point_type = 'Facebook' then up.point_units else 0 end) AS `Facebook`, 
    SUM(case when up.point_type = 'Twitter' then up.point_units else 0 end) AS `Twitter`, 
    SUM(case when up.point_type = 'Extra' then up.point_units else 0 end) AS `Extra`, 
    SUM(case when up.point_type = 'Discount' then up.point_units else 0 end) AS `Discount`, 
    SUM(case when u.user_id = up.user_id then up.point_units else 0 end) AS `Total` 
FROM users AS u, user_groups AS uc, user_points AS up 
WHERE u.user_id = uc.user_id 
    AND u.user_id = up.user_id 
    AND u.active = 1 
    AND uc.active = 1 
    AND up.active = 1 
    AND uc.group_id = up.group_id 
    AND uc.group_id = 65 
ORDER BY u.fname; 
```

我遇到的问题是查询只显示一个用户和每列中所有用户的总和。

我知道这不是正确的方法，但我不知道如何将所有内容放入查询中。此外，我将此查询提供给 PHPExcel，因此它可以生成一个很好的友好报告。

有任何想法吗？:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:12:59.487

`GROUP BY`使用聚合函数时需要一个子句。你的*可能*看起来像：

```
GROUP BY u.user_id 
```

在您的查询中，它会在这里：

```
AND uc.group_id = 65 
GROUP BY u.user_id
ORDER BY u.fname; 
```

# sql - 删除除 TOP 1 之外的内容

> ID：10820105
> 
> 赞同：4
> 
> 时间：2012-05-30T16:11:08.807
> 
> 标签：sql, sql-server, tsql, sql-server-2005

有没有办法删除表中除一个（随机）行之外的所有行，而不在`DELETE`语句中指定任何列名？

我正在尝试做这样的事情：

```
CREATE TABLE [dbo].[DeleteExceptTop1]([Id] INT)
INSERT [dbo].[DeleteExceptTop1] SELECT 1
INSERT [dbo].[DeleteExceptTop1] SELECT 2
INSERT [dbo].[DeleteExceptTop1] SELECT 3

SELECT * FROM [dbo].[DeleteExceptTop1]

DELETE
FROM [dbo].[DeleteExceptTop1]
EXCEPT
SELECT TOP 1 * FROM [dbo].[DeleteExceptTop1]

SELECT * FROM [dbo].[DeleteExceptTop1] 
```

最后`SELECT`应该产生一行（可以是三行中的任何一行）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T16:24:55.650

```
;WITH CTE AS
(
SELECT ROW_NUMBER() OVER (ORDER BY (SELECT newid())) AS RN
FROM [dbo].[DeleteExceptTop1]
)
DELETE FROM CTE
WHERE RN > 1 
```

或类似于@abatishchev 的答案，但在排序和避免弃用结构方面有更多变化。

```
DECLARE @C INT
SELECT @C = COUNT(*) - 1 
FROM [dbo].[DeleteExceptTop1]

IF @c > 0
BEGIN
WITH CTE AS
(
SELECT TOP(@C) *
FROM [dbo].[DeleteExceptTop1]
ORDER BY NEWID()
)
DELETE FROM CTE;
END 
```

或者使用并假设没有重复行并且所有列的数据类型与运算符`EXCEPT`兼容的最终方式`EXCEPT`

```
/*Materialise TOP 1 to ensure only evaluated once*/
SELECT TOP(1) * 
INTO #T
FROM [dbo].[DeleteExceptTop1]
ORDER BY NEWID()

;WITH CTE AS
(
SELECT *
FROM [dbo].[DeleteExceptTop1] T1
WHERE EXISTS(
             SELECT *
             FROM #T
             EXCEPT
             SELECT T1.*)
)
DELETE FROM CTE;

DROP TABLE #T 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-30T16:26:50.003

尝试：

```
declare @c int
select @c = count(*) - 1 from [dbo].[DeleteExceptTop1]

IF @c > 0
BEGIN

set RowCount  @c

delete from [dbo].[DeleteExceptTop1]
END 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-30T16:19:10.540

不可以。
您需要使用列名（例如主键的名称）来标识要删除的行。

除了数据之外，“随机行”在 SQL 中没有任何意义。如果要删除*除*某行以外的所有内容，则必须将该行与其他行区分开来`DELETE`

`EXCEPT`通过比较`DISTINCT`行中的值来工作。

**编辑：** *如果*您可以指定主键，那么这是一件小事。您可以简单地`DELETE`将 PK`<>`您的“随机”选择*或* `NOT IN`“随机”选择放在哪里。

**编辑：**显然我对指定*任何*列名的需要是错误的，您可以使用分配的`ROW_NUMBER`.. 但我不会删除我的答案，因为它引用了您`EXCEPT`在评论中讨论的使用。如果**不***从*_ _`ROW_NUMBER`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-30T16:25:45.330

你可以做这样的事情（SQL 2008）

```
DECLARE @Original TABLE ([Id] INT)
INSERT INTO @Original(ID) VALUES(1)
INSERT INTO @Original(ID) VALUES(2)
INSERT INTO @Original(ID) VALUES(3)

SELECT * FROM @Original;

WITH CTE AS
(SELECT ROW_NUMBER() OVER(ORDER BY ID) AS ROW, ID FROM @Original)
DELETE @Original
FROM @Original O
INNER JOIN CTE ON O.ID = CTE.ROW
WHERE ROW > 1

SELECT * FROM @Original 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-15T00:05:02.377

似乎最简单的答案可能是最好的。以下应该有效：

```
Declare @count int
Set @count=(Select count(*) from DeleteExceptTop1)-1
Delete top (@count) from DeleteExceptTop1 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-31T08:34:27.060

我知道它已被回答，但是呢？

```
DELETE 
FROM [dbo].[DeleteExceptTop1]
Where Id not in (
SELECT TOP 1 * FROM [dbo].[DeleteExceptTop1]) 
```

# excel - 在 Excel 2007 中循环满足条件的值

> ID：10820107
> 
> 赞同：0
> 
> 时间：2012-05-30T16:11:13.427
> 
> 标签：excel, excel-2007, excel-formula

我有一些基本统计数据计算 Excel 电子表格上的最小值、q1、中值、q3、最大值、iqr 和异常值。我现在拥有的是一个不会成为异常值的最大可接受值的值。

所以我想有一个公式说，“真正的最大值是值的最大值，因为它不低于作为异常值计算的值。”

例如，我有数据点：8、5、6、5、37、2。最大值为 37，不会成为异常值的最大值为 11.25。所以显然 37 大于 11.25，所以我希望我的真实最大值为 8。我尝试使用的公式如下：

```
=IF(H25>H33, MAX(IF(B15:G15<H33,B15:G15,"")), H25) 
```

其中 H25 是计算的最大值（在本例中为 37），H33 是最高的非异常值（在本例中为 11.25），B15:G15 是 6 个数据点（8、5、6、5、37、2） .

所以基本上我正在尝试做一个 for 循环，如果它不是异常值，则取计算的最大值，或者循环遍历数据点并取非异常值的最大值。上面的公式不起作用，这是我的问题，这就是我需要帮助的地方。

感谢您的任何指示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T16:39:37.593

所以事实证明我的公式确实按预期工作，您只需按下“Ctrl-Shift-Enter”而不是“Enter”即可确保它被评估为数组公式。这真的很烦人，但它有效（我认为 Excel 应该只识别它是一个数组公式）。

# c# - 访问数组时的速度差异

> ID：10820108
> 
> 赞同：1
> 
> 时间：2012-05-30T16:11:13.847
> 
> 标签：c#, arrays, winforms, performance

**之间有什么区别（我的程序速度 - 执行时间）？** 

**第一个选项：**

```
 private void particleReInit(int loop)
        {
            this.particle[loop].active = true;
            this.particle[loop].life = 1.0f;
            this.particle[loop].fade = 0.3f * (float)(this.random.Next(100)) / 1000.0f + 0.003f; 
            this.particle[loop].r = colors[this.col][0];    // Select Red Rainbow Color
            this.particle[loop].g = colors[this.col][1];    // Select Red Rainbow Color
            this.particle[loop].b = colors[this.col][2];    // Select Red Rainbow Color
            this.particle[loop].x = 0.0f;
            this.particle[loop].y = 0.0f;
            this.particle[loop].xi = 10.0f * (this.random.Next(120) - 60.0f);
            this.particle[loop].yi = (-50.0f) * (this.random.Next(60)) - (30.0f);
            this.particle[loop].xg = 0.0f; 
            this.particle[loop].yg = 0.8f; 
            this.particle[loop].size = 0.2f;
            this.particle[loop].center = new PointF(particleTextures[0].Width / 2, particleTextures[0].Height / 2);

    } 
```

**第二个选项：** 

```
Particle p = particle[loop];
p.active = true;
p.life = 1.0f;
... 
```

Where`Particle particle[] = new Particle[NumberOfParticles];`只是一组具有生命、位置等属性的粒子。

我在 Visual Studio 2010 中像 WFA（Windows 窗体应用程序）一样执行此操作，并且需要提高性能（我们无法使用 OpenGL，因此对于更多粒子，我的程序往往很慢）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T16:15:44.297

我当然希望速度会有所不同——毕竟它正在做更多的工作。另一个线程可能在语句之间更改了数组的内容，这些内容在该线程中*可能*（或可能不）可见。如果这些是属性而不是字段，那么属性设置器甚至可以想象在*同一个*线程中更改数组中的值，这些值*必须*是可见的。

速度差异是否*显着*是另一回事，我们无法判断。

更重要的是，我想说第二种形式比现有代码*更清晰。*

事实上，如果这实际上是为了重新初始化整个元素，我实际上会创建一个*新* `Particle`元素，然后将其分配给元素：

```
particle[loop] = new Particle {
    active = true,
    life = 1f,
    // etc
}; 
```

...或创建一个单独的方法/构造函数，以适当的状态创建一个粒子。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T16:16:06.553

虽然速度差异可能非常小，但这里的任何速度差异都可能可以忽略不计。我会使用最容易阅读和维护的版本。

就个人而言，我更喜欢您的第二个选项，因为我发现它更容易阅读。

> 我在 Visual Studio 2010 中像 WFA（Windows 窗体应用程序）一样执行此操作，并且需要提高性能（我们无法使用 OpenGL .. 所以对于更多粒子，我的程序往往很慢）。

如果您的目标是性能，我高度怀疑这个例程是您问题的核心。您应该在探查器下运行它。在你真正*衡量你的表现*并找到真正的问题之前，你只是在猜测并且可能会花时间优化错误的东西。

使用 GDI+ 渲染“粒子”更有可能成为瓶颈，并且在两个选项之间更改此例程不会对感知速度产生影响。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T18:26:42.690

作为替代方案 - 使 Particle 成为一个结构，在循环中按顺序对其进行初始化，我敢打赌它会比这两个选项中的任何一个都快得多。

# linux - （静态链接的）DLL 是否使用与主程序不同的堆？

> ID：10820114
> 
> 赞同：24
> 
> 时间：2012-05-30T16:11:50.450
> 
> 标签：linux, windows, dll, heap-memory, heap-corruption

我是 Windows 编程的新手，我刚刚“失去”了两个小时来寻找每个人似乎都知道的错误：您不能在 DLL 的堆上创建对象并在另一个 DLL（或主程序）中销毁它.

我几乎可以肯定在 Linux/Unix 上不是这种情况（如果是，请说出来，但我很确定我做了数千次没有问题......）。

在这一点上，我有几个问题：

1) 静态链接的 DLL 是否使用与主程序不同的堆？

2）静态链接的DLL是否映射在主程序的同一个进程空间？（我很确定这里的答案是肯定的，否则将指针从主程序中的函数传递到 DLL 中的函数是没有意义的）。

我说的是普通/常规 DLL，而不是 COM/ATL 服务

编辑：“静态链接”是指我不使用 LoadLibrary 加载 DLL，但我与存根库链接

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-30T16:15:29.970

DLL / exe 需要链接到 C 运行时库的实现。

对于 C Windows 运行时库，您可以选择指定是否要链接到以下内容：

1.  单线程 C 运行时库（现已停止支持单线程库）
2.  多线程 DLL / 多线程调试 DLL
3.  静态运行时库。
4.  更多（您可以查看链接）

它们中的每一个都将引用不同的堆，因此您不允许将从一个运行时库的堆中获取的地址传递给另一个。

现在，这取决于您正在谈论的 DLL 已链接到哪个 C 运行时库。假设您正在使用的 DLL 已链接到静态 C 运行时库，并且您的应用程序代码（包含主函数）已链接到多线程 C 运行时 DLL，那么如果您将指针传递给在DLL 到您的主程序并尝试在那里释放它，反之亦然，它可能导致未定义的行为。因此，基本的根本原因是 C 运行时库。请谨慎选择。

[请在此处](http://msdn.microsoft.com/en-us/library/abx4dbyh%28v=vs.80%29.aspx)和[此处](http://msdn.microsoft.com/en-us/library/2kzt1wy3%28v=vs.71%29.aspx)找到有关支持的 C 运行时库的更多信息

来自 MSDN 的引用：

**警告** *不要混合运行时库的静态和动态版本。在一个进程中拥有多个运行时库副本可能会导致问题，因为一个副本中的静态数据不与另一个副本共享。链接器会阻止您在一个 .exe 文件中同时链接静态和动态版本，但您仍然可以得到两个（或更多）运行时库副本。例如，与运行时库的静态（非 DLL）版本链接的动态链接库在与运行时库的动态 (DLL) 版本链接的 .exe 文件一起使用时可能会导致问题. （您还应该避免在一个进程中混合库的调试和非调试版本。）*

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-04-04T09:41:33.273

让我们首先了解我们的应用程序/DLL 在 Windows 操作系统上的堆分配和堆栈。传统上，操作系统和运行时库都带有堆的实现。

1.  在进程开始时，操作系统会创建一个称为进程堆的默认堆。如果没有使用其他堆，则进程堆用于分配块。
2.  语言运行时还可以在进程中创建单独的堆。（例如，C 运行时创建自己的堆。）
3.  除了这些专用堆之外，应用程序或许多加载的动态链接库 (DLL) 之一可以创建和使用单独的堆，称为专用堆
4.  这些堆位于所有虚拟内存系统中操作系统的虚拟内存管理器之上。
5.  让我们讨论更多关于 CRT 和相关堆的信息：
    1.  C/C++ 运行时 (CRT) 分配器：提供 malloc() 和 free() 以及 new 和 delete 运算符。
    2.  CRT 为其所有分配创建这样一个额外的堆（此 CRT 堆的句柄在 CRT 库内部存储在名为 _crtheap 的全局变量中）作为其初始化的一部分。
    3.  CRT 创建自己的私有堆，它位于 Windows 堆的顶部。
    4.  Windows 堆是围绕 Windows 运行时分配器 (NTDLL) 的薄层。
    5.  Windows 运行时分配器与虚拟内存分配器交互，虚拟内存分配器保留和提交操作系统使用的页面。

您的 DLL 和 exe 链接到多线程静态 CRT 库。您创建的每个 DLL 和 exe 都有自己的堆，即 _crtheap。分配和解除分配必须从各自的堆中进行。从 DLL 动态分配的，不能从可执行文件中取消分配，反之亦然。

你可以做什么？使用 /MD 或 /MDd 在 DLL 和 exe 中编译我们的代码，以使用运行时库的特定于多线程和特定于 DLL 的版本。因此 DLL 和 exe 都链接到同一个 C 运行时库，因此是一个 _crtheap。分配总是与单个模块中的取消分配配对。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-30T16:37:27.580

如果我有一个编译为 .exe 的应用程序并且我想使用一个库，我可以从 .lib 文件静态链接该库或从 .dll 文件动态链接该库。

每个链接的模块（即每个 .exe 或 .dll）都将链接到 C 或 C++ 运行时的实现。运行时本身是一个库，可以静态或动态链接到不同的线程配置。

通过说*静态链接的 dll*，您是在描述应用程序 .exe 动态链接到库 .dll 并且该库在内部静态链接到运行时的设置吗？我会假设这就是你的意思。

另外值得注意的是，每个模块（.exe 或 .dll）都有自己的静态范围，即 .exe 中的全局静态与 .dll 中具有相同名称的全局静态不同。

因此，在一般情况下，不能假设在不同模块中运行的代码行使用相同的运行时实现，而且它们不会使用任何静态状态的相同实例。

因此，在处理跨越模块边界的对象或指针时，需要遵守某些规则。对于任何给定地址，分配和解除分配必须发生在同一模块中。否则，堆将不匹配并且不会定义行为。

COM 使用引用计数解决了这个问题，当引用计数达到零时，对象会自行删除。这是用于解决匹配位置问题的常见模式。

可能存在其他问题，例如，windows 定义了某些操作，例如如何在每个线程的基础上处理分配失败，而不是在每个模块的基础上。这意味着在模块 B 设置的线程上在模块 A 中运行的代码也可能遇到意外行为。

# sql - 用户 [sql server 用户] 登录失败

> ID：10820116
> 
> 赞同：2
> 
> 时间：2012-05-30T16:11:59.807
> 
> 标签：sql, sql-server, sql-server-2008, reporting-services, ssrs-2008

我是 SSRS 的新手，并且已经部署了多个报告。当我强制 Windows 身份验证时，一切正常，但是当我这样做时：

![在此处输入图像描述](../Images/e9ddd9a9b43cef6f708543f7e158ca56.png)

我收到此错误：

> 报告处理过程中发生错误。(rsProcessingAborted) 数据集“DataSet1”的查询执行失败。(rsErrorExecutingCommand) 用户“DWH_Reporting_User”登录失败。

我已经配置了`DWH_Reporting_User`这样的：

![在此处输入图像描述](../Images/0cb2142540c98b40248380623445bdf4.png)

`DWH_Reporting_User`以下是数据库的详细信息`ReportServer`：

![在此处输入图像描述](../Images/f7f99b10a50fe096462f6da82eef6ff0.png)

这是服务器上的安全性：

![在此处输入图像描述](../Images/7084b2550097a577273ce38e517aa000.png)

![在此处输入图像描述](../Images/e14b331407f19d23da71c49e5a17ac7d.png)

当我尝试为该特定文件夹设置安全性时：

![在此处输入图像描述](../Images/e7f173d95af427f8f70982ade403b24b.png)

我收到此错误消息：

![在此处输入图像描述](../Images/756f677cbc6fd26752746deb29714abb.png)

我配置东西的方式有明显的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T17:56:54.723

这个问题的答案是一系列评论。我继续将它放在聊天中以及答案中。

转到服务器而不是数据库的安全性并将用户映射到该数据库。

可以回收运行报告服务的服务器上的应用程序池吗？如果可能，或者重新启动 IIS 服务器。

想到的另一件事是，当您启动此报表时，它会进入报表服务器“门户”。此用户是否有权访问实际报告以查看它？单击此“门户”的详细信息部分并将此用户分配为内容管理员角色。

DWH_REPORTING_USER 这是您域中的管理员帐户吗？

服务器上的本地管理员，那么您是否授予 \COMPUTER_NAME\DWH_Reporting_User 权限作为角色部分的内容管理员？为什么不使用域管理员帐户？

那么您如何访问实际报告 - 这是您的问题。帮我一个忙，在报告服务的第一个选项卡中编写一个存储过程或 sql 查询并使用该用户运行它。在共享数据源中的含义应该是使用这个用户 DWH_Reporting_user。测试连接然后编写一个小的 sql 语句来检索一些数据。从 RS 中运行 SQL 脚本，您看到任何数据吗？

@Aprem 查看 rs 顶部的三个选项卡，它是定义数据集的第一个选项卡，您可以在此处创建 SQL 查询（并使用红色感叹号运行它）。– JonH 20 分钟前

我将一个新数据集定义为“从 mytable 中选择前 1000 个 *”，我重建了项目，部署了它，现在 id o 做什么？– Артём Царионов 16 分钟前

在“共享数据集”中，您有一个数据集，对吗？双击它并转到“查询设计器”，它是此表单上的一个按钮。单击它并“执行”查询（红色感叹号）。你不需要现在部署它，只需在测试机器上进行即可。ago

您在数据源部分“共享数据源”中指定用户，该帐户是用于“提取”数据的帐户。你真的需要更多地体验 RS 或阅读一些关于它的材料。这是最基本的。

****好的，你现在明白你的问题了吗，你用来获取数据的用户没有问题，此外，它运行正常。现在您必须查看报告。查看报告就是查看网页，查看网页意味着您需要使用“匿名”访问或Windows身份验证。因此您需要一个域或本地 WINDOWS 帐户来查看报告。此帐户需要在 RS 门户上设置为内容管理员角色。****

您正在处理两种野兽，一种是数据库（db 服务器），另一种是 IIS（Web 服务器），每种都有特定的用途。该数据库允许您在 Web 服务器托管页面时提取数据。

报表服务器数据库非常重要，它保存了所有报表的列表以及与数据库中的报表关联的元数据。它还存储与您的报告关联的作业 ID 和订阅。基本上，它是所有报告服务的后端数据库，如报告、数据集和数据源。当您创建一个新的“报表项目”时，可以这样想，您可以创建报表、数据集和数据源。如果没有报表服务器数据库，系统将如何记住您的数据集、数据源和报表名称？它是 rs 的核心。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T16:29:37.827

您的数据集不用于连接到报告服务数据库，它用于连接到您正在获取数据以显示在报表上的数据库。

该用户是否存在于报告正在访问的数据库中？

# java - Vaadin 中的 ENTER 快捷方式和 TextArea

> ID：10820117
> 
> 赞同：5
> 
> 时间：2012-05-30T16:12:27.263
> 
> 标签：java, vaadin, keyboard-shortcuts, vaadin7

```
TextField f = new TextField();
Button b = new Button("Save");
b.setClickShortcut(KeyCode.ENTER); // For quick saving from text field itself

TextArea longText = new TextArea(); // "Enter" is garbled here 
```

使快捷方式仅在来自文本字段中有效吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-30T19:05:40.957

使用 focus 和 blur listeners 移除和添加快捷键：

```
 f.addFocusListener(new FocusListener() {
        @Override
        public void focus(FocusEvent event) {
            b.setClickShortcut(KeyCode.ENTER);
        }
    });
    f.addBlurListener(new BlurListener() {
        @Override
        public void blur(BlurEvent event) {
            b.removeClickShortcut();
        }
    }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-09T09:15:18.940

较新版本的 Vaadin 需要以下代码，因为 addListener() 现在已弃用。

```
 f.addFocusListener(new FocusListener() {

        private static final long serialVersionUID = -6733373447805994139L;

        @Override
        public void focus(FocusEvent event) {
            b.setClickShortcut(KeyCode.ENTER);
        }
    });

    f.addBlurListener(new BlurListener() {

        private static final long serialVersionUID = -3673311830300629513L;

        @Override
        public void blur(BlurEvent event) {
            b.removeClickShortcut();
        }
    }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-07-07T07:45:21.183

谈到 Vaadin 14，我一直在寻找答案，对我来说，这很好用

```
 Button search = new Button("Search");
  search.addClickShortcut(Key.ENTER); 
```

# linux - '你的分支在 'origin/master' 之前 1 次提交。' 合并后

> ID：10820118
> 
> 赞同：0
> 
> 时间：2012-05-30T16:12:31.343
> 
> 标签：linux, git

我做了以下事情：

```
git add <filenames>
git commit
git push origin master:mybranch 
```

从我的原始服务器，我做了以下事情：

```
git merge mybranch 
```

我的所有更改现在都存在于原始服务器上，但是 git（和我自己）现在似乎非常困惑。当我`git status`在源上执行 a 时，我添加的两个新文件存在，但列为未跟踪文件。但是，修改后的文件并未列为已修改。

当我`git status`在远程服务器上执行操作时，我收到错误**Your branch is ahead of 'origin/master' by 1 commit。**

当我`git diff origin/master`在远程服务器上执行操作时，我的所有更改都被列为原始服务器上不存在。

这里发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:20:48.883

在你的主人中做一个 git pull 然后再次合并
你目前在哪个分支上？

通常是这样的：

```
git checkout somebranch
*make some changes
git add *any new files here*
git commit -am "commit message"
git checkout master
git pull origin master
git merge somebranch
git push 
```

如果主分支在您拉出时有任何更改，您将需要将这些更改合并到您的工作分支。

```
git checkout somebranch
git merge master 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T18:50:35.283

您只将 mybranch 推送到您的遥控器。这就是为什么在将它合并到遥控器上的 master 后，您会收到“提前 1”消息。这不是错误。

执行 git fetch，您将获得最新的同步信息。

听起来你不明白 Git 的历史结构是如何构建的。谷歌搜索“计算机科学家的 git”以获得快速概览，或花一些时间阅读 progit.org/book。

# graphite - Graphite 在超过 7 小时的范围内没有绘制任何图形

> ID：10820119
> 
> 赞同：12
> 
> 时间：2012-05-30T16:12:32.827
> 
> 标签：graphite

我目前的保留规则是这样的：

```
[whatever]
priority = 110
pattern = ^stats\.whatever\..*
retentions = 60:10080,600:262974 
```

如果我理解正确，这将保存 2 天的 1 分钟数据和 5 年的 10 分钟数据。

在过去的几个小时里，我一直在向石墨发送数据，我可以看到这些数据的图表，但仅限于不到 7 小时的范围。如果我尝试将这些数据可视化，例如 1 天，则生成的图表不会显示单个数据点。

这是由我的保留规则引起的吗？

提前致谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-14T12:51:01.393

我有同样的问题。更改保留规则后，您需要重新启动 carbon-cache.py。如果你想保留你拥有的数据，你需要在你的耳语文件（.wsp）上运行whisper-resize.py。

此链接也应该有帮助： [https ://answers.launchpad.net/graphite/+question/140289](https://answers.launchpad.net/graphite/+question/140289)

但是，在该链接中，传递给whisper-resize.py 的参数顺序错误。它应该是`whisper-resize.py <file> <retention rate>`

这是调整大小的有用命令： `find /opt/graphite/storage/whisper -type f -name "*.wsp" -exec whisper-resize.py {} <retention rate> \;`

根据需要进行调整。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-29T03:20:33.050

我有类似的问题；对我来说，这不是保留规则，而是聚合规则。默认情况下，我的计数器被分配给`--agggregationMethod average`和`-xFilesFactor 0.5`。但是我的数据远没有那么密集，所以聚合器丢弃了我的数据，理由是没有可用的具有统计意义的样本。

在我的特定用例中，我对某个时间段内的峰值感兴趣，所以我曾经`whisper-resize.py`重新配置我的数据库：`--aggregationMethod max`，`--xFilesFactor 0.0`给了我预期的行为。

另见[storage-aggregation.conf](http://graphite.readthedocs.org/en/1.0/config-carbon.html)

# knockout.js - knockout.js 和禁用锚标记

> ID：10820122
> 
> 赞同：12
> 
> 时间：2012-05-30T16:12:45.760
> 
> 标签：knockout.js, anchor, javascript

如何使用此自定义绑定禁用和启用锚标记。它适用于输入元素，但锚标记只是更改 CSS，而不是禁用。

```
<a href="link" data-bind="myDisabled: !enabled()"/>

ko.bindingHandlers.myDisabled = {
    update: function(element, valueAccessor) {
        var value = ko.utils.unwrapObservable(valueAccessor());
        ko.bindingHandlers.css.update(element, function() {return { disabled: value }; });
        ko.bindingHandlers.disable.update(element, valueAccessor);
    }
}; 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-31T01:07:38.103

您需要在绑定处理程序中捕获单击事件。

**HTML**：

```
<a href="link" data-bind="disableClick: !enabled()">test</a>
<br/><br/><br/>
<input type="checkbox" data-bind="checked: enabled"> enabled ​ 
```

**JavaScript**：

```
ko.bindingHandlers.disableClick = {
    init: function (element, valueAccessor) {

        $(element).click(function(evt) {
            if(valueAccessor())
                evt.preventDefault();
        });

    },

    update: function(element, valueAccessor) {        
        var value = ko.utils.unwrapObservable(valueAccessor());
        ko.bindingHandlers.css.update(element, function() {return { disabled_anchor: value }; });
    }
};

ko.applyBindings({ enabled: ko.observable(false)}); 
```

​</p>

这是一个工作示例：

[http://jsfiddle.net/kp74u/54/](http://jsfiddle.net/kp74u/54/)

**更新 1**：如果您需要防止在附加了敲除绑定处理程序后绑定其他事件处理程序，您需要`stopImmediatePropagation`将`preventDefault`.

示例：http: [//jsfiddle.net/kp74u/55/](http://jsfiddle.net/kp74u/55/)

**更新 2**：如果要禁用所有事件处理程序（以及在绑定处理程序之前附加的单击事件处理程序，您需要“破解”jquery 事件数组）。请注意，这可能不适用于其他版本的 jquery（示例使用 1.7）：

```
ko.bindingHandlers.disableClick = {
    init: function(element, valueAccessor) {

        $(element).click(function(evt) {
            alert('test before');
        });

        $(element).click(function(evt) {
            if (valueAccessor()) {
                evt.preventDefault();
                evt.stopImmediatePropagation();
            }
        });

        //begin of 'hack' to move our 'disable' event handler to top of the stack
        var events = $.data(element, "events");
        console.log(events);
        var handlers = events['click'];

        if (handlers.length == 1) {
            return;
        }

        handlers.splice(0, 0, handlers.pop());
        //end of 'hack' to move our 'disable' event handler to top of the stack

        $(element).click(function(evt) {
            alert('test after');
        });
    },

    update: function(element, valueAccessor) {
        var value = ko.utils.unwrapObservable(valueAccessor());
        ko.bindingHandlers.css.update(element, function() {
            return {
                disabled_anchor: value
            };
        });
    }
}; 
```

例如：http: [//jsfiddle.net/nickolsky/kp74u/40/](http://jsfiddle.net/nickolsky/kp74u/40/)

**更新 3**：正如那里提到[的（FIR55TORM 建议的编辑](https://stackoverflow.com/review/suggested-edits/2241922)，抱歉不能批准这个完全正确的编辑，因为我来不及审查）：如果您使用的是 jQuery 1.10.x，则需要添加下划线才能访问像这样的“数据”对象：

```
var events = $._data(element, "events"); 
```

jQuery 1.10.x 的修订小提琴：http: [//jsfiddle.net/nickolsky/kp74u/41/](http://jsfiddle.net/nickolsky/kp74u/41/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T15:22:27.350

我在寻找一种方法时找到了这个答案，但我不喜欢这种方法，我自己的方法也是如此

```
var orgClickInit = ko.bindingHandlers.click.init;
ko.bindingHandlers.click.init = function (element, valueAccessor, allBindingsAccessor, viewModel) {
    if (element.tagName === "A" && allBindingsAccessor().enable != null) {
        var disabled = ko.computed(function () {
            return ko.utils.unwrapObservable(allBindingsAccessor().enable) === false;
        });
        ko.applyBindingsToNode(element, { css: { disabled: disabled} });
        var handler = valueAccessor();
        valueAccessor = function () {
            return function () {
                if (ko.utils.unwrapObservable(allBindingsAccessor().enable)) {
                    handler.apply(this, arguments);
                }
            }
        };

    }
    orgClickInit(element, valueAccessor, allBindingsAccessor, viewModel);
}; 
```

它与本机点击无缝并启用绑定（禁用绑定未实现）小提琴（小提琴也使用我的约定而不是配置库） [http://jsfiddle.net/xCfQC/30/](http://jsfiddle.net/xCfQC/30/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-09T20:55:08.203

使用@Anders 的答案作为灵感，我想出了我自己的版本。允许在有或没有“点击”的情况下使用“启用”、“禁用”。还允许自定义禁用类，否则默认为“禁用”。

```
var koEnableUpdateOrig = ko.bindingHandlers.enable.update;
ko.bindingHandlers.enable.update = function (element, valueAccessor, allBindings) {
    // call original enable update
    var result = koEnableUpdateOrig.apply(this, arguments);
    var enabled = ko.unwrap(valueAccessor());

    // get and apply disabled class
    var disabledClass = "disabled";
    if (allBindings)
        disabledClass = allBindings().disabledClass || "disabled";
    if (enabled) {
        $(element).removeClass(disabledClass);
        if (element.tagName === "A")
            $(element).off("click.koEnableUpdate");
    }
    else {
        $(element).addClass(disabledClass);
        if (element.tagName === "A")
            $(element).on("click.koEnableUpdate", function (e) { e.preventDefault(); });
    }

    return result;
};
ko.bindingHandlers.disable.update = function (element, valueAccessor, allBindings) {
    // call enable with the reverse value
    // the original knockout disable does this, but does not pass the allBindings
    ko.bindingHandlers.enable.update(element, function () {
        return !ko.unwrap(valueAccessor())
    }, allBindings);
};

var koClickInitOrig = ko.bindingHandlers.click.init;
ko.bindingHandlers.click.init = function (element, valueAccessor, allBindings) {
    // wrap click function with enable/disable check
    var valueAccessorOrig = valueAccessor();
    valueAccessor = function () {
        return function () {
            if (ko.unwrap(allBindings().enable) ||
                (allBindings().disable == null || !ko.unwrap(allBindings().disable))) {
                valueAccessorOrig.apply(this, arguments);
            }
        }
    };

    // apply wrapped click to original click init
    koClickInitOrig.apply(this, arguments);
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-07T10:24:07.760

这是我的方法：

**JavaScript**

```
(function () {
  var originalDisableUpdate = ko.bindingHandlers.disable.update;

  ko.bindingHandlers.disable.update = function (element, valueAccessor) {
      if (element.tagName === 'A') {
        var
          value = ko.utils.unwrapObservable(valueAccessor()),
          disabled = 'disabled';

        if (value) {
          element.setAttribute(disabled, null);
        }
        else {
          element.removeAttribute(disabled);
        }
      }
      else {
        originalDisableUpdate(element, valueAccessor);
      }
  };
})(); 
```

**CSS**

```
a[disabled] {
  pointer-events:none;
  cursor:default;
} 
```

# sql - SQL Server 到 CSV 字符编码

> ID：10820123
> 
> 赞同：0
> 
> 时间：2012-05-30T16:12:48.813
> 
> 标签：sql, sql-server, csv, character-encoding

我有一个我正在做的 SQL Server 数据库提取。

在我的程序开始时，我有：

```
ini_set('mssql.charset','cp1250'); 
```

我的数据库调用没有做任何特别的事情。

我只调用以下方法：

```
mssql_connect, mssql_select_db, mssql_query, mssql_fetch_object, 
mssql_next_result and mssql_close. 
```

当我在屏幕上打印导出的输出时，所有字符看起来都很好。当我导出`fputcsv()`到 csv 文件时，我得到了大量的 <92> 和 <93> 字符（这是我使用终端读取它们时它们的外观）。当我使用 Excel 打开文件时，它们看起来像 ì、í 和 î

这导致了重大问题。你有什么想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:58:14.933

尝试将编码转换为 utf8

```
iconv('cp1250', 'utf-8', $text); 
```

也打印这个：

```
var_dump(iconv_get_encoding('all')); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T18:23:34.427

谢谢，但事实证明问题不在于编码，而在于我的 fputcsv() 调用实际上没有指定分隔符。我为 delim 选择了“\t”，一切都很完美。

# objective-c - NSTask - 执行回显命令

> ID：10820125
> 
> 赞同：2
> 
> 时间：2012-05-30T16:12:54.440
> 
> 标签：objective-c, cocoa, command, nstask

我正在尝试运行一个**必须执行 echo** "Hello World"的简单任务

那么这是我的*代码：*

```
NSTask *task;
    task = [[NSTask alloc] init];

    [task setLaunchPath:@"/bin/bash"]; 

    NSArray *arguments;

    arguments = [NSArray arrayWithObjects:@"echo","hello world" nil];
    [task setArguments: arguments];

    NSPipe *pipe;
    pipe = [NSPipe pipe];
    [task setStandardOutput: pipe];
    [task setStandardError: pipe];

    NSFileHandle *file;
    file = [pipe fileHandleForReading];

    [task launch];
    //...
    //Code to get task response 
```

继续给我***没有这样的文件或目录错误***..我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T16:30:04.710

执行命令的正确方法是

```
bash -c "echo 'hello world'" 
```

这意味着您应该传递的参数是

```
arguments = [NSArray arrayWithObjects:@"-c", @"echo 'hello world'", nil]; 
```

# openlayers - 通过 OpenLayers 中其他的位置变化来改变地图位置

> ID：10820126
> 
> 赞同：0
> 
> 时间：2012-05-30T16:12:55.157
> 
> 标签：openlayers

我尝试通过另一个地图的位置来更改一个地图的位置，因此我需要设置一个绑定到诸如“locationChanges（）”之类的回调函数。通过这种方式，我可以设置一个尊重另一个的位置。我怎么能在 Open Layers API 中做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T09:04:58.090

不知道你需要什么，是这样的吗？

```
map.events.on({
    'moveend': function(){
        another_map.zoomToExtent(map.getExtent());
    }
}); 
```

# javascript - 使用从模态表单中选择的值将值附加到主表单

> ID：10820129
> 
> 赞同：-1
> 
> 时间：2012-05-30T16:13:05.117
> 
> 标签：javascript, asp.net-mvc, model-view-controller, jquery

我有一个视图，让用户从模式表单中选择一个电子邮件地址并更新主表单文本框中的值

```
 <div class="editor-label">
        <%: Html.Label("Additional Email Address") %>           
    </div>

    <div class="editor-field modADLookup">          
        <%: Html.TextBoxFor_Readonly(model => model.AdditionalEmailsSentTo, new {@class = "adEmail", style = "width:500px; height:40px;" })%>
        <%: Html.SecurityTrimmedActionButton(true, "Search Active Directory", "Index", "ActiveDirectory", null, "clsSearchButton")%>
    </div> 
```

假设我选择电子邮件 abc@abc.com，文本框加载值“abc@abc.com”，现在当我下次选择 xyz@xyz.com 时，它会将“abc@abc.com”替换为“xyz@xyz.com”。

我正在寻找的是一种附加电子邮件地址并让文本框保留现有电子邮件 ID 的方法。

例如：在第二次选择之后它应该有“abc@abc.com, xyz@xyz.com”。

如何在主窗体中进行附加？

谢谢苏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T22:19:14.420

选择正确的值后，通过 jquery 捕获该值并将其附加到 AdditionalEmailsS​​entTo 文本框。

例如，当您选择一封电子邮件时，您会执行以下操作：

```
$("#SelectListThatContainsValues").change(function() {
    var newvalue = $(this).val();
    var currentValue = $("#AdditionalEmailsSentTo").val();
    $("#AdditionalEmailsSentTo").val(currentValue + "," + newValue);
}); 
```

# c# - 使属性分配成为一个动作

> ID：10820136
> 
> 赞同：1
> 
> 时间：2012-05-30T16:13:32.837
> 
> 标签：c#

只是一个例子：我有一个对设置属性做出反应的类。更具体地说，一旦全部设置完毕，就会从其中加载程序集的三个属性。之后触发一个事件。

我对此行为的单元测试如下所示：

```
bool assemblyLoaded = false;
loader.AssemblyLoaded += () => assemblyLoaded = true;
loader.Type = "someType";

Assert.IsFalse(assemblyLoaded); // not loaded, only one property was set 
```

这将导致三个单元测试，每个属性一个测试。所以我想通过使用帮助方法（见下文）来抽象测试以避免代码复制：

```
private void Testfoobar(Action setProperty)
{
    bool assemblyLoaded = false;
    loader.AssemblyLoaded += (sender, args) => assemblyLoaded = true;
    setProperty();
} 
```

不幸的是，我无法将属性分配设为操作。

所以，我想知道，你能以某种方式将作业“转换”为行动吗？或者是否有不同的方法来抽象代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T16:22:59.873

当您说您不能将属性分配作为操作时，您是什么意思？
你不能在行动中执行任务吗？
为什么不能使用

```
Action<loader> action =(loader)=>loader.Type="someType"; 
```

如果你想用委托来做，你可以使用 Funct<> 委托：

```
Func<string> funct = ()=>"someType"; 
```

# c# - C# try catch 继续执行

> ID：10820137
> 
> 赞同：21
> 
> 时间：2012-05-30T16:13:35.327
> 
> 标签：c#, try-catch

我有一个看起来相当简单的问题（当然，如果你知道答案的话）。

某个函数我调用了另一个函数，但我想继续从调用者执行，即使被调用者抛出了异常。让我给你举个例子：

```
something function1()
{
    try
    {
        //some code
        int idNumber = function2();
        //other code that need to execute even if function2 fails
        return something;
    }
    catch(Exception e)
    {//... perhaps something here}
} 
```

**编辑：function1 也有一个 return 语句，所以实际上没有什么可以在途中崩溃**

在function2中我需要做一些事情，但我只需要在失败时记录，例如：

```
int function2()
{
    try
    {
        //dostuff
    }
    catch(Exception e)
    {
        //Log stuff to db
    }
} 
```

**好的，现在我的问题是，如果我想在函数 1 中继续执行，即使函数 2 抛出错误，我该怎么办？**

*有时，如果我应该投掷，我会混淆；或抛出 e；或什么都不扔（将 catch 块留空）*

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-05-30T16:16:02.793

将 catch 块留空应该可以解决问题。不过，这几乎总是一个坏主意。一方面，存在性能损失，另一方面（这更重要），您总是想知道何时出现错误。

我猜想，在你的情况下，“被调用者”函数失败实际上不一定是“错误”，可以这么说。也就是说，它有时*会*失败。如果是这种情况，几乎总有比使用异常更好的方法来处理它。

*但是*，如果您原谅双关语的话，“规则”有例外***。***例如，如果 function2 要调用的 Web 服务的结果对于您的页面来说并不是真正需要的，那么这种模式可能没问题。尽管在几乎 100% 的情况下，您至少应该将其记录在某个地方。在这种情况下，我会将其记录在一个`finally`块中并报告服务是否返回。请记住，现在可能对您没有价值的数据可能会在以后变得有价值！

最后编辑（可能）：

在评论中，我建议您将 try/catch*放在*function2 中。只是想我会详细说明。Function2 看起来像这样：

```
public Something? function2()
{
    try
    {
        //all of your function goes here
        return anActualObjectOfTypeSomething;
    }
    catch(Exception ex)
    {
        //logging goes here
        return null;
    }
} 
```

这样，由于您使用可为空的返回类型，因此返回 null 不会对您造成伤害。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-30T16:17:21.140

为什么不能使用 finally 块？

像

```
try {

} catch (Exception e) {

  // THIS WILL EXECUTE IF THERE IS AN EXCEPTION IS THROWN IN THE TRY BLOCK

} finally { 

 // THIS WILL EXECUTE IRRESPECTIVE OF WHETHER AN EXCEPTION IS THROWN WITHIN THE TRY CATCH OR NOT

} 
```

修改问题后编辑：

你可以做：

```
int? returnFromFunction2 = null;
    try {
        returnFromFunction2 = function2();
        return returnFromFunction2.value;
        } catch (Exception e) {

          // THIS WILL EXECUTE IF THERE IS AN EXCEPTION IS THROWN IN THE TRY BLOCK

        } finally { 

        if (returnFromFunction2.HasValue) { // do something with value }

         // THIS WILL EXECUTE IRRESPECTIVE OF WHETHER AN EXCEPTION IS THROWN WITHIN THE TRY CATCH OR NOT

        } 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-30T16:16:45.340

或者您可以将循环逻辑本身封装在 try catch 中，例如

```
for(int i = function2(); i < 100 /*where 100 is the end or another function call to get the end*/; i = function2()){

    try{
     //ToDo
    }
    catch { continue; }    

} 
```

或者...

```
try{ 
    for(int i = function2(); ; ;) {
        try { i = function2(); return; } 
        finally { /*decide to break or not :P*/continue; } }
} catch { /*failed on first try*/ } finally{ /*afterwardz*/ } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-30T16:15:33.353

就这样做

```
 try
    {
        //some code
     try
     {
          int idNumber = function2();

     }
     finally
     {
       do stuff here....
     }
    }
    catch(Exception e)
    {//... perhaps something here} 
```

出于所有意图和目的，finally 块将始终执行。现在有几个异常实际上不会执行：任务终止程序，还有一个快速失败安全异常会立即终止应用程序。除此之外，函数 2 中将抛出异常，finally 块将执行所需的代码，然后在外部 catch 块中捕获异常。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-30T16:19:40.473

你的意思是不管function2是否抛出异常，你都想在function1中执行代码？你看过finally块吗？[http://msdn.microsoft.com/en-us/library/zwc8s4fz.aspx](http://msdn.microsoft.com/en-us/library/zwc8s4fz.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-30T16:20:05.767

在您的第二个函数中，删除 catch 块中的 e 变量，然后添加 throw。

这会将生成的异常传递给最终函数并输出。

当您不希望您的业务逻辑代码抛出异常但您的 UI 时，这很常见。

# android - 从活动和启动的服务访问数据库的正确方法？

> ID：10820138
> 
> 赞同：0
> 
> 时间：2012-05-30T16:13:36.197
> 
> 标签：android, database

**简短版**：从活动和启动服务访问同一数据库的最佳实践方式是什么？

**长版**：我有一个从活动开始持久服务的案例。当活动在屏幕上显示数据时，服务正在用数据填充数据库。它们都不是一直在运行 - 服务可以在没有活动时运行，而活动可以在服务尚未启动时运行。但是服务只能从活动中停止（它永远不会自行停止）。

我正在使用 SQLiteOpenHelper 的子类来访问数据库。我绊倒的问题是，显然在一个实例中关闭[数据库`SQLiteOpenHelper`也会在另一个实例中关闭它](http://www.ragtag.info/2011/feb/1/database-pitfalls/)。

我可以想到这些选项：

1.  单例模式（`SQLiteDatabase`公共静态变量中的单个实例 - 只有活动才能关闭它（因为它知道服务是否正在运行）） - 丑陋
2.  检查服务/活动是否正在运行，然后在另一个中关闭它 - 丑陋
3.  将获取/发布构建到 SQLiteOpenHelper 的`getReadableDatabase()`/`close()`

我会选择 3.，但这一定是一个非常常见的模式，所以我想知道是否已经有这样的内置机制 - 我不想重新发明轮子。

换句话说，正确的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:52:17.323

Android 上任何数据库的通常范例是让一个提供者打开数据库并将请求作为意图处理。这具有序列化请求的优点。

从不同的代码打开数据库是完全不标准的。

如果您确实需要应用程序在每次添加某些内容时都注意到，那么来自提供商的广播意图可能就是答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T19:46:03.223

我已经使用保留/释放计数器解决了这个问题：

```
public class DBHandler extends SQLiteOpenHelper
{
    private static int retainCount = 0;

    @Override
    public synchronized SQLiteDatabase getReadableDatabase()
    {
        DBHandler.retainCount++;
        return super.getReadableDatabase();
    }
    @Override
    public synchronized SQLiteDatabase getWritableDatabase()
    {
        DBHandler.retainCount++;
        return super.getWritableDatabase();
    }
    @Override
    public synchronized void close()
    {
        DBHandler.retainCount--;
        if (DBHandler.retainCount == 0)
            super.close();
        }
    }
} 
```

# php - 使用 PHP 脚本监控 Memcached

> ID：10820142
> 
> 赞同：5
> 
> 时间：2012-05-30T16:13:50.110
> 
> 标签：php, memcached, monitoring

我编写了一个 PHP 脚本，我用 CRON 安排它每分钟运行一次。该脚本的目标是验证 memcached 服务器是否在线。我的策略只是尝试连接到 memcached 服务器。如果我连接成功，我会关闭连接。如果我没有成功连接，我会发送一封电子邮件提醒 memcached 离线。

我的问题：这是一个足以证明 memcached 启动并运行的测试，还是通常的做法不仅仅是连接到 memcached？我是否还应该测试我是否可以设置和检索键/值对？

此外，在未来，我们可能希望对 memcached 进行更广泛的监控，以便我们可以跟踪内存使用、连接、请求数量等。是否有开源库可以从 PHP 中执行此操作？如果是这样，在您的体验中，哪些表现出色？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T16:22:46.683

你不需要构建任何东西。有许多 PHP 脚本用于监控、调试和显示 Memchached 服务器的统计信息。

我知道并且工作良好的有两个：

*   phpmemcacheadmin[完整的监控和调试套件](http://code.google.com/p/phpmemcacheadmin/)
*   memcache.php[类似于 apc.php 的简单脚本](http://pecl.php.net/package/memcache)（捆绑在存档文件中以供发布）

# jquery - 如何引用特定的 td(s) 以使用 jQuery 从 html 表中获取它们的值？

> ID：10820147
> 
> 赞同：0
> 
> 时间：2012-05-30T16:14:10.663
> 
> 标签：jquery, struts2

我正在使用 jQuery 1.6.4，并且我有一组从 html 表中获取的值。我要做的是在用户单击该行时从特定的 td 获取值。我使用此代码从特定行获取所有 td 值：

jsp代码：

```
<tr>
<s:iterator value="model.NameList">
<tr>
   <td align=center><s:property value="message.substring(0,125)"/></td>
   <td align=center><s:property value="timestamp"/></td>
   <td align=center><s:property value="retryCount"/></td>
   <td align=center><s:property value="specialId"/></td>
...
   </tr>
  </s:iterator> ... 
```

**specialId 是我需要从 click 事件的每个选定行中获取的 td 单元格值。**

//点击事件代码省略。

```
var arr = [];
arr = $(this).find('td').map(function(){     
return this.innerHTML;   
}).get(); 
```

然后，当我循环遍历该行中的单元格时，我需要使用 if 块检查特定单元格的值。我在下面的代码中对其进行了硬编码以获取值，但我需要动态地执行此操作。

```
$.each(arr, function(i, l){ 
    if(i == 6) { ... 
```

所以我为 td 单元格创建了一个 id 来获取该值，但我需要从多行中获取这个特定的单元格值，因此 id 本身将不起作用。如果用户选择多行并将该值发送到 Struts2 隐藏文本框，我需要处理从行中获取值，然后从多行中获取它。我只是使用一个文本框开始并且有效。

```
$('#textboxId').val(l); //Set the value to the id of a hidden textbox. 
```

我会以错误的方式解决这个问题吗？由于我只需要每一行中的一个值，我认为有一种更好的编码方式，但我还需要允许 td 的 n(values)。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T16:20:35.090

[`parent()`](http://api.jquery.com/parent/)您可以使用jquery方法根据用户的点击查找父TD 。

**[这是一个工作演示](http://jsfiddle.net/s47Uv/1/)**

这是我正在使用的示例 HTML：

```
<table>
    <tr>
        <td><span>Foo</span></td>
    </tr>
    <tr>
        <td><span>Bar</span></td>
    </tr>
</table>​ 
```

这是使用 1.6.4 的 Jquery 代码。

```
$(document).ready(function(){
    $('span').bind('click',function(){
        var newVal = '<b>You clicked</b>';
        $(this).parent('td').html(newVal);
    });
});​ 
```

它不完全清楚你在你的问题中问什么，所以我可能弄错了。如果是这样，请为我们创建一个 jsfiddle 以更好地了解您的问题。

**编辑**

在对您的问题进行编辑之后，这就是您要查找的内容：

**示例 HTML**

```
<table>
    <tr>
        <td>Property</td>
        <td>Timestamp</td>
        <td>RetryCount</td>
        <td>SpecialID</td>
    </tr>    
</table>​ 
```

**jQuery**

```
$(document).ready(function(){
    $('tr').bind('click',function(){
       alert($(this).children('td').last().text());
    });
});​ 
```

**[现场演示](http://jsfiddle.net/s47Uv/3/)**

**解释**

您首先将单击处理程序附加到，`tr`以便用户可以单击行上的任意位置。单击处理程序查找单击的所有`td`元素`tr`（即子元素）。在它找到的所有孩子中，你告诉它提醒最后一个孩子的文本（这就是`.last()`方法所做的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T16:21:19.573

单击行时，您可以使用以下方法获取值：

```
jQuery('table tr').click(function(){
   jQuery('#hiddenInputText').val('jQuery(this).find('#thisone').text()'); 
   //thisone is the id of the id whose value should be fetched
});​ 
```

说你的文本字段是否像

```
<s:inputText id="hiddenInputText" /> 
```

[JS小提琴](http://jsfiddle.net/mprabhat/Dv4Dw/1/)

# facebook - Facebook 分享者：我可以在分享后更改描述吗？

> ID：10820151
> 
> 赞同：0
> 
> 时间：2012-05-30T16:14:21.420
> 
> 标签：facebook

我在自己开发的网站上使用 Facebook 分享按钮。

网站上线后，有人分享了主页，而 og:title 的值仍设置为“建设中”。

现在，og:title 设置为更合适的值，当我想分享主页时，分享者预览会显示正确的标题。但是墙上（或消息）上使用的实际标题是“正在建设中”。

谁能告诉我如何（或是否）我可以重置它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:48:14.457

[通过Facebook 调试工具](http://developers.facebook.com/tools/debug)运行 URL，该工具将清除页面的缓存

# jquery - 使用 jQuery 使用公共 id 合并 2 个 json 对象

> ID：10820154
> 
> 赞同：2
> 
> 时间：2012-05-30T16:14:32.310
> 
> 标签：jquery, json, merge

我有 2 位 json：

```
[
    { "my-id": "123re4",
      "file-path": "3:1/test.png"
    },
    { "my-id": "23gf45",
      "file-path": "3:5/test2.gif"
    }
] 
```

和

```
[
    { "my-id": "123re4",
      "status": 0
    },
    { "my-id": "23gf45",
      "status": 0
    }
] 
```

它们都持有关于同一个项目列表的信息，每个项目都用一个唯一的 id 'my-id' 标识。我想将它们与 jquery 结合起来，以便最终得到一个合并的 json 对象，如下所示：

```
[
    { "my-id": "123re4",
      "file-path": "3:1/test.png",
      "status": 0
    },
    { "my-id": "23gf45",
      "file-path": "3:5/test2.gif",
      "status": 0
    }
] 
```

有谁知道解决这个问题的最佳方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:17:53.433

你可以试试

`var object3 = $.extend({}, object1, object2);`

这将进行合并..如果找到具有相同 iD 的另一个对象，则将其覆盖。 [参考这里](http://api.jquery.com/jQuery.extend/)了解更多

您还可以合并 `$.extend(object1, object2);`此将 object2 合并到 object1 中。

我建议使用第一种方法。（因为它更容易阅读和理解）

# javascript - JavaScript - 重构 getElementById

> ID：10820156
> 
> 赞同：1
> 
> 时间：2012-05-30T16:14:57.737
> 
> 标签：javascript, refactoring, getelementbyid

我使用了很多 getElementById 并且我对重构它的最佳方法有疑问。

正如许多人已经做过的那样，我使用此代码使其更简单、更容易并减小文件大小：

```
 function $(id){
return document.getElementById(id);
} 
```

但是关于我需要帮助的内容：添加一个变量并`document.getElementById`在我需要的每个函数中更改它们会更好吗？或者，我应该坚持我已经拥有的（的用法`$(id)`）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:22:04.793

是的，`window.$ = document.getElementById.bind(document);`也会起作用。一般请参阅[此答案](https://stackoverflow.com/a/9804995/1048572)和[getElementById](https://stackoverflow.com/q/6398787/1048572)的 Javascript 简写。

如果您害怕污染全局命名空间或与某些`$`广泛使用选择器快捷方式的库（尤其是它们的插件）发生冲突，您需要在函数范围内将其设为局部变量：

```
(function(/*id selector*/ $) {
    // your code here, using $
})(document.getElementById.bind(document)); 
```

实际上与

```
(function() {
    function $(id){return document.getElementById(id);}
    // your code here, using $
})(); 
```

# eclipse - eclipse 只删除光标的左侧或右侧

> ID：10820160
> 
> 赞同：0
> 
> 时间：2012-05-30T16:15:08.883
> 
> 标签：eclipse, ide, eclipse-plugin

我正在寻找一个插件或现有功能，可以删除右侧（这更重要）或光标左侧的文本。

```
int x = | newAssignmentGoesHereButIWanttoChangequickly(); 
```

假设管道是游标。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T12:22:58.527

以下是一些组合键：
在 Windows 或 Linux 上：
`Shift`+`Home`或. 在 Mac 上：+`Delete``Backspace`

`Command``Backspace`

# apache - 如何使用 htacess 为每个 url 请求一个 php 页面？

> ID：10820161
> 
> 赞同：0
> 
> 时间：2012-05-30T16:15:10.687
> 
> 标签：apache

假设我有以下网址

```
http://host/testscripts/php_Env 
```

当我请求此页面时，htaccess 应将 .php 附加到它

这样新的 url 就变成了在此处输入代码 `enter code here`http://host/testscripts/php_Env.php

我有以下htaccess。

```
RewriteEngine On    # Turn on the rewriting engine
RewriteRule    ^php_[a-zA-Z_]+$  $1.php   [NC,L] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:33:26.603

你忘了括号。

```
RewriteEngine On    # Turn on the rewriting engine
RewriteRule    ^php_([a-zA-Z_]+)$  $1.php   [NC,L] 
```

# excel - VBA 选项私有模块等效，但仅适用于类模块中的单个函数？

> ID：10820163
> 
> 赞同：2
> 
> 时间：2012-05-30T16:15:13.237
> 
> 标签：excel, excel-addins, private-methods, vba

在 VBA 中，我知道如果您希望子/函数只能在当前项目中访问，您可以将这些方法放入标记为`Option Private Module`.

但是如果我想用类模块中的某个方法来做到这一点呢？我可以从一个类中分离出一个方法吗？

具体来说，我的一个类中有一个属性，我希望它是只读的，除非它正在当前项目中使用。该类中还有其他我希望真正公开的属性/子/函数。

我认为`Friend Property Let...`这可能是正确的方法，但是当我尝试时，它不会阻止同一个打开的 Excel 会话中的另一个项目分配给该属性。所以我正在寻找`Option Private Module`类中函数子集的等价物。

这可能吗？

* * *

解决这个问题的另一种方法是：你可以将一个类模块分布在多个子模块上吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T11:52:46.510

由于这个问题没有多少人关注，而且我什至可能没有很好地表达它，我只是想我会在此期间发布我决定如何解决这个问题，以供后代使用。

VBA 中的类只能是`Private`or `PublicNotCreateable`，所以我已经使用工厂方法来创建对象。
我只是在工厂方法中添加了一些代码来为每个对象分配一个唯一标识符，并在我自己的单独数据结构中跟踪项目范围的伪属性。该类具有属性的“获取”，但要分配给它，`Option Private Module`需要调用模块中的特殊项目范围函数。
不是一个完美的解决方案，但至少它可以满足我的需求。

# c# - 正则表达式未返回正确的术语

> ID：10820164
> 
> 赞同：0
> 
> 时间：2012-05-30T16:15:19.673
> 
> 标签：c#, regex

有人可以告诉我我的正则表达式是怎么回事：

```
expression = (?<=current run date :)([^\.]*?)
searchString = date : 2012-05-26 03:00:00.000 to current run date : 2012-05-26 04:00:00.000 
```

表达式目前是我的正则表达式搜索词。我一直得到一个正确的匹配，但它没有返回我想要的，它返回“”。

下面是值，这是我正在寻找的正则表达式返回。

```
value = 2012-05-26 04:00:00.000 
```

所以字符串中的最后一个日期。我使用 c# .net 4。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:26:58.520

你的问题的答案在最后：

`*?`

通常的`*`意思是“给我 0 个或更多匹配的字符，并给我尽可能多的字符”。“尽可能”被称为“贪婪匹配”。该`?`符号是一个从贪婪匹配切换到非贪婪匹配的修饰符，因此它实际上变成了“给我 0 个或更多匹配的字符，并给我尽可能少的字符。”。在这种情况下，最小的数字是 0。

因此，解决方法是`?`从您的表达式中删除该字符：

`(?<=current run date :)([^\.]*)`

**编辑：**还值得注意的是，您在这里使用了前瞻，但您不需要。前瞻是昂贵的，因此除非需要，否则不应使用它们。您可以将您的正则表达式更改为：

`current run date :([^\.]*)`

您仍然会得到相同的结果，但引擎应该能够更快地返回您的结果（开销更少）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T16:28:48.533

使`?`零个或多个量词`*`以惰性或非贪婪的方式匹配。换句话说，它将尝试尽可能少地匹配。在这种情况下，它匹配一个空字符串，因为这显然是可能的最少数量。所以首先，你需要摆脱它`?`。

接下来，您的字符序列`[^\.]`告诉解析器它应该匹配除句点以外的任何字符`.`，但您的预期结果包括毫秒部分`.000`，其中明确包含句点。该部分不会与字符序列匹配，因此您会得到类似`2012-05-26 04:00:00`.

您可能希望更具体地使用您的模式。如果你*知道*你会得到这种格式的日期，这样的事情应该可以工作：

```
expression = current run date :\s+(\d{4}\-\d{2}\-\d{2}\s\d{2}:\d{2}:\d{2}\.\d{3}) 
```

或者你可以不那么严格并匹配接下来的两个单词

```
expression = current run date :\s+(\S+\s\S+) 
```

注意：`\d`是十进制字符`[0-9]`，`\s`是空格字符，例如空格、制表符、换行符，`\S`不是空格字符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T16:23:21.603

要返回您想要的，您必须从第一个捕获组中获取值，`$1`但您必须删除`?`字符。

逻辑上说它可以与那个非贪婪的运算符一起工作，但我无法解释为什么它不能。

如果将`*`乘数更改为，`+`您将看到它返回数字和`:`字符之间的第一个空格。

# jquery - JEdi table - 重置值

> ID：10820166
> 
> 赞同：3
> 
> 时间：2012-05-30T16:15:23.737
> 
> 标签：jquery, jeditable

这可能是我错过的一件容易的事情，但我找不到“重置”JEditable 字段中的值的方法。我让用户编辑三个字段，然后按一个按钮将这三个字段保存在一起。这工作正常，但一旦完成，我想重置我的 jEditable 字段，以便它们没有值并再次显示它们的占位符。用户输入的三个值显示在其他地方。

我试着做`$("#myfield").editable('reset')`，但没有奏效。

我发现的唯一方法是调用`.empty()`这些字段并使用我的回调函数和我的设置重新设置 .editable ，但我觉得这有点混乱。

还有什么办法吗？

根据要求，这是我想要做的 Fiddle 中[的一个示例：](http://jsfiddle.net/Wz8x9/1)

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T16:22:23.247

只是做这样的事情......

更具体一点：

```
$('.editable').editable('http://www.example.com/save.php', { 
     type     : 'textarea',
     submit   : 'OK',
     callback : function(value, settings) {
         $("#myfield").text('');
     }
}); 
```

我认为还有很多需要改进的地方，但它是一个工作版本:) 这是我到目前为止所做的：http: [//jsfiddle.net/Wz8x9/3/](http://jsfiddle.net/Wz8x9/3/)

这里没什么特别的。我刚刚将默认字段值存储在数据属性中......

```
<div id="field1" data-placeholder="First Name"></div> 
```

现在您可以像这样访问该值：

```
$('#field1').html($('#field1').attr('data-placeholder')); 
```

# scala - 如何在电梯中记录请求/响应

> ID：10820168
> 
> 赞同：2
> 
> 时间：2012-05-30T16:15:33.150
> 
> 标签：scala, lift

我有一个电梯项目，其中
有一个扩展 RestHelper 的类，看起来像这样

```
 serve{
        "api" / "mystuff" prefix {
         case a => ...
         case b => ...
          }
    } 
```

如何在不将其添加到每个案例语句的情况下记录所有请求（包括 POST 参数）和响应？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T17:44:06.147

要记录请求，您可以使用 LiftRules.statelessRewrite（在 bootstrap.liftweb.Boot 中）：

```
LiftRules.statelessRewrite.append {
   case RewriteRequest(ParsePath("api" :: key :: Nil, "", true, _), _, _) =>
      log.info("REST: %s" format key)
      RewriteResponse("api" :: key :: Nil,true)
} 
```

这将在以下休息服务器之前被拦截：

```
case "api":: key :: Nil Get _ => {
  val email = S.param("email") getOrElse {
    "missing email parameter"
  }
  Full(PlainTextResponse("succeeded: %s, %s" format (key,email)))
} 
```

请注意，保留 url 参数。

记录您使用的响应`LiftRules.afterSend`

更新：

使用 afterSend 您实际上可以访问请求和响应。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T19:16:52.337

serve 和 prefix 方法都采用 PartialFunction[Req, Box[LiftResponse]]。您没有直接使用这些类型，因为 RestHelper 为您提供了许多方便的方法和隐式转换，但您仍然*可以*直接访问 Req。如果您只对记录对“api”/“mystuff”前缀 URLS 的访问感兴趣，那很脏，但我认为您可以这样做：

```
object Log {

  def unapply(req: Req): Option[Boolean] = {
     ... code to log the request ....
     None
   }

}

serve{
  "api" / "mystuff" prefix {
    case Log(true) => //matching code will always be called but never match
    case a => ...
    case b => ...
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-27T13:53:44.647

根据Lift Cookbook 中的[调试请求](http://chimera.labs.oreilly.com/books/1234000000030/ch06.html#DebugRequest)`LiftRules.onBeginServicing`，您可以使用and `LiftRules.onEndServicing`：

```
LiftRules.onBeginServicing.append {
  case r => println("Received: "+r)
}

LiftRules.onEndServicing.append {
    case (req, Full(resp)) => println("Responded: " + resp)
} 
```

# c# - 旋转 - 寻找达到所需角度的时间

> ID：10820172
> 
> 赞同：1
> 
> 时间：2012-05-30T16:15:39.117
> 
> 标签：c#, math, rotation

**情况**

一段时间以来，我一直在努力解决这个问题。基本上，我有一个角度**r** *(弧度)*，我想在模拟的每个步骤中以设定的速度**dr** *(弧度/秒)将其更改为所需的角度***wr** *(弧度) 。*因此，我需要对于每一步，我都有一个新的角度**nr**，其中**nr = r + dr * dt**和**dt**是自上一步以来的增量时间。

 *******角度在空间 [-pi, pi] 中，增量角度由最短的转弯方式决定。对于每一步，增量角度被添加到当前旋转，包装到 [-pi, pi] 并存储为新角度。

由于我的步数没有无限精确，我显然会 - 实际上 - 永远不会直接达到所需的角度，因此我需要找到达到所需旋转的时间 -**并交叉**- 然后停止旋转并设置角度到所需的角度。在伪代码中：

```
if rotationSpeed!= 0
     angle = WrapRotation(angle + rotationSpeed * deltaTime)
     if desiredAngle has been reached or crossed
       angle = desiredAngle
       rotationSpeed = 0 
```

**问题**

在几乎所有情况下，这很容易做到，但是当您的角度足够高或足够低（接近 -pi 或 pi）并且新角度带您越过“边界”时，可以说，事情变得复杂了。我所有的尝试都未能涵盖当前、先前和所需轮换的所有可能情况。所以我问你是否碰巧知道解决方案？

如果需要，我在下面附上了我的代码（C#）：

```
// Sets the desired rotation and rotation speed in radians/second:
public void SetRotation(float rotation, float speed)
{
        desiredRotation = MathHelper.WrapAngle(rotation);
        if (desiredRotation != this.rotation)
        {
            // Determine the shortest way to turn (indicated by the sign of speed)
            float a = desiredRotation - this.rotation;
            if (a > Math.PI) a -= 2 * (float)Math.PI;
            if (a < -Math.PI) a += 2 * (float)Math.PI;

            desiredRotationSpeed = a < 0 ? -speed : speed;
        }
 }

 // Update is called per each step. Takes in the amount of seconds since the last call.
 public void Update(float seconds)
 {
        /* Other stuff */
        if (desiredRotationSpeed != 0)
        {
            float delta = desiredRotationSpeed * seconds;
            rotation = MathHelper.WrapAngle(rotation + delta);
            if( /* This is the part I'm struggling with. */ )
            {
                desiredRotationSpeed = 0f;
                rotation = desiredRotation;
            }
        }
        /* Other stuff */
 } 
```

在正常情况下（非循环行为），以下工作：

```
if (Math.Abs(value - desiredValue) < Math.Abs(deltaValue))
    /* Desired has been reached. Do stuff! */ 
```

所以要澄清。我想找出何时达到所需的角度（并且由于精度而超过），以便我可以将当​​前角度设置为所需的角度，并停止旋转。

非常感谢你的帮助！我有一种感觉，这真的有一个简单的解决方案！:3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T17:01:51.307

为什么要*越过*所需的旋转？为什么不将 delta 计算为当前角度和所需角度之间的最小角度以及您想要移动的 delta？这样，最后一步将您移动到所需的角度。

我还会更改您的代码，以便`SetRotation`只存储两个值`desiredRotation`，`speed`然后计算`Update`可以将所需角度与当前角度进行比较，计算差异，将其限制为速度值 x 秒数，然后移动该金额（与方向 +ve 或 -ve 的适当 if 语句）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T17:24:28.617

多亏了 Ian Mercer，我才知道该怎么做。

与普通号码一样：

```
if (Math.Abs(value - desiredValue) < Math.Abs(deltaValue)) 
    /* Desired has been reached. Do stuff! */ 
```

我所需要的只是一些三角函数来找到角度之间的最小角度。将这两个角度视为从 origo 指向的向量（或者更确切地说是两个向量，它们与 x 轴之间的角度），那么最小的角度很容易找到。考虑以下：

```
Math.Atan2(Math.Sin(toAngle - fromAngle), Math.Cos(toAngle - fromAngle)) 
```

那会给我最小的角度。找出何时停止旋转只是看旋转的距离是否大于两个角度之间的最小距离/角度。

对上面的代码进行以下更改将解决问题：

```
 double distance = Math.Atan2(Math.Sin(desiredRotation - rotation),
       Math.Cos(desiredRotation - rotation));
  if(Math.Abs(distance) < Math.Abs(delta))
  {
       desiredRotationSpeed = 0f;
       rotation = desiredRotation;
  } 
```

我希望我曾为这个问题咨询过亲爱的老[乔治·波利亚](http://en.wikipedia.org/wiki/How_to_Solve_It)。感谢人们的帮助，我需要朝着正确的方向前进！*******

# maven - 私有关系存储库无法从中央存储库下载 *.jar

> ID：10820178
> 
> 赞同：0
> 
> 时间：2012-05-30T16:15:57.293
> 
> 标签：maven, repository, nexus

我建立了一个私人关系存储库。当我使用私有存储库不包含它的库时，它应该尝试从中央存储库下载它。但事实是，它只是为我下载了一个 *.pom 文件。但是当我像下面这样评论镜子时

```
<mirrors>
<mirror>
      <id>nexus</id>
      <name>local private nexus</name>
      <mirrorOf>*</mirrorOf>
      <url>http://localhost:8081/nexus/content/groups/public</url>
</mirror>
</mirrors> 
```

然后它起作用了！有没有人可以为我解释一下？非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T17:04:21.137

您的 Nexus 配置似乎有问题。

当镜像被注释掉时，Maven 直接进入中央而不使用 Nexus，所以它可以工作。

我认为值得检查您的 Nexus 日志以获取更多详细信息。

# sql - 使用 TFS 2010 构建 Sql 项目 - 错误 MSB4023

> ID：10820181
> 
> 赞同：3
> 
> 时间：2012-05-30T16:16:00.657
> 
> 标签：tfs2010, sql, msbuild

在我们的项目中，我们还有一个 SQL 项目，以便我们将所有内容都置于源代码控制之下。我在项目中添加了两个 sproc，现在我在[tfs2010](/questions/tagged/tfs2010 "显示标记为“tfs2010”的问题")中收到以下构建错误，但项目在本地构建和部署良好。

```
C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v10.0\TeamData\Microsoft.Data.Schema.Common.targets(92,18): 
error MSB4023: Cannot evaluate the item metadata "%(FullPath)". The item metadata "%(FullPath)" cannot be applied to the path "Schema Objects\Schemas\<Schema Name>\Programmability\Stored Procedures\<sprocName> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T11:02:23.560

乍一看，构建失败是因为构建路径超过了 260 个字符。

我将从查看路径长度开始。根据您的设置，有几种解决方案。

如果项目也升级了，我之前也看到过这个错误。

您使用的是什么数据库项目版本？

您可以检查以确保构建服务器正在根据您在本地使用的正确版本编译 VSDB 项目的源代码。[我提出这个是因为新的数据库工具可能正在尝试升级您的项目。](http://blogs.msdn.com/b/ssdt/archive/2011/11/21/top-vsdb-gt-ssdt-project-conversion-issues.aspx)

希望这可以帮助。

[团队建设和 260 多个角色路径](http://blogs.msdn.com/b/aaronhallberg/archive/2007/06/20/team-build-and-260-character-paths.aspx)

[Windows 命名文件、路径和命名空间](http://msdn.microsoft.com/en-us/library/aa365247%28VS.85%29.aspx)

# vba - “查找所有”方法

> ID：10820184
> 
> 赞同：0
> 
> 时间：2012-05-30T16:16:11.390
> 
> 标签：vba, ms-word

我想在文档中找到具有某种颜色的所有文本并将其打印在调试窗口中。

```
Sub FindText()
    Selection.Find.Font.Color = 3539877
    Selection.Find.Execute
    Debug.Print Selection
End Sub 
```

问题是它只给我下一个结果，而我想一次打印所有结果。据我所知，“FindAll”方法不可用。也许我可以访问一个包含所有查找结果的数组。

此外，稍微无关，是否可以将所有结果复制到剪贴板而不是打印它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T20:49:34.513

您必须循环进行查找。请参阅此示例。我将查找结果存储在一个数组中

```
Option Explicit

Sub FindText()
    Dim MyAR() As String
    Dim i As Long

    i = 0

    Selection.HomeKey Unit:=wdStory
    Selection.Find.Font.Color = -671023105

    Do While Selection.Find.Execute = True
        ReDim Preserve MyAR(i)
        MyAR(i) = Selection
        i = i + 1
    Loop

    If i = 0 Then
        MsgBox "No Matches Found"
        Exit Sub
    End If

    For i = LBound(MyAR) To UBound(MyAR)
        Debug.Print MyAR(i)
    Next i
End Sub 
```

# java - Java 静态变量意外持续存在

> ID：10820185
> 
> 赞同：0
> 
> 时间：2012-05-30T16:16:17.540
> 
> 标签：java, variables, static

我在调试的应用程序中遇到了一个令人沮丧的静态变量问题（我自己没有编写代码）。

我有一个名为 Transits 的 mysql 数据库表。Transits 有一个字符串列 (varchar)，其中包含格式为“yyyy/MM/dd HH:mm:ss”的日期 (eventdt)。

在我相应的休眠类中，我有一个 Date 变量，它将存储 eventdt 的值。因此，当读取 eventdt 时，代码会将其从字符串转换为日期。

该代码使用 SimpleDateFormat 来进行转换。程序员使用了一个静态变量来保存格式，但不幸的是出现了格式错误：

```
private static DateFormat df = new SimpleDateFormat("yyyy/MM/dd hh:mm:ss"); 
```

保持原样，在中午时间存储在 eventdt 列中的每个日期都存储在相应的 Date 变量中作为午夜。显然这是不可取的，所以我试图修复它：

```
private static DateFormat df = new SimpleDateFormat("yyyy/MM/dd HH:mm:ss"); 
```

但是，代码继续保留之前的格式“yyyy/MM/dd hh:mm:ss”。

我已经阅读了一些静态变量，并尽我所能来清除它。我重新编译了代码，然后重新部署（在 Glassfish 3.1.1 上）。我重新启动了 Netbeans (7.1.1)，然后再次重建/重新部署。我清除了 Netbeans 缓存并重复了相同的过程。然后我删除了整个 Glassfish 安装，重新启动，重新创建域，再次清除缓存，并进行了相同的重建/重新部署。

我还尝试更改代码本身。我想也许这可能是一个线程问题，所以我将变量更改为 static final：

```
private static final DateFormat df = new SimpleDateFormat("yyyy/MM/dd HH:mm:ss"); 
```

然后我将其更改为静态最终变量是格式字符串，并在需要它的每个方法中实例化 DateFormat 对象：

```
// In class variable block
private static final String DATETIME_FORMAT_PATTERN = "yyyy/MM/dd HH:mm:ss";

// In class methods
DateFormat df = new SimpleDateFormat(DATETIME_FORMAT_PATTERN); 
```

无论我做了什么，都会保留相同的错误格式“yyyy/MM/dd hh:mm:ss”。

我能想到的唯一一件我还没有做的事情是删除并重新安装 Netbeans。我在某处读过更新它也有帮助。我需要走那么远才能清除旧的静态变量吗？

我也没有尝试将代码放在同步块中或将其初始化为 ThreadSafe（尽管我什至不确定线程​​是这里的问题......）

我将不胜感激任何正确方向的指导，因为我已经没有想法了。谢谢！

编辑：这里要求的是使用 DateFormat 的代码。lpr 是另一个 Hibernate 对象，它整合了 Transits 表和一些其他需要的表。

```
 Date activityDate = null;
    try {
        activityDate = df.parse(getEventdt());
        lpr.setActivityDateTime(activityDate);
    } catch (Exception e) {
        logger.warn("Unable to parse " + getEventdt() + " as a date.");
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T16:21:51.367

NetBeans 不太可能是罪魁祸首。我猜想问题出在部署中，很可能是静态日期格式编译成的 jar 没有被部署。

您也可以在类路径中的某个地方拥有那个 jar，它会被拾取而不是您更改的那个。

另一种可能性是这不是负责日期的日期格式化程序。我会在行上放一个断点，看看你是否击中它。如果你真的击中它，它是否使用了正确的格式字符串？

# c# - 在 C# 中对具有空值的数据库进行选择时处理空白字符串 ("") 文本框值

> ID：10820188
> 
> 赞同：1
> 
> 时间：2012-05-30T16:16:29.497
> 
> 标签：c#, asp.net, visual-studio-2010, sql-server-2008

我正在使用 a`DataGridView`来显示 MSSQL 数据库中的数据。我有几个文本输入字段，当`onkeyup`注册事件时，它执行`lookup query`（使用表适配器）文本字段作为`parameter`SQL 字符串。

我的数据库当前设置为具有一些可为空的字段。

当我在文本输入字段中有一个长度为零的字符串值时，该值不为空，因此 SQL Select 不会`(LIKE clause)`将文本框值与数据库中的 NULL 值匹配。

处理这种情况的最佳方法是什么？将数据库中的所有空字段都转换为NULL？

在查询数据库时，我可以将任何空白输入字符串转换为 null，但这意味着数据库中任何为空字符串且实际上不是 null 的字段都将被排除。

我想我可能遗漏了一些明显的东西，我在网上找不到任何类似的问题，但如果有人能指出我正确的方向，那就太好了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T16:20:37.440

如果您想选择为空但包含空字符串的数据，那么您可以像这样更改您的选择查询：

```
select * from your_table where some_column is null or len(some_column) = 0 
```

不完全确定你在找什么，但怎么样

```
SELECT * FROM Table 
WHERE (Param1 is null or Column1 LIKE '%' + Param1 + '%')
and (Param2 is null or Column2 LIKE '%' + Param2 + '%') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T16:28:09.703

> 我也按其他参数过滤。例如，我从文本框中填写了 2 个参数...

如果要处理多个搜索参数：

```
...
WHERE ( @field1 IS NULL OR COALESCE(field1,'') like '%' + @field1 + '%' )
AND   ( @field2 IS NULL OR COALESCE(field2,'') like '%' + @field2 + '%' )
AND   ( @field3 IS NULL OR COALESCE(field3,'') like '%' + @field3 + '%' ) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T16:22:21.980

尝试像这样使用。如果您的字段值为空，只需将其转换为空字符串并查找您的参数。

```
select * from table
ISNULL(field,'') like @yourparam 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-30T17:13:39.973

我假设您正在使用**`ASP.NET`**

首先，我认为设计中存在问题。您将一遍又一遍地参加 的`Database`每个**`KeyPress`**事件**`TextBox`**。如果您可以通过保存数据来避免它**`ViewState/Session`**？

**回到原来的查询...**

```
Declare @Param Varchar(100)
Set @Param = null

if(@Param is null or @Param = '')
Begin
     select * from your_table
End
Else
Begin
     select * from your_table where some_column like '%' + @Param + '%'
End 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-26T11:07:00.927

```
SELECT * FROM Table 
Where Column1 LIKE '%' + ISNULL(Param1,Column1) + '%' 
```

上面将检查参数是否为NULL。如果它为 NULL，则只需将其与相同的列名进行比较。这是最简单和最短的方法。

# javascript - 将某些值从一个元素复制到另一个元素

> ID：10820189
> 
> 赞同：0
> 
> 时间：2012-05-30T16:16:30.870
> 
> 标签：javascript, jquery

我正在尝试使用 JavaScript/jQuery 将宽度和高度属性从一个元素复制到另一个元素，但无法实现。

我有类似的东西：

```
<div id="two">

<img src="picture.jpg" id="one" width="600px" height="300px" />

</div> 
```

我想得到这个：

```
<div id="two" width="600px" height="300px" >

<img src="picture.jpg" id="one" width="600px" height="300px" />

</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T16:18:08.893

使用 jquery：

```
var $one = $('#one');
$('#two').attr('width', $one.attr('width'))
.attr('height', $one.attr('height')); 
```

但通常这是错误的。您应该有一个使 div 适应您的图像的 css。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T16:22:34.667

您可以直接访问图像元素的`.width`和`.height`属性。

div 没有这些属性，所以你必须使用 CSS 来设置它们：

```
var img = $('#one').get(0);
$('#two').css({ width: img.width, height: img.height }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T16:19:42.767

我建议，没有更多信息：

```
var el = $('#two'),
    img = el.find('img');

el.css({'height' : img.height(), 'width' : img.width()}); 
```

参考：

*   [`find()`](http://api.jquery.com/find/).
*   [`height()`](http://api.jquery.com/height/).
*   [`width()`](http://api.jquery.com/width/).

# sencha-touch-2 - Sencha 中的验证无法正常工作

> ID：10820193
> 
> 赞同：2
> 
> 时间：2012-05-30T16:16:47.307
> 
> 标签：sencha-touch-2

我是 Sencha 的新手，所以基本上我在验证中遇到问题这是我的代码

```
Ext.define("PlayListApp.view.PlayEditor", {
    extend: "Ext.form.Panel",
    requires: "Ext.form.FieldSet",
    alias: "widget.playeditorview",
     config:{ 
        scrollable: 'vertical',
        items: [
            {
                xtype: "toolbar",
                docked: "top",
                title: "Edit PlayList",
                items: [
                    {
                        xtype: "button",
                        ui: "action",
                        iconCls:"home",
                        iconMask:true,
                        itemId: "backButton"
                    },
                    { xtype: "spacer" },
                    {
                        xtype: "button",
                        ui: "action",
                        iconCls:"compose",
                        iconMask:true,
                        itemId: "saveButton"
                    }
                ]
            },
            {
                xtype: "toolbar",
                docked: "bottom",
                items: [
                    {
                        xtype: "button",
                        iconCls: "trash",
                        iconMask: true,
                        itemId: "deleteButton"
                    }
                ]
            },
            { xtype: "fieldset",
                items: [
                    {
                        xtype: 'textfield',
                        name: 'title',
                        label: 'Link',
                        placeHolder: 'http://yousite.com',
                        required: true,

                    },
                    {
                        xtype: 'numberfield',
                        name: 'narrative',
                        label: 'Duration',
                        placeHolder:'99',  
                        required:true
                    }
                ]

            }
        ],
 listeners: [
            {
                delegate: "#backButton",
                event: "tap",
                fn: "onBackButtonTap"
            },
            {
                delegate: "#saveButton",
                event: "tap",
                fn: "onSaveButtonTap"
            },
            {
                delegate: "#deleteButton",
                event: "tap",
                fn: "onDeleteButtonTap"
            },

        ]
    },

  onSaveButtonTap: function () {
        //console.log("saveNoteCommand");
        this.fireEvent("saveNoteCommand", this);
    },
    onDeleteButtonTap: function () {
        //console.log("deleteNoteCommand");
        this.fireEvent("deleteNoteCommand", this);
    },
    onBackButtonTap: function () {
        //console.log("backToHomeCommand");
        this.fireEvent("backToHomeCommand", this);
    }

}); 
```

我想验证标题和叙述，但问题是当我单击保存按钮时只有标题正常工作，而没有为叙述分配任何值，然后它在不检查叙述的验证条件的情况下保存。

```
Ext.define("PlayListApp.model.Play", {
    extend: "Ext.data.Model",
    config: {
        idProperty: 'id',
        fields: [
            { name: 'title', type: 'string' },
            { name: 'narrative', type: 'int'}
        ],
        validations: [
            { type: 'presence', field: 'title', message: 'Please enter a link in playlist.' },//This validation only works
            { type: 'presence', field: 'narrative', message:  'Please enter duration in playlist'},
            { type: 'length', field:'narrative', min:'1', max:'3', message:'Please enter digit between 1 and 3'}
        ]
    }
}); 
```

下面我正在检查每个字段的验证

```
Ext.define("PlayListApp.controller.Plays", {

    扩展：“Ext.app.Controller”，
    配置：{
        参考：{
            // 我们将通过 xtype 查找我们的视图。
            notesListView: "播放列表视图",
            noteEditorView: "playeditorview",
            笔记列表：“#notesList”
        },
        控制： {
            笔记列表视图：{
                // 笔记列表容器触发的命令。
                newNoteCommand: "onNewNoteCommand",
                editNoteCommand: "onEditNoteCommand"
            },
            注意编辑器视图：{
        // 注释编辑器触发的命令。
                 saveNoteCommand: "onSaveNoteCommand",
                 deleteNoteCommand: "onDeleteNoteCommand",
                 backToHomeCommand：“onBackToHomeCommand”
        }
        }
    },  

    onSaveNote 命令：函数（）{

        //console.log("onSaveNoteCommand");

        var noteEditor = this.getNoteEditorView();

        var currentNote = noteEditor.getRecord();
        var newValues = noteEditor.getValues();

        // 使用表单值更新当前笔记的字段。
        currentNote.set("title", newValues.title);
        currentNote.set("narrative", newValues.narrative);

        var 错误 = currentNote.validate();
        味精='';
        if (!errors.isValid()) {
            //Ext.Msg.alert('等一下！','请填写所有字段',Ext.emptyFn);
            //Ext.Msg.alert('Wait!', errors.getByField("title")[0].getMessage(), Ext.emptyFn);
            错误。每个（函数（错误）{
                                            味精 += err.getMessage() + ' 
';
                                        }); // 每个（）
                                        Ext.Msg.alert('错误！', msg);                              
            currentNote.reject();
            返回;
        }

        var notesStore = Ext.getStore("Notes");

        //notesStore.sync();

        //notesStore.sort([{ property: 'dateCreated', direction: 'DESC'}]);

        this.activateNotesList();
    },

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T06:44:08.640

我已经对您的问题做了一些工作，但是通过在“PlayListApp.controller.Plays”中添加自定义验证。现在“叙述”字段的长度不会超过 3 位数。用户也不能输入负数。

您必须在两个文件中进行更改：-

1) “PlayListApp.model.Play”
2) “PlayListApp.controller.Plays”

```
 // "PlayListApp.model.Play"

   Ext.define("PlayListApp.model.Play", {
extend: "Ext.data.Model",
config: {
    idProperty: 'id',
    fields: [
        { name: 'title', type: 'string' },
        { name: 'narrative', type: 'int'}
    ],
    validations: [
        { type: 'presence', field: 'title', message: 'Please enter a link in playlist.' },//This validation only works
        { type: 'presence', field: 'narrative', message:  'Please enter duration in playlist'},
        { type: 'presence', field: 'narrative', message: 'Enter a number for this note.' }
    ]
}
}); 
```

这是controller.js - “PlayListApp.controller.Plays”

```
Ext.define("PlayListApp.controller.Plays", {

extend: "Ext.app.Controller",
config: {
    refs: {
        // We're going to lookup our views by xtype.
        notesListView: "playslistview",
        noteEditorView: "playeditorview",
        notesList: "#notesList"
    },
    control: {
        notesListView: {
            // The commands fired by the notes list container.
            newNoteCommand: "onNewNoteCommand",
            editNoteCommand: "onEditNoteCommand"
        },
        noteEditorView: {
    // The commands fired by the note editor.
             saveNoteCommand: "onSaveNoteCommand",
             deleteNoteCommand: "onDeleteNoteCommand",
             backToHomeCommand: "onBackToHomeCommand"
    }
    }
},  

onSaveNoteCommand: function () {

    //console.log("onSaveNoteCommand");

    var noteEditor = this.getNoteEditorView();

    var currentNote = noteEditor.getRecord();
    var newValues = noteEditor.getValues();

   currentNote.set("title",newValues.title);
    currentNote.set("narrative", newValues.narrative);
    var errors = currentNote.validate();

    if (!errors.isValid()) {
        //Ext.Msg.alert('', errors.getByField("title")[0].getMessage(), Ext.emptyFn);
        errors.each(function (err) {
                                        msg += err.getMessage() + '<br>';
                                    }); // each()
                                    Ext.Msg.alert('ERROR!', msg);
        currentNote.reject();
        return;
    }

       // checking for negative number
    if(newValues.narrative<="0")
    {
      Ext.Msg.alert('','Choose number greater than 0');
      currentNote.reject();
      return;
    }
       // checking for value greater than 3-digit number
    if(newValues.narrative>"999")
    {
      Ext.Msg.alert('','Length should not be greater than THREE');
      currentNote.reject();
      return;
    }

    var notesStore = Ext.getStore("Notes");

    //notesStore.sync();

    //notesStore.sort([{ property: 'dateCreated', direction: 'DESC'}]);

    this.activateNotesList();
}, 
```

希望这对您有所帮助。
如果这不是您想要的，请再次说明您的要求。
再见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T13:41:32.033

在 PlayController 中，*onSaveNoteCommand*被调用，但我得到*currentNote*的空值，这导致应用程序死机。

```
  var currentNote = noteEditor.getRecord(); // 总是返回 null !?

```

我向[Sencha Fiddle](http://www.senchafiddle.com/#KIo66)添加了警报。 *noteEditor*有一个值。

# xcode - OS X Lion 和 Xcode 4.3.2 升级后无法加载修订版 SVN 消息

> ID：10820196
> 
> 赞同：1
> 
> 时间：2012-05-30T16:17:04.460
> 
> 标签：xcode, svn, osx-lion, revision

我升级到 OS X Lion 和 Xcode 4.3.2。升级后，当我打开 Organizer 并为我们的任何 SVN 项目选择根文件夹时，我立即收到“无法加载修订”消息，并且看不到文件夹信息。我正确输入了我的凭据并尝试了[此处](https://stackoverflow.com/questions/5309792/xcode-4-assembla-svn-repository-unable-to-load-revisions)和[此处](https://stackoverflow.com/questions/5376422/xcode-4-svn-working)的解决方案，但仍然无法正常工作。如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T22:58:43.473

我发现了错误。我使用 MacPorts 来管理开源软件的安装，例如本例中的 SVN。根据 MacPorts[迁移](https://trac.macports.org/wiki/Migration)指南，如果有任何问题，建议在 OS 升级后重新安装 Xcode 和 MacPorts。因此，我根据本[指南](http://guide.macports.org/chunked/installing.macports.uninstalling.html)卸载了所有端口，然后卸载了 MacPorts 。然后我从[MacPorts 下载目录](https://distfiles.macports.org/MacPorts/)安装了最新版本的 MacPorts for OS X Lion 。最后，为了以防万一，我对 MacPorts进行了[自我更新，并](http://guide.macports.org/chunked/using.html#using.port.selfupdate)[重新安装了 SVN](https://trac.macports.org/wiki/howto/Subversion)。然后我可以在 Organizer 中看到所有的 SVN 项目。

# c# - typeof(T).AssemblyQualifiedName 返回 null

> ID：10820200
> 
> 赞同：2
> 
> 时间：2012-05-30T16:17:17.037
> 
> 标签：c#, reflection

我一直在处理一些我需要添加模块的代码，我认为我已经正确设置了所有内容，但最后一点让我难住了。

看起来比较简单，我将一个类型传递给一个泛型方法

```
var name typeof(T).AssemblyQualifiedName; 
```

这样我就可以做到这一点

```
var type = Type.GetType(name); 
```

`name`但是它在最后一行抛出异常`null`

我一直在阅读类型反射，我知道它`GetType`需要完全限定的程序集名称，但我不明白为什么它会返回为空。

这是否意味着我对我的代码做了一些根本错误的事情，因为我假设它`AssemblyQualifiedName`是从一个类型发出的，因为它知道它是如何被引用的？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-30T16:19:32.703

那么`AssemblyQualifiedName` *可以*返回null：

> Type 的程序集限定名称，包括从中加载 Type 的程序集的名称，如果当前实例表示泛型类型参数，则为 null。

如果你真的只是在使用它，它*看起来*并不应该代表一个泛型类型参数`typeof(T)`——除非泛型方法是通过反射以某种奇怪的方式调用的。

你为什么要尝试使用`Type.GetType`？听起来你只需要

```
var type = typeof(T); 
```

......这不正是你想要的吗？为什么要通过类型的名称？

# asp.net-mvc-3 - MVC 中的自动刷新在 IE 中不起作用，但在 Chrome 中起作用

> ID：10820203
> 
> 赞同：1
> 
> 时间：2012-05-30T16:17:30.630
> 
> 标签：asp.net-mvc-3, partial-views

我需要在我的一个 MVC 应用程序中实现自动刷新，但我遇到了一些问题。当我使用 jquery.get() 和部分视图执行自动刷新逻辑时，它在 Chrome 和 Opera（最新版本）中完美运行，但在 IE 9 中不起作用。我花了大约一天时间试图弄清楚问题，但无济于事。

我做了一个小测试应用程序，只是为了测试所有浏览器中的自动刷新功能。我对这个应用程序有同样的问题。

我已经附上了下面的代码，如果有人能告诉我我的代码有什么问题，我将不胜感激？如果您需要更多信息，请告诉我。

谢谢，阿比。

**索引.cshtml**

```
@model IEnumerable<AutoRefreshInMVC.Views.ViewModels.HomeIndexModel>
@{
Layout = null;
}
<!DOCTYPE html>
<html>
<head>
<link href="../../Content/Site.css" rel="stylesheet" type="text/css" />
<script src="../../Scripts/jquery-1.7.2-vsdoc.js" type="text/javascript"></script>
<script src="../../Scripts/jquery-1.7.2.js" type="text/javascript"></script>
<script src="../../Scripts/jquery-ui-1.8.20.min.js" type="text/javascript"></script>
<title>Index</title>
<script type="text/javascript">
    function refresh() {
        $.get('/Home/_Quotes', function (result) {

            $('#refreshme').html(result);
        });
    }

    $(document).ready(function () {
        setInterval("refresh();", 10000);
    });
</script>
</head>
<body>
<div id="refreshme">
    @Html.Partial("_Quotes", Model)
</div> 
```

**家庭控制器**

```
public class HomeController : Controller
{
    //
    // GET: /Home/
    public ActionResult Index()
    {
        List<HomeIndexModel> model = new GetQuotes().GetData();

        return View(model);
    }

    private static List<HomeIndexModel> GetData()
    {
        List<HomeIndexModel> model = new GetQuotes().GetData();
        return model.OrderByDescending(i => i.Change).ToList();
    }

    public ActionResult _Quotes()
    {
        List<HomeIndexModel> model = GetData();
        return View(model);
    }
} 
```

**_Quotes.chtml**

```
@model IEnumerable<AutoRefreshInMVC.Views.ViewModels.HomeIndexModel>
<table id="tblIndex">
<tr id="header">
    <th>
        Code
    </th>
    <th>
        LastValue
    </th>
    <th>
        CurrentValue
    </th>
    <th>
        Change
    </th>
</tr>
@foreach (var item in Model)
{
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.Code)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.LastValue)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.CurrentValue)
        </td>
        <td class="Change">
            @Html.DisplayFor(modelItem => item.Change)
        </td>
    </tr>

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T23:56:12.993

我在这些方面遇到了一些问题，使用 jquery 速记`$.get`和`$.post`结果与缓存相关的方法。

尝试用禁用缓存`$.get`的等效项替换您的，即`$.ajax`

```
$.ajax({
  url: '/Home/_Quotes',
  success: function (result) {
              $('#refreshme').html(result);
           },
  cache: false
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T16:35:37.330

setInterval 应如下所示：

```
setInterval(refresh(), 10000); 
```

另外，请注意您的调用可能会被缓存，因此您可能希望在 _Quotes 方法上放置一个 OutputCache 属性。

# jquery - jQuery onselect datetimepicker 更改

> ID：10820208
> 
> 赞同：1
> 
> 时间：2012-05-30T16:18:05.280
> 
> 标签：jquery, jquery-plugins

使用来自[http://trentrichardson.com/examples/timepicker/](http://trentrichardson.com/examples/timepicker/)的日期时间选择器，我必须更改用户单击特定日期时的最大小时数。到目前为止，我的代码进行了 AJAX 调用，并在一天中的每次点击中获得最大小时数（每天的最大小时数不同，并且存在于数据库中）。

现在我试图刷新视图，以便显示更新的 maxhour，但表单重置为“janaury 0”，当我关闭表单并单击它返回最后一个请求的 maxhour（如果应用于选定的任何一天）。

要重置表单，我使用了选项方法，但它不起作用，所以我有一个方法在每个`onselect`事件上调用，该方法会破坏 datetimepicker 的旧属性并重新制作所有内容并分配属性。

我什至尝试使用应该刷新视图的 datetpicker 的刷新方法。

初始分配

```
$("#startDate").datetimepicker({
    onSelect: function (date) {
        manipulate(date);
    },
    timeFormat: 'hh:mm:ss tt',
    hourMin: 8,
    hourMax: endHour,
    showSecond: false,
    stepMinute: 15,
    minuteGrid: 5,
    addSliderAccess: true,
    sliderAccessArgs: {
        touchonly: false
    },
    showOn: "button",
    buttonText: "Select a date to check out equipment(s).",
    buttonImage: "../images/calendar.gif",
    buttonImageOnly: true,
    defaultDate: "+0",
    changeMonth: false,
    numberOfMonths: 2,
    minDate: 0,
    maxDate: '+5w',
    beforeShowDay: unavailable,
    ampm: true
});

function manipulate(date) {
    var sendDate = date.toString();
    jQuery.ajax({
        url: "endtime.php",
        data: {
            day: sendDate
        },
        type: "POST",
        success: function (XML) {
            var answer = jQuery("data", XML).text();
            var time = answer.split(":");
            var timetemp = sendDate.split(" ");
            var timenew = timetemp[0] + " " + answer;
            //$("#startDate").datetimepicker.( "option" ,hourMax ,time[0]); this is one of the first approach
            $("#startDate").datetimepicker("destroy");
            //$("#startDate").datetimepicker("refresh");
            var DateOptions = {
                onSelect: function (date) {
                    manipulate(date);
                    //$("#startDate").datetimepicker("refresh");
                    //datepicker._gotoToday('#startDate');
                },
                timeFormat: 'hh:mm:ss tt',
                hourMin: 8,
                hourMax: time[0],
                showSecond: false,
                stepMinute: 15,
                minuteGrid: 5,
                addSliderAccess: true,
                sliderAccessArgs: {
                    touchonly: false
                },
                showOn: "button",
                buttonText: "Select a date to check out equipment(s).",
                buttonImage: "../images/calendar.gif",
                buttonImageOnly: true,
                defaultDate: "+0",
                changeMonth: false,
                numberOfMonths: 2,
                minDate: 0,
                maxDate: '+5w',
                beforeShowDay: unavailable,
                ampm: true,
                setDate: date
            }
            $("#startDate").datetimepicker(DateOptions);
        }
    })
} 
```

任何帮助将不胜感激。

# regex - 为什么jmeter中的正则表达式提取器并不总是提取相同的值？

> ID：10820209
> 
> 赞同：0
> 
> 时间：2012-05-30T16:18:06.117
> 
> 标签：regex, jmeter

我有两个 WebService(SOAP) 请求。两个 Web 服务调用的响应在结构上完全相同。对于 Web 服务调用编号 1，它具有以下结构，

```
 <data xsi:type="soapenc:string">0</data>
  <data xsi:type="soapenc:string">650</data> 
```

对于 Web 服务调用编号 2，它具有以下结构，

```
 <data xsi:type="soapenc:string">0</data>
  <data xsi:type="soapenc:string">10203</data> 
```

在这些调用中的每一个下，我都有一个正则表达式提取器。参考名称不同；但一切都定义完全一样。提取器具有以下定义。

```
Apply to: Main Sample Only
Response Field to check: Body
Regular Expression: <data xsi:type="soapenc:string">(\d+?)</data>
Template: $1$
Match No.: 0 
```

对于 Web 服务调用编号 1，提取器获取的值是 650，这正是我想要的。但是对于 2 号 Web 服务调用，提取器实际上得到的值为 0，这不是我想要的。我想在 Web 服务调用号 2 中得到的是 10203。我的问题是，为什么正则表达式提取器定义会返回两个不同的结果？

提前致谢，
蒙特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T17:56:44.477

如果您使用的匹配数为零，它将随机为您的正则表达式提取一个值。0 = 随机匹配，1 = 第一次匹配，2 = 第二次，等等...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T20:48:29.460

看起来你已经在这里问过[同样的问题了](https://stackoverflow.com/q/10626762/993246)。

1.  使用[正则表达式提取器](http://jmeter.apache.org/usermanual/component_reference.html#Regular_Expression_Extractor)或[XPath 提取器](http://jmeter.apache.org/usermanual/component_reference.html#XPath_Extractor)- 如上面的评论中所述，哪个更适合解析 xml， - 使用单个表达式 - （对于 RegEx Extractor: `<data xsi:type="soapenc:string">(.+?)</data>`，对于 XPath Extractor: `//data/text()`- 获取所有匹配项。
    然后使用相应的生成的变量来访问您需要的匹配 - 通过`${refName_2}`例如（访问通过查询提取到 refName 变量的第二个匹配），这对于 RegEx 和 XPath 提取器都是实际的， - 或者强制 RegEx 提取器默认使用特定匹配，通过设置“匹配号” .”（根据上面的示例到 2）。

2.  将[XPath Extractor](http://jmeter.apache.org/usermanual/component_reference.html#XPath_Extractor)与[xpath 查询](http://www.w3schools.com/xpath/xpath_syntax.asp)一起使用，它将唯一地描述所需的值：通过固定位置 - 就像`//data[position()=2]/text()`在你的情况下（假设第一个匹配总是 0 并且你需要第二个）， - 或按值 - 比较匹配的 text() 到0 喜欢`//data[text()!=0]/text()`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-28T07:26:28.597

给定 Web 服务调用

对于 Web 服务调用编号 1，它具有以下结构

```
<data xsi:type="soapenc:string">0</data>
  <data xsi:type="soapenc:string">650</data> 
```

对于 Web 服务调用编号 2，它具有以下结构

```
<data xsi:type="soapenc:string">0</data>
  <data xsi:type="soapenc:string">10203</data> 
```

我们可以从以下格式的 Web 服务调用号 1 中提取值 650

```
</data>\s\s<data xsi:type="soapenc:string">(.+)</data>
or
</data>\s\s<data xsi:type="soapenc:string">([0-9]+)</data> 
```

我们可以从 Web 服务调用号 2 中提取值 10203，格式如下

```
</data>\s\s<data xsi:type="soapenc:string">(.+)</data>
or
</data>\s\s<data xsi:type="soapenc:string">([0-9]+)</data> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-30T17:58:00.670

我对`?`你的正则表达式中的 :感到困惑`(\d+?)`。这意味着“一个或多个数字，但可选。”

鉴于您来自电话号码 1 和电话号码 2 的输入数据，我希望它在两种情况下都与第一行匹配`<data xsi:type="soapenc:string">0</data>`，但您说它不匹配。

我怀疑不想将数字与前导零匹配。所以我建议

```
Regular Expression: <data xsi:type="soapenc:string">([1-9]\d*)</data> 
```

# android - Android 共享偏好

> ID：10820212
> 
> 赞同：-1
> 
> 时间：2012-05-30T16:18:14.133
> 
> 标签：android, sharedpreferences

我有一个注册程序的应用程序。这些字段是“徽章 ID（用户名）”和“密钥（密码）”。在流程开始时，我将设置来自共享偏好的两个输入值。我想要这两个值用于我的应用程序。当我们尝试给出接下来的两个值（或编辑这个值）时，会显示一个像“徽章已经被拿走。尝试'在此处输入！'”这样的祝酒词，我该如何实现这些？

```
Toast.makeText(getApplicationContext(), "Badge already taken.Try 'Enter Here !'", Toast.LENGTH_LONG).show(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:51:25.440

您可以使用`SharedPreferences.contains(String key)`来测试您的共享首选项是否已经存储了用户名或密码。

我建议您不要向用户抱怨更改名称或密码，而是简单地禁用或消除任何允许用户进行更改的 UI 元素。

例如，您可以在`onCreate`：

```
SharedPreferences prefs = PreferenceManager
    .getDefaultSharedPreferences(getContext());
if (prefs.contains(KEY_USERNAME)) {
    // name (and password, presumably) already stored
    // disable/hide appropriate UI elements
} else {
    // no user name stored
    // enable/show elements that allow user to make changes
} 
```

您甚至可以`setContentView`根据上述逻辑决定在调用中使用完全不同的布局。

# c - C语言获取int后从用户处获取字符串

> ID：10820217
> 
> 赞同：1
> 
> 时间：2012-05-30T16:18:30.750
> 
> 标签：c, printf, scanf, gets

我不明白为什么这段代码不能正常工作：

```
#include<stdio.h>

    int main()
{
    char string [100];
    int a;
    printf(">");
    scanf("%d", &a);
    printf(">");
    gets(string);
    printf("%s\n", string);
} 
```

这是我必须构建的程序的一小部分，我不明白为什么在通过 scanf() 函数获取值后，程序只是跳过或没有通过 gets() 函数正确读取字符串。如果您将代码复制到编译器并尝试运行，您就会明白我的意思。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T16:19:41.707

说明`%d`符不吃换行符（或其他空白）。尝试这个：

```
scanf("%d ", &a);
         ^ 
```

该空间使`scanf`扔掉所有空白，直到非空白为止。[顺便说一句，您的问题与此C FAQ](http://c-faq.com/stdio/scanfinterlace.html)非常相似。

* * *

*   不要使用`gets`，它太糟糕了，它甚至不再是语言了。`fgets`改为使用
*   不要相信任何建议`fflush(stdin)`你的问题的人

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-02T21:45:08.730

每当您需要阅读由空格组成的句子时（在任何 scanf 之后），请将您的 scanf 修改为：

```
scanf(" [^\n]", mystring);
       ^ Space here. 
```

看看你的例子：

```
#include<stdio.h>

int main(void)
{
    char mystring[100];
    int a;

    printf(">");
    scanf("%d", &a);

    printf(">");
    scanf(" %[^\n]", mystring);

    printf("Number:%d\nString: %s\n", a, mystring);

    return 0;
} 
```

# php - 如何实施贝宝定期付款沙箱？

> ID：10820220
> 
> 赞同：0
> 
> 时间：2012-05-30T16:18:35.837
> 
> 标签：php, paypal

我试图在 authorize.net 中像 ARB 一样实现 paypal Recurring 以向用户收取每月账单，我发现这是[这样的，我还在](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_nvp_r_GetRecurringPaymentsProfileDetails)[这里](https://cms.paypal.com/cms_content/US/en_US/files/developer/nvp_CreateRecurringPaymentsProfile_php.txt)找到了源代码。

但我无法找到我的 my_api_username、my_api_password、my_api_signature，因为它们在 api 中是必需的

```
$API_UserName = urlencode('my_api_username');
$API_Password = urlencode('my_api_password');
$API_Signature = urlencode('my_api_signature'); 
```

如果您有任何代码示例并且任何人都可以指导我在我的帐户中哪里可以找到这些变量，我无法在个人资料选项卡的帐户中找到它们。我想为沙盒实现这个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T21:31:35.447

这是一个帖子，告诉您在哪里可以找到该信息： [http ://www.putler.com/support/faq/how-to-get-paypal-api-username-password-and-signature-information/](http://www.putler.com/support/faq/how-to-get-paypal-api-username-password-and-signature-information/)

# mongodb - 如何在 mongodb 中创建自动增量子集合？

> ID：10820224
> 
> 赞同：0
> 
> 时间：2012-05-30T16:18:43.603
> 
> 标签：mongodb

我很难把我的想法包裹在这件事上。

我想保存每个用户提交的表单的自动递增列表。

我正在尝试实现类似的方案：

```
users:{
    _id:asfa98s7fasf,
    name:"some name",
    forms:{
       1:{
           _id:asdasdfa8sdf,
           q1:'yes',
           q2:'no',
           q3:'yes'
       }, 
       2:{
           _id:asdasdfgdfgf,
           q1:'no',
           q2:'no',
           q3:'yes'
       }
    }
} 
```

我不明白如何创建自动递增表单。

我想我需要在某个地方使用 ensureIndex 但我不确定。

有人可以指出我正确的方向吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T16:47:46.193

您可以在 2 个操作中执行此操作：

1.  使用查询查找表单数组中的总元素，N
2.  使用另一个更新查询再添加一个项目以形成数组，键为 "K+1" 。

您也可以尝试使用非关联数组将元素存储在表单文档中，除非您的键有一些特殊用途，例如：

```
users:{
    _id:asfa98s7fasf,
    name:"some name",
    forms:[
       {
           _id:asdasdfa8sdf,
           q1:'yes',
           q2:'no',
           q3:'yes'
       }, 
       {
           _id:asdasdfgdfgf,
           q1:'no',
           q2:'no',
           q3:'yes'
       ]
    }

} 
```

然后您可以使用`$push`运算符将​​元素添加到`form`数组中，该元素将自动附加到数组的第 3 位。 [http://www.mongodb.org/display/DOCS/Updating#Updating-%24push](http://www.mongodb.org/display/DOCS/Updating#Updating-%24push)

# actionscript-3 - Soundchannel的AS3限制？

> ID：10820227
> 
> 赞同：0
> 
> 时间：2012-05-30T16:18:59.610
> 
> 标签：actionscript-3, audio, simultaneous

我正在开发一个子弹地狱竞技场射击游戏，游戏会有很多敌人和子弹，所以它需要同时播放很多音效。我只使用一个 soundChannel 来处理所有音效，问题是……有时，某些声音无法播放，SoundChannel 中播放的声音有限制吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T20:43:26.737

这个库[http://joeberkovitz.com/blog/2009/05/15/standingwave-open-source-as3-audio/](http://joeberkovitz.com/blog/2009/05/15/standingwave-open-source-as3-audio/)。可以混合你所有的声音。使用简单，听起来比 Flash 声音播放器好得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T18:03:48.163

是的，我相信有一个限度。很多小枪音效和多次爆炸有时可能太多了。

如果我正确阅读了文档，我认为每个声音都应该有自己的 SoundChannel。

然后使用 SoundMixer 类管理所有声音。

[http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/media/SoundMixer.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/media/SoundMixer.html)

使用此类，您还可以设置声音缓冲区，以便所有效果都应在正确的时间播放。

# threadpool - Quartz 调度器和线程

> ID：10820230
> 
> 赞同：0
> 
> 时间：2012-05-30T16:19:05.907
> 
> 标签：threadpool, quartz-scheduler

这是一个理论问题。如果我有一个配置为使用 threadCount 的 Quartz 调度程序，比如说 3 个线程。如果其中一个作业根本没有结束，因为它听取了某种类型的流（例如 Twitter），我可以假设实际上只剩下 2 个线程用于执行待处理的作业吗？

感谢您的回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:54:53.023

是的，你的假设是正确的。此外，如果你有三个这样的作业，Quartz 将根本无法运行任何其他作业。

然而，让工作永远运行似乎是不寻常的（我不确定 Quartz 在这种情况下是否能很好地发挥作用，但很可能这不会成为问题）。如果您有一段代码会一直占用线程，只需手动创建该线程即可。

# google-sheets - 更改电子表格中的边距

> ID：10820234
> 
> 赞同：-1
> 
> 时间：2012-05-30T16:19:19.703
> 
> 标签：google-sheets

我在哪里可以更改电子表格中的边距以适应我想要在单个页面上显示的内容？我可以在 excel 中执行此操作，但是当我导入到 google 文档以共享时，它会更改它并且它不会打印我需要的方式。请为电子表格设置边距选项好吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T16:24:17.183

不，该功能尚不适用于电子表格，仅适用于文档（文件 > 页面设置）。

# php - 下一行的 Preg_match

> ID：10820236
> 
> 赞同：0
> 
> 时间：2012-05-30T16:19:20.277
> 
> 标签：php, preg-match

我的文本中有一个模式，下一行我需要一个 preg_match 模式。

```
Administrative Contact:
xxxx xxxxx

this is like this sometimes :

Admin contact: 
xxxxxx xxxx
or 
admin data:
xxxx xxxx 
```

是否可以为此编写正则表达式？我需要 xxxx xxxx 数据

谢谢你们

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T16:22:05.757

看起来共同的因素是：

*   以“管理员”开头
*   有一个`:`将标签与数据分开
*   有数据直到行尾

在这种情况下，正则表达式是：

```
/admin[^:]*:\s*(.*)/i 
```

所需的数据将在子模式 1 中。

# wpf - 错误：项目文件必须在参考列表中包含 .NET Framework 程序集“WindowsBase、PresentationCore、PresentationFramework”

> ID：10820241
> 
> 赞同：9
> 
> 时间：2012-05-30T16:19:33.527
> 
> 标签：wpf, winforms

我在带有 C# 的 Windows 窗体应用程序中使用 WPF。

跟进问题。 [将一组实线、虚线笔添加到组合框中](https://stackoverflow.com/questions/10810092/adding-a-collection-of-solid-dashed-lines-pen-to-a-combo-box)

错误：

> 项目文件必须在参考列表中包含 .NET Framework 程序集“WindowsBase、PresentationCore、PresentationFramework”。

请建议

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2015-05-13T20:56:49.490

这是一个老问题，但为了保持此资源有效：确实，您可以添加像这样的引用，正如罗斯和里德建议的那样，但我不相信这是实际的解决方案，你只是解决问题的结果，而不是原因。

正如@dumbledad 所说，当我在项目中包含在 .csproj 文件中标记为“页面”的文件时，我收到了完全相同的错误消息，导致 Visual Studio 想要编译此资源。然而，这是一个不可编译的资源（在我的例子中，它是一个 XAML 文件，也可能是一个图像）Visual Studio 要求额外的程序集。在这种情况下，不要只是添加它们，而是进入您的 .csproj 文件并进行以下调整：

搜索打开节点“<Page”并验证它的每个实例实际上是一个需要用相应操作处理的页面。如您所见，在我的情况下，资源被标记为页面，VS 尝试编译：

```
<ItemGroup>
  <Page Include="sitecore\shell\ClientBin\EmptySplashScreen.xaml">
    <Generator>MSBuild:Compile</Generator>
  </Page>
</ItemGroup> 
```

只需删除此部分（或页面节点）并将文件放回 .csproj 文件作为常规内容包含。您必须手动执行此操作，因为在 VS 中包含文件会重新生成相同的错误页面节点。所以我把它放回项目文件中，如下所示：

```
<Content Include="sitecore\shell\ClientBin\EmptySplashScreen.xaml" /> 
```

瞧，您的项目将再次构建，并且错误消息消失而无需添加那些额外的程序集引用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-30T16:23:23.820

在 Visual Studio 中，转到`Project`菜单 > `Add Reference`>`.NET`选项卡，选择`WindowsBase`，`PresentationCore`然后`PresentationFramework`在列表中按`OK`。然后再试一次。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T16:21:13.587

如果您尝试使用 WPF，则需要在项目引用中添加对列出的程序集的引用。

打开您的项目，然后选择“Project->Add Reference...”。将列出的程序集添加为引用，以便使用 WPF 类型。

# database - Hibernate hbm 多对多映射

> ID：10820242
> 
> 赞同：1
> 
> 时间：2012-05-30T16:19:38.820
> 
> 标签：database, hibernate, many-to-many, save, hbm

我正在尝试在 2 个对象之间创建一对多映射（使用 Java）。我能够将对象保存在数据库中，但不能保存它们的关系。我有一个名为“AuthorizationPrincipal”的类，它包含一组“权限”

```
<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
"-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd" >

<hibernate-mapping package="org.openmrs">

<class name="AuthorizationPrincipal" table="authorization_principal" lazy="false">

<id
    name="authorizationPrincipalId"
    type="int"
    column="authorization_principal_id"
    unsaved-value="0"
>
    <generator class="native" />
</id>

<discriminator column="authorization_principal_id" insert="false" />

<property name="name" type="java.lang.String" column="name" unique="true"
            length="38"/>

<many-to-one
    name="creator"
    class="org.openmrs.User"
    not-null="true"
/>

<property
    name="uuid"
    type="java.lang.String"
    column="uuid"
    length="38"
    unique="true"
/>
<property
    name="dateCreated"
    type="java.util.Date"
    column="date_created"
    not-null="true"
    length="19"
/>
<property
    name="policy"
    type="java.lang.String"
    column="policy"
    not-null="true"
    length="255"
/>

<!--  Associations -->

<set name="privileges" inverse="true" cascade=""
    table="authorization_principal_privilege" >
    <key column="authorization_principal_id" not-null="true"/>
    <many-to-many class="Privilege">
        <column name="privilege" not-null="true" />
    </many-to-many>
</set>

</class> 
```

我通过一些教程和示例提出了“set”标签，但它仍然不会保存在数据库中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T19:08:19.393

我看到的第一件事是错误的，您将关系定义为来自 AuthorizationPrincipal 实体*的多对多*，并且正如您在问题中所说，您想要一个一对多的关系。

然后，您必须像这样定义您的集合：

```
<set name="privileges" inverse="true" cascade="all,delete-orphan">
    <key column="authorization_principal_id" not-null="true" />
    <one-to-many class="Privileges" />
</set> 
```

这个配置对你来说应该足够了。

**编辑**

如果您的配置是多对多的，那么您必须有一个表来*记录 AuthoririzationPrincipal*和*权限*之间的关系，例如*AuthoririzationPrincipal-Privileges*

ypur 映射必须是这样的：

在授权主体中：

```
<set name="privileges" table="AuthoririzationPrincipal-Privileges">
    <key column="authorization_principal_id" />
    <many-to-many class="Privileges" column="privileges_id" />
</set> 
```

在特权中：

```
<set name="authorizationPrincipals" inverse="true" table="AuthoririzationPrincipal-Privileges">
    <key column="privileges_id" />
    <many-to-many class="AuthoririzationPrincipal" column="authorization_principal_id" />
</set> 
```

# apache-flex - 打印 AdvancedDataGrid 时网格标题文本不合适

> ID：10820246
> 
> 赞同：0
> 
> 时间：2012-05-30T16:19:42.027
> 
> 标签：apache-flex, air

我想打印 AdvancedDataGrid ，我正在使用此代码

```
public function doPrint():void {
            myPrintJob = new FlexPrintJob();
            myPrintDataGrid = new PrintAdvancedDataGrid();
            myPrintDataGrid.source=this.dataGrid;
            StageReference.instance.addElement(myPrintDataGrid);

            if (myPrintJob.start()) {   
                myPrintJob.addObject(myPrintDataGrid, FlexPrintJobScaleType.MATCH_WIDTH);
                myPrintJob.send();
                StageReference.instance.removeElement(myPrintDataGrid); 
            }
            else
            {
                StageReference.instance.removeElement(myPrintDataGrid);

            }
        } 
```

问题是标题文本使用了很多填充或类似的东西，所以文本不合适

![在此处输入图像描述](../Images/2a2cbd9cfa6b8117f86f190234808dbd.png)

如果有人可以给我任何提示，我不知道要寻找什么（也许尝试创建自己的标题渲染器？）

我找到了原因，FlexPrintJob.addObject 缩放网格，我认为标题需要更多帧直到更新，缩放中有一些奇怪的事情，我在调试中注意到宽度设置为 200，即使页面宽度是600，暂时没有真正的解决方案，然后避免缩放。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T21:09:57.890

如果 Flex 标签/文本对象认为它们没有足够的空间，它们通常会截断文本。

我快速查看`AdvancedDataGridHeaderRenderer`并确认，如果文本太宽**并且**网格的`variableRowHeight`属性为 false，渲染器将设置它的 UITextField 以截断文本。

AdvancedDataGridHeaderRenderer 的 commitProperties() 方法的片段（第 462 行）：

```
label.text = listData.label ? listData.label : " ";
label.multiline = grid.variableRowHeight;
// Get the headerWordWrap for a column, using the default wordWrap if none specified
if( _data is AdvancedDataGridColumn)
    label.wordWrap = grid.columnHeaderWordWrap(_data as AdvancedDataGridColumn); 
```

实际截断发生在 AdvancedDataGridHeaderRenderer 的 updateDisplayList() 方法中（第 628 行）。

知道了这一点，您有一些选择：

*   使用调试器单步执行 commitProperties/updateDisplayList 中的代码，以查看为什么标头中的标签对象**认为**它们需要如此小。在您的屏幕截图中，似乎有足够的空间——但出于某种原因，标签不这么认为。

*   覆盖 AdvancedDataGridHeaderRenderer 的 commitProperties/updateDisplayList 方法，使其完全符合您的要求

*   设置网格/渲染器的样式和属性以允许更多宽度和/或多行文本

要执行后者，您将需要执行以下一些组合：

*   使用 CSS 更改 AdvancedDataGridHeaderRenderer 的字体和其他样式（此类的默认填充为 2px）
*   为网格启用 variableRowHeight
*   将网格的[wordWrap](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/controls/listClasses/AdvancedListBase.html#wordWrap)属性设置为 true（仅适用于可变行高）
*   [或使用headerWordWrap](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/controls/advancedDataGridClasses/AdvancedDataGridColumn.html#headerWordWrap)属性在列级别控制自动换行`AdvancedDataGridColumn`

# php - 带有动态标题的 CJuiDialog

> ID：10820249
> 
> 赞同：0
> 
> 时间：2012-05-30T16:19:52.350
> 
> 标签：php, javascript, jquery-ui, dynamic, yii

我的问题是如何将标题值从链接或按钮传递给 CJuiDialog。

这是我打开 CJuiDialog 的一段代码：

```
echo CHtml::link('Add new role', '#', array(
   'onclick'=>'$("#new-role-dialog").data("curName", ""); $("#new-role-dialog").dialog("open"); return false;',
)); 
```

我尝试了很多不同的品种`$("#new-role-dialog").dialog("title", "My Title")`

这是与我类似的问题：[http ://www.yiiframework.com/forum/index.php/topic/25142-set-cjuidialog-title-dynmically/](http://www.yiiframework.com/forum/index.php/topic/25142-set-cjuidialog-title-dyanmically/)

但这些建议都没有帮助我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T16:26:44.603

首先，像这样创建一个 CJuiDialog

```
$this->beginWidget('zii.widgets.jui.CJuiDialog', array(
      'id'=>'new-role-dialog',
    // additional javascript options for the dialog plugin
    'options'=>array(
        'title'=>'Dialog box 1',
        'autoOpen'=>false,
    ),
));
echo 'dialog content here';

$this->endWidget('zii.widgets.jui.CJuiDialog'); 
```

然后以同样的方式调用它。

如果您想从 javascript 动态设置标题，您应该调用

```
$("#new-role-dialog").dialog( "option", "title", "Dialog Title" ); 
```

更多信息[在这里](http://jqueryui.com/demos/dialog/#options)。根据经验：始终检查插件的原始文档。Yii 扩展通常没有完整的 API 描述/示例 :)

# spring - 我可以为@RequestMapping 提供一个自定义模型参数吗

> ID：10820252
> 
> 赞同：0
> 
> 时间：2012-05-30T16:20:04.563
> 
> 标签：spring, spring-mvc

Spring MVC 自动将 Model 或 ModelMap 参数连接到`@RequestMapping`方法上，但它可以为 ModelMap 的子类做到这一点吗？如果是这样，我在哪里创建子类实例？

我认为 Spring MVC 将未注释的参数视为命令对象，并将从请求中填充其字段。我真的不希望发生这种情况，所以我有点害怕尝试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T16:30:22.560

除非我误解了您的问题，否则您只需要 @ModelAttribute 注释。例如，我有一个这样声明的方法：

```
@RequestMapping(value="/**/contractComplete.do",  method = RequestMethod.POST)
public static void handleContractComplete(
        @ModelAttribute(ParamConstants.CONTRACT) ContractCommand command,
        BindingResult result,
        HttpServletResponse response, HttpSession session) throws IOException 
```

* * *

或者这可能会有所帮助：在我的控制器的声明中，我有

```
@Controller
@SessionAttributes(ParamConstants.CONTRACT) 
```

结果是它使用了我在启动页面时放入模型中的相同命令对象。我怀疑这个对象可能是任何扩展（或实现）参数类的东西。

# java - 更改字段值

> ID：10820254
> 
> 赞同：0
> 
> 时间：2012-05-30T16:20:07.690
> 
> 标签：java, android

我对字符串替换有些困惑。我有类似的字符串

```
CustomerEmailID=fake; NavigatePageValue=0; IsCustomerInsertSucess=asdewewew; 
```

在这个字符串中，我需要将值更改`IsCustomerInsertSucess`为其他人。但我很困惑，我怎么能

我试过

```
String s1 = "CustomerEmailID=fake; NavigatePageValue=0; IsCustomerInsertSucess=asdewewew;";
s1 = s1.replaceAll("IsCustomerInsertSucess=(.*?);", "2026"); 
```

但它替换了整个字段，我也需要更改值，你能帮我吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T16:23:06.743

最简单的方法（不是最聪明的）是将第二行更改为

```
s1 = s1.replaceAll("IsCustomerInsertSucess=(.*?);", "IsCustomerInsertSucess=2026"); 
```

# java - Java.awt.SystemTray 无法正确显示托盘图标

> ID：10820255
> 
> 赞同：9
> 
> 时间：2012-05-30T16:20:11.690
> 
> 标签：java, swing, icons, awt, system-tray

我的代码片段如下：

```
SystemTray systray = SystemTray.getSystemTray();

try{
    TrayIcon trayicon = new TrayIcon(new ImageIO.read(new File("icon.png")),"I am a description");
}
catch(IOException e) {
    e.printStackTrace();
} 
```

一切运行顺利，但系统托盘中显示的图像被切断。除非我缩小到 16x16（从 40x40），否则只显示左上部分。这`icon.png`是一个正确加载的图像文件（不为空）。我认为系统托盘图标文件可能是 40px？

有人可以向我解释这里有什么问题吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-30T16:31:33.000

可能性包括`TrayIcon.setImageAutoSize()`，也许您的操作系统（假设是 Windows）设置为某种高 dpi 显示，如 120 或 144，而 Java 无法正确适应。

# java - 设计模式：像这样重构代码

> ID：10820260
> 
> 赞同：0
> 
> 时间：2012-05-30T16:20:30.643
> 
> 标签：java, oop, design-patterns, jakarta-ee, refactoring

我计划在下面重构我的代码

```
1.Class A_Builder to build A_Model

Class A_Builder{
public A_Model build(arg1){
//build A_Model
}
}

2.Class B_Builder to build B_Model

Class B_Builder{
public B_Model build(arg2,arg3){
//build B_Model
}
}

3.Class C_Builder to build C_Model
Class C_Builder{
public C_Model build(arg4){
//build C_Model
}
}

4.Class D_Builder... 
```

一个构建器来构建模型，所以我打算使用命令模式来重构它们，将构建方法作为命令，但是如何处理不同的变量号，比如 A 是 (arg1) 和 B 是 (arg2,arg3)

或任何想法来重构这样的代码？提前谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T16:27:01.453

您没有指定您正在使用的语言，但我遇到的大多数语言都支持[函数重载](http://en.wikipedia.org/wiki/Function_overloading)。

这意味着您可以声明两个具有相同名称但采用不同参数的独立函数，然后当您调用函数并执行适当的函数时，语言将检查您传递的参数：

```
class Builder {
    public build( arg ) {
        // Build A Model
    }

    public build( arg, arg ) {
        // Build B Model
    }

    ...
} 
```

或者，如果您的函数参数都是相同的变量类型，您可以简单地创建一个接受参数数组的函数。数组可以是可变长度的，因此您的单个函数可以执行不同的操作，具体取决于数组的长度：

```
class Builder {
    public build( arg[] ) {
        switch( arg.length ) {
            case 1:
                // Build A Model
                break;
            case 2:
                // Build B Model
                break;
            ...
        }
    }
} 
```

# dynamic - Wolfram Mathematica：仅跟踪一个变量的动态

> ID：10820265
> 
> 赞同：0
> 
> 时间：2012-05-30T16:20:59.540
> 
> 标签：dynamic, wolfram-mathematica

我要这个：

```
arr[[n]] = b; 
```

仅当**b**更改时自动重新评估。

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T17:09:56.130

你可能想要

```
 myArray={{1,2},{3,Dynamic[b]}}; 
```

通过评估`myArray` 和放置来检查，例如`Slider[Dynamic[b],{0,10}]`。

您可以`Dynamic`稍后设置该部分，即`myArray[[2,2]]=Dynamic[b]`也可以。

# android - 如果我在室内，如何找到我的当前位置？安卓

> ID：10820267
> 
> 赞同：1
> 
> 时间：2012-05-30T16:21:10.343
> 
> 标签：android

如果 GPS 不可用且没有无线网络，我想找到我的当前位置？我想我需要做一些计算，或者有一些代码可以为我做。？

谢谢。

我写了这样的代码，但是当我在室内时它找不到当前位置。

```
package com.anil.bestlocation;

import java.util.List;

import android.app.Activity;
import android.location.Criteria;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.location.LocationProvider;
import android.os.Bundle;
import android.widget.TextView;

public class showBestLocation extends Activity implements LocationListener{
    /** Called when the activity is first created. */

    private static final String[] S = { "Out of Service", 
                                        "Temporarily Out of Service", 
                                        "Available" };
    private TextView output;
    private LocationManager locationManager;
    private String bestProvider;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        output = (TextView) findViewById(R.id.txtLoc);

        locationManager = (LocationManager) getSystemService(LOCATION_SERVICE);

        //list all providers
        List<String> providers = locationManager.getAllProviders();
        for(String provider : providers){
            printProvider(provider);
        }

        Criteria criteria = new Criteria();
        bestProvider = locationManager.getBestProvider(criteria, false);
        output.append("\n\nBEST PROVIDER:\n");
        printProvider(bestProvider);

        output.append("Location.. (initialized with the last known location):");
        Location location = locationManager.getLastKnownLocation(bestProvider);
        printLocation(location);
    }

    @Override
    protected void onPause() {
        // TODO Auto-generated method stub
        super.onPause();
        locationManager.removeUpdates(this);
    }

    @Override
    protected void onResume() {
        // TODO Auto-generated method stub
        super.onResume();
        locationManager.requestLocationUpdates(bestProvider, 20000, 1, this);
    }

    @Override
    public void onLocationChanged(Location location) {
        // TODO Auto-generated method stub
        printLocation(location);

    }

    @Override
    public void onProviderDisabled(String provider) {
        // TODO Auto-generated method stub
        output.append("\n\nSProvider Disabled: " + provider);

    }

    @Override
    public void onProviderEnabled(String provider) {
        // TODO Auto-generated method stub
        output.append("\n\nProvider Enabled: " + provider);

    }

    @Override
    public void onStatusChanged(String provider, int status, Bundle extras) {
        // TODO Auto-generated method stub
        output.append("\n\nProvider Status Changed: " + provider + 
                      ", Status= " + S[status]);

    }

    private void printProvider(String provider){
        LocationProvider info = locationManager.getProvider(provider);
        output.append(info.toString() + "\n\n");
    }

    private void printLocation(Location location){
        if(location == null){
            output.append("\nLocation UNKNOWN\n\n");
        }
        else{
            output.append("\n\nLatitude: " + location.getLatitude() + "\nLongitude: " + location.getLongitude());
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:27:32.390

[http://developer.android.com/guide/topics/location/obtaining-user-location.html](http://developer.android.com/guide/topics/location/obtaining-user-location.html)

更具体地说：http: [//developer.android.com/guide/topics/location/obtaining-user-location.html#BestPerformance](http://developer.android.com/guide/topics/location/obtaining-user-location.html#BestPerformance)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T16:54:00.140

在室内，您可以使用 NetworkProvider 获取位置。此方法使用移动信号塔信息和附近 wifi 基站信息的组合来估算您的位置。

它的方法是扫描该区域的 wifi 基站并从附近的蜂窝塔收集移动运营商的蜂窝塔信息。**然后它将所有这些数据发送到服务器并要求服务器估计您的位置。**

如果您无法访问 Internet（即：没有 wifi 连接和移动数据连接），那么您将不会获得任何位置信息。对此你无能为力。这就是它的工作方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T16:54:04.773

您将需要某种输入来检索位置。你的计算必须基于某些东西。根据您的手机硬件，您可以尝试使用蓝牙、NFC 或尝试检测发射器发出的某些频率（必须放置在该位置）。我希望这可以帮助你。

# c# - 从查询中检索单个值

> ID：10820270
> 
> 赞同：9
> 
> 时间：2012-05-30T16:21:14.600
> 
> 标签：c#, sql, sql-server, tsql, ado.net

我正在尝试根据字符串字段用户名从单个表中检索整数值。我已经尝试过使用存储过程和直接文本。当我执行存储过程时，我得到了正确的返回值；然而，正确的结果并没有出现。

这是两组代码 - 直接文本 -

```
public int GetUserRole(string CUSER)
{
    try
    {
        SQLCON = new SqlConnection(connectionString);
        SQLCON.Open();
        SQLCommand = new SqlCommand();
        SQLCommand.CommandType = CommandType.Text;
        SQLCommand.Parameters.Add("USUsername", SqlDbType.VarChar).Value = CUSER;
        SQLCommand.CommandText = "SELECT USRole FROM tblUser WHERE USUsername = CUSER";
        Int32 USRole = (Int32) SQLCommand.ExecuteScalar();

        return USRole;

    }
    catch
    {
        HttpContext.Current.Response.Redirect("~/ErrorRedirect.aspx", false);
        return 0;
    }
} 
```

SQL查询：

```
ALTER PROCEDURE [dbo].[spGetUserRole]
-- Add the parameters for the stored procedure here
    @username VARCHAR(50)
AS
BEGIN
-- Declare the return variable here
DECLARE @USRole as int

-- Add the T-SQL statements to compute the return value here
SELECT @USRole = tblUser.USRole FROM tblUser WHERE USUsername = @username

-- Return the result of the function
RETURN @USRole  
END 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-30T16:32:41.347

您没有正确引用您的参数。如果要添加一个名为 USUsername 的参数，则应在命令文本中使用 @USUsername：

```
public int GetUserRole(string CUSER)
{
    try
    {
        SQLCON = new SqlConnection(connectionString);
        SQLCON.Open();
        SQLCommand = new SqlCommand();
        SQLCommand.CommandType = CommandType.Text;
        SQLCommand.Parameters.Add("USUsername", SqlDbType.VarChar).Value = CUSER;
        SQLCommand.CommandText = "SELECT USRole FROM tblUser WHERE USUsername = @USUsername";
        Int32 USRole = (Int32) SQLCommand.ExecuteScalar();

        return USRole;

    }
    catch (Exception)
    {
        HttpContext.Current.Response.Redirect("~/ErrorRedirect.aspx", false);
        return 0;
    }
} 
```

您的存储过程也需要更新，因为这里的参数名称也应该匹配并且您不需要返回变量。

```
ALTER PROCEDURE [dbo].[spGetUserRole]
-- Add the parameters for the stored procedure here
@USUsername VARCHAR(50)

AS
BEGIN

-- Add the T-SQL statements to compute the return value here
SELECT tblUser.USRole FROM tblUser WHERE USUsername = @USUsername

END 
```

您还应该考虑使用“使用”语法自动关闭数据库连接。在此处查看 Scott Hanselman 的示例 - [http://www.hanselman.com/blog/WhyTheUsingStatementIsBetterThanASharpStickInTheEyeAndASqlConnectionRefactoringExample.aspx](http://www.hanselman.com/blog/WhyTheUsingStatementIsBetterThanASharpStickInTheEyeAndASqlConnectionRefactoringExample.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T16:26:48.827

不使用存储过程的返回值 ( `RETURN @USRole`)，而是使用 Select 语句（例如 ）将结果发回`Select @USRole`。发生的事情是存储过程的返回值与 ExecuteScalar 使用的不同。ExecuteScalar 返回输出的第一列和第一行。返回值不同，必须使用特殊命名`@RETURN_VALUE`的参数或特殊`ParameterDirection.ReturnValue`属性访问。

您的程序的修订版本如下所示：

```
ALTER PROCEDURE [dbo].[spGetUserRole]
-- Add the parameters for the stored procedure here
@USUsername VARCHAR(50)

AS
BEGIN

-- Add the T-SQL statements to compute the return value here
Select tblUser.USRole 
FROM tblUser 
WHERE USUsername = @USUsername

END 
```

[返回（事务处理 SQL）](http://msdn.microsoft.com/en-us/library/ms174998.aspx)

[SqlCommand.ExecuteScalar 方法](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executescalar.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T16:27:49.963

我不知道您是如何调用存储过程的，但是您发布的查询中有一个错误：

```
"SELECT USRole FROM tblUser WHERE USUsername = CUSER" 
```

应该替换为

```
SQLCommand.Parameters.Add("@USUsername", SqlDbType.VarChar).Value = CUSER;
"SELECT USRole FROM tblUser WHERE USUsername = @USUsername" 
```

您目前并没有真正将参数作为查询的一部分，而是试图在列中找到值 CUSER

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-30T16:26:58.123

正确使用参数。并且不要忘记在 finally 语句上关闭连接。

```
 public int GetUserRole(string CUSER)
    {
        try
        {
            SQLCON = new SqlConnection(connectionString);
            SQLCON.Open();
            SQLCommand = new SqlCommand();
            SQLCommand.CommandType = CommandType.Text;
            SQLCommand.CommandText = "SELECT USRole FROM tblUser WHERE USUsername = @USUsername  ";
            SQLCommand.Parameters.Add("USUsername", SqlDbType.VarChar).Value = CUSER;

            Int32 USRole = (Int32) SQLCommand.ExecuteScalar();

            return USRole;

        }
        catch (Exception)
        {
            HttpContext.Current.Response.Redirect("~/ErrorRedirect.aspx", false);
            return 0;
        }
        finally { close connection here.. }

    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-30T16:33:01.460

如果您坚持使用返回值，您可以通过设置参数方向并使用 ExecuteNonQuery 来实现

```
SqlParameter p = cmd.Parameters.Add("@USRole", SqlDbType.Int);
p.Direction = ParameterDirection.ReturnValue;
cmd.ExecuteNonQuery(); 
int returnvalue = (int)cmd.Parameters["@USRole"].Value; 
```

如果你想使用 ExecuteScalar 那么只需将你的 proc 更改`select`为变量而不是`Return`

您应该注意，您为参数名称输入的内容是任意的。

# c# - 正则表达式从名称中提取首字母

> ID：10820273
> 
> 赞同：12
> 
> 时间：2012-05-30T16:21:28.797
> 
> 标签：c#, regex

```
eg. if the Name is: John Deer
the Initials should be: JD 
```

我可以使用子字符串对 Initials 字段执行此检查，但想知道是否可以为其编写正则表达式？编写正则表达式是否比使用字符串方法更好？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2015-02-06T19:36:43.113

这是我的解决方案。我的目标不是提供最简单的解决方案，而是提供一种可以采用各种（有时很奇怪）名称格式的解决方案，并在名字和姓氏首字母（或在单名的情况下）单个首字母的情况下生成最佳猜测。

我还尝试以相对国际友好的方式编写它，使用 unicode 正则表达式，尽管我没有任何为多种外国名称（例如中文）生成首字母的经验，尽管它至少应该生成一些可用的东西代表人，在两个字符之下。例如，用韩语给它取一个名字，如“행운의 복숭아”，会产生 행복，正如你所预料的那样（尽管这在韩国文化中可能不是正确的做法）。

```
/// <summary>
/// Given a person's first and last name, we'll make our best guess to extract up to two initials, hopefully
/// representing their first and last name, skipping any middle initials, Jr/Sr/III suffixes, etc. The letters 
/// will be returned together in ALL CAPS, e.g. "TW". 
/// 
/// The way it parses names for many common styles:
/// 
/// Mason Zhwiti                -> MZ
/// mason lowercase zhwiti      -> MZ
/// Mason G Zhwiti              -> MZ
/// Mason G. Zhwiti             -> MZ
/// John Queue Public           -> JP
/// John Q. Public, Jr.         -> JP
/// John Q Public Jr.           -> JP
/// Thurston Howell III         -> TH
/// Thurston Howell, III        -> TH
/// Malcolm X                   -> MX
/// A Ron                       -> AR
/// A A Ron                     -> AR
/// Madonna                     -> M
/// Chris O'Donnell             -> CO
/// Malcolm McDowell            -> MM
/// Robert "Rocky" Balboa, Sr.  -> RB
/// 1Bobby 2Tables              -> BT
/// Éric Ígor                   -> ÉÍ
/// 행운의 복숭아                 -> 행복
/// 
/// </summary>
/// <param name="name">The full name of a person.</param>
/// <returns>One to two uppercase initials, without punctuation.</returns>
public static string ExtractInitialsFromName(string name)
{
    // first remove all: punctuation, separator chars, control chars, and numbers (unicode style regexes)
    string initials = Regex.Replace(name, @"[\p{P}\p{S}\p{C}\p{N}]+", "");

    // Replacing all possible whitespace/separator characters (unicode style), with a single, regular ascii space.
    initials = Regex.Replace(initials, @"\p{Z}+", " ");

    // Remove all Sr, Jr, I, II, III, IV, V, VI, VII, VIII, IX at the end of names
    initials = Regex.Replace(initials.Trim(), @"\s+(?:[JS]R|I{1,3}|I[VX]|VI{0,3})$", "", RegexOptions.IgnoreCase);

    // Extract up to 2 initials from the remaining cleaned name.
    initials = Regex.Replace(initials, @"^(\p{L})[^\s]*(?:\s+(?:\p{L}+\s+(?=\p{L}))?(?:(\p{L})\p{L}*)?)?$", "$1$2").Trim();

    if (initials.Length > 2)
    {
        // Worst case scenario, everything failed, just grab the first two letters of what we have left.
        initials = initials.Substring(0, 2);
    }

    return initials.ToUpperInvariant();
} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-05-30T17:39:13.393

就个人而言，我更喜欢这个正则表达式

```
Regex initials = new Regex(@"(\b[a-zA-Z])[a-zA-Z]* ?");
string init = initials.Replace(nameString, "$1");
//Init = "JD" 
```

这会处理首字母缩写和空格删除（那是“？”在最后）。

你唯一需要担心的是像 Jr. 或 Sr. 或 Mrs.... 等头衔和名称。有些人确实在他们的全名中包含这些

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2018-12-31T17:44:48.840

这是我的方法：

```
public static string GetInitials(string names) {
    // Extract the first character out of each block of non-whitespace
    // exept name suffixes, e.g. Jr., III. The number of initials is not limited.
    return Regex.Replace(names, @"(?i)(?:^|\s|-)+([^\s-])[^\s-]*(?:(?:\s+)(?:the\s+)?(?:jr|sr|II|2nd|III|3rd|IV|4th)\.?$)?", "$1").ToUpper();
} 
```

**经办案例：**

```
// Mason Zhwiti                               -> MZ
// mason zhwiti                               -> MZ
// Mason G Zhwiti                             -> MGZ
// Mason G. Zhwiti                            -> MGZ
// John Queue Public                          -> JQP
// John-Queue Public                          -> JQP
// John Q. Public, Jr.                        -> JQP
// John Q Public Jr.                          -> JQP
// John Q Public Jr                           -> JQP
// John Q Public Jraroslav                    -> JQPJ
// Thurston Howell III                        -> TH
// Thurston Howell, III                       -> TH
// Thurston Howell the III                    -> TH
// Malcolm X                                  -> MX
// A Ron                                      -> AR
// A A Ron                                    -> AAR
// Madonna                                    -> M
// Chris O'Donnell                            -> CO
// Chris O' Donnell                           -> COD
// Malcolm McDowell                           -> MM
// Éric Ígor                                  -> ÉÍ
// 행운의 복숭아                               -> 행복 
```

**未处理案件：**

```
// James Henry George Michael III the second  -> JHGMIts
// Robert "Rocky" Balboa, Sr.                 -> R"B
// 1Bobby 2Tables                             -> 12 (is it a real name?) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-30T16:25:15.473

这个怎么样？

```
var initials = Regex.Replace( "John Deer", "[^A-Z]", "" ); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-06-06T15:05:22.210

这是一个强调保持简单的替代方案：

```
 /// <summary>
    /// Get initials from the supplied names string.
    /// </summary>
    /// <param name="names">Names separated by whitespace</param>
    /// <param name="separator">Separator between initials (e.g "", "." or ". ")</param>
    /// <returns>Upper case initials (with separators in between)</returns>
    public static string GetInitials(string names, string separator)
    {
        // Extract the first character out of each block of non-whitespace
        Regex extractInitials = new Regex(@"\s*([^\s])[^\s]*\s*");
        return extractInitials.Replace(names, "$1" + separator).ToUpper();
    } 
```

如果提供的名称与预期不符，则存在一个问题。我个人认为它应该只返回每个不是空格的文本块中的第一个字符。例如：

```
1Steve 2Chambers               => 12
harold mcDonald                => HM
David O'Leary                  => DO
David O' Leary                 => DOL
Ronnie "the rocket" O'Sullivan => R"RO 
```

有些人会主张使用更复杂/更复杂的技术（例如更好地处理最后一个），但 IMO 这确实是一个数据清理问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-30T16:25:06.007

试试这个

```
(^| )([^ ])([^ ])*','\2') 
```

或者这个

```
 public static string ToInitials(this string str)
    {
      return Regex.Replace(str, @"^(?'b'\w)\w*,\s*(?'a'\w)\w*$|^(?'a'\w)\w*\s*(?'b'\w)\w*$", "${a}${b}", RegexOptions.Singleline)
    } 
```

[http://www.kewney.com/posts/software-development/using-regular-expressions-to-get-initials-from-a-string-in-c-sharp](http://www.kewney.com/posts/software-development/using-regular-expressions-to-get-initials-from-a-string-in-c-sharp)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-30T16:31:18.907

`[a-z]+[a-z]+\b`这将使您净每个名字的前两个字母...

其中 name = 'Greg Henry' = 'G H' 或 'James Smith' 'JS'

然后你可以在 ' ' 上拆分并在 '' 上加入

这甚至适用于像这样的名字

“詹姆斯亨利乔治迈克尔”=“JHG M”

'詹姆斯亨利乔治迈克尔三世'='JHGM III'

如果你想避免拆分利用`[a-z]+[a-z]+\b ?`

但是像`Jon Michael Jr. The 3rd`will 之类`JMJr.T3`的名字 = 上面的选项可以让你得到 'The'、'the' 和 '3rd' 如果你想要..

如果您真的想花哨，可以使用`(\b[a-zA-Z])[a-zA-Z]* ?`来匹配名称的部分，然后替换为前者。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-30T17:25:10.457

这个怎么样：

```
 string name = "John Clark MacDonald";
        var parts = name.Split(' ');
        string initials = "";

        foreach (var part in parts)
        {
            initials += Regex.Match(part, "[A-Z]");
            Console.WriteLine(part + " --> " + Regex.Match(part,"[A-Z]"));
        }
        Console.WriteLine("Final initials: " + initials);
        Console.ReadKey(); 
```

这允许可选的中间名，并且适用于多种大写，如上所示。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-08-25T16:59:20.567

我的解决方案如下（C# 正则表达式方言）

```
^\s*(?>(?<First>\w)\w*).*?((?<Last>\w)\w*)?\s*$ 
```

将分别匹配命名组`First`和`Last`第一个单词的第一个字母和最后一个单词的第一个后面的字母，很高兴忽略可能介于两者之间的所有单词，并且不关心是否有尾随或前导空格

不需要替换，匹配发生在一行中，您可以提取按名称访问匹配组的字母，如下所示

```
var displayName = "Nick 'Goose' Bradshaw";
var initialsRule = new Regex(@"^\s*(?>(?<First>\w)\w*).*?((?<Last>\w)\w*)?\s*$");
var matches = initialsRule.Match(displayName);
var initials = $"{matches.Groups["First"].Value}{matches.Groups["Last"].Value}";
//initials: "NB" 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-11-10T12:06:19.217

kotlin 中最简单的版本

```
val initials: String = if (str.size > 1) str[0][0].toString() + str[1][0].toString() else str[0][0].toString() 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2012-05-30T16:26:02.947

是的，使用正则表达式。您可以使用 Regex.Match 和 Regex.Match.Groups 方法来查找匹配项，然后提取您需要的匹配值 - 在这种情况下是首字母。查找和提取值将同时发生。

# jquery - 使用 javascript 触发灯箱

> ID：10820277
> 
> 赞同：3
> 
> 时间：2012-05-30T16:21:42.063
> 
> 标签：jquery, lightbox2

我想使用这个库： http: [//lokeshdhakar.com/projects/lightbox2/](http://lokeshdhakar.com/projects/lightbox2/)

我无法附加`rel="lightbox"`到每个图像，所以我想使用 jQuery 来触发灯箱。

我在想类似的事情：

```
$('img').click(function(){
  //triger lightbox for this image
  //use self src as href
}); 
```

如何触发一张图片的灯箱？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T16:56:15.527

通过将标签包装在`img`标签中`a`并在此之后触发点击来解决问题。

```
$('img').click(function () {
    $(this).wrap('<a href="' + $(this).attr("src") + '" rel="lightbox" />');
    $(this).parent('a').trigger('click');
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T16:28:40.883

该插件必须`rel="lightbox"`能够正常工作。这在如何使用中提到

您可以使用 jquery 添加该属性

```
$('img').attr('rel', 'lightbox'); 
```

您需要在文档就绪函数中添加该行。

如果这仍然不适合你，那么我建议你使用这个其他插件

[http://fancyapps.com/fancybox/](http://fancyapps.com/fancybox/)

# iphone - 尝试将特定音频文件发送到 iOS 中的详细视图

> ID：10820278
> 
> 赞同：3
> 
> 时间：2012-05-30T16:21:47.070
> 
> 标签：iphone, ios, avaudioplayer

我对 iOS 编程相当陌生，所以如果这是一个容易解决的问题，请原谅我。

我正在构建具有深入细节的表格视图的音乐参考应用程序。通过表格，当您选择一行时，它会向详细信息发送标签和滚动视图的图片和文本。我正在努力做到这一点，以便在图片顶部有一个自定义按钮，您将能够点击该图片来播放音频示例。

我已经弄清楚如何让按钮播放声音，但我不知道如何选择要播放的音频文件。

这是我发送数组的序列

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
if ([[segue identifier] isEqualToString:@"ShowBasicsDetails"]) {
    BasicsDetailViewController *detailViewController = [segue destinationViewController];

    NSIndexPath *myIndexPath = [self.tableView indexPathForSelectedRow];

    detailViewController.basicsDetailModel = [[NSArray alloc]initWithObjects:
                                              [self.basicsNames objectAtIndex:[myIndexPath row]],
                                              [self.basicsImages objectAtIndex:[myIndexPath row]],
                                              [self.basicsDetails objectAtIndex:[myIndexPath row]],
                                              [self.basicsAudios objectAtIndex:[myIndexPath row]],nil];
} 
```

这是我的详细视图中的 viewDidLoad。

```
- (void)viewDidLoad

[super viewDidLoad];
// Do any additional setup after loading the view.

self.basicsLabel.text = [self.basicsDetailModel objectAtIndex:0];
self.basicsImage.image = [UIImage imageNamed:[self.basicsDetailModel objectAtIndex:1]];
self.basicsDetail.text = [self.basicsDetailModel objectAtIndex:2]; 
```

我正计划使用 AVAudioPlayer 但我能找到的所有内容都会拉入一个特定的音频文件，就像 techotopia 的这个例子一样

```
[super viewDidLoad];
NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle]
        pathForResource:@"Kalimba"
        ofType:@"mp3"]]; 
```

# asp.net - 错误：非静态字段、方法或属性需要对象引用

> ID：10820287
> 
> 赞同：2
> 
> 时间：2012-05-30T16:22:34.180
> 
> 标签：asp.net

当我想在“return (byte)SaleMode.ToPost;”行中使用“SetSaleMode”时，我有一个包含这些字段和这些静态方法的类 发生此错误，有人可以帮助我吗？

这些是我的代码：

```
公共枚举 SaleMode:byte { ToPost = 0, Downloadable = 1, DownloadableAndFreeTrial = 2, SourceSiteSale = 3 };
公共枚举 FilePriceMode { ProductFile = 0, Free = 1, FreeTrial = 2 };公共类 ProductDAL : BaseDAL
{

#region fields
public Int64 ID { get; set; }
public string Name { get; set; }
public Int64 Price { get; set; }
public bool Private { get; set; }
public Int64 ProductType { get; set; }
public string Notes { get; set; }
public string Image { get; set; }
public DateTime Date { get; set; }
public Int64 Owner { get; set; }
public long Counter { get; set; }
public bool Proved { get; set; }
public byte[] Files { get; set; }
public byte SaleMode { get; set; }
public string SourceSiteSaleAddress { get; set; }
public List<FilesOfProductsDAL> FOfPro;

#endregion fields        

#region constructor
public ProductDAL()
{
    ID = -1;
    FOfPro = new List<FilesOfProductsDAL>();
}

public ProductDAL(string saveIconPath)
{
    ID = -1;
    this.Image = saveIconPath;
    FOfPro = new List<FilesOfProductsDAL>();
}
#endregion constructor

#region method

public static long InsertProduct(ProductDAL objProductDAL)
{
    try
    {
        Int64 ID;
        objProductDAL.SaleMode = SetSaleMode(objProductDAL);
        SqlCommand Sqlcomm = new SqlCommand();
        Sqlcomm.CommandText = StoreQueries.InsertProduct;
        Sqlcomm.CommandType = CommandType.StoredProcedure;
        Sqlcomm.Parameters.AddWithValue("@Name", SqlDbType.NVarChar).Value = objProductDAL.Name;
        Sqlcomm.Parameters.AddWithValue("@Price", SqlDbType.BigInt).Value = objProductDAL.Price;
        Sqlcomm.Parameters.AddWithValue("@Private", SqlDbType.Bit).Value = objProductDAL.Private;
        Sqlcomm.Parameters.AddWithValue("@ProductType", SqlDbType.BigInt).Value = objProductDAL.ProductType;
        Sqlcomm.Parameters.AddWithValue("@Notes", SqlDbType.NVarChar).Value = objProductDAL.Notes;
        Sqlcomm.Parameters.AddWithValue("@Date", SqlDbType.DateTime).Value = objProductDAL.Date;
        Sqlcomm.Parameters.AddWithValue("@Image", SqlDbType.NVarChar).Value = objProductDAL.Image;
        Sqlcomm.Parameters.AddWithValue("@Owner", SqlDbType.BigInt).Value = 1019;//objProductDL.Owner ;
        Sqlcomm.Parameters.AddWithValue("@SaleMode", SqlDbType.VarBinary).Value = objProductDAL.SaleMode;
        if (objProductDAL.Files == null)
            Sqlcomm.Parameters.AddWithValue("@Files", SqlDbType.VarBinary).Value =System.Data.SqlTypes.SqlBinary.Null;// DBNull.Value;
        else
            Sqlcomm.Parameters.AddWithValue("@Files", SqlDbType.VarBinary).Value = objProductDAL.Files;
        if (objProductDAL.SourceSiteSaleAddress == null)
            Sqlcomm.Parameters.AddWithValue("@SourceSiteSaleAddress", SqlDbType.NVarChar).Value = DBNull.Value;
        else
            Sqlcomm.Parameters.AddWithValue("@SourceSiteSaleAddress", SqlDbType.NVarChar).Value = objProductDAL.SourceSiteSaleAddress;
        Sqlcomm.Parameters.AddWithValue("@CheangedSet", SqlDbType.NVarChar).Value = "محصول جدید است.";
        Sqlcomm.Parameters.AddWithValue("PID", SqlDbType.BigInt).Value =objProductDAL.ID;

        ID = Convert.ToInt64(ExecuteScalar(Sqlcomm));

        objProductDAL.Image = objProductDAL.Image.Replace(Path.GetFileNameWithoutExtension(objProductDAL.Image), ID.ToString() );

        for (int i = 0; i <objProductDAL.FOfPro.Count; i++)
        { objProductDAL.FOfPro[i].FileUrl = objProductDAL.FOfPro[i].FileUrl.Replace(Path.GetFileNameWithoutExtension(objProductDAL.FOfPro[i].FileUrl), Path.GetFileNameWithoutExtension(objProductDAL.FOfPro[i].FileUrl) + "." + ID.ToString() + "." + i.ToString()); }
        UpdateFileAndImageUrl(Store.SerializeData(objProductDAL.FOfPro), objProductDAL.Image, ID);
        return ID;
    }
    catch (Exception) { throw; }
}
private static byte SetSaleMode(ProductDAL objProductDAL)
{
    if (objProductDAL.SourceSiteSaleAddress == null || objProductDAL.SourceSiteSaleAddress == "")
    {
         if (!ProductTypesDAL.IsDownloadable(objProductDAL.ProductType))
            return (byte)SaleMode.ToPost;
        if (objProductDAL.FOfPro.Exists(priceMode => priceMode.FilePriceMode == (int)FilePriceMode.FreeTrial))
            return (byte)SaleMode.DownloadableAndFreeTrial;
        else
            return (byte)SaleMode.Downloadable;
    }
    else
        return (byte)SaleMode.SourceSiteSale;
} 
```

}

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T16:26:16.837

您有一个名为`SaleMode`enum的属性`SaleMode`。

当您`SaleMode`在类中使用时，您指的是属性，而不是枚举。该属性会在整个范围内隐藏枚举。

我建议您重命名该属性，使其不会与枚举冲突。

# git - 如何在 GIT 中向前移动分支

> ID：10820289
> 
> 赞同：2
> 
> 时间：2012-05-30T16:22:39.363
> 
> 标签：git

我是 Git 新手，我想知道如何推进分支。

我有一个名为 DevInt 的分支，我们将其用于开发人员集成。

我有另一个特性分支，我们称之为 Feature1。

我已将 Feature1 分支中的更改合并到 DevInt 分支中，但是，自 Feature1 分支创建以来，DevInt 还发生了其他更改。

所以现在 Feature1 分支落后了，我想把它向前推进，使它与 DevInt 处于相同的位置。

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:26:31.843

从您的功能分支：

获取

git rebase 起源/DevInt

# http-headers - 接收到标头中内容长度不正确的 POST 时，WebAPI 无限期挂起

> ID：10820292
> 
> 赞同：2
> 
> 时间：2012-05-30T16:22:49.933
> 
> 标签：http-headers, asp.net-web-api

我在 Azure 上使用 ASP.NET WebAPI 设置了一个项目，每当我尝试在标头中的内容长度太长的情况下创建 HTTP Post 时都会遇到问题。

通常我会忽略这个问题，因为您应该在 POST 上正确设置内容长度，但事实证明，当这种情况发生时，它会导致会话无限期挂起，然后 Azure 模拟器崩溃。

我有一个扩展 MediaTypeFormatter 的自定义 JSON 格式化程序，我在 OnReadFromStreamAsync() 实现的第一行设置了一个断点。但是，断点永远不会被命中，因为挂断发生在 JSON 反序列化器之前。

我真的不知道这种挂起是从哪里发生的，因为我没有收到任何异常，只是无限期挂起和偶尔的 Azure 模拟器崩溃。

提前感谢您提供的任何帮助或见解！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T13:31:33.673

这听起来像一个错误。好消息是您可以从 codeplex 获得更新的开发人员位。

您的经历有可能与以下其中一项有关：

*   [WebAPI：虚拟主机下的流上传不起作用](http://aspnetwebstack.codeplex.com/workitem/61)
*   [DevDiv 388456 - 当内容长度已知时，WebHost 不应使用分块传输编码](http://aspnetwebstack.codeplex.com/SourceControl/changeset/changes/06f52b894414#src/System.Web.Http.WebHost/HttpControllerHandler.cs)。
*   [正文中没有内容类型标头的零 ContentLength 正在抛出](http://aspnetwebstack.codeplex.com/SourceControl/changeset/changes/4c8548f5bc81)

如果更新的位不能解决您的问题，我建议您尝试使用标准媒体格式化程序来排除您的格式化程序。失败了，然后提交一个问题。

# objective-c - pushViewController 的 iOS 过渡动画

> ID：10820294
> 
> 赞同：1
> 
> 时间：2012-05-30T16:22:54.703
> 
> 标签：objective-c, ios, uiview

我有一个 AppDelegate，它拥有一个窗口，从那里开始，一个主视图，当我转到下一个视图时，我推送新视图以使用相同的导航控制器和工具栏：

```
- (void)tableView:(UITableView *)tableView accessoryButtonTappedForRowWithIndexPath:(NSIndexPath *)indexPath
{
    self.appview = [[AppointmentView alloc] initWithNibName:@"AppointmentView" bundle:[NSBundle mainBundle]];

    @synchronized(self.MahAppntmnts){                             // Set the view's appointment
        [appview setMyAppointment:[[MahAppntmnts MyAppointments] objectAtIndex:indexPath.section]];
    }
    [super addChildViewController:self.appview];
    AppDelegate *del = (AppDelegate *)[UIApplication sharedApplication].delegate;
    [UIView  beginAnimations:nil context:NULL];
    [UIView setAnimationCurve:UIViewAnimationCurveEaseInOut];
    [UIView setAnimationDuration:0.75];
    [del.navigationController pushViewController:self.appview animated:NO];
    [UIView setAnimationTransition:UIViewAnimationTransitionFlipFromRight forView:self.navigationController.view cache:NO];
    [UIView commitAnimations];
} 
```

现在这可以很好地切换视图，但是当我试图返回时，我会得到同样无聊的翻转过渡。我尝试设置我的 AppView 的 viewWillDissapear 委托方法：

```
-(void) viewWillDisappear:(BOOL)animated 
{
    [UIView  beginAnimations:nil context:NULL];
    [UIView setAnimationCurve:UIViewAnimationCurveEaseInOut];
    [UIView setAnimationDuration:0.75];
    [UIView setAnimationTransition:UIViewAnimationTransitionFlipFromLeft forView:self.navigationController.view cache:NO];
    [UIView commitAnimations];
    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDelay:0.375];
    [self.navigationController popViewControllerAnimated:NO];
    [UIView commitAnimations];
    [super viewWillDisappear:animated];
} 
```

这似乎适用于当我返回上一个视图时，但是当我尝试转换到新视图（使用与以前相同的方法）时，它们要么不出现，要么我翻转到同一个视图。所以我猜测这段代码不应该出现在 viewWillDissapear 上，或者我做错了什么......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T17:19:53.967

好吧，我找到了解决方案，问题是我对动画属于“谁”的误解。我将 viewWillDissapear 中的代码（位于推送的视图中）添加到首先进行推送的视图的 viewWillAppear 委托（在 accessoryButtonTappedForRowWithIndexPath 中找到的代码），以便控制视图在推送另一个视图时启动动画，当另一个视图导航回它时，会显示反向动画。解决了所有问题并像魅力一样工作。

# java - NoClassDefFoundError ，这里忽略了什么？（附图片）

> ID：10820295
> 
> 赞同：2
> 
> 时间：2012-05-30T16:22:57.057
> 
> 标签：java, android, adt, noclassdeffounderror

症状：我正在使用从创建者的 git 存储库中提取的项目。我包含了他们的库，如`libs`文件夹中所示。项目没有错误，项目编译。然而，当它访问一个应该在 jar 中的对象时，它会崩溃。

我已经做了一些我在这里读过的其他建议。我读过一些关于改变的东西`classpath`，那在哪里？

此外，jar 的 src 代码显示有问题的对象实际存在....

`ConfigurationBuilder configurationBuilder = new ConfigurationBuilder();`

```
05-30 11:26:16.878: E/AndroidRuntime(11098): FATAL EXCEPTION: main
05-30 11:26:16.878: E/AndroidRuntime(11098): java.lang.NoClassDefFoundError:      twitter4j.conf.ConfigurationBuilder
05-30 11:26:16.878: E/AndroidRuntime(11098):    at com.pigmal.android.ex.twitter4j.TwitterApp.askOAuth(TwitterApp.java:110)
05-30 11:26:16.878: E/AndroidRuntime(11098):    at com.pigmal.android.ex.twitter4j.TwitterApp.onClick(TwitterApp.java:144)
05-30 11:26:16.878: E/AndroidRuntime(11098):    at android.view.View.performClick(View.java:2482)
05-30 11:26:16.878: E/AndroidRuntime(11098):    at android.view.View$PerformClick.run(View.java:9077)
05-30 11:26:16.878: E/AndroidRuntime(11098):    at android.os.Handler.handleCallback(Handler.java:587)
05-30 11:26:16.878: E/AndroidRuntime(11098):    at a ndroid.os.Handler.dispatchMessage(Handler.java:92)
05-30 11:26:16.878: E/AndroidRuntime(11098):    at android.os.Looper.loop(Looper.java:130)
05-30 11:26:16.878: E/AndroidRuntime(11098):    at android.app.ActivityThread.main(ActivityThread.java:3683)
05-30 11:26:16.878: E/AndroidRuntime(11098):    at java.lang.reflect.Method.invokeNative(Native Method)
05-30 11:26:16.878: E/AndroidRuntime(11098):    at java.lang.reflect.Method.invoke(Method.java:507)
05-30 11:26:16.878: E/AndroidRuntime(11098):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
05-30 11:26:16.878: E/AndroidRuntime(11098):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
05-30 11:26:16.878: E/AndroidRuntime(11098):    at dalvik.system.NativeStart.main(Native Method) 
```

这是我完整的项目设置。这使用 Android 的事实可能与这里无关，我不想通过标记 Android 来疏远 Java 专家

[![](../Images/6a172e44892708c772df460bc7398955.png)](https://i.stack.imgur.com/UFyPV.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T20:09:57.703

这为我解决了[http://android.foxykeep.com/dev/how-to-fix-the-classdefnotfounderror-with-adt-17](http://android.foxykeep.com/dev/how-to-fix-the-classdefnotfounderror-with-adt-17)

```
What I did to fix the bug was :

Remove the libraries from the standard Java build path :
Right click on the project name > Properties > Java Build Path > tab Libraries > remove      everything except the “Android X.X” (2.3.3 in my case) and the “Android Dependencies”
Rename the libraries folder from “lib” to “libs”
By doing that, all the libraries in the folder “libs” are found by the Android plugin and   are added to the “Android Dependencies” item of the project
Restart Eclipse
Android Dependencies should be created. Running the app won't produce NoClassDefFoundError anymore 
```

除了我必须在遵循这些说明后重新启动 ECLIPSE 之外，而不仅仅是事后清理项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T18:55:23.033

试试这个，这对我有用。

1.  转到 Build Path，删除 twitter4j 库，然后执行 Ok。

2.  转到 Build Path，选择 Add External Libraries，然后转到您从 github 下载的项目文件夹，然后转到其 lib 文件夹，您将在那里找到 twitter4j 文件，仅选择 twitter4j-core（但仅和只有当它仍然失败时，也包括 twitter4j-stream，在此之前只保留核心）并做 OK。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T05:30:34.660

我有同样的问题，从构建路径中删除所有 twitter 库并将 lib 文件夹重命名为 libs 为我解决了这个问题

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-12T08:50:52.143

对我来说重命名文件夹，重新启动并没有解决问题。但是，在[先前评论中发布的链接页面中](http://android.foxykeep.com/dev/how-to-fix-the-classdefnotfounderror-with-adt-17)，有一个答案解决了我的问题。这个回应说：

`If you have references to jars that are not in the ‘libs’ folder, for example if you use ‘classpath variable’, you can resolve the NoClassDefFoundError issue with the new ADT 17 by exporting the references. To export the references: simply go to “Properties > Java Build Path > Order and Export”, and check all the references you want exported.`

我必须在 src 文件夹之前移动 twitter jar

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-30T16:29:40.130

我认为你最好也为这个问题标记android。即使因为 ADT 版本，我也看到早期帖子中的人们也有类似的问题。理想情况下，由于您已将代码放在`libs`文件夹中，因此您应该能够获取所有这些类。但这似乎是一些运行时问题，而不是编译时间。

这似乎也特定于android。

* * *

您是否在类路径中手动添加了 jar？通常，当一个 jar 被添加到`libs`文件夹中时，它开始出现在里面`Android Dependencies`而不是直接显示在快照中。

# facebook - 使用 FQL 安排帖子流式传输

> ID：10820296
> 
> 赞同：0
> 
> 时间：2012-05-30T16:22:57.330
> 
> 标签：facebook, facebook-fql

我试图了解如何在没有经过身份验证的用户启动查询的情况下对 FQL 查询进行预定调用。（我猜类似于 cron-job）

我尝试过尝试实施 cron 作业来进行 FQL 查询，但没有取得任何成功。

谁能引导我朝着正确的方向前进？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T21:14:20.840

您有 3 个选项：

1.  当用户进入您的应用程序时，使用[客户端身份验证](http://developers.facebook.com/docs/authentication/client-side/)，获取一个短暂的用户访问令牌，然后使用[新端点](http://developers.facebook.com/roadmap/offline-access-removal/)将其延长60 天。
    在这 60 天内，您可以使用该用户令牌并按照用户授予的权限执行操作。当 60 天结束后，您需要用户重新使用您的应用程序以获取另一个 60 天的新令牌。

2.  使用[服务器端身份验证](http://developers.facebook.com/docs/authentication/server-side/)获取长寿命用户令牌（60 天），然后与 1 中相同。

3.  如果您获得`publish_stream`许可，那么您可以使用不会过期的应用令牌以用户身份发布，如[Authenticating as an App](http://developers.facebook.com/docs/authentication/applications/)中所述：

> 应用程序访问令牌还可用于代表已授予您应用程序发布权限的用户向 Facebook 发布内容。
> 
> 应用程序访问令牌通常不会过期。一旦生成，它们将无限期有效。

您可能无法使用第三个选项，这取决于您想从 api 获取什么数据。
我建议您使用[访问令牌工具](https://developers.facebook.com/tools/access_token/)获取用户和应用令牌，将应用令牌保存在某处，然后使用用户令牌在[资源管理器工具中测试您的查询。](https://developers.facebook.com/tools/explorer)
当用户令牌过期时，尝试与应用令牌相同，看看它是否可以用于您需要的东西。

# python - python和函数参数

> ID：10820305
> 
> 赞同：1
> 
> 时间：2012-05-30T16:23:26.320
> 
> 标签：python, post, get, python-requests

我有通过发布请求进行身份验证的简单代码。服务器每个请求都会生成“javax.faces.ViewState”变量，例如 javax.faces.ViewState=123456784356754

```
import requests
import re

global_headers = { 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64; rv:12.0) Gecko/20100101 Firefox/12.0',
                   'Accept': 'application/xml, text/xml, */*; q=0.01',
                   'Referer': 'http://serrver.com/login/'}

req = requests.Session(headers=global_headers)

def javalue_parser():
        javalue = re.findall(r'name="javax.faces.ViewState" id="javax.faces.ViewState" value="(.*?)"')
        print javalue[0]
        return javalue

my_post_req = req.post('http://server.com/login/',
                 data={'phone': '+11(123)456-78-91', 
                       'loginForm': 'loginForm',
                       'javax.faces.ViewState': "%s" % javalue_parser()
                        }) 
```

我总是有错误

```
Traceback (most recent call last):
  File "rework_sms.py", line 28, in <module>
    'javax.faces.ViewState': "%s" % javalue_parser()
  File "test.py", line 19, in javalue_parser
    javalue = re.findall(r'name="javax.faces.ViewState" id="javax.faces.ViewState" value="(.*?)"')
TypeError: findall() takes at least 2 arguments (1 given) 
```

需要什么论证？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:25:07.833

参考[re.findall的文档](http://docs.python.org/library/re.html#re.findall)

> re.findall(pattern, **string** , flags=0)**以字符串**列表的
> 形式返回 string 中所有不重叠的 pattern 匹配项。**从左到右扫描字符串，并按找到的顺序返回匹配项**。如果模式中存在一个或多个组，则返回组列表；如果模式有多个组，这将是一个元组列表。空匹配包含在结果中，除非它们触及另一个匹配的开始。

# php - 使用 PHP Cronjob 将整个站点和 SQL 数据库复制/备份到远程服务器

> ID：10820308
> 
> 赞同：0
> 
> 时间：2012-05-30T16:23:41.343
> 
> 标签：php, mysql, cron, backup

我正在尝试每晚对我的网站进行完整的文件和 mySQL 备份。

我在想最好的方法是每天晚上运行一个 cronjob，它会登录到远程服务器并复制所有本地文件。

然后，我需要找到一种方法来备份所有 mysql 数据库（目前有三个）并将它们全部上传到远程服务器。

这听起来像是一个巨大的项目，我不知道是否在这里重新发明轮子，或者是否有一些脚本基本上已经做了同样的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T16:26:43.507

您可以使用`mysqldump`命令将数据库备份到文件，然后上传到不同的服务器 [http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html](http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html)

您是否考虑过 MySQL 复制？也许这更适合您的需求，并且您不需要 php 来做到这一点 [http://dev.mysql.com/doc/refman/5.5/en/replication.html](http://dev.mysql.com/doc/refman/5.5/en/replication.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T16:29:57.863

使用 cronjob 运行 bash 脚本

`mysqldump`数据库

`tar -cvf`文件

`wput`全部到您的远程服务器

您还可以设置一个变量，喜欢`now=$(date +"%Y_%m_%d")`在您的文件名中使用

# c# - C / C++ / C#：如何执行“mount -a”

> ID：10820311
> 
> 赞同：4
> 
> 时间：2012-05-30T16:23:54.857
> 
> 标签：c#, c++, c, linux, system-calls

问题：

在 C/C++/C# 中。（我需要它用于 C#，但 C 和 C++ 也可以）。

如何在 Linux 上执行 mount -a。我的意思是以编程方式，**无需**启动类似的过程

```
system("mount -a"); 
```

**编辑：**
注意“-a”。
我的问题实际上不是关于如何挂载 A 挂载点。
这是关于如何在 /etc/fstab 中挂载所有挂载点。
这意味着解析文件，提取挂载点，检查是否已经挂载，并且只有在尚未挂载时才挂载...

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-30T16:26:44.847

通过键入查看手册页[`man 2 mount`](http://linux.die.net/man/2/mount)。它谈到了一个可以避免实际使用 system() 的系统调用：

```
#include <sys/mount.h>
int mount(const char *source, const char *target, const char *filesystemtype,
          unsigned long mountflags, const void *data); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-16T07:26:31.633

@Ignacio Vazquez-Abrams：关于您的“无法在 C# 中执行此操作”...

**通过矛盾证明你错了：**

下面的代码能够做同样的事情

```
(apt-get install jfsutils)
dd if=/dev/zero of=jfs.dsk bs=1048576 count=150
mkfs.jfs -O jfs.dsk
mkdir -p /mnt/jfs
mount /volumes/jfs.dsk /mnt/jfs -t jfs -o loop
umount /mnt/jfs/ 
```

代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace Syscalls
{

    public class Linux
    {

        // apt-get source util-linux
        // ./mount/loop.h
        // ./mount/mount.c
        // ./mount/lomount.c
        // ./include/linux_version.h
        // ./lib/linux_version.c
        // ./include/linux_reboot.h

        protected const int LOOP_SET_FD = 0x4C00;
        protected const int LOOP_CLR_FD = 0x4C01;

        protected const int LOOP_GET_STATUS = 0x4C03;
        protected const int LOOP_SET_STATUS = 0x4C02;

        protected const int LOOP_GET_STATUS64 = 0x4C05;
        protected const int LOOP_SET_STATUS64 = 0x4C04;

        protected const int LO_NAME_SIZE = 64;
        protected const int LO_KEY_SIZE = 32;

        protected const int PATH_MAX = 4096;

        // MS_RELATIME  //(default for Linux >= 2.6.30) 
        // MS_STRICTATIME //(default for Linux < 2.6.30) 

        // http://harmattan-dev.nokia.com/docs/library/html/manpages/headers/sys/mount.html
        public enum MountFlags : ulong
        {
            MS_RDONLY = 1,         // Mount read-only.
            MS_NOSUID = 2,         // Ignore suid and sgid bits.
            MS_NODEV = 4,         // Disallow access to device special files.
            MS_NOEXEC = 8,         // Disallow program execution.
            MS_SYNCHRONOUS = 16,    // Writes are synced at once.
            MS_REMOUNT = 32,    // Alter flags of a mounted FS.
            MS_MANDLOCK = 64,    // Allow mandatory locks on an FS.
            S_WRITE = 128,   // Write on file/directory/symlink.
            S_APPEND = 256,   // Append-only file.
            S_IMMUTABLE = 512,   // Immutable file.
            MS_NOATIME = 1024,  // Do not update access times.
            MS_NODIRATIME = 2048,  // Do not update directory access times.
            MS_BIND = 4096,  // Bind directory at different place.
        }; // End Enum MountFlags : ulong

        /*
        // http://unix.superglobalmegacorp.com/Net2/newsrc/sys/fcntl.h.html
        [Flags]
        protected enum OpenFlags : int
        {
            // open-only flags 
            O_RDONLY = 0x0000,      // open for reading only 
            O_WRONLY = 0x0001,      // open for writing only 
            O_RDWR = 0x0002,        // open for reading and writing 
            O_ACCMODE = 0x0003,     // mask for above modes 

            //#ifdef KERNEL
            FREAD = 0x0001,
            FWRITE = 0x0002,
            //#endif
            O_NONBLOCK = 0x0004,    // no delay 
            O_APPEND = 0x0008,      // set append mode 
            //#ifndef _POSIX_SOURCE
            O_SHLOCK = 0x0010,      // open with shared file lock 
            O_EXLOCK = 0x0020,      // open with exclusive file lock 
            O_ASYNC = 0x0040,       // signal pgrp when data ready 
            O_FSYNC = 0x0080,       // synchronous writes 
            //#endif
            O_CREAT = 0x0200,       // create if nonexistant 
            O_TRUNC = 0x0400,       // truncate to zero length 
            O_EXCL = 0x0800,        // error if already exists 
            //#ifdef KERNEL
            FMARK = 0x1000,         // mark during gc() 
            FDEFER = 0x2000,        // defer for next gc pass 
            FHASLOCK = 0x4000       // descriptor holds advisory lock 
        } // End Enum OpenFlags : int
        */

        [System.Runtime.InteropServices.StructLayout(System.Runtime.InteropServices.LayoutKind.Sequential)]
        protected struct loop_info
        {
            public int lo_number;
            public System.UIntPtr lo_device; //my_dev_t lo_device; // my_dev_t: long unsigned int
            public System.UIntPtr lo_inode; //unsigned long lo_inode;
            public System.UIntPtr lo_rdevice; //my_dev_t    lo_rdevice;// my_dev_t: long unsigned int
            public int lo_offset;
            public int lo_encrypt_type;
            public int lo_encrypt_key_size;
            public int lo_flags;

            [System.Runtime.InteropServices.MarshalAs(System.Runtime.InteropServices.UnmanagedType.ByValTStr, SizeConst = LO_NAME_SIZE)]
            public string lo_name; //char       lo_name[LO_NAME_SIZE];

            [System.Runtime.InteropServices.MarshalAs(System.Runtime.InteropServices.UnmanagedType.ByValTStr, SizeConst = LO_KEY_SIZE)]
            public string lo_encrypt_key; //unsigned char   lo_encrypt_key[LO_KEY_SIZE];

            [System.Runtime.InteropServices.MarshalAs(System.Runtime.InteropServices.UnmanagedType.ByValArray, SizeConst = 2)]
            public System.UIntPtr[] lo_init; //unsigned long    lo_init[2];

            [System.Runtime.InteropServices.MarshalAs(System.Runtime.InteropServices.UnmanagedType.ByValTStr, SizeConst = 4)]
            public string reserved; //char      reserved[4];
        }; // End Struct loop_info

        protected struct loop_info64
        {
            public System.UInt64 lo_device;
            public System.UInt64 lo_inode;
            public System.UInt64 lo_rdevice;
            public System.UInt64 lo_offset;
            public System.UInt64 lo_sizelimit; /* bytes, 0 == max available */
            public System.UInt32 lo_number;
            public System.UInt32 lo_encrypt_type;
            public System.UInt32 lo_encrypt_key_size;
            public System.UInt32 lo_flags;

            // http://stackoverflow.com/questions/1725855/uint8-t-vs-unsigned-char

            [System.Runtime.InteropServices.MarshalAs(System.Runtime.InteropServices.UnmanagedType.ByValTStr, SizeConst = LO_NAME_SIZE)]
            public string lo_file_name; // uint8_t      lo_file_name[LO_NAME_SIZE];

            [System.Runtime.InteropServices.MarshalAs(System.Runtime.InteropServices.UnmanagedType.ByValTStr, SizeConst = LO_NAME_SIZE)]
            public string lo_crypt_name; // uint8_t     lo_crypt_name[LO_NAME_SIZE];

            [System.Runtime.InteropServices.MarshalAs(System.Runtime.InteropServices.UnmanagedType.ByValTStr, SizeConst = LO_KEY_SIZE)]
            public string lo_encrypt_key; // uint8_t        lo_encrypt_key[LO_KEY_SIZE];

            [System.Runtime.InteropServices.MarshalAs(System.Runtime.InteropServices.UnmanagedType.ByValArray, SizeConst = 2)]
            public System.UInt64[] lo_init;
        }; // End Struct loop_info64

        // http://www.student.cs.uwaterloo.ca/~cs350/common/os161-src-html/kern_2include_2kern_2stat_8h.html
        protected static bool S_ISBLK(int mode)
        {
            const uint S_IFMT = 070000;
            const uint S_IFBLK = 050000;
            return (((mode) & S_IFMT) == S_IFBLK);
        } // End Function S_ISBLK

        public static int KERNEL_VERSION()
        {
            Mono.Unix.Native.Utsname unameres = new Mono.Unix.Native.Utsname();
            Mono.Unix.Native.Syscall.uname(out unameres);

            System.Text.RegularExpressions.Match ma = System.Text.RegularExpressions.Regex.Match(unameres.release, @"(\d+).(\d+).(\d+)(-)?(\d+)?");
            string strMajor = ma.Groups[1].Value;
            string strMinor = ma.Groups[2].Value;
            string strTiny = ma.Groups[3].Value;
            string strPatchlevel = ma.Groups[5].Value;

            int a = System.Convert.ToInt32(strMajor);
            int b = System.Convert.ToInt32(strMinor);
            int c = System.Convert.ToInt32(strTiny);

            return KERNEL_VERSION(a, b, c);
        } // End Function KERNEL_VERSION

        //# define KERNEL_VERSION(a,b,c) (((a) << 16) + ((b) << 8) + (c))
        public static int KERNEL_VERSION(int a, int b, int c)
        {
            return (((a) << 16) + ((b) << 8) + (c));
        }

        public static string CreateVirtualDisk(int iSize)
        {
            string strBaseDirectory = @"/volumes/";
            string strFileName = System.Guid.NewGuid().ToString().Replace("-", "") + ".dsk";

            string strFileNameAndPath = System.IO.Path.Combine(strBaseDirectory, strFileName);

            using (var fs = new System.IO.FileStream(strFileNameAndPath, System.IO.FileMode.Create, System.IO.FileAccess.Write, System.IO.FileShare.None))
            {
                fs.SetLength(iSize);
            } // End Using fs

            return strFileNameAndPath;
        } // End Function CreateVirtualDisk

        // umount("/mnt/testdisk");
        public static bool umount(string strMountPoint)
        {
            int status = UnsafeNativeMethods.umount(strMountPoint);

            if (status == 0)
                Console.WriteLine("Successfully unmounted device.");
            else
                Console.WriteLine("Unmount status: " + status.ToString());

            if (status == 0)
                return true;

            return false;
        } // End Function Unmount

        public static string find_unused_loop_device()
        {
            string dev;
            int fd;
            Mono.Unix.Native.Stat statbuf;
            loop_info loopinfo = new loop_info();
            loop_info64 lo64 = new loop_info64();

            for (int i = 0; i <= 7; i++)
            {
                dev = "/dev/loop" + i.ToString();

                if (System.Convert.ToBoolean(Mono.Unix.Native.Syscall.stat(dev, out statbuf)) == (false && S_ISBLK((int)statbuf.st_mode)))
                {

                    if ((fd = Mono.Unix.Native.Syscall.open(dev, Mono.Unix.Native.OpenFlags.O_RDONLY)) >= 0)
                    {

                        // This block was commented out initially
                        if (UnsafeNativeMethods.ioctl(fd, LOOP_GET_STATUS64, ref lo64) == 0)
                        {
                            if (Mono.Unix.Native.Syscall.GetLastError() == Mono.Unix.Native.Errno.ENXIO)
                            {   // probably free
                                Mono.Unix.Native.Syscall.close(fd);
                                return dev;
                            }
                        }

                        if (UnsafeNativeMethods.ioctl(fd, LOOP_GET_STATUS, ref loopinfo) != 0)
                        {
                            // http://tomoyo.sourceforge.jp/cgi-bin/lxr/source/include/asm-generic/errno-base.h#L9
                            // ENXIO - No such device or address
                            // The device accessed by a command is physically not present, 
                            // or the address of the device is not present
                            if (Mono.Unix.Native.Syscall.GetLastError() == Mono.Unix.Native.Errno.ENXIO)
                            {
                                // that means the device is most-likely free
                                Mono.Unix.Native.Syscall.close(fd);
                                return dev;
                            }

                        } // End if (UnsafeNativeMethods.ioctl(fd, LOOP_GET_STATUS, ref loopinfo) != 0)

                        Mono.Unix.Native.Syscall.close(fd);
                    } // End if ((fd = UnsafeNativeMethods.open(dev, OpenFlags.O_RDONLY)) >= 0)

                } // End if (System.Convert.ToBoolean(Mono.Unix.Native.Syscall.stat(dev, out statbuf)) == (false && S_ISBLK((int)statbuf.st_mode)))

            } // Next i

            return null;
        } // End Function find_unused_loop_device

        public static int set_loop(string device, string file, int offset, ref int loopro)
        {
            loop_info loopinfo = new loop_info();
            int fd = 0, ffd = 0;
            Mono.Unix.Native.OpenFlags mode;

            mode = loopro != 0 ? Mono.Unix.Native.OpenFlags.O_RDONLY : Mono.Unix.Native.OpenFlags.O_RDWR;

            if (
                    (
                        ffd = Mono.Unix.Native.Syscall.open(file, mode)
                    ) < 0
                    &&
                    (
                        (!System.Convert.ToBoolean((int)loopro))
                        &&
                        (

                            Mono.Unix.Native.Syscall.GetLastError() != Mono.Unix.Native.Errno.EROFS
                            ||
                            (ffd = Mono.Unix.Native.Syscall.open(file, mode = Mono.Unix.Native.OpenFlags.O_RDONLY))
                            < 0
                        )
                    )
                ) // if
            {
                Console.WriteLine("Error: file: " + file);
                //perror_msg("%s", file);
                return 1;
            } // End if

            if ((fd = Mono.Unix.Native.Syscall.open(device, mode)) < 0)
            {
                Mono.Unix.Native.Syscall.close(ffd);
                Console.WriteLine("Error: device: " + device);
                //perror_msg("%s", device);
                return 1;
            }

            loopro = System.Convert.ToInt32(mode == Mono.Unix.Native.OpenFlags.O_RDONLY);
            //memset(&loopinfo, 0, sizeof(loopinfo));

            //safe_strncpy(loopinfo.lo_name, file, LO_NAME_SIZE);
            //strncpy(loopinfo.lo_name, file, LO_NAME_SIZE);
            loopinfo.lo_name = string.IsNullOrEmpty(file) ? null : file.Substring(0, Math.Min(file.Length, LO_NAME_SIZE));

            loopinfo.lo_offset = offset;
            loopinfo.lo_encrypt_key_size = 0;

            if (UnsafeNativeMethods.ioctl(fd, LOOP_SET_FD, ffd) < 0)
            {
                Console.WriteLine("ioctl: LOOP_SET_FD");
                //perror_msg("ioctl: LOOP_SET_FD");
                Mono.Unix.Native.Syscall.close(fd);
                Mono.Unix.Native.Syscall.close(ffd);
                return 1;
            }

            if (UnsafeNativeMethods.ioctl(fd, LOOP_SET_STATUS, ref loopinfo) < 0)
            {
                int ro = 0;
                UnsafeNativeMethods.ioctl(fd, LOOP_CLR_FD, ref ro);
                //perror_msg("ioctl: LOOP_SET_STATUS");
                Console.WriteLine("ioctl: LOOP_SET_STATUS");
                Mono.Unix.Native.Syscall.close(fd);
                Mono.Unix.Native.Syscall.close(ffd);
                return 1;
            }

            Mono.Unix.Native.Syscall.close(fd);
            Mono.Unix.Native.Syscall.close(ffd);
            return 0;
        } // End Function set_loop

        public static int del_loop(string device)
        {
            int fd;

            if ((fd = Mono.Unix.Native.Syscall.open(device, Mono.Unix.Native.OpenFlags.O_RDONLY)) < 0)
            {
                //perror_msg("%s", device);
                Console.WriteLine("Error description: " + Mono.Unix.Native.Syscall.strerror(Mono.Unix.Native.Syscall.GetLastError()));
                return 0;
            }

            int r = 0;

            if (UnsafeNativeMethods.ioctl(fd, LOOP_CLR_FD, ref r) < 0)
            {
                //perror_msg("ioctl: LOOP_CLR_FD");
                Console.WriteLine("ioctl: LOOP_CLR_FD\nError description: " + Mono.Unix.Native.Syscall.strerror(Mono.Unix.Native.Syscall.GetLastError()));
                return 0;
            }

            Mono.Unix.Native.Syscall.close(fd);
            Console.WriteLine("Successfully closed loop-device\n");
            return 1;
        } // End Function del_loop

        public static bool mount(string strDevice, string strMountPoint, string strFsType)
        {
            return mount(strDevice, strMountPoint, strFsType, MountFlags.MS_NOATIME);
        }

        public static bool mount(string strDevice, string strMountPoint, string strFsType, MountFlags mflags)
        {
            return mount(strDevice, strMountPoint, strFsType, mflags, IntPtr.Zero);
        }

        // http://cboard.cprogramming.com/c-programming/126630-using-sys-mount-h-mounting-usb-thumb-drive.html
        // http://stackoverflow.com/questions/10458549/mount-usb-drive-in-linux-with-c
        // mount("/dev/loop1", "/mnt/testdisk", "vfat");
        public static bool mount(string strDevice, string strMountPoint, string strFsType, MountFlags mflags, IntPtr options)
        {

            // http://linux.die.net/man/2/mount
            // MS_RDONLY
            // MS_RELATIME (default for Linux >= 2.6.30) 
            // MS_STRICTATIME (default for Linux < 2.6.30) 

            if (UnsafeNativeMethods.mount(strDevice, strMountPoint, strFsType, mflags, options) != 0)
            {
                Mono.Unix.Native.Errno errno = Mono.Unix.Native.Syscall.GetLastError();

                if (errno == Mono.Unix.Native.Errno.EBUSY)
                {
                    Console.WriteLine("Mountpoint busy");
                }
                else
                {
                    Console.WriteLine("Mount error: " + Mono.Unix.Native.Syscall.strerror(errno));
                }

                return false;
            }
            else
            {
                Console.WriteLine("Successfully mounted device !");
            }

            return true; ;
        } // End Function mount

        static class UnsafeNativeMethods
        {

            //string name = "Test";
            //TypedReference tf = __makeref(name);
            //int c = VarSum(2, __arglist(__makeref(name)));

            // http://khason.net/blog/how-to-pinvoke-varargs-variable-arguments-in-c-or-hidden-junk-in-clr/
            // //int rv = ioctl(2, 3, __arglist(5, 10));
            [System.Runtime.InteropServices.DllImportAttribute("libc", EntryPoint = "ioctl",
            CallingConvention = System.Runtime.InteropServices.CallingConvention.Cdecl)]
            public static extern int ioctl(int descriptor, int request, __arglist);

            [System.Runtime.InteropServices.DllImport("libc", SetLastError = true)]
            public static extern int ioctl(int d, int request, int data);

            [System.Runtime.InteropServices.DllImport("libc", SetLastError = true)]
            public static extern int ioctl(int d, int request, ref int data);

            [System.Runtime.InteropServices.DllImport("libc", SetLastError = true)]
            public static extern int ioctl(int d, int request, ref loop_info data);

            [System.Runtime.InteropServices.DllImport("libc", SetLastError = true)]
            public static extern int ioctl(int d, int request, ref loop_info64 data);

            //[System.Runtime.InteropServices.DllImport("libc", SetLastError = true)]
            //public static extern int open([System.Runtime.InteropServices.MarshalAs(System.Runtime.InteropServices.UnmanagedType.LPStr)]string pathname, OpenFlags flags);

            //[System.Runtime.InteropServices.DllImport("libc", SetLastError = true)]
            //public static extern int close(int fd);

            //[System.Runtime.InteropServices.DllImport("libc", SetLastError = true)]
            //public static extern IntPtr read(int fd, IntPtr buffer, UIntPtr count);
            ///////unsafe public static extern IntPtr read(int fd, void* buffer, UIntPtr count);

            // http://linux.die.net/man/2/mount
            // http://www.kernel.org/doc/man-pages/online/pages/man2/mount.2.html
            [System.Runtime.InteropServices.DllImport("libc", SetLastError = true)]
            private static extern int mount(string source, string target, string filesystemtype, UIntPtr mountflags, System.IntPtr data);
            //int mount(const char *source, const char *target, const char *filesystemtype, ulong mountflags, const void *data);

            public static int mount(string source, string target, string filesystemtype, MountFlags mountflags, System.IntPtr data)
            {
                System.UIntPtr p = new System.UIntPtr((ulong)mountflags);
                return mount(source, target, filesystemtype, p, data);
            } // End Function mount

            [System.Runtime.InteropServices.DllImport("libc", SetLastError = true)]
            public static extern int umount(string strMountPoint);
            // extern int umount (__const char *__special_file);
        } // End Class UnsafeNativeMethods

        public static void TryMount()
        {
            const bool SUCCESS = true;

            // int iReturnCode = Mono.Unix.Native.Syscall.system("mount -a");
            // int iReturnCode = Mono.Unix.Native.Syscall.system("mount /volumes/jfs.dsk /mnt/jfs -t jfs -o loop");
            // int iReturnCode = Mono.Unix.Native.Syscall.system("mkfs.jfs -O \"jfs.dsk\"");

            string strLoopDeviceToUse = find_unused_loop_device();
            string strMountPoint = "/mnt/testdisk";

            int ro = 0;
            set_loop(strLoopDeviceToUse, "/volumes/testdisk.dsk", 0, ref ro);

            string strLoopDeviceToUse2 = find_unused_loop_device();

            bool status = false;
            int mountAttempts = 0;
            do
            {
                //status = mount("/dev/sda1", "/media/usb0", "vfat", MS_MGC_VAL | MS_NOSUID, "");
                status = mount(strLoopDeviceToUse, strMountPoint, "vfat", MountFlags.MS_NOATIME);

                if (status != SUCCESS)
                    System.Threading.Thread.Sleep(1000);

                mountAttempts++;
            } while (status != SUCCESS && mountAttempts < 3);

        } // End Sub TryMount

        // In gcc or g++, to show all of the macros that are defined for a given platform:
        // gcc -dM -E test.c
        // or 
        // g++ -dM -E test.cpp

        // http://manual.cream.org/index.cgi/gnu_dev_major.3
        // http://www.gnu.org/software/gnulib/coverage/usr/include/sys/sysmacros.h.gcov.frameset.html
        // http://en.wikipedia.org/wiki/C_data_types
        protected static uint gnu_dev_major(System.UInt64 __dev)
        {
            return (uint)((uint)(((__dev >> 8) & 0xfff)) | ((uint)(__dev >> 32) & ~0xfff));
        }

        protected static uint gnu_dev_minor(System.UInt64 __dev)
        {
            return (uint)((uint)(__dev & 0xff) | ((uint)(__dev >> 12) & ~0xff));
        }

        public static string loopfile_from_sysfs(string device)
        {
            string res = null;
            Mono.Unix.Native.Stat st;
            System.IntPtr f;

            //if (stat(device, &st) || !S_ISBLK(st.st_mode))
            //if (System.Convert.ToBoolean(Mono.Unix.Native.Syscall.stat(device, out st)) || !S_ISBLK((int) st.st_mode))
            //  return null;

            Mono.Unix.Native.Syscall.stat(device, out st);

            const string _PATH_SYS_DEVBLOCK = "/sys/dev/block";
            string strPath = string.Format("{0}/{1}:{2}/loop/backing_file", _PATH_SYS_DEVBLOCK, gnu_dev_major(st.st_rdev), gnu_dev_minor(st.st_rdev));

            f = Mono.Unix.Native.Syscall.fopen(strPath, "r");
            if (f == IntPtr.Zero)
                return null;

            Mono.Unix.Native.Syscall.fclose(f);

            res = System.IO.File.ReadAllText(strPath);
            strPath = null;
            return res;
        } // End Function loopfile_from_sysfs

        public static string loopdev_get_loopfile(string device)
        {
            string res = loopfile_from_sysfs(device);

            if (res == null)
            {
                loop_info lo = new loop_info();
                loop_info64 lo64 = new loop_info64();

                int fd;

                if ((fd = Mono.Unix.Native.Syscall.open(device, Mono.Unix.Native.OpenFlags.O_RDONLY)) < 0)
                    return null;

                if (UnsafeNativeMethods.ioctl(fd, LOOP_GET_STATUS64, ref lo64) == 0)
                {
                    //lo64.lo_file_name[LO_NAME_SIZE-2] = '*';
                    //lo64.lo_file_name[LO_NAME_SIZE-1] = 0;
                    //res = strdup((char *) lo64.lo_file_name);
                    res = lo64.lo_file_name;
                    Console.WriteLine("LOOP_GET_STATUS64");

                }
                else if (UnsafeNativeMethods.ioctl(fd, LOOP_GET_STATUS, ref lo) == 0)
                {
                    //lo.lo_name[LO_NAME_SIZE-2] = '*';
                    //lo.lo_name[LO_NAME_SIZE-1] = 0;
                    //res = strdup((char *) lo.lo_name);
                    res = lo.lo_name;
                    Console.WriteLine("LOOP_GET_STATUS");
                }

                Mono.Unix.Native.Syscall.close(fd);
            } // End if (res == null)

            return res;
        } // End Function loopdev_get_loopfile

        public static void TryUnmount()
        {
            /*
            string strMountPoint = "/mnt/testdisk";

            umount(strMountPoint);
            System.Threading.Thread.Sleep(1000);
            del_loop("/dev/loop2");
            */
            string xxx = loopdev_get_loopfile("/dev/loop0");
            Console.WriteLine("xxx: " + xxx);
        }

        // kernel-support:
        // grep hfs /proc/filesystems
        // cat /proc/partitions

        // apt-get install hfsprogs
        // sudo modprobe hfsplus
        // dd if=/dev/zero of=hfsplus.dsk bs=1048576 count=150
        // mkfs.hfsplus /volumes/hfsplus.dsk
        // mkfs.hfsplus hfsplus.dsk

        // apt-get install jfsutils
        // dd if=/dev/zero of=jfs.dsk bs=1048576 count=150
        // mkfs.jfs -O jfs.dsk
        // mkdir -p /mnt/jfs
        // mount /volumes/jfs.dsk /mnt/jfs -t jfs -o loop
        // umount /mnt/jfs/

        // mkdir -p /mnt/hfsplus

        // mount -t hfsplus /volumes/hfsplus.dsk /mnt/hfsplus/ -o loop

        //  
    } // End Class Linux

} // End Namespace Syscalls

// http://ubuntuforums.org/showthread.php?t=135113
// http://stackoverflow.com/questions/7027151/call-expect-script-in-c-process
// http://linux.die.net/man/1/expect
// http://linux.die.net/man/3/libexpect

// http://linuxcommand.org/man_pages/losetup8.html
// losetup /dev/loop0 /file
// losetup -d /dev/loop0

// http://linux.about.com/library/cmd/blcmdl8_losetup.htm 
```

要在 fstab 中永久挂载它，您需要获取分区 uuid (blkid)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-30T16:32:33.187

[`getmntent`](http://linux.die.net/man/3/getmntent)可以帮助您阅读`/etc/fstab`（然后在其他答案中使用 mount 功能）。

# java - @OneToOne 替换实体

> ID：10820312
> 
> 赞同：0
> 
> 时间：2012-05-30T16:24:01.360
> 
> 标签：java, hibernate, one-to-one

我有`@OneToOne`双向关系，其中父（`P`）类具有：

```
@OneToOne(optional = true, mappedBy = "owner", orphanRemoval = true)
@Cascade({org.hibernate.annotations.CascadeType.ALL}) 
```

在 getter 上，子类 ( `C`) 在 getter 上有：

```
@ForeignKey(name = "fk_reference_owner")
@MapsId("owner")
@ManyToOne(fetch = FetchType.LAZY)
@PrimaryKeyJoinColumns({
        @PrimaryKeyJoinColumn(name = "owner_oid", referencedColumnName = "oid"),
        @PrimaryKeyJoinColumn(name = "owner_id", referencedColumnName = "id")
}) 
```

缩写：

`P(<it's primary key>)`

`C(<it's primary key, and it's also FK to P>, <another PK>)`

情况如下所示：

我拥有`P(1)`并`C(1, a)`保存在数据库中 - 并且`C(1, a)`归`P(1)`. `P(1)`现在在代码的某个地方，我创建了和的分离实例`C(1, a)`。当我打电话时`session.merge(p)`，所有属性都被合并并在`session.commit()`它们更新后。但是，当我将`C(1, a)` 分离的对象更改为例如`C(1, b)`then时`C(1, a)`不会被删除，只会`C(1, b)`被持久化。我知道这是因为它`C(1, b)`在数据库中不存在并且休眠没有得到明确的删除指令`C(1, a)`- 但它应该是自动的，因为`@OneToOne`. 后来因为`@OneToOne`关系破裂而失败。我知道设置了一种可能的解决方案`P.setC(null)`在附着的物体上。但在我的情况下这是不可能的。在合并时，我已经“更新”了分离对象`P`。

在使用自定义 tuplizer 或类似的东西合并期间，我可以在某处将 child 设置为 null 吗？

你有什么想法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T17:37:35.763

当您在 P(1) 中拥有的 C(1, a) 的实例不是您创建的实例，而是来自持久上下文的新实例时，您究竟为什么要更改分离的对象。也许您想将您对 C(1, a) 的引用更新为新的、持久的引用，并对其进行更改？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T16:56:04.270

您有一个双向关联，但一方将其声明为 a `OneToOne`，而另一方（拥有方）将其声明为 a `ManyToOne`。

如果是OneToOne，应该两边都是OneToOne。如果是 OneTomany，则一侧应该是 OneToMany，另一侧应该是 ManyToOne。

# javascript - MVC 剃刀和 Javascript

> ID：10820316
> 
> 赞同：0
> 
> 时间：2012-05-30T16:24:28.423
> 
> 标签：javascript, asp.net-mvc, asp.net-mvc-3, razor, concatenation

我在这里面临着带有剃须刀的 MVC 3 的挑战。

所以情况很简单。

控制器

```
 public ActionResult TreeView()
    { return PartialView(Context.LEFT_NAVIGATION_T.ToList()); } 
```

上下文返回实体列表...

现在我想做的是：

在视图中，我有以下 javascript：

```
<script type="text/javascript">

function OnTreeViewNodeClick(s, e)
{
var tn= e.node.name;
//test
alert('@Model.Find(x => x.ID == ???).TITLE'); 

} 
```

好的，所以**onTreeViewNodeClick**是分配给 Treeview 的事件。

我想要做的是替换**???** **在带有var tn**的剃刀表达式上。

这可能吗 ？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:28:43.413

您不能以这种方式混合这种解析。您要么需要将模型解析为一组可行的 javascript 对象以进行搜索，要么使用 AJAX 来执行这种查找。如果您正在处理小数据子集，我的偏好是创建一个自定义类并将您的模型集合作为该类中的序列化对象的集合包含在内。如果数据很大，使用 AJAX 检索单个 json 对象会更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T16:28:07.453

您要么必须拥有 Json/array 中的 Tree，要么执行 ajax 调用来获取数据。

# nhibernate - nHibernate - 使用私人收藏获取

> ID：10820317
> 
> 赞同：0
> 
> 时间：2012-05-30T16:24:36.663
> 
> 标签：nhibernate, nhibernate-mapping, linq-to-nhibernate

有没有办法将 Fetch 与私有集合一起使用？

这就是我的代码：

```
public class Owner
{
    private ICollection<Cat> _cats = new List<Cat>();

    public virtual int Id { get; set; }

    public virtual IEnumerable<Cat> Cats { get { return _cats; } }

    public virtual void AddCat(Cat cat) { ... }
}

public class Cat
{
    public virtual int Id { get; set; } 

    public virtual string Name { get; set; }

    public virtual Owner Owner { get; set; }
} 
```

大多数时候，我想延迟加载 Cats 集合，但有时我不想。我想在 Linq 查询中使用 Fetch 来急切加载它。我目前收到“无法解析属性：Cats ...”异常。我假设我得到了这个，因为我的 ClassMapping 中有一个 Set("_cats", ...)，它正在寻找要映射的属性 Cats。有没有办法让 Fetch 与 Cats 的私人收藏一起工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T03:06:43.077

您需要`nosetter`在属性映射中指定访问策略。

详细查看这个答案：[Domain Model with Nhibernate design issue](https://stackoverflow.com/questions/10821273/domain-model-with-nhibernate-design-issue/10826312#10826312)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T17:23:53.727

NHibernate 从您的对象生成代理，当它们从数据库加载时，因此您要映射的属性必须是虚拟的。您应该将您的私人猫收藏设为虚拟保护，然后重试。我只使用受保护的 setter 和公共 getter 映射属性，但此解决方案也可能适用于完全受保护的属性。

# c++ - XCode - 修复后编译错误仍然突出显示

> ID：10820318
> 
> 赞同：0
> 
> 时间：2012-05-30T16:24:40.403
> 
> 标签：c++, xcode, xcode3.2

我第一次编译文件时运行 XCode 3.2.6，它在代码中添加了漂亮的错误注释（类似于 eclipse）。当我进行更改以修复错误并重新编译时，注释仍然存在，这让事情变得非常烦人。

我找不到任何关于此的信息（也许不知道正确的搜索词），但想知道这是否是一个已知的错误，或者我是否误用了该工具？我正在使用 command+K 编译当前打开的 .cpp 文件。

# java - Spring Framework中的TransactionScope类等效？

> ID：10820321
> 
> 赞同：0
> 
> 时间：2012-05-30T16:24:51.043
> 
> 标签：java, .net, spring, transactions, spring-transactions

什么是 Spring 中 TransactionScope(.Net) 的一个有点等价的类。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T16:31:33.613

[@Transactional](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/)注释看起来是等价的。

这可以放在类和方法上，并且可以通过传播、隔离、回滚等来定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-18T22:29:55.257

我对 .Net 完全一无所知，所以我不确定这是否是您正在寻找的。您可以使用[`SimpleTransactionScope`](https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/transaction/support/SimpleTransactionScope.html)以在事务的整个生命周期中维护对象。默认情况下它没有注册，所以你必须像任何自定义范围一样在 spring core 中注册它，并给它一个字符串名称。然后，如果您愿意，您还可以专门创建一个注释来注册一个。

几年前，在这个问题被确定之后，我的问题就提出了这个建议。我们特别要求它用于跨多种方法注入服务的时间戳。你可以做这样的事情。

```
public class SimpleTransactionFactoryPostProcessor implements BeanFactoryPostProcessor {

    @Override
    public void postProcessBeanFactory(ConfigurableListableBeanFactory factory) throws BeansException {
        factory.registerScope("transaction", new SimpleTransactionScope());
    }
} 
```

```
 @Configuration
class MyConfiguration {

    @Scope(scopeName = "transaction")
    @Bean
    Instant nowInstant() {
       return Instant.now();
    }

} 
```

```
@Service
class MyService {

    private final ObjectFactory<Instant> nowFactory;

    MyService( @Qualifier("nowInstant") ObjectFactory<Instant> nowFactory ) {
       this.nowFactory = nowfactory
    }

    @Transactional
    public boolean nowisEqualAlways() {
       var now = nowFactory.getObject();
       var sameNow = nowFactory.getObject();
       return Objects.equals( now, sameNow );
    }
} 
```

如果您不这样做，您`now`实际上可能会在交易期间更改一小段时间。您可以简单地通过在测试中发送垃圾邮件来测试它。

您的需求可能不需要它，所以我很难说（很明显，您的需求可能早已过去，很有希望。尽管这对将来的某人有所帮助）

# javascript - 使用 jquery 创建和删除 DOM 的对象避免内存泄漏

> ID：10820322
> 
> 赞同：5
> 
> 时间：2012-05-30T16:24:54.083
> 
> 标签：javascript, jquery

假设您有一个组件，其工作是创建一些 DOM 节点（例如使用 jquery）：

```
function PageFiller() {
}
PageFiller.prototype.fillPage = function () {
  this.dom = $("<div/>", {
    "class" : "hello",
    text : "Hello world"
  });
  $("body").append(this.dom);
} 
```

假设另一个组件使用它来填充 DOM，而不保留对“PageFiller”的引用

```
function Main() {
}
Main.prototype.start = function () {
   var filler = new PageFiller();
   filler.fillPage();
};
var main = new Main()
main.start(); 
```

不认为在那之后（在同一范围内），有人粗暴地清除了 DOM：

```
$(".hello").remove(); 
```

这种情况下的内存布局是什么？我是否使用 PageFiller 实例泄漏了内存？

我有点不确定 PageFiller 实例在什么时候会被垃圾收集（如果它曾经发生过），因为它持有对表示不再存在的部分 DOM 的 jquery 对象的引用？还是它与 DOM 无关，因为据我了解，*实际*的DOM 对象与常规 JS 变量位于不同的堆中（除非我在这里弄错了..）

更新：如果对 PageFiller 的引用由 Main 对象保留，则情况会有所不同：

```
Main.prototype.start = function () {
    this.filler = new PageFiller();
    filler.fillPage();
} 
```

在这种情况下，Main 对象具有对 PageFiller 对象的引用，而 PageFiller 对象本身持有对 JQ 对象的引用；在“删除”之后，JQ 对象仍然存在于内存中，但指向不存在的 DOM 节点，对吧？

我是否正确地说在原始示例中，只要 main.start() 完成：

*   没有对象持有对 PageFiller 对象的引用，所以它会被垃圾收集，而 pageFiller.dom 对象没有被任何人引用，所以它也会被垃圾收集？
*   实际的 DOM 元素显然仍然存在于内存中，但在一个单独的堆中，我真的不必担心

其他情况：

这次是一个小的变化，事件处理程序使事情复杂化：

```
PageFiller.prototype.fillPage = function () {
  var self = this;
  this.dom = ... // as usual 
  this.dom.click(function () {
    alert("Just clicked on dom generated by " + self);
  });
} 
```

这一次，仅仅让 PageFiller 实例超出范围还不足以回收它的内存，因为它被点击处理程序中使用的闭包引用。我在这里泄露了内存吗？或者我可以相信 $("").remove() 调用来终止对闭包的引用，从而终止对 PageFiller 的最后一个引用？如果我在没有 jquery 的情况下删除了元素（使用本机 DOM API 吗？），情况会有所不同吗？

这可能一切都像我希望的那样工作，但我只是想说服自己没有内存可以从这种模式中泄漏。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:50:38.953

**更新**

删除`filler.dom`一旦`main.start()`完成将减少它所持有的节点的引用计数，因为它不拥有节点（即弱属性）。

当您再次调用 refcount 时实际节点被删除时，它`$().remove()`会减少到零并且可以被垃圾收集。

所以，AFAICT 你应该没什么好担心的。

# ruby - 在 Linux 上使用 rvm、ruby 1.8.7 和 gcc 4.7 安装 bundler

> ID：10820323
> 
> 赞同：6
> 
> 时间：2012-05-30T16:24:54.933
> 
> 标签：ruby, linux, gcc, rvm, bundler

在 Linux（Fedora 17、Arch 等）上构建 ruby​​ 1.8.7 或使用 GCC 4.7 安装 bundler gem 时出现问题。这个问题发生在我使用 RVM 时。我能够安装 1.8.7，但无法安装 bundler gem。我会收到以下错误：

```
$ gem install bundler

~/.rvm/rubies/ruby-1.8.7-p358/lib/ruby/1.8/timeout.rb:60: [BUG] Segmentation fault
ruby 1.8.7 (2012-02-08 patchlevel 358) [x86_64-linux] 
```

这个问题在许多地方都有描述，包括：

*   [ruby-enterprise 1.8.7-12: timeout.rb:60: [BUG] 分段错误](https://bbs.archlinux.org/viewtopic.php?id=139573)
*   [Ruby gem install 出现段错误](https://bbs.archlinux.org/viewtopic.php?id=139547)
*   [rvm install rbx 在 archlinux 上失败（mri 1.8 + gcc 4.7 问题）](https://github.com/wayneeseguin/rvm/issues/959)
*   [ruby1.8：使用 gcc-4.7 编译时的段错误](http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=674541)
*   [Ruby 1.8.7 构建失败（Arch Linux，gcc > 4.6）](https://github.com/sstephenson/ruby-build/issues/147)

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-30T16:24:55.353

原始问题中的链接中的问题描述建议安装旧版本的 gcc 以构建 1.8.7，**这不是必需**的。

```
$ rvm remove 1.8.7
$ CFLAGS="-O2 -fno-tree-dce -fno-optimize-sibling-calls" rvm install 1.8.7
$ rvm use 1.8.7
$ gem install bundler 
```

解决方案源自以下：

[错误 #6383：使用 GCC 4.7 编译时超时模块中的段错误](https://bugs.ruby-lang.org/issues/6383#note-1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T17:28:50.207

另外，我会确保您拥有截至今天（2012 年 5 月 30 日）发布的稳定版本，即 4.7.0，而不是之前的 4.7 版本，这些版本不是稳定版本。RVM 的政策是不支持 GCC 的非稳定版本（也称为开发版本），因为我们不是编译器，呵呵。

然后，另外，请卸载并重新安装您原来的 1.8.7 版本。另一个选项是“rvm reinstall 1.8.7”，尽管并非所有以前的配置选项都可以重新生成以包括接受更改后的 CFLAGS 变量，如写入配置。@mpapis，我们是否需要在这里提倡使用 --autoconf --force ？

（mpapis 和我是 RVM 项目的开发人员，所以这是一个讨论标志和监控以查看应该做什么的好地方，这样我们就可以将信息推送给任何来找我们的人）

# algorithm - 最小乘法与集合覆盖问题

> ID：10820326
> 
> 赞同：5
> 
> 时间：2012-05-30T16:24:55.473
> 
> 标签：algorithm, set, np-complete, linear-programming, set-cover

我有一个集合 I ={P1, P2, ..., Pm} 和 I 的 n 个有限子集，用 R1,R2,...,Rn 表示，如下所示：

R1 = {P1, P2}

R2 = {P2, P4}

R3 = {P2，P3，P4}

R4 = {P1，P2，P4}

……

其中 Pi 表示一个整数。

对于每个 Ri，我想计算其所有元素的乘积。我的目标是通过在 Ri (i=1,2,...,n) 之间共享一些公共部分来尽可能少地使用乘法和除法。

例如，如果我可以先计算 P2*P4，那么这个结果可以用于计算 R3 和 R4 的所有元素的乘积。

请注意，也允许除法。例如，我可以先计算 A=P1*P2*P3*P4，然后使用 A/P1 计算 R3 的所有元素的乘积，然后使用 A/P3 计算 R4。

如果我想使用最小乘法和除法来计算 I 的每个子集的所有产品，这是一个集合覆盖问题吗？NP完全？顺便说一句，您能否给出一个整数线性程序公式来描述它，就像[这里](http://en.wikipedia.org/wiki/Set_cover_problem)一样。

任何建议将不胜感激！

*社区编辑*：附加假设：

*   允许除法，与乘法相同的成本
*   给定集合中没有重复的元素。例如`R5 = {P1, P1, P1, P2}`不允许

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T17:26:46.963

**首先，你不需要除法**

这里不需要除法，它总是一个额外的计算。

如果您需要除法，则意味着您已经进行了乘法运算，因此，如果您进行除法，则撤消已经完成的工作。

例如，如果您通过将 Pi*Pj*Pk*Pn 除以 Pn 来计算 Pi*Pj*Pk，这意味着您之前计算了 Pi*Pj*Pk*Pn，因此您之前计算了 Pi*Pj*Pk。

（我假设你所有的数字都是**素数**）

**我的解决方案**

我有一个不考虑分裂可能性的想法。

您可以使用 Ri 开始构建[后缀树](http://en.wikipedia.org/wiki/Suffix_tree)。

那么乘法的数量将是树中的边数。

**例子 ：**

使用您的示例，后缀树将是：

```
 P2
      / \
     P4 P1
    / \ 
   P3 P1 
```

你得到 4 乘法：

```
M1=P1*P2

M2=P2*P4

M3=M2*P1

M4=M2*P3 
```

找到最小的乘法次数相当于构建具有最少边数的后缀树。

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T17:34:08.373

考虑一个没有边的元素 R [i的图。]我们现在允许自己添加边，如下所示：

*   [在 R a] →R [b]之间添加一条有向边，用商 R [b] /R [a]注释。

例如，我们可以画一条边 R [1] →R [3]，成本乘以 R [1] /R [3] = P3*P4/P1

对所有节点都这样做，所以你有 |R| ²边。

现在，如果您*只*使用中间结果，您可以使用最小生成树算法来解决这个问题。我相信 MST 算法在边数上非常接近线性（逆阿克曼的一个因子，增长速度比 慢`log(log(log(...log(n)...)))`）；甚至可能在边数上存在随机线性时间算法，例如[http://www.akira.ruc.dk/~keld/teaching/algoritmedesign_f04/Artikler/07/Karger95.pdf](http://www.akira.ruc.dk/~keld/teaching/algoritmedesign_f04/Artikler/07/Karger95.pdf)因此这个基本算法将采用|R| ²次。

但是，如果您只使用中间结果，您将无法获得真正的最佳答案，因为可以使用我们凭空提取的“临时”表达式来获得更好的性能。例如，您可能会考虑这种情况：

```
R1 = {P2, P3, P4, P5}
R2 = {P1, P3, P4, P5}
R3 = {P1, P2, P4, P5}
R4 = {P1, P2, P3, P5}
R5 = {P1, P2, P3, P4} 
```

最佳解决方案是计算`P1*P2*P3*P4*P5`，然后除以 P [i]，得到 9 次操作。而上面的方法只会做R1=P2*P3*P4*P5这样的事情，然后每次都进行一次乘除运算，R1→R2，R2→R3，R3→R4，R4→R5，总共11次运算。（如果我们没有除法，我们也会有 9 个操作： b=P1*P2 c=b*P3 r5=c*P4 r4=c*P5, d=P4*P5, r3=b*d, e= P3*d, r1=e*P2, r2=e*P1\. 虽然我认为可能会产生需要除法的情况，但似乎找不到；如果我找不到，可能是这样的情况这实际上是一个简单的多项式时间问题。）

我将这种方法称为“临时表达”方法。*如果我们选择计算一个临时表达式（一开始是一个单一的沉没成本），如果我们选择使用它*，这将减少所有未来计算遍历一条边的成本（因为可能需要选择多少个临时表达式采用）。

这给我们带来了一个非常小的旁注：

```
Theorem:
  You should have at least one intermediate expression of each 
  length up to the maximum size of any R.
Proof (induction):
  To build up a product of size N, you will need to do 
  have a product of size N-1. 
```

注意到这个定理，事实证明我们在上面有点错误。最佳解决方案是记住`P1*P2*P3`并`P1*P2*P3*P4`在计算过程中`P1*P2*P3*P4*P5`。然后我们就可以`R5`免费获得（并且`R4`通过另一种方式只需要一次乘法，不幸的是成本与以前相同），将总成本从 9 降低到 8。这导致我们疯狂猜测执行[http://en.wikipedia。 org/wiki/Floyd%E2%80%93Warshall_algorithm](http://en.wikipedia.org/wiki/Floyd%E2%80%93Warshall_algorithm)具有任意边缘也可能会在很长一段时间后产生最佳解决方案。

无论如何，我们如何将这样的系统整合到我们的解决方案中？我们不能添加节点，因为这会弄乱 MST 算法。对于每条边，乘以或除以临时表达式 E 不会使某些 P 具有超过幂 p（例如，对于 p=2，我们允许中间临时表达式创建类似的乘积`P1 * P4^2 / P3`但不允许类似的东西`P2^3`），我们执行乘法和除法在边缘上，并创建两个新边缘。（我们可能不止一次这样做，或者在未来的日期。）我们也对边缘的所有子集这样做，我们会像上面那样记忆。这种方法的代价，如果你使用MST算法，就是边的数量大幅增加，所以可能(|R| + #newedges) ² = (|R|^|P|) ²也许在更糟糕的情况下，会显着增加找到最佳答案所需的时间。

因此，作为一种猜测，似乎更普遍的问题是 NP-hard；如果不是这种情况，请有人插话。但是，您也许可以使用启发式方法来猜测要使用的有用的临时表达式。例如，如果您看到 R 的“大”子集具有“高密度的公共 P”，您可能会生成作为所有公共 P 乘积的技巧节点。如果您对您在 Rs 子集中看到的所有“大/密集的常见 Ps 团块”执行此操作，然后运行 ​​MST，您可能会得到稍微更好的答案，而无需进行更一般的搜索。您甚至可以运行一种算法来帮助检测此类团块，例如层次聚类算法。

（旁注：您也可以将有关格的数学应用于此问题，因为您可以将每个集合视为一个位向量，它们共同构成格的基础。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T00:04:04.583

如果没有除法，这似乎等同于[Gary & Johnson](https://rads.stackoverflow.com/amzn/click/com/0716710455)中描述的问题 ENSEMBLE COMPUTATION ，因此是 NP-complete。

> [PO9] 集成计算
> 
> 实例：有限集 A 的子集的集合 C，正整数 J。
> 
> 问题：是否存在 j <= J 联合操作的序列 S = (z_1 <- x_1 U y_1, z_2 <- x_2 U y_2, ..., z_j <- x_j U y_j)，其中每个 x_i 和 y_i 都是 { a} 对于 A 中的某个 a 或对于某些 k < i 的 z_k，使得 x_i 和 y_i 不相交，1 <= i <= j，并且对于 C 中的每个子集 c 都存在一些 z_i，1 <= i < = j，这与 C 相同。

你的集合I对应A，每个R_i对应C的一个元素，乘法对应集合并集。

# c++ - C++ 大小感知数据类型/参数

> ID：10820329
> 
> 赞同：0
> 
> 时间：2012-05-30T16:25:00.987
> 
> 标签：c++

我不确定，但我想我曾经见过一个看起来像这样的方法签名（在构造函数中）：

```
class Buffer {
    Buffer(char_with_size *data) { ... };
    Buffer(char *data, size_t len) { ... };
}; 
```

在第一个构造函数调用中，可以传递一个数组/指针参数，编译器会自动知道它的大小。所以，我总是知道传递的 char 缓冲区的大小。

有谁知道这是否真的存在于 c++ 中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T16:26:50.267

只有模板版本可能有意义：

```
Buffer(char * data, std::size_t len) { /* ... */ }

template <std::size_t N> Buffer(char (&data)[N]) : Buffer(data, N) { } 
```

（请注意，委托构造函数是新的，还没有得到广泛支持。为了举例，我在这里只使用一个。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T16:26:57.373

当然，`Buffer(std::vector<char> data)`。（IOW，不要使用`char*`。）

# c - C语言宏中需要括号

> ID：10820340
> 
> 赞同：37
> 
> 时间：2012-05-30T16:25:26.760
> 
> 标签：c, macros, c-preprocessor, parentheses

我尝试`SQR`在以下代码中使用宏的定义：

```
#define SQR(x) (x*x)
int main()
{
    int a, b=3;
    a = SQR(b+5);      // Ideally should be replaced with (3+5*5+3), though not sure.
    printf("%d\n",a);
    return 0;
} 
```

它打印`23`。如果我将宏定义更改为，`SQR(x) ((x)*(x))`则输出如预期的那样，`64`. 我知道在 C 中调用宏会用宏的定义替换调用，但我仍然不明白它是如何计算`23`的。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-05-30T16:28:05.930

预处理器宏在编译代码之前执行文本替换，因此 `SQR(b+5)`转换为 (b+5*b+5) = (6b+5) = 6*3+5 = 23

常规函数调用会在将参数 (b+3) 传递给函数之前计算参数的值，但由于宏是预编译替换，因此运算的代数顺序变得非常重要。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-05-30T16:31:01.820

考虑使用此宏进行宏替换：

```
#define SQR(x) (x*x) 
```

用作论据`b+5`。自己更换。在您的代码中，`SQR(b+5)`将变为：`(b+5*b+5)`或`(3+5*3+5)`。现在记住您的**运算符优先**规则：`*`before `+`。所以这被评估为：`(3+15+5)`或`23`。

宏的第二个版本：

```
#define SQR(x) ((x) * (x)) 
```

是正确的，因为您使用括号来保护宏参数免受运算符优先级的影响。

[这个](http://en.cppreference.com/w/c/language/operator_precedence)解释操作员对 C 的偏好的页面有一个很好的图表。[这是](https://port70.net/~nsz/c/c11/n1570.html#A.2.1)C11 参考文档的相关部分。

这里要记住的是，您应该养成使用括号始终屏蔽宏中的任何参数的习惯。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-05-30T16:28:00.050

因为`(3+5*3+5 == 23)`.

而`((3+5)*(3+5)) == 64`.

最好的方法是**不使用宏**：

```
inline int SQR(int x) { return x*x; } 
```

或者干脆写`x*x`。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-05-30T16:27:30.063

宏扩展为

```
 a = b+5*b+5; 
```

IE

```
 a = b + (5*b) + 5; 
```

所以23。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-05-27T12:47:16.697

预处理后，`SQR(b+5)`将扩展为`(b+5*b+5)`. 这显然是不正确的。

的定义中有两个常见的错误`SQR`：

1.  不要将宏的参数括在宏体中的括号中，因此如果这些参数是表达式，则这些表达式中具有不同优先级的运算符可能会导致问题。这是解决此问题的版本

    ```
    #define SQR(x) ((x)*(x)) 
    ```

2.  多次评估宏的参数，因此如果这些参数是具有副作用的表达式，则这些副作用可能会被多次采用。例如，考虑 的结果`SQR(++x)`。

    通过使用 GCC [typeof](https://gcc.gnu.org/onlinedocs/gcc/Typeof.html)扩展，可以像这样解决这个问题

    ```
    #define SQR(x) ({ typeof (x) _x = (x); _x * _x; }) 
    ```

这两个问题都可以通过用内联函数替换该宏来解决

```
 inline int SQR(x) { return x * x; } 
```

这需要 GCC 内联扩展或 C99，请参阅[6.40 内联函数与宏一样快](https://gcc.gnu.org/onlinedocs/gcc/Inline.html)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-30T16:34:44.703

宏只是直接的文本替换。预处理后，您的代码如下所示：

```
int main()
{
    int a, b=3;
    a = b+5*b+5;
    printf("%d\n",a);
    return 0;
} 
```

乘法的运算符优先级高于加法，因此在计算 的值时在两次加法之前完成`a`。在宏定义中添加括号可以通过以下方式解决问题：

```
int main()
{
    int a, b=3;
    a = (b+5)*(b+5);
    printf("%d\n",a);
    return 0;
} 
```

带括号的运算在乘法之前进行评估，因此现在首先进行加法，并且您会得到`a = 64`预期的结果。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-01-09T20:35:36.297

因为宏只是字符串替换，它发生在完成过程之前。编译器将没有机会看到宏变量及其值。例如：如果一个宏被定义为

```
#define BAD_SQUARE(x)  x * x 
```

并像这样称呼

```
BAD_SQUARE(2+1) 
```

编译器会看到这个

```
2 + 1 * 2 + 1 
```

这可能会导致意想不到的结果

```
5 
```

要纠正这种行为，您应该始终用括号括住宏变量，例如

```
#define GOOD_SQUARE(x)  (x) * (x) 
```

例如，当调用此宏时，像这样

```
GOOD_SQUARE(2+1) 
```

编译器会看到这个

```
(2 + 1) * (2 + 1) 
```

这将导致

```
9 
```

此外，这里有一个完整的例子来进一步说明这一点

```
#include <stdio.h>

#define BAD_SQUARE(x)  x * x 
// In macros alsways srround the variables with parenthesis
#define GOOD_SQUARE(x)  (x) * (x) 

int main(int argc, char const *argv[])
{
    printf("BAD_SQUARE(2) = : %d \n", BAD_SQUARE(2) ); 
    printf("GOOD_SQUARE(2) = : %d \n", GOOD_SQUARE(2) ); 
    printf("BAD_SQUARE(2+1) = : %d ; because the macro will be \
subsituted as 2 + 1 * 2 + 1 \n", BAD_SQUARE(2+1) ); 
    printf("GOOD_SQUARE(2+1) = : %d ; because the macro will be \
subsituted as (2 + 1) * (2 + 1) \n", GOOD_SQUARE(2+1) ); 

    return 0;
} 
```

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2016-03-13T11:13:14.377

只需将宏扩展中的每个参数括在括号中即可。

```
#define SQR(x) ((x)*(x)) 
```

这适用于您传递的任何参数或值。

# linux - 如何在 shell 脚本中动态生成新的变量名？

> ID：10820343
> 
> 赞同：40
> 
> 时间：2012-05-30T16:25:53.887
> 
> 标签：linux, bash, shell

我正在尝试在 shell 脚本中生成动态 var 名称，以在循环中处理一组具有不同名称的文件，如下所示：

```
#!/bin/bash

SAMPLE1='1-first.with.custom.name'
SAMPLE2='2-second.with.custom.name'

for (( i = 1; i <= 2; i++ ))
do
  echo SAMPLE{$i}
done 
```

我希望输出：

```
1-first.with.custom.name
2-second.with.custom.name 
```

但我得到了：

```
SAMPLE{1}
SAMPLE{2} 
```

是否可以即时生成 var 名称？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2012-05-30T16:35:23.173

您需要利用变量间接：

```
SAMPLE1='1-first.with.custom.name'
SAMPLE2='2-second.with.custom.name'

for (( i = 1; i <= 2; i++ ))
do
   var="SAMPLE$i"
   echo ${!var}
done 
```

在[Bash 手册页](https://linux.die.net/man/1/bash)的“参数扩展”下：

> “如果参数的第一个字符是感叹号（！），则引入了变量间接级别。Bash 使用由参数的其余部分形成的变量的值作为变量的名称；然后扩展此变量，并且value 用于其余的替换，而不是参数本身的值。这称为间接扩展。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-05-30T16:35:36.933

### 问题

您正在使用*i*的值，就好像它是数组索引一样。不是，因为 SAMPLE1 和 SAMPLE2 是单独的变量，而不是数组。

此外，在调用时，`echo SAMPLE{$i}`您只需将*i*的值附加到单词“SAMPLE”。您在此语句中取消引用的唯一变量是**$i**，这就是您得到结果的原因。

### 解决问题的方法

有两种主要方法可以解决这个问题：

1.  内插变量的多阶段解引用，通过**eval**内置或[间接变量扩展](http://www.gnu.org/software/bash/manual/bashref.html#Shell-Parameter-Expansion)。
2.  遍历数组，或使用*i*作为数组的索引。

### 使用*eval取消引用*

在这种情况下，最简单的方法是使用*eval*：

```
SAMPLE1='1-first.with.custom.name'
SAMPLE2='2-second.with.custom.name'

for (( i = 1; i <= 2; i++ )); do
    eval echo \$SAMPLE${i}
done 
```

这会将*i*的值附加到变量的末尾，然后重新处理结果行，扩展内插变量名称（例如*SAMPLE1*或*SAMPLE2*）。

### 使用间接变量取消引用

这个问题的公认答案是：

```
SAMPLE1='1-first.with.custom.name'
SAMPLE2='2-second.with.custom.name'

for (( i = 1; i <= 2; i++ ))
do
   var="SAMPLE$i"
   echo ${!var}
done 
```

这在技术上是一个三步过程。*首先，它为var*分配一个插值变量名，然后取消引用存储在*var*中的变量名，最后展开结果。它看起来更干净一些，有些人对这种语法比使用*eval*更舒服，但结果基本相同。

### 遍历数组

您可以通过迭代数组而不是使用变量插值来简化循环和扩展。例如：

```
SAMPLE=('1-first.with.custom.name' '2-second.with.custom.name')
for i in "${SAMPLE[@]}"; do
    echo "$i"
done 
```

与其他方法相比，这增加了好处。具体来说：

1.  您无需指定复杂的循环测试。
2.  **您可以通过$SAMPLE[$i]**语法访问单个数组元素。
3.  **您可以通过${#SAMPLE}**变量扩展获得元素的总数。

### 原始示例的实际等效性

所有三种方法都适用于原始问题中给出的示例，但数组解决方案提供了最大的整体灵活性。选择最适合您手头数据的一个。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-30T16:34:07.737

~~据我所知，~~他们的方式@johnshen64 说。此外，您可以使用这样的数组来解决您的问题：

```
SAMPLE[1]='1-first.with.custom.name'
SAMPLE[2]='2-second.with.custom.name'

for (( i = 1; i <= 2; i++ )) do
    echo ${SAMPLE[$i]}
done 
```

请注意，您不需要使用数字，因为索引`SAMPLE[hello]`也可以使用

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-30T16:35:39.633

你可以使用`eval`如下图：

```
SAMPLE1='1-first.with.custom.name'
SAMPLE2='2-second.with.custom.name'

for (( i = 1; i <= 2; i++ ))
do
  eval echo \$SAMPLE$i
done 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-30T21:28:45.733

不是一个独立的答案，只是对 Miquel 的答案的补充，我不太适合发表评论。

您可以使用循环、+= 运算符和此处的文档来填充数组：

```
SAMPLE=()
while read; do SAMPLE+=("$REPLY"); done <<EOF
1-first.with.custom.name
2-second.with.custom.name
EOF 
```

在 bash 4.0 中，它很简单

```
readarray SAMPLE <<EOF
1-first.with.custom.name
2-second.with.custom.name
EOF 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-07-20T20:55:53.833

评估“回声$SAMPLE${i}”

# python - 我应该如何在 python 中使用 lxml 处理 XLink 引用？

> ID：10820351
> 
> 赞同：2
> 
> 时间：2012-05-30T16:26:29.600
> 
> 标签：python, lxml, xlink

我被要求编写一些读取 XML 配置文件的脚本，这些脚本可以自由使用 XLink 来包含存储在多个文件中的 XML。例如：

```
<Environment xlink:href="#{common.environment}" /> 
```

（#{common.environment} 是一个属性占位符，它首先被解析，在这里可以忽略。）该公司已经标准化了 lxml，用于在 python 中进行高级 XML 处理。

我一直在寻找有关如何在这些限制下处理这些事件的示例或文档，并且至少将它们的内容包含在父 XML 文档中，就好像它们实际上是在该点插入一样。我有点惊讶地发现那里很少有珍贵的东西，以至于我想知道我是否遗漏了一些明显的东西。我找到了关于 XLink 是什么的通用文档，并且我找到了一些在 XSLT 处理上下文中使用它的示例。但这对我没有帮助。

任何人都可以就如何最好地实现这一点提供任何建议，无论是文档、示例还是经验中的一些建议？谢谢。

**更新：**这是一个之前和之后的例子：

前。这是正在解析的文件中的实际内容：

```
<Root>
    <Environment xlink:href="#{common.environment}" />
</Root> 
```

这是 #{common.environment} 解析为的文件中的内容：

```
<?xml version="1.0" encoding="UTF-8"?>
<Environment>
    <Property key="hello.world" value="foo" />
    <Property key="bar.baz" value="fred" />
</Environment> 
```

后。这是解析器在所有处理完成后“看到”它的方式：

```
<Root>
    <Environment>
        <Property key="hello.world" value="foo" />
        <Property key="bar.baz" value="fred" />
    </Environment>
</Root> 
```

这是那里发生的事情的一个彻底简化的示例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T15:47:18.627

这个答案可能与您真正需要的相去甚远，但也许它会有所帮助。下面的小程序是我根据“彻底简化”的例子可以想出的。

```
from lxml import etree

parent = etree.parse("parent.xml").getroot()
penv = parent.xpath("Environment")

for e in penv:
    child = e.get("{http://www.w3.org/1999/xlink}href")
    c = etree.parse(child).getroot()
    parent.replace(e, c)

print etree.tostring(parent) 
```

父.xml：

```
<Root xmlns:xlink="http://www.w3.org/1999/xlink">
  <Environment xlink:href="child.xml"/>
</Root> 
```

孩子.xml：

```
<Environment>
  <Property key="hello.world" value="foo" />
  <Property key="bar.baz" value="fred" />
</Environment> 
```

当程序运行时，它会输出：

```
<Root xmlns:xlink="http://www.w3.org/1999/xlink">
  <Environment>
  <Property key="hello.world" value="foo"/>
  <Property key="bar.baz" value="fred"/>
</Environment></Root> 
```

# c# - 通过 xsl 文件查询数据库

> ID：10820362
> 
> 赞同：0
> 
> 时间：2012-05-30T16:26:45.773
> 
> 标签：c#, xml, ajax, xslt, aspdotnetstorefront

我有一个在运行时生成 XML 的电子商务购物车。我可以访问为实际 XML 设置样式的 XSL 样式表。

我想在菜单中显示产品类别图像。是否有在 xsl 文件中运行查询的示例，您可以向我展示吗？

我看不到它从哪里提取类别数据？

你能帮我吗？

```
<?xml version="1.0" standalone="yes" ?>
    <!-- ###################################################################################################### -->
    <!-- Copyright AspDotNetStorefront.com, 1995-2009\. All Rights Reserved. -->
    <!-- http://www.aspdotnetstorefront.com -->
    <!-- For details on this license please visit the product homepage at the URL above. -->
    <!-- THE ABOVE NOTICE MUST REMAIN INTACT. -->
    <!-- ###################################################################################################### -->
    <package version="2.1" displayname="Categories" debug="false" includeentityhelper="true">
    <PackageTransform>
    <xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:aspdnsf="urn:aspdnsf" exclude-result-prefixes="aspdnsf">
    <xsl:output method="html" omit-xml-declaration="yes"/>

    <xsl:param name="CategoryID">
    <xsl:choose>
    <xsl:when test="/root/System/PageName = 'showmanufacturer.aspx' or /root/System/PageName = 'showsection.aspx' or /root/System/PageName = 'showdistributor.aspx' or /root/System/PageName = 'showvector.aspx' or /root/System/PageName = 'showgenre.aspx'">0</xsl:when>
    <xsl:when test="/root/System/PageName = 'showcategory.aspx' and boolean(/root/QueryString/categoryid)">
    <xsl:value-of select="/root/QueryString/categoryid"/>
    </xsl:when>
    <xsl:when test="(/root/System/PageName = 'showcategory.aspx' or /root/System/PageName = 'showproduct.aspx') and boolean(/root/Cookies/LastViewedEntityInstanceID) and /root/Cookies/LastViewedEntityName = 'Category'">
    <xsl:value-of select="/root/Cookies/LastViewedEntityInstanceID"/>
    </xsl:when>
    <xsl:otherwise>
    0
    </xsl:otherwise>
    </xsl:choose>
    </xsl:param>

    <xsl:param name="AncestorID">
    <xsl:for-each select="/root/EntityHelpers/Category//Entity[EntityID = $CategoryID]">
    <xsl:value-of select="ancestor::*/EntityID"/>
    </xsl:for-each>
    </xsl:param>

    <xsl:param name="ParentID">
    <xsl:for-each select="/root/EntityHelpers/Category//Entity[EntityID = $CategoryID]">
    <xsl:value-of select="parent::*/EntityID"/>
    </xsl:for-each>
    </xsl:param>

    <xsl:template match="/">
    <xsl:element name="ul">
    <xsl:attribute name="class">
    <![CDATA[menuul]]>
    </xsl:attribute>

    <xsl:apply-templates select="/root/EntityHelpers/Category/Entity">
    <xsl:with-param name="prefix" select="''"/>
    </xsl:apply-templates>

    </xsl:element>
    </xsl:template>

    <xsl:template match="Entity">
    <xsl:param name="prefix"></xsl:param>
    <xsl:param name="eName" select="aspdnsf:GetMLValue(Name)" />

    <xsl:choose>
    <xsl:when test="Published=1">

    <li class="menuli">
    <xsl:value-of select="$prefix" />
    <!--<xsl:if test="number(ParentEntityID) != 0">
    <span class="catMark">>></span>�
    </xsl:if>-->
    <a href="{concat('c-',EntityID,'-',SEName,'.aspx')}">
    <xsl:if test="EntityID = $CategoryID or descendant::Entity/EntityID = $CategoryID">
    <xsl:attribute name="class">MenuSelected</xsl:attribute>
    </xsl:if>
    <xsl:value-of select="$eName" disable-output-escaping="yes"/>
    </a>

    <xsl:if test="count(child::Entity)>0">
    <ul class="submenuul">
    <xsl:apply-templates select="Entity">
    <xsl:with-param name="prefix" select="concat($prefix, '��')"/>
    </xsl:apply-templates>
    </ul>
    </xsl:if>
    </li>

    </xsl:when>
    </xsl:choose>

    </xsl:template>

    </xsl:stylesheet>
    </PackageTransform>
    </package> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:41:58.537

如果您使用的是 ASP.NET，则可以使用标准的 ASP.NET `XML Control`。

在页面加载时将您的 xml 和 xsl 文件分配给它，如下所示：

```
protected void Page_Load(object sender, EventArgs e)
{
   Xml1.DocumentSource = "~/App_Data/YourXmlFile.xml";
   Xml1.TransformSource = "~/App_Data/YourXslStyleSheetFile.xsl";
} 
```

您还可以使用`DocumentContent`属性，您的 xml 不是存储在文件中，而是存储在数据库中。

在此处查看[示例](http://www.murraymac.net/70528/SpecializedServerControls.aspx#XmlControl)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-28T02:23:43.520

公认的答案对 ASP.Net 是正确的，但对 Aspdotnetstorefront 不是。问题中引用的 XML 文件仅在启用调试时生成，并且不应在任何生产环境中生成（最终会出现写入冲突）。

XSLT 背后的 XML 是在运行时为您生成的。包含类别数据（和其他实体数据）是因为您拥有`includeentityhelper="true"`. EntityHelper 缓存类别（和其他实体）数据以减少数据库查询。如果您需要除此之外的数据，则应使用`<query>`此处记录的 XMLPackage 节点（在“SQL 查询”下）： [http ://manual.aspdotnetstorefront.com/p-157-xml-packages.aspx](http://manual.aspdotnetstorefront.com/p-157-xml-packages.aspx)

您还会发现默认构建中包含的大多数 XMLPackage 中使用的 '' 节点。

# android - 从适配器中的 HashMap 检索数据（GetView 方法）

> ID：10820363
> 
> 赞同：0
> 
> 时间：2012-05-30T16:26:46.290
> 
> 标签：android, listview, hashmap, linkedhashmap

我根据这个例子创建了一个列表：

[http://jsharkey.org/blog/2008/08/18/separating-lists-with-headers-in-android-09/](http://jsharkey.org/blog/2008/08/18/separating-lists-with-headers-in-android-09/)

在GetView 方法中，需要访问的信息只存储在HashMap 中。我可以使用“adapter.getItem(position).ToString()”进行访问，但是这样一来，键和值就在一个字符串中组合在一起，如下所示：

{date=2011-07-25 19:30:00，id=1，caption=Test Caption，title=Test Title，bookmark=true}

您可以单独检索这些数据吗？例如，只有“书签”字段的值

请举个例子。我是为 Android 开发的新手。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T17:45:23.007

请记住，您知道适配器使用的数据类型。

而不是使用 toString，只需获取项目并像往常一样使用它。

例如：

```
HashMap<String, String> i = (HashMap<String, String>) adapter.getItem(position);
i.get(ITEM_TITLE); 
```

# python - 如何在 Windows 上使用 Python 访问远程文件系统？

> ID：10820376
> 
> 赞同：1
> 
> 时间：2012-05-30T16:27:33.740
> 
> 标签：python, windows, networking

我正在编写一个 Python 脚本来访问网络上的所有计算机，登录它们并读取一些日志文件。我不想使用像[socket](http://docs.python.org/library/socket.html)这样低级的东西，但如果必须的话，我可以。我意识到我的问题与[这个问题](https://stackoverflow.com/questions/5314711/python-how-do-i-copy-a-directory-to-a-remote-machine-using-fabric)相似，但不一样。

是否有用于访问外部 Windows 机器的模块？有没有人做过这样的事情？

我特别想登录 Windows 7 机器，**而不是 unix。**

我们还假设我要登录的每台计算机都安装并启用了远程桌面。我也不担心网络安全或加密，因为这些文件不是机密文件。默认情况下，Windows 机器上没有安装 SSH 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T17:20:45.743

另一边一定有什么东西可以和你交谈。这限制了您在每台机器上设置“服务器”、安装真实服务器（即 sshd）、自己构建“服务器”并安装它，或者使用操作系统的内置和活动功能。

基于此，你想在这些机器上建立什么样的系统？它需要做什么？只是阅读预先指定的文件列表的内容？这份名单会改变吗？

*   一种解决方案是打开 telnet，并使用 paramiko 或 twisted 进行对话。这当然不是很安全
*   接下来，设置一个 samba 共享，并远程访问该文件夹。这也是不安全的，虽然不如 telnet
*   如果您愿意，您可以找到一个 ssh 守护程序端口并运行它
*   来自 sysinternals 的 Psexec 可能有效
*   使用 twisted 构建具有您需要的功能的服务器应用程序
*   使用 ncat 侦听端口并生成 cmd 提示符

请注意，大多数远程访问 Windows 的解决方案都......很差。最好的解决方案可能是自己动手，但这是一项艰苦的工作，你可能会犯错误。

此外，Windows 7**并不**完全是多用户友好的。单个进程可以作为单独的用户运行，但操作系统不支持多个用户同时登录。有人将成为“用户”，而其他人只是具有不同凭据集的进程。

这更像是对 M$ 的人为限制，而不是任何技术上的限制。要查看实际情况，请尝试在用户本地登录时使用 RDP 登录。娱乐时间。

根据您的编辑，最简单的方法就是在盒子上设置一个 samba 共享。

设置此共享后：

```
with open(r'\\myCompNameOrIP\C\windows\logs\logfile.txt','rb') as logfile:
    loglines = logfile.readlines() 
```

或者您可以使用[此处找到的](http://www.dabeaz.com/generators/)[gencat](http://www.dabeaz.com/generators/gencat.py)示例。只需将其作为搜索路径并观看魔术。`r'\\myCompNameOrIP\C\windows\logs\*.txt'`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T16:45:04.550

从 Ubuntu 我使用 samba：

在 Bash 中：gvfs-mount smb://them/folder

这里我给出名称、域和密码

然后在python中：

```
folder = '/home/me/.gvfs/folder on them' 
```

使用 os 模块我读取里面的文件夹和文件。

我在小型企业环境中工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T17:35:59.387

为什么不让每台计算机都将日志文件发送到中央计算机？

# c - C - 格式化字符数组，如 printf

> ID：10820377
> 
> 赞同：9
> 
> 时间：2012-05-30T16:27:34.243
> 
> 标签：c, string-formatting

我想像这样格式化交流字符串`printf`。例如：

```
char string[] = "Your Number:%i";
int number = 33;
// String should now be "Your Number:33" 
```

有什么图书馆或我可以做到这一点的好方法吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-30T16:32:46.533

[`sprintf(char* out, const char* format, ... );`](http://www.cplusplus.com/reference/cstdio/sprintf/)像这样使用：

```
int main() {
  char str[] = "Your Number:%d";
  char str2[1000];
  int number = 33;
  sprintf(str2,str,number);
  printf("%s\n",str2);
  return 0;
} 
```

输出：

```
---------- Capture Output ----------
> "c:\windows\system32\cmd.exe" /c c:\temp\temp.exe
Your Number:33

> Terminated with exit code 0. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T16:30:01.670

sprintf - [http://linux.die.net/man/3/sprintf](http://linux.die.net/man/3/sprintf)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-12T19:37:26.540

为了调试我的 Arduino 草图，我习惯性地使用这个解决方案，取自[Madivad](https://arduino.stackexchange.com/users/304/madivad)对[如何在字符串中打印多个变量的回答？](https://arduino.stackexchange.com/questions/176/how-do-i-print-multiple-variables-in-a-string).

您将此功能添加到您的草图中，这将允许您使用`printf()`，尽管它会因`float`,而失败`%f`。

```
// Function that printf and related will use to print
int serial_putchar(char c, FILE* f) {
    if (c == '\n') serial_putchar('\r', f);
    return Serial.write(c) == 1? 0 : 1;
} 
```

添加全局

```
FILE serial_stdout; 
```

并把这是`setup()`

```
fdev_setup_stream(&serial_stdout, serial_putchar, NULL, _FDEV_SETUP_WRITE);
stdout = &serial_stdout; 
```

一个示例草图是：

```
// Function that printf and related will use to print
int serial_putchar(char c, FILE* f) {
    if (c == '\n') serial_putchar('\r', f);
    return Serial.write(c) == 1? 0 : 1;
}

FILE serial_stdout;

void setup(){
    Serial.begin(9600);

    // Set up stdout
    fdev_setup_stream(&serial_stdout, serial_putchar, NULL, _FDEV_SETUP_WRITE);
    stdout = &serial_stdout;

    printf("My favorite number is %6d!\n", 12);
}

void loop() {
  static long counter = 0;
  if (millis()%300==0){
    printf("millis(): %ld\tcounter: %ld (%02X)\n", millis(), counter, counter++);
    delay(1);    
  }
} 
```

# c# - C# 中的语义分析

> ID：10820378
> 
> 赞同：3
> 
> 时间：2012-05-30T16:27:39.317
> 
> 标签：c#, nlp, semantics

制作进行语义分析的 C# 代码的工具（如果有）是什么？我对检测 sysnonims 很感兴趣，例如，如果有一个包含单词 K9 的句子，该工具会识别出 K9 表示狗。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T16:42:30.040

您正在寻找的是[自然语言处理](http://en.wikipedia.org/wiki/Natural_language_processing)(NLP) 工具，周围有一些工具可能会有所帮助，例如[SharpNLP](http://sharpnlp.codeplex.com/)，但我不知道是否有用于检测和替换同义词的特定工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-12T21:26:22.667

这些天更好的方法是使用 ikvm 和 opennlp 之类的东西。已经提到的 SharpNLP 是从 2006 年开始的，已经严重过时并且已经死了。曾有过一次尝试恢复它，但它停滞不前。您可能不会再看到任何纯 .net 解决方案，因为可以使用 ikvm 访问已经存在的成熟 NLP 项目。

# c - 仅使用 rand(start,end) 6 次从 50 个单元阵列中选择 6 个不同的单元

> ID：10820388
> 
> 赞同：-2
> 
> 时间：2012-05-30T16:28:02.640
> 
> 标签：c, random-sample

我试图想出一种算法，它从一个有 50 个单元的数组中选择 6 个随机单元，这样每个单元被选择的概率是相等的。我需要找到一个使用函数 Random(start,end) 不超过 6 次的解决方案。

我不能使用任何额外的数据结构，重要的是每个单元格被选中的概率是相等且独立的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T16:30:57.003

随机调用（0,49）。读取生成的单元格，然后将数组中的所有内容移到一个位置，这样您就有一个 49 单元格数组，其中缺少所选值。

调用 Random(0,48) 并重复 6 次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T16:43:37.527

将单元格放入列表中，随机播放，取六个

# xamarin.ios - MonoTouch 中的并发字典

> ID：10820403
> 
> 赞同：1
> 
> 时间：2012-05-30T16:28:52.773
> 
> 标签：xamarin.ios

我正在尝试在我的 monotouch 应用程序中使用 ConcurrentDictionary。在我尝试在我的 monotouch 应用程序中使用 ConcurrentDictionary 时，一切运行正常。在模拟器中一切运行正常，但是当我在 iPad 中运行时，在创建使用它的类的实例时出现以下异常。有什么想法吗？

```
System.ExecutionEngineException: Attempting to JIT compile method 'System.Collections.Concurrent.SplitOrderedList`2<string, System.Collections.Generic.KeyValuePair`2<string, object>>:.ctor (System.Collections.Generic.IEqualityComparer`1<string>)' while running with --aot-only.

  at System.Collections.Concurrent.ConcurrentDictionary`2[System.String,System.Object]..ctor (IEqualityComparer`1 comparer) [0x00000] in <filename unknown>:0
  at System.Collections.Concurrent.ConcurrentDictionary`2[System.String,System.Object]..ctor () [0x00000] in <filename unknown>:0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T17:15:04.753

这是一个[已知](https://bugzilla.xamarin.com/show_bug.cgi?id=3444)问题，因为该类在内部[如何使用泛型。](http://docs.xamarin.com/ios/about/limitations#Limited_Generics_Support)您可以将自己添加到 bug cc 以获得更新/解决的通知。

# javascript - 如何从网站获取所有图像并用 base64 编码替换它们？

> ID：10820404
> 
> 赞同：-1
> 
> 时间：2012-05-30T16:28:55.073
> 
> 标签：javascript, base64

如何从特定网站获取所有图像并将其替换为 base64 编码？服务器端解决方案将起作用。像：

```
var img = document.querySelectorAll("img");
for (var i = 0; i < img.length; i++) {
    //replace with base64 encoding
} 
```

原因：我想创建一个基于 RSS 提要的电子书 (mobi)。我已经将内容转换为 HTML，但图像需要在本地显示。替换图像 base64 看起来是最好的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T14:38:45.977

首先——我不确定这是否特别适用于您的情况——请记住IE ≤ 7`data`不[支持](http://www.caniuse.com/#feat=datauri)URI ，并且 IE 8 的支持不稳定；并且使用URI可能有[很多缺点。](http://dataurl.net/#advantages)`data`

也就是说，有两个地方需要担心：`<img>`标签和 CSS 文件。

我发现[这个工具](http://dataurl.net/#cssoptimizer)`data`可以用它的URI 表示替换样式表中的所有图像引用。

`<img>`在 HTML 页面中，我没有看到任何对 s 做同样的事情，但[构建可以满足您需要的东西并不难](https://stackoverflow.com/a/7651042/201952)。

或者——考虑到对所有图像进行 base64 编码会使文件大小膨胀 33%——你可以使用[HTML5 应用程序缓存](https://developer.mozilla.org/en/HTML/Using_the_application_cache)，它专为离线运行 HTML 页面而设计，[适用](http://www.caniuse.com/#feat=offline-apps)于除 IE ≤ 9 之外的所有内容。（这是我的方法会用。）

只需向元素添加一个`manifest`属性：`<html>`

```
<html manifest="files.appcache">
    ...
</html> 
```

*files.appcache*是一个简单的文本文件：

```
CACHE MANIFEST
http://www.example.com/index.html
http://www.example.com/header.png
http://www.example.com/blah/blah 
```

[MDN 关于应用程序缓存](https://developer.mozilla.org/en/HTML/Using_the_application_cache#Loading_documents)的文章有更深入的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T16:44:14.190

像这样的东西：

jQuery + 画布：

```
$("img").load(function(i) {
    var $this = $(this),
        jCanvas = $("<canvas width='" + $this.width() + "' height='" + $this.height() + "'/>"),
        oCanvas = jCanvas[0];

    oCanvas.getContext("2d").drawImage(this, 0, 0);

    this.src = oCanvas.toDataURL();
}); 
```

但这仅在图像与脚本位于**同一域时才有效。**

演示：http: [//jsfiddle.net/K5RY3/3/](http://jsfiddle.net/K5RY3/3/)

# python - 如何在不会 对我的计算机造成危害的环境中导入模块？（Python）

> ID：10820406
> 
> 赞同：1
> 
> 时间：2012-05-30T16:29:16.587
> 
> 标签：python, import, module, environment, virus

蟒蛇2.7

Windows 7的

我不想下载一堆模块并运行它们。这些模块的程序员可以使它们包含病毒。为了防止这种情况发生，我想在一个不允许它导入任何模块的环境中运行这些模块，除非我指定它可以导入该特定模块（我让它导入的模块是数学模块，或其他模块）包。我会限制的模块是 os 模块。）

这可能是任何形状或形式，即使它不符合我提供的所有规范，或者我必须自己检查代码并确保它正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:32:42.987

使用 CPython 很难正确地做到这一点。PyPy 具有更好的[沙盒功能](http://pypy.org/features.html#sandboxing)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T16:36:50.147

一种选择可能是对不同环境进行虚拟化，要么在较低级别，如使用 VirtualBox (https://www.virtualbox.org/)，要么在更高级别，如使用 virtualenv (http://pypi.python .org/pypi/virtualenv）。

# mysql - 我应该为 0 到 3 之间的值使用什么数据类型

> ID：10820407
> 
> 赞同：1
> 
> 时间：2012-05-30T16:29:17.623
> 
> 标签：mysql, sql, database-design

我在数据库中的字段将只包含 3 个可能的值：0、1 和 2。所以，我想知道我应该使用什么数据类型？我发现[了这个](https://stackoverflow.com/questions/4968495/mysql-smallest-datatype-for-one-bit)，似乎我应该使用 tinyint(1)，但它的范围从 -127 到 126，所以我想知道这是我的选择还是实际上有更好的选择？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T16:30:51.523

`tinyint(1) unsigned`可能适合这个

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T04:01:36.600

不推荐，但是……我最初在想，如果空间真的是一个大问题，这可能值得探索。

如果您可以使用 NULL、0、1 而不是 0、1、2，那么布尔值/位也可以工作。

但是，看起来 boolean 和 tinyint 实际上是相同的。而且 tinyint 在 mysql 中的所有数据类型中占用空间最小。见[链接](http://dev.mysql.com/doc/refman/5.0/en/storage-requirements.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-30T18:28:45.113

如果您希望确保输入的数字仅为 0、1 或 2，那么最好将 CHECK 约束添加到表中。

```
ALTER TABLE
    tableName
ADD CONSTRAINT 
    checkConstain
CHECK (columnName BETWEEN 0 and 2) 
```

你可以看到一个在[SQL Fiddel上工作的例子](http://www.sqlfiddle.com/#!3/719cc)

# c - libcurl 中的宏函数，它返回 libcurl 版本

> ID：10820428
> 
> 赞同：2
> 
> 时间：2012-05-30T16:30:40.373
> 
> 标签：c, libcurl

我正在使用 libcurl 开发 ac 程序。

当我构建我的程序时，我可以使用不同版本的 libcurl。

当我从版本更改为其他（libcurl）时，我必须更改源代码中的一些块以使其适应 libcurl 版本。

我希望在我的代码中添加宏，它将检查 libcurl 版本，然后确定要自动使用哪个源代码块

libcurl 中是否有返回 libcurl 版本的宏函数或常量？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T16:37:16.690

请参阅 curl/curlver.h（包含在您的 中`#include <curl/curl.h>`）。

您可以玩以下号码。

```
#define LIBCURL_VERSION_MAJOR 7
#define LIBCURL_VERSION_MINOR 26
#define LIBCURL_VERSION_PATCH 0 
```

和

```
#define LIBCURL_VERSION_NUM 0x071a00 
```

# html - 在 html 或 css 中，如何将特定单词设置为始终为某种颜色？

> ID：10820437
> 
> 赞同：1
> 
> 时间：2012-05-30T16:31:26.317
> 
> 标签：html, css

我正在使用 html 和 css。我希望某个词始终设置为红色。我可以使用跨度标签将一个单词设置为红色，但我不想每次出现的单词都输入这个，有没有一种“全局”的方式来做到这一点？

谢谢。

让我们说这个词是“猫”顺便说一句。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:33:46.753

你不能。CSS 样式元素，而不是任意的文本。

您可以以编程方式修改文档（服务器端或客户端 JS）以在您关心的单词周围添加额外的标记（例如`<span class="cat">`和）（注意仅更改常规文本节点中的单词，而不是 CDATA 部分或属性值中的单词。`</span>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T16:34:15.787

我认为您需要手动或使用正则表达式使用 Javascript 来执行此操作。一个好的 jQuery 插件是[http://johannburkard.de/blog/programming/javascript/highlight-javascript-text-higlighting-jquery-plugin.html](http://johannburkard.de/blog/programming/javascript/highlight-javascript-text-higlighting-jquery-plugin.html)

# php - 形成插入困境的解决方案

> ID：10820438
> 
> 赞同：0
> 
> 时间：2012-05-30T16:31:28.377
> 
> 标签：php, forms

我正在构建一个虚拟旅游应用程序，并且在设置过程中遇到了一些绊脚石。目前，管理员负责确定哪个站点属于哪个全景图以及下一步的选择。为了完成这个，我需要能够将照片名称与当前站点的其他信息一起插入数据库。

我的表单解决方案是将某个目录的照片名称添加到一个数组中，统计文件夹中的图像数量，并在页面上创建相应数量的迷你表单。每个表单都有自己的通过 ajax 工作的保存按钮，因此所有信息都会在用户完成工作时更新。

我的问题与通过提交过程添加照片名称有关。照片本身不是表单中的用户定义字段，我使用 POST 将变量传递给插入函数。有没有办法在提交之前将文件名包含在 $_POST 数组中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:52:39.577

你必须做的是使用隐藏输入和 value 属性中的文件名。

```
<input type="hidden" name="filename" value="the filename" /> 
```

此外，您可以在 ajax 调用中添加文件名作为参数，但我认为输入更清晰。

# django - django now() 不应该在默认时区吗？

> ID：10820442
> 
> 赞同：7
> 
> 时间：2012-05-30T16:31:31.867
> 
> 标签：django

这可能是一个微不足道的问题，但我不能让 django now() 处于定义的时区`settings.TIME_ZONE`吗？

这就是实际发生的事情：

```
>>> from django.utils import timezone
>>> timezone.now()
datetime.datetime(2012, 5, 30, 16, 30, 0, 782087, tzinfo=<UTC>)
>>> timezone.get_default_timezone()
<DstTzInfo 'Asia/Singapore' SMT+6:55:00 STD> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-08-19T09:08:18.620

Django 的[源代码](https://github.com/django/django/blob/master/django/utils/timezone.py#L223-L231)（如所选答案所示）解释了以下概念`timezone.now()`：

1.  `datetime.now()`产生没有时区信息（“naive datetime”）的当前时间（在您的活动时区！），而...
2.  `timezone.now()` *始终***以 UTC** (!)格式生成当前时间*以及*时区信息。

乍一看，这很烦人，是的。他们本可以决定产生活动时区的当前时间，但他们没有。你仍然可以`timezone.localtime(timezone.now())`用来得到你想要的：

```
from django.utils import timezone
from datetime import datetime

timezone.get_current_timezone()
# <DstTzInfo 'Antarctica/McMurdo' LMT+11:39:00 STD>
datetime.now()
# datetime.datetime(2014, 8, 19, 20, 8, 8, 440959)
timezone.localtime(timezone.now())
# datetime.datetime(2014, 8, 19, 20, 8, 14, 889429, tzinfo=<DstTzInfo 'Antarctica/McMurdo' NZST+12:00:00 STD>)
timezone.now()
# datetime.datetime(2014, 8, 19, 8, 8, 22, 273529, tzinfo=<UTC>)
datetime.utcnow()
# datetime.datetime(2014, 8, 19, 8, 8, 29, 769312) 
```

对于新手和普通用户`timezone.localtime(timezone.now())`来说可能是最直观的。仍保留时区信息的本地时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T16:40:10.007

或者我可以阅读源代码：

```
def now():
    """
    Returns an aware or naive datetime.datetime, depending on settings.USE_TZ.
    """
    if settings.USE_TZ:
        # timeit shows that datetime.now(tz=utc) is 24% slower
        return datetime.utcnow().replace(tzinfo=utc)
    else:
        return datetime.now() 
```

答案是否定的，我必须自己调整。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T16:39:58.697

这取决于

> now() 当 USE_TZ 分别为 True 或 False 时，返回代表当前时间点的感知或幼稚日期时间。

[https://docs.djangoproject.com/en/dev/ref/utils/#django-utils-timezone](https://docs.djangoproject.com/en/dev/ref/utils/#django-utils-timezone)

因此，所有人都表明 USE_TZ 在您的情况下是错误的，并且没有考虑到 TZ。

# c++ - 从内存中读取图像，知道指向内存的指针。VC++

> ID：10820445
> 
> 赞同：-9
> 
> 时间：2012-05-30T16:31:37.440
> 
> 标签：c++, visual-c++

我有一个带有 c++ api 和 SDK 的相机。有一个回调函数返回一个 C++ 指针，指向存储在内存中的一些 RAW 图像数据的起点我想要 1）获取图像 2）将其转换为某种图像格式 3）将其保存到硬盘

指针是 char*

我怎样才能在 VC++ 中做到这一点。谢谢。

编辑：在这里转贴问题： [https ://stackoverflow.com/questions/10826313/reading-image-from-memory-and-painting-it-in-a-vc-mfc-application](https://stackoverflow.com/questions/10826313/reading-image-from-memory-and-painting-it-in-a-vc-mfc-application)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T16:43:44.223

研究[OpenCV](http://opencv.willowgarage.com/wiki/)将图像转换为某种格式，然后将其保存在磁盘上。

你可能也想[看看这篇文章](https://stackoverflow.com/questions/6924790/opencv-create-mat-from-camera-data)。

# php - HTML、PHP 和 MYSQL 图片彼此相邻

> ID：10820450
> 
> 赞同：0
> 
> 时间：2012-05-30T16:32:24.087
> 
> 标签：php, mysql, html, image, show

因此，假设我的服务器上有许多由用户上传的图像。每张图片在数据库中也有一行，其中包含文件名、类别、文件大小、扩展名和位置等信息。

当我想显示这些图像时，我使用 mysql_query 和 while 循环。这行得通，但是图片都有不同的大小，并且它们彼此相邻或彼此下方显示，这看起来非常糟糕。

假设我有 20 张这样的图像，我怎样才能将 5 张图像并排显示，4 行长？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T16:49:14.010

假设包含图像数据的数字索引对象数组：

```
<div class="row">
<?php
// loop through all my images taking the index and image object
foreach( $images as $idx=>$image ) {

    // If this isn't the 1st image & the modulus of 5 and $idx is 0, make a new row.
    if( $idx > 0 && !(5%$idx) ) {
        </div><div class="row">
    }
    // Print out the image
    echo '<img src="' . $image->filename . '" />';
} ?>
</div> 
```

如果将第一个数字除以第二个数字，则模数基本上是余数。因此，当我们打印了 5 张图像时，5/5=1 没有余数，所以我们创建了一个新行。

我相信这会创造出类似的东西：

```
<div class="row">
<img src="img1.jpg" />
<img src="img2.jpg" />
<img src="img3.jpg" />
<img src="img4.jpg" />
<img src="img5.jpg" />
</div>
<div class="row">
<img src="img6.jpg" />
<img src="img7.jpg" />
<img src="img8.jpg" />
<img src="img9.jpg" />
<img src="img10.jpg" />
</div> 
```

然后可以使用 CSS 设置样式：

```
<style type="text/css">
    div.row {
       clear:left;
    }
    div.row img {
       float:left;
    }
</style> 
```

在调整图像大小时，您有 2 个选项：

1.  简单的选项：在 CSS 中设置图像宽度（高度将相应缩放）。这并不完美，如果图像具有不同的纵横比（宽度与高度），看起来仍然很乱。
2.  使用 GD 或 imagick（imagemagick 之上的 PHP 层）等 PHP 库调整大小（并在必要时进行裁剪）。我个人更喜欢 GD，因为它与 PHP 打包在一起，因此得到了更广泛的支持。也就是说，imagick 是更快、更简单的代码，所以这取决于你。[这个网站](http://www.fliquidstudios.com/2009/05/07/resizing-images-in-php-with-gd-and-imagick/)很好地比较了两者之间的图像调整大小。

编辑：在回答你的问题时，你需要做这样的事情来获取图像数组：

```
<?php
// Build an array of images
$sql = 'SELECT * FROM images';
$result = mysql_query( $sql );

while( $obj = mysql_fetch_object( $result ) ) {
    $images[] = $obj;
}
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T16:48:40.250

伪代码

```
$i = 0;
while($row = mysql_fetch_object($result) {
   //displaying image
   ....
   if($i % 4 == 0) {
          echo '<BR>';
   }
   $i++;
} 
```

# java - if 语句不起作用，跳到 else

> ID：10820452
> 
> 赞同：-1
> 
> 时间：2012-05-30T16:32:33.410
> 
> 标签：java, if-statement

我的“if”语句似乎不起作用，无论我输入什么似乎总是默认为我的“else”语句。例如，如果我输入整数“1”或“2”，其中有“if”语句与之关联，它仍然默认为“else”。任何帮助，将不胜感激 ：）

```
String number = JOptionPane.showInputDialog("Would you like a custom loop count or an infinite? 1\.  Custom   2\. Infinite"); //test choice
n = Integer.parseInt(number);
while (n < 0 || n > 2) {
    if (n == 1) {

        String number2 = JOptionPane.showInputDialog("How many times would you like to loop?");
        integer = Integer.parseInt(number2);
        while (integer < 0) {
            while (x < integer) {
                g.drawString("hi", 200, y);

                x += 1;
                y = y + 40; //test
            }//end while
        }
    }//end if 
    else if (n == 2) {
        while (1 == 1);
    }//end if   
    else;
}
g.drawString("Please pick a valid choice", 200, 200); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-30T16:35:16.580

如果块之后

```
while (n<0 || n>2) 
```

被执行，你知道它`n`是 < 0 或 > 2。因此它不能等于 1 或 2 并且`else`块被执行，**它恰好是空**的，因为它后面跟着 a `;`。

这还没有提到您的代码中发现的一些奇怪的语句；-)

ps：我已经编辑了您的帖子，以在您的代码中添加适当的缩进并包含`{`和`}`. 现在可能看起来更清楚了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T16:35:06.810

```
else; 
```

这是非常错误的。您没有 else 语句，这意味着执行了以下代码行。

这条线也很糟糕：

```
while (1==1); 
```

请按照规范缩进并删除不需要的';'。

# c# - 反射性能 - 创建委托（C# 属性）

> ID：10820453
> 
> 赞同：26
> 
> 时间：2012-05-30T16:32:37.777
> 
> 标签：c#, reflection, action, expression, setvalue

我在使用反射时遇到性能问题。
所以我决定为我的对象的属性创建委托，到目前为止得到了这个：

```
TestClass cwp = new TestClass();
var propertyInt = typeof(TestClass).GetProperties().Single(obj => obj.Name == "AnyValue");
var access = BuildGetAccessor(propertyInt.GetGetMethod());
var result = access(cwp); 
```

```
static Func<object, object> BuildGetAccessor(MethodInfo method)
{
    var obj = Expression.Parameter(typeof(object), "o");

    Expression<Func<object, object>> expr =
        Expression.Lambda<Func<object, object>>(
            Expression.Convert(
                Expression.Call(
                    Expression.Convert(obj, method.DeclaringType),
                    method),
                typeof(object)),
            obj);

    return expr.Compile();
} 
```

结果非常令人满意，比使用传统方法快约 30-40 倍 ( `PropertyInfo.GetValue (obj, null);`)

问题是：**我怎样才能使`SetValue`一个属性，它的工作方式相同？可惜没有办法。**

我这样做是因为由于`<T>`我的应用程序的结构，我不能使用方法。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-30T17:01:35.737

这应该适合你：

```
static Action<object, object> BuildSetAccessor(MethodInfo method)
{
    var obj = Expression.Parameter(typeof(object), "o");
    var value = Expression.Parameter(typeof(object));

    Expression<Action<object, object>> expr =
        Expression.Lambda<Action<object, object>>(
            Expression.Call(
                Expression.Convert(obj, method.DeclaringType),
                method,
                Expression.Convert(value, method.GetParameters()[0].ParameterType)),
            obj,
            value);

    return expr.Compile();
} 
```

用法：

```
var accessor = BuildSetAccessor(typeof(TestClass).GetProperty("MyProperty").GetSetMethod());
var instance = new TestClass();
accessor(instance, "foo");
Console.WriteLine(instance.MyProperty); 
```

与`TestClass`：

```
public class TestClass 
{
    public string MyProperty { get; set; }
} 
```

打印出来：

> 富

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-04-18T09:16:24.223

`CreateDelegate`如果性能是关键，我认为你最好使用构造。由于您事先知道方法的签名，这里只是`GetGetMethod`和`GetSetMethod`，`PropertyInfo`您可以创建一个委托来直接执行具有相同签名的方法。如果您需要为委托构建一些逻辑（您没有方法句柄），表达式会更适合。我对解决此问题的不同途径进行了一些基准测试：

```
Func<S, T> Getter;
Action<S, T> Setter;
PropertyInfo Property;
public void Initialize(Expression<Func<S, T>> propertySelector)
{
    var body = propertySelector.Body as MemberExpression;
    if (body == null)
        throw new MissingMemberException("something went wrong");

    Property = body.Member as PropertyInfo;

    //approaches:

    //Getter = s => (T)Property.GetValue(s, null);

    //Getter = memberSelector.Compile();

    //ParameterExpression inst = Expression.Parameter(typeof(S));
    //Getter = Expression.Lambda<Func<S, T>>(Expression.Property(inst, Property), inst).Compile();

    //var inst = Expression.Parameter(typeof(S));
    //Getter = Expression.Lambda<Func<S, T>>(Expression.Call(inst, Property.GetGetMethod()), inst).Compile();

    //Getter = (Func<S, T>)Delegate.CreateDelegate(typeof(Func<S, T>), Property.GetGetMethod());

    //Setter = (s, t) => Property.SetValue(s, t, null);

    //var val = Expression.Parameter(typeof(T));
    //var inst = Expression.Parameter(typeof(S));
    //Setter = Expression.Lambda<Action<S, T>>(Expression.Call(inst, Property.GetSetMethod(), val),
    //                                         inst, val).Compile();

    //Setter = (Action<S, T>)Delegate.CreateDelegate(typeof(Action<S, T>), Property.GetSetMethod());
}

//Actual calls (tested under loop):
public T Get(S instance)
{
    //direct invocation:
    //return (T)Property.GetValue(instance, null);

   //calling the delegate:
   //return Getter(instance);
}
public void Set(S instance, T value)
{
    //direct invocation:
    //Property.SetValue(instance, value, null);

   //calling the delegate:
   //Setter(instance, value);
} 
```

> **大约 10000000 次调用的结果 - （获取，设置）：**
> 
> GetValue-SetValue（直接）：3800 毫秒、5500 毫秒
> 
> GetValue-SetValue（委托）：3600 毫秒、5300 毫秒
> 
> 编译表达式：
> 
> ```
>  Get: Expression.Property: 280 ms
> 
>         Expression.Call: 280 ms
> 
>         direct compile: 280 ms
>    Set: 300 ms 
> ```
> 
> 创建委托：130 毫秒、135 毫秒
> 
> 直接属性调用：70 ms、70 ms

在你的情况下，我会写：

```
public static Func<S, T> BuildGetAccessor<S, T>(Expression<Func<S, T>> propertySelector)
{
    return propertySelector.GetPropertyInfo().GetGetMethod().CreateDelegate<Func<S, T>>();
}

public static Action<S, T> BuildSetAccessor<S, T>(Expression<Func<S, T>> propertySelector)
{
    return propertySelector.GetPropertyInfo().GetSetMethod().CreateDelegate<Action<S, T>>();
}

// a generic extension for CreateDelegate
public static T CreateDelegate<T>(this MethodInfo method) where T : class
{
    return Delegate.CreateDelegate(typeof(T), method) as T;
}

public static PropertyInfo GetPropertyInfo<S, T>(this Expression<Func<S, T>> propertySelector)
{
    var body = propertySelector.Body as MemberExpression;
    if (body == null)
        throw new MissingMemberException("something went wrong");

    return body.Member as PropertyInfo;
} 
```

所以现在你打电话：

```
TestClass cwp = new TestClass();
var access = BuildGetAccessor((TestClass t) => t.AnyValue);
var result = access(cwp); 
```

不是更简单吗？？[在这里](https://stackoverflow.com/questions/6158768/c-sharp-reflection-fastest-way-to-update-a-property-value?lq=1)写了一个通用类来处理确切的事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-30T16:47:52.623

使用动态类型。他们在引擎盖下使用反射，但速度*要*快得多。

除此以外...

有大量免费的更快的反射库具有许可许可证。我会链接你，但是太多了，我不确定哪个适合你。只需搜索 codeplex 等。当你找到你喜欢的东西时，试试看。

但是，是的，也许在那之前，想想反思是否真的*是*答案。通常还有其他解决方案。

编辑：根据要求...

[http://geekswithblogs.net/SunnyCoder/archive/2009/06/26/c-4.0-dynamics-vs.-reflection.aspx](http://geekswithblogs.net/SunnyCoder/archive/2009/06/26/c-4.0-dynamics-vs.-reflection.aspx)
[http://theburningmonk.com/2010/09/performance-test-dynamic-method-调用-in-csharp-4/](http://theburningmonk.com/2010/09/performance-test-dynamic-method-invocation-in-csharp-4/)
[http://www.mssoftwareconsulting.com/msswc/blog/post/C-40-and-dynamic-performance.aspx](http://www.mssoftwareconsulting.com/msswc/blog/post/C-40-and-dynamic-performance.aspx)

据我所知，这是常识。

# wolfram-mathematica - Nsolve rantz 无法绘制

> ID：10820463
> 
> 赞同：2
> 
> 时间：2012-05-30T16:33:15.560
> 
> 标签：wolfram-mathematica

我有一个问题要在 Mathematica 中绘制一个 equotations 系统的解决方案。我的报价系统有两个变量（s12 和 t）。不可能明确地解决它（s12:=f(t)），但我能够为每个正 t 得到一个解决方案。但我想要的是在 x-achses 上带有 t 和在 y-achses 上带有 s12(t) 的图。

我最好的猜测是，因为我总是得到带有注释“ `*Solve::ratnz: Solve was unable to solve the system with inexact coefficients. The answer was obtained by solving a corresponding exact system and numericizing the result*`”的单一解决方案，这不适用于数学的无限解决方案。

我可能不得不取消这个警告，或者有人有其他想法吗？我只需要一个粗略的情节。

问题如下：

```
ClearAll["Global`*"];
cinv1 = 40;
cinv2 = 4;
cinv3 = 3;
h2 = 1.4;
h3 = 1.2;
alpha = 0.04;
z = 20;
p = 0.06;
cop1 = 0;
cop2 = 1;
cop3 = 1.5;
l2 = 0.1;
l3 = 0.17;
teta2 = 0.19;
teta3 = 0.1;
co2 = -0.1;

smax = 40;
c = 1;

Plot[Solve[{s12 == ((cinv1 - 
         cinv2) + ((cinv2 - cinv3)*((s12 teta2)/(
          Sqrt[ (teta2 - teta3)] Sqrt[
           c s12^2 teta2 - (2 alpha z)/c]))))/((1/(teta2 - 
           teta3))*((teta2*cop3 - teta3*cop2) + (teta2*h3*l3*E^(p*t) -
            teta3*h2*l2*E^(p*t)))), s12 > 0}, s12, Reals], {t, 0, 10}] 
```

如前所述，当我使用特定的 t 时，我会得到一个解决方案，否则我会收到如下消息：

```
"*Solve::ratnz: Solve was unable to solve the system with inexact coefficients. The answer was obtained by solving a corresponding exact system and numericizing the result*"
"*Solve::ratnz: Solve was unable to solve the system with inexact coefficients. The answer was obtained by solving a corresponding exact system and numericizing the result*"
"*Solve::ratnz: Solve was unable to solve the system with inexact coefficients. The answer was obtained by solving a corresponding exact system and numericizing the result*"
*"General::stop: "Further output of \!\(\*
StyleBox[
RowBox[{\"Solve\", \"::\", \"ratnz\"}], \"MessageName\"]\) will be suppressed during this calculation""* 
```

非常感谢您的帮助，安德烈亚斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T09:01:15.507

系统有 4 个解，其中 3 个在感兴趣的范围内为正：

```
s2 = Solve[{s12 - ((cinv1 - cinv2) + ((cinv2 - cinv3) ((s12 teta2)/
          (Sqrt[(teta2 - teta3)] Sqrt[c s12^2 teta2 - (2 alpha z)/c]))))/
           ((1/(teta2 - teta3))*((teta2*cop3 - teta3*cop2) + 
           (teta2*h3*l3*E^(p*t) - teta3*h2*l2*E^(p*t))))} == 0, s12];
Plot[s12 /. s2 , {t, 0, 59}] 
```

![在此处输入图像描述](../Images/3d22cedfa8efaeb4f6fef53c254f38e3.png)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-19T12:50:29.187

要补充的重要事实：

上面提出的解决方案是正确的，但它使用复数来解决。上述解决方案中的图表仅显示了复数的实部。这可能会导致一些混乱，就像它对我一样。

不过，有一个只有实数的解决方案。由于 Mathematica 无法以“连续方式”用实数求解方程，所以我最后做了一个三步法：

1.  我在离散的时间点解决了方程
2.  我用 ListLinePlot 绘制了解决方案。
3.  我使用 Interpolation[] 来粗略检测与其他曲线的交点

    `a = Table[NSolve[{s12 - ((cinv1 - cinv2) + ((cinv2 - cinv3)*((s12 teta2)/(\[Sqrt] (teta2 - teta3) \[Sqrt](c s12^2 teta2 - (2 alpha z)/c)))))/ ((1/(teta2 - teta3))*((teta2*cop3 -teta3*cop2) + (teta2*h3*l3*E^(p*t) - teta3*h2*l2*E^(p*t)))) == 0}, s12][[1]], {t, 0, 100}];`

    `b = Table[t, {t, 0, 100}];`

    ```
    f1a = s12 /. a;

    f1 = Transpose[{b, f1a}];

    ceiling1 = ListLinePlot[{f1},
    PlotRange -> {{0, 20}, {0, 40}},PlotStyle -> {Black, Dotted, Thickness[0.003]}]; 
    ```

在下一步中，我还需要找到以这种方式创建的多条曲线的交点。为了**粗略**估计，我做了以下工作：

```
curve1 = Interpolation[f1];
intersec2a = FindRoot[curve1[x2] - t12[x2, l2], {x2, 0}];
intersec2 = x2 /. intersec2a; 
```

希望这可以帮助

# android - 我怎么知道我的申请来自哪里？

> ID：10820465
> 
> 赞同：1
> 
> 时间：2012-05-30T16:33:18.213
> 
> 标签：android, google-play, package-managers

我需要你的帮助。我有两个问题！

1) 我如何知道我下载的应用程序来自哪里？谷歌播放或其他。

我使用类似的东西来获取有关已安装软件包的一些信息；但我没有找到获取包裹从哪里来的方法！[http://myandroidStore.com/myNewGame.apk](http://myandroidStore.com/myNewGame.apk)为例。

```
List<PackageInfo> packages = getActivity() .getPackageManager()
                       .getInstalledPackages(0);

for (int i=0; i<packages.size(); i++) {     
PackageInfo packageInfo = packages.get(i);
AppList tmpList = new AppList();
tmpList.applicationName = packageInfo.applicationInfo.loadLabel(getActivity()
                .getPackageManager()).toString();

tmpList.packageName = packageInfo.packageName; 
tmpList.versionName = packageInfo.versionName; 
tmpList.versionCode = packageInfo.versionCode; 

tmpList.provider = packageInfo.providers;
tmpList.firstInstallTime = packageInfo.firstInstallTime;
tmpList.lastUpdateTime = packageInfo.lastUpdateTime;
tmpList.signatures = packageInfo.signatures;
} 
```

2) 如果未选择“未知来源”，我无法下载 Google Play 以外的应用程序。您知道 Android 如何检查此验证吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T17:30:18.493

> 1) 我如何知道我下载的应用程序来自哪里？谷歌播放或其他。

AFAIK 系统无法为您提供获取此信息的方法。如果您有兴趣获得它，则必须制作单独的 apk 文件，其中嵌入了一些独特的东西，这样您就可以根据运行时 apk 来自的唯一字符串知道。

> 2) 如果未选择“未知来源”，我无法下载 Google Play 以外的应用程序。您知道 Android 如何检查此验证吗？

我假设 PackageManager 是对此进行检查的原因。不过不确定。

# c# - 无法使用 ssh 客户端连接到 mysql 数据库

> ID：10820467
> 
> 赞同：0
> 
> 时间：2012-05-30T16:33:24.920
> 
> 标签：c#, mysql, database, connection-string

我想通过 SSH 通道连接到服务器上的 mysql 数据库。

我已经下载了这个[SSH.Net](http://sshnet.codeplex.com/)库。

这是我尝试过的，我认为在建立安全连接后它会起作用。

我的 SSH 连接已建立，但未执行与数据库的正常连接。

所以请检查我的代码：

```
using (var client = new SshClient("cpanel****", "******", "******"))
          {
            client.Connect();
            con = new MySqlConnection(GetConnectionString());
            con.Open();
            cmd = new MySqlCommand(String.Format("insert into {0} values (null, ?Parname , ?Parname2, ?Parname3, ?Parname4, ?Parname5, ?Parname6, ?Parname7);", ConfigSettings.ReadSetting("main")), con);
            cmd.Parameters.Add("?Parname", MySqlDbType.Double).Value = Math.Round(deciLat, 5);
            // ... more parameters
            cmd.ExecuteNonQuery();
            client.Disconnect();
           } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:54:57.820

这是一个教程[http://georgelantz.com/2007/09/10/access-mysql-through-ssh-tunnel-in-a-windows-net-application/](http://georgelantz.com/2007/09/10/access-mysql-through-ssh-tunnel-in-a-windows-net-application/)听起来很合理。

基本思想是通过隧道（又名端口转发）建立 SSH 连接，然后将 MySQL 连接指向 localhost。

SSH 隧道将连接到 localhost:XX 重定向到 ssh 服务器端口:YY。所以你的端口 YY 将是 mysql 连接端口，在你的连接字符串中你将使用 localhost:XX。

您正在使用的 SSH 库似乎也支持端口转发，因此您也可以使用它。

# asp.net - 必须按两次 Enter 才能使函数工作 C#

> ID：10820471
> 
> 赞同：2
> 
> 时间：2012-05-30T16:33:44.217
> 
> 标签：asp.net, function, enter

我有以下 .aspx 页面。我正在搜索数据库中的单词，一切正常。我还有一个超链接，如果数据库中不存在该词，它会显示一条消息。

但唯一的问题是当我搜索这个词并且这个词不在数据库中时，它从第一次开始就没有显示超链接，我必须点击两次才能让它工作，然后点击两次它才能消失.

我知道问题是我在 page_load 之后有按钮，但我找不到它的解决方案。我尝试的是创建另一个函数 private void load_data() 并将 page_load 中的所有内容复制到其中。在 load_page 和 button2_click 中调用 load_data(); 它不起作用。

这是代码：

```
namespace TRI_Portal.ScreenPop.Gloss
{
    public partial class Gloss_Test : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            if (GridView2.Rows.Count == 0)
            {

                HyperLink1.Visible = true;
            }

            else
            {
                HyperLink1.Visible = false;
            }

            String s = Request.QueryString["language"];

            Language1.Text = Server.HtmlEncode(s);

        }    

      }
    } 
```

我也试过这个，但没有运气。

```
 protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            SetLink();
        }
    }
    private void SetLink()
    {
        if (GridView2.Rows.Count == 0)
        {

            HyperLink1.Visible = true;
        }

        else
        {
            HyperLink1.Visible = false;
        }

        String s = Request.QueryString["language"];

        Language1.Text = Server.HtmlEncode(s);
    }
    protected void Button2_Click(object sender, EventArgs e)
    {
        SetLink();
    } 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T21:27:20.430

处理 GridView.DataBound 事件

```
protected void GridView1_DataBound(object sender, EventArgs e)
{
     SetLink();
} 
```

和标记：

```
<asp:GridView OnDataBound="GridView1_DataBound" .... 
```

从 Page_Load 事件中删除代码。

# visual-studio-2010 - VS 2010 数据库项目部署未部署索引

> ID：10820477
> 
> 赞同：0
> 
> 时间：2012-05-30T16:34:10.367
> 
> 标签：visual-studio-2010, database-deployment

我在 Visual Studio 2010 中有一个数据库项目，可以毫无问题地将表和存储过程部署到服务器。但是，没有一个索引脚本包含在 sql 输出脚本中，因此没有得到应用。

我一直无法找到任何解决此问题的方法。我不知道我错过了什么。索引脚本的“构建操作”属性设置为“构建”，我在 .sqldeployment 或 .sqlsettings 文件中看不到任何关于索引部署的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T17:18:35.917

我发现了这个问题。当我团队中的任何人对他们的本地数据库进行架构比较时，VS 会阻止注释索引脚本，因为这些索引在本地不存在。一旦我发现这一点并取消注释脚本，索引就会再次包含在部署中。

# javascript - 学习 node.js 的先决条件？

> ID：10820480
> 
> 赞同：2
> 
> 时间：2012-05-30T16:34:24.720
> 
> 标签：javascript, node.js

我想学习 Node.js。我敢肯定，我需要良好的 Javascript (OOP) 经验。还有其他我应该知道的技术来学习它吗？考虑到我在 Javascript 方面有不错的经验，我开始实施 node.js 需要多长时间？

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T16:50:06.500

[http://www.crockford.com/javascript/inheritance.html](http://www.crockford.com/javascript/inheritance.html)

> JavaScript 是一种无类、面向对象的语言，因此它使用原型继承而不是经典继承。这可能会让受过传统面向对象语言（如 C++ 和 Java）培训的程序员感到困惑。正如我们即将看到的，JavaScript 的原型继承比经典继承具有更强的表现力。

Javascript 和 Java 是两种不同的野兽。

> 我写 JavaScript 已经 8 年了，我从来没有发现需要使用 uber 函数。超级想法在经典模式中相当重要，但在原型和功能模式中似乎是不必要的。我现在认为我早期在 JavaScript 中支持经典模型的尝试是错误的。

* * *

有些事情我认为你应该研究一下。

*   使用例如[mocha 之](https://github.com/visionmedia/mocha)类的框架彻底测试您的代码非常重要。
*   学习[npm](http://npmjs.org/)发布自己的模块并[搜索](http://search.npmjs.org/)其他模块。
*   一个数据库，例如 mysql、mongodb 或[redis](http://redis.io)，以及如何在 node.js 中使用它们。我个人非常喜欢[redis 客户端库](https://github.com/mranney/node_redis)，因为它的速度非常快。
*   [Git（集线器）](http://github.com)将您的代码放入存储库（SCM）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T18:10:19.860

除了所有类型的 JavaScript 编程经验（不需要 OOP）并且根据您以前的编程技能，掌握以下基本知识也很有帮助：

*   Posix API（什么是文件描述符？什么是管道？）
*   什么是 HTTP？HTTP 是如何工作的？

# php - 在一个查询中选择多个mysql，然后分别访问它们

> ID：10820484
> 
> 赞同：1
> 
> 时间：2012-05-30T16:34:31.450
> 
> 标签：php, mysql

我想一次执行两个选择查询，但数据彼此不相关，因此 LEFT JOIn 等不会这样做..因为那样我最终得到了我无法使用的数据。

到目前为止我得到的是；

```
$sql .= "SELECT *,
        servertypes.id as servertypeID, 
        servertypes.name as servertypeName 
       FROM servertypes";

$sql .= " JOIN".
    " (SELECT *,
        periods.id as periodID,
        periods.daysForSorting as periodNumber,
        periods.text as periodsText
       FROM periods
       ) AS periods";

$res = mysql_query($sql);
if(!$res) die("database_error_cant_select_data : ".$sql." : ".mysql_error()); 
```

但是现在我如何分别访问`servertypes`和访问`periods`？我想我必须完全停止使用 JOIN 但我不知道......

为了说明我的意思，它类似于：

```
while ($row = mysql_fetch_assoc($res["servertypes"]))
{
    print_r($row);
    echo"<br/><br/>";
}

while ($row = mysql_fetch_assoc($res["periods"]))
{
    print_r($row);
    echo"<br/><br/>";
} 
```

这可能只使用一个查询吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T16:40:38.840

通常，如果两个查询都返回相同的列号，您可以执行类似的操作

```
Table1
-----------
ProductID
Price
Qty

Table2
-----------
ProductID
Price
Qty

$Query = '(SELECT "Table1" AS Source, * FROM Table1) UNION (SELECT "Table2" AS Source, * FROM Table2)';

$Data = array('T1' => array(), 'T2' => array());
while($Assoc = mysql_fetch_assoc($Query)){
    switch(strtoupper($Assoc['Source'])){
        case 'TABLE1':
            $Data['T1'][] = $Assoc;
            break;

        case 'TABLE2':
            $Data['T2'][] = $Assoc;
            break;

        default:
            break;
    }
}

//  $Data['T1'] now hold everything from Table1
//  $Data['T2'] now hold everything from Table2 
```

但在这里，没有什么是相关的。所以回答你的问题：不，你不能做你想做的事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T16:41:55.403

查看 multi_query() / use_result() / next_result() 函数，这里是示例：

[http://www.robert-gonzalez.com/2007/06/01/mysql-multiple-result-procs-in-php/](http://www.robert-gonzalez.com/2007/06/01/mysql-multiple-result-procs-in-php/)

理想情况下，我会远离需要这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T16:42:06.387

在一个查询中加入数据是没有意义的。您尝试加入的实体完全不同，彼此之间没有链接。如果您单独使用它们，请进行单独的查询

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-30T16:44:22.303

如果必须一起选择它们（以避免竞争条件），那么您应该使用事务。

```
begin transaction;
.....queries....
commit; 
```

# jakarta-ee - 泽西岛和过滤器异常处理

> ID：10820485
> 
> 赞同：5
> 
> 时间：2012-05-30T16:34:42.603
> 
> 标签：jakarta-ee, servlets, jersey, jax-rs, servlet-filters

我有一个配置了 Spring Security 处理身份验证的 Jersey 应用程序。jersey-spring 包提供了在我的 web.xml 中注册为 servlet 的 SpringServlet 类。

身份验证和所有工作都按预期进行。我想知道的是如何通过 Jersey servlet 发送 AuthenticationExceptions（和其他过滤器异常），这样我就可以使用我们的 ExceptionMapper 来处理它们。

最初 SpringServlet 被配置为过滤器，但在阅读了一些内容后，我了解到 servlet 应该能够处理过滤器中抛出的异常（也许这是一个不正确的理解）。将其更改为 servlet 后，我​​没有注意到任何行为变化，如果我跟踪 Spring Security 代码，我可以看到 HttpServletResponse 的编写位置。

我的问题：Spring Security 过滤器是否可以抛出 Jersey servlet 进程异常？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-04T14:56:11.263

你如何做取决于你是从 Spring Security 调用 Jersey，还是从 Jersey 调用 Spring Security。

如果您从 Jersey 容器内部调用 Spring Security，那么除了为适当的异常定义异常映射器之外，您不需要做任何事情。

如果您仅在客户端通过 Spring Security 过滤器时调用 Jersey，那么当客户端请求通过这些过滤器时抛出的任何异常都不会被 Jersey 捕获（因为请求尚未进入 Jersey 容器）。将异常“获取”到 Jersey 容器中的一种方法是：

1.  在自定义身份验证过滤器中捕获`AuthenticationException`并调用该`AuthenticationFailureHandler.onAuthenticationFailure()`方法（传入异常），并确保通过*不*调用来中断过滤器链`FilterChain.doFilter()`
2.  将您配置`AuthenticationFailureHandler`为调用您设计的 Jersey 资源，该资源将检索（然后重新抛出）Spring 生成的任何异常`HttpServletRequest.getAttribute(WebAttributes.AUTHENTICATION_EXCEPTION)`

可能还有其他方法可以将异常“获取”到泽西岛，但这是过去对我有用的一种方法。

# iphone - iPhone 加速框架 FFT 与 Matlab FFT

> ID：10820488
> 
> 赞同：8
> 
> 时间：2012-05-30T16:34:50.187
> 
> 标签：iphone, objective-c, matlab, fft, accelerate-framework

我没有太多的数学背景，但我正在从事的项目的一部分需要单个向量的 FFT。matlab 函数 fft(x) 可以准确地满足我的需要，但是在尝试设置 Accelerate Framework fft 函数后，我得到的结果完全不准确。如果有人对 Accelerate Framework fft 有更多的专业知识/经验，我真的可以使用一些帮助来找出我做错了什么。我的 fft 设置基于我在 google 上找到的一个示例，但没有教程或任何产生不同结果的东西。

**EDIT1：根据迄今为止的答案改变了一些东西。它似乎在进行计算，但它不会以任何接近 matlab 的方式输出它们**

这是 matlab 的 fft 文档：http: [//www.mathworks.com/help/techdoc/ref/fft.html](http://www.mathworks.com/help/techdoc/ref/fft.html)

** 注意：出于示例目的，两个示例中的 x 数组将为 {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16}

Matlab代码：

```
x = fft(x) 
```

Matlab输出：

```
x =

   1.0e+02 *

  Columns 1 through 4

   1.3600            -0.0800 + 0.4022i  -0.0800 + 0.1931i  -0.0800 + 0.1197i

  Columns 5 through 8

  -0.0800 + 0.0800i  -0.0800 + 0.0535i  -0.0800 + 0.0331i  -0.0800 + 0.0159i

  Columns 9 through 12

  -0.0800            -0.0800 - 0.0159i  -0.0800 - 0.0331i  -0.0800 - 0.0535i

  Columns 13 through 16

  -0.0800 - 0.0800i  -0.0800 - 0.1197i  -0.0800 - 0.1931i  -0.0800 - 0.4022i 
```

苹果加速框架：http: [//developer.apple.com/library/mac/#documentation/Accelerate/Reference/vDSPRef/Reference/reference.html#//apple_ref/doc/uid/TP40009464](http://developer.apple.com/library/mac/#documentation/Accelerate/Reference/vDSPRef/Reference/reference.html#//apple_ref/doc/uid/TP40009464)

目标C代码：

```
int log2n = log2f(16);

FFTSetupD fftSetup = vDSP_create_fftsetupD (log2n, kFFTRadix2);     

DSPDoubleSplitComplex fft_data;
fft_data.realp = (double *)malloc(8 * sizeof(double));
fft_data.imagp = (double *)malloc(8 * sizeof(double));

vDSP_ctoz((COMPLEX *) ffx, 2, &fft_data, 1, nOver2); //split data (1- 16) into odds and evens

vDSP_fft_zrip (fftSetup, &fft_data, 1, log2n, kFFTDirection_Forward); //fft forward

vDSP_fft_zrip (fftSetup, &fft_data, 1, log2n, kFFTDirection_Inverse); //fft inverse

vDSP_ztoc(&fft_data, 2, (COMPLEX *) ffx, 1, nOver2); //combine complex back into real numbers 
```

目标 C 输出：

ffx 现在包含：

```
272.000000
-16.000000
-16.000000
-16.000000
0.000000
0.000000
0.000000
0.000000
0.000000
10.000000
11.000000
12.000000
13.000000
14.000000
15.000000
16.000000 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-30T19:43:31.960

一个大问题：C 数组从 0 开始索引，这与基于 1 的 MATLAB 数组不同。所以你需要改变你的循环

```
for(int i = 1; i <= 16; i++) 
```

到

```
for(int i = 0; i < 16; i++) 
```

第二个大问题 - 您正在混合单精度 ( `float`) 和双精度 ( `double`) 例程。你的数据是`double`你应该使用`vDSP_ctozD`的，不是`vDSP_ctoz`，`vDSP_fft_zripD`而不是`vDSP_fft_zrip`，等等。

另一件需要注意的事情：不同的 FFT 实现使用不同的 DFT 公式定义，特别是在比例因子方面。看起来 MATLAB FFT 包含一个 1/N 缩放校正，而大多数其他 FFT 没有。

* * *

这是一个完整的工作示例，其输出匹配 Octave（MATLAB 克隆）：

```
#include <stdio.h>
#include <stdlib.h>
#include <Accelerate/Accelerate.h>

int main(void)
{
    const int log2n = 4;
    const int n = 1 << log2n;
    const int nOver2 = n / 2;

    FFTSetupD fftSetup = vDSP_create_fftsetupD (log2n, kFFTRadix2);

    double *input;

    DSPDoubleSplitComplex fft_data;

    int i;

    input = malloc(n * sizeof(double));
    fft_data.realp = malloc(nOver2 * sizeof(double));
    fft_data.imagp = malloc(nOver2 * sizeof(double));

    for (i = 0; i < n; ++i)
    {
       input[i] = (double)(i + 1);
    }

    printf("Input\n");

    for (i = 0; i < n; ++i)
    {
        printf("%d: %8g\n", i, input[i]);
    }

    vDSP_ctozD((DSPDoubleComplex *)input, 2, &fft_data, 1, nOver2);

    printf("FFT Input\n");

    for (i = 0; i < nOver2; ++i)
    {
        printf("%d: %8g%8g\n", i, fft_data.realp[i], fft_data.imagp[i]);
    }

    vDSP_fft_zripD (fftSetup, &fft_data, 1, log2n, kFFTDirection_Forward);

    printf("FFT output\n");

    for (i = 0; i < nOver2; ++i)
    {
        printf("%d: %8g%8g\n", i, fft_data.realp[i], fft_data.imagp[i]);
    }

    for (i = 0; i < nOver2; ++i)
    {
        fft_data.realp[i] *= 0.5;
        fft_data.imagp[i] *= 0.5;
    }

    printf("Scaled FFT output\n");

    for (i = 0; i < nOver2; ++i)
    {
        printf("%d: %8g%8g\n", i, fft_data.realp[i], fft_data.imagp[i]);
    }

    printf("Unpacked output\n");

    printf("%d: %8g%8g\n", 0, fft_data.realp[0], 0.0); // DC
    for (i = 1; i < nOver2; ++i)
    {
        printf("%d: %8g%8g\n", i, fft_data.realp[i], fft_data.imagp[i]);
    }
    printf("%d: %8g%8g\n", nOver2, fft_data.imagp[0], 0.0); // Nyquist

    return 0;
} 
```

输出是：

```
Input
0:        1
1:        2
2:        3
3:        4
4:        5
5:        6
6:        7
7:        8
8:        9
9:       10
10:       11
11:       12
12:       13
13:       14
14:       15
15:       16
FFT Input
0:        1       2
1:        3       4
2:        5       6
3:        7       8
4:        9      10
5:       11      12
6:       13      14
7:       15      16
FFT output
0:      272     -16
1:      -16 80.4374
2:      -16 38.6274
3:      -16 23.9457
4:      -16      16
5:      -16 10.6909
6:      -16 6.62742
7:      -16  3.1826
Scaled FFT output
0:      136      -8
1:       -8 40.2187
2:       -8 19.3137
3:       -8 11.9728
4:       -8       8
5:       -8 5.34543
6:       -8 3.31371
7:       -8  1.5913
Unpacked output
0:      136       0
1:       -8 40.2187
2:       -8 19.3137
3:       -8 11.9728
4:       -8       8
5:       -8 5.34543
6:       -8 3.31371
7:       -8  1.5913
8:       -8       0 
```

与 Octave 相比，我们得到：

```
octave-3.4.0:15> x = [ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16 ]
x =

    1    2    3    4    5    6    7    8    9   10   11   12   13   14   15   16

octave-3.4.0:16> fft(x)
ans =

 Columns 1 through 7:

   136.0000 +   0.0000i    -8.0000 +  40.2187i    -8.0000 +  19.3137i    -8.0000 +  11.9728i    -8.0000 +   8.0000i    -8.0000 +   5.3454i    -8.0000 +   3.3137i

 Columns 8 through 14:

    -8.0000 +   1.5913i    -8.0000 +   0.0000i    -8.0000 -   1.5913i    -8.0000 -   3.3137i    -8.0000 -   5.3454i    -8.0000 -   8.0000i    -8.0000 -  11.9728i

 Columns 15 and 16:

    -8.0000 -  19.3137i    -8.0000 -  40.2187i

octave-3.4.0:17> 
```

请注意，从 9 到 16 的输出只是复共轭镜像或底部 8 项，与实输入 FFT 的预期情况一样。

另请注意，我们需要将 vDSP FFT 缩放 2 倍——这是因为它是基于 N/2 点复数 FFT 的实数到复数 FFT，因此输出按 N/2 缩放，而正常的 FFT 将按 N 缩放。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-30T20:09:46.850

我认为这也可能是数组包装问题。我刚刚查看了他们的示例代码，我看到他们一直在调用转换例程，例如

```
vDSP_ctoz 
```

这是来自苹果的代码示例链接：http: [//developer.apple.com/library/ios/#documentation/Performance/Conceptual/vDSP_Programming_Guide/SampleCode/SampleCode.html#//apple_ref/doc/uid/TP40005147-CH205-中国国际金融学会](http://developer.apple.com/library/ios/#documentation/Performance/Conceptual/vDSP_Programming_Guide/SampleCode/SampleCode.html#//apple_ref/doc/uid/TP40005147-CH205-CIAEJIGF)

我认为这还不是完整的答案，但我也同意 Paul R.

顺便说一句，奇怪的是，如果你去 Wolfram Alpha，他们对 FFT 给出了完全不同的答案{1,2,3,4,5,6,7,8,9,10,11,12,13,14, 15,16}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T23:56:31.417

In MATLAB, it looks like you're doing an fft of 16 real values {1+0i, 2+0i, 3+0i, etc...} whereas in Accelerate you're doing an fft of 8 complex values {1+2i, 3+4i, 5+6i, etc...}

# javascript - video.js - 更新字幕/字幕

> ID：10820489
> 
> 赞同：0
> 
> 时间：2012-05-30T16:34:50.490
> 
> 标签：javascript, html, video

我已经设置了一个 video.js 播放器，它根据单击的缩略图交换各种视频。每个视频都有一个对应的 caption.vtt 文件。视频可以很好地交换，但我找不到更新所选 vtt 文件的方法。我在文档中找不到任何内容。这可能吗？如果是这样，有人可以告诉我怎么做。

像这样的东西会很完美，但显然这不起作用......

```
myPlayer.src([
    { type: "video/mp4", src: "./video/video" + selectedVideo + ".mp4" },
    { type: "video/webm", src: "./video/video" + selectedVideo + ".webm" },
    { type: "video/ogg", src: "./video/video" + selectedVideo + ".ogv" },
    { type: "text/webvtt", src: "./video/caption" + selectedVideo + ".vtt" }
]); 
```

非常感谢任何帮助，因为我处于死胡同。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T19:58:13.240

销毁播放器并使用 JavaScript 重新创建它。那是为我做的。

# c# - 在 C# 中计时 gridView 更新

> ID：10820500
> 
> 赞同：0
> 
> 时间：2012-05-30T16:35:45.327
> 
> 标签：c#, asp.net, gridview, autopostback

所以我目前正在处理一个`C#` `ASP`页面，其中我有一个`DropDownList`和一个`GridView`. 我正在事件中初始化 GridView 和 DropDownList（连同它们连接的数据源）`PageLoad`。

我已将 DropDownList 设置为`AutoPostback=true`. 我正在更改`DropDownList_SelectedIndexChanged`事件中 GridView 的选择语句。最终结果是页面再次加载，然后选择语句被更改，此时 GridView 已经再次加载。这基本上意味着 GridView 更改需要两次页面刷新才能更新。

有没有办法避免两次刷新页面？我尝试在 Page_LoadComplete 函数中简单地更新 DataSource 和 GridView ，但是到那时更新页面已经太晚了，这意味着它仍然需要再次刷新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T16:58:20.777

所以你可以在你的页面加载中尝试这个......

```
 if(!IsPostBack)
    {
      // only then bind your grid View...
    } 
```

并在您的 DDL 的 selectedindex 更改事件中将您的网格绑定到您可能想要绑定到的任何选择结果集...

这将做的是，您的网格视图绑定代码将仅在您的页面加载事件中第一次执行......并且在您的下拉菜单可能导致的任何后续回发中......您可以在所选索引中绑定您的网格视图更改事件...这将避免绑定您的gridview两次...

# c# - 无法在我的代码中使用 Hwndsource

> ID：10820502
> 
> 赞同：2
> 
> 时间：2012-05-30T16:35:54.647
> 
> 标签：c#, .net, winforms, c#-4.0

我正在.net 4.0 中构建一个 C# 应用程序。由于某种原因，我无法使此代码工作：

```
HwndSource Source;

Source = HwndSource.FromHwnd(new WindowInteropHelper(this).Handle);
Source.AddHook(new HwndSourceHook(Window_Proc)); 
```

似乎无法导入正确的程序集。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:42:15.870

由于您在 Windows 窗体 Form 类中执行此操作，因此您可以重写[WndProc](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.wndproc%28v=vs.100%29)而不是尝试使用`HwndSource`and 钩子。

# webgl - 将鼠标事件添加到 webgl 对象

> ID：10820503
> 
> 赞同：2
> 
> 时间：2012-05-30T16:36:03.517
> 
> 标签：webgl, xtk

我使用 xtk 在 webgl 画布中可视化医疗数据。目前我正在玩这节课：

[第 10 课](http://lessons.goxtk.com/10/)

这个库非常好，但没有很好的文档记录。我想摆脱那个 gui 并添加一些鼠标事件。如果我从 gui 加载网格，如何向网格添加鼠标事件？我其实不知道从哪里开始。开始使用这个库有点令人困惑......

我试过

```
mesh.click(function(){
    alert("yes");
  }) 
```

或者

```
mesh.mousedown(function(){
    alert("yes");
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T17:11:35.763

WebGL 中呈现的对象不是 DOM 的一部分，因此不会像 DOM 元素那样生成事件。这意味着对于此类事件，您必须自己实现鼠标交互代码。

传统上，在 WebGL/OpenGL 中，这个过程被称为“挑选”，在线上有几个不错的资源。（例如：[http](http://webgldemos.thoughtsincomputation.com/engine_tests/picking) ://webgldemos.thoughtsincomputation.com/engine_tests/picking ）核心流程是这样的，不过：

*   对于场景中的每个可拾取对象，为其分配一种颜色。把它放在某个查找表中
*   将整个场景重新渲染为纹理，使用分配的颜色渲染每个可拾取对象
*   渲染场景后，确定鼠标坐标并回读该 X/Y 处的纹理颜色。
*   从查找表中获取与该颜色关联的对象。这是您的鼠标光标指向的对象！

如您所见，虽然从概念上讲这不是一个困难的方法，但它也涉及几个中级 WebGL 主题，例如渲染到纹理，因此通常不建议初学者使用。我不确定 xtk 中是否有任何功能可以帮助解决这个问题（老实说，在你发帖之前我从未听说过这个库），但我想这是你必须自己实现的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-30T18:06:17.920

不支持 DOM 事件，但您可以使用 xtk 来实现。看看这个 JSFiddle

[http://jsfiddle.net/haehn/r7Ugf/](http://jsfiddle.net/haehn/r7Ugf/)

```
// create and initialize a 3D renderer
var r = new X.renderer3D();
r.init();

// create a cube and a sphere
cube = new X.cube();
sphere = new X.sphere();
sphere.center = [-20, 0, 0];

r.interactor.onMouseMove = function() {

    // grab the current mouse position
    var _pos = r.interactor.mousePosition;

    // pick the current object
    var _id = r.pick(_pos[0], _pos[1]);

    if (_id != 0) {

        // grab the object and turn it red
        r.get(_id).color = [1, 0, 0];

    } else {

        // no object under the mouse
        cube.color = [1, 1, 1];
        sphere.color = [1, 1, 1];

    }

    r.render();

}

r.interactor.onMouseDown = function(left, middle, right) {

    // only observe right mouse clicks        
    if (!right) return;

    // grab the current mouse position
    var _pos = r.interactor.mousePosition;

    // pick the current object
    var _id = r.pick(_pos[0], _pos[1]);

    if (_id == sphere.id) {

        // turn the sphere green
        sphere.color = [0, 1, 0];
        r.render();

    }

}

r.add(cube); // add the cube to the renderer
r.add(sphere); // and the sphere as well
r.render(); // ..and render it 
```

容易，不是吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T14:49:04.327

XTK 实现了 Toji 解释的拾取方式（即使用 frameBuffer，其中每个对象都以不同的 RGBA“颜色”呈现）。当您拥有少于 255^4 个对象时，它会起作用，所以几乎总是如此。还有其他方法，例如不投影，但我认为它们会更长。

因此，使用 X.renderer.pick 和 X.renderer.get 您可以在鼠标下找到对象并更改其属性。但是，目前您只能更改可视化属性（请参阅每个类中的**setGetter**和**setSetter**），但不能移动 X.object（因为 X.object._transform 属性是私有的，并且还没有 getter/setter）。

处理这件事很有趣：为 X.object 的变换添加一对 getter/setter 将允许，例如，用户将医疗材料（由网格或其他东西建模）放在场景中并放置以测量距离或查看如果它适合手术或类似的东西。海恩不应该是个好主意吗？这是框架中的一个小改动。

# unit-testing - log4net 在单元测试下运行时找不到线程 id

> ID：10820506
> 
> 赞同：0
> 
> 时间：2012-05-30T16:36:27.810
> 
> 标签：unit-testing, log4net, mstest

我有 log4net，它写入如下条目：

```
<conversionPattern value="[%date{yyyy-MM-dd HH:mm:ss}] [%property{machineName}] [%property{pid}] [%thread] [%-5level]: %message%newline"/> 
```

除了运行单元测试外，一切正常。如果我不模拟记录器并且测试使用真实对象，那么我得到的不是 threadId

```
Agent: adapter run thread for test 'Log4NetLogger_TestLoggingMachineNamePrinted' with id '84e27809-f2b8-45b4-a2e1-ce305d20bc0c' 
```

所以很明显，当从测试运行器中使用 log4net 时，它会感到困惑。如果我正常运行应用程序，那么我会得到一个正常的线程 ID。

有人知道解决方法吗？我正在使用 MSTest。MSTest 测试运行程序和 R# 测试运行程序会发生相同的行为。

提前感谢您阅读我的问题。

乔治

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T07:07:17.753

在单元测试项目中添加对 log4net 的引用可能会起到作用（请参阅[此答案](https://stackoverflow.com/a/1598964/687857)）。

话虽如此，在这种情况下您可能不需要记录（除非这些确实是集成测试），因此最好使用[存根](http://martinfowler.com/articles/mocksArentStubs.html)而不是真正的记录器对象。

# javascript - 能够在页面源代码中看到 JavaScript 是否正常？

> ID：10820512
> 
> 赞同：0
> 
> 时间：2012-05-30T16:37:06.777
> 
> 标签：javascript

我了解 PHP 等脚本语言不会显示在浏览器的页面源代码中。JavaScript 不一样吗？

如果是这样，为什么它们会受到不同的对待？是否有解决方案可以从页面源中隐藏 JavaScript（由浏览器显示）？

我不需要有关如何隐藏它的详细信息，只是出于我的好奇心，如果它已经被处理过。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T16:40:03.003

PHP 在服务器上运行并产生一些输出，通常是 HTML，但也可能包括 XML、CSS、PHP、图像等。

JS 被发送到客户端，并在那里运行，所以他们需要看到它。

您始终可以查看 JS 源代码，尽管您可以对其进行混淆处理。但这没什么意义，因为一个体面的调试器无论如何都会让你解决问题。

例如，在 Webkit 浏览器或 Firebug 中使用 Web Inspector 将允许您查看 javascript 并设置断点并查看变量值，因此通常很容易弄清楚发生了什么。

不过这没关系，这也是学习 JS 如此简单的原因之一。如果设计正确，则很少会出现安全问题。

您可能会发现 JS 看起来混乱且难以阅读的网站 - 这通常是为了减小文件大小，因此您在网站上看到的所有 .min.js 文件都不会使其难以阅读。

大多数人在构建过程中自动执行此操作，而不是手动执行。为此，[https://github.com/mishoo/UglifyJS](https://github.com/mishoo/UglifyJS)是一个不错的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T16:39:29.230

您应该了解有服务器端和客户端脚本语言。您在客户端（浏览器）上看到的是服务器端脚本（PHP、Perl 等）的执行输出。

也就是说，已经开发了一些库来混淆 JavaScript 代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T16:39:45.140

> 我了解 PHP 等脚本语言不会显示在浏览器的页面源代码中。JavaScript 不一样吗？

是的，服务器端脚本在浏览器的源代码中不可见，尽管像 JavaScript 这样的客户端脚本被馈送到浏览器并由浏览器解析。

> 如果是这样，为什么它们会受到不同的对待？是否有解决方案可以从页面源中隐藏 JavaScript（由浏览器显示）？

“隐藏”JavaScript 是不可能的。不过，您可以缩小和混淆脚本。

[http://en.wikipedia.org/wiki/Minification_](http://en.wikipedia.org/wiki/Minification_(programming) （编程）

[http://en.wikipedia.org/wiki/Obfuscation](http://en.wikipedia.org/wiki/Obfuscation)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-30T16:40:13.893

PHP 没有在浏览器中“显示”，因为它不存在：它已经被呈现为 HTML 并由服务器发送到浏览器。（与 Java servlet 或 JSP 代码相同。）

内嵌 JavaScript*是*发送到浏览器的一部分，因此它*可以*显示在页面源代码中。

标记中链接的 JavaScript 源`<script>`不显示为页面源的一部分；您只会看到标签和 URL。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-30T16:42:34.863

不，您需要区分服务器端和客户端（脚本）语言。

服务器端脚本运行不可见 [从客户端] 并将其结果（任何类型，包括 js 文件）发送到浏览器。*这些结果文件*是公开的。

浏览器接收公共文件。其中一些可以并且将被执行。由于 JavaScript 是一种非编译语言，您将始终看到它的源代码。

另请参阅[如何防止使用 Javascript 查看页面的源代码？](https://stackoverflow.com/q/1547257/1048572)，[如何隐藏 javascript 代码](https://stackoverflow.com/q/2222355/1048572)等 - 你只能[混淆它](https://stackoverflow.com/q/194397/1048572)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-30T16:44:14.470

Javascript和PHP是两个不同的概念，其中一个是可以在浏览器中看到的客户端语言，另一个是隐藏在眼睛中的服务器端。

隐藏您的 javascript 代码的一种简单方法是包含在一个文件中，这样它就不会在该特定页面中看到 - 但每个人都会有一个指向它的链接，并且当他们点击它时仍然可以看到它。

其他解决方案是缩小它，它的工作原理相同，但会变得非常难以阅读。

[http://en.wikipedia.org/wiki/Minification_%28programming%29](http://en.wikipedia.org/wiki/Minification_%28programming%29)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-30T16:47:02.030

PHP 就像在服务器上运行的宏，它输出发送给客户端的文本。JS 是浏览器必须解释以更新页面内容的脚本。

# excel - 从 IIS 打开时选择工作表 Excel

> ID：10820513
> 
> 赞同：1
> 
> 时间：2012-05-30T16:37:12.580
> 
> 标签：excel, sharepoint, iis, impersonation

我现在正在努力完成这项工作一个星期，但我仍然迷路了。所以基本上我有一个从 Sharepoint 打开的 Excel 文件，我想在其中进行一些更改并再次保存。

我打开它使用：

```
Excel.Workbook excelWorkbook;
using(Impersonator impersonator = new Impersonator())
{
    Excel.Application excelApp = new Excel.ApplicationClass();
    excelWorkbook = excelApp.Workbooks.Open(workbookPath,
                    Missing.Value,
                    true,
                    Missing.Value,
                    Missing.Value,
                    Missing.Value,
                    Missing.Value,
                    Missing.Value,
                    Missing.Value,
                    Missing.Value,
                    Missing.Value,
                    Missing.Value,
                    Missing.Value,
                    Missing.Value,
                    Missing.Value);
        }

        return excelWorkbook; 
```

我认为目前这还不错。我正在使用 Impersonation 来获得打开它和所有内容的权利。

之后，我制作了一份副本，以便两个人可以同时在两个不同的 Excel 上工作。但这不是问题（我不这么认为）。

```
string savedPath = ExcelHelper.saveExcelWorkbookToTemp(filename, excelWorkbook);
//Closing first Excel and reopening the new one
ExcelHelper.closeExcelWorkbook(excelWorkbook);
Excel.Workbook excelWorkbookCurrent = ExcelHelper.openExcelWorkbook(savedPath); 
```

首先，当我尝试打开一个特定的工作表（这里它被命名为“Paramètres”）时，我得到一个名为：Microsoft.Office.Interop.Excel.Worksheet {System.__ComObject} 的对象。这正常吗？我m 使用此功能打开工作表：

```
public static Excel.Worksheet openExcelWorkSheet(Excel.Workbook excelWorkbook, string name)
{
   Excel.Worksheet worksheet;
   using (Impersonator impersonator = new Impersonator())
   {
     //Excel.WorkSheets worksheets = excelWorkbook.Sheets;
     //worksheet = (Excel.Worksheet)worksheets.get_Item(name);

     worksheet = (Excel.Worksheet)excelWorkbook.Sheets["Paramètres"];
     worksheet.Select(Type.Missing);
   }
   return worksheet;
} 
```

之后，我尝试更改单元格值，但出现此错误：

*   worksheet.Cells["A1"] 'worksheet.Cells["A1"]' 抛出类型为 'System.Runtime.InteropServices.COMException' 动态 {System.Runtime.InteropServices.COMException} 的异常或此错误，具体取决于方式我打电话给细胞... HRESULT 异常：0x800A03EC

你们知道我该如何克服这个问题吗？我不认为这是一个正确的问题，因为我正在使用管理员权限来做到这一点......

提前感谢。

PS：这是我修改单元格的功能

```
 public static bool writeExcelCell(Excel.Worksheet worksheet, string cellName, string cellValue)
    {
        bool written = false;
        using (Impersonator impersonator = new Impersonator())
        {
            try
            {
                worksheet.Cells[cellName] = cellValue;
                written = true;
            }
            catch (Exception e)
            {
                written = false;
            }
        }
        return written;
    } 
```

编辑：没有错误：

```
worksheet.get_Range("A1").Value = "AAA";
worksheet.get_Range("A3").Value2 = "BBB";
worksheet.get_Range("A2").set_Value(Type.Missing, "test"); 
```

但是我打开它时看不到变化...

# struts2 - 从 Action 使用的实用程序类访问属性

> ID：10820515
> 
> 赞同：0
> 
> 时间：2012-05-30T16:37:21.540
> 
> 标签：struts2

我只想知道是否有办法从 Action 类使用的实用程序类访问属性。要从 Action 类访问属性，我们扩展 ActionSupport 并使用该`getText("property.key.name")`方法。所以，我的问题是——是否应该每个其他类都扩展 ActionSupport 以访问属性，即使它不是 Action 类？还是有其他方法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T01:48:18.337

`ActionSupport`除非您实际上是在定义一个动作，否则我不会扩展。

S2/XW2`ActionSupport`类使用`com.opensymphony.xwork2.DefaultTextProvider`; 您也许可以在自己的课程中使用它。我对此有点警惕，因为我不相信非动作类应该访问网络应用程序的资源，但我没有考虑太多，所以它可能是有效的。我也没有尝试过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T17:01:45.583

`ActionSuport`是一种由 S2 开发人员开发的帮助程序类，用于补充开发，因为它提供了许多 OOTB 功能。

`getText()`是 S2 提供一种读取属性文件的方法的用例之一。此方法特定于 S2，因为它知道如何跨越层次结构以读取属性文件以及以什么顺序。

有很多方法可以读取应用程序中的属性文件，但其中很少有

*   [资源包](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/ResourceBundle.html)

如果您使用的是 Spring，它有一个非常方便的机制来读取属性文件 - [how-to-read-properties-file-in-spring](http://www.zparacha.com/how-to-read-properties-file-in-spring/#.T8ZRlsXmzIU)

Apache Common 还提供了一种读取文件的方法

*   [阿帕奇通用](http://commons.apache.org/configuration/howto_properties.html)

总之读取属性文件有很多种方法，S2`getText()`是S2开发的一种读取属性文件的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T17:46:19.583

```
//I wanna make you understand how struts doing it.

   public class ActionSupport implements Action, Validateable, ValidationAware,   TextProvider, LocaleProvider, Serializable {

     //Action support implementation.
     //Here TextProvider takes care about resource bundle thing.

    } 
```

# emacs - Emacs cc 主要模式在 Ubuntu 上没有显示颜色，但 lisp 模式显示

> ID：10820517
> 
> 赞同：0
> 
> 时间：2012-05-30T16:37:26.933
> 
> 标签：emacs, xemacs, major-mode

我该如何解决？

我打开 xemacs 并有可爱的颜色。我打开一个 .c 或 .cpp 文件并加载 cc 模式 - 可爱 - 但没有显示颜色。

安装的emacs，版本：

`XEmacs 21.4 (patch 22) "Instant Classic" [Lucid] (x86_64-linux-gnu, Mule) of Mon Nov 21 2011 on allspice`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T16:58:06.363

我有

```
(require 'font-lock) 
```

在我在 XEmacs 启动时加载的文件之一中。这将为所有文件启用字体锁定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T12:08:52.433

在你的 .emacs 中这样的东西可以解决问题吗？

```
(add-hook 'c-mode-common-hook
  (lambda () (font-lock-mode t))) 
```

我没有在 xemacs 中测试过它，但是基本的想法应该可以工作，即使你必须稍微调整一下。

# vb.net - 排序列表（字符串（））使用变量索引到字符串（）作为键 - vb.net

> ID：10820520
> 
> 赞同：1
> 
> 时间：2012-05-30T16:37:57.837
> 
> 标签：vb.net, sorting

我有一个`List(of String())`. 我编写了一个自定义比较器 ( `implements IComparer(of string)`) 来进行字母数字排序。

有没有办法使用给定的索引对 List 进行排序以确定`String()`要排序的位置？换句话说，一次我可能排序`Index = 0`，另一次排序`Index = 3`。列表中所有的长度`String()`是相同的。

作为参考，这个问题类似于[Sort List<String[]>](https://stackoverflow.com/questions/4751866/sort-liststring)除了我使用的是 VB.net 并且这个问题是硬连线到`Index=0`.

* * *

**从 OP 的评论中编辑：**

我从非自定义比较器开始简单，但出现错误：表达式不产生值。不知道我做错了什么。这是代码：

```
Public Shared Function SortListOfStringArray(ByVal ListOfStringArray As List(Of String()), ByVal SortByIndex As Integer) As List(Of String())
    Return ListOfStringArray.Sort(Function(x, y) x(SortByIndex).CompareTo(y(SortByIndex)))
End Function 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T16:46:34.750

要对数组中特定索引上的字符串数组列表进行排序，请使用：

```
Dim index As Integer = 1
list.Sort(Function(x, y) x(index).CompareTo(y(index))) 
```

使用自定义比较器：

```
Dim index As Integer = 1
list.Sort(Function(x, y) comparer.Compare(x(index), y(index))) 
```

# excel - 使用唯一值在excel中创建一行信息

> ID：10820524
> 
> 赞同：1
> 
> 时间：2012-05-30T16:38:48.853
> 
> 标签：excel, vba, uniqueidentifier, mergesort

这是我的第一篇文章。我目前正在处理一个项目，该项目需要我使用几个不同的工作表才能创建一个邮件主工作表，就像是为了进行邮件合并。工作表包含有关不同购买的信息，每个购买者都有自己的 ID 号。下面是我的电子表格现在的样子（但是我确实有更多列）：

```
ID  Salutation     Address  ID      Name        Donation      ID  Name          Tickets
9   Mr. John Doe    123     12  Ms. Jane Smith   100.00       12  Ms.Jane Smith   300.00 
12  Ms. Jane Smith  456     22  Mr. Mike Man     500.00       84  Ms. Jo Smith    300.00 
```

我想做的是以某种方式对我的数据进行排序，以便具有相同唯一标识符 (ID) 的所有内容都排在同一行上。例如 ID 12 Jane Smith - 她的所有信息都将显示在与她的 ID 号码匹配的她的姓名下，ID 22 将与 22 等匹配...

当我将所有电子表格合并在一起时，我按 ID 号对它们进行了排序，但我的问题是，并非所有捐款的人都买了票，或者有些人只买了票而我们什么也没买，所以排序不起作用。

希望这是有道理的。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T18:24:14.593

您可以在 Excel VBA 中执行此操作。如果您之前没有在 Excel 中使用过 VBA，请参阅下面的链接以了解如何访问它。

[http://msdn.microsoft.com/en-us/library/ee814737.aspx](http://msdn.microsoft.com/en-us/library/ee814737.aspx)

**确保在尝试任何操作之前备份电子表格，以防出现问题！**

我写了一些东西，将数据从你的辅助工作表复制到你的主工作表中。只需打开 VBA 编辑器，然后粘贴代码。

接下来，编辑该`ConsolidateWorksheets()`函数，使其具有适合您工作表的名称。如果您有其他工作表，请声明它们并添加另一行来调用`ProcessWorksheet`所添加工作表的子例程。

此代码会在找到匹配的 ID 时将您的门票和捐赠工作表中的数据复制到您的主工作表中。如果没有匹配的 id，它不会为该行复制任何内容。

```
Option Explicit

Sub ConsolidateWorksheets()

    'declare the worksheets you are using
    Dim mainWks As Worksheet
    Dim ticketsWks As Worksheet
    Dim donationsWks As Worksheet

    'set the worksheet names
    Set mainWks = ThisWorkbook.Worksheets("Sheet1")
    Set ticketsWks = ThisWorkbook.Worksheets("Sheet2")
    Set donationsWks = ThisWorkbook.Worksheets("Sheet3")

    Call ProcessWorksheet(mainWks, ticketsWks)
    Call ProcessWorksheet(mainWks, donationsWks)

End Sub

' copies data from the otherWks to the mainWks
Sub ProcessWorksheet(mainWks As Worksheet, otherWks As Worksheet)

    Dim i As Integer
    Dim rowId As Integer

    Dim otherRowIndex As Integer
    Dim otherLastColIndex As Integer

    Dim lastRowIndex As Integer

    Dim pasteColStart As Integer
    Dim pasteColEnd As Integer

    ' figure out the last row in the main sheet
    lastRowIndex = mainWks.UsedRange.Rows.count
    otherLastColIndex = otherWks.UsedRange.Columns.count

    ' figure out where to copy and paste from
    ' this assumes that the id row is always the first row in every sheet
    pasteColStart = mainWks.UsedRange.Columns.count + 1
    pasteColEnd = pasteColStart + (otherLastColIndex - 2)

    ' copy column headers
    otherWks.Activate
    otherWks.Range(Cells(1, 2), Cells(1, otherLastColIndex)).Copy
    mainWks.Activate
    mainWks.Range(Cells(1, pasteColStart), Cells(1, pasteColEnd)).PasteSpecial

    ' loop through all the rows of the main sheet
    For i = 2 To lastRowIndex
        ' get row id from first cell in current row
        rowId = Cells(i, 1).Value
        'lookup row id in other worksheets
        otherRowIndex = FindIdRowInWks(otherWks, rowId)

        If otherRowIndex <> 0 Then
            otherWks.Activate
            otherWks.Range(Cells(otherRowIndex, 2), Cells(otherRowIndex, otherLastColIndex)).Copy
            mainWks.Activate
            mainWks.Range(Cells(i, pasteColStart), Cells(i, pasteColEnd)).PasteSpecial
        End If
    Next i

End Sub

' loops through the given worksheet, looks for a given id in the first column
' and returns the row index where the id was found. returns 0 if nothing found.
Public Function FindIdRowInWks(wks As Worksheet, idToFind As Integer) As Integer
    Dim lastRow As Integer
    lastRow = wks.Range("A" & Rows.count).End(xlUp).Row

    Dim rowNumber As Integer
    rowNumber = 0

    Dim i As Integer
    For i = 2 To lastRow
        If (Cells(i, 1).Value = idToFind) Then
            rowNumber = i
        End If
    Next i
    FindIdRowInWks = rowNumber
End Function 
```

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T22:08:55.840

您可以在没有 VBA 的情况下分 3 步执行此操作：

1) 创建新工作表

2) 在新工作表上获取 ID 和称呼的综合列表

对于 XL2007，请参阅删除重复项，对于 XL2003，请参阅高级过滤器。

3) 像这样使用 vlookups 和 iferror 创建一个设置，根据原始工作表中的相关部分获取您想要的值。在公式栏中查看图像和 vlookup 公式

![在此处输入图像描述](../Images/ced7410aabbf466b86b01d2833e6d705.png)

# yii - 从数据库中获取特定数据

> ID：10820529
> 
> 赞同：2
> 
> 时间：2012-05-30T16:38:56.050
> 
> 标签：yii

我有一个名为 Category 的表，其中包含几列，我试图从我的数据库中只获取一些列。

所以我试过这个：

```
$sql = 'SELECT uppercat AS id, COUNT(uppercat) AS uppercat FROM category GROUP BY uppercat;';
$d = Yii::app()->db->createCommand($sql)->query(); 
```

但我发现输出很奇怪。我试图做一个 array_shift 但我得到一个错误，这不是一个数组。当我对 $d 执行 var_dump 时：

```
object(CDbDataReader)[38]
  private '_statement' => 
    object(PDOStatement)[37]
      public 'queryString' => string 'SELECT uppercat AS id, COUNT(uppercat) AS uppercat FROM category GROUP BY uppercat;' (length=100)
  private '_closed' => boolean false
  private '_row' => null
  private '_index' => int -1
  private '_e' (CComponent) => null
  private '_m' (CComponent) => null 
```

好的..然后我在$id上做了一个foreach：

```
array
  'id' => string '0' (length=1)
  'uppercat' => string '6' (length=1)
array
  'id' => string '3' (length=1)
  'uppercat' => string '2' (length=1)
array
  'id' => string '6' (length=1)
  'uppercat' => string '1' (length=1)
array
  'id' => string '7' (length=1)
  'uppercat' => string '2' (length=1)
array
  'id' => string '9' (length=1)
  'uppercat' => string '2' (length=1) 
```

那为什么我会收到 $id 不是数组但它包含数组的消息？

有没有其他方法可以从我的数据库中获取一些特定数据，然后我可以对它们执行 array_shift ？我也试过用 findAllBySql 来做这件事，但是我无法达到我的 COUNT(uppercat) 属性，这不在我的模型中。我想我必须将它添加到我的模型中，但我不喜欢这样，因为我只需要它一次。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T16:47:38.120

CDbCommand 的[查询](http://www.yiiframework.com/doc/api/1.1/CDbCommand/#query-detail)返回一个 CDbDataReader 对象以获取查询结果。改用[queryAll](http://www.yiiframework.com/doc/api/1.1/CDbCommand#queryAll-detail)，它返回一个行数组。

然而，如果你用 CDbCriteria 来做会更好（你需要一个模型属性，你是对的）。

假设该属性被调用，它看起来像这样`countUppercat`。

```
$criteria = new CDbCriteria;
$criteria->select = 'uppercat, COUNT(uppercat) AS countUppercat';
$criteria->group = 'countUppercat';
$models = CategorieModel::model()->findAll($criteria); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-30T18:33:37.953

试试这个..它已关闭，您使用它...

```
$sql = 'SELECT uppercat AS id, COUNT(uppercat) AS uppercat FROM categorie GROUP BY uppercat;';
$d = Yii::app()->db->createCommand($sql)->queryAll(); 
```

之后，当您想查看您的数组时，请使用，

```
print_r($d); 
```

所以你得到了数组..

它会为你工作..

# actionscript-3 - 闪画线重叠检查

> ID：10820531
> 
> 赞同：0
> 
> 时间：2012-05-30T16:39:00.630
> 
> 标签：actionscript-3, flash-cs5

我有一个应用程序，用户必须在画布上画一条线而不重叠它。有没有办法测试重叠？我已经用谷歌搜索了，但发现圆形和矩形重叠的结果。我的情况不同。在这里，用户将在画布上绘制线条而不与线条本身重叠。可能是我错过了一些东西，所以任何指导表示赞赏。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T17:33:09.020

我认为您的意思是用户使用鼠标使用某种钢笔工具画线。

这是我要做的：

首先，保存在 BitmapData 对象中绘制的线的路径。

```
var lineBitmapData:BitmapData = new BitmapData(display.width,display.height,true,0x00000000); 
```

这将创建一个带有用户线的透明位图对象。

在每一帧（或计时器事件，如果您使用计时器）上执行以下操作：

1.捕获当前鼠标位置并将其放入Point对象中。

```
var currentMousePosition:Point = new Point(mouse.x,mouse.y); 
```

您还需要一个代表 bitmapData 左上角的点。

```
var pt1:Point = new Point(1,1); 
```

2.执行当前鼠标位置与lineBitmapData的碰撞检测

```
var result:Boolean = lineBitmapData.hitTest(pt1, 0xFF, currentMousePosition); 
```

hitTest 方法中的第二个参数是阈值。基本上，这需要设置为您希望算作命中的最小 alpha 值。

3.检查hitTest的结果。如果它是假的，这意味着用户将要绘制此帧的内容与已绘制的内容不相交。在这种情况下，您将在最后一帧期间绘制的位添加到 lineBitmapData。

但是，如果 hitTest 返回 true，则意味着用户即将使他的线相交，因此您的程序需要停止绘图（或任何您想要的行为）。

```
 if(result){
 myPenTool.stopDrawing();}else{
var drawnLastFrame:BitmapData = myPenTool.drawSingleFrameLine();
lineBitmapData.draw(drawnLastFrame);} 
```

4.使用新的 lineBitmapData 更新用户在屏幕上看到的内容

# hibernate - org.hibernate.LazyInitializationException：无法初始化代理 - 拥有会话已关闭

> ID：10820533
> 
> 赞同：2
> 
> 时间：2012-05-30T16:39:05.780
> 
> 标签：hibernate, session, exception, initialization, lazy-evaluation

当我运行以下代码时，我不断收到此错误“线程“主”org.hibernate.LazyInitializationException 中的异常：无法初始化代理 - 拥有的会话已关闭”：

```
public ArrayList<ProfileDTO> getInitialProfiles(Contracts ct){ 
   SessionFactory sessionFactory=new Configuration().configure().buildSessionFactory();
   Session session=sessionFactory.openSession();
   Transaction tx=session.beginTransaction(); 
   ArrayList<ProfileDTO> profileDTOs=new ArrayList<ProfileDTO>();
   try{
       Hibernate.initialize(ct);
        SQLQuery query=session.createSQLQuery("select {b.*},{p.*},{t.*} from bidtool.bt_boiler_plates b,bidtool.bt_profile p,bidtool.bt_trade_lane t where b.contract_id=:val AND p.contract_id=:val AND t.contract_id=:val")
                  .addEntity("b",Boiler_Plates.class)
                  .addEntity("p",BidToolProfiles.class)
                  .addEntity("t",BidToolTradeLanes.class);
        query.setParameter("val", ct.getContract_id());
        List list=query.list();  

        Iterator iteContract = list.iterator();
        while ( iteContract.hasNext() ) {
            Object[] pair =(Object[]) iteContract.next();
            Boiler_Plates bp=(Boiler_Plates)pair[0];
            BidToolProfiles p=(BidToolProfiles)pair[1];
            ProfileDTO profileDTO=new ProfileDTO();
            profileDTO.setProfileId(p.getProfileId());
            profileDTO.setBt_contracts(p.getBt_contracts());
            profileDTO.setCreated(p.getCreated());
            profileDTO.setProfileContent(p.getProfileContent());
            profileDTO.setEditable(p.getEditable());
            profileDTO.setProfileName(p.getProfileName());
            profileDTOs.add(profileDTO);
        } 
        return profileDTOs;
   }
   catch(Exception ex){
       System.out.println(ex.getMessage());
       return profileDTOs;
   }
   finally{
    session.flush();   
    session.close();
   }
 } 
```

只要我不关闭会话，它就可以正常工作，但我不能这样做。我需要关闭会话。您的帮助将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T16:48:02.707

在会话关闭后访问休眠实体中的关联或集合时会引发错误。查看您的代码，我猜问题可能出在以下行：

`profileDTO.setBt_contracts(p.getBt_contracts());`

当您尝试从不同的会话中访问代码中其他地方的此集合时。

尝试将您的查询更改为：

`select {b.*},{p.*},{t.*} from bidtool.bt_boiler_plates b,bidtool.bt_profile p,bidtool.bt_trade_lane t left join fetch p.bt_contracts btcontracts where b.contract_id=:val AND p.contract_id=:val AND t.contract_id=:val`

请注意，我在集合上添加了一个连接提取。这应该确保在获取`BidToolProfiles`实体的同时获取合同集合。还可以尝试在将集合设置到 DTO 之前对其进行初始化。

```
Hibernate.initialize(p.getBt_contracts());
profileDTO.setBt_contracts(p.getBt_contracts()); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-30T16:49:25.070

好吧，您需要在会话关闭后初始化您计划使用的每个对象。

假设您有一个 User 实体，它的地址具有 OneToOne 惰性关联。并假设您在会话打开时加载用户。由于地址是延迟加载的，当您第一次调用地址上的方法时（`user.getAddress().getStreet()`例如），Hibernate 将执行查询以加载用户的地址，从而能够让您访问其街道。但是如果会话关闭，则不再有与数据库的连接，用户实体被分离，Hibernate 就会抛出这个异常。

用于`Hibernate.initialize()`初始化您需要的对象，或执行具有必要提取的查询以一次加载所需的所有内容。

旁注：您的异常处理很糟糕。当被要求返回配置文件时，而不是说：“对不起，由于以下异常，我不能这样做”，您基本上忽略了异常并说“数据库中没有配置文件”。请想象一下癌症检测系统以这种方式工作。您是否希望您的癌症因系统异常而未被发现？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T16:45:20.533

你是如何使用这种方法的？你的映射是什么样的？您启用了哪些属性的延迟加载？这是一个网络应用程序吗？您正在创建 ProfileDTO，但 getBt_contracts 呢？这将从“启用会话的”BidToolProfiles 返回内容，因此如果您在该方法返回后访问延迟加载的属性，则会收到此错误。

鉴于我看不到您的映射，这只是我认为错误的一个示例。这里重要的是，在您延迟加载执行所需任务所需的所有属性后，会话应该关闭。

再一次 - 取决于这是否是一个网络应用程序，您可以采用不同的会话管理策略（网络应用程序上的每个请求的会话，如果它是桌面应用程序，则每个线程的会话等）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-30T16:48:12.217

用于`session.merge()`将从旧会话加载的实例与新会话合并。顺便说一下，这意味着 Hibernate 从数据库中再次加载实体。

另一种可能性是避免延迟加载——无论是在映射中还是通过访问必要的值，只要会话仍然打开（即使这些值在那一刻不是必需的）。

# iphone - 获取 google plus 用户好友

> ID：10820536
> 
> 赞同：6
> 
> 时间：2012-05-30T16:39:33.220
> 
> 标签：iphone, objective-c, ios, google-plus, google-contacts-api

在[Google+ API](https://developers.google.com/+/api/latest/people/search)中有一种搜索公开好友的方法。

但是，我看不到获得用户朋友的方法。有什么方法可以获取 Google+ 用户的朋友？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T22:47:51.863

Googel+ 目前没有 API 访问圈子和朋友。如果添加了 API 方法，您可以添加一个[开放的功能请求以获得通知。](https://code.google.com/p/google-plus-platform/issues/detail?id=9)

或者，您可以使用[Google Contacts API](https://developers.google.com/google-apps/contacts/v3/)。这有一个更可怕的权限对话框的缺点，因为没有只读权限。

# python - 如何模拟python内置方法

> ID：10820545
> 
> 赞同：2
> 
> 时间：2012-05-30T16:40:15.407
> 
> 标签：python, unit-testing, python-mock

我有一个 python 方法执行以下操作：

1.  使用 os.listdir(/test) 列出目录下的文件
2.  正则表达式匹配目录下的一些文件，将文件放在一个列表中
3.  从列表中的文件中读取内容，做一些聚合的东西。

显然，我要测试的唯一有趣的部分是 2、3，所以 1 绝对是我想要模拟的东西。我开始在 setUp() 和 tearDown() 的 /test 文件夹下创建/删除补丁文件。但是同事告诉我，在 unitest 中进行 I/O 并不是一个好主意。

那么在我的单元中模拟构建 os.listdir() 的最佳方法是什么？或者有什么选择？

我可以做些什么来实现以下目标：

```
setUp() {
    #mock a few files eg.test1.txt, test2.txt, test3.txt under directory /test 
    #without physically creating them using I/O
}
tearDown() {
   #whatever cleanup required 
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T17:01:59.530

使用 Mock 模块怎么样？

```
>>> import os
>>> from mock import MagicMock
>>> os.listdir = MagicMock(return_value=['file1.txt', 'file2.txt', 'file3.txt'])
>>> os.listdir('./test')
['file1.txt', 'file2.txt', 'file3.txt'] 
```

如果您不想 mokey-patch（即中断）os，那么您可以使用 mock_os 或类似的东西。

阅读有关启动和停止的信息：http:
[//docs.python.org/dev/py3k/library/unittest.mock.html#patch-methods-start-and-stop](http://docs.python.org/dev/py3k/library/unittest.mock.html#patch-methods-start-and-stop)

并且：
[http ://docs.python.org/dev/py3k/library/unittest.mock.html#quick-guide](http://docs.python.org/dev/py3k/library/unittest.mock.html#quick-guide)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-01-08T15:08:21.363

我发现模拟模块是列出文件和读取模拟数据的方式。这些当然可以组合在一个测试中，但为了清楚起见，我已将它们分开在一个工作文件中。

```
import unittest
from mock import patch, mock_open
import os

class Test(unittest.TestCase):
    @patch.object(os, 'listdir')
    def test_listdir(self, mock_listdir):
        expected = ['file1.txt', 'file2.txt']
        mock_listdir.return_value = expected
        self.assertEquals(expected, Code().get_folder("~"))

    def test_file_mock(self):
        expected_string = "Some File Contents"
        mocked_file_object = mock_open(read_data=expected_string)
        with patch('__main__.open', mocked_file_object, create=True) as mocked_open:
            self.assertEquals(expected_string, Code().get_file_as_string('any'))

class Code(object):
    def get_folder(self, folder):
        return os.listdir(folder)

    def get_file_as_string(self, afile):
        with open(afile, 'r') as handle:
            return handle.read()

if __name__ == '__main__':
    unittest.main() 
```

# c++ - 如何使用 Native Wifi API C++ 获取 MAC 地址和频道信息

> ID：10820547
> 
> 赞同：2
> 
> 时间：2012-05-30T16:40:23.830
> 
> 标签：c++, windows, wifi

我有这个：

```
WLAN_AVAILABLE_NETWORK_LIST *wlanNetworkList = (WLAN_AVAILABLE_NETWORK_LIST*)WlanAllocateMemory(sizeof(WLAN_AVAILABLE_NETWORK_LIST)); 
```

我使用 WlanGetAvailableNetworkList() 函数获取有关网络的信息。

但是在这个信息中没有mac地址或通道。如何得到它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T17:33:41.047

我认为您要查找的信息在`WLAN_BSS_ENTRY`结构中。

由于网络可能有多个接入点，因此至少对我来说网络没有单个 MAC 地址是有意义的（也考虑 ad-hoc 网络），因此 MAC 地址不是网络的属性（不是`WLAN_AVAILABLE_NETWORK`结构的数据成员）。

使用`WlanGetNetworkBssList`（[msdn library entry](http://msdn.microsoft.com/en-us/library/windows/desktop/ms706735%28v=vs.85%29.aspx)），您可以获得特定网络（通过传递 SSID）或无线 LAN 接口的所有网络的 BSS 条目列表。注意这个函数查询接入点：

> 为每个无线网络返回的信息列表还包含每个接入点为基础设施 BSS 网络或独立 BSS 网络（自组织网络）的网络对等点返回的信息元素列表。

* * *

顺便说一句：我认为你不需要为`WLAN_AVAILABLE_NETWORK_LIST`结构分配缓冲区`WlanAllocateMemory`。MSDN：

> 如果调用成功，则返回的 WLAN_AVAILABLE_NETWORK_LIST 的缓冲区由 WlanGetAvailableNetworkList 函数分配。

但是，您必须通过释放函数为列表分配的内存`WlanFreeMemory`。

另请参阅[msdn 库中的示例](http://msdn.microsoft.com/en-us/library/windows/desktop/ms706749%28v=vs.85%29.aspx)（该页面的底部）。

编辑：这个例子有点混乱，有一个变量叫做`pBssList`它的类型`PWLAN_AVAIBLE_NETWORK_LIST`，而不是`PWLAN_BSS_LIST`顾名思义。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-02-02T07:44:26.850

也许你会先尝试使用 WlanScan。我尝试在汇编中编写 WlanApi，goasm。我使用 WlanGetNetworkBssList。一切正常，作为回报，我得到了 6 个字节的 mac，但只有前 3 个字节与我的路由器的 Mac 相同。我不明白为什么。也许我在 WlanApi.h 中写错了 sruct 我仍在学习 ASM [WlanApi.h](http://wklej.org/id/1259379/) [MyCode](http://wklej.org/id/1259380/)

# c# - 仅当字符串的第一个字母在 A 和 K 之间时才将项目添加到下拉列表

> ID：10820548
> 
> 赞同：1
> 
> 时间：2012-05-30T16:40:26.937
> 
> 标签：c#

我有一个下拉列表，需要显示已使用`SqlHelper.FillDataTable`. 我使用 for each 语句将每个值放入列表项，然后将该项目添加到下拉列表值中。仅当名称的第一个字母（这些是数据库中的名称）在 A 和 K 之间时，我才想将此项目添加到下拉列表中。我编写的当前 if 语句导致没有值被放入下拉列表列表。这是当前代码：

```
ListItem NewItem = new ListItem();
NewItem.Text = dr_UsersToShow["ViewValue"].ToString();
NewItem.Value = dr_UsersToShow["DataValue"].ToString();
string str = Convert.ToString(NewItem.Text[0]);
if (String.Compare("str", "A", true) >= 0 && String.Compare("str", "K", true) <= 0)
{
    this.dlNewUserList.Items.Add(NewItem);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T16:42:35.300

您正在将文字“str”与“A”和“K”进行比较。您想将*字符串* `str`与“A”和“K”进行比较。只需从“str”中删除引号。

改变这个

```
if (String.Compare("str", "A", true) >= 0 && String.Compare("str", "K", true) <= 0) 
```

对此

```
if (String.Compare(str, "A", true) >= 0 && String.Compare(str, "K", true) <= 0) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T17:33:32.123

您还可以将 if 条件更改为：

```
if (str[0] >= 'A' && str[0] <= 'K') 
```

我认为这比使用比较方法更有效。为了使它更具可读性（尽管不是真的必要），您可以更进一步并执行以下操作：

```
var firstChar = str[0];
if (firstChar >= 'A' && firstChar <= 'K') 
```

我看到当我重新阅读您传递`true`给比较函数以忽略大小写的原始问题时，那么您真正想要的是：

```
var firstChar = str[0].toUpper();
if (firstChar >= 'A' && firstChar <= 'K') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T16:43:40.697

您应该从“str”中删除引号，在这里您正在比较字符串“str”，我确定这不是您想要的。您想比较字符串变量 str 中包含的任何内容。

# mysql - 在mysql中批量删除

> ID：10820549
> 
> 赞同：0
> 
> 时间：2012-05-30T16:40:27.937
> 
> 标签：mysql, sql, database, jdbc

是否可以在 mysql 中使用 jdbc 或本机 sql 执行批量删除？

我有一组未知数量的字符串要与一列进行比较并删除行。当参数数量未知时，是否可以在 jdbc PreparedStatement 中使用参数？

除了构造一个包含类似子句的字符串并执行它之外，还有其他方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T16:48:16.070

是的，有可能，但可能不值得。

准备好的语句实际上旨在处理查询除了变量之外完全相同的情况。

如果您无法提前构建查询，它们将无济于事。

所以

```
delete from table where field1 = 'string1' or field2='string2'..... or fieldX='stringX' 
```

如果查询是从头开始构建的，或者它是作为准备好的语句创建的，那么预先不知道 X 的地方将运行得同样快。

如果我误解了你的问题，请告诉我。

# javascript - 为什么 Math.prototype 未定义？

> ID：10820554
> 
> 赞同：8
> 
> 时间：2012-05-30T16:40:58.383
> 
> 标签：javascript, math, prototype

我必须在这里遗漏一些东西，因为对我来说`Math.prototype`是[未定义的](http://jsfiddle.net/R3GqT/)。为什么是这样？我试图做这样的事情：

```
Math.prototype.randomRange = function(from, to){
    return Math.floor(Math.random() * (to - from + 1) + from);
} 
```

但不得不做这样的事情：

```
Math.randomRange = function(from, to){
    return Math.floor(Math.random() * (to - from + 1) + from);
} 
```

不过，这感觉不对。只是我还是我应该以另一种方式这样做？如果这是一个愚蠢或重复的问题，我深表歉意，但我无法通过搜索找到任何东西（当我搜索“Math.prototype”时恰好出现了两个问题，这有点奇怪）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T16:42:19.800

这些`Math`函数类似于其他 OO 语言中的类级函数。构造函数上没有原型对象；无论如何，没有人（我知道）使用构造函数。（你会对`Math`实例做什么？）

*编辑*——它在评论中被指出（我从来没有想过要检查我猜）这`Math`不是一个函数。在浏览器控制台中输入`Math()`，您将收到错误消息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T16:44:36.540

`Math`JavaScript 中的静态类相当于其他语言中的静态类。它没有原型或构造函数（相当于，比如说，用 Java 编写一个包含所有静态方法和只有一个私有构造函数的类）。

有关更多信息，请参阅 StackOverflow 问题：[在 JavaScript/ActionScript 中重新定义 Math.constructor 是否有实际用途？](https://stackoverflow.com/questions/10339334/is-there-any-practical-use-of-redefining-math-constructor-in-javascript-actionsc)

具体来说，接受的答案：[https ://stackoverflow.com/a/10431309/1403635](https://stackoverflow.com/a/10431309/1403635)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T16:43:31.533

因为 Math 是一个静态对象，而不是构造函数。如果你调用它会抛出一个错误`new Math()`

# php - 从 PHP 将多个数组保存到 CSV

> ID：10820557
> 
> 赞同：1
> 
> 时间：2012-05-30T16:41:04.220
> 
> 标签：php, csv

我想从 PHP 中将两个数组另存为 CSV 文件。问题是此代码仅适用于第一个呼叫。例如，在下面给出的示例中，我只能保存`array1`，但`array2`不能保存。如果我交换 和 的位置`array1`，`array2`那么`array2`将被保存而不是`array1`。我的代码实际上有什么问题，我该如何解决这个问题？

```
 header("Content-type: text/csv");
     header("Pragma: no-cache");
     $headers = array('xxx','yyy','zzz');
     saveCSV($array1,"file1.csv",$headers);

     header("Content-type: text/csv");
     header("Pragma: no-cache");
     $headers = array('aaa','bbb','ccc');   
     saveCSV($array2,"file2.csv",$headers);

function saveCSV($data,$fileName,$headers) {
    $outstream = fopen($fileName, "a");
    file_put_contents($fileName, "");

    if ($headers != 0)
        fputcsv($outstream,$headers);

    function __outputCSV(&$vals, $key, $filehandler) {
        fputcsv($filehandler, $vals);
    }
    array_walk($data, "__outputCSV", $outstream);
    fclose($outstream);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T16:48:44.837

据我所知，您只能设置一次标题然后返回内容。上面的代码设置了一些标头，使用 CSV 回复，然后再次设置标头，并再次使用不同的 CSV 回复。PHP/浏览器不会处理单独的返回。

而不是从服务器推送多英里，也许您可​​以只使用浏览器 window.open() /path-to-get-csv-script.php?op=file1 然后 op=file2。如果这是您想要的，浏览器可以打开这两个文件....

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T16:50:36.277

您设置标题两次。

尝试建立您的 csv 数据输出，然后一旦完成设置标题一次。

此外，您在另一个中有一个函数声明，我确定这是无效的。

将 __outputCSV 移到其他地方，或者您可能打算将其关闭？

# asp.net-mvc - 在同一个 appDomain 中托管 MVC 和 WCF

> ID：10820558
> 
> 赞同：2
> 
> 时间：2012-05-30T16:41:04.270
> 
> 标签：asp.net-mvc, wcf, model-view-controller, appdomain

是否可以在同一个 appDomain 中托管 WCF 服务和 MVC 应用程序的两个不同项目？

例如，我需要通过我的 WCF 服务使用来自 MVC 应用程序的一些公共静态类。但是他们在不同的项目中，所以他们的这个类在不同的appDomains中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T12:03:10.913

在 ASP.NET 应用程序（MVC 或 WebForms）中托管 WCF 服务是很常见的。从编码的角度来看，如果 WCF 调用的代码需要访问当前的 HTTP 上下文，您可能需要配置的唯一内容是[ASP.NET 兼容模式。](http://msdn.microsoft.com/en-us/library/ms752234.aspx)

像往常一样，创建您的 WCF 服务协定和这些协定的实现，在 web.config 中配置您的服务、绑定和行为。[这是另一个示例](http://blogs.msdn.com/b/wenlong/archive/2006/01/23/516041.aspx)，您几乎可以在任何 ASP.NET 应用程序中创建它。

# ms-access - MS Access 2007 加入多个字段

> ID：10820564
> 
> 赞同：8
> 
> 时间：2012-05-30T16:41:40.387
> 
> 标签：ms-access, join

我有两个类似于以下的表：

![在此处输入图像描述](../Images/0447def0a38f9d4819384542ac718846.png)

![在此处输入图像描述](../Images/aed4653fbd11276f10995799d9da3eeb.png)

我正在尝试在 Access 中创建一个查询以创建如下表：

![在此处输入图像描述](../Images/9a57d05e8d3b8cf07ba979d5b157c986.png)

关键当然是 JOIN 必须与 Date 和 Name 字段匹配。我可以将 T2 的字段连接到 T1。

连接日期和名称上的字段的正确语法是什么（在 SQL 中或通过查询设计器）？

我的尝试重复了字段计数。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T16:44:27.273

使用查询设计窗口，从 T1 拖动 Date 以匹配 T2 中的 Date，同样，将 Name 从 T1 拖动到 T2。这将为您提供有关 bioth 名称和日期的 INNER JOIN。切换到 SQL 视图以查看 SQL。

顺便说一句，名称和日期都是保留字。特别是在 MS Access 中调用任何名称都是一件可怕的事情，所以我希望这些是虚构的字段（列）名称。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-30T16:53:38.497

sql是

```
Select T1.Name, T1.Date,T1.Alpha, T2.Beta
From T1
Inner Join T2 On T1.Name = T2.Name and T1.Date = T2.Date 
```

并停止使用对象名称的保留字......

# objective-c - NSDateFormatter 不适用于下午 4:15:00

> ID：10820565
> 
> 赞同：0
> 
> 时间：2012-05-30T16:41:45.377
> 
> 标签：objective-c, nsdate, nsdateformatter

如何将“下午 4:15:00”转换为 NSDate？下面是我的代码：

```
NSDateFormatter *df = [[NSDateFormatter alloc] init];
[df setDateFormat:@"HH:mm:ss aa"];
NSDate *date =  [df dateFromString:@"4:15:00 PM"];

NSLog(@"date: %@",date);//outputs: 1970-01-01 17:15:00 +0000
//should output: 1970-01-01 16:15:00 +0000 
```

更新：我根据回复进行了更新，但仍然显示不正确：

```
NSLog(@"date: %@",[df stringFromDate:date]);//outputs: 12:15:00 PM
//should output: 4:15:00 PM 
```

**问题是为什么时间会从下午 4:15:00 到下午 12:15:00 发生变化。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T16:44:51.053

实际上，这是正确的。

但是，调试器并以 GMT`NSLog` **显示**时间。

如果要显示当地时间，请使用 a`NSDateFormatter`和`stringFromDate`。

**更新：**
您的日期格式化程序格式也设置不正确。

应该是： `[df setDateFormat:@"hh:mm:ss aa"];`因为您使用的是 12 小时制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T16:44:30.930

这是因为您的语言环境。

`NSDateFormatter`输出 NSDate - 始终为 GMT 时间。

如果您希望将初始字符串解释为 GMT 时间，则需要包含时区。

```
NSDateFormatter *df = [[NSDateFormatter alloc] init];
[df setDateFormat:@"HH:mm:ss aa z"];
NSDate *date =  [df dateFromString:@"4:15:00 PM GMT"]; 
```

# php - 如何使用站点 API 对用户进行身份验证？

> ID：10820566
> 
> 赞同：1
> 
> 时间：2012-05-30T16:41:53.203
> 
> 标签：php, api, oauth

我想为用户构建一个 API 来构建可以轻松与站点交互的应用程序，我想知道验证用户的最佳方式是什么。

看看其他 API，其中很多是让用户通过 HTTPS 连接将用户名和密码作为 GET 参数发送。这是最好的方法吗？还是我应该研究或考虑其他方法？

我已经看到 OAuth 被抛来抛去，它看起来是一个很好的解决方案，但仅仅对于一个简单的 API 来说是不是有点矫枉过正？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T14:20:29.897

GET 中的用户名/密码不是一个很好的方法，因为即使 API 的功能比登录站点更有限，您也可能会暴露整个用户帐户以进行劫持。因此，最好将网站登录和 API 访问之间的关注点分开。

我不确定您属于哪种情况，但是：

*   如果用户是某种商业客户，他们在另一个网站中嵌入了某种类型的小部件或代码，那么最好使用范围为引用域的 API 密钥（就像谷歌地图一样）。

*   如果他们是对 API 一无所知但将使用第三方构建的应用程序的最终用户，那么 oAuth 可能是您最好的选择，否则您的用户可能实际上会将他们的用户名/密码提供给未知的第三方派对。它更复杂，但从长远来看可能是值得的。

要开箱即用这些东西，您可以使用 3scale (http://www.3scale.net) 之类的东西，它会为您处理大部分内容（免责声明，我在那里工作，所以调整偏见！）或者在大多数语言中都有用于 oAuth 的开源库（在 PHP Zend-OAuth 组件中可能会为您完成这项工作）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T16:49:47.020

您可以使用 API 密钥。根据请求生成与帐户绑定的唯一哈希。然后检查该密钥是否为有效密钥。只要 API 对使用他人密钥的人没有任何重大安全问题，则不需要授权。如果有人使用其他人的密钥出现问题，那么身份验证将是合理的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T17:26:46.743

这通常是通过 cookie 实现的。

**客户端通过POST**请求将其用户名和密码发送到您的 API（不要*使用*GET，这是不安全的）。如果凭证是可接受的，则生成一个随机的、唯一的会话密钥，将其存储在您身边，并以 ​​cookie 的形式将其发送回客户端（请参阅 参考资料[`setcookie()`](http://php.net/manual/en/function.setcookie.php)）。

当客户端现在发出进一步的请求时，它们会随请求发送会话密钥 cookie。检查`$_COOKIE`会话密钥是否与您存储的密钥匹配；如果是，则表示用户已通过身份验证。

请注意，这个最小示例很容易受到试图猜测有效会话密钥的暴力攻击。您需要记录客户端在其 cookie 中发送的无效密钥，并在一段时间内阻止其 IP 地址以防止这种情况发生。

# c# - 如何访问 .aspx 页面中的控件

> ID：10820567
> 
> 赞同：0
> 
> 时间：2012-05-30T16:41:53.640
> 
> 标签：c#, asp.net, .net, radiobuttonlist

`radiobuttonlist`我在页面后面的代码中附加事件，单选按钮列表在
`listview`.当我运行程序时它会生成一个错误： ***“对象引用未设置为对象的瞬间”***

**.aspx 代码：**

```
<asp:ListView ID="ListView1" runat="server" >
  <ItemTemplate>
       <tr><td>
  <asp:RadioButtonList ID="radiobuttonlist4" runat="server" AutoPostBack="true" 

        RepeatDirection="Horizontal"
        OnSelectedIndexChanged="selected" Width="240px">
    <asp:ListItem  Value="agree"></asp:ListItem>
       <asp:ListItem Value="disagree"></asp:ListItem>
          <asp:ListItem Value="strongagree"></asp:ListItem>
             <asp:ListItem Value="strongdisagree"></asp:ListItem>
    </asp:RadioButtonList>

</td>
       </tr>
  </ItemTemplate>
 </asp:ListView> 
```

**.aspx.cs 代码**

```
assessdal s = new assessdal();

ListView1.DataSource = s.showop1();
ListView1.DataBind();
RadioButtonList list=  ListView1.FindControl("radiobuttonlist4") as RadioButtonList;

list.SelectedIndexChanged += new EventHandler(handle);

public void handle(object sender, EventArgs e)
{
    Label2.Text = "y";      
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:57:52.163

首先，我修复了您代码中的大量拼写错误。

其次，它没有找到它，因为`FindControl`它被调用`ListView1`，而不是页面（或它所在的控件层次结构），并且`FindControl`只在该实例的子控件中查找。

尝试`Page.FindControl("radiobuttonlist4")`在页面中找到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T18:06:04.993

您应该在 aspx 上以声明方式附加事件处理程序，这是最简单的方法。

```
<asp:RadioButtonList ID="radiobuttonlist4" runat="server" AutoPostBack="true" 
     RepeatDirection="Horizontal"
     OnSelectedIndexChanged="selected" 
     Width="240px">
</asp:RadioButtonList> 
```

由于`ListView`可以包含多个项目，因此[`NamingContainer`](http://msdn.microsoft.com/en-us/library/system.web.ui.control.namingcontainer.aspx)其中的控件`Itemtemplate`不是`ListView`，而是`ListViewItem`。这确保了每个控件在客户端都有一个唯一的 id。

所以你可以`RadioButtonList`通过这种方式在按钮的点击事件处理程序中找到你的：

```
var button = (Button)sender;
var item = (ListViewItem)button.NamingContainer;
var radiobuttonlist4 = (RadioButtonList)item.FindControl("radiobuttonlist4"); 
```

如果您想在它的`SelectedIndexChanged`事件中“找到” RadioButtonList，只需相应地转换`sender`参数 ( `var rbl = (RadioButtonList)sender;`)。

# python - 在 Python 中从文本文件中绘制数据

> ID：10820569
> 
> 赞同：2
> 
> 时间：2012-05-30T16:41:55.127
> 
> 标签：python

我有一个带有用户名的文本文件以及他们用于以这种格式发布推文的应用程序。这是文件中的一个小样本。

```
John, Twitter for iPhone
Doe, web
Jack, Twitter for Android
foo, Twitter for iPhone
bar, Twitter for iPhone
foo1, TweetDeck
John1, Twitter for iPhone
Doe2, web
Jack3, Twitter for Android
foo2, Twitter for iPhone
bar2, Twitter for iPhone
foo3, Tweet Button
a1,Twitter for iPhone
a2,web
s1,Mobile Web
s2,Twitter for iPhone
s3,Twitterrific 
```

如何将应用程序信息绘制为条形图或饼图？我不在乎用户名。只是一个比较不同应用程序的图表。哪个图表库非常适合像这样的简单绘图？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T16:55:09.760

下面是一些示例代码，可帮助您开始使用`Matplotlib`. 我假设您已将数据保存到名为`data.txt`.

```
import matplotlib.pyplot as plt

apps = {}

with open('data.txt', 'r') as f:
    lines = f.readlines()

for line in lines:
    app = line.split(',')[1].strip()
    if app not in apps:
        apps[app] = 1
    else:
        apps[app] += 1

data = [(k,apps[k]) for k in apps]
data_s = sorted(data, key=lambda x: x[1])

x = [app[1] for app in data_s]
l = [app[0] for app in data_s]
plt.pie(x)
plt.legend(l, loc='best')

plt.show() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T17:30:34.547

我重用了@Brandan 的代码，并且（会尊重）通过引入[collections.Counter来改进它](http://docs.python.org/dev/library/collections.html#collections.Counter)

```
import matplotlib.pyplot as plt
import collections

with open('data.txt', 'r') as f:
    data_s = collections.Counter([line.split(',')[1].strip() for line in f.readlines()]).most_common()

x = [app[1] for app in data_s]
l = [app[0] for app in data_s]
plt.pie(x)
plt.legend(l, loc='best')

plt.show() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T16:47:41.250

[Matplotlib](http://matplotlib.sourceforge.net/)是一个流行的选项，它有很好的例子。

我个人使用过[PyX](http://pyx.sourceforge.net/)，我发现它对于某些类型的图表比其他图表更简单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-30T16:46:31.250

我用[pygooglechart](http://pygooglechart.slowchop.com/)。它简单、直观并且有很好的[例子](https://github.com/gak/pygooglechart/tree/master/examples)。

先看看[这个](https://stackoverflow.com/questions/52652/pretty-graphs-and-charts-in-python)。

# couchdb - CouchDB 中的多键搜索

> ID：10820579
> 
> 赞同：6
> 
> 时间：2012-05-30T16:42:26.560
> 
> 标签：couchdb

给定以下对象结构：

```
{
   key1: "...",
   key2: "...",
   data: "..."
} 
```

有没有办法通过查询 key1 和 key2 从 CouchDB 获取此对象，而无需设置两个不同的视图（每个键一个），例如：

```
select * from ... where key1=123 or key2=123 
```

亲切的问候， Artjom

**编辑：**

这里有一个更好的问题描述： 上面描述的对象是一个序列化的游戏状态。一个游戏只有一个创作者用户（key1）和他的对手（key2）。对于给定的用户，我想获得他参与的所有游戏（作为创造者和对手）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T05:40:21.267

发出两个键（如果相等，则只发出一个）：

```
function(doc) {
  if (doc.hasOwnProperty('key1')) {
    emit(doc.key1, 1);
  }
  if (doc.hasOwnProperty('key2') && doc.key1 !== doc.key2) {
    emit(doc.key2, 1);
  }
} 
```

使用（*正确的 url 编码*）查询：

```
?include_docs=true&key=123 
```

或具有多个值：

```
?include_docs=true&keys=[123,567,...] 
```

**更新：**更新为使用单个查询查询多个值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T16:47:28.323

您可以创建一个 CouchDB 视图，该视图产生如下输出：

```
["key1", 111],
["key1", 123],
["key2", 111],
["key2", 123],
etc. 
```

用 javascript 编写地图视图非常简单：

```
function(doc) {
    emit(["key1", doc["key1"]], null);
    emit(["key2", doc["key2"]], null);
} 
```

查询时，可以使用多个key进行查询：

```
{"keys": [["key1", 123], ["key2", 123]]} 
```

您可以将该 JSON 作为 POST 中的数据发送到视图。或者最好为您的编程语言使用 API。此查询的结果将是视图中与任一键匹配的每一行。因此，在 key1 和 key2 上匹配的每个文档都将在视图结果中返回两行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-01-08T12:54:02.687

我也在努力解决类似的问题，如何使用

```
"select * from ... where key1=123 or key2=123". 
```

以下视图将允许您按姓氏**或**名字字段查找客户文档：

```
function(doc) {
  if (doc.Type == "customer") {
      emit(doc.LastName, {FirstName: doc.FirstName, Address: doc.Address});
      emit(doc.FirstName, {LastName: doc.LastName, Address: doc.Address});
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-16T21:17:22.567

我将它用于查询我所有文档并返回与节点的存在和查询匹配的每个文档的 Web 服务。在此示例中，我使用节点“详细信息”进行搜索。如果您想搜索不同的节点，则需要指定。

这是我的第一篇 Stack Overflow 帖子，所以我希望我能帮助别人:)

```
***Python Code

import tornado.httpserver
import tornado.ioloop
import tornado.options
import tornado.web
import httplib, json

from tornado.options import define,options

define("port", default=8000, help="run on the given port", type=int)

class MainHandler(tornado.web.RequestHandler):
    def get(self):
        db_host = 'YOUR_COUCHDB_SERVER'
        db_port = 5984
        db_name = 'YOUR_COUCHDB_DATABASE'

        node = self.get_argument('node',None)
        query = self.get_argument('query',None)

        cleared = None
        cleared = 1 if node else self.write('You have not supplied an object node.<br>')
        cleared = 2 if query else self.write('You have not supplied a query string.<br>')

        if cleared is 2:
            uri = ''.join(['/', db_name, '/', '_design/keysearch/_view/' + node + '/?startkey="' + query + '"&endkey="' + query + '\u9999"'])
            connection = httplib.HTTPConnection(db_host, db_port)
            headers = {"Accept": "application/json"}
            connection.request("GET", uri, None, headers)
            response = connection.getresponse()
            self.write(json.dumps(json.loads(response.read()), sort_keys=True, indent=4))

class Application(tornado.web.Application):
    def __init__(self):
        handlers = [
            (r"/", MainHandler)
        ]
        settings = dict(
            debug = True
        )
        tornado.web.Application.__init__(self, handlers, **settings)

def main():
    tornado.options.parse_command_line()
    http_server = tornado.httpserver.HTTPServer(Application())
    http_server.listen(options.port)
    tornado.ioloop.IOLoop.instance().start()

if __name__ == '__main__':
    main()

***CouchDB Design View
{
   "_id": "_design/keysearch",
   "language": "javascript",
   "views": {
       "detail": {
           "map": "function(doc) { var docs = doc['detail'].match(/[A-Za-z0-9]+/g); if(docs) { for(var each in docs) { emit(docs[each],doc); } } }"
       }
   }
} 
```

# facebook-like - 更改 Facebook Like 按钮的大小

> ID：10820585
> 
> 赞同：9
> 
> 时间：2012-05-30T16:42:45.090
> 
> 标签：facebook-like

我使用下面的代码来获取 Facebook 的 Like 按钮。现在的事情是，我想更改呈现的 Like 按钮的大小。我尝试了根本不起作用的宽度属性。我试图覆盖 facebook 用于以下代码的 CSS 类。但是覆盖 CSS 类也不能正常工作。所以告诉我如何增加Like按钮的高度和宽度。

```
<div class="fb-like" data-href="http://www.xxxxx.com" data-send="true" data-width="450" data-show-faces="true"></div> 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-28T13:52:28.420

或者您可以使用 CSS 定位 iframe 并使用 CSS3 对其进行缩放。像这样的东西：

```
#fbiframe
{
transform: scale(1.5);
-ms-transform: scale(1.5); 
-webkit-transform: scale(1.5); 
-o-transform: scale(1.5); 
-moz-transform: scale(1.5); 
transform-origin: top left;
-ms-transform-origin: top left;
-webkit-transform-origin: top left;
-moz-transform-origin: top left;
-webkit-transform-origin: top left;
} 
```

这是一个例子[http://www.tinydesign.co.uk/like/](http://www.tinydesign.co.uk/like/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-30T16:46:10.147

Facebook Like 按钮由它们提供的 Javascript 片段呈现在 iFrame 中，iFrame 由 Facebook 托管，并且样式不能被覆盖。

完全正确....如果您能够更改“赞”按钮的大小或样式，那么我们会在互联网上看到巨大的、鲜红色的、像按钮一样闪烁的按钮——那将是可怕的。它们被设计为谨慎、可识别且不引人注目。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-30T16:58:12.883

你不能改变这种Facebook按钮的样式，但是如果你使用[JavaScript OpenGraph SDK](http://developers.facebook.com/docs/reference/javascript/)你可以创建你自己的，这样你可以使用一个div（带有自定义信息）或者使用一个图像，基本上自定义它但是你想要它。缺点是它不像使用 Facebook 生成的按钮那样直接，而且你需要一个 App Id 并且用户给你一些权限，但除此之外你可以随意使用它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-23T06:04:52.413

为 iframe 创建 div 类

```
<div class='like-btn'>
<iframe src="https://www.facebook.com/plugins/like.php?href=https%3A%2F%2Fdevelopers.facebook.com%2Fdocs%2Fplugins%2F&amp;width=105&amp;layout=button_count&amp;action=like&amp;show_faces=false&amp;share=false&amp;height=35&amp;appId=422608707941592" width="105" height="35" style="border:none;overflow:hidden" scrolling="no" frameborder="0" allowTransparency="true"></iframe>
  </div> 
```

现在添加这个 CSS

```
.like-btn iframe{margin:0 auto;float;none;border-radius:3px;display:block;max-width:105px;padding-top:2px;padding-left:2px;box-shadow:2px 2px 0px #222;height:35px;border:6px solid #3D58A4 !important;background: #3D58A4} 
```

结果：

[Facebook喜欢演示](http://i.stack.imgur.com/VbWO4.png)

如果您不希望按钮位于中心，则可以使用浮动而不是边距

# android - 使用本机 API 进行屏幕截图？

> ID：10820587
> 
> 赞同：0
> 
> 时间：2012-05-30T16:42:57.297
> 
> 标签：android, screenshot, native, android-4.0-ice-cream-sandwich, capture

Ice Cream Sandwich 中是否有任何本机 API（C 代码）可用于捕获整个屏幕？我需要它在 C 程序中完成，而不是使用`adb`或 Java 接口。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T14:23:54.690

androidscreenshot项目[正是这样做的](http://code.google.com/p/androidscreenshot/source/browse/trunk/Binary/screenshot.c?r=3)[，](http://code.google.com/p/androidscreenshot/)但您需要以root 身份运行或让您的二进制文件由供应商密钥（即编译操作系统时使用的相同密钥）签名。在 Internet 上和其他地方有很多关于此限制的讨论。

# c# - 播放器索引和播放器索引？

> ID：10820589
> 
> 赞同：0
> 
> 时间：2012-05-30T16:43:15.530
> 
> 标签：c#, input, xna

我对 PlayerIndex 以及如何使用它有疑问。

问题是第二个控制器（controllingPlayer2）有时需要为“null”（例如，对于一个玩家模式），但 GetState 不能接受 null 变量。

我有一个像这样的课程（对于我的游戏屏幕）：

```
 public GameScreen(PlayerIndex? controllingPlayer, PlayerIndex? controllingPlayer2)
    {
        this.ControllingPlayer = controllingPlayer;
        this.ControllingPlayer2 = controllingPlayer2;
    }

    public override void HandleInput()
    {
        // Move the character UP - Problem appears at the GetState Here wanting a PlayerIndex not a null?
        if (GamePad.GetState(ControllingPlayer).IsButtonDown(controls.BUp))
        {
            P1movementY--;
        }

        // Move the second character UP - Problem appears at the GetState Here wanting a PlayerIndex not a null?

        if (GamePad.GetState(ControllingPlayer).IsButtonDown(controls.BUp))
        {
            P2movementY--;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:47:46.107

如果提前阻塞，请与 && 一起使用以短路

```
 if (ControllingPlayer2 != null && GamePad.GetState(ControllingPlayer2).IsButtonDown(controls.BUp))
    {
        P2movementY--;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T16:50:24.010

简短的回答，检查是否（ControllingPlayer！= null），然后使用 ControllingPlayer.Value。

更长的形式，C# 中的问号语法允许您将值类型传递为 null，对于该类型，null 不是可分配的值。它是 Nullable<PlayerIndex> 的简写，它有几个属性，例如 HasValue:bool 和 Value:PlayerIndex。它与类型的非 Nullable 版本并不完全相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T17:01:00.747

[这应该可以解决问题，您可以在此处](http://msdn.microsoft.com/en-us/library/b3h38hb0.aspx)查看 Nullable 的工作原理。

```
public override void HandleInput()
{
    if (ControllingPlayer.HasValue && GamePad.GetState(ControllingPlayer.Value).IsButtonDown(controls.BUp))
    {
        P1movementY--;
    }

    if (ControllingPlayer2.HasValue && GamePad.GetState(ControllingPlayer2.Value).IsButtonDown(controls.BUp))
    {
        P2movementY--;
    }
} 
```

# wai-aria - 由 JAWS 隐藏的 aria-hidden true 读取

> ID：10820594
> 
> 赞同：3
> 
> 时间：2012-05-30T16:43:30.707
> 
> 标签：wai-aria, jaws-screen-reader

使用 jQuery 在#div1 中添加角色警报，读取#div2 内容，即使它对 JAWS 是隐藏的。

```
<div id="div1">
     some content 
    <div id="div2" aria-hidden="true">
           some content 2 for div
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T19:25:17.913

JAWS 在其 13.0.718 更新（2012 年 2 月）中添加了对 aria-hidden 属性的支持。请参阅下面的完整更改日志：

[http://www.freedomscientific.com/downloads/jaws/JAWS13-previous-enhancements.asp](http://www.freedomscientific.com/downloads/jaws/JAWS13-previous-enhancements.asp)。

> JAWS 现在可以识别 aria-hidden 属性，以便不再宣布应该隐藏的文本。

它似乎对我有用，但我注意到包装在“隐藏”容器中的可选项卡内容仍然可以由 JAWS 导航和读取。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T19:01:54.443

目前，JAWS 在 Internet Explorer 和 Firefox 中都不支持 aria-hidden 状态。

您可以使用 role="presentation" 虽然不推荐。

也可以看看：

*   [官方 JAWS 咏叹调支持列表](http://freedomscientific.com/PDF/visionloss/manuals/DevDoc/JAWS-ARIA-Support.doc)

*   [唐纳德·埃文斯的博客](http://websiteaccessibility.donaldevans.com/2011/06/22/aria-hidden/)

# javascript - 删除输入时javascript div消失

> ID：10820597
> 
> 赞同：0
> 
> 时间：2012-05-30T16:43:34.470
> 
> 标签：javascript, jquery, html, input, hide

我有一个关于以下的问题：

我有一个 div `display:none`。一旦用户在输入字段中输入文本（使用 jQuery show() 方法），该 div 就会出现。一切正常，但是一旦我删除输入字段中的文本，我希望 DIV 再次消失。我的尝试：

`function`如果输入为空，请在 jQuery函数中使用另一个`hide()`，但它会阻止触发使用 show() 的函数（因为默认情况下输入显然为空）。

任何想法将不胜感激！

这是我的脚本：

```
function password1Security()

{
var pwd1 = document.getElementById("password1");
var strongRegex = new RegExp("^(?=.{8,})(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])(?=.*\\W).*$", "g");
var mediumRegex = new RegExp("^(?=.{7,})(((?=.*[A-Z])(?=.*[a-z]))|((?=.*[A-Z])(?=.*[0-9]))|((?=.*[a-z])(?=.*[0-9]))).*$", "g");
var pwdsft = document.getElementById("passwordSafetyLevel1");

{
if (strongRegex.test(pwd1.value)){pwdsft.innerHTML = '<span style="color:green;">Safe</span>'} else if (mediumRegex.test(pwd1.value)) 

{pwdsft.innerHTML = '<span style="color:orange;">Quite Safe</span>'} else {pwdsft.innerHTML = '<span style="color:red;">Unsafe</span>'};
}
};

function passSafetyAppear1()

{$("#passwordSafety1").show()};

function showPassSafety1()

{
password1Security();
passSafetyAppear1();
};

</script>

<input name="password1" id="password1" type="password" size="15" maxlength="20" style="width:500px; height:30px;" 

onKeyUp="showPassSafety1()"/>
<br/>

<span name="passwordSafety1" id="passwordSafety1" style="font-size:12pt; display:none;">Your password is <b 

name="passwordSafetyLevel1" id="passwordSafetyLevel1"></b>.</span><br/> 
```

先感谢您，

皮埃尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:47:32.863

对模糊执行该操作（当输入失去焦点时）。使用这样的代码和适当的选择器来实现这一点：

```
$('input-selector').blur(function(){
    if(!$(this).val())
        $('div-selector').hide();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T16:48:59.960

您可以按照以下方式做一些事情：**[jsFiddle example](http://jsfiddle.net/j08691/dmwFg/)**。

```
$('input').keyup(function() {
    if ($(this).val().length > 0) $('div').show();
    else $('div').hide();
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T16:50:04.617

```
$('input-selector').keyup(function(){
        if ($(this).val().length > 0)
           $('div-selector').show();
        else
           $('div-selector').hide();
}); 
```

试试...

# ruby-on-rails - Rails - 控制器\测试中的不同Time.now？

> ID：10820602
> 
> 赞同：0
> 
> 时间：2012-05-30T16:43:45.010
> 
> 标签：ruby-on-rails, ruby, time, integration-testing

我正在使用带有 ROR 4.0 的 Agile WD 开发应用程序。

我在 order_controller 中有一个 order receive_date，还有一个检查它的集成测试。控制器创建一个订单，测试检查日期和时间是否相同。由于某种原因，差异是 1 天和 3 小时？这怎么可能，在两种情况下都使用相同的函数来获取日期。这是测试，然后是控制器和测试输出：

测试：

```
test "buying a product" do
  LineItem.delete_all
  Order.delete_all
  ruby_book = products(:ruby)
  get"/"
  assert_response :success
  assert_template "index"
  xml_http_request :post, '/line_items', product_id: ruby_book.id
  assert_response :success
  cart = Cart.find(session[:cart_id])
  assert_equal 1, cart.line_items.size
  assert_equal ruby_book, cart.line_items[0].product
  get"/orders/new"
  assert_response :success
  assert_template "new"
  receive_date_expected = Time.now.to_date
  post_via_redirect "/orders",
    order: { name: "Dave Thomas",
             address: "123 TheStreet",
             email: "dave@example.com",
             pay_type: "Check"}
  assert_response :success
  assert_template "index"
  cart = Cart.find(session[:cart_id])
  assert_equal 0, cart.line_items.size
  orders = Order.all
  assert_equal 1, orders.size
  order = orders[0]
  assert_equal "Dave Thomas", order.name
  assert_equal "123 TheStreet", order.address
  assert_equal "dave@example.com", order.email
  assert_equal "Check", order.pay_type
  assert_equal receive_date_expected, order.receive_date.to_date
  assert_equal 1, order.line_items.size
  line_item = order.line_items[0]
  assert_equal ruby_book, line_item.product
  mail = ActionMailer::Base.deliveries.last
  assert_equal ["dave@example.com"], mail.to
  assert_equal 'Sergey Sob <j0nybr4v0@gmail.com>', mail[:from].value
  assert_equal "Pragmatic Store Order Confirmation", mail.subject
end 
```

控制器：

```
def create
@order = Order.new(params[:order])
@order.add_line_items_from_cart(current_cart)
@order.receive_date = Time.now.to_date
respond_to do |format|
  if @order.save
    Cart.destroy(session[:cart_id])
    session[:cart_id] = nil
    OrderNotifier.received(@order).deliver
    format.html { redirect_to store_url, notice: 'Thank you for your order' }
    format.json { render json: @order, status: :created, location: @order }
  else
    @cart = current_cart
    format.html { render action: "new" }
    format.json { render json: @order.errors, status: :unprocessable_entity }
  end
end 
```

这是输出：

```
 1) Failure:
test_buying_a_product(UserStoriesTest) [c:/Ruby193/work/depot/test/integration/u
ser_stories_test.rb:44]:
<Wed, 30 May 2012> expected but was
<Tue, 29 May 2012>. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T17:06:12.680

尝试将它们与 UTC 进行比较。打电话`#utc`给他们，然后检查。有什么区别吗？一定要确保你总是可以拜访`#zone`他们，看看他们是否匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T16:52:25.583

这似乎是某种时区问题。

尝试到处替换，它可能会有所帮助`Time.now`。`Time.zone.now`

# javascript - 在事件回调中获取对模型的引用

> ID：10820610
> 
> 赞同：2
> 
> 时间：2012-05-30T16:44:35.547
> 
> 标签：javascript, jquery, events, backbone.js

我不确定我是否做对了，第一次玩 Backbone.js。

我有两个带有两个模型的视图，我想使用[事件聚合器](https://stackoverflow.com/a/7843636/74022)方法在两者之间触发事件。

聚合器声明：

```
Backbone.View.prototype.eventAggregator = _.extend({}, Backbone.Events); 
```

所以在一个视图中，我有一条这样的行会触发该`removeRow`方法。

```
this.eventAggregator.trigger("removeRow", this.row); 
```

在另一个视图中

```
MyView = Backbone.View.extend({
    initialize: function() {
      this.eventAggregator.bind("removeRow", this.removeRow);
      this.model.get("rows").each(function(row) {
        // Do stuff
      }); 
    },
    removeRow: function(row) {
       // row is passed in fine
       // this.model is undefined
       this.model.get("rows").remove(row);
    }
}); 
```

我想我明白为什么`this.model`是未定义的，但我能做些什么来维护一个引用，以便我可以`this.model`在回调中使用？我曾考虑将模型传递给第一个视图，然后在`trigger`调用中将其传回，但这似乎使事件聚合器的全部意义变得毫无意义。如果我有模型，我可以直接调用该`.remove`方法并且失去了我的第一个视图不知道模型的好处。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T17:02:27.473

我认为你有*绑定*问题。

您有两种方法可以确保`this`将是*View 实例*：

### 1.使用`bindAll`

在你的`View.initialize()`你可以添加这一行：

```
_.bindAll( this, "removeRow" ) 
```

[@DerickBailey 关于此事的有趣帖子](http://lostechies.com/derickbailey/2011/06/15/solving-backbones-this-model-view-problem-with-underscore-js/)

### 2\. 在绑定声明中使用可选的第三个参数

像这样：

```
this.eventAggregator.bind("removeRow", this.removeRow, this); 
```

[关于此事的骨干文档](http://documentcloud.github.com/backbone/#FAQ-this)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T16:55:39.830

提供您的 View 对象作为绑定方法的第三个参数：

```
this.eventAggregator.bind("removeRow", this.removeRow, this); 
```

第三个参数是调用回调的上下文。请参阅[文档](http://documentcloud.github.com/backbone/#Events-on)。

此外，您可以使用**.on()**而不是更短的**.bind()** ...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-30T16:55:47.553

您需要绑定`this`，以免丢失范围。另一个答案的博客链接使用下划线`bindAll`

```
initialize: function() {
  _.bindAll(this, 'removeRow');
  this.eventAggregator.bind("removeRow", this.removeRow);
  this.model.get("rows").each(function(row) {
    // Do stuff
  }); 
}, 
```

# security - 装配安全

> ID：10820614
> 
> 赞同：7
> 
> 时间：2012-05-30T16:44:54.123
> 
> 标签：security, assembly

我目前正在为某些人提供汇编编译服务。他们可以在在线编辑器中输入汇编代码并进行编译。然后编译它时，代码会通过 ajax 请求发送到我的服务器，被编译并返回程序的输出。

但是，我想知道我能做些什么来防止对服务器造成任何严重损坏。我对自己组装很陌生，所以当他们在我的服务器上运行他们的脚本时有什么可能？他们可以删除或移动文件吗？有没有办法防止这些安全问题？

先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T15:42:21.470

看看[http://sourceforge.net/projects/libsandbox/](http://sourceforge.net/projects/libsandbox/)。它专为在 linux 服务器上执行您想要的操作而设计：

> 该项目提供 C/C++/Python 中的 API，用于在受限环境或沙箱中测试和分析简单（单进程）程序。可以根据可配置/可编程策略捕获和阻止二进制可执行程序的运行时行为。
> 
> 沙盒库最初是作为 ACM/ICPC 培训的成熟在线裁判系统的核心安全模块而设计和使用的。从那时起，它们已经发展成为用于二进制程序测试、分析和安全限制的通用工具。沙盒库目前由 OpenJudge Alliance (http://openjudge.net/) 作为独立的开源项目维护，以促进 IT/CS 教育的各种作业评分解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T18:06:15.187

如果这是一个教程服务，那么客户端只需要测试杂项汇编代码并且不需要在他们的程序之外执行操作（例如读取或修改文件系统），那么另一个选项是只允许选择的子集指示。特别是，不允许任何可以进行系统调用的指令，并且只允许有限的控制转移指令（例如，不返回，只分支到用户代码中定义的标签，等等）。您还可以提供一些有限的方法来返回输出，例如打印特定寄存器中的任何值的库调用。不允许在文本（代码）部分中声明数据，因为可以输入任意机器代码作为数字数据定义。

尽管我写了“另一个选项”，但这应该是其他受访者建议的其他选项的补充，例如沙盒。

这种方法容易出错，如果使用，应该仔细和彻底地设计。例如，一些汇编器允许在一行上执行多条指令。因此，仅仅确保一行的第一个指令字段中的文本是可接受的，就会错过该行的其余指令。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T04:34:37.907

在你的服务器上编译和运行别人的任意代码就是任意代码执行。任意代码执行是每个恶意黑客追求的圣杯。有人可能会使用这个问题来找到您的服务并在这一秒内利用它。立即停止运行服务。如果您希望继续运行此服务，您应该在沙箱中编译并运行该程序。但是，在此实施之前，您应该暂停服务。

您应该在虚拟机沙箱中运行代码，因为如果代码是恶意的，沙箱将阻止代码损坏您的实际操作系统。一些虚拟机包括 VirtualBox 和 Xen。您还可以对代码执行某种签名检测以搜索已知的恶意功能，尽管可以击败任何形式的签名检测。

这是 VirtualBox 主页的链接：[https ://www.virtualbox.org/](https://www.virtualbox.org/)

这是 Xen 的链接：http: [//xen.org/](http://xen.org/)

# sql - 如何插入到许多字段都有自己的 Select 语句的地方？

> ID：10820616
> 
> 赞同：0
> 
> 时间：2012-05-30T16:45:02.577
> 
> 标签：sql, tsql, sql-server-2008-r2

我创建了一个表，并且正在将另一个表中的行插入其中。但是，其中一些行需要来自其他表的连接。据我所知，这意味着在语句中使用子查询选择语句。问题是子查询只返回一个结果，我可能有很多。我想在不存在记录的情况下返回 -1。这是我正在使用的示例，但它不起作用：

```
 INSERT INTO [BDW_ReportPrototype].[dbo].[CustomerCreditFact]
    ( [MortgageDimID]
       ,[LeaseDimID]
       ,[OREODimID]
       ,[OfficerTypeDimID] )
    SELECT 
    --[MortgageDimID]
 -2
    --LeaseDimID
,-2
    --OREODimID
,-2
,CASE WHEN OfficerTypeDimID IS NULL THEN -1 ELSE OfficerTypeDimID END 
FROM Staging_FDB_LN_CPDM_Daily LCD  
LEFT OUTER JOIN ERMA..OfficerTypeDim  OTD  on OTD.OfficerNum = LCD.OFFICER 
FROM dbo.Staging_FDB_LN_CPDM_Daily 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T16:50:00.640

试试这个 sql 语句

```
SELECT CASE WHEN OfficerTypeDimID IS NULL THEN -1 ELSE OfficerTypeDimID END
    FROM Staging_FDB_LN_CPDM_Daily LCD 
    LEFT OUTER JOIN ERMA..OfficerTypeDim  OTD  on OTD.OfficerNum = LCD.OFFICER 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T16:53:26.487

我会修改您的查询，如下所示。

首先，在查询中使用 LEFT OUTER JOIN 而不是子查询。这种类型的连接表示“其他”表中可能存在一行，但它可能不存在，但无论如何我都想要一行。

既然您知道您将拥有所有行，您将想查看那里是否有值。通过合并功能使用简写且更易于维护检查。它基本上是一个值列表（列名、变量或硬编码值），优化器将从列表中选择第一个非空值并使用它。在这里，我们为您的查询提供 -1

```
INSERT INTO 
    [BDW_ReportPrototype].[dbo].[CustomerCreditFact]
(
    [OfficerTypeDimID]
)
SELECT
    -- coalesce returns the first non-null value
    COALESCE(OTD.OfficerTypeDimID, -1) AS OfficerTypeDimID
FROM 
    dbo.Staging_FDB_LN_CPDM_Daily LCD
    LEFT OUTER JOIN
        ERMA..OfficerTypeDim OTD
        ON OTD.OfficerNum = LCD.OFFICER 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T16:51:15.797

也许沿着这些思路...

```
INSERT INTO [BDW_ReportPrototype].[dbo].[CustomerCreditFact]
    ([OfficerTypeDimID])
    Select OfficerTypeDimID 
        from ERMA..OfficerTypeDim  OTD 
        inner JOIN  Staging_FDB_LN_CPDM_Daily LCD 
        on OTD.OfficerNum = LCD.OFFICER
   UNION ALL 
   SELECT -1
   FROM dbo.Staging_FDB_LN_CPDM_Daily LCD
   WHERE NOT EXISTS 
   (
    Select OfficerTypeDimID from ERMA..OfficerTypeDim  
   OTD 
   WHERE
   OTD.OfficerNum = LCD.OFFICER

   ) 
```

# javascript - 重新加载页面时奇怪的 JQuery 行为

> ID：10820617
> 
> 赞同：0
> 
> 时间：2012-05-30T16:45:03.253
> 
> 标签：javascript, jquery, cross-browser

我的网站导航中有一条“魔术线”（如果我已经在该 URL 上，它会在悬停的菜单元素下滑动并留在那里）。

```
$(function() {
    var $el, leftPos, newWidth, $mainNav = $("#menu");

    $mainNav.append("<li id='magic-line'></li>"); // line with position
                                                    // absolute
    var $magicLine = $("#magic-line");
    // initialization
    if ($('.selected')[0].id == 'logo') { // we're on the main page
        $magicLine.width(1) // just hide
        .css({
            "left" : 100
        }).data("origLeft", 100).data("origWidth", 1);
    } else { // we're on the not-main page
        off = parseInt($('#menu > .selected').css('padding-left').slice(0, -2));
        leftPos = $("#menu > .selected").position().left + off;
        $magicLine.width($(".selected").width()) // stay under the menu
                                                    // element
        .css("left", leftPos).data("origLeft", $magicLine.position().left)
                .data("origWidth", $magicLine.width())
    }

    $("#menu > .nav-item").hover(function() { // go under the menu element
        $el = $(this);
        newWidth = $el.width();
        off = parseInt($el.css('padding-left').slice(0, -2));
        leftPos = $el.position().left + off;
        $magicLine.stop().animate({
            left : leftPos,
            width : newWidth
        }, 200);
    }, function() {
        $magicLine.stop().animate({
            left : $magicLine.data("origLeft"),
            width : $magicLine.data("origWidth")
        }, 200);
    });
}); 
```

我发现了一些奇怪的行为。每个浏览器都略有不同，但趋势是相同的：当我点击菜单元素时——它会转到正确的位置（比如说左边 260 像素），我可以一次又一次地点击，但它仍然在那里。但是当我按 F5 （或只是输入网址）时，它出现在稍微不同的位置（左 256 像素）。所以，我点击同一个元素，它又回到了正确的位置。如果我不停止，它可能会发生巨大变化，并且在 F5 出现在正确位置之后。

So what is the reason this behavior? Is it saves state somehow? What is the difference between F5 and just clicking? Only cause that I see at this moment is my django development webserver which is fully synchronously, slow and non-caching, but I can't check it on production server.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T19:50:05.957

So, the problem was in custom fonts used in menu (@font-face) and the related width. If font is changed to one from the safe list (Arial, Verdana) it's rendered and behaves as I expect, but when custom typeface is used it's collapses. By the way, the browser's JS console gave me this warning: "Resource interpreted as Font but transferred with MIME type application/x-font-otf", but I don't sure whether it related to the problem somehow.

And my solution is simply declare the width for each element, so browser can render it correctly from outset.

# java - 无法设置 JApplet 背景颜色

> ID：10820619
> 
> 赞同：3
> 
> 时间：2012-05-30T16:45:09.817
> 
> 标签：java, swing, colors, background, japplet

我的问题是，当尝试在我尝试创建的 JApplet 中设置背景颜色时，我无法获得除默认灰色以外的任何颜色。

如果有人不仅能告诉我出了什么问题而且还能解释它，我将不胜感激。这种技术是通过教科书学习的，所以我想了解这个问题，以便我知道发生了什么。

任何和所有的帮助表示赞赏。

先感谢您，

可持续发展目标

```
public class QuoteApplet extends JApplet
{

    public void paint (Graphics appPage)
    {
        setBackground(Color.YELLOW);

        appPage.drawRect(65,55,255,100);
        //page.drawRect(60,80,225,30);
        //page.drawOval(75,65, 20, 20);
        appPage.drawLine(30,30,30,100);
        appPage.drawLine(40,30,40,100);
        appPage.drawLine(55,45,15,85);

        appPage.drawString("There once lived a man named Oedipus Rex.", 70, 70);
        appPage.drawString("You may have heard about his odd complex.", 70, 90);
        appPage.drawString("His name appears in Freud's index,", 70, 110);
        appPage.drawString("'cause he loved his mother.", 70, 130);
        appPage.drawString("-Tom Lehrer", 200, 150);
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T16:48:30.750

您要设置小程序的 contentPane 的背景颜色，而不是小程序本身。所以打电话`getContentPane().setBackground(...)`。而且您***不想***在paint方法中执行此操作。而是在`init()`. 事实上，您很少会想要覆盖 JApplet 的绘制方法，当然这里也不会。您最好绘制`paintComponent(...)`JPanel 或其他从 JComponent 派生的类的方法，然后将其添加到 contentPane，或将其用作 contentPane。

# gimp - gimp 命令行

> ID：10820629
> 
> 赞同：1
> 
> 时间：2012-05-30T16:46:00.017
> 
> 标签：gimp

我在 linux 中使用 gimp 2.6，并希望从命令行（插件 > web > slice）运行内置脚本。使用默认选项就可以了，或者在命令行中输入它们就可以了，我真的不在乎。只需从命令行运行内置脚本，然后退出 gimp。但是我在网上找不到一个简单的例子，所有这些都是巨大的脚本，学习曲线非常陡峭。有人可以给我一个例子，说明如何在图像上运行 py-slice 然后退出 gimp 吗？

# git - “git gc”说致命：未能写入 ref-pack 文件

> ID：10820630
> 
> 赞同：4
> 
> 时间：2012-05-30T16:46:00.070
> 
> 标签：git

当我`git gc`在我拥有的存储库上运行时，它说

```
fatal: failed to write ref-pack file
error: failed to run pack-refs 
```

这个错误是什么意思，我该如何解决？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T17:36:11.013

该`.git`目录必须可由您的用户写入，并且您的存储设备上必须有足够的可用空间。

当 Git 创建一个新包时，它首先创建新包，并在验证其正确性后删除旧包以及新打包的松散对象。IOW 您必须至少拥有对象数据库的当前大小作为可用空间（简化）。

# trigger.io - Trigger.io 持续开发

> ID：10820631
> 
> 赞同：2
> 
> 时间：2012-05-30T16:46:00.180
> 
> 标签：trigger.io

我想知道是否有任何方法可以使用 Trigger.io 持续开发，并避免我想在浏览器或模拟器中测试的每个文件更改的伪造构建步骤。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T10:17:35.533

构建阶段对源代码进行了一些更改以启用 forge.* API - 因此，尝试仅使用`src`目录中的原始文件是行不通的。

您可能很想直接在`development`目录中更改文件，但这是一个非常糟糕的主意：我们在需要时删除这些文件而不受惩罚！

我们的中期路线图计划添加一个文件系统观察程序，以便在发生更改时自动启动构建。

与此同时，我只是使用`forge build && forge run PLATFORM`它往往只需要几秒钟......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-20T21:20:33.257

我遇到了同样的问题，我有一个工作解决方案，每次我对源文件进行更改时，它使用 watchr 和 watch 来自动重建。如果您正在运行应用程序的“网络”版本，您可以更改源文件并直接进入浏览器并根据构建所需的时间相当快地查看更改的效果。

先决条件：Ruby、watchr、Unix 'watch' 和终端。

1.  宝石安装观察者。
2.  为 watchr 创建一个新的 ruby​​ 文件，以了解要监视哪些文件以及当它看到更改时要做什么。我将我的文件命名为“my_watch.rb”：[https ://gist.github.com/3153167](https://gist.github.com/3153167)
3.  打开两个终端。终端 1 将运行 watchr，终端 2 将运行“forge build ...”。
4.  在终端 1 中运行“watchr my_watch.rb”，确保 my_watch.rb 的路径正确，并确保您已根据您的设置编辑了 my_watch.rb，以便 watch(...) 中的路径反映要保存的文件看了。我的示例监视与 my_watch.rb 脚本相同的目录（及以下）中的所有文件。如果您想匹配我的示例并直接从 src 文件夹运行 watchr my_watch.rb，您可以将 my_watch.rb 放在 Trigger.io 应用程序的“src”文件夹中。也不需要更新块中的 shell 命令和路径以反映您的环境。同样，在我的示例中，“my_watch.rb”位于“src/”内，因此当检测到更改时，我们会转到一个目录并调用“forge build”。
5.  我倾向于使用我的应用程序的“网络”版本积极开发，所以我可以打开终端 2 到我的 forge 项目目录和“forge run web”。当我在模拟器和设备上进行测试时，是的，每次我想看到更改时，我都必须运行 forge build。但是，我通常不必等待 forge 构建完成，因为 watchr 在我进行更改后立即开始构建并且它发生得很快。

我知道这不是一个理想的解决方案，但到目前为止，首先在“网络”版本中开发新功能，然后在移动版本中实施对我来说非常顺利。我从来不需要在构建后杀死“网络”版本，但我可能只是幸运。至于每次你想测试移动版本时运行构建，如果你对键盘快捷键很好的话，它真的一点也不差。XCode 让您在创建原生 iOS 应用程序时对源代码进行更改后构建和运行，因此我认为 Trigger 在需要此构建步骤方面并不是独一无二的。

我希望这会有所帮助，并且我的回答对我和我的设置来说不是太具体。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T13:19:53.727

虽然不完美......这对我有用。

进入开发/网络

rm src

链接到您的根 src，即 ln -s ../../src src

从 web/forge 复制 all.js 并添加到您的 index.html

IE

启动 nodemon web.js

在浏览器中打开。

请注意，您需要注释掉非 Web 构建的 all.js 脚本标记。

# sharepoint-2010 - 新的用户配置文件服务应用程序后，Share Point 服务器中出现意外错误

> ID：10820634
> 
> 赞同：0
> 
> 时间：2012-05-30T16:46:13.563
> 
> 标签：sharepoint-2010

我删除了 Sharepoint 中央管理中的现有用户配置文件服务应用程序并创建了新的 UPSApplication。现在，当我浏览到共享点时，它会出现意外错误

> 错误
> 
> 发生意外的错误。
> 
> 解决 Microsoft SharePoint Foundation 的问题。
> 
> 相关 ID：9edb793e-587f-40fd-adfc-a​​5332a9722d8
> 
> 日期和时间：2012 年 5 月 30 日上午 9:42:46
> 
> 回到网站...

我尝试在服务中重新启动 Sharepoint 计时器，restiis，重新启动应用程序池..但没有运气..

我还能做些什么来解决这个错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T18:51:17.953

查看 SharePoint ULS 日志 (14/Logs)。错误中列出的相关 ID 与日志中记录的错误相对应。应包括包括堆栈跟踪在内的完整错误。一旦您知道实际错误是什么，您就可以从那里进行调试。

# json - 转换为 JSON 时禁用科学计数法

> ID：10820638
> 
> 赞同：2
> 
> 时间：2012-05-30T16:46:26.577
> 
> 标签：json, r

我在将数据结构转换为 JSON 而不用科学计数法表示数字时遇到问题。

```
library(rjson)

options(scipen=1000)

toJSON(c(1200000000, 400000))

# [1] "[1.2e+08,400000]" 
```

我怎样才能让它输出`"[1200000000,400000]"`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T20:42:24.303

**2018 年更新：**`jsonlite`现在像所有人一样使用：

```
> toJSON(c(1200000000, 400000))
[1200000000,400000] 
```

* * *

**2012年的原始答案：**

我还建议在传递给之前将数字转换为字符串，`toJSON`就像@gauden 上面写的那样。但是，如果您不这样做，请尝试包含一个选项`RJSONIO`的包（无论如何它会更快） ：`digits`

```
>  toJSON(c(1200000000, 400000), digits = 10)
[1] "[  1200000000,      400000 ]" 
```

但这会导致一些额外的空白，如您所见。

* * *

**更新：** @gauden 似乎删除了他的答案，所以添加了一些细节

您可能会`format`在将“数字”转换为 JSON 之前调用例如：

```
> toJSON(format(c(1200000000, 400000), scientific = FALSE, trim = TRUE))
[1] "[\"1200000000\",\"400000\"]" 
```

# vb.net - 使用 VB.NET 和 httpwebrequest cookiecontainer 登录

> ID：10820643
> 
> 赞同：0
> 
> 时间：2012-05-30T16:46:46.133
> 
> 标签：vb.net, cookies, httpwebrequest, cookiecontainer

我认为cookiecontainer（httpwebrequest）有问题

我的班级有两个主要功能，首先获取一个新表单（表单标签中的隐藏令牌），它应该设置 cookie（未设置），然后第二个函数（doLogin）应该登录表单。为什么没有设置cookie...？这是我的代码：（您可以使用“http://wetcatdesign.com/wiki/”作为 wikiURL 来测试我的代码）

```
Public Class wiki_submitter
Dim CookieJar As New CookieContainer
Public wikiURL As String

Private Function cutStr(ByVal Str As String, ByVal startStr As String, _
                        ByVal finishStr As String, Optional ByVal startPos As Integer = 1) As String
    Dim start As Integer = InStr(startPos, Str, startStr) + Len(startStr)
    Dim finish As Integer = InStr(start + 1, Str, finishStr)
    cutStr = Mid(Str, start, finish - start)
End Function

Public Function GetNewForm()
    Try
        Dim req As HttpWebRequest = HttpWebRequest.Create(wikiURL & "index.php?title=Special:UserLogin&returnto=Main_Page")
        Dim res As HttpWebResponse
        req.UserAgent = "Mozilla/5.0 (Windows NT 6.1; rv:11.0) Gecko/20100101 Firefox/11.0"
        res = req.GetResponse()
        'Setting cookies
        req.CookieContainer = CookieJar

        'getting HTML result
        Dim sr As StreamReader = New StreamReader(res.GetResponseStream())
        Dim HTML = sr.ReadToEnd
        sr.Close()

        Dim wpLoginToken As String = cutStr(HTML, "<input type=""hidden"" name=""wpLoginToken"" value=""", """") ' finding wpLoginToken parameter
        GetNewForm = wpLoginToken
    Catch ex As Exception
        MsgBox(ex.Message)
    End Try
End Function

Public Function doLogin(ByVal username As String, ByVal pass As String)
    Dim req As HttpWebRequest = HttpWebRequest.Create(wikiURL & "index.php?title=Special:UserLogin&action=submitlogin&type=login")
    Dim res As HttpWebResponse
    Dim HTML As String
    '-------Setting up headers------------
    req.UserAgent = "Mozilla/5.0 (Windows NT 6.1; rv:11.0) Gecko/20100101 Firefox/11.0"
    req.Referer = wikiURL & "index.php?title=Special:UserLogin&returnto=Main_Page"
    req.ContentType = "application/x-www-form-urlencoded" 'Form content type
    req.Method = "POST" 'data will be send in POST method
    req.CookieContainer = CookieJar 'Setting cookies
    '-------------------------------------

    Dim sw As StreamWriter = New StreamWriter(req.GetRequestStream)
    Dim poststring = "wpLoginToken=" & GetNewForm() & "&wpLoginattempt=Log in&wpName=" & username & "&wpPassword=" & pass
    Try
        sw.Write(poststring)
    Catch ex As Exception
        MsgBox(ex.Message)
    Finally
        sw.Close()
    End Try

    res = req.GetResponse()
    Dim sr As StreamReader = New StreamReader(res.GetResponseStream())
    HTML = sr.ReadToEnd 'HTML as result
    sr.Close()

    doLogin = HTML 'returns HTML result
End Function
End Class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T10:24:45.670

首先，您需要在发送请求之前设置 cookie，其次，您需要在您期望的时候从响应中提取 cookie。这是一种方法

```
Public Class wiki_submitter
    Dim CookieJar As New CookieContainer
    Public wikiURL As String

    Private Function cutStr(ByVal Str As String, ByVal startStr As String, _
                            ByVal finishStr As String, Optional ByVal startPos As Integer = 1) As String
        Dim start As Integer = InStr(startPos, Str, startStr) + Len(startStr)
        Dim finish As Integer = InStr(start + 1, Str, finishStr)
        cutStr = Mid(Str, start, finish - start)
    End Function

    Public Function GetNewForm()
        Try
            Dim req As HttpWebRequest = HttpWebRequest.Create(wikiURL & "index.php?title=Special:UserLogin&returnto=Main_Page")
            Dim res As HttpWebResponse
            req.UserAgent = "Mozilla/5.0 (Windows NT 6.1; rv:11.0) Gecko/20100101 Firefox/11.0"
            res = req.GetResponse()
            'Setting cookies
            'req.CookieContainer = CookieJar
            SaveIncomingCookies(res, wikiURL)

            'getting HTML result
            Dim sr As StreamReader = New StreamReader(res.GetResponseStream())
            Dim HTML = sr.ReadToEnd
            sr.Close()

            Dim wpLoginToken As String = cutStr(HTML, "<input type=""hidden"" name=""wpLoginToken"" value=""", """") ' finding wpLoginToken parameter
            GetNewForm = wpLoginToken
        Catch ex As Exception
            MsgBox(ex.Message)
        End Try
    End Function

    Public Function doLogin(ByVal username As String, ByVal pass As String)
        Dim req As HttpWebRequest = HttpWebRequest.Create(wikiURL & "index.php?title=Special:UserLogin&action=submitlogin&type=login")
        Dim res As HttpWebResponse
        Dim HTML As String
        '-------Setting up headers------------
        req.UserAgent = "Mozilla/5.0 (Windows NT 6.1; rv:11.0) Gecko/20100101 Firefox/11.0"
        req.Referer = wikiURL & "index.php?title=Special:UserLogin&returnto=Main_Page"
        req.ContentType = "application/x-www-form-urlencoded" 'Form content type
        req.Method = "POST" 'data will be send in POST method
        'req.CookieContainer = CookieJar 'Setting cookies
        '-------------------------------------

        Dim sw As StreamWriter = New StreamWriter(req.GetRequestStream)
        Dim poststring = "wpLoginToken=" & GetNewForm() & "&wpLoginattempt=Log in&wpName=" & username & "&wpPassword=" & pass
        Try
            req.CookieContainer = CookieJar
            sw.Write(poststring)
        Catch ex As Exception
            MsgBox(ex.Message)
        Finally
            sw.Close()
        End Try

        res = req.GetResponse()
        SaveIncomingCookies(res, wikiURL)
        Dim sr As StreamReader = New StreamReader(res.GetResponseStream())
        HTML = sr.ReadToEnd 'HTML as result
        sr.Close()

        doLogin = HTML 'returns HTML result
    End Function

    Private Function SaveIncomingCookies(ByRef response As HttpWebResponse, ByRef Uri As String)

        If response.Headers("Set-Cookie") <> Nothing Then
            CookieJar.SetCookies(New Uri("http://wetcatdesign.com"), response.Headers("Set-Cookie"))
        End If

    End Function
End Class 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T21:25:19.480

如果你之前设置它会发生什么`res = req.GetResponse()`？

# php - 在具有给定半径的圆形路径上定位图像（SVG 或 PHP）

> ID：10820644
> 
> 赞同：0
> 
> 时间：2012-05-30T16:46:55.250
> 
> 标签：php, javascript, jquery, svg

我需要创建一个应用程序，用户输入曲线或圆的半径并选择所选图像（具有透明背景的 PNG 图像）将在曲线上变换。

前任。这是图片：

![一个](../Images/c3d6281bd05328f5e45a23d8fe5ce536.png) ![D](../Images/f62578f6ff2eaf13bcb3a0be5930a32e.png) ![花](../Images/1f3bea559d9c65b3305afc36fd930a6e.png)

并且用户在文本字段中输入 100px 的半径并提交，那么结果将是：

![最后结果](../Images/7aeae3bdb6f6abb3b86b5ed4e819979f.png)

图像位于曲线或圆的中心。任何想法和示例代码都会有所帮助，（在 javascript 和 svg 或 php 中）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:51:49.360

看看之前的 StackOverflow 问题：[Align objects to curve with canvas](https://stackoverflow.com/questions/2761896/align-objects-to-curve-with-canvas)

它链接到[一个 JavaScript 库以获取数学方面的帮助](http://mathext.sourceforge.net/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T19:36:16.213

有 jQuery Roundrr，[http://www.addyosmani.com/resources/roundrr/](http://www.addyosmani.com/resources/roundrr/)

您可以构建一些用户可以选择参数（如半径等）、选择图像、订购...
然后将数据传递给PHP 并生成最终图像。

# php - 使用 PHP 检查元素（ID）是否分配了特定的类

> ID：10820645
> 
> 赞同：1
> 
> 时间：2012-05-30T16:47:00.000
> 
> 标签：php, css, class, drupal, element

我想要在我的 template.php（drupal 主题）中是这样的：

```
$search_button ='search-button.png';
if($('#page-wrapper').hasClass('blue-colour')) {
    $search_button ='search-button-blue.png';
}
else if ($('#page-wrapper').hasClass('green-colour')) {
    $search_button ='search-button-green.png';
}
$form['actions']['submit'] = array('#type' => 'image_button', '#src' => base_path() . path_to_theme() . '/images/'.$search_button); 
```

这不起作用，因为它是 jQuery。问题是这个位的语法：

> if($('#page-wrapper').hasClass('blue-colour'))

我如何在不使用 javascript 或 jQuery 且仅使用 php 和/或某些 Drupal 函数的情况下做同样的事情？

我想根据在 HTML 元素上设置的类替换搜索框的图标：

```
<div id="page-wrapper" class="blue-colour"> 
```

在这种情况下，它将检查该类是否为“蓝色”，并在变量（$search_button）上设置正确的蓝色图标。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T16:57:46.517

javascript 和 jQuery 是客户端，这意味着页面已经加载并且 javascript 直接在客户端计算机上对加载的 DOM 进行操作。

PHP是服务器端的，这意味着页面是由PHP在服务器上编写的，然后超文本将被传输到客户端的计算机上。

除非您已经知道该类，否则根据类更改图像将需要客户端代码。

例如，

```
$class = 'blue-colour';
switch ($class) {
    case 'blue-colour':
        echo '<img src="blue-colour.jpg" alt="blue-colour" />'
        break;
    default:
        echo '<img src="default.jpg" alt="default" />';
} 
```

如何确定类取决于您的代码，但必须在页面解析期间完成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T17:12:40.677

这不能直接回答您的问题，但是您可以仅使用 css 很好地解决此问题：

1.  不要为您的按钮使用图像，而是使用文本并执行类似的操作`text-indent: -9999em;`
2.  将按钮的背景图像设置为您想要的图像（简单示例）：

```
.blue-colour .button {
   background: url(search-button-blue.png);
}
.green-colour .button {
   background: url(search-button-green.png);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T17:02:25.633

您可以尝试使用 dom 解析器，尽管它会很棘手。

[http://simplehtmldom.sourceforge.net/manual.htm](http://simplehtmldom.sourceforge.net/manual.htm)

# java - 在 longClick 上设置选择？

> ID：10820648
> 
> 赞同：1
> 
> 时间：2012-05-30T16:47:03.263
> 
> 标签：java, android

如何将长按项目设置为选中？这不起作用（单击时项目不会保持选中状态）：

```
listView.setOnItemLongClickListener(new OnItemLongClickListener() {
            @Override
            public boolean onItemLongClick(AdapterView<?> parent, View view,
                  int position, long id) {
                listView.setSelection(position);
                return true;
            }
        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T16:53:14.140

尝试使用 `view.setSelected(true);` 如果您的列表视图项目的背景已选择状态 - 这会将背景更改为此选定状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T17:07:01.840

如果您尝试使用多选列表，请确保将其标记为：

```
listView.setChoiceMode(ListView.CHOICE_MODE_MULTIPLE); 
```

如果它是单选列表，您仍然需要将其标记为“选择模式”列表，而不是单击仅执行操作而不选择项目的列表。

```
listView.setChoiceMode(ListView.CHOICE_MODE_SINGLE); 
```

而且由于您已经将要选择的视图作为参数传入，因此您不需要按位置设置，而是可以按视图设置，如下所示：

```
view.setSelected(true); 
```

# javascript - 在 UI 中的元素之间传递数据

> ID：10820651
> 
> 赞同：0
> 
> 时间：2012-05-30T16:47:06.943
> 
> 标签：javascript, html, model-view-controller, google-app-engine

我是 Web 应用程序的新手，我正在尝试了解在 HTML 中处理数据的最佳方式。我正在使用 Appengine (Python) 并设法将一堆数据加载到视图中。在最简单的形式中，它是一组电影名称，每个名称都有与之相关的详细信息（例如年份、评级等）。现在如何在电影链接和显示所有详细信息的 div 之间传递数据？我将在我的应用程序中对一些控件使用 jQuery，所以我想知道是否有办法将数据绑定到控件？

此外，谁能告诉我这方面的标准是什么，即如果我在一次调用中将所有这些数据加载到 UI 中（假设它不是很多电影标题），这不会让人们轻松地进行屏幕抓取吗？信息？还是这里通常使用一些混淆？

抱歉，如果我不是很清楚，但我真的是 Web 开发的绝对初学者！

Update1：​​我找到了 jQuery data() api。看来这会奏效。评论？

Update2：稍后进行一些测试，结果表明 data() 实际上将数据附加到元素而不是在 div 本身中显示它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T19:39:40.667

有几种方法可以做到这一点，但基本思想是以不可见的方式将数据放入 HTML 中，然后使用 Javascript 解析 HTML 并在需要时提取数据。

现代浏览器上最简单的方法是使用 data- 属性。这些是任何以 data- 开头的属性，您可以自己命名其余属性。例如：

```
<a href="/movie/1234" data-id="1234" data-title="Tsar Wars" data-actors="[Harryson Fjord, Carry Fischer]">Czar Wars</a> 
```

在这种情况下，用户只会看到一个名为“Tsar Wars”的链接，但您的 javascript 可以轻松访问 data- 属性以获取所需的数据。这种方法的另一个好处是 jQuery 将自动使 data- 属性可由 data() api 访问。

另一种方法是使用一个隐藏的 HTML 列表元素，其中包含列表中的所有数据元素，但您必须自己解析这一切。

没有标准的混淆。您需要在服务器端混淆自己，并在您的 JS 中取消混淆。在 js 中找出任何混淆算法并不难，所以这不值得你花时间。

如果数据确实是私有的，那么您将不得不对其进行架构以在服务器上进行所有处理。例如，仅显示令牌（如 1234），并使用 AJAX 调用将令牌传递给服务器，以便服务器可以进行数据处理并将公共安全结果返回给脚本。

# c# - 在 C# 中调用类的受保护构造函数

> ID：10820659
> 
> 赞同：2
> 
> 时间：2012-05-30T16:47:38.583
> 
> 标签：c#, class, constructor, protected

> **可能重复：**
> [如何在 C# 中调用受保护的构造函数？](https://stackoverflow.com/questions/4365745/how-to-call-protected-constructor-in-c)

我搜索了我的问题的解决方案。
其实我不知道有没有可能。请帮我。

```
namespace namespace1
{
    namespace namespace1a
    {
        public class classa
        {
            protected classa(string i) //protected constructor
            {
                //Do something
            }
            public classa() //public constructor
            {
                //Do something
            }

        }
    }

    namespace namespace1b
    {
        public class classb
        {
            classa i = new classa(); // calls public constructor of classa

            classa j = new classa("hi"); //Invalid. How to call the protected constructor of classa
        }
    }
} 
```

我想从“ **classb ”调用“** **classa** ”的受保护构造函数，怎么做？请帮我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T17:12:20.277

如果

*   `classa`并且`classb`在同一个程序集中
*   您正在创作这两个课程
*   您正在尝试保护`classa`的构造函数。

那么您可以将构造函数声明为`protected internal`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T17:05:24.463

您可以使用反射从类型的元数据中获取对要调用的构造函数的引用：

```
var ctor = typeof(classa).GetConstructor(BindingFlags.NonPublic | BindingFlags.Instance, null, new[] { typeof(string) }, null); 
```

一旦你有了对构造函数的引用，你就可以调用它，传入你想要给构造函数的参数作为对象数组：

```
var instance = (classa)ctor.Invoke(new object[] { "Chicken butt" }); 
```

话虽如此，构造函数可能受到保护是有原因的，并且使用反射来规避类型成员的封装通常不是一个好主意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T17:01:40.380

一种安全的方法是添加一个代理类，该类继承自`classb`一个带有字符串的公共构造函数。受保护的合同是明确定义的。

```
class bproxy : classb
{
     public bproxy(string x) : base(x) {...}
} 
```

* * *

另一种方法是使用反射。老实说**，我不建议这样做，**因为当作者将构造函数设置为受保护时，它只能由其自身和派生类使用。您还与未明确定义的“合同”紧密耦合。

话虽如此，这*应该*对您有用，尽管一旦作者更改合同的非保证部分（**使用风险自负**），它就会中断：

```
var constructor = typeof(classa).GetConstructors(BindingFlags.NonPublic | BindingFlags.Instance);
var b = constructor.First().Invoke(new object[] {"hi"}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-30T16:50:20.743

除非 classb 从 classa 派生，否则这是不可能的。Protected 使构造函数仅对类本身和从 classa 派生的每个类可见。

看看这里：[受保护的 C#](http://msdn.microsoft.com/en-us/library/bcd5672a%28v=vs.80%29.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-30T16:59:16.393

[您的问题与此](https://stackoverflow.com/questions/4365745/how-to-call-protected-constructor-in-c)问题重复。
除了从 classa 派生之外，反射是一个有用的选项（通过查询 tpye 的构造函数，然后运行合适的构造函数，如提供的链接中的答案之一所述）

# linq - LINQ 中的 Where 语句中的错误

> ID：10820663
> 
> 赞同：8
> 
> 时间：2012-05-30T16:47:50.267
> 
> 标签：linq, dynamics-crm, dynamics-crm-2011

出于某种原因，在我的地方它说机会实体中不存在“名字”。但它是为 SystemUser 实体设置的。知道为什么会感到困惑吗？谢谢！

```
 var linqQuery = (from r in gServiceContext.CreateQuery("opportunity")
                             join c in gServiceContext.CreateQuery("account") on ((EntityReference)r["accountid"]).Id equals c["accountid"]
                             join u in gServiceContext.CreateQuery("systemuser") on ((EntityReference)r["ownerid"]).Id equals u["systemuserid"]
                             where r["new_leadstatus"].Equals("100000004") && u["lastname"].Equals(rsmLastName) && u["firstname"].Equals(rsmFirstName)
                             select new
                             {
                                 AccountId = !r.Contains("accountid") ? string.Empty : r["accountid"],
                                 Account = !r.Contains("name") ? string.Empty : r["name"]
                             }); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-30T17:20:21.233

[确保根据 Microsoft 指南](http://msdn.microsoft.com/en-us/library/gg328328.aspx#bkmk_operators)将每个`where`子句放在单独的行中。

> **where**子句对结果应用过滤器，通常使用布尔表达式。过滤器指定要从源序列中排除的元素。每个**where**子句只能包含针对单个实体类型的条件。涉及多个实体的复合条件无效。相反，应该在单独的**where**子句中过滤每个实体。

```
var linqQuery = from r in gServiceContext.CreateQuery("opportunity")
                join c in gServiceContext.CreateQuery("account") on ((EntityReference)r["accountid"]).Id equals c["accountid"]
                join u in gServiceContext.CreateQuery("systemuser") on ((EntityReference)r["ownerid"]).Id equals u["systemuserid"]
                where r["new_leadstatus"].Equals("100000004")
                where u["lastname"].Equals(rsmLastName) && u["firstname"].Equals(rsmFirstName)
                select new
                {
                    AccountId = !r.Contains("accountid") ? string.Empty : r["accountid"],
                    Account = !r.Contains("name") ? string.Empty : r["name"]
                }; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T16:51:43.147

您将对机会实体的引用定义为“r”，但尝试从“u”中读取名字

```
from r in gServiceContext.CreateQuery("opportunity")

u["firstname"] 
```

改变你的终点在哪里

```
r["firstname"].Equals(rsmFirstName) 
```

# java - Java：使用 diagnostics.getDiagnostics() 查找错误

> ID：10820672
> 
> 赞同：2
> 
> 时间：2012-05-30T16:48:30.190
> 
> 标签：java, compiler-construction

我正在使用java创建一个编译器程序，我让它编译java文件，我让它找出发生了什么错误以及它发生在哪一行。我的问题是，当它打印出这些信息时`///////////`，我在输出中间得到了一个负载，我不明白为什么会这样！

我的输出是

```
Error on line 4 in ////////////////////////////////////////////////////////////////////////////////////////////.java:4: error: class ToCompileTwo is public, should be declared in a file named ToCompileTwo.java
public class ToCompileTwo { 
```

这是我用来获取此显示的代码

```
for (Diagnostic diagnostic : diagnostics.getDiagnostics()) {
            System.out.format("Error on line %d in %s", diagnostic.getLineNumber(), diagnostic);
        } 
```

**编辑**

我设法解决了这个问题，以下方法是创建`////////`

```
protected DynamicJavaSourceCodeObject(String name, String code) {
    super(URI.create("string:///" + name.replaceAll(".", "/") + Kind.SOURCE.extension), Kind.SOURCE);
    this.qualifiedName = name;
    this.sourceCode = code;
} 
```

我将第二行更改为

```
super(URI.create("string:///" + name.replaceAll("\\\\", "/") ), Kind.SOURCE); 
```

这解决了问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T08:35:16.683

当你这样做时，`name.replaceAll(".", "/")`你将全部替换为`/`. [ReplaceAll](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#replaceAll%28java.lang.String,%20java.lang.String%29)将正则表达式作为第一个参数，因此您可以匹配所有字符`.`并将其替换为`/`.

将您的声明替换为：

```
name.replaceAll("\\.", "/") 
```

`\\.`: 代表字符点。

# bash - 自动完成目录名称时，如何让 bash 忽略模式（例如 .svn）文件夹？

> ID：10820678
> 
> 赞同：2
> 
> 时间：2012-05-30T16:48:44.903
> 
> 标签：bash

在深入研究目录树（例如深度 java 包）时，我经常希望 bash 自动完成目录名称。大多数时候，.svn 文件夹会干扰。我可以将 .svn 排除在自动完成候选者之外吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-30T16:51:29.830

试试这个：

```
export FIGNORE=.svn 
```

[在这里](http://blog.pclewis.com/2010/03/tip-make-bash-tab-completion-ignore-svn-directories/)找到。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-30T16:54:48.907

如果您希望自动完成忽略所有隐藏目录（不仅仅是`.svn`），请将以下内容添加到您的`.bashrc`：

```
bind 'set match-hidden-files off' 
```

来自`man bash`：

> 此变量设置为 On 时，会导致 readline 匹配名称以“.”开头的文件。（隐藏文件）执行文件名完成时。如果设置为 Off，则前导 '.' 必须由用户在要完成的文件名中提供。

# c# - 在 C# 中为自定义图标制作一个 Windows 扩展处理程序

> ID：10820680
> 
> 赞同：1
> 
> 时间：2012-05-30T16:48:53.993
> 
> 标签：c#, windows

我想通过 dll 处理文件扩展名图标并根据 Windows 资源管理器中的文件内容提供图标（类似于 PSD 文件的缩略图图标。Photoshop 处理 .psd 扩展名并为每个文件生成缩略图）

`Load`我用 C# 制作了一个可以很好地处理和运行的 dll `GetIconLocation`。似乎 Windows 应该在之后调用该`Extract`函数，`GetIconLocation`但它不会！

界面：

```
 [ComVisible(true), ComImport, Guid("000214eb-0000-0000-c000-000000000046"),
    InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
   public interface IExtractIcon
   {
        [PreserveSig]
        uint GetIconLocation(int uFlags, IntPtr szIconFile, int cchMax, IntPtr piIndex, UIntPtr pwFlags);

        //[PreserveSig]
        //uint GetIconLocation(uint uFlags, IntPtr szIconFile, uint cchMax, IntPtr piIndex, UIntPtr pwFlags);
        [PreserveSig]
        uint Extract(string pszFile, uint nIconIndex, ref IntPtr phiconLarge,ref IntPtr phiconSmall, uint nIconSize);
    } 
```

和功能：

```
 public uint Load(string pszFileName, uint dwMode)//Using IPersistFile
    {
        icon_File = System.IO.Path.Combine(System.IO.Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location), "Icon.bmp");
        tip = "My tool-tip";
        Logger.WriteLog("Load :"+pszFileName+" , "+dwMode.ToString());

        return S_OK;

    }

    public uint GetIconLocation(int uFlags, IntPtr szIconFile, int cchMax, IntPtr piIndex, UIntPtr pwFlags)//Using IExtractIcon and IPersistFile.Load
    {
            try
            {
                IconHandlerReturnFlags Flags;

                Flags = IconHandlerReturnFlags.PerClass | IconHandlerReturnFlags.DontCache | IconHandlerReturnFlags.NotFilename;
                pwFlags = (UIntPtr)Flags;

                Logger.WriteLog("GetIconLocation...");
                return S_OK;
            }
            catch (Exception e)
            {
                Logger.WriteLog("GetIconLocation " + e.Message);
                return S_FALSE;
            }
        }

        public uint Extract(string pszFile, uint nIconIndex, ref IntPtr phiconLarge,ref IntPtr phiconSmall, uint nIconSize)//Using IExtractIcon 
        {

                Logger.WriteLog("Extract...");
    // other code...
} 
```

`Load`功能正常工作并提供正确的文件名。也`GetIconLocation`有效。但是在返回 S_OK 值后提取不会执行...:(

这是`.myf`在 Windows 资源管理器中查看两个文件图标后的日志

```
Load : C:\**********1.Myf , 0
GetIconLocation...
Load : C:\**********2.Myf , 0
GetIconLocation...
Load : C:\**********1.Myf , 0
GetIconLocation...
GetIconLocation...
Load : C:\**********1.Myf , 0
GetIconLocation.. 
```

（有时两个`GetIconLocation`电话没有`Load`）

请有人帮助我....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T05:27:13.357

它可以帮助你回答我的问题：（来自微软网站...）

实现 IExtractIcon 接口 接口初始化后，Shell 使用处理程序的 IExtractIcon 接口来请求适当的图标。该接口有两个方法： IExtractIcon::GetIconLocation 和 IExtractIcon::Extract 。图标由它们在文件系统中的位置来标识。调用 IExtractIcon::GetIconLocation 方法来请求此信息。将 szIconFile 参数设置为文件名。如果文件中有多个图标，请将 piIndex 设置为图标的索引。为两个标志变量分配适当的值。如果您不想指定文件名，或者不想让 Shell 提取图标，请在 pwFlags 参数中设置 GIL_NOTFILENAME 标志。您不需要为 szIconFile 分配值，但是当 Shell 调用 IExtractIcon::Extract 时，处理程序必须提供图标句柄。如果您返回文件名，Shell 通常会尝试从其缓存中加载图标。要防止加载缓存图标，请在 pwFlags 参数中设置 GIL_DONTCACHE 标志。如果未加载缓存的图标，Shell 然后调用 IExtractIcon::Extract 来请求图标句柄。如果文件和索引由 IExtractIcon::GetIconLocation 指定，它们将分别在 pszFile 和 nIconIndex 参数中传递给 IExtractIcon::Extract。如果提供了文件名，您的处理程序可以返回 S_FALSE 以让 Shell 提取图标。否则，您的处理程序必须提取或以其他方式生成大小图标，并将其 HICON 句柄分配给 phiconLarge 和 phiconSmall 参数。Shell 将图标添加到其缓存中以加快对处理程序的后续调用。Shell 通常会尝试从其缓存中加载图标。要防止加载缓存图标，请在 pwFlags 参数中设置 GIL_DONTCACHE 标志。如果未加载缓存的图标，Shell 然后调用 IExtractIcon::Extract 来请求图标句柄。如果文件和索引由 IExtractIcon::GetIconLocation 指定，它们将分别在 pszFile 和 nIconIndex 参数中传递给 IExtractIcon::Extract。如果提供了文件名，您的处理程序可以返回 S_FALSE 以让 Shell 提取图标。否则，您的处理程序必须提取或以其他方式生成大小图标，并将其 HICON 句柄分配给 phiconLarge 和 phiconSmall 参数。Shell 将图标添加到其缓存中以加快对处理程序的后续调用。Shell 通常会尝试从其缓存中加载图标。要防止加载缓存图标，请在 pwFlags 参数中设置 GIL_DONTCACHE 标志。如果未加载缓存的图标，Shell 然后调用 IExtractIcon::Extract 来请求图标句柄。如果文件和索引由 IExtractIcon::GetIconLocation 指定，它们将分别在 pszFile 和 nIconIndex 参数中传递给 IExtractIcon::Extract。如果提供了文件名，您的处理程序可以返回 S_FALSE 以让 Shell 提取图标。否则，您的处理程序必须提取或以其他方式生成大小图标，并将其 HICON 句柄分配给 phiconLarge 和 phiconSmall 参数。Shell 将图标添加到其缓存中以加快对处理程序的后续调用。在 pwFlags 参数中设置 GIL_DONTCACHE 标志。如果未加载缓存的图标，Shell 然后调用 IExtractIcon::Extract 来请求图标句柄。如果文件和索引由 IExtractIcon::GetIconLocation 指定，它们将分别在 pszFile 和 nIconIndex 参数中传递给 IExtractIcon::Extract。如果提供了文件名，您的处理程序可以返回 S_FALSE 以让 Shell 提取图标。否则，您的处理程序必须提取或以其他方式生成大小图标，并将其 HICON 句柄分配给 phiconLarge 和 phiconSmall 参数。Shell 将图标添加到其缓存中以加快对处理程序的后续调用。在 pwFlags 参数中设置 GIL_DONTCACHE 标志。如果未加载缓存的图标，Shell 然后调用 IExtractIcon::Extract 来请求图标句柄。如果文件和索引由 IExtractIcon::GetIconLocation 指定，它们将分别在 pszFile 和 nIconIndex 参数中传递给 IExtractIcon::Extract。如果提供了文件名，您的处理程序可以返回 S_FALSE 以让 Shell 提取图标。否则，您的处理程序必须提取或以其他方式生成大小图标，并将其 HICON 句柄分配给 phiconLarge 和 phiconSmall 参数。Shell 将图标添加到其缓存中以加快对处理程序的后续调用。它们分别在 pszFile 和 nIconIndex 参数中传递给 IExtractIcon::Extract。如果提供了文件名，您的处理程序可以返回 S_FALSE 以让 Shell 提取图标。否则，您的处理程序必须提取或以其他方式生成大小图标，并将其 HICON 句柄分配给 phiconLarge 和 phiconSmall 参数。Shell 将图标添加到其缓存中以加快对处理程序的后续调用。它们分别在 pszFile 和 nIconIndex 参数中传递给 IExtractIcon::Extract。如果提供了文件名，您的处理程序可以返回 S_FALSE 以让 Shell 提取图标。否则，您的处理程序必须提取或以其他方式生成大小图标，并将其 HICON 句柄分配给 phiconLarge 和 phiconSmall 参数。Shell 将图标添加到其缓存中以加快对处理程序的后续调用。

# asp.net-mvc - 将自定义列表/字典绑定到 MVC 视图中的下拉列表

> ID：10820681
> 
> 赞同：0
> 
> 时间：2012-05-30T16:48:53.983
> 
> 标签：asp.net-mvc

我有一堆桌子。每个表都有一个“状态”列。该列具有字符 A 或 I。A= 活动且 I= 非活动。

我有一个对应于每个表的创建视图。我想显示一个下拉框，其中显示两个值 - Active 和 Inactive，然后相应地映射它们。

我知道我可以在需要状态下拉列表的每个视图中执行以下操作

```
@Html.DropDownListFor(model => model.status, new SelectList(new[] { new { ID = "A", Desc = "Active" }, new { ID = "I", Desc = "Inactive" } }, "ID", "Desc")) 
```

但是，如果明天我决定再添加一个状态，我将不得不更改每个视图。

另一种选择是创建一个字典并将其传递给视图模型，如[本文所述](http://www.rachelappel.com/use-viewmodels-to-manage-data-amp-organize-code-in-asp.net-mvc-applications)

然而，这意味着我必须为我的每个模型创建一个视图模型来容纳状态列表。

还有其他方法可以实现吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T19:23:55.893

我建议为每个独特的视图使用视图模型。从长远来看，它使 UI 更易于使用和维护。

根据我的经验，视图模型方法可能会被极端化并适得其反。例如，在为客户实体创建 VM 时，我不会重新创建具有客户实体所有相同属性的 CustomerVM。相反，我只是在包含整个客户实体的 CustomerVM 上创建一个客户属性。有些人可能不同意这种方法，因为如果视图没有显示所有客户实体信息，我可能会向视图公开更多信息而不是它需要的信息。没错，但我喜欢快速且易于实施和维护的解决方案。

你永远不知道将来需要什么。随着时间的推移，我发现这种方法是最灵活的解决方案。

因此，您可以为所有具有公共查找列表的视图创建一个基本视图模型，并让您的新视图模型从这个基本 VM 继承。

这是一种方法。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-03T05:41:13.327

以下链接可能有助于绑定 mvc 中的下拉列表

[http://www.c-sharpcorner.com/UploadFile/deveshomar/ways-to-bind-dropdown-list-in-Asp-Net-mvc/](http://www.c-sharpcorner.com/UploadFile/deveshomar/ways-to-bind-dropdown-list-in-Asp-Net-mvc/)

# jsf-2 - 在 JBoss AS7 堆栈（JSF2、CDI、JPA2、Seam？）上拥有 ViewScope 和避免 LazyInitializationException 的最简单方法

> ID：10820683
> 
> 赞同：3
> 
> 时间：2012-05-30T16:49:01.817
> 
> 标签：jsf-2, jpa-2.0, cdi, jboss7.x, seam3

我正在尝试为满足以下要求的小型研究原型和学生项目建立基于 JBoss AS7 的 Web 应用程序堆栈：

1.  我想结合 PrimeFaces 组件为我的托管 bean 使用与 AJAX 相关的范围，例如**ViewScope** - 或者可能是 MyFaces Orchestra 中的 (View)AccessScope 。

2.  基于 JPA 的持久性应该相当简单，无需处理 OpenSessionInView 模式等。我在 JPA2 中遇到的主要问题是可怕的**LazyInitializationException**，尤其是在 AJAX 调用中。我*不需要*手动控制对话。

3.  我想使用**尽可能少的依赖**项，因此主要依赖于 JBoss AS7 附带的内容。

现在，我已经建立了一个项目，其中包含以下（主要是提供的）Maven 依赖项：

*   CDI
*   hibernate-2.0-api
*   jboss-ejb-api_3.1_spec
*   jboss-jsf-api_2.1_spec
*   jboss-annotations-api_1.1_spec
*   PrimeFaces 3

到目前为止，这看起来很苗条。缺少的是对更多特定于 JSF 的范围的支持，并且在 JSF 页面中迭代集合时，我总是得到一个 LazyInitializationException。现在，我的持久性服务类如下所示：

```
import javax.ejb.Stateful;
import javax.enterprise.context.RequestScoped;

@Stateful @RequestScoped
public class TestEntityService implements Serializable {
    @PersistenceContext(type=PersistenceContextType.EXTENDED)
    private EntityManager entityManager;

    // ... some methods working with the entityManager ...
} 
```

还有我的 ResourceFactory bean：

```
public class ResourceFactory {
    @Produces @PersistenceUnit
    private EntityManagerFactory entityManagerFactory;
} 
```

我尝试与`@Named`而不是`@Stateful`，或`@SessionScoped`代替的组合没有成功`@RequestScoped`。但是，我发现添加 Seam 3 Persistence、Solder 和 Faces 模块似乎可以解决我的大部分问题，但这会给我的项目添加大量新的依赖项（例如 seam-security、prettyfaces、drools、joda-time 和其他依赖项）。

我的问题是：

1.  **EJB**对 LazyInitializationException 有帮助吗？`@Stateful`还是由于注释，我实际上已经在这里使用了 EJB ？我从一个 jboss-as 示例应用程序中获取了这个，但我对所有这些`@ManagedBean`, `@Named`, `@Stateful`,`@LocalBean`注释之间的差异感到非常困惑......我所知道的是我需要以某种方式将我的实体管理器的生命周期绑定到服务豆。

2.  有人知道解决此问题的其他简单方法吗？使用 EAGER 获取不是一种选择，因为这似乎仅在每个实体不超过一个集合的情况下才有效......

3.  我刚刚阅读了有关**Apache CODI**的信息，它似乎是 MyFaces Orchestra 的 CDI 继任者。这是Seam Faces的更好替代品吗？据我所知，它提供了 ViewScope 和 ViewAccessScope，但没有涉及事务管理。

如果在该领域有更多经验的人可以对此有所了解，那就太好了——我目前有点困惑，因为有很多图书馆在处理类似的问题，尽管最明显的是彼此不兼容（参见例如[在这里](https://stackoverflow.com/a/7829052)）。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T04:56:22.637

你是对的。所有这些都非常令人困惑。这种混淆来自于提供相同特性的 JSF2 和 CDI。由于这两个规范需要在没有其他规范的情况下工作，因此它们对 Scope 和 EL 说明具有相似的注释。这篇[博](http://www.germanescobar.net/2010/04/4-areas-of-possible-confusion-in-jee6.html)文详细介绍了这些令人困惑的领域以及如何做出正确的选择。简而言之，当将 CDI 与 JSF 一起使用时，请始终使用 CDI 注释，或 CDI 将通过扩展控制的注释（就像`javax.faces.ViewScoped`您在项目中使用 Seam Faces 或 CODI 时一样）

回答您的问题

1.  您已经在使用带有`@Stateful`注释的 EJB。EJB 不会直接帮助您，`LazyInitializationException`但它们是处理事务和数据库的更自然的选择（您不能`@PersistenceContext`在 pojo CDI bean 中使用注释）。关于我已经回答的令人困惑的注释
2.  [我对Seam Persistence](http://seamframework.org/Seam3/PersistenceModule)有很好的经验。这个 CDI 扩展创建了一个托管实体管理器，它存在于对话中并允许在 EJB 之外使用事务（如果您没有 Java EE 容器）。使用此实体管理器可显着减少延迟加载问题。由于允许注入不同范围的 Bean 的 CDI 魔法，它可以注入到管理 DAO 的无状态 EJB 中。与 Seam Faces 结合使用，您将获得 JSF ViewScope for CDI 的支持以及与 JSF 生命周期相关的事务
3.  我没有任何使用 CODI 的经验，这似乎带来了嵌套对话等有用的功能。

总之，请注意 Seam 和 CODI 目前在[Apache Delta Spike](https://cwiki.apache.org/confluence/display/DeltaSpike/Community)中处于合并过程中，因此您将要构建的解决方案应在下个月重新评估，以将 Delta Spike 包含在等式中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T03:29:37.307

老实说，CDI 没有“万能”。Seam3 效果很好，MyFaces CODI 效果很好，这真的取决于你想要什么。老实说，对于您的情况，似乎最简单的做法是为您的项目创建自己的 ViewScoped 扩展，或者从 Seam 3 或 CODI 中提取必要的部分。

# sql - sqlplus 查询的类似“更少”的行为

> ID：10820684
> 
> 赞同：1
> 
> 时间：2012-05-30T16:49:04.930
> 
> 标签：sql, sqlplus

sqlplus 是否有任何技巧或命令允许遍历 SELECT 查询返回的数据库记录，就好像它们是通过 Linux 命令“less”发送的一样？

我想选择大量按日期排序的记录并轻松浏览它们。

具体来说，我正在考虑用数据库替换我的日志文件。这有一个很好的搜索属性日志，但我担心我会失去查看日志以查找任何看起来奇怪的内容的能力。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T17:34:08.557

*SQL中*“less”的等价物是 BOTTOM，如下所示：

```
select BOTTOM 100 *
from log 
```

但是，Oracle（和大多数其他数据库）不支持此功能。因此，您可以使用：

```
SELECT top 100 *
from log
order by 1 desc 
```

（我建议您将自动递增的 logid 作为第一列，因此上述查询始终有效。否则，您需要显式地按 logid desc 或其他字段（例如 logdatetime 字段）进行排序。）

根据您的系统，这将适用于多达数十万或数百万行。例如，我有一个去年 9 月一直在运行的处理日志，现在有大约 90,000 行，SQL Server 可以毫无问题地从中获取我需要的数据。

因此，如果您每天在日志中添加数十或数百行，那么您可以使用 SQL。如果您要添加数万行，那么您可能需要更复杂的方法。在这种情况下，我建议拥有一个日志历史表和一个当前日志表，并定期将当前表转储到历史记录中。

我忘了提。在 SQL 中记录日志有令人难以置信的好处。它为您提供了报告的灵活性、很容易看到“昨天发生的事情”的能力，以及一个很好的总结平台。

# javascript - 如何保持先前发送到 JSON 的值？

> ID：10820688
> 
> 赞同：0
> 
> 时间：2012-05-30T16:49:15.930
> 
> 标签：javascript, jquery, json, input

我想将输入的值存储到 JSON（提交时）。如果用户再次填写输入然后提交我想将新值添加到 JSON 保留前一个。

我使用以下内容将输入值添加到 JSON，但我不确定如何将先前的值发送到 JSON。

[http://jsfiddle.net/ABE4T/](http://jsfiddle.net/ABE4T/)

HTML：

```
<form method="post" name="myForm" id="myForm">
<input type="text" name="element" />
<input type="submit" value="Add" name="submit" />
</form>
    <div id="display"></div> 
```

Javascript：

```
$.fn.serializeObject = function()
{
    var arrayData = this.serializeArray();
    var objectData = {};

    $.each(arrayData, function(){
        if(objectData[this.name] != null){
            if(!objectData[this.name].push){
                objectData[this.name] = [objectData[this.name]];
            }

            objectData[this.name].push(this.value || '');
        }
        else{
            objectData[this.name] = this.value || '';
        }
    });
    return objectData;
};

$(document).ready(function(){
    $("#myForm").submit(function(){
        $('#display').text(JSON.stringify($("#myForm").serializeObject()));    
        return false;
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:54:36.540

使用 .append() 函数而不是 .text() 函数。

[演示小提琴](http://jsfiddle.net/ABE4T/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T16:54:44.123

您可以维护一个数组来保存所有这样的值

```
$(document).ready(function(){
    var values = [];

    $("#myForm").submit(function(){
        values.push($("#myForm").serializeObject());
        $('#display').text(JSON.stringify(values));    
        return false;
    });
}); 
```

[工作小提琴](http://jsfiddle.net/joycse06/ABE4T/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T17:59:55.803

您正在覆盖 中的值`#display`。

更改此行

```
 $('#display').text(JSON.stringify($("#myForm").serializeObject())); 
```

至

```
$('#display').text($('#display').text() + JSON.stringify($("#myForm").serializeObject())); 
```

[小提琴](http://jsfiddle.net/GNQWb/)

# paypal - Paypal Express Checkout API：DoExpressCheckoutPayment 会失败吗？

> ID：10820701
> 
> 赞同：1
> 
> 时间：2012-05-30T16:50:07.787
> 
> 标签：paypal, express-checkout

我即将将[Paypal Express Checkout](https://cms.paypal.com/au/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_ECGettingStarted)集成到在线食品订购系统中。我目前对流程的看法如下：

*   `SetExpressCheckout`被调用，并且客户被重定向到带有令牌的 Paypal。
*   客户批准付款后，他将被重定向到等待页面，同时将订单发送到餐厅。
*   收到餐厅回复后，会发生以下情况：
    *   如果订单被批准，`DoExpressCheckoutPayment`则调用并完成付款；
    *   如果订单被拒绝，则付款永远不会完成。

这让我想知道，是否有可能`DoExpressCheckoutPayment`失败，并且无法以任何理由提取资金？因为在我的情况下，取消已经发送到餐厅的订单为时已晚。

我应该`PAYMENTACTION=Authorization`改用，然后获取/取消授权吗？由于资金可以保留3天，而我只需要几分钟的时间来决定，这看起来有点矫枉过正。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T17:49:07.250

是的，DoExpressCheckoutPayment API 调用肯定会失败。
您应该做的是在您的 SetExpressCheckout 和 DoExpressCheckoutPayment API 调用中设置 PAYMENTACTION=Authorization，并且 - 一旦餐厅确认订单 - 调用 DoCapture API 以从授权中获取资金。
资金兑付期限为 3 天，授权期限最长为 29 天。

还; 设计失败。保持一个后备。以防 DoCapture*失败*。它不应该，但你永远不知道。因此，请仔细检查 DoCapture API 响应中的“PAYMENTSTATUS”是否为“已完成”且“TRANSACTIONID”是否为空。

# xpages - 如何从 URL 在 Xpages 移动控件中打开文档

> ID：10820704
> 
> 赞同：1
> 
> 时间：2012-05-30T16:50:16.777
> 
> 标签：xpages, xpages-extlib

如何从 URL 打开 XPages 移动控件中的文档？

我的应用程序使用电子邮件中的嵌入式 URL 链接通知用户待审核。要求是在移动控件（SinglePage/App Page）中打开文档。到目前为止，当从电子邮件中单击链接时，我会在 ipad 上看到一个灰色页面。

但是，我可以使用按钮和`<moveTo>`标签来编辑同一个文档。以下是加载到浏览器时呈现灰色页面的示例 URL。

```
http://175.x.y.z/db.nsf/MN.xsp#newRequest&docId=123761231653&action=openDocument 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T18:04:41.180

URL 的#newRequest 部分需要移动到 url 字符串的 END。URL 中 # 符号之后的任何内容都不会传输到服务器，因此服务器永远不会获取 docId 或操作参数。

# javascript - 如何访问类属性？

> ID：10820709
> 
> 赞同：0
> 
> 时间：2012-05-30T16:50:35.897
> 
> 标签：javascript, jquery

我有这个代码：

```
function myClass() {

    this.tabs = new Array();

    myClass.prototype.focus_tab = function animateTab(nr){
        for(i=0;i<this.tabs.length;i++){
            $('#' + i + '-image').stop().animate(
                { left: '100px' },
                100 , function(){
                    this.tabs[i].step = 1;
                }
            );
        }
} 
```

但动画结束时的功能无法识别“this.tabs”。如何做好？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T16:54:06.603

它在不同的范围内，请尝试：

```
function myClass() {
  this.tabs = new Array();

  myClass.prototype.focus_tab = function animateTab(nr){
     for(i=0;i<this.tabs.length;i++){
         var mytab = this.tabs[i];
         $('#' + i + '-image').stop().animate({ left: '100px' }, 100 , function(){
             mytab.step = 1;
         }
      );
  }
} 
```

还有一些其他问题，但对问题的评论已经解决了其中一些问题！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T16:53:59.357

这是[经典范围界定问题](https://stackoverflow.com/questions/1451009/javascript-infamous-loop-problem)的另一个例子。您只有一个`i`变量，为所有回调共享。您需要`i`为每个回调创建一个本地。改变你的回调：

```
function(){
    this.tabs[i].step = 1;
} 
```

到：

```
(function(i){
    return function(){
        this.tabs[i].step = 1;
    }
})(i) 
```

# c# - 如何提供在 Windows Phone 应用程序中添加图像的选项

> ID：10820713
> 
> 赞同：0
> 
> 时间：2012-05-30T16:50:44.727
> 
> 标签：c#, .net, windows-phone-7

我正在 Windows Phone 中创建一个应用程序，它基本上是电费的组织者。我想允许用户将图像连同他们的每月消费一起添加到应用程序中，并且在添加图像之前，显示图像的预览。我该怎么做呢？我已经了解如何添加文本部分。我还想将图像保存到手机的硬盘驱动器。我听说我可以使用称为 IsolatedStorage 的东西来做到这一点。有人可以告诉我怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T17:01:43.557

无论是从网络还是本地内容，您都没有告诉您从哪里获得图像。在 URL 中尝试这样

[http://www.windowsphonegeek.com/tips/All-about-WP7-Isolated-Storage---Read-and-Save-Images](http://www.windowsphonegeek.com/tips/All-about-WP7-Isolated-Storage---Read-and-Save-Images)

如果要从网络保存图像，则必须将图像保存为内存流。如果您还有任何疑问，请告诉我

# python - 使用python获取子目录和文件

> ID：10820715
> 
> 赞同：1
> 
> 时间：2012-05-30T16:51:09.297
> 
> 标签：python, directory, python-2.7, directory-structure

获取驱动器的子目录（包括其中的文件）的最佳方法是什么？最好`os.listdir()`通过检查文件中是否有目录来使用和过滤目录`'.'`？

任何想法都会有所帮助，我更希望我只使用标准库来完成这项任务。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T16:54:58.190

看一下[`os.walk()`](http://docs.python.org/library/os.html#os.walk)，它允许您访问每个目录并获取您访问的每个目录的文件列表和子目录列表。

以下是您只能下降一个级别的方法：

```
for root, dirs, files in os.walk(path):
    # do whatever you want to with dirs and files
    if root != path:
        # one level down, modify dirs in place so we don't go any deeper
        del dirs[:] 
```

# eclipse - 如何让 FDT 和 Ant 循环构建？

> ID：10820719
> 
> 赞同：0
> 
> 时间：2012-05-30T16:51:22.043
> 
> 标签：eclipse, ant, fdt

我想让 FDT 循环遍历 .AS 文件的列表（或目录）并输出相应的 .SWF。

我想通过 Ant 执行此操作，而不是使用 FDT 的启动器链，并[在此处的文档中](http://fdt.powerflasher.com/docs/FDT_Ant_Tasks#fdt.launch.application)找到了“fdt.launch.application”Ant 任务。我可以用它来帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T16:51:22.467

不是直接的，您可以通过使用[“for”或“foreach”](https://stackoverflow.com/questions/3056395/how-can-i-iterate-over-properties-from-a-file) Ant 任务来模拟 Ant 循环。但是您需要先安装默认情况下不随 Ant 提供的任务。[有关获取这些任务的更多信息，请参见此处。](https://stackoverflow.com/questions/2608935/troubleshooting-failed-to-create-task-or-type-foreach-when-using-foreach)

然后，您可以定义文件和输出以在单独的属性文件中编译 - 也许您也可以通过 Ant 生成或手动编辑。在上面的链接中，答案显示了如何使用外部属性文件。

当您这样做时，您需要`<fdt.launch.application>`在循环中包含 fdt 编译任务并使用从属性文件中提取的变量。

# jquery - 如何隐藏除使用jquery 与onmouseover 元素关联的所有div 之外的所有div？

> ID：10820721
> 
> 赞同：0
> 
> 时间：2012-05-30T16:51:24.103
> 
> 标签：jquery, hover

我有一个物品清单。根据我悬停的项目，我只想显示一个具有相关内容的 div 并隐藏所有其余部分。
该列表大约有 22 个项目，因此我需要在 22 个不同的 div 之间切换（显示/隐藏）。

有没有一些快速的解决方案可以用 jQuery 完成这个？

这就是我目前将其设置为起点的方式：

```
<div id="list-of-items">
    <ul>
        <li id="item1">item1</li>
        <li id="item2">item2</li>
        <li id="item3">item3</li>
        <li id="item...">19-more-items</li>
    </ul>
</div>

<div id="content1">content1</div>
<div id="content2">content2</div>
<div id="content3">content3</div>
<div id="content...">...</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T16:56:05.020

我会用 .content-block 之类的东西对你所有的内容 div 进行分类

```
<div id="list-of-items">
<ul>
    <li id="item1">item1</li>
    <li id="item2">item2</li>
    <li id="item3">item3</li>
    <li id="item...">19-more-items</li>
</ul>
</div>

<div class="content-block" id="content1">content1</div>
<div class="content-block" id="content2">content2</div>
<div class="content-block" id="content3">content3</div>
<div class="content-block" id="content...">...</div> 
```

并在你的 CSS 中全部设置为 display:hide;

然后，只需使用以下内容：

```
$(function(){

    $('#list-of-items').each(function(){

       $(this).on('mouseover',function(){
           var cur-id = $(this).attr('id');
           var content-id = cur-id.replace('item','content');
           $('.content-block').hide();
           $('#'+content-id).show();
       });

    });

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T16:58:55.477

试试这个 ：

```
$('#list-of-items li').mouseover(function() {
    // hide all content divs except `list-of-items`
    $('div').not('#list-of-items').hide();
    // show content div based on current li id
    $('#' + $(this).prop('id').replace('item','content')).show();
}); 
```

这里使用[.mouseover()](http://api.jquery.com/mouseover/)绑定 mouseover 事件.not( [)](http://api.jquery.com/not/)排除`div`包含`li`s 和[.prop()](http://api.jquery.com/prop/)来获取`id`当前元素的属性。

如果您将 a 添加`class`到 content `div`s 中，则可以替换`('div').not('#list-of-items').hide();`为`$('.classofdivs').hide();`

**[这里的工作示例](http://jsfiddle.net/manseuk/qTtKe/)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T16:59:00.387

如果你包装你的底部 div，这可能会更容易一些：http: [//jsfiddle.net/lucuma/Jfw5B/](http://jsfiddle.net/lucuma/Jfw5B/)

```
<div id="list-of-items">
    <ul>
        <li id="item1">item1</li>
        <li id="item2">item2</li>
        <li id="item3">item3</li>
        <li id="item...">19-more-items</li>
    </ul>
</div>

<div id="contents">
<div id="content1">content1</div>
<div id="content2">content2</div>
<div id="content3">content3</div>
<div id="content...">...</div>
</div>​

$('#list-of-items li').on('mouseover', function() {

   $('#contents div').hide().eq($(this).index()).show();

});​ 
```

如果您不想将它们包裹在某些东西中，您可以很容易地做到这一点：

```
$('#list-of-items li').on('mouseover', function() {      
   $('div:gt(0)').hide().eq($(this).index()).show();
});​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-30T17:01:05.283

JQuery`hover`方法都将显示和隐藏相应的`div`块。

```
$("#list-of-items ul > li").hover(function() {
    $("#" + this.id.replace("item", "content")).toggle();
}); 
```

​演示 **：http:** [//jsfiddle.net/LzkKM/](http://jsfiddle.net/LzkKM/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-30T17:08:53.850

```
$('#list-of-items li').on('mouseenter mouseleave', function(e) {
    $('#content'+this.id.replace('item', ''))[e.type==='mouseenter'?'show':'hide']();
})​;​ 
```

[小提琴](http://jsfiddle.net/adeneo/VCGbF/)

**编辑**

我认为这就是你要找的：

```
$(function(){
    $('#list-items li').on('mouseenter', function() {
        $('#content'+this.id.replace('item', '')).show().siblings().hide();
    });
}); 
```

[小提琴](http://jsfiddle.net/adeneo/VCGbF/4/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-30T21:58:31.237

```
<head>
<script type="text/javascript">
$("#list-of-items ul > li").hover(function() {
  $("#" + this.id.replace("item", "content")).toggle();
});
</script>
</head>

<div id="list-of-items">
<ul>
    <li id="item1">item1</li>
    <li id="item2">item2</li>
    <li id="item3">item3</li>
    <li id="item...">19-more-items</li>
</ul>
</div>

<div id="content1">content1</div>
<div id="content2">content2</div>
<div id="content3">content3</div>
<div id="content...">...</div> 
```

# java - Java 中是否有对应的字段集（HTML）？

> ID：10820724
> 
> 赞同：16
> 
> 时间：2012-05-30T16:51:33.477
> 
> 标签：java, swing, swt, awt

Java 中是否存在与 HTML 元素等效的元素（即 Swing/AWT 或 SWT）`fieldset`？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-05-30T16:57:10.050

创建一个面板，创建一个带标题的边框，您就可以将所有字段组件放入其中。

```
JPanel panel = new JPanel();
panel.add(new JLabel("foo"));
panel.setBorder(BorderFactory.createTitledBorder("bar")); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-30T16:54:27.680

看看`javax.swing.border.TitledBorder`。您可以将它们设置在面板上，并且在外观上类似于 HTML 字段集。

```
Border titleBorder = new TitledBorder(new LineBorder(Color.RED), "Fieldset"); 
```

`setBorder()`然后，您可以使用该方法将边框添加到面板。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-04T16:38:08.353

如果您使用的是 SWT，那么我认为这`org.eclipse.swt.widgets.Group`就是您要寻找的。它是一个`Composite`（HTML 类比中的块），它看起来像 HTML 中的字段集。

但是，我不能代表 AWT 和 SWING。

# qt - 无法让滚动/布局工作

> ID：10820725
> 
> 赞同：0
> 
> 时间：2012-05-30T16:51:39.070
> 
> 标签：qt

我试图强制容器大小为 200x100，同时添加分布在大于 200x100 区域的子控件。当我超过视口的大小时，我希望有一个滚动条，但整个容器窗口会被调整大小。

如何强制容器大小为 200x100 并且仍然获得允许我向下滚动并查看其余内容的滚动条？

```
#include <QApplication>
#include <QPushButton>
#include <QScrollArea>
#include <QGridLayout>

int main(int argc, char *argv[])
{
    QApplication a(argc, argv);

    QWidget container;
    container.setGeometry(QRect(600,300,200,100));

    QGridLayout layout(&container);

    QPushButton *aa = new QPushButton(QString("a"));
    aa->setGeometry(QRect(10,10,100,30));
    layout.addWidget(aa, 0, 0);

    QPushButton *b = new QPushButton(QString("b"));
    b->setGeometry(QRect(10,40,100,30));
    layout.addWidget(b, 1, 0);

    QPushButton *c = new QPushButton(QString("c"));
    c->setGeometry(QRect(10,70,100,30));
    layout.addWidget(c, 2, 0);

    QPushButton *d = new QPushButton(QString("d"));
    d->setGeometry(QRect(10,100,100,30));
    layout.addWidget(d, 3, 0);

    QPushButton *e = new QPushButton(QString("e"));
    e->setGeometry(QRect(10,130,100,30));
    layout.addWidget(e, 4, 0);

    QPushButton *f = new QPushButton(QString("f"));
    f->setGeometry(QRect(10,160,100,30));
    layout.addWidget(f, 5, 0);

    QPushButton *g = new QPushButton(QString("g"));
    g->setGeometry(QRect(10,190,100,30));
    layout.addWidget(g, 6, 0);

    QPushButton *h = new QPushButton(QString("h"));
    h->setGeometry(QRect(10,220,100,30));
    layout.addWidget(h, 7, 0);

    QScrollArea area;

    area.setLayout(&layout);
    area.setWidget(&container);
    area.show();

    return a.exec();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T17:26:46.490

设置`QScrollArea`using的大小`setGeometry()`，然后使用`area.setSizePolicy(QSizePolicy::Fixed)`。

# r - 使用已经汇总的数据在 ggplot2 上生成条形图

> ID：10820728
> 
> 赞同：2
> 
> 时间：2012-05-30T16:51:48.430
> 
> 标签：r, ggplot2

> **可能重复：**
> [使用 ggplot2 使用预先汇总的数据创建条形图](https://stackoverflow.com/questions/10067452/create-a-bar-graph-with-pre-summarized-data-using-ggplot2)

在 ggplot2 参考手册 [http://had.co.nz/ggplot2/geom_bar.html](http://had.co.nz/ggplot2/geom_bar.html)

我们可以看到，使用提供的菱形数据，堆叠条形图非常容易。

但是，我尝试使用的数据集与钻石数据不同，因为我的数据已经汇总。

附件是我的意思的一个最小示例

```
 AgeGroup gender Level.of.Education  status count
1     18-25   male        High School married    10
2     18-25   male        High School  single    20
3     18-25   male            College married    25
4     18-25   male            College  single    10
5     18-25   male                PhD married    50
6     18-25   male                PhD  single     4
7     18-25   male                GED married    20
8     18-25   male                GED  single   100
9     18-25 female        High School married    20
10    18-25 female        High School  single    10
11    18-25 female            College married    30
12    18-25 female            College  single    60
13    18-25 female                PhD married    80
14    18-25 female                PhD  single    10
15    18-25 female                GED married     5
16    18-25 female                GED  single     2 
```

完整的数据集也有时间框架，所以我想要生成的是一个堆积条形图，显示已婚人数和未婚人数加班，使用“教育水平”作为填充栏。

完整的数据集是如此之大，以至于非常需要像这样的聚合数据。

您的意见将对我有很大帮助。谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-30T16:59:14.120

你需要`stat='identity'`。

```
ggplot(dat, aes(x=status, y=count, fill=Level.of.Education)) +
    geom_bar(stat='identity') 
```

我还建议按性别分面：

```
ggplot(dat, aes(x=status, y=count, fill=Level.of.Education)) +
    geom_bar(stat='identity') +
    facet_wrap(~gender) 
```

# vb.net - LINQ to SQL - 我什么时候需要选择，什么时候可以省略选择？

> ID：10820731
> 
> 赞同：-1
> 
> 时间：2012-05-30T16:51:58.293
> 
> 标签：vb.net, linq, linq-to-sql

我一直在玩 LINQ to SQL，我只有几个简单的问题：

*   我什么时候需要在查询结束时选择 Select？
*   什么时候可以省略 Select？

这是我的示例查询：

```
Dim pageRoute = From r In db.PageRoutes Where r.PageId = pageId Order By r.Id Descending

Dim pageRoute = From r In db.PageRoutes Where r.PageId = pageId Order By r.Id Descending

Dim dp = From r In db.DownloadPageOnlineOnlies Where r.PageId = pageId Order By r.Weight Descending, r.Id Ascending

Dim download = (From r In db.Downloads Where r.Id = id).First 
```

*   他们中的任何一个在技术上是错误的吗？
*   可以用 Select 或其他东西改进它们吗？

简而言之，我不明白什么时候需要：

```
Select r
Select r.AColumnINeed, r.BColumnINeed (does this improve performance?) 
```

谢谢。

PS 我喜欢在一行上写我的 LINQ 查询，除非它们真的很大。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T18:29:57.683

`where`当且仅当您想从与您的子句匹配的集合中获取完整对象时，linq 语句的 select 部分是完全可选的。如果您想要来自正在 LINQ 的集合中的对象的单个值，那么您需要使用 select 子句。

我个人总是`select r`出于纯粹的习惯将子句放在末尾，但是当我有严格的选项时，我遇到了其他人的代码的一些问题，而他们在编写 LINQ 时却没有。`select`如果您出于任何原因决定`option strict on`在未来转入，那么关闭该子句会产生多个后期绑定错误。

所以简而言之，您不需要该`select`子句，但如果您决定转身，您只会在以后帮助自己`option strict on`。在我看来，它确实使您的代码更具可读性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T16:57:41.047

让我们有一个有 20 列的表。查询 WITH select（2 列）和一个 WITHOUT。两者的执行计划可能不同，在前一种情况下从数据库服务器传输的数据要少得多。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-30T16:56:01.593

如果您有一个请求更精确结果的查询，并且像您只需要查询中的 a 或 a 和 b 一样，使用 select plus 是一个好习惯，您可以使用 select 并为您的查询节省内存分配，因为它知道确切的数字您将要返回的变量。

# java - 致命异常：Timer-0 java.lang.NullPointerException

> ID：10820734
> 
> 赞同：1
> 
> 时间：2012-05-30T16:52:06.480
> 
> 标签：java, android, handler, fatal-error

我在 oncreate() 中有一个计时器，例如：

```
final Timer timer1 = new Timer();
timer1.schedule(new TimerTask() {
    public void run() {
        sendSMS();
    }
}, 20000); 
```

sendSMS() 方法如下：

```
private void sendSMS(){
    float test2;
    test2 = reallocation.getAccuracy(); //-> This is the line where logcat says.... NullPointerException
    ....
} 
```

日志猫说：

```
05-30 18:32:26.962: W/dalvikvm(741): threadid=9: thread exiting with uncaught exception (group=0x4001d5a0)
05-30 18:32:26.972: E/AndroidRuntime(741): FATAL EXCEPTION: Timer-0
05-30 18:32:26.972: E/AndroidRuntime(741): java.lang.NullPointerException
05-30 18:32:26.972: E/AndroidRuntime(741):  at com.eljoom.df.ActionGPS.sendSMS(ActionGPS.java:280) 
```

好吧，在网上搜索后，我相信我需要一个计时器处理程序......但我不知道如何实现它。

有人可以让我走上正轨吗？！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T17:13:33.333

> 我将重新分配设置为 Location: Location reallocation=null; – user1404924 3 分钟前

你设置重新分配=null。你不能调用重新分配的方法 reallocation.getAccuracy(); 因为您还没有 obj 的实例。

我建议你看看 LocationManager 类。您可以使用特定的位置源 [http://developer.android.com/reference/android/location/LocationManager.html从那里请求位置](http://developer.android.com/reference/android/location/LocationManager.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T18:44:35.193

重新分配未初始化，因此它采用空值，对象的默认值。

# c++ - 在线运行 C++ 代码？

> ID：10820737
> 
> 赞同：8
> 
> 时间：2012-05-30T16:52:17.793
> 
> 标签：c++, visual-c++, compiler-construction

有没有可以在线运行 C++ 代码的网站？我见过一些编译器，但是有没有一个也可以接收来自的输入`cin`？我想要一个基本上可以在线托管 C++ .exe 的软件，如果它像 VC++ 平台，那就更可取了。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-01T13:14:32.550

您可能想尝试一下[rextester](http://rextester.com/XYSX22503)。目前 g++ 4.7.2 带有 boost 库和提供编译器参数的能力。

**现在也支持**编辑Visual C++。****

 *** * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-30T16:54:21.767

[http://ideone.com/](http://ideone.com/) 可以编译多种语言，并且支持标准输入

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-30T16:55:09.857

是的，[Ideone](http://ideone.com/)可以做到这一点。可以在那里指定*标准输入*。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-11-26T12:52:12.777

**编辑：**微软的在线编译器似乎不再活跃:(

* * *

Microsoft Research 已在此处制作了 Visual C++ 的在线版本：[http](http://webcompiler.cloudapp.net/) ://webcompiler.cloudapp.net/ 。

~~它（目前？）只编译代码而不运行它，所以你将无法检查`cin`:(~~

现在支持运行代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-30T16:54:51.887

也许以下站点是您的目标：[http ://codepad.org/](http://codepad.org/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-11-30T13:22:56.090

有[Wandbox.org](https://wandbox.org/)，它提供 GCC 和 Clang 到其最新版本（截至 2018 年 11 月）。它有`stdin`.

我不会说它是一个 VC++ 平台。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-04-14T18:23:21.443

TutorialsPoint 的[C++ Coding Ground](http://www.tutorialspoint.com/compile_cpp11_online.php)允许您一次保存和编译多个源文件，这有时很有用，并为您提供了一个 GNU bash 控制台供您使用。但是，共享代码不如 Ideone 之类的网站方便。

[注意：虽然它只链接到 C++、C++0x 和 C++11 环境，但您可以通过指定编译器选项为 C++14 编译代码`-std=c++1y`。但是，我不确定它是否有任何实验性 C++17 支持。]

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-06-20T09:19:42.737

[repl.it](https://repl.it)可以编译、运行和执行[C++](https://repl.it/site/languages/cpp)和[C++11](https://repl.it/site/languages/cpp11)。它也是交互式的，您可以实时要求用户输入。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-06-06T07:39:36.530

目前最好的在线工具似乎是

**特殊在线编译器**

[https://cppinsights.io](https://cppinsights.io)展示，C++ 如何引入转换等并解释源代码（当前基于 clang）

[https://godbolt.org](https://godbolt.org)比较 C++ 编译器、显示反汇编、运行（许多当前编译器包括 Microsoft VCC 和嵌入式编译器）

[http://quick-bench.com](http://quick-bench.com)创建和比较基准（当前 g++ 和 clang）

[https://www.onlinegdb.com](https://www.onlinegdb.com)，包括 gdb 调试器 (g++ 7.4.0)

**可让您设置编译标志的在线编译器**

[https://wandbox.org](https://wandbox.org)（当前的 g++ 和 clang）

[http://coliru.stacked-crooked.com](http://coliru.stacked-crooked.com) (g++ 9.2.0)

[https://repl.it/languages/cpp11](https://repl.it/languages/cpp11) (clang 7.0.0)

[https://www.tutorialspoint.com/compile_cpp11_online.php](https://www.tutorialspoint.com/compile_cpp11_online.php) = codingground (g++ 7.1.1)

[https://tio.run/#cpp-clang（g++](https://tio.run/#cpp-clang) 8.3.1 和 clang 7.0.1）

[https://rextester.com/l/cpp_online_compiler_gcc](https://rextester.com/l/cpp_online_compiler_gcc) (g++ 7.4.0, clang 6.0.0, VS C++ 2015 Update 1)

**不允许您设置编译标志的在线编译器**

[https://www.jdoodle.com](https://www.jdoodle.com) (g++ 9.2.0)

[https://www.codechef.com/ide](https://www.codechef.com/ide) (g++ 9.1.0)

[https://ideone.com](https://ideone.com)（g++ 8.3.0 和 clang 8.0.0）

[https://paiza.io](https://paiza.io) (clang 8.0.0)

[https://www.codiva.io/c](https://www.codiva.io/c) (clang 7.1.0)

[https://code.labstack.com/cpp](https://code.labstack.com/cpp) (g++ 8.3.0)

所有列出的编译器都支持 C++17 代码**

# solr - 将 Nutch 配置为仅索引 Solr 中的特定文件类型

> ID：10820740
> 
> 赞同：2
> 
> 时间：2012-05-30T16:52:27.633
> 
> 标签：solr, nutch

我正在寻找一种配置 Nutch 以抓取网络的方法，但仅将某些类型的文件（具体为 XML）索引到 Solr 中。我很确定自定义插件可以完成这项工作，可能基于 index-more 代码，但我宁愿不这样做，除非我必须这样做。我也确信我可以将所有内容都吸入 Solr，然后使用 Solr 的 API 删除不需要的内容，但这有点 hacky。有没有办法将 Nutch 配置为仅索引 Solr 中的某些文件类型？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T17:32:56.987

您可以根据扩展名过滤文件类型。[您可以在regex-urlfilter.txt](http://svn.apache.org/viewvc/nutch/trunk/conf/regex-urlfilter.txt.template?view=markup)
中指定要包含或排除的扩展名

例如排除（-）：-

> #skip image 和其他我们无法解析的后缀 29 # 使用 urlfilter-suffix 插件进行更广泛的覆盖 -.(gif|GIF|jpg|JPG|png|PNG|ico|ICO|css|CSS|sit| SIT|eps|EPS|wmf|WMF|zip|ZIP|ppt|PPT|mpg|MPG|xls|XLS|gz|GZ|rpm|RPM|tgz|TGZ|mov|MOV|exe|EXE|jpeg|JPEG| bmp|BMP|js|JS)$

使用 + 您可以指定包含列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T15:02:18.693

在 nutch 中，您可以为 url 定义过滤器。按文件扩展名过滤呢？

# scala - (Lift) dflt 的目的是什么：JsCmds.ReplaceOptions 案例类中的 Box[String] 参数

> ID：10820741
> 
> 赞同：1
> 
> 时间：2012-05-30T16:52:33.767
> 
> 标签：scala, lift

JsCmds 中有一个名为 ReplaceOptions 的案例类。它的构造函数的签名是：

```
ReplaceOptions (select: String, opts: List[(String, String)], dflt: Box[String]) extends JsCmd with Product 
```

提供的 scaladoc 描述是：

> 使用新选项更新 Select
> 
> select：是将要更新的select html组件的id
> 
> opts: 是一个包含元组的列表，表示将在选择组件中设置的选项的值：文本。

dflt 的用途是什么？如果我只是简单地使用`Box[String]("Test")`它，但我就是不明白为什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T19:11:17.707

我认为这是为了选择select的默认值。例如，如果您将选项更新为`List(("choice1", "Apple"), ("choice2", "Orange"), ("choice3", "Banana"))`.

`Full("choice1")`然后您可以通过分别将 dflt 设置为,`Full("choice2")`或来选择“Apple”、“Orange”或“Banana”作为默认值`Full("choice3")`。

这样，当用户加载页面时（或在`ReplaceOptions`替换选项时）时，选择了适应的默认值。

# windows - 使用 Sinatra::Reloader 重新加载模型和助手

> ID：10820749
> 
> 赞同：0
> 
> 时间：2012-05-30T16:53:15.347
> 
> 标签：windows, sinatra, jruby, reload

我正在尝试在 Windows Vista/7 上的 JRuby 中自动重新加载 Sinatra 项目。我正在使用来自 Sinatra-contrib 的 Sinatra::Reloader。不幸的是，它似乎只适用于控制器。对模型和助手的任何更改都不会重新加载。

我是在错误地使用also_reload 还是什么？

这是我的项目的样子：/app.rb

```
require 'sinatra'
require 'sinatra/reloader'
require 'json'

class App < Sinatra::Application
  enable :sessions
  enable :logging
  register Sinatra::Reloader
  also_reload "models/*.rb"
  also_reload "helpers/*.rb"

  helpers do
    include Rack::Utils
    alias_method :h, :escape_html
  end
end

require_relative 'helpers/init'
require_relative 'models/init'
require_relative 'controllers/init' 
```

/控制器/init.rb

```
enable :sessions

require_relative 'auth'
require_relative 'customer'
require_relative 'policy'
require_relative 'forms' 
```

/helpers/init.rb

```
require_relative 'auth_helper'
require_relative 'customer_helper'
require_relative 'flash_helper'
require_relative 'form_helper'
require_relative 'policy_helper' 
```

/models/init.rb

```
require 'lib/sqljdbc4.jar'
require 'sequel'
require 'logger'

Java::com.microsoft.sqlserver.jdbc.SQLServerDriver
url = 'foo'

DB = Sequel.connect(url)
DB.loggers << Logger.new($stdout)

Sequel.inflections do |inflect|
  inflect.clear :all
end

files = [
:customer,
:customer_email,
:phone_number ]

files.each do |f|
  require_relative f.to_s
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T07:54:14.310

在您当前的实现下，假设您在`helpers/auth_helper.rb`. 该文件被重新加载，但由于`helpers/init.rb`sinatra-reloader 不会重新加载，因此您不会看到更改。你试过`shotgun`宝石吗？

# iphone - 如何在动态 UITableView (iPhone) 中处理对 UITextFields 的引用

> ID：10820750
> 
> 赞同：3
> 
> 时间：2012-05-30T16:53:18.583
> 
> 标签：iphone, ios, uitextfield, uitableview

我有一个`UITableView`被分解成用户定义数量的`sections`. 在这些`sections`中的每一个中总是有 2 `rows`。这两个中的每一个都`rows`包含一个`UITextField`用户可以编辑的内容。

我需要的是一种能够在`UITextFields`以后访问这些数据的方法。我希望这将是一个简单的问题，但它给我带来了很大的悲伤。

到目前为止，我尝试了两种方法：

**尝试 1**

我创建了两个`NSMutableArrays`，其中我将`UITextField`对象添加到索引 i （对应于`section`它来自）。然后我尝试通过遍历数组来访问这些值。这不起作用，因为`UITextFields`一直被擦干净。每次我向下滚动表格并且看不见`UITextField`时，当我回去时，它的内容已被擦干净。

**尝试 2**

我试图掌握其中的数量`sections`（`UITableView`这很好）。然后我想遍历每个，记录每个中的`section`值。这就是我陷入困境的地方，因为我不确定如何做到这一点，或者是否可能。`UITableView``rows`

如果这是一个幼稚的问题，我深表歉意，但是我真的很挣扎，希望得到任何建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T16:58:16.587

请记住，文本字段会在您滚动时重复使用，因此您并不真的想存储对它们的引用。

相反，您所做的是在输入信息时捕获信息。`textFieldDidEndEditing`最简单的方法是在委托中实现协议方法。

棘手的部分是确定文本字段在哪一行。最好的方法是创建一个`UITableViewCell`具有`NSIndexPath`属性的子类。然后，您可以在使用 配置单元格时进行设置`tableview:willDisplayCell:forRowAtIndexPath:`。

然后，在 textFieldDidEndEditing 中，通过其父视图访问 tableViewCell indexPath 属性。IE：

```
NSIndexPath indexPathOfParentCell = [(MyUITableViewCellSubclass *)self.superview indexPath]; 
```

这样做可以让您知道单元格的部分和行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T17:10:32.010

像这样在表格的 cellForRow 中创建您的 TextField 并给它一个标签

```
 UITextField * userField = [[[UITextField alloc] initWithFrame:CGRectMake(0, 12, self.view.frame.size.width -20, 20)] autorelease];
    userField.tag = 1001;
    userField.font = [UIFont fontWithName:@"HelveticaNeue-Bold" size:14];
    userField.textAlignment = UITextAlignmentCenter;
    userField.delegate = self;
    userField.autocorrectionType = UITextAutocorrectionTypeNo;
    userField.autocapitalizationType = UITextAutocapitalizationTypeNone;
    userField.clearButtonMode = UITextFieldViewModeWhileEditing;

    if (indexPath.row == 0)
        [cell.contentView addSubview:userField]; 
```

然后像这样访问 TextField：

```
 UITextField *userField = (UITextField *)[[(UITableViewCell *)[(UITableView *)tableView cellForRowAtIndexPath:[NSIndexPath indexPathForRow:0 inSection:0]] contentView] viewWithTag:1001]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T17:00:39.917

如果您将文本字段的**文本**保留在数组中，而不是文本字段本身，您的“尝试 1”应该可以正常工作。（任何试图在数据对象中创建视图或控件的操作都很有可能出错。）

如果内容是单独存储的，那么无论作为表格视图的数据源的什么都应该能够根据部分和行重新填充滚动的单元格。

# objective-c - Objective-C 复制点击的文件/选中的文本

> ID：10820767
> 
> 赞同：-4
> 
> 时间：2012-05-30T16:54:31.400
> 
> 标签：objective-c, copy

我想做一个复制粘贴应用程序。如何开发一个 Objective-C 程序，我可以从用户在 Finder 上单击的文件中复制数据？例如，普通的复制粘贴可以复制用户在 Finder 上单击的任何文件，我的程序如何做到这一点？

我也想知道如何从其他应用程序（即文本编辑器）复制任何文本，就像正常的复制粘贴一样？

如果需要，我会进一步澄清。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T17:46:30.783

从阅读[*粘贴板编程指南*](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/PasteboardGuide106/Introduction/Introduction.html#//apple_ref/doc/uid/TP40008100-SW1)开始。当您在任何程序中复制数据时，该数据通常存储在*粘贴板上*。进行复制的程序可以选择是否导出粘贴板上的数据。如果是这样，它还可以选择将数据转换为可能对其他程序更有用的其他格式。

您不能也不应该担心尝试在其他程序中复制数据。那些其他程序将为您做到这一点。您的程序所要做的就是查看可用粘贴板上的数据并使用适合您正在做的任何事情的那些项目。因此，如果用户在文本编辑器中复制（或剪切）一些文本，然后切换到您的应用程序，则数据通常会在其中一个粘贴板上等待您。

# actionscript-3 - 几个错误“未定义属性的访问”

> ID：10820768
> 
> 赞同：0
> 
> 时间：2012-05-30T16:54:36.300
> 
> 标签：actionscript-3, addeventlistener, stage

所以我的文档类中有这个非常基本的代码：

```
package
{
    import flash.display.Sprite;
    import flash.events.Event;
    import flash.events.KeyboardEvent;
    import flash.ui.*;
    import flash.events.MouseEvent;
    import flash.display.Stage;
    import flash.display.MovieClip;

    public class Main extends Sprite
    {
        //Properties
        public var circle:Circle;
        public var vx:Number;
        public var vy:Number;   
        addEventListener(KeyboardEvent.KEY_DOWN, onKeyboardDown);
        addEventListener(KeyboardEvent.KEY_UP, onKeyboardUp);
        addEventListener(Event.ENTER_FRAME, onEnter);
        public function addedToStageHandler(event:Event):void
        {

        }
        public function Main()
        {
            super();
            init();
        }
        public function init():void
        {
            vx = 0;
            vy = 0;

            circle = new Circle(35, 0x0066FF);
            stage.addChild(circle);
            circle.x = 50;
            circle.y = 50;          

        }
        public function onKeyboardDown(event:KeyboardEvent):void
        {
            switch(event.keyCode)
            {
                case Keyboard.LEFT:
                vx = -5;
                break;
                case Keyboard.RIGHT:
                vx = 5;
                break;
                case Keyboard.UP:
                vy = -5;
                break;
                case Keyboard.DOWN:
                vy = 5;
                break;
            }
        }
        public function onKeyboardUp(event:KeyboardEvent):void
        {
            switch(event.keyCode)
            {
                case Keyboard.LEFT:
                vx = 0;
                break;
                case Keyboard.RIGHT:
                vx = 0;
                break;
                case Keyboard.UP:
                vy = 0;
                break;
                case Keyboard.DOWN:
                vy = 0;
                break;
            }
        }
        public function onEnter(event:Event):void
        {
            circle.x += vx;
            circle.y += vy;
        }
    }
} 
```

问题是我不断收到对初学者没有任何意义的错误：

“调用可能未定义的方法 addEventListener。” x 3“访问未定义的属性 onEnter。” “访问未定义的属性 onKeyboardUp。” “访问未定义的属性 onKeyboardDown。”

我真的不明白这个问题。AS3 怎么不能识别 addEventListener？同样，我确实拥有它，所以我的事件侦听器被添加到舞台“stage.addEventListener”中，它也无法识别舞台。有人可以在这个问题上将我推向正确的方向吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T17:19:12.717

这是合乎逻辑的，因为您必须将 eventListeners 放在“init”方法或 Class 构造函数中。

```
public function init():void
{
    addEventListener(KeyboardEvent.KEY_DOWN, onKeyboardDown);
    addEventListener(KeyboardEvent.KEY_UP, onKeyboardUp);
    addEventListener(Event.ENTER_FRAME, onEnter);

    vx = 0;
    vy = 0;

    circle = new Circle(35, 0x0066FF);
    stage.addChild(circle);
    circle.x = 50;
    circle.y = 50;         
} 
```

如果不是，则侦听器被放置在类范围之外，因此无法识别。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T01:28:24.570

总而言之，您的代码几乎就在那里，您只需要更好地了解显示列表的工作原理。

```
package
{
    import flash.display.Sprite;
    import flash.events.Event;
    import flash.events.KeyboardEvent;
    import flash.ui.*;
    import flash.events.MouseEvent;
    import flash.display.Stage;
    import flash.display.MovieClip;

    public class Main extends Sprite
    {
        //Properties
        public var circle:Circle;
        public var vx:Number;
        public var vy:Number;

       // we can not do function calls like this in the class declaration area
       // so we move these listeners to a function
       // addEventListener(KeyboardEvent.KEY_DOWN, onKeyboardDown);
       // addEventListener(KeyboardEvent.KEY_UP, onKeyboardUp);
       // addEventListener(Event.ENTER_FRAME, onEnter);

        public function Main()
        {
            super();
            this.init();
        }
        public function init():void
        {
            // the "this" keyword means we are scoping it to this class instance 
            this.addEventListener( EVENT.ADDEDTOSTAGE, addedToStageHandler)

            // using "this" is good practice and will help make your code more readable
            this.vx = 0;
            this.vy = 0;

            this.circle = new Circle(35, 0x0066FF);
            stage.addChild(circle);
            this.circle.x = 50;
            this.circle.y = 50;          

        }
        public function addedToStageHandler(event:Event):void
        {
            // doing addEventListener(KeyboardEvent.KEY_DOWN, onKeyboardDown);
            // will set the scope for this listener to this class
            // you want to target the stage. And since we are waiting for ADDEDTOSTAGE
            // to trigger we know we are on the stage.
            // the only time we can access stage is if we are on the display list.

            // clean up the listener since we do not need it anymore
            this.removeEventListener( EVENT.ADDEDTOSTAGE, addedToStageHandler)

            stage.addEventListener(KeyboardEvent.KEY_DOWN, onKeyboardDown);
            stage.addEventListener(KeyboardEvent.KEY_UP, onKeyboardUp);
            stage.addEventListener(Event.ENTER_FRAME, onEnter);

        }
        public function onKeyboardDown(event:KeyboardEvent):void
        {
            switch(event.keyCode)
            {
                case Keyboard.LEFT:
                  this.vx = -5;
                  break;
                case Keyboard.RIGHT:
                  this.vx = 5;
                  break;
                case Keyboard.UP:
                  this.vy = -5;
                  break;
                case Keyboard.DOWN:
                  this.vy = 5;
                  break;
            }
        }
        public function onKeyboardUp(event:KeyboardEvent):void
        {
            switch(event.keyCode)
            {
                case Keyboard.LEFT:
                  this.vx = 0;
                  break;
                case Keyboard.RIGHT:
                  this.vx = 0;
                  break;
                case Keyboard.UP:
                  this.vy = 0;
                  break;
                case Keyboard.DOWN:
                  this.vy = 0;
                  break;
            }
        }
        public function onEnter(event:Event):void
        {
            this.circle.x += this.vx;
            this.circle.y += this.vy;
        }
    }
} 
```

# scala - 有条件地连接到数据库

> ID：10820771
> 
> 赞同：6
> 
> 时间：2012-05-30T16:54:42.413
> 
> 标签：scala, playframework, playframework-2.0

要访问数据库，必须在 conf 文件中指定数据库详细信息。

如果数据库启动，一切正常。

如果数据库关闭，Play 会抛出一个我无法控制的异常。

我想有条件地连接到数据库。假设我只想在某处设置标志时连接到数据库。是否有更手动的方式连接到 Play 中的数据库？

更新：我想我还不是很清楚。

如果数据库关闭并从其他备用来源获取数据，我希望应用程序不会失败。我怎样才能在 PLAY 中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T19:17:17.597

我假设您想在没有用于开发的数据库的情况下启动您的应用程序？您可以在启动时传递一个替代配置文件，例如在内存数据库中配置一个：

```
start -Dconfig.resource=development.conf 
```

编辑：

您可以在应用程序配置中配置多个数据库，并使用 DB.getConnection[A](name: String)(f: Connection => A) 获取它们`DB.getDataSource(name: String)`或与之建立连接，`DB.getConnection(name: String)`甚至运行事务

见：[http](http://www.playframework.org/documentation/api/2.0/scala/index.html#play.api.db.DB) ://www.playframework.org/documentation/api/2.0/scala/index.html#play.api.db.DB $

# vb.net - 使用 Dday.ical 如何发送具有相同开始时间和持续时间的多个事件

> ID：10820773
> 
> 赞同：0
> 
> 时间：2012-05-30T16:54:45.630
> 
> 标签：vb.net, outlook, icalendar

当我使用 DDay.ical 设置事件时，我可以成功地将事件发送到用户的前景。当同时设置多个事件时会出现问题。发生这种情况时，所有电子邮件都是对原始任务的更新，而不是新任务。

我尝试使用 .Name 属性向事件添加名称，这导致事件电子邮件成为不受支持的日历邀请。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T17:39:38.167

最终通过一些好的旧试验和错误来解决这个问题。

最后，我没有正确地将 UID 属性设置为每个事件的完全唯一标识符。将其更改为 100% 的唯一时间解决了问题，并允许我能够在任何时候创建任意数量的事件，并将它们全部显示为单独的事件而不是更新。

# iphone - iPhone 移动应用程序管理

> ID：10820780
> 
> 赞同：4
> 
> 时间：2012-05-30T16:55:04.677
> 
> 标签：iphone, ios5, ios4, mdm

我正在尝试为 iPhone 开发一个关键的企业应用程序，它需要能够列出设备上所有已安装的应用程序。此外，该应用程序应允许用户通过单击某些安装按钮来安装此应用程序中的其他应用程序，并通过单击某些卸载按钮来卸载应用程序。这意味着该应用程序应该能够管理设备上的所有应用程序（至少所有企业应用程序在设备）。

我知道在沙盒 iPhone 环境中这是不可能的。所以我正在考虑设置一些 MDM/MAM 服务器，它接受来自 iPhone 中客户端应用程序的请求，并让 MDM/MAM 服务器管理应用程序安装、删除等。

是否可以设置自定义 MDM 或 MAM 服务器？我们已经有一个企业帐户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T03:21:47.150

如果您想确定是否安装了您公司提供的其他应用程序，您可以将每个应用程序的唯一 URL 方案添加到应用程序的`Info.plist`. 然后检查他们的安装，你可以反复检查从`-[UIApplication canOpenURL:]`

如果您想对此狡猾，您可以从 Intranet 上的服务器下载 url 方案列表。因此，没有特定应用程序的用户可以被引导下载它。此外，您可以通过每个应用程序的每个应用程序版本的第二个特殊 url 检查已安装的版本。

这可以满足您的大部分需求……至于卸载，用户只需按住应用程序，直到它抖动然后将其删除。

# sorting - 如何按喜欢的数量对用户管理的页面进行排序

> ID：10820781
> 
> 赞同：0
> 
> 时间：2012-05-30T16:55:08.153
> 
> 标签：sorting, facebook-like, facebook-page

所以我一直在寻找一种管理员可以按“喜欢”计数对 Facebook 页面进行排序的方法（对于他们管理的页面很多的用户。）

可能吗？任何人都可以给我一个关于如何实现这一目标的提示。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T17:36:48.823

您可以使用此[FQL 查询](https://developers.facebook.com/tools/explorer?method=GET&path=fql%3Fq%3DSELECT%20page_id%2C%20name%2C%20username%2C%20fan_count%20FROM%20page%20WHERE%20page_id%20IN%20%28SELECT%20page_id%20FROM%20page_admin%20WHERE%20uid%20%3D%20me%28%29%29%20ORDER%20BY%20fan_count%20DESC)来做到这一点：

```
SELECT page_id, name, username, fan_count 
       FROM page 
       WHERE page_id IN 
          (SELECT page_id FROM page_admin WHERE uid = me()) 
       ORDER BY fan_count DESC 
```

# javascript - 手风琴是如何工作的？

> ID：10820782
> 
> 赞同：2
> 
> 时间：2012-05-30T16:55:08.580
> 
> 标签：javascript, jquery

我不是在问如何`show/hide`满足`click`。

我只想知道如何通过放置 2 个 div，一个在另一个顶部，我可以通过单击底部 div 来“关闭”上部 div 的效果。就这样。不完全是手风琴，但这对我的情况来说已经足够了。

在单击底部 div 后，我试图通过将上部 div 高度设置为 0 来实现这一点。它工作但不够顺利。和 IE 浏览器不喜欢它：

**查询**

```
$('#BottomDiv').click(function() {    
    $('#UpperDiv').animate({ height: '0px' }, "slow");
}); 
```

在标记方面，两个 div 都是位置 - 相对的：

**HTML**

```
 <div id="UpperDiv" style="height:190px; width:100%; margin-top:80px; position:relative">
  </div>
  <div id="BottomDiv" style="width:100%; position:relative; z-index:10; float:left;" >
  </div> 
```

所以我只是好奇也许有更好的方法来实现这一点，就像 jQuery 手风琴一样。流畅且适用于所有浏览器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T17:55:44.477

假设结构如下：

```
<div id="accordionWrapper">
    <div id="UpperDiv" class="accordionSlides">
        <h2>Accordion tab</h2>
        <!-- other content, 'p' elements in the demo -->
    </div>

    <div id="MiddleDiv" class="accordionSlides">
        <h2>Accordion tab</h2>
        <!-- other content, 'p' elements in the demo -->
    </div>

    <div id="BottomDiv" class="accordionSlides">
        <h2>Accordion tab</h2>
        <!-- other content, 'p' elements in the demo -->
    </div>
</div>​ 
```

那我建议：

```
$('#accordionWrapper .accordionSlides').click(
    function(){
        var cur = $(this);
        cur.siblings().children().not('h2').slideUp(); // hides
        cur.find('p').slideToggle(); // shows
    });​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/xft79/1/)。

参考：

*   [`children()`](http://api.jquery.com/children/).
*   [`click()`](http://api.jquery.com/click/).
*   [`find()`](http://api.jquery.com/find/).
*   [`not()`](http://api.jquery.com/not/).
*   [`slideToggle()`](http://api.jquery.com/slideToggle/).
*   [`slideUp()`](http://api.jquery.com/slideUp/).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T17:50:14.677

这有帮助吗？

**标记：**

```
<div id="UpperDiv" style='background:red;height:200px;'>
</div>
<div id="BottomDiv" style="background:Gray;height:200px;">
</div> 
```

**Javascript：**

```
$('#BottomDiv').click(function() {    
    $('#UpperDiv').slideUp("slow","linear");
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T17:12:55.893

```
$('#BottomDiv').click(function() {    
    $('#UpperDiv').css("display", 'none');
}); 
```

上面是简单的解决方案，但是，更优雅的是定义一个 css 类，例如：

```
.invisible
{
    display: none;
} 
```

并且您可以使用 addClass 函数使某些内容不可见，并且您可以使用标签中的 removeClass 删除此类以使其再次可见。

# iphone - 将 Storyboard 与没有 UITableViews 的 UIViewControllers 一起使用

> ID：10820786
> 
> 赞同：0
> 
> 时间：2012-05-30T16:55:17.920
> 
> 标签：iphone, uistoryboard

我观看了关于使用故事板的 WWDC 教程，并且可以看到使用 tableviews 的好处，但我不太明白你将如何使用它们。

例如，如果我正在使用 MKMapView，并且我提供了一个图钉和该图钉的标注，如果我想转到我的下一个视图控制器，据我所知，我必须转到下一个详细视图控制器在代码中，并且在这种情况下不能使用情节提要或 segue。还是我弄错了，当您不使用 UITableViews 时，通过情节提要呈现视图控制器还有一些额外的好处？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T17:10:38.133

当由除表格单元格之外的 UI 元素触发时，Segues 起作用。

它们也可以在代码中请求时工作。例如，在两个控制器（不是视图或控件）之间创建一个 segue，并且可以使用`performSegueWithIdentifier:(NSString *)identifier sender:(id)sender`.

# c# - Java 如何处理原始类型数组？

> ID：10820787
> 
> 赞同：1
> 
> 时间：2012-05-30T16:55:25.340
> 
> 标签：c#, java, arrays, primitive-types

> **可能重复：**
> [整数数组如何在 JVM 内部存储？](https://stackoverflow.com/questions/76549/how-are-integer-arrays-stored-internally-in-the-jvm)

在 C# 中，当您创建一个作为引用类型的新数组时，它会将指针放在 Stack 上，并将对象本身放在 Heap 中。如果您使用简单的原始类型（例如 , 等）创建此数组`int`，`double`那么它所做的就是将值准确地放在它们在堆中放置的位置，而不是指向另一个存储其内容的堆地址的指针。

那么有人可以解释一下这在Java中是如何发生的吗？Java`Integer`一直在数组中使用（引用类型）还是像 C# 一样对待值类型？

```
int[] hello = new int[5];
hello[0] = 2; // C# put this value directly in same slot and doesn't 
//create a wrapping object. 
```

我知道 C# 没有的称为 Java 中的包装类型的东西。C# 具有自动装箱功能，但`Int32`可以说不是引用类型，而是`ValueType`as`Integer`是对象而不是`int`. 您可以使用`Object o = 5;`或者如果 struct 确实有一个父类来装箱一个值，您也可以使用它来将它包装在堆中（装箱）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T16:59:31.540

Java与您描述的大致相同。

```
int[] hello = new int[5]; // reference hello is on stack, the object is on the heap.
hello[0] = 2; // Java puts this value directly in same slot and doesn't 
              // create a wrapping object. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T16:58:07.880

Java 原始数组作为原始数组存储在堆中，而不是整数等。我不相信它们存储方式的实际实现是指定的，因此 boolean[] 很可能由 int[] 实现记忆

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T18:41:16.833

在Java中，无论是保存原始变量还是对象类型，Array都被视为一个Object，在Java中，Array只有一个实例变量，称为length。

int[] arr = new int[5];

arr here is an object reference array variable, which is stored on the `STACK` if its used `Inside` the method(ie as `local variable`), `But` if its used as an `instance variable`, then its stored inside the object on the `Heap`.

# c# - 在不访问 MouseEventArgs 的情况下获取鼠标状态？

> ID：10820788
> 
> 赞同：15
> 
> 时间：2012-05-30T16:55:26.010
> 
> 标签：c#, .net, winforms, mouse

我有一个包含许多控件的表单。我需要检测鼠标是向下还是向上。大多数时候，我没有**MouseEventArgs**。

有没有一种快速简便的方法来判断鼠标是否在没有 mouseEventArgs 的情况下关闭？

有没有其他选择，或者像这样的唯一方法？：

```
foreach (Control c in this.Controls)
{
    c.MouseUp += new MouseEventHandler(globalMouseUp);
    c.MouseDown += new MouseEventHandler(globalMouseDown);
}

bool isMouseUp = true;

private void globalMouseDown(object sender, MouseEventArgs e)
{
    isMouseUp = false;
}

private void globalMouseUp(object sender, MouseEventArgs e)
{
    isMouseUp = true;
} 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-05-30T16:59:58.000

您可以尝试使用计时器检查：

```
private void timer1_Tick(object sender, EventArgs e) {
  this.Text = "Mouse Is " + (Control.MouseButtons == MouseButtons.Left);
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2017-06-22T02:24:40.600

检查 Control.MouseButtons 静态属性：

```
if (Control.MouseButtons == MouseButtons.Left)
{
} 
```

# android - 具有可绘制和依赖位置的自定义 xml

> ID：10820795
> 
> 赞同：0
> 
> 时间：2012-05-30T16:56:06.487
> 
> 标签：android, android-layout, drawable

具有所需布局的图像：

![在此处输入图像描述](../Images/0dc48a6773c16dd5d9c1b02408318dd3.png)我有以下情况：

我有一个包含从数据库填充的按钮的组（例如，特定表中的 10 个项目将填充该组中的 10 个按钮） - 工作正常。

我不知道该怎么做的部分是：

*   我希望这个按钮将显示为一个圆圈（可绘制），并且在该圆圈内有一个图像（路径将从数据库中获取）和上述说明中的标签（来自表格）。

*   如果有一个项目，它将位于屏幕中央，并且随着按钮数量的增加，圆圈将设置在 3 列的网格内。

有人可以帮我解决这个问题吗？

我尝试使用不同方法（使用 RadioButtons）的旧版本，在此示例中没有 Image 或 drawable，并且项目是 RadioGroup 中的 radioButtons：

```
DatBas dbc = new DatBas(Tamar_appActivity.this);
    dbc.open();
    SQLiteDatabase tdb = dbc.getDatabase();
    String[] columns = new String[] { DatBas.KEY_ROW_B_ID,
            DatBas.KEY_B_NAME };
    Cursor c = tdb.query(DatBas.DATABASE_TABLE_SETTINGS, columns, null,
            null, null, null, null);

    int iRawBId = c.getColumnIndex(DatBas.KEY_ROW_ID);
    int iBName = c.getColumnIndex(DatBas.KEY_B_NAME);

    for (c.moveToFirst(); !c.isAfterLast(); c.moveToNext()) {

        RadioGroup radiogroup = (RadioGroup)   
                    findViewById(R.id.bNameSelectGroup);
        final Button rdbtn = new Button(this);

        rdbtn.setId(iRawBId);
        rdbtn.setText(c.getString(iBName));
        radiogroup.addView(rdbtn);
    }
    dbc.close();

} 
```

这是 SpacialButton.java 代码：

```
public class SpecialButton extends RelativeLayout {

public TextView text;
//public ImageView image;

public SpecialButton(Context context) {
    super(context);
    this.setBackgroundResource(R.drawable.cb_shape);
    LayoutInflater.from(context).inflate(R.layout.cb_inner,
            this, true);
    text = (TextView) findViewById(R.id.textView1);
//    image = (ImageView) findViewById(R.id.imageBB);
}

public SpecialButton(Context context, AttributeSet attrs, int defStyle) {
    super(context, attrs, defStyle);
}

public SpecialButton(Context context, AttributeSet attrs) {
    super(context, attrs);
}

} 
```

这是 cb_inner.xml 代码：

```
<?xml version="1.0" encoding="utf-8"?>
<merge xmlns:android="http://schemas.android.com/apk/res/android" >

    <!-- This will hold the image from the database -->
    <ImageView
        android:id="@+id/imageBB"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true" />

    <View
        android:id="@+id/anchor"
        android:layout_width="0dp"
        android:layout_height="0dp"
        android:layout_centerInParent="true" />

    <!-- This will be the label. It will be placed below the center -->
    <TextView
        android:id="@+id/cbTextView"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/anchor"
        android:layout_centerHorizontal="true"
        android:text="TextView"
        android:textColor="#000000" />

</merge> 
```

这是 Main.java 代码：

```
 @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        TableLayout tl = (TableLayout) findViewById(R.id.grid);
            Display display2 = getWindowManager().getDefaultDisplay(); 
            int width = display2.getWidth();  
            int height = display2.getHeight(); 
            int realSize = width / 3;

        DatBas dbc = new DatBas(Tamar_appActivity.this);
        dbc.open();
        SQLiteDatabase tdb = dbc.getDatabase();
        String[] columns = new String[] { DatBas.KEY_ROW_B_ID,
                DatBas.KEY_B_NAME };
        Cursor c = tdb.query(DatBas.DATABASE_TABLE_SETTINGS, columns, null,
                null, null, null, null);
        c.moveToFirst();
        int iRawBId = c.getColumnIndex(DatBas.KEY_ROW_B_ID);
        int iBName = c.getColumnIndex(DatBas.KEY_B_NAME);
        int iBimage = c.getColumnIndex(DatBas.KEY_B_IMAGE_PATH);
//      ic_launcher.png
        int cursorSize = c.getCount();
        int rows = (cursorSize / 3) + 1; // +1 so you have at least one row if the number of button is below 3
        int current = 1; // starting position
        for (int i = 0; i < rows; i++) {
            TableRow tr1 = new TableRow(this);
            tr1.setLayoutParams(new TableLayout.LayoutParams(
                    TableLayout.LayoutParams.FILL_PARENT,
                    TableLayout.LayoutParams.WRAP_CONTENT));
            for (int j = 0; j < 3; j++) {
                if (current <= cursorSize) {
                    SpecialButton sb = new SpecialButton(this);
                    sb.text.setText(c.getString(iBName));
                    sb.setLayoutParams(new TableRow.LayoutParams(realSize,
                            realSize));
                    // other stuff you would do
//                  sb.image.getDrawable();
                    tr1.addView(sb);
                    c.moveToNext();
                }
                current++;
            }
            tl.addView(tr1);
        }
        dbc.close();

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T18:33:41.703

> 我希望这个按钮将显示为一个圆圈（可绘制），在该圆圈内有一个图像（路径将从数据库中获取），以及来自上述说明的标签（来自表格）。

我建议您制作一个布局文件来模拟所有项目：

```
<?xml version="1.0" encoding="utf-8"?>
<merge xmlns:android="http://schemas.android.com/apk/res/android" >

    <!-- This will hold the image from the database -->
    <ImageView
        android:id="@+id/image"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true" />

    <View
        android:id="@+id/anchor"
        android:layout_width="0dp"
        android:layout_height="0dp"
        android:layout_centerInParent="true" />

    <!-- This will be the label. It will be placed below the center -->
    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/anchor"
        android:layout_centerHorizontal="true"
        android:text="TextView"
        android:textColor="#000000" />

</merge> 
```

上面使用的`item_background`drawable：

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="oval" >

    <solid android:color="#92c47d" />

    <stroke
        android:width="2dp"
        android:color="#000000" />

</shape> 
```

然后你可能想把它放在一个自定义`View`类中以便于处理：

```
 public class SpecialButton extends RelativeLayout {

    public TextView text;
    public ImageView image;

    public SpecialButton(Context context) {
        super(context);
        this.setBackgroundResource(R.drawable.item_background1);
        LayoutInflater.from(context).inflate(R.layout.views_special_btn_layout,
                this, true);
        text = (TextView) findViewById(R.id.textView1);
        image = (ImageView) findViewById(R.id.image);
    }

    public SpecialButton(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
    }

    public SpecialButton(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

} 
```

模拟一个`Button`添加`OnCLickListener`到上面的自定义视图。没有办法在 xml drawable 中创建一个圆圈（据我所知），所以如果你没有`View`上面自定义的确切大小（比如 的值`100dp`），你将在代码中计算它。此外，如果您想将`TextView` *标签*放置在某个特定位置，则必须再次在代码中执行此操作。我不确切知道您希望如何将按钮放置在屏幕上，但通常您会找出屏幕的宽度和高度并从中计算实际尺寸：

```
// in the onCreate method
Display display = getWindowManager().getDefaultDisplay(); 
int width = display.getWidth();  
int height = display.getHeight(); 
// here I assumed you have only 3 buttons and you want them to be placed taking all
// the width of the screen(of course this isn't ideal because if the user turns the
// phone, in landscape, you'll end up with 3 really big buttons so you may want to   
// set a default size for the buttons )
int realSize = width / 3; 
Cursor c = tdb.query(DatBas.DATABASE_TABLE_SETTINGS, columns, null,
            null, null, null, null);
    int iRawBId = c.getColumnIndex(DatBas.KEY_ROW_ID);
    int iBName = c.getColumnIndex(DatBas.KEY_B_NAME);
    int cursorSize = c.getCount();
    int rows = (cursorSize / 3) + 1; // +1 so you have at least one row if the number of button is below 3
    int current = 1; // starting position
    for (int i = 0; i < rows; i++) {
        TableRow tr = new TableRow(this);
        tr.setLayoutParams(new TableLayout.LayoutParams(
                TableLayout.LayoutParams.FILL_PARENT,
                TableLayout.LayoutParams.WRAP_CONTENT));
        for (int j = 0; j < 3; j++) {
            if (current <= cursorSize) {
                SpecialButton sb = new SpecialButton(this);
                sb.text.setText(c.getString(iBName));
                sb.setLayoutParams(new TableRow.LayoutParams(realSize,
                        realSize));
                // other stuff you would do
                tr.addView(sb);
                c.moveToNext();
            }
            current++;
        }
        tl.addView(tr);
    } 
```

> 如果有一个项目，它将位于屏幕的中心，并且随着按钮数量的增长，圆圈将设置在 3 列的网格内。

我不知道您当前的布局，但这可以在这样的布局中非常容易地完成（我假设您想将项目放在 a 中`TableLayout`）：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center"
    android:orientation="vertical" >

    <TableLayout
        android:id="@+id/grid"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" >
    </TableLayout>

</LinearLayout> 
```

然后，您将元素放置在代码中（每个 3 项在 a 中`TableRow`），并且`gravity` parent`LinearLayout`属性的 应该将它们放在中心。您可以使用 a`GridView`而不是 a，`TableLayout`但您必须努力使项目居中。上面 3 个按钮的示例：

```
 // in the onCreate method
       tl = (TableLayout) findViewById(R.id.grid);
        Display display = getWindowManager().getDefaultDisplay(); 
        int width = display.getWidth();  
        int height = display.getHeight(); 
        int realSize = width / 3;
        TableRow tr = new TableRow(this);
        tr.setLayoutParams(new TableLayout.LayoutParams(
                TableLayout.LayoutParams.FILL_PARENT,
                TableLayout.LayoutParams.WRAP_CONTENT));
        SpecialButton sb1 = new SpecialButton(this);
        sb1.setLayoutParams(new TableRow.LayoutParams(realSize, realSize));
        SpecialButton sb2 = new SpecialButton(this);
        sb2.setLayoutParams(new TableRow.LayoutParams(realSize, realSize));
        SpecialButton sb3 = new SpecialButton(this);
        sb3.setLayoutParams(new TableRow.LayoutParams(realSize, realSize));
        tr.addView(sb1);
        tr.addView(sb2);
        tr.addView(sb3);
        tl.addView(tr); 
```

# ruby-on-rails - 活动管理员：自定义页面上带有日期选择器的表单

> ID：10820799
> 
> 赞同：5
> 
> 时间：2012-05-30T16:56:29.497
> 
> 标签：ruby-on-rails, forms, activeadmin

好吧，我在 Active Admin 中创建了一个名为“最新客房”的自定义页面，它显示了一个包含当前日期酒店客房的表格。

现在我想在这个自定义页面中添加一个表单，我可以在其中选择日期。我设法通过以下方式使表单与 Datepicker 一起出现：

```
<%= semantic_form_for :newest_rooms, :builder => ActiveAdmin::FormBuilder do |f|
   f.inputs do
     f.input :Datum, :as => :datepicker
   end
   f.buttons
end %> 
```

但不知道如何将其发送到正确的控制器和方法 HotelRoom.newest_rooms

我希望有人可以向我解释如何做到这一点。我添加了以下代码：

latest_room.rb

```
ActiveAdmin.register_page "Newest Rooms" do

  menu :label => "Newest Rooms"

  content do
      render "newest_rooms"
  end
end 
```

_newest_room.html.erb

```
<% @cities = Hotel.cities %>

<%= semantic_form_for :newest_rooms, :builder => ActiveAdmin::FormBuilder do |f|
   f.inputs do
     f.input :Datum, :as => :datepicker
   end
   f.buttons
end %>

<ul class="room_list">
<% @cities.each do |c| %>
<li>
    <table>
    <tr>
        <td>
            <h2><%= c.City %></h2>
        </td>
    </tr>
    <tr class="room_column">
        <td>Hotel</td>
        <td>Free Rooms</td>
        <td>BN-Price</td>
        <td>Old Price</td>
    </tr>
    <% @rooms = HotelRoom.newest_rooms(c.City) %>
    <% @rooms.each do |r| %>
    <tr>
        <td><%= r.hotel.Hotelname %></td>
        <td><%= r.FreeRooms %></td>
        <td><b><%= r.Price %>€&lt;/b></td>
        <td><%= r.OldPrice %>€&lt;/td>
    </tr>   
    <%end%>

</table>
</li>
<% end %>
</ul> 
```

hotel_room.rb

```
class HotelRoom < ActiveRecord::Base
  validates :title, :presence => true
  self.table_name = "hotel_room"

  belongs_to :hotel, :foreign_key => 'H_ID'
  accepts_nested_attributes_for :hotel 

  def to_key
    [self.ID]
  end

  def self.newest_rooms(city)

      HotelRoom.find(:all, :joins => :hotel, :conditions => ["hotel.City = ? and hotel_room.Date = ?", city, Date.today])

  end

end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-04T19:22:20.023

将 url 添加到您的语义形式中，例如...

```
<%= semantic_form_for :newest_rooms, :url => hotel_newest_room_path, :builder => ActiveAdmin::FormBuilder do |f| %> 
```

# php - 通过一个表单提交的单个动态值

> ID：10820801
> 
> 赞同：0
> 
> 时间：2012-05-30T16:56:45.627
> 
> 标签：php, javascript, html, codeigniter

我正在使用 Jquery UI Selectable。用户可以选择将新的列表项动态添加到原始设置中。

我想包括一个“清除”按钮，使用户能够通过单击 X 输入提交 (img) 来清除他们创建的每个单独项目。

HTML (php)

```
 if ($this->session->userdata('inactivefilter') == true) {
            $inactivefilter = $this->session->userdata('inactivefilter');
            $i=0;
            foreach ($inactivefilter as $filter)
                {
                    $filterdash = implode('-', explode(' ', $filter));
                    echo "<li class='ui-state-default' id='$filterdash'>$filter</li>";
                    echo "<div id=clear>
                            <form method='POST' action='".base_url()."main/clear_filter'>
                                <input type='image' name='filtervalue' value='$i' src='".base_url()."img/board/icons/clear.png'></input>
                            </form>
                          </div>";
                    $i++;
                }
        } 
```

这是创建列表的地方。特别是 clear_filter 动作表单。

Clear_filter 当前“尝试”获取 '$i' 的值，但我不知道如何正确传递它。

这是控制器：

```
 public function clear_filter()
    {
        $i = $_POST['filtervalue'];
        $this->thread_model->clear_filter($i);
    } 
```

由于与问题无关，我将省略 clear_filter 模型。

本质上，我只需要根据在实际页面上的动态表单中单击的任何值来获取 $i 。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T17:49:52.367

好吧，看来我只是有点倒退了。

代码或多或少是正确的。

对于 Codeigniter，您可以`value=$i`使用`name ="filtervalue"`

将控制器代码更改为：

`$i = $this->input->post('filtervalue');`

并且 $i 设置为单击的任何值。

# .net - 在图像的不透明部分内绘制边框

> ID：10820802
> 
> 赞同：1
> 
> 时间：2012-05-30T16:56:52.500
> 
> 标签：.net, gdi+, graphicspath

这个线程几乎是我需要的： [Creating a GraphicsPath from a semi-transparent bitmap](https://stackoverflow.com/questions/9752410/creating-a-graphicspath-from-a-semi-transparent-bitmap)

但他正在图像周围绘制轮廓 - 我需要在图像内部绘制一个仅几个像素的轮廓。基本上我正在尝试绘制一个“焦点矩形”（除非它不是矩形），结果需要采用 GraphicsPath 的形式，以便我可以将它直接放入我当前的代码中。

私有函数 GetImagePath(img as Image) as GraphicsPath ...结束函数

**[编辑]** 好的，首先我什至无法从其他帖子中获取代码来工作。我一直在这一行得到索引超出范围：

*byte alpha = originalBytes[y * bitmapData.Stride + 4 * x + 3];*

那就是如果它甚至先通过其他东西。很多时候它从第一个循环中出来并没有找到一个不透明的点——当大部分图像是不透明的时候。

最新的问题是它创建了一个没有任何意义的点列表。图像是 68x68 我的点列表有像 290x21 这样的点，甚至像 2316x-15 这样更疯狂的点

这是我的原始图像：

[不会让我上传因为我是新人]

它是 70x70 的按钮的背景图像 - 如果这很重要的话。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T17:04:25.053

我会考虑使用链接中提供的例程，从中获取输出，并在其周围添加您自己的包装器，以修改将其推入您想要的几个像素的路径。您甚至可以在输入参数中设置要移动的像素数量，以便您可以使用它。

否则，您可以将第二遍直接添加到提供的例程中。无论哪种方式，我认为这是一种 2 遍方法。您需要找到对象的外部边界，即提供的内容。然后，您需要自己绕着路径移动，了解路径的导数，以便您可以将路径垂直于您正在查看的当前点的导数移动。您还必须从外部识别内部（即移动线的方向）。

算法可能看起来像这样（记住只是算法）：

```
Create New List of Points for the new line

For all points i in 0 to (n-2) (points in original point list)
    // Get a New point in between
    float xNew = (x(i) + x(i + 1) ) / 2
    float yNew = (y(i) + y(i + 1) ) / 2

    // Need to figure out how much to move in X and in Y for each (pixel) move along
    // the perpendicular slope line, remember a^2 + b^2 = c^2, we have a and b
    float a = y(i + 1) - y(i)
    float b = x(i + 1) - x(i)
    float c = sqrt( (a * a) + (b * b) )

    // c being the hypotenus is always larger than a and b.
    // Lets Unitize the a and b elements
    a = a / c
    b = b / c

    // Assume the original point array is given in clockwise fashion
    a = -a
    b = -b

    // Even though a was calculated for diff of y, and b was calculated for diff of x
    // the new x is calculated using a and new y with b as this is what gives us the
    // perpendicular slope versus the slope of the given line
    xNew = xNew + a * amountPixelsToMoveLine
    yNew = yNew + b * amountPixelsToMoveLine

    // Integerize the point
    int xListAdd = (int)xNew
    int yListAdd = (int)yNew

    // Add the new point to the list
    AddPointToNewPointList(xListAdd, yListAdd)

Delete the old point list 
```

我正在执行的几何图形的图像： ![我在上面通过算法描述的几何图形](../Images/083053100c6601546741332365329904.png)

# javascript - Javascript 日期计算事件

> ID：10820803
> 
> 赞同：1
> 
> 时间：2012-05-30T16:56:57.583
> 
> 标签：javascript, javascript-events

我有以下代码用于 javascript 计算来计算 2 个日期之间的差异。我在“conference_date_out”字段之一的 .change 事件上具有该功能，但是，如果我返回并更改“date_in”日期 - “总天数”的计算不会更新。我究竟做错了什么？

JavaScript：

```
<script type="text/javascript">
    $(function () {
        $(".datepicker").datepicker({
            dateFormat: 'dd-mm-yy'
        })({
            changeMonth: true,
            changeYear: true
        });
        $(".datepicker").datepicker;
    });
    $('#conference_date_out').change(function () {
        var start = $('#conference_date_in').datepicker('getDate');
        var end = $('#conference_date_out').datepicker('getDate');
        var days = (end - start) / 1000 / 60 / 60 / 24;
        document.getElementById('total_days').value = days;
    });
</script> 
```

HTML：

```
<title>Conference Form</title>
<script type="text/javascript" src="css/jqueryui.css"></script>
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/jqueryui.js"></script>
<link href="style.css" rel="stylesheet" type="text/css" />
<link href="css/jqueryui.css" rel="stylesheet" type="text/css" />
<body>
    <div id="wrapper">
        <div id="header"></div>
        <table width="705" border="1" align="left" cellpadding="1">
            <form action="" method="get" name="myform">
                <tr>
                    <td width="151">
                        <label>Company Name</label>
                    </td>
                    <td width="158">
                        <input type="text" name="companyname" id="companyname" />
                    </td>
                    <td width="155">Enquiry Date</td>
                    <td width="213">
                        <input type="text" name="enquiry_date" id="enquiry_date" />
                    </td>
                </tr>
                <tr>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                </tr>
                <tr>
                    <td>Conference Date In</td>
                    <td>
                        <input type="text" name="conference_date_in" id="conference_date_in" class="datepicker"
                        />
                    </td>
                    <td>Conference Date Out</td>
                    <td>
                        <input type="text" name="conference_date_out" id="conference_date_out"
                        class="datepicker" />
                    </td>
                </tr>
                <tr>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                </tr>
                <tr>
                    <td>Number of Delegates</td>
                    <td>
                        <input type="text" name="no_of_delegates" id="no_of_delegates" />
                    </td>
                    <td>Total Days</td>
                    <td>
                        <input type="text" name="total_days" id="total_days" />
                    </td>
                </tr>
            </form>
        </table>
    </div>
</body>

</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T17:02:58.363

很简单：您`change`只将处理程序绑定到`#conference_date_out`而不绑定到`#conference_date_in`.

```
$('#conference_date_in').add('#conference_date_out').change(function() {
    var start = $('#conference_date_in').datepicker('getDate');
    var end = $('#conference_date_out').datepicker('getDate');
    var days = (end - start) / 1000 / 60 / 60 / 24;
    document.getElementById('total_days').value = days;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T17:08:19.470

您只将更新功能绑定到“out”字段。尝试这个：

```
$(function() {
    $(".datepicker").datepicker({
        dateFormat: 'dd-mm-yy'
    })({
        changeMonth: true,
        changeYear: true
    });
    $(".datepicker").datepicker;
});

var calcDate = function() {
    var start = $('#conference_date_in').datepicker('getDate');
    var end = $('#conference_date_out').datepicker('getDate');
    var days = (end - start) / 1000 / 60 / 60 / 24;

    document.getElementById('total_days').value = days;
}

$('#conference_date_out').change(calcDate);
$('#conference_date_in').change(calcDate); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T17:09:55.513

您可以按如下方式简化您的 jquery：

1.  将共享课程添加到您的会议日期：

    `<input class="conference_date" name="conference_date_out"/>`

    `...`

    `<input class="conference_date" name="conference_date_out"/>`

2.  然后您可以使用以下命令监听两者的更改：

    **`$('.conference_date').change(function() { ...`**

    代替：

    `$('#conference_date_in').add('#conference_date_out').change(function() {`

您可以节省 javscript 代码，并且可以将共享类用于其他侦听器/样式。

# python - OpenCV 2.4, Python - 从 SURF 关键点检索拉普拉斯算子

> ID：10820807
> 
> 赞同：0
> 
> 时间：2012-05-30T16:57:28.600
> 
> 标签：python, opencv, computer-vision, feature-detection

我正在使用 OpenCV 2.4 来提取 SURF 特征，并且需要每个关键点的拉普拉斯值来进行匹配过程。

当我使用 OpenCV 2.3 时，我没有遇到这个问题。在 OpenCV 2.4`cv2.SURF()`中不起作用，所以我不得不这样做：

```
im2 = cv2.imread(imgPath)
im = cv2.cvtColor(im2, cv2.COLOR_BGR2GRAY)
surfDetector = cv2.FeatureDetector_create("SURF")
surfDescriptorExtractor = cv2.DescriptorExtractor_create("SURF")
keypoints = surfDetector.detect(im)
(keypoints, descriptors) = surfDescriptorExtractor.compute(im,keypoints) 
```

这可行，但是它给了我一组通用关键点对象。有没有办法获得 SURF 的特定值？（拉普拉斯，黑森）

不幸的是，我无法回到 2.3，因为 2.4 修复了我之前遇到的另一个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T21:14:04.530

假设`keypoint`是一个关键点：

```
x = keypoint.pt[0]
y = keypoint.pt[1]
size = keypoint.size
dir_in_degrees = keypoint.angle
laplacian = round(keypoint.class_id)
hessian = keypoint.response 
```

# php - 如果未找到，则数组中的针搜索返回 0

> ID：10820808
> 
> 赞同：0
> 
> 时间：2012-05-30T16:57:32.267
> 
> 标签：php, arrays, multidimensional-array

当找到 userid 的值时，我正在使用此函数搜索（最高）数组键：

```
function array_search_value($needle,$haystack) {
foreach($haystack as $key => $value) {
    if(in_array($needle, $value)) return $key;
}
  } 
```

我的数组看起来像这样（它是由一个简单的查询生成的）：

```
Array
(
[0] => Array
    (
        [0] => 1
        [userid] => 1
        [1] => 2
        [score1] => 2
        [2] => 0
        [score2] => 0
    )

[1] => Array
    (
        [0] => 3
        [userid] => 3
        [1] => 2
        [score1] => 2
        [2] => 2
        [score2] => 2
    )

[2] => Array
    (
        [0] => 4
        [userid] => 4
        [1] => 1
        [score1] => 1
        [2] => 1
        [score2] => 1
    )

[3] => 
) 
```

这段代码：

```
echo array_search_value(4, $r) 
```

返回 2，这是正确的。

寻找 1 得到 0，这是正确的。

但是，当我搜索 2（找不到）时，它返回 0。这当然是不正确的......我想要它做的是什么都不返回，而不是 0。我试过了通过添加“== true”来调整函数，但这也不起作用。

任何人都知道如何解决这个问题？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T17:06:38.060

当你搜索`2`你会得到`0`，因为你有`$haystack[0][score1] = 2`。您需要指定您要查找的内容，`userid`而不是其他任何内容。

```
foreach($haystack as $key => $value) {
  if ($value['userid'] == $needle) {
    return $key;
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T17:12:35.893

> 当我搜索 2（找不到）时，它返回 0。当然，这是不正确的......

查看您提供的数组，它*是*正确的。该值`2`出现在 key 中`0`：

```
[0] => Array
    (
        [0] => 1
        [userid] => 1
        [1] => 2 // here
        [score1] => 2 // and here
        [2] => 0
        [score2] => 0
    ) 
```

如果您只想查看`userid`密钥，那么您不能只使用`in_array()`，而必须这样做：

```
<?php
function array_search_value($needle,$haystack) {
foreach($haystack as $key => $value) {
    if($value['userid'] === $needle) return $key;
}
return null; // not found
  }

if (array_search_value(2, $r) === null) { /* doesn't happen */ } 
```

# authentication - 使用 Shibboleth 进行 Desire2Learn 价认证

> ID：10820809
> 
> 赞同：2
> 
> 时间：2012-05-30T16:57:33.700
> 
> 标签：authentication, shibboleth, desire2learn

我的团队开始使用 Desire2Learn Valence，而我们的 Shibboleth 身份验证似乎正在破坏初始 API 密钥身份验证过程。

我们有我们的 App ID 和密钥，但 Valence 身份验证表单将我们发送到 Shib 登录（不是我们的直接登录，就像“湖谷大学”示例那样），它永远不会返回 Valence 来完成该过程.

关于如何配置或更改它以使其正常工作的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T19:13:09.567

Valence 身份验证基于深度链接（最终，Valence 身份验证页面将用户引导回应用程序并附加一些关键信息）。

因此，LMS 的身份验证系统必须配置为进行深度链接，这对于某些系统来说有时是不正确的。此外，还需要特定版本的 shibboleth 身份验证系统来支持该深度链接。

Valence 身份验证流程遵循部署团队（或站点管理员）在 DOME 中为`Tools.Login.OrgLoginPath`和提供的链接`Tools.Login.OrgMobileLoginPath`。这就是为什么您要转到 Shib 页面而不是内置页面的原因。一些 Shibboleth 客户创建一个门户页面，为用户提供提示并选择要针对哪个系统进行身份验证。过程中的所有页面都必须将深层链接 url 作为`?target=`查询参数传递。

由于它没有返回应用程序，这表明它需要 Shib 产品 (IPAS) 的更新版本。我会为此项目打开一个帮助台票证，并提及您这样做是为了将其与 Desire2Learn Valence 身份验证一起使用。

# javascript - 验证具有多个值的输入字段的开头

> ID：10820810
> 
> 赞同：0
> 
> 时间：2012-05-30T16:57:35.893
> 
> 标签：javascript, jquery, regex

我有一个用户经常出错的登录表单。我们正在努力更好地通知用户，但我们也希望在他们在输入字段中输入时提示他们正确的方向。

所有 ID 都是 10 个字符，它们以 4 种不同方式之一开始：

*   A00
*   B00
*   点击率
*   VST

如果用户不从这 4 个选项之一开始，我想提示他们，可能是通过触发隐藏元素来显示自己，提醒他们用户名的样子。

我能弄清楚的大部分 jQuery，唯一我不知道的部分是实际匹配。我不太确定如何编写 RegEx 以使其工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T17:03:24.663

这将匹配正确的字符串

`^((A00)|(B00)|(CTR)|(VST)).*$`

在 JavaScript 中

`if (txt.search(/^((A00)|(B00)|(CTR)|(VST)).*$/) !== -1) {...}`

# php - 将更新表单复选框数组设置为 0 而不是 NULL

> ID：10820814
> 
> 赞同：2
> 
> 时间：2012-05-30T16:57:50.793
> 
> 标签：php, mysql, arrays, checkbox

我有一个从数据库动态填充的更新表单，我的表单中有两个复选框可以发布到一个数组，因此我可以点击一个提交按钮并使用 foreach 语句更新所有行。文本字段按应有的方式工作，但是当复选框字段发布到它们的数组时，它们会忽略零，我的数组会变短。

如何在空复选框的位置添加 0？

这是我的表格

```
 <form action="<?php echo $editFormAction; ?>" method="post" name="form1" id="form1">

<input type="hidden" name="ss_id[]" value="<?php echo $row_rsSnapshot['ss_id']; ?>" />
<input type="hidden" name="ss_yearmonth[]" value="<?php echo htmlentities($row_rsSnapshot['ss_yearmonth'], ENT_COMPAT, 'UTF-8'); ?>" />
<tr>
  <td>
  <input <?php if (!(strcmp($row_rsSnapshot['ss_inventory'],1))) {echo "checked=\"checked\"";} ?> type="checkbox"  name="ss_inventory[]" value=""  <?php if (!(strcmp(htmlentities($row_rsSnapshot['ss_inventory'], ENT_COMPAT, 'UTF-8'),""))) {echo "checked=\"checked\"";} ?> />

  </td>
  <td>

  <input <?php if (!(strcmp($row_rsSnapshot['ss_write_off'],1))) {echo "checked=\"checked\"";} ?> type="checkbox"  name="ss_write_off[]" value=""  <?php if (!(strcmp(htmlentities($row_rsSnapshot['ss_write_off'], ENT_COMPAT, 'UTF-8'),""))) {echo "checked=\"checked\"";} ?>

  </td>
  <td> 
  <input type="text" name="ss_date[]" value="<?php echo htmlentities($row_rsSnapshot['ss_date'], ENT_COMPAT, 'UTF-8'); ?>" size="32" />
  </td>
  <td>
  <input type="text" name="ss_transaction[]" value="<?php echo htmlentities($row_rsSnapshot['ss_transaction'], ENT_COMPAT, 'UTF-8'); ?>" size="32" />
  </td>... 
```

这是我的 sql 更新查询

```
 foreach($_POST['ss_id'] as $key=>$ss_id){

    $ss_inventory = GetSQLValueString(isset($_POST['ss_inventory'][$key]) ? "true" : "", "defined","1","0");
    $ss_write_off = GetSQLValueString(isset($_POST['ss_write_off'][$key]) ? "true" : "", "defined","1","0");
    $ss_date = $_POST['ss_date'][$key];
    $ss_transaction = $_POST['ss_transaction'][$key];
    $ss_debit = $_POST['ss_debit'][$key];
    $ss_credit = $_POST['ss_credit'][$key];
    $ss_yearmonth = $_POST['ss_yearmonth'][$key];

$sql = "UPDATE snapshot SET ss_inventory = '$ss_inventory', ss_write_off = '$ss_write_off', ss_date = '$ss_date', ss_transaction = '$ss_transaction', ss_debit = '$ss_debit', ss_credit = '$ss_credit' , ss_yearmonth = '$ss_yearmonth' WHERE ss_id = '$ss_id' ";

 mysql_select_db($database_connMyayla, $connMyayla);
 $Result1 = mysql_query($sql, $connMyayla) or die(mysql_error());

}

  }
 mysql_close();
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T18:06:10.220

这解决了它

如果有人有兴趣...

我放了一个计数器来找出这个查询填充了多少行并将其插入到我的复选框名称数组中......

```
$i = 0;

 do { 

...

      <td>
      <input <?php if (!(strcmp($row_rsSnapshot['ss_inventory'],1))) {echo "checked=\"checked\"";} ?> type="checkbox"  name="ss_inventory[<?php echo $i;?>]" value=""  <?php if (in_array($i, $ss_inventory)) echo "checked='checked'"; ?> />
      </td>

      <td>
       <input <?php if (!(strcmp($row_rsSnapshot['ss_write_off'],1))) {echo "checked=\"checked\"";} ?> type="checkbox"  name="ss_write_off[<?php echo $i;?>]" value=""  <?php if (in_array($i, $ss_write_off)) echo "checked='checked'"; ?> />
      </td>

....    
$i++;

    } while ($row_rsSnapshot = mysql_fetch_assoc($rsSnapshot)); 
```

现在选中的复选框将与正确的数组编号相对应。

例如

假设您有 4 行数据，但您只选中第 2 行和第 4 行的复选框。

```
//run this to see your result

print_r($_POST['ss_inventory']);

//outputs:  Array ([1] => [3] =>) 
```

在这是我的输出之前，所有内容都被推到了我的数组的开头，因为没有提交错误的复选框或为 NULL。所以第 1 行和第 2 行结果为真。

```
//outputs:  Array ([0] => [1] =>) 
```

另请参阅 [复选框“已检查”-当数组为空时，值会跳转到较早的数组值](https://stackoverflow.com/questions/6438958/checkbox-checked-value-jumps-up-to-earlier-array-values-when-array-is-empty)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T17:01:13.417

浏览器不会提交未选中的复选框。您需要提供唯一的名称，或者只需使用单选按钮。

# android - Android--SQL Server 连接错误

> ID：10820816
> 
> 赞同：0
> 
> 时间：2012-05-30T16:57:51.323
> 
> 标签：android, sql-server, wcf

我是 android 的新手，但现在在 Android 上做了更多的编码。现在我有一个疑问。我使用 Android 和 SQL Lte 创建了 android 数据库应用程序。但 SQL Lite 是客户端站点数据库。但现在我的要求是，我想要一个像 SQL Server 这样的数据库，以便将我的应用程序连接到 SQL Server。所以假设，考虑和举例，我知道 WCF。我创建了一个 WCF 服务，其功能类似于：我在 IIS 上托管 WCF，因为 android 不响应 localhost，所以我在 IIS 上托管 WCF

```
Public string check(string username,string password)

{

 SQLConnection con=new SQLConnection("Data Source=.;Database=test;Integrated Security=true");

 SQLDataAdapeter ad=new SQLDataAdapter("select * from table where usrename='"+username+"'and password='"+password+"'");

 Dataset ds=new Dataset();

 ad.fill(ds,"table");

if(ds.Tables[0].Rows.Count>0)
 {
  return "true";
 }
else
{
 return "false";
}

} 
```

我在本地主机中托管了 WCF，以便我可以在我的 Android 应用程序编码中使用此服务。

就像：

```
HttpGet httpGet=new HttpGet("http://192.168.1.111:8083/Service1.svc/checkLogin?username="+UserName+"&password="+Password);

        //Get the response
        HttpResponse httpResponse = httpClient.execute(httpGet);
        HttpEntity httpEntity = httpResponse.getEntity();
        InputStream stream=httpEntity.getContent(); 
```

但是，尽管代码正确，但在这里我没有得到任何 httpEntity。我采用这个实体并希望使用以下函数将其转换为字符串：

```
public static String convertStreamToString(InputStream is)
{
    BufferedReader reader = new BufferedReader(new InputStreamReader(is));
    StringBuilder sb = new StringBuilder();

    String line = null;
    try {
        while ((line = reader.readLine()) != null) {
            sb.append(line + "\n");
        }
    }
    catch (IOException e) {
        e.printStackTrace();
    }
    finally {
        try {
            is.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
    return sb.toString();
} 
```

但是，它不返回任何字符串值，调试器继续捕获点。那么我该怎么做才能从我的 WCF 中获得字符串格式的结果呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T01:00:28.560

基于上面的代码，我不确定你如何看待移动客户端应用程序、WCF 和 SQL Server。基本设计是 WCF 服务将在内部与 SQL Azure 对话并为您收集数据。您的移动客户端将仅以公开的方法连接到 WCF 服务，该方法会将数据传递给移动客户端。我在上述描述或代码片段中没有看到该架构。

我建议您使用 oData WCF 数据服务将任何移动应用程序连接到 SQL Server。OData 服务是连接本地 SQL Server 或基于云的 RDBMS（即 SQL Azure）的快捷方式。

本文[介绍](http://anindita9.wordpress.com/2012/01/02/consuming-sql-serversql-azure-data-in-windows-phone-7-1-android-through-odata-wcf-data-services-entity-frameworks/)了如何逐步进行操作，因此我建议您尝试一下，如果您遇到任何问题，请发帖到 SO，我们一定会帮助您：

大多数 Android 开发人员实际上更喜欢使用 JSON 的 WCF 从 Android 连接到 SQL Server/Azure，因此您当然也可以在[这里查看](http://guruparan.blog.com/2012/03/30/connecting-android-to-sql-server-via-wcf-using-json-part-1/)。

# jakarta-ee - 检索具有另一个实体的外键的实体列表的查询

> ID：10820818
> 
> 赞同：0
> 
> 时间：2012-05-30T16:57:53.543
> 
> 标签：jakarta-ee, persistence

我正在创建一个简单的 Java EE Web 应用程序。

在其他实体中，我有 User 实体，它拥有一些 Unit 对象。实体类构建正确，用户与单元对象具有一对多的关系。我想检索一个包含登录用户所有单位的列表。

因此在单元EJB中我必须有以下方法

```
public List<Unit> findUnitsByOwner(User user) 
```

我对持久性 api 非常不熟悉，我无法创建一个查询来检索属于某个用户的单元。

有人可以帮忙解决方法体吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T17:00:49.973

那么查询很简单：

```
select unit from User user inner join user.units unit 
```

但你也可以做的更容易

```
return user.getUnits(); 
```

# javascript - 为什么将 jQuery UI 日期选择器的默认值设置为匿名函数不起作用？

> ID：10820822
> 
> 赞同：1
> 
> 时间：2012-05-30T16:58:12.440
> 
> 标签：javascript, jquery, jquery-ui, datepicker, anonymous-function

我真的很好奇为什么这段代码将 defaultDate 设置为从今天起 25 年前的日期可以正常工作......

```
$('div.recipient_modal input[name="birth_date"]:first').datepicker({
    changeMonth: true,
    changeYear: true,
    defaultDate: get_recipient_default_birth_date(),
    yearRange: 'c-125:' + new Date().getFullYear()
});

function get_recipient_default_birth_date()
{
    var d = new Date();
    var y = d.getFullYear() - 25;
    d.setFullYear(y);
    return $.datepicker.formatDate('mm/dd/yy', d);
} 
```

但是，当我尝试使用匿名函数而不是调用具有相同代码的命名函数，从今天开始将默认日期设置为 25 年前，如下所示......

```
 $('div.recipient_modal input[name="birth_date"]:first').datepicker({
    changeMonth: true,
    changeYear: true,
    defaultDate: function() {
        var d = new Date();
        var y = d.getFullYear() - 25;
        d.setFullYear(y);
        return $.datepicker.formatDate('mm/dd/yy', d);
    },
    yearRange: 'c-125:' + new Date().getFullYear(),
}); 
```

我在控制台中收到以下错误...

```
Uncaught TypeError: Object function () {
        var d = new Date();
        var y = d.getFullYear() - 25;
        d.setFullYear(y);
        return $.datepicker.formatDate('mm/dd/yy', d);
    } has no method 'getTime' 
```

谁能解释这两个分配的区别以及为什么匿名函数不起作用但命名函数起作用？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T17:01:43.957

不同之处在于，在您的第一个示例中，您实际上是在*调用*函数，因此`datepicker`获取函数返回的*日期值*，而不是函数本身：

```
get_recipient_default_birth_date() 
```

在第二个中，您正在传递一个函数对象。该选项不支持函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-30T17:01:41.860

您已经描述了它为什么不起作用：您将*匿名函数*设置为值。

不是匿名函数的返回值。

在您的第一个工作示例中，您正在调用返回默认值的函数。在您的第二个示例中，您只是定义了一个匿名函数并将其直接分配为值 - 而无需调用它。

如果您想使用这样的匿名函数，则需要实际调用它，如下所示：

```
defaultValue: (function() { /* stuff */; return something; })() 
```

# sql-server-2008 - T-SQL 变更数据捕获日志清理

> ID：10820827
> 
> 赞同：3
> 
> 时间：2012-05-30T16:58:18.363
> 
> 标签：sql-server-2008, tsql

我在我的 SQL Server 2008 数据库中的几个表上启用了 CDC。我想更改可以保留更改历史记录的天数。

我已阅读默认更改日志保留 3 天，然后由 sys.sp_cdc_cleanup_change_table 存储过程删除。

有谁知道我可以如何更改此默认值，以便我可以将日志保留更长时间。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T17:25:03.517

您需要更新数据库的 cdc_jobs.retention 字段。在至少为 CDC 启用一个表之前，cdc_jobs 表中的记录将不存在。

```
-- modify msdb.dbo.cdc_jobs.retention value (in minutes) to be the length of time to keep change-tracked data
update
    j
set
    [retention] = 3679200 -- 7 years
from
    sys.databases d
inner join
    msdb.dbo.cdc_jobs j
        on j.database_id = d.database_id
        and j.job_type = 'cleanup'
        and d.name = '<Database Name, sysname, DatabaseName>'; 
```

替换`<Database Name, sysname, DatabaseName>`为您的数据库名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-01T10:47:47.103

两种替代解决方案：

1.  放弃清理工作：

    ```
    EXEC sys.sp_cdc_drop_job @job_type = N'cleanup'; 
    ```

2.  通过 sp 更改作业：

    ```
    EXEC sys.sp_cdc_change_job 
    @job_type = N'cleanup',
    @retention = 2880; 
    ```

保留时间以分钟为单位，最长 52494800（100 年）。但是，如果你放弃这份工作，数据永远不会被清理，即使有数据需要清理，这份工作甚至也不会查找。如果想无限期地保留数据，我宁愿放弃这份工作。

# android - 无法将 EditText 值转换为双精度/整数并在 Android 中执行数学函数

> ID：10820829
> 
> 赞同：2
> 
> 时间：2012-05-30T16:58:36.970
> 
> 标签：android, string, android-edittext, double

首先，我是这方面的初学者......所以如果我正在做的事情很容易修复（或一般来说），我很抱歉:)

我正在尝试采用用户输入（圈数 [int]、使用的燃料 [double] 和功能圈数 [int]）为赛车手创建一个简单的燃料计算器。但是，我无法识别变量。我不断收到关于我无法在某个类中使用一个函数之类的错误。我已经将 XML 字段分配为只接受这些类型的数字，所以现在我正在严格使用 java.util.xml 字段。

我在 java 编译器中工作的东西，但把它带到 Android 是我正在学习的另一个过程。

从用户输入计算后，我希望分配的 textView 更改为正确的答案。我认为这部分没问题，但是将值设为数学上可行的值是我遇到问题的地方。

我在这里附上了整个代码（请原谅注释的冗余，让我不会来回查看公式哈哈）。您可以提供的任何帮助将不胜感激！我会尽我最大的努力学习这个应用程序中其他与数学相关的活动。

* * *

```
 package com.tomcat.carolina.learning;

    import android.app.Activity;
    import android.os.Bundle;
    import android.view.View;
    import android.view.View.OnClickListener;
    import android.widget.Button;
    import android.widget.EditText;
    import android.widget.RadioGroup;
    import android.widget.TextView;

    //double pracLaps, fuelUsed, featureLaps, textLPGValue, textFuelNeededValue;

    public class Fuelsimple extends Activity implements OnClickListener{

EditText fuelUsed, pracLaps, featureLaps;
TextView textLPGValue, textFuelNeededValue;
//efficiency = (pracLaps / fuelUsed);
//fuelNeeded = (featureLaps / efficiency);

@Override
protected void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.fuelsimple);

pracLaps = (EditText) findViewById(R.id.pracLaps);
fuelUsed = (EditText) findViewById(R.id.fuelUsed);
featureLaps = (EditText) findViewById(R.id.featureLaps);
Button gen = (Button) findViewById(R.id.submit);
textLPGValue = (TextView) findViewById(R.id.textLPGvalue);
textFuelNeededValue = (TextView) findViewById(R.id.textFuelNeededValue);

gen.setOnClickListener(new View.OnClickListener() {     
    public void onClick(View v) {
        // TODO Auto-generated method stub

        textLPGValue.setText(getNextDecimal(pracLaps / fuelUsed));
        textFuelNeededValue.setText(getNextDecimal(featureLaps/(pracLaps / fuelUsed)));
    };
    }); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T17:09:24.990

我希望这是您正在寻找的：

```
pracLaps = (EditText) findViewById(R.id.pracLaps);
fuelUsed = (EditText) findViewById(R.id.fuelUsed);
featureLaps = (EditText) findViewById(R.id.featureLaps);

pracLapsVar = Double.parseDouble(pracLaps.getText().toString());
fuelUserVar = Double.parseDouble(fuelUsed.getText().toString());
featureLapsVar = Double.parseDouble(featureLaps.getText().toString());

efficiency = (pracLapsVar / fuelUsedVar);
fuelNeeded = (featureLapsVar / efficiency); 
```

# c# - 如何实现自定义控件的可访问性？

> ID：10820830
> 
> 赞同：2
> 
> 时间：2012-05-30T16:58:53.450
> 
> 标签：c#, .net, windows, winapi, accessibility

我的主窗口中有一个自定义呈现的控件，其中包含一些文本。它不支持 MS Active Accessibility。我有文本的位置和文本作为字符串。如何实现它的标准可访问性，以便我可以使其对屏幕阅读器可读？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T17:06:58.487

我会看看实现[IAccessible](http://msdn.microsoft.com/en-us/library/accessibility.iaccessible.aspx)接口

# c# - 在mongodb上汇总大量数据

> ID：10820835
> 
> 赞同：1
> 
> 时间：2012-05-30T16:59:11.890
> 
> 标签：c#, mongodb, database

我正在寻找对 mongodb 执行求和查询的最有效方法。

目前，我们插入包含各种信息和文档创建日期时间戳的文档。

我们需要对这些数据求和以通过以下方式查看：

一天中每小时的文件 1-24 一个月中的一天的文件 1-28/31 一年中的一个月的文件 1-12 一年中的文件

这些汇总的数据将经常被访问，因为我们担心在 mongo 中抛出的大量数据会经常对这些数据进行汇总。

我们可能认为，当一个文档被插入到 mongo 中时，我们有另一个包含这些计数的文档，这些计数在插入时会增加。这样，我们可以快速提取计数，而无需对每个请求的数据求和。我们担心的是，这可能不是在 mongo 中执行此类操作的最有效方式

关于实现这一目标的最佳方法的任何想法？我的开发团队和我自己都是 mongodb 的新手，我们希望确保我们不会因为汇总大量数据而陷入性能陷阱。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T11:09:33.850

[聚合框架](http://www.mongodb.org/display/DOCS/Aggregation)非常适合这种类型的查询。
我在下面为你做了一些例子。

首先，让我们填充一些文档：

> db.myDocumentCollection.insert({"date" : new Date('01/01/2012'), "topic" : "My Title 1"}); db.myDocumentCollection.insert({"date" : new Date('01/02/2012'), "topic" : "My Title 2"}); db.myDocumentCollection.insert({"date" : new Date('01/02/2012'), "topic" : "My Title 3"}); db.myDocumentCollection.insert({"date" : new Date('01/02/2012'), "topic" : "My Title 4"}); db.myDocumentCollection.insert({"date" : new Date('01/04/2012'), "topic" : "My Title 5"}); db.myDocumentCollection.insert({"date" : new Date('01/05/2012'), "topic" : "My Title 6"}); db.myDocumentCollection.insert({"date" : new Date(' 01/07/2013'), "主题" : "我的标题 7"}); db.myDocumentCollection.insert({"date" : new Date('01/07/2013'), "topic" : "My Title 8"}); db.myDocumentCollection.insert({"date" : new Date('02/07/2013'), "topic" : "My Title 9"}); db.myDocumentCollection.insert({"date" : new Date('02/08/2013'), "topic" : "My Title 10"});

**返回按完整日期分组的文档数量**

```
db.myDocumentCollection.group(
{
   $keyf : function(doc) {
       return { "date" : doc.date.getDate()+"/"+doc.date.getMonth()+"/"+doc.date.getFullYear() };
    },
    initial: {count:0},
    reduce: function(obj, prev) { prev.count++; }
 }) 
```

**输出**

```
[
        {
                "date" : "1/0/2012",
                "count" : 1
        },
        {
                "date" : "2/0/2012",
                "count" : 3
        },
        {
                "date" : "4/0/2012",
                "count" : 1
        },
        {
                "date" : "5/0/2012",
                "count" : 1
        },
        {
                "date" : "7/0/2013",
                "count" : 2
        },
        {
                "date" : "7/1/2013",
                "count" : 1
        },
        {
                "date" : "8/1/2013",
                "count" : 1
        }
] 
```

**返回 2013 年按日期分组的文档数量**

这可能与您想要执行的查询类型更相关。
在这里，我们使用`cond`来指定仅对 2013 年 1 月 1 日之后的文档进行分组。
您可以在此处使用`$gte`and`$lte`来执行日期范围。

```
db.myDocumentCollection.group(
{
   $keyf : function(doc) {
       return { "date" : doc.date.getDate()+"/"+doc.date.getMonth()};
    },
    cond: {"date" : {"$gte": new Date('01/01/2013')}},
    initial: {count:0},
    reduce: function(obj, prev) { prev.count++; }
 }) 
```

**输出**

```
[
        {
                "date" : "7/0",
                "count" : 2
        },
        {
                "date" : "7/1",
                "count" : 1
        },
        {
                "date" : "8/1",
                "count" : 1
        }
] 
```

# assembly - 操作码中的汇编段

> ID：10820836
> 
> 赞同：11
> 
> 时间：2012-05-30T16:59:13.200
> 
> 标签：assembly, x86, masm, addressing-mode, memory-segmentation

我注意到在程序集段中使用了操作码。

例子：

```
MOV DWORD PTR SS:[EBP-30],30 
```

我认为“PTR SS：”用于指定 EBP-30 来自堆栈？（SS：堆栈段）我是对的还是完全错的？:) 而且，你能告诉我上面的例子和

```
MOV DWORD PTR[EBP-30],30 
```

那么操作码中使用的 DS（数据段）呢？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-31T17:04:19.517

```
MOV DWORD PTR SS:[EBP-30],30 
```

这里有两个单独的修饰符，`DWORD PTR`和`SS:`.

第一个告诉我们要在指向的地址存储一个单词。当汇编器无法从指令的操作数中分辨出这一点时，这是需要的。这里`30`也可以是一个要存储的字节。

是`SS:`段前缀，表示我们要使用相对于栈段的地址。在这种情况下，它不是严格需要的，因为这是使用`ESP`or`EBP`寄存器时的默认设置。所以该指令的第二个版本与第一个版本相同。

如果你使用`EBX`而不是`EBP`会有不同！

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-05-30T19:01:48.183

*   SS 是堆栈段
*   DS 是数据段
*   PTR - 指针。这是一个地址。

当你这样做

```
mov ax, some_variable 
```

你真的是在替换这个表格“ `mov ax, ds:[pointer_to_variable]`”

在 SS 的情况下，您不是从 DS 访问值，而是从堆栈访问值 :)。将段寄存器视为银行。数据来自 DS，Stack 数据来自 SS，Code 数据来自 CS，Extra 段为 ES。

# android - 在 ACTION_PICK 完成之前调用 onActivityResult

> ID：10820838
> 
> 赞同：1
> 
> 时间：2012-05-30T16:59:16.090
> 
> 标签：android, android-activity, android-gallery, android-photos

我在从我的图库中选择图像并在我的应用程序中使用它时遇到了一些问题。我使用这个意图：

```
Intent i = new Intent(Intent.ACTION_PICK, android.provider.MediaStore.Images.Media.EXTERNAL_CONTENT_URI);
startActivityForResult(i, ACTIVITY_SELECT_PHOTO); 
```

这把我带到了画廊，在那里我可以挑选一张图片。但是当我选择一个时，`onActivityResult`会立即调用，而 ACTION_PICK 还没有完成所有事情。嗯，我想这就是问题所在。我已经读过我应该尝试将清单中的活动更改为`launchMode`，`singleTop`但这没有用。或者我应该改变`launchMode`“ACTION_PICK”活动的？这甚至可能吗？

```
final static int ACTIVITY_SELECT_PHOTO = 0;
final static int ACTIVITY_CAMERA_PHOTO = 1;

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent imageReturnedIntent) { 
    super.onActivityResult(requestCode, resultCode, imageReturnedIntent); 
    Log.d("onActivityresult", "req = " + requestCode + ", result = " + resultCode);
    switch(requestCode) { 
    case ACTIVITY_SELECT_PHOTO:
        if(resultCode == RESULT_OK){  

            Uri selectedImageUri=imageReturnedIntent.getData();
            String actualPath=getRealPathFromURI(selectedImageUri);
            File file=new File(actualPath);
            Bitmap b=decodeFile(file); //this is new bitmap which you can use for your purpose 

            try {
                ByteArrayOutputStream os = new ByteArrayOutputStream();
                b.compress(Bitmap.CompressFormat.PNG, 55, os);
                compressedByteArray = os.toByteArray();
                iv.setImageBitmap(b);
                currentUser.put("picture", compressedByteArray);
                Toast t = Toast.makeText(this, "Uploading picture...", Toast.LENGTH_LONG);
                t.show();
                currentUser.save();
            } catch (ParseException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
    case ACTIVITY_CAMERA_PHOTO:
        if(resultCode == RESULT_OK){

            Bundle extras = imageReturnedIntent.getExtras();

            //THE LINE BELOW THIS ONE GIVES NULLPOINTEREX WHICH IS OBVIOUS BECAUSE IT's ANOTHER //CASE      
            Bitmap bmp = (Bitmap)extras.get("data");
            ByteArrayOutputStream os = new ByteArrayOutputStream();
            bmp.compress(Bitmap.CompressFormat.PNG, 55, os);
            compressedByteArray = os.toByteArray();
            bmp = BitmapFactory.decodeByteArray(compressedByteArray, 0, compressedByteArray.length);
            iv.setImageBitmap(bmp);
            currentUser.put("picture", compressedByteArray);

        }
        try {
            Toast t = Toast.makeText(this, "Uploading picture...", Toast.LENGTH_LONG);
            t.show();
            currentUser.save();
        } catch (ParseException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    } 
```

ResultCode = -1 （所以 RESULT_OK）但它给了我一个错误：

```
java.lang.RuntimeException: Failure delivering result ResultInfo{who=null, request=0, result=-1, data=Intent { dat=content://media/external/images/media/173 }} to activity {com.tapazz/com.tapazz.ShowProfileActivity}: java.lang.NullPointerException 
```

nullPointerException 来自不同的 RequestCode（参见上面的“这条线”）

该应用程序停止，但是当我重新启动它时，我看到它已经像它应该做的那样选择了照片

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T17:07:39.657

这可能相关，也可能不相关，但您的`switch()`陈述`break`在每个案例之后都没有。因此，如果它进入`ACTIVITY_SELECT_PHOTO`案例，它也会`ACTIVITY_CAMERA_PHOTO`处理

```
switch() {
   case 1:
      break;

   case 2:
      break;
} 
```

请注意，您总是需要`break;`在每个`case`.

# asp.net-mvc - 如何指定要在下拉列表中显示的列？

> ID：10820840
> 
> 赞同：0
> 
> 时间：2012-05-30T16:59:17.483
> 
> 标签：asp.net-mvc

我有一个带有计算列的数据库表。计算列将两个名称（名字和姓氏）合并为一个显示名称。在下面的代码中，我想指定名为 DisplayName 的计算列的值。我该怎么做呢？谢谢！

仅供参考，这是 MVC Beta 4。

```
<div class="editor-label">
    @Html.LabelFor(model => model.PdId, "Pd")
</div>
<div class="editor-field">
    @Html.DropDownList("PdId", String.Empty)
    @Html.ValidationMessageFor(model => model.PdId)
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T17:31:17.837

使用视图模型和强类型视图和 DropDownListFor 助手。看不到您的代码，所以这是一个未经测试的伪代码：

```
public class MyViewModel
{
    public int PdId { get; set; }
    public IEnumerable<SelectListItem> Names { get; set; } 
} 
```

从控制器填充视图模型

```
public ActionResult VIewName(?)
{
    var people =  // query    
    var model = new MyViewModel
    {
       PdId = people.nameId,
       FullNames = people.Select(x => new SelectListItem
        {
             Value = x.nameId.ToString(),
             Text = x.FirstName + " " + x.LastName
        })
    };
    return View(model);
} 
```

在视图中使用强类型的 DropDownListFor 助手

```
@model MyViewModel

@Html.DropDownListFor(
    x => x. PdId,
    Model. FullNames
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T17:03:20.383

```
<div class="editor-label">
    @Html.LabelFor(model => model.PdId, "Pd")
</div>
<div class="editor-field">
    @Html.DropDownListFor(model => model.PdId, Model.DisplayName)
    @Html.ValidationMessageFor(model => model.PdId)
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T17:03:45.817

只要该列是实际字段，当您在 DDL 中使用 DISTINCT 执行 SELECT 时连接到数据库时，它应该是一个选项。

如果它是一个别名列，并且正在使用计算列进行引用，那么只需在 C# 端的 select 语句中引用计算列...

# php - 谁能说出我在这个正则表达式中的错误是什么

> ID：10820842
> 
> 赞同：2
> 
> 时间：2012-05-30T16:59:30.843
> 
> 标签：php, validation, url, preg-match

我想使用这个正则表达式在 php 中使用 preg_match 函数验证我的 url，但是当我使用它时，它显示“未知修饰符'&'”有什么问题？

```
$urlregex = "/^(http|ftp|https)\:\/\/";

        // USER AND PASS (optional)
        $urlregex .= "([a-z0-9+!*(),;?&=\$_.-]+(\:[a-z0-9+!*(),;?&=\$_.-]+)?@)?";

        // HOSTNAME OR IP
        $urlregex .= "[a-z0-9+\$_-]+(\.[a-z0-9+\$_-]+)+"; // http://x.x = minimum

        // PORT (optional)
        $urlregex .= "(\:[0-9]{2,5})?";
        // PATH (optional)
        $urlregex .= "(\/([a-z0-9+\$_-]\.?)+)*\/?";
        // GET Query (optional)
        $urlregex .= "(\?[a-z+&\$_.-][a-z0-9;:@/&%=+\$_.-]*)?";
        // ANCHOR (optional)
        $urlregex .= "(#[a-z_.-][a-z0-9+\$_.-]*)?\$/";
        if(preg_match($urlregex, $url) === 1)
        {
            $errors[] = "URL_ISNOTVALID";
            $ok =  false;
        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T17:00:41.867

看起来您忘记转义正斜杠：

```
$urlregex .= "(\?[a-z+&\$_.-][a-z0-9;:@/&%=+\$_.-]*)?"; 
```

应该

```
$urlregex .= "(\?[a-z+&\$_.-][a-z0-9;:@\/&%=+\$_.-]*)?"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T17:03:12.537

GET 查询中的 /（斜杠）被视为正则表达式的终止。而不是在 ANCHOR 行中添加的正则表达式末尾的 / 。

所以你需要在 & 前面转义 /。

```
 $urlregex .= "(\?[a-z+&\$_.-][a-z0-9;:@/&%=+\$_.-]*)?"; 
```

过得去

```
 $urlregex .= "(\?[a-z+&\$_.-][a-z0-9;:@\/&%=+\$_.-]*)?"; 
```

就这样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T17:04:34.767

你可以通过使用来节省一些麻烦`filter_var`。

```
if (false !== ($url = filter_var($url, FILTER_VALIDATE_URL))) {
    echo "$url is a valid url";
} 
```

您可以选择将这些选项添加为第三个参数（使用二进制或组合它们）：

*   `FILTER_FLAG_PATH_REQUIRED`
*   `FILTER_FLAG_QUERY_REQUIRED`

# objective-c - 使用 YouTube JSON 中的 SDWebImage 调整从 URL 下载的图像的大小 已编辑

> ID：10820847
> 
> 赞同：1
> 
> 时间：2012-05-30T16:59:59.923
> 
> 标签：objective-c, ios5

我正在使用 SDWebImage 从 youtube JSON Web 服务下载缩略图，以便将它们设置在表格视图单元格中。问题是下载图像是 120x90，对我的需要来说太大了，因为我想把它放在 75x75 的 UIImageView 中。虽然图像缓存在占位符中，但它们看起来是正确的，但是一旦缓存完成，它们就会以 120x90 的比例大小显示。我尝试了setContentMode:UIViewContentModeScaleToFill，但它不起作用，所以我不知道如何解决这个问题。

```
NSString *path= [thumbnail valueForKey:@"sqDefault"];

        [cell.imageView setImageWithURL:[NSURL URLWithString:path] placeholderImage:[UIImage imageNamed:@"placeholder.png"]];

        [cell.imageView setContentMode:UIViewContentModeScaleToFill];

        CALayer * l = [cell.imageView layer];

        [l setMasksToBounds:YES];

        [l setCornerRadius:5.0]; 
```

非常感谢

编辑：

我在自定义单元格扩展类中设置了内容模式：

```
newsCell.m

- (id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier
{
    self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];
    if (self) {
        [self.Image   setContentMode:UIViewContentModeScaleToFill];

    }

    return self;
} 
```

这是单元格创建代码：

多媒体.m

```
 newsCell *cell = [self.tableView 
                          dequeueReusableCellWithIdentifier:@"news"];

        if (cell == nil) {
            cell = [[newsCell alloc] initWithStyle:UITableViewCellSelectionStyleNone reuseIdentifier:@"news"];
        } 
```

问题是 if (cell == nil) 永远不会被调用，因为第一个语句正在创建单元格，所以不会调用 initWithStyle 并且没有设置内容模式，但是如果我删除第一个语句，则不会创建单元格。我不知道如何管理它。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T17:05:47.533

尝试这两个选项，看看哪个更适合您的需求：

```
UIViewContentModeScaleAspectFit
UIViewContentModeAspectFill 
```

如果这些不起作用，我猜这是因为 UITableViewCell 正在 UIImageView 上设置 contentMode - 在这种情况下，您应该创建一个 UITableViewCell 的子类，其中包含一个 UIImageView 并设置了正确的 contentMode。然后你可以在你的 UITableView 中使用你自定义的 UITableViewCell 子类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T08:03:21.757

在其自定义单元格类中设置表格图像视图的自定义大小

```
 - (void)layoutSubviews {  
    [super layoutSubviews];  
    self.imageView.frame = CGRectMake(5,5,40,32.5);  
    float limgW =  self.imageView.image.size.width;  
    if(limgW > 0) {  
        self.textLabel.frame = CGRectMake(55,self.textLabel.frame.origin.y,self.textLabel.frame.size.width,self.textLabel.frame.size.height);  
        self.detailTextLabel.frame = CGRectMake(55,self.detailTextLabel.frame.origin.y,self.detailTextLabel.frame.size.width,self.detailTextLabel.frame.size.height);  
    }  
} 
```

有关更多详细信息，[请参阅此链接](http://www.wrichards.com/blog/2011/11/sdwebimage-fixed-width-cell-images/)

# jquery - 使用 Firebug 帮助/提示调试 jQuery

> ID：10820848
> 
> 赞同：-1
> 
> 时间：2012-05-30T17:00:14.740
> 
> 标签：jquery, debugging

总而言之，我正在开发一些 jQuery，我现在正在 Chrome 中做这件事，但我之前也在 Mozilla 中使用过 Firebug。我想学习的是如何进行一些故障排除/调试。例如，我有一些 jQuery，当我点击某些东西时，什么都没有发生，但我期待它。当我在 Chrome 的控制台中时，没有任何内容显示为错误，只是没有任何操作。我想对此进行调试以了解为什么什么都没有发生，但不确定如何正确调试这种情况。任何人都可以提供的任何建议/有用的提示将不胜感激！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T17:36:12.887

转到 chrome 开发工具中的脚本选项卡。如果您有最新的 chrome，请单击左上角的小文件夹图标，然后打开感兴趣的 .js 文件。从那里您可以设置断点和调试等。

[https://developers.google.com/chrome-developer-tools/docs/scripts](https://developers.google.com/chrome-developer-tools/docs/scripts)

# ruby-on-rails-3 - 用于私有存储库的 Travis CI

> ID：10820851
> 
> 赞同：29
> 
> 时间：2012-05-30T17:00:23.107
> 
> 标签：ruby-on-rails-3, travis-ci

有没有办法在我们自己的机器上为私有存储库设置[Travis CI](http://travis-ci.org/)并让它连接到我们自己的 git 服务器？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-20T04:22:53.820

看起来他们正在开发私有存储库支持。它现在处于私人 Beta 测试中。查看此线程[https://groups.google.com/forum/?fromgroups#!topic/travis-ci/Asq30ulew4E](https://groups.google.com/forum/?fromgroups#!topic/travis-ci/Asq30ulew4E)

**更新：** 您还可以查看[https://circleci.com/](https://circleci.com/)以获取私人回购。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-29T10:26:41.723

另一种选择是[gitlab-ci](https://github.com/gitlabhq/gitlab-ci)。这适用于[gitlabhq](https://github.com/gitlabhq/gitlabhq)并且是开源的。

**更新：**

我最近用[GitlabHQ尝试了](https://github.com/gitlabhq/gitlabhq)[Jenkins](http://jenkins-ci.org)。它们也可以很好地共存，但在附加插件的帮助下。[Jenkins](http://jenkins-ci.org)没有开箱即用的 git 支持，但有一个插件可以随时使用。

在 Ubuntu 上安装[Jenkins](http://jenkins-ci.org)非常简单。我猜它在其他平台上一定很容易，因为它是用 Java 编写的，并且可以作为 .war 文件使用。从其 Web 界面配置它也非常容易。

有许多插件可用（包括用于[GitlabHQ](https://github.com/gitlabhq/gitlabhq)、 Github 等的插件）。可以直接从其 Web 界面下载和安装插件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-28T15:59:23.657

Travis 现在有一个私人产品，在撰写本文时的起始价格是每月 129.00 美元，用于无限存储库，同时构建两个。非常容易设置，如果你已经在 GitHub 上，它可以很好地集成：[https ://magnum.travis-ci.com/](https://magnum.travis-ci.com/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-19T21:38:50.687

我想这就是你要找的。我特别喜欢只为构建时间付费。 [http://beta.travis-ci.com/?r=http://about.travis-ci.org/docs/user/travis-pro/](http://beta.travis-ci.com/?r=http://about.travis-ci.org/docs/user/travis-pro/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-10T20:33:45.497

Jenkins 也是一个可能的 CI 工具。cloudbees 提供企业支持。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-03-03T15:55:42.500

Travis CI 现在为私有存储库提供[Travis Pro](https://docs.travis-ci.com/user/travis-pro/)。拥有学生电子邮件地址的用户可以注册[GitHub 的学生开发包](https://education.github.com/)，并[免费获得从私有存储库构建的权限](https://education.travis-ci.com)。

# java - 从 xml JSF/Java 配置 web-app 数据目录

> ID：10820853
> 
> 赞同：1
> 
> 时间：2012-05-30T17:00:29.313
> 
> 标签：java, jsf, app-config

我无法弄清楚如何在我的应用程序上实现这一点。

我想要一个 xml（或某个文件），负责应用程序管理的人员选择 Root_Dir 所在的位置。

现在它是硬编码的，`C:\MyAppRootDir`但我希望管理员可以随时修改这条路径。

有任何想法吗？

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T17:09:13.743

有几种方法可以为 webapp 提供外部配置。

1.  创建一个属性文件并将其放在 webapp 的运行时类路径所涵盖的路径之一中，或者将其路径添加到 webapp 的运行时类路径中。

    例如`/path/to/config.properties`这个内容

    ```
    xmlrootdir=C:\MyAppRootDir 
    ```

    您将能够通过类加载器获取它。

    ```
    Properties properties = new Properties();
    properties.load(Thread.currentThread().getContextClassLoader().getResourceAsStream("config.properties"));
    String xmlrootdir = properties.getProperty("xmlrootdir");
    // ... 
    ```

    根据您的问题历史，您正在使用/定位 Tomcat。管理员可以编辑其`shared.loader`条目`/conf/catalina.properties`以指向此属性文件所在的文件夹。

    ```
    shared.loader=/path/to 
    ```

2.  将 VM 参数添加到 Tomcat 启动脚本。

    ```
    -Dconfig.xmlrootdir=C:\MyAppRootDir 
    ```

    可用如下：

    ```
    String xmlrootdir = System.getProperty("config.xmlrootdir");
    // ... 
    ```

3.  设置环境变量。

    ```
    SET CONFIG_XMLROOTDIR=C:\MyAppRootDir 
    ```

    可用如下：

    ```
    String xmlrootdir = System.getenv("CONFIG_XMLROOTDIR");
    // ... 
    ```

# c++ - C++：如何定义具有泛型返回类型的虚函数？

> ID：10820854
> 
> 赞同：4
> 
> 时间：2012-05-30T17:00:29.607
> 
> 标签：c++, oop

我正在尝试在 C++ 中定义一个基类，该类具有由子类实现的纯虚拟方法。

我想为基类中的基本类型定义 setter 和 getter 函数，但我希望派生类能够确定 getter 和 setter 的基本类型。例如，我的基类如下所示：

```
 class Value
    {
    public:
        Value();
        template <class T>;
        virtual T getValue() = 0;
        virtual void setValue(T val) = 0;
    } 
```

我的孩子班看起来像这样：

```
 class IntValue : public Value
    {
    public:
        IntValue();
        template <class T>
        T getValue() {return _val};
        void setValue(T val) {_val = val};
    private:
        int _val;
    } 
```

当然上面的代码是行不通的。关于如何实现这一目标的任何想法？提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T17:04:04.273

如果我正确理解了您的问题，请将您的代码重写为

```
template <class T>
class Value
{
public:
    Value();
    virtual T getValue() = 0;
    virtual void setValue(T val) = 0;
};

class IntValue : public Value<int>
{
public:
    IntValue();

    int getValue() {return _val;}
    void setValue(int val) {_val = val;}
private:
    int _val;
}; 
```

应该管用

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-30T17:05:37.340

你所要求的是不可能的。为了在`vtbl`（或编译器可能使用的任何类似结构）中生成正确的条目，编译器需要知道在基类中具体需要哪些条目。您不能只在派生类中返回不同的类型，并期望基类以这种方式“了解”它；因为这需要修改基类中函数模板的定义。

[在J_D 的答案](https://stackoverflow.com/a/10820912/82320)中可以看到如何使用*类模板*（而不是*函数模板*）对基类进行这种修改的示例，但这仍然与您的问题描述不完全匹配，因为您不会能够创建一个并多态地对待它。`Value`

C++ 模板本质上是“花哨的查找和替换”类型——当编译器实例化函数模板时，它会生成一个替换类型名的普通函数。请注意，这与 C# 或 Java“泛型”非常不同，它们完全不同，依赖运行时支持和间接层来实现类似的效果。（请注意，虽然这个“查找和替换”尊重优先规则等，不像 C 预处理器宏 :)）

如果你真的也想一想，这种模式是没有意义的。在客户端这会是什么样子？

```
class Value
{
public:
    Value();
    //Imagine if this were possible...
    template <class T>;
    virtual T getValue() = 0;
    virtual void setValue(T val) = 0;
}

class IntValue : public Value
{
public:
    IntValue();
    int getValue() {return _val};
    void setValue(int val) {_val = val};
private:
    int _val;
}

class FloatValue : public Value
{
public:
    FloatValue();
    float getValue() {return _val};
    void setValue(float val) {_val = val};
private:
    float _val;
} 
```

现在，你去使用这个类：

```
void example(Value * ptr)
{
    //What could you possibly say the type of "bar" is? There's no type that works!
    ???? bar = ptr->getValue();
    delete ptr;
}

int main()
{
    example(new IntValue());
    example(new FloatValue());
} 
```

因此，即使允许这样做，也没有多大意义。你总是不得不一直沮丧，这意味着`virtual`关键字无论如何都是没有意义的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T17:08:30.240

扩展@Billy ONeal 关于类模板的内容，这可能适用于您的目的：

```
template<typename Type>
class Value
{
public:
    virtual Type getValue() = 0;
};

class IntValue : public Value<int>
{
public:
    IntValue(int value)
        : m_value(value)
    {
    }

    int getValue()
    {
        return m_value;
    }

private:
    int m_value;
}; 
```

# perl - keybd_event 打印数字而不是字母（perl win32::api）

> ID：10820858
> 
> 赞同：1
> 
> 时间：2012-05-30T17:00:59.803
> 
> 标签：perl, winapi

我想打印“a”。相反，它打印“9”。为什么，以及如何解决这个问题？

```
use Win32::API;

$kbd_event = Win32::API->new(
  "user32.dll", 
  "VOID keybd_event( BYTE bVk, BYTE bScan, DWORD dwFlags, DWORD dwExtraInfo );"
);

$a = 0x61;

$kbd_event->Call( $a, 0, 0, 0 ); # press
$kbd_event->Call( $a, 0, 2, 0 ); # release 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T17:04:46.103

看起来“A”键是 0x41

[http://msdn.microsoft.com/en-us/library/windows/desktop/dd375731%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/dd375731%28v=vs.85%29.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T17:59:19.717

`$kbd_event->Call`期望一个字节作为其第一个参数，但您的参数被视为整数。

尝试

```
$kbd_event->Call( chr($a), 0, 0, 0 );
$kbd_event->Call( chr($a), 0, 2, 0 ); 
```

# .net - 嵌入 WPF 应用程序的诊断/基准测试工具

> ID：10820861
> 
> 赞同：3
> 
> 时间：2012-05-30T17:01:08.810
> 
> 标签：.net, wpf, benchmarking, diagnostics

**我想在我的应用程序中添加一个诊断屏幕，用于**测试 RAM、CPU、WPF 性能等资源并将其与基准进行比较。

我正在寻找一个库或开源项目，它可以轻松获得计算性能（RAM、CPU、GPU 等）的基线，以比较快速机器和慢速机器，目的是确定性能问题的根源。 **我的目标是获得一个高层次的答案，即哪种计算资源可能会导致速度变慢。** 这将有助于将故障排除工作集中在正确的方向上。

我正在想象标准计算机硬件/网络性能基准工具之间的交叉，与[DxDiag](http://en.wikipedia.org/wiki/DxDiag)（用于 DirectX）交叉，它测量渲染弹跳球所需的时间等。

理想的解决方案将用 .net 编写并内置：

*   WPF 渲染/着色速度测试。

*   CPU速度测试

*   网络 (LAN) 速度测试（吞吐量和延迟）

*   内存速度测试

*   显示应用程序使用的内存，以及可用的内存量。

**你推荐什么开源项目或现成的库？**

**附加信息：**

我的应用程序由专业人士使用，主要包含文本信息、一些图标、大量阴影和一些鼠标激活的小动画效果。我的目标是获得一个高层次的答案，即哪种计算资源可能会导致速度变慢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T06:59:03.397

For Vista machines and higher you can access the Windows Experience Index scores. This would give you a high level glance on what could be the bottleneck on a system (CPU, video card, memory, or disk drive).

Each time a test is done it creates a file in %Windows%\Performance\WinSAT\DataStore\

You can simply check for the one with the most recent timestamp and read the values directly. Just read the elements between the tags.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T20:27:18.053

它不是用于嵌入，但您知道[WPF 性能套件](http://msdn.microsoft.com/en-us/library/aa969767.aspx)吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T17:51:04.913

我还没有找到与我正在寻找的东西完全一样的东西，但是，[这篇文章](http://www.japf.fr/2009/10/measure-rendering-time-in-a-wpf-application/)可能会很有用，因为它展示了如何测量渲染一些 WPF 需要多长时间。

# javafx-2 - 在退出时保存 JavaFX 控件的状态

> ID：10820864
> 
> 赞同：3
> 
> 时间：2012-05-30T17:01:20.103
> 
> 标签：javafx-2

我有一堆控制对象（准确地说是文本框），它们在 FXML 加载期间使用 @FXML 注释注入到我的代码中。

当用户通过单击标题栏上的关闭框关闭场景时，我想保存这些控件的状态，特别是文本值。

但是，当我在 OnCloseRequest 处理程序中捕获 CloseRequest 事件时，我发现控制变量的值为 null（原始注入有效，因此这是在加载 FXML 和调用 OnCloseRequest 之间发生的事情）。

谁能解释这种行为和/或建议我如何获得我想要的功能？

TIA

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T08:36:06.637

`onCloseRequest`是

> 当有关闭此窗口的外部请求时调用。...

（来自 Javadoc）。“外部请求”的含义之一是当您通过操作系统本机窗口关闭按钮关闭窗口时。该`closeRequest`事件不是通过编程`stage.close()`或`stage.hide()`调用触发的。所以考虑处理[onHiding](http://docs.oracle.com/javafx/2/api/javafx/stage/Window.html#onHidingProperty)或[onHidden](http://docs.oracle.com/javafx/2/api/javafx/stage/Window.html#onHiddenProperty)事件。

否则发布您的 OnCloseRequest 处理程序代码。

# jetty - 将 cometd 会话与 HTTP 会话配对

> ID：10820866
> 
> 赞同：6
> 
> 时间：2012-05-30T17:01:21.760
> 
> 标签：jetty, cometd

我们有一个使用 Jetty 8.1、dojo 和 cometd 的 Web 应用程序，它使用 (1) 用于同步操作的 JSON/HTTP REST API 和 (2) 用于从服务器接收大量事件的 Cometd API 在浏览器和 Web 容器之间进行交互。

我们不完全清楚的是如何优雅地管理这两个不同 API 的身份验证会话，特别是因为我们的 Cometd 将尽可能使用 websocket 而不是常规 HTTP。该应用程序使用标准 Jetty LDAP 模块使用基于表单的身份验证。因此，从 HTTP 的角度来看，容器为浏览器提供了一个标准的 jsessionid，如下所示：

```
Cookie: jsessionid=758E2FAD7C199D722DA8B5E243E0E27D 
```

根据 Simone Bordet 在[此处](https://groups.google.com/group/cometd-users/browse_thread/thread/61549da04311947d/da68db4164aa79b6?lnk=gst&q=browser%20http%20auth#da68db4164aa79b6)的帖子，似乎推荐的解决方案是在我们正在做的 Cometd 握手期间传递此令牌。

我们遇到的问题是有两个根本不同的会话——HTTP 会话和 Bayeux cometd 会话。由于潜在的内存泄漏和安全问题等原因，我们希望它们一致地终止或“配对”。如果用户的 HTTP 会话终止，我们希望相应的 Bayeux 会话也终止，反之亦然。有推荐的方法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-30T17:56:40.670

HTTP 会话和 CometD 会话具有不同的生命周期：例如，如果临时连接失败，则 CometD 会话将失败，服务器会要求客户端重新握手，从而创建不同的 CometD 会话（代表相同的用户，但使用不同的 CometD `clientId`）。在相同的情况下，`HttpSession`将保持不变。

考虑到这一点，您需要在应用程序级别维护用户名、通讯者`HttpSession`和通讯者之间的映射`ServerSession`。我们称之为映射`HttpCometDMapper`。每次新用户登录时，您都要注册其名称（或用户的另一个唯一标识符）、`HttpSession`和当前`ServerSession`. 可能您将需要一个两步过程，首先将用户名和 . 链接起来`HttpSession`，然后将相同的用户名与`ServerSession`.

如果执行 CometD 重新握手，则使用新的`ServerSession`.

`HttpSessionListener`您可以通过向 注册 an来链接这两个会话，`HttpSession`这样当它被销毁时，您可以`ServerSession`从映射器中检索当前的 CometD 并调用`ServerSession.disconnect()`它。

反之亦然有点棘手，因为 CometD 没有像`HttpSession`has 那样的非活动超时概念。它必须使用您自己的逻辑在应用程序中实现。

这样做的一部分是在 上注册 a `RemoveListener`，`ServerSession`如下所示：

```
serverSession.addListener(new ServerSession.RemoveListener() 
{
    public void removed(ServerSession session, boolean timeout);
    {
        if (!timeout)
        {
            // Explicitly disconnected, invalidate the HttpSession
            httpCometDMapper.invalidate(session);
        }
    }
}); 
```

此侦听器监视与客户端（和服务器）的显式断开连接 - 谨防重入。

稍微困难的是为非显式断开实现相同的机制。在这种情况下，`timeout`参数将为真，但可能由于临时网络故障而发生（与客户端永久消失相反），并且同一用户可能已经与新的`ServerSession`.

我认为在这种情况下，应用程序超时可以解决问题：当您看到`ServerSession`因超时而被删除时，您会注意到该用户并启动应用程序超时。如果同一个用户重新握手，取消应用超时；否则用户真的走了，应用程序超时到期，你也使之无效`HttpSession`。

以上只是想法和建议；实际的实现很大程度上取决于应用程序的细节（这就是 CometD 不提供开箱即用的原因）。

关键点是映射器、`HttpSessionListener`和`RemoveListener`，以及了解这些组件的生命周期。一旦你做到了这一点，你就可以编写正确的代码来为你的应用程序做正确的事情。

最后，请注意 CometD 具有与`HttpSession`通过[`BayeuxContext`](http://docs.cometd.org/apidocs/)实例交互的与传输无关的方式，您可以从`BayeuxServer.getContext()`. 我建议你也看看它，看看它是否可以简化事情，尤其是检索存储在`HttpSession`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-12T06:11:23.703

如果我们在临时连接失败后创建一个 BayeuxClient 会遇到什么问题吗？

您可以尝试使用以下代码。

```
 try {
        log.info("Running streaming client example....");
        makeConnect();

    } catch (Exception e) {
        handleException("Error while setup the salesforce connection.", e);
    }
}

private void makeConnect() {
    try{
        client = makeClient();
        client.getChannel(Channel.META_HANDSHAKE).addListener
                (new ClientSessionChannel.MessageListener() {
                    public void onMessage(ClientSessionChannel channel, Message message) {
                        log.info("[CHANNEL:META_HANDSHAKE]: " + message);
                        boolean success = message.isSuccessful();
                        if (!success) {
                            String error = (String) message.get("error");
                            if (error != null) {
                                log.error("Error during HANDSHAKE: " + error);
                            }

                            Exception exception = (Exception) message.get("exception");
                            if (exception != null) {
                                handleException("Exception during HANDSHAKE: ", exception);
                            }
                        }
                    }
                });

        client.getChannel(Channel.META_CONNECT).addListener(
                new ClientSessionChannel.MessageListener() {
                    public void onMessage(ClientSessionChannel channel, Message message) {
                        log.info("[CHANNEL:META_CONNECT]: " + message);
                        boolean success = message.isSuccessful();

                        if (!success) {
                            client.disconnect();
                            makeConnect();
                            String error = (String) message.get("error");
                            if (error != null) {
                                //log.error("Error during CONNECT: " + error);
                            }
                        }
                    }

                });

        client.getChannel(Channel.META_SUBSCRIBE).addListener(
                new ClientSessionChannel.MessageListener() {
                    public void onMessage(ClientSessionChannel channel, Message message) {
                        log.info("[CHANNEL:META_SUBSCRIBE]: " + message);
                        boolean success = message.isSuccessful();
                        if (!success) {
                            String error = (String) message.get("error");
                            if (error != null) {
                                makeConnect();
                                log.error("Error during SUBSCRIBE: " + error);
                            }
                        }
                    }
                });
        client.handshake();
        log.info("Waiting for handshake");
        boolean handshaken = client.waitFor(waitTime, BayeuxClient.State.CONNECTED);
        if (!handshaken) {
            log.error("Failed to handshake: " + client);
        }
        log.info("Subscribing for channel: " + channel);
        client.getChannel(channel).subscribe(new MessageListener() {
            public void onMessage(ClientSessionChannel channel, Message message) {
                injectSalesforceMessage(message);
            }
        });
        log.info("Waiting for streamed data from your organization ...");
    }catch (Exception e) {
        handleException("Error while setup the salesforce connection.", e);
    }

} 
```

# macos - 写入应用程序自己的包时“沙盒：拒绝文件写入创建”

> ID：10820867
> 
> 赞同：1
> 
> 时间：2012-05-30T17:01:33.987
> 
> 标签：macos, osx-lion, sandbox, appstore-sandbox

我在 Mac App Store 中编写了一个显示一些图形的程序。有时它会从互联网上更新这些内容。和大多数人一样，我现在不得不对我的应用程序进行沙箱处理。

几乎一切正常，但在更新时会将文件保存在我的应用程序自己的包中，并因“沙盒：拒绝文件写入创建”而失败

我只是使用 fopen(..., "wb")

传入 fopen 的路径是：/Users/MyUser/Library/Developer/Xcode/DerivedData/MyApp-czuwveatgjffaggwqjdqpobjqqop/Build/Products/Debug/My.app/Contents/Resources/the_file.foo

该路径是使用以下方法创建的：

```
CFBundleRef bundle = CFBundleGetMainBundle();
CFURLRef url = CFBundleCopyResourcesDirectoryURL(bundle);
CFURLGetFileSystemRepresentation(url, true, (UInt8*)buf, sizeof(buf)); 
```

我在这里做明显错误的事情吗？我的应用程序是多平台的，所以理想情况下我会继续使用 fopen/etc。据我了解，应该允许应用程序写入自己的包，即使它被阻止在其他地方做任何事情？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-30T23:28:57.343

OS X 应用程序*永远不*应该写入应用程序包（即使它们没有被沙盒化）。在 OS X 中，应用程序对文件系统的访问权限不比用户自己的权限多，并且用户（通常）没有权限修改 /Applications 中的任何内容。请注意，这与 iOS 应用程序完全不同，后者通常将数据存储在应用程序包中。

在 OS X 中，应用程序数据通常存储在每个用户的 Library 文件夹中，根据数据类型存储在多个子文件夹之一中；有关主要文件，请参阅 Apple 关于“[库目录存储应用程序特定文件](http://developer.apple.com/library/mac/documentation/FileManagement/Conceptual/FileSystemProgrammingGUide/FileSystemOverview/FileSystemOverview.html#//apple_ref/doc/uid/TP40010672-CH2-SW1)”的说明。[沙盒使这变得复杂，因为每个应用程序在用户的 Library](http://developer.apple.com/library/mac/documentation/FileManagement/Conceptual/FileSystemProgrammingGUide/FileSystemOverview/FileSystemOverview.html#//apple_ref/doc/uid/TP40010672-CH2-SW26)中都有自己的Container 。Apple 提供了多种方法来确定各种数据的正确位置；请参阅“[确定存储应用程序特定文件的位置](http://developer.apple.com/library/mac/#documentation/FileManagement/Conceptual/FileSystemProgrammingGUide/AccessingFilesandDirectories/AccessingFilesandDirectories.html#//apple_ref/doc/uid/TP40010672-CH3-SW11)”。

# c# - 写入嵌入在资源文件中的文本文件C#

> ID：10820868
> 
> 赞同：0
> 
> 时间：2012-05-30T17:01:35.213
> 
> 标签：c#, text, embedded-resource

使用 MyNamespace.properties.resources.MyTxtFile 时，我可以从资源文件中的嵌入文本文件中读取，但它直接返回字符串并且它是只读字符串，因此我无法更改它。我想写在文件中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T17:04:04.023

这是不可能的。资源是嵌入的并且是只读的，如果你修改了它们，例如，你会破坏签名。

# sql-server - 使用 SQL Server 转义 & 符号

> ID：10820872
> 
> 赞同：1
> 
> 时间：2012-05-30T17:01:43.817
> 
> 标签：sql-server, escaping

我有这个 SQL-Server 查询

```
UPDATE qryPETEUR_frmPricingModel() SET G&A = '68442.0000' WHERE comp_id = '10004' 
```

失败是因为`Incorrect syntax near '&'`

当我将正在编辑的字段更改为没有与号的内容时，该查询有效，因此我认为与号是问题所在。不幸的是，我不得不使用该字段`G&A`并且无法更改它。

我该怎么做才能使此查询正常工作。我想我必须逃脱＆符号，但我不知道如何。我尝试在它前面添加 \ 斜杠以及添加`ESCAPE '\'`到查询的末尾，但没有任何效果。

如果有帮助，我也在使用 Code Igniter。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T17:05:02.870

您不会转义字段名称。在它周围加上括号：

```
UPDATE qryPETEUR_frmPricingModel()
SET [G&A] = '68442.0000'
WHERE comp_id = '10004' 
```

# macos - 这个沙盒消息“拒绝 mach-lookup”是什么意思？

> ID：10820884
> 
> 赞同：8
> 
> 时间：2012-05-30T17:02:29.343
> 
> 标签：macos, sandbox

我的应用程序在客户机器上无法正常运行。这是控制台消息中的一行：

```
sandboxd: ([14252]) aText(14252) deny mach-lookup com.apple.familycontrols 
```

这是什么意思 ？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-30T23:50:39.077

这意味着它所说的：您的应用程序（或注入您的应用程序或在子进程中运行的一些代码）正在尝试查找名为 com.apple.familycontrols 的 Mach 服务，可能在全局范围内，而您没有这样做的权利，因此被拒绝。

如果你需要这个工作，你需要添加一个临时异常权利 com.apple.security.temporary-exception.mach-lookup.global-name = [com.apple.familycontrols]。但是你必须弄清楚为什么你需要这个例外，并向 Apple 提交一个错误，要求他们提供更好的方法来做同样的事情。

如果您不需要它来工作，您需要弄清楚为什么您的代码试图查找此服务并停止执行任何导致它的事情。（如果不是您的代码，而是通过 SIMBL 或其他方式注入您的应用程序的代码，那么这是您的用户的问题，他必须不使用任何有问题的插件。）

# session - 跨所有子域的会话

> ID：10820887
> 
> 赞同：0
> 
> 时间：2012-05-30T17:02:47.613
> 
> 标签：session, subdomain

我希望你们中的一些人可能在这里有一些答案。我已经在这工作了好几个小时，但进展不大。通过大量研究，我发现这是一个没有很多解决方案的常见问题。

我在 domain.com 登录，然后转到 domain.com/profile?u=username 上的用户配置文件，该配置文件已用 .htaccess 重写为 username.domain.com。我需要在所有子域中访问 SESSION 用户名，以便查看用户是否在他们自己的个人资料中。我已经尝试了所有基本解决方案，让 SESSIONS 在所有子域中使用 .htaccess 等（我没有直接访问 php.ini 的权限），但似乎没有任何效果；除了`session_set_cookie_params(0, '/', '.domain.com');`在脚本顶部设置 SESSION 之外。这一下子奏效了——但问题是——它也突然停止工作，并断断续续地继续工作，并且在我不接触代码的情况下无法工作。

我在这里的问题是...

1.  有谁知道为什么这会间歇性地工作然后不工作？
2.  有没有人有任何其他简单的跨平台解决方案来解决这个问题。
3.  如果做不到这一点，我相信我可以将 SESSION 存储在数据库中并在所有子域中重新创建它。这似乎效率低下，但可能是唯一的解决方案。你有什么想法，最好的方法是什么？

我真的很感激这方面的任何帮助。事实证明，这是一个真正的挑战。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T22:13:52.093

我可以通过简单地在我的主目录中添加一个名为 php.ini 的文本文件来解决这个问题`session.cookie_domain = ".domain.com"`。就是这样。你必须重新启动你的浏览器。

# javascript - 属性和变量（简单）

> ID：10820888
> 
> 赞同：0
> 
> 时间：2012-05-30T17:02:53.250
> 
> 标签：javascript, html

我正在尝试使用 VARIABLE 作为属性值...

我有 ：

```
var text = "Hello!"; 
```

HTML是：

`<li class="pro" id="text">`--->（我希望属性 ID 等于 TEXT 变量）

我怎样才能使这项工作？

谢谢

* * *

编辑

我的问题会更具体。

这是我真正拥有的：

```
<li class="product" name="RD-101" price="18"  minimum="4" gap="4"> 
                         <a class="product-image fancybox" href="images/product_big.jpg" title="Picture 4">
                             <img src="images/product_2.png" alt="Preview"/>
                             <div class="text-overlay">
                              <p class="product-heading">Description</p>
                               Enseignes résidentielles imprimées sur 2 panneaux 4 mm 36” x 24” collés dos à dos.
                             </div>
                         </a>
                         <p class="product-heading">RD-101 (Simple)</p>
                         <a href="#" id="test" class="product-buy">Ajouter au panier</a>
                         <p class="product-meta">Double de pareterre 32x24</p>
                         <div class="product-price">18<span class="product-currency">$</span></div>

                    </li> 
```

如您所见，我使用在我的 Javascript 代码中设置的自定义属性。我想知道如何设置（例如）... PRICE 属性为 VARIABLE VALUE 而不是数字“18”，就像我现在粘贴的那样。

我在想类似的东西-->

```
<li class="product" name="RD-101" price="MY_VARIABLE_HERE"  minimum="4" gap="4"> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T17:06:37.360

`$("li.pro").attr('id', text);`与 jQuery 一起使用

记住属性`name`对 a 无效`<li>`

编辑 ：

没有 jQuery，此代码向所有元素添加`price`（无效）属性`li`

```
<ul id="my_ul_id">
  <li>1</li>
  <li>2</li>
  <li>3</li>
</ul> 
```

-

```
var text = 'Hello';
var arr_li = document.getElementById("my_ul_id").getElementsByTagName("li"); 
for(var i=0 ; i<arr_li.length ; i++)
{
  arr_li[i].setAttribute('price', text);
} 
```

最后一件事，我们说它`price`不是一个有效的属性。如果您希望您的 HTML 文档有效，请查看[此处](https://stackoverflow.com/questions/1735230/can-i-add-custom-attribute-to-html-tag)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T17:08:21.770

由于您指定了“javascript”而不是“jquery”，因此您可以执行以下操作...

```
<script type="text/javascript">
var text = "Hello!";
document.getElementById("liItem").setAttribute("id",text);
</script>

<ul>
  <li class="pro" id="liItem">
</ul> 
```

**更新**以反映属性从“name”到“id”的变化

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-30T17:14:21.740

您可以使用 JQuery [attr](http://api.jquery.com/attr/)方法：

```
var theName = 'yourMom';
$('li.pro').attr('name', theName);​ 
```

[http://jsfiddle.net/J798a/2/](http://jsfiddle.net/J798a/2/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-30T17:09:22.667

```
$("li.pro").attr('name', text); 
```

你可以为属性使用任何名称，你喜欢

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-30T17:19:15.937

Javascript会将其设置为

```
<script type="text/javascript">
    var text = "Hello!";
    document.getElementById("changeMe").setAttribute("id",text);
</script>

<ul>
   <li id="changeMe">
</ul> 
```

setAttribute 将提供的属性（第一个参数）设置为第二个参数的值......所以 element.setAttribute("name", "john smith") 会将名称设置为 "john smith" 和 element.setAttribute("class" , "math") 将类属性设置为 "math"。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-30T18:07:41.670

您也可以使用 javascript 模板库来实现。

一些例子：

*   [车把](http://handlebarsjs.com/)
*   [JavascriptMVC](http://javascriptmvc.com/) / [CanJS](http://canjs.us/)
*   [一大堆其他人](http://codebrief.com/2012/01/the-top-10-javascript-mvc-frameworks-reviewed/)

例如，使用 JavascriptMVC，包含以下行（其中 text 实际上是 JS 变量）的 ejs 文件将被转换为 html：

```
<li class="pro" id="<%= text %>"> 
```

您可以在这里阅读： http://javascriptmvc.com/docs.html#! [jQuery.View](http://javascriptmvc.com/docs.html#!jQuery.View)

欢迎来到神奇的无限 Javascript 框架/库世界:)！！

# php - 延迟显示多个通知通知

> ID：10820889
> 
> 赞同：4
> 
> 时间：2012-05-30T17:02:56.523
> 
> 标签：php, jquery, mysql, notifications

我正在使用[noty](http://needim.github.com/noty/)使用“右上角”警报设置显示通知。我真的是 jquery 的新手，但知道 php 和 mysql 足以完成我想做的大多数事情。

我想要做的是使用 mySQL 获取数据以查看是否需要向用户显示任何通知（完成）。然后在页面加载时显示该通知，我也这样做了，尽管我确信除了重复代码之外还有一种更优雅的方式来显示多个通知？

然后我想为每个通知的出现延迟 1 秒，这样它们就不会同时弹出并同时消失。我已经研究过 .delay() 但不了解 jQuery 对我来说毫无用处。

我的代码：

```
$(document).ready(function() {
  var noty_id = noty({"text":"a message","layout":"topRight","type":"inormation","animateOpen":{"height":"toggle"},"animateClose":{"height":"toggle"},"speed":1000,"timeout":5000,"closeButton":false,"closeOnSelfClick":true,"closeOnSelfOver":false,"modal":false});
  var noty_id = noty({"text":"a message","layout":"topRight","type":"inormation","animateOpen":{"height":"toggle"},"animateClose":{"height":"toggle"},"speed":1000,"timeout":5000,"closeButton":false,"closeOnSelfClick":true,"closeOnSelfOver":false,"modal":false});
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T17:16:34.703

您可以只使用本[`setTimeout()`](http://www.w3schools.com/jsref/met_win_settimeout.asp)机 Javascript 函数。*这将在给定的超时时间（毫秒*）后排队执行操作。

```
$(document).ready(function() {
    var noty_id = noty({"text":"a message","layout":"topRight","type":"inormation","animateOpen":{"height":"toggle"},"animateClose":{"height":"toggle"},"speed":1000,"timeout":5000,"closeButton":false,"closeOnSelfClick":true,"closeOnSelfOver":false,"modal":false});
    setTimeout(function() {   var noty_id = noty({"text":"a message","layout":"topRight","type":"inormation","animateOpen":{"height":"toggle"},"animateClose":{"height":"toggle"},"speed":1000,"timeout":5000,"closeButton":false,"closeOnSelfClick":true,"closeOnSelfOver":false,"modal":false}); }, 5000)
}); 
```

您可能会发现[jQuery Pines](http://pinesframework.org/pnotify/)是一个更好的通知系统，可以将多个通知排队。

# javascript - 消息：未终止的字符串常量

> ID：10820890
> 
> 赞同：0
> 
> 时间：2012-05-30T17:02:56.987
> 
> 标签：javascript, html

我在 Internet Explorer 中收到以下错误消息：

网页错误详情

> 用户代理：Mozilla/4.0（兼容；MSIE 8.0；Windows NT 5.1；Trident/4.0；.NET CLR 1.1.4322；.NET CLR 2.0.50727；.NET CLR 3.0.04506.648；.NET CLR 3.5.21022；.NET CLR 3.0.4506.2152；.NET CLR 3.5.30729；.NET4.0C；.NET4.0E) 时间戳：2012 年 5 月 30 日星期三 16:59:09 UTC
> 
> 消息：未终止的字符串常量行：201 字符：744 代码：0 URI： http: [//new.crystalcoach.com/](http://new.crystalcoach.com/)

浏览器显示“页面已加载，但出现错误”。我不确定是什么导致了错误......这一切似乎都是正确的？错误似乎在第 201 行。有人可以找到错误并解释如何解决它吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T18:31:58.960

看起来第 201 行和第 202 行（“附加代码：圆形项目”）上有一个很长的 Javascript，它似乎应该在一行，而不是两行。换行符打断了代码，一个字符串 (".qmmc) 被打断了（没有结束引号）。

# javascript - jQuery Flot Charts + 覆盖 xAxis

> ID：10820892
> 
> 赞同：0
> 
> 时间：2012-05-30T17:03:02.463
> 
> 标签：javascript, jquery, ajax, each, flot

我通过 AJAX 请求获取数据，它看起来像这样：

```
[1,3252325],[2,2323] 
```

第二个值是调用的文件id`fId`

现在我尝试获取该 id 并进行另一个 ajax 调用以找出相应的名称并使用它来覆盖 x 轴描述。

一切正常，但问题是每次运行时，它都会删除所有现有名称。因此，最后，我只剩下最后一个具有自定义 xAxis 描述的数据集。

我需要的是最终所有数据集都有自定义的 xAxis 新名称。

我试图搜索 API.txt，但找不到任何关于它的信息。我也尝试了几个小时来移动代码或重写它，但毕竟我遇到了同样的问题。

那是代码的一部分：

```
function onDataReceived(series) {

    //Add data
    if (!alreadyFetched[series.label]) {
        alreadyFetched[series.label] = true;
        fdata.push(series);

        //Get ID
        var fId = [series.data[0][0]];

        //Get names
        $.ajax({
            url: 'inc/admin.inc.php?action=get&option=filename&id='+fId+'',
            method: 'GET',
            dataType: 'html',
            success: function(response){
                $.plot(fplaceholder, fdata,$.extend(true, {}, foptions, {

                    //Works, but each time it runs, it removes all previous overrides
                    xaxis:{ticks:[[fId,response]]}

                }));
            }
        });
    }

}

$.ajax({
    url: dataurl,
    method: 'GET',
    dataType: 'json',
    success: onDataReceived
}); 
```

更新：

我目前正在使用“hack”来完成我想要的工作，但这可能只适用于我的特定需求：

我将 xaxis“显示十进制数字”设置为 false。绘图建立后，我启动一个超时函数来搜索所有 xaxis 值（在我的例子中是 ids）并通过一个小的 ajax 调用找到相应的名称。

不过，我仍在寻找如何直接在 flot 代码中执行此操作。

# php - 具有 Drupal 编码风格的 PHP 代码格式化程序

> ID：10820893
> 
> 赞同：3
> 
> 时间：2012-05-30T17:03:09.687
> 
> 标签：php, drupal

我们主要使用 Vim 等简单的文本编辑器进行 Drupal 编程。现在，经过几年的开发和许多不同的人参与该项目，编码约定已经有所不同:-)

Drupal 本身具有清晰的代码风格，并且存在用于识别违反编码约定的脚本。但是，手动修复所有内容需要付出太多努力，并且可能会引入错误。

我想知道是否有任何可定制的非商业PHP代码格式化程序，可以批量处理一个项目的所有PHP文件。[我只找到了一个封闭的解决方案](http://www.waterproof.fr/products/phpCodeBeautifier/)，似乎无法定制。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T19:51:21.483

至于 Drupal，我们有[Coder](http://drupal.org/project/coder)模块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T20:25:30.923

您可以尝试我们的[PHP 格式化](http://www.semanticdesigns.com/Products/Formatters/PHPFormatter.html)程序。

它是可编写脚本的，并且使用项目文件，它可以根据需要在尽可能多的 PHP 文件上运行。

因为它使用语言准确的解析器和漂亮的打印机，所以在重新格式化时不会破坏你的代码。

我不知道是否有“Drupal”风格，但它有一些可配置性。

（这似乎很容易通过 Google 使用“PHP Formatter”找到）。

# javascript - 使用 on() 将事件处理程序添加到尚不存在的元素？

> ID：10820895
> 
> 赞同：21
> 
> 时间：2012-05-30T17:03:19.260
> 
> 标签：javascript, jquery

我想为稍后将在 DOM 中创建的元素添加事件句柄。

基本上，我想做的是，当我单击时，将创建`p#one`新元素，然后单击，告诉我单击“p#two”。但是，它不起作用，我单击后没有得到“p#two clicked”的结果。`p#two``p#two``console.log``p#two`

我`on()`用来将点击事件添加到`p#two`. 我做错了什么？

谢谢。

下面是我的示例代码：

```
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>on() test</title>
  <link type="text/css" href="http://localhost/jquery-ui-1.8.20.custom/css/smoothness/jquery-ui-1.8.20.custom.css" rel="stylesheet" />
  <script type="text/javascript" src="http://localhost/jquery-ui-1.8.20.custom/js/jquery-1.7.2.min.js"></script>
  <script type="text/javascript" src="http://localhost/jquery-ui-1.8.20.custom/js/jquery-ui-1.8.20.custom.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {

        $('p#two').on('click', function() {
            console.log('p#two clicked');
        });

        $('p#one').click(function() {
            console.log('p#one clicked');
            $('<p id="two">two</p>').insertAfter('p#one');
        });

    }); // end doc ready
  </script>
</head>

<body>
    <p id="one">one</p>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-05-30T17:07:18.743

```
$('body').on('click','p#two', function() {
    console.log('p#two clicked');
}); 
```

你也可以使用

```
$(document).on('click', 'p#two', function() {

}); 
```

阅读更多关于**[`.on()`](http://api.jquery.com/on)**

你也可以使用**[`.delegate()`](http://api.jquery.com/delegate)**

```
$('body').delegate('#two', 'click', function() {

}); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-05-30T17:07:22.463

您可以像这样将 $.on 绑定到将始终存在于 dom 中的父元素。

```
$(document).on('click','p#two', function() {
            console.log('p#two clicked');
        }); 
```

**请注意：**您可以替换`document`为将始终存在于 dom 中的元素的任何父元素，并且父元素越接近越好。

检查[$.on的文档](http://api.jquery.com/on)

活是贬值的。改用 $.on 。$.live 和 $.delegate 的 $.on 等效语法

```
$(selector).live(events, data, handler);                // jQuery 1.3+
$(document).delegate(selector, events, data, handler);  // jQuery 1.4.3+
$(document).on(events, selector, data, handler);        // jQuery 1.7+ 
```

我建议您将其`$.on`用于所有事件处理目的，因为所有其他方法都通过 $.on 方法在引擎盖下进行路由。

从 jQuery 源代码 v.1.7.2 检查这些函数的定义

```
bind: function( types, data, fn ) {
    return this.on( types, null, data, fn );
},
unbind: function( types, fn ) {
    return this.off( types, null, fn );
},

live: function( types, data, fn ) {
    jQuery( this.context ).on( types, this.selector, data, fn );
    return this;
},
die: function( types, fn ) {
    jQuery( this.context ).off( types, this.selector || "**", fn );
    return this;
},

delegate: function( selector, types, data, fn ) {
    return this.on( types, selector, data, fn );
},
undelegate: function( selector, types, fn ) {
    // ( namespace ) or ( selector, types [, fn] )
    return arguments.length == 1? this.off( selector, "**" ) : this.off( types, selector, fn );
} 
```

您可以看到所有正在使用的方法`$.on`以及`$.off`它们本身。因此，使用`$.on`您至少可以保存一个函数调用，尽管在大多数情况下这并不重要。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-30T17:06:23.160

你想使用 Jquery.on

```
$('body').on('click','p#two', function() {
        console.log('p#two clicked');
    }); 
```

# java - 所有 RuntimeException / Un-checked exception 倡导者，您将如何处理这种情况？

> ID：10820899
> 
> 赞同：0
> 
> 时间：2012-05-30T17:03:23.290
> 
> 标签：java, exception-handling, runtimeexception, unchecked

设想：

对于需要根据用户 ID 进行注册的网站，用户 ID 必须是唯一的。假设用户尝试使用“foo”用户 ID 注册，该用户 ID 已经存在（带有其他必填字段）。现在，不使用受检异常（数据库 API 将抛出`SQLException`重复插入），我想知道未受检异常的拥护者如何处理这种情况并告知用户已经选择了 id？

假设这个网站是在 Struts 上的（不不，我不是在做一个项目，只是我更了解它）。用户将填写的信息提交给调用 DAO 插入新记录的 Struts Action。因此，最终，DAO 将发出 INSERT 语句，该语句将失败。因此，如果 Action（调用 DAO）没有显式处理这种情况（DAO 方法可能只是声明它抛出`SQLException`或方法可能捕获`SQLException`并抛出一个业务检查异常，如扩展 Exception 的 DuplicateUserIDExceptoion），如何处理未经检查的异常?

底线 - 我读了很多文章说 Java 不需要检查异常，所以我希望这个场景能帮助我更好地理解它。请不要指向文章，因为我已经阅读了很多很多，我真的很困惑。您可以帮助我的最好方法是为上述情况提供答案。

注意：我确实理解任何可恢复的异常情况都必须由已检查的异常（我一直在我的项目中实现）处理，但是，我真的对仅支持未检查异常的人感到困惑。你们如何处理上述情况？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T17:10:36.080

未检查的异常可以完全像已检查的异常一样被捕获。我会使用以下方法来处理这种情况：

1.  检查用户 ID 是否已经存在。如果是这样，抛出一个检查过的 DuplicateUserIdException。我认为检查异常在这里更有意义。但是您也可以将异常设置为运行时异常，并在表示层中捕获它，就像捕获已检查的异常一样
2.  插入用户。如果发生 SQLException，则根本不容易确定它是否正是由于已经存在的用户 ID。另外，如果延迟，可以在提交时检查约束。这种异常只会在两个线程之间出现竞争条件的情况下发生，因此应该很少见。因此，我会将其视为技术运行时异常并显示一般错误消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T17:07:43.430

如何启动事务，查询数据库以检查 id 是否存在，如果不存在，执行插入，然后提交事务？如果确实存在，则告诉用户该 id 已经存在。更好的是，您可以将表单中用户名字段的模糊检查作为 ajax 请求，并向他们表明它已经被占用。为什么要依赖数据库异常来判断id是否存在？

# c# - 保护递归操作免受循环的影响

> ID：10820901
> 
> 赞同：0
> 
> 时间：2012-05-30T17:03:37.857
> 
> 标签：c#, .net

我们的代码允许用户设置参数及其值。一个值可能是对另一个参数的引用。

```
Parameter.Set("Parameter1", "%Parameter2%");
Parameter.Set("Parameter2", "%Parameter1%"); 
```

该值的实际解析使用 Regex 类的 Replace 方法以递归方式解析 % 符号内的任何引用，并替换它们：

```
// Pseudo code (the actual parameter name is retrieved and replaced with its value.
Regex.Replace("%Parameter1%", match => Parameter.Get(match)); 
```

在这种情况下，循环引用将导致 StackOverflowException。

如何避免这种情况？（如果检测到循环引用 - 以某种方式抛出异常/句柄）

建议的实现是保留在当前解析执行中已经查找的术语列表（“搜索历史”）。

对于每一步，查看当前搜索的参数是否在历史记录中，如果是 - 我们已经查看过它，并且我们必须在一个循环中。

这种方法的缺点是浪费（为每个发生的参数解析分配一个新列表）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T17:27:16.817

正如我上面建议的那样，将递归方法的签名重写为`Parameter.Get(string, int)`. 使用 int 作为递归深度计数器。每次该方法需要评估更深的参数时，减少 int 变量。当达到 0 时，停止处理参数。int 的初始值可以是一个非常小的数字，因为很少有人会使用 20 个递归参数。

# javascript - AJAX 跨域安全背后的基本原理是什么？

> ID：10820902
> 
> 赞同：8
> 
> 时间：2012-05-30T17:03:38.887
> 
> 标签：javascript, ajax

鉴于编写跨域获取数据的服务器端代理的简单性，我不知道阻止客户端 AJAX 跨域进行调用的最初意图是什么。我不是在要求猜测，我是在寻找语言设计者（或与他们关系密切的人）的文档，以了解他们认为自己在做什么，而不是仅仅给开发人员带来轻微的不便。

TIA

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T17:33:39.410

**这是为了防止浏览器充当反向代理**。假设您正在办公室的 PC 上浏览[http://www.evil.com](http://www.evil.com)，并假设在该办公室存在一个包含敏感信息的内部网[http://intranet.company.com](http://intranet.company.com)，只能从本地网络访问. **如果跨域策略不存在，www.evil.com 可以向[http://intranet.company.com](http://intranet.company.com)发出 ajax 请求，使用您的浏览器作为反向代理**，并将该信息与另一个发送到 www.evil.com阿贾克斯请求。

我猜这是限制的原因之一。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T17:10:24.650

此限制的最重要原因是安全问题：JSON 请求是否应该让浏览器服务并接受 cookie 或安全凭证以及对另一个域的请求？这与服务器端代理无关，因为它无法直接访问客户端环境。有[一个关于安全净化 JSON 特定请求方法的提案](http://www.json.org/JSONRequest.html)，但它还没有在任何地方实现。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-30T17:14:16.213

如果您是 myblog.com 的作者并且您对 facebook.com 进行了 XHR，那么该请求是否应该发送您的 facebook cookie 凭据？不，这意味着您可以从您的博客请求用户的私人 Facebook 信息。

如果您创建代理服务来执行此操作，则您的代理无法访问 facebook cookie。

您可能还会质疑为什么 JSONP 可以。原因是您正在加载一个不是您编写的脚本，因此除非 facebook 的脚本决定从他们的 JS 代码中向您发送信息，否则您将无法访问它

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-30T17:20:01.070

直接访问和代理之间的区别在于 cookie 和其他安全相关的识别/验证信息，它们绝对限于一个来源。

有了这些，您的浏览器可以访问敏感数据。您的代理不会，因为它不知道用户的登录数据。

因此，代理仅适用于公共数据；和[CORS](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)一样。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-30T17:53:40.833

我知道您在寻求专家的答案，我只是一个新手，这就是我对为什么*服务器端代理*不是正确的最终解决方案的看法：

*   构建*服务器端代理*并不像根本不构建它那么容易。
*   并非总是像在*第三方 JS 小部件*中那样可行。您不会要求所有发布者声明 DNS 注册以集成您的小部件。`document.domain`并用附带问题修改他的页面。
*   [正如我在《第三方 Javascript](http://thirdpartyjs.com/) 》一书中读到的*“它需要加载一个中间隧道文件才能发出跨域请求”*。至少你把 JSONP 放到了游戏中，更棘手的是杂耍。
*   IE8 不支持，同样来自上述书籍：*“IE8 有一个相当奇怪的错误，即使顶级域都选择进入公共域命名空间，它也会阻止顶级域与其子域通信”*。
*   正如人们在其他答案中解释的那样，有几个安全问题，甚至更多，您可以查看上述书籍的第*4.3.2 章使用子域代理进行消息交换。*

对我来说最重要的是：

*   这是一个 hack.. 就像 JSONP 解决方案一样，是时候采用标准、可靠、安全、干净和舒适的解决方案了。

但是，重新阅读您的问题后，我想我仍然没有回答，那么**为什么要使用 AJAX 安全性？**，我再次认为，答案是：

**因为您不希望您访问的任何网页能够*从您的桌面*呼叫*任何计算机或服务器*到您办公室的 Intranet**

# salesforce - Salesforce - 创建没有选项卡的对象项目

> ID：10820903
> 
> 赞同：0
> 
> 时间：2012-05-30T17:03:39.337
> 
> 标签：salesforce

有没有办法创建一个没有选项卡的自定义对象的新项目？我正在使用的环境在选项卡中被最大化，所以我无法创建一个新的环境，这很容易让我创建一个新项目。

如果可能的话，我宁愿不必编写 Visualforce 页面来执行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T23:26:28.907

如果您知道自定义对象的前缀，则可以在左侧创建自定义链接。

即：“/a0E”

# ssh - 已发送 Amazon EC2 SSH 服务器：（publickey、gssapi-keyex、gssapi-with-mic）

> ID：10820917
> 
> 赞同：3
> 
> 时间：2012-05-30T17:04:28.033
> 
> 标签：ssh, amazon-ec2

尝试连接 ssh 时收到此错误消息。

`Disconnected: No supported authentication methods available (server sent: publickey,gssapi-keyex,gssapi-with-mic)`

我创建了一个实例（cent os），生成了我的 webserver.pem，导入了 puttygen 并输出了一个 ppk

我已经看到这可能是服务器上的 ~/.ssh 的权限问题，但是我如何在没有 ssh 访问服务器的情况下更改服务器上的权限？还有其他我不知道的连接方式吗？我对亚马逊 ec2 的东西很陌生。

我现在使用腻子在Windows系统上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T20:42:40.307

我的安全组不正确。我使用正确的安全组重新创建了实例

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-02-06T03:40:00.893

以下步骤对我有用。

1.  编辑 sshd_config 文件 `sudo vi /etc/ssh/sshd_config`。
2.  搜索`PasswordAuthentication`
3.  如果是`no`，请将其更改为`yes`. 对我来说，它被评论了。如果是这样，请取消注释。
4.  重启sshd服务`sudo systemctl restart sshd.service`

完毕。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-15T06:42:17.797

这些是使用公共云、尝试创建虚拟机并连接到它时通常的基本步骤。

1.  创建**虚拟云网络**/虚拟私有云
2.  创建**Internet 网关**并确保 VCN 的**路由表**具有将 Internet 绑定流量（目标 0.0.0.0/0）路由到 Internet 网关的条目
3.  创建一个**虚拟机**（在这种情况下是 Linux），确保它有一个公共 IP（在**公共子网**中创建 VM ），下载密钥对（例如 PEM 格式）
4.  创建一个**安全组**并确保来自源的入口规则：0.0.0.0/0，协议：TCP，目标端口：22
5.  在创建 VM 时或创建后将 VM 与 VNIC 级别**的安全组**相关联。

来自 Oracle Cloud 文档 -

> 仅拥有一个互联网网关并不会将 VCN 子网中的实例直接暴露给互联网。还必须满足以下要求：
> 
> 必须启用互联网网关（默认情况下，互联网网关在创建时启用）。子网必须是公共的。子网必须具有将流量定向到 Internet 网关的路由规则。子网必须具有允许流量的安全列表规则（并且每个实例的防火墙必须允许流量）。实例必须 > 具有公共 IP 地址。

现在使用 putty 连接到 VM，基本上你正在做一个：

*ssh user@ip_address —i private_key*

一种。**使用 puttygen**并加载您下载的 PEM 私钥。成功导入后，将私钥（可选用密码）保存为本地计算机中的 PPK（例如“your_pvt_key_name.ppk”）

湾。**使用 putty 连接**到 VM 的公共 IP。确保在连接到 VM 时在 putty 中提供了用于身份验证的私钥。在 Connection->SSH->Auth 部分中，浏览“your_pvt_key_name.ppk”，然后返回会话并“打开”VM。如果 VM 位于具有正确路由表条目的公共子网上，您应该会看到登录屏幕。如果虚拟机在互联网上不可用，它将无法连接！

c. Once you see the login screen most important and which is the probable cause of the above error, ***login with correct user name***, such as "ec2-user" in AWS or "opc" in OCI. Using an incorrect user name results in this error.

```
 No supported authentication methods available (server sent: publickey,gssapi-keyex,gssapi-with-mic) 
```

# physics - Abaqus - 传热分析中不允许使用应力-位移元素

> ID：10820918
> 
> 赞同：1
> 
> 时间：2012-05-30T17:04:28.800
> 
> 标签：physics, simulation

我正在尝试模拟圆柱形样品的冷却，但是当我提交作业时出现错误：传热分析中不允许使用应力位移元素。我定义了零件、材料（密度、比热、电导率）、截面、截面分配、网格、实例、初始步骤中的预定义场（温度）、步骤 1（热传递）与相互作用（表面膜条件）。问题出在哪里？

**更新：** 我解决了这个问题：我的元素类型不正确。对于传热模拟：网格 -> 单元类型 -> 族 -> 传热。我想应该选择 Hex 选项卡中的 Convection/Diffusion 选项。

# c++ - 如何通过自定义 QAbstractItemModel 在 QTableView 中显示图标？

> ID：10820919
> 
> 赞同：2
> 
> 时间：2012-05-30T17:04:28.970
> 
> 标签：c++, qt, model

我正在构建一个自定义 QAbstractItemModel 模型。

第一列包含图标，第二列 - 文本。

这是数据方法的代码：

```
QVariant data ( const QModelIndex & index, int role = Qt::DisplayRole ) const
{
    if(role != Qt::DisplayRole )
        return QVariant();

    int col = index.column();
    if (col == 0)
    {
        return iconProvider->icon(QFileIconProvider::Folder);
    }
    else if (col == 1)
    {
        return "TEXT";
    }
} 
```

但是我在结果表视图中得到的只是第二列中的文本。第一列中没有文件夹图标。

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-30T17:21:21.000

`Qt::DisplayRole`仅用于文本。添加：

```
if ( role == Qt::DecorationRole ) {
    return iconProvider->icon(QFileIconProvider::Folder);
} 
```

# ruby-on-rails - Rails 3.2 其他语言的变形

> ID：10820920
> 
> 赞同：1
> 
> 时间：2012-05-30T17:04:30.960
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2, inflection

我在一个应用程序中有 2 种语言，**英语**和**西班牙语**。

我有一个名为的对象`Job`，并且有一个名为的`Job`属性整数`max_day_on_complete`

在我看来，我有英语：

```
<%= pluralize(@job.max_day_on_complete, 'day') %> 
```

我得到这个输出：

```
1 day
2 days
3 days
.
.
. 
```

用西班牙语`day = día`和`days = días`

但是当我将我的应用程序更改为**西班牙语**时，我看不到`día, días`单词。

当我的应用程序是西班牙语时，如何在我的视图中显示这些词？

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T17:21:53.247

好的，问题已解决。

补充`config/initializers/inflections.rb`：

```
# encoding: utf-8
ActiveSupport::Inflector.inflections do |inflect|
inflect.irregular('día', 'días')
end 
```

例如，在您看来：

```
<%= pluralize(@job.max_day_on_complete, t('.max_day_on_complete')) %> 
```

在你的`es.yml`

```
jobs:
   show:
       max_day_on_complete: "día" 
```

# asp.net-mvc - 内容文件的 ASP.NET MVC NESTED 虚拟目录

> ID：10820925
> 
> 赞同：1
> 
> 时间：2012-05-30T17:04:47.270
> 
> 标签：asp.net-mvc, iis, virtual-directory

我正在尝试在我的 ASP.NET MVC 3 网站中映射一个虚拟目录。虚拟目录仅包含图像文件，物理目录位于另一台服务器上。当我尝试通过 Web 浏览器访问此目录中的图像时，我收到 HTTP 500 错误：

```
Parser Error Message: An error occurred loading a configuration file: Failed to start monitoring changes to '<virtual directory path>' because access is denied. 
```

[编辑]：重新启动 IIS 后，我看到它在错误消息的末尾添加了“访问被拒绝”。但是，该目录对其具有读取访问权限的“所有人”权限，但它仍然无法正常工作。我已经看到详细说明相同错误的帖子，但是权限设置解决方案对我不起作用。

为什么要查找配置文件？我已经更新了 Global.asax 以忽略有问题的路由，并且在 IIS 6 中，我可以毫无问题地浏览位于虚拟目录中的文件。我已验证虚拟目录未设置为应用程序。此外，对目录的权限对所有人集都具有读取权限。我究竟做错了什么？

[编辑#2]：被指向的虚拟目录是一个网络共享文件夹......这有什么区别吗？

[编辑#3]：我正在尝试做的 IIS 6 层次结构是：默认网站 -> OurSite（MVC 网站，它是一个虚拟目录） -> 图像（我正在努力的虚拟目录）。这是一个嵌套的虚拟目录，这肯定是有问题的。如果我将目录创建为默认网站而不是默认网站 -> OurSite 的直接子目录，则它可以正常工作。

谢谢，

安迪

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T17:52:27.943

确保运行应用程序池的身份在该虚拟文件夹上也具有执行和列出权限，因为它正在尝试监视它以进行缓存更改。

[http://support.microsoft.com/kb/316721/](http://support.microsoft.com/kb/316721/)

[编辑] 此链接表明它可能是第二种情况，它没有对共享目录中的子文件夹的权限。

[http://support.microsoft.com/kb/317955](http://support.microsoft.com/kb/317955)

ASPNET 帐户是否可以一直访问该树？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-11T07:25:55.197

阅读交钥匙的答案和您的评论，我只想指出，如果您的 AppPool 使用`NETWORK SERVICE`身份，那么您的远程服务器需要将 Web 服务器的**机器/计算机帐户**添加到共享文件夹和 NTFS 权限而不是**帐户**`NETWORK SERVICE`。
如果您添加`NETWORK SERVICE`到共享文件夹和 NTFS 权限，您只是添加*本地计算机*的`NETWORK SERVICE`帐户而不是*Web 服务器*的`NETWORK SERVICE`帐户。我希望我说得通。
每当您使用计算机的`NETWORK SERVICE`帐户进行远程连接时，您实际上是在使用计算机的**计算机帐户**，因此您需要添加该帐户。
假设您的网络服务器被调用**PRODSERVER**，您需要将机器/计算机帐户**PRODSERVER$**添加到远程共享文件夹的权限。
希望有帮助。

# webgl - 用于 3D Web 开发的three.js vs libgdx

> ID：10820926
> 
> 赞同：6
> 
> 时间：2012-05-30T17:04:51.507
> 
> 标签：webgl, libgdx, three.js

Libgdx 主要专注于 Android 并且是用 java 编写的，但显然它可以在浏览器（webGL？）上运行应用程序。Three.js 是一个非常令人印象深刻的 javascript 3D 库，它也使用 WebGL（或 2d 画布）进行渲染。到目前为止，我还没有看到这两者之间的任何比较，因为它们有不同的重点，但我想知道它们之间的区别，一个图书馆能做什么而另一个图书馆不能。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-01-11T20:52:35.557

我认为我没有资格谈论 Three.js，但我在我的许多项目中都使用过 libGDX，并且知道它在 WebGL（浏览器导出）方面的缺点。

1.  首先要考虑的因素是你习惯什么语言，Three.js 使用 JavaScript，libGDX 使用 Java。虽然 libGDX 导出到 WebGL，但这只是因为它使用 GWT，您仍然使用 Java 进行编码。

2.  LibGDX（如您所说）专门用于移动和（在一定程度上）桌面应用程序。如果您的目标是创建适用于 Web 以及移动设备和桌面的东西，那么应该考虑使用 libGDX。但是，如果您只想为 Web 编程，那么我真的会考虑只使用 Three.js，原因我稍后会解释。

3.  LibGDX 主要用于游戏开发，因此，如果您正在制作的应用程序是游戏，您可以考虑使用 libGDX，因为它使 3D 游戏编程变得简单易用（并且您可以将其移植到多个平台，而不是只有网络，但移动和桌面）。但是，如果您正在制作其他东西，Three.js 可能是更好的选择。

4.  如果您的分发平台将是您的网络版本，我建议坚持使用 Three.js，因为 libGDX 不适合其 WebGL 导出。最大的问题之一（这是可以解决的，但处理起来很痛苦）是 libGDX 不会阻止使用默认浏览器密钥。但是，如果您确实选择使用 libGDX，请确保查看[此](https://github.com/libgdx/libgdx/issues/2584)内容以解决该问题（或多或少）。

5.  在大多数情况下，如果您的主要平台将是 Web，您将希望使用一种用于 Web 开发的语言进行编程。如果您使用 Three.js 框架在 JavaScript 中进行编程，那么代码运行起来会更加简洁和快速。同时，如果您使用 libGDX，它本质上会将 Java 代码转换为 JavaScript 编码，从而使其效率低下且体积庞大，并且将包含许多无用或可以简化的 JavaScript 代码行。这不是 libGDX（或者更确切地说是 GWT）本身的问题，而只是自动化编程语言翻译时无法避免的问题。举个例子，使用编程语言 Haxe，如果你编译一个*HelloWorld*Haxe to C++ 它包含一堆不必要的变量和方法（在 C++ 源代码中），你可以摆脱它们。在这种情况下也是如此。

所以最终取决于你的目标是什么。如果您打算只使用 Web 版本，请使用 Three.js，否则应考虑使用 libGDX。

# c# - 第一次单击登录和注册链接后断点未命中

> ID：10820927
> 
> 赞同：1
> 
> 时间：2012-05-30T17:04:53.400
> 
> 标签：c#, asp.net, visual-studio-2010, asp.net-mvc-4

我在 Visual Studio 2010 中创建了一个 MVC4 Web 项目。我在 AccountController.cs 文件中有以下方法的断点：

```
[AllowAnonymous]
public ActionResult Login()

[AllowAnonymous]
[HttpPost]
public JsonResult JsonLogin(LoginModel model, string returnUrl)

[AllowAnonymous]
[HttpPost]
public ActionResult Login(LoginModel model, string returnUrl) 
```

单击登录按钮时，第一次点击后，这些都不会被点击。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T19:16:53.617

默认 MVC4 App 项目模板的模式对话框在第一次打开后被缓存。并且第一次必须命中这些断点。在随后的时间里，浏览器没有发出任何请求，因为对话框被缓存了——并且没有命中断点。

# javascript - js滚动条宽度

> ID：10820930
> 
> 赞同：0
> 
> 时间：2012-05-30T17:05:17.410
> 
> 标签：javascript, width, scrollbar, conditional-statements

我在网上找到了这个脚本[http://javascript.jstruebig.de/javascript/70](http://javascript.jstruebig.de/javascript/70)。我只是想知道这条线是什么意思：

```
if(!width) width = document.body.offsetWidth-document.body.clientWidth; 
```

!width 条件是什么意思？如果没有初始化呢？此外，是否有任何较短的脚本提供相同的功能？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T17:40:40.963

!width 只是检查变量的虚假值，更明确的检查将是

```
if(typeof width === "undefined") {
   width = document.body.offsetWidth-document.body.clientWidth;
} 
```

*   offsetWidth 是元素的全宽，包括边框和滚动条客户端
*   clientWidth 是包含填充但不包括边框和滚动条的元素的宽度

简而言之，该逻辑只是获取页面边框和滚动条的宽度。可能有不同的实现，但没有比两个操作数相减更短的逻辑了。

# python - 合并嵌套的默认字典

> ID：10820936
> 
> 赞同：2
> 
> 时间：2012-05-30T17:05:39.853
> 
> 标签：python, data-structures, union, defaultdict

我有这个：

```
dict1 = defaultdict(lambda:defaultdict(list))
dict1['rl1']['sh1'] = ['a','b']
dict1['rl1']['sh2'] = ['c','d']
dict1['rl2']['sh1'] = ['c','d']

dict2 = defaultdict(lambda:defaultdict(list))
dict2['rl1']['sh1'] = ['p','q']
dict2['rl1']['sh3'] = ['r','s']
dict2['rl3']['sh1'] = ['r','s'] 
```

我想做两个默认字典的联合，这将是结果：

```
uniondict = defaultdict(lambda:defaultdict(list))
uniondict['rl1']['sh1'] = ['a','b','p','q']
uniondict['rl1']['sh2'] = ['c','d']
uniondict['rl1']['sh3'] = ['r','s']
uniondict['rl2']['sh1'] = ['c','d']
uniondict['rl3']['sh1'] = ['r','s'] 
```

我不确定如何获得此结果。我尝试使用 dict1.items() 和 dict2.items() 或更新函数，但我必须遗漏一些东西，因为我无法获得“联合” "的默认字典。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-30T17:50:20.963

稍微“优雅”一点：

```
uniondict = defaultdict(lambda:defaultdict(list))
for k1, v1 in dict1.items() + dict2.items():
    for k2, v2 in v1.items():
        uniondict[k1][k2] += v2 
```

对于内存效率更高的解决方案：

```
from itertools import chain
uniondict = defaultdict(lambda:defaultdict(list))
for k1, v1 in chain(dict1.iteritems(), dict2.iteritems()):
    for k2, v2 in v1.iteritems():
        uniondict[k1][k2] += v2 
```

这将使用迭代器来防止在内存中创建临时列表

[itertools.chain 文档](http://docs.python.org/library/itertools.html#itertools.chain)

* * *

对于后代，这是一个通用函数，它将合并第二层值支持`+`运算符的嵌套字典对象（defaultdict 或 no）。（列表、整数、集合等）：

```
from collections import defaultdict
from itertools import chain

def merge_nested_dicts(dict_list):
    uniondict = defaultdict(lambda:defaultdict(list))
    for k1, v1 in chain(*[d.iteritems() for d in dict_list]):
        for k2, v2 in v1.iteritems():
            uniondict[k1][k2] += v2
    return uniondict 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-30T17:18:39.317

```
dict12 = defaultdict(lambda:defaultdict(list))
for k,v in dict1.items():
    for k1,v1 in v.items():
        dict12[k][k1] = v1
for k,v in dict2.items():
    for k2,v2 in v.items():
        dict12[k][k2] += v2
for k,v in dict12.items():
    for k12,v12 in v.items():
        print "dict12[%r][%r] = %r" % (k,k12,v12) 
```

# python - Die Ordnungszahl 63 wurde in der DLL "libexpat.dll" nicht gefunden

> ID：10820937
> 
> 赞同：2
> 
> 时间：2012-05-30T17:05:42.167
> 
> 标签：python, python-2.5, qgis

我有一个 Python 2.5 程序，代码位于

[https://www.dropbox.com/s/wh1sgpsd248x85m/PopGen.zip](https://www.dropbox.com/s/wh1sgpsd248x85m/PopGen.zip)

当我执行这个程序 (python -m gui.mainwindow) 时，我收到错误消息“Die Ordnungszahl 63 wurde in der DLL "libexpat.dll" nicht gefunden。” （对不起，我不知道如何将“Ordnungszahl”翻译成英文，直译-“订货号”）。

![https://www.dropbox.com/s/1osw18xlz8tcjt8/2.png](../Images/645913900f94d4e1eb675248b400d081.png)

当我查看程序的输出时，我看到了错误

导入 qgis 时出错；将不提供映射支持。错误消息 - DLL 加载失败，错误代码为 182

![在此处输入图像描述](../Images/f03b56e8f90ed7cdf5afeece2d9345b2.png)

该程序使用 Quantum GIS (qgis) 包，该包已安装并包含 DLL 的路径。

问题的一个可能原因是在 system32 中有另一个旧版本的 libexpat.dll。但在我的机器上不是这样。

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T18:14:34.277

谢谢大家的帮助。安装不同版本的 QGIS 解决了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-05-26T14:29:41.543

[看起来问题是 libexpat.dll 的不兼容/旧版本，](http://grasswiki.osgeo.org/wiki/WinGRASS_errors#Error_message_.22The_ordinal_63_could_not_be_located_in_the_dynamic_link_libexpat.dll..22)或者在我的情况下，根本没有它的副本。我作弊并将 DLL 的副本下载到相关的 Windows 系统文件夹中。

# php - Mysql编码不一致

> ID：10820942
> 
> 赞同：1
> 
> 时间：2012-05-30T17:06:03.553
> 
> 标签：php, mysql, encoding

我是葡萄牙人，我正在制作一个有蔬菜名称的网站。

但是，编码不一致。例如，Agrião（豆瓣菜）这个词有时会正确出现，但有时会像 AgriÃ£o 一样出现。

当我刷新页面时，它会随机选择其中一个。有时它是正确的，有时它不是。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T17:12:13.070

可能有几个因素：

1.  MySQL 列/表未使用正确的编码（推荐使用 UTF-8）
2.  数据库会话字符集设置不正确（`SET NAMES utf8`[`mysql_set_charset()`用于已弃用的 API]）
3.  页面编码错误（`header('Content-Type: text/html; charset=utf-8')`）

# networking - 通过我的电脑重定向局域网对等方的数据包

> ID：10820946
> 
> 赞同：1
> 
> 时间：2012-05-30T17:06:32.557
> 
> 标签：networking, routes, lan, packet-capture

我想做的很简单：在 WLAN 中，假设我有 ip 172.16.0.10，而我的朋友有 172.16.0.9。路由器的 IP 为 172.16.0.1，我希望我的朋友和路由器的所有流量都通过我的电脑（我可以使用wireshark 进行分析。）

我想这可以使用 linux 中的“route add”命令来完成，我可以在他的电脑中执行该命令并将指标设置为较低的值，但由于我是这些命令的新手，我无法弄清楚确切的方法。请帮忙。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T17:12:20.073

无需使用 route 命令，因为 IP 在同一子网中。仅当 2 个 IP 属于不同的网络时，路由才适用。只需将路由器的IP作为默认网关即可。

# hibernate - 让休眠忽略正常的get方法

> ID：10820954
> 
> 赞同：0
> 
> 时间：2012-05-30T17:07:11.013
> 
> 标签：hibernate, methods, mapping, field

我有一个使用字段映射的应用程序，所以在阅读了它之后，我决定转向方法。但是现在我有一个问题，在我的一个具有方法 getFullName 的抽象类中显示一个错误，上面写着

实体映射中的重复列：com.bomahabo.flow.domain.project.shot.ShotComponent 列：fullName（应使用 insert="false" update="false" 进行映射）

事情是这个方法没有被映射，它不应该被映射，因为它是一个正常的方法。这让我想到了另一件事。如果我使用方法作为映射，这是否意味着休眠将尝试映射任何返回字符串的 get 方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T17:10:02.160

您需要将该字段设置为瞬态。如果您正在使用属性，那么您正在寻找 @Transient

# xslt - 使用 xslt 从父级复制属性

> ID：10820956
> 
> 赞同：1
> 
> 时间：2012-05-30T17:07:18.447
> 
> 标签：xslt

我需要使用 XSLT 1.0 修改 XML。基本上，我需要将属性（名称和值）复制给一个孩子。

这是xml：

```
 <parent id="3450">
        <son1>
            <name>Malcom</name>
            <age>15</age>
            <description>This is the middle son</description>
        </son1>
        <son2>
            <name>Francis</name>
            <age>19</age>
            <description>This is the oldest son</description>
        </son2>
        <son3>
            <name>Dewey</name>
            <age>9</age>
            <description>This is the youngest son</description>
        </son3>
    </parent> 

```

这应该是结果：

```
 <parent id="3450">
        <son1 id="3450">
            <name>Malcom</name>
            <age>15</age>
            <description>This is the middle son</description>
        </son1>   
    </parent> 

```

这是我正在使用的 XSLT：

```
 <xsl:template match="@*|node()">
        <xsl:copy>
            <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="parent/son1">    
        <xsl:copy>
            <xsl:attribute name="id"><xsl:value-of select="../@id"/></xsl:attribute>
            <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="parent/son2" />
    <xsl:template match="parent/son3" /> 

```

XSLT 似乎正在工作，但我的问题是：这是正确的方法吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T17:45:36.063

我会改变

```
<xsl:template match="parent/son1">    
    <xsl:copy>
        <xsl:attribute name="id"><xsl:value-of select="../@id"/></xsl:attribute>
        <xsl:apply-templates select="@*|node()"/>
    </xsl:copy>
</xsl:template> 
```

到

```
<xsl:template match="parent/son1">    
    <xsl:copy>
        <xsl:apply-templates select="../@id | @* | node()"/>
    </xsl:copy>
</xsl:template> 
```

# android - 在android中以编程方式关闭shift键

> ID：10820959
> 
> 赞同：0
> 
> 时间：2012-05-30T17:07:31.370
> 
> 标签：android, keyboard

我正在开发一个 android 应用程序（键盘驱动程序），首先我将蓝牙键盘与 android 设备连接，在我的 Inputmethod 服务中成功连接后，我正在接收按键并将其发送到当前打开的编辑器。问题是我无法弄清楚如何在 android 中打开/关闭大写锁定和 shift 键功能。

```
 private BroadcastReceiver key3Receiver = new BroadcastReceiver() {

    @Override
    public void onReceive(Context context, Intent intent) {
        int key = Integer.parseInt(intent
                .getStringExtra(BluezService.COLONY_KEYPRESS_KEY));
        int action = intent.getIntExtra(BluezService.EVENT_KEYPRESS_ACTION,
                KeyEvent.ACTION_DOWN);
        Log.d("++++ key recieved   ", Integer.toString(key));

        InputConnection ic = getCurrentInputConnection();
        long eventTime = SystemClock.uptimeMillis();

        if(key==2)
        {
            if(checkEnable==true){
                ic.clearMetaKeyStates(KeyEvent.META_SHIFT_LEFT_ON);
                Log.d("metakey", "turn off");
                checkEnable=false;
                return;
            }else{
                Log.d("metakey", "turn on");
                checkEnable=true;
            }
        }
        // ********* Hacks
        if(key==8)
        {
            key=127;
        }

        if (key < 130) {

            ic.sendKeyEvent(new KeyEvent(eventTime, eventTime, action,COLONYKEYCODE[key],
                    0, KeyEvent.META_SHIFT_ON, 0, 0, KeyEvent.FLAG_SOFT_KEYBOARD));
        }

    }
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T17:29:44.293

我找到了可能对某人有帮助的解决方案。我做错了什么，我调用 KeyEvent.ACTION_DOWN 并忘记调用 KeyEvent.ACTION_UP 以在 ic.sendKeyEvent(...) 中执行操作，这就是它没有释放 shift 键的原因。

# opencv - Windows 中不存在 OpenCV 库文件（imgproc.hpp）

> ID：10820966
> 
> 赞同：1
> 
> 时间：2012-05-30T17:08:09.623
> 
> 标签：opencv, build

我是 OpenCV 的新手。遵循 openCV 教程。现在，当我构建项目时，错误来了。它说找不到包含目录 imgproc.hpp。当我检查 opencv/include/opencv2 文件夹时，没有 imgproc.hpp 和 ml.hpp 以及 video.hpp 文件。请帮忙。使用 Win32 和 OpenCV2.4

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T17:13:53.660

您可能缺少目录，请尝试：`opencv/include/opencv2/imgproc/imgproc.hpp`

# php - 在php中每周和每月计算订单

> ID：10820969
> 
> 赞同：1
> 
> 时间：2012-05-30T17:08:21.030
> 
> 标签：php, cakephp-1.3

我需要每周和每月计算订单。到目前为止我设置的代码是这样的：

```
foreach ($commissions as $c) {
    $ts = strtotime($c['order_date']);

    $lastWeekKey = date("Y-m-d", strtotime('last monday', $ts));
    $nextWeekKey = date("Y-m-d", strtotime('next sunday', $ts));

    $stringDays = $lastWeekKey." to ".$nextWeekKey;

    if (!isset($dates[$stringDays])) {
        $dates[$stringDays] = 0;
    }
    $dates[$stringDays] += $c['projected_payment'];
} 
```

这里的问题是，如果日期在星期一，那么它会在上星期一和下星期日。我需要它来计算那个星期一，而不是下一个。这个月也一样。总而言之，我只是在寻找最准确和最简单的答案。它不必是格式。每月和每周。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T21:16:07.370

使用现有代码，您可以在定义密钥之前添加一个 if 语句。IE：

```
$thisday=getdate($ts);
if($thisday==1) { //1 = Monday
    $lastWeekKey = date("Y-m-d",  strtotime('today',$ts));
    $nextWeekKey = date("Y-m-d",  strtotime('next sunday',$ts));
} else {
    $lastWeekKey = date("Y-m-d",  strtotime('next monday',$ts));
    $nextWeekKey = date("Y-m-d",  strtotime('next sunday',$ts));
} 
```

您可能必须检查“今天”是否是当天的实际文本表示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T21:42:15.393

如果你使用 mysql，你可以让 sql 做很多工作。

```
$x = mysql_query("SELECT * FROM `mysales` 
             WHERE `MerchantID`=’$id’
             AND `Saledate`  > ’TIMESTAMP(".strtotime(’-1 week’).")’"); 
```

# erlang - Erlang中的二进制和位串有什么区别？

> ID：10820971
> 
> 赞同：9
> 
> 时间：2012-05-30T17:08:24.750
> 
> 标签：erlang, binary-data, bitstring

在 Erlang shell 中，我可以执行以下操作：

```
A = 300.
    300
<<A:32>>.
    <<0, 0, 1, 44>> 
```

但是当我尝试以下操作时：

```
B = term_to_binary({300}).
    <<131,104,1,98,0,0,1,44>>
<<B:32>>
    ** exception error: bad argument
<<B:64>>
    ** exception error: bad argument 
```

在第一种情况下，我采用一个整数并使用位串语法将其放入一个 32 位字段中。这按预期工作。在第二种情况下，我使用`term_to_binary`BIF 将元组转换为二进制文件，我尝试使用位串语法从中解压缩某些位。为什么第一个示例有效，但第二个示例失败？似乎他们都在做非常相似的事情。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-30T17:24:10.707

二进制和位串的区别在于二进制的长度可以被 8 整除，即它不包含“部分”字节。位串没有这样的限制。

这种差异不是您的问题。

您面临的问题是您的语法错误。如果您想从二进制文件中提取前 32 位，则需要编写完整的匹配语句 - 如下所示：

```
<<B1:32, _/binary>> = B. 
```

请注意，这`/binary`很重要，因为无论其长度如何，它都会匹配二进制文件的剩余部分。如果省略，则匹配长度默认为 8（即 1 个字节）。

[您可以在Erlang 参考手册的位语法部分](http://www.erlang.org/doc/reference_manual/expressions.html#bit_syntax)阅读更多关于二进制文件和使用它们的信息。

编辑

根据您的评论，`<<A:32>>`不仅适用于整数，还适用于*values*。根据我给出的链接，位语法允许您指定二进制匹配的许多方面，包括绑定变量的数据类型 - 虽然默认类型是`integer`，但您也可以说`float`或`binary`（等等）。该`:32`部分表示匹配需要 32 位 - 根据您的数据类型，这可能有意义也可能没有意义，但这并不意味着它仅对整数有效。例如，您可以说`<<Bits:10/bitstring>>`描述一个 10 位的位串。希望有帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-04-10T17:31:31.857

`<<A:32>>`语法构造一个二进制文件*。*要*解构*二进制文件，您需要将其用作模式，而不是将其用作表达式。

```
A = 300.
% Converts a number to a binary.
B = <<A:32>>.
% Converts a binary to a number.
<<A:32>> = B. 
```

# jquery-ui - jQuery UI 自动完成：如何定位下拉菜单？

> ID：10820972
> 
> 赞同：1
> 
> 时间：2012-05-30T17:08:25.847
> 
> 标签：jquery-ui, jquery-ui-autocomplete

问题：我必须根据它们的值在小下拉列表中为我的结果着色。

解决方案：使用 'open' 事件挂钩循环选项并分配颜色。

问题：所以 jQuery UI 自动完成的文档说打开事件挂钩接收两个参数 - 'ui' 和 'event'。问题是，'ui' 只是一个空对象（有人对此提交了错误报告，出色的 jQuery UI 团队说这不是问题），而 'event' 只有输入框，而不是生成的下拉列表。在这一点上，我可以从这里选择我的选项列表的唯一方法是这样做：

```
$( event.target ).nextUntil("ul.ui-autocomplete").last().next() 
```

真恶心。请告诉我有更好的方法吗？

PS：如果有人说“只需使用 $('ul.ui-autocomplete')！” 你显然从来没有做过比……更复杂的事情。这并不复杂。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T23:04:42.473

官方文档很糟糕，但经过大量探索后我发现了：

```
$(event.target).data('autocomplete').menu.element 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T15:04:08.650

你在写插件吗？你可以使用 this.element

# c++ - C ++虚拟方法不起作用

> ID：10820974
> 
> 赞同：3
> 
> 时间：2012-05-30T17:08:35.460
> 
> 标签：c++, function, inheritance, methods, virtual

给定以下示例：

```
class BaseClass
{
  BaseClass()
  {
  };

  virtual ~BaseClass()
  {
    this->Cleanup();
  };

  virtual void Cleanup()
  {
    // Do cleanup here.
  };
};

class Level1DerivedClass : public BaseClass
{
  Level1DerivedClass()
  {
  };

  virtual ~Level1DerivedClass()
  {
  };

  virtual void Cleanup()
  {
    // Call my base cleanup.
    BaseClass::Cleanup();

    // Do additional cleanup here.
  };
};

class Level2DerivedClass : public Level1DerivedClass
{
  Level2DerivedClass()
  {
  };

  ~Level2DerivedClass()
  {
  };

  void Cleanup()
  {
    // Call my base cleanup.
    Level1DerivedClass::Cleanup();

    // Do additional cleanup here.
  };  
};

main()
{
  Level2DerivedClass * derived2 = new Level2DerivedClass();
  delete derived2;
  return 0;
} 
```

当我删除派生类引用时，我希望**流程**如下：

1.  *执行Level2DerivedClass*析构函数。
2.  因为*Level1DerivedClass*析构函数是虚拟的，所以它会被执行。
3.  因为*BaseClass*析构函数是虚拟的，所以它会被执行。
4.  因为*BaseClass::Cleanup*和*Level1DerivedClass::Cleanup*都是虚拟的，所以从*BaseClass析构函数中的**BaseClass* 'this' 指针的调用将执行最派生类 - *Level2DerivedClass::Cleanup*的实现。
***   *Level2DerivedClass::Cleanup*调用其父级的*Cleanup*实现。*   *Level1DerivedClass::Cleanup*调用其父级的*Cleanup*实现。**

 **正在发生的事情是它以我期望的方式为每个继承级别（1-3）调用析构函数。但是当从*BaseClass析构函数调用**this->Cleanup()*时，它只执行自己的实现。我不明白为什么会发生这种情况，因为通常当您实例化派生类指针，将其转换为基类指针并从基类指针调用虚拟方法（在本例中为“this”）时，它仍然运行派生类实现（“虚拟”的全部意义，是吗？）。在我的示例中，*Level2DerivedClass::Cleanup*和*Level1DerivedClass::Cleanup*永远不会被调用。

 ***我以这种方式设置它的原因是我希望能够调用我的清理代码而不必破坏我的对象，这就是我从实际的析构函数体中抽象它的原因。

如果您对更合适的方法有建议，我会全力以赴。但我也想解释为什么我的设置不起作用 - 我误解了什么？

提前感谢您的宝贵时间。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-30T17:10:46.517

经验法则是：[*永远不要在构造或破坏期间调用虚函数*](http://www.artima.com/cppsource/nevercall.html)。

他们的行为不像你想象的那样；随着每个析构函数完成，动态类型`this`被有效地修改。来自 C++ 标准中的 [class.cdtor]：

> 当从构造函数（包括非静态数据成员的 mem-initializer 或大括号或等式初始化器）或从析构函数直接或间接调用虚函数时，调用适用的对象是对象在构造或析构中，调用的函数是在构造函数或析构函数自己的类或其基类之一中定义的函数，但不是在从构造函数或析构函数的类派生的类中覆盖它的函数，或在其中一个类中覆盖它的函数最派生对象的其他基类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T17:32:56.273

正确的做事方式是：*在析构函数中清理自己，并且只清理自己*。不要在你的孩子或你的父母之后打扫卫生。

如果你想清理*不是*从析构函数中的东西，你做错了。在 C++ 中，我们有一个叫做 RAII 的小东西，资源获取就是初始化。但也有它的双重属性，它似乎没有一个正式的名称，但这里有一些可行的方法：RDID，资源处置就是破坏。

当然，您不必遵守 RAII/RDID 理念，但这不是 C++ 方式。*****

# ruby-on-rails - 如何将来自多个模型的数据添加到同一个视图（Rails 3.2）

> ID：10820979
> 
> 赞同：0
> 
> 时间：2012-05-30T17:09:14.703
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我试图弄清楚如何让来自多个模型的数据在我的视图中显示在同一个日历上。现在它正在显示生日，但我也很想添加周年纪念日和假期（目前只是列表中的列表）.. *为了清晰起见，去除了不必要的格式

[https://github.com/watu/table_builder](https://github.com/watu/table_builder)

用户/show.html.erb

```
 <% if @user.friends.any? %>
    <h3>Upcoming Birthdays</h3>
    <div id="calendar">
        <h2 id="month">
         <%= link_to "<", :month => (@date.beginning_of_month-1).strftime("%Y-%m") %>
         <%=h @date.strftime("%B %Y") %>
         <%= link_to ">", :month => (@date.end_of_month+1).strftime("%Y-%m") %>
        </h2>
                    <%= calendar_for @friends, :year => @date.year, :month => @date.month do |calendar| %>
                     <%= calendar.head('mon', 'tue', 'wed', 'thu', 'fri', 'sat', 'sun') %>
                      <%= calendar.day(:day_method => :dob) do |date, friends| %>
                       <%= date.day %>
                        <ul>
                            <% friends.each do |friend| %>
                            <li> <%= link_to h(friend.name), friends %><%= "\'s birthday"%></li>
                         <% end %>
                        </ul>
                    <% end %>
                <% end %>
    </div>
    <% end %>

    <% if @user.holidays.any? %>
    <h3>Upcoming Holidays</h3>
    <% @user.holidays.each do |hld| %>
      <td><%= hld.name %></td>
      <td><%= hld.date %></td>
    <% end %>
    </tbody>
    </table> 
```

楷模

```
class User < ActiveRecord::Base
  has_many :friends
  has_many :user_holidays
  has_many :holidays, :through => :user_holidays
  has_many :anniversaries

class Holiday < ActiveRecord::Base
  attr_accessible :name, :date
  has_many :user_holidays
  has_many :users, :through => :user_holidays

end

class UserHoliday < ActiveRecord::Base
  attr_accessible :holiday_id, :user_id
  belongs_to :user
  belongs_to :holiday
end

class Anniversary < ActiveRecord::Base
  belongs_to :user
  attr_accessible :anniversary_date, :spouse_name, :anniversaries, :interest_ids
  has_many :person_interests, :as => :person
  has_many :interests, :through => :person_interests
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T17:21:58.667

视图并没有阻止它使用来自其他模型的数据。您只需要确保控制器操作以某种方式将其传递给视图。您当前正在传递一个`@date`对象和一个`@user`对象；如果你想要其他对象，你也应该设置它们。我建议您通过`@user`对象使这些对象可访问，也就是说您应该为 User 创建实例方法，以便您可以在视图中访问它们

```
class User

  def birthdays
    ...
  end

  def anniversaries
    ...
  end

  def holidays
    ...
  end
end 
```

然后在您看来，您可以简单地调用`@user.birthdays`etc 等。

# macos - Dylibs 和 OS X

> ID：10820981
> 
> 赞同：5
> 
> 时间：2012-05-30T17:09:18.400
> 
> 标签：macos, boost, homebrew, dylib, vowpalwabbit

我正在尝试在 mac os x 中运行一个名为 vowpal-wabbit（6.0 版）的程序。

我用自制软件安装了一些东西，比如 lib 工具，重要的是，boost。

然而——我发现，即使

```
/usr/local/Cellar/boost/1.49.0/lib 
```

显然有所有的 boost 库，（包括 lib boost_program_options.dylib）...

尝试运行二进制文件时收到的错误消息是：

```
dyld: Library not loaded: libboost_program_options.dylib 
```

运行“make”以从头开始构建此二进制文件时，我得到相同的（基本上）错误：

```
ld: library not found for -lboost_program_options 
```

所以......我想我的问题是：我怎样才能让我编译的二进制文件“看到” libboost_program_options.dylib ？或者……我怎样才能让 vw（6.0 版）在 os x lion 上运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T15:24:43.537

我猜这`/usr/local/Cellar/boost/1.49.0/lib`不在任何一个`DYLD_LIBRARY_PATH`或`DYLD_FALLBACK_LIBRARY_PATH`. 您可以在您的环境中导出其中任何一个，或者您可以将 Boost 库从`/usr/local/lib`.

但请注意不要清除 的内容`DYLD_FALLBACK_LIBRARY_PATH`！在`dyld`手册页中，默认值为`$(HOME)/lib:/usr/local/lib:/lib:/usr/lib`.

# c# - 如何在 Telerik RadGrid 中处理空值（在列中）？（替换为 HTML）

> ID：10820982
> 
> 赞同：1
> 
> 时间：2012-05-30T17:09:21.083
> 
> 标签：c#, asp.net, null, telerik, radgrid

我的 Telerik RadGrid 中有一个 BooundColumn，如下所示：

```
 <telerik:GridBoundColumn DataField="Status" FilterControlAltText="Filter Status column"
                        HeaderText="Status" SortExpression="Status" UniqueName="Status"
                        FilterImageToolTip="Filter">
                        <HeaderStyle HorizontalAlign="Center" VerticalAlign="Middle" />
                        <ItemStyle HorizontalAlign="Center" VerticalAlign="Middle" />
                    </telerik:GridBoundColumn> 
```

我的 sql server 2008 数据库中的状态列可以接受空值，而 RadGrid 用空字符串显示它们。
我怎样才能`Empty Strings`用a 替换这些`Colorable Strings`？
意思是用这样的东西替换->`<span style='color: red;'>Empty</span>` 我知道我可以像这样将 BoundColumn 转换为 TemplateColumn ：

```
 <telerik:GridTemplateColumn FilterControlAltText="Filter TemplateColumn_Status column"
                            HeaderText="Status" UniqueName="TemplateColumn_Status" FilterImageToolTip="Filter"
                            ReadOnly="False" Visible="False">
                            <ItemTemplate>
                                <asp:Label ID="lblStatusInsideGrd" runat="server" Font-Size="11px" Text='<%# (bool)Convert.IsDBNull(Eval("Status")) ? "<span class=\"lblInsideGrd\">Empty</span>" : Eval("Status") %>'></asp:Label>
                            </ItemTemplate>
                            <HeaderStyle HorizontalAlign="Center" VerticalAlign="Middle" />
                            <ItemStyle HorizontalAlign="Center" VerticalAlign="Middle" />
                        </telerik:GridTemplateColumn> 
```

这个替换是个好主意，效果很好。但是这样做我`Filering`在这个专栏上失去了 RadGrid。
你能告诉我另一种保持 RadGrid Friltering 的方法吗？

提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T17:42:04.553

您可以在 ItemDataBound 事件上执行此操作，当网格绑定到 SqlDataSource 时，您可以获得当前的 DataRow ：

**更新**：我只留下了适用于 DataRow 的代码，并修复了列背景设置

```
public void TestGrid_ItemDataBound(Object sender, Telerik.Web.UI.GridItemEventArgs e)
{
  if (e.Item is GridDataItem)
  {
    if (e.Item.DataItem is DataRowView)
    {
      GridDataItem gdItem = (GridDataItem)e.Item;
      DataRow rw = ((DataRowView)e.Item.DataItem).Row;
      if (rw.IsNull("Status"))
      {
        GridColumn urlColumn = TestGrid.MasterTableView.Columns.FindByUniqueName("Status");
        gdItem.Cells[urlColumn.OrderIndex].BackColor = Color.Red;
        gdItem["Status"].Text = "Empty";
      }
    }
  }
} 
```

**由提问者编辑**
真的感谢这些代码。
下面的代码对我来说没问题：

```
protected void grdSMS_ItemDataBound(object sender, GridItemEventArgs e)
{
    if (e.Item is GridDataItem)
    {
        GridDataItem item = (GridDataItem)e.Item;
        if (item["Status"].Text == "&nbsp;")
        {
            item["Status"].ForeColor = Color.Red;
            item["Status"].Text = "Empty";
        }
    }
} 
```

# node.js - 如何基于服务器和客户端向 Dust.js 添加上下文帮助器

> ID：10820985
> 
> 赞同：1
> 
> 时间：2012-05-30T17:09:32.050
> 
> 标签：node.js, dust.js

我正在使用 Dust.js 和 Node/Express。Dust.js 记录了上下文助手函数，其中助手作为函数嵌入到模型数据中。我在服务器的 JSON 数据模型中添加了这样一个函数，但是对浏览器的 JSON 响应没有函数属性（即从下面的模型中，prop1 和 prop2 被返回，但 helper 属性没有。

```
/* JSON data */
model: {
    prop1: "somestring",
    prop2: "someotherstring",
    helper: function (chunk, context, bodies) {
        /* I help, then return a chunk */
    }
/* more JSON data */ 
```

我看到 JSON.stringify（从 response.json() 调用）正在删除函数属性。不确定我是否可以避免使用 JSON.stringify 所以需要在服务器/客户端之间共享这个辅助函数的替代方法。可能有一种方法可以将辅助函数添加到服务器和客户端的灰尘库中。这就是我要找的。由于 Dust 文档很少，因此没有记录。此外，我找不到任何可以证明这一点的代码片段。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T06:53:12.093

将您的助手发送到一个单独的文件中 - 在灰尘中的基本上下文中定义它们，如下所示：

```
base = dust.makeBase({foo:function(){ code goes here }}) 
```

然后每次调用模板时，请执行以下操作：

```
dust.render("index", base.push({baz: "bar"}), function(err, out) {
  console.log(out);
}); 
```

这基本上所做的是将模板的上下文合并到基础中，这就像“全局”上下文。如果你推送太多，不要太担心会破坏基础 - 每次推送时，base 都会使用你提供的上下文和全局上下文重新创建一个新上下文 - 助手和你在调用 makeBase 时定义的任何变量。

希望这可以帮助

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-30T19:20:36.927

如果要 stringify 保留函数，可以使用以下代码。

```
JSON.stringify(model, function (key, value) {
  if (typeof(value) === 'function') {
    return value.toString();
  } else {
    return value;
  }
}); 
```

这可能不会做你想要的。您很可能需要在客户端重新定义函数或使用类似 nowjs 的技术。

# c# - 如何在 WPF 中创建 KeyEventArgs 对象（与 SO 答案相关）

> ID：10820990
> 
> 赞同：30
> 
> 时间：2012-05-30T17:10:07.433
> 
> 标签：c#, wpf

我发现这个答案看起来像我需要的：

[如何以编程方式在 C# 中生成按键事件？](https://stackoverflow.com/questions/1645815/how-can-i-programmatically-generate-keypress-events-in-c/1646568#1646568)

除了我不能创建一个实例`KeyEventArgs`（我不知道怎么做）

有问题的代码是：

```
 var key = Key.Insert;                    // Key to send
  var target = Keyboard.FocusedElement;    // Target element
  var routedEvent = Keyboard.KeyDownEvent; // Event to send

  target.RaiseEvent(
    new KeyEventArgs(
      Keyboard.PrimaryDevice,
      PresentationSource.FromVisual(target), //<--- HERE, I can't
      0,
      key)
    { RoutedEvent=routedEvent }
  ); 
```

编译器说：

```
The best overloaded method match for
'System.Windows.PresentationSource.FromDependencyObject(System.Windows.DependencyObject)'
 has some invalid arguments 
```

ide 说：

参数类型`IInputElement`不可分配给参数类型`DependencyObject`

在 StackOverflow 中，我找到了几个针对该答案的答案，但没有一个解决了如何首先创建实例的问题。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-05-30T17:25:26.363

呸呸呸

我找到了：`Keyboard.PrimaryDevice.ActiveSource`必须使用

```
InputManager.Current.ProcessInput(
    new KeyEventArgs(Keyboard.PrimaryDevice,
        Keyboard.PrimaryDevice.ActiveSource,
        0, Key.Tab)
    {
       RoutedEvent = Keyboard.KeyDownEvent
    }
); 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2015-03-14T21:56:45.207

与 Bill Tarbell 的回答类似，您还可以创建一个虚拟[System.Windows.Interop.HwndSource](https://msdn.microsoft.com/en-us/library/system.windows.interop.hwndsource(v=vs.110).aspx)，如下所示：

```
var kea = new KeyEventArgs(
    Keyboard.PrimaryDevice, 
    new HwndSource(0, 0, 0, 0, 0, "", IntPtr.Zero), // dummy source
    0, 
    key); 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2014-03-27T07:02:13.733

如果有人试图创建 KeyEventArgs 以用于**单元测试**，您会发现 Keyboard.PrimaryDevice.ActiveSource 为 null .. 并在您尝试使用它时引发异常。

模拟 PresentationSource 是一个可行的解决方案（需要 sta）：

```
[Test]
[RequiresSTA]
public void test_something()
{
  new KeyEventArgs(
    Keyboard.PrimaryDevice,
    new Mock<PresentationSource>().Object,
    0,
    Key.Back);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-12-18T11:38:58.477

要对视图模型进行**单元测试**，我必须结合使用 OscarRyz 和 Elijah W. Gagne 的答案来完成这项工作。

```
 [TestMethod]
    public void method_event_expected()
    {
        this.objectUnderTest.TestMethod(
            new KeyEventArgs(Keyboard.PrimaryDevice, new HwndSource(0, 0, 0, 0, 0, "", IntPtr.Zero), 0, Key.Oem3)
            {
                RoutedEvent = Keyboard.KeyDownEvent
            });

        Assert.IsTrue(...)
    } 
```

Keyboard.PrimaryDevice.ActiveSource 是空的，所以我不得不用一个虚拟窗口来伪造它，然后我还需要分配 RoutedEvent。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2017-06-28T00:11:59.327

```
var kea = new KeyEventArgs(
    Keyboard.PrimaryDevice,
    new HwndSource(0, 0, 0, 0, 0, "", IntPtr.Zero),
    0,
    Key.Enter)
    {
        RoutedEvent = UIElement.KeyUpEvent
    }; 
```

# jquery - jquery改变图片路径

> ID：10820991
> 
> 赞同：1
> 
> 时间：2012-05-30T17:10:09.257
> 
> 标签：jquery, function, time, image, attr

由于在不同浏览器中让背景延伸到整个页面的问题，我不得不使用带有图像的 div 来覆盖页面。

我想要做的是让这个图像根据一天中的时间而改变。当我在 CSS 中使用更传统的 background-image 属性时，它工作得很好，但是我在将其转换为更改图像的 src 属性时遇到了问题。

图片的id是#bg。我可能会犯语法错误，但任何帮助都会很棒，谢谢！

```
$('document').ready(function(){

 var hours = getDayTime(new Date().getHours());

if (hours > 20 || hours < 5) {
    $('#page-background > img').prop('src', 'backgrounds/night.jpg')
}    

else if (hours > 17) {
    $('#page-background > img').prop('src', 'backgrounds/dusk.jpg')
}    

else if (hours > 8) {
    $('#page-background > img').prop('src', 'backgrounds/day.jpg')
}

else { 
    $('#page-background > img').prop('src', 'backgrounds/dawn.jpg')
}
});

<div id="page-background"><img src="backgrounds/day.jpg" width="100%" height="100%" alt="" id="bg" /></div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T17:11:26.127

```
$('#bg img').attr('src', 'backgrounds/night.jpg') 
```

应该只是

```
$('#bg').prop('src', 'backgrounds/night.jpg') 
```

由于您`id`已经指定了图像的 ，因此无需包含`img`. 并且[`.prop()`](http://api.jquery.com/prop/)比`attr()`jQuery 1.6更受欢迎

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T17:12:06.733

如果它是 ：

```
<img src="someimage.jpg" id="bg" /> 
```

然后是：

```
$('#bg').attr('src', 'backgrounds/night.jpg') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T17:13:43.920

这是针对您的问题的另一个更实用的解决方案：

```
$("#bg").attr("src", function(i, value) {
    var src = "backgrounds/";

    if (hours > 20 || hours < 5) src += "night.jpg";
    else if (hours > 17) src += "dusk.jpg";
    else if (hours > 8) src += "day.jpg";
    else src += "dawn.jpg";

    return src;
}); 
```

是的，你必须使用`#bg`选择器，因为这是图像本身。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-30T17:14:22.923

```
$('#bg').attr('src', function() {
    var src = 'backgrounds/dawn.jpg';
    if (hours > 20 || hours < 5) {
        src = 'backgrounds/night.jpg';
    } else if (hours > 17) {
        src = 'backgrounds/dusk.jpg';
    } else if (hours > 8) {
        src = 'backgrounds/day.jpg';
    }
    return src;
}) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-30T17:11:26.200

你可能应该使用

```
$('#bg') 
```

代替

```
$('#bg img') 
```

在第二种情况下，您将选择元素#bg 下的所有IMG 元素。

# jquery - 将 jQuery Tipsy 对齐到元素的左边缘

> ID：10820998
> 
> 赞同：1
> 
> 时间：2012-05-30T17:10:43.493
> 
> 标签：jquery, tipsy

我正在使用[jQuery Tipsy 插件](http://onehackoranother.com/projects/jquery/tipsy/)在我的项目中创建工具提示。工具提示会自动以元素为中心，如插件页面演示中所见，但我希望它与元素的左侧对齐，有人知道这样做的方法吗？该插件在显示时会自动设置工具提示的绝对位置，我尝试更改此功能但没有运气。

**更新 1**：我非常了解文档和`gravity`选项，我希望将工具提示箭头居中到其相应元素的**左边缘**。

**更新 2**：这是我希望如何放置工具提示的模型： ![左：当前，右：预期](../Images/34de87e71767f8700f46d4cab4fa90f7.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T20:44:34.537

找到解决方案，我正在编辑错误的功能。事实证明，还有另一个专门针对“NW/SW”重力的功能，更新了 JS：

```
 if (gravity.length == 2) {
                if (gravity.charAt(1) == 'w') {
                    tp.left = pos.left - 5;
                } else {
                    tp.left = pos.left + pos.width / 2 - actualWidth + 15;
                }
            } 
```

我将在 Git 上 fork 以防其他人需要此功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T18:37:04.753

您应该能够根据重力选项设置位置：

```
$('#foo').tipsy({gravity: 'e'});  // these are coordinates: // nw | n | ne | w | e | sw | s | se 
```

可以在此页面上找到有关插件选项的信息。有关更多信息或其他配置选项，请参见重力部分。

[http://onehackoranother.com/projects/jquery/tipsy/#](http://onehackoranother.com/projects/jquery/tipsy/#)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-07-08T14:47:18.953

感谢@Ryan 的回答，这正是我想要的。我对您的代码更进一步，并提供了更多功能。

我为 Tipsy 添加了 2 个新选项，以便它执行以下操作：

*   在`sw`/`nw`上，您可以使用`edgeAlignWest: 'right'`或`edgeAlignWest: 'center'`
*   在`se`/`ne`上，您可以使用`edgeAlignEast: 'left'`或`edgeAlignEast: 'center'`

执行此操作的新代码是

```
// line 61, tipsy version 1.0.0a
if (gravity.length == 2) {
    if (gravity.charAt(1) == 'e') {
        tp.left = (this.options.edgeAlignEast == 'right') ? (pos.left + pos.width - actualWidth + 15) : (pos.left + pos.width / 2 - actualWidth + 15);
    }else if (gravity.charAt(1) == 'w') {
        tp.left = (this.options.edgeAlignWest == 'left') ? (pos.left - 5) : (pos.left + pos.width / 2 - 15);
    } else {
      tp.left = pos.left + pos.width / 2 - actualWidth + 15;
  }
}

//...
// line 191, tipsy version 1.0.0a
$.fn.tipsy.defaults = {
    edgeAlignEast: 'center',  // <-- new option, default to 'center', you can also use 'right'
    edgeAlignWest: 'center',  // <-- new option, default to 'center', you can also use 'left'
    className: null,
    delayIn: 0,
    delayOut: 0,
    fade: false,
    fallback: '',
    gravity: 'n',
    html: false,
    live: false,
    offset: 0,
    opacity: 0.8,
    title: 'title',
    trigger: 'hover'
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-30T20:23:38.430

查看源代码（第 43 行），

我发现这个，

```
case 'n':
tp = {top: pos.top + pos.height + this.options.offset, left: pos.left + pos.width / 2 - actualWidth / 2}; 
```

我想改变`left`应该可以解决问题。