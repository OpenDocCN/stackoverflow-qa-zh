# StackOverflow 问答 000289000-000289999

# mysql - MySQL 是否索引 NULL 值？

> ID：289001
> 
> 赞同：71
> 
> 时间：2008-11-14T01:46:59.467
> 
> 标签：mysql, indexing, null

我有一个 MySQL 表，其中`INT`90% 的行的索引列将为 0。如果我将这些行更改为使用`NULL`而不是 0，它们是否会被排除在索引之外，从而使索引缩小约 90%？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-05-19T17:32:04.563

[http://dev.mysql.com/doc/refman/5.0/en/is-null-optimization.html](http://dev.mysql.com/doc/refman/5.0/en/is-null-optimization.html)

MySQL 可以对其`col_name IS NULL`用于`col_name = constant_value`. 例如，MySQL 可以使用索引和范围来搜索`NULL`with `IS NULL`。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-14T01:52:30.347

看起来它也索引了`NULL`s 。

> 运行此命令时要小心，因为 MySQL 在创建索引期间会为 WRITES 锁定表。即使列为空（全为空），在大型表上构建索引也可能需要一段时间。

[参考](http://dev.mysql.com/doc/refman/5.0/en/create-index.html)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-14T10:45:04.047

允许列为空将增加一个字节到列的存储要求。这将导致索引大小增加，这可能不好。也就是说，如果您的许多查询更改为使用“IS NULL”或“NOT NULL”，它们可能比进行值比较总体上更快。

我的直觉会告诉我不为空，但有一个答案：测试！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-14T02:22:10.647

不，它将继续包括它们，但不要对任何一种情况的后果做出太多假设。很大程度上取决于其他值的范围（谷歌为“基数”）。

对于这种情况，MSSQL 有一种称为“过滤索引”的新索引类型（即基于过滤器在索引中包含记录）。dBASE 类型的系统过去也有类似的功能，而且非常方便。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-08-26T15:19:50.120

每个索引都有一个基数，表示索引了多少不同的值。AFAIK说索引对许多行重复相同的值不是一个合理的想法，但索引只会将重复值寻址到许多行的聚集索引（该字段具有空值的行）并保持聚集索引的参考ID意思是：每行具有 NULL 值索引字段会浪费与 PK 一样大的大小（因此，如果您有复合 PK，专家建议使用合理的 PK 大小）。

# c# - 如何从静态类引发自定义事件

> ID：289002
> 
> 赞同：57
> 
> 时间：2008-11-14T01:47:39.343
> 
> 标签：c#, asp.net

我有一个静态类，我想在该类的静态方法中引发一个事件作为 try catch 块的一部分。

例如，在这个方法中，我想在 catch 中引发一个自定义事件。

```
public static void saveMyMessage(String message)
{
    try
    {
        //Do Database stuff
    }
    catch (Exception e)
        {
              //Raise custom event here
        }
} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2008-11-14T06:23:38.147

重要提示：从实例订阅静态事件时要非常小心。静态到静态很好，但是从静态事件到实例处理程序的订阅是一种很好的（阅读：非常危险的）方法来保持该实例永远活着。GC 将看到该链接，并且不会收集实例，除非您取消订阅（或使用类似 WeakReference 的东西）。

创建静态事件的模式与实例事件相同，只是`static`：

```
public static event EventHandler SomeEvent; 
```

为了让生活更轻松（重新检查 null），这里一个有用的技巧是添加一个简单的处理程序：

```
public static event EventHandler SomeEvent = delegate {}; 
```

然后你可以简单地调用它而不进行空检查：

```
SomeEvent(null, EventArgs.Empty); 
```

请注意，因为委托实例是不可变的，并且取消引用是线程安全的，所以这里从来没有竞争条件，也不需要锁定......当我们取消引用被调用时，谁订阅了。

（调整您自己的事件参数等）。这个技巧同样适用于实例事件。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-14T02:10:11.217

您的事件也需要是静态的：

```
public class ErrorEventArgs : EventArgs
{
    private Exception error;
    private string message;

    public ErrorEventArgs(Exception ex, string msg)
    {
        error = ex;
        message = msg;
    }

    public Exception Error
    {
        get { return error; }
    }

    public string Message 
    {
        get { return message; }
    }
}

public static class Service
{
    public static EventHandler<ErrorEventArgs> OnError;

    public static void SaveMyMessage(String message)
    {
            EventHandler<ErrorEventArgs> errorEvent = OnError;
        if (errorEvent != null)
        {
            errorEvent(null, new ErrorEventArgs(null, message));
        }
    }
} 
```

和用法：

```
public class Test
{
   public void OnError(object sender, ErrorEventArgs args)
   {
        Console.WriteLine(args.Message);
   }
 }

 Test t = new Test();
 Service.OnError += t.OnError;
 Service.SaveMyMessage("Test message"); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-14T06:20:58.137

有几个人提供了代码示例，只是不要使用以下代码触发事件：

```
if(null != ExampleEvent)
{
  ExampleEvent(/* put parameters here, for events: sender, eventArgs */);
} 
```

因为这包含在您检查事件是否为 null 和实际触发事件之间的竞争条件。而是使用一个简单的变体：

```
MyEvent exampleEventCopy = ExampleEvent;
if(null != exampleEventCopy)
{
  exampleEventCopy(/* put parameters here, for events: sender, eventArgs */);
} 
```

这会将任何事件订阅者复制到 exampleEventCopy，然后您可以将其用作公共事件的仅限本地版本，而不必担心任何竞争条件（本质上，另一个线程可能会在您之后抢占您已检查公共事件是否为 null 并继续从事件中删除所有订阅者，从而导致事件的后续触发引发异常，通过使用仅本地副本，您可以避免另一个线程删除订阅者的可能性，因为存在他们无法访问局部变量）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T02:09:32.557

注：VS2008，C#

只需像往常一样在静态类中声明一个事件，但一定要将事件标记为静态：

```
public static event EventHandler Work; 
```

然后像往常一样订阅它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-18T05:28:05.173

只需添加“委托是不可变的”因此，如上例所示，以下行获取委托的副本。

```
EventHandler<ErrorEventArgs> errorEvent = OnError; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-12-12T03:41:18.423

我这样做的方式如下：

1-定义一个委托（这将使您能够自定义参数）：

```
public delegate void CustomeEventHandler(string str); 
```

2-根据之前定义的委托定义一个事件：

```
public static event CustomeEventHandler ReadLine; 
```

3-创建一个事件处理程序：

```
static void OnLineRead(string currentLine)
        {
            if (ReadLine != null)
                ReadLine(currentLine);
        } 
```

4-使用事件处理程序引发您的事件（只需在您希望引发事件的任何地方调用它）。

# .net - 在 asp.net 1.1 和 IE7 中设置 Response.ContentType="image/tiff" 不显示 tif 文件

> ID：289003
> 
> 赞同：0
> 
> 时间：2008-11-14T01:47:39.717
> 
> 标签：.net, asp.net, internet-explorer-7, tiff, asp.net-1.1

我有一个 Asp.Net 1.1 应用程序，它使用以下代码将图像文件写入弹出网页。

```
 Response.ContentType="image/tiff"   'Only for Tif files
    Dim objStream As Object
    objStream = Server.CreateObject("ADODB.Stream")
    objStream.open()
    objStream.type = 1
    objStream.loadfromfile(localfile)
    Response.BinaryWrite(objStream.read) 
```

我正在使用 TIF 文件对此进行测试。这些文件在 IE6 和 Safari 中正确显示，但在 IE7 中它们没有显示，并且似乎没有任何内容返回到网页。带有 jpg、gif 扩展名的文件可以正常显示。这里可能有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T19:24:37.367

嗯，这取决于你的听众。但理想情况下，为了支持旧版浏览器，您不应假设它们可以处理 TIFF。

至少，加载 TIFF，选择第一帧（页面），将 DrawImage 绘制到新的位图中，将位图以 JPG 格式保存到内存流中，然后将其发送到 Response。

如果您不熟悉 .NET 的 GDI+ 图像处理或听起来很难，请参阅[https://web.archive.org/web/20141230145656/http://bobpowell.net/faqmain.aspx](https://web.archive.org/web/20141230145656/http://bobpowell.net/faqmain.aspx)获取建议。只需几行代码即可完成这些步骤中的每一个。如果您还不了解 GDI+，那么对于任何 Web 开发人员来说都是值得学习的。这可能会使这种“艰难（但安全）的方式”仅仅为了教育而值得。如果您已经知道如何操作，则只需 1/2 小时。

如果您必须显示多页 TIFF，并且希望用户控制查看哪些页面，则必须创建一个用户界面来设置页码。如果您尝试在每页显示多个 TIFF，这可能会变得很重要，因此请考虑在第一个网页上显示所有 tiff #1 页面，或者允许他们通过链接到另一个网页来查看后续 tiff 页面上一个/下一个 tiff 页面按钮。它应该是一个通用页面，接受文件名和当前页码（上一个/下一个按钮将指向自身，带有 +/- 一个页码）作为 URL 参数。

如果您知道您将只显示文本文档而不是照片，请尝试将单帧 GIF 而不是 TIFF 发送到浏览器，以减少文本上的 Jpegginess。但事先警告 - 照片可能看起来很糟糕的 GIF。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T01:54:34.803

您是否尝试将[Content-Disposition](http://www.ietf.org/rfc/rfc2183.txt)设置为内联？

```
Response.AppendHeader("Content-Disposition", "inline"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T02:05:12.987

是的，刚才试过了。不工作。这与 tiff 有 4 个字母而不是 3 个有关吗？我在某处读到 IE7 不支持 4 个字母扩展名。

# asp.net - ObjectDataSource 和对象集合

> ID：289004
> 
> 赞同：0
> 
> 时间：2008-11-14T01:47:40.137
> 
> 标签：asp.net, c#-3.0, objectdatasource

我有一个想要绑定到 ObjectDataSource 的 GridView。我有一个具有许多属性的业务对象的 ReadOnlyCollection。我只需要在 GridView 中显示其中四个属性。我之前没有使用过 ObjectDataSource 控件，那么如何使用它来显示我的 ReadOnlyCollection 中所有业务对象的 4 个属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T01:57:04.987

假设您有一个具有两个属性的对象列表：名称和年龄：

```
<asp:GridView ID="gvwExample" runat="server" AutoGenerateColumns="False" 
  DataSourceId="myObjectDataSource">
  <columns>
    <asp:BoundField DataField="Name" HeaderText="Name" />
    <asp:BoundField DataField="Age" HeaderText="Age" />
  </columns>
</asp:GridView> 
```

如果您要对任何源进行数据绑定并且不希望每行数据的每个值都可以做同样的事情。

# sharepoint - 如何从控制台应用程序实例化 SPWeb 对象？

> ID：289006
> 
> 赞同：3
> 
> 时间：2008-11-14T01:49:11.337
> 
> 标签：sharepoint, wss

我正在尝试编写一个控制台应用程序，它只是列出了共享点根目录的数量。

我尝试使用以下代码来执行此操作，但对象 SPContext.Current 为空。关于如何获取网络对象的任何想法？

```
 SPWeb web = SPContext.Current.Site.OpenWeb("http://localhost") ; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-14T06:48:42.200

只需在 Nat 的帖子中添加一点内容：
即使它不像在 SharePoint WebApp 中那样重要，仍然建议处理所有 SPWeb 和 SPSite 对象。
所以一定要养成好习惯：

```
using (SPSite site = new SPSite(weburl))
{
    using (SPWeb web = site.OpenWeb())
    {
        // bla bla
    }
} 
```

注意：您可以直接将 weburl 传递给 SPSite 构造函数，因此 OpenWeb 将打开给定的 web。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-14T01:59:17.227

```
SPSite spSite = new SPSite("http://myurl");
SPWeb spMySite = spSite.Allwebs["mysite"];
SPWeb spRootsite = spsite.RootWeb; 
```

控制台应用程序只会像往常一样在服务器上运行。此外，使用的 url [http://myurl](http://myurl)可以是页面的 url，并且将创建一个 SPSite 对象。例如[http://myurl/mysite/pages/default.aspx](http://myurl/mysite/pages/default.aspx)将获得一个有效的 SPSite 对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T17:54:35.007

您还可以通过其他几种方式使用 SPSite.OpenWeb() ......

如果您跟踪 SPWeb 对象的 GUID：

```
site.OpenWeb(webUid); 
```

使用 Web 的服务器或站点的相对 URL 或标题，请参阅[MSDN SPSite.OpenWeb(string)](http://msdn.microsoft.com/en-us/library/ms474633.aspx)了解更多详细信息：

```
site.OpenWeb(relativeUrl);
site.OpenWeb(title); 
```

使用精确的相对 URL 并避免 SPSite.OpenWeb(string) 使用的任何巧妙的东西：

```
site.OpenWeb(relativeUrl, true); 
```

# c# - C# List<> 按 x 然后 y 排序

> ID：289010
> 
> 赞同：88
> 
> 时间：2008-11-14T01:50:35.560
> 
> 标签：c#, .net, sorting

与[List<> OrderBy Alphabetical Order](https://stackoverflow.com/questions/188141/c-list-orderby-alphabetical-order)类似，我们希望先按一个元素排序，然后再按另一个元素排序。我们想要实现的功能等价于

```
SELECT * from Table ORDER BY x, y 
```

我们有一个包含许多排序函数的类，并且按一个元素排序没有问题。
例如：

```
public class MyClass {
    public int x;
    public int y;
}  

List<MyClass> MyList;

public void SortList() {
    MyList.Sort( MySortingFunction );
} 
```

我们在列表中有以下内容：

```
Unsorted     Sorted(x)     Desired
---------    ---------    ---------
ID   x  y    ID   x  y    ID   x  y
[0]  0  1    [2]  0  2    [0]  0  1
[1]  1  1    [0]  0  1    [2]  0  2
[2]  0  2    [1]  1  1    [1]  1  1
[3]  1  2    [3]  1  2    [3]  1  2 
```

稳定排序会更好，但不是必需的。欢迎使用适用于 .Net 2.0 的解决方案。

* * *

## 回答 #1

> 赞同：158
> 
> 时间：2008-11-14T01:57:08.637

对于可以使用 LINQ`OrderBy`和[`ThenBy`](http://msdn.microsoft.com/en-us/library/vstudio/bb534743(v=vs.100).aspx)（或`ThenByDescending`如果需要）的 .Net 版本：

```
using System.Linq;
....
List<SomeClass>() a;
List<SomeClass> b = a.OrderBy(x => x.x).ThenBy(x => x.y).ToList(); 
```

* * *

注意：对于 .Net 2.0（或者如果您不能使用 LINQ），请参阅[Hans Passant](https://stackoverflow.com/a/289040/477420)对这个问题的回答。

* * *

## 回答 #2

> 赞同：98
> 
> 时间：2008-11-14T02:07:10.830

请记住，如果比较所有成员，则不需要稳定的排序。根据要求，2.0 解决方案可能如下所示：

```
 public void SortList() {
     MyList.Sort(delegate(MyClass a, MyClass b)
     {
         int xdiff = a.x.CompareTo(b.x);
         if (xdiff != 0) return xdiff;
         else return a.y.CompareTo(b.y);
     });
 } 
```

请注意，这个 2.0 解决方案仍然优于流行的 3.5 Linq 解决方案，它执行就地排序并且没有 Linq 方法的 O(n) 存储要求。当然，除非您希望原始 List 对象保持不变。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-14T02:10:11.510

诀窍是实现稳定的排序。我创建了一个可以包含您的测试数据的 Widget 类：

```
public class Widget : IComparable
{
    int x;
    int y;
    public int X
    {
        get { return x; }
        set { x = value; }
    }

    public int Y
    {
        get { return y; }
        set { y = value; }
    }

    public Widget(int argx, int argy)
    {
        x = argx;
        y = argy;
    }

    public int CompareTo(object obj)
    {
        int result = 1;
        if (obj != null && obj is Widget)
        {
            Widget w = obj as Widget;
            result = this.X.CompareTo(w.X);
        }
        return result;
    }

    static public int Compare(Widget x, Widget y)
    {
        int result = 1;
        if (x != null && y != null)                
        {                
            result = x.CompareTo(y);
        }
        return result;
    }
} 
```

我实现了 IComparable，所以它可以被 List.Sort() 不稳定地排序。

但是，我还实现了静态方法 Compare，它可以作为委托传递给搜索方法。

[我从C# 411](http://www.csharp411.com/c-stable-sort/)借用了这种插入排序方法：

```
 public static void InsertionSort<T>(IList<T> list, Comparison<T> comparison)
        {           
            int count = list.Count;
            for (int j = 1; j < count; j++)
            {
                T key = list[j];

                int i = j - 1;
                for (; i >= 0 && comparison(list[i], key) > 0; i--)
                {
                    list[i + 1] = list[i];
                }
                list[i + 1] = key;
            }
    } 
```

你可以把它放在你在问题中提到的排序助手类中。

现在，要使用它：

```
 static void Main(string[] args)
    {
        List<Widget> widgets = new List<Widget>();

        widgets.Add(new Widget(0, 1));
        widgets.Add(new Widget(1, 1));
        widgets.Add(new Widget(0, 2));
        widgets.Add(new Widget(1, 2));

        InsertionSort<Widget>(widgets, Widget.Compare);

        foreach (Widget w in widgets)
        {
            Console.WriteLine(w.X + ":" + w.Y);
        }
    } 
```

它输出：

```
0:1
0:2
1:1
1:2
Press any key to continue . . . 
```

这可能会用一些匿名代表来清理，但我会留给你。

**编辑**：NoBugz 展示了匿名方法的力量......所以，考虑我的更多老派：P

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-12-02T06:52:03.247

这可能会对您有所帮助， [如何对 C# 通用列表进行排序](http://www.codedigest.com/Articles/CSHARP/84_Sorting_in_Generic_List.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-16T16:09:07.423

我遇到了一个问题，OrderBy 和 ThenBy 没有给我想要的结果（或者我只是不知道如何正确使用它们）。

我选择了一个类似这样的 list.Sort 解决方案。

```
 var data = (from o in database.Orders Where o.ClientId.Equals(clientId) select new {
    OrderId = o.id,
    OrderDate = o.orderDate,
    OrderBoolean = (SomeClass.SomeFunction(o.orderBoolean) ? 1 : 0)
    });

    data.Sort((o1, o2) => (o2.OrderBoolean.CompareTo(o1.OrderBoolean) != 0
    o2.OrderBoolean.CompareTo(o1.OrderBoolean) : o1.OrderDate.Value.CompareTo(o2.OrderDate.Value))); 
```

# multithreading - JDBC：我可以在多线程应用程序中共享连接，并享受良好的交易吗？

> ID：289029
> 
> 赞同：4
> 
> 时间：2008-11-14T02:00:39.720
> 
> 标签：multithreading, postgresql, jdbc, transactions

使用 JDBC 处理事务的经典方法似乎是将自动提交设置为 false。这将创建一个新事务，并且每次调用 commit 都标志着下一个事务的开始。在多线程应用程序上，我知道为每个线程打开一个新连接是常见的做法。

我正在编写一个基于 RMI 的多客户端服务器应用程序，因此基本上我的服务器为每个新连接无缝地生成一个线程。为了正确处理事务，我应该为每个线程创建一个新连接吗？这种架构的成本是不是太高了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-14T02:17:49.203

是的，通常您需要为每个线程创建一个新连接。您无法控制操作系统如何对线程的执行进行时间切片（尽管定义了您自己的关键部分），因此您可能会无意中让多个线程尝试通过该管道发送数据。

请注意，这同样适用于任何网络通信。例如，如果您有两个线程试图通过 HTTP 连接共享一个套接字。

*   线程 1 发出请求
*   线程 2 发出请求
*   线程 1 从套接字读取字节，无意中读取了线程 2 请求的响应

如果您将所有事务包装在关键部分中，因此在整个开始/提交周期中锁定任何其他线程，那么您可能能够在线程之间共享数据库连接。但即使那样我也不会这样做，除非你真的对 JDBC 协议有先天的了解。

如果您的大多数线程很少需要数据库连接（或根本不需要），您也许可以指定一个线程来完成您的数据库工作，并让其他线程将它们的请求排队到该线程。这将减少这么多连接的开销。但是你必须弄清楚如何在你的环境中管理每个线程的连接（或者在 StackOverflow 上询问另一个关于这个的具体问题）。

**更新：**要在评论中回答您的问题，大多数数据库品牌不支持单个连接上的多个并发事务（InterBase/Firebird 是我所知道的唯一例外）。

最好有一个单独的事务对象，并且能够在每个连接中启动和提交多个事务。但是供应商根本不支持它。

同样，标准的独立于供应商的 API（如 JDBC 和 ODBC）做出相同的假设，即事务状态仅仅是连接对象的一个​​属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T02:25:58.250

为每个线程打开一个新连接是不常见的做法。通常你使用像[c3po](http://sourceforge.net/projects/c3p0)库这样的连接池。

如果您在应用程序服务器中，或者例如使用 Hibernate，请查看文档，您将了解如何配置连接池。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-02T10:02:10.240

同一个连接对象可以用来创建多个语句对象，然后这些语句对象可以被不同的线程同时使用。大多数由 JDBC 连接的现代数据库都可以做到这一点。因此，JDBC 能够如下使用并发游标。PostgreSQL在这里也不例外，例如：

[http://doc.postgresintl.com/jdbc/ch10.html](http://doc.postgresintl.com/jdbc/ch10.html)

这允许连接池，其中连接只使用很短的时间，即创建语句对象，但之后返回池。仅当 JDBC 连接同时执行语句操作的并行化时才建议使用这种短时间池，否则正常的连接池可能会显示更好的结果。无论如何，线程可以继续使用语句对象并稍后关闭它，但不能关闭连接。

```
1\. Thread 1 opens statement   
3\. Thread 2 opens statement
4\. Thread 1 does something         Thread 2 does something
5\. ...                             ...
6\. Thread 1 closes statement       ...
                                7\. Thread 2 closes statement 
```

以上仅适用于自动提交模式。如果需要事务，则仍然不需要将事务绑定到线程。您可以将池划分为所有事务，并使用与上述相同的方法。但这不是因为某些套接字连接限制而是因为 JDBC 将会话 ID 等同于事务 ID 才需要这样做。

如果我没记错的话，应该有一些设计不那么简单的 API 和产品，其中会话 ID 和事务 ID 并不等同。在此 API 中，您可以使用单个数据库连接对象编写服务器，即使它执行事务也是如此。稍后需要检查并告诉您这些 API 和产品是什么。

# asp.net - 鼠标悬停在图像上的 HTML 超链接

> ID：289030
> 
> 赞同：0
> 
> 时间：2008-11-14T02:00:43.653
> 
> 标签：asp.net, html

我有一个 Html 超链接。我需要将此超链接链接到另一个页面。当我将鼠标放在链接上时。它应该显示图像。这该怎么做

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T02:10:31.247

这取决于您需要在哪里显示图像。如果您正在寻找链接旁边或后面的图标线条，您可以通过 CSS 使用链接悬停状态的背景图像来完成此操作：

```
a:link
{
   background-image:none;
}

a:hover
{
   background-image:url('images/icon.png');
   background-repeat:no-repeat;
   background-position:right;
   padding-right:10px /*adjust based on icon size*/
} 
```

我这样做是出于我的想法，所以你可能需要做一些小的调整。

如果您想在页面的其他位置显示图像，您可以使用 javascript 在链接的鼠标悬停事件中隐藏/显示图像来实现。

如果这不能解决您的问题，也许您可​​以提供一些额外的信息来帮助指导每个人找到正确的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T02:09:23.137

你可以使用javascript来做到这一点..

这将在 div 或元素悬停时创建一个跟随鼠标的正方形。

在此处创建包含这些内容的 .js 文件：

```
 var WindowVisible = null;
function WindowShow() { 
    this.bind = function(obj,url,height,width) {
        obj.url = url;
        obj.mheight = height;
        obj.mwidth = width;
        obj.onmouseover = function(e) {
            if (WindowVisible == null) {
                if (!e) e = window.event;
                var tmp = document.createElement("div");
                tmp.style.position = 'absolute';
                tmp.style.top = parseInt(e.clientY + 15) + 'px';
                tmp.style.left = parseInt(e.clientX + 15) + 'px';
                    var iframe = document.createElement('iframe');
                    iframe.src = this.url;
                    iframe.style.border = '0px';
                    iframe.style.height = parseInt(this.mheight)+'px';
                    iframe.style.width = parseInt(this.mwidth)+'px';
                    iframe.style.position = 'absolute';
                    iframe.style.top = '0px';
                    iframe.style.left = '0px';
                tmp.appendChild(iframe);
                tmp.style.display = 'none';
                WindowVisible = tmp;
                document.body.appendChild(tmp);
                tmp.style.height = parseInt(this.mheight) + 'px';
                tmp.style.width = parseInt(this.mwidth) + 'px';
                tmp.style.display = 'block';
            }
        }
        obj.onmouseout = function() {
            if (WindowVisible != null) {
                document.body.removeChild(WindowVisible);
                WindowVisible = null;
            }
        }
        obj.onmousemove = function(e) {
            if (!e) e = window.event;
            WindowVisible.style.top = parseInt(e.clientY + 15) + 'px';
            WindowVisible.style.left = parseInt(e.clientX + 15) + 'px';
        }
    }
} 
```

然后在您的 html 中执行以下操作：

1.  包含 .js 文件 `<script type="text/javascript" src="myfile.js"></script>`

2.  放入您的网页：

```
 <script type="text/javascript">
            var asd = new WindowShow();
            asd.bind(document.getElementById('go1'),'IMAGE URL HERE!',400,480);
</script> 
```

这是一个完整的 HTML 实现：

```
<html>
<head>
    <title>test page</title>
    <style>
        div.block { width: 300px; height: 300px; background-color: red; }
        iframe { border: 0px; padding: 0px; margin: 0px; }
    </style>
    <script type="text/javascript" src="window_show.js"></script>
</head>
<body>
    <div id="go1" style="background-color: red; width: 200px; height: 200px;"></div>

    <script type="text/javascript">
        var asd = new WindowShow();
        asd.bind(document.getElementById('go1'),'IMAGE URL HERE!',400,480);
    </script>
</body> 
```

再见！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T02:14:12.597

您可以使用 jquery 轻松完成此操作：

```
$("li").hover(
  function () {
    $(this).append($("<img src="myimage.jpg"/>"));
  }, 
  function () {
    $(this).find("img:last").remove();
  }
); 
```

一些经过实际测试的更全面的示例：http: [//docs.jquery.com/Events/hover](http://docs.jquery.com/Events/hover)

# .net - 用于 Windows 窗体的更好的 TreeView - .NET 3.5

> ID：289033
> 
> 赞同：3
> 
> 时间：2008-11-14T02:03:53.723
> 
> 标签：.net, winforms, forms, treeview

是否存在适用于 Visual Studio 2008 / .NET 3.5的更好的**免费TreeView 控件？**

我相信我需要比开箱即用版本更强大的东西。我还不确定是什么，但我想我会在我的项目走得太远之前尽快问清楚。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-14T22:51:20.163

[TreeViewAdv](http://treeviewadv.sourceforge.net/)似乎很不错。SourceForge.net 上描述了以下功能：

*   可扩展的高级 TreeView。
*   100% 管理 C# 代码。
*   特点：模型/视图架构。
    *   多列。
    *   多选。
    *   每个节点的不同控件：CheckBox、Icon、Label ...
    *   拖放突出显示。
    *   按需加载。
    *   增量搜索。

我们很可能会在即将到来的项目 IIRC 中使用它一两次。

高温高压

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-15T21:02:14.377

我会对您将用于树视图控件的内容保持警惕，确保测试它们消耗的内存量与绘图速度。

我们在使用树视图控件（由 Crownwood Software 制造，称为 DotNetMagic）时遇到问题，因为它会导致大量内存泄漏，尽管它的绘图速度*非常*快。

大多数组件供应商都提供试用版，因此请充分利用这些试用版！这里有一些可以帮助你的方式：

[C1 Controls](http://www.componentone.com/SuperProducts/StudioWinForms/)
[DotNetMagic](http://www.dotnetmagic.com/features_treeControl.html)（但要注意这个内存，自己检查，它仍然可能合适）

**编辑：**对不起，错过了免费位，对不起

# python - 通过 python 套接字接收数据

> ID：289035
> 
> 赞同：6
> 
> 时间：2008-11-14T02:04:45.500
> 
> 标签：python, sockets

我正在制作一个程序，该程序通过 python 套接字检索大量数据，然后在信息发送完成后立即断开连接。但我不知道该怎么做

网络上的所有示例都是他们拥有的 tcp 客户端

```
while 1:
   data = sock.recv(1024) 
```

但这创建了一个通过套接字接收数据的无限循环的外观，不是吗？

我需要弄清楚传入消息的大小并以缓冲区大小的增量循环遍历它以获得完整的消息。消息发送完毕后，我想断开连接，尽管我认为连接将从另一端关闭。你能帮忙的话，我会很高兴

谢谢

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-14T02:10:28.437

您可能错过了这些[示例](http://docs.python.org/library/socket.html#example)中非常重要的部分——“recv()”调用之后的行：

```
while 1:
    data = conn.recv(1024)
    if not data: break
    conn.send(data)
conn.close() 
```

# email - MS Entourage 2008 和引用可打印编码

> ID：289055
> 
> 赞同：1
> 
> 时间：2008-11-14T02:15:54.120
> 
> 标签：email, entourage, quoted-printable

我需要发送一封 HTML 电子邮件。除 Entourage 之外的所有电子邮件客户端（Outlook、Thunderbird ..）都可以毫无问题地接收和阅读此电子邮件。随行人员虽然破坏了内容，但从一开始只显示了几行。

我的猜测是它与 Entourage 如何处理引用可打印编码的方式有关。设置的电子邮件的重要标头：

```
Content-Type: text/html; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable 
```

Entourage 中的相同行为发生在电子邮件作为多部分/替代与替代纯文本发送时。电子邮件的内容会一直显示，直到字符`=00`出现（编码为 NUL？）。

这是 Entourage 错误行为吗？还是我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-14T03:24:24.747

The problem is indeed those `*=00*` characters. Before sending the email, you need to prepare it for quoted-printable encoding and remove all null characters.

```
$str = preg_replace('/\x00+/', '', $str); 
```

# php - 您如何在 Joomla 1.5 中获取当前用户对象？

> ID：289065
> 
> 赞同：0
> 
> 时间：2008-11-14T02:22:46.993
> 
> 标签：php, joomla

在 Joomla 1.0 中，当前的 User 对象被存储在一个名为`$my`. 这在 Joomla 1.5 中不再存在 - 我如何获得该对象？另外，如何判断用户是否尚未登录？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-14T02:25:09.937

在[http://docs.joomla.org/Accessing_the_current_user_object找到的信息](http://docs.joomla.org/Accessing_the_current_user_object)

```
$user =& JFactory::getUser(); 
```

以及如何判断他们是否已登录，或者他们是否只是访客：

```
if ($user->guest) {
    echo "Please log in.";
} else {
    echo "Welcome!";
} 
```

# visual-studio - 在 Visual Studio 2008 中，如何添加“使用 blah.myblah;” 到所有新页面代码隐藏？

> ID：289071
> 
> 赞同：2
> 
> 时间：2008-11-14T02:25:10.890
> 
> 标签：visual-studio

有没有办法修改新页面的默认模板，使其包含我的自定义“使用”语句？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T03:22:39.713

从[史蒂夫的博客](http://blogs.msdn.com/steve/archive/2007/04/10/changing-the-default-using-directives-in-visual-studio.aspx)中，它建议您编辑位于以下位置的 Class.cs 文件：

```
%Program Files%\Microsoft Visual Studio 9.0\Common7\IDE\ItemTemplates\CSharp\Code\1033\Class.zip 
```

确保通过运行重新生成模板缓存：

```
%Program Files%\Microsoft Visual Studio 9.0\Common7\IDE\devenv.exe /setup 
```

Make sure you wait for the process to exit (watch your task manager!).

Web templates are in a different zip:

```
%Program Files%\Microsoft Visual Studio 9.0\Common7\IDE\ItemTemplates\CSharp\Web\1033\WebForm.zip 
```

# c# - 如何在 C# 中使用 p/invoke 将指针传递给数组？

> ID：289076
> 
> 赞同：22
> 
> 时间：2008-11-14T02:27:44.860
> 
> 标签：c#, c, api, pinvoke

示例 C API 签名：

`void Func(unsigned char* bytes);`

在 C 中，当我想传递一个指向数组的指针时，我可以这样做：

```
unsigned char* bytes = new unsigned char[1000];
Func(bytes); // call 
```

如何将上述 API 转换为 P/Invoke，以便可以将指针传递给 C# 字节数组？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-11-14T02:54:06.820

传递字节数组的最简单方法是在导入语句中将参数声明为字节数组。

```
[DllImport EntryPoint="func" CharSet=CharSet.Auto, SetLastError=true]
public extern static void Func(byte[]);

byte[] ar = new byte[1000];
Func(ar); 
```

您还应该能够将参数声明为 IntPtr 并手动编组数据。

```
[DllImport EntryPoint="func" CharSet=CharSet.Auto, SetLastError=true]
public extern static void Func(IntPtr p);

byte[] ar = new byte[1000];
IntPtr p = Marshal.AllocHGlobal(Marshal.SizeOf(typeof(byte)) * ar.Length);
Marshal.Copy(ar, 0, p, ar.Length);
Func(p);
Marshal.FreeHGlobal(p); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-14T02:35:05.207

您可以使用不安全的代码：

```
unsafe 
{
     fixed(byte* pByte = byteArray)
     IntPtr intPtr = new IntPtr((void *) pByte);
     Func(intPtr);
} 
```

如果你需要使用安全代码，你可以使用一些技巧：

```
IntPtr intPtr = Marshal.AllocHGlobal(Marshal.SizeOf(byteArray));
Marshal.Copy(byteArray, 0, intPtr, Marshal.SizeOf(byteArray));

Func(intPtr);

Marshal.FreeHGlobal(intPtr); 
```

但是，恕我直言，安全代码会很慢。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-14T02:46:17.787

这是本机函数的适当签名。

```
[System.Runtime.InteropServices.DllImportAttribute("<Unknown>", EntryPoint="Func")]
public static extern  void Func(System.IntPtr bytes) ; 
```

# security - 您在输入或输出期间进行 HtmlEncode 吗？

> ID：289077
> 
> 赞同：3
> 
> 时间：2008-11-14T02:28:10.977
> 
> 标签：security, html-encode

你什么时候打电话`Microsoft.Security.Application.AntiXss.HtmlEncode`？您是在用户提交信息时执行此操作，还是在您显示信息时执行此操作？

像名字、姓氏、城市、州、邮编这样的基本信息怎么样？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-14T02:40:43.620

您在显示信息时执行此操作。保留输入的原件，将其转换为在网页上显示。假设您以其他方式显示它，例如将其导出到 Excel。在这种情况下，您需要导出保存的原件。

编码每一个字符串。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-14T02:39:25.853

您应该只在可能的最后时刻对数据进行编码或转义，无论是直接将其放入数据库之前，还是将其显示在屏幕上。如果你编码得太快，你会冒着意外双重编码的风险（你经常会`&amp;amp;`在新手的网站上看到 - 包括我自己）。

如果您确实想更快地进行编码，请采取措施避免双重编码。Joel 写了一篇关于匈牙利表示法的良好用途的文章，其中他提倡使用前缀来确定变量中存储的内容。例如：“us”表示不安全字符串，“ss”表示安全字符串。

```
usFirstName = getUserInput('firstName')

ssFirstName = cleanString(usFirstName); 
```

另请注意，信息的类型是什么（城市、邮政编码等）并不重要——不选中任何这些都是自找麻烦。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-14T03:01:26.667

这取决于你的情况。在我工作的地方，多年来公司没有进行 HTML 编码，所以当我们开始这样做时，几乎不可能在系统中找到可以在页面上显示用户输入的每个位置。

相反，我们选择在输入进入系统的过程中对其进行清理，因为输入点比输出点少。我们在将数据输入数据库之前立即进行清理，虽然我们不使用 Microsoft 的 AntiXss 库，但我们使用一组自制方法，根据输入类型将 HTML 标记和字符的范围列入白名单。

如果您从头开始设计系统，或者您有一个足够小（或管理良好）的系统来编码输出，请遵循 Corey 的建议。这绝对是更好的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-24T00:34:06.960

编码不是数据的属性，它是传输机制的属性。因此，您应该在收到数据时取消编码，并在传输前对其进行适当编码。传输机制决定了需要什么样的编码。

无论您的传输机制是 HTML、HTTP、烟雾信号等，这个原则都适用。诀窍是知道如何手动执行编码类型，以及各种框架何时自动为您执行这些步骤。例如，ASP.NET 将对分配给 System.Web.UI.WebControls.Button 的 Text 的数据进行编码，但不会对分配给 System.Web.UI.WebControls.Literal 的 Text 的文本进行编码。jQuery 将对使用 .innerText() 设置的内容进行编码，但不会对使用 .innerHtml() 设置的内容进行编码。

# asp.net-mvc - ASP.NET MVC 编辑集合最佳实践 - 您的意见

> ID：289082
> 
> 赞同：13
> 
> 时间：2008-11-14T02:30:01.597
> 
> 标签：asp.net-mvc, collections

鉴于以下课程，您对处理创建/编辑的最佳方式有何看法，其中 Attributes.Count 可以是任意数字。

```
public class Product {
  public int Id {get;set;}
  public string Name {get;set;}
  public IList<Attribute> Attributes {get;set;}
}

public class Attribute {
  public string Name {get;set;}
  public string Value {get;set;}
} 
```

用户应该能够在同一视图中编辑产品详细信息（名称）和属性详细信息（名称/值），包括添加和删除新属性。

处理模型中的更改很容易，处理 UI 和 ActionMethod 方面的最佳方式是什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-07-08T11:03:32.600

查看 Steve Sanderson 的博文[Editing a variable length list, ASP.NET MVC 2-style](http://blog.stevensanderson.com/2010/01/28/editing-a-variable-length-list-aspnet-mvc-2-style/)。

## 控制器

您的操作方法接收您的本机域模型`Product`并保持非常简单：

```
public ActionResult Edit(Product model) 
```

## 看法

**编辑.aspx**

```
<!-- Your Product inputs -->
<!-- ... -->

<!-- Attributes collection edit -->
<% foreach (Attribute attr in Model.Attributes)
   {
       Html.RenderPartial("AttributeEditRow", attr);
   } %> 
```

**属性编辑行.ascx**

注意助手扩展`Html.BeginCollectionItem(string)`

```
<% using(Html.BeginCollectionItem("Attributes")) { %>
    <!-- Your Attribute inputs -->
<% } %> 
```

也可以添加和编辑新属性。见帖子。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-14T02:53:45.357

使用 FormCollection 并遍历键/值对。大概您可以使用一种命名方案，该方案将允许您确定哪些键/值对属于您的属性集。

```
[AcceptVerbs( HttpVerb.POST )]
public ActionResult Whatever( FormCollection form )
{
 ....
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-27T20:58:20.293

使用自定义模型绑定器，并像往常一样编写 Action 方法：

```
ActionResult Edit(
  int id, 
  [ModelBinder(typeof(ProductModelBinder))] Product product
) ... 
```

在您的 ProductModelBinder 中，您遍历 Form Collection 值并绑定到 Product 实体。这使控制器界面保持直观，并且可以帮助测试。

```
class ProductModelBinder : IModelBinder ... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T02:37:03.330

取决于您希望为用户创建的体验。我已经为标记内容实现了类似的东西。在模型中，标签表示为 IList，但 UI 在单个文本字段中显示逗号分隔的列表。然后我处理将列表中的项目合并为一个字符串以填充文本字段，然后我拆分输入以将项目放回模型中的 IList 中。

在我的 DAL 中，然后我处理将列表转换为 LINQ 实体、处理插入和删除等。

它不是最直接的代码，但管理起来并不难，它为用户提供了预期的界面。

我确信还有其他方法可以处理它，但我会专注于最适合用户的方法，然后根据它制定映射细节。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T02:49:24.053

安德鲁，

我在想一些比标签更困难的东西。在这个简单的例子中，名称/值对 .. color: Red; 尺寸：10；材质：棉。

我认为任何可以使用的东西都可以扩展到更复杂的地方。即添加一个类别并在同一页面上添加其所有项目。使用一些 jQuery 添加另一行相对容易，但是将信息发送到 ActionMethod 的共识是什么？

你不能编码：

```
public ActionResult Whatever(stirng attr1Name, string attr2Name, string attr3Name ... 
```

此外，我认为接受这一点也行不通：

```
public ActionResult Whatever(ILIst<Attribute> attributes, string productName ... 
```

# d - D语言应用开发

> ID：289087
> 
> 赞同：20
> 
> 时间：2008-11-14T02:33:59.170
> 
> 标签：d, tango

对于那些使用 D 开发应用程序的人，

*   您使用哪些库来构建您的应用程序？
*   那些库有很好的文档记录吗？
*   你用过探戈吗？
*   你觉得 D 已经准备好构建大型应用程序了吗？
*   你用的是哪个IDE？下降可能？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-16T04:32:46.950

请注意，任何 C 库都可以与 D 一起使用，因为 D 完全支持 C ABI。D 对 C++ 库的支持有限，但不是 C++ 模板库。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-15T01:42:54.547

*   探戈
*   是的，尽管更多的例子可能会很好
*   是的
*   是的，我想是这样。但如果程序员习惯于成熟的 IDE（MS Visual Studio），他们可能不会喜欢 D，
*   我使用基于 Scintilla 的小型定制编辑器，可选择使用 bud、dsss 或 dmd 构建应用程序。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-15T01:44:30.330

*   我通常不在库之上工作（除了标准库），因为我倾向于做非常低级的东西，所以“无”
*   我使用 Phobos，但那是因为我很懒惰，这就是我开始时的全部内容。
*   我在商业应用程序中*使用它。*但我们非常处于早期采用者领域。
*   Descent确实取得了不错的进展。然而，对于我所做的事情（非常繁重的模板工作），它不能胜任这项任务。然而，对于大多数事情来说，这几乎不是一个问题。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-15T02:00:29.720

我使用了探戈库 + dfl 和一些我自己的。Tango 文档非常好。DFL 还不错。是的，我当时确实使用了探戈，但起初尝试了火卫一。准备好使用大型应用了吗？取决于你的意思。在生产使用中，我只将它用于前端和更新程序。到目前为止，我只使用 vim 来编码和设计 gui，因为我找不到适合我的 ide。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-16T03:44:01.133

*   我使用 Tango、Jive stacktrace、dconstructor、dunit 和 selfmock。不过，我保留了其中的最后三个。

*   Tango 有合理的文档。我遇到过一些文档比我需要的少的地方。在这些情况下，我制作了请求更好的文档的票。Jive 不需要文档。我希望我使用的其他人有合理的文档；我一直在努力。

*   是的，我用探戈。

*   您可以在 FORTRAN 中创建大型应用程序；D 更好。主要问题是库支持。据我所知，D 中不太支持密码学之类的东西。但是很容易找到我需要的一切。其他任何事情，您都可以在 C 中围绕现有库编写一个包装器，而不会有太多麻烦。

*   我通常使用 vim，但现在我正在切换到 Descent。它的自动完成功能比 Vim 的要好得多。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-15T17:57:25.233

*   DFL (GUI), Decent (for OpenGL), CUDA (GPGPU)
*   DFL 有良好的文档记录，但缺乏交叉引用。Decent/ CUDA 主要是 C 包装器，尽管 D 使得为 CUDA 制作漂亮的内部 API 变得非常容易。
*   不，我一直在使用 Phobos
*   是的，尽管某些类型的大型应用程序用另一种语言编写会快得多。
*   我一直将 Code::blocks 用于我的主要 IDE 和 Entice 用于 GUI 设计。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-15T18:26:01.713

*   除了核心库（在我的例子中是 Tango），我没有使用任何外部库。

*   Tango 文档很不错。这是一个大型图书馆，我想说其中大约 80% 的文档都在我的脑海中。而且，在那些记录在案的课程中，我想说其中大约 80% 是完整和正确的。鉴于图书馆的规模，文档的数量令人印象深刻。但它仍然不是它需要的地方。为了现在真正使用 Tango，您必须阅读源代码（干净且编写良好）。

*   我不知道 D 是否已准备好进行大型应用程序。我的应用程序很小，我很满意。从语言设计的角度来看，我更喜欢 C#（或 Java，在较小程度上）。相比之下，D 语言的设计让我觉得有些笨拙和笨拙。真的，我为这个项目选择 D 的唯一原因是因为 A) 我需要能够将我的代码编译成一个可以被任意第三方链接的 DLL；B) 我需要我的代码可以在 Win、Lin 和 Mac 之间移植；和 C) 我不想用 C/C++ 编写。

*   我正在使用 Descent（一个 Eclipse IDE 插件）。它提供了相当好的语法高亮和项目导航。自动完成仍然有很多不足之处，并且仍然缺乏与像 dsss 这样的“构建器”的集成。但它比记事本好:)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-16T16:45:16.360

*   主要是我自己开发的那些——SDWF 和 Stewart 的实用程序库。
*   但愿如此。
*   不。
*   是的，虽然我不确定库和 IDE 支持是否已经准备就绪。而且 D 还没有为重要的第三方实施做好准备，这可能在达到这个阶段时发挥了作用。
*   我在 TextPad 中进行大部分编辑。诚然，它与 D 不完全兼容（两个缺少的语法突出显示功能，并且不支持 Unicode），但它可以工作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-09-04T12:10:50.290

代码块似乎[支持 D](http://blog.fedora-fr.org/bioinfornatics/post/Code%3A%3ABlocks-and-D-programming)。

# soap - 如何将 SOAP 方法的返回类型声明为映射（在其 WSDL 中）？

> ID：289091
> 
> 赞同：4
> 
> 时间：2008-11-14T02:37:09.633
> 
> 标签：soap, wsdl, xsd

我正在向 SOAP 服务添加一个方法。我希望这种方法能够返回地图。更具体地说，它是列表（向量/数组）的映射。我将如何在其 WSDL 中捕获这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T05:19:23.940

这是从字符串到字符串的常规映射的 XSD 类型：

```
<xsd:complexType name="MapDataType">
  <xsd:sequence>
    <xsd:element name="Pair" maxOccurs="unbounded" minOccurs="0">
      <xsd:complexType>
        <xsd:sequence>
          <xsd:element name="Key" type="xsd:string" maxOccurs="1" minOccurs="1"/>
          <xsd:element name="Value" type="xsd:string" maxOccurs="1" minOccurs="1"/>
        </xsd:sequence>
      </xsd:complexType>
    </xsd:element>
  </xsd:sequence>
</xsd:complexType> 
```

这是你想要的吗？您需要将其用作返回值的类型。

我不确定您所说的“列表地图”是什么意思

# ssh - 每次从一台机器 ssh 到另一台机器后，如何执行命令？

> ID：289092
> 
> 赞同：7
> 
> 时间：2008-11-14T02:37:28.383
> 
> 标签：ssh

每次从一台机器 ssh 到另一台机器后，如何执行命令？

例如

```
ssh mymachine
stty erase ^H 
```

我宁愿每次在我的 ssh 连接完成后都执行“stty erase ^H”。

该命令不能简单地进入我的 .zshrc 文件。即对于本地会话，我无法运行命令（它搞砸了我的键绑定）。但我需要它为我的远程会话运行。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-14T03:13:32.633

将命令放入`~/.ssh/rc`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-14T03:00:26.310

你可以把这样的东西放到你的 shell 的启动文件中：

```
if [ -n "$SSH_CONNECTION" ]
then
  stty erase ^H
end 
```

`-n`测试将确定是否`SSH_CONNECTION`设置了仅在通过 SSH 登录时发生的设置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T02:43:04.237

如果你用 shell 登录到 *nix 盒子，为什么不把它放在你的 shell 启动中呢？

`.bashrc`或`.profile`在大多数情况下。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T02:41:27.267

假设一个 linux 目标，把它放在你的`.profile`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T03:05:59.917

尝试在 ~/.bashrc 末尾添加命令。它应该在注销时退出。*您是否希望仅*在注销 ssh 会话时执行此命令？本地会话等呢？

```
trap 'stty erase ^H; exit 0' 0 
```

您可能也可以使用相同的模式从 /etc/profile 设置一个 .logout 文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-10T17:46:03.897

屏幕/byobu 用户对我们的回答：

geocar 的解决方案将不起作用，因为屏幕会抱怨“必须连接到终端。”。（这可能是因为 .ssh/rc在shell 启动*之前被处理。请参阅*[LOGIN PROCESS](http://www.manpagez.com/man/8/sshd/)部分`man 8 sshd`）。

Robert 的解决方案在这里更好，但由于 screen 和 byobu 打开了它自己的 bash 实例，我们需要避免无限递归。所以这里是调整 byobu 友好版本：

```
## RUN BYOBU IF SSH'D ##
## '''''''''''''''''' ##
# (but only if this is a login shell)

if shopt -q login_shell
then
    if [ -n "$SSH_CONNECTION" ]
    then
        byobu
        exit
    fi
fi 
```

请注意，我还添加了`exit`after `byobu`，因为 IMO 如果您首先使用 byobu，您通常不想在它之外做任何事情。

# asp.net-mvc - Request.IsMvcAjaxRequest() 方法是否对源自 Ajax.ActionLink() 单击的请求返回 true？

> ID：289093
> 
> 赞同：2
> 
> 时间：2008-11-14T02:39:05.323
> 
> 标签：asp.net-mvc

我有一个控制器操作正在由使用“Ajax.ActionLink()”创建的链接执行，问题是我无法在我的操作中判断该请求是 AJAX 请求，因为`Request.IsMvcAjaxRequest()`它总是返回 false。

`Request.IsMvcAjaxRequest()`不适用于`Ajax.ActionLink()`生成的请求？

这是我用来生成链接的代码：

```
<%= Ajax.ActionLink("Delete", "Delete", new { graphUri = ViewData.Model.Uri.Value }, new AjaxOptions { Confirm = "Really delete?", OnSuccess = "success", OnFailure = "fail", HttpMethod = "DELETE" }, new { title = "Delete Graph", @class = "deleteGraphLink" })%> 
```

当我查看[`IsMvcAjaxRequest`扩展方法](http://www.codeplex.com/aspnet/SourceControl/FileView.aspx?itemId=266442&changeSetId=17272)的代码时，它看起来只适用于 AJAX 表单而不适用于 AJAX ActionLinks。

**更新 11/13**

如果我将 AjaxOptions 中的 HttpMethod 更改为 POST，一切都很好。任何人都知道在使用 DELETE 方法时如何让 Request.IsMvcAjaxRequest() 正常工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T03:52:37.797

删除时没有表单参数。尝试添加 __MVCASYNCPOST=true 作为路由数据（url 中的查询参数）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T03:11:57.533

因为“IsMvcAjaxRequest”只返回 (request["__MVCASYNCPOST"] == true)，并且检查查询字符串、表单 post 和 cookie ......它应该与 POST、GET 等一起使用。

尝试在您的代码后面放置一个断点并确保它正在命中 POST，然后更改为“DELETE”并查看它是否正在命中您的代码（因为这应该有效）。可能是您有一个 ActionFilter 只允许“POSTS”通过（或其他阻碍行为的东西）。

# asp.net - Gridview 控件 VS-2008 上的分页

> ID：289097
> 
> 赞同：0
> 
> 时间：2008-11-14T02:41:04.053
> 
> 标签：asp.net

如果你关注我之前的帖子

```
var filteredUser = from U in collection
                               select new  {U.fname,U.lname};
            gridView.DataSource = filteredUser;
            gridView.DataBind(); 
```

现在我正在尝试这样做：

1.  根据 U 的属性格式化列名。例如，如果 U.fname 更改为 U.FirstName，那么我希望我的 gridview 列名反映相同

2.  如果我通过设计视图启用分页，代码会编译，但是当我启动 Web 应用程序时，它会失败并显示“数据源不支持服务器端数据分页”

编辑::为项目#2 [链接文本找到了这个](http://www.devtoolshed.com/2008/03/gridview-objectdatasource-linq-paging.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T03:39:34.483

1）您是`AutoGenerateColumns="True"`在 GridView 上使用还是自己绑定它们？`AutoGenerateColumns`如果是真的，我认为（1）会起作用。您对列的显示方式失去了很多控制，但它应该可以工作。如果您自己绑定它们，我认为您只需要在数据字段的名称更改或为`select`子句中的名称命名时更新绑定的列名称，使其保持不变。

```
var filteredUser = from U in collection
                   select new  {FirstName = U.fname, LastName = U.lname}; 
```

2）您的收藏支持`IEnumerable<U>`还是仅仅支持`IEnumerable`？我相信 LINQ 使用`Skip()`并`Take()`支持分页，因此它需要支持通用可枚举接口。

# performance - 使用 Grails hasMany 关系时如何解决潜在的性能问题？

> ID：289098
> 
> 赞同：1
> 
> 时间：2008-11-14T02:41:26.970
> 
> 标签：performance, hibernate, grails, groovy

给定以下域类：

```
class Post {
   SortedSet tags
   static hasMany = [tags: Tag]
}

class Tag {
   static belongsTo = Post
   static hasMany = [posts: Post]
} 
```

到目前为止，据我了解，使用 a`hasMany`将导致休眠`Set`映射。然而，为了保持唯一性/顺序，Hibernate 需要从数据库中加载整个集合并比较它们的哈希值。

如果帖子/标签的集合变大，这可能会导致添加和删除帖子/标签时出现严重的性能问题。解决此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-19T23:07:25.900

Hibernate/GORM 在默认映射中没有确保顺序。因此，它不必从数据库中加载元素来进行排序。您将拥有一堆 id，但仅此而已。

见 19.5.2： [http ://www.hibernate.org/hib_docs/reference/en/html/performance-collections.html](http://www.hibernate.org/hib_docs/reference/en/html/performance-collections.html)

一般来说，Hibernate/GORM 的性能会比您预期的要好。除非并且直到您能够真正证明现实世界的性能问题，否则请相信框架并且不要担心。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T13:48:12.210

集合的顺序由`Set`实现来保证，即`SortedSet`. 除非您使用 a`List`来跟踪数据库上的索引，否则排序仅在服务器端。

如果您的域类在 a`SortedSet`中，则必须实现`Comparable`以启用对集合的正确排序。

性能问题本身并不是一个真正的问题。如果你想访问一个单一的`Tag`，你应该通过它的**Id**来获取它。如果您想要排序的标签，那么排序只有在您查看 all 时才有意义`Tags`，而不是特定的标签，因此您最终`Tags`会一次检索所有标签。`SortedSet`由于排序是在服务器端而不是在数据库端执行的，所以在数据库方面 a和常规之间并没有太大区别`HashSet`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T02:10:19.260

Grails 文档似乎已更新：

[http://grails.org/doc/1.0.x/](http://grails.org/doc/1.0.x/)

在 5.2.4 节中，他们讨论了集合类型的潜在性能问题。

这是相关部分：

**关于集合类型和性能的说明**

Java Set 类型是一个不允许重复的集合。为了在将条目添加到 Set 关联时确保唯一性，Hibernate 必须从数据库中加载整个关联。如果关联中有大量条目，这在性能方面可能会很昂贵。

List 类型需要相同的行为，因为 Hibernate 需要加载整个关联以保持顺序。因此，如果您预计关联中有大量记录，则建议您进行双向关联，以便可以在反面创建链接。例如考虑以下代码：

```
def book = new Book(title:"New Grails Book")
def author = Author.get(1)
book.author = author
book.save() 
```

在此示例中，关联链接是由子 (Book) 创建的，因此无需直接操作集合，从而减少查询并提高代码效率。如果您要编写如下代码，给定具有大量关联 Book 实例的 Author，您会看到对性能的影响：

```
def book = new Book(title:"New Grails Book")
def author = Author.get(1)
author.addToBooks(book)
author.save() 
```

# class - 有没有静态鸭子类型的语言？

> ID：289106
> 
> 赞同：18
> 
> 时间：2008-11-14T02:47:35.227
> 
> 标签：class, interface, language-design, duck-typing, static-typing

[声明成员时可以指定接口吗？](https://stackoverflow.com/questions/286584/can-i-specify-interfaces-when-i-declare-a-member#287669)

在考虑了这个问题一段时间后，我突然想到静态鸭子类型的语言可能真的有效。为什么预定义的类不能在编译时绑定到接口？例子：

```
public interface IMyInterface
{
  public void MyMethod();
}

public class MyClass  //Does not explicitly implement IMyInterface
{
  public void MyMethod()  //But contains a compatible method definition
  {
    Console.WriteLine("Hello, world!");
  }
}

...

public void CallMyMethod(IMyInterface m)
{
  m.MyMethod();
}

...

MyClass obj = new MyClass();
CallMyMethod(obj);     // Automatically recognize that MyClass "fits" 
                       // MyInterface, and force a type-cast. 
```

你知道任何支持这种功能的语言吗？它对 Java 或 C# 有帮助吗？它在某些方面存在根本性缺陷吗？我知道你可以继承 MyClass 并实现接口或使用 Adapter 设计模式来完成同样的事情，但这些方法看起来像是不必要的样板代码。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-11-11T20:16:44.493

这个问题的全新答案，[Go 正是这个特性](http://golang.org)。我认为这真的很酷很聪明（尽管我很想看看它在现实生活中是如何发挥作用的）并且对它的思考感到很荣幸。

如[官方文档中所述（作为围棋之旅的一部分，带有示例代码）](https://tour.golang.org/methods/10)：

> **接口是隐式实现的**
> 
> 类型通过实现其方法来实现接口。没有明确的意图声明，没有“implements”关键字。
> 
> 隐式接口将接口的定义与其实现分离，然后可以在没有预先安排的情况下出现在任何包中。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-23T21:21:52.527

在 C++ 中使用模板怎么样？

```
class IMyInterface  // Inheritance from this is optional
{
public:
  virtual void MyMethod() = 0;
}

class MyClass  // Does not explicitly implement IMyInterface
{
public:
  void MyMethod()  // But contains a compatible method definition
  {
    std::cout << "Hello, world!" "\n";
  }
}

template<typename MyInterface>
void CallMyMethod(MyInterface& m)
{
  m.MyMethod();  // instantiation succeeds iff MyInterface has MyMethod
}

MyClass obj;
CallMyMethod(obj);     // Automatically generate code with MyClass as 
                       // MyInterface 
```

我实际上还没有编译过这段代码，但我相信它是可行的，并且是对原始提议（但不工作）代码的一个非常简单的 C++ 化。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-11-14T03:09:41.767

我不明白这一点。为什么不明确说明该类实​​现了接口并完成了它？实现接口就是告诉其他程序员这个类应该按照接口定义的方式运行。仅在方法上具有相同的名称和签名并不能保证设计者的意图是使用该方法执行类似的操作。可能是这样，但为什么要把它留给解释（和滥用）呢？

您可以在动态语言中成功“摆脱”这一点的原因更多地与 TDD 有关，而不是与语言本身有关。在我看来，如果该语言能够为使用/查看代码的其他人提供此类指导，那么您应该使用它。它实际上提高了清晰度，值得添加几个额外的字符。在您无权执行此操作的情况下，适配器的作用与显式声明接口与其他类的关系方式相同。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-11-14T03:37:54.033

根据定义，静态类型语言在*编译时*检查类型，而不是*在运行时*检查类型。上述系统的一个明显问题是编译器将在程序编译时检查类型，而不是在运行时检查。

现在，您可以在编译器中构建更多智能，以便它可以*派生*类型，而不是让程序员显式*声明*类型；编译器可能能够看到它`MyClass`实现了一个`MyMethod()`方法，并相应地处理这种情况，*而*无需显式声明接口（如您所建议的那样）。这样的编译器可以利用类型推断，例如[Hindley-Milner](http://en.wikipedia.org/wiki/Type_inference#Hindley.E2.80.93Milner_type_inference_algorithm)。

当然，一些像 Haskell 这样的静态类型语言已经做了一些*类似于*你建议的事情；Haskell 编译器能够（大多数时候）推断类型，而无需显式声明它们。但显然，Java/C# 不具备这种能力。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-11-23T20:47:43.810

F# 支持静态鸭子类型，但有一个问题：您必须使用成员约束。[此博客条目](http://www.atrevido.net/blog/2008/08/31/Statically+Typed+Duck+Typing+In+F.aspx "F# 中的静态类型鸭子类型")中提供了详细信息。

引用博客中的示例：

```
let inline speak (a: ^a) =
    let x = (^a : (member speak: unit -> string) (a))
    printfn "It said: %s" x
    let y = (^a : (member talk: unit -> string) (a))
    printfn "Then it said %s" y

type duck() =
    member x.speak() = "quack"
    member x.talk() = "quackity quack"
type dog() =
    member x.speak() = "woof"
    member x.talk() = "arrrr"

let x = new duck()
let y = new dog()
speak x
speak y 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-10-24T03:28:03.177

ML 系列中的大多数语言都支持**具有推理和约束类型方案的结构类型**，这是令人讨厌的语言设计器术语，看起来很可能是原始问题中“静态鸭子类型”一词的意思。

这个家族中比较流行的语言包括：Haskell、Objective Caml、F# 和 Scala。当然，与您的示例最匹配的是Objective Caml。这是您的示例的翻译：

```
open Printf

class type iMyInterface = object
  method myMethod: unit
end

class myClass = object
  method myMethod = printf "Hello, world!"
end

let callMyMethod: #iMyInterface -> unit = fun m -> m#myMethod

let myClass = new myClass

callMyMethod myClass 
```

注意：您使用的某些名称必须更改以符合 OCaml 的标识符大小写语义概念，但除此之外，这是一个非常简单的翻译。

另外，值得注意的是，`callMyMethod`函数中的类型注释和类类型的定义都不`iMyInterface`是绝对必要的。Objective Caml 可以推断您示例中的所有内容，而无需任何类型声明。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-11-27T17:02:04.670

**[打字稿！](http://www.typescriptlang.org/)**

好吧，好吧......所以它是一个 javascript 超集，可能不构成一种“语言”，但这种静态鸭子类型在 TypeScript 中是至关重要的。

![在此处输入图像描述](https://i.stack.imgur.com/p91uU.png)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-14T03:38:23.173

Boo 绝对是一种静态的鸭式语言：[http ://boo.codehaus.org/Duck+Typing](http://boo.codehaus.org/Duck+Typing)

摘录：

> Boo 是一种静态类型语言，如 Java 或 C#。这意味着您的 boo 应用程序的运行速度与使用 .NET 或 Mono 的其他静态类型语言编写的应用程序一样快。但是使用静态类型语言有时会将您限制在不灵活和冗长的编码风格中，有时需要使用类型声明（例如“x as int”，但由于 boo 的类型推断，这通常不是必需的）和有时需要的类型转换（参见铸造类型）。Boo 对类型推断和最终泛型的支持在这里有所帮助，但是......
> 
> 有时放弃静态类型提供的安全网是合适的。也许您只是想探索一个 API 而不必过多担心方法签名，或者您正在创建与外部组件（如 COM 对象）对话的代码。无论哪种方式，选择都应该是你的，而不是我的。
> 
> 除了像 object、int、string...boo 这样的普通类型之外，还有一种特殊的类型，称为“duck”。该术语的灵感来自于 ruby​​ 编程语言的鸭子类型功能（“如果它像鸭子一样走路和像鸭子一样嘎嘎叫，那它一定是鸭子”）。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-28T23:05:10.223

Scala 中的结构类型就是这样做的。

请参阅[Scala 中的静态检查“鸭子类型”](http://web.archive.org/web/20090818051106/http://neilbartlett.name/blog/2007/09/13/statically-checked-duck-typing-in-scala/)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-05-09T06:24:09.907

新版本的 C++ 朝着静态鸭子类型的方向发展。你可以有一天（今天？）写这样的东西：

```
auto plus(auto x, auto y){
    return x+y;
} 
```

如果没有匹配的函数调用，它将无法编译`x+y`。

至于你的批评：

> 为您传递给它的每种不同类型创建一个新的“CallMyMethod”，因此它并不是真正的类型推断。

但它是类型推断（您可以说模板函数`foo(bar)`在哪里`foo`），并且具有相同的效果，除了它更省时并且在编译代码中占用更多空间。

否则，您将不得不在运行时查找该方法。您必须找到一个名称，然后检查该名称是否具有具有正确参数的方法。

或者，您必须存储所有有关匹配接口的信息，并查看与接口匹配的每个类，然后自动添加该接口。

在任何一种情况下，这都允许您隐式且意外地破坏类层次结构，这对新功能不利，因为它违背了 C#/Java 程序员的习惯。使用 C++ 模板，您已经知道自己处于雷区（并且他们还添加了功能（“概念”）以允许对模板参数进行限制）。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-05-31T22:53:06.613

[**Crystal**](http://crystal-lang.org)是一种静态鸭式语言。[示例](http://crystal-lang.org/docs/syntax_and_semantics/type_restrictions.html)：

```
def add(x, y)
  x + y
end

add(true, false) 
```

调用`add`导致此编译错误：

```
Error in foo.cr:6: instantiating 'add(Bool, Bool)'

add(true, false)
^~~

in foo.cr:2: undefined method '+' for Bool

  x + y
    ^ 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-14T03:36:18.373

Visual Basic 9 的预发布设计支持使用动态接口的静态鸭子类型，但他们削减了功能[*](http://www.infoq.com/news/2007/04/Dynamic-Interface)以便按时发布。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-04-15T07:48:50.927

D ( [http://dlang.org](http://dlang.org) ) 是一种静态编译语言，通过 wrap() 和 unwrap() ( [http://dlang.org/phobos-prerelease/std_typecons.html#.unwrap](http://dlang.org/phobos-prerelease/std_typecons.html#.unwrap) ) 提供鸭式输入。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-28T22:55:54.623

听起来像 Mixins 或 Traits：
[http ://en.wikipedia.org/wiki/Mixin](http://en.wikipedia.org/wiki/Mixin) [http://www.iam.unibe.ch/~scg/Archive/Papers/Scha03aTraits.pdf](http://www.iam.unibe.ch/~scg/Archive/Papers/Scha03aTraits.pdf)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-12-22T20:23:26.283

在我的编程语言[Heron](http://www.heron-language.com)的最新版本中，它通过一个名为`as`. 所以而不是：

```
MyClass obj = new MyClass();
CallMyMethod(obj); 
```

你会写：

```
MyClass obj = new MyClass();
CallMyMethod(obj as IMyInterface); 
```

就像在您的示例中一样，在这种情况下`MyClass`不必显式实现`IMyInterface`，但如果确实如此，则强制转换可能会隐式发生，并且`as`可以省略运算符。

[我在本文](http://dobbscodetalk.com/index.php?option=com_myblog&show=Explicit-Structural-Typing-Duck-Typing-.html&Itemid=29)中写了更多关于我称之为显式结构子类型的技术。

# scheme - 将此 Scheme 函数转换为不同的形式？

> ID：289107
> 
> 赞同：3
> 
> 时间：2008-11-14T02:47:44.337
> 
> 标签：scheme, message-passing

因此，这是将 sum 定义为消息传递对象的一种方法：

```
 (define (make-sum . exps)
  (let ((len (length exps)))
    ;; first handle variable length operands
    (cond 
     ((= len 0) (make-number 0)) ;; base case for addition
     ((= len 1) (car exps))      ;; might as well drop the sum if only 1 argument
     ((> len 2) 
       (make-sum (car exps) (apply make-sum (cdr exps))))
       ;; apply is described in section 2.4, footnote 47
       ;; > 2 operands: break up into 2 for simplicity in handling
     (else  ;; must be exactly 2 operands
      (let ((op1 (car exps))
            (op2 (cadr exps)))
        (cond ((op1 'zero?) op2) ;; exp + 0 --> exp
              ((op2 'zero?) op1)
              ((and (op1 'number?) (op2 'number?))
               (make-number (+ (op1 'value) (op2 'value)))) ;; num + num --> num
              (else ;; create a new message-passing object representing the sum
               (lambda (m . args)
                 (cond ((eq? m 'derive) 
                        (if (and (= (length args) 1)
                                 (symbol? (car args)))
                            ;; derivative of a sum is the sum of the derivatives
                            ;; of the parts of the sum
                            (make-sum (op1 'derive (car args)) 
                                      (op2 'derive (car args)))
                            (error "derive needs a variable argument")))
                       ((eq? m 'print) (list '+ (op1 'print) (op2 'print)))
                       ((eq? m 'zero?) #f)
                       ((eq? m 'number?) #f)
                       ((eq? m 'value) 
                        (error "should not be asking for the value of a sum expression"))
                       ((eq? m 'evaluate) 
                        (if (and (= (length args) 2)
                                 (symbol? (car args))
                                 (number? (cadr args)))
                            (let ((eop1 (op1 'evaluate (car args) (cadr args)))
                                  (eop2 (op2 'evaluate (car args) (cadr args))))
                              (make-sum eop1 eop2))
                            (error "evaluate needs a variable symbol and a number")))
                       ((eq? m 'has-constant-multiplier?) #f)
                       ((eq? m 'merge-constant) 
                        (error "should not be merging a constant with an addition"))
                       (else (error "unknown message" m))))))))))) 
```

但这可以重写为：

```
(define (make-sum exp1 exp2)
  (cond ((exp1 'zero?) exp2) ;; exp + 0 --> exp
        ((exp2 'zero?) exp1)
        ((and (exp1 'number?) (exp2 'number?))
         (make-number (+ (exp1 'value) (exp2 'value)))) ;; num + num --> num
        (else  ;; create a new message-passing object representing the sum
         (lambda (m . args)
           (cond ((eq? m 'derive) 
                  (if (and (= (length args) 1)
                           (symbol? (car args)))
                      (let ((variable (car args)))
                        ;; derivative of a sum is the sum of the derivatives
                        ;; of the parts of the sum
                        (make-sum (exp1 'derive variable) 
                                  (exp2 'derive variable)))
                      (error "derive needs a variable argument")))
                 ((eq? m 'print) (list '+ (exp1 'print) (exp2 'print)))
                 ((eq? m 'zero?) #f)
                 ((eq? m 'number?) #f)
                 ((eq? m 'value) 
                  (error "should not be asking for the value of a sum expression"))
                 ((eq? m 'evaluate) 
                  (if (and (= (length args) 2)
                           (symbol? (car args))
                           (number? (cadr args)))
                      (let ((variable (car args))
                            (number   (cadr args)))
                        (let ((exp1-eval (exp1 'evaluate variable number))
                              (exp2-eval (exp2 'evaluate variable number)))
                          (make-sum exp1-eval exp2-eval)))
                      (error "evaluate needs a variable symbol and a number")))
                 (else (error "unknown message: " m))))))) 
```

如何将我编写的用于将产品定义为消息传递对象的函数更改为上面的第二种格式？这是我写的代码：

```
(define (make-product . exps)
  (let ((len (length exps)))
    (cond
     ((= len 0) (make-number 1)) ;; base case for multiplication
     ((= len 1) (car exps))      ;; might as well drop the product if only 1 argument
     ((> len 2) (make-product (car exps) (apply make-product (cdr exps))))
     (else
      (let ((op1 (car exps))
            (op2 (cadr exps)))
        (cond ((op1 'zero?) (make-number 0))
              ((op2 'zero?) (make-number 0))
              ((and (op1 'number?) (= (op1 'value) 1)) op2) ;; multiplicative identity
              ((and (op2 'number?) (= (op2 'value) 1)) op1) ;; multiplicative identity
              ((and (op1 'number?) (op2 'has-constant-multiplier?))
               (op2 'merge-constant (op1 'value)))
              ((and (op2 'number?) (op1 'has-constant-multiplier?))
               (op1 'merge-constant (op2 'value)))
              (else
               (lambda (m . args)
                 (cond ((eq? m 'derive) 
                        (if (and (= (length args) 1)
                                 (symbol? (car args)))
                            (make-sum 
                             (make-product (op1 'derive (car args)) op2)
                             (make-product op1 (op2 'derive (car args))))
                            (error "derive needs a variable argument")))
                       ((eq? m 'print) (list '* (op1 'print) (op2 'print)))
                       ((eq? m 'zero?) #f)
                       ((eq? m 'number?) #f)
                       ((eq? m 'value) 
                        (error "should not be asking for the value of an product expression"))
                       ((eq? m 'evaluate) 
                        (if (and (= (length args) 2)
                                 (symbol? (car args))
                                 (number? (cadr args)))
                            (let ((eop1 (op1 'evaluate (car args) (cadr args)))
                                  (eop2 (op2 'evaluate (car args) (cadr args))))
                              (make-product eop1 eop2))
                            (error "evaluate needs a variable symbol and a number")))
                       ((eq? m 'has-constant-multiplier?) 
                        (or (op1 'has-constant-multiplier?)
                            (op2 'has-constant-multiplier?)))
                       ((eq? m 'merge-constant) 
                        (if (and (= (length args) 1)
                                 (number? (car args)))
                            (cond ((op1 'has-constant-multiplier?)
                                   (make-product 
                                    (op1 'merge-constant (car args))
                                    op2))
                                  ((op2 'has-constant-multiplier?)
                                   (make-product 
                                    op1
                                    (op2 'merge-constant (car args))))
                                  (else 
                                   (error "should not be calling merge-constant on a product with no constant multiplier")))
                            (error "invalid arguments to merge-constant")))
                       (else (error "unknown message" m))))))))))) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-07T12:51:25.327

这两个函数之间的主要区别在于`make-sum`第二个函数是二元（2 参数）函数，而第一个函数具有变量[arity](http://en.wikipedia.org/wiki/Arity)。从第一个中删除第`cond`一个`make-sum`，您基本上就拥有了第二个`make-sum`。第二个不处理`'has-constant-multiplier?`or `'merge-constant`，但其他差异完全是装饰性的。由此，您可以得出结论，`make-product`您需要做的是剥离可变参数案例。

# javascript - jQuery 是否有等效的 Request.IsMvcAjaxRequest()？

> ID：289108
> 
> 赞同：8
> 
> 时间：2008-11-14T02:48:24.430
> 
> 标签：javascript, jquery, asp.net-mvc, ajax

我更喜欢在我的 ASP.NET MVC 应用程序中使用 jQuery，而不是 Microsoft Ajax 库。我在我的 ajax 调用中设置的操作中添加了一个名为“mode”的参数。如果提供，我返回一个 JsonViewResult。如果没有提供，我假设它是一个标准的 Http 帖子并返回一个 ViewResult。

在使用 jQuery 时，我希望能够在我的控制器中使用类似于 IsMvcAjaxRequest 的东西，这样我就可以消除我的 Actions 中的额外参数。

有没有什么东西可以在我的控制器中提供这种功能或一些简单的方法来完成它？我不想疯狂地编写代码，因为添加单个参数是可行的，但这并不理想。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-31T11:17:15.520

这是 MVC RC1 发行说明中的​​一个例外 - 2009 年 1 月

**IsMvcAjaxRequest 重命名为 IsAjaxRequest**

> IsMvcAjaxRequest 方法已重命名为 IsAjaxRequest。作为此更改的一部分，更新了 IsAjaxRequest 方法以识别 X-Requested-With HTTP 标头。这是由 Prototype.js、jQuery 和 Dojo 等主要 JavaScript 库发送的众所周知的标头。
> 
> 更新了 ASP.NET AJAX 帮助程序以在请求中发送此标头。但是，他们继续在表单帖子的正文中发送它，以解决去除未知标题的防火墙问题。

换句话说 - 它被专门重命名为与其他库更“兼容”。

此外，对于尚未阅读[完整发行说明](http://go.microsoft.com/fwlink/?LinkID=137661&clcid=0x409)但一直在使用以前版本（即使是最近的测试版）的任何人，我**强烈**建议您完整阅读它们。它将为您节省未来的时间，并且很可能会通过一些新功能激发您的兴趣。令人惊讶的是那里有多少新东西。

**重要提示：**如果从 Beta 升级到 RC1，您需要确保升级 MicrosoftAjax.MVC 的 .js 文件（不是确切名称） - 否则此方法将不起作用。它没有在发行说明中列为升级所需的任务，所以不要忘记。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-14T03:02:53.370

**请参阅下面的西蒙斯回答。我在这里描述的方法在最新版本的 ASP.NET MVC 中不再需要。**

扩展方法当前的工作方式`IsMvcAjaxRequest`是检查`Request["__MVCASYNCPOST"] == "true"`，并且仅在该方法是 HTTP POST 请求时才有效。

如果您通过 jQuery 发出 HTTP POST 请求，您可以动态地将`__MVCASYNCPOST`值插入到您的请求中，然后您可以利用`IsMvcAjaxRequest`扩展方法。

为方便起见，这里是[IsMvcAjaxRequest 扩展方法的源链接](http://www.codeplex.com/aspnet/SourceControl/FileView.aspx?itemId=266442&changeSetId=17272)。

或者，您可以创建一个名为该检查的`IsMvcAjaxRequest`扩展方法 的克隆，并且可以将该值动态插入到 HTTP POST 中。`IsjQueryAjaxRequest``Request["__JQUERYASYNCPOST"] == "true"`

**更新**

我决定继续尝试一下，这就是我想出的。

扩展方法

```
public static class HttpRequestBaseExtensions
{
    public static bool IsjQueryAjaxRequest(this HttpRequestBase request)
    {
        if (request == null)
            throw new ArgumentNullException("request");

        return request["__JQUERYASYNCPOST"] == "true";
    }
} 
```

从操作中检查方法是否是 jQuery $.ajax() 请求：

```
if (Request.IsjQueryAjaxRequest())
    //some code here 
```

JavaScript

```
$('form input[type=submit]').click(function(evt) {
    //intercept submit button and use AJAX instead
    evt.preventDefault();

    $.ajax(
        {
            type: "POST",
            url: "<%= Url.Action("Create") %>",
            dataType: "json",
            data: { "__JQUERYASYNCPOST": "true" },
            success: function(data) {alert(':)');},
            error: function(res, textStatus, errorThrown) {alert(':(');}
        }
    );
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-26T19:14:31.500

为什么不简单地检查大多数 Javascript 库（如 jQuery）自动发送的“X-Requested-With”HTTP 标头？

发送 GET 或 POST 请求时，它的值为“XMLHttpRequest”。

为了对其进行测试，您只需要在您的操作中检查“Request.Headers”NameValueCollection，即：

```
if (Request.Headers["X-Requested-With"] == "XMLHttpRequest")
    return Json(...);
else
    return View(); 
```

这样，您可以简单地将常规浏览器请求与 Ajax 请求区分开来。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-26T18:52:23.793

好的，我更进一步并修改了我的 jQuery 文件以将附加参数加载到发布数据中，因此我不必为每次发布调用重复“__JQUERYASYNCPOST：true”。对于任何感兴趣的人，这是我对 $.post 的新定义：

```
post: function(url, data, callback, type) {
            var postIdentifier = {};
            if (jQuery.isFunction(data)) {
                callback = data;
                data = {};
            }
            else {
                postIdentifier = { __JQUERYASYNCPOST: true };
                jQuery.extend(data, postIdentifier);
            }

            return jQuery.ajax({
                type: "POST",
                url: url,
                data: data,
                success: callback,
                dataType: type
            });
        } 
```

我添加了“postIdentifier”变量以及对 jQuery.extend 的调用。现在，spoon16 的响应中解释的 Helper 可以正常工作，而无需向我的页面级 jQuery 代码添加任何特殊的东西。

# sql - 对任何数据库运行 SQL 脚本的好工具是什么？

> ID：289117
> 
> 赞同：4
> 
> 时间：2008-11-14T02:55:11.937
> 
> 标签：sql, database, scripting, database-agnostic

目前，我有一个自定义工具，可以从我们的数据模型生成 vanilla-SQL（仅使用标准 SQL），为我们的新数据库设置数据库模式和初始数据，并进行版本补丁等......这部分都很好和花花公子现在。

然而，针对所有不同的数据库（不同的供应商）运行这些 SQL 脚本很痛苦，所以不久前我写了一个快速的小 PHP 脚本来为我做这件事，但我想知道是否有更好的解决方案来解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T03:03:39.080

我使用[SQL Developer](http://www.oracle.com/technology/products/database/sql_developer/index.html)，它真的很酷。

它可以在任何平台上运行（是一个 Java 应用程序），您可以连接到任何数据库供应商并且它是免费的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T09:08:38.843

我使用[**Squirrel**](http://www.squirrelsql.org/)，就像 SQL Developer 一样，它是一个免费的 java 应用程序。

**描述**

> SQuirreL SQL Client 是一个图形化的 Java 程序，它允许您查看 JDBC 兼容数据库的结构、浏览表中的数据、发出 SQL 命令。

[**下载和安装**](http://www.squirrelsql.org/#installation)

# excel - 如何以编程方式更改 Excel 2007 图表中系列的线条颜色

> ID：289122
> 
> 赞同：2
> 
> 时间：2008-11-14T02:58:55.453
> 
> 标签：excel, charts, vba

我有一个图表，其中包含一系列表示大量（1000 个）离散测量的图表。其中一些是错误的测量值，我想根据另一组描述测量结果准确度的数据为该系列的线条着色。不好的测量值应该是红色的，好的测量值应该是绿色的，并且介于从红色到黄色到绿色的某种渐变之间。

这应该可以用 VBA 编程，但是我不知道该怎么做。谁能给我一些提示？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-14T12:54:16.483

在 VBA 中为图表线着色很容易。这里有一些注意事项。

```
Dim cht  As Chart
Dim sc As Series
Dim blnBad As Boolean
Dim j

j = 85 'RGB orange '
blnBad = False

'This is a chart called Chart 1, it would be possible '
'to use the charts collection '
Set cht = ActiveSheet.ChartObjects("Chart 1").Chart
'A chart is composed of series of data ... '
For Each sc In cht.SeriesCollection
    ' ... that you can iterate through to pick up '
    ' the individual data values, or a data range. '
    ' Values in this case. '
    For i = LBound(sc.Values) To UBound(sc.Values)
        ' That can be checked against another set of '
        ' values in the range Bad. '
        With ActiveSheet.Range("Bad")
            ' So, look for the value ... '
            Set c = .Find(sc.Values(i), lookat:=xlWhole, LookIn:=xlValues)
            ' and if it is found ... '
            If Not c Is Nothing Then
                ' ... then set the Bad flag '
                blnBad = True
            End If
        End With
    Next
    ' So, this range contains a Bad value '
    ' and we will colour it red ... '
    If blnBad Then
        sc.Border.Color = RGB(255, 0, 0)
        ' ... not forgetting the markers '
        sc.MarkerForegroundColor = RGB(255, 0, 0)
    Else
        ' Otherwise, use an increasingly yellow colour '
        sc.Border.Color = RGB(255, j, 0)
        sc.MarkerForegroundColor = RGB(255, j, 0)

        j = j + 30 ' getting more yellow
        ' Debug.Print j ' uncomment to see j in the immediate window '
    End If
    blnBad = False
Next
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T03:55:27.120

您是否被锁定在 VBA 中？实现此目的的一种方法是打开您的 OOXML .xlsx 文档存档（它实际上是一个 Zip 存档）。然后，您可以自由访问构成文档本身的 XML 数据。这可以通过 XSL 样式表或您选择的任何其他脚本运行，然后重新压缩。

# mysql - 什么时候创建第二个数据库？

> ID：289123
> 
> 赞同：3
> 
> 时间：2008-11-14T02:59:54.343
> 
> 标签：mysql, database-design

我有一个 mysql 数据库，其中已经增长到 200 多个表。我知道这不是性能问题，但是我拥有的大多数管理工具的组织不够好，无法轻松管理这么多表，我正在考虑将一些（新）表放入第二个数据库中，只是为了我自己的理智.

有没有其他人沿着这条路走，是否值得，或者它最终是否比拥有一个单一的数据库更麻烦？

**编辑：**感谢所有的答案，虽然我在寻找一些现实世界的经验而不是假设的建议，抱歉我不能选择正确的答案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-14T03:13:43.147

就个人而言，由于数据库中的所有表都用于同一个应用程序，我建议将它们保存在同一个数据库中。如果遇到性能问题，您应该获得更多硬件。不拆分的最重要的原因是，无论你认为数据中有多少分区，都不可避免地需要跨两个数据库连接表，这在性能方面是非常昂贵的，操作做。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-14T03:10:00.393

[这是](https://stackoverflow.com/questions/282823/multiple-databases-vs-a-single-database)一个类似的问题，开发人员这样做的地方。他们附近没有那么多桌子，但一些评论说明它有多烦人。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-14T04:29:16.677

我认为您遇到的是工具问题，而不是数据库问题！我的建议是改变你的工具，而不是把你的数据库分成多个部分。短期“优势”（具有较短的表列表）将导致您遇到多个长期问题，例如管理代码以在多个数据库中更新/提取数据。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-14T03:08:11.207

不确定你会得到什么。您将需要维护相同数量的表格，只是分散更多。除非您可以将它们划分为某种合理的逻辑方案，否则只会使它们更难找到。如果它们是相互关联的，那么你会使关系更难表达。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-14T03:11:00.593

我目前有一个数据库，其中有 600 个表并且还在增长，我没有遇到任何问题。我使用 MySQL Query Browser 和 MySQL Administrator 没有问题，你有什么具体问题吗？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-14T04:56:36.683

我会在你的表名前加上一些有意义的东西，这样你就可以更容易地找到你需要的表。

我同意其他人的观点，但.. 2 个数据库等于编码噩梦，更不用说维护它们（备份、恢复等）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-14T04:59:42.137

这 200 个表是一个应用程序的一部分吗？如果没有，那么我建议每个应用程序有一个数据库，或者每个大型应用程序至少一个数据库。

如果它们都属于同一个应用程序，我不会去第二个数据库，因为我认为这会导致比它解决的问题更多的问题（管理查询等）。也许进行一些重构以使用更少的表？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-14T03:22:51.287

如果您想开始将某些内容移至第二个数据库，请确保有目的地进行。当我意识到一些数据将成为我正在从事的几个项目的参考数据时，我会这样做。它成为我的“参考”数据库。

然后我的数据库列表将如下所示：
project1
project2
project3
reference

# batch-file - 使用批处理文件从不同的comp调用另一个批处理文件

> ID：289127
> 
> 赞同：2
> 
> 时间：2008-11-14T03:02:05.697
> 
> 标签：batch-file

是否可以使用批处理文件（对于 XP）从**不同的**计算机调用另一个批处理文件？如果是，如何识别目标计算机？是通过 IP comp ID 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T03:04:02.153

您可以使用[psexec执行此操作](http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx) from Sysinternals/Microsoft.

可以通过名称（假设名称解析在网络上工作）或 IP 地址来指定计算机名称。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-14T03:41:42.560

为什么不使用 UNC 命名？如在

这台电脑.bat

```
 @echo on
    dir *.whatever
    call \\ServerName\C$\YourFolder\OtherComputer.bat 
```

# visual-studio-2008 - Visual Studio 2008 .dll 消失问题

> ID：289137
> 
> 赞同：4
> 
> 时间：2008-11-14T03:07:47.853
> 
> 标签：visual-studio-2008, dll, c#-3.0, publish

好的，所以我有 VS 2008 和 SVN。当我“重建所有”时，我的一些 .dll 从我的 bin 文件夹中消失了。

我在库文件夹中有这些 .dll，这就是我引用它们的地方。

当我去发布应用程序时，发布失败，我认为它们是相关的。当我重新启动 web.config（更改某些内容并保存）时，此错误消失。但是，发布仍然失败。

当我转到文件夹并更新 svn 时，当然会将它们全部放回原处，但随后它又重新发生了。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-14T06:57:44.880

我假设“Bin”文件夹是指 Visual Studio 组装应用程序可执行版本的构建位置。

一般来说，我发现手动更改 Bin 文件夹是遇到“痛苦的新世界”的好方法。一旦我开始让 Visual Studio 对目录做它想做的事，我的问题就消失了，我不理会它。

如果您的项目引用了 DLL，请将它们标记为“复制本地”（在解决方案资源管理器中选择它们，在“属性”面板中进行配置），Visual Studio 将确保为您复制它们。

附注：由于 Bin 目录由 Visual Studio 管理并且是完全可重现的，我建议它（以及它的兄弟 Obj）不应该受源代码控制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T03:28:20.793

您需要在引用中指定“复制本地”，这会将它们从库文件夹中复制到您的 bin 目录中。通常，您应该只在源代码管理中（在库文件夹中）保留一份 DLL 副本。如果你控制了 bin 文件夹的源代码，你可能会遇到构建问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T03:26:36.880

听起来构建过程会在构建时删除 bin 目录的内容。

我不明白你说你从库文件夹中引用它们的位置 - 它们也存在于 bin 目录中。

您的发布可能由于其他原因而失败 - 发布错误最有帮助。

更新 SVN 会将文件恢复为最新版本 - 因此，如果您没有文件，则最新版本是存储库中存在的版本。

检查事项：

*   您可能在构建时收到错误 - 听起来 DLL 实际上是从您的解决方案中的其他项目输出的，因此您应该检查它们是否正确构建，或者它们是否正在输出到不同的目录而不是您的 bin 文件夹。

*   您的 subversion 存储库可能不应该有任何二进制或中间文件，例如 dll、lib、exe、suo、ncb 和其他一些文件，但这些是主要文件。

*   在此处发布更多详细信息 - 从它的声音来看，您似乎可能忽略了您未在此处发布的错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T03:30:03.520

我以前在使用 Rebuild 时看到过这个问题——我通过在它们的 Explorer 属性中将这些引用 dll 标记为 ReadOnly 来修复它。

是的，这很 hacky，但它让 VS 的爪子远离了我的 dll！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-13T19:20:54.313

您可能有一个默认网站，而不是一个 Web 应用程序项目。

# java - 一般问题：Java 有堆和本地堆栈。你可以从堆中访问任何对象吗？

> ID：289138
> 
> 赞同：15
> 
> 时间：2008-11-14T03:08:10.897
> 
> 标签：java, jvm, stack, heap-memory

我真的在研究按值传递与 Java 如何分配对象以及 java 将对象放入堆栈中的作用之间的区别。

无论如何可以访问堆上分配的对象吗？java 强制执行哪些机制来保证正确的方法可以访问堆外的正确数据？

看起来如果您很狡猾，甚至可能在运行时操纵 java 字节码，那么您可能能够在不应该的时候操纵堆外的数据？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-14T05:01:18.063

JVM 指令集中没有指令可以任意访问堆。因此，字节码操作在这里对您没有帮助。

JVM 也有一个验证器。它检查每个方法的代码（当一个类被加载时），以验证该方法不会尝试从执行堆栈中弹出比它推入它的值更多的值。这确保了一个方法不能“看到”其调用方法所指向的对象。

最后，局部变量存储在每个方法数组（称为“局部变量数组”）中。同样，验证器确保从/到该数组的每个读/写指令都指定一个小于数组大小的索引。请注意，这些 JVM 指令只能指定一个常量索引。他们不能获取计算值并将其用作索引。

回顾一下，答案是否定的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-14T03:59:38.530

Java 中的所有对象都位于堆上。我不太确定“从堆中访问对象”是什么意思。唯一存储在堆栈中的是调用当前上下文的函数列表及其局部变量和参数。所有局部变量和参数都是原始类型或引用。

如果您使用`new`（这是分配非原始类型的唯一方法；是的，这包括数组类型）分配对象，则该对象将分配在堆上，对该对象的引用存储在堆栈或堆中，取决于引用是存储在局部变量/参数中还是作为另一个对象的成员。

当作为参数传递给函数时，所有对象都是通过引用传递的——如果函数修改了参数，那么原始对象也会被修改。同样，也可以说对象引用是按值传递的——如果您将参数更改为引用一个新对象，它将在函数执行期间继续引用该对象，但传入的原始对象仍将引用它之前提到的任何内容。原始类型也按值传递。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-14T05:14:34.290

关于堆栈上的对象，只有来自 SUN 的新 Java 6 VM（可能还有其他一些虚拟机）会尝试通过将对象放在堆栈上来优化字节码。通常，所有对象都将进入堆。作为参考，请查看：[http ://www.ibm.com/developerworks/java/library/j-jtp09275.html](http://www.ibm.com/developerworks/java/library/j-jtp09275.html)

此外，JVM 规范位于[http://java.sun.com/docs/books/jvms/second_edition/html/Overview.doc.html#6348](http://java.sun.com/docs/books/jvms/second_edition/html/Overview.doc.html#6348)。JVM 通过简单地不给你破坏它所需的指令来保护它的堆。JVM 实现中的缺陷可能会导致您的里程有所不同。

# c# - 如何在 C# 中使用 p/invoke 传递引用参数 (&)（不是指针）？

> ID：289157
> 
> 赞同：2
> 
> 时间：2008-11-14T03:27:11.747
> 
> 标签：c#, c++, api, interop, pinvoke

我有一个 C++ API 原型

```
void Func(int& size); 
```

如何在 C# 中将其翻译为 P/Invoke？

据我所知，如果我使用

```
public static extern Func(ref int size); 
```

，该函数将接收指向 int 而不是值的指针。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-14T04:07:45.580

（哎呀......这意味着这是一个答案，而不是评论）。

当您从 C++ 调用它时，该函数也会收到一个指针。你认为引用是如何实现的？Func() 将该指针视为引用，因此它如何到达那里并不重要。

# php - 在文本区域中捕获换行符（换行符、换行符）

> ID：289159
> 
> 赞同：19
> 
> 时间：2008-11-14T03:29:36.203
> 
> 标签：php, html, textarea, line-breaks

我有一个带有 a 的表单，`<textarea>`我想在服务器端的该文本区域中捕获任何换行符，并将它们替换为`<br/>`.

那可能吗？

我尝试`white-space:pre`在`textarea`'s CSS 上进行设置，但仍然不够。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-11-14T03:35:41.417

看看[`nl2br()`](http://ca3.php.net/manual/en/function.nl2br.php)功能。它应该完全符合您的要求。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-14T16:03:40.173

该[`nl2br()`](http://php.net/nl2br)功能的存在就是为了做到这一点：

然而，这个函数添加了 br 标签，但实际上并没有删除新行——这通常不是问题，但如果你想完全去除它们并捕获回车，你应该使用 a[`str_replace`](http://php.net/str_replace)或[`preg_replace`](http://php.net/preg_replace)

我认为 str_replace 会稍微快一些，但我没有进行基准测试；

```
$val = str_replace( array("\n","\r","\r\n"), '<br />', $val ); 
```

或者

```
$val = preg_replace( "#\n|\r|\r\n#", '<br />', $val ); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-24T20:59:27.470

如果您要使用`str_replace`or `preg_replace`，您可能应该将 the`"\r\n"`放在数组的开头，否则一个`\r\n`序列将被翻译成两个`<br/>`标签（因为`\r`将匹配，然后`\n`将匹配）。

例如：

```
$val = str_replace( array("\r\n", "\n","\r"), '<br />', $val ); 
```

或者

```
$val = preg_replace( "#\r\n|\n|\r#", '<br />', $val ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-06T20:00:59.013

对于那些想要不依赖于答案的人`nl2br()`：

```
$newList = ereg_replace( "\n",'|', $_POST['theTextareaContents']); 
```

或（在这种情况下）：

```
$newList = ereg_replace( "\n",'<br/>', $_POST['theTextareaContents']); 
```

* * *

PHP 端：从 Textarea 字符串到 PHP 字符串

```
$newList = ereg_replace( "\n",'|', $_POST['theTextareaContents']); 
```

PHP 端： PHP 字符串返回到 TextArea 字符串：

```
$list = str_replace('|', '&#13;&#10;', $r['db_field_name']); 
```

# c# - 是否值得将小型 C#“引擎”移植到 C++ 或类似的？

> ID：289162
> 
> 赞同：4
> 
> 时间：2008-11-14T03:31:29.477
> 
> 标签：c#, c++, directx

因此，按照我在 MSDN 上找到的教程，我使用 DirectX 和 C# 创建了您可能称之为“引擎”的东西。我还没有看到很多这样的事情（就个人而言）是用 C# 完成的，而且大多数人似乎更喜欢 C/C++，所以我很好奇使用 C# 是否会回来咬我，或者我是否应该继续吗？

我问的原因是教程突然停止了，所以有一些基础，但它足够小，可以毫不费力地移植。我自己喜欢 C#，但我不知道是否有一些其他人都知道我不知道的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T04:36:17.020

好吧，彼得，主要原因是 C++ 与平台无关，而 C# 不是真正意义上的，尽管 Mono （我认为你不能在大多数手机上运行 Mono C#，例如 Nintendo DS 或 Playstation3）。

无论如何，这些引擎中的大多数都支持 DirectX 和 OpenGL，和/或软件渲染器，因此它们从头开始设计为不可知论。但与任何不可知系统一样，这需要大量的努力和资源。

现在从你所说的来看，你的引擎是 C# + DirectX，这意味着你的引擎现在可以在 PC、Xbox、Zune 和一些 Window 驱动的手机上运行。老实说，这不是一个糟糕的平台范围。因此，如果您对这种自由度感到满意，并且您更喜欢 C# 而不是 C++，那么您不妨坚持现有的，并花时间改进您的引擎。但是，如果您想在 Microsoft 以外的任何东西上运行引擎，则需要在某个时候跳转到 C/C++。

关于我在说什么的想法，我的团队的引擎支持 Xbox、PS3、Wii、PSP、PC 以及可能的其他平台——如果我们付出努力的话，但是我们有 15 名全职工程师在开发它，所以......你看这是一个很大的成本。现在，如果你想为一个免费的项目做这样的事情，并且你知道 C++，你可以尝试许多开源引擎中的任何一个，比如 Ogre 或 Irrlicht。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T23:50:03.050

As a hobbyist game developer I greatly prefer C# (with a 3rd-party library call SlimDX) over C++. Yes, a game written in well-optimized C++ will probably run better than the same game written in well-optimized C#. But the time I save by using C# (I'm guessing very roughly 30-40%) can be used to optimize my algorithms such that a C# game will actually run faster than had I written it in C++ in the same amount of time.

As pointed out above, there's also the cross-platform compatibility issues because for most practical purposes a C# game will only run on Microsoft platforms.

Another issue to consider is that if you write your application in C# then it will require the .Net Framework to be installed on the computers it runs on. This can make distributing your application cleanly somewhat more of a hassle, though this is by no means an insurmountable obstacle.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T03:52:01.477

我建议留在你熟悉的地方。如果您打算执行一些较低级别的功能，例如实现您自己的图像处理或创建自定义过滤器或转换（取决于您使用 directx 的目的），则应仅在您的情况下考虑使用 C 或 C++。

图形应用程序可能具有计算密集型方面。其中大部分已在 DirectX api 中得到解决——如果您从 C++ 或 C# 中使用它，它的速度也一样快。

您会考虑较低级别语言的地方：如果您正在创建一些可以在本机上更快执行的图像处理 - 这仅适用于 Directx api 不提供它的情况，例如创建一些自定义编码器/解码器。在这种情况下，您可以使用另一种语言创建自定义组件，然后将其单独加载到您的 C# 应用程序中。如果你正在考虑使用 C++ Intrinsics，它允许你为你的 CPU 编程，还可以看看像 CUDA 这样的 GPGPU API。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T03:52:48.917

有一些工作室使用 c# 进行游戏。

你也可以看看XNA，还有一个quake3引擎的端口在互联网上飞来飞去，移植到c#。

所以应该没问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T03:53:21.430

如果您在 C# 中感觉更舒服，并且没有强制切换到更接近 CPU 的语言的性能问题，那么我认为没有必要进行更改。

但是，根据您计划在未来做什么以及该引擎应该走多远，这可能会发生巨大变化，而 C# 可能会成为错误的选择。但不幸的是，这只有时间可以证明。正确的有根据的猜测需要更多关于当前实施和未来计划的详细信息。

# asp.net-mvc - 如何将 Html.ValidationSummary 与 Ajax.BeginForm 一起使用？

> ID：289170
> 
> 赞同：5
> 
> 时间：2008-11-14T03:38:25.250
> 
> 标签：asp.net-mvc

我有一个在我的 MVC 项目中创建的 AJAX 表单。如果使用普通浏览器功能提交表单并且发生页面刷新，我会在表单中呈现验证信息（基于 ViewData.ModelState 的内置 MVC 验证）。

AJAX 表单是否有类似的验证机制？

```
<% using (Ajax.BeginForm("Create", "GraphAdministration", new AjaxOptions()
    {
        OnSuccess = "newGraphSuccess",
        OnFailure = "newGraphFailure",
        HttpMethod = "POST"
    }))
{ %>
    <!-- some form stuff in here !-->
<% } //end form %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T14:32:00.537

这实际上取决于表单发布后您从何处获取要显示的内容。验证摘要是在服务器上创建的，因此您必须在其中进行工作。

例如，我使用 .ascx 文件中的一些部分内容来呈现表单。通过直接调用操作，您在第一次获得页面中的表单`Html.RenderAction`

您将`Ajax.BeginForm`在 .ascx 文件中有您的等。然后直接在一个动作中调用它。

当从浏览器发出 Ajax 调用时，您可以将其发布到相同的操作。这样，您就可以像往常一样进行所有服务器端验证。您应该设置 Ajax 调用以将原始表单替换为操作返回的新 html。

您必须注意的一件事是，替换 JavaScript 将替换元素的**内容**而不是元素本身，因此请记住周围元素的 id。

抱歉，如果这有点令人费解，如果您想了解更多详细信息，请发表评论，我将充实相关部分。

### 额外细节：

所有这些都假设您正在服务器上进行所有验证。

您将拥有一个包含所有页面内容的视图，然后是 .ascx 文件中的一些部分内容，这是您的 ajax 表单所在的位置，需要将其设置为用 id 替换内容。如果它与您的 ajax 将要调用的操作具有相同的名称，则它最简单。

您可以使用`Html.RenderAction`它进入视图。您还可以使用相同方法的其他版本传入数据。您基本上以与您的 ajax 代码相同的方式调用它。

您需要将其全部包装在一个带有 id 集的 div 中。在部分中使用此 id 作为要替换的内容。

当您呈现页面时，表单的 html 和所有 ajax 内容都会被放入。

当调用 ajax 操作时，将返回部分内容并执行任何验证。它将替换您提供 id 的 div 的内容。

您可以通过使用`[AcceptVerbs(HttpVerbs.Get)]`和`[AcceptVerbs(HttpVerbs.Post)]`属性来拥有不同版本的操作

这种方法的主要问题是它不是自包含的，具有 id 的 div 在部分外部。

# asp.net-mvc - ActionResult 返回类型的意义何在？

> ID：289171
> 
> 赞同：15
> 
> 时间：2008-11-14T03:38:50.710
> 
> 标签：asp.net-mvc, actionresult

返回 ActionResult 的操作有什么意义？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-14T03:49:24.480

返回一个 ActionResult 而不是“只是做任何 ActionResult 正在做的事情”（即直接使用 Response.Redirect 或尝试直接通过 Response OutputStream 渲染出一个视图）给你一个非常好的优势：单元测试真的很容易，尤其是因为您通常不需要 Web 服务器来对 MVC 项目进行单元测试。

*附录：*作为重定向的示例：

如果你这样做

```
return Redirect(newUrl); 
```

在您的控制器中，您的单元测试现在可以

*   验证返回值是否属于“RedirectResult”类型
*   将其转换为 RedirectResult 后，通过检查 result.Url 来查看重定向到的 URL
*   所有这些都无需启动 IIS 或尝试“聪明地”拦截 Response.Redirect 调用
*   归根结底，RedirectResult 在其 ExecuteResult 函数中调用 Response.Redirect，但您的控制器单元测试位于其前面

*附录 2：*当我在上面的时候，这里是一个自定义 ActionResult 的例子：

[http://www.stum.de/2008/10/22/permanentredirectresult/](http://www.stum.de/2008/10/22/permanentredirectresult/)

这只是为了表明他们不是“黑魔法”。它们实际上非常简单：您的 Controller 返回一个 Action Result，而 MVC Runtime 最终将在其上调用 ExecuteResult 函数，传入一个您的 ActionResult 可以与之交互的 ControllerContext。重点还是要分离 MVC 的各个部分，使代码可重用，并使单元测试更容易，或者简而言之：提供一个非常干净的框架。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T03:42:54.833

由于它是基类，它允许您返回任何 ActionResult 子类，例如 ViewResult 或 JsonResult。我通常返回 ViewResult 作为默认值，但如果我正在处理 Ajax 以返回 JsonResult 对象，则会覆盖该行为。

这使我可以将 Ajax 添加为渐进式增强功能，并让应用程序在没有 JavaScript 的情况下运行，并且不需要单独的控制器操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T03:42:09.250

ActionResult 是许多不同类型的控制器结果的基类。通过返回基类，控制器动作可以根据方法的结果返回不同类型的结果——ViewResult、RedirectToActionResult 等。ActionResult 包含视图所需的所有数据或作为结果的新动作当前控制器动作。

# python - 谷歌 AppEngine 应用版本

> ID：289174
> 
> 赞同：3
> 
> 时间：2008-11-14T03:39:49.787
> 
> 标签：python, google-app-engine

是否可以以编程方式获取当前应用程序版本以用于具有远期过期标头的 url？

例如：

```
<link rel="stylesheet" href="app.js?v=1.23" /> 
```

应自动更新为：

```
<link rel="stylesheet" href="app.js?v=1.24" /> 
```

为此，我需要获取版本。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-15T21:49:31.193

来自 [ [http://code.google.com/appengine/docs/python/theenvironment.html][1]](http://code.google.com/appengine/docs/python/theenvironment.html][1])

```
from google.appengine.ext import webapp
import os

class PrintEnvironmentHandler(webapp.RequestHandler):
  def get(self):
    for name in os.environ.keys():
      self.response.out.write("%s = %s<br />\n" % (name, os.environ[name]))

  [1]: http://code.google.com/appengine/docs/python/theenvironment.html 
```

# interface - 鸭子类型与旧的“变体”类型和/或接口有何不同？

> ID：289176
> 
> 赞同：45
> 
> 时间：2008-11-14T03:40:59.223
> 
> 标签：interface, variant, duck-typing

我经常看到“鸭子打字”这个短语在流传，甚至遇到一两个代码示例。我~~太懒~~了，没时间做自己的研究，有人可以简单地告诉我：

*   'duck type' 和 old-skool 'variant type' 之间的区别，以及
*   提供一个我可能更喜欢鸭子打字而不是变体打字的例子，以及
*   提供一个我*必须*使用鸭子打字来完成的事情的例子？

![鸭子打字插图由 The Register 提供](https://regmedia.co.uk/2007/05/03/cartoon_duck.jpg)

我并不是想通过怀疑这种“新”结构的力量来显得家常便饭，我也不是通过拒绝进行研究来回避这个问题，但我对我所看到的所有蜂拥而至的炒作感到震惊最近呢。对我来说，它看起来像*没有*打字（又名动态打字），所以我没有立即看到优势。

附录：感谢到目前为止的示例。在我看来，使用“O->can(Blah)”之类的东西相当于进行反射查找（这可能并不便宜），和/或与编译器可能会说的（O 是 IBlah）大致相同能够为您检查，但后者的优点是可以将我的 IBlah 接口与您的 IBlah 接口区分开来，而其他两个则没有。当然，每个方法都有很多微小的接口会变得混乱，但同样可以检查很多单独的方法......

...所以我还是不明白。这是一个很棒的节省时间的方法，还是一个全新的麻袋里的旧东西？*需要*鸭子打字的例子在哪里？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-11-14T08:47:15.720

在这里的一些答案中，我看到了一些不正确的术语使用，这导致人们提供错误的答案。

所以，在我给出答案之前，我将提供一些定义：

1.  强类型

    如果语言强制执行程序的类型安全，则它是强类型的。这意味着它保证了两件事：一种叫做进步的东西，另一种叫做保存的东西。进步基本上意味着所有“有效类型”的程序实际上都可以由计算机运行，它们可能会崩溃，或者抛出异常，或者运行无限循环，但它们实际上可以运行。保存意味着如果一个程序是“有效类型的”，那么它将始终是“有效类型的”，并且没有变量（或内存位置）包含不符合其分配类型的值。

    大多数语言都有“进度”属性。然而，有许多不满足“保存”属性。一个很好的例子是 C++（和 C 也是）。例如，在 C++ 中可以强制任何内存地址表现得就像它是任何类型一样。这基本上允许程序员在他们想要的任何时候违反类型系统。这是一个简单的例子：

    ```
    struct foo
    {
        int x;
        iny y;
        int z;
    }

    char * x = new char[100];
    foo * pFoo = (foo *)x;
    foo aRealFoo;
    *pFoo = aRealFoo; 
    ```

    此代码允许某人获取一个字符数组并向其写入一个“foo”实例。如果 C++ 是强类型的，这是不可能的。如果您尝试将字符数组强制转换为“foo”实例，则类型安全语言（如 C#、Java、VB、lisp、ruby、python 和许多其他语言）会引发异常。

2.  弱类型

    如果某些东西不是强类型，那么它就是弱类型。

3.  静态类型

    如果在编译时验证了语言的类型系统，则该语言是静态类型的。静态类型语言既可以像 C 一样是“弱类型”，也可以像 C# 那样是强类型。

4.  动态类型

    动态类型语言是一种在运行时验证类型的语言。许多语言在某种程度上混合了静态类型和动态类型。例如，C# 将在运行时动态验证许多强制转换，因为在编译时无法检查它们。其他示例是 Java、VB 和 Objective-C 等语言。

    还有一些语言是“完全”或“大部分”动态类型的，如“lisp”、“ruby”和“small talk”

5.  鸭打字

    Duck 类型与静态、动态、弱或强类型完全正交。无论对象的底层类型标识如何，编写代码都将与对象一起工作是一种实践。例如，下面的 VB.NET 代码：

    ```
    function Foo(x as object) as object
        return x.Quack()
    end function 
    ```

    无论传递给“Foo”的对象是什么类型，只要定义了一个名为“Quack”的方法，它都可以工作。也就是说，如果物体看起来像鸭子，走路像鸭子，说话像鸭子，那么它就是鸭子。鸭打字有多种形式。可以有静态鸭子类型、动态鸭子类型、强鸭子类型和弱鸭子类型。C++ 模板函数是“弱静态鸭子类型”的一个很好的例子。“JaredPar's”帖子中的示例显示了“强静态鸭子类型”的示例。VB 中的后期绑定（或 Ruby 或 Python 中的代码）启用“强动态鸭子类型”。

6.  变体

    变体是一种动态类型的数据结构，可以保存一系列预定义的数据类型，包括字符串、整数类型、日期和 com 对象。然后，它定义了一系列用于分配、转换和操作存储在变体中的数据的操作。变体是否为强类型取决于使用它的语言。例如，VB 6 程序中的变体是强类型的。VB 运行时确保用 VB 代码编写的操作符合变体的类型规则。通过 VB 中的变体类型将字符串添加到 IUnknown 将导致运行时错误。然而，在 C++ 中，变体是弱类型的，因为所有 C++ 类型都是弱类型的。

好的....既然我已经了解了定义，我现在可以回答您的问题：

VB 6 中的一个变体允许进行鸭子类型的一种形式。有比变体更好的方法来进行鸭子类型（Jared Par 的示例是最好的方法之一），但是您可以使用变体进行鸭子类型。也就是说，您可以编写一段代码来对对象进行操作，而不管其底层类型标识如何。

但是，使用变体执行此操作并不能真正提供很多验证。像 JaredPar 描述的那样，静态类型的鸭子类型机制提供了鸭子类型的好处，以及来自编译器的一些额外验证。这真的很有帮助。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-11-14T07:09:13.670

简单的答案是变体是弱类型，而鸭子类型是强类型。

鸭子打字可以很好地概括为“如果它像鸭子一样走路，看起来像鸭子，像鸭子一样行动，那么它就是一只鸭子。” 计算机科学术语认为鸭子是以下接口。

```
interface IDuck {
  void Quack();
} 
```

现在让我们来看看达菲

```
class Daffy {
  void Quack() {
    Console.WriteLine("Thatsssss dispicable!!!!");
  }
} 
```

在这种情况下，Daffy 实际上不是 IDuck。然而它的行为就像一只鸭子。既然很明显 Daffy 实际上是一只鸭子，为什么还要让 Daffy 实现 IDuck。

这就是 Duck 类型的用武之地。它允许在具有 IDuck 和 IDuck 引用的所有行为的任何类型之间进行类型安全转换。

```
IDuck d = new Daffy();
d.Quack(); 
```

现在可以在完全类型安全的情况下在“d”上调用 Quack 方法。此分配或方法调用中不可能出现运行时类型错误。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-14T03:47:03.483

鸭子类型只是动态类型或后期绑定的另一个术语。使用在运行时期间可能实际定义或未定义的任何成员访问（例如，obj.Anything）解析/编译的变体对象是鸭子类型。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-16T05:00:44.507

可能没有什么*需要*鸭式打字，但在某些情况下它可能很方便。假设您有一个方法从某个 3rd 方库中获取并使用密封类 Duck 的对象。并且您想让该方法可测试。Duck 有一个非常大的 API（有点像 ServletRequest），你只需要关心其中的一小部分。你如何测试它？

一种方法是使该方法采用一些嘎嘎作响的东西。然后，您可以简单地创建一个 quacking 模拟对象。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-14T03:57:17.317

尝试阅读关于鸭子类型的维基百科文章的第一段。
[鸭子在维基百科上打字](http://en.wikipedia.org/wiki/Duck_typing)

我可以有一个定义方法 Run() 的接口 (IRunnable)。
如果我有另一个类具有这样的方法：
public void RunSomeRunnable(IRunnable rn) { ... }

在鸭子类型友好的语言中，我可以将任何具有 Run() 方法的类传递给 RunSomeRunnable() 方法。
在静态类型语言中，传递给 RunSomeRunnable 的类需要显式实现 IRunnable 接口。

“如果它像鸭子一样运行（）”

变体至少更像 .NET 中的对象。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-14T04:30:29.903

@肯特弗雷德里克

您的示例当然可以通过使用显式接口在没有鸭子类型的情况下完成......更丑的是，但这并非不可能。

就个人而言，我发现在接口中定义明确的合同对于执行质量代码比依赖鸭子打字要好得多……但这只是我的意见，并持保留态度。

```
public interface ICreature { }
public interface IFly { fly();}
public interface IWalk { walk(); }
public interface IQuack { quack(); }
// ETC

// Animal Class
public class Duck : ICreature, IWalk, IFly, IQuack
{
    fly() {};
    walk() {};
    quack() {};
}

public class Rhino: ICreature, IWalk
{
    walk();
}

// In the method
List<ICreature> creatures = new List<ICreature>();
creatures.Add(new Duck());
creatures.Add(new Rhino());   

foreach (ICreature creature in creatures)
{
    if (creature is IFly)        
         (creature as IFly).fly();        
    if (creature is IWalk) 
         (creature as IWalk).walk();         
}
// Etc 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-16T04:04:28.613

关于您*需要*使用鸭子打字来完成的示例的请求，我认为不存在这样的事情。我认为它就像我在考虑是否使用递归或是否使用迭代一样。有时一个比另一个工作得更好。

以我的经验，鸭式打字使代码更具可读性和更容易掌握（对于程序员和读者而言）。但我发现更传统的静态类型消除了很多不必要的类型错误。根本没有办法客观地说一个比另一个更好，甚至说什么情况下一个比另一个更有效。

我说如果你习惯使用静态类型，那么就使用它。但是你至少应该尝试鸭式打字（如果可能的话，在一个重要的项目中使用它）。

更直接地回答你：

> ...所以我还是不明白。这是一个很棒的节省时间的方法，还是一个全新的麻袋里的旧东西？

两者都是。你仍然在解决同样的问题。你只是用不同的方式来做。有时这就是你需要做的所有事情来节省时间（即使没有其他理由强迫自己考虑以不同的方式做某事）。

它是拯救全人类免于灭绝的灵丹妙药吗？不，任何告诉你其他情况的人都是狂热者。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-14T03:48:32.750

我认为鸭式打字的核心是它是如何使用的。一个人使用实体的方法检测和自省来知道如何处理它，而不是提前声明*它将*是什么（你知道如何处理它）。

这在 OO 语言中可能更实用，其中原语不是原语，而是对象。

我认为总结它的最好方法，在变体类型中，实体是/可以是任何东西，它是什么是不确定的，而不是实体*看起来*像任何东西，但你可以通过询问它来弄清楚它是什么.

这是我不相信没有鸭式打字的事情。

```
sub dance { 
     my $creature = shift;
     if( $creature->can("walk") ){ 
         $creature->walk("left",1);
         $creature->walk("right",1); 
         $creature->walk("forward",1);
         $creature->walk("back",1);
     }
     if( $creature->can("fly") ){ 
          $creature->fly("up"); 
          $creature->fly("right",1); 
          $creature->fly("forward",1); 
          $creature->fly("left", 1 ); 
          $creature->fly("back", 1 ); 
          $creature->fly("down");
     } else if ( $creature->can("walk") ) { 
         $creature->walk("left",1);
         $creature->walk("right",1); 
         $creature->walk("forward",1);
         $creature->walk("back",1);
     } else if ( $creature->can("splash") ) { 
         $creature->splash( "up" ) for ( 0 .. 4 ); 
     }
     if( $creature->can("quack") ) { 
         $creature->quack();
     }
 }

 my @x = ();  
 push @x, new Rhinoceros ; 
 push @x, new Flamingo; 
 push @x, new Hyena; 
 push @x, new Dolphin; 
 push @x, new Duck;

 for my $creature (@x){

    new Thread(sub{ 
       dance( $creature ); 
    }); 
 } 
```

任何其他方式都需要您对函数进行类型限制，这将删除不同的物种，需要您为不同的物种创建不同的函数，使得代码维护起来非常麻烦。

这真的很糟糕，只是试图表演好的编舞。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-14T03:52:32.927

一个变体（至少我在 VB6 中使用过它们）拥有一个单一的、定义明确的、通常是静态类型的变量。例如，它可能包含一个整数、浮点数或字符串，但变体整数用作整数，变体浮点数用作浮点数，变体字符串用作字符串。

Duck 类型改为使用动态类型。在鸭子类型下，如果变量恰好支持 int、float 或 string 在特定上下文中支持的特定方法，则该变量可能可用作 int、float 或 string。

变体与鸭子类型的示例：

对于 Web 应用程序，假设我希望我的用户信息来自 LDAP 而不是来自数据库，但我仍然希望我的用户信息可供基于数据库和 ORM 的 Web 框架的其余部分使用。

使用变体：没有运气。我可以创建一个可以包含 UserFromDbRecord 对象或 UserFromLdap 对象的变体，但是期望来自 FromDbRecord 层次结构的对象的例程将无法使用 UserFromLdap 对象。

使用鸭子类型：我可以使用我的 UserFromLdap 类并添加几个方法，使其表现得像 UserFromDbRecord 类。我不需要复制整个 FromDbRecord 接口，对于我需要使用的例程就足够了。如果我做对了，这是一个非常强大和灵活的技术。如果我做错了，它会产生非常混乱和脆弱的代码（如果 DB 库或 LDAP 库发生更改，可能会损坏）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-02-12T11:26:05.070

你可以用鸭子打字做的一切，你也可以用接口做。鸭式打字既快速又舒适，但有些人认为它可能会导致错误（如果两个不同的方法/属性名称相同）。接口是安全且明确的，但人们可能会说“为什么要陈述显而易见的事情？”。休息是火焰。每个人都选择适合他的东西，没有人是“正确的”。

# iphone - iPhone OS 上可用的 PDFKit 框架？

> ID：289186
> 
> 赞同：3
> 
> 时间：2008-11-14T03:45:28.840
> 
> 标签：iphone, pdf, pdfkit

我很想知道 PDFKit 框架是否可以在 iPhone OS 中使用，以便构建一个比通过 UIWebView 打开 PDF 文档更复杂的 PDF 阅读器。

只是想知道这是否是一种选择。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-14T04:33:58.117

获取名为 QuartzDemo 的官方示例代码，其中有一个关于如何使用 Quartz 图形操作 PDF 文件的示例。输出似乎比 UIWebView 快。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-14T04:06:41.590

PDFKit 目前在 iPhone 上不可用。当然功能是存在的，但 Apple 并没有在可用的框架中开放它。如果您想在将来看到它，您应该为此提交一个错误。

如果您想对 PDF 进行更多控制，有很多方法可以使用 Quartz 图形来处理 PDF 内容。

# python - 为什么 Excel 宏在 Excel 中有效，但在 Python 中调用时无效？

> ID：289187
> 
> 赞同：0
> 
> 时间：2008-11-14T03:45:51.163
> 
> 标签：python, excel, vba, pywin32

我有一个 Excel 宏，它可以删除一张工作表，复制另一张工作表并将其重命名为与已删除工作表相同的名称。从 Excel 运行时这工作正常，但是当我通过从 Python 调用宏运行它时，我收到以下错误消息：

> 运行时错误“1004” - 无法将工作表重命名为与另一个工作表、引用的对象库或 VisualBasic 引用的工作簿相同的名称。

该宏具有如下代码：

```
Sheets("CC").Delete
ActiveWindow.View = xlPageBreakPreview
Sheets("FY").Copy After:=Sheets(Sheets.Count)
Sheets(Sheets.Count).Name = "CC" 
```

并且调试器在工作表被重命名的最后一行突出显示错误。我也尝试将这些调用直接放在 python 中，但得到相同的错误消息。

任何建议都非常感谢！

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T05:29:29.660

我在 Excel VBA 中运行了代码。
我猜下面的行是失败的。

`Sheets("CC").Delete`

这就是原因，您不能为新工作表提供与现有（未删除）工作表相同的名称。

在您完成代码 `Application.DisplayAlerts = False` 之前 `Sheets("CC").Delete` 和之后放置。
`Application.DisplayAlerts = True`

我没有使用 python，但似乎该库正在为您吞下该错误并让您继续执行下一个语句。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T08:17:32.050

在幕后，VB 和 VBA 为应用程序、工作表等维护对 COM 对象的引用。这就是为什么你有全局“应用程序”、“工作表”等。VBA 可能仍然持有对工作表的引用，所以Excel没有正确整理它。

尽量不要使用这些隐式全局变量并显式引用对象模型中的项目。或者，您可以直接在 Python 中执行此操作。

这是一个 python 脚本，它将执行您想要的操作：

```
import win32com.client
xl = win32com.client.Dispatch ('Excel.Application')
xl.Visible = True
wb = xl.Workbooks.Add()
wb.Worksheets[0].Delete()
wb.Worksheets.Add()
wb.Worksheets[0].Name = 'Sheet1' 
```

# linux - 什么是 TCP 中的最大段生命周期 (MSL)？

> ID：289194
> 
> 赞同：12
> 
> 时间：2008-11-14T03:51:17.610
> 
> 标签：linux, networking, tcp, network-protocols

我们有一个自制的 XMPP 服务器，有人问我我们服务器的 MSL（最大段生命周期）是多少。
它是什么意思，我如何获得它？它在 Linux `/proc`TCP 设置中吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2016-01-25T19:43:54.287

MSL (Maximum Segment Lifetime) 是 TCP 段预计存在于网络中的最长时间（以秒为单位）。它最显着地在 TCP 连接关闭期间发挥作用——在 CLOSE_WAIT 和 CLOSED 状态之间，机器等待 2 个 MSL（从概念上讲是到 Internet 末端的往返行程）以获取任何迟到的数据包。在此期间，机器正在为大部分关闭的连接保留资源。如果服务器很忙，那么以这种方式持有的资源可能会成为问题。一种“修复”是降低 MSL，以便更快地发布它们。通常这可以正常工作，但偶尔会导致令人困惑的失败场景。

在 Linux 上*（反正 RHEL，这是我所熟悉的）*，“变量”`/proc/sys/net/ipv4/tcp_fin_timeout`是 2*MSL 值。通常为 60（秒）。要查看它，请执行以下操作：

```
cat /proc/sys/net/ipv4/tcp_fin_timeout 
```

要更改它，请执行以下操作：

```
echo 5 > /proc/sys/net/ipv4/tcp_fin_timeout 
```

这是 TCP 状态图。您可以在底部找到有问题的等待。

* * *

[![TCP 状态图](https://i.stack.imgur.com/5iSay.gif)](https://i.stack.imgur.com/5iSay.gif)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2018-12-06T02:43:32.850

您还可以在 netstat 或 ss 中使用 -o 来查看套接字的倒数计时器，这有助于显示有关等待时间的具体数字。例如，[TIME_WAIT 不](https://www.samir.ca/2010/12/01/tcp_fin_timeout-doesnt-control-time_wait.html)使用 tcp_fin_timeout（它基于 TCP_TIMEWAIT_LEN，通常硬编码为 60 秒）。

```
cat /proc/sys/net/ipv4/tcp_fin_timeout
3

# See countdown timer for all TIME_WAIT sockets in 192.168.0.0-255
ss --numeric -o state time-wait dst 192.168.0.0/24

NetidRecv-Q  Send-Q    Local Address:Port    Peer Address:Port                             
tcp  0       0         192.168.100.1:57516   192.168.0.10:80    timer:(timewait,55sec,0)   
tcp  0       0         192.168.100.1:57356   192.168.0.10:80    timer:(timewait,25sec,0)   
tcp  0       0         192.168.100.1:57334   192.168.0.10:80    timer:(timewait,22sec,0)   
tcp  0       0         192.168.100.1:57282   192.168.0.10:80    timer:(timewait,12sec,0)   
tcp  0       0         192.168.100.1:57418   192.168.0.10:80    timer:(timewait,38sec,0)   
tcp  0       0         192.168.100.1:57458   192.168.0.10:80    timer:(timewait,46sec,0)   
tcp  0       0         192.168.100.1:57252   192.168.0.10:80    timer:(timewait,7.436ms,0) 
tcp  0       0         192.168.100.1:57244   192.168.0.10:80    timer:(timewait,6.536ms,0) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T04:22:01.840

这看起来可以回答你的问题：

[http://seer.support.veritas.com/docs/264886.htm](http://seer.support.veritas.com/docs/264886.htm)

我建议你问问为什么有人问你这个问题，并了解这如何适用于 XMPP。

TCP/IP 图解第 1 卷已在线，并更详细地描述了 2MSL：[这里](http://books.google.com/books?id=ESM3CWY5xRYC&pg=PA818&lpg=PA818&dq=Maximum+Segment+Lifetime&source=web&ots=b3pW-JtAx-&sig=jtrxP_R9hheQ5afUWEgTX1wkbFU&hl=en&sa=X&oi=book_result&resnum=10&ct=result)

如[维基百科](http://en.wikipedia.org/wiki/Maximum_Segment_Lifetime)中所述，MSL 也在 TCP [RFC 793中进行了描述](http://www.rfc-editor.org/rfc/rfc793.txt)

# visual-studio-2008 - 任何人都经历过 VS2008 (inc SP1) 随机忽略或丢失断点？

> ID：289208
> 
> 赞同：1
> 
> 时间：2008-11-14T03:59:18.610
> 
> 标签：visual-studio-2008, breakpoints

自从升级到 2008 年以来，我和这里的许多人都注意到，随机 VS 将不再介入代码或跳过断点。它已经到了调试成为真正的苦差事的阶段。我们正在运行 SP1，但也注意到 2008 basic 上的问题。

参考罗伯特的问题：我们在 Windows 服务中托管 WCF 和远程处理服务。本质上，来自客户端（通常是 windows exe）的调用最终会在服务本身和我们的代码中的线程中结束（而不是远程处理或 WCF 基础结构）。一旦进入我们的代码，断点就会有这种行为。

我们在这里所做的大部分调试都是在服务代码中进行的，因此附加到进程是非常宝贵的，有时不可能达到所需的状态，除非在进程启动后附加到它们。使用 resharper 等扩展的开发人员和运行 vanilla VS 的开发人员都会遇到这种情况。

看谷歌并没有太大帮助。

## 还有人经历过这个吗？

问候，普雷特

* * *

Spudlo 的回答对我们很有帮助。谢谢你。[请从MSDN](http://blogs.msdn.com/jacdavis/archive/2008/11/14/debugger-qfe-for-vs-2008-sp1-released.aspx)下载修复程序

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T04:05:00.813

是的，当我忘记从 RELEASE 切换到 DEBUG 时。;)

在我意识到自己的愚蠢之前，总是让我发疯。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T04:10:24.297

需要检查的一些事项：

*   您的 PDB 是否与您的应用程序 dll 位于同一目录中？
*   他们是调试版本吗？
*   源的路径也不同吗？
*   附加时是否加载 Dll（检查输出控制台）？
*   断点在VS中是否显示为空心（未填充）圆圈？如果是这样，将鼠标悬停在断点上，它会告诉你为什么它不能设置断点。

也许作为一种解决方法，您可以从 VS 中启动该服务。如果您将应用程序更改为控制台应用程序，并添加一个调用 OnStart 方法的 main 方法（就像 windows 服务一样）。您仍然可以将应用程序安装为 Windows 服务，也可以直接从 VS 运行它：

```
public static void Main(string[] args)
{
    if (Environment.UserInteractive)
    {
        Console.WriteLine("Starting service...");
        Service1 svc = new Service1();
        svc.OnStart(args);
        Console.WriteLine("Started");
        Console.WriteLine("");
        Console.WriteLine("Press any key to stop");
        Console.Read();
        Console.WriteLine("Stopping...");
        svc.OnStop();
        Console.WriteLine("Stopped, Press any key to exit");
        Console.Read();
    }
    else
    {
        ServiceBase.Run(new Service1());
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-18T00:24:02.847

[这](http://blogs.msdn.com/jacdavis/archive/2008/11/14/debugger-qfe-for-vs-2008-sp1-released.aspx "这里")是一篇带有补丁链接的博客文章。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-15T23:22:01.117

我们看到了 SP1 的 BP 问题。我们将它报告给 Conenct ( [https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=363453)，MS](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=363453)已经向我们发送了一个 DLL 来修复它（似乎有效）。我预计 MS 将很快发布补丁。

由于您有没有 SP1 的问题，它可能有帮助，也可能没有帮助

# http - 为什么请求和响应会丢失？

> ID：289210
> 
> 赞同：2
> 
> 时间：2008-11-14T04:02:07.947
> 
> 标签：http, networking

即使在像谷歌这样的大型网站上，我有时也会提出一个请求，浏览器就坐在那里。沙漏会无限转动，直到我再次单击，然后我立即得到响应。因此，响应或请求只是在互联网上迷路了。

作为 ASP.NET Web 应用程序的开发人员，我有什么办法可以缓解这个问题，让我开发的网站的用户不会遇到这个问题？如果有的话，谷歌似乎会这样做。不过，我希望有一个解决方案。

编辑：我可以验证，对于我们的 Web 应用程序，即使在绝对最坏的情况下（例如复杂的报告），实际到达服务器的每个请求都会在几秒钟内得到处理。如果服务器处理请求的时间超过 4 秒，或者无法处理请求，并且在 30 天内未收到该电子邮件，我会发送电子邮件通知。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T07:14:07.373

客户端发出的请求有可能采用了特定路径，而该路径恰好在该特定时刻不起作用。这些是不可避免的——它们只是互联网的结果，互联网建立在不稳定的组件之上，TCP 设法确保某种保证。

就像其他人所说的 - 确保当请求到达您的服务器时，您将准备好回复。其他一切都在你的掌控之中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T04:04:43.760

他们迷路了，因为互联网是一个很大的地方，有时数据包会丢失或服务器过载。为了给您的用户提供最佳体验，请确保您拥有充足的硬件、强大的软件和良好的网络连接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T06:58:27.793

您无法控制从客户端一直到服务器的管道。管道中的任何地方都可能存在网络连接问题，包括从您的 PC 到您的 ISP 的路由器，这可能是首先查看的地方。

底线是，如果您在浏览器中打开 Google.com 时遇到问题，那么您肯定会在使用自己的 Web 应用程序**时**遇到同样的问题。

这并不是说 ASP 应用程序不能完全靠它自己产生相同类型的停机体验……经常测试和防御性代码是要牢记的关键短语。

让我们不要忘记浏览器错误。它们本身并不是近乎完美的应用程序......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T04:11:50.533

这个问题/情况不仅与 ASP 有关，而且还涵盖了保持应用程序正常运行的整个概念，非正式地称为“5 个九”或“99.999% 可用性”。

维基百科文章在[这里](http://en.wikipedia.org/wiki/High_availability)

如果您查找 5 个 9，您会发现大量有用的信息，您可以根据需要将其应用到您的应用程序中。

# sql - 在 MySQL 中更新关联表

> ID：289220
> 
> 赞同：1
> 
> 时间：2008-11-14T04:09:44.593
> 
> 标签：sql, mysql, database

下面是我的（简化的）模式（在 MySQL 版本 5.0.51b 中）和我更新它的策略。必须有更好的方法。插入新项目需要 4 次访问数据库，编辑/更新项目最多需要**7**次！

**items** : itemId, itemName
**categories** : catId, catName
**map** : mapId*, itemId, catId
* mapId (varchar) is concat of itemId + | + 猫号

1）如果插入：插入项目。通过 MySQL API 获取 itemId。
其他更新：只需更新项目表。我们已经有了 itemId。

2）有条件地批量插入`categories`。

```
INSERT IGNORE INTO categories (catName)
VALUES ('each'), ('category'), ('name'); 
```

3) 从 中选择 ID `categories`。

```
SELECT catId FROM categories
WHERE catName = 'each' OR catName = 'category' OR catName = 'name'; 
```

4) 有条件地批量插入`map`.

```
INSERT IGNORE INTO map (mapId, itemId, catId)
VALUES ('1|1', 1, 1), ('1|2', 1, 2), ('1|3', 1, 3); 
```

如果插入：我们完成了。其他更新：继续。

5) 有可能我们不再将类别与我们在更新之前所做的此项目相关联。删除此 itemId 的旧类别。

```
DELETE FROM MAP WHERE itemId = 2
AND catID <> 2 AND catID <> 3 AND catID <> 5; 
```

6) 如果我们将自己与某个类别脱节，那么我们可能会将其孤立。我们不想要没有项目的类别。因此，如果`affected rows > 0`，杀死孤立的类别。我还没有找到在 MySQL 中组合这些的方法，所以这是 #6 和 #7。

```
SELECT categories.catId
FROM categories
LEFT JOIN map USING (catId)
GROUP BY categories.catId
HAVING COUNT(map.catId) < 1; 
```

7) 删除​​在步骤 6 中找到的 ID。

```
DELETE FROM categories
WHERE catId = 9
  AND catId = 10; 
```

请告诉我有一个更好的方法，我没有看到。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T04:28:00.703

你可以做很多事情来让事情变得更容易：

*   阅读关于 [ `INSERT...ON DUPLICATE KEY UPDATE`][1]

*   在插入新类别之前删除旧类别。这可能会更好地受益于索引。

    `DELETE FROM map WHERE itemId=2`;

*   你可能不需要`map.mapID`. 相反，在`(itemID, catID)`.

*   正如彼得在他的回答中所说，使用 MySQL 的多表删除：

    ```
    DELETE categories.* FROM categories LEFT JOIN map USING (catId) 
    WHERE map.catID IS NULL 
    ```

    [http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html](http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T06:06:08.337

此外，如果您担心访问数据库，请在存储过程中执行步骤。然后你有一次旅行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T04:17:24.967

步骤 6 和 7 可以很容易地组合：

```
DELETE categories.*
FROM categories
LEFT JOIN map USING (catId)
WHERE map.catID IS NULL; 
```

步骤 3 和 4 也可以组合：

```
INSERT IGNORE INTO map (mapId, itemId, catId)
    SELECT CONCAT('1|', c.catId), 1, c.catID
    FROM categories AS c
    WHERE c.catName IN('each','category','name'); 
```

否则，您的解决方案非常标准，除非您想使用触发器来维护映射表。

# c# - 围绕存储过程自动创建 C# 包装类

> ID：289221
> 
> 赞同：7
> 
> 时间：2008-11-14T04:09:57.543
> 
> 标签：c#, sql-server, stored-procedures, orm

我继承了一个相当大的应用程序，它确实可以使用一些清理。整个应用程序中散布着数据访问代码。在代码后面，一些在业务逻辑类中，一些在经典的 asp 页面中。

我想做的是重构这段代码，将所有数据访问代码删除到几个 DAL 类中。

所有数据访问都是通过存储过程（Microsoft SQL 2000）完成的。其中有300-400个。

似乎应该有一种自动化的方法来分析存储过程，并为每个存储过程自动生成 c# 方法，将方法参数映射到存储过程参数，并使用返回数据表的方法。

我对 ORM 产品没有任何经验，我不确定我正在寻找的是一个完整的 ORM，还是只是一个有助于在 sp 调用周围生成简单包装器的第 3 方实用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T04:14:20.590

如果您可以访问 .NET Framework 3.5 和 Linq to SQL，您可以很容易地做到这一点，请查看此视频：

[LINQ to SQL：使用存储过程](http://weblogs.asp.net/scottgu/archive/2007/08/16/linq-to-sql-part-6-retrieving-data-using-stored-procedures.aspx)

> 使用 LINQ 可以轻松使用现有的存储过程和函数。我们只需将存储过程拖到 O/R 映射表面上，然后从生成的数据上下文对象中调用它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T04:14:44.973

我建议您获取 Code Smith。该产品包括一个 ORM 模板，并完全支持从 DB Schemas 生成类（我认为是 Procs）。然后，您可以对您需要的所有对象进行代码生成。

另一种选择是使用 LINQ to SQL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T04:32:49.307

我的方法是先考虑更高层次——以最佳方式创建数据访问类和方法，以满足现有或新代码库的需求。然后，对新对象使用现有的过程调用。

我认为您不应该为这项任务考虑任何形式的大规模自动化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T04:27:35.977

将存储过程拖放到数据集设计图面上（在 .net 2.0 及更高版本中）会生成包装函数

但是如果你有很多事情要做，你最好使用或编写一个简单的代码生成器

有两种选择：

1.  自己生成包装代码作为 C# 类/方法
2.  生成一个 dataset.xsd 文件，然后在 Visual Studio 中打开它，让设计人员为您生成类/方法

后者可以通过数据集设计表面进行维护，但可能很难正确生成（第一次）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T04:35:44.433

与 Robert 的建议类似，我们编写了自己的 Code Smith 版本。

我们的“代码生成器”有两部分：SQL 和类。

SQL：将生成更新、选择和删除存储过程。

C#：将生成类并将文件保存为 .cs

我们调用： sp_MShelpcolumns ' *tablename* ' 来获取字段和数据类型的列表，然后进行替换。

它不是一个完美的解决方案，但对于完成前 80% 非常有效

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-19T14:52:00.163

不确定，但似乎这正是您所要求的。

[http://www.codeproject.com/KB/database/SPGenerator.aspx](http://www.codeproject.com/KB/database/SPGenerator.aspx)

# internet-explorer - Internet Explorer 8 是否支持 HTML 5？

> ID：289225
> 
> 赞同：138
> 
> 时间：2008-11-14T04:12:23.013
> 
> 标签：internet-explorer, internet-explorer-8, html

IE8 中是否有任何 HTML5 支持？它在 IE8 路线图上吗？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2008-11-14T08:04:59.283

IE8 beta 2 支持来自 HTML5 的两种 API：[跨文档消息传递](http://www.whatwg.org/specs/web-apps/current-work/#crossDocumentMessages)和[非 SQL 存储](http://www.whatwg.org/specs/web-apps/current-work/#storage)。

IE8 beta 2 没有实现 HTML5 解析算法或新元素（不支持`<canvas>`或不`<video>`支持）。

还有一些错误修复可以更好地使 IE8 与 HTML5 保持一致。

* * *

## 回答 #2

> 赞同：72
> 
> 时间：2010-09-19T14:49:20.890

您可以通过在头部包含这个 JavaScript 来获得在 IE8 中工作的 HTML5 标记。

```
<script type="text/javascript">
 document.createElement('header');
 document.createElement('nav');
 document.createElement('menu');
 document.createElement('section');
 document.createElement('article');
 document.createElement('aside');
 document.createElement('footer');
</script> 
```

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2009-11-18T22:48:41.660

您可以使用[这个 IE HTML5 shim 脚本](http://remysharp.com/2009/01/07/html5-enabling-script/)来获得对 HTML5 中新语义元素的基本支持，例如`<article>`.

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2009-12-01T16:28:09.413

[Modernizr](http://www.modernizr.com/)也是提供 IE HTML5 渲染功能的绝佳选择。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2011-03-08T23:57:12.557

是否支持

```
<!DOCTYPE html> 
```

是的，它确实。

也许更好的问题是 IE8 支持哪些现代 Web 功能。[caniuse.com](http://caniuse.com/)、[html5test.com](http://html5test.com/)和[browserscope.org](http://browserscope.org)是回答问题的最佳地点。

HTML5 对不同的人意味着很多不同的东西。如今，它意味着 HTML、CSS 和 JavaScript 功能。这个术语变得有点像“Web 2.0”。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2008-12-07T14:22:57.343

还支持 HTML5 [hashchange 事件](http://www.whatwg.org/specs/web-apps/current-work/#handler-onhashchange)和[在线、离线事件](http://www.whatwg.org/specs/web-apps/current-work/#dom-navigator-online)

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2011-05-09T07:17:44.970

IE8 对 HTML5 的支持是有限的，但[Internet Explorer 9](http://windows.microsoft.com/en-US/internet-explorer/products/ie/home)刚刚发布，对新兴的 HTML5 技术有*很强的支持。*

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2010-02-02T21:37:01.027

HTML5 仍处于草案规范中（并将持续很长时间）。何苦？

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2011-03-11T13:06:30.667

查看所有浏览器和版本（包括未来版本）的所有 HTML 5 功能的[**caniuse指南。**](http://caniuse.com/)

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2014-03-17T18:00:28.003

您可以使用它来使 IE8 理解/支持基本的 HTML5 标签。

```
<!--[if lt IE 9 ]> 
    <script type="text/javascript">
        var html5Elem = ['header', 'nav', 'menu', 'section', 'article', 'aside', 'footer'];
        for (var i = 0; i < html5Elem.length; i++){
            document.createElement(html5Elem[i]);
        }
    </script>
<![endif]--> 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-11-14T04:18:06.543

根据[http://msdn.microsoft.com/en-us/library/cc288472(VS.85).aspx#html](http://msdn.microsoft.com/en-us/library/cc288472(VS.85).aspx#html)，IE8 将拥有“强大”的 HTML 5 支持。我还没有看到任何讨论究竟什么是“强大的支持”，但我可以说是的，一些 HTML5 的东西将进入 IE8。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-12-13T03:19:41.363

您可以在此处阅读有关 IE8 和 HTML 5 支持的更多信息：

[http://blogs.msdn.com/giorgio/archive/2009/11/29/ie8-and-html-5.aspx](http://blogs.msdn.com/giorgio/archive/2009/11/29/ie8-and-html-5.aspx)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2011-03-09T00:04:18.713

这里的其他一些答案是关于向 IE8 和其他浏览器添加 HTML5 功能。这些被称为[Polyfills ，我最喜欢](http://remysharp.com/2010/10/08/what-is-a-polyfill/)[在这里](https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-browser-Polyfills)找到它们。

# php - TCP Socket Networking 有哪些可用的 PHP 扩展？

> ID：289231
> 
> 赞同：0
> 
> 时间：2008-11-14T04:16:16.313
> 
> 标签：php, network-programming

我正在寻找一个 PHP 扩展，它允许我在 TCP 套接字上连接、绑定/侦听、发送和接收数据。

有一个 PEAR 包 Net_Socket：

[http://pear.php.net/package/Net_Socket](http://pear.php.net/package/Net_Socket)

但这需要安装 PEAR，我们不想这样做，因为这会增加内存消耗。

是否有可用的纯 C 扩展？

谢谢，肯尼斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T04:21:18.097

几个选项：

*   [PHP 套接字](http://php.net/manual/en/ref.sockets.php)（在大多数版本中可用）
*   [PHP 流](http://php.net/manual/en/ref.stream.php)(5+)

# iphone - 在 iphone 应用程序中添加 AppKit 框架时出错

> ID：289236
> 
> 赞同：0
> 
> 时间：2008-11-14T04:18:40.583
> 
> 标签：iphone, nsfilewrapper

我想在我的 iphone 应用程序中导入，但我知道这个框架在 iphone sdk 中不可用，但我需要在这个框架中使用 NSfileWrapper 类，这个类是否也可以在 UIKit 或 iphone sdk 中可用的其他框架中使用，谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-14T04:25:11.973

不，NSFileWrapper 在 iPhone 上不可用。简单地添加一个 iPhone 上不存在的框架也不会为您带来任何好处。在 iPhone 上，您的应用程序在访问文件方面非常有限，您基本上必须使用 Foundation 框架为 iPhone 提供的类和方法。

# iphone - 如何转储存储在 Objective-C 对象（NSArray 或 NSDictionary）中的数据

> ID：289241
> 
> 赞同：48
> 
> 时间：2008-11-14T04:24:29.837
> 
> 标签：iphone, objective-c, gdb, dump

请原谅我在这里提出一个可能很愚蠢的问题，但在其他编程语言（如 PHP 或 Perl 之类的脚本语言）中，通常很容易转储变量中包含的所有内容。

例如，在 PHP 中有`var_dump()`or`print_r()`函数。Perl 有`Data::Dumper`CPAN 类等。

Objective-C 有类似的东西吗？在某些情况下，能够像这样转储所有内容会非常方便，而不是使用 gdb 检查每个变量。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2008-11-14T04:57:20.630

在 Cocoa 中，没有像 PHP 的 print_r 或 python 的**repr**这样的“转储”，因为没有像这些语言那样“表示”对象的文本格式。如果你使用

```
NSLog(@"%@", myObj); 
```

或者

```
NSString *stringRep = [NSString stringWithFormat:@"%@",myObj]; 
```

或者

```
NSString *stringRep = [myObj description]; 
```

您将获得（在第一种情况下记录到控制台）的结果`[myObj description]`，该方法定义`NSObject`为用于打印对象的*描述*（**而不是**转储）。

如果您`po myObj`在 gdb 中调用，您会得到`[myObj debugDescription]`（通常与 相同`description`，但并非总是如此）。

类`NSArray`和`NSDictionary`覆盖打印一个非常有用的对其内容的递归描述，但默认`NSData`只打印与实例对应的指针值。`description``[NSObject description]`

如果您控制相关类型的代码，则可以覆盖它们的`description`或`debugDescription`方法以返回您想要的任何内容。如果没有，您可以使用类别覆盖`description`or`debugDescription`方法，或使用类别来定义 a`myDebugDescription`或 some 这样您就可以从 gdb 使用`po [myObj myDebugDescription]`.

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-11-14T05:08:34.460

您还可以使用 gdb print object 命令在调试器中快速查看对象：

```
po dictionary 
```

这与在代码中调用 NSLog(...) 基本相同。

在打印出包含 ASCII 数据的 NSData 时也很有用：

```
p (char *) [data bytes] 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-11-14T04:29:19.470

使用 NSLog() 转储对象的内容。例如：

```
NSData* myData = //... assume this exists
NSLog(@"Contents of myData: %@", myData); 
```

NSLog 有一个 printf 样式的格式字符串（需要一个 NSString 对象），后跟一个可变参数列表，就像 printf 一样。替换字符 %@ 表示对象的描述方法。这对于在 Cocoa 中转储大多数 Objective-C 对象很有用。

如果你想使用 gdb 转储对象的内容（我看到你用 gdb 标记了它），使用特殊的“po”指令而不是 print。例如：

```
gdb) po myData 
```

将导致 gdb 转储 myData 对象。po 是打印对象的快捷方式。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-14T07:14:26.687

小心 NSLog 日志记录->您很可能不希望它在生产代码中。

当您的产品在调试模式下运行时，您可能希望使用调用 NSLog 的备用日志记录函数。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-03-13T23:09:44.013

我通常用它来“调试” NSArray 内容：

```
NSEnumerator *arrenum = [myarray objectEnumerator];
id cobj;     
while ( cobj = [arrenum nextObject] ) {
   NSLog(@"%@", cobj);
} 
```

该代码将枚举 NSArray 中的所有对象`myarray`，然后遍历并打印每个对象。

希望这对某人有用！

# data-structures - 集合中“查找、删除和返回元素”的术语？

> ID：289255
> 
> 赞同：3
> 
> 时间：2008-11-14T04:34:21.190
> 
> 标签：data-structures, programming-languages, naming-conventions, terminology, naming

标题主要说明了这一点。我想在 C# 中向基本 Dictionary 类添加一个简单的扩展方法。起初我打算将它命名为 Pop(TKey key)，有点像 Stack 方法，但它接受一个用于查找的键。

然后我打算做Take(TKey key)，但是它与同名的LINQ方法不谋而合……虽然C# 3.0可以让你这样做，但我不喜欢它。

那么，您认为，只是坚持使用 Pop 还是“查找并删除元素”有更好的术语？

（我觉得问这个问题有点尴尬，这似乎是一件微不足道的事情......但我喜欢使用标准，而且我对许多语言/环境没有丰富的经验。）

编辑：对不起，应该解释更多......在这种情况下，我不能使用术语删除，因为它已经由我使用新方法扩展的类定义。

编辑 2：好的，这就是我到目前为止所拥有的，受到群众智慧的启发：

```
public static TValue Extract<TKey, TValue>
(
    this Dictionary<TKey, TValue> dict,
    TKey key
)
{
    TValue value = dict[key];
    dict.Remove(key);
    return value;
}

public static bool TryExtract<TKey, TValue>
(
    this Dictionary<TKey, TValue> dict,
    TKey key,
    out TValue value
)
{
    if( !dict.TryGetValue(key, out value) )
    {
        return false;
    }
    dict.Remove(key);
    return true;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-14T04:48:47.683

我认为是**提取物**，就像考古学家在地下*找到一具木乃伊，**将其移除*，然后将其*归还*博物馆 :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T04:36:41.433

[已经提供的 Remove(key) 方法](http://msdn.microsoft.com/en-us/library/system.collections.idictionary.remove.aspx)有什么特别的问题吗？

哦等等，你也想返回删除的元素吗？怎么样

```
object valueRemoved = someDictionary.RemoveElement(key) 
```

很容易实现为

```
if (!dict.ContainsKey(key))
{
    return null;
}
object val = dict[key];
dict.Remove(key);
return val; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T04:44:05.880

我的第一个猜测是“接受”，但正如你所指出的，那已经被接受了。我的下一个建议是“提取”或“分离”，但它们可能是模棱两可的。

“退出”或“退出”怎么样？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-14T05:03:56.480

这个动作有点让人想起一个叫做[Linda](http://en.wikipedia.org/wiki/Linda_(coordination_language))的旧协作平台（主要是学术） 。在那种环境下，你所说的将被称为“in”。但这是一个糟糕的名字——他们基本上把名字倒过来了，因为他们从共享元组空间的角度来命名它们。所以，没关系。

Extract 很好，“Pop”也很明显（几乎任何人都会知道你在做什么，即使它不是堆栈）。

# c# - 有没有办法不在 Visual Studio 中创建显式 EventHandler 委托？

> ID：289261
> 
> 赞同：3
> 
> 时间：2008-11-14T04:37:53.587
> 
> 标签：c#, visual-studio, visual-studio-2008

Visual Studio 喜欢在键入时提供帮助：

```
Event += 
```

通过生成如下代码：

```
Event += new EventHandler(EventClassName_Event);

void EventClassName_Event(object sender, EventArgs e)
{
    throw new System.NotImplementedException();
} 
```

理想情况下，我想删除显式委托并添加显式私有。像这样：

```
Event += EventClassName_Event;

private void EventClassName_Event(object sender, EventArgs e)
{
    throw new System.NotImplementedException();
} 
```

我看了看是否有一个片段，但什么也没找到。有什么建议么？如果有办法可以做到这一点，我确实安装了 ReSharper。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T04:42:04.293

如果我键入以下内容，则使用 Resharper：

```
myObject.SomeEvent += 
```

然后按 Ctrl-Shift-Space，我可以选择创建方法或委托（或使用现有方法）。我想这就是你想要的。

# java - 如何识别哪些代码行参与了 Java 程序的特定执行？

> ID：289270
> 
> 赞同：5
> 
> 时间：2008-11-14T04:46:01.540
> 
> 标签：java, eclipse, profiling, code-coverage, trace

假设我在 IDE（本例中为 Eclipse）中有一个 Java 程序。现在假设我执行程序并在某个时候终止它或它自然结束。

有没有一种**方便**的方法来确定哪些行至少执行一次而哪些没有执行（例如，异常处理或未达到的条件？）

手动收集这些信息的方法是不断地进行调试并维护一组我们至少经过一次的行。但是，是否有一些工具或分析器已经这样做了？

编辑：只是为了澄清：我需要能够以编程方式访问此信息，而不必从 JUnit 测试中访问。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-14T04:51:56.100

[eclemma](http://www.eclemma.org/)将是一个好的开始：代码覆盖工具将允许覆盖会话记录您正在寻找的信息。

[![替代文字](https://i.stack.imgur.com/bWhQj.gif)](https://i.stack.imgur.com/bWhQj.gif)
[（来源：[eclemma.org](http://www.eclemma.org/images/smallscreen.gif)）]

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-14T04:52:30.327

你问的是所谓的“覆盖”。有几种工具可以衡量这一点，其中一些工具集成到 Eclipse 中。我用过[jcoverage](http://java-source.net/open-source/code-coverage/jcoverage-gpl)并且它可以工作（我相信它有一个免费试用期，之后你必须购买它）。我没用过，但你也可以试试[Coverlipse](http://coverlipse.sourceforge.net/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-14T05:58:37.540

如果我正确理解了这个问题，那么您需要的不仅仅是标准的堆栈跟踪数据，但您不想使用例如 log4j 调试语句手动检测您的代码。

我唯一能想到的就是添加某种字节码跟踪。请参阅[检测 Java 字节码](http://www.cs.helsinki.fi/u/pohjalai/k05/okk/seminar/Aarniala-instrumenting.pdf)。这篇文章引用了我没有使用过但听起来像你需要的[Cobertura ...](http://cobertura.sourceforge.net/)

# php - 如何使用 PHP 解码 base64（小端）？

> ID：289271
> 
> 赞同：-1
> 
> 时间：2008-11-14T04:48:27.947
> 
> 标签：php, base64

如何在 PHP 中解码 base64 编码的消息？我知道如何使用 PHP_base64_decode 函数，但我想知道如何编写 little endian 部分，如下面的代码，它是带有 little endian 的 base64 代码：（如何在 php 中编写 little endian 部分）

**原始 Base64 内容（由原始海报发布）**：

[https://stackoverflow.com/revisions/viewmarkup/374860](https://stackoverflow.com/revisions/viewmarkup/374860)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-14T04:58:56.210

使用[base64_decode()](http://php.net/base64_decode)函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-19T08:26:40.987

Base64 将字节流转换为可打印字符。没有什么可以出错的。

'Little-endian' 描述了可以将数字转换为字节序列的两种方式之一：little-endian = 最低有效字节优先。Big-endian = 最高有效字节在前。UTF-8 是将字符串编码为字节流，并且要应用字节顺序的概念。然而，UTF16 将文本编码为 16 位字，并且有两种将字编码为字节的方法，并且 UTF16 有两种形式：UTF16LE（小端）和 UTF16BE（大端）。相同的字节顺序概念也适用于 UTF32，但这不是一种常见的格式。

如果小端法是指 UTF16LE，那么您必须决定要将字符串重新编码为哪种格式（可能是 UTF-8）。
**您可以使用此功能：** `mb_convert_encoding($input, 'UTF-8', 'UTF-16LE')` [1][2]

如果小端序是指数字，那么您必须在将字节转换为数字时指定字节序。

[1] [http://cz.php.net/manual/en/function.mb-convert-encoding.php](http://cz.php.net/manual/en/function.mb-convert-encoding.php)
[2] [http://cz.php.net/manual/en/mbstring.supported-encodings.php](http://cz.php.net/manual/en/mbstring.supported-encodings.php)

# ios - 在 iOS 中导入 zlib 时出错：找不到符号 collect2：ld

> ID：289274
> 
> 赞同：28
> 
> 时间：2008-11-14T04:52:22.620
> 
> 标签：ios, linker, zlib

我已经包含`<zlib.h>`在我的 iphone 应用程序和源代码中，我正在模拟 Brad Larson 提供的 Molecules 示例代码，但是，当我构建项目时，它返回如下错误。谁能为我指出这是图书馆链接问题还是我错过了其他东西？

```
"_deflate", referenced from: -[NSData(Gzip) gzipDeflate] in NSData+Gzip.o "_inflateEnd", 
referenced from: -[NSData(Gzip) initWithGzippedData:] in NSData+Gzip.o "inflateInit2", 
referenced from: -[NSData(Gzip) initWithGzippedData:] in NSData+Gzip.o "_inflate", 
referenced from: -[NSData(Gzip) initWithGzippedData:] in NSData+Gzip.o "_deflateEnd", 
referenced from: -[NSData(Gzip) gzipDeflate] in NSData+Gzip.o "deflateInit2", referenced 
from: -[NSData(Gzip) gzipDeflate] in NSData+Gzip.o ld: symbol(s) not found collect2: ld 
returned 1 exit status 
```

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2008-11-14T05:05:50.940

在您的目标`Build Settings`选项卡中，向下滚动到该`Other Linker Flags`部分并确保`-lz`在该字段中。这将链接到内置的 zlib，您的错误应该会消失。

更改链接器标志后，您必须在再次构建之前`Clean`从菜单中进行选择。`Product`

[![lz截图](https://i.stack.imgur.com/jcba2.jpg)](https://i.stack.imgur.com/jcba2.jpg)

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2008-11-14T05:15:23.183

将 libz 添加到您的项目中。为此，请在 Xcode 中执行以下步骤：

1.  打开您的项目，选择您的项目目标，然后单击工具栏上的蓝色项目信息图标（或按⌘I）
    ![示例 1](https://lh3.ggpht.com/_iSbzrixSaec/SR0H8kAfFlI/AAAAAAAAAu8/qY58X4XyDrw/s640/Picture%201.png)
2.  单击屏幕左下角的+按钮添加库，向下滚动到库列表底部并选择libz.dylib；单击添加按钮。
    ![示例 2](https://lh3.ggpht.com/_iSbzrixSaec/SR0H88FuRiI/AAAAAAAAAvM/TMCHUosh6vU/s576/Picture%204.png)
3.  单击添加后，您将看到库名称出现在链接库列表中。您现在将能够构建您的项目而不会出现链接错误。
    ![示例 3](https://lh4.ggpht.com/_iSbzrixSaec/SR0H9JCWkTI/AAAAAAAAAvU/fyHvgFJrstM/s576/Picture%205.png)

您可以使用相同的方法从列表中添加任何库。如果该库未出现在列表中，那么您知道它不是标准 iPhone SDK 的一部分，您可能需要重新考虑您的解决方案或自己静态构建库并将您的目标链接到该库（如果可能的话）。

# vb6 - Vb6：通过浏览按钮选择稍后使用的文件

> ID：289276
> 
> 赞同：4
> 
> 时间：2008-11-14T04:53:09.997
> 
> 标签：vb6

这是我的代码（请注意，这是由朋友提供的）：

```
Private Sub Browse_Click()
   Dim textfile As String
   textfile = Space(255)
   GetFileNameFromBrowseW Me.hWnd, StrPtr(sSave), 255, StrPtr("c:\"), 
      StrPtr("txt"), StrPtr("Apps (*.txt)" + Chr$(0) + "*.txt" + Chr$(0) +
      "All files (*.*)" + Chr$(0) + "*.*" + Chr$(0)), StrPtr("Select File")
      Text1 = Left$(textfile, lstrlen(textfile))
End Sub 
```

基本上稍后我编辑选择的文本文件，所以稍后我只需在我的函数中使用 textfile 来调用它。但是我找不到一条路径，所以我觉得我做错了什么。提前致谢。

编辑：我要做的就是选择一个文本文件，然后可以调用它并使用它。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-14T09:41:43.317

正如 shahkalpesh 所提到的，您只需使用标准 COM 库即可访问此功能。

在 VB6 中，添加组件：

*   项目 > 组件
*   在控件选项卡上，选择 Microsoft Common Dialog Control 6.0 (SP6)

现在在您的表单上，从工具箱中添加新的 Common Dialog 控件

在代码中，您需要：

```
CommonDialog.Filter = "Apps (*.txt)|*.txt|All files (*.*)|*.*"
CommonDialog.DefaultExt = "txt"
CommonDialog.DialogTitle = "Select File"
CommonDialog.ShowOpen

'The FileName property gives you the variable you need to use
MsgBox CommonDialog.FileName 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T05:40:35.517

这个功能不是VB6中的“通用对话框控件”提供的吗？

我的 VB6 有点生疏，但已经提供了选择文件的基本对话框。
工具 -> 控件 -> Microsoft 通用对话框控件 v....

此外，您对 GetFileNameFromBrowseW 的调用不包括引用变量 - textfile

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T05:19:21.800

也许 sSave 包含路径名，但 textfile 包含 255 个空格。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T08:39:02.147

替换`sSave`为`textfile`。当您稍后需要参考选择的文件时，请使用`Text1`（可能是一个 VB 文本框控件，因此 Text1 单独隐式调用`Text1.Text`，`.Text`是 VB.Textbox 的默认成员）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T18:19:10.540

从[这里](http://allapi.mentalis.org/apilist/GetFileNameFromBrowse.shtml)

我找到了这段代码并运行了它。

```
Private Const VER_PLATFORM_WIN32_NT = 2
Private Type OSVERSIONINFO
    dwOSVersionInfoSize As Long
    dwMajorVersion As Long
    dwMinorVersion As Long
    dwBuildNumber As Long
    dwPlatformId As Long
    szCSDVersion As String * 128
End Type
Private Declare Function GetVersionEx Lib "kernel32" Alias "GetVersionExA" (ByRef lpVersionInformation As OSVERSIONINFO) As Long
Private Declare Function GetFileNameFromBrowseW Lib "shell32" Alias "#63" (ByVal hwndOwner As Long, ByVal lpstrFile As Long, ByVal nMaxFile As Long, ByVal lpstrInitialDir As Long, ByVal lpstrDefExt As Long, ByVal lpstrFilter As Long, ByVal lpstrTitle As Long) As Long
Private Declare Function GetFileNameFromBrowseA Lib "shell32" Alias "#63" (ByVal hwndOwner As Long, ByVal lpstrFile As String, ByVal nMaxFile As Long, ByVal lpstrInitialDir As String, ByVal lpstrDefExt As String, ByVal lpstrFilter As String, ByVal lpstrTitle As String) As Long
Private Sub Form_Load()
    'KPD-Team 2001
    'URL: http://www.allapi.net/
    'E-Mail: KPDTeam@Allapi.net
    Dim sSave As String
    sSave = Space(255)
    'If we're on WinNT, call the unicode version of the function
    If IsWinNT Then
        GetFileNameFromBrowseW Me.hWnd, StrPtr(sSave), 255, StrPtr("c:\"), StrPtr("txt"), StrPtr("Text files (*.txt)" + Chr$(0) + "*.txt" + Chr$(0) + "All files (*.*)" + Chr$(0) + "*.*" + Chr$(0)), StrPtr("The Title")
    'If we're not on WinNT, call the ANSI version of the function
    Else
        GetFileNameFromBrowseA Me.hWnd, sSave, 255, "c:\", "txt", "Text files (*.txt)" + Chr$(0) + "*.txt" + Chr$(0) + "All files (*.*)" + Chr$(0) + "*.*" + Chr$(0), "The Title"
    End If
    'Show the result
    MsgBox sSave
End Sub
Public Function IsWinNT() As Boolean
    Dim myOS As OSVERSIONINFO
    myOS.dwOSVersionInfoSize = Len(myOS)
    GetVersionEx myOS
    IsWinNT = (myOS.dwPlatformId = VER_PLATFORM_WIN32_NT)
End Function 
```

据我所知，GetFileName 函数看起来不错，所以我猜问题出在这个

```
Text1 = Left$(textfile, lstrlen(textfile)) 
```

用这个来检查

```
MsgBox "(" & Text1 & ")-(" & textfile & ")" 
```

确保您从 Left$ 和 lstrlen 获得预期结果

# c++ - strtok 并替换 C++ 中的子字符串

> ID：289278
> 
> 赞同：1
> 
> 时间：2008-11-14T04:55:24.500
> 
> 标签：c++, string, strtok

如果我有一个字符串“12 23 34 56”

将其更改为“\x12 \x23 \x34 \x56”的最简单方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T05:03:49.163

```
string s = "12 23 34 45";
stringstream str(s), out;
int val;
while(str >> val)
    out << "\\x" << val << " "; // note: this puts an extra space at the very end also
                               //       you could hack that away if you want

// here's your new string
string modified = out.str(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T05:35:23.673

你的问题是模棱两可的，这取决于你真正想要什么：

如果您希望结果与以下内容相同： char s[] = { 0x12, 0x34, 0x56, 0x78, '\0'}: 那么您可以这样做：

```
std::string s;
int val;
std::stringstream ss("12 34 56 78");
while(ss >> std::hex >> val) {
   s += static_cast<char>(val);
} 
```

在此之后，您可以使用以下方法对其进行测试：

```
for(int i = 0; i < s.length(); ++i) {
    printf("%02x\n", s[i] & 0xff);
} 
```

这将打印：

```
12
34
56
78 
```

否则，如果你希望你的字符串字面上是 "\x12 \x23 \x34 \x56" 那么你可以按照 Jesse Beder 的建议去做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T05:04:44.403

你可以这样做：

```
foreach( character in source string)
{
  if 
    character is ' ', write ' \x' to destination string
  else 
    write character to destination string.
} 
```

我建议使用 std::string 但这可以通过首先检查字符串来计算有多少空格然后创建新的目标字符串来很容易地完成该数字 x3。

# gwt - EC2：我可以在那里托管一个 http 服务器吗？

> ID：289285
> 
> 赞同：5
> 
> 时间：2008-11-14T04:59:14.430
> 
> 标签：gwt, hosting, amazon-ec2, deployment

有人有将 GWT 应用程序部署到 EC2 的经验吗？

如果我要在 ec2 实例上安装 tomcat 或 apache，我可以让用户直接连接到指向那里的 url 吗？

这是否具有成本效益，或者 Java 托管服务是最好的？

在常规托管服务上托管边缘 HTTP 服务器并直接向 EC2 请求是否有任何缺点？性能在这里有问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-01T20:29:44.453

其他答案是正确的，但我只是想分享一个事实，即我们正在开发一个 100% 基于 EC2/S3 并且还具有纯 GWT 前端的产品。

我们使用 maven2 进行构建和出色的 gwt-maven 插件。这使得生成 Web 应用程序的 WAR 包作为输出变得容易。我们使用 Jetty，但 Tomcat 也可以。

我们在 VM 上运行了 pound（一个 http 加速器/负载均衡器），监听 http 和 https，然后将请求转发到 lighttpd（静态）或 jetty（应用程序）。这也简化了 SSL 证书，因为 pound 处理 SSL。我发现使用 SSL 证书配置 Java 服务器一直很痛苦。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-14T05:31:35.943

是的，您几乎可以托管任何您想要的东西，因为您实际上拥有一台专用的 Linux 机器。

我上次记得，EC2 实例的基本费率在他们的“低端机器”上计算为每月 75 美元左右，因此您可以将其用作与其他供应商的基准。这还假设机器 24x7 全天候运行（因为您按小时付费）。

EC2 实例的主要缺点只是它可以随时“消失”，而当它这样做时，写入您的实例的任何数据也将“消失”。

这意味着您需要对其进行设置，以便您可以轻松地重新启动服务器，但您还需要将您生成并希望保留的任何数据离线（无论是亚马逊的其他服务之一，如 S3，还是其他一些外部服务）。这将产生一些额外的费用，具体取决于数量。

最后，您还将为服务的任何流量付费。

与之比较的是来自其他供应商的另一个“虚拟服务器”。使用 EC2 可以完成很多有趣的事情，但如果您只使用一台机器，使用专用的虚拟主机服务可能会更容易。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-05T04:59:31.630

其他人给出了很好的答案。我不得不补充一点，您需要花程序员时间了解 EC2 的怪癖并解决它们（例如使用 EBS）。这并非完全无关紧要，尽管拥有它是有用的知识，并且可能仅出于这个原因就值得，但如果您想仅使用几台服务器快速启动并运行，您可能应该查看其他托管选项。

另一方面，如果您计划大规模扩展（最终在 EC2 上托管许多服务器），那么我强烈推荐它。你必须设计一些东西，但无论如何你都需要这样做。一旦达到一定的运营规模，按需计算的灵活性和普遍低廉的价格使其成为杀手级平台。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-14T06:54:07.243

您绝对可以在 EC2 中托管一个 http 服务器，但您需要考虑以下几点：

*   如前所述，成本可能比替代托管解决方案高得多
*   您的实例（您在 EC2 中启动的机器）可能会意外关闭。亚马逊不保证 24x7 的可用性。这意味着您存储在本地存储中的数据将会丢失，并且当您启动一个新实例时，它将获得一个新 IP。

因此，要在 EC2 中成功托管服务器，您需要使用 Amazon 的一些其他服务。您需要弹性 IP，这样您就可以规避新 IP 地址问题。您还可以使用弹性块存储。这是一项服务，可让您在您的机器上安装一个磁盘，当您的实例丢失时该磁盘不会消失。

# c# - 您可以将多个列表与 LINQ 结合起来吗？

> ID：289307
> 
> 赞同：18
> 
> 时间：2008-11-14T05:20:23.407
> 
> 标签：c#, .net, linq

假设我有两个列表：

```
var list1 = new int[] {1, 2, 3};
var list2 = new string[] {"a", "b", "c"}; 
```

是否可以编写将生成以下列表的 LINQ 语句：

```
var result = new []{ 
    new {i = 1, s = "a"},
    new {i = 1, s = "b"},
    new {i = 1, s = "c"},
    new {i = 2, s = "a"},
    new {i = 2, s = "b"},
    new {i = 2, s = "c"},
    new {i = 3, s = "a"},
    new {i = 3, s = "b"},
    new {i = 3, s = "c"}
}; 
```

?

编辑：我忘了提到我不想在查询语法中使用它。无论如何，根据 preetsangha 的回答，我得到以下信息：

```
var result = list1.SelectMany(i =>  list2.Select(s => new {i = i, s = s})); 
```

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-11-14T05:25:13.973

```
var result = from l1 in list1
             from l2 in list2       
             select new { i = l1, s = l2}; 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-11-14T06:26:49.903

preetsangha 的回答是完全正确的，但如果你不想要查询表达式，那么它是：

```
var result = list1.SelectMany(l1 => list2, (l1, l2) => new { i = l1, s = l2} ); 
```

（这就是编译器将查询表达式编译成的内容——它们是相同的。）

# java - 在 Java 中输出 RFC 3339 时间戳

> ID：289311
> 
> 赞同：44
> 
> 时间：2008-11-14T05:26:05.813
> 
> 标签：java, timestamp, rfc3339

我想输出一个带有 PST 偏移量的时间戳（例如，2008-11-13T13:23:30-08:00）。`java.util.SimpleDateFormat`似乎没有以*小时：分钟*格式输出时区偏移量，它不包括冒号。有没有一种简单的方法可以在 Java 中获取该时间戳？

```
// I want 2008-11-13T12:23:30-08:00
String timestamp = new SimpleDateFormat("yyyy-MM-dd'T'h:m:ssZ").format(new Date());
System.out.println(timestamp); 
// prints "2008-11-13T12:23:30-0800" See the difference? 
```

此外，`SimpleDateFormat`无法正确解析上面的示例。它抛出一个`ParseException`.

```
// Throws a ParseException
new SimpleDateFormat("yyyy-MM-dd'T'h:m:ssZ").parse("2008-11-13T13:23:30-08:00") 
```

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2014-03-31T12:12:51.853

从 Java 7 开始，就有`X`了 ISO8601 时区的模式字符串。对于您描述的格式的字符串，请使用`XXX`. [请参阅文档](http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html#iso8601timezone)。

样本：

```
System.out.println(new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ssXXX")
        .format(new Date())); 
```

结果：

```
2014-03-31T14:11:29+02:00 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-11-14T12:28:31.857

查看[Joda Time](http://www.joda.org/joda-time/)包。它们使 RFC 3339 日期格式更容易。

**乔达示例：**

```
DateTime dt = new DateTime(2011,1,2,12,45,0,0, DateTimeZone.UTC);
DateTimeFormatter fmt = ISODateTimeFormat.dateTime();
String outRfc = fmt.print(dt); 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-07-16T19:29:47.913

从“完成部门”开始，一种解决方案是在 SimpleDateFormat 完成后使用正则表达式来修复字符串。Perl 中的类似 s/(\d{2})(\d{2})$/$1:$2/ 的东西。

如果您甚至对此感兴趣，我将使用有效的 Java 代码编辑此响应。

但是，是的。我也遇到了这个问题。RFC3339，我在看着你！

编辑：

这对我有用

```
// As a private class member
private SimpleDateFormat rfc3339 = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ssZ");

String toRFC3339(Date d)
{
   return rfc3339.format(d).replaceAll("(\\d\\d)(\\d\\d)$", "$1:$2");
} 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2015-05-20T09:52:13.920

我花了很多时间寻找同一问题的答案，我在这里找到了一些东西：http: [//developer.android.com/reference/java/text/SimpleDateFormat.html](http://developer.android.com/reference/java/text/SimpleDateFormat.html)

建议答案：

`String timestamp = new SimpleDateFormat("yyyy-MM-dd'T'h:m:ssZZZZZ").format(new Date());`

如果您注意到我使用的是 5 'Z' 而不是 1。这会在偏移量中给出带有冒号的输出，如下所示：“2008-11-13T12:23:30-08:00”。希望能帮助到你。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-02T17:07:14.093

问题是 Z 产生的时区偏移量没有冒号 (:) 作为分隔符。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-14T05:39:25.553

```
SimpleDateFormat format = new SimpleDateFormat("yyyy-MM-dd'T'h:m:ss.SZ"); 
```

不正是你需要的吗？

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-03-30T06:00:21.447

为此，我们可以简单地使用[ZonedDateTime 类](https://docs.oracle.com/javase/8/docs/api/java/time/ZonedDateTime.html "转到 Java 文档")和[DateTimeFormatter 类](https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html "转到 Java 文档")。

```
DateTimeFormatter format = DateTimeFormatter.ofPattern("yyyy-MM-dd'T'HH:mm:ssxxx");
ZonedDateTime z2 = ZonedDateTime.now(ZoneOffset.UTC).truncatedTo(ChronoUnit.SECONDS);
System.out.println("format =======> " + z2.format(format)); 
```

输出：格式 =======> 30-03-2020T05:57:37+00:00

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-08-15T02:10:59.603

我发现了一个帮助我解决问题的流浪 PasteBin：http: [//pastebin.com/y3TCAikc](http://pastebin.com/y3TCAikc)

以防其内容稍后被删除：

```
// I want 2008-11-13T12:23:30-08:00
String timestamp = new SimpleDateFormat("yyyy-MM-dd'T'h:m:ssZ").format(new Date());
System.out.println(timestamp); 
// prints "2008-11-13T12:23:30-0800" See the difference?

// Throws a ParseException
new SimpleDateFormat("yyyy-MM-dd'T'h:m:ssZ").parse("2008-11-13T13:23:30-08:00")

SimpleDateFormat format = new SimpleDateFormat("yyyy-MM-dd'T'h:m:ss.SZ"); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-05-17T00:57:55.370

我为 RFC3339 创建了一个[InternetDateFormat](http://mericleclerin.blogspot.jp/2013/07/internetdateformat-for-rfc3339.html)类。

但是源代码注释是日文的。

PS：我创建了英文版并进行了一些重构。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-06-10T15:11:50.233

我尝试了这种格式并为我工作`yyyy-MM-dd'T'HH:mm:ss'Z'`

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-07-18T10:40:50.920

# *java.time*

`java.util`日期时间 API 及其格式化 API已`SimpleDateFormat`过时且容易出错。建议完全停止使用它们并切换到[现代 Date-Time API](https://www.oracle.com/technical-resources/articles/java/jf14-Date-Time.html) ^*。

另外，下面引用的是来自[**Joda-Time**](https://www.joda.org/joda-time/)[主页](https://www.joda.org/joda-time/)**的通知：**

 **> 请注意，从 Java SE 8 开始，用户被要求迁移到 java.time (JSR-310) - JDK 的核心部分，它取代了这个项目。

**使用`java.time`现代日期时间 API 的解决方案：**[太平洋时区](https://en.wikipedia.org/wiki/Pacific_Time_Zone)最大的城市是洛杉矶，其时区名称为*America/Los_Angeles*。使用`ZoneId.of("America/Los_Angeles")`，您可以创建一个实例， `ZonedDateTime`该实例旨在在[DST](https://en.wikipedia.org/wiki/Daylight_saving_time)转换时自动调整时区偏移。

如果您需要时区偏移量但不需要时区名称，您可以将 a 转换`ZonedDateTime`为`OffsetDateTime`using [`ZonedDateTime#toOffsetDateTime`](https://docs.oracle.com/javase/8/docs/api/java/time/ZonedDateTime.html#toOffsetDateTime--)。的其他一些用途`OffsetDateTime`是创建具有固定时区偏移量的日期时间实例（例如`Instant.now().atOffset(ZoneOffset.of("+05:30"))`，以及解析具有时区偏移量的日期时间字符串。

**演示：**

```
import java.time.LocalDate;
import java.time.LocalDateTime;
import java.time.LocalTime;
import java.time.OffsetDateTime;
import java.time.ZoneId;
import java.time.ZonedDateTime;
import java.time.temporal.ChronoUnit;

public class Main {
    public static void main(String[] args) {
        ZoneId zoneIdLosAngeles = ZoneId.of("America/Los_Angeles");
        ZonedDateTime zdtNowLosAngeles = ZonedDateTime.now(zoneIdLosAngeles);
        System.out.println(zdtNowLosAngeles);

        // With zone offset but without time zone name
        OffsetDateTime odtNowLosAngeles = zdtNowLosAngeles.toOffsetDateTime();
        System.out.println(odtNowLosAngeles);

        // Truncated up to seconds
        odtNowLosAngeles = odtNowLosAngeles.truncatedTo(ChronoUnit.SECONDS);
        System.out.println(odtNowLosAngeles);

        // ################ A winter date-time ################
        ZonedDateTime zdtLosAngelesWinter = ZonedDateTime
                .of(LocalDateTime.of(LocalDate.of(2021, 11, 20), LocalTime.of(10, 20)), zoneIdLosAngeles);
        System.out.println(zdtLosAngelesWinter); // 2021-11-20T10:20-08:00[America/Los_Angeles]
        System.out.println(zdtLosAngelesWinter.toOffsetDateTime()); // 2021-11-20T10:20-08:00

        // ################ Parsing a date-time string with zone offset ################
        String strDateTime = "2008-11-13T13:23:30-08:00";
        OffsetDateTime odt = OffsetDateTime.parse(strDateTime);
        System.out.println(odt); // 2008-11-13T13:23:30-08:00
    }
} 
```

**示例运行的输出：**

```
2021-07-18T03:27:15.578028-07:00[America/Los_Angeles]
2021-07-18T03:27:15.578028-07:00
2021-07-18T03:27:15-07:00
2021-11-20T10:20-08:00[America/Los_Angeles]
2021-11-20T10:20-08:00
2008-11-13T13:23:30-08:00 
```

[`ONLINE DEMO`](https://ideone.com/LOGLlN)

您一定已经注意到我没有使用 a`DateTimeFormatter`来解析您问题的日期时间字符串。这是因为您的日期时间字符串符合 ISO-8601 标准。现代日期时间 API 基于[ISO 8601](https://en.wikipedia.org/wiki/ISO_8601)`DateTimeFormatter` ，只要日期时间字符串符合 ISO 8601 标准，就不需要明确使用对象。

**[从Trail: Date Time](https://docs.oracle.com/javase/tutorial/datetime/index.html)**了解有关现代日期时间 API 的更多信息。

* * *

^(* 出于任何原因，如果您必须坚持使用 Java 6 或 Java 7，则可以使用[***ThreeTen-Backport，***](http://www.threeten.org/threetenbp/)它将大部分*java.time*功能向后移植到 Java 6 和 7。如果您正在为 Android 项目和 Android API 工作level 仍然不符合 Java-8，请检查[Java 8+ APIs available through desugaring](https://developer.android.com/studio/write/java8-support-table)和[How to use ThreeTenABP in Android Project](https://stackoverflow.com/questions/38922754/how-to-use-threetenabp-in-android-project)。)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-07-13T13:46:56.120

我用这个测试了很多，对我来说效果很好......特别是在解析（以及格式化）方面，它是迄今为止我发现的最接近的

```
DateTimeFormatter rfc3339Formatter = DateTimeFormatter.ISO_OFFSET_DATE_TIME;

DateTimeFormatter rfc3339Parser = new DateTimeFormatterBuilder()
    .parseCaseInsensitive()
    .appendValue(ChronoField.YEAR, 4)
    .appendLiteral('-')
    .appendValue(ChronoField.MONTH_OF_YEAR, 2)
    .appendLiteral('-')
    .appendValue(ChronoField.DAY_OF_MONTH, 2)
    .appendLiteral('T')
    .appendValue(ChronoField.HOUR_OF_DAY, 2)
    .appendLiteral(':')
    .appendValue(ChronoField.MINUTE_OF_HOUR, 2)
    .appendLiteral(':')
    .appendValue(ChronoField.SECOND_OF_MINUTE, 2)
    .optionalStart()
    .appendFraction(ChronoField.NANO_OF_SECOND, 2, 9, true) //2nd parameter: 2 for JRE (8, 11 LTS), 1 for JRE (17 LTS)
    .optionalEnd()
    .appendOffset("+HH:MM","Z")
    .toFormatter()
    .withResolverStyle(ResolverStyle.STRICT)
    .withChronology(IsoChronology.INSTANCE); 
```

[https://github.com/guyplusplus/RFC3339-DateTimeFormatter](https://github.com/guyplusplus/RFC3339-DateTimeFormatter)上的测试用例

# visual-studio-2005 - 在 Vista 上安装 Visual Studio 2005 时出错

> ID：289314
> 
> 赞同：2
> 
> 时间：2008-11-14T05:30:02.340
> 
> 标签：visual-studio-2005, windows-vista, installation, 64-bit

尝试在我的 64 位 Vista 计算机上安装 Visual Studio 2005 时出现以下错误：

> “1305.从文件 C:\Program Files (x86)\Microsoft Visual Studio 8\Microsoft Visual Studio 2005 Standard Edition - ENU\SITSetup.dll 读取时出错”

我已经成功地使用相同的 DVD 在我的旧 XP 机器上安装 Visual Studio，并且我可以在 DVD 上找到文件 (SITSetup.dll)...并将其复制下来...所以我认为这不是DVD 损坏的情况。在弹出错误消息时，我可以在硬盘驱动器上看到该文件，但它的大小为 0。

我已经用谷歌搜索了这个问题，并找到了一些想法，但到目前为止没有任何效果。任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-18T20:14:30.173

我不得不承认这一点..特别是因为有人投票支持这个问题。

我在原始帖子中所说的关于过去成功使用磁盘的一切都是真的。然而，在无数次尝试让这个安装工作​​之后，我终于回去查看 DVD，发现我自己或我的一个孩子在 DVD 的底部留下了食物痕迹。清除 DVD 后，安装工作正常。这很尴尬。

我认为 DVD 很好，因为我以前用过它，并且能够从中复制文件。然而，我最后一次使用它是几年前的事了，在那时和现在之间的某个时间......有些东西发生了。我想这里的教训是永远不要跳过基本检查！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T05:39:27.487

我昨天刚刚在我的 Vista 机器上安装了它（32 位，这可能是问题所在）。它似乎很顺利，所以除了当我第一次启动应用程序时，它通知我“已知的兼容性问题”并建议我安装 SP1 和 Vista SP 之外，我不知道该告诉你什么！更新。过去没有其他问题。

因此，我怀疑 64 位操作系统存在问题（尽管[微软说它很好......](http://www.microsoft.com/windows/compatibility/Details.aspx?type=Software&p=Microsoft%20Visual%20Studio%202005%20Standard&v=Microsoft&uid=8&pf=0&pi=5&c=Development%20Tools&sc=all&os=64-bit)）或您机器上的其他软件。例如，如果您正在运行病毒扫描程序，请在安装时将其禁用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T05:41:12.130

如果您的 Vista 机器是在 VMware 下运行的客户机，请尝试将整个 DVD 复制到您的硬盘驱动器并从那里安装。

我不知道在真机上是否会出现同样的随机故障。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T05:27:39.867

我可以确认这是我在 Windows 2008 Server 上的问题，而不是在 XP 或 Vista（全 32 位）上。不知道为什么这里有任何问题，但似乎与权限有关。

还尝试以管理员身份运行等，但没有运气。

# css - IE中以下元素使用的空元素的背景

> ID：289315
> 
> 赞同：0
> 
> 时间：2008-11-14T05:30:28.940
> 
> 标签：css, internet-explorer-6, internet-explorer-7

在 IE6 中，空段落后面的段落以空段落的背景颜色显示，我猜这是错误的！它在 Firefox 中可以正常工作，但我没有检查过 IE7。

是否有针对此问题的 CSS 解决方案，或者我是否必须删除空元素？

（我宁愿不必删除空元素，因为这涉及编写代码以在输出之前检查每个元素是否为空）

使用严格或过渡文档类型的行为没有改变（添加此评论以响应答案）

有趣的是，文本颜色不会出现这种效果，只有背景颜色。

```
<html>
<head>
</head>
<body>

  <p style='background-color:green'>Green content</p>
  <p style='background-color:red'>Red content</p>
  <p>Unstyled background working because previous red element is not empty</p>

  <p style='background-color:green'>Green content</p>
  <p style='background-color:red'></p>
  <p>Unstyled background broken because previous red element is empty</p>

  <p style='color:green'>Green content</p>
  <p style='color:red'>Red content</p>
  <p>Unstyled text color working because previous red element is not empty</p>

  <p style='color:green'>Green content</p>
  <p style='color:red'></p>
  <p>Unstyled text color working even though previous red element is empty</p>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T05:53:00.923

我刚刚在 IE7 中进行了测试，并且可以确认它也在那里发生。

**看起来没有**样式的段落实际上没有红色背景，只是IE7为空段落绘制了红色框，然后在顶部绘制了以下段落。

您可以通过尝试以下代码自己查看：

```
<p style='background-color:green'>Green content</p>
<p style='background-color:red; margin-left:50px'></p>
<p>Unstyled background broken because previous red element is empty</p> 
```

您应该看到红色段落距左侧 50 像素。

*为什么*会这样是任何人的猜测。添加一些代码来检查段落是否为空并不难，而且它会从输出中删除无用的标记并完全避免这个问题。试一试？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T05:53:13.263

尝试在你的空段落中放置一个不间断的空格......

```
<p style='color:red'>& nbsp;</p> 
```

除了 & 号后面没有空格...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T00:33:35.793

在 HTML 文件的顶部添加一个 doctype。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd"> 
```

这将迫使 IE6 将表单怪癖切换到标准模式。这带来了很多其他优势，比如正确的盒子模型，所以无论如何你都应该这样做。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-16T00:34:32.967

一个空的段落是没有意义的——这意味着你可能写错了 HTML。

此外，您的示例没有 DOCTYPE - 有效的 DOCTYPE 对于让浏览器正确解释您的代码至关重要，如果没有，您将陷入怪癖模式。

但无论如何，这个错误最简单的解决方法就是为你当前的无样式元素设置一个背景。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-17T01:06:50.937

我发现的一个奇怪的解决方法是添加 position:relative 到可能为空的段落，如下所示：

```
<p style='background-color:red;position:relative'></p>
<p>Unstyled background fine because previous element is 'relative'</p> 
```

# authentication - IIS7 和身份验证问题

> ID：289317
> 
> 赞同：5
> 
> 时间：2008-11-14T05:35:21.410
> 
> 标签：authentication, iis-7, windows-authentication, basic-authentication, http-authentication

我有一个标准的 ASP.NET 网站，部署到我们的开发机器（我们服务器机房的内部机器）。

现在，内部和外部用户都可以访问这个开发站点。现在，在 IIS6 中，我们曾经拥有它，因此关闭了*匿名身份验证*并打开*了*其他东西.. 为用户提供了一个用于用户名和密码的弹出模型框。我*认为*他们必须输入一些在 web.config 文件中定义的用户名或密码？（不是他们的网站帐户用户名/密码）/

现在，使用 IIS7，当我关闭*Anon Auth*并打开*Basic*或*Windows Auth*时，我可以访问该站点但它试图使用这些凭据登录我..而不是用户注册的帐户（使用一些库存标准 asp.net 网络表单页面）。

那么......是否可以“锁定”整个网站并让测试人员获得对该网站的一般访问权限......这与他们的网站用户名和密码不同。这些用户名和密码是在网站中使用的。

那有意义吗？

干杯！

* * *

```
<authentication mode="Forms">
    <forms loginUrl="~/Pages/Login.aspx" protection="Validation" timeout="1000000000" requireSSL="false" slidingExpiration="true" defaultUrl="Default.aspx">
    </forms>
</authentication> 
```

没有授权部分。

另外，当我将“摘要身份验证”添加到 iis7 并启用它（并禁用其他所有内容）时，我得到弹出窗口（kewl！）但我不确定我需要传递什么凭据。我在哪里可以定义那些手动凭据（因此它们与网站的用户分开）？？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-13T02:32:59.107

IIS7 集成模式不支持 IIS6 所做的两阶段身份验证。基本上，IIS6 将执行其身份验证（Windows），然后由 asp.net 执行其身份验证（表单）。但是对于 IIS7，在集成模式下一切都是平等的，因此您只能使用一种或另一种身份验证方法。

您可以将应用程序池转换为使用经典模式，也可以按照[此解决方法](http://mvolo.com/blogs/serverside/archive/2008/02/11/IIS-7.0-Two_2D00_Level-Authentication-with-Forms-Authentication-and-Windows-Authentication.aspx)使其在集成模式下工作。

# ruby-on-rails - Ruby 是否存在 C1 代码覆盖率分析？

> ID：289321
> 
> 赞同：9
> 
> 时间：2008-11-14T05:37:57.490
> 
> 标签：ruby-on-rails, ruby, unit-testing, tdd, code-coverage

我目前正在使用[Rcov](http://eigenclass.org/hiki.rb?rcov)为我正在处理的 Rails 项目获取 C0 代码覆盖率分析。

然而，这些结果实际上毫无意义——根据 rcov，我有 100% 的覆盖率（因为它只涵盖了 C0 分析），而且我几乎没有为迄今为止存在的功能编写一半的测试用例。

我已经习惯了 Visual Studio 2008 Team 中代码覆盖率的有用结果，它具有 C1 覆盖率。是否有任何工具可以为 ruby​​ 提供类似的覆盖范围？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-14T07:09:58.880

目前，没有针对 Ruby 的 C1 覆盖工具。事实上，除了 RCov ，没有*任何覆盖工具。*

直到最近，只有通过在 C 中修补或扩展 MRI 解释器才能编写这样的工具。大约两年前，还可以在 Java 中扩展 JRuby，实际上从上个月开始就有一个 RCov 端口用于杰鲁比。然而，这需要 Ruby*和*C 的知识，以及相当深入的知识，因为摆弄 MRI 的内部结构不适合胆小的人。

但只有使用 Rubinius，才有可能在 Ruby 本身中编写动态分析工具，例如代码覆盖工具，从而使更多 Ruby 社区的人可以使用工具编写。我希望这一点，再加上工具供应商的大量资金支持（许多主要的 IDE 供应商正在开发或已经推出 Ruby IDE，包括 CodeGear（前 Borland）、IntelliJ、NetBeans、Eclipse、SapphireSteel（Ruby in Steel Visual Studio）甚至微软）将在 2009 年导致 Ruby 工具领域的快速创新，我们将看到诸如 C1、C2 覆盖、NPath 复杂性、更细粒度的分析等等之类的东西。

在那之前，我唯一的想法就是使用 Java 工具。JRuby 人试图发出适当的魔法元数据，以使他们生成的字节码至少可以被 Java 工具穿透。因此，也许可以将 Java 覆盖工具与 JRuby 一起使用。但是，我不知道这是否真的有效，也不知道它是否应该有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-11-07T18:50:26.740

[DeepCover](https://github.com/deep-cover/deep-cover)是当今唯一完整的 C1 Ruby Coverage 工具。

*披露*：我是`DeepCover`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T00:17:51.830

我不知道代码覆盖工具，但是 ruby​​ 有一个叫做 heckle 的变异测试器。

突变测试涉及更改正在测试的代码并查看这些突变是否导致单元测试失败。

不幸的是，最新的官方 gem（版本 1.4.1）有一些错误，所以您可能希望使用开发分支中的代码构建一个 gem。它只能改变实例方法。我也不确定开发分支版本有多可靠。

如果正在测试的代码可能会破坏系统（例如删除文件），则应避免突变测试。您可能想阅读[有关](http://glu.ttono.us/articles/2006/12/19/tormenting-your-tests-with-heckle)heckle 的常见问题解答和[提及 rcov 与 heckle 的常见问题解答问题](http://eigenclass.org/hiki/rcov+FAQ#l9)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-17T17:52:54.157

作为记录，NetBeans 7.0 内置了针对 Ruby 的代码覆盖率分析。我找不到任何解释它是 C0 还是 C1 的文档，但值得关注。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-25T09:34:45.953

旧帖子，但我在寻找 Ruby 覆盖工具时遇到了它。仅供参考，我遇到了一个名为[single_cov](https://github.com/grosser/single_cov)的 Ruby 的 C1 覆盖工具。不知道它有多好，但这些天我会给它一个试运行。

# c++ - 让 VC 调试器在堆栈溢出中显示更多帧

> ID：289324
> 
> 赞同：2
> 
> 时间：2008-11-14T05:39:38.483
> 
> 标签：c++, c, visual-studio

我正在远程调试递归函数的堆栈溢出。Visual Studio IDE 只显示了前 1,000 帧（所有功能都相同），但我需要进一步了解原因是什么。

有人知道如何让 VS 在堆栈列表中“向上移动”吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T07:01:34.637

我不相信有办法通过 UI（甚至是注册表黑客）来做到这一点。我的猜测是在堆栈溢出情况下显示所有帧会对性能产生非常负面的影响。

大多数堆栈帧是错误递归的结果。如果是这种情况，您可能会在目标函数上设置条件断点。将其设置为仅在命中数达到一定水平时才中断。我会从大约 1,000 开始计数。您可能需要进行一些试验才能获得正确的计数，但不应超过几次尝试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-15T06:33:13.103

我不时遇到这个问题，我所做的就是将以下行添加到递归调用的函数中：

```
static int nest; if (++nest == 100) *(char*)0 = 0; 
```

数字 100 是任意的，通常只有 10 个可以工作。这限制了递归，以段错误结束。然后调试器应该向您显示开始递归的帧。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T11:03:16.427

你也可以试试[WinDbg](http://www.microsoft.com/whdc/devtools/debugging/installx86.mspx)。它不是那么友好，但它有时可以在 VC 调试器不支持的地方工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-14T09:31:07.470

我建议更换您的调试方法并使用日志记录来处理此类问题。您可能会发现它更有效率，您只需要仔细选择打印的内容和时间。
任何分析几千行文本的方法都比上几千行堆栈帧要快得多。恕我直言。
并且您可以使用[David 的](https://stackoverflow.com/questions/289324/get-vc-debugger-to-show-more-frames-in-a-stack-overflow#289474)建议来控制要打印的数据量（即将相关信息从一个递归周期传递到另一个）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-16T19:37:05.500

您正试图以错误的方式解决此问题。

应该有足够的堆栈帧来显示重复调用模式。您应该已经获得了足够的推理数据来弄清楚无限循环的调用是如何发生的。

另一个 hack 想法可能是大幅减少堆栈大小或人为增加每个帧的大小......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-14T08:12:01.313

您可以向函数添加一个临时递归计数参数，并在它超过最大值时断言。给它一个默认值，您不需要编辑任何其他来源

```
void f(int rcount /* = 0 */ )
{
 Assert(rcount < 1000);
 f(count+1);
} 
```

# c - C中结构中“取消引用`void *'指针”警告的解决方案？

> ID：289329
> 
> 赞同：2
> 
> 时间：2008-11-14T05:45:57.007
> 
> 标签：c, struct, void-pointers

我试图创建一个伪超结构来打印结构数组。我的基本结构如下。

```
/* Type 10 Count */
typedef struct _T10CNT
{
    int _cnt[20];
} T10CNT;

...

/* Type 20 Count */
typedef struct _T20CNT
{
    long _cnt[20];
} T20CNT;
... 
```

我创建了以下结构来打印上述结构的数组。在编译下面的代码片段时，我遇到了取消引用 void 指针错误。

```
typedef struct _CMNCNT
{
    long  _cnt[3];
} CMNCNT;

static int printCommonStatistics(void *cmncntin, int cmncnt_nelem, int cmncnt_elmsize)
{
    int ii;
    for(ii=0; ii<cmncnt_nelem; ii++)
    {
        CMNCNT *cmncnt = (CMNCNT *)&cmncntin[ii*cmncnt_elmsize];
        fprintf(stout,"STATISTICS_INP: %d\n",cmncnt->_cnt[0]);
        fprintf(stout,"STATISTICS_OUT: %d\n",cmncnt->_cnt[1]); 
        fprintf(stout,"STATISTICS_ERR: %d\n",cmncnt->_cnt[2]);
    }
    return SUCCESS;
}

T10CNT struct_array[10];
...
printCommonStatistics(struct_array, NELEM(struct_array), sizeof(struct_array[0]);
... 
```

我的意图是有一个通用的功能来打印所有的数组。请告诉我正确的使用方法。

提前感谢帮助。

编辑：参数名称从 cmncnt 改为 cmncnt。抱歉，这是拼写错误。

谢谢， 马修 Liju

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-15T16:01:04.813

我认为您的设计将会失败，但我也不相信我看到的其他答案完全可以解决更深层的原因。

您似乎正在尝试使用 C 来处理泛型类型，这总是很麻烦。如果你小心点，你可以做到，但这并不容易，在这种情况下，我怀疑这是否值得。

**更深层次的原因**：假设我们已经解决了单纯的句法（或仅是句法）问题。您的代码显示 T10CNT 包含 20`int`和 T20CNT 包含 20 `long`。在现代 64 位机器上 - 除了在 Win64 下 - `sizeof(long) != sizeof(int)`. 因此，打印函数中的代码应该区分解引用`int`数组和`long`数组。在 C++ 中，有一条规则是您不应该尝试多态地处理数组，这就是原因。CMNCNT 类型包含 3 个`long`值；尽管数组的基本类型与 T20CNT 匹配，但在数量上与 T10CNT 和 T20CNT 结构不同。

*风格推荐*：我强烈建议避免名称前导下划线。通常，以下划线开头的名称保留给实现使用，并用作宏。宏不尊重范围；如果实现定义了一个宏 _cnt 它会破坏你的代码。保留哪些名称存在细微差别。我不打算讨论这些细微差别。认为“保留以下划线开头的名称”要简单得多，它会让你摆脱麻烦。

*风格建议*：您的打印功能无条件返回成功。这是不明智的；您的函数不应返回任何内容，以便调用者不必测试成功或失败（因为它永远不会失败）。仔细观察函数返回状态的编码人员将始终测试返回状态，并具有错误处理代码。该代码永远不会被执行，所以它已经死了，但是任何人（或编译器）都很难确定这一点。

*Surface Fix*：暂时，我们可以假设您可以将`int`and`long`视为同义词；但是，您必须改掉认为它们是同义词的习惯。该`void *`参数是说“此函数采用不确定类型的指针”的正确方式。但是，在函数内部，您需要`void *`在进行索引之前从 a 转换为特定类型。

```
typedef struct _CMNCNT
{
    long    count[3];
} CMNCNT;

static void printCommonStatistics(const void *data, size_t nelem, size_t elemsize)
{
    int i;
    for (i = 0; i < nelem; i++)
    {
        const CMNCNT *cmncnt = (const CMNCNT *)((const char *)data + (i * elemsize));
        fprintf(stdout,"STATISTICS_INP: %ld\n", cmncnt->count[0]);
        fprintf(stdout,"STATISTICS_OUT: %ld\n", cmncnt->count[1]); 
        fprintf(stdout,"STATISTICS_ERR: %ld\n", cmncnt->count[2]);
    }
} 
```

（我也喜欢调用文件流的想法`stout`。 *建议*：在真实源代码上使用 cut'n'paste - 它更安全！我通常使用“ `sed 's/^/ /' file.c`”来准备代码，以便将 cut'n'paste 转换为 SO 答案.)

那条铸造线是做什么的？我很高兴你问...

*   第一个操作是将 转换`const void *`为`const char *`; 这允许您对地址执行字节大小的操作。在标准 C 之前的日子里，`char *`它被用作`void *`通用寻址机制。
*   下一个操作添加正确的字节数以到达`i`size 对象数组的第 th 个元素的开头`elemsize`。
*   然后第二个演员告诉编译器“相信我 - 我知道我在做什么”和“将此地址视为 CMNCNT 结构的地址”。

从那里开始，代码就足够简单了。请注意，由于 CMNCNT 结构中包含`long`值，因此我曾经`%ld`对`fprintf()`.

由于您不打算修改此函数中的数据，因此`const`像我一样使用限定符并不是一个坏主意。

请注意，如果您要忠实于`sizeof(long) != sizeof(int)`，那么您需要两个单独的代码块（我建议使用单独的函数）来处理 'array of `int`' 和 'array of `long`' 结构类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T13:36:43.777

void 的类型故意不完整。由此可知，您不能取消引用 void 指针，也不能获取它的 sizeof。这意味着您不能像使用数组一样使用下标运算符。

将某些内容分配给 void 指针的那一刻，原始指向类型的任何类型信息都会丢失，因此只有先将其转换回原始指针类型，才能取消引用。

首先也是最重要的，您传递`T10CNT*`给函数，但您尝试在函数中对其进行类型转换（和取消引用）`CMNCNT*`。这是无效且未定义的行为。

对于每种类型的数组元素，您都需要一个函数 printCommonStatistics。所以，有一个 `printCommonStatisticsInt`, `printCommonStatisticsLong`，`printCommonStatisticsChar`它们的第一个参数不同（一个接受`int*`，另一个接受`long*`，等等）。您可以使用宏创建它们，以避免冗余代码。

传递结构本身并不是一个好主意，因为那时您必须为结构中包含的数组的每个不同大小定义一个新函数（因为它们都是不同的类型）。所以最好直接传递包含的数组（`struct_array[0]._cnt`，为每个索引调用函数）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T05:54:52.603

将函数声明更改为 char *，如下所示：

```
static int printCommonStatistics(char *cmncnt, int cmncnt_nelem, int cmncnt_elmsize) 
```

void 类型不假定任何特定大小，而 char 将假定一个字节大小。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-14T05:58:00.023

你不能这样做：

```
cmncnt->_cnt[0] 
```

如果 cmnct 是一个空指针。

您必须指定类型。您可能需要重新考虑您的实施。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-15T15:48:08.957

功能

```
static int printCommonStatistics(void *cmncntin, int cmncnt_nelem, int cmncnt_elmsize)
{
    char *cmncntinBytes;
    int ii;

    cmncntinBytes = (char *) cmncntin;
    for(ii=0; ii<cmncnt_nelem; ii++)
    {
        CMNCNT *cmncnt = (CMNCNT *)(cmncntinBytes + ii*cmncnt_elmsize);  /* Ptr Line */
        fprintf(stdout,"STATISTICS_INP: %d\n",cmncnt->_cnt[0]);
        fprintf(stdout,"STATISTICS_OUT: %d\n",cmncnt->_cnt[1]); 
        fprintf(stdout,"STATISTICS_ERR: %d\n",cmncnt->_cnt[2]);
    }
    return SUCCESS;
} 
```

为我工作。

问题是在注释为“Ptr Line”的行上，代码添加了一个指向整数的指针。由于我们的指针是一个 char * 我们在内存中向前移动 sizeof(char) * ii * cmncnt_elemsize，这是我们想要的，因为 char 是一个字节。你的代码试图做一个等价的事情，向前推进 sizeof(void) * ii * cmncnt_elemsize，但 void 没有大小，所以编译器给了你错误。

我会将 T10CNT 和 T20CNT 更改为都使用 int 或 long 而不是每个都使用一个。你取决于 sizeof(int) == sizeof(long)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-14T05:52:55.120

在这条线上：

```
CMNCNT *cmncnt = (CMNCNT *)&cmncnt[ii*cmncnt_elmsize]; 
```

您正在尝试声明一个名为 cmncnt 的新变量，但具有此名称的变量已作为函数的参数存在。您可能想使用不同的变量名来解决这个问题。

此外，您可能希望将指向 CMNCNT 的指针而不是 void 指针传递给函数，因为编译器将为您执行指针运算，而您不必强制转换它。当您对它所做的所有事情都将其转换为 CMNCNT 时，我看不到传递 void 指针的意义。（顺便说一下，这对于数据类型来说不是一个非常具有描述性的名称。）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-14T08:32:34.657

你的表情

```
(CMNCNT *)&cmncntin[ii*cmncnt_elmsize] 
```

尝试获取 cmncntin[ii*cmncnt_elmsize] 的地址，然后将该指针转换为类型 (CMNCNT *)。它无法获取 cmncntin[ii*cmncnt_elmsize] 的地址，因为 cmncntin 的类型为 void*。

研究 C 的运算符优先级并在必要时插入括号。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-15T18:17:39.187

信息点：内部填充确实会搞砸。

考虑 struct { char c[6]; }; -- 它的 sizeof()=6。但是如果你有一个数组，每个元素可能会被填充为 8 字节对齐！

某些组装操作不能优雅地处理未对齐的数据。（例如，如果一个 int 跨越两个内存字。）（是的，我以前被这个咬过。）

.

第二：在过去，我使用了可变大小的数组。（那时我很笨......）如果你不改变类型，它会起作用。（或者，如果您有类型的联合。）

例如：

```
struct T { int sizeOfArray;  int data[1]; }; 
```

分配为

```
T * t = (T *) malloc( sizeof(T) + sizeof(int)*(NUMBER-1) );
                      t->sizeOfArray = NUMBER; 
```

（尽管填充/对齐仍然会让你搞砸。）

.

第三：考虑：

```
 struct T {
     int sizeOfArray;
     enum FOO arrayType;
     union U { short s; int i; long l; float f; double d; } data [1];
    }; 
```

它解决了知道如何打印数据的问题。

.

第四：您可以将 int/long 数组传递给您的函数而不是结构。例如：

```
void printCommonStatistics( int * data, int count )
{
  for( int i=0;  i<count;  i++ )
    cout << "FOO: " << data[i] << endl;
} 
```

通过以下方式调用：

```
_T10CNT  foo;
printCommonStatistics( foo._cnt, 20 ); 
```

或者：

```
 int a[10], b[20], c[30];
printCommonStatistics( a, 10 );
printCommonStatistics( b, 20 );
printCommonStatistics( c, 30 ); 
```

这比在结构中隐藏数据要好得多。当您将成员添加到您的结构之一时，布局可能会在您的结构之间发生变化并且不再一致。（意味着 _cnt 相对于结构开头的地址可能会改变

例如：

```
struct FOO {
  union {
         int     bar  [10];
          long biff [20];
   } u;
} 
```

.

第五：如果你必须使用结构...... C++、iostreams 和模板会更容易实现。

例如：

```
template<class TYPE> void printCommonStatistics( TYPE & mystruct, int count )
{
  for( int i=0;  i<count;  i++ )
    cout << "FOO: " << mystruct._cnt[i] << endl;
}      /* Assumes all mystruct's have a "_cnt" member. */ 
```

但这可能不是你要找的......

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-11-14T05:52:21.360

C不是我的cup o'java，但我认为你的问题是“void *cmncnt”应该是CMNCNT *cmncnt。

现在请随时纠正我，C 程序员，告诉我这就是为什么 java 程序员不能有好的东西。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-11-14T14:49:19.763

这条线有点折磨，你不觉得吗？

```
CMNCNT *cmncnt = (CMNCNT *)&cmncntin[ii*cmncnt_elmsize]; 
```

更像的东西怎么样

```
CMNCNT *cmncnt = ((CMNCNT *)(cmncntin + (ii * cmncnt_elmsize)); 
```

或者更好的是，如果 cmncnt_elmsize = sizeof(CMNCNT)

```
CMNCNT *cmncnt = ((CMNCNT *)cmncntin) + ii; 
```

这也应该消除警告，因为您不再取消引用 void *.

顺便说一句：我不确定你为什么要这样做，但如果 cmncnt_elmsize 有时不是 sizeof(CMNCNT)，并且实际上可能因调用而异，我建议重新考虑这种设计。我想这可能有一个很好的理由，但对我来说它看起来真的很不稳定。我几乎可以保证有更好的设计方法。

# .net - XSDObjectGen.exe 与 XSD.exe

> ID：289335
> 
> 赞同：18
> 
> 时间：2008-11-14T05:52:55.150
> 
> 标签：.net, xsd, xsd2code, xsdobjectgen

谁能告诉我 XSDObjectGen.exe 和 XSD.exe 有什么区别？

有没有办法让 XSDObjectGen.exe 在 dot net 2.0 中工作？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2010-06-09T10:17:33.047

作为替代方案，还有[Xsd2Code](http://xsd2code.codeplex.com/)。一些特点：

*   生成部分类。
*   支持通用和自定义集合（List、ObservableCollection、MyCustomCollection）。
*   在不需要特殊获取或设置时支持自动属性。
*   可以生成 WCF 属性（DataContract/DataMember）。
*   支持可空类型。
*   屏蔽 IDE 中的私有字段（使用 EditorBrowsableState.Never 属性）。
*   在构造函数中生成对象分配。
*   实现 INotifyPropertyChanged 以启用 wpf 或 Silverlight 的 DataBinding。
*   使用 Visual Studio 插件提高工作效率。
*   从 xsd 注释生成摘要文档。
*   在引发属性更改事件之前检查新旧值 int setter 是否相同。
*   cs 或 vb 标头中的备份选项生成。
*   将 Xml 文档保存并加载到 silverlight 应用程序的隔离文件存储中（3.0 中的新功能）。
*   生成 CS、VB 或 CPP 代码。
*   序列化/反序列化对象。
*   保存到文件并从文件加载。
*   包括 Xsd2CodeCustomTool。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-06-09T10:13:29.810

区别在于：

*   [XML 架构定义工具](http://msdn.microsoft.com/en-us/library/x6c1kb0s(v=VS.100).aspx)( `xsd.exe`) 是 Visual Studio SDK 的一部分，具有基本功能。
*   [XSD 示例代码生成器工具](http://www.microsoft.com/downloads/details.aspx?familyid=89e6b1e5-f66c-4a4d-933b-46222bb01eb0&displaylang=en)( )`XSDObjectGen.exe`是一个功能更全面的工具，具有更多高级功能，并且单独发布。

为了给您一些想法，这里是一个摘要功能列表`XSDObjectGen.exe`：

*   支持最流行的 XML 模式结构
*   重复元素的枚举器和集合行为
*   匹配模式的编程模型
*   自动子类构造
*   名称冲突避免
*   Visual Studio IDE 集成
*   DateTime 类型的特殊处理逻辑
*   多部分模式支持
*   XML 命名空间序列化
*   可选和序列支持
*   选择支持
*   替代组
*   MakeSchemaCompliant 方法
*   非可选的引用类型处理
*   WS-I.org 基本配置文件合规性
*   多编程语言支持
*   深度遍历事件

有关这些功能的更多详细信息，请参阅*XSDObjectGen.doc*文档文件（`C:\Program Files\XSDObjectGenerator`安装该工具后可用）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-14T22:54:41.437

看起来您至少可以将它与 VS2005 一起使用（[无论如何，根据这篇文章](http://brianscodeextreme.blogspot.com/2006/01/code-camp-part-1-corrections.html)）

只需将它添加到“工具>>外部工具...”下的 VS2005 的外部工具集合中。

设置你的参数如下

*   对于 VB：$(ItemPath) /l:vb /f:$(ItemFileName).vb /c /d /t
*   对于 C#：$(ItemPath) /l:cs /f:$(ItemFileName).vb /c /d /t

XSD 和 XSDObjectGen 似乎会产生不同的类。事实上，这篇 Rick Strahl 文章中的评论在[此处的文章中说“](http://www.west-wind.com/WebLog/posts/10402.aspx)**它们产生*了非常*不同的类**” 。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-02-18T17:33:26.917

在纯技术层面：

XSD.exe 使用`Arrays`
XSDObjectGen 领先一步，使用`ArrayLists`.
XSD2Code***在***`Generics`. _

如果您使用的是 .NET 2.0 及更高版本，则最好使用 XSD2Code。

# eclipse - Eclipse 跳转到右括号

> ID：289342
> 
> 赞同：397
> 
> 时间：2008-11-14T06:04:37.343
> 
> 标签：eclipse, keyboard-shortcuts, curly-braces

Eclipse 中跳转到作用域右括号的键盘快捷键是什么？

* * *

## 回答 #1

> 赞同：517
> 
> 时间：2008-11-14T06:28:56.810

将光标放在左大括号*或右*大括号旁边并打孔`Ctrl`++以查找匹配的大括号。如果 Eclipse 找不到，您将收到*“未找到匹配的括号”*消息。`Shift``P`

 ****编辑：***正如[下面 Romaintaz 所述](https://stackoverflow.com/a/1637242/1030)，您还可以让 Eclipse 自动选择两个大括号之间的所有代码，只需双击左大括号的右侧即可。

* * *

## 回答 #2

> 赞同：131
> 
> 时间：2009-10-28T13:29:45.673

由于已经引用了快捷方式`Ctrl`++ ，我只是想添加一个非常有趣的功能：只需双击紧邻的，Eclipse 将选择打开`Shift`和相应关闭之间的整个代码块。同样，双击关闭“}”的左侧，eclipse 将选择该块。`P``{``{``}`

* * *

## 回答 #3

> 赞同：81
> 
> 时间：2008-11-14T08:58:39.673

用`Ctrl`++`Shift`你`L`可以打开“按键辅助”，在这里你可以找到所有的快捷键。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2008-12-18T16:52:11.483

在 Macintosh 上，将光标放在左大括号或右大括号之后`}`并使用键：`Shift`+ `Command`+ `P`。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2014-02-06T14:20:02.553

选择内容使用`Alt`+ `Shift`+`Up arrow`

要选择直到下一个包装块的内容，请再次按此快捷方式

要返回上一步，请按`Alt`+ `Shift`+ `Down arrow`。当您需要选择复杂表达式中的内容并且不想错过某些内容时，这也是一个有用的快捷方式。

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2012-08-10T10:49:51.673

按`Ctrl`+ `Shift`+ `P`。

在 Eclipse Juno 之前，您需要将光标放在左大括号或右大括号之外。

在 Juno 中，光标可以位于代码块中的任何位置。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2009-10-28T13:26:20.947

我发现如果选择的透视图与当前文件的类型不匹配，那么“去匹配大括号”就不起作用了。然而，改变观点使其再次发挥作用。因此，例如，当我打开一个 PHP 文件，但 Java 透视图处于活动状态时，按`Ctrl`++`Shift`什么`P`也不做。对于 PHP 透视图处于活动状态的同一个文件，按`Ctrl`++完全符合您的预期，并将光标放在相对于它开始位置的右大括号旁边`Shift`。`P`

# c++ - 将 strtok 与 std::string 一起使用

> ID：289347
> 
> 赞同：55
> 
> 时间：2008-11-14T06:14:46.540
> 
> 标签：c++, strtok

我有一个要标记的字符串。但是 C`strtok()`函数要求我的字符串是`char*`. 我怎么能简单地做到这一点？

我试过了：

```
token = strtok(str.c_str(), " "); 
```

失败是因为它将它变成 a `const char*`，而不是 a`char*`

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2008-11-14T06:29:38.493

```
#include <iostream>
#include <string>
#include <sstream>
int main(){
    std::string myText("some-text-to-tokenize");
    std::istringstream iss(myText);
    std::string token;
    while (std::getline(iss, token, '-'))
    {
        std::cout << token << std::endl;
    }
    return 0;
} 
```

或者，如前所述，使用 boost 以获得更大的灵活性。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-11-14T06:22:42.063

复制字符串，标记它，然后释放它。

```
char *dup = strdup(str.c_str());
token = strtok(dup, " ");
free(dup); 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-11-14T06:28:00.400

1.  如果你的系统上可以使用[boost](http://www.boost.org/)（我认为它是当今大多数 Linux 发行版的标准），它有一个你可以使用的[Tokenizer类。](http://www.boost.org/doc/libs/1_37_0/libs/tokenizer/tokenizer.htm)

2.  如果没有，那么快速的 Google 会为 std::string 提供[手动标记](http://oopweb.com/CPP/Documents/CPPHOWTO/Volume/C++Programming-HOWTO-7.html)器，您可能只需复制和粘贴即可。它很短。

3.  而且，如果您不喜欢其中任何一个，那么这是我编写的一个 split() 函数，以使我的生活更轻松。它将使用“delim”中的任何字符作为分隔符将字符串分成几部分。碎片被附加到“零件”向量中：

    ```
    void split(const string& str, const string& delim, vector<string>& parts) {
      size_t start, end = 0;
      while (end < str.size()) {
        start = end;
        while (start < str.size() && (delim.find(str[start]) != string::npos)) {
          start++;  // skip initial whitespace
        }
        end = start;
        while (end < str.size() && (delim.find(str[end]) == string::npos)) {
          end++; // skip to end of word
        }
        if (end-start != 0) {  // just ignore zero-length strings.
          parts.push_back(string(str, start, end-start));
        }
      }
    } 
    ```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-10-20T06:49:46.340

有一个更优雅的解决方案。

> 使用 std::string 您可以使用 resize() 分配一个适当大的缓冲区，并使用 &s[0] 获取指向内部缓冲区的指针。

此时，许多优秀的人会跳起来对着屏幕大喊大叫。但这就是事实。大约 2 年前

> 图书馆工作组决定（在 Lillehammer 开会）就像 std::vector 一样，std::string 也应该正式地，而不仅仅是在实践中，有一个保证的连续缓冲区。

另一个问题是 strtok() 是否会增加字符串的大小。MSDN 文档说：

> 对 strtok 的每次调用都会通过在该调用返回的标记后插入一个空字符来修改 strToken。

但这是不正确的。实际上，该函数将第*一次*出现的分隔符替换为 \0。字符串的大小没有变化。如果我们有这个字符串：

> 一二三四

我们最终会得到

> 一\0二\0--三\0-四

所以我的解决方案很简单：

```
 std::string str("some-text-to-split");
char seps[] = "-";
char *token;

token = strtok( &str[0], seps );
while( token != NULL )
{
   /* Do your thing */
   token = strtok( NULL, seps );
} 
```

阅读关于[http://www.archivum.info/comp.lang.c++/2008-05/02889/does_std::string_have_something_like_CString::GetBuffer](http://www.archivum.info/comp.lang.c++/2008-05/02889/does_std::string_have_something_like_CString::GetBuffer)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-08-08T09:48:17.540

使用 C++17`str::string`接收`data()`重载，该重载返回指向可修改缓冲区的指针，因此可以直接使用字符串`strtok`而无需任何黑客攻击：

```
#include <string>
#include <iostream>
#include <cstring>
#include <cstdlib>

int main()
{
    ::std::string text{"pop dop rop"};
    char const * const psz_delimiter{" "};
    char * psz_token{::std::strtok(text.data(), psz_delimiter)};
    while(nullptr != psz_token)
    {
        ::std::cout << psz_token << ::std::endl;
        psz_token = std::strtok(nullptr, psz_delimiter);
    }
    return EXIT_SUCCESS;
} 
```

输出

> 流行 音乐
> _

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-14T07:59:27.297

编辑：const cast 的使用**仅**用于演示`strtok()`应用于 string::c_str() 返回的指针时的效果。

您**不应该使用 `strtok()`**它，因为它会修改标记化的字符串，这可能会导致不希望的（如果不是未定义的）行为，因为 C 字符串“属于”字符串实例。

```
#include <string>
#include <iostream>

int main(int ac, char **av)
{
    std::string theString("hello world");
    std::cout << theString << " - " << theString.size() << std::endl;

    //--- this cast *only* to illustrate the effect of strtok() on std::string 
    char *token = strtok(const_cast<char  *>(theString.c_str()), " ");

    std::cout << theString << " - " << theString.size() << std::endl;

    return 0;
} 
```

在调用 之后`strtok()`，空格从字符串中“删除”，或者变成了不可打印的字符，但长度保持不变。

```
>./a.out
hello world - 11
helloworld - 11 
```

因此，您必须求助于本机机制、字符串复制或前面提到的第三方库。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-14T06:23:30.347

我想语言是C或C++ ...

strtok，IIRC，用 \0 替换分隔符。这就是它不能使用 const 字符串的原因。为了“快速”解决这个问题，如果字符串不是很大，你可以 strdup() 它。如果您需要保持字符串不变（const 建议的内容......），这是明智的。

另一方面，您可能想要使用另一个标记器，也许是手卷的，在给定的参数上不那么暴力。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-14T06:29:09.010

假设您所说的“字符串”是指 C++ 中的 std::string，您可能会查看[Boost中的](http://www.boost.org/)[Tokenizer](http://www.boost.org/doc/libs/1_36_0/libs/tokenizer/introduc.htm)包。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-11-17T10:52:13.437

使用 std::string 时，[Chris的答案可能很好；](https://stackoverflow.com/a/289372/4012208)但是，如果您想使用 std::basic_string<char16_t>，则不能使用 std::getline。这是一个可能的其他实现：

```
template <class CharT> bool tokenizestring(const std::basic_string<CharT> &input, CharT separator, typename std::basic_string<CharT>::size_type &pos, std::basic_string<CharT> &token) {
    if (pos >= input.length()) {
        // if input is empty, or ends with a separator, return an empty token when the end has been reached (and return an out-of-bound position so subsequent call won't do it again)
        if ((pos == 0) || ((pos > 0) && (pos == input.length()) && (input[pos-1] == separator))) {
            token.clear();
            pos=input.length()+1;
            return true;
        }
        return false;
    }
    typename std::basic_string<CharT>::size_type separatorPos=input.find(separator, pos);
    if (separatorPos == std::basic_string<CharT>::npos) {
        token=input.substr(pos, input.length()-pos);
        pos=input.length();
    } else {
        token=input.substr(pos, separatorPos-pos);
        pos=separatorPos+1;
    }
    return true;
} 
```

然后像这样使用它：

```
std::basic_string<char16_t> s;
std::basic_string<char16_t> token;
std::basic_string<char16_t>::size_type tokenPos=0;
while (tokenizestring(s, (char16_t)' ', tokenPos, token)) {
    ...
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-14T10:05:48.853

首先，我会说使用 boost tokenizer。
或者，如果您的数据是空格分隔的，那么字符串流库非常有用。

但是以上两个都已经涵盖了。
因此，作为第三种 C-Like 替代方案，我建议将 std::string 复制到缓冲区中进行修改。

```
std::string   data("The data I want to tokenize");

// Create a buffer of the correct length:
std::vector<char>  buffer(data.size()+1);

// copy the string into the buffer
strcpy(&buffer[0],data.c_str());

// Tokenize
strtok(&buffer[0]," "); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-06-11T13:30:52.613

如果你不介意开源，你可以使用[https://github.com/EdgeCast/json_parser](https://github.com/EdgeCast/json_parser)中的 subbuffer 和 subparser 类。原始字符串保持不变，没有分配也没有数据复制。我没有编译以下内容，所以可能会有错误。

```
std::string input_string("hello world");
subbuffer input(input_string);
subparser flds(input, ' ', subparser::SKIP_EMPTY);
while (!flds.empty())
{
    subbuffer fld = flds.next();
    // do something with fld
}

// or if you know it is only two fields
subbuffer fld1 = input.before(' ');
subbuffer fld2 = input.sub(fld1.length() + 1).ltrim(' '); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-11-25T15:05:04.967

类型转换为 (char*) 让它为我工作！

```
token = strtok((char *)str.c_str(), " "); 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2015-10-16T20:38:54.900

它失败是因为**`str.c_str()`**返回常量字符串但`char * strtok (char * str, const char * delimiters )`需要易失性字符串。因此，您需要使用***const_cast< char *>***才能使其具有可变性。我给你一个完整但很小的程序来使用 C strtok() 函数标记字符串。

```
 #include <iostream>
   #include <string>
   #include <string.h> 
   using namespace std;
   int main() {
       string s="20#6 5, 3";
       // strtok requires volatile string as it modifies the supplied string in order to tokenize it 
       char *str=const_cast< char *>(s.c_str());    
       char *tok;
       tok=strtok(str, "#, " );     
       int arr[4], i=0;    
       while(tok!=NULL){
           arr[i++]=stoi(tok);
           tok=strtok(NULL, "#, " );
       }     
       for(int i=0; i<4; i++) cout<<arr[i]<<endl;

       return 0;
   } 
```

* * *

**注意：** strtok 可能并不适合所有情况，因为***传递给函数的字符串会被分解为更小的字符串而被修改***。请[参考](http://www.cplusplus.com/reference/cstring/strtok/)以更好地理解 strtok 功能。

**strtok 的工作原理**

添加了一些打印语句，以更好地理解每次调用 strtok 时字符串发生的变化以及它如何返回令牌。

```
#include <iostream>
#include <string>
#include <string.h> 
using namespace std;
int main() {
    string s="20#6 5, 3";
    char *str=const_cast< char *>(s.c_str());    
    char *tok;
    cout<<"string: "<<s<<endl;
    tok=strtok(str, "#, " );     
    cout<<"String: "<<s<<"\tToken: "<<tok<<endl;   
    while(tok!=NULL){
        tok=strtok(NULL, "#, " );
        cout<<"String: "<<s<<"\t\tToken: "<<tok<<endl;
    }
    return 0;
} 
```

输出：

```
string: 20#6 5, 3

String: 206 5, 3    Token: 20
String: 2065, 3     Token: 6
String: 2065 3      Token: 5
String: 2065 3      Token: 3
String: 2065 3      Token: 
```

strtok 遍历字符串第一次调用找到非删除字符（在本例中为 2）并将其标记为标记*开始*，然后继续扫描分隔符并将其替换为空字符（# 被替换为实际字符串）并返回*指向*令牌开始字符（即，它返回以 null 终止的令牌 20）。在随后的调用中，它从下一个字符开始扫描，如果发现则返回令牌，否则返回 null。随后它返回令牌 6、5、3。

# project-management - 如何确定未来功能的优先级（企业 Web 开发）

> ID：289348
> 
> 赞同：2
> 
> 时间：2008-11-14T06:16:27.850
> 
> 标签：project-management, enterprise

假设您是拥有 2000 名用户和 7 名开发人员的内部企业 Web 应用程序的产品经理。您有一个包含 350 个未来功能的列表，每个功能都需要 5 到 150 个开发人员日的工作时间。

您如何选择要处理的功能，以及如何运行发布过程？

以下是我的想法：（如果无聊请跳过）

*   **发布过程。**一次处理多个功能，准备好后单独发布每个功能。另一种选择（到目前为止我们一直在做的事情）是挑选出一组特定的功能，将它们指定为“一个版本”，然后一次性发布它们（通过群发电子邮件宣布）。

    更短的发布过程的好处是我们可以在完成开发后立即发布功能。更大流程的优点是更容易组织。

*   **功能优先级。**将所有未来的功能放在一个电子表格中，其中包含功能、描述、评论、估计、收益、（您的）估计、（您的）收益的列。将副本提供给 2 名高级工程师、另一名高级项目经理和您自己。

    工程师估计所有功能（精确度如何？互相咨询？）。为了确定收益，每个人在未来特征之间分配分数（总分 = 10 * [未来特征数量]）（无需相互协商？），比较分数和平均值（？）。

    这里的另一个潜在策略是仅以绝对（例如）1-100 的比例对每个特征进行排名。拥有绝对排名很好，因为它使我们的功能列表更改时的优先级更容易（我们不希望每次有人提出新功能时都必须重新分配积分）。

你的策略是什么？是否有任何书籍/网站以这种详细程度来解决问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T06:23:09.207

有一本很棒的书可以帮助涵盖这个主题，称为Mike Cohn 的*敏捷估计和规划*。它有一些很好的方法来估计和计划发布。包括一个称为计划扑克的计划游戏，工程团队在其中收集卡片来估计用户故事。每个工程师打出一张牌 1,2,3,5,8,13 面朝下。高低牌解释，你再做一次。在 1 或 2 次重复之后，通常会在相同的估计上收敛。

还有《*超越软件架构：创建和维持成功的解决方案*》（Luke Hohmann），它可能有助于一些与产品管理相关的部分以及用于确定优先级的推理。我还没有读过这本书，但我参加了 Luke Hohmann 的演讲，他谈到了他书中的主题，我迫不及待地想读它。

我还建议阅读有关各种敏捷开发过程的书籍，例如 Scrum、Crystal Clear 和 XP。Ken Schwaber的*Scrum 敏捷项目管理和*Alistair Cockburn*的 Crystal Clear：小型团队的人力驱动方法论。*还*解释了极限编程：* Kent Beck 和 Cynthia Andres 的《拥抱变化》（第 2 版）。

至于功能优先级，通常由利益相关者完成。您需要处理满足利益相关者需求的功能，正如 Luke Hohmann 指出的那样，其中包括系统架构。

但是，最重要的事情之一是确保您在团队中就软件开发过程达成一致。如果你强迫一个过程而团队不相信，那么它就行不通。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T06:51:48.247

当然，您没有 350 个*独立*的功能，有些必须依赖于其他功能。将它们全部放入一些任务管理软件中，该软件允许您定义哪些任务取决于哪些其他任务，您可能很快就会发现您的决策过程要容易得多......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T06:57:24.990

至于发布过程，您可以在功能准备就绪时介绍这些功能，并通过公司博客通知用户，该博客在新功能完成时会更新。然后，这样的博客条目应该简要概述该功能、在哪里找到它、如何使用它等。
这不仅让您的用户保持好奇和回来，它还为潜在客户提供了一个很好的方式来查看您提供的进度。

至于优先考虑未来的实施：让客户也参与进来怎么样？查看 uservoice（它用于跟踪该站点的请求/错误）。它提供了一种让用户对最想要的事情进行投票的好方法，并显示正在处理的内容和计划中的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-15T03:07:12.613

“以绝对（例如）1-100 的比例对每个功能进行排名”

按顺序构建它们。

当你有（a）重要价值或（b）小东西的临界质量时释放它们。

始终按优先顺序工作。首先构建最重要的东西。尽快交付尽可能多的价值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-05T23:30:15.303

这里的一些人已经说过 - 让最终用户参与决定什么进入和等待什么的决策过程。毕竟，它不是关于什么对您有用，而是什么对您的最终用户有用。

也就是说，我不会将其留给“所有用户来决定”；应该有来自与您一起工作的用户组的代表（即高级用户角色）。

即使那样，您也不会说“您想要什么功能？” 对用户来说，你问他们接下来希望看到什么功能。你把它交给他们而不是让他们挑选一个庞大的单个功能电子表格的原因有两个：1）他们不知道依赖关系，2）你想收集一组功能以进行合乎逻辑的发布.

所以用户代表可能会说“我们需要让照片库接下来工作”。他们可能不知道照片库实际上与文件上传模块相同（它只是接受不同的文件类型）。

所以，在下一个发行版本中，你将照片库和文件上传打包在一起——考虑到文件上传已经完成了 75%，因为照片库模块中的工作，你为什么不这样做呢？

我不认为您必须首先研究最难的功能，它是用户更快需要的+您收集的其他功能以制作“逻辑包”。

在某种程度上，您也想清除功能日志。因此，例如，您可能具有以下功能和估计时间：

1.  登记表 - 3 小时
2.  照片库 - 8 小时（<- 客户说他们接下来想要这个）
3.  文件上传 - 2 小时
4.  投票/投票模块 - 7 小时
5.  股票行情 - 5 小时

出于这些人为的功能，我不会接受。2（因为客户要求它），那么我不会。1和3。没有。3 因为它实际上是在画廊代码完成时完成的，而不是。1 纯粹是因为它是剩余特征中最小的估计。没有什么能让你或你的编码人员感受到你的项目取得进展的感觉，就像认真击败功能列表（尽管它可能会重新填充）。

至于让人们了解新版本及其内容，我会通过电子邮件（而不是通过博客或程序本身）进行。我会尽可能简短，要点，如下所示：

===

*Blue Widgets* 1.1 版刚刚推出，现在可供您使用。

添加了以下内容：

*   照片库

*   上传文件

*   报名表格

系统内的用户手册包含有关这些功能如何工作的更多信息。

===

砰 - 完成，让人们尽可能容易。

*   LM

# iphone - 在 UIScrollView 中有相当大的图像的 UIImageViews 使用的内存释放问题

> ID：289360
> 
> 赞同：11
> 
> 时间：2008-11-14T06:23:44.153
> 
> 标签：iphone, objective-c, cocoa-touch, memory-management

我有一个大的 UIScrollView，我在其中放置了 3-4 个相当大（320x1500 像素左右）的 UIImageView 图像图块。我将这些 UIImageViews 添加到我的 NIB 文件内的滚动视图中。我的控制器上有一个插座，那就是 UIScrollView。我为此使用了一个属性（非原子，保留），并对其进行了综合。

我的问题是：当我在内存监视器中观察到这一点时，我可以看到，当加载了所有这些图像的视图时（如预期的那样），使用的内存增加了很多。但是当我离开视图时，它和它的控制器被释放了，但似乎并没有放弃它们占用的内存附近的任何地方。当我将其中一个视图（我的应用程序中有几个）缩减为 1-3 个 320x460 的图像并保持其他所有内容相同时，它可以很好地重新捕获内存。

使用这么大的图像有什么问题吗？我在这段代码中做错了什么（粘贴在下面）？

这是导致问题的 viewController 的片段。

```
- (CGFloat)findHeight 
{
    UIImageView *imageView = nil;
    NSArray *subviews = [self.scrollView subviews];

    CGFloat maxYLoc = 0;
    for (imageView in subviews)
    {
            if ([imageView isKindOfClass:[UIImageView class]])
            {
                    CGRect frame = imageView.frame;

                    if ((frame.origin.y + frame.size.height) > maxYLoc) {
                            maxYLoc  = frame.origin.y;
                            maxYLoc += frame.size.height;
                    }
            }
    }
    return maxYLoc;
}

- (void)viewDidLoad {
    [super viewDidLoad];
    [self.scrollView setContentSize:CGSizeMake(320, [self findHeight])];

    [self.scrollView setCanCancelContentTouches:NO];
    self.scrollView.indicatorStyle = UIScrollViewIndicatorStyleWhite;
    self.scrollView.clipsToBounds = YES;                
    self.scrollView.scrollEnabled = YES;

    self.scrollView.pagingEnabled = NO;
}

- (void)dealloc {
    NSLog(@"DAY Controller Dealloc'd");
    self.scrollView = nil;
    [super dealloc];
} 
```

更新：我注意到另一个奇怪的现象。如果我不使用视图上的滚动，它似乎会挂在内存上。但是，如果我滚动一堆并确保所有 UIImageViews 在某一时刻都可见，它将释放并重新获得它丢失的大部分内存。

UPDATE2：我问这个的原因是我的应用程序实际上由于内存不足而崩溃。我不介意它是否只是缓存和使用额外的内存，但它似乎永远不会释放它 - 即使在 didReceiveMmoryWarning 条件下

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-14T20:08:11.507

我已经解开了这个谜团——我很确定这是苹果方面的一个错误。

正如 Kendall 所建议的（谢谢！），问题在于 InterfaceBuilder 如何从 NIB 文件加载图像。当你 initFromNib 时，所有 UIImageViews 都将使用 UIImage 的 imageNamed: 方法初始化一个 UIImage。此调用对图像使用缓存。通常，这就是您想要的。但是，对于非常大的图像以及滚动远离可见区域的图像，它似乎没有遵守内存警告并转储此缓存。这是我认为苹果方面的一个错误（如果您同意/不同意，请发表评论 - 如果其他人同意，我想提交）。正如我上面所说，如果用户滚动到足以使其全部可见，这些图像使用的内存似乎确实被释放了。

我发现的解决方法（也是 Kendall 的建议）是在 NIB 文件中将图像名称留空。因此，您可以正常布置 UIImageView 元素，但不要选择图像。然后在您的 viewDidLoad 代码中，您进入并使用 imageWithContentsOfFile: 加载图像。此方法不会缓存图像，因此不会导致保留大图像时出现任何内存问题。

当然，imageNamed: 更容易使用，因为它默认为包中的任何内容，而不必查找路径。但是，您可以使用以下内容获取捆绑包的路径：

```
NSString *fullpath = [[[NSBundle mainBundle] bundlePath]; 
```

把所有这些放在一起，这就是代码中的样子：

```
NSString *fullpath = [[[NSBundle mainBundle] bundlePath] stringByAppendingString:[NSString stringWithFormat:@"/%@-%d.png", self.nibName, imageView.tag]];
UIImage *loadImage = [UIImage imageWithContentsOfFile:fullpath];
imageView.image = loadImage; 
```

因此，将其添加到我上面的代码中，完整的功能如下所示：

```
- (CGFloat)findHeight 
{
    UIImageView *imageView = nil;
    NSArray *subviews = [self.scrollView subviews];

    CGFloat maxYLoc = 0;
    for (imageView in subviews)
    {
        if ([imageView isKindOfClass:[UIImageView class]])
        {
            CGRect frame = imageView.frame;

            if ((frame.origin.y + frame.size.height) > maxYLoc) {
                maxYLoc  = frame.origin.y;
                maxYLoc += frame.size.height;
            }

            NSString *fullpath = [[[NSBundle mainBundle] bundlePath] stringByAppendingString:[NSString stringWithFormat:@"/%@-%d.png", self.nibName, imageView.tag]];
            NSLog(fullpath);

            UIImage *loadImage = [UIImage imageWithContentsOfFile:fullpath];
            imageView.image = loadImage;
        }
    }
    return maxYLoc;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-14T07:12:26.160

它可能是系统缓存对内存中图像的引用，假设您刚刚在 IB 的媒体浏览器中的图像中添加了药物，下面的代码可能正在使用`UIImage` `imageNamed`: 方法...

`imageWithContentsOfFile`您可以尝试使用: 或:加载所有图像，`imageWithData`看看它的行为是否相同（拖入未填充`UIImageViews`的 IB 并在 : 中设置内容）`viewDidLoad`。

如果您想了解更多细节，请阅读`UIImage`类参考，它还描述了缓存哪些方法。

如果是缓存，它可能没问题，因为系统会在需要时释放它（您是否也尝试在模拟器中点击模拟内存警告？）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-10-23T18:57:36.423

与您的 imageNamed 缓存问题分开，您的问题的答案

> 我有一个大的 UIScrollView，我在其中放置了 3-4 个相当大（320x1500 像素左右）的 UIImageView 图像图块。[...] 使用这么大的图像有什么问题吗？

在 UIImage 文档的标题中：

```
You should avoid creating UIImage objects that are greater than 1024 x 1024 in size.
Besides the large amount of memory such an image would consume, you may run into 
problems when using the image as a texture in OpenGL ES or when drawing the image 
to a view or layer. 
```

此外，Apple 声称已在 3.0 及更高版本中修复了 imageNamed 缓存刷新问题，尽管我自己并没有对此进行广泛测试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-10T18:56:45.263

**完成 Bdebeez 的回答。**

一个好主意是覆盖`imageNamed:`调用`imageWithContentsOfFile:`.

这是代码的想法：

```
@implementation UIImage(imageNamed_Hack)

+ (UIImage *)imageNamed:(NSString *)name {

    return [UIImage imageWithContentsOfFile:[NSString stringWithFormat:@"%@/%@", [[NSBundle mainBundle] bundlePath], name ] ];
}

@end 
```

**注意：** *使用此覆盖，您将不会有任何缓存加载 UIImages，如果需要，您将必须实现自己的缓存。*

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T06:30:22.703

```
- (void)dealloc {
    NSLog(@"DAY Controller Dealloc'd");
    [self.scrollView release];
    [super dealloc];
} 
```

试一试，您的 @property() 定义要求保留它，但您没有明确释放该对象

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-14T08:57:31.160

从我从它的内存管理行为中了解到的是，除非内存不足，否则视图不会被释放。尝试像 SQLBooks 这样的官方演示： 1\. 使用 Leaks Monitor 运行 2\. 运行它拥有的每个视图。3\. 返回根视图。4\. 您会注意到内存使用水平仍然相同。正如肯德尔所说，它可能会被缓存？

我认为您不应该注意这种内存使用模式——因为当新图像指向 UIScrollView 时，旧图像对象将被释放，并且无论如何都会为新图像释放内存。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-26T21:27:47.307

有一个已知问题 - imageName 中存在内存泄漏。我找到了一个非常有用的解决方案——在应用程序委托中创建图像现金，这样可以优化我的应用程序的性能和内存使用。 [请参阅此博客文章](http://kosmaczewski.net/projects/iphone-image-cache/)

# mysql - 如何使用 MySQL GUI 工具使字段为 NULL？

> ID：289362
> 
> 赞同：65
> 
> 时间：2008-11-14T06:25:04.587
> 
> 标签：mysql, mysql-workbench, mysql-gui-tools

我正在使用 MySQL 查询浏览器（[MySQL GUI 工具](http://dev.mysql.com/downloads/gui-tools/)的一部分）并且需要将一个字段更改为 NULL，但我不知道该怎么做 - 如果我删除它尝试将其更新为`''`. 键入“NULL”使其尝试更新为`'NULL'`（字符串）。

我知道我可以只写一个查询来做到这一点，但这违背了该工具的全部目的，不是吗？

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2008-11-14T06:37:01.473

在 MySQL 查询浏览器中，右键单击单元格并选择“清除字段内容”，而焦点位于另一个单元格中。

在 MySQL Workbench 中，右键单击单元格并选择“将字段设置为 NULL”。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-05-30T19:46:23.630

在 MySQL Workbench 中，选中单元格，按`Shift + Delete`

在 6.3.4.0 上测试

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T07:10:44.930

删除内容：

这适用于某些工具（很抱歉听到它不适用于您的工具）。这可能不会显示为 null，但会在您执行查询时显示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-11T12:26:38.200

```
Shift + Delete 
```

在 MySql Workbench 8 中运行良好

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-21T19:58:14.097

右键单击该列并选择

# '将字段设置为空'

上下文菜单中的选项。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2008-11-14T06:28:37.480

我会尝试 Ctrl-0（零），因为这适用于某些工具。

# functional-programming - 是否有支持可移植延续的快速语言？

> ID：289370
> 
> 赞同：13
> 
> 时间：2008-11-14T06:29:14.953
> 
> 标签：functional-programming, scheme, continuations

我正在寻找一种支持可移植延续的快速语言（即一种可以本地编译以实现性能不超过 C 3 或 4 倍的语言）。我的意思是可以在一台计算机上序列化并在另一台计算机上反序列化的延续。

我知道 SISC 可以做到这一点（Java 中的 Scheme 实现），但速度很慢。同样适用于 Rhino（Java 中的 Javascript 实现）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-14T07:30:56.293

你检查**过 OCaml**吗？它可以被编译并且应该比 C 稍微慢一些。

[延续和定界控制](http://okmij.org/ftp/Computation/Continuations.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-17T17:51:57.257

虽然我同意 Caml 的方言可能是一个很好的选择，但我觉得我不得不提到[Gambit Scheme](https://github.com/mindpool/gambit-termite)。与 Termite（一个类似 erlang 的框架）一起，它支持序列化延续、通过网络发送它们等等。

它编译为 C 代码。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-10-05T04:18:44.713

Scala 2.8.0 将允许延续，并且它们将是可移植的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-14T18:52:37.633

可以使用 Apache JavaFlow 在 Java 中进行可序列化的延续 - 如果你确实走这条路，那么 Swing Continuations 库位于：

[http://www.exploringexcellence.com/swingcontinuations/download.html](http://www.exploringexcellence.com/swingcontinuations/download.html)

使它的编码更加愉快。

# google-app-engine - 为什么 Google App Engine 会限制 GQL 查询？

> ID：289375
> 
> 赞同：5
> 
> 时间：2008-11-14T06:32:55.723
> 
> 标签：google-app-engine

我在 wikipedia 上阅读[App Engine](http://en.wikipedia.org/wiki/App_Engine)并遇到了一些 GQL 限制：

*   不支持加入

*   一次最多可以从一个表中选择

*   最多可以在 WHERE 子句中放置 1 列

这些限制有什么好处？

这些限制在其他优先考虑可扩展性的地方是否常见？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-14T06:37:10.350

GQL 与之对话的数据存储是：

*   不是像 MySQL 或 PostgreSQL 这样的关系数据库
*   是一个名为 BigTable 的面向列的 DBMS

拥有这样一个数据库的一个原因是拥有一个可以跨数百台服务器扩展的高性能数据库。

GQL 不是 SQL，它是类似 SQL 的。

以下是一些参考资料：

*   [http://en.wikipedia.org/wiki/Column-oriented_DBMS](http://en.wikipedia.org/wiki/Column-oriented_DBMS)
*   [http://en.wikipedia.org/wiki/BigTable](http://en.wikipedia.org/wiki/BigTable)
*   [http://code.google.com/appengine/docs/datastore/overview.html](http://code.google.com/appengine/docs/datastore/overview.html)
*   [http://code.google.com/appengine/docs/datastore/gqlreference.html](http://code.google.com/appengine/docs/datastore/gqlreference.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-14T06:41:05.193

我相信答案实际上与数据存储的底层技术有关，而不是对可用内容的任何限制。Google 并没有在后台使用关系数据库，而是使用[BigTable](http://en.wikipedia.org/wiki/BigTable)，他们刚刚添加了一个很好的 API，它使用类似 SQL 的查询来限制那些习惯使用关系数据库的人的学习曲线。对于那些更习惯使用 ORM 的人来说，他们会像鸭子一样接受它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-01-27T23:17:55.590

现有答案很好地解决了高级问题。

另外一点：您提到的第三个限制实际上并不正确。GQL 查询可以在 WHERE 子句中包含任意数量的列。有一些注意事项，但列数没有明确限制。更多的：

[http://code.google.com/appengine/docs/python/datastore/queries.html](http://code.google.com/appengine/docs/python/datastore/queries.html)

# xml - 需要帮助诊断 Amazon S3 的 SOAP 数据包问题

> ID：289380
> 
> 赞同：1
> 
> 时间：2008-11-14T06:41:30.217
> 
> 标签：xml, soap, amazon-s3, amazon

我们正在构建一个将数据存储在 S3 存储桶中的应用程序。但是，我们遇到了**PutObject**方法的问题。这是我们发送的 xml 数据包：

```
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
   <soap:Body>
      <PutObject xmlns="http://doc.s3.amazonaws.com/2006-03-01">
         <Bucket>lills</Bucket>
         <Key>lills123</Key>
         <Metadata>
            <Name>Content-Type</Name>
            <Value>text/plain</Value>
         </Metadata>
         <Metadata>
            <Name>title</Name>
            <Value>lills</Value>
         </Metadata>
         <Data>aGEtaGE=</Data>
         <ContentLength>5</ContentLength>
         <AWSAccessKeyId>key</AWSAccessKeyId>
         <Timestamp>2008-11-12T06:23:17Z</Timestamp>
         <Signature>signature</Signature>
      </PutObject>
   </soap:Body>
</soap:Envelope> 
```

这是我们从 S3 得到的响应：

```
<?xml version="1.0" encoding="utf-8"?>
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
   <soapenv:Body>
      <soapenv:Fault>
         <faultcode>soapenv:Client.badRequest</faultcode>
         <faultstring>Malformed request</faultstring>
         <detail/>
      </soapenv:Fault>
   </soapenv:Body>
</soapenv:Envelope> 
```

谁能告诉我 SOAP 数据包的问题是什么？

在此先感谢，德文

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-27T19:21:59.393

If you want to send the data in the SOAP message itself, you need to use PutObjectInline, and not PutObject (which expects the data to be a DIME attachment).

see [PutObjectInline](http://docs.amazonwebservices.com/AmazonS3/latest/index.html?SOAPPutObjectInline.html) in the s3 docs.

# c++ - 在EXE中运行无限while循环的奇怪问题

> ID：289381
> 
> 赞同：0
> 
> 时间：2008-11-14T06:44:21.037
> 
> 标签：c++, windows-mobile

我在 Windows CE 上遇到了奇怪的问题：

运行 3 个 EXE

1）除非发出退出事件信号，否则第一个 exe 每 8 分钟做一次工作。2）除非退出事件发出信号，否则第二个 exe 每 5 分钟做一次工作。3）第三个exe while循环正在运行，并且在while循环中它随机执行一些工作。这个while循环一直持续到退出事件发出信号。

现在这个退出事件是全局事件，可以由任何进程发出信号。

问题是当我运行第一个exe它工作正常，运行第二个exe它工作正常，运行第三个exe它工作正常

当我运行所有 exe 时，只有第三个 exe 运行，并且在第一个和第二个中没有执行任何指令。

一旦第三个exe被终止，第二个开始处理。是不是第三个 exe 中的 while 循环占用了所有 CPU 周期？我还没有尝试过睡眠，但我认为这可以起到一些作用。但是操作系统应该为所有进程提供 CPU ......有什么想法吗？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T07:03:33.963

每次通过循环将第三个EXE中的while循环放入Sleep，看看会发生什么。即使它不能解决这个特定的问题，使用 while 循环进行轮询也不是一个好习惯，即使在循环中使用 Sleep 也不能很好地替代适当的计时器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T09:38:07.910

在[MSDN](http://msdn.microsoft.com/en-us/magazine/bb985033.aspx)上，我还读到 CE 允许同时（少于）32 个进程。（但是，上下文切换快如闪电......）。有些已经被系统服务占用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T14:45:36.493

（从内存中）如果没有更高优先级的进程在运行，Windows CE 中的进程将一直运行直到完成，或者如果有其他同等优先级的进程正在运行，它们会运行它们的时间片（100 毫秒）。我不确定 Windows CE 是否为带有活动/前台窗口的进程提供了一个小的优先级提升（就像桌面 Windows 一样）。

在您的情况下，前两个进程缺乏处理器时间，因此在第三个进程退出之前它们永远不会运行。解决这个问题的一些方法是：

*   使第三个进程在某些多进程原语（互斥体、信号量等）上等待/阻塞并短暂超时。使用 WaitForMultipleObjects/WaitForSingleObject 等。
*   每次在处理循环周围调用 Sleep 使第三个进程等待。
*   提高其他进程的优先级，这样当它们需要运行时，它们会中断第三个进程并实际运行。我可能会让最不常调用的进程在三个进程中具有最高优先级。

另一件要检查的事情是第三个进程确实及时完成了它的任务，并且没有锁定 CPU 试图正常做它的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T07:14:20.930

是的，我认为这不是一个好的解决方案。我可以尝试使用计时器并查看结果..

# client-server - 请求，响应和服务器之间有什么区别？

> ID：289383
> 
> 赞同：19
> 
> 时间：2008-11-14T06:49:39.467
> 
> 标签：client-server, request, response

请求，响应和服务器之间有什么区别？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2008-11-14T06:58:39.057

**请求：**从客户端到服务器
**响应：**从服务器到客户端
**服务器：**接收请求并发送响应
**客户端：**发送请求并接收响应

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-14T06:56:21.543

客户端（网络用户）向服务器发出请求，**服务器****处理**请求**并**确定适当的**响应**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T07:41:53.557

服务器：为客户提供某些东西的机器。

关注服务器，请求是到达服务器请求某些东西的消息。响应是从服务器发送到客户端的消息，用于向客户端提供什么。

无论如何，请求/响应意味着您可以用常识知道它。

另见： [http ://en.wikipedia.org/wiki/Request-response](http://en.wikipedia.org/wiki/Request-response)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2020-06-10T15:44:26.677

第一个答案（Ramesh Soni 的答案）简单明了。我还想分享一个与此相关的有用术语区别。

# 请求和查询有什么区别？？？

*   首先，**query 和 request 既可以是名词也可以是动词**。例如：

    *   我要求退款。
    *   我们收到了退款请求。
    *   我查询了价格。
    *   我们收到了有关价格的询问。
*   请求某事是请求某事、对象或恩惠等。请求是一种*礼貌的要求*。查询就是询问某事，即您***想要信息***。*一个查询就是一个问题*。

*   此外，QUERY 是一个查询（*查询和查询是同义词*）它们都是请求，但不同之处在于**QUERY 是一个精确的请求**。在信息学中，如果您需要有关某事的信息，您需要发送带有精确信息的*特定请求。*

"我查询了用户账户Maxim Pavlov的信息" = "我需要知道这个网站的用户，特别是我需要知道这个网站上是否有Maxim Pavlov注册"。

*   如果你是阿拉伯语，最好的阿拉伯语翻译是*request = طلب 和 query = إستعلام* )

# c++ - 命名空间会发生什么？

> ID：289389
> 
> 赞同：0
> 
> 时间：2008-11-14T06:51:07.840
> 
> 标签：c++, namespaces

当在给定命名空间 a,b 中使用函数 a::open,b::open 从源代码中创建 dll 时，调用这些函数时是否会发生冲突。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T06:52:13.050

不，因为从 DLL 导出的函数名称是 C++ 错位名称。损坏的名称包括命名空间，因此不会发生冲突。

# c++ - DLL 是如何从 C++ 源代码创建的，以及它们如何在其他源代码中使用？

> ID：289397
> 
> 赞同：3
> 
> 时间：2008-11-14T06:58:23.287
> 
> 标签：c++, dll

DLL 是如何从 C++ 源代码中创建的，以及它们如何在其他源中使用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-14T07:08:14.827

DLL 是一个“动态链接库”，其工作方式与其他库非常相似，但不与您的可执行应用程序链接。在运行时，您可以调用特定函数来加载 DLL 并执行其导出的方法。

您可以尝试自己创建一个 DLL - 使用 Visual Studio 创建一个项目并指定一个 DLL。这将为您的项目创建一些基本结构，例如用于编译 DLL 的项目设置以及一些用于公开方法、对象或变量的基本代码。

在这一点上，有许多演练可以帮助您：[检查这里](http://www.google.com/search?rlz=1C1GGLS_enUS299&sourceid=chrome&ie=UTF-8&q=Creating+DLL+C%2B%2B)。

所以，总结一下：

*   DLL 是一个**可以在运行时加载的库**e。这是一个非常灵活的“插件”模型。示例：您可以在运行时以编程方式选择和加载不同的 DLL。每个 DLL 都可以是一个“插件”来提供不同的功能。

*   DLL 有一个**入口点**。就像您的命令行可执行文件的 Main 函数是入口点一样，DLL 有一个入口点函数，当 DLL 上发生不同的事件（例如加载、卸载等）时会调用该函数。

*   要使用 DLL，您必须使用 DLL 的**导出**对象或方法。

*   **当从另一个应用程序调用这些导出的函数时，匹配兼容类型**非常重要！另外，确保**调用约定**兼容

# performance - 分支预测对性能的影响？

> ID：289405
> 
> 赞同：18
> 
> 时间：2008-11-14T07:04:04.837
> 
> 标签：performance, optimization

当我编写一些需要快速工作的紧密循环时，我经常会被关于处理器分支预测将如何表现的想法所困扰。例如，我尽量避免在最内部的循环中使用 if 语句，尤其是结果不太统一的 if 语句（比如随机评估为真或假）。

我倾向于这样做，因为处理器预取指令的常识有点普遍，如果结果证明它错误地预测了一个分支，那么预取是无用的。

我的问题是 - 这真的是现代处理器的问题吗？分支预测能有多好？
可以使用哪些编码模式使其变得更好？

（为了讨论，假设我已经超出了“早期优化是万恶之源”阶段）

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-11-14T11:45:05.533

这些天，分支预测非常好。但这并不意味着可以消除分支的惩罚。

在典型的代码中，您可能得到超过 99% 的正确预测，但性能损失仍然很大。这有几个因素在起作用。

一是简单的分支延迟。在一个普通的 PC CPU 上，错误预测可能需要 12 个周期，而正确预测的分支可能需要 1 个周期。为了争论起见，我们假设你所有的分支都被正确预测了，那么你就自由了，对吧？不完全的。

分支的简单存在抑制了很多优化。编译器无法跨分支有效地重新排序代码。在一个基本块（即顺序执行的代码块，没有分支，一个入口点和一个出口）内，只要保留代码的含义，它就可以随意对指令进行重新排序，因为它们迟早都会被处决。跨分支，它变得更加棘手。我们*可以*将这些指令下移到这个分支之后执行，但是我们如何保证它们被执行呢？把它们放在两个分支中？这是额外的代码大小，也很混乱，如果我们想跨多个分支重新排序，它就无法扩展。

即使有最好的分支预测，分支仍然可能很昂贵。不仅仅是因为预测错误，还因为指令调度变得更加困难。

这也意味着，重要的因素不是分支的数量，而是它们之间的块中有多少代码。每隔一行一个分支是不好的，但是如果你可以在分支之间的一个块中放入十几行，那么可能可以合理地安排这些指令，因此分支不会过多地限制 CPU 或编译器。

但是在典型的代码中，分支基本上是免费的。在典型的代码中，在性能关键代码中没有*那么*多分支紧密地聚集在一起。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-14T07:12:39.187

“（为了讨论，假设我已经超越了“早期优化是万恶之源”阶段）”

出色的。然后您可以分析您的应用程序的性能，使用 gcc 的标签再次进行预测和分析，使用 gcc 的标签再次进行相反的预测和分析。

现在从理论上想象一个预取两条分支路径的 CPU。并且对于两条路径中的后续 if 语句，它将预取四个路径，等等。CPU 不会神奇地增长四倍的缓存空间，因此与单个路径相比，它将预取每条路径的较短部分。

如果您发现一半的预取被浪费了，例如损失了 5% 的 CPU 时间，那么您确实想要寻找一个不分支的解决方案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-14T07:12:25.597

如果我们超出了“早期优化”阶段，那么我们肯定也超出了“我可以衡量那个”阶段吗？随着现代 CPU 架构的疯狂复杂性，唯一确定的方法就是尝试和测量。当然，在很多情况下，您可以选择两种方式来实现某些东西，其中一种需要分支，另一种不需要。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-14T07:13:03.740

不完全是答案，但您可以在此处找到一个小程序，该[小程序演示了现代微处理器中经常用于基于表的分支预测的有限状态机](http://tams-www.informatik.uni-hamburg.de/applets/hades/webdemos/45-misc/05-fsm-editor/branch-prediction.html)。

它说明了使用额外的逻辑来生成对分支条件和目标地址的快速（但可能是错误的）估计。
处理器全速获取并执行预测指令，但当预测结果错误时需要恢复所有中间结果。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-06T19:42:24.977

是的，分支预测确实**可能** 是一个性能问题。

[这个问题](https://stackoverflow.com/questions/11227809/why-is-processing-a-sorted-array-faster-than-an-unsorted-array)（目前 StackOverflow 上投票率最高的问题）举了一个例子。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-14T07:11:37.580

我的回答是：

AMD 在某些方面与 Intel 一样快或更好的原因仅仅是因为他们有更好的分支预测。

如果您的代码没有分支预测（意味着它没有分支），那么它可以预期运行得更快。

因此，结论：如果没有必要，请避免使用分支。如果是，请尝试使一个分支的评估率达到 95%。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-17T19:57:45.647

我最近发现的一件事（在 TI DSP 上）是，试图避免分支有时会生成比分支预测成本更多的代码。

我在一个紧密的循环中有类似以下的内容：

```
if (var >= limit) { otherVar = 0;} 
```

我想摆脱潜在的分支，并尝试将其更改为：

```
otherVar *= (var<limit)&1; 
```

但是“优化”产生了两倍的程序集，实际上速度更慢。

# html - 全高 CSS 布局，多列

> ID：289409
> 
> 赞同：2
> 
> 时间：2008-11-14T07:09:06.213
> 
> 标签：html, css, layout

我有一个正在工作的布局，但它有一个非常烦人的问题.. 当内容高于屏幕时，背景停止。

这是 bad-ASCII-art 格式的所需布局：

```
_____________________  _
|    | long    |logo|   |
|    | content |    |   |
|    |         |    |   |
|    |         |    |   |
|grad|         |grad|   | Viewport
|    |         |    |   |
|    |         |    |   |
|    |         |    |  _|
|    |         |    |
|    |         |    |
_____________________

|2em| <-20em->| 2em| 
```

..或内容简短..

```
_____________________  _
|    | short   |logo|   |
|    | content |    |   |
|    |         |    |   |
|    |         |    |   |
|grad|         |grad|   | Viewport
|    |         |    |   |
|    |         |    |   |
|    |         |    |   |
|    |         |    |   |
_____________________  _| 
```

基本上它看起来像一个单独的柱子，两边都有一个发光的柱子。在左发光是一个标志。当内容很短时，它仍然是全高。

我尝试使用[CSS min-height hack](http://www.dustindiaz.com/min-height-fast-hack/)，它修复了中间列，但是渐变只延伸到内容（在左列中，单个`&nbsp;`，在右列中的徽标）

* * *

这是布局的样子：

![布局](https://i.stack.imgur.com/CVm4I.png)

还有问题（当浏览器窗口垂直缩小时）：

![问题](https://i.stack.imgur.com/CVhOL.png)

最后是HTML/CSS的问题，[http://data.dbrweb.co.uk/tmp/fifestock_layout_problem/](http://data.dbrweb.co.uk/tmp/fifestock_layout_problem/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-14T07:51:29.483

鉴于您的渐变在左右分开的列中，您需要实现“**[人造列](http://www.alistapart.com/articles/fauxcolumns/)**”。

如果您追求弹性版本，请查看[**Elastic Faux Columns**](http://nickcowie.com/2005/elastic-faux-columns/)和[**Multi-Column Layouts Climb Out of the Box**](http://www.alistapart.com/articles/multicolumnlayouts)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-17T14:45:23.827

这是我最终使用的，使用[这种](http://www.ejeliot.com/blog/61)高值的技术`padding-bottom`，具有相等但反转的值`margin-bottom`- 然后你设置`overflow:hidden`div 包围那个巨大的边距。

这是相当hackish，但它的工作原理！我现在有一个全高，一个 em 定义的宽度，以及每边的全高背景图像！没有太多额外的标记（一个容器 div，三列中的每一列都有一个 div）

```
<html>
<head>
    <title>Yay</title>
    <style type="text/css" media="screen">
        body, html{
            height:100%;
            margin:0;
            background:#1d4b76;
        }
        #contain{
            width:40em;
            margin-left:auto;
            margin-right:auto;
            overflow:hidden;
        }
        #left{
            background-image:url("static/grad_left.png");
            background-repeat:repeat-y;
            background-position:right;

            height:100%;
            float:left;
            width:150px;

            padding-bottom:10000px;
            margin-bottom:-10000px;
        }
        #middle{
            float:left;
            background:#000;
            color:#fff;
            width:20em;

            padding-bottom:100000px;
            margin-bottom:-100000px;
        }
        #right{
            float:left;
            background-image:url("static/grad_right.png");
            background-repeat:repeat-y;
            background-position:left;
            width:150px;

            padding-bottom:100000px;
            margin-bottom:-100000px;
        }
    </style>
</head>
<body>
    <div id="contain">
        <div id="left">
            &nbsp;              
        </div>
        <div id="middle">
                    Put lots of text here
        </div>
        <div id="right">
            <img src="static/logo.png" width="150" height="150" alt="Logo">
        </div>
    </div>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T07:12:51.370

我刚刚看了一个关于[YUI 网格](http://developer.yahoo.com/yui/grids/)的视频，看起来很有前途（推荐观看！）。我还没有时间对其进行测试，但将来很可能会这样做。这可能是你想要的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-14T08:34:03.420

试试这个修改：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html>
 <head>
 <title>Test page</title>
 <style type="text/css" media="screen">
   html, body{
     margin: 0 auto 0 auto;
     padding:0;
     width:22em;
   }

   #wrapper{
      background-color:#ccc;
   }

   #left{
      float:left;
      width:22em;
      background-color:#00f;
    }

    #middle{
       float:right;
       width:18em;
       margin-right:2em;
       background-color:#f00;
     }

     #right{
        float: right;
        width:20em;
        background-color:#0f0;
        background-image: url(static/logo.png);
        background-position: top right;
        background-repeat: no-repeat;
      }

   </style>
   </head>
   <body>
     <div id="wrapper">
       <div id="left">
          <div id="right">
             <div id="middle">
                    Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.<br><br><br> Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.<br><br><br>Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.<br><br><br> Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in oluptate velit esse cillum dolore eu fugiat nulla pariatur.<br><br><br>Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.<br><br><br>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.<br><br><br>
             </div>
           </div>
         </div>
       </div>
   </body>
</html> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T08:19:03.967

在之后添加`<div id="right">...</div>`：

```
<div style="clear: both; font-size: 1px; line-height:1px">&nbsp;</div> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-14T11:30:37.590

最终得到了这个，但必须对您的标记和图像进行一些更改。

1.  删除#left 和#right div。
2.  制作一个 592 像素宽、透明背景并在其左右具有渐变的新单一背景图像 - 具有左侧渐变的 1 像素高图像 - 透明部分 504 像素宽 - 右侧渐变。
3.  将徽标添加到#wrapper，就在#middle 之前

所以标记现在看起来像这样：

```
<body>
    <div id="wrapper">
        <img src="static/fifestock_logo.png" />
        <div id="middle">
        ... etc ...
        </div>
    </div>
</body> 
```

然后，样式表中的相关更改是：

```
#wrapper{
    height:100%;
    width:805px;
    margin-left:auto;
    margin-right:auto;
    text-align: right;
}

#middle {
    width:504px;
    padding: 0 44px;
    margin: -154px auto 0 auto;
    background:#000 url(new_bg.png) repeat-y top left;
} 
```

在我看来很好。

仅在 FF3 和 Opera 中进行了测试（在没有访问 Windows / Mac atm 的情况下运行 Linux），但我认为在 IE / Opera 中应该不会有任何大问题。

# c# - 将使用 Dreamweaver 的设计师与 Visual Studio C# 开发人员集成的最佳方式是什么？

> ID：289413
> 
> 赞同：5
> 
> 时间：2008-11-14T07:10:20.097
> 
> 标签：c#, dreamweaver, graphic-design

我知道代码隐藏文件，但是对于使用 DreamWeaver 或其他设计工具与 Visual Studio 程序员合作的设计师来说，最好的现实世界方式是什么？

例如，假设您有一个基本网站，其用户界面表单访问数据库......数据库工作肯定由开发人员完成，但如何将设计的表单与数据库编码或可能涉及控件事件的客户端逻辑联系起来，或其他与 GUI 相关的插件。图形设计师是否也在控制应用程序流程？似乎有一个很大的脱节需要解决——尤其是在设计实施后需要对其进行调整时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T07:31:18.167

最好的方法是确保您的设计人员对他们将使用的 HTML 类型有一定的了解。

每个 ASP.NET 开发人员都知道 MS-HTML，即 HTML 表格的可爱嵌套，但设计人员却不知道。设计师有他们自己的要求要满足，他们会以最好的方式做到这些。可悲的是，这通常对我们不利。

当我从我们的 UI 团队收到一个设计时，我总是感到沮丧，该设计使用浮动 div 将单选按钮很好地布置在网格中。然后我必须打破他们的梦想，不，我不能为你生成那种 HTML（好吧，我可以使用 ControlAdapters，但每次它们都是不同的设计！）。

尝试制定 90%/10% 规则，其中 90% 的设计在 ASP.NET 启动之前完成，10% 在 ASP.NET 完成后完成，并针对 ASP.NET 生成的 HTML 完成。

并确保您使用的是源代码控制！除非在源代码管理中，否则代码不存在！并且由于最新的 TFS PowerTools 有一个可爱的 Windows Shell 集成组件，所以你现在不需要使用 VS 来签入和签出：D

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T09:14:36.833

使用另一种方法，例如[MVC](http://en.wikipedia.org/wiki/Model-view-controller)，将您的设计与逻辑分开。像这样，团队的每个成员（设计师/开发人员）都可以专注于他们最擅长的事情。

MVC 实现：[链接](http://www.asp.net/mvc/)/[链接](http://www.castleproject.org/monorail/index.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-25T21:03:56.507

这听起来可能很俗气，但是当我使用 Dreamweaver / Visual Studio 时，我会做我的布局，然后方便地将 [RADIO BUTTON HERE]、[INPUT TEXT HERE] 等放在我的表单元素/控件会消失，我会将页面保存为基本的 HTML 文档。

这样一来，Dreamweaver 就不会在其中嵌套自己的表单标签，而且当我去合并内容时，我可以很容易地找到放置在我的 ASP.NET 控件中的位置。在 Visual 中创建一个新的 Web 表单页面很容易Studio，然后复制并粘贴所有内容。如果由于某种原因我把事情搞砸了，我将有一个基本的 HTML“模板”来重新开始。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T20:49:40.030

不幸的是，这是一个非常普遍的问题。Dreamweaver 通常不会编写对 .net 开发人员友好的 html。如果可能的话，找一个可以真正阅读和编写 HTML 的人，而不仅仅是使用 Dreamweaver WYSIWYG 编辑器。

我经常发现，如果我和一个不懂 html 的设计师一起工作，我实际上可以节省很多时间，让他们在 photoshop 中模拟所有内容，然后给我切片图像。我发现我以 .net 友好的格式编写实际的 HTML 可以节省大量时间，而不必在这种情况下与设计人员来来回回。

# jms - MQRA:MC:Warning:createConnection API used w/o username, password for Application Auth|#]

> ID：289429
> 
> 赞同：1
> 
> 时间：2008-11-14T07:25:22.467
> 
> 标签：jms

有谁知道为什么会发生此错误以及如何解决？它似乎只在我们遇到异常时发生。

> [#|2008-11-14T14:49:12.482+0800|警告|sun-appserver-pe8.2|javax.enterprise.system.stream.err|_ThreadID=12;| MQRA:MC:Warning:createConnection API used w/o username, password for Application Auth|#]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-14T08:01:24.003

这似乎与[打开文件过多的问题非常相似](http://forums.java.net/jive/message.jspa?messageID=218478)

# c# - ASP.NET HttpModule - 保证执行前处理程序和后处理程序代码？

> ID：289432
> 
> 赞同：4
> 
> 时间：2008-11-14T07:27:35.520
> 
> 标签：c#, asp.net, httpmodule

基本上，我正在尝试在 ASP.NET HttpModule 中编写以下（伪代码）：

```
*pre-code*
try { handler.ProcessRequest(...) }
catch (Exception) { *error-code* }
finally { *post-code* } 
```

我发现我可以挂接到 HttpModule.PreExecuteHandler 的“预代码”和 .Error 的“错误代码”。但是 PostExecuteHandler 似乎并没有可靠地运行。

BeginRequest 和 EndRequest 运行可靠，但对于我需要编写的代码来说还为时过早，这需要检查选择执行的处理程序。直到 BeginRequest 之后才选择处理程序。

编写这种包装器是否有最佳实践？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-17T18:00:31.887

除了不调用 Response.End 之外，没有办法做你想做的事（至少在 HttpModule 中）。[本文](http://www.west-wind.com/Weblog/posts/494.aspx)很好地解释了它，并提供了 Response.End 的替代方案，以防它是您调用 Server.Transfer 的副作用。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2008-11-15T17:45:06.460

将此添加到您的 Global.asax 文件中：

```
protected void Application_PreRequestHandlerExecute(object sender, EventArgs e)
{
    //
}

protected void Application_PostRequestHandlerExecute(object sender, EventArgs e)
{
    //
} 
```

那应该100％有效。

# image - Firefox - designMode：禁用图像大小调整句柄

> ID：289433
> 
> 赞同：14
> 
> 时间：2008-11-14T07:27:53.790
> 
> 标签：image, firefox, resize, contenteditable, designmode

如何防止用户在 designMode 中调整图像大小？（单击图像时禁用手柄）

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2010-06-12T14:16:18.160

这适用于 Firefox：

`document.execCommand("enableObjectResizing", false, false);`

对于 IE，我使用过：

`image.attachEvent("onresizestart", function(e) { e.returnValue = false; }, false);`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-14T07:48:37.117

假设您像这样打开 contentEditable ：

```
document.body.contentEditable = true; 
```

您所要做的就是为所有（或部分）图像关闭它。

```
var imgs = document.getElementsByTagName("IMG");
for (var i = 0; i < imgs.length; ++i) {
    imgs[i].contentEditable = false;
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-04-30T04:01:56.520

我想你会发现这更容易接受。似乎可以在 Firefox 中使用，但我不确定其他浏览器：

```
document.execCommand("enableObjectResizing", false, false); 
```

它使拖放功能保持不变。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T11:32:29.150

好吧，你不能在 Firefox 和 IE 中删除那些调整大小的处理程序……至少我找不到解决方案。

最后，我通过编辑 FF 安装文件夹中的一些配置文件在 Firefox 中进行了管理，我们不想这样做，对吧？

无论如何，如果您想禁用调整图像大小（但调整大小处理程序仍然可见），只需添加一些 css 样式，例如：

```
img {
    width: auto !important;
    height: auto !important;
} 
```

问候，米海洛

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-25T19:04:24.317

虽然这个问题是很久以前的问题了。每个块元素（div、img...）都将使用 FF 的句柄进行装饰。测试它：

```
<div id="myDiv" contenteditable="true"><p>Sample text!</p></div> 
```

没有句柄，没有调整大小等。

```
<div id="myDiv" contenteditable="true"><p>Sample text!</p><img src="picture.jpg" /></div> 
```

图像可以调整大小。因此，您必须为您不想拥有句柄的每个块元素显式调用 contenteditable="false"，正如 nickf 已经对图像所说的那样。

更奇怪的是：将“位置：绝对”分配给您的任何元素 - 甚至是父 div - 它再次具有句柄。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-20T16:40:10.607

我还不能评论和投票，所以......根据nmb.ten的回答，你必须使用：

```
document.execCommand("enableObjectResizing", false, false); 
```

**但**它**仅在**您填写内容后才有效（我的意思是如果您必须编辑之前保存的一些文本）。

# java - 如何让 Java 线程等待另一个线程的输出？

> ID：289434
> 
> 赞同：133
> 
> 时间：2008-11-14T07:29:37.000
> 
> 标签：java, multithreading

我正在制作一个带有应用程序逻辑线程和数据库访问线程的 Java 应用程序。它们都在应用程序的整个生命周期中持续存在，并且都需要同时运行（一个与服务器对话，一个与用户对话；当应用程序完全启动时，我需要*它们*都工作）。

但是，在启动时，我需要确保最初应用程序线程等待数据库线程准备好（当前通过轮询自定义方法确定`dbthread.isReady()`）。在数据库线程准备好之前，我不介意应用程序线程是否阻塞。

`Thread.join()`看起来不像一个解决方案 - db 线程仅在应用程序关闭时退出。

`while (!dbthread.isReady()) {}`有点工作，但空循环消耗了大量的处理器周期。

还有其他想法吗？谢谢。

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2008-11-14T09:10:22.053

使用计数器为 1的[CountDownLatch 。](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CountDownLatch.html)

```
CountDownLatch latch = new CountDownLatch(1); 
```

现在在应用程序线程中做-

```
latch.await(); 
```

在 db 线程中，完成后，执行 -

```
latch.countDown(); 
```

* * *

## 回答 #2

> 赞同：131
> 
> 时间：2008-11-14T07:56:43.183

在开始进入神奇的多线程世界之前，我真的建议您先阅读[Sun 的 Java Concurrency 之类的教程。](http://java.sun.com/docs/books/tutorial/essential/concurrency/)

也有很多好书出（google for "Concurrent Programming in Java", "Java Concurrency in Practice".

**为了得到你的答案：**

在您必须等待的代码中`dbThread`，您必须具有以下内容：

```
//do some work
synchronized(objectYouNeedToLockOn){
    while (!dbThread.isReady()){
        objectYouNeedToLockOn.wait();
    }
}
//continue with work after dbThread is ready 
```

在您`dbThread`的方法中，您需要执行以下操作：

```
//do db work
synchronized(objectYouNeedToLockOn){
    //set ready flag to true (so isReady returns true)
    ready = true;
    objectYouNeedToLockOn.notifyAll();
}
//end thread run method here 
```

`objectYouNeedToLockOn`我在这些示例中使用的对象最好是您需要从每个线程同时操作的对象，或者您可以为此目的创建一个单独的`Object`对象（我不建议使方法本身同步）：

```
private final Object lock = new Object();
//now use lock in your synchronized blocks 
```

**为了进一步理解：**
还有其他（有时更好）的方法来完成上述操作，例如 with等。从 Java 5 开始，包和子包`CountdownLatches`中有很多漂亮的并发类。`java.util.concurrent`你真的需要在网上找资料来了解并发，或者买一本好书。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2012-01-18T14:03:33.243

要求 ：：

> 1.  等待下一个线程的执行，直到上一个线程完成。
> 2.  下一个线程必须在前一个线程停止之前启动，无论时间消耗如何。
> 3.  它必须简单易用。

回答 ：：

> @参见 java.util.concurrent.Future.get() 文档。
> 
> future.get() 如有必要，等待计算完成，然后检索其结果。

任务完成！！请参阅下面的示例

```
import java.util.concurrent.Callable;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

import org.junit.Test;

public class ThreadTest {

    public void print(String m) {
        System.out.println(m);
    }

    public class One implements Callable<Integer> {

        public Integer call() throws Exception {
            print("One...");
            Thread.sleep(6000);
            print("One!!");
            return 100;
        }
    }

    public class Two implements Callable<String> {

        public String call() throws Exception {
            print("Two...");
            Thread.sleep(1000);
            print("Two!!");
            return "Done";
        }
    }

    public class Three implements Callable<Boolean> {

        public Boolean call() throws Exception {
            print("Three...");
            Thread.sleep(2000);
            print("Three!!");
            return true;
        }
    }

    /**
     * @See java.util.concurrent.Future.get() doc
     *      <p>
     *      Waits if necessary for the computation to complete, and then
     *      retrieves its result.
     */
    @Test
    public void poolRun() throws InterruptedException, ExecutionException {
        int n = 3;
        // Build a fixed number of thread pool
        ExecutorService pool = Executors.newFixedThreadPool(n);
        // Wait until One finishes it's task.
        pool.submit(new One()).get();
        // Wait until Two finishes it's task.
        pool.submit(new Two()).get();
        // Wait until Three finishes it's task.
        pool.submit(new Three()).get();
        pool.shutdown();
    }
} 
```

该程序的输出::

```
One...
One!!
Two...
Two!!
Three...
Three!! 
```

您可以看到在完成其任务之前需要 6 秒，这比其他线程要大。所以 Future.get() 一直等到任务完成。

如果您不使用 future.get() 它不会等待完成并执行基于时间消耗。

祝 Java 并发好运。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2017-01-20T12:13:16.423

很多正确答案，但没有一个简单的例子。这是一个简单易用的使用方法`CountDownLatch`：

```
//inside your currentThread.. lets call it Thread_Main
//1
final CountDownLatch latch = new CountDownLatch(1);

//2
// launch thread#2
new Thread(new Runnable() {
    @Override
    public void run() {
        //4
        //do your logic here in thread#2

        //then release the lock
        //5
        latch.countDown();
    }
}).start();

try {
    //3 this method will block the thread of latch untill its released later from thread#2
    latch.await();
} catch (InterruptedException e) {
    e.printStackTrace();
}

//6
// You reach here after  latch.countDown() is called from thread#2 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-06-11T10:21:18.410

```
public class ThreadEvent {

    private final Object lock = new Object();

    public void signal() {
        synchronized (lock) {
            lock.notify();
        }
    }

    public void await() throws InterruptedException {
        synchronized (lock) {
            lock.wait();
        }
    }
} 
```

然后像这样使用这个类：

创建一个线程事件：

```
ThreadEvent resultsReady = new ThreadEvent(); 
```

在方法中，这是等待结果：

```
resultsReady.await(); 
```

在创建所有结果后创建结果的方法中：

```
resultsReady.signal(); 
```

**编辑：**

（很抱歉编辑了这篇文章，但这段代码的竞争条件非常糟糕，我没有足够的声誉来发表评论）

只有当你 100% 确定在 await() 之后调用了 signal() 时，你才能使用它。这是您不能使用 Java 对象（例如 Windows 事件）的一大原因。

如果代码按此顺序运行：

```
Thread 1: resultsReady.signal();
Thread 2: resultsReady.await(); 
```

然后**线程 2 将永远等待**。这是因为 Object.notify() 只唤醒当前正在运行的线程之一。稍后等待的线程不会被唤醒。这与我期望事件的工作方式非常不同，在这种情况下，事件会发出信号，直到 a) 等待或 b) 显式重置。

注意：大多数时候，您应该使用 notifyAll()，但这与上面的“永远等待”问题无关。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-11-14T07:59:00.433

尝试包外的[CountDownLatch](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CountDownLatch.html)类`java.util.concurrent`，它提供了更高级别的同步机制，与任何低级别的东西相比，它更不容易出错。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-11-14T08:07:00.027

您可以使用两个线程之间共享的[Exchanger对象来做到这一点：](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/Exchanger.html)

```
private Exchanger<String> myDataExchanger = new Exchanger<String>();

// Wait for thread's output
String data;
try {
  data = myDataExchanger.exchange("");
} catch (InterruptedException e1) {
  // Handle Exceptions
} 
```

在第二个线程中：

```
try {
    myDataExchanger.exchange(data)
} catch (InterruptedException e) {

} 
```

正如其他人所说，不要采取这种轻松而只是复制粘贴代码的方式。先做一些阅读。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-11-14T09:00:11.043

包中的[Future](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Future.html)接口`java.lang.concurrent`旨在提供对在另一个线程中计算的结果的访问。

看一下[FutureTask](http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/FutureTask.html)和[ExecutorService](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html)以了解做这种事情的现成方法。

我强烈建议任何对并发和多线程感兴趣的人阅读[Java Concurrency In Practice 。](http://www.javaconcurrencyinpractice.com/)它显然集中在 Java 上，但对于使用其他语言的任何人来说也有很​​多好处。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-14T07:46:13.127

这适用于所有语言：

您想要一个事件/侦听器模型。您创建一个侦听器来等待特定事件。该事件将在您的工作线程中创建（或发出信号）。这将阻塞线程，直到收到信号，而不是像您当前拥有的解决方案那样不断轮询以查看是否满足条件。

您的情况是导致死锁的最常见原因之一——请确保您向另一个线程发出信号，而不管可能发生的错误如何。示例 - 如果您的应用程序抛出异常 - 并且从不调用该方法来通知其他事情已经完成。这将使另一个线程永远不会“醒来”。

我建议您在实施案例之前研究使用事件和事件处理程序的概念，以便更好地理解这种范例。

或者，您可以使用使用互斥锁的阻塞函数调用 - 这将导致线程等待资源空闲。为此，您需要良好的线程同步 - 例如：

```
Thread-A Locks lock-a
Run thread-B
Thread-B waits for lock-a
Thread-A unlocks lock-a (causing Thread-B to continue)
Thread-A waits for lock-b 
Thread-B completes and unlocks lock-b 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-11-14T08:21:10.140

如果你想要一些快速而肮脏的东西，你可以在你的 while 循环中添加一个 Thread.sleep() 调用。如果数据库库是您无法更改的，那么真的没有其他简单的解决方案。轮询数据库直到准备好等待一段时间不会影响性能。

```
while (!dbthread.isReady()) {
  Thread.sleep(250);
} 
```

几乎没有什么可以称为优雅代码的东西，但可以完成工作。

如果您可以修改数据库代码，那么使用其他答案中提出的互斥锁会更好。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-05-04T15:16:25.763

您可以从一个线程中的阻塞队列中读取并在另一个线程中写入它。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-05-10T10:24:25.397

自从

1.  `join()`已被排除
2.  您已经使用了[CountDownLatch](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CountDownLatch.html)和
3.  [Future.get()](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Future.html#get--)已经被其他专家提出，

您可以考虑其他替代方案：

1.  [调用全部](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html#invokeAll-java.util.Collection-)来自`ExecutorService`

    ```
    invokeAll(Collection<? extends Callable<T>> tasks) 
    ```

    > 执行给定的任务，返回一个 Futures 列表，在所有完成时保存它们的状态和结果。

2.  [ForkJoinPool](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ForkJoinPool.html)或[newWorkStealingPool](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Executors.html#newWorkStealingPool--)来自`Executors`（从 Java 8 版本开始）

    > 创建一个工作窃取线程池，使用所有可用处理器作为其目标并行度级别。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2016-05-09T18:45:36.870

[![在此处输入图像描述](https://i.stack.imgur.com/lTchq.png)](https://i.stack.imgur.com/lTchq.png)

这个想法可以适用吗？如果您使用 CountdownLatches 或 Semaphores 效果很好，但如果您正在寻找最简单的面试答案，我认为这可以适用。

# asp.net - 当我指定协议和端口时，只能在 ASP.NET 1.1 中访问 Sql Server 2005

> ID：289438
> 
> 赞同：0
> 
> 时间：2008-11-14T07:33:58.160
> 
> 标签：asp.net, sql-server-2005, connection-string, asp.net-1.1

我的公司目前正在将他们的一些真正旧的数据库迁移到 sql server 2005。一些旧应用程序在连接到新服务器时出现问题。连接字符串在 Asp.NET 2.0 中有效，可能是因为它自动假定为 tcp:1433。

我必须在 ASP.NET 1.1 中构造这样的连接字符串才能使其工作：

```
"Server=tcp:my.server.com,1433;..." 
```

没有协议和端口，连接失败（“无效连接异常”）

TCP 1433 和 UDP 1434 在我们的防火墙上是开放的。在 SQL Server 2005 上启用了远程访问，TCPIP 也是如此，SQL Browser 服务正在运行，我使用正确的登录凭据。

任何想法为什么我不能只指定没有协议和端口号的服务器名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T09:15:39.763

IIRC SQL Server 2005 默认查找任何可用的旧端口。在我的笔记本电脑上，这意味着端口 1212。

要将其强制到特定端口，您必须转到“开始”->“程序”->“SQL Server 2005”->“配置工具”->“SQL Server 配置管理器”

从这里您必须转到 SQL Server 2005 网络配置->（服务名称）的协议->右键单击 TCP/IP->属性->选择选项卡“IP 地址”并将 TCP 动态端口设置为 .

出于某种原因，“0”表示“是的，使用动态端口”并且（即在字段中没有条目）意味着“不，我将自己指定”

然后用 1433 填写字段 TCP 端口。

对列出的所有适配器执行此操作，然后重新启动 SQL 服务。

您现在可以通过执行以下操作来检查服务是否确实在正确的端口上

开始->运行->cmd.exe

C:>netstat -ano

寻找这样的条目

```
 local address         <stuff>           PID
 0.0.0.0:1433                            <some number> 
```

现在做 C:>tasklist

并使用上面的数字查找任务。此任务应称为 sqlsrvr.exe 之类的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-16T08:28:03.650

检查 ASP.NET 机器上“SQL 配置管理器”中的“SQL Native Client 配置”设置。默认连接设置在那里设置。还可以尝试弄乱 MDAC 配置：

[http://msdn.microsoft.com/en-us/library/ms131035.aspx](http://msdn.microsoft.com/en-us/library/ms131035.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T08:27:42.873

也许您的 SQL Server 配置为多协议，并且它尝试首先使用其他协议并且失败，可能是出于某种安全原因（应用程序在 IIS 中运行的帐户）。只是一个猜测。

# c# - 无法使正则表达式与多行一起正常工作

> ID：289440
> 
> 赞同：18
> 
> 时间：2008-11-14T07:39:49.723
> 
> 标签：c#, regex, multiline

我有一个应用程序的相当大的 XML 输出。我需要用我的程序对其进行处理，然后将其反馈给原始程序。此 XML 中有几部分需要填写我们替换。有趣的部分如下所示：

```
<sys:customtag sys:sid="1" sys:type="Processtart" />
    <sys:tag>value</sys:tag>
    here are some other tags
    <sys:tag>value</sys.tag>
<sys:customtag sys:sid="1" sys:type="Procesend" /> 
```

并且该文件包含几个这样的部分。

我需要获取这些标签中的所有 XML 片段才能对其进行修改。我写了一个正则表达式来获取这些部分，但它不起作用：

```
XmlDocument xmlDoc = new XmlDocument();
xmlDoc.Load(@"output.xml");
Regex regExp = new Regex(@"<sys:customtag(.*?)Processtart(.*?)/>(.*?)<sys:customtag (.*?)Procesend(.*?)/>", RegexOptions.Multiline & RegexOptions.IgnorePatternWhitespace & RegexOptions.CultureInvariant);
MatchCollection matches = regExp.Matches(xmlDoc.InnerXml); 
```

如果我将所有内容放在一行中并在没有多行选项的情况下调用此正则表达式，它确实会找到每一个出现。通过保持文件原样并设置多行选项，它不起作用。有什么问题，我应该改变什么？或者有没有更简单的方法可以在没有正则表达式的情况下获取这些标签之间的 XML 部分？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-11-14T07:48:13.343

我相信使用的选项是`RegexOptions.Singleline`代替`RegexOptions.Multiline`（[src](http://www.regular-expressions.info/dot.html)）。允许 (.) 匹配换行符应该适用于您的情况。

> ...点也匹配换行符的模式称为“单行模式”。这有点不幸，因为很容易将这个术语与“多线模式”混淆。多行模式只影响锚点，单行模式只影响点...当使用.NET框架的正则表达式类时，通过指定RegexOptions.Singleline来激活该模式，例如在Regex.Match("string ", "正则表达式", RegexOptions.Singleline)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-14T12:51:26.460

正则表达式字符“。” `MultiLine`即使设置了选项，也从不匹配换行符。相反，您应该使用`[\s\S]`或其他组合来匹配任何东西。

该`MultiLine`选项仅修改 ^ (begin-of-line instead fo begin-of-string) 和 $ (end-of-line instead of end-of-string) 的行为

顺便说一句：确实，正则表达式不是扫描 HTML 的正确方法......

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-14T07:48:45.930

RegExp 对 xml 来说是一个糟糕的工具......你能不能把它加载到 XDocument / XmlDocument 中并使用 xpath？如果你澄清你想要做的修改，我希望我们可以填补空白......在这种情况下，命名空间可能是让它变得复杂的主要因素，所以我们只需要使用一个`XmlNamespaceManager`.

这是一个示例，当然，它比正则表达式更复杂 - 但是，我希望它能够更好地处理 xml 的细微差别：

```
 string xml = @"<foo xmlns:sys=""foobar""><bar/><bar><sys:customtag sys:sid=""1"" sys:type=""Processtart"" />
<sys:tag>value</sys:tag>
here are some other tags
<sys:tag>value</sys:tag>
<sys:customtag sys:sid=""1"" sys:type=""Procesend"" /></bar><bar/></foo>";

    XmlDocument doc = new XmlDocument();
    doc.LoadXml(xml);
    XmlNamespaceManager mgr = new XmlNamespaceManager(new NameTable());
    mgr.AddNamespace("sys", "foobar");
    var matches = doc.SelectNodes("//sys:customtag[@sys:type='Processtart']", mgr);
    foreach (XmlElement start in matches)
    {
        XmlElement end = (XmlElement) start.SelectSingleNode("following-sibling::sys:customtag[@sys:type='Procesend'][1]",mgr);
        XmlNode node = start.NextSibling;
        while (node != null && node != end)
        {
            Console.WriteLine(node.OuterXml);

            node = node.NextSibling;
        }
    } 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-02T19:18:34.940

如果您对此仍有问题，可能是因为您使用的是与 RegexOptions 而不是 OR 的 AND。

此代码是错误的，会将零作为第二个参数传递给构造函数：

```
Regex regExp = new Regex(@"<sys:customtag(.*?)Processtart(.*?)/>(.*?)<sys:customtag (.*?)Procesend(.*?)/>",
RegexOptions.Multiline & RegexOptions.IgnorePatternWhitespace & RegexOptions.CultureInvariant); 
```

此代码是正确的（就使用多个 RegexOptions 标志而言）：

```
Regex regExp = new Regex(@"<sys:customtag(.*?)Processtart(.*?)/>(.*?)<sys:customtag (.*?)Procesend(.*?)/>",
RegexOptions.Multiline | RegexOptions.IgnorePatternWhitespace | RegexOptions.CultureInvariant); 
```

# ios - 我可以将图像设置为 UINavigationBar 的标题吗？

> ID：289441
> 
> 赞同：67
> 
> 时间：2008-11-14T07:40:12.623
> 
> 标签：ios, cocoa-touch

是否可以将某些图像设置为导航栏的标题？

我认为 NYTimes 应用程序使用了导航栏，并且标题看起来像图像文件（看起来的原因`UINavigationBar`是因为他们使用右键搜索）。

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2008-11-14T07:45:54.157

您可以使用属性，例如`UIImageView`：`UINavigationItem.titleView`

```
self.navigationItem.titleView = myImageView; 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-23T18:38:40.233

我发现大约 35px 高的透明 .png 效果很好。

```
- (void)awakeFromNib {

//put logo image in the navigationBar

UIImageView* img = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"logo.png"]];
self.navigationItem.titleView = img;
[img release];

} 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2016-03-13T06:39:05.353

您可以直接从情节提要中执行此操作（从 Xcode 7 开始）：

1.  在视图控制器的主视图之外创建一个视图。它可以是嵌套视图或只是图像
2.  将导航项添加到您的视图控制器
3.  Ctrl+ 从导航项拖动并放在外部视图上

[![在此处输入图像描述](https://i.stack.imgur.com/QmjOX.png)](https://i.stack.imgur.com/QmjOX.png)

4.选择标题视图

[![在此处输入图像描述](https://i.stack.imgur.com/Xy7Fm.png)](https://i.stack.imgur.com/Xy7Fm.png)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-11-17T15:31:07.603

我为 UINavigationBar 创建了一个自定义类别，如下所示

**UINavigationBar+CustomImage.h**

```
#import <UIKit/UIKit.h>

@interface UINavigationBar (CustomImage)
    - (void) setBackgroundImage:(UIImage*)image;
    - (void) clearBackgroundImage;
    - (void) removeIfImage:(id)sender;
@end 
```

**UINavigationBar+CustomImage.m**

```
#import "UINavigationBar+CustomImage.h"

@implementation UINavigationBar (CustomImage)

- (void) setBackgroundImage:(UIImage*)image {
    if (image == NULL) return;
    UIImageView *imageView = [[UIImageView alloc] initWithImage:image];
    imageView.frame = CGRectMake(110,5,100,30);
    [self addSubview:imageView];
    [imageView release];
}

- (void) clearBackgroundImage {
    NSArray *subviews = [self subviews];
    for (int i=0; i<[subviews count]; i++) {
        if ([[subviews objectAtIndex:i]  isMemberOfClass:[UIImageView class]]) {
        [[subviews objectAtIndex:i] removeFromSuperview];
    }
   }    
}

@end 
```

我从我的 UINavigationController 调用它

```
[[navController navigationBar] performSelectorInBackground:@selector(setBackgroundImage:) withObject:image]; 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-10-01T19:57:55.123

这条线对你有用，我总是用这个

```
[self.navigationController.navigationBar setBackgroundImage:[UIImage imageNamed:@"imageNavBar.png"]  forBarMetrics:UIBarMetricsDefault]; 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-09T15:15:03.687

我修改了 UINavigationBar+CustomImage.m 以使用户仍然可以看到标题。只需使用 insertSubview: atIndex: 而不是 addSubview:

**UINavigationBar+CustomImage.m**

```
#import "UINavigationBar+CustomImage.h"

@implementation UINavigationBar (CustomImage)

- (void) setBackgroundImage:(UIImage*)image {
    if (image == NULL) return;
    UIImageView *imageView = [[UIImageView alloc] initWithImage:image];
    imageView.frame = CGRectMake(0, 0, 320, 44);
    [self insertSubview:imageView atIndex:0];
    [imageView release];
}

- (void) clearBackgroundImage {
    NSArray *subviews = [self subviews];
    for (int i=0; i<[subviews count]; i++) {
        if ([[subviews objectAtIndex:i]  isMemberOfClass:[UIImageView class]]) {
        [[subviews objectAtIndex:i] removeFromSuperview];
    }
   }    
}

@end 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2015-06-17T14:19:37.680

这也很好用

```
[self.navigationController.navigationBar.topItem setTitleView:[[UIImageView alloc]initWithImage:[UIImage imageNamed:@"YourLogo"]]]; 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2016-12-15T16:41:47.440

使用故事板快速完成，并且`@IBDesignable`：

```
@IBDesignable class AttributedNavigationBar: UINavigationBar {

    @IBInspectable var imageTitle: UIImage? = nil {

        didSet {

            guard let imageTitle = imageTitle else {

                topItem?.titleView = nil

                return
            }

            let imageView = UIImageView(image: imageTitle)
            imageView.frame = CGRect(x: 0, y: 0, width: 40, height: 30)
            imageView.contentMode = .scaleAspectFit

            topItem?.titleView = imageView
        }
    }
} 
```

然后在属性检查器中选择一个图像：

[![在此处输入图像描述](https://i.stack.imgur.com/0Zhn0.png)](https://i.stack.imgur.com/0Zhn0.png)

并等待一秒钟的结果：

[![在此处输入图像描述](https://i.stack.imgur.com/xwyhV.png)](https://i.stack.imgur.com/xwyhV.png)

所以设置视图就在它应该在的地方......在故事板中。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-06-20T14:29:54.937

对于那些有相同错误但 in`Xamarin Forms`的人，解决方案是创建一个`Renderer`in`iOS`应用程序并像这样设置图像：

```
[assembly: Xamarin.Forms.ExportRenderer(typeof(Xamarin.Forms.Page), typeof(MyApp.Renderers.NavigationPageRenderer))]
namespace MyApp.Renderers
{
    #region using

    using UIKit;
    using Xamarin.Forms.Platform.iOS;

    #endregion

    public class NavigationPageRenderer : PageRenderer
    {
        public override void ViewDidLoad()
        {
            base.ViewDidLoad();
            SetTitleImage();
        }

        private void SetTitleImage()
        {
            UIImage logoImage = UIImage.FromFile(ResourceFiles.ImageResources.LogoImageName);
            UIImageView logoImageView = new UIImageView(logoImage);

            if (this.NavigationController != null)
            {
                this.NavigationController.NavigationBar.TopItem.TitleView = logoImageView;
            }
        }
    }
} 
```

希望它可以帮助某人！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-02-25T13:05:41.383

只需使用

```
[navController.navigationBar insertSubview:myImage atIndex:0] ; 
```

其中 myImage 属于 UIImageView 类型，而 navController 属于 UINavigationController 类型

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-11-03T08:43:26.880

我修改了 UINavigationBar+CustomImage 代码以正常工作而不会泄漏内存。

```
- (void)setBackgroundImage:(UIImage *)image
{
    if (! image) return;
    UIImageView *imageView = [[UIImageView alloc] initWithImage:image];
    imageView.frame = CGRectMake(0, 0, self.frame.size.width, self.frame.size.height);
    [self addSubview:imageView];
    [imageView release];
}

- (void) clearBackgroundImage
{
    // This runs on a separate thread, so give it it's own pool
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
    NSArray *mySubviews = self.subviews;

    // Move in reverse direction as not to upset the order of elements in the array
    for (int i = [mySubviews count] - 1; i >= 0; i--)
    {
        if ([[mySubviews objectAtIndex:i] isMemberOfClass:[UIImageView class]])
        {
            [[mySubviews objectAtIndex:i] removeFromSuperview];
        }
    }

    [pool release];
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-09-12T02:56:07.297

以下是使用 C#.NET 在（Xamarin 的）MonoTouch 中执行此操作的方法

在 NavigationController 中创建一个 UIViewConvrtoller，然后随时调用它：

```
someNiceViewControllerYouMade.NavigationController.NavigationBar
     .InsertSubview(new UIImageView
     (MediaProvider.GetImage(ImageGeneral.navBar_667x44)),0); 
```

注意：MediaProvider 只是一个获取图像的类。

此示例允许视图填充完整的 Navigation Bar ，并让项目标题的文本也出现。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-11-16T10:40:11.520

如果您在导航来回导航时按钮消失，这为我修复了它：

```
NSArray *mySubviews = navigationBar.subviews;
UIImageView *iv = nil;

// Move in reverse direction as not to upset the order of elements in the array
for (int i = [mySubviews count] - 1; i >= 0; i--)
{
    if ([[mySubviews objectAtIndex:i] isMemberOfClass:[UIImageView class]])
    {
        NSLog(@"found background at index %d",i);
        iv = [mySubviews objectAtIndex:i];
        [[mySubviews objectAtIndex:i] removeFromSuperview];
        [navigationBar insertSubview:iv atIndex:0];
    }
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-08-22T04:07:32.230

ios5.0 引入了一大堆功能来自定义标准元素的外观。如果您不想使用 ImageView 作为标题，另一种方法是使用背景图像和自定义字体/颜色自定义所有 UINavbars 的外观。

```
- (void) customiseMyNav
{
    // Create resizable images
    UIImage *portraitImage = [[UIImage imageNamed:@"nav_bar_bg_portrait"] 
        resizableImageWithCapInsets:UIEdgeInsetsMake(0, 0, 0, 0)];
    UIImage *landscapeImage = [[UIImage imageNamed:@"nav_bar_bg_landscape"] 
        resizableImageWithCapInsets:UIEdgeInsetsMake(0, 0, 0, 0)];

    // Set the background image
    [[UINavigationBar appearance]  setBackgroundImage:portraitImage forBarMetrics:UIBarMetricsDefault];
    [[UINavigationBar appearance]  setBackgroundImage:landscapeImage forBarMetrics:UIBarMetricsLandscapePhone];

    // set the title appearance
    [[UINavigationBar appearance] setTitleTextAttributes:
        [NSDictionary dictionaryWithObjectsAndKeys:
            [UIColor colorWithRed:50.0/255.0 green:150.0/255.0 blue:100/255.0 alpha:1.0], 
            UITextAttributeTextColor, 
            [UIColor colorWithRed:0.0 green:0.0 blue:0.0 alpha:0.6], 
            UITextAttributeTextShadowColor, 
            [NSValue valueWithUIOffset:UIOffsetMake(0, -1)], 
            UITextAttributeTextShadowOffset, 
            [UIFont fontWithName:@"Arial-Bold" size:0.0], 
            UITextAttributeFont, 
            nil]];
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-09-10T21:22:38.820

在 MonoTouch 中，您可以使用：

```
 this.NavigationItem.TitleView = myImageView; 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-08-19T11:10:32.440

使用 SWIFT将图像添加到 naviagtionBar，该**SWIFT**可以缩放以适应并剪辑到边界。您可以在视图控制器 viewDidLoad() 函数中调用此函数。

```
func setupNavigationBarWithTitleImage(titleImage: UIImage) {

    let imageView = UIImageView(image: titleImage)
    imageView.contentMode = .ScaleAspectFit
    imageView.clipsToBounds = true
    navigationItem.titleView = imageView

} 
```

# asp.net - ASP.Net 中的 SVN 报告

> ID：289443
> 
> 赞同：1
> 
> 时间：2008-11-14T07:43:14.413
> 
> 标签：asp.net, visualsvn, visualsvn-server

我们有一个内置 ASP,net 3.5 的自定义项目管理工具，我们使用 VisualSVN 进行版本管理。然而，我们正在寻找一种通过项目管理工具报告版本更改的方法，将 VisualSVN 与我们的项目管理工具集成，即非常类似于 Trac [基于 python 的 SCM 工具] 提供的。

基本上是在寻找一个简单的 VisualSVN 客户端 API，以便能够根据提供的修订集检测和报告文件更改。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T08:55:19.680

还有[SharpSvn](http://sharpsvn.open.collab.net/)封装了整个 Subversion 1.5 客户端 API。它是在 Apache 2.0 许可下获得许可的，它来自 CollabNet。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T07:56:39.753

检查[Svn.NET](http://www.pumacode.org/projects/svndotnet/)我认为是目前 Subversion 客户端系统库的 .NET 绑定的最佳解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T23:40:20.367

如果您对某些脚本感到满意，可以使用 svnlook，它是提供更改和存储库修改报告的工具。

我在提交后挂钩中使用它来将所有文件的更改发送到我的 bugtracker，因此它可以显示哪些文件在给定修订号的情况下被更改。我在日志中添加了一个特定的文本，它会选择它以了解将数据与哪个错误相关联。

编辑，根据要求，这个 perl 脚本是从 post-commit 钩子调用的：

```
$url = `svnlook log -r $ARGV[1] $ARGV[0]`;

# check the string contains the matching regexp, 
# quit if it doesn't so we don't waste time contacting the webserver
# this is the g_source_control_regexp value in mantis.

exit 1 if not $url =~ /\b(?:bug|issue|mantis)\s*[#]{0,1}(\d+)\b/i;

$url = $url . "---\nSVN Revision: " . $ARGV[1];
$url = $url . "\n" . `svnlook dirs-changed -r $ARGV[1] $ARGV[0]`;

#urlencode the string
$url =~ s/([^\w\-\.\@])/$1 eq " "?"+":  sprintf("%%%2.2x",ord($1))/eg;

print "log=$url";

exit 0; 
```

这将写入 postcommit_mantis.txt 文件，该文件通过 curl 发送到 Mantis：

```
d:\tools\curl -s -d user=svn -d @c:\temp\postcommit_mantis.txt http://<server>/mantis/core/checkincurl.php 
```

# c# - 解析IP失败

> ID：289452
> 
> 赞同：2
> 
> 时间：2008-11-14T07:48:24.807
> 
> 标签：c#, .net, networking, dns

尽我所能，我无法将地址解析为 IP。代码片段如下所示。我不断收到 No such host is known 异常，即使我可以用我的浏览器访问谷歌（DNS 服务器几乎肯定在工作）。然而，我在公司的防火墙后面。

```
try
{
   foreach (IPAddress address in Dns.GetHostAddresses("www.google.com"))
   {
      Console.WriteLine(address.ToString());
   }
}
catch (SocketException e)
{
   Console.WriteLine("Source : " + e.Source); // System
   Console.WriteLine("Message : " + e.Message); // No such host is known
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T07:54:02.097

您的代码没有任何问题。鉴于您可以从 Web 浏览器访问 www.google.com，下一个最可能的问题是 Web 浏览器正在使用代理服务器。网络浏览器实际上是通过允许通过防火墙的代理服务器访问 www.google.com。您编写的简单应用程序不允许通过防火墙并导致异常。

您可以通过查看 Internet Explorer 中的代理设置来验证这一点。

工具 -> 选项 -> 连接 -> 局域网设置

会有一个代理服务器组设置。如果存在值，则几乎可以肯定这是您的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T09:02:04.333

您需要设置代理：

这是一个应该为以下所有调用设置它的片段：

```
 protected void SetupProxy(string proxyUrl, string proxyLogin, string proxyPassword, string[] proxyBypass)
    {
        WebProxy proxy = new WebProxy(proxyUrl);
        proxy.Credentials = new NetworkCredential(proxyLogin, proxyPassword);
        proxy.BypassList = proxyBypass;
        proxy.BypassProxyOnLocal = true;
        WebRequest.DefaultWebProxy = proxy;
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T08:47:48.137

与其尝试通过浏览器，不如尝试从命令行 ping www.google.com（当然也可以是其他主机）。

ping 本身可能不起作用，但它应该首先显示 IP 地址解析。如果您收到这样的错误消息：

```
    Ping 请求找不到主机 www.google.com。
    请检查名称并重试。
```

那么很可能代理服务器在您浏览时正在为您进行 DNS 查找，并且您的 DNS 服务器无法正常工作或您的机器的网络设置不正确。

# visual-studio - Visual Studio 代码格式

> ID：289456
> 
> 赞同：12
> 
> 时间：2008-11-14T07:51:40.417
> 
> 标签：visual-studio, code-formatting

一段时间以来，我一直在使用 Visual Studio 作为我的主要 IDE（不过，我仍然将 Emacs 用于一些个人项目）。

我喜欢 Emacs 格式化 C/C++ 代码的方式，我想说服 Visual Studio 对 C# 代码使用类似的约定。例如，在 Emacs 中，一个 C 函数调用如下所示：

```
functionName(argument1,
             argument2,
             argument3); 
```

而在 Visual Studio 格式化的 C# 代码中，函数调用如下所示：

```
functionName(argument1,
    argument2,
    argument3); 
```

这对我来说似乎更糟。

有没有办法调整 Visual Studio 代码格式规则？有什么插件可以处理吗？

非常感谢，

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-14T07:53:36.997

工具 > 选项 > 文本编辑器 > C# > 格式化

和

[http://www.jetbrains.com/resharper/features/code_formatting.html#Code_Formatting](http://www.jetbrains.com/resharper/features/code_formatting.html#Code_Formatting)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-14T09:23:16.223

Resharper（上图）很好。CodeRush 现在从 DevExpress 中免费。多年来我一直很喜欢使用他们的产品。

[http://www.devexpress.com/Products/Visual_Studio_Add-in/CodeRushX/](http://www.devexpress.com/Products/Visual_Studio_Add-in/CodeRushX/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-17T21:34:26.603

另请参阅此扩展程序，它将在每次保存文件时自动执行该过程：[https ://visualstudiogallery.msdn.microsoft.com/3ea1c920-69c4-441f-9979-ccc2752dac56](https://visualstudiogallery.msdn.microsoft.com/3ea1c920-69c4-441f-9979-ccc2752dac56)

# debugging - 如何跟踪 COM/ActiveX 依赖项？

> ID：289466
> 
> 赞同：2
> 
> 时间：2008-11-14T08:01:05.437
> 
> 标签：debugging, activex, dependencies

是否有任何“外面”的东西，类似于 Dependency Walker，它遍历并报告 ActiveX/COM 对象的依赖关系？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-14T08:15:17.843

您可以尝试两个有用的工具：

[依靠](http://www.dependencywalker.com/)

[进程浏览器](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)

# html - 从 HTML 文档中抓取最大的文本块

> ID：289468
> 
> 赞同：4
> 
> 时间：2008-11-14T08:04:32.933
> 
> 标签：html, screen-scraping, text-extraction, html-content-extraction

我正在研究一种算法，该算法将在给定 HTML 文件的情况下尝试挑选出它认为最有可能包含页面大部分内容文本的父元素。例如，它将选择以下 HTML 中的 div“内容”：

```
<html>
   <body>
      <div id="header">This is the header we don't care about</div>
      <div id="content">This is the <b>Main Page</b> content.  it is the
      longest block of text in this document and should be chosen as
      most likely being the important page content.</div>
   </body>
</html> 
```

我想出了一些想法，比如遍历 HTML 文档树到它的叶子，将文本的长度相加，并且只有在父级给我们的内容比子级多的情况下才能查看父级的其他文本。

有没有人尝试过这样的事情，或者知道可以应用的算法？它不必是可靠的，但只要它能够猜出包含大部分页面内容文本的容器（例如，对于文章或博客文章），那就太棒了。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-12-29T22:39:51.740

一个词：[锅炉管](http://code.google.com/p/boilerpipe/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-14T14:00:55.057

这大致是我将如何处理这个问题：

```
// get array of all elements (body is used as parent here but you could use whatever)
var elms = document.body.getElementsByTagName('*');
var nodes = Array.prototype.slice.call( elms, 0 );

// get inline elements out of the way (incomplete list)
nodes = nodes.filter(function (elm) {
  return !/^(a|br?|hr|code|i(ns|mg)?|u|del|em|s(trong|pan))$/i.test( elm.nodeName );
});

// sort elements by most text first
nodes.sort(function(a,b){
  if (a.textContent.length == b.textContent.length) return 0;
  if (a.textContent.length > b.textContent.length)  return -1;
  return 1;
}); 
```

使用 ancestry 函数`a.compareDocumentPosition(b)`，您还可以在排序期间（或之后）下沉元素，具体取决于这件事需要多么复杂。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T08:18:28.710

您还必须制定要在其上选择节点的级别。在您的示例中，“body”节点中的文本数量甚至更多。所以你必须明确什么是“父元素”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T08:13:04.073

您可以创建一个应用程序来查找不考虑格式标记的连续文本块（如果需要）。您可以通过使用 DOM 解析器并遍历树来执行此操作，跟踪直接父级（因为那是您的输出）。

从父节点开始并遍历每个正在格式化的节点的树，它将继续该子块内的“计数”。它将计算内容的字符。

找到内容最多的块后，将树向上遍历到其父级以获取答案。

我认为您的解决方案取决于您如何遍历 DOM 并跟踪您正在扫描的节点。

您使用什么语言？您的项目还有其他详细信息吗？您也可以使用特定于语言或特定于包的工具。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-05-03T11:41:59.440

我也可以说词库是一个很大的帮助。任何常见的“广告”单词列表，例如 twitter 和 click 以及连续的几个大写名词。拥有一个词性标注器可以提高准确性。对于新闻网站，世界上所有已知主要城市的列表可以帮助区分。事实上，你几乎可以不看 HTML 就抓取一个页面。

# asp.net - ASP.NET 逻辑/连接池和错误处理

> ID：289472
> 
> 赞同：0
> 
> 时间：2008-11-14T08:10:08.400
> 
> 标签：asp.net, error-handling, logic

我刚刚上传了我的第一个 ASP.NET（作为我学习 vb.net 的一部分），并且在连接池中陷入了严重的混乱（当您的网站有超过 1 个用户时会发生有趣的事情），现在所有这些都被更好地使用了try catch 语句的一部分（这个想法是要学习的）但是我想知道这是否是最好的/最终的方法，现在如果尝试失败，那么页面上的很多细节都没有放置/更新，所以如果您正在做一些数据库工作并且尝试失败，您是否重新加载页面...重定向到自我并希望它下次工作...或者只是通知用户有错误，他们应该再试一次？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-14T08:16:02.880

我永远不会自动重定向并希望它下次能正常工作（你可能会陷入无限循环）。

通知用户和可选的链接以再次尝试。

您甚至可能想分析您的异常，看看是否再次尝试会有所帮助。有些异常确实是错误，再试一次也无济于事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-16T08:22:15.753

如果发生意外错误，请将用户重定向到错误页面，因为它可能会在下一次发生。

您是否查看过数据库连接和读取器的“使用”语句？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-16T08:28:34.680

`using`对于所有实现的对象`IDisposable`（例如连接和读取器），您应该明确使用“ ”语句。'using' 语句在幕后被转换为 try-finally 块，并确保即使发生错误也调用 Dispose()。

这是一个代码片段示例：

```
using (SqlConnection conn = new SqlConnection(this.connectionString))
{
    using (SqlCommand cmd = conn.CreateCommand())
    {
        cmd.CommandText = "LoadFromRepository";
        cmd.CommandType = CommandType.StoredProcedure;
        cmd.Parameters.AddWithValue("@ID", fileID);

        conn.Open();
        using (SqlDataReader rdr =
                   cmd.ExecuteReader(CommandBehavior.CloseConnection))
        {
            while (rdr.Read())
            {
                // do something with read data
            }
        }
    }
} 
```

# php - 如何进行页面控制？

> ID：289475
> 
> 赞同：0
> 
> 时间：2008-11-14T08:12:46.367
> 
> 标签：php, mysql, pagination

我的意思是获取有关页面项目数量的信息并使用您需要的 LIMIT 进行 sql 查询的最有效方法是什么。或者我应该获取所有项目，然后使用 php 函数裁剪数组？

现在我做 2 个查询：首先计算所有项目，然后使用 LIMIT 获取我需要的项目。

好的，我会更具体。例如，我需要在我的页面上显示一个问题和这个问题的 20 个答案。在底部应该有页面控制：链接到下一个，上一个页面等等。我想显示正确数量的链接（答案数/20），当我转到任何链接时，我想收到正确的答案（例如 3d 页面上的 41 到 60）。那么获取项目数量（答案）以显示正确数量的链接并为每个链接获得正确答案的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T09:46:05.273

我猜你想说你想知道查询中有多少项目/答案，但一次最多只能阅读 20 个项目，用于分页。

首先：你真的应该找一个分页包；很多很多人之前都遇到过同样的问题，并且您的编程语言和框架可能同时存在免费/开源和专有解决方案。（如果您说出您使用的语言，我相信有人可以为您推荐解决方案。）

无论如何，我知道*我*想知道事情是如何运作的，所以通常是这样的：

据我所知，分页代码通过使用`select count(*) from tblX where something`将此数字除以每页项目数并使用上限（例如 4.1 => 5）进行一次查询来计算页面。

为了列出每页的结果，需要一个*新*的查询；*不要*担心计数查询比让每个结果丢弃你不需要的结果要快得多不要这样做（这是成为[本页](http://thedailywtf.com/)头条新闻的秘诀）。其中 Y 是每页`select * from tblX where something limit Y offset Z`的项目数，Z 是`(requested_page - 1)*Y`; 第 1 页的偏移量为 0，第 2 页的偏移量为 20（如果那是 Y）等等。

但是不要试图手动实现它，它是不必要的、乏味的并且容易出错，最好花时间定制一个现成的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T08:24:23.037

我假设您想要计算要阅读的行数以便进行分页或类似操作？在您的问题中，我不明白您对 LIMIT 的需求。但是，如果您只想计算找到的行数，请使用以下方法之一。

您选择所有行的计数，例如：

```
select count(*) as counted, name, address
from contact 
```

或找到行：

```
SELECT SQL_CALC_FOUND_ROWS, name, address
from contact 
```

这可能是mysql特定的，我不确定。

更新：

对于分页，您可以执行以下操作 - (Psuedocode)

$rows = array($result)
$num_rows = sql_calc_found_rows
$per_page = 20
$pages = ceil($num_rows / $per_page)

**页**
$rows_this_page = array()
$rows_this_page = get_values($rows, (min index)$page_number * $per_page - $per_page, (max index)$page_number * $per_page - 1)

# visual-studio - T4 在 Visual Studio 2008 中不起作用

> ID：289483
> 
> 赞同：1
> 
> 时间：2008-11-14T08:18:01.830
> 
> 标签：visual-studio, t4

我有两台机器设置为运行 Visual Studio 2008 (SP1) 和 NET Framework 3.5 (SP1)。如果我在 1 号机器上的控制台应用程序中创建 .tt 文件，它会自动为我创建子 .cs 文件，但是如果我在 2 号机器上执行完全相同的操作，则不会创建子 .cs 文件。

我尝试切换“显示所有文件”选项，重新启动 Visual Studio（多次），添加新`.tt`文件（结果相同），在 C# 和 VB.NET 项目中尝试过，谷歌正在绘制空白。

T4 文本模板是否可能以某种方式被禁用？如果是这样，那么我到底该如何重新打开它们，这很烦人:-)。？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T12:22:29.953

我相信没有为 Visual Studio 2008 的 Express 版本安装 T4。两台机器是否运行相同的版本？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T08:20:04.900

检查机器 2 上的文件属性 CustomTool 是否为 TextTemplateFileGenerator。

如果此属性为空，则不会运行任何工具来生成 cs 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T08:32:36.187

该属性在机器 2 上为空白，手动输入并保存它也不会触发 cs 文件的生成。好像这个工具在第二台机器上不能正常工作？

目前我无法访问机器 1（它们在我的家和办公室之间分配）所以我无法比较东西 =（

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-21T20:40:13.697

我无法让它在常规网站项目中工作。当我添加一个库项目并将我的模板目录移到那里时，生成会自动开始，我的右键单击也有“运行自定义工具”。无论如何，我认为这是一个更整洁的分离。

# asp.net - 切换到 IIS7 后使用匿名登录连接到 SQL

> ID：289493
> 
> 赞同：0
> 
> 时间：2008-11-14T08:22:23.570
> 
> 标签：asp.net, iis, iis-7

我最近将我的 PC 升级到了 Vista，这意味着它包含 IIS7。问题是我们正在开发的 ASP.NET 网站不再工作了。我收到一个错误，因为应用程序尝试使用 NT AUTHORITY/ANONYMOUS LOGON 而不是我的域用户连接到 SQL Server，并且未授权匿名。我尝试了几件事，但还没有解决方案： - 安装并启用“IIS 元数据库和 IIS 6 配置兼容性” - 为该网站启用 Windows 身份验证 - 创建了一个不同的应用程序池，托管管道模式设置为经典 - 启用 IIS6 WMI兼容性和 IIS6 管理控制台（在这里变得绝望）

在我们的 web.config 中有，在我们的 machine.config 中有 . 我尝试将 impersonate 设置为 false 并在 machine.config 中输入我的域用户和密码（以前是这样的），但这也无济于事。

有什么我想念的吗？有没有其他人有类似的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-15T05:21:22.967

您的应用程序如何通过 SQL Server 进行身份验证？它使用 SQL 还是 Windows 身份验证？我希望您正在尝试使用 Windows 身份验证。在这种情况下，您的 IIS 工作进程应该在该 Windows 用户帐户下运行。如果不是，它至少应该模拟一个对 SQL Server 具有必要访问权限的 Windows 用户帐户。如果您启用了模拟，并且您使用了正确的 Windows 用户帐户，并且如果 SQL Server 使用 Windows auth 进行身份验证，并且您仍然无法访问 SQL Server，则您可能遇到了经典的双跳问题。换句话说，您尝试对 IIS 进行一次身份验证，然后使用相同的凭据通过网络（这是您的第二个跃点）对 SQL Server 进行身份验证，出于安全原因，Windows 不允许这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T12:13:57.140

我相信我已经找到了一个/解决方案。至少它现在正在工作。这就是我所做的：

*   该网站现在在单独的应用程序池中运行，托管管道模式设置为经典，加载用户配置文件设置为 False，身份设置为自定义，并使用有权访问数据库的域用户（和密码）。
*   在网站本身的“授权”下，我将匿名设置为启用，并将 ASP.NET 模拟设置为禁用。
*   在网站的 web.config 中也设置了。

应得的信用，[这个网站](http://weblogs.asp.net/nannettethacker/archive/2008/11/14/membership-provider-connections-to-remote-database.aspx)帮助了我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-18T08:13:28.360

很抱歉，我无法进一步调查这个问题。实际上，这可能与我们连接到 SQL Server (Win Auth) 的方式有关，因为我们现在已经改变了它。现在我们用连接字符串中的用户名和密码进行连接，它就解决了。所以我真的不能说你是否提供了答案，msvcyc，但我确实对你的解决方案进行了投票。感谢您的时间和麻烦。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-23T11:30:37.197

好吧，如果没有太多麻烦来享受它带来的创新，我建议你迁移到集成模式。:)

[http://mvolo.com/blogs/serverside/archive/2007/12/08/IIS-7.0-Breaking-Changes-ASP.NET-2.0-applications-Integrated-mode.aspx](http://mvolo.com/blogs/serverside/archive/2007/12/08/IIS-7.0-Breaking-Changes-ASP.NET-2.0-applications-Integrated-mode.aspx)

# sql-server - 流和 Linq Blob

> ID：289496
> 
> 赞同：4
> 
> 时间：2008-11-14T08:24:08.653
> 
> 标签：sql-server, linq, linq-to-sql, blob

我有一个用于将文档元数据存储到表中的对象。文档的正文可能非常大，有时 > 2GB，因此我会将其存储到 SQL 2008 中的 nvarchar(max) 字段中。稍后我将使用 SQL 2008 来索引该字段。我不会使用文件流，因为它们对数据库非常严格，并且会阻止某些类型的并发锁定方案。

该对象通过 LinqToSQL 公开给开发人员。我担心该字段会太大，如果文本> 1.5 GB，我已经看到.Net 爆炸并出现OutOfMemory 异常。

所以我想知道，我可以将这个 blob 视为带有 Linq 的流吗？或者如果我想使用 blob，我是否必须完全绕过 Linq？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T08:43:35.320

鉴于[“LINQ 查询可以检索 BLOB [...]”](https://stackoverflow.com/questions/53873/can-a-linq-query-retrieve-blobs-from-a-sql-database)的答案，我*怀疑*您不走运。[System.Data.Linq.Binary](http://msdn.microsoft.com/en-us/library/system.data.linq.binary.aspx)类型没有任何流式传输机制——基本上它只是一个不可变的字节数组表示。

您可能会调用一些深层的 LINQ mojo，但我怀疑它确实必须非常深。

实体框架可能会处理它 - 我还没有调查过。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-08T03:03:36.650

我最终围绕 linqtoSql 编写了自己的方法，使用 SQL 中的 varchar(max) 对象可用的 write 方法。这允许开发人员将大数据类型的插入分块到数据库中。

# windows - Windows启动时在后台运行批处理文件

> ID：289498
> 
> 赞同：24
> 
> 时间：2008-11-14T08:25:56.887
> 
> 标签：windows, batch-file, startup, tracd

每次Windows启动时如何运行批处理文件，我还需要在后台运行它（不显示该命令窗口）？我使用的是 Windows XP。我的实际要求是我想在 Windows 启动时使用命令行命令启动 Tracd 服务器。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-11-14T08:29:22.900

[在注册表](http://www.bleepingcomputer.com/tutorials/tutorial44.html)中添加您的程序：

运行 - 这些是安装自动启动的程序最常见的启动位置。默认情况下，这些键不在安全模式下执行。如果您在这些键的值前面加上星号，* 将在安全模式下运行。注册表项：

```
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run registry key
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run registry key 
```

[然后您可以在不可见模式下](http://www.computing.net/answers/dos/run-batch-file-invisiblestealth/14270.html)启动您的批次：

```
wscript.exe "C:\yourpath\invis.vbs" "your_file.bat" 
```

在 invis.vbs 中...

```
CreateObject("Wscript.Shell").Run """" & WScript.Arguments(0) & """", 0, False 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-14T09:27:42.347

另外两个启动可能性：

*   您可以随时将 bat 文件添加到启动文件夹中，
*   或将其作为计划任务设置启动以在登录时运行。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-14T08:31:44.953

您可以使应用程序作为服务运行。

查看[这篇文章](http://support.microsoft.com/kb/137890)了解详情：

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-14T08:34:20.207

您可以为此使用[autoexnt](http://support.microsoft.com/kb/243486)。它最初是为 Windows NT 设计的，但仍在更新版本的 Windows 中工作。

您必须[下载 Windows 2003 Resource Kit](http://www.microsoft.com/downloads/details.aspx?familyid=9d467a69-57ff-4ae7-96ee-b18c4790cffd&displaylang=en)才能获得它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-07-10T07:19:03.643

还有[hstart](http://www.ntwind.com/software/utilities/hstart.html)，一个非常适合我的需要的第三方程序。它也被维护了。最后一个版本于 2010 年 7 月 7 日发布。

# jobs - 你有没有在面试中得到意想不到的答案？

> ID：289502
> 
> 赞同：9
> 
> 时间：2008-11-14T08:30:17.703
> 
> 标签：jobs

在面试编程职位时，你有没有得到你没想到的问题的答案？答案可能非常聪明，您甚至都不知道，或者它可能是您从未预料到的最愚蠢的答案。我期待技术类型的问题，但任何有趣的都可以。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-11-14T08:57:42.767

问：“你有什么弱点吗？”

答：“氪石”

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-14T09:04:58.210

一个轻松的...

在面试快结束时，我认为候选人提出了合理的问题，表现出兴趣和良好的一般融洽，我问了一个结束问题，因为我想知道是否继续，“所以你觉得怎么样，你会对这个职位感兴趣吗？”。

他回答说：“我认为这是我听说过的最无聊的工作，我不可能来为*你*工作，我认为你的整个公司都很蹩脚”（该公司是一家纳斯达克上市的软件公司，翻身亿美元）。我看着我的合作面试官，他是一位经验丰富的开发经理，为我工作。他笑了，我们带他出去。

在近 20 年的采访中，这是我得到的最令人惊讶的回应。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-14T20:28:58.017

我们正在寻找一个应用程序程序员。在白板上贴上一些伪代码后，我问候选人一个关于它的问题。他的回答是“这是某种编程的东西吗？”

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-14T20:19:45.930

作为一名面试官，我从来没有大吃一惊，但作为一名候选人，我对一家不允许我提问的公司感到震惊和震惊...... WTF？我很快就离开了。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-05T23:03:24.887

不是一个真正的答案，也是一个早已死去的问题，但无论如何......我曾经是几个面试候选人的人之一。这对他来说并不顺利，但也不是一场彻底的灾难。采访过程中，他的手机突然响了起来。

在这一点上，我有点为他感到难过——他显然很紧张，现在忘记关掉他的铃声了。

我没想到会发生的是他接听电话，说了几分钟。用外语。我和我的同事难以置信地看着对方。

电话打完，他干脆挂断了电话，继续采访，就好像什么事都没发生过一样。

他没有得到这份工作。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-14T08:54:47.170

没有任何问题，但有人告诉我，在他向我提供有关该公司的信息后，我必须举行一次有关该公司的演讲。让我真正关注他告诉我的关于工作和组织的内容（我得到了这份工作）。

我也进行了很多采访并聘请了我的几个同事，我为这个问题写了一些东西：

[https://stackoverflow.com/questions/194543/for-interviews-how-do-you-gauge-whether-the-candidate-would-be-a-good-coworker#285594](https://stackoverflow.com/questions/194543/for-interviews-how-do-you-gauge-whether-the-candidate-would-be-a-good-coworker#285594)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-14T20:21:28.970

我记得有一次我在微软面试，经理告诉我，他与我在是否雇用我的问题上犹豫不决。我告诉他，“那就不要雇用我了”，我认为这对他来说可能有点意外。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-14T08:40:15.437

作为一名面试官，我并不经常感到惊讶。大多数人都很尊重和聪明。我只是惊讶于有些人变得如此安静和紧张，或者他们很少尝试回答一些技术问题。

作为一名受访者，我给出了出乎意料的答案。有一次，我在大型跨国公司的早期面试官中给出了答案-他们根本不理解解决方案。经验教训：永远不要给出“不同”或“开箱即用”的答案，除非它是书面的并且接收它的人是该领域的技术人员。否则，他们可能会认为这是不正确的。给出你认为是常态的答案——因为在大多数情况下，早期的面试官只有一个非常短的“可能”答案列表。

更新：我所指的采访是第 4 阶段或第 5 阶段的电话屏幕——所以我想它并不适用。问题是那些涉及“假设你有无限记忆”的问题之一，所以我想出了一些奇怪的“假设”场景。“最佳”答案是使用传统方法更切中要害的答案。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-14T09:24:11.137

面试时，我让某人在白板上画了一些 Java 代码，我很惊讶地看到应聘者写了一些 Python 代码。事实证明，这个人的 Java 技能，容我们说，在简历上被夸大了……

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-05T02:55:33.097

不是我听到的答案，而是我给出的答案。

一位面试官问我是否可以“仅使用 C 编译器”编写面向对象的程序。我对这个奇特的词选择有点好笑，所以我开玩笑地回答说，在 C 中，你可以为面向对象的语言编写一个编译器并这样做。

面试官没有给我机会说我是如何理解结构不是真正的对象，函数并没有真正与它们的数据足够紧密地联系在一起，而且还有很多其他的 OO 特性缺失，所以你不能真的是用 C 语言做的，这可能是他想要的答案。我以为我搞砸了，直到他结束了面试并提供了这个职位。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-05T03:19:12.487

这不仅仅适用于我在下面提到的单个项目。

有一次，我们确实请一位以 C++ 为中心的软件工程职位的申请人谈论 C++ 中的类和对象，但他无法回答。结束这一切的最后一件事是“你有任何 C++ 经验吗？” 回应：“没有。” “你有一个学校课程，你把它列在你的简历上……”

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-16T19:39:15.760

我采访了一个 C++ 工作的人。他的简历上有很多 C++ 流行语，包括“智能指针”。

我写了一个在循环中使用原始指针的小示例程序，该指针从未被释放。有几个 if() 语句里面有 if() 语句，所以东西进出范围很多。

我告诉他这个程序在一段时间内运行良好，但最终它会使我的计算机陷入瘫痪或从操作系统抛出某种错误消息。我请他看看这个，看看你是否能发现问题或提出改进建议。

在看似永远，但实际上是五到十分钟之后，他注意到几个 if 语句会重新分配我的指针，而不会删除它当前指向的东西。他经历并在这些行之前添加了删除语句。到目前为止，一切都很好，如果有点慢。

我问他是否有办法让这段代码更干净、更不危险。我尝试了十多分钟让他说“使用智能指针”，但我就是做不到。有一次我什至说“答案就在你的简历上”。仍然，全脑锁定。

我真的希望在简历上写上“智能指针”的人会使用智能指针。我曾预料我们会讨论 C++ 世界中存在的不同风格的智能点，我没想到他的简历上列出的东西完全是真空的。

在与他交谈后发现，在他目前在国防承包商的职位上，他几乎把所有的时间都花在了开会上，几乎没有写任何代码。

我喜欢这个人，但对从事全职 C++ 工作感觉不太好，所以我们放弃了他。

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2008-11-14T09:01:03.477

对不起，我误读了这个问题。但由于我也完成了采访，所以我可以调整我的答案。

在我工作的地方，我们在每次采访中问的第一个问题是“给我们讲个笑话”。（是的，我知道，从技术上讲，这不是一个“问题”）。这往往会导致一些意想不到的答案，但他们只会亲自娱乐。

# c# - 如何使用 StructureMap 通过代码定义默认构造函数？

> ID：289512
> 
> 赞同：16
> 
> 时间：2008-11-14T08:34:54.027
> 
> 标签：c#, inversion-of-control, structuremap

我不知道如何通过代码为 StructureMap（2.5 版）中的类型定义默认构造函数（当它存在重载时）。

我想获得一个服务实例，并且容器必须向其中注入一个 Linq2Sql 数据上下文实例。

我在我的“引导程序”方法中写了这个：

```
ForRequestedType<MyDataContext>().TheDefault.Is.OfConcreteType<MyDataContext>(); 
```

当我运行我的应用程序时，我收到了这个错误：

> StructureMap 异常代码：202
> 没有为 PluginFamily MyNamespace.Data.SqlRepository.MyDataContext、MyNamespace.Data、Version=1.0.0.0、Culture=neutral、PublicKeyToken=null 定义默认实例

如果我注释掉所有不需要的 Linq2Sql 生成的构造函数，它就可以正常工作。

更新：哦，我忘了说我不会使用该`[StructureMap.DefaultConstructor]`属性。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-11-18T10:35:13.080

您可以使用 ConstructedBy() 指定构造函数。请试试这个：

```
ForRequestedType<MyDataContext>().TheDefault.
Is.ConstructedBy(() => new MyDataContext()); 
```

这对我有用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-03-13T04:11:05.777

如果您使用的是 Linq2Sql，我假设您还需要设置对象生存期 (InstanceScope)。我建议使用此代码，因为它为您提供了更多的灵活性。

```
ForRequestedType< MyDataContext >()
            .CacheBy( InstanceScope.PerRequest )
            .TheDefault.Is.OfConcreteType< MyDataContext >()

SelectConstructor< MyDataContext >( () => new MyDataContext()); 
```

使用此代码，您还可以像这样将接口定义进一步注入 MyDataContext 构造函数

```
SelectConstructor< MyDataContext >( () => new MyDataContext((IDatabaseFactory)null )); 
```

请记住使用 StructureMap 为您的 IDatabaseFactory 实例定义具体类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T09:14:38.393

我不确定如何/是否可以使用流畅的接口/内部 DSL 来完成。但是，如果您不担心*污染您的域*，您可以使用属性吗？

使用 [DefaultConstructor] 标记您的首选构造函数 StructureMap 默认为约定最贪婪的构造函数（具有最多参数的构造函数）。

# javascript - Javascript正则表达式匹配一个人的身高

> ID：289513
> 
> 赞同：2
> 
> 时间：2008-11-14T08:38:42.633
> 
> 标签：javascript, regex

我需要一个 javascript 正则表达式模式来匹配一个人的身高来检查输入是否有效。以下是一些示例输入：

5' 9"

6'

5'8"

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-14T08:57:44.357

如果你想确保没有人乱用它，你可以将它限制在合理的范围内，例如：3' 到 7'11''

```
/^(3-7)'(?:\s*(?:1[01]|0-9)(''|"))?$/ 
```

我一直认为“英寸”标记是双引号（`"`），而 VonC 的答案是他把它放在两个单引号（`''`）中，所以这个正则表达式同时考虑了两者。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-14T08:58:17.973

也许是这样的：

```
^(\d{1,5})\'((\s?)(-?)(\s?)([0-9]|(1[0-1]))\")?$ 
```

见：[这里](http://groups.google.com/group/django-users/browse_thread/thread/155257a63c7a2cc6)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T08:40:48.727

就像是：

```
\d'(?:\s*\d+'')? 
```

第二部分是指高度的可选部分。

如果您只想要一位数字，请删除 +。

```
\b\d'(?:\s*\d+'')?\b 
```

也可用于检测文本中的模式（避免将 1234'45 检测为...一个人的高度？！）

[您可以在此处为 javascript](http://www.regular-expressions.info/javascriptexample.html)测试该正则表达式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-14T09:12:13.267

好的。感谢您的输入。哇，好快啊，大快人心。

无论如何，我已经测试了你所有的正则表达式，看来鲁本的答案通过了我所有的测试输入。非常感谢那个伙伴。

所以这是我需要的：

> ^(\d{1,5})\'((\s?)(-?)(\s?)([0-9]|(1[0-1]))\")?$

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T08:57:01.940

```
^\d'\s?(\d{1,2}")?$ 
```

在这里测试：[http ://www.regular-expressions.info/javascriptexample.html](http://www.regular-expressions.info/javascriptexample.html)

# python - py2exe setup.py 带图标

> ID：289518
> 
> 赞同：5
> 
> 时间：2008-11-14T08:41:21.410
> 
> 标签：python, icons, py2exe

编译 Python 程序时如何为我的 exe 文件制作图标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T23:16:00.153

py2exe 有点过时了，并继续使用 pyinstaller（它本身有点过时；svn 版本是最新的） [http://pyinstaller.python-hosting.com/](http://pyinstaller.python-hosting.com/)

在运行 pyinstaller 的初始脚本并从 Makespec.py 生成规范文件后，编辑规范文件并查找 EXE 部分。在最后添加您的 ico 定义；所以

> 控制台=真）

会成为

> 控制台=真，图标='mine.ico'）

也就是说，如果 mine.ico 文件与 Makespec.py 文件位于同一文件夹中。还有一个用于将图标输入其中的命令行选项。我认为是

```
python Makespec.py -i 'mine.ico' /path/to/file.py 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T08:57:38.553

我前一阵子在搜索这个，发现了这个： http: [//www.mail-archive.com/pygame-users@seul.org/msg05619.html](http://www.mail-archive.com/pygame-users@seul.org/msg05619.html)

从上面的链接引用：

> setup.py 文件：PY_PROG =
> 
> 'trek10.py' APP_NAME = 'Trek_Game'
> 
> cfg = {
> 
> ```
> 'name':APP_NAME,
> 'version':'1.0',
> 'description':'',
> 'author':'',
> 'author_email':'',
> 'url':'',
> 
> 'py2exe.target':'',
> 'py2exe.icon':'icon.ico', #64x64
> 'py2exe.binary':APP_NAME, #leave off the .exe, it will be added
> 
> 'py2app.target':'',
> 'py2app.icon':'icon.icns', #128x128
> 
> 'cx_freeze.cmd':'~/src/cx_Freeze-3.0.3/FreezePython',
> 'cx_freeze.target':'',
> 'cx_freeze.binary':APP_NAME,
> } 
> ```
> 
> --剪辑--

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-14T09:23:37.830

在其他答案中回答了链接图标。创建这个东西就像使用[png2ico](http://winterdrache.de/freeware/png2ico/)一样简单。它从 1 个或多个 png 创建一个 ico 文件并处理多种尺寸等，例如：

```
png2ico myicon.ico logo16x16.png logo32x32.png 
```

将创建尺寸为 16x16 和 32x32 的 myicon.ico。尺寸必须是 8 个正方形的倍数，且不得大于 256x256。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-14T09:06:43.387

我没有使用 py2exe 的经验，但是如果在 exe 文件中*嵌入*图标是您所要求的 ，那么通过[谷歌快速搜索](http://www.google.com/search?q=py2exe+embed+icon)发现[了这一点。](http://www.py2exe.org/index.cgi/CustomIcons)

 *如果您想*创建*.ico 文件，我真的建议您搜索图标设计器或完成的图标。当然，您*可以*通过在绘画中创建 16x16、32x32 或 64x64 像素的图像，并将其重命名为 .ico，从而相当容易地创建 Win 3.x 风格的图标。但是为 Windows 创建现代多分辨率图标要复杂得多。

（当我意识到“exe”听起来很Windows时，我正要问你正在编译什么操作系统，果然......）

# oracle - 使用 Oracle 异常

> ID：289523
> 
> 赞同：1
> 
> 时间：2008-11-14T08:46:25.830
> 
> 标签：oracle, plsql

我想使用 Oracle 异常来处理下面代码中可能发生的错误。如果用户提供了数据库中不存在的图书 ID 和/或员工 ID，则会引发 NO_DATA_FOUND 异常。因此，我怎么知道哪个语句引发了这个异常。

```
CREATE OR REPLACE PROCEDURE TEST_EXCEPTION
(
    book_id_in IN book.book_id%TYPE,
    emp_id_in IN emp.emp_id%TYPE
)
IS

v_book_desc book.description%TYPE;
v_emp_name emp.emp_name%TYPE;

BEGIN

SELECT description into v_book_desc FROM book WHERE book_id = book_id_in;

...

SELECT emp_name into v_emp_name FROM emp WHERE emp_id = emp_id_in;

...

EXCEPTION
     WHEN NO_DATA_FOUND THEN
         /* Do something */

END TEST_EXCEPTION; 
```

我感谢任何建议或指导。谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-14T09:25:03.443

有多种方法可以做到这一点：

# 选项1

另一种选择是创建多个开始/结束块

```
CREATE OR REPLACE PROCEDURE TEST_EXCEPTION (
     book_id_in IN book.book_id%TYPE,
     emp_id_in IN emp.emp_id%TYPE )
IS

v_book_desc book.description%TYPE; v_emp_name emp.emp_name%TYPE;
statementIndex number(1, 0);

BEGIN

     BEGIN

     SELECT description into v_book_desc FROM book WHERE book_id = book_id_in;

     EXCEPTION WHEN NO_DATA_FOUND THEN 
      -- do your handling or raise a custom exception to be handled at end
     END; 

     BEGIN

     SELECT emp_name into v_emp_name FROM emp WHERE emp_id = emp_id_in;

      EXCEPTION WHEN NO_DATA_FOUND THEN 
      -- do your handling or raise a custom exception to be handled at end
     END; 

EXCEPTION WHEN_OTHERS THEN 

END TEST_EXCEPTION; 
```

* * *

# 选项 2

另一种选择是使用游标；

使用游标%NOTFOUND

请参阅（[http://www.unix.com.ua/orelly/oracle/langpkt/ch01_09.htm](http://www.unix.com.ua/orelly/oracle/langpkt/ch01_09.htm)）了解游标

* * *

# 选项 3：从 Yapiskan 复制

```
CREATE OR REPLACE PROCEDURE TEST_EXCEPTION ( book_id_in IN book.book_id%TYPE, emp_id_in IN emp.emp_id%TYPE ) IS

v_book_desc book.description%TYPE; v_emp_name emp.emp_name%TYPE;
statementIndex number(1, 0);

BEGIN

statementIndex := 1;
SELECT description into v_book_desc FROM book WHERE book_id = book_id_in;

...

statementIndex := 2;
SELECT emp_name into v_emp_name FROM emp WHERE emp_id = emp_id_in;

...

EXCEPTION WHEN NO_DATA_FOUND THEN 
if statementIndex = 1
then 
/* Do something */
else
/* Do something */
endif;

END TEST_EXCEPTION; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T08:52:37.923

您可以在给定语句之前设置一个变量。像;

```
CREATE OR REPLACE PROCEDURE TEST_EXCEPTION ( book_id_in IN book.book_id%TYPE, emp_id_in IN emp.emp_id%TYPE ) IS

v_book_desc book.description%TYPE; v_emp_name emp.emp_name%TYPE;
statementIndex number(1, 0);

BEGIN

statementIndex := 1;
SELECT description into v_book_desc FROM book WHERE book_id = book_id_in;

...

statementIndex := 2;
SELECT emp_name into v_emp_name FROM emp WHERE emp_id = emp_id_in;

...

EXCEPTION WHEN NO_DATA_FOUND THEN 
if statementIndex = 1
then 
/* Do something */
else
/* Do something */
endif;

END TEST_EXCEPTION; 
```

# eclipse - 如何使用 SVN 删除与模式匹配的所有目录？

> ID：289527
> 
> 赞同：3
> 
> 时间：2008-11-14T08:49:02.610
> 
> 标签：eclipse, svn

我已经从我的台式计算机签入了一个巨大的 Eclipse 项目到 SVN 服务器。我是使用命令行完成的。但是，我错误地在服务器中提交了所有已编译的类。

对于每个插件，都有一个目录 /bin/ 包含已编译的类。

有没有办法使用命令行快速删除服务器中与此模式匹配的所有目录？

另外，有没有办法告诉 svn 默认忽略 bin 目录？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-14T08:52:55.583

从[这里](http://bugs.sakaiproject.org/confluence/display/BOOT/Add+bin+and+target+to+global+svn+ignore+in+Eclipse)（对于“附加部分”）：

1.  单击窗口-> 首选项
2.  选择团队 -> 忽略的资源
3.  单击添加模式并输入“bin”
4.  单击应用，然后单击确定

对于 bin 目录，你有 svn 1.5 吗？

因为如果你这样做，`'svn rm --keep-local'`允许将它们从版本控制中拉出来，但*不能*从你的机器中删除它。

你可以用**[Tortoise](http://www.thecrumb.com/2008/07/14/digging-into-tortoisesvn/)**来做（删除（保留本地））

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T08:57:13.420

要添加 VonC 的建议，如果您使用的是命令行，您可以在此处编辑您的配置文件（并更改您的 global-ignores 条目）：

```
~/.subversion/config 
```

或在 Windows 注册表中：

```
HKCU\Software\Tigris.org\Config 
```

# hash - 这个 Base64 Look-alike 是什么？

> ID：289529
> 
> 赞同：-2
> 
> 时间：2008-11-14T08:51:46.770
> 
> 标签：hash, base64, exploit

我是解码技术的新手，昨天刚刚了解了 base64、sha-1、md5 和其他一些技术。

我一直试图弄清楚“orkut”蠕虫实际上包含什么。

在过去的几天里，我受到了许多 orkut 垃圾邮件发送者和黑客的攻击，他们发送给我们的 URL 有相似之处。

我不知道它包含什么信息，但我需要弄清楚。

问题在于以下文本：

```
Foo+bZGMiDsstRKVgpjhlfxMVpM=
lmKpr4+L6caaXii9iokloJ1A4xQ= 
```

上面的编码似乎是 base64 但不是，因为每当我尝试使用在线 base64 解码器对其进行解码时，我都会得到原始输出并且它不能准确解码。

也许其他一些代码已经与 base64 混合在一起。

谁能帮我解码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-16T17:06:33.027

它是 orkut 蠕虫的一部分。[这个页面](http://ryanlrussell.blogspot.com/2007/12/more-on-orkut-worm.html)有一些细节。请注意，它提到了`JSHDF["Page.signature.raw"]`您要在其中找到这些字符串的变量。

这是它所在页面的 SHA1 哈希。[此页面](http://www.marrowbones.com/commons/technosocial/2007/12/orkut_worm_code_and_why_was_go.html)显示了它的解码形式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-16T16:55:33.937

> 上面的编码似乎是 base64 但它不是，因为每当我尝试使用在线 base64 解码器对其进行解码时，我都会得到原始输出并且它不能准确解码。

是什么让您认为解码不正确？通常，您会对二进制内容进行 base64 或十六进制编码，以便可以将其作为文本传输。您不会对文本进行 base64 编码，因此将上面提供的字符串解码为 ASCII gobbledygook 也就不足为奇了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T08:57:32.813

哈哈，如果这么简单，那就不值得破解了！您必须更加努力地尝试，而不仅仅是简单地解码一次。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-14T09:15:36.207

它们可能只是散列。

如果它们是散列，如果原始内容超过一定大小，则在算法上“反转”它们是不可能的，因为在一定的源数据大小之后，散列变成了有损压缩函数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-23T21:44:53.360

通常 Foo+whatever 是加盐哈希的结果。用盐存储哈希结果是很常见的，盐可以明文存储。为了将盐与实际哈希值分开，通常使用 + 号。

使用Base64，使得哈希的二进制结果可以以文本形式存储。您可以看出这些字符串的最后一部分可能是有效的 Base64，因为 Base64 内容将始终是 4 的倍数。它为每 3 个字节的输入输出 4 个有效的 ASCII 字符。它用“=”符号填充结尾。

因此，对于`Foo+bZGMiDsstRKVgpjhlfxMVpM=`，这可能是接受一些输入的结果，无论是某种消息还是其他什么，并应用[盐](http://en.wikipedia.org/wiki/Salt_(cryptography))“Foo”，然后对结果进行哈希处理。字符串值`bZGMiDsstRKVgpjhlfxMVpM=`可能是某个哈希函数的二进制结果。在线[Base64 解码器](http://tomeko.net/online_tools/base64.php?lang=en)显示，十六进制而不是 Base64 的值是`{ 6D 91 8C 88 3B 2C B5 12 95 82 98 E1 95 FC 4C 56 93 }`. 是的，这不是 ASCII 文本。

Base64、二进制、十六进制、十进制，都是值的表示方式。把后面的部分想象`+`成一个数字。例如，上述 136 位数字可能是 128 位散列和 8 位[CRC](http://en.wikipedia.org/wiki/Cyclic_redundancy_check)的结果。谁知道？我不知道您为什么会收到垃圾邮件，或者为什么这些垃圾邮件带有这些字符串，但这可能是对字符串结构性质的一些了解。

# algorithm - 检查数独字段的酷算法？

> ID：289537
> 
> 赞同：25
> 
> 时间：2008-11-14T08:56:22.627
> 
> 标签：algorithm, sudoku

有谁知道一个简单的算法来检查数独配置是否有效？我想出的最简单的算法是伪代码中的（对于大小为 n 的板）

```
for each row
  for each number k in 1..n
    if k is not in the row (using another for-loop)
      return not-a-solution

..do the same for each column 
```

但我很确定一定有更好的（在更优雅的意义上）解决方案。效率是相当不重要的。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-11-14T09:26:52.300

您需要检查数独的所有约束：

*   检查每一行的总和
*   检查每一列的总和
*   检查每个框的总和
*   检查每一行的重复数字
*   检查每列上的重复数字
*   检查每个盒子上的重复数字

这总共是 6 次检查.. 使用蛮力方法。

如果您知道棋盘的大小（即 3x3 或 9x9），可以使用某种数学优化

**编辑**：总和约束的解释：首先检查总和（如果总和不是 45，则停止）比检查重复项要快得多（也更简单）。它提供了一种丢弃错误解决方案的简单方法。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-11-14T10:33:33.210

Peter Norvig 有一篇关于解决数独谜题（使用 python）的精彩文章，

[https://norvig.com/sudoku.html](https://norvig.com/sudoku.html)

也许对于你想做的事情来说太多了，但无论如何它都是一本很棒的书

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-29T12:22:39.750

检查每一行、每一列和每一个方框，使其包含数字 1-9，并且没有重复。这里的大多数答案已经讨论过了。

但是如何有效地做到这一点？答案：使用类似的循环

```
result=0;
for each entry:
  result |= 1<<(value-1)
return (result==511); 
```

每个数字将设置结果的一位。如果所有 9 个数字都是唯一的，则将设置最低 9 位。所以“检查重复”测试只是检查所有9位是否设置，与测试结果==511相同。您需要进行 27 项检查……每行、每列和每一个框都要检查一次。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-14T09:07:01.093

只是一个想法：你不需要检查每个 3x3 方块中的数字吗？

我试图弄清楚是否有可能在没有正确数独的情况下满足行和列条件

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-04-04T11:58:45.657

这是我在 Python 中的解决方案，我很高兴看到它是迄今为止最短的解决方案 :)

编码：

```
def check(sud):
    zippedsud = zip(*sud)

    boxedsud=[]
    for li,line in enumerate(sud):
        for box in range(3):
            if not li % 3: boxedsud.append([])    # build a new box every 3 lines
            boxedsud[box + li/3*3].extend(line[box*3:box*3+3])

    for li in range(9):
        if [x for x in [set(sud[li]), set(zippedsud[li]), set(boxedsud[li])] if x != set(range(1,10))]:
            return False
    return True 
```

和执行：

```
sudoku=[
[7, 5, 1,  8, 4, 3,  9, 2, 6],
[8, 9, 3,  6, 2, 5,  1, 7, 4], 
[6, 4, 2,  1, 7, 9,  5, 8, 3],
[4, 2, 5,  3, 1, 6,  7, 9, 8],
[1, 7, 6,  9, 8, 2,  3, 4, 5],
[9, 3, 8,  7, 5, 4,  6, 1, 2],
[3, 6, 4,  2, 9, 7,  8, 5, 1],
[2, 8, 9,  5, 3, 1,  4, 6, 7],
[5, 1, 7,  4, 6, 8,  2, 3, 9]]

print check(sudoku) 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-10-13T18:42:19.030

为每一行、每一列和每一方格创建一个布尔数组。数组的索引表示放入该行、列或正方形的*值。*换句话说，如果将 5 添加到第二行第一列，则将 rows[2][5] 以及 columns[1][5] 和 squares[4][5] 设置为 true，以表示行、列和方格现在有了`5`值。

无论您的原始电路板是如何表示的，这都是一种简单且非常快速的方法来检查它的完整性和正确性。只需按照它们在板上出现的顺序获取数字，然后开始构建此数据结构。当您在板上放置数字时，它变成了一个 O(1) 操作来确定是否有任何值在给定的行、列或正方形中重复。（您还需要检查每个值是否是合法数字：如果他们给您一个空白或过高的数字，您就知道该板不完整。）当您到达板的尽头时，您'会知道所有的值都是正确的，并且不需要更多的检查。

也有人指出，你可以使用任何形式的 Set 来做到这一点。以这种方式排列的数组只是 Set 的一种特别轻量级和高性能的形式，适用于小的、连续的、固定的数字集。如果您知道电路板的大小，您也可以选择进行位掩码，但考虑到效率对您来说没什么大不了的，这可能有点过于乏味了。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-14T10:36:30.147

创建单元格集，其中每个集包含 9 个单元格，并为垂直列、水平行和 3x3 正方形创建集。

然后对于每个单元格，只需识别它所属的集合并分析它们。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-14T11:10:32.747

您可以将集合（行、列、框）中的所有值提取到列表中，对其进行排序，然后与 '(1, 2, 3, 4, 5, 6, 7, 8, 9) 进行比较

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-15T02:59:36.357

我为一个班级项目做过一次。我一共使用了 27 个集合来表示每一行、每一列和每一框。我会在将数字添加到每个集合时检查数字（数字的每个位置都会将数字添加到 3 个集合、一行、一列和一个框），以确保用户只输入数字 1- 9\. 填充集合的唯一方法是正确填充唯一数字。如果所有 27 组都被填满，那么这个谜题就解决了。设置从用户界面到 27 个集合的映射有点乏味，但其余的逻辑很容易实现。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-14T09:58:42.190

检查是否：

```
when the sum of each row/column/box equals n*(n+1)/2
and the product equals n!
with n = number of rows or columns 
```

这足以满足数独的规则。因为这将允许 O(n^2) 的算法，对正确的单元格求和和相乘。

看 n = 9，总和应该是 45，乘积 362880。

你会做这样的事情：

```
for i = 0 to n-1 do
  boxsum[i] := 0;
  colsum[i] := 0;
  rowsum[i] := 0;
  boxprod[i] := 1;
  colprod[i] := 1;
  rowprod[i] := 1;    
end;

for i = 0 to n-1 do
  for j = 0 to n-1 do
    box := (i div n^1/2) + (j div n^1/2)*n^1/2;
    boxsum[box] := boxsum[box] + cell[i,j];
    boxprod[box] := boxprod[box] * cell[i,j];
    colsum[i] := colsum[i] + cell[i,j];
    colprod[i] := colprod[i] * cell[i,j];
    rowsum[j] := colsum[j] + cell[i,j];
    rowprod[j] := colprod[j] * cell[i,j];
   end;
end;

for i = 0 to n-1 do
  if boxsum[i] <> 45
  or colsum[i] <> 45
  or rowsum[i] <> 45
  or boxprod[i] <> 362880
  or colprod[i] <> 362880
  or rowprod[i] <> 362880
   return false; 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-29T11:27:16.873

前段时间，我写了一个数独检查器，它检查每一行上的重复数字、每列上的重复数字和每个盒子上的重复数字。不过，如果有人能想出几行 Linq 代码，我会很高兴的。

```
char VerifySudoku(char grid[81])
{
    for (char r = 0; r < 9; ++r)
    {
        unsigned int bigFlags = 0;

        for (char c = 0; c < 9; ++c)
        {
            unsigned short buffer = r/3*3+c/3;

                        // check horizontally
            bitFlags |= 1 << (27-grid[(r<<3)+r+c]) 
                        // check vertically
                     |  1 << (18-grid[(c<<3)+c+r])
                        // check subgrids
                     |  1 << (9-grid[(buffer<<3)+buffer+r%3*3+c%3]);

        }

        if (bitFlags != 0x7ffffff)
            return 0; // invalid
    }

    return 1; // valid
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-10-13T17:56:56.207

如果行/列的总和**和**乘积等于正确的数字 45/362880

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-05-27T15:36:38.530

首先，您需要创建一个布尔值，“正确”。然后，如前所述，创建一个 for 循环。循环的代码和之后的所有内容（在 java 中）如所述，其中 field 是具有相等边的二维数组， col 是另一个具有相同尺寸的数组，而 l 是一维数组：

```
for(int i=0; i<field.length(); i++){
    for(int j=0; j<field[i].length; j++){
        if(field[i][j]>9||field[i][j]<1){
            checking=false;
            break;
        }
        else{
            col[field[i].length()-j][i]=field[i][j];
        }
    }
} 
```

我不知道检查 3x3 框的确切算法，但是您应该在另一个*for*循环中使用“ `/*array name goes here*/[i].contains(1)&&/*array name goes here*/[i].contains(2)`”检查字段和 col 中的所有行（继续直到达到行的长度） 。

 ** * *

## 回答 #14

> 赞同：1
> 
> 时间：2013-10-12T06:18:38.673

这是 Python 中一个很好的可读方法：

```
from itertools import chain                                                                                            

def valid(puzzle):                                                                                                     
    def get_block(x,y):                                                                                                
        return chain(*[puzzle[i][3*x:3*x+3] for i in range(3*y, 3*y+3)])                                               
    rows = [set(row) for row in puzzle]                                                                                
    columns = [set(column) for column in zip(*puzzle)]                                                                 
    blocks = [set(get_block(x,y)) for x in range(0,3) for y in range(0,3)]                                             
    return all(map(lambda s: s == set([1,2,3,4,5,6,7,8,9]), rows + columns + blocks)) 
```

每个 3x3 方格称为一个块，其中 9 个在 3x3 网格中。假设拼图作为列表列表输入，每个内部列表为一行。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2016-10-14T18:52:00.690

```
def解决方案（板）：
    我在船上：
        如果总和（i）！= 45：
            返回“不正确”

    对于范围内的 i (9)：
        温度2 = []
        对于范围内的 x (9)：
            temp2.​​append(板[i][x])

        如果总和（temp2）！= 45：
            返回“不正确”

    返回“正确”

板= []
对于范围内的 i (9)：
    inp = raw_input()
    temp = [int(i) for i in inp]
    board.append（临时）

打印解决方案（板）

```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-11-14T10:02:56.753

假设 int sudoku[0..8,0..8] 是数独字段。

```
bool CheckSudoku(int[,] sudoku)
{
    int flag = 0;

// Check rows
for(int row = 0; row < 9; row++)
{
    flag = 0;
    for (int col = 0; col < 9; col++)
    {
        // edited : check range step (see comments)
        if ((sudoku[row, col] < 1)||(sudoku[row, col] > 9)) 
        {
            return false;
        }

        // if n-th bit is set.. but you can use a bool array for readability
        if ((flag & (1 << sudoku[row, col])) != 0) 
        {
            return false;
        }

        // set the n-th bit
        flag |= (1 << sudoku[row, col]); 
    }
}

// Check columns
for(int col= 0; col < 9; col++)
{
    flag = 0;
    for (int row = 0; row < 9; row++)
    {
        if ((flag & (1 << sudoku[row, col])) != 0)
        {
            return false;
        }
        flag |= (1 << sudoku[row, col]);
    }
}

// Check 3x3 boxes
for(int box= 0; box < 9; box++)
{
    flag = 0;
    for (int ofs = 0; ofs < 9; ofs++)
    {
        int col = (box % 3) * 3;
        int row = ((int)(box / 3)) * 3;

        if ((flag & (1 << sudoku[row, col])) != 0)
        {
            return false;
        }
        flag |= (1 << sudoku[row, col]);
    }
}
return true; 
```

}

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-11-14T10:45:48.163

假设您的电路板从 1 - n 开始。

我们将创建一个验证数组，填充它然后验证它。

```
grid [0-(n-1)][0-(n-1)]; //this is the input grid
//each verification takes n^2 bits, so three verifications gives us 3n^2
boolean VArray (3*n*n) //make sure this is initialized to false

for i = 0 to n
 for j = 0 to n
  /*
   each coordinate consists of three parts
   row/col/box start pos, index offset, val offset 
  */

  //to validate rows
  VArray( (0)     + (j*n)                             + (grid[i][j]-1) ) = 1
  //to validate cols
  VArray( (n*n)   + (i*n)                             + (grid[i][j]-1) ) = 1
  //to validate boxes
  VArray( (2*n*n) + (3*(floor (i/3)*n)+ floor(j/3)*n) + (grid[i][j]-1) ) = 1
 next    
next

if every array value is true then the solution is correct. 
```

我认为这可以解决问题，尽管我确信我在那里犯了几个愚蠢的错误。我什至可能完全错过了这条船。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-11-14T12:10:18.353

```
array = [1,2,3,4,5,6,7,8,9]  
sudoku = int [][]
puzzle = 9 #9x9
columns = map []
units = map [] # box    
unit_l = 3 # box width/height
check_puzzle()    

def strike_numbers(line, line_num, columns, units, unit_l):
    count = 0
    for n in line:
        # check which unit we're in
        unit = ceil(n / unit_l) + ceil(line_num / unit_l) # this line is wrong - rushed
        if units[unit].contains(n): #is n in unit already?
             return columns, units, 1
        units[unit].add(n)
        if columns[count].contains(n): #is n in column already?
            return columns, units, 1
        columns[count].add(n)
        line.remove(n) #remove num from temp row
    return columns, units, line.length # was a number not eliminated?

def check_puzzle(columns, sudoku, puzzle, array, units):
    for (i=0;i< puzzle;i++):
        columns, units, left_over = strike_numbers(sudoku[i], i, columns, units) # iterate through rows
        if (left_over > 0): return false 
```

在没有彻底检查的情况下，在我的脑海中，这应该可以工作（进行一些调试），同时只循环两次。O(n^2) 而不是 O(3(n^2))

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-04-29T12:16:02.717

这是数学教授 JF Crook 的论文：[A Pencil-and-Paper Algorithm for Solving Sudoku Puzzles](http://www.ams.org/notices/200904/rtx090400460p.pdf)

这篇论文发表于 2009 年 4 月，它作为确定的数独解决方案得到了很多宣传（查看谷歌的“JFCrook Sudoku”）。

除了算法之外，还有一个算法有效的数学证明（教授承认他不觉得数独很有趣，所以他在纸上扔了一些数学以使其更有趣）。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-04-29T12:29:09.220

我会编写一个接口，该接口具有接收数独字段并返回真/假（如果它是一个解决方案）的函数。然后将约束实现为每个约束的单个验证类。

要验证只需遍历所有约束类，并且当所有约束类都通过时，数独是正确的。为了加快速度，将最有可能失败的那些放在前面，并在指向无效字段的第一个结果中停止。

很一般的模式。;-)

当然，您可以增强它以提供提示，哪个字段可能是错误的等等。

第一个约束，只需检查所有字段是否都已填写。（简单循环）第二次检查每个块中是否所有数字（嵌套循环）第三次检查完整的行和列（与上面的过程几乎相同，但访问方案不同）

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2012-06-15T17:39:18.530

这是我在 C 中的。每个方格只通过一次。

```
int checkSudoku(int board[]) {
  int i;
  int check[13] = { 0 };

  for (i = 0; i < 81; i++) {
    if (i % 9 == 0) {
      check[9] = 0;
      if (i % 27 == 0) {
        check[10] = 0;
        check[11] = 0;
        check[12] = 0;
      }
    }

    if (check[i % 9] & (1 << board[i])) {
      return 0;
    }
    check[i % 9] |= (1 << board[i]);

    if (check[9] & (1 << board[i])) {
      return 0;
    }
    check[9] |= (1 << board[i]);

    if (i % 9 < 3) {
      if (check[10] & (1 << board[i])) {
        return 0;
      }
      check[10] |= (1 << board[i]);
    } else if (i % 9 < 6) {
      if (check[11] & (1 << board[i])) {
        return 0;
      }
      check[11] |= (1 << board[i]);
    } else {
      if (check[12] & (1 << board[i])) {
        return 0;
      }
      check[12] |= (1 << board[i]);
    }
  }
} 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2013-05-27T23:20:29.287

这是我刚刚为此所做的：

```
boolean checkers=true;
String checking="";
    if(a.length/3==1){}
    else{
       for(int l=1; l<a.length/3; l++){
            for(int n=0;n<3*l;n++){
                for(int lm=1; lm<a[n].length/3; lm++){
                    for(int m=0;m<3*l;m++){
                    System.out.print("    "+a[n][m]);
                    if(a[n][m]<=0){
                    System.out.print("        (Values must be positive!)        ");
                    }
                    if(n==0){
                        if(m!=0){
                        checking+=", "+a[n][m];
                    }
                    else{
                        checking+=a[n][m];
                    }
                }
                else{
                    checking+=", "+a[n][m];
                }
            }
                    }
            System.out.print("        "+checking);
            System.out.println();
                }
       }
            for (int i=1;i<=a.length*a[1].length;i++){
        if(checking.contains(Integer.toString(i))){

        }
        else{
            checkers=false;
        }
            }
        }
    checkers=checkCol(a);
    if(checking.contains("-")&&!checking.contains("--")){
        checkers=false;
    }
    System.out.println();
    if(checkers==true){
        System.out.println("This is correct! YAY!");
    }
    else{
        System.out.println("Sorry, it's not right. :-(");
    }
}
private static boolean checkCol(int[][]a){
    boolean checkers=true;
    int[][]col=new int[][]{{0,0,0},{0,0,0},{0,0,0}};
    for(int i=0; i<a.length; i++){
        for(int j=0; j<a[i].length; j++){
            if(a[i][j]>9||a[i][j]<1){
                checkers=false;
                break;
            }
            else{
                col[a[i].length-j][i]=a[i][j];
            }
        }
    }
    String alia="";
    for(int i=0; i<col.length; i++){
        for(int j=1; j<=col[i].length; j++){
            alia=a[i].toString();
            if(alia.contains(""+j)){
                alia=col[i].toString();
                if(alia.contains(""+j)){}
                else{
                    checkers=false;
                }   
            }
            else{
                checkers=false;
            }
        }
    }
    return checkers;
} 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2014-04-15T10:45:12.680

您可以通过以下两种类似的方式检查数独是否已解决：

*   检查数字在每一行、每一列和每一块中是否唯一。

一个天真的解决方案是遍历每个正方形并检查该数字在该数字占用的行、列块中是否唯一。

但是有一个更好的方法。

*   如果每一行、每一列和每一块都包含数字的排列（从 1 到 9），数独就可以解决

这只需要检查每一行、每一列和每一块，而不是对每个数字都这样做。一个简单的实现是有一个数字 1 到 9 的位域，并在迭代列、行和块时删除它们。如果您尝试删除丢失的数字，或者完成后该字段不为空，则数独无法正确解决。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2017-09-13T00:09:46.740

这是 Swift 中的一个非常简洁的版本，它只使用一个 Ints 数组来跟踪 9 个数字的组，并且只对数独进行一次迭代。

```
import UIKit

func check(_ sudoku:[[Int]]) -> Bool {

    var groups = Array(repeating: 0, count: 27)

    for x in 0...8 {
        for y in 0...8 {
            groups[x] += 1 << sudoku[x][y] // Column (group 0 - 8)
            groups[y + 9] += 1 << sudoku[x][y] // Row (group 9 - 17)
            groups[(x + y * 9) / 9 + 18] += 1 << sudoku[x][y] // Box (group 18 - 27)
        }
    }

    return groups.filter{ $0 != 1022 }.count == 0
}

let sudoku = [
    [7, 5, 1,  8, 4, 3,  9, 2, 6],
    [8, 9, 3,  6, 2, 5,  1, 7, 4],
    [6, 4, 2,  1, 7, 9,  5, 8, 3],
    [4, 2, 5,  3, 1, 6,  7, 9, 8],
    [1, 7, 6,  9, 8, 2,  3, 4, 5],
    [9, 3, 8,  7, 5, 4,  6, 1, 2],
    [3, 6, 4,  2, 9, 7,  8, 5, 1],
    [2, 8, 9,  5, 3, 1,  4, 6, 7],
    [5, 1, 7,  4, 6, 8,  2, 3, 9]
]

if check(sudoku) {
    print("Pass")
} else {
    print("Fail")
} 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2018-12-12T15:38:52.030

您可以进行的一个小优化是，您可以在 O(n) 时间而不是 O(n^2) 时间内检查行、列或框中的重复项：当您遍历一组数字时，将每个数字添加到一个哈希集。根据语言的不同，您实际上可能能够使用真正的哈希集，即恒定时间查找和插入；然后通过查看插入是否成功，可以在同一步骤中检查重复项。这是代码的一个小改进，但从 O(n^2) 到 O(n) 是一个重要的优化。

# plsql - 使用 DBMS_CRYPTO 加密数据

> ID：289555
> 
> 赞同：1
> 
> 时间：2008-11-14T09:01:59.933
> 
> 标签：plsql

我目前正在使用 Oracle 10g。我使用 DBMS_CRYPTO 包来加密用户登录密码。为了加密或解密数据，我必须有一个密钥。那么我应该将密钥放在哪里以便对其他开发人员隐藏它，或者是否有其他方法可以加密数据而无法解密？

在 SQL Server 中，我只是使用 PWDENCRYPT 函数进行加密，当我想比较用户输入的数据是否正确时，我使用 PWDCOMPARE。请建议。谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-18T10:18:52.380

为了向其他开发人员隐藏密钥，希望这篇文章对您有所帮助，它包括一个关于密钥管理的部分：

[http://www.oracle.com/technology/oramag/oracle/05-jan/o15security.html](http://www.oracle.com/technology/oramag/oracle/05-jan/o15security.html)

要加密数据而无法将其解密，您可能希望研究[*一种方式 hashes*](http://en.wikipedia.org/wiki/Cryptographic_hash_function)。Oracle 以 DBMS_CRYPTO.HASH 的形式提供此功能，使用起来很简单（如此[处](http://forums.oracle.com/forums/thread.jspa?threadID=347102)所述）：

```
SQL> select SYS.DBMS_CRYPTO.HASH('FFFFFF',1) from dual;
7D91F6D9BE28A9756B0D2F11D3AF4F0C 
```

然后，您只将哈希存储在数据库中 - 如果哈希用户输入与您存储的哈希匹配，您可以验证密码，但您无法以任何方式检索密码。

# c++ - C++ 中的类布局：为什么成员有时是有序的？

> ID：289559
> 
> 赞同：9
> 
> 时间：2008-11-14T09:06:14.277
> 
> 标签：c++

C++ 标准规定，单个访问段内的成员变量必须按照声明它们的顺序在内存中布局。同时，编译器可以自由选择访问段本身的相互顺序。这种自由使得理论上不可能链接由不同编译器创建的二进制文件。那么，严格的分段排序的其余原因是什么？即将推出的~~C++09~~新 C++11 标准是否提供了一种“手动”完全确定对象布局的方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-14T10:01:29.360

> 这种自由使得理论上不可能链接由不同编译器创建的二进制文件。

由于多种原因，这是不可能的，结构布局是最次要的。vtables，和的实现`operator new`，`delete`数据类型大小......

> 那么，严格的分段排序的其余原因是什么？

C 兼容性，我会想到，因此在 C 中定义的结构与在 C++*中对给定编译器集的*打包方式相同。

> 新的 C++ ~~09~~ 11 标准是否提供了一种“手动”完全确定对象布局的方法？

不，不超过当前标准。

但是，对于一个`class`或`struct`没有 vtable 且完全私有（或公共）字段，如果您使用这些`[u]int[8|16|32|64]_t`类型，它已经是可能的。除了这个，你还有什么用例？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T10:52:27.370

[编辑] 我今天学到了一些新东西！找到以下标准报价：

> 分配没有中间访问说明符的（非联合）类的非静态数据成员，以便后面的成员在类对象中具有更高的地址。由访问说明符分隔的非静态数据成员的分配顺序未指定 (11.1)。实现对齐要求可能会导致两个相邻的成员不会被立即分配；管理虚拟功能 (10.3) 和虚拟基类 (10.1) 的空间要求也是如此。

有趣-我不知道为什么要给出这种自由度。继续我之前的回复……

* * *

如前所述，保留排序的原因是 C 兼容性，当时我想没有人想到重新排序成员的好处，而内存布局通常是手动完成的。此外，现在被认为是“丑陋的技巧”（例如使用 memset 将选定成员归零，或者拥有两个具有相同布局的结构）非常普遍。

该标准没有为您提供强制执行给定布局的方法，但大多数编译器都提供了控制填充的措施，例如 MSVC 编译器上的 #pragma pack。

自动填充的原因是平台的可移植性：不同的架构有不同的对齐要求，例如一些架构抛出未对齐的整数（这些是当时的简单情况）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T10:08:15.820

编辑：恐怕我误解了你的问题

我认为这是对内存访问的优化。例如，如果我们得到这个结构：

```
struct example
{
   int16 intData;
   byte  byteData;
   int32 intData;
   byte intData;
   int32 intData;
} 
```

假设这个平台中的单词是 32 位的。然后你将需要 4 个完整的单词来传递结构中的所有数据：

> int16 + byte = 24 位（netx 字段不适合这里）
> 
> int32 = 32 位（netx 字段不适合此处）
> 
> 字节 = 8 位（netx 字段不适合此处）
> 
> int32 = 32 位

但是，如果您将字段重新排列为：

```
struct example
{
   int16 intData;
   byte  byteData;
   byte intData;
   int32 intData;
   int32 intData;
} 
```

然后你可以保存一个内存访问。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T12:54:12.850

您永远不应该链接由不同编译器创建的对象。即使您谈论的内容发生了变化，您仍然会有更多问题阻止您链接到其他编译器生成的文件。（对齐、名称修饰、调用约定仅举几个例子）。

编译器可以自由地对访问部分进行排序的一个原因可能是编译器可以为访问部分建立顺序：例如，具有较低地址的成员比具有较高地址的成员受到更多保护。

如果不允许重新排序，您将不会获得任何东西：只有 POD 提供 C 兼容性以及一种为您提供类/结构内成员的字节偏移量（使用宏`offsetof`）或允许您对其进行记忆的方法。如果您定义自定义构造函数、复制构造函数、私有成员或其他一些东西，则类型将变为非 POD。特别是，从一个类派生当前会破坏 PODness。

C++1x 降低了对 POD 的要求。例如，在 C++1x`std::pair<T, U>`中实际上是一个 POD，尽管它提供了自己的构造函数（尽管它必须符合某些规则）。

# ubuntu - 什么是 LTS（长期支持）？

> ID：289565
> 
> 赞同：25
> 
> 时间：2008-11-14T09:08:53.820
> 
> 标签：ubuntu, terminology, lts

我在维基百科上查了一下，那里只有一行。有人有更详细的描述吗？Ubuntu 使用这种表示法发布他们的操作系统，但我无法找到关于它的含义/包含的详细描述。我已经阅读了 Ubuntu 表示法，但需要更一般的描述，而不是 Ubuntu 是如何实现它的。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-11-14T09:32:39.340

在 Linux 世界中，LTS 和类似术语意味着发行版保持稳定。这意味着：您不会获得任何主要的功能升级（至少不会以任何方式破坏兼容性），但您将获得安全性增强。这方面的一个例子是 Red Hat Enterprise Server 或 CentOS，它只有 PHP 5.1 并且没有升级到 5.2，但所有 5.2 安全升级都被向后移植。

可以这样想：如果您现在正在编写一个自定义软件（例如，一个非常特殊的 Apache 模块）并且该公司保证 5 年的支持，这意味着您可以非常确定您的自定义软件在 5 年内仍然可以运行因为所有的接口和结构都将保持不变。

在 Windows World 中，这并不严格，但类似。微软支持 Windows NT 4 长达 10 年，直到 2006 年年中或年底。到那时它早已过时，被 Windows 2000 和 XP/2003 取代，但因为公司要么还不想迁移，要么有定制软件不兼容，微软在此之前提供了支持和（安全）升级。

如果您喜欢项目符号列表，长期支持意味着：

*   稳定的接口和“系统核心”
*   获取安全更新
*   （通常）没有或没有添加太多新功能
*   正如他们所知，在制定计划时为公司提供安全保障：如果我们今天启动它，它可以保证运行到 X 日期。
*   并非在所有情况下都可用。如果你想要最前沿，LTS 系统几乎肯定不适合你，但即使不是最前沿的技术也可能不会被添加（即 Windows NT 从未获得真正的 USB 支持，RedHat/CentOS 运行 PHP 5.1 而不是 5.2，甚至几个月5.2.0 发布后）...
*   长期支持涵盖的确切定义因供应商而异，您需要在做出决定之前与他们核实

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-11-14T09:12:06.573

[来自 Ubuntu 维基：](https://wiki.ubuntu.com/LTS)

> LTS 是“长期支持”的缩写。
> 
> 我们每六个月发布一个新的桌面和服务器版本。这意味着您将始终拥有开源世界必须提供的最新最好的应用程序。
> 
> Ubuntu 的设计考虑到了安全性。您可以在桌面和服务器上获得至少 18 个月的免费安全更新。
> 
> 使用长期支持 (LTS) 版本，您可以获得三年的桌面支持和五年的服务器支持。LTS 版本不收取额外费用，我们以相同的免费条款向所有人提供我们最好的作品。升级到新版本的 Ubuntu 是免费的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-14T09:20:25.573

我不相信“LTS”有任何一般定义，所以任何答案都必须关注 Ubuntu 的“长期支持”是什么意思

但是，只是为了添加 xsl 的答案，在服务器上使用[LTS](http://wiki.ubuntu.com/LTS)版本可以让您有信心部署将定期修补但不需要升级整个操作系统的服务器。

此外，非 LTS Ubuntu 升级需要按顺序进行，即从 7.10 升级到 8.10，您首先需要升级到 8.04

对于 LTS 版本，从一个 LTS 版本到下一个 LTS 版本有一条清晰的升级路径，即从[6.06 可以直接升级到 8.04](http://www.ubuntu.com/getubuntu/upgrading-8.04#head-e059d5452a24b50d09c64df48058ef2d834eb197-2)

# c++ - C++ 访问部分可以交错吗？

> ID：289568
> 
> 赞同：1
> 
> 时间：2008-11-14T09:11:58.463
> 
> 标签：c++

C++ 标准对内存中的类成员变量进行排序。它说成员变量的地址必须按照声明的顺序增加，但只能在一个访问段内。非常具体地说，这似乎并没有阻止编译器以交错的方式布置访问部分。例如：

```
class X {
public:
   int i;
   int j;
private:
   int k;
   int n;
} 
```

该标准是否允许编译器按 i、k、j、n 的顺序排列数据成员？这将为编译器在不违反标准的情况下优化对象布局提供一些（有限的）自由。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T14:38:39.863

我检查了 C++ 标准。在第 9.2 节第 12 段（或子句或其他任何内容）中，它说“由访问说明符分隔的非静态数据成员的分配顺序未指定。” “未指定”表示不需要记录的依赖于实现的行为。

因此，标准没有明确说明分配，除了 i 必须在 j 之前，k 必须在 n 之前。因此，允许编译器按 i、k、j、n 的顺序进行分配，并且不需要记录任何关于排序的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T14:02:46.923

不，我认为他不是想发送垃圾邮件。这是一个有效的问题，我认为非常有趣。

好的，现在我认为编译器可以做到这一点。该标准在 9.2 中说。p12：

`Implementation alignment require- ments might cause two adjacent members not to be allocated immediately after each other; so might requirements for space for managing virtual functions (10.3) and virtual base classes (10.1).`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T14:22:48.863

我对标准的解释方式，它看到的代码示例如下：由于 i 和 j 之间没有访问说明符，因此 i 的地址必须在 j 的地址之前。建议的排序满足了这一点。k 和 n 同上。所以在我的解释中，编译器*可以*使用这个顺序。

# windows-vista - USB HID 笔要求

> ID：289572
> 
> 赞同：3
> 
> 时间：2008-11-14T09:14:12.467
> 
> 标签：windows-vista, usb, driver, hid, pen

Windows Vista 中是否有 USB HID 笔驱动程序？如果是这样，为了使 Windows Vista 识别笔并加载笔驱动程序，对 USB 描述符有什么要求？

我正在寻找的是相当于 HID 鼠标驱动程序、HID 键盘驱动程序和大容量存储驱动程序的笔。上述示例驱动程序使 Windows、Linux 和 Mac OS 无需安装新驱动程序即可识别鼠标、键盘和记忆棒。

Windows Vista 对笔有很多本机支持，并且可以仅使用标准 HID 使用表定义 USB 笔设备（从 USB 协议的角度来看）。到目前为止，我能够制作符合鼠标和键盘的 USB HID 描述符（从操作系统的角度来看），并自动使用操作系统提供的标准驱动程序。

然而，对于我的 Pen，Windows Vista 仅加载通用 HID 驱动程序，并没有意识到该设备是“笔”。使用绝对坐标定义笔而不是鼠标的动机是，Vista 支持“手势”等特殊功能，但这仅适用于笔/数字化仪设备。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-01-24T04:03:45.227

看看这篇论文：[https ://www.microsoft.com/whdc/device/input/DigitizerDrvs_touch.mspx](https://www.microsoft.com/whdc/device/input/DigitizerDrvs_touch.mspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-09-25T13:09:43.853

此链接对我帮助很大：[https ://docs.microsoft.com/en-us/windows-hardware/design/component-guidelines/supporting-usages-in-digitizer-report-descriptors](https://docs.microsoft.com/en-us/windows-hardware/design/component-guidelines/supporting-usages-in-digitizer-report-descriptors)

> 数字化仪所需的 HID 用途
> 
> 所有数字化仪都需要以下用法。不支持所有必需用途的设备将无法在 Windows 8 上运行：
> 
> *   X 和 Y
> *   小费
> *   扫描时间（仅触控设备需要）
> *   在范围内
> 
> 可选 HID 用法：
> 
> *   宽度和高度
> *   信心
> *   压力
> *   桶
> *   X 倾斜
> *   Y 倾斜
> *   捻
> *   方位角

# iphone - 便利方法与初始化方法的内存使用情况

> ID：289578
> 
> 赞同：4
> 
> 时间：2008-11-14T09:17:21.680
> 
> 标签：iphone, objective-c, initialization, memory-management, convenience-methods

最近在研究 iPhone 内存管理时，我尝试比较同一个对象上的便捷方法和 init 方法。例如，我有 UIImageView，它显示下载的 NSData：

便捷方法：

```
imageView.image = [UIImage imageWithData:[downloads dataAtIndex:0]]; 
```

初始化方法：

```
UIImage *aImage = [[UIImage alloc] initWithData:[downloads dataAtIndex:0]];
imageView.image = aImage;
[aImage release]; 
```

当我尝试在视图上来回切换以增加内存使用量并点击“模拟内存警告”时，应用程序的内存使用量使用便捷方法从 20MB 变为 18MB，而 init 方法立即从 20MB 变为 13MB。

我还等待并与应用程序交互，以便在便捷方法的自动释放上释放时间。但并没有下降太多。

除了自动发布与发布之外，还有什么造成了差异？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-14T17:40:21.213

在包含的自动释放池耗尽之前，不会释放由便捷方法创建的自动释放对象。`NSAutoreleasePool`如果您将大量使用它们，建议将内存密集型操作包装在块内。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T21:53:53.933

Something that I have noticed is that with autoreleased objects, under memory pressure, there is a system GC that occurs with a noticeable performance hit if you don't release your pools in a timely fashion.

Also, using the init / release method allows your memory consumption in loops to remain flat, while using a autorelease pool creates spikes. In some memory challenged contitions, the rapid increase of objects in the autorelease pool may cause your application to get booted before the system takes steps to clean up stuff like emails being open, mobile safari tabs, and iTunes stuff running.

Bottom line, I tend to use init more because it makes my application's memory consumption more consistent and I see fewer problems with getting booted randomly. The gradual increase in memory consumption lets the daemons clean up the system without killing my app. Finally, as somewhat of an aside, if you are using the @property keyword in your classes, you have to be careful with stuff like:

```
myProperty = [NSMutableArray arrayWithCapacity:10]; 
```

Because what will happen is when the pool in your main.m class gets collected that item will be gone, causing a crash due to calling a method on a released object. If you are setting it with @property (nonatomic, retain) you will want to use:

```
self.myProperty = [NSMutableArray arrayWithCapacity:10]; 
```

to make sure it hangs around. You can avoid all of that by just going with alloc init however. Just watch your reference counts to make sure you don't have double references causing memory leaks.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T09:42:29.803

可能导致这种情况的唯一区别是 imageWithData: 不使用系统图像缓存，而 initWithData: 使用。因此，也许使用初始化程序创建的图像可以在收到内存警告时释放其图像数据，因为它可以返回系统缓存，而通过便捷方法创建的图像则不能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-14T13:20:10.677

使用便捷方法创建的对象是自动释放的，我相信您知道。但是，如果您在创建映像的 RunLoop 中没有 AutoReleasePool，则该对象将被添加到不存在的池中，并且永远不会被正确清理。如果您在线程中运行并且忘记为该线程创建 AutoReleasePool，则可能会出现这种情况。

要验证是否是这种情况，您可以运行 Instruments (Leaks) 并查看它报告的内容。

# .net - 与 .net 和 mono 一起使用的最佳对象关系映射框架？

> ID：289583
> 
> 赞同：2
> 
> 时间：2008-11-14T09:22:05.337
> 
> 标签：.net, orm, mono

我正在为我的学位项目结束做一些研究：一个使用 .net3.5 和 mono2.0 开发的多平台应用程序

我需要一些关于你们认为最好的对象关系映射框架的意见，它也可以与单声道一起运行。

另外，任何关于什么 ORM 最适合我的项目的意见，都会很方便（简单思考:)）

我的项目将是一个桌面应用程序，带有一个使用 SQL-Lite 的简单数据库，因为不需要多个连接或多用户访问。预期的开发平台是 Mac 和 Win（目前没有 linux，但我认为如果我设法让它与 mac 一起工作，那么将来添加对 linux 的支持会相对容易:)）

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-15T03:24:02.050

我会跳过 NHibernate 并使用 Castle ActiveRecord，它是 NHibernate 之上的一个层，我发现它更容易使用。我用它在 Mono 上进行开发，完全没有问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T09:28:37.133

NHibernate 是迄今为止最好的选择，那里也有非常好的工具，我推荐： [NHibernate Analyzer](http://ayende.com/projects/nhibernate-query-analyzer.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T09:24:52.663

休眠。

当您决定切换到 Java 时，它也会很有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T09:25:15.550

那么，第一个选项（没有 MS 产品）必须是[NHibernate](http://www.hibernate.org/343.html)。我*认为*它在单声道上播放得很好...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-10T19:55:46.750

[ECO](http://www.capableobjects.com)是一个非常强大的框架。免费使用最多 12 节课。

# apache - 安装在 Debian 机器上的 Apache 版本

> ID：289586
> 
> 赞同：324
> 
> 时间：2008-11-14T09:22:28.817
> 
> 标签：apache, debian, version

如何检查 Debian 机器上安装了哪个版本的 Apache？

有执行此操作的命令吗？

* * *

## 回答 #1

> 赞同：421
> 
> 时间：2008-11-14T09:23:19.080

试试 apachectl -V：

```
$ apachectl -V
Server version: Apache/2.2.9 (Unix)
Server built:   Sep 18 2008 21:54:05
Server's Module Magic Number: 20051115:15
Server loaded:  APR 1.2.7, APR-Util 1.2.7
Compiled using: APR 1.2.7, APR-Util 1.2.7
... etc ... 
```

如果它不适合您，请使用`sudo`.

* * *

## 回答 #2

> 赞同：153
> 
> 时间：2012-01-23T13:03:05.597

这适用于我的 Debian：

```
$ /usr/sbin/apache2 -v 
```

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2011-08-05T12:48:13.537

对于较新的 Debian 或 Ubuntu 发行版，您应该使用**apache2ctl** -v 或**apache2 -v 。**

```
apache:/etc/apache2# apache2ctl -v
Server version: Apache/2.2.16 (Debian)
Server built:   May 12 2011 11:58:18 
```

或者您可以使用**apache2 -V**获取更多信息。

```
apache2 -V
Server version: Apache/2.2.16 (Debian)
Server built:   May 12 2011 11:58:18
Server's Module Magic Number: x
Server loaded:  APR 1.4.2, APR-Util 1.3.9
Compiled using: APR 1.2.12, APR-Util 1.3.9
Architecture:   64-bit
Server MPM:     Worker
  threaded:     yes (fixed thread count)
    forked:     yes (variable process count)
Server compiled with.... 
```

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2016-03-05T01:07:25.977

该命令根据您的 Linux 版本命名 Apache 服务器的方式而有所不同。

在 Debian 和 Mac 操作系统上：

```
apachectl -v 
```

在 Red Hat 和 Amazon 的 EC2 Linux 上使用：

```
httpd -v 
```

在其他版本的 Linux 上尝试：

```
apache2 -v 
```

您可以使用两种不同的标志：

```
-v # gives you the version number
-V # gives you the compile settings including version number. 
```

如果您想像 user3786265 那样使用完整目录运行该命令，但不知道您的 apache 所在的位置，请使用以下`whereis`命令：

```
whereis httpd 
```

* * *

## 回答 #5

> 赞同：25
> 
> 时间：2014-09-24T08:25:44.773

我正在使用[Red Hat Linux](http://en.wikipedia.org/wiki/Red_Hat_Linux)，以下命令有效：

```
httpd -V 
```

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2017-04-24T19:36:04.667

我认为你必须确定你有什么类型的安装二进制或源代码。要检查安装了哪些二进制包：使用 root 权限执行以下命令：

```
dpkg -l |grep apache2 
```

结果应该是这样的：

```
dpkg -l |grep apache2 
```

```
ii  apache2                               2.4.10-10+deb8u8                      amd64        Apache HTTP Server
ii  apache2-bin                           2.4.10-10+deb8u8                      amd64        Apache HTTP Server (modules and other binary files)
ii  apache2-data                          2.4.10-10+deb8u8                      all          Apache HTTP Server (common files)
ii  apache2-doc                           2.4.10-10+deb8u8                      all          Apache HTTP Server (on-site documentation) 
```

要查找版本，您可以运行：

```
apache2ctl -V |grep -i "Server version" 
```

结果应该类似于： 服务器版本：Apache/2.4.10 (Debian)

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2014-09-17T15:34:40.523

用 sudo 试试

```
apachectl -V
-bash: apachectl: command not found

sudo apachectl -V
Server version: Apache/2.4.6 (Debian)
Server built:   Aug 12 2013 18:20:23
Server's Module Magic Number: 20120211:24
Server loaded:  APR 1.4.8, APR-UTIL 1.5.3
Compiled using: APR 1.4.8, APR-UTIL 1.5.2
Architecture:   32-bit
Server MPM:     prefork
  threaded:     no
  forked:     yes (variable process count)
Server compiled with....
bla bla.... 
```

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2015-04-09T09:28:37.520

您也可以直接使用包管理器：

```
dpkg -l | grep apache 
```

这不仅仅关注*版本号*，而是会进行更广泛的搜索，这将为您提供其他有用的信息，例如模块版本。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2014-06-28T16:01:17.030

对我来说，这适用于[Debian 6](https://en.wikipedia.org/wiki/Debian#Release_timeline) (Squeeze)：

> Linux www809 2.6.26-2-xen-686 #1 SMP Wed Sep 21 09:56:47 UTC 2011 i686 GNU/Linux

我必须走正确的道路：

```
/usr/local/apache/bin** $ **./apachectl -v 
```

> ./apachectl：第 71 行：ulimit：打开文件：无法修改限制：不允许操作
> 服务器版本：Apache/ **2.2.21**（Unix）
> 服务器构建：2011 年 12 月 17 日 19:57:53

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2015-06-23T06:12:08.313

另一种在基于 Debian 的系统上检查软件包（包括 Apache）安装版本的方法，我们可以使用：

```
apt-cache policy <package_name> 
```

例如对于 Apache

```
apt-cache policy apache2 
```

这将显示类似（查看该`Installed`行）：

```
$ apt-cache policy apache2
apache2:
  Installed: (none)
  Candidate: 2.2.22-1ubuntu1.9
  Version table:
     2.2.22-1ubuntu1.9 0
        500 http://hk.archive.ubuntu.com/ubuntu/ precise-updates/main amd64 Packages
        500 http://security.ubuntu.com/ubuntu/ precise-security/main amd64 Packages
     2.2.22-1ubuntu1 0
        500 http://hk.archive.ubuntu.com/ubuntu/ precise/main amd64 Packages 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2015-11-12T03:52:40.847

我尝试运行命令“httpd -V”和“apachectl -V”，但我无法执行并收到错误：

> -ksh: php: not found [没有这样的文件或目录]

然后我尝试了另一种方法。我转到服务器上的 Apache 目录，然后尝试执行命令：

```
./apachectl -v 
```

这对我有用并返回了输出：

```
Server version: Apache/2.2.20 (Unix)
Server built:   Sep  6 2012 17:22:16 
```

我希望这有帮助。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2016-11-07T09:25:51.980

1.  您可以使用`apachectl -V`或`apachectl -v`。两者都会返回 Apache 版本信息！

    ```
     xgqfrms:~/workspace $ apachectl -v

        Server version: Apache/2.4.7 (Ubuntu)
        Server built:   Jul 15 2016 15:34:04

        xgqfrms:~/workspace $ apachectl -V

        Server version: Apache/2.4.7 (Ubuntu)
        Server built:   Jul 15 2016 15:34:04
        Server's Module Magic Number: 20120211:27
        Server loaded:  APR 1.5.1-dev, APR-UTIL 1.5.3
        Compiled using: APR 1.5.1-dev, APR-UTIL 1.5.3
        Architecture:   64-bit
        Server MPM:     prefork
          threaded:     no
            forked:     yes (variable process count)
        Server compiled with....
         -D APR_HAS_SENDFILE
         -D APR_HAS_MMAP
         -D APR_HAVE_IPV6 (IPv4-mapped addresses enabled)
         -D APR_USE_SYSVSEM_SERIALIZE
         -D APR_USE_PTHREAD_SERIALIZE
         -D SINGLE_LISTEN_UNSERIALIZED_ACCEPT
         -D APR_HAS_OTHER_CHILD
         -D AP_HAVE_RELIABLE_PIPED_LOGS
         -D DYNAMIC_MODULE_LIMIT=256
         -D HTTPD_ROOT="/etc/apache2"
         -D SUEXEC_BIN="/usr/lib/apache2/suexec"
         -D DEFAULT_PIDLOG="/var/run/apache2.pid"
         -D DEFAULT_SCOREBOARD="logs/apache_runtime_status"
         -D DEFAULT_ERRORLOG="logs/error_log"
         -D AP_TYPES_CONFIG_FILE="mime.types"
         -D SERVER_CONFIG_FILE="apache2.conf"
    ```

2.  您可能更喜欢使用`apache2 -V`or `apache2 -v`。好像更容易记住！

    ```
     xgqfrms:~/workspace $ apache2 -v

        Server version: Apache/2.4.7 (Ubuntu)
        Server built:   Jul 15 2016 15:34:04

        xgqfrms:~/workspace $ apache2 -V

        Server version: Apache/2.4.7 (Ubuntu)
        Server built:   Jul 15 2016 15:34:04
        Server's Module Magic Number: 20120211:27
        Server loaded:  APR 1.5.1-dev, APR-UTIL 1.5.3
        Compiled using: APR 1.5.1-dev, APR-UTIL 1.5.3
        Architecture:   64-bit
        Server MPM:     prefork
          threaded:     no
            forked:     yes (variable process count)
        Server compiled with....
         -D APR_HAS_SENDFILE
         -D APR_HAS_MMAP
         -D APR_HAVE_IPV6 (IPv4-mapped addresses enabled)
         -D APR_USE_SYSVSEM_SERIALIZE
         -D APR_USE_PTHREAD_SERIALIZE
         -D SINGLE_LISTEN_UNSERIALIZED_ACCEPT
         -D APR_HAS_OTHER_CHILD
         -D AP_HAVE_RELIABLE_PIPED_LOGS
         -D DYNAMIC_MODULE_LIMIT=256
         -D HTTPD_ROOT="/etc/apache2"
         -D SUEXEC_BIN="/usr/lib/apache2/suexec"
         -D DEFAULT_PIDLOG="/var/run/apache2.pid"
         -D DEFAULT_SCOREBOARD="logs/apache_runtime_status"
         -D DEFAULT_ERRORLOG="logs/error_log"
         -D AP_TYPES_CONFIG_FILE="mime.types"
         -D SERVER_CONFIG_FILE="apache2.conf"
    ```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-11-14T09:33:06.627

对我来说`apachectl -V`没有用，但`apachectl fullstatus`给了我我的版本。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2016-09-09T12:22:17.570

Apache 的某些安装是 fubar（想想 Oracle 对它的打包，OHS）并且不理解 -V 标志，也不能直接调用而不会遇到缺少库的错误。

最简单的方法是对 httpd 二进制文件和 grep 使用`strings`命令（部分`binutils`）来获取可能类似于版本的字符串。例如，假设您的`httpd`二进制文件在目录下`/foo/bar`：

```
$ strings /foo/bar/httpd  | grep 2.2
GLIBC_2.2.5
Oracle-HTTP-Server/2.2.22 (Unix)
Success_Accepted_202
202 Accepted 
```

大多数二进制文件（不是全部）都包含它们的版本（至少是它们的主要版本）作为静态字符串。这是我获取版本的首选方式（或证实二进制文件的帮助信息与实际情况相符。）

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-11-14T09:24:41.760

或者，不那么直接：

`nmap -A localhost -p 80`

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2017-02-17T01:04:55.093

当然，在 shell 中键入*/usr/sbin/apache2 -v*是最好和最快的方法，顺便说一下，这是另一种选择，以防万一你的服务器中也有 PHP 并且你有兴趣收集 Apache 版本（以及更多更多信息）在快速编程步骤中。

只需在您的 Apache Web 根文件夹（或任何您喜欢的文件夹）中创建一个**info.php文件，然后在其中写入以下内容：**

```
<?php
    phpinfo();
?> 
```

现在转到*yoursite.com/info.php*（或本地机器的*localhost/info.php*）。

您将在*PHP 变量*部分看到您的 Apache 版本，这是一个示例：

[phpinfo() 示例转储页面](https://encrypted-tbn2.gstatic.com/images?q=tbn:ANd9GcTTIdelGpFE4FuEUbd7K2fuvCmFzcPEhu_T1kmOYnSaCeNBNEce)

另外，请注意，这些步骤显然适用于**任何具有 PHP 集成的 Web 服务器**，因此它不仅限于 Apache，一旦创建该页面，在开发时可能会很方便（只是不要忘记在生产环境中将其删除！！）

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2016-08-05T19:58:10.173

```
dlocate -s apache2 | grep '^Version:' 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2022-02-16T20:52:54.840

适用于 Debian 11 靶心

```
/usr/sbin/apache2 -v 
```

# c# - 通过代理使用 WCF 连接到 asmx Web 服务

> ID：289601
> 
> 赞同：4
> 
> 时间：2008-11-14T09:26:35.437
> 
> 标签：c#, wcf, authentication, proxy, asmx

**输入时发现抱歉的答案**

我正在尝试连接到需要通过代理进行用户名/密码身份验证的外部 Web 服务。我正在使用 Visual Studio Express 2008 生成服务引用

*   我已经使用 Web 引用连接到同一个 Web 服务。我们只需要设置一个更大的超时时间，因为它需要很长时间才能完成。
*   我已经连接到另一个不需要用户名/密码身份验证的 Web 服务，并使用生成的服务引用和一些设置来通过代理获取它。

所以我的想法是参考这个参考，将它指向正确的网络服务并添加身份验证。

我在没有安全性的情况下使用的配置：

```
 <?xml version="1.0" encoding="utf-8" ?>
    <configuration>
      <system.net>
        <defaultProxy useDefaultCredentials="true">
          <proxy bypassonlocal="False" proxyaddress="http://***.***.****:80" />
        </defaultProxy>
      </system.net>
        <system.serviceModel>
          <bindings>
            <customBinding>
              <binding name="AreaWebServiceSoap12">
                <textMessageEncoding maxReadPoolSize="64" maxWritePoolSize="16"
                    messageVersion="Soap12" writeEncoding="utf-8">
                  <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
                      maxBytesPerRead="4096" maxNameTableCharCount="16384" />
                </textMessageEncoding>            
                <httpTransport manualAddressing="false" maxBufferPoolSize="524288"
                    maxReceivedMessageSize="65536" allowCookies="false" authenticationScheme="Anonymous"
                    bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
                    keepAliveEnabled="true" maxBufferSize="65536" proxyAuthenticationScheme="Anonymous"
                    realm="" transferMode="Buffered" unsafeConnectionNtlmAuthentication="false"
                    useDefaultWebProxy="true" />            
              </binding>
            </customBinding>
          </bindings>
          <client>
            <endpoint address="http://www.****.*****.****.com/samplewebservice/service.asmx"
                    binding="customBinding" bindingConfiguration="AreaWebServiceSoap12"
                    contract="ServiceReference1.ServiceSoap" name="ServiceSoap" />
            </client>
        </system.serviceModel>
    </configuration> 
```

我在身份验证调用中添加了以下代码：

```
static void Main(string[] args)
{
  ServiceSoapClient s = new ServiceSoapClient();
  s.ClientCredentials.UserName.UserName = @"username";
  s.ClientCredentials.UserName.Password = @"password";

  Service.RawGpsData[] result = s.GetRawGpsData(0);
  Console.WriteLine(String.Format("done:{0}",result.Length));
  Console.ReadLine();
} 
```

仅使用此设置会按预期给出错误：

*HTTP 请求未使用客户端身份验证方案匿名授权。接收到来自服务器的身份验证标头是 NTLM。*

现在我迷路了，开始尝试一些愚蠢的事情，因为我刚刚开始使用 WCF。

当我将以下部分添加到配置中时

```
 <security authenticationMode="UserNameOverTransport"></security> 
```

我收到以下错误：

*为合约AreaWebServiceSoap.AreaWebServices 的绑定CustomBinding.http://tempuri.org/ 配置了需要具有完整性和机密性的传输级别的验证模式。传输不能提供完整性和机密性。*

抱歉，在输入这​​个问题时，我自己偶然发现了答案。我仍然认为人们可能对此感兴趣，并且仍然欢迎所有评论和想法。所以我会把问题留在这里，让它成为社区并自己发布答案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-14T09:28:54.793

将绑定更改为：

```
<?xml version="1.0" encoding="utf-8" ?>
<customBinding>
            <binding name="AreaWebServiceSoap12" closeTimeout="00:01:00" openTimeout="00:10:00"
                    receiveTimeout="00:20:00" sendTimeout="00:05:00">
                <textMessageEncoding maxReadPoolSize="64" maxWritePoolSize="16"
                  messageVersion="Soap12" writeEncoding="utf-8">
                <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
                    maxBytesPerRead="4096" maxNameTableCharCount="16384" />
              </textMessageEncoding>              
              <httpTransport manualAddressing="false" maxBufferPoolSize="524288"  
                  maxReceivedMessageSize="65536" allowCookies="false" authenticationScheme="Ntlm"
                  bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
                  keepAliveEnabled="true" maxBufferSize="65536" proxyAuthenticationScheme="Anonymous"
                  realm="" transferMode="Buffered" unsafeConnectionNtlmAuthentication="false"
                  useDefaultWebProxy="true" />              
            </binding>
          </customBinding> 
```

所以设置 authenticationScheme="Ntlm"

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-23T18:39:23.883

以下是无需代理即可连接的方法：

[http://blog.bodurov.com/Create-a-WCF-client-for-asmx-web-service-without-using-web-proxy](http://blog.bodurov.com/Create-a-WCF-client-for-asmx-web-service-without-using-web-proxy)

# c# - 文件系统索引

> ID：289620
> 
> 赞同：1
> 
> 时间：2008-11-14T09:37:01.377
> 
> 标签：c#, .net

我正在创建一个应用程序，我需要扫描目录配置单元以查找某个文件。

我还想更好地了解索引是如何工作的。

谁能指出我最好在 C# 中显示如何为文件系统搜索创建基本索引的任何资源？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T11:05:31.197

所以，听起来你需要一个库来进行搜索。

Lucene 是一个 Java 搜索库，已[移植到 C#](http://incubator.apache.org/lucene.net/)中。

# windows - 在 Windows 2008 Server 上添加桌面快捷方式到“我的电脑”

> ID：289622
> 
> 赞同：14
> 
> 时间：2008-11-14T09:37:22.250
> 
> 标签：windows, windows-server-2008, desktop

现在我终于开始为 Windows 2008 做一些开发/支持工作，我发现自己因为缺少一项我无法启用的功能而烦恼：我已经习惯了“我的电脑”的桌面快捷方式。我知道如何在 XP 和 2003 上启用此功能，但我在 2008 上找不到设置。

用户如何在 Windows 2008 Server 上配置哪些桌面图标（我的电脑、我的文档、回收站等）？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-11-14T12:03:47.133

右键单击开始菜单上的计算机菜单项，然后从弹出的上下文菜单中选择“在桌面上显示”。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-11-13T14:39:31.067

创建`.reg`具有以下内容的注册表编辑器文件（文件），并将其导入注册表：

```
Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel]

"{F02C1A0D-BE21-4350-88B0-7367FC96EF3C}"=dword:00000000

"{20D04FE0-3AEA-1069-A2D8-08002B30309D}"=dword:00000000

"{5399E694-6CE5-4D6C-8FCE-1D8870FDCBA0}"=dword:00000000 
```

# sql - SQL Server - 条件语句的查询执行计划

> ID：289625
> 
> 赞同：3
> 
> 时间：2008-11-14T09:38:25.443
> 
> 标签：sql, sql-server, performance, sql-execution-plan

条件语句（如**IF ... ELSE**）如何影响 SQL Server（2005 及更高版本）中的查询执行计划？

条件语句是否会导致执行计划不佳，在考虑性能时是否需要注意任何形式的条件？

**编辑添加**：

我特指缓存的查询执行计划。例如，在下面的实例中缓存查询执行计划时，是否为条件的每个结果缓存了两个执行计划？

```
DECLARE @condition BIT

IF @condition = 1
BEGIN
    SELECT * from ...
END
ELSE
BEGIN
    SELECT * from ..
END 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T11:41:01.687

你会经常用这种方法重新编译计划。我通常会尝试将它们分开，因此您最终会得到：

```
DECLARE @condition BIT

IF @condition = 1 
BEGIN 
 EXEC MyProc1
END 
ELSE 
BEGIN 
 EXEC MyProc2
END 
```

这样对最终用户没有区别，并且 MyProc1 和 2 获得自己的、适当的缓存执行计划。一个过程，一个查询。

# linux - 如何从svn状态循环linux中的文件

> ID：289626
> 
> 赞同：4
> 
> 时间：2008-11-14T09:39:37.643
> 
> 标签：linux, svn, shell, loops

作为 linux 的新手，我有以下问题。我有文件列表（这次是由 svn 状态产生的），我想创建一个脚本来循环它们并用 4 个空格替换制表符。

所以我想从

```
....
D      HTML/templates/t_bla.tpl
M      HTML/templates/t_list_markt.tpl
M      HTML/templates/t_vip.tpl
M      HTML/templates/upsell.tpl
M      HTML/templates/t_warranty.tpl
M      HTML/templates/top.tpl
A  +   HTML/templates/t_r1.tpl
.... 
```

类似于

```
for i in <files>; expand -t4;do cp $i /tmp/x;expand -t4 /tmp/x > $i;done; 
```

但我不知道该怎么做...

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-14T09:46:39.483

你可以使用这个命令：

```
svn st | cut -c8- | xargs ls 
```

这将删除前 8 个字符，只留下文件名列表，没有 Subversion 标志。您还可以添加`grep`before`cut`以仅过滤某些类型的更改，例如`/^M/`. `xargs`将文件列表作为参数传递给给定命令（`ls`在这种情况下）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-14T09:45:56.223

我会使用 sed，如下所示：

```
for i in files
do
    sed -i 's/\t/    /' "$i"
done 
```

里面的那个大块有四个空间。;-)

我还没有测试过，但它*应该可以*工作。我会备份你的文件以防万一。-i 标志意味着它将就地对文件进行替换，但如果它搞砸了，您将希望能够恢复它们。

这假定 $files 包含文件名。但是，您也可以使用 Adam 的方法来获取文件名，只需使用上面不带“$i”的 sed 命令。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-14T10:44:16.140

不要求任何投票，但为了记录，我将发布[@Adam Byrtek](https://stackoverflow.com/questions/289626/how-to-loop-files-in-linux-from-svn-status#289643)和[@Dan Fego](https://stackoverflow.com/questions/289626/how-to-loop-files-in-linux-from-svn-status#289640)的综合答案：

```
svn st | cut -c8- | xargs sed -i 's/\t/    /' 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-14T10:14:45.887

我无法使用真正的颠覆输出对其进行测试，但这应该可以完成工作：

```
svn st | cut -c8- | while read file; do expand -t4 $file > "$file-temp"; mv "$file-temp" "$file"; done 
```

`svn st | cut -c8-`将生成一个没有颠覆标志的文件列表。`read`然后将每个条目保存在变量中`$file`，并`expand`用于在每个文件中用四个空格替换制表符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T11:58:24.850

不是您要问的，但也许您应该研究颠覆中的提交钩子？

您可以创建一个挂钩来阻止签入任何在行首包含制表符的代码，或者根本不包含制表符。

在你的颠覆服务器上的 repo 目录中，会有一个名为 hooks 的目录。在其中放置一些名为“pre-commit”的可执行文件，它将在允许提交任何内容之前运行。如果您愿意，它可以返回阻止提交的状态。

这是我必须停止检查语法错误的 php 文件：

```
#!/bin/bash
REPOS="$1"
TXN="$2"
PHP="/usr/bin/php"

SVNLOOK=/usr/bin/svnlook

$SVNLOOK log -t "$TXN" "$REPOS" | grep "[a-zA-Z0-9]" > /dev/null

if [ $? -ne 0 ]
then
  echo 1>&2
  echo "You must enter a comment" 1>&2
  exit 1
fi

CHANGED=`$SVNLOOK changed -t "$TXN" "$REPOS" | awk '{print $2}'`

for LINE in $CHANGED
  do
  FILE=`echo $LINE | egrep \\.php$`
  if [ $? == 0 ]
    then
    MESSAGE=`$SVNLOOK cat -t "$TXN" "$REPOS" "${FILE}" | $PHP -l`
    if [ $? -ne 0 ]
      then
      echo 1>&2
      echo "***********************************" 1>&2
      echo "PHP error in: ${FILE}:" 1>&2
      echo "$MESSAGE" | sed "s| -| $FILE|g" 1>&2
      echo "***********************************" 1>&2
      exit 1
    fi
  fi
done 
```

# asp.net-mvc - 像 in 这样的 linq 运算符

> ID：289628
> 
> 赞同：1
> 
> 时间：2008-11-14T09:40:49.793
> 
> 标签：asp.net-mvc, linq

你好，

我有 3 个表：**Clips**、**Books和****ClipBook**之间的关系

 ****问题是：** 我需要得到**bookID=4和一些剪辑的****书**，我的意思是多对多

 **在简单的文本 sql 中，它将是这样的：

`select * from Clips where clipID in (select clipID from ClipBook where bookID=4)`

**问题是：**

我如何在没有运算符**加入**的情况下使用**Linq做到这一点**

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T09:48:35.580

Contains 方法是在 Linq 中转换为 IN 运算符，例如：

```
String[] cities = {"London", "Paris", "Madrid"};

from p in context.Person
where cities.Contains(p.Adress.City)
select p 
```

被翻译成一个 sql 子句，如： ..`WHERE a.City in ('London', 'Paris', 'Madrid')`其中 a 是与 Person 表连接后的 Address 表别名。

编辑：

您可以编写没有子查询的单个查询，但这很可能会转换为连接：

```
var clips = (from c in context.ClipBooks
             where c.BookID == 4
             select c.Clip).Distinct(); 
```

或者

```
var clips =  from c in context.Clip
             where c.ClicBooks.Any( cb => cb.BookID == 4)
             select c 
```

Any 在 Exists() 中翻译

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T09:51:55.730

这可能是一个解决方案；

```
from cb in ClipBooks
where cb.BookID == 4
select cb.Clip; 
```

或者

```
ClipBooks.Where(cb => cb.BookId == 4).Select(cb => cb.Clip); 
```

# xml - XML Schema：使多次出现的标签的值唯一

> ID：289635
> 
> 赞同：2
> 
> 时间：2008-11-14T09:43:39.507
> 
> 标签：xml, xsd

我有这个 XML 模式...

```
<module>
   <promo>
      <day>1</day>
      <day>2</day>
   </promo>
   <promo>
      <day>3</day>
      <day>4</day>
   </promo>
   <promo>
      <day>Default</day>
   </promo>
</module> 
```

我想阻止用户将相同的值放入`<day>`标签中任何位置的2 个标签中`<module>`。

我目前可以使用`<xsd:unique>`标签来做到这一点，但这不允许我`<day>`在一个标签中有两个标签`<promo>`。

我也可以使用该属性`base="xs:ID"`，但这不允许该值以数字开头。

任何帮助深表感谢。

问候，汤姆。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-14T12:22:22.167

这是我的问题的答案。将 xs:unique 标记设置为此...

```
<xsd:unique name="day">
    <xs:selector xpath="promo/day" />
    <xs:field xpath="." />
</xsd:unique> 
```

在“模块”标签的元素声明中为我提供了我需要的功能。

问候，汤姆。

# sql - Remapping/Concatenating in SQL

> ID：289649
> 
> 赞同：0
> 
> 时间：2008-11-14T09:49:25.530
> 
> 标签：sql, mysql, concatenation

I'm trying to reorder/group a set of results using SQL. I have a few fields (which for the example have been renamed to something a bit less specific), and each logical group of records has a field which remains constant - the address field. There are also fields which are present for each address, these are the same for every address.

```
id  forename    surname     address
1   John        These       Address1
2   Lucy        Values      Address1
3   Jenny       Are         Address1
4   John        All         Address2
5   Lucy        Totally     Address2
6   Jenny       Different   Address2
7   Steve       And         Address2
8   Richard     Blah        Address2

address     John    Lucy            Jenny       Steve       Richard
Address1        These   Values          Are         (null)      (null)
Address2        All     Totally         Different   And         Blah 
```

For example: John,Lucy,Jenny,Steve and Richard are the only possible names at each address. I know this because it's stored in another location.

Can I select values from the actual records in the left hand image, and return them as a result set like the one on the right? I'm using MySQL if that makes a difference.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T11:36:44.910

Assuming that the column headings "john", "lucy" etc are fixed, you can group by the address field and use if() functions combined with aggregate operators to get your results:

```
select max(if(forename='john',surname,null)) as john,
       max(if(forename='lucy',surname,null)) as lucy,
       max(if(forename='jenny',surname,null)) as jenny,       
       max(if(forename='steve',surname,null)) as steve,       
       max(if(forename='richard',surname,null)) as richard,
       address
from tablename 
group by address; 
```

It is a bit brittle though.

There is also the group_concat function that can be used (within limits) to do something similar, but it will be ordered row-wise rather than column-wise as you appear to require.

eg.

```
select address, group_concat( concat( forename, surname ) ) tenants 
from tablename
group by address; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T09:55:01.667

I'm not certain, but I think what you're trying to do is GROUP BY.

```
SELECT Address,Name FROM Table GROUP BY Name 
```

if you want to select more columns, make sure they're included in the GROUP BY clause. Also, you can now do aggregate functions, like MAX() or COUNT().

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T09:55:13.460

I am not sure about the question, but from what I understand you can do:

```
SELECT concat(column1,column2,column3) as main_column, address from table; 
```

# google-visualization - 谷歌图表数据编码

> ID：289653
> 
> 赞同：2
> 
> 时间：2008-11-14T09:51:36.323
> 
> 标签：google-visualization

我最近开始研究 Google Charts API 是否可以在我正在开发的产品中使用。在为给定图表构建 URL 时，可以以三种不同的格式指定数据点：未编码、使用简单编码和使用扩展编码 ( [http://code.google.com/apis/chart/formats.html](http://code.google.com/apis/chart/formats.html) )。但是，似乎无法绕过这样一个事实，即为数据点指定的最高值是使用扩展编码，在这种情况下是 4095（结尾为“..”）。

我在这里遗漏了什么还是这个限制是真的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-14T09:53:07.693

使用 Google Chart API 时，您通常需要自己缩放数据，使其适合 API 要求的 0-4095 范围。

例如，如果您的数据值介于 0 到 1,000,000 之间，那么您可以将所有数据除以 245，使其适合可用范围 (1000000 / 245 = 4081)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T23:18:24.930

根据数据缩放，这也可以帮助您：

[http://code.google.com/apis/chart/formats.html#data_scaling](http://code.google.com/apis/chart/formats.html#data_scaling)

注意 chds 参数选项。

您可能还希望考虑利用包装 API 来抽象出其中一些丑陋的细节。它们在这里列出：

[http://groups.google.com/group/google-chart-api/web/useful-links-to-api-libraries](http://groups.google.com/group/google-chart-api/web/useful-links-to-api-libraries)

我编写了[charts4j](http://code.google.com/p/charts4j/)，它具有帮助您处理数据缩放的功能。

# svn - 从 Subversion 损坏中恢复

> ID：289663
> 
> 赞同：5
> 
> 时间：2008-11-14T09:56:07.000
> 
> 标签：svn, recovery, corruption

颠覆中出了点问题，现在我面临

```
svnadmin: Invalid diff stream: [tgt] insn 0 starts beyond the target view position 
```

如果我尝试从存储库进行转储。我们在这里有另一个问题[Subversion Repository Error](https://stackoverflow.com/questions/245308/subversion-repository-error)，但是那里的解决方案对我来说还不够好，因为损坏是 85 次修订。

因为损坏在一个不太重要的目录中（不在主干/分支/标签中），所以我在考虑两种解决方案：

1.  从健康部分创建转储，并将其导入新存储库后，重要目录的提交差异（丢失所有修订历史记录）
2.  从健康部分创建一个转储并编写一个 ruby​​ 脚本，该脚本将检查旧存储库中所需目录的每个修订版。这将为修订创建一个差异文件，并将其提交到带有作者姓名和原始评论的新存储库。

任何意见？:)

/亚努斯西姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-15T00:53:52.587

如果您确实需要访问您的资源，我建议您向 users@subversion.tigris.org 发送邮件，说明您的问题。阅读该列表的一些用户在恢复损坏的存储库方面有经验。（在许多情况下，由于恢复源代码通常需要保密协议，因此未在列表中报告）

创建您可以访问的所有有效修订的转储文件不会造成损害，并且可能有助于恢复。

# keyboard - 如何设置 vim 以根据 CAPS LOCK 是否打开自动更改背景颜色？

> ID：289665
> 
> 赞同：11
> 
> 时间：2008-11-14T09:58:28.087
> 
> 标签：keyboard, vim

我是一个狂热的 vim 用户，最近开始编写一些 SQL 代码。我喜欢用 CAPS 编写我的 SQL 语句，有时会忘记关闭`CapsLock`“关闭”，然后我很快就在我意识到发生了什么之前对我的代码造成了严重破坏。

到目前为止`CapsLock`，除了查看我的键盘（这需要我将视线从屏幕上移开，我认为这是一个很大的延迟）之外，我还没有找到任何方法来判断按键是否打开。

理想情况下，我希望 vim 在`CapsLock`“打开”时自动更改我的背景颜色，但我愿意接受其他屏幕上的`CapsLock`状态指示器作为妥协。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T08:00:25.330

建议将小写字母映射到大写的人是正确的，但我们需要添加更多细节。诀窍是将*SQL 关键字*映射为大写。然后你可以用小写字母输入它们，vim 会帮你把它们转换成大写字母。这是使用缩写而不是映射来完成的。例如，如果您创建缩写

```
:iab ATT American Telephone and Telegraph 
```

那么每次你在代码中输入 'ATT' 时，只要你按下空格键，Vim 就会自动将其翻译成 'American Telephone and Telegraph'。（试试看！很有趣！）

因此，创建一个新文件并开始输入所有 SQL 关键字的缩写。

```
iab select SELECT
iab like LIKE
iab where WHERE
... 
```

由于您只希望在编辑 SQL 源代码时应用这些缩写，因此将此文件保存到 ~/.vim/after/ftplugin/sql.vim 当 Vim 检测到它打开了一个 SQL 文件时，将执行此文件中的命令。

文件类型检测只有在你打开它时才有效，所以确保你的 .vimrc 有如下行：

```
set nocompat
filet detect plugin on 
```

一旦你完成了这项工作，你应该节省时间*并*减少一直按住 shift 键的腕管！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-14T13:08:37.377

你能得到的最接近的是肯特的答案。Vim 看不到`CapsLock`（或`NumLock`，或`ScrollLock`，或任何其他修饰键本身），因为这些键的状态不是通过终端发送的。

请注意，理论上 gVim 可以看到这些修饰符，但实际上却看不到。gVim 的键盘处理在许多其他方面都优于 vim。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-14T10:28:26.640

我所做的是将我的大写锁定键绑定到“撰写”键，所以我的大写锁定键实际上丢失了，我只是强迫自己使用 SHIFT 代替。:)

您*可能*想尝试一下，这听起来可能有点自虐，但从长远来看会更好。有人认为大写锁定是多余的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-14T12:38:58.717

~~我能给你的最好的方法是让 vim 在 vi​​m 中按下 CAPSLOCK 键时切换背景颜色。~~

Vim 不能单独检测 CAPSLOCK 键。我能给你的是一个映射，所以你可以使用其他键（在本例中为 F3）来充当插入模式的 CAPSLOCK 键，并在全大写打开时更改背景颜色。希望这将为您提供所需的功能。

将以下内容放入您的 ~/.vimrc 或适当的 ~/.vim/ftplugin/ **<filetype>** .vim 中：

```
 " let the case be toggled in normal mode
    map <expr> <F3> ToggleInsertCase()
    " let the case be toggled in insert mode
    imap <expr> <F3> ToggleInsertCase()

    let toUpper = 0
    func! ToggleInsertCase() 
        let g:toUpper = 1 - g:toUpper
        if (g:toUpper == 1)
            highlight Normal ctermbg=Blue " the background color you want when uppercased
            " convert all the letters to uppercase in insert mode
            let i = char2nr('a')
            while i <= char2nr('z')
                let c = nr2char(i)
                exe 'inoremap' c toupper(c)
                let i = i + 1
            endwhile
        else
            highlight Normal ctermbg=Black " the background color you want normally
            " let letters be as normal in insert mode
            let i = char2nr('a')
            while i <= char2nr('z')
                let c = nr2char(i)
                exe 'iunmap' c 
                let i = i + 1
            endwhile
        endif
        " don't insert anything when this function is called in normal mode
        return ""
    endfunc 
```

这从[Tim Pope 的 capslock.vim](http://www.vim.org/scripts/script.php?script_id=1725)中借用了一些。

如果你真的想为此使用 CAPSLOCK 键，取决于你的平台，有一堆免费的应用程序可以让你将你的 CAPSLOCK 键重新映射到其他东西，所以你可以设置它，以便当你点击 CAPSLOCK 时，vim（和其他一切）得到了F3。管他呢。这会干扰其他应用程序获取 CAPSLOCK 键（除非键重新映射器应用程序很聪明），所以这可能很麻烦。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T13:32:35.550

为什么不为包含 imap 命令的 .sql 文件提供文件类型插件，以将所有击键转换为大写字母。这样，您就不必在键盘上切换实际的大写锁定键，当您返回代码时一切都会好起来的。

在文件 $VIM/vimfiles/ftplugin/sql_too.vim 中添加以下内容：

```
imap a A
imap b B
imap c C
imap d D
imap e E
imap f F
imap g G
imap h H
imap i I
imap j J
imap k K
imap l L
imap m M
imap n N
imap o O
imap p P
imap q Q
imap r R
imap s S
imap t T
imap u U
imap v V
imap w W
imap x X
imap y Y
imap z Z 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-05T00:06:43.500

我同意 Kent 的观点，并将 Caps Lock 键重新映射到控制键。我在 Windows 机器上使用 AutoHotKey 来执行此操作，但是[这里](http://www.usnetizen.com/fix_capslock.php)和许多其他地方都描述了注册表设置。如果您不使用 Windows，您还可以轻松地在 MacOS 和 unix X 窗口平台上重新映射大写锁定键。

**不**意外地锁定大写的便利性远远超过了我一年中真正想要的几次！

# javascript - Ajax“有新内容吗？如果有，更新页面” - 如何在不破坏服务器的情况下做到这一点？

> ID：289667
> 
> 赞同：9
> 
> 时间：2008-11-14T09:59:09.757
> 
> 标签：javascript, mysql, ajax, comet

这是一个简单的 javascript 案例，它不断询问“还有吗？” 就像一个四岁的孩子开车一样。但是，就像父母一样，如果你经常这样做，或者一次有太多孩子，服务器会在压力下崩溃。

您如何解决网页以每 5 秒的顺序查找新内容并允许更多访问者的问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-14T10:12:02.037

stackoverflow 以某种方式做到这一点，但不知道如何。

更标准的方式确实是每隔几秒钟寻找新内容的 javascript。

更高级的方法是使用类似[推送的](http://en.wikipedia.org/wiki/Push_technology)技术，通过使用[Comet](http://en.wikipedia.org/wiki/Comet_(programming))技术（长轮询等）。该链接下有很多有趣的东西。

我还在等待一个自己使用它的好机会......

哦，这里有一个来自 stackoverflow 的链接：
[有什么方法可以将数据从 Web 服务器推送到浏览器？](https://stackoverflow.com/questions/19995/is-there-some-way-to-push-data-from-web-server-to-browser)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T10:27:39.883

在 Java 中，我使用 Comet 技术使用 Ajax 库 (DWR) - 我认为您应该使用它在 PHP 中搜索库。这个想法是服务器正在发送一个非常长的 Http 响应，当它有东西要发送给客户端时，它会结束它并发送带有更新数据的新响应。使用它客户端不必每隔 x 秒 ping 服务器来获取新数据 - 我认为它可以帮助你。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-14T12:07:14.723

您可以根据客户端的数量使轮询时间可变。用你的比喻，孩子问“我们到了吗？” 司机回答“不，但可能在一小时内”。值得庆幸的是，Javascript 不是一个顽固的孩子，所以你可以确定他在那之前不会打扰你。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-14T12:13:35.193

您可以考虑开始每 5 秒轮询一次，但过一段时间开始增加轮询间隔时间 - 可能达到某个上限（1 分钟、5 分钟 - 任何看起来最适合您的使用）。增加不一定是线性的。

一个更复杂的旋转（可以结合 monzee 的建议以根据客户端数量而变化）是允许服务器在下一次轮询之前指定间隔。然后，服务器可以随着时间的推移增加间隔，您甚至可以动态更改算法，或响应网络负载。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-14T10:17:46.830

你可以看看 python 中的[“Twisted”](http://twistedmatrix.com/trac/)框架。它是事件驱动的网络编程框架，可能满足您的需求。它可用于从服务器推送消息。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-14T10:18:58.030

也许您可以将查询发送到一个真正简单的脚本，它不需要进行真正的数据库查询，而只使用一个简单的时间戳来判断是否有任何新内容。

然后，如果答案是真的，你可以做一个真正的查询，服务器必须做真正的工作！-)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-14T12:29:08.487

我将有一个调用数据库的实例，如果存在更新的时间戳，则将该新时间戳放入应用程序变量中。然后让所有会话检查该应用程序变量。或类似的东西。这样只有一个实例在调用 sql-server，客户端的数量无关紧要。

我还没有尝试过，这只是头顶上的第一个想法，但我认为兑现时间戳并让客户检查兑现是一种方法，以及如何实现兑现（sql-server-cash，应用程序变量等等）我不知道什么是最好的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-14T18:45:30.927

关于 SO 是如何做到的，请注意它不会持续检查新答案，只有当您输入“您的答案”框时。

那么，关键是首先进行计算成本低的操作以清除常见的“不需要更新”情况（例如，输入新答案或检查时间戳），然后再启动更昂贵的过程来实际检索任何更改。

或者，根据您的应用程序，您可以通过优化更改发布机制来解决此问题。例如，将更改（或它们的摘要）放在 RSS 提要上并让客户观看提要而不是真正的应用程序也许是可行的。我们可以假设这将是相当有效的，因为它正是 RSS 设计和优化的那种东西，而且它还有一个额外的好处，就是使您的应用程序与世界其他地方的互操作性更高，而成本很低或没有成本你。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-15T17:45:00.080

我相信该方法应该基于服务器端套接字和客户端 ajax/comet 的组合。像：

假设一个聊天应用程序有多个登录用户，并且每个用户都通过对服务器端侦听器脚本的慢负载 AJAX 调用进行侦听。

无论浏览器获取刚刚输入的数据，都会通过对编写器脚本的 ajax 调用将其提交给服务器。该服务器更新数据库（或存储系统）并将套接字写入通知的侦听器脚本。然后后者获取新数据并将其发送回客户端浏览器。

现在我还没有写这个，现在我不知道两个并发连接的浏览器限制是否/如何破坏上述逻辑。

将不胜感激在这里听到任何有想法的人。

作为

# python - 使用 py2exe 编译我的 python 程序时如何使用我的图标？

> ID：289668
> 
> 赞同：4
> 
> 时间：2008-11-14T09:59:48.927
> 
> 标签：python, py2exe

在编译 python 程序以使用我的图标时，我不知道在 setup.py 文件中输入什么命令。谁能帮我？提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-14T11:03:57.707

```
from distutils.core import setup
import py2exe
setup(
        windows=[{"script": 'app.py', "icon_resources": [(1, "icon.ico")]}],
        options={"py2exe":{"unbuffered": True,
                        "optimize": 2,
                        "bundle_files" : 1,
                        "dist_dir": "bin"}},
                        zipfile = "lib.zip", 
) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-14T10:34:53.787

我还没有尝试过，但这是我找到的链接：

[http://www.py2exe.org/index.cgi/CustomIcons](http://www.py2exe.org/index.cgi/CustomIcons)

# delphi - 在对象检查器上显示 TFrame 后代的附加属性

> ID：289672
> 
> 赞同：11
> 
> 时间：2008-11-14T10:02:25.723
> 
> 标签：delphi, tframe

Delphi 对象检查器没有按设计显示 TFrame 后代的附加属性。人们倾向于建议使用通常用于在对象检查器上显示 TForm 后代属性的已知技巧。诀窍是：通过设计时包将 TForm 后代的自定义模块注册到 Delphi IDE，例如：

```
RegisterCustomModule(TMyFrame, TCustomModule); 
```

对象检查器可以通过这种方式显示 TFrame 后代实例的其他属性，但它在嵌入表单时会丢失其帧行为。不可重新设计，无法为其子组件实现事件，并且它接受子控件（它不能）。但它在自己的设计区域中表现正常。

看起来，Delphi IDE 专门为 TFrame 提供的那些行为。它们可能不是一种通用设施。

有没有其他方法可以在不丢失帧行为的情况下做到这一点？

我正在使用德尔福 2007

* * *

@Tondrej，

阅读问题的评论，在此先感谢。

框架单元.dfm：

```
object MyFrame: TMyFrame
  Left = 0
  Top = 0
  Width = 303
  Height = 172
  TabOrder = 0
  object Edit1: TEdit
    Left = 66
    Top = 60
    Width = 151
    Height = 21
    TabOrder = 0
    Text = 'Edit1'
  end
end 
```

* * *

```
unit frameunit;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms, 
  Dialogs, StdCtrls;

type
  TBaseFrame = Class(TFrame)
  protected
    Fstr: string;
    procedure Setstr(const Value: string);virtual;
  published
    Property str:string read Fstr write Setstr;
  End;

  TMyFrame = class(TBaseFrame)
    Edit1: TEdit;
  private
    // This won't be called in designtime. But i need this to be called in designtime
    Procedure Setstr(const Value: string);override;
  end;

implementation

{$R *.dfm}

{ TBaseFrame }

procedure TBaseFrame.Setstr(const Value: string);
begin
  Fstr := Value;
end;

{ TMyFrame }

procedure TMyFrame.Setstr(const Value: string);
begin
  inherited;
  Edit1.Text := Fstr;
  // Sadly this code won't work and Edit1 won't be updated in designtime.
end;

end. 
```

* * *

```
unit RegisterUnit;

interface

procedure Register;

implementation

uses
  Windows, DesignIntf, frameunit;

procedure Register;
var
  delphivclide: THandle;
  TFrameModule: TCustomModuleClass;
begin
  delphivclide := GetModuleHandle('delphivclide100.bpl');
  if delphivclide <> 0 then
  begin
    TFrameModule := GetProcAddress(delphivclide, '@Vclformcontainer@TFrameModule@');
    if Assigned(TFrameModule) then
    begin
      RegisterCustomModule(frameunit.TBaseFrame, TFrameModule);
      // Just registering that won't cause Tmyframe to loose its frame behaviours
      // but additional properties won't work well.

      //RegisterCustomModule(frameunit.TMyFrame, TFrameModule);  
      // That would cause Tmyframe to lose its frame behaviours
      // But additional properties would work well.

    end;
  end;
end;

end. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-14T12:32:49.693

您正在为您的框架注册哪个自定义模块类？您使用的是哪个版本的 Delphi？

从我对 Delphi 2007 的实验来看，似乎可以工作的自定义模块类是 TFrameModule。该类包含在 delphivclide100.bpl 中。由于没有相应的 delphivclide.dcp，您必须手动加载它：

```
unit FrameTestReg;

interface

procedure Register;

implementation

uses
  Windows, DesignIntf,
  FrameTest;

procedure Register;
var
  delphivclide: THandle;
  TFrameModule: TCustomModuleClass;
begin
  delphivclide := GetModuleHandle('delphivclide100.bpl');
  if delphivclide <> 0 then
  begin
    TFrameModule := GetProcAddress(delphivclide, '@Vclformcontainer@TFrameModule@');
    if Assigned(TFrameModule) then
      RegisterCustomModule(TTestFrame, TFrameModule);
  end;
end;

end. 
```

我的 FrameTest 单元很简单，它没有 FrameTest.dfm，只有新 TFrame 后代的声明：

```
unit FrameTest;

interface

uses
  Forms;

type
  TTestFrame = class(TFrame)
  private
    FHello: string;
  published
    property Hello: string read FHello write FHello;
  end;

implementation

end. 
```

使用 TFrameModule 类，到目前为止一切似乎都运行良好。我可以创建 TTestFrame 的新后代以包含在项目中并在 Object Inspector 中编辑其发布的属性，将这个新后代的实例放在 IDE 中的表单上，在 Object Inspector 中编辑它们新发布的属性，编写事件处理程序他们的子组件等。在 .dfm 资源中，我可以看到实例的预期“内联”指令。到目前为止，我还没有遇到任何问题，所以也许这就是解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-06-23T10:28:35.523

没有必要以“黑客方式”做

```
uses
...
  DMForm,
  VCLFormContainer,
...

procedure Register;
begin
...
  RegisterCustomModule(TYourFrameClass, TFrameModule);   // for frames
  RegisterCustomModule(TYourModuleClass, TDataModuleCustomModule);   // for data modules
...
end; 
```

还有另一种添加框架的方法

```
type
  TNestableWinControlCustomModule = class (TWinControlCustomModule)
  public
    function Nestable: Boolean; override;
  end;

function TNestableWinControlCustomModule.Nestable: Boolean;
begin
  Result := True;
end; 
```

+

```
 RegisterCustomModule(TYourFrameClass, TNestableWinControlCustomModule); 
```

**单位名称（在 XE7 中测试）：**

**TCustomModule** =>设计编辑器

 **TDataModuleCustomModule => **DMForm** (designide.dcp)

TWinControlCustomModule => **WCtlForm** (designide.dcp)

TFrameModule => **VCLFormContainer** (vcldesigner.dcp)

**我想对于*FireMonkey*应该可以以类似的方式进行**（查找*fmxdesigner.dcp*并检查 Notepad++ 中的内容）

**PS。**在较旧的 Delphi 版本中，单元 DMDesigner 中有 TDataModuleDesignerCustomModule 元类而不是**TDataModuleCustomModule**

**聚苯乙烯。**其他现有的元类名称：

TCustomFormCustomModule

TIDESourceModuleCustomModule

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T12:27:24.060

不，我不认为这是完全可能的。

当我有类似需求时，我通常会做的就是简单地将框架后代安装为它自己的组件。但是，是的，这样你会失去很多典型的框架行为（尤其是在设计时），例如你不能再直接操作子组件并且对框架的​​更改不再自动传播到在设计时使用它的表单 - 你有首先重新编译包含框架的运行时包。

再说一次，从 OOP 的角度来看，这还不算太糟糕。它实际上强化了实现隐藏的概念。您仍然可以通过框架本身的新属性和方法公开子组件的各个属性和功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-11T04:22:36.760

```
procedure TMyFrame.Setstr(const Value: string);
begin
  inherited;
  Edit1.Text := Fstr;
  // Sadly this code won't work and Edit1 won't be updated in designtime.
end; 
```

我认为这是因为它不应该在设计时工作。您将 TBaseFrame 注册为自定义模块，因此 TBaseFrame 的（不是它的后代！！！）属性在设计时应该是可编辑的。Delphi IDE 只知道您注册的类的已发布属性；它对您在项目中所做的任何后代和覆盖一无所知。要使代码在设计时工作，您应该将其包含在 TBaseFrame 定义中：

```
procedure TBASEFrame.Setstr(const Value: string);
begin
  inherited;
  Edit1.Text := Fstr; 
end; 
```

或者（除了 TBaseFrame）将 TMyFrame 定义注册为自定义模块。

试着理解：设计时的 Delphi IDE 只知道已经在其中注册的东西。这不是障碍；这是合乎逻辑的行为。

# mfc - MFC 对话框中的父通知

> ID：289674
> 
> 赞同：3
> 
> 时间：2008-11-14T10:03:54.287
> 
> 标签：mfc

我有第一个对话框，上面有一个简单的按钮，单击按钮时，使用 CDialog::Create(IDD,this) 创建了第二个对话框。我希望在第二个对话框被销毁时通知父级，但不向第二个对话框添加任何代码，即不在 OnDestroy 方法中添加 m_pParent->Notify() 行。我在父对话框中尝试了 OnParentNotify、PreTranslateMessage、SubclassWindow，但没有成功。我没有在第二个对话框中使用 WS_CHILD 样式。任何的想法？

完成：事实上，我有一个 ComboBox 派生类（但问题与按钮相同）并且我正在显示一个无模式对话框而不是显示列表框。但我希望控件尽可能通用，以便可以使用任何无模式对话框。这就是我不想在第二个对话框中添加特定通知的原因。如果我有义务，我会使用这个技巧，但我要求一个更通用的解决方案。PreTranslateMessage 仅捕获 WM_PAINT、WM_NCMOUSELEAVE 和 WM_NCMOUSEMOVE。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T21:09:09.357

使用基类并让您的父母仅按基类引用无模式的孩子。在基础 PostNcDestroy 中将其发布给父级。

It doesn't make sense to have the parent do a bunch of filtering / spying on all messages. It does make sense to implement behavior in a base class that you want to have common to all the different future flavors you might have of the modeless child.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T12:39:33.067

OnParentNotify() 未被调用，因为 dialog2 不是 dialog1 的子项。

PreTranslateMessage() 在这里应该有所帮助（尽管我不喜欢这个项目符号）。诀窍是无模式对话框在关闭时不会自行销毁。如果您希望对话框终止，它必须在关闭时调用 DestroyWindow()，例如在 OnCancel() 覆盖中。

当然，首先想到的就是为什么不想在无模式对话框代码中添加自定义通知。

编辑：另一种方法是安装一个消息挂钩（对于当前线程，而不是整个系统！）。这将帮助您捕获与 dialog1 相同的线程关联的所有窗口的所有消息。请参见[SetWindowsHookEx()](http://msdn.microsoft.com/en-us/library/ms644990%28VS.85%29.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T12:38:40.010

将主父表单事件发布到消息队列怎么样？

# sqlite - SQLite中2个日期之间的差异

> ID：289680
> 
> 赞同：131
> 
> 时间：2008-11-14T10:08:31.717
> 
> 标签：sqlite

如何获得 SQLite 中 2 个日期之间的天数差异？我已经尝试过这样的事情：

```
SELECT Date('now') - DateCreated FROM Payment 
```

它每次都返回 0。

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2008-11-14T10:11:37.313

```
 SELECT julianday('now') - julianday(DateCreated) FROM Payment; 
```

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2015-12-20T16:43:51.113

**天数差异**

```
Select Cast ((
    JulianDay(ToDate) - JulianDay(FromDate)
) As Integer) 
```

**小时差异**

```
Select Cast ((
    JulianDay(ToDate) - JulianDay(FromDate)
) * 24 As Integer) 
```

**分钟差异**

```
Select Cast ((
    JulianDay(ToDate) - JulianDay(FromDate)
) * 24 * 60 As Integer) 
```

**以秒为单位的差异**

```
Select Cast ((
    JulianDay(ToDate) - JulianDay(FromDate)
) * 24 * 60 * 60 As Integer) 
```

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2013-02-09T19:12:17.243

这两个答案都提供了更复杂的解决方案，因为它们需要。假设付款是在 上创建的`January 6, 2013`。我们想知道这个日期和今天之间的区别。

```
sqlite> SELECT julianday() - julianday('2013-01-06');
34.7978485878557 
```

相差34天。我们可以使用`julianday('now')`以获得更好的清晰度。换句话说，我们不需要把 函数`date()`或`datetime()`函数作为参数来`julianday()` 运行。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2008-11-17T14:21:18.383

SQLite 文档是一个很好的参考，[DateAndTimeFunctions](https://www.sqlite.org/lang_datefunc.html)页面是一个很好的书签。

记住使用 sqlite 命令行实用程序处理查询非常容易，这也很有帮助：

```
sqlite> select julianday(datetime('now'));
2454788.09219907
sqlite> select datetime(julianday(datetime('now')));
2008-11-17 14:13:55 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2016-12-08T19:54:46.437

这个答案有点冗长，文档不会告诉你这一点（因为他们假设你将日期作为 UTC 日期存储在数据库中），但这个问题的答案很大程度上取决于你的日期存储的时区在。您也不使用`Date('now')`，而是使用该`julianday()`函数来计算两个日期与一个共同的日期，然后减去这些结果的差异。

如果您的日期以 UTC 格式存储：

```
SELECT julianday('now') - julianday(DateCreated) FROM Payment; 
```

这是排名靠前的答案，也在[文档](http://sqlite.org/lang_datefunc.html)中。如果您问我，这只是图片的一部分，并且是一个非常简单的答案。

如果您的日期存储在本地时间，使用上面的代码将使您的答案**错误**，因为您的 GMT 偏移量是小时数。如果您像我一样在美国东部，即 GMT -5，您的结果将增加 5 小时。如果您因为违反 GMT 日期而尝试`DateCreated`遵守 UTC ：`julianday('now')`

```
SELECT julianday('now') - julianday(DateCreated, 'utc') FROM Payment; 
```

`DateCreated`这有一个错误，它会在夏令时（3 月至 11 月）期间增加一个小时。假设“现在”是在非 DST 日的中午，并且您在 6 月（在 DST 期间）中午创建了一些东西，您的结果将在小时部分中间隔 1 小时，而不是 0 小时。您必须在应用程序代码中编写一个函数来显示结果以修改结果并从 DST 日期中减去一个小时。我这样做了，直到我意识到我遇到的那个问题有一个更好的解决方案： [SQLite vs. Oracle - 计算日期差异 - 小时](https://stackoverflow.com/questions/41007455/sqlite-vs-oracle-calculating-date-differences-hours)

相反，正如向我指出的那样，对于存储在本地时间的日期，使两者都与本地时间匹配：

```
SELECT julianday('now', 'localtime') - julianday(DateCreated) FROM Payment; 
```

或附加`'Z'`到当地时间：

```
julianday(datetime('now', 'localtime')||'Z') - julianday(CREATED_DATE||'Z') 
```

这两者似乎都可以补偿并且不会为 DST 日期添加额外的小时并进行直接减法 - 因此在 DST 日中午创建的项目，在非 DST 日中午检查时，不会得到额外的小时执行计算。

虽然我知道大多数人会说不要在数据库中存储当地时间的日期，并将它们存储在 UTC 中，这样你就不会遇到这种情况，但并不是每个应用程序都有全球受众，也不是每个程序员都想要每次他们在数据库中执行 GET 或 SET 并处理确定某些内容是本地的还是 UTC 时，都将系统中的每个日期转换为 UTC 并再次返回。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2018-04-15T12:53:57.923

鉴于您的日期格式如下：“YYYY-MM-DD HH:MM:SS”，如果您需要找出两个日期之间的月数差异：

`(strftime('%m', date1) + 12*strftime('%Y', date1)) - (strftime('%m', date2) + 12*strftime('%Y', date2))`

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-08-11T16:26:02.900

只是编写时钟函数的注释。对于那些寻找工作时间的人来说，一个非常简单的更改就是将小时数加上分钟数显示为 60 的百分比，这是大多数工资单公司想要的。

`CAST ((julianday(clockOUT) - julianday(clockIN)) * 24 AS REAL) AS HoursWorked`

```
Clock In            Clock Out           HoursWorked
2016-08-07 11:56    2016-08-07 18:46    6.83333332836628 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2018-12-12T01:43:25.190

首先，不清楚您的日期格式是什么。已经有一个答案涉及`strftime("%s")`.

我喜欢扩展这个答案。

SQLite 只有以下存储类：NULL、INTEGER、REAL、TEXT 或 BLOB。为简化起见，我假设日期是真实的，包含自 1970-01-01 以来的秒数。这是一个示例模式，我将为其放入“2018 年 12 月 1 日”的示例数据：

```
CREATE TABLE Payment (DateCreated REAL);
INSERT INTO Payment VALUES (strftime("%s", "2018-12-01")); 
```

现在让我们计算一下“2018 年 12 月 1 日”和现在之间的日期差异（当我写这篇文章时，它是 2018 年 12 月 12 日中午）：

**日期差异（以天为单位）：**

```
SELECT (strftime("%s", "now") - DateCreated) / 86400.0 FROM Payment;
-- Output: 11.066875 
```

**以小时为单位的日期差异：**

```
SELECT (strftime("%s", "now") - DateCreated) / 3600.0 FROM Payment;
-- Output: 265.606388888889 
```

**以分钟为单位的日期差异：**

```
SELECT (strftime("%s", "now") - DateCreated) / 60.0 FROM Payment;
-- Output: 15936.4833333333 
```

**以秒为单位的日期差异：**

```
SELECT (strftime("%s", "now") - DateCreated) FROM Payment;
-- Output: 956195.0 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2017-03-22T12:27:58.533

如果你想要 00:00 格式的时间：我这样解决了：

```
SELECT strftime('%H:%M',
                CAST((julianday(FinishTime) - julianday(StartTime)) AS REAL),
                '12:00')
FROM something; 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-12-02T13:02:09.350

如果你想以秒为单位

```
SELECT strftime('%s', '2019-12-02 12:32:53') - strftime('%s', '2019-12-02 11:32:53') 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-03-28T05:40:59.863

如果您想要在几天之间的记录，

```
select count(col_Name) from dataset where cast(julianday("now")- julianday(_Last_updated) as int)<=0; 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-11-28T12:17:03.403

就我而言，我必须以分钟为单位计算差异，并且`julianday()`没有给出准确的值。相反，我使用`strftime()`：

`SELECT (strftime('%s', [UserEnd]) - strftime('%s', [UserStart])) / 60`

两个日期都转换为 unixtime（秒），然后减去两个日期之间的秒数。接下来，将其除以 60。

[https://www.sqlite.org/cvstrac/wiki?p=DateAndTimeFunctions](https://www.sqlite.org/cvstrac/wiki?p=DateAndTimeFunctions)

# windows - 为什么 <Ca> (CTRL+A) 在 windows 上的 gvim 下不起作用？

> ID：289681
> 
> 赞同：31
> 
> 时间：2008-11-14T10:09:18.127
> 
> 标签：windows, keyboard-shortcuts, vim

我正在尝试使用vim 下的 < Ca> ( `CTRL`+ ) 快捷方式来增加光标下的变量。`A`这在 Linux 上运行的 vim 下运行良好。但是，当我尝试在 Windows 下的 gvim 中执行此操作时，它会“全选”（即突出显示或直观地选择当前窗口中的所有文本）。如何更改此行为，或者如何恢复增量变量功能（例如，可能使用不同的键映射）？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-11-14T10:14:08.507

这是因为 mswin.vim 源自安装 vim 时生成的默认 _vimrc。只需用您在 *nix 下使用的 .vimrc 覆盖您的 _vimrc，或删除 mswin.vim。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-27T10:09:29.933

我知道我迟到了，但我想我会分享以下内容：

```
nnoremap <kPlus> <C-a>
nnoremap <kMinus> <C-x> 
```

这将增量重新映射到`+`数字小键盘上的键并减量到`-`键。这是我在自己`_vimrc`的 Windows 文件中使用的解决方案。`Ctrl`它保持了 Windows 的兼容性，也比原来的+ `A`/ `Ctrl`+更容易记住`X`。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-14T10:15:34.607

默认情况下，Windows 上的 Vim 具有专门的键映射，以使快捷键更“windows-y”。这些在 $VIMRUNTIME\mswin.vim 文件中指定，除非你禁用它，否则它会通过你的 vimrc 加载。您可以编辑 mswin.vim 文件（您可能想要编辑一个副本，将您的 vimrc 更改为使用您编辑的副本）。

我不完全确定这是一个默认的 Vim 映射，因为我可以在帮助文件中的 Ctrl+A 上找到的唯一参考是这个，它似乎没有做你所指的事情：

```
*c_CTRL-A*
CTRL-A      All names that match the pattern in front of the cursor are
              inserted. 
```

所以你可能想检查你的 Linux 框，看看是否有任何插件或任何东西改变了键映射。（当然，也可能是我找不到 Vim 帮助的适当部分。）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-01-29T17:37:52.420

在 gvim 提供的当前版本的 mswin.vim 中，该文件检查全局命名的值`skip_loading_mswin`；如果设置，则跳过文件的其余部分；因此添加就足够了

```
let skip_loading_mswin=1 
```

to`$HOME/_vimrc`和正常的 vim 绑定将在您下次启动 vim 时恢复。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-04-02T14:54:26.737

如果你只是不喜欢`Ctrl``A`行为，但对 VIM 中的其他 Windows 行为（如`Ctrl``Z`撤消）很好，只需禁用该特定行：

1.  编辑所述文件（`c:\Program Files\Vim\vim73\mswin.vim`对我而言）
2.  找到开头的段落`CTRL-A is Select all`
3.  在该段落的所有 (6) 行前面加上左括号 ( `"`)
4.  重新打开您的 GVIM 窗口。

您仍然可以通过键入“全选” `ggVG`（将光标定位在第一行，选择整行，选择直到文档的最后一行）。

快乐增量！

# sql-server - t-sql 替换文本字段

> ID：289688
> 
> 赞同：31
> 
> 时间：2008-11-14T10:13:48.633
> 
> 标签：sql-server, sql-server-2000

我遇到了一个需要对 sql 2000 数据库中的文本字段进行字符串替换的经典问题。这可能是对整个专栏的更新，也可能是我不挑剔的单个字段。

我找到了一些如何使用 updatetext 来实现它的示例，但它们往往在存储过程中，有没有人知道类似的东西被包装到一个函数中，所以我可以像通常使用 Replace() 一样使用它。对于任何不知道的人来说，Replace() 函数的问题是它不支持文本字段。

编辑：我意识到我可能会摆脱 varchar(8000) 因此已将字段交换为解决问题的这种类型。我从来没有找到真正的解决方案。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-10-26T08:52:18.383

这是使用 REPLACE 函数使用文本列更新表的示例查询。希望这对你有用。

```
UPDATE <Table> set textcolumn=
REPLACE(SUBSTRING(textcolumn,1,DATALENGTH(textcolumn)),'findtext','replacetext') 
WHERE <Condition> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-14T11:11:49.453

恐怕你不能在一个函数中做到这一点

当您尝试声明如下函数时：

```
create function dbo.textReplace(
@inText as text)
returns text
as 
begin
    return 'a' -- just dummy code
end 
```

您将收到以下错误：

```
The text data type is invalid for return values. 
```

换句话说，您不能为文本数据类型编写一个简单的 REPLACE 函数等价物

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-20T08:32:56.697

这是我在这种情况下的代码片段：

```
DECLARE @oldtext    varchar(1000)
DECLARE @newtext    varchar(1000)
DECLARE @textlen    int
DECLARE @ptr        binary(16)
DECLARE @pos        int
DECLARE @id         uniqueidentifier

SET @oldtext = 'oldtext'
SET @newtext = 'newtext'
SET @textlen = LEN(@oldtext)

DECLARE mycursor CURSOR LOCAL FAST_FORWARD
FOR
    SELECT  [UniqueID]
            ,TEXTPTR([Text])
            ,CHARINDEX(@oldtext, [Text]) - 1
    FROM    [dbo].[myTable] 
    WHERE   [Text] LIKE '%' + @oldtext +'%'

OPEN mycursor

FETCH NEXT FROM mycursor into @id, @ptr, @pos

WHILE @@fetch_status = 0
BEGIN   
    UPDATETEXT [dbo].[myTable].Text @ptr @pos @textlen @newtext

    FETCH NEXT FROM mycursor into @id, @ptr, @pos   
END

CLOSE mycursor
DEALLOCATE mycursor 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T00:29:44.963

如果要替换 ntext 字段，则必须将文本字段转换为 varchar(8000) 或 nvarchar(4000)。

MyField = REPLACE(CAST(MyField as VARCHAR(4000)), "string1", "string2")

这当然只有在您可以保证字段中的内容长度 <= 4000/8000 个字符的情况下才有效。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-13T19:22:00.147

您还可以使用 SUBSTRING() 函数，该函数在传递文本值时返回 varchar。

例如：

```
MyVarchar = SUBSTRING(myTextField, 1, DATALENGTH(myTextField)) 
```

如果要填充具有特定长度的 varchar，则可以截断以适应：

```
MyVarchar100 = SUBSTRING(myTextField, 1, 100) 
```

# asp.net-mvc - 您是否使用任何自定义 ASP.NET MVC HtmlHelper 扩展？

> ID：289692
> 
> 赞同：8
> 
> 时间：2008-11-14T10:17:13.807
> 
> 标签：asp.net-mvc, extension-methods, html-helper

我有兴趣了解**其他开发人员为 ASP.NET MVC HtmlHelper 类创建的自定义扩展**。

我认为微软**的开端不错**，但像往常一样，留下了很多**空缺**！

看起来我将不得不创建一些用于渲染图像、将动作链接渲染为图像等。

认为实际上**将列表放在一起并为其他一些开发人员节省一些时间和精力**可能是有益的，老实说，也为我节省了一些时间。=)

如果您有任何指向 HtmlHelper 类的其他扩展方法的网站链接，请提供！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-14T10:42:19.230

您应该检查 Codeplex 上的[MVC-Contrib](http://www.codeplex.com/MVCContrib)项目...

另外，我刚刚发现[这个](http://blogs.taiga.nl/martijn/archive/2008/08/27/paging-with-asp.net-mvc.aspx)HtmlHelper 的分页扩展看起来很酷，虽然我还没有使用它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-14T12:10:10.770

我写了一篇关于[在 ASP.NET MVC 中构建自定义控件](http://www.singingeels.com/Articles/Building_Custom_ASPNET_MVC_Controls.aspx)的文章，我实际上使用了我在那里构建的“汇总网格视图”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-14T18:24:14.277

我写了一篇文章来收集有用的 MVC HtmlHelpers 并与他人分享；我们可以把它长大！

看一看：[http](http://sharplife.net/2008/11/14/UsefulHtmlHelpersForASPNETMVC.aspx) ://sharplife.net/2008/11/14/UsefulHtmlHelpersForASPNETMVC.aspx （或[http://tinyurl.com/mvchelper](http://tinyurl.com/mvchelper)容易记住！）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-20T08:58:19.760

我为我在工作中做的一个项目做了很多。我能想到的那些是：

ActionImage，它是 ActionLink 和 Image 的邪恶爱子。ScriptBlock，它可以根据来自 ASP.NET 的一些参数写出一个 JavaScript 脚本块。Textile，它将采用[Textile](http://en.wikipedia.org/wiki/Textile_%28markup_language%29 "纺织品标记语言")标记中标记的字符串，并将该标记写为由[Textile 库](http://textilenet.codeplex.com/ "纺织图书馆")生成的 XHTML 。

还有一些其他更具体的方法，但我认为这是封装标签块的一种非常巧妙的方式。

# java - 如何在单元测试时重新初始化静态决赛

> ID：289702
> 
> 赞同：1
> 
> 时间：2008-11-14T10:24:23.730
> 
> 标签：java, unit-testing, testing

我正在为一个具有静态最终变量的类编写单元测试。但是，由于静态最终变量的状态在每次测试中都会被修改，所以我需要一些方法来重新初始化它。

这怎么可能？我需要使用某种自定义类加载器吗？

变量初始化为 -

```
静态最终 CountdownLatch 锁存器 = new CountdownLatch(1);

```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-14T10:59:49.163

当然，你可以通过反射或类加载来解决它，但是“如果我是你，我就不会从这里开始。” 可变静态是非常邪恶的（即使是那些被称为单例的）。因此，通过“从上面进行参数化”来更好地设计你的代码——将对象传递给需要它们的对象，而不是做一些硬连线的事情或使用目录服务。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-17T19:07:49.897

从 JDK 1.5 开始，您**可以通过反射更改静态决赛。**（有关代码示例，请参阅[此链接](http://blogs.oracle.com/vaibhav/entry/final_variables)）...但我建议您不要这样做。事实上，过去已经表明，如果可能的话，应该避免使用静态变量。Commons Logging 就是一个很好的例子。（查看[这里](http://wiki.apache.org/jakarta-commons/Logging/StaticLog)的解释）。

因此，如果可能，请摆脱*final*甚至*static*。如果这不是选项，您可以编写一个通过反射来完成的辅助函数。但这肯定是最糟糕的选择。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-14T10:29:28.710

假设您正在使用 junit 和 ant 的一种（不是非常有效的）方法。

您可以为每个测试方法创建一个单独的类，然后使用`perTest`.

正如[Ant junit 任务文档](http://ant.apache.org/manual/Tasks/junit.html)所述：

> 如果要分叉一些测试，控制创建多少 Java 虚拟机。可能的值是“perTest”（默认值）、“perBatch”和“once”。“once”只为所有测试创建一个 Java VM，而“perTest”为每个 TestCase 类创建一个新 VM。“perBatch”为每个嵌套的 <batchtest> 创建一个 VM，并为收集所有嵌套的 <test> 创建一个 VM。请注意，只有具有相同 filtertrace、haltonerror、haltonfailure、errorproperty 和 failureproperty 设置的测试才能共享一个 VM，因此即使您将 forkmode 设置为“once”，Ant 也可能需要创建多个 Java VM。对于未派生到新 Java VM 中的测试，此属性将被忽略。自蚂蚁 1.6.2

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-14T10:29:34.950

首先如何初始化静态最终变量？

也许您可以模拟初始化变量的方法？

示例： static final int number = getNumber();

通过模拟 getNumber() 方法以返回您想要的值，您可以控制“数字”变量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T10:29:58.600

我认为通过单元测试或其他方式修改“最终”变量的唯一方法是通过字节码操作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-14T10:34:59.993

编辑注释以明确指出有问题的变量是静态的，因此在 JVM 中存在一次。

标记为**final**的变量只修改过一次，这似乎在您的不同测试中发生过一次。如果您使用的是 JUnit，为什么不在每次调用 setup() 时创建一个新的类实例，它本身在每次测试之前都会被调用。这将是最快的，最能代表您的情况。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-15T08:38:07.203

静态决赛是常量，这意味着它们不是可变的。为什么用不同的值测试它们？

一个好的静态最终变量，是一个持有一些关于你的环境的状态的变量。例如，您的操作系统的变量。你甚至不会在测试中改变它。这种情况下您需要在不同的机器（或至少是虚拟机）上进行测试。

但是你想用不同的值测试这个变量。因此，这里的修饰符之一似乎是错误的，静态的或最终的，其中一个与您在这里需要的语义不匹配，否则您不想用不同的值对其进行测试。

您能否提供有关该问题的更多详细信息？

# c# - 如何在 Delphi 和 C# 中格式化复合语句？

> ID：289712
> 
> 赞同：9
> 
> 时间：2008-11-14T10:31:12.920
> 
> 标签：c#, delphi, coding-style, code-formatting

作为一个长期的 Pascal 和 Delphi 开发人员，我总是这样排列我的开始和结束：

```
begin
  if x = y then
  begin
     ...
     ...
  end
  else
    for i := 0 to 20 do
    begin
      ...
      ...
    end;
end; 
```

让我抓狂的是代码格式如下：

```
begin
  if x = y then begin
     ...
     ...
  end
  else
    for i := 0 to 20 do begin
      ...
      ...
    end;
end; 
```

当有几个层次的复合语句时，我发现这很难阅读。上面的代码没问题，因为它并没有那么复杂，但是为了保持一致性，我希望所有的开始和结束都对齐。

当我开始使用 c# 时，我发现自己也在对齐大括号。C# 世界的标准是什么？

**编辑 ：**

有人指出，这是不应该在 SO 上提出的问题类型。我不明白为什么不。我正在建立一个编码指南文档。我知道我会对某些事情产生一些阻力，我希望在这里能得到一些答案，这样我就可以准备好正面应对这种阻力。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-14T13:36:46.117

我个人使用：

```
if Condition then
begin
  DoThis;
end else
begin
  DoThat;
end; 
```

请参阅[对象 Pascal 样式指南](http://dn.codegear.com/article/10280#8.2.3)。

> 在复合 if 语句中，将每个元素分隔语句放在一个新行上： 示例：

```
// INCORRECT
if A < B then begin
  DoSomething; 
  DoSomethingElse;
end else begin
  DoThis;
  DoThat;
end;

// CORRECT
if A < B then 
begin
  DoSomething; 
  DoSomethingElse;
end 
else 
begin
  DoThis;
  DoThat;
end; 
```

> 以下是一些被认为有效的变体：

```
// CORRECT
if Condition then
begin
  DoThis;
end else
begin
  DoThat;
end;

// CORRECT
if Condition then
begin
  DoThis;
end
else
  DoSomething;

// CORRECT
if Condition then
begin
  DoThis;
end else
  DoSomething; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-14T13:30:28.457

我曾经在 Delphi 中使用“悬空”开头：

```
if (SomeCondition) then begin
  ...
end; 
```

奇怪的是，我没有使用 C，因为我发现这更具可读性：

```
if (SomeCondition)
{
  ...
} 
```

过了一会儿，我不再尝试在这里和那里保存一行以提高可读性：

```
if (SomeCondition) then 
begin
  ...
end; 
```

我还使用显式的开始/结束块，我认为它可以提高可读性。我不需要“聪明”。我需要能够一目了然地遵循代码的意图。更重要的是，每个可能阅读/维护它的人也是如此。

```
if x = y then 
begin
  ...
  ...
end
else
begin
  for i := 0 to 20 do 
  begin
    ...
    ...
  end;
end; 
```

如果显然只有一个语句，我通常不会打扰

```
if (SomeCondition) then
  ... 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-14T13:49:19.587

我倾向于在 Delphi 中这样做：

```
if a=b then begin
  c;
end else begin
  d;
end;

if x=y then z; 
```

仅仅是因为我发现它比额外的换行符更具可读性。显然，如果我与其他人一起工作，我将使用我们同意的任何标准（或当前代码库使用的任何标准），但是当我是唯一一个正在研究它的人（如在个人项目中）时，那么我这样做。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-14T10:37:49.320

每个人都有不同的喜好。就我而言，我在学习 Pascal 之前学习了 Modula-2。Modula-2 没有 BEGIN 关键字，并且每个块都需要 END。所以代码可能看起来像这样（Modula-2 恰好对大写关键字区分大小写）：

```
IF x = y THEN
    ....
END; 
```

当我开始用 Pascal 编码时，这变成了：

```
if x = y then begin
    ....
end; 
```

通过这种方式，代码看起来更像我以前看到的，同时仍然在可接受的 Pascal 代码范围内。

对我来说，这些早期印象影响了我使用过的几乎所有其他语言的首选大括号和缩进样式。C# 代码实际上没有任何特定的“规范”，就像 C 或 Pascal 没有任何特定的“规范”一样。

唯一真正要遵循的规则是：在处理现有代码时，使用已经存在的样式。在处理新代码时，请使用您喜欢的样式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-14T14:07:24.777

C 世界中的标准是将右大括号与起始语句对齐：

```
if (I am nuts) {
    Psychiatry
} 
```

甚至将左大括号放在自己的行上：

```
if (I am nuts)
{
    Psychiatry
} 
```

在某些样式中，大括号有不同的缩进：

```
if (I am nuts)
  {
    Psychiatry
  } 
```

甚至

```
if (I am nuts)
    {
    Psychiatry
    } 
```

我在 Perl 中使用了很长时间的第一种样式，这是我对 else 延续的方式：

```
if (I am nuts) {
    Psychiatry
  } else {
    I am free
} 
```

但是在接触过 Lisp 之后，当我已经正确缩进时，我认为将大括号放在自己的行上并没有额外的价值：

```
if (I am completely nuts) {
    Psychiatry }
  else {
    I am free } 
```

不过，我不希望用这些想法来改变传统的 C 方式。

顺便说一句，Python 完全抛弃了大括号，只依赖缩进，但是在我看来，这太过分了，因为它会导致诸如 lambda 只能有一个语句这样荒谬的事情。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-14T15:55:36.807

我倾向于总是排列我的 IF 和 ELSE 并缩进我的 BEGIN/END 块。如果我有多个条件 IF，我将其分成多行。如果我发现自己越来越深入，那么我会重新考虑我正在编码的内容或重构为多种方法。所以我的代码如下所示：

```
if condition1 then
  begin
    // do something
  end
else // not condition1
  begin
    // do something else
  end; 
```

或更复杂的 if 条件。

```
if condition1 or
  condition2 or
  condition3 and
  ( condition4 or
    condition5 )
then
  begin
    // do something
  end
else // not conditions
  begin
    // do something else
  end; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-08-27T13:00:33.753

*我发现当关键词（句法和逻辑上的键*）尽可能多地暴露时，代码更具可读性。

这对我来说非常重要，以至于有时我会诉诸（IMO）非常非常规的事情。

这是它的样子：

```
if (condition) then begin
  statement;
  ...
  statement; end
else begin
  ...
end; 
```

我承认，这会使修改代码变得不那么方便。只是我`end`在语句中间发现“悬空” `if`，并且与 相同`if`，有点令人困惑。如果是`end`，它必须是最后一个（对于语句），否则我期望`else`在该位置的下一个语句的开头或开头。

`then`当块是复合的时，我通常不会让它出现，但`else`它是一个单一的语句。颠倒条件并重新排列块对我来说从来没有什么大不了的。更是如此，因为我在用`begin ... end`s 包装单个语句时非常吝啬。在我的观点和经验中，丰富的'begin-end'往往是多余的'begin-end'。虽然我喜欢当一个语句有一个明确的结尾关键字时，所以`case`和`repeat`是我一直以来的最爱。:)

关于`if`s （以及`while`s ）的另一件事是，在无数层条件的情况下，我倾向于将`then`( `do`) 放在下一行并与语句的起始关键字对齐。

像这样：

```
if (some_long_conditional_expression) or
   (some_other_long_conditional_expression) or
   (some_even_longer_conditional_expression)
then
  Exit; 
```

另外，这里已经提到了一些我不是外国人的东西，比如单线`else if`s（适当时）或`for ... do with ... do try`s（是的，这可能又与我上面提到的紧握拳头的本性有关）。

总的来说，我可能过于依赖代码高亮和缩进，尤其是后者。也许如果不是为了缩进，我宁愿总是挑出`begin`s。

还有一点：某人的格式化风格很可能是由他们的编程风格引起的。就像，有些人讨厌非常大的例程，并倾向于尽可能考虑因素，而另一些人则更喜欢专注于代码本身，而不是那些跨越屏幕的复合块——我发现这些方法非常不同，这可能会导致不同的格式化习惯.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-14T13:48:12.710

就个人而言，我更喜欢将连接语句压缩在一行上。例如`end else`在一条线上。更清楚地表明下一个语句块与当前语句相关。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-14T11:22:23.863

我永远不会那样写代码（你的第二个例子）。这将是（首选）

```
begin
  if x = y then begin
     ...
  end
  else begin
    for i := 0 to 20 do begin
      ...
   end;
  end;
end; 
```

或者

```
begin
  if x = y then begin
     ...
  end
  else for i := 0 to 20 do begin
     ...
  end; 
```

结尾;

有时我使用这种折叠（如在第二种情况下）来组合 if 和 try..finally。

```
x := GetMeTheObject;
if assigned(x) then try
  ...
finally FreeAndNil(x); end; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-17T12:10:43.030

哈！拿着这个！;)

```
try
  if Condition1
  or (    Condition2
      and Condition3) then
    begin
      DoSomething
      DoSomeMore;
    end

  else if Condition4 then // I only do this if the nested "if" has "case"-like characteristics
    begin                 // otherwise the if would obviously be indented and on its own line
      DoSomethingElse;

      if Condition5 then
        begin
          DoThisToo;
          DoFoo;
        end;
    end

  else
    DoTheWholeShebang;

  case Whatever of
    A: DoIt;

    B, C, D:
      begin
        DoSomethingSlightly;
        MoreComplicated;
      end;

  else
    begin
      DoWhatever;
      DoLastResort; 
    end;
  end;
except
  on ESomeException do
    begin
      HandleIt;
      raise;
    end;
  on ESomeOtherException do
    DealWithIt;

  else
    DoWhateverItTakes;
end; 
```

奇怪的是，在用花括号语言编写时，我也更喜欢尾括号布局：

```
if (condition) {
  doSomething;
} else {
  doSomethingElse;
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-14T14:39:32.340

有人发帖说他们会写以下内容：

```
if x=y then z; 
```

现在这个我真的不喜欢，和审美无关。让我们假设 x、y 和 z 是函数，如果我单步执行代码，上面的意思是我不能跨过 x 和 y 并进入 z。

```
1   if x=y then
2     Z; 
```

我现在可以跨入第 2 行而无需踏入第 1 行。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-14T14:53:05.620

我总是像你的例子一样排列开始/结束。（除了我在 For 语句周围还有一个 Begin/End ——以防你稍后再添加代码。）

无论如何，如果你的代码有多个层次，那么你把开始/结束放在哪里并不重要，因为它太复杂了。如果您发现自己超过了 3 个级别，请停止并简化。创建子例程来清理东西。

CodeComplete 是这方面的最佳参考书。如果你没有从那本书中学到东西，那我就吃掉我的帽子。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-14T15:14:27.403

前段时间我用

```
if <cond> then
  begin
  ShowMessage('balablala');
  exit;
  end; 
```

但现在我按照标准

```
if <cond> then
begin
  ShowMessage('balablala');
  exit;
end; 
```

如 [对象帕斯卡风格指南](http://dn.codegear.com/article/10280#8.2.3)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-11-15T01:05:23.497

这一切都很有趣。我有自己独特的对齐方式，奇怪的是，我在多种语言中都使用了这种方式，包括 Pascal、C 甚至 COBOL（虽然这种方式用不了多久）。

我想我第一次看到它是在 Ken Orr 的课上。我的版本也非常像有一个越位规则（类似于 Python 和 F#），您可以使用缩进来显示嵌套。

无论如何，这是我做这个例子的方式：

```
begin  if x = y 
       then begin (* stack to avoid getting too much indentation *)
            ...     
            ...  
            end  
       else for i := 0 to 20 
             do begin      
                ...      
                ...    
                end;
       end; 
```

是的，C/C++/Java/C# 风格类似于

```
 {  if (x == y)
          {  ...   /* Space as if 'then' is there */  
             ...  
             }
     else for (int i = 0; i<21; i++)
              {  ... /* space as if 'do' is there */
                 ...  
                 }
     } 
```

我经常使用这个。您可以像开始和结束时一样堆叠 { 和 }，但我发现能够看到边缘并确认匹配的括号和缩进组的结尾更令人愉悦。我改变以防止缩进过度，并避免有太多的“{”和“}”单独站在空白的海洋中。

我不传福音。没有人抱怨能够阅读它。将“{”放在行尾似乎是 Ratfor 预处理器的保留，类似于 Python 在某些地方需要（更令人愉快的）“:”。当我可以更有效地使用左边缘对齐时，我不想在代码中向下扫描参差不齐的右边缘。

正如我们在这里所说，YMMV

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-11-15T02:25:58.140

使用一些代码格式化程序，例如来自[http://jedicodeformat.sourceforge.net/的 JEDI 代码格式](http://jedicodeformat.sourceforge.net/)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-11-15T10:22:15.653

即使它是 中的单个语句`if`，我也总是使用复合`begin-end` 来防止将来混淆。
我也把`// if`每个`end;`.

```
if A < B then 
begin
  DoSomething; 
end; // if 
```

其他语句也一样：

```
with qryTemp do
begin
  First;

  while not Eof do
  begin
    if (A < B)
      or (C < D)
    begin
      DoSomething;
    end else
    begin
      DoSomethingElse;
    end; // if-else        

    Next;
  end; // while
end; // with 
```

对于 C#，我遵循[Java 编程语言](http://java.sun.com/docs/codeconv/html/CodeConventions.doc6.html#15395)样式复合语句的代码约定。

```
if (condition) {
    statements;
} // if 
```

```
if ((condition1 && condition2)
        || (condition3 && condition4)
        ||!(condition5 && condition6)) {
    doSomethingAboutIt();
} else {
    doSomethingElse();
} // if-else 
```

对于 Delphi 和 C#，连接逻辑运算符位于下一行的开头。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-11-15T22:16:55.100

我是周末程序员，所以，作为唯一一个在项目上工作的人，我可以不遵循特定的编码约定，我很幸运。

在代码可读性方面，Castalia 的[结构突出显示](http://www.twodesk.com/castalia/structural_highlighting.html)非常有用。[CnPack](http://www.cnpack.org/index.php?lang=en)有一个类似的功能，我没有弄错。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-07-06T12:21:40.250

在大多数情况下，只需让您的 IDE 为您缩进即可。

# c++ - std::map 中的最后一个键

> ID：289715
> 
> 赞同：59
> 
> 时间：2008-11-14T10:31:38.940
> 
> 标签：c++, iterator, stdmap

我正在寻找 std::map 的最高键值（由比较运算符定义）。

这是保证

```
map.rbegin()->first 
```

?

（我对反向迭代器有点动摇，在 std::map 的实现中有多少自由）

如果不是，请指教。我无法更改数据结构。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2008-11-14T10:45:12.080

是的。Map 是一个排序容器，反向迭代器必须以它们的键的反向（即递减）顺序返回元素。

[编辑：正如查尔斯贝利在他的回答中指出的那样，**如果它存在**，你的代码给出了最大的键- 即如果地图是非空的]

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-11-14T11:28:03.320

是的，但记得检查一下`map.rbegin() != map.rend()`。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2016-11-22T04:56:15.780

您可以使用以下方法：-

```
if(!map.empty())
    (--map.end())->first; 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2020-11-15T04:06:22.640

还有一种方法——

```
std::prev(map.end())->first; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-11-12T11:29:13.917

Map 按排序顺序存储键值对，因此我们可以通过以下方式访问最后一个元素：-

```
auto it=m.end();
it--;
int element=it->first; 
```

# cuda - CUDA内存问题

> ID：289719
> 
> 赞同：5
> 
> 时间：2008-11-14T10:33:34.443
> 
> 标签：cuda, gpgpu

我有一个 CUDA 内核，我正在编译为一个 cubin 文件，没有任何特殊标志：

```
nvcc text.cu -cubin 
```

它编译，虽然有这个消息：

> 咨询：假设全局内存空间，无法判断指针指向的内容

以及对某个临时 cpp 文件中的一行的引用。我可以通过注释掉一些对我来说毫无意义的看似任意的代码来实现这一点。

内核如下：

```
__global__ void string_search(char** texts, int* lengths, char* symbol, int* matches, int symbolLength)
{
    int localMatches = 0;
    int blockId = blockIdx.x + blockIdx.y * gridDim.x;
    int threadId = threadIdx.x + threadIdx.y * blockDim.x;
    int blockThreads = blockDim.x * blockDim.y;

    __shared__ int localMatchCounts[32];

    bool breaking = false;
    for(int i = 0; i < (lengths[blockId] - (symbolLength - 1)); i += blockThreads)
    {
        if(texts[blockId][i] == symbol[0])
        {
            for(int j = 1; j < symbolLength; j++)
            {
                if(texts[blockId][i + j] != symbol[j])
                {
                    breaking = true;
                    break;
                }
            }
            if (breaking) continue;
            localMatches++;
        }
    }

    localMatchCounts[threadId] = localMatches;

    __syncthreads();

    if(threadId == 0)
    {
        int sum = 0;
        for(int i = 0; i < 32; i++)
        {
            sum += localMatchCounts[i];
        }
        matches[blockId] = sum;
    }
} 
```

如果我更换线路

```
localMatchCounts[threadId] = localMatches; 
```

在此行的第一个 for 循环之后

```
localMatchCounts[threadId] = 5; 
```

它编译时没有任何通知。这也可以通过注释掉行上方循环的看似随机的部分来实现。我也尝试用普通数组替换本地内存数组无效。谁能告诉我问题是什么？

该系统是 Vista 64 位，物有所值。

编辑：我修复了代码，因此它实际上可以工作，尽管它仍然会产生编译器通知。警告似乎不是问题，至少在正确性方面（它可能会影响性能）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T13:34:20.727

像 char** 这样的指针数组在内核中是有问题的，因为内核无法访问主机的内存。
最好分配单个**连续**缓冲区并以支持并行访问的方式对其进行划分。
在这种情况下，我将定义一个一维数组，其中包含一个接一个地定位的所有字符串和另一个一维数组，大小为 2*numberOfStrings，其中包含第一个数组中每个字符串的偏移量及其长度：

例如 - 内核准备：

```
char* 缓冲区 = st[0] + st[1] + st[2] + ....;
int* 元数据 = new int[numberOfStrings * 2];
int lastpos = 0;
for (int cnt = 0; cnt < 2* numberOfStrings; cnt+=2)
{
    元数据[cnt] = lastpos;
    lastpos += 长度（st[cnt]）；
    元数据[cnt] = 长度（st[cnt]）；
}

```

在内核中：

```
currentIndex = threadId + blockId * numberOfBlocks;
char* currentString = 缓冲区 + 元数据[2 * currentIndex];
int currentStringLength = 元数据[2 * currentIndex + 1];

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-18T08:42:46.973

该问题似乎与 char** 参数有关。把它变成一个 char* 解决了这个警告，所以我怀疑 cuda 可能对这种形式的数据有问题。在这种情况下，也许 cuda 更喜欢使用特定的 cuda 2D 数组。

# asp.net - 如何根据主机使图像控件的 imageurl 动态化？

> ID：289720
> 
> 赞同：0
> 
> 时间：2008-11-14T10:33:37.563
> 
> 标签：asp.net

我正在尝试将我的 Web 应用程序转换为一个完全动态的系统。我想做的一件事是根据主机加载不同的徽标（在母版页模板中设置）。

但是，即使代码被命中（在 page_init 中），在任何继承母版页的页面上都没有显示图像 - 没有图像，没有红色 x，什么都没有。

我的代码看起来像这样（从母版页，图像的路径是正确的，并从 Windows 资源管理器的属性窗口路径粘贴）：

```
Protected Sub Page_Init(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Init
    If Request.Url.Host.Contains("localhost") Then
        Image1.ImageUrl = "C:\Users\firstname.lastname\Documents\Visual Studio 2008\WebSites\ecardsystem\images\ECard Platform.jpg."

    End If

End Sub 
```

我知道我可以通过代码隐藏使用文字控件即时添加图像，但这意味着我也需要手动设计 html，当设计完成并完美时。因此，这种方法将创造更多的工作。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T12:04:38.800

您是否尝试过使用相对于您网站的图像的虚拟路径？Internet Explorer 通常不会显示来自具有默认安全设置的用户本地文件系统的图像。尝试将图像放在项目中的图像目录中，并将 URL 设置为它的相对路径：

```
Image1.ImageUrl = "~/images/Card Platform.jpg." 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-21T07:10:58.033

问题是~/images/Card Platform.jpg。将转换为 c:.SiteFolder\images\card

它在本地服务器上找到图像，但是当此页面转到客户端时..说一些 xyz 人打开了同一页面...在他的机器中找不到该文件..在路径..c:.SiteFolder\images\card

更正后的答案是我们应该提供相对于站点名称的图像路径：- 像[http://localhost:88/images/card](http://localhost:88/images/card) 这样的东西......

# mysql - 用于存储布尔值的 MySQL 数据类型

> ID：289727
> 
> 赞同：1318
> 
> 时间：2008-11-14T10:36:18.870
> 
> 标签：mysql, boolean, sqldatatypes

由于 MySQL 似乎没有任何“布尔”数据类型，您“滥用”哪种数据类型在 MySQL 中存储真/假信息？

特别是在编写和读取 PHP 脚本的上下文中。

随着时间的推移，我使用并看到了几种方法：

*   tinyint，包含值 0/1 的 varchar 字段，
*   包含字符串 '0'/'1' 或 'true'/'false' 的 varchar 字段
*   最后枚举包含“真”/“假”两个选项的字段。

以上似乎都不是最佳的。我倾向于使用 tinyint 0/1 变体，因为 PHP 中的自动类型转换为我提供了相当简单的布尔值。

那么您使用哪种数据类型？有没有为我忽略的布尔值设计的类型？您是否看到使用一种或另一种类型的任何优点/缺点？

* * *

## 回答 #1

> 赞同：1320
> 
> 时间：2008-11-14T10:50:51.943

对于 MySQL 5.0.3 及更高版本，您可以使用`BIT`. 手册说：

> 从 MySQL 5.0.3 开始，BIT 数据类型用于存储位域值。一种 BIT(M) 可以存储 M 位值。M 的范围可以从 1 到 64。

否则，根据 MySQL 手册，您可以使用`BOOL`or `BOOLEAN`，它们目前是[tinyint](http://dev.mysql.com/doc/refman/5.7/en/integer-types.html) (1) 的别名：

> Bool、Boolean：这些类型是[TINYINT](http://dev.mysql.com/doc/refman/5.7/en/integer-types.html) (1) 的同义词。零值被认为是错误的。非零值被认为是真的。

MySQL 还指出：

> 我们打算在未来的 MySQL 版本中根据标准 SQL 实现完整的布尔类型处理。

参考资料：[http ://dev.mysql.com/doc/refman/5.5/en/numeric-type-overview.html](http://dev.mysql.com/doc/refman/5.5/en/numeric-type-overview.html)

* * *

## 回答 #2

> 赞同：273
> 
> 时间：2008-11-14T10:55:02.280

`BOOL`并且`BOOLEAN`是 的同义词`TINYINT(1)`。零是`false`，其他都是`true`。更多信息[在这里](https://dev.mysql.com/doc/refman/8.0/en/numeric-type-syntax.html)。

* * *

## 回答 #3

> 赞同：76
> 
> 时间：2012-02-10T18:09:21.070

这是一个我非常欣赏的优雅解决方案，因为它使用零数据字节：

```
some_flag CHAR(0) DEFAULT NULL 
```

要将其设置为 true，请设置`some_flag = ''`并将其设置为 false，请设置`some_flag = NULL`。

然后测试是否为真，检查是否为 some_flag `IS NOT NULL`，测试为假，检查是否为 some_flag `IS NULL`。

（此方法在 Jon Warren Lentz、Baron Schwartz 和 Arjen Lentz 的“高性能 MySQL：优化、备份、复制等”中进行了描述。）

* * *

## 回答 #4

> 赞同：41
> 
> 时间：2009-04-30T17:39:49.200

这个问题已经得到解答，但我想我会投入 0.02 美元。我经常使用 a `CHAR(0)`, where `'' == true and NULL == false`。

来自[MySQL 文档](https://dev.mysql.com/doc/refman/8.0/en/string-type-syntax.html)：

> `CHAR(0)`当您需要一个只能取两个值的列时，这也很不错：定义为的列`CHAR(0)` `NULL`只占用一位并且只能取值`NULL`和`''`（空字符串）。

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2008-11-14T14:59:29.757

如果您使用 BOOLEAN 类型，则别名为 TINYINT(1)。如果您想使用标准化 SQL 并且不介意该字段可能包含超出范围的值（基本上任何不为 0 的值都将是“真”），这是最好的选择。

ENUM('False', 'True') 将允许您在 SQL 中使用字符串，MySQL 将在内部将字段存储为整数，其中 'False'=0 和 'True'=1 根据 Enum 指定的顺序.

在 MySQL 5+ 中，您可以使用 BIT(1) 字段来指示 1 位数字类型。我不相信这实际上在存储中使用了更少的空间，但再次允许您将可能的值限制为 1 或 0。

以上所有将使用大约相同数量的存储空间，因此最好选择您认为最容易使用的存储空间。

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2008-11-14T10:42:51.210

我使用 TINYINT(1) 来在 Mysql 中存储布尔值。

我不知道使用它是否有任何优势...但是如果我没记错的话，mysql可以存储布尔值（BOOL）并将其存储为tinyint（1）

[http://dev.mysql.com/doc/refman/5.0/en/other-vendor-data-types.html](http://dev.mysql.com/doc/refman/5.0/en/other-vendor-data-types.html)

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2012-01-12T16:18:54.063

如果您有很多布尔字段，Bit 仅比各种字节选项（tinyint、enum、char(1)）更有优势。一个位字段仍然占用一个完整字节。两个位字段适合同一个字节。三、四、五、六、七、八。之后他们开始填充下一个字节。最终节省的成本是如此之小，您应该关注数以千计的其他优化。除非您要处理大量数据，否则这几个字节不会加起来太多。如果您在 PHP 中使用 bit，则需要对输入和输出的值进行类型转换。

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2011-07-13T17:13:59.433

在 MySQL 实现 bit 数据类型之前，如果您的处理确实需要空间和/或时间，例如处理大量事务，请创建一个调用`bit_flags`所有布尔变量的 TINYINT 字段，并在 SQL 中屏蔽和移动您想要的布尔位询问。

例如，如果您最左边的位代表您的 bool 字段，而最右边的 7 个位不代表任何内容，那么您的`bit_flags`字段将等于 128（二进制 10000000）。屏蔽（隐藏）最右边的七个位（使用按位运算符`&`），并将第 8 位向右移动七个空格，以 00000001 结尾。现在整个数字（在本例中为 1）就是您的值。

```
SELECT (t.bit_flags & 128) >> 7 AS myBool FROM myTable t;

if bit_flags = 128 ==> 1 (true)
if bit_flags = 0 ==> 0 (false) 
```

您可以在测试时运行这样的语句

```
SELECT (128 & 128) >> 7;

SELECT (0 & 128) >> 7; 
```

等等

由于您有 8 位，因此一个字节可能有 8 个布尔变量。一些未来的程序员总是会使用接下来的七位，所以你*必须*屏蔽。不要只是转变，否则你将在未来为自己和他人制造地狱。确保你让 MySQL 来做你的屏蔽和转换——这将比让 web 脚本语言（PHP、ASP 等）来做这件事要快得多。此外，请确保在您的`bit_flags`字段的 MySQL 注释字段中放置注释。

在实施此方法时，您会发现这些站点很有用：

*   [MySQL — 位函数和运算符](http://dev.mysql.com/doc/refman/5.0/en/bit-functions.html)
*   [十进制/二进制转换工具](http://acc6.its.brooklyn.cuny.edu/~gurwitz/core5/nav2tool.html)

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2012-07-09T20:10:04.210

我厌倦了试图在 PHP、MySql 和 POST 值的循环中准确地获取零、NULLS 和“”，所以我只使用“是”和“否”。

这完美无瑕，不需要不明显且容易做到的特殊处理。

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2019-05-26T17:53:19.503

由于 MySQL (8.0.16) 和 MariaDB (10.2.1) 都实现了 CHECK 约束，我现在将使用

```
bool_val TINYINT CHECK(bool_val IN(0,1)) 
```

您将只能存储`0`,`1`或`NULL`, 以及可以转换为`0`或`1`没有错误的值，如`'1'`,或/ 。`0x00``b'1'``TRUE``FALSE`

如果您不想允许 NULL，请添加`NOT NULL`选项

```
bool_val TINYINT NOT NULL CHECK(bool_val IN(0,1)) 
```

`TINYINT`请注意，使用,`TINYINT(1)`或几乎没有区别`TINYINT(123)`。

如果您希望您的架构向上兼容，您还可以使用`BOOL`或`BOOLEAN`

```
bool_val BOOL CHECK(bool_val IN(TRUE,FALSE)) 
```

[db<>小提琴演示](https://dbfiddle.uk/?rdbms=mysql_8.0&fiddle=a029601f37296a7e712c096d03d94b1d)

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2015-02-23T10:41:52.263

参考此链接 [Boolean datatype in Mysql](https://dba.stackexchange.com/questions/28422/what-is-the-benefit-of-using-boolean-over-tinyint1)，根据应用程序的使用情况，如果只想存储 0 或 1，bit(1) 是更好的选择。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2018-06-26T10:14:10.300

在阅读了这里的答案后，我决定使用`bit(1)`它，是的，它在空间/时间上更好，**但**过了一段时间我改变了主意，我再也不会使用它了。当使用准备好的语句、库等（php）时，这使我的开发变得非常复杂。

从那以后，我一直使用`tinyint(1)`，似乎已经足够好了。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-04-26T10:43:59.500

您可以使用 BOOL、BOOLEAN 数据类型来存储布尔值。

> 这些类型是 TINYINT(1) 的同义词

但是，BIT(1) 数据类型更适合存储布尔值（true[1] 或 false[0]），但 TINYINT(1) 在输出数据、查询等时更易于使用并实现 MySQL 与其他数据库之间的互操作性。您也可以检查[这个答案或线程](https://stackoverflow.com/a/4933041/7477462)。

> MySQL 还将 BOOL、BOOLEAN 数据类型转换为 TINYINT(1)。

此外，阅读[文档](https://dev.mysql.com/doc/refman/5.7/en/numeric-type-syntax.html)

# php - PHPUnit 文件命名约定

> ID：289729
> 
> 赞同：3
> 
> 时间：2008-11-14T10:37:13.877
> 
> 标签：php, unit-testing, phpunit

我刚刚开始在一些现有代码上尝试 phpunit。我们使用的命名约定是 MyClass 类应该在 MyClass.class.php 中。PHPUnit 似乎要求该文件应称为 MyClass.php。

有没有办法解决？

我在尝试生成骨架测试类时注意到了它：

```
phpunit --skeleton-test MyClass.class

PHPUnit 3.3.4 by Sebastian Bergmann.

Could not find class "MyClass.class" in "/home/jd/skeleton/classes/MyClass.class.php".
Fatal error: Call to a member function getOutClassName() on a non-object in /usr/share/php/PHPUnit/TextUI/Command.php on line 470 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-14T10:50:40.760

它不是一个要求，它只是假设性的。您可以编写自己的测试用例。

Skeleton 只是制作了一个“简单方法”的模型，它为所有类的虚拟函数制作了虚拟函数。

还，

```
phpunit --skeleton-test MyClass  MyClass.class.php 
```

可能会做你想做的事。

```
 Usage: phpunit [switches] UnitTest [UnitTest.php]
       phpunit [switches] <directory>

--skeleton-class         Generate Unit class for UnitTest in UnitTest.php.
--skeleton-test          Generate UnitTest class for Unit in Unit.php. 
```

所以根据这个推理，如果你不告诉它类在哪个文件中，它会尝试猜测，如果你告诉它类在哪个文件中，它不会猜测。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-01-31T16:13:14.680

当为其生成骨架的类是命名空间时，我遇到了类似的问题。我从命令行使用 phpunit 3.5.6。phpUnit 文档示例对我不起作用，我在网上找不到答案，所以我想我在这里分享它。假设您在目录 /my/dir 中有类 Foo 并且它在单个文件 Foo.php 中声明，因此类文件的完整路径是 /my/dir/Foo.php

还假设 Foo 声明如下：

```
<?php

namespace my\space;
class Foo
{
    ...
} 
```

为了生成测试框架，我确保我位于 Foo.php 所在的目录中，然后运行以下命令：

```
user[/my/dir]$ phpunit --skeleton-test my\\dir\\Foo Foo.php 
```

这让我的骨架生成。关键是转义反斜杠，因为 phpUnit 的文档提到了命名空间，但只显示了一个反斜杠。希望这可以帮助某人。

# java - Method.isBridge 用于什么？

> ID：289731
> 
> 赞同：30
> 
> 时间：2008-11-14T10:37:42.830
> 
> 标签：java, api, reflection

在`java.lang.reflect.Method`课程导航期间，我遇到了方法`isBridge`。它的 Javadoc 说只有当 Java 规范将方法声明为 true 时它才会返回 true。

请帮助我了解它的用途！如果需要，自定义类可以将其方法声明为桥梁吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-11-14T10:44:48.820

当扩展其方法具有参数化参数的参数化类型时，编译器可能会创建桥接方法。

您可以在此类[BridgeMethodResolver](https://fisheye.springsource.org/browse/spring-framework/spring-core/src/main/java/org/springframework/core/BridgeMethodResolver.java?r=02a4473c62d8240837bec297f0a1f3cb67ef8a7b)中找到一种获取“桥方法”引用的实际方法的方法。

请参阅[创建帧、同步、传输控制](http://java.sun.com/docs/books/jls/third_edition/html/expressions.html#15.12.4.5)：

作为这种情况的一个示例，请考虑以下声明：

```
class C<T> { abstract T id(T x); }
class D extends C<String> { String id(String x) { return x; } } 
```

现在，给定一个调用

```
C c = new D();
c.id(new Object()); // fails with a ClassCastException 
```

被调用的实际方法的擦除`D.id(String)`在其签名上与编译时方法声明的签名不同，`C.id(Object)`. 前者采用 String 类型的参数，而后者采用 Object 类型的参数。在执行方法主体之前，调用失败并出现 ClassCastException。

只有当程序产生未经检查的警告（[第 5.1.9 节](http://java.sun.com/docs/books/jls/third_edition/html/conversions.html#190772)）时，才会出现这种情况。

实现可以通过创建桥接方法来强制执行这些语义。在上面的示例中，将在 D 类中创建以下桥接方法：

```
Object id(Object x) { return id((String) x); } 
```

这是 Java 虚拟机实际调用的方法，以响应`c.id(new Object())`上面显示的调用，它会根据需要执行强制转换并失败。

另见**[桥](http://books.google.com/books?id=zaoK0%5A2STlkC&pg=PA50&lpg=PA50&dq=java+bridge+%22covariant+return+types%22&source=web&ots=6WoofeXYFM&sig=8bS5Y0sw%5ApBu%5ACuf1EkIR_L4Ddo&hl=en&sa=X&oi=book_result&resnum=4&ct=result#PPA48,M1)**：

**如评论中所述，协变覆盖**还需要桥接方法：

*   在 Java 1.4 及更早版本中，如果签名完全匹配，则一种方法可以覆盖另一种方法。
*   在 Java 5 中，如果参数完全匹配*但*覆盖方法的返回类型（如果它是另一个方法的返回类型的*子类型*），则一个方法可以覆盖另一个方法。

通常，方法`Object clone()`可以被 a 覆盖`MyObject clone()`，但编译器会生成桥方法：

```
public bridge Object MyObject.clone(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-05-19T00:04:15.187

那里显示的示例（引自 JLS）听起来像是桥接方法仅在使用原始类型的情况下使用。由于情况并非如此，我想我会举一个例子，其中桥方法用于完全类型正确的通用代码。

考虑以下接口和函数：

```
public static interface Function<A,R> {
    public R apply (A arg);
}
public static <A, R> R applyFunc (Function<A,R> func, A arg) {
    return func.apply(arg);
} 
```

如果您按以下方式使用此代码，则使用桥接方法：

```
Function<String, String> lower = new Function<String, String>() {
    public String apply (String arg) {
        return arg.toLowerCase();
    }
};
applyFunc(lower, "Hello"); 
```

擦除后，`Function`接口包含方法`apply(Object)Object`（您可以通过反编译字节码来确认）。自然，如果您查看反编译的代码，`applyFunc`您会发现它包含对`apply(Object)Object`. `Object`是其类型变量的上限，因此没有其他签名有意义。

因此，当使用该方法创建匿名类时，除非创建桥接方法`apply(String)String`，否则它实际上并没有实现接口。`Function`bridge 方法允许所有通用类型的代码使用该`Function`实现。

有趣的是，只有当类实现了带有签名的*其他*接口`apply(String)String`并且只有通过该接口类型的引用调用该方法时，编译器才会发出带有该签名的调用。

即使我有以下代码：

```
Function<String, String> lower = ...;
lower.apply("Hello"); 
```

编译器仍会发出对`apply(Object)Object`.

实际上还有另一种方法可以让编译器调用`apply(String)String`，但它利用了分配给匿名类创建表达式的神奇类型，否则无法写下来：

```
new Function<String, String>() {
    public String apply (String arg) {
        return arg.toLowerCase();
    }
}.apply("Hello"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-26T18:48:31.980

我偶然发现的另一个案例与泛型无关：

```
protected abstract class Super {
    public void m() {}
}
public class Sub extends Super {}
assert Sub.class.getMethod("m").isBridge(); 
```

# c# - 我的 C# 代码中存在逻辑错误，我该怎么办？

> ID：289733
> 
> 赞同：0
> 
> 时间：2008-11-14T10:38:27.210
> 
> 标签：c#

我有一个逻辑错误。我提供了以下内容作为输入：

*   工资是30000
*   孩子 n° 是 9

所以净工资将是：

*   家庭奖金+工资-税

    ```
     (750)       + (30000) - (3000) 
    ```

*   但我的程序将它们视为

    ```
     (1500)    + (30000) + (6000) 
    ```

我的计划使家庭奖金和税收翻​​了一番（累积）。谁能解释为什么？

```
class Program
{
    static void Main(string[] args)
    {
        Employee e = new Employee();
        e.ReadEmployee();
        e.PrintEmployee();
    }
}

class Employee
{
    private string n;
    private int byear;
    private double sal;
    private bool gen;
    private bool mar;
    private int child;
    public static double tax = 0;
    public static double familybonus = 0;
    public string Ename
    {
        get { return this.n; }
        set
        {
            this.n = value;

        }
    }
    public int Birthyear
    {
        get { return this.byear; }
        set
        {
            if (value >= 1970 && value <= 1990) this.byear = value;
            else this.byear = 0;
        }
    }
    public double Salary
    {
        get { return this.sal; }
        set
        {
            if (value >= 5000 && value <= 50000) this.sal = value;
            else this.sal = 0;
        }
    }

    public bool Gender
    {
        get { return this.gen; }
        set { this.gen = value; }
    }
    public bool Married
    {
        get { return this.mar; }
        set { this.mar = value; }
    }
    public int NChildren
    {
        get { return this.child; }
        set
        {
            if (value >= 0 && value <= 12) this.child = value;
            else this.child = 0;
        }
    }

    public double getAge()
    {
        return 2008 - this.Birthyear;
    }
    public double getNet()
    {
        double net = getFamilyBonus() + this.Salary - getTax();
        return net;
    }

    public double getFamilyBonus()
    {

        if (this.Married == true)
            familybonus += 300;
        if (this.NChildren == 1) familybonus += 200;
        else if (this.NChildren == 2) familybonus += 350;
        else if (this.NChildren >= 3) familybonus += 450;
        return familybonus;
    }

    public double getTax()
    {
        if (Salary < 10000)
            tax = 0;
        if (Salary <= 10000 && Salary >= 20000)
            tax += Salary * 0.05;
        else tax += Salary * 0.1;
        return tax;

    }

    public void ReadEmployee()
    {
        Console.Write("Enter Employee Name: ");
        Ename = Console.ReadLine();
        Console.Write("Enter Employee birth date: ");
        Birthyear = int.Parse(Console.ReadLine());

        while (Birthyear < 1970 || Birthyear > 1990)
        {
            Console.WriteLine("Invalid Birthyear!");
            Console.Write("Enter Employee Birth date: ");

            Birthyear = int.Parse(Console.ReadLine());
        }
        string g = null;
        while (g != "M" && g != "m" && g != "F" && g != "f")
        {
            Console.Write("Enter Employee Gender (M/F)");
            g = Convert.ToString(Console.ReadLine());
        }

        if (g == "M" || g == "m")
            Gender = true;
        else
            Gender = false;
        Console.Write("Enter Employee Salary: ");
        Salary = Double.Parse(Console.ReadLine());
        while (Salary < 5000 || Salary > 50000)
        {
            Console.WriteLine("Invalid Salary!");
            Console.Write("Enter Employee Salary: ");
            Salary = int.Parse(Console.ReadLine());
        }
        string m = null;
        while (m != "true" && m != "True" && m != "false" && m != "False")
        {
            Console.Write("Married (true/false)");
            m = Console.ReadLine();

        }
        if (m == "true")
            this.Married = true;
        else
            this.Married = false;

        Console.Write("Enter Employee Children count: ");
        NChildren = int.Parse(Console.ReadLine());

        while (NChildren < 0 || NChildren > 12)
        {
            Console.WriteLine("Invalid NChildren!");
            Console.Write("Enter Employee Children count: ");

            NChildren = int.Parse(Console.ReadLine());
        }

    }
    public void PrintEmployee()
    {
        Console.Write("Hello ");
        {
            if (Gender == true)
                Console.Write("Mr. ");
            else
                Console.Write("Mrs. ");
            Console.WriteLine(Ename);
        }
        Console.WriteLine("You are {0} years old", getAge());
        Console.WriteLine("Salary= {0}", Salary);
        Console.WriteLine("Tax= {0}", getTax());
        Console.WriteLine("Family bonus= {0}", getFamilyBonus());
        Console.WriteLine("Net= {0}", getNet());
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T10:48:11.887

我采用了现有代码，并对输入进行了硬连接（而不是使用 Console.ReadLine()），我得到：

> 你28岁 工资= 30000 税金= 3000 家庭奖金= 750 净值= 25500

主要问题似乎不是初始化值 - 即将字段视为变量：

```
public double getTax()
{
    if (Salary < 10000)
        tax = 0;
    if (Salary <= 10000 && Salary >= 20000)
        tax += Salary * 0.05;
    else tax += Salary * 0.1;
    return tax;
} 
```

好的 - 以及`tax`从 if`Salary >= 10000`等开始的内容。同样`familyBouns`在`getFamilyBonus`. 顺便说一句，**Salary 怎么可能是`<= 10000`和`>= 20000`**？

为了说明，我将输出更改为：

```
 Console.WriteLine("Tax= {0}", getTax());
    Console.WriteLine("Tax= {0}", getTax());
    Console.WriteLine("Tax= {0}", getTax()); 
```

这表明：

> 税收= 3000 税收= 6000 税收= 9000

我的建议是：除非您知道数学是如此复杂以至于值得，否则不要存储计算值。只需根据需要计算它们（根本没有字段）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T10:46:00.770

另一个问题似乎在于，当您说familybonus += 300 时，您没有初始化familybonus。因此，每次调用GetFamilybonus 时，它都会添加到先前的结果中。您在 PrintEmployee 函数中调用它两次，一次是直接调用，一次是通过调用 getNet 间接调用；

# python - 如何改进这个 number2words 脚本

> ID：289735
> 
> 赞同：3
> 
> 时间：2008-11-14T10:40:21.233
> 
> 标签：python

```
import sys

words = {
    1 : 'one',
    2 : 'two',
    3 : 'three',
    4 : 'four',
    5 : 'five',
    6 : 'six',
    7 : 'seven',
    8 : 'eight',
    9 : 'nine',
    10 : 'ten',
    11 : 'eleven',
    12 : 'twelve',
    13 : 'thirteen',
    14 : 'fourteen',
    15 : 'fifteen',
    16 : 'sixteen',
    17 : 'seventeen',
    18 : 'eighteen',
    19 : 'nineteen'
}

tens = [
    '',
    'twenty',
    'thirty',
    'forty',
    'fifty',
    'sixty',
    'seventy',
    'eighty',
    'ninety',
]

placeholders = [
    '',
    'thousand',
    'million',
    'billion',
    'trillion',
    'quadrillion'
]

# segMag = segment magnitude (starting at 1)
def convertTrio(number):
    return ' '.join([words[int(number[0])],  'hundred',  convertDuo(number[1:3])]) # convertDuo(number[1:3])

def convertDuo(number):
    #if teens or less
    if int(number[0]) == 1:
        return words[int(number)]
    #twenty-five
    else:
        return tens[int(number[0]) - 1] + '-' + words[int(number[1])]

if __name__ == "__main__":

    string = []
    numeralSegments = []
    numeral = sys.argv[1]

    if int(numeral) < 100:
        print convertDuo(numeral)
    else:

        # split number into lists, grouped in threes
        for i in range (0, len(numeral), 3):
            numeralSegments.append(numeral[i:i+3])

        numeralSegments.reverse()

        # for every segment, convert to trio word and append thousand, million, etc depending on magnitude
        for i in range (len(numeralSegments)):
            string.append(convertTrio(numeralSegments[i]) + ' ' + placeholders[i])

        # reverse the list of strings before concatenating to commas
        string.reverse()        
        print ', '.join(string) 
```

**警告**：我是个 Python 新手。我知道可能有很多更有效的做事方式。我很感激对他们的任何指点。

**编辑**：该代码目前仅适用于位数为三的倍数的数字。我也很感激提出一种优雅的方法来解决这个问题。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T10:45:32.313

想到两个改进：

*   40 拼写为“四十”，而不是“四十”
*   你的程序需要单元测试

查看 Python [doctest](http://python.org/doc/2.5/lib/module-doctest.html)和[unittest](http://python.org/doc/2.5/lib/module-unittest.html)模块。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T10:54:29.130

您不能将数字分组为从左到右的“段”。这`range(0,len(),3)`不会很好地工作。您必须编写相同的算法来插入数字分隔符。你从右边开始，挑选数字段。

剩下的（在左边，明白了吗？）将是 1、2 或 3 位数字。你有 convertTrio 和 convertDuo，它们分别处理 3 位和 2 位数字。某处有一个转换一位数的功能（看不到它）。

如果不是功课，那么，这里有一个合适的数字聚类算法

```
def segment( n ):
   segList= []
   while len(n) > 3:
       segList.insert( 0, n[-3:] )
       n= n[:-3]
   segList.insert( 0, n )
   return segList 
```

编辑

为了更加 Pythonic，将其打包为一个整洁、可重用的模块。里面的东西`if __name__ == "__main__"`做了两件事，应该分开。

您的命令行解析（与此有关的任何事情`sys.argv`都是一回事。实际的“转换数字”功能完全是另一回事。您希望看起来更像这样。

```
if __name__ == "__main__":
    import sys
    for number in sys.argv[1:]:
        print number2string( number ) 
```

然后，您的`number2string`函数将成为该模块的一个易于重用的部分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-14T16:45:41.870

不是切片数字，而是使用模运算来分隔单元。此函数将使用给定的数据结构转换小于 100 的数字。

```
def convert(n):
    q, r = divmod(n, 10)
    if q < 2:
        return words[n]
    result = tens[q-1] # offset because tens is missing first null value
    if r:
        result += '-' + words[r]
    return result 
```

然后递归地使用convert 来支持更大的数字，例如，以divmod(n, 100) 等开头。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-14T10:53:49.443

也许[数字和复数词作为英语口语](http://code.activestate.com/recipes/413172/)会有所帮助。不过有点过时了——2005 年 5 月 4 日。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T11:24:35.760

查看[Number::Spell](http://search.cpan.org/src/LHOWARD/Number-Spell-0.04/Spell.pm) Perl 模块的源代码。它很短，可以很容易地移植到 Python（如果还没有完成的话）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-09T23:55:19.667

如果有人阅读本文正在寻找文字脚本的数字，请查看[inflect.py](http://pypi.python.org/pypi/inflect)

```
import inflect
p = inflect.engine()
p.numwords(123456789) 
```

给

```
'one hundred and twenty-three million, four hundred and fifty-six thousand, seven hundred and eighty-nine' 
```

# c# - 将 C# var 重构为显式类型的工具

> ID：289743
> 
> 赞同：18
> 
> 时间：2008-11-14T10:44:26.340
> 
> 标签：c#, refactoring

我们的编码标准要求我们尽量减少 C# var 的使用（建议将其限制为与 Linq 结合使用）。然而，有时使用泛型相当方便，例如

```
Dictionary<DateTime, Dictionary<string, float>> allValues = ...
// ...
foreach (var dateEntry in allValue) 
```

更容易打字

```
foreach (KeyValue<DateTime, Dictionary<string, float>> dateEntry in allValue) 
```

（并且在某些情况下比记住显式类型更容易）。

是否有任何重构工具能够将前者转换为后者。我看过 Resharper，但它似乎没有这样做（事实上，它的默认建议是朝相反的方向发展）。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-14T11:01:36.417

我有 ReSharper 4.1，它确实提供了这个选项（在任一方向）。

实际上，我建议挑战标准......前者比后者更具可读性（特别是如果你调用变量`pair`或类似的东西）。我不会将“var”用于`var i = 0`，但它非常适合上述情况。

如需批量更改，请访问：

*   清理代码...（选择一个配置文件 => “编辑配置文件” => 工具 => 代码清理）
    *   C＃
        *   在声明中使用 'var'
            *   替换方向 = Can 'var' 输入用法
            *   'foreach' 迭代器声明样式 = 始终使用显式类型
            *   局部变量声明样式 = 始终使用显式类型

并运行...

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2017-09-22T20:02:41.010

这在 Visual Studio 2017 中是可能的。

工具 > 选项 > 文本编辑器 > C# > 代码样式 > 常规 –

查找“var”首选项 > 当变量类型明显时。对于 Preference 选择“Prefer explicit type”，对于 Severity 选择“Suggestion”。

[![在此处输入图像描述](https://i.stack.imgur.com/wdxwh.png)](https://i.stack.imgur.com/wdxwh.png)

现在，您将在使用 时获得灯泡操作，并且您可以使用快捷键`var`快速更改为显式类型。`Ctrl``.`

[![在此处输入图像描述](https://i.stack.imgur.com/yvBKN.png)](https://i.stack.imgur.com/yvBKN.png)

[![在此处输入图像描述](https://i.stack.imgur.com/rNInt.png)](https://i.stack.imgur.com/rNInt.png)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-14T10:56:22.917

Resharper 这样做（仅在版本 4+ 中我确定）但我不知道是否可以简单地将 var 转换为特定类型自动 - 最终您需要转到“var”然后灯光显示up 这使您可以选择显式指定类型

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-14T11:16:41.457

[@Adam](https://stackoverflow.com/questions/289743/tool-to-refactor-c-var-to-explicit-type#289795) - 你不能在这里声明一个类，因为这不会是从`IDictionary<,>.GetEnumerator()`- 但是，你可以通过别名`using`：

```
using InnerPair = System.Collections.Generic.KeyValuePair<System.DateTime,
    System.Collections.Generic.Dictionary<string, float>>; 
```

然后：

```
foreach(InnerPair pair in dict) {...} 
```

这只是一个类型别名，所以工作正常。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-14T14:29:10.443

DevExpress 通过 CodeRush 支持这一点，他们最近开始免费提供一些重构。您正在寻找的重构是“Make Explicit”

[http://devexpress.com/Products/Visual_Studio_Add-in/CodeRushX/](http://devexpress.com/Products/Visual_Studio_Add-in/CodeRushX/)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-03-09T06:59:00.940

可能已经很晚了，但我写了一个基于 .NET 编译器平台的 Visual Studio 2015 扩展。[将 var 替换为 Type](https://marketplace.visualstudio.com/items?itemName=RishabhVerma.ReplacevarWithType) 已针对正常场景进行了测试，如果有错误，我会尽快修复它，并且它也是开源的，以防有人想贡献或增强此工具。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-14T11:08:53.483

我认为你的域对象上有复杂的泛型类型，你应该对它们进行 typedef

```
类 DomainValueCollection : KeyValue<DateTime, Dictionary<string, float>>{}

```

DomainValueCollection 在您的域上下文中有意义的地方

然后代码变成

```
var allItems = new DomainValueCollection();

```

而不是

```
var allItems = new KeyValue<DateTime, Dictionary<string, float>>();

```

# javascript - 如何在 Firefox 上关闭缓存？

> ID：289751
> 
> 赞同：145
> 
> 时间：2008-11-14T10:46:05.807
> 
> 标签：javascript, firefox, caching

在开发过程中，我必须一直在 Firefox 中“清除缓存”，以使其使用最新版本的 JavaScript 文件。

是否有某种设置 (about:config) 可以完全关闭 JavaScript 文件的缓存？或者，如果不是，对于所有文件？

* * *

## 回答 #1

> 赞同：230
> 
> 时间：2008-11-14T10:57:26.313

在 Firefox 地址栏中输入“about:config”并设置：

```
browser.cache.disk.enable = false
browser.cache.memory.enable = false 
```

如果在本地开发，或者使用 HTML5 的新清单属性，您可能还必须在 about:config 中设置以下内容 -

```
browser.cache.offline.enable = false 
```

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2008-11-14T12:35:55.477

[Web 开发人员工具栏](https://addons.mozilla.org/en-US/firefox/addon/60)有一个禁用缓存的选项，这使得在需要时可以很容易地打开和关闭它。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-11-14T10:47:37.287

您是否尝试过使用`CTRL`-`F5`来更新页面？

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2013-01-26T13:25:01.860

没有仅针对 JavaScript 禁用缓存的特定选项，您必须完全禁用缓存。

[FireBug](https://getfirebug.com/)在“网络”选项卡的下拉菜单中提供了禁用浏览器缓存的选项。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2016-10-05T08:41:47.273

**Firefox 48 开发者工具**

允许您仅在工具箱打开时关闭缓存，非常适合 Web 开发：

*   F12
*   变速箱在右上角
*   向下滚动顶部高级设置
*   选中“禁用缓存（工具箱打开时）”

[![在此处输入图像描述](https://i.stack.imgur.com/YYnAg.png)](https://i.stack.imgur.com/YYnAg.png)

[https://stackoverflow.com/a/27397425/895245](https://stackoverflow.com/a/27397425/895245)有类似的内容，但定位有所改变。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2014-12-10T09:29:51.637

在您要禁用缓存的同一页面上执行以下操作：仅供参考：正在使用的版本是 30.0

你可以 ：

![打开 webdeveloper 工具栏](https://i.stack.imgur.com/qOLEo.png) ![开放网络开发者](https://i.stack.imgur.com/ps2rB.png)

![并选择禁用缓存](https://i.stack.imgur.com/RZL8b.png)

之后，它会从自己的页面重新加载页面（你在），每件事都会被重新缓存，任何进一步的请求也会每次都被重新缓存，你可以让 Web 开发人员始终保持打开状态，以确保它始终处于打开状态（检查） .

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-11-14T11:50:32.197

如果您正在使用服务器端代码，您可以生成一个随机数并以下列方式将其附加到 src 的末尾......

src="yourJavascriptFile.js?randomNumber=434534"

每次随机生成randomNumber。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2011-07-13T04:21:02.427

我知道我正在复活一个古老的问题，但我今天试图解决这个问题并有一个替代解决方案。当我想测试时切换缓存对我来说并不是真的可以接受，正如其他人提到的，硬刷新（ctrl+shift+r）并不总是有效。

相反，我选择将以下内容放在我的开发环境中的 vhost.conf 文件中（也可以在 .htaccess 中完成）：

```
<FilesMatch "\.(js|css)$">
FileETag None
<IfModule mod_headers.c>
Header unset ETag
Header set Cache-Control "max-age=0, no-cache, no-store, must-revalidate"
Header set Pragma "no-cache"
Header set Expires "Wed, 11 Jan 1984 05:00:00 GMT"
</IfModule>
</FilesMatch> 
```

在我的开发环境中，这可确保始终检索 js 和 css。此外，它不会影响我的其余浏览，它也适用于所有浏览器，因此在 chrome / ie 等中进行测试也很容易。

在这里找到了片段，还有一些其他方便的 apache 技巧：[http ://www.askapache.com/htaccess/using-http-headers-with-htaccess.html#prevent-caching-with-htaccess](http://www.askapache.com/htaccess/using-http-headers-with-htaccess.html#prevent-caching-with-htaccess)

为了确保我的客户在生产中始终看到最新版本，我们在每次更新时增加 js 包含的查询字符串，即

```
jquery.somefile.js?v=0.5 
```

这会强制我的客户的浏览器在看到新的查询字符串时更新其本地缓存，然后缓存新副本，直到文件再次更新

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-11-14T10:59:08.107

您可以使用`CTRL`-`F5`绕过缓存重新加载。

您可以在Firefox中设置首选项不使用缓存

```
network.http.use-cache = false 
```

您可以设置您的 Web 服务器为 js 文件发送 no-cache/Expires/Cache-Control 标头。

这是 apache Web 服务器的[示例](http://www.askapache.com/htaccess/using-http-headers-with-htaccess.html#prevent-caching-with-htaccess)。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-11-14T11:07:39.837

最好的策略是设计你的网站来为你的 JS 文件建立一个唯一的 URL，每次发生变化时都会重置。这样，它在没有更改时缓存，但在发生任何更改时立即重新加载。

您需要针对您的特定环境工具进行调整，但如果您使用的是 PHP/Apache，这对您和最终用户来说都是一个很好的解决方案。

[http://verens.com/archives/2008/04/09/javascript-cache-problem-solved/](http://verens.com/archives/2008/04/09/javascript-cache-problem-solved/)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2015-08-23T10:43:37.463

如果您使用 FireBug，在“网络”选项卡的下拉菜单中有一个选项可以禁用浏览器的缓存。

[![在此处输入图像描述](https://i.stack.imgur.com/IM9jR.png)](https://i.stack.imgur.com/IM9jR.png)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-14T14:58:18.823

我使用`CTRL`- `SHIFT`-`DELETE`激活隐私功能，允许您一次清除缓存、重置 cookie 等。您甚至可以对其进行配置，使其只是执行此操作，而不是弹出一个对话框要求您确认。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-10-15T13:23:00.490

发布的最后两个解决方案各有利弊，但恕我直言，它们都是很棒的解决方案。

1.  您可能希望也可能不希望将会话 ID 嵌入到您的 url 中，以提高安全性。但是在开发中这应该无关紧要，但是如果您忘记删除它怎么办？这也真的有效吗？您是否不需要类似序列号生成器的东西（存储在会话中的命中计数，或者甚至可能只是 1 然后 0，如果 0 然后 1）？

2.  添加会话 ID（或任何排序器）意味着您需要记住将其添加到您不想缓存的每个资源中。一方面这更好，因为您可以仅将会话 ID 包含在您正在积极开发和测试的资源中。另一方面，这意味着您必须这样做，并且您必须记住将其删除以进行生产。

3.  修改 vhost.conf 或 .htaccess 文件可以很好地解决问题，而无需记住添加和删除会话 ID。但缺点是所有 js 和 css 资源的性能都会受到影响，如果你有大文件，那会减慢你的速度。

两者看起来都是很棒、优雅的解决方案——取决于您的需求。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-08-08T02:27:23.567

在更高版本的 Firefox 中，例如 Nightly，有一个名为“禁用缓存”的选项，您可以通过单击齿轮找到它。而且该选项仅在当前会话中有效，这意味着当您关闭检查器并重新启动它时，如果您想禁用捕获，则必须再次检查它。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-09-05T11:43:58.577

经过 2 小时浏览各种替代方案后，这对我有用。

我的要求是在我的 Spring 安全 Web 应用程序中禁用 js 和 css 文件的缓存。但同时在特定会话“内”缓存这些文件。

为每个请求传递一个唯一的 id 是建议的方法之一。

这就是我所做的:- 而不是

```
<script language="javascript" src="js/home.js"></script> 
```

我用了

```
<script language="javascript" src="js/home.js?id=${pageContext.session.id}"></script> 
```

欢迎对上述方法的任何缺点。安全问题 ？

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-04-19T19:50:52.710

在 firefox 45 中，可以通过更改以下值来设置磁盘缓存选项：browser.cache.disk.enable

该值可以在“about:config”页面上设置。

在[http://kb.mozillazine.org/About:config_entries#Browser](http://kb.mozillazine.org/About:config_entries#Browser)我找到了“browser.cache.disk.enable”的以下描述：

True（默认）：使用磁盘缓存，直到 browser.cache.disk.capacity 中指定的容量 False：禁用磁盘缓存（与将 browser.cache.disk.capacity 设置为 0 效果相同）

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-05-18T13:49:07.297

首先，这很容易做到，例如通过 PHP 强制浏览器根据缓存日期（到期时间）更新文件。如果您只是出于实验需要，请尝试使用 ctrl+shift+del 在 Firefox 浏览器中一次清除所有缓存。第三种解决方案是使用许多为 Firefox 退出的附加组件，以根据时间线清除缓存。

# c# - 文本框自动完成

> ID：289756
> 
> 赞同：2
> 
> 时间：2008-11-14T10:49:52.633
> 
> 标签：c#, asp.net, javascript, textbox, autocomplete

如何在asp中制作自动完成文本框？但我需要通过查询数据库来获取自动完成数据。我真的不知道如何解释这一点，如果没有足够的细节，对不起。我不能使用 ajax，因为我认为我的旧应用程序会有兼容性问题。所以我想用java脚本来做这件事。或者有没有办法通过使用.net来做到这一点？我使用 C# 进行代码隐藏。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T11:12:09.577

我认为，如果不使用一些第三方自动完成功能，将会付出很多努力 - 不知道“我不能使用 ajax”是什么意思，但是如何使用[ASP.NET AJAX 自动完成控件](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/AutoComplete/AutoComplete.aspx)，将`ServiceMethod`属性设置为静态页面方法在你的代码后面吗？这至少使它包含在您的页面中。

Page 方法可以转到您的数据库，并返回一个 String[] 结果。

如果您决定使用它，则需要在控件中将`EnablePageMethods`属性设置为。`true``<asp:ScriptManager>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T11:13:57.390

AJAX 是 JavaScript。它是使用 XMLHttpRequest 对象发出异步请求的 JavaScript。 [这是一篇关于它和 ASP.NET 的文章](http://www.dotnetjunkies.ddj.com/Article/E80EC96F-1C32-4855-85AE-9E30EECF13D7.dcik)。

如果您想了解更多关于 AJAX（**A**同步**J** avaScript和**X ML）****的**信息，我会先查看[Wikipedia](http://en.wikipedia.org/wiki/AJAX)。如果你想要关于它的书，有很多。我推荐Christian Wenz (O'Reilly And Associates) 的*[Programming ASP.NET AJAX](http://safari.oreilly.com/9780596514242)*。

 *** * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T23:12:10.527

如果您不想使用 ajax 库，请尝试 jquery

有很多插件自动完成或 jquery 建议文本框试试这个 [http://www.vulgarisoip.com/2007/08/06/jquerysuggest-11/](http://www.vulgarisoip.com/2007/08/06/jquerysuggest-11/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T06:21:30.183

ASP.NET AJAX 框架适用于 ASP.NET 2.0 及更高版本。因此，它不能在 Visual Studio 2003 环境中工作。

Anthem.NET 是一个免费的跨浏览器 AJAX 工具包/框架，适用于 ASP.NET 开发环境，适用于 ASP.NET 1.1 和 2.0 - [http://sourceforge.net/projects/anthem-dot-net](http://sourceforge.net/projects/anthem-dot-net)

对于您的自动完成要求，您可以考虑使用 jQuery Autocomplete Plugin

它需要非常少的编程。在此处查看演示和代码示例 - [http://docs.jquery.com/Plugins/Autocomplete](http://docs.jquery.com/Plugins/Autocomplete)

它的 autocomplete() 方法采用 URL 或数组来填充您的自动完成列表。您可以传递直接从数据库中获取结果的页面的 URL。

# windows - 自动将文件从 Linux 机器复制到 Windows 机器

> ID：289760
> 
> 赞同：6
> 
> 时间：2008-11-14T10:51:26.763
> 
> 标签：windows, linux, file, cross-platform, copy

我需要每天自动将文件从 linux 机器复制到 windows 一个。

我正在寻找简单而安全的东西，例如 scp、rsync、sftp。不幸的是，我不知道如何在 Windows 机器上进行设置。

有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-14T10:53:39.833

您可以尝试使用 smbfs 将 Windows 驱动器挂载为 Linux 机器上的挂载点；然后，您将能够使用普通的 Linux 脚本和复制工具（例如 cron 和 scp/rsync）进行复制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T10:58:41.397

你可以在 cygwin 中找到 rsync for windows，这样你就可以在 windows 机器上设置一个 rsync 服务器，并在你的 linux 机器上运行一个 cron 作业，将所有文件同步到 windows 机器。我们曾经这样做过，而且效果很好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-14T15:42:02.310

我已经好几年没用过了，但你可以从[http://www.cis.upenn.edu/~bcpierce/unison/尝试 Unison](http://www.cis.upenn.edu/~bcpierce/unison/)

它可以使用“smbclient”来完成，它的作用很像 Windows 共享的 FTP 客户端。查看手册页：`man smbclient`并寻找使用该`-c`选项编写脚本或`man expect`驱动它的方法。

这就是我可能会这样做的方式：

1.  在同步文件时选择您将成为的用户。以该用户身份登录并输入“id”，然后获取数字 ID。您将在第 4 步中使用此 ID
2.  成为“根”
3.  `mkdir /mnt/sharename`
4.  编辑您的 /etc/fstab 文件并添加一个类似这样的条目。将用户 ID 500 替换为您的用户 ID。将 sharename 替换为您的 Windows 共享名称。将 WINDOWSHOSTNAME 替换为您的主机名或 IP 地址。如果您不知道共享，请运行`smbclient -L WINDOWSHOSTNAME`.

    > `//WINDOWSHOSTNAME/sharename /mnt/sharename cifs credentials=/root/smblogin,uid=500,noauto,user 0 0`

5.  编辑 /root/smblogin 并将以下两行放入其中

    > `username=YOUR_WINDOWS_USERNAME
    > password=YOUR_WINDOWS_PASSWOD`

6.  以步骤 1 中的用户身份登录。

7.  尝试安装共享：`mount /mnt/sharename`
8.  如果成功，则编写一个脚本自动执行此操作。我们称它为“backup.sh”：

    > `#!/bin/sh
    > df | grep -q /mnt/sharename
    > if test $? -ne 0 ; then
    > mount /mnt/sharename
    > fi
    > cp -r /path/to/dir /mnt/sharename/destination/`

9.  使用 cron 运行脚本。

    1.  类型`crontab -e`
    2.  将以下内容放入文件中：

    > `PATH=/bin:/usr/bin
    > # Backup at 2:15 A.M. every day. Run 'man 5 crontab' for help on the time format
    > 15 2 * * * /path/to/backup.sh`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-14T11:01:07.243

“我不知道如何在 Windows 机器上进行设置。” Windows是客户端还是服务器？不知所措意味着什么，具体是什么？你不能做什么？

“linux机器到windows”可以通过两种方式完成。

1.  Linux是客户端。Windows 运行 FTP 或 SCP 或 SSH 服务器。Linux 有一个客户端并将文件推送到 Windows。查看[FileZilla](http://filezilla-project.org/)免费的 windows FTP 服务器。此外，Windows 的 FTP 服务通常已关闭。打开它。

2.  Windows 是客户端。Windows 会定期从 linux 服务器中提取文件。这更容易，因为 Linux 已经拥有所有必要的可用服务器。但是，您确实需要在 Linux 上启动它们。

有许多用于 Windows 的 sftp、scp 客户端。Windows 带有一个 ftp 客户端。谷歌 sftp 客户端。您会找到[WinSCP](http://winscp.net/eng/index.php)、[Putty](http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html)、[filezilla](http://filezilla-project.org/)，并列出sftp 客户端的[免费国家](http://www.thefreecountry.com/webmaster/freeftpclients.shtml)/地区列表。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-14T10:56:45.863

您可以尝试[WinSCP](http://winscp.net/)及其[脚本支持](http://winscp.net/eng/docs/scripting)。而且 Windows 在其管理内容中支持某种类似 cron 的操作，不是吗？

# sharepoint - IIS 帐户的权限

> ID：289763
> 
> 赞同：1
> 
> 时间：2008-11-14T10:52:30.193
> 
> 标签：sharepoint, iis, permissions

我有一个在共享点下运行的网络服务，在标准的 Server2003/IIS6 设置上。此 Web 服务需要从同一域中另一台计算机上的共享中打开和读取文件。目前我得到一个

System.UnauthorizedAccessException：拒绝访问路径“\strand\DROPBOXES\MattTrinder\SharepointShared\bd116dfa-be0e-4c58-93e6-3fb93fa0ef22.tmp”。在 System.IO.__Error.WinIOError（Int32 错误代码，字符串可能全路径）

我需要向哪些帐户授予哪些权限才能允许此 Web 服务打开和读取文件？

使用 "\\sharepointserver\c$" 工作正常...

谢谢

马特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T11:14:50.397

您授予访问权限的帐户也必须存在于目标（存在共享的位置）上（相同的域帐户或具有相同密码的本地帐户）。由于 IIS 用户通常有一个自动生成的密码并且是本地的，所以这很难。

我们解决这个问题的方法是，以不同用户（我们自己创建）的身份运行网站，并授予该用户访问远程 PC 上共享的权限。请注意，共享权限和文件系统权限都必须正确。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T11:15:14.360

您需要在文件系统级别和共享中授予读取访问权限。问题是 sharepoint 在无法访问网络的网络服务帐户下运行（可能是因为它可以更改）。

选项：

*   如果您对 Web 服务使用集成身份验证。然后，您必须向运行 Web 服务客户端的用户授予权限。但不要走这条黑暗的道路。因为委派很难配置。
*   如果您对 Web 服务具有匿名访问权限，请确保运行 Web 服务的应用程序池以有权访问该文件的显式用户的用户权限运行。这可以通过 sharepoint 管理站点进行配置。或者用电脑管理mmc。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T11:21:45.750

默认情况下，经典 asmx Web 服务以 IUSR_ 帐户运行。这可能没有访问网络路径的权限。您可以通过更改应用程序池标识将其更改为域帐户。

# c# - 在 .Net 中调用命名空间的最佳方法是什么

> ID：289770
> 
> 赞同：4
> 
> 时间：2008-11-14T10:57:11.603
> 
> 标签：c#, .net, namespaces, package

在过去，我总是将某个特定项目的命名空间与项目（和原则类）相同，例如：

```
namespace KeepAlive
{
    public partial class KeepAlive : ServiceBase
    {... 
```

然后从其他项目中，每当我调用该类时，它总是：

```
KeepAlive.KeepAlive()... 
```

我现在开始认为这可能不是一个好主意，但我有点难倒我的命名空间的实际名称。其他人做什么？您的所有项目是否只有一个命名空间？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-14T11:02:19.520

让一个类的名称与命名空间相同是一个坏主意——在我看来，在某些情况下引用正确的东西变得非常棘手。

我通常将项目（和命名空间）称为适当的名称，然后在适当的地方为入口点设置“EntryPoint”或“Program”。在您的示例中，我可能会调用“KeepAliveService”类。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-14T11:22:55.983

我们有这个简单的方案：

```
 CompanyName.ProductName 
```

然后是应用层，例如

```
 CompanyName.ProductName.Data
  CompanyName.ProductName.Web 
```

等等

内部按模块和/或功能划分，通常对应于文件夹

```
 CompanyName.ProductName.Web.Shop
  CompanyName.ProductName.Web.Newsletter 
```

等等

顺便说一句：您可以在此处找到类似问题的答案：

*   [.NET 命名空间](https://stackoverflow.com/questions/55692/net-namespaces)
*   [解决方案中的文件夹是否应该与命名空间匹配？](https://stackoverflow.com/questions/4664/should-the-folders-in-a-solution-match-the-namespace)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-14T11:26:07.567

CompanyName.ProductName.AreaOfSystem.SubAreaOfSystem

永远不要将它们与班级同名。

我们的领域包括：

*   服务
*   智能卡
*   用户界面

子区域很少使用，但在相关时：

*   智能卡.Mifare
*   智能卡DESFire

我们的不对应文件夹，因为从逻辑上讲可能并非如此。为了简化解决方案资源管理器的导航，我们可能会在文件夹中分割某些位，但这并不一定意味着命名空间应该遵循文件夹结构。特别是如果文件夹中只有几个文件（类型很少的命名空间通常很愚蠢）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-14T10:59:27.700

我用进入该名称空间的所有事物的通用描述符来命名我的名称空间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T12:26:28.647

我喜欢 java 封装方式：com.stackoverflow.Data（或者您公司的主域名可能是什么）。
这样你的命名空间就不会模棱两可了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-14T12:29:19.547

我们坚持旧的

uk.co.company.system.layer

这样我们就可以将冲突减少到最低限度，因为我们使用了大量的 MS Server 产品，它有助于概念分离。

例如。

uk.co.acme.biztalk.bizutils。

# .net - 如何在安装过程中修改 .NET 配置文件？

> ID：289773
> 
> 赞同：40
> 
> 时间：2008-11-14T10:59:03.533
> 
> 标签：.net, configuration, installation

我使用 app.config 文件来存储一些值（映射数据库的路径、数据连接选择）。这些设置在用户机器上有所不同，我希望安装程序正确设置它们。是否有安装程序可以在安装过程中使用 .NET 配置文件并允许我创建一些对话框来帮助我填写这些值？

我知道这个问题可能类似于：[Initializing user.config or app.exe.config during install](https://stackoverflow.com/questions/75546/initializing-userconfig-or-appexeconfig-during-install)，但我不限于 VS 2008 安装项目，我想更改配置文件中的设置。

编辑：我看到使用 WIX 是一种选择，但我觉得用大锤敲碎核桃。这可能是唯一的解决方案，但我仍然希望有一些简单的东西。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2008-11-14T15:15:56.700

我们使用 WIX 来更改应用程序的配置文件。它工作得很好，您需要在参考中添加 wixUtilExtension.dll。

WIX 样品：

```
<Component Id="ChangeConfig" Guid="[YOUR_GUID_HERE]">
   <File Id="App.config" Name="MyApplication.exe.config" Vital="yes" KeyPath="yes" Source="[Path to project dir]\app.config" />
   <util:XmlFile Id="AppConfigSetConnStr" Action="setValue" Permanent="yes" File="[#App.config]"            
        ElementPath="/configuration/connectionStrings/add[\[]@name='MyDatabaseName'[\]]" Name="connectionString" 
        Value="Your Connection string values here" />

</Component> 
```

这实际上取决于您使用什么来创建安装程序，您在使用什么？
看看[WIX 教程](http://www.tramontana.co.hu/wix/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-14T18:22:07.213

如果您使用的是 VS 设置项目，您是否创建了自定义操作？我已经将它们用于从戳 XML 值到部署数据库的所有事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T11:10:53.323

我已经使用 WIX 工具集来生成 msi。该工具允许您在安装期间以声明方式指定对 XML 文件（如 app.config）的更改。问题是尽管有一个显着的学习曲线。在 sourceforge 中搜索 wix。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-14T18:19:39.260

我使用带有 XML 插件的 NSIS 来执行此操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-09T21:58:37.727

我知道这是一个老问题，但我们也不想将 WIX 用于一个非常简单的小安装程序。我发现这篇文章详细解释了如何做到这一点。它对我们来说非常有效。

[http://www.c-sharpcorner.com/UploadFile/ddoedens/CustomUI11102005042556AM/CustomUI.aspx](http://www.c-sharpcorner.com/UploadFile/ddoedens/CustomUI11102005042556AM/CustomUI.aspx)

# c++ - 计算几个链接矩形周围的边界

> ID：289779
> 
> 赞同：1
> 
> 时间：2008-11-14T10:59:53.160
> 
> 标签：c++, graphics, geometry

我正在做一个项目，我需要在一组矩形周围创建一个边界。

让我们以这张图片为例来说明我想要完成的事情。

编辑：无法使图像标签正常工作，所以这里是完整链接： [http ://www.flickr.com/photos/21093416@N04/3029621742/](http://www.flickr.com/photos/21093416@N04/3029621742/)

我们有矩形 A 和 C，它们通过特殊的链接矩形 B 链接。您可以将其视为图中的两个节点 (A,C) 和它们之间的边 (B)。这意味着矩形以下列方式具有彼此的指针：A->B、A<-B->C、C->B

每个矩形有四个顶点存储在一个数组中，其中索引 0 位于左下角，索引 3 位于右下角。

我想“遍历”这个链接结构并计算构成它周围边界（红线）的顶点。关于如何实现这一点，我已经有了一些小想法，但想知道你们中的一些更倾向于数学的人是否有一些巧妙的技巧。

我在这里发布这个的原因只是有人可能以前解决过类似的问题，并且有一些我可以使用的想法。我不希望任何人坐下来仔细思考这个问题。在等待答案的同时，我将并行研究解决方案。

非常感谢任何输入。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-16T23:22:34.937

使用示例，其中矩形相互垂直，因此可以由四个值（两个 x 坐标和两个 y 坐标）表示：

```
   1 2 3 4 5 6

1 +---+---+
   | |   
2 + A +---+---+
   | | 乙|
3 + + +---+---+
   | | | | |
4 +---+---+---+---+ +
               | |
5 + C +
               | |
6 +---+---+

```

1）将所有x坐标（左右）收集到一个列表中，然后对其进行排序并删除重复项

```
1 3 4 5 6
```

2）将所有y坐标（顶部和底部）收集到一个列表中，然后对其进行排序并删除重复项

```
1 2 3 4 6
```

3) 通过唯一 x 坐标之间的间隙数 * 唯一 y 坐标之间的间隙数创建一个 2D 数组。每个单元只需要一位，因此在 c++ 中，vector<bool> 可能会为您提供一个非常节省内存的版本

```
4 * 4
```

4）将所有矩形绘制到这个网格中

```
   1 3 4 5 6

1 +---+
   | 1 | 0 0 0
2 +---+---+---+
   | 1 | 1 | 1 | 0
3 +---+---+---+---+
   | 1 | 1 | 1 | 1 |
4 +---+---+---+---+
     0 0 | 1 | 1 |
6 +---+---+

```

5）对于网格中的每个单元格，对于每个边缘，如果在该基本方向上它旁边的单元格没有被绘制，则为该边缘绘制边界线

* * *

在问题中，矩形被描述为四个向量，每个向量代表一个角。如果每个矩形都可以与其他矩形进行任意且不同的旋转，那么我上面概述的方法将行不通。寻找复杂多边形周围路径的问题通常由矢量图形光栅器解决，解决问题的一个好方法是使用像 Cairo 这样的库来为您完成这项工作！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-16T04:35:50.233

这个问题的通用解决方案是根据扫描线实现布尔运算。[你可以在这里](http://boolean.klaasholwerda.nl/algdoc/top.html)找到一个简短的讨论来帮助你开始。从文中：

“布尔算法的基础是扫描线。对于基本原理，Franco P. Preparata 和 Michael Ian Shamos 的[Computational Geometry an Introduction](https://rads.stackoverflow.com/amzn/click/com/3540961313)这本书非常好。”

我拥有这本书，虽然它现在在办公室，所以我无法查找你应该阅读的页码，尽管第 8 章关于矩形的几何形状可能是最好的起点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T16:20:10.843

1.  分别计算所有 3 个矩形的边界之和
2.  计算 A 和 B 的重叠矩形，并从总和中减去
3.  对 B 和 C 的重叠矩形执行相同操作

（要从 A 和 B 中获取重叠矩形，取中间 2 个 X 位置，以及中间 2 个 Y 位置）

示例 (x1,y1) - (x2,y2)：

*   矩形 A：(1,1) - (3,4)
*   矩形 B：(3,2) - (5,4)
*   矩形 C：(4,3) - (6,6)

计算：

1.  10 + 8 + 10 = 28
2.  X 坐标有序 = 1,3,3,5 中间两个是 3 和 3
    Y 坐标有序 = 1,2,4,4 中间两个是 2 和 4
    所以： (3,2) - (3,4) : boundery = 4
3.  X 坐标排序 = 3,4,5,6 中间两个是 4 和 5
    Y 坐标排序 = 2,3,4,6 中间两个是 3 和 4
    所以：(4,3) - (5,4) : boundery = 4
4.  28 - 4 - 4 = 20

这是我的可视化示例：

```
 1   2   3   4   5   6

1  +---+---+
   |       |   
2  +   A   +---+---+
   |       | B     |
3  +       +   +---+---+
   |       |   |   |   |
4  +---+---+---+---+   +
               |       | 
5              +   C   +
               |       |
6              +---+---+ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T11:04:57.360

一个简单的技巧应该是：

1.  从第一个矩形创建一个区域
2.  将其他矩形添加到该区域
3.  获取区域的边界（不知何故？：P）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T11:25:57.957

经过一番思考，我最终可能会做这样的事情：

伪代码：

```
 LinkRectsConnectedTo(Rectangle rectangle,Edge startEdge) // Edge can be West,North,East,South 
    for each edge in rectangle starting with the edge facing last rectangle
       add vertices in the edge to the final boundary polygon
       if edge is connected to another rectangle
          if edge not equals startEdge
             recursively call LinkRectsConnectedTo(rectangle,startEdge) 
```

Obvisouly 这个伪代码必须稍微改进一下，可能无法涵盖所有​​情况，但我想我可能已经解决了我自己的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-14T12:17:02.190

我还没有完全想到这一点，但我想知道你是否不能这样做：

*   列出所有边。
*   获取 P1.X = P2.X 的所有边
*   在该列表中，获取 X 相等的对
*   对于每一对，用一个或两个边缘替换它们不重叠的部分
*   做一些聪明的事情以正确的顺序获得边缘

你的矩形是否总是水平对齐的，如果不是，你也需要做同样的事情，但对于 Y 呢？并且他们总是保证是感动的吗？如果不是，算法不会被破坏，但“正确的顺序”将无法定义。

# c# - C# 中的 Int 到 Char

> ID：289792
> 
> 赞同：116
> 
> 时间：2008-11-14T11:07:40.537
> 
> 标签：c#, casting

鉴于 Int 在有效值范围内，将 Int 值转换为 Utf16 中相应 Char 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：169
> 
> 时间：2008-11-14T11:16:20.113

```
(char)myint; 
```

例如：

```
Console.WriteLine("(char)122 is {0}", (char)122); 
```

产量：

> (char)122 是 z

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2008-11-14T11:15:28.667

```
int i = 65;
char c = Convert.ToChar(i); 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-11-14T12:44:57.393

虽然没有完全按照公式回答问题，但如果您需要或可以将最终结果作为字符串，您也可以使用

```
string s = Char.ConvertFromUtf32(56); 
```

如果需要，它将为您提供代理 UTF-16 对，如果您不在[BMP](http://en.wikipedia.org/wiki/Basic_Multilingual_Plane)一侧，则可以保护您。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-03-12T20:17:18.707

gimel 在 PowerShell 中的回答似乎是：

```
> [char]65
A
> [char]48
0
> [char]97
a 
```

# c# - 检查arraylist中的重复项

> ID：289794
> 
> 赞同：5
> 
> 时间：2008-11-14T11:08:48.320
> 
> 标签：c#, .net, asp.net

我有一个数组列表，其中包含名为 Room 的项目。每个房间都有一个房间类型，例如厨房、接待处等。我想在将其添加到列表之前检查数组列表以查看是否存在该类型的房间。任何人都可以推荐一种无需多个 foreach 循环的简洁方法吗？

（.NET 2.0）

* * *

我无法访问 .net 2.0 上运行的 linq 技术。我应该在问题中说明这一点。道歉

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-14T11:21:23.443

我不会`ArrayList`在这里使用；由于您拥有 .NET 2.0，因此使用`List<T>`一切变得简单：

```
List<Room> rooms = ...
string roomType = "lounge";
bool exists = rooms.Exists(delegate(Room room) { return room.Type == roomType; }); 
```

或者使用 C# 3.0（仍然针对 .NET 2.0）

```
bool exists = rooms.Exists(room => room.Type == roomType); 
```

或者使用 C# 3.0 和[LINQBridge](http://www.albahari.com/nutshell/linqbridge.aspx)或 .NET 3.5：

```
bool exists = rooms.Any(room => room.Type == roomType); 
```

（该`Any`用法将适用于更多类型，而不仅仅是`List<T>`）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T11:14:33.830

```
if (!rooms.Any (r => r.RoomType == typeToFind /*kitchen, ...*/))
  //add it or whatever 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T20:28:14.853

从你的问题来看，如果你想强制执行可能只有一个给定类型的房间的规则，或者你只是想知道，我并不是 100% 清楚。

如果您有一个不变量，即没有 s 的集合`Room`可能具有多个相同`Room`类型，您可以尝试使用 a `Dictionary<Type, Room>`。

这样做的好处是不对 add 执行线性搜索。

您将使用以下操作添加房间：

```
if(rooms.ContainsKey(room.GetType()))
{
   // Can't add a second room of the same type
   ...
}
else
{
   rooms.Add(room.GetType(), room);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T12:10:48.180

我认为使用列表并在需要`O(n)`时间的操作中执行 Exists。如果内存不是问题，那么使用`Dictionary`代替是并且是首选。`O(1)`

如果您不需要顺序列表，我会尝试使用`Dictionary`这样的：

```
Dictionary<Type, List<Room>> rooms = new Dictionary<Type, List<Room>>;

void Main(){
  KitchenRoom kr = new KitchenRoom();
  DummyRoom dr = new DummyRoom();
  RoomType1 rt1 = new RoomType1();
  ... 

  AddRoom(kr);
  AddRoom(dr);
  AddRoom(rt1);
  ...

}

void AddRoom(Room r){
  Type roomtype = r.GetType();
  if(!rooms.ContainsKey(roomtype){ //If the type is new, then add it with an empty list
   rooms.Add(roomtype, new List<Room>);
  }
  //And of course add the room.
  rooms[roomtype].Add(r);
} 
```

你基本上有一个不同房间类型的列表。但是这个解决方案只有在你不需要 arraylist 时才可以。但对于大型列表，这将是最快的。

我曾经有过一个`List<string>`包含 300.000 多个项目的解决方案。将每个元素与另一个几乎相同大小的列表进行比较需要花费 12 小时的时间。将逻辑改为使用 Dictionary 并缩短到 12 分钟。对于较大的列表，我总是去`Dictionary<mytype, bool>`哪里 bool 只是一个没有被使用的假人。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T20:07:31.353

不使用 lambda 表达式：

```
void AddRoom(Room r, IList<Room> rooms, IDictionary<string, bool> roomTypes)
{
   if (!roomTypes.Contains(r.RoomType))
   {
      rooms.Add(r);
      roomTypes.Add(r.RoomType, true);
   }
} 
```

字典中值的类型实际上并不重要，因为您唯一看到的是键。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-14T20:15:48.777

另一种方法是对数组进行排序，然后遍历元素，直到找到一对相邻的重复项。坚持到底，阵列是无重复的。

# windows - 从部署包中卸载 Windows 服务

> ID：289796
> 
> 赞同：0
> 
> 时间：2008-11-14T11:08:56.290
> 
> 标签：windows, visual-studio, deployment, service

我知道您可以通过我已经完成的 VS 部署系统安装您的 Windows 服务。但是在那之后你如何部署更新呢？每次我部署一个新版本时，它都会说该服务已经存在并退出。

我尝试使用以下内容添加一个小的 DOS CMD 文件： net stop [ServiceName] sc delete [ServiceName]

如果我可以运行它会很好，但是部署系统中的自定义脚本选项不允许该文件类型。

我怎么能a）。在客户端 pc 或 b) 上更新我的包。从我的安装程序中运行该卸载实用程序以便我可以运行更新？

任何帮助将不胜感激。

问候，

风暴

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T11:36:35.207

如果该服务已经安装，您需要做的就是 NET STOP 它，替换 exe，然后 NET START 服务。

# java - 在 Eclipse 3.4 中哪里可以找到 Maven 安装目录

> ID：289800
> 
> 赞同：19
> 
> 时间：2008-11-14T11:10:35.353
> 
> 标签：java, maven-2, eclipse-plugin

我已经从[http://m2eclipse.codehaus.org/](http://web.archive.org/web/20150524020820/http://m2eclipse.codehaus.org/)安装了 m2eclipse 插件。现在我想将它用作独立的构建工具，但我找不到安装目录。任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2016-09-13T21:15:55.363

执行以下命令：

```
mvn --version 
```

示例结果：

```
Apache Maven 3.0.5 (r01de14724cdef164cd33c7c8c2fe155faf9602da; 2013-02-19  14:51:28+0100)
Maven home: `D:\apache-maven-3.0.5\bin`\..
Java version: 1.6.0_25, vendor: Sun Microsystems Inc.
Java home: C:\Program Files\Java\jdk1.6.0_25\jre
Default locale: nl_NL, platform encoding: Cp1252
OS name: "windows 7", version: "6.1", arch: "amd64", family: "windows" 
```

Maven Home 将显示 maven 的安装位置。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-14T12:53:26.533

我有插件（带有嵌入式 maven 实例）和完整的 maven 下载。两者最终都应该使用相同的存储库，例如`C:\Documents and Settings\user\.m2`.

在某些情况下，无论如何您都需要完整的 Maven 下载。例如，尝试构建一个 groovy maven 插件会导致嵌入式 maven 崩溃，但可以正常下载完整下载。

您还可以从 Eclipse 的首选项窗格中指定使用与嵌入式安装不同的 maven 安装。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-05-08T09:12:23.040

我的 Eclipse 使用的是默认 Maven 版本 (3.0.4)。所以试试这个：

**选项 1**：重新启动 重新启动 Eclipse 并在“Windows”->“首选项”->“Maven”->“安装”下查看 Maven 配置是否正确

**选项2**：选择/配置您的嵌入式“Maven运行时”右键单击您的项目->“运行方式...”->在“Maven Build”下，选项卡“Main”->在Drop中选择“External”Maven - 下框。然后运行它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-14T12:35:07.163

我不确定你想要什么。m2eclipse 是 Eclipse 的**插件**，因此必须在 Eclipse 中运行。

要拥有一个独立的构建工具，我建议您直接下载[Maven2 二进制文件](http://maven.apache.org/download.html)，然后将其安装到您的计算机上（如果尚未完成）！

供您参考，所有插件都存储在 eclipse-dir/plugins 目录中，作为子目录或 JAR 文件。

# java - 让调用者访问 Spring AOP 代理

> ID：289801
> 
> 赞同：2
> 
> 时间：2008-11-14T11:10:38.550
> 
> 标签：java, spring, proxy, aop

我正在寻找一种方法来开发打印调用者类的 MethodInterceptor。

有没有办法让调用者对象进入方法拦截器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T05:18:41.343

这可能有效，声明一个异常，然后在您的方法被拦截时使用它来查看堆栈：

```
 Throwable t = new Throwable();
StackTraceElement[] elements = t.getStackTrace();

String calleeMethod = elements[0].getMethodName();
String callerMethodName = elements[1].getMethodName();
String callerClassName = elements[1].getClassName();

System.out.println("CallerClassName=" + callerClassName + " , Caller method name: " + callerMethodName);
System.out.println("Callee method name: " + calleeMethod); 

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T11:21:02.367

您可以通过生成堆栈跟踪并检查它来做一些粗略的事情，但这很难看

# java - 线程何时超出范围？

> ID：289804
> 
> 赞同：9
> 
> 时间：2008-11-14T11:12:05.833
> 
> 标签：java, multithreading, scope

我编写了一个计算文本中的行数、单词数和字符数的程序：它使用线程来执行此操作。有时效果很好，但有时效果不佳。最终发生的是指向计数的单词和字符数量的变量有时会出现短缺，有时不会。

在我看来，线程有时会在他们计算出他们想要的所有单词或字符之前就结束了。是因为当 while (true) 循环中断时这些线程超出范围吗？

我在下面包含了我的问题的线程部分的代码：

```
private void countText() {
  try {
    reader = new BufferedReader(new FileReader("this.txt"));
    while (true) {
      final String line = reader.readLine();
      if(line == null) {break;}
      lines++;
      new Thread(new Runnable() {public void run() {chars += characterCounter(line);}}).start();
      new Thread(new Runnable() {public void run() {words += wordCounter(line);}}).start();
      println(line);
    }

  } catch(IOException ex) {return;}

} 
```

（子问题：这是我第一次询问一些事情并发布代码。我不想使用 StackOverflow 代替谷歌和维基百科，并且担心这不是一个合适的问题？我试图让问题更笼统，所以我不只是寻求我的代码帮助......但是，是否有另一个网站可能更适合这类问题？）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-14T11:49:03.323

不同的线程设计将更容易找到和解决此类问题，并且更有效地进行讨价还价。这是一个冗长的回应，但总结是“如果你在 Java 中做线程，请尽快检查[java.util.concurrent ”。](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/package-summary.html)

我猜你正在多线程处理这段代码来学习线程，而不是加快计算单词的速度，但这是使用线程的一种非常低效的方式。您*每行*创建两个线程- 一千行文件有两千个线程。创建线程（在现代 JVM 中）使用操作系统资源并且通常相当昂贵。当两个 - 更不用说两千个 - 线程必须访问共享资源（例如您的`chars`和`words`计数器）时，由此产生的内存争用也会损害性能。

`synchronized`按照[Chris Kimpton 的建议](https://stackoverflow.com/questions/289804/when-does-a-thread-go-out-of-scope#289818)或[WMR 的建议](https://stackoverflow.com/questions/289804/when-does-a-thread-go-out-of-scope#289851)`Atomic`制作计数器变量可能会修复代码，但也会使争用的效果更糟。我很确定它会比单线程算法慢。

我建议只有一个长期存在的线程来照顾`chars`和 一个用于`words`，每个线程都有一个工作队列，每次您想添加一个新号码时，您都可以向该工作队列提交作业。这样，只有一个线程写入每个变量，如果您对设计进行更改，谁负责什么将更加明显。它也会更快，因为没有内存争用，并且您不会在紧密循环中创建数百个线程。

同样重要的是，一旦您读取了文件中的所有行，在实际打印出计数器的值之前*等待*所有线程完成，否则您将丢失尚未完成的线程的更新。使用您当前的设计，您必须建立一个您创建的线程的大列表，并在最后运行它以检查它们是否都已死亡。使用队列和工作线程设计，您可以告诉每个线程排空其队列，然后等到它完成。

Java（从 1.5 及更高版本）使这种设计非常容易实现：查看[java.util.concurrent.Executors.newSingleThreadExecutor](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/Executors.html#newSingleThreadExecutor)。它还使以后添加更多并发性变得容易（假设适当的锁定等），因为您可以切换到线程池而不是单个线程。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-14T11:37:31.303

正如 Chris Kimpton 已经正确指出的那样，您在更新不同线程时遇到了`chars`问题`words`。同步`this`也不起作用，因为`this`它是对当前线程的引用，这意味着不同的线程将在不同的对象上同步。您可以使用可以同步的额外“锁定对象”，但解决此问题的最简单方法可能是将[AtomicIntegers](http://java.sun.com/javase/6/docs/api/java/util/concurrent/atomic/AtomicInteger.html)用于 2 个计数器：

```
AtomicInteger chars = new AtomicInteger();
...
new Thread(new Runnable() {public void run() { chars.addAndGet(characterCounter(line));}}).start();
... 
```

虽然这可能会解决您的问题，但[Sam Stoke 更详细的答案](https://stackoverflow.com/questions/289804/when-does-a-thread-go-out-of-scope#289869)是完全正确的，原始设计效率非常低。

要回答有关线程何时“超出范围”的问题：您正在为文件中的每一行启动两个新线程，并且所有线程都将运行，直到它们到达`run()`方法的末尾。这是除非你让它们成为[守护线程）](http://java.sun.com/javase/6/docs/api/java/lang/Thread.html#setDaemon(boolean))，在这种情况下，只要守护线程是唯一仍在此 JVM 中运行的线程，它们就会退出。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-14T11:17:29.177

对我来说听起来是个好问题......我认为这个问题可能与字符 += 和单词 += 的原子性有关 - 多个线程可能同时调用它 - 你做任何事情来确保有没有交错。

那是：

线程 1，有 chars = 10，想加 5

线程 2，有 chars = 10，想要添加 3

线程 1 计算出新的总数，15

线程 2 计算出新的总数，13

线程 1 将 chars 设置为 15

线程 2 将 chars 设置为 13。

除非您在更新这些变量时使用同步，否则可能是可能的。

# linq - linq 帮助 - 新手

> ID：289809
> 
> 赞同：0
> 
> 时间：2008-11-14T11:14:15.580
> 
> 标签：linq, c#-3.0, subsonic-v3p2

这个工作怎么来的

```
public IQueryable<Category> getCategories(int postId)  
{
      subnusMVCRepository<Categories> categories = new subnusMVCRepository<Categories>();
      subnusMVCRepository<Post_Category_Map> postCategoryMap = new  subnusMVCRepository<Post_Category_Map>();

      var query = from c in categories.GetAll()
                  join pcm in postCategoryMap.GetAll() on c.CategoryId equals pcm.CategoryId
                  where pcm.PostId == 1
                  select new Category
                  {
                    Name = c.Name,
                    CategoryId = c.CategoryId
                  };
       return query;
} 
```

但这并不

```
public IQueryable<Category> getCategories(int postId)  
{
subnusMVCRepository<Categories> categories = new subnusMVCRepository<Categories>();
subnusMVCRepository<Post_Category_Map> postCategoryMap = new subnusMVCRepository<Post_Category_Map>();

    var query = from c in categories.GetAll()
                join pcm in postCategoryMap.GetAll() on c.CategoryId equals pcm.CategoryId
                where pcm.PostId == postId
                select new Category
                {
                    Name = c.Name,
                    CategoryId = c.CategoryId
                };
    return query;
  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T13:50:29.803

该问题很可能出现在查询提供程序的实现中。

pcm.PostId == 1

和

pcm.PostId == postId

实际上有很大的不同。在表达式树中，第一个生成为不需要评估的 ConstantExpression。

对于第二个，编译器实际上在这里生成了一个内部类（这是您看到的 _DisplayClassX）。此类将具有一个属性（很可能与您的参数同名），并且表达式树将创建一个指向自动生成的 DisplayClassX 的 MemberAccessExpression。当您查询提供程序遇到此问题时，您需要 Compile() Lambda 表达式并评估委托以获取要在查询中使用的值。

希望这可以帮助。

科沙利文

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T11:35:39.640

问题不在于 linq 本身，您需要确保上下文或提供者对象能够获取数据。尝试测试

```
subnusMVCRepository<Categories> categories = new subnusMVCRepository<Categories>();
subnusMVCRepository<Post_Category_Map> postCategoryMap = new subnusMVCRepository<Post_Category_Map>(); 
```

对象并查看它们是否已填充或是否按要求运行。

您可能想搜索 c__DisplayClass1 的生成代码并查看您可以在那里看到的内容。有时生成的代码会产生一些奇怪的东西。

当您进入代码时，请检查局部变量和变量值。这也可能给你一些线索。

**编辑：**您是否尝试返回 List<> 集合？还是 Enumerable 类型？

**编辑：****项目**的真实类型是什么，查询可能不可迭代

# flash - 如何流畅播放一系列 FLV 视频（在 AS2 中）？

> ID：289812
> 
> 赞同：1
> 
> 时间：2008-11-14T11:14:51.693
> 
> 标签：flash, flv

在 Flash 中播放一系列 flv 视频文件（使用 actionscript）的最佳方法是什么？我的目标是尽可能顺利地进行过渡。

目前我正在使用 netStream 类并捕获 onStatus 事件以在当前视频达到其结束持续时间时播放下一个视频。尽管这种方法效果很好，但当前视频的结尾和下一个视频的开头之间仍然存在很小的差距。关于如何优化此方法的任何想法？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-18T13:56:47.153

我真的不能正确回答这个问题，因为我只知道 as3 但到目前为止你还没有其他答案。

我认为这是因为您触发新视频开始播放，并且它首先必须下载和缓冲电影的一部分，然后才能开始播放，因此延迟。您可以在不同的组件中更早地开始下一部电影并在第一帧暂停它，并在前一帧完成时以某种方式交换和取消暂停，以便它已经准备好播放？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-21T10:47:57.670

我的想法完全正确！这就是我接近这个概念的方式，唯一的问题是当前视频的结尾和下一个视频的开始之间的差距仍然存在。

我的解决方案：尝试捕获视频的元数据（尤其是持续时间），并使用 setInterval 来检查视频的播放秒数是否接近视频文件的末尾。当它接近尾声时，我删除视频文件并开始播放下一个视频。这种方法在本地运行良好，但在网上我仍然遇到一些问题。当我找到合适的解决方案时，我会通知您。

# macos - 在 Mac OS X 上获取当前堆栈跟踪

> ID：289820
> 
> 赞同：6
> 
> 时间：2008-11-14T11:20:22.103
> 
> 标签：macos, backtrace

我正在尝试研究如何在 Mac OS X 上的 C++ 应用程序中存储并打印当前堆栈。主要问题似乎是让 dladdr 在主可执行文件中给出地址时返回正确的符号。我怀疑这个问题实际上是一个编译选项，但我不确定。

我已经尝试过来自 Darwin/Leopard 的回溯代码，但它调用了 dladdr，并且与我自己的调用 dladdr 的代码有相同的问题。

原始帖子：目前我正在使用以下代码捕获堆栈：

```
int BackTrace(Addr *buffer, int max_frames)
{
    void **frame = (void **)__builtin_frame_address(0);
    void **bp = ( void **)(*frame);
    void *ip = frame[1];
    int i;

    for ( i = 0; bp && ip && i < max_frames; i++ )
    {
        *(buffer++) = ip;
        ip = bp[1];
        bp = (void**)(bp[0]);
    }

    return i;
} 
```

这似乎工作正常。然后使用 dladdr 打印我正在查看的堆栈，如下所示：

```
Dl_info dli;
if (dladdr(Ip, &dli))
{
    ptrdiff_t       offset;
    int c = 0;

    if (dli.dli_fname && dli.dli_fbase)
    {
        offset = (ptrdiff_t)Ip - (ptrdiff_t)dli.dli_fbase;
        c = snprintf(buf, buflen, "%s+0x%x", dli.dli_fname, offset );
    }
    if (dli.dli_sname && dli.dli_saddr)
    {
        offset = (ptrdiff_t)Ip - (ptrdiff_t)dli.dli_saddr;
        c += snprintf(buf+c, buflen-c, "(%s+0x%x)", dli.dli_sname, offset );
    }

    if (c > 0)
        snprintf(buf+c, buflen-c, " [%p]", Ip); 
```

这几乎可以工作，一些示例输出：

```
/Users/matthew/Library/Frameworks/Lgi.framework/Versions/A/Lgi+0x2473d(LgiStackTrace+0x5d) [0x102c73d]
/Users/matthew/Code/Lgi/LgiRes/build/Debug/LgiRes.app/Contents/MacOS/LgiRes+0x2a006(tart+0x28e72) [0x2b006]
/Users/matthew/Code/Lgi/LgiRes/build/Debug/LgiRes.app/Contents/MacOS/LgiRes+0x2f438(tart+0x2e2a4) [0x30438]
/Users/matthew/Code/Lgi/LgiRes/build/Debug/LgiRes.app/Contents/MacOS/LgiRes+0x35e9c(tart+0x34d08) [0x36e9c]
/Users/matthew/Code/Lgi/LgiRes/build/Debug/LgiRes.app/Contents/MacOS/LgiRes+0x1296(tart+0x102) [0x2296]
/Users/matthew/Code/Lgi/LgiRes/build/Debug/LgiRes.app/Contents/MacOS/LgiRes+0x11bd(tart+0x29) [0x21bd] 
```

它为共享对象获取方法名称，但不适用于主应用程序。那些只是映射到“tart”（或“start”减去第一个字符）。

理想情况下，我想要行号以及此时的方法名称。但我会为初学者选择正确的函数/方法名称。也许在那之后拍摄行号，在 Linux 上，我听说您必须为具有自己的指令集的私有 ELF 块编写自己的解析器。听起来很吓人。

无论如何，任何人都可以对这段代码进行排序，以便正确获取方法名称吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-14T15:59:45.597

您的目标是什么 OS X 版本。如果您在 Mac OS X 10.5 和更高版本上运行，您可以只使用 backtrace() 和 backtrace_symbols() 库调用。它们在 execinfo.h 中定义，并且有一个带有一些示例代码的手册[页。](https://developer.apple.com/legacy/library/documentation/Darwin/Reference/ManPages/man3/backtrace.3.html)

编辑：

您在评论中提到您需要在 Tiger 上运行。您可能只在您的应用程序中包含来自 Libc 的实现。源代码可从 Apple 的开源站点获得。这是相关[文件](https://opensource.apple.com/source/Libc/Libc-498.1.1/gen/backtrace.c.auto.html)的链接。

# delphi - 为什么 TList.Remove() 会产生 EAccessViolation 错误？

> ID：289825
> 
> 赞同：8
> 
> 时间：2008-11-14T11:22:03.487
> 
> 标签：delphi, generics, delphi-2009, tlist

为什么在执行下面的代码时会引发 EAccessViolation？

```
uses
  Generics.Collections;
  ...

var
  list: TList<TNotifyEvent>;
  ...

begin
  list := TList<TNotifyEvent>.Create();
  try
    list.Add(myNotifyEvent);
    list.Remove(myNotifyEvent);  // EAccessViolation at address...
  finally
    FreeAndNil(list);
  end;
end;

procedure myNotifyEvent(Sender: TObject);
begin
  OutputDebugString('event');  // nebo cokoliv jineho
end; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-14T11:59:02.710

它看起来像一个错误。

如果您使用调试 dcu 进行编译（通常不要这样做，除非您想失去理智！）您会看到对比较器的调用出错了。比较函数的第三个值（可能是可选的）未设置并导致访问冲突。

因此，您可能无法将方法指针放在通用列表中。

好的，以下工作：

```
uses
  Generics.Defaults;

type
  TForm4 = class(TForm)
    ...
  private
    procedure myNotifyEvent(Sender: TObject);
  end;

TComparer<T> = class (TInterfacedObject, IComparer<T>)
public
  function Compare(const Left, Right: T): Integer;
end;

implementation

uses
  Generics.Collections;

var
  list: TList<TNotifyEvent>;
begin
  list := TList<TNotifyEvent>.Create(TComparer<TNotifyEvent>.Create);
  try
    list.Add(myNotifyEvent);
    list.Remove(myNotifyEvent);
  finally
    FreeAndNil(list);
  end;
end;

procedure TForm4.myNotifyEvent(Sender: TObject);
begin
  ShowMessage('event');
end;

{ TComparer<T> }

function TComparer<T>.Compare(const Left, Right: T): Integer;
begin
  Result := 0;
end; 
```

您必须定义自己的比较器，并且可能具有更多的智能;-)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-01-14T19:13:32.123

访问冲突是由缺少比较器引起的。我怀疑这已在补丁中修复，但如果您使用 TObjectList，问题仍然存在（至少在 Delphi 2009 中），所以我只是用最简单的解决方案进行更新：

```
TList<TNotifyEvent>.Create(TComparer<TNotifyEvent>.Default); 
```

或者在我的情况下

```
TObjectList<TNotifyEvent>.Create(TComparer<TNotifyEvent>.Default); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T12:19:27.757

是否可以将自定义比较器传递给`TList<T>`？我面前没有D2009，所以不能尝试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T11:50:04.260

上面的代码用于 TForm1 ...

```
uses 
  Generics.Collections;

procedure TForm1.Button1Click(Sender: TObject);
var
  list: TList<TNotifyEvent>;
begin
  list := TList<TNotifyEvent>.Create();
  try
    list.Add(myNotifyEvent);
    list.Remove(myNotifyEvent);  // EAccessViolation at address...
  finally
    FreeAndNil(list);
  end;
end;
procedure TForm1.myNotifyEvent(Sender: TObject);
begin
  OutputDebugString('event');  // nebo cokoliv jineho
end; 
```

# asp.net - 为什么 aspnet_compiler.exe 这么慢（并且可以做得更快）？

> ID：289831
> 
> 赞同：29
> 
> 时间：2008-11-14T11:26:59.203
> 
> 标签：asp.net, aspnet-compiler, pre-compilation

在我们的构建过程中，我们`aspnet_compiler.exe`针对我们的网站运行，以确保 ASP.NET/MVC 中的所有后期绑定的东西都实际构建（我对 ASP.NET 一无所知，但我确信这是防止在运行时发现故障所必需的）。

我们的网站规模相当大，有几百个页面/视图/控件/等。但是，在 10-15 分钟范围内所花费的时间似乎过多（作为参考，这比编译大约 40 个项目的整个解决方案所需的时间要长，而且我们只预编译了两个网站项目）。

我怀疑硬件是问题，因为我在最新的四核 Intel 芯片上运行，配备 4GB RAM 和 WD Velociraptor 10,000rpm 硬盘。奇怪的是，EXE 似乎并没有使用太多的 CPU (1-5%)，而且似乎也没有做太多的 I/O。

那么......这是一个已知问题吗？为什么这么慢？有什么办法可以加快速度吗？

**注意：**为了澄清人们已经回答的一些事情，我并不是在谈论 Visual Studio 中的代码编译。我们已经在使用 Web 应用程序项目，编译速度不是问题。问题是作为开发构建脚本的一部分，这些项目已经被编译（[有关更多详细信息，请参阅此 MSDN 页面）](http://msdn.microsoft.com/en-us/library/ms229863.aspx)*之后*对站点进行预编译。我们正在执行就地预编译，而不是将文件复制到目标目录。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-08-26T12:13:41.643

切换到 Roslyn 编译器很可能会显着缩短预编译时间。这是一篇关于它的好文章：[https](https://devblogs.microsoft.com/aspnet/enabling-the-net-compiler-platform-roslyn-in-asp-net-applications/) ://devblogs.microsoft.com/aspnet/enabling-the-net-compiler-platform-roslyn-in-asp-net-applications/ 。

除此之外，确保通过在编译元素上将批处理属性设置为 true 来启用批处理编译。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-16T01:09:04.490

简单地说，`aspnet_compiler`当它开始预编译任何单独的 aspx 页面时，它实际上使用了“全局编译器锁”；基本上只允许按顺序编译每一页。

这是有原因的（尽管我个人不同意它们）-主要是为了检测和防止循环引用导致各种无限循环，以及确保在编译所需页面之前正确构建所有依赖项，它们避免很多“讨厌的 CS 问题”。

`aspnet_compiler.exe`我曾经开始写我上次在一家网络公司工作的大规模分叉版本，但被“真正的工作”束缚住了，从未完成它。最大的问题是 ASPX 页面：可以并行化 HELL 的 MVC/Razor 东西，但是 ASPX 解析/编译引擎大约有 20 级深度的内部和私有类/方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-17T01:49:52.470

1.  编译器应该为每个 .aspx 页面生成第二个代码隐藏文件，[检查](http://webproject.scottgu.com/CSharp/UnderstandingCodeBehind/UnderstandingCodeBehind.aspx "查看")
2.  在编译过程中，aspnet_compiler.exe 会将所有网站文件复制到输出目录，包括 css、js 和图像。

[使用Web 应用程序项目](http://webproject.scottgu.com/ "网络应用项目")而不是网站模型，您将获得更好的编译时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T11:44:58.683

我对此编译器没有任何具体的热门提示，但是当我遇到此类问题时，我运行 ProcMon 以查看进程在机器上执行的操作，并运行 Wireshark 以检查它是否没有花费时间- 对在某些注册表项或环境变量中引用的长期被遗忘的机器进行一些网络访问。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-06-08T14:03:18.010

只是我的2美分。

显着降低 ASP.NET 视图预编译速度的原因之一`-fixednames`是`aspnet_compiler.exe`. **不要使用它，**尤其是在使用 Razor/MVC 时。

从 Visual Studio 发布 wep 应用程序时，请确保选择“不合并”，并且**不要**选择“创建单独的程序集”，因为这是导致全局锁定并减慢速度的原因。

[![在此处输入图像描述](https://i.stack.imgur.com/qw0ge.png)](https://i.stack.imgur.com/qw0ge.png)

更多信息在这里[https://msdn.microsoft.com/en-us/library/hh475319(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/hh475319(v=vs.110).aspx)

# c++ - 使用 wxWidgets 发布到 URL

> ID：289838
> 
> 赞同：1
> 
> 时间：2008-11-14T11:31:21.097
> 
> 标签：c++, wxwidgets, wxhttp

有没有人有一些示例代码显示如何使用 wxWidgets 发布到 URL？文档和讨论论坛暗示这是可能的，但是与您在 .NET 和 Perl 和 Ruby 等脚本语言中找到的方法相比，wxHTTP 中的方法非常低级。我真的必须自己创建 HTTP 请求并通过 SocketOutputStream 将其发送到服务器吗？我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T12:08:43.207

我最初遇到了类似的问题，最终改用 Curl，因为它也是跨平台的并且非常易于使用。

蒂姆

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-17T17:12:24.590

最后，这里也一样。尝试使用 wxHTTP 并最终使用 Curl。卷曲是一种与之合作的魅力......

乔

# c# - 封装 VS 继承 - 如何使用受保护的函数？

> ID：289841
> 
> 赞同：2
> 
> 时间：2008-11-14T11:33:11.750
> 
> 标签：c#, vb.net, oop, inheritance, encapsulation

在 C# 或 VB.NET 等 OOP 语言中，如果我在超类中创建属性或方法，`protected`我将无法在我的表单中访问它们 - 它们只能在从该超类继承的类中访问。

要访问这些属性或方法，我需要创建它们`public`，这会破坏封装，或者将它们重新写入我的类，这会破坏继承。

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T11:45:14.487

如果您的代码需要要求类执行特定操作，但该类没有为您的代码提供执行此操作的方法，则该类不满足您的代码要求。

这有点像说我有一辆带有受保护方向盘的汽车（汽车），所以我无法访问它。车对我没用。

要么将这些成员设为公共（或至少在内部）并使用它们，要么放弃该类并使用一个为您的消费代码提供所需功能的类。

也许你真正要找的是一个界面。该接口包含您的代码所需的成员，并且您在类上实现该接口。这里的优点是您的类可以确定成员正在通过此接口而不是继承的子类访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T12:00:37.903

“需要将它们公开，这会破坏封装”

不要将好的设计与讨厌的可见性规则混为一谈。可见性规则令人困惑。实际上有两种正交的可见性——子类和客户端。目前还不清楚为什么我们会从我们的子类中隐藏任何东西。但我们可以，用`private`.

这是重要的。封装并不意味着隐藏。受保护和私有不是良好封装的重要组成部分。您可以在所有内容都公开的情况下进行良好的设计（例如，Python 就是这样工作的）。

受保护/私有的东西——主要是——关于知识产权管理：你是否愿意（以具有法律约束力的“如果它不起作用”的方式）承诺界面？如果您的软件开发涉及律师，那么您会关心为您不承诺的事情添加保护和私有。

如果您不必与律师打交道，请考虑正确封装，但将所有内容公开。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T11:46:52.393

抱歉，不清楚您所说的“在我的表格中”是什么意思-您的表格和您的两个班级之间的关系是什么？如果你的类是同一个项目中的控件，并且你想从表单中访问属性，你应该使用'internal'关键字。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T16:20:43.640

至少有三种方法可以限制谁可以使用特定类实例的某些特定实例方法：

1.  Define the method as `protected`, `internal`, or `private`. In the first case, an instance method will only be usable from within derived-class methods of the same instance; in the second case, all classes within the assembly will have access to those methods, but classes outside won't; in the third case, no outside classes, even derived ones in the same assembly, will have access, unless their code is nested within the declaring class.
2.  Define the method as `public`, but have the classes that create instances keep them private and never expose them to the outside world. Anyone wanting to invoke an instance method on an object has to have an instance to invoke it on. If a class holds instances but never exposes direct references to them, the only instance methods that can ever be used on those instances will be those which the holding classes uses itself.
3.  Define the method as `public`, but have a constructor which accepts a location into which one or more delegates to private methods may be stored. Code with access to those delegates will be able to call the methods referred to thereby, but other code will not (except by using Reflection in ways which I think are only usable in full-trust scenarios).

If Reflection in non-full-trust scenarios would allow unbound delegates to be bound to arbitrary object instances, one could use nested classes to reinforce #3 so that one would have to access `private` fields to gain illegitimate access to the `private` functions; that would definitely be forbidden outside full-trust scenarios.

# ms-access - 访问 VBA：运行时错误 3734

> ID：289843
> 
> 赞同：0
> 
> 时间：2008-11-14T11:34:48.783
> 
> 标签：ms-access, vba

谁能给我详细信息

> 运行时错误 3734

在访问 vba 中。

作为参考，我从以下线程中的代码中获取它

[如何在访问中运行查询循环？](https://stackoverflow.com/questions/233026/how-to-run-a-loop-of-queries-in-access)

```
Sub plausibt_check()

Dim rs As DAO.Recordset
Dim rs2 As ADODB.Recordset
Dim db As database
Dim strsql As String
Dim tdf As TableDef

Set db = opendatabase("C:\Codebook.mdb")
Set rs = db.OpenRecordset("querycrit")

Set rs2 = CreateObject("ADODB.Recordset")
rs2.ActiveConnection = CurrentProject.Connection

For Each tdf In CurrentDb.TableDefs ' in this line the error occurs 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-16T20:38:12.570

我不明白你想做什么。为什么要使用一个 DAO 记录集和一个 ADO？这根本没有意义。如果您在 Access 前端保存了查询，那么即使您的后端是，例如，带有 ODBC 表链接的 SQL Server，使用 ADO 也没有任何实用程序。

您的代码中没有循环的证据，因此除非您的代码被循环调用，否则在我看来，知识库文章的解释并不适用。

我不知道你想要做什么，但是关于打开你的数据库一次，而不是在你的循环的每次重复中，对于任何想到它的人来说都应该是非常明显的。如果您正在运行一个循环并在循环的每次重复中重复打开同一个数据库，那么很明显该操作属于循环之外。

那将是这样的：

```
 Dim db As DAO.Database
  Dim qdf As DAO.QueryDef

  Set db = CurrentDB()

  For Each qdf in db.QueryDef
    [do whatever here]
  Next qdf

  Set qdf = Nothing
  Set db = Nothing 
```

在该代码中，您使用的是当前在用户界面中打开的 MDB，但这并不重要——无论您打开哪个数据库并在其对象中循环，都应该只在循环外打开一次。

如果您想让您的循环位于从您的主代码调用的子例程中，则将数据库变量作为参数传递给您的子例程。子程序将是这样的：

```
 Public Sub ProcessQueries(db As DAO.Database)
    Dim qdf As DAO.QueryDef

    For Each qdf in db.QueryDef
      [do whatever here]
    Next qdf

    Set qdf = Nothing
  End Sub 
```

你会这样称呼它：

```
 Dim db As DAO.Database

  Set db = CurrentDB()    
  Call ProcessQueries(db)    
  Set db = Nothing 
```

现在，如果您坚持从 DAO 获取源数据，然后通过 ADO 对其进行处理，那么您将有一个 DAO 循环并在其中和 ADO 循环。因此，您希望在 DAO 循环之外而不是在其内部定义 ADO 连接。唯一的例外是，如果您从 DAO 循环中提取的数据定义了您使用 ADO 打开的数据库。由于我们不知道您实际上想要完成什么，因此几乎不可能就您应该在代码中更改的确切内容给出好的建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T13:26:29.307

您似乎在当前数据库中使用 ADO 而不保存。您必须在运行包含 ADO 的代码之前保存。

# vb.net - 为什么是 Type.Equals(t1, t2) 而不是等式运算符？

> ID：289845
> 
> 赞同：3
> 
> 时间：2008-11-14T11:35:54.507
> 
> 标签：vb.net, reflection, types, equals

为什么必须`Type.Equals(t1, t2)`使用确定等价类型，而不是相等运算符（例如对于 VB.NET，`t1 = t2`）？

它似乎与 .NET API 的其他部分不一致。

VB.NET 中的示例：

`If GetType(String) = GetType(String) Then Debug.Print("The same, of course") End If`

导致“ `Operator '=' is not defined for types 'System.Type' and 'System.Type'.`”的编译时错误

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-14T11:56:27.133

据此[，](http://msdn.microsoft.com/en-us/library/215yacb6.aspx) VB 相等运算符进行值比较，而不是引用比较。使用 Type.Equals(t1,t2) 强制它进行参考比较。如果 t1 和 t2 是类型，我认为两者都可以，但我是 C# 人，所以我知道什么。如果我不关心精确的类型匹配，我可能更喜欢使用`is`已知类的语法和。`IsInstanceOf`

```
Typeof a Is Boolean

a.GetType().IsAssignableFrom( b.GetType() ) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T11:48:25.150

考虑到类型的加载方式，这让我感到惊讶。你从哪里听说的？

[System.Type.Equals(Type)](http://msdn.microsoft.com/en-us/library/3ahwab82.aspx)的文档建议它通过[UnderlyingSystemType](http://msdn.microsoft.com/en-us/library/system.type.underlyingsystemtype.aspx)属性进行比较，但我不确定在什么情况下两个不同的 Type 对象将具有相同的底层系统类型。

我真的很想看到一个重要的例子......我的*猜测*是，从“用户代码”中的任何地方它们都是一样的，但可能有一些狡猾的 BCL 代码在它重要的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T18:41:07.690

在 VB.NET 中 Is 是用于测试类型相等性的语言运算符。请注意，Type.Equals 测试两个相同类型的变量是否指向同一个对象。如下例所示。

```
Public Class Form1

    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
        Dim X As New TestObject
        Dim Y As New TestObject

        If X Is Y Then MsgBox("The Same 1")
        If Type.Equals(X, Y) Then MsgBox("The Same 2")

        X = Y
        If X Is Y Then MsgBox("The Same 3")

        If Type.Equals(X, Y) Then MsgBox("The Same 4")
    End Sub
End Class

Public Class TestObject
    Public Value As Double
End Class 
```

这样做是因为 BASIC 语言中“等于”运算符的历史。当在 VB4 中引入对象时，选择 IS 来测试相等性，因为感觉重载 equals 会产生问题。

我建议在 google 和 usenet 中搜索 Paul Vicks 关于为什么移植了一些单独的 BASIC 习语以及为什么没有移植其他习语的评论。我相信在这种情况下是为了避免混淆，因为 VB.NET 引入

ObjectA = ObjectC '这会导致 ObjectA 引用与 ObjectC 引用的对象相同的对象。

而在 VB6 中它是 Set ObjectA = ObjectC

与在 VB4 中引入对象时 IS 和 Set 用于处理对象而不是重载 equals 的原因相同。

最终，这些怪癖成为了基本编码方式的一部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T11:51:21.197

查看 Reflector 中的源代码，我看不出 Type.Equals(t1,t2) 的处理方式与 t1 = t2 有何不同。（实际上没有 Type.Equals；它实际上会调用 Object.Equals）。

在 C# 中，T1 == T2 工作得很好。

# php - 文本的自动字体大小（GD 通过 PHP）

> ID：289850
> 
> 赞同：4
> 
> 时间：2008-11-14T11:36:47.763
> 
> 标签：php, gd

$im (GD Image Resource) 上的文本有一个 x*y 的空间，我如何选择一个不会溢出该区域的字体大小（或编写这样的文本）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-14T11:59:31.150

我认为您正在寻找[imagettfbbox](http://fr.php.net/manual/en/function.imagettfbbox.php "图像ttfbbox")功能。

几年前，我将它用于为 Web 界面生成本地化按钮的脚本。如果文本不适合模板，我实际上调整了按钮的大小，以保持文本大小一致，但您可以尝试减小文本大小直到文本适合。

如果您有兴趣，我可以粘贴一些我的代码片段（或立即提供）。

[编辑] 好的，这是我的代码的一些摘录，有一天我会清理它（使其独立于目标应用程序，提供示例）并将其作为一个整体公开。
我希望这些片段有意义。

```
// Bounding boxes: ImageTTFBBox, ImageTTFText:
// Bottom-Left: $bb[0], $bb[1]
// Bottom-Right: $bb[2], $bb[3]
// Top-Right: $bb[4]; $bb[5]
// Top-Left: $bb[6], $bb[7]
define('GDBB_TOP', 5);
define('GDBB_LEFT', 0);
define('GDBB_BOTTOM', 1);
define('GDBB_RIGHT', 2);

#[ In class constructor ]#
// Get size in pixels, must convert to points for GD2.
// Because GD2 assumes 96 pixels per inch and we use more "standard" 72.
$this->textSize *= 72/96;
$this->ComputeTextDimensions($this->textSize, FONT, $this->text);

#[ Remainder of the class (extract) ]
/**
 * Compute the dimensions of the text.
 */
function ComputeTextDimensions($textSize, $fontFile, $text)
{
    $this->textAreaWidth = $this->imageHSize - $this->marginL - $this->marginR;
    $this->textAreaHeight = $this->imageVSize - $this->marginT - $this->marginB;

    // Handle text on several lines
    $this->lines = explode(NEWLINE_CHAR, $text);
    $this->lineNb = count($this->lines);
    if ($this->lineNb == 1)
    {
        $bb = ImageTTFBBox($textSize, 0, $fontFile, $text);
        $this->textWidth[0] = $bb[GDBB_RIGHT] - $bb[GDBB_LEFT];
        $this->maxTextWidth = $this->textWidth[0];
        $this->textHeight[0] = $bb[GDBB_BOTTOM] - $bb[GDBB_TOP];
    }
    else
    {
        for ($i = 0; $i < $this->lineNb; $i++)
        {
            $bb = ImageTTFBBox($textSize, 0, $fontFile, $this->lines[$i]);
            $this->textWidth[$i] = $bb[GDBB_RIGHT] - $bb[GDBB_LEFT];
            $this->maxTextWidth = max($this->maxTextWidth, $this->textWidth[$i]);
            $this->textHeight[$i] = $bb[GDBB_BOTTOM] - $bb[GDBB_TOP];
        }
    }
    // Is the given text area width too small for asked text?
    if ($this->maxTextWidth > $this->textAreaWidth)
    {
        // Yes! Increase button size
        $this->textAreaWidth = $this->maxTextWidth;
        $this->imageHSize = $this->textAreaWidth + $this->marginL + $this->marginR;
    }
    // Now compute the text positions given the new (?) text area width
    if ($this->lineNb == 1)
    {
        $this->ComputeTextPosition(0, $textSize, $fontFile, $text, false);
    }
    else
    {
        for ($i = 0; $i < $this->lineNb; $i++)
        {
            $this->ComputeTextPosition($i, $textSize, $fontFile, $this->lines[$i], false);
        }
    }
}

/**
 * Compute xText and yText (text position) for the given text.
 */
function ComputeTextPosition($index, $textSize, $fontFile, $text, $centerAscDesc)
{
    switch ($this->textAlign)
    {
    case 'L':
        $this->xText[$index] = $this->marginL;
        break;
    case 'R':
        $this->xText[$index] = $this->marginL + 
                $this->textAreaWidth - $this->textWidth[$index];
        break;
    case 'C':
    default:
        $this->xText[$index] = $this->marginL + 
                ($this->textAreaWidth - $this->textWidth[$index]) / 2;
        break;
    }

    if ($centerAscDesc)
    {
        // Must compute the difference between baseline and bottom of BB.
        // I have to use a temporary image, as ImageTTFBBox doesn't use coordinates
        // providing offset from the baseline.
        $tmpBaseline = 5;
        // Image size isn't important here, GD2 still computes correct BB
        $tmpImage = ImageCreate(5, 5);
        $bbt = ImageTTFText($tmpImage, $this->textSize, 0, 0, $tmpBaseline,
                $this->color, $fontFile, $text);
        // Bottom to Baseline
        $baselinePos = $bbt[GDBB_BOTTOM] - $tmpBaseline;
        ImageDestroy($tmpImage);
        $this->yText[$index] = $this->marginT + $this->textAreaHeight -
                ($this->textAreaHeight - $this->textHeight) / 2 - $baselinePos + 0.5;
    }
    else
    {
        // Actually, we want to center the x-height, ie. to keep the baseline at same pos.
        // whatever the text is really, ie. independantly of ascenders and descenders.
        // This provide better looking buttons, as they are more consistent.
        $bbt = ImageTTFBBox($textSize, 0, $fontFile, "moxun");
        $tmpHeight = $bbt[GDBB_BOTTOM] - $bbt[GDBB_TOP];
        $this->yText[$index] = $this->marginT + $this->textAreaHeight -
                ($this->textAreaHeight - $tmpHeight) / 2 + 0.5;
    }
}

/**
 * Add the text to the button.
 */
function DrawText()
{
    for ($i = 0; $i < $this->lineNb; $i++)
    {
        // Increase slightly line height
        $yText = $this->yText[$i] + $this->textHeight[$i] * 1.1 * 
                ($i - ($this->lineNb - 1) / 2);
        ImageTTFText($this->image, $this->textSize, 0,
                $this->xText[$i], $yText, $this->color, FONT, $this->lines[$i]);
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-03-03T23:08:05.230

我采用了上面 PhiLho 的课程并将其扩展为动态缩放单个文本行以适应边界框。我还用一个电话包装了它，这样你就可以看到它是如何运作的。这几乎是复制意大利面，只需更改您的变量，它应该可以开箱即用。

```
 <? 

header("Content-type: image/png"); 

define('GDBB_TOP', 5);
define('GDBB_LEFT', 0);
define('GDBB_BOTTOM', 1);
define('GDBB_RIGHT', 2);

class DrawFont {

    function DrawFont($details) {
    // Get size in pixels, must convert to points for GD2.
    // Because GD2 assumes 96 pixels per inch and we use more "standard" 72.
    $this->textSizeMax = $details['size'];
    $this->font = $details['font'];
    $this->text = $details['text'];
    $this->image = $details['image']; 
    $this->color = $details['color'];
    $this->shadowColor = $details['shadowColor'];
    $this->textAlign = "C";

    $this->imageHSize = $details['imageHSize'];
    $this->imageVSize = $details['imageVSize'];

    $this->marginL = $details['marginL'];
    $this->marginR = $details['marginR'];

    $this->marginT = $details['marginT'];
    $this->marginB = $details['marginB'];

    $this->ComputeTextDimensions($this->font, $this->text);

    }

    /**
     * Compute the dimensions of the text.
     */
    function ComputeTextDimensions($fontFile, $text)
    {
        $this->textAreaWidth = $this->imageHSize - $this->marginL - $this->marginR;
        $this->textAreaHeight = $this->imageVSize - $this->marginT - $this->marginB;

        // Handle text on several lines
        $this->lines = explode(' ', $text);
        $this->lineNb = count($this->lines);

        if ($this->lineNb == 1)
        {

            $this->textSize[0] = $this->textSizeMax;

            $bb = ImageTTFBBox($this->textSize[0], 0, $fontFile, $text);
            $this->textWidth[0] = $bb[GDBB_RIGHT] - $bb[GDBB_LEFT];
            $this->maxTextWidth = $this->textWidth[0];
            $this->textHeight[0] = $bb[GDBB_BOTTOM] - $bb[GDBB_TOP];

            $this->textSize[0] = $this->textSizeMax;
              while ($this->textWidth[0] > $this->textAreaWidth && $this->textSize[0] > 1) {

                $this->textSize[0]--;

                $bb = ImageTTFBBox($this->textWidth[$i], 0, $fontFile, $text);
                $this->textWidth[0] = $bb[GDBB_RIGHT] - $bb[GDBB_LEFT];
                $this->maxTextWidth = $this->textWidth[0];
                $this->textHeight[0] = $bb[GDBB_BOTTOM] - $bb[GDBB_TOP];    

              }

        }
        else
        {
            for ($i = 0; $i < $this->lineNb; $i++)
            {
                $this->textSize[$i] = $this->textSizeMax;

                $bb = ImageTTFBBox($this->textSize[$i], 0, $fontFile, $this->lines[$i]);
                $this->textWidth[$i] = $bb[GDBB_RIGHT] - $bb[GDBB_LEFT];
                $this->maxTextWidth = max($this->maxTextWidth, $this->textWidth[$i]);
                $this->textHeight[$i] = $bb[GDBB_BOTTOM] - $bb[GDBB_TOP];

                while ($this->textWidth[$i] > $this->textAreaWidth && $this->textSize[$i] > 1) {

                  $this->textSize[$i]--;

                  $bb = ImageTTFBBox($this->textSize[$i], 0, $fontFile, $this->lines[$i]);
                  $this->textWidth[$i] = $bb[GDBB_RIGHT] - $bb[GDBB_LEFT];
                  $this->maxTextWidth = max($this->maxTextWidth, $this->textWidth[$i]);
                  $this->textHeight[$i] = $bb[GDBB_BOTTOM] - $bb[GDBB_TOP];      

                }

            }
        }

        /*
        // Is the given text area width too small for asked text?
        if ($this->maxTextWidth > $this->textAreaWidth)
        {
            // Yes! Increase button size
            $this->textAreaWidth = $this->maxTextWidth;
            $this->imageHSize = $this->textAreaWidth + $this->marginL + $this->marginR;

        }
        */

        // Now compute the text positions given the new (?) text area width
        if ($this->lineNb == 1)
        {
            $this->ComputeTextPosition(0, $this->textSize[0], $fontFile, $text, false);
        }
        else
        {
            for ($i = 0; $i < $this->lineNb; $i++)
            {
                $this->ComputeTextPosition($i, $this->textSize[$i], $fontFile, $this->lines[$i], false);
            }
        }
    }

    /**
     * Compute xText and yText (text position) for the given text.
     */
    function ComputeTextPosition($index, $textSize, $fontFile, $text, $centerAscDesc)
    {
        switch ($this->textAlign)
        {
        case 'L':
            $this->xText[$index] = $this->marginL;
            break;
        case 'R':
            $this->xText[$index] = $this->marginL + 
                    $this->textAreaWidth - $this->textWidth[$index];
            break;
        case 'C':
        default:
            $this->xText[$index] = $this->marginL + 
                    ($this->textAreaWidth - $this->textWidth[$index]) / 2;
            break;
        }

        if ($centerAscDesc)
        {
            // Must compute the difference between baseline and bottom of BB.
            // I have to use a temporary image, as ImageTTFBBox doesn't use coordinates
            // providing offset from the baseline.
            $tmpBaseline = 5;
            // Image size isn't important here, GD2 still computes correct BB
            $tmpImage = ImageCreate(5, 5);
            $bbt = ImageTTFText($tmpImage, $this->textSizeMax, 0, 0, $tmpBaseline,
                    $this->color, $fontFile, $text);
            // Bottom to Baseline
            $baselinePos = $bbt[GDBB_BOTTOM] - $tmpBaseline;
            ImageDestroy($tmpImage);
            $this->yText[$index] = $this->marginT + $this->textAreaHeight -
                    ($this->textAreaHeight - $this->textHeight) / 2 - $baselinePos + 0.5;
        }
        else
        {
            // Actually, we want to center the x-height, ie. to keep the baseline at same pos.
            // whatever the text is really, ie. independantly of ascenders and descenders.
            // This provide better looking buttons, as they are more consistent.
            $bbt = ImageTTFBBox($textSize, 0, $fontFile, "moxun");
            $tmpHeight = $bbt[GDBB_BOTTOM] - $bbt[GDBB_TOP];
            $this->yText[$index] = $this->marginT + $this->textAreaHeight -
                    ($this->textAreaHeight - $tmpHeight) / 2 + 0.5;
        }
    }

    /**
     * Add the text to the button.
     */
    function DrawText()
    {

        $this->maxTextHeight = 0;

        // find maxTextHeight
        for ($i = 0; $i < $this->lineNb; $i++)
        {
          if ($this->textHeight[$i] > $this->maxTextHeight) {
            $this->maxTextHeight = $this->textHeight[$i];
          }
        }

        for ($i = 0; $i < $this->lineNb; $i++)
        {
            // Increase slightly line height
            $yText = $this->yText[$i] + $this->maxTextHeight * 1.1 * 
                    ($i - ($this->lineNb - 1) / 2);

            ImageTTFText($this->image, $this->textSize[$i], 0,
                    $this->xText[$i]+2, $yText+2, $this->shadowColor, $this->font, $this->lines[$i]);

            ImageTTFText($this->image, $this->textSize[$i], 0,
                    $this->xText[$i], $yText, $this->color, $this->font, $this->lines[$i]);

        }
    }

}

// Script starts here

$im = imagecreatefromjpeg("/home/cvgcfjpq/public_html/fb/img/page_template.jpg"); 

$color = imagecolorallocate($im, 235, 235, 235);
$shadowColor = imagecolorallocate($im, 90, 90, 90);

$details = array("image" => $im, 
                 "font" => "OldSansBlack.ttf", 
                 "text" => $_GET['name'],
                 "color" => $color,
                 "shadowColor" => $shadowColor,
                 "size" => 40,
                 "imageHSize" => 200,
                 "imageVSize" =>  250,
                 "marginL" => 5,
                 "marginR" => 5,
                 "marginT" => 5,
                 "marginB" => 5);

$dofontobj =& new DrawFont($details);
$dofontobj->DrawText();

imagepng($im); 
imagedestroy($im); 
unset($px); 

?> 
```

# html - 以特定顺序加载 HTML 框架而没有后退按钮问题？

> ID：289865
> 
> 赞同：1
> 
> 时间：2008-11-14T11:46:59.663
> 
> 标签：html, load, frames, back-button

我有一个使用框架集的网页。

由于脚本和对象依赖性，我需要按特定顺序加载帧。

我已将此示例用作模板： [JavaScript Source: Navigation: Frames Load Order](http://javascript.internet.com/navigation/frames-load-order.html)

这会加载一个空页面来代替我最后需要加载的页面，然后在第一页加载后将其替换为正确的页面。

但是：我还需要使用浏览器的后退按钮。如果您在上面的链接中运行示例，让两个框架都加载，然后单击返回按钮，顶部框架恢复到临时空白页面。然后需要再次单击返回按钮以导航到框架集之前的页面。

有没有办法强制框架以特定顺序加载而没有此后退按钮行为 - 或强制后退按钮跳过空白页面？

这需要适用于 Internet Explorer 6 和 7，最好也适用于 Firefox 3。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-04-22T07:26:42.837

你在这篇文章中提到了很多......

> 这是一个遗留系统。框架集是必需的。

如果您正在使用旧系统，那么我认为您是时候接受框架集在浏览器的后退按钮方面的行为方式了。如果它确实是一个遗留系统，则无需修复此行为。如果它实际上不是遗留系统并且您需要解决此问题，则需要避免使用框架集。框架集已从 HTML 标准中弃用，不应使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-16T16:43:09.860

为什么不按所需顺序使用三个 iframe，然后将它们调整大小/移动到适当的位置？

```
<iframe id="a1" src="page-to-load-first.htm"></iframe>
<iframe id="a2" src="page-to-load-second.htm"></iframe>
<iframe id="a3" src="page-to-load-third.htm"></iframe>
<script>
function pos(elem,x,y,w,h) {
   if (!elem.style) elem=document.getElementById(elem);
   elem.style.position='absolute';
   elem.style.top = y+'px';
   elem.style.left= x+'px';
   elem.style.width=w+'px';
   elem.style.height=h+'px';
}
window.onload = function() {
    window.onresize=function() {
        var w = window.innerWidth || document.documentElement.clientWidth;
        var h = window.innerHeight || document.documentElement.clientHeight;
        var w3 = w/3;
        var h2 = h/2;
        pos('a1',0,0,w3,h); /* left 1/3rd */
        pos('a2',w3,0,w3+w3,h2);
        pos('a3',w3,h2,w3+w3,h2);
    };
    window.onresize();
};
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T21:05:15.307

Build the frames themselves using JavaScript:

```
<html>
<head>
<script>
function makeFrame(frameName) {
    var newFrame = document.createElement('frame');
    newFrame.id=frameName;
    if(frameName=="B") {
        newFrame.onload=function() {makeFrame("C")};
        newFrame.src = 'http://www.google.com';
    }
    else {
        newFrame.src = 'http://www.yahoo.com';
    }
    document.getElementById('A').appendChild(newFrame);

}
</script>
</head>
<frameset name='A' id='A' rows="80, *" onload="makeFrame('B')"></frameset>
</html> 
```

# c# - 尝试通过反射加载应用程序并收到错误“无法加载文件或程序集...系统找不到指定的文件。”

> ID：289875
> 
> 赞同：0
> 
> 时间：2008-11-14T11:53:04.097
> 
> 标签：c#, reflection

它试图查找的程序集不是根程序集 - 它是一个引用的程序集，但它位于同一文件夹中，并且 Directory.GetCurrentDirectory() 是包含所有文件的文件夹。

我被困住了 - 有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T11:54:32.753

您可以：

1.  创建一个新`AppDomain`的以加载程序集（并将`AppDomain`的基目录设置为包含所有程序集的目录）。
2.  附加一个处理程序`AppDomain.AssemblyResolve`以帮助 CLR 找到程序集的依赖项。
3.  您也许可以将有问题的目录添加到要探测的路径列表中。但是，它需要驻留在应用程序目录下的某个位置。有关详细信息，请参阅[探头](http://msdn.microsoft.com/en-us/library/823z9h8w.aspx)元件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T14:07:09.443

你可以尝试使用这样的东西

```
string myDll = string.Empty;
string location = Assembly.GetExecutingAssembly().Location;
if (location != null)
{
    myDll = string.Format(@"{0}\my.assembly.name.dll", location.Substring(0, location.LastIndexOf(@"\")));
} 
```

这应该获得运行程序集的物理目录。这可能在 Windows .NET 临时目录中。但是，由于文件处于同一级别，因此它们应该并排存在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T14:38:52.890

如果您使用[assembly.loadfrom](http://msdn.microsoft.com/en-us/library/1009fa28.aspx)，您可以指定程序集的文件路径。

> load-from 上下文允许从未包含在探测中的路径加载程序集，但还允许找到和加载对该路径的依赖项，因为路径信息由上下文维护。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-03-01T20:00:38.093

从具有引用dll的文件夹中执行程序也可以解决问题。

# user-interface - 具有简单的基于 GUI 的编辑器的非开发人员的宏/脚本语言

> ID：289879
> 
> 赞同：6
> 
> 时间：2008-11-14T11:55:19.380
> 
> 标签：user-interface, scripting, macros, embedded-language

我们希望让人们能够在他们的帐户中添加一些逻辑（例如，给定一些参数，如何计算特定结果）。因此，从本质上讲，这相当于编写支持条件和表达式的简单业务规则。然而，挑战在于为他们提供一个简单的在线编辑器，他们可以在其中通过完全可视化的方式（最好是拖放 Expr-tree 节点——有点像 Y！管道）来创建逻辑。

有人知道可以让人们这样做的脚本/宏/域特定语言吗？挑战在于可视化编辑器，因为我们不希望投资开发 UI 来进行编辑。基本要求是：
1\. 嵌入到另一种语言中，或安全运行（否`reboot -n`或`<JUNK-DANGEROUS-COMMAND> >> ~/.bashrc`）
2\. 无需编码背景的用户即可轻松访问（不需要任何高级功能）
3\. 最好有一个简单的基于 GUI 的编辑器来创建逻辑非开发人员可以访问的程序（有点像电子表格）
4\. 生成编译时警告（无效代码）的能力会很好（类型安全？）
5\. 能够在执行前嵌入一些解​​释器可用的数据（例如., `name`, `birthday`, `amount`)

有人试过做这样的事情并有任何想法吗？我查看了 Lua、Io、Python、Ruby 和许多其他工具，但挑战本质上是我不认为非程序员能够理解这么多代码。如果可以轻松开发编辑器，可以通过“元编程”添加一些东西来表示 Ruby 也很好！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T20:12:15.150

事实上，微软正在开发[Oslo](http://www.microsoft.com/soa/products/oslo.aspx)，这正合您的胃口。 [Chris Sells](http://www.sellsbrothers.com/)最近写了很多关于它的文章。

它被设计成一种创作 DSL 的方式，也可以使用名为 Quadrant 的图形工具直观地创作这些模型。听起来与您正在寻找的非常相似。

开源方面，我认为 Ruby 可以接近，你可以看看 _whytheluckystiff 的 Try Ruby 或[Hackety](http://hacketyhack.net/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-15T13:09:35.783

[另一方面，按照我的Clive](http://codeaholic.blogspot.com/2006/02/vbscript-clive-command-language.html)工具编写一些简单的东西，如超文本应用程序 (HTA)——当然假设是 Windows 。博客上的文章没有提到 HTA 版本，但基本上我可以将 VBScript-ish 代码输入到一个文本区域并当场解释它，输出到表单上的另一个文本区域。

使用 HTA 为您提供 HTML 的所有表单控制以及 DOM，您可以相当快地想出一些有趣的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T13:28:07.320

我认为您不会找到任何不太通用的东西，尤其是关于 GUI 编辑器。据我所知，没有通用工具能够自动与您的程序交互并能够从中查询数据并将脚本解释为您软件中的命令——如果有的话，我想要一份副本。不是轻率，但你*必须*做一些（可能很多）工作才能让它发挥作用。它可能会导致您编写自定义 DSL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T22:34:03.053

我会看看PowerShell。您可以以非常易读的方式显示用户想要编写脚本的所有活动。[在 PowerShell 团队博客](http://blogs.msdn.com/powershell/archive/2008/10/09/domain-specific-languages-dsls-in-general-and-how-powershell-relates.aspx)上有一些关于使用 PowerShell 创建 DSL的讨论，技术负责人 Bruce Payette 在他的 Manning 的 Windows PowerShell in Action 一书中谈到了这一点。

# c - 为什么这个联合的大小是 2 位域？

> ID：289900
> 
> 赞同：3
> 
> 时间：2008-11-14T12:08:19.620
> 
> 标签：c, structure, bit-manipulation, unions

我正在 Windows 上处理 turbo C，其中 char 占用一个字节。现在我的问题出在下面的联合上。

```
union a
{
 unsigned char c:2;
}b;
void main()
{
printf("%d",sizeof(b));  \\or even sizeof(union a)
} 
```

该程序将输出打印为 2，而 union 应该只占用 1 个字节。为什么会这样？

对于 struct 给出 1 个字节很好，但这个联合工作不正常。

**还有一**件事是如何访问这些位字段。

```
scanf("%d",&b.c);  //even scanf("%x",b.c); 
```

不起作用，因为我们无法获得位地址。所以我们必须使用另一个变量，如下所示

```
int x;
scanf("%d",&x);
b.c=x; 
```

我们不能避免吗？有没有别的办法？？？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-14T12:24:10.553

允许编译器向结构和联合添加填充，虽然我承认，当你能够获得一个完全允许的单字节结构时，你的联合将联合四舍五入到两字节大小有点令人惊讶。

回答你的第二个问题：不，这是无法避免的。位字段是一种结构打包优化，要付出的性能和便利性损失是位字段成员不可单独寻址。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-14T12:55:36.607

[Turbo C 基于 8086 微处理器，具有两个字节的字边界](http://web.archive.org/web/20080627072007/http://cunion.blogspot.com/2008/01/why-we-cannot-use-relation-and-logical.html)。原子读写通常与 CPU 的体系结构绑定，因此编译器会添加一些松弛字节来对齐您的数据结构。

![替代文字](https://bp1.blogger.com/_uIwyaTjqYYw/R3vInzM5lDI/AAAAAAAAANM/FQ0HmvlkxPg/s400/slack+byte.bmp)

调用`#pragma pack(1)`可能可以禁用它，但不确定它是否适用于 Turbo C。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T12:22:07.423

我不确定您在哪里找到联合必须恰好是最小尺寸的要求。一个对象必须至少与其成员一样大，但这只是一个下限。

您不能获取位域的地址；它的类型是什么？它不能是 int*。scanf(%d) 会将 sizeof(int) * CHAR_BIT 位写入您传入的 int* 中。这是写入超过 2 位，但您没有那个空间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-14T12:26:55.900

标准中有一段规定在结构的第一个成员之前不应有填充。但它并没有明确说明工会。可能会出现大小差异，因为它希望在 2 个字节边界处对齐联合，但由于它不能在结构的第一个成员之前填充，因此该结构将有一个字节对齐。另请注意，一个工会可能有更多不同类型的成员，这可能会扩大工会所需的对齐范围。编译器可能有理由给它们至少 2 个字节对齐，例如为了简化必须根据联合所需对齐处理的代码。

无论如何，没有要求你的联合应该是一个字节。它只需要为其所有成员提供一席之地。

以下是 C 标准对您的第二个问题的看法：

`The operand of the unary & operator shall be either a function designator or an lvalue that designates an object that is not a bit-field and is not declared with the register storage-class specifier.`

所以你最好的选择是使用 int 的方式。您可以在代码周围加上大括号，因此临时变量保持在本地：

```
void func(void) { struct bits f; { int x; scanf("%d", &x); f.bitfield = x; } /* ... */ } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-02-01T11:55:43.960

答案中有很多错误信息，所以我会澄清一下。这可能是两个原因之一（我不熟悉编译器）。

1.  位域存储单元为 2。

2.  强制对齐到字（2 字节）边界。

我怀疑这是第一种情况，因为将位域存储单元作为声明的“基本”类型的大小是一种常见的扩展。在这种情况下，类型是 char，其大小始终为 1。

[在标准中，您只能声明 int 或 unsigned int 类型的位域，并且位域分组的“存储单元”是固定的（通常与 int 大小相同）。即使是单个位域也将使用一个存储单元。]

在第二种情况下，C 编译器通常实现`#pragma pack`允许控制对齐。我怀疑默认打包为 2，在这种情况下，将在联合末尾添加一个填充字节。避免这种情况的方法是使用：

```
#pragma pack(1) 
```

您还应该使用`#pragma pack()`after 设置回默认值（如果您的编译器支持，甚至更好地使用 push 和 pop 参数）。

对于所有说您必须忍受编译器所做的事情的回复者，这与 C 的精神背道而驰。在您无法控制的情况下，您应该能够使用位域映射到任何大小或位顺序例如文件格式或硬件映射。

当然，这是高度不可移植的，因为不同的实现具有不同的字节顺序、位添加到位域存储单元（从顶部或底部）的顺序、存储单元大小、默认对齐方式等。

至于您的第二个问题，我看不到问题所在，尽管我从不使用`scanf`它，因为它有问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-14T17:49:40.197

除了“在结构或联合的末尾可能还有未命名的填充”这一事实之外，编译器还被允许将位域放置在“任何大到足以容纳位域的可寻址存储单元”中。（两个引用都来自 C90 标准 - C99 标准有类似但不同的措辞）。

另请注意，该标准规定“位字段应具有一种类型，即 int、unsigned int 或 signed int 的合格或非合格版本”，因此在 char 类型中具有位字段是非标准的。

因为位域的行为如此依赖于未指定的编译器实现细节（还有其他几个我没有提到的位域的不可移植问题）使用它们几乎总是一个坏主意。特别是，当您尝试以文件格式、网络协议或硬件寄存器对位域进行建模时，它们不是一个好主意。

* * *

[来自另一个 SO 答案](https://stackoverflow.com/questions/149995/why-does-a-bit-field-of-type-unsigned-short-pack-into-a-struct-differently-to-a#150001)的更多信息：

> 通常，您应该避免使用位域并使用其他具有显式位掩码和移位的清单常量（枚举或其他）来访问字段中的“子字段”。
> 
> 这是应该避免位域的一个原因 - 即使对于同一平台，它们在编译器之间也不是很便携。来自 C99 标准（C90 标准中有类似的措辞）：
> 
> > 实现可以分配任何大到足以容纳位域的可寻址存储单元。如果有足够的空间剩余，紧跟在结构中另一个位域之后的位域将被打包到同一单元的相邻位中。如果剩余空间不足，则将不适合的位域放入下一个单元还是与相邻单元重叠是实现定义的。单元内位域的分配顺序（高位到低位或低位到高位）是实现定义的。未指定可寻址存储单元的对齐方式。
> 
> 您无法保证位域是否会“跨越”一个 int 边界，并且您无法指定位域是从 int 的低端还是 int 的高端开始（这与处理器是否大端或小端）。

# c++ - 为 MSVC 预构建的 Boost 1.37

> ID：289909
> 
> 赞同：6
> 
> 时间：2008-11-14T12:12:40.423
> 
> 标签：c++, boost, bjam

我找不到用于 Boost 1.37.0 的一组预构建的 MSVC++ 库，只有源代码。我不明白他们奇怪的构建系统是如何工作的……有没有什么地方可以找到 Visual Studio 项目的下载或其他东西？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-14T12:57:00.207

BoostPro [Computing](http://www.boostpro.com/)人员为 Windows 维护 Boost 安装程序，但他们通常需要几周时间才能将新版本上线。它还没有到 1.37。

没有 Visual Studio 解决方案（请记住，Boost 针对*许多*平台），尽管努力也支持[使用 CMake 构建 Boost](https://svn.boost.org/trac/boost/wiki/CMake)。我不确定他们在 1.37 上走了多远，但我相信这个过程还处于早期阶段。

然而，标准构建系统并没有*那么*奇怪！首先为您的平台[下载 bjam](http://sourceforge.net/project/showfiles.php?group_id=7586&package_id=72941)（查找 Windows 的“ntx86”后缀）并将其安装在路径中的某个位置（C:/Windows/System32）。然后下载[源代码](http://sourceforge.net/project/showfiles.php?group_id=7586&package_id=8041)，解压缩并从命令行运行构建系统。对于 Visual Studio 用户，它看起来像这样：

```
bjam --build-dir="C:\boostsource" --toolset=msvc --build-type=complete stage 
```

这在很大程度上是从[入门指南](http://www.boost.org/doc/libs/1_37_0/more/getting_started/windows.html)中提取的，该指南更详细。如果当前目录是源的根目录，则不需要 build-dir。

在等待几个小时以构建所有内容之后（“完成”意味着它将构建调试、发布、单/多线程、静态/动态、静态/动态链接到运行时 - 以及*组合*）你最终会得到'stage/lib' 目录中的所有库。

最后，您需要告诉 Visual Studio 在哪里可以找到头文件和库。转到工具-> 选项-> 项目和解决方案-> VC++ 目录。为“包含文件”添加一个条目（如“C:\boostsource”）。为“库文件”添加一个条目（“C:\boostsource\stage\lib”）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T19:52:32.877

我的网站上有一个 1.37 (VC 7.1, 8, 9) 的版本，请帮助自己。

[http://boost.teeks99.com/](http://boost.teeks99.com/)

（更新... 1.38 也在那里）
（另一个更新，1.39 现在在那里）
（1.40 起来了） （1.41 起来了，有点晚了）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-14T12:51:44.010

看起来很复杂，但是构建 Boost 确实没那么糟糕。首先您需要下载 bjam 工具（[SourceForge](http://sourceforge.net/project/showfiles.php?group_id=7586&package_id=72941)是一个很好的来源）。确保 bjam.exe 位于 PATH 中的目录中。

转到解压后 Boost 下载的根目录（例如 C:\Boost_1_37_0）

键入`bjam --help`以获取所有构建选项的列表。

我使用以下命令构建所有内容，您可以自定义它以满足您的需求：

```
bjam --prefix=C:\boost --build-dir=C:\build --build-type=complete install 
```

结果将放在 C:\boost 中，您可以删除 C:\build。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-14T12:51:26.053

建造它并不困难。他们在这里对默认过程进行了相当好的扩展：http: [//www.boost.org/doc/libs/1_37_0/more/getting_started/windows.html#or-build-binaries-from-source](http://www.boost.org/doc/libs/1_37_0/more/getting_started/windows.html#or-build-binaries-from-source)

下载 bjam（来自 sourceforge，有来自 boost 网站的链接）以及 boost 源，确保可以从 boost 目录访问 bjam，cd 到 boost 目录，然后运行类似以下的内容：

bjam --build-dir= --prefix-dir= --toolset=msvc --build-type=完成安装

where 是一个临时目录，它可以存储中间文件，并且是最终安装位置。您可以使用各种其他选项，但并非所有选项都记录得很好，但基础知识相当简单。

如需更多帮助，您可以从 boost 源目录运行 bjam --help。

# cruisecontrol.net - Starteam 和 Cruise Control.Net 的问题

> ID：289911
> 
> 赞同：1
> 
> 时间：2008-11-14T12:14:15.787
> 
> 标签：cruisecontrol.net, starteam

是否有人在使用巡航控制工具从starteam 获取文件以设置自动构建作业时遇到问题？

该脚本似乎运行良好，但一段时间后失败并显示错误消息错误发生：无法从网络读取数据：与 StarTeam 服务器的连接已丢失。

我不确定问题是否出在我们 Starteam 服务器的设置方式上，我们在团队中共享了 4 个许可证，如果服务器检测到一段时间内不活动，服务器会自动将人员注销

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-30T12:38:44.827

我已经让 StarTeam 与 Cruise control.net 一起工作，所以我可以告诉你它可以工作，但它很痛苦，尤其是 starteam 不会自行从工作目录中删除已删除文件的事实。我以前见过一次该错误，但如果我没记错的话，它与 IPSec 配置问题有关，并且是即时的，而不是延迟之后。失败所需的时间是否更短/更长/与不活动的超时相同？在失败之前是否有任何/所有/没有源文件进入工作目录？

# mysql - 从 MySQL 执行 shell 命令

> ID：289914
> 
> 赞同：4
> 
> 时间：2008-11-14T12:17:08.150
> 
> 标签：mysql, database, stored-procedures

我知道我正在寻找的可能是一个安全漏洞，但由于我设法在 Oracle 和 SQL Server 中做到了，我会试一试：

我正在寻找一种从 MySQL 上的 SQL 脚本执行 shell 命令的方法。如有必要，可以创建和使用新的存储过程。

注意：我不是在寻找 mysql 命令行工具提供的 SYSTEM 命令。相反，我正在寻找这样的东西：

> BEGIN IF COND1 ... EXEC_OS cmd1; ELSE EXEC_OS cmd2；结尾;

其中 EXEC_OS 是调用我的代码的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-01-27T21:33:24.073

这与其说是对问题的回答，不如说是对这种功能的证明——因此否定了那些会说“你应该做其他事情”或“你为什么想要”的人。

我有一个数据库，我试图对其保持严格的规则——我不想在任何地方出现孤儿。参照完整性检查在表级别帮助我解决这个问题，但我必须将一些数据作为文件保存在文件系统中（这是我老板直接命令不要在数据库本身中存储任何二进制数据的结果）。

这里明显的解决方案是有一个触发器，它在删除记录时触发，然后自动删除关联的外部文件。

现在，我确实意识到 UDF 可能会提供一个解决方案，但这似乎需要大量的 C/C++ 工作来简单地删除一个文件。当然，数据库权限本身至少会为潜在的攻击者提供**一些**安全性。

现在，我确实意识到我可以编写一个 shell 脚本或类似的脚本来删除表记录，然后去删除相关文件，但同样，这是在数据库*本身*的域之外。正如一位老导师曾经告诉我的那样“业务的规则应该体现在数据库的规则中”。可以清楚地看到，我无法使用 MySQL 强制执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T12:40:31.787

[请参阅http://www.databasesecurity.com/mysql/HackproofingMySQL.pdf](http://www.databasesecurity.com/mysql/HackproofingMySQL.pdf)中的 do_system()

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T02:29:34.027

您可能需要考虑使用功能更强大的脚本语言编写脚本，例如 Perl、Python、PHP 或 Ruby。所有这些语言都有库来运行 SQL 查询。

存储过程语言中没有用于运行 shell 命令的内置方法。这被认为是一个坏主意，不仅因为它是一个安全漏洞，而且因为 shell 命令的任何效果都不遵守事务隔离或回滚，就像您在存储过程中执行的任何 SQL 操作的效果一样：

```
START TRANSACTION;
CALL MyProcedure();
ROLLBACK; 
```

如果`MyProcedure`做了诸如创建或编辑文件，或发送电子邮件等操作，这些操作将不会回滚。

我建议在存储过程中执行 SQL 工作，并在调用存储过程的应用程序中执行其他工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T12:38:31.167

根据forums.mysql.com 上的[这篇文章](http://forums.mysql.com/read.php?10,198595,198899#msg-198899)，解决方案是使用[MySQL_Proxy](http://forge.mysql.com/wiki/MySQL_Proxy)。

# statistics - 交互式统计分析工具

> ID：289915
> 
> 赞同：5
> 
> 时间：2008-11-14T12:17:45.513
> 
> 标签：statistics

我正在寻找用于统计分析的基本软件。最重要的是简单直观的使用，“开箱即用”。至少基本操作应该是交互式的。免费将是一个奖励:)

目的是分析各种进程的数据转储和日志。

*   导入逗号/制表符分隔的文件
*   根据条件对行进行排序和过滤
*   基本聚合：计数、平均值、偏差、回归、趋势
*   可视化 - 绘制数据、bin 分布等。

Excel 在过滤和重新组合数据时失败（至少对我而言），我想像“Excel with SQL”这样的东西会很好。我以前一直在使用 MS Access + Excel 并复制数据，但这很痛苦。

你有什么建议吗？

**澄清**我不是在寻找用于 IIS/Web 服务器日志的特定工具，而是在寻找具有制表符分隔值的各种数据结束事件日志（主要来自自定义应用程序）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T12:44:44.880

专门针对日志文件分析，我推荐[Microsoft 的 Log Parser](http://www.microsoft.com/downloads/details.aspx?FamilyID=890cd06b-abf8-4c25-91b2-f8d975cf8c07&displaylang=en)（免费），它允许您针对所有类型的基于文本的文件（以及跨文件集）、XML、CSV、事件日志、注册表运行具有基本聚合的查询，文件系统、活动目录等。

在它之上还有一个免费的 GUI 构建，称为[Log Parser Lizard GUI](http://www.lizardl.com/PageHtml.aspx?lng=2&PageId=18&PageListItemId=17)，这使得它更加用户友好并且可以进行基本的绘图等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-05T23:57:48.633

我会考虑看[R](http://www.r-project.org/)，它是：

*   自由
*   被统计学家广泛使用
*   相当容易使用。
*   可以轻松完成您在帖子中提到的所有内容

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T12:45:47.267

我在之前的演出中使用过[Tableau Software](http://www.tableausoftware.com/)，它非常棒 - 非常直观且易于使用。

不幸的是它也很昂贵。

# php - 替代“PDO::lastInsertId”/“mysql_insert_id”

> ID：289916
> 
> 赞同：6
> 
> 时间：2008-11-14T12:19:16.353
> 
> 标签：php, mysql, auto-increment, lastinsertid, mysql-insert-id

我总是听说使用“lastInsertId”（如果您不使用 PDO，则使用 mysql_insert_id()）是邪恶的。如果是触发器，显然是这样，因为它可能会返回完全不是您的 INSERT 创建的最后一个 ID 的东西。

```
$DB->exec("INSERT INTO example (column1) VALUES ('test')");
// Usually returns your newly created ID.
// However when a TRIGGER inserts into another table with auto-increment:
// -> Returns newly created ID of trigger's INSERT
$id = $DB->lastInsertId(); 
```

有什么选择？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-14T13:08:49.717

恕我直言，它只被认为是“邪恶的”，因为几乎没有任何其他 SQL 数据库（如果有的话）拥有它。

我个人觉得它非常有用，并希望我不必在其他系统上求助于其他更复杂的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-14T13:42:58.493

一种替代方法是改用序列，因此您在插入之前自己生成 ID。

不幸的是，它们在 MySQL 中不受支持，但像 Adodb 这样的库可以使用另一个表来模拟它们。但是，我认为仿真本身将使用 lastInsertId() 或等效项...但至少您不太可能在纯粹用于序列的表上触发触发器

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-14T13:41:49.463

如果你走 ADOdb 的路线（[http://adodb.sourceforge.net/](http://adodb.sourceforge.net/)），那么你可以事先创建插入 ID *，*并在插入时明确指定 ID。这可以以可移植的方式实现（ADOdb 支持大量不同的数据库......）并保证您使用正确的插入 ID。

PostgreSQL SERIAL 数据类型类似，只是它是按表/按序列的，您在请求时指定您想要最后一个插入 ID 的表/序列。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-14T12:31:49.823

我想这也不是最先进的，但我使用写锁来确保我真的得到了最后插入的 ID。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T12:28:33.277

它并不复杂而且效率不高，但如果您插入的数据包含唯一字段，那么 SELECT 显然可以产生您所追求的。

例如：

```
INSERT INTO example (column1) VALUES ('test');
SELECT id FROM example WHERE column1 = 'test'; 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2012-07-17T12:50:20.290

你可以试试这个：

```
$sql = "SELECT id FROM files ORDER BY id DESC LIMIT 1";
$PS = $DB -> prepare($sql);
$PS -> execute();
$result = $PS -> fetch(); 
```

# c# - 在 C# 中填充 Word 2007 模板的最佳方法是什么？

> ID：289922
> 
> 赞同：6
> 
> 时间：2008-11-14T12:24:07.340
> 
> 标签：c#, ms-word, openxml, docx, word-2007

我需要从代码中填充 Word 2007 文档，包括重复的表格部分 - 目前我在 docx 的 document.xml 部分使用 XML 转换，但是设置起来非常耗时（每次编辑模板文档时） ，您必须重新创建 transform.xsl 文件，对于复杂的文档可能需要一天的时间）。

有没有更好的方法，最好是不需要您在此过程中*运行*Word 2007 的方法？

问候理查德

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T13:04:33.017

我尝试自己为此目的编写一些代码，但放弃了。现在我使用了第 3 方产品：[**Aspose Words**](http://www.aspose.com/categories/file-format-components/aspose.words-for-.net-and-java/default.aspx)，并且对该组件非常满意。

它不需要机器上的 Microsoft Word。

*“Aspose.Words 使 .NET 和 Java 应用程序能够在不使用 Microsoft Word® 的情况下读取、修改和编写 Word® 文档。”*

*“Aspose.Words 支持广泛的功能，包括文档创建、内容和格式处理、强大的邮件合并功能、对 DOC、OOXML、RTF、WordprocessingML、HTML、OpenDocument 和 PDF 格式的全面支持。Aspose.Words 确实是最实惠的，市场上最快且功能丰富的 Word 组件。”*

**免责声明**：我不隶属于该公司。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T17:34:09.057

由于 DOCX 文件只是一个包含带有图像和 XML 文件的文件夹结构的 ZIP 文件，因此您应该能够使用我们最喜欢的 XML 操作 API 来操作这些 XML 文件。格式规范称为**WordprocessingML**，它是[Office Open XML 标准](http://en.wikipedia.org/wiki/Office_Open_XML)的一部分。

我想我会提到它，以防 splattne 建议的第 3 方工具不是一个选项。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-29T16:33:21.690

您是否考虑过使用 Microsoft 的 Open XML SDK？唯一依赖于 .NET 3.5。

文档：[http://msdn.microsoft.com/en-us/library/bb448854%28office.14%29.aspx](http://msdn.microsoft.com/en-us/library/bb448854%28office.14%29.aspx)

下载：[http://www.microsoft.com/downloads/details.aspx?familyid=C6E744E5-36E9-45F5-8D8C-331DF206E0D0&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=C6E744E5-36E9-45F5-8D8C-331DF206E0D0&displaylang=en)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-23T01:16:10.150

使用调用 docx 库。它支持表格数据（[http://invoke.co.nz/products/help/docx_tables.aspx](http://invoke.co.nz/products/help/docx_tables.aspx)）。更多信息请访问[http://invoke.co.nz/products/docx.aspx](http://invoke.co.nz/products/docx.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T01:05:29.190

你考虑过用VB吗？您可以创建一个单独的程序集来填充您的文档。

我知道您正在寻找 C# 解决方案，但 XML 文字支持是 XML 文字支持可以帮助您填充文档的一个领域。在 Word 中创建一个文档到服务器作为模板，解压缩 docx，将您要更改的相关 XML 部分粘贴到您的 VB 代码中，然后添加代码以填写您要更改的部分。从您的描述中很难说这是否符合您的要求，但我建议您调查一下。

# java - 如何获取两个 java.util.Date 之间的年数？

> ID：289936
> 
> 赞同：4
> 
> 时间：2008-11-14T12:33:39.757
> 
> 标签：java, gwt

如何获得两个之间的年数`java.util.Date`？

**注意：**仅使用`java.util.Date`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-14T12:38:58.683

您需要准确到什么程度？如果近似值足够好，那么我会做

```
long msDiff = date1.getTime() - date2.getTime();
int yearDiff = (int)(msDiff / 1000 / 60 / 60 / 24 / 365.25); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-25T14:07:30.793

你真的需要使用*[java.util.Date](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Date.html)*吗？

如果您放宽此限制并允许使用**[Joda Time - Java 日期和时间 API](http://joda-time.sourceforge.net/index.html)**，您可以像这样完成您的任务：

```
import org.joda.time.DateTime;
import org.joda.time.Period;

import static java.lang.System.out;

public class App {
  public static void main(String[] args) {
    final DateTime now = new DateTime();
    out.println(new Period(now.minusYears(2), now).getYears());
    out.println(new Period(now.minusYears(2).plusHours(1), now).getYears());
  }
} 
```

输出结果为：

```
2
1 
```

如果您不能使用[Joda Time](http://joda-time.sourceforge.net/index.html) ，请使用*[java.util.Calendar](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Calendar.html)*。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T12:41:19.350

对每个 Date 对象使用 getTime 方法并进行减法。将结果转换为年。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T00:10:25.227

我假设，因为这个问题在 GWT 下被标记，所以您正在尝试在 GWT 应用程序中进行日期数学。GWT 的仿真库实现了已弃用的函数 Date.getYear()，在这种情况下，您只需执行 date2.getYear() - date1.getYear()。

使用不推荐使用的函数不是最好的，但似乎是 GWT 开发世界中的常见做法。

# asp.net - 关于 Asp.Net DataList 命令和 EventValidation

> ID：289941
> 
> 赞同：1
> 
> 时间：2008-11-14T12:37:06.583
> 
> 标签：asp.net, event-handling, datalist

我有一个更新面板内的 Datalist，它位于 modalpopupextender 的面板中；

我可以列出我想要的项目。我还为 Delete 和 AddBelow 放置了 2 个按钮。这是标记：

```
<asp:DataList ID="SpeedDialsDL" runat="server">
                <ItemTemplate>
                    <table id="speedDialValueEditorTable" width="100%">
                        <tr>
                            <td width="275px">
                                <asp:Label ID="ValueLabel" runat="server" Text="Value"></asp:Label>
                            </td>
                            <td>
                                <asp:TextBox ID="ValueTextBox" runat="server" Text='<%# Eval("Value") %>' Width="340px"
                                    Enabled="false"></asp:TextBox>
                            </td>
                        </tr>                       
                        <tr>
                            <td colspan="2">
                                <asp:Button ID="Delete" runat="server" Text="Delete" CommandName="Delete"
                                 CausesValidation="false" />&nbsp;
                                <asp:Button ID="AddNewButton" runat="server" Text="AddBelow" CommandName="AddBelow"
                                   CausesValidation="false" />
                            </td>
                        </tr>
                    </table>
                </ItemTemplate>
            </asp:DataList> 
```

并注册如下事件：（我同时使用了 ItemCommand 和 DeleteCommand 来查看哪个有效：）

```
protected void Page_Load(object sender, EventArgs e)
{
    SpeedDialsDL.ItemCommand += SpeedDialsDL_ItemCommand;
    SpeedDialsDL.DeleteCommand += SpeedDialsDL_ItemCommand;            
}        

void SpeedDialsDL_ItemCommand(object source, DataListCommandEventArgs e)
{
    switch (e.CommandName)
    {
        case "Delete":
            this.DeleteFromList((string)e.CommandArgument);
            break;
        case "AddBelow":
            break;
    }
} 
```

但是当我单击 Delete 或 AddBelow 按钮时，我收到以下错误：

```
Invalid postback or callback argument.  Event validation is enabled using <pages enableEventValidation="true"/> in configuration or <%@ Page EnableEventValidation="true" %> in a page.  For security purposes, this feature verifies that arguments to postback or callback events originate from the server control that originally rendered them.  If the data is valid and expected, use the ClientScriptManager.RegisterForEventValidation method in order to register the postback or callback data for validation. 
```

我已禁用页面的事件验证，但无法捕获该事件...

我在这里想念什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-15T09:44:06.743

控件在呈现期间注册其事件，然后在回发或回调处理期间验证事件。您在 Page_Load 期间手动注册事件。

尝试重构代码，以便在 .aspx 页面中指定事件处理程序，将项的 Id 绑定到按钮的 CommandArgument，然后在处理程序中获取绑定的项 Id。对于不同的事件，我也会有单独的事件处理程序，它更简洁一些。就像是：

```
<asp:DataList ID="SpeedDialsDL" runat="server">                
<ItemTemplate>                    
    <table id="speedDialValueEditorTable" width="100%">                        
        <tr>                            
            <td width="275px">                                
                <asp:Label ID="ValueLabel" runat="server" Text="Value"></asp:Label>                            
            </td>                            
            <td>                                
                <asp:TextBox ID="ValueTextBox" runat="server" Text='<%# Eval("Value") %>' Width="340px" Enabled="false"></asp:TextBox>                            
            </td>                       
        </tr>                                               
        <tr>                            
            <td colspan="2">                                
                <asp:Button ID="Delete" runat="server" Text="Delete" OnClick="Delete" CausesValidation="false" CommandArgument='<%# Eval("Id") %>' />
                <asp:Button ID="AddNewButton" runat="server" Text="AddBelow" OnClick="AddBelow" CausesValidation="false" CommandArgument='<%# Eval("Id") %>' />                            
            </td>                     
        </tr>                   
    </table>                
</ItemTemplate> 
```

```
protected void Delete(object sender, EventArgs e)
{
    Button b = (Button)sender as Button;
    string boundItemId = b.CommandArgument;
    //handle delete
}

protected void AddBelow(object sender, EventArgs e)
{
    Button b = (Button)sender as Button;
    string boundItemId = b.CommandArgument;
    //handle add below
} 
```

# windows-mobile - 通过托管代码在 Windows Mobile 中查看 SMS

> ID：289946
> 
> 赞同：1
> 
> 时间：2008-11-14T12:38:58.420
> 
> 标签：windows-mobile, sms

在 Windows Mobile SDK 中，Microsoft.WindowsMo​​bile.PocketOutlook 中有一个 MessagingApplication 类，它有一个方法“DisplayComposeForm”，允许您调出默认的撰写对话框来发送 SMS。

我需要一种从托管代码显示默认消息查看对话框的方法。即我已经通过 MAPI 检索到消息，但现在我想使用 Windows Mobile 中的默认消息查看器显示它。

有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-17T13:46:06.520

感谢一些聪明的谷歌搜索，我偶然发现了答案。

使用 P/Invoke 访问 MAPI API 中的[MailDisplayMessage](http://msdn.microsoft.com/en-us/library/bb415500.aspx)方法。

P/Invoke 签名如下：

```
[DllImport("cemapi.dll")]
internal static extern int MailDisplayMessage(byte[] lpEntryID, int cbEntryID); 
```

对于对消息存储的托管访问，您可以使用免费的[MAPIdotnet](http://www.codeproject.com/KB/mobile/PocketPCandSmartphone.aspx)项目。

# powershell - 为什么通过 FTP 传输的 Apple DMG 文件已损坏？

> ID：289950
> 
> 赞同：0
> 
> 时间：2008-11-14T12:39:56.373
> 
> 标签：powershell, ftp, dmg

我正在尝试对一些苹果 DMG 文件进行 FTP 传输，如果我们通过 Safari 或 IE 手动完成，它最终会到达目的地并且完好无损。但是，如果我使用一个免费软件 FTP 客户端，我们一直在为 zip 和 exe 取得巨大成功，或者如果我使用我完成的 Powershell 脚本（改编自另一个 stackover 流的问题的答案），那么我会丢失大约 1/2 Mb一个 10.5 Mb 的文件，并且 dmg 已损坏。有没有人知道可能出了什么问题？我可以做些什么来防止它？到目前为止，我所尝试的只是在发送之前对 dmg 进行 gzip 压缩，但什么也没做。同样，除了 dmg 之外的任何东西都可以很好地传输。

仅供参考，我正在使用二进制模式传输，所以不是这样..thx

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T12:42:52.483

似乎您的客户将 dmg 文件视为文本文件。在您的 ftp 客户端中设置二进制传输模式，它将按原样进行 ftp。

我一直认为 ftp 中的 ascii 传输模式很愚蠢。它会带来更多的麻烦，然后它是值得的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T12:43:41.810

您确定除 DMG 之外的所有内容都正确传输吗？这听起来像是传输编码的问题。FTP 支持二进制和 ASCII 传输类型，主要是由于历史包袱。在过去，当带宽更紧张时，去掉高位（ASCII 不使用）是一个很好的节省时间的方法。但是，如果您有任何设置了位的字节，ASCII 传输模式将丢失它们 - 因此是“二进制”模式，它不会截断任何内容。

通常，切换传输模式的命令是“bin”或“ascii”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-01T16:12:41.713

就这样大家都知道了。一定是我使用的客户端与我的 PowerShell 脚本有完全相同的问题。我正在使用 StreamReader 来获取要传输的字节，并且它假设编码不正确。我切换到了一个没有的 BinaryReader，现在它可以工作了。

# delphi - Delphi 和 XPath 函数

> ID：289951
> 
> 赞同：1
> 
> 时间：2008-11-14T12:39:56.670
> 
> 标签：delphi, xpath, msxml

我可以在 Delphi 的函数 selectNodes() 中使用 Xpath 节点集函数 position() 从节点列表中只选择一定数量的元素吗？如果我这样做：

```
selectNodes('Item[1]') 
```

一切都很好，我得到了索引为 1 的元素，但是当我尝试时

```
selectNodes('Item[position()<10]') 
```

当我尝试时，我得到异常“未知方法”

```
selectNodes('Item[<10]') 
```

我得到“意外的令牌<”。我使用的是 delphi7，我还使用更新版本的 msxml 将新类型库导入到我的项目中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T13:09:53.910

我认为这不是一个真正的德尔福问题，而是一个 MSXML 问题。检查[MSXML 文档](http://msdn.microsoft.com/en-us/library/ms763742(VS.85).aspx)或更确切地说是[MS XPath 文档](http://msdn.microsoft.com/en-us/library/ms256115(VS.85).aspx)。

嗯，根据MSDN 上发布的[XPath 示例](http://msdn.microsoft.com/en-us/library/ms256086(VS.85).aspx)`Item[position() &lt; 10]`“ ”应该可以工作，至少如果“ `Item`”是您所追求的元素的名称......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-17T15:00:55.167

会不会是版本问题？我已经从 MS XML 6 导入了类型库，并且没有出现错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T12:45:57.703

selectNodes 需要一个字符串，所以你应该尝试：

```
selectNodes('Item[position()<10]') 
```

或任何 xpath 查询。

# java - 通过 Java 将文本插入现有文件

> ID：289965
> 
> 赞同：26
> 
> 时间：2008-11-14T12:44:50.217
> 
> 标签：java, file, file-io, filesystems

我想创建一个简单的程序（在 Java 中）来编辑文本文件 - 特别是一个在文本文件中的随机位置插入任意文本片段的程序。这个功能是我目前正在编写的一个更大程序的一部分。

阅读有关 java.util.RandomAccessFile 的描述，似乎在文件中间执行的任何写入操作实际上都会覆盖现有内容。这是我想避免的副作用（如果可能的话）。

有没有一种简单的方法可以实现这一目标？

提前致谢。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-07-10T08:35:23.267

好的，这个问题已经很老了，但是 FileChannels 从 Java 1.4 开始就存在了，我不知道为什么在处理在文件中替换或插入内容的问题时没有提到它们。[FileChannels](http://docs.oracle.com/javase/6/docs/api/java/nio/channels/FileChannel.html)很快，使用它们。

这是一个示例（忽略异常和其他一些东西）：

```
public void insert(String filename, long offset, byte[] content) {
  RandomAccessFile r = new RandomAccessFile(new File(filename), "rw");
  RandomAccessFile rtemp = new RandomAccessFile(new File(filename + "~"), "rw");
  long fileSize = r.length();
  FileChannel sourceChannel = r.getChannel();
  FileChannel targetChannel = rtemp.getChannel();
  sourceChannel.transferTo(offset, (fileSize - offset), targetChannel);
  sourceChannel.truncate(offset);
  r.seek(offset);
  r.write(content);
  long newOffset = r.getFilePointer();
  targetChannel.position(0L);
  sourceChannel.transferFrom(targetChannel, newOffset, (fileSize - offset));
  sourceChannel.close();
  targetChannel.close();
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-14T12:57:33.327

嗯，不，我不相信有一种方法可以避免使用单个标准 Java IO API 调用覆盖现有内容。

如果文件不是太大，只需将整个文件读入 ArrayList（每行一个条目），然后重写条目或为新行插入新条目。

然后用新内容覆盖现有文件，或将现有文件移动到备份并写入新文件。

根据编辑需要的复杂程度，您的数据结构可能需要更改。

另一种方法是在写入已编辑文件时从现有文件中读取字符，并在读取流时对其进行编辑。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-21T15:00:02.897

如果 Java 有内存映射文件的方法，那么您可以做的是将文件扩展至新长度，映射文件，将所有字节向下移动到末尾以创建一个孔并将新数据写入该孔。

这在 C 中有效。从未在 Java 中尝试过。

我刚刚想到的另一种方法，但使用随机文件访问。

*   寻找到最后 - 1 MB
*   读取 1 MB
*   将其写入原始位置+间隙大小。
*   对文件开头的每个前 1 MB 重复此操作。
*   当您到达所需的间隙位置时停止。

使用更大的缓冲区大小以获得更快的性能。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-06-04T06:16:23.973

您可以使用以下代码：

```
BufferedReader reader = null;
BufferedWriter writer = null;
ArrayList list = new ArrayList();

try {
    reader = new BufferedReader(new FileReader(fileName));
    String tmp;
    while ((tmp = reader.readLine()) != null)
        list.add(tmp);
    OUtil.closeReader(reader);

    list.add(0, "Start Text");
    list.add("End Text");

    writer = new BufferedWriter(new FileWriter(fileName));
    for (int i = 0; i < list.size(); i++)
        writer.write(list.get(i) + "\r\n");
} catch (Exception e) {
    e.printStackTrace();
} finally {
    OUtil.closeReader(reader);
    OUtil.closeWriter(writer);
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-14T12:55:18.247

我相信将文本插入现有文本文件的唯一方法是读取原始文件并将内容写入临时文件并插入新文本。然后擦除原始文件并将临时文件重命名为原始名称。

这个[例子](http://www.java-tips.org/java-se-tips/java.io/insert-a-line-in-a-file.html)的重点是在现有文件中插入一行，但仍然可能对您有用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-14T12:55:33.847

我不知道是否有一种方便的方法可以直接做到这一点

*   读取文件的开头并将其写入目标
*   将您的新文本写入目标
*   读取文件的其余部分并将其写入目标。

关于目标：您可以在内存中构造文件的新内容，然后如果处理的文件不是很大，则覆盖文件的旧内容。或者您可以将结果写入临时文件。

使用流可能最容易做到这一点， RandomAccessFile 似乎并不意味着插入中间（afaik）。如果需要，请查看[教程。](http://java.sun.com/docs/books/tutorial/essential/io/index.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-09-23T19:08:29.423

如果是文本文件，，，，读取 StringBuffer 中的现有文件并将新内容附加到同一个 StringBuffer 中，现在您可以将 SrtingBuffer 写入文件。所以现在该文件包含现有文本和新文本。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-10-05T21:49:03.570

由于@xor_eq 答案的编辑队列已满，因此在一个新答案中，他的版本更加有据可查且略有改进：

```
public static void insert(String filename, long offset, byte[] content) throws IOException {
    File temp = Files.createTempFile("insertTempFile", ".temp").toFile(); // Create a temporary file to save content to
    try (RandomAccessFile r = new RandomAccessFile(new File(filename), "rw"); // Open file for read & write
            RandomAccessFile rtemp = new RandomAccessFile(temp, "rw"); // Open temporary file for read & write
            FileChannel sourceChannel = r.getChannel(); // Channel of file
            FileChannel targetChannel = rtemp.getChannel()) { // Channel of temporary file
        long fileSize = r.length();
        sourceChannel.transferTo(offset, (fileSize - offset), targetChannel); // Copy content after insert index to
                                                                                // temporary file
        sourceChannel.truncate(offset); // Remove content past insert index from file
        r.seek(offset); // Goto back of file (now insert index)
        r.write(content); // Write new content
        long newOffset = r.getFilePointer(); // The current offset
        targetChannel.position(0L); // Goto start of temporary file
        sourceChannel.transferFrom(targetChannel, newOffset, (fileSize - offset)); // Copy all content of temporary
                                                                                    // to end of file
    }
    Files.delete(temp.toPath()); // Delete the temporary file as not needed anymore
} 
```

# sql-server - SQL Server 此时无法获取 LOCK 资源 - 怎么办？

> ID：289969
> 
> 赞同：2
> 
> 时间：2008-11-14T12:46:44.020
> 
> 标签：sql-server, sql-server-2005, multithreading

我在 SQL Server 2005 上有一个存储过程来执行可序列化事务。在这个事务中，它选择一个带有行锁的表。在过程结束时，在回滚/提交之后，它将事务隔离级别设置为已提交读。

这个程序在运行，不同的进程有这些约束控制的并发访问，但是突然，一段时间后，一些进程抛出了一个Sql Exception：

> SQL Server 数据库引擎的实例此时无法获取 LOCK 资源。当活动用户较少时重新运行您的语句。要求数据库管理员检查此实例的锁和内存配置，或检查长时间运行的事务。

这是不可预测的，它可能会提前发生，也可能在一小时后发生。

我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T14:04:13.537

你的记忆锁太多了。增加内存或重写您的查询以使用更少的锁。可序列化是一个锁猪。你真的需要吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-26T12:43:55.577

我通过减少服务器之间传递的数据范围来解决此错误，这意味着如果您选择 1000 条记录，请尝试将事务减少为两批 500 条记录，另外 500 条记录不断减少数量，直到错误停止

# database - 带有嵌入式数据库的 PowerBuilder 应用程序？

> ID：289972
> 
> 赞同：1
> 
> 时间：2008-11-14T12:48:11.240
> 
> 标签：database, sqlite, powerbuilder

是否可以将 SQLite 与 PowerBuilder 一起使用？我需要一个嵌入式开源数据库（无需额外费用）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-16T03:24:52.547

就像伯纳德说的那样，你需要一个 ODBC 驱动程序，所以只要你愿意去第三方（如果我正确理解 SQLite 的情况），那应该没问题。

也就是说，如果您拥有 PowerBuilder，则您拥有分发单用户 SQL Anywhere 运行时引擎的许可。如果免费是您的唯一标准，并且您只是在本地连接，那么 SQL Anywhere 可能是一个评估选项。它不仅是一个非常可靠的数据库，而且还有更多的文档基础和将 PowerBuilder 连接到 SQL Anywhere 的经验，因此如果您遇到问题，您更有可能获得一些帮助。

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T17:33:47.043

我不相信 PowerBuilder 包含原生支持 SQLite 的驱动程序。但它肯定有一个 ODBC 驱动程序，因此即使它不是最有效的选项，它也始终是一个选项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T21:26:37.950

我曾经使用 SQL Anywhere，但由于 Joe Landau 给出的原因最终放弃了它 - 无法使用可分发的运行时引擎更改架构。

我改用 Firebird，它有一个嵌入式版本，看起来很可靠。唯一的问题是我正在使用的 ODBC 驱动程序（Gemini）似乎是最好的驱动程序，它似乎已经停业了。（我刚刚检查过 - 它似乎在其他网站上可用。）您必须将以下内容添加到您的 PBODB*.INI 文件中：

```
[Firebird]
PBSyntax='Firebird_SYNTAX'
PBNoCatalog='YES'

[Firebird_SYNTAX]
CreateTable='CREATE TABLE &TableName (::ColumnElement[::ColumnElement]...)'
ColumnElement='&ColumnName &DataType'
DropTable='DROP TABLE &TableName'
GetIdentity='Select gen_id(GEN_&TableName,0) from RDB$DATABASE' 
```

我对此非常满意。使用了将近 2 年，拥有超过 1,000 名用户，没有任何问题。如果某些用户需要，您也可以轻松切换到 Firebird 服务器版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-24T06:13:07.257

如前所述，SQL Anywhere 可用且可靠。但它有一个缺点——您不能使用运行时引擎更改架构。这使得很难将一列添加到您已分发的数据库中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-04-10T22:57:11.493

++ DC 对 Firebird 的评论。最好的免费数据库之一。我多年来一直将它用于我出售给律师事务所的 PB 应用程序。

尽管即使目标是单个工作站，我也使用服务器版本。如果需要，可以简化部署和稍后添加工作站的问题。

[我在http://www.firebirdsql.org/index.php?op=files&id=odbc](http://www.firebirdsql.org/index.php?op=files&id=odbc)使用标准的 Firebird ODBC 驱动程序

我使用过两个很好的 GUI 前端数据库管理工具 - IBOConsole 和 Flamerobin。

# python - 使用 python 或 ironpython 访问 mssql 的最简单方法是什么？

> ID：289978
> 
> 赞同：23
> 
> 时间：2008-11-14T12:50:11.860
> 
> 标签：python, sql-server, ironpython

我在我的个人计算机上运行了 mssql 2005，并带有一个我想在其上运行一些 python 脚本的数据库。我正在寻找一种方法来对数据进行一些非常简单的访问。我想运行一些选择语句，处理数据，也许让 python 保存一个包含结果的文本文件。

不幸的是，即使我对 python 和数据库有所了解，但仅从阅读中我很难判断一个库是否符合我的要求。理想情况下，我想要一些适用于其他版本的 mssql、免费并获得许可以允许商业使用、易于使用并且可能与 Ironpython 一起使用的东西。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-11-19T12:27:37.097

其他人似乎都覆盖了 cPython -> SQL Server 端。如果你想使用 IronPython，你可以使用标准的 ADO.NET API 与数据库对话：

```
import clr
clr.AddReference('System.Data')
from System.Data.SqlClient import SqlConnection, SqlParameter

conn_string = 'data source=<machine>; initial catalog=<database>; trusted_connection=True'
connection = SqlConnection(conn_string)
connection.Open()
command = connection.CreateCommand()
command.CommandText = 'select id, name from people where group_id = @group_id'
command.Parameters.Add(SqlParameter('group_id', 23))

reader = command.ExecuteReader()
while reader.Read():
    print reader['id'], reader['name']

connection.Close() 
```

如果您已经拥有 IronPython，则无需安装其他任何东西。

[这里](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.aspx)和[这里](http://www.ironpython.info/index.php/Contents#Databases)有很多可用的文档。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-11-14T13:02:21.383

我将[SQL Alchemy](http://www.sqlalchemy.org/)与 cPython 一起使用（我不知道它是否可以与 IronPython 一起使用）。如果您使用过 Hibernate/nHibernate，您会非常熟悉。如果这对您来说有点过于冗长，您可以使用[Elixir](http://elixir.ematia.de/trac/wiki)，它是 SQL Alchemy 之上的一个薄层。要使用其中任何一个，您需要[pyodbc](http://pyodbc.sourceforge.net/)，但这是一个非常简单的安装。

当然，如果你想直接写 SQL 而不使用 ORM，你只需要 pyodbc。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-11-14T21:17:14.940

pyodbc 带有 Activestate Python，可以从[这里](http://www.activestate.com/store/productdetail.aspx?prdGuid=b08b04e0-6872-4d9d-a722-7a0c2dea2758)下载。连接到 SQL Server 2005 数据库的最小 odbc 脚本如下所示：

```
import odbc

CONNECTION_STRING="""
Driver={SQL Native Client};
Server=[Insert Server Name Here];
Database=[Insert DB Here];
Trusted_Connection=yes;
"""

db = odbc.odbc(CONNECTION_STRING)
c = db.cursor()
c.execute ('select foo from bar')
rs = c.fetchall()
for r in rs:
    print r[0] 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-14T13:39:35.707

我还成功地将[pymssql](http://pymssql.sourceforge.net/)与 CPython 一起使用。（有和没有 SQLAlchemy）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-23T14:54:22.337

[http://adodbapi.sourceforge.net/](http://adodbapi.sourceforge.net/)可以与 CPython 或 IronPython 一起使用。我对此非常满意。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-09-27T03:49:08.723

[PyPyODBC](http://code.google.com/p/pypyodbc "PyPyODBC") ( [http://code.google.com/p/pypyodbc](http://code.google.com/p/pypyodbc) ) 在 PyPy、Ironpython 和 CPython 下工作。

[本文](https://code.google.com/p/pypyodbc/wiki/A_HelloWorld_sample_to_access_mssql_with_python)展示了一个用 Python 访问 mssql 的 Hello World 示例。

PyPyODBC 的用法与 pyodbc 几乎相同，因为它可以被视为 pyodbc moudle 的重新实现。因为它是用纯 Python 编写的，所以它也可以在 IronPython 和 PyPy 上运行。

实际上，在现有脚本中切换到 pypyodbc 时，您可以这样做：

```
#import pyodbc               <-- Comment out the original pyodbc importing line

import pypyodbc as pyodbc    # Let pypyodbc "pretend" the pyodbc

pyodbc.connect(...)          # pypyodbc has 99% same APIs as pyodbc

... 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-14T21:08:49.607

我已经将[pymssql](http://www.pymssql.org/)与标准 python 一起使用并且喜欢它。如果您*只是在*寻找基本的数据库访问权限，可能比提到的替代方案更容易。

示例[代码](http://www.pymssql.org/pymssql_examples.html)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-09-14T20:48:50.093

如果您想要使用 CPython 的快速而肮脏的方式（也适用于 3.X python）：

[安装 python http://sourceforge.net/projects/pywin32/files/pywin32/](http://sourceforge.net/projects/pywin32/files/pywin32/)后安装 PYWIN32

导入以下库：import odbc

我创建了以下获取 SQL Server odbc 驱动程序的方法（根据您的 Windows 版本，命名略有不同，因此无论如何都会得到它）：

```
def getSQLServerDriver():
    key = winreg.OpenKey(winreg.HKEY_LOCAL_MACHINE, r"SOFTWARE\ODBC\ODBCINST.INI")
    sqlServerRegExp =  re.compile('sql.*server', re.I | re.S)

    try:
        for i in range(0, 2048):
            folder = winreg.EnumKey(key, i)
            if sqlServerRegExp.match(folder):
                return folder.strip()
    except WindowsError:
        pass 
```

注意：如果你使用上面的函数，你还需要导入这两个库：winreg 和 re

然后使用此处定义的 odbc API 1 信息：http: [//www.python.org/dev/peps/pep-0248/](http://www.python.org/dev/peps/pep-0248/)

您的连接接口字符串应如下所示（假设您使用我上面的方法来获取 ODBC 驱动程序名称，并且它是受信任的连接）：

```
dbString = "Driver={SQLDriver};Server=[SQL Server];Database=[Database Name];Trusted_Connection=yes;".replace('{SQLDriver}', '{' + getSQLServerDriver() + '}') 
```

这种方法有很多缺点。因为只支持 ODBC API 1，所以它很笨拙，而且我遇到的 API 或 ODBC 驱动程序中存在一些小错误，但它确实可以在 Windows 中的所有 CPython 版本中完成工作。

# database - 使用 postgresql 连接的应用程序进行测试自动化

> ID：289979
> 
> 赞同：0
> 
> 时间：2008-11-14T12:50:45.417
> 
> 标签：database, postgresql, web-applications, testing

我想在我的 Web 应用程序上自动化测试，它使用 postgresql。有谁知道如何在 postgresql 数据库上定义还原点并还原到早期状态？我听说过有关时间点恢复的信息，但如果这是我需要的，我不知道。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-14T13:19:54.687

PITR 适用于在线备份场景，它旨在在不中断操作的情况下创建备份，然后能够在发生灾难时恢复数据，而不是用于测试应用程序。数据恢复不在线，比较复杂。

我认为测试的正确方法是拥有一个可以轻松丢弃并从标准备份恢复的数据库，然后您可以通过在自动化中使用标准备份/恢复脚本来重复测试。如果做不到这一点，另一种测试方法是使用事务。您将进行的每个测试都将包含在执行测试后回滚的事务中。

```
BEGIN;
SELECT ...
INSERT ...
UPDATE ...
DELETE ...

<Here go queries to check if everything is alright, setting the test result>
ROLLBACK 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T13:35:11.707

首先，不要在您的生产数据库上执行此操作。

正确的方法 (tm) 是将交易用于其价值。在 postgres 中，您甚至可以使用保存点（您可以回滚到）来嵌套它们。

```
test=# create table foo (foo_id serial primary key, bar varchar);
NOTICE:  CREATE TABLE will create implicit sequence "foo_foo_id_seq" for serial column "foo.foo_id"
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "foo_pkey" for table "foo"
CREATE TABLE
test=# begin; insert into foo (bar) values ('test');
BEGIN
INSERT 0 1
test=# savepoint sp1;
SAVEPOINT
test=# insert into foo (foo_id, bar) values (1, 'test');
ERROR:  duplicate key value violates unique constraint "foo_pkey"
test=# rollback to sp1;
ROLLBACK
test=# select * from foo;
 foo_id | bar  
--------+------
      1 | test
test=# -- note that you're still in a transaction 
```

如果这不适合（由于软件限制或其他原因），您可以始终将数据库的多个转储保存在可以轻松恢复的文件中；和/或有一个脚本自动将您的生产数据库转储到本地测试数据库中。

此外，请始终记住将架构更改保留在版本控制中（或至少一些 .sql 文件）；使用测试数据库开发新内容后，可以轻松更新生产数据库。

PITR 主要用于热备用/备份目的。

# c# - C# 中是否有可用于属性的委托？

> ID：289980
> 
> 赞同：13
> 
> 时间：2008-11-14T12:50:57.177
> 
> 标签：c#, .net

给定以下课程：

```
class TestClass {
  public void SetValue(int value) { Value = value; }
  public int Value { get; set; }
} 
```

我可以

```
TestClass tc = new TestClass();
Action<int> setAction = tc.SetValue;
setAction.Invoke(12); 
```

这一切都很好。是否可以使用属性而不是方法来做同样的事情？最好使用.net内置的东西。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-14T13:06:03.077

您可以使用反射创建委托：

```
Action<int> valueSetter = (Action<int>)Delegate.CreateDelegate(typeof(Action<int>), tc, tc.GetType().GetProperty("Value").GetSetMethod()); 
```

或为设置属性的匿名方法创建委托；

```
Action<int> valueSetter = v => tc.Value = v; 
```

编辑：对 CreateDelegate() 使用了错误的重载，需要使用以对象为目标的重载。固定的。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-14T13:03:01.367

有三种方法可以做到这一点；第一种是使用GetGetMethod()/GetSetMethod() 并使用Delegate.CreateDelegate 创建一个委托。第二个是 lambda（反射没有多大用处！）[即 x=>x.Foo]。第三个是通过表达式（.NET 3.5）。

lambda 是最简单的；-p

```
 class TestClass
    {
        public int Value { get; set; }
    }
    static void Main()
    {
        Func<TestClass, int> lambdaGet = x => x.Value;
        Action<TestClass, int> lambdaSet = (x, val) => x.Value = val;

        var prop = typeof(TestClass).GetProperty("Value");
        Func<TestClass, int> reflGet = (Func<TestClass, int>) Delegate.CreateDelegate(
            typeof(Func<TestClass, int>), prop.GetGetMethod());
        Action<TestClass, int> reflSet = (Action<TestClass, int>)Delegate.CreateDelegate(
            typeof(Action<TestClass, int>), prop.GetSetMethod());
    } 
```

显示用法：

```
 TestClass foo = new TestClass();
        foo.Value = 1;
        Console.WriteLine("Via property: " + foo.Value);

        lambdaSet(foo, 2);
        Console.WriteLine("Via lambda: " + lambdaGet(foo));

        reflSet(foo, 3);
        Console.WriteLine("Via CreateDelegate: " + reflGet(foo)); 
```

请注意，如果您希望委托指向特定实例，则可以对 lambda 使用闭包，或者接受和实例的 CreateDelegate 的重载。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-14T12:53:22.070

属性实际上是 .Net 中方法的包装器，因此使用反射您应该能够获取委托（set_PROPERTY 和 get_PROPERTY）然后执行它们......

请参阅[System.Reflection.PropertyInfo](http://msdn.microsoft.com/en-us/library/system.reflection.propertyinfo(VS.85).aspx)

如果有两种方法可用于获取/设置值 - GetGetMethod 和 GetSetMethod。

所以你可以写：

```
var propertyInfo = typeof (TestClass).GetProperty ("Value");

var setMethod = property.GetSetMethod (); // This will return a MethodInfo class. 
```

# sql-server - 如何导入 SDF 文件

> ID：289994
> 
> 赞同：9
> 
> 时间：2008-11-14T12:55:41.177
> 
> 标签：sql-server, sql-server-2008, compact-framework, import, sdf

我开始使用我的数据库的 Sql Compact 版本，在开发过程中，需要通过网络访问数据库。因为我无法找到一种无需复制即可通过网络共享 SDF 文件的方法，我需要将其导入 SQL Server 2008 (Express)。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-14T15:45:34.377

我解决了我的问题。GvS 的建议给出了要搜索的关键字：http: [//bembengarifin-tech.blogspot.com/2008/08/generate-script-export-data-from-sql-ce.html](http://bembengarifin-tech.blogspot.com/2008/08/generate-script-export-data-from-sql-ce.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-25T17:34:28.410

CodePlex 现在有几个工具可以完美地解决这个问题。

这些是 IDE 扩展。

如果您使用的是 SQL Server Management Studio Express 或更高版本，请获取[此版本。](http://exportsqlce.codeplex.com/)

如果您使用的是 Visual Studio 2010 Pro 或更高版本，请获取[此版本。](http://sqlcetoolbox.codeplex.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T13:23:09.517

这看起来更难，因为它似乎不适用于 SQL Server 导入和导出向导。

您可以编写一个小程序，逐个表/逐个记录地从 SDF 文件表中获取所有数据，然后将它们插入 SQL 数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T13:37:21.157

我想看看您是否可以使用 ODBC 直接访问数据库文件，但显然不能...根据[这个论坛主题](http://www.mydatabasesupport.com/forums/ms-sqlserver/216820-odbc-driver-sql-ce.html)，您最好的选择是尝试通过 OLEDB/ADO 访问它。

# language-agnostic - “过载”/“过载”/“过载”是什么意思？

> ID：289997
> 
> 赞同：16
> 
> 时间：2008-11-14T12:58:16.553
> 
> 标签：language-agnostic, overloading

关于编程，“过载”/“过载”是什么意思？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-11-14T13:00:59.403

这意味着您提供了一个名称相同但签名不同的函数（方法或运算符）。例如：

```
void doSomething();
int doSomething(string x);
int doSomething(int a, int b, int c); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-14T13:11:47.870

**基本概念**

重载或“方法重载”是具有多个具有相同名称但具有不同参数的方法的概念的名称。

例如，c# 中的 System.DateTime 类有多个 ToString 方法。标准 ToString 使用系统的默认区域性将日期时间转换为字符串：

```
new DateTime(2008, 11, 14).ToString(); // returns "14/11/2008" in America 
```

而同一方法的另一个重载允许用户自定义格式：

```
new DateTime(2008, 11, 14).ToString("dd MMM yyyy"); // returns "11 Nov 2008" 
```

有时参数名称可能相同，但参数类型可能不同：

```
Convert.ToInt32(123m); 
```

将小数转换为 int 而

```
Convert.ToInt32("123"); 
```

将字符串转换为 int。

**过载分辨率**

为了找到要调用的最佳重载，编译器执行名为“重载解析”的操作。对于第一个示例，编译器只需匹配参数计数即可找到最佳方法。对于第二个示例，如果传递十进制参数，编译器会自动调用十进制版本的替换方法，如果传递字符串参数，编译器会自动调用字符串版本。从可能的输出列表中，如果编译器找不到合适的调用，您将收到类似“最佳重载与参数不匹配...”的编译器错误。

您可以[找到](http://www.google.com/search?hl=en&client=opera&rls=en&hs=syd&q=overload+resolution&btnG=Search)很多关于不同编译器如何执行重载解析的信息。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-14T13:01:45.627

当一个函数有多个签名时，它就会被重载。这意味着您可以使用不同的参数类型调用它。例如，您可能有一个在屏幕上打印变量的函数，您可以为不同的参数类型定义它：

```
void print(int i);
void print(char i);
void print(UserDefinedType t); 
```

在这种情况下，函数 print() 将具有三个重载。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-14T13:02:04.770

这意味着具有相同函数的不同版本，它们采用不同类型的参数。这样的功能是“重载”的。例如，采用以下函数：

```
void Print(std::string str) {
  std::cout << str << endl;
} 
```

您可以使用此函数将字符串打印到屏幕上。但是，当您要打印整数时不能使用此函数，您可以制作该函数的第二个版本，如下所示：

```
void Print(int i) {
  std::cout << i << endl;
} 
```

现在函数被重载了，调用哪个版本的函数取决于你给它的参数。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-07T08:18:08.250

其他人已经回答了超载是什么。当您开始时，它会与覆盖/覆盖混淆。

与重载相反，覆盖是在子类（或子类）中定义具有相同签名的方法，它会覆盖父类的实现。某些语言需要显式指令，例如`virtual`C++ 或`override`Delphi 和 C# 中的成员函数。

```
using System;

public class DrawingObject
{
    public virtual void Draw()
    {
        Console.WriteLine("I'm just a generic drawing object.");
    }
}

public class Line : DrawingObject
{
    public override void Draw()
    {
        Console.WriteLine("I'm a Line.");
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-14T13:02:22.287

重载方法是一种具有多个参数数量和类型选项的方法。例如：

```
foo(foo)

foo(foo, bar) 
```

两者都会做相对相同的事情，但一个有更多选项的第二个参数

您也可以使用相同的方法采用不同的类型

```
int Convert(int i)
int Convert(double i)
int Convert(float i) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-14T13:06:00.923

就像通常的用法一样，它指的是某事（在这种情况下，是方法名称），做不止一项工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-16T23:07:47.497

**重载是**[来自 CLOS 和其他语言](http://en.wikipedia.org/wiki/Multimethod)的多方法的穷人版本 。这是令人困惑的一个。

**覆盖**是通常的 OO 之一。它与继承有关，我们也将其称为重新定义（例如，在[https://stackoverflow.com/users/3827/eed3si9n 的答案](https://stackoverflow.com/questions/289997/what-does-overloaded-overload-overloading-mean/419549#419549) `Line`中提供了`Draw()`.***************