# StackOverflow 问答 000795000-000795999

# php - 使用 Cacti 监控请求响应的 HTTP 状态码？

> ID：795011
> 
> 赞同：0
> 
> 时间：2009-04-27T19:49:14.717
> 
> 标签：php, curl, monitoring, cacti

我有一个代理脚本，它通过 PHP 使用 cURL 向其他页面发出 HTTP GET 请求。

是否可以使用 Cacti 监控哪些响应代码返回到这些 cURL 请求？如果不是 Cacti，是否可以使用任何类似的监控系统？

例如，我想要一个显示每个状态类别中有多少响应的报告，即 200、404、500 等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T20:17:00.017

当然，您可以使用 Cacti 来做这些事情。你可以用它绘制几乎任何东西。 [http://docs.cacti.net/manual:087:3a_advanced_topics.1_data_input_methods#data_input_methods](http://docs.cacti.net/manual:087:3a_advanced_topics.1_data_input_methods#data_input_methods)

从您的问题看来，您需要一个监控和警报解决方案，而不仅仅是一个图形解决方案。对于监控、警报和绘图（尽管这些图表不如 rrdtool 和 cacti 有吸引力），我喜欢开源 Hyperic 产品 ( [http://www.hyperichq.com](http://www.hyperichq.com) )。还有 Nagios、BigBrother 和许多其他低成本/免费选项。

# c# - System.IO.Stream 有接口吗？

> ID：795012
> 
> 赞同：2
> 
> 时间：2009-04-27T19:49:23.687
> 
> 标签：c#, mono

我正在编写一个需要接收对象、记录其当前状态、更新对象并将其传递给另一个类的类。唯一的问题是你只能从一个类继承，而我需要它来继承我项目中的一个类。我对 System.IO.Stream 很感兴趣，因为如果需要，我可以将这个类移到它自己的线程中，而不需要大多数（如果不是全部）套接字和 IPC 的其他方法。主要问题是，是否有 System.IO.Stream 的接口？如果没有，有没有办法在不牺牲我所依赖的项目关键数据的情况下获得我想要的功能？（如果我听起来有点不连贯，我很抱歉，我真的不知道如何措辞这个问题。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T19:55:13.877

听起来`IEnumerable<T>`更合适 - 流适合传递*字节*，但迭代器适合表示更通用的对象流。

您需要从流中读取的内容（例如套接字）并创建对象，可能使用 C# 迭代器块（yield 语句等）。然后，您可以在 上使用处理功能、过滤器等，`IEnumerable<T>`稍后再将其送回套接字（或其他字节流）。

要回答这个问题 - 不，`Stream`没有界面，但不清楚这与您的问题的线程部分有多大的相关性。您对异步 IO 感兴趣吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T19:55:30.740

为什么你想要一个 Stream 接口？实现该接口不会为您提供该类的任何功能，它只会让其他类知道您提供了该功能。如果你真的需要多重继承（两个基类，这样你就可以从两者中获得功能），你*可以*让你的基类，你肯定需要的，成为 Stream 本身的子类。

```
public class MyObject : Base Object
{

}

public class BaseObject : Stream
{

} 
```

ETC..？

mroe 背景/上下文可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T19:56:52.377

很难弄清楚你在这里想要做什么。

这听起来像是聚合而不是继承的候选者。而不是扩展 System.IO.Stream，你为什么不将一个传递给对象来使用呢？这可以作为属性或 get/set 方法，如果您将对象传递给另一个线程，则流随之而来。

# cocoa - 在 QTCapture 中设置分辨率？

> ID：795018
> 
> 赞同：3
> 
> 时间：2009-04-27T19:50:59.503
> 
> 标签：cocoa, video, quicktime

我正在从网络摄像头录制。相机在 PhotoBooth 中看起来很棒。但是，当我在我的程序中使用 QTCaptureView 预览它，或者将它记录到文件中时，它非常非常慢。原因是 QuickTime 为我提供了 1600x1200 的最大可能分辨率。如何为我的 QTCaptureView 和我的录制文件强制一个更合理的大小？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-29T18:21:41.073

如此[处所述](http://developer.apple.com/qa/qa2008/qa1582.html)，您可以在 QTCaptureSession 的输出中设置像素缓冲区属性，以更改正在捕获的视频的分辨率。例如：

```
[[[myCaptureSession outputs] objectAtIndex:0] setPixelBufferAttributes: [NSDictionary dictionaryWithObjectsAndKeys:
                                                                [NSNumber numberWithInt:480], kCVPixelBufferHeightKey,
                                                                [NSNumber numberWithInt:640], kCVPixelBufferWidthKey, nil]]; 
```

将捕获会话中第一个输出的视频分辨率设置为 640x480。这也应该调整相机设置本身，使其返回该大小的图像帧（如果相机硬件支持）。

您可能还希望使用基本 MPEG4 编码而不是 h.264 来进行实时视频录制。这可以使用类似于以下的代码进行设置：

```
NSArray *outputConnections = [mCaptureMovieFileOutput connections];
QTCaptureConnection *connection;
for (connection in outputConnections)
{
    if ([[connection mediaType] isEqualToString:QTMediaTypeVideo])
            [mCaptureMovieFileOutput setCompressionOptions:[QTCompressionOptions compressionOptionsWithIdentifier:@"QTCompressionOptionsSD480SizeMPEG4Video"] forConnection:connection];
} 
```

h.264 编码，尤其是 Quicktime 实现，使用比基本 MPEG4 更多的 CPU 能力进行编码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-12-06T18:09:28.753

上面的解决方案 (setPixelBufferAttributes:) 确实正确设置了预览大小，但是一旦电影录制开始，如果您设置了（几乎）任何压缩选项，预览图像将恢复为原始值（我的 MBP 上为 1280 x 1024） .

如果这只是在电影录制期间，那将是一回事，但是一旦录制完成，对 setPixelBufferAttributes 的进一步调用将无效。

因此，只要您不打算进行任何实际的压缩电影录制，您就可以更改预览图像的大小。

这是在 10.5.8/9L30、MBP 和 GeForce 8600M 上。除无压缩或 QTCompressionOptionsSD240SizeH264Video 中断之外的任何压缩选项，如上所述。

rdar://7447812

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-13T21:42:57.703

要添加有关该主题的更多信息：

您不能直接在捕获端指定定义。相反，这是定义定义的捕获会话的输出。例如

*   如果你捕捉到一个 QtCaptureDecompressedVideoOutput，你应该在这个对象上指定定义。

# wpf - WPF 中的本地化

> ID：795025
> 
> 赞同：37
> 
> 时间：2009-04-27T19:52:40.747
> 
> 标签：wpf, localization, resx

我正在 WPF 中启动一个新应用程序，我很好奇如何处理本地化？在 WinForms 中，您可以将 resx 字符串用于 UI 文本，这在 WPF 中是如何完成的？是否有用于绑定到 resx 资源的特殊绑定语法，或者是否有不同的方式来执行此操作？

谢谢！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-27T19:58:11.157

查看[WPF 全球化和本地化概述](https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/wpf-globalization-and-localization-overview)。这篇文章很好地解释了 WPF 中的本地化是如何工作的。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-06T07:09:42.970

您可以使用**MarkupExtension**通过动态语言切换进行本地化。这是一篇关于此的有趣文章：

[http://www.wpftutorial.net/LocalizeMarkupExtension.html](http://www.wpftutorial.net/LocalizeMarkupExtension.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-26T10:09:42.733

我发现使用 VS 模板开始 WPF 本地化非常容易，如[作者博客](http://www.csharpblog.co.cc/2011/04/easy-localize-wpf-application.html)中所述。

使用此模板创建的项目已经包含所有必要的本地化工具，并且最大限度地自动化了本地化过程。在应用程序开发过程中，您无需担心本地化问题即可添加新的 XAML 文件。更改完成后，只需构建项目并将默认语言更改为已翻译。

[下载](http://visualstudiogallery.msdn.microsoft.com/7b8a8c13-0a7b-481f-b1f9-08e085448bdc)模板

# binary - 代码高尔夫 - 十六进制到（原始）二进制转换

> ID：795027
> 
> 赞同：12
> 
> 时间：2009-04-27T19:53:19.997
> 
> 标签：binary, hex, code-golf

在回答[这个](https://stackoverflow.com/questions/794902/whats-the-opposite-of-od1)询问十六进制到（原始）二进制转换的问题时，有一条评论建议它可以用“5-10 行 C 或任何其他语言”来解决。

我确信对于（某些）脚本语言可以实现，并且想看看如何。我们能否证明该评论对于 C 也是正确的？

注意：这并不意味着十六进制到*ASCII*二进制 - 特别是输出应该是对应于输入 ASCII 十六进制的原始八位字节流。此外，输入解析器应该跳过/忽略空格。

**编辑**（由 Brian Campbell 撰写）为了保持一致性，我可以提出以下规则吗？如果您认为这些内容没有帮助，请随意编辑或删除这些内容，但我认为由于已经讨论了某些情况应该如何工作，因此进行一些澄清会有所帮助。

1.  程序必须从标准输入读取并写入标准输出（我们也可以允许读取和写入通过命令行传入的文件，但我无法想象在任何语言中这会比标准输入和标准输出更短）
2.  该程序必须仅使用包含在您的基本标准语言发行版中的软件包。对于 C/C++，这意味着它们各自的标准库，而不是 POSIX。
3.  程序必须在没有传递给编译器或解释器的任何特殊选项的情况下编译或运行（因此，'gcc myprog.c' 或 'python myprog.py' 或 'ruby myprog.rb' 都可以，而 'ruby -rscanf myprog.rb ' 是不允许的；需要/导入模块会影响您的字符数）。
4.  程序应读取由成对的相邻十六进制数字（大写、小写或混合大小写）表示的整数字节，可选用空格分隔，并将相应的字节写入输出。每对十六进制数字首先写入最高有效半字节。
5.  程序对无效输入的行为（除 之外`[a-fA-F \t\r\n]`的字符，将两个字符分隔在单个字节中的空格，输入中的奇数个十六进制数字）是未定义的；错误输入的任何行为（除了主动损坏用户的计算机或其他东西）都是可以接受的（抛出错误，停止输出，忽略错误字符，将单个字符视为一个字节的值，都可以）
6.  程序可能不会写入额外的字节来输出。
7.  代码按源文件中最少的总字节数计分。（或者，如果我们想更忠实于最初的挑战，分数将基于最少的代码行数；在这种情况下，我会限制每行 80 个字符，否则你会得到一堆1 行的关系）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-27T21:57:28.577

**编辑**Checkers 已将我的 C 解决方案减少到[46 字节](https://stackoverflow.com/questions/795027/code-golf-hex-to-raw-binary-conversion/795944#795944)，然后由于 BillyONEal 的提示加上我的错误修复（不再有错误输入的无限循环，现在它只是终止循环）而减少到 44 字节。请感谢 Checkers 将其从 77 字节减少到 46 字节：

```
main(i){while(scanf("%2x",&i)>0)putchar(i);} 
```

而且我有一个比上一个更好的 Ruby 解决方案，在~~42~~ *38*字节（感谢 Joshua Swank 的正则表达式建议）：

```
STDIN.read.scan(/\S\S/){|x|putc x.hex} 
```

**原始解决方案**

C，77 个字节，或两行代码（如果您可以将 1 放在`#include`同一行，则为 1）。请注意，这对错误输入有一个无限循环；在 Checkers 和 BillyONEal 的帮助下，44 字节的解决方案修复了错误，并在输入错误时停止。

```
#include <stdio.h>
int main(){char c;while(scanf("%2x",&c)!=EOF)putchar(c);} 
```

如果你正常格式化它甚至只有 6 行：

```
#include <stdio.h>
int main() {
  char c;
  while (scanf("%2x",&c) != EOF)
    putchar(c);
} 
```

Ruby，79 字节（我相信这可以改进）：

```
STDOUT.write STDIN.read.scan(/[^\s]\s*[^\s]\s*/).map{|x|x.to_i(16)}.pack("c*") 
```

它们都从 STDIN 获取输入并写入 STDOUT

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-28T13:11:54.853

39 char perl oneliner

```
y/A-Fa-f0-9//dc,print pack"H*",$_ for<> 
```

**编辑：**并没有真正接受大写，已修复。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-28T15:10:56.313

45 字节可执行文件（base64 编码）：

```
6BQAitjoDwDA4AQI2LQCitDNIevrWMOy/7QGzSF09jLkBMAa5YDkByrEJA/D 
```

（粘贴到扩展名为 .com 的文件中）

编辑：好的，这是代码。打开一个窗口的控制台，创建一个名为“hex.com”的 45 字节文件，输入“debug hex.com”，然后输入“a”并输入。复制并粘贴这些行：

```
db e8,14,00,8a,d8,e8,0f,00,c0,e0,04,08,d8,b4,02,8a,d0,cd,21,eb,eb,cd,20
db b2,ff,b4,06,cd,21,74,f6,32,e4,04,c0,1a,e5,80,e4,07,2a,c4,24,0f,c3 
```

按回车键，'w'，然后再次输入，'q' 并回车。您现在可以运行“hex.com”

EDIT2：使它小了两个字节！

```
db e8, 11, 00, 8a, d8, e8, 0c, 00, b4, 02, 02, c0, 67, 8d, 14, c3
db cd, 21, eb, ec, ba, ff, 00, b4, 06, cd, 21, 74, 0c, 04, c0, 18
db ee, 80, e6, 07, 28, f0, 24, 0f, c3, cd, 20 
```

那很棘手。我不敢相信我花时间做那件事。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-28T01:47:21.613

[Brian 的 77 字节 C 解决方案](https://stackoverflow.com/questions/795027/code-golf-hex-to-raw-binary-conversion/795452#795452)可以改进到 44 字节，这要归功于 C 对函数原型的宽容。

```
main(i){while(scanf("%2x",&i)>0)putchar(i);} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-27T19:58:55.553

在 Python 中：

```
binary = binascii.unhexlify(hex_str) 
```

一条线！（是的，这是作弊。）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-27T19:56:24.793

编辑：**这段代码是在充实要求的问题编辑之前很长时间编写的。**

鉴于单行 C 可以包含大量语句，几乎可以肯定它是正确的，但没有用处。

在 C# 中，我几乎肯定会用 10 多行来编写它，即使它在 10 行中也是*可行*的。我会将“解析 nybble”部分与“将字符串转换为字节数组”部分分开。

当然，如果您不关心发现错误的长度等，它会变得更容易一些。您的原始文本还包含空格 - 是否应该跳过、验证等？它们是*所需*输入格式的一部分吗？

我宁愿怀疑这个评论是在没有考虑一个令人愉快的、可读的解决方案是什么样子的情况下发表的。

话虽如此，这是 C# 中的一个可怕的版本。对于加分，它完全不恰当地使用 LINQ 来节省一两行代码。当然，线路可以更长...

```
using System;
using System.Linq;

public class Test
{
    static void Main(string[] args)
    {
        byte[] data = ParseHex(args[0]);
        Console.WriteLine(BitConverter.ToString(data));

    }

    static byte[] ParseHex(string text)
    {
        Func<char, int> parseNybble = c => (c >= '0' && c <= '9') ? c-'0' : char.ToLower(c)-'a'+10;
        return Enumerable.Range(0, text.Length/2)
            .Select(x => (byte) ((parseNybble(text[x*2]) << 4) | parseNybble(text[x*2+1])))
            .ToArray();
    }
} 
```

（这是通过使用任何内置的十六进制解析代码来避免“作弊”，例如`Convert.ToByte(string, 16)`。除此之外，这将意味着失去对单词 nybble 的使用，这始终是一个奖励。）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-27T21:09:54.697

嘎。

你不能在我的即兴估计上打电话给我！;-P

这是一个没有奇怪格式的 9 行 C 版本（好吧，我承认 tohex 数组最好分成 16 行，这样你就可以看到哪些字符代码映射到哪些值......），并且只有 2 个快捷方式除了一次性脚本之外，我不会部署任何东西：

```
#include <stdio.h>
char hextonum[256] = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 0, 0, 0, 0, 0, 0,10,11,12,13,14,15, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,10,11,12,13,14,15, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
char input[81]="8b1f0008023149f60300f1f375f40c72f77508507676720c560d75f002e5ce000861130200000000";
void main(void){
   int i = 0;
   FILE *fd = fopen("outfile.bin", "wb");
   while((input[i] != 0) && (input[i+1] != 0))
      fputc(hextonum[input[i++]] * 16 + hextonum[input[i++]], fd);
} 
```

没有合并的行（每个语句都有自己的行），它是完全可读的，等等。一个混淆的版本无疑可能更短，一个人可以作弊并将右大括号放在与前面的语句相同的行上，等等等等。

我不喜欢它的两件事是我没有 close(fd) ，并且 main 不应该是 void 并且应该返回一个 int。可以说它们是不需要的——操作系统将释放程序使用的所有资源，文件将毫无问题地关闭，编译器将处理程序退出值。鉴于它是一次性使用脚本，它是可以接受的，但不要部署它。

两者都变成了 11 行，所以无论如何这并不是一个巨大的增加，而 10 行版本将包括一个或另一个，这取决于一个人可能会觉得是两害相权。

它不进行任何错误检查，并且不允许空格 - 再次假设它是一次性程序，那么在运行脚本之前执行搜索/替换并删除空格和其他空格会更快，但是它不应该只需要另外几行来吃空白。

当然，有一些方法可以缩短它，但它们可能会显着降低可读性......

哼。 **只需阅读有关 line length 的评论**，因此这里有一个更新的版本，它有一个更丑的 hextonum 宏，而不是数组：

```
#include <stdio.h>
#define hextonum(x) (((x)<'A')?((x)-'0'):(((x)<'a')?((x)+10-'A'):((x)+10-'a')))
char input[81]="8b1f0008023149f60300f1f375f40c72f77508507676720c560d75f002e5ce000861130200000000";
void main(void){
   int i = 0;
   FILE *fd = fopen("outfile.bin", "wb");
   for(i=0;(input[i] != 0) && (input[i+1] != 0);i+=2)
      fputc(hextonum(input[i]) * 16 + hextonum(input[i+1]), fd);
} 
```

它不是非常不可读，但我知道很多人对三元运算符有疑问，但是宏的适当命名和一些分析应该很容易让普通 C 程序员知道它是如何工作的。由于宏中的副作用，我不得不移至 for 循环，因此我不必为 i+=2 设置另一行（`hextonum(i++)`每次调用时都会将 i 增加 5，宏副作用不适合胆小的人！）。

**此外，输入解析器应该跳过/忽略空格。**

抱怨，抱怨，抱怨。

我不得不添加几行来满足这个要求，现在最多 14 行用于格式合理的版本。它将忽略所有不是十六进制字符的内容：

```
#include <stdio.h>
int hextonum[] = {-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,-1,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1};
char input[]="8b1f 0008 0231 49f6 0300 f1f3 75f4 0c72 f775 0850 7676 720c 560d 75f0 02e5 ce00 0861 1302 0000 0000";
void main(void){
   unsigned char i = 0, nibble = 1, byte = 0;
   FILE *fd = fopen("outfile.bin", "wb");
   for(i=0;input[i] != 0;i++){
      if(hextonum[input[i]] == -1)
         continue;
      byte = (byte << 4) + hextonum[input[i]];
      if((nibble ^= 0x01) == 0x01)
         fputc(byte, fd);
   }
} 
```

我不关心 80 个字符的行长，因为输入甚至不小于 80 个字符，但是一个 3 级三元宏可以替换第一个 256 个条目数组。如果不介意一点“替代格式”，那么以下 10 行版本并非完全不可读：

```
#include <stdio.h>
int hextonum[] = {-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,-1,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1};
char input[]="8b1f 0008 0231 49f6 0300 f1f3 75f4 0c72 f775 0850 7676 720c 560d 75f0 02e5 ce00 0861 1302 0000 0000";
void main(void){
   unsigned char i = 0, nibble = 1, byte = 0;
   FILE *fd = fopen("outfile.bin", "wb");
   for(i=0;input[i] != 0;i++){
      if(hextonum[input[i]] == -1) continue;
      byte = (byte << 4) + hextonum[input[i]];
      if((nibble ^= 0x01) == 0x01) fputc(byte, fd);}} 
```

而且，再一次，进一步的混淆和比特旋转可能会导致一个更短的例子。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-27T22:52:34.263

## Perl

当然，在一条（相当短的）行中：

```
my $bin = map { chr hex } ($hex =~ /\G([0-9a-fA-F]{2})/g); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-28T00:44:54.617

哈斯克尔：

```
import Data.Char
import Numeric
import System.IO
import Foreign

main = hGetContents stdin >>= 
       return.fromHexStr.filter (not.isSpace) >>=  
       mapM_ (writeOneByte stdout)

fromHexStr (a:b:tl) = fromHexDgt [a,b]:fromHexStr tl
fromHexStr [] = []
fromHexDgt str =  case readHex str of 
  [(i,"")] -> fromIntegral (i)
  s -> error$show s

writeOneByte h i = allocaBytes 1 (wob' h i)
wob' :: Handle -> Int8 -> (Ptr Int8) -> IO ()
wob' h i ptr = poke ptr i >> hPutBuf h ptr 1 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-05-18T13:16:46.147

```
. 
```

它是一种叫做“Hex！”的语言。它的唯一用途是从标准输入读取十六进制数据并将其输出到标准输出。十六进制！由一个简单的python脚本解析。导入系统

```
try:
  data = open(sys.argv[1], 'r').read()
except IndexError:
  data = raw_input("hex!> ")
except Exception as e:
  print "Error occurred:",e

if data == ".":
  hex = raw_input()
  print int(hex, 16)
else:
  print "parsing error" 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-27T20:24:40.513

相当可读的 C 解决方案（9 个“真实”行）：

```
#include <stdio.h>
int getNextHexDigit() {
    int v;
    while((v = fgetc(stdin)) < '0' && v != -1) {    /* Until non-whitespace or EOF */
    }
    return v > '9' ? 9 + (v & 0x0F) : v - '0';      /* Extract number from hex digit (ASCII) */
}
int main() {
    int v;
    fputc(v = (getNextHexDigit() << 4) | getNextHexDigit(), stdout);
    return v > 0 ? main(0) : 0;
} 
```

要支持 16 位 little endian，请替换`main`为：

```
int main() {
    int v, q;
    v = (getNextHexDigit() << 4) | getNextHexDigit();
    fputc(q = (getNextHexDigit() << 4) | getNextHexDigit(), stdout);
    fputc(v, stdout);
    return (v | q) > 0 ? main(0) : 0;
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-20T23:49:49.853

一个 31 个字符的 Perl 解决方案：

`s/\W//g,print(pack'H*',$_)for<>`

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-27T20:02:53.140

我无法在脑海中对此进行编码，但是对于每两个字符，输出 (byte)((AsciiValueChar1-(AsciiValueChar1>64?48:55)*16)+(AsciiValueChar1-(AsciiValueChar1>64?48: 55))) 将十六进制字符串更改为原始二进制文件。如果您的输入字符串不是 0 到 9 或 A 到 B 以外的任何值，这将非常糟糕，所以我不能说它对您有多大用处。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-04-27T21:26:06.123

我知道 Jon 已经发布了一个（更干净的）LINQ 解决方案。但是这一次，我能够使用 LINQ 语句在执行期间修改字符串并滥用 LINQ 的延迟评估，而不会被我的同事大喊大叫。:p

```
string hex = "FFA042";
byte[] bytes =
    hex.ToCharArray()
       .Select(c => ('0' <= c && c <= '9') ? 
                         c - '0' :
                         10 + (('a' <= c) ? c - 'a' : c - 'A'))
       .Select(c => (hex = hex.Remove(0, 1)).Length > 0 ? (new int[] {
           c,
           hex.ToCharArray()
                 .Select(c2 => ('0' <= c2 && c2 <= '9') ?
                                    c2 - '0' :
                                    10 + (('a' <= c2) ? c2 - 'a' : c2 - 'A'))
                 .FirstOrDefault() }) : ( new int[] { c } ) )
       .Where(c => (hex.Length % 2) == 1)
       .Select(ca => ((byte)((ca[0] << 4) + ca[1]))).ToArray(); 
```

1 条语句格式化为便于阅读。

**更新**

支持空格和不均匀小数位数（89A 等于 08 9A）

```
byte[] bytes =
    hex.ToCharArray()
       .Where(c => c != ' ')
       .Reverse()
       .Select(c => (char)(c2 | 32) % 39 - 9)
       .Select(c => 
           (hex =
                new string('0', 
                           (2 + (hex.Replace(" ", "").Length % 2)) *
                                hex.Replace(" ", "")[0].CompareTo('0')
                                                       .CompareTo(0)) +
                hex.Replace(" ", "").Remove(hex.Replace(" ", "").Length - 1))
              .Length > 0 ? (new int[] {
                        hex.ToCharArray()
                           .Reverse()
                           .Select(c2 => (char)(c2 | 32) % 39 - 9)
                           .FirstOrDefault(), c }) : new int[] { 0, c } )
                     .Where(c => (hex.Length % 2) == 1)
                     .Select(ca => ((byte)((ca[0] << 4) + ca[1])))
                     .Reverse().ToArray(); 
```

还是一种说法。可以通过在开始时在十六进制字符串上运行 replace(" ", "") 来缩短时间，但这将是第二个语句。

这个有两个有趣的点。如何在没有源字符串本身以外的外部变量帮助的情况下跟踪字符数。在解决这个问题时，我遇到了 char y.CompareTo(x) 只返回“y - x”而 int y.CompareTo(x) 返回 -1、0 或 1 的事实。所以 char y.CompareTo(x).CompareTo(0 ) 等于返回 -1、0 或 1 的 char 比较。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-07-16T11:32:03.217

**PHP** , 28 个符号：

```
<?=pack(I,hexdec($argv[1])); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2011-09-25T12:41:21.597

游戏迟到了，但这里有一些 Python{2,3} 单行代码（100 个字符，需要`import sys, re`）：

```
sys.stdout.write(''.join([chr(int(x,16)) for x in re.findall(r'[A-Fa-f0-9]{2}', sys.stdin.read())])) 
```

# sql - 复合索引是如何工作的？

> ID：795031
> 
> 赞同：79
> 
> 时间：2009-04-27T19:53:56.830
> 
> 标签：sql, indexing, composite

之前我已经在表格上创建了​​复合索引（*为*数学爱好者准备的索引），并假设它们是如何工作的。我只是好奇我的假设是否正确。

我假设当您列出索引的列顺序时，您还指定了索引的分组方式。例如，如果您有列`a`,`b`和,`c`并且您以相同的顺序指定索引 ,`a ASC`则结果索引本质上将是 中每个“组”的许多索引。`b ASC``c ASC``a`

它是否正确？如果不是，那么结果索引实际上会是什么样子？

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2009-04-27T20:05:55.397

复合索引与常规索引一样工作，只是它们具有多值键。

如果您在字段 (a,b,c) 上定义索引，则记录首先按 a 排序，然后是 b，然后是 c。

例子：

```
| A | B | C |
-------------
| 1 | 2 | 3 |
| 1 | 4 | 2 |
| 1 | 4 | 4 |
| 2 | 3 | 5 |
| 2 | 4 | 4 |
| 2 | 4 | 5 | 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-04-27T20:24:17.800

复合索引就像字典中的普通字母索引，但涵盖两个或多个字母，如下所示：

```
AA - page 1
AB - page 12 
```

等等

表行首先按索引中的第一列排序，然后按第二列排序，以此类推。

当您按两列或第一列搜索时，它是可用的。如果你的索引是这样的：

```
AA - page 1
AB - page 12
…
AZ - page 245
BA - page 246
… 
```

您可以使用它来搜索`2`字母（`= 2`表格中的列），或者像一个字母上的普通索引：

```
A - page 1
B - page 246
… 
```

请注意，在字典的情况下，页面本身是按字母顺序排列的。这是一个`CLUSTERED`索引的例子。

在普通的非`CLUSTERED`索引中，对页面的引用是有序的，就像在历史书中一样：

```
Gaul, Alesia: pages 12, 56, 78
Gaul, Augustodonum Aeduorum: page 145
…
Gaul, Vellaunodunum: page 24
Egypt, Alexandria: pages 56, 194, 213, 234, 267 
```

`ORDER BY`当您有两个或更多列时，也可以使用复合索引。在这种情况下，一个`DESC`子句可能会派上用场。

请参阅我的博客中有关`DESC`在复合索引中使用子句的这篇文章：

*   [**降序索引**](http://explainextended.com/2009/04/27/descending-indexes/)

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-04-27T20:11:54.117

最常见的索引实现使用 B 树来允许快速查找，以及相当快速的范围扫描。在这里解释太多了，但这里是关于[B-trees](http://en.wikipedia.org/wiki/B_tree)的 Wikipedia 文章。你是对的，你在创建索引中声明的第一列将是生成的 B 树中的高阶列。

对高位列的搜索相当于范围扫描，而 B 树索引对于此类搜索非常有用。看到这一点的最简单方法是与图书馆中尚未转换为在线目录的旧卡片目录进行类比。

如果您要查找姓氏为“Clemens”的作者的所有卡片，您只需转到作者目录，并很快找到前面写着“CLE-CLI”的抽屉。那是正确的抽屉。现在你在那个抽屉里进行一种非正式的二分搜索，以快速找到上面写着“Clemens, Roger”或“Clemens, Samuel”的所有卡片。

但是假设您要查找名字为“Samuel”的作者的所有卡片。现在你已经上岸了，因为这些卡片并没有聚集在作者目录中的一个地方。数据库中的复合索引也会发生类似的现象。

不同的 DBMS 的优化器在检测索引范围扫描和准确估计其成本方面的聪明程度不同。并非所有索引都是 B 树。您必须阅读特定 DBMS 的文档才能获得真实信息。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-27T19:59:22.323

不，结果索引将是单个索引，但具有复合键。

KeyX = A,B,C,D; KeyY = 1,2,3,4;

索引 KeyX, KeyY 实际上是：A1,A2,A3,B1,B3,C3,C4,D2

因此，如果您需要通过 KeyX**和**KeyY 找到某些东西 - 这将很快并且将使用单个索引。类似于 SELECT ... WHERE KeyX = "B" AND KeyY = 3。

但重要的是要理解： WHERE KeyX = ? 请求**将**使用该索引，而 WHERE KeyY = ? 根本**不会**使用这样的索引。

# c - 有没有办法在其他常量的定义中使用 const 变量？

> ID：795045
> 
> 赞同：4
> 
> 时间：2009-04-27T19:58:57.940
> 
> 标签：c, constants

我想在新常量的定义中使用一些以前定义的常量，但我的 C 编译器不喜欢它：

```
const int a = 1;
const int b = 2;
const int c = a;         // error: initializer element is not constant
const int sum = (a + b); // error: initializer element is not constant 
```

有没有办法使用其他常量的值来定义一个常量？如果不是，这种行为的原因是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-27T20:07:16.937

const vars 不能定义为表达式。

```
#define A (1)
#define B (2)
#define C (A + B)

const int a = A;
const int b = B;
const int c = C; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-27T20:38:00.607

对于整数 const 值，优先使用枚举而不是预处理器宏：

```
enum {
    A = 1,
    B = 2
};

const int a = A;
const int b = B;
const int c = A;        
const int sum = (A + B); 
```

在 C 和 C++ 中工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T20:03:33.997

您只能将文字分配给 const 变量，因此该程序是非法的。我认为您应该使用预处理器。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-27T21:51:58.947

由于结果是恒定的，我同意 Michael Burr 的观点，即枚举是这样做的方法，但除非你需要传递指向常量整数的指针，否则我不会使用“变量”（真的是一个常量变量？）但只是枚举：

```
enum { a = 1 };
enum { b = 2 };
enum { c = a };
enum { sum = a + b }; 
```

# asp.net - asp.net中的双字节数

> ID：795055
> 
> 赞同：1
> 
> 时间：2009-04-27T20:02:41.300
> 
> 标签：asp.net, internationalization

我们正在开发一个具有日语本地化的网站。`asp:label`在该站点中，我们使用和此类控件显示了几个动态字段。

最近，我们被要求使用“双字节字符”来显示数字。

虽然一开始我认为这是客户的困惑，但他在一封电子邮件中给我发了这个：

```
1234567890
１２３４５６７８９０ 
```

这表明我错了，而且确实有“更宽”的数字字符可用。

关于如何使 ASP.NET 动态切换到这些的任何提示？

**更新**：第二个样本似乎被称为“FULLWIDTH”字符。这个问题可以改写为：

当前文化为 JP 时，如何使 ASP.NET 自动显示全宽数字？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T20:21:02.083

显然，unicode 中还有一些其他字符看起来就像“正常”数字，但默认显示更宽。

这是粘贴到记事本中的问题文本，保存为 unicode，并通过 XXD 运行：

```
0000000: fffe 3100 3200 3300 3400 3500 3600 3700  ..1.2.3.4.5.6.7.
0000010: 3800 3900 3000 0d00 0a00 11ff 12ff 13ff  8.9.0...........
0000020: 14ff 15ff 16ff 17ff 18ff 19ff 10ff 0d00  ................
0000030: 0a00 0a                                  ... 
```

看起来“1”是0x0031，“特殊1”是0xff11。如果使用 CSS 显示“正常”数字，但不能选择更宽的字体，我会说你必须获取数字，将其转换为字符串，将 0xff10 添加到 0x0030 和 0x0039 之间的每个字符得到你正在寻找的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T20:16:04.450

您将字体宽度与[DBCS](http://en.wikipedia.org/wiki/DBCS)混淆了。如果您只想要更宽的字体，请使用适当的 CSS。如果你真的想支持 unicode 并使用宽字符，你需要使用适当的数据类型来实现你的后端。

默认情况下，C# 中的所有字符串都是 Unicode。[您可以按照此处](http://msdn.microsoft.com/en-us/library/cc488003.aspx)概述的技术控制编码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T20:51:42.913

这是执行此操作的功能：-

```
 static string IntToWideNumbers(int n)
    {
        char[] chars = n.ToString().ToCharArray();
        for (int i = 0; i < chars.Length; i++)
        {
            chars[i] = (char)((uint)chars[i] ^ 0xFF20);
        }
        return new String(chars);
    } 
```

# .net - VSTO：应用焦点

> ID：795059
> 
> 赞同：6
> 
> 时间：2009-04-27T20:03:26.010
> 
> 标签：.net, vb.net, excel, vsto

任何人都知道查看 VSTO 项目的 Excel 窗口是否处于活动状态/焦点的方法？

我正在寻找相当于`System.Windows.Window.IsActive`.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-28T18:22:57.367

我也对此感到沮丧。您是否在 VSTO 应用程序中使用对话框？如果是这样，我所做的是在 Windows 窗体/对话框的关闭中添加一个事件以激活 Office 应用程序，如下所示（示例是 Word，因此 Excel 中可能存在差异）：

```
//... VSTO Startup Event
WindowsForm form = new WindowsForm();
form.FormClosed += new FormClosedEventHandler(form_FormClosed);
form.Show();

void form_FormClosed(object sender, FormClosedEventArgs e)
{
    this.Application.Activate();         
    this.Application.ActiveWindow.WindowState = Microsoft.Office.Interop.Word.WdWindowState.wdWindowStateNormal;

} 
```

我发现这条线总是谎言/返回真：

```
this.ActiveWindow.Active() 
```

但这效果更好（全局布尔变量“AppActive”来跟踪活动窗口）：

```
//... VSTO Startup Event    
this.Application.WindowDeactivate += new Microsoft.Office.Interop.Word.ApplicationEvents4_WindowDeactivateEventHandler(Application_WindowDeactivate);
this.Application.WindowActivate += new Microsoft.Office.Interop.Word.ApplicationEvents4_WindowActivateEventHandler(Application_WindowActivate);

    void Application_WindowActivate(Microsoft.Office.Interop.Word.Document Doc, Microsoft.Office.Interop.Word.Window Wn)
    {
        AppActive = true;
    }

    void Application_WindowDeactivate(Microsoft.Office.Interop.Word.Document Doc, Microsoft.Office.Interop.Word.Window Wn)
    {
        AppActive = false;
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-03-16T07:27:34.243

`this.ActiveWindow.Activate()`是激活窗口的方法。

`this.ActiveWindow.Active`是告诉您窗口状态的属性。

# c - 为什么 C 的语言设计者会这样做类型等价？

> ID：795064
> 
> 赞同：4
> 
> 时间：2009-04-27T20:04:46.943
> 
> 标签：c, language-design, type-equivalence

我正在学习 C 并且正在阅读关于类型等价的内容。

我很好奇，有没有人有意见，为什么他们对数组和指针使用结构等价，但对结构和联合使用声明等价？

为什么会有差距？使用结构/联合进行声明等效以及对其他所有内容进行结构等效有什么好处？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-27T20:09:36.027

我相信其他人会提供 C 特定的信息，但我会提到类型等价是编程语言理论中的经典主要问题之一。确定两种类型实际上是否等效是一个比看起来要复杂得多的问题。

例如，这里有一些[来自学术课程的概述幻灯片，](http://www.cs.rochester.edu/u/sandhya/csc254/lectures/lecture5.pdf)只是为了让您体验一下头痛。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T20:11:48.160

我敢肯定这是因为它在当时看起来是个好主意。

不要试图过度思考 C. Kernighan 和 Ritchie 的设计，他们正在设计一种可能对其他事情有好处的系统实现语言，并最终做出了他们后来后悔的决定（操作员优先级是最好的文档）。有些问题已经被标准委员会清理了，有些则根深蒂固。

正如 Uri 在他的回答中指出的那样，类型等价是一个难题，因此可能是 K&R 为了尽快获得工作编译器而不是稍后获得干净的语言设计而抨击的问题之一。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-27T20:12:56.313

在很多方面，c 都是 1970 年代汇编语言的简洁表达。这些处理器上的数组是直接使用指针实现的，而 c 只是简单地复制了这个*fact*。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-27T20:21:35.483

结构等价性很难检查。指针和数组非常简单，但结构和联合类型更复杂。在这些复杂类型上测试结构等价是非常困难的，但对于指针和数组来说更容易。

**编辑**

*最初我写了一个处理*值等价*而不是*类型等价的答案，*所以它并不是这个问题的真正答案。不过，我确实收到了一些赞成票，所以我决定留在这里。*

我对 [值等价] 的了解是，指针和数组在内存中总是有一个非常简单的布局。这使得进行简单的逐字节比较变得容易。

对于结构体和联合体，这种内存布局不一定这么简单。例如，您可以拥有一个带有 int（32 位）和 double（64 位）的结构。这样的结构需要 128 位内存，其中 32 位实际上与比较无关。因此，逐字节比较是不可能的。因此，声明等价更容易实现。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-28T02:25:21.693

不要低估丹尼斯·里奇。每种静态类型语言都应该有一种方法来创建用户无法伪造的*抽象类型。*为此，您需要一个可生成的类型构造或声明构造*，*即构造的每个实例都会生成一个新类型，与其他类型不同。如果您想让其他人对您的数据不闻不问，那么这种结构至关重要。（有关大量示例，请参阅 Dave Hanson 的书[C 接口和实现](http://www.cs.princeton.edu/software/cii/)。）

所以这里的值`p1`和`p2`具有不同的类型但相同的表示：

```
struct { float x, y } p1;
struct { float x, y } p2; 
```

为什么选择`struct`生成？因为它足够通用，可以进行广泛的方便表示。 `union`有点牵强，但我怀疑这是“附带设计”；在 C 的类型系统中，`union`行为尽可能多的列表`struct`，这简化了编译器。

顺便说一句，“声明等效”是我以前从未听说过的术语。25 年前，“名称等价”、“结构等价”和“出现等价”等术语很流行。今天的类型系统更加正式，等价通常由逻辑规则而不是非正式的英语定义。当求助于非正式英语有帮助时，我通常发现“生成性”的概念比为每种新语言的等价规则发明一个新名称更具有解释力。

# c# - 有没有办法用 itextsharp 替换 PDF 文件中的文本？

> ID：795066
> 
> 赞同：6
> 
> 时间：2009-04-27T20:05:50.793
> 
> 标签：c#, itextsharp

我正在使用 itextsharp 生成 PDF，但我需要动态更改一些文本。我知道如果有任何 AcroField 可以更改，但我的 PDF 确实有。它只有一些纯文本，我需要更改其中的一些。

有谁知道该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-03-24T15:10:39.307

实际上，我有一篇关于如何做到这一点的博客文章！但就像 IanGilham 所说，这取决于您是否可以控制原始 PDF。基本思想是您在页面上设置一个表单并用您想要的文本替换表单字段。（您可以设置表单的样式，使其看起来不像表单）

如果您无法控制 PDF，请告诉我如何操作！

这是完整帖子的链接：

[使用模板通过 C# 和 iTextSharp 以编程方式创建 PDF](http://johnnycode.com/2010/03/05/using-a-template-to-programmatically-create-pdfs-with-c-and-itextsharp/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T20:55:29.067

我没有使用 itextsharp，但在过去的几周里，我一直在使用[PDFNet SDK](http://www.pdftron.com/)来探索大量 PDF 的内容以进行本地化。

我会说你需要的东西是绝对可以实现的，但它的难度将完全取决于你对文件质量的控制程度。就我而言，这些文件可以由图像、任意随机顺序的文本、表格、表格、路径、单像素图形和扫描页面的任意组合构成，其中一些由数百个较小的图像组成。让我们说我们玩得很开心。

在 PDFTron 的处理方式中，您必须实现一个查看器（可用示例），并在文本选择上添加一些代码。鉴于格式的复杂性，可能需要在辅助对话框中实现一个简单的编辑器，该编辑器能够将选择扩展到下一行（或任何其他用于构成文本的基本对象）。然后可以通过将文档的整个页面复制到新页面中来编辑和应用字符串，用新字符串替换选定的元素。不过，您可能需要做一些数学运算才能使其正常工作，因为 PDF 中的几乎所有内容都通过[仿射变换](http://en.wikipedia.org/wiki/Affine_transform)位于页面上。

祝你好运。我敢肯定这里有些人总体上对 itextsharp 和 PDF 有一定的经验。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2011-12-23T07:32:59.820

这个问题不时出现在[邮件列表中](https://lists.sourceforge.net/lists/listinfo/itext-questions)。一次又一次地给出相同的答案——**不**。[有关创建 iText 的人](http://www.lowagie.com/)的**官方**答案，请参阅[此线程](http://www.mail-archive.com/itext-questions@lists.sourceforge.net/msg58454.html)。

 **这个问题*应该*是[itextsharp 标签 wiki 上的常见问题解答](https://stackoverflow.com/edit-tag-wiki/16611)。

# jquery - 生成 HTML 表格客户端

> ID：795075
> 
> 赞同：1
> 
> 时间：2009-04-27T20:07:47.467
> 
> 标签：jquery, asp.net, auto-generate, generated-code, client-side

（ASP.NET Web 应用程序）我想创建一个允许用户构建 HTML 表的页面。将为用户提供以下控件：用于定义表格中行数的文本框、用于定义表格中列数的文本框以及形状的项目符号列表（例如方形、八角形等） ) 将显示在每个单元格中。

当用户在每个控件中输入一个值时，我想根据现有值构建和显示表格。我想在客户端处理 HTML 表代码的生成。

我有哪些选择？我遇到了[许多我认为可能有用](http://encosia.com/2008/06/26/use-jquery-and-aspnet-ajax-to-build-a-client-side-repeater/) [的](http://www.codeproject.com/KB/scripting/DHTMLGrid.aspx) [文章](http://beta.blogs.microsoft.co.il/blogs/linqed/archive/2009/03/04/generating-html-tables-with-jquery.aspx)，但我无法将所有内容拼凑在一起并收集适用的方法；我在客户端脚本方面几乎没有经验，但是如果它会产生一个干净、有效的解决方案，我不会回避学习曲线（程序员会怎样？）。

您可以提供的任何信息链接将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T20:36:33.013

带有几个嵌套循环的 JQuery 应该很容易做到这一点。您可以使用字符串生成器或其他工具对其进行优化，但基础非常清楚。如果你正在做一些更复杂的事情，你可能会更好地研究 JQuery 或 MS AJAX 的模板引擎之一：

```
 <script type="text/javascript">
     $(function() {
       $('INPUT, SELECT').change(function() {
          var rows = parseInt($('#rows').get(0).value);
          var cols = parseInt($('#cols').get(0).value);
          if (isNaN(rows) || isNaN(cols)) {
              return;
          }
          var shape = $('#shape').get(0).value;
          drawTable(rows, cols, shape);
       });
     });

     function drawTable(rows, cols, shape) {
        $('#results').empty().append("<table></table>");
        var table = $('#results > TABLE');

        for (var row = 0; row < rows; row++) {
           var htmlRow;
           htmlRow = '<tr>';
           for (var col = 0; col < cols; col++) {
              htmlRow += '<td><img src="' + shape + '.gif" alt="' + shape + '" /></td>';
           }
           htmlRow += "</tr>";
           table.append(htmlRow);
        }
     }         
 </script>

 Columns: <input id="cols" type="text" /> <br />
 Rows: <input id="rows" type="text" /> <br />
 Shape: 
     <select id="shape">
        <option value="square">Square</option>
        <option value="circle">Circle</option>
     </select>

 <div id="results">
 </div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T20:13:39.213

我看起来你想做一些非常具体的事情，所以你必须进行自定义构建。我想说看看 JQuery ( [http://jquery.com/](http://jquery.com/) )，这是编写自定义 javascript 的最佳方法之一，而无需花费数小时重新发明轮子。Google上有很多很好的教程。

编辑：有简单的方法来添加元素（您的案例的表格行）并设置它们的属性。如果需要，您也可以使用 AJAX 调用来保存所有这些。

希望有帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T20:18:14.057

如果您真的想在客户端执行此操作，您可以针对 HTML DOM 进行编程以构建表格。创建一个表对象并添加行和列应该没什么大不了的。您可以在 for 循环中使用文本框的值作为控制变量。有关要使用的 DOM 对象，请参阅[W3Schools 教程](http://www.w3schools.com/htmldom/dom_obj_table.asp)。在客户端添加形状应该像在 td 元素中添加图像对象（或 img 标签）一样简单。

我自己没有做过，但是根据您的描述，这听起来像是可以在客户端用 JavaScript 完成的事情，而无需付出大量的努力。也就是说，除非你真的需要在客户端上，否则我肯定会考虑在服务器上进行。

**编辑：** 顺便说一句，我对 jQuery 了解不多。使用该库可能有一种更简单的方法。但是纯JS的方式不应该太毛。

# sql - Reporting Services 参数的默认值问题

> ID：795083
> 
> 赞同：0
> 
> 时间：2009-04-27T20:11:10.767
> 
> 标签：sql, sql-server-2005, reporting-services, parameters, default-value

我有一个包含多个报表参数的 SQL 2005 Reporting Services 报表。其中之一称为 IsActive 并且是布尔类型。该参数被隐藏并设置为允许空值。对于其默认值设置，我将其设置为 null。在具有reportviewer 控件的应用程序中，我有决定是否将此参数设置为值（真或假）的逻辑。有些条件要求根本不设置它。出于某种原因，如果我不传递值，则参数默认为 TRUE。传递值时它运行良好。我的问题是否源于它是布尔参数的简单原因？将其更改为字符串会更好吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-15T15:37:54.350

仅当由于错误或“功能”而无法使其获取 NULL 值时，才需要将其更改为字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-02-24T11:08:34.973

不知道有没有关系...

我遇到了一个问题，在对报告进行更改后从 BIDS 外部查看报告时，我无法获得要选择的默认值。

原来部署报表时参数设置没有更新。

通过报告管理器手动更改设置或删除并重新部署报告可以解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-20T05:00:01.820

IIf(IsNothing(Fields!BooleanField.Value) , "-- Any --" , IIf(Fields!BooleanField.Value = True , "Yes" , "No"))

# .net - 从现有 Crystal Reports 文件中检索缓存数据

> ID：795090
> 
> 赞同：2
> 
> 时间：2009-04-27T20:12:58.093
> 
> 标签：.net, crystal-reports, vbscript

有什么方法可以从以前刷新的报告中检索缓存数据，然后将其转储到文件中？基本上，我正在寻找报告正在使用的数据集，并且将每个字段手动拖动到画布上，甚至导出文件并不能完全让我到达我想要的位置。

我并不特别关注特定的解决方案，无论是 .NET、vbscripting 还是程序本身……我对 Crystal Report 对象模型和 .NET 都不太熟悉，但它似乎有一个像这样的设置“EnableSaveDataWithReport”，应该有一个直截了当的方法。

哦，我在 CR 11 Pro

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-03-26T01:47:08.963

文件菜单选项中有一个设置为“使用报告保存数据”，如果您导出该数据，您将获得报告格式的数据（即某些字段；公式返回结果等）但是它只会在报告对象中本身。如果您导出该数据，您还缺少什么？除非您在某些区域启用了“向下钻取”和“抑制”功能，否则您似乎应该看到这一切。

# c# - 如何以编程方式使用 SVN 和 .NET 进行文件版本控制？

> ID：795096
> 
> 赞同：8
> 
> 时间：2009-04-27T20:14:08.793
> 
> 标签：c#, .net, svn, api, c#-3.0

我们有一个报告生成器。每天，它将其数据写入一个 excel 文件。

出于版本控制和文件数据安全的原因，我们需要更改此文件，并将更改提交到存储库中。

您推荐您使用过的任何 .net SVN API 吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-27T20:36:10.533

你应该看看[SharpSvn](http://sharpsvn.net/) .NET 库。您可能需要签出和提交命令：

签出：

```
string wcPath = "c:\\my working copy";
using (SvnClient client = new SvnClient())
{
    client.CheckOut(new Uri("http://server/path/to/repos"), wcPath);
} 
```

承诺：

```
string wcPath = "c:\\my working copy";
SvnCommitArgs a = new SvnCommitArgs();
a.LogMessage = "My log message";

using (SvnClient client = new SvnClient())
{
    client.Commit(wcPath, a);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T20:26:30.620

我们正在使用在预定义位置实际搜索已安装 TortoiseSVN 并使用它的命令行 api 的工具。如果这适用于 Windows 并且不是为了重新分发 - 它可能更容易做到。

cmd的有用代码：

```
@echo off
if exist "%ProgramW6432%\TortoiseSVN\bin\TortoiseProc.exe" set patht=%ProgramW6432%
if exist "%ProgramFiles%\TortoiseSVN\bin\TortoiseProc.exe" set patht=%ProgramFiles%
if exist "%ProgramFiles(x86)%\TortoiseSVN\bin\TortoiseProc.exe" set patht=%ProgramFiles(x86)%

echo Placing SVN Commit
"%patht%\TortoiseSVN\bin\TortoiseProc.exe" /command:commit /path:"%CD%" /notempfile 
```

如果您仍想从代码中完成该任务 - SharpSVN [http://sharpsvn.open.collab.net](http://sharpsvn.open.collab.net)是更好的选择

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T20:27:29.790

您也许可以为您的存储库打开[自动](http://svnbook.red-bean.com/en/1.2/svn.webdav.autoversioning.html)版本控制。由于它使用 WebDAV，因此您可以将存储库视为网络驱动器（Web 文件夹）。并且您可以将文件视为普通文件，只需打开、修改和保存即可。

如果是我，我会为 excel 数据文件创建一个新的存储库。我不认为我希望我的代码被自动版本化:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T20:25:32.540

最简单的方法是生成一个进程并调用 SVN.exe 来提交您的更改。

这是一个类似的问题。

[有谁知道用于 Subversion 的好的 C# API？](https://stackoverflow.com/questions/481247/does-anyone-know-of-a-good-c-api-for-subversion)

这是另一个资源

[.NET 的 SVN 库？](https://stackoverflow.com/questions/211765/svn-libraries-for-net)

# .net - .NET 命名空间和 using 语句

> ID：795098
> 
> 赞同：14
> 
> 时间：2009-04-27T20:14:45.017
> 
> 标签：.net, namespaces

> **可能重复：**
> [Usings 应该在命名空间内部还是外部](https://stackoverflow.com/questions/125319/should-usings-be-inside-or-outside-the-namespace)

和有什么区别

```
namespace x
{
  using y;
} 
```

和

```
using y;
namespace x
{
} 
```

?

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-27T20:16:01.893

第一个在命名空间 x 的范围内有 y，第二个在整个文件的范围内有 y，因此可能是其他命名空间。如果您为每个文件保留一个名称空间（我猜这是惯例），那么*通常*没有真正的区别[但是如果不同类型在不同名称空间中具有相同名称，请参阅 Marc 关于冲突的评论]。如果您使用 StyleCop，它会希望您将 usings 保留在命名空间内。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-27T20:42:42.140

将`using`语句放在`namespace`块内将其范围限定为该块。这会影响很多事情。

1.  正如[@Steve Haigh](https://stackoverflow.com/questions/795098/net-namespaces-and-using-statements/795100#795100)提到的，该`using`语句仅在块内有效，因此如果有其他`namespace`块，它们不会受到影响。
2.  指定的命名空间`using`可以根据外部`namespace`块缩短。所以`using x.y;`命名空间之外的内容只能表示为块的`using y;`内部`namespace x`。
3.  将命名空间放在`using`内部会导致编译器保证指定的命名空间不会被覆盖。例如：

    ```
     using Guid = System.Guid;
        namespace Sample
        {
            public class Guid {}
            public class Program
            {
                public static void Main()
                {
                    Console.WriteLine(new Guid());
                }
            }
        }
    ```

    上面的代码将编译，但不清楚哪个`Guid`正在被实例化。但是，如果`using`语句位于`namespace`块内，则会引发编译器错误。

有关更完整的讨论，请参阅[相关的 StyleCop 文档。](http://www.thewayithink.co.uk/stylecop/sa1200.htm)

# ruby - 红宝石循环重构

> ID：795102
> 
> 赞同：2
> 
> 时间：2009-04-27T20:16:15.980
> 
> 标签：ruby, arrays, refactoring

我有一个看起来像这样的循环

```
def slow_loop(array)
 array.each_with_index do |item, i|
   next_item = array[i+1]
   if next_item && item.attribute == next_item.attribute
     do_something_with(next_item)
   end
 end
end 
```

除了改变调用 do_something_with 的方式之外，我怎样才能让它表现得更好？

谢谢，

-C

ps

由于看起来这是一个“O(n)”操作，因此这里显然没有性能可取，所以我选择的答案是使用已经封装了该操作的 ruby​​ 方法的答案。谢谢大家的帮助

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T20:28:55.323

正如其他人提到的那样，您不会大大提高性能，但是您可以像这样更干净地做到这一点：

```
array.each_cons(2) do |a, b|
  do_something_with(b) if a == b
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T20:22:06.463

性能`do_something_with`是主要因素。其他任何事情都是微优化。

这应该是 O(n)，你可以想出一种方法来避免最终检查，但在宏伟的计划中这不会那么昂贵。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T20:30:13.667

I tend to agree with Garry on the optimization potential, but it can certainly be written more simply.

```
prev_attr = nil
my_array.each |item|
  do_something_with(item) if prev_attr and prev_attr == item.attribute
  prev_attr = item.attribute
end 
```

# asp.net - 通过gridview问题上传图片

> ID：795106
> 
> 赞同：0
> 
> 时间：2009-04-27T20:17:14.807
> 
> 标签：asp.net, image, gridview, file-upload

我有一个显示来自数据库的数据的网格视图。数据库存储项目的图像文件名（字符串）以及其他内容。

我在 EDIT 视图中显示了 fileupload 控件，并且可以很好地上传文件。

问题是，我想更新数据库中的图像文件名，但我不确定如何将数据获取到 gridview 用于更新数据库的文本框控件。文本框控件我已将可见性设置为隐藏。这是aspx代码：

```
 <asp:TemplateField HeaderText="Image" SortExpression="Image">
                <EditItemTemplate>
                    <asp:TextBox ID="txtImage" runat="server" Text='<%# Bind("Image") %>' Visible="False" OnTextChanged="txtImage_TextChanged"></asp:TextBox>
                    <asp:FileUpload ID="FileUpload1" runat="server" />
                </EditItemTemplate>
                <ItemTemplate>                        
                    <asp:Image ID="Image1" runat="server" Width="50px" AlternateText='<%# Eval("Image") %>' ImageUrl='<%# "images/hardware/" + Eval("Image") %>' />
                </ItemTemplate>
            </asp:TemplateField> 
```

这是将文件存储到服务器上并将文件名放入变量的函数：

```
 protected void GridView1_RowUpdating(object sender, GridViewUpdateEventArgs e)
    {
        GridViewRow row = GridView1.Rows[e.RowIndex];
        FileUpload fileUpload = row.Cells[0].FindControl("FileUpload1") as FileUpload;
         if ( fileUpload != null && fileUpload.HasFile)
         {
             strFileName = fileUpload.FileName;
             fileUpload.SaveAs(Server.MapPath("images/hardware/" + strFileName));
             TextBox txtImage = row.Cells[0].FindControl("txtImage") as TextBox;
             txtImage.Text = strFileName;
         }
    } 
```

那么我从这里去哪里呢？我认为更新已经发生还是什么？因为“txtImage.Text”没有更新数据库……我是不是在这里出了问题？我可以在此函数的文本框中操作值，然后再将其保存到数据库中，对吗？感谢您对此的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T21:21:46.227

如果您在后面的代码中处理更新数据库，您应该能够像在 GridView1_RowUpdating 中一样获取文件名。只需在网格中找到处于编辑模式的行。网格上的行集合中的每一行都有一个 RowState 属性...您正在寻找 DataControlRowState.Edit

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T21:21:58.723

我想我有一个解决方案，但想知道这是否是一种编码的好方法。我将此设置作为gridview使用的数据集的“更新”事件：

```
 protected void SetRecords(object sender, SqlDataSourceCommandEventArgs e)
    {
        if (strFileName != "")
        {
            e.Command.Parameters["@Image"].Value = strFileName;
        }
    } 
```

这个可以吗？一切似乎都很好......但这是解决问题的好方法吗？我想正确编码，而不是从一开始就开始糟糕的编码实践（我是一名成功的经典 ASP 开发人员，转向 C# 和 ASP.NET）谢谢大家！

# c# - C# 中的抽象显式接口实现

> ID：795108
> 
> 赞同：32
> 
> 时间：2009-04-27T20:17:40.827
> 
> 标签：c#, interface, abstract-class

我有这个 C# 代码：

```
abstract class MyList : IEnumerable<T>
{
    public abstract IEnumerator<T> GetEnumerator();

    //abstract IEnumerator IEnumerable.GetEnumerator();
} 
```

照原样，我得到：

> “类型”未实现接口成员“System.Collections.IEnumerable.GetEnumerator()”。

删除评论，我得到：

> 修饰符“抽象”对此项目无效

如何制作明确的实现抽象

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-04-27T20:21:51.567

有趣 - 我不确定你能做到。但是，如果这是您的真实代码，您是否想通过调用泛型以外的*任何*`GetEnumerator()`方式实现非泛型？

 *我会这样做：

```
abstract class MyList<T> : IEnumerable<T>
{
    public abstract IEnumerator<T> GetEnumerator();

    IEnumerator IEnumerable.GetEnumerator() 
    {
        return GetEnumerator();
    }
} 
```

这使您免于在每个派生类中实现它的繁琐——毫无疑问，这将使用相同的实现。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2011-05-29T20:40:28.200

虽然显式接口成员可能不是抽象（或虚拟）成员，但它可以根据抽象（或虚拟）成员[¹](http://msdn.microsoft.com/en-us/library/aa664593%28v=vs.71%29.aspx)来实现：

```
public abstract class Foo: IEnumerable {
    IEnumerator IEnumerable.GetEnumerator() { 
        return getEnumerator();    
    }

    protected abstract IEnumerator getEnumerator(); 
}

public class Foo<T>: Foo, IEnumerable<T> {
    private IEnumerable<T> ie;
    public Foo(IEnumerable<T> ie) {
        this.ie = ie;
    }

    public IEnumerator<T> GetEnumerator() {
        return ie.GetEnumerator();
    }

    protected override IEnumerator getEnumerator() {
        return GetEnumerator();
    }

    //explicit IEnumerable.GetEnumerator() is "inherited"
} 
```

我发现在强类型的 ASP.NET MVC 3 部分视图中需要这样做，它不支持泛型类型定义模型（据我所知）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-05-30T16:38:56.683

您实际上可以通过强制派生自抽象类的类来实现接口，并仍然允许它选择如何实现该接口 - 隐式或显式：

```
namespace Test
{
    public interface IBase<T>
    {
        void Foo();
    }

    public abstract class BaseClass<T> 
        where T : IBase<T>  // Forcing T to derive from IBase<T>
    { }

    public class Sample : BaseClass<Sample>, IBase<Sample>
    {
        void IBase<Sample>.Foo() { }
    }

    class Program
    {
        static void Main(string[] args)
        {
            Sample sample = new Sample();

            // Error CS1061  'Sample' does not contain a definition for 'Foo' 
            // and no extension method 'Foo' accepting a first argument of type 'Sample' 
            // could be found(are you missing a using directive or an assembly reference ?)
            sample.Foo();

            (sample as IBase<Sample>).Foo(); // No Error
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-17T17:47:43.567

我有一个稍微复杂的案例，我想要一个基类显式地实现非泛型接口，而派生类实现泛型接口。

接口：

```
public interface IIdentifiable<TKey> : IIdentifiable
{
    TKey Id { get; }
}

public interface IIdentifiable
{
    object Id { get; }
} 
```

我通过在基类中声明一个抽象 getter 方法并让显式实现调用它来解决它：

```
public abstract class ModelBase : IIdentifiable
{
    object IIdentifiable.Id
    {
        get { return GetId();  }
    }

    protected abstract object GetId();
}

public class Product : ModelBase, IIdentifiable<int>
{
    public int ProductID { get; set; }

    public int Id
    {
        get { return ProductID; }
    }

    protected override object GetId()
    {
        return Id;
    }
} 
```

请注意，基类没有`Id`它可以调用的类型化版本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-18T02:06:14.760

似乎不可能做一个抽象的显式接口实现，但你可以做一个解决方法来摆脱错误，但仍然强制使用隐式的显式接口实现：

```
abstract class MyList : IEnumerable<T>
{
    public virtual IEnumerator<T> GetEnumerator() {
        (this as IEnumerable).GetEnumerator();
    }
} 
```

但是，正如对上述问题的评论所指出的：

> 如果您选择让成员非抽象，编译器将允许没有（自己的）实现的子类......

# reporting-services - 参数缺少值

> ID：795110
> 
> 赞同：1
> 
> 时间：2009-04-27T20:18:08.330
> 
> 标签：reporting-services

我是报告服务的新手，我正在编写一份报告服务 2005 报告，用作我们组织的基本报告模板。我正在尝试将上次在报表服务器上修改报表的日期放入报表的页眉中。但是，当我尝试这样做时，我不断收到“ParamX”参数缺少值错误这就是我所做的：

使用默认值 Globals!ReportName 设置参数 ReportName。它也是隐藏的和内部的。

如果报表不在报表服务器上，则设置一个调用存储过程的数据集 ReportHeader，该存储过程返回报表上次更新的日期或另一个日期。它有一个分配给 Parameter!ReportName.Value 的参数 @ReportName。数据集在 BI 工具的数据集选项卡上运行时返回值。

根据数据集 ReportHeader 并选择 ModDate 列，设置具有默认值 Query From 的参数 ReportVersion。它是报告参数列表中的最后一个参数。

我为参数分配了一个文本框。

当我预览时，我得到“'ReportVersion'参数缺少一个值，无论我将它放在报告正文还是页眉（这是我想要的位置）中。我已经删除并再次添加了参数，玩弄了隐藏和内部设置就可以了。

这个错误的真正含义是什么，我缺少什么，我什至可以用参数来做到这一点吗？

提前致谢

吉姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T20:25:15.177

如果我理解你在做什么，听起来你想使用一个你正在实现参数的字段......

您正在从数据源返回 ModDate，对吗？如果您这样做，您可以简单地在其中放置一个文本框，然后使用如下内容：=Fields!modDate.Value 来显示它。

参数是进入查询的值，字段是它返回的内容。

希望这可以帮助...

编辑:: 好的，那么您是否尝试从报告服务器数据库中检索 mod-date 列值？如果这就是我们所说的，您需要在报告中添加一些内容。将数据源添加到报表数据库、包含日期的数据集（以下查询）、链接到数据集的报表中的列表对象以及所述列表对象中的文本框以显示该字段。如果您使用如下查询访问报表服务器：

```
SELECT MAX(ModifiedDate) AS ModDate FROM catalog WHERE name='myReportName' 
```

这将从 ReportSERvices 数据库中返回您的 modifieddate 作为您可以使用的字段。

# javascript - 如何使用 Javascript 设置动态字符串值？

> ID：795122
> 
> 赞同：0
> 
> 时间：2009-04-27T20:21:21.600
> 
> 标签：javascript, webkit, css, transform

我有这段代码，但因为我使用“”，`a.innerheight`所以不会被它的值取代。是否有可能使这种动态化？

```
a.style.webkitTransform = "translate(0,a.innerHeight)" 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-27T20:34:18.463

我不确定你在问什么……这可能吗？

```
a.style.webkitTransform = "translate(0," + a.innerHeight + ")"; 
```

# obfuscation - C++ Win/OSX 应用程序的混淆和逆向工程威慑

> ID：795129
> 
> 赞同：2
> 
> 时间：2009-04-27T20:22:07.837
> 
> 标签：obfuscation, reverse-engineering

我有一个在 Windows 和 OSX 上发布的 C++ 应用程序。它使用 TCP（使用 OpenSSL 加密，natch）与我们的后端通信。我想为那些试图逆向工程协议和/或反汇编可执行文件的人抛出一些减速带。

Skype 在这方面做得很好，这就是为什么你找不到很多使用 Skype 的应用程序的原因。这是一个关于它的作用的非常好的阅读：[http ://www.secdev.org/conf/skype_BHEU06.handout.pdf](http://www.secdev.org/conf/skype_BHEU06.handout.pdf)

我想要一些关于如何在我们的应用程序中完成类似事情的想法。是否存在使代码更难进行静态分析的商业产品？投入时间来完成我列出的目标的最佳方式是什么？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T20:50:08.800

对 OSX 的一些简单建议：

*   防止 gdb 附加到您的程序 [http://www.steike.com/code/debugging-itunes-with-gdb/](http://www.steike.com/code/debugging-itunes-with-gdb/) （这可以解决，但会让一些随意的探索者远离）

*   至少将产品中的一些代码存储在可执行文件的文本段之外，例如数据或外部（加密）共享库中。

*   不以纯文本形式存储任何敏感字符串数据，从而最大限度地保护它。对您的可执行文件运行“字符串”，如果您看到任何可能对试图找出协议的人有所帮助的内容，请对其进行加密。

*   GCC 的 -fomit-frame-pointer 选项会使调试更加痛苦（但可能会与 C++ 异常进行不良交互）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-07T15:49:13.143

如果我没记错的话，Skype 正在使用与以下描述的“代码卫士”类似的东西（也许他们付钱让他们在 Skype 中实现它，谁知道）：

[https://www.cerias.purdue.edu/tools_and_resources/bibtex_archive/archive/2001-49.pdf](https://www.cerias.purdue.edu/tools_and_resources/bibtex_archive/archive/2001-49.pdf)

# php - PHP 如何判断用户是否按下了 Enter 键或 Submit 按钮？

> ID：795132
> 
> 赞同：4
> 
> 时间：2009-04-27T20:23:36.447
> 
> 标签：php, forms, submit, form-submit

我遇到的问题是我在一个表单中有多个提交输入。这些提交输入中的每一个都有不同的值，我更愿意将它们保留为提交。

每当用户按下`Enter`时，就好像按下了最上面的提交输入，因此它会导致代码检查哪个输入被单击了问题。

PHP有没有办法确定输入是否被单击，或者只是用户按下`Enter`键时选择的输入？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-27T20:29:11.347

只要您正确构建 HTML，您就可以确定使用了哪个按钮

```
<input type="submit" name="action" value="Edit">
<input type="submit" name="action" value="Preview">
<input type="submit" name="action" value="Post"> 
```

`$_POST`数组（或）将`$_GET/$_REQUEST`包含键“action”和已执行按钮的值（无论是否单击）。

现在，“点击”显然是一种客户端行为——如果您想区分点击和按键，您需要在表单中添加一些脚本来帮助确定。

## 编辑

或者，您可以“偷偷摸摸”并使用隐藏的提交，该提交应正确识别提交的按键，但这可能会对可访问性产生重大影响。

```
<?php

if ( 'POST' == $_SERVER['REQUEST_METHOD'] )
{
    echo '<pre>';
    print_r( $_POST );
    echo '</pre>';
}

?>
<form method="post">

    <input type="text" name="test" value="Hello World">

    <input type="submit" name="action" value="None" style="display: none">
    <input type="submit" name="action" value="Edit">
    <input type="submit" name="action" value="Preview">
    <input type="submit" name="action" value="Post">

</form> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-27T20:27:41.647

罗伯托，

PHP 是服务器端技术，因此在服务器上运行 - 因此它无法确定在客户端（也就是用户）按下了哪些键。也就是说，当然，除非您专门对客户端进行编码以在服务器请求中包含此类信息（发布表单数据也是一种请求形式）。

实现这一目标的一种方法是在您的客户端代码中使用 Javascript。

请参阅此页面作为有关使用 Javascript 处理表单提交事件的起点。 [http://www.w3schools.com/jsref/jsref_onSubmit.asp](http://www.w3schools.com/jsref/jsref_onSubmit.asp)

您可能还必须为页面上的按键事件添加侦听器，以便捕获用户按下 Enter 键，然后记录此信息。 [http://www.howtocreate.co.uk/tutorials/javascript/domevents](http://www.howtocreate.co.uk/tutorials/javascript/domevents)讨论了在 Javascript 中添加/删除事件侦听器的主题，但是在使用事件时必须非常小心，因为使用不当它们可能是难以调试并导致用户不满意的内存泄漏:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T20:30:24.527

单独的 PHP 无法确定表单提交事件是如何触发的，因为这发生在客户端，而 PHP 是一种服务器端语言。您必须实现 Javascript 来监听 - 并记录到服务器端 - 按键和鼠标点击，然后分析这些数据以找到您正在寻找的内容。

现在，PHP 可以判断*哪个*提交输入被触发了，因为它会出现在表单数据中，而其他的则不会。大多数浏览器将第一个提交输入设置为默认值（按*Enter*键触发的输入）。您可以重新排序所有提交，以控制触发哪个提交。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T20:34:48.120

PHP 无法真正知道客户端发生了什么。

我建议使用 javascript。当用户执行操作时，将其捕获并将其存储在将与表单一起提交的隐藏字段中。您还可以跟踪哪些输入处于活动状态并将其存储在隐藏字段中。

代码会有点像那样（我没有检查语法）

```
<input type="text" onfocus="setCurrent(this)" id="1" />
<input type="hidden" id="hid" />

function setCurrent(o){
  $('hid').value = o.id;
} 
```

我认为玩事件捕获和隐藏字段应该会给你想要的结果。

希望有帮助

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-27T20:38:18.640

这是您在客户端编写标记的方式。

例如，这是您可以执行此操作的一种（非 XHTML）方式：

在 HTML 文件中：

```
<form method="post" action="myform.php" id="myform">
  ... form items here ...

<input type="submit" name="enter_key" value="true" style="display:none">
<input type="hidden" name="pressed_button" id="pressed_button" value="false">
<input type="button" value="Submit"
  onclick="document.getElementById('pressed_button').value='true';document.getElementById('myform').submit();">
</form> 
```

在 myform.php 中：

```
if ($_POST['pressed_button']=='false') {
   // Logic for enter key
} else {
   // Logic for button press
} 
```

# flash - 嵌入 Flash 影片以符合 XHTML 的正确方法是什么？

> ID：795134
> 
> 赞同：0
> 
> 时间：2009-04-27T20:23:58.037
> 
> 标签：flash, xhtml, adobe, actionscript-2, embed

我有一部简单的电影，其中包含一点 Actionscript 2.0。

1.  嵌入 Flash 影片以符合 XHTML 的最佳方式是什么？
2.  我应该导出哪个版本？

Flash 自动输出的代码太臃肿了，我不确定我需要什么。另外，我注意到代码中有一个 Macromedia URL，现在 Adob​​e 拥有 Flash，我想知道这是否是一个错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T20:26:38.420

在 HTML 中嵌入 Flash 文件的最佳方法是使用 Google 的 swfobject：[http ://code.google.com/p/swfobject/](http://code.google.com/p/swfobject/)

最后它是这样的：

```
<script type="text/javascript">

var flashvars = {
  name1: "hello",
  name2: "world",
  name3: "foobar"
};
var params = {
  menu: "false"
};
var attributes = {
  id: "myDynamicContent",
  name: "myDynamicContent"
};

swfobject.embedSWF("myContent.swf", "myContent", "300", "120", "9.0.0","expressInstall.swf", flashvars, params, attributes);

</script> 
```

希望有帮助

# ruby-on-rails - validates_presence_of 无法正常工作...如何调试？

> ID：795135
> 
> 赞同：1
> 
> 时间：2009-04-27T20:24:12.340
> 
> 标签：ruby-on-rails, validation

在我的 Review 模型中，我有以下内容：

```
class Review < ActiveRecord::Base
  belongs_to :vendor
  belongs_to :user
  has_many :votes  

  validates_presence_of :summary
end 
```

我在 URL 中提交如下新条目：

```
vendors/9/reviews/new 
```

new.html.erb 包含如下形式：

```
<%= error_messages_for 'review' %>

<h1>New review for <%= link_to @vendor.name, @vendor%></h1>

<% form_for(@review, :url =>vendor_reviews_path(@vendor.id)) do |f| %>
  <%= f.error_messages %>

  <p>
    <%= f.label :summary %><br />
    <%= f.text_area :summary, :rows=>'3', :class=>'input_summary' %>

    <%= f.hidden_field :vendor_id, :value => @vendor.id %>
  </p>
  <p>
    <%= f.submit 'Submit Review' %>
  </p>
<% end %> 
```

当我将 :summary 的字段留空时，我收到一个错误，而不是验证消息：

当你没想到时，你有一个 nil 对象！评估 nil.name 时发生错误

提取的源代码（在第 3 行附近）：

```
1: <%= error_messages_for 'review' %>
2: 
3: <h1>New review for <%= link_to @vendor.name, @vendor%></h1> 
```

我不明白发生了什么，如果填充了 :summary 就可以了

```
 def new
    @review = Review.new
    @vendor = Vendor.find(params[:vendor_id])
    @review = @vendor.reviews.build

    respond_to do |format|
      format.html # new.html.erb
      format.xml  { render :xml => @review }
    end
  end

def create
    @review = Review.new(params[:review])

    #@vendor = Vendor.find(params[:vendor_id]) #instantiate the vendor from the URL id -- NOT WOKRING
    #@review = @vendor.reviews.build #build a review with vendor_id -- NOT working
    @review = @current_user.reviews.build params[:review]#build a review with the current_user id

    respond_to do |format|
      if @review.save
        flash[:notice] = 'Review was successfully created.'
        format.html { redirect_to review_path(@review) }
        format.xml  { render :xml => @review, :status => :created, :location => @review }
      else
        format.html { redirect_to new_review_path(@review) }
        format.xml  { render :xml => @review.errors, :status => :unprocessable_entity }
      end
    end
  end 
```

我的*猜测*是，当它失败时，它会失败`redirect_to new_review_path(@review)`，因此不知道它的供应商。我怎样才能重定向到`vendor/:vendor_id/reviews/new`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T20:30:36.600

`new`您的和`create`操作中有什么代码`ReviewsController`？

我怀疑您的 new`Review`验证失败，因为该`summary`字段为空白，然后在验证失败时重新显示表单时，`@vendor`实例变量为`nil`.

您需要确保`@vendor`为两个代码路径都分配了一个值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T09:58:23.257

您可能没有设置 @vendor 成员变量 - 但要解决此问题，不直接使用 @vendor 而是通过您的 @review 变量实例使用会更正确。

如果您正在创建新评论，则您已经创建了 @review 成员变量，并且您只是在其中填充字段 - 因此，您需要为 @review 设置供应商（除非它是可选的）......它会更正确改用@review.vendor.name。

（如果 vendor 是可选的，那么您显然必须捕获所有 vendor.nil? 案例。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T13:52:18.940

我认为你需要`render :action => 'new'`代替你的`redirect_to new_review_path(@review)`. 这会将您的 error_messages 保留在 @review 对象上。通过重定向，您将丢失旧对象并创建一个新对象。

正如其他人所说，您还需要确保在渲染视图之前在 create 方法中重新填充 @vender 变量。

PS。我喜欢使用[ardes resources_controller 插件](http://github.com/econsultancy/resources_controller/tree/master)来实现像这样的沼泽标准控制器操作，这让*我*的生活变得更轻松，并且它可以很好地处理嵌套资源。

# oop - 什么是“场”？“字段”与“字段值”

> ID：795146
> 
> 赞同：0
> 
> 时间：2009-04-27T20:26:05.957
> 
> 标签：oop

在护照中有一个字段：**First Name**，该字段的值为**John**。

我断言将关系描述如下是正确的：

字段**名**：

1.  有一个名字（名字）。
2.  具有一组有效值（例如，由正则表达式 [A-Za-z. ]{1,30} 定义
3.  有描述（在人的全名中排在第一位的名字）

Passport是一**组**对（字段：字段值），例如：

*   护照有一个字段“名字”
*   护照**具有**字段“名字”**的**值

这里的重点是说： “First Name value is John” 是**不正确的；**

**正确**的方法（概念上/学术上）是说：
“护照的字段'名字'的值为'约翰'”。

实际上，它意味着（伪 C#）：

```
struct Passport {
    Map<Field, object> fieldValues;
}

struct Field {
    string Name;
    string Description; 
    bool IsValidValue(object value);
} 
```

**问：**这有意义吗？有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T20:38:09.157

这是非常主观的并且完全是上下文敏感的，而且似乎是一件很愚蠢的事情。

正确与否，如果我正在与同事讨论“护照”，如果他们每次我说“名字是 'john'”时都纠正我，并告诉我说它是“护照的”，我会向他们扔东西名字字段是“约翰””。你只会觉得很烦人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-06T18:27:08.740

如果你要对这样的东西建模，那么你可以看看 java 或 c# 的反射 API。和你描述的差不多。类有一组字段，字段有名称、类型和其他属性，而不是值。Object 是类的实例，您可以向 object 询问指定字段的值。同一类的不同对象具有相同字段的值，因此您可以说它们共享字段。因此，如果您尝试对基于类的 OOP 进行建模，那么您可能是对的。

然而，这不是进行 OOP 的唯一方法。基于原型的 OOP 看起来不同，因为没有类，只有对象，所以对象包含带值的字段，因此如果您说对象包含字段并且字段具有值，则没有太大区别。

所以回答“这有意义吗？” 我认为是“是”，因为类似的东西在反思中并被广泛使用。它是对还是错 - 取决于您的需求。

UPD：关于“value = Passport [Field]”与“value = Passport.Field.Value”，我会再介绍一本护照以说明问题

```
firstNameField = PassportClass.Fields["FirstName"]
myName   =   myPassport[firstNameField]
yourName = yourPassport[firstNameField] 
```

假设两个护照具有相同的字段，这是有道理的。拥有不同领域的不同护照可能有一种感觉，只是不同的护照。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-06T18:50:12.770

好吧..不是真的在 c# 中，请参阅[Scott Bellware 对我关于 C# not being Object Oriented (kinda) 的问题的回答](https://stackoverflow.com/questions/52092/why-the-claim-that-c-guys-dont-get-object-oriented-programming-vs-class-orien/792775#792775)。

在 C# 中，passport 是一个类，所以说起来很有意义

1.  “护照有一个字段 FirstName”
2.  对于特定实例，“FirstName 值为 John”。

这里第一个子句描述类，下一个子句描述对象。在像 ruby​​ 这样更面向对象的语言中，我认为说“passport has a value 'John' for field 'First Name'”是等价的，你只是在描述两个对象 - Passport 原型和它在同一个句子中的实例.

不过，我自己对此感到很困惑。这个问题的措辞很奇怪，因为护照无疑不仅仅是它的领域，例如长期存在的身份。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-27T21:06:28.917

不，至少在 OOP 中，保留值是该字段的责任。尽管对象负责确保值与其他字段或对象的约束一致，但实际“包含值”是字段的工作。

使用您的示例：

**字段名：**

*   有一个名字（名字）。
*   有一个**类型**（int、string、object）
*   有描述（可选）
*   **有价值**_

 **Passport**是**一组**字段**：

*   可以在模型定义的此类字段上定义**约束**，确保值和对象的整体状态有效

# xml - 访问数据库数据交换

> ID：795147
> 
> 赞同：0
> 
> 时间：2009-04-27T20:26:17.593
> 
> 标签：xml, ms-access

我目前正在 MS Access 2003 中构建或多或少的调查应用程序。我希望数据访问是分散的 - 用户正在操作本地数据，而不是集中存储的数据。

用户需要能够将调查的某些子集发送给另一个用户以填写并返回。

用户还需要能够将调查（作为文件）发布到服务器。

我应该传递 MDB 文件吗？XML？还有什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T23:21:28.903

这取决于您如何看待这项工作。以编程方式链接 mdb 中的表很容易，并且可以通过电子邮件发送压缩的 mdb，通常很容易从 Access 更新主数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T00:32:19.250

如果我理解正确，并且每个用户都安装了访问权限，那么传递 MDB 将与我能想到的任何其他选项一样合理。它的运行原理可能与让人们传递 Excel 电子表格的原理相同。

# c# - 如何在运行时获取子控件的原始标记

> ID：795157
> 
> 赞同：0
> 
> 时间：2009-04-27T20:29:08.023
> 
> 标签：c#, asp.net, controls

我正在尝试使用以下库创建一个用于显示格式化代码的 ASP.net 服务器控件：http: [//www.manoli.net/csharpformat/](http://www.manoli.net/csharpformat/)

诀窍是：我希望能够表达这样的代码块......

```
<custom:CodeFormatter runat="server">
<asp:Label runat="server" ID="something" Text="my text" />
<asp:Image runat="server" ID="something" ImageUrl="header.jpg" />
</custom:CodeFormatter> 
```

...但没有实际执行内部标签。我希望 CodeFormatter 将标签和图像视为原始文本，而不是解析为真正的服务器标签。

所以我的问题是，如何防止标签实际呈现为这样？以及如何将 custom:CodeFormatter 中的所有内容作为原始文本访问？

我现在的解决方法是将 <> 编码为 < 和>。我不想那样做。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T21:02:33.560

如何扩展您的控件以使用 ITemplate。这是一篇解释如何扩展控件的文章。

[http://www.devx.com/codemag/Article/32182](http://www.devx.com/codemag/Article/32182)

# java - Java 永远不会通过引用传递，对吗？...对吗？

> ID：795160
> 
> 赞同：53
> 
> 时间：2009-04-27T20:29:41.407
> 
> 标签：java, pass-by-reference, pass-by-value

> **可能的重复：**
> [Java 是“按引用传递”吗？](https://stackoverflow.com/questions/40480/is-java-pass-by-reference)

今天发现了一个不寻常的Java方法：

```
private void addShortenedName(ArrayList<String> voiceSetList, String vsName)
{
     if (null == vsName)
       vsName = "";
     else
       vsName = vsName.trim();
     String shortenedVoiceSetName = vsName.substring(0, Math.min(8, vsName.length()));
     //SCR10638 - Prevent export of empty rows.
     if (shortenedVoiceSetName.length() > 0)
     {
       if (!voiceSetList.contains("#" + shortenedVoiceSetName))
         voiceSetList.add("#" + shortenedVoiceSetName);
     }
} 
```

根据我所读到的有关 Java 传递变量、复杂对象与否的行为的所有内容，这段代码应该什么都不做。所以嗯......我在这里错过了什么吗？我是否遗漏了一些微妙之处，或者这段代码是否属于 thedailywtf？

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2009-04-27T20:36:51.593

正如 Rytmis 所说，Java 按值传递引用。这意味着您可以合法地在方法的参数上调用变异方法，但您不能重新分配它们并期望值传播。

例子：

```
private void goodChangeDog(Dog dog) {
    dog.setColor(Color.BLACK); // works as expected!
}
private void badChangeDog(Dog dog) {
    dog = new StBernard(); // compiles, but has no effect outside the method
} 
```

**编辑：**在这种情况下，这意味着虽然`voiceSetList` *可能会*因这种方法而改变（它可能会添加一个新元素），但`vsName`在方法之外不会看到改变。为了防止混淆，我经常标记我的方法参数`final`，以防止它们在方法内被重新分配（无论是否意外）。这将使第二个示例根本无法编译。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-04-27T20:32:25.067

Java 通过*value 传递引用*，因此您获得了引用的副本，但引用的对象是相同的。因此，此方法确实会修改输入列表。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-11-03T14:46:13.510

引用本身是按值传递的。

摘自 Java How to Program，Deitel & Deitel 的第 4 版：（第 329 页）

> 与其他语言不同，Java 不允许程序员选择是通过值还是通过引用传递每个参数。原始数据类型变量始终按值传递。对象不传递给方法；相反，对对象的引用被传递给方法。引用本身是按值传递的——引用的副本被传递给方法。当方法接收到对象的引用时，该方法可以直接操作该对象。

大学学习Java的时候用过这本书。精彩参考。

这是一篇很好的文章来解释它。 [http://www.javaworld.com/javaworld/javaqa/2000-05/03-qa-0526-pass.html](http://www.javaworld.com/javaworld/javaqa/2000-05/03-qa-0526-pass.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-27T20:33:16.157

好吧，它可以操纵`ArrayList`- 这是一个对象...如果您传递对象引用（甚至通过值传递），对该对象的更改将反映给调用者。是这个问题吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-27T20:51:02.200

我认为您很困惑，因为 vsName 已修改。但在这种情况下，它只是一个局部变量，与shortenedVoiceSetName 处于完全相同的级别。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2012-10-20T12:34:50.547

我不清楚代码中的确切问题是什么。Java 是按值传递的，但数组是按引用传递的，因为它们不传递对象而只传递指针！数组由指针组成，而不是真实对象。这使它们非常快，但也使它们难以处理。要解决这个问题，您需要克隆它们以获取副本，即使这样它也只会克隆数组的第一个维度。

有关更多详细信息，请参见我的回答：[在 Java 中，什么是浅拷贝？](https://stackoverflow.com/questions/1175620/in-java-what-is-a-shallow-copy/12986375)（另见我的其他答案）

顺便说一句，数组只是指针有一些优点：您可以（ab）将它们用作同步对象！

# css - IE 不清除后续浮动

> ID：795161
> 
> 赞同：3
> 
> 时间：2009-04-27T20:29:55.743
> 
> 标签：css, internet-explorer, css-float

我试图让两个 div 浮动到页面的两侧，文本在它们之间流动。第二个（左对齐）div 的顶部应该与第一个（右对齐）div 的底部齐平。下面的代码在 FF、Chrome、Opera 等中运行良好，但在 IE 中无法正确清除。两个 div 都出现在文本的顶部。

如果我在文本中将左对齐的 div 移动到足够低的位置，它在 IE 中可以正常工作，但这并不是一个真正可持续的解决方案。

我在 IE CSS float bugs 上找到了多个页面，但我没有找到任何直接与此相关的内容。

**CSS**

```
div {
    width: 200px;
    margin-top: 10px;
    border-style: solid;
    border-width: 1px;
    position: relative;
}
.wrapper {
    width: 600px;
    border-color: #FF0000;
}
.right {
    float: right;
    border-color: #00FF00;
}
.left {
    float: left;
    clear: both;
    border-color: #0000FF;
} 
```

**HTML：**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" 
"http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<link rel="stylesheet" href="float.css" />
</head>
<body>
<div class="wrapper">
    <div class="right">
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. 
        Nulla pretium tempor leo. Vivamus mi risus, dapibus ac, 
        consectetur quis, pellentesque eget, sem.
    </div>
    <div class="left">
            Proin malesuada. Ut vel lorem. Cras rhoncus nisl accumsan 
            turpis tristique consequat. Sed lacinia ligula at nibh. 
            Morbi in quam. Morbi commodo nibh.
    </div>
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. 
    Nulla pretium tempor leo. Vivamus mi risus, 
    dapibus ac, consectetur quis, pellentesque eget, sem. 
    Maecenas est dui, imperdiet nec, fermentum ut, 
    pretium a, orci. Quisque hendrerit interdum orci. 
    Nulla sit amet risus non enim ultrices bibendum. 
    Aenean arcu purus, rhoncus at, vestibulum vel, 
    volutpat et, nunc. Integer eget risus eget purus viverra 
    congue.</p>
    <p>Nullam vel libero ut purus semper ullamcorper. 
    Pellentesque mattis tincidunt odio. Nullam pulvinar 
    orci at dolor. Sed volutpat eros ac elit. 
    Praesent porttitor libero sed felis. Vivamus lobortis 
    pellentesque diam. 
    Proin laoreet massa ac metus. Integer faucibus lorem 
    molestie nibh. Integer id massa. Integer ligula ipsum, 
    pellentesque id, interdum at, pretium eget, orci.
    Proin malesuada. Ut vel lorem.</p>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T22:48:42.103

IE7和IE6 的元素[存在各种问题](http://www.brunildo.org/test/IEWfc.html)。在 IE7 中，在一个元素上使用只会清除其他*浮动在同一方向上*的浮动下方的浮动。`float``clear``clear``float`

 *[easyclearing](http://www.positioniseverything.net/easyclearing.html)修复程序的修改版本可能会奏效，但不要抱太大希望。详情见本页：[IE7需要新的清除方式？](http://www.456bereastreet.com/archive/200603/new_clearing_method_needed_for_ie7/).

底线是，如果不作弊，您可能无法在 IE6/7 中使用它：将 div 在文本中向下移动，将 div 嵌入段落中，等等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T23:23:49.210

我相当确定这是 ie6 中没有纯 CSS 解决方案的罕见错误之一。

尝试使用 ie7 javascript - 它可能会为您解决问题：[http ://code.google.com/p/ie7-js/](http://code.google.com/p/ie7-js/)

# f# - F# 中的命名空间和模块有什么区别？

> ID：795172
> 
> 赞同：90
> 
> 时间：2009-04-27T20:33:07.000
> 
> 标签：f#, module, namespaces

我刚刚开始学习 F#（之前几乎没有 .NET 经验）所以请原谅我可能是一个非常简单的问题：F# 中的命名空间和模块之间有什么区别？

谢谢

戴夫

编辑：感谢布赖恩的回答。这就是我想知道的。澄清一下：你也可以打开一个命名空间（类似于 C# using 语句）吗？

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2009-04-27T21:01:51.050

命名空间是 .Net 的东西，在许多工业级语言中很常见，只是一种组织框架和避免不同库之间命名冲突的方法。你和我都可以定义一个类型“Foo”并在一个项目中使用它们，只要它们位于不同的命名空间中（例如 NS1.Foo 和 NS2.Foo）。.Net 中的命名空间包含类型。

模块是 F# 的东西，它大致类似于“静态类”......它是一个实体，可以保存 let-bound 值和函数，以及类型（注意命名空间不能直接包含值/函数、命名空间只能包含类型，而类型本身可以包含值和函数）。可以通过“ModuleName.Thing”引用模块中的事物，这与命名空间的语法相同，但 F# 中的模块也可以“打开”以允许非限定访问，例如

```
open ModuleName
...
Thing  // rather than ModuleName.Thing 
```

（编辑：命名空间也可以类似地打开，但模块可以包含值和函数的事实使得打开模块更加“有趣”，因为您可以使用值和函数，例如“cos”，作为您可以使用的名称直接，而在其他 .Net 语言中，您通常必须对其进行限定，例如“Math.cos”）。

如果您在 F# 中的“顶级”键入代码，则此代码会隐式进入模块。

希望有所帮助，这是一个非常开放的问题。:)

# sharepoint - 共享点公共表单

> ID：795180
> 
> 赞同：1
> 
> 时间：2009-04-27T20:35:16.183
> 
> 标签：sharepoint, permissions, sharepoint-2007, anonymous

我有一个 MOSS 2007 运行一个网站，该网站有一个面向公众的表单，任何匿名用户都可以填写和保存。但我要求匿名用户只能看到空白表单，并且其他用户填写的表单对匿名用户不可见/不可访问。

为此，我有一个受身份验证保护的表单库（form1）和另一个可供公众使用的表单库（form2）。我的安排是匿名用户从form2填写表单，并将其保存在form1中。但是在以这种方式实现时，我收到“提交表单时出错”错误。

任何的想法 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T20:47:50.100

您可以创建简单的工作流程，将新文档从公共文档库移动到受保护的文档库。或者，您可以通过电子邮件启用文档库以将填写的表格作为受保护文档库的附件。
这里有关于如何构建 SharePoint 工作流的视频、开发环境的详细描述等免费研讨会。[http://rshelton.com/archive/2007/10/05/free-workshop-sharepoint-document-workflow-for-developers---part-1.aspx](http://rshelton.com/archive/2007/10/05/free-workshop-sharepoint-document-workflow-for-developers---part-1.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T02:19:06.840

我认为最简单的方法是使用事件处理程序！（假设你知道基本代码）希望这个博客对你有所帮助，否则谷歌它。[http://blogs.msdn.com/brianwilson/archive/2007/03/05/part-1-event-handlers-everything-you-need-to-know-about-microsoft-office-sharepoint-portal-server-苔藓事件处理程序.aspx](http://blogs.msdn.com/brianwilson/archive/2007/03/05/part-1-event-handlers-everything-you-need-to-know-about-microsoft-office-sharepoint-portal-server-moss-event-handlers.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T20:41:19.843

您信任经过身份验证的用户吗？如果是这样，最简单的方法是授予他们管理列表权限并更改列表的查看/编辑访问设置。

您可以在“列表设置 -> 高级设置 -> 项目级权限”下找到它们。

这样，您就可以将所有内容都放在同一个列表中。

# c# - 如何将 DataGridView 定位到特定行（使所选行位于顶部）

> ID：795181
> 
> 赞同：16
> 
> 时间：2009-04-27T20:35:23.373
> 
> 标签：c#, .net, datagridview, user-interface

我有一个带有 DataGridView 的应用程序，我想定位行，以便特定行位于列表的顶部。

我不想要排序，我想要一种以编程方式告诉 DataGridView“滚动到第 N 行”的方法。

有任何想法吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-04-27T20:38:35.863

怎么样[`FirstDisplayedScrollingRowIndex`](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.firstdisplayedscrollingrowindex.aspx)？

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-27T20:39:02.897

DataGridView 有一个名为：FirstDisplayedScrollingRowIndex 的属性。设置它，然后该行将位于列表的顶部。

# wpf - WPF - 必须满足哪些条件才能在自定义控件的内容项中使用数据绑定？

> ID：795184
> 
> 赞同：3
> 
> 时间：2009-04-27T20:36:30.563
> 
> 标签：wpf, binding, dependency-properties

我正在制作一个自定义控件——特别是一个饼图。我希望标记看起来像这个例子：

```
<c:PieChart>
    <!-- These dependency properties are never set -->
    <c:Slice Value="{Binding RedCount}" />
    <c:Slice Value="{Binding BlueCount}" />
    <c:Slice Value="{Binding GreenCount}" />
</c:PieChart> 
```

`PieChart`源自`Control`：

```
[ContentProperty("Slices")]
public class PieChart : Control
{
    public PieChart()
    {
        Slices = new ObservableCollection<Slice>();
    }

    public ObservableCollection<Slice> Slices { get; private set; }
} 
```

上面的 XAML 导致该`Slices`属性填充三个`Slice`.

这是来自的片段`Slice`：

```
public class Slice : ContentControl
{
    public static DependencyProperty ValueProperty
        = DependencyProperty.Register(
            "Value", typeof(double), typeof(Slice),
            new PropertyMetadata((p,a) => ((Slice)p).OnValueChanged(a)));

    private void OnValueChanged(DependencyPropertyChangedEventArgs e)
    {
        // This code never called!
    }
} 
```

*问题*是永远不会设置`Value`属性。`Slice`如果我将依赖属性放在`PieChart`并复制绑定表达式，则值已设置，因此我确信我了解依赖属性和绑定的基础知识。

那么，我必须做什么才能让我的依赖属性在子项上设置一个值？由于这些项目在我自己的收藏中，它们是否不在逻辑树中，任何魔法都可以使绑定起作用？

一个简单的“这样做”答案会有所帮助，但我真的很想了解这里出了什么问题，所以我会接受发布的最有见地、解释性的答案。

**编辑**我没有说清楚，但有一些环境对象`DataContext`包含`PieChart`属性`RedCount`等。过去，当我在绑定路径中出现拼写错误（或其他错误）时，我见过运行时 VS 输出窗口中的警告。在这种情况下，我什么也看不到。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T21:12:56.420

看起来`Slice`控件没有连接到可视化树。它们只是成员变量，而 WPF 并不知道将它们显示为`PieChart`. 几种可能的方法：

已`PieChart`调用`AddLogicalChild`添加`Slice`对象。您将需要处理`Slice`在运行时将 s 添加到集合中或从集合中删除的可能性。这是相当低的级别：MSDN 建议，“对于控件作者，不推荐在此级别操作逻辑树，除非可用基本控件类的内容模型都不适合您的控件方案。考虑在该级别子类化,`ContentControl`和. `ItemsControl`"`HeaderedItemsControl`

做`PieChart`一个`Panel`. 然后`Slice`s 将成为它的孩子，但请注意该`Children`属性是弱类型的，因此人们可以向 a 添加任何内容`PieChart`。这本质上不是一件坏事或一件好事。这是一个设计考虑（见下面的注释）。但这可能不是您想要的。

制作`PieChart`,[`ItemsControl`](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.aspx)并覆盖[`GetContainerForItemOverride`](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.getcontainerforitemoverride.aspx),[`IsItemItsOwnContainerOverride`](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.isitemitsowncontaineroverride.aspx)并可能[`PrepareContainerForItemOverride`](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.preparecontainerforitemoverride.aspx)创建/尊重`Slice`控件。（参见`ListBox`and `ListBoxItem`, `ComboBox`and`ComboBoxItem`等）其中一个很好的特性是用户可以使用 an `ItemsSource`and a `DataTemplate`（如 a `ListBox`），而不必手动创建子控件。（但用户仍然可以`Slice`根据您的语法在 XAML 中创建固定的 s，就像他们可以`ListBoxItems`在 XAML 中创建一样。）

您甚至可以考虑一种混合方法，例如将径向布局功能分解为 a`RadialLayoutPanel`并将饼图生成分解为`ItemsControl`使用 a`RadialLayoutPanel`作为其`ItemsPanel`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T20:47:50.897

我认为您看到的问题是绑定试图使用错误的来源。我怀疑这样的事情会为你工作：

```
<c:PieChart>
    <!-- These dependency properties are never set -->
    <c:Slice Value="{Binding RedCount, RelativeSource={AncestorType c:PieChart}}" />
    <c:Slice Value="{Binding BlueCount, RelativeSource={AncestorType c:PieChart}}" />
    <c:Slice Value="{Binding GreenCount, RelativeSource={AncestorType c:PieChart}}" />
</c:PieChart> 
```

我认为这很接近，但我可能还差得很远。我现在真的查不出来。但这对我来说听起来不错。（对不起，如果它完全错误:)）

# python - 如何在继承的类中执行常见的初始化后任务？

> ID：795190
> 
> 赞同：16
> 
> 时间：2009-04-27T20:38:03.883
> 
> 标签：python, inheritance, initialization

一组共享同一个父类的类的初始化过程可以分为三个部分：

*   通用初始化
*   特定于子类的初始化
*   常见的后初始化

目前前两部分是从`__init__`每个子类的方法中调用的，但最后的初始化后部分必须单独调用，例如

```
class BaseClass:
    def __init__(self):
        print 'base __init__'
        self.common1()

    def common1(self):
        print 'common 1'

    def finalizeInitialization(self):
        print 'finalizeInitialization [common2]'

class Subclass1(BaseClass):
    def __init__(self):
        BaseClass.__init__(self)
        self.specific()

    def specific(self):
        print 'specific'

if __name__ == '__main__':
    s = Subclass1()  # Don't forget to finalize the initialization
    s.finalizeInitialization()  # now the object is fully initialized 
```

有没有办法不用打电话`finalizeInitialization()`？或者可以将呼叫转移`finalizeInitialization()`到`Subclass1`'s `__init__`（如[S.Lott's answer](https://stackoverflow.com/questions/795190/how-to-perform-common-post-initialization-tasks-in-inherited-python-classes/795213#795213)中）。这使生活更轻松，但仍然必须记住完成初始化，这次是在“构造函数”内部。无论哪种方式，都无法强制执行完全初始化，这就是我正在寻找的。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-28T01:17:47.847

模板方法设计模式的救援：

```
class BaseClass:
    def __init__(self, specifics=None):
        print 'base __init__'
        self.common1()
        if specifics is not None:
            specifics()
        self.finalizeInitialization()

    def common1(self):
        print 'common 1'

    def finalizeInitialization(self):
        print 'finalizeInitialization [common2]'

class Subclass1(BaseClass):
    def __init__(self):
        BaseClass.__init__(self, self.specific)

    def specific(self):
        print 'specific' 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-27T20:43:57.223

版本 1 - 委托一切。

```
class Subclass1(BaseClass):
    def __init__(self):
        super( Subclass1, self ).__init__()
        self.specific()
        super( Subclass1, self ).finalizeInitialization() 
```

版本 2 - 仅委托一步

```
class BaseClass:
    def __init__(self):
        print 'base __init__'
        self.common1()
        self.specific()
        self.finalizeInitialization()

    def common1(self):
        print 'common 1'

    def finalizeInitialization(self):
        print 'finalizeInitialization [common2]'

    def specific( self ):
        # two choices:
        # if this is "abstract": raise an exception
        # if this is "concrete": pass 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T02:10:17.487

类似于 S. Lott 的方法，除了`__init__`派生类无法（没有覆盖）覆盖（甚至调用）常用方法：

```
class BaseClass:
    def __init__(self):
        def common():
            print "common initialization..."

        def final():
            print "common finalization..."

        common()
        self.specific()
        final()

    def final_init(self):
        print "BaseClass.final_init"

class Subclass1(BaseClass):

    def specific(self):
        print "Subclass1.specific" 
```

如果在创建不提供自己实现的任何子类的实例时引发 an 是不合适的，您可能希望提供`specific`in的默认实现。`BaseClass``AttributeError`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-10-31T23:06:30.730

您可以使用元类（并更新为 Python3 代码）：

```
class PostInitCaller(type):
    def __call__(cls, *args, **kwargs):
        obj = type.__call__(cls, *args, **kwargs)
        obj.__post__init__()
        return obj

class BaseClass(metaclass=PostInitCaller):  

    def __init__(self):
        print('base __init__')
        self.common1()

    def common1(self):
        print('common 1')

    def finalizeInitialization(self):
        print('finalizeInitialization [common2]')

    def __post__init__(self): # this is called at the end of __init__
        self.finalizeInitialization()

class Subclass1(BaseClass):
    def __init__(self):
        super().__init__()
        self.specific()

    def specific(self):
        print('specific')

s = Subclass1() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T20:47:40.757

从子类的 init 调用 finalInitilazation 有什么问题？

```
 class BaseClass:
        def __init__(self):
            print 'base __init__'
            self.common1()

        def common1(self):
            print 'common 1'

        def finalizeInitialization(self):
            print 'finalizeInitialization [common2]'

    class Subclass1(BaseClass):
        def __init__(self):
            BaseClass.__init__(self)
            self.specific()
            BaseClass.finalizeInitialization(self)

        def specific(self):
            print 'specific'

    if __name__ == '__main__':
        s = Subclass1() #Don't forget to finalize the initialization
        s.finalizeInitialization()  # now the object is fully initialized 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-27T21:43:07.720

如果您必须以特定顺序调用多个方法，这通常意味着设计一开始就有问题（它正在泄漏实现细节）。所以我会尝试从那一端开始工作。

另一方面，如果人们从类派生并且必须修改初始化，他们应该知道其中的含义——这不是您希望在普通 API 中拥有的东西。或者，您可以对最终初始化进行防御，并检查它是否已在依赖它的方法中调用（如果没有调用它或引发异常）。

# c - 数组中的元素太多！

> ID：795194
> 
> 赞同：5
> 
> 时间：2009-04-27T20:38:59.497
> 
> 标签：c, arrays, size, double

对不起，如果这是一个菜鸟问题:(。

一段C代码。

```
int array[5];
int cnt;

for(cnt = 0; cnt <= 10; cnt+=1)
{
      array[cnt] = cnt;
} 
```

应该报错吧？不！工作正常！但这是为什么呢？似乎 - 在第一行 - 定义了一个大于双倍大小 (11) 的数组。您甚至可以稍后访问数组 [5 到 10]。这让我很困惑。当您定义数组 [4 或更少] 时，它会停止工作...

提前致谢。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-27T20:40:21.163

它可能恰好适用于您的特定编译器和计算机，但您不应该指望它。

根据 C 语言规范，您的代码的行为是*未定义*的。这意味着它可能会如您所愿，或者可能导致您的计算机崩溃，或者可能导致[恶魔飞出您的鼻子](http://catb.org/jargon/html/N/nasal-demons.html)。

与 Java 和 C# 等高级语言不同，C 信任您并且不对数组的边界执行显式检查。你应该负责，不要踏出阵列的边界。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-04-27T20:42:59.253

如果您对“工作”的定义与“尚未崩溃”同义，则这只“有效”。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-27T20:43:25.570

您看到的是**未定义的行为**，这是由于您使用无效索引访问数组引起的。未定义的行为意味着任何事情都可能发生，包括您的程序似乎可以正常工作。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-27T20:40:32.253

**“但这是为什么呢？”**

因为C就是这样。

运行时不检查数组边界。

这就是“C定律”

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-28T15:57:10.523

我只想指出，这一切确实是未定义的。您的示例在此特定示例中“有效”，因为这两个变量都位于堆栈上。那就是 cnt 的地址就在数组末尾的下方。当 cnt 达到 cnt==5 时，语句 array[cnt]=cnt; 不会写入专用于数组的内存，而是写入数组之后，cnt 的地址所在的位置。它没有改变你的计数器只是运气。当 cnt>5 没有内存可以丢弃，它只会写入“stack void”（不知道正确的词）。

另一个例子来说明这一点：

```
int main(int ac,char **av)
{
    int a[5];
    int cnt;
    int cnt2=3;

    for(cnt=0;cnt<7;cnt++) {
        a[cnt]=cnt;
        printf("%d %d %d\n", a[cnt], cnt, cnt2);
    }
} 
```

输出：

```
0 0 3
1 1 3
2 2 3
3 3 3
4 4 3
5 5 5
6 6 5 
```

循环的最后两次写入会覆盖 a[] 之后的堆栈数据，并且可能会产生非常混乱的错误。在这种情况下，cnt2 被丢弃。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-27T20:47:47.183

C 中的数组在运行时不检查。换句话说，您可以“定义”一个大小为 N 的数组，并愉快地访问数组边界的末尾。如果您离开数组的末尾，那么您将在堆栈（或堆）的某个位置丢弃内存。

一旦你在某处垃圾内存，你的程序很可能会崩溃。这些崩溃可能很难追踪，因为它们可能会在远离您实际超出阵列末端的地方崩溃。

通常，当您在 C 中声明数组时，最好使用某种常量或 #define 来标记数组的大小：

```
#define MAX_ELEMENTS 10
int array[MAX_ELEMENTS];
int cnt;
for(cnt = 0; cnt < MAX_ELEMENTS; cnt+=1) {
   array[cnt] = cnt;
} 
```

如果您在数组赋值中超过 MAX_ELEMENTS，您可能会覆盖 cnt 的值。您可能会覆盖其他一些变量。一切都取决于编译器和代码结构。还要注意在 for 循环中使用 < 符号。C 数组是基于 0 的，因此您必须使用小于和不小于或等于进行检查。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-01T03:37:04.413

C 中的数组边界*不一定*在运行时检查。该标准让实现者可以自由选择或不选择这样做 - 这是*undefined*的一部分。在使用胖指针的实现中，样本确实可能会导致某种错误。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-27T20:43:11.203

一旦你跑出数组的末尾，你就会覆盖软件不期望的内存并破坏堆。您的软件可能会继续运行，但会非常不稳定！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-27T20:43:19.020

取决于堆栈内存的打包方式。此外，它会很高兴地覆盖这些值甚至读取它们，但很可能您正在破坏堆栈。

# c# - 插入具有对现有记录的引用的新行的 Linq 问题

> ID：795196
> 
> 赞同：1
> 
> 时间：2009-04-27T20:40:07.497
> 
> 标签：c#, .net, linq, linq-to-sql

[（我相信这和这个](https://stackoverflow.com/questions/785291/why-is-linq-to-sql-entity-association-creating-a-new-duplicate-row-when-inserti)问题一样，但那里没有答案，我想我可以在这里更好地表达这个问题......）

我有两个 Linq-to-SQL 类，`State`并且`County`，其中`County`有一个 FK 到`State`. 下面是一些测试代码：

```
State s = State.GetState("NY"); // here I do a load of a State class via the Linq DataContext
County c = new County();
c.Name = "Rockland";
c.State = s;
MyDataContext.GetTable<County>().InsertOnSubmit(c);
MyDataContext.SubmitChanges(); // throws an exception 
```

抛出的异常是`"Violation of PRIMARY KEY constraint 'PK_State'. Cannot insert duplicate key in object 'dbo.State'"`.

换句话说，这里似乎发生的是，尽管我已`s`作为现有记录加载，但当我尝试插入时`c`，Linq 假设所有相关对象（`State`包括在内）也需要插入！

这完全是荒谬的，我无法相信微软会犯这么大的错误——所以一定是我自己的理解有问题。

谁能解释我做错了什么，这里的正确方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T20:56:29.393

这里有些不对劲。我假设 State -> Count 是一对多的关系。在这种情况下，正确的做法是：

```
State s = State.GetState("NY"); // here I do a load of a State class via the Linq DataContext
County c = new County();
c.Name = "Rockland";

s.Counties.Add(c);
db.SubmitChanges(); 
```

由于 State 是父表，因此您需要将县添加到州的县集合中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T21:17:08.953

该`State.GetState(...)`函数是否使用与 相同的数据上下文`MyDataContext.GetTable<County>()`？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T21:50:46.220

## 解决了！

[约翰·博克](https://stackoverflow.com/questions/795196/linq-problem-with-inserting-new-rows-that-have-references-to-existing-records/795319#795319)问道：

> State.GetState(...) 函数是否使用与 MyDataContext.GetTable() 相同的数据上下文？

我的回答是“是”——他们使用的是相同的 DataContext 类……但他们使用的是不同的**实例**。

**经验教训：**对于您计划持久保存到数据库的任何对象，始终使用 DataContext 类的相同**实例！**

（无论如何，约翰得到了答案......）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T22:12:46.697

如果 State 没有使用相同的 DataContext 实例，则可能首先调用 Attach 方法。

# c# - C# 中的事件或 Lambda？

> ID：795203
> 
> 赞同：2
> 
> 时间：2009-04-27T20:41:28.197
> 
> 标签：c#, events, lambda

我只是出于好奇而将其扔在那里...

**假设您只期望/想要提供一种方法**，这会不受欢迎还是*不好的做法？*

```
public class Something  {
    public Action OnRemove = () => { };
    public Action<object, EventArgs> OnFinishedLoading = (sender, e) => { };
}

// then used like...
something.OnRemove = () => { /*do something...*/ };
something.OnFinishedLoading = (sender, e) => { /*do something else...*/ }; 
```

我意识到这就像在活动中作弊，但是这种方法有什么不好的地方吗？从长远来看，这会导致您的应用程序出现任何潜在问题吗？

*我意识到如果你想要运行不止一种方法，那么一个事件会更好，这主要是你是否只想要/期望一种方法的问题。*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T20:45:35.567

好吧，它最明显的“错误”是它暴露了公共领域。我至少会使用一个属性-无论如何，事件可能会更简单。与属性相比，它以更少的代码提供了更大的灵活性（因为您不能使用具有特定默认值的自动实现的属性）。

另一种选择是将它放在构造函数中，然后将其保留为私有只读字段。这可能是我真正倾向于做的事情......真的有必要将动作公开为属性/字段吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T20:45:38.717

这种方法没有任何问题，我经常使用它。它使简单的处理程序具有简单的代码（这是一件好事）。

这种方法的唯一缺点是不能轻易删除以这种方式创建的处理程序。通常你可以说

```
something.OnRemove -= SomeEvent; 
```

但并非所有 lambda 表达式都如此。文本相等的 lambda 表达式几乎肯定会有单独的实现，因此不会匹配到添加和删除事件处理程序的目的。

例如，以下代码将无法删除处理程序。

```
something.OnRemove += () { MessageBox.Show("Removed!"); }
something.OnRemove -= () { MessageBox.Show("Removed!"); } 
```

但只要你只想添加，这不是问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T20:46:46.030

它可能会比您想要的更多。通常，事件不允许客户端检查`MulticastDelegate`支持该事件的内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T20:48:56.540

我认为这种方法很好，它只是声明委托的一种简写方式（查看 Action 系列的定义）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T20:44:53.150

对于该事件，您不能这样做：

```
something.OnRemove = null; 
```

这些事件为您提供了一个包装器，一种具有属性和属性的包装器，因此您可以确保对委托方法的封装。

# c# - “模拟”数据库和“真实”数据库行为之间的差异

> ID：795204
> 
> 赞同：3
> 
> 时间：2009-04-27T20:41:45.840
> 
> 标签：c#, database, linq, count, mocking

*我们将 C# 和 Linq2SQL 与 MS SQL Server 数据库一起使用。我们有一个 mockdatacontext 来进行一些单元测试。在测试时，我们发现了两种不同的行为，这取决于使用的是“真实”还是“模拟”数据库。*

**场景一：真实数据库**

数据库中有5条记录：

```
db = realDatabase
db.InsertOnSubmit(new record)

var count1 = db.getTable.Count()

db.SubmitChanges()

var count2 = db.getTable.Count() 
```

计数 1 = **5** 计数 2 = **6**

**场景 2：模拟数据库**

数据库中有5条记录：

```
db= mockDatabase

db.InsertOnSubmit(new record)

var count1 = db.getTable.Count()

db.SubmitChanges()

var count2 = db.getTable.Count() 
```

计数 1 = **6** 计数 2 = **6**

*“模拟”数据库在调用 SubmitChanges() 之前已经知道新记录，因此它包含在计数中。对于测试，我们需要两种行为相同。

**有没有其他人遇到过这个问题，你能提出解决方案吗？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-29T22:20:14.340

IMO，这是一个试图在测试中模拟的常见错误。**模拟不是模拟器。**它不应该实现类似于原始的逻辑，它应该只返回硬编码的结果。

**如果模拟行为很复杂，您最终会测试模拟而不是业务代码。**

我正在使用 RhinoMocks，它看起来像这样：

```
// arrange
IList<Record> testdata = new List<Record>() {a, b, c};
db = MockRepository.GenerateMock<IDatabase>();
db.Stub(x => db.getTable).Return(testdata);

// act: call your unit under test

// assert
db.AssertWasCalled(x => x.InsertOnSubmit(Arg<Record>.Is.Anything));
db.AssertWasCalled(x => x.SubmitChanges()); 
```

它仍然每次都返回相同的列表。对于许多情况，这已经足够了。您仍然可以在第二次 getTable 调用中返回其他数据：

```
db.Stub(x => db.getTable).Return(testdata1);
db.Stub(x => db.getTable).Return(testdata2); 
```

它总是特定于单个测试，但这使它变得如此简单。

编辑：

我不得不承认我对 Linq2Sql 并不熟悉。在我的示例中模拟的调用是 Linq2Sql 调用，可能不能那么容易地模拟。您可能需要将它放在一个简单的 DAL 接口后面。然后你模拟这个界面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T18:39:20.237

我猜您的模拟数据库（在内存中？？）不是事务性的，并且该`InsertOnSubmit`方法实际上是插入记录。

# c# - 使用 Intellisense 和编译时检查提取反射的属性名称

> ID：795208
> 
> 赞同：15
> 
> 时间：2009-04-27T20:43:08.253
> 
> 标签：c#, reflection, mapping, intellisense, compile-time

行。所以我有一些代码将winForm上的某些控件映射到对象中的某些属性，以便在数据发生某些事情时对控件执行某些事情。一切都很好，工作正常。不是问题。问题是，要将项目添加到映射中，我调用了一个如下所示的函数：

```
this.AddMapping(this.myControl,myObject,"myObjectPropertyName"); 
```

我遇到的问题是，在编译时很难分辨上面的行和下面的行之间的区别：

```
this.AddMapping(this.myControl,myObject,"myObjectPropretyName"); 
```

由于最后一个参数是字符串，因此没有编译时检查或类似的东西会强制字符串本身实际上对应于给定对象上的有效属性名称。此外，诸如 Refactor 和“查找所有引用”之类的东西错过了这种引用，当属性名称本身发生变化时会导致欢闹。所以我想知道是否有某种方法可以改变函数，这样我传入的仍然是以某种方式表示属性名称的字符串，但是编译时会检查实际值。有人说我可以用表达式树做到这一点，但我已经阅读了它们，似乎没有看到联系。我很想做类似的事情：

```
this.AddMapping(this.myControl,myObject,myObject.myObjectPropertyName); 
```

甚至

```
this.AddMapping(this.myControl,myObject.myObjectPropertyName); 
```

会很甜！

有任何想法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-27T20:48:05.810

在 3.5 中，Expression 是将成员名称指定为代码的一种方式；你可以有：

```
public void AddMapping<TObj,TValue>(Control myControl, TObj myObject,
       Expression<Func<TObj, TValue>> mapping) {...} 
```

然后解析表达式树以获取值。效率有点低，但还不错。

这是示例代码：

```
 public void AddMapping<TSource, TValue>(
        Control control,
        TSource source,
        Expression<Func<TSource, TValue>> mapping)
    {
        if (mapping.Body.NodeType != ExpressionType.MemberAccess)
        {
            throw new InvalidOperationException();
        }
        MemberExpression me = (MemberExpression)mapping.Body;
        if (me.Expression != mapping.Parameters[0])
        {
            throw new InvalidOperationException();
        }
        string name = me.Member.Name;
        // TODO: do something with "control", "source" and "name",
        // maybe also using "me.Member"
    } 
```

调用：

```
 AddMapping(myControl, foo, f => f.Bar); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T14:47:54.387

为了使基于表达式的 lamda 变通方法更容易，我将其编写为扩展方法。

```
 public static string GetPropertyName<T>(this object o, Expression<Func<T>> property)
    {
        var propertyInfo = (property.Body as MemberExpression).Member as PropertyInfo;
        if (propertyInfo == null)
            throw new ArgumentException("The lambda expression 'property' should point to a valid Property");
        var propertyName = propertyInfo.Name;
        return propertyName;
    } 
```

像这样打电话

```
 class testclass
    {
        public string s { get; set; }
        public string s2 { get; set; }
        public int i { get; set; }

    }

    [TestMethod]
    public void TestMethod2()
    {
        testclass x = new testclass();
        string nameOfPropertyS = this.GetPropertyName(() => x.s);
        Assert.AreEqual("s", nameOfPropertyS);

        string nameOfPropertyI = x.GetPropertyName(() => x.i);
        Assert.AreEqual("i", nameOfPropertyI);

    } 
```

好的，使用作为扩展方法确实是为了方便，因为您实际上可以在一个类上调用该方法来获取另一个类的属性。我确信它可以改进。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2021-04-08T10:27:53.790

老问题，但没有人用可用的最新语法糖更新答案。

从 C# 6 开始，有一种更好的方法，即获取成员名称，同时仍然引用成员本身。`nameof`关键字。它是一种语法糖，将替换为包含引用的属性/成员/函数名称的字符串。Intellisense、重构、查找所有引用都将起作用。这适用于任何属性、字段、函数和类引用。

```
using System;

public class Program
{
    public static void Main()
    {
        Console.WriteLine("Name of the class is: {0}", nameof(MyClass));
        Console.WriteLine("Name of the class field is: {0}", nameof(MyClass.MyField));
        Console.WriteLine("Name of the class property is: {0}", nameof(MyClass.MyProperty));
        Console.WriteLine("Name of the class function is: {0}", nameof(MyClass.MyFunction));
    }
}

public class MyClass
{
    public int MyField;

    public int MyProperty { get; set; }

    public void MyFunction() { }
} 
```

该程序输出以下行：

> 类名：MyClass
> 类字段名：MyField
> 类属性名：MyProperty
> 类函数名：MyFunction

使用它，您的代码现在变为：

```
this.AddMapping(this.myControl, nameof(myObject.myObjectPropertyName)); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-27T20:53:29.447

考虑使用 lambdas 甚至`System.Linq.Expressions`为此，使用以下之一：

```
extern void AddMapping<T,U>(Control control, T target, Func<T,U> mapping);
extern void AddMapping<T,U>(Control control, T target, Expression<Func<T,U>> mapping); 
```

然后调用它

```
this.AddMapping(this.myControl, myObject, (x => x.PropertyName)); 
```

如果您需要在运行时拆分抽象语法树，请使用 Expression 参数，以执行反射性操作，例如将属性名称作为字符串获取；或者，让委托人完成你需要的数据的工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-27T20:47:28.510

您真的不应该将字符串文字作为属性名称传递。相反，您应该使用`YourClass.PROPERTY_NAME_FOO`.

您应该在您的类中将这些字符串声明为 const。

```
public const String PROPERTY_NAME_FOO = "any string, it really doesn't matter";
public const String PROPERTY_NAME_BAR = "some other name, it really doesn't matter"; 
```

或者，您根本不必担心字符串，只需担心属性名称：

```
public const int PROPERTY_NAME_FOO = 0;
public const int PROPERTY_NAME_BAR = 1; //values don't matter, as long as they are unique 
```

这将阻止不引用有效属性的字符串进入函数调用。

Intelisense 将能够向您显示您班级中的属性名称，作为自动完成的建议。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-09-09T17:18:44.710

你在找什么叫做静态反射。无耻的插件 => [http://emiajnet.blogspot.com/2009/05/getting-fun-with-net-static-reflection.html](http://emiajnet.blogspot.com/2009/05/getting-fun-with-net-static-reflection.html) 还有一篇更好的文章： [http ://www.lostechies.com/blogs/ gabrielschenker/archive/2009/02/03/dynamic-reflection-versus-static-reflection.aspx](http://www.lostechies.com/blogs/gabrielschenker/archive/2009/02/03/dynamic-reflection-versus-static-reflection.aspx)

# frameworks - 微软的哪些框架并不为人所知，值得深入探索？

> ID：795212
> 
> 赞同：0
> 
> 时间：2009-04-27T20:43:36.163
> 
> 标签：frameworks

似乎某些 Microsoft 框架仅以名称和声誉而闻名，而不是内容或用途。尤其是随着开源框架的兴起，它们有时会变得有点不受欢迎。

微软的哪些框架并不为人所知，值得深入探索？他们的声誉和有用的领域是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T20:51:09.233

我用的不多，但它是一个引人入胜的话题：[协调和并发运行时](http://msdn.microsoft.com/en-us/library/bb648752.aspx)。它是[Microsoft Robotics Developer Studio](http://msdn.microsoft.com/en-us/robotics/default.aspx)的一部分，在安装和许可方面很麻烦，但它是查看并发性的一种非常简洁的方式。据我所知，Parallel Extensions 并没有完全覆盖相同的领域——我希望在某个时候看到 CCR 作为独​​立的免费库提供。

从我的角度来看，特别简洁的方面是通过迭代器块中的延续来表示异步工作流。不像 F# 那样整洁，但仍然相当漂亮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T21:15:16.180

我认为您应该查看他们在 Microsoft Research 上的资料。就像我觉得非常棒的框架之一是对测试很有用的[NaturalSpec 。](http://code.google.com/p/natural/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T21:13:15.483

[微软（代号）凤凰](https://connect.microsoft.com/Phoenix)

Phoenix 是一个用于构建编译器、代码分析和优化工具的 SDK。发布后，它将用作未来 Microsoft 编译器的后端。

SDK（预发行版）可通过上述链接获得。

更多信息：

[维基百科文章](http://en.wikipedia.org/wiki/Phoenix_(compiler_framework))
[Andy Ayers：了解 Phoenix 编译器框架（channel9 视频）](http://channel9.msdn.com/shows/Going+Deep/Andy-Ayers-Understanding-the-Phoenix-Compiler-Framework/)

# asp.net - IIS：匿名和 Windows 身份验证

> ID：795214
> 
> 赞同：4
> 
> 时间：2009-04-27T20:44:08.860
> 
> 标签：asp.net, iis, authentication

# 设想

对于我正在实现的多文件上传器，我需要在使用匿名访问的 Windows 身份验证站点中有一个处理程序。

如此处详述，[这](http://www.uploadify.com/forum/viewtopic.php?f=4&t=239&p=722&hilit=windows+authentication#p722)是因为 Flash 无法使用 Windows 身份验证。上述帖子指出，实现这一目标的唯一方法是创建一个完全独立的站点。但是，对于上传者来说，这似乎是一个很大的麻烦。

有没有办法解决 IIS 的这种限制？

# 笔记

我在带有 Service Pack 2 的 Windows 2003 服务器上使用 asp.net 3.0 和 IIS6。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T21:12:11.837

您可以创建一个虚拟目录作为主站点的子目录。

1.  在机器上的某处创建一个文件夹。确保 IUSR 帐户对此文件夹具有读/写权限。

2.  通过 IIS 在您的网站中创建一个虚拟目录。将其指向您在上面创建的文件夹。

3.  允许对虚拟目录进行匿名访问，并清除 Windows 身份验证。

你应该很高兴。请注意，通过匿名访问，任何人都可以读取/写入此文件夹，即使不使用您的 Flash 应用程序。

我过去这样做的方法是将文档存储在数据库中，并要求在从数据库返回文件之前从 Flash 应用程序传递会话令牌。您可以对文件共享应用类似的方法（制作一个将检查身份验证的upload.aspx，然后从无法从网络访问的文件夹中获取文件）。

# ruby-on-rails - Rails 中的部分 SSL

> ID：795219
> 
> 赞同：8
> 
> 时间：2009-04-27T20:45:12.633
> 
> 标签：ruby-on-rails, ssl

我正在寻找在 Rails 中创建部分 SSL 站点。我基本上想保护 SSL 背后的用户操作，但仅此而已。

任何人都知道使这个简单而高效的插件或gem吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-27T20:48:15.573

这通常通过[SSL Requirement](http://github.com/rails/ssl_requirement/tree/master)插件完成。它设置`before_filter`s 允许您指定哪些操作需要 SSL，哪些可选地允许它，哪些特别不允许它。

除此之外，只需在您的 Apache（或您使用的任何服务器）配置中设置 2 个 VHost，一个用于 SSL 站点，一个用于非 SSL 站点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T20:50:55.770

您可以尝试[ssl_requirement](http://github.com/rails/ssl_requirement/tree/master)。它可以让你指定你想要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-31T08:31:39.800

[ssl_routes](https://github.com/cedric/ssl_routes) gem 在路由文件中定义 ssl 强制规则。它还将自动输出具有正确协议的 url 以防止重定向。

# regex - 如何使用 Perl 正则表达式删除换行符？

> ID：795224
> 
> 赞同：3
> 
> 时间：2009-04-27T20:46:03.053
> 
> 标签：regex, perl, newline

当我运行时：

```
perl -e '$x="abc\nxyz\n123"; $x =~ s/\n.*/... multiline.../; printf("str %s\n", $x);' 
```

我希望结果是：

```
str abc... multiline... 
```

相反，我得到

```
str abc... multiline...
123 
```

我哪里错了？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-27T20:55:23.077

```
$x =~ s/\n.*/... multiline.../s 
```

`/s`修饰符告诉 Perl 将匹配的字符串视为单行，这会导致`.`匹配换行符。通常它不会，导致您观察到的行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T20:58:15.677

您需要在正则表达式上使用 's' 修饰符，以便点 '.' 将匹配任何后续换行符。所以这：

```
$x =~ s/\n.*/... multiline.../; 
```

变成这样：

```
$x =~ s/\n.*/... multiline.../s; 
```

# macos - 在 Mac OS X 中，如何获得文件描述符使用的准确计数？

> ID：795236
> 
> 赞同：38
> 
> 时间：2009-04-27T20:48:08.243
> 
> 标签：macos, unix, lsof

在 Linux 上，`ulimit -n`可用于更改或查看进程的文件描述符数量限制，并且`lsof -p nnn | wc -l`似乎始终报告实际文件描述符的使用情况。

但在 Mac OS X 上，`lsof -p nnn | wc -l`可以返回一个高于限制的数字。我想这意味着`lsof`返回的不仅仅是文件描述符，但我不知道是什么。

底线：**如何获得 Mac OS X 中文件描述符使用的准确计数？**

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2015-02-13T17:45:10.057

我最近遇到了识别这一点的需要——我用来计算总条目的命令（不仅仅是文件句柄，而是它的相对关系，因此与 imo 相关）是：

```
lsof | awk '{print $1}' | uniq -c | sort -rn | head 
```

这给出了类似于以下输出的内容（您使用最多的应用程序可能不同！）：

```
$lsof | awk '{print $1}' | uniq -c | sort -rn | head
3271 com.apple
2978 Google
 914 Atom\x20H
 505 Skype
 476 Microsoft
 375 Screenher
 304 Finder
 292 Dock
 277 Atom\x20H
 270 Atom\x20H 
```

我通常只需要查看前 10 个条目，但您可以操作`head`显示任意数量的行。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-28T14:29:08.677

lsof 不仅可以显示文件描述符，还可以显示很多东西，但大多数可能会增加您的计数的是应用程序的已加载框架和库。您可以查看“FD”列以查看某行是否为文件描述符——在这种情况下，它是一个数字，可能后跟一个指示模式的字母——或其他内容（参见lsof 手册页的完整列表）。

如果你只需要一个粗略的近似值，在你的 wc 之前添加一个“grep -v”txt“”会让你更接近一个准确的值。如果您需要一个准确的值，您可能需要将一个正则表达式放在一起，以便通过 FD 列精确地通过该过滤器提供输出。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-09-21T02:03:47.393

我修改了安德斯的答案，现在它只显示特定进程的打开 fd 编号：

```
FCOUNT=`lsof -p $1 | grep -v " txt " | wc -l`;echo "PID: $1 $FCOUNT" | sort -nk3 
```

例子：

```
$ ./fd-count.sh 5926                                                                                                           
PID: 5926       97 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-03-07T21:07:26.647

我正在寻找哪个进程有很多文件描述符 - 所以我猜像

```
for pid in `ps aux | tail -n +2 | awk '{print $2}'`; do FCOUNT=`lsof -p $pid | grep -v " txt " | wc -l`; echo "PID: $pid $FCOUNT"; done | sort -nk3 
```

# mysql - MySQL 竞争条件

> ID：795237
> 
> 赞同：2
> 
> 时间：2009-04-27T20:48:08.977
> 
> 标签：mysql, database, multithreading, innodb, race-condition

这是否会导致 MySQL (InnoDB) 的竞争条件：

1.  开始交易。

2.  尝试获取记录。

3.  如果记录不存在，则返回。

4.  如果记录存在，请将其删除并添加一个日志条目，说明已删除。

5.  结束事务（提交/回滚）。

是否可以在 2b 中的删除步骤之前启动另一个进程，检测记录的存在，然后让两个进程在日志中输入项目删除条目？

我需要采取什么预防措施吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T20:57:21.620

在步骤 2 中使用“选择更新”。只有一个进程能够获得该行的锁定，从而避免了您描述的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T21:18:46.780

我相信，熟练的程序员有正确的解决方案。既然您已经表明您使用的是损坏的 ORM 工具（一个不允许您查询更新的工具），我建议您将 INSERT 移动到日志表中，作为删除操作的触发器，这样您就可以避免重复入口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-19T15:52:51.427

开始交易。

删除记录 /* 使用与“尝试获取记录”相同的标准 */

如果响应表明记录确实被删除，则添加一个日志条目。

结束事务（提交/回滚）。

没有更多的比赛条件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T21:16:23.433

是的，在您阅读表格后，另一个事务可能会检查该表格。

更糟糕的是，由于事务的工作方式，即使在您删除该行之后，任何开始的新事务都会看到该行，因为您尚未提交删除。

`SELECT ... FOR UPDATE`是防止它的一种方法。

`LOCK TABLE tablename`是另一个。

不幸的是，由于您使用的是 ORM，所以我不能说它是否有能力执行其中任何一项。

# java - python 与 java 运行时占用空间

> ID：795241
> 
> 赞同：7
> 
> 时间：2009-04-27T20:49:30.580
> 
> 标签：java, python, footprint, memory-footprint

谁能指出 Python 运行时足迹与 Java 的认真比较？

谢谢， 亚伯拉罕

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-02-23T15:47:38.597

我无法比较内存占用，因为它实际上取决于您加载/使用的类。但我可以告诉你的是，Python（尤其是 IronPython 2.7）存在真正的内存泄漏问题。尤其是与金融等第三方使用良好的第三方。当 Java 应用程序/服务器运行时没有出现可以用常用工具识别的罕见情况时，Python 会在内存中不断增长。

内存转储表明 Python 本身以及大多数包都不会关注像 String 这样的常见类，而是将它们保存在执行模块的不同部分。遍历所有这些来源并修复所有泄漏是困难且不明智的。

我尝试了很多方法来解决这些问题，但最终屈服并在应用程序达到某个内存阈值时简单地重新启动应用程序。

# linux - 最佳 Squid 日志文件分析工具

> ID：795250
> 
> 赞同：0
> 
> 时间：2009-04-27T20:52:44.083
> 
> 标签：linux, logging, statistics, monitoring, squid

我最近的任务是安装和配置 Squid 代理服务器以过滤和监控我们的内部无线网络。我最近发布了为该项目选择指南的[请求指导](https://stackoverflow.com/questions/682099/best-squid-administrators-guidebook)，你们在那里完成了评分工作。我的下一个问题是 stackoverflow 社区建议使用哪种日志文件分析工具？第一个也是唯一的要求是它是开源/免费软件。

[Squid 主页](http://www.squid-cache.org/Scripts/)有一个很好的可用应用程序列表，但关于每个选项的整体质量或受欢迎程度的数据很少。你过去用过什么，我为什么要选择其中一个而不是另一个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-10-31T13:13:00.653

鱿鱼是一个很好的分析器......

# memory - 用于存储非重叠间隔的数据结构 + 算法

> ID：795258
> 
> 赞同：2
> 
> 时间：2009-04-27T20:56:09.533
> 
> 标签：memory, virtual

我想知道你们中是否有人知道存储非重叠间隔的节省空间的方法。我的最终目标是使用它来分配虚拟地址空间（我正在编写一个有趣的操作系统）并且想知道是否可以以比 O(n) 空间复杂度和 O(n) 搜索更好的方式存储空闲空间区域复杂。

概率数据结构可以工作，因为我总是可以遍历页表以找出地址空间是否可用。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T21:03:36.287

[R-Trees](http://en.wikipedia.org/wiki/R-tree)可用于此。它们也用于 2D（可能还有 N 维）结构，但也可以管理您需要的 1D 项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T21:04:31.887

看看[R 树](http://en.wikipedia.org/wiki/R-tree)。

# linux - Linux中的Curses窗口导致中止

> ID：795260
> 
> 赞同：0
> 
> 时间：2009-04-27T20:56:28.190
> 
> 标签：linux, curses, hp-ux

我有一些最近在 Linux 上编译的遗留 C 代码。在原始 HPUX 上，应用程序打开和关闭多个 curses 窗口。在 Linux 机器上，它可以处理一个窗口，但如果我关闭该窗口，它会使程序崩溃，并显示“已中止”的错误消息。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T21:03:01.983

是的。*使用ulimit(1)*更改您的选项，以便在它中止时保存核心转储。*然后使用gdb(1)*查看核心转储，找出它在哪里中止并回复我们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T21:46:10.070

鉴于对查理·马丁回应的评论，您似乎没有打开窗口，然后关闭了一个未打开的窗口，结果非常显着。查看 Curses 初始化函数和窗口打开调用的返回码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T15:58:02.440

发现是 touchwin 命令导致它失败。删除那行代码似乎没有负面影响。:-) 谢谢大家的帮助。到处投票。

# asp.net - 为什么当 Contional Comment 声明它应该被忽略时加载样式表？

> ID：795267
> 
> 赞同：1
> 
> 时间：2009-04-27T21:01:14.013
> 
> 标签：asp.net, html, css, conditional-comments

我认为如果条件不满足，条件注释会指示浏览器忽略内容？！

例如，如果 IE6 是浏览器，我只想包含一个样式表。以下位于页面的 <HEAD> 元素中。

```
<!--[if IE 6]>
  <link id="IE6StyleSheet" rel="Stylesheet" type="text/css" href="~/css/IE6.css" runat="server" />
<![endif]--> 
```

或者

```
<!--[if IE 6]>
  <link rel="Stylesheet" type="text/css" href="../css/IE6.css" />
<![endif]--> 
```

为什么 IE7、IE8 和 FF3 都加载该样式表？！

注意：将条件更改为 [if lte IE 6] 没有任何区别！:(

**重大更新**

我是个白痴……我才注意到我做错了什么！我给出的示例稍作修改。App_Themes下的css文件的路径！当然，css总是被加载！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T21:04:53.630

尝试：

```
<!--[if lte IE 6]>
   <link id="IE6StyleSheet" rel="Stylesheet" type="text/css" href="../css/IE6.css" />
<![endif]--> 
```

这只会加载 IE6 或更低版本的样式表。这是您可以使用的测试脚本，它将打印出您正在使用的 IE 版本：

```
<p><!--[if IE]>
According to the conditional comment this is Internet Explorer<br />
<![endif]-->
<!--[if IE 5]>
According to the conditional comment this is Internet Explorer 5<br />
<![endif]-->
<!--[if IE 5.0]>
According to the conditional comment this is Internet Explorer 5.0<br />
<![endif]-->
<!--[if IE 5.5]>
According to the conditional comment this is Internet Explorer 5.5<br />
<![endif]-->
<!--[if IE 6]>
According to the conditional comment this is Internet Explorer 6<br />
<![endif]-->
<!--[if IE 7]>
According to the conditional comment this is Internet Explorer 7<br />
<![endif]-->
<!--[if gte IE 5]>
According to the conditional comment this is Internet Explorer 5 and up<br />
<![endif]-->
<!--[if lt IE 6]>
According to the conditional comment this is Internet Explorer lower than 6<br />
<![endif]-->
<!--[if lte IE 5.5]>
According to the conditional comment this is Internet Explorer lower or equal to 5.5<br />
<![endif]-->
<!--[if gt IE 6]>
According to the conditional comment this is Internet Explorer greater than 6<br />
<![endif]-->
</p> 
```

您不应该在 Firefox 中看到带有此测试代码的任何文本。

# macos - 在 Applescript 中解析一组行

> ID：795278
> 
> 赞同：1
> 
> 时间：2009-04-27T21:05:00.120
> 
> 标签：macos, applescript

我正在尝试解析从 Applescript 中的文件读取的一组行。

这就是我的代码的样子：

```
my status_dialog(indexData)
set AppleScript's text item delimiters to return
set indexFreq to (text items 1 thru 1 of indexData) 
```

indexData 包含一组行。行分隔符不起作用。indexFreq 再次返回整组行而不是第一行。

我是这里的新手，在线资源对我没有帮助。

非常感谢！普拉迪普

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T21:47:22.000

您的代码*应该*按预期工作。问题可能在于这`return`不是这组特定行的正确字符。换行符可以是回车、换行或两者兼有，具体取决于创建文件的程序或系统。

您可以尝试使用不同的字符而不是`return`：

```
tell me to set the text item delimiters to (ASCII character 10) --// LF
tell me to set the text item delimiters to (ASCII character 13) --// CR 
```

此外，为确保您的其余代码*设置*正确，请进行简单测试：

```
set test_string to "thisQisQaQtest"
set the text item delimiters to "Q"
return text items of test_string 
```

这应该产生以下内容（在您的 AppleScript 控制台中）：

> { “这是一个测试” }

# java - 上下文相关菜单 - Java ME

> ID：795281
> 
> 赞同：2
> 
> 时间：2009-04-27T21:05:32.600
> 
> 标签：java, java-me, command, midp, lcdui

我正在尝试构建一个基于上下文敏感的命令列表。我为所有命令按钮设置了 command.ITEM 选项。但我找不到如何提供以下功能的方法：

我有一个值列表，比如 A、B、C 对于 A，我的命令菜单应该包含 2,4 当我将选择（光标）移动到 B 时，我的命令菜单应该有 1,3 当我移动到 C 时，命令应该有 2,1 当我回到 A 时，它应该有 A 的命令菜单 (2,4)

它可以用于文件和目录的列表：

选择文件后，我想显示打开、编辑和删除的选项（命令）。当我选择一个目录时，我想显示打开和删除的命令。

提前感谢任何指向正确方向的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T11:06:38.040

该类的规范`javax.microedition.lcdui.Form`（我假设是您正在使用的）指出：

“这些遍历和滚动操作不会导致应用程序可见事件”

在显示命令菜单之前也没有调用任何方法。

这一切意味着你不能在这里使用表单做你想做的事。

根据您所针对的特定手机上的 J2ME 实现，`javax.microedition.lcdui.CustomItem.getInteractionModes()`可能会告诉您是否可以在表单中使用单个 CustomItem 来创建上下文相关菜单。

在所有手机上执行此操作的唯一可靠方法是使用 a`javax.microedition.lcdui.Canvas`并通过自己绘制所需的控件来重新实现它们。然后，您可以跟踪“选择”了哪一个，并在显示它以响应低级`keyPressed()`事件之前填充您自己的命令菜单。

您可能想查看`LWUIT`开源库以获取中间解决方案。

# javascript - Firefox 和 IE 之间 GeoRSS 覆盖的加载时间不一致

> ID：795282
> 
> 赞同：1
> 
> 时间：2009-04-27T21:06:06.047
> 
> 标签：javascript, rss, mapping, geolocation, yahoo-maps

我有一个非常简单的页面，用于显示地图并根据 GeoRSS XML 文件中的点覆盖一条线。这是可公开访问的文件。 [http://68.178.230.189/georssimport.html](http://68.178.230.189/georssimport.html)

Firefox 加载大约需要 5 秒，这是预期的，因为要映射很多点，但 IE（6 和 7）需要 45 秒到一分钟。我能做些什么来诊断发生了什么？什么工具可以告诉我发生了什么？（即 IE 的 Firebug）

谢谢，马克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T15:07:32.610

对于 IE6/7，您可以尝试[YUI Profiler](http://developer.yahoo.com/yui/profiler/)。IE8 内置了一个：工具 -> 开发者工具 -> 分析器 -> 开始分析 -> 重新加载页面

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-04-28T19:30:47.887

我使用谷歌地图 v3。polyline api 在所有浏览器中运行良好且始终如一。一年后，我在雅虎开发者论坛上的所有帖子都没有得到答复。基于这种经验，我不会在 yahoo Maps 库上构建。

# sql-server - 使用 ORDER BY 和 TOP 子句的 SQL 2008 全文搜索，并且没有来自服务器的答案

> ID：795285
> 
> 赞同：1
> 
> 时间：2009-04-27T21:06:36.327
> 
> 标签：sql-server, sql-server-2008, full-text-search

我有以下 SQL 查询：

```
SELECT TOP 200 * FROM article WITH (nolock) 
WHERE CONTAINS(*,'"ram*" and "1*"')
ORDER BY article_number 
```

我在 10 分钟内没有收到任何结果。如果我在几分钟后停止查询，那么它会返回一些记录。

表中`article`有 10,000 条记录。全文目录有`article`4-5 个字段，所以它只包含 1 个表。

如果我不写`ORDER BY`or`TOP 200`子句，那么它会立即返回正确答案。

文章表`INDEX (Unique, clustered)`上有`Article_number`。

我认为这是一个 MS-SQL 2008 错误。

SQL 2008 SP1 也存在该问题。

我真的不明白这个问题，请帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T21:17:44.880

我不相信您可以使用长度少于 3 个字符的字词进行搜索。作为测试，尝试搜索其他内容，例如：

```
select top 200 * from article with (nolock) WHERE contains(,'"ram" and "king*"') order by article_number 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T21:12:46.513

Order by 使查询变慢。article_number 有索引吗？尝试创建索引。

# c++ - 问号字符 ('?') 在 C++ 中是什么意思？

> ID：795286
> 
> 赞同：90
> 
> 时间：2009-04-27T21:07:33.407
> 
> 标签：c++, operators, conditional-operator

```
int qempty()
{
    return (f == r ? 1 : 0);
} 
```

在上面的代码片段中，“？”是什么意思？意思是？我们可以用什么来代替它？

* * *

## 回答 #1

> 赞同：146
> 
> 时间：2009-04-27T21:09:52.857

这通常被称为[**条件运算符**](http://en.wikipedia.org/wiki/%3F:)，当这样使用时：

```
condition ? result_if_true : result_if_false 
```

...如果`condition`计算结果为`true`，则表达式计算结果为`result_if_true`，否则计算结果为`result_if_false`。

它是[语法糖](http://en.wikipedia.org/wiki/Syntactic_sugar)，在这种情况下，它可以替换为

```
int qempty()
{ 
  if(f == r)
  {
      return 1;
  } 
  else 
  {
      return 0;
  }
} 
```

**注意：**有些人将`?:`其称为“**三元运算符**”，因为它是他们使用的语言中唯一的三元运算符（即接受三个参数的运算符）。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-27T21:11:56.547

这是一个三元运算符，它基本上是一个内联 if 语句

```
x ? y : z 
```

像

```
if(x) y else z 
```

除了，你有表达式而不是语句；所以你可以在更复杂的语句中间使用它。

它对于编写简洁的代码很有用，但可能被过度使用以创建难以维护的代码。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-11-22T06:38:37.220

只是一个注释，如果你看到这个：

```
a = x ? : y; 
```

这是标准的 GNU 扩展（参见[https://gcc.gnu.org/onlinedocs/gcc/Conditionals.html#Conditionals](https://gcc.gnu.org/onlinedocs/gcc/Conditionals.html#Conditionals)）。

它与

```
a = x ? x : y; 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-27T21:49:37.377

您可以将其重写为：

```
int qempty(){ return(f==r);} 
```

这与其他答案中所说的相同。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-27T21:12:03.350

它被称为[条件运算符](http://en.wikipedia.org/wiki/%3F:)。

您可以将其替换为：

```
int qempty(){ 
    if (f == r) return 1;
    else return 0;
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-27T21:10:40.887

它是条件运算符。

一种 ？乙：丙

这是 IF/THEN/ELSE 的快捷方式。

意思是：如果a为真，返回b，否则返回c。在这种情况下，如果 f==r，则返回 1，否则返回 0。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-27T21:14:07.323

问号是条件运算符。代码表示如果 f==r 则返回 1，否则返回 0。代码可以重写为

```
int qempty()
{
  if(f==r)
    return 1;
  else
    return 0;
} 
```

这可能不是最干净的方法，但希望能帮助您理解。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2022-01-14T05:36:17.630

它读作：

```
If f == r then return 1 else return 0 
```

# bash - 请问这个重定向">>& “在 Korn shell 中工作？

> ID：795294
> 
> 赞同：2
> 
> 时间：2009-04-27T21:10:26.550
> 
> 标签：bash, redirect, ksh, shell

我正在尝试重定向 UNIX 命令的 STDOUT/STDERR 并附加到 korn shell 中的日志文件。

**rm -rf file1 >>& 日志文件**

这个命令会在 ksh 中工作还是这是一个典型的 bash 命令？使用上述命令会造成什么伤害？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-27T22:54:03.150

我使用这种形式将标准输出和标准错误重定向到同一个文件。

```
ls -ld . fred > no_fred 2>&1 
```

刚刚在 Red Hat Linux 4 的 Korn shell 中进行了测试。no_fred 包含：

```
ls: fred: No such file or directory
drwxrwxr-x  2 user group 1024 Apr 27 17:41 . 
```

">" 实际上是 1>，表示重定向文件描述符 1（标准输出）。“2>”重定向标准错误，因为标准错误是文件描述符 2。“&1”表示“无论你对文件描述符 1 做什么”。所以总而言之，这意味着“将标准输出转储到一个文件中，以及随之而来的标准错误”。

这种方法的一个优点是错误消息出现在正确的位置。例如，编译失败的文件的编译器错误消息将出现在您的 makefile 中的编译命令之后。

>>& 构造可能会将命令的输出附加到日志文件中，并将其置于后台。我不确定它对标准错误有什么作用。我刚刚咨询了 Bolsky/Korn 1989，它甚至不在那里，所以也许其他人可以解析它的作用。

**更新：**如果您的命令中有任何管道，那么随着产生错误的命令运行，早期阶段的标准错误将首先出现。由于只有标准输出通过管道路由，所以当整个管道完成时，它会立即出现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T16:57:28.100

您正在尝试在 ksh 中使用 csh 语法。见杰森的回答。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-30T22:05:17.320

对于附加：

```
ls -ld . fred 1>> no_fred 2>&1 
```

# c++ - 将 Windows 句柄传递给非托管 C++ dll

> ID：795297
> 
> 赞同：1
> 
> 时间：2009-04-27T21:10:43.367
> 
> 标签：c++, unmanaged, managed-c++

非托管 C++ dll 有一个导出函数，它采用 int 类型作为窗口句柄

```
void SetWindowHandle(int nHandle); 
```

否则，在非托管 dll 代码中，它`int`被强制转换为`HWND`并正确使用。

从 windows 窗体应用程序中，我将句柄设置如下

```
_hHandle = this->Handle.ToInt32();
m_pViewer->SetWindowHandle(_hHandle); 
```

`_hHandle`类中的私有成员在哪里。我的手柄正确吗？似乎是这样，但显然应用程序没有给出期望的输出。我怀疑问题出在手柄上。

PS：我可以访问非托管 dll，因此我可以在其中进行修改以进行任何建议的更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T21:30:33.883

从表面上看，并没有错。您还没有显示整个 .Net 声明。需要注意的一件事是调用约定需要匹配。DLL 的常用调用约定是*stdcall*，但这不是 C++ 中的默认设置。您必须要求它，通常使用`WINAPI`您在所有 Windows 标头中看到的宏。

既然您可以访问调用的双方，为什么不**使用调试器**来确定您是否正确获取句柄？设置断点并检查变量的值，或者将值打印到调试控制台或文件并检查结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-02-01T21:50:15.660

该问题是否与所使用的 CRT 库的不同副本有关？ [http://msdn.microsoft.com/en-us/library/ms235460%28v=VS.90%29.aspx](http://msdn.microsoft.com/en-us/library/ms235460%28v=VS.90%29.aspx)

# compression - 逆向工程：如何识别未知的压缩方法？

> ID：795300
> 
> 赞同：6
> 
> 时间：2009-04-27T21:11:32.087
> 
> 标签：compression, reverse-engineering, lzma, lzo, lzh

我和一群试图对蓝光播放器进行逆向工程和修改的模组制作者在一起。我们被卡住了，因为固件代码似乎被压缩了，而解压代码却无处可寻。据推测，解压缩由硬件处理。

我的问题是，只有压缩输出，我们如何确定使用什么类型的压缩算法？我们设法找到了一个重复的字符串，它可能对重复的数据进行了编码。

压缩后的 0x00 字节从 0x00 0x15 开始，然后是重复序列（F8 06 FC 03 7E 01 BF 00 DF 80 6F C0 37 E0 1B F0 0D）并在末尾发生变化。

[http://hej456.com/forum/viewtopic.php?t=832](http://hej456.com/forum/viewtopic.php?t=832)

我们的文档和努力在上面的线程中。固件二进制文件位于上面的线程中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T21:35:35.680

我建议查看硬件，看看它是否支持任何本机加密或压缩方案。我注意到加密是因为这样的字符串也是可能的；例如，任天堂 DS 使用 RSA 加密，我认为它在某种程度上是在硬件级别处理的，但不要引用我的话。

简而言之，查看硬件数据表（如果有）将是您最好的做法。我假设如果你能拿到固件，你也能查看硬件本身。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-06T09:25:39.730

我对此没有太多经验，但是您可以通过尝试分析功耗来进行侧信道攻击。我的一个好朋友这样做是为了能够破解一些 AES 加密。也许这会引导您找到解决方案：

[http://en.wikipedia.org/wiki/Power_analysis](http://en.wikipedia.org/wiki/Power_analysis)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-17T18:07:18.350

我知道这是一篇旧帖子，但这里有一个用 C# 编写的 DS 解压缩代码的链接。如果您实际上仍在尝试这种努力，也许它可以成为您黑暗中的前灯。

[DS DECOMPRESS：用于为任天堂游戏机/手持设备制作的游戏中常用的压缩格式的压缩器和解压缩器。](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=2&cad=rja&ved=0CCQQFjAB&url=http://code.google.com/p/dsdecmp/&ei=_vJ-UNSnMcnW2gXGr4Bg&usg=AFQjCNFSw2aMzoG_5nwZPIAVrmWSsSkVOQ&sig2=QiE9RK7hL_7lAkpEvAZwDA "DS 解压")

# dependency-injection - 依赖注入：将调用图与构造图分离

> ID：795309
> 
> 赞同：1
> 
> 时间：2009-04-27T21:13:49.477
> 
> 标签：dependency-injection, call-graph

我正在尝试练习[Dependency Injection 的原则](http://stackoverflow.com/questions/130794/what-is-dependency-injection)，但我在这样做时遇到了一些困难。

我有一个函数可以定期访问我的数据库，检索产品列表，然后针对这些产品运行一系列测试以确定它们的安全性。

如果发现一种或多种产品不安全，我需要通过实例化和调度`ProductRecall`对象来发出召回。

该函数看起来像这样：（伪代码）

```
void SafteyInspector::CheckProductSaftey()
{
  database.getProducts( list_of_products )

  foreach( list_of_products as p )
  {
    if ( !runBatteryOfTests( p ) )
      unsafe_products.insert( p );
  }

  if ( !unsafe_products.empty() )
  {
    ProductRecall * recall = 
          new ProductRecall( unsafe_products );  // Oh no!
    recall->dispatch();
  }
} 
```

问题是我在`ProductRecall`调用图的中间“新建”了一个对象。这违反了依赖注入的原则。如所写，我无法在`CheckProductSaftey()`不创建`ProductRecall`对象的情况下进行测试。

但是，我不能将`ProductRecall`对象传递给我的`SafetyInspector`对象，因为它`SafetyInspector`是确定不安全产品列表的人。

我正在对所有内容使用构造函数注入，并且我想继续这样做。另请注意，我可能`ProductRecalls`随时发出多个，因此我不一定只将单个`ProductRecall`对象传递给`SafetyInspector`at 构造。

有什么建议么？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T21:23:20.890

我认为您实际上需要变出某种方式`ProductRecallFactory`来代替。注入容器支持某种工厂风格的界面是相当普遍的，或者您可能只想让您的 SafetyInspector 容器感知。

编辑：通过“容器感知”，我指的是按照 COM 的线实现一些接口`IObjectWithSite`，以便您的对象可以回调其父对象。这是一种较弱的依赖注入形式，可以部分撤销控制反转。如果您手动进行依赖注入，请务必注入工厂对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T21:37:04.473

我认为问题可能出在您的`ProductRecall`. 具体来说，如果您可以调用`dispatch()`新创建的对象，则意味着许多实际功能要么隐藏在`ProductRecall`类中，要么`ProductRecall`类具有静态成员和/或单例以提供它所需的一切。

我建议创建一个名为的类`ProductRecallDispatcher`来处理实际调度的复杂性。然后，您将创建这些对象之一，并将其​​传递给`SafteyInspector`. 这将使您的`CheckProductSafety`函数如下所示：

```
void SafteyInspector::CheckProductSaftey()
{
  database.getProducts( list_of_products )

  foreach( list_of_products as p )
  {
    if ( !runBatteryOfTests( p ) )
      unsafe_products.insert( p );
  }

  if ( !unsafe_products.empty() )
  {
    recallDispatcher.recall( unsafe_products );
  }
} 
```

# python - 如何比较 Django QuerySet 中两个字段的值？

> ID：795310
> 
> 赞同：8
> 
> 时间：2009-04-27T21:13:51.567
> 
> 标签：python, django, model

我有一个这样的 Django 模型：

```
class Player(models.Model):
    name = models.CharField()
    batting = models.IntegerField()
    bowling = models.IntegerField() 
```

与以下 SQL 等效的 Django QuerySet 是什么？

```
SELECT * FROM player WHERE batting > bowling; 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-27T21:17:30.607

在 django 1.1 中，您可以执行以下操作：

```
players = Player.objects.filter(batting__gt=F('bowling')) 
```

有关详细信息，请参阅[另一个问题](https://stackoverflow.com/questions/433294/column-comparison-in-django-queries)

# java - 您如何使用一组精选的插件构建一个简单的 Eclipse 编辑器？

> ID：795312
> 
> 赞同：2
> 
> 时间：2009-04-27T21:14:20.503
> 
> 标签：java, eclipse, plugins

有没有人有一个教程来构建一个只有一组插件的自定义 Eclipse IDE？

我假设我需要： eclipse.exe 插件目录中的一些插件，功能目录中的一些文件夹。

我的目标是只包括基本的文本编辑器，也许还有其他几个实用程序。

（是的，我可以只使用记事本/文本板，但我正在研究一个项目，其中一个“更轻”版本的 Eclipse 会很有用）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T15:49:51.180

创建产品配置文件（新建 -> 其他 -> 插件开发 -> 产品配置）。

您可以将产品基于插件或功能（如果您想要两者，请使用功能，您将获得功能及其包含的插件）。您定义要在启动时启动的产品或应用程序，并且有启动屏幕和品牌的选项。

例如，您还可以创建一个新的插件项目，并在向导中对“您想创建一个富客户端应用程序”说“是”。然后，您可以选择一个模板。

您可以从 UI 导出此产品，它会自动为您处理包含可执行文件的操作。您也可以无头构建它（请参阅[帮助](http://help.eclipse.org/ganymede/index.jsp?topic=/org.eclipse.pde.doc.user/tasks/pde_product_build.htm)），这将需要 deltapack（[此处](http://download.eclipse.org/eclipse/downloads/drops/R-3.4.2-200902111700/download.php?dropFile=eclipse-3.4.2-delta-pack.zip)为 3.4.2 版本）来获取启动器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T21:22:56.270

Eclipse Rich Client Platform (RCP) 正是为此而设计的——构建基于 Eclipse 的应用程序，而不包括整个 IDE。

这里有[很多关于它的资源](http://wiki.eclipse.org/index.php/Rich_Client_Platform)

下面是一个[基于 RCP 的编辑器示例](http://www.eclipse.org/eclipse/platform-text/development/rcp/examples/index.html)

# c# - 负数向后看，空格数未知

> ID：795313
> 
> 赞同：2
> 
> 时间：2009-04-27T21:15:08.803
> 
> 标签：c#, regex

使用 c# 正则表达式，我试图匹配不在括号中的引号中的内容，同时也忽略任何空格：

```
"blah" - match
("blah") - no match
( "blah") - no match
(  "blah") - no match 
```

我有（未转义）：

```
"(?<=[^(]\s")(.*?)" 
```

它适用于前三个，但我不知道如何处理第一个括号和引号之间的多个空格。在 s 之后使用 + 是相同的结果，使用 * 意味着最后两个匹配。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T21:23:30.000

这应该有效：

```
/(?<![^(\s])\s*"([^"]*)"\s*(?![\s)])/ 
```

*   第一个`(?<![^(\s])`断言字符串之前没有空格或左括号。

*   然后`\s*`将匹配任意数量的空白字符。

*   `("[^"]*")`将匹配带引号的字符串，并捕获它的内容。

*   `\s*`将匹配任意数量的空白字符。

*   最后，`(?![\s)])`将断言后面没有空格或右括号。

它们一起确保所有空格都与 each 匹配`\s*`，并且它们不与括号相邻。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T21:20:20.240

据我所知，在 PCRE 中，lookbehinds 必须是固定宽度的。如果在 C# 的 PCRE 引擎中仍然如此，那么您将无法按照您尝试的方式进行操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T21:24:05.130

Look behinds 需要一个固定的宽度，但您可以使用下面的表达式到达那里。这假设没有嵌套。

```
/\G                 # from the spot of the last match
  (?:               # GROUP OF: 
     [^("]*           # anything but open-paren and double quote.
     [(]              # an open-paren
     [^)]*            # anything but closing-paren
     [)]              # a closing-paren
  )*                # any number of times 
  [^"]*             # anything but double quote

  "([^"]*)"         # quote, sequence of anything except quote, then ending quote
/x 
```

# haskell - 为什么这个 Haskell 代码会产生“无限类型”错误？

> ID：795317
> 
> 赞同：87
> 
> 时间：2009-04-27T21:16:38.580
> 
> 标签：haskell, types, type-inference

我是 Haskell 的新手，面临一个我无法理解的“无法构造无限类型”错误。

事实上，除此之外，我还没有找到一个很好的解释来解释这个错误的含义，所以如果你能超越我的基本问题并解释“无限类型”错误，我真的很感激。

这是代码：

```
intersperse :: a -> [[a]] -> [a]

-- intersperse '*' ["foo","bar","baz","quux"] 
--  should produce the following:
--  "foo*bar*baz*quux"

-- intersperse -99 [ [1,2,3],[4,5,6],[7,8,9]]
--  should produce the following:
--  [1,2,3,-99,4,5,6,-99,7,8,9]

intersperse _ [] = []
intersperse _ [x] = x
intersperse s (x:y:xs) = x:s:y:intersperse s xs 
```

这是尝试将其加载到解释器中的错误：

```
Prelude> :load ./chapter.3.ending.real.world.haskell.exercises.hs
[1 of 1] Compiling Main (chapter.3.ending.real.world.haskell.exercises.hs, interpreted )

chapter.3.ending.real.world.haskell.exercises.hs:147:0:
Occurs check: cannot construct the infinite type: a = [a]
When generalising the type(s) for `intersperse'
Failed, modules loaded: none. 
```

谢谢。

--

这是一些更正的代码和处理 Haskell 中“无限类型”错误的一般准则：

**更正的代码**

```
intersperse _ [] = []
intersperse _ [x] = x
intersperse s (x:xs) =  x ++ s:intersperse s xs 
```

**问题是什么：**

我的类型签名声明 intersperse 的第二个参数是*列表的列表*。因此，当我对“s (x:y:xs)”进行模式匹配时，x 和 y 变成**了 lists**。然而我将 x 和 y 视为元素，而不是列表。

**处理“无限类型”错误的指南：**

*大多数时候，当您遇到此错误时，您已经忘记了您正在处理的各种变量的类型，并且您试图使用一个变量，就好像它是其他类型一样。仔细查看所有内容的类型与您使用它的方式，这通常会发现问题。*

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-04-27T21:32:37.107

问题出在最后一个子句中，您将 x 和 y 视为元素，而它们是列表。这将起作用：

```
intersperse _ [] = []
intersperse _ [x] = x 
intersperse s (x:y:xs) = x ++ [s] ++ y ++ intersperse s xs 
```

发生无限类型错误是因为 : 运算符的类型为 a -> [a] -> [a]，而您将其视为 [a] -> a -> [a]，这意味着 [a] 必须与a，这意味着 a 是一个无限嵌套的列表。这是不允许的（无论如何，这不是你的意思）。

**编辑：**上面的代码中还有另一个错误。它应该是：

```
intersperse _ [] = []
intersperse _ [x] = x
intersperse s (x:xs) = x ++ [s] ++ intersperse s xs 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-03-22T23:53:11.820

通常添加显式类型定义可以使编译器的类型错误消息更有意义。但是在这种情况下，显式类型会使编译器的错误消息变得更糟。

看看当我让 ghc 猜测穿插的类型时会发生什么：

```
Occurs check: cannot construct the infinite type: a = [a]
  Expected type: [a] -> [[a]] -> [[a]]
  Inferred type: [a] -> [[a]] -> [a]
In the second argument of `(:)', namely `intersperse s xs'
In the second argument of `(:)', namely `y : intersperse s xs' 
```

这清楚地指向了代码中的错误。使用这种技术，您不必像其他人建议的那样盯着所有的东西仔细考虑类型。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-27T21:34:24.153

我可能是错的，但似乎你正在尝试解决一个更困难的问题。您的版本`intersperse`不仅将值与数组散布，而且还将其展平一层。

Haskell 中的`List`模块实际上提供了一个 intersperse 函数。*它在列表中的每个*元素之间放入给定的值。例如：

```
intersperse 11 [1, 3, 5, 7, 9] = [1, 11, 3, 11, 5, 11, 7, 11, 9]
intersperse "*" ["foo","bar","baz","quux"] = ["foo", "*", "bar", "*", "baz", "*", "quux"] 
```

我假设这是您想要做的，因为这是我的教授在我学习 Haskell 时希望我们做的。当然，我可以完全出局。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-27T13:36:29.830

我还发现[这](http://www.haskell.org/pipermail/haskell-cafe/2005-March/009314.html)解释了错误的含义。

每次解释器/编译器给我这个错误都是因为我使用了一些类型参数化的元组作为形式参数。**通过删除**包含类型变量的函数的类型定义，一切正常。

我仍然无法弄清楚如何修复它并保留函数类型定义。

# vmware - 强制 VMWare Workstation 6.5 运行 32 位主机

> ID：795326
> 
> 赞同：0
> 
> 时间：2009-04-27T21:19:40.100
> 
> 标签：vmware, virtual-machine

我使用的是 64 位 Vista，出于此问题范围之外的原因，我需要让 VMWare Workstation 作为 32 位进程运行。现在，当我运行 VMWare 时，它​​作为 64 位进程启动，我不知道如何让它作为 32 位进程运行。

如果重要的话，来宾操作系统是 Windows XP（32 位），但我怀疑它确实如此。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T21:38:59.523

好的，因为我们已经在评论中讨论了你**真正**想要做什么。我会回答这个问题。

首先，您最初的问题是：**“如何在 64 位 Windows 上运行 32 位 vmware 主机？”**

通过查看 VMware 站点和文档，没有迹象表明这是可能的。如果您**确实**需要这样做，请在 32 位版本的 windows 上运行它。

现在谈谈您实际尝试做的事情：您已经表明您已经编写了用于控制 VMware 进程的工具。执行此操作的正确 API 是[VIX API](http://www.vmware.com/support/developer/vix-api/)或使用 vmrun 应用程序（后者更多用于从 shell 编写脚本）。我假设 VIX。如果你正在使用这个。我想确保您拥有最新的 SDK 副本并重新编译您的应用程序应该允许它们与 64 位版本的 VMware 一起工作。

**编辑：**转到 VIX SDK 下载页面显示“VIX API for Window 32-bit and 64-bit”。这表明如果您使用该版本的 SDK，则最好使用 64 位 VMWare。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T23:54:49.917

最好的办法是在[VMware 论坛](http://communities.vmware.com/)上提问，在那里您可以直接从开发人员那里获得答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T00:15:47.137

我遇到了类似的问题。我在 64 位 Vista 上运行 VMWare，但我只能让 VMWare 加载 32 位操作系统。事实证明，在戴尔上，您必须进入 BIOS 才能将“虚拟化”设置为 32 位或 64 位。不确定您使用的是哪种硬件，但请检查 BIOS 以查看您是否具有相同的设置。它根本不会影响基本操作系统，只会影响虚拟操作系统。

# perl - 如何在 Perl 中处理俄语文本？

> ID：795327
> 
> 赞同：1
> 
> 时间：2009-04-27T21:20:16.620
> 
> 标签：perl, utf-8

我对用任何非英语语言做任何事情都是新手。到目前为止，我唯一做过的编程就是输入基本的英文字母+数字并输出。现在我必须处理一些俄语文本（尤其是来自俄语维基百科页面），但我不知道从哪里开始。我用谷歌和谷歌搜索，但我得到的只是关于 unicode、UTF-8 和其他东西的结果，但这些对我来说没有意义，因为我不确定它们指的是什么。维基百科条目本身似乎是为已经了解这些内容的人编写的。

谁能指出我一个好的起点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-27T21:22:46.287

看来您应该首先了解 Unicode 是什么。Joel Spolsky 的文章[The Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses!)](http://www.joelonsoftware.com/articles/Unicode.html)可能是一个很好的起点（不过，对于有经验的人来说，它提供的信息非常少）。

之后，您应该了解 Perl 如何处理 Unicode，例如查看[Perl Unicode 教程](http://perldoc.perl.org/perlunitut.html)。

# javascript - 返回不在函数中

> ID：795337
> 
> 赞同：10
> 
> 时间：2009-04-27T21:22:03.840
> 
> 标签：javascript, firebug

Firebug 报告没有位置的“return not in function”错误（嗯，没有任何内容的第 1 行）。如何追踪此错误的来源？

```
return not in function
[Break on this error] return(0)
javascript:return... (line 1) 
```

我在 Ubuntu 上的 FF 2.0.0.20 上运行 FireBug 1.05。

我找到了一个可行的**解决方案**（对于这个配置）：

```
 var link = document.createElement('a');
  link.href='/';
  if (childSummary.more) {
    link.onclick = capture(function(id) { follow(id); }, childSummary.id);
  } else {
    link.onclick = capture(function(id) { show(id); }, childSummary.id);
  }
  link.appendChild(document.createTextNode(name));
  div.appendChild(link);

  [...]

 function capture(fn, val) {
   return function() { fn(val); return false; };
 } 
```

代码在一个循环中，其中 id 正在更改，因此需要捕获函数。

以前href是'javascript：return 0'，捕获函数不是直接返回false，而是使用fn的结果，当它返回true时有一个路径。正在评估 href 导致错误。

将 href 定义为 '#' 或 '' 会导致所有链接都显示为已访问过。根本没有定义 href 导致没有链接突出显示。这似乎是最简单的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T21:27:49.723

我认为“javascript：return ...”很能说明问题。我相信您正在尝试在`href`锚点的属性中返回一个值，如下所示：

```
<a href="javascript: return false">Test</a> 
```

Firebug 没有告诉您位置的原因是它不在任何 JavaScript 中，而是在 DOM 中的单行中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T21:33:17.870

Javascript 返回错误，因为 return 语句不在函数内部。造成这种情况的一个可能原因是函数定义不正确，例如：

```
myFunc() { some code; return; } 
```

正确的代码定义是：

```
function myFunc() { some code; return; } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T21:26:30.723

我会冒险猜测这意味着您有一个额外的右大括号，或者缺少一个左大括号。

您的代码库是否过于庞大，无法围绕您的每个返回函数进行抽查？您是否有一个 IDE 可以为您突出显示匹配的大括号？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-31T09:23:24.593

我在firebug的控制台窗口中输入时得到了这个。我编写了一个 for 循环来搜索列表中的某些内容，不要尝试在其中返回一个值 - 只需将其分配给一个变量，您就可以在控制台中看到对象/值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-07T20:51:40.633

Daniel Lew 为 dougfelt 提供了答案，但其他遇到此错误的人也应该注意任何不在函数中的 return 语句。例如：

```
<script type="text/javascript">
    alert("I'm JavaScript!");
    return false;
</script> 
```

`return false;`在任何函数之外，并且会导致此错误。

# sql - COUNT CLAUSE 中的 SQL CASE STATEMENT

> ID：795341
> 
> 赞同：5
> 
> 时间：2009-04-27T21:23:09.483
> 
> 标签：sql, join, count, case

我正在尝试从两个单独的表中获取产品的名称及其销售数量。

我的表看起来像这样：

```
BOOK
Book_ID | Book_Title | Book_Author  

SOLD  
Transaction_ID | Book_ID | Customer_ID 
```

我可以从以下查询中获得我想要的大部分结果

```
SELECT b.Book_Title, COUNT(s.Book_ID) FROM Book b, Sold s 
WHERE b.Book_ID = s.Book_ID 
GROUP BY b.Book_Title; 
```

但是，这只显示至少有一次销售的产品。我想显示所有产品，如果没有发生销售，只需显示零。我一直在搞乱这样的事情：

```
SELECT b.Book_Title, 
       COUNT(CASE WHEN s.Book_ID IS NULL THEN 0 ELSE s.Book_ID END) 
FROM Book b, Sold s WHERE b.Book_ID = s.Book_ID GROUP BY Book_Title; 
```

但是该`WHERE`条款将结果限制为具有 1 个或更多销售额的结果。

任何人都可以提出解决这个问题的方法吗？我正在使用 Oracle 10g。

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-27T21:26:56.700

使用左外连接：

```
SELECT b.Book_Title, COUNT(s.Book_ID) 
FROM Book b left outer join Sold s on b.Book_ID = s.Book_ID 
GROUP BY b.Book_Title; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T23:07:16.240

您还可以在`select`子句中使用相关子查询：

```
select b.book_title, (select count(*) from sold s where s.book_id=b.book_id) from book b 
```

它不需要`group by`or `outer join`，这对于非常多的行可能会很慢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T21:28:28.053

正如@Vincent 所说，您需要一个外部联接。我最近与 Oracle 合作不多，但它专有的外连接语法相当奇怪。（我不知道他们是否在这方面赶上了 ANSI。）

专有语法是：

```
 SELECT b.Book_Title,
         COUNT(s.Book_ID)
    FROM Book b,
         Sold s
   WHERE b.Book_ID = s.Book_ID (+)
GROUP BY b.Book_Title; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T21:29:51.153

您应该在子查询中获取计数并对其进行左外连接：

```
select b.book_title, 
   case when s.book_id is null then 0 
       else s.salesCount end as Sales
from book b
left outer join 
  (select count(*) as salesCount, book_id from sales group by book_id) s on b.book_id = s.book_id 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-27T21:27:01.863

从书到售出另一个连接。你可能仍然会得到一个空值，但你可以通过在上面添加一个 NVL 来解决这个问题......

# ruby-on-rails - 应达、Rails 测试和自动测试

> ID：795345
> 
> 赞同：2
> 
> 时间：2009-04-27T21:23:39.547
> 
> 标签：ruby-on-rails, unit-testing, automated-tests, shoulda, autotest

我正在尝试按照 Thougtbot 家伙所做的出色工作来模拟我的测试。他们似乎使用 Rails Shoulda 内置的测试框架。伟大的。

我听说过很多关于 Autotest 的事——它的神奇性应该让事情变得更容易......我希望如果我安装它，事情会“正常工作”。我的 rake 测试：单位已经全部通过。当我运行自动测试时，没有任何反应。我几乎没有找到任何关于自动测试如何工作的信息，并且只简要提到了一个特殊的文件“.autotest”，它应该做的事情除了满足咆哮和红绿的要求。

我来自这里的 CruiseControl 背景......但看起来事情应该更加明显。有人有运行 Rails 的原生测试以及 Shoulda 和 Autotest 的经验吗？

**更新|**显然解决了 seed-fu 中的 discover.rb 文件让 autotest 认为它正在测试 RSpec，而不是 Test::Unit。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T15:43:46.343

我正在使用的一个插件，seed-fu，有一个 discover.rb 来“帮助”自动测试。就我而言，尽管它使自动测试认为我正在运行 RSpec，但其他一切都坏了。

# search - Google 通配符运算符 (*)

> ID：795350
> 
> 赞同：2
> 
> 时间：2009-04-27T21:25:25.533
> 
> 标签：search

我正在使用 google ajax rest api，我想通过前缀获取本地结果。例如：我输入“sta”，得到“starbucks”。

我想知道是否有记录或未记录的通配符运算符可以让您找到以字符串*开头的结果。*

我知道谷歌确实有一个通配符运算符，但它是逐字地工作的。像这样：星巴克 * => 星巴克咖啡

以下是 Google 搜索运营商的列表，它们都不提供启动功能：[http](http://www.google.com/support/websearch/bin/answer.py?hl=en&answer=13) ://www.google.com/support/websearch/bin/answer.py?hl=en&answer=13 ...

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T22:58:02.267

您正在寻找的是用于本地搜索的 Google Suggest API。鉴于似乎没有官方的 Google Suggest API，您不太可能找到用于本地搜索的 API。但是，有很多产品（包括 Firefox 和 Google 工具栏）使用 Google Suggest，所以他们使用的方法可能不会消失。快速搜索 Suggest API 会发现许多由不同人组合而成的解决方案。我建议您选择一个看起来很合适的并尝试使其与本地搜索一起使用（如果这实际上会产生不同的结果）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T22:47:35.867

可能不是您想听到的答案，但我有理由确定您想要做的事情不受支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-04T17:42:53.933

您可以在标准搜索框中将多个通配符串在一起，例如 star* * *，其中将其括在引号中可能会进一步获得您想要的短语，例如“star* * location*”。

或者，您可以使用 AROUND() 搜索过滤器 [全部大写] 找到一些成功，例如，star* AROUND() 位置。AROUND() 过滤器还接受一个包含性的数字过滤器，例如“star* AROUND(3) location*”，它将返回任何以 star 开头并且在 location、locations 等三个或更少的单词内的单词。

相比之下，* 表示特定数量的空格，例如星* * * 位置，其中星距位置正好三个项，但不是一个或两个位置或远离。star* AROUND(3) location 将返回 star 和 location 相距三个或更少的结果。

YMMV 关于这些高级 Google 搜索过滤器是否可以用作 API 查询的一部分。

# external - 为什么我会得到：无法解析的外部符号错误 - C

> ID：795361
> 
> 赞同：1
> 
> 时间：2009-04-27T21:27:54.327
> 
> 标签：external, symbols

我尝试编译这段代码：

```
static uint64_t
push(int fd, SOCKET sock, SSL *ssl, const char *buf, uint64_t len)
{
    uint64_t    sent;
    int     n, k;

    sent = 0;
    while (sent < len) {

        /* How many bytes we send in this iteration */
        k = len - sent > INT_MAX ? INT_MAX : (int) (len - sent);

        if (ssl != NULL) {
            n = SSL_write(ssl, buf + sent, k);
        } else if (fd != -1) {
            n = write(fd, buf + sent, k);
        } else {
            n = send(sock, buf + sent, k, 0);
        }

        if (n < 0)
            break;

        sent += n;
    }

    return (sent);
} 
```

我得到这个链接器错误： Linking...
mongoose.obj : error LNK2019: unresolved external symbol _send@16 referenced in function _push

我错过了什么？它必须是一些库或其他东西。我只是不记得我需要在链接中添加什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T21:32:54.483

问题是链接器找不到该`send()`函数。您已经包含了正确的头文件，所以编译器没问题，但是您没有链接到正确的静态库。打开您的项目设置，转到链接器部分，并将适当的库添加到链接的库列表中。

**[编辑]**

要添加的正确库是`wsock32.lib`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T21:32:08.013

目前尚不完全清楚您实际上在问什么问题。但看起来您的链接器在被告知要查看的任何地方都找不到“发送”功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T21:32:11.647

与正常错误的区别在于您需要使用链接器，而不是编译器和代码编辑器来解决它。

# iphone - UITable 第一部分包含一个

> ID：795368
> 
> 赞同：1
> 
> 时间：2009-04-27T21:30:10.200
> 
> 标签：iphone

所以，如果这有助于澄清，我可以提供一张图片。

我目前有一个包含很多行的 UITableView。表格的第一行是一个搜索栏。太好了，工作正常。

我刚刚在表格中显示的每个部分之前添加了“普通”索引、字母标题。我还添加了最正确的索引，以便快速跳转到任何部分。

但是，由于 UISearchBar 在绘制 UISearchBar 时是表格的一部分（第一个元素），因此它会将 UISearchBar 推过一点，将其压扁。看起来很傻。一种选择是不使 UISearchBar 成为表格的一部分，但我没有其他地方可以放置它。

知道如何获得最正确的索引来坐在 UISearchBar 上吗？

谢谢，

*   sk

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T02:29:32.523

我通常最终从 UITableViewController 子类开始，然后最终将其转换为普通的 UIViewController 子类，因此 UITableView 只是更复杂的视图的一部分。只需使用顶部的搜索栏创建一个视图，表格占据其余空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T22:10:22.523

你试过把它放到tableView.tableHeaderView中吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T12:37:06.747

我不确定您所说的“将其推过一点”是什么意思，但是您可以通过使用委托方法来调整行的高度

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath 
```

这可能会让你有更多的玩耍空间。您还可以查看单元格相对于自身绘制 UISearchBar 的位置，并且可能也很漂亮。

但是，我也建议使用带有 tableView 和 searchView 的 ViewController。此外，如果您是 3.0 开发人员，您可能想查看一些新的搜索 UI。

# ruby-on-rails - 如何检查给定的@current_user 是否已经写过“评论”？

> ID：795376
> 
> 赞同：0
> 
> 时间：2009-04-27T21:32:32.613
> 
> 标签：ruby-on-rails

对于我的模型供应商：

```
:has_many Review 
```

和每个用户：

```
:has_many Review 
```

每条评论：

```
:belongs_to Vendor
:belongs_to User 
```

所以。我没有一个用户可以写多个评论，所以我想检查 vendor/:vendorId URL 这是“显示”操作，并有办法进行“写评论”按钮消失或出现取决于@current_user 是否已经为该特定供应商撰写了评论。

我知道@vendor.id 和@loggedin_user.id 但不确定如何查找两个参数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T22:26:37.693

有很多方法可以做到这一点。如果你只想找到两个参数，你可以这样做：

```
Review.find(:first, :conditions => {:user_id => @user.id, :vendor_id => @vendor.id}) 
```

您还可以使用关联，如下所示：

```
@current_user.reviews.find(:first, :conditions => {:vendor => @vendor}) 
```

named_scope 将是另一种方式：

```
class Review < ActiveRecord::Base
  named_scope :for_vendor, lambda {|vendor| 
    {:conditions => {:vendor => vendor}}
  }
  belongs_to :vendor
  belongs_to :user
end

@current_user.reviews.for_vendor(@vendor).empty? 
```

由于这是一个业务规则，我建议将此逻辑封装在 User 或 Vendor 的方法中，例如：

```
def can_review?(vendor)
  self.reviews.find(:first, :conditions => {:vendor => @vendor}).nil?
end 
```

然后，您可以在视图中执行以下操作：

```
<%= review_vendor_button if @current_user.can_review?(@vendor) %> 
```

# c# - 如果有的话，使用 System.Diagnostics.Stopwatch 的资源损失是多少？

> ID：795377
> 
> 赞同：10
> 
> 时间：2009-04-27T21:32:34.173
> 
> 标签：c#, .net, performance, stopwatch

例如

```
foo() //Some operation bound by an external resource. db,I/O, whatever. 
```

对比

```
var watch = new Stopwatch();
watch.Start();
foo()
var time = watch.ElapsedMilliseconds
watch.Stop(); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-27T21:34:42.780

我相信 Stopwatch 是建立在 QueryPerformanceCounter 之上的，因此每次调用都会导致内核转换。如果 foo() 非常简短，QPC 开销将使其相形见绌。

如果您使用 Stopwatch 来测量短任务，您应该运行 foo() 多次（如数千次），并在整个批次中使用 Stopwatch。将总时间除以运行次数以获得任务的平均时间。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T21:35:46.570

这听起来像是一个递归的答案，但真正了解秒表惩罚的唯一方法是测量它。测量托管代码通常涉及 Stopwatch 实例。

秒表仅用于诊断目的，不应在零售应用程序中使用。当然，除非您处于诊断模式。因此，对于非诊断代码来说，这真的不应该是一个问题。您能否提供一些有关您的场景的见解，以便我们提供更好的答案？

秒表实例（通常）构建在 QueryPerformanceCounter 调用之上。这些不是免费的，但也不是很贵。任何值得用秒表测量的任务都将是一个足够长的运行任务，任务的成本将使 QueryPerformanceCounter 调用微不足道。否则，你为什么要测量它？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T21:42:32.607

根据我的经验，使用该类*时*会有一些明显的开销。`Stopwatch`当然比使用`Environment.TickCount`或这样来测量时间要多得多，但仍然不是*太大*。但是，这对您来说可能是也可能不是大问题。如果被测量的时间段通常很短（使用 时通常应该是这种情况`Stopwatch`，因为其他方法同样适用于更长的时间段），那么我想，性能应该不会受到明显的影响。此外，[本页](http://www.dotnetperls.com/stopwatch)的末尾还有一些关于在程序中运行 a 的成本`Stopwatch`。（但不确定我是否会接受关于使用它进行持续程序监控的建议。）

# javascript - 谷歌地图地理编码问题

> ID：795388
> 
> 赞同：2
> 
> 时间：2009-04-27T21:35:45.040
> 
> 标签：javascript, google-maps, maps, geocoding

我第一次玩谷歌地图。而且我正在努力提取有关标记所在位置的一些信息。

我已经设置了一个示例供您查看。当我拖动 A 节点时出现问题，getGeocode() 返回未定义？

当我拖动节点时，我需要从节点中提取邮政编码、城市和地址。

请参阅[http://dev.korebogen.dk/gmap/](http://dev.korebogen.dk/gmap/)

提前致谢！

**更新**

我从响应中编辑了我的代码 - 现在我得到了两个地址（仍然需要剥离它以便我在单独的变量中获取信息）但由于某种原因我的方向输出结果是“0”和“1”（数组）我真的需要反向地理编码吗？

是否可以在地图上进行单击事件以添加 A 和 B 标记（如果加载时没有方向？）[http://dev.korebogen.dk/gmap/](http://dev.korebogen.dk/gmap/)已更新！

它来自：

```
var param = i + "@" + newMarkers[i].getLatLng().y + "," + newMarkers[i].getLatLng().x; 
```

这是更新的部分：

```
GEvent.addListener(newMarkers[i], "dragend", function() {
            var points = [];
            for (var i = 0; i < newMarkers.length; i++) {
                var param = i + "@" + newMarkers[i].getLatLng().y + "," + newMarkers[i].getLatLng().x;
                //points[i] = newMarkers[i].getLatLng();
                points.push(param);
                if (!i) {
                    var x = new GClientGeocoder();

                    x.getLocations(newMarkers[0].getLatLng(), function(addresses) {
                        if (addresses.Status.code == 200) {
                            var address = addresses.Placemark[0].address;
                            document.getElementById("start").innerHTML = address;
                        }
                    });

                    x.getLocations(newMarkers[1].getLatLng(), function(addresses) {
                        if (addresses.Status.code == 200) {
                            var address = addresses.Placemark[0].address;
                            document.getElementById("end").innerHTML = address;
                        }
                    });
                }
            }
            gdir.loadFromWaypoints(points);

        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T23:34:31.963

您正在尝试将位置转换为地址，通常称为“反向地理编码”。

[请参阅此处](http://googlegeodevelopers.blogspot.com/2008/10/geocoding-in-reverse.html)的示例代码。

简而言之，您应该调用 GClientGeocoder.getLocations 而不是调用[getGeocode](http://code.google.com/apis/maps/documentation/reference.html#GClientGeocoder.getLocations)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T00:26:05.020

这里的问题是，您从 loadFromWaypoints 请求返回的对象没有填充您在 onGDirectionsLoad() 中请求的所有成员。如果您查看您的 javascript 错误日志，您将看到：

错误：gdir.getRoute(0).getStartGeocode().AddressDetails.Country 未定义

好的，根据谷歌文档，来自 loadFromWaypoints 和 GClientGeodcoder 的响应应该是相同的。

我冒昧地对[您的样本进行了一些测试，](http://www.cannonade.net/geo.html)突然发现反应不一样了。如果您查看[http://www.cannonade.net/geo.js](http://www.cannonade.net/geo.js)，您会看到我对 GClientGeocoder 请求和第一个标记的响应进行了字符串化，它们非常不同。所以你需要做几件事：

*   检查您的回复以确保您不会收到未填充结果的 javascript 错误：

    if ('AddressDetails' in resp)

*   对每个标记点执行 GClientGeocoder 请求以获取完整的地址信息。我的样本为第一个标记执行此操作。

# c++ - LoadLibrary 失败：第一次机会异常 0xC0000139（未找到 DLL） - 如何调试？

> ID：795391
> 
> 赞同：5
> 
> 时间：2009-04-27T21:37:25.550
> 
> 标签：c++, exception, dll, loadlibrary

我有一个 dll “mytest.dll”，当通过 加载时`LoadLibrary()`，返回 NULL（和 127 作为`GetLastError()`）。如果我在“mytest.dll”上使用 DependencyWalker，它会报告它应该正确加载并且正确找到所有 DLL。在主机 exe 上运行 DependencyWalker 的探查器选项会在日志中为我提供以下相关部分：

```
00:00:55.099：由线程 0xBBC 在地址 0x07860000 加载“mytest.DLL”。成功挂接模块。
00:00:55.115：线程 0xBBC 在地址 0x76E24285 的“NTDLL.DLL”中发生第一次机会异常 0xC0000139（未找到 DLL）。
00:00:55.115：线程 0xBBC 在地址 0x07860000 处卸载了“mytest.DLL”。
00:00:55.115：LoadLibraryW("mytest.dll") 由线程 0xBBC 返回 NULL。错误：找不到指定的过程 (127)。

```

有没有办法调试它以找出 NTDLL.DLL 报告的 DLL Not Found 消息试图寻找什么？还是我应该在别处寻找问题的根源？

请注意，从另一个应用程序加载相同的“mytest.DLL”似乎可以正常工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T21:42:44.210

使用SysInternals 中的[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)或[FileMon](http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx)可能会为您提供有关 myTest.dll 是否根本不在寻找它的位置的线索。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T21:51:31.977

您的应用程序是否会在未找到的初始加载（可能）之后尝试通过 GetProcAddress 调用特定的 DLL 函数？它是 32 位还是 64 位应用程序？

如果它按照您的建议在另一个应用程序中正确加载，那么它可能有一个正确的入口点。

快速的[谷歌搜索](http://www.google.com.au/search?hl=en&client=firefox-a&rls=org.mozilla%3Aen-GB%3Aofficial&q=0xC0000139+DLL+Not+Found&btnG=Search&meta=)表明，您返回的错误代码可能来自 DLL 中缺少的函数名称（或特定函数的序数值）。我建议在[Exescope](http://hp.vector.co.jp/authors/VA003525/emysoft.htm)之类的东西中打开 DLL并检查导出列表。

它还可以解释为什么 DLL 与另一个应用程序一起工作（也许另一个应用程序在 DLL 中使用不同的导出函数）？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T23:13:15.727

DependencyWalker 显示隐式依赖项（Windows 加载程序自动处理的依赖项）。您使用 LoadLibrary 加载的 DLL 是显式依赖项，而 DependencyWalker 无法找到它们（例如，库名称可能是从 ini 文件中读取的，而 DependencyWalker 无法推断出这一点）。

DLL 在一个应用程序中工作而不在另一个应用程序中工作一点也不稀奇。在最常见的情况下，一个应用程序已经加载了所需的 dll，而另一个没有。如果 dll 不在路径上，则您的 dll 将在第一种情况下工作，而不是在第二种情况下工作。

无论如何，请按照 Michael Burr 的建议使用 FileMon。尽管 SysInternals 网站说 FileMon 已经过时，但它仍然比 ProcMon 更容易使用。

# jquery - Internet Explorer 和非常奇怪的 iFrame 行为案例

> ID：795394
> 
> 赞同：5
> 
> 时间：2009-04-27T21:39:20.583
> 
> 标签：jquery, html, css, iframe

在我正在开发的带有窗口系统的 Internet Explorer 中，我遇到了一个真正的……*奇怪的错误。*基本上，窗口是绝对定位的 div，其中包含 ah iFrame，显示它们的页面并与它们一起调整大小。在所有其他浏览器中，这可以正常工作，但在 IE 中，iFrame 没有正确显示。

我生成新窗口的原始代码如下所示：

```
function spawnNewWindow(url, title, type)
{
    //Does another window with that particular type already exist?
    //If so, just point it at the new link without actually spawning a new window.
    var cancelSpawn = false;
    if ( $('.windowType_'+type).length )
    {
        //Update the SRC attribute for the iframe contained within the window. This should effectively
        //reload the window too.
        $('.windowType_'+type).children("iframe").attr("src", "/darknova4/"+url);
    } else {

    //First, create the window
    $("body").append(
    "<div class='window'> \
    <div class='resizeArea'></div> \
    <div class='titlebar'>"+title+"</div> \
    <div class='closeWindow'></div> \
    <div class='windowContent newspawn'><iframe src='/darknova4/"+url+"' frameborder='0' width='100%' height='100%' scrolling='auto'></iframe></div> \
    </div>");

    //Move this window to the top of the stack
    $(".newspawn").parent(".window").css("z-index", windowZIndex++);

    //Set the data for this window's type, will be used to prevent copy windows being open later
    $(".newspawn").addClass("windowType_"+type);

    //Set up the window for moving and resizing and other stuff
    setupWindows();

    //Finally, remove the "newspawn" flag from the window, since it has content and we don't need work with it anymore.
    $(".newspawn").removeClass("newspawn");

    }
} 
```

在 Internet Explorer 上，这会产生一个空白的白色窗口，这表示一个不可见的 iFrame，因为我所有的窗口页面都有黑色背景。我怀疑著名的（但仍未完全修复）z-index 错误，因此我进行了以下更改以使用堆叠顺序并查看是否可以找到快速修复：

```
$("body").append(
"<div class='window'> \
<div class='resizeArea'></div> \
<div class='titlebar'>"+title+"</div> \
<div class='closeWindow'></div> \
<div class='windowContent newspawn'><iframe style='position: relative;' src='/darknova4/"+url+"' frameborder='0' width='100%' height='100%' scrolling='auto'></iframe></div> \
</div>"); 
```

注意相对位置，这*应该*是对象的默认值，但不是因为堆叠错误。这段代码会发生什么，窗口出现，iFrame 出现，一切看起来都很好，直到你尝试使用它。我无法解释原因，但是**将鼠标悬停在 iFrame 上**会导致它*消失*。我在网站上没有与鼠标移动事件相关的代码，在 iFrame 的页面上也没有代码会导致它在鼠标悬停时执行任何操作。这真的很奇怪。有没有人知道它为什么会这样？

如果您需要亲自查看此行为，我已经在 www.darknovagames.com 上对系统进行了测试，该系统在 Firefox 中运行良好，但如前所述，在 IE 中确实很奇怪。如果您认为有帮助，我可以发布更多代码，但这是我认为错误所在。也就是说，我很乐意在父窗口上发布 CSS 和鼠标事件的 JavaScript 等。

感谢任何可以对这种奇怪行为提供一些见解的人。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-27T23:26:26.600

尝试`position: relative`从 iframe 内的 HTML 元素中删除。这似乎解决了 IE8（以及 IE8 的兼容模式）中的问题。

**更新：修复高度问题**

添加到 iframe 修复了IE7 和 IE8`position: absolute; left: 0px; top: 0px; bottom: 0px; right: 0px;`中上述更改导致的高度问题。`position: relative`

通过这两个修复程序，iframe 似乎在我的机器上模拟 IE7 的 IE7、IE8 和 IE8 中正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T07:04:04.750

我认为这在某种程度上与 MS IE 中的垫片技术问题有关。

IFRAME 是无窗口元素，因此 IFRAME 的 z-index 可能与轮廓 DIV z-index 不同步。

请参阅 [http://support.microsoft.com/default.aspx?scid=http://support.microsoft.com:80/support/kb/articles/q177/3/78.asp&NoWebContent=1](http://support.microsoft.com/default.aspx?scid=http://support.microsoft.com:80/support/kb/articles/q177/3/78.asp&NoWebContent=1)了解更多信息。

也请看[这个](http://dotnetjunkies.com/WebLog/jking/archive/2003/07/21/488.aspx)。

（无法正确显示带有名称的 MS KB 链接，可能是 SO 中的错误）。

# haskell - Haskell 缺点运算符 (:)

> ID：795397
> 
> 赞同：10
> 
> 时间：2009-04-27T21:39:49.243
> 
> 标签：haskell, functional-programming, operators

我对 Haskell 真的很陌生（实际上我从 O'Reilly 看到“Real World Haskell”并想“嗯，我想我会在昨天学习函数式编程”）我想知道：我可以使用构造运算符添加一个项目到列表的开头：

```
1 : [2,3]
[1,2,3] 
```

我尝试制作我在书中找到的示例数据类型，然后使用它：

```
--in a file
data BillingInfo = CreditCard Int String String
| CashOnDelivery
| Invoice Int
deriving (Show)

--in ghci
 $ let order_list = [Invoice 2345]
 $ order_list
[Invoice 2345]
 $ let order_list = CashOnDelivery : order_list
 $ order_list
[CashOnDelivery, CashOnDelivery, CashOnDelivery, CashOnDelivery, CashOnDelivery, CashOnDelivery, CashOnDelivery, CashOnDelivery, CashOnDelivery, CashOnDelivery, CashOnDelivery, CashOnDelivery, CashOnDelivery, CashOnDelivery, ...- 
```

等等......它只是永远重复，这是因为它使用了*惰性*评估吗？

**- 编辑 -**

好的，所以让 order_list = CashOnDelivery:order_list 不会将 CashOnDelivery 添加到原始 order_list 然后将结果设置为 order_list，而是递归并创建一个无限列表，永远将 CashOnDelivery 添加到开头本身。当然，现在我记得 Haskell 是一种函数式语言，我无法更改原始 order_list 的值，那么对于简单的“将其添加到此列表的末尾（或开头，无论如何）我该怎么办？” 制作一个以列表和 BillingInfo 作为参数的函数，然后返回一个列表？

**-- 编辑 2 --**

好吧，基于我得到的所有答案以及无法通过引用和变异变量传递对象（例如我习惯的）......我想我只是过早地问了这个问题，而且我真的需要进一步研究函数范式，然后才能真正理解我的问题的答案......我想我正在寻找的是如何编写一个函数或其他东西，获取一个列表和一个项目，然后返回一个同名列表，因此可以多次调用该函数，而无需每次都更改名称（好像它实际上是一个将实际订单添加到订单列表的程序，用户不必考虑每次列表的新名称，而是将一个项目附加到同一个列表中）。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-27T22:07:35.837

你来做这件事：

```
$ let order_list = [Invoice 2345]
$ let order_list = CashOnDelivery : order_list 
```

这里要注意的重要一点是，您*不*只是将`CashOnDelivery`项目添加到您的第一个`order_list`. 您正在定义一个`order_list`与第一个变量无关的新变量。这是一个递归定义，`order_list`右侧的 是指`order_list`您在左侧定义的，而不是上一行中定义的。由于这种递归，您会得到一个无限列表。

我怀疑你真的想做这样的事情：

```
$ let order_list = [Invoice 2345]
$ order_list
[Invoice 2345]
$ let order_list2 = CashOnDelivery : order_list
$ order_list2
[CashOnDelivery, Invoice 2345] 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-28T02:03:15.943

*作为一名正在康复的 ML 程序员，我一直*被这个人抓住。这是 Haskell 中为数不多的烦恼之一，您不能轻易地在`let`or`where`子句中重新绑定名称。如果要使用`let`or `where`，则必须发明新名称。在顶层的 read-eval-print 循环中，如果你想一次绑定一个名字，你别无选择。但是如果你愿意嵌套构造，你可以滥用`do`标识单子的符号：

```
import Control.Monad.Identity

let order_list = runIdentity $ do
       order_list <- return [Invoice 2345]
       order_list <- return $ CashOnDelivery : order_list
       return order_list 
```

是的，这段代码是卑鄙的——对于这个例子来说不值得——但如果我有一个很长的重新绑定列表，我可能会求助于它，这样我就不必在同名上发明 5 或 6 个无意义的变体.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-27T22:07:03.483

**回答问题编辑：**

> 那么对于一个简单的“将其添加到此列表的末尾（或开头，等等）”，我应该怎么做？制作一个以列表和 BillingInfo 作为参数的函数，然后返回一个列表？

啊，但是已经有一个“函数”用于将元素添加到列表之前：它是 cons`(:)`构造函数:-)

因此，只要您不对两个不同的变量使用相同的名称，您现有的代码就可以正常工作，因为第二个名称绑定将隐藏（隐藏）第一个。

```
ghci> let first_order_list = [Invoice 2345]
ghci> first_order_list
[Invoice 2345]
ghci> let second_order_list = CashOnDelivery : first_order_list
ghci> second_order_list
[CashOnDelivery, Invoice 2345] 
```

* * *

**关于第二次编辑：**

既然你问你如何在实际程序中做这样的事情，我会这样说：

如果您反复将内容添加到列表中，您不想每次都为该列表发明新名称。但是这里的关键字是“重复”，在命令式编程中你会在这里使用一个循环（并在循环中修改一些变量）。

因为这是函数式编程，所以不能使用循环，但可以使用递归。下面是我如何编写一个允许用户输入订单并收集列表的程序：

```
main = do
  orderList <- collectBillingInfos
  putStrLn ("You entered these billing infos:\n" ++ show orderList)

collectBillingInfos :: IO [BillingInfo]
collectBillingInfos = loop []
  where
    loop xs = do
      putStrLn "Enter billing info (or quit)"
      line <- getLine
      if line /= "quit"
        then loop (parseBillingInfo line : xs)
        else return xs

parseBillingInfo :: String -> BillingInfo
parseBillingInfo _ = CashOnDelivery -- Don't want to write a parser here 
```

回顾一下；该`loop`函数递归调用自身，每次都会向列表中添加一个新元素。直到用户输入“退出”，它才会停止调用自己并返回最终列表。

* * *

**与惰性评估有关的原始答案：**

正如其他人所说，这是一个递归定义，创建了一个仅包含值`order_list`的无限列表。`CashOnDelivery`虽然惰性评估不是它的原因，但它确实使它有用。

由于惰性评估，您可以`order_list`像这样使用：

```
ghci> take 3 order_list
[CashOnDelivery, CashOnDelivery, CashOnDelivery] 
```

如果您没有惰性评估，则调用`take`会崩溃，因为它会首先尝试评估`order_list`（这是无限的）。

现在，因为`order_list`这并不是真的有用，但是还有许多其他地方能够使用无限（或非常大）数据结构进行编程非常方便。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-27T21:52:03.720

是的，您正在尝试打印一个可以通过惰性评估创建的无限列表。例如

```
let a = 1 : a 
```

创建无限列表，您可以使用 take 函数或尝试打印时尽可能多地获取它们。请注意，您在等式的左侧和右侧使用相同的标识符，它可以工作：order_list 是 CashOnDelivery:order_list，现在替换为：order_list = CashOnDelivery:(CashOnDelivery:order_list) = Cash... 等等。

如果您想创建 [Cash..., Invoice] 列表，请不要重复使用这样的名称。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-27T21:43:48.140

您刚刚创建的 cons 的 cdr 指向自身：`order_list`第二个`let`中使用的定义是正在创建的定义。使用不同的变量名来完全回避递归问题，代码也不会那么混乱。

编辑：阅读乔尔的回答后，我似乎在这里和一个 Lisp 说话。懒惰的评估与否，无论如何你已经创建了一个递归定义......

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-27T21:44:46.267

Haskell 使用惰性评估...在需要之前不会评估任何内容，这就是为什么 order_list 存储为包含 CashOnDelivery 和另一个未评估的单元格再次引用 order_list 的原因。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-27T22:10:38.560

我认为这里的重要问题不是*懒惰*而是*范围*。该表达式`let x = ...`引入了一个新定义，`x`该定义将替换任何先前的定义。如果`x`出现在右侧，则定义将是递归的。看来您希望在`order_list`右侧使用

```
let order_list = CashOnDelivery : order_list 
```

参考`order_list`(ie, `[Invoice 2345]`) 的第一个定义。但是`let`表达式引入了一个新的范围。相反，您定义了一个无限的`CashOnDelivery`元素列表。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-27T21:46:55.573

我认为您的意思是“这是因为它使用*惰性*评估”吗？答案是肯定的：

```
let ol = CashOnDelivery : ol 
```

这告诉我们 ol 包含元素 CashOnDelivery，然后是表达式 ol 的结果。*直到必要时才评估此表达式*（因此：懒惰）。因此，当打印 ol 时，将首先打印 CashOnDelivery。*只有这样*才能确定列表的下一个元素，从而导致无限行为。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-27T21:57:28.950

X:L 表示“创建一个以 X 开头的列表，后跟 L 定义的列表中的项目”。

然后，您将 order_list 定义为 CashOnDelivery，后跟列表中定义的 order_list 中的项目。此定义是递归的，这就是列表评估不断返回 CashOnDelivery 的原因。您的列表实际上包含无数个 CashOnDelivery 值，*后跟*一个 Invoice 值。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-27T22:11:18.807

`order_list`在这一行：

```
let order_list = [Invoice 2345] 
```

`order_list`是与这一行不同的变量

```
let order_list = CashOnDelivery : order_list 
```

第二行不改变 的值`order_list`。它引入了一个名称相同但值不同的新变量。

`order_list`第二行右侧与第二行`order_list`左侧相同；它与第一行中的无关`order_list`。你会得到一个无限的列表，其中包含 ---在第二个列表`CashOnDelivery`中没有s。`Invoice`

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-28T15:56:13.757

在 ML 中，`val`不是递归的。您必须指定`val rec`递归值。

```
val fin = fn _ => 0
val fin = fn x => fin x + 1
(* the second `fin` is calling the first `fin` *)

val rec inf = fn x => inf x + 1
(* ML must be explicitly told to allow recursion... *)
fun inf' x = inf' x + 1
(* though `fun` is a shortcut to define possibly recursive functions *) 
```

在 Haskell 中，所有顶级`let`、 和`where`绑定都是递归的——没有非递归绑定。

```
let inf = \_ -> 0
let inf = \x -> inf x + 1
-- the second `inf` completely shadows the first `inf` 
```

例外：在 中`do`，`<-`绑定不是递归的。但是，如果您使用`{-# LANGUAGE RecursiveDo #-}`和 import `Control.Monad.Fix`，您会得到`mdo`，其中的`<-`绑定是递归的。

```
foo :: Maybe [Int]
foo = do
    x <- return [1]
    x <- return (0 : x)  -- rhs `x` refers to previous `x`
    return x
-- foo == Just [0, 1]

bar :: Maybe [Int]
bar = mdo
    y <- return (0 : y)  -- rhs `x` refers to lhs `x`
    return y
-- bar == Just [0, 0, 0, ...] 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-03-31T04:47:44.283

也许试试这个

我们创建了一个**函数**来执行此操作。（如在**函数**式编程中）

`$ let order_list = [Invoice 2345]
$ let f x = x : order_list
$ let order_List = f cashOnDelivery
$ order_list
[CashOnDelivery, [Invoice 2345]]` 

`let f x = x : order_list`~注意，每次我们追加 order_list 时，我们都需要重铸函数，以便将其固定到最新的 order_list

`$ let f x = x : order_list
$ let order_List = f cashOnDelivery
$ order_list
[CashOnDelivery, CashOnDelivery, [Invoice 2345]]` 

干杯!

*ps，函数式编程的强大功能是能够在异步（并行/超快）系统上无缝运行无限量的函数和对象，因为所有函数和对象在定义上都是独立的。*

# visual-studio-2008 - Visual Studio 2008 和 Wine

> ID：795401
> 
> 赞同：5
> 
> 时间：2009-04-27T21:41:41.080
> 
> 标签：visual-studio-2008, wine

任何人都尝试过在 linux wit wine 上运行 Visual Studio 2008？有什么烦恼吗？有用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T21:47:20.237

WineHQ 有一些关于这个主题的[测试结果](http://appdb.winehq.org/objectManager.php?sClass=version&iId=11022&iTestingId=21512)，这似乎给出了一个坚定的*否定*。但是，正如您所看到的，它们有些过时了。您可以随时尝试使用最新版本并在 Wine 论坛上发帖寻求帮助，尽管我怀疑您是在乞求痛苦和麻烦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T21:55:13.417

几个月前，我尝试在 Wine 下运行 Visual Studio 远程调试监视器，并且不得不破解几个缺少 Wine API 的实现，然后它才能工作。考虑到这一点，完整的事情会奏效的机会有多大？不好。

# c# - 如何：在 C# 中自动实例化单例

> ID：795402
> 
> 赞同：7
> 
> 时间：2009-04-27T21:41:42.217
> 
> 标签：c#, singleton

我想要一个在程序启动时自动实例化的单例。

我所说的“自动实例化”的意思是单例中的代码应该在程序启动时实例化自己，而不需要其他代码的任何调用或声明。

所以我想要类似下面的东西来实例化并在程序启动时写出“MySingleton Instantiated”（没有主代码做任何事情）......

```
static class MySingleton
{
    private static MySingleton self = new MySingleton();

    protected MySingleton()
    {
        System.Console.WriteLine("MySingleton Instantiated");
    }
} 
```

除了这不起作用，因为 C# 只会在需要时初始化类的静态成员，即当它们被访问/等时。

那我该怎么办？可以这样做吗？

我没有亲自用 C++ 做过这件事（有一段时间没有使用 C++），但我很确定它可以用 C++ 完成，但不确定 C#。

任何帮助表示赞赏。谢谢。

* * *

我实际上想要做的是......会有很多这样的单例类（随着时间的推移可以添加更多），所有这些都将继承自一个公共（抽象）父类（又名。 P类）。

PClass 将有一个静态成员，它是 PClasses 的集合......以及一个将自身添加到集合中的构造函数......

然后理论上所有的单例都会自动添加到集合中（因为当它们被实例化时，基 PClass 构造函数被调用并将新对象添加到集合中）......然后可以在不知道任何关于什么孩子的情况下使用该集合（单例）类已经实现，并且可以随时添加新的子（单例）类，而无需更改任何其他代码。

不幸的是，我无法让孩子们（单身人士）实例化自己......搞砸了我的小计划，导致了这篇文章。

希望我解释得足够好。

* * *

PS。是的，我意识到对单例及其使用有不好的感觉......但它们有时很有用，即使撒旦自己制作了单例，我仍然想知道我的问题是否可以在 C# 中解决。感谢大家。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-27T22:44:08.637

Chris 提到的 IoC 方法可能是最好的，但我能想到的“最佳”解决方案是用反射和属性做一些时髦的事情，如下所示：

```
public class InitOnLoad : Attribute 
{ 
    public static void Initialise()
    {
        // get a list of types which are marked with the InitOnLoad attribute
        var types = 
            from t in AppDomain.CurrentDomain.GetAssemblies().SelectMany(a => a.GetTypes())
            where t.GetCustomAttributes(typeof(InitOnLoad), false).Count() > 0
            select t;

        // process each type to force initialise it
        foreach (var type in types)
        {
            // try to find a static field which is of the same type as the declaring class
            var field = type.GetFields(System.Reflection.BindingFlags.Static | System.Reflection.BindingFlags.Public | System.Reflection.BindingFlags.NonPublic).Where(f => f.FieldType == type).FirstOrDefault();
            // evaluate the static field if found
            if (field != null) field.GetValue(null);
        }
    }
}

[InitOnLoad]
public class Foo
{
    public static Foo x = new Foo();

    private Foo()
    {
        Console.WriteLine("Foo is automatically initialised");
    }
}

public class Bar
{
    public static Bar x = new Bar();

    private Bar()
    {
        Console.WriteLine("Bar is only initialised as required");
    }
} 
```

将调用 InitOnLoad.Initialise() 添加到您的 main 方法中。

您可以取消该属性，但这可能会导致不必要的类型被初始化并不必要地消耗内存（例如上面代码中的 Bar ）。

还值得注意的是，这不会处理动态加载的任何程序集中包含的类型，除非您再次调用 Initialise，但基于您的问题（“程序启动时自动实例化”），这听起来不像一个问题为你。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-27T21:47:03.063

虽然 .NET 模块在理论上 (IIRC) 可以对模块加载等做出反应，但这在 C# 中是不可用的。在某些框架（如 ASP.NET）中，您可以通过配置使用钩子，例如通过处理程序或通过 global.asax.cs 来破解它 - 但是，对于常规 C# 应用程序（控制台、winform 等），您必须手动触发它。例如，`Main`将调用承载您的入口点的类上的静态构造函数。

那么：这里的用例是什么？什么时候延迟加载方法不行？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-27T22:35:42.447

根据您要执行的操作，我会放弃真正的 Singleton 的想法，而改用 IoC 库。

查看 StructureMap、Castle Windsor、Ninject 和/或 Autofac。

这将允许您通过 IoC 库将类创建为单例，拥有任意数量的类，但它只是一个普通的旧类。

单例有一个问题，就是它们真的弄乱了应用程序的可测试性（通过单元测试）。

只需在“Singleton Considered Harmful”上进行谷歌搜索，您就会看到更多参考资料。

或者，您也可以使用简单的类工厂/方法工厂模式。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-27T21:47:30.020

我怀疑如果不做任何事情，这是可能的`Main`。`static MySingleton() {}`如果您不使用它，即使将 a 添加到类中也不能保证它的实例化。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-27T22:27:27.363

您基本上是在要求 .NET 框架在加载程序集时调用某个函数。该函数将是 PClass 实例注册器。

C#中没有`DllMain`。您可以通过在 main 方法中使用程序集级属性和一些代码来模拟这一点，该方法在程序集加载时进行侦听。该属性可以`DllMain`指定一个“”入口点或指向您的 PCIass 继承类。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-27T22:30:29.947

切线地，请允许我指出，这并不是通常实现的单例模式。这是 C# 中的普通（简化）实现（为简洁起见，不包括线程安全之类的东西）：

```
public sealed class Singleton
{
static readonly Singleton _instance = new Singleton();

// private ctor
Singleton() {}

 public static Singleton Instance
 {
  get { return _instance; }
 }
} 
```

您的代码中的这一行甚至不应该编译！

```
protected MySingleton() 
```

说了这么多，我同意那个询问你用例的人的观点。很高兴知道。=)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-27T22:06:42.093

我不相信您想要的在.Net 框架中是可能的。基本上，您希望诸如运行时之类的东西来通知类型或在它们上调用一些预定义的静态方法，表明应用程序已加载并正在运行，或者提供类似的机制。想想开销。运行时唯一确保的是自动调用程序的主入口方法。就是这样。在那里你可以设置和初始化它们，但没有什么是自动的。您仍在明确地连接事物并进行方法调用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-27T23:01:14.803

“PClass 将有一个静态成员，它是 PClass 的集合......”

听起来像是可以通过反射轻松完成的事情。您不需要在启动时运行的代码；您可以在需要时构建这些类的列表。

这是一个示例，当您第一次读取 Instances 属性时将加载列表一次，将查看当时加载的所有程序集（如果您只想查看与 PClass 相同的程序集，则可以稍微简化一下，但是您的问题没有指定您要查看的程序集），并将任何 PClass 后代（但不是 PClass 本身）的单个实例添加到列表中。每个 PClass 后代都需要一个无参数构造函数，但您不需要任何类构造函数。

```
public class PClass
{
    private static List<PClass> m_instances;
    public static IList<PClass> Instances
    {
        get
        {
            if (m_instances == null)
                m_instances = LoadInstanceList();
            return m_instances;
        }
    }
    private static List<PClass> LoadInstanceList()
    {
        foreach (var assembly in AppDomain.GetAssemblies())
        {
            foreach (var type in assembly.GetTypes())
            {
                if (type.IsAssignableTo(typeof(PClass)) && type != typeof(PClass))
                    m_instances.Add(Activator.CreateInstance(type));
            }
        }
    }
} 
```

# python - 有没有一种简单的方法来判断等待 Python GIL 花费了多少时间？

> ID：795405
> 
> 赞同：6
> 
> 时间：2009-04-27T21:42:12.717
> 
> 标签：python, multithreading

我有一个长期运行的 Python 服务，我想知道等待 GIL 的任何可运行线程（即，由于其他原因没有被阻塞的线程）花费了多少累积挂钟时间。是否有捷径可寻？例如，也许我可以定期将一些计数器转储到它的日志文件中。

我的潜在动机是排除 GIL 作为这些长期运行过程中神秘响应延迟的来源。没有特别的理由怀疑 GIL（除了它符合症状外），但其他形式的日志记录还没有出现任何东西，所以，*如果它很容易*，最好有这个信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T10:19:59.540

我不认为有一个简单的方法。可能有一种尴尬的方式，涉及重建 Python 以遍历 PyThreadState 列表并在每次获取锁时计算线程数，但我怀疑这是否值得！

我知道这是一个推测性的问题，但如果您甚至适度担心线程会导致延迟，那么转向多处理模型而不是多线程模型可能是明智的。由于 Python 中的流程更安全且更具可扩展性，因此如果可行，它们几乎总是最佳选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-04-28T21:26:26.123

您现在可以使用[gil_load](https://github.com/chrisjbillington/gil_load)分析 GIL 的使用情况。

请参阅[我](https://stackoverflow.com/a/42818585/2096752)对其他问题的回答。

# javascript - 在 jQuery 中用兄弟姐妹包装 div 的最简单方法是什么？

> ID：795408
> 
> 赞同：2
> 
> 时间：2009-04-27T21:43:03.540
> 
> 标签：javascript, jquery, css

我想使用 jQuery 动态扩展我的标记，以便我的 div 显示为漂亮的圆角框。

例如，如果我的 DOM 有一系列具有唯一 ID 的 div 对象，例如：

```
<div id="queuediv0" class="isequeue" > </div> 
```

可以使用以下方式选择：

```
$(“.isequeue”) 
```

我想替换/包装这些 div，以便最终结果如下所示：

```
<div class="isequeue_wrapper">
    <div class="isequeue_wrapper_oc">
        <div class="isequeue_wrapper_dk" style="margin: 0 5px;"> </div>
        <div class="isequeue_wrapper_dk" style="margin: 0 3px;"> </div>
        <div class="isequeue_wrapper_dk" style="margin: 0 2px;"> </div>
        <div class="isequeue_wrapper_dk" style="margin: 0 1px;"> </div>
   </div>
    <p class="isequeue_header">
        Header text
    </p>
    <div class="isequeue_wrapper_ic">
        <div class="isequeue_wrapper_lt" style="margin: 0 5px;"> </div>
        <div class="isequeue_wrapper_lt" style="margin: 0 3px;"> </div>
        <div class="isequeue_wrapper_lt" style="margin: 0 2px;"> </div>
        <div class="isequeue_wrapper_lt" style="margin: 0 1px;"> </div>
    </div>
    <div id="queuediv0" class="isequeue" >
    </div>
     <div class="isequeue_wrapper_oc">
         <div class="isequeue_wrapper_dk" style="margin: 0 1px;"> </div>
         <div class="isequeue_wrapper_dk" style="margin: 0 2px;"> </div>
         <div class="isequeue_wrapper_dk" style="margin: 0 3px;"> </div>
         <div class="isequeue_wrapper_dk" style="margin: 0 5px;"> </div>
     </div>
</div> 
```

可以即时添加附加标记，也可以将其隐藏在原始页面中，以便可以选择和复制它。

我敢肯定有一种干净的方法可以做到这一点，但它现在已经避开了我。jQuery.wrap() 会将选定的对象放入提供的源的最里面，但是当您希望选定的项目成为新添加的源的兄弟时，如何实现这一点。

谢谢，吉姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T22:01:41.437

像这样的东西可以工作：

```
$(function() {
    var $isqueue = $('.isequeue');
    $isqueue.wrap('<div class="isequeue_wrapper"></div>');
    $isqueue.before(/* All the isequeue_wrapper_oc, isequeue_header, isequeue_wrapper_ic and  stuff */).after(/* All the isequeue_wrapper_ic stuff */);
}); 
```

将所有东西预先制作好然后克隆它是明智的。但是，您也可以将它们作为字符串并以相同的方式插入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T21:49:36.567

before() 和 after() 应该可以工作。

# php - 为什么我不能在子域之间传递用户会话？

> ID：795414
> 
> 赞同：3
> 
> 时间：2009-04-27T21:45:47.980
> 
> 标签：php, session, cookies

首先，我在这篇 SO 文章中使用了所有建议的方法： [Allow php sessions to carry over to subdomains](https://stackoverflow.com/questions/644920/allow-php-sessions-to-carry-over-to-subdomains)

为了您的方便，以下是我已经遵循的提示：

> 这里有 3 个选项。
> 
> 把它放在你的 php.ini 中：
> 
> ```
> session.cookie_domain = ".example.com"
> ```
> 
> 在您的 .htaccess 中：
> 
> ```
> php_value session.cookie_domain .example.com
> ```
> 
> 作为脚本中的第一件事：
> 
> ```
> ini_set('session.cookie_domain','.example.com' );
> ```

我有 9 个子域（losangeles.mysite.com、sandiego.mysite.com 等），我希望用户能够在它们之间保持登录状态。但是，到目前为止，服务器将每个子域视为具有单独会话的完全包含的站点。

还有什么我可以做的吗？或者我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T21:57:17.717

我怀疑 cookie 是为 .foo.example.com 而不是 .example.com 设置的。尝试为 Firefox 安装 Live HTTP Headers 插件并检查 cookie 的设置。

为此，打开 Live HTTP Headers 并在窗口打开的情况下，转到设置 cookie 的页面。在窗口中，应该有一条看起来像这样的线。

设置 Cookie：lng=en-US；路径=/; 域=.example.com；

如果 cookie 设置为 domain=.foo.example.com; 那么你就知道问题出在哪里了。但是，如果域是 .example.com，则会发生其他事情。

此外，如果在 foo.example.com 上为 .example.com 设置了 cookie，请检查浏览器是否正在向 bar.example.com 发送 cookie。这应该有助于找出问题所在。

# php - 在 PHP 中，我可以在 switch 语句中获取 case 语句的总数吗？

> ID：795417
> 
> 赞同：3
> 
> 时间：2009-04-27T21:46:34.500
> 
> 标签：php, count, switch-statement, case

有没有办法返回 switch 语句中的（案例）实例总数？像这样的东西：

```
$id = $_GET['id'];

switch ($id) {
  case "item1" :
  $data = 'something1';
  break;

  case "item2" :
  $data = 'something2';
  break;
}

echo $data; 
```

但原因是其中有多个文件，其中包含这些 switch 语句，但它们的数量因文件而异。理想情况下，我希望能够通过递增“id”来遍历这些 switch 语句。关于这是否可能的任何想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-27T21:54:11.250

如果您只是根据另一个值分配值，则可以改用[数组](http://docs.php.net/manual/en/language.types.array.php)：

```
$idToData = array(
    'item1' => 'something1',
    'item2' => 'something2',
);
$data = 'default';
if (isset($_GET['id']) && array_key_exists($_GET['id'], $idToData)) {
    $data = $idToData[$_GET['id']];
}
echo $data; 
```

数组的优点是可以[扩展](http://php.net/manual/language.types.array.php#language.types.array.syntax.modifying)，可以统计项数[`count()`](http://php.net/count)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T21:50:46.407

并非没有改变 $id 的值并删除 break 语句..但这有悖于目的。你有理由知道有多少吗？

我只会 grep 你想知道的文件

```
find -name '*php' | xargs grep 'case' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T21:59:02.643

啊——我想我明白你在追求什么了。您可以做的是添加一个 default: case 来终止循环，而不是尝试计数。例如

```
for($id = 1; !$quit; $id++)
{
    switch("item" . $id) {
    case "item1":
         // Do something
         break;
    case "item<n>":
         // Do something else
         break;
    default:
         $quit = true;
    }
} 
```

问题是：为什么不只是通过......将一个语句一个接一个地放在没有循环和案例语句的情况下完成所有这些？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-28T00:40:00.713

[您可能可以使用token_get_all()](http://www.php.net/manual/en/function.token-get-all.php)做您所要求的事情，但很可能这并不是您*实际问题*的最佳解决方案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-28T15:19:06.637

实际上，您可以使用[token_get_all()](http://au2.php.net/token_get_all)可靠地做到这一点。下面是使用该函数[查找 PHP 文件中所有 define() 用法](https://stackoverflow.com/questions/645862/regex-to-parse-define-contents-possible/645914#645914)的示例。您将需要构建一个有限状态机（类似于链接状态机）来查找 switch 语句，然后查找从属 case 语句。您可能希望也可能不希望确保正确处理嵌套的 switch 语句。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-28T15:09:13.337

好的，假设 URL 如下所示：

somesite.com/ajax/getinfo.php?id=news

然后您可以获取 $_GET[id] 值并使用开关对其进行处理。

如果我正确地想象你的代码：

```
$section=$_GET[id];
switch($section) {
case "1":
break;
.
.
.
default:

} 
```

如果这不正确，请原谅我的英语。请多解释一下，它仍然有点模棱两可。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-28T15:23:43.617

实际上，这段代码可以工作：

```
$i = 0;
switch(something)
{
    case "item".$i++: //something
        break;
    case "item".$i++: //something
        break;
    default: //something
        break;
} 
```

# sorting - 在 MIPS 中对用户输入的数字列表进行排序

> ID：795424
> 
> 赞同：1
> 
> 时间：2009-04-27T21:47:32.390
> 
> 标签：sorting, mips

我正在编写 MIPS 程序，它将检查要从终端输入的 10 个数字的列表。并且这些数字会按升序在终端上输出。下面是我的 MIPS 程序...请有人帮我研究一下，因为我正在运行并且无法正常工作...。

```
 .data
array:  .space 40  
prompt: .asciiz "Enter a number: " 
spacee: .asciiz " "
output: .asciiz "The numbers are: "
        .text

main:
 li $t1,10
 la $a1,array

loop:
 addi $t1,$t1,-1
 li $v0,4     
 la $a0,prompt
 syscall
 li $v0,5
 syscall
 sw $v0,0($a1)
 addi $a1,$a1,4
 bnez $t1,loop
 li $t1,9
 li $t2,9
 la $a1,array

loop1:
 beqz $t2,here
 addi $t2,$t2,-1
 lw $t5,0($a1)
 lw $t6,4($a1)
 add $a1,$a1,4
 ble $t5,$t6,loop1
 sw $t5,0($a1)
 sw $t6,-4($a1)
 bnez $t2,loop1

here:
 la $a1,array
 addi $t1,$t1,-1
 add $t2,$t2,$t1
 bnez $t1,loop1
 li $v0,4
 la $a0,output
 syscall
 la $a1,array
 li $t1,10

loop2:
 li $v0,1
 lw $a0,0($a1)
 syscall
 li $v0,4
 la $a0,spacee
 syscall
 add $a1,$a1,4
 addi $t1,$t1,-1
 bnez $t1,loop2

 li $v0,10              #exit

 syscall 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T23:41:07.733

如果您使用 addi 而不是 add，它有效吗？同样对于汇编，它有时有助于进行很多评论，因为它不会在任何接近自然语言的地方阅读。

```
.data
array:  .space 40  
prompt: .asciiz "Enter a number: " 
spacee: .asciiz " "
output: .asciiz "The numbers are: "
.text

main:
 li $t1,10         #load 10 into $t1
 la $a1,array      #load a pointer to array into $a1

loop:
 addi $t1,$t1,-1   #subtract 1 from $t1, save to $t1
 li $v0,4          #load 4 into $v0 (print string)
 la $a0,prompt     #load prompt text into $a
 syscall           #display prompt
 li $v0,5          #load 5 into $v0 (read integer)
 syscall           #prompt for input
 sw $v0,0($a1)     #store input int to array
 addi $a1,$a1,4    #add 4 to $a1, save to $a1
 bnez $t1,loop     #if $t1 isn't zero,goto loop
 li $t1,9          #if $t1 is zero, load 9 into $t1
 li $t2,9          #and load 9 into $t2
 la $a1,array      #load array pointer into $a1

loop1:
 beqz $t2,here     #if $t2 is zero, goto here
 addi $t2,$t2,-1   #subtract 1 from $t2, save to $t2
 lw $t5,0($a1)     #load an input int into $t5
 lw $t6,4($a1)     #load the next one into $t6
 addi $a1,$a1,4    #add 4 to $a1, save to $a1
 ble $t5,$t6,loop1 #if $t5 <= $t6, goto loop1
 sw $t5,0($a1)     #else, store $t5 in $a1
 sw $t6,-4($a1)     #and store $t6 in $a1-4 (swapping them)
 bnez $t2,loop1    #if $t2 is not zero, to go loop1

here:
 la $a1,array      #load array into $a1
 addi $t1,$t1,-1   #subtract 1 from $t1, save to $t1
 add $t2,$t2,$t1   #add $t2 to $t1, save to $t2
 bnez $t1,loop1    #if $t1 isn't zero, goto loop1
 li $v0,4          #load 4 into $v0 (print string)
 la $a0,output     #load 'the numbers are' into $a0
 syscall           #display message to screen
 la $a1,array      #load array pointer into $a1
 li $t1,10         #load 10 into $t1

loop2:
 li $v0,1          #load 1 into $v0 (print int)
 lw $a0,0($a1)     #load $a1 into $a0
 syscall           #print first number to screen
 li $v0,4          #load 4 into $v1 (print string)
 la $a0,spacee     #load ' ' into $a0
 syscall           #print ' ' to screen
 addi $a1,$a1,4    #add 4 to $a1, save to $a1
 addi $t1,$t1,-1   #subtract 1 from $t1, save to $t1
 bnez $t1,loop2    #if $t1 isn't zero, goto loop2

 li $v0,10              #exit

 syscall 
```

我没有 MIPS 处理器，但这在 C 中有效：#include "stdafx.h"

```
int _tmain(int argc, _TCHAR* argv[])
{
int t1;
int t2;

int* a1;
int t5;
int t6;

int arr[10] = {10,9,8,7,6,5,4,3,2,1};

t1 = 9;
t2 = 9;
a1 = arr;

loop1:
if(t2 == 0)
    goto here;

t2 = t2 - 1;
t5 = *a1;
t6 = *(a1 + 1);
a1 = a1 + 1;
if(t5 <= t6)
    goto loop1;

*a1 = t5;
*(a1-1) = t6;
if(t2 != 0)
    goto loop1;

here:
a1 = arr;
t1 = t1 - 1;
t2 = t2 + t1;
if(t1 != 0)
    goto loop1;
printf("the numbers are\n");
a1 = arr;
t1 = 10;

loop2:
printf("%i ", *a1);
a1 = a1 + 1;
t1 = t1 - 1;
if(t1 != 0)
    goto loop2;

return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T22:52:01.673

首先，您以错误的方式使用了一些指令。

```
add $a1,$a1,4 
```

应该

```
addiu $a1,$a1,4 
```

因为您要添加一个中间件，而不是两个寄存器。

除此之外，您应该看看您的比较逻辑。这非常令人困惑且容易出错。

# asp.net - 绕过输入的 onClick 事件的 ASP.NET 验证

> ID：795428
> 
> 赞同：1
> 
> 时间：2009-04-27T21:50:13.023
> 
> 标签：asp.net, javascript, html, validation

我有一个带有 onclick 事件的 <input> ，它检查 Enter 键。被调用的函数可能会执行 window.location 重定向。

但是，当我按下 Enter 键时，它显然会触发页面验证。所以我一瞬间看到了验证消息。

当焦点在那个 <input> 中时，如何告诉页面不要触发任何验证事件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-27T21:57:07.203

如果是 <asp:Button>，只需将[CausesValidation](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.button.causesvalidation.aspx)属性设置为 false。但是，我*怀疑*它实际上不是导致它的按钮 - 但表单提交是作为 Enter 键的结果发生的。

如果是这种情况，您可以使用[客户端 API](http://msdn.microsoft.com/en-us/library/aa479045.aspx#aspplusvalid_clientside)并设置`Page_ValidationActive = false;`焦点何时更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T21:52:16.827

设置验证控件的[ValidationGroup](http://msdn.microsoft.com/en-us/library/ms227424.aspx)属性。之后，为要触发验证的按钮定义 ValidationGroup 属性。

此外，将[Causesvalidation](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.causesvalidation.aspx)属性设置为 false 可能会有所帮助。

# c++ - 将 BOOST_FOREACH 与 std::map 一起使用

> ID：795443
> 
> 赞同：45
> 
> 时间：2009-04-27T21:55:43.417
> 
> 标签：c++, boost, foreach, maps, std

我想使用 BOOST_FOREACH 迭代 std::map 并编辑值。我不太明白。

```
typedef std::pair<int, int> IdSizePair_t;
std::map<int,int> mmap;    
mmap[1] = 1;
mmap[2] = 2;
mmap[3] = 3;
BOOST_FOREACH( IdSizePair_t i, mmap )
    i.second++;
// mmap should contain {2,3,4} here 
```

当然，这不会改变任何事情，因为我没有通过引用进行迭代。所以我用这一行代替（根据 Boost 文档中的示例）：

```
BOOST_FOREACH( IdSizePair_t &i, mmap ) 
```

我得到编译器错误：

```
error C2440: 'initializing' : 
cannot convert from 'std::pair<_Ty1,_Ty2>' to 'IdSizePair_t &'
    with
    [
        _Ty1=const int,
        _Ty2=int
    ] 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-04-27T22:09:54.647

问题在于该对的第一个成员，它应该是*const*。试试这个：

```
typedef std::map<int, int> map_t;
map_t mmap;  
BOOST_FOREACH( map_t::value_type &i, mmap )
    i.second++; 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-10-04T21:41:55.107

这是一个旧线程，但有一个更方便的解决方案。

boost 具有对迭代器范围执行转换的“范围适配器”的概念。对于这个确切的用例（迭代映射键或值）有特定的范围适配器：`boost::adaptors::map_values`和`boost::adaptors::map_keys`.

所以你可以像这样迭代地图值：

```
BOOST_FOREACH(int& size, mmap | boost::adaptors::map_values)
{ 
    ++size;
} 
```

更多信息[在这里](http://www.boost.org/doc/libs/1_51_0/libs/range/doc/html/range/introduction.html)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-08-04T05:23:22.490

另一种选择是使用 BOOST_FOREACH_PAIR，请在此处查看我的答案：

[BOOST_FOREACH 和没有 typedef 的模板](https://stackoverflow.com/questions/1713653/boost-foreach-templates-without-typedef/1745774#1745774)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-17T18:44:42.023

从 C++11 开始考虑使用 auto 关键字：

```
std::map<int,int> mmap;    
mmap[1] = 1;
mmap[2] = 2;
mmap[3] = 3;

BOOST_FOREACH(auto& mpair, mmap)
    mpair.second++;

//mmap will contain {2,3,4} here 
```

# asp.net - Cassini 上的 ASP.NET MVC：如何强制“内容”目录返回 304 而不是 200？

> ID：795451
> 
> 赞同：13
> 
> 时间：2009-04-27T21:57:26.050
> 
> 标签：asp.net, asp.net-mvc, visual-studio-2008, cassini

**场景**：我有一个在 Visual Studio 2008 中开发的 ASP.NET MVC 应用程序。有一个名为“Content”的根文件夹，用于存储图像和样式表。当我在本地运行（使用 Cassini）并浏览我的应用程序时，*总是会*下载“内容”目录中的*每个* *资源。*使用 Firebug，我可以验证 Web 服务器是否返回 HTTP 200（“ok”）。

 ***期望**：我希望 Cassini 返回 HTTP 304（“未修改”）而不是 200。这是在 IIS7 下运行站点时的行为。

**推理**：我正在处理的网站有大量静态资源（通常每页多达 40 个）。在 IIS7 上浏览站点非常快，因为这些资源（正确地）由浏览器缓存。但是，在我的本地计算机上浏览该站点非常缓慢。

在 IIS7 上在 1 秒内呈现的页面需要 30 多秒才能在 Cassini 上呈现。实际上，每隔几分钟上传整个网站并从那里进行测试对我来说*更快。*（是的，我承认这是不正当和疯狂的。）

那么：**我如何指导/欺骗 Cassini 像 IIS7 一样处理“内容”目录**？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-04-27T22:07:53.153

您确定问题出在缓存上吗？因为当我在 Cassini 上运行应用程序时，内容确实会正确缓存在我的机器上。

我认为您遇到的问题可能是 Firefox 在解析 IPv6 地址时性能不佳，这会导致使用[http://localhost:55555](http://localhost:55555)之类的地址加载时出现非常烦人的延迟。

我为改变这种行为所做的就是在 Firefox 上更改首选项`network.dns.disableIPv6`。我建议尝试一下。`about:config``true`

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2010-06-10T12:17:08.780

我在 Chrome 中遇到过类似的问题。要解决此问题，请取消注释文件中的 IPv4 localhost 行`hosts`。显然，这些默认情况下在 Windows 7 中被注释。

```
127.0.0.1       localhost
#::1             localhost 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T22:09:07.003

您的另一个选择是简单地跳过 Cassini 并[在 IIS 下进行调试](http://learn.iis.net/page.aspx/387/using-visual-studio-2008-with-iis-70/)。它非常简单，不需要十分钟即可启动和运行。浏览您在 Cassini 上的 20 个页面，反正您已经使用了那段时间；）

我注意到的一件事并不总是在指南中，如果您想在不同的地址上进行调试，则`http://localhost/`需要手动将主机设置为本地 IIS。这是通过在`hosts`文件中添加一行来完成的，位于

C:\Windows\system32\drivers\etc\hosts

使用记事本打开文件（如果您使用的是 Windows Vista 并打开了用户帐户控制，则需要“以管理员身份运行”才能保存...）并添加您的主机。例如，在`http://mysite/`你添加下调试

```
mysite         127.0.0.1 
```

# sql-server - 如何处理 SQL Server T-SQL try-catch 块中丢失的客户端连接？

> ID：795458
> 
> 赞同：0
> 
> 时间：2009-04-27T21:59:19.867
> 
> 标签：sql-server, error-handling, try-catch

TSQL BEGIN TRY 和 BEGIN CATCH 块模式不会捕获由于客户端连接丢失而导致的错误。如何捕获和处理丢失的客户端连接？

我正在设置一个标志，指示在处理单个事务的循环时进行处理，并且 catch 块会在错误时重新设置该标志，但是如果客户端连接丢失，我的 catch 块不会执行......

伪代码：

```
BEGIN TRY
  SET FlagToIndicateProcessing = 1
  LOOP START
    BEGIN TRANS
      DO WORK
    COMMIT TRANS
  LOOP END
  SetSomeValues
  SET FlagToIndicateProcessing = 0
END TRY
BEGIN CATCH
  SetSomeValues
  SET FlagToIndicateProcessing = 0
END CATCH 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T22:14:59.533

数据库连接丢失超出了 T-SQL 中的 TRY/CATCH 可以处理的范围。

您有很多选择，但这取决于您的情况（从设计的角度来看）什么是可以接受的。不知道这些信息，很难提出建议。

话虽如此，一个想法是将所有内容包装在“父”事务中。如果该事务被回滚（如果您失去连接，这是设计使然），则该会话中的任何更改都不会持久保存到数据库中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T04:06:20.343

正确的。

客户端丢失连接实际上是对 SQL Server 的中止和回滚：您只需停止执行 SQL，CATCH 块就不会执行。

为什么要在一个循环中批量处理单个事务？这可能会帮助某人提出解决方案。通常，一个 SQL 调用就是一个工作单元。

# c# - C# 对象初始化器的嵌套使用

> ID：795460
> 
> 赞同：9
> 
> 时间：2009-04-27T22:00:14.903
> 
> 标签：c#, c#-3.0

所以，对象初始化器很方便——尤其是当你在做 linq 时，它们是完全必要的——但我不太明白这个：

```
public class Class1 {
   public Class2 instance;
}

public class Class2 {
   public Class1 parent;
} 
```

像这样使用：

```
Class1 class1 = new Class1();
class1.instance = new Class2();
class1.parent = class1; 
```

作为初始化器：

```
Class1 class1 = new Class1() {
    instance = new Class2() {
        parent = class1
    }
}; 
```

这不起作用，class1 应该是一个未分配的局部变量。当你做类似的事情时，它在 Linq 中变得更加棘手

```
select new Class1() { ... 
```

它甚至没有一个名字来引用它！

我该如何解决这个问题？我可以不使用对象初始化器进行嵌套引用吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-27T22:08:53.620

> 我可以不使用对象初始化器进行嵌套引用吗？

你是对的——你不能。会有一个循环；A 需要 B 进行初始化，但 B 之前需要 A。准确地说-您当然可以制作嵌套对象初始化程序，但不能使用循环依赖项。

但是你可以——如果可能的话，我建议你应该——按如下方式解决这个问题。

```
public class A
{
   public B Child
   {
      get { return this.child; }
      set
      {
         if (this.child != value)
         {
            this.child = value;
            this.child.Parent = this;
         }
      }
   }
   private B child = null;
}

public class B
{
   public A Parent
   {
      get { return this.parent; }
      set
      {
         if (this.parent != value)
         {
            this.parent = value;
            this.parent.Child = this;
         }
      }
   }
   private A parent = null;
} 
```

在属性内部建立关系的好处是，如果您忘记了其中一个初始化语句，您就不会获得不一致的状态。很明显，这是一个次优的解决方案，因为您需要两条语句来完成一件事。

```
b.Parent = a;
a.Child = b; 
```

使用属性中的逻辑，您只需一条语句即可完成任务。

```
a.Child = b; 
```

或者反过来。

```
b.Parent = a; 
```

最后是对象初始化语法。

```
A a = new A { Child = new B() }; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T22:09:37.470

我认为无论如何都无法解决这个问题，当应用程序实例化 Class1 对象时，它需要首先创建 Class2 对象，以便它知道引用在内存中的位置。如果您尝试以下操作，您会看到这一点：

```
 Class1 myClass1 = null;

        myClass1 = new Class1()
        {
            instance = new Class2
            {
                parent = myClass1
            }
        }; 
```

这将编译并运行，但 Class2 的 parent 属性将为 null，因为这是运行内部代码行时的值，这意味着最里面的行是第一个被执行的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T22:16:16.207

你不能用对象初始化器来做到这一点。但是，您可以使用属性代码来解决问题：

```
class A
{
    B b;

    public B B
    {
        set
        {
            b = value;
            b.a = this;
        }
        get
        {
            return b;
        }
    }
}

class B
{
    public A a;
} 
```

调用它：

```
var a = new A  {  B = new B() }; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T22:07:57.053

此问题并非特定于对象初始化程序，而是 C# 语言中的一般限制。在明确分配之前，您不能使用局部变量。这是一个更简单的复制

```
Class1 Foo(Class1 c1) {
  return c1;
}

void Example() {
  Class1 c1 = Foo(c1);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T22:11:56.153

你当然可以使用嵌套对象初始化器，我一直都这样做。

但是，在您的特定情况下，您的对象具有循环引用。您需要先完成一个实例化，然后再将其分配给另一个。否则，您将给编译器一个它无法处理的经典[鸡和蛋问题。](http://en.wikipedia.org/wiki/Chicken_and_egg_problem)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-27T22:39:20.923

IMO，您的示例并未反映良好的课程设计；它的凝聚力不恰当，并创建了一个循环引用。这就是无法在一个表达式中将它们一起实例化的原因。

我建议您回到绘图板并将您的类重构为父/子关系。我会在子类上使用构造函数注入，并让子类告诉父类它是它的子类。

例如：

```
public class ParentClass 
{
    public List<ChildClass> Children;
    public void AddChild(ChildClass child)
    {
        Children.Add(child);
        // or something else, etc. 
    }
    // various stuff like making sure Children actually exists before AddChild is called
}

public class ChildClass 
{
    public ParentClass Parent;
    public ChildClass(ParentClass parent)
    {
        Parent = parent;
        Parent.AddChild(this);
    }
} 
```

然后，在您的调用代码中：

```
var parent = new ChildClass(new ParentClass()).Parent; 
```

而且，是的，这在 LINQ 中有效：

```
// qry, etc.
select new ChildClass(new ParentClass()).Parent 
```

> *但是如何让所有 ChildClass 都具有相同的 ParentClass 实例？*——安迪·霍霍斯特

那么你必须提前知道父类。

```
var parent = new ParentClass();
var child = new ChildClass(parent); 
```

或者

```
var parent = new ParentClass();
// qry, etc.
select new ChildClass(parent) 
```

# shortcuts - 如何在 Mirth 中加载静态数据，避免多次往返数据库

> ID：795462
> 
> 赞同：4
> 
> 时间：2009-04-27T22:00:49.113
> 
> 标签：shortcuts, hl7, mirth

[Mirth](http://www.mirthcorp.com/community/mirth-connect)是帮助医疗保健应用程序 HL7 消息集成的代理。

我的问题是，每次您想要查找 HL7 中包含的某些数据时，您都可以省去访问自己的数据存储区的麻烦。

场景：对于频道收到的每条消息，我想找到设施的助记符/代码/ID，并获取设施的全名。不幸的是，我不能要求 HL7 消息的发件人在消息中为我发送它。所以我必须编写自己的数据库访问代码来调用存储过程，传入 ID，并接收全名。

关于如何在 Mirth 中创建数据缓存以便您可以从任何通道、源、目标、转换器或过滤器访问查找的任何想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-01-11T22:12:34.933

在我们的例子中，我们必须从数据库中加载查找值，我们解决了这个问题，如下所示：

1.  有一个通道部署脚本，当通道部署到全局地图时加载查找值。
2.  有一个全局模板函数，允许您从此全局映射中查找值。
3.  在过滤器和翻译中使用全局模板功能。

注意：在我们的例子中，每个键可以有两个与之关联的值。如果我们不同时使用两者，我们只需在数据库查询中将第二个设置为 null。

要加载全局地图，请将其放在频道的部署脚本中（根据需要自定义）：

```
// This script executes once when the mule engine is started
// You only have access to the globalMap here to persist data 

var sqlDBDriver   = 'net.sourceforge.jtds.jdbc.Driver';
var sqlDBName     = 'jdbc:jtds:sqlserver://databaseserver/databasename';
var sqlDBDUser    = 'username';
var sqlDBPassword = 'password';

function PopulateLookup ( sqlQuery, globalMapName )
{
    logger.info('Loading lookup table values in the deploy script: ' + globalMapName);

    var dbConn = DatabaseConnectionFactory.createDatabaseConnection( sqlDBDriver, sqlDBName, sqlDBDUser, sqlDBPassword );
    var rs = dbConn.executeCachedQuery( sqlQuery );
    dbConn.close();

    var arr = new Array();
    while(rs.next())
    {
        var obj = new Object();
        obj.LeftValue   = rs.getString('LeftValue');
        obj.RightValue1 = rs.getString('RightValue1');
        obj.RightValue2   = rs.getString('RightValue2');
        arr.push(obj);
    } 
    globalMap.put( globalMapName, arr );
}

PopulateLookup( 'SELECT keyColumn as LeftValue, Value1 as RightValue1, Value2 as RightValue2 FROM tableName', 'GlobalMapName' );

// Repeat above line as needed for each lookup you need

return; 
```

为了访问这些值，您可以使用以下函数作为全局模板。

```
function FindLookupValueWithDefault ( LookupGlobalMapName, LeftValue, DefaultValue1, DefaultValue2 ){
    /***********************************************************************************************
    DESCRIPTION: Retrieves lookup table values from the global map and uses the input values to return output values

     PARAMETERS:
       LookupGlobalMapName - name of the lookup table in the Global Map
       LeftValue - The value to look up
       DefaultValue1 - the first default value if a match was not found
       DefaultValue2 - the second default value if a match was not found

    RETURNS:
       An object containing the replacement value and associated OID if applicable

    REMARKS: 
    ************************************************************************************************/
        // Retrieve the previously matched item from the globalmap
        //    We do this to save time and not look through a huge lookup table tons of times
        //    unless we absolutely have to
        var prevItem = globalMap.get(LookupGlobalMapName + '-Previous');

        // This is the same item requested for this globalmap name - just return the previous value
        if ( prevItem != null && prevItem.LeftValue == LeftValue) {
            return prevItem;
        }

        //
        // If we reach this point the previous item either did not exist or did not match 
        //

        // Retrieve the array with lookup objects from the globalmap and search for the matching value
        var arr = globalMap.get(LookupGlobalMapName);
        var obj = new Object();
        obj.LeftValue = LeftValue;
        obj.RightValue1 = DefaultValue1;
        obj.RightValue2   = DefaultValue2; 
        for each ( item in arr )
        {
            var pattern=new RegExp("^" + item.LeftValue + "$");
            var result = pattern.test(LeftValue );

            if ( pattern.test(LeftValue ) )
            {
                obj = item;
                break;
            } 
        }

        // Store the previous value in the globalmap
        globalMap.put( LookupGlobalMapName + '-Previous', obj );

        // Return the object we found or created
        return obj;
    } 
```

访问值的代码示例：

```
var myObject = FindLookupValueWithDefault('GlobalMapName', 'LookupValue', 'DefaultValue1', 'DefaultValue2');

if ( myObject != null )
{

      var value1 = myObject.RightValue1;
      var value2 = myObject.RightValue2;
} 
```

您的里程可能会有所不同......但到目前为止这对我们有用。

谢谢，弗兰斯德湿

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-29T21:50:48.143

您可以尝试编写具有两个功能的全局脚本：

1) 使用您要查找的数据填充 Java hastable 或类似结构

2）使用你传入的参数作为哈希表的key，返回这个key对应的哈希表中包含的数据。

在 Mirth 中使用 Java 的链接（[链接](http://www.mirthcorp.com/community/wiki/display/mirth/How+to+invoke+Java+code+from+Mirth)）

# windows - Windows 中的自定义 URL 协议 - 电子邮件链接

> ID：795463
> 
> 赞同：7
> 
> 时间：2009-04-27T22:01:39.657
> 
> 标签：windows, email

我有一个我正在处理的应用程序的自定义 URL 协议（定义如下：http: [//msdn.microsoft.com/en-us/library/aa767914.aspx](http://msdn.microsoft.com/en-us/library/aa767914.aspx)）。此协议运行良好，我可以转到开始 -> 运行并输入：

```
foo:1_1 
```

我的应用程序按预期启动。如果我创建一个具有该类型链接的网页，它会按预期工作（我从浏览器收到警告，但这没问题）。当我尝试从我的程序中发送一封包含这些链接之一的电子邮件时，我的问题就出现了。尤其是 Gmail，似乎正在删除我的链接，所以当我发送包含此链接的电子邮件时：

```
<a href='foo:1_1'>foo</a> 
```

我留下了这个生成的 HTML：

```
<a>foo</a> 
```

它似乎正在剥离我的 href 标记，我猜这是因为它无法识别协议。有谁知道我该如何解决这个问题？我用我的 ISP 的电子邮件服务对其进行了测试，并且标签没有受到干扰。这只是我将不得不忍受的事情，并告诉我的用户将链接剪切并粘贴到他们的开始 - >运行框中吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T22:28:40.123

经过一番探索，看看另一个应用程序做了什么，我想出了一个合适的解决方法：

我们不会直接链接到我们的协议，而是链接到我们网站上我们传递参数的页面，然后该页面将使用我们的协议创建链接。当您通过 iTunes 发送链接时，这似乎是 iTunes 的做法。

# css - 如何将元素放置在具有高度和溢出的 div 底部：auto

> ID：795465
> 
> 赞同：1
> 
> 时间：2009-04-27T22:02:09.750
> 
> 标签：css

这是我的情况，我有一个具有 height:400px 和 overflow:auto 的 div 以在内容长于 400px 时滚动。在这个 div 里面我有 2 个 div。一个普通的高度未知，另一个具有绝对定位，锚定到底部：0px；

只要没有滚动条并且高度低于 400 像素，一切都可以。但是一旦我们得到滚动条，就会出现问题。

这是问题所在，我希望根据 div 内容的真实高度而不是 400px 来定位绝对 div。我希望它始终位于底部滚动条位置的底部，而不仅仅是视觉零底部。

有没有人可以提供一些启示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T22:21:25.740

如何用另一个“最小高度”为 100%（以及“相对”的“位置”以使其成为绝对定位 div 的偏移父级）的另一个内部 div 包装呢？Chrome 中的快速测试表明这可能有效。

IE6 可能有点棘手（如果您需要支持它），因为它不支持“最小高度”。不过，您可能会通过 IE6 特定的 CSS hack 获得“高度”来为您执行此操作，因为 IE6 似乎将“高度”视为“最小高度”。

# java - 将行插入 JTable 时出现重复值

> ID：795468
> 
> 赞同：2
> 
> 时间：2009-04-27T22:02:30.030
> 
> 标签：java, swing, jtable

我在将行插入 a 时遇到问题`JTable`，我不知道问题是什么。

我就是这样做的：

```
((DefaultTableModel)myJTable.getModel()).insertRow(0,webSiteDownloader.getWebSites().toArray()); 
```

是`webSiteDownloader`一个具有`ArrayList`. 我可以让那个数组调用方法`getWebSites`。

问题是当我插入一行时，添加第二行，`JTable`只显示第一行，但重复了两次。我够清楚了吗？

谢谢 :D

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T22:53:10.983

我会在黑暗中拍摄并猜测你想要完成这样的事情：

```
DefaultTableModel dtm = (DefaultTableModel)myJTable.getModel();
for (MyRowObject row : webSiteDownloader.getWebSites()) {
  dtm.insertRow(0, row.toArray());
} 
```

您使用 insertRow 而不是 addRow 是否有特殊原因？

另外，我真的很想建议您通过扩展 AbstractTableModel 来推出自己的特殊用途 TableModel。基本未经测试的例子：

```
public class MyTableModel extends AbstractTableModel
{
  protected List<MyObject> rows;

  public MyTableModel()
  {
    rows = new ArrayList<MyObject>();
  }

  public void add(MyObject obj)
  {
    rows.add(obj);
  }

  @Override
  public int getRowCount()
  {
    return rows.size();
  }

  @Override
  public int getColumnCount()
  {
    // This value will be constant, but generally you'd also
    // want to override getColumnName to return column names
    // from an array, and in that case you can return the length
    // of the array with column names instead
    return 2;
  }

  @Override
  public Object getValueAt(int row, int column)
  {
    MyObject obj = rows.get(row);

    // Change this to match your columns
    switch(column) {
      case 0: return obj.getId();
      case 1: return obj.getName();
    }

    return null;
  }
} 
```

# java - 当对象具有不同的serialVersionUID时，如何反序列化保存在数据库中的对象

> ID：795470
> 
> 赞同：12
> 
> 时间：2009-04-27T22:02:53.977
> 
> 标签：java, serialization, serialversionuid

我的客户端有一个 oracle 数据库，并且一个对象通过 objOutStream.writeObject 作为 blob 字段持久化，该对象现在有一个不同的`serialVersionUID`（即使对象没有变化，可能是不同的 jvm 版本），当他们尝试反序列化一个抛出异常：

```
java.io.InvalidClassException: CommissionResult; local class incompatible: 
 stream classdesc serialVersionUID = 8452040881660460728, 
 local class serialVersionUID = -5239021592691549158 
```

他们从一开始就没有为它分配一个固定的值，`serialVersionUID`所以现在有些东西改变了，抛出了异常。现在他们不想丢失任何数据，为此我认为最好的方法是读取对象，反序列化它们，然后通过 XMLEncoder 再次持久化它们，以避免将来出现诸如当前“类不兼容”错误之类的错误。

显然，该对象的持久化有 2 个不同的值，`serialVersionUID`所以我想读取数据，尝试使用一个值，如果失败，则尝试使用另一个值，为此，我[尝试](http://asm.ow2.org)`serialVersionUID`使用 [ASM 接口](http://asm.ow2.org)。我已经能够更改该值，但问题是如何对类进行主动更改，因此当它被反序列化时，`objInpStr.readObject()`将我修改后的类的版本与我的特定`serializedVersionUID`. 我做了一个测试类来模拟真实环境，我取一个对象（它具有不同`serialVersionUID`问题的对象作为属性）对象名称是`Reservation`属性 `CommissionResult`：

```
public class Reservation implements java.io.Serializable {

    private CommissionResult commissionResult = null;

}

public class CommissionResult implements java.io.Serializable{

}

import org.objectweb.asm.ClassReader;
import org.objectweb.asm.ClassVisitor;
import org.objectweb.asm.ClassWriter;
import org.objectweb.asm.commons.SerialVersionUIDAdder;

public class SerialVersionUIDRedefiner extends ClassLoader {

    public void workWithFiles() {
        try {
            Reservation res = new Reservation();
            FileOutputStream f = new FileOutputStream("/home/xabstract/tempo/res.ser");
        ObjectOutputStream out = new ObjectOutputStream(f);

            out.writeObject(res);

            out.flush();
            out.close();

            ClassWriter cw = new ClassWriter(0); 
             ClassVisitor sv = new SerialVersionUIDAdder(cw); //assigns a real serialVersionUID 
             ClassVisitor ca = new MyOwnClassAdapter(sv); //asigns my specific serialVerionUID value
             ClassReader cr=new  ClassReader("Reservation"); 
              cr.accept(ca, 0); 

             SerialVersionUIDRedefiner   loader= new SerialVersionUIDRedefiner(); 
             byte[] code = cw.toByteArray();
             Class exampleClass =        loader.defineClass("Reservation", code, 0, code.length); //at this point the class Reservation has an especific serialVersionUID value that I put with MyOwnClassAdapter

             loader.resolveClass(exampleClass);
             loader.loadClass("Reservation");
             DeserializerThread dt=new DeserializerThread();
             dt.setContextClassLoader(loader);
             dt.run();
    } catch (Exception e) {
            e.printStackTrace();
    }}

import java.io.FileInputStream;
import java.io.ObjectInputStream;

public class DeserializerThread extends Thread {

    public void run() {
        try {
            FileInputStream f2;

            f2 = new FileInputStream("/home/xabstract/tempo/res.ser");

             ObjectInputStream in = new ObjectInputStream(f2);

            Reservation c1 = (Reservation)in.readObject();

            System.out.println(c1);

        } catch (Exception e) {

            e.printStackTrace();
        }
        stop();
    }
}

MyOwnClassAdapter Relevant code:

public void visitEnd() {
        // asign SVUID and add it to the class

            try {

                cv.visitField(Opcodes.ACC_FINAL + Opcodes.ACC_STATIC,
                        "serialVersionUID",
                        "J",
                        null,
                        new Long(-11001));//computeSVUID()));
            } catch (Throwable e) {
                e.printStackTrace();
                throw new RuntimeException("Error while computing SVUID for x"
                        , e);
            }

        super.visitEnd();
    } 
```

测试应该因`java.io.InvalidClassException`“本地类不兼容”而失败，因为我`serialVersionUID`在保存文件并使用新文件读取 de 文件后更改了它，但它没有失败，因此这意味着`ObjectInputStream.readObject`没有使用我修改后的`Reservation`类版本。

有任何想法吗？提前致谢。

！！！！！！！！！！！！！更新：

好的，可以重新定义 resultClassDescriptor 以覆盖流 serialVersionUID，但是，发生了一些奇怪的事情，正如我之前所说，似乎有 2 个版本的类持久化，serialVersionUID = -5239021592691549158L 的对象和其他值为 8452040881660460728L 的对象最后value 是如果我没有为本地类指定值时生成的值。

- 如果我没有为 serialVersionUID 指定值，则使用默认值 (8452040881660460728L)，但无法解除具有其他值的对象，则会引发错误，指出属性属于其他类型。

- 如果我指定值 -5239021592691549158L，则使用该值持久的类将成功反序列化，但其他类则没有，相同的类型错误。

这是错误跟踪：

可能致命的反序列化操作。java.io.InvalidClassException：覆盖序列化类版本不匹配：本地 serialVersionUID = -5239021592691549158 流 serialVersionUID = 8452040881660460728 java.lang.ClassCastException：无法将 java.util.HashMap 的实例分配给字段 com.posadas.ic.rules.common.commisionRules。 com.posadas.ic.rules.common.commisionRules.CommissionResult 实例中 java.lang.String 类型的 CommissionResult.statusCode

抛出此错误时，该类的值为-5239021592691549158，如果将值更改为8452040881660460728，则该类已成功反序列化，那么会发生什么？为什么那个错误会试图转换为错误的类？

谢谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-28T07:15:34.863

Jorge 我在[http://forums.sun.com/thread.jspa?threadID=518416](http://forums.sun.com/thread.jspa?threadID=518416)上找到了一种可行的解决方案。

在您的项目中创建以下类。无论您在何处创建 ObjectInputStream 对象，请改用 DecompressibleInputStream，它会使用新版本 Id 类反序列化旧对象。

```
public class DecompressibleInputStream extends ObjectInputStream {

    public DecompressibleInputStream(InputStream in) throws IOException {
        super(in);
    }

    protected ObjectStreamClass readClassDescriptor() throws IOException, ClassNotFoundException {
        ObjectStreamClass resultClassDescriptor = super.readClassDescriptor(); // initially streams descriptor
        Class localClass = Class.forName(resultClassDescriptor.getName()); // the class in the local JVM that this descriptor represents.
        if (localClass == null) {
            System.out.println("No local class for " + resultClassDescriptor.getName());
            return resultClassDescriptor;
        }
        ObjectStreamClass localClassDescriptor = ObjectStreamClass.lookup(localClass);
        if (localClassDescriptor != null) { // only if class implements serializable
            final long localSUID = localClassDescriptor.getSerialVersionUID();
            final long streamSUID = resultClassDescriptor.getSerialVersionUID();
            if (streamSUID != localSUID) { // check for serialVersionUID mismatch.
                final StringBuffer s = new StringBuffer("Overriding serialized class version mismatch: ");
                s.append("local serialVersionUID = ").append(localSUID);
                s.append(" stream serialVersionUID = ").append(streamSUID);
                Exception e = new InvalidClassException(s.toString());
                System.out.println("Potentially Fatal Deserialization Operation. " + e);
                resultClassDescriptor = localClassDescriptor; // Use local class descriptor for deserialization
            }
        }
        return resultClassDescriptor;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T22:16:43.663

我可能遗漏了一些东西，但*听起来*你正在尝试做一些比必要的更复杂的事情。如果出现以下情况会发生什么：

(a) 您采用当前类定义（即源代码）并将其序列 UID 硬编码为旧的（或旧的之一），然后使用该类定义反序列化序列化实例？

(b) 在您正在读取的字节流中，在将 ObjectInputStream 包裹在它们周围之前，您将旧的串行 UID 替换为新的 UID？

好的，只是为了澄清（b）。例如，如果我有一个像这样的小课：

```
 public static class MyClass implements Serializable {
    static final long serialVersionUID = 0x1122334455667788L;
    private int myField = 0xff;
  } 
```

然后当数据被序列化时，它看起来像这样：

```
ACED000573720011746573742E546573 ¬í..sr..test.Tes
74244D79436C61737311223344556677 t$MyClass."3DUfw
880200014900076D794669656C647870 ?...I..myFieldxp
000000FF ...ÿ 
```

每行是 16 个字节，每个字节是 2 个十六进制数字。如果你仔细看，在第二行的 9 个字节（18 位）中，你会看到序列版本 ID 开始（1122...）。因此，在我们的数据中（您的数据会略有不同），串行版本 ID 的偏移量是 16 + 9 = 25（或十六进制的 0x19）。所以在我开始反序列化之前，如果我想将此序列版本 ID 更改为其他内容，那么我需要在偏移量 25 处写入我的新编号：

```
byte[] bytes = ... serialised data ...
ByteBuffer bb = ByteBuffer.wrap(bytes);
bb.putLong(25, newSerialVersionUID); 
```

然后我照常进行：

```
ObjectInputStream oin = new ObjectInputStream(new ByteArrayInputStream(bytes));
MyClass obj = (MyClass) oin.readObject(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T22:41:37.270

如果您在数据库中存储了该类的多个版本，则一次通过反序列化并将它们全部升级为一致的序列化格式可能会非常棘手。

如果可能，您可以使用列更改表以标记序列化对象是否已被处理。然后为 each 遍历表`serialVersionUID`，在其中尝试处理尚未处理的任何对象。如果您的更新程序遇到一个它无法处理的序列化对象，您可以捕获`InvalidClassException`并继续下一条记录，记下版本号，以便您可以再次通过。

这有点乏味，但非常简单。

Java 序列化有一些非常好的特性来支持类的进化。但是，您必须清楚自己在做什么。可能所有对象实际上都具有相同的数据，但没有注意维护版本 ID。

将所有对象更新到相同版本后，您可以继续使用序列化。在向类中添加新字段时要小心，它们的默认值是有意义的（布尔值为假，对象为空，整数为零等）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-28T00:24:06.820

您应该能够通过覆盖来解决问题`ObjectInputStream.readClassDescriptor`。

`XMLEncoder`由于兼容性规则大致相同，因此使用实际上不会帮助进行版本迁移。真正应该做的是在 ORM 工具的帮助下以关系形式持久化对象。

`serialVersionUID`由于 javac 生成了不同的合成成员，可能会发生不同的 s。头上的警告和投入`serialVersionUID`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-03-22T07:09:01.420

您可以找到 HEX 格式的串行 UID，如果您将序列化数据存储在 db 中，您可以编辑旧 UID 并将其替换为 HEX 格式的新串行 UID

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-08-15T16:35:22.787

可能有点破解，但可能对某人有帮助：我有一个类似的问题，我通过复制有问题的类并将新类 UID 设置为 0L（例如）来解决这个问题。然后在执行序列化的代码中，我将原始对象复制到新对象中并序列化。然后您可以更新您的代码和反序列化代码，以使用新类代替旧类。这很有效，尽管你被新的类名卡住了。但是，您可以重复该过程来恢复旧的类名。最后，您有一个您选择的固定 UID。提示我学到了一个艰难的方法：总是设置你自己的 UID ！

# pdf - 如何在结果质量很大程度上是主观的情况下自动化测试

> ID：795471
> 
> 赞同：2
> 
> 时间：2009-04-27T22:02:58.187
> 
> 标签：pdf, localization, testing-strategies

我一直在通过一系列快速原型开发自动化和统计生成程序，以查看 API 的许可成本是否会产生良好的投资回报。有限的时间框架和我自己有限的经验导致了一个没有自动质量或正确性测试和指标的有用工具。

该程序处理 PDF 文档的本地化过程。具体来说，它会生成有关文件的某些内容（大约字数、图像数等）的报告，并具有一些内容提取和处理功能。它主要用于减少评估PDF本地化项目成本的时间和成本。

该应用程序现已获准用于更正式的开发过程，包括对错误跟踪系统的请求以及初步测试、发布和反馈周期。

那么问题是，您将如何在这种应用程序中进行 QA 和测试，其中数字通常是基于一些启发式的最佳猜测，并且由于源文档的可怕结构，处理后的输出并不总是有用的？我计划在数字明显很疯狂时在报告中添加警告，但是还能做些什么来保证质量呢？

到目前为止，我拥有的最复杂的解决方案是通过构建环境中的断言测试和编写一堆传统的用户测试用例（我宁愿避免）来保证一些辅助方法的结果。

您如何测试主观质量测量？

我在 C# 中工作，但我更喜欢一般的最佳实践答案，而不是任何过于特定于框架的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T22:47:19.657

我不确定您的应用程序到底在做什么，但要回答一般问题：构建代表您的输入范围的测试用例集合，看看它是否可以正确判断这些。您无法真正绕过测试实际输入文档。

然后，有一点你必须接受自动化测试可以完成的事情是有限的。例如，当事情变得非常主观的美学或可用性时）你将需要一个真正的人来获得有用的判断。

我希望我能给出一个更有帮助的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T23:05:41.050

尝试[批准测试](http://approvaltests.sourceforge.net/)。

# vb.net - Excel VBA 转 VB (DCOM)

> ID：795474
> 
> 赞同：4
> 
> 时间：2009-04-27T22:07:22.717
> 
> 标签：vb.net, excel, vba, dcom

我继承了 Excel VBA 电子表格。我的任务是将其转换为 VB。

我认为应用程序使用 DCOM 对象从 PLC 获取数据。以下代码在 MX1.0 更新时运行子 SBR1Select。

```
Sub Workbook_Open()
    ActiveWorkbook.SetLinkOnData "dassidirect|strandburner!MX1.0", "SBR1Select"
End Sub 
```

当我打开控制面板 -> 管理工具 -> 组件服务，然后导航到控制台根目录 -> 组件服务 -> 计算机 -> 我的电脑 -> DCOM 配置项目“DASSIDirect”列出，我相信这是 Excel 引用.

如何通过 DASSIDIRECT 组件将 VB 代码连接到 PLC？

注意：DASSIDIRECT 也是一项 Windows 服务（不确定这是否有助于回答问题）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T23:02:24.987

很久以前，我在 PLC 上做过一些工作，并问了我的一位老同事。他说您需要 WonderWare 的 InTouch，它有一组 .Net 2 兼容的程序集，可与 DASSIDIRECT 配合使用，为您提供所需的东西。

[这是](http://www.wonderwaremidwest.com/pages/IT95SP1_English.htm)最新版本，我希望它是您正在寻找的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T10:16:22.703

哇，DDE。DDE，我相信你知道它已经相当老了。网络 DDE 已被贬低，将不再在 Vista 中工作。我只能想象这种趋势可能会持续下去。但是 user32 中的 DDE API 仍然有效（参考在此处：http: [//msdn.microsoft.com/en-us/library/ms674605](http://msdn.microsoft.com/en-us/library/ms674605(VS.85).aspx) (VS.85).aspx ），您可以从 .net 应用程序调用它，使用一点工作。我能找到的唯一例子是 VB6，即使在那时它们也很旧。我相信你可以想象这有点痛苦。无论如何，我从 API-Guide（来自 Mentalis）中挖出了这个例子。它不是 .Net，但无论如何它应该让你开始：

```
'This application shows you how to use DDE to create a better PrevInstance-function.
'Compile this sample and start it two times
'The first instance minimizes itself and when the second instance is started, it will
'send a message to the first instance to maximize itself.

'in a module
Public Const VBServerName = "TestServer"
Public Const VBTopicName = "SHOW_YOUR_MAIN_WINDOW"
Public Const XCLASS_BOOL = &H1000
Public Const XTYPF_NOBLOCK = &H2 ' CBR_BLOCK will not work
Public Const XTYP_CONNECT = &H60 Or XCLASS_BOOL Or XTYPF_NOBLOCK
Public Const CP_WINANSI = 1004 ' default codepage for windows & old DDE convs.
Public Const SW_RESTORE = 9
Public Const DDE_FACK = &H8000
Public Const XCLASS_FLAGS = &H4000
Public Const XTYP_EXECUTE = &H50 Or XCLASS_FLAGS
Public Const DNS_REGISTER = &H1
Public Const DNS_UNREGISTER = &H2
Public Declare Function DdeInitialize Lib "user32" Alias "DdeInitializeA" (pidInst As Long, ByVal pfnCallback As Long, ByVal afCmd As Long, ByVal ulRes As Long) As Integer
Public Declare Function DdeCreateStringHandle Lib "user32" Alias "DdeCreateStringHandleA" (ByVal idInst As Long, ByVal psz As String, ByVal iCodePage As Long) As Long
Public Declare Function DdeConnect Lib "user32" (ByVal idInst As Long, ByVal hszService As Long, ByVal hszTopic As Long, pCC As Any) As Long
Public Declare Function DdeNameService Lib "user32" (ByVal idInst As Long, ByVal hsz1 As Long, ByVal hsz2 As Long, ByVal afCmd As Long) As Long
Public Declare Function DdeFreeStringHandle Lib "user32" (ByVal idInst As Long, ByVal hsz As Long) As Long
Public Declare Function DdeQueryString Lib "user32" Alias "DdeQueryStringA" (ByVal idInst As Long, ByVal hsz As Long, ByVal psz As String, ByVal cchMax As Long, ByVal iCodePage As Long) As Long
Public Declare Function DdeUninitialize Lib "user32" (ByVal idInst As Long) As Long
Function DdeCllback(ByVal uType As Long, ByVal uFmt As Long, ByVal hConv As Long, ByVal hszTopic As Long, ByVal hszItem As Long, ByVal hData As Long, ByVal dwData1 As Long, ByVal dwData2 As Long) As Long
    DdeCllback = Form1.AppDdeCallback(uType, uFmt, hConv, hszTopic, hszItem, hData, dwData1, dwData2)
End Function
'in a form
Dim isRun As Boolean, idInst As Long, hszVBServer As Long, hszVBTopic As Long
Dim hconvVBServer As Long, dderesult As Long
Private Sub Form_Load()
   'KPD-Team 2000
   'URL: http://www.allapi.net/
   'E-Mail: KPDTeam@Allapi.net
   If DdeInitialize(idInst, AddressOf DdeCllback, 0, 0) Then Exit Sub
   hszVBServer = DdeCreateStringHandle(idInst, VBServerName, CP_WINANSI)
    hszVBTopic = DdeCreateStringHandle(idInst, VBTopicName, CP_WINANSI)
    'try to find the first instance
    hconvVBServer = DdeConnect(idInst, hszVBServer, hszVBTopic, ByVal 0&)
    If hconvVBServer Then
        Unload Me
        Exit Sub
    End If
    DdeNameService idInst, hszVBServer, 0, DNS_REGISTER
    Me.WindowState = vbMinimized
End Sub
Private Sub Form_Unload(Cancel As Integer)
        DdeFreeStringHandle idInst, hszVBServer
        DdeFreeStringHandle idInst, hszVBTopic
        'only unregister the DDE server for first instance
        If isRun Then
            If DdeNameService(idInst, hszVBServer, 0, DNS_UNREGISTER) Then
                MsgBox "in ServiceUnRegister", vbOKOnly, "Error"
            End If
        End If
        DdeUninitialize idInst
End Sub
Function AppDdeCallback(ByVal wType As Long, ByVal wFmt As Long, ByVal hConv As Long, ByVal hszTopic As Long, ByVal hszItem As Long, ByVal hData As Long, ByVal lData1 As Long, ByVal lData2 As Long) As Long
        Dim iCount As Long, Buffers As String, Ret As Long
        Select Case wType
            Case XTYP_CONNECT
                iCount = DdeQueryString(idInst, hszTopic, vbNullString, 0, CP_WINANSI)
                Buffers = Space(iCount)
                DdeQueryString idInst, hszTopic, Buffers, iCount + 1, CP_WINANSI
                If Buffers = VBTopicName Then
                    Me.WindowState = vbNormal
                    'add any code for the first instance have found the second one is launch
                    Ret = DDE_FACK
                End If
                AppDdeCallback = Ret
            Case XTYP_EXECUTE
                AppDdeCallback = Ret
        End Select
End Function 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-15T01:16:38.370

处理此问题的最简单方法是使用 VB 6 并创建一个“ActiveX EXE”，它将 DDE 与 SIDirect 通信。从 VB 6 做 DDE 是微不足道的。然后使用 tlbimp 公开为 VB 6 模块创建主互操作程序集，或者简单地将 EXE 作为 C# 代码中的 COM 组件引用。

# c# - 这可能是一个 lambda 表达式吗？

> ID：795483
> 
> 赞同：3
> 
> 时间：2009-04-27T22:10:02.943
> 
> 标签：c#, linq, lambda

我知道

```
from f in list 
where f.bar == someVar
select f 
```

可以写成

```
list.Where( f => f.bar == someVar ); 
```

是否可以创建类似的表达式

```
from f in foo
from b in f.bar
where b.something == someVar
select b; 
```

?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-27T22:16:30.073

`from`映射（用于后续术语）到`SelectMany`：

```
var query = foo.SelectMany(f=>f.bar).Where(b=>b.something==someVar); 
```

（请注意，`Select`琐碎的预测不需要final）

# c# - .NET 中的精确计时

> ID：795484
> 
> 赞同：10
> 
> 时间：2009-04-27T22:10:13.227
> 
> 标签：c#, .net, midi, timing, naudio

我刚刚看到[这个问题](https://stackoverflow.com/questions/795377/what-if-any-is-the-resource-penalty-for-using-system-diagnostics-stopwatch)，其中一个答案表明[System.Diagnostics.Stopwatch](http://msdn.microsoft.com/en-us/library/system.diagnostics.stopwatch(loband).aspx)应该只用于诊断性能，而不是用于生产代码。

在这种情况下，在 .NET 中获得精确计时的最佳方法是什么？我目前正处于使用[NAudio](http://www.codeplex.com/naudio)的 MIDI 输出功能构建一个非常简单的[MIDI 音](http://en.wikipedia.org/wiki/Musical_Instrument_Digital_Interface)序器的早期阶段。我希望能够以尽可能少的抖动将 MIDI 消息发送到（比如说）1/10 秒。这是可行的，还是像上下文切换这样的事情会毁了我的一天？

我目前在控制台应用程序中有一些代码，它`Stopwatch`在以 150bpm 生成 1/16 音符流时不断调用和计算抖动。在这种情况下，抖动非常低。但是，我将把它移到另一个线程，所以我不知道这种情况是否会继续存在。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-27T22:13:34.230

如果不介意P/Invoke，可以使用QueryPerformanceCounter：[http ://www.eggheadcafe.com/articles/20021111.asp](http://www.eggheadcafe.com/articles/20021111.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-08T14:10:37.443

你也可以使用原生的流媒体 MIDI API。我不认为它在 NAudio 中，但您可以查看 C# Midi Toolkit 以查看它是否支持它。否则，您有两个示例说明如何执行本机 MIDI API P/Invoke，并且可以自己滚动...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-17T21:59:30.600

[Windows 多媒体计时器](https://msdn.microsoft.com/en-us/library/dd742877%28v=vs.85%29.aspx)声明它允许“应用程序以硬件平台可能的最大分辨率（或精度）来安排计时器事件”。

它用作示例的应用程序是 MIDI 音序器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-08-21T13:43:25.227

我是[DryWetMIDI](https://github.com/melanchall/drywetmidi)的作者。该库具有播放功能，可在 WinMM 高精度计时器的帮助下工作。Timer 被封装到[MidiClock](https://melanchall.github.io/drywetmidi/api/Melanchall.DryWetMidi.Devices.MidiClock.html)类中，因此您可以使用它来驱动您的 MIDI 操作：

```
var midiClock = new MidiClock(true, new HighPrecisionTickGenerator(), TimeSpan.FromMilliseconds(1));
midiClock.Ticked += OnTick; 
```

`OnTick`将使用此代码每 1 毫秒调用一次。

# c# - 锁定指定对象和锁定次要对象有什么区别？

> ID：795489
> 
> 赞同：1
> 
> 时间：2009-04-27T22:11:03.223
> 
> 标签：c#, .net

最近我的一个朋友问我，他刚刚开始玩线程，使用辅助对象纯粹用于锁定或仅锁定您引用的对象之间的区别是什么。我不得不承认我不知道，谁能告诉我？我将尝试使用几个代码片段进行演示：

第一种方法：

```
List<string> data = new List<string>();
object datalock = new object();

void main()
{
    lock(datalock)
    {
        if (data.contains("SomeSearchString"))
        {
            //Do something with the data and then remove it
        }
    }
} 
```

第二种方法：

```
List<string> data = new List<string>();

void main()
{
    lock(data)
    {
        if (data.contains("SomeSearchString"))
        {
            //Do something with the data and then remove it
        }
    }
} 
```

是否有显着差异，或者这取决于个人编码风格？如果有显着差异，谁能解释它是什么？

我确实遇到了另一个问题 [ [lock(locker) 和 lock(variable_which_I_am_using) 之间的区别](https://stackoverflow.com/questions/230716/difference-between-locklocker-and-lockvariablewhichiamusing)]，其中答案暗示这两者是等价的，但如果是这样的话，哪一个最好用，为什么？

我在网上看到很多例子，我倾向于使用第一种方法作为个人选择，但我想知道使用第二种方法的优点是什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-27T22:13:44.340

最大的区别在于**，只有您的代码知道**的次要对象不会因*其他*代码（不是您的代码）锁定主要对象（通常可用于其他代码）。

IMO，也许 CLR 团队使用显式类型会做得更好`Lock`——或者`Monitor`应该是非静态的，等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T22:16:54.520

Marc 已经介绍了最重要的一点，但我更喜欢第一种模式，因为它还为读写锁或任何其他可能对您的特定用途有用的粒度级别提供了单独的对象的范围。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T22:18:19.320

从根本上说，没有区别。如果所有线程不安全操作都锁定在同一个对象上，则没有区别。但是，从实施的角度来看，可能存在差异。如果其他线程需要访问需要独占锁的对象，则必须确保使该同步对象可用并明确需要锁定哪个对象。

另一方面，在某些情况下，您实际上可能会将值分配给锁定块中的不同内容。在这种情况下，您显然需要锁定一个不相关的对象。

它归结为个人偏好和可维护性（是否需要锁定第二个对象，一个坏主意，还是两者都不需要？）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T22:21:24.710

使用不同的对象锁定允许更多的同步粒度和性能。如果您锁定同一个对象，则一项操作可能会不必要地阻塞另一项操作。如果使用 lock(this)，所有并发操作都必须等到拥有锁的操作释放它。但是，这可能不是必需的，因为某些操作可能不会访问相同的资源。因此，您不必要地锁定了它们，从而损害了性能。相反，对不同的共享资源组使用不同的同步对象，并让您的操作对他们需要访问的资源使用相应的锁。

# c++ - C++：读取数据怎么可能影响内存？

> ID：795496
> 
> 赞同：5
> 
> 时间：2009-04-27T22:14:30.983
> 
> 标签：c++, mpi, corruption

我最近一直在深入研究 C++，我的错误似乎变得复杂。

我有一个对象向量，每个对象都包含一个浮点向量。我决定我需要创建一个进一步的平面数组，其中包含所有对象的所有浮点值。它比这要复杂一些，但问题的要点是，当我遍历对象以提取浮点值时，在某些时候，我的对象向量会发生变化，或者以某种奇怪的方式损坏。（我的读操作都是const函数）

另一个例子是 MPI。我刚刚开始，所以我只想在两个不同的节点上运行完全相同的代码，它们有自己的内存并且没有发生数据传输，这一切都非常简单。令我惊讶的是，我遇到了分段错误，经过数小时的跟踪，我发现一个变量的一个赋值是将一个完全不同的变量设置为 NULL。

所以我很好奇，读操作怎么可能影响我的数据结构。同样，看似无关的操作如何影响另一个操作。我不能指望用这些简短的描述来解决我的问题，但是任何建议都将不胜感激。

更新：这是一段代码，我最初没有发布，因为我不确定在不了解整个系统的情况下可以从中提取多少。

我刚刚发现的一件事是，当我停止将值分配给我的平面数组而只是 cout'ed 时，段错误消失了。所以也许我声明我的数组是错误的，但即使我不确定它会如何影响对象向量。

```
void xlMasterSlaveGpuEA::FillFlatGenes() {
    int stringLength = pop->GetGenome(0).GetLength();
    for (int i=0;i<pop->GetPopSize();i++)
        for (int j=0;j<stringLength;j++)
            flatGenes[(i*stringLength)+j]<< pop->GetGenome(i).GetFloatGene(j);
}

float xlVectorGenome::GetFloatGene(unsigned int i) const {
    return GetGene(i);
} 
```

我的平面数组是一个成员函数

```
float * flatFitness; 
```

在构造函数中初始化，如下所示：

```
flatFitness = new float(popSize); 
```

更新 2：

我只想指出，上面的两个例子没有关系，第一个不是多线程的。第二个 MPI 示例在技术上，但 MPI 是分布式内存，我特意尝试了我能想到的最简单的实现，即两台机器独立运行代码。然而，还有一个额外的细节，我放了一个有条件的说法

```
if node 1 then do bottom half of loop

if node 1 then do top half 
```

再次，内存应该被隔离，它们应该像彼此一无所知一样工作..但是删除这个条件并使两个循环都执行所有立方体，消除了错误

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-27T22:28:30.920

这不是数组构造函数：

```
float * flatFitness;
flatFitness = new float(popSize); 
```

你在这里的堆上创建一个浮点数，用 value 初始化`popSize`。如果你想要一个浮点数组，你需要使用括号而不是括号：

```
float *flatFitness = new float[popSize]; 
```

这很容易导致您描述的问题。另外，请记住，当您创建数组时，您需要使用`delete []`（最终）删除：

```
delete [] flatFitness; 
```

如果您只使用`delete`，它可能会起作用，但行为是未定义的。

如果您想完全避免使用数组语法，为什么不使用`std::vector`? 您可以像这样创建 popSize 元素的向量：

```
#include <vector>

std::vector<float> flatFitness(popSize); 
```

这将在超出范围时自动释放，因此您不必担心`new`or `delete`。

**更新（回复：评论）：** 如果您已经`std::vectors`在代码的其他地方使用，请查看`std::vector::swap()`. 您可以完全避免复制内容，只需在 CUDA 缓冲和您在此处进行的处理之间来回交换几个向量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T22:16:57.717

我怀疑你有你不知道的多线程或内存损坏问题。您描述的行为不是任何标准的、设计的、理想的行为。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-27T22:23:58.653

jeffamaphone 可能是正确的，这是一个线程问题。另一种可能性是您正在阅读的对象已被删除。然后，您将从无效地址读取。您此时写入的数据结构也可能存储在向量以前占用的相同位置。这将导致您描述的行为。

**编辑**（根据您的更新）：

这可能是错误`stringLength`的：在外循环之外初始化，但看起来它需要在外循环期间更新：

```
int stringLength = pop->GetGenome(0).GetLength();
for (int i=0;i<pop->GetPopSize();i++)
    for (int j=0;j<stringLength;j++)
        flatGenes[(i*stringLength)+j]<< pop->GetGenome(i).GetFloatGene(j); 
```

建议修复：

```
for (int i=0;i<pop->GetPopSize();i++) {
    int stringLength = pop->GetGenome(i).GetLength();
    for (int j=0;j<stringLength;j++) {
        flatGenes[(i*stringLength)+j]<< pop->GetGenome(i).GetFloatGene(j);
    }
} 
```

# asp.net-mvc - ASP.NET MVC 在新页面而不是 UpdateTargetId 中显示 ajax 结果

> ID：795498
> 
> 赞同：1
> 
> 时间：2009-04-27T22:15:16.240
> 
> 标签：asp.net-mvc, asp.net-mvc-ajax

我正在使用 Ajax.BeginForm 发出 ajax 请求，但 asp.net mvc 在新页面中显示结果，而不是在 UpdateTargetId 中设置的 div。我确保页面上只有一个同名的 div。

生成的标记是：

```
<form action="/MyController/MyAction" id="myform" method="post" onsubmit="Sys.Mvc.AsyncForm.handleSubmit(this, new Sys.UI.DomEvent(event), { insertionMode: Sys.Mvc.InsertionMode.replace, updateTargetId: 'myDiv', onSuccess: Function.createDelegate(this, someJsFunction) });">
    <input type="text" name="name" id="userInput" value="" />
    <input type="submit" id="mySubmit" style="display:none" />
    </form><div id="myDiv"></div> 
```

在这里，提交按钮没有显示，因为我是用 javascript 单击它（我在另一个页面上使用相同的方法，它有效）：

```
$(document).ready(function() {
            $("[name:'name']").bind("keyup", function() {
                $("#mySubmit").click();
            }) 
```

我正在使用最新版本的 asp.net mvc。我没有收到脚本错误，我仔细检查了所有 id 的唯一性，所有 js 函数都存在并且可以正常工作。标记是 html 严格有效的，除了输入不能直接在表单中，但在其他页面上可以正常工作。服务器端代码运行成功，返回的标记完全正确。一切似乎都很好，只是结果显示在新页面上而不是在我的 div 中。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-03-03T04:55:47.610

I had the very same problem, and the solution was referencing MicrosoftAjax.js and MicrosoftMvcAjax.js, which I had forgotten.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T07:03:00.043

首先是一般提示：为什么要单击不可见的提交按钮才能提交？你也可以只使用：

```
 $("#myform").submit(); 
```

和你的问题有关，肯定是javascript代码有问题，也许你没有在页面上包含ajax js库......因为如果javascript失败，表单将使用提供的post方法正常提交行动。尝试在 IE 中打开客户端脚本调试（实际上您必须在工具/Internet 选项的高级面板中禁用“禁用脚本调试”。或者使用[Firebug](http://getfirebug.com/) for Firefox。

# c# - 研究课题列表

> ID：795504
> 
> 赞同：3
> 
> 时间：2009-04-27T22:17:04.067
> 
> 标签：c#, c++, visual-studio-2008

我有使用 Visual Studio 6.0 使用 C++ 开发 MFC 应用程序的经验。你可以猜到那是多久以前的事了（提示：持续 10 年）。我正在尝试更新我的技能，但发生了很多变化。如何让这些技能与时俱进？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T22:36:15.957

在 C++ 中？boost绝对值得一玩。

C# 是一种很好的互补语言。WPF 是一个很好的 MFC 替代品。

MFC 也得到了改进，因此您可以创建具有现代外观的应用程序，值得一看。仍然有很多人创建本机代码 Windows 应用程序。

*   选择某种脚本语言，lua，python，ruby ......
*   选择某种函数式语言，haskell，F#，或其他东西

*   了解 ORM

*   设计模式
*   TDD 和单元测试
*   重构

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T23:48:32.897

如果我是你，我会学习 Web 开发。这就是现在很多工作的发展方向，它需要多种技能，并且会扩展你对软件应该如何编写的理解（对网络的无状态特性）。

# linux - 旧版链接器（使用 libc5）在 linux 内核 2.6.25 上失败

> ID：795510
> 
> 赞同：2
> 
> 时间：2009-04-27T22:19:49.177
> 
> 标签：linux, linker, legacy, glibc, libc

我们有一个使用 libc5 的旧版链接器，由于多种因素，我们只有二进制文件而不是源代码。是的，版本控制可以让我们摆脱当前的问题......现在我们的完整工具链和产品线都在使用它，但是这匹特别的马早已不复存在。

此链接器适用于 linux 内核 2.6.24，但在 2.6.25（和 2.6.26）上失败并显示消息

```
    “新”中超出虚拟内存

```

我们在使用相应的旧版编译器时遇到了类似的问题，但是通过一些 stackoverflow.com的[答案](https://stackoverflow.com/questions/779964/legacy-gcc-compiler-issues)和大量研究发现，编译器问题是由 linux 内核 2.6.25 中的“brk 随机化”引起的。解决方法是设置 sysctl vars 和 environment var：

```
    /proc/sys/kernel/randomize_va_space = 0 或 1
    setenv MALLOC_TOP_PAD_ 536870912

```

但是，这对链接器没有帮助。

我通过使用“ldd”发现链接器具有更多的共享库依赖项（编译器只有 libc.so.5）：

```
    libg++.so.27 => /usr/lib/libg++.so.27 (0xb7eca000)
    libstdc++.so.27 => /usr/lib/libstdc++.so.27 (0xb7e99000)
    libm.so.5 => /lib/libm.so.5 (0xb7e90000)
    libc.so.5 => /lib/libc.so.5 (0xb7dd3000)

```

而且我已经读到我可能必须安装 libg++.so.27 的 libc5 版本。我犹豫是否这样做，因为我不知道这是否会覆盖最新的 libg++.so.27 并导致非 libc5 应用程序出现问题。

那么，我是否找到并安装了 libc5 版本的 libg++.so.27，或者是否有更好的方法来禁用 brk 随机化，或者内核 2.6.24 和 2.6.25 之间是否存在导致链接器问题的另一个区别？

**编辑**

有关[此](https://stackoverflow.com/questions/779964/legacy-gcc-compiler-issues)搜索的所有详细信息以及我的最终解决方案，请参阅此内容。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-28T05:01:53.080

它不能准确回答您的问题，但在您的情况下，我会创建一个具有已知可工作的 libc + libstdc++ 组合的 chroot，甚至是 kernel+libc+libstdc++（在这种情况下，您显然需要一个虚拟机）。这样，您可以相对轻松地尝试事情，而不会破坏其他任何事情。

毕竟，与旧库兼容的最好方法是使用这个旧库，因为它“只是”一个工具链问题，所以使用某种监狱/chroot/虚拟机应该不是什么大问题？

# php - 如何在 PHP 中实现前向索引？

> ID：795512
> 
> 赞同：11
> 
> 时间：2009-04-27T22:19:56.913
> 
> 标签：php, parsing, indexing

我希望在 PHP 中实现一个简单的正向索引器。是的，我确实明白 PHP 几乎不是完成这项任务的最佳工具，但我还是想这样做。它背后的理由很简单：我想要一个，并且在 PHP 中。

让我们做一些基本假设：

1.  整个 Interweb 由大约五千个 HTML 和/或纯文本文档组成。每个文档驻留在特定域**(UID)**中。我们想象中的洞穴式互联网中不存在其他专有/神秘格式。

2.  我们出色的基于 PHP 的前向索引算法的结果应该是：

    UID1 -> index.html -> helen,she,was,champion,with,freckles

    UID1 -> foo.html -> 鸡，农民，去，回家，吃，羊

    UID2 -> blah.html -> 下一个、周、上、badgerwatch

    UID2 -> gah.txt -> 一，一，和，一，是，不是，numberwang

理想情况下，我希望看到解决方案考虑到，即使是最基本的，标记化/词边界消歧/词性标记的概念。当然，我确实意识到这是一厢情愿的想法，因此将通过以下方式降低解析所述虚构文件的任何有价值的尝试：

1.  将文档中的真实文本内容提取为按出现顺序排列的单词列表。
2.  一直以来，忽略任何垃圾，例如`<script>`和`<html>` 标签来计算 UID 列表（例如，可能是域），然后是文档名称（域中的资源），最后是该文档的单词列表。我确实意识到 HTML 标记在文档中文本的语义放置中起着重要作用，但在这个阶段我**并不关心**。
3.  请记住，一种可以在阅读文档时构建单词列表的解决方案比需要首先阅读整个文档的解决方案更酷。

在这个阶段，我不关心存储的位置或方式。即使是一套基本的“打印”语句也足够了。

在此先感谢，希望这足够清楚。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-27T23:46:01.140

看一眼

[http://simplehtmldom.sourceforge.net/](http://simplehtmldom.sourceforge.net/)

你做类似的事情

```
$p = new Simple_dom_parser();
$p->load("www.page.com");
$p->find("body")->plaintext; 
```

这将为您提供所有文本。只想遍历链接

```
foreach ($p->find("a") as $link)
{
    echo $link->innerText;
} 
```

它非常有用且功能强大。看看这个。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-27T22:34:41.373

我不认为我完全清楚你想要做什么，但你可以很容易地得到一个简单的结果：

1.  通过[Tidy](http://php.net/tidy)运行页面（[一个很好的介绍](http://devzone.zend.com/article/761-Tidying-up-your-HTML-with-PHP-5)）以确保它具有有效的 HTML。
2.  扔掉之前（包括）的所有东西`<body>`。
3.  一次一个字符地浏览文档。
    1.  如果字符是 '<'，在看到 '>' 之前不要对后面的字符执行任何操作（跳过 HTML）
    2.  如果字符是“单词字符”（字母数字、连字符，可能更多），则将其附加到“当前单词”。
    3.  如果字符是“非单词字符”（标点、空格，可能更多），将“当前单词”添加到前向索引中的单词列表中，并清除“当前单词”。
4.  执行上述操作，直到您击中`</body>`.

就是这样，您可能必须添加一些例外来处理诸如`<script>`标签之类的事情（您不想将javascript视为应该被索引的单词），但这应该会给您一个基本的前向索引。

# windows-server-2008 - 适用于 Windows Server 2008 的 MSDN 下载

> ID：795514
> 
> 赞同：1
> 
> 时间：2009-04-27T22:20:42.967
> 
> 标签：windows-server-2008, hyper-v

我目前正在 MSDN 订阅站点上查看适用于 Windows Server 2008 的可用 ISO 列表，我需要知道下载哪个 ISO 以使用 Hyper-V 功能。

我拥有带有 MSDN Premium 许可证的 Visual Studio Team System Development Edition。

跟进[有关](https://stackoverflow.com/questions/795645/windows-server-2008-hyper-v-on-x86-processor)使用和不使用 Hyper-V 的可用 ISO（x86 和 X64）的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T22:46:29.770

您可以使用 x64 Standard、Enterprise 或 Data Center。[Hyper-V 入门指南](https://technet.microsoft.com/en-us/library/cc732470.aspx)中提供了这些信息以及更多信息。

# c# - C# 如何防止 TcpClient 对象在我使用 new 关键字创建的不同线程中进行处理？

> ID：795518
> 
> 赞同：0
> 
> 时间：2009-04-27T22:22:04.053
> 
> 标签：c#, multithreading, object, runtime-error, disposing

所以我试图用 C# 为我的服务器创建一个客户端，它接受消息作为命令，这样我就可以远程控制客户端。我的 masterServer.Connect 一直在加载，几乎每次我关闭我的应用程序时，我都必须等待 10 秒才能完全停止。我已经尽一切努力阻止这...没有运气。所以我已经放弃了，现在要解决另一个问题，我正在使用 masterServer = new TcpClient() 这似乎在 CreateConnection() 线程中工作得很好。但是当线程完成时，我在某处调用 SendClientInfo() 并导致此运行时错误：

***无法访问已释放的对象 System.Net.Sockets.TcpClient***

因此，我已尽力想办法在对象处置或其他任何事情之前保存对象，但我就是不知道该怎么做。所以这是我的问题：

1.  如何防止 mainServer = new TcpClient() 处理，以便我可以在我的 SendClientInfo() 上使用它？
2.  任何人都可以重做我的 CreateConnection() 方法，以便我可以看到如何正确地做到这一点吗？我已经重写了那东西一千次，但它看起来仍然非常错误，如果 masterServer.connect() 还没有连接到服务器，它需要永远完成。
3.  您可以在此处查看任何其他更改或修复。我已经进进出出好几个小时了，只是想通过阅读一百个教程来教自己如何使用套接字。任何你告诉我我做错了的事情，我都会永远记住并在下一次正确地做。

如果您需要更多信息，请告诉我......我真的很感激。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Net;
using System.Net.Sockets;
using System.Threading;
using System.IO;

namespace RemoteClient
{
    public partial class Form1 : Form
    {
        private int MyPort = 56789;
        private IPAddress myIp = IPAddress.Parse("210.232.115.79");
        private IPAddress serverIp = IPAddress.Parse("72.216.18.77"); // Master Server's IP Address
        public static TcpClient masterServer = new TcpClient();

        private StreamWriter responseWriter;
        private StreamReader commandReader;

        private Thread connectionThread;
        private Thread commandsThread;

        private bool RequestExitConnectionThread { get; set; }

        private delegate void AddMessageDelegate(string message, int category);
        private delegate void ConnectedDelegate();

        private bool isConnected { get; set; }

        public Form1()
        {
            InitializeComponent();
            isConnected = false;
        }

        private void LogMessage(string message, int category)
        {
            if (category == 1)
            {
                ListViewItem item = new ListViewItem(message);
                item.BackColor = Color.LightGreen;
                item.UseItemStyleForSubItems = true;
                Log.Items.Add(item).SubItems.Add(DateTime.Now.ToString());
            }
            if (category == 2)
            {
                ListViewItem item = new ListViewItem(message);
                item.BackColor = Color.Orange;
                item.UseItemStyleForSubItems = true;
                Log.Items.Add(item).SubItems.Add(DateTime.Now.ToString());
            }
            if (category == 3)
            {
                ListViewItem item = new ListViewItem(message);
                item.BackColor = Color.Yellow;
                item.UseItemStyleForSubItems = true;
                Log.Items.Add(item).SubItems.Add(DateTime.Now.ToString());
            }
            if (category == 0)
            {
                Log.Items.Add(message).SubItems.Add(DateTime.Now.ToString());
            }
        }

        private void Connected()
        {
            LogMessage("Found and Accepted Master Server's connection. Waiting for reply...",1);
            Status.Text = "Connected!";
            Status.ForeColor = Color.Green;

            commandsThread = new Thread(new ThreadStart(RecieveCommands));

            sendClientInfo();
        }

        private void exitButton_Click(object sender, EventArgs e)
        {
            Disconnect();
            exitButton.Enabled = false;
            exitButton.Text = "Closing...";

            if (connectionThread != null)
            {
                while (connectionThread.IsAlive)
                {
                    Application.DoEvents();
                }
            }

            this.Close();
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            Connect();
        }

        private void Disconnect()
        {
            RequestExitConnectionThread = true;

            if (masterServer != null)
                masterServer.Close();

            if (connectionThread != null)
                connectionThread.Abort();

            LogMessage("Closing Client. Please wait while Program threads end.", 2);
        }

        private void Disconnected()
        {
            Status.Text = "Disconnected";
            Status.ForeColor = Color.Red;
            Connect();
        }

        private void Connect()
        {
            LogMessage("Attempting to connect to Master Server...", 1);

            connectionThread = new Thread(new ThreadStart(CreateConnection));
            connectionThread.Start();
        }

        private void CreateConnection()
        {
            int i = 1;
            bool success = false;

            while (!success)
            {
                try
                {
                    using (masterServer = new TcpClient())
                    {
                        IAsyncResult result = masterServer.BeginConnect(serverIp, MyPort, null, null);
                        success = result.AsyncWaitHandle.WaitOne(1000, false);
                    }

                    if (success)
                    {
                        BeginInvoke(new ConnectedDelegate(this.Connected), new object[] {});
                        break;
                    }
                    else
                    {
                        Thread.Sleep(2000);
                        BeginInvoke(new AddMessageDelegate(LogMessage), new object[] { "Connection Retry # " + i.ToString() + ". Master Server hasn't been started yet.", 3 });
                    }
                }
                catch
                {
                    MessageBox.Show("Error!");
                }
                i++;
            }

        }

        private void RecieveCommands()
        {
            MessageBox.Show("Hello!");
            commandReader = new StreamReader(masterServer.GetStream());

            string CommandResponse = commandReader.ReadLine();
            string Command = null;

            if (CommandResponse != null)
                MessageBox.Show("Recieved Command that was NOT null!");

            if (CommandResponse != null)
            {
                MessageBox.Show("Recieved null response!");
                BeginInvoke(new AddMessageDelegate(LogMessage), new object[] { "Disconnected From Master Server. Reason: Recieved Null response.", 1 });
                Disconnected();
            }
            else if (CommandResponse.StartsWith("0"))
            {
                MessageBox.Show("Recieved 0 as a response!");
                Command = CommandResponse.Substring(2).Trim();

                isConnected = false;
                BeginInvoke(new AddMessageDelegate(LogMessage), new object[] { "Disconnected From Master Server. Reason: " + Command, 1 });
            }
            else if (CommandResponse.StartsWith("1"))
            {
                MessageBox.Show("Recieved 1 as a response!");
                isConnected = true;
                BeginInvoke(new AddMessageDelegate(LogMessage), new object[] { "Connected to Master Server Successfully.", 1 });
            }
        }

        //************************** RESPONSE'S BELOW HERE ************************* \\

        private void sendClientInfo()
        {
            responseWriter = new StreamWriter(masterServer.GetStream());

            responseWriter.WriteLine(myIp.ToString());
            responseWriter.Flush();
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T22:26:12.173

在这种情况下，您不应该使用`using`块。事实上，除非有一些没有想到的疯狂场景，否则永远不要**在该范围之外声明的变量上****使用块。`using`**该`using`块在块完成时调用该`Dispose()`方法，这就是您的服务器被处置的原因。只需更改您的代码以删除该块，您就应该准备就绪。像这样：

```
masterServer = new TcpClient();

IAsyncResult result = masterServer.BeginConnect(serverIp, MyPort, null, null);
success = result.AsyncWaitHandle.WaitOne(1000, false); 
```

# wpf - WPF DataGrid Take() 不适用于 ItemsSource

> ID：795521
> 
> 赞同：1
> 
> 时间：2009-04-27T22:23:50.867
> 
> 标签：wpf, linq, filter

我正在尝试将 DataGrid 绑定到 Array 以进行测试。只要我不尝试过滤任何东西，自动列就可以很好地工作。

一旦我尝试通过 .Take(5) 或任何其他过滤器过滤数组，行就会保持空白，并且只有水平线。我认为这可能与 Take 生成的“匿名”类有关。但这是一个疯狂的猜测......

让我向您展示一些运行良好的代码，并且可以满足我的要求：

```
public partial class WindowLister : UserControl
{
    private int counter = 0;
    public WindowLister()
    {
        InitializeComponent();
        dataGrid1.ItemsSource = SystemWindow.FilterToplevelWindows(filterFunction);
    }

    private bool filterFunction(SystemWindow window)
    {
        counter++;
        if (counter > 5) return false;
        return true;
    }
} 
```

现在不起作用的版本：

```
public partial class WindowLister : UserControl
{
    public WindowLister()
    {
        InitializeComponent();
        dataGrid1.ItemsSource = SystemWindow.FilterToplevelWindows(filterFunction).Take(5);
    }

    private bool filterFunction(SystemWindow window)
    {
        return true;
    }
} 
```

对于任何感兴趣的人，使用的源代码来自非常好的 Lib：ManagedWinapi.Windows；

任何帮助表示赞赏......克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T22:25:12.877

我希望你需要一个列表（`Take`/`Where`等会给你一个`IEnumerable<T>`/`IQueryable<T>`序列）。尝试使用`.Take(5).ToList()`，或`.Where(...).ToList()`等（`...`您的过滤器在哪里）。

# ssis - 将 COMP-3 压缩十进制字段解释为数值

> ID：795523
> 
> 赞同：5
> 
> 时间：2009-04-27T22:24:48.510
> 
> 标签：ssis, cobol, comp-3

我正在创建一个 SSIS 包以从一系列字帖文件中读取未打包的数据。我不确定对以下字段定义的正确解释，并希望有人知道：

FIELD-NAME-1 PIC S9(15)V9(3) COMP-3。
FIELD-NAME-2 PIC S9(3)V9(8) COMP-3。
FIELD-NAME-3 PIC S9(3)V9(6) COMP-3。

数据以固定宽度的文本存储。上述字段的数据具有以下长度：

字段名称 1：19 字段名称 2：11 字段名称 3：9

我不确定如何解释小数位和符号。

任何帮助将不胜感激。

亲切的问候，火腿

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-30T01:32:45.187

See method getMainframePackedDecimal in [http://jrecord.cvs.sourceforge.net/viewvc/jrecord/jrecord/src/net/sf/JRecord/Common/Conversion.java?revision=1.2&view=markup](http://jrecord.cvs.sourceforge.net/viewvc/jrecord/jrecord/src/net/sf/JRecord/Common/Conversion.java?revision=1.2&view=markup)

for an example of converting packed decimal in java (it is part of the jrecord project jrecord.sf.net)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-28T19:32:31.240

这是回答您问题的一些不同尝试。

PIC S9(15)V9(3) COMP-3 在文件中如下所示：

```
 00 00 00 00 00 00 00 00 00 0F 
```

如果值为 -4568248.323，则为：

```
 00 00 00 00 04 56 82 48 32 3D 
```

这对您没有帮助，但可能会帮助其他人。解压之前的值如下所示：

```
F0 F0 F0 F0 F0 F0 F0 F0 F0 F4 F5 F6 F8 F2 F4 F8 F3 F2 D3 (or F3 as the last byte, therefore losing the sign) 
```

该字段在小数点前有 15 位（实际上是 16 位），在小数点后有 3 位。

虽然它只请求 18 位数字 (15+3)，但它得到 19 以使其成为带有符号的偶数长度字段（在前面添加一个数字以使其在文件中的长度为 10 个字节）。最佳实践是始终使打包字段的长度为奇数，以避免这种混淆。

** 最后一个字母表示符号，C & F 为正，D 为负。对于您的程序，检查是否为负 (D)，如果不是，则视为正。

** 'V' 是隐含的小数点。它在文件中不存在，但 COBOL 知道它用于舍入等。您需要以编程方式对其进行说明。该文件中没有任何内容可以帮助您确定它在哪里，或者它是否存在。

其他两个字段已经是奇数长度，因此当打包时，与符号一起，它们可以存储在偶数长度的空间中。

任何其他问题，编辑您的问题或在评论中提问，有人会尝试为您回答。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-09T06:24:09.520

COMP-3 字段长度计算为我们需要存储的位数 + 1 除以 2。例如，要存储值 987 的数字字段，我们需要 3 +1 除以 2 = 2 因此 Comp-3 字段为长度 2 个字节可以存储 +999 到 -999 的值作为限​​制。

15 将存储为 01 5C。所以数字的最后四位用于存储数字的符号C或D，因此“C”代表正数，“D”代表负数。每个数字需要 4 位来表示自己。

因此，一个 7 位数字将需要 7 +1 = 8 / 2 = 4 字节大小。因此大小为 4 字节的 comp-3 字段可以存储 +999,9999 到 -999,9999 位的数字。

如果上述问题要移动数字的小数部分，则需要定义一个只能存储小数部分的变量，并将值移动到仅包含小数部分的字段。

像 FIELD-NAME-3 PIC S9(3)V9(6) COMP-3。

我们需要定义一个像 DEC-PORTION V9(6) comp-3 这样的十进制字段，然后将 FIELD-NAME-3 移动到 DEC-PORTION 以保留值的小数部分。

这样，我们可以将数字的小数部分与完整数字分开。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-27T22:49:53.473

通常 COMP-3 字段由一次打包成两个字节的[BCD数字组成，每个数字使用一个半字节（4 位）。](http://en.wikipedia.org/wiki/Binary-coded_decimal)最后一个数字进入最后一个字节的高半字节。如果数字为负数，则最后一个字节的低半字节为 13，如果为正数，则为其他值（通常为 12）。小数点是隐含的。

例如，-1.2 在十六进制中看起来像这样，最后的 D 是负号。

```
 01 2D 
```

12.345 是：

```
 12 34 5C 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-27T22:40:16.070

开始了：

PIC 是“图片”
S9(15) 表示 15 位数字带符号字段：S 表示符号，9 是数字，(15) 是长度。V 是小数位 9(3) 是三位数字

COMP-3 是 BCD 编码的十进制。字段的每个 nybble（半字节）都是二进制的十进制值，所以

0b01110110（呃）

是“76”。

18位需要9个字节，符号是低位字节的低位。

这让我担心，那些应该需要**10**个字节。

这是一篇[很好的文章](http://www.3480-3590-data-conversion.com/article-packed-fields.html)。

# entity-framework - 我可以在不先查询的情况下更新 EF 实体吗？

> ID：795528
> 
> 赞同：3
> 
> 时间：2009-04-27T22:25:45.513
> 
> 标签：entity-framework

这是我的场景：

*   我有一条通过 WCF 传入的简单消息。此消息表示现有的数据库记录，并包含进行计算所需的*所有数据字段。*
*   完成计算后，我想更新此数据记录上的**一个**字段。

目前，试图简单地设置实体框架的实体版本的所有字段，然后保持对象上下文的状态似乎无济于事。

有什么想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-28T13:13:12.290

是的你可以。该过程是创建一个类似于实体原始状态的实体，将其附加到 ObjectContext，修改实体，然后保存更改。请记住，在修改实体*之前*将实体附加到 ObjectContext 很重要。[这篇文章](http://blogs.msdn.com/alexj/archive/2009/04/25/tip-15-how-to-avoid-loading-unnecessary-properties.aspx)中有一个例子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T22:33:34.137

如果您也有实体键，您应该能够执行以下操作：

```
myDataContext.Refresh(RefreshMode.ClientWins, Object myEntity); 
```

（不是 100% 确定语法就是这样，但我知道该方法被调用`.Refresh()`）...

# lucene - 如何传递“允许”ID 列表来过滤 Lucene 搜索？

> ID：795532
> 
> 赞同：2
> 
> 时间：2009-04-27T22:27:35.913
> 
> 标签：lucene, lucene.net, filtering

我只需要返回用户可以通过 Lucene 搜索访问的文档。我可以从构成“允许”子集的数据库中获取 ID 列表。我怎样才能将这些传递给 Lucene？我在网上找到的文章建议我需要使用 BitSet 和 FieldCache（对吗？），但我很难找到好的示例。有人有吗？

我正在使用 C#，但任何语言都会很棒。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T22:39:30.347

一种简单的方法是使用包含所有匹配 ID 的数组构建 MultiPhraseQuery，通过`MultiPhraseQuery.add(Term[] terms)`. 你可以用数千个术语构建其中的一个，而 Lucene（一如既往）表现得非常好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-12T23:20:18.887

一旦我知道我需要使用自定义过滤器，问[这个问题](https://stackoverflow.com/questions/1079934/how-do-you-implement-a-custom-filter-with-lucene-net)就会得到正确的答案。

# asp.net-mvc - ASP.NET MVC Routing 基于当前 url 构造链接

> ID：795536
> 
> 赞同：3
> 
> 时间：2009-04-27T22:29:16.660
> 
> 标签：asp.net-mvc, routing

我的网址看起来像这样

`~\articles\energy\topweek`

`~\articles\metals\latestpopular`

其中第二个 url 字符串是一个类别，第三个是一个过滤器

所以路线看起来像这样

```
 routes.MapRoute("ArticleFilter",
     "articles/{category}/{filter}",
  new { controller="Article", action="Filter" }) 
```

这很容易，一切正常。

所以让我们说如果我正在查看文章{类别}\默认视图。

如何使用过滤器构建指向当前类别的链接。

示例：如果当前页面`articles\energy`，我需要构造`article\energy\topweek`和`article\energy\latestpopular`。

根据当前页面，类别应该是动态的。最好在局部视图中，这样我就可以在不同的页面上使用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T22:35:17.970

`UrlHelper`在拆分 url 字符串以获取您需要的信息后，使用该类构造路由 url。

```
string url = "~\articles\film\topweek";
string[] parts = url.Split("\\");
string cat = parts[2];
string fil = parts[3];

string actionUrl = UrlHelper.RouteUrl("ActionFilter", new { category = cat, filter = fil }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T22:47:11.030

为您的用户控件创建一个对象以作为模型，如下所示：

```
public class ArticleLinksControl {
    public string CategoryName { get; set; }
}
```

和您的用户控制： `<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl<Namespace.ArticleLinksControl>" %>`

假设您对 ArticleController 的默认操作的视图也接受包含有关类别名称信息的模型，您可以通过以下方式将类别名称发送到您的用户控件：

```
<%Html.RenderPartial("~/Views/Shared/YourControl.ascx",
    new NameSpace.ArticleLinksControl { 
        CategoryName = Model.Category}); %> 
```

现在在您的用户控件中，您可以使用 访问类别名称`Model.CategoryName`。

这是如果您坚持为此使用用户控件。您也可以在视图上使用 Html 助手。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T22:45:21.067

您必须使用 Html.RouteLink（或 Html.ActionLink）来构建 URL。

```
<% Html.RouteLink('link text', routeName, new { filter = "topweek" }) %> 
```

# asp.net-mvc - 使用 XmlSerializer 对 Silverlight 库和 MVC 应用程序之间的类进行序列化/反序列化时出现问题

> ID：795543
> 
> 赞同：1
> 
> 时间：2009-04-27T22:34:00.673
> 
> 标签：asp.net-mvc, silverlight, xml-serialization

这是我的情况：

我有一个包含三个项目的解决方案：1) Silverlight App，2) Silverlight Library，3) Asp.net-MVC Web App。

在 Silverlight 库中，我有一个名为“MyClass”的类。在 Silverlight 应用程序中，我使用 XmlSerializer 将该类序列化为 XML，并将 XML 发送回数据库。我在 Silverlight 应用程序中定期检索和反序列化该 XML 以使用 MyClass。

当我尝试从 Asp.Net-MVC 应用程序中反序列化该 XML 时，我的问题就出现了。在 Asp.Net-MVC 应用程序中，这是我用来将 XML 反序列化为 MyClass 的代码：

```
 MySilverlightLibrary.MyClassObjects.MyClass newMyClass = null;

 Assembly ass = Assembly.Load("MySilverlightLibrary.MyClassObjects");
 Type ty = ass.GetType("MySilverlightLibrary.MyClassObjects.MyClass", true);

 XmlSerializer theSerializer = new XmlSerializer(ty);

 if( !String.IsNullOrEmpty(xmlText) )
 {
    using( XmlReader sr = XmlReader.Create(new StringReader(xmlText)) )
    {                 
       newMyClass = theSerializer.Deserialize(sr) as MySilverlightLibrary.MyClassObjects.MyClass;
    }
 } 
```

这是我得到的运行时错误：

> “/”应用程序中的服务器错误。
> 
> 无法加载文件或程序集“ **System.Xml**，Version=2.0.5.0，Culture=neutral，PublicKeyToken=7cec85d7bea7798e”或其依赖项之一。该系统找不到指定的文件。
> 
> 说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：System.IO.FileNotFoundException：无法加载文件或程序集“System.Xml，Version=2.0.5.0，Culture=neutral，PublicKeyToken=7cec85d7bea7798e”或其依赖项之一。该系统找不到指定的文件。

我注意到 Silverlight 库项目中“System.Xml”引用的版本是 2.0.5.0，但 Asp.Net-MVC App 中的“System.Xml”引用是 2.0.0.0。我认为这可能是问题的原因，但我不知道如何解决它！

我已经搞砸了很长一段时间了，这让我发疯了！一如既往，任何帮助将不胜感激！

谢谢

杰夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T16:11:30.810

您是对的-您遇到问题的原因是版本不匹配。[我相信您可以使用Assembly binding redirection](http://msdn.microsoft.com/en-us/library/2fc472t2(vs.71).aspx)解决这个问题。

# java - 类（java）和闭包（javascript）之间的区别？

> ID：795549
> 
> 赞同：6
> 
> 时间：2009-04-27T22:35:24.897
> 
> 标签：java, javascript, closures

我不明白闭包如何比类更强大。看起来我可以使用类实现相同的闭包行为。任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-27T22:50:02.303

闭包是穷人的对象/对象是穷人的闭包

### 请参阅：[闭包和对象](https://stackoverflow.com/questions/501023/closures-and-objects)

对于懒人：

> 尊贵的 Qc Na 大师与他的学生 Anton 同行。安东希望能引起大师的讨论，道：“大师，我听说物件是一个很好的东西，这是真的吗？” Qc Na 怜悯地看着他的学生，回答说：“愚蠢的学生 - 对象只是一个穷人的闭包。”
> 
> 受到责备后，安东离开了他的主人，回到了他的牢房，一心研究闭包。他仔细阅读了整个“Lambda: The Ultimate...”系列论文及其表亲，并实现了一个带有基于闭包的对象系统的小型 Scheme 解释器。他学到了很多，并期待着向他的主人通报他的进步。
> 
> 在与 Qc Na 的下一次散步中，Anton 试图打动他的师父，他说：“师父，我已经认真研究了这件事，现在明白了物体确实是穷人的闭包。” Qc Na 用棍子击打 Anton 回应说：“你什么时候才能学会？闭包是穷人的对象。” 那一刻，安东顿悟了。
> 
> —<a href="http://people.csail.mit.edu/gregs/ll1-discuss-archive-html/msg03277.html" rel="nofollow noreferrer">Anton van Straaten

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T22:38:28.273

A`closure`和 a`class`是两个非常不同的东西。

`class`说“A 比 a更强大”是不正确的`closure`。反之亦然。

他们做完全不同的事情。

A`closure`在基本意义上是一个函数调用，它保留了它创建的范围内的局部变量信息。

A`class`是对象的定义。类定义了类实例的行为和内容。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-28T01:46:20.367

其他人已经解释了类和闭包之间的区别。我只是想指出，在 Java API 中支持它们的语言会/可能使用闭包的许多地方，都会使用接口的匿名实现。例如考虑下面的代码：

```
JButton btn = new JButton("Say Hello");
btn.addActionListener(new ActionListener() {
    public void actionPerformed(ActionEvent e) {
        JOptionPane.showMessageBox("Hello");
    }
}); 
```

在这种情况下，可以说匿名 ActionListener 充当了一个闭包，如果 Java 允许闭包，代码可能如下所示：（使用 c++0x-esque 语法）

```
JButton btn = new JButton("Say Hello");
btn.addActionListener([]=>(ActionEvent e){JOption.showMessageBox("Hello");}); 
```

在这个简单的例子中，闭包和接口（AII）的匿名实现之间的主要区别在于：

1.  AII 方法比闭包具有更强的类型检查。（可以使闭包系统具有更强的类型检查，但一般来说，它们不是）
2.  闭包语法需要更少的输入。这似乎是一旦你咀嚼 Java 需要闭包参数足够长的时间呈现出来的主要抱怨。

我还没有遇到过 AII 无法做需要做的事情的情况。是的，需要定义更多类型和另一个接口，但是它们的系统可以工作，而且恕我直言，更强大，因为您不需要使用 AII，而是可以使用具有自己的方法、成员数据和构造函数的成熟类. 一个示例是弹出上下文菜单的动作侦听器。如果您创建一个实现 ActionListener 并以 JMenu 作为参数的类，您可以执行以下操作：

```
btn.addActionListener( new ContextMenuActionListener(myMenu) ); 
```

这看起来比 boost:bind 类型的解决方案更干净（对我来说）。

```
[]=>(ActionListener) myContextPopupClosure = []=>(ActionListener E){ ... };
...
btn.addActionListener( Closure.bind1(myContextPopupClosure,myMenu) ); 
```

或者

编辑：

在昨晚做了很多关于泛型的工作之后，我意识到了闭包优于 AII 的一个优势。在上面的例子中，我一直假设闭包的类型是 []=>(ActionEvent)，但它实际上可能是类型 []=>(? super ActionEvent)。这表示：

```
[]=>(Object) c = []=>(Object o) { System.exit(0); }
btn.addActionClosure( c );
window.addMouseMovedClosure( c );
//Each method in MouseMotion listener would need it's own closure.
//So I 'invented' an API change. 
```

将是可编译的。这可能很有用，因为当您需要做同样的事情来响应多个事件时。

另一个例子。这个闭包可以添加到任何需要闭包的地方。如果添加到 ActionListener 或 MouseListener 中，它会记录调用。

```
[]=>(Object ... objs) log = []=>(Object ... obj) {for(Object o:obj){logObject(o);}} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-28T05:09:02.203

这是一个很好的问题，但措辞可能更好：

“Java 对象和 JavaScript 闭包之间有哪些相同点和不同点”？

相似之处：它们都在局部变量中具有持久状态。他们的方法可以访问这些状态变量。

区别：Javascript是一种函数式语言，因此函数中的函数可以立即调用和返回。例如：

```
newXY = function(x,y) {

    var that = {};//Instantiate new object
    var x = parseFloat(x);
    var y = parseFloat(y);

    that.xtimesy = function() {
      return x*y;
    }(); // <-- Notice the immediate invocation of the function, here.

    return that;
}; 
```

所以你可以编写这样的代码，从[rhino shell](http://www.mozilla.org/rhino/shell.html)复制/粘贴：

```
js> var foo = newXY(2,5);
js> foo.xtimesy;
10 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-27T22:39:19.317

我不确定是什么导致您提出这个问题，但是您被告知的某些内容或您阅读的某些内容严重误导了您。

完全忽略语言，[闭包](http://en.wikipedia.org/wiki/Closure_(computer_science))和[类](http://en.wikipedia.org/wiki/Class_(computer_science))是编程中完全不相关的结构/约定。

# ssl - HAProxy 可以在一个 IP 和端口上同时处理 Web 服务器和 SSL VPN 吗？

> ID：795551
> 
> 赞同：0
> 
> 时间：2009-04-27T22:35:55.253
> 
> 标签：ssl, amazon-ec2, nginx, vpn, haproxy

我需要一个反向代理，通过坐在一个 IP/端口上来支持 Lablz Web 服务器和 SSL VPN Adito（SSL Explorer 分支）。使用 Nginx 无法实现这一点。未能将 Adito 用作通用反向 HTTP 代理。

如果 HAProxy 无法感知 HTTP 流量，它是否可以回退为 TCP 代理？换句话说，如果它的第 7 层检查确定这不是 HTTP 流量，它是否可以退回到第 4 层？

**这是我的设置**

*   具有一个公共 IP（弹性 IP）的 EC2 机器。
*   只有一个端口是开放的——443。
*   Stunnel 位于 443 并将流量传递给 HAProxy（我不喜欢使用 Stunnel，但 HAProxy 还没有完全支持 SSL，这与 Nginx 不同）。
*   HAProxy 必须配置为将一些 HTTP 流量传递到一台服务器（位于 SVN 服务器前面的 Apache 服务器），并将其余 HTTP 流量传递到我们的 Lablz Web/App 服务器。
*   所有非 HTTP 流量都必须转发到 Adito VPN。
    *   这个流量是：
        *   VNC、NX、SMB
        *   ...以及 Adito 支持的所有其他协议

我不能依赖源 IP 地址或端口将流量拆分为 HTTP 和非 HTTP。

那么，这样的配置可以在 HAProxy 中完成吗？可以为此使用任何其他反向代理吗？如果我对 HAProxy 的想法不正确，请告诉我，并且可以使用替代方法。

顺便说一句，Adito SSL VPN 很棒，如果此设置有效，我们将能够为 Lablz 开发人员提供出色的一键式单点登录安全 VNC-over-HTTPS 访问他们在云中的盒子。

没有解决方案，但通过 Adito - 请证明我错了。但请不要说 VNC over SSH 更好。是的，VNC-over-SSH 更快、更安全，但也更难（对于我们的目标用户群）设置并假定用户位于允许端口 22 上的出站流量的防火墙后面（并非总是如此）。

此外，Adito 不仅仅是远程访问网关——它是一个成熟的浏览器内 VPN、一个软件分发平台等等。我与 Adito 的人没有联系 - 请参阅[我们 Lablz 博客上的 Adito 帖子](http://crm.lablz.com/v.html?-b=34378&max=y)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T12:34:08.797

好的，首先，我会使用一个简单的防火墙将所有 HTTP 与非 HTTP 流量分开。您需要的是数据包检查以找出传入的内容。

haproxy 或 nginx 都无法做到这一点。它们都是为**网络**流量而设计的，我看不出他们如何检查流量来猜测他们正在处理的是什么。

**更新：**对此进行了一些研究，使用 iptables 您可能可以使用字符串匹配来分配*流量*。然而，这一切都很棘手，尤其是在加密性质的情况下。我的一个朋友发现了[l7-filter](http://l7-filter.sourceforge.net/)，这看起来就像你需要的。让我知道这是否有帮助。

# sql - “安全”允许用户使用 SQL 进行搜索

> ID：795553
> 
> 赞同：4
> 
> 时间：2009-04-27T22:37:42.160
> 
> 标签：sql, security, web-applications

例如，我经常想用

```
SELECT whatever FROM questions WHERE
   views * N + votes * M > answers AND NOT(answered) ORDER BY views; 
```

或类似的东西。

*是否有任何合理的方式允许用户使用 SQL 作为搜索/过滤语言？*

我发现它有一些问题：

*   访问/更改内容（仔细设置的用户帐户应该可以解决该问题）
*   SQL 注入（考虑到以前最糟糕的情况，他们应该能够做的就是找回垃圾并在会话中崩溃）。
*   带有病态查询的 DOS 攻击
*   你给他们什么指标？

*编辑：*我想允许加入，什么也不允许。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-27T23:07:52.090

**访问/更改内容**
没问题，只需使用残障用户运行查询，仅具有选择权限

**SQL 注入**
只需清理查询

**DOS 攻击**
使查询超时并通过 IP 限制访问。我想您还可以限制某些服务器中的 CPU 使用率

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T23:03:54.640

如果您执行`SQLEncode`用户的输入（并确保也将所有输入都删除`;`！），我认为拥有三个输入框没有巨大的安全漏洞（除了我们仍在向精神病患者分发核武器......） - 一个用于表，一个用于列，一个用于条件。他们将无法在其条件中包含字符串，但像您的示例这样的查询应该可以工作。您将实际粘贴 SQL 语句，因此您将控制实际执行的内容。如果您的设置足够好，您将是安全的。

但是，我不会让我的用户像那样输入 SQL。如果您想真正自定义搜索选项，请为搜索字段提供一堆标志，或者提供一堆可以随意组合的表单元素。

另一种选择是发明某种“标记语言”，有点像 Markdown（SO 用于格式化所有这些问题和答案的框架......），您可以将其翻译为 SQL。然后，您可以确保只执行“无害”选择，并且可以保护用户数据等。

事实上，如果你曾经实现过这个，你应该看看是否可以从 SQL 服务器上的单独帐户运行命令，该帐户只能访问非常基本的需求，并且显然只有读取访问权限。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T23:39:47.113

Facebook 使用[FQL](http://wiki.developers.facebook.com/index.php/FQL)做到这一点。请参阅[博客文章](http://blog.facebook.com/blog.php?post=2245872130)或[演示文稿](http://www.slideshare.net/csaila/fql-overview)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-28T00:30:57.990

我只是想到了一种强大的消毒方法，可以用来限制可以使用的东西。

*   使用 MySQL 并获取它的 lex/yacc 文件
*   按原样使用 lex 文件
*   将 yacc 文件删除为您想要允许的内容
*   使用在成功时吐出输入的操作规则。

# authentication - Windows 域的 JAAS 身份验证

> ID：795561
> 
> 赞同：2
> 
> 时间：2009-04-27T22:39:47.927
> 
> 标签：authentication, kerberos, jaas

使用提供的用户名、密码和域名，我如何检索一个布尔值，指示用户是否已成功通过主域控制器进行身份验证？应使用 Windows 域控制器的 Kerberos 协议执行身份验证。在此先感谢，丹

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-05-25T12:21:56.280

有一个仅限 Windows 的 JAAS 登录模块和 SSO Negotiate (Kerberos/NTLM) 身份验证器的免费实现：[Waffle](http://waffle.codeplex.com)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T23:08:50.183

您需要为此编写自己的身份验证模块或使用第三方身份验证模块。当我这样做的时候，JDK 没有任何可用的东西，所以我使用[了这个工具](http://free.tagish.net/jaas/doc.html)。请注意，它是 GPL，但您可以从那里学习。您将必须创建 conf. **描述您的身份验证模块的文件，并使用java.security.auth.login.config**属性将其输入您的 JVM （例如，使用 -D 或任何一种方式）。在 Tagish 的情况下，它看起来像这样：

NTLogin { com.tagish.auth.win32.NTSystemLogin 需要 returnNames=true returnSIDs=false defaultDomain="domain"; };

您需要做的另一件事是通过**java.security.krb5.conf**属性指定 kerberos 配置文件。我手边没有这个文件的详细信息，但你可以很容易地在网上找到它——google about krb5.conf。此文件中的设置必须与您的 Windows 域和其他 Windows 特定设置相匹配。

配置起来有点棘手，但对我来说它工作得很好，非常强大。

# c# - 你如何建模一个简单的组合关系

> ID：795564
> 
> 赞同：0
> 
> 时间：2009-04-27T22:41:33.510
> 
> 标签：c#, uml, modeling, relationship, composition

有人可以帮助我了解如何最好地模拟组合关系吗？

例如，如果我有一个可以有很多时间表的学生，我会大致创建：

```
class Student
{
  prop long Pk { get; set; }
  prop string Name { get; set; }
  prop List<Schedule> Schedules { get; set; }
}

class Schedule
{
  prop string Semester { get; set; }
  prop List<Course> Courses{ get; set; }
} 
```

在某个地方，我可能有一个 Schedule 对象，并希望确定它属于哪个学生。我希望能够写作`Schedule.Student.Name`，并收到学生的名字作为回报。我是否也将 Student 属性添加到我的 Schedule 对象？

我的应用程序一直在将 Student Pk 传递给我的 Schedule 对象以执行 CRUD 功能。我将 Student PK 保留为私有变量，以便在需要时对其进行处理。

随着我的应用程序变得越来越复杂，我发现很难维护我一直在做的事情。你对我有什么建议？我还可以咨询什么（书籍/链接）来复习和更好地掌握这些基础知识？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T22:48:50.183

“我希望能够编写 Schedule.Student.Name，并接收学生的姓名作为回报。我是否也将 Student 属性添加到我的 Schedule 对象中？” 是的。

您所描述的内容（支持用于查找的外键和用于轻松导航对象图的对象引用）听起来非常适合对象关系映射器（ORM）。一个好的 ORM 将使用 FK/PK 自动为您加载关联的对象/对象（例如，如果 Schedule 具有 StudentPK 字段，则映射器将为您处理 Student 属性的加载/映射）。这种类型的产品有很多：您可以使用内置的 .NET 框架，如[Entity Framework](http://msdn.microsoft.com/en-us/library/aa697427(VS.80).aspx)，开源框架，如[NHibernate](http://www.hibernate.org/)，或商业产品，如[LightSpeed](http://www.mindscape.co.nz/products/LightSpeed/default.aspx)、[LLBLGen](http://www.llblgen.com/)、[EntitySpaces](http://www.entityspaces.net/)或[OpenAccess](http://www.telerik.com/products/orm.aspx)（披露：我在一家制作商业 ORM 的公司工作）。谷歌 ORM 或对象关系映射器，或查看 Wikipedia，以了解我所描述的事物的概述。

# jquery - 使用 jQuery AJAX 设置超时功能的问题

> ID：795565
> 
> 赞同：0
> 
> 时间：2009-04-27T22:41:33.837
> 
> 标签：jquery, ajax, timeout

我有一个加载表单的 jQuery HTML 页面。

表单有很多设置，但最终表单使用 post 命令（见下文）提交，该命令返回由服务器上运行的脚本构建的 HTML 页面。

这工作正常，除非脚本运行时间超过 5 分钟。post 命令什么也不返回。

我尝试在高级页面中使用 timeout 命令如下：

```
$.ajaxSetup({ cache: false, timeout: 18000000 }) ; 
```

但这似乎不起作用。有人有建议吗？

这是发布命令：

```
$.post('/cgi-bin/tw_lookup_3.cgi', lookupData, function(data){
  var page = $(data).find('input[name=result_dir]').val();
  $('#results').load( page + "/TW_LOOKUP_RESULTS.html");

  $('#SubmitQuery').attr('disabled',false);
  $('#SubmitQuery').val('Submit Query');
  $('#SubmitQuery').css('backgroundColor','');
  $('#SubmitQuery').css('color','');
},"html"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T02:26:19.263

是否有可能在服务器上发生超时并且它只是返回一个错误？设置错误处理函数并确定是否正在调用它。在这种情况下，无论如何处理错误都应该是一种标准做法，特别是如果您预计它需要特别长的时间（比如 5 分钟！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T23:05:57.153

我与一位同事一起工作，我们发现问题确实是服务器而不是我试图设置超时的网页。

我希望这对将来的某人有所帮助，并感谢那些回答的人。

史蒂夫

# vbscript - 如何使VBscript中的列固定

> ID：795568
> 
> 赞同：1
> 
> 时间：2009-04-27T22:43:16.780
> 
> 标签：vbscript

我是 VBscript 的初学者，我得到了一个获取本地驱动器磁盘空间使用情况的脚本。但是，当某些列包含长数值时，某些相邻列甚至值向右移动，从而使输出杂乱无章。我已经

请参阅下面的脚本内容：

```
Option Explicit

const strComputer = "."
const strReport = "F:\dba_scripts\diskspace.txt"

Dim objWMIService, objItem, colItems
Dim strDriveType, strDiskSize, txt

Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\cimv2")
Set colItems = objWMIService.ExecQuery("Select * from Win32_LogicalDisk WHERE DriveType=3")
txt = "DRIVE" & vbtab & vbtab & "SIZE" & vbtab & vbtab & "USED" & vbtab & vbtab & "FREE" & vbtab & vbtab & "FREE(%)" & vbcrlf
For Each objItem in colItems

    DIM pctFreeSpace,strFreeSpace,strusedSpace

    pctFreeSpace = INT((objItem.FreeSpace / objItem.Size) * 1000)/10
    strDiskSize = round((objItem.Size /1073741824),1) & " GB"
    strFreeSpace = round((objItem.FreeSpace /1073741824),1) & " GB"
    strUsedSpace = round(((objItem.Size-objItem.FreeSpace)/1073741824),1) & " GB"
    txt = txt & objItem.Name & vbtab & vbtab & strDiskSize & vbtab & vbtab & strUsedSpace & vbTab & vbtab & strFreeSpace & vbtab & vbtab & pctFreeSpace & vbcrlf

Next

writeTextFile txt,strReport
wscript.echo "Report written to " & strReport & vbcrlf & vbcrlf & txt

' Procedure to write output to a text file
private sub writeTextFile(byval txt,byval strTextFilePath)
    Dim objFSO,objTextFile

    set objFSO = createobject("Scripting.FileSystemObject")

    set objTextFile = objFSO.CreateTextFile(strTextFilePath)

    objTextFile.Write(txt)

    objTextFile.Close
    SET objTextFile = nothing
end sub 
```

输出文件看起来不错，但是当我使用免费 bmail 发送/通过电子邮件发送它时，结果杂乱无章（意味着一些列和值移到了右侧。

我的问题是有没有办法使列和值结果固定（意味着没有列和值向右移动）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T01:30:33.977

```
Function RightJustified(ColumnValue, ColumnWidth)
   RightJustified = Space(ColumnWidth - Len(ColumnValue)) & ColumnValue
End Function 
```

使用示例：

```
output = output & _
         RightJustified(strDiskSize, 15) & _
         RightJustified(strUsedSpace, 15) & _
         RightJustified(strFreeSpace, 15) & _
         RightJustified(pctFreeSpace, 15) & _
         vbCrLf 
```

**编辑**

将**RightJustified**函数添加到您的脚本中。

然后，替换这行代码：

```
txt = txt & objItem.Name & vbtab & vbtab & strDiskSize & vbtab & vbtab & strUsedSpace & vbTab & vbtab & strFreeSpace & vbtab & vbtab & pctFreeSpace & vbcrlf 
```

和：

```
txt = txt & objItem.Name & _
      RightJustified(strDiskSize, 15) & _
      RightJustified(strUsedSpace, 15) & _
      RightJustified(strFreeSpace, 15) & _
      RightJustified(pctFreeSpace, 15) & _
      vbCrLf 
```

* * *

## **编辑 2**

我在脚本底部添加了 RightJustified 函数，然后在循环中调用它来格式化列。我还在列标题上使用了它。下面是脚本，底部是我机器上的输出。

```
Option Explicit

const strComputer = "."
const strReport = "F:\dba_scripts\diskspace.txt"

Dim objWMIService, objItem, colItems
Dim strDriveType, strDiskSize, txt

Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\cimv2")
Set colItems = objWMIService.ExecQuery("Select * from Win32_LogicalDisk WHERE DriveType=3")

txt = RightJustified("DRIVE", 10) & _
      RightJustified("SIZE", 15) & _
      RightJustified("USED", 15) & _
      RightJustified("FREE", 15) & _
      RightJustified("FREE(%)", 15) & _
      vbCrLf

For Each objItem in colItems

    DIM pctFreeSpace,strFreeSpace,strusedSpace

    pctFreeSpace = INT((objItem.FreeSpace / objItem.Size) * 1000)/10
    strDiskSize = round((objItem.Size /1073741824),1) & " GB"
    strFreeSpace = round((objItem.FreeSpace /1073741824),1) & " GB"
    strUsedSpace = round(((objItem.Size-objItem.FreeSpace)/1073741824),1) & " GB"

    txt = txt & _
      RightJustified(objItem.Name, 10) & _
      RightJustified(strDiskSize, 15) & _
      RightJustified(strUsedSpace, 15) & _
      RightJustified(strFreeSpace, 15) & _
      RightJustified(pctFreeSpace, 15) & _
      vbCrLf
Next

writeTextFile txt,strReport
wscript.echo "Report written to " & strReport & vbcrlf & vbcrlf & txt

' Procedure to write output to a text file
Sub writeTextFile(byval txt,byval strTextFilePath)
    Dim objFSO,objTextFile
    set objFSO = createobject("Scripting.FileSystemObject")
    set objTextFile = objFSO.CreateTextFile(strTextFilePath)
    objTextFile.Write(txt)
    objTextFile.Close
    Set objTextFile = nothing
End Sub

Function RightJustified(ColumnValue, ColumnWidth)
   RightJustified = Space(ColumnWidth - Len(ColumnValue)) & ColumnValue
End Function 
```

产生的输出：

```
 DRIVE           SIZE           USED           FREE        FREE(%)
    C:        48.4 GB        40.6 GB         7.8 GB           16.1
    D:       100.6 GB        56.8 GB        43.8 GB           43.5 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T23:44:54.090

您可以使用 HTML 写出一个表格。这应该在电子邮件中起作用。

# c# - 这个 lambda 表达式可能吗？

> ID：795569
> 
> 赞同：2
> 
> 时间：2009-04-27T22:43:37.327
> 
> 标签：c#, linq, lambda

[感谢这](https://stackoverflow.com/questions/795483/is-a-lambda-expression-from-this-possible)方面的帮助。

试过这个，没有运气..

我知道

```
from f in list 
where f.bar == someVar
select f 
```

可以写成

```
list.Where( f => f.bar == someVar ); 
```

是否可以创建类似的表达式

```
from f in foo
from b in f.bar
where b.something == someVar
select f; 
```

?

编辑：对不起，我忘了第二个例子中的 f.bar 是一个对象列表。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T22:46:29.597

确实。查询语法只是语法糖。它会被编译器翻译成底层的 lambda 语法，所以每个查询表达式都有一个等效的基于 lambda 的表示。

这可能是您需要的（这并不严格等同于，但当您`bar`在 ​​each 中只有一个匹配查询时有效`foo`）：

```
var result = foo.Where(f => f.bar.Any(b => b.something == someVar)); 
```

严格等效的版本是：

```
var result = foo.SelectMany(f => f.bar, (f, b) => new { F = f, B = b })
                .Where(x => x.b.something == someVar)
                .Select(x => x.f); 
```

# python - 在numpy中将一组向量与另一组相关联？

> ID：795570
> 
> 赞同：4
> 
> 时间：2009-04-27T22:43:38.247
> 
> 标签：python, numpy

假设我有一组向量（来自传感器 1 的读数、来自传感器 2 的读数、来自传感器 3 的读数——首先按时间戳索引，然后按传感器 ID 索引），我想将它们与一组单独的向量（温度、湿度等——也都首先按时间戳索引，然后按类型索引）。

numpy 中最干净的方法是什么？看起来它应该是一个相当简单的功能......

换句话说，我希望看到：

```
> a.shape 
(365,20)

> b.shape
(365, 5)

> correlations = magic_correlation_function(a,b)

> correlations.shape
(20, 5) 
```

干杯，/YGA

PS我被要求添加一个例子。

这是我想看到的：

```
$ In [27]:  x
$ Out[27]: 
array([[ 0,  0,  0],
       [-1,  0, -1],
       [-2,  0, -2],
       [-3,  0, -3],
       [-4,  0.1, -4]])

$ In [28]: y
$ Out[28]: 
array([[0, 0],
       [1, 0],
       [2, 0],
       [3, 0],
       [4, 0.1]])

$ In [28]: magical_correlation_function(x, y)
$ Out[28]: 
array([[-1\.        ,  0.70710678,  1\.        ]
       [-0.70710678,  1\.        ,  0.70710678]]) 
```

Ps2：哎呀，我的例子抄错了。对不起大家。现在修好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T13:28:54.000

我能找到的最简单的事情是使用 scipy.stats 包

```
In [8]: x
Out[8]: 
array([[ 0\. ,  0\. ,  0\. ],
       [-1\. ,  0\. , -1\. ],
       [-2\. ,  0\. , -2\. ],
       [-3\. ,  0\. , -3\. ],
       [-4\. ,  0.1, -4\. ]])
In [9]: y
Out[9]: 
array([[0\. , 0\. ],
       [1\. , 0\. ],
       [2\. , 0\. ],
       [3\. , 0\. ],
       [4\. , 0.1]])

In [10]: import scipy.stats

In [27]: (scipy.stats.cov(y,x)
          /(numpy.sqrt(scipy.stats.var(y,axis=0)[:,numpy.newaxis]))
          /(numpy.sqrt(scipy.stats.var(x,axis=0))))
Out[27]: 
array([[-1\.        ,  0.70710678, -1\.        ],
       [-0.70710678,  1\.        , -0.70710678]]) 
```

这些不是你得到的数字，但你混淆了你的行。（元素 [0,0] 应该是 1。）

一个更复杂但纯粹是 numpy 的解决方案是

```
In [40]: numpy.corrcoef(x.T,y.T)[numpy.arange(x.shape[1])[numpy.newaxis,:]
                                 ,numpy.arange(y.shape[1])[:,numpy.newaxis]]
Out[40]: 
array([[-1\.        ,  0.70710678, -1\.        ],
       [-0.70710678,  1\.        , -0.70710678]]) 
```

这会比较慢，因为它会计算 x 中的每个元素与 x 中的其他元素的相关性，这是您不想要的。此外，用于获取所需数组子集的高级索引技术可能会让您头疼。

如果您打算大量使用 numpy，请熟悉[广播](http://www.scipy.org/EricsBroadcastingDoc)和[索引](http://docs.scipy.org/doc/numpy/reference/arrays.indexing.html)的规则。他们将帮助您尽可能地降低到 C 级别。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T21:10:06.683

这会做你想要的吗？

```
correlations = dot(transpose(a), b) 
```

注意：如果你这样做，你可能首先要标准化或变白`a`，`b`例如与此等价的东西：

```
a = sqrt((a - mean(a))/(var(a)))
b = sqrt((b - mean(b))/(var(b))) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-27T23:11:40.830

正如大卫所说，你应该定义你正在使用的相关性。我不知道在关联空信号和非空信号时给出合理数字的任何相关定义。

# wpf - Databound WPF CheckBox 在值集上出现异常

> ID：795573
> 
> 赞同：3
> 
> 时间：2009-04-27T22:44:34.157
> 
> 标签：wpf, data-binding, exception, checkbox

我有一个数据绑定的 WPF CheckBox 控件，当在 UI 中切换值时，该控件似乎正在吃由相应的属性设置器抛出的异常。我知道如果我在 Binding 实例上提供 ExceptionValidationRule 会发生这种情况，但我仔细检查了 Binding 实例的 ValidationRules 计数为零。我还检查了调用堆栈中是否存在干预异常处理程序，但都不存在。尽管如此，抛出的异常并没有像我预期的那样冒泡到顶部并在应用程序中产生崩溃。

如果我从同一个 UI 中的按钮单击处理程序中抛出异常，该异常会冒泡并导致应用程序崩溃，从而排除某种全局异常处理程序。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T07:22:41.540

为了添加到 itowlson 的答案，`Binding`该类提供了[UpdateSourceExceptionFilter](http://msdn.microsoft.com/en-us/library/system.windows.data.binding.updatesourceexceptionfilter.aspx)属性，该属性允许您提供在更新源发生异常时运行的逻辑。它与[ExceptionValidationRule](http://msdn.microsoft.com/en-us/library/system.windows.controls.exceptionvalidationrule.aspx)类结合使用，并允许您`ValidationError`在更新失败时执行除添加 a 之外的其他操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T23:10:46.980

不，这是预期的行为：WPF 数据绑定基础结构捕获由于将值从绑定目标保存回源而导致的异常。我怀疑这是因为应用程序无法围绕保存操作设置异常处理程序（因为它是从 WPF 代码而不是应用程序代码调用的），所以如果 WPF 不这样做，应用程序将崩溃而没有处理异常的机会。

（相比之下，在按钮单击处理程序中，您正在编写代码，因此您*确实*有机会处理异常。因此 WPF 认为如果您决定不处理异常，可以让异常传播。）

# c# - C# 当我准备好程序结束时，如何停止 tcpClient.Connect() 进程？它只是在那里呆了大约 10 秒钟！

> ID：795574
> 
> 赞同：4
> 
> 时间：2009-04-27T22:44:36.513
> 
> 标签：c#, timeout, connect, tcpclient

这是我的第一个问题。每当我退出程序时， tcpClient.Connect() 需要永远关闭。我已经尝试了很多东西，但它们似乎都不起作用。

看看 CreateConnection() 线程，如果客户端还没有连接......我关闭了程序，它需要永远关闭。如果它已连接，它会立即关闭。我知道这可以通过某种超时技巧来完成，但我尝试了一些，但都没有奏效。

如果可以，请提供代码示例。

此外，对于 C# 是否有任何关于使用缓冲区而不是仅执行 masterServer.writeLine() 和 masterServer.readline() 的版本读取/写入实际字节的好教程，或者它们都一样有效？

如果你看到任何其他可以帮助我改进的东西......无论如何，请继续。我正在尝试自学如何做到这一点，但我没有任何帮助，所以如果你看到它，请不要让我继续做错事！！！多谢你们！

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Net;
using System.Net.Sockets;
using System.Threading;
using System.IO;

namespace RemoteClient
{
    public partial class Form1 : Form
    {
        private int MyPort = 56789;
        private IPAddress myIp = IPAddress.Parse("210.232.115.79");
        private IPAddress serverIp = IPAddress.Parse("72.216.18.77"); // Master Server's IP Address
        public static TcpClient masterServer = new TcpClient();

        private StreamWriter responseWriter;
        private StreamReader commandReader;

        private Thread connectionThread;
        private Thread commandsThread;

        private bool RequestExitConnectionThread { get; set; }

        private delegate void AddMessageDelegate(string message, int category);
        private delegate void ConnectedDelegate();

        private bool isConnected { get; set; }

        public Form1()
        {
            InitializeComponent();
            isConnected = false;
        }

        private void LogMessage(string message, int category)
        {
            if (category == 1)
            {
                ListViewItem item = new ListViewItem(message);
                item.BackColor = Color.LightGreen;
                item.UseItemStyleForSubItems = true;
                Log.Items.Add(item).SubItems.Add(DateTime.Now.ToString());
            }
            if (category == 2)
            {
                ListViewItem item = new ListViewItem(message);
                item.BackColor = Color.Orange;
                item.UseItemStyleForSubItems = true;
                Log.Items.Add(item).SubItems.Add(DateTime.Now.ToString());
            }
            if (category == 3)
            {
                ListViewItem item = new ListViewItem(message);
                item.BackColor = Color.Yellow;
                item.UseItemStyleForSubItems = true;
                Log.Items.Add(item).SubItems.Add(DateTime.Now.ToString());
            }
            if (category == 0)
            {
                Log.Items.Add(message).SubItems.Add(DateTime.Now.ToString());
            }
        }

        private void Connected()
        {
            LogMessage("Found and Accepted Master Server's connection. Waiting for reply...",1);
            Status.Text = "Connected!";
            Status.ForeColor = Color.Green;

            commandsThread = new Thread(new ThreadStart(RecieveCommands));

            sendClientInfo();
        }

        private void exitButton_Click(object sender, EventArgs e)
        {
            Disconnect();
            exitButton.Enabled = false;
            exitButton.Text = "Closing...";

            if (connectionThread != null)
            {
                while (connectionThread.IsAlive)
                {
                    Application.DoEvents();
                }
            }

            this.Close();
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            Connect();
        }

        private void Disconnect()
        {
            RequestExitConnectionThread = true;

            if (masterServer != null)
                masterServer.Close();

            if (connectionThread != null)
                connectionThread.Abort();

            LogMessage("Closing Client. Please wait while Program threads end.", 2);
        }

        private void Disconnected()
        {
            Status.Text = "Disconnected";
            Status.ForeColor = Color.Red;
            Connect();
        }

        private void Connect()
        {
            LogMessage("Attempting to connect to Master Server...", 1);

            connectionThread = new Thread(new ThreadStart(CreateConnection));
            connectionThread.Start();
        }

        private void CreateConnection()
        {
            int i = 1;
            bool success = false;

            while (!success)
            {
                try
                {
                    using (masterServer = new TcpClient())
                    {
                        IAsyncResult result = masterServer.BeginConnect(serverIp, MyPort, null, null);
                        success = result.AsyncWaitHandle.WaitOne(1000, false);
                    }

                    if (success)
                    {
                        BeginInvoke(new ConnectedDelegate(this.Connected), new object[] {});
                        break;
                    }
                    else
                    {
                        Thread.Sleep(2000);
                        BeginInvoke(new AddMessageDelegate(LogMessage), new object[] { "Connection Retry # " + i.ToString() + ". Master Server hasn't been started yet.", 3 });
                    }
                }
                catch
                {
                    MessageBox.Show("Error!");
                }
                i++;
            }

        }

        private void RecieveCommands()
        {
            MessageBox.Show("Hello!");
            commandReader = new StreamReader(masterServer.GetStream());

            string CommandResponse = commandReader.ReadLine();
            string Command = null;

            if (CommandResponse != null)
                MessageBox.Show("Recieved Command that was NOT null!");

            if (CommandResponse != null)
            {
                MessageBox.Show("Recieved null response!");
                BeginInvoke(new AddMessageDelegate(LogMessage), new object[] { "Disconnected From Master Server. Reason: Recieved Null response.", 1 });
                Disconnected();
            }
            else if (CommandResponse.StartsWith("0"))
            {
                MessageBox.Show("Recieved 0 as a response!");
                Command = CommandResponse.Substring(2).Trim();

                isConnected = false;
                BeginInvoke(new AddMessageDelegate(LogMessage), new object[] { "Disconnected From Master Server. Reason: " + Command, 1 });
            }
            else if (CommandResponse.StartsWith("1"))
            {
                MessageBox.Show("Recieved 1 as a response!");
                isConnected = true;
                BeginInvoke(new AddMessageDelegate(LogMessage), new object[] { "Connected to Master Server Successfully.", 1 });
            }
        }

        //************************** RESPONSE'S BELOW HERE ************************* \\

        private void sendClientInfo()
        {
            responseWriter = new StreamWriter(masterServer.GetStream());

            responseWriter.WriteLine(myIp.ToString());
            responseWriter.Flush();
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-09-22T13:46:14.980

抱歉，经过测试：不，它不使用异步等待句柄，它阻塞了进程:(

我更喜欢这个解决方案，它也会阻止进程，但只能在您指定的时间段内，在本例中为 5 秒：

```
using (TcpClient tcp = new TcpClient())  
{  
    IAsyncResult ar = tcp.BeginConnect("127.0.0.1", 80, null, null);  
    System.Threading.WaitHandle wh = ar.AsyncWaitHandle;  
    try 
    {  
       if (!ar.AsyncWaitHandle.WaitOne(TimeSpan.FromSeconds(5), false))  
       {  
           tcp.Close();  
           throw new TimeoutException();  
       }  

        tcp.EndConnect(ar);  
    }  
    finally 
    {  
        wh.Close();  
    }  
} 
```

来自：[http ://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/2281199d-cd28-4b5c-95dc-5a888a6da30d](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/2281199d-cd28-4b5c-95dc-5a888a6da30d)

以下示例同时使用异步连接和异步超时控制：

```
var tcp = new TcpClient();
var ar = tcp.BeginConnect(Ip, Port, null, null);
Task.Factory.StartNew(() =>
{
    var wh = ar.AsyncWaitHandle;
    try
    {
        if (!ar.AsyncWaitHandle.WaitOne(TimeSpan.FromSeconds(5), false))
        {
            // The logic to control when the connection timed out
            tcp.Close();
            throw new TimeoutException();
        }
        else
        {
            // The logic to control when the connection succeed.
            tcp.EndConnect(ar);
         }
     }
     finally
     {
         wh.Close();
     }
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-12-05T19:14:32.570

连接超时 2000 毫秒：

```
AutoResetEvent connectDone = new AutoResetEvent( false );
TcpClient client = new TcpClient();
client.BeginConnect(
    "127.0.0.1", 80,
    new AsyncCallback(
        delegate( IAsyncResult ar ) {
            client.EndConnect( ar );
            connectDone.Set();
        }
    ), client
);
if( !connectDone.WaitOne( 2000 ) ) {
    Console.WriteLine( "network connection failed!" );
    Environment.Exit( 0 );
}
Stream stream = client.GetStream(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T01:21:02.253

如果程序正在退出，则在连接过程中添加一个检查以取消它应该会有所帮助。

尝试将其添加`CreateConnection()`到您的`while(!success)`循环中，但在您的`try`块之前：

```
if(RequestExitConnectionThread)
{
    break;
} 
```

下面是一个异步 BeginConnect() 调用的示例：

```
myTcpClient.BeginConnect("localhost", 80, OnConnect, null); 
```

OnConnect 功能：

```
public static void OnConnect(IAsyncResult ar)
{
    // do your work
} 
```

# java - Java Web 应用程序的最佳 3D 图形库是什么？

> ID：795576
> 
> 赞同：6
> 
> 时间：2009-04-27T22:44:54.733
> 
> 标签：java, web-applications, graphics, 3d

我正在为 Java Web 应用程序寻找 3D 图形库。可以使用一些建议——不过只有开源。

编辑：我并不关心图形是如何输出的——Javascript/applet/canvas/flash，但我想用 Java 编写图形逻辑。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T22:52:35.900

JMonkeyEngine 非常好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-29T08:57:01.070

查看*轻量级 Java 游戏库*。它为开发人员提供了对 openGl 等跨平台库的访问。并且可以在浏览器中运行。

*   [http://lwjgl.org](http://lwjgl.org)

以下是一些演示：

*   [http://lwjgl.org/applet/](http://lwjgl.org/applet/)
*   [http://fabiensanglard.net/Prototyp/index.php](http://fabiensanglard.net/Prototyp/index.php)
*   [http://www.cokeandcode.com/info/tut2d-4.html](http://www.cokeandcode.com/info/tut2d-4.html)

人们正在用这个库做很棒的项目：http: [//lwjgl.org/projects.php](http://lwjgl.org/projects.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T07:52:28.800

这是一篇介绍如何在小程序中使用 jmonkeyengine 的文章。

[http://www.streamhead.com/tutorial-jmonkeyengine-applet-hardware-3d-in-the-browser/](http://www.streamhead.com/tutorial-jmonkeyengine-applet-hardware-3d-in-the-browser/)

（JMonkeyEngine 是一个相当不错的 3d 引擎）

# c++ - c++中的小数位和Pow函数

> ID：795595
> 
> 赞同：0
> 
> 时间：2009-04-27T22:49:18.000
> 
> 标签：c++, decimal

很可能是一个非常简单的问题，请保持任何答案易于理解我对此还是很陌生：

我正在制作一个小应用程序，我需要使用幂进行几次计算。经过一番研究，我在 cmath 中找到了 pow 函数，并玩了一把。最后我想出了这个片段，它有效：

```
#include <iostream>
#include <cmath>
using namespace std;

int main ()
{
    float dummy2, test(6.65);
    dummy2 = (float) pow((float) 3.57, test);
    cout << dummy2;

    return 0;   
} 
```

它返回正确的答案 (4734.17)，但只保留两位小数。我最好是小数点后 5 位。

我在这里做错了什么？我是否使用了错误的数据类型（浮点数）？还是 pow 函数中仅使用 2dp 的限制？

我可以，如果它只是用我想要的值定义常量，因为它只会是我需要这个精度的 4 或 5 个总和，但如果可以让程序计算它，那就太好了。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-27T23:07:18.033

我会按照 fbinder 所说的那样做，并使用 Doubles 来获得更高的精度。为了解决您的问题，您有两种选择，C 风格和 C++ 风格。

**C型**

```
#include <cstdio>
printf("%.5f", dummy2); 
```

**C++ 风格**

```
#include <iomanip>
std::cout << setprecision(5) << dummy2 << std::endl; 
```

或者

```
std::cout.precision(5);
std::cout << dummy2 << std::endl;
// continue to use cout to output 5 decimal places 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T22:52:29.053

为了获得更好的精度，您应该使用双精度。Doubles 的精度为 15 位，而浮点数为 7。

# jquery - 更改高亮颜色

> ID：795600
> 
> 赞同：72
> 
> 时间：2009-04-27T22:50:16.280
> 
> 标签：jquery, jquery-ui

jQuery 的 highlight 方法将突出显示任何带有黄色背景的 div。

如何指定使用什么颜色而不是黄色来突出显示？

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2009-04-27T22:51:59.880

根据[文档](https://api.jqueryui.com/highlight-effect/)：

```
$(this).effect("highlight", {color: 'blue'}, 3000); 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-04-27T22:52:30.457

```
$("div").click(function () {
    $(this).effect("highlight", { color: "#ff0000" }, 3000);
}); 
```

将以红色突出显示。这一切都在[文档](http://docs.jquery.com/UI/Effects/Highlight)中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-14T14:13:07.180

`effect("highlight",...)`FWIW 我发现当元素的当前颜色被指定为文本或突出显示颜色被指定为文本（即`"blue"`）而不是十六进制表示法时，IE8 会在 jQuery 1.7.2 中给出错误： `"#ff0000"`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-13T13:23:23.447

```
 $('.divID').live('mouseover mouseout', function (event) {
        if (event.type == 'mouseover') {
            // do something on mouseover
          $(this).css({ "background-color": YOURCOLOR, "opacity": ".50" });

        }
        else {
            // do something on mouseout
             $(this).css("opacity", "100");

        }
      }); 
```

这将提供带有不透明外观的漂亮悬停效果。

# javascript - Google Gears 和 jQuery 创建 managedStore 的问题

> ID：795601
> 
> 赞同：1
> 
> 时间：2009-04-27T22:50:51.223
> 
> 标签：javascript, jquery, google-gears, gears

我正在尝试创建一个 managedStore 来缓存我正在开发的网络应用程序中的所有 js、img、swf 和 css。

这是代码：

```
$(document).ready(function() {
    var manifestName = 'cache_manifest.json';
    var storeName = 'cache';
    var localServer;
    var localStore;
    if (window.google && google.gears) {
        localRequest = google.gears.factory.create('beta.httprequest');
        localServer = google.gears.factory.create('beta.localserver');
        localStore = localServer.openManagedStore(storeName);
        isServerAvailable();
        $("#separator").text(' | ');
        if (!localStore) {
                localStore = localServer.createManagedStore(storeName);
                localStore.manifestUrl = manifestName;
                localStore.onerror = $('#offline').text('Error con el cache');
                localStore.oncomplete = $('#offline').text('Cache activado');
                localStore.onprogress = $('#offline').text(Math.ceil(((event.filesComplete / event.filesTotal) * 100)) + "%");
                localStore.checkForUpdate();
        }
        else {
            $('#offline').text('Cache activado');
        }
    }
}); 
```

但是， localStore.onerror 总是被触发。

我不得不提问：

*   任何想法出了什么问题？
*   我怎样才能看到实际的错误是什么（ alert(localStore.onerror) 不起作用）

问候，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T16:00:02.063

尝试

```
if (!localStore) {
   localStore = localServer.createManagedStore(storeName);
   localStore.manifestUrl = manifestName;
   localStore.onerror = function(){$('#offline').text('Error con el cache');}
   localStore.oncomplete = function(){$('#offline').text('Cache activado');}
   localStore.onprogress = function(){$('#offline').text(Math.ceil(((event.filesComplete / event.filesTotal) * 100)) + "%");}
   localStore.checkForUpdate();
} 
```

您必须分配对函数的引用，这些函数应该在定义的事件上调用。你所做的是调用这些函数，最后 onerror、oncomplete 和 onprogress 属性包含由 $('#offline').text('...') 返回的 jQuery 实例

# c# - 正确调整包含未知尺寸图像的 iframe

> ID：795611
> 
> 赞同：1
> 
> 时间：2009-04-27T22:53:43.120
> 
> 标签：c#, javascript, jquery, resize

我有一个 C# webbrowser，它包含一个包含多个 iframe 的 html 页面。每个 iframe 都包含一个任意的 html 文件，通常带有图像。img 标签通常没有任何宽度或高度属性（即，通常只有`<img src="someimage.jpg">`）。

我已经阅读了如何根据内容调整 iframe 的大小，并使用 jquery 让它工作。iframe 的 html 中存在以下 jquery 片段：

```
$(document).ready(function() {
  $('img').each(function(){ 
        $(this) 
            .bind('load readystatechange', function(e) {
                var iframes = window.top.document.getElementsByName(window.name);
                if (iframes.length == 1) {
                    window.top.DoResizeFrame(iframes[0]);
                }
            })
    }); 
```

DoResizeFrame 在父 html 文件（网页浏览器显示的那个）中定义：

```
 function DoResizeFrame(fr) {
        if (fr && fr.Document && fr.Document.body) {
            fr.style.height = fr.Document.body.scrollHeight + 'px'; 
            fr.style.width = fr.Document.body.scrollWidth + 'px';
        }
    } 
```

我还从父文档的 $(document).ready 事件中调用 DoResizeFrame。这很好用——如果没有图像，文档的就绪事件会触发调整大小。如果有图像，则每次完成图像加载时，都会正确调整 iframe 的大小。

但是，加载大图像会导致 iframe 的大小不正确，直到图像完全加载为止。由于我很少在图像标签中使用宽度和高度属性，我想我可以使用 jquery 来监听图像的 readystatechange 事件，当它“加载”时，选择图像的大小并适当调整大小即使图像仍在加载中，iframe 也是如此。不幸的是，至少在 IE7 中，readystatechange=loading 仅在图像下载完成后发生。

Does anyone have any ideas how I can detect the size of an image referenced in my html simply by "`<img src="someimage.jpg">`" without waiting for the entire download to happen? I'm trying to provide the best user experience by sizing everything correctly, so that the user can read the rest of the iframe even if a large image is taking a while to download.

thanks! jean

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T23:14:16.240

One dependable way to be sure is to ask the server the size of the image before downloading it. I've done this using .net, it's quite easy.

# datetime - 如何处理 CFML 中的时区？

> ID：795615
> 
> 赞同：13
> 
> 时间：2009-04-27T22:55:56.890
> 
> 标签：datetime, coldfusion, timezone, cfml

如何处理 CFML 中的时区？到目前为止，我编写的所有应用程序都只使用 CF 服务器和/或 SQL 服务器的默认时区。

大家平时都做什么？您是否使用 GetTimezineInfo() 然后 DateAdd() 将所有日期存储在 GMT 中，并根据登录用户的偏好将所有时间转换为正确的时区？

还是你们使用任何java方法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-27T23:12:26.087

前段时间我正在研究这个问题，发现[Paul Hasting 的博客](http://www.sustainablegis.com/blog/cfg11n/index.cfm?mode=cat&catid=162AEDB4-20ED-7DEE-2A6CF1B79AC2E03A)和 Coldfusion/Java 示例非常有帮助：

不要忘记查看他的[TZCFC 测试台](http://www.sustainablegis.com/projects/tz/testTZCFC.cfm)

如何存储日期可能取决于您的业务逻辑。在我做的一个项目中，我们必须跨时区实施人力资源调度，我们将日期/时间存储在 UTC 中，并在数据库中使用 datediff 来检查冲突。

编辑：

*   [处理存储中的时区](https://stackoverflow.com/questions/11975/handling-timezones-in-storage)
*   [是否有时区信息的中央存储库](https://stackoverflow.com/questions/237023/is-there-a-central-repository-for-time-zone-information)

# javascript - 在 HTML 画布元素上绘制文本的最佳方法是什么？

> ID：795621
> 
> 赞同：2
> 
> 时间：2009-04-27T22:58:32.797
> 
> 标签：javascript, html, text, canvas

不幸的是，canvas 元素不能很好地处理文本。有很多方法（参见例如[http://canvaspaint.org/blog/2006/12/rendering-text/](http://canvaspaint.org/blog/2006/12/rendering-text/)），但它们大多看起来像黑客。我能做些什么是跨平台的，并给我最大的灵活性来让我的字体像我想要的那样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T04:41:51.177

你看过 typeface.js，[http](http://typeface.neocracy.org) ://typeface.neocracy.org 。我听说它很适合写文字。这是他们的网站：

“typeface.js 使用浏览器的矢量绘图功能在 HTML 文档中绘制文本。很长一段时间以来，浏览器都支持矢量绘图——Firefox、Safari 和 Opera 支持该`<canvas>`元素（以及 SVG），而 IE 支持VML。

typeface.js 项目有两个组件：用于转换字体的 perl 模块和用于在浏览器中绘图的 javascript 库。perl 模块从 truetype 字体中提取字形轮廓信息，并以 JSON 格式写入该数据。然后，javascript 库遍历 HTML 文档并使用`<canvas>`或 VML 呈现文本以绘制字形。

在支持`<canvas>`文本的浏览器中是可选择的，但你必须有信心。当您选择时，没有反馈，也没有突出显示让您知道它正在工作。未来的工作将旨在实现更好的跨浏览器支持，以选择具有突出显示的文本。”（引自[http://typeface.neocracy.org/usage.html](http://typeface.neocracy.org/usage.html)）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T11:02:34.507

如果你想使用 HTML5 文本方法，你应该试试这个库：[http](http://code.google.com/p/canvas-text/) ://code.google.com/p/canvas-text/ 我是主要开发人员，所以我可以提供帮助，并且可以快速做出更改。

演示在这里：[http ://canvas-text.googlecode.com/svn/trunk/examples/index.html](http://canvas-text.googlecode.com/svn/trunk/examples/index.html)

它仍处于 alpha 阶段，因此欢迎任何错误报告和反馈！:)

# php - 如何将数组内部指针设置到特定位置？PHP/XML

> ID：795625
> 
> 赞同：43
> 
> 时间：2009-04-27T23:03:50.647
> 
> 标签：php, xml, arrays

我正在尝试使用 XML 而不是数据库来构建一个小站点。

我想构建一个下一个和上一个按钮，它将相对于我显示的内容起作用。

我找到了 php 函数 next() 和 prev() 以及 current() 但我不知道如何将指针设置到特定位置以便能够相对于当前页面进行导航。

```
$list=array('page1','page2','page3') 
```

例如，如果我显示page2 的内容，我怎么能告诉php 我在$list[1] 以便next($list) 显示page3？

提前致谢

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-04-27T23:07:49.140

如果您的数组始终被一致地索引（例如，'page1' 始终位于索引'0'），那么它相当简单：

```
$List = array('page1', 'page2', 'page3', 'page4', 'page5');
$CurrentPage = 3; // 'page4'

while (key($List) !== $CurrentPage) next($List); // Advance until there's a match 
```

我个人不依赖自动索引，因为自动索引总是有可能改变。您应该考虑明确定义键：

```
$List = array(
    '1' => 'page1',
    '2' => 'page2',
    '3' => 'page3',
); 
```

**编辑：**如果要测试数组的值（而不是键），请使用[`current()`](http://php.net/current)：

```
while (current($List) !== $CurrentPage) next($List); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-11-09T12:39:24.710

使用下面的函数，您可以获得数组的*下一个*和*上一个* **值**。如果当前**值**无效或者它是数组中的**最后一个**（**第一个***- 用于 prev*）**值**，则：

*   函数**getNextVal(...)**返回第一个**元素值**
*   函数**getPrevVal(...)**返回最后一个**元素值**

函数是循环的。

```
function getNextVal(&$array, $curr_val)
{
    $next = 0;
    reset($array);

    do
    {
        $tmp_val = current($array);
        $res = next($array);
    } while ( ($tmp_val != $curr_val) && $res );

    if( $res )
    {
        $next = current($array);
    }

    return $next;
}

function getPrevVal(&$array, $curr_val)
{
    end($array);
    $prev = current($array);

    do
    {
        $tmp_val = current($array);
        $res = prev($array);
    } while ( ($tmp_val != $curr_val) && $res );

    if( $res )
    {
        $prev = current($array);
    }

    return $prev;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-11-09T12:13:17.143

使用下面的函数，您可以获得数组的*下一个*和*上一个* **KEY**。如果当前**键**无效或它是数组中的**最后一个**（**第一个***- 用于 prev*）**键**，则：

*   函数**getNext(...)**返回 0（第一个元素**key**）
*   函数**getPrev(...)**返回最后一个数组元素 的**键**

函数是循环的。

```
function getNext(&$array, $curr_key)
{
    $next = 0;
    reset($array);

    do
    {
        $tmp_key = key($array);
        $res = next($array);
    } while ( ($tmp_key != $curr_key) && $res );

    if( $res )
    {
        $next = key($array);
    }

    return $next;
}

function getPrev(&$array, $curr_key)
{
    end($array);
    $prev = key($array);

    do
    {
        $tmp_key = key($array);
        $res = prev($array);
    } while ( ($tmp_key != $curr_key) && $res );

    if( $res )
    {
        $prev = key($array);
    }

    return $prev;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-27T23:11:36.900

内部数组指针主要用于循环一个 PHP 脚本中的数组。我不建议使用它从一个页面移动到另一个页面。

为此，只需跟踪页码和页面大小（每页的项目数）。然后，当您加载另一个页面时，您可以使用它们来决定要显示哪些数组项。例如：

```
$pageNum = $_GET["pageNum"];
$pageSize = 10;
$startIndex = ($pageNum - 1) * $pageSize;
$endIndex = ($startIndex + $pageSize) - 1; 
```

（或类似的东西）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-11-28T09:16:34.317

另一种没有循环或搜索的方法。

```
list($prev,$next) = getPrevNext($oObjects,$sCurrentKey);

function getPrevNext($aArray,$key){
    $aKeys = array_keys($aArray); //every element of aKeys is obviously unique
    $aIndices = array_flip($aKeys); //so array can be flipped without risk
    $i = $aIndices[$key]; //index of key in aKeys
    if ($i > 0) $prev = $aArray[$aKeys[$i-1]]; //use previous key in aArray
    if ($i < count($aKeys)-1) $next = $aArray[$aKeys[$i+1]]; //use next key in aArray
    return array($prev,$next);
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-09-05T06:07:46.297

我使用此代码来设置带有数组键的内部指针。

```
reset($List);
while (key($List) !== $id && key($List) !== null) next($List);
if(key($List) === null) end($List); 
```

之后，您可以使用 prev() 或 next()。

更新来自@VaclavSir 的关注通知

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-05-20T15:51:32.227

试试这个

```
 public function getNextVal(&$array, $curr_val){

    foreach($array as $k=>$v){
        if($v['your_key'] == $curr_val){
            if(isset($array[$k+1]))
                return $array[$k+1];
            else
                return $array[0];
        }
    }

}

public function getPrevVal(&$array, $curr_val){

    foreach($array as $k=>$v){
        if($v['your_key'] == $curr_val){
            if(isset($array[$k-1]))
                return $array[$k-1];
            else
                return end($array);
        }
    }
} 
```

对于这样的数组：

```
array (size=3)
0 => 
array (size=11)
  'id' => string '21' (length=2)
  'cat' => string '1' (length=1)
  'gal' => string '1' (length=1)
  'type' => string 'image' (length=5)
  'name' => string 'chalk_art_dies-irea_2nd_pic' (length=27)
  'permalink' => string 'chalk-art-dies-irea-2nd-pic' (length=27)
  'url' => string 'rxNsPoEiJboJQ32.jpg' (length=19)
  'content' => string '' (length=0)
  'date' => string '1432076359' (length=10)
  'order' => string '20' (length=2)
  'views' => string '0' (length=1)
 1 => 
   array (size=11)
  'id' => string '10' (length=2)
  'cat' => string '1' (length=1)
  'gal' => string '1' (length=1)
  'type' => string 'image' (length=5)
  'name' => string '3dchalkart' (length=10)
  'permalink' => string '3dchalkart' (length=10)
  'url' => string 's57i5DKueUEI4lu.jpg' (length=19)
  'content' => string '' (length=0)
  'date' => string '1432076358' (length=10)
  'order' => string '9' (length=1)
  'views' => string '0' (length=1)
  2 => 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2015-02-13T14:00:14.350

这是完整的 @tjunglc 循环方法：

```
protected function getPrevNext($aArray,$key)
{
    $aKeys = array_keys($aArray); //every element of aKeys is obviously unique
    $aIndices = array_flip($aKeys); //so array can be flipped without risk
    $i = $aIndices[$key]; //index of key in aKeys
    if ($i > 0) $prev = $aArray[$aKeys[$i-1]]; //use previous key in aArray
    if ($i < count($aKeys)-1) $next = $aArray[$aKeys[$i+1]]; //use next key in aArray
    if (!isset($prev)) $prev = end($aArray);
    if (!isset($next)) $next = reset($aArray);
    return array($prev,$next);
} 
```

哦，谢谢@tjunglc :)

# asp.net - 如何在 Vista 上的 IIS7 下调试 ASP.NET 应用程序？

> ID：795642
> 
> 赞同：4
> 
> 时间：2009-04-27T23:10:18.057
> 
> 标签：asp.net, visual-studio-2008, iis, iis-7, cassini

IIS.net 上有一篇题为“[将 Visual Studio 2008 与 IIS 7.0 一起使用](http://learn.iis.net/page.aspx/387/using-visual-studio-2008-with-iis-70/)”的帖子，但我不太相信人们会这样做。（在其他宝石中，它建议在每次更改后发布您的 Web 应用程序。）

如果您在 IIS7 而不是 Cassini 中调试 ASP.NET 应用程序，我很想听听您的方法、提示和技巧。

**编辑**：我特指本地调试。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-27T23:43:32.360

我相信我已将您指向该指南，但是当我仔细查看它时，我认为这比我所做的要复杂一些。我做了以下事情：

1.  在 IIS 中为您的项目创建一个网站。

2.  例如，向该站点添加自定义主机标头`http://mysite:*/ or http://mysite:80/`

3.  打开`hosts`位于`C:\Windows\system32\drivers\etc`记事本中的文件（如果您使用的是 Vista，则以管理员身份运行）并添加以下行：

    ```
    mysite        127.0.0.1 
    ```

    如果您在 IIS 中的网站上有多个主机头，则需要在`hosts`文件中表示每个主机头。

现在，当您`F5`在 Visual Studio 中按下时，该站点将使用 url 打开，`http://mysite`您将能够像往常一样调试、设置断点等，除非没有与 Cassini 相关的问题... ;)

**编辑：**为了澄清起见，我只想指出，据我所知，我从来不需要将任何进程附加到 VS。至少我不必每次都这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T23:19:42.560

我只是将 Visual Studio 附加到 IIS 工作进程，如果您有多个应用程序池，那么您可以运行“issapp”来获取适当的 PID。

我从不通过单击“开始调试”进行调试。

如果您已经安装了 msvcmon，这对于在远程服务器上工作也有一个很好的优势。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T23:16:35.390

好吧，设置 IIS 7 进行调试并不是很棘手，但我更喜欢做的是节省时间（如果我对从冷启动调试不感兴趣）是在 Web 浏览器中启动 Web 应用程序/网站首先 - 让 ASP.net 预编译等。

然后我将使用 Visual Studio 附加到 IIS 进程。连接后，我可以设置断点和调试，我发现这是一种更快的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T23:37:58.537

我以管理员身份启动 Visual Studio，然后调试 > 附加到进程 > w3wp.exe。

# installation - x86 处理器上的 Windows Server 2008 Hyper-V

> ID：795645
> 
> 赞同：0
> 
> 时间：2009-04-27T23:11:14.403
> 
> 标签：installation, windows-server-2008, x86, hyper-v

我注意到在 MSDN 订阅许可证站点上有两个版本的 Windows Server 2008 w/Hyper-V 可供下载：

*   Windows Server 2008 数据中心、企业版和标准版 (x64)
*   Windows Server 2008 数据中心、企业版和标准版 (x86)

我想设置一个开发服务器来使用 Hyper-V 软件进行测试/开发。根据[先决条件](http://technet.microsoft.com/en-us/library/cc731898.aspx)，您只能在基于 x64 的处理器上运行 Hyper-V。可以在基于 x86 的处理器上运行 Hyper-V 吗？如果没有，为什么 Microsoft 提供 x86 和 x64 下载？

[这是对这个问题](https://stackoverflow.com/questions/795514/msdn-download-for-windows-servers-2008)的跟进

**更新：**

MSDN 订阅站点还提供不带 Hyper-V（x64 和 x86）的 Windows Server 2008 Datacenter、Enterprise 和 Standard 的下载。他们为什么不在 Windows Server 2008 上提供一个 x86 版本的下载，试图确定正确的安装 ISO 只是令人困惑......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T01:24:13.477

x64 CPU 仅支持 Hyper-V。除此之外，64 位 CPU 应支持 Intel 或 AMD 虚拟化硬件。来宾操作系统可以是 32 位或 64 位。有一个简单的应用程序 SecurAble [http://www.grc.com/securable.htm](http://www.grc.com/securable.htm)，您可以使用它来测试您的硬件，而无需实际安装 Windows 2008/Hyper-V。在许多情况下，您应该在 BIOS 中启用硬件虚拟化。
Hyper-V 有几个问题。最烦人的事情之一是客户操作系统中 USB 支持的运气。
除此之外，它是一个非常好的工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-12-09T02:37:55.250

x86 不需要 64 位硬件。它的存在是为了允许在旧 x86 硬件上安装 Windows Server 2008。

根据我的经验，旧版 x86 硬件通常没有硬件虚拟化支持，而这些类型的 Windows 在这种情况下工作得很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T01:08:58.677

**如果您的应用程序绝对不能在 64 位中运行，并且**您不能在 Hyper-V 32 位来宾操作系统中托管这些应用程序，或者您必须运行的硬件不提供，您应该只安装 32 位版本一个 64 位驱动程序。对于所有其他情况，运行 64 位版本的操作系统会获得[巨大优势。](http://www.microsoft.com/windowsserver2008/en/us/compare-specs.aspx)（这两个版本都需要 64 位硬件，但 x86 版本的操作系统仍然是 32 位——就像在 64 位机器上运行任何其他 32 位应用程序一样，除了这个应用程序。恰好是您的操作系统）。

# visual-studio-2005 - 为什么VS2005 ReportViewer在设置边距时会添加分页符？

> ID：795647
> 
> 赞同：2
> 
> 时间：2009-04-27T23:11:26.387
> 
> 标签：visual-studio-2005, reporting-services, reportviewer

我正在使用 Visual Studio 2005 中包含的报表查看器控件，但发生了一些奇怪的事情；当我在报表上设置边距并运行应用程序时，报表查看器会在每个内容页之后添加一个分页符，因此如果我有 2 个内容页，我最终会得到 4 个页面，其中 2 个是空白页。

如果我将报表的边距设置为零，则报表显示正常，但是如果没有边距，它当然看起来不好（并且无法正确打印）

我很确定内容没有包装或可能导致这种情况，因为我故意将桌子设计为适合 6 英寸，所以 6 英寸加 2（每个边距一个）是 8，我还有半英寸那里有空间，所以事情不会搞砸，因为这是 8.5" x 11" 的字母大小

有人有过同样的行为吗？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T17:25:40.513

找到了解决方案，结果证明正文不应该比报告大小更宽，例如，如果你有一个标准的信页：8.5" x 11" 比正文应该小于 8.5，如果你有边距，请特别注意你也必须减去这些英寸，我想要每边一英寸的边距，所以左右加起来两英寸：

8.5 - 2 = 6.5

因此，如果您打算制作一个边距为 1 英寸的信函报告，请确保正文最多为 6.5 英寸，那么它就适合了。

很明显吧？但我一开始并没有弄清楚，因为报表查看器设计器没有任何标尺来标记正文的开头，仅用于报表。

# .net - 正则表达式：匹配相同的表达式未知次数

> ID：795650
> 
> 赞同：0
> 
> 时间：2009-04-27T23:12:15.870
> 
> 标签：.net, regex

在这里的一些人的帮助下，我有一些正则表达式来匹配不在括号中的引号中的字符串：

```
"one" - matches
("two") - doesn't match 
```

是否可以重复匹配，所以输入：

```
"one" ("two") "three" 
```

会返回一和三吗？我唯一能想到的就是捕获剩余的内容并使用相同的正则表达式进行重新处理，即：

```
process > "one" ("two") "three" - returns one and "("two") "three""
process > ("two") "three"       - returns failed and "three", not sure how but hey
process > "three" 
```

我现在正在学习正则表达式，所以想知道这个功能是否内置？

注意：这可能是[在 regex, c# 中引用已经存在的组](https://stackoverflow.com/questions/638113/refering-to-already-existing-group-in-regex-c)的重复，但对我来说不够清楚:(。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T23:15:37.263

您需要[`Regex.Matches()`](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regex.matches.aspx)返回与正则表达式匹配的所有子字符串的函数。

# javascript - 使用 javascript 将链接标记为已访问

> ID：795654
> 
> 赞同：16
> 
> 时间：2009-04-27T23:12:58.660
> 
> 标签：javascript, css, hyperlink

FF2（至少）不会将链接标记为 :visited 如果它触发 onclick 处理程序而不遵循 href。我正在使用 onclick 从服务器获取数据并修改页面，链接样式在这里似乎合适。但该链接未标记为已访问。

是否有跨浏览器的方式将链接标记为已访问？如果做不到这一点，有没有办法确定浏览器的 a:visited 样式并将其应用于链接？

感谢所有回复的人。

看起来**答案**是：

*   *是否有跨浏览器的方式将链接标记为已访问？*
    不，没有办法做到这一点。如果 href 在浏览器历史记录中，则链接被标识为已访问。
*   *有没有办法确定浏览器的 a:visited 样式？*
    不，不是仅通过 javascript。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-02T03:40:07.760

这是我的做法。仅适用于支持 HTML5 历史 API的[浏览器。](http://caniuse.com/#search=history)

```
// store the current URL
current_url = window.location.href

// use replaceState to push a new entry into the browser's history
history.replaceState({},"",desired_url)

// use replaceState again to reset the URL
history.replaceState({},"",current_url) 
```

使用 replaceState 意味着后退按钮不会受到影响。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-28T00:16:46.947

我知道的唯一*解决方法如下。*

说，您访问的链接是红色的：

```
<a href="#" onclick="someEvent();this.style.color='#ff0000'">link</a> 
```

但这并不意味着当页面重新加载时，链接仍然*被标记为*已访问。

为了实现这一点，我建议提供所有链接 ID，它们在整个应用程序中当然是唯一的，或者每个页面都有命名空间。在您的`onclick`中，您将触发另一种方法，该方法将链接的 ID 保存到 cookie。

最简单的方法是逗号分隔的列表，您可以`split()`在阅读之前使用。当页面重新加载时，你会做什么。拆分时，您遍历所有 ID 并在链接上设置颜色。

例如，使用 jQuery：

```
// onclick
function saveID(id) {
  if ($.cookie('idCookie')) {
    $.cookie('idCookie', $.cookie('idCookie') + "," + id);
  } else {
    $.cookie('idCookie', id);
  }
}

// make all links colored
function setVisted() {
  var idArray = $.cookie('idCookie').split(',');
  for (var x=0; x<idArray.length; x++) {
    $('#' + idArray[x]).css('color', '#ff0000');
  }
}

// assign saveID()
$(document).ready(function(){
  $('a').click(function(){
    saveId($(this).attr('id'));
  });
  setVisited();
}); 
```

我没有测试过这段代码，但它应该能让你开始并给你一个想法。如果你幸运的话，那就是*粘贴并获胜*。;-) 我还没有研究你可以在 cookie 中存储多少，以及性能影响是什么，或者有哪些其他限制，也请参阅我的评论。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T23:18:25.620

应用与 :visited 具有相同定义的类。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T23:19:07.770

严格来说，没有个别链接的“已访问”状态。浏览器将 URL 本身解释为“已访问”。任何指向浏览器历史中的 URL 的链接都将接收由 CSS 中的 :visited 伪样式定义的样式。

您可以尝试通过将隐藏 iframe 的位置设置为所需的 URL 来伪造它，但这不会强制当前页面重新绘制，所以我怀疑您是否会看到 :visited 样式更新 w/oa 刷新。

对于您问题的第二部分，我可能会选择 Jordan Jones 的回答。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-09T16:51:27.433

有没有办法确定浏览器的 a:visited 样式？

我会说是的，因为访问了当前文档，您可以找到它的链接颜色，如下所示：-

```
alert(mys_getLinkColor(top.location))

function mys_getLinkColor(href) {
var x, body, res=''
x = document.createElement('a')
x.href = href
body = document.getElementsByTagName('body')[0]
body.appendChild(x)
if(x.currentStyle) {
   res = x.currentStyle.color
}
else if(window.getComputedStyle) {
   res = window.getComputedStyle(x,null).color
}
return mys_rgbToHexColor(res) }

function mys_rgbToHexColor(v) { 
// E.g. 'rgb(5,2,11)' converts to "#05020b". All other formats returned unchanged.
var i
v = v.split('(')
if(!v[1]) return v[0]
v = v[1].replace(/ /g, '').replace(/\)/, '')
v = v.split(',')
for(i=0; i<v.length; i++) {
   v[i] = Number(v[i]).toString(16)
   if(v[i].length==1) v[i] = '0' + v[i]
}
return '#'+v.join('')} 
```

# c# - 继续使用 System.DirectoryServices.AccountManagement 程序集中的 PrincipalContext 获取异常

> ID：795659
> 
> 赞同：3
> 
> 时间：2009-04-27T23:14:31.167
> 
> 标签：c#, exception, active-directory

使用 System.DirectoryServices.AccountManagement 程序集。

我正在使用构造函数

```
 PrincipalContext context = new PrincipalContext(
                ContextType.Domain,
                "myserver.ds.com", 
                "LDAP://OU=the-users,DC=myserver,DC=ds,DC=com", 
                adusername, 
                password); 
```

我可以打电话`context.ValidateCredentials(adusername, password, ContextOptions.ServerBinding)`，它返回真。

只要我打电话给 UserPrincipal.FindByIdentity(context, IdentityType.SamAccountName, username);

我得到各种 PrincipalOperationException。有时是“服务器发送了推荐人”。其他时候是未知错误（0x80005000）

我正在使用这些重载，因为有问题的服务器不在运行程序的用户所在的域中。

无论如何，如何解决这个问题以及可能对过程参数的一些启示将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-24T18:46:44.003

`LDAP://`从您传递的容器字符串中删除。

之后它应该可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-02-09T18:39:12.683

请注意，.NET 4.0 中有一个带有 FindByIdentity() 的错误。

[http://connect.microsoft.com/VisualStudio/feedback/details/605939/principalcontext-groupprincipal-unknown-error](http://connect.microsoft.com/VisualStudio/feedback/details/605939/principalcontext-groupprincipal-unknown-error)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T20:58:19.190

您能告诉我们您发送到的确切值是什么`FindByIdentity`吗？PrincipalContext 的创建似乎很好，如果它可以验证用户凭据，那么您的连接也应该很好。传递给 FindByIdentity 的参数很可能有问题。

马克

# xna - 动态更改或破坏 Texture2D 以进行绘图和碰撞检测

> ID：795673
> 
> 赞同：4
> 
> 时间：2009-04-27T23:21:29.200
> 
> 标签：xna, textures, sprite

我将 XNA 用于 2D 项目。我有一个问题，我不知道用什么方法来解决它。我有一个被绘制到屏幕上的纹理（图像），例如：

```
|+++|+++|
|---|---|
|+++|+++| 
```

现在我希望能够破坏该结构/图像的一部分，使其看起来像：

```
|+++|
|---|---|
|+++|+++| 
```

所以现在的碰撞也适用于新图像。

哪种方式会更好地解决这个问题：

1.  用另一个纹理交换整个纹理，在它被破坏的地方是透明的。
2.  对 spriteBatch.Draw(sourceRectangle,destinationRectangle) 使用一些技巧来绘制所需的矩形，并以某种方式对此进行碰撞检查。
3.  将纹理拆分为 4 个较小的纹理，每个纹理将负责其自己的绘图/碰撞检测。
4.  使用我不知道的其他一些聪明的方法。

任何帮助，将不胜感激。如果您需要更多说明/示例，请告诉我。

编辑：为了澄清，我将为此提供一个使用示例。想象一堵 4x4 的墙，当被射击时，它的一小部分 1x1 被摧毁。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T01:09:58.207

我会选择**第三个**选项：

> **3** - 将纹理拆分为 4 个较小的纹理，每个纹理负责自己的绘图/碰撞检测。

这并不难。基本上它与 TileSet 结构相同。但是，您需要更改代码以适应这种方法。阅读有关 Tiles 的一些信息：[http](http://www-cs-students.stanford.edu/~amitp/gameprog.html#tiles) ://www-cs-students.stanford.edu/~amitp/gameprog.html#tiles 许多网站和书籍都谈到了 Tiles 以及如何使用它来构建游戏世界。但是你可以使用这个逻辑来处理整个由小部分堆肥的所有东西。

让我快速记下其他选项：

> **1** - 用另一个纹理交换整个纹理，在它被破坏的地方是透明的。

不..对每个不同的位置都有不同的形象是不好的。如果你需要改变纹理？你会重新制作每张照片吗？

> **2** - 对 spriteBatch.Draw(sourceRectangle,destinationRectangle) 使用一些技巧来绘制所需的矩形，并以某种方式对此进行碰撞检查。

不幸的是，它不起作用，因为 spriteBatch.Draw 仅适用于 Rectangles :(

> **4**使用我不知道的其他一些聪明的方法。

我无法想象这有什么魔力。也许，您可以使用其他图像制作蒙版。但它的处理成本非常高。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-29T23:10:57.820

在 Ziggyware 上查看这篇文章。它是关于[Deformable Terrain](http://www.ziggyware.com/readarticle.php?article_id=154)的，可能是您正在寻找的。本质上，该技术涉及将要隐藏的像素设置为透明。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T02:04:09.667

选项#3 将起作用。

一个更健壮的系统（如果您不想局限于盒子）将使用每像素碰撞检测。该过程基本上如下工作：

1.  计算每个对象的边界框（或圆）
2.  检查两个对象是否重叠
3.  对于每个重叠，将精灵 blit 到隐藏的表面上，同时比较像素值。如果在您尝试从第二个精灵绘制像素时已经设置了一个像素，那么您就会发生碰撞。

这是一个很好的 XNA 示例（实际上是另一篇 Ziggyware 文章）：[2D Per Pixel Collision Detection](http://www.ziggyware.com/readarticle.php?article_id=48)

更多链接：

[有人可以解释每像素碰撞检测吗](https://stackoverflow.com/questions/173199/can-someone-explain-per-pixel-collision-detection)

[XNA 2-d 每像素碰撞](http://creators.xna.com/tutorial/collision2dperpixel)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T12:37:49.580

我最终选择了选项 3。基本上我有一个包含纹理和尺寸的 Tile 类。维度 n 表示该图块中有 n*n 个子图块。我还有一个数组可以跟踪哪些瓷砖被破坏了。我的类在伪代码中看起来像这样：

```
 class Tile
     texture
     dimention
     int [,] subtiles; //0 or 1 for each subtile

     public Tile() // constructor
         subtiles = new int[dimention, dimention];
         intialize_subtiles_to(1);

     public Draw() // this is how we know which one to draw
        //iterate over subtiles
        for(int i..
          for(int j ...)
             if(subtiles[i,j] == 1)
                Vector2 draw_pos = Vector2(i*tilewidth,
                                      j*tileheight)                       
                spritebatch.Draw(texture, draw_pos) 
```

以类似的方式，我有一个碰撞方法来检查碰撞：

```
 public bool collides(Rectangle rect)
       //iterate over subtiles 
       for i...
          for j..
              if(subtiles[i,j]==0) continue;

              subtile_rect = //figure out the rect for this subtile
              if(subtile_rect.intersects(rect))
                   return true;

       return false; 
```

等等。您可以想象如何通过将它们各自的值设置为 0 来“破坏”某些子图块，以及如何检查整个图块是否被破坏。使用这种技术，子图块将具有相同的纹理。到目前为止，我想不出更简单的解决方案。

# c++ - 在 C++ 中将值作为常量、引用和常量引用返回的含义是什么？

> ID：795674
> 
> 赞同：14
> 
> 时间：2009-04-27T23:21:41.477
> 
> 标签：c++, return-value

我正在学习 C++，但我仍然对此感到困惑。在 C++ 中将值作为常量、引用和常量引用返回的含义是什么？例如：

```
const int exampleOne();
int& exampleTwo();
const int& exampleThree(); 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-04-28T00:05:10.623

这是您所有案例的内幕：

**• 按引用返回**：函数调用可用作赋值的左侧。例如使用运算符重载，如果你有 operator[] 重载，你可以说类似

```
a[i] = 7; 
```

（通过引用返回时需要确保返回的对象在返回后可用：不应返回对本地或临时的引用）

**• 作为常量值返回**：防止函数在赋值表达式的左侧使用。考虑重载的 operator+。可以这样写：

```
a + b = c; // This isn't right 
```

将 operator+ 的返回类型设置为“const SomeType”允许按值返回，同时防止在赋值左侧使用表达式。

作为常量值返回还可以防止出现这样的拼写错误：

```
if (someFunction() = 2) 
```

当你的意思是

```
if (someFunction() == 2) 
```

如果 someFunction() 被声明为

```
const int someFunction() 
```

那么上面的 if() 错字将被编译器捕获。

**• 作为常量引用返回**：此函数调用不能出现在赋值的左侧，并且您希望避免复制（按值返回）。例如，假设我们有一个学生类，我们想提供一个访问器 id() 来获取学生的 ID：

```
class Student
{
    std::string id_;

public:

    const std::string& id() const;
};

const std::string& Student::id()
{
    return id_;
} 
```

考虑 id() 访问器。这应该声明为 const 以保证 id() 成员函数不会修改对象的状态。现在，考虑返回类型。如果返回类型是 string& 那么可以编写如下内容：

```
Student s;
s.id() = "newId"; 
```

这不是我们想要的。

我们本可以按值返回，但在这种情况下按引用返回更有效。将返回类型设为 const string& 还可以防止 id 被修改。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-27T23:50:39.053

要了解的基本内容是按值返回将创建对象的新副本。通过引用返回将返回对现有对象的引用。注意：就像指针一样，你可以有悬空引用。因此，不要在函数中创建对象并返回对该对象的引用——当函数返回时，它将被销毁，并返回一个悬空引用。

**按值返回：**

*   当您拥有 POD（普通旧数据）时
*   当您想要返回对象的副本时

**通过引用返回：**

*   当您出于性能原因避免返回要返回的对象的副本，并且您了解对象的生命周期时
*   当您必须返回对象的特定实例，并且您了解对象的生命周期时

Const / Constant 引用可帮助您执行代码的合同，并帮助用户的编译器发现使用错误。它们不影响性能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-27T23:51:14.230

返回一个常量值并不是一个很常见的习惯用法，因为无论如何你都返回了一个只有调用者才能拥有的新事物，所以他们无法修改它的情况并不常见。在您的示例中，您不知道他们将如何处理它，那么为什么要阻止他们修改它呢？

请注意，在 C++ 中，如果您不说某物是引用或指针，则它是一个值，因此您将创建它的新副本而不是修改原始对象。如果您来自默认使用引用的其他语言，这可能并不完全明显。

返回引用或 const 引用意味着它实际上是别处的另一个对象，因此对它的任何修改都会影响另一个对象。一个常见的习惯用法可能是暴露一个类的私有成员。

`const`意味着无论它是什么都不能被修改，所以如果你返回一个 const 引用，你就不能在它上面调用任何非 const 方法或修改任何数据成员。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-28T00:02:06.437

*   **按引用返回**。

您可以返回对某个值的引用，例如类成员。这样，您就不会创建副本。但是，您不应该返回对堆栈中值的引用，因为这会导致未定义的行为。

```
#include <iostream>                                                                                                                                          
using namespace  std;

class A{
private: int a;

public:
        A(int num):a(num){}

        //a to the power of 4.
        int& operate(){
                this->a*=this->a;
                this->a*=this->a;
                return this->a;
        }

        //return constant copy of a.
        const int constA(){return this->a;}

        //return copy of a.
        int getA(){return this->a;}
};

int main(){

        A obj(3);
        cout <<"a "<<obj.getA()<<endl;
        int& b=obj.operate(); //obj.operate() returns a reference!

        cout<<"a^4 "<<obj.getA()<<endl;
        b++;
        cout<<"modified by b: "<<obj.getA()<<endl;
        return 0;
} 
```

b 和 obj.a “指向”同一个值，所以修改 b 会修改 obj.a 的值。

```
$./a.out 
a 3
a^4 81
modified by b: 82 
```

*   **返回一个常量值**。

另一方面，返回一个 const 值表示该值不能被修改。需要说明的是，返回值是一个副本。：例如，

```
constA()++; 
```

将导致编译错误，因为 constA() 返回的副本是常量。但这只是一个副本，并不意味着 A::a 是恒定的。

*   **返回一个常量引用**。

这类似于返回一个 const 值，只是没有返回副本，而是对实际成员的引用。但是，它不能被修改。

```
const int& refA(){return this->a;}

const int& b = obj.refA();
b++; 
```

将导致编译错误。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-28T00:09:26.543

```
const int exampleOne(); 
```

返回某个 int 的 const 副本。也就是说，您创建了一个不能修改的新 int 。这在大多数情况下并不是很有用，因为无论如何您都在创建副本，因此您通常不在乎它是否被修改。那么为什么不只返回一个常规的 int 呢？

它可能对更复杂的类型产生影响，但修改它们可能会产生不良的副作用。（从概念上讲，假设一个函数返回一个表示文件句柄的对象。如果该句柄是 const，则该文件是只读的，否则可以对其进行修改。那么在某些情况下，函数返回一个 const 值是有意义的。但一般来说，返回 const 值并不常见。

```
int& exampleTwo(); 
```

这个返回一个对 int 的引用。但是，这不会影响该值的生命周期，因此在以下情况下可能会导致未定义的行为：

```
int& exampleTwo() {
  int x = 42;
  return x;
} 
```

我们正在返回一个对不再存在的值的引用。编译器可能会就此发出警告，但它可能还是会编译。但它没有意义，迟早会导致时髦的崩溃。不过，这在其他情况下经常使用。如果函数是类成员，它可以返回对成员变量的引用，其生命周期将持续到对象超出范围，这意味着函数返回值在函数返回时仍然有效。

```
const int& exampleThree(); 
```

与上面基本相同，返回对某个值的引用而不获取它的所有权或影响它的生命周期。主要区别在于，现在您返回的是对 const（不可变）对象的引用。与第一种情况不同，这通常更有用，因为我们不再处理其他人不知道的副本，因此代码的其他部分可能会看到修改。（您可能有一个定义它的非 const 对象，以及一个允许代码的其他部分作为 const 访问它的函数，方法是返回对它的 const 引用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-27T23:36:28.743

从来没有想过，我们可以通过引用返回一个 const 值，但我没有看到这样做的价值。但是，如果你尝试将一个值传递给这样的函数是有意义的

```
void func(const int& a); 
```

这样做的好处是告诉编译器不要在内存中复制变量 a （这是在您通过值而不是通过引用传递参数时完成的）。const 在这里是为了避免变量 a 被修改。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-28T00:03:29.817

你的第一个案例：

```
const int exampleOne(); 
```

对于像 int 这样的简单类型，这几乎不是您想要的，因为 const 毫无意义。按值返回意味着一个副本，您可以自由地分配给一个非常量对象：

```
int a = exampleOne(); // perfectly valid. 
```

当我看到这一点时，通常是因为编写代码的人试图保持 const 正确，这是值得称赞的，但并不完全理解他们所写内容的含义。但是，在*某些*情况下，重载运算符和自定义类型会产生影响。

一些编译器（较新的 GCC、Metrowerks 等）会对简单类型的此类行为发出警告，因此应避免使用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-28T00:13:57.483

我认为你的问题实际上是两个问题：

*   返回 const 的含义是什么？
*   返回引用的含义是什么。

为了给你一个更好的答案，我将更多地解释这两个概念。

**关于 const 关键字**

const 关键字意味着**不能通过**该变量修改对象，例如：

```
MyObject *o1 = new MyObject;
const MyObject *o2 = o1;
o1->set(...); // Will work and will change the instance variables.
o2->set(...); // Won't compile. 
```

现在，可以在三种*不同*的上下文中使用 const 关键字：

*   向方法的调用者保证您不会修改对象

例如：

```
void func(const MyObject &o);
void func(const MyObject *o); 
```

在这两种情况下，对对象所做的任何修改都将保留在函数范围之外，这就是为什么使用关键字 const 我向调用者保证我不会修改它的实例变量。

*   向编译器保证特定方法不会改变对象

如果你有一个类和一些方法从实例变量中“获取”或“获取”信息而不修改它们，那么即使使用了 const 关键字，我也应该能够使用它们。例如：

```
class MyObject
{
    ...
public:
    void setValue(int);
    int getValue() const; // The const at the end is the key
};

void funct(const MyObject &o)
{
    int val = o.getValue(); // Will compile.
    a.setValue(val); // Won't compile.
} 
```

*   最后，（您的情况）返回一个 const 值

这意味着返回的对象不能直接修改或变异。例如：

```
const MyObject func();

void func2()
{
    int val = func()->getValue(); // Will compile.
    func()->setValue(val); // Won't compile.
    MyObject o1 = func(); // Won't compile.
    MyObject o2 = const_cast<MyObject>(func()); // Will compile.
} 
```

有关 const 关键字的更多信息：[C++ Faq Lite - Const Correctness](http://www.parashift.com/c++-faq-lite/const-correctness.html)

**关于参考**

返回或接收引用意味着该对象不会被复制。这意味着对值本身所做的任何更改都将反映在函数范围之外。例如：

```
void swap(int &x, int &y)
{
    int z = x;
    x = y;
    y = z;
}
int a = 2; b = 3;
swap(a, b); // a IS THE SAME AS x inside the swap function 
```

因此，返回一个参考值意味着可以更改该值，例如：

```
class Foo
{
public:
    ...
    int &val() { return m_val; }
private:
    int m_val;
};

Foo f;
f.val() = 4; // Will change m_val. 
```

有关引用的更多信息：[C++ Faq Lite - 引用和值语义](http://www.parashift.com/c++-faq-lite/value-vs-ref-semantics.html)

**现在回答你的问题**

```
const int exampleOne(); 
```

表示返回的对象不能通过变量改变。返回对象时更有用。

```
int& exampleTwo(); 
```

意味着返回的对象与函数内部的对象相同，对该对象所做的任何更改都将*反映在函数内部*。

```
const int& exampleThree(); 
```

表示返回的对象与函数内部的对象相同，不能通过该变量进行修改。

# c# - Visual Studio Designer 总是试图改变我的控制

> ID：795678
> 
> 赞同：18
> 
> 时间：2009-04-27T23:24:25.997
> 
> 标签：c#, winforms, visual-studio-2008, user-controls, windows-forms-designer

我有一个有点复杂的 UserControl，而 Visual Studio 2008 在使用它时给我带来了相当无害的烦恼。每次我用设计器打开控件时，它都会决定立即更改设计器设置的一些无害值——即 Size 属性的初始化。如果我保存这些更改，关闭并重新打开，它几乎总是会决定我的控件的另一个组件需要更改其初始大小，无穷无尽。幸运的是，这些更改是无害的，因为我在任何地方都使用自动调整大小，但这很烦人。我还不清楚从哪里开始找出问题所在，我现在唯一的想法是每次打开控件时设计器都会将自动调整大小的结果分配回初始大小字段。关于原因/修复的任何想法？

**编辑：**另外，我正在使用应用程序设置来保存跨应用程序运行的某些可调整大小的子组件的大小，但我真的希望设计器足够聪明，能够理解它应该只使用默认值。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-07-25T13:48:37.737

也许它会有所帮助：
我注意到如果您插入一个自定义 UserControl，FormDesigner（没有 WPF，没有 Web 等）会出现奇怪的行为。
其他控件（GroupBox、EditBox、ComboBox）的大小随机变化（对我来说发生在宽度上）。
选择调整大小的控件似乎是随机的，但是在重新启动 vs2010 时它总是相同的。如果删除并重新插入，设计者会选择一个不同的控件来随机调整大小......

我将我的 UserControl 的属性 AutoScaleMode 从“Font”更改为“Inherit”并且它没有再次发生。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-27T23:33:50.357

你是对的，设计师经常尝试为属性添加默认值。

在属性声明的顶部添加：

```
[DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)] 
```

这将告诉设计师忽略此属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T03:05:10.020

我有一些类似的问题。我在继承的用户控件上使用 Infragistics GroupBox，现在想在派生类中更改其外观。我已在基类中对其进行了保护——因此它确实允许我更改派生类中的属性。但它不保存它。每次我打开它——我都会得到与基类相同的旧值。

任何想法？

**编辑：**我想通了。

为上述给出的答案之一尝试各种值。使用`[DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]`而不是`[DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]`为更改的属性生成代码 - 并且事情按预期工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-30T10:01:40.533

尝试覆盖控件的 DefaultSize 属性。

来自 MSDN： DefaultSize 属性表示控件最初创建时的大小。

# sitemap - 网站的线框图需要什么？

> ID：795679
> 
> 赞同：1
> 
> 时间：2009-04-27T23:25:11.063
> 
> 标签：sitemap, estimation, wireframe

我将与一些程序员和定制软件公司会面，为我参与的公司创建网站获得投标。我的问题是：我应该为程序员准备什么，以便他们可以给我一个准确的报价，时间表等网站的开发？我清楚地了解我希望该网站如何工作以及我希望包含的功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-06T14:02:35.257

我建议使用[balsamiq 之](http://www.balsamiq.com/products/mockups)类的东西将一些简单的草图放在一起，如其他地方所建议的那样。

通常，以代表实际站点的方式将您的要求写在纸上的行为会清除您以前没有考虑过的各种问题，并且会让您更清楚地了解您所追求的。

还要考虑您正在显示的数据的来源。从功能规格方面来看，简单地说“在此处显示此图”之类的内容很容易。从编程的角度来看，首先提出数字通常是困难的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-06T14:10:07.670

不是一个完整的列表，但这里有几个想法：

不要忘记后退按钮。后退按钮行为是我曾经工作过的每个网站的一个问题。如果用户通过点击后退按钮进入该页面，请准确指定您希望在每个页面上发生的事情。通常这很容易，但有时它根本不是微不足道的。

安全性：人们是否需要登录，如何，如何创建帐户，重置密码等。哪些页面需要您登录，如果您在未登录的情况下点击这些页面会发生什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T23:33:46.957

您能做的最好的事情就是戴上最终用户的帽子并描述您希望系统的外观/工作方式。

想象所有页面并为每个页面创建一个新框架。尽可能多地进行注释，以便所有投标人都确切地知道您的期望。

如果网站的要求在开发过程中可能会发生变化，我也会在最后添加，所以每个人都会提前警告。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T23:35:24.347

细节细节细节。你可能认为你有一个清晰的画面，你没有。无论多么微不足道，您都需要写下每一步。你会发现有些事情是你没有想到的。

试着写下你能想到的尽可能多的信息。浏览用户在使用您的网站时会遇到的所有场景。使用步骤如

1) 用户点击购买按钮

2) 屏幕显示 4 个项目，链接到详细信息、价格、数量和 32x32 缩略图。

2a）如果用户点击缩略图全分辨率图像等显示等。

不要试图掩盖“简单”的东西，您将获得最准确的出价！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T23:36:37.777

基本上以非常简单的方式绘制出您想要的内容（即文本框、下拉列表、控件等）。然后在每个具有某些功能的区域周围添加少量数字。在页边空白处或另一张纸上，描述您在控件上编号的每个点，并简要说明该功能应如何工作。

将其视为描述您想要的应用程序的骨架。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-15T14:32:55.597

您可以阅读 Joel Spolsky 的[Painless Functional Specifications](http://www.joelonsoftware.com/articles/fog0000000036.html)以获得想法，但我也只是试图总结一下这对 Web 软件意味着什么。

我通常分三个阶段执行此操作：

1.  内容列表，在它们将出现在网站上的标题下。在做任何线框图之前，得到各方的一致同意；

2.  纯 HTML/CSS 中的灰度功能线框，使用真实世界内容的示例和用于动态内容的虚拟静态页面，以及应有的一切。这是程序员最想看到的；

3.  每种类型页面的纯视觉图形模型 - 这是程序员希望看到的下一个东西，如“告诉我你希望它看起来如何，我会实现它”。

# winapi - SendMessage 点击非客户端项目

> ID：795684
> 
> 赞同：0
> 
> 时间：2009-04-27T23:30:28.493
> 
> 标签：winapi, sendmessage, user32

我无法让 SendMessage 激活另一个程序上的菜单。当用户单击菜单时通过 Spy++ 查看时，会发生以下情况：

```
000A0628 P WM_NCLBUTTONDOWN nHittest:HTMENU xPos:1706 yPos:395 [wParam:00000005 lParam:018B06AA 时间:27:23:56.156 点:(1706, 395)]
 000A0628 S WM_SYSCOMMAND uCmdType:SC_MOUSEMENU xPos:1706 yPos:395 [wParam:0000F095 lParam:018B06AA]
 000A0628 S WM_ENTERMENULOOP fIsTrackPopupMenu:False [wParam:00000000 lParam:00000000]
 000A0628 R WM_ENTERMENULOOP lResult:00000000
 000A0628 S WM_SETCURSOR hwnd:000A0628 nHittest:HTCAPTION wMouseMsg:0000 [wParam:000A0628 lParam:00000002]
 000A0628 R WM_SETCURSOR fHaltProcessing:False [lResult:00000000]
 000A0628 S WM_INITMENU hmenuInit:00200355 [wParam:00200355 lParam:00000000]
 000C0672 S EM_GETSEL lpdwStart:0010EFA0 lpdwEnd:0010EFA4 [wParam:0010EFA0 lParam:0010EFA4]
 000C0672 R EM_GETSEL wStart:26 wEnd:26 lpdwStart:0010EFA0 (684) lpdwEnd:0010EFA4 (276) [lResult:001A001A]
 000C0672 S WM_GETTEXTLENGTH wParam:00000000 lParam:00000000
 000C0672 R WM_GETTEXTLENGTH cch:26 [lResult:0000001A]
 000C0672 S EM_CANUNDO wParam:00000000 lParam:00000000
 000C0672 R EM_CANUNDO fCanUndo:True [lResult:00000001]
 000A0628 R WM_INITMENU lResult:00000000
 000A0628 S WM_MENUSELECT uItem：0 fuFlags：MF_POPUP | MF_HILITE | MF_MOUSESELECT hmenu:00200355 [wParam:80900000 lParam:00200355]
 000A0628 R WM_MENUSELECT lResult:00000000
 000A0628 S WM_INITMENUPOPUP hmenuPopup:00150595 uPos:0 fSystemMenu:False [wParam:00150595 lParam:00000000]
 000A0628 R WM_INITMENUPOPUP lResult:00000000
```

而当我尝试使用带有 WM_NCLBUTTONDOWN 的 SendMessage 进行相同操作时，会发生以下情况：

```
000A0628 P WM_NCLBUTTONDOWN nHittest:HTMENU xPos:1700 yPos:400 [wParam:00000005 lParam:019006A4 时间:27:25:02.156 点:(1700, 400)]
 000A0628 S WM_SYSCOMMAND uCmdType:SC_MOUSEMENU xPos:1700 yPos:400 [wParam:0000F095 lParam:019006A4]
 000A0628 S WM_ENTERMENULOOP fIsTrackPopupMenu:False [wParam:00000000 lParam:00000000]
 000A0628 R WM_ENTERMENULOOP lResult:00000000
 000A0628 S WM_EXITMENULOOP fIsTrackPopupMenu:False [wParam:00000000 lParam:00000000]
 000A0628 R WM_EXITMENULOOP lResult:00000000
 000A0628 S WM_MENUSELECT uItem:0 fuFlags:FFFF（菜单已关闭） hmenu:00000000 [wParam:FFFF0000 lParam:00000000]
 000A0628 R WM_MENUSELECT lResult:00000000
 000A0628 S WM_EXITMENULOOP fIsTrackPopupMenu:False [wParam:00000000 lParam:00000000]
 000A0628 R WM_EXITMENULOOP lResult:00000000
 000A0628 R WM_SYSCOMMAND lResult:00000000

```

有谁知道如何让它正常工作？

干杯

罗斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T23:40:06.677

您不应该使用 SendMessage 来模拟鼠标点击和按键。请改用[SendInput](http://msdn.microsoft.com/en-us/library/ms646310(VS.85).aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T00:01:41.430

我猜想菜单循环测试鼠标按钮的状态。但是，您还没有模拟按下鼠标按钮，您所做的只是发送一条消息说按钮已按下。

如果您需要同步行为，我建议您使用[Windows 挂钩](http://msdn.microsoft.com/en-us/library/ms644990(VS.85).aspx)并让您的线程阻塞直到合适的时间。（换句话说，您可以使用异步方法，然后将其包装，使其阻塞并充当同步调用。这是额外的工作，但如果您坚持从本质上异步的事物中进行同步行为，那么这是您最好的解决方案。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T12:57:02.033

您可以完美地使用 SendMessage()，尤其是用于菜单（请参阅 MSDN 和 Google Groups 以获取代码示例）
（此处与钩子无关）

# java - 非确定性下推自动机的模拟器

> ID：795685
> 
> 赞同：1
> 
> 时间：2009-04-27T23:31:18.867
> 
> 标签：java

好吧，我需要为非确定性下推自动机制作模拟器。一切都很好，我知道我需要做递归或类似的事情。但我不知道如何制作模拟自动机的功能。

我控制了其他所有东西，自动机生成器，堆栈......我在 java 中做这件事，所以这可能是人可以碰到的唯一问题，我做到了。因此，如果有人做过类似的事情，我可以使用建议。

这是我目前的代码组织：

```
Classes:  class transit:
  list<transit> -contains non deterministic transitions
  state
  input  sign
  stack sign class generator
  it generate automaton from file clas NPA
  public boolean start() - this function I am having trouble with 
```

当然是单独堆栈的问题，以及每个分支的输入。

我试图用对象集合 NPA 来解决它并尝试启动每个对象，但它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T00:19:42.353

好吧，想想自动机的定义。您有状态和状态转换功能。你有堆栈。使生活激动人心的是不确定性。

但是，每个非确定性有限自动机都有一个等价的确定性 FSA，这是一个定理（查一下）。

您可以尝试的一种方法是构建等效的 DFA。不过，这是最坏情况下的指数空间：DFA 中的每个状态都映射到 NFA 状态的幂集的子集。

因此，您可以改为“在线”尝试。现在，不是构造等效的 DFA，而是模拟 NFA；在状态转换时，你构建你到达的所有下一个状态并将它们放在一些数据结构上；然后回去看看每个这样的状态接下来会发生什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-11T19:37:58.913

[JFLAP](http://www.cs.duke.edu/csed/jflap/tutorial/) is open source and does this (and much more!) - why not check it out?

# html - 将word文档中的wingdings（等）复制到html文本字段

> ID：795687
> 
> 赞同：2
> 
> 时间：2009-04-27T23:32:48.923
> 
> 标签：html, ms-word, wingdings

当我使用 Windings 作为字体在 Word 中写出一些文本（标准英语，没有花哨的字符）时，复制文本并粘贴到 html 文本字段会导致操作系统的“我不知道这是什么字符”字符（小方块在 Windows 上）。

似乎更改字体（应该是仅显示属性）会阻止文本正确粘贴到输入字段中。

为什么不直接粘贴文本？我能做些什么来阻止“小方块”的问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-28T00:36:49.940

这里有2个问题：

1.  网页上的标准文本字段只接受/显示纯文本。将“Wingdings”字符添加到 Word 文档时，实际上是将该字符的字体更改为“Wingdings”。这是可能的，因为大多数现代文本编辑器使用高级文档格式，如 RTF、ODF、各种 Word 格式之一等。

    因此，当您将选定的文本从 Word 复制并粘贴到浏览器时，所有文本格式（包括字体信息）都会丢失。粘贴的文本将简单地以该特定文本字段的字体和样式显示。

2.  Internet 上的大多数文档都使用某种形式的 Unicode 编码进行编码，通常是 UTF-8。由于 Wingdings 没有映射到 Unicode，这会阻止它在网页上正确显示。

# visual-studio - 将搜索限制在 Visual Studio 中的指定文件夹或文件类型？

> ID：795691
> 
> 赞同：72
> 
> 时间：2009-04-27T23:34:54.020
> 
> 标签：visual-studio, search, visual-studio-2008, find

有没有办法将 Visual Studio 中的搜索（通过“查找和替换”对话框）限制为指定的文件夹或文件类型？

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2009-04-27T23:38:00.143

是的，在查找/替换窗口中，您可以：

*   在“*查看这些文件类型*”选项中指定文件类型
*   *并在“查找*”选项的`...`按钮中选择文件夹。

 *![查找和替换窗口](https://i.stack.imgur.com/9Vivn.png)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2016-03-22T21:56:38.113

我不敢相信这个问题在 VS2015 中仍然存在。我们有一个解决方案资源管理器文件夹树。为什么“当前选定的文件夹”不是下拉列表中的选项。“...”不默认从解决方案文件夹开始，我必须通过网络浏览到共享，然后向下钻取所有文件夹以获取已经存在并在解决方案探索者。Dreamweaver 为它的搜索提供了这个功能至少十年（也许更长）。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2015-12-07T11:12:49.740

1.  单击在文件中查找
2.  选择搜索文件夹三个点按钮**“...”**
3.  选择所需的文件夹
4.  验证文件夹名称并单击所需的操作

[![单击在文件中查找](https://i.stack.imgur.com/9vd3g.png)](https://i.stack.imgur.com/9vd3g.png)

[![选择搜索文件夹](https://i.stack.imgur.com/YBg6g.png)](https://i.stack.imgur.com/YBg6g.png)

[![选择所需的文件夹](https://i.stack.imgur.com/5PSsL.png)](https://i.stack.imgur.com/5PSsL.png) [![验证文件夹名称并单击所需的操作](https://i.stack.imgur.com/wsQgq.png)](https://i.stack.imgur.com/wsQgq.png)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2019-01-10T10:48:26.307

**VS 中最快的文件夹搜索：**

正如在其他答案中所说，没有直接的方法可以将您的搜索限制在当前解决方案中的给定文件夹中。[（ visualstudio.uservoice.com](https://visualstudio.uservoice.com/forums/121579-visual-studio-ide/suggestions/10145649-add-current-folder-to-search-options)中至少有 3 个功能请求已因缺乏支持而全部关闭。）

但这是我能找到的最快的解决方法。
无需离开 VS 且仅使用击键即可工作（无需鼠标操作）：

*   在解决方案资源管理器中选择要在其中搜索的文件夹。
*   按`Ctrl-C`（将文件夹路径复制到剪贴板）。
*   按`Ctrl-Shift-F`打开“在文件中查找”。
*   输入您的搜索词，然后按`Tab`将光标转发到“查找范围”字段。
*   按`Ctrl-V`从剪贴板粘贴文件夹路径。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-10-13T11:01:49.690

2020 年更新：实际上您可以在 Microsoft Visual Studio Professional 2019 版本 16.7.5 中选择文件夹（也是当前目录，单击两次）并定义文件类型

[![在查找和替换对话框中选择当前目录](https://i.stack.imgur.com/CkILx.png)](https://i.stack.imgur.com/CkILx.png)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-04-06T13:07:11.623

虽然选择搜索文件夹有效，但它可能会好得多。我真的很想选择要排除和包含的文件夹，因为有时文件夹是嵌套的。您可能需要一个文件夹，但只需要一些子文件夹。

但到目前为止，最糟糕的不便是它没有与解决方案一起存储。如果我去定义搜索的麻烦，关闭VS，然后重新打开，我必须重新定义它。

# .net - 公共属性和私有成员 C#

> ID：795693
> 
> 赞同：2
> 
> 时间：2009-04-27T23:36:05.907
> 
> 标签：.net, variables, properties

只使用公共属性而不是使用公共属性来访问私有变量有什么好处？

例如

```
public int iMyInt { get; set; } 
```

代替

```
private int myint;
public int iMyInt { get { return myint; } set { myint = value; } } 
```

除了让 .NET 管理属性下的变量/内存之外，还有什么优点（或缺点）？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-27T23:38:40.330

使用自动属性（第一个示例）需要更少的输入。

强烈建议只有公共属性而不是公共字段。许多属性都是私有字段的简单包装器。自动属性为您节省了手动创建属性和支持字段的时间和麻烦。

您提到的简单案例的自动和手动属性背后的实际代码应该几乎相同。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-27T23:43:19.740

我建议比需要更少的输入更重要的是提高代码的可读性。我通常建议使用自动属性作为我的默认选项，并且仅在对它们有特殊要求时才切换到显式属性。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-27T23:41:04.427

一旦编译为 IL，两者将几乎相同。

我个人的经验法则是使用自动属性。它们更简洁，需要更少的输入，而且我知道，当我使用它们时，它们只是一个没有逻辑的简单包装器。

如果我以后需要添加逻辑，很容易切换到我自己的支持字段，并且没有（外部）后果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T23:39:54.803

在您希望在获取或设置属性时发生某些事情之前，一种或另一种方式没有区别。

例如，如果您想要 OnMyIntSet 事件，则不能使用自动属性语法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-27T23:48:59.713

我个人的偏好是自动属性，除非另有必要。

使用自动属性的优点当然是简洁。它占用更少的空间，更容易阅读，更容易打字。

缺点是您不再有权访问私有支持变量，有时您*需要*它。

所以：当您需要使用私有后备变量时，请使用“旧”方法。如果不这样做，请使用自动属性。永远不要使用公共领域。那简直是胡说八道。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-11-02T15:49:24.383

快速说明：自动实现的属性必须同时定义 get 和 set 访问器。

# sql - 如何运行查询以使用参数按列和 asc/desc 排序？

> ID：795706
> 
> 赞同：2
> 
> 时间：2009-04-27T23:41:20.870
> 
> 标签：sql, sql-server, tsql

我正在研究这个例子。

[http://www.drury.net.nz/2005/04/15/specifying-a-sort-parameter-for-a-tsql-stored-procedure/](http://www.drury.net.nz/2005/04/15/specifying-a-sort-parameter-for-a-tsql-stored-procedure/)

```
CREATE PROCEDURE getEmployees ( @ColumnName varchar(100) ) 
AS 
  SELECT 
    EmployeeID, 
    FirstName, 
    LastName, 
    SSN, 
    Salary 
  FROM 
     Employees 
  ORDER BY 
    CASE 
      WHEN @ColumnName=’LastName’ THEN LastName 
      WHEN @ColumnName=’Salary’ THEN CONVERT(varchar(50), Salary) 
      WHEN @ColumnName=’SSN’ THEN SSN 
    END 
```

case 语句有效，但如果我有以下参数怎么办：@SortColumn、@SortDirection。

@SortColumn 可以是任何类型的任何列，它似乎使用 case 语句，您必须将值转换为相同类型。我想我可以将它们全部设为 VARCHAR，并确保将 DateTime 之类的值按我想要的正确顺序排列。

但是，如果我将 @SortDirection 参数设置为 ASC 或 DESC 作为 VARCHAR 值怎么办？如何调整查询以更改排序方向？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-28T12:27:14.303

如果您不想使用动态 SQL，那么您可以通过使用导致 where 子句的未过滤部分的 case 语句来做到这一点；不过它不会很快。您还需要注意案例部分中的类型是否匹配。

```
SELECT
  *
FROM
  dbo.Contacts
ORDER BY
    CASE @Sort
      WHEN 1 THEN Surname
      WHEN 2 THEN Forename
      WHEN 3 THEN Telephone_Number
      ELSE        ''
    END ASC
  , 
    CASE @Sort
      WHEN 4 THEN Personnel_Ref
      WHEN 5 THEN timesheet_number
      WHEN 6 THEN Telephone_Number
      ELSE        ''
    END DESC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T01:16:31.020

（显然我没有足够的声誉来发表评论，所以我在这里回复）

回复：

> 你知道我怎样才能避免使用 sp_executesql 吗？我听说如果你使用它，它就不能缓存查询计划。– 布伦南 4 月 28 日 0:16

实际上，在大多数情况下，sp_executesql 允许查询计划与存储过程一样被缓存。

诀窍是使用参数化的动态 sql，如下所示：

```
exec sp_executesql N'select from MyTable where myId = @id', N'@id int', @id; 
```

这样，您将运行相同的查询，只需替换 @id，就像使用存储过程一样。使用动态 sql，查询计划基于查询的字符串值（sp_executesql 的第一个参数）进行缓存。

我要问的唯一问题是，为什么必须在数据库中对其进行排序？我觉得你应该稍后再整理一下...

但是，由于排序表达式和方向不能参数化（它们必须直接连接到查询字符串中），因此您将获得为每个排序表达式和方向缓存的单独查询计划。这可能没什么大不了的。

**编辑：** 这是一个解释如何[缓存动态 SQL 查询计划](http://blog.namwarrizvi.com/?p=145)的链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T23:44:06.680

您可以使用动态查询。

例如，请看[这里](http://www.mssqltips.com/tip.asp?tip=1160)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-28T00:03:12.393

我想你的场景会是这样的：

如果你有

```
@SortColumn varchar(50), @SortDirection varchar(50) 
```

那么你可以这样做：

```
DECLARE @sql nvarchar(4000)    
SET @sql = N'SELECT EmployeeID, FirstName, LastName, SSN, Salary ' +
            'FROM Employees ' +
            'ORDER BY ' + @SortColumn + ' ' + @SortDirection    
EXEC sp_executesql @sql 
```

当然，您可以放入存储过程或任何您想要的内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-28T02:43:50.947

将 select 语句 for `Employee`table 的结果放入表变量或临时表中。

然后使用`if..else`语句以升序/降序返回结果。

使用没有任何问题`if..else`。

# wcf - 如何将用户凭据从 WebClient 传递到 WCF REST 服务？

> ID：795717
> 
> 赞同：8
> 
> 时间：2009-04-27T23:46:10.733
> 
> 标签：wcf, security, webclient, webhttpbinding

我正在尝试公开 WCT REST 服务，并且只有具有有效用户名和密码的用户才能访问它。用户名和密码存储在 SQL 数据库中。

这是服务合同：

```
public interface IDataService
{
    [OperationContract]
    [WebGet(ResponseFormat = WebMessageFormat.Json)]
    byte[] GetData(double startTime, double endTime);
} 
```

这是 WCF 配置：

```
<bindings>
  <webHttpBinding>
    <binding name="SecureBinding">
      <security mode="Transport">
        <transport clientCredentialType="Basic"/>
      </security>
    </binding>
  </webHttpBinding>
</bindings>
<behaviors>
  <serviceBehaviors>
    <behavior name="DataServiceBehavior">
      <serviceMetadata httpGetEnabled="true"/>
      <serviceCredentials>
        <userNameAuthentication
           userNamePasswordValidationMode="Custom"
           customUserNamePasswordValidatorType=
                 "CustomValidator, WCFHost" />
      </serviceCredentials>
    </behavior>
  </serviceBehaviors>
</behaviors>
<services>
  <service behaviorConfiguration="DataServiceBehavior" name="DataService">
    <endpoint address="" binding="webHttpBinding"
              bindingConfiguration="SecureBinding" contract="IDataService" />
  </service>
</services> 
```

我正在通过 Silverlight 应用程序中的 WebClient 类访问该服务。但是，我无法弄清楚如何将用户凭据传递给服务。我尝试了 client.Credentials 的各种值，但它们似乎都没有触发我的自定义验证器中的代码。我收到以下错误：底层连接已关闭：发送时发生意外错误。

这是我尝试过的一些示例代码：

```
 WebClient client = new WebClient();
   client.Credentials = new NetworkCredential("name", "password", "domain");
   client.OpenReadCompleted += new OpenReadCompletedEventHandler(GetData);
   client.OpenReadAsync(new Uri(uriString)); 
```

如果我将安全模式设置为“无”，则一切正常。我还尝试了其他 clientCredentialType 值，但没有一个起作用。我还自托管了 WCF 服务，以消除与 IIS 在服务获得机会之前尝试对用户进行身份验证相关的问题。

任何关于潜在问题的评论将不胜感激。谢谢。

**更新**：感谢 Mehmet 的出色建议。这是我的跟踪配置：

```
 <system.diagnostics>
    <sources>
      <source name="System.ServiceModel"
              switchValue="Information, ActivityTracing"
              propagateActivity="true">
        <listeners>
          <add name="xml" />
        </listeners>
      </source>
      <source name="System.IdentityModel" switchValue="Information, 
               ActivityTracing" propagateActivity="true">
        <listeners>
          <add name="xml" />
        </listeners>
      </source>
    </sources>
    <sharedListeners>
      <add name="xml"
           type="System.Diagnostics.XmlWriterTraceListener"
           initializeData="c:\Traces.svclog" />
    </sharedListeners>
  </system.diagnostics> 
```

但我没有看到来自我的 Silverlight 客户端的任何消息。至于 https 与 http，我使用 https 如下：

```
string baseAddress = "https://localhost:6600/";
_webServiceHost = new WebServiceHost(typeof(DataServices), 
                new Uri(baseAddress));
_webServiceHost.Open(); 
```

但是，我没有配置任何 SSL 证书。这是问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T03:07:55.237

由于您使用的是“基本”身份验证，因此您需要在请求标头中发送用户名和密码。手动将凭据添加到标头的示例如下所示：

```
HttpWebRequest req = (HttpWebRequest)WebRequest.Create(@"https://localhost:6600/MyWCFService/GetData");
//Add a header to the request that contains the credentials
//DO NOT HARDCODE IN PRODUCTION!! Pull credentials real-time from database or other store.
string svcCredentials = Convert.ToBase64String(ASCIIEncoding.ASCII.GetBytes("userName" + ":" + "password"));
req.Headers.Add("Authorization", "Basic " + svcCredentials);
//Parse the response and do something with it...
using (WebResponse svcResponse = (HttpWebResponse)req.GetResponse())
{
  using (StreamReader sr = new StreamReader(svcResponse.GetResponseStream()))
  {
    //Sample parses json response; your code here may be different
    JavaScriptSerializer js = new JavaScriptSerializer();
    string jsonTxt = sr.ReadToEnd();
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T00:14:21.477

首先，您可能希望将 WCF 跟踪添加到您的服务以获取更多详细信息。其次，我认为问题可能是您以明文形式发送用户凭据，而 WCF 不允许通过不安全的传输通道以明文形式传输用户凭据。因此，请尝试使用 https 或指定加密算法以通过 http 保护用户凭据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T06:31:50.050

**上面的 atconway**建议似乎是正确的方法，但您的服务必须从标头读取 base 64 字符串数据并转换回字符串，然后进行身份验证。但它需要在每次调用时进行身份验证。

**另一种方法是使用安全密钥。和令牌**

1.  每个客户端都有他在第一次请求时发送的**安全密钥**，可能在标头中。
2.  您可以生成密钥，例如 key = MD5Hash(username+password);
3.  作为响应，他获得了**令牌**，然后在每个请求中发送令牌。令牌可以是 Guid。每个令牌在*x*分钟后过期。
4.  在服务器端，您可以维护一个像 Dictionay 这样的单例字典，以在当前时间 > 过期时间将其从字典中删除时检查令牌过期。
5.  要更新会话，请将更新会话方法放入您的代码中。

**为了极高的安全性**

拥有私钥/公钥对，客户端将使用公钥加密整个帖子数据，您将使用私钥解密。

# ruby - Camping 和 Sinatra 之间有什么重要的区别吗？

> ID：795727
> 
> 赞同：4
> 
> 时间：2009-04-27T23:51:45.760
> 
> 标签：ruby, sinatra, web-frameworks, camping

我的感觉是 Camping 和 Sinatra 之间的差异不是很显着，您可以放心地选择其中一个并没问题。但我想问问 Ruby 专家这是否属实。Sinatra 和 Camping 微框架之间实际上有什么重要区别吗？您将如何决定使用哪一个？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-28T00:08:45.407

我知道的唯一显着区别是 Camping 基于 MVC 模式（如 rails），并与 ActiveRecord 耦合。西纳特拉更加不可知论。

~~露营也不再维护，而 Sinatra 正在积极开发中。仅此一项可能就足以让我们先看看 Sinatra。~~

编辑：感谢您的纠正菲利普，很高兴听到露营的发展正在进行中。抱歉，另有说明。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-07-03T17:04:10.250

需要考虑的一件事是露营有点[像高尔夫运动](http://en.wikipedia.org/wiki/Perl#Perl_golf)。它是 4k，但 judofyr 已将其降至 3k。尝试阅读[源代码](https://github.com/camping/camping/blob/master/lib/camping.rb)，我敢。现在，还有[未删节的版本](https://github.com/camping/camping/blob/master/lib/camping-unabridged.rb)，可以给你不错的评论，但代码本身仍然令人痛苦地混淆。

使用 Sinatra，您可以轻松地挖掘内部结构并找到惯用的红宝石。恕我直言，这非常重要，尤其是当您需要修补某些东西时。

（请记住，露营在设计上是古怪的，我的目的不是要做出判断。）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-07-06T16:27:38.127

[露营*正在*维护](http://github.com/camping/camping)中。自从 _why 一直专注于[Hackety-Hack/Shoes](http://www.cuberick.com/2009/03/hackety-hack-is-backety-back.html)直到他消失了，并且（正如[语义](https://stackoverflow.com/users/96232/semanticart)艺术在上面所写的）Magnus Holm ( [judofyr](http://github.com/judofyr) ) 一直[致力于 Camping](http://wiki.github.com/camping/camping)。未删节的版本有一些[有用的文档](http://rdoc.info/projects/camping/camping)。它对我来说很好，虽然我还没有真正扩展它，但那里的一些露营应用程序（如[Cheat](http://cheat.errtheblog.com/)）运行良好。

您可能还想检查[Sinatra 和 Ramaze 之间的主要区别是什么？](https://stackoverflow.com/questions/812856/what-are-the-main-differences-between-sinatra-and-ramaze/1086264#1086264)其中有一些到 Sinatra 和其他轻量级 Ruby 框架的有用链接。

# c# - 现代编程中不推荐使用“#IF DEBUG”吗？

> ID：795731
> 
> 赞同：5
> 
> 时间：2009-04-27T23:55:26.623
> 
> 标签：c#

这是我的第一个 StackOverflow 问题，所以很好！:-)

我最近在一些 C# 源代码中遇到了以下示例：

```
public IFoo GetFooInstance()
{
    #IF DEBUG
        return new TestFoo();
    #ELSE
        return new Foo();
    #ENDIF
} 
```

这让我想到了这些问题：

1.  是否非正式地弃用了“#IF DEBUG”的使用？如果不是，什么被认为是其使用的良好实现？
2.  使用类工厂和/或 MOQ、RhinoMocks 等工具如何实现上述示例？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-28T00:00:42.367

使用 IoC 容器，整个函数变得多余，而不是调用 GetFooInstance 您将拥有类似于以下的代码：

```
ObjectFactory.GetInstance<IFoo>(); 
```

IoC 容器的设置可以在代码中或通过配置文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-28T00:00:32.070

没有。我们一直使用它在我们的程序集中散布诊断信息。例如，我在调试时使用了以下快捷方式：

```
#if DEBUG
        if( ??? ) System.Diagnostics.Debugger.Break();
#endif 
```

哪里可以改？？？到任何相关的表达式，如 Name == "Popcorn"。等等。这样可以确保没有任何调试代码泄漏到发布版本中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T00:08:24.033

就像其他一些海报提到的那样，我一直使用#if 语句来调试场景。

您发布的代码风格更像是一种工厂创建模式，这很常见。我经常使用它，不仅不认为它贬值，而且我认为#if 和#define 语句的使用是我的技巧包中的一个重要工具。

我相信 CastleWindsor ( [http://www.castleproject.org/container/index.html](http://www.castleproject.org/container/index.html) ) 也有一个 IoC 容器。我相信一般模式是，在配置文件中，您声明 TestFoo 或 IFoo 将是 CastleWindsor 初始化 IoC 容器时创建的类。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-28T01:58:10.290

是的。我强烈建议不要使用“ `#IF DEBUG`”，除非在极少数情况下

它在 C 中很常见，但您不应该在 C# 等现代语言中使用，原因如下：

1.  代码（和头文件）文件变得噩梦
2.  太容易犯错误并为发布构建留下/退出条件
3.  测试变成一场噩梦：需要测试多种构建组合
4.  并非所有代码都经过编译检查，除非您针对所有可能的条件符号进行编译！

@Richard 的回答显示了如何使用 IoC 替换（更清洁）。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-28T01:37:56.987

我强烈反对#if; 而是`if`与清单常量一起使用：

```
#define DEBUG 0   // actually in a header or on a command line

public IFoo GetFooInstance()
{
    if (DEBUG)
        return new TestFoo();
    else
        return new Foo();
} 
```

为什么`#IF`不好？因为在`#IF`版本中，**并非所有代码都经过 typechecked**。对于复杂的、长期存在的代码，bitrot 可以设置，然后突然你需要`DEBUG`，但代码不会构建。使用该`if`版本，代码始终可以构建，即使是最小的优化设置，您的编译器也会完全消除无法访问的代码。换句话说，只要*已知*`DEBUG`始终为 0（并且会为您执行此操作）*，*使用.*`#define`*`if`**

 **并且您可以保证，如果您`DEBUG`从 0 更改为 1，系统将构建。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-04-28T00:08:04.580

你的编译器应该足够聪明，可以弄清楚：

```
final DEBUG=false;
...
if(DEBUG)
    return new debugMeh();
else
    return new meh(); 
```

该方法永远不必被调用，事实上，可以从最终程序集中编译出来。

再加上即使未经优化的性能差异也不会产生任何重大影响，这使得使用一些不同的语法几乎是不必要的。

编辑：我想在这里指出一些有趣的事情。评论里有人刚刚说：

```
#IF DEBUG
    return new TestFoo();
#ELSE
    return new Foo();
#ENDIF 
```

比这更容易写：

```
if(DEBUG)
    return new TestFoo();
else
    return new Foo(); 
```

我发现人们会竭尽全力捍卫他们做事的方式是正确的，这真是令人惊讶。另一个说他们必须在每个文件中定义一个 DEBUG 变量。我不确定 C#，但在 Java 中，我们通常放一个

```
public static final DEBUG=true; 
```

在我们的记录器或另一个中央工厂对象中（尽管我们实际上找到了更好的方法来做到这一点——比如使用 DI）。

我并不是说 C# 中不存在相同的工具，我只是惊讶于人们会竭尽全力证明他们因为习惯而坚持的解决方案是正确的。

# sql-server - 来自 Sql 2008 Mgmt Studio 的脚本表

> ID：795732
> 
> 赞同：1
> 
> 时间：2009-04-27T23:56:51.720
> 
> 标签：sql-server

我使用 Sql Server Mgmt Studio 为我们的数据库和所有实体的创建编写脚本。最近我们从 SQL Server 2005 迁移到 SQL Server 2008，我现在使用的是 2008 版的 Mgmt Studio。

我注意到它的脚本支持存在一些微小但令人讨厌的差异，这让我很难将现有的 2005 脚本与 2008 年创建的新脚本进行区分。

我遇到的一些问题是表格以某种不确定的顺序（不是字母顺序）排序，以及每个 GO 命令后的额外换行符。

有谁知道如何使 2008 版的 Mgmt Studio 脚本与 2005 版相同？

补充一点，我发现如果我使用“对象资源管理器详细信息”窗口的多选功能，我可以在生成的脚本中获得一致的表顺序，但如果我使用“生成脚本”向导，我不会。该向导似乎仅在我进行架构更改时更改顺序，但它使差异更改变得更加困难。其他人肯定看到了这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-28T01:32:43.190

如果你去工具 -> 选项，打开“SQL Server 对象资源管理器”节点，然后选择“脚本”节点，有几个选项可以改变脚本的生成方式，包括“服务器版本的脚本”可以设置为“SQL Server 2005”。

# asp.net - 打开一个弹出窗口最大化用户的屏幕配置

> ID：795740
> 
> 赞同：2
> 
> 时间：2009-04-28T00:01:34.220
> 
> 标签：asp.net, popup

打开最大化用户屏幕配置的弹出窗口的最佳方法是什么？我正在使用 C# ASP.NET 3.5 网站项目。

**更新：**

@Anthony - windows xp 任务栏覆盖了一些浏览器窗口。windows xp任务栏如何设置maxmmumize并停止？

**更新1：**

我使用以下解决方案来最大化弹出窗口，但它首先打开窗口然后将其移动到屏幕的左上角。有没有办法在 0,0 位置打开弹出窗口？

```
function openMaxWindow(url) {
    var name = "MyWindow";
    var features = "status=1,toolbar=1,location=1,menubar=1,scrollbars=1,resizable=1,top=0,left=0,height=" + screen.availHeight + ",width=" + screen.availWidth;

    var newWindow = window.open(url, name, features); 
} 
```

**更新 2：**

想通了，我需要将 top=0 和 left=0 添加到功能列表中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-28T00:19:37.563

使用javascript运行

`var newWindow = window.open(); newWindow.resizeTo(screen.width, screen.height);`

显然，您需要使用适当的参数来`window.open()`声明。

[此链接还显示了如何做到这一点](http://www.boutell.com/newfaq/creating/maximize.html)

**编辑**

```
newWindow.moveTo(0,0);
newWindow.resizeTo(screen.availWidth, screen.availHeight); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-21T07:01:14.873

```
function maximizeWindow() {
  window.moveTo(0, 0);
  if (document.all) {
    top.window.resizeTo(screen.availWidth,screen.availHeight);
  } else if (document.layers||document.getElementById) {
    if (top.window.innerHeight < screen.availHeight || top.window.innerWidth < screen.availWidth) {
      top.window.outerHeight = screen.availHeight;
      top.window.outerWidth = screen.availWidth;
    }
  }
} 
```

# php - 警告：mysql_fetch_array()：提供的参数不是有效的 MySQL 结果

> ID：795746
> 
> 赞同：43
> 
> 时间：2009-04-28T00:03:46.527
> 
> 标签：php, mysql

尝试运行时出现错误：

```
<?php
require_once('includes/DbConnector.php');
$connector = new DbConnector();
$result = $connector->query('SELECT title,content FROM staff_vacancies ORDER BY ordering LIMIT 0,100');
// Get an array containing the results.
// Loop for each item in that array
while ($row = $connector->fetchArray($result)){

echo $row['title'].'</h3>';
echo $row['content'];
}
?> 
```

我有一个链接文件：DbConnector.php：

```
<?php
////////////////////////////////////////////////////////////////////////////////////////
// Class: DbConnector
// Purpose: Connect to a database, MySQL version
///////////////////////////////////////////////////////////////////////////////////////
require_once 'SystemComponent.php';

class DbConnector extends SystemComponent {

var $theQuery;
var $link;

//*** Function: DbConnector, Purpose: Connect to the database ***
function DbConnector(){

    // Load settings from parent class
    $settings = SystemComponent::getSettings();

    // Get the main settings from the array we just loaded
    $host = $settings['dbhost'];
    $db = $settings['dbname'];
    $user = $settings['dbusername'];
    $pass = $settings['dbpassword'];

    //the settings
    $host = 'localhost';
    $db = 'xxx';
    $user = 'xxx';
    $pass = 'xxx';

    // Connect to the database
    $this->link = mysql_connect($host, $user, $pass);
    mysql_select_db($db);
    register_shutdown_function(array(&$this, 'close'));

}

//*** Function: query, Purpose: Execute a database query ***
function query($query) {
    $this->theQuery = $query;
    return mysql_query($query, $this->link);
}

//*** Function: getQuery, Purpose: Returns the last database query, for debugging ***
function getQuery() {
    return $this->theQuery;
}

//*** Function: getNumRows, Purpose: Return row count, MySQL version ***
function getNumRows($result) {
    return mysql_num_rows($result);
}

//*** Function: fetchArray, Purpose: Get array of query results ***
function fetchArray($result) {
    return mysql_fetch_array($result);
}

//*** Function: close, Purpose: Close the connection ***
function close() {
    mysql_close($this->link);
}

}
?> 
```

有谁知道问题是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-28T00:10:19.863

您的查询一定存在导致 $result 成为无效资源的问题。

尝试在运行查询的行之后检查[mysql_error() 。](http://ca3.php.net/mysql_error)

编辑：

实际上，我会将您的 DBConnector 类函数 query() 更改为类似以下内容，以便在查询错误时引发可识别的错误：

```
function query($query) {
    $this->theQuery = $query;
    $queryId = mysql_query($query,$this->link);
    if (! $queryId) {
        throw new Exception(mysql_error().".  Query was:\n\n".$query."\n\nError number: ".mysql_errno();
    }
    return $queryId;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-05-19T20:24:40.633

我在帖子中找到了这个，对我来说解决了我的问题。Slds。

是的，答案很简单，使用的查询不是真正的结果，因为它是 getrow 内部的查询，可以这么说。这是修复：查找所有看起来像这样的行：

```
mysql_fetch_array(mysql_query("...snip...";-) ); 
```

只需在它前面添加一个“@”，它看起来像这样：

```
@mysql_fetch_array(mysql_query("...snip...";-) ); 
```

然后对以下几行做同样的事情。代码：

```
mysql_num_rows(mysql_query("...snip...";-) ); 
```

执行与上述相同的步骤，将“@”添加到它，使其看起来像这样：

```
@mysql_num_rows(mysql_query("...snip...";-) ); 
```

所有这一切都说“在 yyy 内做​​ xxx” 否则，由于缺少结果值，它已经死了。这是一个PHP的东西..

像魅力一样工作，我花了 5 分钟将整个代码撕开并将其全部放入 Modernbill，共享相同的数据库并且非常适合我。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-10-01T14:20:26.590

此错误表示您的查询失败。**`mysql_query()`**如果发生错误，则返回 false，然后您将 false 传递给**`mysql_fetch_array()`**触发错误消息的对象。

由于缺少/错误的表或字段，您的查询可能会失败。要查看详细错误，请打印**mysql_error()**的结果。

该`mysql_*`库已弃用。建议升级到**`MySQLi`**或PDO。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T17:17:11.883

请提供来自 mysql_error() 的错误。没有它，我只能猜测...尝试转义您的字段名称？

```
$result = $connector->query('SELECT `title`,`content` FROM `staff_vacancies` ORDER BY `ordering` LIMIT 0,100'); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-28T00:17:27.617

```
// Load settings from parent class
$settings = SystemComponent::getSettings();

// Get the main settings from the array we just loaded
$host = $settings['dbhost'];
$db = $settings['dbname'];
$user = $settings['dbusername'];
$pass = $settings['dbpassword'];

//the settings
$host = 'localhost';
$db = 'xxx';
$user = 'xxx';
$pass = 'xxx'; 
```

您的意思是重新分配连接变量吗？或者是你忘记取出的那几行存根代码？或者只是一个示例来显示 $settings 包含的内容？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-04-28T06:13:59.857

您的查询一定存在导致 $result 成为无效资源的问题。

用这个

```
<?php
require_once('includes/DbConnector.php');
$connector = new DbConnector();
$result = $connector->query('SELECT title,content FROM staff_vacancies ORDER BY ordering LIMIT 0,100');
// Get an array containing the results.
// Loop for each item in that array

if($result){
while ($row = $connector->fetchArray($result)){

echo $row['title'].'</h3>';
echo $row['content'];
}
}
?> 
```

# exception - 我可以在 PowerShell 中获得详细的异常堆栈跟踪吗？

> ID：795751
> 
> 赞同：59
> 
> 时间：2009-04-28T00:07:46.297
> 
> 标签：exception, powershell, stack-trace

运行这样的脚本：

```
 1: function foo()
 2: {
 3:    bar
 4: }
 5: 
 6: function bar()
 7: {
 8:     throw "test"
 9: }
10: 
11: foo 
```

我懂了

```
test
At C:\test.ps1:8 char:10 
```

我可以获得详细的堆栈跟踪吗？

```
At bar() in C:\test.ps1:8
At foo() in C:\test.ps1:3 
At C:\test.ps1:11 
```

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-04-28T14:07:16.747

[PowerShell 团队博客上](https://devblogs.microsoft.com/powershell/resolve-error/)有一个名为 Resolve-Error 的功能，它将为您提供各种详细信息

请注意，$error 是您在 PSSession 中遇到的所有错误的数组。此功能将为您提供有关您遇到的最后一个错误的详细信息。

```
function Resolve-Error ($ErrorRecord=$Error[0])
{
   $ErrorRecord | Format-List * -Force
   $ErrorRecord.InvocationInfo |Format-List *
   $Exception = $ErrorRecord.Exception
   for ($i = 0; $Exception; $i++, ($Exception = $Exception.InnerException))
   {   "$i" * 80
       $Exception |Format-List * -Force
   }
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-03-13T23:48:14.580

Powershell 3.0 将 ScriptStackTrace 属性添加到 ErrorRecord 对象。我使用此功能进行错误报告：

```
function Write-Callstack([System.Management.Automation.ErrorRecord]$ErrorRecord=$null, [int]$Skip=1)
{
    Write-Host # blank line
    if ($ErrorRecord)
    {
        Write-Host -ForegroundColor Red "$ErrorRecord $($ErrorRecord.InvocationInfo.PositionMessage)"

        if ($ErrorRecord.Exception)
        {
            Write-Host -ForegroundColor Red $ErrorRecord.Exception
        }

        if ((Get-Member -InputObject $ErrorRecord -Name ScriptStackTrace) -ne $null)
        {
            #PS 3.0 has a stack trace on the ErrorRecord; if we have it, use it & skip the manual stack trace below
            Write-Host -ForegroundColor Red $ErrorRecord.ScriptStackTrace
            return
        }
    }

    Get-PSCallStack | Select -Skip $Skip | % {
        Write-Host -ForegroundColor Yellow -NoNewLine "! "
        Write-Host -ForegroundColor Red $_.Command $_.Location $(if ($_.Arguments.Length -le 80) { $_.Arguments })
    }
} 
```

Skip 参数允许我将 Write-Callstack 或任意数量的错误处理堆栈帧排除在 Get-PSCallstack 列表之外。

请注意，如果从 catch 块调用，Get-PSCallstack 将错过 throw 站点和 catch 块之间的任何帧。因此，我更喜欢 PS 3.0 方法，即使我们每帧的细节更少。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-04-28T08:43:25.060

有自动变量`$StackTrace`，但它似乎对内部 PS 细节更具体一点，而不是真正关心你的脚本，所以这不会有太大帮助。

也有，`Get-PSCallStack`但不幸的是，一旦你遇到异常，它就消失了。但是，您可以`Get-PSCallStack`在脚本中的每次抛出之前放置一个。这样您就可以在遇到异常之前立即获得堆栈跟踪。

我认为可以通过使用 Powershell 的调试和跟踪功能编写这样的功能，但我怀疑这很容易。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-04-28T20:11:54.810

您无法从 PowerShell 脚本代码的异常中获取堆栈跟踪，只能从 .NET 对象中获取。为此，您需要获取 Exception 对象，如下所示：

```
$Error[0].Exception.StackTrace
$Error[0].Exception.InnerException.StackTrace
$Error[0].StackTrace 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2014-07-09T02:52:38.257

我将在这里找到的内容作为灵感，并创建了一个任何人都可以放入他们的代码中的好功能。

这就是我所说的：Write-Host“无法写入日志文件`n$(Resolve-Error)”-ForegroundColor Red

```
Function Resolve-Error
{
<#
.SYNOPSIS
    Enumerate error record details.

.DESCRIPTION
    Enumerate an error record, or a collection of error record, properties. By default, the details
    for the last error will be enumerated.

.PARAMETER ErrorRecord
    The error record to resolve. The default error record is the lastest one: $global:Error[0].
    This parameter will also accept an array of error records.

.PARAMETER Property
    The list of properties to display from the error record. Use "*" to display all properties.
    Default list of error properties is: Message, FullyQualifiedErrorId, ScriptStackTrace, PositionMessage, InnerException

    Below is a list of all of the possible available properties on the error record:

    Error Record:               Error Invocation:           Error Exception:                    Error Inner Exception(s):
    $_                          $_.InvocationInfo           $_.Exception                        $_.Exception.InnerException
    -------------               -----------------           ----------------                    ---------------------------
    writeErrorStream            MyCommand                   ErrorRecord                         Data
    PSMessageDetails            BoundParameters             ItemName                            HelpLink
    Exception                   UnboundArguments            SessionStateCategory                HResult
    TargetObject                ScriptLineNumber            StackTrace                          InnerException
    CategoryInfo                OffsetInLine                WasThrownFromThrowStatement         Message
    FullyQualifiedErrorId       HistoryId                   Message                             Source
    ErrorDetails                ScriptName                  Data                                StackTrace
    InvocationInfo              Line                        InnerException                      TargetSite
    ScriptStackTrace            PositionMessage             TargetSite                          
    PipelineIterationInfo       PSScriptRoot                HelpLink                            
                                PSCommandPath               Source                              
                                InvocationName              HResult                             
                                PipelineLength              
                                PipelinePosition            
                                ExpectingInput              
                                CommandOrigin               
                                DisplayScriptPosition       

.PARAMETER GetErrorRecord
    Get error record details as represented by $_
    Default is to display details. To skip details, specify -GetErrorRecord:$false

.PARAMETER GetErrorInvocation
    Get error record invocation information as represented by $_.InvocationInfo
    Default is to display details. To skip details, specify -GetErrorInvocation:$false

.PARAMETER GetErrorException
    Get error record exception details as represented by $_.Exception
    Default is to display details. To skip details, specify -GetErrorException:$false

.PARAMETER GetErrorInnerException
    Get error record inner exception details as represented by $_.Exception.InnerException.
    Will retrieve all inner exceptions if there is more then one.
    Default is to display details. To skip details, specify -GetErrorInnerException:$false

.EXAMPLE
    Resolve-Error

    Get the default error details for the last error

.EXAMPLE
    Resolve-Error -ErrorRecord $global:Error[0,1]

    Get the default error details for the last two errors

.EXAMPLE
    Resolve-Error -Property *

    Get all of the error details for the last error

.EXAMPLE
    Resolve-Error -Property InnerException

    Get the "InnerException" for the last error

.EXAMPLE
    Resolve-Error -GetErrorInvocation:$false

    Get the default error details for the last error but exclude the error invocation information

.NOTES
.LINK
#>
    [CmdletBinding()]
    Param
    (
        [Parameter(Mandatory=$false, Position=0, ValueFromPipeline=$true, ValueFromPipelineByPropertyName=$true)]
        [ValidateNotNullorEmpty()]
        [array]$ErrorRecord,

        [Parameter(Mandatory=$false, Position=1)]
        [ValidateNotNullorEmpty()]
        [string[]]$Property = ('Message','InnerException','FullyQualifiedErrorId','ScriptStackTrace','PositionMessage'),

        [Parameter(Mandatory=$false, Position=2)]
        [switch]$GetErrorRecord = $true,

        [Parameter(Mandatory=$false, Position=3)]
        [switch]$GetErrorInvocation = $true,

        [Parameter(Mandatory=$false, Position=4)]
        [switch]$GetErrorException = $true,

        [Parameter(Mandatory=$false, Position=5)]
        [switch]$GetErrorInnerException = $true
    )

    Begin
    {
        ## If function was called without specifying an error record, then choose the latest error that occured
        If (-not $ErrorRecord)
        {
            If ($global:Error.Count -eq 0)
            {
                # The `$Error collection is empty
                Return
            }
            Else
            {
                [array]$ErrorRecord = $global:Error[0]
            }
        }

        ## Define script block for selecting and filtering the properties on the error object
        [scriptblock]$SelectProperty = {
            Param
            (
                [Parameter(Mandatory=$true)]
                [ValidateNotNullorEmpty()]
                $InputObject,

                [Parameter(Mandatory=$true)]
                [ValidateNotNullorEmpty()]
                [string[]]$Property
            )
            [string[]]$ObjectProperty = $InputObject | Get-Member -MemberType *Property | Select-Object -ExpandProperty Name
            ForEach ($Prop in $Property)
            {
                If ($Prop -eq '*')
                {
                    [string[]]$PropertySelection = $ObjectProperty
                    Break
                }
                ElseIf ($ObjectProperty -contains $Prop)
                {
                    [string[]]$PropertySelection += $Prop
                }
            }
            Write-Output $PropertySelection
        }

        # Initialize variables to avoid error if 'Set-StrictMode' is set
        $LogErrorRecordMsg      = $null
        $LogErrorInvocationMsg  = $null
        $LogErrorExceptionMsg   = $null
        $LogErrorMessageTmp     = $null
        $LogInnerMessage        = $null
    }
    Process
    {
        ForEach ($ErrRecord in $ErrorRecord)
        {
            ## Capture Error Record
            If ($GetErrorRecord)
            {
                [string[]]$SelectedProperties = &$SelectProperty -InputObject $ErrRecord -Property $Property
                $LogErrorRecordMsg = $ErrRecord | Select-Object -Property $SelectedProperties
            }

            ## Error Invocation Information
            If ($GetErrorInvocation)
            {
                If ($ErrRecord.InvocationInfo)
                {
                    [string[]]$SelectedProperties = &$SelectProperty -InputObject $ErrRecord.InvocationInfo -Property $Property
                    $LogErrorInvocationMsg = $ErrRecord.InvocationInfo | Select-Object -Property $SelectedProperties
                }
            }

            ## Capture Error Exception
            If ($GetErrorException)
            {
                If ($ErrRecord.Exception)
                {
                    [string[]]$SelectedProperties = &$SelectProperty -InputObject $ErrRecord.Exception -Property $Property
                    $LogErrorExceptionMsg = $ErrRecord.Exception | Select-Object -Property $SelectedProperties
                }
            }

            ## Display properties in the correct order
            If ($Property -eq '*')
            {
                # If all properties were chosen for display, then arrange them in the order
                #  the error object displays them by default.
                If ($LogErrorRecordMsg)     {[array]$LogErrorMessageTmp += $LogErrorRecordMsg    }
                If ($LogErrorInvocationMsg) {[array]$LogErrorMessageTmp += $LogErrorInvocationMsg}
                If ($LogErrorExceptionMsg)  {[array]$LogErrorMessageTmp += $LogErrorExceptionMsg }
            }
            Else
            {
                # Display selected properties in our custom order
                If ($LogErrorExceptionMsg)  {[array]$LogErrorMessageTmp += $LogErrorExceptionMsg }
                If ($LogErrorRecordMsg)     {[array]$LogErrorMessageTmp += $LogErrorRecordMsg    }
                If ($LogErrorInvocationMsg) {[array]$LogErrorMessageTmp += $LogErrorInvocationMsg}
            }

            If ($LogErrorMessageTmp)
            {
                $LogErrorMessage  = 'Error Record:'
                $LogErrorMessage += "`n-------------"
                $LogErrorMsg      = $LogErrorMessageTmp | Format-List | Out-String
                $LogErrorMessage += $LogErrorMsg
            }

            ## Capture Error Inner Exception(s)
            If ($GetErrorInnerException)
            {
                If ($ErrRecord.Exception -and $ErrRecord.Exception.InnerException)
                {
                    $LogInnerMessage  = 'Error Inner Exception(s):'
                    $LogInnerMessage += "`n-------------------------"

                    $ErrorInnerException = $ErrRecord.Exception.InnerException
                    $Count = 0

                    While ($ErrorInnerException)
                    {
                        $InnerExceptionSeperator = '~' * 40

                        [string[]]$SelectedProperties = &$SelectProperty -InputObject $ErrorInnerException -Property $Property
                        $LogErrorInnerExceptionMsg = $ErrorInnerException | Select-Object -Property $SelectedProperties | Format-List | Out-String

                        If ($Count -gt 0)
                        {
                            $LogInnerMessage += $InnerExceptionSeperator
                        }
                        $LogInnerMessage += $LogErrorInnerExceptionMsg

                        $Count++
                        $ErrorInnerException = $ErrorInnerException.InnerException
                    }
                }
            }

            If ($LogErrorMessage) { $Output += $LogErrorMessage }
            If ($LogInnerMessage) { $Output += $LogInnerMessage }

            Write-Output $Output

            If (Test-Path -Path 'variable:Output'            ) { Clear-Variable -Name Output             }
            If (Test-Path -Path 'variable:LogErrorMessage'   ) { Clear-Variable -Name LogErrorMessage    }
            If (Test-Path -Path 'variable:LogInnerMessage'   ) { Clear-Variable -Name LogInnerMessage    }
            If (Test-Path -Path 'variable:LogErrorMessageTmp') { Clear-Variable -Name LogErrorMessageTmp }
        }
    }
    End {}
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-09-11T07:27:11.033

这段代码：

```
try {
    ...
}
catch {
    Write-Host $_.Exception.Message -Foreground "Red"
    Write-Host $_.ScriptStackTrace -Foreground "DarkGray"
    exit 1
} 
```

将以以下格式回显错误：

```
No match was found for the specified search criteria and module names 'psake'.
at Get-InstalledModule<Process>, ...\PSModule.psm1: line 9251
at Import-ModuleThirdparty, ...\Import-ModuleThirdparty.psm1: line 3
at <ScriptBlock>, ...\index.ps1: line 13 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-07-13T15:12:31.943

这是一种方法：[跟踪脚本堆栈](http://jtruher3.wordpress.com/2007/07/15/tracing-the-script-stack/)

它的核心是这段代码：

```
    1..100 | %{ $inv = &{ gv -sc $_ myinvocation }

```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-07-25T14:31:20.713

我刚刚想通了。$_ 是在 catch 块中捕获的异常。

```
$errorString= $_ | Out-String 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-12-28T23:30:17.650

您还可以更改错误对象的默认格式以包含堆栈跟踪。基本上，通过从 $PSHOME\PowerShellCore.format.ps1xml 复制 System.Management.Automation.ErrorRecord 的块并添加您自己的添加跟踪的元素来制作您的格式文件。然后使用 Update-FormatData 加载它。有关更多详细信息，我刚刚写了一篇关于它的博客文章：[https ://blogs.msdn.microsoft.com/sergey_babkins_blog/2016/12/28/getting-a-stack-trace-in-powershell/](https://blogs.msdn.microsoft.com/sergey_babkins_blog/2016/12/28/getting-a-stack-trace-in-powershell/)

哦，还有一件事：这不会自动传播到远程会话中。对象在远程端被格式化为字符串。对于远程会话中的堆栈跟踪，您必须将这个文件上传到那里并再次在那里调用 Update-FormatData。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-08-07T16:00:11.487

偶然发现了这个寻找内置解决方案。我将采用简单的解决方案。只需在使用任何 powershell 之前添加跟踪块。这将确保显示调用堆栈。不利的一面是堆栈将在错误消息之前显示。

```
Trace {
   $_.ScriptStackTrace
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-07-21T08:39:46.703

也许我误解了一些东西，但我的问题是我没有看到内部异常的 powershell 脚本堆栈跟踪。

最后，我在 $Global:Error 中搜索异常的 Error Eecord 对象以检索脚本堆栈跟踪。

```
<#
.SYNOPSIS
   Expands all inner exceptions and provides Script Stack Traces where available by mapping Exceptions to ErrorRecords

.NOTES
   Aggregate exceptions aren't full supported, and their child exceptions won't be traversed like regular inner exceptions

#>
function Get-InnerErrors ([Parameter(ValueFrompipeline)] $ErrorObject=$Global:Error[0])
{
   # Get the first exception object from the input error
   $ex = $null
   if( $ErrorObject -is [System.Management.Automation.ErrorRecord] ){
       $ex = $ErrorObject.Exception 
   }
   elseif( $ErrorObject -is [System.Exception] ){
       $ex = $ErrorObject
   } 
   else
   {
       throw "Unexpected error type for Get-InnerErrors: $($ErrorObject.GetType()):`n $ErrorObject"
   }

   Write-Debug "Walking inner exceptions from exception"
   for ($i = 0; $ex; $i++, ($ex = $ex.InnerException))
   {  
       $ErrorRecord = $null

       if( $ex -is [System.Management.Automation.IContainsErrorRecord] ){ 

           Write-Debug "Inner Exception $i : Skipping search for ErrorRecord in `$Global:Error, exception type implements IContainsErrorRecord" 
           $ErrorRecord = ([System.Management.Automation.IContainsErrorRecord]$ex).ErrorRecord
       }
       else {

           # Find ErrorRecord for exception by mapping exception to ErrorRecrods in $Global:Error

           ForEach( $err in $Global:Error ){# Need to use Global scope when referring from a module
               if( $err -is [System.Management.Automation.ErrorRecord] ){
                  if( $err.Exception -eq $ex ){
                       $ErrorRecord = $err 
                       Write-Debug "Inner Exception $i : Found ErrorRecord in `$Global:Error" 
                       break
                   }
               } 
               elseif( $err -is [System.Management.Automation.IContainsErrorRecord] ) {
                   if( $err -eq $ex -or $err.ErrorRecord.Exception -eq $ex ){
                       $ErrorRecord = $err.ErrorRecord
                       Write-Debug "Inner Exception $i : Found ErrorRecord in `$Global:Error" 
                       break
                   }
               } 
               else {
                   Write-Warning "Unexpected type in `$Global:Error[]. Expected `$Global:Error to always be an ErrorRecrod OR exception implementing IContainsErrorRecord but found type: $($err.GetType())"
               }
           }
       }

       if( -not($ErrorRecord) ){
           Write-Debug "Inner Exception $i : No ErrorRecord could be found for exception of type: $($ex.GetType())" 
       }

       # Return details as custom object

       [PSCustomObject] @{
           ExceptionDepth      = $i
           Message             = $ex.Message
           ScriptStackTrace    = $ErrorRecord.ScriptStackTrace  # Note ErrorRecord will be null if exception was not from Powershell
           ExceptionType       = $ex.GetType().FullName
           ExceptionStackTrace = $ex.StackTrace
       }
   }
} 
```

示例用法：

```
function Test-SqlConnection
{
    $ConnectionString = "ThisConnectionStringWillFail"
    try{
        $sqlConnection = New-Object System.Data.SqlClient.SqlConnection $ConnectionString;
        $sqlConnection.Open();
    }
    catch
    {
        throw [System.Exception]::new("Sql connection failed with connection string: '$ConnectionString'", $_.Exception)
    }
    finally
    {
        if($sqlConnection){
            $sqlConnection.Close();
        }
    }
}

try{
    Test-SqlConnection
}
catch {
    Get-InnerErrors $_
} 
```

示例输出：

```
 ExceptionDepth      : 0
Message             : Sql connection failed with connection string: 'ThisConnectionStringWillFail'
ScriptStackTrace    : at Test-SqlConnection, <No file>: line 11
                      at <ScriptBlock>, <No file>: line 23
ExceptionType       : System.Exception
ExceptionStackTrace : 

ExceptionDepth      : 1
Message             : Exception calling ".ctor" with "1" argument(s): "Format of the initialization string does not conform to specification starting at index 0."
ScriptStackTrace    : 
ExceptionType       : System.Management.Automation.MethodInvocationException
ExceptionStackTrace :    at System.Management.Automation.DotNetAdapter.AuxiliaryConstructorInvoke(MethodInformation methodInformation, Object[] arguments, Object[] originalArguments)
                         at System.Management.Automation.DotNetAdapter.ConstructorInvokeDotNet(Type type, ConstructorInfo[] constructors, Object[] arguments)
                         at Microsoft.PowerShell.Commands.NewObjectCommand.CallConstructor(Type type, ConstructorInfo[] constructors, Object[] args)

ExceptionDepth      : 2
Message             : Format of the initialization string does not conform to specification starting at index 0.
ScriptStackTrace    : 
ExceptionType       : System.ArgumentException
ExceptionStackTrace :    at System.Data.Common.DbConnectionOptions.GetKeyValuePair(String connectionString, Int32 currentPosition, StringBuilder buffer, Boolean useOdbcRules, String& keyname, String& 
                      keyvalue)
                         at System.Data.Common.DbConnectionOptions.ParseInternal(Hashtable parsetable, String connectionString, Boolean buildChain, Hashtable synonyms, Boolean firstKey)
                         at System.Data.Common.DbConnectionOptions..ctor(String connectionString, Hashtable synonyms, Boolean useOdbcRules)
                         at System.Data.SqlClient.SqlConnectionString..ctor(String connectionString)
                         at System.Data.SqlClient.SqlConnectionFactory.CreateConnectionOptions(String connectionString, DbConnectionOptions previous)
                         at System.Data.ProviderBase.DbConnectionFactory.GetConnectionPoolGroup(DbConnectionPoolKey key, DbConnectionPoolGroupOptions poolOptions, DbConnectionOptions& userConnectionOptions)
                         at System.Data.SqlClient.SqlConnection.ConnectionString_Set(DbConnectionPoolKey key)
                         at System.Data.SqlClient.SqlConnection.set_ConnectionString(String value)
                         at System.Data.SqlClient.SqlConnection..ctor(String connectionString, SqlCredential credential) 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-03-09T11:31:02.063

在某些情况下，PowerShell 似乎不保留回溯，例如调用方法或使用`.Invoke()`. 为此，`Set-PSDebug -Trace 2`可能会派上用场。它将打印正在运行的脚本的每一行。

尝试在 (1) 和 (2) 上翻转 # 并运行`WrapStackTraceLog({ function f{ 1/0 } ; & f }) # let's divide by zero`

```
Function WrapStackTraceLog($func) {
    try {
        # return $func.Invoke($args)  # (1)
        return (& $func $args)  # (2)
    } catch {
        Write-Host ('=' * 70)
        Write-Host $_.Exception.Message
        Write-Host ('-' * 70)
        Write-Host $_.ScriptStackTrace
        Write-Host ('-' * 70)
        Write-Host "$StackTrace"
        Write-Host ('=' * 70)
    }
} 
```

分支 (1) 异常捕获：

```
Exception calling "Invoke" with "1" argument(s): "Attempted to divide by zero." 
```

分支 (2) 提供更多信息：

```
at f, <No file>: line 1
at <ScriptBlock>, <No file>: line 1
at global:WrapStackTraceLog, <No file>: line 4
at <ScriptBlock>, <No file>: line 1 
```

但是，您仍然可以通过跟踪分支 (1) 来跟踪您的调用：

```
DEBUG:     ! CALL function 'f'
DEBUG:    1+ WrapStackTraceLog({ function f{  >>>> 1/0 } ; & f })
DEBUG:    6+          >>>> Write-Host ('=' * 70)
======================================================================
DEBUG:    7+          >>>> Write-Host $_.Exception.Message
Exception calling "Invoke" with "1" argument(s): "Attempted to divide by zero." 
```

# perl - 是否有使用 HTML::Template 而不是 TT 的 Catalyst 教程？

> ID：795759
> 
> 赞同：7
> 
> 时间：2009-04-28T00:10:46.650
> 
> 标签：perl, catalyst, template-toolkit, perl-html-template

我一直在浏览一些 Catalyst 教程，它们都倾向于使用 Template Toolkit 而不是 HTML::Template。

我在 HTML::Template 上花了很多时间，我喜欢它，虽然我可以看到 TT 的强大功能，但我不知道它，我觉得我会同时学习两件事；另外，因为它在模板中进行处理，所以我不确定我的 HTML::Template`$template->param(foo => \$bar);`代码会去哪里！

任何人都知道使用 HTML::Template 的好教程/代码示例吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-28T00:24:24.930

当然，关于[Catalyst::View::HTML::Template](http://search.cpan.org/~mramberg/Catalyst-View-HTML-Template-0.02/lib/Catalyst/View/HTML/Template.pm)的文档有点稀疏，它本身不是教程，但它确实涵盖了配置基本 HTML::Template 设置（`die_on_bad_params`等）并声明“*模板参数是从 $c->stash* "的内容设置的，在我看来它应该足以让你开始。

# language-agnostic - 在被证明之前是真的还是在被证明之前是假的？

> ID：795760
> 
> 赞同：2
> 
> 时间：2009-04-28T00:13:21.853
> 
> 标签：language-agnostic, boolean

我注意到我的编码有些未定义。假设我们有一个二维数组、一个矩阵或一个表，我们正在查看它以检查每个行或嵌套维度的属性是否为真。

假设我有一个布尔标志，用于检查属性是真还是假。我的选择是：

1.  将其初始化为 true 并检查每个单元格，直到证明为 false。在代码完全执行之前，这会给它一个错误的名称。
2.  从 false 开始并检查每一行，直到证明为 true。只有当所有行都为真时，数据才会正确。没有柜台的最干净的方法是什么？

我总是不假思索地做了1，但今天它让我想知道。2呢？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-28T00:22:08.727

恕我直言，取决于哪个先将您从循环中转储。

例如，在 OR 情况下，我默认为 false，一旦你得到一个 TRUE，就返回结果，否则在循环失败时返回默认值。

对于 AND 情况，我会做相反的事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-28T00:30:45.463

它们实际上都等同于同一件事，并且由于您说“检查每个行或嵌套维度的属性是否为真”，我相信第一种方法更容易阅读并且可能稍微快一些。

在代码完全执行之前，您不应该尝试读取标志的值，因为检查还没有完成。如果您正在运行异步代码，则应防止在不稳定时访问该值。

在执行代码之前，这两种方法都“给出了错误的名称”。1 给出假阳性，2 给出假阴性。我不确定你这样说是想避免什么——如果你能在完全运行你的代码之前获得“正确”的值，那么你一开始就没有运行你的代码。

* * *

如何在没有计数器的情况下实现每个（如果您的语言没有`foreach`语法，请使用适当的`enumerator->next`循环语法）：

1：

```
bool flag = true;

foreach(item in array)
{
    if(!check(item))
    {
        flag = false;
        break;
    }
} 
```

2：

```
bool flag = false;
foreach(item in array)
{
    if(!check(item))
    {
        break;
    } 
    else if(item.IsLast())
    {
        flag = true;
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-28T00:34:58.697

选择第一个选项。算法总是有前置条件、后置条件和不变量。如果您的不变量是“如果 0-currentN 中的所有行都具有正属性，则 bool x 为真”，那么一切都很好。

不要仅仅为了使整个程序状态在每行迭代中有效而使您的算法更复杂。重构方法，提取它，并使用您的语言机制（Java：）使其“原子化” `synchronized`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-28T00:30:25.480

就个人而言，我只是将整个循环放入一个名为 isPropertyAlwaysTrue(property, array[][]) 的有点可重用的方法/函数中，如果发现它发现不正确的情况，则直接返回 false。

顺便说一句，逻辑倒置不会让你更快地离开那里。例如，如果您想要第一个不正确的情况，说 areAnyFalse 或 areAllTrue 将有一个反转的输出，但必须测试完全相同的情况。

areAnyTrue 和 areAllFalse 也是这种情况——完全相同算法的不同词（一旦找到真值就返回）。

您无法将 areAnyFalse 与 areAnyTrue 进行比较，因为它们正在测试完全不同的情况。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-28T00:21:10.367

使属性名称类似于`isThisTrue`. 然后它会回答“是”或“否”，但它总是有意义的。

在 Ruby 和 Scheme 中，您可以在名称中使用问号：`isThisTrue?`. 在许多其他语言中，名称上都有一个将“p”表示为“谓词”的约定——`null-p`用于在 LISP 中返回真或假的测试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-28T00:27:30.290

我同意 Will Hartung 的观点。

如果您担心（1），那么只需为您的布尔值选择一个更好的名称。IsNotSomething 而不是 IsSomething。

# javascript - 如何使用 javascript 获取访问的链接 css 样式

> ID：795761
> 
> 赞同：0
> 
> 时间：2009-04-28T00:13:45.567
> 
> 标签：javascript, css, hyperlink, stylesheet

我想使用 javascript 来设置一个元素的样式，使其看起来像一个 :visited 链接，而无需为访问的链接定义我自己的样式。如何访问浏览器对已访问链接的默认样式，以便定义可以应用于元素的匹配样式（例如，通过应用类名）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T00:39:30.247

您可以尝试在 hidden 中打开页面`<iframe />`。除了为浏览器构建扩展来做你想做的事情之外，我没有看到其他解决方案。我也不知道你是不是在这方面付出了太多的努力。

它可以像为您的应用程序建立一些规则一样简单。

例如，**新链接**与*访问链接*。差异很明显，也不取决于颜色。

# c# - 关于匿名方法签名和事件处理程序的简单问题

> ID：795763
> 
> 赞同：2
> 
> 时间：2009-04-28T00:14:00.480
> 
> 标签：c#

所以，可能是一个简单的问题，答案很简单，但我不知道它是什么，我很好奇:)。为什么编译器允许我做这样的事情？

```
button1.Click += delegate { someFlag = true; }; 
```

（我只能使用.NET 2.0，所以没有lamdas，但概念相同）

但是我不能这样做：

```
button1.Click += MyDelegateMethod

// snip

// compile error, signature does not match the signature of System.EventHandler.
private void MyDelegateMethod( )
{ 

} 
```

我希望我必须将我的匿名方法声明为：

```
delegate(object sender, EventArgs e) { someFlag = true; }; 
```

我不明白为什么匿名方法可以，但是当我编写完整的方法本身时就不行了。任何人？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-28T00:17:18.037

编译器可以确定您的匿名委托与按钮单击委托的类型相同，但您不需要使用事件参数。

但是，当您指定实际方法时，编译器会“看到”您指向具有错误签名的委托，因此不会编译。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T00:17:43.123

如您所见，您正在使用`delegate { ... }`而不是`delegate() { ... }`允许 C# 为您完成工作。

# ruby-on-rails - 如何使用 gmail SMTP 设置 restful_authentication 电子邮件激活？

> ID：795777
> 
> 赞同：0
> 
> 时间：2009-04-28T00:18:13.650
> 
> 标签：ruby-on-rails, gmail, restful-authentication

我已经从 technoweenie 安装了 restful_authentcation 并激活了，所以我看到了生成的 UserMailer < ActionMailer::Base。

但是，说明不包括如何设置它以使用 Google SMTP。

我**猜**environment/development.rb 需要有 SMTP 设置，但仍然不确定谷歌（通过谷歌应用程序）都是 TLS。

有人使用restful_authentication设置激活吗？

我目前将以下内容放入environments.rb：

```
 ActionMailer::Base.smtp_settings = {
     :enable_starttls_auto => true,
     :address => "smtp.gmail.com",
     :port => "587",
     :domain => "mydomain.com",
     :authentication => :plain,
     :user_name => "xxx@mydomain.com",
     :password => "mypassword"

} 
```

谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T01:16:28.707

我从未使用过来自 ruby​​ 的 SMTP（我有来自 python 的），但这*看起来*是正确的。您拥有正确的域和端口（实际上，支持多个端口，但这是其中之一），并且您正在使用谷歌使用的 starttls 和 AUTH PLAIN。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T08:26:15.870

据我所知，ActionMailer 没有开箱即用的 TLS (2.3.2)。几个月前，我遇到了同样的问题，在一个日文页面上找到了一些代码并将其集成。看来代码现在已经被打包到一个插件中（有英文文档是的！）。这不完全是我正在使用的，但它宣传相同的效果。

所以添加这个插件：http: [//github.com/openrain/action_mailer_tls/tree/master](http://github.com/openrain/action_mailer_tls/tree/master)

在 environment/development.rb 或 environements.rb 你需要这样的东西：

```
ActionMailer::Base.smtp_settings = {
  :address => "smtp.gmail.com",
  :port => 587,
  :domain => "yourdomain.com",
  :user_name => "first.last@gmail.com",
  :password => "passwd",
  :authentication => :plain
} 
```

我看到 :enable_starttls_auto => true 现在在文档中，但不是在我开始的时候。这至少对我有用......

编辑：由于某种原因，如果您关注该链接，该链接将不起作用，但是在地址栏中复制粘贴它并且它是实时的...

# ruby - 我希望在编写 Ruby 时能在 VIM 中做的事情

> ID：795784
> 
> 赞同：-1
> 
> 时间：2009-04-28T00:24:13.950
> 
> 标签：ruby, vim

我面临一些问题，我在论坛中四处寻找，没有找到任何讨论的解决方案。对不起，如果这些问题已经解决了。

*   有什么办法可以在 80 个字符后使 VIM 换行。我不希望文本环绕，而是创建一个新行。我希望它能打断完整的最后一句话。因此，代替上一行中的 *fo*和下一行中的*o ，它可以在下一行中与**foo* 中断吗？

*   当我结束我的评论并按回车键时，我在新行中得到一个 # 。这很酷，但是当我删除 # 并想开始一行代码时，我没有在那里突出显示语法。它仍然认为我输入的是评论。这是一个错误还是我做错了？

*   还有一件事是我已经将 shiftwidth 设置为 4。但是当我按 Ctrl+S 保存文档时，光标会跳转到句子的开头。然后我需要手动回到我原来的位置来开始代码。有没有办法解决这个问题？

谢谢您阅读此篇。我是 Ruby 和 Vim 的新手。我希望你们帮助我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-28T00:35:47.557

Ctrl-S ? 这是我不知道的。在 Vim/Gvim 中，文件通常由

```
:w filename.ext (if none's been given yet) 
```

或者

```
:saveas filename.ext 
```

（对于所有这些命令，请尝试 ":help :w" 或...相同的原则）。

我不知道评论部分，因为我不做 Ruby，但是让自己成为一个不错的评论器插件（我想我使用[LineCommenter](http://www.vim.org/scripts/script.php?script_id=2428)）对你来说是非常明智的 - 简化了评论。只需写下注释，然后添加#'s（将其设置为在正常和可视模式下工作；它工作得很好）。

至于打破文本部分，可以通过添加来解决

```
:set tw=80 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-30T05:21:16.527

"wrapscan" 是将整个单词换行到下一行的 vim 功能；它可能不会在您的配置中默认设置 - 可能不是。因此，除了 **:set tw=78**您可能还想尝试以下方法之一：

```
:set wrapscan
:set wrap     <- just a shorter version
:set nowrap   <- to turn the wordwrap feature back off 
```

顺便说一句，与其将文本宽度 (tw) 设置为一定数量的字符（小于您的窗口），不如设置您希望在窗口右侧留下的边距，如下所示：

```
:set wrapmargin=1 
```

如果 wrapmargin 设置为 0 以外的值，则应该忽略 textwidth。

我会使用 ":w" 保存并继续编辑（如果是新文件，则使用 ":w 文件名"），完成后使用 "ZZ" 或 ":wq" 保存并退出 - 这些都不会移动光标位置。

我不确定你的“#”延续是从哪里来的，但如果它们还没有，我也会确保设置它们（你可以通过输入“ **:set** ”来检查设置了哪些变量，没有其他选项):

```
:set syntax=ruby
:set filetype=ruby
:syntax enable 
```

如果您从一个空文档开始，然后在其中添加了“#!/usr/bin/ruby”，vim 不会注意到您正在编辑 ruby​​，直到您保存并退出并重新打开文件。在其他情况下，语法着色不是很亮或需要轻推，但是是的，这对我来说听起来像是一个错误。

# visual-studio - Visual Studio 项目模板多个项目类型

> ID：795802
> 
> 赞同：2
> 
> 时间：2009-04-28T00:34:05.593
> 
> 标签：visual-studio, templates

我有一个项目模板，我希望它出现在“Visual C#”及其子类型“Test”下。我可以通过将它分别放在 \Visual Studio 2008\Templates\ProjectTemplates\Visual C# 和 \Visual Studio 2008\Templates\ProjectTemplates\Visual C#\Test 中，让它出现在一个而不是另一个中。

我尝试在 vstemplate 文件中设置以下属性

```
<ProjectType>CSharp</ProjectType>
<ProjectSubType>Test</ProjectSubType> 
```

但这似乎不起作用。

我还查看了默认模板的想法，但找不到任何东西。

有没有办法做到这一点而不在两个位置都放一个副本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-28T00:47:16.077

刚刚找到 NumberOfParentCategoriesToRollUp 标签。通过说

```
<NumberOfParentCategoriesToRollUp>1</NumberOfParentCategoriesToRollUp> 
```

它也将其放在父级中（模板位于 Test 文件夹中）。该描述声称它不适用于用户模板，但它适用于我。

# sql-server - 如何以编程方式读取 SQL Server 报告历史记录？

> ID：795804
> 
> 赞同：4
> 
> 时间：2009-04-28T00:34:39.383
> 
> 标签：sql-server, reporting-services, ssrs-2008

SQL Reporting Services 问题 - 针对 SQL Server 2008。

鉴于 SQL Server Reporting Services 具有可用于调度 SQL 报表运行的调度程序，是否有人知道以编程方式（通过 C#）从报表服务器读取报表历史记录的方法（然后可能检索报表的结果)?

因此，经过更多的挖掘，看起来我需要为报表服务器生成一个 WSDL，然后使用 ReportingService 对象访问信息——以前有没有人做过（2008 年）并且可以提供一些指针？

注意：看起来（根据 SQL 2008 在线书籍）SQL 2008 的 WSDL 地址是：

```
http://server/reportserver/ReportService2005.asmx?wsdl 
```

如果我能做到这一点，我将发布一个包含实现它的基本步骤的答案:) 这有点令人困惑，因为文档是 SQL 2000 和 SQL 2005 参考的混合体！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T06:30:05.147

好的，所以我实际上已经想出了如何完成这个看似不可能的任务。

在开始之前，我只想说，如果您正在使用 SQL Server Reporting Services 2008 (SSRS 08) 并且*不得不*（即您别无选择）使用基本身份验证之类的东西，那么您只会发现基于 WCF 的服务存根和 IIS。稍后我将在博客中介绍配置。

简短的回答如下：

*   连接（例如 new ReportingService2005() 或 ReportingService2005SoapClient()）

注意：使用旧的（WCF 之前的）ASMX 服务更容易，但使用新的 CF 版本并非不可能。身份验证需要一些配置。版本之间也有一些细微的语法变化。

*   找到您要查找的报告历史记录，例如 ReportHistorySnapshot[] history = reportServer.ListReportHistory(@"/Reports/MyHandyReport");
*   从您想要的任何快照中获取 HistoryID（从 ListHistoryReport 返回）
*   现在，使用 ReportViewer 来呈现历史报告，就像您处理任何其他报告一样，例如：

    ReportViewer rv = new ReportViewer();
    rv.ProcessingMode = ProcessingMode.Remote;
    rv.ServerReport.ReportServerUrl = new Uri(@" [http://localhost/reportserver](http://localhost/reportserver) ");
    rv.ServerReport.ReportPath = @"/Reports/MyHandyReport";
    **rv.ServerReport.HistoryId = historyId;**
    //...snip
    byte[] bytes = rv.ServerReport.Render("Excel", null, out mimeType, out encoding, out extension, out streamids, out warnings);

注意：您也可以将第二个 WCF Web 服务 (ReportExecution2005.asmx?wsdl) 用于报告执行

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T00:52:01.790

那么它有[肥皂](http://support.microsoft.com/kb/875447)和可扩展性API，也许它们可以使用？

# ms-access - F# 和 ADO.NET 连接到 Access 2007

> ID：795810
> 
> 赞同：1
> 
> 时间：2009-04-28T00:37:08.537
> 
> 标签：ms-access, ado.net, f#

我对 F# 非常陌生，我试图找到使用 System.Data.OleDb 连接到 Access 2007 的最简单方法。我已经用 C# 做到了这一点，但我不知道如何将语法转换为 F#。以下是我目前所知道的：

```
#light
open System.Windows.Forms
open System.Data.OleDb
open System.Data

let ADOCon = new OleDbConnection()
let DTab = new DataTable()

ADOCon.ConnectionString = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\Users\...mdb" 
```

我知道连接字符串的语法是错误的，我不知道如何添加 OleDataAdapter 和 OleCommandBuilder。有谁知道从#light 到打开连接的简单示例？先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T01:48:27.490

这不是 F# 做事的方式，但这很有效......

```
open System.Data  
open System.Data.OleDb

let cmd = new OleDbCommand( "SELECT * FROM TABLE1" );
let conn = new OleDbConnection( @"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\Temp\Database1.mdb;Persist Security Info=False;" )

conn.Open();
cmd.Connection <- conn;
  using (cmd.ExecuteReader()) 
    (fun reader ->
      if (reader.HasRows) then
        (
          printfn "Queried: %s" cmd.CommandText
          while (reader.Read()) do
            (
              let id = reader.GetInt32(0)
              let tmp = reader.GetString(1)

              printfn "%d %s" id tmp
            )
          done
        )
      else (printfn "Empty result")
      )

conn.Close();
;; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T01:15:51.873

如果您显示相应的 C#，它可能会有所帮助。

假设您试图在最后一行分配一个属性，那么您需要“<-”：

```
ADOCon.ConnectionString <- "yadda" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T03:45:59.703

我终于编译了一些代码来从 winform 中读取 F# 中的 Access 2007 Db：

```
open System.Data.OleDb
open System.Data

//Create winform//
let frmMain = new Form()

//Connect to Access Db//
let ADOCon = new OleDbConnection(@"Provider=Microsoft.Jet.OLEDB.4.0;
  Data Source=C:\Users\...\Desktop\FSharpDb.mdb")

let DAdapter = new OleDbDataAdapter("Select * from Names_Table", ADOCon)

let DTable = new DataTable()
DAdapter.Fill(DTable)|>ignore
let view = new DataGridView()
do view.DataSource <- DTable

let ConnectionString = 
    ADOCon.Open()

frmMain.Controls.Add(view)

//Run main form on start up
Application.Run(frmMain) 
```

感谢所有帮助过的人！

# web-services - 基于 Web 服务的动态查询

> ID：795811
> 
> 赞同：0
> 
> 时间：2009-04-28T00:38:00.547
> 
> 标签：web-services

有谁知道如何通过 Web 服务实现动态查询？例如，以 HQL 为例，我想提交一个字符串，例如“Select Person.* from Person”，并返回一个包含 Person 肥皂对象数组的肥皂响应。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T01:05:36.627

这并不能真正回答您的问题，但是从 Web 服务执行动态查询是危险的。如果您的服务直接执行查询，您的客户端可能会发送删除/更新/插入/删除表/等。并弄乱你的数据库。

我建议实现更具体的服务方法，这些方法接受特定的参数并返回类型安全的对象或集合。

# python - Google AppEngine：如何计算数据库的条目超过 1000 个？

> ID：795817
> 
> 赞同：12
> 
> 时间：2009-04-28T00:44:43.620
> 
> 标签：python, google-app-engine, count

**重复** [“如何在谷歌应用引擎的数据存储模型中获取行数？”](https://stackoverflow.com/questions/751124/how-does-one-get-a-count-of-rows-in-a-datastore-model-in-google-appengine)

* * *

我想知道我有多少用户。以前，我使用以下代码实现了这一点：

```
users = UserStore.all()
user_count = users.count() 
```

但现在我有超过 1,000 个用户，并且此方法继续返回 1,000 个。

是否有一种有效的编程方式来了解我有多少用户？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-28T07:15:18.250

它确实是重复的，另一篇文章描述了理论上如何做到这一点，但我想强调的是，你真的不应该以这种方式进行计数。原因是 BigTable 的分布式特性对聚合确实很不利。您可能想要做的是向该实体添加一个事务计数器，如果有很多事务，一个分片计数器。请参阅：[http ://code.google.com/appengine/articles/sharding_counters.html](http://code.google.com/appengine/articles/sharding_counters.html)

更新：由于 1.3.1 游标使这样的事情变得更容易：[http ://code.google.com/appengine/docs/python/datastore/queriesandindexes.html#Query_Cursors](http://code.google.com/appengine/docs/python/datastore/queriesandindexes.html#Query_Cursors)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T01:00:12.410

[在此处](http://google-appengine.googlegroups.com/web/efficient_paging_using_key_instead_of_a_dedicated_unique_property.txt)使用这些示例的分页。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-08-23T14:58:22.347

从 SDK 版本[1.3.6](http://googleappengine.blogspot.com/2010/08/multi-tenancy-support-high-performance_17.html)开始，计数功能的 1000 限制已被移除。因此，对 count 函数的调用现在将返回确切数量的实体，即使有超过 1000 个。唯一的限制是，如果您有这么多实体，在请求超时之前 count 函数不会返回。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-23T12:11:44.217

我已经写了这个方法来计算一个查询，但是尼克约翰逊怎么说可能是个坏主意......

```
def query_counter (q, cursor=None, limit=500):
  if cursor:
      q.with_cursor (cursor)
  count = q.count (limit=limit)
  if count == limit:
      return count + query_counter (q, q.cursor (), limit=limit)
  return count 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-11T17:32:29.080

对于 Python GAE SDK，可以增加 count 方法的参数“limit”： [https ://developers.google.com/appengine/docs/python/datastore/queryclass#Query_count](https://developers.google.com/appengine/docs/python/datastore/queryclass#Query_count)

# matlab - 如何在 MATLAB 中设置函数参数的默认值？

> ID：795823
> 
> 赞同：131
> 
> 时间：2009-04-28T00:46:13.990
> 
> 标签：matlab, arguments, default

MATLAB中是否可以有默认参数？

例如，这里：

```
function wave(a, b, n, k, T, f, flag, fTrue=inline('0')) 
```

我希望真正的解决方案是波函数的可选参数。如果可能，这样做的正确方法是什么？

目前，我正在尝试上面发布的内容，我得到：

```
??? Error: File: wave.m Line: 1 Column: 37
The expression to the left of the equals sign is not a valid target for an assignment. 
```

* * *

## 回答 #1

> 赞同：157
> 
> 时间：2009-04-28T00:55:17.977

没有像您尝试过的那样直接执行此操作的方法。

通常的方法是使用“可变参数”并检查参数的数量。就像是：

```
function f(arg1, arg2, arg3)

  if nargin < 3
    arg3 =   'some default'
  end

end 
```

您可以使用`isempty`等做一些更有趣的事情，并且您可能想查看 MATLAB central 以获得一些捆绑这些东西的包。

您可能会看一下`varargin`,`nargchk`等。它们是这类事情的有用功能。*可变参数*允许您保留可变数量的最终参数，但这并不能解决部分/全部参数的默认值问题。

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2009-05-02T12:37:40.127

我已经使用该[`inputParser`](http://www.mathworks.com/help/matlab/ref/inputparserclass.html)对象来处理设置默认选项。MATLAB 不会接受您在问题中指定的类似 Python 的格式，但您应该能够像这样调用函数：

```
wave(a, b, n, k, T, f, flag, 'fTrue', inline('0')) 
```

像这样定义`wave`函数后：

```
function wave(a, b, n, k, T, f, flag, varargin)

    i_p = inputParser;
    i_p.FunctionName = 'WAVE';

    i_p.addRequired('a', @isnumeric);
    i_p.addRequired('b', @isnumeric);
    i_p.addRequired('n', @isnumeric);
    i_p.addRequired('k', @isnumeric);
    i_p.addRequired('T', @isnumeric);
    i_p.addRequired('f', @isnumeric);
    i_p.addRequired('flag', @isnumeric);
    i_p.addOptional('ftrue', inline('0'), 1);

    i_p.parse(a, b, n, k, T, f, flag, varargin{:}); 
```

现在传递给函数的值可以通过`i_p.Results`. 另外，我不确定如何验证传入的参数`ftrue`实际上是一个`inline`函数，所以我将验证器留空。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2011-02-20T15:21:27.967

另一个稍微不那么老套的方法是

```
function output = fun(input)
   if ~exist('input','var'), input='BlahBlahBlah'; end
   ...
end 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-04-28T11:56:57.280

是的，拥有按照您所写的那样做的能力可能真的很好。但这在 MATLAB 中是不可能的。我的许多允许参数默认值的实用程序往往在开始时使用显式检查来编写，如下所示：

```
if (nargin<3) or isempty(myParameterName)
  MyParameterName = defaultValue;
elseif (.... tests for non-validity of the value actually provided ...)
  error('The sky is falling!')
end 
```

好的，所以我通常会应用更好、更具描述性的错误消息。看到对空变量的检查允许用户传入一对空括号，`[]`作为将采用其默认值的变量的占位符。不过，作者仍必须提供代码以将该空参数替换为其默认值。

我的实用程序更复杂，有*许多*参数，所有参数都有默认参数，通常会使用属性/值对接口作为默认参数。在 MATLAB 中的句柄图形工具以及 optimset、odeset 等中可以看到这种基本范式。

作为使用这些属性/值对的一种方法，您需要了解*varargin*，作为向函数输入完全可变数量的参数的一种方式。我编写（并发布）了一个实用程序来处理此类属性/值对[parse_pv_pairs.m](http://www.mathworks.com/matlabcentral/fileexchange/9082)。它可以帮助您将属性/值对转换为 MATLAB 结构。它还使您能够为每个参数提供默认值。将笨重的参数列表转换为结构体是在 MATLAB 中传递它们的一种*非常好的方法。*

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-06-09T14:01:02.400

这是我使用“try”为函数设置默认值的简单方法：

```
function z = myfun (a, varargin)

%% Default values
b = 1;
c = 1;
d = 1;
e = 1;

try 
    b = varargin{1};
    c = varargin{2};
    d = varargin{3};
    e = varargin{4};
end

%% Calculation
z = a * b * c * d * e;
end 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-04-06T19:01:35.290

我很困惑没有人指出MATLAB 的开发人员之一 Loren 的[这篇博文。](http://blogs.mathworks.com/loren/2009/05/05/nice-way-to-set-function-defaults/)该方法基于`varargin`并避免了所有那些无休止和痛苦`if-then-else`或`switch`情况复杂的情况。当有*几个*默认值时，效果是*显着的*。这是链接博客中的一个示例：

```
function y = somefun2Alt(a, b, varargin)
% Some function that requires two inputs and has some optional inputs.

% Only want three optional inputs at most
numvarargs = length(varargin);
if numvarargs > 3
    error('myfuns:somefun2Alt:TooManyInputs', ...
        'requires at most three optional inputs');
end

% Set defaults for optional inputs
optargs = {eps 17 @magic};

% Now put these defaults into the valuesToUse cell array,
% and overwrite the ones specified in varargin.
optargs(1:numvarargs) = varargin;
% or ...
% [optargs{1:numvarargs}] = varargin{:};

% Place optional args in memorable variable names
[tol, mynum, func] = optargs{:}; 
```

如果您仍然不明白，请尝试阅读 Loren 的整个博客文章。我写了一篇后续[博客文章](https://web.archive.org/web/20160711181129/http://all3fox.github.io/blog/2014/06/17/matlab-function-default-arguments)，处理*缺少*的位置默认值。我的意思是你可以写这样的东西：

```
somefun2Alt(a, b, '', 42) 
```

并且仍然具有参数的默认`eps`值`tol`（当然还有`@magic`回调`func`）。Loren 的代码通过轻微但棘手的修改来实现这一点。

最后，只是这种方法的几个优点：

1.  即使有很多默认值，样板代码也不会变得很大（与`if-then-else`方法家族相反，每个新的默认值都会变得更长）
2.  所有默认设置都在一个地方。如果其中任何一项需要更改，您只需查看一个地方。

说实话，也有缺点。当您在 MATLAB shell 中键入函数并忘记其参数时，您会看到一个无用`varargin`的提示。为了解决这个问题，建议您编写一个有意义的使用条款。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-28T21:00:52.633

我发现[parseArgs](http://www.mathworks.com/matlabcentral/fileexchange/3448)函数非常有用。

**这是它的文档：**

用于解析的辅助函数`varargin`。使编写接受如下参数的函数变得容易：`subaxis(4,2,1,'spacing',0,'marginleft',.1,'H','pt',.1)`

`ArgStruct=parseArgs(varargin,ArgStruct[,FlagtypeParams[,Aliases]])`

*   `ArgStruct`是一个充满了具有默认值的命名参数的结构。
*   Flagtype 参数是不需要值的参数。（如果存在，该值将设置为 1）
*   别名可用于将一个参数名称映射到多个 argstruct 字段

## 示例用法：

```
function parseargtest(varargin)

%define the acceptable named arguments and assign default values
Args=struct('Holdaxis',0, ...
'SpacingVertical',0.05,'SpacingHorizontal',0.05, ...
'PaddingLeft',0,'PaddingRight',0,'PaddingTop',0,'PaddingBottom',0, ...
'MarginLeft',.1,'MarginRight',.1,'MarginTop',.1,'MarginBottom',.1, ...
'rows',[],'cols',[]);

%The capital letters define abrreviations.
% Eg. parseargtest('spacingvertical',0) is equivalent to parseargtest('sv',0)

Args=parseArgs(varargin,Args, ... 
% fill the arg-struct with values entered by the user, e.g.
% {'Holdaxis'}, ... %this argument has no value (flag-type)
% {'Spacing' {'sh','sv'}; 'Padding' {'pl','pr','pt','pb'}; 'Margin' {'ml','mr','mt','mb'}});

disp(Args) 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-12-07T09:30:38.933

还有一个可以使用的“hack”，尽管它可能会在某些时候从 MATLAB 中删除：

函数*eval*实际上接受两个参数，如果第一个发生错误，则运行第二个参数。

因此我们可以使用

```
function output = fun(input)
   eval('input;', 'input = 1;');
   ...
end 
```

使用值 1 作为参数的默认值。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-01-16T14:18:21.187

这是一个处理这个问题的好方法，只占用三行代码（除非换行）。以下内容是直接从我正在编写的函数中提取的，它似乎可以按需要工作：

```
defaults = {50/6,3,true,false,[375,20,50,0]}; % Set all defaults
defaults(1:nargin-numberForcedParameters) = varargin; % Overload with function input
[sigma,shifts,applyDifference,loop,weights] = ...
     defaults{:}; % Unfold the cell struct 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-03-22T09:55:50.437

在了解了[ASSIGNIN](http://www.mathworks.com/help/techdoc/ref/assignin.html)（感谢[b3](https://stackoverflow.com/users/14946/b3)的[这个答案](https://stackoverflow.com/questions/5091284/clever-way-to-assign-multiple-fields-at-once/5091374#5091374)）和[EVALIN 之后](http://www.mathworks.com/help/techdoc/ref/evalin.html)，我编写了两个函数来最终获得一个非常简单的调用结构：

```
setParameterDefault('fTrue', inline('0')); 
```

这是清单：

```
function setParameterDefault(pname, defval)
% setParameterDefault(pname, defval)
% Author: Tobias Kienzler (https://stackoverflow.com/users/321973)
% sets the parameter NAMED pname to the value defval if it is undefined or
% empty

if ~isParameterDefined('pname')
    error('paramDef:noPname', 'No parameter name defined!');
elseif ~isvarname(pname)
    error('paramDef:pnameNotChar', 'pname is not a valid varname!');
elseif ~isParameterDefined('defval')
    error('paramDef:noDefval', ['No default value for ' pname ' defined!']);
end;

% isParameterNotDefined copy&pasted since evalin can't handle caller's
% caller...
if ~evalin('caller',  ['exist(''' pname ''', ''var'') && ~isempty(' pname ')'])
    callername = evalin('caller', 'mfilename');
    warnMsg = ['Setting ' pname ' to default value'];
    if isscalar(defval) || ischar(defval) || isvector(defval)
        warnMsg = [warnMsg ' (' num2str(defval) ')'];
    end;
    warnMsg = [warnMsg '!'];
    warning([callername ':paramDef:assigning'], warnMsg);
    assignin('caller', pname, defval);
end 
```

和

```
function b = isParameterDefined(pname)
% b = isParameterDefined(pname)
% Author: Tobias Kienzler (https://stackoverflow.com/users/321973)
% returns true if a parameter NAMED pname exists in the caller's workspace
% and if it is not empty

b = evalin('caller',  ['exist(''' pname ''', ''var'') && ~isempty(' pname ')']) ; 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-28T00:59:25.207

这或多或少是从[MATLAB 手册](http://www.mathworks.com/access/helpdesk/help/techdoc/index.html?/access/helpdesk/help/techdoc/ref/varargin.html)中提取的；我只有过客经验...

```
function my_output = wave ( a, b, n, k, T, f, flag, varargin )
  optargin = numel(varargin);
  fTrue = inline('0');
  if optargin > 0
    fTrue = varargin{1};
  end
  % code ...
end 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-13T04:18:36.217

Matlab 没有为此提供一种机制，但是您可以在用户代码中构造一个比 inputParser 或“如果 nargin < 1...”序列更简洁的机制。

```
function varargout = getargs(args, defaults)
%GETARGS Parse function arguments, with defaults
%
% args is varargin from the caller. By convention, a [] means "use default".
% defaults (optional) is a cell vector of corresponding default values

if nargin < 2;  defaults = {}; end

varargout = cell(1, nargout);
for i = 1:nargout
    if numel(args) >= i && ~isequal(args{i}, [])
        varargout{i} = args{i};
    elseif numel(defaults) >= i
        varargout{i} = defaults{i};
    end
end 
```

然后你可以像这样在你的函数中调用它：

```
function y = foo(varargin)
%FOO 
%
% y = foo(a, b, c, d, e, f, g)

[a, b,  c,       d, e, f, g] = getargs(varargin,...
{1, 14, 'dfltc'}); 
```

格式是一种约定，可让您从参数名称向下读取到它们的默认值。您可以使用可选的参数类型规范（用于错误检测或隐式转换）和参数计数范围来扩展您的 getargs()。

这种方法有两个缺点。首先，它很慢，因此您不想将它用于在循环中调用的函数。其次，Matlab 的函数帮助 - 命令行上的自动完成提示 - 不适用于 varargin 函数。但这很方便。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-10-08T19:04:52.863

您可能想`parseparams`在 MATLAB 中使用该命令；用法如下：

```
function output = wave(varargin);
% comments, etc
[reg, props] = parseparams(varargin);
ctrls = cell2struct(props(2:2:end),props(1:2:end),2);  %yes this is ugly!
a = reg{1};
b = reg{2};
%etc
fTrue = ctrl.fTrue; 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-10-11T13:56:52.427

```
function f(arg1, arg2, varargin)

arg3 = default3;
arg4 = default4;
% etc.

for ii = 1:length(varargin)/2
  if ~exist(varargin{2*ii-1})
    error(['unknown parameter: ' varargin{2*ii-1}]);
  end;
  eval([varargin{2*ii-1} '=' varargin{2*ii}]);
end; 
```

例如，`f(2,4,'c',3)`使参数`c`为 3。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-06-10T14:09:18.040

如果您使用[Octave](https://en.wikipedia.org/wiki/GNU_Octave)，您可以这样做 - 但遗憾的是 MATLAB 不支持这种可能性：

```
function hello (who = "World")
  printf ("Hello, %s!\n", who);
endfunction 
```

（取自[文档](https://www.gnu.org/software/octave/doc/interpreter/Default-Arguments.html)。）

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-05-24T12:04:16.337

我喜欢以一种更面向对象的方式来做这件事。

在调用 wave() 之前，将一些参数保存在一个结构中，例如一个称为参数的参数：

```
parameters.flag = 42;
parameters.fTrue = 1;
wave(a, b, n, k, T, f, parameters); 
```

然后在 wave 函数中检查结构参数是否包含名为“flag”的字段，如果是，则其值是否为非空。然后为它分配一个您之前定义的默认值，或者作为参数结构中的参数给出的值：

```
function output = wave(a, b, n, k, T, f, parameters)
  flagDefault = 18;
  fTrueDefault = 0;
  if (isfield(parameters,'flag') == 0 || isempty(parameters.flag)), flag=flagDefault;else flag=parameters.flag; end
  if (isfield(parameter, 'fTrue') == 0 || isempty(parameters.fTrue)), fTrue=fTrueDefault;else fTrue=parameters.fTrue; end
  ...
end 
```

这使得处理大量参数变得更容易，因为它不依赖于给定参数的顺序。也就是说，如果您稍后必须添加更多参数也很有帮助，因为您不必更改函数签名即可。

# c++ - 测试 C++ 应用程序的性能

> ID：795827
> 
> 赞同：6
> 
> 时间：2009-04-28T00:48:38.930
> 
> 标签：c++, performance, testing

我正在尝试找到一种方法来测试运行一段 C++ 代码需要多长时间。我用它来比较不同算法和不同语言的代码，所以理想情况下我想要一个以秒/毫秒为单位的时间。在 Java 中，我使用这样的东西：

```
long startTime = System.currentTimeMillis();

function();

long stopTime = System.currentTimeMillis();
long elapsedTime = stopTime - startTime; 
```

有没有像 C++ 那样获得准确时间的好方法（或者我应该使用其他一些基准测试方法）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-28T10:09:48.253

使用您平台上可用的最佳计数器，回退到 time() 以获得可移植性。我正在使用 QueryPerformanceCounter，但请参阅其他回复中的评论。

一般建议：

内部*循环*应至少运行时钟分辨率的 20 倍左右，以使分辨率误差 < 5%。（因此，使用 time() 时，您的内部循环应至少运行 20 秒）

重复这些测量，看看它们是否一致。

我使用了一个额外的*外循环*，运行了十次，并忽略了计算平均值和偏差的最快和最慢测量。比较两种实现时，偏差很方便：如果您有一种算法采用 2.0ms +/- .5，而另一种算法采用 2.2 +/- .5，则将其中一种称为“更快”的差异并不显着。（最大值和最小值仍应显示）。所以恕我直言，一个有效的性能测量应该是这样的：

```
10000 x 2.0 +/- 0.2 ms (min = 1.2, , max=12.6), 10 repetitions 
```

如果您知道自己在做什么，那么清除缓存和设置线程关联可以使您的测量更加稳健。

然而，这并非没有缺陷。测量越“稳定”，它也就越不真实。任何实现都会随时间发生很大变化，具体取决于数据和指令缓存的状态。我这里比较懒，使用 max= 值来判断首次运行惩罚，这对于某些场景可能还不够。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-28T00:53:29.947

执行该功能几千次以获得准确的测量结果。

单个测量可能受操作系统事件或其他随机噪声的支配。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-28T01:01:26.263

在 Windows 中，您可以使用高性能计数器来获得更准确的结果：

您可以使用该`QueryPerformanceFrequency()`函数获取每秒的高频滴答数以及用户`QueryPerformanceCounter()`想要计时的函数之前和之后。

当然，这种方法是不可移植的……

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-28T01:03:20.593

您是否考虑过实际使用分析器？Visual Studio Team System 内置了一个，但也有其他可用的，例如 VTune 和 GlowCode。

另请参阅[适用于 Windows 的最佳免费 C++ 分析器是什么？](https://stackoverflow.com/questions/67554/whats-the-best-free-c-profiler-for-windows-if-there-are)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-29T13:37:31.677

`clock()`和有什么问题`CLOCKS_PER_SEC`？它们是标准的 C89。

像（从 MSDN 中删减）：

```
 long i = 6000000L;
   clock_t start, finish;
   double  duration;

   // Measure the duration of an event.
   printf( "Time to do %ld empty loops is ", i );
   start = clock();
   while( i-- ) 
      ;
   finish = clock();
   duration = (double)(finish - start) / CLOCKS_PER_SEC;
   printf( "%2.1f seconds\n", duration ); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-28T00:54:55.420

您可以使用该[`time()`](http://www.opengroup.org/onlinepubs/009695399/functions/time.html)函数获取分辨率为一秒的计时器。如果您需要更高的分辨率，可以使用[`gettimeofday()`](http://www.opengroup.org/onlinepubs/009695399/functions/gettimeofday.html). 解决方案取决于您的操作系统和运行时库。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-28T09:40:26.263

我总是使用[boost::timer](http://www.boost.org/doc/libs/1_38_0/libs/timer/timer.htm)或[boost::progress_timer](http://www.boost.org/doc/libs/1_38_0/libs/timer/timer.htm)。

伪代码：

```
#include <boost/timer.hpp>

boost::timer t;

func1();
cout << "fun1: " << t.elapsed();

t.restart();
func2();
cout << "func2(): " << t.elapsed(); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-29T08:08:09.927

如果你想检查你的性能，你应该考虑测量使用的*处理器*时间，而不是你现在尝试测量的*实时时间。*否则，如果在后台运行的其他应用程序决定同时进行一些繁重的计算，您可能会得到非常不准确的时间。您想要的函数是Windows上的[GetProcessTimes和 Linux 上的](http://msdn.microsoft.com/en-us/library/ms683223(VS.85).aspx)[getrusage](http://www.manpagez.com/man/2/getrusage/)。

此外，您应该考虑使用探查器，正如其他人所建议的那样。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-01-24T07:24:36.210

**概述**

我为此编写了一个简单的语义破解。

*   便于使用
*   代码看起来很整洁。

**宏**

```
#include <time.h>

#ifndef SYSOUT_F
#define SYSOUT_F(f, ...)      _RPT1( 0, f, __VA_ARGS__ ) // For Visual studio
#endif

#ifndef speedtest__             
#define speedtest__(data)   for (long blockTime = NULL; (blockTime == NULL ? (blockTime = clock()) != NULL : false); SYSOUT_F(data "%.9fs", (double) (clock() - blockTime) / CLOCKS_PER_SEC))
#endif 
```

**用法**

```
speedtest__("Block Speed: ")
{
    // The code goes here
} 
```

**输出**

```
Block Speed: 0.127000000s 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-28T01:07:29.883

您可以简单地在代码中使用[time()](http://www.cplusplus.com/reference/clibrary/ctime/time/)来测量几秒钟的精度。彻底的基准测试应该运行多次迭代以确保准确性，因此秒数应该足够大。如果您使用的是 linux，则可以使用命令行提供的 time 实用程序，如下所示：

```
[john@awesome]$time ./loops.sh

real    0m3.026s
user    0m4.000s
sys     0m0.020s 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-28T03:03:45.627

在 unix 系统（Linux、Mac 等）上，您可以`time`像这样使用实用程序：

```
$ time ./my_app 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-28T03:03:48.760

如果您的函数非常快，一个好的做法是将函数计时在一个循环中，然后减去循环开销。

像这样的东西：

```
int i;
int limit=1000000;
int t0=getTime();
for(i=0; i < limit; ++i)
   ;
int t1=getTime();
int loopoverhead = t1-t0;
t0=getTime();
for(i=0; i < limit; ++i)
    function();
t1=getTime();
double tfunction = (1.0/limit)*((t1-t0)-loopoverhead); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-29T12:52:16.560

以 100 次迭代 * 10 次迭代运行 1000 次，您可以展开内部循环以最小化开销。然后秒转换为毫秒。

正如其他人所指出的，这是衡量需要多长时间的好方法。

但是，如果您还想让它花费更少的时间，那是一个不同的目标，需要不同的技术。[我最喜欢的是这个。](https://stackoverflow.com/questions/375913/what-can-i-use-to-profile-c-code-in-linux/378024#378024)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-04-08T12:28:51.783

您的部署平台可能会对您的时钟精度产生严重影响。如果您在虚拟机内部进行采样，那么所有的赌注都没有了。VM 中的系统时钟相对于物理时钟浮动，并且必须偶尔重新同步。考虑到墨菲先生在软件领域的恶作剧性质，几乎可以肯定的是，这将会发生

# javascript - 检测资源负载 ？

> ID：795830
> 
> 赞同：6
> 
> 时间：2009-04-28T00:50:00.097
> 
> 标签：javascript, css, optimization

`<script>`浏览器为和`<img>`标签提供加载事件。有没有办法检测对元素的请求是否已经完成？

具体来说，我希望检测何时`<link>`加载了 'd 样式表。

不幸的是，我认为在我的情况下，使用哨兵样式并检测来自 a 的负载`computedStyle`是不可行的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T02:05:09.010

可能有一种更简单的方法来做到这一点，但这对我有用。

确保你的`<link>`标签有一个`title`属性：

```
<link title="myStyles" rel="stylesheet" href="style.css" /> 
```

然后使用这样的函数来检查特定样式集中的样式是否存在：

```
function linkLoaded(linkTitle, checkStyle)
{
    for (var ix=0; ix<document.styleSheets.length; ix++) {
        try {
            if (document.styleSheets[ix].title == linkTitle) {
                var mySheet=document.styleSheets[ix];
                var myRules = mySheet.cssRules? mySheet.cssRules: mySheet.rules
                for (var jx=0; jx<myRules.length; jx++) {
                    var thisSelector = myRules[jx].selectorText.toLowerCase();
                    if (thisSelector.substring(0, checkStyle.length) == checkStyle) {
                        alert("Found style!");
                        return;
                    }
                }
            }
        }
        catch (err) {}    
    }

    alert("Not loaded!");
    return;
} 
```

# python - 如何在 mod_python 中打开和传输文件系统上的文件？

> ID：795837
> 
> 赞同：1
> 
> 时间：2009-04-28T00:53:59.947
> 
> 标签：python, file-io, mod-python

我是 mod_python 和 Apache 的新手，在 GET 请求后我无法将文件返回给用户。我现在有一个非常简单的设置，并希望简单地打开文件并将其写入响应：

```
from mod_python import apache

def handler(req):
    req.content_type = 'application/octet-stream'
    fIn = open('response.bin', 'rb')
    req.write(fIn.read())
    fIn.close()
    return apache.OK 
```

但是，当我使用 open() 时出现错误，说该文件不存在（尽管我已经检查了十几次）。使用相对和绝对文件路径时会发生这种情况。

我有两个问题：

*   为什么 open() 找不到正确的文件？
*   从文件系统返回文件的最佳方法是什么？（我要求确保我没有错过使用 mod_python 返回文件的更好方法。）

谢谢

编辑：找到这个线程后：http: [//www.programmingforums.org/thread12384.html](http://www.programmingforums.org/thread12384.html) 我发现如果我将文件移动到家外的另一个目录， open() 对我有用（我是 /home/myname 的别名/httpdocs，但如果我使用 /data，它就可以工作）。任何想法为什么有效？

编辑 2：我的调试错误的一部分，根据要求：

```
MOD_PYTHON ERROR

ProcessId:      13642
Interpreter:    '127.0.1.1'

ServerName:     '127.0.1.1'
DocumentRoot:   '/var/www'

URI:            '/test/mptest.py'
Location:       None
Directory:      '/home/myname/httpdocs/'
Filename:       '/home/myname/httpdocs/mptest.py'
PathInfo:       ''

Phase:          'PythonHandler'
Handler:        'mptest'

Traceback (most recent call last):

  File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 1537, in HandlerDispatch
    default=default_handler, arg=req, silent=hlist.silent)

  File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 1229, in _process_target
    result = _execute_target(config, req, object, arg)

  File "/usr/lib/python2.5/site-packages/mod_python/importer.py", line 1128, in _execute_target
    result = object(arg)

  File "/home/myname/httpdocs/mptest.py", line 13, in handler
    fIn = open('/home/myname/httpdocs/files/response.bin', 'rb')

IOError: [Errno 2] No such file or directory: '/home/myname/httpdocs/files/response.bin' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-28T01:16:48.957

要调试这种东西，您需要从正在运行的 mod_python 实例收集所有信息。

不要再纠结“检查它[存在] 十几次”。有些假设是不正确的。

做这样的事情来获取一些调试信息。

```
def handler(req):
    req.content_type = 'text/plain'
    req.write(os.environ)
    req.write(os.getcwd())
    # etc.
    return apache.OK 
```

* * *

**编辑**

现在您可以看到**重要的东西**。在这种情况下，它可能是权限——您需要使用 os.filestat 来确定。Apache 以几乎没有可用权限的用户身份运行 mod_python。Apache 也不喜欢链接，但这不应该影响 mod_python。如果您的文件没有被所有人阅读并且不在正确的目录中，那么您将遇到问题。

您可能想切换到[mod_wsgi](http://code.google.com/p/modwsgi/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T01:27:47.587

你能粘贴你得到的错误吗？

这可能是权限错误（如果您尝试使用文件的完整路径）。请记住，脚本以运行 Web 服务器进程的用户身份运行 - 因此您通常会以“www-data”或“nobody”的身份访问文件。

还要检查文件夹的权限`/home/myname/httpdocs/files/`。该文件夹应该是`+x`给`www-data`用户的：

```
$ mkdir blah
$ echo works > blah/response.bin
$ chmod 000 blah/
$ cat blah/response.bin
cat: blah/response.bin: Permission denied
$ chmod +x blah/
$ cat blah/response.bin
works 
```

您可以通过执行以下操作从等式中消除 Apache/your-script：

```
you:~$ sudo su - www-data
www-data:~$ file /home/myname/httpdocs/files/response.bin 
```

（su 可能不起作用，具体取决于您使用的操作系统/发行版，例如 OS X 会阻止您以其`www`用户身份登录）

除了文件权限，为什么脚本仍然依赖于主文件夹中的文件？可以`response.bin`移动到与 Python 脚本相同的文件夹吗？或者甚至可能移动到数据库中？（也许是 SQLite？可能是不必要的/过度的，取决于里面有什么`response.bin`以及它改变了多少）

# c# - 假人的线程队列

> ID：795842
> 
> 赞同：6
> 
> 时间：2009-04-28T00:56:33.607
> 
> 标签：c#, multithreading, queue

我认为这是一个非常常见的线程场景：

*   我有 100 个相同的工作要完成
*   所有工作都是相互独立的
*   我想一次最多处理 15 个作业
*   随着每个作业的完成，将开始一个新作业，直到所有作业都完成

如果您假设每个作业在完成时都会触发一个事件（我正在使用 BackgroundWorker 类），我可以想出几种方法来解决这个问题，但我不确定“正确”的解决方案是什么。我希望你们中的一些大师能指出我正确的方向。

**解决方案 1：** 有一段**时间（继续）{ Threading.Sleep(1000); 在我的 Main( )**函数中循环。Job_Completed 事件处理程序中的代码将设置 continue = false 当**A)**没有待排队的作业和**B)**所有排队的作业都已完成。我之前使用过这个解决方案，虽然它似乎工作正常......对我来说似乎有点“奇怪”。

**解决方案 2：** 在我的 Main() 函数中使用 Application.Run()。类似地，Job_Completed 事件处理程序中的代码将调用 Application.Exit() 当**A)**没有作业要排队和**B)**所有排队的作业都已完成。

**解决方案 3：** 使用 ThreadPool，将所有 500-1000 个请求排队，让它们一次运行 10 个（SetMaxThreads）并以某种方式等待它们全部完成。

在所有这些解决方案中，基本思想是每次完成另一个工作时都会启动一个新工作，直到没有工作为止。因此，问题不仅在于等待现有作业完成，还在于等待不再有任何待处理的作业开始。如果 ThreadPool 是正确的解决方案，那么在 ThreadPool 上等待完成所有排队项目的正确方法是什么？

我认为我在这里最重要的困惑是我不完全了解事件是如何从我的 Main() 函数中触发的。显然他们这样做了，我只是从 Windows 消息循环的角度不了解它的机制。解决这个问题的正确方法是什么，为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T02:56:19.950

即使如果您想要另一个选择（您永远不会有足够的选择），其他答案也很好，那么作为一个想法怎么样。

只需将每个作业的数据放入一个结构中，该结构位于 FIFO 堆栈中。

创建 15 个线程。

每个线程将从堆栈中获取下一个作业，并将其弹出。

当一个线程完成处理时，获取下一个作业，如果堆栈为空，则线程死亡或只是休眠，等待。

唯一很容易解决的复杂性是将弹出放在关键部分（同步读取/弹出）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T01:09:52.810

回复：“不知何故等待他们全部完成”

[ManualResetEvent](http://msdn.microsoft.com/en-us/library/system.threading.manualresetevent.aspx)是你的朋友，在你开始大批量创建这些小狗之前，在你的主线程中等待它，在工作完成后在后台操作结束时设置它。

另一种选择是手动创建线程并执行 foreach 线程 thread.Join()

你可以使用这个（我在测试期间使用这个）

```
 private void Repeat(int times, int asyncThreads, Action action, Action done) {
        if (asyncThreads > 0) {

            var threads = new List<Thread>();

            for (int i = 0; i < asyncThreads; i++) {

                int iterations = times / asyncThreads; 
                if (i == 0) {
                    iterations += times % asyncThreads;                    
                }

                Thread thread = new Thread(new ThreadStart(() => Repeat(iterations, 0, action, null)));
                thread.Start();
                threads.Add(thread);
            }

            foreach (var thread in threads) {
                thread.Join();
            }

        } else {
            for (int i = 0; i < times; i++) {
                action();
            }
        }
        if (done != null) {
            done();
        }
    } 
```

用法：

```
// Do something 100 times in 15 background threads, wait for them all to finish.
Repeat(100, 15, DoSomething, null) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T01:09:58.113

我只会使用任务并行库。

您可以将其作为一个简单的 Parallel.For 循环与您的任务一起执行，它会自动相当干净地管理它。如果您等不及 C# 4 和 Microsoft 的实现，一个临时的解决方法是只编译和使用[TPL 的 Mono 实现](http://code.google.com/p/mono-taskparallel-library/)。（我个人更喜欢 MS 实现，尤其是较新的 beta 版本，但 Mono 是今天功能性和可再分发的。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-28T01:10:07.503

当你在线程队列中排队一个工作项时，你应该得到一个等待句柄。将它们全部放在一个数组中，您可以将其作为参数传递给`WaitAll()`函数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-28T01:25:35.033

我会使用线程池。

在开始运行作业之前，请创建一个[ManualResetEvent](http://msdn.microsoft.com/en-us/library/system.threading.manualresetevent.aspx)和一个 int 计数器。将每个作业添加到 ThreadPool，每次递增计数器。

在每个作业结束时，递减计数器，当它达到零时，对事件调用[Set()](http://msdn.microsoft.com/en-us/library/system.threading.manualresetevent.set.aspx)。

在您的主线程中，调用[WaitOne()](http://msdn.microsoft.com/en-us/library/system.threading.manualresetevent.waitone.aspx)以等待所有作业完成。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-28T01:07:09.977

这是我将如何处理它的伪代码（这不利用线程池，所以有人可能有更好的答案：）

```
main
{
    create queue of 100 jobs
    create new array of 15 threads
    start threads, passing each the job queue
    do whatever until threads are done
}

thread(queue)
{
    while(queue isn't empty)
    {
        lock(queue) { if queue still isn't empty dequeue a thing }
        process the thing
    }

    queue is empty so exit thread
} 
```

编辑：如果您的问题是如何判断线程何时完成，并且您使用的是普通 C# 线程（不是 ThreadPooled 线程），您可以在每个线程上调用 Thread.Join() 并使用可选超时，它只会返回一次线程完成。如果你想在不挂断的情况下跟踪完成了多少线程，你可以像这样循环它们：

```
for(int i = 0; allThreads.Count > 0; i++)
{
    var thisThread = allThreads[i % threads.Count];
    if(thisThread.Join(timeout)) // something low, maybe 100 ms or something
        allThreads.Remove(thisThread);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-28T03:06:43.933

`ThreadPool`可能是要走的路。该`SetMaxThreads`方法将能够限制正在执行的线程数。但是，这限制了进程/AppDomain 的最大线程数。`SetMaxThreads`如果进程作为服务运行，我不建议使用。

```
private static ManualResetEvent manual = new ManualResetEvent(false);
private static int count = 0;

public void RunJobs( List<JobState> states )
{
     ThreadPool.SetMaxThreads( 15, 15 );

     foreach( var state in states )
     {
          Interlocked.Increment( count );
          ThreadPool.QueueUserWorkItem( Job, state );
     }

    manual.WaitOne();
}

private static void Job( object state )
{
    // run job
    Interlocked.Decrement( count );
    if( Interlocked.Read( count ) == 0 ) manual.Set();
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-06-22T07:41:43.473

Microsoft 的反应式框架在这方面非常出色：

```
Action[] jobs = new Action[100];

var subscription =
    jobs
        .ToObservable()
        .Select(job => Observable.Start(job))
        .Merge(15)
        .Subscribe(
            x => Console.WriteLine("Job Done."),
            () => Console.WriteLine("All Jobs Done.")) 
```

完毕。

只是 NuGet“System.Reactive”。

# java - 从 JSP 填充向量，将向量输出到 JSP

> ID：795845
> 
> 赞同：0
> 
> 时间：2009-04-28T00:57:30.560
> 
> 标签：java, html, jsp

嗨，这是一个微不足道的问题，但我似乎无法让它发挥作用。

我正在从我的 jsp 中填充一个向量。（我已经验证了向量中有元素）

现在，我想将同一向量的内容输出回我的同一 jsp。

那里有一些代码的接受者吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-02-17T03:21:45.187

如果您想避免 scriptlet 代码，您可以使用 JSTL`<c:forEach>`标记来执行此操作。例如，要将每个项目打印为有序列表中的单独条目，请使用：

```
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<html>
  <head></head>
  <body>
    <ol>
      <c:forEach items="${vector}" var="item">
        <li><c:out value="${currentName}" /></li>
      </c:forEach>
    </ol>
  </body>
</html> 
```

如果您不关心 encoding `currentName`，您可以将其缩短为：

```
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<html>
  <head></head>
  <body>
    <ol>
      <c:forEach items="${vector}" var="item">
        <li>${currentName}</li>
      </c:forEach>
    </ol>
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T01:59:54.453

```
<% 
for (Iterator it = vector.iterator(); it.hasNext();) {
   out.println("Hey here is an item in my vector: " + it.next());
}
%> 
```

?

没有细节很难做很多其他事情。

另外，人们真的还在使用 Vector，而不是 List？

# jquery - Sizzle 中的 makeArray 函数 (jQuery 1.3)

> ID：795861
> 
> 赞同：1
> 
> 时间：2009-04-28T01:08:48.523
> 
> 标签：jquery, sizzle

[我](https://stackoverflow.com/questions/456457/jquery-1-3-only-selecting-the-first-element)只在我的一个网站上遇到了很多关于 jQuery 1.3.2 的问题。这是一个 Joomla 站点，所以 Mootools 也包含在页面上（而且移除 Mootools 太难了）。`"a", ".myClass"`基本上问题是用一个选择器（例如： ，*not* ）调用基本的jQuery选择器`"html a", ".myClass td"`，只会返回第一个元素。

我已经单步执行了代码并将其缩小到 Sizzle 引擎中的这个函数：（
[请自己查看，第 2058 行[jquery.js](http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.js)）]

```
var makeArray = function(array, results) {
    array = Array.prototype.slice.call( array );
    if ( results ) {
        results.push.apply( results, array );
        return results;
    }
    return array;
}; 
```

我将在这里再次写出来并附上注释，以显示我在调用后记录的值`jQuery("a")`：

```
var makeArray = function(array, results) {
    // "array" is an array of all the 58 links on the page
    // "results" is an empty jQuery object

    array = Array.prototype.slice.call( array );

    // array is unchanged.

    if ( results ) {   // true
        results.push.apply( results, array );
        // "results" is now an array only holding the FIRST element.
        return results;
    }
    return array;
}; 
```

有人可以向我解释这段代码吗？还有为什么它除了我的一个元素之外都摆脱了？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-28T01:37:21.323

啊，我终于找到了。我使用的是旧版本的[Validation 插件](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)，它与 jQuery 1.3+ 不兼容——它定义了自己的`push`方法，只将第一个元素推入数组中，而不是常规的 jQuery 方法。

因此，让这对所有升级后遇到奇怪问题的人发出警告：检查插件的兼容性！

# asp.net - 如何在两台主机配置中保持转换后媒体的机密性？

> ID：795867
> 
> 赞同：0
> 
> 时间：2009-04-28T01:13:31.537
> 
> 标签：asp.net, security, configuration, servlets, host

假设我在公共 Internet（不是 Intranet）上有两台机器 A 和 B。

机器 A 有一个 Web 服务器，用于托管机密文档的未加密图像。

机器 B 托管一个 ASP.net 或 Java servlet 页面，以允许对这些图像进行操作。

机器 A 上的媒体 URL 可以传递到机器 B 上的页面，然后机器 B 可以操作图像。

机器 B 如何保证不保留从机器 A 传递给它的任何机密信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T01:21:21.580

我认为没有任何方法可以保证这一点。使用可[否认加密](http://en.wikipedia.org/wiki/Deniable_encryption)，如果他们公开了一份文件，你可以合理地否认曾经发送过它。

但我想不出任何技术上迫使他们在处理后销毁文件的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T01:23:16.757

如果机器 B 必须从机器 A 访问未加密版本的文档，并且机器 A 不能信任机器 B 上运行的代码，我想不出任何方法可以向机器 A 保证机器 B 已经销毁了所有副本什么发送它。

# c++ - 如何使用 ICU 解析汉字数字字符？

> ID：795868
> 
> 赞同：7
> 
> 时间：2009-04-28T01:14:04.687
> 
> 标签：c++, parsing, unicode, icu

我正在使用 ICU 编写一个函数来解析由汉字数字字符组成的 Unicode 字符串，并希望返回字符串的整数值。

"五" => 5
"三十一" => 31
"五千九百七十二" => 5972

我将语言环境设置为 Locale::getJapan() 并使用 NumberFormat::parse() 来解析字符串。但是，每当我传递任何汉字字符时，parse() 方法都会返回 U_INVALID_FORMAT_ERROR。

有谁知道 ICU 是否支持 NumberFormat::parse() 方法中的汉字字符串？我希望因为我将语言环境设置为日语，所以它能够解析汉字数值。

谢谢！

```
#include <iostream>
#include <unicode/numfmt.h>

using namespace std;

int main(int argc, char **argv) {
    const Locale &jaLocale = Locale::getJapan();
    UErrorCode status = U_ZERO_ERROR;
    NumberFormat *nf = NumberFormat::createInstance(jaLocale, status);

    UChar number[] = {0x4E94}; // Character for '5' in Japanese '五'
    UnicodeString numStr(number);
    Formattable formattable;
    nf->parse(numStr, formattable, status);
    if (U_FAILURE(status)) {
        cout << "error parsing as number: " << u_errorName(status) << endl;
        return(1);
    }
    cout << "long value: " << formattable.getLong() << endl;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-10-07T17:29:51.377

您可以使用 ICU 基于规则的数字格式 (RBNF) 模块 rbnf.h (C++) 或对于 C，在 unum.h 中带有 UNUM_SPELLOUT 选项，两者都带有日语的“ja”语言环境。Atryom 为您的 C++ 代码提供了更正：`new RuleBasedNumberFormat(URBNF_SPELLOUT,jaLocale, status);`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T09:49:13.167

我创建了一个小的 perl 模块来执行此操作。它可以转换阿拉伯语<=>日语，虽然我没有对它进行详尽的测试，但我认为它非常全面。随时改进它。

```
 package kanjiArabic;
use strict;
use warnings;
our $VERSION = "1.00";
use utf8;

our %big = (
    十 => 10,百 => 100,千 => 1000,
    );
our %bigger = (
    万 => 10000,億 => 100000000,
    兆 => 1000000000000,京 => 10000000000000000,
    垓 => 100000000000000000000,
    );
#precompile regexes                                                                                                          
our $qr = qr/[0-9]/;
our $bigqr = qr/[十百千]/;
our $biggerqr = qr/[万億兆京垓]/;

#this routine does most of the real work.
sub kanji2arabic{
    $_ = shift;

    tr/〇一二三四五六七八九/0123456789/;
    #optionally precompile for performance boost                                                                             
    s/(?<=${qr})(${bigqr})/\*${1}/g;
    s/(?<=${bigqr})(${bigqr})/\+${1}/g;
    s/(${bigqr})(?=${qr})/${1}\+/g;
    s/(${bigqr})(?=${bigqr})/${1}\+/g;
    s/(${bigqr})/${big{$1}}/g;

    s/([0-9\+\*]+)/\(${1}\)/g;

    s/(? "〇", 1 => "一", 2 => "二", 3 => "三", 4 => "四",
    5 => "五", 6 => "六", 7 => "七", 8 => "八", 9 => "九",
    );
our %places = (
    1 => 10, 
    2 => 100, 
    3 => 1000, 
    4 => 10000, 
    8 => 100000000, 
    12 => 1000000000000,
    16 => 10000000000000000, 
    20 => 100000000000000000000,
    );
our %abig   = (
    10 => "十", 
    100 => "百", 
    1000 => "千", 
    10000 => "万", 
    100000000 => "億",
    1000000000000 => "兆", 
    10000000000000000 => "京", 
    100000000000000000000 => "垓",
    );
our $MAX = 24; #We only support numbers up to 24 digits!                                                                     

sub arabic2kanji{
    my @number = reverse(split(//,$_[0]));
    my @kanji;
    for(my $i=$#number;$i>=0;$i--){
        if( $i==0 ){push(@kanji,$asmall{$number[$i]});}
        elsif( $i % 4 == 0 ){
            if( $number[$i] !~ m/[01]/ ){
                push(@kanji,$asmall{$number[$i]});
            }
            push(@kanji,$abig{$places{$i}});
    }else{
            my $p = $i % 4;
            if( $number[$i]==0 ){
                next;
            }elsif( $number[$i]==1 ){
                push(@kanji,$abig{$places{$p}});
            }else{
                push(@kanji,$asmall{$number[$i]});
        push(@kanji,$abig{$places{$p}});
            }
    }
    }
    return join("",@kanji);
}

sub eval_k2a{
    #feed me utf-8!                                                                                                          
    if($_[0] !~ m/^[〇一二三四五六七八九十百千万億兆京垓]+$/){
        print "Error: ".$_[0].
              " not a Kanji number.\n" if defined($_[1])&&$_[1]==1;
        return -1;
    }
    my $expression = kanji2arabic($_[0]);
    print $expression."\n" if defined($_[1])&&$_[1]==1;
    return eval($expression);
}

1; 
```

然后你会像这样从另一个脚本中调用它，

```
 #!/usr/bin/perl -w
use strict;
use warnings;
use Encode;
use kanjiArabic;

my $kanji = kanjiArabic::arabic2kanji($ARGV[0]);
print "Kanji: ".encode("utf8",$kanji)."\n";
my $arabic =  kanjiArabic::eval_k2a($kanji);
print "Back to arabic...\n";
print "Arabic: ".$arabic."\n"; 
```

并像这样使用这个脚本，

```
 kettle:~/k2a$ ./k2a.pl 5000215
Kanji: 五百万二百十五
Back to arabic...
Arabic: 5000215 
```

摇滚。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T05:21:59.943

我受到您的问题的启发，[使用 Python 解决了这个问题](http://ginstrom.com/scribbles/2009/04/28/converting-kanji-numbers-to-integers-with-python/)。

如果您没有找到 C++ 解决方案，那么将其适应 C++ 应该不会太难。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-23T05:37:33.837

这实际上是相当困难的，尤其是当您开始查看[非常大的数字](http://en.wikipedia.org/wiki/Chinese_numerals#Large_numbers)的晦涩汉字时。

在 perl 中，[Lingua::JA::Numbers](http://search.cpan.org/~dankogai/Lingua-JA-Numbers/lib/Lingua/JA/Numbers.pm)中有一个非常完整的实现。如果您想将它移植到 C++，它的[来源可能会很有启发性。](http://cpansearch.perl.org/src/DANKOGAI/Lingua-JA-Numbers-0.04/lib/Lingua/JA/Numbers.pm)

# ruby-on-rails - 断点在 ruby on rails 的脚本目录中不可用

> ID：795881
> 
> 赞同：0
> 
> 时间：2009-04-28T01:19:16.767
> 
> 标签：ruby-on-rails, ruby

我是一个 ruby​​ on rails 新手。在我使用脚手架创建的应用程序中，脚本目录下没有断点。当我从某个地方复制断点并将其放在脚本目录下时，它给出了一个错误。对此的任何指示都会很棒..

谢谢，阿亚帕

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T17:44:09.987

断点不再受支持，主要是因为它与较新版本的 Ruby 不兼容。ruby-debug，又名 rdebug，是新标准。尝试这个

```
./script/server --debug 
```

然后放关键字

```
debugger 
```

您想在哪里进行调试会话。这是关于使用 rdebug[的一个很好的介绍截屏视频。](http://railscasts.com/episodes/54-debugging-with-ruby-debug)

# asp.net-mvc - 以两种形式使用一个控件的最佳方式

> ID：795882
> 
> 赞同：0
> 
> 时间：2009-04-28T01:20:47.480
> 
> 标签：asp.net-mvc

我正在尝试创建一个页面，用户可以在其中选择他们想要购买的订阅类型，然后输入他们的信用卡信息或点击“使用 PayPal 支付”按钮。

到目前为止，我能想到的最好的方法是有一个下拉菜单，用户可以在其中选择订阅类型，然后并排放置两个表单（一个输入 CC 信息，另一个只输入一个很大的 PayPal 按钮）。我做出了这个决定，以便在一种形式中，我可以发送一个`?paymentType=CreditCard`查询字符串参数，而在另一种形式中，我可以发送`?paymentType=Paypal`. 这使我不必检查 buttonText == "Next" 进程是否为 CC，否则重定向到 PayPal。

但是，由于订阅控件不是*任何一种*形式的一部分，我无法访问已选择的类型，而无需在两种形式中复制控件（这不能提供最佳的用户体验）。

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T01:36:11.280

为什么你需要两个表格呢？我肯定会选择一种形式。因为即使你有两种形式，它们仍然会做同样的事情；订阅。

你可以有两个这样的单选按钮

```
<input id="radiobtn-paypal" name="PaymentType" type="radio" value="PayPal" />
<label for="radiobtn-paypal">PayPal</label>
<input id="radiobtn-cc" name="PaymentType" type="radio" value="CC" />
<label for="radiobtn-cc">Credit Card</label> 
```

根据选择，是否显示信用卡文本框。然后根据用户的选择处理信用卡或使用 PayPal 选择操作执行您需要执行的操作。毕竟这些都是 html 输入控件的用途。

# security - 您如何在托管服务中监控、管理和运行不受信任的第三方代码？

> ID：795888
> 
> 赞同：3
> 
> 时间：2009-04-28T01:24:22.790
> 
> 标签：security, sandbox

假设我正在运行一个托管服务，它希望允许第三方客户端编写的插件。

也许是提供基础设施但允许客户开发自己的游戏裁判的游戏服务提供商。或者，一个编码竞赛网站，允许编码人员提交代码以作为他们对某些编码问题的解决方案来运行。

您将如何加固/锁定/沙箱此用户代码以免对打算运行它的服务器造成潜在损害？

您将如何监控和限制资源使用（主要是 CPU、内存）？

[这对 Python 来说是一个好的开始](http://wiki.python.org/moin/How%20can%20I%20run%20an%20untrusted%20Python%20script%20safely%20(i.e.%20Sandbox))，但我想知道这里是否有人有更具体的经验可以分享*，无论使用哪种语言*（Python、Lua、Ruby 等）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T01:47:48.240

[RestrictedPython](http://pypi.python.org/pypi/RestrictedPython/)（显示在您提供的链接中）看起来很有希望。但是，我不能说我实际上已经尝试过这样做。

另一个可行的选择是构建一个**极小**的 Linux 发行版，然后在虚拟化环境中为每个用户复制它。使用虚拟机的监控机制通过在资源达到特定级别时暂停 VM 来限制 CPU 和内存使用。如果您将发行版构建得足够小，那么 VM 本身对资源的影响就会很小，但我想您仍然需要相当大量的 RAM 来实现这样的解决方案（只是为了安全起见）。

只是我的2美分。不过，我不是 Python 专家。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T10:20:58.740

[100% 安全可能是不可能的](http://www.bpfh.net/simes/computing/chroot-break.html)，但是 chroot'ing 是一个好的开始。我在我的服务器上使用了几个脚本，这些脚本在 chroot 的监狱中运行。一个脚本是攻击的受害者（我忽略了一个相当聪明的漏洞 - 哎呀！）虽然渗透者破坏了脚本，但监狱阻止了他们进行任何进一步的破坏。

如果您要使用最小的 python 选项，请查看[Minimal Python](https://stackoverflow.com/questions/356452/minimal-python-build-for-my-applications-scripting-needs/356579#356579)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T11:16:43.630

您可能想要执行以下操作：

1.  编译传入的代码以挑选出所有`import`语句并限制可以导入的内容。

2.  还要检查`_import_`和`reload`功能的使用。

3.  为这些模块定义一个 API，允许它们作为单独的进程运行，封装在您提供的轻量级 WSGI 服务器中。将它们分叉为子进程并通过您的服务器 API 进行交互。如果它们崩溃或挂起，您将通过超时检测到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-28T05:42:18.057

Lua 拥有迄今为止我见过的最好的沙盒和看门狗。我的宿主语言是 Python。因此，我决定使用[Lunatic Python](http://labix.org/lunatic-python)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-28T10:19:12.117

FWIW，[Apache/mod_wsgi 3.0 版](http://code.google.com/p/modwsgi/wiki/ChangesInVersion0300)能够在 chroot 环境中运行其守护进程模式进程。

如果只对尝试保护主要操作系统感兴趣，那么这是能够做到这一点的一个可能组件。

如果您还想阻止用户干扰其他用户的代码，并且可以有任意数量的用户可以动态更改，那么这会更难，因为 Apache/mod_wsgi 还没有动态守护进程组的功能，而是依赖于静态配置。

# c# - 解决方案子文件夹中的 C# 资源文件导致 MissingManifestResourceException

> ID：795889
> 
> 赞同：2
> 
> 时间：2009-04-28T01:24:48.077
> 
> 标签：c#, resources

我创建了一系列资源 (resx) 文件来保存语言特定的字符串数据。按照各种教程，我将基本资源文件 (MyResources.resx) 放在解决方案的根文件夹中，并在解决方案中并排放置其他后续资源文件，例如 (MyResources.en-AU.resx)。说这一切一切正常，直到我在解决方案资源管理器中创建一个文件夹，例如，称为“文化”，然后将一个或所有资源文件移动到该文件夹​​中。这样做之后，我得到了 MissingManifestResourceException。一旦我将它们移回解决方案资源管理器的根文件夹，就没有问题。

谁能解释这里发生了什么？如何将这些资源文件从根解决方案中移开？

问候

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-28T01:38:06.750

当您说您移动了资源文件时，您的意思是您手动将它们移动到文件系统上吗？如果是这种情况，显然构建工具将无法找到这些文件，因为它们仍然被它们的“旧”位置引用。尝试从项目中删除资源文件，然后“添加现有项目”并将其添加回来。当然，在尝试之前不要忘记备份所有内容......

编辑：当您将文件移动到文件夹中时，该文件夹名称将成为命名空间的一部分。因此，例如，如果您有一个名为 Resource1 的资源文件，并且您通过 Resource1.String1 访问它，则将其移至“文件夹”后，它将变为 Folder.Resource1.String1

# c# - 减少 .NET 应用程序中的线程数量

> ID：795892
> 
> 赞同：2
> 
> 时间：2009-04-28T01:25:51.367
> 
> 标签：c#, multithreading, memory

我有一个中型进程查看器，它在 Windows Vista 上使用大约 40MB 的私有内存。问题是人们总是将这个数字与 Process Explorer 和类似的非托管工具使用的内存量进行比较。

我注意到当我的程序空闲时，有 13 个正在运行的线程：

*   一个 RPC 线程 (RPCRT4.dll!ThreadStartRoutine)
*   一个 COM 相关线程 (ole32.dll!CoRegisterSurrogateEx+0x35e0)
*   两个 ntdll 线程 (ntdll.dll!TppWorkerThread, ntdll.dll!TppWaiterpThread)
*   主 GUI 线程
*   计时器线程（由 CLR 使用）
*   门线程 (CLR)
*   调试器线程 (CLR)
*   4 个工作线程 (mscorwks.dll!Thread::intermediateThreadProc)
*   最后是 GDI+ 后台线程 (gdiplus.dll!BackgroundThreadProc)

如何摆脱其中一些线程，释放线程堆栈内存（每个 1MB）？ThreadPool.GetAvailableThreads 告诉我有 0 个工作线程正在运行，但有 3 个“intermediateThreadProc”线程。使用服务管理器 API 是否与 RPC 线程有关？（它进行 RPC 调用。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T01:40:40.177

13个线程是相当低的。不幸的是，如果不削减功能，您将无法摆脱大多数这些线程。

对于托管应用程序来说，摆脱 RPC 和 COM 很可能是不可能的，而且 CLR 线程似乎都在做一些有用的事情。我猜您正在使用 GDI+（可能通过 System.Drawing。）即使有 0 个工作线程正在运行，线程池也有线程“处于待机状态”，准备启动。您不希望发布工作项必须承担在空闲进程中创建新线程的开销。

即使您可能正在使用 40 MB 的私有内存，这很可能不是因为线程数。即使每个线程都完全使用了它的 1 MB 默认堆栈（它们肯定不是，大部分堆栈被保留但未提交并且不会显示为私有字节），也只是 40 MB 中的 13 MB你看到了。您能否使用 CLR Profiler 查看您的应用程序正在执行哪些分配？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T02:38:34.953

注意：具有默认选项的线程会为堆栈空间保留 1MB 的虚拟内存。但是，所有这些内存都不会自动提交。

相反，如果线程刚刚超过已提交空间的边缘，则会自动提交另一个页面，直到所有虚拟空间都用完为止。最有可能的是，每个使用的空间都少于 1MB。

看[http://msdn.microsoft.com/en-us/library/ms686774(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms686774(VS.85).aspx)

# django - 你可以在 Django 中让多个应用程序处理 404 吗？

> ID：795893
> 
> 赞同：3
> 
> 时间：2009-04-28T01:26:08.777
> 
> 标签：django, http-status-code-404, django-flatpages

显然，Django flatpages 的工作方式是处理其他应用程序抛出的 404。我想知道我是否可以做另一个平面类型的应用程序，在平面页面之前获得 404 的破解。到目前为止，我尝试了这个但没有成功。一个模板被渲染，但数据没有通过。

甚至可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T02:55:26.720

根据 Django 文档，您可以将自己的视图指定为 404 或 500 处理程序：

```
handler404 = 'mysite.views.my_custom_404_view' 
```

因此，您的应用可以定义一个自定义错误处理视图`views.py`，您可以在其中设置为 404 或 500 视图的处理程序`urls.py`

有关详细信息，请参阅“[自定义错误视图](http://docs.djangoproject.com/en/dev/topics/http/views/#the-404-page-not-found-view)”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T20:02:42.273

内置平面应用程序的工作方式是使用[一些中间件](http://code.djangoproject.com/browser/django/trunk/django/contrib/flatpages/middleware.py)：中间件有一个名为“process_response”的函数，用于检查 404 状态代码的传出响应。如果响应是 404，并且 URL 与平面页面匹配，则中间件会抑制 404 并返回呈现的平面页面。

你可以用你自己的中间件做同样的事情。为确保在 flatpages 代码之前调用您的代码，您的中间件应位于设置中的 flatpages**之后**`MIDDLEWARE_CLASSES`：

```
# in settings.py
MIDDLEWARE_CLASSES = (
    # ...
    'django.contrib.flatpages.middleware.FlatpageFallbackMiddleware',
    'myapp.middleware.MyMiddlewareClass',
) 
```

它在之后而不是之前的原因是因为在响应阶段 Django 以相反的顺序应用中间件。

# recursion - 与使用堆栈相比，递归通常被认为是一种过时的遍历方法吗？

> ID：795903
> 
> 赞同：3
> 
> 时间：2009-04-28T01:31:44.317
> 
> 标签：recursion, stack

我一直在阅读一些人们选择使用堆栈而不是递归的地方。这是因为递归被视为完成工作的过时方式，还是两种方法在不同的环境中同样适用？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-28T01:34:31.893

不，恰恰相反。递归是表达一整类问题的自然方式。如果没有递归，堆栈是一种模拟方式。

例如，参见这个[问题](https://stackoverflow.com/questions/779282/how-far-does-recursion-execute-into-your-function-in-c/779297#779297)。或者考虑一种标准递归函数：计算第*n*个斐波那契数。

你会记得[斐波那契数](http://en.wikipedia.org/wiki/Fibonacci_number)列

```
0,1,1,2,3,5,8,13, ... 
```

定义为 F [n] = F [n-1] +F [n-2]。

这可以写成递归定义

基本情况：
F(0) = 0
F(1) = 1
递归步骤：
F(n) = F(n-1)+F(n-2)

因此，您有 F(0) = 0、F(1)= 1、F(2)=F(0)+F(1)=1，依此类推。

一个计算这个的简单程序（在 C 中只是为了咧嘴笑）是：

```
int fib(int n) {
    /* we'll ignore possible negative arguments, see Wikipedia */
    switch(n) {
       case 0: return 0; break;
       case 1: return 1; break;
       default: return fib(n-1)+fib(n-2); break;
    }
} 
```

请注意该程序与原始定义的对应程度有多接近？

*问题是，C 管理调用堆栈*中的所有中间结果。有些语言没有被定义为这样做（我能想到的唯一一种是旧的 FORTRAN，但我相信还有其他的）。如果您使用汇编程序或旧的 FORTRAN 编写，那么您必须管理自己的堆栈以跟踪这些中间结果。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-28T01:36:21.310

迭代通常比递归更快/开销更少。通过递归，我们隐式地使用机器的堆栈作为我们的堆栈——我们“免费”获得它——但我们付出了昂贵的函数调用（以及随之而来的机器堆栈管理）的成本。

但是递归函数通常更易于书写和阅读。

通常，可以使用递归来编写函数，直到它成为瓶颈，然后用使用显式堆栈的迭代函数替换它。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-28T01:35:05.760

**更新**以包括鱼唇的更正。

使用堆栈是消除[递归的标准技术](http://en.wikipedia.org/wiki/Recursion)

另请参阅：[什么是尾递归？](https://stackoverflow.com/questions/33923/what-is-tail-recursion)

尾递归的一个例子（可以使用迭代删除）：

```
public class TailTest
{   
    public static void Main()
    {       
        TailTest f = new TailTest();
        f.DoTail(0);
    }

    public void DoTail(int n)
    {       
        int v = n + 1;      
        System.Console.WriteLine(v);    

        DoTail(v);   // Tail-Recursive call
    }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-28T01:37:11.340

如果您处于尾调用增长堆栈（未应用尾调用优化（TCO））的编程语言/环境中，那么最好避免深度递归，并且可能使用堆栈数据结构的迭代解决方案是首选。

另一方面，如果您处于支持尾调用迭代的语言/环境中，或者如果递归深度总是很小，那么递归通常是一个很好/优雅的解决方案。

（这有点过于宽泛，但总的来说，我绝不会称递归“过时”。）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-04-16T15:56:30.960

不不，我认为现代开发人员应该在几毫秒内强调可读性和易于维护。

如果问题是递归的，我完全推荐你的递归解决方案。

此外，您最终可能会引入一些意料之外的错误，试图强制执行迭代/堆叠解决方案。

# batch-file - 批处理文件，$ : 和 ~

> ID：795906
> 
> 赞同：1
> 
> 时间：2009-04-28T01:32:47.700
> 
> 标签：batch-file, environment-variables

我一直在编写一个需要在文件中扩展环境字符串的应用程序。

为此，我可以使用标准的 Windows API 函数 ExpandEnvironmentStrings：http: [//msdn.microsoft.com/en-us/library/ms724265 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms724265(VS.85).aspx)

不过，我确实对该功能有一些问题。第一的： `The size of the lpSrc and lpDst buffers is limited to 32K.`

下一个：`Note that this function does not support all the features that Cmd.exe supports. For example, it does not support %variableName:str1=str2% or %variableName:~offset,length%.`

我想实现 cmd.exe 允许的这些额外功能，但我不确定它们到底是什么。:~offset,length 有点明显......子字符串。但不确定第一个是什么。

有任何想法吗？

比利3

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-28T01:36:14.493

这是字符串替换。

基本上，如果 variableName 设置为`"I am three"`，则`"%variableName:three=four%"`生成`"I am four"`（放入双引号以获得更好的格式，它们不构成字符串的一部分）。

```
C:\Documents and Settings\Administrator>set x=I am three

C:\Documents and Settings\Administrator>echo %x%
I am three

C:\Documents and Settings\Administrator>echo %x:three=four%
I am four 
```

您还可以用空字符串替换（很明显）并从字符串的开头替换（不太明显）：

```
C:\Documents and Settings\Administrator>echo %x:three=%
I am 

C:\Documents and Settings\Administrator>echo %x:*am=I am not%
I am not three 
```

此外，子字符串变体是 Pythonesque，因为负数从字符串*末尾*开始工作：

```
C:\Documents and Settings\Administrator>echo %x:~,4%
I am

C:\Documents and Settings\Administrator>echo %x:~-5%
three 
```

# c# - 我应该将 MEF 的接口放在哪里？

> ID：795908
> 
> 赞同：8
> 
> 时间：2009-04-28T01:33:10.053
> 
> 标签：c#, mef

在组织项目时，我应该将 MEF 中使用的提供程序接口放在哪里？目前我只是将它们与其他所有东西放在同一个项目中，但似乎我可能希望将它们提取到一个单独的 dll 中，这样它是一个非常小的 dll，并且很容易被其他尝试编写扩展的人链接到。这有什么好的做法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-28T01:43:12.213

与任何插件/扩展模型一样，您应该将“合同”（插件作者应该实现的接口）放在与您的应用程序分开的程序集中。

这样，您就可以将该程序集提供给插件作者，而无需向他们提供整个应用程序 - 如果它是您需要单独许可的商业应用程序，这将非常有用。

MEF Preview 5 引入了导出接口的能力（即向接口添加 [Export] 属性），以便自动导出该接口的任何实现者。这意味着插件作者甚至不需要了解 MEF - 他们只是实现您的接口，并且它们自动成为 MEF 扩展。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-12-22T18:28:32.977

实际上，.NET 4.0 中有一个称为类型等效的新功能可以实现这一点。使用此功能，您可以在不同的合同程序集中拥有两个不同的接口，告诉 CLR 它们是相同的。因为它是低级的，所以 MEF 可以很好地使用它。

一些警告：

*   除框架类型外，仅支持自定义接口。
*   不支持自定义通用接口。
*   匹配需要两个接口上的 guid :-(

您可以在此处阅读更多相关信息：http: [//msdn.microsoft.com/en-us/library/dd997297](http://msdn.microsoft.com/en-us/library/dd997297(VS.100).aspx) (VS.100).aspx 。文档会说它适用于 COM，但您也可以将它用于托管代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T01:28:18.570

最初 MEF 打算实现鸭子类型，这意味着您不需要通用程序集，但显然这被证明太难了。

我将它们全部放在一个通用程序集中，以及一些可用于帮助实现接口的有用抽象基类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-09T08:35:08.193

我也有同样的问题，想看一个例子，其中在一个项目中定义了合同，在其他项目中定义了多个实现，以及一个单独的消费者项目，它使用合同并具有扩展文件夹，其中实现 dll 可以简单地复制并可用消费者应用程序无需任何代码更改。所以我尝试编写一个简单的 Hello World 类型的应用程序并发布在我的博客上。希望你会发现它有用。我还发布了源代码（在 C# 中）。

[http://ppsinfo.blogspot.com/2009/11/managed-extensibility-framework-mef.html](http://ppsinfo.blogspot.com/2009/11/managed-extensibility-framework-mef.html)

# c# - FTP 和文件提取自动化

> ID：795915
> 
> 赞同：0
> 
> 时间：2009-04-28T01:35:18.693
> 
> 标签：c#, xml, automation

第三方来源每天 FTP 在我的应用程序服务器上的给定文件夹中发送一个 zip 文件（其中包含 xml 文件）。现在，我正在手动对发件人进行 FTP 传输，下载 zip 文件并从中提取 xml。

如果我需要使用 C# 以编程方式实现所有这些，我该怎么做？即，我需要.... 1.FTP 发件人 2.下载文件 3.提取 xml 并将其保存到我在应用服务器上的文件夹中。

请帮忙。

万分感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T01:50:06.100

查看[FTPWebRequest](http://msdn.microsoft.com/en-us/library/system.net.ftpwebrequest.aspx)和[FTPWebResponse](http://msdn.microsoft.com/en-us/library/system.net.ftpwebresponse.aspx)类。他们应该有你需要的一切。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-28T01:45:49.027

我会因为没有回答你的问题而被否决，但 C# 可能对此有点过分了。您可以只获取[windows 的 curl](http://fileforum.betanews.com/detail/cURL-for-Windows/966899018/1)，它将为您下载文件，然后使用[链接文本](http://www.7-zip.org/)的命令行版本来解压缩它。大约是 2 行 bat 脚本。

```
cd <some dir>
curl ftp://some.ftp/somefiles/archive.zip
7z e archive.zip 
```

3 行与 cd。如果您真的想在 C# 中执行此操作，请查看[这些](http://aspalliance.com/1187_Building_a_Simple_FTP_Application_Using_C_20) [文章。](http://www.eggheadcafe.com/tutorials/aspnet/9ce6c242-c14c-4969-9251-af95e4cf320f/zip--unzip-folders-and-f.aspx)

# c# - 如何找到程序中每个对象使用的内存？

> ID：795919
> 
> 赞同：4
> 
> 时间：2009-04-28T01:36:43.260
> 
> 标签：c#, memory, object

如何找出程序中每个对象使用的内存？

例如：我想知道这个对象“someclassinstance”使用了多少内存（以 Kb 为单位）..

someclass someclassinstance=new someclass();

我可以在任务管理器中看到应用程序使用的总内存......但是有没有办法查看每个对象实例的内存使用情况的详细报告？

注意：我已经尝试过 CLR 分析器..但据我所知，它只显示字符串使用的总内存......它不显示每个字符串对象使用的内存。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T01:52:56.920

[.NET Memory Profiler 非常棒](http://memprofiler.com/) ，它有 14 天的试用期，之后非常便宜。它可以让您跟踪您拥有的所有实例，绘制它们并查看每个实例占用了多少内存。它使您可以深入了解应用程序中到底发生了什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T01:42:10.423

[Red Gate Software](http://www.red-gate.com/products/ants_profiler/index.htm)制作了 Ants Profiler，我相信它会为您提供所需的信息。它绝对是非免费的，但有 15 天的试用期，这取决于您是否有幸在工作中拥有软件预算，您也许可以购买它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T02:23:39.467

[CLR profiler](http://www.microsoft.com/downloads/details.aspx?FamilyId=A362781C-3870-43BE-8926-862B40AA0CD0&displaylang=en)是免费的，可以做到这一点。它有一个学习曲线，但附带您需要的文档。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-28T01:49:58.953

分配的内存量`new someclass`是 sizeof(someclass) 向上取整的；向上取整可能类似于 sizeof(someclass) + sizeof(void*) 四舍五入到 32。

这不会告诉您某个类为其成员分配的内存（如果有的话）。

最好的方法可能是用一个记录分配的字节的包装器替换全局操作符 new。请注意，如上所述，出于簿记和对齐的原因，请求的字节数少于实际分配的字节数。

这可以在 C++ 中完成，我不了解 C#。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-28T02:01:18.380

[使用Windbg + SOS](http://msdn.microsoft.com/en-us/library/bb190764.aspx)免费、极其强大且相当棘手的方法是

这篇[博文](http://blogs.msdn.com/jasonz/archive/2003/10/21/53581.aspx)应该足以让你开始。

# iphone - 验证发布版本

> ID：795921
> 
> 赞同：1
> 
> 时间：2009-04-28T01:37:13.557
> 
> 标签：iphone, shared-libraries, itunes, xcodebuild

我的项目引用了我创建的静态 DLL。设置这些项目以确保发生相应的构建阶段。这意味着，如果我在模拟器/调试中构建，静态库将具有最新的模拟器/调试版本。我可以验证我的应用程序工作正常，除了设备/版本。有没有办法验证设备/版本？这有点像在没有任何验证的情况下把它扔给苹果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T15:23:10.627

我的建议是使用 Release 配置来构建您的开发配置文件，并创建一个新的 Distribute 配置。新配置在所有方面都应该与发布配置相同，只是它使用您的分发证书而不是您的开发证书进行签名。

为此，只需进入您的项目设置，转到配置选项卡，然后复制发布配置，然后将副本重命名为分发。然后转到 Build 选项卡，从下拉列表中选择 Distribute 配置，然后更改 Code Signing Identity 以使用您的分发证书。

现在您可以确保除了代码签名步骤之外，两种配置的输出是相同的。如果您将来更改构建设置，只需删除并重新创建分发配置文件以确保所有设置都相同。

# django - Does order of declaration matter in models.py (Django / Python)?

> ID：795930
> 
> 赞同：6
> 
> 时间：2009-04-28T01:39:49.587
> 
> 标签：django, django-models

I have something like this in models.py

```
class ZipCode(models.Model):
    zip = models.CharField(max_length=20)
    cities = City.objects.filter(zip=self).distinct()

class City(models.Model):
    name = models.CharField(max_length=50)
    slug = models.CharField(max_length=50)
    state = models.ForeignKey(State)
    zip = models.ManyToManyField(ZipCode) 
```

When I do this I get:

```
NameError: name 'City' is not defined 
```

Is this because the order of declaration matters? And if so, how can I do this, because either way I arrange this, it looks like I'm going to get a NameError.

Thanks.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-28T21:12:17.863

Apart from order issues, this is wrong:

```
cities = City.objects.filter(zip=self).distinct() 
```

It is not inside a method, so "self" will also be undefined. It is executed only once, at class-creation time (i.e. when the module is first imported), so the attribute created would be a class attribute and have the same value for all instances. What you might be looking for is this:

```
@property
def cities(self):
  return City.objects.filter(zip=self).distinct() 
```

Because this is inside a method, which is not executed until it's accessed, ordering issues will no longer be a problem. As ozan points out, this is a duplication of what Django reverse relations already give you for free:

```
a_zip_code.city_set.all() 
```

And you can use related_name to call it what you like:

```
zip = models.ManyToManyField(ZipCode, related_name='cities')
...
a_zip_code.cities.all() 
```

So I don't think the ordering issue you originally asked about is even relevant to your situation. When it is, others have already pointed out using quoted strings in ForeignKey and ManyToManyField declarations to get around it.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-28T02:00:10.677

When you have references to classes defined after, you can use this trick:

```
attribute = models.ForeignKey('ClassDefinedAfterThis') 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-28T02:42:07.347

I was once worried about order... because I thought my models below could only reference models above. But then realized that you can just do a

```
models.ForeignKey('appName.modelName') 
```

and all was fine.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-28T06:07:58.147

Yes order does matter as others have noted.

Though, encountering this issue is almost always going to be an indication that you're doing something wrong.

In this case your declaration:

```
cities = City.objects.filter(zip=self).distinct() 
```

... is both [redundant](http://docs.djangoproject.com/en/dev/ref/models/relations/#ref-models-relations) and bad practice. You can find the cities related to a zip code by referring to that zip code's city_set in your views (ie not in your model!). So if zip is an instance of ZipCode, you would do:

```
cities = zip.city_set.all() 
```

If you really want to call it 'cities' rather than 'city_set' you can use the related_name parameter in your m2m declaration.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-28T01:56:18.563

Yes, order does matter, but your example does not look right to me. I think you should just be using a foreign key for your many-to-one relationship:

```
cities = models.ForeignKey(City) 
```

[This has the details](http://www.djangoproject.com/documentation/models/many_to_one/) on many-to-one relationships with django models.

Edit:

It was pointed out to me in the comments that cities in Europe might have several cities in the same zip code. If you are looking for a many-to-many relationship here, you should use:

```
cities = models.ManyToManyField(City) 
```

This is described in [Django's documentation](http://www.djangoproject.com/documentation/models/many_to_many/). The point is, this is either of these examples are much more clear than what is used in the example.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-28T01:55:59.907

Order matters in Python. [This thread](https://stackoverflow.com/questions/524714/does-python-have-class-prototypes-or-forward-declarations) may be relevant to your question. Also for your uses, you may want to use a unique foreign key in the ZIP code class.

# java - jbpm 并发执行 FORK-JOIN 分支中的节点

> ID：795933
> 
> 赞同：0
> 
> 时间：2009-04-28T01:41:22.720
> 
> 标签：java, workflow, jbpm

jbpm 中的默认 FORK 处理程序为流程中定义的每个转换（在 FORK 节点中）创建并发执行路径。但是，它们不是以并行方式执行的。

是否可以编写自定义 fork 处理程序，它启动单独的线程来运行每个 FORK-JOIN 分支？这可能允许真正并发执行 FORK 中的各个分支。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T13:01:05.410

默认的 jBPM fork 处理程序没有实现“真正的”并发，但它确实实现了“业务并发”（即从业务的角度来看它是并发的）。

您可以编写自己的 fork/join 实现...但我看到很多 Hibernate 乐观锁定/陈旧对象/...发生异常。另一个问题是线程的寿命不长（即当数据库/服务器崩溃时），您需要重新创建、重新启动并将它们恢复到以前的状态。考虑到默认的分叉开销很小，这一切似乎都很麻烦……

# wordpress - Wordpress 小部件创建

> ID：795946
> 
> 赞同：0
> 
> 时间：2009-04-28T01:48:15.510
> 
> 标签：wordpress, widget

%wordpress 我已经创建了将 php 函数转换为 Wordpress 小部件的工具。我使用 register_sidebar_widget 函数，但似乎 wp_register_sidebar_widget 会给我更多选择。那合法吗？

PS 我还生成新的 2.8 格式的小部件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T13:40:02.210

`register_sidebar_widget`已弃用——尽管它仍然可以使用，但您可以使用`wp_register_sidebar_widget`. 如果您确实使用`register_sidebar_widget`，可能需要将其括起来，`if ( function_exists('register_sidebar_widget') )`以防该功能在后续版本中被删除。

此外，还有一个插件，Otto 的 PHP 代码小部件，它允许在小部件中使用 PHP 代码。

1.  [http://codex.wordpress.org/WordPress_Widgets_Api/register_sidebar_widget](http://codex.wordpress.org/WordPress_Widgets_Api/register_sidebar_widget)
2.  [http://codex.wordpress.org/WordPress_Widgets_Api/wp_register_sidebar_widget](http://codex.wordpress.org/WordPress_Widgets_Api/wp_register_sidebar_widget)
3.  [http://wordpress.org/extend/plugins/php-code-widget](http://wordpress.org/extend/plugins/php-code-widget)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T01:54:53.140

合法的？当然。WordPress 是 GPL，你可以做任何你想做的事情，只要你遵循许可证的要求。

# php - Xdebug profiler 和 xdebug_time_index() 给出不同的值

> ID：795950
> 
> 赞同：0
> 
> 时间：2009-04-28T01:52:01.757
> 
> 标签：php, xdebug

我使用 Xdebug 来分析我的 PHP 应用程序。

当我使用 WinCacheGrind 打开生成的配置文件时，{main} 的总累积时间为 3 毫秒（0.003 秒）。

但是，当我在代码末尾使用函数 xdebug_time_index() 时，它返回的时间为 0.03 秒。

任何人都知道可能导致这种差异的原因以及哪个更具代表性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T05:40:45.467

添加该功能的任何机会实际上会增加所需的时间吗？

此外，我可以想象当 PHP 运行时（时间索引 0），探查器实际上会开始运行，而 XDebug 的内部计数器可以更早地启动。

# asp.net-mvc - 从 DropDown 中获取显示值

> ID：795958
> 
> 赞同：2
> 
> 时间：2009-04-28T01:56:58.953
> 
> 标签：asp.net-mvc

我正在尝试访问动作内部 FormCollection 中的值。我可以通过执行以下操作来获取值字段：

```
var value = formCollection["MyDropDownList"]; 
```

但我似乎找不到获得显示值的方法。我错过了一些明显的东西吗？也许是演员？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T02:16:07.423

[使用 JavaScript 代码从 HTML 下拉选择列表中获取文本](http://www.webdevelopersnotes.com/tips/html/getting_the_text_from_an_html_drop_down_selection_list.php3)

> 从每个选项中获取文本有点棘手。我们使用选择列表的 selectedIndex 属性来捕获选定的选项，然后将此值传递给 options[].text 属性。这是代码
> 
> ```
> var w = document.myform.mylist.selectedIndex;
> var selected_text = document.myform.mylist.options[w].text; 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T02:41:13.900

我认为没有办法从表单集合中获取显示列。基本上，formcollection 是一种询问 Request 对象（Request.Form、Request.QueryString 等）的简单方法，并且唯一进入其中的是来自输入字段的值。

如果您确实需要获取显示文本，则必须从绑定列表的任何集合中获取它，并通过键（您从 formcollection 中选择的值）访问它。例如，如果它是您绑定到列表的字典集合，请使用同一字典根据键查找值。

我需要了解有关如何绑定下拉列表以进一步帮助您的更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T02:43:04.660

这是正常的行为。发布表单时，仅将表单字段生成的名称-值集合发送到服务器。当然，`option`标签的内部文本不属于该集合。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T06:48:20.117

你没问题，发送的下拉列表显示所选项目的值未显示所选项目的文本...如果你想要（出于某种原因，因为我假设你正在填写模型上的下拉列表对吗？:)）查看发送还显示文本，也许您可​​以在下拉列表中的每次选择更改时使用 javascript 将其放在隐藏字段中...

干杯

# ruby-on-rails - 是否可以在 Ruby on Rails 中对 basic_model (couchdb) 进行验证？

> ID：795960
> 
> 赞同：1
> 
> 时间：2009-04-28T01:59:33.440
> 
> 标签：ruby-on-rails, validation, couchdb

是否可以使用以下验证：

```
class Post < ActiveRecord::Base
  validates_presence_of :name, :title  
  validates_length_of :title, :minimum => 5 
end 
```

与[基本模型](http://github.com/topfunky/basic_model/tree/master)？

我尝试阅读源代码，但在那里找不到任何东西。那些`validates_`可用于其他模型类型，还是仅适用于 ActiveRecord::Base？

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T07:43:02.957

ActiveRecord 中的验证与 ActiveRecord 本身非常耦合，因此您将无法在 AR 之外轻松使用 AR 的验证代码。他们很清楚这一点，Rails 3.0 将拥有 ActiveModel，它将它与 ActiveRecord 分离，因此您可以这样做：

```
class Foo
  include ActiveModel::Validations
end 
```

在那之前，您可以[自己编写](https://stackoverflow.com/questions/775976#776220)或使用[可验证](http://validatable.rubyforge.org/)的gem。

# java - Java：在 jni 调用中，本地代码的错误通常如何处理？

> ID：795963
> 
> 赞同：1
> 
> 时间：2009-04-28T02:00:38.727
> 
> 标签：java, error-handling, java-native-interface

我已经用谷歌搜索了一下，并没有真正找到我的问题的好答案：从本机 jni 代码将错误信​​息传递回 java 的惯用方法是什么？

我通常会选择一个设计并使用它，但是这个代码每 5 毫秒调用一次，（大约），所以我想我会问是否有一种习惯的“干净/高效”的方式来做到这一点。

在我看来，我有四个明显的选择：

1.  在每次调用时，在 java 中创建一个“错误返回”对象并将其传递给 JNI。如果有问题，本机代码会在此对象中填写错误描述，而 java 代码会在返回时对其进行检查。由于错误并不常见，这会为 GC 清理创建大量对象，其中 99.99% 是不必要的。

2.  与 #1 类似，在 java 类中创建一些*单一*的“错误返回”对象，该对象一遍又一遍地传递给每个方法调用。在每次返回的 java 代码中检查它是否有错误。这对我来说似乎很狡猾，但也许这是正确的选择？

3.  在本机代码中创建一个包含错误描述的对象（如果适用），并将其作为返回值传回给 java.util 。在java中调用之后，检查返回是否为null。这似乎没有#1那么浪费，但似乎有点尴尬。

4.  只需在 jni 方法上构建一个整数返回值，并传回一个与本机代码的“退出”值相对应的 int。枚举 Java 映射中所有可能的本机退出状态。将返回值与“0”进行比较，并在必要时在此映射中查找错误。这似乎比其他方法更有效，但似乎更笨拙，因为本地代码的更改需要有人返回并更新“错误表”。

我觉得好像我错过了一些明显的东西......那里有一位大师可以提供任何见解吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-28T02:06:04.547

抛出 java 异常：http: [//java.sun.com/docs/books/jni/html/exceptions.html](http://java.sun.com/docs/books/jni/html/exceptions.html)？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T02:13:37.070

关于您提到的方法：

1.  正如您所提到的，这会产生很多分配/释放调用。
2.  如果您有超过 1 个线程调用您的本机代码，则此方法将不起作用。
3.  这假设您不需要其他任何东西的返回值。还有一个问题是你的错误对象在何时何地被“释放”。
4.  假设您没有将返回值用于其他任何内容，并且您不需要任何有关错误的“额外”信息，这是一个很好的解决方案。可能的错误不应经常更改，以免在更新 Java 代码时产生问题。

当然，如果您*确实*需要返回值，并且想要有关实际错误的更多详细信息，则应该使用[exceptions](http://java.sun.com/docs/books/jni/html/exceptions.html)。

# iphone - 检测到 iPhone 麦克风上的吹气？

> ID：795968
> 
> 赞同：19
> 
> 时间：2009-04-28T02:06:00.630
> 
> 标签：iphone

我试图检测用户何时向 iPhone 的麦克风吹气。现在我正在使用[Stephen Celis](http://stephencelis.com/2009/03/02/now-i-just-need-an-audience.html)的 SCListener 类来调用

```
if ([[SCListener sharedListener] peakPower] > 0.99) 
```

在 NSTimer 中。但是，有时当我不吹气时，这会返回 true。任何人都有任何示例代码来检查用户是否对着麦克风吹气？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-28T02:17:54.503

我建议先对电源信号进行[低通滤波。](http://en.wikipedia.org/wiki/Low-pass_filter)总会有一些瞬态噪声会干扰瞬时读数；低通滤波有助于缓解这种情况。一个不错且简单的低通滤波器将是这样的：

```
// Make this a global variable, or a member of your class:
double micPower = 0.0;
// Tweak this value to your liking (must be between 0 and 1)
const double ALPHA = 0.05;

// Do this every 'tick' of your application (e.g. every 1/30 of a second)
double instantaneousPower = [[SCListener sharedListener] peakPower];

// This is the key line in computing the low-pass filtered value
micPower = ALPHA * instantaneousPower + (1.0 - ALPHA) * micPower;

if(micPower > THRESHOLD)  // 0.99, in your example
    // User is blowing on the microphone 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-12-11T01:56:10.443

在 iPhone 上运行时，您应该在 [recorder prepareToRecorder] 之后添加以下代码

```
[[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryPlayAndRecord error:nil];
[[AVAudioSession sharedInstance] setActive:YES error:nil]; 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-01-23T14:14:49.447

使用`lowPassResults`大于 0.55 的返回值。这工作正常：

```
-(void)readyToBlow1 { NSURL *url = [NSURL fileURLWithPath:@"/dev/null"]; 
    NSDictionary *settings = [NSDictionary dictionaryWithObjectsAndKeys:
                              [NSNumber numberWithFloat: 44100.0],                 AVSampleRateKey,
                              [NSNumber numberWithInt: kAudioFormatAppleLossless], AVFormatIDKey,
                              [NSNumber numberWithInt: 1],                         AVNumberOfChannelsKey,
                              [NSNumber numberWithInt: AVAudioQualityMax],         AVEncoderAudioQualityKey,
                              nil];
    NSError *error;
    recorder = [[AVAudioRecorder alloc] initWithURL:url settings:settings error:&error];
    if (recorder) {
        [recorder prepareToRecord];
        recorder.meteringEnabled = YES;
        [recorder record];
        levelTimer = [NSTimer scheduledTimerWithTimeInterval: 0.01 target: self selector: @selector(levelTimerCallback1:) userInfo: nil repeats: YES];
    } else
        NSLog(@"%@",[error description]);
}

-(void)levelTimerCallback1:(NSTimer *)timer { [recorder updateMeters];
    const double ALPHA = 0.05; 
    double peakPowerForChannel = pow(10, (0.05 * [recorder peakPowerForChannel:0])); 
    double lowPassResults = ALPHA * peakPowerForChannel + (1.0 - ALPHA) * lowPassResults; 
    if (lowPassResults > 0.55) { 
        lowPassResults = 0.0;
        [self invalidateTimers];
        NextPhase *objNextView =[[NextPhase alloc]init];
        [UIView transitionFromView:self.view
                      toView:objNextView.view
                      duration:2.0
                      options:UIViewAnimationOptionTransitionCurlUp
                      completion:^(BOOL finished) {}
        ];
        [self.navigationController pushViewController:objNextView animated:NO];
    **return;**
    }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-12-06T12:09:20.483

[http://mobileorchard.com/tutorial-detecting-when-a-user-blows-into-the-mic/](http://mobileorchard.com/tutorial-detecting-when-a-user-blows-into-the-mic/)

本教程适用于模拟器，但它不适用于 iphone iphone mic 没有响应

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-05-20T06:42:09.620

试试这个它对我来说很好。谢谢@jinhua 廖

```
- (void)viewDidLoad {
   [super viewDidLoad];

lowPassResults = 0.0;
[self readyToBlow1];

NSURL *url = [NSURL fileURLWithPath:@"/dev/null"];

NSDictionary *settings = [NSDictionary dictionaryWithObjectsAndKeys:
                          [NSNumber numberWithFloat: 44100.0],                 AVSampleRateKey,
                          [NSNumber numberWithInt: kAudioFormatAppleLossless], AVFormatIDKey,
                          [NSNumber numberWithInt: 1],                         AVNumberOfChannelsKey,
                          [NSNumber numberWithInt: AVAudioQualityMax],         AVEncoderAudioQualityKey,
                          nil];

NSError *error;

recorder = [[AVAudioRecorder alloc] initWithURL:url settings:settings error:&error];

if (recorder) {
    [recorder prepareToRecord];
    [[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryPlayAndRecord error:nil];
    [[AVAudioSession sharedInstance] setActive:YES error:nil];
    recorder.meteringEnabled = YES;
    [recorder record];
    levelTimer = [NSTimer scheduledTimerWithTimeInterval: 0.03 target: self selector: @selector(levelTimerCallback:) userInfo: nil repeats: YES];
} else
    NSLog([error description]); 

}

- (void)levelTimerCallback:(NSTimer *)timer {
[recorder updateMeters];

const double ALPHA = 0.05;
double peakPowerForChannel = pow(10, (0.05 * [recorder peakPowerForChannel:0]));
lowPassResults = ALPHA * peakPowerForChannel + (1.0 - ALPHA) * lowPassResults;  
NSLog(@"lowpassResult is %f",lowPassResults);
if (lowPassResults > 0.95){
    NSLog(@"Mic blow detected");
    [levelTimer invalidate];
}
} 
```

# c++ - C++ 中的卡方概率函数

> ID：795972
> 
> 赞同：4
> 
> 时间：2009-04-28T02:07:50.940
> 
> 标签：c++, statistics, chi-squared

我的以下代码使用卡方的“分位数”和 Boost 的概率函数计算置信区间。

我正在尝试实现此功能以避免对 Boost 的依赖。有什么资源可以在哪里找到这样的实现？

```
#include <boost/math/distributions/chi_squared.hpp>
#include <boost/cstdint.hpp>

using namespace std;     
using boost::math::chi_squared; 
using boost::math::quantile;

vector <double> ConfidenceInterval(double x) {
    vector <double> ConfInts; 

    // x is an estimated value in which
    // we want to derive the confidence interval.

    chi_squared distl(2);     
    chi_squared distu((x+1)*2);

    double alpha = 0.90;      

    double lower_limit = 0;   

    if (x != 0) {
        chi_squared distl(x*2);   
        lower_limit = (quantile(distl,((1-alpha)/2)))/2;
    }

    double upper_limit = (quantile(distu,1-((1-alpha)/2)))/2;

    ConfInts.push_back(lower_limit);
    ConfInts.push_back(upper_limit);

    return ConfInts;         
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T03:09:52.180

看看[Gnu Scientific 图书馆](http://www.gnu.org/software/gsl/)。或查看[数字食谱](http://www.nr.com/)。[Apache Commons Math](http://commons.apache.org/math/userguide/stat.html)中还有一个 Java 版本，应该很容易翻译。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T19:34:37.417

如果您正在寻找可以复制/粘贴的源代码，这里有一些链接：

*   [算法库](http://www.alglib.net/specialfunctions/distributions/chisquare.php)
*   [科德斯](http://www.koders.com/default.aspx?s=c%2B%2B+chi-square)

YMMV...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-07-08T13:18:37.700

> 我正在尝试实现此功能以避免对 Boost 的依赖。

另一种选择是***减少***Boost 依赖项，但不***避免***它们。如果您减少依赖关系，您可能可以使用包含`Boost`200 或 300 个源文件的文件夹，而不是整个 1+ GB 的材料。（是的，200 或 300 可能是准确的 - 这是我在复制时得到的结果`shared_ptr`）。

要减少依赖性，请使用[`bcp`(boost copy)](http://www.boost.org/doc/libs/1_58_0/tools/bcp/doc/html/index.html)仅复制`chi_squared.hpp`. 坏事是，您通常必须`bcp`从源代码构建，因为它没有分布在 ZIP 或 TARBALL 中。

要查找有关构建的说明`bcp`，请参阅[如何检查最新的稳定 Boost（不是开发或前沿）？](https://stackoverflow.com/q/17777694)

# wcf - SvcUtil 不在客户端代理 (WCF) 中生成抽象类

> ID：795973
> 
> 赞同：1
> 
> 时间：2009-04-28T02:08:02.233
> 
> 标签：wcf, svcutil.exe

我的服务中的课程定义为

```
[DataContract]
[KnownType(typeof(MyConcrete1)) ]
[KnownType(typeof(MyConcrete2)) ]
public abstract class MyAbstract
{
    [DataMember]
    public int AbsInt { get; set; }
}
[DataContract]
public  class MyConcrete1 : MyAbstract
{
    [DataMember]
    public int Concrete1Int { get; set; }
}
[DataContract]
public class MyConcrete2 : MyAbstract
{
    [DataMember]
    public int Concrete2Int { get; set; }
} 
```

在我的服务中，我将其用作

```
[ServiceContract]
public interface IService1
{
    [OperationContract]
    MyAbstract TestAbstract(MyAbstract value);
} 
```

如您所见，TestAbstract 方法接受并返回抽象参数 MyAbstract，但是在 SvcUtil 生成的客户端代理中，类型“ **MyAbstract** ”*不是抽象的*！它生成了一个具体的类。

```
[System.Diagnostics.DebuggerStepThroughAttribute()]
[System.CodeDom.Compiler.GeneratedCodeAttribute("System.Runtime.Serialization", "3.0.0.0")]
[System.Runtime.Serialization.DataContractAttribute(Name = "MyAbstract", Namespace = "http://schemas.datacontract.org/2004/07/WcfService")]
[System.Runtime.Serialization.KnownTypeAttribute(typeof(WcfService.MyConcrete1))]
[System.Runtime.Serialization.KnownTypeAttribute(typeof(WcfService.MyConcrete2))]
public partial class MyAbstract : object, System.Runtime.Serialization.IExtensibleDataObject
{

    private System.Runtime.Serialization.ExtensionDataObject extensionDataField;

    private int AbsIntField;

    public System.Runtime.Serialization.ExtensionDataObject ExtensionData
    {
        get
        {
            return this.extensionDataField;
        }
        set
        {
            this.extensionDataField = value;
        }
    }

    [System.Runtime.Serialization.DataMemberAttribute()]
    public int AbsInt
    {
        get
        {
            return this.AbsIntField;
        }
        set
        {
            this.AbsIntField = value;
        }
    }
} 
```

如何强制 svcUtil 将 MyAbstract 生成为抽象类？我被卡住了，请帮助...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T05:27:33.253

你不能 - svcutil 不能知道 MyAbstract 类是抽象的。服务器和客户端之间交换的元数据不支持这样的概念。SOA 世界并不总是支持 OO 世界所拥有的一切。

服务元数据只知道诸如服务、方法调用和数据契约之类的东西——其他任何东西都不属于服务元数据。

您将需要添加一些额外的逻辑并对客户端代码进行调整，一旦它被创建，如果这是您的实际需求。

马克

# c++ - 改进和发布应用程序。需要一些建议

> ID：795975
> 
> 赞同：1
> 
> 时间：2009-04-28T02:08:46.740
> 
> 标签：c++, projects

上学期（2008 年 8 月 - 2008 年 12 月）我和一些同学用 C++ 编写了一个应用程序。没什么特别的，它是 Sqlite3 的 ORM。我们实现了一些像反射这样的东西来使它工作并将最终用户从丑陋的东西中解放出来。就个人而言，我认为我们做得很好，而且我们的 ORM 实际上可能对某人有用（尽管它是专门为 Sqlite3 编写的，但它很容易适应其他数据库）。

因此，我得出的结论是，它应该作为一个开源项目发布在某个地方（最有可能是 sourceforge）。但是，由于这是一个学期项目，因此在这样做之前需要解决一些问题。也就是说，它有一些应该修复的内存泄漏，并且可以重构代码的某些部分以使每个人的生活在未来更轻松。

我想了解更多有经验的 C++ 程序员对一些问题的看法：

*   是否值得重写一些部分以应用新技术（例如，boost）。
*   我们的 ORM 是否应该适应最新的 C++ 标准？这样做有什么好处吗？
*   我们如何知道我们的代码何时可以发布？
*   这个 ORM 被遗忘在互联网迷雾中的可能性有多大？（即，作为程序员的个人自豪感是否值得出版？）

现在我想不出更多的问题，但我想阅读类似的经历。

编辑：我可能应该将我的代码 + 注释翻译成英文，对吗？（自问）

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T02:52:02.330

我想我对您的特定问题“更有经验”。在 Java 或 ASP 出现之前的 Web 设计早期，我共同开发了一个开源 Web 应用程序语言和模板系统，很像 ColdFusion。如果您有兴趣，您仍然可以在[http://www.steelblue.com/](http://www.steelblue.com/)上看到它。它仍然在我开发它时所在的公司使用，但我不认为其他任何地方。

我发现，除非你已经建立了良好的联系并且人们正在关注你在做什么，否则让人们使用你的开源代码就像出售你的封闭源程序一样难。你真的需要为你的项目辩护，它应该有某种独特的销售主张，将它与竞争对手区分开来。

所以，这是不请自来的建议。以下是对您提出的问题的一些具体答案……当然，这纯粹是我的看法。

除非您有要添加的功能，否则我不会重写任何代码。该功能可能与特定平台或编译器兼容。可能是为了支持新的 db 数据类型或更智能的索引等。如果您打算在应用程序中投入一些更严肃的工作，请考虑您可以在下一次迭代中实际完成的路线图，以及哪些选择将使应用程序在您的周期结束时成为“最好的”。

一旦代码可用于特定目的，任何目的，就立即发布代码。两个原因。首先，现在可能有人为此目的想要它。如果它不可用，他们将使用其他东西。此外，如果它是开源的，他们可能会回馈项目。其次，越早发现有多少人想要使用代码越好。要么它会比你预期的更受欢迎，你会为继续开发而兴奋……或者……你会发现甚至没有人访问你的网页来查看你所拥有的东西。无论哪种情况，最好尽早了解人们真正想要从您的项目中得到什么，这样您就可以在计划新版本时考虑到这一点。

关于“被遗忘的迷雾”。我认为大多数项目都是。我不想成为一个沮丧的人，但是看看 Wikipedia，有 5 个 C++ ORM 工具很受欢迎，足以被提及，它们都是开源的。正如我上面所说，除非您可以将您的想法出售给人们，否则他们将采用另一种经过验证的开源解决方案。要让某人选择你而不是他们，必须发生三件事： 1\. 他们需要你拥有而其他人没有的功能。2\. 他们找到你的项目网站，它展示了你的代码的优越性。3\. 他们足够信任你的代码来试一试。

另一方面，如果您长期从事这项工作并希望继续开发，那么随着时间的推移，事情会变得更加容易。最终，该项目将涵盖所有基础知识，您可以开始开发其他解决方案中没有的新功能。此外，您在积极开发中的时间越长，项目看起来就越值得信赖。最后，您将获得更多的经验。从现在起 2 年后，您将更有能力说出您的努力在哪些方面将对改进项目产生最大影响。

最后的想法：如果你喜欢它，从中学习，并且它不会妨碍你把食物放在桌子上，那么这是对你时间的一种很好的利用。

祝你好运！
-铝

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T14:52:43.703

关于开源部分：

如果你真的想让它成为一个开源项目，你真的应该发布它，不管它的当前状态是什么——完全工作和调试——或者一半工作并且充满内存泄漏。只是，如果它的状态不好，请确保记录它，并给它一个合适的版本号（小于一个？）。然后其他人可能会查看您的代码、提出改进建议、加入您的团队等……

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T01:50:09.697

我的 - 相当随机 - 对此事的想法（按我认为最重要的顺序）：

*   我们如何知道我们的代码何时可以发布？

就像[Liran Orevi 说](https://stackoverflow.com/questions/795975/improving-and-publishing-an-application-need-some-advice/807321#807321)的：如果你要尽早开源发布。合理地记录它，并花时间提供计划或希望未来改进的路线图（这些是邀请人们帮助您的邀请，因此请注意哪些没有人在处理它们）。

*   是否值得重写一些部分以应用新技术（例如，boost）。
*   我们的 ORM 是否应该适应最新的 C++ 标准？这样做有什么好处吗？

SQLite 依赖于相当有限的基础。也许您不希望您的工具需要更重的环境。如果代码当前不是一团糟且无法维护的混乱，您可能希望避免增强和最新的装饰。一旦你有了一个稳定的版本（至少 1.0），你就可以开始考虑可以对版本 2 进行的改进。

*   这个 ORM 被遗忘在互联网迷雾中的可能性有多大？（即，作为程序员的个人自豪感是否值得出版？）

大多数事情最终都在天空中的大 /dev/null 中，并且只有一种方法可以找出......如果它去任何地方，你就赢了。如果不是这样，那是一笔不大的投资，也许你在做的时候学到了一些东西。

# python - Django / Python 世界中是否有任何与 Wordpress 的 SimplePie 插件等效的东西？

> ID：795976
> 
> 赞同：1
> 
> 时间：2009-04-28T02:09:21.387
> 
> 标签：python, django, rss, django-templates, simplepie

我知道 SimplePie 本身是从 UFP 派生的，但我想知道的功能是 SimplePie for WordPress 插件中可用的后处理功能：

[http://simplepie.org/wiki/plugins/wordpress/simplepie_plugin_for_wordpress/processing](http://simplepie.org/wiki/plugins/wordpress/simplepie_plugin_for_wordpress/processing)

我可以为我的 Django 应用程序找到类似的东西吗？

这可以使用 Django 包含标签来完成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-30T13:42:07.400

您正在寻找[通用提要解析器](http://feedparser.org)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T02:19:12.270

[http://www.djangosnippets.org/tags/rss/](http://www.djangosnippets.org/tags/rss/)

# python - 用 subprocess.Popen() 包装脚本

> ID：795977
> 
> 赞同：0
> 
> 时间：2009-04-28T02:09:29.703
> 
> 标签：python, scripting

我有一个随另一个软件包提供的脚本——我不想以任何方式修改它。我需要执行此脚本，提供密码，然后从终端与其交互（使用 raw_input 等）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T02:14:58.830

[pexpect](http://pexpect.sourceforge.net/pexpect.html)是您想要使用的。

> Pexpect 是一个 Python 模块，用于生成子应用程序并自动控制它们。Pexpect 可用于自动化交互式应用程序，例如 ssh、ftp、passwd、telnet 等。它可用于自动化安装脚本，以便在不同服务器上复制软件包安装。它可用于自动化软件测试。它应该可以在任何支持标准 Python pty 模块的平台上运行。Pexpect 界面侧重于易用性，因此简单的任务很容易。

# web-services - 检索给定 URL 的最流行的 GET 参数变体列表？

> ID：795979
> 
> 赞同：1
> 
> 时间：2009-04-28T02:10:34.160
> 
> 标签：web-services, api, machine-learning

我正在围绕链接传播构建智能，因为我需要处理许多需要从确切 URL 地址进行反向查找的短 URL 服务，所以我需要能够解析同一 URL 的多个近似版本。

一个例子是像[http://www.example.com?ref=affil&hl=en&ct=0这样的 URL](http://www.example.com?ref=affil&hl=en&ct=0)

当然，在某些情况下更改 GET 参数可能会引用完全不同的页面，尤其是当相关的 GET 参数引用配置文件或内容 ID 时。

但是对页面的快速解析将很快确定这些页面彼此之间的相似程度。使用一点机器学习，可以很快清楚哪些 GET 参数不会影响给定站点返回的页面内容。

我假设只有谷歌或雅虎（或 Twitter）等公司才能提供发送 URL 并获取非常相似 URL 列表的服务，但它们似乎不提供此功能，我也没有找到任何其他服务。

如果您知道任何以上述方式将几乎相同的 URL 组聚集在一起的服务，请告诉我。

我的赏金是一个拥抱。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T06:12:49.307

每个 URL 都类似于 Internet 上数据位置的“地址”。URL 的“主机”部分（在您的示例中为“www.example.com”）是一个网络服务器，或世界某处的一组网络服务器。如果我们将 URL 视为“地址”，那么主机可能是“国家”。

该国本身可能会跟踪进入它的每一封邮件。有些会，有些不会。我说的是网络服务器！当然，真实的国家不会记录您收到的每一封邮件！:-)

但是，即使那个“国家”跟踪每封邮件——我真的怀疑他们是否有任何机制可以将该列表发送给您。

至于那些可能自己收获的组织，我认为最好的选择是谷歌，但即使在那里，情况也相当严峻。你看，因为谷歌不是世界上每个网络服务器（“国家”）的所有者，他们**无法**知道访问该网络服务器的每个 URL。

但他们可以反其道而行之。由于他们可以为遇到的每个页面编制索引，因此他们可以很好地了解 Web 上公共 HTML 页面中出现的每个 URL。当然，这不包括人们在聊天、短信或电子邮件中相互发送的 URL。但是，他们仍然可以很好地了解存在哪些 URL。

我想我想说的是，你正在寻找的东西并不存在，真的。获取用于访问**单个**网站的所有 URL 的唯一方法是成为**该网站的所有者**。

不好意思，朋友。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T16:44:23.577

听起来您需要在页面之间创建某种离散的相似度等级。这可以通过查找两页之间相似词的数量并将值标准化到有界范围然后将范围的某些部分映射到不同的相似度等级来完成。

您还需要知道每对您比较它们的共同 GET 参数或它们的接近程度。此信息将成为定义每个实例的属性（与上述排名一起存储）。在你积累了几百对比较之后，你也许可以做一些特征子集选择来识别最能识别两个页面有多相似的 GET 参数。

当然，这最终可能根本找不到任何有用的东西，因为该数据集可能包含大量噪音。

如果您对这种方法感兴趣，您应该研究一下 Infogain 和一般的特征子集选择。这是我的教授讲义的链接，可能会派上用场。[http://stuff.ttoy.net/cs591o/FSS.html](http://stuff.ttoy.net/cs591o/FSS.html)

# c++ - C++ 迭代器和循环优化

> ID：795987
> 
> 赞同：47
> 
> 时间：2009-04-28T02:16:16.877
> 
> 标签：c++, optimization, compiler-construction, coding-style, iterator

我看到很多看起来像这样的 c++ 代码：

```
for( const_iterator it = list.begin(),
     const_iterator ite = list.end();
     it != ite; ++it) 
```

与更简洁的版本相反：

```
for( const_iterator it = list.begin();
     it != list.end(); ++it) 
```

这两个约定在速度上会有什么区别吗？因为 list.end() 只被调用一次，所以第一个会稍微快一些。但由于迭代器是 const，编译器似乎会将这个测试拉出循环，为两者生成等效的程序集。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-04-28T02:50:36.123

虽然这两个版本不一样。在第二个版本中，它将迭代器与`list.end()`每次进行比较，`list.end()`评估结果可能会在循环过程中发生变化。现在当然`list`不能通过 const_iterator进行修改`it`；但没有什么能阻止循环内的代码`list`直接调用方法并对其进行变异，这可能（取决于什么样的数据结构`list`）改变结束迭代器。因此，在某些情况下，预先存储结束迭代器可能是不正确的，因为当你到达它时，它可能不再是正确的结束迭代器。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-04-28T11:24:36.810

我将仅提及 C++ 标准要求在*任何*容器类型（无论是、等）上调用`begin()`和**必须只花费恒定时间**。实际上，如果您在打开优化的情况下进行编译，这些调用几乎肯定会被内联到单个指针比较。`end()`*`vector``list``map`*

 ***请注意，此保证不一定适用于其他供应商提供的“容器”，这些“容器”实际上不符合标准第 23 章中规定的容器的形式要求（例如单链表`slist`）。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-28T02:22:41.527

第一个可能几乎总是更快，但是如果您认为这会有所作为，请始终**先分析**一下，看看哪个更快以及快多少。

编译器可能能够`end()`在这两种情况下内联调用，尽管如果`end()`足够复杂，它可能会选择不内联它。但是，关键的优化是编译器是否可以执行[循环不变的代码运动](http://en.wikipedia.org/wiki/Loop-invariant_code_motion)。我认为在大多数情况下，编译器无法确定`end()`在循环迭代期间不会改变的值，在这种情况下，它别无选择，只能`end()`在每次迭代后调用。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-28T02:32:26.777

我会选择最简洁易读的选项。不要试图猜测编译器及其可能执行的优化。请记住，绝大多数代码对整体性能绝对没有影响，因此只有在代码的性能关键部分中，您才应该花时间对其进行分析并选择适当有效的源表示。

具体参考您的示例，第一个版本制作迭代器的*副本*，调用为`end()`迭代器对象的复制构造函数运行的任何代码。STL 容器通常包含内联`end()`函数，因此编译器有很多机会优化第二个版本，即使您不想帮助它。哪个最好？测量它们。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-04-28T02:46:05.137

您可以使第一个版本更简洁，并充分利用两者：

```
for( const_iterator it = list.begin(), ite = list.end();
     it != ite; ++it) 
```

PS 迭代器不是 const，它们是 const 引用的迭代器。有很大的不同。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-04-28T04:43:57.007

考虑这个例子：

```
for (const_iterator it = list.begin(); it != list.end(); ++list)
{
    if (moonFull())
        it = insert_stuff(list);
    else
        it = erase_stuff(list);
} 
```

在这种情况下，您需要在循环中调用 list.end() ，并且编译器不会对其进行优化。

编译器可以证明 end() 总是返回相同值的其他情况，可以进行优化。

如果我们谈论的是 STL 容器，那么当编程逻辑不需要多个 end() 调用时，我认为任何好的编译器都可以优化多个 end() 调用。但是，如果您有一个自定义容器并且 end() 的实现不在同一个翻译单元中，那么优化将不得不在链接时进行。我对链接时间优化知之甚少，但我敢打赌大多数链接器不会做这样的优化。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-04-28T03:42:40.447

啊，人们似乎在猜测。在调试器中打开你的代码，你会看到对 begin()、end() 等的调用都被优化掉了。无需使用版本 1。使用 Visual C++ 编译器 fullopt 测试。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-04-28T22:30:50.640

编译器可能能够将第二个优化为第一个，但这假设两者是等价的，即 end() 实际上是常量。一个稍微有问题的问题是编译器可能由于可能的别名而无法推断出结束迭代器是恒定的。但是，假设对 end() 的调用是内联的，区别只是内存负载。

请注意，这假定优化器已启用。如果优化器没有启用，就像调试构建中经常做的那样，那么第二个公式将涉及 N-1 多个函数调用。在当前版本的 Visual C++ 中，由于函数 prolog/epilog 检查和更重的调试迭代器，调试构建也会产生额外的命中。因此，在 STL 繁重的代码中，默认为第一种情况可以防止代码在调试构建中异常缓慢。

正如其他人所指出的那样，在循环中插入和删除是可能的，但是对于这种循环样式，我发现这不太可能。一方面，基于节点的容器——list、set、map——不会在任一操作中使 end() 无效。其次，迭代器增量经常必须在循环中移动以避免失效问题：

```
   // 假设列表 -- 不能为向量缓存 end()
   iterator it(c.begin()), end(c.end());
   而（它！=结束）{
       if (should_remove(*it))
           它= c.erase（它）；
       别的
           ++它;
   }
```

因此，我认为一个循环声称调用 end() 出于 mutate-during-loop 原因，并且在循环头中仍然有 ++it 是可疑的。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-28T11:41:41.980

1.  在压力条件下对其进行采样，看看您是否经常在**此代码中***。
    如果没有，那也没关系。

2.  如果是，请查看反汇编，或单步执行。
    这就是你如何判断哪个更快。

你必须小心这些迭代器。
它们可能会被优化成漂亮的机器代码，但通常它们不会，并且会浪费时间。

** （其中“in”表示实际在其中，或从中调用。）

*** （其中“经常”表示很大一部分时间。）

补充：不要只看每秒执行多少次代码。它可能每秒 1,000 次，但仍然使用不到 1% 的时间。

也不要计算需要多长时间。这可能需要一毫秒，但仍然使用不到 1% 的时间。

您可以将两者相乘以获得更好的主意，但这仅在它们不太偏斜的情况下才有效。

[对调用堆栈进行采样](https://stackoverflow.com/questions/375913/what-can-i-use-to-profile-c-code-in-linux/378024#378024)将告诉您它是否使用了足够高的时间百分比。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-28T02:58:43.920

我总是喜欢第一个。尽管使用内联函数、编译器优化和相对较小的容器大小（在我的情况下，通常最多 20-25 个项目），但它在性能方面确实没有太大差异。

```
const_iterator it = list.begin();
const_iterator endIt = list.end();

for(; it != endIt ; ++it)
{//do something
} 
```

但最近我尽可能使用更多的[std::for_each 。](http://www.sgi.com/tech/stl/for_each.html)它优化的循环有助于使代码看起来比其他两个更具可读性。

```
std::for_each(list.begin(), list.end(), Functor()); 
```

`std::for_each`只有在无法使用时，我才会使用循环。（例如：`std::for_each`除非引发异常，否则不允许您中断循环）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-28T02:45:21.893

理论上，编译器可以将第二个版本优化为第一个版本（显然，假设容器在循环期间没有改变）。

在实践中，我在分析时间关键代码时发现了几个类似的情况，其中我的编译器完全无法将不变计算提升到循环条件之外。因此，虽然在大多数情况下稍微更简洁的版本都可以，但在我真正关心性能的情况下，我不依赖编译器对其进行明智的处理。

# visual-studio-2008 - 如何部署VS2008 express桌面项目？

> ID：795993
> 
> 赞同：3
> 
> 时间：2009-04-28T02:21:58.377
> 
> 标签：visual-studio-2008, deployment, installation, desktop-application, visual-studio-express

我想知道如何将其部署/制作到使用 vs 2008 express 创建的应用程序的安装程序中。我知道设置和部署功能只能通过完整版的 Visual Studio 获得，对吗？

那么，如果必须达到我可以用来执行此操作的功能，是否有任何附加组件或可能是额外的免费/或非免费？

还是最好的工具是vs 6.0时代的旧Visual Studio安装程序？:)

谢谢

**更新**：经过一番谷歌搜索，我发现[这个链接使用 click once 来部署 vs 2008 express，里面有教程](http://blogs.msdn.com/vbteam/archive/2008/10/02/looking-for-setup-and-deployment-project-templates.aspx)，我会检查一下，但当然欢迎更多和更好的推荐:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T02:24:57.170

[WiX 非常棒。](http://wix.sourceforge.net/) 这也是一篇[很好的 MSDN 文章](http://msdn.microsoft.com/en-us/magazine/cc163456.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T02:34:06.680

我肯定会推荐 ClickOnce。这就是我分发[Comicster](http://comicster.net)的方式（我自己使用 C# Express 编写的爱好项目）。它也处理您的应用程序的更新，这非常好。

如果您无法部署到网站，ClickOnce 还支持部署到文件夹以进行基于文件的安装（例如 CD 或网络共享）。

# c# - 可以在使用 asp.net 按钮回发后运行 javascript 函数吗？

> ID：795998
> 
> 赞同：2
> 
> 时间：2009-04-28T02:23:27.343
> 
> 标签：c#, asp.net, javascript

我正在尝试实现一个网页，该网页将在 asp.net 提交按钮上单击将转到服务器以向 SQL 数据库表添加一行。之后，在同一页面上，我希望能够使用 javascript 将 columnID 显示为警报（这必须是 javascript）。这可能吗？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-06-10T10:15:12.073

Telerik 的另一个技巧是创建一个 asp:Label 并将其放在页面顶部。然后从您后面的代码中将文本设置为 javascript 命令：

```
aspLabel.Text = "JavascriptFunction();"; 
```

当您的页面重新加载时，它将执行 Javascript 函数。在您的情况下，您似乎只对显示和警报感兴趣，因此不需要注册脚本。在您的情况下，您可以执行以下操作：

```
aspLabel.Text = "alert('" + yourValue.ToString() + "');"; 
```*************