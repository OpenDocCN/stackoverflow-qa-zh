# StackOverflow 问答 11871000-11871999

# css - 将左侧 div 与右侧内容的底部对齐

> ID：11871008
> 
> 赞同：0
> 
> 时间：2012-08-08T18:39:40.493
> 
> 标签：css, css-float

我的html结构如下：

```
<div class="pagebody">
 <div class="pageleft">
      <div class="sidebarmenu">
      </div>
      <div class="sidebarbottom">
      </div>
 </div>   <!--  end pageleft  -->

 <div class="pageright">
      ...
      ...
      ...
 </div>   <!--  end pageright  -->

 <div class="clear"></div>

 </div>   <!--  end pagebody  --> 
```

CSS是

```
.pagebody {
width:960px;
text-align:left;
margin:0 auto;
}
.pageleft {
width:333px;
float:left;
position:relative;
padding:24px 0 0 37px;
min-height:100%;
height: auto !important;
height: 100%;
margin: 0 auto -301px;
}
.pageright {
width:590px;
float:right;
padding-top:29px;
min-height:1200px;
}
.sidebarmenu {
margin-right:72px;
font:15px Helvetica, Arial, sans-serif;
}
.sidebarbottom {
margin-left:10px;
position:absolute;
bottom:0;
    height:301px;
} 
```

“pageright”内容的高度不固定，并且会有所不同。我想将“sidebarbottom”与“pageright”的底部对齐。尝试使用绝对和相对位置但不工作。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:07:07.910

这是你想要达到的目标吗[http://jsfiddle.net/2cUJS/](http://jsfiddle.net/2cUJS/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T21:11:30.323

我找到了解决方案。

在 <div class="pagebody"></div> 下面会有另一个重复：-

```
<div class="pagebody">
  <div class="pageleft">
    <div class="sidebarmenu">
    </div>
  </div>   <!--  end pageleft  -->

  <div class="pageright">
  ...
  ...
  ...
  </div>   <!--  end pageright  -->

  <div class="clear"></div>

</div>   <!--  end pagebody (1) -->

<div class="pagebody">
  <div class="pageleft">
    <div class="sidebarbottom">
    </div>
  </div>   <!--  end pageleft  -->

  <div class="pageright">
   &nbsp;
  </div>   <!--  end pageright  -->

  <div class="clear"></div>

</div>   <!--  end pagebody (2) --> 
```

这行得通！

# php - 除冠词、连词和介词外，每个单词的首字母大写

> ID：11871017
> 
> 赞同：2
> 
> 时间：2012-08-08T18:40:17.040
> 
> 标签：php, codeigniter, tags

我正在为使用 Codeigniter 构建的自定义 CMS 编写标签系统，并且正在尝试强制执行特定格式。

基本上，我需要将每个单词的第一个字母大写，但以下内容除外，应为小写：

*   文章：一个，一个，的
*   并列连词：and、but、or、for、nor 等。
*   介词（少于五个字母）：with、on、at、to、from、by 等。

此外，如果标签以上述之一开头，则应大写。

格式正确的标签的一些示例：

*   权力的游戏
*   人鼠之间
*   从头到尾
*   指环王
*   极品飞车

到目前为止，我只有：

```
$tag = 'Lord of the Rings';
$tag = ucwords($tag); 

$patterns = array('/A/', '/An/', '/The/', '/And/', '/Of/', '/But/', '/Or/', '/For/', '/Nor/', '/With/', '/On/', '/At/', '/To/', '/From/', '/By/' );
$lowercase = array('a', 'an', 'the', 'and', 'of', 'but', 'or', 'for', 'nor', 'with', 'on', 'at', 'to', 'from', 'by' );

$formatted_tag = preg_replace($patterns, $lowercase, $tag);

// capitalize first letter of string
$formatted_tag = ucfirst($formatted_tag);

echo $formatted_tag; 
```

这会产生*Lord of the Rings*的正确结果，但是如何避免重复数组？当我添加新单词时，将它们匹配起来很乏味。

我确定应该包含一些我缺少的单词，是否有任何现有的函数或类可以使用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-08T18:46:32.303

如果您`$lowercase`将自定义回调与[`preg_replace_callback()`](http://php.net/preg_replace_callback). 此外，您当前的方法需要单词边界，否则它将替换`Android`为`android`或。最后，为 N 个单词创建 N 个正则表达式效率低下且没有必要，因为这可以通过一个正则表达式来完成。`bAnd``band`

我只会保留一个单词数组：

```
$words = array('A', 'An', 'The', 'And', 'Of', 'But', 'Or', 'For', 'Nor', 'With', 'On', 'At', 'To', 'From', 'By' ); 
```

并创建**一个**动态正则表达式，完成单词边界，如下所示：

```
$regex = '/\b(' . implode( '|', $words) . ')\b/i'; 
```

现在将所有匹配项替换为小写对应项：

```
$formatted_tag = preg_replace_callback( $regex, function( $matches) {
    return strtolower( $matches[1]);
}, $tag); 
```

# bash - 如何从管道中获取我的进程 ID？

> ID：11871019
> 
> 赞同：0
> 
> 时间：2012-08-08T18:40:19.530
> 
> 标签：bash

嗨，如果这看起来很恶心，请原谅我刚刚开始学习如何编写脚本。

无论发生什么，我都想在 65 秒后杀死 vlc，但如果它在那段时间与源断开连接，我想杀死它并使用新的输出文件名重新启动它。

```
#!/bin/bash

function record {
  DATE=$(date "+%d%m%y%H%M%S%N");

  cvlc -vR rtsp://192.168.1.233 \
      --sout=file/mov:/var/www/continuous/%1/$DATE.mov 2>& 1 |

  while read event;
  do
    PID=$!
    lastevent=${event#*]}
    if [ "$lastevent" == "live555 demux warning: no data received in 10s, eof ?" ];
    then
      kill $PID
      record
    fi
  done
}

record &
sleep 65
kill $PID 
```

麻烦是$！没有得到正确的pid，所以我不能杀死它。我需要得到vlc的pid。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:07:54.103

`$!`*仅适用于显式*置于后台的进程。

这里介绍的语法几乎可以在 ksh 中使用，其中`|&`具有不同的含义：它将命令作为协同进程置于后台，这意味着您可以`read`从协同进程中使用`read -p event`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T18:45:24.610

你的想法`$!`是错误的。在这里使用要好得多`pkill -P$$`。

例子：

```
cvlc -vR rtsp://192.168.1.233 \
    --sout=file/mov:/var/www/continuous/%1/$DATE.mov | while read event; do
  lastevent=${event#*]}
  if [ "$lastevent" == "live555 demux warning: no data received in 10s, eof ?" ];
  then
    pkill -P$$ cvlc
  fi
done 
```

使用`pkill -P$$ cvlc`你将杀死`cvlc`由 shell 启动的那个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T19:44:49.320

这是我最后使用的解决方案（这个脚本的名字是vlcrecorder）。

它获取自己的子进程 (pgrep) 的 pid，因为该函数调用自己，所以它必须遍历子进程、孙子进程、曾孙子进程等，直到在树的底部找到 vlc 的 pid。

感谢所有帮助过我的人。

```
#!/bin/bash
function record {
DATE=$(date "+%d%m%y%H%M%S%N");
cvlc -v -R rtsp://$1/$2 --sout=file/mov:/var/www/continuous/2/$DATE.mov |&
while read event;
do
lastevent=${event#*]}
echo $lastevent
if [[ "$lastevent" == *"live555 demux warning: no data received in 10s, eof ?"* ]]; then
sleep .1
ppid=$(pgrep -P $$ -x vlcrecorder)
vlcpid=$(pgrep -P $ppid -x vlc)
until [ -z "$ppid" ]; do
vlcppid=$vlcgppid
vlcgppid=$ppid
ppid=$(pgrep -P $ppid -x vlcrecorder)
done
vlcpid=$(pgrep -P $vlcppid -x vlc)
kill $vlcpid
record $1 $2 
fi
done
}

record $1 $2 &
sleep 65
parentpid=$!
until [ -z "$parentpid" ]; do
gppid=$parentpid
parentpid=$(pgrep -P $parentpid -x vlcrecorder)
lastvlcpid=$(pgrep -P $gppid -x vlc)
if [ -n "$lastvlcpid" ]; then
kill $lastvlcpid
fi
done 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-09T18:38:05.870

也许您可以将 的输出写入`cvlc`命名管道，然后将其踢到后台，这样您就可以使用`$!`. 然后，您从命名管道中读取并`cvlc`在您的时间限制结束时被杀死。

```
# create the named pipe
MYPIPE=/tmp/cvlc_pipe_$$
rm -f ${MYPIPE} # remove the named pipe in case it already exist
mkfifo ${MYPIPE}

function record {
  DATE=$(date "+%d%m%y%H%M%S%N");

  # have cvlc write to the named pipe in the background, then get its pipe with $1
  cvlc -vR rtsp://192.168.1.233 \
      --sout=file/mov:/var/www/continuous/%1/$DATE.mov > ${MYPIPE} 2>& 1 &&
  PID=$!

  # read cvlc's output from the named pipe
  exec 7<>${MYPIPE}
  while read -u 7 event;
  do  
    PID=$!
    lastevent=${event#*]}
    if [ "$lastevent" == "live555 demux warning: no data received in 10s, eof ?" ];
    then
      kill $PID
      record
    fi  
  done
  exec 7>&-
}

record &
sleep 65
kill $PID
rm -f ${MYPIPE} # cleanup 
```

# facebook - Facebook 聊天 API 是否支持阅读以前的聊天消息？

> ID：11871020
> 
> 赞同：2
> 
> 时间：2012-08-08T18:40:21.157
> 
> 标签：facebook, chat, facebook-chat

我看到那里有许多支持 FB 聊天的第 3 方客户端，但是从在第 3 部分客户端中开始对话之前，是否有任何会在聊天中显示以前的消息（类似于 FB Messages iPhone 应用程序的方式作品）？

到目前为止，我已经检查了 Adium 和 Trillion（仅限 OSX 版本），它们只显示当前对话中发送的消息。

简而言之，公共 API 是否有足够的支持来构建允许离线消息传递的聊天应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T09:55:10.143

不，但您可以使用 REST API 调用**/me/inbox**来检索历史记录，我们在[ChattAR for Facebook](http://quickblox.com/developers/Chattar)示例应用程序中使用它，它是开放项目

# numerical-methods - 测试凸优化代码

> ID：11871021
> 
> 赞同：0
> 
> 时间：2012-08-08T18:40:23.997
> 
> 标签：numerical-methods, convex-optimization

我想为我已经实现的一组凸优化方法（梯度下降、共轭梯度、BFGS 等）创建一套测试问题。

理想情况下，我会知道问题的确切解决方案，然后检查这些算法是否得到了足够接近的答案。

目前，我正在为多元高斯做最大似然（并使用上述基于梯度的方法而不是封闭形式的答案）。

你还有什么推荐的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T17:16:09.400

求 x 以最小化 ||A*xb||。如果 b 是 A*y，并且 A 是 1-1，则唯一解是 y。如果范数是通常的范数，那么这只是线性最小二乘法，但对于任何范数来说，问题都是凸的。通过选择具有大条件数的 A，您可以在数值上使问题变得困难。

# macos - AppleScript 返回“不允许用户交互”

> ID：11871022
> 
> 赞同：6
> 
> 时间：2012-08-08T18:40:29.117
> 
> 标签：macos, applescript

我尝试使用以下命令从控制台调用一个简单的消息框：

```
osascript -e "display dialog \"hello\"" 
```

但它返回：

```
execution error: No user interaction allowed. (-1713) 
```

有解决方法吗？

编辑：

解决方法是：`tell application "AppleScript Runner" to display dialog "Hello"`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-08T23:45:53.877

您可以告诉 SystemUIServer 之类的后台进程显示对话框。默认情况下关闭对话框后，先前聚焦的窗口不会重新获得焦点。如果系统事件和 AppleScript Runner 之前没有运行，它们可能会有一些延迟。

```
answer=$(osascript -e 'try
tell application "SystemUIServer"
set answer to text returned of (display dialog "" default answer "")
end
activate app (path to frontmost application as text)
answer
end' | tr '\r' '\n')
[[ -z "$answer" ]] && exit 
```

您也可以告诉最前面的应用程序显示一个对话框，但它通常会稍微慢一些。如果应用程序没有响应，对话框不会立即显示。如果 MPlayer OS X 位于最前面，则文本对话框不接受任何键盘输入。

```
answer=$(osascript -e 'try
tell application (path to frontmost application as text)
text returned of display dialog "" default answer ""
end
end' | tr '\r' '\n')
[[ -z "$answer" ]] && exit 
```

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2012-08-08T18:57:12.923

See this question for a solution, it contains an example that works from the console:

["No user interaction allowed" When running AppleScript in python](https://stackoverflow.com/questions/13484482/no-user-interaction-allowed-when-running-applescript-in-python)

# c++ - 用于 C++ 解析器的带有图像和文本层的最简单文件格式

> ID：11871025
> 
> 赞同：0
> 
> 时间：2012-08-08T18:40:42.300
> 
> 标签：c++, parsing, layer, file-format, psd

我正在寻找最简单且具有以下特点的文件格式：

1.  带有图像的图层（具有透明度）
2.  带有文本的图层（我只需要字体名称、颜色、大小、位置和文本内容本身）

我知道 .psd 具有这些功能，但它非常复杂，我没有找到很好的解析器，它有很多我根本不需要的功能，但我必须处理它们来解析文件。

完美的解决方案是易于从 Photoshop 创建/导出的文件格式（例如 tif，但它没有文本图层）。

文件格式的另一个专业人士将是现有的（例如 LGPL），简单的（！）C/C++ 解析器类。

你知道任何这样的文件格式吗？

# c - 自动 3G 调制解调器发现

> ID：11871026
> 
> 赞同：3
> 
> 时间：2012-08-08T18:40:46.173
> 
> 标签：c, linux, cellular-network

**背景**

我目前正在使用 Linux 和 C 构建一个软件，以`3G`自动并同时建立和监控与多个调制解调器的连接。这目前运作良好。

我正在阅读该`/proc/tty/driver/usbserial`文件以发现所有 GSM 调制解调器。

然后我有一个调制解调器设备 ID 的列表，它告诉我要使用的接口 (ttyUSBX)`pppd`以及用于 AT 命令（网络名称、RSSI 等）的接口。

列表条目包含；

*设备 ID (12d1:1001) ,serial tty (3) ,modem tty (1)*

这意味着对于设备`12d1:1001`，第一个`ttyUSB`关联的应该用于调制解调器，第三个用于`AT`命令，第二个不使用。

**问题：** 我想尝试做的是删除对这个列表的需要。有什么方法可以轻松发现哪个接口应该用于 AT 命令以及哪个接口用于调制解调器 ppp 链接？

# iphone - ViewController 架构

> ID：11871029
> 
> 赞同：0
> 
> 时间：2012-08-08T18:41:08.060
> 
> 标签：iphone, objective-c, model-view-controller, architecture, uiviewcontroller

我想构建一个具有一个主视图的应用程序，该主视图大部分时间都在屏幕上。部分视图是不变的并显示主要控件。但是，有一个特殊的子视图取决于应用程序的状态。应用程序的状态以特殊的“状态对象”呈现。一次只能有一个“状态对象”处于活动状态，但它们可以有非常不同的逻辑，并且应该以不同的用户界面呈现（在这个特殊的子视图中）。

显然，我可以通过分析当前状态对象的类型，在主视图的ViewController中进行处理。我可以创建一个 biiiig 开关，其中包含大量特定于状态对象可能具有的每个可能的类的代码，并在每次添加新的状态对象子类时添加一些代码......但这听起来不是一个好的架构大部头书。我希望状态对象或特定于它们的不同 ViewController 来控制这个特殊的视图。不幸的是，我对视图、视图控制器和委托感到有点迷茫，不明白我究竟如何才能做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T18:51:44.103

如果您需要在这些 slate 视图中处理大量逻辑内容，您可能希望将它们作为视图控制器，然后在需要时使用容器方法将它们添加到主视图控制器，如[Session 102 - Implementing UIViewController Containment](https://developer.apple.com/videos/wwdc/2011/?id=102)中所示。基本上是这样的：

```
[self addChildViewController:childViewController];
[childViewController didMoveToParentViewController:self];
[self.view addSubView:childViewController.view]; 
```

您甚至可以使用此方法进行过渡动画：`transitionFromViewController: toViewController: duration: options: animations: completion:`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T18:58:14.267

It is important to remember that the View Controller and the UI (XIB) are two different things. You can implement a controller to handle the logic of your various subviews and then bind that instance of your controller to a different UI based on context using init with NibName...

This allows you to write your controlling logic once and spawn as many different and varied UI experiences as you need. The XIBs would all need to tie back to a centralized set of IBOutlets and you will be all set. Chances are there are large areas of similarity ion the sub-views given they still live in the overall context of your app. This strategy of one view controller to potentially many XIBs helps simplify development along those lines.

Good Luck.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T19:32:00.563

每个不同的子视图类型都是一个单独的视图控制器，具有自己的关联视图。

# c# - 正方体训练问题

> ID：11871031
> 
> 赞同：1
> 
> 时间：2012-08-08T18:41:16.767
> 
> 标签：c#, ocr, tesseract, anpr

我正在尝试将某些车牌图像训练为特定字体。我想知道在训练时我应该把 unicharambigs 文件放在哪里。我有一个没有 unicharambigs 文件的数据集。但是当我在我的代码中包含 tessdata 文件夹时，它在运行时抛出了一个异常，说“尝试读取或写入受保护的内存。这通常表明其他内存已损坏。”。我是使用 tesseract 的新手 我有几个问题需要澄清，因为我相信上述异常是由于以下问题之一而发生的

1) 必须拥有 unicharambigs 文件吗？如果是这样，在创建最终训练数据之前我应该​​把这个文件放在哪里？

2) 与 C# 代码集成时，tessdata 文件夹中应考虑哪些文件？

我一直在使用预训练的数据集进行测试，但我想拥有自己的数据集，并且当我使用该 tessdata 文件夹时，应用程序不会因上述运行时异常而退出。因此我相信这与我自己的 tessdata 文件夹有关。

**更新**

只是为了补充这个问题。当我使用由 tesseract 安装创建的默认 tessdata 文件夹时，应用程序工作正常，但结果错误。我再次训练了 tesseract 并将现有的训练数据文件替换为训练后生成的新训练数据文件，我的应用程序再次崩溃。

我正在使用 C# 和 tesseract 点网包装器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-12T10:06:35.710

实际上这里的问题是受过训练的 tessedata 和 tesseract DLL 的版本不匹配。我猜受过训练的 tessedata 是最新的 >3.0 版本，因为旧版本（2.0）dll 抛出异常，例如尝试读取或写入受保护的内存“所以请尝试使用最新的tesseract dll . [https://github.com/charlesw/tesseract/tree/master/Samples](https://github.com/charlesw/tesseract/tree/master/Samples) 从上面的链接下载示例项目并测试您的训练数据，它有 Nuget tesseract 包的参考，因此这将支持 Tesseract 3.02 训练的 tessedata。

# c++ - 所有者绘制的窗口

> ID：11871033
> 
> 赞同：0
> 
> 时间：2012-08-08T18:41:21.110
> 
> 标签：c++, winapi, listbox, ownerdrawn

我没有成功绘制自己的列表框，代码如下：

```
LRESULT CALLBACK ListBoxProcedure(HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam)
{
        switch (msg)
        {
               case WM_DRAWITEM:
                    LPDRAWITEMSTRUCT Item;
                    Item = (LPDRAWITEMSTRUCT)lParam;

                if (Item->itemState == ODS_SELECTED)
                {
                    FillRect(Item->hDC, &Item->rcItem, CreateSolidBrush(0));
                    SetTextColor(Item->hDC, 0x0000FF);
                }
                else
                {
                    SetBkColor(Item->hDC, 0);
                    FillRect(Item->hDC, &Item->rcItem, (HBRUSH)GetStockObject(BLACK_BRUSH));
                    SetTextColor(Item->hDC, 0xFFFFFF);
                }
                LPSTR lpBuff;
                SendMessageA(Item->hwndItem , LB_GETTEXT, Item->itemID, (LPARAM)lpBuff);
                TextOutA(Item->hDC, Item->rcItem.left, Item->rcItem.top, (lpBuff), strlen(lpBuff)-1);
                if (Item->itemState & ODS_FOCUS)
                {
                   DrawFocusRect(Item->hDC, &Item->rcItem);
                }
                return true;
                break;
           case WM_MEASUREITEM:
                break;
           default:
                   DefWindowProcA(hwnd, msg, wParam, lParam);
    }
    return 0;
} 
```

我像这样创建 ListBox：

```
lbLogs = CreateWindowExA(0, "LISTBOX", "", WS_VISIBLE + WS_CHILD + WS_BORDER + LBS_HASSTRINGS + LBS_NOINTEGRALHEIGHT + WS_TABSTOP, 15, 115, 515, 180, hwnd, (HMENU)1005, hInstance, NULL);
         //-----------------------------
         SetWindowLong(lbLogs, GWL_WNDPROC, (LONG)&ListBoxProcedure); 
```

有人可以向我解释其中有什么问题吗？我正在尝试制作一个具有黑色背景和红色文本的列表框，当一个项目被选中时，它的文本将转换为白色。但列表框不添加任何内容。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T19:19:43.203

您正在创建一个列表框，然后安装您自己的 WNDPROC 来处理发送到列表框的消息。*但是，自绘列表框会向其所有者*发送 WM_MEASUREITEM 和 WM_DRAWITEM 消息，因此您需要在父窗口的 WNDPROC，而不是列表框 WNDPROC 中处理这些消息。

此外，即使子类化是正确的方法（在这种情况下不是这样），您的子类 WNDPROC 也应该将未处理的消息传递给原始列表框 WNDPROC，而不是 DefWindowProc()。绕过原始列表框 WNDPROC 很可能会导致麻烦。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-08T18:58:33.857

`LBS_OWNERDRAW...`创建 ListBox 时，您没有指定任何窗口样式。这些消息也会发送到 ListBox 的父窗口，而不是 ListBox 本身，因此您需要在`WindowProcedure()`而不是`ListBoxProcedure()`. 这就是为什么您没有收到任何`WM_MEASUREITEM`消息`WM_DRAWITEM`的原因。

您必须执行该`WM_MEASUREITEM`消息，而不是像现在这样丢弃它。

在将基于位的标志组合在一起时，您需要使用`|`运算符而不是运算符，例如窗口样式。`+`

您没有正确使用`LB_GETTEXT`消息或`DefWindowProc()`功能。

试试这个：

```
#include <windows.h>
#include <tchar.h>

LRESULT CALLBACK WindowProcedure (HWND, UINT, WPARAM, LPARAM);

const TCHAR szClassName[] = TEXT("JMBSoftwares");

HWND hMainWnd, btnClose, btnMinimize, txtFileName, btnLoad, btnGo, lbLogs;

WINAPI _tWinMain (HINSTANCE hThisInstance,
                    HINSTANCE hPrevInstance,
                    LPTSTR lpszArgument,
                    int nFunsterStil)
{
    WNDCLASSEX wincl = {0};
    wincl.hInstance = hThisInstance;
    wincl.lpszClassName = szClassName;
    wincl.lpfnWndProc = WindowProcedure;
    wincl.style = CS_DBLCLKS;
    wincl.cbSize = sizeof (WNDCLASSEX);
    wincl.hIcon = LoadIcon (NULL, IDI_APPLICATION);
    wincl.hIconSm = LoadIcon (NULL, IDI_APPLICATION);
    wincl.hCursor = LoadCursor (NULL, IDC_ARROW);
    wincl.lpszMenuName = NULL;
    wincl.cbClsExtra = 0;
    wincl.cbWndExtra = 0;
    wincl.hbrBackground = CreateSolidBrush(0);

    if (!RegisterClassEx (&wincl))
        return 0;

    hMainWnd = CreateWindowEx (
           0,
           szClassName,
           TEXT("JMB Encryptor - V1.0"),
           WS_VISIBLE | WS_DLGFRAME,
           CW_USEDEFAULT,
           CW_USEDEFAULT,
           544,
           375,
           HWND_DESKTOP,
           NULL,
           hThisInstance,
           NULL
           );

    if (!hMainWnd)
        return 0;

    SetWindowLong(hMainWnd, GWL_STYLE, GetWindowLong(hMainWnd, GWL_STYLE) & ~(WS_BORDER | WS_DLGFRAME));
    ShowWindow (hMainWnd, nFunsterStil);

    MSG messages;
    while (GetMessage (&messages, NULL, 0, 0) > 0)
    {
        TranslateMessage(&messages);
        DispatchMessage(&messages);
    }

    return 0;
}

void DrawMyText(HDC hDC, COLORREF Color, DWORD Size, DWORD X, DWORD Y, LPTSTR FontName, LPTSTR Text, BOOL SolidBG)
{
    HFONT hFont = CreateFont(Size, 0, 0, 0, FW_NORMAL, 0, 0, 0, DEFAULT_CHARSET, OUT_DEFAULT_PRECIS, CLIP_DEFAULT_PRECIS, DEFAULT_QUALITY, DEFAULT_PITCH, FontName);
    if (!hFont) return;

    HFONT hOldFont = (HFONT) SelectObject(hDC, hFont);

    int iOldBkMode;
    if (!SolidBG)
        iOldBkMode = SetBkMode(hDC, TRANSPARENT);
    else
    {
        SetBkColor(hDC, RGB(0, 0, 0));
        iOldBkMode = SetBkMode(hDC, OPAQUE);
    }

    COLORREF clrOldColor = SetTextColor(hDC, Color);
    TextOut(hDC, X, Y, Text, lstrlen(Text));
    SetTextColor(hDC, clrOldColor);
    SetBkMode(hDC, iOldBkMode);

    SelectObject(hDC, hOldFont);
    DeleteObject(hFont);
}

LRESULT CALLBACK WindowProcedure (HWND hwnd, UINT message, WPARAM wParam, LPARAM lParam)
{
    switch (message)
    {
        case WM_DESTROY:
            PostQuitMessage (0);
            break;

        case WM_CREATE:
        {
             HINSTANCE hInstance = GetModuleHandle(NULL);
             btnClose = CreateWindowEx(0, TEXT("STATIC"), TEXT("X"), WS_VISIBLE | WS_CHILD | SS_NOTIFY, 530, 1, 10, 15, hwnd, (HMENU)1001, hInstance, NULL);
             btnMinimize = CreateWindowEx(0, TEXT("STATIC"), TEXT("_"), WS_VISIBLE | WS_CHILD | SS_NOTIFY, 515, -3, 10, 18, hwnd, (HMENU)1002, hInstance, NULL);
             txtFileName = CreateWindowEx(0, TEXT("EDIT"), TEXT(""), WS_VISIBLE | WS_CHILD, 75, 40, 280, 15, hwnd, NULL, hInstance, NULL);
             btnLoad = CreateWindowEx(0, TEXT("STATIC"), TEXT("Load a file"), WS_VISIBLE | WS_CHILD | WS_BORDER | SS_NOTIFY | SS_CENTER, 380, 38, 150, 20, hwnd, (HMENU)1003, hInstance, NULL);
             btnGo = CreateWindowEx(0, TEXT("STATIC"), TEXT("Protect my file!"), WS_VISIBLE | WS_CHILD | WS_BORDER | SS_NOTIFY | SS_CENTER, 380, 70, 150, 20, hwnd, (HMENU)1004, hInstance, NULL);
             lbLogs = CreateWindowEx(0, TEXT("LISTBOX"), TEXT(""), WS_VISIBLE | WS_CHILD | WS_BORDER | LBS_HASSTRINGS | LBS_NOINTEGRALHEIGHT | LBS_OWNERDRAWVARIABLE | LBS_NOTIFY | WS_TABSTOP, 15, 115, 515, 180, hwnd, (HMENU)1005, hInstance, NULL);
             break;
        }

        case WM_COMMAND:
        {
             switch (wParam)
             {
                    case 1004: //Protect my File!
                    {
                         SendMessage(lbLogs, LB_ADDSTRING, 0, (LPARAM)TEXT("TEST"));
                         break;
                    }
             }
             break;
        }

        case WM_PAINT:
        {
             PAINTSTRUCT ps;
             HDC hDC = BeginPaint(hwnd, &ps);
             HPEN hPen = CreatePen(PS_SOLID, 3, 0x0000FF);
             HPEN hOldPen = (HPEN) SelectObject(hDC, hPen);
             HBRUSH hOldBrush = (HBRUSH) SelectObject(hDC, GetStockObject(NULL_BRUSH));
             Rectangle(hDC, 1, 1, 544, 374);
             DrawMyText(hDC, RGB(0xFF, 0xFF, 0xFF), 15, 1, 3, TEXT("Arial Black"), TEXT("JMB Encryption V1.1"), FALSE);
             MoveToEx(hDC, 1, 20, NULL);
             LineTo(hDC, 544, 20);
             MoveToEx(hDC, 1, 354, NULL);
             LineTo(hDC, 544, 354);
             DrawMyText(hDC, RGB(0xFF, 0xFF, 0xFF), 15, 1, 357, TEXT("Arial Black"), TEXT("Written by João Marcelo Brito - BETA Version"), FALSE);
             DrawMyText(hDC, RGB(0xFF, 0xFF, 0xFF), 12, 10, 42, TEXT("Arial Black"), TEXT("File Name:"), FALSE);
             DrawMyText(hDC, RGB(0xFF, 0xFF, 0xFF), 15, 10, 70, TEXT("Arial Black"), TEXT("You can also use Drag and Drop"), FALSE);
             MoveToEx(hDC, 75, 56, NULL);
             LineTo(hDC, 360, 56);
             Rectangle(hDC, 10, 110, 534, 300);
             DrawMyText(hDC, RGB(0xFF, 0xFF, 0xFF), 12, 25, 105, TEXT("Arial Black"), TEXT("Logs "), TRUE);
             SelectObject(hDC, hOldPen);
             SelectObject(hDC, hOldBrush);
             DeleteObject(hPen);
             EndPaint(hwnd, &ps);
             break;
        }

        case WM_CTLCOLORSTATIC:
        {
             SetBkMode((HDC)wParam, TRANSPARENT);
             SetTextColor((HDC)wParam, 0x0000FF);
             return (LRESULT)GetStockObject(NULL_BRUSH);
        }

        case WM_CTLCOLOREDIT:
        {
             SetBkColor((HDC)wParam, 0);
             SetTextColor((HDC)wParam, 0x0000FF);
             break;
        }

        case WM_DRAWITEM:
        {
            LPDRAWITEMSTRUCT Item = (LPDRAWITEMSTRUCT)lParam;
            if (Item->CtlID == 1005)
            {
                if (Item->itemID != -1)
                {
                    if (Item->itemState == ODS_SELECTED)
                    {
                        FillRect(Item->hDC, &Item->rcItem, CreateSolidBrush(0));
                        SetTextColor(Item->hDC, 0x0000FF);
                    }
                    else
                    {
                        SetBkColor(Item->hDC, 0);
                        FillRect(Item->hDC, &Item->rcItem, (HBRUSH)GetStockObject(BLACK_BRUSH));
                        SetTextColor(Item->hDC, 0xFFFFFF);
                    }

                    int len = SendMessage(Item->hwndItem , LB_GETTEXTLEN, Item->itemID, 0);
                    if (len > 0)
                    {
                        LPTSTR lpBuff = new TCHAR[len+1];
                        len = SendMessage(Item->hwndItem , LB_GETTEXT, Item->itemID, (LPARAM)lpBuff);
                        if (len > 0)
                            TextOut(Item->hDC, Item->rcItem.left, Item->rcItem.top, lpBuff, len);
                        delete[] lpBuff;
                    }
                }

                if (Item->itemState & ODS_FOCUS)
                {
                    DrawFocusRect(Item->hDC, &Item->rcItem);
                }

                return TRUE;
            }
            break;
        }

        case WM_MEASUREITEM:
        {
            MEASUREITEMSTRUCT *mis = (MEASUREITEMSTRUCT*) lParam;
            if (mis->CtlID == 1005)
            {
                mis->itemHeight = 15; // your desired item height, in pixels
                return TRUE;
            }
            break;
        }

        default:
            return DefWindowProc (hwnd, message, wParam, lParam);
    }

    return 0;
} 
```

# sql-server-2005 - '%%' 丢弃结果

> ID：11871036
> 
> 赞同：1
> 
> 时间：2012-08-08T18:41:30.487
> 
> 标签：sql-server-2005, stored-procedures, autocomplete

我在 sql server 2005 中编写了一个用于搜索结果的存储过程。

SP

```
SELECT RTRIM(DEPT_DESC) DEPT_DESC, RTRIM(DEPT_ID) DEPT_ID
FROM T_ROLLUP_DEPT
WHERE DEPT_ID like @SearchText + '%' OR DEPT_DESC like '%%' 
```

我添加了“%%”来帮助它在列中搜索。

即，如果我们正在搜索 Medical Controller，它将允许我们键入“CONTRO”，它会产生结果 Medical Controller。

然而，这也引起了一些头痛。似乎如果我按 dept_id 搜索并输入“2”，它会显示所有结果。不仅是以 2 开头的部门 ID。此外，如果我输入一堆随机数，它也会返回所有结果。

任何人都知道为什么以及如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T18:53:17.917

这就像说`.. OR 1 = 1`¹ .. 是否有*任何*搜索输入不返回所有结果？（我怀疑不是。）

也许应该`.. OR DEPT_DESC like '%' + @SearchText + '%'`改为？包含搜索文本时将匹配`DEPT_DESC`..

¹其实相当于说`.. OR DEPT_DESC IS NOT NULL`in that`LIKE '%%'`会匹配每一个非NULL字符串。

# php - 带有数组参数的准备好的语句 WHERE ... IN (...)

> ID：11871037
> 
> 赞同：1
> 
> 时间：2012-08-08T18:41:32.617
> 
> 标签：php, mysqli

就我而言，我正在从多个表中删除，`LEFT JOIN`并且需要提供要删除的问题 ID 数组。问题 id 的数组是`$questions_to_delete`.

无法通过将数组作为参数绑定`mysqli`是一种痛苦，我已经查看了一些 SO 问题来得出这个结论：

```
$params = implode(',', array_fill(0, count($questions_to_delete), '?'));
$types = array_fill(0, count($questions_to_delete), 'i');
$delete_questions = $mysqli->prepare('DELETE    ...
                                          FROM questions
                                          LEFT JOIN ...
                                          WHERE questions.id IN ('.$params.')');

call_user_func_array(array(&$delete_questions, 'bind_param'), array_merge($types, $questions_to_delete));
$delete_questions->execute();
$delete_questions->close(); 
```

我得到的错误是

**警告**：mysqli_stmt::bind_param() [mysqli-stmt.bind-param]：类型定义字符串中的元素数与绑定变量数不匹配

我注意到一些答案使用了`&$delete_questions`vs `$delete_questions`，但我对 PHP 抱怨的内容感到困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:20:24.503

我没有正确`$types`合并`$questions_to_delete`！在我的原始代码中：

```
// Produces ['i', 'i', 'i', ...]
$types = array_fill(0, count($questions_to_delete), 'i');

// The argument (array_merge) is then ['i', 'i', ..., 'id1', 'id2', ...]
call_user_func_array(array($delete_questions, 'bind_param'), array_merge($types,$questions_to_delete)); 
```

最终对我有用的是：

```
// Produces 'iii..'
$types = str_repeat('i', $questions_to_delete);

// The argument (array_merge) is then ['iii...', 'id1', 'id2', ...]
call_user_func_array(array($delete_questions, 'bind_param'), array_merge(array($types),$questions_to_delete)); 
```

所以参数的类型需要是参数数组开头的String。

我真的不明白如何`call_user_func_array`处理`array(mysqli_stmt, 'bind_param')`a `callable`，或者为什么必须以这种方式构造参数，我想看看是否有人能提出解释！

# c# - 为什么我在终止进程时收到 AccessViolationException？

> ID：11871038
> 
> 赞同：0
> 
> 时间：2012-08-08T18:41:37.500
> 
> 标签：c#, winforms

我正在使用一个用 C# 编写的 .EXE 程序（从一家公司购买）。
有时我需要关闭它（从外部，而不是手动 - 我使用我的小型 C# 程序，它在需要时执行 Process.Kill）
如果程序没有做任何事情 - 我可以轻松地杀死它。
但如果它正在做一些“工作”（我认为它在他们的代码中是“计时器”或“后台工作人员”） - 它会关闭，但会出现一个小弹出窗口，上面写着“致命错误”（和“确定”按钮）。我单击“确定”，然后它会给出一个更大的弹出窗口，说：

```
System.AccessViolationException: Attempted to read or write protected memory. This is often an indication that other memory is corrupt.
at
System.Windows.Forms.UnsafeNetiveMethods.DispatchMessageA(MSG&msg)
at 
System.Windows.Forms.Application.ComponentManager.System.Windows.Forms.UNsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(in t32 dbComponentID, Int32 Reason, Int32 pv LoopData)
at
System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(Int32 reason ApplicationContext context)
at
System.Windows.Forms.Applicaion.ThreadContext.RunMessageLoop(Int32reason, ApplicationContext context_
at System.Windows.Forms.Application.Run(Form mainForm)
at cawf.xad70bf2c5a1a269d.xef498c90a0302180() 
```

（CAWF 是我刚刚杀死的他们的进程的名称）。
在我在这里单击“确定”后 - 我必须再次杀死它，然后它才会死。
他们的支持说这是 Windows 错误，所以他们无能为力。
我的猜测是他们的后台工作人员不想在某事中间被打断时死去。

有没有可能的方法来杀死它“好方法”（这样它就不会给出这些错误）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T18:48:27.213

是的，将 WM_CLOSE 发布到其主窗口并让它优雅地关闭。有关详细信息，请参阅此答案：[如何在 C# 中使用 WM_Close？](https://stackoverflow.com/questions/1129204/how-to-use-wm-close-in-c)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T18:49:49.223

如果你想杀死它然后通过运行命令杀死它

```
win key + R 
```

然后输入

```
tskill cawf 
```

或者

```
tskill cawf.exe 
```

尝试其中之一。

# c++ - C++ 中的 Linux 进程加载器

> ID：11871040
> 
> 赞同：3
> 
> 时间：2012-08-08T18:41:55.597
> 
> 标签：c++, linux, process, linux-kernel

我正在为 C++ 中的 Linux 平台开发进程加载器；这只是一个娱乐项目。基本上，我想手动将可执行文件的所有部分加载到内存中，然后执行它。

大约一周前，我[在这里](https://stackoverflow.com/questions/11723758/simple-process-loader-memory-mapping)问了一个相关但更具体的问题。然而，在阅读更多之后，我意识到在我学会如何实际创建进程之前，内存映射是无关紧要的。所以我的问题是，有没有办法在 Linux 上创建一个具有自己的虚拟地址空间的“空白”新进程（我将能够访问它以加载代码和数据）？

即使是关于进程加载器开发的一般资源也会很有用，因为我还没有找到任何资源。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T20:00:29.383

如果您有兴趣了解 Linux 进程加载器在您请求`exec()`某事时在幕后的真正作用，请获取内核源代码的副本并在里面`fs/exec.c`查找`do_execve_common()`.

如果您尝试运行 ELF 二进制文件，ELF 处理程序本身最终会被调用，它位于`fs/binfmt_elf.c`. 特别是，`load_elf_binary()`实际加载是否`struct linux_binprm`包含从磁盘加载过程映像所需的信息。

`binfmt_*.c`请注意，Linux 支持的二进制格式有很多文件；如果您有自定义二进制格式，那么原则上您*可以*编写自己的格式并将其作为内核模块提供。进程加载的内部对用户模式代码是不透明的（这是理所当然的：如果不这样，就会存在严重的安全漏洞）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T18:50:30.233

您可以使用 fork() 函数创建一个新进程，该进程将创建父进程的副本，然后使用[exec](http://www.unix.com/man-page/FreeBSD/3/execv/)系列函数之一，您可以加载可执行文件并执行它。

# sql - 如何传递参数进行查询？

> ID：11871042
> 
> 赞同：15
> 
> 时间：2012-08-08T18:41:57.460
> 
> 标签：sql, jasper-reports, parameter-passing

我正在尝试为我的应用程序编写查询，但遇到了一些麻烦。我需要将数据库的一个字段作为参数传递，例如：

```
SELECT name, phone, email 
FROM company 
WHERE $P{clause} = $P{key}
ORDER BY $P{order} 
```

因为 WHERE 子句和 ORDER BY 子句是动态的，供用户选择。

使用`$P{}`它没有用。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-08-09T06:36:20.767

*JasperReports*中有两种用于参数引用的语法表达式：***`$P{}`***和***`$P!{}`***。

*   **$P{paramName} 语法**主要用于设置*WHERE*输入参数值。替换算法是“智能”的，它的实现使用[java.sql.PreparedStatement](http://docs.oracle.com/javase/1.4.2/docs/api/java/sql/PreparedStatement.html)：对于***java.lang.String***参数，引擎将***$P{parameterName}***替换为引用值，对于***java.lang.Integer*** - 使用数值等等.

样本：

```
| 参数名称 | 参数类型 | 参数值 |
|:---------------|-------|:------------ ----:|
| 事件名称 | java.lang.String | 奥运会 |
| 事件类型 | java.lang.Integer | 2 |

```

原始表达式（替换）：

```
SELECT startDate, endDate, rating FROM events WHERE name=$P{eventName} AND type=$P{eventType} 
```

结果将是：

```
SELECT startDate, endDate, rating FROM events WHERE name='Olympic Games' AND type=2 
```

*   **$P!{paramName} 语法**主要用于“简单”替换。

样本：

```
| 参数名称 | 参数类型 | 参数值 |
|:---------------|------------------:|:------------ ----:|
| 表名 | java.lang.String | 活动 |
| 事件名称 | java.lang.String | 奥运会 |
| 频道 | java.lang.String | '英国广播公司' |
| 类型 | java.lang.String | 运动 |

```

原始表达式（替换）：

```
SELECT startDate, endDate, rating FROM $P!{tableName} WHERE name='$P!{eventName}' AND channel=$P!{channel} AND type=$P!{type} 
```

结果将是：

```
SELECT startDate, endDate, rating FROM events WHERE name='Olympic Games' AND channel='BBC' AND type=sport 
```

* * *

**有关更多信息**，您可以阅读这篇[使用报告参数](http://jasperforge.org/uploads/publish/ireportwebsite/IR%20Website/ir_using_parameters.html)帖子并查看此[查询示例](http://jasperreports.sourceforge.net/sample.reference/query/index.html#query)。

* * *

在您的情况下，正确的表达式可能是这样的：

```
SELECT name, phone, email FROM company WHERE $P!{clause} = $P{key} ORDER BY $P!{order} 
```

其中***$P{key}***是***java.lang.String***参数

或像这样（这取决于*$P!{clause}*值）

```
SELECT name, phone, email FROM company WHERE $P!{clause} = $P!{key} ORDER BY $P!{order} 
```

其中***$P{key}***是***java.lang.String***参数

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-10-24T07:43:53.067

如果您需要按参数订购，请尝试以下操作：

```
SELECT name, phone, email ,(case when $P{order} = 'name' then name when $P{order} = 'phone' then phone else email end) as orderlist
FROM company 
WHERE $P{clause} = $P{key}
ORDER BY orderlist 
```

# titanium - Titanium API 文本字段翻倍

> ID：11871048
> 
> 赞同：0
> 
> 时间：2012-08-08T18:42:14.863
> 
> 标签：titanium

我的应用程序中有一个 TextField，它在文本上加倍。我的意思是，如果我输入“dog”，它会返回“dogDog”，注意它是如何大写的？

```
var searchText = Ti.UI.createTextField({
      borderRadius:5,
      hintText : 'Enter Search Text',
      color:"#0000FF",
      borderColor:"#0000FF",
      font:{fontSize: 30},
      width:400,
      top:50
});
searchText.addEventListener('return',textEntered);

function textEntered(){
 Titanium.API.info(searchText.getValue());// logs "dogDog" when should be "dog"
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T12:20:25.460

使用与事件一起发送的属性。（文档[http://docs.appcelerator.com/titanium/2.1/#!/api/Titanium.UI.TextField-event-return](http://docs.appcelerator.com/titanium/2.1/#!/api/Titanium.UI.TextField-event-return)）

```
searchText.addEventListener('return',textEntered);

function textEntered(source,type,value){
    Titanium.API.info(value); // should just log 'dog'
    // var type should contain 'return'
    // var source should contain the searchText object.
} 
```

# java - 如何有效地将已经排序的列表分成组，可能使用 Guava？

> ID：11871049
> 
> 赞同：4
> 
> 时间：2012-08-08T18:42:15.347
> 
> 标签：java, guava

我有一个在逻辑上包含多组元素的数组，其中每个组在数组中都是连续的。（它是通过数据库“order by”子句排序的）。将其作为集合的集合（在松散的意义上 - 迭代器的迭代器很好）遍历它是最干净的，其中顶级迭代器将为每个组返回一个较低级别的迭代器。这可能与 Guava 的 partition() 类似，但使用传入的比较器来确定在哪里分解输入。

有很多低效的方法可以做到这一点，例如使用 Guava 的 MultiMap。有没有一种简单、现成、有效的方法来利用订购的优势？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:22:10.310

编写自己的迭代器。

第一个返回第二个的实例。

他们共享一个索引！

只要索引位于同一组的元素上，第二个就为 hasNext() 返回 true。当 second's.hasNext() 返回 false 时调用 first.hasNext() 然后 first.next() 等等。

它应该是 5 到 10 行手写代码（假设您的 IDE 完成了所有的类、方法和括号内容）。

这是一种高效且不太丑陋的做事方式。如果您想提高效率，只需遍历数组，在 for 循环中检查组条件。那是更少的代码。

# asp.net - SQL Server 数据库的 ASP.NET 主机问题

> ID：11871051
> 
> 赞同：1
> 
> 时间：2012-08-08T18:42:27.500
> 
> 标签：asp.net, sql-server, entity-framework

NET 4.0 应用程序连同它的 SQL Server 2008 数据库到在线主机。ORM 层是实体框架。但是，应用程序不会从数据库中的表中读取数据 - 简而言之，它看不到数据库并且它显示网络实例错误 bla bla bla... 每当对其进行查询时。

我检查了其中是否有数据，它返回了我放入的其中一个表中的数据。任何有线索的人可能有什么问题？以下是我的 web.config 的一部分

```
<connectionStrings>
<add name="ApplicationServices"
     connectionString="data source=.\SQLEXPRESS;Integrated  Security=SSPI;AttachDBFilename=|DataDirectory|\aspnetdb.mdf;User Instance=true"
     providerName="System.Data.SqlClient" />
<add name="DemographicDBEntities" connectionString="metadata=res://*/DemoGraph.csdl|res://*/DemoGraph.ssdl|res://*/DemoGraph.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=DemographicDB.mssql.somee.com;initial catalog=DemographicDB;persist security info=False;user  id=west;pwd=westhouseit;multipleactiveresultsets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient" />
</connectionStrings> 
```

# c++ - C++ 中的内存跟踪器在向量初始化期间进入无限循环

> ID：11871052
> 
> 赞同：3
> 
> 时间：2012-08-08T18:42:38.153
> 
> 标签：c++, windows, new-operator

我正在尝试通过重载`new`和`delete`运算符在 C++ 中编写内存跟踪器。但它会进入循环并`new`一次又一次地调用。以下是我的代码。

```
#ifndef MEMORY_TRACKER_H_
#define MEMORY_TRACKER_H_

#pragma warning( disable : 4290 )
#pragma comment(lib, "Dbghelp.lib")

#include <Windows.h>
#include <malloc.h>
#include <map>
#include <iostream>
#include <DbgHelp.h>
#include <sstream>
#include <vector>

static const int MAX_TRACES     = 62;
static const int MAX_LENGTH     = 256;
static const int BUFFER_LENGTH  = (sizeof(SYMBOL_INFO) + MAX_LENGTH * sizeof(wchar_t) + sizeof(ULONG64) - 1) / sizeof(ULONG64);
static bool SYSTEM_INITIALIZED  = false;

typedef struct record_t {
    std::string symbol;
    std::string address;
    std::string filename;
    std::string linenumber;
} record;

typedef std::vector<record>              record_vec_t;
typedef std::pair<size_t, record_vec_t>  record_entry_t;
typedef std::map<size_t, record_entry_t> memory_record_t;

memory_record_t gMemoryRecord;

static record_vec_t GetCallStackDetails(const void* const* trace, int count ) {
    record_vec_t callStackVector;

    for (int i = 0; i < count; ++i) {
        ULONG64 buffer[BUFFER_LENGTH];
        DWORD_PTR frame           = reinterpret_cast<DWORD_PTR>(trace[i]);
        DWORD64 sym_displacement  = 0;
        PSYMBOL_INFO symbol       = reinterpret_cast<PSYMBOL_INFO>(&buffer[0]);
        symbol->SizeOfStruct      = sizeof(SYMBOL_INFO);
        symbol->MaxNameLen        = MAX_LENGTH;
        BOOL has_symbol           = SymFromAddr(GetCurrentProcess(), frame, &sym_displacement, symbol);
        DWORD line_displacement   = 0;
        IMAGEHLP_LINE64 line      = {};
        line.SizeOfStruct         = sizeof(IMAGEHLP_LINE64);
        BOOL has_line             = SymGetLineFromAddr64(GetCurrentProcess(), frame, &line_displacement, &line);

        record curr_rec;
        curr_rec.symbol = "(No Symbol)";

        std::stringstream formatter;        
        if (has_symbol) {
            curr_rec.symbol = symbol->Name;
            formatter.clear();
            formatter << " [0x" << trace[i] << "+" << sym_displacement << "]";     
            curr_rec.address = formatter.str();
        } else {
            formatter.clear();
            formatter << " [0x" << trace[i] << "]";
            curr_rec.address = formatter.str();
        }
        if (has_line) {
            formatter.clear();
            formatter << line.FileName;
            curr_rec.filename = formatter.str();

            formatter.clear();
            formatter << line.LineNumber;
            curr_rec.filename = formatter.str();
        }
        callStackVector.push_back(curr_rec);
    }
    return callStackVector;
}

static void addRecord(void *ptr, size_t size) {
    if ( SYSTEM_INITIALIZED == false ) {
        SymSetOptions(SYMOPT_DEFERRED_LOADS | SYMOPT_UNDNAME | SYMOPT_LOAD_LINES);
        if (SymInitialize(GetCurrentProcess(), NULL, TRUE)) {
            SYSTEM_INITIALIZED = true;
        } else {
            SYSTEM_INITIALIZED = false;
            return;
        }
    }
    void* trace[MAX_TRACES];

    int count            = CaptureStackBackTrace(0, MAX_TRACES , trace, NULL);
    record_vec_t record  = GetCallStackDetails( trace, count);
    record_entry_t entry = std::make_pair( size, record);

    gMemoryRecord.insert(std::make_pair((size_t)ptr, entry));
}

static void deleteRecord(void *ptr ) {
    memory_record_t::iterator itr = gMemoryRecord.find((size_t)ptr);
    if ( itr != gMemoryRecord.end()) {
        gMemoryRecord.erase(itr);
    }
}

void dumpUnfreedMemory() {
    for ( memory_record_t::iterator itr = gMemoryRecord.begin(); itr != gMemoryRecord.end(); ++itr ) {
    }
}

// Overloading new operator
void* operator new ( size_t size ) throw ( std::bad_alloc ) {
    std::cout << " Overloaded new is called " << std::endl;
    void *ptr = (void *)malloc(size);
    addRecord(ptr, size);   

    return ptr;
}

// Overloading delete Operator
void operator delete ( void* ptr ) throw () { 
    std::cout << " Overloaded delete  is called " << std::endl;
    deleteRecord(ptr);
    free ( ptr );
}

#endif 
```

以下是测试文件

```
#include "MemoryTracker.h"
int main ( int argc, char **argv) {
    int *ptr = new int;
    return 0;
} 
```

它在调用时进入循环`GetCallStackDetails`，平台是`windows`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T18:49:11.757

您正在重载 global `operator new`，并`std::vector<record>`使用默认分配器，该分配器调用`operator new`分配内存。然后调用你的GetCallStack，它分配一个新的向量......

一种解决方案是在您的向量中使用自定义分配器，该分配器从单独的内存池中提取，因此它不会调用您的 GetCallStack。

# java - Z阶曲线java实现

> ID：11871057
> 
> 赞同：4
> 
> 时间：2012-08-08T18:42:56.190
> 
> 标签：java, indexing

任何人都可以指出 Z 阶曲线实现的 Java 代码吗？我有 x,y 浮点坐标，我想要它们的一维表示，我知道这可以使用 Z 阶曲线变换。我找不到此函数的 Java 实现或 C 代码。

我将不胜感激任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T21:49:04.183

[GridKit根据](http://code.google.com/p/gridkit/)[koders](http://www.koders.com/java/fidA3C2B778E1FFBC24CE66C46E02163407F1E23C5B.aspx?s=ConvertToBinary)有一个 Z-Order 实现。如果您也接受 c++，则还可以[使用 STANN](https://sites.google.com/a/compgeom.com/stann/)对点云进行最近邻搜索。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T22:14:38.317

我会自己写这个。

[`Math.getExponent`](http://docs.oracle.com/javase/7/docs/api/java/lang/Math.html#getExponent%28double%29)首先从浮点数转换为整数，通过使用并取其中的[最大值](http://docs.oracle.com/javase/7/docs/api/java/lang/Math.html#max%28int,%20int%29)计算两个指数。然后您可以[缩放](http://docs.oracle.com/javase/7/docs/api/java/lang/Math.html#scalb%28float,%20int%29)这些数字，使这些数字中较大的一个在小数点前有 32 位。然后将结果四舍五入（或截断）为 int。然后，您必须使用位交错将这两个整数组合成一个 long，最后您可以使用存储的指数再次缩放结果。

如果您的输入已经被限制在例如 [0,1] 范围内，您可以简单地使用基于整数的定点算术而不是手动重新缩放。

为了进行位交错，我会使用一个查找图，例如获取一个 8 位块并计算相应的 16 位交错块。这样你就不必做太多的位移操作。

# c++ - 我的 Firefox 扩展程序不工作。使用 C++ XPCOM 组件的 Firefox 扩展（XPI 文件）的结构是什么？

> ID：11871059
> 
> 赞同：1
> 
> 时间：2012-08-08T18:43:04.240
> 
> 标签：c++, firefox, firefox-addon, xpcom

我已经尝试了一百万种不同的东西，但无法让它发挥作用。

在 xpi 文件中，我有：

```
* content folder
     -browserOverlay.js
     -browserOverlay.xul

* locale folder
     *en-US folder
         -browserOverlay.dtd
         -browserOverlay.properties
* skin folder
         -browserOverlay.css 
```

我有 Firefox 14.0.1，并且我的“Hello World”扩展部分不使用 XPCOM 正在工作。现在，它所做的只是添加一个带有按钮的工具栏，单击该按钮时会显示“Hello World”，然后尝试运行我使用 Gecko SDK 构建并使用 VS 2005 编译的 C++ XPCOM 组件。

browserOverlay.js 文件包含以下代码：

```
/**
 * XULSchoolChrome namespace.
 */
if ("undefined" == typeof(XULSchoolChrome)) {
  var XULSchoolChrome = {};
};

/**
 * Controls the browser overlay for the Hello World extension.
 */
XULSchoolChrome.BrowserOverlay = {
  /**
   * Says 'Hello' to the user.
   */
  sayHello : function(aEvent) {
    let stringBundle = document.getElementById("xulschoolhello-string-bundle");
    let message = stringBundle.getString("xulschoolhello.greeting.label");

    window.alert(message);

    try
    {
      // normally Firefox extensions implicitly have XPCOM privileges
      //but since this is a file we have to request it.

      netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
      const cid = "@example.com/XPCOMSample/MyComponent;1";
      obj = Components.classes[cid].createInstance();
      // bind the instance we just created to our interface
      obj = obj.QueryInterface(Components.interfaces.IMyComponent);
    } catch (err) {
      alert(err);
      return;
    }
    var res = obj.Add(3, 4);
    alert('Performing 3+4\. Returned ' + res + '.');
  }
}; 
```

当我单击按钮时，我会看到第一个警报窗口。当我单击“确定”时，我看到一个带有以下错误消息的窗口：

> TypeError: Components.classes [cid] 未定义

我究竟做错了什么？我应该在 xpi 文件中的什么位置放置 .dll 文件？.idl 文件？.xpt 文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T07:45:21.433

我猜你正在关注一个过时的教程，大多数教程还没有更新到[Gecko 2.0 中的 XPCOM 更改](https://developer.mozilla.org/en/XPCOM/XPCOM_changes_in_Gecko_2.0)。但是对于你的问题：

> 我应该在 xpi 文件中的什么位置放置 .dll 文件？

任何你喜欢的地方。传统的放置在`components/`子目录内。

> .idl 文件？

它不应该是您的扩展的一部分，而应该是`.xpt`文件。

> .xpt 文件？

再次在您喜欢的任何地方，但通常在与文件相同的目录中`.dll`。

但是，将必要的声明添加到`chrome.manifest`文件中很重要，通常是这样的：

```
interfaces components/mycomponent.xpt
binary-component components/mycomponent.dll ABI=WINNT_x86-msvc 
```

另请参阅有关组件代码中需要更改的内容的[文档](https://developer.mozilla.org/en-US/docs/XPCOM/XPCOM_changes_in_Gecko_2.0#Binary_components)（如果您愿意，Firefox 源代码树中有一个[示例）。](http://mxr.mozilla.org/mozilla-central/source/xpcom/sample/nsSampleModule.cpp)请注意，您必须使用与您要使用该组件的 Firefox 版本相匹配的[Gecko SDK版本来编译您的组件。](https://developer.mozilla.org/en-US/docs/Gecko_SDK)因此，对于 Firefox 14，您需要使用 Gecko SDK 14。由于不再有任何二进制兼容性，因此您的组件将只能在 Firefox 14 中运行，而不能在 Firefox 13 或 Firefox 15 中运行。

# php - 否则， fetchRow() zend

> ID：11871061
> 
> 赞同：0
> 
> 时间：2012-08-08T18:43:09.350
> 
> 标签：php, zend-framework

```
public function updateMemberdetail(Application_Model_Memberdetail $memberdetail)
{
    $data = array(
        'memberid' => $memberdetail->getMemberid(),
        'membername' => $memberdetail->getMembername(),
        'contact' => $memberdetail->getContact(),
        'birthday' => $memberdetail->getBirthday(),
        'email' => $memberdetail->getEmail(),
        'address' => $memberdetail->getAddress(),
    );

    $auth= Zend_Auth::getInstance(); //declare zend_auth to get instance
    $user= $auth->getIdentity(); //get identity of user
    $userid = $user->userid; //get userid of user

    $this->select() //select from usertable and memberdetail 
    ->from(array('memberdetail', 'usertable')) //join memberdetail and usertable through memberid = username 
    ->where('memberdetail.memberid = usertable.?', $userid); 
    $row = $this->fetchRow($select);
    if ($row == true) //if row exist update row
    {

        $this->update($data, 'memberid = '. (int)($memberdetail->getMemberid()));

    }
    else
    {

        $this->insert($data); //if row doesnt exist, add it

    }
} 
```

您好，我在使用 if else 语句时遇到了一些问题。如果数据库中不存在，我想添加一行数据，但如果存在则更新它。但是，当我在数据库中没有该行时，它不会插入它。当我手动将一行插入数据库时​​，它会更新该行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:06:17.320

fetchRow 方法将返回 Zend_Db_Table_Row_Abstract 的一个实例，如果没有找到则返回 NULL。从 Zend 的[手册](http://framework.zend.com/manual/en/zend.db.table.row.html#zend.db.table.row.write.insert)中，我相信您需要在保存之前创建行。

```
 $select = $this->select() //select from usertable and memberdetail 
    ->from(array('memberdetail', 'usertable')) //join memberdetail and usertable through memberid = username 
    ->where('memberdetail.memberid = usertable.?', $userid); 
  $row = $this->fetchRow($select);
  if (empty($row)) //if row exist update row
  {
    $newRow = $this->createRow($data);
    $newRow->save(); //if row doesnt exist, add it
  }
  else
  {
    $this->update($data, 'memberid = '. (int)($memberdetail->getMemberid()));
  } 
```

# javascript - JavaScript 中的 Monad

> ID：11871065
> 
> 赞同：23
> 
> 时间：2012-08-08T18:43:21.750
> 
> 标签：javascript, monads

所以我想了解 JavaScript 中的 monad 有用的实际案例。

我阅读了一堆关于 JavaScript 中 Monads 的文章，并了解 jQuery 是其使用的一个例子。但是除了“链式”模式，在前端工程中使用 Monads 还能有效解决哪些问题呢？

参考：

[http://importantshock.wordpress.com/2009/01/18/jquery-is-a-monad/](http://importantshock.wordpress.com/2009/01/18/jquery-is-a-monad/)

[http://igstan.ro/posts/2011-05-02-understanding-monads-with-javascript.html](http://igstan.ro/posts/2011-05-02-understanding-monads-with-javascript.html)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2018-05-23T00:20:26.510

这是我为您可能从未在其他任何地方找到的 monads 初学者做出贡献的尝试。

## monad 是函数式编程中高度可组合的单元（一种编程的构建块）。

（IMO，在没有任何上下文和合理化的情况下引入“Monad 定律”只是一种无用的分类和理解这个概念的危险。不用担心，我会在本文后面完成这项工作。）

在大多数情况下，我们有多种编程构建块，例如对象、函数、列表等。

尽管拥有多种编程块似乎是自然规律，并且对于实际用途的灵活编程来说是不可避免的，但事实上，拥有多种块是编程环境污染的主要来源之一。

使用各种块构建块是一项复杂的任务。程序员需要在各种情况下从各种块中非常明智地选择一个块，并且在很长一段时间内，他会失败。

因此，不鼓励根据情况选择各种块，相反，始终使用某个普遍标准化的预选块是一个很好的原则。

事实上，这种智慧在当今的 PC 世界中很常见。

> [USB 是通用串行总线的缩写，是一种行业标准，旨在定义用于个人计算机及其外围设备之间的连接、通信和电源的电缆、连接器和协议。](https://en.wikipedia.org/wiki/USB)

获得精心设计的通用标准化构建块可以消除许多问题。

1.  [对象](https://en.wikipedia.org/wiki/Object_(computer_science))是（曾经是）那个。
2.  [功能](https://en.wikipedia.org/wiki/Function_object)是唯一的。
3.  [单子](https://en.wikipedia.org/wiki/Monad_(functional_programming))就是一个。
4.  规格
5.  执行
6.  确认

# 1.OOP

> [面向对象编程（OOP）是一种基于“对象”概念的编程范式，它可能包含数据，以字段的形式，通常称为属性；和代码，以过程的形式，通常称为方法。对象的一个​​特征是对象的过程可以访问并经常修改与其相关联的对象的数据字段（对象具有“this”或“self”的概念）。在 OOP 中，计算机程序是通过将它们制作成相互交互的对象来设计的。OOP 语言有很大的多样性，但最流行的语言是基于类的，这意味着对象是类的实例，这通常也决定了它们的类型。](https://en.wikipedia.org/wiki/Object_(computer_science))

选择对象作为通用标准化的构建块，程序员准备一个包含成员值和函数的基类，并且为了获得块的变体，使用[继承](https://en.wikipedia.org/wiki/Inheritance_(object-oriented_programming))。

面向对象的思想通常是用现实世界的物理对象来解释的，而范式本身在数学抽象方面很薄弱。

例如，函数（或方法）从属于对象，函数不需要是[一等对象](https://en.wikipedia.org/wiki/First-class_citizen)，这是理所当然的，因为范式最初选择对象作为其精心设计的通用标准化构建块。

功能是作为标准化构建块的对象的从属实体并且两者的角色完全不同的观点来自物理世界中的工程意义。不是编程实际所在的数学抽象。

OOP 的基本问题只是对象不是精心设计的通用标准化构建块。具有强大数学背景的函数式编程或 monad 是更好的选择。

# 2.函数式编程

**函数式编程就是组合函数。**

说起来容易，但这已经是编程史上的一大成就了。

与其研究编程的悠久历史，不如分享我的个人历史。

我从1.0版本开始就是C#(OOP)程序员，总体上还算满意，但感觉很不对劲，但不知道是什么问题。

后来我成为了一名 JavaScript 程序员，在早期，我曾经这样写：

```
function add1(a) {
    return a + 1;
} 
```

有一天，我读到一篇网络文章说“在 JavaScript 中，一个函数也是一个值”。

这个事实让我很惊讶，也突破了我的编程技巧。

在那之前，对我来说，价值就是价值，函数就是函数。两者都是不同领域的完全不同的实体。

当然，C#1.0 已经实现了委托，我稍微理解它是关于事件的内部机制的东西。毕竟，C# 一直是主要的 OOP 语言，而且对于函数式编程来说相当丑陋，至少在 version1.0 中是这样。

在 JavaScript 中，函数也是一个值。由于 JavaScript 的函数是一等对象，因此我可以定义一个函数，该函数既可以将其他函数作为参数，也可以将它们作为结果返回。

所以，现在，我写这个：

```
const add1 = x => x + 1;
const add2 = x => x + 2;
[1, 2, 3].map(add1); //[2,3,4]
[1, 2, 3].map(add2); //[3,4,5] 
```

或者

```
const plus = (x) => (y => x + y);
plus(1)(5); //6 
```

事实上，这是我在 C# 编程中非常需要的，我一直觉得这是非常错误的。

这就是所谓的[函数组合](https://en.wikipedia.org/wiki/Function_composition)，这是释放编程约束的真正秘诀。

所以，JavaScript 的一个函数是一个一流的对象，它似乎是一个精心设计的通用标准化的构建块，从现在开始，我们称之为“高度可组合的单元”。

一个函数是`BEFORE => AFTER`。

基本思想是组合函数。

当您专注于功能组合时，您只关心`BEFORE => AFTER`.

当您专注于功能组合时，您应该忘记从代码顶部流向底部或有时循环的[流程图。](https://en.wikipedia.org/wiki/Flowchart)

流程图编码被称为[命令式编程](https://en.wikipedia.org/wiki/Imperative_programming)，一般来说，它有缺陷且过于复杂。OOP 倾向于成为这种风格。

另一方面，函数式编程会自动将编程风格引入[Declarative_programming](https://en.wikipedia.org/wiki/Declarative_programming)，而且一般来说，它没有错误或易于调试。

流更难追踪和控制，但组合更容易追踪和控制。程序员不应控制流程，而应编写函数。

# 3.单子

顺便说一句，我不会在这里使用 Haskell 代码。

对于大多数人来说，理解 monad 事物的一个主要障碍是

1.  为了学习 monad，初学者需要熟悉 Haskell 代码和术语。
2.  为了熟悉 Haskell 代码和术语，初学者需要学习 Monad。

这是“先有鸡还是先有蛋？” 问题。确保避免。

话虽如此，正如我在本文开头所说的那样，为了分享 Monad 的知识，首先引用“Monad 法则”似乎也很荒谬。

人们只能在他们已经知道的基础上学习。

那么，让我们回到 JavaScript 代码。

函数似乎是高度可组合的单元，但是这个呢？

```
console.log("Hello world!"); 
```

这是最简单的 JS 代码之一，当然它是一个函数。

在 ChromeBrowser 上按 F12 键，然后将代码复制粘贴到开发人员控制台上。

```
Hello world!
undefined 
```

好的，代码已经完成了显示“Hello world！”的任务。然而，在控制台上，`console.log`函数的返回值为`undefined`.

编写函数，情况不舒服；一个不舒服的功能。

另一方面，有一个舒适的功能。让我们研究以下代码：

```
const add1 = x => x + 1;
[1, 2, 3].map(add1); //[2,3,4] 
```

JavaScript 中的数组在函数式编程世界中表现得非常好。

```
[1, 2, 3].map(add1)   //[2,3,4] 
```

表示：
`Array` `Function=>` `Array`

函数的输入和输出是同一类型：`Array`.

数学结构自始至终是相同的`BEFORE => AFTER`。

一致性和同一性的本质是美丽的。

与 USB 接口的耐人寻味的相似性自然引出了一个想法：
`Array` `Function=>` `Array` `Function=>` `Array` `Function=>` `Array`...

在 JavaScript 代码中：

```
[1, 2, 3]
  .map(add1) //[2,3,4]
  .map(add1) //[3,4,5]
  .map(add1);//[4,5,6] 
```

代码提示一旦进入 Array 领域，出口永远是 Array 领域，所以在某种意义上没有出口。

由于数组领域是一个自包含的世界，因此可以在函数式编程中做类似代数的事情。

当我们有：

```
Array.map(F).map(F).map(F)... 
```

考虑到`.map(F)`JavaScript Array 特定的语法，将其替换为更简洁的语法是可能的，例如，通过利用诸如[Babel](https://babeljs.io/)之类的转译器。

所以替换`.map(F)`为`*F`：

```
Array*F*F*F... 
```

这看起来像[代数](https://en.wikipedia.org/wiki/Algebra)。

获得高度可组合的单元，程序员可以写出像代数一样的代码，意义重大，值得非常认真地研究。

在代数中，

```
a
= 0+a
= 0+0+a
= 0+0+0+a 
```

或者

```
a
= 1*a
= 1*1*a
= 1*1*1*a 
```

`0`在+（加法）运算中，

```
a + 0 = a  //right identity
0 + a = a  //left identity 
```

`1`在*（乘法）运算中，

```
a ∗ 1 = a  //right identity
1 ∗ a = a  //left identity 
```

称为[恒等元](https://en.wikipedia.org/wiki/Monad_(functional_programming))。

在代数中，

```
1 + 2 + 3 = 1 + 2 + 3
(1+2) + 3 = 1 + (2+3)
    3 + 3 = 1 + 5
        6 = 6 
```

称为[关联属性](https://en.wikipedia.org/wiki/USB)

```
number + number = number

number * number = number

string + string = string

"Hello" + " " + "world" + "!" 
= "Hello world" + "!" 
= "Hello "+ "world!" 
```

也是关联的，标识元素是`""`。

那么，函数式编程中的标识元素是什么？

就像是：

```
identityF * f = f = f * identityF 
```

函数式编程中的关联属性是什么？

```
const add1 = x => x + 1;
const add2 = x => x + 2;
const add3 = x => x + 2; 
```

就像是：

```
add1 * add2 * add3
= (add1 * add2) * add3
= add1 * (add2 * add3) 
```

或者

```
 (add1)(add2)(add3) = (add1)(add2)(add3)
 ((add1)(add2))(add3) = (add1)((add2)(add3))
         (add3)(add3) = (add1)(add5)
　             (add6) = (add6) 
```

函数式编程是关于函数组合的。

我们在函数式编程中需要的是

```
function * function = function 
```

当然，在 JavaScript（或其他语言）中，由于每种语言的语法限制，我们不能写出上面的确切形式。

其实我们可以有[《Algebraic JavaScript Specification》（JavaScript中常见代数结构的互操作性规范）](https://github.com/fantasyland/fantasy-land)

[![代数 JavaScript 规范](../Images/bf6b7010bc88d6d664a07871721f77ce.png)](https://i.stack.imgur.com/9anw0.png)

那么 JavaScript 数组就是所谓的 Monad 吗？

不，但很接近。JavaScript 数组可以归类为[Functor](https://github.com/fantasyland/fantasy-land#functor)。

[Monad](https://github.com/fantasyland/fantasy-land#monad)是 Functor 的一种特殊形式，具有一些额外的性质（应用了更多规则）。

Functor 仍然是高度可组合的单元之一。

所以我们正在接近 Monad 是什么。让我们更进一步。

现在，我们知道 JavaScript 数组是可以做一些代数的高度可组合的单元之一，至少在一定程度上是这样。

那么除了数组之外的 JavaScript 值呢？功能呢？

学习并遵循[Algebraic JavaScript Specification](https://github.com/fantasyland/fantasy-land)，很容易尝试实现各种可组合单元，包括 Functor 或 Monad，有什么意义？

毕竟，它们只是数学结构的分类表，一味地遵循规范是没有意义的。

# 4.规格

关键是要获得一个高度可组合的单元，该单元是独立的。这是唯一要满足的规范。

所以，这里是问题的建立：
实现一个生成自包含领域的数学结构，看看它是如何进行的。

什么都好，我会从头开始，但我已经有一个好的模型可以参考。

JavaScript 数组

```
Array.map(F).map(F).map(F)... 
```

代替 Array 领域，让我们将我的原始`M`领域变成这样：

```
M.map(F).map(F).map(F)... 
```

我认为`Array.map`不是简洁的语法，`M`它本身就是一个函数：

```
M(F)(F)(F)... 
```

嗯，总是使用某个预先选择的、普遍标准化的块是一门很好的纪律。这就是开始的想法，所以可能`F`也应该是`M`：

```
M(M)(M)(M)... 
```

嗯，这是什么意思？？

所以，这是我的疯狂想法。

在函数式编程中，任何函数也是一等对象，这就是突破。所以当我将任何值/对象/函数解释为`M`时，就会有另一个突破。

这就像说“任何值都是数组！”一样疯狂。

确切地说，如果它在 JavaScript 领域是疯狂的，但如果它在 Array 的自包含领域是合法的。

因此，我将设计原始`M`领域将任何裸值/对象/函数视为`M`

例如，在`M`领域中，当找到裸值：时`5`，解释为`M(5)`.

换句话说，只要在`M`领域中，程序员就不必编写`M(5)`，因为`5`被隐式解释为`M(5)`.

因此，在`M`领域：

```
5
= M(5)
= M(M(5))
= M(M(M(5)))
... 
```

结果，我发现`M`有些透明，`M`应该是领域中的一个身份元素。

正如我一直在强调的，**函数式编程就是组合函数。**

函数的组合对于函数式编程是关联的。

`M`应该灵活地编写来组合函数 ：

```
const add1 = x => x + 1;
M(10)(add1);             //11
M(10)(add1)(add1);       //12
M(10)(add1)(add1)(add1); //13
const add2 = M(add1)(add1);
M(10)(add2);             //12
const add3 = M(add2)(add1);   
M(10)(add3);             //13 
```

此外，高阶函数的组合：

```
const plus = (x) => (y => x + y);
M(plus(1)(5));    //6
M(5)(M(1)(plus)); //6
const plus1 = M(1)(plus);
M(5)(plus1)(;     //6 
```

# 5.实施

这是一个实现`M`：

```
const compose = (f, g) => (x => g(f(x)));
const isMonad = (m) => !(typeof m.val === "undefined");

const M = (m = []) => {
  const f = m1 => {
    try { //check type error
      return M(M(m1).val(m));
    } catch (e) {
      return M(compose(m, M(m1).val)); // f-f compose
    };
  };
  f.val = m;
  return isMonad(m)
    ? m
    : f;
};
M.val = m => m; 
```

记录功能：

```
const log = (m) => (typeof m !== 'function')
  ? (() => {
    console.log(m);
    return m;
  })()
  : err(); 
```

测试代码：

```
const err = () => {
  throw new TypeError();
};

const log = (m) => (typeof m !== 'function')
  ? (() => {
    console.log(m);
    return m;
  })()
  : err();

const loglog = M(log)(log);
M("test")(loglog);

M("------")(log);
M([1])(log);
M(M(M(5)))(log)
M(99)(M)(log)

M("------")(log);
M([1, 2, 3])(([a, b, c]) => [a + 1, b + 1, c + 1])(log)

M("------")(log);

const add1 = a => (typeof a == 'number')
  ? a + 1
  : err();

M(10)(add1)(log); //11
M(10)(add1)(add1)(log); //12
M(10)(add1)(add1)(add1)(log); //13
const add2 = M(add1)(add1);
M(10)(add2)(log); //12
const add3 = M(add2)(add1);
M(10)(add3)(log); //13

M("------")(log);
const plus = (x) => (y => x + y);
M(plus(1)(5))(log); //6
M(5)(M(1)(plus))(log); //6
const plus1 = M(1)(plus);
M(5)(plus1)(log); //6

M("------")(log);
const map = (f) => (array => array.map(f));
const map1 = M(add1)(map);
M([1, 2, 3])(log)(map1)(log);

//===

M("left identity   M(a)(f) = f(a)")(log);
M(7)(add1)(log) //8

M("right identity  M = M(M)")(log);
console.log(M) //{ [Function: M] val: [Function] }
console.log(M(M)) //{ [Function: M] val: [Function] }

M("identity")(log);
M(9)(M(x => x))(log); //9
M(9)(x => x)(log); //9

M("homomorphism")(log);
M(100)(M(add1))(log); //101
M(add1(100))(log); //101

M("interchange")(log);
M(3)(add1)(log); //4
M(add1)(f => f(3))(log); //4

M("associativity")(log);
M(10)(add1)(add1)(log); //12
M(10)(M(add1)(add1))(log); //12 
```

输出：

```
test
test
------
[ 1 ]
5
99
------
[ 2, 3, 4 ]
------
11
12
13
12
13
------
6
6
6
------
[ 1, 2, 3 ]
[ 2, 3, 4 ]
left identity   M(a)(f) = f(a)
8
right identity  M = M(M)
{ [Function: M] val: [Function] }
{ [Function: M] val: [Function] }
identity
9
9
homomorphism
101
101
interchange
4
4
associativity
12
12 
```

好的，工作。

`M`是函数式编程中高度可组合的单元。

# 6.验证

那么，这就是所谓的Monad吗？

是的。

[https://github.com/fantasyland/fantasy-land#monad](https://github.com/fantasyland/fantasy-land#monad)

> ### 单子
> 
> 实现 Monad 规范的值也必须实现[Applicative](https://github.com/fantasyland/fantasy-land#applicative)和[Chain](https://github.com/fantasyland/fantasy-land#chain)规范。1.`M.of(a).chain(f)`等价于`f(a)`（左身份） 2.`m.chain(M.of)`等价于`m`（右身份）

左恒等式 M(a)(f) = f(a)

```
M(7)(add1) //8
M(add1(7)) //8 
```

正确的身份 M = M(M)

```
console.log(M) //{ [Function: M] val: [Function] }
console.log(M(M)) //{ [Function: M] val: [Function] } 
```

> ### 适用的
> 
> 实现 Applicative 规范的值也必须实现[Apply](https://github.com/fantasyland/fantasy-land#apply)规范。1.`v.ap(A.of(x => x))`等价于`v`(identity) 2.`A.of(x).ap(A.of(f))`等价于`A.of(f(x))`(homomorphism) 3.`A.of(y).ap(u)`等价于`u.ap(A.of(f => f(y)))`(interchange)

身份

```
M(9)(M(x => x)) //9 
```

同态

```
M(100)(M(add1)) //101
M(add1(100)) //101 
```

互换

```
M(3)(add1)    //4
M(add1)(f => f(3))  //4 
```

> ### 链
> 
> 实现 Chain 规范的值也必须实现[Apply](https://github.com/fantasyland/fantasy-land#apply)规范。1.`m.chain(f).chain(g)`等价于`m.chain(x => f(x).chain(g))`（关联性）

联想性

```
M(10)(add1)(add1) //12
M(10)(M(add1)(add1)) //12 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-21T21:13:29.450

好吧，我认为第一篇文章很棒而且很详细。它描述了 JQuery 解决的许多问题及其 monad 特性。

1.  JQuery 包装了 DOM 元素并提供了更丰富的界面。解决的问题很多：更丰富的事件（“mouseenter”、“mouseleave”、“hashchnged”等）。事件绑定添加处理程序而不是覆盖。CSS 处理的接口类似于 JQuery 公开的其他接口。

这也是 JQuery 对许多开发人员如此直观的原因，因为它只是简单地包装了我们所知道的内容，而不是试图重新发明 HTML。

更不用说它在引用空值时节省了很多错误。如果我没有带有 id 的元素`guy`，则运行`$("#guy").text("I am not here")`不会导致 JQuery 出错。

1.  JQuery 很容易将自己包裹在 DOM 元素周围，允许在原始 JS 和 JQuery 的接口之间来回遍历。这允许开发人员按照自己的节奏学习 JQuery，而不是一次性重写整个代码。

2.  当 JQuery 使用参数提供回调时，它使用 DOM 对象而不是 JQuery 的包装器。这允许第 3 方轻松与 JQuery 集成，因为他们不需要依赖 JQuery。例如，假设我编写了一个使用原始 JavaScript 将文本绘制为红色的函数。`function paintRed(element){element.style.color="red"}`- 我可以轻松地将此函数作为回调传递给 JQuery 函数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-15T09:16:41.910

使用 monad 时可以避免使用全局变量和状态（例如“纯”代码）。您可能还想看看[https://github.com/brownplt/flapjax/](https://github.com/brownplt/flapjax/)。Flapjax 是一个函数响应式编程库，它也使用单子方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-22T20:30:11.527

将参数传递给特定范围内的给定回调函数可以使用 monad 进行泛化：

```
/* Unit function */
function Monad(value)
  {
  // Construct monad and set value to given argument or undefined
  this.value = value || undefined;
  }

/* Constructor function */
Monad.prototype.pass = function(value, cb, scope)
  {
  // return constructor result if no default value is passed
  if (/undefined/.test(this.value) )
    {
    return new this.constructor();
    }
  // return callback result for given value in given context if scope is passed
  if(scope)
    {
    /* Bind function */
    return cb.call(scope, value);
    }
  // return callback result for given value otherwise
  return cb(value);
  }

 /* Separate arguments from function, and function from global scope */
 var foo = new Monad(RegExp);
 var bar = foo.pass(2, Function("count","return ++count"), Math); 
```

**参考**

*   [关于单子](http://c2.com/cgi/wiki/wiki?OnMonads)
*   [透明的持久性](http://lambda-the-ultimate.org/node/526)
*   [一元二元](http://www.jsoftware.com/help/dictionary/d310v.htm)
*   [通用逻辑控制英语](http://www.jfsowa.com/clce/specs.htm)
*   [JSON Parser Monad - 以有趣的方式解析 JSON（第 3 部分）](http://blogs.msdn.com/b/fzandona/archive/2011/11/02/parsing-json-the-fun-way-json-parser-monad-part-3.aspx)
*   [Fortran 77 语义分析](http://eli-project.sourceforge.net/fortran_html/Semantics.html)
*   [实用单子](https://en.wikibooks.org/wiki/Haskell/Practical_monads)
*   [穷人的并发单子](https://www.seas.upenn.edu/~cis552/11fa/lectures/concurrency.html)

# android - 如何忽略 DialogFragment 中的“搜索”按键

> ID：11871066
> 
> 赞同：5
> 
> 时间：2012-08-08T18:43:44.200
> 
> 标签：android, android-fragments, android-dialog, android-keypad, android-dialogfragment

我之前为我的对话框扩展了类，我必须在我的对话框中使用以下代码段，以便在按下手机的*搜索*键`Dialog`时它们不会被关闭：

 *```
setOnKeyListener(new OnKeyListener()
{
  public boolean onKey(DialogInterface dialog, int keyCode, KeyEvent event)
  {
    if (keyCode == KeyEvent.KEYCODE_SEARCH)
      return true; // pretend we've processed it
    else
      return false; // pass on to be processed as normal
  }
}); 
```

我现在正在使用`DialogFragment`该类进行对话。不幸的是，与按下手机的*搜索*键时对话框被取消`DialogFragment`的问题相同（无论对话框的可取消状态如何）。双重问题是没有方法，因此上述代码段不再适用。`Dialog`*`DialogFragment``setOnKeyListener`*

 *任何人都知道如何让我的对话框（显示时）忽略*搜索*按键？

> **注意：**我尝试将上述代码段添加到我的活动`onKeyUp` 方法中，但不幸的是，如果显示实例，`onKeyUp`则不会调用我的活动方法。`DialogFragment`相反，令人恼火的是， `DialogFragment`实例被解雇了。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-13T17:37:01.930

尝试这个。
在你的里面`DialogFragment.Onresume`

```
 getDialog().setOnKeyListener(new OnKeyListener()
 {
    public boolean onKey(DialogInterface dialog, int keyCode, KeyEvent event){
    if (keyCode == KeyEvent.KEYCODE_SEARCH)
      return true; // pretend we've processed it
    else
      return false; // pass on to be processed as normal
  }
}); 
```**

# windows-phone-7 - 想要在 MS 窗口电话上的 BeginGetRespone 之后返回对象

> ID：11871071
> 
> 赞同：0
> 
> 时间：2012-08-08T18:44:00.603
> 
> 标签：windows-phone-7

我想在发布 HTTP Post 或 Get 请求后返回该对象。我可以在网络应用程序上做。现在我需要在 MS windows phone 应用程序中编写这个函数。我读了一些关于执行 HTTP Get 和 Post 请求的文章，但我仍然无法弄清楚。我想要一个帮助类来执行 Web 请求并返回对象，就像我在我的 Web 应用程序上所做的一样。我的 Windows 应用程序使用 MVVM 模式。Web 请求将由 viewmodel 调用。如何重载 BeginGetResponse 以返回对象而不是 IAsyncResult？有人会给我链接或示例来指导我。提前致谢。

Web 应用程序上有我的旧代码

```
public static T GetData<T>(Uri relativeUri)
    {
        var request = CreateRequest(relativeUri);
        HttpWebResponse r;          

        try
        {
            r = (HttpWebResponse)request.GetResponse();                 
            return Deserializer<T>(r.GetResponseStream());
        }
        catch (WebException webex)
        {
            HttpWebResponse webResp = (HttpWebResponse)webex.Response;            
            setSessionError(webResp.GetResponseStream());

        }

        return Deserializer<T>(request.GetResponse().GetResponseStream());
    }

public static T Deserializer<T>(Stream s)
    {
        //Get results   
        var ser = new DataContractSerializer(typeof(T));
        var reader = XmlDictionaryReader.CreateTextReader(s,
            new System.Xml.XmlDictionaryReaderQuotas());
        ser = new DataContractSerializer(typeof(T));
        var deserializedItem = (T)ser.ReadObject(reader, true);
        reader.Close();
        return deserializedItem;
    } 
```

我想做这样的事情：

```
public static T GetData<T>(Uri relativeUri)
    {
        var request = CreateRequest(relativeUri);
        Stream ResponseStream;
       request.BeginGetResponse(ReadCallback, request, ResponseStream);
       return Deserializer<T>(ResponseStream);
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:19:08.813

如果不使用 IAsyncResults，您将无法做到这一点。你有两个选择，WebClient 和 HttpWebRequest...

```
WebClient wc = new WebClient();
wc.DownloadStringCompleted += delegate { //do something };
wc.DownloadStringAsync(new Uri("http://website.com")); 
```

或者您可以使用 HttpWebRequest ，它具有更多功能但使用起来有点困难。

我建议像您正在做的那样创建一个帮助程序类，并向其中添加事件处理程序。事件处理程序将返回您的结果。这是一个示例。

```
public static event EventHandler CompletedDownload;

public static void StartGetData()
{
    HttpWebRequest req = (HttpWebRequest)WebRequest.Create("http://website.com");
    req.Method = "GET"; //or POST
    req.ContentType = "application/x-www-form-urlencoded";

    req.BeginGetRequestStream(GetRequestStreamCompleted, req);
}

//You can send data through this method
public static void GetRequestStreamCompleted(IAsyncResult result)
{
    HttpWebRequest req = (HttpWebRequest)result.AsyncState;
    var stream = req.EndGetRequestStream(result);

    byte[] byteData = Encoding.UTF8.GetBytes("u=" + loginData.Username + "&p=" + loginData.Password);

    stream.Write(byteData, 0, byteData.Length);
    stream.Close();

    request.BeginGetResponse(GetResponseCompleted, request);
}

public static void GetResponseCompleted(IAsyncResult result)
{
    HttpWebRequest request = (HttpWebRequest)result.AsyncState;
    HttpWebResponse response = (HttpWebResponse)request.EndGetResponse(result);

    Stream stream = response.GetResponseStream();

    //Now trigger your CompletedDownload event, sending the deserialized data
    if (CompletedDownload != null)
        CompletedDownload(Deserializer(stream), new EventArgs());
} 
```

然后在调用下载的代码中，订阅 CompletedDownload。在对象发件人中，您将拥有反序列化的数据（您必须对其进行转换）。然后只需调用 StartGetData()！

编辑：这是您在主要数据中调用的内容，因为您不确定...

```
public partial class MainPage : PhoneApplicationPage
{
    ServiceHelper.CompletedDownload += new EventHandler(ServiceHelper_CompletedDownload);

    ServiceHelper.StartGetData();
}

void ServiceHelper_CompletedDownload(object sender, EventArgs e)
{
    var q = sender as List<QueueItem>;

    //do the rest of your work here.

    //if you need to update something on the UI, you MUST call the dispatcher
    since this will be coming from a background thread... you would do this...

    System.Windows.Deployment.Current.Dispatcher.BeginInvoke(delegate
    {
        textBoxTitle.Text = q;
        MessageBox.Show("Download finished!");
    });
} 
```

那有意义吗？当您的服务助手完成下载时，它将调用 CompletedDownload 事件。您不能简单地按顺序执行并强制下载立即返回某些内容的原因是因为这会冻结您的应用程序，直到下载完成。

在 Windows 8 和 WP8 中，您实际上可以使用称为“等待”的东西，它可以让您按顺序执行操作而不会冻结它……但是对于 WP7，您必须使用这些 IAsyncResults 和回调方法。

顺便说一句，对于事件处理程序，您有多种使用它们的方法......这里还有另外两种：

```
public partial class MainPage : PhoneApplicationPage
{
    ServiceHelper.CompletedDownload += delegate
    {
        string answer = "I rock";
    };

    ServiceHelper.StartGetData();
} 
```

或者这另一个。这两者都为您提供了可以完全访问您在当前方法中定义的局部变量的优势。第二个为您提供了从事件处理程序访问对象发送者和 EventArgs e 的优势。

```
public partial class MainPage : PhoneApplicationPage
{
    ServiceHelper.CompletedDownload += (sender, e) =>
    {
        string answer = "I rock";
    };

    ServiceHelper.StartGetData();
} 
```

享受！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T03:48:34.170

你可以试试异步 CTP 包。 [http://msdn.microsoft.com/en-us/vstudio/async.aspx](http://msdn.microsoft.com/en-us/vstudio/async.aspx) 或使用 EX 可以很容易。

女士一直是真正的 C# 5，因此它将支持异步并等待这方面的好工作。

[http://reedcopsey.com/2010/10/28/c-5-async-part-1-simplifying-asynchrony-that-for-which-we-await/](http://reedcopsey.com/2010/10/28/c-5-async-part-1-simplifying-asynchrony-that-for-which-we-await/)

# jquery - 如何从 Google Places API 访问 JSON 响应

> ID：11871072
> 
> 赞同：2
> 
> 时间：2012-08-08T18:44:01.017
> 
> 标签：jquery, jsonp, google-places-api

我试图弄清楚如何使用 Google Places API。我已经阅读了他们所有的文档。我只是想弄清楚如何在 JSON 响应中获取数据。我不想将响应输出到地图。我想访问地名等内容。

我在上一篇文章中尝试使用 $.getJSON jquery 函数（http://stackoverflow.com/questions/11642418/trying-to-use-google-places-api-with-jquerys-getjson-function） ，但是我无法让浏览器相应地解析 JSON 响应，我在想是因为 JSON 响应位于远程服务器中。我现在正在尝试使用 JSONP，但我有同样的错误。

```
<script type="text/javascript">

    function jasonPCall() {
        var url = 'https://maps.googleapis.com/maps/api/place/search/json?location=-33.8670522,151.1957362&radius=500&types=food&name=harbour&sensor=false&key=****my key****&callback=?';

        $.ajax({
            type: 'GET',
            url: url,
            async: false,
            jsonpCallback: 'jsonCallback',
            contentType: "application/json",
            dataType: 'jsonp',
            success: function (json) {

                console.log("We got a response.");
                console.dir(json.results[0].name);

            },
            error: function (e) {
                console.log("We didn't get a response.");
                console.log(e.message);
            }
        });
    }
</script> 
```

我正在尝试做的事情可能吗？如果是这样，那么您应该如何访问 Google Places 提供的 JSON 回复数据？有人可以发布一个正确方法的简单示例吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:18:32.163

据我回忆，不支持通过javascript访问places api。您必须使用 Google Maps javascript sdk 的 Places Library 才能访问它。[https://developers.google.com/places/documentation/](https://developers.google.com/places/documentation/)上的位置文档的第一行 说“希望在 JavaScript 应用程序中使用此服务？查看 Google Maps API v3 的位置库。”

# java - 具有多个首选项文件的 PreferenceActivity

> ID：11871073
> 
> 赞同：6
> 
> 时间：2012-08-08T18:44:02.177
> 
> 标签：java, android, sharedpreferences, android-preferences

在 PreferenceActivity 中使用首选项文件（而不是默认的共享首选项）的方式如下：

```
public class MyPreferencesActivity extends PreferenceActivity {
    protected void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);

         PreferenceManager prefMgr = getPreferenceManager();
         prefMgr.setSharedPreferencesName("my_preferences");
         prefMgr.setSharedPreferencesMode(MODE_WORLD_READABLE);

         addPreferencesFromResource(R.xml.preferences);
    }
} 
```

在此示例中，我们使用名为“my_preferences”的共享首选项。但是我们如何在同一个 PreferenceActivity 中使用多个自定义首选项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T18:49:41.813

声明您的首选项文件的名称，并在检索首选项时，提及您要在 getSharedPreferences() 中访问的文件的名称。

这里我声明了两个文件名：PrefFile 和 PrefFileNEW；然后我在检索首选项时将各自的名称传递给 getSharedPreference()。

```
 public static final String PREF_FILE_NAME = "PrefFile";
    public static final String PREF_FILE_NAME_NEW = "PrefFileNEW";
    SharedPreferences preferences = getSharedPreferences(PREF_FILE_NAME, MODE_PRIVATE);
{
//access your preferences here
}

SharedPreferences preferences_new = getSharedPreferences(PREF_FILE_NAME_NEW, MODE_PRIVATE);

{
//access your preferences_new here
} 
```

希望能帮助到你。

# php - 密码哈希应该以二进制还是十六进制存储？

> ID：11871074
> 
> 赞同：14
> 
> 时间：2012-08-08T18:44:07.173
> 
> 标签：php, mysql, security, hash, passwords

我通常将它存储为十六进制数字，但我意识到如果我将它存储在 MySQL 中的二进制文件中，我可以节省一半的空间。如果我决定将其存储为二进制文件，我应该注意哪些问题？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-08T18:46:02.733

您希望存储多少个密码？一半的空间对你来说真的那么重要吗？

您可能在应用程序中以十六进制形式表示密码，因此在对这些密码执行任何操作时，将它们存储为二进制会增加另一层复杂性和处理开销。

我的意见是，您应该以方便您使用的方式存储它们，而不是为您节省少量空间。

**编辑：**

做一些假设，并借此机会进一步帮助你。

由于您的密码是十六进制的，我假设您没有使用[`crypt`](http://php.net/crypt)，如果您没有使用，那么您应该使用。最坏的情况，你正在使用 md5 ......而上帝正在杀死小猫。

已经有很多关于 bcrypt on stack overflow 的问题和答案，所以我不会在这里再次介绍这些信息。

[不过， SHA512 与 Blowfish 和 Bcrypt](https://stackoverflow.com/questions/1561174/sha512-vs-blowfish-and-bcrypt)的问题是一个很好的起点。

还可以阅读[@ircmaxell](https://stackoverflow.com/users/338665/ircmaxell)关于该主题的几篇博客文章：

*   [介绍密码库](http://blog.ircmaxell.com/2012/04/introducing-passwordlib.html)
*   [安全程序员承诺](http://blog.ircmaxell.com/2012/07/secure-programmers-pledge.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-08T18:48:38.917

从可用性的角度来看，最好将散列存储为十六进制。以二进制形式存储它们意味着还需要一个步骤来将纯文本输入与存储的密码进行比较。它也有可能给在你继续工作后从事你的项目的任何人增加一层混乱。“为什么这个密码以二进制形式存储？”

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2020-06-30T10:10:21.773

**免责声明**：让我们说实话，这个问题必须在纯粹基于意见的情况下被关闭。因此，您得到的任何答案都是偏好和经验的问题。

只是为这个问题添加我的常识答案：您应该以从加密工具/方法中获取它的方式存储它。

任何好的加密都有一个`encrypt`和一个`decrypt`或`compare`方法。通常，`encrypt`您需要将输出作为输入传递给`decrypt`/ `compare`。

无论`encrypt`产生什么输出，都应该是存储它的首选方式。

您可以将输出转换为您喜欢的任何内容，无论是二进制、十六进制、base64 还是使用笔和纸写下来，加密值都不会变得或多或少安全。找到该值的人将需要加密密钥来解密它。

但是每次转换某些内容时，您还需要将其转换回之前的状态。这意味着您添加了一层新的潜在问题并增加了整个过程的开销。不管它可能多么微不足道，它仍然比不做它更复杂/更慢。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-28T05:31:08.993

密码的主要动机是*它的安全性，而不仅仅是扩展它在数据库中占用的大小或空间，*因此您的密码必须包含所有安全实体，例如**算法**、**算法选项**（例如：时间成本，内存成本，线程），**盐**，**散列密码**。所有这些都使您的密码比简单的十六进制或二进制密码更强大。

**参考：**

[安全密码散列](https://www.php.net/manual/en/faq.passwords.php)

[密码哈希](https://www.php.net/manual/en/function.password-hash.php)

根据第一个链接*，建议在散列密码时使用的算法是 Blowfish，这也是密码散列 API 使用的默认算法，因为它的计算成本明显高于 MD5 或 SHA1，同时仍然具有可扩展性。*

**您可以使用**

```
echo password_hash("rasmuslerdorf", PASSWORD_DEFAULT); 
```

**输出**

```
$2y$10$.vGA1O9wmRjrwAVXD98HNOgsNpDczlqm3Jq7KnEd1rVAGv3Fykk1a 
```

这里您的密码由所有**算法**、**算法选项**（例如：时间成本、内存成本、线程）、**盐**、**哈希密码组成**

# javascript - 检测 WebGL 支持的正确方法？

> ID：11871077
> 
> 赞同：55
> 
> 时间：2012-08-08T18:44:16.260
> 
> 标签：javascript, jquery, firefox, cross-browser, webgl

我试图检测跨多个浏览器的 WebGL 支持，我遇到了以下情况。当前版本的 Firefox 似乎使用以下检查报告了积极的支持，即使访问者的视频卡被列入黑名单和/或 WebGL 被禁用：

```
if (window.WebGLRenderingContext) {
    // This is true in Firefox under certain circumstances,
    // even when WebGL is disabled...
} 
```

我尝试指导我的用户使用以下步骤启用 WebGL。这在某些情况下有效，但并非总是如此。显然，这不是我可以向公众要求的：

1.  在 Firefox 的地址栏中输入about **:config**
2.  要启用 WebGL，请将**webgl.force-enabled**设置为 true

这导致我创建了自己的检测支持的方法，它使用 jQuery 注入一个画布元素来检测支持。这借鉴了我在各种 WebGL 库和插件中发现的许多技术。问题是，它非常难以测试（非常感谢您对以下链接是否对您有用的任何评论！）。为了使这个问题成为一个客观的问题，**我想知道是否有一种普遍接受的方法来检测所有浏览器对 WebGL 的支持**。

测试网址：

[http://jsfiddle.net/Jn49q/5/](http://jsfiddle.net/Jn49q/5/)

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2014-04-09T04:53:42.127

优秀的 Three 库实际上有一个检测以下内容的机制：

1.  WebGL 支持
2.  文件 API 支持
3.  工人支持

特别是对于 WebGL，这里是使用的代码：

```
function webgl_support () { 
   try {
    var canvas = document.createElement('canvas'); 
    return !!window.WebGLRenderingContext &&
      (canvas.getContext('webgl') || canvas.getContext('experimental-webgl'));
   } catch(e) {
     return false;
   }
 }; 
```

该代码片段是[Detector](https://github.com/mrdoob/three.js/blob/master/examples/js/Detector.js)类的一部分，它还可以向用户显示相应的错误消息。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2012-08-08T18:51:01.047

[ **2014 年 10 月]**我更新了 modernizrs 示例以匹配他们[当前的实现，这是一个来自](https://github.com/Modernizr/Modernizr/blob/master/feature-detects/webgl/extensions.js)[http://get.webgl.org/](http://get.webgl.org/)的清理版本。

[Modernizr](http://modernizr.com/)确实如此，

```
var canvas;
var ctx;
var exts;

try {
  canvas = createElement('canvas');
  ctx = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
  exts = ctx.getSupportedExtensions();
}
catch (e) {
  return;
}

if (ctx !== undefined) {
  Modernizr.webglextensions = new Boolean(true);
}

for (var i = -1, len = exts.length; ++i < len; ){
  Modernizr.webglextensions[exts[i]] = true;
}

canvas = undefined; 
```

[Chromium](https://bugs.webkit.org/show_bug.cgi?id=70117)指向[http://get.webgl.org/](http://get.webgl.org/)以获得规范的支持实现，

```
try { gl = canvas.getContext("webgl"); }
catch (x) { gl = null; }

if (gl == null) {
    try { gl = canvas.getContext("experimental-webgl"); experimental = true; }
    catch (x) { gl = null; }
} 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2014-07-15T19:47:15.820

如[http://www.browserleaks.com/webgl#howto-detect-webgl所示](http://www.browserleaks.com/webgl#howto-detect-webgl)

> 这是一个检测 WebGL 支持的适当 javascript 函数，具有各种实验性 WebGL 上下文名称并检查特殊情况，例如通过 NoScript 或 TorBrowser 阻止 WebGL 函数。
> 
> 它将报告三种 WebGL 功能状态之一：
> 
> *   WebGL 已启用 — 返回 TRUE，或返回
> *   WebGL 对象，如果第一个参数被传递
> *   WebGL 已禁用 — 返回 FALSE，如果需要，您可以更改它>
> *   WebGL 没有被暗示——返回 FALSE

```
function webgl_detect(return_context)
{
    if (!!window.WebGLRenderingContext) {
        var canvas = document.createElement("canvas"),
             names = ["webgl2", "webgl", "experimental-webgl", "moz-webgl", "webkit-3d"],
           context = false;

        for(var i=0;i< names.length;i++) {
            try {
                context = canvas.getContext(names[i]);
                if (context && typeof context.getParameter == "function") {
                    // WebGL is enabled
                    if (return_context) {
                        // return WebGL object if the function's argument is present
                        return {name:names[i], gl:context};
                    }
                    // else, return just true
                    return true;
                }
            } catch(e) {}
        }

        // WebGL is supported, but disabled
        return false;
    }

    // WebGL not supported
    return false;
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-11-05T00:12:24.870

除了@Andrew 回答之外，还可以支持实验模式。我写了以下代码片段：

```
var canvasID = 'webgl',
    canvas = document.getElementById(canvasID),
    gl,
    glExperimental = false;

function hasWebGL() {

    try { gl = canvas.getContext("webgl"); }
    catch (x) { gl = null; }

    if (gl === null) {
        try { gl = canvas.getContext("experimental-webgl"); glExperimental = true; }
        catch (x) { gl = null; }
    }

    if(gl) { return true; }
    else if ("WebGLRenderingContext" in window) { return true; } // not a best way, as you're not 100% sure, so you can change it to false
    else { return false; }
} 
```

`canvasID`根据您的 ID更改变量。

在 Chrome、Safari、Firefox、Opera 和 IE（8 到 10）上测试。如果是 Safari，请记住它是可用的，但您需要明确启用 WebGL（启用开发人员菜单并在之后启用 Web GL 选项）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-12-07T23:38:53.490

为了检测支持 WebGL 的浏览器，但排除较旧的浏览器可能无法很好地支持它（当[WebGL 实际上不是](https://stackoverflow.com/questions/41006612/webgl-detected-as-supported-when-it-is-actually-not/41029281)为了排除 Android 4.4.2 设备时需要检测为支持），我添加了一个更严格的，虽然无关检查：

```
function hasWebGL() {
    var supported;

    try {
        var canvas = document.createElement('canvas');
        supported = !! window.WebGLRenderingContext && (canvas.getContext('webgl') || canvas.getContext('experimental-webgl'));
    } catch(e) { supported = false; }

    try {
        // let is by no means required, but will help us rule out some old browsers/devices with potentially buggy implementations: http://caniuse.com/#feat=let
        eval('let foo = 123;');
    } catch (e) { supported = false; }

    if (supported === false) {
        console.log("WebGL is not supported");
    }

    canvas = undefined;

    return supported;
}, 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-08-10T20:37:00.523

```
// this code will detect WebGL version until WebGL Version maxVersionTest 
var
maxVersionTest = 5,
canvas = document.createElement('canvas'),
webglVersion = (canvas.getContext('webgl') || canvas.getContext('experimental-webgl')) ? 1 : null,
canvas = null; // free context

// range: if maxVersionTest = 5 makes [5, 4, 3, 2]
Array.apply(null, Array(maxVersionTest - 1))
.map(function (_, idx) {return idx + 2;})
.reverse()
.some(function(version){
    // cant reuse canvas, potential to exceed contexts or mem limit *
    if (document.createElement('canvas').getContext('webgl'+version))
        return !!(webglVersion = version);
});

console.log(webglVersion); 
```

* 重新“可能超过上下文或内存限制”请参阅 [https://bugs.chromium.org/p/chromium/issues/detail?id=226868](https://bugs.chromium.org/p/chromium/issues/detail?id=226868)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-06-07T14:17:22.007

来自[MDN](https://developer.mozilla.org/en-US/docs/Learn/WebGL/By_example/Detect_WebGL)：

```
// Run everything inside window load event handler, to make sure
// DOM is fully loaded and styled before trying to manipulate it.
window.addEventListener("load", function() {
  var paragraph = document.querySelector("p"),
    button = document.querySelector("button");
  // Adding click event handler to button.
  button.addEventListener("click", detectWebGLContext, false);
  function detectWebGLContext () {
    // Create canvas element. The canvas is not added to the
    // document itself, so it is never displayed in the
    // browser window.
    var canvas = document.createElement("canvas");
    // Get WebGLRenderingContext from canvas element.
    var gl = canvas.getContext("webgl")
      || canvas.getContext("experimental-webgl");
    // Report the result.
    if (gl && gl instanceof WebGLRenderingContext) {
      paragraph.innerHTML =
        "Congratulations! Your browser supports WebGL.";
    } else {
      paragraph.innerHTML = "Failed to get WebGL context. "
        + "Your browser or device may not support WebGL.";
    }
  }
}, false);
```

```
body {
  text-align : center;
}
button {
  display : block;
  font-size : inherit;
  margin : auto;
  padding : 0.6em;
}
```

```
<p>[ Here would go the result of WebGL feature detection ]</p>
<button>Press here to detect WebGLRenderingContext</button>
```

# windows-phone-7 - 如何将对象传递给 wp7 上的点击事件方法

> ID：11871078
> 
> 赞同：0
> 
> 时间：2012-08-08T18:44:18.107
> 
> 标签：windows-phone-7, button, click

我正在创建一个按钮（不使用 xaml，因为它是一组应该根据某种需要动态创建的按钮，而不是经常存在）。当您想告诉按钮该做什么时，您正在向 click 事件添加一个方法，如下所示：

```
btn.Click += b_ClickMethod; 
```

b_clickMethod 具有以下签名：

```
private void b_ClickMethod(object sender, RoutedEventArgs e) 
```

我的问题是如何（或者即使我实际上可以）将某个对象作为发送者传递，以便将信息传递给该方法。如果这个对象已经设置在其他地方，那么它代表什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T22:36:48.593

我通常从一个对象获取信息到它的事件处理程序的方式是使用它的`DataContext`. 如果这对您来说是一个选择（很难说是不是），这是一件非常容易的事情。如果设置`DataContext`了按钮的 （您可以很容易地从代码隐藏中执行此操作），您可以像这样访问它：

```
private void b_ClickMethod(object sender, RoutedEventArgs e)
{
    // Let's say you're trying to pass a Car-object
    var car = sender.DataContext as Car;

    // Manipulate away.
} 
```

您设置 DataContext 的方式是 - 非常简单：

```
CarViewModel someViewModel = new ViewModel(); // or whatever
Car someCarObject = someViewModel.getSomeCar(); // basically - find the object you would like to send.
btn.DataContext = someCarObject; 
```

希望这可以帮助。最后，您可能需要重新考虑创建这样的按钮。如果您只在某些情况下需要按钮，只需将这些按钮的`Visibility`参数设置为`Visibility.Hidden`.

# android - 不知道这种安卓导航叫什么

> ID：11871080
> 
> 赞同：0
> 
> 时间：2012-08-08T18:44:19.270
> 
> 标签：android, navigation, uinavigationbar

在标题栏下方的屏幕截图中，我需要创建这种类型的导航。我不是在寻找“教我”，而只是在某个地方指向我。这是原生机器人元素吗？如果是这样，它叫什么，所以我可以RTFM！我以前见过它，但我不记得在哪里。-- 或者我需要构建一个自定义片段。

[外观示例](http://dev.marketingclique.com/nav-example.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T18:59:58.327

我想您是在询问 ViewPager ...请参见此处：

[http://android-developers.blogspot.com/2011/08/horizo​​ntal-view-swiping-with-viewpager.html](http://android-developers.blogspot.com/2011/08/horizontal-view-swiping-with-viewpager.html)

和这里：

[http://developer.android.com/reference/android/support/v4/view/ViewPager.html](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T19:02:38.537

基本上你正在寻找[`ViewPager`](http://developer.android.com/reference/android/support/v4/view/ViewPager.html).

> *约瑟夫*
> 
> 该技术被称为“Swipey Tabs”，由谷歌用户界面工程师 Kirill Grouchnikov 在这篇博文中描述。
> 
> Andreas Stütz 做了一个项目来复制名为 android-viewpagertabs 的功能。其他人也有过尝试。

[链接到帖子](https://stackoverflow.com/questions/7971758/android-how-to-make-a-tab-flip-like-android-market)

# java - 如何打印整个数据库

> ID：11871084
> 
> 赞同：0
> 
> 时间：2012-08-08T18:44:39.247
> 
> 标签：java, mysql, executequery

我有一个名为的表`ClientsTable`和一个名为`myDb`.

如何打印`System.out.prinln()`整个数据库？我只想选择所有行并将所有字段呈现到屏幕上。

谢谢

**编辑：**我应该放什么而不是`rs.getString()`, 在这里（因为它不编译）：

```
 ResultSet rs = this.m_statement.executeQuery("SELECT * FROM CheckingAccountsTable");
    while (rs.next())
        System.out.println(rs.getString()); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T19:05:14.470

如果您不知道表中有多少列，请尝试以下操作：

```
 ResultSet rs = this.m_statement.executeQuery("SELECT * FROM CheckingAccountsTable");
    int columnCount = rs.getMetaData().getColumnCount();
    while (rs.next()) {
        for (int i = 1; i <= columnCount; i++) {
            System.out.print(rs.getString(i));
        }
        System.out.println();
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T18:46:23.497

SQL 查询将是：

```
SELECT * FROM DB_TABLE_NAME 
```

然后您可以遍历您的结果集并将其打印出来。

编辑：

您没有指定要打印的列。

下面的例子：

```
System.out.println(rs.getString("COLUMN_NAME")); 
```

第二次编辑：

```
ResultSet rs = this.m_statement.executeQuery("SELECT * FROM CheckingAccountsTable");
int colCount = rs.getMetaData().getColumnCount();
while (rs.next()){
    for(int i = 1; i < colCount + 1; i++){
       System.out.println(rs.getString(i));
    }
} 
```

# jquery - jQuery slideDown/slideUp 问题

> ID：11871092
> 
> 赞同：0
> 
> 时间：2012-08-08T18:45:02.353
> 
> 标签：jquery, html, css, slidedown

我无法让 jQuery slideDown 效果起作用。我正在尝试通过向下滑动来显示面板。相反，它只是像 show() 方法一样显示，但在 Firefox 中它甚至不显示。

jQuery：

```
$("#linkHBE").click(function(){
    if ($(".panel").is(":hidden")) {
        $(".panel").show("slow");
    } 
    else 
        $(".panel").hide("slow");
}); 
```

的HTML：

```
 <div class="panel"></div>

 <ul id="grid">
      <li class="web"><a id="linkHBE"><img  width="296px" height="196px"></a></li>
      <li class="graphic"><img width="296px" height="196px"></li>
      <li class="web"><img width="296px" height="196px"></li>
 </ul> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T18:46:16.827

```
$("#linkHBE").click(function(e) {
    e.preventDefault();
    $('.panel').toggle(1000); // fadeToggle() or slideToggle() are also available
}); 
```

**[演示](http://jsfiddle.net/DVS9x/3/)**

* * *

在这里，`e.preventDefault()`是为了防止页面重新加载以单击锚标记。jQuery**[`.toggle()`](http://api.jquery.com/toggle)**会为你做显示隐藏。因此，无需额外检查。

* * *

**相关参考：**

*   **[防止默认（）](http://api.jquery.com/event.preventdefault)**

*   **[淡入淡出切换（）](http://api.jquery.com/fadetoggle)**

*   **[滑动切换（）](http://api.jquery.com/slidetoggle)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T18:49:31.047

您的代码不起作用的原因是您的处理程序没有取消默认事件，因此浏览器正在跟踪链接。尝试这个：

```
$("#linkHBE").click(function(e){
    $(".panel").slideToggle("slow");
    e.preventDefault();
}); 
```

# java - 使用抽象类绘制函数图

> ID：11871094
> 
> 赞同：0
> 
> 时间：2012-08-08T18:45:05.657
> 
> 标签：java

这是我在一本关于 java 的书中找到的练习。我无法解决它。

```
 public abstract class AbstractDrawFunction extends JPanel {
    /** Polygon to hold the points */
    private Polygon p = new Polygon();
    protected AbstractDrawFunction () {
    drawFunction();
    }
    /** Return the y-coordinate */
    abstract double f(double x);
    /** Obtain points for x-coordinates 100, 101, ..., 300 */
    public void drawFunction() {
    for (int x = -100; x <= 100; x++) {
    p.addPoint(x + 200, 200 - (int)f(x));
     }
    }
    /** Implement paintComponent to draw axes, labels, and
    * connecting points
    */
    protected void paintComponent(Graphics g) {
    // To be completed by you
     }
    }

Test the class with the following functions:
f(x) = x2;
f(x) = sin(x);
f(x) = cos(x);
f(x) = tan(x);
f(x) = cos(x) + 5sin(x);
f(x) = 5cos(x) + sin(x);
f(x) = log(x) + x2; 
```

对于每个函数，创建一个扩展 AbstractDrawFunction 类并实现 f 方法的类。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T19:01:35.350

实现子类是容易的部分。只需扩展类并实现方法；我想你已经知道并理解如何做到这一点。如果没有，请在您的书中查找“派生类”。

这`paintComponent`部分有点难，但前提是它假设您将函数缩放到缩放。看起来该方法应该在 200 x 200 窗口中绘制图形，函数范围从 -100 到 100。因此没有缩放，但您不会看到太多正弦和余弦函数。
您不必缩放的事实也意味着绘制轴很容易。请注意，坐标系从 -100 运行到 100，这应该可以为您提供足够的线索。

保重`tan`！它不是为所有输入值定义的。其他功能之一也是如此，这可能就是他们在练习中的原因。

该方法使用`Polygon`. `Polygon`可以通过调用 来简单地绘制A `Graphics.drawPolygon`，但该方法将*关闭*它：最后一个点将与第一个点相连。
对此有一些解决方法，例如添加额外的点并强制将额外的线精确地绘制在轴上。但它们不适用于所有公式，我认为这不是你应该研究的。该练习可能只是使用`Polygon`，因此您可以调用`drawPolygon`实际渲染。

要将 JPanel 添加到 JFrame，请使用`JFrame.add( subclass )`或`JFrame.setContentPane( subclass )`。

# iphone - UIBarButtonItem 到情节提要视图

> ID：11871095
> 
> 赞同：0
> 
> 时间：2012-08-08T18:45:08.327
> 
> 标签：iphone, ios, xcode, storyboard, uibarbuttonitem

我在单独的 xib 文件中有一个 UIBarButton 项，但是当按下该按钮时，我想将它带到我的故事板上的视图中。

我可以从情节提要视图（按下圆形矩形按钮时）转到单独的自定义 xib 文件视图。但我不能回去（使用圆形矩形按钮或 uibarbuttonitem）。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T20:01:13.277

如果您使用此代码从 xib 创建视图：

```
-(IBaction)button { 
    MainViewController *viewOther = [[MainViewController alloc] initWithNibName:@"MainViewController" bundle:[NSBundle mainBundle]]; 
    [self.view addSubview:viewOther.view]; 
    [THISViewController release]; 
} 
```

然后只需在新的子视图控制器中执行此操作以将其删除并“返回”到情节提要上的视图：

```
[self.view removeFromSuperview]; 
```

但是，我认为这根本不是处理这个问题的最佳方法。我会以 a 的形式呈现新`viewController`的`modalViewController`，然后在使用它完成时将其解雇：

介绍它：

```
-(IBaction)button { 
    MainViewController *viewOther = [[MainViewController alloc] initWithNibName:@"MainViewController" bundle:[NSBundle mainBundle]];
    [self presentModalViewController:viewOther animated:YES];
} 
```

然后使用它释放它：

```
[self dismissModalViewControllerAnimated:YES]; 
```

但是，这仍然不是最好的方法。最好的方法是在 中创建一个委托，`MainViewController`然后让情节提要视图控制器将自己分配为`MainViewController`. 然后当按下按钮时，`MainViewController`应该告诉它`delegate`（故事板视图控制器）将其关闭，然后故事板视图控制器将关闭`MainViewController`. 不过，这需要一点时间来解释，尤其是在您不熟悉创建协议的情况下。

# xcode - 使用源代码管理时，Xcode 卡在“正在加载修订版”和“正在扫描工作副本...”

> ID：11871096
> 
> 赞同：20
> 
> 时间：2012-08-08T18:45:14.283
> 
> 标签：xcode, version-control

我最近注意到，我当前项目中的一些提交正在“组织者 - 存储库”窗口中的其他项目下显示。此外，“Organizer - Repositories”窗口还在左侧面板列表中显示了我未处理的其他项目，包括当前项目的副本。因此，我使用左下角的 (-) 键从左侧面板中删除了不必要的项目列表。

但是现在看来，Xcode 中的版本编辑器（在助手编辑器按钮旁边）不起作用。当我尝试加载“Time Machine”视图（带有 CCW 箭头的时钟指针）时，状态栏显示“Loading Revision”并且从不加载我之前的提交。我之前的提交出现在当前项目下的“Organizer - Repositories”窗口中。

此外，尝试进行新提交会导致 Xcode 对话框显示“请稍候，正在扫描工作区以查找工作副本”，而其下方则停留在短语“正在扫描工作副本...”上，下一个微调器给它。

我刚开始使用源代码控制时，Xcode 也遇到了其他几个问题。我正在运行外接显示器并使用 Lion（如果相关）。我的另一个新问题是，如果我离开计算机并返回，iOS 模拟器经常会死机（因此我必须重新登录）。这迫使我强制退出 Xcode 并重新启动它。

* * *

更新 1：以下链接似乎*可以*解决问题，只是“位置”字段不可编辑（即，它是灰色的）并且设置为“不适用”。（参见[Xcode 4 停留在“扫描工作副本”](https://stackoverflow.com/questions/9754605/xcode-4-stuck-on-scanning-for-working-copies)）

更新 2：最近一次重新启动 Xcode 后，我现在可以再次提交。我还意识到每个文件的“时间机器”视图都不同；即，它只会可视化该特定文件的修订历史。我仍然不明白为什么我对当前项目所做的一些提交也出现在其他项目下，或者为什么 Xcode 认为这些项目一开始是开放的（通过单击 Dock 中的 Xcode 图标来证明） .

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-09-10T04:01:08.557

I resolved the issue by deleting everything inside of:

```
yourproject.xcodeproj/project.xcworkspace/ 
```

No harm done to the project at all and the Xcode crashing with every change done to the project stopped as well.

Also you will need to exit the version editor.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-10T13:36:54.027

我刚刚在 Git 存储库中的一个项目中遇到了同样的问题。在尝试了几个不同的“修复”后，我从 Xcode 项目中删除了文件“contents.xcworkspacedata”，即

yourproject.xcodeproj/project.xcworkspace/contents.xcworkspacedata

可能值得先获取文件的副本，以防它使问题变得更糟。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-10-22T13:22:52.307

There is a specific file to remove in order to fix this issue:

```
rm [your-project].xcodeproj/project.xcworkspace/xcshareddata/[your-project].xccheckout 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-02-25T17:46:15.293

Just doing a force quit on Xcode fixed it for me :)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-09-28T08:05:47.850

I tried deleting all these files but nothing worked except for blowing away my workspace and recloning.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-04-10T18:08:40.300

I just got this problem, and deleting xcworkspace did not help.
**Looks like Xcode refuses to use a newer svn version.**

In detail: My project was originally checked out with svnX which uses the current version of svn (1.8.13) I installed in brew. I later used Xcode (6.2) to open the project, assuming it would just find the working copy - which it did, but with above problem.
So, to test, I checked out the project to a different location using Xcode - and voila, the version editor seemed to work. Then I used svnX to look at that working copy, and it said that the wc would need updating to the current svn version. So, obviously Xcode uses its own (outdated) svn version, and then gets stuck when a working copy was checked out using a newer version. (As a way out, in Netbeans I would just configure it to use the svn binary on my system - but I did not find such an option in Xcode...) Will now install Xcode 6.3 and hope that improves things...

# javascript - 使用 jQuery 在 div 标签内添加一些字符串

> ID：11871100
> 
> 赞同：1
> 
> 时间：2012-08-08T18:45:33.893
> 
> 标签：javascript, jquery

我只是想`#OL_Icon_63`使用 jQuery在 div 中添加一些字符串或 HTML 标记`.append()`，这是代码示例：

```
$(document).ready(function() {
    $('#OL_Icon_63').append('HELLO WORLD');
}); 
```

但那是代码对我不起作用，我尝试像这样更改代码：

```
$(document).ready(function() {
    $("body").click(function() {
       $('#OL_Icon_63').append('HELLO WORLD');
    });
}); 
```

和

```
$(document).ready(function() {
    $("body").hover(function() {
       $('#OL_Icon_63').append('HELLO WORLD');
    });
}); 
```

两种代码对我有用，在我使用的地方`.hover()`和`.click()`在 body 标记之后，但我基本上不能使用 .append() 之类的函数或任何其他函数，而无需在 $("body") 之后添加 .hover() 或 .click() 但是当我使用单击或悬停时，字符串重复出现

谁能给我一些例子/意见，以便`.append()`jQuery 函数对我来说完美吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T18:48:11.860

更通用的解决方案是使用 javascript 函数是对象这一事实，一旦调用函数 clickAction，它会在附加文本后将自身设置为空白函数

**编辑** 由于它处理事件的方式，这在 jQuery 中不起作用，但是它确实包含一个名为 one() 的方法

```
$(document).ready(function() {
  var clickAction = function(){
     $('div').append("Hello World");
  } 
    $("div").one("click",clickAction);
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T18:48:06.500

改用`text`：

```
$('#OL_Icon_63').text("hello world") 
```

您使用的附加错误。Append 用于将*元素*添加到元素的 innerHTML。`text`用于文本，`html`用于 HTML

这也将替换元素中的所有文本，因此不会有倍数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T19:00:44.603

你为什么不试试`$(document).ready`这对我有用：

```
(function(){
    $('#OL_Icon_63').append('HELLO WORLD');
})(); 
```

工作示例：http: [//jsfiddle.net/tgzKQ/](http://jsfiddle.net/tgzKQ/)

# python - Python 3.x：更新一个项目而不是每次都复制整个项目

> ID：11871101
> 
> 赞同：4
> 
> 时间：2012-08-08T18:45:44.300
> 
> 标签：python, python-3.x

所以我不确定这个功能是否存在。这是场景：

我已经使用[它](http://guide.python-distribute.org/quickstart.html#lay-out-your-project)来设置我的项目，并且`$ python setup.py sdist`每次我想要发布新版本时都会运行该命令。问题是，这使得开始变得多余并且该过程可能需要太长时间，特别是当我更新的只是一个或两个文件时。我不需要创建一个全新的项目，只需更新与前一个项目相比发生的变化。有没有人可以做到这一点？如果不清楚，那么我可以尝试更好地解释，但让我们看看人们是否理解我的意思。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T17:10:01.183

If you indeed want to make a release each time and are bothered by the time it takes, you are probably making releases too often.

However, if you're only looking for installing the package locally for testing, you should be doing `pip install -e /path/to/package`, which creates symlinks for your package in the system. You only need to do this once. Every change to the package source will be immediately seen by the system

# django - Django：生成下载链接

> ID：11871104
> 
> 赞同：16
> 
> 时间：2012-08-08T18:45:58.653
> 
> 标签：django, download

我有一个`File`模型，它`path`在文件系统中存储字段 - 文件路径。所有文件都存储在 MEDIA_ROOT/files

`File`在模板中，我想为对象生成下载链接。做这个的最好方式是什么？我应该在 django 中使用静态文件处理吗？

蒂亚！

**UPD**

`File`模型

```
class File(models.Model):
    item = models.ForeignKey(Item)
    file = models.FileField(upload_to = os.path.join(MEDIA_ROOT,'items'))
    format = models.CharField(max_length = 255) 
```

在项目的视图中，我执行以下操作：

`files = File.objects.filter(item_id = id)`

并传递`files`给模板

例如，在我使用的模板`files.1.file.url`中，仍然有错误的网址，例如`site.com/home/dizpers/...`

**UPD2**

[相关问题](https://stackoverflow.com/questions/1756190/django-filefield-url-not-relative)

**解决方案**

我的问题出在文件模型中，在`file`现场。在 upload_to 参数中，我使用绝对路径，但必须使用相对路径：

`file = models.FileField(upload_to = 'items')`

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-08T18:54:24.483

我不确定您所说的“生成下载链接”到底是什么意思，但要简单地链接到文件，只需将`{{ some_file.url }}`其用作您的`href`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-08T20:27:19.603

在`models.py`：

```
import os

from django.conf import settings
from django.db import models

class File(models.Model):
    ... (your existing File model)

    @property
    def relative_path(self):
        return os.path.relpath(self.path, settings.MEDIA_ROOT) 
```

（使用[该`relpath`方法](http://docs.python.org/library/os.path.html#os.path.relpath)`MEDIA_ROOT`从 的值中剥离`self.path`）

在您的`file_detail.html`（或等效的）模板中：

```
<a href='{{ MEDIA_URL }}{{ file.relative_path }}'>{{ file.name }}</a> 
```

*注意*正如克里斯所说，最好在`FileField`这里使用 a 。以上内容有望适用于您的确切情况，但除非您坚定地致力于以这种方式安排事情，否则我建议您更改为专用领域。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-08T19:13:30.620

尝试使用`href="{{ STATIC_URL }}/files/somefile"`, 或`href="{{ MEDIA_URL }}/files/somefile"`用于用户上传的内容

# android - 如何让 ListView Header 可选？

> ID：11871107
> 
> 赞同：0
> 
> 时间：2012-08-08T18:46:15.127
> 
> 标签：android

我在我的 ListView 中添加了一个 Header。它看起来很好，但无论我尝试什么，让它可以选择，没有任何工作。

目前我正在做：

```
hazardHeaderView =
    (View)getLayoutInflater().inflate(R.layout.warning_header, null);

hazardHeaderView.setClickable(true); 
```

我已经`OnClickListener`为它设置好了，但是`Log`我在那里的消息永远不会被调用。

我需要做什么才能检测到用户点击了标题？

我已经尝试了上述几种变体，但没有任何效果。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:18:26.357

我想你正在夸大第二个warning_header。显示的视图是否可能不是您附加`OnClickListener`.

要获取显示的视图并且是活动的一部分，请使用`Activity.findViewById(R.id...)`或`View.findViewById(R.id...)`。

# asp.net-mvc - 如何在 MVC Razor 视图中动态创建 ActionLink

> ID：11871110
> 
> 赞同：1
> 
> 时间：2012-08-08T18:46:18.967
> 
> 标签：asp.net-mvc, razor

我可以使用如下函数中的代码重定向用户：

```
 window.location.href = "@Url.Action("ShippingSummary", "Shipping", new { id = 2 })" 
```

我在变量中有 id，但我需要将它动态分配给 ActionLink。像这样的东西

```
var ID = 2;
window.location.href = "@Url.Action("ShippingSummary", "Shipping", new { id = ID })" 
```

我收到一个未定义 ID 的错误。我曾尝试先将操作链接创建为字符串，但这没有用。我怎样才能让它工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T18:53:04.640

在本例中，您正在混合使用 Javascript 和 C#。Javascript 会在浏览器中执行，而 C# 会在服务器上执行，所以不能这样混用。

相反，您应该这样做：

```
var ID = 2;
window.location.href = "@Url.Action("ShippingSummary", "Shipping")" + "?id=" + ID; 
```

在这种情况下，Razor 将发出 Controller Action 路由的第一部分，然后您可以将所需的查询字符串参数添加到路径中。

# java - 自纪元以来的Java时间

> ID：11871120
> 
> 赞同：15
> 
> 时间：2012-08-08T18:46:50.680
> 
> 标签：java, time, simpledateformat, epoch

在 Java 中，我怎样才能打印出以秒和纳秒为单位的纪元以来的时间，格式如下：

```
java.text.SimpleDateFormat("yyyy-MM-dd HH:mm:ss.SSS"); 
```

我的输入是：

```
long mnSeconds;
long mnNanoseconds; 
```

其中两者的总和是自 epoch 以来经过的时间`1970-01-01 00:00:00.0`。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-08-08T18:53:14.697

使用它并除以 1000

```
long epoch = System.currentTimeMillis();

System.out.println("Epoch : " + (epoch / 1000)); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-05-25T18:09:07.777

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-08-08T18:52:47.443

你可以这样做

```
public static String format(long mnSeconds, long mnNanoseconds) {
    SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss.");
    return sdf.format(new Date(mnSeconds*1000))
           + String.format("%09d", mnNanoseconds);
} 
```

例如

```
2012-08-08 19:52:21.123456789 
```

* * *

如果你真的不需要超过毫秒，你可以做

```
public static String format(long mnSeconds, long mnNanoseconds) {
    SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss.SSS");
    return sdf.format(new Date(mnSeconds*1000 + mnNanoseconds/1000000));
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-08T18:50:45.447

`java.util.Date`类有一个接受纪元毫秒的构造函数。

检查[java doc](http://docs.oracle.com/javase/6/docs/api/java/util/Date.html#Date%28long%29)并尝试使用它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-08T18:54:27.650

这在一定程度上取决于您的 mnSeconds 和 mnNanoseconds 的值，但是您需要使用像这样的格式化程序（具有毫秒精度）来创建一个 java.util.Date。如果 mnNanoseconds 是您的 mnSeconds 之上的纳秒数，我会假设它类似于

`Date d = new Date(mnSeconds*1000+mnNanosecods/1000000)`

然后在打印之前使用格式化程序对其进行格式化。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-08T18:52:24.983

您可以使用

```
new java.util.Date(mnSeconds); 
```

然后[SimpleDateFormat](http://docs.oracle.com/javase/1.4.2/docs/api/java/text/SimpleDateFormat.html)格式化您的输出。

Date 不支持纳秒。您必须手动添加纳秒或使用某些框架（有吗？）。

# sql - 如何过滤特定时间之前的结果

> ID：11871121
> 
> 赞同：1
> 
> 时间：2012-08-08T18:46:55.887
> 
> 标签：sql, sql-server, datetime, sql-server-2000

我有一个查询从昨天的日期获取结果。我想做的是更多地过滤结果，只返回早上 6:30 或早上 7:15 之后的任何结果。如果结果介于上午 6:30 和 7:15 之间，我不关心结果。

以下是我的查询：

```
SELECT Store_Id, DM_Corp_Received_Date
FROM   Register_Till_Count_Tb
WHERE  (Register_Transaction_Type = 'SOD') 
  AND  (Register_Till_Count_Datetime >= DATEADD(day, DATEDIFF(day, 0, GETDATE()) - 1, 0)) 
  AND  (Register_Till_Count_Datetime < DATEADD(day, DATEDIFF(day, 0, GETDATE()), 0)) 
```

这是输出：

```
Store_ID DM_Corp_Received_Date
1        8/7/2012 5:29 AM
2        8/7/2012 6:15 AM
3        8/7/2012 6:29 AN
4        8/7/2012 5:53 AM
5        8/7/2012 6:12 AM
6        8/7/2012 6:23 AM
7        8/7/2012 6:00 AM
8        8/7/2012 6:08 AM
9        8/7/2012 5:39 AM
10       8/7/2012 6:14 AM 
```

另一个棘手的部分是上面是在中央时间，我的时区是东部。所以我需要将其转换为东部然后过滤结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:51:12.270

尝试类似下面的代码。如果您按计划运行，您可能需要弄清楚如何将“现在”的正确值传递给查询。例如，周一运行是看周日，还是看周五？

```
declare
  @dtNow         datetime ,
  @dtToday       datetime ,
  @dtFrom        datetime ,
  @dtThru        datetime ,
  @dtExcludeFrom datetime ,
  @dtExcludeThru datetime

set @dtNow         = getdate()
set @dtToday       = convert(datetime,convert(varchar,@dtNow,112),112)
set @dtFrom        = dateadd(day,-1,@dtToday) -- start-of-day yesterday
set @dtThru        = dateadd(ms,-3,@dtToday)  -- end-of-day yesterday (e.g., 2012-06-17 23:59:59.997)
set @dtExcludeFrom = convert(datetime, convert(char(10),@dtFrom,120) + ' 06:30:00.000' , 120 )
set @dtExcludeThru = convert(datetime, convert(char(10),@dtFrom,120) + ' 07:15:00.000' , 120 )

SELECT Store_Id ,
       DM_Corp_Received_Date
FROM Register_Till_Count_Tb
WHERE Register_Transaction_Type    =  'SOD'
  AND Register_Till_Count_Datetime     between @dtFrom        and @dtThru
  AND Register_Till_Count_Datetime not between @dtExcludeFrom and @dtExcludeThru 
```

这是计算变量值的示例：

```
@dtNow         2012-08-08 15:12:46.790
@dtToday       2012-08-08 00:00:00.000
@dtFrom        2012-08-07 00:00:00.000
@dtThru        2012-08-07 23:59:59.997
@dtExcludeFrom 2012-08-07 06:30:00.000
@dtExcludeThru 2012-08-07 07:15:00.000 
```

对于`datetime`值，一天中的最后一个“滴答”可能是`23:59:59.996`在 SQL Server 2000 中。不过我不记得了（因为我不得不处理它已经太久了）。如果是，则需要更改`dateadd(ms,-3,...)`为`dateadd(ms,-4,...)`.

就时区而言，SQL Server 2000 对它们一无所知。对UTC也一无所知。日期时间值只是自 1900-01-01T00:00:00.000 纪元以来的天数和小数天数。

它是代表 UTC 还是本地时间完全取决于您的系统是如何设置的。如果日期/时间值来自用户或其他系统，则您依赖于数据源的含义。

就从东部标准时间 (EST) 到中部标准时间 (CST) 的转换而言，CST 比东部时间早一小时，因此只需减去一小时即可获得 EST：`dateadd(hour,-1,@my_datetime_value)`应该是这样。如果您必须处理夏令时（夏季）时间和标准时间之间的界限，它会变得 [much] 更复杂，因为您需要知道日期/时间值的源*轨迹*，并且很可能，无论是记录系统没有以任何方式标准化日期/时间值。

例如，在 2005 年之前，印第安纳州表面上位于中央时区。但是，时区的选择 - 中部 (UTC-6) 或东部 (UTC-7) - 以及是否遵守夏令时是逐县进行的。一些县喜欢复活节时间。虽然有些县观察夏令时，但大多数都没有。这有效地使这些县根据一年中的什么时间在中部时间和东部时间之间切换。

2006 年，印第安纳州通过了一项法律，并 [某种] 标准化了东部时区和夏令时的观察……除了印第安纳州 92 个县中有 18 个在中部时间（该州西北角有 7 个，因为他们在芝加哥附近，这是中央时间，在该州的西南角 11 点，只是因为他们几乎什么都没有，所以很讨厌）。然后在 2007 年 3 月 11 日，普拉斯基县从中央时间更改为复活节时间。不知道自他们之后印第安纳州做了什么。

有关处理此类问题的困难的更多信息，请参阅[Nachum Dershowitz](http://www.cs.tau.ac.il/~nachum/nachumd/Homepage.html)和[Edward M. Reingold](http://emr.cs.uiuc.edu/~reingold/)所著的 [优秀！] 书[*Calendrical Calculations*](http://www.cambridge.org/gb/knowledge/isbn/item1164334/?site_locale=en_GB)。这本书有自己的网站：

[http://www.cs.tau.ac.il/~nachum/calendar-book/index.shtml](http://www.cs.tau.ac.il/~nachum/calendar-book/index.shtml)

![历法计算封面](../Images/91a937b4dd53d476f729321c5ae01cd7.png)

如果我要解决这个问题，我会设计某种映射表或多个表，让我查找在给定日期/时间值和邮政编码或基本邮政编码等轨迹的情况下要进行的适当调整。美国邮政编码的前 3 位数字为您提供城市或地区的基本邮政编码。例如，西雅图的基本邮编是 98100。

在表格中查找要加载的数据，这些数据与时区随时间的使用情况有关，是否在该位置观察到夏令时，如果是，则每个位置的特定年份或年份范围的转换日期可能是什么成为一个挑战。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T19:26:16.460

您可以使用 BETWEEN 函数。例如

```
SELECT value
FROM table
WHERE date_col NOT BETWEEN '2012-08-08 06:30' AND '2012-08-08 07:15' 
```

要将时间转换为东部时间，您可以更改过滤器（增加一个小时），也可以使用

```
DATEADD(hh,-1,date_col) 
```

这基本上会从每个日期减去一个小时。显然，更改 1 个日期比更改表中的所有日期要快，因此仅更改过滤器日期会更有效。

如果您有更多问题，也许您可​​以发布更多信息。

# grails - Amazon Cloud Web Services 上的 Grails 应用程序会话数据错误

> ID：11871122
> 
> 赞同：1
> 
> 时间：2012-08-08T18:47:05.107
> 
> 标签：grails, amazon-ec2, amazon-web-services, grails-2.0

我有一个在 DEV 和 PROD 环境中运行的 Grails 2.0.0 Web 应用程序，没有任何问题。这两个环境都在运行 Tomcat 7 的 CentOS 6.0 服务器上。

由于客户的要求，我的任务是使用 Amazon 的 Web 服务将应用程序部署到云中。我已经能够做到这一点，但是我看到读取/写入会话数据的任何表单字段（即下拉框）的奇怪行为。例如，当我从下拉框中选择一个值时，应将所选值保存到会话中，并在 ajax 调用后调用以过滤相应的国家数据列表。如果我选择“百慕大”，下拉值实际上（错误地）从列表中更改为另一个国家（在 ajax 调用之后），我没有选择。

虽然我已经确认 session 变量包含错误的国家，但我也确认所有应用程序特定的代码都可以正常工作（因为它应该在 DEV 和 PROD 环境中正常工作）。我认为问题可能是由于环境配置不同造成的。我的 DEV/PROD 环境使用 CentOS 6.0，但我的 Amazon Cloud 环境使用 Red Hat Linux。由于 Amazon 不提供 CentOS 映像，因此 Red Hat 是我能找到的最接近的版本。

我想知道配置的差异是否会影响功能。或者，也许这是亚马逊特有的东西。例如，所有传入/传出流量都通过 Amazon 的内部威胁管理网关 (TMG)。也许这会影响会话数据？

有没有人有过类似的经历？或者谁能​​指出我正确的方向？这个问题已经影响了我好几个星期了......

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T11:30:54.120

RedHad、CentOS 和 Amazon Linux 具有大部分相同的软件包，除了一些可能不会干扰运行的附加软件包。

我认为亚马逊内部 TMG 也不是问题，因为它会阻止网络数据包，但不会更改数据包内容。

然后它只持续 tomcat、grails 和您的应用程序：

1.  您是否尝试将 grails 版本升级到 2.0.4 或 2.1.0？
2.  您是否在日志中确认您的 ajax 请求实际上正在处理中？
3.  你的 Xms、Xmx 和 PermGen tomcat 配置是什么？
4.  您的 EC2 虚拟机的大小是多少？如果是 m1.micro 你应该改为 m1.small 吗？

另外，我建议您尝试其他名为[Elastic Beanstalk](http://docs.amazonwebservices.com/gettingstarted/latest/awsgsg-freetier/deploy-sample-app.html)的 Amazon 产品，它使用 EC2、Auto Scaling Group、Elastic Load Balance 和 Cloud Watch，提供了一个非常简化和集成的控制台来管理您的环境，从而可以非常快速地测试不同的配置。

如果您今天安装了 MySQL，您可能希望将其替换为 MySQL RDS 实例，并将您的 EC2 实例仅用于 Web 应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T15:54:25.177

问题是 Microsoft TMG 被设置为执行缓存，这导致了问题。

# unit-testing - 使用 Scala 时在 IntelliJ 中无法识别 Mock

> ID：11871124
> 
> 赞同：0
> 
> 时间：2012-08-08T18:47:07.897
> 
> 标签：unit-testing, scala, mocking

```
@RunWith(classOf[MockitoJUnitRunner])
class ScalaTest {

  var x  = mock[java.util.Map]
  val y  = mock[ClassA]
  val z  = mock[ClassB]
} 
```

无论我在我的 pom 文件中设置什么依赖项，我都无法让 Mock 工作。编译器只是说无法解析符号`Mock`和`ClassOf`. 我在下面显示了我的依赖项：

```
<dependency>
  <groupId>org.scalamock</groupId>
  <artifactId>scalamock-scalatest-support_${scala.version}</artifactId>
  <version>2.4</version>
</dependency>
<dependency>
  <groupId>org.scalamock</groupId>
  <artifactId>scalamock-junit3-support_${scala.version}</artifactId>
  <version>2.4</version>
</dependency> 
```

并且测试依赖是：

```
<dependency>
  <groupId>org.scalatest</groupId>
  <artifactId>scalatest_${scala.version}</artifactId>
  <version>2.0.M3</version>
  <scope>test</scope>
</dependency>

<dependency>
  <groupId>org.mockito</groupId>
  <artifactId>mockito-core</artifactId>
  <version>1.9.0</version>
  <scope>test</scope>
</dependency> 
```

这些是我的进口：

```
import org.junit.{Test, Before}
import org.junit.runner.RunWith
import org.mockito.runners.MockitoJUnitRunner 
```

有什么建议么？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T12:41:12.777

我不知道 mockito 但根据

*   [如何在 Scala 中模拟带有函数参数的方法？](https://stackoverflow.com/questions/2152019/how-to-mock-a-method-with-functional-arguments-in-scala)
*   [具有特征的 Scala 和 Mockito](https://stackoverflow.com/questions/6243467/scala-and-mockito-with-traits)
*   [ClassCastException 在 Scala 中使用 ArgumentCapture 进行 Double](https://stackoverflow.com/questions/11544913/classcastexception-using-argumentcapture-for-double-in-scala)

你的类`ScalaTest`应该扩展一个单元套件并且应该混入 MockitoSugar （它提供了`mock`方法）。

如果`classOf`无法在您的注释声明中解决，您`RunWith`可能必须使用更新的 Scala 版本（2.8 或更高版本）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T13:49:28.493

您正在为 ScalaTest 和 JUnit 导入 ScalaMock 支持类，但您根本没有使用 ScalaTest（您正在使用带有自定义运行器的 JUnit，我不熟悉）并且似乎使用了错误的集合特征，根据 Stefan 对 yoru 问题的评论。

如果您想使用 ScalaTest 作为您的测试运行器，您应该将相关套件类之一与 MockitoSugar 混合使用（遵循[ScalaTest 文档](http://www.scalatest.org/user_guide/testing_with_mock_objects#mockito)）：

```
// First, create the mock object
val mockCollaborator = mock[Collaborator]

// Create the class under test and pass the mock to it
classUnderTest = new ClassUnderTest
classUnderTest.addListener(mock)

// Use the class under test
classUnderTest.addDocument("Document", new Array[Byte](0))
classUnderTest.addDocument("Document", new Array[Byte](0))
classUnderTest.addDocument("Document", new Array[Byte](0))
classUnderTest.addDocument("Document", new Array[Byte](0))

// Then verify the class under test used the mock object as expected
verify(mockCollaborator).documentAdded("Document")
verify(mockCollaborator, times(3)).documentChanged("Document") 
```

# git - 如何将以前被忽略且现在不会显示的文件重新添加到我的 git 存储库中？

> ID：11871125
> 
> 赞同：2
> 
> 时间：2012-08-08T18:47:12.760
> 
> 标签：git, .htaccess, git-tower

我最初在我的 Git 存储库的排除列表中有 .htaccess。我现在已将其从排除列表中删除（并仔细检查了它也已从忽略列表中删除）。

我在本地更改了文件，但 Tower（我的 git 客户端）没有将文件显示为已更改并准备好远程提交。

如何让 Tower 识别文件已更改并可提交？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T18:54:21.660

您需要使用 -f 标志添加文件：

```
 git add -f .htaccess 
```

# c - 预处理器初始化的结构

> ID：11871126
> 
> 赞同：0
> 
> 时间：2012-08-08T18:47:15.453
> 
> 标签：c, beagleboard, raspberry-pi

我有大量常量数据需要存储在头文件中。由于数据的性质（如何嵌套），我决定使用由预处理器初始化的结构。

我正在尝试像这样初始化这些结构：

```
typedef struct s_PWM {
  uint8_t muxmode;
  char *name;
  char *path;
} PWM;

typedef struct s_PIN {
  char *name;
  uint8_t gpio;
  char *mux;
  uint8_t eeprom;
  PWM *pwm;
} PIN; 
```

这将允许我做类似的事情

```
PIN p1 = P8_19; 
```

从某种意义上说，组装一个具有适当属性的结构。

基本上，您可以将引脚发送到函数中

```
pinMode(P8_19, OUTPUT) 
```

这是有问题的行

```
#define P8_19 ((PIN){"EHRPWM2A", 22, "gpmc_ad8", 14, (PWM*){4, "EHRPWM2A", "ehrpwm.2:0"}}) 
```

这是警告

```
src/gpio.c:50:2: warning: excess elements in scalar initializer
src/gpio.c:50:2: warning: (near initialization for '(anonymous)')
src/gpio.c:50:2: warning: excess elements in scalar initializer
src/gpio.c:50:2: warning: (near initialization for '(anonymous)') 
```

有谁知道为什么会这样？我是否错误地将 PWM* 结构嵌套到 PIN 结构中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T18:56:01.317

简短的回答：是的。

您应该直接使用该结构，而不是使用指针：

```
typedef struct s_PIN {
  char *name;
  uint8_t gpio;
  char *mux;
  uint8_t eeprom;
  PWM pwm;  /* Notice: not a pointer */
} PIN; 
```

此外，您不需要进行铸造：

```
#define P8_19 {"EHRPWM2A", 22, "gpmc_ad8", 14, {4, "EHRPWM2A", "ehrpwm.2:0"}} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T18:56:52.177

```
#define P8_19 ((PIN){"EHRPWM2A", 22, "gpmc_ad8", 14, (PWM*){4, "EHRPWM2A", "ehrpwm.2:0"}})
                                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ 
```

标记的部分不是指针。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T07:29:30.937

我会稍微不同地解决这个问题；我会在他们自己的模块中定义引脚名称，如下所示。

`gpio.h`：

```
typedef struct s_PWM {
  uint8_t muxmode;
  char *name;
  char *path;
} PWM;

typedef struct s_PIN {
  char *name;
  uint8_t gpio;
  char *mux;
  uint8_t eeprom;
  PWM *pwm;
} PIN;

...
extern PIN * P8_19; 
```

`gpio.c`：

```
PWM _P8_19_PWM = {4, "EHRPWM2A", "ehrpwm.2:0"};
PIN _P8_19     = {"EHRPWM2A", 22, "gpmc_ad8", 14, &_P8_19_PWM};
PIN *P8_19     = &_P8_19; 
```

`gpio.h`然后您可以通过正常包含和使用 P8_19在另一个文件中引用它。

# php - 如何在 Slim 框架上访问中间件中的请求对象

> ID：11871131
> 
> 赞同：1
> 
> 时间：2012-08-08T18:47:40.000
> 
> 标签：php, slim

我正在尝试在中间件中获取 Request 对象。我正在创建一个 ajaxOnly 中间件，并且需要检查 isXhr() 请求方法。我试图创建如下内容：

```
 $ajaxOnly = function($request, $response, $route) { // this is the line 3
             if (!$request->isXhr()) {
                Slim::redirect('/dashboard/');
             }
            }; 
```

并像这样使用：

```
$app->get('/posts/:start_date/:end_date', $ajaxOnly, function($start_date, $end_date) use($app) {
    echo 'ok';
}); 
```

但它给了我以下错误：

Slim 应用程序错误由于以下错误，应用程序无法运行：

*   代码：2 消息：
*   {closure}() 缺少参数 1
*   文件：/var/www/myapp/routes.php 行：3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-18T02:20:10.237

发生的情况是，slim 没有将任何参数传递给闭包，所以你得到了那个错误，试试这样的

```
$ajax = function(){
    $slim = Slim::getInstance();
    if (!$slim->request()->isXhr()) {
            $slim->redirect('/dashboard/');
    }
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-21T08:59:39.653

你可以做这样的事情。

```
$ajaxOnly = function($app) {
    if (!$app->request()->isXhr()) {
        $app->redirect('/dashboard');
    }
}; 
```

# c# - 处理图像时，值对于 Int32 来说太大或太小

> ID：11871134
> 
> 赞同：1
> 
> 时间：2012-08-08T18:47:56.630
> 
> 标签：c#, .net, image-processing

下面是我的代码的一部分，我正在尝试应用图像过滤器来清除图像

```
 //Convert the image to integer array
        uint[,] image = new uint[use.Width, use.Height];
        for (i = 0; i < use.Width; i++)
        {
            for (j = 0; j < use.Height; j++)
            {
                image[i, j] = Convert.ToUInt32(use.GetPixel(i, j).R);
            }
        }

        int Block = 5;
        int BlockSqr = 25;

        // Internal Block Processing
        for (i = Block; i < use.Width- Block; i = i + 1)
            for (j = Block; j < use.Height- Block; j = j + 1)
            {
                int lM, lVAR;

                // Calculating the Mean of the Block
                tmp = 0;
                for (int k = i - Block; k < i + Block; k = k + 1)
                {
                    for (int l = j - Block; l < j + Block; l = l + 1)
                    {
                        tmp = tmp + image[k, l];
                    }
                }
                lM = Convert.ToInt32(Math.Abs(tmp / BlockSqr));

                // Calculating the Variance of the Block
                tmp = 0;
                M1 = 0;
                for (int k = i - Block; k < Block + i; k = k + 1)
                {
                    for (int l = j - Block; l < Block + j; l = l + 1)
                    {
                        M1 = ((image[k, l] - Convert.ToUInt32(lM)) * (image[k, l] - Convert.ToUInt32(lM)));
                        tmp = tmp + M1;
                    }
                }
                lVAR = Convert.ToInt32(Math.Abs(tmp / BlockSqr));

                //Putting the filtered value

                float tm = (lVAR - mVAR);
                float tm1 = tm / lVAR;
                int mm = Convert.ToInt32(image[i, j] - lM);
                float tm2 = tm1 * (image[i, j] - lM);
                int A = lM + Convert.ToInt32(tm2);

                if (A < 255)
                    Wiener.SetPixel(i, j, Color.FromArgb(255, A, A, A));

            } 
```

问题是我在处理图像时收到以下错误

> 对于 Int32，值太大或太小。

上

> int A = lM + Convert.ToInt32(tm2);

知道问题是什么吗？

编辑：做了一些调试

lM 保持 0 和 lVAR 保持 0

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:00:01.817

tm2 很可能是一个大于最大 Int32 值或低于最小 Int32 值的值......我会添加一个检查，比如......

```
double AD = lM + Convert.ToInt32(tm2);
if((AD >= 0) && (AD < 255)) {
  int A = Convert.ToInt32(AD);
  Wiener.SetPixel(i, j, Color.FromArgb(255, A, A, A));
} 
```

或类似的东西...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T18:54:18.790

有符号整数只能存储介于 -2,147,483,648 和 2,147,483,647 之间的值

如果您不需要负值，则可以使用`unsigned`整数获得超过 40 亿的数字。

如果这还不够，您可以使用`long`可以存储更大数字的类型。

此外，`NaN`表示“不是数字”，您可能应该使用调试器查看该数字是如何计算的，确保您没有除以零或与其他 NAN 进行算术运算或做其他不做数学的事情感觉。

# jquery - 获取 Facebook 群组成员数量的 Ajax 调用在 IE 中不起作用

> ID：11871138
> 
> 赞同：0
> 
> 时间：2012-08-08T18:48:17.943
> 
> 标签：jquery, ajax, facebook-graph-api

获取 Facebook 群组成员数量的调用。

这适用于除 IE 之外的所有浏览器。知道为什么吗？

```
$(document).ready(function(){
            i=0;

            $.ajax({

                type: "POST",
                url: "https://graph.facebook.com/oauth/access_token?client_id=My_apps_id&client_secret=SHHHHSECRETDONTTELLANYBODY&grant_type=client_credentials",
                //data: msg,
                dataType: "html",

           success: function(msg) {
                    $.getJSON('https://graph.facebook.com/242578930612/members?' + msg, function(data) {
                      var items = [];

                      $.each(data["data"], function(key, val) {              
                        i++;

                      });
                      $("#numMembers").text(i + " members");
                      console.log("members: " + i);
                    });
                }

             });
        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T20:02:43.437

`XDomainRequest`与标准化组件相比，IE 的组件有一定的限制`XMLHttpRequest`——例如，协议必须在您所在的页面和您请求的资源之间匹配。

相反，使用`FB.api`正确处理此问题的跨浏览器。

也就是说 - 你在浏览器中执行令牌交换是不是很疯狂？我希望这适用于 Phonegap 应用程序或类似应用程序：D。

# javascript - 滑动切换后滚动顶部不起作用

> ID：11871151
> 
> 赞同：0
> 
> 时间：2012-08-08T18:49:05.063
> 
> 标签：javascript, jquery, html

我正在使用 jquerys slideToggle 方法，并希望添加一个回调函数，该函数还可以向下滚动页面，以便新扩展的文本即使出现在页面当前可见区域之外也是可见的。

我发现了几个类似/相同的问题，但我无法获得任何解决方案，我是 javascript 新手，所以我真的可以和某人一起[快速查看我的代码。](http://jsfiddle.net/DpXJh/)

**Javascript**：

```
$(document).ready(function() {

    //br is the most efficient way to get desired effect with inline h3's
   $("<br/>").insertBefore("h3");

   //collapse all expandable sections on page load
   $(".expansion_text").slideToggle("slow");
});

//Click for expansion
$(function(){
    $("h3").click( function(){
        $(this).siblings(".expansion_text").slideToggle( "slow", function(){
            if ( $(this).is(":visible") ){
                $("html, body").animate({
                scrollTop: $(this).offset().top
                }, "slow");
            }
        });

    });
});​ 
```

**HTML**：

```
<div class="expandable">
<h3>The Prisoner of Benda</h3>
<div class="expansion_text">
<p>Bender, I didn't know you liked cooking. That's so cute. The key to victory is discipline, and that means a well made bed. You will practice until you can make your bed in your sleep. This is the worst part. The calm before the battle. Bender! Ship! Stop bickering or I'm going to come back there and change your opinions manually!</p>  
</div></div>
<div class="expandable">
<h3>Where the Buggalo Roam</h3>
<div class="expansion_text">
<p>Are you crazy? I can't swallow that. Bender, quit destroying the universe! Belligerent and numerous. Can I use the gun?</p>
<ol>
<li>Can we have Bender Burgers again?</li>
<li>I was all of history's great robot actors - Acting Unit 0.8; Thespomat; David Duchovny!</li>
<li>I videotape every customer that comes in here, so that I may blackmail them later.</li>
</ol>
</div></div> 
```

**编辑：解决方案，**在接受的答案的帮助下达成，但我认为不同之处足以在此处发布以供将来参考：

```
//Click for expansion
$(function(){
    $("h3").click( function(){
        toggleExpansion($(this).siblings(".expansion_text"));
    });
});

function toggleExpansion(expandableText){
    expandableText.slideToggle( "slow", function(){
            if ( $(this).is(":visible") ){

                var page = $("#page");

                page.animate({scrollTop: page.scrollTop() +
                    $(this).siblings("h3").position().top},1000);

            }

        });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T21:30:42.033

Afaik 这不是那么微不足道。最近我遇到了类似的问题，在[这里找到了很好的解决方案](https://stackoverflow.com/questions/172821/detecting-when-a-divs-height-changes-using-jquery)。它使用了一个额外但非常小的[jQuery 调整大小插件](http://benalman.com/projects/jquery-resize-plugin/)(1KB)。以下是您的代码的可能修改：

HTML：

```
<script type="text/javascript" src="http://github.com/cowboy/jquery-resize/raw/v1.1/jquery.ba-resize.min.js"></script> 
```

Javascript：

```
$(".expansion_text").css('display','none'); //instead of .slideToggle("slow");

$.resize.delay = 10;
$('.expandable').resize(function(){
    var page = $('#page');
    page.scrollTop(page.scrollTop() + $(this).children('h3:first').position().top);
}); 
```

[小提琴在这里。](http://jsfiddle.net/Lmp8q/)

# python - 在 python pandas 中处理欧洲日期格式

> ID：11871152
> 
> 赞同：0
> 
> 时间：2012-08-08T18:49:06.247
> 
> 标签：python, numpy, pandas

[这个问题在某种程度上是这个](https://stackoverflow.com/questions/10484106/pandas-reading-csv-orientation)问题的延续。我已经能够正确获取我对可下载 csv 文件感兴趣的内容，如下所示

```
import time
import urllib2
import csv
import sys
import pandas
response=urllib2.urlopen('http://www.euribor-ebf.eu/assets/modules/rateisblue/processed_files/hist_EURIBOR_2012.csv')
localFile = open('file.csv', 'w')
localFile.write(response.read())
localFile.close()
df2=pandas.io.parsers.read_csv('file.csv',index_col = 0, parse_dates = True, dayfirst = True)[:15].transpose()[:200] ## transpose in order to be compatible with pandas dataframe
df2 = df2.dropna() ## drop the values which are not-a-number
eur3m = df2['3m'] 
```

现在 eur3m 是`Series`Pandas 中的一个，我想了解给定时间段的信息。我知道我可以使用 DateRange 生成日期范围。我基本上想做的是在 1 个月的时间段内拥有例如静态数据（假设从 2012 年 7 月 1 日到 2012 年 7 月 31 日期间的平均值和标准差）。由于某些原因，尽管考虑到这些日期是欧洲格式（DD/MM/YYYY），我阅读了试图解析日期的 csv 文件，但我无法遵循[这个示例](https://stackoverflow.com/questions/10565282/pandas-python-how-to-select-specific-times-in-timeseries)。假设尝试类似

```
day=eur3m.index
i = ((day >= '01/07/2012') & (day <= '31/07/2012')) 
```

但它不起作用。实际上 day 是一个字符串数组。我不明白这是否正确。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T03:34:22.377

日期最初是作为列名读入的，pandas 目前不将列名解析为日期。对于功能请求，请在 github 上创建一个新问题：[https ://github.com/pydata/pandas/issues](https://github.com/pydata/pandas/issues)

现在你可以做一些后期处理：

```
eur3m.index = [datetime.datetime.strptime(x, '%d/%m/%Y') for x in eur3m.index] 
```

# c# - unity选择带参数的构造函数

> ID：11871157
> 
> 赞同：3
> 
> 时间：2012-08-08T18:49:13.207
> 
> 标签：c#, dependency-injection, unity-container

我正在注册这样的类型：

```
IUnityContainer container = new UnityContainer()
                .RegisterType<IActiveDirectoryUser, ADUser>(); 
```

ADUser 类包含 2 个构造函数，一个是无参数的，一个是单参数的。当解析器去解析它时，它会选择带有参数的那个。我如何告诉它使用无参数委托人？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-08T19:01:01.960

注册类型时，用于`InjectionConstructor`指示 Unity 应使用无参数构造函数：

```
IUnityContainer container = new UnityContainer();
container.RegisterType<IActiveDirectoryUser, ADUser>(new InjectionConstructor()); 
```

由于您没有向`InjectionConstructor`构造函数传递任何类型，Unity 将知道在实例化`ADUser`类时使用无参数构造函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T18:52:02.050

用 注释需要的构造函数`[InjectionConstructor]`。

# java - 读取注册表比较值到 if 语句

> ID：11871160
> 
> 赞同：-1
> 
> 时间：2012-08-08T18:49:24.673
> 
> 标签：java, registry

我有一个用于读取注册表的工作代码。我的问题是我读取注册表的部分，我想比较一些 if 语句以最终根据答案做一些事情。我检查了值，它输出 Windows 7 Professional 作为值，我的 if 语句不同意。

我的注册表代码来自[这里](https://stackoverflow.com/questions/62289/read-write-to-windows-registry-using-java)

```
public class Regtest {

    public static void main(String[] args) { 
    String value = null;
    String os7 = "Windows 7 Professional";
    try {
        value = Registry.readString ( 
                Registry.HKEY_LOCAL_MACHINE,                             //HKEY 
               "SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion",           //Key 
               "ProductName");

        if(value == os7 ){
            System.out.println("Windows Distribution = " + value);
        }else{
            if(value != os7 ){
                System.out.println("Windows Distribution = Wrong OS");  
            }
        }
    } catch (IllegalArgumentException e) {
                e.printStackTrace();
    } catch (IllegalAccessException e) {
                e.printStackTrace();
    } catch (InvocationTargetException e) {
                e.printStackTrace();
            }                                              
        }  
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T18:58:24.470

You need to use value.equals(os7). Java does not support == for Strings. It only checks for object identity which is not a given.

# asp.net - asp.net ReportViewer - 使用 SizeToReportContent=true 强制垂直滚动条

> ID：11871163
> 
> 赞同：0
> 
> 时间：2012-08-08T18:49:33.883
> 
> 标签：asp.net, visual-studio-2010, report-viewer2010

在 VS10 中有没有办法保持 SizeToReportContent=true 并强制垂直滚动条？我有一个允许用户选择报告的 DDL，它为 ReportViewer 设置数据源。SizeToReportContent 似乎是动态控制报表宽度以与 ReportViewer 的宽度对齐的唯一方法。该页面包含一个高度小于报表的显示区域。如果 ReportViewer 有一个垂直滚动条，那么报表将满足显示区域约束。

我已经尝试了对.rdlc 的样式格式和大小更改的各种组合，但在 SizeToReportContent=true 时没有强制滚动条。

ReportViewer 的 width 和 height 属性都被覆盖，但是 .rdlc 的哪个属性？

该报告正在本地处理，但我认为这没有什么不同。

蒂亚！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T15:52:47.537

我希望这可以帮助别人...

强制 ReportViewer 生成所需的页面尺寸。

设置 SizeToReport=false。将每个报告的所需宽度附加到由“|”分隔的 .rdlc 值的名称中。在运行报告方法中拆分所选值以获取 .rdlc 名称及其宽度。这意味着物理上确定要使用报告名称硬编码的每个报告的宽度 - [弱！]。

代码：

**报告中的 ddl .ascx** [实际上是从数据库中填充的，但我想显示数据]

```
<asp:DropDownList ID="reportDropDownList" runat="server" AutoPostBack="True" OnSelectedIndexChanged="RunReport">
    <asp:ListItem Selected="True" Value="0">-- Select Report --</asp:ListItem>
    <asp:ListItem Value="RVSum.rdlc|504" >RV Purchased Sum</asp:ListItem>
    <asp:ListItem Value="ZeroPricePurchasesView.rdlc|550">Zero Price Purchases</asp:ListItem>
    ...
</asp:DropDownList> 
```

**运行报告方法：**

```
protected void RunReport(object sender, EventArgs e)
{
    ObjectDataSource source = new ObjectDataSource("WC.DataAccess.DAO.ReportsDAO", "GetAllReports");
    string path = "RDLC" + "\\";
    string ddlValue = "";

    if (reportDropDownList.SelectedIndex != 0)
    {
        ddlValue = reportDropDownList.SelectedValue.ToString();
        string[] ddlSplit = ddlValue.Split('|');  //split ddl selected value
        path = path + ddlSplit[0];  //.rdlc name
        reportViewer.LocalReport.DataSources.Clear();
        reportViewer.LocalReport.ReportPath = path;
        reportViewer.LocalReport.DataSources.Add(new ReportDataSource("DataSet1", source));

        reportViewer.AsyncRendering = false;
        reportViewer.SizeToReportContent = false;
        reportViewer.ShowZoomControl = false;
        reportViewer.Height = 400;  // default value but exactly what is needed

        reportViewer.Width = Convert.ToInt32(ddlSplit[1]);  // desired report width
        reportViewer.DataBind();

    }
    else  /* default clear viewer */
    {
        reportDropDownList.SelectedIndex = 0;
        reportViewer.LocalReport.DataSources.Clear();
        reportViewer.Reset();
    }
} 
```

我不喜欢这种类型的编程，但在 MS 提供更好的报告查看器之前，我会这样做。

我仍然对一些建议感兴趣 - 现在继续......

# php - 错误的文件名，但它是正确的

> ID：11871167
> 
> 赞同：1
> 
> 时间：2012-08-08T18:49:45.017
> 
> 标签：php, pdf, download, file-exists

我正在尝试创建下载按钮，以便用户可以通过单击按钮下载 pdf 文件。我有这个：

```
<?php

session_start(); // Alltid överst på sidan

if(!isset($_SESSION['sess_id']) OR $_SESSION['sess_id'] < 1){
   die("Skapa ett konto som investerare för att enkelt få tillgång till affärsplaner!");
}else if(is_numeric($_SESSION['sess_id'])) {

    /* kolla om användaren försöker ange filer i en annan mapp */
    if(substr_count($_GET['file'], "/") > 0){
        die("Invalid path"); }

/* skapa fullständig sökväg till filen */
$file = '/server/php/files/' . $_GET['file'];

/* kolla om filen finns */
if(!file_exists($file))
{
   die("Invalid filename");
} 
```

它给了我一个“无效的文件名”消息..

但是，当我`echo $file;`将路径复制到我的浏览器（前面的+localhost）时，它会为我提供我正在寻找的下载对话框。关于我做错了什么的任何想法？

的输出`echo $file`

```
/server/php/files/roibay-business-plan.pdf 
```

“ `server`”是我根文件夹中的一个文件夹。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T18:53:22.560

> 当我回显 $file; 并将路径复制到我的浏览器，它为我提供了我正在寻找的下载对话框。

那是因为`file_exists`需要一个相对于服务器的路径名；不是 URI。

*   [文件已存在](http://php.net/manual/en/function.file-exists.php)

例子：

```
file_exists('/var/www/site.com/index.htm'); // this would work.
file_exists('www.site.com/index.htm'); // this would not 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T19:02:16.960

> 我已经用 mamp 设置了 localhost 并且我创建了一个别名 lab.local ，所以我正在谈论的文件路径是：lab.local/server/php/files/somefile.pdf 当我输入它时网络浏览器弹出对话框，但 file_exists 不验证该路径

这意味着该`server`目录不是您的根目录。尝试这个：

`file_exists($_SERVER{'DOCUMENT_ROOT'} . "/server/php/files/roibay-business-plan.pdf"))`

# php - 用 PHP 重命名图像文件

> ID：11871169
> 
> 赞同：0
> 
> 时间：2012-08-08T18:49:59.117
> 
> 标签：php, joomla

我只是想确保我做对了。这是一个简单的上传类。我需要更改下面的代码以使用变量名称（Joomla 用户 ID 并保留扩展名）重命名实际的图像文件。很容易获取登录的用户 ID。所以我在上传之前的图像文件名将是用户拥有 (usersimagename.jpg) 并将其更改为由 joomla 的用户变量填充的数字 userid.ext，例如 (62.png)。

```
<?php

$uploaddir = $_REQUEST['path'];
$uploadfile = $uploaddir . basename($_FILES['userfile']['name']);

if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploadfile)) {
echo "success";
} else {
// WARNING! DO NOT USE "FALSE" STRING AS A RESPONSE!
// Otherwise onSubmit event will not be fired
echo "error";
 }

 ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T18:56:07.197

如果我正确理解您的问题，您希望在更改存储的实际名称时保留文件扩展名。我不知道 Joomla 变量，但这样的东西应该可以工作

```
<?php
    $ext = strrchr($_FILES['userfile']['name'],".");

    $uploadfile = $uploaddir . $JOOMLAID . $ext;
?> 
```

然后使用其余代码跟进此操作。

您也可以用您能想到的任何生成名称替换 $JOOMLAID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T19:05:11.120

代码本身在操作上很好，但在逻辑上是一场噩梦。您允许用户为最终存储位置指定路径和文件名。考虑如果恶意用户进入您的网站会发生什么。他们可以轻松地替换您的服务器上您的网络服务器的用户 ID 有权访问的**任何文件。**

例如

```
$_REQUEST['path'] = '/etc/';
$_FILES['userfile']['name'] = 'passwd'; 
```

或者

```
$_REQUEST['path'] = 'c:\windows\system32\';
$_FILES['userfile']['name'] = 'ntoskrnl.exe'; 
```

虽然这些只是令人震惊的价值示例，并且不太可能被您的网络服务器修改，但这是一个示例，说明您的代码将多么容易让某人完全 pwn 您的服务器。

# scheduling - 在 SJF 算法中计算平均等待时间

> ID：11871172
> 
> 赞同：0
> 
> 时间：2012-08-08T18:50:14.143
> 
> 标签：scheduling, preemptive

![SJF 表及其甘特图](../Images/7d64294fada41cd5d4aafdedcd784339.png)

我了解抢占式 SJF 调度的工作原理，但我不知道如何计算平均等待时间。
这个示例取自 Galvin、Gagne 和 Silberschatz 的“OS 原则”。
他们将平均等待时间计算为：
`((10-1)+(1-1)+(17-2)+(5-3)) / 4 = 6.5ms`
这是如何计算的？请简化。
此外，如果您可以使用 RR 算法解决同样的问题，时间量为... 5ms（用于简单计算）并解释如何计算平均等待时间，那就太好了

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T19:02:20.233

看看图，计算一下每个进程，他等了多少时间：

P1在开始时运行1次（他是唯一的）因此他在这里等待0。然后，他从时间 1 等待到时间 10 -> 总等待时间 = (10-1)。

P2在时间1到达，并立即开始运行。所以他根本没有等待->（1-1）。

P3 在时间 2 到达，并在时间 17 -> (17-2) 开始运行。

P4 在时间 3 到达，并在时间 5 开始运行 -> 总等待时间 = (5-3)。

因此，平均等待时间 = ((10-1)+(1-1)+(17-2)+(5-3))/4 = 6.5ms。

**编辑：** 对于具有 5 个量子的 RR，这就是将要发生的事情：

P1 到达，并获得 5ms 的 quanta -> 在时间 5 中，他以剩余的突发 3 停止。接下来，P2 将从时间 5 开始运行到时间 9。（他的突发只有 4）。所以你让P2等待（5-1）。

P3 将从时间 9 到时间 14 开始运行，剩余脉冲数为 4。接下来，P4 将从时间 14 到时间 19 开始运行并结束。P4 的总等待时间为 (14-3)。

比 P1 将继续从时间 19 运行到时间 22 并将结束。P1 的总等待时间为 (19-5)。然后，P3 从时间 22 继续运行到时间 26。P3 的总等待时间为 (9-2) + (22-14)。

所以你得到平均运行时间 = ((5-1)+(14-3)+(19-5)+(9-2)+(22-14))/4 = 10.5ms

# mongodb - 删除“scanAndOrder”：在我的 MongoDB 查询结果中为 true

> ID：11871187
> 
> 赞同：5
> 
> 时间：2012-08-08T18:51:18.223
> 
> 标签：mongodb, sorting, indexing, sharding

所以我在我的数据库中有一个带有以下 shardkey 的集合： {cl:"yyyy-mm", user_id:N}

当我执行以下查询时

```
db.collection.find({ cl:"2012-03", user_id:{$in:users}, _id:{"$lt":new ObjectId('4f788b54204cfa4946000044')} }).sort({_id:-1}).limit(5).explain(true) 
```

它给了我这个结果：

```
"clusteredType" : "ParallelSort",
"shards" : {
    "set1/hostname.com:27018" : [
        {
            "cursor" : "BtreeCursor cl_1_user_id_1 multi",
            "nscanned" : 21294,
            "nscannedObjects" : 21288,
            "n" : 5,
            "scanAndOrder" : true,
            "millis" : 1258,
            "nYields" : 69,
            "nChunkSkips" : 0,
            "isMultiKey" : false,
            "indexOnly" : false,
            "indexBounds" : { ... 
```

那么如何进行排序以使用索引，然后我不需要扫描所有 21288 个文档，只需返回最后 5 个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-07T21:15:30.530

感谢您对 Dex 的关注！

如果在 2013 年还不算太晚，我建议在这里避免 scanAndOrder 的索引是 { _id: -1, cl: 1, user_id: 1 }。

原因是因为 _id 上的 $lt 和 user_id 上的 $in 构成了跨多个索引“桶”的范围。除上述顺序之外的任何其他顺序的索引意味着这些存储桶仍必须一起排序以满足对 _id 的排序。通过将 _id 放在首位，索引中访问的所有文档将提前正确排序。

请注意，这比 Andre 的建议（{ _id: -1, user_id: 1, cl: 1 }，这也应该避免 scanAndOrder）略有改进，因为它允许对 cl 进行直接等效检查以修剪结果。

查看[http://blog.mongolab.com/2012/06/cardinal-ins/](http://blog.mongolab.com/2012/06/cardinal-ins/)了解更多详情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-10T07:12:59.323

因为您使用的是`$lt`我不知道您是否能够`scanAndOrder`从查询中删除操作。常规公理是您将排序字段作为索引的最后一个成员，但这会在进行范围查询的地方分解。您通常可以通过反转索引的顺序，将排序字段作为第一个成员插入来解决此问题。在您的情况下还有一个问题，因为集合是分片的，因此您可能总是至少选择分片键索引而不是“倒序索引”。

在不了解数据分布的情况下，很难推荐具体的行动方案。从我所做的简短测试中，添加一个索引以将and`{cl:1,user_id:1,_id:-1}`大致减半。这将使用排序字段作为索引的最后一个成员，但存在如上所述的缺陷。您也可以尝试与此相反，但您可能会发现分片键将在该索引上被选中。您可以进一步尝试通过提示强制反向索引，但这并没有在我的测试中带来任何性能提升。`nscanned``nscannedobjects``{_id:1,user_id:1,cl:-1}`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-08T19:36:35.697

尝试 Dex 以确保索引按照您认为的方式工作：[https ://github.com/mongolab/dex](https://github.com/mongolab/dex)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-23T16:13:26.133

AFAIK、条件运算符 $gt、$lt 等（mongo 查询中的比较函数）使 mongo**根本不使用索引**（对于查询的那一部分）。Mongo 必须**扫描**集合中的所有文档才能执行此类查询。

所以，这部分：

> find({ cl:"2012-03", user_id:{$in:users}, _id:{"$lt":new ObjectId('4f788b54204cfa4946000044')} })

不会使用索引，即使它存在。这让它变慢了。

**UPDATE** 查询中的条件运算符 $gt、$lt 等允许使用索引，但没有它们时效率不高。仍然 mongodb 必须扫描更多返回结果的文档。

# profiling - 使用分析信息编译的 OCaml 二进制文件

> ID：11871195
> 
> 赞同：4
> 
> 时间：2012-08-08T18:51:40.973
> 
> 标签：profiling, ocaml

给定一个使用 OCaml 编译的二进制文件，有没有办法找出它是否已使用分析信息（使用`ocamlcp`/`ocamloptp`或使用`gprof`特定数据 via `ocamlopt -p`）进行编译？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:10:34.440

如果您`ocamlobjinfo`在已分析的字节码文件上运行，它会将 Profiling 显示为导入的接口之一：

```
$ ocamlcp -c my.ml
$ ocamlobjinfo my.cmo
File my.cmo
Unit name: My
Interfaces imported:
        720848e0b508273805ef38d884a57618    Array
        d7e1aaf95ba3578d33efe347aefa6c49    My
        db723a1798b122e08919a2bfed062514    Pervasives
        6a6248bae49664a0bb530dd3f0c15b79    Profiling
Uses unsafe features: no
$ 
```

**更新**

在我的系统（OS X）上，一个分析的本机可执行文件包含一个定义`camlProfiling`和相关符号：

```
$ ocamlopt -o my my.ml
$ nm my | grep camlProfiling
$ ocamloptp -o my my.ml
$ nm my | grep camlProfiling
000000010003e240 D _camlProfiling
000000010003e2e0 d _camlProfiling__1
000000010003e300 d _camlProfiling__2
000000010003e318 d _camlProfiling__3
000000010003e268 d _camlProfiling__4
000000010003e280 d _camlProfiling__5
000000010003e2a0 d _camlProfiling__6
000000010003e2c0 d _camlProfiling__7
0000000100003760 T _camlProfiling__code_begin
0000000100003ac7 T _camlProfiling__code_end
000000010003e238 D _camlProfiling__data_begin
000000010003e328 D _camlProfiling__data_end
00000001000038d0 T _camlProfiling__dump_counters_1014
0000000100003a40 T _camlProfiling__entry
000000010003e32c D _camlProfiling__frametable
0000000100003770 T _camlProfiling__fun_1046
0000000100003800 T _camlProfiling__fun_1048
0000000100003890 T _camlProfiling__incr_1010 
```

这似乎很可能适用于每个支持`nm`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-03T16:29:46.657

**注意**：旧的分析标志 ( `ocamlopt -p`) 会产生`gprof`- 特定信息，并且不会`camlProfiling`像 Jeffrey 的回答那样产生符号。但是使用`ocamloptp`，他的解决方案有效。

如果您需要“旧”方法，如[本网站](http://avd.reduct.ru/linux/profiling-gprof-gcov.html)所示，确定二进制文件是否已在`gprof`支持下编译的一种比较可靠的方法是检查符号的存在`mcount`：

```
nm <native binary> | grep mcount 
```

只有编译的程序`-p`应该包含`mcount`符号：

```
U mcount@@GLIBC_2.2.5 
```

否则，程序尚未使用该`-p`标志编译。

# javascript - JSONP请求响应中无限循环的目的是什么？

> ID：11871198
> 
> 赞同：1
> 
> 时间：2012-08-08T18:51:45.433
> 
> 标签：javascript, json, jsonp

添加“for (;;);”的目的是什么 对 JSONP 请求的响应？例如这样的回应：

for (;;);{a:...} （其中 {a:...} - JSON 字符串）

只传递 {a:...} （如果有的话）有什么区别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T21:52:05.443

[您可以在 SO 上](https://stackoverflow.com/a/856084/1350193)找到答案。

我会总结一下：无限循环将对 JSON 数据的访问限制在您自己的域中。您可以通过在您自己的站点上加载脚本`XMLHttpRequest`并在使用/执行数据/脚本之前删除循环。该循环阻止了跨域请求，因为这些请求必须使用`<script>`节点，因此将执行循环。

请注意，如果有人在服务器上加载 JSON 数据/脚本，该服务器可以删除循环然后将数据发送到客户端，这将不起作用。

# export-to-excel - Access 2010 使用 VBA 将查询导出到特定的 Excel 范围

> ID：11871201
> 
> 赞同：0
> 
> 时间：2012-08-08T18:51:49.400
> 
> 标签：export-to-excel, ms-access-2010

标题几乎说明了一切，我正在寻找一种方法将此查询导出到 excel 中的特定列，这样我就不必创建一堆单独的 excel 文件。

查询本身使用日期进行计算，我想在一年中的每个月运行它。所以在伪代码中是这样的：

```
For i = 1 to 13  
  Export Query with to cell i with parameters 
    StartDate = DateSerial(Me.txtYear, i, 1), 
    EndDate = DateSerial(Me.txtYear, i+1, 1)
  i++
Next 
```

同样，现在计算被称为月份，但如果我能知道如何让它动态变化并将实际月份作为字段标题，我会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T20:38:42.360

如果您可以创建创建数据的查询，那么类似的东西应该会[有所](http://msdn.microsoft.com/en-us/library/office/aa165427%28v=office.10%29.aspx)帮助。

在我用来将数据拖放到 excel 的代码中，我用它来编写标题：

```
fldCount = rs.Fields.Count
For iCol = 1 To fldCount
    xlWs.Cells(1, iCol).value = rs.Fields(iCol - 1).Name
Next 
```

然后将数据写入A2中的工作表

```
xlWs.Cells(2, 1).CopyFromRecordset rs 
```

# java - Spring的请求映射问题

> ID：11871202
> 
> 赞同：1
> 
> 时间：2012-08-08T18:51:53.873
> 
> 标签：java, spring, spring-mvc, request-mapping

所以我正在按照我发现的 Spring Beans 范围指南：[http ://richardchesterwood.blogspot.com/2011/03/using-sessions-in-spring-mvc-included.html](http://richardchesterwood.blogspot.com/2011/03/using-sessions-in-spring-mvc-including.html)

我正在使用第 3 个选项，这意味着我的组件在会话范围内，我的控制器在请求范围内，并且组件自动连接到控制器中（因此每个会话只有一个实例）。

但是当我这样做时，我得到了 eclipse 错误：

> 无法将处理程序“somethingsController”映射到 URL 路径 [/SomethingsPage]：已经映射了处理程序“scopedTarget.somethingsController”。

在我的控制器中，我有一个这样的方法：

```
@RequestMapping(value = "SomethingsPage")
    public ModelAndView changeTheSomething(HttpServletRequest request) {
        [...]
    } 
```

如果我注释掉这种方法，一切都会很好。（除了那个方法。）因此，出于某种原因，在该控制器内部使用请求映射会导致某些东西中断。有什么方法可以更改我的请求映射以使其全部正常工作吗？

所以我认为这个问题与我的 spring xml 扫描两次控制器有关，并且导致 @Requestmapping 第二次被映射，这会引发错误。考虑到我在范围界定和自动装配方面如何使用类的注释，我的 xml 文件的设置方式是否有问题？

```
<?xml version="1.0" encoding="windows-1252"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:mvc="http://www.springframework.org/schema/mvc" xmlns:aop="http://www.springframework.org/schema/aop"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xsi:schemaLocation="
       http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context-3.0.xsd
       http://www.springframework.org/schema/mvc
       http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
       http://www.springframework.org/schema/aop
       http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
       http://www.springframework.org/schema/tx
       http://www.springframework.org/schema/tx/spring-tx-3.0.xsd">

    <!-- Use @Component annotations for bean definitions -->
    <context:component-scan base-package="controllers, daos, map, models, session, testControllers"  scoped-proxy="targetClass" />
    <!-- added this because I think it makes annotations work? -->
    <context:annotation-config />

    <!-- Use @Controller annotations for MVC controller definitions -->
    <mvc:annotation-driven />

    [... bunch of other stuff that shouldn't be relevant] 
```

# regex - 正则表达式中星号的行为

> ID：11871205
> 
> 赞同：0
> 
> 时间：2012-08-08T18:52:03.017
> 
> 标签：regex

我正在实现一个简单的正则表达式，但我无法确定 star 的行为。

假设 a*b 是我的搜索表达式。当它应用于目标文本 aaaaaabbc 和 1345536 时会发生什么？

因为 star 需要零个或多个前面的字符，所以两者都必须通过。这不正确吗？这里的[http://www.zytrax.com/tech/web/regex.htm](http://www.zytrax.com/tech/web/regex.htm)说不是。

如果确实不是，那么如何使迭代停止？我觉得让它停止违反了既定规则。

- - - - 编辑

我说它必须适用于第二个的原因是这个。应该有零个或多个a，并且有零个a。随着它的继续，它的字母用完了， b 将没有机会与之进行比较。所以这不是比赛吗？

那是我无法得到的，b 如何以及何时获得机会？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T21:02:15.363

> 假设 a*b 是我的搜索表达式。当它应用于目标文本 aaaaaabbc 和 1345536 时会发生什么？

使用`aaaaaabbc`，它开始尝试匹配第一个字符 (an `a`)，发现可以匹配，然后继续运行，直到到达第一个`b`。在这一点上它停止，宣布成功。（某些语言默认为正则表达式添加隐式的全字符串锚定，但通常可以匹配任何地方。）

使用`1345536`，它尝试匹配第一个字符，发现它不能（它既不是`a`也不是`b`），因此继续尝试从第二个字符开始。由于它永远找不到可以开始匹配的点，因此整个字符串不匹配。

让我们也考虑一下`aaac`（一个您没有使用过但仍然提供信息的案例）；尽管状态机找到了`a`并开始*尝试*匹配，但由于它从未找到*强制* `b`的，它实际上从未完成匹配并且字符串不匹配。

> 我说它必须适用于第二个的原因是这个。应该有零个或多个a，并且有零个a。随着它的继续，它的字母用完了， b 将没有机会与之进行比较。所以这不是比赛吗？
> 
> 那是我无法得到的，b 如何以及何时获得机会？

为了`a*b`匹配任何东西，它必须有一个零个或多个`a`s 的运行，然后是一个强制的`b`。是的，`a`s 是可选的，但`b`不是；它*必须*存在才能找到匹配项。里面没有`b`；`1345536`它永远不会匹配。RE 引擎将寻找 a`a`或 a`b`开始；两者都可以。如果找到 a `a`，它将开始尝试在`a`s 上进行匹配扫描，直到`b`达到 a（匹配）或达到非`b`（和非`a`）（非匹配）。如果找到的第一个字符是`b`; 立即找到匹配项。

简而言之，你有点误解了什么`a*b`意思。的可选性`a`与`b`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T19:01:39.470

在您给出的示例中，“1345536”字符串不会被“a*b”匹配，因为它需要一个“b”。这些将匹配：

```
aaaaaaaaab
aaaaaabc
121435b 
```

* 符号表示它前面的 0 个或多个字符，因此，如果你在它的任何地方放一个 'b'，将被匹配，'a' 仅用于获取匹配组：

```
test  | Group
1aab => aab
ab   => ab
bab  => b, ab 
```

* * *

编辑：

[根据regular-expressions.info](http://www.regular-expressions.info/engine.html)，您思考的方式不是正则表达式的工作方式，它们需要测试到底：“只有在尝试了所有可能性并发现失败时，引擎才会继续执行第二个特点。”。

当您在 1345536 上测试 a*b 时，会发生这种情况（实际上并非如此，但您明白了）：

*   检查第一个字符
*   是一个'a'吗？
*   没有
*   是'b'吗？
*   没有
*   然后转到下一个字符

'b'在测试字符串中的**每个字符上都有机会。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T18:56:28.040

您没有说是哪种语言，但在大多数正则表达式实现中，星号表示“零个或多个前面的字符”，因此`a*b`表示“零个或多个 'a' 后跟一个 'b'”。

因此，`a*b`应该匹配第一个目标中的子字符串`aaaaaab`，但在第二个目标中根本不匹配。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T19:40:44.933

正则表达式与状态机同构。一旦你有了基本的想法，代码应该是显而易见的。计算理论的任何基础课程都涵盖了这一点；或阅读[Ken Thompson 的原始论文](http://dl.acm.org/citation.cfm?id=363387)。

# mysql - MySQL查询优化三重连接与嵌套选择

> ID：11871206
> 
> 赞同：2
> 
> 时间：2012-08-08T18:52:03.437
> 
> 标签：mysql, sql, optimization, select, join

我如何优化这样的三重连接查询

```
select users.id_user from users,sales,specSales where users.id_user=sales.id_user AND sales.id_sale=specSales.id_sale AND specSales.id_article=34 group by id_user 
```

我想要购买由 id_article=X 标识的产品的不同用户

我已经想到了这一点，但我不确定改进

```
select id_user from (select distinct(sales.id_user) from sales,specSales where sales.id_sale=specordine.id_sale and specSale.id_article=34)as t 
```

表是（*=主键）

```
users
*id_user | name | ....

sales
*id_sale | id_user | .... other values

salesSpec
id_sale | id_article | .... other values 
```

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:11:18.833

第二个查询可以简化为：

```
select distinct(sales.id_user)
from sales join
     specSales 
     on sales.id_sale=specordine.id_sale
where specSale.id_article=34 
```

这应该比第一个版本执行得更快。一个简单的原因：它没有加入用户表。“distinct”应该与“group by”的工作量大致相同，因此连接的差异应该是性能的主要影响。

这假设用户表的加入没有充当过滤器（销售中的所有用户 id 都在表中并且没有重复）。

此外，您应该开始使用正确的连接语法。在 from 语句中使用“，”是不好的做法。

# tomcat - 在 Web 容器中使用 Apache 的 HttpClient 和 HTTPS 时遇到问题

> ID：11871210
> 
> 赞同：1
> 
> 时间：2012-08-08T18:52:18.340
> 
> 标签：tomcat, https, junit, jetty, apache-httpclient-4.x

我正在使用 Apache 的`HttpClient`4.2.1 版来执行 HTTP POST，我得到了常见的结果`SSLPeerUnverifiedException`：

```
javax.net.ssl.SSLPeerUnverifiedException: peer not authenticated
    at com.sun.net.ssl.internal.ssl.SSLSessionImpl.getPeerCertificates(SSLSessionImpl.java:352)
    at org.apache.http.conn.ssl.AbstractVerifier.verify(AbstractVerifier.java:128)
    ... 
```

许多解决方案比比皆是，但我认为这种情况有所不同。

当我在 Eclipse 或 Maven 中使用 JUnit 执行代码时`HttpClient`，我没有收到任何错误，并且可以按预期与相关服务器进行通信。但是，当代码在 Tomcat 或 Jetty 中运行时（通过 Maven 的 Cargo 插件），我得到了上述异常。

为什么会发生这种情况，我该怎么做才能克服这个问题？

# excel - 我需要一个与 Excel 中的 NETWORKDAYS 相反或相反的函数

> ID：11871213
> 
> 赞同：1
> 
> 时间：2012-08-08T18:52:26.587
> 
> 标签：excel, excel-formula

NETWORKDAYS 返回两个日期之间的天数。我有一个开始日期和工作日数，我需要返回结束日期。（或者我需要提供结束日期和工作日数并返回开始日期）。是否有 Excel 功能可以做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T19:00:46.803

认为您正在寻找 WORKDAY(start_date,days)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T19:03:14.323

您将需要使用[WORKDAY 功能](http://office.microsoft.com/en-us/excel-help/workday-HP005209339.aspx)

# java - 使用 Ant 设置一个第三方 JAR 的类路径以包含另一个

> ID：11871215
> 
> 赞同：3
> 
> 时间：2012-08-08T18:52:34.313
> 
> 标签：java, ant, classpath

如何设置一个第三方 JAR 的类路径以在 Ant 中包含第二个第三方 JAR？

我需要这个来运行 vanilla *Using Schematron with ANT* example from [this site](http://schematron.com/implementation.html)。^(（我 99% 确定您不需要知道 Schematron 是什么来回答这个问题。）)该示例的说明位于页面顶部附近链接的简短 PDF 中。我将所有文件的内容直接从 PDF 复制粘贴到 Eclipse 中。

然后我`ant-schematron-2010-04-14.jar`从上面的站点下载，并`saxon9he.jar`从 SAXON SourceForge 页面获取。我还更改了构建文件以匹配。带有行号且不带注释，它看起来像这样：

```
09 <project name="schematron-ant-sample" default="validate">
14     <taskdef name="schematron"
15              classname="com.schematron.ant.SchematronTask"
16              classpath="lib/ant-schematron-2010-04-14.jar; lib/saxon9he.jar" />
22     <target name="validate" description="Test with a Fileset">
23         <schematron schema="sch/sample.sch" failonerror="false">
24             <fileset dir="xml" includes="*.xml" />
25         </schematron>
26     </target>
27 </project> 
```

当我运行构建文件时，出现以下错误：

```
validate:

BUILD FAILED
C:\Users\gdawes\Documents\workspace\SchematronAntExample\build.xml:23: /
javax.xml.transform.TransformerFactoryConfigurationError: Provider /
net.sf.saxon.TransformerFactoryImpl not found

Total time: 265 milliseconds 
```

如果 SAXON JAR 未列在`schematron`的类路径中，则会发生类似的错误。我已经确认它`TransformerFactoryImpl`存在于 SAXON JAR 中，但我不知道如何让 Schematron 代码识别它。我应该如何设置类路径？（或者，如果我错了并且这不是类路径问题，我该如何让构建成功？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:13:49.700

`classpath`中的应该`<taskdef>`只包含：`lib/ant-schematron-2010-04-14.jar`，类似于***[Using Schematron for Ant by example](http://schematron.com/resource/Using_Schematron_for_Ant.pdf)***中提供的示例。

```
<?xml version="1.0" encoding="UTF-8"?>
<project name="schematron-ant-sample" default="validate">
  <taskdef name="schematron"
      classname="com.schematron.ant.SchematronTask"
      classpath="lib/ant-schematron-2010-04-14.jar" />
  <target name="validate" description="Test with a Fileset">
    <schematron schema="sch/sample.sch" failonerror="false">
      <fileset dir="xml" includes="*.xml" />
    </schematron>
  </target>
</project> 
```

除了更正 之外`<taskdef>`，将 放在`saxon9he.jar`Ant 库文件夹中也`net.sf.saxon.TransformerFactoryImpl`可以使用并解决错误（在 Ubuntu Linux 上使用 Ant 1.8.2 测试）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T19:44:37.367

如果我没记错的话，taskdef 上的类路径只是用于查找您要加载的类的类路径，它不是任务实际运行的类路径。尝试将所需的 jars 添加到Eclipse 中 Ant 构建配置`User Entries`的选项卡部分。`Classpath`

# php - 访问 kohana auth hash_password 方法

> ID：11871219
> 
> 赞同：0
> 
> 时间：2012-08-08T18:52:49.243
> 
> 标签：php, kohana

我想在基于正常会话的登录的上下文之外使用 kohana auth hash_password 方法进行身份验证。（对于一个简单的 api）

我尝试了几种方法。简单地实例化 auth 类是行不通的，因为它是一个抽象类。我试图静态调用该方法，这显然不起作用。最后，我尝试创建了一个名为 authenticate 的新类，它扩展了 auth 类并实例化了该类。我收到以下错误

> Authenticate 类包含 3 个抽象方法，因此必须声明为抽象方法或实现其余方法（Kohana_Auth::_login、Kohana_Auth::password、Kohana_Auth::check_password）

不知道该怎么做

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:10:07.753

尝试 Auth::factory()->hash_password($pass) ，这将创建一个没有与之关联的用户数据的新 Auth 对象，或者 Auth::instance() 将拾取当前实例化的 Auth 对象（如果有的话）。

# python - Python：“TypeError：__str__ 返回非字符串”但仍打印输出？

> ID：11871221
> 
> 赞同：57
> 
> 时间：2012-08-08T18:53:02.643
> 
> 标签：python

我有这段代码可以创建一个新注释..当我尝试打印时，即使它打印输出，我也会收到以下错误

```
Error:
C:\Python27\Basics\OOP\formytesting>python notebook.py
Memo=This is my first memo, Tag=example
Traceback (most recent call last):
  File "notebook.py", line 14, in <module>
    print(firstnote)
TypeError: __str__ returned non-string (type NoneType) 
```

笔记.py

```
import datetime
class Note:
    def __init__(self, memo, tags):
        self.memo = memo
        self.tags = tags
        self.creation_date = datetime.date.today()

    def __str__(self):
        print('Memo={0}, Tag={1}').format(self.memo, self.tags)

if __name__ == "__main__":
    firstnote = Note('This is my first memo','example')
    print(firstnote) 
```

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2012-08-08T18:54:04.057

方法[__str__](http://docs.python.org/reference/datamodel.html#object.__str__)应该返回字符串，而不是打印。

```
def __str__(self):
    return 'Memo={0}, Tag={1}'.format(self.memo, self.tags) 
```

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2015-02-11T18:46:43.633

你也可以用 str() 包围输出。我遇到了同样的问题，因为我的模型具有以下内容（作为简化示例）：

```
def __str__(self):
    return self.pressid 
```

其中 pressid 是一个 IntegerField 类型的对象。Django（和一般的python）需要一个字符串作为**str**函数，所以返回一个整数会导致这个错误被抛出。

```
def __str__(self):
    return str(self.pressid) 
```

这解决了我在房子的 Django 管理方面遇到的问题。希望它对你有帮助。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2018-08-22T07:13:09.033

您面临的问题是： TypeError : **str** returned non-string (type NoneType)

这里你必须了解**str**函数的工作原理：**str**函数虽然主要用于打印值，但实际上旨在返回一个字符串，而不是打印一个。在您的类**str**函数中直接调用 print 而它没有返回任何内容，这解释了您的错误输出。由于我们的格式化字符串是构建的，并且由于我们的函数没有返回任何内容，因此使用 None 值。这是您的错误的解释

**您可以通过使用str**函数中的 return 来解决这个问题，例如： *simply returnig 字符串值而不是打印它

```
 class Summary(models.Model):
   book = models.ForeignKey(Book,on_delete = models.CASCADE)
   summary = models.TextField(max_length=600)

    def __str__(self):
        return self.summary 
```

但是如果您返回的值不是字符串类型，那么您可以这样做从您的**str** 函数返回字符串值

*将值类型转换为**str**函数返回的字符串

```
class Summary(models.Model):
   book = models.ForeignKey(Book,on_delete = models.CASCADE)
   summary = models.TextField(max_length=600)

   def __str__(self):
       return str(self.summary)
            ` 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-17T01:34:57.610

我遇到了同样的问题，就我而言，是因为我返回了一个数字：

```
def __str__(self):
    return self.code 
```

str 正在等待一个 str，而不是另一个。

现在可以很好地使用：

```
def __str__(self):
    return self.name 
```

其中名称是一个字符串。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-07-20T14:15:14.090

您的表中可能有一些空值。进入mysql并删除表中的空值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-03-12T12:25:08.183

我是 Django 的新手。但我分享我的经验，因为解决了同样的情况。

我的情况是，某天（没有记忆）将某些字段（备忘录）的属性更改（添加）为 null=True。但我完全忘记了我的model.py如下。

```
def __str__(self):
    if self is not None:
        return self.author.memo 
```

所以我将返回值编辑到其他字段。就这样。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-01-05T00:21:57.687

试试这个：

```
def __str__(self):
    return f'Memo={self.memo}, Tag={self.tags}' 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-01-08T11:34:02.690

在模型的`__str__`方法中，您返回的值是`null`.

例如：

```
class X(models.Model):
    name = models.CharField(_('Name'), null=True, blank=True, 
    max_length=150)
    date_of_birth = models.DateField(_('Date of birth'), null=True, blank=True)
    street = models.CharField(_('Street'), max_length=150, blank=True)

    def __str__(self):
        return self.name # here the value of name field might be null, so the 
```

错误正在显示。

正确`__str__`的方法是：

```
def __str__(self):
    return str(self.name) 
```

# jquery - 提取元素中的文本，然后使用 jQuery 将其附加到属性

> ID：11871226
> 
> 赞同：-2
> 
> 时间：2012-08-08T18:53:31.267
> 
> 标签：jquery, text, attributes, clone, extraction

我在这个链接上捎带... [使用 JQuery 提取元素中的文本](https://stackoverflow.com/questions/1017330/extract-the-text-in-a-element-with-jquery)

我喜欢提取元素中的文本，然后将其附加到这样的属性中。

jQuery

```
$(document).ready(function() {
    var text;
    $(".parent span").contents().each(function(i) {
        if(this.nodeName == "#text") text = $(this).text();   
        $(".child").attr("ref", text);
    });
}); 
```

HTML

```
<div class="parent">
  <div class="child"> </div>
  <span><strong>bla bla bla</strong>Child-1</span> </div>
<div class="parent">
  <div class="child"> </div>
  <span><strong>bla bla bla</strong>Child-2</span> 
</div> 
```

我一直在每个父母的参考中得到“Child-1”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T18:56:44.213

试试这个：

```
$(document).ready(function() {
    $("div.child").each(function() {
        var text = "";
        $(this).next("span").contents().each(function(i) {
            if(this.nodeName == "#text") text += $(this).text();
        });
        $(this).parent().attr("ref", text);
    });
}); 
```

注意：我使用链接问题中接受的答案从第一个获取所需的文本`div`。

# android - Android socket建立连接但不发送或接收

> ID：11871229
> 
> 赞同：0
> 
> 时间：2012-08-08T18:53:50.640
> 
> 标签：android, sockets

我一直在尝试在我的服务器和电话之间建立一个基本的套接字连接。以下代码在 Android 模拟器上完美运行，但是当我在手机上尝试时，它失败了，我不知道为什么。我已经尝试了在 SO 和 Google 上可以找到的大多数建议，但没有一个有效。

我的服务器代码只是一些基本的 Ruby：需要 'socket'

```
server = TCPServer.new 2000

puts 'Server started!'
loop do
Thread.start(server.accept) do |client|
puts "Received client"

client.write "Connection established."

    while text = client.gets
        puts text
        client.puts text # Just echo the result back...
    end

    client.close
  end
end 
```

我的客户端代码如下： public void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main);

```
 try{
        Socket s = new Socket("***", 2000);

        BufferedReader in = new BufferedReader(new InputStreamReader(s.getInputStream()));

        PrintWriter out = new PrintWriter(s.getOutputStream());

        out.println("test\r\n"); 
        out.flush();
        out.close();            

    }catch(Exception e){

    }

} 
```

该代码在模拟器上返回预期的响应：

```
Server started!
Received client
test 
```

但是当我在手机上运行它时，它只会返回：

```
Server started!
Received client 
```

显然它正在建立连接。我写了一些更深入的代码，也写回服务器，模拟器再次写入和接收，但我的手机两者都没有，过了一会儿，我的手机报告：“连接被对等方关闭。”

任何想法都会很棒！

编辑：它似乎在我朋友的手机上工作......所以现在我更加难过......我正在使用索尼 Xperia

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T18:57:06.747

您永远不会从输入流中读取任何输入，因此它只是在等待。也许您想要做的是在缓冲阅读器上调用 readLine() 。并且可能将您的输出流代码放在输入流代码之前。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T13:55:06.530

原来运营商 MTN 上的端口 2000 存在问题。使用另一个端口解决了我的问题。

# jquery - Jquery Slider：对象[object Object]没有方法'slider'？

> ID：11871231
> 
> 赞同：0
> 
> 时间：2012-08-08T18:53:57.303
> 
> 标签：jquery, jquery-ui

我可能遗漏了一些微不足道的东西，但我找不到任何缺陷，我有一个 Jquery UI 滑块

```
$(function()
        {
            $("#slider").slider(
                {
                    min : 0,      // Have a box that just takes in the price
                    max : 500,
                    change: function(event,ui)
                    {
                        $( "#amount" ).val( "$" + ui.value );
                    }
                });
            $("#amount").val( "$" + $("#slider").slider("value") );
        }); 
```

我的html代码是

```
<label for="amount">Your Price:</label> 
<input type="text" id="amount" style="border: 0; font-weight: bold;" />
<div id="slider" class="slider"></div> 
```

但我的滑块没有显示，我在 chrome 中不断收到此错误

```
Uncaught TypeError: Object [object Object] has no method 'slider' 
```

我还包含了 jquery 头文件

```
<script type="text/javascript" src="js/jquery-1.7.2.js"></script> 
```

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T18:54:59.190

您需要在 jQuery 包含之后包含滑块的 jQuery UI 插件。那是：

```
<script type="text/javascript" src="js/jquery-1.7.2.js"></script>
<script type="text/javascript" src="PATH_TO_JQUERY_UI"></script> 
```

# android - Android、C++ 上的基准矩阵乘法

> ID：11871234
> 
> 赞同：0
> 
> 时间：2012-08-08T18:54:08.833
> 
> 标签：android, memory, matrix, linear-algebra

嗨，我正在使用带有 JNI（Java - C++）的 Android 来对 Android 设备上的一些矩阵乘法运算进行基准测试。有没有人有任何关于以前进行的测试的资源？我确信这是一个很好的访问问题，并且想看看那里已经完成了什么。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T12:24:41.050

您可以使用[Linpack Benchmark Suite，](http://en.wikipedia.org/wiki/LINPACK_benchmarks)它是专为 CPU 基准测试而设计的，使用矩阵运算。您还可以查看[0xbench，](http://code.google.com/p/0xbench/wiki/Benchmarks)一个针对 android 的开源基准测试套件，以获取 Linkack 基准测试的源代码

# function - 将字符串或字符串数 组传递给 Powershell 中的函数

> ID：11871236
> 
> 赞同：9
> 
> 时间：2012-08-08T18:54:14.353
> 
> 标签：function, powershell

我希望这是一个简单的问题。我有一个 Powershell 函数，可以对给定文件夹中的所有文件进行操作。有时我想让函数在单个文件夹上运行，有时我希望它在多个文件夹上运行，这些文件夹的路径存储在一个数组中。有没有办法让一个函数能够同时接受单个元素和数组？

```
Do-Stuff $aSingleFolder

Do-Stuff $anArrayofFolders 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-08T20:11:43.773

您还可以在函数中运行流程部分。它看起来像这样：

```
Function Do-Stuff {
    param(
        [Parameter( `
            Mandatory=$True, `
            Valuefrompipeline = $true)]
        [String]$Folders
    )
    begin {
        #Things to do only once, before processing
    } #End Begin

    Process {
         #What  you want to do with each item in $Folders
    } #End Process 

    end {
        #Things to do at the end of the function, after all processes are done
    }#End end
} #End Function Do-Stuff 
```

然后当你调用函数时。像这样做

```
$Folders | Do-Stuff 
```

这是将会发生的事情。块中的所有内容都`Begin`将首先运行。然后，对于`$Folders`变量中的每个项目，`Process`块中的所有内容都将运行。完成后，它将运行`End`块中的内容。这样，您可以将任意数量的文件夹通过管道传输到您的函数中。如果您想在某天向此函数添加其他参数，这将非常有用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-08T19:01:05.987

在 Powershell 中，您可以以统一的方式迭代数组和单个元素：

```
function Do-Stuff($folders) {
    foreach($f in $folders) {
        //do something with $f
    }
} 
```

传递单个元素将导致 foreach 对给定项目执行一次。

```
Do-Stuff "folder"
Do-Stuff "folder1", "folder2",... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-19T16:02:13.843

这在没有 cmd.exe 和使用文件的情况下有效：

```
 function Invoke-PlinkCommandsIOS { 
     param (
        [Parameter(Mandatory=$true)][string] $Host,
        [Parameter(Mandatory=$true)][System.Management.Automation.PSCredential] $Credential,
        [Parameter(Mandatory=$true)][string] $Commands,
        [Switch] $ConnectOnceToAcceptHostKey = $false
    )
     $PlinkPath="$PSScriptRoot\plink.exe"
    $commands | & "$PSScriptRoot\plink.exe" -ssh -2 -l $Credential.GetNetworkCredential().username -pw "$($Credential.GetNetworkCredential().password)" $Host -batch
 } 
```

用法：不要忘记你的出口和终端长度 0 否则它会挂起

```
PS C:\> $Command = "terminal lenght 0
>> show running-config
>> exit
>> "
>>
PS C:\> Invoke-PlinkCommandsIOS -Host ace-dc1 -Credential $cred -Commands $Command 
```

……

# node.js - MongoDB：使用字典更新数组中的文档

> ID：11871238
> 
> 赞同：1
> 
> 时间：2012-08-08T18:54:18.643
> 
> 标签：node.js, mongodb

我发现一个[StackOverflow Question](https://stackoverflow.com/questions/6460394/mongodb-updating-a-document-in-an-array)非常接近回答我的问题，但并不完全在那里。

采取这个原始问题（修改数组中的文档），但假设您没有想要进行的特定更改。相反，我有一本我希望做出的改变的字典。这是一个例子：

**原始文件**

```
{
    _id: something,
    recipients: [{id:1, name:"Andrey", isread:false}, {id:2, name:"John", isread:false}]
} 
```

**要做的改变**

```
{
    isread: true,
    fullname: 'jonathan'
} 
```

如何将这本更改字典应用于 John (id:2)？如果它是相关的，我正在使用[MongoDB-Node.JS 驱动程序](http://mongodb.github.com/node-mongodb-native/api-generated/collection.html#findandmodify) 谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T19:05:24.753

就像您引用的问题一样，您需要使用`$` [位置运算符](http://www.mongodb.org/display/DOCS/Updating#Updating-The%24positionaloperator)，但`update`在这种情况下：

```
collection.update({_id:something, 'recipients.id': 2}, {$set: {'recipients.$': {
    isread: true,
    fullname: 'jonathan'
}}}, function (err) {... 
```

**编辑**

要不替换整个数组元素对象，您必须执行以下操作：

```
collection.update({_id:something, 'recipients.id': 2}, {$set: {
    'recipients.$.isread': true,
    'recipients.$.fullname': 'jonathan'
}}, function (err) {... 
```

# python - Python在图中找到x值对应的最大y值

> ID：11871241
> 
> 赞同：7
> 
> 时间：2012-08-08T18:54:21.640
> 
> 标签：python, average, max

我已经从大约 300,000 个数据点绘制了一个移动平均值，我需要找到信号峰值的最大 y 值及其相应的 x 值，这将是它的频率。我想让它给我绘图本身的坐标，但如果我能让它至少打印出来，我会很满意。请原谅我的编程技能，因为它们不是最强的。这是我正在处理的代码部分以及它生成的绘图的链接。我没有足够的积分来发布图像。

```
def movingaverage(interval, window_size):
    window= np.ones(int(window_size))/float(window_size)
    return np.convolve(interval, window, 'same')

x = freq[0:300000]
y = fft
pylab.plot(x,y,"k.")
y_av = movingaverage(y, 30)
pylab.plot(x, y_av,"r")
pylab.xlim(0,10)
pylab.ylim(0,1500)
pylab.xlabel("Frequency")
pylab.ylabel("Moving Average Magnitude")
pylab.grid(True)
pylab.show() 
```

[移动平均线图](http://i256.photobucket.com/albums/hh161/KyLayfield/Plot.jpg)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-08T18:59:41.640

您应该能够执行以下操作：

```
max_y = max(y_av)  # Find the maximum y value
max_x = x[y_av.index(max_y)]  # Find the x value corresponding to the maximum y value
print max_x, max_y 
```

* * *

**编辑**

numpy 数组没有索引方法，所以我们应该使用 argmax，正如评论中指出的那样：

```
max_y = max(y_av)  # Find the maximum y value
max_x = x[y_av.argmax()]  # Find the x value corresponding to the maximum y value
print max_x, max_y 
```

* * *

我认为[这个 API](http://matplotlib.sourceforge.net/api/pyplot_api.html#matplotlib.pyplot.text)应该可以让你在图像上绘制文本。你可以这样做：

```
pylab.text(max_x, max_y, str((max_x, max_y))) 
```

# c++ - knuth 乘法哈希

> ID：11871245
> 
> 赞同：9
> 
> 时间：2012-08-08T18:54:28.987
> 
> 标签：c++, algorithm, hash

这是 Knuth 乘法哈希的正确实现吗？

```
int hash(int v)
{
    v *= 2654435761;
    return v >> 32;
} 
```

乘法中的溢出会影响算法吗？

如何提高这种方法的性能？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2017-01-08T21:17:10.970

Knuth 乘法散列用于`{0, 1, 2, ..., 2^p - 1}`从整数 k 计算散列值。

假设它`p`在 0 到 32 之间，算法如下所示：

*   将 alpha 计算为最接近 2^32 (-1 + sqrt(5)) / 2 的整数。我们得到 alpha = 2 654 435 769。

*   计算 k * alpha 并以 2^32 为模减少结果：

    k * alpha = n0 * 2^32 + n1 其中 0 <= n1 < 2^32

*   保留 n1 的最高 p 位：

    n1 = m1 * 2^(32-p) + m2 0 <= m2 < 2^(32-p)

因此，在 C++ 中 Knuth 乘法算法的正确实现是：

```
std::uint32_t knuth(int x, int p) {
    assert(p >= 0 && p <= 32);

    const std::uint32_t knuth = 2654435769;
    const std::uint32_t y = x;
    return (y * knuth) >> (32 - p);
} 
```

忘记将结果移动 (32 - p) 是一个重大错误。因为您将失去哈希的所有良好属性。它将偶数序列转换为偶数序列，这将非常糟糕，因为所有奇数插槽都将保持空置状态。这就像拿一杯好酒和可乐混合。顺便说一句，网络上到处都是错误引用 Knuth 并使用乘以 2 654 435 761 而没有取高位的人。我刚打开 Knuth，他从来没有说过这样的话。看起来某个自认为“聪明”的人决定取一个接近 2 654 435 769 的素数。

请记住，大多数哈希表实现不允许在其接口中使用这种签名，因为它们只允许

```
uint32_t hash(int x); 
```

并减少`hash(x)`模 2^p 以计算 x 的哈希值。那些哈希表不能接受 Knuth 乘法哈希。这可能是为什么这么多人因为忘记取更高的 p 位而完全破坏了算法的原因。因此，您不能将 Knuth 乘法哈希与`std::unordered_map`or一起使用`std::unordered_set`。但我认为那些哈希表使用素数作为大小，所以 Knuth 乘法哈希在这种情况下没有用。使用`hash(x) = x`将非常适合这些表。

资料来源：“算法简介，第三版”，Cormen 等人，13.3.2 p:263

资料来源：“计算机编程艺术，第 3 卷，排序和搜索”，DE Knuth，6.4 p:516

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-08-08T20:19:50.603

好的，我在 TAOCP 第 3 卷（第 2 版）第 6.4 节第 516 页中查到了它。

这个实现是不正确的，尽管正如我在评论中提到的那样，它*可能会*给出正确的结果。

一个正确的方法（我认为 - 随意阅读TAOCP的相关章节并验证这一点）是这样的：（重要：是的，你必须将结果右移以减少它，而不是使用按位AND。但是，那不是*此功能*的责任- 范围缩小不是散列本身的适当部分）

```
uint32_t hash(uint32_t v)
{
    return v * UINT32_C(2654435761);
    // do not comment about the lack of right shift. I'm not ignoring it. read on.
} 
```

请注意`uint32_t`'s（与`int`'s 相对）——它们确保乘法溢出模 2^32，如果您选择 32 作为字长，则应该这样做。这里也没有右移`k`，因为没有理由将范围缩小的责任交给基本的散列函数，而获得完整结果实际上更有用。常数 2654435761 来自问题，实际建议的常数是 2654435769，但据我所知，这是一个很小的差异，不会影响哈希的质量。

其他有效的实现将结果向右移动一定量（虽然不是完整的字长，这没有意义，C++ 也不喜欢它），具体取决于您需要多少位散列。或者他们可以使用其他常量（受某些条件限制）或其他字长。减少哈希模数*不是*一个有效的实现，而是一个常见的错误，可能是对哈希进行范围减少的事实上的标准方法。乘法散列的底部位是质量最差的位（它们依赖于较少的输入），如果您确实需要更多位，您只想使用它们，而将散列模数为 2 的幂只会返回*最差的位位*. 事实上，这也相当于丢弃了大部分输入位。以非二次幂为模减少并不是那么糟糕，因为它确实混合了更高的位，但这不是乘法散列的定义方式。

# 所以要清楚，是的，有一个右移，但那是*范围缩小*而不是*散列*，只能是散列表的责任，因为它取决于它的内部大小。

类型应该是无符号的，否则溢出是未指定的（因此可能是错误的，不仅在非 2 的补码架构上而且在过于聪明的编译器上）并且可选的右移将是有符号的移位（错误）。

在我在顶部提到的页面上，有这个公式：

[![克努特公式](../Images/36a7bf9ae89045324ff9b72d8325bd4d.png)](https://i.stack.imgur.com/kDEZz.png)

这里我们有 A = 2654435761（或 2654435769），w = 2 ^(32)和 M = 2 ^(32)。计算 AK/w 给出了格式为 Q32.32 的定点结果，模 1 步骤仅采用 32 个小数位。但这与做模乘然后说结果是分数位是一样的。当然，当乘以 M 时，由于 M 的选择方式，所有小数位都变为整数位，因此它简化为一个普通的旧模乘法。如前所述，当 M 是 2 的较低幂时，这恰好使结果右移。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-01-12T13:00:02.220

可能会迟到，但这是 Knuth 方法的 Java 实现：

对于大小为 N 的哈希表：

```
public long hash(int key) {
    long l = 2654435769L;
    return (key * l >> 32) % N ;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-30T12:06:38.093

如果输入参数是一个指针，那么我使用它

```
#include <inttypes.h>

uint32_t knuth_mul_hash(void* k) {
  ptrdiff_t v = (ptrdiff_t)k * UINT32_C(2654435761);
  v >>= ((sizeof(ptrdiff_t) - sizeof(uint32_t)) * 8); // Right-shift v by the size difference between a pointer and a 32-bit integer (0 for x86, 32 for x64)
  return (uint32_t)(v & UINT32_MAX);
} 
```

我通常在 hashmap 实现、字典、集合等中使用它作为默认的后备散列函数......

# ios - CBCharacteristicProperties 是什么意思？

> ID：11871249
> 
> 赞同：7
> 
> 时间：2012-08-08T18:54:37.387
> 
> 标签：ios, core-bluetooth

在 iOS CBCharacteristic Class Reference 中，有用于返回特征属性的位图的描述。我正在寻找有关其中三个含义的信息。

文档将它们列出如下：

**CBCharacteristicProperties**

特征的可能属性。

```
enum {
    CBCharacteristicPropertyBroadcast = 0x01,
    CBCharacteristicPropertyRead = 0x02,
    CBCharacteristicPropertyWriteWithoutResponse = 0x04,
    CBCharacteristicPropertyWrite = 0x08,
    CBCharacteristicPropertyNotify = 0x10,
    CBCharacteristicPropertyIndicate = 0x20,
    CBCharacteristicPropertyAuthenticatedSignedWrites = 0x40,
    CBCharacteristicPropertyExtendedProperties = 0x80,
}; 
```

我找不到其他文档或这些属性的列表。

有些是显而易见的，例如读取、写入和通知。广播记录在我发现的其他 BLE 文档中。

CBCharacteristicPropertyWriteWithoutResponse 令人困惑。为什么这是一面旗帜？CBDevice 调用 writeValue:forCharacteristic:type: 有一个接受以下内容的标志：

```
enum {
    CBCharacteristicWriteWithResponse = 0,
    CBCharacteristicWriteWithoutResponse,
}; 
```

这些标志是多余的，还是必须为 writeValue:forCharacteristic:type: 提供与 CBCharacteristicProperties 标志匹配的类型？

另外，CBCharacteristicPropertyIndi​​cate 和 CBCharacteristicPropertyExtendedProperties 是什么意思？

有没有比 Apple 的文档更好的参考来解释这些？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-09T16:03:32.757

我在 Apple Developer Forums 上得到了这个答案：

> 它有助于理解底层规范。如果您查看 4.0 规范的主机卷中的 GATT 部分（可在此处获得：http: [//www.bluetooth.org/Technical/Specifications/adopted.htm](http://www.bluetooth.org/Technical/Specifications/adopted.htm)），常量应该更清楚。
> CBCharacteristicPropertyWriteWithoutResponse 表示该特性支持“Write without Response”子过程。CBCharacteristicWriteWithoutResponse 表示您实际上想要使用“Write without Response”子过程。据推测，尝试对不支持它的特性使用“无响应写入”子过程将导致错误。希望有帮助，
> 
> 本

作为后续，有问题的文档是[Core Version 4.0](http://www.bluetooth.org/docman/handlers/downloaddoc.ashx?doc_id=229737)。请参阅第*3.3.1.1 节特性属性*。

# linux - 从linux中的目录读取文件的顺序

> ID：11871251
> 
> 赞同：1
> 
> 时间：2012-08-08T18:54:46.850
> 
> 标签：linux, bash, shell, linux-kernel

如果在一个目录中，假设有 100 个文件，名称分别为 file.pcap1、file.pcap2、file.pcap3、.....、file.pcap100。在 shell 脚本中，为了逐个读取这些文件，我写了如下一行：

```
for $file in /root/*pcap*
do
  Something
done 
```

读取文件的顺序是什么？它们是否按文件名末尾的数字的递增顺序读取？所有类型的 linux 机器都是一样的情况吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:01:12.997

它按文件名排序。就像默认值一样`ls`（没有标志）。

此外，您需要`$`在 foreach 中删除：

```
for file in /root/*pcap* 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T19:18:37.377

[POSIX shell 返回使用当前语言环境排序的路径](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_13_02)：

> 如果模式匹配任何现有文件名或路径名，则模式应替换为这些文件名和路径名，*根据当前语言环境中有效的整理顺序进行排序*

这意味着 pcap10 在 pcap2 之前。您可能需要自然排序顺序，例如[natsort 函数的 Python 模拟（使用“自然顺序”算法对列表进行排序）](https://stackoverflow.com/questions/2545532/python-analog-of-natsort-function-sort-a-list-using-a-natural-order-algorithm)。

# jquery - 即使用户通过点击后退按钮进入页面，也执行 document.ready

> ID：11871253
> 
> 赞同：19
> 
> 时间：2012-08-08T18:54:57.837
> 
> 标签：jquery

我有一个带有 jQ​​uery 的 PHP 页面，它对页面`$(document).ready()`上的表单进行了一些更改。这工作正常。但是，如果我来到这个页面，然后去另一个页面，然后从浏览器中点击“返回”并返回到这个页面，该`$(document).ready()`功能似乎根本没有运行。这发生在 FF 和 Chrome 上。

`document.ready`即使用户点击浏览器的后退按钮来访问我的页面，是否有某种方法可以执行？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2018-01-11T18:36:53.090

我遇到了完全相同的问题；@Alfabravo 的链接在这里帮助了我很多： [https ://stackoverflow.com/a/12648785/679240](https://stackoverflow.com/a/12648785/679240)

下面的代码对我来说已经足够好了，因为我真正需要的是在用户进入页面或通过后退按钮到达页面时进行一些清理：

```
$(window).on('pageshow', function(){
    console.info('Entered the page!');
}); 
```

如果你需要专门检测页面是什么时候通过*返回按钮到达的，*而不是第一次进入的时候，你可能需要控制一下状态；上面的链接可能会对您有所帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-03-22T22:00:27.580

我的用例是，当点击后退按钮时，`ready`事件被触发并且我的处理函数执行得很好。

尽管如此，我发现我的一些页面数据仍然过时。

我放入了一些`console.log()`s 来断言所有函数实际上都被调用了。

对于我的特殊情况，当页面加载时，会调用一些 AJAX 来从我的服务器加载一些数据。我发现它实际上**是来自被缓存的 API 的响应！！！**

当然是！

那么，我的解决方案很简单。

我添加了一个新生成的时间戳

`new Date().getTime();`

作为 AJAX 调用 URL 的查询参数，瞧，返回的数据是新鲜的。

# reference - 为什么 c++ 允许常量引用由数值初始化？

> ID：11871260
> 
> 赞同：1
> 
> 时间：2012-08-08T18:55:12.620
> 
> 标签：reference, constants, definition, numeric

为什么这在 C++ 中有效？：

```
const int& a = 5; 
```

引用是别名。理想情况下，引用声明不应导致将内存分配给任何变量。但是，试试这个：

```
cout<<&a<<endl; 
```

你会得到一个内存地址！相反，以下将做同样的事情： const int a = 5;

同时更加优雅。

同样，这样的声明有什么用：

```
const int& a = 5; 
```

? 为什么它在 c++ 中被允许？

# opengl - CG Toolkit 替代品？

> ID：11871261
> 
> 赞同：0
> 
> 时间：2012-08-08T18:55:14.373
> 
> 标签：opengl

我希望有一个开源替代 CG 工具包。不过只需要编译高级 OpenGL 着色器。有这样的吗？我主要需要像 fx 文件这样的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T21:39:40.463

唯一的选择是构建您自己的效果库或使用不完整的开源库，例如 GLFX。

# php - PHP MYSQL 寻找一种方法来对在特定列中具有相同值的行进行分组

> ID：11871265
> 
> 赞同：1
> 
> 时间：2012-08-08T18:55:43.157
> 
> 标签：php, mysql

我有一个名为 records 的表，其中包含以下列：recordid、艺术家、专辑、描述和封面。表中的一些专辑具有相同的艺术家。

在我的网站上，我想这样显示：

-艺术家1 专辑 1
  专辑2 - 艺术家 2 专辑
  3
- 艺术家
  3
专辑 4
  专辑
  5

如果我使用 GROUP BY，它只会显示每个艺术家一行。有没有其他方法可以在不使用关系表的情况下对它们进行分组？

因为现在我有一个表单可以通过我的站点插入和更新表格，而且我不知道如何对表格进行编码才能使其与关系表一起使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:07:06.070

试试这个

```
select artist,group_concat(album) from albums group by artist 
```

给你

```
artist1  | album1,album2,album3
artist2  | albumx,albumy 
```

您可以在 PHP 中拆分第二列，例如使用 explode(row[1])

这应该对你有所帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T19:15:38.940

你可以做到这一点没有`group by`：

```
<?php
$query = 'Select artist, album
    FROM records
    ORDER BY artist'
$result = mysql_query($query);

$artist = '';
while ($line = mysql_fetch_assoc($result)){
    // only show artist when it's an other artist then the previous one
    if ($line['artist'] != $artist){
        echo $line['artist'].'<br/>';
        $artist = $line['artist'];
    }
    echo $line['album'].'<br/>';
}
?> 
```

我知道我不应该再使用 mysql_* 函数了，请选择 mysqli_* 或 PDO....

# php - 如何向此查询添加多个表

> ID：11871266
> 
> 赞同：1
> 
> 时间：2012-08-08T18:55:54.607
> 
> 标签：php, sql

我有一个名为的表`news`，并且使用这两个代码片段，我想创建一个扫描该`keywords`表的搜索引擎。一个表连接并运行得非常好，向查询中添加一个额外的表会更干净。

我的任务是创建一个从表中返回行的搜索引擎。搜索引擎基于关键字，非常适合特定术语，例如“纽约时报”，但如果我想输入新闻，那是所有新闻网站按 id 排序的地方。但有时，与 CNN 不同，由于 id 的原因，具有关键字“新闻”的完全不同的术语会在表格中弹出相当高的位置。使用新表，组织表会容易得多。这样，如果输入的术语是“新闻”，则站点将按 id 排序，即使它们在其他表上发生冲突，它们仍然按 id 排序。

虽然我的查询与传统查询有点不同，但我不知道如何

1.  通过`UNION`或添加表格

2.  带有某种`LEFT JOIN`标签。

我的查询如下，我希望有人解释：a）*简单的问题*b）*告诉我或粘贴下面的代码*：

```
<?php
if( isset($_GET['k']) ){
    $k = $_GET['k'];
}else{
    $k = '';
}
$k = ( isset($_GET['k']) )? trim($_GET['k']) : '';
$terms = (strlen($k) > 0)? explode(' ', $k) : Array();

/* The code below is from a different part of the script */

$query = " SELECT * FROM scan WHERE "; 

$terms = array_map('mysql_real_escape_string', $terms);
$i = 0; 
foreach ($terms as $each) {
    if ($i++ !== 0){
        $query .= " AND ";
    }
    $query .= "keywords LIKE '%{$each}%'";
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:14:43.040

我不确切知道您想做什么，但这可能会有所帮助：

```
$query = " SELECT * FROM scan, news WHERE scan.news_id = news.id AND ";

$terms = array_map('mysql_real_escape_string', $terms);

foreach ($terms as $each) {
  $query .= "AND scan.keywords LIKE '%{$each}%'";
} 
```

通过在查询中添加条件并从两个表中进行选择，您可以在两个表之间建立联合。条件是保证两个表中的公共列相等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T19:08:45.913

对于左连接，请阅读此[http://www.w3schools.com/sql/sql_join_left.asp](http://www.w3schools.com/sql/sql_join_left.asp)

我真的不知道你在问什么。如果你能澄清你的问题，我会为你提供一个例子。谢谢。

# datatables - Datatables fngetdata 关联格式

> ID：11871275
> 
> 赞同：0
> 
> 时间：2012-08-08T18:56:38.447
> 
> 标签：datatables

我有一个关于数据表 fngetdata 的问题。我`aData = oTable.fnGetData(aPos);`用来从我的数据表中获取一行。我正在以数组格式获取数据。所以我的第一列数据将是`aData[0]`，第二列将是`aData[1]`等等。我可以获取关联数组格式的数据吗？例如，第一列名称是`Group`，那么数据可以是`aData[Group]`吗？我需要这种格式，因为我的数据表是从 mysql 表中填充的，每当我扩展表以添加列时，我都必须更改所有其他列的位置。我想消除位置依赖性。请指教。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T22:33:01.323

`mDataProp`使用 中的选项修复了此问题`aoColumns`。

# apache - 子域到 Apache 中的子文件夹

> ID：11871276
> 
> 赞同：0
> 
> 时间：2012-08-08T18:56:42.780
> 
> 标签：apache, mod-rewrite, mod-vhost-alias

我正在寻找允许以下内容的 Apache 配置：

*   *将 sub.domain.com*作为,`/%docRoot%/domain.com/sub`和
*   将能够**为每个托管域和任何子域**执行此操作（即，没有每个域的虚拟主机配置）

我将不胜感激任何解决方案，特别是如果没有`mod_rewrite`涉及（使用`mod_vhost_alias`）。

注意：使用 有一些明显的解决方案`mod_vhost_alias`，但它们要么适用于*domain.com*要么适用于*sub.domain.com*，它们似乎都没有涵盖这两种情况。

祝你今天过得愉快！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:09:04.713

指向`*.domain.com`您的文档根目录 ( `/%docRoot%/`)。您需要在虚拟主机配置中执行此操作。在同一个虚拟主机中，添加以下内容：

```
RewriteEngine On
RewriteCond %{REQUEST_URI} !^/domain.com/
RewriteCond %{HTTP_HOST} ^([^\.]+)\.domain\.com$ [NC]
RewriteRule ^/(.*)$ /domain.com/%1/$1 [L] 
```

如果要避免指向`www.domain.com`，`/%docRoot%/domain.com/www`则添加条件以将其排除：

```
RewriteEngine On
RewriteCond %{REQUEST_URI} !^/domain.com/
RewriteCond %{HTTP_HOST} !^www\.domain\.com$ [NC]
RewriteCond %{HTTP_HOST} ^([^\.]+)\.domain\.com$ [NC]
RewriteRule ^/(.*)$ /domain.com/%1/$1 [L] 
```

* * *

编辑：

> 我假设我仍然必须为每个托管域执行此操作（因为您发布的示例都引用了“domain.com”）。我对吗？

是的，上面只会为 做路由`domain.com`，如果你想为所有任意的做这个`domain.com`，你需要做一些更棘手的事情：

```
RewriteEngine On
# here, %1 = subdomain name, and %2 = domain name
RewriteCond %{HTTP_HOST} ^([^\.]+)\.(.+)$ [NC]
# make sure the request doesn't already start with the domain name/subdomain name
RewriteCond %{REQUEST_URI}:%2/%1 !^/([^/]+/[^/]+)[^:]*:\1
# rewrite
RewriteRule ^/(.*)$ /%2/%1/$1 [L] 
```

这里最棘手的是`%{REQUEST_URI}:%2/%1 !^/([^/]+/[^/]+)[^:]*:\1`比赛。它提出条件：`%{REQUEST_URI}:domain.com/sub`并确保`%{REQUEST_URI}` *不*使用反向引用以`domain.com/sub`（使用 %2/%1 从先前的匹配`\1`反向引用）开始。

有了这个，您将您的虚拟主机设置为接受*每个域*（默认虚拟主机），并且任何子域/域都将被路由。例子：

*   `http://blah.bleh.org/file.txt`去`/%docRoot%/bleh.org/blah/file.txt`
*   `http://foo.bar.com/some/path/`去`/%docRoot%/bar.com/foo/some/path/`
*   `http://sub2.sub1.d.com/index.html`去`/%docRoot%/sub1.d.com/sub2/index.html`

* * *

编辑2：

> 是的，我非常希望将 domain.com 路由到`/%docRoot%/domain.com/`

试试这些：

```
RewriteCond %{HTTP_HOST} ^(.+?)\.([^\.]+\.[^\.]+)$ [NC]
RewriteCond %{REQUEST_URI}:%2/%1 !^/([^/]+/[^/]+)[^:]*:\1
RewriteRule ^/?(.*)$ /%2/%1/$1 [L]

RewriteCond %{HTTP_HOST} ^([^\.]+\.[^\.]+)$ [NC]
RewriteCond %{REQUEST_URI}:%1 !^/([^/]+)[^:]*:\1
RewriteRule ^/?(.*)$ /%1/$1 [L] 
```

基本上是一样的，除了需要调整一些正则表达式来区分 a`domain.com`和`sub.domain.com`. 如果你想重定向`www.domain.com`到`domain.com`，那需要在这些规则*之前发生。*

# javascript - How do I find an array within a multi-dimensional array?

> ID：11871285
> 
> 赞同：2
> 
> 时间：2012-08-08T18:57:09.987
> 
> 标签：javascript, jquery

This is how I am currently searching:

```
function RemoveQuestion(question)
    {
        $.each(questionCollection, function (index, item)
        {
            var indexToRemove;
            if (item["PprID"] == question["PprID"])
            {
                //This question needs to be removed.
                indexToRemove = index;
                return false;
            }
        });

        questionCollection.splice(indexToRemove, 1);
    } 
```

I feel like looping through every array instance, then looking at the array inside of it might be a bit slow.

Any help is appreciated.

Thanks

Kevin

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:02:45.277

您可以使用 jQuery inArray() 查找项目，然后将其删除

[http://api.jquery.com/jQuery.inArray/](http://api.jquery.com/jQuery.inArray/)

您甚至可以使用 jQuery grep 来查找项目并将其拼接出来：

[如何使用jQuery从数组中删除特定值](https://stackoverflow.com/questions/3596089/how-to-add-and-remove-array-value-in-jquery)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T18:59:32.197

To check the array you need this:

```
if( Object.prototype.toString.call( item ) === '[object Array]' ) {
  // do some
} 
```

To find element within an array you can use jQuery **[`.inArray()`](http://api.jquery.com/inarray)**.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T18:59:45.690

您可以将 更改`questionCollection`为数组的散列。或者，您可以先从中构建和索引哈希，假设您只需要这样做一次即可删除多个问题。

```
function IndexQuestions()
{
    $.each(questionCollection, function (index, item)
    {
        questionIndex[item["PprID"]] = index;
    });
}
function RemoveQuestion(question)
{
    var indexToRemove = questionIndex[question["PprID"]];
    if (indexToRemove != null)
    {
        questionCollection.splice(indexToRemove, 1);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T19:11:29.320

[http://api.jquery.com/jQuery.grep/](http://api.jquery.com/jQuery.grep/)

```
function RemoveQuestion(question) 
{ 
    questionCollection = $.grep(questionCollection, function (item) {
        return (item.PprID === question.PprID);
    }, true);
} 
```

# cakephp - CakePHP delete cascade do not work

> ID：11871288
> 
> 赞同：1
> 
> 时间：2012-08-08T18:57:32.127
> 
> 标签：cakephp

Excuse me my english... I have two models: User and Note In user.php:

```
var $hasMany=array('Note'=>array('className'=>'Note',
                                 'foreignKey'=>'user_id',
                                 'dependent'=>'true',
                                 'exclusive'=>'true'
                                 )
                    ); 
```

In users_controller.php:

```
function delete($id = null) {
    if (!$id) {
        $this->Session->setFlash(__('Invalid id for User', true));
        $this->redirect(array('action'=>'index'));
    }
    if ($this->User->delete($id,true)) {
        $this->Session->setFlash(__('User deleted', true));
        $this->redirect(array('action'=>'index'));
    }
} 
```

But when I delete an user, the notes associated with the user are not eliminated!!!

What is wrong????

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-09T04:33:54.300

它应该是：

```
// In your User Model
var $hasMany=array('Note'=>array('className'=>'Note',
                                 'foreignKey'=>'user_id',
                                 'dependent'=>true, // true without single quote
                                 'exclusive'=>true
                                )
                );

//In your Note Model
var $belongsTo = array('User'=>array('className'=>'User',
                                     'foreignKey'=>'user_id'
                             )
                ); 
```

现在试试。它也会删除相关的数据。请询问它是否不适合您。

# javascript - How to replace an apostrophe in a string in Javascript?

> ID：11871289
> 
> 赞同：15
> 
> 时间：2012-08-08T18:57:42.137
> 
> 标签：javascript, string

Given a string in Javacript, such as

```
var str = "this's kelly"; 
```

I want to replace the apostrophe (') with another character. Here is what I've tried so far:

```
str.replace('&quot;', 'A');
str.replace('\'', 'A'); 
```

None of these work.

How do I do it?

Can you also please advices me with the invalid characters that when passed to the query string or URL crashes the page or produces undesired results ? e.g passing apostrophe (') produces undesired result are their any more of them.

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-08-08T18:59:40.803

```
var str = "this's kelly"
str = str.replace(/'/g, 'A'); 
```

The reason your version wasn't working is because `str.replace` returns the new string, without updating in place.

I've also updated it to use the [regular expression](http://en.wikipedia.org/wiki/Regular_expression) version of `str.replace`, which when combined with the `g` option replaces all instances, not just the first. If you actually wanted it to just replace the first, either remove the `g` or do `str = str.replace("'", 'A');`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T18:59:41.267

做这个：

```
str = str.replace("'","A"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-08T19:00:42.583

str = str.replace("'", "A");

您正在运行该功能，但没有再次将其分配给任何东西，因此 var 保持不变

# hadoop - Reducer stuck due to dead host

> ID：11871293
> 
> 赞同：1
> 
> 时间：2012-08-08T18:57:53.357
> 
> 标签：hadoop

I noticed my reducer is stuck due to a dead host. On the logs, it's showing a lot of retry messages. Is it possible to tell job tracker to give up on the dead node and resume the work? There were 323 mappers and only 1 reducer. I am on hadoop-1.0.3.

```
2012-08-08 11:52:19,903 INFO org.apache.hadoop.mapred.ReduceTask: 192.168.1.23 Will be considered after: 65 seconds.
2012-08-08 11:53:19,905 INFO org.apache.hadoop.mapred.ReduceTask: attempt_201207191440_0203_r_000000_0 Need another 63 map output(s) where 0 is already in progress
2012-08-08 11:53:19,905 INFO org.apache.hadoop.mapred.ReduceTask: attempt_201207191440_0203_r_000000_0 Scheduled 0 outputs (1 slow hosts and0 dup hosts)
2012-08-08 11:53:19,905 INFO org.apache.hadoop.mapred.ReduceTask: Penalized(slow) Hosts: 
2012-08-08 11:53:19,905 INFO org.apache.hadoop.mapred.ReduceTask: 192.168.1.23 Will be considered after: 5 seconds.
2012-08-08 11:53:29,906 INFO org.apache.hadoop.mapred.ReduceTask: attempt_201207191440_0203_r_000000_0 Scheduled 1 outputs (0 slow hosts and0 dup hosts)
2012-08-08 11:53:47,907 WARN org.apache.hadoop.mapred.ReduceTask: attempt_201207191440_0203_r_000000_0 copy failed: attempt_201207191440_0203_m_000001_0 from 192.168.1.23
2012-08-08 11:53:47,907 WARN org.apache.hadoop.mapred.ReduceTask: java.net.NoRouteToHostException: No route to host
    at java.net.PlainSocketImpl.socketConnect(Native Method)
    at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:327)
    at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:193)
    at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:180)
    at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:384)
    at java.net.Socket.connect(Socket.java:546)
    at sun.net.NetworkClient.doConnect(NetworkClient.java:173)
    at sun.net.www.http.HttpClient.openServer(HttpClient.java:409)
    at sun.net.www.http.HttpClient.openServer(HttpClient.java:530)
    at sun.net.www.http.HttpClient.<init>(HttpClient.java:240)
    at sun.net.www.http.HttpClient.New(HttpClient.java:321)
    at sun.net.www.http.HttpClient.New(HttpClient.java:338)
    at sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:935)
    at sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:876)
    at sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:801)
    at org.apache.hadoop.mapred.ReduceTask$ReduceCopier$MapOutputCopier.getInputStream(ReduceTask.java:1618)
    at org.apache.hadoop.mapred.ReduceTask$ReduceCopier$MapOutputCopier.setupSecureConnection(ReduceTask.java:1575)
    at org.apache.hadoop.mapred.ReduceTask$ReduceCopier$MapOutputCopier.getMapOutput(ReduceTask.java:1483)
    at org.apache.hadoop.mapred.ReduceTask$ReduceCopier$MapOutputCopier.copyOutput(ReduceTask.java:1394)
    at org.apache.hadoop.mapred.ReduceTask$ReduceCopier$MapOutputCopier.run(ReduceTask.java:1326)

2012-08-08 11:53:47,907 INFO org.apache.hadoop.mapred.ReduceTask: Task attempt_201207191440_0203_r_000000_0: Failed fetch #18 from attempt_201207191440_0203_m_000001_0
2012-08-08 11:53:47,907 WARN org.apache.hadoop.mapred.ReduceTask: attempt_201207191440_0203_r_000000_0 adding host 192.168.1.23 to penalty box, next contact in 1124 seconds
2012-08-08 11:53:47,907 INFO org.apache.hadoop.mapred.ReduceTask: attempt_201207191440_0203_r_000000_0: Got 1 map-outputs from previous failures
2012-08-08 11:54:22,909 INFO org.apache.hadoop.mapred.ReduceTask: attempt_201207191440_0203_r_000000_0 Need another 63 map output(s) where 0 is already in progress
2012-08-08 11:54:22,909 INFO org.apache.hadoop.mapred.ReduceTask: attempt_201207191440_0203_r_000000_0 Scheduled 0 outputs (1 slow hosts and0 dup hosts)
2012-08-08 11:54:22,909 INFO org.apache.hadoop.mapred.ReduceTask: Penalized(slow) Hosts: 
2012-08-08 11:54:22,909 INFO org.apache.hadoop.mapred.ReduceTask: 192.168.1.23 Will be considered after: 1089 seconds. 
```

I leave it alone and it retried for a while then give up on the dead host and rerun the mapper and succeeded. It's caused by two ip addressed on the host and I intentionally turned off one ip which was the one hadoop use.

My question is whether there is a way to tell hadoop to give up the dead host without retrying.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T19:14:51.477

从您的日志中，您可以看到无法连接到运行地图任务的任务跟踪器之一。运行 reducer 的 tasktracker 试图通过 HTTP 协议检索 map 中间结果，它失败了，因为拥有结果的 tasktracker 已经死了。

tasktracker 失败的默认行为是这样的：

如果它们属于不完整的作业，jobtracker 会安排在失败的 tasktracker 上运行并成功完成的 map 任务重新运行，因为它们的中间输出驻留在失败的 tasktracker 的本地文件系统上，reduce 任务可能无法访问它们。任何正在进行的任务也会重新安排。

问题是，如果一个任务（无论是 map 还是 reduce）失败太多次（我认为是 4 次），它将不再被重新安排，并且作业将会失败。在您的情况下，映射似乎已成功完成，但减速器无法连接到映射器并检索中间结果。它尝试了 4 次，然后作业失败。

失败的任务不能完全忽略，因为它是作业的一部分，除非作业包含的所有任务都成功，否则作业本身不会成功。

尝试找到reducer 尝试访问的链接并将其复制到浏览器中以查看您得到的错误。

您还可以将某个节点列入黑名单并从 Hadoop 使用的节点列表中完全排除：

```
 In conf/mapred-site.xml

  <property>
     <name>mapred.hosts.exclude</name>
     <value>/full/path/of/host/exclude/file</value>
  </property>

  To reconfigure nodes.

  /bin/hadoop mradmin -refreshNodes 
```

# javascript - Any way to hide CSS and JavaScript file from the client-side user?

> ID：11871294
> 
> 赞同：4
> 
> 时间：2012-08-08T18:57:59.300
> 
> 标签：javascript, html, css

Is there any way to hide the CSS and JavaScript file from the client-side user and still embed it in the webpage shown to the user?

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-08T18:58:54.400

No. CSS and Javascript must be parsable and readable by the browser, therefore a human can get access to the same data.

It is possible to obscure/compress/minify the javascript, but all that generally does is remove whitespace and rename/shorten variable names. The script is still functional and anyone interesting in how it really works can still figure it out (perhaps by using some tools to reformat it) with a little more time.

The typical reasons for minification is to reduce the download size of your scripts (speeding up site performance), but it also has the side effect of making the code harder to read by a human. One should not count on minification providing any real protection as the code can be reformatted and still understood by anyone determined to do so.

If you need to keep something private, keep the logic on the server and don't put it in the client. Clients can access server-based functionality via ajax if need be.

I've never heard of anyone thinking there was a business reason to protect CSS. It's layout/presentation formatting.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T19:07:20.537

缩小和base64编码。[这是关于 base64 encoding 的问题](https://stackoverflow.com/questions/246801/how-can-you-encode-to-base64-using-javascript)。请注意，您所做的只是让查看代码的过程变得悲惨，仅此而已。

在线[编码器/解码器](http://www.motobit.com/util/base64-decoder-encoder.asp)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T19:02:49.093

您始终可以缩小 JavaScript 文件，以使其他人更难阅读或修改它。

例如： http: [//www.minifyjavascript.com/](http://www.minifyjavascript.com/)

你也可以用 CSS 做同样的事情。

[http://developer.yahoo.com/yui/compressor/](http://developer.yahoo.com/yui/compressor/) （它可以做 JavaScript 和 CSS）

还有其他站点提供了一种缩小文件的方法，但无法从客户端完全隐藏它。

# xml - How can I concatenate all of these XML tags into one larger tag of the same name with XSLT?

> ID：11871295
> 
> 赞同：1
> 
> 时间：2012-08-08T18:58:06.737
> 
> 标签：xml, xslt, xpath-1.0

I am transforming this XML:

```
<root>
  <contrib contrib-type="author">
    <name>
      <last-name>Kottke</last-name>
      <first-name>Leo</first-name>
    </name>
  </contrib>

  <contrib contrib-type="author">
    <name>
      <last-name>McKee</last-name>
      <first-name>Andy</first-name>
    </name>
  </contrib>

  <contrib contrib-type="author">
    <name>
      <last-name>Hedges</last-name>
      <first-name>Michael</first-name>
    </name>
  </contrib>
</root> 
```

...with this XSL:

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output omit-xml-declaration="yes" indent="yes" method="xml"/>
    <xsl:strip-space elements="*"/>

    <!-- identity rule -->
    <xsl:template match="node()|@*">
        <xsl:copy>
            <xsl:apply-templates select="node()|@*"/>
        </xsl:copy>
    </xsl:template>

        <!-- Authors -->
        <xsl:template match="contrib[@contrib-type='author']">
            <Authors>
              <xsl:if test="position() != last()">
                <xsl:value-of select = "concat(name/first-name, ' ', name/last-name, ', ')" />
              </xsl:if>

              <xsl:if test="position() = last()">
                <xsl:value-of select = "concat('and ', name/first-name, ' ', name/last-name, '.')" />
              </xsl:if>
            </Authors>
        </xsl:template>
</xsl:stylesheet> 
```

...and am getting this output:

```
<root>
    <Authors>Leo Kottke, </Authors>
    <Authors>Andy McKee, </Authors>
    <Authors>and Michael Hedges.</Authors>
</root> 
```

* * *

* * *

***However*, I am trying to concatenate all of the  `Author`  tags into one larger  `Author`  tag, so that the output would resemble this**:

```
<root>
    <Authors>Leo Kottke, Andy McKee, and Michael Hedges.</Authors>
</root> 
```

Do I need to use a  `for-each`  loop in some way?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:22:28.330

稍微简单一点的东西

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    version="1.0">
    <xsl:output method="xml" indent="yes"/>

    <xsl:template match="/root">
        <xsl:variable name="authors">
            <xsl:for-each select="contrib/name">
                <xsl:text>, </xsl:text>
                <xsl:value-of select="first-name"/>
                <xsl:text> </xsl:text>
                <xsl:value-of select="last-name"/>
            </xsl:for-each>
        </xsl:variable>

        <root>
            <authors><xsl:value-of select="substring($authors,3)"/></authors>
        </root>
    </xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T19:14:07.377

不需要`xsl:for-each`。`/*`只需为(or `/root`)添加模板并`Authors`从`contrib`匹配中删除：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output omit-xml-declaration="yes" indent="yes" method="xml"/>
    <xsl:strip-space elements="*"/>

    <!-- identity rule -->
    <xsl:template match="node()|@*">
        <xsl:copy>
            <xsl:apply-templates select="node()|@*"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="/root">
        <xsl:copy>
            <xsl:apply-templates select="@*"/>
            <Authors>
                <xsl:apply-templates select="contrib[@contrib-type='author']"/>
            </Authors>
        </xsl:copy>
    </xsl:template>

    <!-- Authors -->
    <xsl:template match="contrib[@contrib-type='author']">
        <xsl:if test="position() != last()">
            <xsl:value-of select = "concat(name/first-name, ' ', name/last-name, ', ')" />
        </xsl:if>

        <xsl:if test="position() = last()">
            <xsl:value-of select = "concat('and ', name/first-name, ' ', name/last-name, '.')" />
        </xsl:if>
    </xsl:template>
</xsl:stylesheet> 
```

# actionscript-3 - Prevent Scaleform TileList from filling last row with disabled ItemListRenderer objects?

> ID：11871298
> 
> 赞同：2
> 
> 时间：2012-08-08T18:58:16.353
> 
> 标签：actionscript-3, tilelist

I'm using Actionscript 3 and Scaleform 4.1 to command an instance of a TileList in a Flash project (CS 5.5).

I have got the TileList populating with ListItemRenderer objects (basically buttons).

In my current situation, I need rows of 4, but I need to place 15 buttons (design requirement). The TileList automatically populates the final row with 3 buttons, and one Disabled state button (instead of a blank space).

So the question:

*   Can you prevent the TileList from placing Disabled buttons (ListItemRenderer) in remainder spaces?
*   Is the TileList required to fill a grid to capacity (with Disabled buttons if necessary)?
*   Can you force a TileList to leave remainder spaces empty?

Alternate solutions also welcome, i.e. can you add another state to the ListItemRenderer such as "blank"? If so, how would you force TileList to default to that instead of Disabled?

If there is good documentation available on this, I don't mind an RTFM reply with a link, but I haven't found anything after a couple days scrounging. Thanks!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T16:56:48.077

当然可以扩展或修改 TileList 以满足您的需要。这就是我们发布 CLIK 源代码的原因。但是为了回答您的问题，默认情况下，Tilelist 设置为使用空白/禁用的渲染器来处理空图块。

您可以在不扩展 tilelist 的情况下处理此问题，而是使用项目渲染器本身（无论如何显示自定义数据更常见）。“禁用”的渲染器都将调用它们的 setdata(null)。因此，在这种情况下，只需覆盖 setdata 即可切换可见性：

```
if ( data != null )
{
    //do stuff with data 
    visible = true; 
}
else
{
    visible = false;
} 
```

# c++ - casting to void* to pass objects to pthread in c++

> ID：11871299
> 
> 赞同：4
> 
> 时间：2012-08-08T18:58:17.607
> 
> 标签：c++, pointers, pthreads, static-cast

I'm a little confused about how to pass an object to the pthread_create function. I've found a lot of piecemeal information concerning casting to void*, passing arguments to pthread_create, etc., but nothing that ties it all together. I just want to make sure I've tied it all together and am not doing anything stupid. Let's say I have the following thread class: **Edit:** fixed mis-matched `static_cast`.

```
class ProducerThread {
    pthread_t thread;
    pthread_attr_t thread_attr;
    ProducerThread(const ProducerThread& x);
    ProducerThread& operator= (const ProducerThread& x);
    virtual void *thread_routine(void *arg) {
        ProtectedBuffer<int> *buffer = static_cast<ProtectedBuffer<int> *> arg;
        int randomdata;

        while(1) {
            randomdata = RandomDataGen();
            buffer->push_back(randomdata);
        }

        pthread_exit();
    }
public:
    ProtectedBuffer<int> buffer;

    ProducerThread() {
        int err_chk;

        pthread_attr_init(&thread_attr);
        pthread_attr_setdetachstate(&thread_attr,PTHREAD_CREATE_DETACHED);

        err_chk = pthread_create(&thread, &thread_attr, thread_routine, static_cast<void *> arg);
        if (err_chk != 0) {
            throw ThreadException(err_chk);
        }
    }
    ~ProducerThread() {
        pthread_cancel(&thread);
        pthread_attr_destroy(&thread_attr);
    }
} 
```

To clarify, the data in the `ProtectedBuffer` class can only be accessed with methods like `ProtectedBuffer::push_back(int arg)`, which use mutexes to protect the actual data.

My main question is: am I using `static_cast` correctly? And my secondary question is do I need that first line in `virtual void *thread_routine(void *arg)` where I copy the passed void pointer to a pointer to `ProtectedBuffer`?

Also, if I've done anything else that might cause problems, I'd appreciate hearing it.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T19:17:33.783

您的代码存在许多问题。对于初学者，我看不到`arg`你在哪里声明，所以我不能说这种情况是否合适。

或许更重要的是，`thread_routine`是一个成员函数，所以它不能被转换成一个指向函数的指针。传递给的函数 `pthread_create`必须是`extern "C"`，所以它不能是成员，句号；它必须是一个自由函数声明`extern "C"`。如果要调用成员函数，请将指向对象的指针作为最后一个参数传递，并在`extern "C"`函数中取消引用它：

```
extern "C" void* startProducerThread( void* arg )
{
    return static_cast<ProducerThread*>( arg )->thread_routine();
} 
```

并启动线程：

```
int status = pthread_create( &thread, &thread_attr, startProducerThread, this ); 
```

只是不要在构造函数中这样做。另一个线程可能在对象完全构造之前开始运行，产生灾难性的影响。

此外，请确保强制`startProducerThread`转换 的类型与传入的指针*完全相同*`pthread_create`。如果您转换为 中的基类`startProducerThread`，那么非常非常确定它是指向您传递给的基类的指针 `pthread_create`；必要时使用显式强制转换（对 in 的类型 `startProducerThread`，*而不是*对`void*`）。

最后，虽然与您的实际问题无关：如果 `ProtectedBuffer`有一个类似的接口`std::vector`，并返回对内部数据的引用，那么您无法使其成为线程安全的。保护需要在类外部。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-08T19:09:15.587

如果你想走这条路，我相信你想要这样的东西：

**编辑：**根据 James Kanze 的回答，添加一个单独的`activate`方法来在构建完成后启动线程。

```
class GenericThread {
protected:
    GenericThread () {
      //...
    }
    virtual ~GenericThread () {}

    int activate () {
        return pthread_create(..., GenericThreadEntry, this);
    }

    virtual void * thread_routine () = 0;

    #if 0
    // This code is wrong, because the C routine callback will do so using the
    // C ABI, but there is no guarantee that the C++ ABI for static class methods
    // is the same as the C ABI.
    static void * thread_entry (void *arg) {
        GenericThread *t = static_cast<GenericThread *>(arg);
        return t->thread_routine();
    }
    #endif
};

extern "C" void * GenericThreadEntry (void *) {
    GenericThread *t = static_cast<GenericThread *>(arg);
    return t->thread_routine();
} 
```

然后，`ProducerThread`将派生自`GenericThread`。

**编辑：** ~~在 C++ 标准中~~~~搜索。`extern "C"`没有显示函数指针必须指向具有 C 链接的函数才能被 C 库例程调用的要求。由于正在传递指针，因此链接要求不适用，因为链接用于解析名称。根据 C++ 2011 草案 (n3242), Sec. ，指向静态方法的指针是函数指针。3.9.2p3：~~

> ~~除了指向静态成员的指针外，引用指针的文本不适用于指向成员的指针。~~

**编辑：** *过失。*C 库将调用假定 C 应用程序二进制接口的回调函数。具有 C++ 链接的函数可能使用与 C ABI 不同的 ABI。`extern "C"`这就是为什么在将回调函数传递给 C 库时需要使用具有链接的函数的原因。我对 James Kanze 对他的怀疑表示诚挚的歉意，并衷心感谢 Loki Astari 让我直言不讳。

# php - PHP: Possible to trickle-output to browser while waiting for database query to execute?

> ID：11871301
> 
> 赞同：0
> 
> 时间：2012-08-08T18:58:29.677
> 
> 标签：php, multithreading

**tl;dr:** Is it possible to feed some "dummy spaces" periodically back to the browser while waiting for a SQL query to execute? This to not have the browser hang up on me while nothing returns.

*Longer story:*

I've made a small "web tool" against a database (MS SQL, using their PDO driver).

Sometimes, the queries that I run take a long time.

After about 100 seconds, the browser just stops "rotating". I don't know yet what causes this, but it is the same with Firefox and Chrome. The stack is PHP 5.3, IIS 6, FastCGI. It is not PHP nor DB/SQLSRV timeout, as I've increased both of those - and other queries I have take a longer time to feed back all the result. (I can reproduce the problem by writing some header, chilling for 110 seconds, and then write the footer. Only the header-part is then shown.)

The problem with the present query, is that it doesn't feed back anything for about 200 seconds, then the whole thing comes. But this doesn't help when something along that stack have stopped listening/receiving/transmitting after about 100 seconds.

**Thus, the question**: Is it possible to trickle-feed the browser some dummy spaces *while* the script is waiting for the SQL to return? In my native tounge of Java, this would be trivial, but in PHP, one is AFAIK utterly single threaded (actually, "single process'd"). I know that this trickling would work, as I have other scripts that in total takes much longer, but which continually sends small pieces of the result back to the browser - this renders just fine.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:09:24.307

如果您只打算运行一个查询，则不会。但是，根据查询的性质，您可能只需将其拆分为多个较小的查询，然后循环遍历这些查询。

与您的其他答案和评论相反，如果您拆分呼叫，您可以将数据“滴灌”到浏览器。您正在寻找`flush()`功能。

**演示**

```
<?php

for ($i = 0; $i <= 200; $i++)
{
    sleep(1);
    echo ' ';

    flush();
}

echo 'It worked!';
?> 
```

尝试运行这个。它应该需要 200 秒。但是，因为`flush()`存在，它会在每次循环迭代后向浏览器发送数据，并且希望不会超时！我老板的虚拟主机在 30 秒不活动后超时（Rackspace，grrrr！）所以我不得不无数次使用这个相同的技巧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T19:01:19.970

当您回显它时，PHP 不会将输出发送到浏览器。它将内容写入缓冲区，并立即将全部内容发送到浏览器。所以，不，你不能将输出涓涓细流到浏览器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-07T11:32:39.797

flush 不能很好地工作有一个更好的方法-您可以将输出通过管道传输到文件，然后使用独立的 php 脚本仅翻录最后一行，然后在客户端上使用 ajax 每 200 毫秒轮询一次该独立脚本最后一行。这给出了你想要的效果

EDIT1：哈哈恩德是你！<3 来自英格兰，你最讨厌你 x

EDIT2：超时来自 PHP.ini 内外的大量微妙参数，大部分没有记录，因为它们似乎无关，但也*不要*低估浏览器的跛脚 - 根据我的经验，我只能辐射完全超时一次，然后才在 Firefox 上，但我*能够*以这种方式运行/轮询一个 3 小时长的脚本（遗憾的是，这是一个 AD 迁移脚本，在我的旧工作中，我没有代码）

EDIT3：您可以通过使用 PHP CLI 然后进程 ID 或使用 curl 在 PHP 中“线程化”两者都相当 ewww 但你可以做到

# ruby-on-rails - Parse a long string in ruby

> ID：11871307
> 
> 赞同：0
> 
> 时间：2012-08-08T18:59:06.193
> 
> 标签：ruby-on-rails, regex, json, parsing

In my project I need to aggregate many data in one string and later parse it out. The data is related to people, it need to record people_ids in different state and age group, and their counts. For example, we have 5 people named John Smith in CA, 2 people between 20-29, 2 between 30-39, 1 between 40-49; 2 people named John Smith in NY, 1 between 20-29 and 1 between 30-39\. Then the string will be somewhat like this,

```
John smith| [CA#5: 20-29#2{pid_1, pid_2};30-39#2{pid_3,pid_4};40-49#1{pid_5}] [NY#2: 20-29#1{pid_6};30-39#1{pid_7}] 
```

It not necessarily be the same format, but whatever format easy to parse out. Is there any good way to do this? How about Json format? And if it looks like the above format, if I want all John Smith in CA between age 30-39, how should I parse out the data? Thanks a lot!!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:13:20.077

根据我对您帖子的理解，这可能是您正在寻找的格式（以 JSON 表示）。

请记住，有些 gem 可以为您生成和解析 JSON。

```
{
    "name": "John Smith",
    "states": {
        "CA": {
            "total": 5,
            "ages": {
                "20-29": [pid_1, pid_2],
                "30-39": [pid_3, pid_4],
                "40-49": [pid_5]
            }
        },
        "NY": {
            "total": 2,
            "ages": {
                "20-29": [pid_6],
                "30-39": [pid_7]
            }
        }
    }
} 
```

# asp.net-mvc - ASP.Net MVC 中嵌套模型的客户端验证

> ID：11871317
> 
> 赞同：0
> 
> 时间：2012-08-08T18:59:56.863
> 
> 标签：asp.net-mvc

我正在尝试创建填充以下情况的 MVC 模型验证属性：我创建了多个模型（生日和电话号码是优秀的示例），这些模型通过视图上的多个输入字段（月、日、年；区号，交换，后缀）。

```
 public class PhoneNumber
  {
    [RegularExpression("^([2-9][0-8][0-9])$", ErrorMessage = "Invalid Area Code")]
    public virtual string AreaCode { get; set; }

    [RegularExpression("^([2-9][0-9][0-9])$", ErrorMessage = "Invalid Phone Exchange")]
    public virtual string Exchange { get; set; }

    [RegularExpression("^([0-9][0-9][0-9][0-9])$", ErrorMessage = "Invalid Phone Suffix")]
    public virtual string Suffix { get; set; }
  } 
```

我经常将这些模型嵌套在其他模型中（例如，Person 有一个 PhoneNumber 和一个生日）。在我看来，有时需要电话号码，有时则不需要。我可以通过将类实现为 IValidatableObject 在服务器端处理这些情况，但是如果我想进行客户端验证，甚至只是通过属性进行服务器端验证，我就会遇到麻烦。

我想我将不得不构建自己的自定义验证属性，但我什至不确定从哪里开始访问多个级别的对象和属性信息。有没有人遇到过这样的事情？有什么好主意可以为我指明正确的方向吗？

提前致谢！

- - - - 更新 - - -

通过使用 IClientValidatable 和 GetClientValidationRules，我可以访问 ModelMetadata 可以获取容器的类型。问题是容器是生日或电话号码，而不是顶级模型的类型，这是最重要的。ModelMetadata 尚未填充 Model 属性，因为它可能还不存在。我真正想做的是获得顶级模型的类型。任何人有任何见解？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:10:45.150

根据您编写视图的方式，我认为您可能需要查看名为 BeginCollectionItem [http://nuget.org/packages/BeginCollectionItem的扩展](http://nuget.org/packages/BeginCollectionItem)

如果你正在做，验证会有点混乱

```
@Html.TextBoxFor( m => number.AreaCode ) 
```

代替

```
@Html.TextBoxFor( m => m.AreaCode ) 
```

# javascript - 正则表达式：从字符串中提取部分。用 JS

> ID：11871320
> 
> 赞同：-2
> 
> 时间：2012-08-08T19:00:05.367
> 
> 标签：javascript, regex

嘿，我对正则表达式并不是很好，我希望有人能提供帮助。

好的，这就是“找到钥匙！[57:09:91:40:32:11:00:77:16:80:34:40:91]”

我需要拉“57:09:91:40:32:11:00:77:16:80:34:40:91”，现在这个密钥的长度可能很短，而不仅仅是这里写的，有或没有这 ”：”

现在我想测试和提取的第二个刺是：“[00:00:09] 测试了 853 个密钥（得到 179387 个 IV）”，我想提取“00:00:09”和“853”和“179387” ”。

这将是原始字符串 [http://regexr.com?31pcu](http://regexr.com?31pcu)或[http://pastebin.com/eRbnwqn7](http://pastebin.com/eRbnwqn7)

这就是我现在正在做的事情。

```
var pass = new RegExp('KEY FOUND\!')
var tested = new RegExp('Tested')
var fail = new RegExp('\Failed. Next try with ([0-9]+) IVs')
var data="Look at the link i added"
if (tested.test(data)) {
self.emit('update', mac, {
    'keys' : data.split('Tested ')[1].split(' keys ')[0],
    'ivs' : data.split('got ')[1].split(' IVs')[0]
});
} else if (pass.test(data)) {
var key = data.split('KEY FOUND! [')[1].split(' ]')[0].split(':').join('');

} else if (fail.test(data)) {
console.log(data);
} 
```

谢谢大家

编辑：我添加了更多问题以帮助回答

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:03:39.393

如果它总是被包围，`[]`那么它很简单：

`\[([\s\S]*)\]`

这将匹配由 . 括起来的任何字符`[]`。

[在这里](http://regexr.com?31pcl)查看它的实际应用。

# .net - Windows 7 中的 aspnet_setreg 位于何处？

> ID：11871322
> 
> 赞同：2
> 
> 时间：2012-08-08T19:00:16.510
> 
> 标签：.net, windows-7

有谁知道在 Windows 7 机器上哪里可以找到 aspnet_setreg？我检查了这些文件夹，但在那里找不到

C:\Windows\Microsoft.NET\Framework64\v2.0.50727

C:\Windows\Microsoft.NET\Framework64\v3.5

C:\Windows\Microsoft.NET\Framework64\v4.0.30319

# python - 使用 Python raw_input 从 CSV 文件中获取特定值？

> ID：11871323
> 
> 赞同：1
> 
> 时间：2012-08-08T19:00:20.173
> 
> 标签：python, csv

目前，我有一个这样的 CSV 文件：

```
Element,Weight
"Hydrogen","1"
"Oxygen","16" 
```

最终它将拥有所有元素及其旁边的原子量，但是除非我先解决这个问题，否则将所有这些都放入是毫无意义的。

主要的Python程序如下：

```
import csv
reader = csv.reader(open("chem.csv", "rb"))

first = raw_input("Enter first element: ")
second = raw_input("Enter second element: ")

if first == "Hydrogen" or "hydrogen":
     for Weight in reader:
        print Weight

else:
     print "No." 
```

现在，正如您可能从中看出的那样，我的目标是让程序暂时显示从 CSV 文件中获取的氢的重量。但是，目前它最终只显示以下内容：

```
Enter first element: hydrogen
Enter second element: oxygen
['Element', 'Weight']
['Hydrogen', '1']
['Oxygen', '16'] 
```

所以，基本上，我怎样才能让它进入氢行，然后从第二列获取重量值？我应该能够从那里着手完成程序的其余部分，但这部分让我陷入了困境。

作为第二件事，是否有可能拥有它，这样我就不必在主要 Python 程序和 CSV 文件中拥有本质上是元素列表的内容？它会减少很多混乱，但我就是想不通。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T19:13:30.323

与其对数据进行迭代，不如以一种易于访问的方式存储它可能会更好，例如将名称映射到权重的字典。然后您可以查找输入的字符串并显示结果（如果没有，则不显示）。

```
import csv

#Read in data anbd store it in dictionary.
#The element name will be stored in lowercase.
elemen_data = { element.lower():int(weight) for element,weight in csv.reader(open("in", "rb"))}

first = raw_input("Enter first element: ")
second = raw_input("Enter second element: ")

#Look for the weight of the entered element (after converting it to all lowercase)
weight_first = elemen_data.get(first.lower())
weight_second = elemen_data.get(second.lower())

if weight_first is not None:
    print 'First Element:', first, 'Weight:', weight_first
else:
    print 'First Element', first, 'not found'

if weight_second is not None:
    print 'Second Element:', second, 'Weight:', weight_first
else:
    print 'Second Element', second, 'not found' 
```

如果您希望能够在不接触程序的情况下轻松更改数据，那么将数据与程序逻辑分开存储是有意义的。所以有一个读入的 csv 文件是绝对可以的。（只要数据大小合理）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T19:07:54.320

问题是，当您遍历 csv.reader 对象时，您会收到 csv 文件行作为行单元格值的列表。因此，您可以尝试下一个案例：

```
if first in ("Hydrogen", "hydrogen"):
     for Weight in reader:
        if Weight[0] == first:
            print Weight[1] 
```

这不是最好的代码，但它返回了你想要的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T19:14:38.683

第一个问题：

```
if first == "Hydrogen" or "hydrogen": 
```

那不会返回你想要的。你要么想要：

```
if first == 'Hydrogen' or first == 'hydrogen': 
```

或者

```
if first in ['Hydrogen', 'hydrogen']: 
```

或者更好：

```
if first.lower() == 'hydrogen' 
```

这适用于所有大写字母，例如 HYDrogen。

然后，你可以做你想做的事：

```
for row in reader:
    if row[0].lower() == first.lower():
        print row[1] 
```

当然，这可以通过使用值字典来稍微清理一下；您可能不希望`if`对每个元素都有一个声明，但是您就可以了。

# sql - SQL Server 触发器：无法绑定多部分标识符

> ID：11871324
> 
> 赞同：2
> 
> 时间：2012-08-08T19:00:23.887
> 
> 标签：sql, sql-server, triggers, identifier

我正在尝试创建一个相当简单的触发器，该触发器将在列中添加一个触发器，以跟踪类似于 Netflix 的电影发行公司的租赁数量。

我关注的专栏是：

*   **电影**( `movie_id, movie_title, release_year, num_rentals`)
*   **客户租金**( `item_rental_id, movie_id, rental_date_out, rental_date_returned`)

我当前的触发器如下所示：

```
CREATE TRIGGER tr_num_rented_insert
ON customer_rentals FOR INSERT
AS
BEGIN 
UPDATE movies
SET num_rentals=num_rentals+1
WHERE customer_rentals.movie_id=movies.movie_id;
END; 
```

它返回错误：

> 消息 4104，级别 16，状态 1，过程 tr_num_rented_insert，第 7 行
> 无法绑定多部分标识符“customer_rentals.movi​​e_id”。

我只希望它与movie_id 匹配并将租赁数量加1。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-08T19:02:44.953

您需要加入`inserted`伪表：

```
CREATE TRIGGER dbo.tr_num_rented_insert
ON dbo.customer_rentals 
FOR INSERT
AS
BEGIN 
  UPDATE m
    SET num_rentals = num_rentals + 1
  FROM dbo.movies AS m
  INNER JOIN inserted AS i
  ON m.movie_id = i.movie_id;
END
GO 
```

但我不得不问，在电影表中保持这个计数最新有什么意义？您始终可以在查询中获取计数，而不是冗余地存储它：

```
SELECT m.movie_id, COALESCE(COUNT(r.movie_id))
  FROM dbo.moves AS m
  LEFT OUTER JOIN dbo.customer_rentals AS r
  ON m.movie_id = r.movie_id
  GROUP BY m.movie_id; 
```

如果该查询的性能成为问题，您可以创建一个索引视图来维护计数，这样您就不必使用触发器使其保持最新：

```
CREATE VIEW dbo.rental_counts
WITH SCHEMABINDING
AS
  SELECT movie_id, num_rentals = COUNT_BIG(*)
  FROM dbo.customer_rentals
  GROUP BY movie_id; 
```

这会导致与您的触发器相同*类型*的维护，但在没有您的触发器的情况下执行此操作，并且不会影响`movies`表。现在要获得租金计数，您可以说：

```
SELECT m.movie_id, m.other_columns, 
    num_rentals = COALESCE(r.num_rentals, 0)
  FROM dbo.movies AS m
  LEFT OUTER JOIN dbo.rental_counts AS r
  ON m.movie_id = r.movie_id; 
```

（我们在这里使用 LEFT JOIN，因为电影可能还没有被租用。）

这里的另一个好处是您不必执行任何技巧即可将电影表中的其他列获取到结果中。即使删除了租赁，它也可以确保数据准确（您的触发器将继续愉快地为计数添加 +1）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-07-28T01:47:03.263

您的代码对于简单的插入触发器是正确的。假设这些列确实存在于两个表中，您的问题可能是您在 WHERE 语句的末尾放置了一个分号。分号只能在 END 语句之后。

# django - Django 忽略了我的 TestCase 固定装置

> ID：11871327
> 
> 赞同：2
> 
> 时间：2012-08-08T19:00:34.477
> 
> 标签：django, django-fixtures

我有 Django 1.4。在我的 test.py 中，我有必要的 TestCase 导入：

```
from django.test import TestCase 
```

为了隔离问题，我添加了以下行：

```
fixtures = ['westeros'] 
```

到默认示例测试用例，即

```
class SimpleTest(TestCase):
    fixtures = ['westeros']

    def test_basic_addition(self):
        """
        Tests that 1 + 1 always equals 2.
        """
        self.assertEqual(1 + 1, 2) 
```

使用 django-admin.py 转储数据，我在 customers/fixtures 目录中创建了一个名为“westeros”的夹具文件，其中“customers”是 settings.INSTALLED_APPS 中列出的应用程序。

当我运行测试时，无论多么冗长，Django 都会简单地忽略夹具并通过`test_basic_addition`测试。没有错误，没有夹具加载。就好像 TestCase 导入不存在一样。关于可能出错或如何调试的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T22:35:57.673

定义时可以省略扩展名`fixtures`，即

```
fixtures = ['westeros'] 
```

但是，fixture 文件本身必须具有与其序列化程序相对应的扩展名，例如`westeros.json`，`westeros.json.zip`或者`westeros.xml`分别对应于 json、zipped json 或 xml。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T20:50:47.840

你的`westeros`文件在哪里？

它需要`fixtures`位于应用程序内的目录中或文件中指定的目录`FIXTURE_DIRS`中`settings.py`

您可以运行测试`verbosity=2`以获得完整输出。 [https://docs.djangoproject.com/en/1.0/ref/django-admin/#test](https://docs.djangoproject.com/en/1.0/ref/django-admin/#test)

您的固定装置文件是否命名`westeros`？还是有文件扩展名？

如您所见，Django 将在夹具加载时静默失败。（至少在 1.3 之前，我还没有在新的 1.4 版本中使用过灯具）。但是您实际上并没有测试固定装置是否正在加载。输入 a `self.assertGreater(YourModel.objects.all(), 0)`or somethign 以验证没有对象，或放入调试器并开始查询您的一些模型。

# osx-mountain-lion - Mac Mountain Lion 错误 - “不在 fPermittedFrontASNs 中”

> ID：11871328
> 
> 赞同：5
> 
> 时间：2012-08-08T19:00:36.693
> 
> 标签：osx-mountain-lion, launchd, py2app

我有一个已使用 py2app 转换为捆绑应用程序的 python 脚本。手动调用时，它运行良好。但是，在 Mountain Lion 下，当我尝试使用 launchd 调用它时，系统日志中出现以下错误：

> 8 月 8 日 07:15:02 StraylightPro.local 灌溉 [79689]：灌溉错误
> 8 月 8 日 07:15:02 StraylightPro.local coreservicesd[77]：应用程序：“灌溉”[0x0/0x697596f] @ 0x0x7fe77240cec0 试图提前，但不在 fPermittedFrontASNs ( ( ASN:0x0-0x1cb2cb1:) ) 中，所以拒绝。

似乎很明显，这是 Mountain Lion 中新安全功能的结果，但通过 Apple 的开发人员文档和在网上搜索“fPermittedFrontASNs”一词并没有找到任何结果。

如果我可以向应用程序包添加扩展属性或在启动的 plist 文件中添加一行来解决这个问题，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T10:58:55.903

如果您确定这是 Gatekeeper 提出的安全限制，您可以停用 Gatekeeper 以进行测试：

> spctl --master-disable

如果有效，您可以使用 spctl 命令添加适当的规则。查看“man spctl”以获取说明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-23T10:01:41.673

申请是否已签署？

根据[https://apple.stackexchange.com/questions/62707/how-to-get-installers-not-to-hang-on-waiting-for-other-installations-to-complet](https://apple.stackexchange.com/questions/62707/how-to-get-installers-not-to-hang-on-waiting-for-other-installations-to-complet)，它指的是[一个页面Apple 的支持站点](http://support.apple.com/kb/HT5290?viewlocale=en_US&locale=en_US)，使用 Developer ID 签名的应用程序在更改应用程序包时不会启动。

使用当前版本的 py2app 创建的应用程序在首次启动后可能会发生变化，因为某些文件在创建应用程序包时未进行字节编译，并且将在首次启动时进行编译。这是我将在以后的更新中修复的错误。

# c# - 从数组中解析正则表达式

> ID：11871334
> 
> 赞同：0
> 
> 时间：2012-08-08T19:00:54.613
> 
> 标签：c#, regex, arrays

我正在尝试从 Outlook 电子邮件标头中解析出 IP 地址。我已经开始用 C# 编写一些东西（因为那是我正在利用的示例）并且想出了一些接近的东西。

我可以使用字符串 lines[] = Regex.Split(headers, @"\r\n"); 拆分标题 命令没问题，但是当我尝试遍历 lines[] 数组时，我的 IP 地址正则表达式失败并且不会将值存储在第二个数组中：

代码：

```
private void button1_Click(object sender, EventArgs e)
    {
        // use a string constant to define the mapi property
        string PidTagTransportMessageHeaders = @"http://schemas.microsoft.com/mapi/proptag/0x007D001E";
        string mypattern = @"(#{1,3}\.)(#{1,3}\.)([0-9]{1,3}\.)([0-9]{1,3})";
        // string[] ip = Regex.Split(lines[i], (@"(\(|\[)(#{1,3}\.)(#{1,3}\.)([0-9]{1,3}\.)([0-9]{1,3})(\)|\])"));

        // get a handle on the current message
        Outlook.MailItem message = (Outlook.MailItem)this.OutlookItem;

        // use the property accessor to retreive the header
        string headers = string.Empty;

        try
        {
            headers = (string)message.PropertyAccessor.GetProperty(PidTagTransportMessageHeaders);
        }
        catch { 
        }

        //  if getting the internet headers is successful, put into textbox
        string[] lines = Regex.Split(headers, "\r\n");

        Regex regexObj = new Regex(mypattern);

        for (int i = 0; i < lines.Length; i++)
        {
            MatchCollection matches = regexObj.Matches(lines[i]);                       

        }            
        //eventually write the found IP array into textBox1.Text
       textBox1.Text = headers;
        }
    }
} 
```

有什么帮助或建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:06:05.327

将您的 's 更改`#`为`\d`'s：

```
string mypattern = @"(\d{1,3}\.)(\d{1,3}\.)(\d{1,3}\.)(\d{1,3})"; 
```

请注意，更准确的 IPv4 地址捕获正则表达式类似于：

```
\b(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\b 
```

...或者至少添加单词边界...

`\b(\d{1,3}\.)(\d{1,3}\.)(\d{1,3}\.)(\d{1,3})\b`

对于一个简单的 IPv6（标准），我喜欢：

```
(?<![:.\w])(?:[A-F0-9]{1,4}:){7}[A-F0-9]{1,4}(?![:.\w]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T19:16:51.743

[IPAddress.Parse 方法](http://msdn.microsoft.com/en-us/library/system.net.ipaddress.parse.aspx)不要重新发明轮子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T19:41:06.013

如果你想匹配 IPv4，那么试试这个野兽，应该非常接近实际的 IPv4，封闭的**\b**表示单词的开头和结尾，所以你应该能够删除这些并调整为根据您的标头格式获取IP的您的心脏内容

```
\b(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b 
```

# boost-spirit - 如何使用 qi::symbols 解析器来匹配来自使用 no_case 的精神词法分析器的标记？

> ID：11871337
> 
> 赞同：4
> 
> 时间：2012-08-08T19:01:04.023
> 
> 标签：boost-spirit, boost-spirit-qi, boost-spirit-lex

我有一个基于它的词法分析器，`spirit::lexertl`它产生用`lex::token_def<std::string>`. 我想使用一个`qi::symbols<>`表来匹配该表中的标记，使用符号表中的关联数据作为规则中的属性。像这样的东西[从实际代码中浓缩]：

```
qi::symbols<char, int> mode_table;
mode_table.add("normal", 0)("lighten", 1)("darken", 2);

rule<Iterator, int()> mode = raw_token(tok.kMode) >> ':' >> ascii::no_case[mode_table]; 
```

但是，当我编译它时，我收到以下错误：

/Users/tim/Documents/src/tr_libs/boost/boost_1_49_0/boost/spirit/home/qi/string/detail/tst.hpp:80：错误：从**“char”**转换为非标量类型**'boost::spirit::lex::lexertl::token<boost::spirit::line_pos_iterator<boost::spirit::multi_pass<std::istreambuf_iterator<char, std::char_traits<char>>, boost:: Spirit::iterator_policies::default_policy<boost::spirit::iterator_policies::ref_counted, boost::spirit::iterator_policies::buf_id_check, boost::spirit::iterator_policies::buffering_input_iterator, boost::spirit::iterator_policies:: split_std_deque> > >, boost::mpl::vector<std::basic_string<char, std::char_traits<char>, std::allocator<char> >, boost::spirit::basic_string<std::basic_string<字符、std::char_traits<char>、std::allocator<char> >、symbol_type>、double、mpl_::na、mpl_::na、mpl_::na、mpl_::na、mpl_::na、mpl_ ::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na, mpl_::na,mpl_::na, mpl_::na>, mpl_::bool_<true>, long unsigned int>'**请求

tst.hpp 中的第 80 行是这样的：

```
 c = filter(*i); 
```

在我看来，它确实正在尝试将我的词法分析器标记转换为 a `char`，我理解它是`symbols<char, int>`表中的字符类型。一时兴起，我确实尝试了`symbols<ident, int>`——`ident`我的令牌类型在哪里——但这显然不是记录在案的`symbols<>`API，而且可以预见的是它不起作用。

（你可能会问为什么我不让词法分析器将这些标识符作为令牌 ID 发出，就像`kMode`上面的示例一样。在这种特殊情况下我可能会这样做，但我真的很好奇集成符号的*一般*情况带有词法分析器的语法中的表。）

从根本上说，我认为我的问题是：是否可以以`qi::symbols<>`这种方式使用来匹配来自 Spirit 词法分析器的标记？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-04-11T20:40:25.843

不可能`symbols`像您一样直接使用实例......但是通过使用 Phoenix 语义动作可以完成，但会增加冗长。如果您有一个`token_def<std::string>`表示您希望在符号表中查找的值，则可以将其集成到如下规则中：

```
qi::rule<Iterator, locals<int const*>, int()> modename;
using namespace boost::phoenix;
// disambiguate symbols::find method (there are two!)
typedef const symtab_t::value_type * (symtab_t::*findfn_t)(std::string const&) const;
modename = tok.modeName[_a = bind(static_cast<findfn_t>(&symtab_t::find),
                                  cref(mode_table), _1),
                        _pass = _a,
                        if_(_a)[_val = *_a]]; 
```

它在符号表中手动查找令牌的字符串值，如果不存在则失败，否则将找到的整数值复制到规则的结果属性。

处理不区分大小写也可以通过语义操作来完成，要么在解析器中（通过在执行查找之前转换为小写），要么通过在词法分析器中创建标记时进行转换。后一种方法可以这样处理：

```
this->self +=
     modeName[ 
        let(_a = construct<std::string>(_start, _end)) [
            bind(&to_lower<std::string>, ref(_a),
                 // must supply even defaulted arguments
                 construct<std::locale>()),
            _val = _a
            ]
         ]; 
```

这将创建基础范围的副本并调用`to_lower`它，将结果作为令牌值提供。

一个完整的例子可以在[这里找到](https://gist.github.com/jefftrull/928eac7d47e61f5d9634)

# objective-c - 将自定义视图拖到界面生成器中的窗口上？

> ID：11871340
> 
> 赞同：6
> 
> 时间：2012-08-08T19:01:08.740
> 
> 标签：objective-c, xcode, user-interface, interface-builder

我来自 C# 和 Winforms 的世界，在那里我可以构建自定义 UserControl 并将其拖到窗体上，就好像它是一个通用控件一样。有没有办法在 Xcode 和 Interface Builder 中做到这一点？

我只看到了如何在运行时设置视图，但我想在设计时在我的窗口上看到它。例如，我希望我的自定义视图列在可用控件中。

谢谢！

西蒙

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-08T19:46:26.330

**Interface Builder**不会向对象库添加（或允许添加，因为 IB 插件已被废弃）自定义对象。您只能拖入现有/预设对象，但您**可以**让 IB 将它们实例化为子类的实例，只要它们以相同的方式实例化即可。

例如**，在自定义视图中拖动并将类设置为** `MyCustomViewClass`，**或在滚动视图中拖动并将类设置为** `MyCustomScrollView`，**或者在对象中拖动并将类设置为** `CustomObject`，等等。

这是在 Interface Builder 中使用自定义控件的首选方式。

![在此处输入图像描述](../Images/c9a9146fa4e86e8c513d9678bb46e080.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T19:47:06.160

基本上只是扯掉rdelmar的评论......但我认为一张图片会有所帮助![在此处输入图像描述](../Images/d5fdaca8b2c5c9d536e900dfaeb4e454.png)

将普通视图拖入 IB，然后选择它并执行此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T20:02:33.943

您在 IB 中创建的每个窗口都有一个视图作为其第一个子组件。您不需要为其创建单独的自定义视图。如果你真的是子类化它只需在检查器中更改类名。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-15T14:01:25.680

除了这个线程中提到的关于将自定义视图的名称添加到视图控制器的`XIB`文件中的内容之外，您还需要在自定义视图中进行*覆盖* `initWithCoder`。

# android - 使用另一个包含 Cursor 的类中的方法

> ID：11871344
> 
> 赞同：0
> 
> 时间：2012-08-08T19:01:16.530
> 
> 标签：android, cursor

正在为我的 android 应用程序开发一个类，它将随机生成 NPC 及其统计信息。由于这些方法将在不同的活动中调用，因此最好将它们放在自己的类中。但是在使它们包含的游标正常工作时遇到了一些麻烦。

```
import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.KeyEvent;
import android.view.View;

    public class startscreen extends Activity {
        private dbhelper mydbhelper;
        Intent intent;

        /** Called when the activity is first created. */
            @Override
            public void onCreate(Bundle savedInstanceState) {
                super.onCreate(savedInstanceState);
                setContentView(R.layout.startscreen);
                mydbhelper = dbhelper.getInstance(startscreen.this);
                }

            public void onClickNew(View v){
             intent = new Intent(getBaseContext(), newgame.class);
             startActivity(intent);
             }

            public void onClickLoad(View v){
             //intent = new Intent(getBaseContext(), mainmenu.class);
             //startActivity(intent);
                Generator obj = new Generator();
                obj.randomName();
             } 
```

我将这个底部按钮上的方法调用到我的主菜单，以便于测试。

```
import java.util.Random;

import android.database.Cursor;
import android.util.Log;

public class Generator {
    public dbhelper mydbhelper;

    public String randomName(){
        Cursor name;
        Random nameRandom = new Random();
        int first = nameRandom.nextInt(171)+1;
        name = mydbhelper.getRandomName(first); //This is where I get the error. "NullPointerException"
        String firstName = name.getString(name.getColumnIndex(dbhelper.KEY_FIRST));
        int last = nameRandom.nextInt(245)+1;
        name =  mydbhelper.getRandomName(last);
        String lastName = name.getString(name.getColumnIndex(dbhelper.KEY_LAST));
        String fullName = firstName + " " + lastName;
        Log.e(fullName, "was the generated name");

        return fullName;

    }

} 
```

如果我取出游标并放入一个统计字符串以返回它工作正常。所以我错误地处理了这个游标。可悲的是，单例和使用其他类的方法是我的缺点，所以希望这里的人能够解释我做错了什么。

```
 public Cursor getRandomName(int number){
      return myDataBase.query(NAME_TABLE, new String[]{KEY_ID, KEY_FIRST, KEY_LAST},
              KEY_ID + " = " + number , null, null, null, KEY_ID);
    } 
```

这是我正在使用的光标，位于我的 dbhelper 类中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:14:06.117

`mydbhelper`在您的班级中与您`Activity`班级中的参考不同。在使用它之前，您需要调用您的类或传递参考。`mydbhelper``Generator``mydbhelper = dbhelper.getInstance()``Generator`

一个快速的方法是：

```
public String randomName(dbhelper mydbhelp) {
  // code 
  name = mydbhelper.getRandomName(first);
  // code
  name.close
} 
```

完成后请记住关闭光标和数据库。首先关闭光标。

# android - ListView 上的按钮

> ID：11871346
> 
> 赞同：0
> 
> 时间：2012-08-08T19:01:22.457
> 
> 标签：android, listview, button

怎么可能把 a`Button`放在 a 上`ListView`？喜欢这张[图片](http://www.freeimagehosting.net/g43mp)吗？

我试过了：

```
 <FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="bottom|right"
        android:text="Button" />

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Large Text"
        android:textAppearance="?android:attr/textAppearanceLarge" />
    <ListView 
        android:id="@+id/listView1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content">

    </ListView>
    </LinearLayout>

</FrameLayout> 
```

但是 the`Button`是不可访问的…… the`ListView`和 the都`Button`必须是可访问的。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-08T19:15:54.907

首先，您应该使用`RelativeLayout`; [`FrameLayout`](http://developer.android.com/reference/android/widget/FrameLayout.html)用于以最佳方式保存单个子元素。

其次，布局是按照从上到下->从后到前的顺序绘制的。因此，您希望您`Button`在 XML 文件中的下方。

最后，`gravity`您应该使用`align`.

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical" >

        <TextView
            android:id="@+id/textView1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Large Text"
            android:textAppearance="?android:attr/textAppearanceLarge" />
        <ListView 
            android:id="@+id/listView1"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content">

        </ListView>
    </LinearLayout>

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignParentBottom="true"
        android:text="Button" />

</RelativeLayout> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T19:16:30.447

这里的示例代码介绍了如何将相对布局与 listview 一起使用，它的显示方式与您的图像一样。

```
<RelativeLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Large Text"
        android:textAppearance="?android:attr/textAppearanceLarge" />

    <ListView
        android:id="@+id/listView1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/textView1" >
    </ListView>

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBottom="@+id/listView1"
        android:layout_alignParentRight="true"
        android:text="Button" />

</RelativeLayout> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T19:14:43.120

使用相对布局，然后您可以通过`gravity`使用此示例添加`layout_align`不同的值来设置按钮位置，将为您解决问题。......

```
<RelativeLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent" >
<Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="bottom|right"
    android:text="Button" />

<ListView 
    android:id="@+id/listView1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" />
</RelativeLayout>
...... 
```

下面是您可以在按钮代码中使用的边距属性。

```
layout_alignParentBottom
layout_alignParentLeft 
layout_alignParentRight
layout_alignParentTop
layout_alignRight 
android:layout_alignTop 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T19:09:18.000

添加`android:focusable="false"`到您的按钮属性，看看是否有帮助。

```
<Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="bottom|right"
    android:focusable="false"
    android:focusableInTouchMode="false"
    android:text="Button" /> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-08T19:11:23.463

使用 RelativeLayout 并使用 android:layout_below="@+id/yourIdHere" 或 android:layout_above="@+id/yourIdHere"

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-02-18T05:59:48.137

只需复制粘贴即可。经测试的解决方案。

```
 <?xml version="1.0" encoding="utf-8"?>
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
  android:orientation="horizontal"
  android:layout_width="match_parent"
  android:layout_height="wrap_content"
  android:layout_weight="3">

<LinearLayout
    android:id="@+id/linearLayout"
    android:orientation="horizontal"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    android:layout_alignParentLeft="true"
    android:layout_alignParentStart="true"
 >

    <Button
        android:text="Status"
        android:textSize="20sp"
        android:textStyle="bold"
        style="?android:attr/buttonBarButtonStyle"
        android:gravity="center"
        android:layout_width="0dp"
        android:layout_weight="1"
        android:textColor="@color/black"
        android:layout_height="wrap_content"
        android:id="@+id/textView10" />

    <Button
        android:text="Date"
        android:textSize="20sp"
        android:textStyle="bold"
        style="?android:attr/buttonBarButtonStyle"
        android:layout_width="0dp"
        android:layout_weight="1"
        android:textColor="@color/black"
        android:layout_height="wrap_content"
        android:id="@+id/textView6"
        />

    <Button
        android:text="Subject"
        android:textSize="20sp"
        android:textStyle="bold"
        android:gravity="center"
        style="?android:attr/buttonBarButtonStyle"
        android:textColor="@color/black"
        android:layout_width="0dp"
        android:layout_weight="1"
        android:layout_height="wrap_content"
        android:id="@+id/textView9"

        />

</LinearLayout>

<ListView
    android:id="@+id/list"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_alignParentLeft="true"
    android:layout_alignParentStart="true"
    android:layout_below="@+id/linearLayout"
/>

  </RelativeLayout> 
```

# c - 关于程序堆栈执行的链表程序流程

> ID：11871351
> 
> 赞同：0
> 
> 时间：2012-08-08T19:01:45.073
> 
> 标签：c, algorithm, pointers, linked-list, stack-trace

```
static void just_traverse(sll **head_ref) {
    sll *first = *head_ref;
    sll *second = (*head_ref)->next;

    if(second == NULL) {
            return;
    }

    just_traverse(&(second));
    *head_ref = second;
    printf("%d \t",second->payload);
} 
```

在上面的代码中，如果我删除 *head_ref = second; 我得到关于堆栈的输出但是如果我把这条线 *head_ref = second; 它总是打印最后一个元素说 {4,3,2,1} 然后它总是打印 1？谁能解释为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T20:10:39.653

我认为你试图让它变得太复杂 - 这没有经过测试，但至少是一个更简单的模式，用于在单链表上进行递归反向行走：

```
static void just_traverse(sll *head_ref) {
    if (head_ref == NULL) {
            return;
    }

    just_traverse(head_ref -> next);

    printf("%d \t",head_ref->payload);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T03:02:47.387

如果您的列表包含 {4,3,2,1}，那么您的输出应该是`1 1 1`正确的。

这是因为声明`*head_ref = second;`。在对函数的第三次调用中，`just_traverse` `head_ref`将指向`2`并且`second`将指向`1`. 现在您正在更新`**head_ref`到`1`. 现在您正在打印`second`. 所以输出将是价值`1`

然后它会返回到第二次调用，这里`head_ref`是`3`和`second`现在`1`（不是`2`因为我们在第三次全部更新）。现在再次分配`1`给 head 和打印`second`。同样，它将`1`仅打印该值。

然后它会返回到第一次调用，这里`head_ref`是`4`和`second`是`1`（不是`3`因为我们在第二次调用中更新了）。现在再次分配`1`给 head 和打印`second`。同样，它将`1`仅打印该值。

所以输出将是三个`1`

```
1 1 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T20:04:05.550

1.  您可以尝试调试以找出错误设置指针的原因。

2.  大概应该是下面这个

    just_traverse(&(second)); 第二->下一个=第一个；第一个->下一个 = NULL；

# linux - 无法停止 Tomcat

> ID：11871354
> 
> 赞同：6
> 
> 时间：2012-08-08T19:01:58.650
> 
> 标签：linux, tomcat, webserver, jprofiler

我对 Tomcat 很陌生，刚刚用 jprofiler 配置了我的 tomcat。但是现在无法停止 tomcat 服务器，收到以下错误消息。

```
[root@localhost bin]# service tomcat stop 
Stopping .
Using CATALINA_BASE:   /data/applications/apache-tomcat-6.0.26
Using CATALINA_HOME:   /data/applications/apache-tomcat-6.0.26
Using CATALINA_TMPDIR: /data/applications/apache-tomcat-6.0.26/temp
Using JRE_HOME:        /usr/lib/jvm/java-1.6.0-openjdk-1.6.0.0
Using CLASSPATH:       /data/applications/apache-tomcat-6.0.26/bin/bootstrap.jar
JProfiler> Protocol version 35
JProfiler> Using JVMTI
JProfiler> JVMTI version 1.1 detected.
JProfiler> 32-bit library
JProfiler> Listening on port: 8849.
JProfiler> Instrumenting native methods.
JProfiler> Can retransform classes.
JProfiler> Can retransform any class.
JProfiler> Native library initialized
JProfiler> VM initialized
JProfiler> Waiting for a connection from the JProfiler GUI ...
JProfiler> ERROR: Could not bind socket.
\n\nTomcat has shutdown 
```

我不确定我的配置有什么问题，是的，盒子上禁用了防火墙。

```
[root@localhost bin]# service iptables status
Firewall is stopped. 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-08T19:11:12.057

为了找到 tomcat PID 运行：

```
ps -ef | grep tomcat 
```

然后使用这个命令：

```
kill -9 PID 
```

或者在一个命令中：

```
kill -9 $(ps -ef | grep tomcat | grep -v "grep" | awk '{print $2}') 
```

另一件事，你可能有一个看门狗在运行，它不断让 tomcat 重新启动——在这种情况下，你也想关闭（或杀死）看门狗

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T13:26:14.410

您已在 tomcat 脚本中插入用于加载 JProfiler 代理的 VM 参数。JProfiler 代理希望能够侦听特定端口（默认为 8849）上的传入连接。该端口已被正在运行的 Tomcat 使用。再次启动 tomcat 脚本时，JVM 初始化失败，因为无法初始化 profiling agent。

您必须`-agentlib:[path to jprofilerti.dll]`从您的 tomcat 启动脚本中删除 JVM 参数或使其有条件，以便它不适用于“停止”命令。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-08T18:28:36.973

根据 Tomcat 文档，您可以定义一个 PID 文件，该文件应该存储 Tomcat 的进程 ID。

1.  在 Tomcat bin 目录中创建一个 shell 脚本“setenv.sh”。
2.  该文件在 catalina.sh 中被引用，因此它应该具有完全相同的名称。
3.  您可以在“setenv.sh”中获取 tomcat pid 信息。像下面的东西..

    `#!/bin/bash CATALINA_PID="$CATALINA_BASE/bin/catalina.pid"`

4.  通过上述步骤，tomcat 将在其 bin 目录中查找名为“catalina.pid”的文件。所以只需创建它。

你完成了。只是不要忘记使用 -force 选项停止 tomcat。

```
./shutdown.sh -force 
```

force 选项告诉 tomcat 通过 PID 杀死 tomcat，如果它不能在给定时间内停止。

# java - 导入到 eclipse 的项目不显示源包

> ID：11871361
> 
> 赞同：0
> 
> 时间：2012-08-08T19:02:37.653
> 
> 标签：java, eclipse

为什么导入到 Eclipse 的项目不显示包，而是只显示常规文件夹结构？

我的 .project 文件

```
<?xml version="1.0" encoding="UTF-8"?>
<projectDescription>
    <name>hello-connector</name>
    <comment></comment>
    <projects>
    </projects>
    <buildSpec>
        <buildCommand>
            <name>org.eclipse.m2e.core.maven2Builder</name>
            <arguments>
            </arguments>
        </buildCommand>
    </buildSpec>
    <natures>
        <nature>org.eclipse.m2e.core.maven2Nature</nature>
    </natures>
</projectDescription> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T19:06:13.083

我假设您不是在导入 Eclipse 项目，而是在导入与 IDE 无关的东西。

您需要编辑项目设置。在 java 构建路径设置中，在第一个选项卡上，您必须添加源文件夹以及源文件夹。;-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T19:20:01.060

从导航器视图中检查项目根目录的内容。您应该看到一个 .classpath 文件。如果该文件丢失，则导入无法正常工作（请注意，两个关键的项目配置文件 .project 和 .classpath 有时会被版本控制系统甚至某些文件系统浏览器忽略）。如果 .classpath 在那里，您必须手动重新配置 .classpath （或检查您是否正在使用包资源管理器视图）。

尝试将您的 .project 更改为如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<projectDescription>
    <name>hello-connector</name>
    <comment></comment>
    <projects>
    </projects>
    <buildSpec>
        <buildCommand>
            <name>org.eclipse.jdt.core.javabuilder</name>
            <arguments>
            </arguments>
        </buildCommand>
        <buildCommand>
            <name>org.eclipse.m2e.core.maven2Builder</name>
            <arguments>
            </arguments>
        </buildCommand>
    </buildSpec>
    <natures>
        <nature>org.eclipse.m2e.core.maven2Nature</nature>
        <nature>org.eclipse.jdt.core.javaNature</nature>
    </natures>
</projectDescription> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T19:47:34.343

从 .project-file 我假设这是一个 Maven 项目。尝试右键单击项目根目录并选择配置 -> 转换为 Maven 项目。之后，您可能需要再次右键单击项目并选择 Maven -> 更新项目配置。希望能帮助到你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-09T16:20:39.107

我通过执行以下操作获得了要显示的包

```
mvn eclipse:eclipse 
```

并按照警告说明安装激活 jar

```
[WARNING] An error occurred during dependency resolution.
    Failed to retrieve javax.activation:activation-1.1-osgi
Caused by: Could not find artifact javax.activation:activation:jar:1.1-osgi in mulesoft-releases (http://repository.mulesoft.org/releases/)

Try downloading the file manually from:
    https://maven-repository.dev.java.net/nonav/repository/javax.activation/jars/activation-1.1.jar

Then, install it using the command:
    mvn install:install-file -DgroupId=javax.activation -DartifactId=activation -Dversion=1.1-osgi -Dpackaging=jar -Dfile=/path/to/file 
```

哦，我也将 POM 文件的依赖项清除为仅此

```
<repositories>
    <repository>
        <id>mulesoft-releases</id>
        <name>MuleSoft Releases Repository</name>
        <url>http://repository.mulesoft.org/releases/</url>
        <layout>default</layout>
    </repository>
</repositories> 
```

所以毕竟我不确定有什么帮助..我确实有其他错误，但至少我可以继续前进。谢谢！

# c# - xml中的简单字符串替换

> ID：11871362
> 
> 赞同：1
> 
> 时间：2012-08-08T19:02:37.543
> 
> 标签：c#, .net

我有一个包含相当多的 XML 的字符串，它实际上是描述一个 word 文档（document.xml）的 xml。我想简单地用一个空字符串替换字符串的一部分，从而有效地将其从字符串中删除。这听起来很简单，但我没有得到我期望的结果。

下面是一些 XML 的样子，这只是前 10 行：

```
<w:body xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main">
    <w:p w:rsidR="00CB3A3E" w:rsidP="00257CF7" w:rsidRDefault="008C1E91">
        <w:pPr>
            <w:pStyle w:val="Heading-Title" />
        </w:pPr>
        <w:r>
            <w:t>References</w:t>
        </w:r>
    </w:p>
    <w:sdt> 
```

正如我所说，这是一个字符串。我只是尝试`<w:t>References</w:t>`用空字符串替换。我这样做是这样的：

```
//xmlBody is the string that is holding the xml
xmlBody.Replace("<w:t>References</w:t>", " "); 
```

这不起作用，当我这样做时字符串不会改变。我究竟做错了什么？任何建议将不胜感激，非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T19:06:15.390

在 C# 中，字符串是不可变的 - 一旦创建，就无法更改。`Replace`返回一个新的字符串实例。因此，您需要捕获它的返回值：

```
xmlBody = xmlBody.Replace("<w:t>References</w:t>", " "); 
```

作为旁注，使用正则表达式解析基于 XML 的字符串并不是一种好的做法，因为它太脆弱了。考虑使用`XDocument`或一些类似的东西来删除你所追求的元素。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-08T19:04:49.453

```
xmlBody = xmlBody.Replace("<w:t>References</w:t>", ""); 
```

Replace 函数不会更改源字符串；它返回一个包含所做更改的新字符串。事实上，C# 字符串是无法更改的。如果您查看[文档](http://msdn.microsoft.com/en-us/library/362314fe.aspx)，它会说它们是不可变的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-08T19:05:28.420

string.replace 返回一个新字符串，它不会改变原始字符串

尝试

```
xmlBody = xmlBody.Replace("<w:t>References</w:t>", " "); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-08T19:05:38.917

Replace 不是内联替换......它返回一个带有替换的新字符串。

# wordpress - 没有 Wordpress 管理员登录或 FTP 访问权限？

> ID：11871363
> 
> 赞同：0
> 
> 时间：2012-08-08T19:02:38.060
> 
> 标签：wordpress, login, admin

我有一个客户希望我为他们创建一个全新的 WP 网站，但大部分内容与他们当前的 WP 网站相同。问题是他们不知道他们当前的 WP 管理员登录或他们的 ftp 登录（通过 DreamHost），而他们以前的网络人是 MIA。他们是否有任何其他方式可以访问他们的网站以导出他们的 WP 数据？我想不，但我想我至少会问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:05:31.150

联系托管公司。他们可以让您访问。他们通常在这种事情上非常合作。只要您能证明您拥有该网站。

# perl - 如何从 perl 调试器更改脚本参数

> ID：11871365
> 
> 赞同：1
> 
> 时间：2012-08-08T19:02:41.710
> 
> 标签：perl, debugging, command-line-arguments

我正在调试一个带有很多命令行参数的 perl 脚本。

是否可以使用不同的参数集重新执行脚本（使用 perl 调试器的 R 命令）？

由于我定义了很多断点和监视，我不想退出调试器并使用新的参数重新启动它......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:07:11.427

您可以在开始时设置一个断点，用 R 重新启动它，然后`@ARGV`在调试器中定义您想要的。

# git - 如何在heroku上部署JSP项目？

> ID：11871374
> 
> 赞同：0
> 
> 时间：2012-08-08T19:02:55.173
> 
> 标签：git, jsp, heroku

我想在heroku上部署JSP项目，我在这个项目中使用mysql数据库，那么我们如何使用mysql数据库在heroku上部署它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T13:57:51.883

您还可以在 Heroku 上尝试 Xeround 的附加组件。他们提供了一个高度可用的 MySQL 云数据库服务，可以与 Heroku 应用程序一起使用。我认为您可以从 Heroku 或 DB 服务创建您的数据库。此外，由于它不是 Amazon 产品，因此您将来可以从 Amazon 云中迁移出去，例如迁移到 RackSpace。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T22:13:38.113

两种选择：

1.  迁移您的应用程序以改用 postgres 并使用[Heroku Postgres](http://postgres.heroku.com)。
2.  使用[亚马逊 RDS 插件](https://addons.heroku.com/amazon_rds)。

# autocomplete - 如何在 Sublime Text 中使用自动完成

> ID：11871379
> 
> 赞同：1
> 
> 时间：2012-08-08T19:03:02.027
> 
> 标签：autocomplete

我正在从 Dreamweaver 切换到 Sublime Text，但 ST 处理自动完成的方式与 DW 不同。在 DW 中，当您开始输入结束标签时，标签会自动完成。但是对于 ST，它会在您键入开始标签时自动完成。

我的问题是，在 ST 中，您被困在您正在输入的标签内，而进入下一行的唯一方法是多次按右箭头键。这似乎完全荒谬。有什么我缺少的捷径吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:11:18.357

这可能是您正在寻找的：

[https://github.com/SublimeText/Tag](https://github.com/SublimeText/Tag)

在我安装了这个插件的 ST 副本中，开始输入结束标记来完成标记并将光标移动到紧跟行尾的字符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-09T16:11:10.413

Ctrl Enter 将带您到下一行并保持显示的自动完成。我在Mac上。

# python - 选择订阅特定用户但该用户未订阅的所有用户

> ID：11871380
> 
> 赞同：3
> 
> 时间：2012-08-08T19:03:04.067
> 
> 标签：python, sql, sqlalchemy, many-to-many, flask-sqlalchemy

我有以下表定义：

```
subscriptions = db.Table("subscriptions",
    db.Column("subscriber_id", db.Integer, db.ForeignKey("users.id"),
        primary_key=True),
    db.Column("subscribee_id", db.Integer, db.ForeignKey("users.id"), 
        primary_key=True),
)

class User(db.Model):
    __tablename__ = 'users'
    id = db.Column(db.Integer, primary_key=True)

    subscribes = db.relationship('User', secondary=subscriptions,
        backref=db.backref('subscribed'),
        primaryjoin="User.id==subscriptions.c.subscriber_id",
        secondaryjoin="User.id==subscriptions.c.subscribee_id",
    ) 
```

我需要形成一个查询来选择订阅特定用户但该用户未订阅的所有用户。我已经可以在 Python 中做到这一点（它们可能比我的描述更清楚地说明我想要什么）：

```
filter(lambda u: u not in self.subscribes, self.subscribed)
# OR: set(self.subscribed) - set(self.subscribes) 
```

但是如果在 SQL 端完成会不会更快？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T20:02:57.227

如果这是在 SQL 中完成的，我相信您的查询将类似于以下内容：

```
SELECT
    u.id
FROM
    subscriptions sub  JOIN
    users u ON u.id = sub.subscriber_id LEFT JOIN
    subscriptions unsub
        ON unsub.subscribee_id = sub.subscriber_id
        AND unsub.subscriber_id= sub.subscribee_id 
WHERE
    sub.subscribee_id = :user_id
    AND unsub.subscribee_id IS NULL 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T22:14:21.330

这是 SQLALchemy 中的解决方案（它只是 Michael Fredrickson 解决方案的翻译）：

```
User1 = aliased(User)
sub = aliased(subscriptions)
unsub = aliased(subscriptions)

qry = db.session.query(User1).select_from(sub).\
    join(User1, User1.id==sub.c.subscriber_id).\
    filter(sub.c.subscribee_id==self.id).\
    outerjoin(unsub,
        and_(unsub.c.subscribee_id==sub.c.subscriber_id,
             unsub.c.subscriber_id==sub.c.subscribee_id)).\
    filter(unsub.c.subscribee_id==None).\
    order_by(User1.name.desc()) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T20:20:16.640

如果您的数据库是 Oracle，您可以使用“MINUS”关键字，该关键字适用于集合，就像您最终评论中的减号一样。以下是一个结构类似于“UNION”查询的单个语句：

```
SELECT subscriber_id FROM subscriptions WHERE subscribee_id = :myuid
MINUS
SELECT subscribee_id FROM subscriptions WHERE subscriber_id = :myuid 
```

或者，如果“MINUS”不可用，您可以使用“NOT IN”；

```
SELECT subscriber_id
FROM subscriptions
WHERE subscribee_id = :myuid
  AND subscriber_id NOT IN
        (SELECT subscribee_id FROM subscriptions WHERE subscriber_id = :myuid) 
```

# windows-phone-7 - 应用程序未运行时的 Windows Phone 7 推送通知

> ID：11871381
> 
> 赞同：2
> 
> 时间：2012-08-08T19:03:07.517
> 
> 标签：windows-phone-7, windows-phone-7.1

我正在尝试在 windows phone 7.5 中实现推送通知

当应用程序启动时，我在 App.xaml 中绑定了 channelUri。然后我可以将我的应用程序切换到后台并根据 Uri 接收 toast 通知。

但这需要我先打开应用程序，然后再将其设置为后台。

我可以在没有运行应用程序的情况下接收 toast 吗？那是 channelUri 没有绑定的时候。

这是 Windows phone 7 中的默认行为，还是我在这里遗漏了一点？

如果这是这种行为，当应用程序未运行时，如何向手机发送某种形式的通知/信息？

当应用程序被墓碑化时，我确实看到了这个[Windows Phone 7.5 - Push Notifications](https://stackoverflow.com/questions/10340474/windows-phone-7-5-push-notifications-when-app-is-tombstoned)。

更新：

1.  我知道频道最多可以使用 30 天，我只使用模拟器时是否一样？
2.  应用程序应该与一个通道相关联以便接收通知，即使在应用程序没有运行时，如果通知通道处于活动状态，那么应用程序也会收到 toast

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T07:58:24.557

我认为你没有抓住重点。为了接收 toast 通知，您不必让应用程序在后台运行。Toasts（和 Tile 通知）适用于应用程序根本没有运行的情况。因此，启动应用程序以获取 push-uri，然后将其发送到服务。理论上，您在 30 天后将不再需要。当涉及到模拟器时，只要模拟器正在运行，它就可以使用。一旦你关闭/关闭模拟器，push-uri 就消失了，你需要重新请求一个。（一般来说，模拟器上没有保存任何东西，所以关闭和打开模拟器就像每次都得到一个新设备。）

希望这会有所帮助

# actionscript-3 - AS3 Datagrid 多选

> ID：11871382
> 
> 赞同：0
> 
> 时间：2012-08-08T19:03:08.423
> 
> 标签：actionscript-3, advanceddatagrid

我正在使用 Flash AS3（不是 Flex）。我有一个带有**“allowMultipleSelection = true”的数据网格；** 仅当使用按钮完成行选择时，我才想在我的数据库中获取和存储选定的行。（我不想使用“ListEvent.ITEM_CLICK”，因为可以使用 CTRL 键选择一行并将其从选择中删除）

如何检索数据网格中的选定行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:54:01.920

假设您使用的是[fl.controls.DataGrid](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/fl/controls/DataGrid.html)，您可以在单击按钮时使用[selectedItems](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/fl/controls/SelectableList.html#selectedItems)属性（它是一个）来获取（或设置）所选项目。`Array`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-20T03:10:23.120

我有一个数据网格，其中有复选框，用于在单击数据网格行时进行检查。我想允许多项选择，并根据是否使用 shift 键选择相应的行来选中或取消选中它们。我可以通过使用 arraycollection 的 contains 方法然后选中复选框来做到这一点。

# cuda - CUDA simpleP2P 失败

> ID：11871388
> 
> 赞同：0
> 
> 时间：2012-08-08T19:03:19.890
> 
> 标签：cuda, multi-gpu

我有带有 24 个 GPU 的 Tesla M2070 集群。我尝试运行 simpleP2P SDK 示例，但它显示以下错误，尽管我的设备支持 UVA。操作系统；Linux 64 位。

`Checking for multiple GPUs...`

`CUDA-capable device count: 3`

> GPU0 = "Tesla M2070" 支持点对点 (P2P)
> 
> GPU1 = "Tesla M2070" 支持点对点 (P2P) GPU2 = "Tesla M2070" 支持点对点 (P2P)

`Checking GPU(s) for support of peer to peer memory access...`

> 从 Tesla M2070 (GPU0) -> Tesla M2070 (GPU1) 对等访问：否
> 
> 从 Tesla M2070 (GPU1) -> Tesla M2070 (GPU0) 对等访问：否

`Two or more SM 2.0 class GPUs are required for ./simpleP2P to run.`

`Support for UVA requires a GPU with SM 2.0 capabilities.`

`Peer to Peer access is not available between GPU0 <-> GPU1, waiving test.`

`PASSED`

它最后显示通过，但从一个 GPU 到另一个标志的对等访问显示没有值。

# java - 使用 netbeans 项目在 linux 中构建不工作

> ID：11871389
> 
> 赞同：0
> 
> 时间：2012-08-08T19:03:26.177
> 
> 标签：java, linux, ant, netbeans-7

我编写了一个 Java Web 应用程序（部署在 glassfish 服务器上）以部署到 Tomcat 服务器上。我将项目文件与 build.xml 一起复制到 linux 系统并尝试

```
[packwolf src]$ ant
Buildfile: build.xml

BUILD FAILED
/home/packwolf/Application/src/build.xml:12: The following error occurred while executing this line:
/home/packwolf/Application/src/nbproject/build-impl.xml:22: Class org.apache.tools.ant.taskdefs.condition.Not doesn't support the nested "antversion" element. 
```

Web 应用程序应该是可移植的，但事实并非如此。有什么想法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:12:10.853

您需要检查您的 ant 版本。它可能与您的其他盒子上的不同。

# linux - 为可以安装在不同机器上的 Linux 创建 R 二进制包？

> ID：11871394
> 
> 赞同：14
> 
> 时间：2012-08-08T19:03:46.770
> 
> 标签：linux, r, ubuntu, binary, package

我很确定这是不可能的，因为如果是这样，那么 CRAN 将拥有 R Linux 二进制包。为什么不可能？我们可以创建 R 包的 Mac 和 Windows 二进制版本，这些 tgz/zip 文件可以安装在不同的系统上。为什么我们不能对 Linux 做同样的事情？

我猜是因为有很多不同的发行版，每个发行版都不一样。是否可以为 Debian/Ubuntu 和 RHEL/CentOS 创建二进制文件？

如果可能，我们该怎么做？谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-08T19:27:21.710

不同的编译器版本、不同的 libc/libstc++ 版本、不同的“其他库”版本、不同的发行版发行周期……使您无法将目标与动态链接相匹配。

您可以通过 a) 捆绑所有依赖项和 b) 像对 Debian/Ubuntu 和 RH/FC/CentOS 所做的那样反映子集，就像 RStudio 所做的那样。但是使用 a) 压缩包会变得很大，就像使用静态链接一样。

简而言之：你不能在 Linux 上。所以回到源头。

# jquery - 如何像带有换行符的段落一样布局相对定位的“li”？

> ID：11871396
> 
> 赞同：0
> 
> 时间：2012-08-08T19:04:02.667
> 
> 标签：jquery, wordpress, html-lists, nav

这是我的jsfiddle，请看一下：

[http://jsfiddle.net/63pNN/](http://jsfiddle.net/63pNN/)

我在格式化这个“ul”时遇到了问题。它适用于 wordpress，因此将添加更多“li”元素。'li' 元素需要是 'position:relative;' 这样当他们从“显示：无”到“显示：内联”时，使用 jquery 下拉功能，“div”将改变高度以适应。

我希望列表如下所示：

主页 Item1 Item2 Item3
ItemA ItemB ItemC ItemD ItemE ItemF
ItemX ItemY ItemZ

我应该为此使用一张桌子吗？如何让这些元素以这种方式出现？我试过左浮动'ul'。

The list will work like a dropdown menu, so that when Item2 > ItemC is selected, the list should appear like this:

主页 Item1 **Item2** Item3
**ItemC** ItemD
ItemY

此外，如果您对如何在单击或切换时一次只显示一个兄弟姐妹有任何想法，请告诉我。我有任何想法，父母应该采用一个意味着它的“选择”的类，然后向它的孩子添加一个类，以便它们出现。然后，当单击其同级之一时，父级应丢失其“选定”类。但我无法让它发挥作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:07:32.523

您可以使用：

```
li {
   float: left;
} 
```

或者：

```
li {
   display: inline;
} 
```

# python - LIBSVM Python ctypes 字符串函数指针分段错误

> ID：11871398
> 
> 赞同：2
> 
> 时间：2012-08-08T19:04:43.933
> 
> 标签：python, machine-learning, solaris, ctypes, libsvm

我一直在将一个使用 libsvm 的 Python 包移植到一些生产服务器上，并遇到了一个奇怪的分段错误，我追踪到了一个 ctypes 函数指针。我正在尝试确定 ctypes 包装器失败的位置以及这是否是特定于发行版的问题。

我运行它的系统是一个非常干净的虚拟机，几乎没有安装任何东西：Solaris 5.11 amd64 pentium_pro+mmx pentium_pro pentium+mmx pentium i486 i386 i86 Python 2.7.2

现在是问题描述以及我如何缩小到 ctypes。在 libsvm 中，您可以通过将`void (*print_func)(const char *)`指针传递给函数来指定打印`svm_set_print_string_function`函数。NULL 指针的默认设置是打印到标准输出。现在有趣的部分是 libsvm 的 Python 包装器（在各种其他系统上都可以正常工作）在通过以下方式请求安静模式（不打印）时会生成这样一个函数指针：

```
PRINT_STRING_FUN = CFUNCTYPE(None, c_char_p)
def print_null(s): 
    return

if argv[i] == "-q":
    self.print_func = PRINT_STRING_FUN(print_null)

libsvm.svm_set_print_string_function(self.print_func) 
```

`svm_train`当我设置安静模式时，libsvm 接受函数指针，但在调用然后 seg 错误时会在几秒钟后挂起。我尝试制作一个`void *`参数函数指针，然后将其转换为`const char *`具有相同结果的函数指针，这意味着它不是从`const char *`PyStringObject 的转换。

然后我终于写了一个 C++ 函数，通过以下方式将函数指针设置为库本身中的空操作：

```
void print_null(const char *) {}

void svm_set_print_null() {
    svm_set_print_string_function(&print_null);
} 
```

它按预期工作，没有分段错误。这让我认为 ctypes 在函数指针转换的某个内部点失败了。尽管我没有明确地使用 ctypes 进行大量工作，但查看 ctypes 源文件并没有发现任何明显的东西，因此很难缩小可能存在的错误。

我现在可以使用我的库添加解决方案，但如果我想静默处理返回，我实际上需要能够将函数指针传递给 libsvm。另外，如果我需要在不知道问题的真正根本原因是什么的情况下实施此类变通办法，它不会让我对稳定性高枕无忧。

有没有其他人对 Solaris 上的 libsvm 打印函数或 Solaris 上的 Python 中的 ctypes 函数指针有问题？我在网上找不到任何关于 Solaris 的此类问题的搜索。我计划玩弄库调用并制作一些函数处理库以找到故障的确切边界，但其他人的输入可能会为我节省一两天的调试测试。

**更新**

该问题在 Solaris 5.11 的 32 位版本上也可以重现。

# jquery - 多个 jquery datepickers 中的默认日期

> ID：11871399
> 
> 赞同：0
> 
> 时间：2012-08-08T19:04:48.197
> 
> 标签：jquery, jquery-ui, jquery-ui-datepicker

我有几个共享一个“日期”类的输入，每个输入都从数据库中获取它的值，并像这样转换为日期选择器：

```
$(".date").datepicker({
    changeMonth: true,
    changeYear: true,
    dateFormat: "dd/mm/yy"
}); 
```

我需要的是，当我单击任何输入并显示日期选择器时，该特定日期选择器的默认日期是存储在值中的日期，而不是今天的日期。

我怎样才能做到这一点？

我尝试了以下但没有成功

```
$(".date").datepicker({
    changeMonth: true,
    changeYear: true,
    dateFormat: "dd/mm/yy",
    defaultDate: $(this).val()
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T19:10:27.623

这个你可能想多了。看看这个[小提琴](http://jsfiddle.net/BQGEk/)。单击每个输入并查看作为输入值的默认日期。

**HTML**

```
<input type="text" class="date" value="02/05/2012" />
<input type="text" class="date" value="06/09/2015" />​ 
```

**JS**

```
$(function(){
    $(".date").datepicker({
        changeMonth: true,
        changeYear: true,
        dateFormat: "dd/mm/yy"
    }); 
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T19:17:54.777

试试这个代码：

```
$(".date").datepicker({
    changeMonth: true,
    changeYear: true,
    dateFormat: "dd/mm/yy"
}).on( "change", function() {
    $(".date").datepicker("option", "defaultDate", this.value);
}); 
```

这会监听输入何时更改并更新`defaultDate`所有日期选择器字段的设置。请注意，根据您操作输入的方式，您可能需要不同的事件（除了更改）。此外，当前日期值将始终覆盖默认日期（因此我的代码不适用于 wanovak 的示例，因为字段中已经有值）。

# javascript - Google Maps API v3 自定义光标在 Google Chrome 中的热点

> ID：11871411
> 
> 赞同：0
> 
> 时间：2012-08-08T19:06:04.057
> 
> 标签：javascript, jquery, google-chrome, google-maps-api-3, cursor

我以前听说过 Google Chrome 在自定义光标热点方面遇到问题，但我不确定如何在我的情况下解决这些问题，因为 Google Maps API v3 正在使用自定义光标。我有一个我设计并保存为 .cur 文件的光标。热点设置在左下角。我通过在 Photoshop CS5 中设置标尺开始点来设置它。光标在 Firefox 和 Safari 中完美运行，但在 Google Chrome 中，热点仍位于左上角。我也在 Chrome 的控制台中收到此警告：“资源解释为图像，但使用 MIME 类型应用程序/八位字节流传输。” 我该怎么办？

这是jsFiddle。您会发现它在 Safari 或 Firefox 中有效，但在 Chrome（在 Mac 上）中无效。

[http://jsfiddle.net/ruXhf/1/](http://jsfiddle.net/ruXhf/1/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:11:43.463

将此添加到您的`.htaccess`文件中

```
 AddType image/vnd.microsoft.icon .cur .ico 
```

# multithreading - 虚拟列表视图、线程和内存消耗不会下降

> ID：11871420
> 
> 赞同：3
> 
> 时间：2012-08-08T19:06:22.510
> 
> 标签：multithreading, delphi, memory, virtual, tstringlist

*更新：有两个人告诉我，如果没有真实/完整的代码，很难帮助我。你几乎在下面有它，但如果我忘记了什么，就在这里！[Laserrental.ca/MemoryProblem.zip](http://laserrental.ca/MemoryProblem.zip)

* * *

**使用的 Delphi 版本：2007**

你好，

我是线程和虚拟列表视图的新手，所以我的问题可能很容易解决；但是，我已经被困了几天。基本上，这就是我所拥有的：

[http://image.noelshack.com/fichiers/2012/32/1344440638-urlsloader.png](http://image.noelshack.com/fichiers/2012/32/1344440638-urlsloader.png)

用户单击**加载 URL**，URL 存储在以下记录中：

```
type TVirtualList=record
  Item:Integer; // Index
  SubItem1:String; // Status
  SubItem2:String; // URL
end;

...

var
 LURLs : Array of TVirtualList; 
```

并且该记录用于填充Virtual Listview。这是 OnData 代码：

```
procedure TForm1.ListViewData(Sender: TObject; Item: TListItem);
begin
 Item.Caption := IntToStr(LURLs[Item.Index].Item);
 Item.SubItems.Add(LURLs[Item.Index].SubItem1);
 Item.SubItems.Add(LURLs[Item.Index].SubItem2);
end; 
```

当用户点击**GO**时，应用程序将启动一个线程来控制工作线程的创建。每个工作线程获取一个 URL，下载并解析它以获取更多信息。

现在，这是我的问题：内存消耗总是越来越高——至少，根据任务管理器的说法。如果我最小化应用程序并再次打开它，内存消耗会恢复正常......但虚拟内存消耗仍然非常高。现在，我知道很多人说任务管理器不可靠。然而，一段时间后，内存消耗变得如此之高，以至于无法再下载 URL。我收到**EOutOfMemory**错误。我的电脑变得超级慢。

根据 FastMM4，没有内存泄漏。

有趣的是：如果我清除 TVirtualList 记录，内存消耗——“正常”和虚拟的——都会恢复正常。但除非我这样做，否则它会保持在超高水平。显然，这是一个问题，因为我希望应用程序能够下载成千上万个 URL；但是有了这个错误，我不能走得太远。

**清除 TVirtualList 记录的代码**

```
ListView.Items.BeginUpdate;
SetLength(LURLs,0);
ListView.Items.Count := Length(LURLs);
ListView.Clear;
ListView.Items.EndUpdate; 
```

* * *

因此，我将应用程序精简到了最基本的部分。没有解析，应用程序使用临界区加载单个本地 HMTL 文件，而不是下载文件。内存消耗问题仍然存在。

* * *

**控制线程：**

```
unit Loader;

interface

uses Classes, SysUtils, Windows, Thread, Forms;

type
  TLoader = class(TThread)
  private
    { Private declarations }
  protected
    procedure Execute; override;
    procedure UpdateButtons;
    procedure UpdateListView;
  public
    constructor Create;
  end;

implementation

uses Main;

constructor TLoader.Create;
begin
 inherited Create(False);
 FreeOnTerminate := True;
end;

procedure TLoader.UpdateButtons;
begin
 Form1.BSwitch(false); // Re-enable interface
end;

procedure TLoader.UpdateListView;
begin
 Form1.ListView.Items.Item[BarP].MakeVisible(false); // Scroll down the listview
 Application.ProcessMessages;
end;

procedure TLoader.Execute;
begin
 while (BarP < Length(LURLs)) and (not(Terminated)) do  // Is there any URL left?
 begin
  if (ThreadsR < StrToInt(Form1.Threads.Text)) then // Have we met the threads limit?
  begin
   Synchronize(UpdateListView);
   TThreadWorker.Create(LURLs[BarP].SubItem1, BarP);
   InterlockedIncrement(ThreadsR);
   Inc(BarP);
  end else Sleep(100);
 end;

 while (not(ThreadsR = 0)) do Sleep(100);

 Synchronize(UpdateButtons);
end;

end. 
```

**工作线程：**

```
unit Thread;

interface

uses Classes, SysUtils, Windows, Forms;

type
  TThreadWorker = class(TThread)
  private
    { Private declarations }
    Position : Integer;
    HtmlSourceCode : TStringList;
    StatusMessage, TURL : String;
    procedure UpdateStatus;
    procedure EndThread;
    procedure AssignVariables;
    procedure DownloadURL;
  protected
    procedure Execute; override;
  public
    constructor Create(URL : String ; LNumber : Integer);
  end;

implementation

uses Main;

var CriticalSection: TRTLCriticalSection;

constructor TThreadWorker.Create(URL : String ; LNumber : Integer);
begin
 inherited Create(False);
 TURL := URL;
 Position := LNumber;
 FreeOnTerminate := True;
end;

procedure TThreadWorker.UpdateStatus;
begin
 LURLs[Position].SubItem1 := StatusMessage;
 Form1.ListView.UpdateItems(Position,Position);
end;

procedure TThreadWorker.EndThread;
begin
 StatusMessage := 'Success';
 Synchronize(UpdateStatus);
 InterlockedIncrement(NDone);

 // I free Synapse THTTPSend variable.

 HtmlSourceCode.Free;
 InterlockedDecrement(ThreadsR);
end;

procedure TThreadWorker.AssignVariables;
begin
 StatusMessage := 'Working...';
 Synchronize(UpdateStatus);

 // I initialize Synapse THTTPsend variable.

 HtmlSourceCode := TStringList.Create;
end;

procedure TThreadWorker.DownloadURL;
begin
 (* This is where I download the URL with Synapse. The result file is then loaded
 with HtmlSourceCode for further parsing. *)

 EnterCriticalSection(CriticalSection);
  HtmlSourceCode.LoadFromFile(ExtractFilePath(application.exename)+'testfile.html');
 LeaveCriticalSection(CriticalSection);

 Randomize;
 Sleep(1000+Random(1500)); // Only for simulation
end;

procedure TThreadWorker.Execute;
begin
 AssignVariables;
 DownloadURL;
 EndThread;
end;

initialization
  InitializeCriticalSection(CriticalSection);

finalization
  DeleteCriticalSection(CriticalSection);

end. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T02:11:23.163

您所描述的听起来像是内存泄漏或内存碎片。无论哪种方式，都很难说，因为您没有展示如何分配和填充 URLs 数组本身。

我建议完全摆脱`TLoader`并使用节流队列。下载 url 时，检查是否已经存在空闲`TWorker`，如果存在则让它下载 URL，否则`TWorker`如果您还没有达到限制，则开始一个新的，否则将 URL 放入队列以供以后处理。每次 a`TWorker`完成时，它可以检查队列以获取要下载的新 URL，如果队列为空，`TWorker`则可以终止下载。

尝试这样的事情：

```
type
  TURLInfo = record 
    Index: Integer;
    Status: String;
    URL: String;
  end; 

...

private 
  LURLs: array of TURLInfo; 
  LURLQueue: TList;
  LWorkers : TList; 

...

uses
  ..., Worker;

const
  WM_REMOVE_WORKER := WM_USER + 100;

procedure TForm1.FormCreate(Sender: TObject); 
begin 
  LURLQueue := TList.Create;
  LWorkers := TList.Create; 
end; 

procedure TForm1.FormDestroy(Sender: TObject); 
begin 
  LURLQueue.Free;
  LWorkers.Free; 
end; 

procedure TForm1.FormClose(Sender: TObject; var Action: TCloseAction);
begin
  StopWorkers;
end;

procedure TForm1.WndProc(var Message: TMessage);
var
  Worker: TWorker;
begin
  if Message.Msg = WM_REMOVE_WORKER then
  begin
    Worker := TWorker(Message.LParam);
    if LWorkers.Remove(Worker) <> -1 then
    begin
      Worker.Stop;
      Worker.WaitFor;
      Worker.Free;
    end;
  end else
    inherited;
end;

procedure TForm1.ListViewData(Sender: TObject; Item: TListItem); 
var
  Index: Integer;
begin 
  Index := Item.Index;
  Item.Caption := IntToStr(LURLs[Index].Index); 
  Item.SubItems.Add(LURLs[Index].Status); 
  Item.SubItems.Add(LURLs[Index].URL); 
end; 

procedure TForm1.ClearURLs;
begin 
  StopWorkers;
  ListView.Items.Count := 0; 
  SetLength(LURLs, 0); 
end;

procedure TForm1.DownloadURL(Number: Integer);
var
  I: Integer;
  Worker: TWorker;
begin
  for I := 0 to LWorkers.Count-1 do
  begin
    Worker := TWorker(LWorkers[I]);
    if Worker.Idle then
    begin
      if Worker.Queue(LURLs[Number].URL, Number) then
        Exit;
    end;
  end;
  if LWorkers.Count < StrToInt(Threads.Text) then
  begin
    Worker := TWorker.Create;
    try
      Worker.OnStatus := WorkerStatus;
      Workers.Add(Worker);
    except
      Worker.Free;
      raise;
    end;
    Worker.Resume;
    if Worker.Queue(LURLs[Number].URL, Number) then
      Exit;
  end;

  LURLQueue.Add(TObject(Number));

  LURLs[Number].Status := 'Queued'; 
  ListView.UpdateItems(Number, Number); 
end;

procedure TForm1.DownloadURLs;
var
  I: Integer;
begin 
  LURLQueue.Clear;
  for I := 0 to High(LURLs) do
    DownloadURL(I);
end; 

procedure TForm1.StopWorkers;
var
  I: Integer;
  Worker: Tworker;
begin
  LURLQueue.Clear;

  for I := 0 to LWorkers.Count-1 do
    TWorker(LWorkers[I]).Stop;

  for I := 0 to LWorkers.Count-1 do
  begin
    Worker := TWorker(LWorkers[I]);
    Worker.WaitFor;
    Worker.Free;
  end;

  LWorkers.Clear;
end;

procedure TForm1.WorkerStatus(Sender: TWorker; APosition: Integer; const Status: String; Done: Boolean);
var
  URL: String;
  Number: Integer;
begin
  LURLs[APosition].Status := Status; 
  ListView.UpdateItems(APosition, APosition); 

  if not Done then Exit;

  if LURLQueue.Count = 0 then
  begin
    Sender.Stop;
    PostMessage(Handle, WM_REMOVE_WORKER, 0, Sender);
    Exit;
  end;

  Number := Integer(LURLQueue[0]);

  if Sender.Queue(LURLs[Number].URL, Number) then
    LURLQueue.Delete(0);
end; 
```

.

```
unit Worker; 

interface 

uses
  Classes, SysUtils, HttpSend; 

type 
  TWorker = class;
  TWorkerStatusEvent = procedure(Sender: TWorker; ANumber: Integer; const Status: String; Done: Boolean) of object;

  TWorker = class(TThread) 
  private 
    { Private declarations } 
    Http: THTTPsend;
    Signal: TEvent;
    Number : Integer; 
    HtmlSourceCode : TStringList; 
    StatusMessage, URL : String; 
    StatusDone : Boolean; 
    FOnStatus: TWorkerEvent;
    procedure UpdateStatus(const Status: String; Done: Boolean); 
    procedure DoUpdateStatus; 
    procedure DownloadURL; 
  protected 
    procedure Execute; override; 
    procedure DoTerminate; override; 
  public 
    Idle: Boolean;
    constructor Create; 
    destructor Destroy; override; 
    function Queue(AURL: String; ANumber: Integer): Boolean;
    procedure Stop;
    property OnStatus: TWorkerStatusEvent read FOnStatus write FOnStatus;
  end; 

implementation 

constructor TWorker.Create; 
begin 
  inherited Create(True); 
  Signal := TEvent.Create(nil, False, False, '');
  Http := THTTPsend.Create;
  HtmlSourceCode := TStringList.Create; 
end; 

constructor TWorker.Destroy; 
begin 
  Signal.Free;
  HtmlSourceCode.Free; 
  Http.Free;
  inherited Destroy; 
end; 

function TWorker.Queue(AURL: String; ANumber: Integer): Boolean;
begin
  if (not Terminated) and Idle then
  begin
    URL := AURL; 
    Number := ANumber;
    Signal.SetEvent;
    Result := True;
  end else
    Result := False;
end;

procedure TWorker.Stop;
begin
  Terminate;
  Signal.SetEvent;
end;

procedure TWorker.UpdateStatus(const Status: String; Done: Boolean); 
begin
  if Assigned(FOnStatus) then
  begin
    StatusMessage := Status;
    StatusDone := Done;
    Synchronize(DoUpdateStatus); 
  end;
end;

procedure TWorker.DoUpdateStatus; 
begin 
  if Assigned(FOnStatus) then
    FOnStatus(Self, Number, StatusMessage, StatusDone);
end; 

var
  HtmlFileName: String;

procedure TWorker.Execute; 
begin 
  Randomize; 
  while not Terminated do
  begin
    Idle := True;

    if Signal.WaitFor(Infinite) <> wrSignaled then Exit;
    if Terminated then Exit;

    Idle := False;
    try
      try
        UpdateStatus('Working...', False); 
        if Terminated then Exit;

        // initialize THTTPsend...
        // download URL...
        // parse HTML...
        //
        HtmlSourceCode.LoadFromFile(HtmlFileName); 
        Sleep(1000+Random(1500)); // Only for simulation 

        UpdateStatus('Success', True); 
      finally
        HtmlSourceCode.Clear; 
      end;
    except
      UpdateStatus('Error', True); 
    end;
  end;
end; 

procedure TWorker.DoTerminate;
begin
  Idle := False;
  Terminate;
  inherited;
end; 

initialization
  HtmlFileName := ExtractFilePath(ParamStr(0)) + 'testfile.html';

end. 
```

# android - 尝试录制音频但收到消息“mediarecorder 因未处理的事件而消失”和“致命信号 11 (SIGSEGV)....”

> ID：11871421
> 
> 赞同：24
> 
> 时间：2012-08-08T19:06:23.370
> 
> 标签：android, audio-recording

我正在尝试在 android 中录制音频，但我遇到了问题。

我有开始和停止按钮，“开始”用于开始录制，“停止”用于停止录制。

问题是，当我按下停止按钮时，我的应用程序会记录一条消息“W/MediaRecorder(635): mediarecorder away with unhandled events”。（启动功能正在正确保存音频文件。）

然后，如果我再次按下开始或停止按钮，则会收到错误消息“A/libc(743): Fatal signal 11 (SIGSEGV) at 0x00000010 (code=1), thread 743 (xample.recorder)”

录音类代码如下：

```
 /**
   * Creates a new audio recording at the given path (relative to root of SD card).
   */
  public AudioRecorder(String path) {
    this.path = sanitizePath(path);
  }
  private String sanitizePath(String path) {
        if (!path.startsWith("/")) {
          path = "/" + path;
        }
        if (!path.contains(".")) {
          path += ".3gp";
        }
        return Environment.getExternalStorageDirectory().getAbsolutePath() + path;
      }

  public void start() throws IOException {
    String state = android.os.Environment.getExternalStorageState();
    if(!state.equals(android.os.Environment.MEDIA_MOUNTED))  {
        throw new IOException("SD Card is not mounted.  It is " + state + ".");
    }

    // make sure the directory we plan to store the recording in exists
    File directory = new File(path).getParentFile();
    if (!directory.exists() && !directory.mkdirs()) {
      throw new IOException("Path to file could not be created.");
    }

    recorder.setAudioSource(MediaRecorder.AudioSource.MIC);
    recorder.setOutputFormat(MediaRecorder.OutputFormat.THREE_GPP);
    recorder.setAudioEncoder(MediaRecorder.AudioEncoder.AMR_NB);
    recorder.setOutputFile(path);
    try{
    recorder.prepare();
    }
    catch(IOException e){
        Log.e("Recorder","Recording failed");
    }
    recorder.start();
  }
  /**
   * Stops a recording that has been previously started.
   */
  public void stop() throws IOException {
    recorder.stop();
    recorder.release();
  } 
```

主要活动代码如下：

```
 /*
 * */
  public class Recorder extends Activity implements OnClickListener

   {
private static final String TAG="Recorder";
AudioRecorder ar=new AudioRecorder("/TestAudio.3gp");
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_recorder);

    final Button start = (Button) this.findViewById(R.id.btn_start);
    start.setOnClickListener(this);

    final Button stop = (Button) this.findViewById(R.id.btn_stop);
    stop.setOnClickListener(this);

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_recorder, menu);
    return true;
}

public void onClick(View v) {
    // TODO Auto-generated method stub
    try{
         switch (v.getId()) {
            case R.id.btn_start:
                ar.start();
                Log.d("Recorder","Recorded");
                Toast.makeText(this, "Controll returned from start function", Toast.LENGTH_LONG).show();              
                break;
            case R.id.btn_stop:
                ar.stop();
                Toast.makeText(this, "Recording stopped; Starting MediaPlayer", Toast.LENGTH_SHORT).show();
                //Toast.makeText(this, "Starting media player", Toast.LENGTH_LONG).show();
                ar.startPlaying();
                //Toast.makeText(this, "Recording stopped", Toast.LENGTH_LONG).show();

              break;
            }
        }
        catch(Exception e){
            Log.e("Recorder", e.getMessage(), e);   
            Toast.makeText(this, e.getMessage(), Toast.LENGTH_LONG).show();
        }

} 
```

}

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-08-16T09:34:08.493

我通过在释放记录器之前重置记录器解决了这个问题。

```
recorder.stop();     // stop recording
recorder.reset();    // set state to idle
recorder.release();  // release resources back to the system
recorder = null; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-09T06:57:50.530

这可能是由于运行修改后的固件而引起的。SIGSEGV 不应该来自 Java。阅读这篇文章。最后有错误的解释。祝你好运。

[录制音频时出现Android SIGSEGV错误](https://stackoverflow.com/questions/11274341/android-sigsegv-error-when-recording-audio)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-22T07:07:05.100

该文档指出：

> 为了接收与这些侦听器相关的相应回调，应用程序需要**在运行 Looper 的线程上创建 MediaRecorder 对象**（默认情况下，主 UI 线程已经运行了 Looper）。

确保在 UI 线程上创建记录器。也许也可以在 UI 线程上调用它的方法。

# ruby - 有没有办法在红宝石中获得单次击键？

> ID：11871425
> 
> 赞同：3
> 
> 时间：2012-08-08T19:06:52.810
> 
> 标签：ruby

我需要一种方法来检查键盘，看看是否按下了任何一个键，如果是，请获取该键，如果没有，请离开并继续我的业务。我只需要检查大约六把钥匙。而且我会经常回来检查（即，这个检查是在程序的一部分中不断重复[只要程序正在运行）。或者，我想我也可以将它实现为中断，即，做剩下的循环并在按下时获取密钥。

因为 get 和 getc 都在等待返回，所以它们对我不起作用。我在 java 和 windows 中找到了示例，但我在 Mac 上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T20:29:36.543

要立即读取字符而不给 tty 设备编辑字符并等待返回的机会，您需要这样的东西：

```
system 'stty cbreak'
$stdout.syswrite 'How now: '
q = $stdin.sysread 1
puts
puts "You typed #{q} it seems."
system 'stty cooked' 
```

要添加对可用字符的检查，请将其扩展为进行非阻塞读取...

```
def read1maybe
  return $stdin.read_nonblock 1
rescue Errno::EAGAIN
  return ''
end

system 'stty cbreak'
while true
  q = read1maybe
  break if q.length > 0
  puts 'you did not change anything'
  sleep 1
end
puts
puts "You typed #{q} it seems."
system 'stty cooked' 
```

有关更详细的内容，请参阅[标准库 curses 包。](http://ruby-doc.org/stdlib-1.9.3/libdoc/curses/rdoc/Curses.html)您可能还会发现[io/console](http://www.ruby-doc.org/core-1.9.3/IO.html)很有用。

# php - 在理解如何使用 DOMDocument 时遇到问题

> ID：11871426
> 
> 赞同：0
> 
> 时间：2012-08-08T19:06:53.130
> 
> 标签：php, dom

我正在尝试将 html 页面转换为 dom 对象，以便从页面中获取信息

以下代码只给了我错误，所以无论我在做什么都是错误的

**php代码**

```
$page = file_get_contents('http://google.com');
$dom= new DOMDocument();
$dom->loadHTML($page);
echo $dom->saveHTML(); 
return; 
```

错误示例

```
Warning: DOMDocument::loadHTML() [domdocument.loadhtml]: htmlParseEntityRef: expecting ';' in Entity, line: 34 in C:\xampp\htdocs\site\index.php on line 32 
```

谁能告诉我我应该做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:23:54.903

老实说，我不知道这是否能解决您的问题，但请尝试以下操作。使用[tidy](http://www.php.net/manual/en/book.tidy.php)清理 html。

```
$page = file_get_contents('http://google.com');

// Specify configuration
$config = array(
           'indent'         => true,
           'output-xhtml'   => true,
           'wrap'           => 200);

// Tidy
$tidy = new tidy();
$tidy->parseString($page, $config, 'utf8');
$tidy->cleanRepair();

$dom= new DOMDocument();
$dom->loadHTML($tidy);
echo $dom->saveHTML(); 
return; 
```

# asp.net - 即使信任级别为高，也未授予 ReflectionPermission

> ID：11871433
> 
> 赞同：1
> 
> 时间：2012-08-08T19:07:17.760
> 
> 标签：asp.net, security, iis-7.5, code-access-security

我正在尝试在 Windows 2008、IIS 7.5 上运行 ASP.NET 2.0 应用程序。该应用程序抛出此异常：

> SecurityException：请求“System.Security.Permissions.ReflectionPermission，mscorlib，Version=2.0.0.0，Culture=neutral，PublicKeyToken=b77a5c561934e089”类型的权限失败。]

即使应用程序`trust level = "Full"`按照`web.config`. 是的，框架 web.config 配置为允许覆盖信任级别。

我感觉盒子上的安全策略正在阻止应用程序以这种信任级别实际运行，即使我们明确指示它这样做。该应用程序在 Win7 上的 dev 中运行良好。

感谢您的任何想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:40:02.030

在“解锁”特定 dll 及其 pdb 和 xml 文件后，问题得到解决。（右键单击，属性，单击“取消阻止”按钮。）

# c - 调试程序

> ID：11871435
> 
> 赞同：0
> 
> 时间：2012-08-08T19:07:21.097
> 
> 标签：c

我几乎完成了我的程序。问题是，我在使用指针进行调试时遇到了一些小问题。我想要一些关于如何修复它的帮助。请注意，我确实需要我所有的函数原型。（如果我能在 main 中做所有事情，分配会容易得多......）

```
#include <stdio.h>
#include <stdlib.h>

#define STUDENTS 5

int getData(int *student, char *pass, int *hw1, int *hw2, int *hw3, int *hw4,
             int *hw5, int *hw6, int *hw7, int *mid1, int *mid2, int *final,
             int *extra);
float calcAvg(float *total);
float printTable(int student, float total);

int main(void)

{
    int student[STUDENTS];
    char pass[STUDENTS];
    int hw1[STUDENTS], hw2[STUDENTS], hw3[STUDENTS], hw4[STUDENTS], hw5[STUDENTS], hw6[STUDENTS], hw7[STUDENTS];
    int mid1[STUDENTS], mid2[STUDENTS];
    int final[STUDENTS];
    int extra[STUDENTS];
    float total[STUDENTS];

    getData(student, pass, hw1, hw2, hw3, hw4, hw5, hw6, hw7,
            mid1, mid2, final, extra);
    calcAvg(total);
    printTable(student, total);

system("pause");
return 0;
}

int getData(int *student, char *pass, int *hw1, int *hw2, int *hw3, int *hw4,
             int *hw5, int *hw6, int *hw7, int *mid1, int *mid2, int *final,
             int *extra)
{
    FILE *fpIn;
    int i;

    fpIn = fopen("data.txt", "r");
    if (!fpIn)
    {
        printf("File does not exist.");
        system("pause");
        exit (101);
    }

    for (i=0; i<STUDENTS; i++)
    {
        fscanf(fpIn, "%d", &student[i]);
        fscanf(fpIn, "%c", &pass[i]);
        fscanf(fpIn, "%d %d %d %d %d %d %d", hw1[i], hw2[i], hw3[i], hw4[i], hw5[i], hw6[i], hw7[i]);
        fscanf(fpIn, "%d %d", mid1[i], mid2[i]);
        fscanf(fpIn, "%d %d", final[i], extra[i]);
    }

    return;
}

float calcAvg(float *total)
{
    int hwtotal[STUDENTS], midtotal[STUDENTS];
    int i;

    for (i=0; i<STUDENTS; i++)
    {
        hwtotal[i] = hw1[i]+ hw2[i]+hw3[i]+hw4[i]+hw5[i]+hw6[i]+hw7[i];
        midtotal[i] = mid1[i]+mid2[i];
        total[i] = (hwavg[i]+midavg[i]+final[i]+extra[i])/3;
    }

    return total;
}

float printTable(int student, float total)
{
    int i;

    printf("==== ======= =======\n");
    printf(" ID   Score   Grade\n");
    printf("==== ======= =======\n");

    for(i=0; i<STUDENTS; i++)
    {
        printf("%d .1f  ", student[i], total[i]);

        if (total>90)
        printf("A\n");
        else if(total>80);
        printf("B\n");
        else if (total>70);
        printf("C\n");
        else if (total>60);
        printf("D\n");
        else
        printf("F\n");
    }

    return;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:25:46.523

我建议您创建一个结构来封装学生的所有信息，而不是为您存储的每个数据使用不同的数组。

```
struct{ 
   int studentId;
   char pass;
   int hw[7]
   int mid[2];
   int final;
   int extra;
   float total;
} student;

 student mystudents[STDENTS]; 
```

无论您的问题是什么，使用更紧凑的数据结构将更容易检测到，如果必须进行任何更改，这些数据结构也将变得容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T19:38:06.423

好吧，您没有描述您的问题，但看起来这部分可能会导致问题。

```
int getData(...) {
    ...
    fscanf(fpIn, "%d %d %d %d %d %d %d", hw1[i], hw2[i], hw3[i], hw4[i], hw5[i], hw6[i], hw7[i]);
    fscanf(fpIn, "%d %d", mid1[i], mid2[i]);
    fscanf(fpIn, "%d %d", final[i], extra[i]);
    ...
} 
```

您将`int`s 传递给`fscanf`期望`int *`s 的对象。你早先做了正确的事

```
fscanf(fpIn, "%d", &student[i]);
fscanf(fpIn, "%c", &pass[i]); 
```

# sharepoint - 从 SharePoint 工作流调用控制台应用程序

> ID：11871436
> 
> 赞同：0
> 
> 时间：2012-08-08T19:07:20.993
> 
> 标签：sharepoint, sharepoint-2010, ms-word, workflow

我需要从 SharePoint 工作流中打开一个 Word 文档，并将其打印到特定的打印机托盘。我首先尝试使用 Word.Interop 创建一个 Word 应用程序实例，但是我的 doc 对象总是返回 null。我已经读到这不是 WordInterop 的受支持使用。所以现在我正在寻找替代品

我编写了一个简单的控制台应用程序，它接受 word 文档、打印机名称和托盘号作为参数。控制台应用程序在命令提示符下运行良好，但我无法从 SharePoint 工作流 CodeActivity 调用它

```
string urlWord = GetwordDocument(printType);

System.Diagnostics.Process prcs = new System.Diagnostics.Process();
prcs.StartInfo.FileName = @"c:\DocxPrint2Tray.exe";
prcs.StartInfo.Arguments = String.Format(" \"{0}\" \"{1}\" \"{2}\" ",urlWord,  printerName, printerTray);
prcs.StartInfo.UseShellExecute = false;
prcs.StartInfo.RedirectStandardOutput = true;
prcs.Start();

string prcsOut = prcs.StandardOutput.ReadToEnd();
prcs.WaitForExit(); 
```

代码似乎挂在*prcs.StandardOutput.ReadToEnd()*行。SharePoint 工作流是否支持调用外部进程？对任何代码建议和替代解决方案开放。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-14T11:55:17.897

这里的关键是 PowerShell。遗憾的是，SharePoint 没有将 PS 集成到工作流中，但是有第三方工具可以做到。（我们创建了一个本土的来避免许可。）一旦您拥有 PS 供您使用，您就可以从包括调用控制台应用程序在内的工作流程中做任何事情。

以下是我们如何集成 PS。创建一个名为 System Tasks 的任务列表。当工作流启动时，将条目写入此列表；该条目实际上是一个事件。该条目应包含对 PS 有用的足够信息。有一个计划的 PS 作业在某个时间间隔运行并读取/处理系统任务列表。它应该将条目视为要处理的消息。不同的条目将携带不同的数据：

```
EVENT-X Y Z 
```

引导节点`EVENT-X`是您的事件消息。 `Y`还有`Z`你的论点、参数等等。显然，您可以根据需要传递尽可能多的信息。调度的 PS 作业将不同的事件分派给不同的 PS 脚本进行处理，然后在完成后检查系统任务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:18:22.480

我作弊了....我最后只是将文件复制到一个文件夹中，并编写了一个 Windows 服务来监视文件夹并打印文件。不是我喜欢的解决方案，但紧接着你只需要完成工作。

# wordpress - 在特定类别页面下包含特定评论和评论区

> ID：11871437
> 
> 赞同：0
> 
> 时间：2012-08-08T19:07:31.977
> 
> 标签：wordpress

我已经按 slug 名称为类别创建了一个页面，以插入该类别的帖子。现在我想在该页面的底部有评论和评论区。怎么做 ？我可以通过 wordpress 功能在该页面中添加其中一个帖子评论和评论区吗？谢谢 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:15:36.790

```
<?php wp_list_comments( $args ); ?> 
```

资料来源：Wordpress 法典：[http ://codex.wordpress.org/Function_Reference/wp_list_comments](http://codex.wordpress.org/Function_Reference/wp_list_comments)

# perl - Perl 单行的包装脚本（用于从文本文件中提取列）

> ID：11871441
> 
> 赞同：0
> 
> 时间：2012-08-08T19:07:37.437
> 
> 标签：perl, shell

我有这个用于从文本文件中提取列的 Perl 单行器，我在这个论坛中找到了它。

```
perl -ane "print qq(@F[0,1,3,4]\n)" ./folder/input.txt 
    > ./short_files/output.txt 
```

我需要在 352 个具有名称的输入文件上运行它`input1.txt, input2.txt,...,input352.txt`并生成 352 个具有名称的输出文件`output1.txt, output2.txt,..., output352.txt`。

任何人都可以帮助我使用包装器代码，以便我可以在循环中运行 Perl 单行程序，输入和输出文件名每次都在更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:35:46.723

您似乎想要一个 Perl 解决方案：

```
for my $in_file (glob('input*.txt')) {
   ( my $out_file = $in_file ) =~ s/input/output/;

   open(my $fh_in, '<', $in_file)
      or die("Can't open \"$in_file\": $!\n");

   open(my $fh_out, '>', $out_file)
      or die("Can't create \"$out_file\": $!\n");

   while (<$fh_in>) {
      my @F = split;
      print $fh_out "@F[0,1,3,4]\n";
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T19:15:01.950

你在Unix吗？你有`bash`吗？

```
for i in {1..352} ; do
    perl -ale ... ./folder/input$i.txt > ./short_files/output$i.txt
done 
```

# php - cakephp jquery ui父页面刷新

> ID：11871444
> 
> 赞同：0
> 
> 时间：2012-08-08T19:07:41.423
> 
> 标签：php, javascript, jquery-ui, cakephp, modal-dialog

我正在使用 jquery 从 cakephp 的视图中显示模式对话框以提交数据。问题是，在我提交数据后，原始页面（在对话框打开之前）被刷新了。我应该怎么做，这样它就不会刷新父页面？例如：

admin_add.ctp（这是文章控制器的视图）

```
<div>
//...other code
<?php
    echo '<div class="addNewCategory">';
    echo 'add';
    echo '</div>';

?>
//...other code
</div>

<div class="dialog-form" title='Create new Category'>
</div>

<script type="text/javascript">
        $('.dialog-form').dialog({
           autoOpen: false,
           title: 'New Category',
           modal: true,
           close: function() {

           }
        });

        $('.addNewCategory').click(function() {
            $('.dialog-form').load('/admin/categories/addmodal').dialog('open');
        });
</script> 
```

类别控制器.ctp

```
public function admin_addmodal() {
    $this->layout=null;

    if ($this->request->is('post')) {
        $this->Category->create();
        if ($this->Category->save($this->request->data)) {
            $this->Session->setFlash(__('The category has been saved'));
            $this->redirect(array('action' => 'index'));
        } else {
            $this->Session->setFlash(__('The category could not be saved. Please, try again.'));
        }
    }
} 
```

最后一个是模态视图 admin_addmodal.ctp

```
<h2><?php echo __('New Category');?></h2>
<div id="content_wrap">
    <div class="categories form">
    <?php echo $this->Form->create('Category');?>
        <?php
            echo $this->Form->input('name');
        ?>
    <?php echo $this->Form->end(__('Submit'));?>
    </div>
</div> 
```

所以，一般来说它是有效的。我单击“添加”，它将触发显示 admin_addmodal.ctp 的模式对话框，当我在那里填写数据并单击提交时。数据已提交，模式对话框已关闭。问题是在那之后，原始页面被刷新（如果我将它重定向到原始页面，即 admin/article/）或发送到“/admin/categories/”。

有谁知道如何解决这个问题？

# html - 从 Rails 中的 Tumblr 正文中提取第一张图片

> ID：11871446
> 
> 赞同：0
> 
> 时间：2012-08-08T19:07:47.953
> 
> 标签：html, ruby-on-rails, json, parsing, tumblr

我正在构建一个带有外部 Tumblr 博客的网站，并使用 JSON 从博客中提取信息并将其放置在网站上。尝试将 Tumblr {body} 中的图像作为与实际文本帖子分开的实体放入我的网站时，我遇到了一个问题，用于样式/ CSS 目的。HTML 中的标签存在，但我似乎无法将其拉出较大的

标签。这是我从 Tumblr 中提取信息的代码：

```
<%= tumblr.each do |post| %>
                <div class="blog-item span4">
                  <span class="date"><%= post['date'] %></span>
                  <h3> <%= post['title'] %> </h3>
                  <div class="image">
                   <%= image_tag "http://media.tumblr.com/tumblr_m8ci2mGzND1ruwmhv.jpg" %>
                  </div>
                  <p><%= post['body'].html_safe %></p>
                </div><!-- .blog-item span4 -->
<%end%> 
```

谁能帮我从带有图片的纯文本帖子中解析图像？非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T09:16:57.777

如果约定遵循[Tumblr API](http://www.tumblr.com/docs/en/api)那么我建议它是`photo-url`

（注：未测试）

# iphone - iPhone：TableView 添加数据

> ID：11871447
> 
> 赞同：0
> 
> 时间：2012-08-08T19:07:48.933
> 
> 标签：iphone, objective-c, xcode

我正在制作具有表格视图的应用程序，但我无法在表格视图中添加数据

我在 .h 文件中名为 NewTable 的 .xip 文件中有表格视图，这是我在 .m 文件中使用它的代码（listData 它是数组）：

```
- (void)viewDidLoad{
    [super viewDidLoad];
    [self TestTable];
}

-(void)TestTable{
    NSArray *array = [[NSArray alloc] initWithObjects:@"Vishal",@"Vinod",@"Sachin",@"Nilesh",@"Balu",@"Amrita",
                      @"susho",@"Akash",@"Nil",@"Lop",@"Koi",@"Absoulate",@"Dwalin",
                      @"Fili",@"Kili",@"Oin",@"Gloin",@"Bifur",@"Bofur",@"Bombur",nil];

    self.listData = array;
    [array release];
    self.listData= array;

    [self.NewTable reloadData];
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section { 
    return [self.listData count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *SimpleTableIdentifier = @"SimpleTableIdentifier";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:
                             SimpleTableIdentifier];
    if(cell == nil){
        cell = [[UITableViewCell alloc] autorelease];
    }
    NSUInteger row = [indexPath row];
    cell.textLabel.text = [listData objectAtIndex:row];
    return cell;
} 
```

{{{{{{{{{{{当我添加nslog时`cellForRowAtIndexPath`它不会在consol中打印任何东西！}}}}}}}}}} {{{{{{{{{{{当我添加nslog`cellForRowAtIndexPath`不会在 consol 中打印任何内容！}}}}}}}}}} {{{{{{{{{{{另外，当我添加 nslog 时，`cellForRowAtIndexPath`它不会在 consol 中打印任何内容！}}}}}} }}}}}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:33:03.810

这是我通常看到的用于初始化数据的内容。

```
-(void)viewDidLoad {
    self.listData = [[NSMutableArray alloc] initWithObjects:@"Vishal",@"Vinod",...,nil];
    [super viewDidLoad];
} 
```

虽然，我认为您的问题是分配给不再保留的数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T19:34:15.227

如果你正在使用`UIViewController`而不是`UITableViewController`你需要确保你的 viewController 符合`UITableViewDataSource`和`UITableViewDelegate`

```
@interface MyViewController : UIViewController <UITableViewDataSource, UITableViewDelegate> 
```

接下来，您需要将这个视图控制器实际设置为 tableView 的 dataSource 和委托。
您可以通过将鼠标从 tableView 拖动到文件所有者（即 MyViewController）来使用 IB 执行此操作，
或者在代码中执行此操作：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    self.NewTable.dataSource = self;
    self.NewTable.delegate = self;
} 
```

同样在`cellForRowAtIndexPath`，换行

```
cell = [[UITableViewCell alloc] autorelease]; 
```

和

```
cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:SimpleTableIdentifier] autorelease]; 
```

# c++ - 结构指针的区别

> ID：11871450
> 
> 赞同：2
> 
> 时间：2012-08-08T19:07:54.660
> 
> 标签：c++, c

```
struct node
{
 int data;
 struct node *next;
}; 
```

以下两个功能有什么区别：

```
void traverse(struct node *q)
{ } 
```

和

```
void traverse(struct node **q)
{ } 
```

如何从主程序调用上述函数？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-08T19:09:27.653

第一个参数列表传递一个指向 a 的指针`struct node`。这允许您更改`struct node`函数主体中的 。例如：

```
// this will change the structure, caller will see the changes:
q->data = newValue;

// but this will only change q in the function, caller WON'T see the NULL:
q = NULL; 
```

第二个参数列表将*指针传递给指向 a 的*指针`struct node`。这使您不仅可以更改`struct node`函数体中的 ，还可以更改指针*指向的*。例如：

```
// this will change the structure, caller will see the changes:
(*q)->data = newValue;

// This will change the pointer, caller will now see a NULL:
*q = NULL: 
```

至于调用函数的两个版本，从`main`或以其他方式：给定一个指向您的结构的指针：`struct node *arg;`，

*   你可以这样调用第一个版本：`traverse(arg);`
*   第二个版本是这样的：`traverse(&arg);`

或者，给定一个声明为 的结构`struct node arg;`，您可以创建一个指向它的指针：

```
struct node arg;
struct node *ptrToArg = &arg; 
```

进而：

*   你可以这样调用第一个版本：`traverse(&arg);`
*   第二个版本是这样的：`traverse(&ptrToArg);`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-08T19:12:15.377

```
void traverse(struct node *q)
{ } 
```

接受一个指向结构的指针。你可以这样称呼它：

```
struct node A;
traverse(&A); 
```

这个功能

```
void traverse(struct node **q)
{ } 
```

获取指向结构的指针的指针。你可以这样称呼它：

```
struct node A;
struct node* Aptr = &A;
traverse(&Aptr); 
```

如果您想修改传递给函数的原始变量，传递指针很有用，例如，如果您有这样的函数：

```
void setToNull(struct node ** q){
   *q = NULL;
} 
```

然后你可以这样做：

```
struct node A;
struct node* Aptr = &A;
setToNull(&Aptr);
// Aptr is now equal to NULL. 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-08T19:10:27.110

```
 void traverse(struct node *q) 
```

只需传递一个指向函数的指针。

```
 void traverse(struct node **q) 
```

将指针传递给指针，因此您可以更改原始指针。它是 C++ 通过引用传递指针的 C 等效项。在 C++ 中，你可以这样做：

```
 void traverse(node *& q) 
```

你可以称它们为：

```
 struct node* q;

 //...
 traverse(q); //calls first version
 traverse(&q);//calls second version 
```

# c# - 无法让 XPATH 与 Html Agility Pack 一起使用

> ID：11871451
> 
> 赞同：1
> 
> 时间：2012-08-08T19:08:29.620
> 
> 标签：c#, .net, xpath, html-agility-pack

我正在尝试通过使用 firebug 获取 XPATH 值来抓取 Wikipedia 上的“今日精选文章”。

![在此处输入图像描述](../Images/2977049822afee638a9a2da54c281451.png)

然后将其粘贴到我的代码中：

```
string result = wc.DownloadString("http://en.wikipedia.org/wiki/Main_Page");

            HtmlAgilityPack.HtmlDocument doc = new HtmlAgilityPack.HtmlDocument();

            doc.LoadHtml(result);

            var featuredArticle = doc.DocumentNode.SelectSingleNode("/html/body/div[3]/div[3]/div[4]/table[2]/tbody/tr/td/table/tbody/tr[2]/td/div/p"); 
```

但是，featuredArticle 始终返回 null。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T20:05:39.817

因为 Firebug 显示像 Firefox 这样的 XPath 制作了 Html，所以这可能是也可能不是来自服务器的 Html。此外，Firebug 的路径是绝对的，每一个微小的变化都可能打破它。

更简单的方法是只查看 Html，您要查找的 p-Tag 位于带有 id 的 div 中`mp-tfa`，因此更容易让 XPath 查找 div 并获取第一个 p 内部。

像这样：

```
var wc = new WebClient();
var doc = new HtmlDocument();
doc.Load(wc.OpenRead("http://en.wikipedia.org/wiki/Main_Page"));
var featuredArticle = doc.DocumentNode.SelectSingleNode("//div[@id='mp-tfa']/p");
Console.WriteLine(featuredArticle.InnerText); 
```

学习如何使用 XPath 的最佳地点是[w3schools.com](http://www.w3schools.com/xpath/)。

或者你可以使用 Linq，虽然我觉得 XPath 更清晰一些。

```
var featuredArticle=   doc.DocumentNode.Descendants("div")
 .First(n => n.Id == "mp-tfa")
 .Descendants("p").FirstOrDefault(); 
```

# javascript - Web Workers 能否使用 100% 的多核 CPU？

> ID：11871452
> 
> 赞同：30
> 
> 时间：2012-08-08T19:08:29.947
> 
> 标签：javascript, multithreading, html, web-worker

我一直试图找出网络工作者在分配处理器负载方面的能力。我还没有找到任何可以让我的四核 2600k 甚至达到 50% 的演示，更不用说 100% 了。

这是我试图最大化我的 CPU 的网络工作者演示：

[http://nerget.com/rayjs-mt/rayjs.html](http://nerget.com/rayjs-mt/rayjs.html)

（如果您使用 firebug /chrome-inspect-element 进入页面的 HTML 并使画布更大，您可以使其光线跟踪成为更大的图像 - 我将我的设置为 1920 x 1080）

即使选择了 4、8、16 名工作人员，我的 CPU 利用率也无法超过每个核心 25% 左右。

有谁知道您是否可以通过网络工作者使用 100% 的 CPU？

（我使用的是谷歌浏览器。）

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-08-08T19:14:26.343

这在我的 2500K 上使用了 100%：

```
var code = "while(true){}";
var URL = window.webkitURL || window.URL;
var bb = new Blob([code], {type : 'text/javascript'});

code = URL.createObjectURL(bb);

new Worker(code);
new Worker(code);
new Worker(code);
new Worker(code); 
```

[http://jsfiddle.net/MTJ27/81/](http://jsfiddle.net/MTJ27/81/)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-06-11T21:40:09.877

我已经使用新的 blob 构造函数重写了 Esailija 的答案。BlobBuilder 现在已过时，因此您必须改用 Blob()，请参阅此处了解详情：http: [//updates.html5rocks.com/2012/06/Don-t-Build-Blobs-Construct-Them](http://updates.html5rocks.com/2012/06/Don-t-Build-Blobs-Construct-Them)

```
window.URL = window.URL || window.webkitURL;

var blob = new Blob(["while(true){}"], {type: 'text/javascript'});

code = window.URL.createObjectURL(blob);

new Worker(code);
new Worker(code);
new Worker(code);
new Worker(code); 
```

[http://jsfiddle.net/MTJ27/15/](http://jsfiddle.net/MTJ27/15/)

# excel - 如何在 Excel 2010 中引用动态可扩展/可收缩的 Excel 表格？

> ID：11871455
> 
> 赞同：1
> 
> 时间：2012-08-08T19:08:36.903
> 
> 标签：excel, excel-formula, excel-2010

我们的系统使用模板电子表格，每个模板有两张表，Data 和 RawData。RawData 包含由应用程序填充数据的 excel 表。用户负责根据 RawData 表中的数据创建他们想要的报告（在数据表上）。现在，表中的数据可以变化，一个表今天可以有 5 行，第二天可以有 10 行。

如果在 RawData 上我有 Table1 和 column1，我将如何引用数据表上此列中的数据，以说明 Table1 中数据的增长/收缩？

我以为我可以使用数组公式和引用并使用数组公式 {=Table1[column1]} 但是当我定义它时，我总是必须指定固定数量的行。似乎无法指定数组公式将扩展到的行数/列数并从公式中派生该数字，类似于动态范围的工作方式。如果我也选择了可能的行，则数组公式会将 #NA 值放在超出可用项目的单元格中。

谢谢

PS。使用 VBA 不是一种选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T17:22:47.530

目前，不可能做我想做的事，除非我求助于数据透视表或利用一些假设（使用表不能超过某个已知行数的知识）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T16:12:45.827

您是否尝试过 NamedRange 公式条目中的 OFFSET 函数？您可以将表格放在自己的工作表中并使用它。您只需要确保您的高度和宽度参考中始终包含数据*。

```
=OFFSET(Reference, Rows, Cols, Height, Width)
Reference = Start of your table
Rows = 0 - no offset
Cols = 0 - no offset
Height = COUNTA($A:$A) - counts the number of entries in column A
Width = COUNTA($6:$6) - counts the number of entries in row 6 
```

如果我将此命名范围称为“testrange”，那么我可以去一个单元格并说它`=rows(testrange)`会返回动态范围的值

*您可以像这样“MAX(1,COUNTA($A:$A))”将您的 COUNTA 包装在 MAX 中，以防止表中没有数据时出现引用错误

# c++ - 未解析的外部符号 cvFindChessboardCorners()

> ID：11871458
> 
> 赞同：0
> 
> 时间：2012-08-08T19:08:52.257
> 
> 标签：c++, opencv, camera-calibration

我已经包含了`cvFindChessboardCorners()`声明的头文件和其他一些头文件，但它仍然不起作用。如何定义符号？不知道这里发生了什么？

如果需要更多信息，请告诉我。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:31:39.347

您必须将 OpenCV 库添加到您的项目中。（VS2010的说明）

首先在下面添加路径

项目 -> 配置属性 -> VC++ 目录 -> 库目录

对于我的系统，它是 D:\OpenCV\build\x64\vc10\lib

然后在 Linker -> Input -> Additional Dependencies 下添加

opencv_calib3d231.lib opencv_contrib231.lib opencv_core231.lib opencv_features2d231.lib opencv_flann231.lib opencv_haartraining_engine.lib opencv_highgui231.lib opencv_imgproc231.lib opencv_legacy231.lib opencv_ml231.lib opencv_objdetect231.lib opencv31_ts231.lib opencv_video2.lib

你应该很高兴。

# c# - 为什么下载时文件类型会改变？

> ID：11871461
> 
> 赞同：1
> 
> 时间：2012-08-08T19:09:02.383
> 
> 标签：c#, asp.net

我已经 `Response.ContentType = "application/octet-stream";`在 Downloads.aspx 页面的 Page_Load 处理程序中设置了 。当我尝试下载 .gif 文件时，它工作正常。但在 .jpg 文件的情况下，对话框显示文件类型为“application/octet-stream”，下载的文件只是一个不像预期的 .jpg 的文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T19:12:01.103

尝试为每种文件类型设置明确的内容类型。

```
switch (fileExtension)
{
    case "gif": Response.ContentType = "image/gif"; break; 
    case "jpeg": Response.ContentType = "image/jpg"; break; 
    case "jpg": Response.ContentType = "image/jpg"; break; 
    case "png": Response.ContentType = "image/png"; break; 

    default: Response.ContentType = "application/octet-stream"; break; 
} 
```

请参阅以下链接以获取 mime 类型参考：

```
http://www.freeformatter.com/mime-types-list.html
https://github.com/cymen/ApacheMimeTypesToDotNet/blob/master/ApacheMimeTypes.cs 
```

# ruby-on-rails - Rails Active Record 项目分区

> ID：11871463
> 
> 赞同：2
> 
> 时间：2012-08-08T19:09:06.507
> 
> 标签：ruby-on-rails, ruby, arrays, activerecord

所以，这是一个更容易的问题。我有一个像这样的活动记录对象：

```
Item
  --id
  --attribute 
```

我需要通过属性键拆分一个“项目”数组，所以我想要像这样拆分各种数组。

```
[<#Item :id => 1, :attribute => 1>,<#Item :id => 4, :attribute => 1>,<#Item :id => 7, :attribute => 1>]
[<#Item :id => 2, :attribute => 2>,<#Item :id => 5, :attribute => 2>,<#Item :id => 8, :attribute => 2>]
[<#Item :id => 3, :attribute => 3>,<#Item :id => 6, :attribute => 3>,<#Item :id => 9, :attribute => 3>] 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:48:16.693

这应该为您提供一个数组数组，其中每个子数组具有相同的`attribute`：

```
Items.all.group_by(&:attribute).values 
```

编辑：由于您使用的是`ActiveRecord`，您可以在数据库中进行分组。我`DataMapper`自己更像一个人，但这应该大致是这样的：

```
Items.find(:all, group: 'attribute') 
```

# r - 以简单的方式在保持原始顺序的同时聚合数据框

> ID：11871464
> 
> 赞同：8
> 
> 时间：2012-08-08T19:09:06.540
> 
> 标签：r, aggregate, data.table

我在聚合数据框时遇到了一些麻烦，同时保持组的原始顺序（基于数据框中首次出现的顺序）。我已经设法做到了，但希望有一种更简单的方法来解决它。

这是要处理的示例数据集：

```
set.seed(7)
sel.1 <- sample(1:5, 20, replace = TRUE)     # selection vector 1
sel.2 <- sample(1:5, 20, replace = TRUE)
add.1 <- sample(81:100)                      # additional vector 1
add.2 <- sample(81:100)
orig.df <- data.frame(sel.1, sel.2, add.1, add.2) 
```

需要注意的几点：有两个选择列来确定数据如何组合在一起。他们将是相同的，并且他们的名字是已知的。我只在此数据中添加了两列，但可能还有更多。我给出了以 'sel' 和 'add' 开头的列名，以便更容易理解，但实际数据有不同的名称（所以虽然`grep`技巧很酷，但在这里它们不会有用）。

我要做的是根据“sel”列将数据框聚合成组，并将所有“添加”列加在一起。这很简单，使用`aggregate`如下：

```
# Get the names of all the additional columns
all.add <- names(orig.df)[!(names(orig.df)) %in% c("sel.1", "sel.2")]
aggr.df <- aggregate(orig.df[,all.add], 
                     by=list(sel.1 = orig.df$sel.1, sel.2 = orig.df$sel.2), sum) 
```

问题是结果是按“sel”列排序的；我希望根据每个组在原始数据中的首次出现对其进行排序。

这是我完成这项工作的最佳尝试：

```
## Attempt 1
# create indices for each row (x) and find the minimum index for each range
index.df <- aggregate(x = 1:nrow(orig.df),
                      by=list(sel.1 = orig.df$sel.1, sel.2 = orig.df$sel.2), min)
# Make sure the x vector (indices) are in the right range for aggr.df
index.order <- (1:nrow(index.df))[order(index.df$x)]
aggr.df[index.order,]

## Attempt 2
# get the unique groups. These are in the right order.
unique.sel <- unique(orig.df[,c("sel.1", "sel.2")])
# use sapply to effectively loop over data and sum additional columns.
sums <- t(sapply(1:nrow(unique.sel), function (x) {
    sapply(all.add, function (y) {
        sum(aggr.df[which(aggr.df$sel.1 == unique.sel$sel.1[x] & 
                          aggr.df$sel.2 == unique.sel$sel.2[x]), y])
        })
}))
data.frame(unique.sel, sums) 
```

虽然这些给了我正确的结果，但我希望有人能指出一个更简单的解决方案。如果该解决方案适用于标准 R 安装附带的软件包，那将是更可取的。

我查看了`aggregate`and的文档`match`，但找不到答案（我想我希望有类似的“keep.original.order”参数`aggregate`）。

任何帮助将非常感激！

* * *

更新：（以防有人偶然发现）

这是我尝试了几天后能找到的最干净的方法：

```
unique(data.frame(sapply(names(orig.df), function(x){
    if(x %in% c("sel.1", "sel.2")) orig.df[,x] else
    ave(orig.df[,x], orig.df$sel.1, orig.df$sel.2, FUN=sum)},
simplify=FALSE))) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T11:38:29.493

它在[data.table](http://datatable.r-forge.r-project.org/)中简短而简单。默认情况下，它以首次出现的顺序返回组。

```
require(data.table)
DT = as.data.table(orig.df)
DT[, list(sum(add.1),sum(add.2)), by=list(sel.1,sel.2)]

    sel.1 sel.2  V1  V2
 1:     5     4  96  84
 2:     2     2 175 176
 3:     1     5 384 366
 4:     2     5  95  89
 5:     4     1 174 192
 6:     2     4  82  87
 7:     5     3  91  98
 8:     3     2 189 178
 9:     1     4 170 183
10:     1     1 100  91
11:     3     3  81  82
12:     5     5  83  88
13:     2     3  90  96 
```

这对于大数据来说会很快，因此如果您发现速度问题，以后无需更改代码。以下替代语法是传递要分组的列的最简单方法。

```
DT[, lapply(.SD,sum), by=c("sel.1","sel.2")]

    sel.1 sel.2 add.1 add.2
 1:     5     4    96    84
 2:     2     2   175   176
 3:     1     5   384   366
 4:     2     5    95    89
 5:     4     1   174   192
 6:     2     4    82    87
 7:     5     3    91    98
 8:     3     2   189   178
 9:     1     4   170   183
10:     1     1   100    91
11:     3     3    81    82
12:     5     5    83    88
13:     2     3    90    96 
```

或者，`by`也可能是一个逗号分隔的列名字符串：

```
DT[, lapply(.SD,sum), by="sel.1,sel.2"] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T19:29:09.847

有点难读，但它给了你想要的东西，我添加了一些评论来澄清。

```
# Define the columns you want to combine into the grouping variable
sel.col <- grepl("^sel", names(orig.df))
# Create the grouping variable
lev <- apply(orig.df[sel.col], 1, paste, collapse=" ")
# Split and sum up
data.frame(unique(orig.df[sel.col]),
           t(sapply(split(orig.df[!sel.col], factor(lev, levels=unique(lev))),
                    apply, 2, sum))) 
```

输出看起来像这样

```
 sel.1 sel.2 add.1 add.2
1      5     4    96    84
2      2     2   175   176
3      1     5   384   366
5      2     5    95    89
6      4     1   174   192
7      2     4    82    87
8      5     3    91    98
10     3     2   189   178
11     1     4   170   183
14     1     1   100    91
17     3     3    81    82
19     5     5    83    88
20     2     3    90    96 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-03-19T10:41:22.697

寻找相同问题的解决方案，我发现了一个使用聚合（）的新解决方案，但首先将选择变量转换为您想要的顺序的因素。

```
all.add <- names(orig.df)[!(names(orig.df)) %in% c("sel.1", "sel.2")]

# Selection variables as factor with leves in the order you want
orig.df$sel.1 <- factor(orig.df$sel.1, levels = unique(orig.df$sel.1))
orig.df$sel.2 <- factor(orig.df$sel.2, levels = unique(orig.df$sel.2))

# This is ordered first by sel.1, then by sel.2
aggr.df.ordered <- aggregate(orig.df[,all.add], 
                             by=list(sel.1 = orig.df$sel.1, sel.2 = orig.df$sel.2), sum) 
```

输出是：

```
 newvar add.1 add.2
1     1 1   100    91
2     1 4   170   183
3     1 5   384   366
4     2 2   175   176
5     2 3    90    96
6     2 4    82    87
7     2 5    95    89
8     3 2   189   178
9     3 3    81    82
10    4 1   174   192
11    5 3    91    98
12    5 4    96    84
13    5 5    83    88 
```

要将其排序为两个变量的每个组合的首次出现，您需要一个新变量：

```
# ordered by first appearance of the two variables (needs a new variable)
orig.df$newvar <- paste(orig.df$sel.1, orig.df$sel.2)
orig.df$newvar <- factor(orig.df$newvar, levels = unique(orig.df$newvar))

aggr.df.ordered2 <- aggregate(orig.df[,all.add], 
                              by=list(newvar = orig.df$newvar,
                                      sel.1 = orig.df$sel.1, 
                                      sel.2 = orig.df$sel.2), sum) 
```

这给出了输出：

```
 newvar sel.2 sel.1 add.1 add.2
1     5 4     4     5    96    84
2     5 5     5     5    83    88
3     5 3     3     5    91    98
4     2 4     4     2    82    87
5     2 2     2     2   175   176
6     2 5     5     2    95    89
7     2 3     3     2    90    96
8     1 4     4     1   170   183
9     1 5     5     1   384   366
10    1 1     1     1   100    91
11    4 1     1     4   174   192
12    3 2     2     3   189   178
13    3 3     3     3    81    82 
```

使用此解决方案，您无需安装任何新软件包。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-05-16T05:04:02.400

不确定该解决方案对于大型数据集的速度和存储容量等如何，但我认为这是解决此问题的一种非常简单的方法。

```
# Create dataframe
x <- c("C", "C", "A", "A", "A","B", "B")
y <- c(5, 6, 3, 2, 7, 8, 9)
df <- data.frame(x, y)
df 
```

原始数据框：

```
 x y
1 C 5
2 C 6
3 A 3
4 A 2
5 A 7
6 B 8
7 B 9 
```

解决方案：

```
# Add column with the original order
order <- seq(1:length(df$x))
df$order <- order

# Aggregate
# use sum for column Y (the variable you want to aggregate according to X)
df1 <- aggregate(y~x,data=df,FUN=sum)
# use mean for column 'order'
df2 <- aggregate(order~x, data=df,FUN=mean)

# Add the mean of order values to the dataframe
df <- df1
df$order <- df2$order

# Order the dataframe according the the mean of order values
df <- df[order(df$order),]
df 
```

具有相同顺序的聚合数据框：

```
 x  y order
3 C 11   1.5
1 A 12   4.0
2 B 17   6.5 
```

# mysql - 删除具有两个重复字段但没有重复 ID 的 MySQL 行

> ID：11871469
> 
> 赞同：1
> 
> 时间：2012-08-08T19:09:32.137
> 
> 标签：mysql, sql, duplicates

抱歉，我意识到我的标题令人困惑。请让我解释一下。

我有一个看起来像这样的数据库：

```
| i | a | b |
| 1 | 5 | 8 |
| 2 | 3 | 3 |
| 3 | 3 | 6 |
| 4 | 5 | 8 |
| 5 | 1 | 1 |
| 6 | 3 | 3 | 
```

`i`ID在哪里`a`和`b`是另外两个字段。正如您在上面看到的，ID 2 和 ID 6 都具有`a = 3`和`b = 3`。ID 1 和 ID 4 也是如此，两者都有 5 for`a`和 8 for `b`。即使 ID 号不同，我仍然认为这些行是重复的，并且希望删除除一行之外的所有行。哪一个都没有关系，身份证号码不必改变以弥补差距（但我不反对）。

我会很高兴有一个查询将上述示例变为如下内容：

```
| i | a | b |          | i | a | b |
| 3 | 3 | 6 |          | 1 | 5 | 8 |
| 4 | 5 | 8 |    or    | 2 | 3 | 3 |
| 5 | 1 | 1 |          | 3 | 3 | 6 |
| 6 | 3 | 3 |          | 5 | 1 | 1 | 
```

不要犹豫，询问更多详细信息，并提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T19:12:28.033

```
delete from your_table
where i not in 
(
    select * from 
    (
      select min(i)
      from your_table
      group by a, b 
    ) x
) 
```

MySQL 无法从它选择的表中删除。这就是为什么我用`select * from () x`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T19:14:01.950

首先。清理完表后，在 a 和 b 列上放置一个备用键索引，以确保不会将更多重复记录添加到表中......但是，话虽如此，要删除最后输入的重复项，您需要

```
 Delete TableName
 From Tablename t
 Where id <> (Select Min(id) From TableName
             Where a = t.a and b = t.b) 
```

要删除除最后输入的重复项之外的所有重复项，请将 Min 更改为 Max

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T19:14:23.457

我喜欢这种方法，因为它为多种场景提供了解决方案（是否使用 pk，留下一个条目等）：

[http://www.4guysfromrolla.com/webtech/sqlguru/q051200-2.shtml](http://www.4guysfromrolla.com/webtech/sqlguru/q051200-2.shtml)

# ios - 在后台上下文中保存核心数据时出现 NSInternalInconsistencyException

> ID：11871470
> 
> 赞同：1
> 
> 时间：2012-08-08T19:09:49.230
> 
> 标签：ios, multithreading, core-data, nsmanagedobjectcontext

我已经阅读了关于这个错误的所有内容，但仍然无法确定它为什么会在我的应用程序中发生。

使用后台上下文保存多个 Core Data 对象时出现以下错误：

`*** Terminating app due to uncaught exception "NSInternalInconsistencyException", reason: "Failed to process pending changes before save. The context is still dirty after 100 attempts. Typically this recursive dirtying is caused by a bad validation method, -willSave, or notification handler.`

在下面的代码中，`ArticleManager`'s`addArticle`在主线程的循环中被调用。可能有 0-200 多篇文章要添加。此错误通常发生在文章计数 100-150 之间。

```
//ArticleManager.m

-(id)init
{
    ... //normal init stuff
    dispatch_queue_t request_queue = dispatch_queue_create("com.app.articleRequest", NULL);
}    

-(void) addArticle:(Article *)article withURLKey:(NSString *)url
{
    //check if exists
    if ([downloadedArticles objectForKey:url] == nil && article != nil)
    {
        //add locally
        [downloadedArticles setObject:article forKey:url];

        //save to core data
        SaveArticle *saveArticle = [[SaveArticle alloc] init];
        [saveArticle saveArticle:article withURL:url onQueue:request_queue];
    }
} 
```

```
//SaveArticle.m

@implementation SaveArticle

@synthesize managedObjectContext;
@synthesize backgroundContext;

-(id)init
{
    if (![super init]) return nil;

    AppDelegate *appDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];
    managedObjectContext = [appDelegate managedObjectContext];

    backgroundContext = [[NSManagedObjectContext alloc] init];
    [backgroundContext setPersistentStoreCoordinator:[managedObjectContext persistentStoreCoordinator]];

    return self;
}

-(void)saveArticle:(Article *)article withURL:(NSString *)url onQueue:(dispatch_queue_t)queue
{       
    //save persistently in the background
    dispatch_async(queue, ^{
        ArticleCache *articleCacheObjectModel = (ArticleCache *)[NSEntityDescription insertNewObjectForEntityForName:@"ArticleCache" inManagedObjectContext:backgroundContext];

        if (article != nil)
        {
            [articleCacheObjectModel setArticleHTML:article.articleHTML];
            [articleCacheObjectModel setUrl:url];

            NSError *error;

            //Save the background context and handle the save notification 
            [[NSNotificationCenter defaultCenter] addObserver:self
                                                     selector:@selector(backgroundContextDidSave:)
                                                         name:NSManagedObjectContextDidSaveNotification
                                                       object:backgroundContext];

            if(![backgroundContext save:&error]) //ERROR OCCURS HERE, after many saves
            {  
                //This is a serious error saying the record  
                //could not be saved. Advise the user to  
                //try again or restart the application.
            }

            [[NSNotificationCenter defaultCenter] removeObserver:self
                                                    name:NSManagedObjectContextDidSaveNotification
                                                  object:backgroundContext];

        }
    });
}

/* Save notification handler for the background context */
- (void)backgroundContextDidSave:(NSNotification *)notification {
    /* Make sure we're on the main thread when updating the main context */
    if (![NSThread isMainThread]) {
        [self performSelectorOnMainThread:@selector(backgroundContextDidSave:)
                               withObject:notification
                            waitUntilDone:NO];
        return;
    }

    /* merge in the changes to the main context */
    [self.managedObjectContext mergeChangesFromContextDidSaveNotification:notification];
}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:38:58.163

好的，所以阅读官方文档有点用处。

来自苹果（重点是我的）：

> 并发
> 
> Core Data 使用线程（或序列化队列）限制来保护托管对象和托管对象上下文（请参阅“Core Data 的并发性”）。这样做的结果是上下文假定默认所有者是分配它的线程或队列——这由调用其 init 方法的线程确定。**因此，您不应该在一个线程上初始化上下文，然后将其传递给另一个线程。相反，您应该将引用传递给持久存储协调器，并让接收线程/队列创建一个从中派生的新上下文。**如果使用 NSOperation，则必须在 main（对于串行队列）或 start（对于并发队列）中创建上下文。

所以我的问题是我在主线程上初始化了后台上下文，但随后使用 Grand Central Dispatch 通过`dispatch_async`它在后台线程上执行保存（使用在主线程上创建的上下文）。

我通过将上下文初始化添加到背景块来修复它：

```
-(void)saveArticle:(Article *)article withURL:(NSString *)url onQueue:(dispatch_queue_t)queue
{       
    //save persistently in the background
    dispatch_async(queue, ^{

        NSManagedObjectContext *backgroundContext = [[NSManagedObjectContext alloc] init];
        [backgroundContext setPersistentStoreCoordinator:[managedObjectContext persistentStoreCoordinator]];

        ArticleCache *articleCacheObjectModel = (ArticleCache *)[NSEntityDescription insertNewObjectForEntityForName:@"ArticleCache" inManagedObjectContext:backgroundContext];

        if (article != nil)
        {
            [articleCacheObjectModel setArticleHTML:article.articleHTML];
            [articleCacheObjectModel setUrl:url];

            NSError *error;

            //Save the background context and handle the save notification 
            [[NSNotificationCenter defaultCenter] addObserver:self
                                                     selector:@selector(backgroundContextDidSave:)
                                                         name:NSManagedObjectContextDidSaveNotification
                                                       object:backgroundContext];

            if(![backgroundContext save:&error])
            {  
                //This is a serious error saying the record  
                //could not be saved. Advise the user to  
                //try again or restart the application.
            }

            [[NSNotificationCenter defaultCenter] removeObserver:self
                                                            name:NSManagedObjectContextDidSaveNotification
                                                          object:backgroundContext];
        }
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T21:08:11.393

是的，如果您使用限制并发模型（这是您通过 init 获得的），那么您必须保证只在创建它的线程中使用 MOC。

您可以使用 NSPrivateQueueConcurrencyType 创建一个 MOC，然后使用

```
[moc performBlock:^{
}]; 
```

执行操作。它有自己的内部队列，并将在后台运行所有请求，与其他调用同步访问。

您可以使用 NSMainQueueConcurrencyType 将 MOC 绑定为仅在主线程上运行。

# android - 科尔多瓦应用程序未在 avd 中运行

> ID：11871475
> 
> 赞同：2
> 
> 时间：2012-08-08T19:10:19.637
> 
> 标签：android, cordova

我的科尔多瓦应用程序给了我错误：与服务器的连接不成功。（文件：///android_asset/www/index.html）在 android avd 上。它在我的设备上运行良好，但我想测试不同的 android 平台。请帮助。

# html - 为什么要使用除 div 之外的任何东西？

> ID：11871487
> 
> 赞同：5
> 
> 时间：2012-08-08T19:11:07.733
> 
> 标签：html, xhtml, web

在 HTML/XHTML 中，为什么要使用除 div 元素之外的其他元素？

它们是可以用来构建整个页面的基本块。当然，它们不会增加页面的语义，但 HTML 与语义无关，它与结构有关。我为什么要关心语义？

有什么想法吗？

**编辑：**所以声明“...HTML 与语义无关，它与结构有关。” 引起了一些骚动；它被认为是关于语义的，尽管 div 和 span（可能是最常见的元素）打破了这个规则。或许，一个更好的问题是问：HTML/XHTML 是否应该与语义有关*？*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T19:13:11.390

并非所有元素都应该是块级元素，并且需要为页面上的每个 div 指定 div 的类型是荒谬的。它也更容易阅读。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T19:19:41.507

两个重要原因：

1.  搜索引擎
2.  屏幕阅读器

搜索引擎根据其内容以及该内容的语义对页面进行排名。为您的内容添加适当的语义可以加强内容试图传达的意图，并允许搜索引擎对该内容赋予更高的价值。

屏幕阅读器还依赖于语义正确的内容。有关更多信息，请参阅[本文](http://www.accessibleculture.org/articles/2011/10/jaws-ie-and-headings-in-html5/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T19:15:44.007

各种电子邮件客户端支持不同的 HTML 子集，这些子集经常忽略外部样式表、浮动等。在许多情况下，您必须恢复到表格。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-08T19:27:16.770

看看你的建议的一个简单例子：

```
<div>
    <div>Hello</div>
    <div>this is a paragraph which contains some <div>stuff</div> that should not be in a div</div>
</div> 
```

现在，人类、浏览器、搜索引擎等是否更容易理解以下内容？

```
<div>
    <h1>Hello</h1>
    <p>this is a paragraph which contains some <span>stuff</span> that should not be in a div</p>
</div> 
```

有不同的元素是有原因的。除了样式的块和内联之外，标签会向页面添加大量信息，如果将其全部替换为 div 标签，则会丢失这些信息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-08T19:28:10.643

因为：

1.  最好为搜索引擎阅读。
2.  为人类阅读更好。
3.  最好为屏幕阅读器阅读。

使用语义 html 或在 div-hell 中烧毁！;-)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-08T19:14:46.503

再加上您的页面结构如何说明您页面上的内容。搜索引擎将比 h6 更重视 h1。它不仅可以显示您的数据，还可以描述您的数据。HTML5 会有更多的元素，所以你最好系好安全带。

# c# - 在数据注释的 ErrorMessage 属性中使用 html

> ID：11871495
> 
> 赞同：3
> 
> 时间：2012-08-08T19:11:26.787
> 
> 标签：c#, asp.net-mvc-3, data-annotations

任何人都知道是否可以执行以下操作：

```
public class User
{
    public Guid UserID { get; set; }

    [Required(ErrorMessage="A school selection is required.")]
    [Range(1, int.MaxValue, ErrorMessage="School not found.  Please contact support at <a href='mailto:support@mysite.com'>support@mysite.com</a>")]
    public int SchoolID { get; set; }

    // ... other properties
} 
```

并且没有`@Html.ValidationMessageFor(model => model.SchoolID)`对 HTML 进行编码？也许我需要为此制作一个自定义助手扩展？有没有更简单的方法？任何指导将不胜感激。如果辅助扩展是要走的路，我如何访问辅助扩展方法中的验证规则以确保 html 没有被编码？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:52:47.533

根据您需要使用它的频率，您可以`HttpUtility.HtmlDecode`在验证消息上使用该方法。

```
@{HttpUtility.HtmlDecode(Html.ValidationMessageFor(x=>x.SchoolId).ToString)} 
```

更可重用但涉及更多前期时间的方法是创建您自己的返回非 html 编码字符串的 html 帮助程序（可能称为 HtmlValidationMessageFor()）。

话虽如此，ValidationMessageFor 函数的返回类型是[MvcHtmlString](http://msdn.microsoft.com/en-us/library/system.web.mvc.mvchtmlstring.aspx)，它声明它是

> 表示不应再次编码的 HTML 编码字符串。

但是我找不到一个可靠的理由来解释为什么不应该再次对其进行编码，除非它可能是一个双重编码的字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T12:56:03.773

我做了一些更多的搜索，发现了下面的 SO 帖子，该帖子解决了我的要求。我在此处添加了该答案，以防将来有人遇到此问题。我也会将此标记为答案，因为它最接近我正在寻找的最佳答案，但我会让版主决定是否需要将其作为副本关闭。

[在 MVC3 中的 HTML.ValidationMessageFor 内渲染 HTML 标签](https://stackoverflow.com/questions/8933853/render-html-tags-inside-of-html-validationmessagefor-in-mvc3)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-30T05:44:27.530

我只需要一个解决方法来解决一条错误消息。所以一个简单的jquery绕道；

```
 <script>
    $(document).ready(function() {
       $('.validation-summary-errors ul li').each(function(){
            if($(this).html() == "School not found"){
                $(this).html("School not found.  Please contact support at <a href='mailto:support@mysite.com'>support@mysite.com</a>");
            }
       });
    }); 
```

干杯!

# xsd - XSD.EXE 在文件具有交叉引用时生成多个元素时出错

> ID：11871499
> 
> 赞同：3
> 
> 时间：2012-08-08T19:11:46.547
> 
> 标签：xsd, xsd.exe, xsd-validation, xsd2code, xsdobjectgen

我有 orbitz（全球酒店分销系统）xsd 架构，并希望从这些 xsd 文件生成 c#.Net 类。

当我使用 Xsd.Exe 或 XSD2Code 或其他东西时，生成的类会将复杂类型从导入的文件复制到内部，因此多个文件具有相同的类。

我很困惑，该怎么办？

您可以从以下链接下载 xsd 架构文件。我需要在“hotel”文件夹中使用 xsd 文件的 c# 类。

生成 xsd 文件后，请将这些 .cs 文件添加到项目中并查看错误。

谢谢

XSD 文件 =>http://rapidshare.com/files/1062702005/orbitz-pws-schemas-1.42.zip

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-09T13:12:38.010

您的场景与我在 SO 上发布[此解决方案](https://stackoverflow.com/questions/8896602/the-minoccurs-attribute-cannot-be-present/8944124#8944124)的场景非常相似。对于您的场景，我也尝试过，并且生成的代码可以正确编译。

您的问题与 xsd.exe 中的限制有关。解决方法是重构 XSD，使其使用最少数量的 XSD 文件（不使用 xsd:include）捕获您想要处理的所有范围，然后运行生成器。

就您而言，这就是您所拥有的：

![QTAssistant 显示 Orbitz XSD 文件关系](../Images/f97a5f5728ee1e8a37320ee8ee0aae34.png)

这是重构后的 XSD 的样子：

![QTAssistant 显示 XSR 重构的 Orbitz 文件关系](../Images/e99715cceee5594b6e07760783fdc853.png)

xsd.exe 命令行看起来像这样（省略完整路径）：

```
xsd.exe Vendor.xsd Hotel.xsd Air.xsd DynamicPackaging.xsd Car.xsd Common.xsd /language:CS /classes /out:xsd2code 
```

生成的代码编译没有任何问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-11T09:35:24.413

谢谢Petru，我通过另一个渠道找到了答案。

我将文件放入同一个文件夹，并将导入文件位置更改为同一个文件夹，因为 xsd.exe 要求文件位于同一个文件夹中。

然后下面的命令生成确切的 c# 库。

> xsd.exe /c /f /l:cs /namespace:Schema common.xsd hotel_common.xsd hotel_shopping.xsd hotel_raterules_RQ.xsd hotel_raterules_RS.xsd hotel_itinerary_RQ.xsd hotel_itinerary_RS.xsd hotel_booking_RQ.xsd hotel_booking_RS.xsd hotel_cancel_RQ.xsd hotel_cancel_RQ.xs xsd hotel_precancel_RS.xsd hotel_deals_RQ.xsd .\hotel_deals_RS.xsd

# php - PHP Pear system_daemon 不分叉

> ID：11871500
> 
> 赞同：2
> 
> 时间：2012-08-08T19:11:49.657
> 
> 标签：php, pear

为 pear 的“system_daemon”编写的脚本拒绝分叉以形成新进程。这在我的旧服务器上运行良好，但我的新服务器没有它。守护程序脚本在 shell 中运行得很好，并且会一直运行到我杀死它们为止。作为临时解决方法，我让守护进程在分离的 tmux shell 中运行，但这显然不是一个长期解决方案。

是否有任何已知问题阻止它分叉？

我有 PHP 5

```
PHP 5.3.10-1ubuntu3.2 with Suhosin-Patch (cli) (built: Jun 13 2012 17:19:58) 
```

和此处列出的 pcntl 加载了 ini

```
/etc/php5/cli/conf.d/pcntl.ini, 
```

在 php -i 输出中进一步向下

```
pcntl

pcntl support => enabled 
```

和梨

```
PEAR Version: 1.9.4 
```

和 Pear 的 system_daemon

```
pear/System_Daemon                             1.0.0      1.0.0  Turn PHP scripts into Linux daemons 
```

任何想法这里出了什么问题？

不幸的是，我无法发布源代码，但我可以说所有（**包括文档中的示例**）system_daemon 脚本都拒绝分叉。

## 编辑——附加细节

根据 cweiske 的建议，我尝试了 pcntl 示例，它工作正常

我还尝试卸载 system_daemon，使用 aptitude 清除我的 pear 安装，重新启动，重新安装 pear，然后重新安装 system_daemon。这也没有效果。

我可以在其他 Ubuntu 机器 11.04+ 上复制这个问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T16:31:30.467

问题解决了。

1) 我的 appName 属性中有一个大写字母，较新版本的 system_daemon 会抱怨

2) 我在安装 pcntl 之前已经安装了 pear 和 system_daemon。从源头上看，这似乎不会导致问题，但为了安全起见，我重新安装了两者。

# ios - setBackButtonBackgroundImage：导致按钮显示异常

> ID：11871503
> 
> 赞同：1
> 
> 时间：2012-08-08T19:12:05.177
> 
> 标签：ios

我正在调用以下代码将我自己的后退按钮放入导航栏中

```
 [[UIBarButtonItem appearance] setBackButtonBackgroundImage: [UIImage imageNamed:@"button_back_static"]  forState:UIControlStateNormal barMetrics:UIBarMetricsDefault]; 
```

但结果是这样的：

![在此处输入图像描述](../Images/4f6995a85f2ef50a520cdd64deb5d8d2.png)

我尝试尝试调整大小，例如

```
resizableImageWithCapInsets:UIEdgeInsetsMake(0, 13, 0, 5)]; 
```

但仍然是类似的结果：

![在此处输入图像描述](../Images/82b258a87bd7d8314820b3a4992c0fe3.png)

这就是我要添加的按钮的样子：

![在此处输入图像描述](../Images/a95ed2c8a5e5573434d7946fc7320800.png)

它是 .png 101 像素 x 60 像素（我不知道为什么尺寸不均匀，这就是设计师给我的方式）。

为什么它不能正确显示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:21:27.580

图像是应有的高度的两倍，因此您只能看到上半部分。

也许这是您拥有的图像的@2x 版本并且您没有正确命名它？

如果没有，您需要一个高度/宽度一半的图像。

# android - ProgressDialog 在 AsyncTask 中强制关闭

> ID：11871504
> 
> 赞同：0
> 
> 时间：2012-08-08T19:12:07.190
> 
> 标签：android, android-asynctask, nullpointerexception, progressdialog, logcat

我正在尝试在我的 Activity 的 onResume() 事件中运行异步任务。我的目标是每次 Activity 进入前台时运行任务。当我在模拟器/电话中运行它时，当遇到 onPreExecute 方法中存在的 ProgressDialog 代码时，应用程序强制关闭。

这是我的活动代码：

```
 public class PostActivity extends Activity {

    private ProgressDialog progressBar;

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.post);
    }

    public void onResume() {
        super.onResume();
        new LoadFeedTask().execute();
    }

    public class LoadFeedTask extends AsyncTask<Void, Void, Boolean> {

        protected void onPreExecute() {
            progressBar.setCancelable(false);
            progressBar.setMessage("Logging in...");
            progressBar.setProgressStyle(ProgressDialog.STYLE_SPINNER);
            progressBar.show();
        }

        @Override
        protected Boolean doInBackground(Void... params) {

            // TODO Auto-generated method stub
            ConnectivityManager cm = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);
            NetworkInfo netInfo = cm.getActiveNetworkInfo();
            Log.d(TAG, "Checking Internet Connectivity");
            if (netInfo != null && netInfo.isConnectedOrConnecting()) {
                return true;
            }
            return false;

        }

        protected void onPostExecute(Boolean result) {

            progressBar.dismiss();

            if (result == true) {

                //Do Something

            }

            if (result == false) {

                //Do Something Else
            }

        }

    }

} 
```

当我检查 LogCat 的输出时，它在 progressBar.setCancelable(false) 处显示 NPE。即使经过数小时的努力，我也无法解决它。请帮忙。抱歉，如果这是一个重复的问题，我似乎无法在 SO 中找到与我的问题相关的任何此类问题

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T19:30:05.013

尝试在 preExecute 中替换整个 4 行 ProgressDialog

with progressBar = ProgressDialog.show(PostActivity.this, "", "正在登录...", false, false);

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T19:14:42.997

听起来您的应用程序在将您的应用程序移至后台时正在收集进度条的垃圾。在调用 asynctask 之前，在 onResume 中重新初始化你的 progressBar 变量。

实际上，当您最小化您的应用程序时，您的progressDialog 可能刚刚被关闭。检查并确保它在启动时实际上是打开的。无论哪种方式，您都会获得 NPE，因为 progressBar 不存在，您需要找到它并将其带回。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T19:19:28.623

你声明了

```
private ProgressDialog progressBar; 
```

但它从未被初始化（没有创建任何实例），因此它实际上是一个 NULL 指针。

`onCreate()`在您的方法中添加此代码

```
progressBar = new ProgressDialog(this, ProgressDialog.STYLE_SPINNER); 
```

将解决您的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-28T11:34:03.293

如果您想在任何地方都使用相同的：在课堂上或其他地方`ProgressDialog`解雇。`onPostExecute`所以你可以简单地将它定义为 `progress = new ProgressDialog(RemoteActivity.this);`

然后它将起作用，您可以在任何地方使用它。

# xml - 使用 JAXB 解组不同 XML 文档的公共元素

> ID：11871508
> 
> 赞同：1
> 
> 时间：2012-08-08T19:12:14.910
> 
> 标签：xml, jaxb

我有许多 XML 文档，它们都有一个共同的内部结构，如下所示：

```
<Fields>
    <Field>
        <Name>foo</Name>
    </Field>
    <Field>
        <Name>bar</Name>
    </Field>
</Fields> 
```

每个不同文档的相似之处仅在于“字段”元素的结构相同。根元素和周围元素可能不同。

示例文档 1：

```
<ObjectX>
    <Fields>
        <Field>
            <Name>foo</Name>
        </Field>
        <Field>
            <Name>bar</Name>
        </Field>
    </Fields>
</ObjectX> 
```

示例文档 2：

```
<Object-Y>
    <Section1>
        <Fields>
            <Field>
                <Name>foo</Name>
            </Field>
            <Field>
                <Name>bar</Name>
            </Field>
        </Fields>
    </Section1>
</Object-Y> 
```

是否可以使用 JAXB 仅解组所有文档的“字段”元素，而不必设置与我不关心的元素相对应的 Java 类？

基于对类似问题的几个答案，我尝试了一些事情但无济于事。
任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T22:41:01.710

`XMLStreamReader`您可以在 XML 文档上创建一个 StAX 。将其推进到`Fields`元素，然后将其从该状态解组。

**例子**

*   [https://stackoverflow.com/a/6414517/383861](https://stackoverflow.com/a/6414517/383861)
*   [http://blog.bdoughan.com/2012/08/handle-middle-of-xml-document-with-jaxb.html](http://blog.bdoughan.com/2012/08/handle-middle-of-xml-document-with-jaxb.html)

# javascript - 使用 AJAX 让 PowerReviews 正确加载

> ID：11871516
> 
> 赞同：4
> 
> 时间：2012-08-08T19:12:45.550
> 
> 标签：javascript, ajax, magento

我们在 Magento 商店中使用 PowerReviews 作为对标准 Magento 评论系统的替代。我们已经为类别、产品和评论页面设置了它，并且已经运行了一段时间。

最近我添加了一个模块，它为类别页面上的过滤导航带来了 AJAX 重新加载功能。即我选择“红色”作为过滤器，类别页面会刷新而无需重新加载适当的产品。当我关闭 Power Review 时，这可以正常工作。

当 Power Review 开启时，AJAX 开始加载，但随后页面变为白色，仅显示 PowerReviews`<div>`标签。当我查看 PowerReviews 代码时，我想我可以看到原因：

```
<script type="text/javascript">
  POWERREVIEWS.display.snippet(document, {
       pr_page_id : '49DAF4', 
       pr_write_review :    '/review/product/list/id/1907/category/111/#review-form',
       pr_read_review : txt, pr_snippet_min_reviews : 1});
</script> 
```

由于`POWERREVIEWS.display.snippet`正在调用“文档”，我认为正在发生的是 AJAX 负载正在发生，被写入“文档”，然后 PowerReviews 正在发生并且也被写入“文档”。由于这是最后发生的，因此它会劫持页面，而不是像在正常加载时那样正确放置。

如果我将“文档”更改为类似的内容`document.getelementbyid('PWR')`并添加一个`<div id="PWR">`片段将不会显示在页面上。有没有办法可以将输出定位`POWERREVIEWS.display.snippet`到“文档”以外的内容，这样两个脚本就不会相互干扰？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-20T16:46:35.553

PowerReviews 实际上为此提供了一个有效的答案。他们建议直接使用 JQuery 传递方法到 DIV。在这里发布以帮助他人。

> 1) 将 JS 包含插入到该部分中的 jquery 库中（如果您还没有的话）：
> 
> ```
> <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js" type="text/javascript"></script> 
> ```
> 
> 2) 对片段函数调用使用 write : function(content) 语法：
> 
> ```
> <div id="pr_snippet_category_12345"> <script type="text/javascript">
> POWERREVIEWS.display.snippet({ write : function(content) {
> $('div#pr_snippet_category_12345').append(content); } }, { pr_page_id
> : '12345', pr_snippet_min_reviews : '1' }) </script> </div> 
> ```

# java - 如何使用 Java 中的 Scanner 类从控制台读取输入？

> ID：11871520
> 
> 赞同：240
> 
> 时间：2012-08-08T19:13:07.250
> 
> 标签：java, java.util.scanner

我如何使用`Scanner`类从控制台读取输入？像这样的东西：

```
System.out.println("Enter your username: ");
Scanner = input(); // Or something like this, I don't know the code 
```

基本上，我想要的只是让扫描仪读取用户名的输入，并将输入分配给`String`变量。

* * *

## 回答 #1

> 赞同：361
> 
> 时间：2012-08-08T19:29:23.313

一个简单的例子来说明`java.util.Scanner`工作原理是从`System.in`. 这真的很简单。

```
Scanner sc = new Scanner(System.in);
int i = sc.nextInt(); 
```

要检索用户名，我可能会使用[`sc.nextLine()`](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html#nextLine%28%29).

```
System.out.println("Enter your username: ");
Scanner scanner = new Scanner(System.in);
String username = scanner.nextLine();
System.out.println("Your username is " + username); 
```

[`next(String pattern)`](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html#next%28java.lang.String%29)如果您想对输入进行更多控制，或者只是验证`username`变量，也可以使用。

[您将在API 文档中](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html)找到有关其实现的更多信息[`java.util.Scanner`](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html)

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2012-08-08T19:15:37.593

```
Scanner scan = new Scanner(System.in);
String myLine = scan.nextLine(); 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2015-07-06T08:30:26.770

**从控制台读取数据**

*   [**`BufferedReader`**](http://docs.oracle.com/javase/7/docs/api/java/io/BufferedReader.html)是同步的，因此可以从多个线程安全地完成 BufferedReader 上的读取操作。可以指定缓冲区大小，也可以使用默认大小（[8192](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/8-b132/java/io/BufferedReader.java#BufferedReader)）。对于大多数用途，默认值足够大。

    [readLine()](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/8-b132/java/io/BufferedReader.java#BufferedReader.readLine%28boolean%29) **«** *只是从流或源中逐行读取数据。一行被认为是由以下任何一个终止：\n、\r（或）\r\n*

*   [**`Scanner`**](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html)使用分隔符模式将其输入分解为标记，默认情况下匹配空格（\s）并且它被[`Character.isWhitespace`](http://docs.oracle.com/javase/7/docs/api/java/lang/Character.html#isWhitespace(char)).

    **«** *在用户输入数据之前，扫描操作可能会阻塞，等待输入。* **«** *如果您想从流中解析特定类型的令牌，**请使用 Scanner( [BUFFER_SIZE = 1024 )。](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/8-b132/java/util/Scanner.java#Scanner)* **«** *然而，扫描仪不是线程安全的。它必须在外部同步。*

    next() « 从这个扫描器中查找并返回下一个完整的令牌。nextInt() « 将输入的下一个标记扫描为 int。

**代码**

```
String name = null;
int number;

java.io.BufferedReader in = new BufferedReader(new InputStreamReader(System.in));
name = in.readLine(); // If the user has not entered anything, assume the default value.
number = Integer.parseInt(in.readLine()); // It reads only String,and we need to parse it.
System.out.println("Name " + name + "\t number " + number);

java.util.Scanner sc = new Scanner(System.in).useDelimiter("\\s");
name = sc.next();  // It will not leave until the user enters data.
number = sc.nextInt(); // We can read specific data.
System.out.println("Name " + name + "\t number " + number);

// The Console class is not working in the IDE as expected.
java.io.Console cnsl = System.console();
if (cnsl != null) {
    // Read a line from the user input. The cursor blinks after the specified input.
    name = cnsl.readLine("Name: ");
    System.out.println("Name entered: " + name);
} 
```

### Stream 的输入和输出

```
Reader Input:     Output:
Yash 777          Line1 = Yash 777
     7            Line1 = 7

Scanner Input:    Output:
Yash 777          token1 = Yash
                  token2 = 777 
```

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2018-03-07T13:38:36.103

input.nextInt() 方法有问题 - 它只读取 int 值。

因此，当使用 input.nextLine() 读取下一行时，您会收到“\n”，即`Enter`密钥。所以要跳过这个，你必须添加 input.nextLine()。

试试这样：

```
 System.out.print("Insert a number: ");
 int number = input.nextInt();
 input.nextLine(); // This line you have to add (it consumes the \n character)
 System.out.print("Text1: ");
 String text1 = input.nextLine();
 System.out.print("Text2: ");
 String text2 = input.nextLine(); 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2015-12-31T17:34:36.307

有几种方法可以从用户那里获得输入。在这个程序中，我们将使用 Scanner 类来完成任务。这个 Scanner 类在 下`java.util`，因此程序的第一行是**import java.util.Scanner;** 它允许用户在 Java 中读取各种类型的值。导入语句行必须在 java 程序的第一行，我们继续进行代码。

```
in.nextInt(); // It just reads the numbers

in.nextLine(); // It get the String which user enters 
```

要访问 Scanner 类中的方法，请创建一个新的扫描仪对象作为“in”。现在我们使用它的一种方法，即“下一步”。“next”方法获取用户在键盘上输入的文本字符串。

这里我`in.nextLine();`用来获取用户输入的字符串。

```
import java.util.Scanner;

class GetInputFromUser {
    public static void main(String args[]) {
        int a;
        float b;
        String s;

        Scanner in = new Scanner(System.in);
        System.out.println("Enter a string");
        s = in.nextLine();
        System.out.println("You entered string " + s);

        System.out.println("Enter an integer");
        a = in.nextInt();
        System.out.println("You entered integer " + a);

        System.out.println("Enter a float");
        b = in.nextFloat();
        System.out.println("You entered float " + b);
    }
} 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2013-08-20T10:45:54.330

```
import java.util.Scanner;

public class ScannerDemo {
    public static void main(String[] arguments){
        Scanner input = new Scanner(System.in);

        String username;
        double age;
        String gender;
        String marital_status;
        int telephone_number;

        // Allows a person to enter his/her name   
        Scanner one = new Scanner(System.in);
        System.out.println("Enter Name:" );  
        username = one.next();
        System.out.println("Name accepted " + username);

        // Allows a person to enter his/her age   
        Scanner two = new Scanner(System.in);
        System.out.println("Enter Age:" );  
        age = two.nextDouble();
        System.out.println("Age accepted " + age);

        // Allows a person to enter his/her gender  
        Scanner three = new Scanner(System.in);
        System.out.println("Enter Gender:" );  
        gender = three.next();
        System.out.println("Gender accepted " + gender);

        // Allows a person to enter his/her marital status
        Scanner four = new Scanner(System.in);
        System.out.println("Enter Marital status:" );  
        marital_status = four.next();
        System.out.println("Marital status accepted " + marital_status);

        // Allows a person to enter his/her telephone number
        Scanner five = new Scanner(System.in);
        System.out.println("Enter Telephone number:" );  
        telephone_number = five.nextInt();
        System.out.println("Telephone number accepted " + telephone_number);
    }
} 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2014-05-06T08:08:11.210

您可以编写一个简单的程序来询问用户的姓名并打印回复使用的任何输入。

或者让用户输入两个数字，您可以对这些数字进行加、乘、减或除，然后打印用户输入的答案，就像计算器的行为一样。

所以你需要 Scanner 类。你必须`import java.util.Scanner;`，并且在你需要使用的代码中：

```
Scanner input = new Scanner(System.in); 
```

`input`是一个变量名。

```
Scanner input = new Scanner(System.in);

System.out.println("Please enter your name: ");
s = input.next(); // Getting a String value

System.out.println("Please enter your age: ");
i = input.nextInt(); // Getting an integer

System.out.println("Please enter your salary: ");
d = input.nextDouble(); // Getting a double 
```

看看这有什么不同：`input.next();`,,,`i = input.nextInt();``d = input.nextDouble();`

根据 String，int 和 double 的变化方式与其余部分相同。不要忘记代码顶部的 import 语句。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-08-18T17:19:24.340

一个简单的例子：

```
import java.util.Scanner;

public class Example
{
    public static void main(String[] args)
    {
        int number1, number2, sum;

        Scanner input = new Scanner(System.in);

        System.out.println("Enter First multiple");
        number1 = input.nextInt();

        System.out.println("Enter second multiple");
        number2 = input.nextInt();

        sum = number1 * number2;

        System.out.printf("The product of both number is %d", sum);
    }
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-06-09T11:44:57.130

当用户输入他/她`username`时，还要检查有效输入。

```
java.util.Scanner input = new java.util.Scanner(System.in);
String userName;
final int validLength = 6; // This is the valid length of an user name

System.out.print("Please enter the username: ");
userName = input.nextLine();

while(userName.length() < validLength) {

    // If the user enters less than validLength characters
    // ask for entering again
    System.out.println(
        "\nUsername needs to be " + validLength + " character long");

    System.out.print("\nPlease enter the username again: ");
    userName = input.nextLine();
}

System.out.println("Username is: " + userName); 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-07-30T10:07:01.590

```
import java.util.*;

class Ss
{
    int id, salary;
    String name;

   void Ss(int id, int salary, String name)
    {
        this.id = id;
        this.salary = salary;
        this.name = name;
    }

    void display()
    {
        System.out.println("The id of employee:" + id);
        System.out.println("The name of employye:" + name);
        System.out.println("The salary of employee:" + salary);
    }
}

class employee
{
    public static void main(String args[])
    {
        Scanner sc = new Scanner(System.in);

        Ss s = new Ss(sc.nextInt(), sc.nextInt(), sc.nextLine());
        s.display();
    }
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-03-29T05:08:33.237

这是执行所需操作的完整类：

```
import java.util.Scanner;

public class App {
    public static void main(String[] args) {
        Scanner input = new Scanner(System.in);
        final int valid = 6;

        Scanner one = new Scanner(System.in);
        System.out.println("Enter your username: ");
        String s = one.nextLine();

        if (s.length() < valid) {
            System.out.println("Enter a valid username");
            System.out.println(
                "User name must contain " + valid + " characters");
            System.out.println("Enter again: ");
            s = one.nextLine();
        }

        System.out.println("Username accepted: " + s);

        Scanner two = new Scanner(System.in);
        System.out.println("Enter your age: ");
        int a = two.nextInt();
        System.out.println("Age accepted: " + a);

        Scanner three = new Scanner(System.in);
        System.out.println("Enter your sex: ");
        String sex = three.nextLine();
        System.out.println("Sex accepted: " + sex);
    }
} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2015-04-04T11:58:02.773

1.  读取输入：

    ```
    Scanner scanner = new Scanner(System.in);
    String input = scanner.nextLine(); 
    ```

2.  在调用带有一些参数/参数的方法时读取输入：

    ```
    if (args.length != 2) {
        System.err.println("Utilizare: java Grep <fisier> <cuvant>");
        System.exit(1);
    }
    try {
        grep(args[0], args[1]);
    } catch (IOException e) {
        System.out.println(e.getMessage());
    } 
    ```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-07-07T08:07:04.480

有一种从控制台读取的简单方法。

请找到以下代码：

```
import java.util.Scanner;

    public class ScannerDemo {

        public static void main(String[] args) {
            Scanner sc = new Scanner(System.in);

            // Reading of Integer
            int number = sc.nextInt();

            // Reading of String
            String str = sc.next();
        }
    } 
```

详细了解请参考以下文档。

[文档](https://www.javatpoint.com/Scanner-class)

现在让我们谈谈对Scanner类工作的详细理解：

```
public Scanner(InputStream source) {
    this(new InputStreamReader(source), WHITESPACE_PATTERN);
} 
```

这是创建 Scanner 实例的构造函数。

在这里，我们传递的`InputStream`只是一个`System.In`. 在这里它打开了`InputStream`用于控制台输入的管道。

```
public InputStreamReader(InputStream in) {
    super(in);
    try {
        sd = StreamDecoder.forInputStreamReader(in, this, (String)null); // ## Check lock object
    }
    catch (UnsupportedEncodingException e) {
        // The default encoding should always be available
        throw new Error(e);
    }
} 
```

通过传递 System.in，此代码将打开套接字以从控制台读取。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2017-08-27T11:19:00.183

您可以流动此代码：

```
Scanner obj= new Scanner(System.in);
String s = obj.nextLine(); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-07-07T07:02:52.877

您可以在 Java 中使用 Scanner 类

```
Scanner scan = new Scanner(System.in);
String s = scan.nextLine();
System.out.println("String: " + s); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-11-01T08:37:42.983

```
import java.util.Scanner;  // Import the Scanner class

class Main { // Main is the class name
  public static void main(String[] args) {
    Scanner myObj = new Scanner(System.in);  // Create a Scanner object
    System.out.println("Enter username");

    String userName = myObj.nextLine();  // Read user input
    System.out.println("Username is: " + userName);  // Output user input
  }
} 
```

# java - Java upload file ftp server

> ID：11871528
> 
> 赞同：0
> 
> 时间：2012-08-08T19:13:27.517
> 
> 标签：java, file, upload, ftp

I am trying to make a function in Java :

```
public static void upload_files(String us, String pw, String ip, String f){
 try
 {
    FTPClient client = new FTPClient();
    client.connect(ip);
    client.login(us,pw);
    client.upload(f);
 } catch(Exception e) {
    e.printStackTrace();
 }
} 
```

I added apache libraries, but sadly I got an error on "upload" line I suppose I do not use correctly the method upload, but I don't know how to.

When I compile it with Netbeans, it is noticing me that there is an error line "client.upload(f);"

The error given in output is "*java.lang.RuntimeException: Uncompilable source code - Erroneous sym type: org.apache.commons.net.ftp.FTPClient.upload*"

Thank you all in advance. nb : "f" is the direct path to my file

* * *

EDIT :

The problem is "quite" solved since now I upload some files on my ftp server BUT sadly they are all empty, as noticed on below.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:33:38.313

The Apache FTPClient does not have an `upload` method.

What it does have, is a method called [storeFile](http://commons.apache.org/net/apidocs/org/apache/commons/net/ftp/FTPClient.html#storeFile%28java.lang.String,%20java.io.InputStream%29) .

It takes as it's parameters the name the file should have on the server, and an `InputStream`. The InputStream reads from your local file, so you need:

```
 InputStream is = new FileInputStream( f );
 client.storeFile( some_name, is ); 
```

# java - 如何保存不同类型的收藏？

> ID：11871541
> 
> 赞同：0
> 
> 时间：2012-08-08T19:14:20.613
> 
> 标签：java, android, generics, sqlite

我正在编写包装 db SELECT 语句的方法，该语句接收 SQL 查询并运行它。结果收集在`Object[][]`. 数据库中的每个单元格都可以是整数或字符串。

我有返回数组的问题。它的`Object[][]`，所以我松散的类型。

```
public Object[][] select(String query) {
    Object[][] result = new Object[cursor.getCount()][cursor.getColumnCount()];
    Cursor cursor = db.rawQuery(query, null);

    //Iterate over cursor (rows)
    do {
        //Iterate over columns (cells with data of different type)
        for(int columnIndex = 0; columnIndex < cursor.getColumnCount(); columnIndex++) {
            int type = cursor.getType(columnIndex);

            //assume, that there are only two types - String or Integer (actualy there are 3 more types)
            if(type == Cursor.FIELD_TYPE_INTEGER) {
                result[cursor.getPosition()][columnIndex] = cursor.getInt(columnIndex);
            }
            else if(type == Cursor.FIELD_TYPE_STRING) {
                result[cursor.getPosition()][columnIndex] = cursor.getString(columnIndex);
            }
        }
    } while (cursor.moveToNext());

    return result;
} 
```

我不想松散的类型。例如希望能够这样做（伪代码）：

```
//pseudocode:
result = select("SELECT age, name FROM people")
print( "Hello, " + result[0][0] + ". In ten years you'll be " )
print( result[0][0] + 10 )
//Prints: Hello, John. In ten years you'll be 56 
```

每本关于 Java 的书都说，我不能拥有不同类型的数组。天气晴朗。

但是**我应该如何从数据库中保存所有这些整数和字符串？**我尝试使用集合和泛型，但没有运气——Java 新手。

还尝试使用某种结果值持有者：

```
private class Result {
    private Class type;
    private Object value;

        ...

    public ??? get() { //??? - int or string - here I have some problems :)
        return this.type.cast(this.value);
    }

    //do NOT want to have these:
    public int getInt() { return (int) value; }
    public int getString() { return (String) value; }
} 
```

在这种情况下方法`select(...)`返回。`Result[][]`

**自己回答：** 明白，我正在尝试用 Java 编写代码，就像我在 php 中所做的那样。使用强类型，我无法制作简单的方法，在没有显式转换的情况下返回所有类型。

毕竟我决定创建通用数据对象并在选择时填写它们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T19:16:39.930

你为什么不创建一个 Result 类来包装你想要的任何东西并实例化它？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T20:07:26.080

我可能会做类似的事情......

```
public final class Row {

  private final Map<String, ?> columns;

  protected Row(final Map<String, ?> columns) {
    this.columns = columns;
  }

  public <T> T get(final String name) {
    return (T) columns.get(name);
  }  

  public <T> T get(final String name, final Class<T> type) {
    return (T) columns.get(name);
  }
}

public final Iterable<Row> select(final String query) {
  final Cursor cursor = db.rawQuery(query, null);
  final int numRow = cursor.getCount();
  final int numCol = cursor.getColumnCount();
  final Row[] rows = new Row[numRow];
  for (int row = 0; row < numRow; ++row) {
    final Map<String, Object> cols = new HashMap<String, Object>(numCol);
    for (int col = 0; col < numCol; ++col) {
      final String name = cursor.getColumnName(col);
      final Object val = null;
      final int type = cursor.getType(col);
      switch (type) {
        case Cursor.FIELD_TYPE_INTEGER:
          val = cursor.getInt(col);
          break;
        case Cursor.FIELD_TYPE_STRING:
          val = cursor.getString(col);
          break;
        ...
      }
      map.put(name, val);
    }
    rows[row] = new Row(cols);
    cursor.moveToNext();
  }
  return Arrays.asList(rows); 
}

private final Row selectFirst(final String query) {
  return select(query).iterator().next();
} 
```

其次是...

```
final Row result = selectFirst("SELECT age, name FROM people");
print("Hello, " + result.get("name") + ". In ten years you'll be "
          + (result.<Integer>get("age") + 10)). 
```

...或者，等效地：

```
final Row result = selectFirst("SELECT age, name FROM people");
final String name = result.get("name");
final int age = result.get("age");
print("Hello, " + name + ". In ten years you'll be " + (age + 10)); 
```

使用变量允许 javac 分别推断`get`(`String`和`Integer`) 的类型参数。

由于`select`返回，您可以在循环`Iterable<Row>`中使用它：`for`

```
for (final Row row : select(...)) {
  /* operate on the row */
} 
```

**请注意**，我不确定这是否会在没有一两次调整的情况下编译。抱歉，尚未对其进行测试-但总体思路应该。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T19:15:39.123

最好的方法可能是创建一个带有 getter/setter 的 java bean，其中包含您将从数据库中获得的属性。例如，如果您要雇用员工

```
class Employee
{
int empID;
String empName;

public void setEmpID(String eID)
{
empID= eID;
}

public int getEmpID()
{
return eID;
}
.......
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T19:19:22.147

返回以列名或索引作为键的 Map 列表，如下所示：

```
public List<Map<Integer,Result>> select(String query) 
```

提取数据时，请执行以下操作：

```
List<Map<Integer,Result>> data = new ArrayList<Map<Integer,Result>>();
...
Map<String,Result> elem = new...
elem.put(columnIndex, new Result(..));

data.add(elem); 
```

集合肯定比数组更强大。

**编辑** 使用`Result`您提供的持有人类。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-08T19:23:42.457

用一个`Map<String,List<Result>>`

Result 类可以存储实际值及其类型

```
class Result {

   Object value;
   DataType type;

}

enum DataType {

  String,
  Integer

} 
```

# python - Django：获取与登录用户相关的数据。

> ID：11871553
> 
> 赞同：1
> 
> 时间：2012-08-08T19:14:51.857
> 
> 标签：python, django

登录后，用户可以访问他们创建的一组草稿。这些存储在以下位置：

```
class Draft(models.Model):
    user = models.ForeignKey(User)
    title = models.CharField(max_length=30)
    content = models.TextField() 
```

用户应该能够`/drafts`访问他们的草稿。如何使用`request.user`过滤草稿？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T19:19:01.170

在您看来，您会这样做：

```
drafts = Draft.objects.filter(user=request.user) 
```

然后将草稿返回到您的模板并循环遍历它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-08T19:18:32.187

```
Draft.objects.filter(user=request.user) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-08T19:19:13.843

您可以简单地将[login_required](https://docs.djangoproject.com/en/dev/topics/auth/#the-login-required-decorator)装饰器用于您的视图功能并使用`user=request.user`查询过滤草稿。

# html - 如何沿屏幕制作 150x150 方格的 div

> ID：11871555
> 
> 赞同：4
> 
> 时间：2012-08-08T19:14:57.970
> 
> 标签：html, inline, tiling

*并在填充前一行时开始新行？
这应该有效，但不适合我，
html：

```
<div id="squares">
<div id="1">
width:150px;
height:150px;
</div>
<div id="2">
width:150px;
height:150px;
</div>
<div id="3">
width:150px;
height:150px;
</div>  
</div> 
```

所以这在页面上建立了 3 个框

CSS：

```
#squares {
display:inline;
background-color:#000000;
} 
```

css 应该告诉他们排队并且是黑色的，这样我们就可以看到他们，判断他们是否在正确的位置。
我需要添加什么吗？你能想出任何不同的方法来达到这个结果吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-08T19:24:45.453

HTML

```
<div id="squares">
    <div id="1"></div>
    <div id="2"></div>
    <div id="3"></div>
</div>​ 
```

CSS

```
#squares div {
    /* these styles will let the divs line up next to each other
       while accepting dimensions */
    display: block;
    float: left;

    width: 150px;
    height: 150px;
    background: black;

    /* a small margin to separate the blocks */
    margin-right: 5px;
} 
```

使用的替代方法`float`是使用`inline-block`样式：

```
display: inline-block;
zoom: 1;
*display: inline; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T19:22:32.843

您缺少一个 div 语句，表明它必须应用于 id 为“squares”的 div 内的 div：

```
css:
#squares div {
display:inline;
background-color:#000000;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T20:15:16.880

最好的方法是使用 display: inline-block;

HTML

```
<div id="squares">
<div id="1" class="square">
</div><div id="2" class="square">
</div><div id="3" class="square">
</div>
</div>​ 
```

请注意 HTML 标记的格式，重要的是避免在使用 display inline-block 时在元素之间获得额外的边距（[检查这个](http://css-tricks.com/fighting-the-space-between-inline-block-elements/)）

CSS：

```
.square {
background-color: #000;
display: inline-block;
height: 150px;
vertical-align: top;
width: 150px;
*display: inline;
zoom: 1;
} 
```

出于开发目的，您可以添加： CSS：

```
.square {outline: 1px solid red;} 
```

所以你可以在不破坏布局的情况下看到它们的尺寸（通过扩展元素的自然宽度）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T19:20:22.647

我想你不见了；

```
div {float:left;} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-08T19:27:26.963

如果我理解正确，您希望每个 div #1 #2 和 #3 的宽度和高度都为 150px，并且都排成一行，在这种情况下

你想定位每个 div 而不是主要的，像这样

```
#squares > div {
    display:block;
    float:left;
    width:150px;
    height:150px;
    background-color:#000000;
    margin-right:5px;
} 
```

# c# - 使用选定的关键字解析 XML 文件

> ID：11871558
> 
> 赞同：0
> 
> 时间：2012-08-08T19:15:11.027
> 
> 标签：c#, xml, winforms, keyword

我有下面的代码。`<item></item>`假设用户可以插入1-4个关键词并点击搜索按钮，那么如果子标签中的内容`<description</description>`包含一个/多个输入的关键词，就会有结果在richtextbox中显示出来。但是代码在这一行不正确`if (itemDescription.Contains(txtComKeyword1 | txtComKeyword2 | txtComKeyword3 | txtComKeyword4)`。

请问大家可以看一下吗？非常感谢您的帮助！谢谢你。

以下是我的 XML 文件结构的一部分：

```
<item>
      <title>[PhoTosynthesIs] Being driven</title>
      <author>PhoTosynthesIs</author>
      <description>purely by profit, I've decided to stick to my strategy and exit both tranches at 177\. Will pick this stock up again when it breaches and holds the next pivot point. gl all</description>
      <link>http://www.lse.co.uk/shareChat.asp?ShareTicker=BARC&amp;post=5660817</link>
      <pubDate>Wed, 08 Aug 2012 11:43:17 GMT</pubDate>
</item>
<item>
      <title>[b36m] alw51</title>
      <author>b36m</author>
      <description>Could you share your thoughts/opinions  on a buy in price based on TW with me please   many thanks</description>
      <link>http://www.lse.co.uk/shareChat.asp?ShareTicker=BARC&amp;post=5660636</link>
      <pubDate>Wed, 08 Aug 2012 11:16:56 GMT</pubDate>
</item> 
```

下面是我的这个函数的一段代码：

```
private void searchComByKeywords()
{
    // Process the list of files found in the directory. 
    string[] fileEntries = Directory.GetFiles(sourceDir);
    foreach (string fileName in fileEntries)
    {
        try
        {
            XmlDocument xmlDoc = new XmlDocument(); //* create an xml document object.

            string docPath = fileName;

            xmlDoc.Load(docPath); //* load the XML document from the specified file.

            XmlNodeList nodeList = xmlDoc.GetElementsByTagName("item");

            foreach (XmlNode node in nodeList)
            {

                XmlElement itemElement = (XmlElement)node;

                string itemDescription = itemElement.GetElementsByTagName("description")[0].InnerText;

                if (itemDescription.Contains(txtComKeyword1 | txtComKeyword2 | txtComKeyword3 | txtComKeyword4)
                {
                    string itemTitle = itemElement.GetElementsByTagName("title")[0].InnerText;
                    string itemDate = itemElement.GetElementsByTagName("pubDate")[0].InnerText;
                    string itemAuthor = itemElement.GetElementsByTagName("author")[0].InnerText;

                    richComResults.AppendText("Author: " + itemAuthor + "\nDate: " + itemDate + "\nTitle: " + itemTitle + "\nDescription: " + itemDescription + "\n\n--------\n\n");
                }
                //else
                //{
                //    richComResults.AppendText("There is no author " + txtComAuthor.Text.ToString().ToLower() + ". Please ensure you are using a correct author name.");
                //}
            }
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:19:05.337

也许你可以尝试：

```
if (itemDescription.Contains(txtComKeyword1) || itemDescription.Contains(txtComKeyword2) || itemDescription.Contains(txtComKeyword3) || itemDescription.Contains(txtComKeyword4))
{
...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T19:25:43.500

当`if`语句中的条件很复杂并且其含义不能立即明确时，我倾向于将其重构为单独的方法。在您的情况下，它可能如下所示：

```
private static bool DoesItemDescriptionContainOneOf(string description, params string[] items)
{
    return items.Any(description.Contains);
} 
```

然后，您的情况将如下所示：

```
if (DoesItemDescriptionContainOneOf(itemDescription, txtComKeyword1, txtComKeyword2, txtComKeyword3, txtComKeyword4))
{
    ....
} 
```

整洁多了，嗯？

# wolfram-mathematica - 在 Mathematica 中创建出版质量表的最佳方法是什么？

> ID：11871562
> 
> 赞同：0
> 
> 时间：2012-08-08T19:15:28.807
> 
> 标签：wolfram-mathematica

我想在 Mathematica 8 中创建一个出版质量的文本表格。有没有一种方法可以创建一个漂亮的表格并设置其格式，类似于您可以在 Mathematica 的 MS Word 中创建的表格？

该表将是文本的一部分 - 不用于矩阵运算。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T10:15:45.080

在不知道您的数据采用什么格式的情况下，很难提供结构化代码，但是假设它是结果表，那么一旦您有了数据，您就可以使用 Grid 函数，标准帮助文档中有一个有趣的示例，其中下面的代码可能会让你开始。

```
Grid[data, Alignment -> Left, Spacings -> {2, 1}, Frame -> All, 
 ItemStyle -> "Text", Background -> {{Gray, None}, {LightGray, None}}] 
```

其中“数据”显然将是您自己的数据，这提供了一个漂亮的表格，如[官方文档中的链接所示](http://reference.wolfram.com/mathematica/howto/EnterRangesAndOptionsForFunctions.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T21:39:12.260

由于您的问题目前非常普遍，因此这里是一个同样普遍的答案。

[`Grid`](http://reference.wolfram.com/mathematica/ref/Grid.html)，它的[选项](http://reference.wolfram.com/mathematica/ref/Grid.html#1519354290)，以及相关的功能，例如[`Item`](http://reference.wolfram.com/mathematica/ref/Item.html)允许在表格中使用相当多的样式和格式选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T17:04:54.833

您可能对我的[`SciForm`函数](https://mathematica.stackexchange.com/a/9015/280)感兴趣，例如，它[允许](https://mathematica.stackexchange.com/a/9015/280)生成下表：

![在此处输入图像描述](../Images/738089927c82e8bc815af5893b881141.png)

# java - 使用 Spring3 mvc 时出现 ajax 问题。返回对象列表时出现 406 错误

> ID：11871570
> 
> 赞同：2
> 
> 时间：2012-08-08T19:15:41.553
> 
> 标签：java, jquery, spring-mvc, jackson

我尝试在我的 spring3 mvc 应用程序中实现 ajax。当我返回一个简单的字符串时，Ajax 工作得很好，但是当我尝试返回一个字符串列表时，我得到了一个`406 error`.

这是我的`context`文件

```
<context:annotation-config />
<context:component-scan base-package="com.ajaxtest" />
<mvc:annotation-driven />
<import resource="hibernate-context.xml" />
<mvc:resources mapping="/resources/**" location="/resources/"/> 
```

这是我的控制器映射方法

```
@RequestMapping(value="/test", method = RequestMethod.GET, 
        headers="Accept=*/*")
public @ResponseBody List<String> testAjax(@RequestParam("query") String query) {
    System.out.println(query);
    ArrayList<String> list = new ArrayList<String>();

    for (int i = 0; i < 10; i++) {
        list.add(""+i);
    }
    return list;
} 
```

这是我的js代码。

```
$(function(){
    $.get('ajax/test.html',{'query' : 1},function(data){
        console.log(data);
    });
}); 
```

我添加了以下用于映射的 jar 文件。

`jackson-core-2.0.2.jar, jackson-core-asl-1.9.7.jar, jackson-datatype-json-org-2.0.2.jar, jackson-mapper-asl-1.9.7.jar`

我应该做哪些更改才能将对象列表返回给 js？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:27:47.303

HTTP 错误代码 406 代表错误的客户端请求（请参阅[HTTP 错误代码](http://en.wikipedia.org/wiki/HTTP_status_code#4xx_Client_Error)）

> 请求的资源只能生成根据请求中发送的 Accept 标头不可接受的内容。

您需要将 Accept Header 设置为`application/json`. 在 JQuery 中，您可以使用[`jQuery.getJSON()`](http://api.jquery.com/jQuery.getJSON/)

# r - 在另一个时间范围内返回数据子集时间范围？

> ID：11871572
> 
> 赞同：48
> 
> 时间：2012-08-08T19:15:46.233
> 
> 标签：r, time-series, subset, xts

`xts`对对象进行子集化的方法非常好。例如，可以通过执行以下操作获取所有年、月、日但严格在上午 9:30 到下午 4 点之间的所有数据：

```
my_xts["T09:30/T16:00"] 
```

或者，您可以通过以下方式获得两个日期之间的所有观察结果：

```
my_xts["2012-01-01/2012-03-31"] 
```

或通过执行以下操作在某个日期之前/之后的所有日期：

```
my_xts["/2011"]  # from start of data until end of 2011
my_xts["2011/"]  # from 2011 until the end of the data 
```

我如何才能获得所有年份仅特定月份的所有数据，或所有月份和年份仅特定日期的所有数据？是否存在任何其他子集化技巧？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-08-08T19:25:58.933

您可以使用`.index*`函数系列来获取特定月份或月份中的特定日期。查看`?index`完整的函数列表。例如：

```
library(quantmod)
getSymbols("SPY")
SPY[.indexmon(SPY)==0]   # January for all years (note zero-based indexing!)
SPY[.indexmday(SPY)==1]  # The first of every month
SPY[.indexwday(SPY)==1]  # All Mondays 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-08-08T19:22:23.223

时间子集有点隐藏，所以我理解它为什么会引发这样的问题。我知道的唯一其他“技巧”是`last`and`first`函数，如果需要，您可以嵌套它们。例如，这将获得前 3 周的最后 2 天。

```
last(first(my_xts, "3 weeks"), "2 days") 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-04-15T16:45:44.823

`xts`请注意， windows 和 ubuntu 的 yearmon 日期格式的子集似乎有不同的行为。

```
library(quantmod)
library(xts)

getSymbols("SPY", src="google", from = "2004-01-01")
x1 <- SPY['2006-01/2007-12']

x2 <- apply.monthly(x1,mean)
x2['2006-01/2007-12']

x3 <- as.xts(coredata(x2),order.by = as.yearmon(index(x2)))
x3['2006-01/2007-12'] 
```

Windows 和 ubuntu 之间的结果`x2`是一致的，因为格式是完整日期。但是，在`x3`将日期转换为 yearmon 后，windows 和 ubuntu 会产生不同的结果。

# android - android 上类似 Google+ 的单元格背景

> ID：11871573
> 
> 赞同：0
> 
> 时间：2012-08-08T19:15:45.863
> 
> 标签：android, listview, drawable

我正在尝试复制带有 google+ 在其应用中的轻微阴影效果的白框。

我已经用完成这个的方法做了大量的尝试。我发现 9-patch 图像在旧设备上会导致显着滞后。我已经转而尝试使用 a 进行复制，但是，我似乎无法完全正确地获得投影。

我尝试了许多方法，包括向形状添加渐变，将可绘制对象转换为位图，对位图应用阴影，然后将其封装回可绘制对象并将其设置为我的视图的背景图像。然而，这些似乎都没有给我想要的效果。

有谁知道为列表视图中的每个视图绘制这些框的有效方法。

（作为旁注，我不关心 2 列，我只想要他们拥有的视图背景，而不必使用 9patch。

![在此处输入图像描述](../Images/759b4792064e561b91a586d2673a22e8.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:31:59.630

查看 Google+ apk，他们对所有阴影使用了 9 个补丁图像。我认为 9-patch 图像正是您想要的。您可能想要拉下 APK 并查看它们的资源文件夹和它们的 9-patch 图像的大小。也许您的针对较小屏幕设备的优化不佳？

# c# - EndpointDispatcher 的 ContractFilter 不匹配

> ID：11871576
> 
> 赞同：1
> 
> 时间：2012-08-08T19:16:01.863
> 
> 标签：c#, asp.net, wcf

我有这个错误。我知道问题出在哪里，但我无法解决。我有正在运行的 WCF Web 服务。我需要与第一个 Web 服务相同但具有不同名称空间的第二个 Web 服务。localhost/test1.svc localhost/test2.svc 我不想添加网络引用，所以我在 test1.svc?wsdl 上使用了 wsdl.exe 现在我想用那个类 test2.svc 调用，但我收到了这个错误。
EndpointDispatcher 的 ContractFilter 不匹配我发现[了这个](http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.endpointdispatcher.aspx)

但我不知道如何使用它。或者是否有任何其他方式可以 dinamicli 添加 Web 服务 url。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T08:04:34.643

使用服务时，您为服务定义两个不同的端点：

例如

```
 <endpoint address="address1"
    binding="basicHttpBinding" bindingConfiguration="test1config" contract="service.icontract"
    name="test1endpoint" />
      <endpoint address="address2"
    binding="basicHttpBinding" bindingConfiguration="test2config" contract="service.icontract"
    name="test2endpoint" /> 
```

然后，您可以像这样指定希望在代码中使用的端点：

```
var channelFactory = new ChannelFactory<IContract>("your-endpoint-name-here"); 
```

并使用它以正常方式创建您的频道。

从中，您可以通过更改端点名称来选择在正确的时间使用哪一个。

# java - 监听 Mysql 表更改事件，用于 java

> ID：11871578
> 
> 赞同：2
> 
> 时间：2012-08-08T19:16:08.967
> 
> 标签：java, mysql

我想用java听mysql表的变化，最可用和最常用的方法是使用触发器，但是在mysql中触发器在我的情况下不能做太多，（如果我错了，请纠正）

我的真实情况是这样的，我想使用 mysql 数据库生成图表，当 mysql 表更新为新行时，这些图表应该刷新。所以目前我正在做的是运行一个单独的线程来观察表格的行数，如果行数改变了，那么我创建图表！！！！！！

但是如果有更好的方法，我认为这不是一个好主意，那么有没有一种方法可以让我收听 mysql 表的变化？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:20:23.180

您能否仅在请求图表时查询数据库？它是否输出用户正在访问的图片？还是您的应用程序中正在绘制图表？如果它是在您的应用程序中绘制的，我只会在请求图表时查询数据库。或者甚至是定时的。如果您的数据允许，您也只能从数据库中请求更新信息。如果不了解更多有关应用程序和数据的信息，很难推荐一些东西。

# c# - 休眠子查询

> ID：11871580
> 
> 赞同：1
> 
> 时间：2012-08-08T19:16:13.497
> 
> 标签：c#, nhibernate, nhibernate-mapping, hibernate-criteria

我在尝试为以下情况编写查询时遇到了巨大的困难：

在我的核心框架中（我无法修改，因为它不是我们的代码）我有两个类：

```
[Class(Table = "Teacher")]
public class Teacher
{
    [Id]
    public virtual long? Id {get;set;}

    [Property]
    public virtual string EmployeeNr{get;set;}
}

[Class(Table = "Student")]
public class Student
{
    [Id]
    public virtual long? Id{get;set;}

    [Property]
    public virtual string Name{get;set;}
} 
```

接下来，在我的应用程序层中，我创建了以下类来记录有关学生和教师进行测试的信息

```
[Class(Table = "TestReports", DiscriminatorValueObject = 1)]
public class TestReport
{
    [Id]
    public virtual long? Id{get;set;}

    [Property]
    public virtual string TestName{get;set;}

    [Property]
    public virtual DateTime Date{get;set;}

    [Property]
    public virtual int Correct{get;set;}

    [Property]
    public virtual int InCorrect{get;set;}

    [Property]
    public virtual int Unanswerd{get;set;}

}

[Subclass(NameType = typeof(StudentTestReport), ExtendsType = typeof(TestReport), DiscriminatorValueObject = 2)]
public class StudentTestReport
{
    [ManyToOne]
    public virtual Student Student{get;set;}
}

[Subclass(NameType = typeof(TeacherTestReport), ExtendsType = typeof(TestReport), DiscriminatorValueObject = 3)]
public class TeacherTestReport
{
    [ManyToOne]
    public virtual Teacher Teacher{get;set;}
} 
```

现在我想要的是一个查询来获取所有学生和老师的最后一个测试报告**但是如果老师或学生没有参加任何测试，他们仍然应该出现在概览中**。所以我决定采用 AliasToBeanTranformer 方法并为报表创建一个包装器对象：

```
public class TestOverviewWrapper
{
    public virtual string TestName{get;set;}
    public virtual DateTime Date{get;set;}
    public virtual int Correct{get;set;}
    public virtual int InCorrect{get;set;}
    public virtual int Unanswerd{get;set;}
    public virtual long Id{get;set;}
    public virtual string Name{get;set;}
    public virtual string EmployeeNr{get;set;}

    public virtual string Person
    {
            get{ return Name ?? EmployeeNr;}
    }
} 
```

我在正确查询时遇到了很大的麻烦，我试图看看我是否只能得到学生和他们的最后一个测试报告，但是我卡住了将子查询的属性投影到包装器对象中。这是我走了多远：

```
public IList<TestOverviewWrapper> GetTestOverview()
{
    var crit = SessionFactory.GetCurrentSession().CreateCriteria<Student>("st");

    var dcrit = DetachedCriteria.For<StudentTestReport>("lastTest")
        .Add(Subqueries.PropertyEq("Date",
                                   DetachedCriteria.For<StudentTestReport>("test")
                                       .Add(Restrictions.EqProperty("lastTest.Student", "st.Id"))
                                       .SetProjection(Projections.Max("lastTest.Date"))));

    dcrit.Add(Restrictions.EqProperty("lastTest.Student", "st.Id"));

    crit.Add(Subqueries.Select(dcrit));

    crit.SetProjection(Projections.ProjectionList()
                            .Add(Projections.Property("lastTest.Id")
                            .Add(Projections.Property("lastTest.TestName")
                            .Add(Projections.Property("lastTest.Date")
                            .Add(Projections.Property("lastTest.Correct")
                            .Add(Projections.Property("lastTest.Incorrect")
                            .Add(Projections.Property("lastTest.Unanswerd")
                            .Add(Projections.Property("st.Id")
                            .Add(Projections.Property("st.Name")
                        );

    crit.SetResultTransformer(Transformers.AliasToBean<TestOverview>());
    return crit.List<TestOverviewWrapper>();
} 
```

谁能指出我正确的方向，记住我不能在学生和教师班级上添加映射

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T09:08:29.083

有一个名为 Future 的方便功能可以一起批量选择。鉴于以下

```
public class TestOverviewWrapper
{
    public virtual string TestName { get; set; }
    public virtual DateTime Date { get; set; }
    public virtual int Correct { get; set; }
    public virtual int InCorrect { get; set; }
    public virtual int Unanswerd { get; set; }
    public virtual long Id { get; set; }
    public virtual string Person { get; set; }
} 
```

查询（IES）看起来像

```
var studentTests = session.CreateCriteria<StudentTestReport>("test")
    .Add(Subqueries.PropertyEq("Date", DetachedCriteria.For<StudentTestReport>()
        .Add(Restrictions.EqProperty("Student", "test.Student"))
        .SetProjection(Projections.Max("lastTest.Date"))))
    .CreateAlias("Student", "student")
    .SetProjection(Projections.ProjectionList()
        .Add(Projections.Property("TestName"), "TestName")
        .Add(Projections.Property("Date"), "Date")
        .Add(Projections.Property("Correct"), "Correct")
        .Add(Projections.Property("Incorrect"), "Incorrect")
        .Add(Projections.Property("Unanswerd"), "Unanswerd")
        .Add(Projections.Property("student.Id"), "Id")
        .Add(Projections.Property("student.Name"), "Person"))
    .SetResultTransformer(Transformers.AliasToBean<TestOverviewWrapper>())
    .Future<TestOverviewWrapper>();

var studentsWithoutTests = session.CreateCriteria<Student>("student")
    .Add(Subqueries.NotExists(DetachedCriteria.For<StudentTestReport>()
        .Add(Restrictions.EqProperty("Student", "student"))))
    .SetProjection(Projections.ProjectionList()
        .Add(Projections.Property("Id"), "Id")
        .Add(Projections.Property("Name"), "Person"))
    .SetResultTransformer(Transformers.AliasToBean<TestOverviewWrapper>())
    .Future<TestOverviewWrapper>();

var teacherTests = session.CreateCriteria<TeacherTestReport>("test")
    .Add(Subqueries.PropertyEq("Date", DetachedCriteria.For<TeacherTestReport>()
        .Add(Restrictions.EqProperty("Teacher", "test.Teacher"))
        .SetProjection(Projections.Max("lastTest.Date"))))
    .CreateAlias("Teacher", "teacher")
    .SetProjection(Projections.ProjectionList()
        .Add(Projections.Property("TestName"), "TestName")
        .Add(Projections.Property("Date"), "Date")
        .Add(Projections.Property("Correct"), "Correct")
        .Add(Projections.Property("Incorrect"), "Incorrect")
        .Add(Projections.Property("Unanswerd"), "Unanswerd")
        .Add(Projections.Property("teacher.Id"), "Id")
        .Add(Projections.Property("teacher.EmployeeNr"), "Person"))
    .SetResultTransformer(Transformers.AliasToBean<TestOverviewWrapper>())
    .Future<TestOverviewWrapper>();

var teacherWithoutTests = session.CreateCriteria<Teacher>("teacher")
    .Add(Subqueries.NotExists(DetachedCriteria.For<TeacherTestReport>()
        .Add(Restrictions.EqProperty("Teacher", "teacher"))))
    .SetProjection(Projections.ProjectionList()
        .Add(Projections.Property("Id"), "Id")
        .Add(Projections.Property("EmployeeNr"), "Person"))
    .SetResultTransformer(Transformers.AliasToBean<TestOverviewWrapper>())
    .Future<TestOverviewWrapper>();

return studentTests.Concat(studentsWithoutTests).Concat(teacherTests).Concat(teacherWithoutTests); 
```

# c++ - 这是一个 g++ 错误、libc 错误，还是我疯了（或者三个都疯了）？

> ID：11871582
> 
> 赞同：2
> 
> 时间：2012-08-08T19:16:20.323
> 
> 标签：c++, stl, g++

当我遇到内存访问错误时，我正在使用一些 openFrameworks 示例。经过一天缩小问题的范围后，我有一个相当小的相对纯 C++ 代码示例，它仍然会导致内存访问错误。我会在这里发布整个内容，因为它很短。

共有三个文件：testApp.cpp、main.cpp 和 testApp.h。

测试应用程序.h：

```
#include <cstdlib>
#include <iostream>
#include <vector>
#include <string>
using namespace std;
class X {
public:

  X();
  virtual ~X();

private:

  vector<string> vertices;
  vector<string> colors;
  vector<string> normals;
  vector<string> texCoords;
  vector<string> indices;
  bool bVertsChanged, bColorsChanged, bNormalsChanged, bTexCoordsChanged, bIndicesChanged;
  int mode;
  string name;

  bool useColors;
  bool useTextures;
  bool useNormals;
};

class testApp{

public:
  void setup();

  X x1;
  X x2;
  vector<string> stroke;
}; 
```

测试应用程序.cpp：

```
#include "testApp.h"

X::X() {}
X::~X() {}

void testApp::setup(){
  std::cout << stroke.size() << std::endl;

} 
```

主.cpp：

```
#define _GLIBCXX_DEBUG
#include "testApp.h"

int main( ){

    testApp* o = new testApp();
    o->setup();
    std::cout << o->stroke.size() << std::endl;

} 
```

为了编译，我输入：`g++ -o testApp testApp.cpp main.cpp`. （我正在使用带有股票 g++ 编译器版本 4.6.3、x86_64 架构的 Ubuntu 12.04）。当我运行它时，我得到这个输出：

```
18446744073709025734
0 
```

第一个数字来自调用 testApp::setup，它打印出 stroke.size()（这显然是不正确的）。第二个数字来自直接打印 stroke.size() 。似乎存在某种内存问题，但我不知道从哪里开始，或者在哪里提交错误。

这似乎只在 testApp 类被完全指定时才会发生。如果您注释掉单个向量（甚至是布尔值），问题就会消失。如果您注释掉，问题也会消失`_GLIBCXX_DEBUG`，但该标志应该是良性的 AFAIK。有什么建议吗？我应该在哪里提交错误？还是有什么明显的我忽略了？

另外，有人介意在他们自己的计算机/编译器上尝试这个，看看他们是否遇到同样的问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T19:20:05.413

`_GLIBCXX_DEBUG`可能会更改标准库容器的定义，因此您的程序违反了[单一定义规则 (ODR)](https://stackoverflow.com/questions/4192170/what-exactly-is-one-definition-rule-in-c)。`X`main.cpp 翻译单元和 testApp.cpp 翻译单元中的定义不同，导致未定义的行为。

# c++ - C++ std::map 字符串到指针

> ID：11871583
> 
> 赞同：0
> 
> 时间：2012-08-08T19:16:28.817
> 
> 标签：c++, stl, map, direct3d

我目前正在将 C++ 与 Direct3D 一起使用，并正在尝试更改我的资产存储。

现在我的资产存储为“矢量纹理列表”，并使用枚举定义获得。

我想通过使用 STL 地图类使课程更加开放。但是，我以前从未使用过这个类，并且遇到了我不理解的问题。

我刚刚做了一切非常简单的测试，目前有以下内容：

```
#include <d3d9.h>
#include <d3dx9.h>
#include <map>
#include <string>

#pragma comment (lib, "d3d9.lib") 
#pragma comment (lib, "d3dx9.lib") 

using namespace std;

class Assets
{
private:
typedef std::map<string, IDirect3DTexture9*> TexMap;
TexMap textureList;

public:
IDirect3DTexture9* LoadTexture(IDirect3DDevice9* pd3dDevice, LPCWSTR file, string key)
{     
    //load a texture from file
    IDirect3DTexture9*      tex;

    //D3DXCreateTextureFromFile(pd3dDevice, file, &tex);
    D3DXCreateTextureFromFileEx(pd3dDevice, file, 512, 512, 0, 0, D3DFMT_UNKNOWN, D3DPOOL_MANAGED, D3DX_DEFAULT, D3DX_DEFAULT, 0xFF000000, NULL, NULL, &tex);

    //store the loaded texture to a vector array
    textureList.insert(TexMap::value_type(key, tex));
    return S_OK;
}
} 
```

当我尝试运行它时，出现“调试断言失败”错误，表达式为“map/set iterators incompatible”

我只是觉得我在代码中做到了尽可能简单，但通过查看类似示例仍然看不到错误。

我还将代码运行为：

```
#include <d3d9.h>
#include <d3dx9.h>
#include <map>
#include <string>

#pragma comment (lib, "d3d9.lib") 
#pragma comment (lib, "d3dx9.lib") 

using namespace std;

class Assets
{
private:
typedef std::map<int, int> TexMap;
TexMap textureList;

public:

IDirect3DTexture9* LoadTexture(IDirect3DDevice9* pd3dDevice, LPCWSTR file, string key)
    {     

    //load a texture from file
    IDirect3DTexture9*      tex;

    //D3DXCreateTextureFromFile(pd3dDevice, file, &tex);
    D3DXCreateTextureFromFileEx(pd3dDevice, file, 512, 512, 0, 0, D3DFMT_UNKNOWN, D3DPOOL_MANAGED, D3DX_DEFAULT, D3DX_DEFAULT, 0xFF000000, NULL, NULL, &tex);

    //store the loaded texture to a vector array
    //textureList.push_back(tex);
    textureList.insert(TexMap::value_type(3, 4));
    return S_OK;
}
} 
```

就这样它只是使用整数，我仍然得到同样的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:48:51.490

该错误实际上可能非常基本 -`D3DXCreateTextureFromFileEx`想要 type`IDirect3DTexture9*`作为最后一个参数，但你给它 type `IDirect3DTexture9**`。也就是改变

```
D3DXCreateTextureFromFileEx(..., &tex); 
```

至

```
D3DXCreateTextureFromFileEx(..., tex); 
```

# cakephp - 当我在该项目中上传图像时，在 cakephp 中保存项目时出错

> ID：11871585
> 
> 赞同：1
> 
> 时间：2012-08-08T19:16:31.400
> 
> 标签：cakephp

我第一次在 cakephp 工作。我能够开始使用具有图像变量的产品模型。我可以上传图片，但之后我无法保存到产品中。这是我的 add.ctp

```
<div class="products form">
<?php echo $this->Form->create('Product', array('enctype' => 'multipart/form-data')); ?>
    <fieldset>
        <legend><?php echo __('Add Product'); ?></legend>
    <?php
        echo $this->Form->input('name');
        echo $this->Form->input('slug');
        echo $this->Form->input('description');
        echo $this->Form->input('price');
        echo $this->Form->input('weight');

            //upload image    
            echo $this->Form->input('Product.image', array('type'=>'file', 'tmp_name'=>'temp'));

    ?>
    </fieldset>
<?php echo $this->Form->end(__('Submit')); ?>
</div>
<div class="actions">
    <h3><?php echo __('Actions'); ?></h3>
    <ul>

        <li><?php echo $this->Html->link(__('List Products'), array('action' => 'index')); ?></li>
    </ul>
</div> 
```

这是我的 ProductsController add() 功能

```
 public function add($seller_id = null) {
        if ($this->request->is('post')) {
            $this->Product->create();
            debug($this->request->data);
                            if(isset($this->request->data["Product"]["image"]["name"]))
                            {
                                $file = new File($this->request->data["Product"]["image"]["name"]);
                                debug($this->request->data);
                                $ext = pathinfo(($this->request->data["Product"]["image"]["name"]), PATHINFO_EXTENSION);

                                if ($ext != 'jpg' && $ext != 'jpeg' && $ext != 'gif' && $ext != 'png') 
                                {
                                    $this->Session->setFlash('You may only upload image files.');
                                }else
                                {
                                    if(move_uploaded_file($this->request->data["Product"]["image"]["tmp_name"],WWW_ROOT."/img/uploads/" . $this->data["Product"]["image"]["name"]) == true)
                                    {
                                        $this->data["Product"]["image"] =  $this->data["Image"]["image"]["name"];
                                    }
                                }
                                if ($this->Product->save($this->request->data)) //error here
                                {
                                    $this->Session->setFlash(__('The product has been saved'));
                                    $this->redirect(array('action' => 'index'));
                                    $this->request->data['Product']['seller_id'] = $seller_id;
                                }
                                else {
                                    $this->Session->setFlash(__('The product could not be saved. Please, try again.'));
            }

                        }$this->Session->setFlash(__('The image could not be saved. Please, try again.'));
        }

    } 
```

谁能看到为什么它会上传和移动图像但不保存产品？此外，这里是 debug($this->request->data);

```
array(
    'Product' => array(
        'name' => '8',
        'slug' => '8',
        'description' => '8',
        'price' => '8',
        'weight' => '8',
        'image' => array(
            'name' => 'celeb16.com-purple-strapless-short-bridesmaid-dress-g129-33(1).jpg',
            'type' => 'image/jpeg',
            'tmp_name' => 'C:\xampp\tmp\phpDD08.tmp',
            'error' => (int) 0,
            'size' => (int) 1404
        )
    )
) 
```

另一条可能有用的信息是，当我使用此代码时：

```
<?php echo $this->Form->create('Product', array('enctype' => 'multipart/form-data')); ?> 
```

它将允许图像正确上传，但不会保存产品，当我使用此代码时：

```
 <?php echo $this->Form->create('Product'); ?> 
```

它将保存产品但不上传图片

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T20:28:26.593

您需要在移动图像之前保存数据，试试这个..

```
 if ($this->Product->save($this->request->data)) //error here
                            {
                                $this->Session->setFlash(__('The product has been saved'));
                                $this->redirect(array('action' => 'index'));
                                $this->request->data['Product']['seller_id'] = $seller_id;
                            }
  if(move_uploaded_file($this->request->data["Product"]["image"]["tmp_name"],WWW_ROOT."/img/uploads/" . $this->data["Product"]["image"]["name"]) == true)
                                {
                                    $this->data["Product"]["image"] =  $this->data["Image"]["image"]["name"];
                                }
                            } 
```

希望这对你有用

这是我之前如何实现文件上传的示例，请尝试将其用作指南，我建议保持简单，如果您想限制文件类型，我建议在 MODEL 中执行此操作。

```
public function add() {

 if($this->request->is('post')){

 $file = $this->request->data['Upload']['file'];
 if($this->Upload->save($this->data) && move_uploaded_file($file['tmp_name'],APP.'webroot/files/uploads'.DS.$this->Upload->id.'.mp4')) 
 {
 $this->Session->setFlash('<p class="uploadflash">The upload has been saved</p>', true);
 $this->redirect(array('controller'=>'Uploads', 'action' => 'watch', $this->Upload->id));
 }  else {
 $this->Session->setFlash('<p class="loginerror">The upload could not be saved, mp4 files can be saved only.</p>', true);   
 }
 }
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T21:57:25.263

尝试更改此行：

```
$this->data["Product"]["image"] =  $this->data["Image"]["image"]["name"]; 
```

对此：

```
$this->request->data["Product"]["image"] =  $this->request->data["Image"]["image"]["name"]; 
```

在您尝试操作的原始代码中`$this->data`，在您的保存调用中，您正在引用`$this->request->data`：

```
$this->Product->save($this->request->data) 
```

希望这应该可以解决问题，如果没有错误本身就很难说:)

# php - PHP 正则表达式不起作用。反斜杠的问题？

> ID：11871592
> 
> 赞同：2
> 
> 时间：2012-08-08T19:16:53.980
> 
> 标签：php, regex, backslash

有问题的正则表达式：

```
$reg = '/[.]{1,}[\/\\]/';
if(preg_match($reg, $dir))... 
```

我已经在[http://regexpal.com](http://regexpal.com)和[http://regex.larsolavtorvik.com/](http://regex.larsolavtorvik.com/)上测试了这个表达式，它运行良好，但是在我的 PHP 脚本中我收到了这个通知。

```
Message: preg_match() [function.preg-match]: Compilation failed: missing terminating ] for character class at offset 12 
```

我弄乱了“\”的数量，但它没有改变任何东西。关于可能出现问题的任何建议？

我试图寻找类似的问题，但我似乎遇到的只是没有添加分隔符的人。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T19:22:30.623

那是因为`\\`将被 PHP 转义为单个`\`，这将使`preg_match`您的模式评估为

```
/[.]{1,}[\/\]/ 
```

要在 PHP 字符串中有 2 个反斜杠，您实际上需要输入 4：

```
$reg = '/[.]{1,}[\/\\\\]/';
preg_match($reg, "test"); 
```

或者使用 PHP 的 heredoc：

```
$reg = <<<REGEX
/[.]{1,}[\/\\\\]/
REGEX;
preg_match($reg, "test"); 
```

**编辑：**似乎 Heredoc 也需要 4 个反斜杠。那是因为像`\n`.

# python - Python对非序列的迭代

> ID：11871593
> 
> 赞同：16
> 
> 时间：2012-08-08T19:16:57.143
> 
> 标签：python

我有这段代码可以创建一个笔记并添加到笔记本中。当我运行它时，我得到一个非序列错误的迭代。

```
import datetime
class Note:
    def __init__(self, memo, tags):
        self.memo = memo
        self.tags = tags
        self.creation_date = datetime.date.today()

def __str__(self):
    return 'Memo={0}, Tag={1}'.format(self.memo, self.tags)

class NoteBook:
     def __init__(self):
        self.notes = []

     def add_note(self,memo,tags):
        self.notes.append(Note(memo,tags))

if __name__ == "__main__":
    firstnote = Note('This is my first memo','example')
    print(firstnote)
    Notes = NoteBook()
    Notes.add_note('Added thru notes','example-1')
    Notes.add_note('Added thru notes','example-2')
    for note in Notes:
        print(note.memo) 
```

错误：

```
C:\Python27\Basics\OOP\formytesting>python notebook.py  
Memo=这是我的第一个备忘录，Tag=example  
回溯（最近一次通话最后）：  
  文件“notebook.py”，第 27 行，在   
    注意事项中的注意事项：  
TypeError：对非序列的迭代
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-08T19:21:54.697

您正在尝试迭代对象本身，这将返回错误。您想遍历对象内部的列表，在这种情况下`Notes.notes`（这有点令人困惑的命名，您可能希望通过使用笔记本对象实例的另一个名称来区分内部列表）。

```
for note in Notes.notes:
    print(note.memo) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-08T19:21:28.807

Notes 是`NoteBook`. 要遍历这样的对象，它需要一个[`__iter__`方法](http://docs.python.org/reference/datamodel.html#object.__iter__)：

```
class NoteBook:

    def __iter__(self):
        return iter(self.notes) 
```

PS。Python 中的[PEP8](http://www.python.org/dev/peps/pep-0008/)建议/约定将小写变量名用于类的实例，将 CamelCase 用于类名。遵循此约定将帮助您立即从您的类中识别您的类实例。

如果您希望遵循此约定（并让喜欢此约定的其他人喜欢自己），请更改`Notes`为`notes`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-08T19:23:47.197

如果您想实际迭代 Notes 本身，您还可以添加自定义`__iter__ method to it that returns the .notes property.`

```
class Notebook:

    def __iter__(self):
        return iter(self.notes)

    ... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-08T19:21:06.157

问题出在一行`for note in Notes:` ，因为 Notes 是一个**对象**而不是列表。我相信你想要`for note in Notes.notes:`

也正如 unutbu 指出的那样，您可以重载`__iter__`运算符，这将允许您当前的循环工作。这取决于您希望它如何外观。我个人会超载`__iter__`

# active-directory - 在 Active Directory 中创建员工-经理关系

> ID：11871594
> 
> 赞同：3
> 
> 时间：2012-08-08T19:17:06.080
> 
> 标签：active-directory, activedirectorymembership, active-directory-group

所以必须在 Active 目录中放置一些员工-经理关系的数据结构。

员工列表已存在于 Active Directory 中。我可以创建经理组并将一些员工分配为经理吗？之后，我可以将其他员工分配给这些经理。

请帮忙。蒂亚·罗恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:51:32.280

Active Directory 中的每个类型对象`Person`都已具有一个`Manager`属性。

通过将经理的 DN（专有名称）设置到该属性中，您实际上是在将用户分配给他/她的经理。

```
DirectoryEntry deEmployee = new DirectoryEntry("LDAP://CN=John Employee,OU=Sales,DC=Corp,DC=com");

deEmployee.Property["manager"] = "CN=Peter Manager,OU=Sales,DC=Corp,DC=com";
deEmployee.CommitChanges(); 
```

员工都将拥有一个`Manager`属性 - 只需使用其经理的 DN（专有名称）填充这些属性 - 您应该进行设置。

当然 - 这些经理也有一个`Manager`属性，因此您可以根据需要创建任何深度的管理层次结构

# c# - 如何检查我是否已连接？

> ID：11871601
> 
> 赞同：1
> 
> 时间：2012-08-08T19:17:42.757
> 
> 标签：c#, sockets, asynchronous

全部，我正在编写一个需要与服务器建立**异步阻塞**连接的应用程序。我有一个带有按钮的 GUI 表单和一个与 BeginConnect/EndConnect 对执行连接的类。该实现遵循[此](http://msdn.microsoft.com/en-us/library/bew39x2a.aspx)MSDN 示例。

但是，在回调方法中抛出了异常。这是我试图避免的。我想要的是检查连接是否已经建立，以及它是否没有将适当的错误作为我的 GUI 表单上的文本吐出。

我试图检查 BeginConnect() 的返回值，但它在调用静态方法之前返回。当我建立连接（按钮单击事件）时，我试图重新抛出异常并捕获它，但它不起作用。异常没有被捕获。

如何检查是否已建立连接？

我可能可以将我的文本控件传递给连接类，并在捕获异常时将文本设置为错误，但是还有其他方法吗？

谢谢你。

[编辑]

```
class InternetConnector
{
    public void ConnectToHost()
    {
        IPEndPoint ip = new IPEndPoint(IPAddress.Parse(connector_host), connector_port);
        client = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
        client.Blocking = true;
        client.BeginConnect(ip, new AsyncCallback(ConnectCallback), client);
    }

    private static void ConnectCallback(IAsyncResult ar)
    {
        try
        {
            Socket sock = (Socket)ar.AsyncState;
            sock.EndConnect(ar);
            connectDone.Set();
            Connected = true;
        }
        catch (Exception e)
        {
            throw (e);
        }
    }
}

public partial class Form1 : Form
{
    private bool isRunning = false;
    private InternetConnector client = new InternetConnector();

    private void startStop_Click(object sender, EventArgs e)
    {
        try
        {
            if (!isRunning || !InternetConnector.Connected)
            {
                if (!InternetConnector.Connected)
                {
                    client.SetAddress(ipAddress.Text);
                    client.SetPort(Convert.ToInt32(connectionport.Text));
                    client.ConnectToHost();
                    status.Text = "Signals Receiver: Connected";
                    status.ForeColor = Color.Green;
                    startStop.Text = "Stop";
                    isRunning = true;
                }
                else
                {
                    startStop.Text = "Start";
                    client.DisconnectFromHost();
                    isRunning = false;
                }
            }
        }
        catch(Exception ex)
        {
            status.Text = "Socket Error: " + ex.Message;
        }
    }
 } 
```

如果我使用“throw(e);” 在回调中捕获块异常未在单击侦听器中捕获。但是回调中需要 try/catch，因为错误的连接会抛出异常而不返回错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T20:25:01.117

因为您使用的是异步 BeginConnect，所以回调几乎不会发生在与单击处理程序相同的线程上，因此您的单击处理程序无法捕获异常。

如果需要通过异步回调设置 UI 元素的状态，通常需要在创建 UI 的同一线程上执行委托。

任何从 Control 派生的 UI 元素都有一些方法可以帮助您做到这一点（`InvokeRequired`和`BeginInvoke`）。我已经修改了您的示例以帮助说明这一点。

基本上，您可以传入一个 Action 委托，如果它发生在异步 Connect 回调中，该委托将被调用。然后，此错误处理委托可以完成所有工作，以根据异步连接回调期间引发的异常设置 UI 状态。

因为我们需要传入错误处理委托，所以我们必须创建一个结构（称为 ConnectionData）来保存我们需要在异步连接回调中访问的所有状态（套接字和错误处理程序）。

```
class InternetConnector  
{  
    private struct ConnectionData
    {
        public Action<Exception> ErrorHandler { get; set; }
        public Socket Socket { get; set; }
    }

    public void ConnectToHost(Action<Exception> errorHandler)  
    {  
        IPEndPoint ip = new IPEndPoint(IPAddress.Parse(connector_host), connector_port);  
        client = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);

        var connectionData = new ConnectionData { ErrorHandler = errorHandler, Socket = client };

        client.Blocking = true;  
        client.BeginConnect(ip, new AsyncCallback(ConnectCallback), connectionData);  
    }  

    private static void ConnectCallback(IAsyncResult ar)  
    {  
        ConnectionData connectionData = new ConnectionData();
        try  
        {  
            connectionData = (ConnectionData)ar.AsyncState;  
            connectionData.Socket.EndConnect(ar);  
            connectDone.Set();  
            Connected = true;  
        }  
        catch (Exception e)  
        {  
            if (connectionData.ErrorHandler != null)
                connectionData.ErrorHandler(e);
        }  
    }  
}  

public partial class Form1 : Form       
{       
    private bool isRunning = false;       
    private InternetConnector client = new InternetConnector();       

    private void AsyncErrorHandler(Exception e)
    {
        if (status.InvokeRequired)
        {
            // queue a call to ourself on control's UI thread and immediately return
            status.BeginInvoke(new Action(()=>AsyncErrorHandler(e)));
            return;
        }

        // we are on the right thread to set the status text
        status.Text = "Async Error: " + ex.Message;  
    }

    private void startStop_Click(object sender, EventArgs e)       
    {       
        try       
        {       
            if (!isRunning || !InternetConnector.Connected)       
            {       
                if (!InternetConnector.Connected)       
                {       
                    client.SetAddress(ipAddress.Text);       
                    client.SetPort(Convert.ToInt32(connectionport.Text));       

                    // connect, pass in the method to use for error reporting
                    client.ConnectToHost(AsyncErrorHandler);       

                    status.Text = "Signals Receiver: Connected";       
                    status.ForeColor = Color.Green;       
                    startStop.Text = "Stop";       
                    isRunning = true;       
                }       
                else       
                {       
                    startStop.Text = "Start";       
                    client.DisconnectFromHost();       
                    isRunning = false;       
                }       
            }       
        }       
        catch(Exception ex)       
        {       
            status.Text = "Socket Error: " + ex.Message;       
        }       
    }       
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T19:22:01.570

有属性[Socket.Connected](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.connected.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T19:22:27.283

在窗口中

> [返回值](http://msdn.microsoft.com/en-us/library/windows/desktop/ms737625%28v=vs.85%29.aspx)
> 
> 如果没有发生错误，connect 返回零。否则，它返回 SOCKET_ERROR，并且可以通过调用 WSAGetLastError 来检索特定的错误代码。

# database - 如何在任何条件下将列的值提取到列表框？

> ID：11871602
> 
> 赞同：0
> 
> 时间：2012-08-08T19:17:42.883
> 
> 标签：database, delphi, listbox, delphi-7

我有一个数据库，里面有一个“**用户表**”。在此表中，有包含用户信息的列（站点、昵称、jeton、邮件、sifre）。我正在尝试制作基于信用系统的程序。任何用户运行程序，如果用户信用等于列表框中的站点数（我的意思是行数），则用户站点将出现在列表框中。否则不会出现。

在数据库中，“credits”列中的值必须等于列表框中的行数。例如，如果任何用户的信用值为 4，并且列表框中有 5 行，则该用户站点将不会添加到列表框中。但是如果用户的信用值是5或更高，他/她的站点将被添加（列出）在列表框中。

**uyeler** = 表

**nick** = 用户名列。

**site** = 用户站点名称列。

**jeton** = 用户信用栏。

**邮件**= 用户邮件列。

**sifre** = 用户密码列。

**我试过这些；**

```
MyQuery1.Close;
 MyQuery1.SQL.Text :='SELECT jeton, site FROM uyeler WHERE jeton > 0 ORDER BY site';
  MyQuery1.Open;
  ListBox1.Items.Clear;
  If (MyQuery1.IsEmpty) or (MyQuery1.FieldByName('jeton').AsString > IntToStr(Listbox1.Items.Count)) Then
  Begin
  MessageDlg('warning: you have not credit!', mtWarning,[mbOK],0)
  End
  Else
  Begin
  While not MyQuery1.Eof do
  Begin
  ListBox1.Items.Add(MyQuery1.Fields[1].AsString);
  MyQuery1.Next;
  end;
 MyQuery1.Close;
End; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T05:16:00.593

如果我理解正确的话。有一个网站列表框。如果运行该程序的用户的积分等于列表框中的行数，则该用户的站点将被添加到列表框中。此外，我正在假设一个用户可以拥有多个站点。

首先更改您的 sql 查询以根据是否找到用户返回数据。IE

> 将下面的代码视为伪代码！

```
MyQuery1.SQL.Text :='SELECT jeton, site FROM uyeler WHERE nick =:nick and jeton > 0 ORDER BY site';
MyQuery.Params['nick'] = userName;  //Check syntax as this line is meant as pseudo code

int noOfUserCredits = MyQuery1.FieldByName('jeton');

if (noOfUserCredits >= listBox.lines.Count)
begin
  while not MyQuery1.Eof do
  begin
    ListBox1.Items.Add(MyQuery1.FieldByName('site').AsString);
    MyQuery1.Next;
  end;
end else
if (noOfUserCredits < listBox.lines.Count)
begin
  //Do stuff
end else
if ((noOfUserCredits == 0) or (MyQuery1.IsEmpty))
begin
  MessageDlg('warning: you have not credit!', mtWarning,[mbOK],0);
end; 
```

# asp.net - ASP.NET Dropdownlist 控件参数问题

> ID：11871603
> 
> 赞同：0
> 
> 时间：2012-08-08T19:17:53.543
> 
> 标签：asp.net, sql, drop-down-menu, parameters, guid

所以我有两个下拉列表，第一个包含来自数据源的项目，其值为 GUID 和静态项目。

```
<asp:DropDownList runat="server" ID="CategoryDDL" DataSourceID="SqlDataSource1" DataTextField="Name" DataValueField="categoryID" AutoPostBack="True" AppendDataBoundItems="True" >
     <asp:ListItem Value="(Select Category)">(New Category)</asp:ListItem>
</asp:DropDownList>
<asp:SqlDataSource ID="SqlDataSource1" runat="server" ConnectionString="<%$ ConnectionString%>" SelectCommand="SELECT categoryID, Name FROM category"></asp:SqlDataSource> 
```

其他的下拉列表很类似，但是作为控制参数集读取的值首先，并且再次包含一个静态项。

```
<asp:DropDownList runat="server" ID="itemDDL" DataSourceID="SqlDataSource2" DataTextField="item" DataValueField="itemID">
      <asp:ListItem Value="(Select Item)">(New Question)</asp:ListItem>
</asp:DropDownList>
<asp:SqlDataSource ID="SqlDataSource2" runat="server" ConnectionString="<%$ ConnectionString%>" SelectCommand="SELECT itemID, categoryID, item FROM Items WHERE (categoryID = @categoryID)">
    <SelectParameters>
            <asp:ControlParameter ControlID="CategoryDDL" Name="categoryID" PropertyName="SelectedValue" />
      </SelectParameters>
</asp:SqlDataSource> 
```

如果第二个值不存在，如何让下拉列表忽略我的第一个值的值。或者更好的是，有没有一种方法可以从代码中调用 SQL 数据源并填充下拉列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T09:04:51.673

添加`OnSelecting="SqlDataSource2_Selecting"`到第二个下拉列表中，以便在无法获取有效 GUID 时取消选择命令。

```
Dim GUIDRef As Guid

Protected Sub SqlDataSource2_Selecting(sender As Object, e As SqlDataSourceSelectingEventArgs) Handles SqlDataSource2.Selecting
    If Not Guid.TryParse(CategoryDDL.SelectedValue, GUIDRef) Then
        e.Cancel = True
    End If

End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T19:42:10.007

我还不清楚你的问题，但我认为你必须使用下拉列表的 SelectedIndexChanged

```
private void itemDDL_SelectedIndexChanged()
{
      // check the item in the first dropdown and do your work
} 
```

# apache - 使用 htaccess 进行 url 重定向和重写

> ID：11871614
> 
> 赞同：0
> 
> 时间：2012-08-08T19:18:32.560
> 
> 标签：apache, .htaccess, url, url-rewriting

我正在尝试将动态 url 重写为 SEO url。我为此创建了 htaccess 代码但问题是用户何时键入地址，如**http://example.com/anoop** ， **http://example.com/ anoop/vvv**或**http://example.com/anoop/vvv/kkk**然后它会进入错误页面。最后我决定在每个目录中自动添加反斜杠。我为此创建了htaccess代码

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^/(.*[^/]+)$ /$1/ [R=301,L] 
RewriteRule ^([^/]*)/$ /?cat=$1 [L]
RewriteRule ^([^/]*)/([^/]*)/$ /?cat=$1&sub=$2 [L] 
```

但是现在自动将反斜杠添加到**http://example.com/anoop/** 。但是如果不存在反斜杠，我想添加反斜杠

例如

```
http://example.com/anoop/activity -     http://example.com/anoop/activity/
http://example.com/anoop/act/page -     http://example.com/anoop/act/page/ 
```

现在**http://example.com/anoop/activity**将被重定向到错误页面。请帮助我任何人重写程序

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:24:01.950

我不确定我是否理解这个问题。您想添加反斜杠吗？看起来它奏效了！您如何尝试重写 URL？如果您为 Web 应用程序重写 URL，则 Web 应用程序将必须处理 URL 并相应地显示数据。您是为 Web 应用程序还是为静态网站重写 URL？

**编辑**

这是 Wordpress 的做法。

```
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /
    RewriteRule ^index\.php$ - [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.php [L]
</IfModule> 
```

# javascript - `=` 和 `==` 操作符和 `===` 有什么区别？（单、双、三等号）

> ID：11871616
> 
> 赞同：2
> 
> 时间：2012-08-08T19:18:38.060
> 
> 标签：javascript, operators, equality, assignment-operator

我写了一些代码，在某些地方`==`是必需的，在其他地方`=`是必需的。有人可以解释这些差异或指出我可以使用的资源方向吗？

例子：

```
if($("#block").css.display == "none"){
  $("#block").css.display = "block";
} 
```

我唯一能想到的是，在一个我正在改变，而在另一个我正在检查。但在两者中，我指的是平等。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-08T19:20:44.670

`=`是赋值运算符。它将一个变量（左侧）设置为一个值（右侧）。结果是右侧的值。

`==`是比较运算符。`true`只有在将它们的类型强制为相同类型后，如果两个值相等，它才会返回。

`===`是更严格的比较运算符，通常称为恒等运算符。`true`只有当操作数的类型和值都相同时，它才会返回。

我会查看[CodeCademy](https://www.codecademy.com/tracks/javascript)以快速了解 JavaScript。

如果您喜欢阅读更多内容，[MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Guide)也是一个很好的介绍。

对于那些关心术语“身份运算符”来源的人，jbabey 指出[JavaScript: The Definitive Guide](https://docstore.mik.ua/orelly/webprog/jscript/ch05_04.htm)似乎提到了它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-08T19:21:16.967

`=`给变量赋值

`==`检查两个参数是否相等

`===`检查两个参数是否相等**以及**它们的类型是否相同

* * *

`!`不是运算符

`!=`检查两个参数是否不相等

`!==`检查两个参数是否不相等**或**类型不同

* * *

## 多一个

`>`检查一个参数是否大于另一个

`>=`检查一个参数是否大于或等于另一个

`>==`不存在

* * *

## 等等……

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-08T19:20:04.207

== 用于测试左边的值是否等于右边的值。

= 用于将右边的值赋给左边的变量。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-08T19:20:53.260

在 javascript 中，您也有 ===。

`=` 这是为变量设置值。

`==` 如果值相同，则用于比较。

`===` 如果值相同且类型相同，则用于比较。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-08T19:23:37.730

= 运算符是赋值运算符。您正在将一个对象分配给一个值。== 运算符是一个条件相等运算。您正在确认两件事是否具有相等的值。还有一个 === 运算符。这不仅比较值，还比较类型。

[赋值运算符](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Assignment_Operators)

[比较运算符](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Comparison_Operators?redirectlocale=en-US&redirectslug=Core_JavaScript_1.5_Reference/Operators/Comparison_Operators)

# c# - 如何根据起始集将一组时间间隔转换为另一组

> ID：11871617
> 
> 赞同：2
> 
> 时间：2012-08-08T19:18:37.740
> 
> 标签：c#, .net, algorithm, time, intervals

我有一组`setTimes`这样的时间间隔：

```
[a,d] [h,j] [k,l] 
```

另一组时间`rawTimes`是这样的：

```
[a,c] [b,e] [e,g] [f,i] [k,l] [i,m] 
```

`rawTimes`需要转换为新的区间，这些区间位于 指定的区间内`setTimes`。所以结果集是：

```
[a,c] [b,d] [h,i] [k,l] [i,j] [k,l] 
```

（其中 a < b < c ... < m）

基本上，结果集应该全部包含在`setTimes`集合中的一个区间内。有可能一个间隔`rawTimes`可以分成多个部分，或者它甚至永远不会进入最后一组。

目前我所做的是将`setTimes`间隔中的每个开始时间添加到一个名为的列表中`startTimes`，并将结束时间添加到`endTimes`. 所以：

```
startTimes = a , h , k
endTimes = d , j , l 
```

但我被困在那里。我不知道从那里去哪里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T21:05:22.623

[你可以用艾伦的区间代数](http://en.wikipedia.org/wiki/Allen%27s_interval_algebra)优雅地做到这一点

# microformats - 为什么这个食谱没有出现在 Google 食谱搜索结果中？

> ID：11871618
> 
> 赞同：0
> 
> 时间：2012-08-08T19:18:38.843
> 
> 标签：microformats, rich-snippets

我有[这篇博客文章](http://www.amateurgourmet.com/2012/08/drunk-blondies.html)，它使用富文本片段（微格式）进行编码，以向 Google 指示许多字段，包括包含配料的完整食谱、作者、烹饪时间和准备时间、照片等。

根据[谷歌的指导方针](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=173379)，我有足够的字段应该显示出来，谷歌的[富文本片段工具](http://www.google.com/webmasters/tools/richsnippets?url=http://www.amateurgourmet.com/2012/08/drunk-blondies.html)没有显示该页面的错误。

然而——谷歌没有爱。为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T02:48:52.607

对于初学者，您需要具有以下两个类： `photo` `prepTime`or `cookTime`or `totalTime`or `ingredients` `calories` `review`(nested)

我检查了第一个，`photo`虽然您的页面上确实有两个，但它们是相同的图像，并且第二个设置为`display:none`。不确定哪个或两者都将其扔掉。我会先开始他们的。然后确保我有所有其他要求。

# ruby - 在 Ruby 中，如何在动态创建的 DataMapper 模型上插入数据？

> ID：11871619
> 
> 赞同：0
> 
> 时间：2012-08-08T19:18:48.150
> 
> 标签：ruby, datamapper, fixture

我正在尝试为我的 Sinatra 应用程序构建“夹具”功能。我只是将数据库导出到带有数据库名称的 csv，并使用文件名作为通过 datamapper 访问类的引用。

我知道下面的数据库设置正在工作，因为“.destroy！” 正在工作中。但是我无法通过“.create”方法插入新数据，因为我不断收到“错误数量的参数（1 代表 0）”错误。

我试图手动插入数据（而不是行，实际上是写一个测试哈希），但错误仍然存​​在。

没关系，但我在捆绑环境（bundle exec rake db:fixtures）上通过 rake 运行下面的代码。

```
require 'data_mapper'
require 'config/database'

Dir["./models/fixtures/*.csv"].each do |file|
  class_name = DataMapper::Inflector.singularize(
    File.basename(file, '.csv').capitalize
  )
  current_model = Object.const_get(class_name)
  current_model.destroy!

  # Next 4 lines are turning the file CSV into a Hash of arrays,
  # so it can be used to perform the insert on the database.
  csv_data = CSV.read(file)
  headers = csv_data.shift.map {|i| i.to_sym }
  string_data = csv_data.map {|row| row.map {|cell| cell.to_s } }
  array_of_hashes = string_data.map {|row| Hash[*headers.zip(row).flatten] }

  current_model.transaction do
    array_of_hashes.each do |row|
      current_model.create(row)
    end
  end
end 
```

这是执行的 --trace 输出：

```
** Invoke db:fixtures (first_time)
** Execute db:fixtures
~ default: begin
~ default: rollback
rake aborted!
wrong number of arguments (1 for 0)
/Users/username/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/thread.rb:144:in initialize'
/Volumes/StaticData/fixtures/vendor/bundler/ruby/1.9.1/gems/dm-validations-1.2.0/lib/dm-validations.rb:129:innew'
/Volumes/StaticData/fixtures/vendor/bundler/ruby/1.9.1/gems/dm-validations-1.2.0/lib/dm-validations.rb:129:in create'
/Volumes/StaticData/fixtures/Rakefile:27:inblock (5 levels) in '
/Volumes/StaticData/fixtures/Rakefile:26:in each'
/Volumes/StaticData/fixtures/Rakefile:26:inblock (4 levels) in '
/Volumes/StaticData/fixtures/vendor/bundler/ruby/1.9.1/gems/dm-transactions-1.2.0/lib/dm-transactions.rb:373:in block in transaction'
/Volumes/StaticData/fixtures/vendor/bundler/ruby/1.9.1/gems/dm-transactions-1.2.0/lib/dm-transactions.rb:131:inblock in commit'
/Volumes/StaticData/fixtures/vendor/bundler/ruby/1.9.1/gems/dm-transactions-1.2.0/lib/dm-transactions.rb:195:in within'
/Volumes/StaticData/fixtures/vendor/bundler/ruby/1.9.1/gems/dm-transactions-1.2.0/lib/dm-transactions.rb:131:incommit'
/Volumes/StaticData/fixtures/vendor/bundler/ruby/1.9.1/gems/dm-transactions-1.2.0/lib/dm-transactions.rb:373:in transaction'
/Volumes/StaticData/fixtures/Rakefile:25:inblock (3 levels) in '
/Volumes/StaticData/fixtures/Rakefile:14:in each'
/Volumes/StaticData/fixtures/Rakefile:14:inblock (2 levels) in '
/Volumes/StaticData/fixtures/vendor/bundler/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:205:in call'
/Volumes/StaticData/fixtures/vendor/bundler/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:205:inblock in execute'
/Volumes/StaticData/fixtures/vendor/bundler/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:200:in each'
/Volumes/StaticData/fixtures/vendor/bundler/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:200:inexecute'
/Volumes/StaticData/fixtures/vendor/bundler/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:158:in block in invoke_with_call_chain'
/Users/username/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/monitor.rb:211:inmon_synchronize'
/Volumes/StaticData/fixtures/vendor/bundler/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:151:in invoke_with_call_chain'
/Volumes/StaticData/fixtures/vendor/bundler/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:144:ininvoke'
/Volumes/StaticData/fixtures/vendor/bundler/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:116:in invoke_task'
/Volumes/StaticData/fixtures/vendor/bundler/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:94:inblock (2 levels) in top_level'
/Volumes/StaticData/fixtures/vendor/bundler/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:94:in each'
/Volumes/StaticData/fixtures/vendor/bundler/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:94:inblock in top_level'
/Volumes/StaticData/fixtures/vendor/bundler/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:133:in standard_exception_handling'
/Volumes/StaticData/fixtures/vendor/bundler/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:88:intop_level'
/Volumes/StaticData/fixtures/vendor/bundler/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:66:in block in run'
/Volumes/StaticData/fixtures/vendor/bundler/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:133:instandard_exception_handling'
/Volumes/StaticData/fixtures/vendor/bundler/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:63:in run'
/Volumes/StaticData/fixtures/vendor/bundler/ruby/1.9.1/gems/rake-0.9.2.2/bin/rake:33:in'
/Volumes/StaticData/fixtures/vendor/bundler/ruby/1.9.1/bin/rake:23:in load'
/Volumes/StaticData/fixtures/vendor/bundler/ruby/1.9.1/bin/rake:23:in'
Tasks: TOP => db:fixtures 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T22:28:43.537

找到了。我的模型之一被称为“队列”，并与 thread.rb 中的队列对象混为一谈。我重命名了我的模型，现在一切都很好。

# jquery - 使用 Jquery 在文本中搜索单词

> ID：11871621
> 
> 赞同：0
> 
> 时间：2012-08-08T19:18:59.470
> 
> 标签：jquery, variables, search, contains

我正在尝试在 html 中进行输入，其中将搜索任何输入的单词，然后进行标记。获取输入值并将其提供给 js 中的变量是可以的，但是我不能将该变量用作搜索项，我的错误在哪里？

```
$(document).ready(function(){
$("#Input").change(function() {

    var str = $("#Input").val();
    $("div:contains(str)").css("text-decoration", "underline");
});    
}); 
```

如果我将 :contains(str) 更改为 :contains("Any string") 它确实工作得更好，但我不能使变量工作，请帮助 :)

> 解决了

一切正常，现在我被手机卡住了，我在 PC 上试过它运行良好，但是我的手机无法执行代码，手机是否需要额外的按钮或者没有机会为我的手机执行 js电话？(诺基亚 E5)

> 以防万一有人想检查，这是[链接](http://bla2e.com/jquery)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:20:27.837

您需要使用字符串连接来使用您的变量创建选择器`str`，否则选择器正在寻找文字文本“str”。

```
$("div:contains(" + str + ")").css("text-decoration", "underline"); 
```

...欢迎来到 StackOverflow。

# java - 首选项库未加载首选项

> ID：11871623
> 
> 赞同：1
> 
> 时间：2012-08-08T19:19:01.717
> 
> 标签：java, xml, xml-parsing

我正在使用**java.util.prefs.Preferences**为我的应用程序创建引用，但由于某种原因，我似乎无法从 xml 文件加载首选项。我没有收到文件未找到错误，所以它正在加载文件。它似乎没有解析文件。有人可以让我知道我做错了什么吗？

**澄清**是的，正在加载文件。'root.exportSubtree(System.out)' 行正在输出整个 XML。但是，我从中获取的示例仅显示了根“用户”的子根。这可能是对我的问题的暗示，但我仍然没有解决它。

我的偏好类

```
package com.g4apps.secure.processserver;

import java.io.BufferedInputStream;
import java.io.FileInputStream;
import java.io.InputStream;
import java.util.prefs.Preferences;

public class PSPrefs {
        private String user;
        private String url;
        private String password;
        private String database;

        public PSPrefs(String file) {
            InputStream is = null;

            try {
                is = new BufferedInputStream(new FileInputStream(file));
                Preferences.importPreferences(is);
                Preferences root = Preferences.userRoot();
                root.exportSubtree(System.out);
                this.user=root.get("user", "");
                this.url=root.get("url", "");
                this.password=root.get("password","");
                this.database=root.get("database","");
            }
            catch (Exception e) {
                e.printStackTrace();
            }
        }

        public String getUser() {
            return this.user;
        }
        public String getURL() {
            return this.url;
        }
        public String getPassword() {
            return this.password;
        }
        public String getDatabase() {
            return this.database;
        }

} 
```

我的preferences.xml 文件。

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE preferences SYSTEM "http://java.sun.com/dtd/preferences.dtd">
<preferences EXTERNAL_XML_VERSION="1.0">
    <root type="user">
        <map/>
        <node name="Server Settings">
            <map>
                <entry key="user" value="user"/>
                <entry key="url" value="jdbc:mysql://mysqldb.com/"/>
                <entry key="password" value="password"/>
                <entry key="database" value="mydb"/>
            </map>
        </node>
    </root>
</preferences> 
```

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T20:25:30.297

好吧，我突然想到的是该文件不在您认为的位置。尝试验证文件是否存在`file.exists()`

确保文件在执行上下文中的正确位置

**更新**

好的，对不起，我的不好:(

试试这个：

```
try {
    is = new BufferedInputStream(new FileInputStream(file));
    Preferences.importPreferences(is);
    Preferences root = Preferences.userRoot();

    Preferences node = Preferences.userRoot().node("Server Settings");

    this.user = node.get("user", "");
    this.url = node.get("url", "");
    this.password = node.get("password", "");
    this.database = node.get("database", "");

    System.out.println(user);
    System.out.println(url);
    System.out.println(password);
    System.out.println(database);

} catch (Exception e) {
    e.printStackTrace();
} 
```

这给了我输出

```
user
jdbc:mysql://mysqldb.com/
password
mydb 
```

哦，如果您使用的是 roseindia 的示例，它实际上会丢弃整个偏好树，它们只是“突出显示”了那里的分支

# asp.net - xmlreader 遍历节点

> ID：11871630
> 
> 赞同：0
> 
> 时间：2012-08-08T19:19:24.673
> 
> 标签：asp.net, .net, xmlreader

我有一个xml文件如下，

```
<rss> 
<report name="rpt1"> 
<title>AAA</title> 
<image/> 
<weblink/> 
<pdflink/> 
<pdfsize/> </report> 
<report name="rpt2"> 
<title>BBB</title> 
<image/> 
<weblink/> 
<pdflink/> 
<pdfsize/> </report> 
</rss> 
```

我必须遍历链接并转到报告节点并获取每个报告的标题/图像/weblink/pdflink/pdfsize。我如何使用 xml 阅读器来做到这一点。我谷歌并看到遍历单个节点但不是循环。任何输入？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T20:11:20.797

您可以使用[**LINQtoXML**](http://msdn.microsoft.com/en-us/library/bb387098.aspx)从您的 XML 中获取项目。

```
var path = Server.MapPath("~/Content/pairs.xml");    
XElement elm = XElement.Load(path);
//you can also load the XML from stream / string also

if (elm != null)
{
    foreach (var item in elm.Elements("report"))
    {
        string title = item.Element("title").Value;
        string image = item.Element("image").Value;
        string weblink= item.Element("weblink").Value;
        //do whatever with the values          
    }
} 
```

# c# - 错误：“属性 'ContentControl' 的代码生成失败。” （C＃）

> ID：11871634
> 
> 赞同：0
> 
> 时间：2012-08-08T19:19:42.237
> 
> 标签：c#, resources

我在我的资源中添加了一些图像。然后，我决定不使用它们并将它们从**Resources.rex**和**Resources 文件夹**中删除。现在，当我尝试运行应用程序时出现此错误：

![在此处输入图像描述](../Images/307a4cb0336b22d581545e867f86afa9.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-18T15:54:52.280

请尝试卸载项目然后再次加载项目，然后清理解决方案并再次重建，希望它能解决问题

# php - 如何发送电子邮件以使它们看起来像是来自我的 hotmail 帐户？

> ID：11871643
> 
> 赞同：-3
> 
> 时间：2012-08-08T19:20:04.320
> 
> 标签：php, email

我计划向大约 100 人发送一批电子邮件 - 但是我想用他们的姓名和公司名称对其进行个性化设置。我想在 PHP 中创建一个脚本，这样我就可以遍历我的数据，将变量插入到消息中，然后一次性发送。

唯一需要注意的是，我希望电子邮件看起来来自我的 hotmail 帐户，我知道我可以使用 PHP 的邮件功能添加“发件人”标头，但是许多收件人帐户会标记该邮件来自我的apache服务器不是正版hotmail帐号。

我怎样才能防止这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:29:37.660

您需要通过 hotmail 的 SMTP 服务器发送邮件。

您可能可以相当容易地调整[此答案，以使用 hotmail 的服务器而不是谷歌的服务器发送邮件。](https://stackoverflow.com/a/2748837/1084754)

[Hotmail SMTP 配置信息](http://windows.microsoft.com/en-US/hotmail/send-receive-email-from-mail-client)

# cocos2d-x - 动画不运行

> ID：11871644
> 
> 赞同：0
> 
> 时间：2012-08-08T19:20:08.917
> 
> 标签：cocos2d-x

在 cocos2d-x 中，以下动画代码显示精灵但不运行动画。我究竟做错了什么？

```
// create a CCAnimation node
CCAnimation * anim = CCAnimation::animation();

// add the images to the loop (one image per frame)
anim->addSpriteFrameWithFileName("Hero/1.png");
anim->addSpriteFrameWithFileName("Hero/2.png");
anim->addSpriteFrameWithFileName("Hero/3.png");

// create an action
CCAnimate * animation   = CCAnimate::actionWithAnimation( anim );
animation->setDuration(0.5);
CCAction * repeat       = CCRepeatForever::actionWithAction(animation);

// create a sprite to run the action
CCSprite * test = CCSprite::create("Hero/1.png");
test->setPosition( ccp( 150, 150 ) );
test->runAction( repeat );
this->addChild( test ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T11:47:42.780

试试这个希望这对你有帮助

```
[anim  addFrameWithFilename:Hero/1.png];
id rep_frame;
id frameactions=[CCAnimate actionWithDuration:1.0 animation:anim restoreOriginalFrame:YES];    
rep_frame=[CCRepeatForever actionWithAction:frameactions];
[self runAction:rep_frame]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-06T14:19:56.200

试试这个代码：

```
CCAnimation * anim = CCAnimation::animation();
for (int i = 1; i <= 3 ; i++)
 // add the images to the loop (one image per frame)
anim->addSpriteFrameWithFileName((CCString::createWithFormat("Hero/%d.png",i)->getCString()));
anim->setDelayPerUnit( 0.5f / 3.0f);
CCAnimate *action = CCAnimate::create(anim);

// create a sprite to run the action
CCSprite * test = CCSprite::create("Hero/1.png");
test->setPosition( ccp( 150, 150 ) );
test->runAction(CCRepeatForever::create(action)); // run action on sprite object
this->addChild( test ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T21:38:14.453

您需要在动画的帧上设置延迟，CCAnimate 会自动计算持续时间，因此您不需要`animation->setDuration()`

```
// create a CCAnimation node
CCAnimation * anim = CCAnimation::animation();

// add the images to the loop (one image per frame)
anim->addSpriteFrameWithFileName("Hero/1.png");
anim->addSpriteFrameWithFileName("Hero/2.png");
anim->addSpriteFrameWithFileName("Hero/3.png");
anim->setDelay(.5 / 3.0); 
```

另外，我会在将动画添加为孩子之后开始动画。

# .htaccess - 使用 .htaccess 进行移动重定向，但仅适用于根域

> ID：11871652
> 
> 赞同：1
> 
> 时间：2012-08-08T19:20:33.570
> 
> 标签：.htaccess

我从 ThemeForest.net 上的开发者那里购买了一个移动网站主题，他建议我在这里与社区讨论 .htaccess。我目前使用 .htaccess 将移动流量重定向到我的移动网站，效果很好。但是我发现，如果使用触摸设备的人尝试通过直接将其作为 URL 输入或从外部链接访问我服务器上的页面，它会将用户重定向到我的移动网站的索引页面.

一个例子; 我使用 SlideShowPro Director 为房地产经纪人创建了很多幻灯片。这些幻灯片嵌入在我创建的 HTML 页面中。我将 URL 发送给我的房地产经纪人，以便他们可以访问幻灯片，或将 URL 链接到另一个站点。如果有人使用触摸设备点击该链接，.htaccess 文件将检测到该设备并将其重定向到移动索引页面，而不是幻灯片页面。显然，文件的配置方式有些问题。该文件的代码如下：

```
RewriteEngine on
RewriteBase /

# Check if this is the noredirect query string
RewriteCond %{QUERY_STRING} (^|&)m=0(&|$)
# Set a cookie, and skip the next rule
RewriteRule ^ - [CO=mredir:0:www.mainevideotours.com]

RewriteCond %{HTTP:x-wap-profile} !^$ [OR]
RewriteCond %{HTTP:Profile}       !^$ [OR]
RewriteCond %{HTTP_USER_AGENT} "acs|alav|alca|amoi|audi|aste|avan|benq|bird|blac|blaz|brew|cell|cldc|cmd-" [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "dang|doco|eric|hipt|inno|ipaq|java|jigs|kddi|keji|leno|lg-c|lg-d|lg-g|lge-" [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "maui|maxo|midp|mits|mmef|mobi|mot-|moto|mwbp|nec-|newt|noki|opwv" [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "palm|pana|pant|pdxg|phil|play|pluc|port|prox|qtek|qwap|sage|sams|sany" [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "sch-|sec-|send|seri|sgh-|shar|sie-|siem|smal|smar|sony|sph-|symb|t-mo" [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "teli|tim-|tosh|tsm-|upg1|upsi|vk-v|voda|w3cs|wap-|wapa|wapi" [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "wapp|wapr|webc|winw|winw|xda|xda-" [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "up.browser|up.link|windowssce|iemobile|mini|mmp" [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "symbian|midp|wap|phone|pocket|mobile|pda|psp" [NC]
RewriteCond %{HTTP_USER_AGENT} !macintosh [NC]

# Check if we're not already on the mobile site
RewriteCond %{HTTP_HOST}          !^m\.
# Can not read and write cookie in same request, must duplicate condition
RewriteCond %{QUERY_STRING} !(^|&)m=0(&|$) 

# Check to make sure we haven't set the cookie before
RewriteCond %{HTTP_COOKIE}        !^.*mredir=0.*$ [NC]

# Now redirect to the mobile site
RewriteRule ^ http://m.mainevideotours.com [R,L] 
```

任何帮助将不胜感激！-基思

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T23:46:56.670

> 我希望它仅在有人尝试访问根域索引文件 www.mainevideotours.com/index.html 而不是我域上的任何其他页面时重定向

啊。看起来您需要将规则（最后一行）更改为：

```
RewriteRule ^(index.html)?$ http://m.mainevideotours.com [R,L] 
```

这应该涵盖`/`和`/index.html`

# c - 链表程序未给出预期结果

> ID：11871657
> 
> 赞同：-3
> 
> 时间：2012-08-08T19:21:01.433
> 
> 标签：c, algorithm, linked-list

我正在尝试设置 head -> data =10，然后在链表的开头添加 10 个值（101-110）。

目前我得到**输出：10**

有人能帮我吗？

```
#include<stdio.h>
#include<conio.h>
#include<stdlib.h>
struct node
{
 int data;
 struct node *next;
};
void main()
{
 struct node *head, emp;
 int num = 10, i;
 void add_beg(struct node *q, int n);
 void traverse(struct node *q);
 clrscr();
 head = (node*)malloc(sizeof(node));
 head->data = num;
 head->next = NULL;
 for (i= 101; i<=110; i++)
 {
  add_beg(head, i);
 }

 traverse(head);
 getch();

}

void add_beg(struct node *q, int num)
{
 int n = num;
 struct node *temp;
 temp = (node *)malloc(sizeof(node));
 temp->data = n;
 temp->next = q;
 q = temp;
}

void traverse(struct node *q)
{
while(q!=NULL)
  {
   printf("%d\n",q->data);
   q = q->next;
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:28:29.470

看起来*head*最终位于列表的末尾，因此当您从*head*遍历时，打印*head*的值并且 traverse() 停止，因为*head->next*为空。

您可以尝试让 add_beg() 返回*临时*指针，并使用 add_beg() 返回的最终值来调用 traverse()。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T19:37:46.377

您需要更改`void add_beg(struct node *q, int num)`为`void add_beg(struct node **q, int num)`.

传递的指针不能更改，我的意思是实际地址被复制并且不会在 add_beg() 之外更改，指向的值可以更改。所以如果你有一个指向指针的指针，你可以改变指向的指针（head）。

因此，要让头回到您的主函数，您需要像这样调用它`add_beg(&head, i);`，并对 add_beg() 进行上述更改。

# tfs - 如果我的团队有多个功能分支，那么我们需要多个 QA 环境吗？

> ID：11871661
> 
> 赞同：1
> 
> 时间：2012-08-08T19:21:09.670
> 
> 标签：tfs

如果我们有 3 个功能分支并行开发，这意味着根据定义我们需要 3 个 QA 环境，对吗？

否则人们将覆盖彼此的代码。

唯一的另一种方法是在推送到 QA 之前拥有另一个我们推送的分支（所有 3 个功能分支）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:32:42.950

分支策略是一个很大的话题，但这里有一些我发现有用的链接：

[http://msdn.microsoft.com/en-us/library/bb668955.aspx](http://msdn.microsoft.com/en-us/library/bb668955.aspx)

[http://branchingguidance.codeplex.com](http://branchingguidance.codeplex.com)

[http://tfsbranchingguideii.codeplex.com/releases/view/20785](http://tfsbranchingguideii.codeplex.com/releases/view/20785)

[http://www.ericsink.com/scm/scm_branches.html](http://www.ericsink.com/scm/scm_branches.html)

不确定您所说的“QA 环境”是什么意思，但通常 QA 会处理`Main`“稳定”功能的单个分支。发布将分支`Main`。您的“功能”分支（如果有）将分支出不同的`Development`分支（也已分支`Main`），并可能会采用更宽松的签入策略。`Development`将用于持续集成和构建验证测试。但是，我觉得“功能分支”确实可以作为搁置集完成，`Development`而不是需要一个分支。

# mysql - 这是检查重复值的正确语句吗？

> ID：11871664
> 
> 赞同：0
> 
> 时间：2012-08-08T19:21:25.157
> 
> 标签：mysql

我有一个包含以下字段的表：

```
domainname | domian_name_cert_no | keyvalue 
```

是独一无二的`domian_name_cert_no`，它以计数器结尾；1,2,3 等。有两个或更多`domian_name_cert_no`共享的可能性`keyvalue`。我需要列出这些案例。所以我有以下语句来列出第`keyvalue`一个中的出现`domian_name_cert_no` （即，仅没有=1。我不关心_2，_3中的重复项）。

```
select domainname, domian_name_cert_no, count(keyvalue), keyvalue 
from db.table 
where domian_name_cert_no like '%_1'
group by (keyvalue) 
having count(keyvalue)>1; 
```

假设一个输出如下： xyx , xyx_1 , 10 , 777

然后，根据前面的输出，我知道有 10 次出现，现在我需要详细列出这些共享的域名`keyvalue`，所以我使用了：

```
SELECT  a.*
FROM    db.table a
            INNER JOIN
            (
                SELECT keyvalue
                FROM db.table
                GROUP by keyvalue
                HAVING COUNT(keyvalue) = 10
            ) b 
                ON a.keyvalue = b.keyvalue; 
```

这些正确的陈述是否基于我对需要的解释？我不太确定我在第二个语句中做了什么：`HAVING COUNT(keyvalue) = 10`。

请 MySQL 专家向我确认这些陈述是否正确。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:53:26.953

**根据 OP 附加评论更改**

您的第一个查询看起来不太正确。

```
select keyvalue, count(domian_name_cert_no) as rec_count 
from db.table 
where domian_name_cert_no like '%_1'
group by keyvalue 
having rec_count>1; 
```

对于您的第二个查询，我不确定您在尝试什么。我最好的猜测是，您希望获取所有具有您在第一个查询中确定的键值的记录。只需将您的第一个查询插入到内部连接中。您将不需要该`HAVING`声明。

```
 select a.*
  from 
    db.table a
  inner join
    (select keyvalue, count(domian_name_cert_no) as rec_count 
     from db.table
     where domian_name_cert_no like '%_1'
     group by keyvalue 
     having rec_count>1) b 
  on a.keyvalue = b.keyvalue; 
```

希望我理解你的问题。

# java - Struts2使用属性标签从jsp访问ActionContext

> ID：11871667
> 
> 赞同：1
> 
> 时间：2012-08-08T19:21:37.440
> 
> 标签：java, struts2, actioncontext

我一直在查找此信息一段时间，但似乎网上没有太多信息。

为了简单起见，我们如何`ActionContext`通过`<s:property/>`标签访问？

基本上我想获得`com.opensymphony.xwork2.ActionContext.locale`（当前语言环境）

我尝试了所有这些，但似乎没有一个工作

```
<s:property value="#com.opensymphony.xwork2.ActionContext.locale"/>
<s:property value="${#com.opensymphony.xwork2.ActionContext.locale}"/>
<s:property value="%{#com.opensymphony.xwork2.ActionContext.locale}"/> 
```

以及这些的更多组合。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T21:30:54.160

你试过`locale.toString()`吗？

```
Locale: <s:property value='locale.toString()'/> 
```

**编辑**

正如您希望将其`ActionContext`放入您的值`action`：

```
public class FooAction extends ActionSupport {
    ...
    private String locale; // TODO: Getters and setters
    ...

    @Override
    public String execute () {
        ...
        locale = ActionContext.getContext().getLocale().toString();
        ...
    }
} 
```

然后在您的 jsp 中，您可以`locale`使用`<s:property>`.

```
<s:property value="locale"/> 
```

我希望它有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T05:50:22.430

更直接的方法是说：

```
<s:property value="@com.opensymphony.xwork2.ActionContext@getContext().locale"/> 
```

为此，需要在 struts.xml 中启用静态方法调用

```
<struts>
  <constant name="struts.ognl.allowStaticMethodAccess" value="true"/>
  ...
</struts> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-05T06:35:15.257

您可以将其用作：

```
<%=session.getAttribute("WW_TRANS_I18N_LOCALE") %> 
```

这将直接从会话中获取语言环境

# php - 使用 PHP 从 HTTP POST 获取图像

> ID：11871668
> 
> 赞同：1
> 
> 时间：2012-08-08T19:21:46.250
> 
> 标签：php, iphone, html, http, post

因此，我使用 HTTP POST 通过 Internet 发送图像并将其发送到我服务器上的 php 脚本。我希望能够拍摄并保存该图像。我对文本做得很好，但是当涉及到其他内容（例如图像）时，它会出错，说它找不到变量，当我尝试时`file_get_contents`，它也不喜欢那样。我也从 iPhone 发送图像，所以我的 POST 请求看起来像这样。

```
NSMutableData *postBody = [NSMutableData data];
[postBody appendData:[[NSString stringWithFormat:@"--%@\r\n", stringBoundary] dataUsingEncoding:NSUTF8StringEncoding]];
[postBody appendData:[@"Content-Disposition: form-data; name=\"media\"; filename=\"dummy.jpg\"\r\n" dataUsingEncoding:NSUTF8StringEncoding]];
[postBody appendData:[@"Content-Type: image/jpeg\r\n" dataUsingEncoding:NSUTF8StringEncoding]];
[postBody appendData:[@"Content-Transfer-Encoding: binary\r\n\r\n" dataUsingEncoding:NSUTF8StringEncoding]];
[postBody appendData:imageData];
[postBody appendData:[@"\r\n" dataUsingEncoding:NSUTF8StringEncoding]];
[postBody appendData:[[NSString stringWithFormat:@"--%@--\r\n", stringBoundary] dataUsingEncoding:NSUTF8StringEncoding]];
[postRequest setHTTPBody:postBody]; 
```

请求的其余部分已写好，但我真的不想将其全部发布。

但无论如何，这就是我发送请求的方式，在 php 服务器端，

```
<?php
    echo "Some Message";
    $nameValue =  $_POST['name'];
    echo "<br/>";
    echo $nameValue;
    $otherValue =  $_POST['other'];
    echo "<br/>";
    echo $otherValue;
    file_get_contents('dummy.jpg');
    // or I tried this
    $imageData = $_POST['media'];
?> 
```

我似乎无法抓取图像。获取图像的两次尝试都失败了，我不知道为什么。有什么建议么？

**编辑：**

我添加了打印语句`print_r($_FILES)`以查看我会得到什么，它返回以下内容。

```
(
    [media] => Array
        (
            [name] => dummy.jpg
            [type] => 
            [tmp_name] => 
            [error] => 1
            [size] => 0
        )
) 
```

所以它似乎正在获取图像，至少是它的名称，但由于某种原因它没有获取实际数据并且抛出了一些错误。我想如果它没有发送数据并且我的 PHP 服务器出现错误，这可能是在 iPhone 方面。不过我不确定，有人遇到过这样的事情吗？

**编辑2：**

我终于让一切正常了。事实证明，所有内容都已正确格式化我只是遇到了文件图像大小上传限制问题。我发送的图像大约 8MB，显然我们的服务器无法处理，所以我只是降低了 jpeg 的质量，问题就解决了。然后还有一些权限问题，没有什么是`sudo chmod`无法解决的。感谢大家的建议和帮助，我希望我能接受多个答案！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T14:14:53.963

错误代码“1”表示您尝试上传的图像太大。 [http://php.net/manual/en/features.file-upload.errors.php](http://php.net/manual/en/features.file-upload.errors.php)

检查 php.ini 中的 upload_max_filesize 设置。

我看到您正在尝试继续使用 $_FILES['media']['name']，但实际上传的文件可通过 $_FILES['media']['tmp_name'] 中给出的路径获得。

为确保您正确处理上传，请参阅 php-docu：http: [//php.net/manual/en/features.file-upload.post-method.php](http://php.net/manual/en/features.file-upload.post-method.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T19:26:33.150

首先您必须输出`file_get_contents`(1) 的结果，然后您需要告诉浏览器您提供的是图像而不是标准 HTML (2)。

```
echo file_get_contents('dummy.jpg'); // 1
header("Content-Type: image/jpg");   // 2 
```

我只是浏览了`header`函数的表面；您需要在实际案例中添加更多标题。查看：

*   [php头文件](http://php.net/manual/en/function.header.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T20:47:51.630

检查 PHP 端的 $_FILES 数组，看看你的图像是否在那里......

做`print_r($_FILES);`

# objective-c - 无法在我的其他视图控制器中访问我的数组

> ID：11871669
> 
> 赞同：0
> 
> 时间：2012-08-08T19:21:52.743
> 
> 标签：objective-c, ios, xcode, nsarray

我在我的 CRHViewControllerScript 类中创建了一个名为“bulletedArray”的 NSArray，我试图访问同一个数组并将其写在我的 CRHCommentSection 类的 NSLog 中。但是，它不是在写数组。我知道数组有效，可以在第一堂课上写出来。我认为我上下一堂课的方法很糟糕，但这是我的代码的样子。

“CRHViewControllerScript.h”

```
@interface CRHViewControllerScript : UIViewController <UITextViewDelegate> {

__weak IBOutlet UITextView *myTextView;

}

+ (NSArray*)theArray;
- (IBAction)chalkYes:(id)sender;
@end 
```

“CRHViewControllerScript.m”

```
#import "CRHViewControllerScript.h"

static NSArray* bulletedArray = nil;

@interface CRHViewControllerScript ()

@end

@implementation CRHViewControllerScript

+ (NSArray*)theArray {
return bulletedArray;
}

- (IBAction)chalkYes:(id)sender {

//get the text inside the textView
NSString *textContents = myTextView.text;

textContents = [textContents stringByReplacingOccurrencesOfString:@"\n" withString:@""];

//make the array
NSArray *bulletedArray = [textContents componentsSeparatedByString:@"\u2022"];

//eliminate blank component at top of the array ("")
NSUInteger len = bulletedArray.count;
if (bulletedArray.count) {

    bulletedArray = [bulletedArray subarrayWithRange:NSMakeRange(1, len-1)]; 
}

//print out array 
NSLog(@"%@",bulletedArray); 

} 
```

CRHCommentSection.h

```
#import <UIKit/UIKit.h>

@interface CRHCommentSection : UIViewController

@end 
```

CRHCommentSection.m

```
#import "CRHCommentSection.h"
#import "CRHViewControllerScript.h"

@interface CRHCommentSection ()

@end

@implementation CRHCommentSection

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view.

    NSArray *myArray = [CRHViewControllerScript theArray]; // This is how to call a Class     Method in Objective C
    NSLog(@"%@", myArray); 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:27:33.153

```
//make the array
NSArray *bulletedArray = [textContents componentsSeparatedByString:@"\u2022"]; 
```

这将创建一个名为的新变量，该变量`bulletedArray`位于

```
-(IBAction)chalkYes:(id)sender { 
```

所以它掩盖了你在外面声明的全局。只需`NSArray*`从开头删除即可解决问题：

```
bulletedArray = [textContents componentsSeparatedByString:@"\u2022"]; 
```

编辑：

实例级方法和类级方法的命名法是分别以`-`或开头的方法之间的区别`+`。

在您的代码中，`+(NSArray*)theArray;`是一个类级别的方法，可以`[CRHViewControllerScript theArray];`使用类名作为方法的接收者来调用。

而`-(IBAction)chalkYes:(id)sender;`是实例级方法，必须在类的实际实例上调用，例如`[myCRHViewScript chalkYes:nil];`

正如@user490696 指出的那样，理想情况下，您应该将数组存储在实例级属性中并从方法中返回它，而不是将其存储在全局范围内。例如，您的`myTextView`变量是 ivar 或实例变量。这是**每个类实例**存储的变量。您可以创建一个返回此变量的方法，如下所示：

```
-(UITextView*) getTextView
{
    return myTextView;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T19:27:48.300

```
NSArray *bulletedArray = [textContents componentsSeparatedByString:@"\u2022"];

//eliminate blank component at top of the array ("")
NSUInteger len = bulletedArray.count;
if (bulletedArray.count) {

    bulletedArray = [bulletedArray subarrayWithRange:NSMakeRange(1, len-1)]; 
} 
```

上面的代码对你声明的静态没有影响。本地声明

```
NSArray *bulletedArray //hides the static variable 
```

更改局部变量的名称，然后重新分配给静态变量（如果这是您的意图）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T19:52:10.913

您需要从一个实例而不是类中调用它。

只需将属性添加到`CRHCommentSection`：

```
@property(strong, nonatomic) CRHViewControllerScript *theControllerScript 
```

并在您的应用程序中将实例委托`CRHViewControllerScript`给这样的`CRHCommentSection`实例

```
theCRHCommentSection.theControllerScript = theViewCRHViewControllerScript; //replace those Values with the actual ones 
```

您可以`CRHCommentSection`像这样访问它：

```
[self.theControllerScript theArray]; 
```

# git - 在主干中工作，不想提交，想将更改移动到分支

> ID：11871678
> 
> 赞同：1
> 
> 时间：2012-08-08T19:22:20.170
> 
> 标签：git

假设我在主干上工作了一段时间，然后意识到我当前的所有更改都应该进入功能分支。

此时我是否可以将所有更改移动到功能分支并保持主干/主干干净？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:25:12.870

是（注意：假设已提交更改）：

在主干上创建一个新分支： `git checkout -b my-feature-branch`

再次结帐后备箱： `git checkout trunk`

将中继重置为更改之前的状态： `git reset --hard <revision before your changes>`

瞧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T20:28:44.840

只需使用选项`-m`( `--merge`) 签出主题分支并像往常一样提交：

```
$ git checkout -m topic 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T20:24:13.723

如果您有未提交的更改，请使用`git stash`stash 它们。

创建一个新分支`git checkout -b <new_branch>`，然后使用`git stash apply`.

如果您同时有已提交和未提交的更改，请使用 存储它们`git stash`，然后执行@jmosbech 编写的操作，然后`git stash apply`在新分支上执行。

# java - 套接字通道始终为空

> ID：11871681
> 
> 赞同：0
> 
> 时间：2012-08-08T19:22:22.513
> 
> 标签：java, sockets

我正在尝试向 SMTP 服务器发送 EHLO 命令。连接成功，但我似乎无法从中读取任何数据：

```
 ByteBuffer byteBuffer = null;
    try {
        socketChannel = SocketChannel.open();
        socketChannel.connect(new InetSocketAddress("host", 25));
        socketChannel.configureBlocking(true);
        byteBuffer = ByteBuffer.allocateDirect(4 * 1024);

    } catch (Exception e) {
        e.printStackTrace();
    }

    try {
        byteBuffer.clear();
        socketChannel.write(byteBuffer.put(SMTP_EHLO.getBytes()));
        byteBuffer.flip();
        socketChannel.read(byteBuffer);
        byteBuffer.get(subStringBytes);
        String ss = new String(subStringBytes);
        System.out.println(byteBuffer);

    } catch (IOException e) {
        e.printStackTrace();
    } catch (InterruptedException e) {
        e.printStackTrace();
    } 
```

print 语句的输出总是 \u000(null)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:52:33.987

```
 socketChannel.write(byteBuffer.put(SMTP_EHLO.getBytes())); 
```

您`put`将 SMTP_EHLO 放入缓冲区，但您必须在写入`flip()`缓冲区*之前*将其写入。否则，您不会向套接字通道写入任何内容。来自`SocketChannel`Javadoc：

> 尝试将最多 r 个字节写入通道，其中 r 是缓冲区中剩余的字节数，即`src.remaining()`，在调用此方法时。

从`Buffer#remaining()`：

> `public final int remaining()`
> 
> 返回当前位置和限制之间的元素数。

因此，在`byteBuffer.put(...)`当前位置 == 限制之后。

# combobox - 当组合框选择为空时，将依赖文本框设置为空

> ID：11871683
> 
> 赞同：1
> 
> 时间：2012-08-08T19:22:26.253
> 
> 标签：combobox, textbox

我在表单上有一个组合框 *CboInst*，其行源是包含以下字段的查询：

Class_Catalog 表中的 [Instructor] 和 [Inhouse]。在 CboInst 的“更改”事件中，我有以下代码：

```
Me.TxtHouse = Me.CboInst.Column(1) 
```

该代码根据 CboInst 的选择填充文本框*TxtHouse 。*

它工作正常。我的问题是当我在表单上删除 CboInst 的内容时，文本框会继续显示上一个选择的结果，直到做出另一个选择。出于此表单的目的，我需要在组合框为空白时文本框为空白。

# linux - 检查已安装的信号处理程序

> ID：11871693
> 
> 赞同：3
> 
> 时间：2012-08-08T19:22:59.913
> 
> 标签：linux, unix, signals, signal-handling, systems-programming

我有一个库，它为 SIGSEGV 安装信号处理程序以进行调试。SIGSEGV 处理程序只是打印一些信息然后退出程序。

最近，我需要从 Java 调用这个库（使用 JNI），我遇到的问题是 JVM 还为 SIGSEGV 安装了一个信号处理程序，用于比我更有用的目的。

所以我要选择的操作是，如果我的库发现已经为信号安装了信号处理程序，它根本不会安装任何信号。

为清楚起见，我使用的是 sigaction 调用。

现在要实现我的功能，我要做的是：

一种。屏蔽所有信号。

湾。调用 sigaction 并检查 oact 是否返回有效的处理程序。

C。如果是这样，请使用 oact 重新调用 sigaction 作为新行为。

d。UNBLOCK 信号。

B和c对我来说似乎很麻烦。我想要的是能够确定一个特定的信号是否已经有一个处理程序，而无需先替换处理程序，然后用原始处理程序重新替换它（什么都没有）。

还有什么比 sigaction 更细粒度的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T10:15:40.437

您可以调用`sigaction(SIGSEGV, NULL, &sa)`查询信号配置而不更改它。

请注意，阻塞信号不会“锁定”其他线程，因为信号掩码是每个线程的，而信号处置对于进程中的所有线程来说是通用的。

# java - Java：通用方法和返回类型

> ID：11871694
> 
> 赞同：5
> 
> 时间：2012-08-08T19:23:13.017
> 
> 标签：java, generics

谁能解释以下代码中的返回类型是什么意思

```
public static <T> ArrayList<T> a()
{       
       return null;
} 
```

和

```
public static <String> ArrayList<Vector> a()
{       
       return null;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-08T19:28:43.797

```
public static <T> ArrayList<T> a() 
```

第一次出现的`<T>`引入了一个类型参数，该参数将在方法中可用。

实际的返回类型是`ArrayList<T>`，其中`T`与第一个相同。

您可以在此处阅读 -[通用方法](http://docs.oracle.com/javase/tutorial/extra/generics/methods.html)。

在第二个中：

```
public static <String> ArrayList<Vector> a() { 
```

即使您引入了泛型类型参数（即`String`，它不是实际类型或参数，如`java.lang.String`），您也没有使用它。而且，该方法也总是返回一个`ArrayList<Vector>`( `ArrayList`of `Vector`s)。

# javascript - 如何在 js 中为 win8 Metro 应用程序捕获可见性更改/应用程序背景事件

> ID：11871695
> 
> 赞同：0
> 
> 时间：2012-08-08T19:23:14.273
> 
> 标签：javascript, windows-8, microsoft-metro

我问了这个关于如何在 Metro 应用程序中捕获可见性变化的问题： [如何判断 JS Windows8 Metro 应用程序是否可见](https://stackoverflow.com/questions/11855715/how-to-tell-if-js-windows8-metro-app-is-visible-or-not)

似乎有两个答案：1）应用程序失去焦点后约10秒将调用检查点，因为应用程序将被暂停

2）页面可见性事件将起作用。

但是，当我在我的 default.js 中执行以下操作时，我看不到这些事情发生：

```
var onVisibilityChange = function (args) {
  console.log("Visibility changed. (this will never appear");
};
app.addEventListener("visibilitychange", onVisibilityChange);

// ...

app.oncheckpoint = function (args) {
  console.log("APP onCheckpoint (this also never appears");
}; 
```

有没有人有一个捕获应用程序何时开始/停止可见的示例？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-08T19:50:52.530

为了可见性，您需要使用文档：

```
document.addEventListener("visibilitychange", function() {
    console.log("Visible: " + !document.hidden);
}) 
```

对于 Checkpoint，您的代码是正确的，但请注意：

*   挂起/恢复不会在附加调试器的情况下*自动发生。*您需要使用 Visual Studio 中的工具栏来控制挂起状态。
*   在应用程序恢复之前，您的 console.log 不会显示（不清楚原因，可能是一些缓存），但是您可以通过在该行上设置断点并使用 VS 工具栏按钮来验证它在暂停之前是否已执行

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-12T21:32:15.703

我推荐使用这个库：[http ://dueljs.studentivan.ru/](http://dueljs.studentivan.ru/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T20:25:21.297

一种解决方案是：

```
var onVisibilityChange = function (args) {
  var state = document["visibilityState"];
  if (state == "visible")
  {
    console.log("COMING IN");
  }
  else if (state == "hidden") {
    console.log("AWAY");
  }
};
document.addEventListener("visibilitychange", onVisibilityChange, false); 
```

# c# - 如何使用 TreeView.AfterSelect 和 TreeView.DrawNode 方法？

> ID：11871697
> 
> 赞同：2
> 
> 时间：2012-08-08T19:23:17.013
> 
> 标签：c#, .net, winforms, treeview

我的项目中有`MyForm.cs, MyForm.Designer.cs`文件，`MyForm.Designer.cs`我这样做了：

```
private System.Windows.Forms.TreeView myTreeView;
this.myTreeView = new System.Windows.Forms.TreeView();
.........
this.myTreeView.AfterSelect += 
                           new TreeViewEventHandler(this.myTreeView_AfterSelect); 
```

像`MyForm.cs`这样：

```
private void myTreeView_AfterSelect(object sender, TreeViewEventArgs e)
        {
          //........;
        } 
```

我也有`CostumeTreeView`其他文件（`CostumeTreeView.cs`和`CostumeTreeView.Designer.cs`）的课程， `CostumeTreeView.Designer.cs`我确实喜欢这样：

```
private System.Windows.Forms.TreeView myCostumeTreeView
this.myCostumeTreeView = new System.Windows.Forms.TreeView();
...........
this.myCostumeTreeView.DrawMode = 
                          System.Windows.Forms.TreeViewDrawMode.OwnerDrawAll;
this.myCostumeTreeView.DrawNode += 
               new DrawTreeNodeEventHandler(this.myCostumeTreeView_DrawNode); 
```

在`CostumeTreeView.cs`：

```
private void myCostumeTreeView_DrawNode(object sender, DrawTreeNodeEventArgs e)
        {
        ........
            //Here is the problem, myTreeView isn't seen here
            e.Node.Tag = myTreeView.SelectedNode.Text; 
        } 
```

我需要在`myTreeView`选择节点时，`myCostumeTreeView`使用后选择功能更改所有标签（所有方法都在一个命名空间中）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T20:35:23.563

如果您的 TreeView 控件位于不同的窗体上，则它们需要通过窗体属性或事件相互引用，以便控件可以相互通信。

我看到的另一件事是，您可能不应该`e.Node.Tag = myTreeView.SelectedNode.Text;`在 DrawNode 事件中设置绘图或绘画事件中的属性。您应该在 DrawNode 事件中做的唯一一件事就是绘制节点，仅此而已。

要进行引用，您的服装形式需要一个变量，然后将其传递给构造函数，例如：

```
private MyForm mainForm;

private CostumeTreeView(MyForm mf) {
  InitializeComponents();
  mainForm = mf;
} 
```

现在您可以引用 TreeView 控件：

```
private void myCostumeTreeView_DrawNode(object sender, DrawTreeNodeEventArgs e) {
  ........
  e.Node.Tag = mainForm.myTreeView.SelectedNode.Text; 
} 
```

同样，不需要使用 DrawNode 事件来设置节点的标签。您正在创建对 GUI 的依赖关系，这将使将来的维护和调试变得困难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T14:50:20.177

我认为最好的选择是访问 TreeNode 类中存在的 Treeview 属性。

```
 e.Node.Tag = e.Node.TreeView.SelectedNode.Text; 
```

您应该有权访问它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T20:38:25.257

创建一个协调器类并将两棵树传递给协调器。让协调员在选择一棵树之后订阅，然后在选择之后，在另一棵树中执行它应该做的事情。

除非我遗漏了某些东西，否则您不需要所有者全部绘制。

# java - java.sql.SQLException：索引处缺少 IN 或 OUT 参数:: 1

> ID：11871698
> 
> 赞同：29
> 
> 时间：2012-08-08T19:23:18.500
> 
> 标签：java, jdbc, oracle11g

我制作了一些 Java 1.6-Oracle11g-JDBC（使用 OJDBC 6）代码（如下）。我遇到了一个例外 -`java.sql.SQLException: Missing IN or OUT parameter at index:: 1` 为什么会发生这种情况，我该如何解决？

我的输出是-

```
create CREATE TABLE employee(emp_name varchar(25),emp_address varchar(25))
insert INSERT INTO employee(jim,germany) values(?,?)
Exception: java.sql.SQLException: Missing IN or OUT parameter at index:: 1 
```

代码是-

```
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.sql.Statement;

public class Oracle {

public static void main(String[]args)
{

    try
    {

        Connection con = DriverManager.getConnection("jdbc:oracle:thin:@//localhost:1521/xe", "newman", "123456");
        Statement stmt = con.createStatement(); 

        String create = "CREATE TABLE employee(emp_name varchar(25),emp_address varchar(25))";
        System.out.println("create " + create);//
        stmt.execute(create);

        //insert 1st row            
        String inserting = "INSERT INTO employee(hans,germany) values(?,?)";
        System.out.println("insert " + inserting);//
        PreparedStatement ps = con.prepareStatement(inserting); 
        ps.executeUpdate();

        //insert 2nd row            
        inserting = "INSERT INTO employee(david,austria) values(?,?)";
        System.out.println("insert " + inserting);//
        ps = con.prepareStatement(inserting); 
        ps.executeUpdate();

    }catch(SQLException ex){System.out.println("Exception: " + ex);}

    }

} 
```

编辑 - 为了更正代码，我们使用 -

//插入第一行

```
 String inserting = "INSERT INTO 
                    employee(emp_name,emp_address) values(?,?)";
        PreparedStatement ps = con.prepareStatement(inserting);
        System.out.println("insert " + inserting);//
        ps.setString(1, "hans");
        ps.setString(2, "germany");
        ps.executeUpdate(); 
```

//插入第二行

```
 inserting = "INSERT INTO 
                    employee(emp_name,emp_address) values(?,?)";
        ps = con.prepareStatement(inserting);
        System.out.println("insert " + inserting);//
        ps.setString(1, "david");
        ps.setString(2, "austria"); 
        ps.executeUpdate(); 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-08-08T19:27:57.817

这不是 SQL 的工作方式：

```
INSERT INTO employee(hans,germany) values(?,?) 
```

这些值`(hans,germany)`应该使用列名`(emp_name, emp_address)`。这些值由您的程序通过使用`Statement.setString(pos,value)`方法提供。它在抱怨，因为您说有两个参数（问号）但没有提供值。

您应该创建一个 PreparedStatement，然后设置参数值，如下所示：

```
String insert= "INSERT INTO employee(emp_name,emp_address) values(?,?)";
PreparedStatement stmt = con.prepareStatement(insert);
stmt.setString(1,"hans");
stmt.setString(2,"germany");
stmt.execute(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-08T19:28:52.577

您必须使用列名，然后设置要插入的值（两个 ? 标记）：

```
//insert 1st row            
String inserting = "INSERT INTO employee(emp_name ,emp_address) values(?,?)";
System.out.println("insert " + inserting);//
PreparedStatement ps = con.prepareStatement(inserting); 
ps.setString(1, "hans");
ps.setString(2, "germany");
ps.executeUpdate(); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-08T19:28:57.663

第一个问题是您的查询字符串是错误的：

我认为：`"INSERT INTO employee(hans,germany) values(?,?)"`应该是这样的：`"INSERT INTO employee(name,country) values(?,?)"`

另一个问题是您有一个参数化的 PreparedStatement 并且在运行它之前没有设置参数。

您应该将这些添加到您的代码中：

```
String inserting = "INSERT INTO employee(name,country) values(?,?)";
System.out.println("insert " + inserting);//
PreparedStatement ps = con.prepareStatement(inserting); 
ps.setString(1,"hans"); // <----- this
ps.setString(2,"germany");// <---- and this
ps.executeUpdate(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-08T19:33:11.580

在您的 INSERT 语句中：

```
INSERT INTO employee(hans,germany) values(?,?) 
```

您的字段名称属于您的值。将其更改为：

```
INSERT INTO employee(emp_name,emp_address) values(?,?) 
```

如果您要从 SQL 提示符运行该语句，它将如下所示：

```
INSERT INTO employee(emp_name,emp_address) values('hans','germany'); 
```

请注意，您需要在字符串/varchar 值周围加上单引号。

此外，您也没有在准备好的语句中添加任何参数。这实际上是导致您看到的错误的原因。尝试这个：

```
PreparedStatement ps = con.prepareStatement(inserting); 
ps.setString(1, "hans");
ps.setString(2, "germany");
ps.execute(); 
```

此外（根据[Oracle](http://docs.oracle.com/javase/7/docs/api/java/sql/PreparedStatement.html)），您可以对任何 SQL 语句使用“执行”。在这种情况下使用“executeUpdate”也是有效的，它将返回一个整数来指示受影响的行数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-08T19:29:39.780

有关如何使用 PreparedStatement 的信息，请参阅下面的链接。我也引用了链接。

[http://docs.oracle.com/javase/tutorial/jdbc/basics/prepared.html](http://docs.oracle.com/javase/tutorial/jdbc/basics/prepared.html)

> 在执行 PreparedStatement 对象之前，您必须提供值来代替问号占位符（如果有）。通过调用 PreparedStatement 类中定义的 setter 方法之一来执行此操作。以下语句在名为 updateSales 的 PreparedStatement 中提供两个问号占位符：
> 
> updateSales.setInt(1, e.getValue().intValue()); updateSales.setString(2, e.getKey());

# java - 来自java客户端的Python套接字recv

> ID：11871712
> 
> 赞同：4
> 
> 时间：2012-08-08T19:24:19.877
> 
> 标签：java, python, sockets, socketserver

我有一个简单的 python tcp 服务器*（我正在使用`SocketServer`类）*的问题，它必须从 java 客户端接收数据。

这里是服务器端代码：

```
class ServerRequestHandler(SocketServer.BaseRequestHandler):
    [...]
    def handle(self):
        requestCode = struct.unpack('>i', self.request.recv(4))[0]
        [...]
    [...] 
```

这里有客户端：

```
addr = InetAddress.getByName(hostname);
SocketAddress sockaddr = new InetSocketAddress(addr, port);
clientSocket = new Socket();
clientSocket.connect(sockaddr, timeoutMs);
clientSocketDataOutputStream = new DataOutputStream(clientSocket.getOutputStream());
int   requestCode = 1;
clientSocketDataOutputStream.writeInt(requestCode);
clientSocketDataOutputStream.flush(); 
```

我启动 Python 服务器，然后尝试执行必须向服务器发送整数的客户端。

在服务器端 Python 引发异常，因为该`recv(4)`函数不读取 4 个字节，它只返回一个字节。

事实上，我的 java 客户端正确发送了 4 个字节，如果我尝试调用`recv(1)`4 次，它会正确读取 4 个字节。

我尝试编写一个 Python 客户端来执行与我的 java 客户端相同的操作，在这种情况下，服务器`recv(4)`运行良好。

如何解决这个问题呢？我想实现一个简单的 python`buffered reader function`来逐字节读取套接字，但我确信存在更智能的解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T19:35:27.470

recv 不必读取 4 个字节，它只抓取最多 4 个字节的任何内容。因为，正如您所说，您可以调用 recv(1) 4 次。你可以这样做

```
def recvall(sock, size):
    msg = ''
    while len(msg) < size:
        part = sock.recv(size-len(msg))
        if part == '': 
            break # the connection is closed
        msg += part
    return msg 
```

这将重复调用`recv`，`sock`直到`size`收到字节。如果`part == ''`套接字已关闭，则它将返回关闭前的任何内容

所以改变

```
requestCode = struct.unpack('>i', self.request.recv(4))[0] 
```

至

```
requestCode = struct.unpack('>i', recvall(self.request, 4))[0] 
```

我建议`recvall`为您的班级制作一种方法以使事情变得更清洁。

* * *

这是对此处定义的安全套接字类的方法的修改：http: [//docs.python.org/howto/sockets.html](http://docs.python.org/howto/sockets.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T19:33:42.670

recv(4)*最多*读取4 个字节。请参阅文档：[http](http://docs.python.org/library/socket.html) ://docs.python.org/library/socket.html 。我认为在这里制作一个简单的缓冲阅读器功能是一个完全可以接受的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T19:35:28.050

也许你可以使用[io](http://www.python.org/doc//current/library/io.html)模块中的东西？例如[BufferedRWPair 。](http://www.python.org/doc//current/library/io.html#io.BufferedRWPair)

# python - Distutils 和 shell 扩展

> ID：11871713
> 
> 赞同：2
> 
> 时间：2012-08-08T19:24:22.800
> 
> 标签：python, bash, distutils

我在 Python 中有一个需要 GTK 的扩展模块。编译 GTK 程序通常需要大量链接，因为 GTK 依赖于许多其他库（Glib、Cairo、Pango 等）。因此，通常我只是`pkg-config`使用 shell 扩展（反引号）的输出进行编译，例如：

```
gcc -p-O2 -Wall myprogram.c -o myprogram `pkg-config --cflags gtk+-3.0` `pkg-config --cflag `pkg-config --libs gtk+-3.0` 
```

但是由于某种原因，当我在传递给 distutils 的参数中使用 shell 扩展时`module.extra_compile_args`，我收到一个错误，因为 BASH 实际上并没有扩展表达式：

```
module = Extension('mymodule',
        sources = ['mymodule.c'])

module.extra_compile_args = ['`pkg-config --cflags gtk+-3.0`', 
        '`pkg-config --libs gtk+-3.0`']; 
```

这只会导致如下错误：

```
gcc: error: `pkg-config --cflags gtk+-3.0`: No such file or directory 
```

那么，有什么办法可以使这项工作？我是否需要通过获取`pkg-config`Python 字符串的输出然后将其作为元素添加来手动进行 shell 扩展`module.extra_compile_args`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:55:21.747

```
module.extra_compile_args = [
  subprocess.check_output(["pkg-config", "--cflags", "gtk+-3.0"]),
  subprocess.check_output(["pkg-config", "--libs", "gtk+-3.0"])
]; 
```

[http://docs.python.org/library/subprocess.html#subprocess.check_output](http://docs.python.org/library/subprocess.html#subprocess.check_output)

# c# - 如何在对象属于复杂类型的实体框架中正确调用将 SProc 映射到 ObservableCollection 的函数

> ID：11871714
> 
> 赞同：1
> 
> 时间：2012-08-08T19:24:20.973
> 
> 标签：c#, wpf, entity-framework-4, complextype

> **可能重复：**
> [在实体框架中使用带有输入参数的 ObjectResult 到 StoredProcedure 的正确方法是什么？（输出映射到复杂类型属性）](https://stackoverflow.com/questions/11836345/whats-the-correct-way-to-use-objectresult-with-input-parameters-to-storedproced)

我已经[在这里](https://stackoverflow.com/q/11836345/1076406)问过这个问题，但我似乎无法弄清楚，所以我再问一次。

我将实体模型中的一个函数映射到一个名为 ReturnPnsPerAtts_Result 的复杂类型，该类型具有标量属性：pn_ID、conn_pn 和 part_class。

这样做是正确的。

SQL SELECT 存储过程称为 ReturnPnsPerAtts，它接受大约 12 个参数（这些都是我从视图中一堆列表框的 SelectedValue 属性中获取的实体查询的“属性”属性。

现在，我意识到我可以将存储过程的结果作为复杂类型的 ObjectResult 返回。我正在使用 WPF 和 C#——我究竟如何创建一个方法来将我的 ObjectResults 提供给 DataContext？

谢谢 - 非常感谢任何帮助。

::编辑:: 我一直在尝试：

我的代码现在看起来完全像这样：

```
 private void Window_Loaded(object sender, RoutedEventArgs e)
    {
          CollectionViewSource returnPnsPerAtts_ResultViewSource = ((CollectionViewSource)(this.FindResource("returnPnsPerAtts_ResultViewSource");

          returnPnsPerAtts_ResultViewSource.Source = this.selectedPnsCollection;
     }

     private ObservableCollection<ReturnPnsPerAtts_Result> selectedPnsCollection = new ObservableCollection<ReturnPnsPerAtts_Result>();

     private void connShapeLBox_SelectionChanged(object sender, SelectionChangedEventArgs e)
     {
          ConnCompAttsView selectedConnShape = this.connShapeLBox.SelectedValue as ConnCompAttsView;
           if (connShapeLBox.SelectedValue != null)
           {
                 selectedPnsCollection.Clear();
                 foreach (ReturnPnsPerAtts_Result result in 
                      this.myEntities.ReturnPnsPerAttsFN(selectedConnShape.PK_att_val_id, null, null, null, null, null));
                      {
                          selectedPnsCollection.Add(result);
                      }
              }
       }
      } 
```

但是，我得到了一个内部异常，指出

```
 "{"Procedure or function 'ReturnPnsPerAtts' expects parameter '@@connShape', which was not supplied."}" 
```

但它是提供的......或者我认为......并且作为一个 int，这是我的存储过程所期望的。

# css - 如何在 Rails gem 中打开文本文件并将其输出插入视图？

> ID：11871718
> 
> 赞同：0
> 
> 时间：2012-08-08T19:24:40.453
> 
> 标签：css, ruby-on-rails, ruby, rubygems, gem

我正在制作一个 ruby​​ gem（具有标准目录结构，例如 lib/mygem）......在那个 gem 中，我有一个方法调用应该打开一个 css 文件（来自 gem 中的 lib/vendor/assets/css目录结构）。并将css输出到视图文件。mygem.rb 看起来像：

```
require "mygem/version"
 module MyGem
   class Engine < Rails::Engine #cause rails to add its directories to the load path when the gem is required.
   end
 def mygem_div_tag(div_id, options={})
     options = {:css_template=>"example1"}.merge(options)
    file_str = IO.read("../vendor/assets/css/"+options[:css_template]+".css")
    div_str = %Q{
   <style type="text/css">
  #{file_str}
  </style> }
 end 
```

因此，在视图中，我会有以下内容：

```
<%= mygem_div_tag %> 
```

我得到一个错误：*没有这样的文件或目录 - ../vendor/assets/css/example1.css*

如何输出“example1.css”文件中的 CSS？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T20:28:02.663

如果这是 Rails 应用程序的一部分，请尝试：

> ```
> file_str = IO.read("#{Rails.root}/vendor/assets/css/"+options[:css_template]+".css") 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T22:03:55.983

to 的参数[`IO#read`](http://ruby-doc.org/core-1.9.3/IO.html#method-c-read)要么是绝对路径，要么是相对于进程工作目录的路径，*而不是*相对于当前文件的路径。当您的 gem 作为另一个应用程序的一部分运行时，您将不知道其中任何一个。

为了获取相对于当前文件的路径，您可以使用[`File#expand_path`](http://ruby-doc.org/core-1.9.3/File.html#method-c-expand_path)特殊[`__FILE__`](http://ruby-doc.org/docs/keywords/1.9/Object.html#method-i-__FILE__)常量：

```
file_path = File.expand_path("../vendor/assets/css/"+options[:css_template]+".css", File.dirname(__FILE__))
file_str = IO.read(file_path) 
```

# .net - base.OnPropertyChanged("Item[]") 在 ObservableCollection 中做了什么？

> ID：11871720
> 
> 赞同：3
> 
> 时间：2012-08-08T19:24:47.183
> 
> 标签：.net, wpf, observablecollection, inotifypropertychanged

我在`ObservableCollection<T>`使用反编译器时环顾四周，看到了一些`OnPropertyChanged`我以前从未见过的奇怪代码。

```
public class ObservableCollection<T> : Collection<T>, INotifyCollectionChanged, INotifyPropertyChanged
{    
    private const string IndexerName = "Item[]";

    protected override void ClearItems()
    {
        ...
        base.OnPropertyChanged("Count");
        base.OnPropertyChanged("Item[]");
        ...
    }
} 
```

`OnPropertyChanged("Item[]")`在编写我自己的代码时，调用有什么用？

它必须做一些不同于标准`OnPropertyChanged`调用的事情，因为“Item”不是对象上的属性，并且“ `[]`”肯定不是“任何”属性名称的一部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:54:04.993

调用 to`OnPropertyChanged("Item[]")`需要遵循`INotifyPropertyChanged`. 默认索引器返回的数据`Item`已更改。

在您的具体示例中，该集合已被清除，因此如果您正在索引该集合的特定项目，则需要通知您您感兴趣的对象引用可能不同。

## 编辑

在 Kevin 关于绑定到索引器的评论之后，我编写了一个应用程序来测试绑定。

我创建了一个`ObservableCollection<int>`并填充如下：

```
this.Indexed.Add(1);
this.Indexed.Add(2);
this.Indexed.Add(3); 
```

如果您像这样通过索引器绑定到某些东西，它将显示`3`：

```
<TextBlock Text="{Binding Indexed[2]}" /> 
```

然后在运行时更改该索引处的对象，

```
this.Indexed.Insert(2, 10); 
```

将`TextBlock`更新并显示新值`10`。

# windows - 自定义 Windows USB / RNDIS .inf 文件以更改网络连接名称

> ID：11871721
> 
> 赞同：5
> 
> 时间：2012-08-08T19:25:04.200
> 
> 标签：windows, driver, inf, network-connection, rndis

我的嵌入式 Linux 设备使用`g_ether`Linux 中的驱动程序通过 USB 上的以太网与 Windows 7 通信。我正在尝试修改`linux.inf`下面的内核源代码中的示例文件，`src/Documentation/usb/`以使我的设备在 Windows 网络连接对话框中显示为“本地连接 2”以外的其他内容。

我只是修改了文件的`[strings]`一部分`linux.inf`以指定一个自定义字符串，该字符串确实显示为“本地连接 2”主标题下的子字符串。

我不知道如何让我的设备说出例如“Phils Device”而不是“Local Area Connection 2”。如果有人能启发我如何做到这一点，我将不胜感激！谢谢 -

我修改的示例 .inf 文件的一部分：

```
[Strings]
Company               = "Phil"
CompanyDevice         = "Phils Device"
Vista_Property        = "Phils Device"
ServiceDisplayName    = "Phils Device Driver" 
```

参考：

[http://msdn.microsoft.com/en-us/library/ff570620.aspx](http://msdn.microsoft.com/en-us/library/ff570620.aspx)

[http://msdn.microsoft.com/en-us/windows/hardware/gg463293.aspx](http://msdn.microsoft.com/en-us/windows/hardware/gg463293.aspx)

# mysql - 以重复键更新为条件

> ID：11871723
> 
> 赞同：6
> 
> 时间：2012-08-08T19:25:13.623
> 
> 标签：mysql, conditional, on-duplicate-key

我做了一些研究，但似乎没有什么适合我的需求。我有一个数据库表，其中包含从 Web 服务检索的一些数据。

用户为每条记录执行一些任务，然后将其标记为“已处理”。所以我有一个名为“已处理”的附加 db 字段（不是基于我从 WS 获得的数据），默认设置为 0，当用户完成工作时设置为 1。

每天我都会检查 WS，如果状态码发生变化，我想更新行并将处理设置回 0（以便用户可以再次处理它）。

假设这是我的数据库...

```
+------+------------+-------+------------+
| id   | statuscode | foo   | processed  |
+------+------------+-------+------------+
| 123  | 66         | bar   | 1          |
+------+------------+-------+------------+ 
```

*   如果没有具有相同键（id）的行，我想插入一条新记录。
*   如果有一行具有相同的键和“foo”更改，我想更新除“已处理”字段之外的任何值。
*   如果有一行具有相同的键和状态码更改，我想更新任何值并将处理设置为 0。

我认为具有某些条件的 ON DUPLICATE KEY UPDATE 可以使其工作，也许在某些 CASE 或 IF 条件下......我错了吗？任何建议都可以接受，在此先感谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-08T19:47:19.847

像这样的东西（警告：`NULL`未处理的值）：

```
INSERT INTO tableX
  (id, statuscode, foo, processed)
VALUES 
  (?, ?, ?, DEFAULT)
ON DUPLICATE KEY UPDATE
  processed = CASE WHEN statuscode <> VALUES(ststuscode)
                     THEN 0
                   ELSE processed
              END 
, statuscode = VALUES(statuscode)
, foo = VALUES(foo) ; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T20:21:45.160

在这里稍微修改另一个答案，应该这样做：

```
INSERT INTO tableX (id, statuscode, foo, processed) 
            VALUES (@id, @statuscode, @foo, @processed) 
ON DUPLICATE KEY UPDATE 
                       foo = IF (statuscode != VALUES(statuscode) OR foo != VALUES(foo), VALUES(foo), foo), 
                       statuscode = IF (statuscode != VALUES(statuscode) OR foo != VALUES(foo), VALUES(statuscode), statuscode), 
                       processed = IF (statuscode != VALUES(statuscode), 0, processed) 
```

# protobuf-net - ProtoBuf-net 仅使用 ProtoContract 并在 DataContract 或 XmlType 上引发异常

> ID：11871726
> 
> 赞同：2
> 
> 时间：2012-08-08T19:25:16.870
> 
> 标签：protobuf-net

我正在尝试移动现有代码以使用 ProtoBuf-Net。有些类有 DataContract 但 DataMembers 没有顺序，这会导致忽略这些属性而不是序列化它们。

有没有办法告诉 ProtoBuf-Net 仅序列化标有 [ProtoContract] 的类，并在尝试使用 [XmlType] 或 [DataContract] 序列化类时抛出异常？如果可能，是否会使用 GPB 正确序列化其他系统类（例如 System.String）？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T20:37:19.630

公平的问题；这不是以前出现过的场景，但它是一个足够公平的场景，并且很容易解决，谢天谢地......我在 r567 中添加`AutoAddProtoContractTypesOnly`了。`RuntimeTypeModel`如果您使用的是 v1 风格的`Serializer.Serialize(...)`方法，那么您可以通过以下方式应用它：

```
RuntimeTypeModel.Default.AutoAddProtoContractTypesOnly = true; 
```

（所有`Serializer.*`方法都映射到`RuntimeTypeModel.Default`模型实例）

这是我现在通过的测试：

```
[Test]
public void ExecuteWithoutAutoAddProtoContractTypesOnlyShouldWork()
{
    var model = TypeModel.Create();
    Assert.IsInstanceOfType(typeof(Foo), model.DeepClone(new Foo()));
}
[Test, ExpectedException(typeof(InvalidOperationException),
    ExpectedMessage = "Type is not expected, and no contract can be inferred: Examples.Issues.SO11871726+Foo")]
public void ExecuteWithAutoAddProtoContractTypesOnlyShouldFail()
{
    var model = TypeModel.Create();
    model.AutoAddProtoContractTypesOnly = true;
    Assert.IsInstanceOfType(typeof(Foo), model.DeepClone(new Foo()));
}

[DataContract]
public class Foo { } 
```

# nhibernate - 如何保存值为0的parentId？对象引用了一个未保存的瞬态实例

> ID：11871727
> 
> 赞同：1
> 
> 时间：2012-08-08T19:25:20.183
> 
> 标签：nhibernate, fluent-nhibernate, fluent-nhibernate-mapping

我有一个 SQL**表 - table_description**三列。

1）ID——身份和主键

2) 说明

3) Parent_Id - 这链接回 SAME 表中的 ID。

有一个记录`ID = 0`作为行之一。当我尝试使用创建新记录时`Parent_Id = 0`，NHibernate 会抛出错误：

> 对象引用未保存的瞬态实例 - 在刷新之前保存瞬态实例或将属性的级联操作设置为使其自动保存的内容

我猜这是因为当 NHibernate 尝试生成一个新记录时，它会查看`ID =0`并且因为它看到`parent_Id = 0`，它认为存在依赖关系。

理解了这一点，**我们如何创建新记录`parent_Id = 0`**？

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:40:21.153

尝试将您的[ID 的 unsaved-value](http://nhforge.org/doc/nh/en/index.html#mapping-declaration-id)属性设置为您的表中不存在的某个值，即**-1**。整数列的默认值为**0**。

您可以在流畅的映射类中像这样更改它：

```
Id(x => x.ID).UnsavedValue(-1); 
```

# c# - 创建自定义 Excel 饼图标签

> ID：11871730
> 
> 赞同：2
> 
> 时间：2012-08-08T19:25:33.983
> 
> 标签：c#, excel

我正在使用 C# 以编程方式在 Excel 中创建饼图。我需要为切片添加一些自定义标签。基本上，我希望饼图左侧的切片标签从图表区域的左上角开始向下。在右边同样的事情。我的问题是，我怎样才能找到切片弧的中点来知道标签应该在图表的哪一侧？

我想如果我得到系列中的积分我可以找到它，但我没有看到它。

```
Point p = (Point)oSeriesCollection.Item(1).Points(1); 
```

有什么建议么？

**编辑**

意识到我可能应该包括更多细节。当我说“自定义标签”时，我的意思是我将使用下面的代码在图表上放置文本框。从我所做的所有搜索中，我还没有找到另一种方法（使用内置数据标签）。如果有办法调整和放置内置数据标签的大小，我会全力倾听有关如何做到这一点的任何提示。

```
oChart.Chart.Shapes.AddTextbox(MsoTextOrientation.msoTextOrientationHorizontal, 0, 0, 100, 100).TextFrame.Characters(Type.Missing, Type.Missing).Text = "text"; 
```

**编辑 2** 对于任何对此感兴趣的人，我在 Excel 论坛上找到了答案（它使用的是 VBA）。添加文本框的行只是一个占位符，但如果中心在 0 到 180 之间，它将在右侧，否则它将在左侧，当然，我必须将它们向下移动每一个。要考虑的另一件事是，如果饼图已旋转，则需要通过 FirstSliceAngle 修改中心值。

```
double total=0;
foreach (object item in (Array)oSeriesCollection.Item(1).Values)
{
    total+=Convert.ToDouble(item);
}

double runtotal=0;
for (int x=1; x <= ((Array)oSeriesCollection.Item(1).Values).GetUpperBound(0); x++)
{
    object item = ((Array)oSeriesCollection.Item(1).Values).GetValue(x);
    double center = (runtotal + Convert.ToDouble(item) / 2) / total * 360;
    runtotal+=Convert.ToDouble(item);

    chart.Chart.Shapes.AddTextbox(MsoTextOrientation.msoTextOrientationHorizontal, 0, 0, 50, 10).TextFrame.Characters(Type.Missing, Type.Missing).Text = "some text";
} 
```

# php - php文件没有取消链接

> ID：11871731
> 
> 赞同：0
> 
> 时间：2012-08-08T19:25:37.347
> 
> 标签：php, permissions, directory, unlink

我正在调用位于我的“上传”目录中的 .php 文件以从文件系统中删除。需要搜索的目录将始终位于“uploads/$_SESSION['email']”中。这是我目前拥有的：

```
<?php

session_start();

require('../mysqli_connect.php'); 

    $old = getcwd(); // Save the current directory
    $new = './'.$_SESSION['email'];
    chdir($new);

    $delpaths = "SELECT `title` FROM `upload` WHERE `upload_id` IN ({$id_array}) AND `owner_id` =". $_SESSION['user_id'];
    $getpaths = mysqli_query($dbc, $delpaths);
    while ($row = mysqli_fetch_array($getpaths, MYSQLI_ASSOC))
    {
        chown($row, 666);

function removeupload() {
$todelete = $row;
unlink($todelete);
chdir($old); 

}

    }

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:44:49.203

我在这里看到了几个问题......第一个是 $row 将作为数组传回，所以**简单地调用 $row 不会给你想要的结果**（我假设这是你的文件的名称'正在尝试删除存储在您的数据库中的内容）。$row 应更改为：

```
chown($row['column_name'], 666); // Where column_name is the name of the file you're trying to delete 
```

第二个是**没有任何东西被传递给你的函数**。您应该重写它，以便可以将几个变量传递给它，以便它正确执行，我们将添加 $filename 和 $old。

```
function removeupload($filename, $old) {
    unlink($filename);
    chdir($old); 
} 
```

最后，您应该**在您的 while 循环之外定义此函数**，通常在页面的开头，并在您希望发生所需的效果时调用它。

您的**最终代码**应该看起来像这样。

```
<?php
    //Start the session
    session_start();

    //Include the connection script
    require('../mysqli_connect.php'); 

    //Build the file deletion function
    function removeupload($filename, $old) {
        unlink($filename);
        chdir($old); 
    }  

    $old = getcwd(); // Save the current directory
    $new = './'.$_SESSION['email'];
    chdir($new);

    $delpaths = "SELECT `title` FROM `upload` WHERE `upload_id` IN ({$id_array}) AND `owner_id` =". $_SESSION['user_id'];
    $getpaths = mysqli_query($dbc, $delpaths);

    while ($row = mysqli_fetch_array($getpaths, MYSQLI_ASSOC)) {
        chown($row['column_name'], 666); //This $row column holds the file name, whatever you've called it in your database.

        //Now call the function and pass the variables to it
        removeupload($row['column_name'], $old);

    }

?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T19:40:29.203

```
<?php

session_start();

require('../mysqli_connect.php'); 

function removeupload($row , $old){
    $todelete = $row;
    unlink($todelete);
    chdir($old);
}

    $old = getcwd(); // Save the current directory
    $new = './'.$_SESSION['email'];
    chdir($new);

    $delpaths = "SELECT `title` FROM `upload` WHERE `upload_id` IN ({$id_array}) AND `owner_id` =". $_SESSION['user_id'];
    $getpaths = mysqli_query($dbc, $delpaths);
    while ($row = mysqli_fetch_array($getpaths, MYSQLI_ASSOC))
    {
        chown($row, 666);
        removeupload($row['title'] , $old);
    }
?> 
```

# android - 弹出窗口内的 ListView (android)

> ID：11871732
> 
> 赞同：0
> 
> 时间：2012-08-08T19:25:39.960
> 
> 标签：android, listview, dialog, popupwindow

几天前我会搜索这个，但不幸的是我找不到我的问题的答案。我目前正在开发一个 android 项目，当您单击一个按钮时，它会向您显示一个对话框，其中包含来自字符串数组资源的项目的列表视图。谢谢。

这是我的字符串数组：

```
<string-array name="heart_attacks_and_shock">
<item>1</item>
<item>2</item>
<item>3</item>
<item>4</item>
</string-array> 
```

这是我的代码：

```
import java.util.ArrayList;
import com.sap.BSMA.R.string;
import android.annotation.SuppressLint;
import android.app.Activity;
import android.app.Dialog;
import android.content.Intent;
import android.content.res.Resources;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.ImageButton;
import android.widget.ListView;
import android.widget.TextView;

@SuppressLint("ParserError")
public class FirstaidActivity extends Activity {
Resources res = getResources();
String[] has = res.getStringArray(R.array.heart_attacks_and_shock);

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.firstaid_layout);

    ImageButton has_button = (ImageButton) findViewById(R.id.HAS);
    has_button.setOnClickListener(new OnClickListener() {
    public void onClick(View v) {
            //set up dialog
            Dialog dialog = new Dialog(FirstaidActivity.this);
            dialog.setContentView(R.layout.firstaidcategoryoutput_layout);
            dialog.setTitle("Heart attack and shock");
            dialog.setCancelable(true);
            ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,android.R.layout.simple_list_item_1,has); 
            setListAdapter(adapter);

            dialog.show();
        }
    });
}
} 
```

我用于弹出窗口的 xml：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent" android:layout_height="fill_parent"
android:background="@drawable/mainbackground">

<ListView
android:id="@+id/listExample"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:background="#CCCCCC"
android:choiceMode="singleChoice"
 />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T09:14:15.363

添加这个

```
Dialog dialog = new Dialog(FirstaidActivity.this);
        dialog.setContentView(R.layout.firstaidcategoryoutput_layout);
ListView list = (ListView)dialog.findViewById(R.id.listExample);
        dialog.setTitle("Heart attack and shock");
        dialog.setCancelable(true);
        ArrayAdapter<String> adapter = new ArrayAdapter<String> (FirstaidActivity.this,android.R.layout.simple_list_item_1,has); 
        list.setAdapter(adapter);

        dialog.show(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T19:44:44.830

您可以尝试更改：

```
android:id="@+id/listExample" 
```

至

```
android:id="@android:id/list" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T19:42:41.430

您的问题之一是您使用的“this”对象在 onclick 方法中引用了错误的内容。而不是这个尝试 Firstaidactivity.this 来获取您的活动的上下文

第二个问题是您不能在方法中使用 setListAdapter，除非该类扩展了 ListActivity。您需要获取对您的 listExample 的引用，然后执行 list.setAdapter(adapter)

# c# - 在 NAS Filer 上安全复制文件

> ID：11871737
> 
> 赞同：6
> 
> 时间：2012-08-08T19:25:53.017
> 
> 标签：c#, .net, nas, cifs

我们有一个 NetApp NAS 文件管理器，它有时似乎会出现故障，不确定这是否取决于网络问题、负载过重还是文件管理器本身；问题是通常的`System.IO.File.Copy(...)`命令有时会意外失败，而它在一分钟前工作并在一分钟后再次工作...... filer 正在使用 CIFS 文件系统。

在我的 Log4Net 日志文件中，我看到了异常：

> System.IO.IOException：指定的网络名称不再可用。在 System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath) ...

网络团队不确定会发生什么以及为什么，我现在正在考虑是否可以实现一个简单的尝试/重试系统来复制文件并在失败时重试复制，可能是 System.IO.File.Copy 不是专为 CIFS 存储而设计，但适用于普通 NTFS 驱动器或稳定的网络存储。

是否有适合执行此*复制和重试*的通用模式或 .NET 类，或者我应该简单地使用以下伪代码中的方法？

```
while(!copied && count <5)
{
  count++;

  try
  {
    //here copy the file
    ...

    //if no exception copy was ok
    copied = true;
  }
  catch
  {
    if(count >= 5)
    {
      // Log that retry limit has been reached...
    }
    else
    {
      // make thread to wait for some time,
      // waiting time can be in function of count or fixed...
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:45:27.043

我也一样。我有一个旧的[NAS 服务器](http://en.wikipedia.org/wiki/Network-attached_storage)，并且 Windows 不时[显示一个错误，告诉我该驱动器无法再访问](http://cdn.windows7themes.net/pics/f-or-h-drive-location-is-not-available.jpg)。
要管理[文件复制过程](http://en.wikipedia.org/wiki/File_copying)，您可能可以改用[CopyFileEx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363852%28v=vs.85%29.aspx)（来自[Windows API](http://msdn.microsoft.com/en-us/library/windows/desktop/ff818516%28v=vs.85%29.aspx)），如下一个示例所示：

```
public class SecureFileCopy
{
    public static void CopyFile(FileInfo source, FileInfo destination, 
        CopyFileOptions options, CopyFileCallback callback, object state)
    {
        if (source == null) throw new ArgumentNullException("source");
        if (destination == null) 
            throw new ArgumentNullException("destination");
        if ((options & ~CopyFileOptions.All) != 0) 
            throw new ArgumentOutOfRangeException("options");

        new FileIOPermission(
            FileIOPermissionAccess.Read, source.FullName).Demand();
        new FileIOPermission(
            FileIOPermissionAccess.Write, destination.FullName).Demand();

        CopyProgressRoutine cpr = callback == null ? 
            null : new CopyProgressRoutine(new CopyProgressData(
                source, destination, callback, state).CallbackHandler);

        bool cancel = false;
        if (!CopyFileEx(source.FullName, destination.FullName, cpr, 
            IntPtr.Zero, ref cancel, (int)options))
        {
            throw new IOException(new Win32Exception().Message);
        }
    }

    private class CopyProgressData
    {
        private FileInfo _source = null;
        private FileInfo _destination = null;
        private CopyFileCallback _callback = null;
        private object _state = null;

        public CopyProgressData(FileInfo source, FileInfo destination, 
            CopyFileCallback callback, object state)
        {
            _source = source; 
            _destination = destination;
            _callback = callback;
            _state = state;
        }

        public int CallbackHandler(
            long totalFileSize, long totalBytesTransferred, 
            long streamSize, long streamBytesTransferred, 
            int streamNumber, int callbackReason,
            IntPtr sourceFile, IntPtr destinationFile, IntPtr data)
        {
            return (int)_callback(_source, _destination, _state, 
                totalFileSize, totalBytesTransferred);
        }
    }

    private delegate int CopyProgressRoutine(
        long totalFileSize, long TotalBytesTransferred, long streamSize, 
        long streamBytesTransferred, int streamNumber, int callbackReason,
        IntPtr sourceFile, IntPtr destinationFile, IntPtr data);

    [SuppressUnmanagedCodeSecurity]
    [DllImport("Kernel32.dll", CharSet=CharSet.Auto, SetLastError=true)]
    private static extern bool CopyFileEx(
        string lpExistingFileName, string lpNewFileName,
        CopyProgressRoutine lpProgressRoutine,
        IntPtr lpData, ref bool pbCancel, int dwCopyFlags);
}

public delegate CopyFileCallbackAction CopyFileCallback(
    FileInfo source, FileInfo destination, object state, 
    long totalFileSize, long totalBytesTransferred);

public enum CopyFileCallbackAction
{
    Continue = 0,
    Cancel = 1,
    Stop = 2,
    Quiet = 3
}

[Flags]
public enum CopyFileOptions
{
    None = 0x0,
    FailIfDestinationExists = 0x1,
    Restartable = 0x2,
    AllowDecryptedDestination = 0x8,
    All = FailIfDestinationExists | Restartable | AllowDecryptedDestination
} 
```

MSDN Magazine 中有[更广泛的描述](http://msdn.microsoft.com/en-us/magazine/cc163851.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T15:57:37.607

经过数周和数周的研究、测试和痛苦，我终于找到了一个可行的解决方案，决定用Win Server 2008 R2 中提供的[Microsoft Robocopy 命令](http://en.wikipedia.org/wiki/Robocopy)`System.IO.File.Copy`调用替换该方法，并且从第一次尝试开始似乎运行良好。这让我感到很舒服，因为我不是在重新发明轮子，而是使用完全符合我需求的经过测试的技术。无论如何，感谢大家的回答和评论。

# python - Windows 错误：异常：访问冲突读取 0x00000160

> ID：11871741
> 
> 赞同：2
> 
> 时间：2012-08-08T19:26:16.960
> 
> 标签：python, windows, exception, access-violation

我对 Python 非常陌生，并且正在运行一个程序来使用 Nexys3 板发送和接收以太网包。我在 init 方法中打开指向以太网设备的指针，将它存储在一个全局变量中，然后在发送和接收方法中访问它。在这两种方法中，我都会收到错误：

WindowsError：异常：访问冲突读取 0x00000160

我做了很多研究，发现这个 Windows 错误意味着重新启动操作失败，但我不知道这意味着什么或如何修复它。

我无法发布我的代码，所以我不是在寻找快速简便的修复方法。我只是想知道是否有人以前遇到过这个错误以及它可能意味着或表明我的代码。预先感谢您的帮助！

# ios - 在 tel 中发送 # & *：iOS 5+ 中的 URI

> ID：11871742
> 
> 赞同：3
> 
> 时间：2012-08-08T19:26:21.440
> 
> 标签：ios, openurl

就在最近，我们注意到在 iOS 5.1 中现在允许使用包含 # 或 * 字符的 tel: URI 调用 [[UIApplication sharedApplication] openURL:url]。

例如 NSURL *url = [NSURL URLWithString:@"tel:15555551212,,1234#"];

文档似乎没有更新以表明现在允许这样做。它在 iOS 4.x 中仍然不起作用。我们正在测试看看何时发生了变化。有谁知道 Apple 是否正式更改了从应用程序中拨出这些字符的政策？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-02T17:59:05.910

更改似乎允许在or`#`之后，即在呼叫连接后发送 DTMF。等待几秒钟，让用户决定何时发送它，例如“拨 123”按钮。假设通过呼叫发送 DTMF 被认为是安全的，因为它不会被解释为服务/USSD/etc 代码。`*``,``;``,``;`

根据运营商的不同，仍有可能将其用于恶意目的，但这取决于用户在完成有效负载之前不结束呼叫（例如，如果您知道正确的号码，您可以删除一些语音邮件）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T15:00:13.297

由 tc. 描述的变化。真的发生了。同时，我们将 DTMF tel 的结尾限制为“+”，这会导致 DTMF 故障
所以，像 tel://1234567,12345+ 这样的 url 在 iPhone 5 上不起作用，但在 iPhone4(s) 上也可以使用使用 ios6
工作电话 url 代码：

```
NSString * baseTel = @"12345";
NSString * ext = @"54321";
NSString * telStr = [NSString StringWithFormat:@"tel://%@,%@#",$baseTel,$ext];
NSURL * theUrl = [NSURL URLWithString:[telStr stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]]; 
```

这将呼叫 12345 并在线路应答后播放 DTMF 54321#。

# javascript - HTML5 Canvas 拖拽线

> ID：11871743
> 
> 赞同：0
> 
> 时间：2012-08-08T19:26:23.313
> 
> 标签：javascript, json, html, canvas, drag

我使用此代码从 .json 文件加载行描述并在 Canvas 上绘制描述的行：

```
<html>
    <head>
    <script type="text/javascript" src="jQuery.js"> </script>
        <script type="text/javascript">
        var canvas;
        var context;
        function Line(x1, y1, x2, y2, color) 
        {
            canvas = document.getElementById("canvas_1");
            context = canvas.getContext("2d");

            this.x1 = x1;
            this.y1 = y1;
            this.x2 = x2;
            this.y2 = y2;
            this.color = color;
        }
        Line.prototype.draw = function() {
            context.beginPath();
            context.moveTo(this.x1, this.y1);
            context.lineTo(this.x2, this.y2);
            context.strokeStyle = this.color;
            context.stroke();
        }
        onload=function simpleExample()
        {
            $(document).ready(function() 
            {
                // draw line with cordinates read from points.json file
                $.getJSON('points.json', function(data)
                {   
                    var line = new Line(data.line.point1.x, data.line.point1.y, data.line.point2.x, data.line.point2.y, data.line.color);
                    line.draw(context);
                });

            });
        }
        </script>
    <head>
    <body>
        <canvas height="500" width="500" id="canvas_1"></canvas>
    </body>
</html>` 
```

我的 points.json 文件如下所示：

```
{
"line": {
    "point1": {
        "x": "50",
        "y": "50"
    },
    "point2": {
        "x": "100",
        "y": "100"
    },
    "color": "red"
} 
```

}

现在我想添加在 Canvas 上移动这条线的能力，但我现在不知道如何。我需要建议，因为我的任务是从 .json 文件加载行描述并在 Canvas 上绘制该行（它不必像我那样用 jQuery 加载，如果有人知道其他方法，请写一些如何做到这一点的例子）。

谢谢，亚历山大

# c# - 在 Appharbor 上设置数据库

> ID：11871745
> 
> 赞同：2
> 
> 时间：2012-08-08T19:26:27.167
> 
> 标签：c#, asp.net-mvc, appharbor

我使用 C# 和 MVC 启动了一个应用程序，首先使用代码来创建我的模型。

我的问题是如何设置一个 sql 数据库以使用[AppHarbor](https://appharbor.com/)运行。我想为我的用户使用 ASP.NET SQL 配置文件提供程序，并为我创建的模型使用数据库。

我听说过 SQL 迁移，但不太熟悉。我是否应该使用它来创建一个脚本，然后使用管理工作室在 AppHarbor 上手动构建，然后按照他们在 AppHarbor 中的建议添加连接字符串以将所有内容连接在一起？

非常感谢任何帮助，因为我即将获得实时应用程序，但我无法弄清楚如何正确设置数据库。

[我在问了这个问题后发现了很好的博客文章示例](http://www.nashcoding.com/2011/02/05/using-the-forms-authentication-membership-provider-on-appharbor/comment-page-1/#comment-477 "有关如何执行此操作的示例")

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T20:07:05.897

创建自己的：

```
var uriString = ConfigurationManager.AppSettings["SQLSERVER_URI"];
var uri = new Uri(uriString);
var connectionString = new SqlConnectionStringBuilder
{
    DataSource = uri.Host,
    InitialCatalog = uri.AbsolutePath.Trim('/'),
    UserID = uri.UserInfo.Split(':').First(),
    Password = uri.UserInfo.Split(':').Last(),
}.ConnectionString; 
```

开发名称：

```
<connectionStrings>
    <add name="connectionstringname" connectionString="Server=localhost;
        Database=my-app-debug;User ID=test;Password=dfy5fgFdsvV;" />
<connectionStrings> 
```

更多信息： http: [//support.appharbor.com/kb/add-ons/using-sequelizer](http://support.appharbor.com/kb/add-ons/using-sequelizer)

这是一个常见问题解答：当人们遇到与管理工作室的连接问题时，它会显示那里的信息，这将很有帮助。

[http://support.appharbor.com/kb/getting-started/frequently-asked-questions](http://support.appharbor.com/kb/getting-started/frequently-asked-questions)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-09T07:24:51.523

如果您使用的是实体框架，您可能也应该使用[迁移](http://blogs.msdn.com/b/adonet/archive/2012/02/09/ef-4-3-code-based-migrations-walkthrough.aspx)功能。通过迁移，您的应用程序会在每个应用程序启动时更新架构（如果需要），因此您只需要担心指向 AppHabor SQL 实例的正确连接字符串。

# regex - Vim 检查第二行是否为 'To:' 并且为空

> ID：11871748
> 
> 赞同：1
> 
> 时间：2012-08-08T19:26:47.183
> 
> 标签：regex, function, vim

我正在寻找一些东西放入启动时运行的 vimrc 文件中。我需要检查它打开的文件的第二行：

```
To: 
```

那是 to 和一个空格，基本上是那些单词，然后什么都没有。如果它找到一个“空” `To:`，它将带我到最后的那一行，第 2 行。如果`To:`后面有文本，那么它带我到第 9 行。

我使用 Vim 在 Mutt 中编辑电子邮件，我试图让它决定我是在回复电子邮件（电子邮件地址已经存在）还是创建新电子邮件（我需要输入一个地址）并采取我到相应的行。

甚至不知道从哪里开始，我不知道我是否可以在 vimrc 中启动时运行函数以及如何告诉它到 X 行的末尾。我知道我可以去一行：

```
2gg 
```

但行尾和正则表达式对我来说是困难的部分。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T19:46:38.373

试试这个自动命令（见`:help autocmd`）

```
au FileType mail if getline(2) == "To: " | 2 | else | 9 | endif | start! 
```

## 一步步：

1.  `au`- 开始一个自动命令。这应该在一个里面`augroup`，第一行`augroup`应该是`au!`。这是为了防止在为您的`.vimrc`.

2.  `FileType`- 这是一个事件触发器。看`:help FileType`

3.  `mail`- 这是运行此命令的文件类型。这在 mutt 中默认设置为邮件。

4.  `getline(2) == "To: "`- 如果第 2 行等于`"To: "`

5.  `2`- 然后去第二行。vim 中的`|`or`<Bar>`不是管道。相反，它更像是来自其他语言的分号。它允许您分隔语句，但是有些语句不能使用，例如`:norm`.

6.  `else | 9`- 否则转到第 9 行

7.  `endif`- 关闭 if 语句

8.  `start!`- 在行尾开始插入模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T19:43:24.553

尝试

```
function MuttEnter()
    let l2=getline(2)
    if l2[:3] is# 'To: '
        if len(l2)==3
            2
        else
            9
        endif
        startinsert!
    endif
endfunction
augroup vimrcMutt
    autocmd!
    autocmd VimEnter * call MuttEnter()
augroup END 
```

. 注意：更好地检测您是否正在编辑一条 mutt 消息是有意义的（目前它假设您`To:`在第二行有（带有空格）时这样做）。

顺便说一句，你在这里完全不需要正则表达式，Vim 在优化它们方面不如 perl。

# jquery - 防止 DIV 部分显示在窗口之外

> ID：11871751
> 
> 赞同：1
> 
> 时间：2012-08-08T19:26:53.637
> 
> 标签：jquery

每当用户右键单击表中的一行时，我都会在光标的右下角弹出一个 DIV。问题是，如果用户在浏览器窗口底部附近单击鼠标右键，DIV 将弹出并在窗口结束处被截断。

有没有办法检测这是否会发生，如果会，将 DIV 定位在光标的上方和右侧？

忘了说！！我正在使用[这个插件](http://www.trendskitchens.co.nz/jquery/contextmenu/)。我不介意是否需要稍微更改插件的源代码。

# heroku - 从共享数据库计划升级到新开发计划时出错

> ID：11871752
> 
> 赞同：0
> 
> 时间：2012-08-08T19:26:58.320
> 
> 标签：heroku

我正在尝试将我的应用程序升级到新的开发计划，但在报告步骤中出现错误：

```
jseidel@EDP15:~/Dev/xxx$ heroku pgbackups:restore postgres://[xxx].amazonaws.com:[xxx]
Database on [xxx].amazonaws.com <---restore--- b001 (most recent)
SHARED_DATABASE
2012/08/08 06:16.20
23.2KB
! WARNING: Potentially Destructive Action
! This command will affect the app: xxx
! To proceed, type "xxx" or re-run this command with --confirm xxx
xxx
Pending... \
! An error occurred and your restore did not finish. 
```

谢谢...乔恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T21:53:59.940

原来我应该使用数据库 ID (HREOKU_POSTGRESQL_NAVY) 时使用的是实际 URL (postgresql://xxx...)

# php - 根据我的想法，哪个类似于 CodeIgniter 的 PHP 程序？

> ID：11871773
> 
> 赞同：0
> 
> 时间：2012-08-08T19:28:32.093
> 
> 标签：php

什么是最好的程序，如 PHP 的 CodeIgniter，我应该使用它来创建学生数据库系统？

我这样做只是一个随机项目，以便我可以了解这些类型的程序。

我只是想问问更有经验的用户他们会推荐什么。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:37:37.927

通过“类似 CodeIgniter 的程序”，我假设您询问的是 PHP Web 框架。这里有一个非常全面的列表：[http](http://en.wikipedia.org/wiki/Comparison_of_web_application_frameworks#PHP_2) ://en.wikipedia.org/wiki/Comparison_of_web_application_frameworks#PHP_2 。

有很多可供选择的一些最受欢迎的（在我看来）是：

*   曾德
*   CakePHP
*   代码点火器
*   小花
*   易
*   Symfony
*   德鲁巴

您需要弄清楚您可以访问哪个版本的 PHP，因为某些框架仅适用于 PHP 5.3+。所有人都能做任何你能做的事情，我觉得这真的归结为你选择使用什么框架的编码偏好。

# eclipse - Eclipse 从命令行创建项目索引

> ID：11871774
> 
> 赞同：2
> 
> 时间：2012-08-08T19:28:32.297
> 
> 标签：eclipse

如何通过提供项目名称从命令行构建 C++ 项目索引？我已经搜索了旧问题，但没有找到任何解决方案。在文档中也没有给出如何给出项目名称来构建索引 [http://help.eclipse.org/galileo/index.jsp?topic=/org.eclipse.cdt.doc.isv/guide/dom/index/ prebuiltIndexes.html](http://help.eclipse.org/galileo/index.jsp?topic=/org.eclipse.cdt.doc.isv/guide/dom/index/prebuiltIndexes.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-18T14:49:22.500

我成功生成了pdom文件，没有验证是否正确。粘贴命令仅供参考。

```
$ECLIPSE_PATH -data $WS -arch x86 -nosplash -application org.eclipse.cdt.core.GeneratePDOM \
-target /tmp/test.pdom -source "$SRC_DIR" -id "" -include "$SRC_DIR" -vmargs -Xms512m -Xmx1024m 
```

# jquery - div内的Jquery选择按钮

> ID：11871777
> 
> 赞同：10
> 
> 时间：2012-08-08T19:28:47.650
> 
> 标签：jquery

我想选择存在于 DIV 中的一组特定按钮并将其 ID 分配给页面上的隐藏字段，但我无法终生选择 div 内的按钮。示例在下面失败

源 HTML

```
 <div id = test>
    <div class="ButtonGroupWrapper">                    
                    <img src="test.jpg" width="100" height="100" alt="thumbnail" />
                <input id="buttonID5" type="submit" value="Link" class="button" />
    </div>
    <div class="ButtonGroupWrapper">                    
                    <img src="test.jpg" width="100" height="100" alt="thumbnail" />
                <input id="buttonID6" type="submit" value="Link" class="button" />
    </div>
    </div> 
```

Jquery 选择器失败

```
 $(".ButtonGroupWrapper").find(":button").click(function () {
        alert("hi there");
        return false;
    });

    $("#ButtonGroupWrapper input[type=button]").click(function () {
        alert("hi there");
        return false;
    });

    $("#ButtonGroupWrapper :button").click(function () {
        alert("hi there");
       return false;
    }); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-08T19:30:30.110

尝试：

```
$(".ButtonGroupWrapper").find(".button").click(function () {
        alert("hi there");
        return false;
}); 
```

您的第一个示例失败，因为您试图定位一个以`.`not开头的类`:`。您可能还试图定位按钮类型的元素，但有问题的元素是提交类型。

您的第二个示例失败，因为您尝试在不存在时选择按钮类型的输入（您的目标是类型提交）。另一种选择是`input[type=submit]`.

Your third example fails for a similar reason to the first example failing in that it's looking for an element of type button.

See also [http://api.jquery.com/button-selector/](http://api.jquery.com/button-selector/)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-05-15T16:43:52.310

Putting a space looks for any .button class within your .ButtonGroupWrapper class. (NOTE: not any 'button', but anything with the code class="button" added to it)

```
$(".ButtonGroupWrapper .button").click(function () {
    alert("hello");
    return false;
}); 
```

In your HTML code the submit input has a 'class' of 'button'. It could actually be anything such as .strawberry or .mybutton or anything you like.

**Alternative:**

As you have an id wrapping the whole lot you could also target button within the id:

```
<div id ="test">
  <div>                    
    <img src="test.jpg" width="100" height="100" alt="thumbnail" />
    <input type="submit" value="Link" class="button" />
  </div>
  <div>                     
    <img src="test.jpg" width="100" height="100" alt="thumbnail" />
    <div class="button" />Just text</div>
  </div>
</div> 
```

And then your javascript could be:

```
$("#test .button").click(function () {
     alert("button class clicked");
    return false;
}); 
```

Remember you need to run this after the DOM has loaded, so best practice is to either write it at the end of the page or wrap it in your favourite onready function.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T19:30:25.973

这将起作用：

```
$(".ButtonGroupWrapper").find(".button").click(function () {
    alert("hi there");
    return false;
}); 
```

# command-line - 将命令输入控制台

> ID：11871780
> 
> 赞同：0
> 
> 时间：2012-08-08T19:28:55.293
> 
> 标签：command-line, batch-file, cmd

我正在尝试将 Windows 命令传送到一个基本上运行控制台的程序中，而我是这方面的新手，所以我并没有完全正确地掌握命令。我想要做的是将命令 dir /b > out.txt 通过管道传输到其他程序中。

命令是

> 回声目录 /b > out.txt | nc.exe 127.0.0.1 7003 - 忽略 nc.exe 它并不重要

我想要的是管道 echo 的输出，它应该是“dir /b > out.txt”，但我得到了操作顺序或错误。目前发生的事情是我将“dir / b”写入文件out.txt，而没有将任何内容导入nc.exe。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:43:08.047

双引号或转义 >

```
echo "dir /b > out.txt" | nc.exe 127.0.0.1 7003 
```

或者

```
echo dir /b ^> out.txt | nc.exe 127.0.0.1 7003 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T19:37:56.113

不确定它是否适合你。

```
echo stackoverflow.com > out.txt
nslookup<out.txt 
```

看看[http://www.robvanderwoude.com/redirection.php](http://www.robvanderwoude.com/redirection.php)

# ios - 对在许多地方运行但不在 viewDidAppear 中的方法感到困惑

> ID：11871783
> 
> 赞同：0
> 
> 时间：2012-08-08T19:29:03.090
> 
> 标签：ios

在我的一个视图控制器中，我有一个名为

```
-(void)calculateUpdatedTotal{ // do things here } 
```

每次用户离开一个文本字段（其中有很多）时，我都会运行更新，语句如下所示：

```
[self calculateUpdatedTotal]; 
```

它工作得很好，除了下面描述的。

我需要在控制器视图出现时更新计算，因此在我的 viewDidAppear 方法中，我包含了调用该方法的语句。viewDidAppear 正在按预期运行，但 [self calculateUpdatedTotal]; 什么都不做。没有错误，也没有警告。我使用了几个 NSLog 语句来缩小范围，一切都很好，只是它没有运行。它可能与 viewDidAppear 有关吗？任何关于如何追踪和解决问题的想法将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T21:33:21.770

我假设您没有在 viewWillLoad 或 view WillUnload 中调用来验证这些例程是否被调用。假设此代码位于带有 nib 和视图的 UIViewController 子类中，唯一可能的解释是您输入了方法名称并且没有使用命令竞争或复制粘贴。那就是验证你有：

```
- (void)viewWillAppear:(BOOL)animated;
- (void)viewDidAppear:(BOOL)animated; 
```

我从来没有听说过系统没有调用这些的情况。但是，如果您拼错了名称，您将永远不会知道，因为它不是强制您提供此类方法的协议。

# c++ - Recv 没有返回足够的字节（二进制 http 响应）？

> ID：11871787
> 
> 赞同：1
> 
> 时间：2012-08-08T19:29:15.407
> 
> 标签：c++, bittorrent

我正在用 C++ 编写一个 bittorrent 客户端。当我的程序使用 .torrent 文件中提供的信息联系跟踪器时，它有时不会发回足够的字节。[根据 bittorrent 协议规范 ( http://wiki.theory.org/BitTorrentSpecification#Tracker_Response](http://wiki.theory.org/BitTorrentSpecification#Tracker_Response) )定义的响应应该是一个经过编码的字典，这意味着它应该以“d”开头并以“e”结尾。这是我用来接收和存储跟踪器响应的代码：

```
int iResult;
char recvBuf[512];
int recvBuflen = 512;
string response;

//Receive response from tracker
do{
    iResult = recv(ConnectSocket, recvBuf, recvBuflen, 0);
    if(iResult > 0){
        printf("  - Bytes Received: %d\n", iResult);
        response.append(recvBuf, 0, iResult);
    } else if(iResult == 0){
        printf("  - Connection Closed\n");
    } else {
        working = false;
        printf("  - Failed: %d\n", WSAGetLastError());
        return 1;
    }
} while(iResult > 0); 
```

这是我在 Visual Studio 中查看 Watch 功能时响应字符串中的内容（在连接关闭后）：

> HTTP/1.1 200 OK Content-Type: text/plain Content-Length: 399 d8:completei213e10:downloadedi139e10:incompletei17e8:intervali1970e12:min intervali985e5:peers300:Yšqö*^ýÈÈµµcü*—®€Éýò6¸VÉ_0ºàÉQ¸UºÉ¬Æ'÷ÃQÉQ¸UºÉ¬ã÷ÃQÉ ,Ië{¾£é´ÈÕ½ÇMÈn½ÖQÖ¼1¼K]»k„ÎÅº× PÅº|Á¶X¼ºMä¸B"‹žÆ²"Œ2–±ªÈj°4Ìú·¯«ö'î¯+r€c¯‰"r¦Î´Ã7Íœ" 5ÄcÿICÈ|´"”ø3yÛæÜâÕsø¿³©nŸ¤u±ýmÿ‡µmš8äScûÜ8ý–_÷

peers 后面的 300 表示 300: 后面的数据应该是 300 字节长。我将数据放在字符计数器中，只有 212 个字符（字节），这让我相信响应被切断了。它也不以 e 结尾。

这似乎只在涉及二进制数据时发生。二进制数据是否可能包含 '\0' 字符的二进制文件，导致它被过早地切断？我将如何解决这个问题？谢谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T19:38:09.643

可能只是调试器显示字符串直到第一个空字符。您可以考虑使用 a`vector<unsigned char>`代替，因为您在这里处理原始字节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T19:37:04.197

可能这只是一个打印问题：检查实际字符串`length()`并手动打印字符串`data()`（即使用循环）。正如您所说，Visual Studio 完全有可能在`\0`遇到第一个字符串时立即停止在监视列表中显示该字符串。

# php - PHP单选*复杂的单词

> ID：11871788
> 
> 赞同：0
> 
> 时间：2012-08-08T19:29:15.903
> 
> 标签：php, mysql

我目前正在为我的网站创建一个投票模块，我必须检查用户是否已经投票，它只会从投票日志中选择 *，我的脚本会为每次投票插入一条新记录，所以假设你在站点 1 上投票不同的记录，然后说您是否投票给站点 2。

列是站点和用户名。我无法检查他们是否在一个 php mysql 查询 SELECT * FROM TABLE_NAME 中根据他们的用户名对所有网站进行了投票

然后以这种方式整理信息，但我无法理解它....

一如既往地感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T20:23:33.503

这是我将如何设置它：

用户表：

```
CREATE TABLE users(    
    userid    INT UNSIGNED NOT NULL PRIMARY KEY AUTO_INCREMENT,
    username  VARCHAR(50) NOT NULL,
    UNIQUE INDEX(username)
); 
```

网站表：

```
CREATE TABLE sites(    
    siteid    INT UNSIGNED NOT NULL PRIMARY KEY AUTO_INCREMENT,
    sitename  VARCHAR(50) NOT NULL,
    UNIQUE INDEX(sitename)
); 
```

投票表：

```
CREATE TABLE votes(    
    timestamp timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
    userid INT UNSIGNED NOT NULL,
    siteid INT UNSIGNED NOT NULL,
    UNIQUE INDEX(userid,siteid)
); 
```

当用户投票时：

```
INSERT INTO votes(userid,siteid) VALUES ("$userid","$siteid") 
```

要查看用户投票的网站：

```
SELECT sites.sitename FROM sites
INNER JOIN votes ON sites.siteid=votes.voteid
WHERE votes.userid="$userid" 
```

要查看用户未投票的网站（如果没有返回任何行，则用户已在每个网站上投票）：

```
SELECT sitename FROM sites
WHERE siteid NOT IN (
    SELECT siteid FROM votes WHERE userid="$userid"
) 
```

我喜欢这个解决方案，因为这样你就可以显示用户没有投票的网站。

**最后一点**：（1）永远不要在生产环境中使用“SELECT * FROM table”；这是可怕的表现。始终选择您需要的唯一行。并且 (2) 一定要在查询中引用用户输入以避免 SQL 注入攻击。

# php - 有没有办法确保人们无法访问页面，除非他们使用 php 完成了 paypal 表单？

> ID：11871789
> 
> 赞同：0
> 
> 时间：2012-08-08T19:29:16.090
> 
> 标签：php, javascript, security, paypal, download

我有一个文件，我想向用户收取使用贝宝下载的费用，贝宝帐户已设置并且重定向工作，但我想让人们不要只与他们的朋友分享下载网址，以便他们必须填写贝宝表格. 有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:44:09.453

将文件存储在您的 webroot 之外，让用户需要登录。设置 PayPal 的 IPN 以更新用户的帐户，并且仅当用户的帐户被标记为允许时才允许用户下载文件。

但是请注意，对于用户直接共享文件，您确实无能为力。

# wordpress - 首先在子域或完全不同的域上设置新的 Wordpress 站点？

> ID：11871791
> 
> 赞同：1
> 
> 时间：2012-08-08T19:29:19.300
> 
> 标签：wordpress, dns, subdomain

我有一个客户希望我为他们创建一个全新的 WP 网站，但大部分内容与他们当前的 WP 网站相同。

我会更容易在他们当前的域（即test.theirdomain.com）上设置一个子域并在其上安装一个新的wordpress，然后将其移动到主域，或者使用完全不同的域创建站点然后完成后将其移至他们的域？我从来不需要将 WP 站点移动到不同的域，所以我不知道随之而来的所有令人头疼的问题。我认为在潜入之前询问是我最好的选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:36:58.660

移动一个标准的 WordPress 站点并不是一个真正的问题，您必须在数据库中更改主机名几次。

移动 WordPress MU 网站是一场相对的噩梦，这里是龙。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T21:08:19.440

这是 6 对 (2x3)。这也很容易做到。如果您意识到在移动 WordPress 站点时遇到的问题（我说的是普通站点，而不是 MU/Network），那么同样容易。我在这篇文章中写了一些信息；

[http://www.stackoverflow.com/questions/11371308/creating-a-wordpress-dev-enviornment-and-uploading-to-production/11376492#11376492](http://www.stackoverflow.com/questions/11371308/creating-a-wordpress-dev-enviornment-and-uploading-to-production/11376492#11376492)

如果您正在做 WP 工作，它将为您节省大量时间。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-08T19:34:30.063

根据网站的动态程度，最简单的方法是创建另一个网站（域无关紧要），以您喜欢的方式获取。然后，根据您的喜好，更改您的 DNS 条目和 Web 服务器以使用新站点。或者您甚至可以更改您的本地 DNS 条目以将域指向您的新网站，因此当您准备好时，您所要做的就是将您的权威 DNS 更改为您的新网络服务器。

# jquery - Twitter Javascript 插件“BootStrap”

> ID：11871798
> 
> 赞同：0
> 
> 时间：2012-08-08T19:29:45.217
> 
> 标签：jquery, jquery-plugins, twitter-bootstrap

我刚刚实现了[here](http://twitter.github.com/bootstrap/javascript.html#collapse)的基本隐藏和显示。

**这是一个工作示例代码：**

```
<div id="content" class="collapse" >
//Place content in here
</div>
<a href="content" data-toggle="collapse" style="cursor:pointer;">Read More</a> 
```

我的下一个任务是在单击事件上将“阅读更多”更改为“阅读更少”。

问题是如何检查正在发生的事件以及如何使用它。

**示例 Twitter 代码**

```
$('#myCollapsible').on('hidden', function () {
    // do something…
    }) 
```

我不明白的部分是什么是“#myCollapsible”？那会是缩小的 div id 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:33:20.763

使用它是正确的

```
$('#content') 
```

而不是使用

```
$('#myCollapsible') 
```

在你的情况下:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T19:38:10.623

一个完整的解决方案是：

```
$( '#content' ).on( 'hidden', function() {
    $( 'a[href="' + this.id + '"]' ).html( 'Read More' );
}).on( 'shown', function() {
    $( 'a[href="' + this.id + '"]' ).html( 'Read Less' );
}); 
```

如果你想要一些通用的东西，你可以`$( '#content' )`用`$( '.collapse' )`.

# javascript - 如何限制 div 中的图像大小

> ID：11871802
> 
> 赞同：0
> 
> 时间：2012-08-08T19:30:07.660
> 
> 标签：javascript, jquery, html, css

我试图限制`div`.

图像有不同的大小，如果图像过大，我想减小图像大小，同时保持它的比例。

```
 $('#Div').css({display:'block',
                     position: 'absolute',
                     top: offset.top,
                     left:offset.left
                     }).append("<img src='" + largePic+ "'/>"); 
```

这`largePic`是大图像路径，在加载之前我无法判断图像有多大。

知道怎么做吗？非常感谢！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:36:25.400

您可以通过 div 或图像来约束图像。这是通过在 div 上设置宽度并让图像尽可能填充 div 来限制图像的 jsfiddle：http: [//jsfiddle.net/LELns/](http://jsfiddle.net/LELns/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T19:34:10.233

[`max-width`](http://quirksmode.org/css/width.html)使用div 上的 CSS属性。

像这样的东西应该工作：

```
$('#Div').css({display:'block',
                 position: 'absolute',
                 top: offset.top,
                 left:offset.left,
                 max-width: '200px'
                 }).append("<img src='" + largePic+ "'/>"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T19:34:18.380

用最大高度或最大宽度约束它。

# python - 使用 jQuery 从 Web 服务器获取数据

> ID：11871805
> 
> 赞同：1
> 
> 时间：2012-08-08T19:30:18.907
> 
> 标签：python, jquery, webserver, cherrypy

这是场景：我通过 Web 服务器从数据库中获取数据。基于该数据页面向同一服务器发送另一个请求以执行某些操作。简化结构如下：

```
var datacon;
$.post('method',function(data){
   datacon = data;
   // populating some tags;
}) // end of post
//some other staff happening;
$.post('other',{datacon}, function(env){
...// taking data from populated tags
   $("div").load(env);
...
}) // end of post 
```

每次用户进入页面时都会发生这种情况。此代码在打开页面时 datacon 为空的意义上不起作用。但是，如果我将它刷新一次或两次，它就会开始工作。第二个 $.post 完美运行，检查了数百次。我用 $.get 更改了第一个 $.post，但它没有帮助。

可能它涉及异步/同步调用。我不太明白为什么会这样。请帮忙。

ps 服务器是 CherryPy。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:35:17.193

回调函数是异步执行的，即一旦从服务器接收到数据。您的第二个 POST 可能会在第一个 POST 的响应返回之前执行。您可以将您的第一个 post() 更改为 ajax() 并将“异步”设置为“假”。见[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

上面的内容有点笨拙——理想情况下，取决于 AJAX 调用结果的所有内容都应该放在回调方法中。例如，尝试将第二个 POST 移动到第一个回调的内部。像您尝试做的标志设置可能被认为是代码异味。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T19:36:52.780

由于这些调用是异步的，因此第二个调用可能在第一个调用完成之前运行。为了确保它们以正确的顺序运行，请将第二个 ajax 调用放在第一个末尾的 done() 函数中。这样，第二个只会在第一个完成时运行。

这是我正在从事的项目的示例：

```
    $("#leftcolumn").activity();
    $.ajax({
            类型：“获取”，
            网址：“/搜索”，
            缓存：假，
            数据：{搜索词：搜索词}
            }).done(函数(回复){
                $("#leftcolumn").activity(false);
                显示搜索结果（回复）；
                });

```

第一行在屏幕上显示进度指示器。然后 ajax 调用进行搜索。在 .done 的最后，我禁用了我正在显示的进度指示器，然后显示搜索结果。将我要执行的代码放入 .done 可以保证在 ajax 调用完成之前它不会运行。

# javascript - 使用 javascript 计算 Telerik RadDatePicker 日期差异

> ID：11871809
> 
> 赞同：0
> 
> 时间：2012-08-08T19:30:40.190
> 
> 标签：javascript, asp.net, telerik

我正在尝试从日历控件中选择的日期计算天数。如果 Javascript 中有任何功能，请告诉我。

```
 <telerik:RadDatePicker ID="dtStart" runat="server" Culture="English (United States)"
        MinDate="0001-01-01" Enabled="true">
        <DateInput ID="DateInput2" runat="server" DisplayDateFormat="MM/dd/yyyy" DateFormat="MM/dd/yyyy">
        </DateInput>
        <ClientEvents OnDateSelected="DateSelected" />
    </telerik:RadDatePicker>

    <telerik:RadDatePicker ID="dtEndDate" runat="server" Culture="English (United States)"
        MinDate="0001-01-01" Enabled="true">
        <DateInput ID="DateInput3" runat="server" DisplayDateFormat="MM/dd/yyyy" DateFormat="MM/dd/yyyy">
        </DateInput>
        <ClientEvents OnDateSelected="DateSelected" />
    </telerik:RadDatePicker>

function DateSelected(sender, eventArgs) {
    var startDate = $find('<%=dtStart.ClientID%>');
    var endDate =  $find('<%=dtEndDate.ClientID%>');

    if ((startDate.get_selectedDate() != null) && (endDate.get_selectedDate() != null)) {
        var days = (startDate.get_selectedDate() - endDate.get_selectedDate());  
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:36:11.370

我以前没有使用`telerik:RadDatePicker`过，但我认为您最终可以从中获得 JavaScript 日期。一旦你有了它，你可以这样做：

```
var timeDiffMS = date2.getTime() - date1.getTime();
var diffDays = Math.floor(timeDiffMS / 1000 / 60 / 60 / 24); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T19:33:57.393

我会使用一个名为 moment.js 的辅助库来用 javascript 减去日期。[http://momentjs.com/docs/](http://momentjs.com/docs/)

# php - 在php中抛出str_pad的特殊字符？

> ID：11871811
> 
> 赞同：12
> 
> 时间：2012-08-08T19:30:47.537
> 
> 标签：php

我正在编写一个应该能够以 BankOne 格式导出交易记录的模块。

[这是格式的规范](https://s3.amazonaws.com/prod_object_assets/assets/1370813228725/CN_BankOneImport.pdf?AWSAccessKeyId=AKIAJJMCS3THBEIU2QRQ&Expires=1344470222&Signature=eu%2F6sb8Nl9vuveCvAn0arLQG49o%3D)

[这是一个示例文件](https://s3.amazonaws.com/prod_object_assets/assets/1370813228723/bankone.txt?AWSAccessKeyId=AKIAJJMCS3THBEIU2QRQ&Expires=1344450213&Signature=ZxTODQq/1n220LDOZcFn6ZOgkBQ=)

字段放在行上的特定范围内，记录由新行分隔。需要添加大量空格以确保字段在行中的特定点开始和结束。

为此，我在 php 中编写了一个函数。它接受字段作为参数，并应返回格式正确的记录。

```
function record4($checknum='', $nameid='', $purpose='', $pledge='', $payment='', 
             $frequency='', $title='', $fname='', $lname='', $suffix='',
             $address='', $postalcode='', $city='', $state='', $greeting='')
{
$fields = array(
    'checknum' => array('length' => 8, 'start' => 37),
    'nameid' => array('length' => 7, 'start' => 45),
    'purpose' => array('length' => 5, 'start' => 52),
    'pledge' => array('length' => 10, 'start' => 57),
    'payment' => array('length' => 10, 'start' => 67),
    'frequency' => array('length' => 1, 'start' => 77),
    'title' => array('length' => 20, 'start' => 78),
    'fname' => array('length' => 40, 'start' => 98),
    'lname' => array('length' => 40, 'start' => 138),
    'suffix' => array('length' => 20, 'start' => 178),
    'address' => array('length' => 35, 'start' => 198),
    'postalcode' => array('length' => 10, 'start' => 233),
    'city' => array('length' => 28, 'start' => 243),
    'state' => array('length' => 5, 'start' => 271),
    'greeting' => array('length' => 40, 'start' => 276)
);

$str = '4';
foreach($fields as $field_name => $field)
{
    if($$field_name)
    {
        $str = str_pad($str, $field['start']-1, ' ');
        $str = $str.substr(trim((string)$$field_name), 0, $field['length']);
    }
}

return $str."\n";
} 
```

它似乎按预期工作，但是当我查看输出文件时，我发现了这个（滚动到最后）：

```
4                                                                 1                              David                                   Landrum
4                                                                 3                              Hazel                                   Baker
4                                                                 3                              Jerome                                  Zehnder
4                                                                 1                              VÃ­ctor                               Nadales
4                                                                 2                              Philip                                  Nauert
4                                                                 1                              Jana                                    Ortcutter 
```

该文件包含从数据库中提取的 900 条记录，所有记录的格式都正确，除了 Víctor Nadales。在这个名字之后，每隔一个字段就在它应该在的位置的左边三个空格处。这张唱片唯一的异常似乎是名字中的“Ã”。

该函数应该在它处理的每个字段之后将字符串填充到适当的长度，但是它以某种方式在这一行上被愚弄了？

谁能告诉我这里发生了什么？

编辑：我刚刚意识到这种格式的任何导入文件甚至可能不支持特殊的 UTF-8 字符。因此，我将此行添加到我的代码中：

```
$$field_name = iconv('UTF-8', 'ASCII//TRANSLIT', $$field_name); 
```

Ã 看起来像这样：~A-。不理想，但至少文件现在格式正确。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-08T19:40:32.860

发生这种情况是因为`'Ã'`它是一个多字节字符（4 个字节长），并且`str_pad`计算的是字节数而不是逻辑字符数。

这就是为什么您缺少三个空格，`str_pad`将其计`'Ã'`为 4 个单字节字符而不是一个多字节字符。

试试这个功能（[信用在这里](https://gist.github.com/226350)）。

```
<?
function mb_str_pad( $input, $pad_length, $pad_string = ' ', $pad_type = STR_PAD_RIGHT)
{
    $diff = strlen( $input ) - mb_strlen( $input );
    return str_pad( $input, $pad_length + $diff, $pad_string, $pad_type );
}
?> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-05-13T00:50:20.883

使用 Gordon 的解决方案，您只需将编码类型添加到`mb_strlen`，它就会正确计算字节数（至少它对我有用）

这是我使用的功能：

```
function mb_str_pad( $input, $pad_length, $pad_string = ' ', $pad_type = STR_PAD_RIGHT, $encoding="UTF-8") {
    $diff = strlen( $input ) - mb_strlen($input, $encoding);
    return str_pad( $input, $pad_length + $diff, $pad_string, $pad_type );
} 
```

[归功于这里](http://www.php.net/manual/en/ref.mbstring.php#90611)的想法

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-07T09:40:05.627

```
function mb_str_pad($input, $pad_length, $pad_string = ' ', $pad_type = STR_PAD_RIGHT) {
    $diff = strlen($input) - mb_strlen($input,mb_detect_encoding($input));
    return str_pad($input, $pad_length + $diff, $pad_string, $pad_type);
} 
```

# javascript - 来自 Object 的 Jquery Ajax 调用立即失败

> ID：11871812
> 
> 赞同：2
> 
> 时间：2012-08-08T19:30:49.860
> 
> 标签：javascript, jquery

我已经使用对象以及使用 Jquery 1.7.2 创建了一个类。除了“$.ajax()”和“$.getJSON()”等与 AJAX 相关的调用外，我的所有 Jquery 都可以正常工作。

我通常不通过对象或函数创建类，因为不担心范围。我确实认为这是一个范围问题，但我不确定如何解决它，因为我有很多其他 Jquery 代码正在顺利使用。所以问题似乎集中在 JQuery 中设置的 Ajax 上。

下面是一些 Javascript 代码。并非全部，因为它会是一个巨大的数量，并且所有 Jquery 都在其余代码中使用，例如 binding()、click()、.each()。

除了 Ajax 调用之外，还有更多的 HTML 和 JavaScript。HTML、CSS 和 Javascript 已经过验证。这就是为什么我一直认为这是一个范围问题。

**HTML**

```
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="_res/css/main.css" />
        <script src="_res/js/libs/jquery-1.7.2.min.js"></script>
        <script src="_res/js/libs/main.js"></script>
    </head>
    <body></body>
</html> 
```

**Javascript 片段代码 (main.js)**

```
var BettingApp = {
    loadData:function()
    {
        //console.log("loadData()");

        //BettingApp.resetData();

        // This fails before it even tries to get the data.
        $.ajax(
        {
            url: "/_res/json/sampleData.json", 
            cache: false,
            contentType:"json",
            processData: false,
            complete: BettingApp.parseData,
            success: BettingApp.parseData
        });
    },

    resetData:function()
    {
        console.log("resetData()");
        // This works just fine
        $("#agencyBetView ul li").remove();
        $("#playerBetView ul li").remove();
    },

    activateData:function()
    {
        console.log("activateData()");
    }
};

$(document).ready(function(){ BettingApp.loadData(); }); 
```

**来自浏览器的错误（最新的 Chrome、Safari、Firefox）**

```
Uncaught TypeError: Property 'String' of object [object Window] is not a function

jquery-1.7.2.min.js:2
e.extend.type jquery-1.7.2.min.js:2
f.Callbacks.n jquery-1.7.2.min.js:2
f.Callbacks.p.add jquery-1.7.2.min.js:2
f.extend.ajax jquery-1.7.2.min.js:4
BettingApp.loadData main.js:175
BettingApp.updateStep main.js:102
BettingApp.chooseBetType_agency main.js:369
f.event.dispatch jquery-1.7.2.min.js:3
f.event.add.h.handle.i 
```

**以完整代码工作的 Jquery 函数**

```
.bind()
.click()
.data()
.each()
.focus()
.focusout()
.html()
.ready()
.remove()
.slideUp()
.slideDown() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T20:24:30.890

从错误来看，`Property 'String' of object [object Window] is not a function`这意味着您覆盖了window.String，如下所示，`String`实际上被覆盖了，`"fast"`最后被覆盖了`""`

```
animSpeed:String            = "fast",
voucherID_step:Number       = 1,
voucherID_target:String     = "#voucherIDView",
noCredits_step:Number       = 2,
noCredits_target:String     = "#noCreditsView",
chooseBetType_step:Number   = 3,
chooseBetType_target:String = "#chooseBetTypeView",
agencyBet_step:Number       = 4.1,
agencyBet_target:String     = "#agencyBetView",
playerBet_step:Number       = 4.2,
playerBet_target:String     = "#playerBetView",
confirmation_step:Number    = 5,
confirmation_target:String  = "#confirmationView",

// Steps
step:Number                 = 0,

// VoucherID
voucherIDDefaultText:String = "", 
```

你不需要在javascript中指定变量类型（实际上你不能），我想这就是你的意思

```
animSpeed:           "fast",
voucherID_step:          1,
voucherID_target:        "#voucherIDView",
noCredits_step:          2,
noCredits_target:        "#noCreditsView",
chooseBetType_step:      3,
chooseBetType_target:    "#chooseBetTypeView",
agencyBet_step:          4.1,
agencyBet_target:        "#agencyBetView",
playerBet_step:          4.2,
playerBet_target:        "#playerBetView",
confirmation_step:   5,
confirmation_target:     "#confirmationView",

// Steps
step:                0,

// VoucherID
voucherIDDefaultText:    "", 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T19:34:28.537

应该没有`new`

```
new $.ajax( 
```

它应该只是

```
$.ajax( 
```

# objective-c - 覆盖核心数据字段

> ID：11871817
> 
> 赞同：0
> 
> 时间：2012-08-08T19:31:03.640
> 
> 标签：objective-c, ios, xcode

嗨，我对核心数据相当陌生，最近开始做一些教程。我已经通过核心数据成功添加了新数据，但正在努力覆盖数据。我有一个文本字段，我希望能够将在该文本字段中写入的文本保存到核心数据。这就是我添加新数据的方式。谁能带领我朝着正确的方向前进？

谢谢

PS我相信这与我做“insertNewObjectForEntityForName”的方式有关

```
-(IBAction)saveData
{

AppDelegate *appDelegate = 
[[UIApplication sharedApplication] delegate];

NSManagedObjectContext *context = 
[appDelegate managedObjectContext];
NSManagedObject *newContact;
newContact = [NSEntityDescription
              insertNewObjectForEntityForName:@"Gameinfo"
              inManagedObjectContext:context];
[newContact setValue:[self valuefromtextfield] forKey:@"score"];
//[newContact setValue:@"mark" forKey:@"currentLevel"];
NSError *error;
[context save:&error];

 } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T19:42:36.753

当您使用时，`insertNewObjectForEntityForName`您正在创建一个**新**实体。如果要编辑**现有**实体，则需要

```
AppDelegate *app = [[UIApplication sharedApplication] delegate]
NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:@"Gameinfo"];
NSError *error = nil;
NSArray *someArray = [app.managedObjectContext executeFetchRequest:request error:&error]; 
```

然后`someArray`具有其中命名`Gameinfo`的所有实体。找到您想要的并编辑您想要的任何属性。然后调用`save`托管对象上下文。

# android - 我如何从arraylist中获取第一个数据（在我的代码中匹配）

> ID：11871825
> 
> 赞同：1
> 
> 时间：2012-08-08T19:31:36.867
> 
> 标签：android

我只需要显示来自的第一个条目`Arraylist`。

我下面的代码显示了所有结果，但我只需要列表中的第一个条目。

`wordsList`是`ListView`：

```
ArrayList <<String>> matches = data.getStringArrayListExtra(RecognizerIntent.EXTRA_RESULTS);

wordsList.setAdapter(new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1,matches)); 
```

* * *

完整的方法代码：

```
protected void onActivityResult(int requestCode, int resultCode, Intent data) 
{
    if (requestCode == REQUEST_CODE && resultCode == RESULT_OK) 
    { 
        // Populate the wordsList with the String values the recognition engine thought it heard 
        ArrayList<String> matches = data.getStringArrayListExtra( RecognizerIntent.EXTRA_RESULTS); 
        wordsList.setAdapter(new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, matches.get(0)));
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:36:47.517

由于您只需要第一个元素，因此`ArrayList<String> matches`您只需要创建一个新`List<String>`元素并将第一个元素添加到新元素`List`。

然后将新`List`的用于`Adapter`.

```
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    if (requestCode == REQUEST_CODE && resultCode == RESULT_OK) { 
        // Populate the wordsList with the String values the recognition engine thought it heard 
        ArrayList<String> matches = 
                data.getStringArrayListExtra( RecognizerIntent.EXTRA_RESULTS);

        if (matches.size() > 0) {
            List<String> oneMatch = new ArrayList<String>();
            oneMatch.add(matches.get(0));

            wordsList.setAdapter(
                new ArrayAdapter<String>(
                     this, android.R.layout.simple_list_item_1, oneMatch));
        } else {
            Log.e(TAG, "Matches does not contain any values.");
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T19:39:23.993

如果您试图获取第一个元素，`ArrayList`那么您需要使用`get(int)`ArrayList 类的方法。因此，在您的情况下，您`matches.get(0)`将获得`matches` `ArrayList`. 请澄清“第一数据”的含义，以便我可以提供最佳答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T19:42:25.940

如果您只想显示第一项，请执行以下操作：

```
ArrayList <<String>> matches = data.getStringArrayListExtra(RecognizerIntent.EXTRA_RESULTS);

wordsList.setAdapter(new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1,matches.get(0))); 
```

将其更改为`matches.get(0)`仅将列表中的第一个 String 对象传递给您的适配器。很难说你在做什么，因为只有一个项目的适配器似乎效率低下。

# ruby-on-rails - 以简单形式向文本输入添加默认值

> ID：11871827
> 
> 赞同：30
> 
> 时间：2012-08-08T19:31:43.573
> 
> 标签：ruby-on-rails, ruby-on-rails-3, simple-form

我想使用简单表单向文本输入字段添加默认值。不使用`:placeholder`它作为默认值....

```
<%= f.input :user, :placeholder => 'user@domain.com' %> 
```

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-08-08T19:36:39.037

```
<%= f.input :user, :input_html => { :value => 'user@domain.com' } %> 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-12-13T01:09:45.160

你可以简单地做：

```
<% f.text_field, value: 'user@admin.com' %> 
```

`text_field`如果您正在使用像 Ransack 这样的表单搜索 gem，那就太好了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-07-12T12:07:47.140

在 Rails 5.1 上`placeholder: 'aaaaaaaaaaa'`工作。例如

```
<%= f.input :user, :placeholder => 'user@domain.com' %> 
```

将在 Rails 5.1 上工作

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-12-03T14:52:10.987

你可以试试这个选项：

```
<%= f.input :user, label: 'user@domain.com' %> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-15T12:42:35.607

您可以在控制器中执行此操作，并将数据详细信息保留在表单之外。而不是这个： `def new @article = Article.new end`

你可以这样做： `def new # hardcode default values (as shown) or generate on the fly @article = Article.new(title: "10 Best Things") end`

“新”表单将打开并填充默认（预设）值。这应该适用于简单表单、普通旧 Rails 或任何其他以 Rails 方式执行操作的表单生成器。

# java - 如何区分某些标识符和变量声明之间的区别？

> ID：11871828
> 
> 赞同：1
> 
> 时间：2012-08-08T19:31:44.963
> 
> 标签：java, compiler-construction, javac

我正在为一些类似 Java 的语言制作一个简单的解析器（仅用于学习目的）。我无法确定语句是否是变量声明。这可能是我的词法分析器的问题（这真的很草率）。如果词法分析器看到一些文本，它只是将其标记为标识符，即使该文本是关键字或类型。将它们区分开来的工作交给了解析器。

到目前为止，这已经奏效，但现在我正在尝试解析变量声明，就像这里的这个：

```
int x = 3; 
```

问题是我不知道如何确定这是否是变量声明。如果我只查看第一个标记并发现它是一个“标识符”，那并不能告诉我任何信息，因为这行代码也以一个标识符开头：

```
System.out.print("hi"); 
```

像这样的语句由解析器的另一部分处理。

我想到的另一个解决方案是检查第一个标记是否是一种类型。例如，我可以有一个看起来像这样的方法：

```
boolean isType(String t) {
    if( t.equals("int")  ||
        t.equals("long") ||
        t.equals("char") ||
        /* et cetera */ )
        return true;
    else return false;
} 
```

这样做的问题是它只允许特定的一组类型。由于我的小语言被编译为 Java 字节码，因此我需要它来将任意类识别为类型。

所以我的问题是：是否可以在不知道所有可能的变量类型的情况下确定语句是否是变量声明？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T06:55:48.640

另一种解决方案是让解析器和词法分析器使用符号表进行协作。一旦解析器确定已经声明了一个新的类型名称，它将将该名称作为类型名称插入符号表中。反过来，词法分析器会查询符号表以查看新的类似标识符的单词是否是类型名称，并相应地选择正确的标记类型。

然而，也有一些并发症。

*   如果语言允许内部作用域将类型名称重新定义为另一种类型的名称或非类型标识符，则符号表必须理解作用域，并且解析器必须在作用域结束时通知符号表。
*   如果语言允许类型名称在某些上下文中成为普通标识符，则解析器必须能够处理它。
*   如果解析器回溯，它还必须记住撤消符号表更改。

它不像让词法分析器忽略上下文那样干净，但作为回报（在某些情况下）它允许解析器避免过度的前瞻和回溯；尽管我认为 Java 解析器不一定需要这种帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T19:39:36.797

当您阅读第一个单词时，您不知道它是否是声明，但您不需要。

当你得到下一个分隔符时，你就知道它是做什么用的了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T19:39:47.347

大约 4 年前，我不得不为一堂课做这种风格的东西。虽然我不记得“官方”方式的所有细节，但是

我会做的是，我会向前看，在未来的符号中确定它是否是一个变量声明，也就是说`Benjamin Gruenbaum`，如果你看到一个合法的标识符（在一行的开头）后跟另一个合法的标识符，而不是第一个可能是变量声明。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-08T19:40:02.987

您可能应该阅读有关编译器设计的书，并且可能在尝试之前查看 lex 和 yacc 代码。或者你可以[谷歌写一个编译器](https://www.google.com/search?q=writing%20a%20compiler&rlz=1C1CHFX_enUS459US459&aq=f&sugexp=chrome,mod=10&sourceid=chrome&ie=UTF-8)

IIRC，已经有一段时间了，首先将源文件分解为[解析树](http://en.wikipedia.org/wiki/Parse_tree)，然后遍历解析树以生成目标代码。当您分解源文件时，您会根据关键字标记列表检查每个标记。

在您的示例中，您的词法分析器会看到“int”，并对其进行处理，查找必须跟随关键字（或在它之前，取决于您的语言定义）的变量声明。

这看起来很容易，但是大多数人使用 flex 或 lex 之类的工具来创建解析树是有原因的。

# extjs - 考虑浮动自动调整大小的 ExtJS 面板中的滚动条宽度

> ID：11871829
> 
> 赞同：0
> 
> 时间：2012-08-08T19:31:59.210
> 
> 标签：extjs, scrollbar

这是我的问题，使用 ExtJS 4.1.1：我有一个浮动面板，它的内容可能会随着时间的推移而改变大小。我想让浮动面板围绕内容调整大小，但将高度限制为最大 400 像素，之后应该会出现一个垂直滚动条。

这个 JSFiddle 最好地解释了这个问题：http: [//jsfiddle.net/38Kaf/6/](http://jsfiddle.net/38Kaf/6/)。

当内容大小低于 maxHeight 时，自动调整大小效果很好。但是当它更大（350px 或更大）时，面板宽度太小，无法同时包含蓝色框*和*垂直滚动条，导致出现水平滚动。

请注意，布局属性（“manageOverflow”和“reserveScrollbar”）都没有任何效果。

欢迎任何有关解决方法或替代方法的建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:48:47.153

您已指定布局属性，但尚未指定布局类型：

```
layout: {
    type: 'fit',
    manageOverflow: 1,
    reserveScrollbar: true
} 
```

这应该可以解决问题。

# python - SciPy 源代码 - 找不到导入的模块

> ID：11871833
> 
> 赞同：1
> 
> 时间：2012-08-08T19:32:03.340
> 
> 标签：python, module, github, package, scipy

我在[那里](https://github.com/scipy/scipy/tree/master/scipy/ndimage)玩 scipy 源代码。

我正在寻找方法分水岭`ndimage.measurements`。方法正在调用一个神秘的`_nd_image.watershed_ift(...)`模块`measurements.py`并且确实 import `_nd_image`。但是，我`_nd_image`在父存储库和其他任何地方都找不到。

我想知道是否`_nd_image`指的`watershed_ift`是 src 文件夹中的 C 实现。但是，该算法的 C 实现不存在于`nd_image.c`.

这个`_nd_image`模块是什么？我在哪里可以找到这个分水岭算法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T19:41:53.537

您怀疑它在 C 中是正确的；[nd_image.c](https://github.com/scipy/scipy/blob/master/scipy/ndimage/src/nd_image.c#L809)定义`Py_WatershedIFT`（暴露为[watershed_ift](https://github.com/scipy/scipy/blob/master/scipy/ndimage/src/nd_image.c#L1013)）。这调用了`NI_WatershedIFT`ni_measure.c[中](https://github.com/scipy/scipy/blob/master/scipy/ndimage/src/ni_measure.c#L867)的实际实现。

# sqlite - 编译 Sqlite 并将其包含在 PHP 中

> ID：11871834
> 
> 赞同：1
> 
> 时间：2012-08-08T19:32:04.837
> 
> 标签：sqlite

我使用以下方法编译了 Sqlite 3.7.13：

```
apt-get install build-essential
apt-get install php5-dev
wget http://www.sqlite.org/sqlite-autoconf-3071300.tar.gz
tar -xzf sqlite-autoconf-3071300.tar.gz
cd sqlite-autoconf-3071300
phpize
./configure
make
make install
ldconfig
sqlite3 --version 
```

编辑 sqlite.ini 并包含 sqlite.so

```
nano /etc/php5/conf.d/sqlite.ini
extionsion=sqlite.so 
```

问题是现在我在我的 phpinfo 中看不到 sqlite 扩展，并且 sqlite 在 PHP 脚本中不起作用。我正在使用 Debian 6。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:40:50.973

听起来你做的大部分事情都是正确的。

建议：

1.  这是一个错字：`extionsion=sqlite.so`？

    应该：`extension=sqlite.so`

2.  您的 sqlite.so 在您的 PHP 插件目录中吗？

3.  看看这个链接：

    *   [如何为 php 启用 sqlite3？](https://stackoverflow.com/questions/948899/how-to-enable-sqlite3-for-php)
4.  也看这里：

    *   [http://php.net/manual/en/sqlite.installation.php](http://php.net/manual/en/sqlite.installation.php)

# hibernate - Hibernate 3.6.10 依赖解析

> ID：11871838
> 
> 赞同：0
> 
> 时间：2012-08-08T19:32:46.067
> 
> 标签：hibernate, ivy, slf4j

我最近升级了一个项目以使用 hibernate 3.6.10.Final。该项目使用常春藤检索和依赖项。现在我收到一个错误，找不到 slf4j 中的方法。我相信这是由于 hibernate-core（需要 1.6.1）和 hibernate-commons-annotations（需要 1.5.8）之间的冲突 slf4j 依赖关系。根据hibernate-core ivy.xml，hibernate-core依赖于hibernate-commons-annotations。

这是我得到的错误：

```
 Constructor threw exception; nested exception is java.lang.NoSuchMethodError: org.slf4j.helpers.MessageFormatter.format(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/String;:
java.lang.NoSuchMethodError: org.slf4j.helpers.MessageFormatter.format(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/String;
        at org.slf4j.impl.JDK14LoggerAdapter.info(JDK14LoggerAdapter.java:303)
        at org.hibernate.annotations.common.Version.<clinit>(Version.java:37)
        at org.hibernate.annotations.common.reflection.java.JavaReflectionManager.<clinit>(JavaReflectionManager.java:73)
        at org.hibernate.cfg.Configuration.createReflectionManager(Configuration.java:2988)
        at org.hibernate.cfg.Configuration.createReflectionManager(Configuration.java:2984)
        at org.hibernate.cfg.Configuration.reset(Configuration.java:307)
        at org.hibernate.cfg.Configuration.<init>(Configuration.java:298)
        at org.hibernate.cfg.Configuration.<init>(Configuration.java:302)
        at mb.common.hibernate.cfg.DefaultEnhancedConfiguration.<init>(DefaultEnhancedConfiguration.java:10)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
        at java.lang.reflect.Constructor.newInstance(Constructor.java:525) 
```

我检查了旧的 slf4j javadoc，果然看起来 slf4j-1.6.1 有一个格式方法，它返回一个 FomattingTuple 而不是一个字符串。

这是从 maven2 存储库中检索到的**hibernate-core-3.6.10.Final ivy.xml**文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<ivy-module version="2.0" xmlns:m="http://ant.apache.org/ivy/maven">
    <info organisation="org.hibernate"
        module="hibernate-core"
        revision="3.6.10.Final"
        status="release"
        publication="20120208201903"
    >
        <description homepage="">
        The core functionality of Hibernate
        </description>
        <m:dependency.management__javassist__javassist__version>3.12.0.GA</m:dependency.management__javassist__javassist__version>
        <m:properties__bytemanVersion>1.5.1</m:properties__bytemanVersion>
        <m:dependency.management__commons-collections__commons-collections__version>3.1</m:dependency.management__commons-collections__commons-collections__version>
        <m:dependency.management__javax.validation__validation-api__version>1.0.0.GA</m:dependency.management__javax.validation__validation-api__version>
        <m:dependency.management__dom4j__dom4j__version>1.6.1</m:dependency.management__dom4j__dom4j__version>
        <m:dependency.management__org.hibernate__hibernate-validator__version>4.1.0.Final</m:dependency.management__org.hibernate__hibernate-validator__version>
        <m:dependency.management__cglib__cglib__version>2.2</m:dependency.management__cglib__cglib__version>
        <m:dependency.management__org.hibernate.javax.persistence__hibernate-jpa-2.0-api__version>1.0.1.Final</m:dependency.management__org.hibernate.javax.persistence__hibernate-jpa-2.0-api__version>
        <m:dependency.management__com.h2database__h2__version>1.2.145</m:dependency.management__com.h2database__h2__version>
        <m:properties__project.build.sourceEncoding>UTF-8</m:properties__project.build.sourceEncoding>
        <m:properties__slf4jVersion>1.6.1</m:properties__slf4jVersion>
        <m:dependency.management__org.slf4j__slf4j-api__version>1.6.1</m:dependency.management__org.slf4j__slf4j-api__version>
        <m:dependency.management__antlr__antlr__version>2.7.6</m:dependency.management__antlr__antlr__version>
        <m:dependency.management__org.hibernate__hibernate-commons-annotations__version>3.2.0.Final</m:dependency.management__org.hibernate__hibernate-commons-annotations__version>
        <m:properties__antlrPluginVersion>2.1</m:properties__antlrPluginVersion>
        <m:dependency.management__org.jboss.byteman__byteman__version>1.5.1</m:dependency.management__org.jboss.byteman__byteman__version>
        <m:maven.plugins>org.jboss.maven.plugins__maven-jdocbook-style-plugin__null|org.codehaus.groovy.maven__gmaven-plugin__1.0|org.apache.maven.plugins__maven-enforcer-plugin__null|org.apache.maven.plugins__maven-compiler-plugin__null|org.apache.maven.plugins__maven-jar-plugin__null|org.apache.maven.plugins__maven-surefire-plugin__null|org.apache.maven.plugins__maven-source-plugin__null|org.jboss.maven.plugins__maven-jdocbook-style-plugin__null|org.codehaus.groovy.maven__gmaven-plugin__1.0|org.apache.maven.plugins__maven-enforcer-plugin__null|org.apache.maven.plugins__maven-compiler-plugin__null|org.apache.maven.plugins__maven-jar-plugin__null|org.apache.maven.plugins__maven-surefire-plugin__null|org.apache.maven.plugins__maven-source-plugin__null|org.codehaus.mojo__antlr-maven-plugin__2.1|org.jboss.maven.plugins__maven-injection-plugin__null|null__maven-jar-plugin__null</m:maven.plugins>
    </info>
    <configurations>
        <conf name="default" visibility="public" description="runtime dependencies and master artifact can be used with this conf" extends="runtime,master"/>
        <conf name="master" visibility="public" description="contains only the artifact published by this module itself, with no transitive dependencies"/>
        <conf name="compile" visibility="public" description="this is the default scope, used if none is specified. Compile dependencies are available in all classpaths."/>
        <conf name="provided" visibility="public" description="this is much like compile, but indicates you expect the JDK or a container to provide it. It is only available on the compilation classpath, and is not transitive."/>
        <conf name="runtime" visibility="public" description="this scope indicates that the dependency is not required for compilation, but is for execution. It is in the runtime and test classpaths, but not the compile classpath." extends="compile"/>
        <conf name="test" visibility="private" description="this scope indicates that the dependency is not required for normal use of the application, and is only available for the test compilation and execution phases." extends="runtime"/>
        <conf name="system" visibility="public" description="this scope is similar to provided except that you have to provide the JAR which contains it explicitly. The artifact is always available and is not looked up in a repository."/>
        <conf name="sources" visibility="public" description="this configuration contains the source artifact of this module, if any."/>
        <conf name="javadoc" visibility="public" description="this configuration contains the javadoc artifact of this module, if any."/>
        <conf name="optional" visibility="public" description="contains all optional dependencies"/>
    </configurations>
    <publications>
        <artifact name="hibernate-core" type="jar" ext="jar" conf="master"/>
        <artifact name="hibernate-core" type="source" ext="jar" conf="sources" m:classifier="sources"/>
    </publications>
    <dependencies>
        <dependency org="antlr" name="antlr" rev="2.7.6" force="true" conf="compile->compile(*),master(*);runtime->runtime(*)"/>
        <dependency org="commons-collections" name="commons-collections" rev="3.1" force="true" conf="compile->compile(*),master(*);runtime->runtime(*)"/>
        <dependency org="dom4j" name="dom4j" rev="1.6.1" force="true" conf="compile->compile(*),master(*);runtime->runtime(*)">
            <exclude org="xml-apis" module="xml-apis" name="*" type="*" ext="*" conf="" matcher="exact"/>
        </dependency>
        <dependency org="org.hibernate" name="hibernate-commons-annotations" rev="3.2.0.Final" force="true" conf="compile->compile(*),master(*);runtime->runtime(*)"/>
        <dependency org="org.hibernate.javax.persistence" name="hibernate-jpa-2.0-api" rev="1.0.1.Final" force="true" conf="compile->compile(*),master(*);runtime->runtime(*)"/>
        <dependency org="javax.validation" name="validation-api" rev="1.0.0.GA" force="true" conf="provided->compile(*),provided(*),runtime(*),master(*)"/>
        <dependency org="org.hibernate" name="hibernate-validator" rev="4.1.0.Final" force="true" conf="test->runtime(*),master(*)"/>
        <dependency org="javax.xml.bind" name="jaxb-api" rev="2.2" force="true" conf="test->runtime(*),master(*)">
            <exclude org="javax.xml.stream" module="stax-api" name="*" type="*" ext="*" conf="" matcher="exact"/>
            <exclude org="javax.activation" module="activation" name="*" type="*" ext="*" conf="" matcher="exact"/>
        </dependency>
        <dependency org="com.sun.xml.bind" name="jaxb-impl" rev="2.1.12" force="true" conf="test->runtime(*),master(*)"/>
        <dependency org="javassist" name="javassist" rev="3.12.0.GA" force="true" conf="optional->compile(*),master(*)"/>
        <dependency org="cglib" name="cglib" rev="2.2" force="true" conf="optional->compile(*),master(*)"/>
        <dependency org="javax.transaction" name="jta" rev="1.1" force="true" conf="compile->compile(*),master(*);runtime->runtime(*)"/>
        <dependency org="org.jboss.javaee" name="jboss-jacc-api_JDK4" rev="1.1.0" force="true" conf="provided->compile(*),provided(*),runtime(*),master(*)">
            <exclude org="org.jboss.javaee" module="jboss-servlet-api_3.0" name="*" type="*" ext="*" conf="" matcher="exact"/>
            <exclude org="org.jboss.logging" module="jboss-logging-spi" name="*" type="*" ext="*" conf="" matcher="exact"/>
            <exclude org="org.jboss" module="jboss-common-core" name="*" type="*" ext="*" conf="" matcher="exact"/>
        </dependency>
        <dependency org="ant" name="ant" rev="1.6.5" force="true" conf="provided->compile(*),provided(*),runtime(*),master(*)"/>
        <dependency org="com.h2database" name="h2" rev="1.2.145" force="true" conf="test->runtime(*),master(*)"/>
        <dependency org="org.slf4j" name="slf4j-api" rev="1.6.1" force="true" conf="compile->compile(*),master(*);runtime->runtime(*)"/>
        <dependency org="junit" name="junit" rev="3.8.1" force="true" conf="test->runtime(*),master(*)"/>
        <dependency org="org.slf4j" name="jcl-over-slf4j" rev="1.6.1" force="true" conf="test->runtime(*),master(*)"/>
        <dependency org="org.slf4j" name="slf4j-log4j12" rev="1.6.1" force="true" conf="test->runtime(*),master(*)"/>
        <dependency org="commons-logging" name="commons-logging" rev="99.0-does-not-exist" force="true" conf="test->runtime(*),master(*)"/>
        <dependency org="commons-logging" name="commons-logging-api" rev="99.0-does-not-exist" force="true" conf="test->runtime(*),master(*)"/>
        <override org="commons-collections" module="commons-collections" matcher="exact" rev="3.1"/>
        <override org="org.hibernate" module="hibernate-validator" matcher="exact" rev="4.1.0.Final"/>
        <override org="javassist" module="javassist" matcher="exact" rev="3.12.0.GA"/>
        <override org="org.jboss.byteman" module="byteman" matcher="exact" rev="1.5.1"/>
        <override org="cglib" module="cglib" matcher="exact" rev="2.2"/>
        <override org="org.hibernate.javax.persistence" module="hibernate-jpa-2.0-api" matcher="exact" rev="1.0.1.Final"/>
        <override org="com.h2database" module="h2" matcher="exact" rev="1.2.145"/>
        <override org="org.hibernate" module="hibernate-commons-annotations" matcher="exact" rev="3.2.0.Final"/>
        <override org="org.slf4j" module="slf4j-api" matcher="exact" rev="1.6.1"/>
        <override org="antlr" module="antlr" matcher="exact" rev="2.7.6"/>
        <override org="javax.validation" module="validation-api" matcher="exact" rev="1.0.0.GA"/>
        <override org="dom4j" module="dom4j" matcher="exact" rev="1.6.1"/>
    </dependencies>
</ivy-module> 
```

这是从 maven2 存储库中检索到的**hibernate-commons-annotations-3.2.0.Final ivy.xml**文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<ivy-module version="2.0" xmlns:m="http://ant.apache.org/ivy/maven">
    <info organisation="org.hibernate"
        module="hibernate-commons-annotations"
        revision="3.2.0.Final"
        status="release"
        publication="20100309114153"
    >
        <license name="GNU LESSER GENERAL PUBLIC LICENSE" url="http://www.gnu.org/licenses/lgpl.txt" />
        <description homepage="http://hibernate.org">
        Common reflection code used in support of annotation processing
        </description>
        <m:dependency.management__org.slf4j__slf4j-api__version>1.5.8</m:dependency.management__org.slf4j__slf4j-api__version>
        <m:properties__slf4jVersion>1.5.8</m:properties__slf4jVersion>
        <m:maven.plugins>org.apache.maven.plugins__maven-compiler-plugin__null</m:maven.plugins>
    </info>
    <configurations>
        <conf name="default" visibility="public" description="runtime dependencies and master artifact can be used with this conf" extends="runtime,master"/>
        <conf name="master" visibility="public" description="contains only the artifact published by this module itself, with no transitive dependencies"/>
        <conf name="compile" visibility="public" description="this is the default scope, used if none is specified. Compile dependencies are available in all classpaths."/>
        <conf name="provided" visibility="public" description="this is much like compile, but indicates you expect the JDK or a container to provide it. It is only available on the compilation classpath, and is not transitive."/>
        <conf name="runtime" visibility="public" description="this scope indicates that the dependency is not required for compilation, but is for execution. It is in the runtime and test classpaths, but not the compile classpath." extends="compile"/>
        <conf name="test" visibility="private" description="this scope indicates that the dependency is not required for normal use of the application, and is only available for the test compilation and execution phases." extends="runtime"/>
        <conf name="system" visibility="public" description="this scope is similar to provided except that you have to provide the JAR which contains it explicitly. The artifact is always available and is not looked up in a repository."/>
        <conf name="sources" visibility="public" description="this configuration contains the source artifact of this module, if any."/>
        <conf name="javadoc" visibility="public" description="this configuration contains the javadoc artifact of this module, if any."/>
        <conf name="optional" visibility="public" description="contains all optional dependencies"/>
    </configurations>
    <publications>
        <artifact name="hibernate-commons-annotations" type="jar" ext="jar" conf="master"/>
        <artifact name="hibernate-commons-annotations" type="source" ext="jar" conf="sources" m:classifier="sources"/>
        <artifact name="hibernate-commons-annotations" type="javadoc" ext="jar" conf="javadoc" m:classifier="javadoc"/>
    </publications>
    <dependencies>
        <dependency org="org.slf4j" name="slf4j-api" rev="1.5.8" force="true" conf="compile->compile(*),master(*);runtime->runtime(*)"/>
        <dependency org="junit" name="junit" rev="3.8.1" force="true" conf="test->runtime(*),master(*)"/>
        <dependency org="org.slf4j" name="jcl-over-slf4j" rev="1.5.8" force="true" conf="test->runtime(*),master(*)"/>
        <dependency org="org.slf4j" name="slf4j-log4j12" rev="1.5.8" force="true" conf="test->runtime(*),master(*)"/>
        <dependency org="commons-logging" name="commons-logging" rev="99.0-does-not-exist" force="true" conf="test->runtime(*),master(*)"/>
        <dependency org="commons-logging" name="commons-logging-api" rev="99.0-does-not-exist" force="true" conf="test->runtime(*),master(*)"/>
        <override org="org.slf4j" module="slf4j-api" matcher="exact" rev="1.5.8"/>
    </dependencies>
</ivy-module> 
```

我应该如何解决这种依赖冲突？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T22:29:54.283

您的问题是类路径上只能使用 slf4j jar 的一份副本，因此您需要决定保留哪一份。选择旧版本可能会修复一个编译错误，但会导致另一个:-)

默认情况下，ivy 会选择最新的，假设它向后兼容。您可以通过使用[冲突](http://ant.apache.org/ivy/history/latest-milestone/ivyfile/conflict.html)指示器来覆盖此行为，如下所示：

```
<dependencies>
    <dependency org="org.hibernate" name="hibernate-core" rev="3.6.10.Final" conf="compile->default"/>
    <dependency org="org.slf4j" name="slf4j-api" rev="1.5.8" conf="compile->default"/>

    <conflict org="org.slf4j" module="slf4j-api" rev="1.5.8"/>
</dependencies> 
```

# javascript - 如何与 JQuery RGB 值进行比较？

> ID：11871843
> 
> 赞同：3
> 
> 时间：2012-08-08T19:33:16.693
> 
> 标签：javascript, jquery

我想使用 jQuery 或 Javascript 中的简单方法与返回的 rgb 颜色值进行比较。我已经尝试了所有我能想到的东西，但无法得到任何评估真实的东西。

```
if( $('.Updated-Alert').css('color') == 'rgb(255,0,0)') 
```

我找到了通过 RGB 解析的其他答案，但对于我需要它的东西来说，它们确实看起来有点过分了。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-08T19:36:59.327

它只返回一个字符串。您的比较失败，因为您的空白阻止了等价性。

```
$('div').css('color') === 'rgb(0, 0, 255)' 
```

[http://jsfiddle.net/etLcv/](http://jsfiddle.net/etLcv/)

如果你想加强一点，你可以修剪空白并与之进行比较：

```
$('div').css('color').replace(/\s+/g, '') === 'rgb(0,0,255)' 
```

甚至删除除数字以外的任何内容：

```
$('div').css('color').replace(/\D+/g, '') === '00255' 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-08T19:37:17.053

在值之后添加一个空格 - [http://jsfiddle.net/c6874/](http://jsfiddle.net/c6874/)

```
if ( $("p").css("color") == 'rgb(255, 0, 0)' ) {
    alert("It's red");
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-08T19:37:11.637

这在基本的 javascript 中并不是一个简单的任务，考虑以下事实

`white == #FFF == #FFFFFF == rgb(255,255,255) == rgba(255,255,255,0`

这是一个执行此操作的免费库： [http ://www.phpied.com/rgb-color-parser-in-javascript/](http://www.phpied.com/rgb-color-parser-in-javascript/)

# google-chrome-extension - 为什么 Chrome 网上应用店“在哪里发布”选项不见了？

> ID：11871848
> 
> 赞同：2
> 
> 时间：2012-08-08T19:33:37.957
> 
> 标签：google-chrome-extension

从我的个人基于 Google Apps 的帐户部署应用程序或扩展程序时，我在 Chrome 网上应用店中看到“发布位置”选项，该选项允许我将用户限制在我的域中。

但是，当使用我雇主的帐户（Google Apps for business 帐户）时，该选项根本不可用。

这是为什么？域配置中是否有需要在某处切换的选项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T05:48:08.700

我不久前遇到了这个问题。无法将“发布位置”控制权委托给您的 Google 帐户。如果您是 Google Apps 帐户的管理员，则可以访问“在哪里发布”功能，以便在您的域中私下共享应用程序。我怀疑您也可以使用组电子邮件地址（例如 qa_team@example.com）手动添加“测试人员帐户”，但我没有尝试过。

奇怪的是，这对于 Chrome Web Store 上的 Chrome OS 应用程序（但不是 CWS 上的常规 Chrome 应用程序）来说根本不是问题。他们甚至获得了一个小“For domain.name”类别，该类别仅适用于 Chrome OS 用户。我们普通的 Chrome 人没有得到这样的爱。请参阅： http: [//support.google.com/chromeos/a/bin/answer.py ?hl=en&answer=2649489](http://support.google.com/chromeos/a/bin/answer.py?hl=en&answer=2649489)

# php - AJAX 搜索不显示结果

> ID：11871851
> 
> 赞同：2
> 
> 时间：2012-08-08T19:33:51.390
> 
> 标签：php, ajax, modx-evolution

我正在尝试创建 AJAX 搜索并遇到一些困难。这是我的 JS 和表单：

```
<script type="text/javascript">// 
function prodSearch(request) {

    if (request == "") {
        document.getElementById("searchResults").innerHtml="";  
        return;
    }

    if (window.XMLHttpRequest) {
        xmlhttp = new XMLHttpRequest();
    }

    xmlhttp.onreadystatechange = function() {
        if(xmlhttp.readystate==4 && xmlhttp.status==200) {
            document.getElementById("searchResults").innerHTML=xmlhttp.responseText;
        }
    }
xmlhttp.open("GET","/ps.php?country="+request,true);
xmlhttp.send();
}
</script>
<form>
<select name="countries" onchange="prodSearch(this.value)">
<option>Select a country:</option> ...
<div id="searchResults">
</div> 
```

这是我的php：

```
<?php
/* Get data from form */
$country = $_GET["country"];

/* Build query */
$result = "SELECT .... ";

while( $row = $modx->db->getRow( $result ) ) {
    echo "<pre>";
    print_r($row);
    echo "</pre>";
}

?> 
```

我对数据库的查询运行良好，我可以在 Firebug 控制台中看到 ps.php 正在返回结果。但是，我似乎无法让它实际填充`searchResults div`结果。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T20:01:20.387

`readyState``if`有一个大写字母 S。将您的条件更改为：

```
if(xmlhttp.readyState==4 && xmlhttp.status==200) { 
```

# objective-c - 什么时候适合使用常量，什么时候适合使用单一方法返回一个常量

> ID：11871853
> 
> 赞同：0
> 
> 时间：2012-08-08T19:33:59.047
> 
> 标签：objective-c, singleton, global-variables, constants, software-design

所以可以说我有以下代码

标题：

```
#import <Foundation/Foundation.h>

FOUNDATION_EXPORT NSString* const kTHBaseUrl;

@interface THSharedObject : NSObject

+ (THSharedObject*)shared;
- (NSString*)baseUrl;

@end 
```

执行：

```
#import "THSharedObject.h"

NSString* const kTHBaseURL = @"http://0.0.0.0/";

@implementation THSharedObject

static THSharedObject* shared;

+ (void)initialize
{
    static BOOL initialized = NO;
    if(!initialized) {
        initialized = YES;
        shared = [[THSharedObject alloc] init];
    }
}

+ (THSharedObject*)shared
{
    return shared;
}

- (NSString*)baseUrl
{
    return kTHBaseURL;
}

- (MyModelObject*)globalModel
{
    return instanceOfModel;
}

@end 
```

我应该将此文件包含在 .pch 中，还是应该仅将其包含在使用共享对象的文件中。

调用 kTHBaseURL 常量，或者调用返回常量 [[THSharedObject shared] baseUrl]; 的实例化方法会更合适吗？

将文件包含在 pch 中而不是将其仅包含在使用它的类中的优点和缺点是什么。

与直接调用常量相比，调用返回常量的方法有什么优势。

或者这一切只是一个意见问题？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:51:47.230

您不能从类外部访问实现中的常量，除非常量在头文件中，在这种情况下不是。直接在类内部使用常量是可以的，但是外部类需要一个静态方法（如果它是静态的）或实例方法来返回值。

# android - 如何在 Android 上制作频闪灯效果？

> ID：11871854
> 
> 赞同：-2
> 
> 时间：2012-08-08T19:34:03.557
> 
> 标签：android, background-image, background-color, light

对于我的应用程序，我想要一个具有多种颜色的频闪灯来播放，我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:45:15.580

如果你想要不同的颜色等等，那么你可以`View`在你的 XML 中创建一个来占据整个屏幕宽度。然后根据`AlarmManager`您可以使用`setBackground()`的颜色使其成为您选择的颜色。

`Handler`使用 a而不是可能更有益`AlarmManager`，但是您可以同时查看两者以查看适合您的需求。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-08T19:52:49.300

如果您希望屏幕以不同的颜色闪烁，只需制作一个计时器并让主视图每隔一段时间更改一次背景颜色即可。

javax.swing.Timer 可用于每隔一段时间更改屏幕：

```
Timer colorChanger = new Timer(500 /*milis between each color change*/, new TimeListener(this) );
colorChanger.start(); 
```

where`TimeListener`将`ActionListener`改变指定活动的背景颜色。TimerListener 可能如下所示：

```
public class TimerListener implements ActionListener {
    public TimerListener(Activity activity) {
        this.backgroundToChange = activity;
    }
    private Activity backgroundToChange = null; // the activity who's background we will change
    private int numFrames = 0; //the number of frames that have passed
    public void actionPerformed(ActionEvent evt) { //happens when the timer will go off
        numFrames++;
        switch ( numFrames % 2 ) { // every other time it will make the background red or green
            case 0: backgroundToChange.getContentView().setBackgroundColor(Color.RED);
            case 1: backgroundToChange.getContentView().setBackgroundColor(Color.GREEN);
        }
    }
} 
```

您将需要导入 javax.swing.Timer 并且 ActionListener 和 ActionEvent 在 java.awt.event 中。

但是，如果您使用的是 android，则可能需要考虑使用除 Timer 之外的另一个专为 android 设计的类。Timer 专为摇摆而设计，如果您在 android 上使用它可能无法正常工作。任何其他类似类的计时器都将与 Timer 类似。

# javascript - 如何删除包含特定孩子的 li？

> ID：11871861
> 
> 赞同：1
> 
> 时间：2012-08-08T19:34:17.943
> 
> 标签：javascript, jquery

所以说我有：

```
<li>
    <span id="foo">bar</span>
</li>

<li>
    <span id="abc">123</span>
</li> 
```

我想用孩子“span id = foo”删除li。我如何用 Jquery 做到这一点？

我试过类似的东西：

```
$("li:has(span[id=foo])").remove(); 
```

似乎没有工作......有什么想法吗？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T19:35:14.027

选择孩子，而不是父母：

```
$('#foo').closest('li').remove(); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/n2wFa/)。

或者：

```
$('li:has(#foo)').remove(); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/n2wFa/1/)。

参考：

*   [`closest()`](http://api.jquery.com/closest/).
*   [`:has()`选择器](http://api.jquery.com/has-selector/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-08T19:36:00.993

试试这个：

```
$("li:has(span#foo)").remove(); 
```

**[演示](http://jsfiddle.net/KVMfB/1/)**

但似乎您的代码运行良好。**[看这里](http://jsfiddle.net/KVMfB/2/)**

# c - malloc 上的 sigsev 错误让我发疯

> ID：11871865
> 
> 赞同：7
> 
> 时间：2012-08-08T19:34:43.107
> 
> 标签：c, gdb, segmentation-fault, malloc

这段 C 代码在 gdb 中给出了分段错误

```
if ((seq_entry_action=malloc((seq_subphases)*sizeof(int*)))==NULL){
    printf("Cannot allocate memory for seq_entry_action\n");
} 
```

在哪里：

```
int **seq_entry_action=NULL;
unsigned int seq_subphases=0; 
```

在执行时，如果我在 gdb 中在这段代码之前添加一个断点（它只是另一个 printf() 语句），则值为

```
(gdb) p seq_subphases
$3 = 88
(gdb) p seq_entry_action
$4 = (int **) 0x0 
```

然后我按下一步，它在 malloc 处出现段错误

实在看不懂。。。。。。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T07:44:27.817

确实是这样……错误计算 sizeof() 的早期 malloc 是该 malloc 失败的原因。

# php - PHP - 如果控制器的名称是“类别”，那么方法就是这个控制器的值

> ID：11871866
> 
> 赞同：1
> 
> 时间：2012-08-08T19:34:51.797
> 
> 标签：php, model-view-controller

所以我有一个名为 Engine.php 的库，它的作用基本上是在运行

example.com/controller/method/value

所以例如，如果我有

example.com/category/images

它运行称为“图像”的方法。但我不想为每个类别添加代码。我希望该方法是一个变量（以便稍后我将使其与 db 一起使用）。

如何在不更改引擎的情况下实现这一目标？问题是 - 有些页面根本没有类别。而且我不想重写引擎本身。

我可以在控制器中以某种方式做到这一点吗？例如：

我正在输入名为“类别”的控制器，如果设置了方法，它会在控制器中搜索此方法（“类别”）。

这就是我的 Engine.php 的一部分：

```
 if (isset($url_output[1])) {
        if (isset($url_output[2])) {
            if (method_exists($controller,$url_output[1])) {
                $controller->{$url_output[1]}($url_output[2]);
            } else {
                $this->error();
            }
        } else {
            if (method_exists($controller,$url_output[1])) {
                $controller->{$url_output[1]}();
            } else {
                $this->error();
            }
        }
      } 
```

所以基本上，如您所见：

```
$controller->{$url_output[1]}(); 
```

$url_output[1] = 控制器中名为 $url_output[0] 的方法的名称。

我想要的是：

```
public function $category() {
echo $category
} 
```

你知道我的意思？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:49:45.207

你为什么不做这样的网址

```
example.com/category/index/images 
```

其中 index 是类别控制器的预定义函数，图像将作为第一个参数传递给 index 函数。

第二种选择，绕过 url 中的索引功能。

```
if (isset($url_output[1])) {
    if (method_exists($controller,'index')) {
        $controller->index($url_output[1]);
    } else {
        $this->error();
    }
}

class Category
{
    function index($category)
    {

    }
} 
```

像这样使用：example.com/category/images

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T19:51:48.723

您可以尝试使用[变量 variable](http://dk.php.net/manual/en/language.variables.variable.php)。
**警告**：从安全的角度来看，这是非常危险的，所以如果你这样做，你应该确保你验证你的输入！

```
if (isset($url_output[1])) {
    if (isset($url_output[2])) {
        if (method_exists($controller,$url_output[1])) {
            $controller->{$url_output[1]}($url_output[2]);
        } else {
            $this->error();
        }
    } else {
        if (array_search($allowed_categories, $url_output[1]) !== FALSE) {
            echo ${$url_output[1]};
        } else {
            $this->error();
        }
    }
  } 
```

基本上，如果`$url_output[1]`是`image`，则`${$url_output[1]}`转换为`$image`，然后输出`$image`变量的值。该`$allowed_categories`变量应该是一个包含您要处理的任何类别的数组。这是为了防止恶意用户进入某些会输出敏感变量的类别。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T20:11:52.757

您需要做的是为您的项目创建一个真正的路由机制。我已经在其他两个答案中介绍了它：[this](https://stackoverflow.com/a/11770908/727208)和[this](https://stackoverflow.com/a/9855170/727208)。其中一个我已经把你链接到了一次。

重点是创建正则表达式 (regexp) 对你可以匹配*传入*的URL。如果您找到匹配的模式，则使用拆分它`preg_match()`并分配一些默认值，如果 URL 的非强制性部分丢失。

您可以自己制作路由机制，也可以从其他项目（[简单](https://github.com/kohana/core/blob/3.2/master/classes/kohana/route.php)或[复杂](https://github.com/symfony/symfony/tree/master/src/Symfony/Component/Routing)）移植它。

此外，您应该将应用程序的路由部分与处理调度到控制器的部分分开。检查控制器中是否有这样的方法或者用户是否被允许访问它，不是路由过程的一部分。如果将它们混合在一起，您将违反[SRP](http://en.wikipedia.org/wiki/Single_responsibility_principle)。

# php - 从其中一个属性具有 $ 符号的对象中获取 php 变量

> ID：11871872
> 
> 赞同：3
> 
> 时间：2012-08-08T19:35:24.820
> 
> 标签：php, json, variables, object

所以我从 API 获取了一个 json 对象，然后 json 对其进行了解码......

但随后返回的对象如下：

```
stdClass Object
(
    [id] => stdClass Object
        (
            [$t] => some string
        )
) 
```

如您所见，有一个带有 $ 符号的属性

但是当我这样做时`$object->id->$t` <-- 会返回错误，因为它认为 $t 是一个变量

我将如何使用 $ 符号获取该变量？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T19:38:22.730

将其封装为单引号字符串：

```
echo $object->id->{'$t'}; 
```

请注意，不能使用双引号的原因与不能使用的原因相同`$object->id->$t`：PHP 将尝试进行插值`$t`。但是，如果您转义美元符号，则可以使用双引号：

```
echo $obj->id->{"\$t"}; 
```

[您可以在这个简单的演示](http://viper-7.com/96mrBI)中看到它的工作原理。

# file - Nginx：编码utf8字符的静态文件导致Ã

> ID：11871874
> 
> 赞同：3
> 
> 时间：2012-08-08T19:35:27.320
> 
> 标签：file, ubuntu, utf-8, nginx

我试图弄清楚为什么 nginx 会尝试使用错误的编码加载一些静态图像。例如：

从**error.log**：

> 2012/08/08 21:14:46 [错误] 17968#0: *71 open() "/home/www/mydomain.com/WEB-INF/images/productimage/image-Ã¸.png" 失败 (2 ：没有这样的文件或目录），客户端：xxxx，服务器：www.mydomain.com，请求：“GET /images/productimage/image-%C3%B8.png HTTP/1.1”，主机：“www.mydomain.com ", 推荐人: "http://www.mydomain.com/"

在我的 nginx.conf 文件中，我添加了以下内容；

```
source_charset utf-8;
charset utf-8; 
```

但不幸的是，这并没有解决它。

我的虚拟主机配置文件使用以下内容来提供图像文件；

```
 location /images/
    {
            alias /home/www/mydomain.com/WEB-INF/images/;
            expires 15d;
    } 
```

我正在使用 ubuntu，并设置了 LANG 环境变量；

```
export LANG=en_US.UTF-8
export LANGUAGE=en_US.UTF-8
export LC_ALL=en_US.UTF-8 
```

有什么线索吗？谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:46:02.427

URI 中的百分比编码实际上是两步编码，而不是一步。理想情况下，第一个文本被编码为 UTF-8，而 UTF-8 文本被“百分比编码”以在 URI 中使用，产生如下结果：

```
/images/productimage/image-%C3%B8.png 
```

您能否确认此 URI 已正确编码？如果你从你想要的字符开始，然后将其编码为 UTF-8，然后对其进行百分比编码，结果是 %C3%B8 吗？您可以像这样手动生成百分比编码的脚本：

```
 $perl -MCGI -e 'print CGI::escape("Hello World")."\n";'
 Hello%20World 
```

另一种说法：您确定问题出在Nginx的*解码上，而不是**编码*上吗？检查包含图像引用的 HTML 页面的编码。检查 HTTP 标头和元标记。确保它明确地将自己声明为 UTF-8。否则，这可能会导致浏览器误解引用。

您也可以手动测试解码过程，如下所示：

```
 perl -MCGI -e 'print CGI::unescape("/images/productimage/image-%C3%B8.png")."\n";'
 /images/productimage/image-ø.png 
```

如果有兴趣作为参考，我已经写了一篇[关于 Perl 百分比编码的详细文章。](http://mark.stosberg.com/blog/2010/12/percent-encoding-uris-in-perl.html)

# matlab - 尝试优化一些代码并使其更快

> ID：11871901
> 
> 赞同：-1
> 
> 时间：2012-08-08T19:37:15.337
> 
> 标签：matlab

我在matlab中有以下代码，非常慢。这段代码与我[之前](https://stackoverflow.com/questions/10863734/image-processing-algorithm-in-matlab)在堆栈溢出中的帖子有关我想知道是否有任何方法可以使matlab更快，当我运行代码时它应该显示我的数字，更新图像，但它没有显示任何东西

```
%% Loading Data
cd('D:\MatlabTest\15-07SpeedSensitivity\0.3');
clear all
row=101;
column=311;

%%
%Coefficients Creation
N=5;
W = [0.005 0.10;0.10 0.20;0.20 0.30;0.30 0.40;0.40 0.50;0.50 0.60 ;0.60 0.70;0.70 0.80 ;0.80 0.90;0.90 1.0];
for ind=1:9
    wn = W(ind,:);
    [b,a] = butter(N,wn);
    bCoeff{ind}=b;
    aCoeff{ind}=a;
end
[bCoeff{10},aCoeff{10}]=butter(N,0.9,'high');

%%
%filter initialization
ZState = cell(1,10);
for i=1:10
    ZState{i} = zeros(max(length(aCoeff{i}), length(aCoeff{i})) - 1, 1); %# This is the initial filter state
end
%%
bands=10;
for b=1:bands
    Yout{b}{row, column}=[];
end

%%
j=1;
K = 1000:4000;
window = zeros(1,10);
figure;
y = 0;         %# Preallocate memory for output
j=0;
buffSize=10;
tempMean{row,column}=[];
Gibbs=(length(K)*3)/100;
fImg{1}(row,column)=0;
%load one image
for i = 1000:length(K)
    disp(i)
    str = int2str(i);
    str1 = strcat(str,'.mat');
    load(str1);
    D(:,:) = A(100:200 ,200:510);
    %go throught the columns and rows
    for p = 1:row
        for q = 1:column
            %calculte the temporal mean value based on previous ones
            if(size(tempMean{p,q})<buffSize) %init the first 10
                tempMean{p,q}=[D(p,q) tempMean{p,q}];
            else
                tempMean{p,q}=[D(p,q) tempMean{p,q}(1:end-1)];
            end
            if(mean2(tempMean{p,q})==0)
                x=0;
            else
                x = double(D(p,q)/mean2(tempMean{p,q}));
            end
            %filtering for 10 bands, based on the previous state
            for f = 1:10
                [y, ZState{f}] = filter(bCoeff{f},aCoeff{f},x,ZState{f});
                if(j<Gibbs)
                    continue;
                end
                if(size(Yout{f}{p,q})<10)%init the first 10 after Gibbs phenomenon
                    Yout{f}{p,q} = [y.^2 Yout{f}{p,q}];
                else
                    Yout{f}{p,q} = [y.^2 Yout{f}{p,q}(1:end-1)];
                    fImg{f}(p,q)=mean2(Yout{f}{p,q});
                end
            end
        end
    end
     if(size(fImg{1}(1,1))>1)   
    for k = 1:10
        subplot(5,2,1);
        subimage(fImg{k}*5000, [0 0.5]);
        colormap jet
    end
    pause(0.01);
     end
    j=j+1;
end
disp('Done Loading...')` 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T04:59:04.690

好吧，我没有`1000.mat`, `1001.mat`, ..., `4000.mat`，所以我无法真正正确地测试它。

不管怎样，我可以随便告诉你的是

*   嵌套循环通常是一个坏主意。将大部分精力放在防止您拥有的四重嵌套循环上

*   大多数循环体都包含对外部非内置函数（`means2`、、`int2str`...）的引用。这意味着无法应用 JIT 编译，并且`for`-loop 以解释器速度运行。

*   每个最内层迭代的内容`Yout`和大小都会改变。`fImg`应该避免改变大小或至少保持非常小的循环。

调整变量大小的意思是，Matlab需要创建一个更大的临时变量，将原始数组的内容复制到临时变量中，将新数据附加到其中，将临时变量分配给原始变量，然后清理混乱。正如您所理解的，所有这些毫无意义的复制都需要大量时间，而您必须多次（您确实这样做），所以：努力*预分配整个数组*。

除此之外，我们不能没有这些`mat`文件。正如@slayton 所建议的，学习使用 Matlab[分析器](http://www.mathworks.nl/help/techdoc/matlab_env/f9-17018.html)。我强调的要点可能会跳出来（数据的加载也会跳出来，但是这无法改进（除非*所有*数据文件都适合您的记忆？））

# jquery - Firefox 中的 jQuery 从右向左滑动中断

> ID：11871903
> 
> 赞同：1
> 
> 时间：2012-08-08T19:37:16.503
> 
> 标签：jquery, jquery-ui, coffeescript

我希望我的内容从窗口的右侧滑到左侧。内容 div 以自动边距为中心。在 Chrome 和 Safari 中一切正常，但在 Firefox 中，幻灯片从中间开始，向左移动，然后跳回中间。已搜索但似乎没有其他人遇到此问题，也许是我的 CSS 有问题？

```
# JavaScript
$('[data-pjax-container]').show("slide", { direction: "right" }, 1000);  

#Css
#content { width: 1200px; margin: 0 auto; padding-top: 30px; } 
```

编辑，jsfiddle：http: [//jsfiddle.net/VBgkT/](http://jsfiddle.net/VBgkT/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T21:09:15.913

这是导致问题的自动边距。您可以计算脚本中的边距（对不起，我不知道 coffeescript 的语法，所以这是我在 javascript 中的做法）：

```
var x = $(window).width() - $("#content").width();

$("#content").css("margin-left", x/2);
$("#content").css("margin-right", x/2);

$('.click').click(function () {
    $('#content').hide('slide', { direction: 'left' }, 1000)
    $('#content').show('slide', { direction: 'right' }, 1000)
}); 
```

小提琴：http: [//jsfiddle.net/VBgkT/20/](http://jsfiddle.net/VBgkT/20/)

# javascript - 非常轻的选择器引擎

> ID：11871904
> 
> 赞同：-1
> 
> 时间：2012-08-08T19:37:26.603
> 
> 标签：javascript, dom

我想要一个选择器引擎，功能不多，非常小。

我只需要通过标签、id 和类来识别——并且能够嵌套这些东西......

```
// select info paragraph within content area
#content p.info

// change headings above size h3
h1, h2, h3 
```

我不需要检查标记是否作为匹配正则表达式模式或类似内容的属性。我只想在格式良好的 HTML 上使用快速选择方法。

我只能在网上找到功能齐全的库，它们的大小都在 3K 左右——我觉得这对于一份小工作来说太过分了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:40:00.203

我看不出本机 javascript 有什么问题？

```
document.getByElementId(...);
document.getElementsByClassName(...);
document.getElementsByTagName(...); 
```

甚至这个（可以在所有现代浏览器[包括 IE8+] 中使用）：

```
document.querySelectorAll(...);
document.querySelector(...); 
```

# c# - MOQ 使用不同的 EventArgs 多次引发事件

> ID：11871906
> 
> 赞同：2
> 
> 时间：2012-08-08T19:37:37.503
> 
> 标签：c#, unit-testing, windows-phone-7, moq

我正在尝试测试一个异步进程，其中向具有不同值的服务发出多个请求，这会导致引发多个完成事件。

该应用程序是 WP7 应用程序，其中包含 WP7 类库项目中的代码和测试，所有其他测试（带有模拟）都可以正常工作，只有这个测试我无法开始工作。

测试是：

```
 [Test]
    public void Should_referesh_all_stocks_held_in_collection()
    {
        var fakeStockService = new Mock<IStockService>();
        var msftStock = new StockViewModel { Symbol = "MSFT", Name = "Microsoft", Price = 12.5m, Change = "+1" };

        var googStock = new StockViewModel { Symbol = "GOOG", Name = "Google", Price = 12.0m, Change = "-1" };

        var target = new StockSummaryViewModel(fakeStockService.Object);

        target.Stocks.Add(msftStock);
        target.Stocks.Add(googStock);

        fakeStockService.Setup(s => s.GetStock("MSFT"))
            .Raises(s => s.StockQuoteReceived += null, new StockQuoteEventArgs(new QuoteReceived { Symbol = "MSFT", Name = "Microsoft Corp", Last = "13.5", Change = "+1" }));

        fakeStockService.Setup(s => s.GetStock("GOOG"))
            .Raises(s => s.StockQuoteReceived += null, new StockQuoteEventArgs(new QuoteReceived { Symbol = "GOOG", Name = "Google", Last = "11.5", Change = "-0.5" }));

        target.Refresh();

        Assert.AreEqual(2, target.Stocks.Count);
        var stock = target.Stocks.Single(s => s.Symbol == "MSFT");

        Assert.IsTrue(stock.Change == "+1" && stock.Price == 13.5m);

        stock = target.Stocks.Single(s => s.Symbol == "GOOG");
        Assert.IsTrue(stock.Change == "-0.5" && stock.Price == 11.5m);
    } 
```

测试失败，因为没有触发第二个事件，而是第一个 raise 触发了两次。

我错过了什么？

# internationalization - 狂欢商务添加第二语言

> ID：11871912
> 
> 赞同：0
> 
> 时间：2012-08-08T19:38:00.050
> 
> 标签：internationalization, e-commerce, locale, spree

我需要在我的狂欢项目中添加对西班牙语的支持。尝试了各种方法，URL 方式不适合我（不想要）， globalizer3 并没有真正做我想要的。其他一些扩展不起作用，一些会杀死网站等。

所以我添加了

```
gem 'spree_i18n', :git => 'git://github.com/spree/spree_i18n.git'
gem 'globalize3' 
```

到我的gemfile，而全球化器很可能会被划伤（不做我想要的）。

我在“spree_users”中添加了一个“def_lang”列来存储语言环境，这是由用户注册时的下拉框设置的。可用的是“en”和“es”。

我在过去 14 小时内找到的代码和重复建议是这样的：

将以下代码添加到 application_controller.rb （或根据其他人的 base_controller.rb ）

```
before_filter :set_locale

protected
 def set_locale
 I18n.locale = params[:locale] || I18n.default_locale
end 
```

我的情况应该是

```
before_filter :set_locale

 protected #<-this is not in all tips
  def set_locale
  I18n.locale = params[:def_lang] || I18n.default_locale
end 
```

简而言之，它不起作用。可以通过在“application.rb”中设置来证明对西班牙语的语言支持

```
config.i18n.default_locale = :es 
```

该网站已翻译。

为什么它不起作用？如何使它工作？还有什么我可以用来让第二语言在每个用户的基础上工作的吗？

请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T05:12:54.010

`params[:def_lang]`仅适用于注册请求，不适用于后续请求。您可能希望使用`current_user && current_user.locale`它而不是检查`params[:def_lang]`

# java - 在java中写入文本文件的相对路径

> ID：11871913
> 
> 赞同：0
> 
> 时间：2012-08-08T19:38:00.750
> 
> 标签：java

我正在处理这个项目，并且正在访问我放在资源文件夹中的大量文本文件。我在编写这些文件的相对路径时遇到了很多麻烦。在命令行中，我从包含带有 main 方法的 java 文件的目录到我想要的文本文件，其中包含“cd ../../../../../../../resources/信息/ConfluneceTotalLists/table.txt”。我尝试在 main 方法中使用它来获取文件，但它不起作用。我怎样才能解决这个问题？另外，当一个java程序运行时，当前目录是包含main方法的java文件的目录吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:40:10.660

采用：

```
System.out.println(System.getProperty("user.dir"))); 
```

找出运行 Java 程序的目录。然后使用此位置的相对路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T19:40:26.647

当 java 程序运行时，它会继承启动它的程序的工作目录。这与主类的Java源文件或类文件无关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T19:43:17.857

`cd`是一个 unix shell 命令，在 java 中打开文件时指定完整路径（相对或绝对）就足够了。至于当前目录，通常是您运行程序的目录。如果您使用的是 IDE，它通常是主项目文件夹。

# makefile - 抑制和忽略 Makefile 的输出？

> ID：11871921
> 
> 赞同：51
> 
> 时间：2012-08-08T19:38:57.753
> 
> 标签：makefile, gnu-make

我知道`@`前缀会抑制 Makefiles 中 shell 命令的输出，并且`-`前缀会忽略 shell 命令中的错误。有没有办法将两者结合起来，即抑制输出并忽略错误的前缀？我不认为`@-`或`-@`工作。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-08-08T19:49:53.907

实际上，`@-`两者`-@`都可以工作，但会打印`make: [target] Error 1 (ignored)`警告。

相反，您可以使用

```
@command || true 
```

或者，因为`:`是`true`in shell 的简写，

```
@command ||: 
```

这通常是一件更好的事情，因为它避免了 Make 的令人困惑的警告，即在不可见的命令中忽略了错误。

考虑两种最常见的情况，您可能希望忽略命令的返回值：

1.  部分构建已损坏，您仍想继续，在这种情况下，[您需要学习一些东西](http://www.amazon.ca/dp/0321717287)。构建已损坏，需要修复，而不是以无法维护的方式进行捆绑。
2.  一个命令返回一个非零的退出代码，即使它完全按照您的意愿执行，在这种情况下，您并不真的希望 Make 发出警告。

对于第二种情况，请考虑在命令生成的日志文件中对警告进行 grepping 的示例。`grep`如果找不到匹配项，将返回错误，这不是您想要的：

```
.PHONY: all one two three

all: at-warning at-success or-success or-warning

at-%: %.log
    @echo Making $@
    @-grep ^Warning $<

or-%: %.log
    @echo Making $@
    @grep ^Warning $< ||:

success.log:
    echo 'Success!' > $@

warning.log:
    echo 'Warning: foo' > $@

clean::
    rm -f {success,warning.log} 
```

产生：

```
echo 'Warning: foo' > warning.log
Making at-warning
Warning: foo
Making at-success
make: [at-success] Error 1 (ignored)
Making or-success
Making or-warning
Warning: foo 
```

使用`@-`成功时会产生无意义的忽略错误警告，同时`|| true`处理警告和没有警告而没有抱怨。

理论上 using`|| true`比 using 慢`@-`，但这种开销不太可能成为精心设计和维护的构建系统的瓶颈。绝大多数时间应该花在构建，或者在没有构建的时候检查时间戳，而不是运行成千上万的快速命令，这些命令的返回值都被忽略，这对于产生可衡量的性能影响是必要的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-08T20:33:06.807

GNU make 确实允许您将两者结合`@`起来`-`：

```
all:
        @-exit 1 
```

使用 gmake 3.81 运行它会产生以下输出：

> gmake：[全部]错误1（忽略）

如您所见，该命令未回显，并且按预期忽略错误。

# android - 如何从内部存储的特定文件夹中获取文件列表？

> ID：11871925
> 
> 赞同：8
> 
> 时间：2012-08-08T19:39:18.843
> 
> 标签：android, file

有了`listFiles()`我可以在 `/data/data/package/files`.
如何从目录中获取文件列表 `/data/data/package/myfolder`？

谢谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-08T19:45:30.317

您的应用程序有一个“文件”和“缓存”目录。您可以使用 Context.getFilesDir() 或 Context.getCacheDir() 查询此路径。

还有一个 Context.getDir() 函数用于私人文件夹，如“myfolder”。

使用相应的 File 对象，您可以枚举文件。

```
File dirFiles = mContext.getFilesDir();
for (String strFile : dirFiles.list())
{
 // strFile is the file name
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-08-08T20:10:28.520

以上都不是准确的，也不是真正有效的，但它有助于得到答案，谢谢。
我的问题的答案是：

```
File mydir = context.getDir("myfolder", Context.MODE_PRIVATE);              
File lister = mydir.getAbsoluteFile();
for (String list : lister.list())
{
   //       
} 
```

# arrays - 索引超出范围

> ID：11871926
> 
> 赞同：-1
> 
> 时间：2012-08-08T19:39:20.390
> 
> 标签：arrays, vb.net

我在 VB.NET 中有以下代码：

```
Public Sub New()
    config = ""

    Dim args() As String = System.Environment.GetCommandLineArgs()
    If args.Count > 1 Then
        config = args(1)
    End If
End Sub 
```

当它遇到 config = args(1) 时，我总是会收到错误，说索引超出范围。

我不知道如何解决这个问题，或者当我已经进行计数检查时为什么这甚至是一个问题！我已经调试过了，它确实抓取了命令行参数，所以这不是问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:43:13.053

`Length`您可以使用以下属性获取数组的长度：

```
If args.Length > 1 Then 
```

无论如何，我测试了你的代码，它也可以使用`Count`。我没有得到你提到的例外。

# licensing - MonoDroid 和为您的应用添加许可

> ID：11871939
> 
> 赞同：1
> 
> 时间：2012-08-08T19:40:09.820
> 
> 标签：licensing, xamarin.android, xamarin

我正在尝试将许可添加到我的应用程序中，并找到了这篇文章：-

[http://developer.android.com/guide/google/play/licensing/adding-licensing.html](http://developer.android.com/guide/google/play/licensing/adding-licensing.html)

是否有使用 MonoDroid 执行此操作的教程、示例等？xamarin网站上没有提及？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T06:50:13.470

**新的**

此库已移至： [https ://github.com/xamarin/XamarinComponents/tree/master/Android/GoogleAndroidVending](https://github.com/xamarin/XamarinComponents/tree/master/Android/GoogleAndroidVending)

它也不再是 C# 端口，而是 SDK 管理器的官方版本。

这些文档有点旧，但我涵盖了所有内容：

*   [https://dotnetdevaddict.co.za/2014/12/19/play-licensing-in-xamarin-android/](https://dotnetdevaddict.co.za/2014/12/19/play-licensing-in-xamarin-android/)
*   [https://dotnetdevaddict.co.za/2014/12/21/downloading-expansion-files-in-xamarin-android/](https://dotnetdevaddict.co.za/2014/12/21/downloading-expansion-files-in-xamarin-android/)

**原来的**

我已经创建了许可库的 C# 版本。我目前在 Play 上的一个应用程序中使用它。看看我的回购：

[Android.Play.ExpansionLibrary](https://github.com/mattleibow/Android.Play.ExpansionLibrary)

它有几个示例，包括一个简单的许可示例和一个扩展文件示例。让我知道事情的后续。

我知道 Xamarin 的一个人现在正在编写教程，但也许您可以早点提出请求。

# qt - Backbone.js 应该与 533.3 版 Qt WebKit 浏览器一起使用吗？

> ID：11871941
> 
> 赞同：0
> 
> 时间：2012-08-08T19:40:15.647
> 
> 标签：qt, backbone.js, webkit, qtwebkit

我有一个基于 Backbone、Underscore 和 jQuery 的网站。它在 Qt 4.8.1 的 Qt WebKit 浏览器版本 537.1 中运行良好（使用 Qt Creator 作为独立版本构建）。但是在版本 533.3（这是 Maya 2013 附带的）中，Backbone 模型的`parse`函数永远不会在`fetch`.

我从`alert(jQuery.browser.version)`. 我无法在浏览器中进行 Javascript 调试，因为它是我正在开发的 Maya 插件的一部分。所以我不能很好地确定这里发生了什么。

所以我的问题是，我应该期望这不会根据我的浏览器版本工作，还是应该寻找其他一些不兼容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T20:35:14.443

我有这个代码：

```
app.arrCollection.fetch();
app.arrWorkflowModel.fetch();
app.arrMetafieldsModel.fetch(); 
```

arrCollection.fetch 正在工作。arrWorkflowModel.fetch 失败，但没有停止浏览器。arrMetafieldsModel.fetch 失败，并停止浏览器。在我尝试的 QWebView 的更高版本中没有发生这种停止。

由于这些东西是异步的，第三个失败是在第一次 fetch 可以返回任何东西之前停止浏览器。

# c++ - 访问私人会员数据和功能

> ID：11871944
> 
> 赞同：-2
> 
> 时间：2012-08-08T19:40:25.763
> 
> 标签：c++, oop, constructor

对于即将到来的决赛，我有一个简短的问题。私有成员数据和函数是否只能由构造函数访问？

回答和详细说明表示赞赏。

这是促使我来找你们的问题和答案：

**编辑：**

> 5) 能够确定语句何时是访问私有成员变量或函数的无效尝试。- 这是一个赠品，私有函数和变量只能在构造函数中访问。

所以这是错的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:59:11.313

是的，这是完全错误的。

根据标准（ISO/IEC 14882:2003 (E), §11.0/1）：

> 一个类的成员可以是
>     - 私有的；也就是说，它的名称只能被声明它的类的成员和朋友使用。

它说*成员*，而不是*构造函数*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T19:50:45.627

任何类方法都可以访问类的私有成员。需要考虑的一点是静态成员函数，它没有`this`指针，只能访问静态成员变量。Friend 函数和 Friend 类也能够访问类的私有成员变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T19:42:21.033

您可以从类内部的任何位置访问私有成员，但不能从其他类或其他子类访问。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T19:42:24.950

不，它们可以从对象内的任何地方访问，只是不能从外部访问。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-08T19:45:39.103

您可以在对象本身内部访问它们，而不仅仅是构造函数。

而且你应该有 get 和 set 方法来从对象外部获取或设置它，以防你想知道如何做到这一点。

# asp.net - mySQL 获得最高 ID 奇数结果

> ID：11871949
> 
> 赞同：0
> 
> 时间：2012-08-08T19:40:36.643
> 
> 标签：asp.net, mysql, vb.net

嘿，当我尝试在表中查找最高 ID 号时，我在 VB.net 中得到了一个奇怪的返回值：

这是我的 VB.net 代码：

```
 objConn = New MySqlConnection(product.strConnString)
    objConn.Open()

    strSQL = "SELECT MAX(id) FROM product;"

    Try
        objCmd = New MySqlCommand(strSQL, objConn)
        dtReader = objCmd.ExecuteReader()

        While dtReader.Read()
            nextDBID = dtReader(0)
        End While

        objConn.Close()
        objConn = Nothing
    Catch ex As Exception
        MsgBox("LoadProduct: " & ex.Message)
    End Try 
```

当我检查**nextDBID**的值时，它显示为**39**。但是，数据库中没有39！

当我在 mySQL GUI 中运行该确切查询时，我得到以下信息：

```
select MAX(id) from fivestar_range.product;

37 
```

我的 id 数据字段在产品表中是这样的：

```
37
10
11
12
7
8
6
5
4
3
2
1
13
14
36
21 
```

我什至尝试使用这个查询：

```
SELECT id FROM product ORDER BY ID DESC LIMIT 1; 
```

我在 VB.net 中仍然是**39** ，但在 mySQL GUI 中仍然是**37 。**

我忽略了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T19:41:56.990

检查您的连接字符串。您可能正在查看两个不同的数据库。

# javascript - 通过chrome中的javascript书签调用emacs org-protocol

> ID：11871950
> 
> 赞同：0
> 
> 时间：2012-08-08T19:40:37.220
> 
> 标签：javascript, bash, emacs, bookmarklet, org-mode

**设置**

Cygwin Emacs，我有一个*部分*工作设置`org-protocol`。org-protocol 是一种从浏览器捕获信息并将其传递给 Emacs 的方法。我使用 Windows 7 注册表修改来添加`org-protocol`到已知协议列表中，并使 cygwin`bash`能够启动`emacsclient`以处理这些请求。部分工作意味着书签和 emacs 加载操作成功，除了下面的问题案例。

**问题**

我在页面上选择有趣的文本，并调用小书签，但是单独使用某些字符`encodeURIComponent`（即括号和单引号）无法正确转义。这会造成严重破坏，导致 bash 解析错误。我不知道单独使用 bash 来处理这个潜在的引用问题的方法，所以我想修改书签，以替换任何有问题的字符。

下面的代码在 Chrome 的 JS 控制台中调用时**有效**，但在作为书签调用时无效**。**我还尝试`(function(){...})()`用相同的失败结果的语法重做它。

我有什么解决方案（bash、bookmarklet、其他？）？

**书签代码**

```
javascript:location.href='org-protocol://capture://'+encodeURIComponent(location.href)+'/'+encodeURIComponent(document.title)+'/'+encodeURIComponent(window.getSelection()).replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29") 
```

**注册表模组**

另外，这里是命令行调用——以防我的引用方案出现问题。

```
REGEDIT4

[HKEY_CLASSES_ROOT\org-protocol]
@="URL:Org Protocol"
"URL Protocol"=""
[HKEY_CLASSES_ROOT\org-protocol\shell]
[HKEY_CLASSES_ROOT\org-protocol\shell\open]
[HKEY_CLASSES_ROOT\org-protocol\shell\open\command]
@="\"cmd.exe\" \"/k\" \"C:\\cygwin\\bin\\bash.exe\" \"--login\" \"-c\" \"DISPLAY=:0 /usr/local/bin/emacsclient -c %1\"" 
```

# c - 动态 2D 数组 - 分配不起作用（段错误）

> ID：11871951
> 
> 赞同：0
> 
> 时间：2012-08-08T19:40:37.977
> 
> 标签：c, arrays, pointers, 2d, dynamic-allocation

为什么这行不通？我已经多次查看我的代码，但找不到问题所在。

谢谢！

```
void generateData(float** inData, int x, int y){
    inData[0][0]= 3000.0; // SEGFAULT
}

float** createMatrix(int x, int y){
    float** array= malloc(sizeof(float*) * y);
    for(int i=0; i<y; i++)
        array[i] = malloc(sizeof(float) * x);
}

int main(int argc, char** argv) {
    float** arr = createMatrix(100,2);

    generateData(arr, 100, 2);

    return(0);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T19:42:30.160

你忘记了这条非常重要的线；

```
return array; 
```

在`createMatrix`. 查看您的编译器警告，或者如果您还没有打开它们，请打开它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T19:44:24.957

不确定此代码段是否与您的代码直接相关，但您从未从 createMatrix() 返回地址。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-09T02:27:46.517

`return array;`是您代码中的一个问题。除此之外还有一个大问题。

`float** array= malloc(sizeof(float*) * y);`- 您首先为数组分配内存以存储指针数组（浮动）。然后你为每一行分配内存`malloc(sizeof(float) * x);`

现在您已经为 2 行和 100 列分配了内存。然后调用`generateData(arr, 100, 2);`。如果`generateData`你这样做`inData[100][2]`会导致崩溃。因为您只分配了 2 行，每行有 100 个元素。`inData[100][2]`相当于`*( *(inData + 100) + 2)`。这`*(inData + 100)`将导致崩溃（未定义的行为）。因为您假设只能访问索引`1`not `100`。

错误在于`createMatrix`功能，您错误地使用了`x`and `y`。像下面这样重写你的函数。

```
float** createMatrix(int x, int y)
{
    int i;
    float** array= (float **)malloc(sizeof(float*) * x);
    for(int i=0; i<x; i++)
    {
        array[i] = (float *)malloc(sizeof(float) * y);
    }
    return array;
} 
```

并且还如下重写你`generateData`的。

```
void generateData(float** inData, int x, int y)
{
    x--;
    y--;    
    inData[i][j]= 3000.0; //Do you assignment to array here
} 
```

# java - 解析 XML 并填充到 Map

> ID：11871952
> 
> 赞同：0
> 
> 时间：2012-08-08T19:40:43.850
> 
> 标签：java, xml, xml-parsing

我有如下的xml。

```
<Employees>
      <Employee id="1">Chuck</Employee>
      <Employee id="2">Al</Employee>
      <Employee id="3">Kiran</Employee>
</Employees> 
```

XML 包含大量员工。我只是为了简化而提到的。

解析此 xml 并填充到地图中的最佳方法是什么？地图应该包含 id 和 name 对。

请提供代码以便更好地理解。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-09T19:11:52.010

XStream的[答案](https://stackoverflow.com/a/11886299/383861)似乎有很多代码。您可以使用 JDK/JRE 中的 StAX API 执行以下操作：

```
package forum11871952;

import java.io.FileReader;
import java.util.*;
import javax.xml.stream.*;

public class Demo {

    public static void main(String[] args) throws Exception {
        XMLInputFactory xif = XMLInputFactory.newFactory();
        XMLStreamReader xsr = xif.createXMLStreamReader(new FileReader("src/forum11871952/input.xml"));
        xsr.nextTag(); // advance to Employees tag
        xsr.nextTag(); // advance to first Employer element
        Map<String,String> map = new HashMap<String,String>();
        while(xsr.getLocalName().equals("Employee")) {
            map.put(xsr.getAttributeValue("", "id"), xsr.getElementText());
            xsr.nextTag(); // advance to next Employer element
        }
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T19:43:14.723

使用诸如 XStream 之类的库。`List<Employee>`比`Map`这里更适合。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-09T15:01:17.057

我们可以使用 Xstream 简单地映射它。

```
XStream xStream = new XStream(new DomDriver());
xStream.alias("Employees", Employees.class);
xStream.registerConverter(new MapEntryConverter());
employeesMap = (Map<String, String>) xStream.fromXML(queryXML); 
```

创建一个将 XML 解组为 Map 对象的转换器

```
private static class MapEntryConverter implements Converter {
        public boolean canConvert(Class clazz) {
            return clazz.equals(Employees.class);
        }

        public void marshal(Object value, HierarchicalStreamWriter writer, MarshallingContext context) {
            AbstractMap<String, String> map = (AbstractMap<String, String>) value;
            for (Map.Entry<String, String> entry : map.entrySet()) {
                writer.startNode(entry.getKey().toString());
                writer.setValue(entry.getValue().toString());
                writer.endNode();
            }
        }

        public Object unmarshal(HierarchicalStreamReader reader, UnmarshallingContext context) {
            Map<String, String> map = new HashMap<String, String>();

            while (reader.hasMoreChildren()) {
                reader.moveDown();
                map.put(reader.getAttribute(1), reader.getValue());
                reader.moveUp();
            }
            return map;
        }
    } 
```

如下创建员工和员工类。

```
private class Employees{
        List<Employee> employees;
    }
    private class Employee{
        private String id;
        private String value;
} 
```

希望这对你有用。

# maven - 如何使用 maven 进行 websphere 7 部署自动化？

> ID：11871962
> 
> 赞同：6
> 
> 时间：2012-08-08T19:41:10.960
> 
> 标签：maven, deployment, websphere, websphere-7

大家
好，我们的 Maven 脚本目前是为了在 tomcat6（开发）服务器中编译/打包和部署而编写的。这有助于我们自动化构建-部署过程。

展望未来，我们希望使用 MAVEN脚本**自动部署到 WAS7 (Websphere 7) 服务器。**我读过的几篇文章谈到了调用可以执行部署到 websphere 的 ANT 任务。

任何人都可以共享相同的 Maven 脚本/标签吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-09T07:53:38.530

我不知道这是否适用于 WAS 7，但 IBM 为 WAS 6 和 Maven 集成提供支持：

*   [http://sdudzin.blogspot.fr/2007/09/maven-2-and-websphere-automated-build.html](http://sdudzin.blogspot.fr/2007/09/maven-2-and-websphere-automated-build.html)
*   [https://www.ibm.com/developerworks/wikis/download/attachments/113607155/RAD_755_MAVEN_0601.pdf?version=1](https://www.ibm.com/developerworks/wikis/download/attachments/113607155/RAD_755_MAVEN_0601.pdf?version=1)
*   [RAD7.5 的 Maven 集成以及自动 Websphere 兼容的 EAR 创建](https://stackoverflow.com/questions/4972880/maven-integration-for-rad7-5-along-with-automatic-websphere-compatible-ear-creat)
*   [http://www.ibm.com/developerworks/forums/thread.jspa?messageID=14486753](http://www.ibm.com/developerworks/forums/thread.jspa?messageID=14486753)

一家（著名的）法国 IT 咨询公司列出了与著名的**Cargo 插件**的兼容性，该插件允许远程控制服务器：[http](http://blog.xebia.fr/2008/11/05/lintegration-continue-avec-cargo/) ://blog.xebia.fr/2008/11/05/lintegration-continue-avec-cargo/ 。但是正如您所看到的（即使您不懂法语；D），Websphere 并没有得到很好的支持。

它可能对您没有帮助，但主要思想是 Maven 和 WAS 7 集成对您来说可能比其他服务器更痛苦；）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-06T19:13:15.640

你可以使用这个插件 [http://code.google.com/p/websphere-maven-plugin/](http://code.google.com/p/websphere-maven-plugin/)

```
<plugin>
 <groupId>Websphere7AM.plugin</groupId>
 <artifactId>websphere7am-maven-plugin</artifactId>
 <version>1.0.0</version>
 <configuration>
  <defaultCommand>
  <host>localhost</host>
  <port>8880</port>
 </defaultCommand>
 <commands>
  <command>
   <command>INSTALL</command>
   <appName>My Application</appName>
   <earFile>myapp.ear</earFile>
   <target>WebSphere:cell=myhostNode01Cell,node=myhostNode01,server=server1</target>
   <description>Install my app</description>
  </command>
 </commands>
</configuration>
<executions>
 <execution>
 <phase>compile</phase>
 <goals>
  <goal>was</goal>
 </goals>
 </execution>
</executions>
</plugin> 
```

# c - 静态结构变量段错误

> ID：11871963
> 
> 赞同：0
> 
> 时间：2012-08-08T19:41:21.140
> 
> 标签：c, pointers, memcpy

我有一个这样分配的结构：

```
static struct cparray_buffer_t *_cparray;

struct __attribute__ ((__packed__)) cparray_buffer_t 
{
    u_int64_t buflen;
    u_char buf[buffersize];
}

.
.
.
_cparray = (struct cparray_buffer_t *)calloc(1024, sizeof(struct cparray_buffer_t); 
```

后来在程序中，我尝试像这样做一个 memcpy

```
memcpy(_cparray[0].buf, test, buffersize); 
```

我得到一个 sigsegv

我在 memcpy 中正确地引用了吗？

编辑：在 gdb 中，当实际使用数组时，_cparray 的地址似乎是 0x0。我试图在 _cparray 上放置一个数据观察点，但没有看到任何释放它的东西。有趣的是，如果我看一下 &_cparray 它仍然有一个有效的地址，但是 *&_cparray 是 0x0

edit2：不知道是否有区别，但是calloc在thread1中，而segfault在thread2中发生。我的印象是全局静态对所有线程都是可见的。这个对吗？

谢谢

到底是怎么回事？

这是 _cparray 上的观察点的输出

```
Old value = (struct cparray_buffer_t *) 0x284ba000
New value = (struct cparray_buffer_t *) 0x0
0x28102c83 in sem_init () from /lib/libc.so.7 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T03:08:48.367

全局变量在所有线程中都是可见的，无论是否是静态的。static 关键字只是给出变量文件范围，以便它只在文件中可见。由于它仅在文件中可见，因此使用该变量的代码必须在定义它的文件中。

我看到的一个问题是人们将静态变量放入头文件中，期望该变量对多个文件可见。结果是静态变量在每个包含头文件的文件中重复，导致静态变量的几个不同实例在各个文件之间没有共享，因为它们是不同的内存位置。

由于这是一个多线程应用程序，其中一个线程创建内存区域，第二个线程使用内存区域，您可能会遇到竞争条件，即第二个线程在第一个线程分配内存区域之前正在访问它。

例如，我首先将指针初始化为已知值

```
static struct cparray_buffer_t *_cparray = 0; 
```

然后，在第二个线程中，您可以测试变量是否具有一个检查 0 的地址，如果它为零，则休眠并重试，直到它变为非零，这意味着第一个线程已分配内存。首选方法是让第一个线程分配内存，然后启动第二个线程以使用内存。或者，您可以使用其他线程同步，只要第二个线程等到第一个线程在尝试使用指针之前分配内存。

假设 test 是某种类型的指针，例如数组，那么 memcpy() 函数调用看起来是正确的。我假设代码看起来像：

```
u_char test[buffersize];
// do some things involving test

// save the things put into test
memcpy (_cparray[0].buf, test, buffersize); 
```

# jquery - jQuery replaceWith 有效，但 prepend 无效？

> ID：11871964
> 
> 赞同：0
> 
> 时间：2012-08-08T19:41:21.747
> 
> 标签：jquery

错误线是这样的：

```
contxt.replaceWith(safe_copy[id]).prepend("<span class='error'>"+jsonObj.data+"</span>"); 
```

虽然该`replaceWith`语句工作得很好，但数据没有得到“ `prepended`”。

更完整的代码：

```
contxt = $(this).parents('div[style^="display"]');
id = $(this).attr('id');

        $.ajax({
                url: "/submit/myposts",
                type: "POST",
                data: "action=edit&post="+$(this).attr('id').match(/[0-9]+/)[0]+"&data="+encodeURIComponent(text),
                success: function(data){
                    loading.remove();
                    jsonObj = $.parseJSON(data);

                    if(jsonObj.code == "0")
                        block.html(jsonObj.data);
                    else
                        contxt.replaceWith(safe_copy[id]).prepend("<span class='error'>"+jsonObj.data+"</span>");
                },
                error: function(){
                    loading.remove();
                    contxt.replaceWith(safe_copy[id]).prepend("<span class='error'>An error occurred. Please try again.</span>");
                }
            }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:47:15.857

`.replaceWith()`返回原始 jQuery 对象（从页面中删除的对象），因此当您链接到它时，它将对已删除的内容进行操作，而不是添加的内容。

来自jQuery[文档](http://api.jquery.com/replaceWith/)：`.replaceWith()`

> .replaceWith() 方法，像大多数 jQuery 方法一样，返回 jQuery 对象，以便其他方法可以链接到它。但是，必须注意返回的是原始的 jQuery 对象。此对象指的是已从 DOM 中删除的元素，而不是替换它的新元素。

我不完全确定我理解您的代码/HTML，但这可能是一种可能的解决方法：

```
var newContent = $(safe_copy[id]).prepend("<span class='error'>"+jsonObj.data+"</span>");
contxt.replaceWith(newContent); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T20:08:45.557

我怀疑以下两个问题：

```
a. Either the object being returned by replaceWith() was not same as the new node added, or
b. The return object was being regenerated using the original selection criteria 
```

事实证明，您仍然拥有原始对象的句柄，该对象已从 DOM 中拉出。这在[此处](http://api.jquery.com/replaceWith/)的文档中得到了证实。

您只需要运行选择以再次获取对新节点的引用，然后运行您的前置操作。对于您描述的场景，您不能在 replaceWith() 之前进行链接。查看以下小提琴示例，表明此方法有效：

[http://jsfiddle.net/shaikhtabrez/BbgXW/7/](http://jsfiddle.net/shaikhtabrez/BbgXW/7/)

# php - .htaccess，mod_rewrite 错误

> ID：11871965
> 
> 赞同：0
> 
> 时间：2012-08-08T19:41:24.060
> 
> 标签：php, .htaccess, url, mod-rewrite

在根目录的 .htaccess 文件中，我有以下规则：

```
Options -Indexes  
RewriteEngine on  
RewriteCond %{HTTP_HOST} ^example.com$  
RewriteRule (.*) http://www.example.com$1 [R=301]  
RewriteRule ^([A-Za-z0-9-%]+)/?$ /index.php?m=$1 [L] 
```

我设置了规则，以便将“www”添加到输入的每个 URL 的开头。问题是当我输入“example.com/test”时，它会尝试将我重定向到“www.example.comtest”而不是“www.example.com/test”。我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:46:05.310

尝试更换

```
RewriteRule (.*) http://www.example.com$1 [R=301] 
```

上

```
RewriteRule (.*) http://www.example.com/$1 [R=301] 
```

# url-rewriting - .htacces 重写

> ID：11871970
> 
> 赞同：0
> 
> 时间：2012-08-08T19:41:54.010
> 
> 标签：url-rewriting

我确定已经有了答案，但我无法以简短的方式制定我的查询。

所以这里有一个问题：

我有一个实际位于[http://www.mydomain.com/demo/](http://www.mydomain.com/demo/) 的 PHP 应用程序。整个 PHP 代码的所有链接都为`<a href="/index.php">Home</a>`or`<img src="/logo.png">`等​​。

所以 all 指的是根目录，更改代码很复杂，因为同一个应用程序必须从根文件夹以及另一个客户端工作。我确信有一种优雅的方式可以在 .htaccess 中使用重写规则，但我真的不知道。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:54:05.690

尝试将其放入文档根目录中的 htacess 文件中：

```
RewriteEngine On
RewriteCond %{DOCUMENT_ROOT}/demo%{REQUEST_URI} -f [OR]
RewriteCond %{DOCUMENT_ROOT}/demo%{REQUEST_URI} -d
RewriteRule ^(.*)$ /demo/$1 [L] 
```

如果您确实需要重定向浏览器，请将 替换`[L]`为`[L,R=301]`.

# javascript - 我可以使用谷歌驱动器进行 chrome 扩展（不是应用程序）

> ID：11871973
> 
> 赞同：23
> 
> 时间：2012-08-08T19:42:12.553
> 
> 标签：javascript, google-chrome-extension, google-drive-api

我有一个 chrome 扩展程序（不是应用程序），它是来自免费第三方的数据的混搭。我不为我的扩展维护服务器。

我可以使用 Google Drive 使用用户帐户保存用户的数据，以便不同计算机共享吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-08T23:46:35.220

是的你可以！查看其他[StackOverflow 答案](https://stackoverflow.com/questions/10330992/authorization-of-google-drive-using-javascript/10331393#10331393)，该答案解释了如何使用 google-api-javascript-client 库将数据发送到 Google Drive API。

您可能还对这篇解释如何将 Web Intents 和 Google Drive API 混搭的[博文感兴趣。](http://googleappsdeveloper.blogspot.com/2012/07/saving-files-to-google-drive-with-web.html)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2020-04-06T16:01:52.260

是的，这是一个简短的指南：）

* * *

## 设置您的项目

**首先，您需要：**

1.  按照官方[Google Drive API 文档](https://developers.google.com/drive/api/v3/enable-drive-api)中概述的步骤创建*“云平台项目”*并启用*“Drive API”*。
2.  按照官方[Chrome 扩展开发者文档](https://developer.chrome.com/extensions/app_identity)中概述的步骤为您的扩展获取*“OAuth2 客户端 ID”*并设置您的 manifest.json。

您的 manifest.json 现在应该有一些额外的字段，如下所示：

```
// manifest.json

"permissions": [
    "identity",
    "https://www.googleapis.com/*"
],

"oauth2": {
    "client_id": "YOUR_CLIENT_ID",
    "scopes": [
        "https://www.googleapis.com/auth/drive.appdata",
        "https://www.googleapis.com/auth/drive.file"
    ]
},

"key": "YOUR_APPLICATION_KEY", 
```

您现在可以使用 Google Drive API！

* * *

## 文档

可以在此处找到使用 Google API 的文档（这不是特定于 Google Drive）：

1.  [如何使用 JavaScript 客户端库发出 API 请求](https://github.com/google/google-api-javascript-client/blob/master/docs/start.md)
2.  [如何使用 CORS 访问 Google API](https://github.com/google/google-api-javascript-client/blob/master/docs/cors.md)

可以在[此处找到 Google Drive API 的参考，并在](https://developers.google.com/drive/api/v3/reference/files)[此处](https://developers.google.com/drive/api/v3/manage-uploads)找到示例。

**注意：**与上述文档中使用的方法相比，chrome 扩展中的用户身份验证处理方式可能有所不同。请参阅以下示例，了解如何使用 Chrome Identity API 进行身份验证。

* * *

## 例子

**创建文件：**

```
chrome.identity.getAuthToken({interactive: true}, token => {
    var metadata = {
        name: 'foo-bar.json',
        mimeType: 'application/json',
        parents: ['appDataFolder'],
    };
    var fileContent = {
        foo: 'bar'
    };
    var file = new Blob([JSON.stringify(fileContent)], {type: 'application/json'});
    var form = new FormData();
    form.append('metadata', new Blob([JSON.stringify(metadata)], {type: 'application/json'}));
    form.append('file', file);

    var xhr = new XMLHttpRequest();
    xhr.open('POST', 'https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart');
    xhr.setRequestHeader('Authorization', 'Bearer ' + token);
    xhr.responseType = 'json';
    xhr.onload = () => {
        var fileId = xhr.response.id;
        /* Do something with xhr.response */
    };
    xhr.send(form);
}); 
```

**要获取文件内容：**

```
chrome.identity.getAuthToken({interactive: true}, token => {
    var xhr = new XMLHttpRequest();
    xhr.open('GET', 'https://www.googleapis.com/drive/v3/files/YOUR_FILE_ID?alt=media');
    xhr.setRequestHeader('Authorization', 'Bearer ' + token);
    xhr.responseType = 'json';
    xhr.onload = () => {
        /* Do something with xhr.response */
    };
    xhr.send();
}); 
```

**要覆盖现有文件内容：**

```
chrome.identity.getAuthToken({interactive: true}, token => {
    var xhr = new XMLHttpRequest();
    xhr.open('PATCH', 'https://www.googleapis.com/upload/drive/v3/files/YOUR_FILE_ID?uploadType=media&access_token=' + token);
    xhr.responseType = 'json';
    xhr.onload = () => {
        /* Do something with xhr.response */
    };
    xhr.send(JSON.stringify({foo: 'bar'}));
}); 
```

**注意：**以上示例均使用 CORS，但您也可以使用 javascript 客户端库。

例如，要使用库获取文件内容：

```
gapi.client.init({
    apiKey: 'YOUR_API_KEY',
    discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'],
}).then(() => {
    chrome.identity.getAuthToken({interactive: true}, token => {
        gapi.auth.setToken({
            'access_token': token,
        });

        gapi.client.drive.files.get({
            'fileId': 'YOUR_FILE_ID',
            'alt': 'media'
        }).then(res => console.log(res))
    });
}); 
```

* * *

**进一步阅读：**

[Chrome 扩展中的跨域 XMLHttpRequest](https://developer.chrome.com/apps/xhr)

[适用于 JavaScript Web 应用程序的 OAuth 2.0](https://developers.google.com/identity/protocols/oauth2/javascript-implicit-flow)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2020-08-25T10:53:14.330

Nick Park 的回答是正确的，但我已经学会了简单设置项目并不像听起来那么简单的痛苦方式。如果您按照 Chrome 文档中的本[教程](https://developer.chrome.com/extensions/tut_oauth)进行操作，您可能会在第一步中被打脸。

因此，这里是设置项目的回顾，并进行了一些修改以使其正常工作。

## 上传到开发者仪表板

1.  将项目文件压缩成 zip 文件
2.  转到[开发人员仪表板](https://chrome.google.com/webstore/developer/dashboard)以创建新项目。
3.  上传 zip 文件，填写必填字段并返回仪表板。
4.  **诀窍是**：在我撰写本文时，Developer Dashboard 将始终默认使用新界面，该界面不附带您需要包含到项目中的公钥。

展开右下角的欢迎弹出窗口，然后单击**退出**以恢复到旧视图。

[![在此处输入图像描述](../Images/baae13bac7c6e330990f2d46de640fb2.png)](https://i.stack.imgur.com/unonP.png)

5.  在旧仪表板视图中，找到您的扩展程序并单击更多信息。 [![在此处输入图像描述](../Images/a636b7f33b513c87d9b366f4e233271f.png)](https://i.stack.imgur.com/raUPX.png)

6.  复制公钥并将其作为值粘贴到解`key`压缩目录中清单文件的字段中

## 加载解压后的扩展

7.  导航到`chrome://extensions`，启用开发人员模式并上传解压缩的目录。您应该会看到此页面上的应用程序 ID 与开发人员仪表板中的应用程序 ID 匹配。

## 创建 OAuth 客户端 ID

8.  转到[Google Api 控制台](https://console.developers.google.com/apis)并为您的扩展创建一个新项目。
9.  导航到新创建的项目，然后单击左侧边栏上的**凭据。**
10.  单击**Create Crendentials**并选择**OAuth Client ID**。
11.  在下一个屏幕上，选择应用**程序类型**下的**Chrome 应用**程序并输入您的应用程序 ID。

 **如果您访问扩展程序的 Chrome 网上商店 URL，例如`https://chrome.google.com/webstore/detail/abcdefghjik`，您将看到**404 Not Found**错误。别担心。您尚未发布您的应用程序，因此该 URL 当然不存在。但是您仍然可以使用应用程序 ID 向 Google OAuth 注册您未发布的扩展程序。

12.  准备好后，点击保存按钮，您应该会看到您的应用程序的客户端 ID。可以通过单击左侧边栏上的凭据选项卡随时访问它。

## 在清单文件中注册 OAuth

13.  在工作目录的清单文件中，包含`oauth2`字段并添加以下信息：

```
"oauth2": {
  "client_id": <your client id>,
  "scopes": ["https://www.googleapis.com/auth/userinfo.email"]
} 
```

请注意，年份是 2020 年，您不能再将 Scopes 字段留空，如古代文档所述。

您需要添加上述范围，因为您的应用会要求用户选择他们的 Gmail 帐户之一。这意味着您的应用程序将能够查看用户的电子邮件地址，我们需要提前做好准备。

这就是棘手、耗时的部分。现在您可以按照本教程的其余部分以及 Nick Park 对向您想要的任何 Google API 发出 HTTP 请求的回答进行操作。**

# vb.net - VB.Net 2010 - 从 MDB 访问数据库填充 ComboBox

> ID：11871983
> 
> 赞同：1
> 
> 时间：2012-08-08T19:42:46.137
> 
> 标签：vb.net, drop-down-menu, combobox

我目前正在尝试从 MDB 数据库中为我正在从事的工作项目填充 VB.Net 中的表单上的下拉框。

我在名为“cancmov”的数据库中有一个名为“Months”的表，我试图从中提取的字段称为 MoveMonth。

我正在使用的当前代码是：-

```
Private Sub drpMovedFrom_SelectedIndexChanged(sender As System.Object, e As System.EventArgs) Handles drpMovedFrom.SelectedIndexChanged

    Dim ConnnectionString As String = "PROVIDER=Microsoft.Jet.OLEDB.4.0;Data Source=C:\Users\Admin\Desktop\CancellationsAndMovements\CancellationsandMovements\cancmov.mdb"
    Dim db As String = "SELECT MoveMonth FROM Months"
    Dim cn As New OleDbConnection(ConnnectionString)
    Dim da As New OleDbDataAdapter(db, cn)
    Dim ds As New DataSet()

    da.Fill(ds, "MoveMonth")

    With drpMovedFrom
        .DataSource = ds.Tables("MoveMonth")
        .SelectedIndex = 0
    End With

End Sub 
```

正如您可能从上面收集到的那样，我目前正在学习中，所以上面的很多内容我都在努力理解。我实际上是从我在谷歌上找到的一个类似问题中提取了上面的代码。任何帮助都将不胜感激，即使只是向我指出一个我可以学习为自己做这件事的资源。

提前谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T20:03:11.847

几件事情马上开始：

当下拉索引更改时，您正在调用此代码。可能不是您想要的，因为它总是会将其设置为零。

另外，尝试使用括号将一次性物品括起来：

```
Private ds As New DataSet()
Private ConnnectionString As String = "PROVIDER=Microsoft.Jet.OLEDB.4.0;Data Source=C:\Users\Admin\Desktop\CancellationsAndMovements\CancellationsandMovements\cancmov.mdb"

Protected Overrides Sub OnLoad(e As EventArgs)
  Dim db As String = "SELECT MoveMonth FROM Months"

  Using cn As New OleDbConnection(ConnnectionString)
    Using da As New OleDbDataAdapter(db, cn)
      da.Fill(ds, "MoveMonth")
    End Using
  End Using

  With drpMovedFrom
      .DisplayMember = "MoveMonth"
      .DataSource = ds.Tables("MoveMonth")
      .SelectedIndex = 0
  End With

  MyBase.OnLoad(e)
End Sub 
```

此外，ComboBox 具有您映射到数据源的 DisplayMember 和 ValueMember 属性。DisplayMember 是您在列表中看到的可见值，ValueMember 通常是可见属性的 ID 值。

# javascript - 如图所示，如何将名字姓氏放在文本框的顶部

> ID：11871984
> 
> 赞同：0
> 
> 时间：2012-08-08T19:42:49.230
> 
> 标签：javascript, asp.net, css, asp.net-mvc

我已经看到了，但我不知道该怎么做..或者用什么来环绕文本框来完成这个。

我认为这将通过字段集完成，但我可能是错的。

我附上了一张图片，希望能传达我的观点。

谢谢 .. ![在此处输入图像描述](../Images/4828fb7b7325883e0321284c4675366d.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T20:15:08.560

这是在没有表格的情况下执行此操作的一种方法。

CSS：

```
<style>
div{
width:150px
}
div label{
clear:left;
font-size:9px;
}
</style> 
```

和 HTML：

```
<div><label>First</label><input type="text" id="firstName" /></div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T19:50:15.263

有人可能会为此向我开枪，但一张桌子可以让这很容易..

```
<table style="width:375px;" cellspacing="0" cellpadding="2">
    <col width="75px">
    <col width="150px">
    <col width="150px">
    <tr>
        <td></td>
        <td>first</td>
        <td>last</td>
    </tr>
    <tr>
        <td>
            NAME
        </td>
        <td>
            <input type="text" id="firstName" />
        </td>
        <td>
            <input type="text" id="lastName" />
        </td>
    </tr>
</table> 
```

`<divs>` 如果你也愿意，我可以用它来鞭打一个..

编辑：我不熟悉任何会自动执行此操作的 .NET 控制器，除非它是自定义的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T20:02:04.930

这应该这样做：

```
<table>
       <tr>
          <td>
             Name
          </td>
          <td>
             Html.LabelFor(m => m.First)
             Html.TextBoxFor(m => m.First)
          </td>
          <td>
             Html.LabelFor(m => m.Last)
             Html.TextBoxFor(m => m.Last)
          </td>
      </tr>
    </table> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-09T21:07:29.327

这里

```
<div class="section">
    <div class="left">
        Name
    </div>
    <div class="right">
        <div class="nm">
            First
        </div>
        <div class="val">
            <asp:TextBox runat="server" ID="txtBox1"></asp:TextBox>
        </div>
    </div>
    <div class="right">
        <div class="nm">
            Last
        </div>
        <div class="val">
            <asp:TextBox runat="server" ID="txtBox2"></asp:TextBox>
        </div>
    </div>
</div> 
```

风格：

```
<style>
    .section
    {
        clear: both;
        }
        .section .left
        {
            float: left;
            font-size: 25px;
            padding:5px;
            padding-top:15px;

        }
        .section .right
        {
            float: left;
            padding:5px;

            }
            .section .right .nm
            {
                font-size: 10px;
            }
            .section .right .val
            {
            }
</style> 
```

# php - PHP标头不起作用

> ID：11871985
> 
> 赞同：-2
> 
> 时间：2012-08-08T19:42:59.177
> 
> 标签：php, http-headers

> **可能重复：**
> [PHP 已发送的标头](https://stackoverflow.com/questions/8028957/headers-already-sent-by-php)

“无法修改标头信息 - 标头已发送”

自从将我的 MacBook Pro 更新到 OS X Mountain Lion 后，我的 localhost 网站一直出现故障。

我的大部分（如果不是全部）`header("Location: ./xxx.php");`重定向都不起作用。他们在 Lion 工作，所以我假设 Mountain Lion 是导致此问题的原因，而不是我的代码。如果我关闭内置服务器并启用/使用 MAMP，也会发生错误。

这让我相信，Mountain Lion 作为一个整体对待头球的方式存在问题。如果这个错误实际上是我的代码，那么为什么它在 Lion 中起作用？如果是这种情况，我会假设 Mountain Lion 以更严格的方式读取 PHP 代码。此外，我随后制作了一个带有标头重定向的简单 test.php 脚本，以查看标头是否正常工作。事实证明，当我在 Safari 中打开该脚本时，它毫无问题地重定向了我。这个错误对我来说似乎很奇怪，我想要一些反馈。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T19:48:12.790

`Cannot modify header information - headers already sent`表示您正在尝试在数据已发送时发送标头。这是不可能的。

如果您需要调试您的应用程序，请将您`header('Location: ...)`的替换为一个简单的`exit;`并检查您是否有任何输出。在您的呼叫之前搜索任何`echo`, `print`...。`header()`

# javascript - 粘性导航栏功能

> ID：11871998
> 
> 赞同：0
> 
> 时间：2012-08-08T19:43:48.000
> 
> 标签：javascript, jquery, css, jquery-waypoints

我正在尝试使用 jQuery 航点创建一个粘性导航栏。我对 Javascript 不太了解，所以我试图从示例中拼凑起来。

这是我正在使用的导航：

```
 <section id="nav">

    <div class="container">
        <div id="mainnav">
            <nav id="myNavigation" class="horizontal_nav pageScrollerNav topNav sixteen columns alpha">
                <ul>
                    <li><a href="#"><i class="icon-home"></i> Home</a></li>
                    <li><a href="#"><i class="icon-picture"></i> Portfolio</a></li>
                    <li><a href="#"><i class="icon-list-ul"></i> Services</a></li>
                    <li><a href="#"><i class="icon-comments"></i> Contact</a></li>
                    <li><a href="#"><i class="icon-rss"></i> Follow Me</a></li>
                </ul>
            </nav>
        </div> <!--end mainnav-->
    </div> <!--end nav-container-->

</section> <!--end nav--> 
```

这是我设置的 jQuery：

```
 $(document).ready(function() {
    $('.top').addClass('hidden');
    $.waypoints.settings.scrollThrottle = 30;
    $('#mainnav').waypoint(function(event, direction) {
        $('.top').toggleClass('hidden', direction === "up");
    }, {
        offset: '-100%'
    }).find('#myNavigation').waypoint(function(event, direction) {
        $(this).parent().toggleClass('sticky', direction === "down");
        event.stopPropagation();
    });
}); 
```

感谢您的所有帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T19:56:45.297

假设你有一个像这样的类：

```
.nav-fixed {
    position: fixed;
    top: 0;
    left: 0;
} 
```

您可以像这样编写一些 jQuery（根据为 Twitter 的 Bootstrap 文档页面编写的代码修改）。它将监视您的导航元素。当它到达屏幕顶部时，它将获取`nav-fixed`将元素固定到页面左上角的类。

```
var $window = $(window),
    $nav = $('#navigation'),
    nav_top = $nav.offset().top,
    isNavFixed = false;

$window.on('scroll',checkNav); // call function when page scrolls

checkNav(); // initial call to function on document ready

function checkNav() {
    var scroll_top = $window.scrollTop();

    if(scroll_top >= nav_top && !isNavFixed) {
        isNavFixed = true;
        $nav.addClass('nav-fixed');
    } else if(scroll_top <= nav_top && isNavFixed) {
        isNavFixed = false;
        $nav.removeClass('nav-fixed');
    }
} 
```

您可以根据需要修改此代码以使用您的航点插件。

# javascript - 将处理代码链接到 javascript，同时保持 pde 文件分开

> ID：11871999
> 
> 赞同：1
> 
> 时间：2012-08-08T19:43:50.293
> 
> 标签：javascript, variables, global-variables, processing.js

我正在使用 ProcessingJs。我想要做的就是从我的 pde 文件中获取一个变量，以便在我的 javascript 中使用。此处的唯一示例似乎是您直接在 javascript 中编写处理代码时。我正在尝试加载 pde 文件，然后在我的 javascript 中使用 pde 中的变量。

Processingjs 网站给出了这些段落：

> 从处理代码到 JavaScript 比另一种方式更容易，因为由 Processing.js 解析器创建的 JavaScript 不会直接暴露在全局对象上。相反，您可以使用 Processing.instances 属性获得访问权限。
> 
> Processing 构造函数跟踪它创建的实例，并使用 getInstanceById() 方法使它们可用。默认情况下，当 a 具有 data-processing-sources 属性时，其 id 用作 Processing 实例的唯一标识符。如果没有提供 id 属性，您可以使用 Processing.instances[0]。

他们在本段下方指向的示例没有链接。这一定是我的答案，但我想不通。有人可以帮我吗？如何在我的 javascript 中实例化处理实例？

我曾尝试在我的 javascript 中使用 getInstanceById(...) ，但它说该方法在错误控制台中未定义。

任何帮助表示赞赏，谢谢！~麦克希尼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T10:57:01.997

要从 javascript 访问处理，您必须为您*的*`id`html`canvas`元素设置一个：

```
<canvas id="my-sketch" data-processing-sources="sketch.pde"></canvas> 
```

然后使用以下`getInstanceById`方法访问它：

```
var p = Processing.getInstanceById('my-sketch');
p.background(0);
p.redraw();
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T19:53:43.503

我很困惑 - 我以为你的 .pde 文件基本上*是*Javascript！

无论如何：看这里：

> * [http://js.processing.org/reference/articles/jsQuickStart#writingpureprocessingcode](http://js.processing.org/reference/articles/jsQuickStart#writingpureprocessingcode)
> 
> **编写结合处理和 JavaScript 代码的文档**
> 
> 人们对 Processing.js 提出的第一个问题是他们是否可以从正在运行 Processing 草图的文档中读取值，反之亦然。答案是肯定的。
> 
> Processing.js 将处理代码转换为包含在函数闭包中的 JavaScript。您创建的变量和函数不附加到全局对象（即窗口）。但是，您仍然可以访问它们。
> 
> **从处理中访问 JavaScript 对象**
> 
> 由于处理代码被转换为 JavaScript 并像任何其他函数一样运行，所有处理代码都可以访问全局对象。这意味着如果您在全局脚本块中创建变量或函数，Processing 会自动访问它们。