# StackOverflow 问答 000233000-000233999

# tsql - 对 T-SQL 中的聚合感到困惑

> ID：233009
> 
> 赞同：1
> 
> 时间：2008-10-24T10:28:24.713
> 
> 标签：tsql

好的：这是我的一些表结构在这里很重要

```
CaseStudyID int
Title nvarchar(50)
OverrideTitle nvarchar(50) 
```

我的程序的一部分

```
Declare @Temp table(CaseStudyID int,
            Title nvarchar(50))

Insert Into @Temp 
SELECT CaseStudyID,Title 
FROM CaseStudy 
WHERE Visible = 1 AND DisplayOnHomePage = 1 
ORDER BY Title

Update @Temp Set Title = TitleOverride 
--Here is where im lost if the title occurs more than once
--I need to replace it with the override
--Schoolboy error or leaking brain I cant get it going

Select * From @Temp 
```

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T10:57:05.000

我不确定您是否需要原始表的每一行。所以这是我的替代解决方案，它为您提供每一行：

```
SELECT CaseStudyID, Title 
FROM CaseStudy c1
WHERE NOT EXISTS (
   SELECT * FROM CaseStudy c2 
   WHERE c2.CaseStudyID <> c1.CaseStudyID and c2.Title = c1.Title
)

UNION ALL

SELECT CaseStudyID, OverrideTitle
FROM CaseStudy c1
WHERE exists (
   SELECT * FROM CaseStudy c2
   WHERE c2.CaseStudyID <> c1.CaseStudyID and c2.Title = c1.Title
)

ORDER BY Title 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T10:40:48.167

您可以通过这种方式在不使用临时表的情况下实现它：

```
SELECT 
    MIN(CaseStudyID) AS CaseStudyID, 
    CASE WHEN count(*) = 1 THEN 
       MIN(Title) 
    ELSE
       MIN(OverrideTitle) 
    END AS Title
FROM CaseStudy
GROUP BY Title
ORDER BY Title 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-24T11:04:05.233

这将用相应的 overrideTitle 值替换多次出现的每个标题。

它将保留它的第一次出现，例如，如果您有 3 个标题，例如 a、a、a，则只有第二个和第三个将被替换

```
select distinct
    cs1.CaseStudyID,
    case when cs2.CaseStudyID is null then cs1.Title else cs1.overrideTitle end as title
from  
    CaseStudy cs1
    left join CaseStudy cs2 
        on cs1.title = cs2.title
        and cs1.CaseStudyID > cs2.CaseStudyID 
```

如果要替换所有这些，只需将 > 更改为 <>，如下所示

```
select distinct
    cs1.CaseStudyID,
    case when cs2.CaseStudyID is null then cs1.Title else cs1.overrideTitle end as title
from  
    CaseStudy cs1
    left join CaseStudy cs2 
        on cs1.title = cs2.title
        and cs1.CaseStudyID <> cs2.CaseStudyID 
```

# language-agnostic - 你最喜欢的语言如何处理深度递归？

> ID：233013
> 
> 赞同：23
> 
> 时间：2008-10-24T10:30:17.003
> 
> 标签：language-agnostic, recursion, language-features, language-design

我最近开始学习 Python，我很惊讶地发现深度递归限制为 1000（默认情况下）。如果你将它设置得足够高，大约 30000，它会像 C 一样因分段错误而崩溃。虽然，C 似乎要高得多。

（Python 人员很快指出，您始终可以将递归函数转换为迭代函数，并且它们总是更快。这是 100% 正确的。不过，这并不是我的问题所在。）

我在 Perl 中尝试了相同的实验，大约 1000 万次递归消耗了我所有的 4 gig ram，我使用 ^C 停止尝试。显然 Perl 不使用 C 堆栈，但它在递归时确实使用了大量的内存——考虑到调用函数需要做多少工作，这并不令人震惊。

我在 Pike 中尝试过，在大约 2 秒内获得了 100,000,000 次递归，这让我感到非常惊讶。我不知道它是如何做到的，但我怀疑它会将递归展平为一个迭代过程——它在执行此操作时似乎没有消耗任何额外的内存。[注意：Pike 确实可以使琐碎的情况变平，但在更复杂的情况下会出现段错误，或者我被告知。]

我使用了这些原本无用的功能：

```
int f(int i, int l) { if(i<l) return f(i+1,l); return i; }

sub f { return f($_[0]+1, $_[1]) if $_[0]<$_[1]; return $_[0] };

def f(i,l):
   if i<l:
     return f(i+1,l)
   return i 
```

我很好奇其他语言（例如 PHP、Ruby、Java、Lua、Ocaml、Haskell）是如何处理递归的，以及为什么它们以这种方式处理递归。此外，请注意如果函数是“尾递归”（见评论），它是否会有所不同。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-24T11:30:53.213

“Python 人员很快指出，您始终可以将递归函数转换为迭代函数，而且它们总是更快”

这是真的，但如果它真的这么简单，为什么 Python 不为我做这件事，让我的代码看起来尽可能简单？（我这样说不是为了抨击 Python 实现者，而是因为答案解释了问题）。

自 14 世纪以来，递归优化一直存在于函数式语言中。Haskell、CAML、Lisp 实现通常都至少将尾递归函数转换为迭代：您基本上通过发现它是可能的来做到这一点，即可以重新排列函数，以便在递归调用之后不使用除返回值之外的局部变量. 如果在返回之前对递归返回值做了一些工作，一个技巧是引入一个额外的“累加器”参数。简单来说，这意味着可以在“向下”而不是“向上”的方式上有效地完成工作：搜索“如何使函数尾递归”以获取详细信息。

将尾递归函数转换为循环的实际细节基本上是调整您的调用约定，这样您只需设置参数并跳回函数的开头即可“执行调用”，而无需费心保存所有这些你知道你永远不会使用的范围内的东西。在汇编器术语中，如果数据流分析告诉您它们在调用之外未被使用，则您不必保留调用者保存寄存器，堆栈上的任何内容也是如此：您不必移动堆栈指针如果您不介意“您的”堆栈被下一次递归/迭代所覆盖，则在通话中。

与您对 Python 人员的解释相反，将通用递归函数转换为迭代并非易事：例如，如果它是乘递归的，那么在一个简单的方法中，您仍然需要一个堆栈。

不过，对于任意递归函数，记忆化是一种有用的技术，如果您对可能的方法感兴趣，您可能想查找它。这意味着每次评估一个函数时，您都会将结果保存在缓存中。要使用它来优化递归，基本上，如果您的递归函数计数“向下”，并且您记住它，那么您可以通过添加一个“向上”计数的循环来迭代地评估它，依次计算函数的每个值，直到您到达目标。如果备忘录缓存足够大以容纳您需要的所有值，这将使用非常少的堆栈空间：例如，如果 f(n) 取决于 f(n-1)、f(n-2) 和 f(n -3）您只需要缓存中的 3 个值的空间：当您向上时，您可以将梯子踢开。如果 f(n) 取决于 f(n-1) 和 f(n/2)，

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-24T13:41:46.090

这更像是一个实现问题而不是语言问题。没有什么能阻止一些（愚蠢的）C 编译器实现者也将他们的调用堆栈限制为 1000。那里有很多小型处理器，即使有那么多也没有堆栈空间。

> （Python 人员很快指出，您始终可以将递归函数转换为迭代函数，并且它们总是更快。这是 100% 正确的。不过，这并不是我的问题所在。）

也许他们确实这么说，但这并不完全正确。递归总是可以转换为迭代，但有时也需要手动使用*堆栈*。在这种情况下，我可以看到递归版本更快（假设您足够聪明，可以进行简单的优化，例如在递归例程之外提取不需要的声明）。毕竟，围绕过程调用的堆栈推送是一个有界的问题，您的编译器应该知道如何很好地优化。另一方面，手动堆栈操作不会在您的编译器中具有专门的优化代码，并且可能会进行各种用户界面的完整性检查，这将占用额外的周期。

可能是迭代/堆栈解决方案*在 Python*中总是更快。如果是这样，那是 Python 的失败，而不是递归的失败。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-24T10:36:28.643

PHP 在死前默认限制为 100：

`Fatal error: Maximum function nesting level of '100' reached, aborting!`

编辑：您可以使用 更改限制`ini_set('xdebug.max_nesting_level', 100000);`，但如果超过 1150 次迭代 PHP 会崩溃：

`[Fri Oct 24 11:39:41 2008] [notice] Parent: child process exited with status 3221225477 -- Restarting.`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-24T10:38:08.000

C#/.NET 将在特定情况下使用尾递归。（C# 编译器不会发出尾调用操作码，但[JIT 在某些情况下会实现尾递归](http://blogs.msdn.com/davbr/pages/tail-call-jit-conditions.aspx)。

Shri Borde[也有关于这个主题的帖子](http://blogs.msdn.com/shrib/archive/2005/01/25/360370.aspx)。当然，CLR 不断变化，在 .NET 3.5 和 3.5SP1 中，它可能在尾调用方面再次发生变化。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-24T12:45:19.073

在 F# 交互式控制台中使用以下内容，它在不到一秒的时间内运行：

```
let rec f i l = 
  match i with 
  | i when i < l -> f (i+1) l
  | _ -> l

f 0 100000000;; 
```

然后我尝试了直接翻译，即

```
let rec g i l = if i < l then g (i+1) l else l

g 0 100000000;; 
```

相同的结果，但不同的编译。

这是*f*翻译成 C# 时的样子：

```
int f(int i, int l)
{
  while(true)
  {
    int num = i;
    if(num >= l)
      return l;
    int i = num;
    l = l;
    i = i + 1;
  }
} 
```

*g*，但是被翻译成这样：

```
int g(int i, int l)
{
  while(i < l)
  {
    l = l;
    i++;
  }
  return l;
} 
```

有趣的是，两个基本相同的函数在 F# 编译器中呈现的方式不同。它还表明 F# 编译器具有尾递归优化。因此这应该循环直到 i 达到 32 位整数的限制。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-24T10:36:31.110

根据这个线程，[大约 5,000,000](http://www.velocityreviews.com/forums/showpost.php?p=652300&postcount=7)使用 java，1Gb RAM。（而且，使用热点的“客户端”版本）

那是300Mo的[堆栈（-Xss）](http://mindprod.com/jgloss/javaexe.html)。

使用[-server 选项](https://stackoverflow.com/questions/198577/real-differences-between-java-server-and-java-client#198651)，可以增加。

也可以尝试优化编译器（例如[使用 JET](http://mindprod.com/jgloss/jet.html)）以减少每一层的堆栈开销。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-24T11:45:11.957

在一些非病态的情况下（比如你的），（最新的）Lua 将使用[尾调用递归](http://en.wikipedia.org/wiki/Tail_recursion "尾递归 - 维基百科，免费的百科全书")，即。它只会跳转而不将数据推送到堆栈中。所以递归循环的数量几乎是无限的。

经测试：

```
function f(i, l)
    if i < l then
        return f(i+1, l)
    end
    return i
end

local val1  = arg[1] or 1
local val2  = arg[2] or 100000000
print(f(val1 + 0, val2 + 0)) 
```

还有：

```
function g(i, l)
    if i >= l then
        return i
    end
    return g(i+1, l)
end 
```

甚至尝试过交叉递归（f 调用 g 和 g 调用 f ...）。

在 Windows 上，Lua 5.1 使用大约 1.1MB（常数）来运行它，在几秒钟内完成。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-24T10:46:52.367

Visual Dataflex 将堆栈溢出。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-24T16:05:58.623

有一种方法可以改进`Perl`代码，使其使用恒定大小的堆栈。您可以使用特殊形式的`goto`.

```
sub f{
  if( $_[0] < $_[1] ){

    # return f( $_[0]+1, $_[1] );

    @_ = ( $_[0]+1, $_[1] );
    goto &f;

  } else {
    return $_[0]
  }
} 
```

首次调用时，它将在堆栈上分配空间。然后它将更改其参数，并重新启动子程序，而不向堆栈添加任何内容。因此它会假装它从未调用过它自己，将它变成一个迭代过程。

* * *

您还可以使用[Sub::Call::Recur](http://search.cpan.org/perldoc/Sub::Call::Recur)模块。这使得代码更容易理解，更短。

```
use Sub::Call::Recur;
sub f{
  recur( $_[0]+1, $_[1] ) if $_[0] < $_[1];
  return $_[0];
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-24T16:16:24.233

我非常喜欢函数式编程，并且由于大多数语言都实现了尾调用优化，因此您可以随心所欲地递归：-P

然而，实际上，我必须使用大量的 Java 和 Python。不知道 Java 有什么限制，但对于 Python，我实际上已经计划（但尚未完成）实现一个装饰器，该装饰器将尾调用优化装饰函数。我计划这样做不是为了优化递归，而是主要作为动态修补 Python 字节码和了解更多关于 Python 内部结构的练习。继承人一些 itneresting 链接：[http](http://lambda-the-ultimate.org/node/1331) ://lambda-the-ultimate.org/node/1331和[http://www.rowehl.com/blog/?p=626](http://www.rowehl.com/blog/?p=626)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-11-19T21:34:16.217

[clojure](http://clojure.org/)为尾递归“recur”提供了一种特殊形式，它只能用于 ast 的尾部位置。否则，它的行为类似于 java 并且可能会抛出 StackverflowException。

# sql - 如何在访问中运行查询循环？

> ID：233026
> 
> 赞同：0
> 
> 时间：2008-10-24T10:36:04.463
> 
> 标签：sql, ms-access, loops

我有一个带有表的数据库，该表充满了用于检查另一个数据库的条件和错误消息。

我想运行一个循环，以便根据第二个数据库中的所有表检查每个条件，并生成一个给出错误的报告。

这在 ms 访问中是否可能。

例如，

查询语句表

```
id           query                                 error    
1           speed<25 and speed>56              speed above limit  
2           dist<56 or dist >78                dist within limit 
```

我有 400 多个这样的不同变量的查询。

我运行查询的表是

记录表

```
id   speed     dist    accce   decele   aaa   bbb     ccc
1     33        34      44         33   33     33      33
2     45        44      55         55   55     22      23 
```

问候 ttk

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T13:09:23.737

这是更多示例代码。它说明了两种不同类型的记录集的使用。您可能希望阅读Allen Browne 的[VBA 陷阱：使用记录集以及](http://allenbrowne.com/ser-29.html)[Access 2002 和更高版本的 Access 中的保留字列表](http://support.microsoft.com/kb/286335) 。

```
Dim rs As DAO.Recordset
Dim rs2 As ADODB.Recordset

Set rs = CurrentDb.OpenRecordset("querycrit")
Set rs2 = CreateObject("ADODB.Recordset")
rs2.ActiveConnection = CurrentProject.Connection
For Each tdf In CurrentDb.TableDefs
'EDIT: TableDefs includes Microsoft System tables and '
'these should never be tampered with. They all begin with Msys '
'so we can leave them out of the loop here. '
   If Left(tdf.Name, 4) <> "msys" And tdf.Name <> "querycrit" Then
        rs.MoveFirst
        strSQL = "SELECT * From [" & tdf.Name & "] WHERE "

        Do While Not rs.EOF
            On Error Resume Next
            Debug.Print tdf.Name
            rs2.Open strSQL & " " & rs![query]
            If Err.Number = 0 Then
                On Error GoTo 0
                If Not rs2.EOF Then
                    Debug.Print rs![Error]
                    Debug.Print rs2.GetString
                End If
            End If
            Err.Clear
            rs2.Close
            rs.MoveNext

        Loop
    End If
Next
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T11:01:45.707

当您说“报告”时，您是指访问报告，还是写入文件或访问表单有效？

您可以在模块中创建一个函数或子函数来执行此操作。在您的 querycrit 表上打开一个记录集并通过记录动态构建和运行记录表的 SQL。您可以将这些动态查询的结果写入文件或表单，或将结果插入临时表并从那里驱动访问报告。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T11:20:50.957

这是一些示例代码，它是输入的，未经测试。

```
Dim rs AS DAO.Recordset
Dim rs2 AS DAO.Recordset

Set rs=CurrentDB.OpenRecordset("querycrit")

strSQL="SELECT * From Records WHERE "
Do While Not rs.EOF
   Set rs2=CurrentDB.OpenRecordset(strSQL & rs![Query])
   If Not rs2.EOF Then
       Debug.Print rs![Error]
       Debug.Print rs2.Fields(1)
   End If

   rs.MoveNext
Loop 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T12:12:11.857

> “实际上有许多记录表需要检查，并不是所有的查询都可以在所有表​​上运行，例如在一个表中可能没有速度，而在下一个表中可能没有距离。”

我认为，正确的做法是创建一个表表和一个查询表联结表，该表显示要在哪个表上运行哪些查询，例如：

```
TableID  QueryID
1           4
2           1
2           3
3           1 
```

这可用于在每个表上运行正确的查询集。

# c - 如何在 Windows 中设置 Turbo C 路径？

> ID：233027
> 
> 赞同：1
> 
> 时间：2008-10-24T10:36:09.520
> 
> 标签：c, windows, path, turbo-c, tcc

如何在 windows 中全局设置 turbo c 路径，以便我可以在 windows XP 中使用命令提示符编译和运行我的 C 程序（在其他驱动器中）？谁能告诉我如何在命令提示符下的每个驱动器上输入命令

```
c:\tcc 
```

在 Windows 和 Turbo C 环境中的命令提示符下？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-24T10:40:00.417

*   转到开始菜单，然后转到控制面板。
*   选择“系统”小程序。
*   单击“高级”选项卡。
*   点击“环境变量”
*   找到“路径”变量，然后按“编辑”
*   附加分号，然后是 Turbo C 的路径

要设置包含和库路径，请转到同一个位置，但不要编辑“Path”变量，而是创建一个名为“INCLUDE”的新变量，并将其设置为您的 turboc“\include”目录的位置；并创建一个名为“LIB”和一个名为“CLASSPATH”，并将它们设置到您的涡轮增压器“\lib”目录。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-24T11:17:33.647

您使用这么旧的编译器有什么原因吗？如果我没记错的话，Turbo C 最后一次发布是在 1990 年代初。

我可能会建议下载免费的[Visual Studio Express Edition](http://www.microsoft.com/Express/)，它是一个更现代的编译器，您会在这里找到更多愿意提供帮助的人。它还带有良好的文档，并且更容易在网上搜索文章和帮助。

# c++ - VB DLL 中的下划线符号是什么？

> ID：233035
> 
> 赞同：1
> 
> 时间：2008-10-24T10:39:58.030
> 
> 标签：c++, dll, com, vb6

我在 VS2005 中有一个 C++ 应用程序并导入一个 VB DLL。IntelliSense 按预期向我显示了 DLL 中的所有符号，但它也再次显示所有（或几乎所有）符号，并带有下划线前缀（尽管其中没有 @s）。为什么是这样？带下划线的项目和普通项目有什么区别？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-24T11:24:02.340

假设您使用的是 VB6，前导下划线版本 _Klass 是 Vb 为类 Klass 生成的默认接口。这个网站有一个很好的解释： [http ://www.15seconds.com/issue/040721.htm](http://www.15seconds.com/issue/040721.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T10:45:52.917

在（某些）c# 编码标准中，下划线前缀表示一个私有变量，这可以解释它......是 VB 还是 VB.Net？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T11:02:23.507

符号是属性吗？如果是这样，这些可能只是支持属性的私有变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T11:26:23.987

查看这篇关于 Name Mangling 的 wiki 文章以深入了解：

[http://en.wikipedia.org/wiki/Name_mangling](http://en.wikipedia.org/wiki/Name_mangling)

# javascript - Javascript 世界时区与 GMT 计算器的时差

> ID：233041
> 
> 赞同：2
> 
> 时间：2008-10-24T10:41:53.720
> 
> 标签：javascript, time, timezone

我希望有人可以向我发送定期更新时区数据库的方向。

我找到了一个，但很抱歉我不记得它是从哪里来的，但是随着当前 GMT 时钟变化的迅速临近，我担心我所有的数据都会不正确，即从英国到纽约的差异将从 5 小时后变为 6 小时落后几个小时。

对此问题的任何帮助将不胜感激。

卡梅伦

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-24T10:52:59.000

你的意思是像[奥尔森数据库](http://en.wikipedia.org/wiki/zoneinfo)吗？

例如，[flegix.js](http://js.fleegix.org/plugins/date/date) javascript 库是一个支持时区的插件，可以替代现有的 JavaScript Date，为您提供全面的时区支持，独立于运行浏览器的最终用户机器上设置的时区。它使用 Olson zoneinfo 文件作为其时区数据。

我相信[时间转换器](http://www.timezoneconverter.com/cgi-bin/zoneinfo?s=standard&tz=Europe/London)也使用这样的数据库，以及[timeanddate.com](http://timeanddate.com/worldclock)，例如[London](http://timeanddate.com/worldclock/city.html?n=136)或[New-York](http://timeanddate.com/worldclock/city.html?n=179)。

* * *

任何 DST 信息（夏令时）都可以从[timeanddate.com](http://timeanddate.com/worldclock)推导出来，也可以从**[夏令时时间.info 推导出来](http://daylight-savings-time.info/)**

这是一个[javascript 程序](http://lists.evolt.org/pipermail/javascript/2004-April/007068.html)，它确实利用 DST 信息来应用正确的时移。
还有另一个[SimpleTimeZone](http://www.michaelbrumm.com/simpletimezone.html)脚本。

您还可以从[global-time-zones.com](http://wwp.global-time-zones.com/europe/uk/)查询 DST 数据，如[wwp.britishsummertime.co.uk](http://wwp.britishsummertime.co.uk/)。您在[webexhibits.org上也有信息](http://www.webexhibits.org/daylightsaving/g.html)

有关如何检索 DST 信息的详细讨论，请参阅**[此论坛。](http://www.codeverge.net/ng.asp-net-forum.dotnetnuke/timezone-daylight-savings-time)**

最后，请参阅tar.gz Olson 数据库示例的**[SO 问题](https://stackoverflow.com/questions/154369/what-is-the-best-way-to-represent-summer-time-rules#165452)**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T01:51:12.863

如果您有想要获取时区信息的任何地方的纬度和经度，则可以使用以下服务将其映射到实时时区信息： [http ://www.earthtools.org/webservices.htm#timezone](http://www.earthtools.org/webservices.htm#timezone)

如果您从地址或地名开始，您可以使用地理编码服务获取 lat/lng 信息 - 例如参见 geonames.org，或者 google 和 yahoo 也有服务。然后如上所述使用时区服务。

# django - How to read the database table name of a Model instance?

> ID：233045
> 
> 赞同：115
> 
> 时间：2008-10-24T10:43:29.067
> 
> 标签：django

Given a model's instance object, how can I get the database table's name?

I don't want to specify names explicitly in the Meta class.

* * *

## 回答 #1

> 赞同：196
> 
> 时间：2008-10-24T11:38:53.387

Found the answer myself: the _meta attribute of an instance has the information:

```
model_instance._meta.db_table 
```

# c - 任何人都可以告诉我c中的列表文件和地图文件是什么吗？

> ID：233047
> 
> 赞同：0
> 
> 时间：2008-10-24T10:44:40.733
> 
> 标签：c, windows, command, dos, turbo-c

我是**Manoj**再次在这里问你我的疑问。

我听说在 turbo c 中，当我们使用多个源文件进行项目时

然后我们可以生成**列表文件和地图文件**。

这些是什么？

它们包含什么？

以及如何使用 tcc for turbo c 在 MS-DOS 命令提示符下使用命令生成它们？

如何使用 turbo tcc 命令生成 ac 文件的汇编代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T11:31:12.870

列表文件通常包含编译器生成的汇编语言代码。它还可能包含您的原始源代码，其中散布着 asm 代码。

映射文件包含代码中的所有静态符号（函数、全局变量等）及其相对地址。根据您的链接器设置，它可能包含其他信息，例如程序中每一行代码的地址。如果您的程序崩溃，可以使用映射文件确定崩溃发生的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T11:13:34.263

据我所知，映射文件提供了函数和变量到相对内存位置的映射。通常它们对程序员不是很有用。

要生成它们，请查看帮助文件，所有需要的信息都应该在那里。

# c - 如何在 Turbo C 的 C 代码中包含汇编代码？

> ID：233072
> 
> 赞同：0
> 
> 时间：2008-10-24T10:54:18.750
> 
> 标签：c, assembly, inline-assembly, tasm, turbo-c

如何在我的 C 程序中包含任何汇编代码行？

在 turbo c 中是否有可能将汇编代码文件 (.asm) 添加到少数 .c 文件的项目中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T11:03:25.797

包含汇编代码的一种方法是添加一个包装函数并将汇编代码写入 asm 块中，如下例所示：

```
void wrapper_function()
{
    asm
    {
        /* your assembly code */
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T11:18:17.123

您可以使用您的 makefile 为不同的目标类型定义操作。对于 C 类型（例如 foo.c），调用 C 编译器。对于 ASM 文件，调用汇编程序。任何一个的输出都应该是一个目标文件（例如 .o），它们都可以由链接器一起编译。

如果您有一点组装，请继续进行内联。否则，我建议将单独的模块和功能分解作为管理一切的最佳方式。特别是如果您需要支持不同的目标（即跨平台开发）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T11:15:33.230

您还可以链接到目标文件。但是内联汇编器更容易维护。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-11-10T18:00:03.433

```
void func()
{
asm://assembly statements...
asm://assembly statements...
...
} 
```

# crystal-reports - 在 Crystal Reports 中按两个字段分组

> ID：233073
> 
> 赞同：3
> 
> 时间：2008-10-24T10:54:26.207
> 
> 标签：crystal-reports, grouping

如何按水晶报表中的两个不同字段进行分组？

敌人示例：

```
val1|val2|val3|val6
val1|val12|val3|val7
val11|val2|val3|val8
val11|val12|val3|val9 
```

我希望报告看起来像

```
val1 :
=======
val2 
----
val3|val6

val12
-------
val3|val7

val11  :
=========
val2
-----
val3|val8

val12 :
------
val3|val9 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-24T17:12:24.450

提供的通用数据比较模糊，所以我将提供自己的数据来演示（第一行带有字段名称）

```
"EmployeeName","WeekNumber","DayOfWeek","HoursWorked"
“约翰·多伊”，20，“星期一”，8
“约翰·多伊”，20，“星期二”，8
“约翰·多伊”，20，“星期三”，8
“约翰·多伊”，21，“星期四”，8
“约翰·多伊”，21，“星期五”，8
“简·多伊”，20，“星期一”，8
“简·多伊”，20，“星期二”，8
“简·多伊”，21，“星期三”，8
“简·多伊”，21，“星期四”，8
“简·多伊”，21，“星期五”，8

```

假设我正确阅读了问题，您会希望报告如下所示：

```
约翰·多伊
   周：20
      周一 8 小时
      周二 8 小时
      周三 8 小时
   周：21
      星期四 8 小时
      周五 8 小时

简·多伊
   周：20
      周一 8 小时
      周二 8 小时
   周：21
      周三 8 小时
      星期四 8 小时
      周五 8 小时
```

如果是这种情况，您将首先按“EmployeeName”字段分组，然后通过“插入”菜单使用“组”选项简单地为“WeekNumber”添加另一个组。这非常简单，您可以对各个级别的字段进行汇总。唯一会使多层分组变得“毛茸茸”的事情是，如果您正在计算组内的字段并希望将这些计算返回到更高级别的分组进行求和，这将需要在报告中声明全局变量。

值得一提的是，在过去的 7 年里，我一直在大量使用 Crystal Reports。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T13:08:03.350

不确定最佳实践，但我过去做过类似的事情是在第一组中使用它自己的分组的子报告。

所以它看起来像这样：

MainReportHeader SubReport(?) SubreportHeader 值 SubReportFooter MainReportFooter

再说一次，不是水晶专家，只是一个想法和我以前用过的东西。可能有一个更简单的方法。

# regex - 正则表达式令牌查找和替换

> ID：233074
> 
> 赞同：0
> 
> 时间：2008-10-24T10:54:30.073
> 
> 标签：regex, notepad++

请有人帮我写一个正则表达式来替换 0044 标记，它将在字符串的开头用 0 替换。请注意，我不想用 0 替换所有 0044 标记，只有那些出现在开头的标记字符串。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-24T13:12:29.097

如果您真的想使用正则表达式，上面已经回答了。IE

找什么：`^0044`

用。。。来代替：`0`

但这是一种粗略的方法：

按 ALT，然后`044`使用鼠标垂直选择所有 ' 并删除它们。进行选择时按住 ALT。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T10:56:04.127

在 perl 中：

```
s/^0044/0/; 
```

这`^`意味着匹配只会发生在字符串的开头。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T13:02:26.903

那么为什么你不在搜索和替换框中的开头放置一个空格，我的意思是：

```
Search: " 0044"
Replace " 0" 
```

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T13:08:06.343

^ 在 notepad++ 中工作以匹配行的开头。

# c# - .NET 中的“obj”目录是什么？

> ID：233081
> 
> 赞同：66
> 
> 时间：2008-10-24T10:57:28.337
> 
> 标签：c#, .net

.NET 中“obj”目录的具体用途是什么？

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2008-10-24T10:59:31.953

“ **obj”文件夹**用于存储临时目标文件和其他用于在编译过程中创建最终二进制文件的文件。

“ **bin”文件夹**是完整二进制文件（程序集）的输出文件夹。

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2008-10-24T11:30:38.317

除了[splattne 的回答](https://stackoverflow.com/questions/233081/whats-the-obj-directory-for-in-net#233085)，我相信拥有它（而不是在构建后清理它）的原因是支持增量编译*。*如果您已经编译了 100 个类并更改了其中一个，那么只为一个更改的类重新编译代码并从新旧代码的混合中重新组装 exe/dll 会更有效。

当然，增量编译远比这复杂得多——它必须跟踪所有内容，以便检测何时需要重新编译一个类，即使该类本身没有更改。（例如，如果一个新的重载在一个类中可用 - 一些调用者可能需要重新编译。）

# web-services - 有没有人有任何可用于生成 Web 服务的 T4 示例模板？

> ID：233082
> 
> 赞同：1
> 
> 时间：2008-10-24T10:57:57.133
> 
> 标签：web-services, t4

有没有人有任何可用于生成 Web 服务的 T4 示例模板（或相同的链接）？

我在想这样一个事实，我猜 Webservice 不仅是 Vb 或 Cs 字段，而且还需要一个适当的 asmx 文件。

我真的不确定如何实现这一目标

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-30T16:39:39.743

[Oleg Sych：如何从单个 T4 模板生成多个输出](http://www.olegsych.com/2008/03/how-to-generate-multiple-outputs-from-single-t4-template/)；创建另一种生成 asmx 的方法 - 应该非常简单，因为它是一行 - 并将其呈现到文件中。

[T4 Toolbox](http://www.codeplex.com/t4toolbox)也有一些对此有帮助的方法。Oleg Sych 的网站还有其他文章可以指导您完成，特别是这些：

*   [T4 工具箱](http://www.olegsych.com/2008/08/t4-toolbox/)
*   [创建复杂的代码生成器](http://www.olegsych.com/2008/09/t4-tutorial-creating-complex-code-generators/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-30T11:54:32.463

也许[Web Service Software Factory](http://www.codeplex.com/servicefactory)会立即满足您的需求。据我了解，它使用您可以扩展的 T4 模板生成代码。

# pseudocode - 将卡路里转换为体重

> ID：233088
> 
> 赞同：0
> 
> 时间：2008-10-24T11:02:29.123
> 
> 标签：pseudocode

体重减轻/增加的基本方程是：

```
weight_change = convert_to_weight_diff(calories_consumed - calories_burnt); 
```

我要进行健康检查，就像一个好书呆子一样，我想我会开始跟踪这些事情并编写一些软件来处理我的数据。我不够专心和自律，无法计算食物中的卡路里，所以我想我会倒退：

*   我可以每天称体重
*   我可以计算我的 BMR 以及我整天无所事事燃烧多少卡路里
*   我可以使用我的心率监测器来计算我在运动中消耗了多少卡路里

这样我就可以根据我的锻炼和体重记录生成一个近似的“卡路里消耗”图表，并在我想吃甜甜圈时用它来激励自己。

我坚持的是功能：

```
int convert_to_weight_diff(int calorie_diff); 
```

有人知道那个函数的伪代码吗？如果您有一些详细信息，请确保您指定我们是否在谈论卡路里、卡路里、千焦耳、磅、公斤等。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-24T11:05:50.597

看看[黑客的饮食](http://www.fourmilab.ch/hackdiet/www/hackdiet.html)和[physicsdiet.com——](http://www.physicsdiet.com/)这个轮子已经被发明出来了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-24T11:08:46.613

我认为转换系数约为每磅 3500 卡路里。谷歌搜索（不是计算器！）似乎同意：[http ://www.google.com/search?q=calories+per+pound](http://www.google.com/search?q=calories+per+pound)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-03-14T04:13:18.540

我的意思是，如果这是你要找的东西，你应该做好准备。

假设，在爱因斯坦的相对论中，他指出卡路​​里确实具有精确的重量（0.000000000000046 克）。

话虽如此，这样的事情应该可以工作：

```
int convert_to_weight_diff(int calories)
{
    return 0.000000000000046 * calories;
} 
```

这将返回（以克为单位）减轻了多少重量。为了使它更合理，我会做一些事情，比如找出半磅或其他的卡路里含量。

从我读到的，这就是你想要做的。如果没有，请告诉我。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T11:08:40.060

我不知道这有多准确，因为它是维基百科，但它看起来像是经验法则的良好基础。

[http://en.wikipedia.org/wiki/Food_energy](http://en.wikipedia.org/wiki/Food_energy)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-24T11:12:51.863

因为你只会燃烧脂肪，所以对话如下：

要燃烧 1g 脂肪，您必须消耗 9kcal。

资料来源：[http ://en.wikipedia.org/wiki/Food_energy](http://en.wikipedia.org/wiki/Food_energy)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-24T12:10:10.767

我认为其他人都总结得很好，但是有些东西（也许更多）你已经忘记了：

水和兴奋剂（你的开发人员是对的，所以咖啡因是一种标准药物，就像沙丘中的香料一样）

例如，如果我一天有 2000cal 的食物，通过新陈代谢和运动我燃烧了 1750（我现在所有运动的东西，应该是 2500 左右），我还剩下 350cal，这就是脂肪，所以我'm 大约 +50 克（是 3500 卡 == 大约 500 克脂肪。不确定这是否正确，但暂时让我们去吧）

如果我明天做同样的事情，但我有 2 杯咖啡（请记住，我选择的咖啡是浓缩咖啡，里面没有其他东西，所以接近零卡路里），我必须考虑两件事：

*   咖啡因提高了我的新陈代谢，所以我燃烧得更多 - 所以我的燃烧可能是 +100cals
*   咖啡因是一种利尿剂，所以我会失去更多的水分 - 所以我的体重可能会下降 -200 克，这取决于我的身体对它的反应。

所以，我认为对于一个基本的想法，你的建议是一个很好的建议，但是一旦你开始变得更加具体，它就会变得非常复杂。

另一个例子：如果您正在锻炼，并且在跑步期间燃烧 500 卡路里，那么您将在之后的几个小时内继续燃烧卡路里。如果你通过举重训练燃烧 200 卡路里，你会在运动后做同样的燃烧（可能更多），并且你的基础代谢燃烧（如果你只是坐在你的背部，你会燃烧多少）会更高，直到肌肉萎缩回来无论以前是什么。

我认为你是对的 - 这不是一个真正的问题，但仍然很有趣。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-24T12:15:27.950

我要补充一点，您会在考虑中发现与 BMI 不同的测量方法，因为它没有考虑身体成分。例如，我记得看到一篇关于埃文德霍利菲尔德的文章基于他的高 BMI 被认为是“危险的肥胖”。他看起来几乎没有一盎司的脂肪。无论如何，只是一个考虑。

# singleton - 有没有一个名字意味着“不是单身”？

> ID：233107
> 
> 赞同：30
> 
> 时间：2008-10-24T11:10:59.323
> 
> 标签：singleton, naming, grammar

有没有一个名字意味着“不是单身”？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-24T11:19:21.210

Castle Windsor 使用术语“瞬态”来描述所有非单例对象。

不过，我个人更喜欢“非单例”这个词。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-24T12:19:00.920

是的，有一个[Multiton](http://en.wikipedia.org/wiki/Multiton_pattern)模式，但它意味着一些非常具体的东西。这不仅仅是不是单例的所有东西。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-24T11:26:12.287

原型。它用作 Spring 框架中的作用域，以识别注入时始终是新实例的依赖项。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-24T11:28:02.940

当有人问我一门课是否是单例课时（实际上不是），我只是说不，这是一门普通课。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-24T11:13:34.637

多实例？

[http://elegantcode.com/2008/04/17/the-opposite-of-a-singleton/](http://elegantcode.com/2008/04/17/the-opposite-of-a-singleton/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-24T11:23:30.127

实际上，Singleton 上有一个变体，称为 Multiton 或 Multiplton 或类似的东西。您有 n 个实例，其中 n 是一个特定值，而不是只有一个实例。我不确定这四人组是否在他们的书中描述了这个应用程序，但我在我的 Software Engineering 361 课程中了解到了它。

但是，如果您的实例数量不受限制，我认为它没有名称。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-24T11:21:37.150

简单地说，一个“类的单一实例”。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-05-02T04:44:05.970

这是一篇旧帖子，但如果有人仍然遇到，那么更好的词是“多路复用”而不是“瞬态”。恕我直言

定义：

名词：涉及沿单个通信通道同时传输多个消息的系统或信号。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-10-25T18:26:05.990

在[English Language & Usage](https://english.stackexchange.com/questions/104001/what-s-the-opposite-of-singleton)有一个相关的话题。浏览那里发布的各种建议，我认为最好的建议是

# 复制人

在我建立的一个 PHP 反射工厂中，我在方法的命名和注释的措辞中采用了这个术语。

# c# - .NET：如何检查泛型类型类中的类型？

> ID：233113
> 
> 赞同：15
> 
> 时间：2008-10-24T11:12:35.653
> 
> 标签：c#, .net, generics, types

如何在类中获取泛型类型类的类型？

一个例子：

我构建了一个实现*ICollection< T>*的通用类型化集合。在我里面我有这样的方法

```
 public void Add(T item){
        ...
    }

    public void Add(IEnumerable<T> enumItems){
        ...
    } 
```

我如何在给定类型*T*的方法中询问？

我的问题的原因是：如果*object*用作*​​ T*集合使用 Add(object item) 而不是 Add(IEnumerable<object> enumItems) 即使参数是 IEnumerable。因此，在第一种情况下，它将整个可枚举集合添加为一个对象，而不是可枚举集合的多个对象。

所以我需要类似的东西

```
if (T is object) {
    // Check for IEnumerable
} 
```

但这当然不能在 C# 中工作。建议？

非常感谢你！

迈克尔

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-10-24T11:15:09.033

您可以使用：`typeof(T)`

```
if (typeof(T) == typeof(object) ) {
    // Check for IEnumerable
} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-10-24T11:24:58.203

`IEnumerable<T>`就个人而言，我会通过将方法重命名为`AddRange`. 这避免了此类问题，并且与现有的 API 一致，例如[`List<T>.AddRange`](http://msdn.microsoft.com/en-us/library/z883w3dc.aspx).

`T`当您想添加工具时，它还可以保持清洁`IEnumerable<T>`（我承认很少见）。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-24T11:27:28.603

如果要`is`在泛型类/方法中使用运算符，则必须限制`T`为引用类型：

```
public void MyMethod<T>(T theItem) where T : class
{
    if (theItem is IEnumerable) { DoStuff(); }
} 
```

# java - AWT TextArea 似乎将 cr-lf 序列计为一个字符

> ID：233119
> 
> 赞同：0
> 
> 时间：2008-10-24T11:14:52.920
> 
> 标签：java, awt

我有这个问题：

从文件加载的文本“ABCD\r\nEFGHJ”与 java 正则表达式“EFGH”匹配。Matcher 对象当然表示匹配字符串的开头位于位置 6。匹配器将 \r \n 计为两个位置。

我将原始文本放在 AWT TextArea 组件中，然后调用 select(6,10) 以突出显示匹配的区域。你猜怎么着......它从“F”字母开始突出显示。一个位置比它应该的...

如果超过 1 对 crlf 在匹配区域之前，则突出显示会比应有的更向前移动。

任何人有任何简单的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-24T11:20:08.867

简单的解决方案：从文本中删除所有 \r ... :-P

不像听起来那么愚蠢，除非你有不一致的行尾（它可能发生）并且想要保持它们不变......这可能就是组件所做的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T14:20:56.213

如果 \r\n 一致，您可以在运行正则表达式之前删除 \r，然后在移交给下一个之前替换它们。或更改副本，如果效果更好。这样，您的正则表达式以与 AWT 所期望的一致的方式找到位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T12:11:23.667

我不能弄乱文本，因为它是协议数据，并且 \r 和 \n 字符具有与显示或行分隔无关的语义。我只想要一个组件，它将分别处理每个输入字符并将其视为一个显示和计数，无论它如何显示。

# visual-studio - 可以并排安装多个相同版本的 Visual Studio 套件吗？

> ID：233123
> 
> 赞同：1
> 
> 时间：2008-10-24T11:15:37.223
> 
> 标签：visual-studio, visual-studio-2008

我想知道我是否可以在同一台机器上安装说 Visual Studio 2008 Pro 和 Visual Studio 2008 标准。我已经尝试在 express 之后安装 pro（MSDN 上提供的试用版），并且似乎需要将它们安装在同一目录中。这是特定于快递版的吗？

我问这个的原因是为了支持在给定机器上自动检测 VS 编译器的构建工具（scons），而且我对非快速版本的 VS 不太熟悉。IOW，我不想并排运行它们，我只需要知道我是否应该在我的检测方案中处理并排安装。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-24T11:25:24.537

我不建议并排安装同一版本的多个版本。我可以想象它会对注册表造成严重破坏。如果您只需要有所有不同的版本可用于测试，我会使用虚拟机。

但是，您可以并排安装多个版本（例如 2003、2005 和 2008）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T11:26:30.633

我知道我在同一台机器上安装了快捷版和专业版。

您还可以使用[Microsoft Virtual PC](http://www.microsoft.com/downloads/details.aspx?FamilyId=04D26402-3199-48A3-AFA2-2DC0B40A73B6&displaylang=en)并在虚拟机上安装其他版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T11:43:55.873

您可以并排安装 Visual Studio 和每个[Express Edition ，但不能同时安装一堆 Visual Studio。](http://www.microsoft.com/Express/)

如果您需要关闭它们，我会同意虚拟机的想法。

# c++ - 如何在线程之间传播异常？

> ID：233127
> 
> 赞同：117
> 
> 时间：2008-10-24T11:17:09.483
> 
> 标签：c++, multithreading, exception

我们有一个单线程调用的函数（我们将其命名为主线程）。在函数体内，我们生成多个工作线程来执行 CPU 密集型工作，等待所有线程完成，然后在主线程上返回结果。

结果是调用者可以天真地使用该函数，并且在内部它将使用多个内核。

*到目前为止一切都很好。。*

我们遇到的问题是处理异常。我们不希望工作线程上的异常导致应用程序崩溃。我们希望函数的调用者能够在主线程上捕获它们。我们必须在工作线程上捕获异常并将它们传播到主线程以让它们继续从那里展开。

***我们应该怎么做？***

我能想到的最好的是：

1.  在我们的工作线程上捕获各种各样的异常（std::exception 和我们自己的一些）。
2.  记录异常的类型和消息。
3.  在主线程上有一个相应的 switch 语句，它重新抛出工作线程上记录的任何类型的异常。

这具有仅支持有限的异常类型集的明显缺点，并且在添加新异常类型时需要修改。

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2015-09-06T21:22:21.640

C++11 引入了`exception_ptr`允许在线程之间传输异常的类型：

```
#include<iostream>
#include<thread>
#include<exception>
#include<stdexcept>

static std::exception_ptr teptr = nullptr;

void f()
{
    try
    {
        std::this_thread::sleep_for(std::chrono::seconds(1));
        throw std::runtime_error("To be passed between threads");
    }
    catch(...)
    {
        teptr = std::current_exception();
    }
}

int main(int argc, char **argv)
{
    std::thread mythread(f);
    mythread.join();

    if (teptr) {
        try{
            std::rethrow_exception(teptr);
        }
        catch(const std::exception &ex)
        {
            std::cerr << "Thread exited with exception: " << ex.what() << "\n";
        }
    }

    return 0;
} 
```

因为在您的情况下，您有多个工作线程，您需要`exception_ptr`为每个工作线程保留一个。

请注意，这`exception_ptr`是一个类似 ptr 的共享指针，因此您需要至少保留一个`exception_ptr`指向每个异常的指针，否则它们将被释放。

Microsoft 特定：如果您使用 SEH 异常 ( `/EHa`)，示例代码还将传输 SEH 异常，例如访问冲突，这可能不是您想要的。

* * *

## 回答 #2

> 赞同：76
> 
> 时间：2008-10-24T13:47:00.353

目前，唯一**可移植**的方法是为您可能希望在线程之间传输的所有类型的异常编写 catch 子句，将信息存储在该 catch 子句的某个位置，然后稍后使用它来重新引发异常。这是[Boost.Exception](http://www.boost.org/doc/libs/1_36_0/libs/exception/doc/boost-exception.html)采用的方法。

在 C++0x 中，您将能够捕获异常，`catch(...)`然后将其存储在`std::exception_ptr`using的实例中`std::current_exception()`。然后，您可以稍后从相同或不同的线程重新抛出它`std::rethrow_exception()`。

如果您使用的是 Microsoft Visual Studio 2005 或更高版本，那么[just::thread C++0x 线程库](http://www.stdthread.co.uk)支持`std::exception_ptr`. （免责声明：这是我的产品）。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-01-25T01:18:58.130

如果您使用的是 C++11，那么`std::future`可能会做您正在寻找的事情：它可以自动捕获使其到达工作线程顶部的异常，并将它们传递给父`std::future::get`线程叫。（在幕后，这与@AnthonyWilliams 的回答完全相同；它已经为您实施了。）

不利的一面是没有标准的方法来“停止关心” a `std::future`；甚至它的析构函数也会简单地阻塞，直到任务完成。**[编辑，2017 年：阻塞析构函数行为*只是*从返回的伪期货的错误特征`std::async`，无论如何你都不应该使用它。正常的期货不会阻塞它们的析构函数。但是，如果您正在使用，您仍然不能“取消”任务`std::future`：即使没有人再听答案，履行承诺的任务仍将继续在幕后运行。]**这是一个玩具示例，可能会澄清我意思是：

```
#include <atomic>
#include <chrono>
#include <exception>
#include <future>
#include <thread>
#include <vector>
#include <stdio.h>

bool is_prime(int n)
{
    if (n == 1010) {
        puts("is_prime(1010) throws an exception");
        throw std::logic_error("1010");
    }
    /* We actually want this loop to run slowly, for demonstration purposes. */
    std::this_thread::sleep_for(std::chrono::milliseconds(100));
    for (int i=2; i < n; ++i) { if (n % i == 0) return false; }
    return (n >= 2);
}

int worker()
{
    static std::atomic<int> hundreds(0);
    const int start = 100 * hundreds++;
    const int end = start + 100;
    int sum = 0;
    for (int i=start; i < end; ++i) {
        if (is_prime(i)) { printf("%d is prime\n", i); sum += i; }
    }
    return sum;
}

int spawn_workers(int N)
{
    std::vector<std::future<int>> waitables;
    for (int i=0; i < N; ++i) {
        std::future<int> f = std::async(std::launch::async, worker);
        waitables.emplace_back(std::move(f));
    }

    int sum = 0;
    for (std::future<int> &f : waitables) {
        sum += f.get();  /* may throw an exception */
    }
    return sum;
    /* But watch out! When f.get() throws an exception, we still need
     * to unwind the stack, which means destructing "waitables" and each
     * of its elements. The destructor of each std::future will block
     * as if calling this->wait(). So in fact this may not do what you
     * really want. */
}

int main()
{
    try {
        int sum = spawn_workers(100);
        printf("sum is %d\n", sum);
    } catch (std::exception &e) {
        /* This line will be printed after all the prime-number output. */
        printf("Caught %s\n", e.what());
    }
} 
```

我只是尝试使用`std::thread`and编写一个类似工作的示例`std::exception_ptr`，但是（使用 libc++）出了点问题，`std::exception_ptr`所以我还没有让它真正工作。:(

**[编辑，2017：**

```
int main() {
    std::exception_ptr e;
    std::thread t1([&e](){
        try {
            ::operator new(-1);
        } catch (...) {
            e = std::current_exception();
        }
    });
    t1.join();
    try {
        std::rethrow_exception(e);
    } catch (const std::bad_alloc&) {
        puts("Success!");
    }
} 
```

**我不知道我在 2013 年做错了什么，但我确信这是我的错。]**

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-24T11:48:24.337

您的问题是您可能会收到来自多个线程的多个异常，因为每个线程都可能失败，可能是由于不同的原因。

我假设主线程以某种方式等待线程结束以检索结果，或者定期检查其他线程的进度，并且对共享数据的访问是同步的。

## 简单的解决方案

简单的解决方案是捕获每个线程中的所有异常，将它们记录在共享变量中（在主线程中）。

所有线程完成后，决定如何处理异常。这意味着所有其他线程继续其处理，这可能不是您想要的。

## 复杂的解决方案

更复杂的解决方案是让每个线程在其执行的战略点检查，如果从另一个线程抛出异常。

如果线程抛出异常，在退出线程之前被捕获，异常对象被复制到主线程中的某个容器中（就像在简单的解决方案中一样），并将某个共享布尔变量设置为 true。

当另一个线程测试这个布尔值时，它看到执行将被中止，并以一种优雅的方式中止。

当所有线程都中止时，主线程可以根据需要处理异常。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-24T11:54:29.927

从线程抛出的异常将无法在父线程中捕获。线程具有不同的上下文和堆栈，通常不需要父线程留在那里等待子线程完成，以便它可以捕获它们的异常。代码中根本没有该捕获的位置：

```
try
{
  start thread();
  wait_finish( thread );
}
catch(...)
{
  // will catch exceptions generated within start and wait, 
  // but not from the thread itself
} 
```

您将需要在每个线程内捕获异常并解释主线程中线程的退出状态以重新抛出您可能需要的任何异常。

顺便说一句，在线程中没有捕获的情况下，是否完全展开堆栈是特定于实现的，即在调用终止之前甚至可能不会调用自动变量的析构函数。一些编译器会这样做，但这不是必需的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-24T11:45:14.233

您能否在工作线程中序列化异常，将其传输回主线程，反序列化并再次抛出？我希望要使其正常工作，异常都必须源自同一个类（或者至少是一小组带有 switch 语句的类）。另外，我不确定它们是否可以序列化，我只是在大声思考。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-24T11:39:38.033

确实，没有好的通用方法可以将异常从一个线程传输到下一个线程。

如果你的所有异常都从 std::exception 派生，那么你可以有一个顶级的通用异常捕获，它会以某种方式将异常发送到将再次抛出的主线程。问题是你失去了异常的抛出点。您可能可以编写依赖于编译器的代码来获取此信息并传输它。

如果不是所有的异常都继承了 std::exception，那么你就有麻烦了，必须在你的线程中编写很多顶级 catch ......但解决方案仍然成立。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-24T11:47:16.057

您将需要对工作线程中的所有异常（包括非标准异常，如访问冲突）进行通用捕获，并从工作线程（我想您有某种消息传递？）发送消息到控制线程，包含指向异常的活动指针，并通过创建异常的副本重新抛出该异常。然后工人可以释放原始对象并退出。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-01-14T07:55:53.577

请参阅[http://www.boost.org/doc/libs/release/libs/exception/doc/tutorial_exception_ptr.html](http://www.boost.org/doc/libs/release/libs/exception/doc/tutorial_exception_ptr.html)。也可以为您调用的任何函数编写一个包装函数来加入子线程，该函数会自动重新抛出（使用 boost::rethrow_exception）子线程发出的任何异常。

# regex - 用“NA”替换空的逗号分隔字段的正则表达式

> ID：233141
> 
> 赞同：1
> 
> 时间：2008-10-24T11:23:28.707
> 
> 标签：regex

我有一个逗号分隔的字符串列表，如下所示。

```
a,b   ,c ,d, ,      , , ,e, f,g,h  . 
```

我想编写一个正则表达式来替换空值，即只包含空格到“NA”的字符串。所以结果应该是

```
a,b   ,c ,d,NA,NA,NA,NA,e, f,g,h  . 
```

我尝试使用 ",\s+," 进行搜索，但它会跳过备用的空字符串并导致

```
a,b   ,c ,d,NA,      ,NA, ,e, f,g,h  . 
```

在这里使用的正确正则表达式是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-24T11:30:11.297

`(?<=,)\s+(?=,)`

这是逗号的后视，然后是空格，然后是逗号的前瞻

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T12:03:23.777

这个给你：

回声 a,b ,c ,d, , , , ,e, f,g,h 。| perl -p -e 's/, +[^az|AZ]/,Na/g'

或者：

回声 a,b ,c ,d, , , , ,e, f,g,h 。| perl -p -e 's/, +\S/,Na/g'

如果您也想让它与非 aZ 字符一起使用（感谢您的评论:)

# visual-studio - Visual Studio 2008 - 在文件中查找：列出所有内容两次

> ID：233147
> 
> 赞同：7
> 
> 时间：2008-10-24T11:25:01.493
> 
> 标签：visual-studio, visual-studio-2008

在 VS2008 中，我有一个网站项目。当我在文件中使用查找并搜索字符串时，查找结果窗口将列出每个出现两次。

这可能是什么原因造成的？

[编辑]

下面是 VS 的屏幕截图。我正在我的网站项目中搜索工作 CommissionBucketProductID。请注意，每行返回两次。

![屏幕截图](https://i.stack.imgur.com/LXSyr.gif)

[编辑2]

在回答你的问题。我只是在项目中搜索，而不是整个解决方案。我目前在 VSS 下没有这些文件，尽管它们是过去的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-08-12T18:59:01.000

我有同样的问题，这很烦人。我刚刚修好了。我所做的是在搜索时在“查找”字段中将“整个解决方案”更改为“当前项目”。然后我注意到结果不会翻倍。在我切换回“完整解决方案”后，问题就消失了。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-24T15:36:52.160

如果您确实在“整个解决方案”中找到，它还会搜索任何已加载的文件，即使它们已经在解决方案中。这意味着它们将被列出两次。

也许这是你的问题？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-27T01:07:16.740

我使用 VS2003，但是当我在多个项目中拥有相同的源文件时，我得到了这个确切的结果。您确定您搜索的不是多个项目吗？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-06-25T20:49:13.557

这是你的答案：

[在文件中查找两次搜索相同的文件](http://connect.microsoft.com/VisualStudio/feedback/details/489209/find-in-files-searches-same-files-twice)

这似乎发生在同一解决方案中多个项目之间共享的文件上，导致它们被搜索两次。由于问题存在于 VS2010 中，它一定是从 VS2008 继承的，这可能意味着您非常不走运（除非您解决它，例如将项目分成多个解决方案）。

但与此同时，听起来它在微软的优先级列表中还不够高，无法解决这个问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-27T00:13:13.217

您是否有任何指向同一搜索范围内的目录/文件的符号链接？这可能导致文件被列出两次：一次用于主文件，一次用于文件链接。尽管从内存中它应该显示第二次出现的链接目录，而不是链接指向的文件（这与您的屏幕截图中的内容不一致）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-27T01:29:37.460

尝试关闭 VS2008，重命名文件（USPostalApplciation.aspx 和文件后面的代码），然后重新打开 VS2008，刷新您能想到的所有内容（项目、解决方案等），然后再次尝试搜索。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-20T21:30:06.580

确保您的 Web 项目没有任何指向站点其他区域的虚拟目录。

验证 VS2008 是否显示与 IIS 相同的虚拟目录（如果有）。

如果您错误指向或配置错误的虚拟目录，将导致巨大的性能损失、搜索结果复制等。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-05-19T17:36:18.140

我有一个类似的问题。VS 会从我在 IDE 中加载的文件中找到解决方案结果，只是为了查看它们，然后再次关闭。所以它会搜索甚至不在解决方案中的文件。

我扫描了解决方案中的所有文件，但没有引用存储在任何地方的这些幻像文件。最后我决定扫描注册表，发现它们存储在 MRU 列表中。删除 MRU 列表条目后，恢复了预期的行为。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-21T09:55:43.773

这是一个旧线程，但这仍然会发生。

作为新信息，我刚刚发现该解决方案包含一个安装项目，除了解决方案本身之外，它自然地引用了一些项目。

在这种情况下，当搜索整个解决方案时，某些文件有两条路径。

# objective-c - 通过指针算术访问数组值与 C 中的下标

> ID：233148
> 
> 赞同：39
> 
> 时间：2008-10-24T11:25:05.957
> 
> 标签：objective-c, c, arrays, pointers, pointer-arithmetic

我一直在读到，在 C 中，使用指针算法通常比下标访问数组更快。即使使用现代（据说是优化的）编译器也是如此吗？

如果是这样，当我开始在 Mac 上从学习 C 转向 Objective-C 和[Cocoa时，情况是否仍然如此？](http://en.wikipedia.org/wiki/Cocoa_%28API%29)

在 C 和 Objective-C 中，哪种是数组访问的首选编码风格？哪个（由各自语言的专业人士）认为更清晰，更“正确”（因为没有更好的术语）？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2008-10-24T11:31:32.263

您需要了解此声明背后的原因。你有没有问过自己为什么它更快？让我们比较一些代码：

```
int i;
int a[20];

// Init all values to zero
memset(a, 0, sizeof(a));
for (i = 0; i < 20; i++) {
    printf("Value of %d is %d\n", i, a[i]);
} 
```

它们都为零，真是令人惊讶：-P 问题是，`a[i]`在低级机器代码中实际上意味着什么？它的意思是

1.  取`a`内存中的地址。

2.  将`i`单个项目的大小乘`a`以该地址（int 通常是四个字节）。

3.  从该地址获取值。

因此，每次从 中获取值时`a`，都会将 的基地址`a`添加到乘以`i`4 的结果中。如果你只是取消引用一个指针，步骤 1\. 和 2\. 不需要执行，只需要执行步骤 3。

考虑下面的代码。

```
int i;
int a[20];
int * b;

memset(a, 0, sizeof(a));
b = a;
for (i = 0; i < 20; i++) {
    printf("Value of %d is %d\n", i, *b);
    b++;
} 
```

这段代码**可能**会更快......但即使是这样，差异也很小。为什么会更快？"*b" 与上面的第 3 步相同。但是，“b++”与第1步和第2步不一样。“b++”会将指针增加4。

> （**对新手很重要**：`++` 在指针上运行不会将指针在内存中增加一个字节！它会将指针在内存中增加与它指向的数据大小一样多的字节。它指向一个`int`并且 `int`是四个字节我的机器，所以 b++ 将 b 增加四！）

好的，但为什么会更快？因为将四加到指针上比乘以`i`四并将其加到指针上要快。无论哪种情况，您都有一个加法，但在第二种情况下，您没有乘法（您避免了一次乘法所需的 CPU 时间）。考虑到现代 CPU 的速度，即使阵列是 1 个 mio 元素，我想知道您是否真的可以对差异进行基准测试。

现代编译器可以将其中任何一个优化为同样快，您可以通过查看它产生的汇编输出来检查这一点。您可以通过将“-S”选项（大写 S）传递给 GCC 来实现。

这是第一个 C 代码的代码（`-Os`已使用优化级别，这意味着针对代码大小和速度进行优化，但不要进行会显着增加代码大小的速度优化，不同`-O2`和非常不同`-O3`）：

```
_main:
    pushl   %ebp
    movl    %esp, %ebp
    pushl   %edi
    pushl   %esi
    pushl   %ebx
    subl    $108, %esp
    call    ___i686.get_pc_thunk.bx
"L00000000001$pb":
    leal    -104(%ebp), %eax
    movl    $80, 8(%esp)
    movl    $0, 4(%esp)
    movl    %eax, (%esp)
    call    L_memset$stub
    xorl    %esi, %esi
    leal    LC0-"L00000000001$pb"(%ebx), %edi
L2:
    movl    -104(%ebp,%esi,4), %eax
    movl    %eax, 8(%esp)
    movl    %esi, 4(%esp)
    movl    %edi, (%esp)
    call    L_printf$stub
    addl    $1, %esi
    cmpl    $20, %esi
    jne L2
    addl    $108, %esp
    popl    %ebx
    popl    %esi
    popl    %edi
    popl    %ebp
    ret 
```

与第二个代码相同：

```
_main:
    pushl   %ebp
    movl    %esp, %ebp
    pushl   %edi
    pushl   %esi
    pushl   %ebx
    subl    $124, %esp
    call    ___i686.get_pc_thunk.bx
"L00000000001$pb":
    leal    -104(%ebp), %eax
    movl    %eax, -108(%ebp)
    movl    $80, 8(%esp)
    movl    $0, 4(%esp)
    movl    %eax, (%esp)
    call    L_memset$stub
    xorl    %esi, %esi
    leal    LC0-"L00000000001$pb"(%ebx), %edi
L2:
    movl    -108(%ebp), %edx
    movl    (%edx,%esi,4), %eax
    movl    %eax, 8(%esp)
    movl    %esi, 4(%esp)
    movl    %edi, (%esp)
    call    L_printf$stub
    addl    $1, %esi
    cmpl    $20, %esi
    jne L2
    addl    $124, %esp
    popl    %ebx
    popl    %esi
    popl    %edi
    popl    %ebp
    ret 
```

嗯，这是不同的，这是肯定的。104 和 108 的数字差异来自变量`b`（在第一个代码中，堆栈上少了一个变量，现在我们多了一个，改变了堆栈地址）。`for`循环中真正的代码差异是

```
movl    -104(%ebp,%esi,4), %eax 
```

相比

```
movl    -108(%ebp), %edx
movl    (%edx,%esi,4), %eax 
```

实际上在我看来，第一种方法看起来更快（！），因为它发出一个 CPU 机器代码来执行所有工作（CPU 为我们完成所有工作），而不是有两个机器代码。另一方面，下面的两个汇编命令的运行时间可能比上面的要短。

作为结束语，我会说取决于您的编译器和 CPU 功能（CPU 提供什么命令以何种方式访问​​内存），结果可能是任何一种方式。任何一个都可能更快/更慢。除非您将自己完全限制在一个编译器（也意味着一个版本）和一个特定的 CPU 上，否则您无法确定。由于 CPU 在单个汇编命令中可以做越来越多的事情（很久以前，编译器确实必须手动获取地址，乘以`i`4，然后在获取值之前将两者相加），过去曾经是绝对真理的语句现在是现在越来越有问题了。还有谁知道 CPU 在内部是如何工作的？在上面，我将一个汇编指令与另外两个汇编指令进行了比较。

我可以看到指令的数量不同，并且此类指令所需的时间也可能不同。此外，这些指令在它们的机器表示中需要多少内存（毕竟它们需要从内存传输到 CPU 缓存）是不同的。但是，现代 CPU 不会按照您提供指令的方式执行指令。他们将大指令（通常称为 CISC）拆分为小的子指令（通常称为 RISC），这也使他们能够更好地优化程序流程以提高内部速度。事实上，第一条指令和下面的另外两条指令可能会导致*相同的子指令集*，在这种情况下，无论如何都没有可测量的速度差异。

关于Objective-C，它只是带有扩展的C。因此，所有适用于 C 的东西都适用于 Objective-C，就指针和数组而言也是如此。另一方面，如果您使用对象（例如，一个`NSArray`或`NSMutableArray`），这是一个完全不同的野兽。但是，在这种情况下，无论如何您都必须使用方法访问这些数组，没有指针/数组访问可供选择。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-24T11:31:56.753

> “使用指针算法通常比数组访问下标更快”

不。无论哪种方式都是相同的操作。下标是将（元素大小*索引）添加到数组的起始地址的语法糖。

也就是说，当迭代数组中的元素时，每次通过循环获取指向第一个元素的指针并增加它通常比每次从循环变量中计算当前元素的位置要快一些。（尽管这在现实生活中的应用程序中很重要。首先检查你的算法，过早的优化是万恶之源，等等）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-24T12:02:20.033

这可能有点离题（抱歉），因为它没有回答您关于执行速度的问题，但您应该考虑*过早优化是万恶之*源（Knuth）。在我看来，特别是在（重新）学习语言时，一定要以最容易阅读的方式编写它。然后，如果您的程序运行**正确**，请考虑优化速度。无论如何，大多数情况下你的代码都会足够快。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-24T12:25:43.857

Mecki 有一个很好的解释。根据我的经验，索引与指针之间通常很重要的一件事是循环中的其他代码。例子：

```
#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include <iostream>

using namespace std;

typedef int64_t int64;
static int64 nsTime() {
  struct timespec tp;
  clock_gettime(CLOCK_REALTIME, &tp);
  return tp.tv_sec*(int64)1000000000 + tp.tv_nsec;
}

typedef int T;
size_t const N = 1024*1024*128;
T data[N];

int main(int, char**) {
  cout << "starting\n";

  {
    int64 const a = nsTime();
    int sum = 0;
    for (size_t i=0; i<N; i++) {
      sum += data[i];
    }
    int64 const b = nsTime();
    cout << "Simple loop (indexed): " << (b-a)/1e9 << "\n";
  }

  {
    int64 const a = nsTime();
    int sum = 0;
    T *d = data;
    for (size_t i=0; i<N; i++) {
      sum += *d++;
    }
    int64 const b = nsTime();
    cout << "Simple loop (pointer): " << (b-a)/1e9 << "\n";
  }

  {
    int64 const a = nsTime();
    int sum = 0;
    for (size_t i=0; i<N; i++) {
      int a = sum+3;
      int b = 4-sum;
      int c = sum+5;
      sum += data[i] + a - b + c;
    }
    int64 const b = nsTime();
    cout << "Loop that uses more ALUs (indexed): " << (b-a)/1e9 << "\n";
  }

  {
    int64 const a = nsTime();
    int sum = 0;
    T *d = data;
    for (size_t i=0; i<N; i++) {
      int a = sum+3;
      int b = 4-sum;
      int c = sum+5;
      sum += *d++ + a - b + c;
    }
    int64 const b = nsTime();
    cout << "Loop that uses more ALUs (pointer): " << (b-a)/1e9 << "\n";
  }
} 
```

在基于 Core 2 的快速系统（g++ 4.1.2，x64）上，时间如下：

```
    简单循环（索引）：0.400842
    简单循环（指针）：0.380633
    使用更多 ALU（索引）的循环：0.768398
    使用更多 ALU（指针）的循环：0.777886

```

有时索引更快，有时指针算法更快。这取决于 CPU 和编译器如何能够流水线化循环执行。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-24T11:31:54.803

如果您正在处理数组类型的数据，我会说使用下标使代码更具可读性。在今天的机器上（尤其是对于像这样简单的东西），可读的代码更为重要。

现在，如果您正在显式处理您 malloc() 的一大块数据，并且您想在该数据中获取一个指针，例如音频文件头中的 20 个字节，那么我认为地址算术更清楚地表达了您的意思试图做。

~~我不确定这方面的编译器优化，但即使下标速度较慢，它最多也只会慢几个时钟周期。当你可以从清晰的思路中获得更多收益时，这几乎不算什么。~~

编辑：根据其他一些回复，下标只是一个句法元素，对性能没有影响，就像我想的那样。在这种情况下，绝对要使用您试图通过访问指针指向的块内的数据来表达的任何上下文。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-24T12:18:38.660

请记住，即使使用超标量 cpu 等查看机器代码，执行速度也很难预测

*   乱序执行
*   流水线
*   分支预测
*   超线程
*   ...

它不仅仅是计算机器指令，甚至不仅仅是计算时钟周期。在真正需要的情况下进行测量似乎更容易。即使计算给定程序的正确循环计数并非不可能（我们必须在大学里这样做），但这并不有趣而且很难做到正确。旁注：在多线程/多处理器环境中正确测量也很困难。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-24T11:32:01.683

这不是真的。它与下标运算符一样快。在 Objective-C 中，您可以像在 C 和面向对象风格中那样使用数组，其中面向对象风格要慢得多，因为由于调用的动态特性，它在每次调用中都会进行一些操作。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-24T11:44:20.150

```
char p1[ ] = "12345";
char* p2 = "12345";

char *ch = p1[ 3 ]; /* 4 */
ch = *(p2 + 3); /* 4 */ 
```

C标准没有说哪个更快。在可观察的行为上是相同的，编译器可以按照它想要的任何方式来实现它。通常情况下，它甚至根本不会读取内存。

通常，除非您指定编译器、版本、体系结构和编译选项，否则您无法说出哪个“更快”。即使这样，优化也将取决于周围的环境。

所以一般的建议是使用任何能提供更清晰和更简单代码的东西。使用 array[ i ] 提供了一些工具来尝试查找索引超出范围的条件，因此如果您使用数组，最好将它们视为此类。

如果它很重要 - 查看编译器生成的汇编程序。但请记住，它可能会随着您更改围绕它的代码而改变。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-24T12:32:34.683

不，使用指针算术并不是更快，而且很可能更慢，因为优化编译器可能会使用英特尔处理器上的 LEA（加载有效地址）等指令或其他处理器上的类似指令来进行指针算术，这比 add 或 add/mul 更快。它的优点是一次做几件事而不影响标志，而且它也需要一个周期来计算。顺便说一句，以下来自 GCC 手册。所以`-Os`主要不是针对速度进行优化。

我也完全同意themarko。首先尝试编写干净、可读和可重用的代码，然后考虑优化并使用一些 profiling 工具找到瓶颈。大多数时候，性能问题是与 I/O 相关的，或者是一些糟糕的算法或一些你必须寻找的错误。[高德纳](http://en.wikipedia.org/wiki/Donald_Knuth)是男人 ;-)

我突然想到，你会用结构数组做什么。如果你想做指针运算，那么你肯定应该为结构的每个成员做。听起来是不是有点矫枉过正？是的，这当然是矫枉过正，也为掩盖错误打开了一扇大门。

> `-Os`优化大小。`Os`启用通常不会增加代码大小的所有 O2 优化。它还执行旨在减少代码大小的进一步优化。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-24T11:33:12.883

速度上不太可能有任何差异。

使用数组运算符 [] 可能是首选，因为在 C++ 中，您可以对其他容器（例如向量）使用相同的语法。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-03-01T22:12:18.580

我已经为几个[AAA](https://en.wikipedia.org/wiki/AAA_(video_game_industry))游戏进行 C++/汇编优化 10 年了，我可以说，在我研究过的**特定平台/编译器**上，*指针算法*产生了相当大的差异。

作为一个透视的例子，我能够在我们的粒子生成器中创建一个非常紧密的循环，速度提高 40%，方法是用指针算法替换所有数组访问，这让我的同事完全不相信。以前我从我的一位老师那里听说它是一个很好的技巧，但我认为它不会对我们今天拥有的编译器/CPU 产生影响。我错了 ;）

必须指出的是，许多控制台[ARM](https://en.wikipedia.org/wiki/ARM_architecture)处理器没有现代[CISC](https://en.wikipedia.org/wiki/Complex_instruction_set_computer) CPU 的所有可爱功能，而且编译器有时有点不稳定。

# mysql - 使用特殊字符时MySQL更新错误

> ID：233165
> 
> 赞同：1
> 
> 时间：2008-10-24T11:31:16.053
> 
> 标签：mysql, asp-classic, special-characters

我想知道是否有人以前遇到过这个。我有一个客户在他们的产品描述字段中使用了特殊字符。如果我们使用它们的 HTML 等价物，更新到 MySQL 数据库可以正常工作，但如果使用字符本身（我假设从字符映射或 Word 复制）则失败。

有没有人见过这种行为？在这种情况下，有问题的字符是 ø - 我们似乎无法对其进行替换（至少在 ASP 中），因为该字符以“？”的形式出现在 SQL 字符串中。

任何建议都非常感谢 - 谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T11:42:04.257

这表明您的数据库（连接）和实际数据之间的字符集不匹配。

最有可能的是，您在您的站点上使用 ISO-8859-1，但 MySQL 认为它应该使用 UTF-8。

[http://dev.mysql.com/doc/refman/5.0/en/charset-connection.html](http://dev.mysql.com/doc/refman/5.0/en/charset-connection.html)描述了要检查的内容以及如何更改它。最简单的方法可能是在连接到数据库时运行查询“SET NAMES latin1”（假设这是您需要的字符集）。

作为 Unicode 的粉丝，我建议完全切换到 UTF-8，但我意识到这并不总是一个可行的选择。

编辑：@markokocic：排序规则仅规定排序顺序。尽管这当然应该与您的字符集匹配，但它不会影响可以存储在字段中的字符范围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T11:41:12.480

您是否尝试将表的排序规则设置为 utf-8 或非 latin1/ascii。

# java - 在 Clojure 中做 GUI 的最佳方法是什么？

> ID：233171
> 
> 赞同：153
> 
> 时间：2008-10-24T11:31:58.533
> 
> 标签：java, user-interface, lisp, clojure

[在Clojure](http://en.wikipedia.org/wiki/Clojure)中做 GUI 的最佳方法是什么？

是否有一些功能性[Swing](http://en.wikipedia.org/wiki/Swing_%28Java%29)或[SWT](http://en.wikipedia.org/wiki/Standard_Widget_Toolkit)包装器的示例？[或者与JavaFX](http://en.wikipedia.org/wiki/JavaFX)声明性 GUI 描述的一些集成，可以使用一些宏观很容易地包装到[s 表达式](http://en.wikipedia.org/wiki/S-expression)？

有教程吗？

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2011-05-10T02:55:45.843

我会谦虚地建议[Seesaw](https://github.com/daveray/seesaw)。

[这是一个基于 REPL 的教程](https://gist.github.com/1441520)，假设没有 Java 或 Swing 知识。

* * *

跷跷板很像@tomjen 所建议的。这是“你好，世界”：

```
(use 'seesaw.core)

(-> (frame :title "Hello"
       :content "Hello, Seesaw"
       :on-close :exit)
  pack!
  show!) 
```

这是@Abhijith 和@dsm 的示例，按字面意思翻译：

```
(ns seesaw-test.core
  (:use seesaw.core))

(defn handler
  [event]
  (alert event
    (str "<html>Hello from <b>Clojure</b>. Button "
      (.getActionCommand event) " clicked.")))

(-> (frame :title "Hello Swing" :on-close :exit
           :content (button :text "Click Me" :listen [:action handler]))
  pack!
  show!) 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2010-01-31T12:17:16.163

Stuart Sierra 最近发表了一系列关于使用 clojure（和 swing）进行 GUI 开发的博客文章。从这里开始：[http ://stuartsierra.com/2010/01/02/first-steps-with-clojure-swing](http://stuartsierra.com/2010/01/02/first-steps-with-clojure-swing)

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-10-25T12:19:06.873

如果您想做 GUI 编程，我会指向[Temperature Converter](http://en.wikibooks.org/wiki/Clojure_Programming#Simple_GUI_:_Temperature_Converter)或[ant Colony](http://clojure.googlegroups.com/web/ants.clj)。

Swing 中的许多事情都是通过子类化完成的，尤其是在创建自定义组件时。为此，有两个基本功能/宏：[代理](http://clojure.org/api#toc383)和[gen-class](http://clojure.org/api#toc234)。

现在我明白了你用更 Lispy 的方式要去哪里。我认为还没有这样的事情。我强烈建议不要尝试构建一个宏大的 GUI 构建框架 a-la [CLIM](http://www.cliki.net/CLIM)，而是做一些更 Lispy 的事情：开始编写你的 Swing 应用程序并用宏抽象出你的常见模式。这样做时，您最终可能会使用一种语言来编写您的 GUI，或者可能是一些可以共享和发展的非常通用的东西。

在 Clojure 中编写 GUI 时您会失去一件事，那就是使用像 Matisse 这样的工具。这可能是在 Java 中编写一些部分（GUI）和在 Clojure 中编写一些部分（逻辑）的一个强项。这实际上是有道理的，因为在逻辑中您将能够使用宏为您的逻辑构建一种语言，我认为那里可以获得比 GUI 更多的东西。显然，这取决于您的应用程序。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2013-05-14T15:17:07.380

还没有人建议，所以我会：浏览器作为 UI 平台。您可以在 Clojure 中编写您的应用程序，包括一个 HTTP 服务器，然后使用从 HTML 到 hiccup、ClojureScript 以及您需要的任何数十亿个 JS 库中的任何内容来开发[UI](https://github.com/weavejester/hiccup)。如果您想要一致的浏览器行为和“桌面应用程序外观”，您可以将[chrome 与您的应用程序捆绑在一起](http://developer.chrome.com/trunk/apps/about_apps.html)。

这似乎是[Light Table](http://www.lighttable.com/)的分布方式。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2008-10-24T12:21:42.710

从这个[页面](http://blog.thinkrelevance.com/2008/8/12/java-next-2-java-interop)：

```
(import '(javax.swing JFrame JButton JOptionPane)) ;'
(import '(java.awt.event ActionListener))          ;'

(let [frame (JFrame. "Hello Swing")
     button (JButton. "Click Me")]
 (.addActionListener button
   (proxy [ActionListener] []
     (actionPerformed [evt]
       (JOptionPane/showMessageDialog  nil,
          (str "<html>Hello from <b>Clojure</b>. Button "
               (.getActionCommand evt) " clicked.")))))

 (.. frame getContentPane (add button))

 (doto frame
   (.setDefaultCloseOperation JFrame/EXIT_ON_CLOSE)
   .pack
   (.setVisible true)))

print("code sample"); 
```

当然，看看 clojure 网站的[互操作性](http://clojure.org/java_interop)部分也是值得的。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-12-16T14:16:13.827

在 clojure contrib 中有一个 MigLayout 的包装器。你也可以看看[这个要点](http://gist.github.com/261140)。我基本上是在学习摇摆/miglayout 时编写我正在编写的任何代码。

dsm 的示例使用 contrib.swing-utils 以 lispy 的方式重写

```
(ns test
      (:import (javax.swing JButton JFrame))
      (:use (clojure.contrib
          [swing-utils :only (add-action-listener)])))

    (defn handler
      [event]
      (JOptionPane/showMessageDialog nil,
        (str "<html>Hello from <b>Clojure</b>. Button "
          (.getActionCommand event) " clicked.")))

    (let [ frame (JFrame. "Hello Swing") 
           button (JButton. "Click Me")  ]
      (add-action-listener button handler)
        (doto frame
          (.setDefaultCloseOperation JFrame/EXIT_ON_CLOSE)
          (.add button)
          (.pack)
          (.setVisible true))) 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2014-12-04T14:33:45.183

我宁愿去clojurefx，这有点为时过早，但它确实有效并且可以节省你的时间。

我用跷跷板启动了我的 GUI，然后在 clojurefx 中尝试了另一个组件。

我已经完成了两者，并且我确信我将把跷跷板重构为 clojurefx。

毕竟，JavaFX 是前进的道路。

感觉比跷跷板轻。或者至少，写它..

绑定工作，侦听器工作，大部分组件工作，否则，只需使用其中一个宏来为特定情况创建构造函数并完成工作。或者，如果您觉得困难，请用 Java 编写一些方法并寻求帮助以改进 clojurefx。

写 clojurefx 的人现在很忙，但你可以分叉项目并做一些修复。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-03-04T13:29:21.603

邮件列表上已经[讨论](http://groups.google.com/group/clojure/browse_thread/thread/cd88c3d948ff6b4a)了一些 Cells （[类似于 Kenny Tilton 的 Cells](http://smuglispweeny.blogspot.com/2008/02/cells-manifesto.html)）实现。这是进行 GUI 编程的一种非常巧妙的方法。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-10-01T17:43:40.533

这是另一个非常基本的摆动包装示例：

```
; time for some swing
(import '(javax.swing JFrame JTable JScrollPane))
(import '(javax.swing.table DefaultTableModel))

(let 
  [frame (JFrame. "Hello Swing")
    dm (DefaultTableModel.)
      table (JTable. dm)
        scroll (JScrollPane. table)]
  (doto dm
      (.setNumRows 30)
        (.setColumnCount 5))
  (.. frame getContentPane (add scroll))
    (doto frame
      (.setDefaultCloseOperation JFrame/EXIT_ON_CLOSE) 
        (.pack)
        (.setVisible true))) 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-01-13T11:59:32.007

我问自己同样的问题，即使用 Swing 在 Clojure 中编写 GUI，并提出了 library [signe](https://github.com/jonasseglare/signe)

它允许您将域模型表示为包裹在原子中的单个 Clojure 数据结构。

[请参阅此处](https://github.com/jonasseglare/signe/blob/master/src/signe/examples.clj)的示例。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-16T14:52:00.117

我一直在开发一个 Java 小程序，其中除了用 Java 编写的小程序代码外，所有内容都是用 Clojure 编写的。小程序从 java 的钩子中调用 Clojure 代码的 init、paint 等回调，用于小程序模型定义的那些方法。所以代码最终是 99.999% 的 Clojure，而且您在大多数情况下根本不必考虑微小的 Java 部分。

这种方法有一些缺点，我希望在 Clojure Google Group 上更详细地讨论。我认为 Clojure 开发人员应该包含构建应用程序的本地方式。目前你可以从 REPL 中做任何你喜欢的 GUI 东西，但是如果你想要一个可交付的 GUI 应用程序，就必须编写一些 Java 来调用 Clojure 代码。此外，Java Applet 的架构似乎迫使您脱离 Clojure 更惯用的最佳实践，要求您使用可变状态等。

但是，我与 Clojure 的距离还不是很远，而且可能是这样，但我还没有发现如何正确地做到这一点。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2015-09-03T17:00:44.767

我首选的 Clojure UI 环境使用[IO.js (Node for ES6)](https://iojs.org/en/) + [Electron (Container)](http://electron.atom.io/) + [Quiescent (ReactJS wrapper)](https://github.com/levand/quiescent)。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2017-06-09T16:44:28.993

所以我没有在这个名单上看到来自 Timothy Baldridge (halgiri) 的 Fn-Fx。这是一个 Clojure 库，提供对 JavaFX 的功能抽象。

它可以在 Github 上的[https://github.com/halgari/fn-fx](https://github.com/halgari/fn-fx)上找到。

要使用，请确保您使用的是最新版本的 Java (1.8 90+)，并通过将以下内容添加到 project.clj 来向 github 存储库添加依赖项：

```
:plugins [[lein-git-deps "0.0.1-SNAPSHOT"]]
:git-dependencies [["https://github.com/halgari/fn-fx.git"]] 
```

我已经尝试过了，它开箱即用。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-01-27T15:34:20.810

Clojure 和 SWT 是执行 GUI 的最佳方法。本质上，SWT 是一种即插即用风格的软件开发方法。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-10-01T19:05:06.413

我不认为有一个官方的，但我个人会利用我正在使用世界上最强大的语言之一这一事实，想象一下完美的 gui 代码会是什么样子：

```
(form {:title :on-close dispose :x-size 500 :y-size 450}
  [(button {:text "Close" :id 5 :on-click #(System/exit 0) :align :bottom})
   (text-field {:text "" :on-change #(.println System/out (:value %)) :align :center})
   (combo-box {:text "Chose background colour" :on-change background-update-function
               :items valid-colours})]) 
```

你的想法会有所不同，但这应该希望上面能给你一些想法。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-12-26T22:28:11.110

我知道您在暗示经典的桌面解决方案，但 web 非常适合 clojure。我编写了一个完整的音频应用程序，其中所有内容都已连接，因此如果您将音乐添加到音频文件夹，它会反映在 Web UI 中。只是说桌面应用程序不是唯一的方法:)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-04-15T18:42:21.883

**[cljfx](https://openjfx.io/)**被描述为

> JavaFX 的声明性、功能性和可扩展包装器，灵感来自 react 和 re-frame 的更好部分

和[JavaFx](https://openjfx.io/)作为

> ... 一个开源的下一代客户端应用平台，适用于基于 Java 构建的桌面、移动和嵌入式系统。这是许多个人和公司的协作努力，其目标是为开发富客户端应用程序生成一个现代、高效且功能齐全的工具包。

它的创建者使用它来构建[显示](https://vlaaad.github.io/reveal/)，以及一个 以各种功能为特色的[hackernews 演示，以及通过](https://github.com/cljfx/hn)[jpackage](https://openjdk.java.net/jeps/343)为多个操作系统捆绑的一些内容。

通过利用 JavaFX 为桌面、移动和 Web 构建 UI，您可以获得 Clojure REPL 驱动的开发。

# sql-server - SQL Server 2005 和 SQL Server 2008 之间是否存在冲突？

> ID：233182
> 
> 赞同：4
> 
> 时间：2008-10-24T11:42:04.240
> 
> 标签：sql-server, installation, business-intelligence

有人告诉我，带有 BI 工具的 SQL Server 2005 安装和带有 BI 工具的 SQL Server 2008 不能在同一台计算机上一起工作。显然“一些”事情停止工作。这是我的一位团队成员告诉我的。由于我是 SQL BI 的新手，所以我不能完全否定他所说的内容，我不想将它们都安装在我的开发盒上，以后再发现有问题。

这里有没有人安装了它们，都使用得很好并且发现它工作正常？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-30T12:39:30.680

我在我的工作站上完整安装了 SQL2005 开发人员和 SQL2008 开发人员。没有发生任何不寻常的事情。一位同事也已安装并正在使用 SQL 2005 的 BI 端，同样我们没有注意到任何不良影响。服务器端在安装两者之前我会三思而后行，但这只是因为资源使用情况。如果您的盒子有足够的可用资源，那么我预计不会有任何问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-25T22:12:54.473

我不确定这是您的开发系统还是服务器......如果它是服务器，您可以同时在同一台服务器上同时拥有并排报告服务（尽管您也使用双倍资源）。我不确定你为什么会这样做；报告服务 2008 非常出色，可以报告来自 sql 2005 实例的数据。如果您担心缺少 sql 2008 的服务包，您可以从报告服务 2005 ( [http://msdn.microsoft.com/en-us/library/ms143736.aspx](http://msdn.microsoft.com/en-us/library/ms143736.aspx) )报告 sql 2008 中的数据

如果它在您自己的 PC 上是本地的，您可以同时安装两个开发工具（[http://msdn.microsoft.com/en-us/library/bb500441.aspx](http://msdn.microsoft.com/en-us/library/bb500441.aspx)）；虽然在这种情况下，我只会在您迁移到 sql 2008 时使用 sql 2005 工具，因为 SQL 2005 代码在 2008 年有效，但不一定相反。

如果您有报告服务模型，请务必查看 ms 本周推出的报告生成器 2。它的用户体验比报表生成器 1 好得多。

# javascript - Firefox 和 IE 之间的窗口和 div 宽度有什么不同

> ID：233188
> 
> 赞同：2
> 
> 时间：2008-10-24T11:44:39.867
> 
> 标签：javascript, html, internet-explorer, firefox

我有一个使用滚动 div 来显示表格信息的网页。当窗口调整大小时（以及页面加载时），显示居中，div 的滚动条通过设置其宽度位于页面右侧。由于某种原因，firefox 下的行为与 IE 下的行为不同。IE 按预期定位/调整 div，但 Firefox 似乎使它太宽，以至于当窗口客户端宽度达到大约 800px 时滚动条开始消失。我正在使用以下方法来设置位置和大小：

```
function getWindowWidth() {
  var windowWidth = 0;
  if (typeof(window.innerWidth) == 'number') {
    windowWidth=window.innerWidth;
  }
  else {
    if (document.documentElement && document.documentElement.clientWidth) {
      windowWidth=document.documentElement.clientWidth  ;
    }
    else {
      if (document.body && document.body.clientWidth) {
        windowWidth=document.body.clientWidth;
      }
    }
  }
  return windowWidth;
}

function findLPos(obj) { 
  var curleft = 0; 
  if (obj.offsetParent) { 
    curleft = obj.offsetLeft 
    while (obj = obj.offsetParent) { 
      curleft += obj.offsetLeft 
    } 
  } 
  return curleft; 
}

var bdydiv;
var coldiv;

document.body.style.overflow="hidden";
window.onload=resizeDivs;
window.onresize=resizeDivs; 

function resizeDivs(){
  bdydiv=document.getElementById('bdydiv');
  coldiv=document.getElementById('coldiv');
  var winWdth=getWindowWidth();
  var rghtMarg = 0;
  var colHdrTbl=document.getElementById('colHdrTbl');
  rghtMarg = parseInt((winWdth - 766) / 2) - 8;
  rghtMarg = (rghtMarg > 0 ? rghtMarg : 0);
  coldiv.style.paddingLeft = rghtMarg + "px";
  bdydiv.style.paddingLeft = rghtMarg + "px";
  var bdydivLft=findLPos(bdydiv);
  if ((winWdth - bdydivLft) >= 1){
    bdydiv.style.width = winWdth - bdydivLft;
    coldiv.style.width = bdydiv.style.width;
  }
  syncScroll();
}

function syncScroll(){
  if(coldiv.scrollLeft>=0){
    coldiv.scrollLeft=bdydiv.scrollLeft;
  }
} 
```

请注意，我已经删除了其他设置高度的代码和其他不相关的部分。完整的页面可以在[这里](http://site1.funddata.com/mozilladivresize.html)看到。如果你在IE和firefox中都去链接，调整宽度直到右上角的绿色框显示“800”，调整高度直到启用右侧的滚动条，你可以看到问题。如果您随后调整 IE 宽度，滚动条会保持不变，但如果您将 Firefox 宽度调整得更宽，滚动条就会开始消失。我不知道为什么会发生这种情况......

请注意，AFAIK，getWindowWidth() 应该是跨浏览器兼容的，但我不太确定 findLPos().... Firefox 的 DOM 或其他东西中可能有一个额外的对象，它正在改变结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T15:55:14.510

根据 Wikipedia，您正在处理“[级联样式表 (CSS) 的流行实现中最著名的软件错误之一”。](http://en.wikipedia.org/wiki/Internet_Explorer_box_model_bug)我推荐[Quirksmode.org上的](http://www.quirksmode.org/)[元素尺寸](http://www.quirksmode.org/viewport/elementdimensions.html)和[CSS 对象模型视图](http://www.quirksmode.org/dom/w3c_cssom.html)页面。

另外：我认为您会发现 Safari 和 Opera 在大多数情况下的行为类似于 Firefox。解决这些问题的一种更兼容的方法是测试 MSIE 并为其设置例外，而不是相反。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T15:20:43.440

好的，我发现了问题。似乎是 firefox 在其 style.width 设置中不包含 style.paddingLeft 值，而 IE 包含，因此 div 最终的 style.paddingLeft 太宽了。也就是说，例如，如果 style.paddingLeft 为 8，则 IE 的 style.width 值将比 FireFox 的值大 8 - 因此在设置值时相反，对于 FireFox，我需要减去 style.paddingLeft 值

修改后的代码：

```
 if (__isFireFox){
    bdydiv.style.width = winWdth - bdydivLft - rghtMarg;
  } else {
    bdydiv.style.width = winWdth - bdydivLft;
  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T11:47:20.267

只要您不包含有效的文档类型，由于 Quirks 模式，您就不能期望得到一致的结果。去添加一个（HTML 4.01 Transitional 很好），然后让我们知道它是否仍然存在。

另请参阅[http://en.wikipedia.org/wiki/Quirks_mode](http://en.wikipedia.org/wiki/Quirks_mode)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T11:53:23.033

在您的 getWindowWidth() 函数中，每当您抓取某物的宽度时，而不是这样：

```
windowWidth = document.documentElement.clientWidth; 
```

试试这个

```
windowWidth = Math.max(document.documentElement.scrollWidth, document.documentElement.clientWidth); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-24T13:44:08.083

有助于优化某些代码的详细信息：

```
function getPos(elm) {//jumper
    for(var zx=zy=0;elm!=null;zx+=elm.offsetLeft,zy+=elm.offsetTop,elm=elm.offsetParent);
    return {x:zx,y:zy}
} 
```

（jumper 是在 Eksperten.dk 中发布此代码的用户）

# eclipse - Eclipse：将 git 存储库从项目重定位到工作区

> ID：233189
> 
> 赞同：1
> 
> 时间：2008-10-24T11:44:48.323
> 
> 标签：eclipse, git, version-control, refactoring, relocation

我一直在研究一个 Eclipse 插件项目，我遇到了一种情况，我需要拆分项目以将测试用例与插件包分开。我使用 git 作为版本控制。

为了简单地描述这一点，我正在像这样对旧项目进行版本控制：

```
workspace/
  |
  +-- myplugin/
         |
         +-- .git/ <-- Here be the git repository
         |
         +-- /* Source code, project stuff, etc. */ 
```

…而且我处于需要在单独的项目中进行插件测试的情况（这样就不需要将 jUnit 作为插件的必需捆绑包）。而且我希望存储库对工作区中的所有内容进行版本控制。像这样：

```
workspace/
  |
  +-- .git/ <-- The repository should be relocated here instead…
  |
  +-- myplugin/
  |      |
  |      +-- /* Source code, project stuff, etc. */
  |
  +-- myplugin-test/
         |
         +-- /* Unit tests and stuff… */ 
```

有没有一种简单的方法可以在不丢失旧项目历史的情况下做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-24T11:50:57.873

这是伪代码的工作流程：

```
cd 工作区/myplugin
mkdir myplugin
git mv * myplugin # 你可能需要手动对所有文件/文件夹执行此操作
mkdir myplugin-test
# 将文件移动/添加到 myplugin-test
git commit -a -m "重组"
cd 工作区
mv myplugin myplugin_old
mv myplugin_old/* 。
# 你应该得到请求的结构

```

# web-crawler - 检测“隐形”网络爬虫

> ID：233192
> 
> 赞同：110
> 
> 时间：2008-10-24T11:46:52.437
> 
> 标签：web-crawler

*有哪些选项可以检测不想被检测到的网络爬虫？*

（我知道列出检测技术可以让智能隐形爬虫程序员制作出更好的蜘蛛，但我认为无论如何我们都无法阻止智能隐形爬虫，只能阻止那些犯错误的爬虫。）

我不是在谈论像 googlebot 和 Yahoo! 这样的爬虫。啜饮。我认为一个机器人很好，如果它：

1.  在用户代理字符串中将自己标识为机器人
2.  读取 robots.txt（并服从它）

我说的是*糟糕*的爬虫，隐藏在普通用户代理后面，使用我的带宽，从不给我任何回报。

有一些活板门可以构建*更新列表（感谢 Chris，gs）*：

1.  添加仅在 robots.txt 中列出（标记为不允许）的目录，
2.  添加隐形链接（可能标记为 rel="nofollow"？），
    *   样式=“显示：无；” 在链接或父容器上
    *   放置在具有更高 z-index 的另一个元素下方
3.  检测谁不了解 CapiTaLiSaTioN，
4.  检测谁试图发布回复但始终未能通过验证码。
5.  检测对仅 POST 资源的 GET 请求
6.  检测请求之间的间隔
7.  检测请求页面的顺序
8.  检测谁（一致地）通过 http 请求 https 资源
9.  检测谁不请求图像文件（这与已知图像浏览器的用户代理列表相结合，效果非常好）

“好”和“坏”机器人都会触发一些陷阱。您可以将它们与白名单结合起来：

1.  它触发了一个陷阱
2.  它要求`robots.txt`？
3.  它不会触发另一个陷阱，因为它服从了`robots.txt`

*另一件重要的事情是：*
请考虑使用屏幕阅读器的盲人：给人们一种联系您的方式，或解决（非图像）验证码以继续浏览。

**有什么方法可以自动检测试图将自己伪装成普通人类访问者的网络爬虫。**

*更新*
问题不是：*我如何捕获每个爬虫。*问题是：*如何最大限度地提高检测到爬虫的机会。*

有些蜘蛛真的很厉害，实际上可以解析和理解 html、xhtml、css javascript、VB 脚本等......
我没有幻想：我无法击败它们。

但是，您会惊讶于某些爬虫是多么愚蠢。愚蠢的最好例子（在我看来）是：在请求它们之前将所有 URL 转换为小写。

然后有一大堆爬虫“不够好”，无法避开各种活板门。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-22T18:38:33.993

不久前，我与一家小型托管公司合作，帮助他们实施解决方案。我开发的系统检查了来自任何给定 IP 地址的过度活动的 Web 服务器日志，并发布了防火墙规则来阻止违规者。它包括基于[http://www.iplists.com/](http://www.iplists.com/)的 IP 地址/范围白名单，然后根据需要通过检查声称的用户代理字符串以及如果客户端声称是合法蜘蛛但不在白名单，它执行 DNS/反向 DNS 查找以验证源 IP 地址是否对应于声称的机器人所有者。作为故障保险，这些操作已通过电子邮件报告给管理员，并附有将地址列入黑/白名单的链接，以防评估不正确。

我已经有 6 个月左右没有与那个客户交谈了，但是，我上次听说，系统运行得非常有效。

旁白：如果您正在考虑使用基于命中率限制的类似检测系统，请务必使用至少一分钟（最好至少五分钟）的总数。我看到很多人在谈论这类计划，他们想要阻止任何在一秒钟内获得超过 5-10 次点击的人，这可能会在图像密集的页面上产生误报（除非图像被排除在统计之外）并且*会*产生错误当像我这样的人找到一个他想阅读所有有趣的网站时，他会打开标签中的所有链接，以便在阅读第一个链接时在后台加载。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-21T21:56:04.563

See [Project Honeypot](http://www.projecthoneypot.org/) - they're setting up bot traps on large scale (and have DNSRBL with their IPs).

Use tricky URLs and HTML:

```
<a href="//example.com/"> = http://example.com/ on http pages.
<a href="page&amp;&#x23;hash"> = page& + #hash 
```

In HTML you can use plenty of tricks with comments, CDATA elements, entities, etc:

```
<a href="foo<!--bar-->"> (comment should not be removed)
<script>var haha = '<a href="bot">'</script>
<script>// <!-- </script> <!--><a href="bot"> <!--> 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-24T13:32:16.560

一个简单的解决方案是创建一个链接并使其不可见

```
<a href="iamabot.script" style="display:none;">Don't click me!</a> 
```

当然，您应该期望某些查看源代码的人会跟随该链接，只是为了了解它的方向。但是您可以向这些用户提供验证码...

当然，有效的爬虫也会跟随链接。但是你不应该实现 rel=nofollow，而是寻找有效爬虫的标志。（如用户代理）

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-24T13:08:06.440

您没有列出的一件事，通常用于检测不良爬虫。

命中速度，好的网络爬虫会打破他们的命中，所以他们不会用请求淹没一个网站。坏人会做以下三件事之一：

1.  一个接一个地点击顺序链接
2.  以一些并行顺序命中顺序链接（一次 2 个或更多。）
3.  以固定间隔命中顺序链接

此外，一些离线浏览程序会占用大量页面，我不确定您要使用什么样的阈值来开始通过 IP 地址进行阻止。

此方法还将捕获镜像程序，如 fmirror 或 wget。

如果机器人随机化时间间隔，您可以检查链接是否以顺序或深度优先的方式遍历，或者您可以查看机器人是否正在遍历大量文本（如要阅读的单词）时间太短。一些站点也限制每小时的请求数。

实际上，我在某个地方听到了一个想法，我不记得在哪里，如果用户获得了太多的数据，以千字节计，可以向他们提供验证码，要求他们证明他们不是机器人。不过，我从来没有见过这样的实现。

隐藏链接更新

就隐藏链接而言，您可以将一个 div 放在另一个下，使用 CSS（将其放在绘制顺序的首位）并可能设置 z 顺序。机器人无法忽略这一点，而无需解析所有 javascript 以查看它是否是菜单。在某种程度上，如果机器人不解析所有 javascript，也不能忽略不可见 DIV 元素内的链接。

将这个想法完成，可能会显示隐藏元素的未调用 javascript 可能会欺骗 javascript 解析机器人的子集。而且，实施起来也不是很多工作。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-24T14:58:41.893

跟上良好的用户代理字符串实际上并不容易。浏览器版本来来去去。通过不同的行为对用户代理字符串进行统计可以揭示有趣的事情。

我不知道这可以自动化到什么程度，但至少这是一件与众不同的事情。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-04-07T20:04:24.000

我听说过的一种简单的表单检测方法是隐藏输入技术。如果您正在尝试保护表单，请在表单中输入一个看起来完全合法的 id。然后在外部文件中使用 css 来隐藏它。或者，如果您真的很偏执，请设置类似 jquery 的东西来隐藏页面加载时的输入框。如果你做对了，我想机器人很难弄清楚。您知道这些机器人天生就可以填写页面上的所有内容，特别是如果您为隐藏的输入提供类似 id="fname" 等的 id。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-06-25T21:21:12.963

未经测试，但这里有一个很好的用户代理列表，您可以从中制作正则表达式。可以让你大部分时间到达那里：

```
ADSARobot|ah-ha|almaden|aktuelles|Anarchie|amzn_assoc|ASPSeek|ASSORT|ATHENS|Atomz|attach|attache|autoemailspider|BackWeb|Bandit|BatchFTP|bdfetch|big.brother|BlackWidow|bmclient|Boston\ Project|BravoBrian\ SpiderEngine\ MarcoPolo|Bot\ mailto:craftbot@yahoo.com|Buddy|Bullseye|bumblebee|capture|CherryPicker|ChinaClaw|CICC|clipping|Collector|Copier|Crescent|Crescent\ Internet\ ToolPak|Custo|cyberalert|DA$|Deweb|diagem|Digger|Digimarc|DIIbot|DISCo|DISCo\ Pump|DISCoFinder|Download\ Demon|Download\ Wonder|Downloader|Drip|DSurf15a|DTS.Agent|EasyDL|eCatch|ecollector|efp@gmx\.net|Email\ Extractor|EirGrabber|email|EmailCollector|EmailSiphon|EmailWolf|Express\ WebPictures|ExtractorPro|EyeNetIE|FavOrg|fastlwspider|Favorites\ Sweeper|Fetch|FEZhead|FileHound|FlashGet\ WebWasher|FlickBot|fluffy|FrontPage|GalaxyBot|Generic|Getleft|GetRight|GetSmart|GetWeb!|GetWebPage|gigabaz|Girafabot|Go\!Zilla|Go!Zilla|Go-Ahead-Got-It|GornKer|gotit|Grabber|GrabNet|Grafula|Green\ Research|grub-client|Harvest|hhjhj@yahoo|hloader|HMView|HomePageSearch|http\ generic|HTTrack|httpdown|httrack|ia_archiver|IBM_Planetwide|Image\ Stripper|Image\ Sucker|imagefetch|IncyWincy|Indy*Library|Indy\ Library|informant|Ingelin|InterGET|Internet\ Ninja|InternetLinkagent|Internet\ Ninja|InternetSeer\.com|Iria|Irvine|JBH*agent|JetCar|JOC|JOC\ Web\ Spider|JustView|KWebGet|Lachesis|larbin|LeechFTP|LexiBot|lftp|libwww|likse|Link|Link*Sleuth|LINKS\ ARoMATIZED|LinkWalker|LWP|lwp-trivial|Mag-Net|Magnet|Mac\ Finder|Mag-Net|Mass\ Downloader|MCspider|Memo|Microsoft.URL|MIDown\ tool|Mirror|Missigua\ Locator|Mister\ PiX|MMMtoCrawl\/UrlDispatcherLLL|^Mozilla$|Mozilla.*Indy|Mozilla.*NEWT|Mozilla*MSIECrawler|MS\ FrontPage*|MSFrontPage|MSIECrawler|MSProxy|multithreaddb|nationaldirectory|Navroad|NearSite|NetAnts|NetCarta|NetMechanic|netprospector|NetResearchServer|NetSpider|Net\ Vampire|NetZIP|NetZip\ Downloader|NetZippy|NEWT|NICErsPRO|Ninja|NPBot|Octopus|Offline\ Explorer|Offline\ Navigator|OpaL|Openfind|OpenTextSiteCrawler|OrangeBot|PageGrabber|Papa\ Foto|PackRat|pavuk|pcBrowser|PersonaPilot|Ping|PingALink|Pockey|Proxy|psbot|PSurf|puf|Pump|PushSite|QRVA|RealDownload|Reaper|Recorder|ReGet|replacer|RepoMonkey|Robozilla|Rover|RPT-HTTPClient|Rsync|Scooter|SearchExpress|searchhippo|searchterms\.it|Second\ Street\ Research|Seeker|Shai|Siphon|sitecheck|sitecheck.internetseer.com|SiteSnagger|SlySearch|SmartDownload|snagger|Snake|SpaceBison|Spegla|SpiderBot|sproose|SqWorm|Stripper|Sucker|SuperBot|SuperHTTP|Surfbot|SurfWalker|Szukacz|tAkeOut|tarspider|Teleport\ Pro|Templeton|TrueRobot|TV33_Mercator|UIowaCrawler|UtilMind|URLSpiderPro|URL_Spider_Pro|Vacuum|vagabondo|vayala|visibilitygap|VoidEYE|vspider|Web\ Downloader|w3mir|Web\ Data\ Extractor|Web\ Image\ Collector|Web\ Sucker|Wweb|WebAuto|WebBandit|web\.by\.mail|Webclipping|webcollage|webcollector|WebCopier|webcraft@bea|webdevil|webdownloader|Webdup|WebEMailExtrac|WebFetch|WebGo\ IS|WebHook|Webinator|WebLeacher|WEBMASTERS|WebMiner|WebMirror|webmole|WebReaper|WebSauger|Website|Website\ eXtractor|Website\ Quester|WebSnake|Webster|WebStripper|websucker|webvac|webwalk|webweasel|WebWhacker|WebZIP|Wget|Whacker|whizbang|WhosTalking|Widow|WISEbot|WWWOFFLE|x-Tractor|^Xaldon\ WebSpider|WUMPUS|Xenu|XGET|Zeus.*Webster|Zeus [NC] 
```

取自： http: [//perishablepress.com/press/2007/10/15/ultimate-htaccess-blacklist-2-compressed-version/](http://perishablepress.com/press/2007/10/15/ultimate-htaccess-blacklist-2-compressed-version/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-02-03T13:31:33.433

您还可以检查推荐。没有推荐可以引起机器人怀疑。糟糕的推荐意味着它肯定不是浏览器。

> 添加隐形链接（可能标记为 rel="nofollow"？），

```
* style="display: none;" on link or parent container
* placed underneath another element with higher z-index 
```

我不会那样做的。您最终可能会被谷歌列入黑帽 SEO 的黑名单 :)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-06-25T21:52:49.040

我目前在一家扫描网站以便对其进行分类的公司工作。我们还会检查网站是否存在恶意软件。

根据我的经验，我们的网络爬虫（当然使用 IE 或 Firefox UA 并且不遵守 robots.txt。Duh。）的第一大拦截器是故意托管恶意软件的网站。这很痛苦，因为该站点随后会退回到必须手动加载站点、对其进行分类并检查其是否存在恶意软件的人。

我只是说，[通过阻止网络爬虫，您将自己置于一个糟糕的公司中。](http://www.darkreading.com/applications/google-report-how-web-attackers-evade-ma/231500264)

当然，如果他们非常粗鲁并且占用了您大量的带宽，那就另当别论了，因为您有充分的理由。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-09-14T09:04:52.580

人们一直在处理广泛的爬虫，而不是专门为您的网站设计的爬虫。

我编写了隐形爬虫，如果它们是单独构建的，那么再多的蜜罐或隐藏链接都不会产生任何影响 - 检测专用爬虫的唯一真正方法是检查连接模式。

使用 AI 的最佳系统（例如 Linkedin）使用 AI 来解决这个问题。
最简单的解决方案是编写日志解析器来分析 IP 连接并将这些 IP 列入黑名单或提供验证码，至少是暂时的。

例如
，如果每 2 秒看到一次 IP X 连接到`foo.com/cars/*.html`但没有连接到任何其他页面 - 它很可能是机器人或饥饿的高级用户。

或者，有各种 javascript 挑战作为保护（例如 Cloudflare 的反机器人系统），但这些挑战很容易解决，您可以编写一些自定义的东西，这可能足以阻止爬虫的努力。

但是，您必须问一个问题，您是否愿意误报合法用户并为他们带来不便，以防止机器人流量。保护公共数据是一个不可能的悖论。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2019-02-27T18:00:52.470

简短的回答：如果一个中级程序员知道他在做什么，你将无法在不影响真实用户的情况下检测到爬虫。公开您的信息，您将无法抵御爬虫……这就像第一修正案一样：）

# apache-flex - RemoteObject - 跨域问题

> ID：233199
> 
> 赞同：0
> 
> 时间：2008-10-24T11:49:14.163
> 
> 标签：apache-flex, xml-rpc

我正在尝试从我的服务器获取数据，使用 RemoteObject 来完成它。当我在我的本地主机上运行应用程序时，它运行良好，但是当我在我的服务器上使用它时，我得到一个 Channel.Security.Error（访问 URL 的安全错误）。

在服务器端日志中提到了 cross domain 。77.127.194.4 - - [23/Oct/2008 21:15:11]“GET /crossdomain.xml HTTP/1.1”501

有人遇到过同样的问题吗？任何想法 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-25T14:01:09.000

我找到了解决方案。您对 crossdomain.xml 文件的看法是正确的，但不幸的是，Python SimpleXMLRPCServer 库默认不支持 GET 方法，因此我们需要实现这一点。

```
from SimpleXMLRPCServer import SimpleXMLRPCRequestHandler

class ExtendedXMLRPCRequestHandler(SimpleXMLRPCRequestHandler):
  def do_GET(self):
    #only allow a request for the crossdomain file
    if self.path != '/crossdomain.xml':
      self.send_response(403)
      self.log_request(403)
      return

    #open the crossdomain file and read its contents
    response = open('crossdomain.xml', 'r').read()

    #write the data to the socket along with valid HTTP headers
    self.send_response(200)
    self.send_header("Content-type", "text/xml")
    self.send_header("Content-length", str(len(response)))
    self.end_headers()
    self.wfile.write(response)
    self.log_request(200) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T12:05:01.887

您是否尝试将以下内容添加到您的 crossdomain.xml（从中获取内容）：

```
<?xml version="1.0"?>
    <!DOCTYPE cross-domain-policy SYSTEM "http://www.YOUR_FRAME_WORK_CROSSDOMAIN_POLICY.com/xml/dtds/cross-domain-policy.dtd">
    <cross-domain-policy>
        <site-control permitted-cross-domain-policies="all"/>
        <allow-access-from domain="*.YOUR_SITE_GOES_HERE.com" secure="false" />
        <allow-access-from domain="*.YOUR_SITE_GOES_HERE.com" secure="false" />
    </cross-domain-policy> 
```

大写的东西你可能不得不改变以适应你的框架。例如，我从与macromedia flash 一起使用的那个中复制了它。而不是“www.YOUR_FRAME_WORK_CROSSDOMAIN_POLICY.com/...”我通常有“www.macromedia.com/xml/dtds/...

我不确定，但请尝试对此进行调查，这可能是您的问题。对于跨域，您通常需要添加到服务器端，您的文件来自哪里，其他站点获取它的权限。

# c# - always try-catch external resource calls?

> ID：233207
> 
> 赞同：8
> 
> 时间：2008-10-24T11:55:23.277
> 
> 标签：c#, exception, external

Should I always wrap external resource calls in a try-catch? (ie. calls to a database or file system) Is there a best practice for error handling when calling external resources?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-24T12:12:31.730

Catch **only exceptions** that you **can handle**. So for example when using external resources, the best practice is to catch **specific** exceptions that you know you can handle. In case of files this can be (IOException, SecurityException, etc), in case of Database the exception can be SqlException or others.

In any case, **don't catch** exceptions that you **don't handle**, let them flow to a upper layer that can. Or if for some reason you do catch exceptions but don't handle them, rethrow them using just *throw;* (which will create an rethrow IL op, as opposed to trow).

In case of using resources that you don't know what type of exceptions might throw, you are kind of forced to catch the general exception type. And in this case the safes thing would be to use the said resources from a different app domain (if possible), or let the exception bubble up to top level (ex UI) where they can be displayed or logged.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-24T12:12:46.253

I think there are three reasons to have a catch block:

*   You can handle the exception and recover (from "low level" code)
*   You want to rewrap the exception (again, from "low level" code)
*   You're at the top of the stack, and while you can't recover the operation itself, you don't want the whole app to go down

If you stick to these, you should have very few catch blocks compared with `try/finally` blocks - and those `try/finally` blocks are almost always just calling `Dispose`, and therefore best written as `using` statements.

Bottom line: It's very important to have a `finally` block to free resources, but `catch` blocks should usually be rarer.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-24T12:04:28.983

[> Know when to set up a try/catch block. For example, you can programmatically check for a condition that is likely to occur without using exception handling. In other situations, using exception handling to catch an error condition is appropriate.](http://msdn.microsoft.com/en-us/library/seyhszts(VS.71).aspx)

That's what I found and it makes sense to me.. Check manually for the obvious things, let try-catch do the rest..

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-24T12:12:41.370

Eric Lippert has a good blog on this, [here](https://docs.microsoft.com/en-us/archive/blogs/ericlippert/vexing-exceptions).

There is no point (except for "vexing" (see blog)) catching an exception unless you can do something useful; and in most cases you simply can't - so let it bubble (your UI should obviously cleanse and display something).

You might, however, have a "try/finally" to deal with resource management. Or even cleaner, a "using" block to do the same.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-24T11:59:15.797

I think the absolute answer is completely conditional (how control do you have over the environment, what is the expected balance between performance and consistency and many others I'm sure), but generally speaking I always do, choosing the safety over the potentially slower performance.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-24T12:03:14.573

it always depend on what you want to achieve. A server not responding might be serious enough to stop all what the routine what doing, and the exception should be thrown to the caller.

In other cases, you don't care whether you failed to update the db or not. Then consuming the exception is OK.

Obviously, you don't want to show the stack trace to your end user, though, so you'll need to catch it somewhere.

# .net - 检测 .NET Framework 3.5 SP1 依赖项（cmp. 3.5 w/o SP1）

> ID：233211
> 
> 赞同：5
> 
> 时间：2008-10-24T11:57:16.533
> 
> 标签：.net, visual-studio-2008, dependencies, fxcop

我在我的机器上使用 3.5 SP1，而我们的客户目前使用没有 SP1 的 3.5。我不知道在 VS2008 中如何将解决方案或项目定位到不带 SP1 的 3.5，只有我安装的带 SP1 的 3.5。

如果我们使用 3.5 w/o SP1 中不可用的函数或构造函数，代码将无法正常工作。

也就是说，我想在**编译时**检测没有 SP1 的情况。

到目前为止，我们已经完成了测试（在 VM 或单独的机器中）以查看应用程序是否中断，并且有时当我们使用在 SP1 之前不可用的 API 部分时它确实会中断。问题是它仅在代码实际运行时（在运行时）而不是在加载程序集时中断。

一种解决方案是拥有一台带有 VS2008 w/o SP1 的机器并尝试编译该项目。但是，我更喜欢通过分析源代码或我们生成的程序集来帮助我检测对 3.5 SP1 的依赖项（由于使用新的 API 或其他原因）的工具。

我的谷歌能力对这个问题还不够强大，有什么提示吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T21:29:30.117

我刚遇到同样的问题，我找到了解决方案。对于我们的应用程序，是对 System.Threading.WaitHandle.WaitOne(Int32) 的调用给我们带来了麻烦。有关对服务包版本中引入的 API 的引用如何在 Visual Studio 不注意的情况下泄漏到您的代码中的更多详细信息，请参阅[Krzysztof Cwalina 的帖子](http://blogs.msdn.com/kcwalina/archive/2007/10/02/Multi_2D00_TargetingAndFxCop.aspx)。

好消息是，正如[Marc 在他的回答中提到的](https://stackoverflow.com/questions/233211/detect-net-framework-3-5-sp1-dependency-cmp-3-5-w-o-sp1/233231#233231)那样，FxCop 有一个[新规则](http://davesbox.com/archive/2008/08/25/new-for-visual-studio-2008-sp1-and-fxcop-1-36-multi-targeting-rule.aspx)来检测这些泄漏。坏消息是，当您以 .NET Framework 3.5 为目标时，FxCop 1.36 中的规则被破坏了。然而，David Kean 描述了如何编辑几个 XML 配置文件来[解决这个问题](http://davesbox.com/archive/2008/11/29/bug-multi-targeting-rule-not-firing-on-usages-of-2-0-sp2-and-3-0-sp2.aspx)。我按照说明进行操作，FxCop 现在检测到我对服务包 API 的引用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-24T12:05:09.780

[这个](http://davesbox.com/archive/2008/08/25/new-for-visual-studio-2008-sp1-and-fxcop-1-36-multi-targeting-rule.aspx)怎么样？（FxCop 的多目标规则）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-24T14:14:53.120

您可以使用[此处](http://geekswithblogs.net/lorint/archive/2006/01/30/67654.aspx)找到的代码来检测已安装的 .NET Framework。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-18T23:37:49.513

字符串 Fx35RegistryKey = @"HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\NET Framework Setup\NDP\v3.5"; 对象 Fx35ServicePack = Registry.GetValue(Fx35RegistryKey, "SP", null);

if (Fx35ServicePack == null || (int)Fx35ServicePack < 1) throw new Exception(".NET Framework 3.5 SP1 is required.");

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T21:36:40.257

还有一个我没有尝试过的选择。[Visual Studio 文档](http://msdn.microsoft.com/en-us/library/bb398202.aspx)说您可以使 ClickOnce 安装程序专门针对 .NET 3.5SP1 框架。点击链接，搜索“Targeting .NET Framework Version 3.5 SP1”。本质上，它说执行以下任何操作都会强制安装程序安装 3.5SP1：

*   在“发布选项”对话框中指定错误 URL。
*   在“发布选项”对话框中指定套件名称。
*   在“发布选项”对话框中创建桌面快捷方式。
*   从“应用程序文件”对话框中的哈希中排除文件。
*   清除 Signing 页面上的 Sign the ClickOnce manifests 复选框。
*   添加对 System.Data.Entity 程序集的引用。

# c# - 泛型和类型推断

> ID：233216
> 
> 赞同：1
> 
> 时间：2008-10-24T11:59:38.260
> 
> 标签：c#, generics, reflection

我有一个抽象的泛型类`BLL<T> where T : BusinessObject`。我需要打开一个包含一组具体 BLL 类的程序集，并在 Dictionary 中返回元组（businessObjectType、concreteBLLType）。到目前为止，我可以做部分方法，但是我在发现 T 时遇到了问题。

```
protected override Dictionary<Type, Type> DefineBLLs()
{
   string bllsAssembly = ConfigurationManager.AppSettings["BLLsAssembly"];

   Type[] types = LoadAssembly(bllsAssembly);

   Dictionary<Type, Type> bllsTypes = new Dictionary<Type, Type>();

   foreach (Type type in types)
   {
     if (type.IsSubclassOf(typeof(BLL<>)))
        /* how to know T in the situation below? */
        bllsTypes.Add(??businessObjectType (T)??, type);
   }

   return bllsTypes;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T12:07:31.490

那么具体的类将是封闭的而不是通用的？这是一个简短的程序，它展示了我*认为*你所追求的......

```
using System;
using System.Reflection;

public abstract class Base<T>
{
}

public class Concrete : Base<string>
{
}

class Test
{
    static void Main()
    {
        Type type = typeof(Concrete);
        Type baseType = type.BaseType;
        Type typeOfT = baseType.GetGenericArguments()[0]; // Only one arg
        Console.WriteLine(typeOfT.Name); // Prints String
    }
} 
```

请注意，这里我*假设*我们只需要上一级即可获得适当的基本类型，并且具体类*将*被关闭。当然，您希望对您的真实代码进行更多检查，但我怀疑您缺少的是对[GetGenericArguments的调用。](http://msdn.microsoft.com/en-us/library/system.type.getgenericarguments.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T12:20:13.180

乔恩，这正是我想要的。我使用反射和泛型的基础知识，所以当需要更深入的 API 知识来面对两者时，我想念这样的东西，谢谢你的回答。

您的假设是正确的，具体类是封闭的，并且 T 是在基类（BLL）上定义的。

代码变成了这样：

```
protected override Dictionary<Type, Type> DefineBLLs()
{
   string bllsAssembly = ConfigurationManager.AppSettings["BLLsAssembly"];

   Type[] types = LoadAssembly(bllsAssembly);

   Dictionary<Type, Type> bllsTypes = new Dictionary<Type, Type>();

   foreach (Type bllType in types)
   {
     if (bllType.IsSubclassOf(typeof(BLL<>)))
     {
        Type baseType = bllType.BaseType;
        Type businessObjectType = baseType.GetGenericArguments()[0];
        bllsTypes.Add(businessObjectType, bllType);
     }
   }

   return bllsTypes;
} 
```

# linux - 如何在不覆盖 TTY 的情况下将密码传递给 su/sudo/ssh？

> ID：233217
> 
> 赞同：152
> 
> 时间：2008-10-24T11:59:55.780
> 
> 标签：expect, linux, ssh, passwords, sudo, su

我正在编写一个将执行`su`or `sudo`or的 C Shell 程序`ssh`。他们都希望在控制台输入（TTY）而不是标准输入或命令行中输入密码。

有人知道解决方案吗？

设置无密码`sudo`不是一种选择。

[expect](/questions/tagged/expect "显示标记为“期望”的问题")可能是一个选项，但它不存在于我的精简系统中。

* * *

## 回答 #1

> 赞同：226
> 
> 时间：2010-12-01T17:27:26.380

对于 sudo，有一个 -S 选项用于接受来自标准输入的密码。这是男人的条目：

```
 -S          The -S (stdin) option causes sudo to read the password from
                the standard input instead of the terminal device. 
```

这将允许您运行如下命令：

```
echo myPassword | sudo -S ls /tmp 
```

至于 ssh，我已经做了很多尝试来自动化/脚本化它的使用，但没有成功。似乎没有任何内置方法可以在不提示的情况下将密码传递给命令。正如其他人所提到的，“ [expect](http://en.wikipedia.org/wiki/Expect) ”实用程序似乎旨在解决这一难题，但最终，设置正确的私钥授权是尝试自动化此操作的正确方法。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2008-12-09T06:04:04.073

我写了一些 Applescript，它通过一个对话框提示输入密码，然后构建一个自定义 bash 命令，如下所示：

```
echo <password> | sudo -S <command> 
```

我不确定这是否有帮助。

如果 sudo 接受预加密的密码，那就太好了，这样我就可以在我的脚本中对其进行加密，而不必担心回显明文密码。然而，这适用于我和我的情况。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2012-01-13T12:27:10.887

因为`ssh`你可以使用`sshpass`: `sshpass -p yourpassphrase ssh user@host`。

你只需要先下载 sshpass :)

```
$ apt-get install sshpass
$ sshpass -p 'password' ssh username@server 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2015-06-09T14:12:18.673

对于 sudo 你也可以这样做：

```
sudo -S <<< "password" command 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2011-01-07T16:36:04.900

我有：

```
ssh user@host bash -c "echo mypass | sudo -S mycommand" 
```

为我工作。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2008-10-24T12:07:15.080

这个问题的通常解决方案是设置一个帮助应用程序来执行需要超级用户访问权限的任务： [http ://en.wikipedia.org/wiki/Setuid](http://en.wikipedia.org/wiki/Setuid)

Sudo 不适合离线使用。

稍后编辑：SSH 可以与私钥-公钥身份验证一起使用。如果私钥没有密码，可以使用 ssh 而不提示输入密码。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2012-07-30T12:54:31.337

这可以通过在您将连接到的目标主机上设置公钥/私钥来完成。第一步是为在本地主机上运行脚本的用户生成一个 ssh 密钥，方法是执行：

```
ssh-keygen
Enter file in which to save the key (/home/myuser/.ssh/id_rsa): <Hit enter for default>
Overwrite (y/n)? y 
```

然后输入一个空白密码。之后，将您的 ssh 密钥复制到您将要连接的目标主机上。

```
ssh-copy-id <remote_user>@<other_host>
remote_user@other_host's password: <Enter remote user's password here> 
```

注册 ssh 密钥后，您将能够`ssh remote_user@other_host`从本地主机执行静默操作。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2012-05-08T04:21:46.863

也许您可以使用`expect`命令？：

```
expect -c 'spawn ssh root@your-domain.com;expect password;send "your-password\n";interact 
```

该命令自动提供密码。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2008-10-24T12:01:57.507

看看`expect`linux 实用程序。

它允许您根据 stdin 上的简单模式匹配将输出发送到 stdio。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2011-09-15T21:30:21.723

如果没有更好的选择（如其他人所建议的那样），那么 man socat 可以提供帮助：

```
 (sleep 5; echo PASSWORD; sleep 5; echo ls; sleep 1) |
   socat - EXEC:'ssh -l user server',pty,setsid,ctty

          EXEC’utes an ssh session to server. Uses a pty for communication
          between socat and ssh, makes it ssh’s  controlling  tty  (ctty),
          and makes this pty the owner of a new process group (setsid), so
          ssh accepts the password from socat. 
```

所有 pty、setsid、ctty 的复杂性都是必要的，虽然你可能不需要睡那么久，但你需要睡觉。echo=0 选项也值得一看，就像在 ssh 的命令行上传递远程命令一样。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-02-17T14:08:08.607

```
ssh -t -t me@myserver.io << EOF
echo SOMEPASSWORD | sudo -S do something
sudo do something else
exit
EOF 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-27T15:56:17.617

为公钥身份验证设置 SSH，密钥上没有密码。网络上的大量指南。那时您不需要密码即可登录。然后，您可以根据客户端主机名限制密钥的连接。提供合理的安全性，非常适合自动登录。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-01-11T23:38:47.727

更好的`sshpass`选择是：`passh` [https ://github.com/clarkwang/passh](https://github.com/clarkwang/passh)

登录到远程服务器

```
 $ passh -p password ssh user@host 
```

在远程服务器上运行命令

```
 $ passh -p password ssh user@host date 
```

其他传递密码的方法

> -p 密码（默认值：`password'）
> 
> -p env：从环境变量中读取密码
> 
> -p file：从文件中读取密码

[在这里](https://serverfault.com/a/998599/364860)我解释了为什么它比 sshpass 和其他解决方案更好。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-08-11T21:17:10.103

您还可以传递各种参数，如下所示：

`echo password | echo y | sudo -S pacman -Syu`

（虽然这是一个坏主意，但这只是一个例子）

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-10-18T14:02:06.383

```
echo <password> | su -c <command> <user> 
```

这是有效的。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-03-23T11:23:19.687

我有同样的问题。用于在远程 PC 上创建目录的对话框脚本。与 ssh 的对话很容易。我使用 sshpass（以前安装）。

```
 dialog --inputbox "Enter IP" 8 78 2> /tmp/ip

   IP=$(cat /tmp/ip)

   dialog --inputbox "Please enter username" 8 78 2> /tmp/user

   US=$(cat /tmp/user)

   dialog --passwordbox "enter password for \"$US\" 8 78 2> /tmp/pass

   PASSWORD = $(cat /tmp/pass)

   sshpass -p "$PASSWORD" ssh $US@$IP mkdir -p /home/$US/TARGET-FOLDER

   rm /tmp/ip

   rm /tmp/user

   rm /tmp/pass 
```

来自德国的问候

提图斯

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-11-03T23:13:38.227

基于@Jahid 的回答，这在 macOS 10.13 上对我有用：

```
ssh <remote_username>@<remote_server> sudo -S <<< <remote_password> cat /etc/sudoers 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-12-18T23:24:31.303

我曾经有一个用例，我需要在同一命令中运行 Sudo 和 ssh，而无需`stdin`指定所有需要的变量。

这是我使用的命令

```
echo sudopassword | sudo -S -u username sshpass -p  extsshpassword ssh -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no  username@ipaddress " CMD on external machine" 
```

把那个命令分解成碎片！

这将允许您使用超级用户通过您的机器运行命令：

```
echo password | sudo -S -u username 
```

这将允许您传递 ssh 密码并在外部机器上执行命令：

```
sshpass -p  sshpassword  ssh -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no  username@ipaddress " CMD on external machine" 
```

> > 确保你在你的机器上安装了 sudo 和 openssh 包。

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2013-02-22T01:29:01.950

一种方法是使用 read -s option .. 这样密码字符就不会回显到屏幕上。我为一些用例写了一个小脚本，你可以在我的博客中看到它： [http ://www.datauniv.com/blogs/2013/02/21/a-quick-little-expect-script/](http://www.datauniv.com/blogs/2013/02/21/a-quick-little-expect-script/)

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2017-03-23T08:00:45.837

采用：

```
echo password | sudo command 
```

例子：

```
echo password | sudo apt-get update; whoami 
```

希望能帮助到你..

* * *

## 回答 #21

> 赞同：-3
> 
> 时间：2008-10-24T12:07:16.997

您可以提供密码作为期望脚本的参数。

* * *

## 回答 #22

> 赞同：-12
> 
> 时间：2009-10-22T14:04:12.957

```
su -c "Command" < "Password" 
```

*希望它是有帮助的。*

# eclipse - Eclipse：在“打开资源”对话框中隐藏路径

> ID：233220
> 
> 赞同：6
> 
> 时间：2008-10-24T12:00:20.770
> 
> 标签：eclipse

有什么方法可以定义 Eclipse 中的“打开资源”对话框应该显示什么？

如果您使用 svn，您不希望出现 *.svn 文件。（我知道这个有解决办法，但是否存在更通用的解决办法？）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-24T12:09:56.947

在“开放资源”的右上角有一个蓝色的小箭头。单击它并“选择工作集”。根据需要创建一个新的工作集以包含您需要的内容

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-12-22T17:40:13.707

您可以将文件标记为“派生”，但根据它们的目录结构，这可能很耗时。请参阅我对[这个问题](https://stackoverflow.com/q/2632419/292728)的回答。

# jquery - jQuery 元素交换

> ID：233222
> 
> 赞同：0
> 
> 时间：2008-10-24T12:01:19.023
> 
> 标签：jquery

我有 3 个 div，默认情况下只有一个可见，它们每个都包含有关产品的信息。在此 div 下方是 3 张图片的列表，这些图片是产品的图片。默认情况下，当然第一个列表项被选中并具有`class="selected"`. 当点击不同的产品图像`class="selected"`时，移动到该列表项，其上方的 div 变为隐藏，并且需要显示包含其他产品信息的 div。

我到处寻找可以做我想做的插件的插件，它们都以某种方式受到限制，这阻止了我做它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T12:14:10.383

考虑以下代码：

```
<img id="img1" src="1.jpg" desc="d1" class="selected prodImg" />
<img id="img2" src="2.jpg" desc="d2" class="prodImg" />
<img id="img3" src="3.jpg" desc="d3" class="prodImg"/>

<div id="d1">description 1</div>
<div id="d2" class="hidden">description 2</div>
<div id="d3" class="hidden">description 3</div>

<script>

    $(".prodImg").click(function() {

        if ($(this).hasClass("selected")) return;

        $("#" + $(".selected").attr("desc")).addClass("hidden");
        $(".selected").removeClass("selected");

        $("#" + $(this).attr("desc")).removeClass("hidden");
        $(this).addClass("selected");

    });

</script> 
```

这应该让你非常接近。您需要定义图像和 div 之间的关系......所以我在图像中添加了一个“desc”属性。图像上额外的“prodImg”类允许您确保只有这些图像被连接用于这种类型的换入和换出行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T12:22:23.253

Acordian 小部件具有一些类似的功能。如果将图像放在标题中，您将获得所需的效果。

查看[http://docs.jquery.com/UI/Accordion](http://docs.jquery.com/UI/Accordion)了解更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-10T08:29:02.497

```
<script>

    $(".prodImg").click(function() {

        if ($(this).hasClass("selected")) return;

        $('.prodImg').removeClass('selected');

        $(this).addClass('selected');

        var name = $(this).attr('desc');

        $('.'+name).removeClass();
        $('.'+name).addClass('');       

    });

</script> 
```

我希望这可以帮助你！

# cryptography - 虚拟化对加密强随机数生成器有什么影响？

> ID：233240
> 
> 赞同：9
> 
> 时间：2008-10-24T12:10:15.387
> 
> 标签：cryptography, virtualization, random

/dev/random 和 /dev/urandom 使用环境噪音来产生随机性。

使用虚拟化服务器，一个硬件配置上可以有多个操作系统实例。这些操作系统都将从相同的环境噪声中获取随机性。

这是否意味着作为一个组，随机数生成器的强度会降低，因为所有操作系统实例都基于相同输入的计算？或者，是否将环境噪声分开，从而不会发生共享？

如果后者是真的，我可以看到这会降低 /dev/urandom 的有效性，因为它重用了其内部池并且环境输入更少，从而降低了熵。

/dev/random 应该没问题，因为它会阻塞直到获得足够的噪音......当然，除非操作系统实例都共享输入。

所以，问题是：虚拟化对加密强的随机数生成器有什么影响，特别是那些使用环境噪声的生成器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T13:54:13.677

我无法快速找到任何参考资料，但在我看来，熵来自设备的内核数据结构，而不是实际设备本身。由于无论虚拟化如何，这些都是独立的，我怀疑答案并不多。

[编辑] 在查看内核源代码（实际上是补丁历史）之后，看起来 Linux 至少从键盘按下、鼠标活动、中断时间（但不是所有中断）和块设备请求完成时间收集熵。在虚拟化系统上，我怀疑鼠标/键盘事件会非常低，因此不会对收集的熵做出贡献。据推测，这会被额外的网络 I/O 中断活动所抵消，但目前尚不清楚。在这方面，我认为它与非 VM 服务器没有太大区别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-25T03:03:42.697

根据定义，加密强 PRNG 的随机性不应受到虚拟化的影响。[正如您所提到的，/dev/random 和 /dev/urandom [ref: http://en.wikipedia.org/wiki/Urandom/]](http://en.wikipedia.org/wiki/Urandom/])之间的区别在于，如果系统有，则 /dev/random 上的读取操作将阻塞收集到的熵不足以产生所需数量的随机数据。您也可以*写入*/dev/random 以将您自己的数据混合到熵池中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-25T02:50:45.107

谢谢。

据我了解，依赖网络 I/O 获取熵的系统容易受到中间人攻击。我发现[以下文章](http://lwn.net/Articles/283103/)讨论了适当的熵来源。他们的建议是从 Linux 内核中删除网络 I/O，因为它具有敏感性。

我认为这意味着有可能在虚拟化环境中利用通用硬件。如果使用网络 I/O，机会就会增加。否则，它足够低，除了最安全的应用程序之外，其他所有应用程序都不会关注它。在这种情况下，无论如何托管您自己的应用程序可能更安全。

# c - RS232 通信 - 我可以使用它来创建稳态信号吗？

> ID：233242
> 
> 赞同：4
> 
> 时间：2008-10-24T12:11:29.173
> 
> 标签：c, embedded, communication, serial-port

老实说，我认为答案是“不”；但是，我想获得第二意见。基本上，我需要一个微控制器设备向另一个微控制器设备发送稳定的信号，但它们之间的通信是使用 RS232。所以我认为我必须创建/更新通信消息才能让它做我想做的事。

你怎么看？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-24T12:22:37.530

您应该能够将 DTR（数据终端就绪）引脚 20 或 DSR（数据集就绪）引脚 6 设置为高电平，并将其作为稳态信号保持在那里。这就是调制解调器/终端如何检测到另一端有设备准备好进行通信的方式。这完全取决于您通过驱动程序对硬件的访问级别。

[编辑] 这不涉及发送数据，尽管您仍然可以使用 TX/RX、引脚 2 和 3 来执行此操作。

维基百科上[的 RS-232 参考](http://en.wikipedia.org/wiki/RS-232)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-28T19:26:38.207

你是说固定电压？不是方波？（字母 U）break 命令怎么样（如果你想称它为命令）？

当然，如果有帮助，您可以使用其中一条控制线……或者您是否专门从 TX 中寻找某些东西？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-24T12:55:15.823

如果问题是“我可以改变 Tx 线的 DC 状态吗”，那么答案是可以要求许多 uart（包括 PC 中的那些）来创建“中断”条件，这与正常空闲相反线路状况。

因此，您可以打开和关闭“中断”并像那样切换线路。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T12:22:46.327

如果您不介意类似突发的界面，则可以执行类似的操作。一个微可以传输一个字节，另一个可以对该字节执行某些操作并将其作为响应发送回来。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-24T12:38:09.383

如果您可以控制线路的两端，则可以将 rs-232 tx 和 rx 线路转换为常规逻辑线路以提供该信息。

然而，在大多数情况下，每一端都会定期发送一个字节的状态信息，其中包含 8 个可能的数字值 - 提供更多的状态信息。

每次接收到消息时，接收端的计时器都会重置，如果计时器超时，则消息花费的时间太长，您可以对丢失的状态消息采取行动。

正如其他人指出的那样，如果您使用的是硬件流控制，那么您也有一些可用的状态行，尽管在许多情况下这些行没有实现，因此这可能不是一个选项。

-亚当

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-24T12:49:58.940

稳定的信号可能意味着：

*   稳定的字符突发：保持发送缓冲区满
*   线保持高位或低位：不发送任何内容或发送连续中断

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-24T12:54:55.233

我认为这在很大程度上取决于您使用的 UART，例如[链接文本](http://www.national.com/ds/PC/PC16550D.pdf)，以及您在软件下对其的访问级别。如果您查看数据表，通常有一些方法可以直接控制大多数引脚以进行测试，但您需要从相当低的级别开始。

在更高的层次上，tvanfosson 的回答几乎就是我的做法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-28T13:59:55.277

虽然第一个答案是正确的，但可能无法在许多微控制器上使用这种技术（使用 DTR 或 DSR），因为它们可能没有这些信号（许多微控制器可能只有基本的 RX/TX 线，而您通常会有如果您想要额外的控制/状态线，可以使用其他 i/o 端口。但是，一切都不会丢失，许多 RS232 控制器允许您将 TX 线设置为“标记”或“空格”（即将 TX 线设置为逻辑高或低）。这将允许您获得稳定状态信号。可以检查接收器上的 RX 线以查看其是否处于标记或空间电平。

# regex - 如何使用正则表达式检查字符串是否为回文？

> ID：233243
> 
> 赞同：101
> 
> 时间：2008-10-24T12:11:51.467
> 
> 标签：regex, palindrome

那是一个我无法回答的面试问题：

如何使用正则表达式检查字符串是否为回文？

ps 已经有一个问题“[如何检查给定的字符串是否为回文？](https://stackoverflow.com/questions/52002/how-to-check-if-the-given-string-is-palindrome) ”它给出了很多不同语言的答案，但没有使用正则表达式的答案。

* * *

## 回答 #1

> 赞同：169
> 
> 时间：2008-10-29T18:41:09.530

这个问题的答案是“不可能”。更具体地说，面试官想知道你是否在计算理论课上集中注意力。

在您的计算理论课上，您了解了有限状态机。有限状态机由节点和边组成。每条边都用有限字母表中的一个字母进行注释。一个或多个节点是特殊的“接受”节点，一个节点是“开始”节点。当从给定单词中读取每个字母时，我们会遍历机器中的给定边。如果我们最终处于接受状态，那么我们就说机器“接受”了这个词。

正则表达式总是可以翻译成等效的有限状态机。也就是说，接受和拒绝与正则表达式相同的单词（在现实世界中，一些正则表达式语言允许任意函数，这些不计算在内）。

不可能建立一个接受所有回文的有限状态机。证明依赖于这样一个事实，即我们可以很容易地构建一个需要任意大量节点的字符串，即字符串

a^xba^x（例如，aba、aabaa、aaabaaa、aaaabaaaa、...）

其中 a^x 是重复 x 次。这至少需要 x 个节点，因为在看到“b”之后，我们必须倒数 x 次以确保它是回文。

最后，回到最初的问题，你可以告诉面试官，你可以编写一个正则表达式来接受所有小于某个有限固定长度的回文。如果有一个现实世界的应用程序需要识别回文，那么它几乎肯定不会包括任意长的回文，因此这个答案将表明您可以将理论上的不可能与现实世界的应用区分开来。尽管如此，实际的正则表达式会很长，比等效的 4 行程序长得多（对读者来说很容易练习：编写一个识别回文的程序）。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2008-10-24T12:26:55.257

虽然[PCRE](https://www.pcre.org)引擎确实支持递归正则表达式（参见[Peter Krauss 的回答](https://stackoverflow.com/a/48608623/18017)），但您不能在[ICU](http://www.icu-project.org/userguide/regexp)引擎（例如，Apple 使用的）上使用正则表达式来实现这一点，而无需额外的代码。你需要做这样的事情：

这会检测到任何回文，但确实需要一个循环（这是必需的，因为正则表达式无法计数）。

```
$a = "teststring";
while(length $a > 1)
{
   $a =~ /(.)(.*)(.)/;
   die "Not a palindrome: $a" unless $1 eq $3;
   $a = $2;
}
print "Palindrome"; 
```

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2008-10-24T12:25:11.347

这是不可能的。回文不是由常规语言定义的。（看，我确实在计算理论中学到了一些东西）

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2008-10-24T12:35:45.007

使用 Perl 正则表达式：

```
/^((.)(?1)\2|.?)$/ 
```

但是，正如许多人指出的那样，如果您想严格要求，这不能被视为正则表达式。*正则表达式*不支持递归。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2008-10-24T12:22:36.843

[对于任何类型的字符，这是](http://dirac.org/linux/misc/regex.html)一个检测 4 字母回文（例如：契约）的方法：

```
\(.\)\(.\)\2\1 
```

[这是](http://www.grymoire.com/Unix/Regular.html#uh-10)一个检测 5 个字母的回文（例如：radar），只检查字母：

```
\([a-z]\)\([a-z]\)[a-z]\2\1 
```

所以似乎我们需要为每个可能的字长使用不同的正则表达式。 [Python 邮件列表上的这篇文章](http://mail.python.org/pipermail/python-list/2003-November/236316.html)包括一些关于原因的详细信息（有限状态自动机和泵引理）。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2008-10-24T12:22:13.550

根据您的自信程度，我会给出以下答案：

> 我不会用正则表达式来做。这不是正则表达式的适当使用。

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2010-07-12T04:08:28.597

**是**的，您可以在 .Net 中完成！

```
(?<N>.)+.?(?<-N>\k<N>)+(?(N)(?!)) 
```

你可以[在这里查看](http://blog.stevenlevithan.com/archives/balancing-groups)！这是一个很棒的帖子！

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2015-02-23T14:38:43.130

StackOverflow 充满了诸如“正则表达式？不，他们不支持它。他们*不能*支持它。”之类的答案。

事实是，**正则表达式不再与*正则语法*有任何关系。**现代正则表达式具有递归和平衡组等功能，并且其实现的可用性不断增长（例如，请参见此处的 Ruby 示例）。在我看来，坚持认为我们领域中的正则表达式不是编程概念的旧观念只会适得其反。与其因为不再是最合适的词选择而讨厌他们，而是我们接受事物并继续前进的时候了。

这是Perl 本身的创建者[Larry Wall 的一句话：](http://www.perl6.org/archive/doc/design/apo/A05.html)

> （……）通常与我们所说的“正则表达式”有关，它们与真正的正则表达式关系不大。尽管如此，这个术语随着我们模式匹配引擎的功能而增长，所以我不打算在这里与语言的必要性作斗争。然而，我通常会称它们为“正则表达式”（或“正则表达式”，当我处于盎格鲁-撒克逊语境中时）。

这[是 PHP 的核心开发人员之一的](https://github.com/nikic)博客[文章](https://nikic.github.io/2012/06/15/The-true-power-of-regular-expressions.html)：

> 由于文章比较长，这里总结一下要点：
> 
> *   程序员使用的“正则表达式”与形式语言理论背景下的原始规则概念几乎没有共同之处。
> *   正则表达式（至少 PCRE）可以匹配所有上下文无关语言。因此，它们也可以匹配格式良好的 HTML 和几乎所有其他编程语言。
> *   正则表达式至少可以匹配一些上下文相关的语言。
> *   正则表达式的匹配是 NP 完全的。因此，您可以使用正则表达式解决任何其他 NP 问题。

话虽如此，您可以使用以下方法将回文与正则表达式匹配：

```
^(?'letter'[a-z])+[a-z]?(?:\k'letter'(?'-letter'))+(?(letter)(?!))$ 
```

...这显然与常规语法无关。
更多信息在这里：[http ://www.regular-expressions.info/balancing.html](http://www.regular-expressions.info/balancing.html)

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2009-09-21T08:32:31.347

正如一些人已经说过的那样，没有一个单一的正则表达式可以检测到开箱即用的一般回文，但是如果你想检测到一定长度的回文，你可以使用类似的东西

```
(.?)(.?)(.?)(.?)(.?).?\5\4\3\2\1 
```

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2016-11-24T18:32:44.480

您也可以在不使用递归的情况下执行此操作：

```
\A(?:(.)(?=.*?((?(2)\1\2|\1))\z))*?.?\2\z 
```

允许单个字符：

```
\A(?:(?:(.)(?=.*?((?(2)\1\2|\1))\z))*?.?\2|.)\z 
```

与 Perl、PCRE 一起使用

[演示](https://regex101.com/r/fSvsrx/1)

对于 Java：

```
\A(?:(.)(?=.*?(\1\2\z|(?<!(?=\2\z).{0,1000})\1\z)))*?.?\2\z 
```

[演示](https://www.regexplanet.com/share/index.html?share=yyyydzyvbar)

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2014-03-07T21:50:19.503

现在可以在 Perl 中完成。使用递归引用：

```
if($istr =~ /^((\w)(?1)\g{-1}|\w?)$/){
    print $istr," is palindrome\n";
} 
```

根据最近的最后一部分修改[http://perldoc.perl.org/perlretut.html](http://perldoc.perl.org/perlretut.html)

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2012-06-28T13:54:34.450

在 ruby​​ 中，您可以使用命名的捕获组。所以这样的事情会起作用 -

```
def palindrome?(string)
  $1 if string =~ /\A(?<p>| \w | (?: (?<l>\w) \g<p> \k<l+0> ))\z/x
end 
```

试试吧，它的工作...

```
1.9.2p290 :017 > palindrome?("racecar")
 => "racecar" 
1.9.2p290 :018 > palindrome?("kayak")
 => "kayak" 
1.9.2p290 :019 > palindrome?("woahitworks!")
 => nil 
```

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2018-02-04T13:37:08.077

## 递归正则表达式可以做到！

如此简单且不言而喻的算法来检测包含回文的字符串：

```
 (\w)(?:(?R)|\w?)\1 
```

在[rexegg.com/regex-recursion](http://www.rexegg.com/regex-recursion.html)教程解释了它是如何工作的。

* * *

它适用于任何语言，这里有一个使用 PHP 改编自与概念验证相同的源（链接）的示例：

```
$subjects=['dont','o','oo','kook','book','paper','kayak','okonoko','aaaaa','bbbb'];
$pattern='/(\w)(?:(?R)|\w?)\1/';
foreach ($subjects as $sub) {
  echo $sub." ".str_repeat('-',15-strlen($sub))."-> ";
  if (preg_match($pattern,$sub,$m)) 
      echo $m[0].(($m[0]==$sub)? "! a palindrome!\n": "\n");
  else 
      echo "sorry, no match\n";
} 
```

输出

```
dont ------------> sorry, no match
o ---------------> sorry, no match
oo --------------> oo! a palindrome!
kook ------------> kook! a palindrome!
book ------------> oo
paper -----------> pap
kayak -----------> kayak! a palindrome!
okonoko ---------> okonoko! a palindrome!
aaaaa -----------> aaaaa! a palindrome!
bbbb ------------> bbb 
```

* * *

## 比较

正则表达式`^((\w)(?:(?1)|\w?)\2)$` 做同样的工作，但作为“是/不是”而不是“包含”。
PS：它使用的定义是“o”不是回文，“able-elba”连字符格式不是回文，但“ableelba”是。将其命名为**定义1**。
当 "o" 和 "able-elba" 是回文时，命名为**definition2**。

与另一个“回文正则表达式”相比，

*   `^((.)(?:(?1)|.?)\2)$`上面的基本正则表达式没有`\w`限制，接受“able-elba”。

*   `^((.)(?1)?\2|.)$`（[@LilDevil](https://stackoverflow.com/a/9639518)）使用*定义*2 （接受“o”和“able-elba”，因此在识别“aaaaa”和“bbbb”字符串方面也存在差异）。

*   `^((.)(?1)\2|.?)$`（[@Markus](https://stackoverflow.com/a/233326)）未检测到“kook”和“bbbb”

*   `^((.)(?1)*\2|.?)$`( [@Csaba](https://stackoverflow.com/a/630063) ) 使用*定义*2 。

* * *

`$subjects`注意：要进行比较，您可以在每个比较的正则表达式中添加更多单词和一行，

```
 if (preg_match('/^((.)(?:(?1)|.?)\2)$/',$sub)) echo " ...reg_base($sub)!\n";
  if (preg_match('/^((.)(?1)?\2|.)$/',$sub)) echo " ...reg2($sub)!\n";
  if (preg_match('/^((.)(?1)\2|.?)$/',$sub)) echo " ...reg3($sub)!\n";
  if (preg_match('/^((.)(?1)*\2|.?)$/',$sub)) echo " ...reg4($sub)!\n"; 
```

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2014-08-20T22:12:42.253

[这是我对Regex Golf 第 5 级](https://regex.alf.nu/5)（一个人，一个计划）的回答。它适用于浏览器的 Regexp 最多 7 个字符（我使用的是 Chrome 36.0.1985.143）。

```
^(.)(.)(?:(.).?\3?)?\2\1$ 
```

这是一个最多 9 个字符的

```
^(.)(.)(?:(.)(?:(.).?\4?)?\3?)?\2\1$ 
```

为了增加它可以工作的最大字符数，你会反复替换**.?** 与**(?:(.).?\n?)?** .

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2008-10-24T12:25:45.713

使用字符串操作而不是正则表达式实际上更容易做到这一点：

```
bool isPalindrome(String s1)

{

    String s2 = s1.reverse;

    return s2 == s1;
} 
```

我意识到这并不能真正回答面试问题，但你可以用它来展示你如何知道更好的完成任务的方法，而且你不是典型的“拿着锤子的人，把每个问题都看成钉子” 。”

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2009-03-10T13:06:40.750

关于 PCRE 表达式（来自 MizardX）：

/^((.)(?1)\2|.?)$/

你测试过吗？在我的 Win XP Pro 下的 PHP 5.3 上它失败了：aaaba 实际上，我稍微修改了表达式表达式，改为：

/^((.)(?1)*\2|.?)$/

我认为正在发生的事情是，虽然外部的一对角色被锚定了，但其余的内部角色却没有。这并不是完整的答案，因为虽然它错误地传递了“aaaba”和“aabaacaa”，但它确实在“aabaaca”上失败了。

我想知道是否有对此进行修复，以及 Perl 示例（由 JF Sebastian / Zsolt 编写）是否正确通过了我的测试？

来自维也纳的 Csaba Gabor

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2016-05-26T10:41:07.700

```
/\A(?<a>|.|(?:(?<b>.)\g<a>\k<b+0>))\z/ 
```

它适用于 Oniguruma 引擎（在 Ruby 中使用）

取自[实用书架](https://media.pragprog.com/titles/ruby3/ruby3_extract_regular_expressions.pdf)

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2008-11-03T22:04:04.967

在 Perl 中（另见[Zsolt Botykai 的回答](https://stackoverflow.com/questions/233243/how-to-check-that-a-string-is-a-palindrome-using-regular-expressions#235199)）：

```
$re = qr/
  .                 # single letter is a palindrome
  |
  (.)               # first letter
  (??{ $re })??     # apply recursivly (not interpolated yet)
  \1                # last letter
/x;

while(<>) {
    chomp;
    say if /^$re$/; # print palindromes
} 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2008-10-24T13:30:39.390

[正如ZCHudson](https://stackoverflow.com/questions/233243/how-to-check-that-a-string-is-a-palindrome-using-regular-expressions#233291)所指出的，确定某事是否是回文无法使用通常的正则表达式来完成，因为回文集不是常规语言。

[当Airsource Ltd](https://stackoverflow.com/questions/233243/how-to-check-that-a-string-is-a-palindrome-using-regular-expressions#233296) 说“这不可能”不是面试官想要的答案时，我完全不同意他的看法。在我的面试中，当我面对一个好的候选人时，我会提出这样的问题，以检查当我们向他提出做错事时，他是否能找到正确的论点。我不想雇用一个如果他知道更好的人就会试图以错误的方式做某事的人。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2008-10-24T20:44:35.830

你可以用 perl 做些什么：[http ://www.perlmonks.org/?node_id=577368](http://www.perlmonks.org/?node_id=577368)

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2008-12-17T18:22:59.820

我会向面试官解释，由回文组成的语言不是常规语言，而是上下文无关的。

匹配所有回文的正则表达式将是*无限*的。相反，我建议他将自己限制在可以接受的最大回文数；或者如果需要所有回文，至少使用某种类型的 NDPA，或者只使用简单的字符串反转/等于技术。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2011-10-30T13:10:36.853

在用完捕获组之前，您可以使用正则表达式做的最好的事情：

```
/(.?)(.?)(.?)(.?)(.?)(.?)(.?)(.?)(.?).?\9\8\7\6\5\4\3\2\1/ 
```

这将匹配长度不超过 19 个字符的所有回文。

以编程方式解决所有长度是微不足道的：

```
str == str.reverse ? true : false 
```

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2012-03-09T18:59:56.010

我还没有代表内联评论，但是 MizardX 提供并由 Csaba 修改的正则表达式可以进一步修改以使其在 PCRE 中工作。我发现的唯一失败是单字符字符串，但我可以单独测试。

`/^((.)(?1)?\2|.)$/`

如果您可以使其在任何其他字符串上失败，请发表评论。

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2013-01-10T05:10:19.310

```
#!/usr/bin/perl

use strict;
use warnings;

print "Enter your string: ";
chop(my $a = scalar(<STDIN>));    
my $m = (length($a)+1)/2;
if( (length($a) % 2 != 0 ) or length($a) > 1 ) { 
  my $r; 
  foreach (0 ..($m - 2)){
    $r .= "(.)";
  }
  $r .= ".?";
  foreach ( my $i = ($m-1); $i > 0; $i-- ) { 
    $r .= "\\$i";
  } 
  if ( $a =~ /(.)(.).\2\1/ ){
    print "$a is a palindrome\n";
  }
  else {
    print "$a not a palindrome\n";
 }
exit(1);
}
print "$a not a palindrome\n"; 
```

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2013-08-15T18:30:34.643

从自动机理论来看，它不可能匹配任何长度的回文（因为这需要无限量的内存）。但是有可能匹配固定长度的回文。说它可以编写一个匹配所有长度 <= 5 或 <= 6 等回文数的正则表达式，但不匹配 >=5 等上限不清楚的地方

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2014-09-08T10:14:11.083

在 Ruby 中，您可以使用`\b(?'word'(?'letter'[a-z])\g'word'\k'letter+0'|[a-z])\b`来匹配回文词，例如`a, dad, radar, racecar, and redivider`. ps：这个正则表达式只匹配长度为奇数个字母的回文词。

让我们看看这个正则表达式如何匹配雷达。单词边界 \b 在字符串的开头匹配。正则表达式引擎输入捕获组“word”。[az] 匹配 r，然后将其存储在递归级别为零的捕获组“字母”的堆栈中。现在正则表达式引擎进入组“word”的第一个递归。(?'letter'[az]) 在递归级别 1 匹配并捕获 a。正则表达式输入组“单词”的第二次递归。(?'letter'[az]) 在递归级别 2 捕获 d。在接下来的两次递归中，该组在第三和第四级捕获 a 和 r。第五次递归失败，因为字符串中没有字符可供 [az] 匹配。正则表达式引擎必须回溯。

正则表达式引擎现在必须尝试组“word”中的第二种选择。正则表达式中的第二个 [az] 匹配字符串中的最后一个 r。引擎现在从成功的递归中退出，返回到第三次递归。

在匹配 (&word) 之后，引擎到达 \k'letter+0'。反向引用失败，因为正则表达式引擎已经到达主题字符串的末尾。于是又一次回溯。第二种选择现在与 a 匹配。正则表达式引擎退出第三次递归。

正则表达式引擎再次匹配 (&word)，需要再次尝试反向引用。反向引用指定 +0 或当前的递归级别，即 2。在此级别，捕获组匹配 d。反向引用失败，因为字符串中的下一个字符是 r。再次回溯，第二个选择匹配 d。

现在，\k'letter+0' 匹配字符串中的第二个 a。这是因为正则表达式引擎已经返回到捕获组匹配第一个 a 的第一个递归。正则表达式引擎退出第一个递归。

正则表达式引擎现在回到所有递归之外。即这个级别，捕获组存储了 r。反向引用现在可以匹配字符串中的最后一个 r。由于引擎不再在任何递归内部，因此它继续执行组之后的正则表达式的其余部分。\b 匹配字符串的末尾。到达正则表达式的末尾，雷达作为整体匹配返回。

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2015-12-15T07:08:34.943

这是 PL/SQL 代码，它使用正则表达式判断给定字符串是否为回文：

```
create or replace procedure palin_test(palin in varchar2) is
 tmp varchar2(100);
 i number := 0;
 BEGIN
 tmp := palin;
 for i in 1 .. length(palin)/2 loop
  if length(tmp) > 1 then  
    if regexp_like(tmp,'^(^.).*(\1)$') = true then 
      tmp := substr(palin,i+1,length(tmp)-2);
    else 
      dbms_output.put_line('not a palindrome');
      exit;
    end if;
  end if;  
  if i >= length(palin)/2 then 
   dbms_output.put_line('Yes ! it is a palindrome');
  end if;
 end loop;  
end palin_test; 
```

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2017-01-29T18:23:40.277

```
my $pal='malayalam';

while($pal=~/((.)(.*)\2)/){                                 #checking palindrome word
    $pal=$3;
}
if ($pal=~/^.?$/i){                                         #matches single letter or no letter
    print"palindrome\n";
}
else{
    print"not palindrome\n";
} 
```

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2020-02-06T00:52:30.470

此正则表达式将检测最多 22 个字符的回文，忽略空格、制表符、逗号和引号。

```
\b(\w)[ \t,'"]*(?:(\w)[ \t,'"]*(?:(\w)[ \t,'"]*(?:(\w)[ \t,'"]*(?:(\w)[ \t,'"]*(?:(\w)[ \t,'"]*(?:(\w)[ \t,'"]*(?:(\w)[ \t,'"]*(?:(\w)[ \t,'"]*(?:(\w)[ \t,'"]*(?:(\w)[ \t,'"]*\11?[ \t,'"]*\10|\10?)[ \t,'"]*\9|\9?)[ \t,'"]*\8|\8?)[ \t,'"]*\7|\7?)[ \t,'"]*\6|\6?)[ \t,'"]*\5|\5?)[ \t,'"]*\4|\4?)[ \t,'"]*\3|\3?)[ \t,'"]*\2|\2?))?[ \t,'"]*\1\b 
```

在这里玩它：[https ://regexr.com/4tmui](https://regexr.com/4tmui)

我在这里写了一个解释：[https ://medium.com/analytics-vidhya/coding-the-impossible-palindrome-detector-with-a-regular-expressions-cd76bc23b89b](https://medium.com/analytics-vidhya/coding-the-impossible-palindrome-detector-with-a-regular-expressions-cd76bc23b89b)

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2009-09-21T08:17:26.487

Airsource Ltd 方法的轻微改进，伪代码：

```
WHILE string.length > 1
    IF /(.)(.*)\1/ matches string
        string = \2
    ELSE
        REJECT
ACCEPT 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2018-01-03T15:59:29.200

`\b([a-z])?([a-z])?([a-z])?\2\1\b/gi`

匹配 5 个字母回文，例如 refer 和 kayak。它使用任意三个字母的（非贪婪）匹配来做到这一点，然后是第二个和第一个匹配的字母。

[使用此链接到 regex101 站点](https://regex101.com/r/SjrxXx/2)

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2018-05-19T15:53:34.263

在 JavaScript 中，它是通过键入来完成的

```
 function palindrome(str) {
  var symbol = /\W|_/g;
  str = str.replace(symbol, "").toLowerCase();
  var palindrome = str.split("").reverse("").join("");
  return (str === palindrome);
} 
```

# html - 如何在不使用 Javascript 的情况下在 HTML 中创建菜单？

> ID：233251
> 
> 赞同：5
> 
> 时间：2008-10-24T12:13:53.053
> 
> 标签：html, css, xhtml, menu

多年来，GUI 标准是应用程序的菜单栏，如果您单击或悬停菜单栏中的条目，则会弹出菜单。一些网站也实现了这个功能，但据我所知，它们使用的是 Javascript。由于不同的原因，Javascript 可能是一个问题，所以问题是：这是否可以在没有 Javascript 的情况下仅使用 HTML 和 CSS 来实现？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-24T12:21:32.553

我以前做过类似的事情，这是通过将菜单项放置在锚标记中来实现的，在这些锚标记中隐藏 div 中的子菜单。CSS 技巧是让内部 div 在 a:hover 事件期间出现。

它看起来像：

```
<style>
    A DIV { display: none; }
    A:hover DIV { display: block; }
</style>
<a href="blah.htm">
    Top Level Menu Text
    <div><ul>
        <li><a href="sub1.htm">Sub Item 1</a></li>
        <li><a href="sub2.htm">Sub Item 2</a></li>
        <li><a href="sub3.htm">Sub Item 3</a></li>
    </ul></div>
</a> 
```

你的旅费可能会改变...

编辑：Internet Explorer 6 及更低版本不支持除 A 之外的其他元素上的 :hover 伪类。在更“现代”的浏览器中，可以接受能够将此技巧与 LI、TD、DIV、SPAN 和大多数任何标签。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-24T12:22:42.350

看看[CSS 菜单制作器](http://www.cssmenumaker.com/)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-24T12:29:57.047

最著名的技术是[吸盘鱼菜单](http://www.alistapart.com/articles/dropdowns)。搜索它会产生很多有趣的菜单。它只需要 IE6 及更低版本的 javascript。

[这是吸盘鱼菜单的儿子列表。](http://www.htmldog.com/articles/suckerfish/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-24T13:25:06.780

考虑使用 CSS 方法作为 JavaScript 不可用时的备份。JavaScript 可以* 为下拉菜单提供更好的用户体验，因为您可以添加一些延迟因素来阻止菜单在鼠标短暂离开其悬停区域时立即消失。纯 CSS 菜单有时使用起来有点挑剔，尤其是在悬停目标很小的情况下。

*：当然，并不是所有的菜单脚本都真正费心去做这件事……

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-24T12:20:13.023

您可以使用伪类 :hover 来获得悬停效果。

```
a:link {
 color: blue;
}

a:hover {
  color: red;
} 
```

我可以举一个更广泛的例子，但不是现在（需要让孩子去看牙医）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-24T13:41:55.263

还有[Eric Meyer](http://en.wikipedia.org/wiki/Eric_Meyer)关于[**纯 CSS 菜单**](http://meyerweb.com/eric/css/edge/menus/demo.html)的原创文章。

其他人现在提到的肯定会有更强大和现代的外卖，但我想我会为后代提及它。:)

# c# - SetUnhandledExceptionFilter 如何在 .NET WinForms 应用程序中工作？

> ID：233255
> 
> 赞同：10
> 
> 时间：2008-10-24T12:15:48.587
> 
> 标签：c#, .net, debugging, clrdump

我正在做一个项目来增强我们的生产调试能力。我们的目标是在任何未处理的异常上可靠地生成一个小型转储，无论该异常是托管的还是非托管的，以及它是否发生在托管或非托管线程上。

我们目前为此使用了出色的[ClrDump](http://www.debuginfo.com/tools/clrdump.html)库，但它并不能完全提供我们需要的确切功能，我想了解异常过滤背后的机制，所以我开始亲自尝试一下。

我开始按照这篇博客文章自己安装 SEH 处理程序：http: [//blogs.microsoft.co.il/blogs/sasha/archive/2007/12.aspx](http://blogs.microsoft.co.il/blogs/sasha/archive/2007/12.aspx)。这种技术适用于控制台应用程序，但是当我从 WinForms 应用程序尝试相同的事情时，我的过滤器不会针对任何种类的非托管异常调用。

ClrDump 可以做什么我没有做的事情？ClrDump 在所有情况下都会产生转储，因此仍必须调用其异常过滤器...

注意：我知道 ADPlus 的功能，我们也考虑过使用 AeDebug 注册表项......这些也是可能的，但也有它们的权衡。

谢谢，戴夫

```
// Code adapted from <http://blogs.microsoft.co.il/blogs/sasha/archive/2007/12.aspx>
LONG WINAPI MyExceptionFilter(__in struct _EXCEPTION_POINTERS *ExceptionInfo)
{
   printf("Native exception filter: %X\n",ExceptionInfo->ExceptionRecord->ExceptionCode);

   Beep(1000,1000);
   Sleep(500);
   Beep(1000,1000);

   if(oldFilter_ == NULL)
   {
      return EXCEPTION_CONTINUE_SEARCH;
   }

   LONG ret = oldFilter_(ExceptionInfo);
   printf("Other handler returned %d\n",ret);

   return ret;
}

#pragma managed

namespace SEHInstaller
{
   public ref class SEHInstall
   {
   public:
      static void InstallHandler()
      {    
         oldFilter_ = SetUnhandledExceptionFilter(MyExceptionFilter);
         printf("Installed handler old=%x\n",oldFilter_);
      }

   };
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-26T17:55:01.577

Windows 窗体有一个内置的异常处理程序，默认情况下执行以下操作：

*   在以下情况下捕获未处理的托管异常：
    *   没有附加调试器，并且
    *   窗口消息处理期间发生异常，并且
    *   App.Config 中的 jitDebugging = false。
*   向用户显示对话框并防止应用程序终止。

**您可以通过在 App.Config 中设置jitDebugging = true**来禁用第一个行为。这意味着您停止应用程序终止的最后机会是通过注册事件 Application.ThreadException 来捕获未处理的异常，例如在 C# 中：

```
Application.ThreadException += new Threading.ThreadExceptionHandler(CatchFormsExceptions); 
```

如果您决定不在这里捕获未处理的异常，则需要检查和/或更改HKLM\Software.NetFramework 下的注册表设置**DbgJitDebugLaunchSetting 。**这具有我知道的三个值之一：

*   0：显示询问“调试或终止”的用户对话框。
*   1：让异常通过让CLR来处理。
*   2：启动 DbgManagedDebugger 注册表项中指定的调试器。

在 Visual Studio 中，转到 Tools>Options>Debugging>JIT 将此键设置为 0 或 2。但值 1 通常是您在最终用户计算机上想要的值。请注意，此注册表项是在您讨论的 CLR 未处理异常事件之前执行的。

然后您可以设置您讨论的本机异常过滤器。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-09-26T18:15:43.100

如果您希望您的 GUI 线程异常像您的非 GUI 线程一样工作，以便以相同的方式处理它们，您可以这样做：

```
Application.SetUnhandledExceptionMode(UnhandledExceptionMode.ThrowException); 
```

这是背景：

在托管的 GUI 应用程序中，默认情况下，源自 GUI 线程的异常由分配给 Application.ThreadException 的任何内容处理，您可以像这样自定义：

```
Application.ThreadException += 
    new System.Threading.ThreadExceptionEventHandler(Application_ThreadException); 
```

源自其他线程的异常由 AppDomain.CurrentDomain.UnhandledException 处理，您可以像这样自定义：

```
AppDomain.CurrentDomain.UnhandledException += 
    new UnhandledExceptionEventHandler(Program.CurrentDomain_UnhandledException); 
```

分配给 UnHandledException 的工作方式与调用 Win32 SetUnhandledExceptionFilter 完全相同。

如果您的目标是创建小型转储然后使用它们，则需要使用 Windows 调试工具 sos.dll。您需要生成小型转储 MiniDumpWithFullMemory。

然后，即使那样，你也可能不会拥有你想要的一切。System.Diagnostics.StackTrace 获取调用托管调用堆栈。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-24T14:22:30.627

SetUnhandledExceptionFilter 安装一个处理程序，当 Win32 异常到达线程调用堆栈的顶部而没有被处理时调用该处理程序。

在包括托管在内的许多语言运行时中，语言异常是使用 Win32 异常实现的。但是，托管运行时将在每个线程的顶部有一个顶级 __try __catch(...) 块，它将捕获任何 win32 运行时异常并处理它们，而不会让它们逃逸到 Win32 的顶级处理程序。

在此级别注入处理程序需要了解特定运行时的知识，因为永远不会允许异常逃逸到 Win32 的 TheadProc 处理程序。

# c++ - 内存泄漏是否有可接受的限制？

> ID：233258
> 
> 赞同：21
> 
> 时间：2008-10-24T12:17:26.773
> 
> 标签：c++, memory-leaks, sdl

我刚刚开始在 C++ 中尝试使用 SDL，我认为定期检查内存泄漏可能是早期形成的一个好习惯。

考虑到这一点，我一直在通过 Valgrind 运行我的“Hello world”程序以捕获任何泄漏，尽管我已经删除了除了最基本的`SDL_Init()`和`SDL_Quit()`语句之外的所有内容，但 Valgrind 仍然报告丢失了 120 个字节并且仍然可以访问 77k。

我的问题是：内存泄漏是否存在可接受的限制，或者我应该努力使我的所有代码完全无泄漏？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-24T12:32:31.237

请注意，Valgrind 不会在其测量中发现误报。

许多内存分析器的幼稚实现将丢失的内存标记为泄漏，而实际上并非如此。

Maybe have a read of some of the papers in the external links section of the [Wikipedia article on Purify](http://en.wikipedia.org/wiki/IBM_Rational_Purify). I know that the documentation that comes with Purify describes several scenarios where you get false positives when trying to detect memory leaks and then goes on to describe the techniques Purify uses to get around the issues.

BTW I'm not affiliated with IBM in any way. I've just used Purify extensively and will vouch for its effectiveness.

Edit: Here's an [excellent introductory article](http://www.ibm.com/developerworks/rational/library/06/0822_satish-giridhar/) covering memory monitoring. It's Purify specific but the discussion on types of memory errors is very interesting.

HTH.

cheers,

Rob

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-24T12:46:33.953

You have to be careful with the definition of "memory leak". Something which is allocated once on first use, and freed on program exit, will sometimes be shown up by a leak-detector, because it started counting before that first use. But it's not a leak (although it may be bad design, since it may be some kind of global).

To see whether a given chunk of code leaks, you might reasonably run it once, then clear the leak-detector, then run it again (this of course requires programmatic control of the leak detector). Things which "leak" once per run of the program usually don't matter. Things which "leak" every time they're executed usually do matter eventually.

I've rarely found it too difficult to hit zero on this metric, which is equivalent to observing creeping memory usage as opposed to lost blocks. I had one library where it got so fiddly, with caches and UI furniture and whatnot, that I just ran my test suite three times over, and ignored any "leaks" which didn't occur in multiples of three blocks. I still caught all or almost all the real leaks, and analysed the tricky reports once I'd got the low-hanging fruit out of the way. Of course the weaknesses of using the test suite for this purpose are (1) you can only use the parts of it that don't require a new process, and (2) most of the leaks you find are the fault of the test code, not the library code...

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-24T14:15:03.480

Living with memory leaks (and other careless issues) is, at its best, (in my opinion) very bad programming. At its worst it makes software unusable.

You should avoid introducing them in the first place and run the tools you and others have mentioned to try to detect them.

Avoid sloppy programming - there are enough bad programmers out there already - the world doesn't need another one.

EDIT

I agree - many tools can provide false positives.

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-10-24T12:25:43.590

如果您真的担心内存泄漏，则需要进行一些计算。

您需要测试您的应用程序一个小时，然后计算泄漏的内存。这样，您将获得泄漏的内存字节/分钟值。

现在，您需要估计程序会话的平均长度。例如，对于 notepad.exe，15 分钟听起来对我来说是一个不错的估计。

如果 (**平均会话长度)*(泄漏字节/分钟) > 0.3 * (您的进程通常占用的内存空间)**，那么您可能应该做更多的努力来减少内存泄漏。我刚刚补了0.3，用常识来确定你可以接受的阈值。

请记住，成为一名程序员的一个重要方面是成为一名软件工程师，而工程通常是关于从两个或多个糟糕的选项中选择最差的选项。当您需要衡量一个选项实际上有多糟糕时，数学总是很方便。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-10-24T14:05:56.447

Most OSes (including Windows) will give back all of a program's allocated memory when the program is unloaded. This includes any memory which the program itself may have lost track of.

Given that, my usual theory is that it's perfectly fine to leak memory during startup, but *not* OK to do it during runtime.

So really the question isn't if you are leaking *any* memory, it is if you are continually leaking it during your program's runtime. If you *use* your program for a while, and no matter what you do it stays at 120 bytes lost rather than increasing, I'd say you have done great. Move on.

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-10-24T12:24:38.053

对于桌面应用程序，小的内存泄漏并不是真正的问题。对于服务（服务器），不允许出现内存泄漏。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-24T12:19:52.027

这取决于您的应用程序。一些泄漏可能是不可避免的（由于查找泄漏所需的时间与截止日期相比）。只要您的应用程序可以随心所欲地运行，并且在那段时间内不占用大量内存，那可能就可以了。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-12T03:50:12.367

It does look like SDL developers don't use Valgrind, but I basically only care about those 120 bytes lost.

> With this in mind, I've been running my 'Hello world' programs through Valgrind to catch any leaks, and although I've removed everything except the most basic SDL_Init() and SDL_Quit() statements, Valgrind still reports 120 bytes lost and 77k still reachable.

Well, with Valgrind, "still reachable memory" is often not really leaked memory, especially in such a simple program. I can bet safely that there is basically no allocation in SDL_Quit(), so the "leaks" are just structures allocated once by SDL_Init().

Try adding useful work and seeing if those amounts increase; try making a loop of useful work (like creating and destroying some SDL structure) and see if the amount of leaks grows with the amount of iterations. In the latter case, you should check the stack traces of the leaks and fix them.

Otherwise, those 77k leaks count as "memory which should be freed at program end, but for which they rely on the OS to free it.

So, actually, I'm more worried right now by those 120 bytes, if they are not false positives, and they are usually few. False positives with Valgrind are mostly cases where usage of uninitialized memory is intended (for instance because it is actually padding).

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-24T12:47:43.093

As per Rob Wells' comments on Purify, download and try out some of the other tools out there. I use BoundsChecker and AQTime, and have seen different false positives in both over the years. Note that the memory leak might also be in a third party component, which you may want to exclude from your analysis. From example, MFC had a number of memory leaks in the first view versions.

IMO, memory leaks should be tracked down for any code that is going into a code base that may have a long life. If you can't track them down, at least make a note that they exist for the next user of the same code.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-24T12:56:25.293

Firstable memory leaks are only a serious problem when they grow with time, otherwise the app just looks a little bigger from the outside (obviously there's a limit here too, hence the 'serious'). When you have a leak that grows with time you might be in trouble. How much trouble depends on the circumstances though. If you *know* where the memory is going and can make sure that you'll always have enough memory to run the program and everything else on that machine you are still somewhat fine. If you don't know where the memory is going however, i wouldn't ship the program and keep digging.

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-22T02:24:51.447

With SDL on Linux in particular, there seem to be some leaking in the underlying X windows library. There's nothing much you can do about those (unless you want to try to fix the library itself, which is probably not for the faint hearted).

You can use valgrind's suppression mechanism (see --suppressions and --gen-suppressions in the valgrind man page) to tell it not to bother you with these errors.

In general we do have to be a little more lenient with third party libraries; while we should absolutely not accept memory leaks in our own code, and the presence of memory leaks should be a factor when choosing between alternative third party libraries, sometimes there's no choice but to ignore them (though it may be a good idea to report them to the library maintainer).

# email - 我正在寻找有关处理电子邮件的 ActiveX 组件的建议

> ID：233259
> 
> 赞同：1
> 
> 时间：2008-10-24T12:18:37.100
> 
> 标签：email, activex, smtp, pop3, ocx

我正在寻找可以轻松执行以下操作的 ActiveX 组件：

*   通过 SMTP 和 POP3 获取和发送电子邮件
*   剥离并保存附件。
*   将 RTF（Outlook 电子邮件）转换为 HTML
*   清理 HTML。

您会推荐哪些组件？你使用什么组件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T12:52:24.520

使用 CDOSYS，Sendong 和接收电子邮件很简单。RTF 并不是一种复杂的格式来处理。但我认为 Chilkat SMTP/POP# ActiveX 组件是您可能想要研究的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T22:25:36.713

seanyboy，我可以在这里为您提供帮助，但在您查看商业解决方案之前，您需要了解几件事。

首先，有数百或数千个控件可以执行您想要的操作。

但是，您必须考虑如何使用它们。我曾经在一家反病毒公司工作，当我们决定将我们的产品挂接到 Exchange 时，很明显我们选择的解决方案行不通。问题是，商业应用程序（通常）遵循 RFC 到 T。（或者是 TEE？我不知道..）但是，病毒从不遵循 RFC 标准。所以，我最终为我们的扫描仪编写了自己的 Mime 解析器，我的检测率比我们尝试过的任何其他方法都要好得多。为什么？因为每次我发现一封破坏 RFC 的电子邮件时，我都会调整代码来处理它。想到的一个例子是“Content-Type: maintype/subtype; param =”。注意 param 和 equals 后面的空格。这违反了 RFC 规则，但大多数邮件阅读器都会处理它，从而允许病毒做它的事情。

但是，这也是一个双面硬币......在我的代码中，我无法解码格式如下的附件：

……
`Content-Type: application/octet-stream
Content-Transfer-Encoding: base64`

`[http://virus.virussite.com](http://virus.virussite.com)
JVBERi0xLjMgCiXi48/TIAo3IDAgb2JqCjw8Ci9Db250ZW50cyBbIDggMCBSIF0gCi9QYXJlbnQg NSAwIFIKL1Jlc291cmNlcyA2IDAgUgovVHlwZSAvUGFnZQo+PgplbmRvYmoKNiAwIG9iago8PAov`
...

但是，商业应用程序解析它没有问题......很可能是因为他们再次遵循 RFC，并且如果它不完全是 77 个字符长，则不接受 Base64 数据（我认为 77 是 RFC 标准。我有参考它。）。

但是，我遇到了更大的问题，B64 损坏，B64 全部运行在一条线上，等等，它必须被解码，所以我把数据块中的所有内容都当作 Base64 数据，实际上是一个有效的 base64 字符。其他的都直接跳过了……

无论如何，他们的关键是，决定你需要什么不受这个控制，然后决定你是否想考虑自己写，买一个商业的，甚至付钱给别人（比如我自己）为你写一个。

(I'm not exactly sure my last sentence is acceptable by Stack Overflow rules, so I'm not soliciting you, just tell you know your options. I mention this option because you'd have access to the source code, and would be able to maintain it yourself, or find someone else to maintain it, if you decided to break relations with your developer. This is not an option for 99.99% of the commercial solutions...) If they make a change that screws you or your application, you are well, screwed.. :)

Hope this helps, or at least gives you something to read. heh..

Let me know if I can be of any more help.

# asp.net-mvc - 将 Viewdata 作为成员从其他 viewdata 传递给 RenderPartial 使第一个 null

> ID：233261
> 
> 赞同：0
> 
> 时间：2008-10-24T12:18:51.513
> 
> 标签：asp.net-mvc, renderpartial

强类型`SearchViewData`有一个名为 Colors 的字段，它又是一个`ColorViewData`. 在我的我根据给定的搜索条件`/Colors.mvc/search`填充它。`viewData.Model.Colors`然后，基于几个因素，我渲染了一组用户控件中的一个，这些控件能够使用`ColorViewData`.
所以我最终会得到：

```
<%Html.RenderPartial("~/Views/Color/_ColorList.ascx", ViewData.Model.Colors);%> 
```

这曾经工作得很好，但自从升级到 beta1，我的用户控件总是以`viewdata = null;`

建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T16:26:40.780

可能是过载问题。您可以调用 RenderPartial(string, object, ViewDataDictionary) 来明确所有三个参数。

我们计划更改的一件事是，如果您调用重载 RenderPartial(string, object)，我们会将当前 ViewDataDictionary 传递给部分。我们在 Beta 版中没有这样做，但似乎这是一个非常常见的场景，并且会使这种方法更有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T12:36:33.053

注意到同样的事情，我用以下方法修复了它，但我不确定它是否是“正确”的解决方案：

```
<% Html.RenderPartial("xxx", new ViewDataDictionary(ViewData.Model.Colors)); %> 
```

# nant - Nant：更改文件权限

> ID：233264
> 
> 赞同：8
> 
> 时间：2008-10-24T12:19:20.687
> 
> 标签：nant, file-permissions

我有一个 ASP.NET 应用程序。基本上交付过程是这样的：

*   Nant 构建应用程序并在开发人员的计算机上创建一个 zip 文件，其中包含没有 SVN 文件夹和无用文件的应用程序文件。此文件随 Nant 脚本一起提供。
*   将 zip 和 nant 文件复制到客户端的计算机
*   Nant 脚本将当前网站文件替换为 zip 文件中包含的文件。

我的问题是，在此过程中，当我尝试打开网站时出现未经授权的访问错误。似乎这些文件需要为用户“ **IIS_WPG** ”设置权限。

我无权更改 IIS 配置，因此我必须手动更改每个文件的权限。每次我替换文件时，权限都会被删除，我需要重新设置它们。

所以我有两个问题：

*   我可以使用 Nant 更改文件权限吗？怎么做 ？
*   有没有可能避免这个问题？（开发人员的计算机上没有此用户）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-24T13:06:59.390

@Jeff Fritz 哎哟......你的建议是正确的解决方案，但参数是......危险的:)。

在开发计算机上，我以管理员身份登录，并使用 cmd 尝试了您的建议。

*   它替换了所有权限集，以便仅设置命令中定义的权限（因此，在命令之后，即使使用我的管理员用户访问文件也会导致“访问被拒绝”）
*   它应用于 C:\WINDOWS\ 目录，而我从 wwwroot 文件夹调用命令。:)

所以，经过一些测试，正确的命令是：

```
cacls [full folder path] /T /E /G IIS_WPG:F 
```

*   /T : 适用于指定文件夹和子文件夹
*   /E :**编辑**ACL 而不是**替换**它 :)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-24T12:27:39.563

您需要在 Windows 中运行 CACLS 程序才能授予文件和文件夹的权限。在 Nant 中，您可以使用 EXEC 任务执行此操作。

尝试一个标签块，如：

```
<exec program="cacls">
    <arg value="*" />
    <arg value="/G IIS_WPG:F" />
</exec> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-24T16:49:21.547

我们最终用一些相当直接的代码为此编写了自己的任务：

```
[TaskName("addusertodir")]
public class AddUserToDirectorySecurity : Task
{
    [TaskAttribute("dir", Required=true)]
    public string DirPath { get; set; }

    [TaskAttribute("user", Required=true)]
    public string UserName { get; set; }

    protected override void ExecuteTask()
    {
        FileSystemAccessRule theRule1 = new FileSystemAccessRule(UserName, FileSystemRights.ListDirectory, AccessControlType.Allow);
        FileSystemAccessRule theRule2 = new FileSystemAccessRule(UserName, FileSystemRights.ReadAndExecute, AccessControlType.Allow);
        FileSystemAccessRule theRule3 = new FileSystemAccessRule(UserName, FileSystemRights.Read, AccessControlType.Allow);

        DirectorySecurity theDirSecurity = new DirectorySecurity();
        theDirSecurity.AddAccessRule(theRule1);
        theDirSecurity.AddAccessRule(theRule2);
        theDirSecurity.AddAccessRule(theRule3);
        Directory.SetAccessControl(DirPath, theDirSecurity);
    }
} 
```

然后你可以编写一个加载自定义任务并执行的 nant 脚本：

```
<loadtasks>
    <fileset>
        <include name="MyTask.dll"/>
    </fileset>
</loadtasks>

<addusertodir dir="MyDir" user="IIS_WPG"/> 
```

显然，这可以根据您的某些规则进行修改，或者如果您愿意，您甚至可以在任务中对其进行参数化。我们更喜欢使用 exec 任务，因为它让我们对正在应用的权限有更多的控制。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-22T17:46:43.320

CACLS 现在已弃用。这是一个使用 ICACLS 的版本，替代品。

假设我们有以下内容：

*   我们安装的根文件夹是“c:\inetpub\wwwroot”，它存储在 NANT 变量中`${paths.myprogram.inetpub}`
*   我们要修改的文件夹叫做“uploads”，它存放在`${upload.foldername}`
*   我们要授予访问权限的用户是“IIS_UPLOAD_USER”，存储在`${iis.upload.user}`
*   我们要授予的权限级别是“M”，用于“修改”权限，存储在`${iis.user.permissionlevel}`

有了这些假设，我们的任务是：

```
<exec program="icacls">
    <arg value="${path::combine(paths.myprogram.inetpub, upload.foldername)}" />
    <arg value="/grant" />
    <arg value="${iis.upload.user}:${iis.user.permissionlevel}" />
</exec> 
```

希望这可以帮助！

# php - Wordpress 中的启动页面

> ID：233283
> 
> 赞同：2
> 
> 时间：2008-10-24T12:23:29.540
> 
> 标签：php, javascript, css, wordpress

我正在创建一个包含成人内容的 Wordpress 博客，因此我需要在 Wordpress 中创建一个仅限首次使用的启动页面。第一次唯一的问题，我可以用 cookie 修复（虽然我知道不是每个人都启用了 cookie）

我可以做的是，创建一个脚本，如果 cookie 不存在，则加载另一个页面。或者我可以让启动页面成为我的主页，如果 cookie 存在，则重定向。

但这并不是我真正想要的。我不想麻烦页面。相反，我正在寻找一个灯箱式解决方案，它会使背景（主页）变暗并显示一个面板，可以选择留下还是离开。

我不知道如何开始这个。我熟悉 PHP、Javascript 和 CSS，所以我什至不要求代码。我只想要一个网络程序员对此的看法，以及如何按照我想要的方式创建启动页面的一些帮助。或者这是一个愚蠢的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T12:32:18.507

我会使用灯箱解决方案。

例如
[http://leandrovieira.com/projects/jquery/lightbox/](http://leandrovieira.com/projects/jquery/lightbox/)

这包括如何使用它的示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-24T12:34:26.663

我将为它创建 CSS，准备好一切，然后根据您的条件将其粘贴到标题中。这样，您就知道每个页面都会显示它，并且如果您被链接到，您就不会“脱裤子”。

我唯一关心的是确保灯箱效果覆盖任何图形，因为我确定您不希望在用户同意看到它之前显示它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-24T12:36:30.217

创建一点 JavaScript 代码来检查 cookie 并在未设置 cookie 时显示灯箱应该没有任何问题。JavaScript 可以简单地显示一个带有面板的 div，可以选择留下或离开。也许还有一个 div 可以使背景变暗，但你可以用任何你认为合适的方式来做到这一点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-04T23:16:20.753

我使用了建议的[JQuery ColorBox](http://www.jacklmoore.com/colorbox)解决方案，但是 inline 不起作用，`display: none`没有被 jQuery 更改，所以我使用了

```
$.colorbox({html:"<div id=\"splash-wrapper\"><h1>it works</h1></div>"}); 
```

它就像一个魅力

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-02-29T22:06:48.353

使用 Colorbox 并将其称为 onload

[http://jacklmoore.com/colorbox/example1/](http://jacklmoore.com/colorbox/example1/)

我正在使用它在加载时创建一个弹出窗口。它将 cookie 设置为每 30 天过期一次。创建一个`#inline_content`包含所有内容的 div 并将其设置为`display: none;`

希望这可以帮助。

```
 <script>

                $(document).ready(function() { 

                    if (document.cookie.indexOf('visited=true') === -1) {
                       var expires = new Date();
                        expires.setDate(expires.getDate()+30);
                        document.cookie = "visited=true; expires="+expires.toUTCString();
                        $.colorbox({inline:true, width:"40%", height:"450px", href:"#inline_content"});

                    }

                    });

            </script> 
```

# .net - 通过 COM 可见 DLL 从 VB6 调用 .NET 方法

> ID：233284
> 
> 赞同：2
> 
> 时间：2008-10-24T12:23:44.843
> 
> 标签：.net, arrays, com, vb6, assemblies

我创建了一个 .NET DLL，它使一些方法 COM 可见。

一种方法是有问题的。它看起来像这样：

```
bool Foo(byte[] a, ref byte[] b, string c, ref string d) 
```

当我尝试调用该方法时，VB6 给出了一个编译错误：

> 标记为受限的函数或接口，或函数使用 Visual Basic 不支持的自动化类型。

我读到数组参数必须通过引用传递，所以我更改了签名中的第一个参数：

```
bool Foo(ref byte[] a, ref byte[] b, string c, ref string d) 
```

VB6 仍然给出相同的编译错误。

如何更改签名以与 VB6 兼容？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-24T13:15:12.570

需要用“ref”声明数组参数。您的第二次尝试应该工作得很好，也许您忘记重新生成 .tlb？

测试代码：

```
[ComVisible(true)]
public interface IMyInterface {
 bool Foo(ref byte[] a, ref byte[] b,string c, ref string d);
}

[ComVisible(true)]
public class MyClass : IMyInterface {
  public bool Foo(ref byte[] a, ref byte[] b, string c, ref string d) {
    throw new NotImplementedException();
  }
}

  Dim obj As ClassLibrary10.IMyInterface
  Set obj = New ClassLibrary10.MyClass
  Dim binp() As Byte
  Dim bout() As Byte
  Dim sinp As String
  Dim sout As String
  Dim retval As Boolean
  retval = obj.Foo(binp, bout, sinp, sout) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T13:05:34.353

尝试

```
[ComVisible(true)]
bool Foo([In] ref byte[] a, [In] ref byte[] b, string c, ref string d) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-05T09:23:18.237

与此相关的事情是我的问题。我在 C# 中有一个具有以下签名的方法：

```
public long ProcessWiWalletTransaction(ref IWiWalletTransaction wiWalletTransaction) 
```

VB 6 不断抱怨“功能或接口标记为受限......”，我认为这是我在调用中使用的自定义对象。原来 VB 6 做不到，不得不将签名更改为：

```
public int ProcessWiWalletTransaction(ref IWiWalletTransaction wiWalletTransaction) 
```

# c# - 派生类的通用约束

> ID：233288
> 
> 赞同：8
> 
> 时间：2008-10-24T12:24:32.157
> 
> 标签：c#, generics, subsonic, constraints

**我有A类：**

```
public class ClassA<T> 
```

**B 类派生自 A：**

```
public class ClassB : ClassA<ClassB> 
```

**C类派生自B类：**

```
public class ClassC : ClassB 
```

**现在我有一个带有约束的通用方法**

```
public static T Method<T>() where T : ClassA<T> 
```

好的，现在我想打电话：

```
ClassC c = Method<ClassC>(); 
```

但我得到编译错误说： `Type argument 'ClassC' does not inherit from or implement the constraint type 'ClassA<ClassC>.`

然而，编译器将允许：

```
ClassB b = Method<ClassB>(); 
```

我的理解是，这失败了，因为`ClassC`继承`ClassA<ClassB>`而不是`ClassA<ClassC>`

**我真正的问题是，是否可以创建一个派生自该类的类，该类`ClassB`可以以某种方式与泛型方法一起使用？**

这似乎泛型被过度使用，我同意。我正在尝试创建从单独项目中的亚音速数据对象派生的业务层对象。

注意：我在 < T > 中添加了额外的空格，否则它们会从问题中删除。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-24T12:29:59.947

好吧，您可以将 Method 更改为：

```
public static T Method<T,U>() where T : ClassA<U> where U : T 
```

这些帮助有用？当然，如果您不能更改方法，那也没多大用处...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-24T12:39:43.377

不可以。您必须更改或包装此方法。

这就是原因。

ClassC 继承自 ClassB 继承自 ClassA(ClassB)

ClassC 不继承自 ClassA(ClassC)

ClassB 的子级不会继承 ClassA（子类），因为它们是从 ClassB 继承的，而 ClassB 不会继承自 ClassA（子类）。

[泛型类型是不变的](http://msdn.microsoft.com/en-us/library/aa479859.aspx#fundamentals_topic12)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-24T12:59:07.393

在大多数情况下，可以通过使用基本的非泛型抽象类来解决这种情况：

```
public abstract class BasicClassA
{
}

public class ClassA<T> : BasicClassA
{
}

public class ClassB : ClassA<ClassB>
{
}

public class ClassC : ClassB
{
}

public static T Method<T>() where T : BasicClassA
{
    return null;
} 
```

不过，您的里程可能会有所不同。

# python - 无法使用 Python 2.6 导入 SQLite

> ID：233320
> 
> 赞同：10
> 
> 时间：2008-10-24T12:33:24.887
> 
> 标签：python, sqlite

我在 Unix 上运行 Python 2.6，当我运行交互式提示时（应该预安装[SQLite ），我得到：](http://en.wikipedia.org/wiki/SQLite)

```
[root@idev htdocs]# python
Python 2.6 (r26:66714, Oct 23 2008, 16:25:34)
[GCC 3.2.2 20030222 (Red Hat Linux 3.2.2-5)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import sqlite
Traceback (most recent call last):
File "<stdin>", line 1, in <module>
ImportError: No module named sqlite
>>> 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-24T14:52:21.173

错误：

```
ImportError: No module named _sqlite3 
```

表示[SQLite](http://en.wikipedia.org/wiki/SQLite) 3 没有找到关联的共享库。在 Mac OS X 上它是 _sqlite3.so，它在其他 Unix 系统上应该是一样的。

要解决该错误，您必须在您的计算机上找到 _sqlite3.so 库，然后检查您的 PYTHONPATH 以获取此目录位置。

要打印 Python 搜索路径，请在 Python shell 中输入以下内容：

```
import sys
print sys.path 
```

如果缺少包含您的库的目录，您可以尝试以交互方式添加它

```
sys.path.append('/your/dir/here') 
```

并尝试

```
import sqlite3 
```

再次。如果这可行，您必须将此目录永久添加到您的 PYTHONPATH 环境变量中。

PS：如果缺少库，您应该（重新）安装模块。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-24T12:36:50.790

```
import sqlite3 
```

[sqlite3](http://docs.python.org/library/sqlite3.html#module-sqlite3) - SQLite 数据库的 DB-API 2.0 接口。

您缺少`.so`（共享对象） - 可能是安装步骤。在我的 Linux python 安装中，`_sqlite3`位于：

```
${somewhere}/lib/python2.6/lib-dynload/_sqlite3.so 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-06-02T11:35:17.983

Python 2.6 会检测 sqlite3 开发头文件的安装位置，如果 _sqlite3 不可用，它将静默跳过构建。如果您是从源代码构建，请安装 sqlite3，包括开发头文件。就我而言，`sudo yum install sqlite-devel`在 CentOS 4.7 上解决了这个问题。然后，从源代码重建 Python。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-24T14:55:09.110

试试这个：

```
from pysqlite2 import dbapi2 as sqlite 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-24T15:12:53.160

在我的系统`_sqlite3.so`上：

```
'/usr/lib/python2.6/lib-dynload/_sqlite3.so' 
```

检查目录是否在您的`sys.path`：

```
>>> import sys; print(filter(lambda p: 'lib-dynload' in p, sys.path))
['/usr/lib/python2.6/lib-dynload'] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-05T00:44:48.680

这能解决你的问题吗？

```
Python 2.5.4 (r254:67916, May 31 2009, 16:56:01)
[GCC 4.3.3] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import sqlite
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ImportError: No module named sqlite
>>> import sqlite3
>>> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-04-22T15:49:53.317

2.5.5。Python 2.5 的 Mac 端口现在有这个提示：

```
"py25-sqlite3 @2.5.4 (python, databases)
    This is a stub. sqlite3 is now built with python25" 
```

因此升级了 python25 端口以`python25 @2.5.5_0`使导入再次工作。由于 sqlite3 是 python25 的依赖项之一，因此在升级 python25 时会重新构建它。因此，

```
$ sudo port upgrade python25 
```

在 Mac OS X 上做的伎俩，端口集合。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-07T11:09:00.513

我面临同样的问题。步骤来解决。

1.  从 sqlite 网站下载最新的 sqlite3。sqlite-autoconf*
2.  只需 3 个简单的步骤即可安装
    1.  。/配置
    2.  制作
    3.  进行安装
3.  重建python make make install

# c++ - 如何在 gdb 中打印长字符串的完整值？

> ID：233328
> 
> 赞同：424
> 
> 时间：2008-10-24T12:36:01.353
> 
> 标签：c++, c, string, debugging, gdb

我想在 GDB 中打印 C 字符串的全长。默认情况下它是缩写的，我如何强制 GDB 打印整个字符串？

* * *

## 回答 #1

> 赞同：565
> 
> 时间：2008-10-24T12:37:42.037

```
set print elements 0 
```

[从 GDB 手册](http://ftp.gnu.org/old-gnu/Manuals/gdb-5.1.1/html_node/gdb_57.html#IDX353)：

> `set print elements` *`number-of-elements`*

> 设置一个数组 GDB 将打印多少元素的限制。如果 GDB 正在打印一个大数组，它会在打印完`set print elements`命令设置的元素数量后停止打印。此限制也适用于字符串的显示。当 GDB 启动时，此限制设置为 200。**将*元素数量*设置为零意味着打印是无限的**。

* * *

## 回答 #2

> 赞同：112
> 
> 时间：2008-10-31T10:42:56.483

只要您的程序处于正常状态，您也可以`call (void)puts(your_string)`将其打印到标准输出。实际上，同样的原则适用于调试器可用的所有功能。

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2015-12-03T20:47:14.080

该`printf`命令将打印完整的字符串：

```
(gdb) printf "%s\n", string 
```

* * *

## 回答 #4

> 赞同：42
> 
> 时间：2011-10-06T16:15:39.330

还有第三个选项：x 命令，它允许您为特定命令设置不同的限制，而不是更改全局设置。要打印字符串的前 300 个字符，您可以使用`x/300s your_string`. 输出可能有点难以阅读。例如打印 SQL 查询会导致：

```
(gdb) x/300sb stmt.c_str()
0x9cd948：“选择文章.r”...
0x9cd958：“来自文章的 owid”...
..

```

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2012-01-18T11:05:52.507

只是为了完成它：

```
(gdb) p (char[10]) *($ebx)
$87 =   "asdfasdfe\n" 
```

您必须给出一个长度，但可能会更改该字符串的表示：

```
(gdb) p/x (char[10]) *($ebx)
$90 =   {0x61,
  0x73,
  0x64,
  0x66,
  0x61,
  0x73,
  0x64,
  0x66,
  0x65,
  0xa} 
```

如果您想通过它们的值进行调试，这可能很有用

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-06-23T07:08:33.443

使用`set elements ...`并不总是最好的方法。如果有一个不同的`set string-elements ...`.

所以，我在我的 .gdbinit 中使用了这些函数：

```
define pstr
  ptype $arg0._M_dataplus._M_p
  printf "[%d] = %s\n", $arg0._M_string_length, $arg0._M_dataplus._M_p
end

define pcstr
  ptype $arg0
  printf "[%d] = %s\n", strlen($arg0), $arg0
end 
```

注意事项：

*   第一个依赖于 c++ lib，因为它访问 std::string 的成员，但很容易调整。
*   第二个只能用于正在运行的程序，因为它调用 strlen。

# e-commerce - 开发其他人可以使用的购物网站的最佳方式是什么

> ID：233351
> 
> 赞同：4
> 
> 时间：2008-10-24T12:41:43.153
> 
> 标签：e-commerce, shopping-cart

我想开发一个电子商务网站，在那里我可以允许其他人销售商品，比如图片、视频、Flash 等。我希望能够保留一定比例，并将其余部分返还给卖家。

有什么可用的，DotNetNuke 等可以做到这一点或帮助开始。如果不是，那么以避免前期时间和成本为目标的解决此问题的好方法是什么。

我想随着时间的推移会有一些收入可以再投资，所以可能会在一段时间后成长为有一定成本的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-07T15:47:15.927

你应该看看[osCommerce](http://www.oscommerce.com/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-30T17:32:11.027

如果您想要一些开发时间最短的东西，我会看看[Shopify](http://www.shopify.com/)，否则，如果您有一些开发预算，为什么不看看[Spree](http://spreehq.org/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T14:26:37.933

如果您需要包含购物以外的其他内容，则可以使用 DotNetNuke 或其他类似框架。

如果您使用 DotNetNuke，您可以查看 Catalook 商店，我相信它支持您想要的销售格式。它并不完美，但它确实有效，最终有一点经验。否则，ASP .NET Storefront 可能也有您需要的东西，无论是基于 DNN 的版本还是它们的独立版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-18T05:18:14.553

如果您需要包含除[购物](http://thefashionmart.in)之外的其他内容，则可以使用 WordPress 或其他类似框架。

如果您使用 WordPress，您可以查看 Catalook 商店，我相信它支持您想要的销售格式。它并不完美，但它确实有效，最终有一点经验

# linux - ELF 文件头

> ID：233358
> 
> 赞同：11
> 
> 时间：2008-10-24T12:44:22.540
> 
> 标签：linux, unix, embedded

关于 elf 文件头的一个快速问题，我似乎找不到任何关于如何在 elf 头中添加/更改字段的有用信息。我希望能够更改幻数并在标题中添加构建日期，可能还有其他一些东西。

据我了解，链接器会创建标头信息，但我在 LD 脚本中看不到任何引用它的内容（尽管我是 ld 脚本的新手）。

我正在使用 gcc 并为 ARM 构建。

谢谢！

更新：

*   好的，也许我的第一个问题应该是：是否可以在链接时创建/编辑头文件？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-24T16:14:28.700

我不知道可以执行此操作的链接器脚本命令，但您可以使用**objcopy**命令在链接后执行此操作。**--add-section**选项可用于将包含任意数据的部分添加到 ELF 文件。如果 ELF 标头不包含您想要的字段，只需创建一个新部分并将它们添加到那里。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-26T10:49:12.323

[此链接（teensy elf binary）](http://www.muppetlabs.com/~breadbox/software/tiny/teensy.html)是某人对另一个问题的回答，但它详细介绍了 ELF 标头的复杂性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-24T16:50:07.880

我相当确定一个足够复杂的 ld 脚本可以做你想做的事。但是，我不知道如何。

另一方面，[elfsh](http://elfsh.asgardlabs.org/)可以轻松地对 elf 对象进行各种操作，所以试一试。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-11-02T21:24:13.060

您可以创建一个包含信息字段（如版本号）的目标文件，并链接该文件，以便它们包含在生成的 ELF 二进制文件中。

## 标识

例如，作为构建过程的一部分，您可以生成 - 比如说 -`info.c`包含一个或多个`#ident`指令：

```
#ident "Build: 1.2.3 (Halloween)"
#ident "Environment: example.org" 
```

编译它：

```
$ gcc -c info.c 
```

检查是否包含信息：

```
$ readelf -p .comment info.o
String dump of section '.comment':
  [     1]  Build: 1.2.3 (Halloween)
  [    1a]  Environment: example.org
  [    33]  GCC: (GNU) 7.2.1 20170915 (Red Hat 7.2.1-2) 
```

或者，您可以使用`objdump -s --section .comment info.o`. 请注意，默认情况下，GCC 也会编写自己的注释。

链接 ELF 可执行文件后检查信息：

```
$ gcc -o main main.o info.o
$ readelf -p .comment main 
String dump of section '.comment':
  [     0]  GCC: (GNU) 7.2.1 20170915 (Red Hat 7.2.1-2)
  [    2c]  Build: 1.2.3 (Halloween)
  [    45]  Environment: example.org 
```

### 评论区

在 C 翻译单元中使用`#ident`基本上等同于`.comment`在汇编文件中创建一个节。例子：

```
$ cat info.s
.section .comment
.string "Build: 1.2.3 (Halloween)"
.string "Environment: example.org"
$ gcc -c info.s
$ readelf -p .comment info.o
String dump of section '.comment':
  [     0]  Build: 1.2.3 (Halloween)
  [    19]  Environment: example.org 
```

使用不常见的部分名称也可以（例如`.section .blahblah`）。但是`.comment`被其他工具使用和理解。GNU as 也理解该`.ident`指令，这就是 GCC 所翻译`#ident`的内容。

## 带符号

对于您还想从 ELF 可执行文件本身访问的数据，您需要创建符号。

### 对象复制

假设您想包含一些存储在数据文件中的魔术字节：

```
$ cat magic.bin 
2342 
```

[使用GNU objcopy](https://sourceware.org/binutils/docs/binutils/objcopy.html)转换为目标文件：

```
$ objcopy -I binary -O elf64-x86-64 -B i386 \
    --rename-section .data=.rodata,alloc,load,readonly,data,contents \
    magic.bin magic.o 
```

检查符号：

```
$ nm  magic.o  
0000000000000005 R _binary_magic_bin_end
0000000000000005 A _binary_magic_bin_size
0000000000000000 R _binary_magic_bin_start 
```

示例用法：

```
#include <stdio.h>
#include <string.h>
#include <inttypes.h>

extern const char _binary_magic_bin_start[];
extern const char _binary_magic_bin_end[];
extern const unsigned char _binary_magic_bin_size;
static const size_t magic_bin_size = (uintptr_t) &_binary_magic_bin_size;

int main()
{
  char s[23];
  memcpy(s, _binary_magic_bin_start,
      _binary_magic_bin_end - _binary_magic_bin_start);
  s[magic_bin_size] = 0;
  puts(s);
  return 0;
} 
```

将所有内容链接在一起：

```
$ gcc -g -o main_magic main_magic.c magic.o 
```

## GNU ld

[GNU ld](https://sourceware.org/binutils/docs/ld/index.html)还能够使用兼容 objcopy 的命名方案将数据文件转换为目标文件：

```
$ ld -r -b binary magic.bin -o magic-ld.o 
```

与 objcopy 不同的是，它将符号放入`.data`而不是`.rodata`部分，但（参见`objdump -h magic.o`）。

### 公司

如果 GNU objcopy 不可用，可以使用[GNU as](https://sourceware.org/binutils/docs/as/index.html) [`.incbin`指令](https://sourceware.org/binutils/docs/as/Incbin.html#Incbin)来创建目标文件（用 汇编`gcc -c incbin.s`）：

```
 .section .rodata

    .global _binary_magic_bin_start
    .type _binary_magic_bin_start, @object
_binary_magic_bin_start:
    .incbin "magic.bin"
    .size _binary_magic_bin_start, . - _binary_magic_bin_start

    .global _binary_magic_bin_size
    .type _binary_magic_bin_size, @object
    .set _binary_magic_bin_size, . - _binary_magic_bin_start

    .global _binary_magic_bin_end
    .type _binary_magic_bin_end, @object
    .set _binary_magic_bin_end, _binary_magic_bin_start + _binary_magic_bin_size
    ; an alternate  way to include the size    
    .global _binary_magic_bin_len
    .type _binary_magic_bin_len, @object
    .size _binary_magic_bin_len, 8
_binary_magic_bin_len:
    .quad _binary_magic_bin_size 
```

### xxd

一种更便携的替代方案，它不需要 GNU objcopy 或 GNU，因为它可以创建一个中间 C 文件并编译和链接它。例如[xxd](https://manpages.debian.org/stretch/xxd/xxd.1.en.html)：

```
$ xxd -i magic.bin | sed 's/\(unsigned\)/const \1/' > magic.c
$ gcc -c magic.c
$ nm magic.o
0000000000000000 R magic_bin
0000000000000008 R magic_bin_len
$ cat magic.c
const unsigned char magic_bin[] = {
  0x32, 0x33, 0x34, 0x32, 0x0a
};
const unsigned int magic_bin_len = 5; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-24T12:55:13.720

你也许可以使用 libmelf，一个关于 Freshmeat 的死项目，但可以从 LOPI 获得 - [http://www.ipd.bth.se/ska/lopi.html](http://www.ipd.bth.se/ska/lopi.html)

否则，您可以自己获取规范并（覆盖）编写标题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-24T13:00:12.587

我已经有一段时间没有这样做了，但是您不能将任意数据附加到可执行文件中。如果您总是附加固定大小的数据，那么恢复您附加的任何内容都是微不足道的。可变大小不会更难。可能比弄乱 w/elf 标头并可能破坏您的可执行文件更容易。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-24T16:53:52.957

在 Solaris 中，您可以使用[elfedit](http://blogs.oracle.com/ali/entry/changing_elf_runpaths)，但我认为您确实在为 Linux 寻求解决方案。Linux 不是 Unix :P

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-25T00:08:12.440

我没有读完这本书，但[John Levine](https://rads.stackoverflow.com/amzn/click/com/1558604960)的 iirc Linkers and Loaders 有血淋淋的细节，你需要能够做到这一点。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-10-28T12:30:53.960

在 Linux 控制台中：

$人ld

$ ld --详细

高温高压

# testing - 测试人员应该对代码的内部细节了解多少？

> ID：233360
> 
> 赞同：2
> 
> 时间：2008-10-24T12:45:21.493
> 
> 标签：testing

对于产品团队的测试人员来说，了解产品的内部代码细节有多大用处（如果有的话）。这并不意味着他们需要了解每一行代码，而是要了解代码的结构、对象模型是什么、各种模块如何相互关联、各种功能之间的相互依赖关系等？这可以说可以帮助他们在遇到相关问题或缺陷时找到相关问题或缺陷。另一方面，这可能会“偏向”他们“以用户为中心”的方法来评估和认证产品，并最终影响测试结果。

我还没有听说过这种互动的任何具体模型。（让我们假设用户使用的产品可能是非技术性的，而不是测试人员正在测试的框架或 API - 在后一种情况下，测试人员可能需要了解代码来测试，因为用户是另一个程序员）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-24T12:49:11.953

这完全取决于正在进行的测试类型。

对于功能系统测试，测试人员可以并且可能应该忽略实现的细节——如果他们知道细节，他们可能会无意中在他们的测试策略中考虑到这一点，并且没有正确地测试产品。

对于性能和可扩展性测试，测试人员对代码库的结构有一些高级知识通常很有帮助，因为它有助于识别潜在的性能热点，从而编写有针对性的测试用例。这很重要的原因是，通常性能测试是一个广泛的开放式过程，因此可以做任何事情来集中测试以获得结果对每个人都有好处。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-24T12:59:17.267

您在这里看到的是黑盒（不了解内部知识）、白盒（所有知识）和灰盒（一些选择知识）之间的区别。

答案实际上取决于代码的目的。对于集成繁重的项目，它们在何处以及如何进行通信，即使它完全在幕后，也允许测试人员生成适当的非功能测试用例。

这些测试用例正在确定组件是否会优雅地处理依赖项的可用性不足。它还可用于识别与性能相关的问题。

**例如：**作为测试人员，如果我知道 Web UI 组件将请求推迟到执行实际工作的编排服务，那么我可以构建一个编排需要很长时间（高负载）的场景。如果用户随后执行另一个请求（模拟用户不耐烦）并且 Web 服务将在第一个请求仍在进行时收到第二个请求。如果我们不断重复这一点，Web 服务最终会因压力而死。在不了解底层模型的情况下，很难找到问题

在大多数情况下，对于功能测试，黑盒是首选，一旦您转向非功能或系统集成，那么了解交互可以帮助确保适当的测试覆盖率。

并非所有测试人员都熟练或舒适地工作/理解组件交互或内部结构，因此它是否适用于每个测试人员/每个系统。

在几乎所有情况下，我们都从黑匣子开始，然后根据需要走向白色。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-24T13:25:19.710

这听起来与之前的问题很相似：[QA 是否应该从严格的黑盒角度进行测试？](https://stackoverflow.com/questions/164170/should-qa-test-from-a-strictly-black-box-perspective)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-24T13:52:12.730

我从未见过对系统内部非常了解的测试人员处于不利地位的情况。

我会断言，有一些自我证明的神话，即知情的测试人员与技术含量高的测试人员一样足够甚至更好，因为：

1.  它允许项目经理使用“随机或低质量资源”进行测试。“像用户神话一样不知情”。如果你想要这种类型的测试 - 让一些“真正的”用户来测试你的东西。
2.  测试人员仍然经常被视为比开发人员更便宜且价值更低。'任何人都可以进行黑盒测试的神话'。
3.  开发可以将适当的测试推迟到测试团队。两个神话合二为一“我们不需要培训测试人员”和“只有测试团队进行测试”的神话。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-24T12:48:43.857

测试人员不需要知道内部细节。

应在不了解内部结构、开发问题、外部依赖关系的情况下测试应用程序。

如果你用这些额外的信息来妨碍测试人员，你就会把他推到某个测试方案中，并且永远不应该把测试人员推向一个他应该只从非编码人员的角度进行测试的方向。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-24T12:50:11.857

有多种测试方法需要代码审查，也有一些不需要。

白盒测试（即阅读代码）的优点是您可以将测试调整为仅测试您知道（通过阅读代码）会失败的区域。

缺点包括从实际测试中浪费时间来理解代码。

黑盒测试（即不阅读代码）在发现错误方面与白盒测试一样好（或更好？）。

通常两种类型的测试都可以在一个项目上进行，开发人员进行白盒单元测试，测试人员进行黑盒集成测试。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-24T12:50:38.643

我更喜欢最终测试制度的黑盒测试在理想的世界中......

*   测试人员应该对代码的内部一无所知
*   他们应该知道客户会知道的一切——即拥有使用系统/应用程序所需的文档/帮助。（如果它是某种可交付的代码，这肯定包括 API 描述/文档）

如果测试人员无法找到具有这些限制的缺陷，则说明您的 API/应用程序没有足够的文档记录。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-24T12:52:01.743

如果他们是专门的测试人员（他们唯一做的事情），那么我认为他们应该尽可能少地了解他们试图测试的代码。

他们经常试图确定失败的原因，这是开发人员而不是测试人员的责任。

也就是说，我认为开发人员是优秀的测试人员，因为我们倾向于了解某些类型功能的边缘情况。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-24T13:18:36.777

这是一个错误示例，如果您不了解代码内部结构，则无法找到该错误，因为您根本无法测试所有输入：

```
long long int increment(long long int l) {
    if (l == 475636294934LL) return 3;
    return l + 1;
} 
```

但是，在这种情况下，如果测试人员将 100% 的代码覆盖率作为目标，并且只查看足够的内部结构来编写测试来实现这一目标，就会发现。

*这是一个错误示例，如果您确实*了解代码内部结构，您很可能不会发现该错误，因为错误的信心具有传染性。特别是，代码的作者通常不可能编写捕获此错误的测试：

```
int MyConnect(socket *sock) {
    /* socket must have been bound already, but that's OK */
    return RealConnect(sock);
} 
```

如果 MyConnect 的文档没有提到必须绑定套接字，那么总有一天会发生意想不到的事情（有人会称之为未绑定，并且可能套接字实现会选择任意本地地址）。但是能看到代码的测试人员往往没有“测试”文档的心态。除非他们真的在形式上，否则他们不会注意到文档中没有提到的代码中有一个假设，并且只会接受这个假设。相反，从文档中编写的测试人员可以轻松发现错误，因为他们会认为“套接字可以处于哪些可能的状态？我将为每个状态进行测试”。由于没有提到任何限制，他们没有理由不尝试失败的案例。

答：两者都做。一种方法是**在您查看/编写代码之前编写一个测试套件**，然后添加更多测试以涵盖您在实现中引入的任何特殊情况。这适用于测试人员与程序员是否是同一个人，尽管显然如果程序员编写第二种测试，那么组织中只有一个人必须理解代码。让只有一个人能理解的代码是否是一个好的长期策略是有争议的，但它很普遍，因为它确实可以节省时间。

[编辑：我拒绝透露这些错误是如何产生的。也许第一个的程序员在临床上是疯了，而对于第二个，对使用的端口有一些限制，以解决一些已知发生的奇怪网络设置，并且套接字应该是通过一些 de-通用套接字文档中提到了其存在的怪异 API，但他们忽略了要求使用它。显然，在这两种情况下，程序员都非常粗心。但这并不影响重点：这些例子不需要是现实的，因为如果你没有捕捉到只有非常粗心的程序员才会犯的错误，那么你就不会捕捉到代码中的所有实际错误，除非你永远不会有糟糕的一天，犯一个疯狂的错字，等等。]

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-26T05:12:33.953

我想这取决于你想要的测试有多好。如果您只是想检查常见场景，那么无论如何，只要给测试人员/吃披萨的人提供应用程序并告诉他们发疯。

但是，如果您想有机会发现边缘情况、性能或负载问题，或者隐藏在代码深处的大量其他问题，您最好聘请知道如何和何时使用白盒技术。

你的来电。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-26T05:43:45.747

恕我直言，我认为测试人员的行业观点是完全错误的。

想想看……你有两个水管工，一个非常有经验，知道所有的规则和建筑规范，并且可以快速查看某些东西并知道工作是否正确。另一个水管工很好，可以可靠地完成工作。

您希望哪一个进行最终检查以确保您不会回到被淹的房子？事实上，在其他哪些行业，他们允许对他们正在检查的系统几乎一无所知的人进行实际检查？

这些年来，我看到 QA 的标准不断提高，这让我很高兴。随着时间的推移，QA 可能会成为开发人员渴望成为的东西。

简而言之，他们不仅应该熟悉被测试的代码，还应该了解与产品架构师相媲美的理解，并且能够有效地与产品所有者/客户进行交互，以确保什么正在创建的实际上是他们想要的。但现在我要进入一个完全独立的对话......

Will it happen? Probably sooner than you think. I have been able to reduce the number of people needed to do QA, increase the overall effectiveness of the team, and increase the quality of the product simply by hiring very skilled people with dev / architect backgrounds with a strong aptitude for QA. I have lower operating costs, and since the software going out is higher quality, I end up with lower support costs. FWIW ... I have found that while I can backfill the QA guys effectively into a dev role when needed, the opposite is almost always not true.

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-29T08:18:47.837

If there is time, a tester should definitely go through a developers code. This way, you can improve your tests to get better coverage.

So, maybe if you write your black box tests looking at the spec and think you have the time to execute all of those and will still be left with time, going through code cannot be a bad idea.

Basically it all depends on how much time you have.. Another thing you can do to improve coverage is look at the developers design documents. Those should give you a good idea of what the code is going to look like...

Testers have the advantage of being familiar with both the dev code and the test code!

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-24T12:51:45.973

我想说他们根本不需要知道内部代码的详细信息。然而，他们确实需要详细了解所需的功能和系统规则——就像分析师一样。否则他们不会测试所有的功能，或者不会意识到系统何时出现异常。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-24T12:54:23.377

对于用户验收测试，测试人员不需要知道应用程序的内部代码细节。他们只需要知道预期的功能、业务规则。报告错误时

修复错误的人应该知道各种功能之间的相互依赖关系。

# svn - 如何从 svn 存储库获取每日提交计数和修改路径的数量？

> ID：233369
> 
> 赞同：0
> 
> 时间：2008-10-24T12:48:04.217
> 
> 标签：svn, commit

那么实现这一目标的最简单方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T13:10:20.850

我们使用[StatSVN](http://www.statsvn.org/)并设置计划任务来创建夜间报告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T12:50:25.490

阻力最小的路径是下载[Tortoise](http://tortoisesvn.tigris.org/)，它支持这个开箱即用。

从他们的功能页面：

> 可以创建所有修订/提交的图表。然后，您可以轻松查看创建标签/分支或修改文件/文件夹的位置 项目提交统计图表 轻松比较两个分支或标签

# .net - 阻止 Winforms 窗口四处移动的最巧妙方法是什么

> ID：233379
> 
> 赞同：3
> 
> 时间：2008-10-24T12:50:25.663
> 
> 标签：.net, winforms, desktop-application

我们有一个 WinForms 应用程序，它在一些工业设备的触摸屏上运行。由于今天无法更改的历史原因，显示的表单具有正常的 Windows 标题栏。

我们想阻止人们使用鼠标（即触摸屏）通过拖动标题栏来移动窗口。我们不在乎是否有其他方法可以使用键盘移动窗口。

实现这一目标的最优雅方法是什么？如果标题栏上有鼠标按下，我可以考虑尝试颠覆鼠标消息（尽管乍一看，NC 命中测试在 Winforms 中似乎并不完全明显），我可以考虑以某种方式响应 Move 消息恢复窗口位置。

但是这两个看起来都很笨重，我觉得我错过了一些优雅而明显的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T13:02:02.910

Nc 消息仍然是我认为的最佳选择。Syncfusion 的 windows form faq 有你需要的代码。我会粘贴一个链接，但我在没有复制粘贴的 iPhone 上（抱怨，抱怨！）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-24T13:24:50.710

好的，多亏了 DanF 的一些鼓励，我想出了这个：

```
 protected override void  WndProc(ref Message msg)
  {
      const int WM_NCLBUTTONDOWN = 0xa1;

      switch (msg.Msg)
      {
         case WM_NCLBUTTONDOWN:
            // To prevent people moving the window with the mouse 
            // unless CTRL is held
            if (!(GetKeyState((int)Keys.ControlKey) < 0))
            {
               return;
            }
            break;
      }
      base.WndProc(ref msg);
  } 
```

这似乎只是事情。谢谢大家。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T12:53:41.943

修改主窗体事件的LocationChanged、SizeChanged等怎么样...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T12:56:46.070

如果这对您的应用程序实用，您可以强制窗口保持最大化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-01-04T22:01:56.720

要处理@rotard 对您的解决方案的评论，您可以通过以下方式阻止鼠标移动：在您的*覆盖*`WndProc`中， for `WM_NCHITTEST`，调用`base.WndProc` *first*。如果它返回`HTCAPTION`，`HTNONE`则改为返回。

# c# - 在 C# 中覆盖面板的 Controls 属性

> ID：233382
> 
> 赞同：3
> 
> 时间：2008-10-24T12:50:58.563
> 
> 标签：c#, windows, .net-2.0

我必须覆盖从窗口的面板控件扩展的 myControl 的“控件”属性的 Add 方法。为此，我将 ControlCollection 类扩展为 MyControlCollection，并在其中覆盖了它的 Add 方法。现在我声明了一个 MyControlCollection 类型的 Controls 属性来隐藏面板的 Controls 属性。当我访问 this.Controls.Add(control) 时，它指的是重写的 Add 方法。但是，如果我在 myControl 上拖放一个控件，则行为属于基本类型的 Add 方法。任何机构都可以提出这个问题的原因和补救措施吗？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T12:56:55.230

您可以改为覆盖 CreateControlCollection 函数，并返回您选择的类的实例，该实例继承 System.Web.UI.ControlCollection。从您的类中删除 Controls 属性，您不需要覆盖或隐藏原始实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T12:53:42.270

原因是设计者正在调用 Control.Controls 而不是访问您的单独集合。老实说，您的解决方案听起来注定会造成麻烦 - 隐藏成员通常会这样做。

你到底想达到什么目的？看起来没有什么好的活动可以参与，`ControlCollection`但可能有一种不同的方式来解决这个问题。

编辑：我刚刚看到`Control`有一个[`ControlAdded`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.controladded.aspx)事件 - 订阅它对你来说就足够了吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T12:59:24.443

实际上，如果某些标志为真，我必须限制在我的控件中添加控件。我使用了那个 ControlAdded 事件，但它只增加了问题。ControlAdded 仅在位置 0、0 的父级中添加该控件后才会触发。在引发该事件后，它会根据鼠标在放置时的位置重新定位控件。如果我在 ControlAdded 的 EventHandler 异常中从父级删除该新控件。

# jsp - JSP XALAN 示例

> ID：233383
> 
> 赞同：0
> 
> 时间：2008-10-24T12:50:59.063
> 
> 标签：jsp, xalan

我正在尝试做的是以下内容。

将两个参数传递给 URL

*   类型
*   doc_id

一旦它们通过 URL 传递给 JSP，我想将类型模板应用于 doc_id xml。

因此，如果类型是 001，那么 001.xsl 将应用于 doc_id.xml。我不想将其输出存储在文件中，而是直接输出到浏览器。

我将如何使用 XALAN 和 JSP 页面执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-24T13:30:18.593

我建议将这种类型的代码放在 servlet 而不是 JSP 页面中。如果您有一些需要 JSP 的特定约束，那么可以修改代码以在 JSP 页面上工作。

XALAN 站点有一个使用 servlet 的好示例，为方便起见，我将在此处复制该示例：可以在[此处](http://xml.apache.org/xalan-j/usagepatterns.html)找到原始示例。在此示例中，他们对 xsl 和 xml 文件的名称进行了硬编码，但是很容易修改以使用您所描述的生成的文件名。重要的是生成的输出会流式传输到浏览器。

```
public class SampleXSLTServlet extends javax.servlet.http.HttpServlet {

    public final static String FS = System.getProperty("file.separator"); 
    // Respond to HTTP GET requests from browsers.

    public void doGet (javax.servlet.http.HttpServletRequest request,
                 javax.servlet.http.HttpServletResponse response)
                 throws javax.servlet.ServletException, java.io.IOException
   {
     // Set content type for HTML.
     response.setContentType("text/html; charset=UTF-8");    
     // Output goes to the response PrintWriter.
     java.io.PrintWriter out = response.getWriter();
     try
     {  
        javax.xml.transform.TransformerFactory tFactory = 
           javax.xml.transform.TransformerFactory.newInstance();
        //get the real path for xml and xsl files.
        String ctx = getServletContext().getRealPath("") + FS;        
        // Get the XML input document and the stylesheet, both in the servlet
       // engine document directory.
       javax.xml.transform.Source xmlSource = 
            new javax.xml.transform.stream.StreamSource
                         (new java.net.URL("file", "", ctx+"foo.xml").openStream());
       javax.xml.transform.Source xslSource = 
            new javax.xml.transform.stream.StreamSource
                         (new java.net.URL("file", "", ctx+"foo.xsl").openStream());
       // Generate the transformer.
       javax.xml.transform.Transformer transformer = 
                         tFactory.newTransformer(xslSource);
       // Perform the transformation, sending the output to the response.
      transformer.transform(xmlSource, 
                       new javax.xml.transform.stream.StreamResult(out));
     }
     // If an Exception occurs, return the error to the client.
    catch (Exception e)
    {
       out.write(e.getMessage());
       e.printStackTrace(out);    
    }
    // Close the PrintWriter.
    out.close();
   }  
} 
```

# c# - How do I enable a second monitor in C#?

> ID：233411
> 
> 赞同：21
> 
> 时间：2008-10-24T12:55:47.603
> 
> 标签：c#, winforms, desktop, multiple-monitors

Is it possible to enable a second monitor programatically and extend the Windows Desktop onto it in C#? It needs to do the equivalent of turning on the checkbox in the image below.

![alt text](https://i.stack.imgur.com/ss2sE.png)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-24T14:44:41.330

[MSDN Device Context Functions](http://msdn.microsoft.com/en-us/library/ms533259.aspx)

What you basically need to do:

> Use the EnumDisplayDevices() API call to enumerate the display devices on the system and look for those that don't have the `DISPLAY_DEVICE_ATTACHED_TO_DESKTOP` flag set (this will include any mirroring devices so not all will be physical displays.) Once you've found the display device you'll need to get a valid display mode to change it to, you can find this by calling the EnumDisplaySettingsEx() API call - Generally you'd display all the available modes and allow the user to choose however in your case it sounds like this may be possible to hard-code and save you an additional step. For the sake of future-proofing your application though I'd suggest having this easily changeable without having to dig through the source every time, a registry key would be the obvious choice. Once you've got that sorted out populate a DevMode display structure with the information about the display positioning (set the PelsWidth/Height, Position, DisplayFrequency and BitsPerPel properties) then set these flags in the fields member. Finally call ChangeDisplaySettingsEx() with this settings structure and be sure to send the reset and update registry flags. That should be all you need, hope this helps,

[DISPLAY_DEVICE](http://www.pinvoke.net/default.aspx/Structures/DISPLAY_DEVICE.html) structure import using PInvoke

[EnumDisplayDevices](http://www.pinvoke.net/default.aspx/user32/EnumDisplayDevices.html) function import

[EnumDisplaySettingsEx](http://www.pinvoke.net/default.aspx/user32/EnumDisplaySettingsEx.html) function import

etc. the rest of them functions can be found with a simple search by name.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-06-27T07:38:53.530

If you have windows 7, then just start a process:

```
 private static Process DisplayChanger = new Process
    {
        StartInfo =
        {
            CreateNoWindow = true,
            WindowStyle = ProcessWindowStyle.Hidden,
            FileName = "DisplaySwitch.exe",
            Arguments = "/extend"
        }
    }; 
```

then DisplayChanger.Start();

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-24T13:46:16.190

I don't have the full answer here but I am almost sure that you will have to call out of .Net to do this. You will have to use Pinvoke to call an unmanaged dll. A great resource for this is pinvoke.net.

I did a quick search and found [http://www.pinvoke.net/default.aspx/user32/ChangeDisplaySettings.html](http://www.pinvoke.net/default.aspx/user32/ChangeDisplaySettings.html) which probably isn't exactly what you want but you will probably find it somewhere on pinvoke.net

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-03T14:51:45.303

I am looking for the same solution. I have written the following code to call `ChangeDisplaySettingsEx` with PInvoke:

```
DEVMODE dm = new DEVMODE();
dm.dmSize = (short)Marshal.SizeOf(dm);
dm.dmPelsWidth = 1680;
dm.dmPelsHeight = 1050;
dm.dmBitsPerPel = 32;
dm.dmDisplayFrequency = 60;
dm.dmFields = DevModeFields.DM_BITSPERPEL | DevModeFields.DM_PELSWIDTH | 
              DevModeFields.DM_PELSHEIGHT | DevModeFields.DM_DISPLAYFREQUENCY;
int res = ChangeDisplaySettingsEx(@"\\.\DISPLAY2", ref dm, IntPtr.Zero, CDS_RESET | CDS_UPDATEREGISTRY, IntPtr.Zero);
Console.WriteLine("result = " + res.ToString()); 
```

If the monitor is already enabled, this changes the resolution successfully. But if the monitor isn't attached to the desktop already, this won't activate it. So does anyone have a code example that works?

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-02-10T20:01:53.120

To enable a monitor, set its position to something other than 0,0, like as shown:

```
POINTL enabledPosition = new POINTL();
enabledPosition.x = -1280;
enabledPosition.y = 0;

dm.dmPosition = enabledPosition;
dm.dmFields = DM.Position;
res = ChangeDisplaySettingsEx(d.DeviceName, ref dm, IntPtr.Zero, (uint) DeviceFlags.CDS_UPDATEREGISTRY, IntPtr.Zero); 
```

# windows - 在 Windows 中托管 Git 存储库

> ID：233421
> 
> 赞同：110
> 
> 时间：2008-10-24T12:57:56.710
> 
> 标签：windows, git

目前有没有办法在 Windows 中托管一个共享的 Git 存储库？我了解您可以在 Linux 中配置 Git 服务：

```
git daemon 
```

是否有本地 Windows 选项（缺少共享文件夹）来托管 Git 服务？

编辑：我目前正在使用 git 的 cygwin 安装来存储和使用 Windows 中的 git 存储库，但我想采取下一步托管存储库的服务，该服务可以提供对其他人的访问。

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2010-02-16T19:52:22.457

您可以按照以下步骤让 git 守护程序在 Windows 下运行：

*（先决条件：一个默认的 Cygwin 安装和一个支持 git 守护进程的 git 客户端）*

**第 1 步**：打开 bash shell

**第二步**：在/cygdrive/c/cygwin64/usr/local/bin/目录下，创建一个名为“gitd”的文件，内容如下：

```
#!/bin/bash

/usr/bin/git daemon --reuseaddr --base-path=/git --export-all --verbose --enable=receive-pack 
```

**第 3 步**：从提升的提示符（即以管理员身份）运行以下 cygrunsrv 命令以将脚本安装为服务（注意：假设 Cygwin 安装在 C:\cygwin64）：

```
cygrunsrv   --install gitd                          \
            --path c:/cygwin64/bin/bash.exe         \
            --args c:/cygwin64/usr/local/bin/gitd   \
            --desc "Git Daemon"                     \
            --neverexits                            \
            --shutdown 
```

**第四步**：运行以下命令启动服务：

cygrunsrv --start gitd

你完成了。如果你想测试它，这里有一个快速而肮脏的脚本，它显示你可以将 git 协议推送到本地机器：

```
#!/bin/bash

echo "Creating main git repo ..."
mkdir -p /git/testapp.git
cd /git/testapp.git
git init --bare
touch git-daemon-export-ok
echo "Creating local repo ..."
cd
mkdir testapp
cd testapp
git init
echo "Creating test file ..."
touch testfile
git add -A
git commit -m 'Test message'
echo "Pushing master to main repo ..."
git push git://localhost/testapp.git master 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-02-06T11:43:38.923

[GitStack](http://gitstack.com)可能是您的最佳选择。它目前是免费的（最多 2 个用户）并且在撰写本文时是~~开源的。~~

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2011-06-03T10:36:18.547

这是一个专用于 Windows 的 git 服务器：[https ://github.com/jakubgarfield/Bonobo-Git-Server/wiki](https://github.com/jakubgarfield/Bonobo-Git-Server/wiki)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-10-24T13:06:02.510

如果您在 Windows 环境中工作，您考虑过[Mercurial](http://www.selenic.com/mercurial/wiki/)吗？它是一个类似于 Git 的分布式版本控制系统，但与 Windows 的集成更加整洁和容易。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2010-11-17T20:17:21.447

如果`cygrunsrv: Error starting a service: QueryServiceStatus: Win32 error 1062: The service has not been started.`运行命令后出现错误：

```
cygrunsrv --start gitd 
```

这意味着您没有创建“基本路径”文件夹。

创建文件夹 '/git' 并重新运行命令将解决此问题。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2011-03-10T06:54:15.747

安装 CygWin 有点过头了，请阅读本教程，了解如何更快、更原生地安装：

[http://code.google.com/p/tortoisegit/wiki/HOWTO_CentralServerWindowsXP](http://code.google.com/p/tortoisegit/wiki/HOWTO_CentralServerWindowsXP)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-02-17T22:20:02.917

我目前[在 Windows 上使用 cygwin 的 ssh 守护程序](http://pigtail.net/LRP/printsrv/cygwin-sshd.html)来提供服务并允许远程访问我的仓库。它工作得很好，我可以完全控制谁通过他们的 ssh 证书访问我的存储库，并且性能非常好，甚至在远程 WAN 和 VPN 链接上也是如此。

[另一种解决方案是使用 Gitosis](http://scie.nti.st/2007/11/14/hosting-git-repositories-the-easy-and-secure-way)。它是一种使托管存储库变得更加容易的工具。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-10-24T13:03:33.640

您是否考虑过使用 cygwin 层？请参阅[此链接](http://fab.cba.mit.edu/classes/MIT/863.07/people/steve/git.html)。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-02-07T16:55:52.490

您不需要托管服务，也可以在共享驱动器上创建共享存储库。只需创建一个裸存储库。您可以使用“git clone --bare --shared [source] [dest]”将现有的 repo 克隆到共享的 repo 中。您还可以使用“git init --bare --shared=all”来初始化一个新的存储库。

亨克

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2011-02-26T12:42:49.377

现在 msysGit 支持 git daemon ！它工作正常（至少对我来说）。我会尝试让它作为服务运行......

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2012-10-31T10:28:19.063

[单片机经理](http://www.scm-manager.org/)

*   用于 Git、Mercurial、Subversion 存储库**的**轻量级 http 服务器（仅需要 Java）
*   用于管理用户、ACL、repos 的 Web 界面

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2011-07-02T11:54:02.947

在 Windows 上，您还**可以使用 DAV 扩展通过 HTTP 或 HTTPS 为 Git 存储库提供服务。**

然后可以使用 Apache 身份验证检查来保护 Git 存储库路径，例如限制到某些 IP 地址或 htpasswd/htdigest 类型身份验证。

使用 htpasswd/htdigest 身份验证的限制是用户名：密码是在请求的 Git URL 中传递的，因此将对 Git URL 的访问限制为某些 IP 地址会更好。

*编辑：*请注意，您可以将密码留在 Git URL 之外，Git 会在推送和获取/拉取时提示您输入密码。

使用 HTTPS 意味着所有数据在传输过程中都是加密的。

它很容易设置和工作。

以下示例显示了通过标准 HTTP 的 IP 地址和用户：密码的访问控制组合。

**示例 Apache 虚拟主机**

```
## GIT HTTP DAV ##
<VirtualHost *:80>

  ServerName git.example.com
  DocumentRoot C:\webroot\htdocs\restricted\git
  ErrorLog C:\webroot\apache\logs\error-git-webdav.log

    <Location />
      DAV on
      # Restrict Access
      AuthType Basic
      AuthName "Restricted Area"
      AuthUserFile "C:\webroot\apache\conf\git-htpasswd"
      # To valid user
      Require valid-user
      # AND valid IP address
      Order Deny,Allow
      Deny from all
      # Example IP 1
      Allow from 203.22.56.67 
      # Example IP 2
      Allow from 202.12.33.44 
      # Require both authentication checks to be satisfied
      Satisfy all
    </Location>

</VirtualHost> 
```

**示例 .git/config**

```
[core]
    repositoryformatversion = 0
    filemode = true
    bare = false
    logallrefupdates = true
[remote "origin"]
    fetch = +refs/heads/*:refs/remotes/origin/*
    url = http://username:password@git.example.com/codebase.git
[branch "master"]
    remote = origin
    merge = refs/heads/master 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2013-10-31T14:02:20.633

在工作中，我正在使用安装在 Windows Server 上的 GitBlit GO。完美地工作并与 ActiveDirectory 很好地集成以进行用户身份验证和授权。它也是免费和开源的（Apache 许可）

[GitBlit 主页](http://gitblit.com/)

仅支持 HTTP(S) 访问，不支持 SSH，但在 Windows 下，您应该不再需要任何东西。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-12-06T01:15:03.467

这是 2015 年对超过 7 年的问题的回答。

[从https://bitbucket.org/product/server](https://bitbucket.org/product/server)一次性支付 10 美元，可以为最多**10 个用户**购买 64 位 Windows 许可证。

显然 32 位版本只能通过其存档获得。

**Bitbucket Server**以前称为**Stash**。

请注意，我没有尝试过这个版本，但 10 美元似乎很划算；[在这里，](https://www.atlassian.com/software/bitbucket/pricing?tab=host-on-your-server)我读到 Atlassian 将 10 美元捐给了慈善机构。FWIW

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-04-23T17:56:47.347

我认为 Henk 的意思是您可以在驱动器上创建一个共享存储库，然后将其复制到你们双方都可以访问的某个公共位置。如果有一些公司服务器或者你们都可以通过 ssh 访问的东西，你可以将存储库放在某个地方，你可以将它 SCP 回你自己的计算机，然后从中提取。我为自己做了一段时间，因为我有两台电脑。这很麻烦，但它确实有效。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2011-06-14T23:41:59.020

对于 Windows 7 x64 和 Cygwin 1.7.9，我需要使用 /usr/bin/gitd 作为 cygrunsrv 的 args 参数

```
cygrunsrv   --install gitd                          \
            --path c:/cygwin/bin/bash.exe           \
            --args /usr/bin/gitd                    \
            --desc "Git Daemon"                     \
            --neverexits                            \
            --shutdown 
```

另外，我需要以管理员身份运行 bash 来安装该服务。

# sql-server - 是否可以对 SSIS 包 dtsConfig 文件使用相对路径？

> ID：233434
> 
> 赞同：22
> 
> 时间：2008-10-24T13:00:24.113
> 
> 标签：sql-server, ssis, etl

我正在尝试使我们的 SQL Server 集成服务包尽可能可移植，而阻止这一点的一件事是配置的路径始终是绝对路径，这使得测试和部署令人头疼。有什么建议可以让这更易于管理吗？

另一个问题是，当另一个开发人员从源代码​​控制中获取包时，路径是特定于开发人员机器的。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-24T13:30:12.913

如果您尝试使用 Visual Studio 执行包，则配置文件路径将在那里硬编码。因此，如果您移动项目，则需要更改包设置中的路径。为避免这种情况，您可以使用环境变量选项来存储配置文件路径。然后你只需要改变它。

但是，对于测试和部署，您可能应该使用 dtexec 实用程序来执行您的包。为此制作一些批处理文件。最好为每个不同的环境使用一个。这里配置文件路径可以是相对的。

```
dtexec /File Package.dtsx /Conf configuration.dtsConfig 
```

这是如果你的包在文件系统上。您也可以将它们存储在 SQL Server 中。您还可以将配置存储在 SQL Server 中，这可以提供灵活性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T09:47:03.353

经过几个小时尝试完成这项工作后，我在[这里](https://web.archive.org/web/20180620162930/http://www.beyeblogs.com/rda_corp/archive/2010/02/errors_locating.php)找到了一个解决方案（不是最好的，但它有效）

1.  在与解决方案文件（.sln 文件）相同的目录中找到您的配置文件（dtsconfig 文件）
2.  始终通过双击解决方案文件（.sln 文件）打开您的解决方案。这会将“工作文件夹”设置为解决方案所在的位置，您的配置文件将被正确读取

否则，相对路径对我不起作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-19T05:40:59.227

查看可以在没有 BIDS 的情况下编辑 SSIS 配置文件路径的免费实用程序：http: [//ssisconfigeditor.codeplex.com/](http://ssisconfigeditor.codeplex.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-17T02:13:22.347

我解决这类问题的标准技巧是映射驱动器。

通过使用[映射的网络驱动器](http://windows.microsoft.com/en-au/windows-vista/create-a-shortcut-to-map-a-network-drive)或使用[Subst](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/subst.mspx?mfr=true)（这两种方法都是可互换的）。

例如，将包的位置映射到 N:\，然后在包中使用 N:\MyParentPackage.dtsx、N:\MyChildPackage.dtsx 的路径。这些包可以位于不同机器上不同文件夹中的完全不同的驱动器上，一旦将包位置映射到 N:\

我通常在项目文件旁边放一个脚本来映射驱动器，它映射驱动器以便它可以在之前轻松运行。一个问题，如果您在 VISTA - Win8 上使用 subst，请将其映射为提升和非提升。

我对 Visual Studio 项目中的文件引用使用相同的方法。这种方法唯一的问题是，你用来解决开发环境中的太多问题，你会用完驱动器号。

# svn - SVN：如何维护我的本地 config.blah 文件？

> ID：233441
> 
> 赞同：8
> 
> 时间：2008-10-24T13:02:18.993
> 
> 标签：svn, file, config, local

在 SVN 服务器上，有一个名为`config.conf`. 我有一个本地版本，称为相同的东西（在同一个地方）。**如何确保我的本地配置不会被覆盖或签入？**

当我在这里时，目录的答案是否不同？

我正在使用 Tortoise SVN，但命令行答案很酷。

谢谢！

[对不起，如果以前有人问过这个基本问题……我看了但没有找到。]

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-08-27T20:48:15.757

TortoiseSVN 对这个问题的一半有一个很好的答案：**ignore-on-commit**

这可以防止您意外提交“仅限本地”更改，但它并不能解决意外更新本地更改文件的问题。

查看此博客文章，了解详细的如何：

[http://blog.baljeetsingh.net/2009/02/tips-tricks-svn-ignore-on-commit.html](http://blog.baljeetsingh.net/2009/02/tips-tricks-svn-ignore-on-commit.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-24T13:12:11.593

1.  使用 svn:ignore 将其从存储库中排除（您必须先将其从存储库中删除）
2.  在 config.conf.default 中保留一份带有占位符值的副本。您可以在存储库中保留默认副本。
3.  正常使用 config.conf - subversion 不会再看到它了

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-24T13:11:26.993

谢谢大家。我以为 Eoin 可能疯了，但事实上这是真的。您不能忽略版本控制中的文件。

根据乌龟文档

> 忽略版本化项目
> 
> 版本化的文件和文件夹永远不能被忽略——这是 Subversion 的一个特性。如果您错误地对文件进行了版本控制，请阅读名为“忽略已经版本控制的文件”的部分，了解如何“取消版本”它的说明。

从 SVN 文档

> 我的项目中有一个文件，每个开发人员都必须更改，但我不希望那些本地模块被提交。如何让 'svn commit' 忽略该文件？
> 
> 答案是：不要将该文件置于版本控制之下。相反，将文件模板置于版本控制之下，例如“file.tmpl”。
> 
> 然后，在最初的“svn checkout”之后，让您的用户（或您的构建系统）将模板的正常操作系统副本复制到正确的文件名，并让用户自定义副本。该文件是无版本的，所以它永远不会被提交。如果您愿意，您可以将文件添加到其父目录的 svn:ignore 属性中，这样它就不会显示为“？” 在'svn status'命令中。

这非常烦人......我想我只需要小心那个文件并制作我自己的配置的备份副本（我可以忽略）。

感谢大家的回答。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-24T13:04:39.067

您可以将 svn-ignore: 属性添加到不包括 config.conf 甚至 *.conf 的本地文件夹

但我相信，你必须从 SVN 中完全排除这个文件，即如果它已经被签入到 repo，你需要先从存储库中删除它

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-24T13:07:13.773

如果您将其命名为相同并将其粘贴在同一目录中，SVN 将始终认为该文件是存储库的一部分。你的选择是

*   重命名它（也许写一个shell脚本`mv config.conf config.conf.theirs && mv config.conf.mine config.conf`然后运行你的应用程序）
*   移动它。可能会在您的应用程序中添加一些逻辑，以检查本地用户特定目录中的 config.conf，然后在未找到时使用默认的 config.conf

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-24T13:05:30.500

忽略该文件应该可以帮助您：

[http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-ignore.html](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-ignore.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-24T13:14:12.993

当配置文件发生颠覆时，我发现拥有一个专用于它的整个主干非常有用。为什么？主要是因为您可以简单地拥有两个本地存储库副本，一个用于本地使用，一个用于远程转换。

像这样：

/workdir/configuration [是到 /workdir/conf_local 的链接]
/workdir/conf_local [保持本地配置更新但不会覆盖我的设置]
/workdir/conf_remote [总是使用远程数据更新，所以我可以提交更改]

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-24T13:41:31.487

我不知道你有什么样的设置，或者这是否适用于你碰巧使用的任何语言，但这是我使用网站和 PHP 的方式。

首先，您创建默认配置，它可能具有不适用于 90% 的设置的幼稚值，但会为您提供有关哪些值以及实际可以配置的值的参考。该脚本通常称为 ' `config.default.php`' 或类似的名称。在这个脚本的底部是这样的：

```
if (file_exists("config.php")) require "config.php"; 
```

简单的逻辑。如果配置文件有用户覆盖，则将其加载，并让它覆盖它需要的任何内容。然后通过已经在所有开发机器上解释的方法忽略这个用户配置文件，以及任何出于任何原因保持 svn checkout 的生产机器。这是一个非常灵活的设置，并且可以为大多数语言/环境设置类似的过程。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-01-07T10:52:59.713

正如 Scrappydog 指出的那样

您可以在提交对话框中使用/创建不同的列表

它支持**忽略提交**列表，这样该列表下的文件将不可见..

您可以参考 **[此博客链接](http://blog.baljeetsingh.net/2009/02/tips-tricks-svn-ignore-on-commit.html)**了解详细信息。

[http://blog.baljeetsingh.net/2009/02/tips-tricks-svn-ignore-on-commit.html](http://blog.baljeetsingh.net/2009/02/tips-tricks-svn-ignore-on-commit.html)

# apache-flex - 使用 Flex 显示小型嵌入式动画图像的最佳方式是什么？

> ID：233443
> 
> 赞同：1
> 
> 时间：2008-10-24T13:02:42.783
> 
> 标签：apache-flex, animation, flv

我需要在 Flex 应用程序中显示一个小（15x15 像素）动画。我有它的 FLV 格式，但它可以转换成别的东西。我希望将文件嵌入到应用程序中（它只有 8k 大小）。我看过关于使用第三方代码显示动画 GIF 的帖子，这没问题，但是有没有办法使用本机 Flex 库来做到这一点。我还意识到 FLV 可以显示在 Video 对象中，但前提是它们是外部文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-24T21:18:06.450

It is a lot easier converting it into a SWF and displaying it in an `Image` control. [SWFTools](http://www.swftools.org/) can convert animated GIF into SWF file, small enough to be embedded in your app.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-25T20:23:24.910

或者，您可以将其转换为一个好的旧动画 GIF 文件并使用此包嵌入和播放它：

[http://www.bytearray.org/?p=95](http://www.bytearray.org/?p=95)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T23:42:10.640

我猜您在 SWF 中的开头或结尾都有一个空白框。

# c++ - 使用 Win32 API 监控电池电量

> ID：233446
> 
> 赞同：6
> 
> 时间：2008-10-24T13:04:33.857
> 
> 标签：c++, c, winapi, monitor, power-management

我正在尝试编写一个小应用程序来监视笔记本电池中剩余的电量，我想知道我可以使用哪个 Win32 函数来完成此操作。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-24T13:06:58.657

对于 Vista 及更高版本，您可以使用[RegisterPowerSettingNotification](http://msdn.microsoft.com/en-us/library/aa373196(VS.85).aspx)

有关早期功能，请参阅MSDN 页面“[电源](http://msdn.microsoft.com/en-us/library/aa373163(VS.85).aspx)管理功能：Windows Server 2003 及更早版本”的此部分中的电源管理功能

[您可以在codeproject](http://www.codeproject.com/KB/vista/VGPowerMonitor.aspx)上查看 Vista 方法的示例代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-04-03T16:01:20.217

我推荐使用 Win32 [GetSystemPowerStatus](https://msdn.microsoft.com/en-us/library/windows/desktop/aa372693%28v=vs.85%29.aspx)函数。代码片段：

```
int getBatteryLevel()
{
    SYSTEM_POWER_STATUS status;
    GetSystemPowerStatus(&status);
    return status.BatteryLifePercent;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-25T12:35:31.140

以下链接中有一篇非常详细的文章，以及一个示例项目（在 Win8.1 上测试）： http: [//www.codeproject.com/Articles/15829/Vista-Goodies-in-C-Monitoring-计算机的力量](http://www.codeproject.com/Articles/15829/Vista-Goodies-in-C-Monitoring-the-Computer-s-Power)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-02-09T18:38:12.487

你可以听听[`PBT_APMPOWERSTATUSCHANGE`](https://docs.microsoft.com/en-us/windows/win32/power/pbt-apmpowerstatuschange)。此事件在以下 3 种情况下触发。

1.  电池寿命降至不到 5 分钟的电量，或
2.  电池寿命低于 10%，
3.  电池寿命改变 3%

理想的方法是在收到此事件时调用 [GetSystemPowerStatus()](https://docs.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-getsystempowerstatus)，而不是连续轮询。的`BatteryLifePercent`成员`SYSTEM_POWER_STATUS`将以百分比给出电池寿命。

对于此事件，您将必须处理该[`WM_POWERBROADCAST`](https://docs.microsoft.com/en-us/windows/win32/power/wm-powerbroadcast)消息。对于`PBT_APMPOWERSTATUSCHANGE`wParam 将是`PBT_APMPOWERSTATUSCHANGE`

# c# - C# 中的网络摄像头使用

> ID：233455
> 
> 赞同：22
> 
> 时间：2008-10-24T13:06:04.930
> 
> 标签：c#, clipboard, webcam

我正在用 C# 编写一个程序来连接网络摄像头并用它进行一些图像处理。我有一个工作应用程序，它使用 win32 api (avicap32.dll) 连接到网络摄像头并向其发送消息，将其发送到剪贴板。问题是，虽然可以从绘制中访问，但从程序中读取它会导致空指针。

这是我用来连接网络摄像头的代码：

```
mCapHwnd = capCreateCaptureWindowA("WebCap", 0, 0, 0, 320, 240, 1024, 0);

SendMessage(mCapHwnd, WM_CAP_CONNECT, 0, 0);
SendMessage(mCapHwnd, WM_CAP_SET_PREVIEW, 0, 0); 
```

这就是我用来将图像复制到剪贴板的方法：

```
SendMessage(mCapHwnd, WM_CAP_GET_FRAME, 0, 0);

SendMessage(mCapHwnd, WM_CAP_COPY, 0, 0);
tempObj = Clipboard.GetDataObject();
tempImg = (System.Drawing.Bitmap)tempObj.GetData(System.Windows.Forms.DataFormats.Bitmap); 
```

我从代码中删除了一些错误检查以使其更短。

提前致谢 ：）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-24T17:08:20.043

我最近开始在这个领域做一些业余爱好。

我们决定使用带有[opencvdotnet](http://code.google.com/p/opencvdotnet/)包装器的[OpenCV](http://sourceforge.net/projects/opencv/)库。它支持从网络摄像头捕获帧：

```
using (var cv = new OpenCVDotNet.CVCapture(0))
{
    var image = cv.CreateCompatibleImage();
    // ...
    cv.Release();
} 
```

如果您在进行图像处理，OpenCV 的图像处理算法已经封装在 OpenCVDotNet.Algs 程序集中。

如果您决定走这条路，请务必安装 OpenCV 1.0 版（如果您使用的是 64 位 Vista，请将其安装到“c:\program files\opencv”，或“mklink OpenCV 'c:\program files (x86) \OpenCV`" 从正确的目录，否则 opencvdotnet 将无法安装）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-24T18:11:32.847

实际上有两种方法可以将相机数据导入您的应用程序，DirectShow 和 WIA。Microsoft 建议您使用[WIA](http://msdn.microsoft.com/en-us/library/ms630368.aspx)，并且 WIA 的界面相当简单，可以让您大开眼界。我基于不久前所做的工作创建并发布了一个开源[WIA 桌面库。](http://blog.opennetcf.com/ctacke/2007/12/21/WIADesktopLibrary.aspx)

现在WIA在某些情况下的问题是它太简单了。例如，如果您想调整相机属性（如帧速率、分辨率等），那么 WIA 就会失败。Microsoft 弃用了 DirectShow，但他们确实没有给我们任何具有其所有功能的替代品，而且我发现它在所有现有平台上继续正常工作（它非常根深蒂固，所以我无法想象支持会消失很快）。

SourceForge 上有一个非常好的[DirectShow 库](http://directshownet.sourceforge.net/)。唯一的“问题”是它真的很复杂，这源于 DShow 一开始就非常复杂和令人困惑的事实。包装器可以做很多不容易解决的事情，但它们确实为许多常见用例提供了示例，例如显示视频或捕获帧。如果您想添加叠加层或插入其他过滤器，它可以做到，但请注意它一点也不简单。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-11-09T03:45:11.807

看看这篇文章： http: [//www.codeproject.com/KB/miscctrl/webcam_c_sharp.aspx](http://www.codeproject.com/KB/miscctrl/webcam_c_sharp.aspx)

它比安装和使用 OpenCVNetWrapper 简单多了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T14:50:44.517

你试过 Clipboard.GetImage() 吗？您还可以尝试各种 Clipboard.Contains*() 方法来查看数据存储在剪贴板中的格式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-02-15T17:22:37.283

我尝试过的 OpenCV 捕获、EMGU 捕获和所有其他捕获库都有
相同的问题：您不能以编程方式高于 640x480
（不打开 windows 视频源窗口）。

我建议使用这个（确实有效）：
[https ://github.com/ofTheo/videoInput](https://github.com/ofTheo/videoInput)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-26T08:58:28.033

这也被问到[如何在 C# 中获取网络摄像头图像？](https://stackoverflow.com/questions/2881858/how-to-get-web-cam-images-in-c)您可能会发现以下内容很有用（很抱歉发送垃圾邮件，但这确实有助于回答问题）：

我刚刚发布了我的 Windows 应用程序 CamTimer 的完整源代码（用 .NET/C# 编写）。[在https://github.com/johanssonrobotics/CamTimer](https://github.com/johanssonrobotics/CamTimer)下载/查看完整代码（带有工作网络摄像头示例）

快乐编码！

# javascript - 打开新浏览器窗口的最佳方式是什么？

> ID：233467
> 
> 赞同：36
> 
> 时间：2008-10-24T13:08:46.577
> 
> 标签：javascript, html, browser

我知道大多数链接应该留给最终用户来决定如何打开，但我们不能否认有时你几乎“不得不”强行进入一个新窗口（例如在表单中维护数据在当前页面上）。

我想知道的是关于在新浏览器窗口中打开链接的“最佳”方式的共识是什么。

我知道那`<a href="url" target="_blank">`已经结束了。我也知道由于`<a href="#" onclick="window.open(url);">`各种原因这并不理想。我还尝试用类似的东西完全替换锚点，`<span onclick="window.open(url);">`然后将 SPAN 设置为看起来像一个链接。

我倾向于的一种解决方案是`<a href="url" rel="external">`使用 JavaScript 在标记为“外部”的锚点上将所有目标设置为“_blank”。

还有其他想法吗？什么更好？我正在寻找最符合 XHTML 且最简单的方法来执行此操作。

更新：我说 target="_blank" 是不可以的，因为我在[几个地方](http://www.sitepoint.com/article/standards-compliant-world/3/)读到target 属性将被 XHTML 淘汰。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-10-24T13:19:50.707

我正在使用您提出的最后一种方法。我添加 rel="external" 或类似的东西，然后使用 jQuery 遍历所有链接并为它们分配一个点击处理程序：

```
$(document).ready(function() {
  $('a[rel*=external]').click(function(){
    window.open($(this).attr('href'));
    return false; 
  });
}); 
```

我发现这是最好的方法，因为：

*   语义上非常清楚：您有一个指向外部资源的链接
*   它符合标准
*   它优雅地降级（你有一个非常简单的常规`href`属性链接）
*   如果他们愿意，它仍然允许用户中键单击链接并在新选项卡中打开它

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-24T13:11:41.953

为什么是`target="_blank"`个坏主意？

它应该完全按照您的意愿行事。

编辑：（见评论）点了，但我确实认为使用 javascript 来完成这样的任务会导致一些人非常不高兴（那些习惯性地在新窗口中单击以打开新窗口的人，以及那些使用 NoScript 扩展的人） )

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-25T08:05:19.093

请**不要强行**在新窗口中打开链接。

反对的理由：

*   它违反了最小惊讶规则。
*   后退按钮不起作用，用户可能不知道原因。
*   选项卡式浏览器会发生什么？新标签还是新窗口？无论发生什么情况，如果您混合选项卡和窗口，这是您想要的吗？

我总是听到支持打开新窗口的原因是用户不会离开网站。但可以肯定的是，我永远不会回到让我烦恼的网站。如果该网站夺走了我的控制权，那将是一个很大的烦恼。

一种方法可能是，您提供两个链接，一个是正常的，另一个在新窗口中打开它。在正常链接之后添加带有小符号的第二个。这样，您网站的用户就可以控制他们想要点击的链接。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-07-10T04:35:36.420

这是我为 jQuery 编写的插件

```
 (function($){  
  $.fn.newWindow = function(options) {       
    var defaults = {
        titleText: 'Link opens in a new window'     
    };

     options = $.extend(defaults, options);

     return this.each(function() {  
       var obj = $(this);

       if (options.titleText) {        
           if (obj.attr('title')) {
                     var newTitle = obj.attr('title') + ' (' 
                                                + options.titleText + ')';
           } else {
                    var newTitle = options.titleText;
           };              
           obj.attr('title', newTitle);            
       };          

       obj.click(function(event) {
          event.preventDefault();  
          var newBlankWindow = window.open(obj.attr('href'), '_blank');
          newBlankWindow.focus();
        });     
       });    
  };  
 })(jQuery); 
```

**示例用法**

```
$('a[rel=external]').newWindow(); 
```

您还可以通过传入一些选项来更改或删除标题文本

更改标题文本的示例：

```
$('a[rel=external]').newWindow( { titleText: 'This is a new window link!' } ); 
```

将其全部删除的示例

```
$('a[rel=external]').newWindow( { titleText: '' } ); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-24T13:13:46.520

也许我误解了一些东西，但你为什么不想使用 target="_blank"？我就是这样做的。如果您正在寻找最兼容的，那么任何类型的 JavaScript 都会被淘汰，因为您无法确定客户端是否启用了 JS。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-25T07:07:37.087

```
<a href="http://some.website.com/" onclick="return !window.open( this.href );">link text</a> 
```

详细信息在我[对另一个问题的回答中进行了](https://stackoverflow.com/questions/134845/href-for-javascript-links-or-javascriptvoid0#143410)描述。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-24T13:18:01.833

```
<a href="http://www.google.com" onclick="window.open(this.href); return false"> 
```

如果用户禁用了 JS，这仍然会打开链接（尽管在同一个窗口中）。否则，它的工作原理与 target=blank 完全相同，而且它很容易使用，因为您只需将 onclick 函数（可能通过使用 JQuery）附加到所有普通标签。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-24T14:05:38.927

如果您使用任何严格的文档类型或即将推出的真正的 xhtml 风格，则不允许使用目标...

使用过渡，无论是 HTML4.01 还是 XHTML1，您都可以使用 Damirs 解决方案，尽管它无法实现 window.open() 中必需的 windowName-property：

在纯 html 中：

```
<a href="..." target="_blank" onclick="window.open(this.href, 'newWin'); return false;">link</a> 
```

但是，如果您使用其中一种严格的文档类型，则打开链接的唯一方法是在没有目标属性的情况下使用此解决方案...

-- 顺便说一句，非 js 浏览器的数量经常被错误计算，查找计数器数字指的是非常不同的数字，我想知道这些非 js 浏览器中有多少是爬虫之类的！-)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-24T14:37:32.170

如果我在表单页面上单击 moreinfo.html 链接（例如）会导致我丢失数据，除非我在新选项卡/窗口中打开它，请告诉我。

您可以欺骗我使用 window.open() 或 target="_blank" 打开新选项卡/窗口，但我可能禁用了目标和弹出窗口。如果您需要 JS、目标和弹出窗口来欺骗我打开新窗口/选项卡，请在我开始使用表单之前告诉我。

或者，将指向另一个页面的链接作为表单请求，以便当访问者提交时，保存当前表单数据，以便他们可以从上次开始（如果可能）继续。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-07-29T21:06:07.343

我用这个...

```
$(function() {
  $("a:not([href^='"+window.location.hostname+"'])").click(function(){
    window.open(this.href);
    return false;
  }).attr("title", "Opens in a new window");
}); 
```

# asp.net - 如何为自定义控件定义默认的“TagPrefix”

> ID：233468
> 
> 赞同：9
> 
> 时间：2008-10-24T13:08:47.560
> 
> 标签：asp.net

我有许多自定义控件，我正在尝试启用设计器支持。签名如下所示：

```
[ToolboxData("<{0}:MyDropDownList runat=\"server\" CustomProp="123"></{0}:MyDropDownList>")]
public class MyDropDownList: DropDownList
{
   ... code here
} 
```

这很好用，但是当我从工具箱将控件拖到页面上时，添加的 TagPrefix 是“cc1”：

```
<%@ Register Assembly="DBMClientPortal.Controls" Namespace="DBMClientPortal.Controls"
    TagPrefix="cc1" %> 
```

显然，TagPrefix 是什么有点无关紧要......它按原样工作，但我想我*必须*能够以某种方式改变它，好奇心让我变得更好......

任何人都知道如何定义将自定义控件拖到 Visual Studio 中的页面时将设置的 TagPrefix 吗？

谢谢，马克斯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-24T13:14:36.037

它看起来像这样：

```
[assembly:TagPrefix("MyControls","RequiredTextBox")] 
```

这里有一些关于它[的](http://msdn.microsoft.com/en-us/library/system.web.ui.tagprefixattribute.tagprefixattribute.aspx)更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T01:03:09.260

仅供参考，TagPrefix 属性只是对 Visual Studio 和其他设计器工具的*建议。*如果用户已经将您的命名空间注册到不同的标签前缀，则可以自由使用该标签前缀。此外，如果您建议的标记前缀已在使用中并指向不同的命名空间，则 Visual Studio 将使用自动生成的标记前缀。

但是，如果您选择基于您的产品或公司名称的标签前缀，那么其中任何一种情况发生的可能性都相当小。

# java - 如何模拟实例化为局部变量的类

> ID：233475
> 
> 赞同：1
> 
> 时间：2008-10-24T13:11:06.650
> 
> 标签：java, unit-testing, tdd, mocking

我正在为调用一些 DAO 类以对数据库执行操作的业务方法编写测试。

这个方法，首先从 DataSource 对象中检索一个 JDBC 连接，将相同的连接传递给所有 DAO 实例，所以我可以用它来控制事务。因此，如果一切正常，我必须通过连接对象调用 commit()。

我想测试是否调用了 commit()，所以我想创建一个检查它的期望（我正在使用 JMock）。但由于 Connection 类不是我的 Business 类的直接邻居，我不知道该怎么做。

有人知道如何克服这个吗？有一些 JMock 工具可以解决这个问题，还是有一些替代设计可以克服这个问题？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T13:17:33.627

您需要模拟`DataSource` *，* `Connection`以便您的模拟`DataSource`返回您的模拟`Connection`。是的，这种事情最终变成了真正的痛苦……

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-24T13:18:38.493

我很难从您的描述中确切地知道您的类是如何组成的，但是 DataSource 应该通过它的构造函数或`setDataSource()`方法注入到您的 DAO 类中。

这将允许您单独测试 DAO，并允许您在单元测试中构建模拟 DataSource 并将其传递给正在测试的 DAO。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-24T13:48:28.340

重构以便将 Connection 注入到 Dao 中，并将 Dao 注入到业务类中。然后，您可以模拟 Dao 和/或 Connection。您可以轻松编写自己的模拟来扩展 Connection 并覆盖 connect() 以设置一个布尔值，稍后您可以通过诸如 wasConnectCalled() 之类的编写方法检索该布尔值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T19:52:37.950

我肯定会建议您使用[spring-jdbc](http://static.springframework.org/spring/docs/2.5.x/reference/jdbc.html)而不是自己尝试编写这种代码。这将确保正确关闭连接、语句和结果集。Spring 还具有出色的事务管理，因此您根本不必担心这一点。

例如，看看这个使用 spring-jdbc 的典型更新语句：

```
public void updateName(int id, String name) {
    getJdbcTemplate().update(
            "update mytable set name = ? where id = ?", 
            new Object[] {name, new Integer(id)});
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-24T13:21:26.660

使 bussines 类从全局/静态对象工厂检索局部变量。这样，您可以将工厂置于测试模式并使其返回模拟对象而不是真实对象。

那应该可以。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T18:22:58.277

@Paul 附议。一旦你将连接的管理分离出来，你就可以在一个回调中编写其余的行为，然后将它传递给拥有连接的东西——比如 UnitOfWork。连接所有者处理事务，并将连接传递给 UnitOfWork。事务在一个地方——易于测试，UnitOfWork 在另一个地方，使用模拟连接进行测试。

# .net - IIS 5 上的 ASP.NET 2.0 应用程序导致错误（aspnet_wp.exe (PID: XXXX) 意外停止。）

> ID：233478
> 
> 赞同：3
> 
> 时间：2008-10-24T13:11:48.927
> 
> 标签：.net, asp.net, .net-2.0, asp.net-2.0, iis-5

在 Windows 2000 服务器 (IIS 5) 上托管 ASP.NET 2.0 Web 应用程序之后。我无法浏览该网站。

浏览器上显示以下错误消息，并添加了三个事件日志条目...

**浏览器上的错误消息**

> 服务器应用程序不可用 您尝试在此 Web 服务器上访问的 Web 应用程序当前不可用。请在您的网络浏览器中点击“刷新”按钮以重试您的请求。

**事件日志条目**

> 事件类型：错误
> 事件源：ASP.NET 2.0.50727.0
> 事件类别：无
> 事件 ID：1000
> 日期： 2008 年 10 月 24 日
> 时间：下午 3:45:26
> 用户：N/A
> 计算机：XXXXX
> 描述：aspnet_wp.exe ( PID: XXXX) 意外停止。
> 
> 事件类型：错误
> 事件源：ASP.NET 2.0.50727.0
> 事件类别：无
> 事件 ID：1088
> 日期： 2008 年 10 月 24 日
> 时间：下午 3:45:26
> 用户：N/A
> 计算机：XXXXX
> 描述：无法执行请求因为无法创建应用程序域。错误：0x80070005 访问被拒绝。
> 
> 事件类型：警告
> 事件源：ASP.NET 2.0.50727.0
> 事件类别：无
> 事件 ID：1073
> 日期： 2008 年 10 月 24 日
> 时间：下午 3:45:26
> 用户：
> 不适用计算机：WEBDEV
> 描述：无法初始化AppDomain：/LM/W3SVC/1/Root/WebApplicationName
> 异常：System.IO.FileLoadException
> 消息：无法加载文件或程序集“System.Web，版本=2.0.0.0，Culture=neutral，PublicKeyToken=b03f5f7f11d50a3a”或其之一依赖关系。访问被拒绝。StackTrace：在 System.Reflection.Assembly.nLoad（AssemblyName 文件名，字符串代码库，证据 assemblySecurity，程序集 locationHint，StackCrawlMark 和 stackMark，布尔 throwOnFileNotFound，布尔 forIntrospection）
> 在 System.Reflection.Assembly.InternalLoad(AssemblyName assemblyRef, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection)
> 在 System.Reflection.Assembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection)
> 在 System.Activator.CreateInstance(String assemblyName, String typeName, Boolean ignoreCase, BindingFlags bindingAttr, Binder binder, Object[] args, CultureInfoculture, Object[] activationAttributes, Evidence securityInfo, StackCrawlMark& stackMark)
> at System.Activator.CreateInstance(String assemblyName, String typeName)
> at System.AppDomain .CreateInstance（字符串组件名称，字符串类型名称）
> 在 System.AppDomain.CreateInstance(String assemblyName, String typeName)
> 在 System.Web.Hosting.ApplicationManager.CreateAppDomainWithHostingEnvironment(String appId, IApplicationHost appHost, HostingEnvironmentParameters hostingParameters)
> 在 System.Web.Hosting.ApplicationManager.CreateAppDomainWithHostingEnvironmentAndReportErrors(String appId, IApplicationHost appHost, HostingEnvironmentParameters 托管参数）

有任何想法吗...

** 编辑 **

为什么会抛出 System.IO.FileLoadException 来访问 System.Web 程序集？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-27T09:16:52.620

我发现当网站文件夹被复制到服务器时，它继承了父文件夹的安全权限，该文件夹仅对管理员、管理员和系统帐户具有权限。

我添加了

*   IUSER_MACHINENAME（互联网访客帐户）
*   ASPNET（ASP.NET 机器帐户）

使用**Read & Execute**，**列出文件夹内容**和**读取**权限。

**即使问题解决了我仍然有一些问题**

从第三个事件日志条目中可以清楚地看出，ApplicationManager 无法创建 System.Web 程序集中的 HostingEnvironment。

由于 System.Web 引发了 FileLoadException，因此 ASP.NET 工作进程似乎无权访问 GAC 文件夹。

为什么访问 System.Web 会抛出 FileLoadException？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T14:10:19.073

从外观上看，您为 ASP.NET 安装设置了不正确的权限。通常最好的办法是卸载并重新安装 ASP.NET 部分。您可以通过以下方式轻松完成此操作。

1.  打开命令提示符到 C:\windows\microsoft.net\framework\v2.0.50727
2.  运行以下命令：aspnet_regiis.exe -u
3.  运行以下命令：aspnet_regiis.exe -i

这将卸载 ASP.NET 并重新安装，然后应该为该帐户建立适当的权限。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T14:10:45.250

此错误意味着您的代码引发了导致 IIS 崩溃或强制关闭的异常。导致这种情况的常见异常是 OutOfMemoryException 和 StackOverflowException。

您收到 FileLoadException，但可能存在潜在的 OutOfMemoryException 或类似情况，这实际上是其根本原因。在不知道您要加载的内容以及其中的代码的情况下，不可能说出真正导致您的问题的原因。

不过，为了排除加载组件的问题，我要做的第一件事是尝试在测试工具中对其进行反思，看看是否会发生同样的问题。如果是这样，那么问题在于您尝试加载的 DLL，而不是 IIS。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-29T21:40:51.640

我遇到了同样的问题，它并没有与带有 -u 和 -i 的 aspnet_regiis 以及许多其他人建议的问题一起[消失](http://social.msdn.microsoft.com/Forums/en-US/asmxandxml/thread/bf530e90-5d42-4909-a858-6be0ae28717d)。但是在我清理“%windir%\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files”文件夹并从 web.config 中的身份模拟部分向用户授予该文件夹读写权限后，问题就消失了。授予本地 ASPNET 用户这些权限是不够的。

# c# - 需要模拟用户访问网络资源，Asp.Net 帐户

> ID：233490
> 
> 赞同：3
> 
> 时间：2008-10-24T13:16:28.387
> 
> 标签：c#, .net, asp.net, impersonation, delegation

我需要访问只有给定域帐户才能访问的网络资源。我正在使用 LogonUser 调用，但出现“用户没有所需的权限”异常，因为 Web 应用程序使用 asp.net 帐户运行，并且它没有足够的权限来进行此调用。

有没有办法绕过它？更改 ASP.Net 帐户的身份或权限不是一种选择，因为这是一台运行着许多项目的生产机器。有没有更好的方法来实现这一目标？

使用 Asp.Net 2.0，表单身份验证。

亲切的问候。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-24T13:52:48.500

仅仅调用 LogonUser 是不够的。您需要模拟该用户。您可以模拟访问网络资源。

示例代码可以在[MSDN](http://msdn.microsoft.com/en-us/library/chf6fbt4.aspx)上找到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T13:31:05.627

你可以添加一个

```
<identity impersonate="true" userName=""/> 
```

标记到您的 web.config 但这可能并不理想，因为您可能不想以该用户身份运行整个站点...

您可以使用域名和密码将网络共享映射为本地驱动器...然后通过映射的驱动器将文件拉到网站上吗？

```
NET USE Z: \\SERVER\Share password /USER:DOMAIN\Username /PERSISTENT:YES 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T13:40:47.403

我只在 1.1 下对此有过亲身体验，所以在 2.0 天里情况可能会发生变化，但是......我们有一个可以部署在 Intranet 场景中的应用程序，我们也遇到了同样的事情。我们在打开身份模拟、表单模式身份验证、关闭匿名访问的情况下运行。控制这个（我发现）的最简单方法是将有权访问的用户的凭据放在 web.config 中。它们在您打开身份模拟的节点上进行。如果它是超级秘密信息，我不会这样做！我们只在打印环境中访问共享图形，因此大多数网站都乐于为我们设置一个受限帐户以放入 web.confit。LogonUser 确实需要提升的特权。Msdn 有一些关于如何在代码中模拟特定用户的好文章。一世'

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T13:59:20.173

能否更改保护网络资源的 ACL？我过去使用的一个技巧是创建一个 Active Directory 组，然后将计算机对象放入该组。然后，我在需要访问的对象（文件、共享等）的访问控制列表中使用该组。

这使我能够将 Windows 服务作为本地系统运行并访问受保护的网络资源。这个技巧似乎也适用于作为网络服务运行的 ASP.NET 进程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-25T09:44:34.560

*   使用此 WebPart y 连接到具有受限访问权限的网络资源，我放置了一个文件并关闭与资源的连接（作为具有授予访问权限的用户），您不需要建立新的共享连接，这是唯一的限制，我的sistems部门给我。可能是，有很多必要的导入，但我做了很多测试，我没有时间清理代码。我希望对你有所帮助。（对不起我糟糕的英语）。

导入 System 导入 System.ComponentModel 导入 System.Web.UI 导入 System.Web.UI.WebControls 导入 System.IO 导入 System.IO.File 导入 System.Diagnostics 导入 System.Xml.Serialization 导入 Microsoft.SharePoint 导入 Microsoft.SharePoint.Utilities导入 Microsoft.SharePoint.WebPartPages 导入 Microsoft.SharePoint.WebControls 导入 Microsoft.SharePoint.Administration 导入 System.Security.Principal 导入 System.Security.Permissions 导入 System.Runtime.InteropServices 导入 System.Environment 导入 System.Net.Sockets 导入 System.Web .UI.HtmlControls

公共类 Impersonalizacion Private Const LOGON32_PROVIDER_DEFAULT As Integer = 0 Private Const LOGON32_LOGON_INTERACTIVE As Integer = 2

```
<DllImport("advapi32.dll", SetLastError:=True)> _
Public Shared Function LogonUser(ByVal lpszUsername As String, ByVal lpszDomain As String, ByVal lpszPassword As String, ByVal dwLogonType As Integer, ByVal dwLogonProvider As Integer, ByRef phToken As IntPtr) As Boolean
End Function

<DllImport("advapi32.dll", EntryPoint:="DuplicateToken", ExactSpelling:=False, CharSet:=CharSet.Auto, SetLastError:=True)> _
Public Shared Function DuplicateToken(ByVal ExistingTokenHandle As IntPtr, ByVal ImpersonationLevel As Integer, ByRef DuplicateTokenHandle As IntPtr) As Integer
End Function

Public Shared Function WinLogOn(ByVal strUsuario As String, ByVal strClave As String, ByVal strDominio As String) As WindowsImpersonationContext
    Dim tokenDuplicate As New IntPtr(0)
    Dim tokenHandle As New IntPtr(0)
    If LogonUser(strUsuario, strDominio, strClave, LOGON32_LOGON_INTERACTIVE, LOGON32_PROVIDER_DEFAULT, tokenHandle) Then
        If DuplicateToken(tokenHandle, 2, tokenDuplicate) <> 0 Then
            Return (New WindowsIdentity(tokenDuplicate)).Impersonate()
        End If
    End If
    Return Nothing
End Function 
```

End Class 'WebPart1 的描述。"), XmlRoot(Namespace:="SPSCopiarFichero")> _ 公共类 WebPart1 继承 Microsoft.SharePoint.WebPartPages.WebPart

```
Protected WithEvents File1 As HtmlInputFile

Dim vdestino As String = "\\centappd20nd01\uploads_avisos"
Dim vtemporal As String = "c:\pdf"

Protected WithEvents boton1 As Button
Protected WithEvents usuario As TextBox
Protected WithEvents contra As TextBox
Protected WithEvents dominio As TextBox
Protected WithEvents destino As TextBox
Protected WithEvents origen As TextBox
Protected WithEvents temporal As TextBox
Protected WithEvents log As TextBox
'Render this Web Part to the output parameter specified.
Protected Overrides Sub RenderWebPart(ByVal output As System.Web.UI.HtmlTextWriter)
    log.RenderControl(output)
    output.Write("<br><font>Ruta Origen</font><br>")
    File1.RenderControl(output)
    output.Write("<br><font>Ruta Temporal </font><br>")
    temporal.RenderControl(output)
    output.Write("<br><font>Ruta Destino </font><br>")
    destino.RenderControl(output)
    output.Write("<br><font>Usuario </font><br>")
    usuario.RenderControl(output)
    output.Write("<br><font>Contraseña </font><br>")
    contra.RenderControl(output)
    output.Write("<br><font>Dominio </font><br>")
    dominio.RenderControl(output)
    output.Write("<br><br><center>")
    boton1.RenderControl(output)
    output.Write("</center>")
End Sub
Protected Overrides Sub CreateChildControls()

    dominio = New TextBox
    With dominio
        .Text = "admon-cfnavarra"
        .Width = Unit.Pixel("255")
    End With
    Controls.Add(dominio)

    boton1 = New Button
    With boton1
        .Text = "Copiar Fichero"
    End With
    Controls.Add(boton1)

    File1 = New HtmlInputFile
    With File1

    End With
    Controls.Add(File1)

    usuario = New TextBox
    With usuario
        .Text = "SVCWSINCPre_SNS"
        .Width = Unit.Pixel("255")
    End With
    Controls.Add(usuario)

    contra = New TextBox
    With contra
        .Text = "SVCWSINCPre_SNS"
        .Width = Unit.Pixel("255")
    End With
    Controls.Add(contra)

    destino = New TextBox
    With destino
        .Text = vdestino
        .Width = Unit.Pixel("255")
    End With
    Controls.Add(destino)

    log = New TextBox
    With log
        .Width = Unit.Percentage(100)
        .BackColor = System.Drawing.Color.Black
        .ForeColor = System.Drawing.Color.White
    End With
    Controls.Add(log)

    temporal = New TextBox
    With temporal
        .Text = vtemporal
        .Width = Unit.Pixel("255")
    End With
    Controls.Add(temporal)
End Sub
Private Sub boton1_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles boton1.Click
    If File1.PostedFile.FileName <> "" Then
        Dim _objContext As WindowsImpersonationContext = Nothing
        log.Text = QuienSoy()
        CopyFile(File1.PostedFile.FileName, temporal.Text)
        _objContext = Impersonalizacion.WinLogOn(usuario.Text, contra.Text, dominio.Text)
        CopyFile(temporal.Text & "\" & System.IO.Path.GetFileName(File1.PostedFile.FileName), destino.Text)
        _objContext.Undo()
    Else
        log.Text = "Se debe introducir un fichero"
    End If
End Sub
Friend Shared Function QuienSoy() As String
    Return WindowsIdentity.GetCurrent().Name
End Function
Public Function CopyFile(ByVal StartPath As String, ByVal EndPath As String)
    Try
        Dim fn As String = System.IO.Path.GetFileName(StartPath)
        System.IO.File.Copy(StartPath, EndPath & "\" & fn, False)
        log.Text = "Fichero Copiado Correctamente"
    Catch ex As Exception
        log.Text = ex.Message
    End Try
End Function 
```

结束类

# java - Java L&F 自定义：如何使用 synth 自定义 BorderFactory 边框？

> ID：233491
> 
> 赞同：1
> 
> 时间：2008-10-24T13:16:42.957
> 
> 标签：java, look-and-feel, synth, titled-border, lf

具体来说，我目前有一个带有 TitledBorder 的 JPanel。我想自定义边框的外观。在我的应用程序的当前状态下，绘制的是标题，而不是线条边框本身。

如果我将 imagePainter 绑定到 Panel 对象的 panelBorder 方法，我可以在面板周围放置一个自定义图像——但是它只显示在那些我没有在代码中明确设置边框的面板上。这是该代码的样子：

```
<style id="PanelStyle">
    <state>
        <imagePainter method="panelBorder" path="images/thick border.png" sourceInsets="3 3 3 3" />
    </state>
</style>
<bind style="PanelStyle" type="region" key="Panel" /> 
```

我该如何做相反的事情——也就是说，让这个自定义图像只显示在我应用了 TitledBorder 的面板上？

我也尝试过使用命名面板：

```
panel.setName("MyPanel") 
```

和名称绑定：

```
<bind style="PanelStyle" type="name" key="MyPanel"> 
```

这使我可以仅更改特定面板的样式，这很好。但是，它并没有解决原来的问题：我仍然无法自定义面板的 NamedBorder。

如果我指定 NamedBorder，我的 PanelBorder 画家将被忽略，只打印名称。如果我拿走我的 NamedBorder，我*可以*使用我的自定义边框图形，但是我必须戳我的布局以在标题之前所在的同一位置获得一个 JLabel，这是不可取的。

进一步的研究发现，没有渲染线的原因是 TitledBorder 的构造函数接受了另一个 Border 的参数，除了标题之外它还渲染了该参数。我没有传递这个参数，默认值取决于您选择的 L&F。当我使用系统 L&F 时，默认是 LineBorder。显然 Synth 的默认值是 EmptyBorder。显式指定 LineBorder 可以让我返回线，这解决了我的大部分问题。

我剩下的问题涉及为 LineBorder 使用自定义图形。现在，我通过将我的自定义图形渲染为第二个 PanelBackground 图像来获得——它被合成在实际背景之上并实现了所需的视觉效果，尽管它不是理想的实现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-28T06:51:42.953

哈，找到原因了。来自 TitledBorder.getBorder，如果使用了合成器外观。TitledBorder.border 应该在 xml 文件中定义。

```
public Border getBorder()       {       
    Border b = border;
if (b == null)
    b = UIManager.getBorder("TitledBorder.border");
    return b; 
} 
```

所以我的回答是：

```
<object id="TitledBorder_Color" class="java.awt.Color">
        <int>140</int>

        <int>125</int>

        <int>100</int>

        <int>255</int>
    </object>

    <object id="LineBorder" class="javax.swing.border.LineBorder">
        <object idref="TitledBorder_Color"/>
    </object>

    <defaultsProperty key="TitledBorder.border" type="idref" value="LineBorder"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-10T21:50:50.810

指定要应用特殊样式的组件的名称，而不是区域：

```
<bind style="PanelStyle" type="name" key="mySpecialPanel" /> 
```

在您的 Java 代码中，您需要设置组件的名称以匹配您在 XML 中提供的名称：

```
panel.setName("mySpecialPanel"); 
```

您可以考虑扩展 JPanel 以便所有面板具有相同的名称：

```
public class MySpecialPanel extends JPanel 
{    
   public MySpecialPanel(String title) 
   {
       super(title);
       this.setName("mySpecialPanel");    
   } 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-13T09:51:45.537

我们遇到了同样的问题。当然，您的解决方法（您在上面描述的）有效，但它不是解决方案。

我们使用的解决方法是：

代替：

```
BorderFactory.createTitledBorder("title"); 
```

你应该使用：

```
Border objBorder = BorderFactory.createLineBorder(Color.black); 
//Also you can create all the rest of the borders here.
BorderFactory.createTitledBorder(objBorder, "title"); 
```

# c# - 它在 ASP.NET 代码后面使用多种语言的页面可以接受吗？

> ID：233501
> 
> 赞同：2
> 
> 时间：2008-10-24T13:19:38.490
> 
> 标签：c#, asp.net, vb.net

就本问题而言，代码库是一个 ASP.NET 网站，其中包含多个用 C# 和 Visual Basic .NET 编写的页面。主要语言是 C# 和 Visual Basic .NET 网页，因为需要相同的功能，所以在项目中分叉。

是否应该花时间实际重写这些页面，包括再次经历测试和调试周期，还是认为可以接受？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-24T14:24:29.937

您应该记住三点：

1.  如果它没有损坏，请不要修复它。
2.  团队构成和能力
3.  编码标准和统一性

首先，就像许多人所说的那样，如果它没有损坏，那为什么还要努力更改代码库。您可能会在语言转换期间添加错误，即使它们都是在 ASP.Net 中运行的 .Net 语言。

其次，我将假设分叉项目并使用 VB.Net 而不是继续使用 C# 是有正当理由的。这种语言变化背后的原因是什么？这些理由不再有效吗？考虑导致分叉成不同语言的假设的有效性。

第三，所有团队成员都精通C#吗？如果有几个团队成员不精通 C#，那么将所有代码迁移到 C# 可能是一种负担。

最后，我建议采用编码标准，并从此时起将所有新开发集中在一种语言中。除了这些标准，您可能会考虑一项策略，即如果您需要修改/修复 VB.Net 页面，则该页面应迁移到 C#。

此时 VB.Net 页面不再“未损坏”，您很可能必须通过调试/测试阶段来验证修复/更改。因此，您将迁移成本添加到任何错误修复中。通过这种方式，您可以将代码缓慢迁移到 C#，而不会产生大量的一次性成本。

如果您不愿意迁移页面以及 VB.Net 页面中的任何错误修复或更改，请注意这一点。您很可能没有时间或资源来迁移所有 VB.Net 页面。由于大规模迁移将需要更多时间，并且明智地要求您在迁移过程中停止 VB.Net 页面上的所有工作/修复。这可能表明迁移到 C# 是否是根据您的业务需求的一个选项。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-24T13:23:54.830

您的建议是部分重写。

如果现有代码的功能或架构存在严重错误，我只能主张重写。

IMO 偏爱 C# 而不是 VB。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-24T13:23:08.653

您可能不想这样做。在这种情况下，可维护性将非常困难，因为团队通常拥有单一语言的专业知识。

我们在这里有使用 C# 为某些页面编写的项目和 VB.Net 为其他页面编写的项目。建立团队来维护这些项目是很困难的。

亲切的问候，阿希什

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-24T14:07:46.380

要回答第一个问题，是的，这是完全可以接受的，并且得到 Microsoft 的支持。

你应该改变它吗？如果您的开发人员了解项目情况，那么我认为您还可以，但是如果您开始看到无法处理 VB 的 namspace、引用或开发团队的问题（不太可能）。然后我会考虑重写。

但是，如果代码在那里并且可以工作，那么通常很难证明重写是合理的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-27T13:04:19.977

它得到了很好的支持。

对于页面，它没有区别。每个页面都是单独编译的。

对于 App_Code 目录中的代码，它是按文件夹编译的。所以 C# 文件和 VB.NET 文件需要放在各自独立的子文件夹中。这些子文件夹需要在 web.config 的编译部分中注明，以便编译器知道以不同方式对待它们。

```
<configuration>
<system.web>
    <compilation>
        <codeSubDirectories>
            <add directoryName="VB_Code"/>
            <add directoryName="CS_Code"/>
        </codeSubDirectories>
    </compilation>
</system.web> 
```

这是一个不错的链接。 [在 App_Code 文件夹中使用 VB.NET 和 C#](http://pietschsoft.com/post/2006/03/ASPNET-20-Use-VBNET-and-C-within-the-App_Code-folder.aspx)

我发现的唯一缺点是 Intellisense 似乎在两个 App_Code 子文件夹之间不起作用。虽然在页面中智能感知工作正常。

# java - 将 dpi 元数据写入 Java 中的 jpeg 图像

> ID：233504
> 
> 赞同：15
> 
> 时间：2008-10-24T13:20:09.957
> 
> 标签：java, metadata, jpeg, dpi, javax.imageio

我正在尝试以编程方式在 Java 中设置 jpeg 图像的 dpi 元数据。图像的来源是扫描仪，所以我从 TWAIN 获得水平/垂直分辨率以及图像原始数据。我想保存此信息以获得更好的打印效果。

这是我到目前为止的代码。它将原始图像 (byteArray) 保存到 JPEG 文件中，但它忽略了我通过 IIOMetadata 指定的 X/Y 密度信息。任何建议我做错了什么？

任何其他解决方案（第三方库等）也将受到欢迎。

```
import java.awt.image.BufferedImage;
import java.awt.image.WritableRaster;
import java.io.File;

import javax.imageio.IIOImage;
import javax.imageio.ImageIO;
import javax.imageio.ImageTypeSpecifier;
import javax.imageio.metadata.IIOMetadata;
import javax.imageio.plugins.jpeg.JPEGImageWriteParam;
import javax.imageio.stream.ImageOutputStream    

import org.w3c.dom.Element;    
import com.sun.imageio.plugins.jpeg.JPEGImageWriter;

public boolean saveJpeg(int[] byteArray, int width, int height, int dpi, String file)
{
    BufferedImage bufferedImage = new BufferedImage(width, height, BufferedImage.TYPE_INT_RGB);

    WritableRaster wr = bufferedImage.getRaster();
    wr.setPixels(0, 0, width, height, byteArray);

    try
    {           
        // Image writer 
        JPEGImageWriter imageWriter = (JPEGImageWriter) ImageIO.getImageWritersBySuffix("jpeg").next();
        ImageOutputStream ios = ImageIO.createImageOutputStream(new File(file));
        imageWriter.setOutput(ios);

        // Compression
        JPEGImageWriteParam jpegParams = (JPEGImageWriteParam) imageWriter.getDefaultWriteParam();
        jpegParams.setCompressionMode(JPEGImageWriteParam.MODE_EXPLICIT);
        jpegParams.setCompressionQuality(0.85f);

        // Metadata (dpi)
        IIOMetadata data = imageWriter.getDefaultImageMetadata(new ImageTypeSpecifier(bufferedImage), jpegParams);
        Element tree = (Element)data.getAsTree("javax_imageio_jpeg_image_1.0");
        Element jfif = (Element)tree.getElementsByTagName("app0JFIF").item(0);
        jfif.setAttribute("Xdensity", Integer.toString(dpi));
        jfif.setAttribute("Ydensity", Integer.toString(dpi));
        jfif.setAttribute("resUnits", "1"); // density is dots per inch         

        // Write and clean up
        imageWriter.write(data, new IIOImage(bufferedImage, null, null), jpegParams);
        ios.close();
        imageWriter.dispose();
    }
    catch (Exception e)
    {
       return false;
    }

    return true;
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-08-14T09:22:01.057

这里没有考虑的一些问题：

1.  树没有直接映射到 IOMetaData。要应用树中的数据，请在设置密度和栅格参数后添加以下调用：

    ```
    data.setFromTree("javax_imageio_jpeg_image_1.0", tree); 
    ```

2.  不要将元数据用作 write 调用中的第一个参数。见`JPEGImageWriter#write(IIOMetaData, IIOImage, ImageWriteParam)`。如果 streamMetaData 不为 NULL，则会生成警告 (WARNING_STREAM_METADATA_IGNORED)。

3.  将元数据设置`IOMetadata`为`IOImage`. 这些元数据由 JPEGImageWriter 使用。那么正确的写调用是

    ```
    imageWriter.write(null, new IIOImage(F_scaledImg, null, data), jpegParams); 
    ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-24T15:58:41.867

我觉得这可能是一个错误。

我[从几个谷歌搜索中找到了这篇文章](http://www.velocityreviews.com/forums/t360709-imageio-iiometadatasetfromtree-cripples-data.html)

显然还有更多指向错误的地方。

上面的帖子谈到了使用 JMagick 作为第三方解决方法。

# http - 如何使用 BASIC 身份验证从网站注销用户？

> ID：233507
> 
> 赞同：319
> 
> 时间：2008-10-24T13:21:35.007
> 
> 标签：http, authentication, basic-authentication

如果他使用基本身份验证，是否可以从网站注销用户？

杀死会话是不够的，因为一旦用户通过身份验证，每个请求都包含登录信息，因此用户下次使用相同的凭据访问站点时会自动登录。

到目前为止唯一的解决方案是关闭浏览器，但从可用性的角度来看这是不可接受的。

* * *

## 回答 #1

> 赞同：218
> 
> 时间：2013-10-08T21:28:29.980

让用户单击指向[https://log:out@example.com/](https://log:out@example.com/)的链接。这将用无效的凭据覆盖现有凭据；将它们注销。

* * *

## 回答 #2

> 赞同：203
> 
> 时间：2009-01-29T18:56:08.247

bobince的答案的补充......

使用 Ajax，您可以将“注销”链接/按钮连接到 Javascript 函数。让此函数使用错误的用户名和密码发送 XMLHttpRequest。这应该会返回 401。然后将 document.location 设置回登录前页面。这样，用户在注销期间将永远不会看到额外的登录对话框，也不必记住输入错误的凭据。

* * *

## 回答 #3

> 赞同：181
> 
> 时间：2008-10-24T13:33:36.497

基本身份验证并非旨在管理注销。你可以做到，但不能完全自动。

您需要做的是让用户单击注销链接，并发送“401 Unauthorized”作为响应，使用与您发送请求登录的普通 401 相同的领域和相同的 URL 文件夹级别。

接下来必须指示他们输入错误的凭据，例如。一个空白的用户名和密码，作为响应，您会发回“您已成功注销”页面。然后，错误/空白凭据将覆盖以前的正确凭据。

简而言之，注销脚本反转了登录脚本的逻辑，仅在用户*未*传递正确凭据时才返回成功页面。

问题是有点好奇的“不要输入密码”密码框是否会满足用户的接受。尝试自动填充密码的密码管理器也可能在此处妨碍您。

编辑添加以响应评论：重新登录是一个稍微不同的问题（除非您显然需要两步注销/登录）。您必须拒绝（401）第一次访问重新登录链接的尝试，而不是接受第二次（可能具有不同的用户名/密码）。有几种方法可以做到这一点。一种方法是在注销链接中包含当前用户名（例如 /relogin?username），并在凭据与用户名匹配时拒绝。

* * *

## 回答 #4

> 赞同：76
> 
> 时间：2013-01-15T01:46:20.850

您可以完全在 JavaScript 中完成：

IE （长期以来）有用于清除基本身份验证缓存的标准 API：

```
document.execCommand("ClearAuthenticationCache") 
```

工作时应该返回 true。在其他浏览器上返回 false、未定义或爆炸。

新浏览器（截至 2012 年 12 月：Chrome、FireFox、Safari）具有“神奇”行为。如果他们看到一个*成功*的基本身份验证请求，其中包含任何伪造的其他用户名（比如说`logout`），他们会清除凭据缓存，并可能将其设置为新的伪造用户名，您需要确保该用户名不是查看内容的有效用户名。

基本示例是：

```
var p = window.location.protocol + '//'
// current location must return 200 OK for this GET
window.location = window.location.href.replace(p, p + 'logout:password@') 
```

执行上述操作的“异步”方式是使用`logout`用户名进行 AJAX 调用。例子：

```
(function(safeLocation){
    var outcome, u, m = "You should be logged out now.";
    // IE has a simple solution for it - API:
    try { outcome = document.execCommand("ClearAuthenticationCache") }catch(e){}
    // Other browsers need a larger solution - AJAX call with special user name - 'logout'.
    if (!outcome) {
        // Let's create an xmlhttp object
        outcome = (function(x){
            if (x) {
                // the reason we use "random" value for password is 
                // that browsers cache requests. changing
                // password effectively behaves like cache-busing.
                x.open("HEAD", safeLocation || location.href, true, "logout", (new Date()).getTime().toString())
                x.send("")
                // x.abort()
                return 1 // this is **speculative** "We are done." 
            } else {
                return
            }
        })(window.XMLHttpRequest ? new window.XMLHttpRequest() : ( window.ActiveXObject ? new ActiveXObject("Microsoft.XMLHTTP") : u ))
    }
    if (!outcome) {
        m = "Your browser is too old or too weird to support log out functionality. Close all windows and restart the browser."
    }
    alert(m)
    // return !!outcome
})(/*if present URI does not return 200 OK for GET, set some other 200 OK location here*/) 
```

您也可以将其设为书签：

```
javascript:(function (c) {
  var a, b = "You should be logged out now.";
  try {
    a = document.execCommand("ClearAuthenticationCache")
  } catch (d) {
  }
  a || ((a = window.XMLHttpRequest ? new window.XMLHttpRequest : window.ActiveXObject ? new ActiveXObject("Microsoft.XMLHTTP") : void 0) ? (a.open("HEAD", c || location.href, !0, "logout", (new Date).getTime().toString()), a.send(""), a = 1) : a = void 0);
  a || (b = "Your browser is too old or too weird to support log out functionality. Close all windows and restart the browser.");
  alert(b)
})(/*pass safeLocation here if you need*/); 
```

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2015-09-01T07:24:57.410

确认以下功能适用于 Firefox 40、Chrome 44、Opera 31 和 IE
[11。Bowser](https://github.com/ded/bowser)用于浏览器检测，也使用 jQuery。

- secUrl 是登录密码保护区域的 URL。
- redirUrl 是非密码保护区域（注销成功页面）的 url。
- 您可能希望增加重定向计时器（当前为 200 毫秒）。

```
function logout(secUrl, redirUrl) {
    if (bowser.msie) {
        document.execCommand('ClearAuthenticationCache', 'false');
    } else if (bowser.gecko) {
        $.ajax({
            async: false,
            url: secUrl,
            type: 'GET',
            username: 'logout'
        });
    } else if (bowser.webkit) {
        var xmlhttp = new XMLHttpRequest();
        xmlhttp.open("GET", secUrl, true);
        xmlhttp.setRequestHeader("Authorization", "Basic logout");
        xmlhttp.send();
    } else {
        alert("Logging out automatically is unsupported for " + bowser.name
            + "\nYou must close the browser to log out.");
    }
    setTimeout(function () {
        window.location.href = redirUrl;
    }, 200);
}
```

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2014-06-10T12:35:08.780

这是一个使用 jQuery 的非常简单的 Javascript 示例：

```
function logout(to_url) {
    var out = window.location.href.replace(/:\/\//, '://log:out@');

    jQuery.get(out).error(function() {
        window.location = to_url;
    });
} 
```

此注销用户而没有再次向他显示浏览器登录框，然后将他重定向到已*注销的*页面

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2008-10-24T13:30:40.450

基本身份验证无法直接实现这一点。

HTTP 规范中没有让服务器告诉浏览器停止发送用户已经提供的凭据的机制。

有“黑客”（参见其他答案）通常涉及使用 XMLHttpRequest 发送带有不正确凭据的 HTTP 请求以覆盖最初提供的凭据。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2015-02-18T18:59:17.237

其实很简单。

只需在浏览器中访问以下内容并使用错误的凭据： [http://username:password@yourdomain.com](http://username:password@yourdomain.com)

那应该“让你退出”。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2019-09-15T11:14:51.017

只是为了记录，有一个新的 HTTP 响应标头称为`Clear-Site-Data`. 如果您的服务器回复包含`Clear-Site-Data: "cookies"`标头，则应删除身份验证凭据（不仅是 cookie）。我在 Chrome 77 上对其进行了测试，但控制台上显示了此警告：

```
Clear-Site-Data header on 'https://localhost:9443/clear': Cleared data types:
"cookies". Clearing channel IDs and HTTP authentication cache is currently not
supported, as it breaks active network connections. 
```

并且身份验证凭据没有被删除，因此（目前）这不适用于实现基本身份验证注销，但将来可能会。没有在其他浏览器上测试。

参考：

[https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Clear-Site-Data](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Clear-Site-Data)

[https://www.w3.org/TR/clear-site-data/](https://www.w3.org/TR/clear-site-data/)

[https://github.com/w3c/webappsec-clear-site-data](https://github.com/w3c/webappsec-clear-site-data)

[https://caniuse.com/#feat=mdn-http_headers_clear-site-data_cookies](https://caniuse.com/#feat=mdn-http_headers_clear-site-data_cookies)

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2013-05-20T08:52:50.180

这适用于 IE/Netscape/Chrome ：

```
 function ClearAuthentication(LogOffPage) 
  {
     var IsInternetExplorer = false;    

     try
     {
         var agt=navigator.userAgent.toLowerCase();
         if (agt.indexOf("msie") != -1) { IsInternetExplorer = true; }
     }
     catch(e)
     {
         IsInternetExplorer = false;    
     };

     if (IsInternetExplorer) 
     {
        // Logoff Internet Explorer
        document.execCommand("ClearAuthenticationCache");
        window.location = LogOffPage;
     }
     else 
     {
        // Logoff every other browsers
    $.ajax({
         username: 'unknown',
         password: 'WrongPassword',
             url: './cgi-bin/PrimoCgi',
         type: 'GET',
         beforeSend: function(xhr)
                 {
            xhr.setRequestHeader("Authorization", "Basic AAAAAAAAAAAAAAAAAAA=");
         },

                 error: function(err)
                 {
                    window.location = LogOffPage;
             }
    });
     }
  }

  $(document).ready(function () 
  {
      $('#Btn1').click(function () 
      {
         // Call Clear Authentication 
         ClearAuthentication("force_logout.html"); 
      });
  }); 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2015-12-12T14:12:34.980

您只需要在某个注销 URL 上重定向用户并`401 Unauthorized`在其上返回错误。在错误页面（必须无需基本身份验证即可访问）上，您需要提供指向主页的完整链接（包括方案和主机名）。用户将单击此链接，浏览器将再次要求提供凭据。

Nginx 的示例：

```
location /logout {
    return 401;
}

error_page 401 /errors/401.html;

location /errors {
    auth_basic off;
    ssi        on;
    ssi_types  text/html;
    alias /home/user/errors;
} 
```

错误页面`/home/user/errors/401.html`：

```
<!DOCTYPE html>
<p>You're not authorised. <a href="<!--# echo var="scheme" -->://<!--# echo var="host" -->/">Login</a>.</p> 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2019-12-20T01:35:11.223

我刚刚在 Chrome (79)、Firefox (71) 和 Edge (44) 中测试了以下内容，它运行良好。它像上面提到的其他人一样应用脚本解决方案。

只需添加一个“注销”链接，点击后返回以下 html

```
 <div>You have been logged out. Redirecting to home...</div>    

<script>
    var XHR = new XMLHttpRequest();
    XHR.open("GET", "/Home/MyProtectedPage", true, "no user", "no password");
    XHR.send();

    setTimeout(function () {
        window.location.href = "/";
    }, 3000);
</script> 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2015-09-18T13:29:40.060

将此添加到您的应用程序中：

```
@app.route('/logout')
def logout():
    return ('Logout', 401, {'WWW-Authenticate': 'Basic realm="Login required"'}) 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2015-02-06T15:37:43.253

```
function logout() {
  var userAgent = navigator.userAgent.toLowerCase();

  if (userAgent.indexOf("msie") != -1) {
    document.execCommand("ClearAuthenticationCache", false);
  }

  xhr_objectCarte = null;

  if(window.XMLHttpRequest)
    xhr_object = new XMLHttpRequest();
  else if(window.ActiveXObject)
    xhr_object = new ActiveXObject("Microsoft.XMLHTTP");
  else
    alert ("Your browser doesn't support XMLHTTPREQUEST");

  xhr_object.open ('GET', 'http://yourserver.com/rep/index.php', false, 'username', 'password');
  xhr_object.send ("");
  xhr_object = null;

  document.location = 'http://yourserver.com'; 
  return false;
} 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2015-03-13T16:50:32.707

```
 function logout(url){
    var str = url.replace("http://", "http://" + new Date().getTime() + "@");
    var xmlhttp;
    if (window.XMLHttpRequest) xmlhttp=new XMLHttpRequest();
    else xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    xmlhttp.onreadystatechange=function()
    {
        if (xmlhttp.readyState==4) location.reload();
    }
    xmlhttp.open("GET",str,true);
    xmlhttp.setRequestHeader("Authorization","Basic xxxxxxxxxx")
    xmlhttp.send();
    return false;
} 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2017-03-02T15:45:30.377

根据我上面阅读的内容，我得到了一个适用于任何浏览器的简单解决方案：

1）在您的注销页面上，您将 ajax 调用到您的登录后端。您的登录后端必须接受注销用户。一旦后端接受，浏览器清除当前用户并假定“注销”用户。

```
$.ajax({
    async: false,
    url: 'http://your_login_backend',
    type: 'GET',
    username: 'logout'
});      

setTimeout(function () {
    window.location.href = 'http://normal_index';
}, 200); 
```

2) 现在当用户回到正常的索引文件时，它将尝试使用用户“注销”自动进入系统，第二次你必须通过回复 401 来阻止它以调用登录/密码对话框。

3）有很多方法可以做到这一点，我创建了两个登录后端，一个接受注销用户，一个不接受。我的正常登录页面使用不接受的页面，我的注销页面使用接受的页面。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2020-02-28T11:06:36.660

除了 Mac 上的 Safari 之外，发送`https://invalid_login@hostname`在任何地方都可以正常工作（好吧，没有检查 Edge，但也应该在那里工作）。

当用户在 HTTP 基本身份验证弹出窗口中选择“记住密码”时，注销在 Safari 中不起作用。在这种情况下，密码存储在 Keychain Access 中（Finder > Applications > Utilities > Keychain Access（或 CMD+SPACE 并键入“Keychain Access”））。发送`https://invalid_login@hostname`不会影响钥匙串访问，因此使用此复选框无法在 Mac 上的 Safari 上注销。至少它对我来说是这样的。

MacOS Mojave (10.14.6)、Safari 12.1.2。

下面的代码在 Firefox (73)、Chrome (80) 和 Safari (12) 中运行良好。当用户导航到注销页面时，将执行代码并删除凭据。

```
 //It should return 401, necessary for Safari only
    const logoutUrl = 'https://example.com/logout'; 
    const xmlHttp = new XMLHttpRequest();
    xmlHttp.open('POST', logoutUrl, true, 'logout');
    xmlHttp.send(); 
```

同样出于某种原因，即使选择了“记住密码”，Safari 也不会在 HTTP 基本身份验证弹出窗口中保存凭据。其他浏览器正确执行此操作。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-10-24T13:24:46.217

*   使用会话 ID (cookie)
*   使服务器上的会话 ID 无效
*   不接受会话 ID 无效的用户

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2015-07-21T05:16:23.443

此 JavaScript 必须适用于所有最新版本的浏览器：

```
//Detect Browser
var isOpera = !!window.opera || navigator.userAgent.indexOf(' OPR/') >= 0;
    // Opera 8.0+ (UA detection to detect Blink/v8-powered Opera)
var isFirefox = typeof InstallTrigger !== 'undefined';   // Firefox 1.0+
var isSafari = Object.prototype.toString.call(window.HTMLElement).indexOf('Constructor') > 0;
    // At least Safari 3+: "[object HTMLElementConstructor]"
var isChrome = !!window.chrome && !isOpera;              // Chrome 1+
var isIE = /*@cc_on!@*/false || !!document.documentMode; // At least IE6
var Host = window.location.host;

//Clear Basic Realm Authentication
if(isIE){
//IE
    document.execCommand("ClearAuthenticationCache");
    window.location = '/';
}
else if(isSafari)
{//Safari. but this works mostly on all browser except chrome
    (function(safeLocation){
        var outcome, u, m = "You should be logged out now.";
        // IE has a simple solution for it - API:
        try { outcome = document.execCommand("ClearAuthenticationCache") }catch(e){}
        // Other browsers need a larger solution - AJAX call with special user name - 'logout'.
        if (!outcome) {
            // Let's create an xmlhttp object
            outcome = (function(x){
                if (x) {
                    // the reason we use "random" value for password is 
                    // that browsers cache requests. changing
                    // password effectively behaves like cache-busing.
                    x.open("HEAD", safeLocation || location.href, true, "logout", (new Date()).getTime().toString())
                    x.send("");
                    // x.abort()
                    return 1 // this is **speculative** "We are done." 
                } else {
                    return
                }
            })(window.XMLHttpRequest ? new window.XMLHttpRequest() : ( window.ActiveXObject ? new ActiveXObject("Microsoft.XMLHTTP") : u )) 
        }
        if (!outcome) {
            m = "Your browser is too old or too weird to support log out functionality. Close all windows and restart the browser."
        }
        alert(m);
        window.location = '/';
        // return !!outcome
    })(/*if present URI does not return 200 OK for GET, set some other 200 OK location here*/)
}
else{
//Firefox,Chrome
    window.location = 'http://log:out@'+Host+'/';
} 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2019-04-16T09:37:30.373

在地址栏和 chrome 中键入`chrome://restart`，其所有在后台运行的应用程序将重新启动，并且 Auth 密码缓存将被清除。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2017-05-15T23:15:31.033

我为现代 Chrome 版本更新了 mthoring 的解决方案：

```
function logout(secUrl, redirUrl) {
    if (bowser.msie) {
        document.execCommand('ClearAuthenticationCache', 'false');
    } else if (bowser.gecko) {
        $.ajax({
            async: false,
            url: secUrl,
            type: 'GET',
            username: 'logout'
        });
    } else if (bowser.webkit || bowser.chrome) {
        var xmlhttp = new XMLHttpRequest();
        xmlhttp.open(\"GET\", secUrl, true);
        xmlhttp.setRequestHeader(\"Authorization\", \"Basic logout\");\
        xmlhttp.send();
    } else {
// http://stackoverflow.com/questions/5957822/how-to-clear-basic-authentication-details-in-chrome
        redirUrl = url.replace('http://', 'http://' + new Date().getTime() + '@');
    }
    setTimeout(function () {
        window.location.href = redirUrl;
    }, 200);
} 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-03-16T02:11:25.490

正如其他人所说，我们需要获取**相同的 URL**并发送错误（例如，401：StatusUnauthorized 之类的），仅此而已。

我使用 Get 方法让它知道我需要注销，

这是使用[golang](https://golang.org/)编写的完整示例。

```
package main

import (
    "crypto/subtle"
    "fmt"
    "log"
    "net/http"
)

func BasicAuth(username, password, realm string, handlerFunc http.HandlerFunc) http.HandlerFunc {

    return func(w http.ResponseWriter, r *http.Request) {
        queryMap := r.URL.Query()
        if _, ok := queryMap["logout"]; ok { // localhost:8080/public/?logout
            w.WriteHeader(http.StatusUnauthorized) // 401
            _, _ = w.Write([]byte("Success logout!\n"))
            return
        }

        user, pass, ok := r.BasicAuth()

        if !ok ||
            subtle.ConstantTimeCompare([]byte(user), []byte(username)) != 1 ||
            subtle.ConstantTimeCompare([]byte(pass), []byte(password)) != 1 {
            // https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/WWW-Authenticate
            w.Header().Set("WWW-Authenticate", `Basic realm="`+realm+`", charset="UTF-8"`)
            w.WriteHeader(http.StatusUnauthorized)
            _, _ = w.Write([]byte("Unauthorised.\n"))
            return
        }

        handlerFunc(w, r)
    }
}

type UserInfo struct {
    name string
    psw  string
}

func main() {

    portNumber := "8080"
    guest := UserInfo{"guest", "123"}

    // localhost:8080/public/  -> ./public/everyone
    publicHandler := http.StripPrefix(
        "/public/", http.FileServer(http.Dir("./public/everyone")),
    )

    publicHandlerFunc := func(w http.ResponseWriter, r *http.Request) {
        switch r.Method {
        case http.MethodGet:
            publicHandler.ServeHTTP(w, r)
        /*
            case http.MethodPost:
            case http.MethodPut:
            case http.MethodDelete:
        */
        default:
            return
        }
    }

    http.HandleFunc("/public/",
        BasicAuth(guest.name, guest.psw, "Please enter your username and password for this site",
            publicHandlerFunc),
    )

    log.Fatal(http.ListenAndServe(fmt.Sprintf(":%s", portNumber), nil))
} 
```

当您已经注销时，您需要*刷新*(F5) 页面。否则，您可能会看到旧内容。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2022-02-28T09:02:53.423

实际上，我认为基本身份验证旨在用于静态页面，而不是用于任何复杂的会话管理或 CGI 页面。

因此，当需要会话管理时，您应该设计一个经典的“登录表单”来查询用户和密码（也许也是第二个因素）。CGI 表单处理程序应该将成功的身份验证转换为在服务器上和（在 cookie 中或作为 URI 的一部分）记住的*会话(ID)。*

然后可以简单地通过使服务器（和客户端）“忘记”会话来实现注销。另一个优点是（即使是加密的）用户和密码*不会*随每个请求一起发送到服务器（而是会发送会话 ID）。

如果服务器上的会话 ID 与执行的“最后操作”的时间戳相结合，则可以通过将该时间戳与当前时间进行比较来实现会话超时：如果时间跨度太大，则通过忘记“超时”会话会话 ID。

对无效会话的任何请求都会导致重定向到登录页面（或者，如果您想让它更舒适，您也可以使用“重新验证表单”再次请求密码）。

作为概念证明，我实现了一个完全基于 URI 的完全无 cookie 的会话管理（会话 ID 始终是 URI 的一部分）。然而，完整的代码对于这个答案来说太长了。

当想要处理数千个并发会话时，必须特别注意性能。

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2017-01-09T10:29:46.377

```
 ```
 function logout(secUrl, redirUrl) {
        if (bowser.msie) {
            document.execCommand('ClearAuthenticationCache', 'false');
        } else if (bowser.gecko) {
            $.ajax({
                async: false,
                url: secUrl,
                type: 'GET',
                username: 'logout'
            });
        } else if (bowser.webkit) {
            var xmlhttp = new XMLHttpRequest();
            xmlhttp.open("GET", secUrl, true);
            xmlhttp.setRequestHeader("Authorization", "Basic logout");
            xmlhttp.send();
        } else {
            alert("Logging out automatically is unsupported for " + bowser.name
                + "\nYou must close the browser to log out.");
        }
        setTimeout(function () {
            window.location.href = redirUrl;
        }, 200);
    }
``` 
```

我尝试通过以下方式使用上述内容。

```
?php
    ob_start();
    session_start();
    require_once 'dbconnect.php';

    // if session is not set this will redirect to login page
    if( !isset($_SESSION['user']) ) {
        header("Location: index.php");
        exit;
    }
    // select loggedin users detail
    $res=mysql_query("SELECT * FROM users WHERE userId=".$_SESSION['user']);
    $userRow=mysql_fetch_array($res);
?>
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Welcome - <?php echo $userRow['userEmail']; ?></title>
<link rel="stylesheet" href="assets/css/bootstrap.min.css" type="text/css"  />
<link rel="stylesheet" href="style.css" type="text/css" />

    <script src="assets/js/bowser.min.js"></script>
<script>
//function logout(secUrl, redirUrl)
//bowser = require('bowser');
function logout(secUrl, redirUrl) {
alert(redirUrl);
    if (bowser.msie) {
        document.execCommand('ClearAuthenticationCache', 'false');
    } else if (bowser.gecko) {
        $.ajax({
            async: false,
            url: secUrl,
            type: 'GET',
            username: 'logout'
        });
    } else if (bowser.webkit) {
        var xmlhttp = new XMLHttpRequest();
        xmlhttp.open("GET", secUrl, true);
        xmlhttp.setRequestHeader("Authorization", "Basic logout");
        xmlhttp.send();
    } else {
        alert("Logging out automatically is unsupported for " + bowser.name
            + "\nYou must close the browser to log out.");
    }
    window.location.assign(redirUrl);
    /*setTimeout(function () {
        window.location.href = redirUrl;
    }, 200);*/
}

function f1()
    {
       alert("f1 called");
       //form validation that recalls the page showing with supplied inputs.    
    }
</script>
</head>
<body>

    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="http://www.codingcage.com">Coding Cage</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="http://www.codingcage.com/2015/01/user-registration-and-login-script-using-php-mysql.html">Back to Article</a></li>
            <li><a href="http://www.codingcage.com/search/label/jQuery">jQuery</a></li>
            <li><a href="http://www.codingcage.com/search/label/PHP">PHP</a></li>
          </ul>
          <ul class="nav navbar-nav navbar-right">

            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
              <span class="glyphicon glyphicon-user"></span>&nbsp;Hi' <?php echo $userRow['userEmail']; ?>&nbsp;<span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="logout.php?logout"><span class="glyphicon glyphicon-log-out"></span>&nbsp;Sign Out</a></li>
              </ul>
            </li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav> 

    <div id="wrapper">

    <div class="container">

        <div class="page-header">
        <h3>Coding Cage - Programming Blog</h3>
        </div>

        <div class="row">
        <div class="col-lg-12" id="div_logout">
        <h1 onclick="logout(window.location.href, 'www.espncricinfo.com')">MichaelA1S1! Click here to see log out functionality upon click inside div</h1>
        </div>
        </div>

    </div>

    </div>

    <script src="assets/jquery-1.11.3-jquery.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>

</body>
</html>
<?php ob_end_flush(); ?> 
```

但它只会将您重定向到新位置。没有注销。

# visual-studio-2008 - 禁用断点消失，不再有红点？

> ID：233511
> 
> 赞同：3
> 
> 时间：2008-10-24T13:23:58.373
> 
> 标签：visual-studio-2008, debugging

在以前版本的 VS 中，如果您右键单击断点的红点并选择禁用断点，该点将变为“空心”，再次单击它将重新启用它。但在 VS2008 中，禁用断点会完全移除红点，您需要进入断点窗口重新启用。

任何人都知道如何获得以前版本的行为？我有几个经常切换的 BP，以这种方式进行操作有点像 PITA。我不明白为什么 MS 把它拿走了。

编辑：我昨天安装了 SP1 - 因为没有它，一旦我尝试 CTRL+F，VS 就会崩溃。很好的测试，微软！同样的问题发生在 SP 之前。

我没有触及默认配色方案，检查它表明它应该是一个空心点。我尝试更改它无济于事。事实上，我什至无法更改启用断点的颜色。

这是一台 Windows XP 64 位机器。我猜这是问题的根源。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T01:49:58.283

看起来像 VS 2008 SP1 中的一个错误。

[https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=366060](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=366060)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T13:29:11.013

这对我来说就像你描述的那样有效，但只适用于实际代码会受到影响的特定位置，比如在方法体内部。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T14:11:38.807

远射，但是您使用的是自定义配色方案吗？为禁用断点选择的颜色是否有可能有效地“隐藏”它？（例如黑底黑字）

工具-->选项-->环境-->字体/颜色-->断点（禁用）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-18T09:36:28.983

这是 Visual Studio 2008 SP1 的一个错误。有一个可用的修复：

[http://code.msdn.microsoft.com/KB957912](http://code.msdn.microsoft.com/KB957912)

相关的支持页面在这里：

[http://support.microsoft.com/kb/957912](http://support.microsoft.com/kb/957912)

原始错误报告在这里：

[https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=366060](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=366060)

只需点击第一个链接，然后单击下载。那里有一个下载修复程序的链接。它现在在我的机器上运行良好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-18T11:28:10.097

热修复 KB957912 有助于解决此问题，但不幸的是，下载链接：[http](http://code.msdn.microsoft.com/KB957912) ://code.msdn.microsoft.com/KB957912已失效。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-24T13:29:09.687

我有 VS2008 SP1，它具有您描述的“禁用断点”功能……您是否安装了 SP1？也许这是一个错误？

# sql-server - SQL 用户只能运行 proc，但该 proc 可以做任何事情

> ID：233525
> 
> 赞同：2
> 
> 时间：2008-10-24T13:29:24.460
> 
> 标签：sql-server, stored-procedures, permissions

在 SQL Server 2005 中，我希望名为 LimitedUser 的用户只能运行一个过程：GRANT EXEC ON [usp_RunETL] TO [LimitedUser]

但是，该过程需要能够做所有事情——更新、删除、插入、执行……一切。如何在不必将所有这些权限授予 LimitedUser 的情况下做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T13:33:53.297

LimitedUser 只需要运行存储过程的权限。他们不需要任何其他权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T14:29:54.900

您只需要将 GRANT EXEC 授予受限用户。只要用户对存储过程具有权限，它就会忽略/覆盖过程内部操作的权限。

不过，我会非常小心，这听起来像是一个巨大的潜在安全漏洞。通常，您会使用多个过程来灵活地根据需要调整权限。我建议将权限分配给过程或基础表和视图，而不是决定只有一个*超级*过程。

# javascript - 如何使用今天的日期预先填充 jQuery Datepicker 文本框？

> ID：233553
> 
> 赞同：242
> 
> 时间：2008-10-24T13:33:42.220
> 
> 标签：javascript, jquery, jquery-ui, date, jquery-ui-datepicker

我有一个非常简单的 jQuery Datepicker 日历：

```
$(document).ready(function(){
    $("#date_pretty").datepicker({ 
    });
}); 
```

当然在 HTML 中...

```
<input type="text" size="10" value="" id="date_pretty"/> 
```

当用户调出日历时，今天的日期会很好地突出显示，但是如何让 jQuery 在页面加载时使用今天的日期预先填充文本框本身，而无需用户做任何事情？99% 的情况下，今天的默认日期将是他们想要的。

* * *

## 回答 #1

> 赞同：574
> 
> 时间：2010-02-24T11:38:05.590

**更新：有报道称这不再适用于 Chrome。**

这很简洁并且可以完成工作（已过时）：

```
$(".date-pick").datepicker('setDate', new Date()); 
```

这不太简洁，利用[链接](https://www.w3schools.com/jquery/jquery_chaining.asp)允许它在 chrome 中工作（2019-06-04）：

```
$(".date-pick").datepicker().datepicker('setDate', new Date()); 
```

* * *

## 回答 #2

> 赞同：227
> 
> 时间：2012-01-20T17:16:08.410

您必须首先调用 datepicker() >**然后**使用 'setDate' 来获取当前日期。

```
$(".date-pick").datepicker();
$(".date-pick").datepicker("setDate", new Date()); 
```

或在您的日期选择器初始化之后链接您的 setDate 方法调用，如对此答案的评论中所述

```
$('.date-pick').datepicker({ /* optional option parameters... */ })
               .datepicker("setDate", new Date()); 
```

它**不适**用于

```
$(".date-pick").datepicker("setDate", new Date()); 
```

***注意***：*[此处](http://api.jqueryui.com/datepicker/#method-setDate)**描述了可接受的 setDate 参数*

* * *

## 回答 #3

> 赞同：72
> 
> 时间：2008-10-24T14:04:47.230

```
var myDate = new Date();
var prettyDate =(myDate.getMonth()+1) + '/' + myDate.getDate() + '/' +
        myDate.getFullYear();
$("#date_pretty").val(prettyDate); 
```

似乎工作，但可能有更好的方法在那里..

* * *

## 回答 #4

> 赞同：59
> 
> 时间：2012-08-05T19:23:05.157

该[`setDate()`](http://api.jqueryui.com/datepicker/#method-setDate)方法设置日期并更新关联的控件。方法如下：

```
$("#datepicker1").datepicker({
    dateFormat: "yy-mm-dd"
}).datepicker("setDate", "0"); 
```

[**演示**](http://jsfiddle.net/salman/ZBFFJ/)

如文档中所述，`setDate()`愉快地接受 JavaScript Date 对象、数字或字符串：

> 新日期可以是 Date 对象或当前日期格式的字符串（例如 '01/26/2009'）、从今天开始的天数（例如 +7）或一串值和句点（'y' 表示年，'m' 表示月，'w' 表示周，'d' 表示天，例如 '+1m +7d'），或 null 以清除所选日期。

如果您想知道，[`defaultDate`](http://api.jqueryui.com/datepicker/#option-defaultDate)在构造函数中设置属性*不会*更新关联的控件。

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2012-06-23T18:38:34.433

设置为***今天***：

```
$('#date_pretty').datepicker('setDate', '+0'); 
```

设置为***昨天***：

```
$('#date_pretty').datepicker('setDate', '-1'); 
```

以此类推，在*今天 date****之前***或***之后*** 的任意天数。

 *请参阅[jQuery UI › 方法 › setDate](http://jqueryui.com/demos/datepicker/#methods)。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-10-24T14:25:17.717

解决方案是：

```
$(document).ready(function(){
    $("#date_pretty").datepicker({ 
    });
    var myDate = new Date();
    var month = myDate.getMonth() + 1;
    var prettyDate = month + '/' + myDate.getDate() + '/' + myDate.getFullYear();
    $("#date_pretty").val(prettyDate);
}); 
```

谢谢灰鬼！

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2013-04-08T03:44:07.847

这个对我有用。

```
$('#inputName')
  .datepicker()
  .datepicker('setDate', new Date()); 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2010-08-18T18:58:28.480

此代码将确保使用您的 datepicker 格式：

```
$('#date-selector').datepicker('setDate', new Date()); 
```

无需重新应用格式，它使用您在日期选择器初始化时预定义的日期选择器（如果您已分配它！）；）

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2012-10-23T23:37:28.790

David K Egghead 的代码运行良好，谢谢！

```
$(".date-pick").datepicker(); 
$(".date-pick").datepicker("setDate", new Date()); 
```

我还设法对其进行了一些修剪，并且它也有效：

```
$(".date-pick").datepicker().datepicker("setDate", new Date()); 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2011-02-16T08:16:30.027

```
$('input[name*="date"]').datepicker({
        dateFormat: 'dd-mm-yy',
        changeMonth: true,
        changeYear: true,
        beforeShow: function(input, instance) { 
            $(input).datepicker('setDate', new Date());
        }
    }); 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-07-10T22:52:16.880

为了在加载时将日期选择器设置为某个默认时间（在我的情况下为当前日期），然后可以选择另一个日期，语法为：

```
 $(function() { 
        // initialize the datapicker
        $("#date").datepicker();

        // set the time
        var currentDate = new Date();
        $("#date").datepicker("setDate",currentDate);

    //  set the options for the button  
        $("#date").datepicker("option",{
            dateFormat: 'dd/mm',
            showOn: "button",
          // whatever option Or event you want 
        });
  }); 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2015-09-03T12:45:43.243

你有两个选择：

**选项 A)** 在您的日历中标记为“活动”，仅当您单击输入时。

**JS**：

```
$('input.datepicker').datepicker(
                        {   
                            changeMonth: false,
                            changeYear: false,
                            beforeShow: function(input, instance) { 
                                $(input).datepicker('setDate', new Date());
                            }
                        }                         
                     ); 
```

**CSS**：

```
div.ui-datepicker table.ui-datepicker-calendar .ui-state-active,
        div.ui-datepicker table.ui-datepicker-calendar .ui-widget-content .ui-state-active  {
            background: #1ABC9C;
            border-radius: 50%;
            color: #fff;
            cursor: pointer;
            display: inline-block;
            width: 24px; height: 24px;
        }​ 
```

**选项 B)**默认输入今天。您必须首先填充 datepicker 。

```
$("input.datepicker").datepicker().datepicker("setDate", new Date());
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-01-08T14:25:21.643

只是想我会加两分钱。选择器正在添加/更新表单上使用，因此如果编辑现有记录，则需要显示来自数据库的日期，否则需要显示今天的日期。下面对我来说很好：

```
 $( "#datepicker" ).datepicker();
    <?php if (!empty($oneEVENT['start_ts'])): ?>
       $( "#datepicker" ).datepicker( "setDate", "<?php echo $startDATE; ?>" );
    <? else: ?>
       $("#datepicker").datepicker('setDate', new Date());   
    <?php endif; ?>
  }); 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-07-05T10:58:02.987

要预填充日期，首先必须初始化 datepicker，然后传递 setDate 参数值。

```
$("#date_pretty").datepicker().datepicker("setDate", new Date()); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-01-17T15:24:56.290

```
var prettyDate = $.datepicker.formatDate('dd-M-yy', new Date());
alert(prettyDate); 
```

将 prettyDate 分配给必要的控件。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-02-26T15:08:44.883

试试这个

```
$(this).datepicker("destroy").datepicker({
            changeMonth: false, changeYear: false,defaultDate:new Date(), dateFormat: "dd-mm-yy",  showOn: "focus", yearRange: "-5:+10"
        }).focus(); 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-03-22T13:35:55.290

`.datepicker('setDate', new Date());`这对我来说效果更好，因为如果我已经为日期选择器配置了参数，有时我会遇到麻烦，因为它会造成混乱。

```
$("#myDateText").val(moment(new Date()).format('DD/MM/YYYY')); 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-10-15T11:49:25.317

用这个：

`$(".datepicker").datepicker({ dateFormat: 'dd-M-yy' }).datepicker('setDate', new Date());`

以格式获取日期，例如：2019 年 10 月 10 日，这对用户来说更容易理解。

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2008-12-29T15:23:54.803

```
$(function()
{
$('.date-pick').datePicker().val(new Date().asString()).trigger('change');
}); 
```

来源：[http ://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/datePickerDefaultToday.html](http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/datePickerDefaultToday.html)

# delphi - 将现有的 Delphi 应用程序国际化（至少是多语言）最省力的技术是什么？

> ID：233560
> 
> 赞同：4
> 
> 时间：2008-10-24T13:36:44.663
> 
> 标签：delphi, localization, multilingual, capability

我已经开发了大约 300 个应用程序，我想为它们提供独立于操作系统的多语言功能。我已经编写了一个即时翻译器，但是在具有许多组件的应用程序中这太慢了。你会建议我做什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-24T13:48:44.360

我们正在使用[TsiLang](http://www.sicomponents.com/tsilang1.html)并且对它非常满意。

最好的一点是您可以使用字典（从现有翻译中填充）预翻译项目。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-24T13:56:09.540

我听说[TsiLang 组件](http://www.tsilang.com/?siteid2=1)很好，但是您正在寻找就地解决方案...

我已经[为 Delphi 使用了 GNU gettext，](http://dxgettext.po.dk/)它完全符合您的要求，它从文本文件加载翻译并替换组件中的文本。它甚至有一个 pas/dfm 扫描仪来自动生成英文翻译文件。

也可以自动更改您的 pascal 源代码以注入 gettext 过程来代替您的静态字符串。如果我没记错的话，它只是添加了一个下划线作为函数，如下所示。

```
ShowMessage('Hello'); // before
ShowMessage(_('Hello')); // after 
```

我必须说自从我上次使用这种方法已经 2 年了。

有一件事仍然存在问题，Delphi 组件没有启用 unicode（D2009 修复了这个问题），所以当您不更改组件时，您对其他语言的支持仍然有限。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-24T13:56:39.943

一个好的免费解决方案是[GNU gettext for Delphi](http://dybdahl.dk/dxgettext/)。它有一些 TsiLang 不具备的功能 - 例如，您可以将有关如何计算事物（一、二、四、百零二、许多...的不同结尾）的知识放入翻译文件中，这样您就不会’不必教每个程序都知道这些东西。

Delphi 部分的许可证非常宽松，但我不确定包含的 GNU 内容会对您的应用程序产生多大影响。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-28T12:34:50.643

获取[Multilizer](http://www.multilizer.com/)。它是用 Delphi 制作的，它可以处理 Delphi 程序，特别支持 VCL。您甚至可以轻松地为每种语言重做屏幕。使用 Multilizer，您可以使用不同的技术来翻译和运行您的程序。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-29T01:33:37.110

Delphi 2009 添加了集成翻译环境/外部翻译管理器 ITE 和 ETM 现在可用于 Delphi 和 C++Builder。

在 Codegear 的文章：[What's New in Delphi and C++Builder 2009](http://dn.codegear.com/article/38869)中，他们指出：

> 集成翻译环境 (ITE) 是简化项目本地化的 IDE 的一部分。ITE 可以从现有项目创建新的本地化项目。ITE 不会自动翻译文本，但会提供一个对话框，列出所有需要本地化的文本以及输入相应翻译文本的字段。输入翻译文本并构建本地化项目后，您可以设置另一种语言活动并在本地化文本中显示表单；您不必切换语言环境并重新启动系统。这使您无需本地化系统即可执行本地化。
> 
> 外部翻译管理器 (ETM) 是一个独立的应用程序，可处理源代码中的 DFM 文件和文本字符串。尽管 ETM 不允许您创建新的本地化项目，但它确实提供了一个对话框，列出了本地化文本和翻译的文本，类似于 ITE。

这是我计划在我想要将我的产品国际化时首先尝试的。

然而，对我来说，最简单的部分是翻译程序。困难的部分是翻译帮助文件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-29T21:19:49.343

我会说[GNU gettext for Delphi](http://dybdahl.dk/dxgettext/)结合[TMS Unicode 组件包](http://www.tmssoftware.com/site/tmsuni.asp)（以前在 TntWare 下免费）以获得组件中的 unicode 支持。

要使用或让翻译人员使用 gettext 文件，我建议查看可以编辑 .po 文件的免费跨平台[Poedit 。](http://www.poedit.net/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-11-08T17:28:42.570

如果您拥有 DexExpress 组件，只需提及[cxLocalizer 。](http://www.devexpress.com/Products/VCL/ExQuantumGrid/key_localization.xml)

# oracle - 如何在 oracle 文本索引中添加权重？

> ID：233564
> 
> 赞同：1
> 
> 时间：2008-10-24T13:38:41.837
> 
> 标签：oracle, indexing, full-text-search

我在一个表上创建了一个多列数据存储，它允许我对表进行全文索引。我需要做的是对每一列进行不同的加权并将分数加在一起。

以下查询有效，但速度很慢：

```
SELECT document.*, Score(1) + 2*Score(2) as Score
FROM document
WHERE (CONTAINS(documentContent, 'the_keyword', 1) > 0
OR CONTAINS(documentTitle, 'the_keyword', 2) > 0 )
ORDER BY Score DESC 
```

经过相当多的谷歌搜索，人们提出了解决方案：

```
SELECT document.*, Score(1) as Score
FROM document
WHERE CONTAINS(dummy, '(((the_keyword) within documentTitle))*2 OR ((the_keyword) within documentText)',1) > 0)
ORDER BY Score Desc 
```

上面的查询比它的前任更快，但它并没有解决实际问题。在这种情况下，如果在 documentTitle 中找到关键字，则不会搜索 documentText（它使用 OR 运算符）。我真正需要的是把这两个分数加在一起，这样如果一个关键字出现在标题和文本中，它的分数就会比它只出现在标题中的分数高。

那么，如何在一个 CONTAINS 子句中添加加权列的分数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T14:13:50.613

使用 ACCUM 代替 OR 运算符：

SELECT document.*, Score(1) as Score FROM document WHERE CONTAINS(dummy, '(((the_keyword) within documentTitle))*2 **ACCUM** ((the_keyword) within documentText)',1) > 0) ORDER BY Score Desc

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T14:28:36.213

如果您进行嵌套选择怎么办？

```
select *, Score(1) + 2 * Score(2) as Score
from (
    SELECT document.*, Score(1) as Score
    FROM document
    WHERE CONTAINS(dummy, '(((the_keyword) within documentTitle))
        OR ((the_keyword) within documentText)',1) > 0)
)
ORDER BY Score Desc 
```

# wcf - 大型 WCF 服务的最佳实践？

> ID：233571
> 
> 赞同：39
> 
> 时间：2008-10-24T13:40:52.677
> 
> 标签：wcf

编写包含大量 OperationContract 和 DataContract 的相当大的 wcf 服务的最佳实践是什么？

我如何将功能区域分成几个合同，最好为每个功能区域创建一个端点？

有没有办法将不同部分的来源分开，但仍然只为所有这些部分使用一项服务？

我在哪里可以获得关于如何计划合同、包括什么、如何拆分...的好信息？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-24T13:45:06.660

自服务成立以来，这一直是围绕服务的一个大问题。SOA 成功完成是您所说的 SOA 计划。话虽如此，我一直更倾向于将服务拆分，但以复合方式使用它们。也就是说，当您有多个合同时，有多个端点，但其中大多数仅由非服务调用者使用的少数端点使用。（哇，那是一口，它甚至有意义吗？）

另外，我建议尽可能少地签订合同。太多的合同会导致可管理性差。良好的合约设计将有助于限制端点和服务调用的数量。从合同设计中删除 OO 概念是这样做的一种方法。合同设计本身就是一个庞大的话题，但可以说，通过良好的合同计划（预先），良好的服务设计就足够了。

Maarten Mullender[写了一篇](http://blogs.msdn.com/maarten_mullender/)关于 WCF 设计的精彩博客，值得一读。也出现了一些很棒的 SOA/WCF 书籍。

一些好书：

*   [Pro WCF：实用的 Microsoft SOA 实施](http://www.amazon.com/s/ref=nb_ss_b?url=search-alias%3Dstripbooks&field-keywords=wcf&x=0&y=0)
*   [编程 WCF](https://rads.stackoverflow.com/amzn/click/com/0596526997)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-24T14:20:03.143

这对我很有帮助，它来自 idesign.net 网站，由 Juval Lowy 撰写：

[WCF 编码标准](http://idesign.net/Downloads/GetDownload/1987 "WCF 编码标准")

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-24T14:32:14.333

我将在这里偏离轨道，说我使用了整体 WCF 合同、功能分离的合同（在他的书中 Juval 的指导方针中最多有十种方法），并且我还尝试了一个消息处理架构，其中服务具有一个接受基本消息的方法，以及“知道”如何在消息通过网络后解包和处理消息的处理程序。

如果你在栅栏的两边都有.NET，我是后者的忠实粉丝。Oren 用代码对这个想法进行了截屏。我不知道您的需求是什么，但这对我有用。

[http://ayende.com/Blog/archive/2008/03/30/Hibernating-Rhinos-8--Going-Distributed-amp-Building-our-own.aspx](http://ayende.com/Blog/archive/2008/03/30/Hibernating-Rhinos-8--Going-Distributed-amp-Building-our-own.aspx)

也就是说，如果您已经来自“我需要大型 WCF 服务”，那么采用一种方法可能不会为您解决问题。如果这是真的，那么 Juval Lowy 的 Programming WCF Services 是您在设计中应该坚持的标准。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-24T15:25:07.567

我在这里有一篇关于单个操作应如何不同于传统代码操作的帖子：

[http://www.iserviceoriented.com/blog/post/Introduction+to+Service+Oriented+Architecture.aspx](http://www.iserviceoriented.com/blog/post/Introduction+to+Service+Oriented+Architecture.aspx)

您最终应该只针对实际业务事件进行操作。如果您停下来想“我需要在我的 Web 服务上启用事务支持”，这意味着您还没有设计足够广泛的操作。您永远不必启用 Web 服务事务支持。

我强烈推荐 Bill Poole 的博客以了解更高级别的 SOA 概念。这是一个开始的帖子：

[http://feeds.feedburner.com/~r/BillPoolesCreativeAbrasion/~3/328955489/service-contract-stability.html](http://feeds.feedburner.com/~r/BillPoolesCreativeAbrasion/~3/328955489/service-contract-stability.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-09T13:39:19.010

我知道这是一篇旧文章，但我对服务的思考方式与我对编程中的对象的思考方式相同。

让他们在他们必须做的事情上保持最低限度。当然不会走极端，但我是根据数据实体做出决定的。

一项服务用于帐户，一项用于产品等。

虽然不知道有人会怎么想……

# java - Java 7 中的闭包

> ID：233579
> 
> 赞同：29
> 
> 时间：2008-10-24T13:44:24.180
> 
> 标签：java, syntax, closures, java-7

我听说闭包可能会在计划于明年夏天左右发布的下一个 Java 标准中引入。

这种语法会是什么样子？

我在某处读到，在 java 中引入闭包比在 java 5 中的泛型变化更大。这是真的吗？优点和缺点？

（到目前为止，我们肯定知道闭包不会包含在下一个 Java 版本中）

或者

**编辑：[http](http://puredanger.com/tech/2009/11/18/closures-after-all/) ://puredanger.com/tech/2009/11/18/closures-after-all/ ：D**

**编辑2：重新思考JDK7：http: [//blogs.oracle.com/mr/entry/rethinking_jdk7](http://blogs.oracle.com/mr/entry/rethinking_jdk7)**

**编辑3：没有一刻可以失去！： http: [//blogs.oracle.com/mr/entry/quartet](http://blogs.oracle.com/mr/entry/quartet)**

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-24T13:49:35.293

看看[http://www.javac.info/](http://www.javac.info/)。

看起来是这样的：

```
boolean even = { int x => x % 2 == 0 }.invoke(15); 
```

位`{ int x => x % 2 == 0 }`是闭包。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-24T13:50:08.507

这真的取决于引入了什么，以及*是否*会引入。有许多不同规模的关闭提案。

有关建议和各种博客文章，请参阅[Alex Miller 的 Java 7 页面](http://tech.puredanger.com/java7#closures)。

就我个人而言，我很想看到关闭——它们很[漂亮，而且非常有用](http://csharpindepth.com/Articles/Chapter5/Closures.aspx)——但我担心其中一些建议是相当多毛的。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-04T23:25:40.223

在 2009 年 11 月，这个问题发生了令人惊讶的大转弯，现在Java 7[中将添加闭包。](http://java.dzone.com/news/closures-coming-java-7)

## 更新

Java 7 中的闭包（AKA lambdas 表达式）没有发生。它们*最终*在 2014 年被添加到 Java 8 的第一个版本中。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-09-12T07:34:08.513

不幸的是，您不会在 Java 7 中找到闭包。如果您正在寻找更轻的解决方案来在 Java 中使用闭包，请查看 lambdaj 项目：

[http://code.google.com/p/lambdaj/](http://code.google.com/p/lambdaj/)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-24T13:54:48.793

这是 java 7 的特性[http://tech.puredanger.com/java7/#switch](http://tech.puredanger.com/java7/#switch)的例子非常有用。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-24T15:21:53.737

请注意，“函数类型”实际上是提案下的类型：

```
{int => boolean} evaluateInt;    //declare variable of "function" type
evaluateInt = {int x => x % 2 }; //assignment 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-24T17:54:33.473

我认为关于最终将使用什么语法仍然存在很多争论。如果由于所有这些原因，它确实进入了 Java 7，我实际上会感到非常惊讶。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-05-10T23:19:21.783

如果没有任何类型的推断，闭包将会非常冗长...... :(

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-08T20:08:21.000

闭包有一些严重的边缘情况。我会说闭包是比泛型更重要的变化，而后者仍然有一些毛茸茸的边缘情况。例如，Java Collections 库不能在没有警告的情况下编写/编译。

# java - 可以使用 Eclipse 查找所有已弃用的方法调用吗？

> ID：233593
> 
> 赞同：32
> 
> 时间：2008-10-24T13:48:59.523
> 
> 标签：java, eclipse, ide

Eclipse 是否具有允许您搜索项目以查找对已弃用方法的所有调用的功能？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-10-24T13:51:47.927

您可以将编译器设置为针对已弃用 API 的任何使用生成错误或警告（您的选择）。

> 首选项 -> Java -> 编译器 -> 错误/警告 ->*已弃用和受限的 API*部分。

然后，每次使用已弃用的方法或 API 都会在“问题”视图中显示为错误/警告。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2017-02-27T23:35:14.713

*[八年后更新，对于当前版本的 Eclipse，带有屏幕截图。]*

**首先，构建您的项目。**构建项目后，Problems 视图默认包含弃用。您可以将所有弃用组合在一起。

**要显示问题视图，请**使用*Window>Show View>Problems*。

**如果在下一步之后没有出现弃用，您可以在***Java>Compiler>Errors/Warnings*下的 Preferences 中配置它们。

**使用问题视图菜单将**弃用组合在一起。**首先单击下面圈出的控件。**

 **[![按 Java 问题类型分组的菜单](https://i.stack.imgur.com/hIu5k.png)](https://i.stack.imgur.com/hIu5k.png)

完成后，打开“弃用”子树。例如：

[![在此处输入图像描述](https://i.stack.imgur.com/avN90.png)](https://i.stack.imgur.com/avN90.png)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-25T22:20:45.160

您始终可以使用“搜索 -> 文件”下的 grep 工具。`@deprecated`选中“考虑派生资源”选项框后，Eclipse 可以进行递归搜索。

# c# - 在 C# 中强制垃圾回收的最佳实践

> ID：233596
> 
> 赞同：120
> 
> 时间：2008-10-24T13:49:43.640
> 
> 标签：c#, .net, garbage-collection

根据我的经验，似乎大多数人会告诉您强制垃圾回收是不明智的，但在某些情况下，您正在处理大型对象，这些对象并不总是在 0 代中被回收，但内存是一个问题，是可以强制收集吗？是否有这样做的最佳实践？

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2008-10-24T14:01:08.920

最佳做法是不强制进行垃圾收集。

根据 MSDN：

> “可以通过调用 Collect 来强制进行垃圾收集，但大多数情况下，应该避免这样做，因为它可能会产生性能问题。”

但是，如果您可以可靠地测试您的代码以确认调用 Collect() 不会产生负面影响，那么请继续......

只需尝试确保在您不再需要对象时将其清理干净。如果您有自定义对象，请查看使用“使用语句”和 IDisposable 接口。

这个链接有一些关于释放内存/垃圾收集等很好的实用建议：

[http://msdn.microsoft.com/en-us/library/66x5fx1b.aspx](http://msdn.microsoft.com/en-us/library/66x5fx1b.aspx)

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2008-11-02T02:33:02.007

这么看——厨房垃圾是在垃圾桶10%的时候扔掉，还是先装满再拿出来？

不让它填满，你就是在浪费时间往返外面的垃圾箱。这类似于 GC 线程运行时发生的情况——所有托管线程在运行时都被挂起。如果我没记错的话，GC 线程可以在多个 AppDomain 之间共享，因此垃圾收集会影响所有这些。

当然，您可能会遇到一种情况，即您不会在短时间内向垃圾桶添加任何东西 - 例如，如果您要休假。那么，出门前把垃圾扔掉是个好主意。

这可能是强制 GC 可以提供帮助的一次 - 如果您的程序空闲，则正在使用的内存不会被垃圾收集，因为没有分配。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2009-09-24T15:32:23.337

**最佳做法是在大多数情况下不强制进行垃圾收集。** （我工作过的每个系统都强制进行垃圾收集，有强调的问题，如果解决了就不需要强制垃圾收集，并且大大加快了系统的运行速度。）

在某些**情况下**，**您**比垃圾收集器更了解内存使用情况。在多用户应用程序或一次响应多个请求的服务中，这不太可能是真的。

但是，在某些**批处理类型的处理**中，您确实比 GC 了解更多。例如，考虑一个应用程序。

*   在命令行上给出文件名列表
*   处理单个文件，然后将结果写入结果文件。
*   在处理文件时，会创建很多相互关联的对象，直到文件处理完成（例如解析树）才能收集这些对象
*   **在已处理的文件之间不保留太多状态**。

您*可能*能够进行案例（经过仔细的）测试，在处理完每个文件后，您应该强制进行完整的垃圾回收。

另一种情况是每隔几分钟唤醒一次以处理某些项目的服务，并且**在它处于睡眠状态时不保持任何状态**。然后在睡觉前强制收集完整的数据*可能*是值得的。

> 我会考虑强制收集的唯一一次是当我知道最近创建了很多对象并且当前引用的对象很少时。

我宁愿有一个垃圾收集 API，因为我可以给它提示这种类型的事情，而不必强迫我自己进行 GC。

另见“ [Rico Mariani 的表演花絮](http://blogs.msdn.com/ricom/archive/2004/11/29/271829.aspx)”

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2008-11-02T02:51:25.917

[我认为Rico Mariani](http://blogs.msdn.com/ricom/archive/2004/11/29/271829.aspx)给出的例子很好：如果应用程序的状态发生重大变化，触发 GC 可能是合适的。例如，在文档编辑器中，当文档关闭时触发 GC 可能是可以的。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2008-11-06T04:25:23.463

编程中很少有绝对的通用准则。有一半的时候，当有人说“你做错了”时，他们只是在宣扬一定数量的教条。在 C 语言中，它曾经担心诸如自修改代码或线程之类的事情，在 GC 语言中，它正在强制 GC 或阻止 GC 运行。

与大多数指南和良好的经验法则（以及良好的设计实践）一样，在极少数情况下围绕既定规范工作确实有意义。您确实必须非常确定您了解案例，您的案例确实需要废除常规做法，并且您了解可能导致的风险和副作用。但也有这样的情况。

编程问题多种多样，需要灵活的方法。我已经看到了在垃圾收集语言中阻止 GC 有意义的情况以及触发它而不是等待它自然发生的地方是有意义的。95% 的情况下，这两种情况中的任何一种都是没有正确解决问题的标志。但是 20 次中有 1 次，可能有一个有效的案例。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2008-10-24T13:52:54.477

我已经学会了不要试图智取垃圾收集。**`using`**话虽如此，在处理文件 I/O 或数据库连接等非托管资源时，我只是坚持使用关键字。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2012-09-21T08:50:22.657

我最近遇到的一个需要手动调用的情况`GC.Collect()`是，在处理封装在小型托管 C++ 对象中的大型 C++ 对象时，这些对象又可以从 C# 访问。

垃圾收集器从未被调用，因为使用的托管内存量可以忽略不计，但使用的非托管内存量很大。手动调用`Dispose()`对象需要我自己跟踪何时不再需要对象，而调用`GC.Collect()`将清除不再引用的任何对象.....

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2008-10-24T13:53:14.163

不确定这是否是最佳实践，但是当在循环中处理大量图像时（即创建和处理大量 Graphics/Image/Bitmap 对象），我经常让 GC.Collect。

我想我在某处读到 GC 仅在程序（大部分）空闲时运行，而不是在密集循环的中间，所以这看起来像是手动 GC 可能有意义的区域。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2008-10-24T13:54:32.180

我认为您已经列出了最佳实践，除非真的有必要，否则不要使用它。我强烈建议您更详细地查看您的代码，如果需要先回答这些问题，可以使用分析工具。

1.  您的代码中是否有一些东西在比需要的更大范围内声明项目
2.  内存使用率真的太高了吗
3.  比较使用 GC.Collect() 之前和之后的性能，看看它是否真的有帮助。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2008-11-02T02:19:44.840

假设您的程序没有内存泄漏，对象累积并且无法在 Gen 0 中进行 GC，因为：1）它们被长时间引用，因此进入 Gen1 和 Gen2；2）它们是大对象（> 80K），所以进入LOH（大对象堆）。LOH 不像 Gen0、Gen1 和 Gen2 那样进行压缩。

检查“.NET Memory”的性能计数器可以看出1）问题确实不是问题。一般每 10 次 Gen0 GC 会触发 1 次 Gen1 GC，每 10 次 Gen1 GC 会触发 1 次 Gen2 GC。从理论上讲，如果 GC0 上没有压力（如果程序内存使用确实是有线的），则 GC1 和 GC2 永远不会被 GC-ed。它永远不会发生在我身上。

对于问题 2)，您可以检查“.NET Memory”性能计数器来验证 LOH 是否变得臃肿。如果这确实是您的问题，也许您可​​以创建一个大型对象池，因为此博客建议[http://blogs.msdn.com/yunjin/archive/2004/01/27/63642.aspx](http://blogs.msdn.com/yunjin/archive/2004/01/27/63642.aspx)。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2014-03-17T17:03:32.727

我想补充一点：调用 GC.Collect() (+ WaitForPendingFinalizers()) 是故事的一部分。正如其他人正确提到的那样， GC.COllect() 是非确定性收集，由 GC 本身 (CLR) 自行决定。即使您添加了对 WaitForPendingFinalizers 的调用，它也可能不是确定性的。从此 msdn[链接](http://msdn.microsoft.com/en-us/library/system.gc.waitforpendingfinalizers(v=vs.110).aspx)中获取代码，并使用对象循环迭代为 1 或 2 运行代码。您会发现非确定性的含义（在对象的析构函数中设置断点）。准确地说，当 Wait..() 只有 1 个（或 2 个）延迟对象时，不会调用析构函数。 [引用请求]

如果您的代码正在处理非托管资源（例如：外部文件句柄），则必须实现析构函数（或终结器）。

这是一个有趣的例子：

**注意**：如果您已经尝试过来自 MSDN 的上述示例，那么下面的代码将会清除空气。

```
class Program
{    
    static void Main(string[] args)
        {
            SomePublisher publisher = new SomePublisher();

            for (int i = 0; i < 10; i++)
            {
                SomeSubscriber subscriber = new SomeSubscriber(publisher);
                subscriber = null;
            }

            GC.Collect();
            GC.WaitForPendingFinalizers();

            Console.WriteLine(SomeSubscriber.Count.ToString());

            Console.ReadLine();
        }
    }

    public class SomePublisher
    {
        public event EventHandler SomeEvent;
    }

    public class SomeSubscriber
    {
        public static int Count;

        public SomeSubscriber(SomePublisher publisher)
        {
            publisher.SomeEvent += new EventHandler(publisher_SomeEvent);
        }

        ~SomeSubscriber()
        {
            SomeSubscriber.Count++;
        }

        private void publisher_SomeEvent(object sender, EventArgs e)
        {
            // TODO: something
            string stub = "";
        }
    } 
```

我建议，首先分析输出可能是什么，然后运行，然后阅读以下原因：

{只有在程序结束时才会隐式调用析构函数。为了确定性地清理对象，必须实现 IDisposable 并对 Dispose() 进行显式调用。这就是本质！:)

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-10-24T14:24:38.857

大对象是在 LOH（大对象堆）上分配的，而不是在 gen 0 上。如果您说它们不会在 gen 0 上进行垃圾收集，那么您是对的。我相信只有在完整的 GC 周期（第 0、1 和 2 代）发生时才会收集它们。

话虽如此，我相信另一方面，当您处理大型对象并且内存压力上升时，GC 会更积极地调整和收集内存。

是否收集以及在什么情况下收集很难说。我曾经在处理带有大量控件等的对话框窗口/表单后执行 GC.Collect() （因为由于创建了许多业务对象实例/加载了大量数据，表单及其控件最终进入第 2 代 - 不显然是大物体），但实际上并没有注意到长期这样做的任何积极或消极影响。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-11-02T02:24:32.680

还有一件事，显式触发 GC Collect 可能不会提高程序的性能。很可能使情况变得更糟。

.NET GC 经过精心设计和调整以具有自适应性，这意味着它可以根据您程序内存使用的“习惯”调整 GC0/1/2 阈值。因此，它会在运行一段时间后适应您的程序。一旦您显式调用 GC.Collect，阈值将被重置！并且.NET 必须花时间再次适应您的程序的“习惯”。

我的建议是始终信任 .NET GC。出现任何内存问题，请检查“.NET Memory”性能计数器并诊断我自己的代码。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-01-10T00:12:11.790

> > 不确定这是否是最佳实践...

建议：不确定时不要执行此操作或任何操作。在已知事实时重新评估，然后在性能测试之前/之后进行验证。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-11-02T02:39:22.040

> 但是，如果您可以可靠地测试您的代码以确认调用 Collect() 不会产生负面影响，那么请继续......

恕我直言，这类似于说*“如果你能证明你的程序将来永远不会有任何错误，那么继续......”*

严肃地说，强制 GC 对于调试/测试目的很有用。如果你觉得你需要在其他任何时候这样做，那么要么你错了，要么你的程序构建错误。无论哪种方式，解决方案都不会强制GC ...

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2021-08-19T20:56:17.203

我不推荐手动垃圾收集。我向您保证，您没有正确处理大型物体。使用 USING 语句。每当您实例化一个对象时，请务必在使用完它时将其丢弃。此示例代码使用 USING 语句创建连接。然后它实例化一个运输标签对象，使用它，并正确地处理它。

```
 Using con As SqlConnection = New SqlConnection(DB_CONNECTION_STRING)
            con.Open()

            Using command As SqlCommand = New SqlCommand(sqlStr, con)
                Using reader As SqlDataReader = command.ExecuteReader()

                    While reader.Read()
                        code_here()
                    End While
                End Using
            End Using
        End Using
        Dim f1 As frmShippingLabel
        f1 = New frmShippingLabel
        f1.PrintLabel()
        f1.Dispose() 
```

# macos - OS X 文件复制默认转换文本编码

> ID：233621
> 
> 赞同：1
> 
> 时间：2008-10-24T13:54:32.633
> 
> 标签：macos, text, encoding, utf-8

我工作区中的所有 PHP 文件都以**Unicode (UTF-8, no BOM)**编码。我经常复制现有的源文件以用作新脚本的基础。总是（使用路径查找器或原始查找器），OS X 会将重复文件的编码转换为**Western (Mac OS Roman)**。

复制文本文件时，有什么方法可以使 OS X 正常运行而不转换文本编码？或者让它对所有扩展名为 .php 的文件默认使用特定的文本编码（西方除外！）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T18:17:09.933

我非常怀疑您看到的“转换”是文件的两个副本中的实际差异。OS X 不会为文件内容存储任何类型的编码值，因此很可能是您用来查看/编辑文件的任何工具对内容进行了不同的解释，无论是 Xcode、TextWrangler 还是其他任何工具您正在使用的其他编辑器。直接复制文件，无论是从 Finder、路径查找器还是命令行，都不会在复制过程中更改文件中的实际数据。

如果您没有任何高于 0x7f 的字符，UTF-8 和 Mac OS Roman 实际上是相同的，因此没有 BOM 的有效 UTF-8 文件很可能被解释为 Mac OS Roman 文件。无论如何，我会研究向您展示编码以找到解决方案的任何程序，而不是 OS X 本身的文件复制过程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-25T21:37:38.473

请注意，OS X 中确实存在一个扩展属性，用于存储通过`-[NSString writeToFile:...]`或类似工具生成的文本文件的文件编码，这些文件可能不会与文件一起复制。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-25T21:21:28.820

您是使用 Finder 来复制文件，还是使用其他工具（IDE）？

如果您不使用 Finder 进行复制，您的原始文件可能在其 Resource Fork 中有一些扩展的 Finder 元数据，这些元数据在复制过程中会丢失。

-W

# javascript - 从 JSON 使用 Javascript 创建动态关联数组

> ID：233622
> 
> 赞同：2
> 
> 时间：2008-10-24T13:54:33.223
> 
> 标签：javascript, jquery, json

这听起来比实际上要复杂得多。

所以在 Perl 中，你可以这样做：

```
foreach my $var (@vars) {
  $hash_table{$var->{'id'}} = $var->{'data'};
} 
```

我有一个 JSON 对象，我想做同样的事情，但在 jQuery 中有一个 javascript 关联数组。

我尝试了以下方法：

```
hash_table = new Array();

$.each(data.results), function(name, result) {
  hash_table[result.(name).extra_info.a] = result.(name).some_dataset;
}); 
```

其中 data 是从 $.getJSON 调用获得的 JSON 对象。它看起来或多或少是这样的（我的 JSON 语法可能有点不对，抱歉）：

```
{
  results:{
    datasets_a:{
      dataset_one:{
        data:{
          //stuff
        }
        extra_info:{
          //stuff
        }
      }
      dataset_two:{
         ...
      }
      ...
    }
    datasets_b:{
      ...
    }
  }
} 
```

但每次我这样做时，萤火虫都会抛出以下错误：

“XML 过滤器应用于非 xml 数据”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T14:13:37.460

我认为您可以将 JSON 响应用作关联数组。所以你应该可以直接进去使用JSON。

假设你收到了上面的例子：

```
$('result').innerHTML = data['results']['dataset_a']['dataset_two']['data'];
// Or the shorter form:
$('result').innerHTML = data.results.dataset_a.dataset_two.data; 
```

了解我没有对此进行测试，但是将方括号与变量一起使用比使用括号加上带有点访问器的名称更安全。

由于我刚刚发现的一些复杂的逻辑，您的示例失败了。

```
$.each(data.results), function(name, result) {
     hash_table[result.(name).extra_info.a] = result.(name).some_dataset;
}); 
```

现在，foreach 循环遍历变量`data.results`以查找深度为 1 处的内部元素。它找到的项被赋予带有该项的键的 lambda。AKA，第一个结果将是`name = "datasets_a" item = object`. 一直跟着我？现在您访问返回的散列，即 中的对象`item`，就好像它在`name`...“datasets_a”中有子键。但是等等，这**就是**对象！

如果一切都失败了...将结果 JSON 动态写入文本字段并确保其格式正确。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T14:11:53.067

为什么要将一个数组更改为另一个数组？-)

-- 为什么不简单的访问数据，如果要简化或过滤，可以直接遍历对象的数组！-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T14:12:54.467

这行得通。只需将其转储到脚本块中进行测试。

```
 d = {
      'results':{
       'datasets_a':{
          'dataset_one':{
            'data':{
              'sample':'hello'
            },
            'extra_info':{
              //stuff
            }
          },
      'dataset_two':{
            ///
          }
          ///
    },
        'datasets_b':{
         ///
        }
      }
}
alert(d.results.datasets_a.dataset_one.data.sample) 
```

我希望这粘贴正确。这个编辑器不喜欢我在代码中的换行符。

```
d = {
  'results':{
   'datasets_a':{
      'dataset_one':{
        'data':{
          'sample':'hello'
        },
        'extra_info':{
          //stuff
        }
      },
      'dataset_two':{
        ///
      }
      ///
    },
    'datasets_b':{
     ///
    }
  }
};

alert(d.results.datasets_a.dataset_one.data.sample) 
```

# java - 缓存 FreeMarker 模板

> ID：233623
> 
> 赞同：2
> 
> 时间：2008-10-24T13:54:34.050
> 
> 标签：java, spring, caching, templates, freemarker

我正在使用 Spring 类[FreeMarkerConfigurationFactoryBean](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/ui/freemarker/FreeMarkerConfigurationFactoryBean.html)来检索 FreeMarker 模板。我希望缓存这些模板，但似乎没有任何方法表明需要这种行为。

相反，Spring 模块提供了一个[CachingTemplateResolver](https://springmodules.dev.java.net/docs/reference/0.9/html/template.html)，它确实提供了模板缓存，但是否可以不使用 Spring 模块（即使用 FreeMarkerConfigurationFactoryBean）来实现这一点？

干杯，唐

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-24T14:51:22.470

从[Freemarker 手册](http://fmpp.sourceforge.net/freemarker/pgui_config_templateloading.html)中，似乎默认情况下缓存是打开的。

**模板缓存**

FreeMarker 缓存模板（假设您使用 Configuration [Spring MBean 所做的...] 方法来创建模板对象）。这意味着当你调用 getTemplate 时，FreeMarker 不仅返回生成的 Template 对象，而且将它存储在缓存中，所以当你下次使用相同（或等效）路径调用 getTemplate 时，它​​只返回缓存的 Template 实例，并将不再加载和解析模板文件。

# c# - c# Reporting Services -- 不是字符串的 ReportParameter 值

> ID：233632
> 
> 赞同：2
> 
> 时间：2008-10-24T13:58:05.713
> 
> 标签：c#, asp.net, reporting-services, reportparameter

行

我目前正在做一个小项目，报告需要一个 int 但 ReportParameter 类只让我有一个字符串或字符串 [] 的值

我怎样才能传递一个int？

谢谢

担

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T14:08:38.267

您可以调用`GetReportParameters()`将返回`ReportParameter[]`数组的方法。如果您遍历每个参数并查看其 Type 属性，它将指示它是否为`int`. Type 属性是一个`enum`类型`ParameterTypeEnum`，`ParameterTypeEnum.Integer`用于一个`int`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T14:30:25.273

我会尝试：

```
var rp = new ReportParameter("IntValue", intValue.ToString());
report.SetParameters(new ReportParameter[]{rp}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-03T17:30:59.713

仍然没有答案，最终在底层存储过程中进行了转换。

# vb.net - 如何在 Visual Basic 2005 中创建 Windows 防火墙例外？

> ID：233633
> 
> 赞同：1
> 
> 时间：2008-10-24T13:58:33.047
> 
> 标签：vb.net, firewall

有没有办法可以在 VB2005 中创建 Windows 防火墙例外？我正在尝试部署一个打开几个端口的小应用程序，以便我可以连接到它们并使用 VMWare Converter 转换它们。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-24T14:07:43.823

非常类似于这个问题：[Programmatically add an application to Windows Firewall](https://stackoverflow.com/questions/113755/programmatically-add-an-application-to-windows-firewall)

这个问题是针对 C# 的，但由于语言相似，因此技术应该相同。

# sql - 用于 MacOS 的数据库草图？

> ID：233636
> 
> 赞同：1
> 
> 时间：2008-10-24T13:59:29.580
> 
> 标签：sql, database, database-design, ddl

我一直在尝试为 mac os 寻找免费的数据库创建者，但我找不到任何东西。谁知道我可以免费下载的？

编辑：我还需要应用程序生成 sql（在这种情况下为 mysql）：）

泰

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T14:26:51.910

[SQL 设计器](http://ondras.zarovi.cz/sql/demo/)是基于 Web 的。

[这个问题](https://stackoverflow.com/questions/30474/database-schema-diagram-design-tool)还有更多选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T14:33:19.450

我认为[XCode 中的实体建模东西](http://developer.apple.com/documentation/Cocoa/Conceptual/CoreData/Articles/cdBasics.html#//apple_ref/doc/uid/TP40001650)可能是我们给你的......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T10:33:18.237

[SchemaBank](http://schemabank.com/)是另一个可用的基于 Web 的。

# wpf - 用于触摸屏信息亭开发的图形子系统

> ID：233640
> 
> 赞同：3
> 
> 时间：2008-10-24T14:00:02.917
> 
> 标签：wpf, silverlight, user-interface, embedded, kiosk

我正在开始一个爱好项目，我希望在其中有一个图形触摸屏界面，用于与在 Windows XP Embedded 之上运行的类似信息亭的设备进行交互。为了开发丰富的 UI 体验，我正在考虑使用 WPF。但是，我遇到的许多演示视频都使用了 Silverlight，而我还没有看过一个 WPF 演示。

据我了解，Silverlight 面向网站开发人员，而 WPF 更面向桌面开发。

所以这个问题有两个部分。首先，对于在 Windows XP 嵌入式平台上托管的类似信息亭的设备上开发丰富的 UI 体验，推荐的图形子系统是什么？其次，如果是 Silverlight，建议使用哪个版本（1.0 或 2.0），为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T17:16:20.760

似乎 WPF 在嵌入式上运行良好。请参阅[此处](http://blogs.msdn.com/mikehall/archive/2006/07/10/661539.aspx)的第二条评论。

我认为您的选择应该取决于您要构建的 kyosk 类型。一些 kyosk 只是一个打开的浏览器页面。然后你有像 Microsoft Surface 这样可以像水平 kyosk 一样使用的东西 :-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-11T11:45:45.097

我还推荐 WPF，使用它的信息亭应用程序很少。

我还推荐[http://fpscomponents.com/Product.aspx?id=8](http://fpscomponents.com/Product.aspx?id=8)作为虚拟触摸屏键盘软件组件。它是在 WPF 中完成的，非常灵活和可定制。

用户可以自定义键盘的主题（皮肤）、布局和语言。伙计们正在与客户合作并听到他们的声音，因此任何建议都可能被接受。

# cakephp - 在 CakePHP 视图中链接到文件（例如 PDF）

> ID：233643
> 
> 赞同：7
> 
> 时间：2008-10-24T14:00:34.727
> 
> 标签：cakephp

我想在我的一个控制器视图中链接到一些 PDF。实现这一目标的最佳做法是什么？CakePHP webroot 文件夹包含一个 ./files/ 子文件夹，我很困惑地试图链接到它而不在我的 href 中使用“神奇”路径名（例如“/path/to/my/webroot/files/myfile.pdf”）。

我有哪些选择？

**编辑：**我没有充分描述我的问题。`mod_rewrite`我试图以与平台无关（即 no ）的方式链接到 /app/webroot/files/ 中的文件。

我已经通过将这些文件存储在 CakePHP 目录结构之外来解决这个问题。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-27T08:19:07.790

```
$html->link('Pdf', '/files/myfile.pdf'); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-11-03T16:56:58.710

这有点切题，但要访问模型和其他地方的这样一个位置，你可以简单地这样做：

```
$file = WWW_ROOT . DS . 'files' . DS; 
```

这种策略可能对访问文件以加载静态数据（例如 XML 或 JSON）的人有所帮助。

不建议将其用于公共消费或公共链接。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-08-18T14:45:27.083

我可以确认这是未使用 mod_rewrite 时的问题。

```
<?php echo $html->link('pdf', '/files/test.pdf'); ?> 
```

输出

```
<a href="/pathtoapp/index.php/files/test.pdf">pdf</a> 
```

它应该输出

```
<a href="/pathtoapp/app/webroot/files/test.pdf">pdf</a> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-08-28T18:10:08.447

这应该工作

```
<?php echo $html->link('pdf', $this->webroot('files'.DS.'test.pdf'); ?> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-26T14:05:56.843

我不确定我是否正确理解了这个问题，但是这里有。基本上，您放在 webroot 文件夹中的任何文件都可以在网络服务器上访问，因此如果您将文件放在 webroot/files/file.pdf 中，您只需链接到 /files/file.pdf。

如果这不起作用，请澄清您的问题...

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-17T02:44:07.610

或者..

```
<a href="<?php echo $this->webroot; ?>files/somefile.pdf">Link Text</a> 
```

:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-11T09:30:40.333

或者...

```
<a href="<?php echo $html->url('/files/somefile.pdf'); ?>">Link Text</a> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-09-19T03:49:45.617

```
 <a href="<?php echo $this->request->webroot . 'carpetadentrodelwebroot/archivo.pdf'; ?>" target="pdf-frame" download="nombreParaDescarga">Descargar Archivo</a> 
```

# hibernate - btw org.hibernate.jmx.HibernateService 和 org.jboss.hibernate.jmx.Hibernate 的区别

> ID：233649
> 
> 赞同：0
> 
> 时间：2008-10-24T14:01:27.283
> 
> 标签：hibernate, jboss, jndi

他们都是mbean。两者都旨在设置 Hibernate Session Factory 并通过 JNDI 公开它。两者都在 Red Hat 中实现。但同时它们中的每一个都属于不同的类层次结构。

它们之间实际上有什么区别？

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-24T14:13:56.383

*   `org.hibernate.jmx.HibernateService`是核心 Hibernate 的一部分
*   `org.jboss.hibernate.jmx.Hibernate`不是核心的一部分，而是 JBoss 的一部分。这似乎是一件历史性的事情——可能是从 Hibernate 没有 MBean 的时候开始的。它似乎是[由于被删除](https://jira.jboss.org/jira/browse/JBAS-2907)。

# sharepoint - 延迟活动未在 SharePoint 工作流中触发

> ID：233657
> 
> 赞同：2
> 
> 时间：2008-10-24T14:05:14.717
> 
> 标签：sharepoint, workflow

我有一个间隔设置为 1 天的延迟活动。由于某种原因，工作流计时器在时间过去后不会激活工作流。

我已经安装了 SharePoint 基础结构更新，但它没有解决问题。

工作流还设置为侦听项目更改事件，如果我在延迟间隔后更改项目，则会激活延迟。有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T23:58:47.700

我也有过这样的经历，对问题出在哪里感到困惑。对我来说，结果是这样的，它有一个修补程序：

[http://support.microsoft.com/default.aspx?scid=kb;en-us;932394](http://support.microsoft.com/default.aspx?scid=kb;en-us;932394)

我认为这不会包含在 SharePoint 基础结构更新中，因为这是 .NET Framework 和 Windows Workflow Foundation 的问题，而不是专门针对 SharePoint 的问题。

# python - 词法闭包是如何工作的？

> ID：233673
> 
> 赞同：156
> 
> 时间：2008-10-24T14:08:25.053
> 
> 标签：python, closures, lazy-evaluation, late-binding, python-closures

当我在调查 Javascript 代码中的词法闭包问题时，我在 Python 中遇到了这个问题：

```
flist = []

for i in xrange(3):
    def func(x): return x * i
    flist.append(func)

for f in flist:
    print f(2) 
```

请注意，此示例有意避免`lambda`. 它打印“4 4 4”，这令人惊讶。我期待“0 2 4”。

这个等效的 Perl 代码做得对：

```
my @flist = ();

foreach my $i (0 .. 2)
{
    push(@flist, sub {$i * $_[0]});
}

foreach my $f (@flist)
{
    print $f->(2), "\n";
} 
```

打印“0 2 4”。

你能解释一下区别吗？

* * *

更新：

问题**不**在于`i`全球化。这显示相同的行为：

```
flist = []

def outer():
    for i in xrange(3):
        def inner(x): return x * i
        flist.append(inner)

outer()
#~ print i   # commented because it causes an error

for f in flist:
    print f(2) 
```

如注释行所示，`i`当时是未知的。尽管如此，它仍然打印“4 4 4”。

* * *

## 回答 #1

> 赞同：159
> 
> 时间：2008-10-24T14:47:08.953

Python 实际上按照定义的方式运行。**创建了三个单独的函数**，但它们每个都有**定义它们的环境的闭包**- 在这种情况下，全局环境（如果循环放置在另一个函数中，则为外部函数的环境）。然而，这正是问题所在 - 在这种环境中，**i 是 mutated**，并且闭包都**引用相同的 i**。

这是我能想到的最佳解决方案 - 创建一个函数创建器并调用*它*。这将为创建的每个函数强制使用**不同的环境，每个函数中都有****不同的 i**。

```
flist = []

for i in xrange(3):
    def funcC(j):
        def func(x): return x * j
        return func
    flist.append(funcC(i))

for f in flist:
    print f(2) 
```

当您混合副作用和函数式编程时，就会发生这种情况。

* * *

## 回答 #2

> 赞同：157
> 
> 时间：2008-10-25T01:56:42.237

循环中定义的函数在`i`其值发生变化时继续访问相同的变量。在循环结束时，所有函数都指向同一个变量，该变量保存循环中的最后一个值：效果与示例中报告的一样。

为了评估`i`和使用它的值，一种常见的模式是将其设置为参数默认值：在`def`执行语句时评估参数默认值，从而冻结循环变量的值。

以下按预期工作：

```
flist = []

for i in xrange(3):
    def func(x, i=i): # the *value* of i is copied in func() environment
        return x * i
    flist.append(func)

for f in flist:
    print f(2) 
```

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2011-07-24T06:24:40.130

这是使用`functools`库的方法（我不确定在提出问题时是否可用）。

```
from functools import partial

flist = []

def func(i, x): return x * i

for i in xrange(3):
    flist.append(partial(func, i))

for f in flist:
    print f(2) 
```

正如预期的那样，输出 0 2 4。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-10-24T14:36:07.493

看这个：

```
for f in flist:
    print f.func_closure

(<cell at 0x00C980B0: int object at 0x009864B4>,)
(<cell at 0x00C980B0: int object at 0x009864B4>,)
(<cell at 0x00C980B0: int object at 0x009864B4>,) 
```

这意味着它们都指向同一个 i 变量实例，一旦循环结束，其值为 2。

一个可读的解决方案：

```
for i in xrange(3):
        def ffunc(i):
            def func(x): return x * i
            return func
        flist.append(ffunc(i)) 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-10-25T11:28:04.720

正在发生的事情是变量 i 被捕获，并且函数正在返回它在调用时绑定的值。在函数式语言中，这种情况永远不会出现，因为 i 不会反弹。但是，对于 python，以及您在 lisp 中所见，这不再是正确的。

您的方案示例的不同之处在于 do 循环的语义。Scheme 每次通过循环都有效地创建一个新的 i 变量，而不是像其他语言一样重用现有的 i 绑定。如果您使用在循环外部创建的不同变量并对其进行变异，您将在方案中看到相同的行为。尝试将循环替换为：

```
(let ((ii 1)) (
  (do ((i 1 (+ 1 i)))
      ((>= i 4))
    (set! flist 
      (cons (lambda (x) (* ii x)) flist))
    (set! ii i))
)) 
```

看看[here](http://lambda-the-ultimate.org/node/2648)以进一步讨论这个问题。

[编辑] 描述它的更好方法可能是将 do 循环视为执行以下步骤的宏：

1.  定义一个采用单个参数 (i) 的 lambda，其主体由循环主体定义，
2.  使用适当的 i 值作为参数立即调用该 lambda。

IE。相当于下面的python：

```
flist = []

def loop_body(i):      # extract body of the for loop to function
    def func(x): return x*i
    flist.append(func)

map(loop_body, xrange(3))  # for i in xrange(3): body 
```

i 不再是来自父作用域的变量，而是它自己作用域中的一个全新变量（即 lambda 的参数），因此您会得到观察到的行为。Python 没有这个隐式的新作用域，所以 for 循环的主体只共享 i 变量。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-24T14:42:55.607

问题是所有局部函数都绑定到同一个环境，因此绑定到同一个`i`变量。解决方案（解决方法）是为每个函数（或 lambda）创建单独的环境（堆栈帧）：

```
t = [ (lambda x: lambda y : x*y)(x) for x in range(5)]

>>> t[1](2)
2
>>> t[2](2)
4 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-25T07:20:03.847

我仍然不完全相信为什么在某些语言中这是一种方式，而在另一种方式中。在 Common Lisp 中，它就像 Python：

```
(defvar *flist* '())

(dotimes (i 3 t)
  (setf *flist* 
    (cons (lambda (x) (* x i)) *flist*)))

(dolist (f *flist*)  
  (format t "~a~%" (funcall f 2))) 
```

打印“6 6 6”（注意这里的列表是从 1 到 3，并且是反向构建的）。在 Scheme 中它的工作方式与在 Perl 中类似：

```
(define flist '())

(do ((i 1 (+ 1 i)))
    ((>= i 4))
  (set! flist 
    (cons (lambda (x) (* i x)) flist)))

(map 
  (lambda (f)
    (printf "~a~%" (f 2)))
  flist) 
```

打印“6 4 2”

正如我已经提到的，Javascript 属于 Python/CL 阵营。这里似乎有一个实现决定，不同的语言以不同的方式处理。我很想知道这个决定是什么，确切地说。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-24T14:17:35.143

该变量`i`是一个全局变量，每次`f`调用该函数时其值为 2。

我倾向于实现您所追求的行为，如下所示：

```
>>> class f:
...  def __init__(self, multiplier): self.multiplier = multiplier
...  def __call__(self, multiplicand): return self.multiplier*multiplicand
... 
>>> flist = [f(i) for i in range(3)]
>>> [g(2) for g in flist]
[0, 2, 4] 
```

**对您的更新的回应**：导致这种行为的不是`i` *自身*的全局性，而是它是来自封闭范围的变量，在调用 f 时具有固定值。在您的第二个示例中， 的值`i`取自函数的范围`kkk`，当您在 上调用函数时，没有任何改变`flist`。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-07-24T08:20:04.593

行为背后的原因已经解释过，并且已经发布了多个解决方案，但我认为这是最 Pythonic 的（记住，Python 中的一切都是对象！）：

```
flist = []

for i in xrange(3):
    def func(x): return x * func.i
    func.i=i
    flist.append(func)

for f in flist:
    print f(2) 
```

Claudiu 的答案非常好，使用函数生成器，但 piro 的答案是一个 hack，老实说，因为它使 i 成为具有默认值的“隐藏”参数（它可以正常工作，但它不是“pythonic”） .

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-11-18T14:38:00.757

我不喜欢上面的解决方案是如何`wrappers`在循环中创建的。注意：python 3.xx

```
flist = []

def func(i):
    return lambda x: x * i

for i in range(3):
    flist.append(func(i))

for f in flist:
    print f(2) 
```

# c# - 从 web 服务写入文件

> ID：233681
> 
> 赞同：3
> 
> 时间：2008-10-24T14:10:57.497
> 
> 标签：c#, .net, web-services, file-io

我有一个使用 .net c# 的 Web 服务，我想写入服务器上的文本文件，但我无法让它工作。我相信这是一个许可问题。

具体来说，我认为问题在于我正在使用`System.IO.Directory.GetCurrentDirectory()`.

有更好的选择吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-24T14:14:39.300

尝试授予 ASP.NET 用户（或任何运行 IIS 的帐户）写入您尝试写入的文件夹的权限。

如果这是网络共享，请尝试以可以写入共享的域用户身份运行 IIS。

记住授予最小权限的原则（不要使用管理员级别的访问权限）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-09-28T11:59:12.027

如果您没有指定目标文件夹，我假设您的 Web 服务想要写入“C:\Windows\System32\”或类似的东西。这就是为什么会在服务器上抛出 UnauthorizedAccessException 的原因。为了写入 Web 服务的“home”目录，您必须首先找出它在哪里。

以下对我有用，但您也可以[在此处](https://stackoverflow.com/questions/236166/how-do-i-get-the-current-directory-in-a-web-service)找到其他建议。

添加引用 System.Web，并通过调用获取当前目录：

```
strFileDestination = System.Web.Hosting.HostingEnvironment.ApplicationPhysicalPath + strFileName; 
```

请记住在 IIS 中授予您的服务写入权限。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-09T21:56:03.810

Stuart，您可能希望使用 Server.MapPath，而不是使用 System.IO.Directory.GetCurrentDirectory()。您可以为 Server.MapPath 提供相对于您要保存文件的 Web 服务位置的目录，否则您可能需要传递完整的文件路径“C:\Files\file.txt”。至于权限问题，我通常可以通过向 IIS_WPG 和 ASPNET 用户写入文件的文件夹添加写入权限来解决此问题（这些用户名在您的服务器上可能不同）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-24T14:22:33.323

如果您在 Windows 2003 上运行并且*尚未*打开 ASP.NET 模拟，并且在 DefaultAppPool 或配置为以“网络服务”身份运行的应用程序池中运行应用程序，那么您将需要授予“网络服务”帐户对目标文件夹的写入权限。如果您在使用“网络服务”以外的身份的应用程序池中运行该站点，则该帐户可能需要对目标文件夹的写入权限。

如果您运行的是 Windows 2000，则该`'<MACHINENAME>\ASPNET'`帐户将需要对目标文件夹的写入权限。

如果您打开了模拟，那么您需要授予站点的匿名用户帐户对目标文件夹的写入权限。

要检查是否启用了模拟，请打开（假设为 ASP.NET 2.0）然后检查您的 machine.config 文件 (C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\CONFIG) 以查看您是否具有以下设置：

```
<identity impersonate="true"/> 
```

这也可能在您的应用程序的 web.config 中被覆盖。

此外，如果您在部分信任环境中运行，那么您可能只能写入网站的应用程序文件夹，因为默认 FileIOPermission 通常设置为 $AppDir$，即您不能在其他任何地方修改文件，即使使用正确的 NTFS 权限。

如果您正在写入网络共享，那么[StingyJack](https://stackoverflow.com/questions/233681/write-a-file-from-webservices#233698)会为您提供答案，但部分信任环境的考虑仍然适用。

但首先检查您的 NTFS 权限，这可能是最好的选择。

希望这有助于凯夫

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-24T14:16:05.897

您应该能够从 Web 服务写入文件。这很可能是权限或信任问题。如果您处于有限信任（即中等信任）中，请确保您正在写入您的 Web 根目录中或下面的补丁。如果您已经这样做了，或者处于完全信任环境中，请检查以确保该目录具有 IIS 工作进程写入它的权限。

# eclipse - 忽略 Eclipse 工作区的模式

> ID：233682
> 
> 赞同：8
> 
> 时间：2008-10-24T14:11:24.453
> 
> 标签：eclipse, svn, language-agnostic, version-control, development-environment

你有一个很好的 svn、git 等处理 eclipse 工作区的忽略模式吗？我想对工作区中的所有项目进行版本处理。它必须忽略所有 eclipse 配置、编译文件和输出文件夹。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-24T14:18:05.550

您应该能够只忽略顶级工作区目录。你想达到什么目的？

基本上，在工作区上方的目录中，执行以下操作：

```
svn propset svn:ignore "<your_workspace_dir>" . 
```

由于您想要忽略项目中更具体的资源，因此您需要这样的东西（您可以使用 svn prop_edit_ svn:ignore 设置它`<project_dir>`）：

```
.project
.classpath
.settings
bin 
```

在标准 Eclipse JDT 项目（具有单独的源代码和构建树）中，将排除它输出的内容。当然，对于 CDT 项目、ruby 等，这会略有不同。YMMV 等等。

我的一般做法是手动版本化我需要版本化的所有内容，然后排除剩下的所有内容。通配符对于忽略是*危险的；*他们可以很容易地让你不注意到一些关键的事情，所以要谨慎行事，只忽略最低限度的事情。

# asp.net - 如何：在 ASP.NET 网络表单中进行跨站点发布和重定向

> ID：233691
> 
> 赞同：1
> 
> 时间：2008-10-24T14:13:16.587
> 
> 标签：asp.net, asp.net-2.0, cross-server

**设想：**

我手头的任务是在不同组织/网站之间启用单点登录解决方案。我从一个组织网站上的经过身份验证的用户开始，将特定信息转换为 Xml 文档，使用三重 des 加密文档，然后将其作为 post 变量发送到第二个组织的登录页面。

**问题：**

一旦我打包了我的 xml 数据，我如何以编程方式向第二个网站发布帖子并将用户的浏览器也重定向到第二个网站。

这应该表现得就像具有如下形式：

*action="http://www.www.com/posthere" 方法="post"*

...并有一个隐藏的文本字段，例如：

*输入类型=“隐藏”值=“我的加密xml”*

这是用 asp.net 2.0 webforms 编写的。

--

**编辑：** Nic 询问为什么我上面描述的 html 表单不起作用。答：我无法控制任何一个站点；我正在建立使这一切发生的“中间人”。站点 1 将用户转发到我正在制作的页面，我必须构建 XML，然后将其转发到站点 2。站点 1 不希望用户知道我的站点，重定向应该是透明的。

我上面描述的过程是双方（站点 A 和站点 B）要求的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T18:55:48.483

发回一个包含带有隐藏输入的 from 的文档，并包含一个 onload 处理程序，该处理程序将表单立即发布到另一个站点。使用 jquery 的 document.ready() 解决了在 post 发生之前是否加载 DOM 的问题，尽管没有 jquery 也有其他方法可以做到这一点。您可能希望在屏幕上包含一些小消息，大意是用户将很快被重定向，并提供一个链接，该链接也可以发布

```
...headers left out...

<script type='text/javascript'>

$(document).ready( function() {
   $('form:first').submit();
 });
</script>

<body>
   <form action='othersiteurl' method='POST'>
       <input type='hidden' value='your-encrypted-xml" />
   </form>
</body> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T14:40:05.613

您正在考虑这个过于面向过程的问题，您将需要一个月的周日时间来尝试按照您的建议解决所有错误和移动部件。

您已经在向另一台服务器发帖，所以您真的不需要做任何事情。您拥有的表单已经很完美，当其他服务器拦截请求时，它决定允许用户进入并继续通过站点，或者将它们重定向回标头中的引用者（原文如此）。当重定向回Referer时，他们可能想要附加一条说明出了什么问题的消息，例如 ?error=no_auth

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T14:32:04.340

我不久前写了另一个问题。希望这可以帮助：

[您如何在应用程序域之间传递经过身份验证的会话](https://stackoverflow.com/questions/72125/how-do-you-pass-an-authenticaticated-session-between-app-domains#73077)

# vba - Outlook 在哪里存储 VBA 代码文件？

> ID：233702
> 
> 赞同：21
> 
> 时间：2008-10-24T14:15:16.490
> 
> 标签：vba, outlook, ms-office

我在 Outlook 中有一个带有一些电子邮件宏的 VBA 项目 - 但是在 PC 崩溃后，它们都消失了，当我按下 Alt+F11 时，我看到的只是一个新的“Project1”

我不是 VBA 程序员，但有一组方便的宏用于电子邮件排序等。我不想再次编写它们。任何人都知道代码文件应该在文件系统上的哪个位置，以便我可以挽救代码？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-10-24T14:28:30.443

[此页面](http://www.outlookcode.com/article.aspx?id=28)对 Outlook 将所有内容保存在何处有一些非常好的见解。它提出以下建议：

> 所有 Outlook 宏都存储在用户的 %appdata%\Microsoft\Outlook 文件夹中名为 VbaProject.otm 的单个文件中，该文件夹在大多数系统上将是一个隐藏文件夹。

现在，问题是如果您现在看不到它们，那么您可能无法从该位置恢复它们：那里可能有一个“空”项目或根本没有项目，但如果该文件夹是正在备份，您也许可以恢复它。

展望未来，您可能会考虑定期导出宏，以防再次发生这种情况，通过 VBA IDE（右键单击并选择导出文件...）或使用链接文章中提到的工具之一（如[Office 配置文件向导](http://office.microsoft.com/en-us/ork2003/HA011513591033.aspx)）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-12-22T21:37:18.663

行。试图解决这个问题的事情......

我假设问题发生后您尝试重新登录到相同的 Windows 用户帐户和相同的 Outlook 配置文件。

1.  为有问题的机器创建一个新的 Windows 登录名。
2.  登录此帐户并打开 Outlook，这将创建一个新的 Outlook 配置文件。记下配置文件名称（要找到它：控制面板 > 邮件小程序 > 显示配置文件...）
3.  现在退出 Outlook，并确保它没有运行（检查任务管理器中的 Outlook.exe）。
4.  打开 Windows 资源管理器。
5.  复制（不要剪切）现有的 VbaProject.OTM 文件。（如果它有任何其他名称，请先将其重命名为 VbaProject.OTM，然后复制）。
6.  导航到 C:\Documents and Settings\USERNAME\Application Data\Microsoft\Outlook（或使用环境变量表示法 %appdata%\Microsoft\Outlook for vista/win7）
7.  将现有的 VbaProject.OTM 重命名为 VbaProject.OTM.OLD
8.  将第 5 步中的 VbaProject.OTM 粘贴到此文件夹中。
9.  重新打开 Outlook 并进行测试（即 Alt + F11）。
10.  祝你康复顺利。

如果这不起作用，您还记得添加自签名证书吗？如果有，你有证书的副本吗？您可以尝试将其重新安装到证书管理器 (certmgr.msc) 中，将其复制/安装到 Certficiates - Current User\Personal\Certificates 配置单元。

我刚刚从 Sue Mosher（outlook VBA 大师）那里找到了这条注释：“AFAIK，一旦 .otm 文件损坏，就无法恢复。这就是为什么我建议依赖 VBA 代码的人导出他们的模块或备份整个文件。 ”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-02-04T16:02:14.967

所有宏都嵌入到 OTM 文件中，位于以下位置：

```
C:\Users\(***Your User Name***)\AppData\Roaming\Microsoft\Outlook\VbaProject.OTM 
```

要恢复，用旧文件替换这个文件，它应该可以工作

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-02-05T18:42:43.873

遇到同样的问题。

*   首先查看了@Anonymous Type 和@Dave DuPlantis 提到的.otm 文件
*   没有损坏...嗯

我在 Outlook 中的功能区中检查了“开发人员”选项卡。它丢失了，只需将其重新添加到我的功能区即可解决我的问题。

# c# - 对通过亚音速返回的数据应用过滤器“like”子句

> ID：233706
> 
> 赞同：0
> 
> 时间：2008-10-24T14:16:19.000
> 
> 标签：c#, asp.net

我有一个数据访问层，它从存储过程返回数据。如果我将它绑定到 asp.net 2.0 中的 gridview 控件，则用户可以选择在该数据选择列表上进行过滤，他们可以在其中选择条件子句

*   喜欢

*   =

*   或者

*   和

返回结果后，我不想在应用过滤器的情况下再次点击 Db。

如果需要，我可以选择使用 .net 3.5。我看了这个： [http ://weblogs.asp.net/jgaylord/archive/2006/05/31/Filter-A-GridView-After-The-Initial-Bind.aspx](http://weblogs.asp.net/jgaylord/archive/2006/05/31/Filter-A-GridView-After-The-Initial-Bind.aspx)

并且不确定它的效率。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-24T14:35:05.827

您是否在页面上使用 SqlDataSource 控件并绑定到该控件？如果是这样，那么您将不得不换档并进行手动装订步骤。

您可能会执行一些操作，例如将 DataTable 存储在 ViewState 或 Session 中，然后将其包装在包含您的过滤器的 DataView 中（或者没有过滤器用于初始页面加载）。然后你只需绑定到 DataView。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T15:18:08.623

SubSonic Collections 具有内置的过滤功能。您还可以对它们使用 LINQ 过滤器。我这里没有具体的例子给你，但是你基本上可以在亚音速集合上设置 Where 子句并运行一个特定的方法（不记得是哪个，因为我从来没有使用过这个功能），它将过滤器应用于当前集合并返回一个新的。从我所见，原始集合没有被修改，它只是有元数据来过滤它在内存中。

# http - 域重定向到同一页面和谷歌

> ID：233710
> 
> 赞同：0
> 
> 时间：2008-10-24T14:16:41.917
> 
> 标签：http, redirect, seo

我们为客户开发了一个网站，他购买了 .com、.net、.info 版本的域。

有没有办法将所有内容重定向到同一页面，而不会被 Google 视为重复内容并因此在排名位置受到惩罚？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-24T14:19:11.460

只需使用[永久重定向](http://en.wikipedia.org/wiki/HTTP_301)。

# c# - 创建后将属性添加到匿名类型

> ID：233711
> 
> 赞同：107
> 
> 时间：2008-10-24T14:16:50.433
> 
> 标签：c#, reflection, anonymous-objects

我使用匿名对象将我的 Html 属性传递给一些辅助方法。如果消费者没有添加 ID 属性，我想在我的辅助方法中添加它。

如何向此匿名对象添加属性？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2010-12-11T11:41:36.520

以下扩展类将为您提供所需的东西。

```
public static class ObjectExtensions
{
    public static IDictionary<string, object> AddProperty(this object obj, string name, object value)
    {
        var dictionary = obj.ToDictionary();
        dictionary.Add(name, value);
        return dictionary;
    }

    // helper
    public static IDictionary<string, object> ToDictionary(this object obj)
    {
        IDictionary<string, object> result = new Dictionary<string, object>();
        PropertyDescriptorCollection properties = TypeDescriptor.GetProperties(obj);
        foreach (PropertyDescriptor property in properties){
            result.Add(property.Name, property.GetValue(obj));
        }
        return result;
    }
} 
```

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2008-10-24T14:19:55.873

我假设您在这里指的是匿名类型，例如`new { Name1=value1, Name2=value2}`等。如果是这样，那么您就不走运了-匿名类型是普通类型，因为它们是固定的编译代码。它们恰好是自动生成的。

你*能做*的就是写`new { old.Name1, old.Name2, ID=myId }`，但我不知道这是否真的是你想要的。有关情况的更多详细信息（包括代码示例）将是理想的。

或者，您可以创建一个*始终*具有 ID 的容器对象，以及包含其余属性的任何其他对象。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2011-07-19T20:40:46.717

如果您尝试扩展此方法：

```
public static MvcHtmlString ActionLink(this HtmlHelper htmlHelper, string linkText, string actionName, object routeValues); 
```

虽然我确信 Khaja 的对象扩展会起作用，但您可能会通过创建 RouteValueDictionary 并传入 routeValues 对象、从 Context 添加其他参数，然后使用采用 RouteValueDictionary 而不是对象的 ActionLink 重载返回来获得更好的性能：

这应该可以解决问题：

```
 public static MvcHtmlString MyLink(this HtmlHelper helper, string linkText, string actionName, object routeValues)
    {
        RouteValueDictionary routeValueDictionary = new RouteValueDictionary(routeValues);

        // Add more parameters
        foreach (string parameter in helper.ViewContext.RequestContext.HttpContext.Request.QueryString.AllKeys)
        {
            routeValueDictionary.Add(parameter, helper.ViewContext.RequestContext.HttpContext.Request.QueryString[parameter]);
        }

        return helper.ActionLink(linkText, actionName, routeValueDictionary);
    } 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-24T14:37:38.397

```
public static string TextBox(this HtmlHelper html, string value, string labelText, string textBoxId, object textBoxHtmlAttributes, object labelHtmlAttributes){} 
```

这将接受文本框应具有的 id 值和标签应引用的值。如果消费者现在没有在 textBoxHtmlAttributes 中包含“id”属性，则该方法将创建一个不正确的标签。

如果这个属性被添加到 labelHtmlAttributes 对象中，我可以通过反射检查。如果是这样，我想添加它或创建一个新的匿名对象来添加它。但是因为我无法通过遍历旧属性并添加自己的“id”属性来创建新的匿名类型，所以我有点卡住了。

具有强类型 ID 属性和匿名类型“属性”属性的容器将需要不符合“添加 id 字段”要求的代码重写。

希望这个回答是可以理解的。这一天结束了，我不能再让我的大脑排成一行了。。

# iis - IIS 中每个用户会话的应用程序域

> ID：233718
> 
> 赞同：0
> 
> 时间：2008-10-24T14:18:07.000
> 
> 标签：iis, session, appdomain

这个问题是关于应用程序域和会话的。是否可以让 IIS 在单独的应用程序域中运行每个用户会话。如果是，请让我在配置文件中设置影响这一点的设置。

问候，阿尼尔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-24T14:31:35.367

我不知道可以轻松完成此操作的方法。请进一步解释您的问题，说明为什么需要 AppDomain - 将应用程序集合使用移动到 Session 可能更容易。

更新：不幸的是，您的问题的正确解决方案是为基于服务器的会话解决方案重新构建库。你可以做的，我强烈不推荐这样做，是为每个 Session 创建一个 AppDomain，在 Session 中存储对它的引用，然后依靠诸如`CreateInstanceAndUnwrap`魔术字符串和反射之类的调用（没有真正的编译时间检查）来为每个用户加载一个库实例。我想如果你追求这个解决方案，你将花费更多的时间来调试它和处理错误，而不是你预先进行重新架构时间投资。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T14:53:22.980

这在运行 ASP.NET 1.x 或 ASP.NET 2.0（即使安装了 .NET Framework 3.5）的 Windows 2000 或 Windows 2003 下是不可能的。这同样适用于在 IIS7 上运行的 ASP.NET。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T17:40:54.250

一种可能的解决方法（当然不会扩展）是创建一个 Windows 服务来管理新进程的启动和停止，并使用 WCF 从 Web 应用程序与该服务进行通信。

# javascript - 是否可以使用 JavaScript 在 Firefox、Safari 和 Chrome 中读取剪贴板？

> ID：233719
> 
> 赞同：34
> 
> 时间：2008-10-24T14:18:10.010
> 
> 标签：javascript, cross-browser, clipboard

我正在尝试使用 JavaScript 读取剪贴板的内容。使用 Internet Explorer 可以使用该功能

```
window.clipboardData.getData("Text") 
```

在 Firefox、Safari 和 Chrome 中是否有类似的读取剪贴板的方法？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-24T18:16:13.367

`onpaste`Safari 支持在事件期间读取剪贴板：

[信息](http://developer.apple.com/documentation/AppleApplications/Conceptual/SafariJSProgTopics/Tasks/CopyAndPaste.html#//apple_ref/doc/uid/30001234-176911)

你想做这样的事情：

```
someDomNode.onpaste = function(e) {
    var paste = e.clipboardData && e.clipboardData.getData ?
        e.clipboardData.getData('text/plain') :                // Standard
        window.clipboardData && window.clipboardData.getData ?
        window.clipboardData.getData('Text') :                 // MS
        false;
    if(paste) {
        // ...
    }
}; 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-03T10:58:24.700

在线电子表格挂钩`Ctrl`+ `C`、`Ctrl`+`V`事件并将焦点转移到隐藏的 TextArea 控件，并将其内容设置为所需的新剪贴板内容以进行复制或在事件完成粘贴后读取其内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-24T14:47:39.297

***不。*** 如果你确实发现了一个 hack（例如旧版本的 flash），请不要依赖它。

我可以问你为什么要从剪贴板中读取吗？如果用户想要传递剪贴板内容，他们需要做的就是粘贴。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-24T14:32:39.810

我相信人们使用隐藏的 Flash 元素从您提到的浏览器中读取剪贴板数据。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-01-25T21:38:59.497

使用@agsamek 的建议，我创建了一个小测试并让它工作。在我的情况下，我需要在新的页面加载后等待粘贴输入，所以我专注于一个视野外的文本区域并从那里阅读文本。

您可以扩展它以收听特定键（粘贴组合），然后专注于隐藏字段。肯定会有更多工作要做，因为我认为您需要重新关注最后一个焦点元素并将内容粘贴到那里。

对于我的用例来说，这足以让它在最新的 Chrome 和 Firefox 中运行。欢迎提出建议。

[https://jsfiddle.net/wuestkamp/91dxjv7s/11/](https://jsfiddle.net/wuestkamp/91dxjv7s/11/)

```
$(function () {

    $('body').prepend('<input type="text" id="hidden_textbox" style="position: absolute; width:0px; height: 0px; top: -100px; left: -100px">');

    var $hiddenTextbox = $('#hidden_textbox');
    $hiddenTextbox.focus();

    $(document).on('paste', function () {
        setTimeout(function () {
            var val = $hiddenTextbox.val();

            console.log('pasted: ' + val);

        }, 50);

    });

}); 
```

# testing - Beta测试新产品

> ID：233720
> 
> 赞同：5
> 
> 时间：2008-10-24T14:18:12.770
> 
> 标签：testing

作为一个微型 ISV，我正在开发一个新的桌面软件应用程序，在那里与外部用户组进行 beta 测试会很棒。

*我更喜欢仅私人邀请的 beta 测试，而不是所有 beta 测试的公开免费。*

**是否有免费或付费的网站/组织，我可以在其中“联系”想要测试软件并提供反馈/错误报告等的人（具有一定程度的选择性）？**

**其他人在对他们的产品进行 Beta 测试时做了什么？**

更新：我遇到了看起来很有趣的[TryBeta](http://www.trybeta.com/login/index.php)（尽管网站上的活动似乎在 2007 年左右结束）。

关于将测试人员变成客户，我目前不太关心这样做。针对目标受众的广告以建立客户群将在​​稍后阶段实施。现在只有测试人员，理想情况下由第三方网站/组织管理，将是理想的。

提前谢谢了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T14:22:21.077

通常，仅限邀请的 Beta 测试几乎将您限制在现有或潜在客户中。如果你有这个产品的客户（你没有因为你说它是“新的”）或者你公司的其他产品，邀请他们来测试你的产品。他们不会都说是的。

如果您没有客户，或者您没有足够的 Beta 测试人员，那么您的销售人员（听起来可能是您）就该开始行动来创建一些客户了。提供免费且无义务的测试版通常可以吸引那些真正鼓励他们购买的人，特别是如果他们的错误报告得到认真对待。因此，这会将您的问题转变为“我如何为我的应用找到潜在客户？” 这将取决于您的应用程序是什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T14:53:37.957

您可能会采用 GMail 在其初始发布期间使用的方法——对于具有网络效应的产品，初始种子发布，然后基于推荐邀请的增长将允许您以您喜欢的增长率扩大规模。并且，测试池将有更大的交互可能性。

如何形成最初的种子？一种可能性是去杂志（在线或印刷）了解目标人群并“租用邮件列表”。

# dns - DNS 域名语法示例

> ID：233721
> 
> 赞同：1
> 
> 时间：2008-10-24T14:18:36.017
> 
> 标签：dns

根据 RFC1035，dns 名称可能包含 \ddd \x 和引号。请举例说明这些。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T15:05:30.913

[RFC1035](http://www.ietf.org/rfc/rfc1035.txt)没有说 DNS**名称**可以包含这些字符。在第 5 节（主文件）中，它说包含 RR 信息的**文件**可以包含这些字符。具体来说：“因为这些文件是文本文件，所以需要几种特殊编码才能加载任意数据。” 除了域之外，还有可以进入区域文件的文本。例如，TXT 记录中的条目是自由文本，因此您可能希望在其中放入一个二进制字符，用 \ddd 字符串等表示。您还可以发表评论，因此您可以使用这些“特殊编码” “在你的评论中。

支持国际化域名，但 RFC1035 是从 1987 年开始的，当时还没有讨论 i18n 域名。

编辑：我只是重读它，我认为我错了。上面的内容在技术上是关于文件格式的。但是，这也在 RFC 的 3.1 节中：

> ```
> Although labels can contain any 8 bit values in octets that make up a
> label, it is strongly recommended that labels follow the preferred
> syntax described elsewhere in this memo, which is compatible with
> existing host naming conventions.  Name servers and resolvers must
> compare labels in a case-insensitive manner (i.e., A=a), assuming ASCII
> with zero parity.  Non-alphabetic codes must match exactly. 
> ```

因此，这表示任何 8 位字符都可以成为标签的一部分（其中标签是点之间的域名部分）。不过，该文档描述的是 DNS 协议的技术能力。常见用法是另一回事。实际上，在“2.3.1.首选名称语法”部分中：

```
The following syntax will result in
fewer problems with many applications
that use domain names (e.g., mail,
TELNET).

<domain> ::= <subdomain> | " "

<subdomain> ::= <label> | <subdomain>
"." <label>

<label> ::= <letter> [ [ <ldh-str> ]
<let-dig> ]

<ldh-str> ::= <let-dig-hyp> |
<let-dig-hyp> <ldh-str>

<let-dig-hyp> ::= <let-dig> | "-"

<let-dig> ::= <letter> | <digit>

<letter> ::= any one of the 52
alphabetic characters A through Z in
upper case and a through z in lower
case

<digit> ::= any one of the ten digits
0 through 9 
```

换句话说，DNS 协议从一开始就被定义为使用 8 位 ascii。但是，如果您真的希望您的程序能够使用 DNS 中的域，您应该坚持使用 [az-]。

举个例子，我认为这只是意味着你可以有一个这样的 DNS 条目：

```
IHaveAn\020EmbeddedTab  IN A 172.24.3.1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-19T07:06:30.613

推荐阅读[RFC 2181](http://www.ietf.org/rfc/rfc2181.txt)，其第 11 节很好地解释了这个问题。

否则，例如，请参阅`maps-to-nonascii.rfc-test.net`。此名称是具有非 ASCII 字符的名称的别名。

# sql - LINQ to SQL 多个 DataContext-s

> ID：233745
> 
> 赞同：11
> 
> 时间：2008-10-24T14:23:30.797
> 
> 标签：sql, linq, linq-to-sql, datacontext

我试图找出关于如何组织 DataContexts 的最佳策略。我们工作的典型数据库有 50 到 100 个表，通常是第三范式，它们之间有很多关系。我认为我们有两个选择：

1.  将所有表放在一个上下文中。这将确保我们所做的任何事情都将在数据库中以正确的顺序提交。问题是 LINQ 设计器会弄乱 50 多个表，我担心性能可能会受到影响。
2.  根据表的逻辑分组创建多个数据上下文。问题在于，在某些地方，关系的一侧将在一个上下文中，而另一侧在另一个上下文中。我们必须手动处理以正确的顺序提交两个上下文。

有没有推荐的做法来处理这个问题？

更多细节：

我想在 LINQ to SQL 之上创建自己的实体和工作单元。实体将在 xml 模型文件中定义，其中还将指定到 LINQ 实体的映射。自定义工具将根据模型生成我的实体 (POCO)。客户端代码将仅与我的实体和我的工作单元交互；永远不要直接使用 DataContext 或 LINQ 实体。但是我不想复制 LINQ to SQL 提供的开箱即用的功能，所以我想使用底层的 LINQ DataContext。这意味着我不能在不同的数据上下文中拥有两个订单，因为不可能将我的 POCO 订单与它们都映射。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-07-19T15:15:33.203

这是一个已在此处彻底分析的常见问题：http: [//craftycode.wordpress.com/2010/07/19/linq-to-sql-single-data-context-or-multiple/](http://craftycode.wordpress.com/2010/07/19/linq-to-sql-single-data-context-or-multiple/)

本质上，您应该为每个强连接的表组创建最多一个数据上下文，或者每个数据库最多创建一个数据上下文。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-24T14:50:16.077

LINQ-to-SQL 映射类似于类型化的数据集，因为当您使用其中一个时，您正在处理一个包含数据的会话。您可以在几个不同的 DataContext 中拥有相同的表。毕竟，它们只是类；在您开始与数据库交互之前，它们没有任何意义，通过用现有数据填充它们或使用它们来创建新数据。

因此，当您发送新目录时，您可能需要处理客户、地址、电话等表。然后，您就有了在创建订单时使用的 Invoice、Line Item、Product 等表格。但是在后一组中，您可能还希望拥有 Customer。没关系。您应该注意一次只有一个会话处于活动状态，这样您就不会使用不一致的数据。只要您不以重叠的方式使用它们，您就不应该在各种 DataContexts 中遇到重叠*实体的问题。*

就混乱而言，您可以将 DataContext 放在特定的命名空间中，也可以将各种实体放在特定的命名空间中（尽管 DataContext 中的每组实体只有一个命名空间）。您可以在“属性”窗口中执行此操作。这将使您保持 Intellisense 不那么混乱。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T14:30:41.687

您应该创建允许您执行*工作单元的*上下文。这可能涉及重叠的表映射。

上下文1：客户有很多发票

上下文2：客户有很多订单

上下文3：发票有很多订单

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-18T20:07:54.213

我每个数据库使用一个数据上下文。

平均表最多可达 100 个，但根据经验，我没有遇到任何性能问题。

数据上下文位于一个单独的项目中，该项目已编译。从 BLL 引用的结果 dll

# c# - 将gridview写入文件不适用于嵌套for循环

> ID：233749
> 
> 赞同：2
> 
> 时间：2008-10-24T14:24:27.097
> 
> 标签：c#, asp.net, visual-studio

我有这个循环，我用它来获取gridview所有行中所有单元格的值，然后将其写入csv文件。我的循环如下所示：

```
string filename = @"C:\Users\gurdip.sira\Documents\Visual Studio 2008\WebSites\Supressions\APP_DATA\surpressionstest.csv";
StreamWriter sWriter = new StreamWriter(filename);
string Str = string.Empty;

string headertext = "";

sWriter.WriteLine(headertext);

for (int i = 0; i <= (this.GridView3.Rows.Count - 1); i++)
{
    for (int j = 0; j <= (this.GridView3.Columns.Count - 1); j++)
    {
        Str = this.GridView3.Rows[i].Cells[j].Text.ToString();
        sWriter.Write(Str);
    }

sWriter.WriteLine();

} 

sWriter.Close(); 
```

这段代码的问题是，当单步执行时，第二个循环（通过列的循环）没有开始，因为调试器没有命中这个循环，因此我的文件是空的。

关于造成这种情况的任何想法？代码本身看起来不错。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-24T14:56:02.837

我认为内部循环应该访问*Cells*，而不是列：

```
 for (int i = 0; i <= (this.GridView3.Rows.Count - 1); i++)
    {

        for (int j = 0; j <= (this.GridView3.Rows[i].Cells.Count - 1); j++)
        {

            Str = this.GridView3.Rows[i].Cells[j].Text.ToString();

            sWriter.Write(Str);
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T15:07:25.433

添加行号，如果我正确理解您的问题，您是说在调试时，您永远不会到达第 8 行。如果是这种情况，那么我希望您的问题是当您实际通过循环进行处理时网格视图中没有行。要弄清楚为什么会这样，我建议您查看您在页面发布周期中的位置

```
 string filename = @"C:\Users\gurdip.sira\Documents\Visual Studio 2008\WebSites\Supressions\APP_DATA\surpressionstest.csv";//1
     StreamWriter sWriter = new StreamWriter(filename);//2
     string Str = string.Empty;//3
     string headertext = ""; //4
     sWriter.WriteLine(headertext);  //5
     for (int i = 0; i <= (this.GridView3.Rows.Count - 1); i++)   //6
     {         //7
        for (int j = 0; j <= (this.GridView3.Columns.Count - 1); j++)  //8
        { //9
               Str = this.GridView3.Rows[i].Cells[j].Text.ToString();//10
               sWriter.Write(Str);//11
        }//12
        sWriter.WriteLine();//13
      }//14
      sWriter.Close();//15
}//16 
```

# visual-studio - .NET VS2005 WinForms：如何将用户控件拖放到表单上？

> ID：233756
> 
> 赞同：2
> 
> 时间：2008-10-24T14:27:24.033
> 
> 标签：visual-studio, winforms, assemblies

我写了一个在程序集 dll 中**的UserControl 后代。**

如何将控件放在表单上？

```
namespace StackOverflowExample
{
   public partial class MonthViewCalendar : UserControl
   {
      ...
   }
} 
```

我在**解决方案资源管理器的****引用**节点下添加了对程序集的引用，但我的**工具箱**中没有出现新控件。

 ****如何使控件出现在工具箱中，以便我可以将其放在表单上？

* * *

**更新 1**：

我尝试在 Visual Studio 选项中构建程序集：

**工具**-->**选项...** --> **Windows 窗体设计器**--> **AutoToolboxPopulate** = true

在新解决方案的工具箱中时，该控件未出现。

注意：我不知何故错误地写了“……那*不在*程序集 dll 中……”。我不知道我是怎么写出来的，特别*是*在程序集 dll 中。当它们在同一个项目中时，控件神奇地出现了，但现在不是因为它是不同的项目/解决方案。

* * *

**更新 2：答案**

1.  右键单击**工具箱**
2.  选择**选择项目...**
3.  **.NET Framework 组件**选项卡
4.  选择**浏览...**
5.  浏览到包含控件的**程序集 dll文件并选择****打开**

    注意：程序集中的控件将以静默方式添加到 .NET Framework 组件列表中。

6.  **检查**您希望出现在工具箱中的每个控件
7.  选择**确定**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-24T14:34:42.003

通常，当您构建项目时，您的用户控件将出现在顶部的工具箱中。通常，您会看到一个新窗格，其中包含每个程序集和控件。

如果这没有发生，您还可以通过右键单击工具箱，选择*选择项*来添加控件，然后在*.NET Framework Components*下浏览您的程序集，添加它，然后确保选中您的控件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-16T11:07:19.163

我注意到的是，只有当您的项目（包含控件/组件）与解决方案位于同一文件夹中时，vs2005 才会自动将用户控件和组件添加到工具箱中。当此项目在子文件夹中时，vs2005 不会在工具箱中添加控件和组件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T14:30:49.063

您需要构建包含您创建的控件的项目，并确保您的选项设置为工具箱重建。如果你没有改变它的默认值，它应该可以工作；否则，转到**Tools-->Options...**并选择 Windows Forms Designer 组。确保**AutoToolboxPopulate**选项设置为**true**。

你不需要`ToolboxItemAttribute`它来工作。如果提供程序集与使用程序集位于同一解决方案中，则它应该出现在工具箱中。如果提供的程序集不是解决方案的一部分，您可以通过从工具箱上下文菜单中选择 **Choose items...* 并直接添加程序集来手动将程序集添加到工具箱。如果您希望工具箱自动拾取它们，则需要使用`ToolboxItemAttribute`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T15:08:52.607

我偶然发现了一些问题。最后，只需重建和重新引用即可。我更喜欢从 UserControl 继承。它让我的生活更简单；）

例如，如果您想创建一个“圆角边框”标签，请执行以下操作：

```
using System;
using System.ComponentModel;
using System.Drawing;
using System.Drawing.Drawing2D;
using System.Windows.Forms;

namespace YourUIControls
{
    [DefaultProperty("TextString")]
    [DefaultEvent("TextClick")]
    public partial class RoundedLabel : UserControl
    {
         public RoundedLabel()
         {
             InitializeComponent();
         }
         protected override void OnPaint(PaintEventArgs e)
         {
             //Draw your label here…
         }
     }
} 
```

编译并添加对输出的引用。您将能够将其拖到工具箱中，然后再拖到设计器中。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-24T14:30:14.010

将 ToolboxAttribute 添加到您的类中。

# c# - C#项目设置“允许不安全代码”的实际作用是什么

> ID：233759
> 
> 赞同：8
> 
> 时间：2008-10-24T14:27:40.693
> 
> 标签：c#, dll, interop, native, unsafe

我想知道 C# 项目设置“允许不安全代码”是否仅适用于项目本身中的不安全 C# 代码，或者在链接本机 C++ DLL 时是否需要设置此选项？如果在托管 DLL 中链接本身链接到本机 DLL 呢？这个选项到底在做什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-24T14:29:10.423

它与 C# 中的“不安全”关键字有关。“不安全”会关闭所有通常会发生的检查，并允许您直接访问内存。它不是指调用本机 C++ DLL 或接口。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-24T14:28:56.837

它允许您使用“不安全”块。

```
unsafe(...)
{
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-24T14:29:23.577

这仅与`unsafe`块的使用有关（可以使用指针的地方）。它不管理 P/Invoke。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-24T14:29:00.940

必须使用不安全的 { } 上下文。它曾经需要使用 sizeof() 但在以后的版本中不再适用。

如果您要外部连接到用另一种语言（如 C）编写的另一个 DLL，则不需要允许不安全的代码。

# sql-server-2005 - StructureMap 和 SqlCacheDependency

> ID：233772
> 
> 赞同：0
> 
> 时间：2008-10-24T14:30:40.797
> 
> 标签：sql-server-2005, linq-to-sql, inversion-of-control, structuremap

我正在尝试通过我的 StructureMap IoC 启用 SqlCacheDependency，我正在使用 LinqToSql 我已经完成了处理 Linq 缓存的代码，但不太确定如何设置 SqlCacheDependency，因为它需要将它放在全局中。文件

```
void Application_Start(object sender, EventArgs e) 
{
    string connectionString = WebConfigurationManager.
        ConnectionStrings["Catalog"].ConnectionString;
    SqlDependency.Start(connectionString);
} 
```

但是，我的存储库不使用 global.asa，因为它只是一个库 (.dll) 而不是 Web 应用程序。

任何想法如何做到这一点？也许将 application_start 方法中的内容放入我的存储库的构造函数中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-24T14:34:06.810

将该代码移动到构造函数中应该没问题。

我经常在任何需要显式初始化的东西上放置一个静态 Initialize() 方法。如果我的代码对于外部使用来说是卫生的，如果在使用 Initialize 方法之前调用了一个方法，我也会抛出我自己的 UninitializedException。

结果，我的 Global.asax 往往包含几个 blah.Initialize() 调用。

# java - 在 Eclipse 控制台中为日志着色

> ID：233790
> 
> 赞同：107
> 
> 时间：2008-10-24T14:34:21.257
> 
> 标签：java, eclipse, console, escaping, metadata

有没有办法在 Eclipse 控制台中为部分日志着色。我知道我可以发送到错误和标准流并为它们着色，但我更多的是在 ANSI 转义码（或任何其他，HTML？）的行中寻找一些东西，我可以在字符串中嵌入颜色以使其着色日志。

它肯定有助于在不采用奇怪布局的情况下使重要的部分脱颖而出，而是将布局保持在 log4j 设置中

这是我正在寻找的一个例子：

[INFO] 网格完整....... **false**

在粗体部分为蓝色的情况下，这种颜色可以在一定程度上由应用程序控制。像这样（标签是概念性的和任意的，但你明白了）：

log.info(String.format("网格完成....... `<blue>`%s `</blue>`", isComplete ));

* * *

更一般地说，它能够在日志中嵌入元信息以帮助呈现这些日志。就像我们标记网页内容以帮助通过 CSS 呈现信息一样。

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-09-03T13:03:25.743

试试这个 Eclipse 插件：[Grep 控制台](http://marketplace.eclipse.org/content/grep-console)

**[更新]**：
~~正如评论者所指出的：在当前最新版本的 Eclipse 中安装 Grep 控制台时，您需要在安装对话框中取消选中“按类别分组项目”以查看可用项目。~~[正如@Line](https://stackoverflow.com/questions/233790/colorize-logs-in-eclipse-console/1373290#comment92218117_1373290)
所指出的，该插件现在可以再次通过 Eclipse Marketplace 轻松安装，而无需更改任何选项。

**[更新 2]**：正如[@azdev](https://stackoverflow.com/questions/233790/colorize-logs-in-eclipse-console#comment9125576_1373290)
所指出的，要获得正确的突出显示：

> 只输入文字字符串是行不通的。`.*` 要使线条着色，您必须在两侧 将字符串括起来 ，如下所示：`.*ERROR.*`

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2014-04-07T13:54:38.230

实际上，[ANSI 控制台插件](https://github.com/mihnita/ansi-econsole)为 Eclipse 控制台添加了 ANSI 转义码支持。目前它确实有一个限制，即跨越多行的转义码在滚动时会错误地泄漏到其他行，请参阅[问题 #3](https://github.com/mihnita/ansi-econsole/issues/3)。

[否则，其他问题](https://stackoverflow.com/questions/1562600/is-there-an-eclipse-plugin-to-run-system-shell-in-the-console)中解释的某些终端视图插件可能是某些人的选择。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-09-07T06:49:26.873

正如@Benjamin Grep 已经指出的那样，控制台是在控制台中为输出着色的好方法。

我制作了一个简短的视频来演示它是如何工作的，并从 Grep 控制台插件的创建者那里得到了回复。他提到**Grep 控制台 3 已经发布。**

**截屏**：[http ://www.youtube.com/watch?v=fXjgGZAxToc](http://www.youtube.com/watch?v=fXjgGZAxToc)

## 更新站点

**Grep Console 2**
[http://eclipse.musgit.com](http://eclipse.musgit.com)
（需要 Eclipse 3.4 (Ganymede) 或更高版本以及 Java 5.0 或更高版本）

**Grep Console 3**
[http://eclipse.schedenig.name](http://eclipse.schedenig.name)
（需要 Eclipse 3.7 (Indigo) 或更高版本以及 Java 6.0 或更高版本）

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-24T15:18:51.247

如何使用[Logback](http://logback.qos.ch/consolePlugin.html)及其[属性转换器](http://logback.qos.ch/translator/Welcome.do)并将所有内容记录在 log4j 中，这可能会让您看到不同颜色的不同级别。

祝你好运！

**编辑**：[日食](http://logback.qos.ch/dist/ch.qos.logback.eclipse_1.1.0.zip)插件

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-24T15:20:48.200

我们在我工作的地方使用 Ganymede Eclipse 插件，它运行良好。

[http://sourceforge.net/projects/ganymede/](http://sourceforge.net/projects/ganymede/)

“Eclipse 的 log4j 插件，其工作方式类似于链锯 (SocketServer)。包括颜色、过滤、详细信息和保存设置。”

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2020-02-27T13:30:05.967

您可以在Eclipse[的控制台插件中使用 ANSI Escape 。](https://stackoverflow.com/questions/5762491/how-to-print-color-in-console-using-system-out-println/5762502#5762502)您将需要它，以便 Eclipse 控制台可以解释 ANSI Escape 代码。**安装它并重新启动 Eclipse**。然后您可以使用 ANSI 颜色代码以某种颜色书写。这是来自另一个 stackoverflow 答案[的 ANSI 颜色代码列表。](https://stackoverflow.com/questions/5762491/how-to-print-color-in-console-using-system-out-println/5762502#5762502)然后你可以这样做：

```
public static final String ANSI_RESET = "\u001B[0m";
public static final String ANSI_RED = "\u001B[31m";

public static void main(String[] args) {
    System.out.println(ANSI_RED + "This text is red!" + ANSI_RESET);
} 
```

我用它为控制台处理程序创建了一个自定义格式化程序，因此它以不同颜色显示来自 Logger 的不同级别的日志（青色的 INFO 日志，黄色的 WARNING 日志和红色的 SEVERE 日志）。[这是我的做法](https://stackoverflow.com/a/60433979/7915606)，如果你有兴趣。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-07-09T01:09:20.853

阅读**org.eclipse.ui.console.consolePatternMatchListeners**扩展点。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-24T14:49:02.740

如果您已经在使用 log4j，您可以考虑尝试 Apache Chainsaw ( [http://logging.apache.org/chainsaw/index.html )。](http://logging.apache.org/chainsaw/index.html)让您定义颜色和过滤器并使用（几乎）零配置。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-24T15:38:03.623

我以前用过这个插件，它可以让你根据自定义的正则表达式对日志的行进行着色。

例如，当我使用它时，任何带有 error 字样的行都会是红色的，warning 会是橙色的，info 会是蓝色的......等等。

因为它是正则表达式，所以你可以做任何事情。设置它以使该行以“>>>”开头时变为绿色，然后在您的消息字符串前面加上“>>>”。

[http://sourceforge.net/projects/logfiletools](http://sourceforge.net/projects/logfiletools)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-08-15T18:34:49.993

# 表情符号

您可以像其他人在他们的答案中提到的那样为文本使用颜色。

但是您可以改用**表情符号**！例如，您可以使用您可以使用`⚠️`警告消息和`错误消息以使它们脱颖而出！`

 `或者干脆将这些笔记本用作颜色：

```
: error message
: warning message
: ok status message
: action message
: canceled status message
: Or anything you like and want to recognize immediately by color 
```

我个人对不同的输出使用有意义的表情符号。

```
Authentication Key:  
Server Error: 
etc. 
```

### 奖金：

**此方法还可以帮助您直接在源代码中**快速扫描和查找日志。

[但是 linux 默认 emoji 字体默认情况下不是彩色的，您可能希望首先使它们彩色。]

# php - 寻找在 Windows 上开发的轻量级 PHP 堆栈

> ID：233791
> 
> 赞同：0
> 
> 时间：2008-10-24T14:34:41.677
> 
> 标签：php, windows, rest

我希望在 Windows（和可能的 OSX）上设置一个轻量级的、仅限开发人员的 Web 堆栈。理想情况下，我会使用 Zend 框架 MySQL。但我对其他 API 持开放态度，以方便创建 RESTFul（或伪 Restful）Web 服务。我见过一些工具，比如 QuickPHP，但它可能太轻量级了，因为我无法让我想要的所有东西都能正常工作。我并不反对安装 Apache 和所有这些，但只是好奇是否还有其他一些我看不到的工具可以快速上手。

请记住，这仅用于本地开发。

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-24T14:39:19.687

问题是，您希望您的开发环境的行为方式与您的生产环境相同，所以我建议安装您要部署到的任何内容。我在服务器上运行 LAMP 堆栈，因此我在 Windows 上运行[WAMP](http://www.wampserver.com/en/)进行开发。它很容易安装，我没有注意到它会降低我的笔记本电脑的速度。您也可以查看[XAMPP](http://www.apachefriends.org/en/xampp.html)，但在尝试两者之后，我更喜欢 WAMP。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-24T14:37:06.103

对于我本地的 OSX 开发，我使用了[MAMP](http://www.mamp.info/en/download.html)。我强烈推荐它。

对于 Windows，我相信您已经了解[WAMP](http://en.wikipedia.org/wiki/Comparison_of_WAMPs)，而我没有使用过其他任何东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T14:37:24.137

我会调查[XAMPP](http://www.apachefriends.org/en/xampp.html)。但我更喜欢自己安装和配置 Apache 和 PHP，而不是使用预先推出的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T14:54:30.437

如果您想要真正轻量级，请确保在安装 WAMP 或 XAMPP 时，不要将服务设置为随 Windows 自动启动。

当您想开发应用程序时，使用 WAMP/XAMPP 控制台启动它们相当容易，但它可以让您避免一直运行它们并减慢启动时间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-08T19:46:36.413

我使用了 WAMP 和 XAMPP，但现在我在我的 VISTA 机器上分别安装了 Apache 2.2、PHP 5.3、MySQL 5.1.4（以及用于编写代码 Notepad++；用于处理 Windows 的照片 GIMP）。

安装起来并不难。仔细阅读 PHP 下载页面，哪个版本的 PHP Windows 安装程序适用于 Apache 2.2（也有一个适用于 IIS）。

所有这些软件都是高度可定制的。花一些时间做对是有道理的。

# javascript - 在 IE 中使用 javascript 预填充动态创建的文本框

> ID：233793
> 
> 赞同：0
> 
> 时间：2008-10-24T14:34:48.323
> 
> 标签：javascript, internet-explorer

我正在尝试将一些文本框（输入类型=文本）动态添加到 javascript 中的页面并预填充它们。文本框即将出现，但它们是空的。预填充文本框的正确方法是什么。理想情况下，我喜欢使用创建子 div、设置 innerhtml 属性，然后将该 div 添加到父主 div 的技巧，但这不起作用。然后我想我会使用 dom，但是在插入之前或之后设置 textboxname.value 将不起作用，并且 txttextbox.setattribute('value','somevalue') 也不起作用。在 Firefox 中运行良好。是什么赋予了？这一定是可能的？这是我的代码。我知道我只使用字符串文字，但这些文字最终将被 Web 服务调用的结果替换。下面是一些代码。哦，您如何格式化代码以在您键入时显示？我以为它说要缩进四个空格，我这样做了，但代码仍然在一行上。对于那个很抱歉。

```
var table=document.createElement('table');
var tbody=document.createElement('tbody');
var row=document.createElement('tr');
row.appendChild(document.createElement('td').appendChild(document.createTextNode('E-mail')));
var txtEmail=document.createElement('input');

row.appendChild(document.createElement('td').appendChild(txtEmail));
tbody.appendChild(row);
table.appendChild(tbody);

//document.getElementById('additionalEmails').innerHTML="";
document.getElementById('additionalEmails').appendChild(table); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-24T14:39:23.400

```
txtEmail.value = 'my text' 
```

不工作？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-24T14:50:24.640

您还可以使用[Prototype](http://prototypejs.org)轻松完成此操作：

```
document.body.insert(new Element("input", { type: "text", size:20, value:'hello world' })) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T15:44:42.473

我最终通过子 div 将 html 直接注入页面来解决这个问题。那确实有效，只是我是盲人，我用来阅读屏幕的软件出于某种愚蠢的原因无法看到文本框中的文本。去搞清楚。不过，感谢有关原型的提示，如果我决定不作弊并将元素直接添加到 dom，我会这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T14:56:48.527

过去我遇到过类似的问题，虽然我的记忆有点模糊，但我认为您可能需要确保在修改元素值之前将元素实际添加到 DOM 中。例如：

```
 var txtEmail=document.createElement('input');

document.getElementById('someElementThatAlreadyExists').appendChild(txtEmail);

txtEmail.value = 'sample text'; 

```

# ruby-on-rails - Rails：检测用户代理在开发中有效，但在生产中无效？

> ID：233802
> 
> 赞同：6
> 
> 时间：2008-10-24T14:36:53.547
> 
> 标签：ruby-on-rails, ruby

我正在尝试在我的应用程序中检测黑莓用户代理，这在我的开发版本中运行良好。但是当我在生产中重新部署应用程序时没有任何反应。

application_helper.rb

```
 def blackberry_user_agent?
    request.env["HTTP_USER_AGENT"] && request.env["HTTP_USER_AGENT"][/(Blackberry)/]
  end 
```

应用程序.html.erb

```
<% if blackberry_user_agent? -%>
<div class="message">
<p>Using a Blackberry? <a href="http://mobile.site.ca/">Use the mobile optimized version</a>.</p>
</div> 
```

我尝试使用 rake tmp:cache:clear 清除缓存并重新启动 mongrel 几次。显然 HTTP_USER_AGENT 在生产中归零。我正在将 Nginx 与杂种集群一起使用。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-10-29T19:33:02.530

尝试：

```
request.user_agent 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-24T15:17:40.983

你在你的 mongrel(s) 前面使用 Apache 或 nginx 吗？

您正在记录 user_agent 吗？这是来自我的 nginx.conf：

```
log_format main '$remote_addr - $remote_user [$time_local] $request '
                  '"$status" $body_bytes_sent "$http_referer" '
                  '"$http_user_agent" "http_x_forwarded_for"'; 
```

# windows-mobile - 在移动设备和服务器之间创建双向链接

> ID：233803
> 
> 赞同：2
> 
> 时间：2008-10-24T14:36:55.917
> 
> 标签：windows-mobile

我想在 winMo 设备和服务器之间创建一个链接，以便它们可以相互传递信息。我真的不知道从哪里开始，我有 SOAP、RPC 并建议我创建一个 TCP 链接。如果有人可以提供一个示例的链接，那就太好了。

谢谢！

感谢您的回复。更新：

*   服务器启动通信并不重要，我可以让移动设备轮询服务器
*   时机不是很关键
*   例如，如果我还想与掌上设备通信，我希望它使用一些开放标准。
*   我认为网络服务是一种方式，除非移动设备也运行服务器？！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T14:44:27.697

您最好的办法是在服务器上设置一个 ASP.NET Web 服务，然后让您的 PDA 应用程序与它通信。

您还可以使用网络服务与 PDA 对话。本质上，PDA 必须首先调用 Web 服务并传入一个委托方法，然后当它需要与 PDA 通信时服务器调用该委托方法。我不推荐后一种方法，尤其是在 PDA 没有持续连接到网络的环境中。通常最好让 PDA 发起与服务器的每次联系。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T16:14:19.620

定义“双向”。如果您需要一端来进行初始化，例如设备需要从服务器获取数据或向服务器发送数据，那么 Web Service 或 WCF 服务之类的东西就可以很好地工作并且非常容易。WCF 需要更少的开销和“服务器”端的安装（不需要 IIS）。但是，如果您需要服务器来启动通信，这将成为一个更大的问题，因为该设备通常是不可寻址的。

您必须考虑的其他一些注意事项是您的连接模型（当您未连接或在通信时失去连接时会发生什么）和可接受的延迟（我现在需要响应，还是从现在开始 5 分钟？）。

设备的传递性使其成为与 PC 到 PC 连接模型大不相同的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T14:54:21.560

我正在建立一个正是这样做的项目，并且我正在使用网络服务来进行对话。

您还可以使用*sqlClient*直接访问 SQL Server，使用SQL Server 2005 Compact Edition“远程数据访问”同步数据或使用 SQL Server Merge Replication。

我不确定这些东西之间有什么区别，但我从Wigley, Moth & Foot的[“Microsoft Mobile Development Handbook”中得到了列表。](http://www.microsoft.com/MSPress/books/10294.aspx)

# sql-server - SQL Server 2005 Express 可以执行完整备份吗？

> ID：233812
> 
> 赞同：3
> 
> 时间：2008-10-24T14:38:52.403
> 
> 标签：sql-server, backup

我需要一些帮助来执行我计划的备份策略。

我的数据库大小约为 1 gig。我想每周执行一次完整备份，每小时执行一次增量备份。

所有这些都内置在 SQL Server 2005 Express 中吗？

是否可以滚动备份以便我只保留 1 个月的备份？

这意味着每周完整备份每周有 1 个，在第 5 周它会覆盖最旧的完整备份。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T15:58:46.983

你可以做到，只是更难。

您没有维护计划，但这并不重要，因为它们通常会导致比解决问题更多的问题。您将需要自己编写备份脚本。

另一个问题是您将没有用于调度脚本的 SQL Server 代理。您可以使用 sqlcmd 和 windows 调度程序来解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T14:51:14.670

SQL Server express 无法设置维护计划，因此您必须手动执行脚本。AFAIK。

对于所有其他版本，一个简单的 DB Maint。可以设置计划来完成所有这些工作，它甚至会引导您完成整个过程。

# windows - “在进程加载期间引发了未处理的非持续异常”

> ID：233824
> 
> 赞同：1
> 
> 时间：2008-10-24T14:44:13.250
> 
> 标签：windows, winapi

当同事尝试启动他正在处理的 Windows 应用程序时，此错误消息会出现在他的计算机上：

> 在进程加载期间引发了未处理的不可持续异常

这是什么意思，如何去调查是什么原因造成的？

我用谷歌搜索了它，但没有找到明确的答案。这似乎与加载 DLL 的问题有关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-02-08T10:32:31.890

是的，我目前正在我自己的代码中查看这个问题 - 对于遇到这个问题的任何人，这里有一些提示：

1.  有一个相当复杂的线程在这里讨论它：http: [//bytes.com/topic/net/answers/555706-unhandled-non-continuable-exception-throw-during-process-load](http://bytes.com/topic/net/answers/555706-unhandled-non-continuable-exception-thrown-during-process-load)

2.  您是否链接到 Winmm.lib？它有问题，你能避免使用它吗？

3.  你在使用 C++/CLI 吗？如果是这样，请考虑延迟加载 C++/CLI 模块。

任何其他提示，请发布 - 这会不时出现，并且可能会出现问题！

更多详细信息请参见：[http ://www.dwmkerr.com/post/2012/02/08/Debugger-An-unhandled-non-continuable-exception-was-throw-during-process-load.aspx](http://www.dwmkerr.com/post/2012/02/08/Debugger-An-unhandled-non-continuable-exception-was-thrown-during-process-load.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T14:51:09.850

错误消息中是否有更多信息，可能在调试控制台中？如果有可用的堆栈跟踪，它可能会将您指向有问题的应用程序，或者更好的是，指向导致问题的 DLL。下一步是查看是否有可用于该 DLL 的更新。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-28T00:09:52.617

我发现在签入版本控制的 dll 上启用“读取和执行”权限可以解决这个问题。

我尝试的第一件事是将整个 Debug/ 目录复制到某个地方，应用程序在那里运行良好，然后我检查了每个原始 dll 的属性并启用了执行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-05T23:10:07.880

我遇到了同样的问题，结果是在 x86 项目中为 x64 编译的 DLL 是罪魁祸首。将 DLL 替换为 x86 版本解决了该问题。

# asp.net - 视图状态是否过期？

> ID：233828
> 
> 赞同：23
> 
> 时间：2008-10-24T14:45:03.543
> 
> 标签：asp.net, viewstate

假设您有一个不依赖会话的 aspx 页面，但确实依赖于视图状态来实现回发之间的持久性。

如果一个用户正在访问这个页面，并且离开了一个很长的午餐，当他返回时视图状态仍然有效吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-24T14:49:13.927

Viewstate 本身不会过期。由于它以表格形式发布，因此可以随时重新构建。

[根据 MSDN](http://msdn.microsoft.com/en-us/library/cteh3e77.aspx)：“ *..如果页面未在会话到期时间内回发，则视图状态可能会到期*”。因此，以某种方式，如果您的会话过期，它可能会过期，但视图状态不会直接过期。由于您无论如何都没有使用会话状态，因此您不必担心隐式过期。

请注意，我不会说它已过期。那是我在他们自己的题为[控制 ViewState的文章中引用的 MS](http://msdn.microsoft.com/en-us/library/cteh3e77.aspx)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-24T14:48:06.253

没有 ViewState 被保留为 PostBack 过程的一部分。但是，如果需要，您可以[覆盖](http://msdn.microsoft.com/en-us/library/ms972976.aspx#viewstate_topic10)Page 类的 SavePageStateToPersistenceMedium() 和 LoadPageStateFromPersistenceMedium() 以实现该行为。有关详细信息，请阅读[了解 ASP.NET ViewState](http://msdn.microsoft.com/en-us/library/ms972976.aspx)。

请注意，***Page*** ViewState 存储在 Session 中，因此如果您的 Session 过期，ViewState 将丢失。我不会说这是 ViewState 到期，但是是的，它会在 Session 超时后被销毁。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-24T14:51:14.390

Viewstate 不会过期。

所有视图状态数据都存储在客户端上，并在用户执行回发时提交回服务器。

[这有一些非常有趣的含义，在这里](http://weblogs.asp.net/infinitiesloop/archive/2006/08/03/truly-understanding-viewstate.aspx)进行了非常彻底的解释。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-24T14:58:31.287

此外，作为一个陷阱，默认情况下 ASP.NET 使用自动生成的密钥加密 ViewState。这可以用 web.congif 文件中的 MachineKey 元素覆盖。即使 ViewState 不会过期，但如果使用不同的自动生成的密钥来解密 ViewState，例如在 IIS 重置、重新部署应用程序或访问 Web 场中的不同服务器之后，它可能会变得无效。如果您计划长时间存储视图状态，请注意它是如何加密/解密的。

[http://msdn.microsoft.com/en-us/library/ms998288.aspx](http://msdn.microsoft.com/en-us/library/ms998288.aspx)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-03-21T12:24:56.233

**是的，ViewState 在某些情况下会过期。**例如，当您使用 iframe:s 时，或者当您通过定期回发保持与服务器的“实时”连接时。然后你可能想研究这个选项：`<sessionPageState historySize="9"/>`，它实际上硬编码了 Session 中存储了多少“回发结果”（如果使用 SessionPageStatePerster）。每个回发将其 ViewState 存储到 Session["__VIEWSTATEQUEUE"] 中的队列末尾，并删除“太旧”的 ViewState。你认为 SessionPageStatePerster 如何决定哪些 ViewStates 太旧了.. 通过在 web.config 中配置一些任意的 historySize-constant .. Omg！我也永远找不到这个问题...我对 asp.net 编程的仇恨现在无法形容.. grrr ...

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-24T14:49:44.470

Viewstate 不会过期，只要它们还在页面上，它就仍然存在并且可以正常工作。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-24T14:54:17.487

ViewState 将从 POST 持续到 POST。它实际上存储在表单上的隐藏字段中，因此它一直被 POST 回您的服务器。

只要您不依赖 Session 重建页面状态就不应该有任何问题。不过，如果您愿意，可以很容易地测试页面的状态代码：只需在 web.config 中将会话设置为 60 秒后过期，然后加载页面，等待一分钟多一点（浏览 Stack Overflow 并回答一些问题）然后单击页面上的按钮。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-06-20T05:17:04.217

很抱歉重温这个旧线程，但现在有新信息可用：

**是的，ViewStates expires**。我花了 19 个小时研究 ViewStates 在长时间间隔回发之间丢失其值的问题。我花了一段时间阅读 MSDN 文档和 Stackoverflow 的回答，说除非采用自定义 ViewState 存储实现，否则基本上不可能发生，现在我知道，这不是真的。

我的问题发生在 SharePoint 2013 环境中。称为*分布式缓存*（又名*AppFabric*）的服务会缓存 ViewState 并具有与之关联的*生存时间*。您可以在此处找到更多信息：http: [//blogs.msdn.com/b/besidethepoint/archive/2013/03/27/appfabric-caching-and-sharepoint-1.aspx](http://blogs.msdn.com/b/besidethepoint/archive/2013/03/27/appfabric-caching-and-sharepoint-1.aspx)

可以在以下短语中找到有趣的信息： ***“为了提高页面性能，从 SharePoint 2013 开始，SharePoint 会在服务器端缓存 ViewState 数据，而不是将其来回传输到客户端。”***

我希望这些信息可以帮助像 19 小时前一样绝望的人。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-24T14:51:46.400

ViewState 保存在页面本身的隐藏字段中。因此，只要用户拥有该页面，他就会拥有 ViewState。但是，如果您的应用程序在一段时间后自动将用户注销，那么仍然拥有 ViewState 可能对他没有任何好处。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-24T14:51:51.317

默认情况下，Viewstate 作为隐藏输入包含在 html 内容中。这意味着它不会过期，但视图状态中的所有内容都必须从用户的浏览器上传。由于这通常是公共站点中连接速度最慢的部分，因此在视图状态中放置大量内容会很快使您的站点看起来很慢。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-24T14:51:53.873

最简洁的答案是不。

更长的答案是：这取决于 ViewState 存储的实现。您可以提供 ViewState 的自定义实现，该实现可能会在给定的时间后过期。例如，您可以将 ViewState 存储在数据库或磁盘上，并仅发送对隐藏字段中存储值的一些引用。然后，您可以使用批处理来删除过时的 ViewState 数据或根据请求执行过期。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-09-18T11:39:17.763

没有视图状态不会过期。重定向到其他页面后，视图状态的值会丢失或视图状态过期。更多详情[http://www.c-sharpcorner.com/UploadFile/78d182/Asp-Net-state-management-techniques/](http://www.c-sharpcorner.com/UploadFile/78d182/Asp-Net-state-management-techniques/)

# .net - 使用 .NET 互操作在 Adob e Reader 9 中以编程方式打印

> ID：233842
> 
> 赞同：2
> 
> 时间：2008-10-24T14:48:57.123
> 
> 标签：.net, vb.net, interop, activex, adobe-reader

我正在使用 VB.Net WinForms。我想调用 Adob​​e Reader 9 ActiveX 控件来打印一些 PDF。我已将 ActiveX 控件添加到 VS 工具箱（dll 为 AcroPDF.dll，COM 名称为“Adobe PDF Reader”。经过一些实验，以下代码有效。

```
Dim files As String() = Directory.GetFiles(TextBoxPath.Text, "*.pdf", SearchOption.TopDirectoryOnly)

Using ActiveXPDF As New AxAcroPDFLib.AxAcroPDF

    Me.Controls.Add(ActiveXPDF)
    ActiveXPDF.Hide()

    For Each filename As String In files

        ActiveXPDF.LoadFile(filename)
        ActiveXPDF.printAll()

        'Begin Yukky Hack    '

        Dim endTime As Date = DateAdd(DateInterval.Second, 20, Now)
        Do While Now < endTime
            My.Application.DoEvents()
        Loop

        'End Yuk   '

    Next

End Using 
```

如果没有 Yuk 位，这只会打印一些 PDF，看起来 End Using 语句在完成打印之前正在调用控件上的 dispose。

因此，对 printAll 的调用似乎是非阻塞的，但我找不到可以查询的回调或状态属性，以查看打印假脱机是否已完成。我错过了一个属性/方法，或者是否有更优雅（且响应更快）的解决方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-28T12:34:36.890

使用这种方法打印多个文档并不像您发现的那样好用。

让它工作是相当棘手的，但这里是解决方案的一般描述。

我使用 System.Diagnostics.Process 使用 myProcess.StartInfo.Verb = "Print" 进行打印 然后我分两步检查打印机队列的状态和状态，以确保打印准备就绪，可以打印下一个文档。使用 WMI 和 ManagementObjectSearcher 使用“SELECT * FROM Win32_Printer”枚举打印机信息。逻辑是，在继续打印下一个之前，我尝试查看假脱机是否开始。

有关 Win32_Printer WMI 类，请参阅[http://msdn.microsoft.com/en-us/library/aa394363.aspx](http://msdn.microsoft.com/en-us/library/aa394363.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-02-10T12:34:15.003

我在 Delphi 中使用 AcroPDF 时遇到了同样的问题。然后我发现当我使用消息“停止”处理时，AcroPDF 开始打印。

所以我只是创建了一个模态 TForm，它会在几秒钟后自行关闭。

```
var
  formModal : TFormModal;
begin
  formModal := TFormModal.Create(self);
  //PrintMethodHere  
  frmPecas.CarregarDocumentoParaImpressao();
  formModal.ShowModal;
end; 
```

TFormModal 就是这个，我只是在表单上插入一个加载图标来代表“打印”之类的东西。

```
unit FModal;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, ExtCtrls, Animate, GIFCtrl;

type
  TFormModal = class(TForm)
    Timer: TTimer;
    imgGif: TRxGIFAnimator;
    procedure TimerTimer(Sender: TObject);
    procedure FormShow(Sender: TObject);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure FormCreate(Sender: TObject);
    procedure FormKeyDown(Sender: TObject; var Key: Word;
      Shift: TShiftState);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  FormModal: TFormModal;

implementation

{$R *.dfm}
//    Author: Anderson Mello  Date: 09-fev-2012
//  DEscription: Using TTimer after 5 seconds I close this form
procedure TFormModal.TimerTimer(Sender: TObject);
begin
 close;
end;

//    Author: Anderson Mello  Date: 09-fev-2012
//  Description: Enable the timer only when the form is shown
procedure TFormModal.FormShow(Sender: TObject);
begin
 Timer.Enabled := true;
end;

//  Description: disable when close
procedure TFormModal.FormClose(Sender: TObject; var Action: TCloseAction);
begin
 Timer.Enabled := false;
end;

//    Author: Anderson Mello  Date: 09-fev-2012
//  Description: disable close button "X", so the user can't close 
procedure TFormModal.FormCreate(Sender: TObject);
var
  hSysMenu:HMENU;
begin
  hSysMenu:=GetSystemMenu(Self.Handle,False);
  if hSysMenu <> 0 then begin
    EnableMenuItem(hSysMenu,SC_CLOSE,MF_BYCOMMAND or MF_GRAYED);
    DrawMenuBar(Self.Handle);
  end;
  KeyPreview:=True;
end;

//    Author: Anderson Mello  Date: 09-fev-2012
//  Description: disable shortcuts to close
procedure TFormModal.FormKeyDown(Sender: TObject; var Key: Word;
  Shift: TShiftState);
begin
  if (Key = VK_F4) and (ssAlt in Shift) then
    Key:=0;
end; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T15:55:41.967

我们最终将 Adob​​e 的 PDF Verifier 用于我们自己的测试目的。为了做到这一点，我们必须实际启动 acrobat 并使用[SendInput](http://www.pinvoke.net/default.aspx/user32.SendInput)以编程方式操作它的界面。

我很想看看是否可以使用内部 API。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-12-07T19:49:39.487

您可以使用此代码通过相应的软件显示任何文件。

```
Sub Show_Document(ByVal FILENAME As String)
    Dim p As Process = Nothing
    Try
        If My.Computer.FileSystem.FileExists(FILENAME) Then
            p = Process.Start(FILENAME)
            p.Dispose()
        End If

    Catch ex As Exception

    Finally

    End Try

End Sub 
```

# tsql - TSQL：如何在没有游标的情况下使用生成的 sql 命令字符串填充变量

> ID：233843
> 
> 赞同：4
> 
> 时间：2008-10-24T14:48:59.137
> 
> 标签：tsql

我试图在存储过程中获取生成的 sql 的值。
执行这个

```
 DECLARE @sSQL varchar(5000), @retval int
   DECLARE @tablename varchar(50)

   SELECT @tablename = 'products'

   SELECT @sSQL = 'SELECT @retval = MAX(ID)'
   SELECT @sSQL = @sSQL + ' FROM ' + @tablename
   EXEC (@sSQL) 

   SELECT @retval 
```

我明白了

```
 Must declare the variable '@retval'. 
```

如何在不使用游标的情况下获取值（我试图避免）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-24T15:07:14.747

您将需要使用 sp_executesql：

```
DECLARE @retval int   
DECLARE @sSQL nvarchar(500);
DECLARE @ParmDefinition nvarchar(500);

DECLARE @tablename nvarchar(50)  
SELECT @tablename = N'products'  

SELECT @sSQL = N'SELECT @retvalOUT = MAX(ID) FROM ' + @tablename;  
SET @ParmDefinition = N'@retvalOUT int OUTPUT';

EXEC sp_executesql @sSQL, @ParmDefinition, @retvalOUT=@retval OUTPUT;

SELECT @retval; 
```

# javascript - 配置 Visual Studio 2008 以编辑旧版 JScript ASP 文件

> ID：233845
> 
> 赞同：2
> 
> 时间：2008-10-24T14:49:06.920
> 
> 标签：javascript, visual-studio-2008, asp-classic, intellisense

我正在开发一个通过 COM 互操作将 .NET 与一些遗留 ASP 代码相结合的项目。旧版 ASP 是用 JScript 编写的 - 文件看起来像这个 helloworld.asp 示例。

```
<%@Language="JScript"%>
<html>
<head>
  <title>Jscript ASP Page</title>
</head>
<body>
  <h1>JScript ASP</h1>
  <p>This is JScript ASP at <%=new Date()%></p>
  <%
  var helloWorld = Server.CreateObject("Interop.HelloWorld")
  helloWorld.Name = "Dylan"
  %>
  <%=helloWorld.SayHello() %>
  </body>
</html> 
```

我真的很想使用 VS2008 来编辑遗留的 ASP 代码以及项目的其余部分，但是 Intellisense 的行为非常奇怪。一分钟它会给我正确的 JScript 关键字和方法：

[VS2008 中的 JS Intellisense - 工作 http://www.dylanbeattie.net/vs_js_working.jpg](http://www.dylanbeattie.net/vs_js_working.jpg)

...所以我将键入一行，按 Enter，开始键入下一行，完全相同的击键将为我提供看起来是 VBScript 智能感知的内容：

[VS2008 中的 ASP 智能感知 - 损坏 http://www.dylanbeattie.net/vs_js_wrong.jpg](http://www.dylanbeattie.net/vs_js_wrong.jpg)

有什么办法可以告诉 VS .asp 文件始终是 Javascript 代码，而根本不使用 VB 代码？当您按 Enter 键时让 IDE 将“var”转换为“vArray”有点令人沮丧……

帮助我，Stackoverflow。你是我唯一的希望。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-10-29T21:23:59.947

正如您所观察到的，经典的 ASP 智能感知在 VS2008 中被破坏。微软实际上在 VS2008 RTM 中完全切断了对 Classic ASP 语法着色和智能感知的支持，然后由于客户的强烈抗议，在 SP1 中恢复了它。查看Microsoft Connect 站点上的[此错误报告](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=329236#details)，了解有关它如何恢复的更多信息。

无论如何，让我详细说明它是如何损坏的。您所看到的实际上并不是 VB 智能感知——相反，您看到的方法和对象存在于以下任何内容中：

*   [服务器端 Response 对象](http://www.newobjects.com/pages/ndl/alp/ref-Response.htm)有时是其他服务器端对象，如 Session 或 Request，就好像在您的任何代码之前对这些对象有一个 javascript "with" 语句。这毫无意义——这是 VS 中的一个错误。
*   客户端[窗口对象](http://msdn.microsoft.com/en-us/library/ms535873(VS.85).aspx)(!!!!)。这是没有意义的，因为这是服务器端脚本。这是VS中的一个错误。
*   javascript 关键字和全局对象，如字符串。这是意料之中的（尽管如果您使用 runat=server 定义脚本，它会更可靠地工作——如果我使用 <% %> 定义脚本，我通常不会得到正确的关键字智能感知。

请注意，这些都不是 VB 智能感知——您所看到的只是经典 ASP 的服务器端脚本对象模型中内置的请求、响应等对象的有效内置方法的 PascalCased 方法。

有趣的是，我发现智能感知在 runat=server 脚本块中比 <% %> 块更自然地工作。至少使用 runat=server，我可以通过键入“Request.”、“Response.”等获得智能感知，而且 jscript 关键字智能感知似乎在这些块中也能更好地工作。

智能感知中还有其他怪癖，例如当您有一个 <% %> 脚本块时，当您键入一个字符时，该字符会在您返回的智能感知选择列表中被忽略。（这在 runat=server 块中也更有效）

换句话说，这一切都非常破碎。我没有关于它为什么如此失败的内部信息，除了这是一个在 VS2008 中被弃用的功能，在服务包中被带回，并且可能比 VS 的其他部分进行的测试要少得多——所以它被破坏并不奇怪。尤其是当您考虑到它支持一项功能时，即经典的 ASP，Microsoft 可能希望放弃该功能。这并不意味着 Redmontonians 正在积极尝试破坏这一点，但在资源有限的团队中，让经典 ASP 工作得很好可能不会像 ASP.NET MVC 那样吸引同等程度的关注。

也就是说，恕我直言，即使是这种有限的支持也比 VS2008 RTM 中的支持要好，当时经典的 ASP 文件看起来像记事本，根本没有智能感知或语法着色。

如果您对这种令人遗憾的状况感到恼火，我建议您在[https://connect.microsoft.com/VisualStudio](https://connect.microsoft.com/VisualStudio)提交错误报告。就像一个错误报告让微软在 VS2008 SP1 中恢复经典的 ASP 智能感知一样，它可能会让他们为 SP2 和/或 VS2010 修复它。您可能还想查看最新的 VS2010 测试版，看看问题是否已解决或更糟。

抱歉，如果这不是您希望的答案。:-(

# algorithm - 俄罗斯方块旋转算法

> ID：233850
> 
> 赞同：48
> 
> 时间：2008-10-24T14:49:54.127
> 
> 标签：algorithm, rotation, tetris

表示和旋转俄罗斯方块游戏的最佳算法（和解释）是什么？我总是觉得作品旋转和表示方案令人困惑。

大多数俄罗斯方块游戏似乎在每次旋转时都使用天真的“重新制作方块数组”：

[http://www.codeplex.com/Project/ProjectDirectory.aspx?ProjectSearchText=俄罗斯方块](http://www.codeplex.com/Project/ProjectDirectory.aspx?ProjectSearchText=tetris)

但是，有些使用预先构建的编码数字和位移来表示每个部分：

[http://www.codeplex.com/wintris](http://www.codeplex.com/wintris)

有没有一种方法可以使用数学来做到这一点（不确定是否可以在基于单元的板上工作）？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-10-24T14:55:07.657

形状的数量是有限的，所以我会使用一个固定的表格而不进行计算。这样可以节省时间。

但是有旋转算法。

选择一个中心点并旋转 pi/2。

如果一块棋子从 (1,2) 开始，它会顺时针移动到 (2,-1) 和 (-1,-2) 和 (-1, 2)。将其应用于每个块并旋转该块。

每个 x 是前一个 y，每个 y - 前一个 x。这给出了以下矩阵：

```
[  0   1 ]
[ -1   0 ] 
```

对于逆时针旋转，使用：

```
[  0  -1 ]
[  1   0 ] 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2011-11-15T04:02:41.433

当我试图弄清楚旋转对我的俄罗斯方块游戏如何起作用时，这是我在堆栈溢出中发现的第一个问题。尽管这个问题很老，但我认为我的输入将帮助其他人试图通过算法解决这个问题。首先，我不同意硬编码每个部分和旋转会更容易。Gamecat 的回答是正确的，但我想详细说明一下。以下是我用来解决 Java 中的旋转问题的步骤。

1.  对于每个形状，确定其原点的位置。我使用[此页面](http://tetris.wikia.com/wiki/SRS)上图表上的点来分配我的原点。请记住，根据您的实现，您可能必须在每次用户移动该片段时修改原点。

2.  旋转假设原点位于点 (0,0)，因此您必须先平移每个块，然后才能旋转它。例如，假设您的原点当前位于点 (4, 5)。这意味着在形状可以旋转之前，每个块必须在 x 坐标中平移 -4，在 y 坐标中平移 -5，以相对于 (0,0)。

3.  在 Java 中，典型的坐标平面从最左上角的点 (0,0) 开始，然后向右和向下增加。为了在我的实现中补偿这一点，我在旋转之前将每个点乘以 -1。

4.  这是我用来计算逆时针旋转后新的 x 和 y 坐标的公式。有关这方面的更多信息，我会查看[Rotation Matrix](http://en.wikipedia.org/wiki/Rotation_matrix)上的 Wikipedia 页面。x' 和 y' 是新坐标：

    x' = x * cos(PI/2) - y * sin(PI/2) 和 y' = x * sin(PI/2) + y * cos(PI/2) 。

5.  对于最后一步，我只是以相反的顺序完成了第 2 步和第 3 步。所以我再次将结果乘以 -1，然后将块转换回它们的原始坐标。

这是对我有用的代码（在 Java 中），以了解如何用您的语言进行操作：

```
public synchronized void rotateLeft(){

    Point[] rotatedCoordinates = new Point[MAX_COORDINATES];

    for(int i = 0; i < MAX_COORDINATES; i++){

        // Translates current coordinate to be relative to (0,0)
        Point translationCoordinate = new Point(coordinates[i].x - origin.x, coordinates[i].y - origin.y);

        // Java coordinates start at 0 and increase as a point moves down, so
        // multiply by -1 to reverse
        translationCoordinate.y *= -1;

        // Clone coordinates, so I can use translation coordinates
        // in upcoming calculation
        rotatedCoordinates[i] = (Point)translationCoordinate.clone();

        // May need to round results after rotation
        rotatedCoordinates[i].x = (int)Math.round(translationCoordinate.x * Math.cos(Math.PI/2) - translationCoordinate.y * Math.sin(Math.PI/2)); 
        rotatedCoordinates[i].y = (int)Math.round(translationCoordinate.x * Math.sin(Math.PI/2) + translationCoordinate.y * Math.cos(Math.PI/2));

        // Multiply y-coordinate by -1 again
        rotatedCoordinates[i].y *= -1;

        // Translate to get new coordinates relative to
        // original origin
        rotatedCoordinates[i].x += origin.x;
        rotatedCoordinates[i].y += origin.y;

        // Erase the old coordinates by making them black
        matrix.fillCell(coordinates[i].x, coordinates[i].y, Color.black);

    }
    // Set new coordinates to be drawn on screen
    setCoordinates(rotatedCoordinates.clone());
} 
```

这个方法就是将你的形状向左旋转所需的全部，结果证明它比为每个形状定义每个旋转要小得多（取决于你的语言）。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-10-24T15:17:37.783

这就是我最近在基于 jQuery/CSS 的俄罗斯方块游戏中的做法。

计算块的中心（用作枢轴点），即块形状的中心。称之为（px，py）。

构成块形状的每块砖都将围绕该点旋转。对于每块砖，您可以应用以下计算...

其中每块砖的宽度和高度为 q，砖的当前位置（左上角）为 (x1, y1)，新砖的位置为 (x2, y2)：

```
x2 = (y1 + px - py)

y2 = (px + py - x1 - q) 
```

要向相反方向旋转：

```
x2 = (px + py - y1 - q)

y2 = (x1 + py - px) 
```

该计算基于 2D 仿射矩阵变换。如果您对我如何做到这一点感兴趣，请告诉我。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-10-24T14:56:59.790

就我个人而言，我一直只是手动表示旋转 - 形状很少，这样编码很容易。基本上我有（作为伪代码）

```
class Shape
{
    Color color;
    ShapeRotation[] rotations;
}

class ShapeRotation
{
    Point[4] points;
}

class Point
{
    int x, y;
} 
```

至少在概念上 - 直接形状的多维点数组也可以解决问题:)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2010-05-02T11:57:38.337

您只能通过对其应用数学运算来旋转矩阵。如果你有一个矩阵，说：

```
Mat A = [1,1,1]
        [0,0,1]
        [0,0,0] 
```

要旋转它，先乘以它的转置，然后乘以这个矩阵（[I]dentity [H]orizo​​ntaly [M]irrored）：

```
IHM(A) = [0,0,1]
         [0,1,0]
         [1,0,0] 
```

然后你将拥有：

```
Mat Rotation = Trn(A)*IHM(A) = [1,0,0]*[0,0,1] = [0,0,1]
                               [1,0,0] [0,1,0] = [0,0,1]
                               [1,1,0] [1,0,0] = [0,1,1] 
```

注意：旋转中心将是矩阵的中心，在本例中为 (2,2)。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2015-12-08T19:51:43.100

**表示**

表示最小矩阵中的每个部分，其中 1 表示四联体占据的空间，0 表示空白空间。例子：

```
originalMatrix = 
[0,   0,   **1**]
[**1**,   **1**,   **1**] 
```

> [![在此处输入图像描述](https://i.stack.imgur.com/BfZKD.jpg)](https://i.stack.imgur.com/BfZKD.jpg)

**旋转公式**

```
clockwise90DegreesRotatedMatrix = reverseTheOrderOfColumns(Transpose(originalMatrix))

anticlockwise90DegreesRotatedMatrix = reverseTheOrderOfRows(Transpose(originalMatrix)) 
```

**插图**

```
originalMatrix = 
  x    y    z
a[0,   0,   **1**]
b[**1**,   **1**,   **1**] 
```

```
transposed = transpose(originalMatrix)
  a   b
x[0,  **1**]
y[0,  **1**]
z[**1**,  **1**] 
```

```
counterClockwise90DegreesRotated = reverseTheOrderOfRows(transposed)
  a   b
z[**1**,  **1**]
y[0,  **1**]
x[0,  **1**] 
```

[![在此处输入图像描述](https://i.stack.imgur.com/cTiEk.jpg)](https://i.stack.imgur.com/cTiEk.jpg)

```
clockwise90DegreesRotated = reverseTheOrderOfColumns(transposed)
  b   a
x[**1**,  0]
y[**1**,  0]
z[**1**,  **1**] 
```

[![在此处输入图像描述](https://i.stack.imgur.com/fTvMj.jpg)](https://i.stack.imgur.com/fTvMj.jpg)

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-10-24T15:00:36.553

由于每个形状只有 4 个可能的方向，为什么不使用形状的状态数组并旋转 CW 或 CCW 简单地增加或减少形状状态的索引（索引环绕）？我认为这可能比执行旋转计算等更快。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-11-16T04:26:31.400

如果您在 python 中执行此操作，基于单元格而不是坐标对，旋转嵌套列表非常简单。

```
rotate = lambda tetrad: zip(*tetrad[::-1])

# S Tetrad
tetrad = rotate([[0,0,0,0], [0,0,0,0], [0,1,1,0], [1,1,0,0]]) 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-12-31T13:34:27.187

如果我们假设 tetromino 的中心正方形的坐标 (x0, y0) 保持不变，那么 Java 中其他 3 个正方形的旋转将如下所示：

```
private void rotateClockwise()
{
    if(rotatable > 0)   //We don't rotate tetromino O. It doesn't have central square.
    {
        int i = y1 - y0;
        y1 = (y0 + x1) - x0;
        x1 = x0 - i;
        i = y2 - y0;
        y2 = (y0 + x2) - x0;
        x2 = x0 - i;
        i = y3 - y0;
        y3 = (y0 + x3) - x0;
        x3 = x0 - i;  
    }
}

private void rotateCounterClockwise()
{
    if(rotatable > 0)
    {
        int i = y1 - y0;
        y1 = (y0 - x1) + x0;
        x1 = x0 + i;
        i = y2 - y0;
        y2 = (y0 - x2) + x0;
        x2 = x0 + i;
        i = y3 - y0;
        y3 = (y0 - x3) + x0;
        x3 = x0 + i;
    }
} 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2010-01-03T22:33:20.840

[我从这里](https://stackoverflow.com/questions/1457605/rotating-cordinates-around-pivot-tetris)的矩阵旋转导出了一个旋转算法。总结一下：如果您有组成块的所有单元格的坐标列表，例如 [(0, 1), (1, 1), (2, 1), (3, 1)] 或 [( 1, 0), (0, 1), (1, 1), (2, 1)]:

```
 0123       012
0....      0.#.
1####  or  1###
2....      2...
3.... 
```

您可以使用计算新坐标

```
x_new = y_old
y_new = 1 - (x_old - (me - 2)) 
```

对于顺时针旋转和

```
x_new = 1 - (y_old - (me - 2))
y_new = x_old 
```

逆时针旋转。`me`是块的最大范围，即`4`对于 I 块、`2`对于 O 块和`3`所有其他块。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-01-06T00:32:30.723

对于 3x3 大小的俄罗斯方块块，翻转你的块的 x 和 y，然后交换外列，这就是我一段时间以来的想法

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-10-07T10:19:39.340

如果数组大小为 3*3 ，则最简单的旋转方式（例如逆时针方向）是：

```
oldShapeMap[3][3] = {{1,1,0},
                     {0,1,0},
                     {0,1,1}};

bool newShapeMap[3][3] = {0};
int gridSize = 3;

for(int i=0;i<gridSize;i++)
    for(int j=0;j<gridSize;j++)
        newShapeMap[i][j] = oldShapeMap[j][(gridSize-1) - i];
/*newShapeMap now contain:    
                               {{0,0,1},
                                {1,1,1},
                                {1,0,0}};

*/ 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-24T14:56:09.467

我为所有形状中的四个点使用了一个形状位置和一组四个坐标。由于它在 2D 空间中，因此您可以轻松地将 2D 旋转矩阵应用于点。

这些点是 div，因此它们的 css 类从关闭变为打开。（这是在清除了他们上一回合所在的 css 类之后。）

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-02-17T21:25:29.280

至少在 Ruby 中，您实际上可以使用矩阵。将您的棋子形状表示为数组的嵌套数组，例如 [[0,1],[0,2],[0,3]]

```
require 'matrix'
shape = shape.map{|arr|(Matrix[arr] * Matrix[[0,-1],[1,0]]).to_a.flatten} 
```

但是，我同意对形状进行硬编码是可行的，因为每个形状有 7 个形状和 4 个状态 = 28 行，而且永远不会超过这个。

有关这方面的更多信息，请参阅我在 https://content.pivotal.io/blog/the-simplest-thing-that-c​​ould-possibly-work-in-tetris 上的博客文章以及在 [https](https://github.com/andrewfader/Tetronimo)[上](https://content.pivotal.io/blog/the-simplest-thing-that-could-possibly-work-in-tetris)的完整工作实现（带有小错误）[://github.com/andrewfader/Tetronimo](https://github.com/andrewfader/Tetronimo)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-10-30T01:13:33.917

Python：

```
pieces = [
    [(0,0),(0,1),(0,2),(0,3)],
    [(0,0),(0,1),(1,0),(1,1)],
    [(1,0),(0,1),(1,1),(1,2)],
    [(0,0),(0,1),(1,0),(2,0)],
    [(0,0),(0,1),(1,1),(2,1)],
    [(0,1),(1,0),(1,1),(2,0)]
]

def get_piece_dimensions(piece):
    max_r = max_c = 0
    for point in piece:
        max_r = max(max_r, point[0])
        max_c = max(max_c, point[1])
    return max_r, max_c

def rotate_piece(piece):
    max_r, max_c = get_piece_dimensions(piece)
    new_piece = []
    for r in range(max_r+1):
        for c in range(max_c+1):
            if (r,c) in piece:
                new_piece.append((c, max_r-r))
    return new_piece 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-02-15T15:35:40.440

在 Java 中：

```
private static char[][] rotateMatrix(char[][] m) {
    final int h = m.length;
    final int w = m[0].length;
    final char[][] t = new char[h][w];

    for(int y = 0; y < h; y++) {
        for(int x = 0; x < w; x++) {
            t[w - x - 1][y]  = m[y][x];
        }
    }
    return t;
} 
```

在 Java 中作为单页应用程序的简单俄罗斯方块实现： [https ://github.com/vadimv/rsp-tetris](https://github.com/vadimv/rsp-tetris)

# asp.net - Session ID 是在服务器端还是客户端生成？

> ID：233867
> 
> 赞同：5
> 
> 时间：2008-10-24T14:52:45.603
> 
> 标签：asp.net, session, server-side, sessionid, client-side

此网页[http://www.w3schools.com/ASP/prop_sessionid.asp](http://www.w3schools.com/ASP/prop_sessionid.asp)声明会话 ID 是在服务器端生成的。

如果是这种情况，那么服务器如何知道它在第二个请求响应周期中仍然是同一个客户端？

肯定会在 ClientSide 上生成 SessionId 以便客户端确定将相同的值传递给服务器？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-24T14:54:33.137

SessionID 是在服务器端生成的，但存储在 Cookie 中的客户端上。然后每次客户端向服务器发出请求时，SessionID 都用于验证客户端的现有会话。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-24T14:55:31.730

会话 ID 通常在服务器上生成。然后它被发送到客户端，或者作为 HTTP 标头中的 cookie，或者通过将其包含在 HTML 中，即链接变为 href=my.html?sessionid=1234。

然后，客户端的下一个请求将包含会话 ID，无论是在 cookie 中还是在请求的 GET 部分中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T14:54:56.427

如果不存在，服务器将生成一个会话 ID。但是一旦生成，客户端就可以将该 id 传递回服务器。如果客户端修改了该 id，您可能会从服务器收到一个错误，并生成一个新的 id。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T14:55:12.073

ID 在服务器上生成。然后，客户端将其存储在服务器在后续请求中获取的会话 cookie 中。

如果服务器在无 cookie 模式下运行，则会话密钥成为 URL 的一部分，服务器从那里解析它。

添加： ...如果服务器希望使用会话 cookie，但客户端禁用了 cookie，那么从服务器的角度来看，所有请求都是新会话，因为它无法判断这是同一用户。

# iphone - 在 iPhone 上调用邮件应用程序

> ID：233868
> 
> 赞同：1
> 
> 时间：2008-10-24T14:53:06.773
> 
> 标签：iphone

我正在编写的应用程序调用向用户发送电子邮件的 Web 服务。对 Web 服务的调用完成后，我想调出 Mail 应用程序，以便用户可以阅读电子邮件。我知道我可以使用 mailto:，但随后会创建一个新电子邮件供用户撰写。有没有办法调用 Mail 应用程序，以便它在 Mailboxes 视图中启动，允许用户导航到他们的收件箱？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T15:30:12.533

你不能这样做。SDK 中没有在 URL 关联之外启动另一个应用程序的功能。您在短期内所能期望的最好的结果是它们为您创建了一种将电子邮件面板嵌入到您的应用程序中的方法。

# sql - 如何在不复制数据的情况下创建 Oracle 表的副本？

> ID：233870
> 
> 赞同：294
> 
> 时间：2008-10-24T14:53:17.023
> 
> 标签：sql, oracle, copy, database-table

我知道这样的说法：

```
create table xyz_new as select * from xyz; 
```

哪个复制结构和数据，但如果我只想要结构怎么办？

* * *

## 回答 #1

> 赞同：459
> 
> 时间：2008-10-24T14:55:55.660

只需使用不会选择任何行的 where 子句：

```
create table xyz_new as select * from xyz where 1=0; 
```

### 限制

以下内容不会复制到新表中：

*   序列
*   触发器
*   索引
*   某些约束可能无法复制
*   物化视图日志

这也不处理分区

* * *

* * *

## 回答 #2

> 赞同：88
> 
> 时间：2008-10-27T15:47:40.957

我使用了您经常接受的方法，但正如有人指出的那样，它不会重复约束（我认为 NOT NULL 除外）。

如果要复制完整结构，更高级的方法是：

```
SET LONG 5000
SELECT dbms_metadata.get_ddl( 'TABLE', 'MY_TABLE_NAME' ) FROM DUAL; 
```

这将为您提供完整的创建语句文本，您可以根据需要对其进行修改以创建新表。当然，您必须更改表的名称和所有约束。

（您也可以在旧版本中使用 EXP/IMP 执行此操作，但现在要容易得多。）

**编辑添加** 如果您之后的表在不同的模式中：

```
SELECT dbms_metadata.get_ddl( 'TABLE', 'MY_TABLE_NAME', 'OTHER_SCHEMA_NAME' ) FROM DUAL; 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2013-12-21T17:49:17.773

```
create table xyz_new as select * from xyz where rownum = -1; 
```

为了避免一次又一次地迭代并且根据 1=2 的条件不插入任何内容

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2008-10-24T14:54:38.360

使用 sql developer 选择表并单击 DDL 选项卡

当您在 sql 工作表中运行该代码时，您可以使用该代码创建一个没有数据的新表

sqldeveloper 是来自 oracle 的免费应用程序。

如果表有序列或触发器，则 d​​dl 有时也会为您生成这些。您只需要注意您制作它们的顺序并知道何时打开或关闭触发器。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-12-10T23:14:18.280

你可以这样做 `Create table New_table as select * from Old_table where 1=2 ;` **但要小心** 你创建的表没有任何索引，PK等像old_table。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-12-05T19:17:52.203

```
 DECLARE
    l_ddl   VARCHAR2 (32767);
BEGIN
    l_ddl      := REPLACE (
                      REPLACE (
                          DBMS_LOB.SUBSTR (DBMS_METADATA.get_ddl ('TABLE', 'ACTIVITY_LOG', 'OLDSCHEMA'))
                        , q'["OLDSCHEMA"]'
                        , q'["NEWSCHEMA"]'
                      )
                    , q'["OLDTABLSPACE"]'
                    , q'["NEWTABLESPACE"]'
                  );

    EXECUTE IMMEDIATE l_ddl;
END; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-02-07T14:34:06.387

只需编写如下查询：

```
create table new_table as select * from old_table where 1=2; 
```

where`new_table`是您要创建的新表`old_table`的名称，是您要复制其结构的现有表的名称，这将仅复制结构。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-08-31T23:21:21.183

```
SELECT * INTO newtable
FROM oldtable
WHERE 1 = 0; 
```

使用另一个模式创建一个新的空表。只需添加一个导致查询不返回数据的 WHERE 子句：

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-10-06T20:02:53.050

如果需要创建一个表（具有空结构）只是为了**EXCHANGE PARTITION**，最好使用“..FOR EXCHANGE..”子句。不过，它仅从*Oracle **12.2***版开始可用。

```
CREATE TABLE t1_temp FOR EXCHANGE WITH TABLE t1; 
```

如果正常 CTAS 操作未完全复制表结构，这将在“交换分区”期间无缝解决“ORA-14097”。我看到 Oracle 缺少原始表中的一些“DEFAULT”列和“HIDDEN”列定义。

> ORA-14097: ALTER TABLE EXCHANGE PARTITION 中的列类型或大小不匹配

[请参阅此以进一步阅读...](https://oracle-base.com/articles/12c/create-table-for-exchange-with-table-12cr2#create-table-for-exchange-with-table)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-02-24T06:46:27.257

你也可以做一个

```
create table abc_new as select * from abc; 
```

然后截断表格`abc_new`。希望这能满足您的要求。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-06-11T08:29:40.580

使用 pl/sql developer，您可以在 sql 工作区或对象资源管理器中右键单击 table_name，然后单击“查看”，然后单击“查看 sql”，生成 sql 脚本以创建表以及所有约束，索引，分区等。

接下来，您使用 new_table_name 运行脚本

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-08-19T14:06:29.933

以其他方式，您可以从下面列出的命令中获取表创建的 ddl，然后执行创建。

```
SELECT DBMS_METADATA.GET_DDL('TYPE','OBJECT_NAME','DATA_BASE_USER') TEXT FROM DUAL 
```

*   `TYPE`是`TABLE`，`PROCEDURE`等等。

使用此命令，您可以从数据库对象中获取大部分 ddl。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-04-16T14:07:26.913

## **复制没有表数据**

```
create table <target_table> as select * from <source_table> where 1=2; 
```

## **用表数据复制**

```
create table <target_table> as select * from <source_table>; 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-02-16T17:02:52.990

`WHERE 1 = 0`或类似的错误条件有效，但我不喜欢它们的外观。Oracle 12c+ 恕我直言的稍微干净的代码是

`CREATE TABLE bar AS SELECT * FROM foo FETCH FIRST 0 ROWS ONLY;`

同样的限制适用：只有列定义及其可空性被复制到新表中。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2015-04-21T05:24:39.083

```
Create table target_table 
As
Select * 
from source_table 
where 1=2; 
```

Source_table 是您要复制其结构的表。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2019-08-13T19:54:03.983

> 1.  从 xyz 中选择 * 创建表 xyz_new；

-- 这将创建表并复制所有数据。

> 2.  从 xyz_new 中删除；

-- 这将具有相同的表结构，但所有复制的数据都将被删除。

如果您想克服答案指定的限制： [如何在不复制数据的情况下创建 Oracle 表的副本？](https://stackoverflow.com/questions/233870/how-can-i-create-a-copy-of-an-oracle-table-without-copying-the-data#answer-233890)

* * *

## 回答 #17

> 赞同：-6
> 
> 时间：2012-08-28T20:07:02.657

上面的任务可以通过两个简单的步骤完成。

### 第1步：

```
CREATE table new_table_name AS(Select * from old_table_name); 
```

`query`上面创建了一个表的副本（也包含内容）。

要获取结构，请使用删除表的内容。

### 第2步：

```
DELETE * FROM new_table_name. 
```

希望这能解决您的问题。并感谢之前的帖子。给了我很多见识。

# java - Spring + Tiles2 + Freemarker - 通过 Freemarker Servlet 或 Spring 的 FreeMarkerViewResolver 集成？

> ID：233881
> 
> 赞同：7
> 
> 时间：2008-10-24T14:55:04.303
> 
> 标签：java, spring, tiles, freemarker, tiles2

我今天正在努力从 Freemarker 迁移到 Tiles2 + Freemarker。

我的 freemarker 模板使用来自 spring.ftl 的宏。

如果我在 web.xml 中提供一个 fremarker servlet，我的模型对 freemarker 是可见的，但特定的 spring 变量（自然）不会填充到模型中，因为 springs FreemarkerView 对此负责。

如果我为特定的 url（比如“/tpl/*”）配置一个单独的 DispatcherServlet，并将 freemarker 解析器配置为该 servlet 的默认视图解析器，并提供 UrlFilenameViewController 作为默认控制器，则特殊的 spring 变量确实会填充到模型中，但我自己的模型是不可见：它被绑定为请求属性。我可以通过 ${Request.mymodel.myvar} 访问我的模型，但这样我必须更改我所有的 freemarker 模板，并且我发现这个想法有些异味。

现在我的解决方案是扩展 UrlFilenameViewController 并将我的模型从请求添加到 ModelAndView：

```
protected ModelAndView handleRequestInternal(HttpServletRequest request, HttpServletResponse response)  {
        ModelAndView mav = super.handleRequestInternal(request, response);

        HashMap<String, Object> map = new HashMap<String, Object>();

        Enumeration<String> attributes = request.getAttributeNames();

        while(attributes.hasMoreElements()) {
            String attribute = attributes.nextElement();

            if("model".equals(attribute)) {
                logger.debug("FreemarkerViewController.handleRequestInternal: putting attribute to model: " + attribute + "=" + request.getAttribute(attribute));
                map.put(attribute, request.getAttribute(attribute));
            }
        }
        logger.debug("FreemarkerViewController.handleRequestInternal: VIEW: " + mav.getViewName());
        return new ModelAndView(mav.getViewName(), map);
    } 
```

但是这个解决方案也有点臭——如果我在我的业务控制器的模型中添加一些东西，我必须在这里添加它。

我的问题有优雅的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T21:54:42.517

我记得我在两个项目中解决了同样的问题。您的第二种方法几乎是正确的`FreeMarkerViewResolver`（`FreeMarkerView``TilesView`

自定义瓷砖视图：

```
public class CustomTilesView extends TilesView {

    @Override
    protected void exposeModelAsRequestAttributes(Map model, HttpServletRequest request) {
        request.setAttribute(CustomFreeMarkerView.MODEL_KEY, model);
    }
} 
```

自定义 FreeMarker 视图：

```
public class CustomFreeMarkerView extends FreeMarkerView {

    public static final String MODEL_KEY = FreeMarkerView.class.getName() + ".MODEL";

    @Override
    protected void exposeHelpers(Map model, HttpServletRequest request) throws Exception {
        super.exposeHelpers(model, request);
        final Map savedModel = (Map) request.getAttribute(MODEL_KEY);
        if (savedModel != null) {
            mergeModels(model, savedModel);
        }
    }

    private void mergeModels(Map<String, Object> targetModel, Map<String, Object> recipientModel) throws ServletException {
        for (Map.Entry<String, Object> entry : recipientModel.entrySet()) {
            String key = entry.getKey();
            if (targetModel.containsKey(key)) {
                throw new ServletException("Cannot merge models because of an existing model object of the same name: " + key);
            }
            targetModel.put(key, entry.getValue());
        }
    }
} 
```

在 Spring 中同时注册：

```
<bean class="org.springframework.web.servlet.view.UrlBasedViewResolver"
      p:viewClass="com.my.CustomTilesView"
      p:contentType="text/html;charset=UTF-8"/>

<bean class="org.springframework.web.servlet.view.freemarker.FreeMarkerViewResolver"
      p:suffix=".ftl"
      p:exposeSpringMacroHelpers="true"
      p:viewClass="com.my.CustomFreeMarkerView"
      p:contentType="text/html;charset=UTF-8"/> 
```

应该管用。

# visual-studio-2008 - VSTestHost.exe 已停止工作 - 无法运行单元测试

> ID：233895
> 
> 赞同：5
> 
> 时间：2008-10-24T14:57:37.420
> 
> 标签：visual-studio-2008, unit-testing, vstesthost

微软单元测试框架突然罢工了。

当我尝试在 VS2008 中运行测试时，我得到一个对话框，其中显示消息“VSTestHost.exe 已停止工作”。

我在 Vista 上运行 Visual Studio Team System 2008（版本 9.0.30729.1 SP）并应用了所有更新。

“问题报告和解决方案”建议我“升级到 Visual Studio Team Edition for Software Testers 的最新零售版”，这是不对的。

我试过重启。
我试过“devenv /resetuserdata”

这些没有任何区别。

基于这种废话，我想回到[MbUnit ，但这不是我的选择。](http://www.mbunit.com/)
对于如何解决这个问题，有任何的建议吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-10-29T17:19:11.837

这通常是由于代码中的某些错误，例如无限循环或循环引用。

I had the same issue and realized that it was my code that was messing up, and the test framework was simply protecting itself against my code by shutting itself down.

The key for me was that the same thing happened with two different testing frameworks. So it had to be my code.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-26T16:25:29.510

我找到了我要问的问题，这是我的错。我编写了一个堆栈溢出代码：我将一些代码重构为一个扩展方法，将其重命名以匹配它调用的 Linq 扩展方法，因此它只是自递归地调用它。

从中吸取的教训：
**1：** [“选择”没有被破坏](http://www.pragprog.com/the-pragmatic-programmer/extracts/tips)。由于它的坏名声，我太快责怪框架了。

**2：**但它确实有一个病态的一般性和完全误导性的错误信息。

在错误消息如此糟糕的情况下，一个好的调试技术是尝试确定什么会导致错误，什么不会导致错误。在我的情况下，当我注意到它不是“测试运行”失败时，突破就来了，它只是包含 Sql 数据库测试的运行——域对象和模拟存储库测试可以运行得很好，所以必须对它正在运行的代码有所了解。并且调试器将进入测试。我从灾难性的错误中假设它甚至没有走那么远。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-17T16:30:37.343

请务必注意，虽然解释 VSTestHost.exe 停止工作的错误消息的描述性不是很强。在测试结果中，有一个链接显示“测试运行已完成”（或者在您的情况下，它会显示“测试运行失败”），当您单击此链接时，您会看到发生的确切错误消息，导致测试主机失败（堆栈溢出异常）。

他们有点掩饰这些信息，但是知道主机没有崩溃但某些测试根本不起作用时尤其有用，有时可以在该链接中找到有关原因的信息。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-26T16:26:44.437

您是否尝试过在 Visual Studio 上运行修复，甚至重置回出厂设置？

要重置为出厂设置，请从运行窗口运行 devenv /ResetSettings。

# .net - 将 ConnectionString 保留在 LINQ 设计器文件中

> ID：233896
> 
> 赞同：4
> 
> 时间：2008-10-24T14:58:00.757
> 
> 标签：.net, linq

每当我将一个新的数据库对象从服务器资源管理器放入 dbml 时，Visual Studio 都会将设计器文件中的连接字符串替换为一个新的连接字符串，它会自动添加到我的配置文件中的连接字符串中。它们都具有完全相同的参数，只是名称不同。

如何强制 Visual Studio 使用并保留我已有的连接字符串？

例如，在 dbml-designer.cs 中，我有这个：

```
base(global::System.Configuration.ConfigurationManager.ConnectionStrings["ConnString1"].ConnectionString, mappingSource) 
```

这是自动生成的。在我的配置文件中，我有：

```
<add name="DefaultConnString" connectionString="EXACTLYTHESAME"
    providerName="System.Data.SqlClient" /> <add name="ConnString1" connectionString="EXACTLYTHESAME"
    providerName="System.Data.SqlClient" /> 
```

每当我将数据库对象拖到 dbml 时，都会自动添加 ConnString1。

我希望designer.cs 使用DefaultConnstring。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-31T23:25:13.633

有一篇很好的帖子在这里几乎解释了您的选择：

[http://blog.jongallant.com/2007/11/linq-web-app-connection-strings.html#.UGA8Q42PUg0](http://blog.jongallant.com/2007/11/linq-web-app-connection-strings.html#.UGA8Q42PUg0)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-30T07:55:00.083

您需要确保 Visual Studio 的服务器资源管理器中使用的连接字符串与 dbml 文件中已定义的连接字符串相同。

我不太清楚你所说的不同名称是什么意思，你是说数据库名称吗？当我有不同的数据库名称用于开发和生产时，我通常会在开发时保留开发连接字符串值，但在我的主应用程序中更改连接字符串值。这是因为我通常在单独的程序集中开发我的 LINQ 逻辑。

或者，您保留两个连接字符串：一个用于添加新的数据库对象，另一个用于测试，例如。当然，您必须格外小心地跟踪您将使用的连接字符串。

# apache-flex - 弹性普拉纳

> ID：233899
> 
> 赞同：0
> 
> 时间：2008-10-24T14:58:50.803
> 
> 标签：apache-flex, flash, actionscript-3, inversion-of-control

我想知道你们中有多少人已经使用过用于 AS3（Flex/Flash）的 Prana 框架或听说过它？

我发现它非常有用，但似乎没有很多开发人员使用它......

链接是[PranaFramework](http://www.pranaframework.org)

谢谢，Lieven Cardoen 又名 Johlero

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-13T21:28:04.000

Marcel Panse 上周三在荷兰 Bussum 举行的 JFall 会议上谈到了 Prana。他说它是 Flex 最好的“类似 Spring”的框架之一。我不是 Flex 开发人员，但我可以看到与 Spring 的相似之处。

他的幻灯片在这里： [http ://www.slideshare.net/marcel.panse/flex-in-de-praktijk-presentation/](http://www.slideshare.net/marcel.panse/flex-in-de-praktijk-presentation/)

（对不起，大部分是荷兰语）

# visual-studio - 仅指向一个文件夹并在解决方案资源管理器中显示所有子文件夹和文件的 Visual Studio 解决方案？

> ID：233900
> 
> 赞同：3
> 
> 时间：2008-10-24T14:59:11.877
> 
> 标签：visual-studio

有没有办法在 Visual Studio 中创建一个空白解决方案或某种类型的基于文件的项目解决方案，以便我可以指向一个根文件夹，并让该根目录中的所有子文件夹和文件显示在我的解决方案探索者？我意识到我可以创建一个空白解决方案，然后通过添加 > 现有项目手动添加各个项目，但是，这并不能保持文件夹结构完整，而且，如果我有很多文件夹/文件，这将需要很长时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-24T15:03:52.447

您还可以创建空白解决方案，然后单击解决方案资源管理器顶部的右数第二个图标（它看起来像三个文件，其中一个“剪切”）。单击该按钮以显示解决方案目录中不在项目中的文件后，您可以选择所有文件（使用 shift 单击），然后右键单击您的选择并选择“包含在项目中”。

另请注意，您可以在“添加现有...”文件窗口中使用 shift 或 control 键单击来选择多个文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-01-31T12:37:47.093

您必须在解决方案中创建一个 Visual Studio 项目才能添加文件并保持其文件夹结构。要添加的文件必须位于项目的主文件夹下。

我建议添加一个“C# 空项目”（解决方案资源管理器：解决方案 > 添加 > 新项目 ... > Visual C# > Windows > 空项目）。之后，您可以按照 SoloBold 的说明进行操作，以显示项目文件夹中的文件。右键单击源文件的最顶层文件夹并选择“包含在项目中”，然后将添加包括所有文件的整个文件夹结构。这可能需要一些时间，具体取决于文件/子文件夹的数量。

另请参阅：[对类似问题的回答，带有屏幕截图](https://stackoverflow.com/questions/392473/how-do-you-add-an-existing-directory-tree-to-a-project-in-visual-studio/392477#392477)

# sql-server - Windows 桌面应用程序的最佳零（接近零？）管理关系数据库是什么：Access、SQLite、SQL Server 等？

> ID：233902
> 
> 赞同：3
> 
> 时间：2008-10-24T14:59:20.707
> 
> 标签：sql-server, windows, ms-access, sqlite

我们不需要多用户。只是关系。我们的应用目前使用 Access，但 Access 并不完全是零管理，因为它容易损坏。

SQLite 是坚如磐石、坚如磐石、纯零管理的吗？

或者...有没有办法将 SQL Server 配置为桌面引擎，使其成为纯零管理员？

或者......还有其他一些关系选择吗？

我们使用 ADO 作为与 Access 对话的层，因此切换到 SQL Server 并不难，但我的理解是我无法将 ADO 用于 SQLite，因此切换到 SQLite 需要大量重写。是对的吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-24T15:24:45.837

其他数据库可能比 Access 更稳定，但我不知道有什么比 Access 更容易使用，而且最终用户也很容易理解。Access（如 SourceSafe）总是被称为“容易腐败”，但很少有第一手资料。大多数人“在某处读过它”。

如果您担心损坏，请考虑在您的应用程序中包含一个备份例程，以保留 Access 数据库的最后两个或三个副本。

如果您坚持其他内容，请尝试 SQL Server Compact Edition（正如其他人所建议的那样），它（如 Access）只是一个文件，在这种情况下是一个 .sdf 文件和一些 DLL。与 SQL Server Express Edition 不同，SQL Server CE 不会让后台进程一直运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-24T15:04:35.360

另一种选择是嵌入式 Firebird。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-24T15:06:14.593

最简单的转换是使用 SQL Server 精简版，它可以嵌入到您的应用程序中，并且根据我所做的一些轻量级测试，它工作得非常好。

转到 SQL lite 将需要对 DAL 进行更多修改。

现在请注意，SQL Compact Edition 不支持存储过程！（应该没什么大不了，但一定要研究差异）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-24T15:18:31.043

SQLite有[ADO.NET 包装器](http://sqlite.phxsoftware.com/)，不确定这是您想要的还是直接的 ADO。我发现 SQLite 非常健壮，尽管您确实需要不时对数据库进行 VACUUM 以在删除后恢复未使用的空间。你可以从你的代码中做到这一点，所以这不是真正的管理。我只是在启动或关闭时执行此操作。

我同意其他人对 SQL Express Edition 的看法。我将它用于多个应用程序。

如果您正在使用 .NET，那么您可能希望查看[Subsonic](http://subsonicproject.com/default.aspx)以进行数据访问。它支持以上所有以及更多功能，并且使切换变得相当轻松。对于单用户数据库应用程序，这很棒。如果您要进行重写，那么这是值得的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-24T15:02:23.447

由于您正在考虑不需要多用户，因此您可能需要查看 SQL Server Compact Edition。[http://www.microsoft.com/Sqlserver/2005/en/us/compact.aspx](http://www.microsoft.com/Sqlserver/2005/en/us/compact.aspx)

# c# - 使用连接查询还是使用 LINQ 魔法？

> ID：233905
> 
> 赞同：3
> 
> 时间：2008-10-24T14:59:58.927
> 
> 标签：c#, .net, .net-3.5

最好做这样的联合查询：

```
var employer = (from person in db.People
                  join employer in db.Employers
                  on person.EmployerID equals employer.EmployerID 
                  where person.PersonID == idPerson
                  select employer).FirstOrDefault(); 
```

或者做简单的事情并这样做（使用空检查）是否同样好：

```
var employer = (from person in db.People
                  where person.PersonID == idPerson
                  select person).FirstOrDefault().Employer; 
```

显然，在这一个中，我实际上必须在 2 个语句中执行此操作才能进行空检查。

对于可读性或性能问题，这里有什么最佳实践吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-24T15:06:10.943

我会用这个：

```
var employer = (from person in db.People
                where person.PersonID == idPerson
                select person.Employer).FirstOrDefault(); 
```

它具有第一个版本的简单性，但仍然只为雇主（而不是个人*和*雇主）获取数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-24T15:02:32.073

第二个可以评估为 null ，这将导致错误。

我更喜欢第一个，因为如果它为空，那么您可以处理它而不会引发异常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-24T15:03:23.087

我发现第一个更好读，但我不确定实现上的差异。

我强烈建议使用 LinqPad 查看生成的 SQL，这将帮助您找出差异。

# iphone - 如何创建一个 YUI 菜单，您可以在其中单击以打开子菜单？

> ID：233906
> 
> 赞同：1
> 
> 时间：2008-10-24T15:00:03.607
> 
> 标签：iphone, menu, yui

我们有一个通过 YUI 菜单按钮激活的多层/分层 YUI 菜单。此菜单中的所有内容都运行良好。如果您将鼠标悬停在带有子菜单的菜单项上，子菜单将按预期显示。你可以从这个子菜单中选择一个项目就好了。

但是，问题是您还可以单击此菜单的父项，从而关闭整个菜单。事实上，我想要相反的结果。我想单击父菜单项使顶级菜单保持打开状态并打开子菜单（即，我希望单击在功能上与鼠标悬停事件相同）。

旁注：这在点击事件无关紧要的典型 Web 浏览器（例如 Firefox）上不是问题，因为没有鼠标悬停就无法点击。这是没有鼠标悬停事件的 iPhone 上的问题。

我一直在使用 autosubmenudisplay 属性和 keepopen 属性，希望我可以处理父项单击事件来做我想做的事情，但是到目前为止，我一直没有成功。如果我将 autosubmenudisplay 设置为 false，我无法弄清楚如何手动显示子菜单。keepopen 属性似乎不起作用，而是我将其设置在菜单或子菜单上。

有没有办法获得我想要的行为，让我们的 iPhone 用户满意？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T18:43:10.447

Todd Kloots，这里是 YUI 按钮和菜单小部件的作者。看了看你的要求。不幸的是，当前版本的 YUI 按钮和菜单不支持您想要创建的交互类型。随意通过 SourceForge 提交功能请求，我将尝试为未来版本的 YUI 处理此问题。

*   托德

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T16:31:06.920

这不是您所要求的，但是您看过[iUI](http://code.google.com/p/iui/)吗？您也许可以从实现中学到一些技巧。

# vb.net - 使用正则表达式替换将 10000 添加到数字？

> ID：233908
> 
> 赞同：2
> 
> 时间：2008-10-24T15:00:34.510
> 
> 标签：vb.net, regex

我需要用相同的数字加上 10000 替换一些 2 位和 3 位数字。所以

```
Photo.123.aspx 
```

需要成为

```
Photo.10123.aspx 
```

并且

```
Photo.12.aspx 
```

需要成为

```
Photo.10012.aspx 
```

我知道在 .NET 中，我可以将替换委托给一个函数，只需将 10000 添加到数字上，但如果可以的话，我宁愿坚持使用普通的 RegEx。有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-24T15:01:57.737

我认为在这种情况下，使用正则表达式进行匹配和替换函数是最合适的，你正在做简单的数学运算，使用专门设计的东西......

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-24T16:04:10.390

James 是对的，您希望使用带有 MatchEvaluator 参数的 Regex.Replace 方法。匹配评估器委托是您可以获取在匹配中获得的数字字符串并将其转换为可以添加 10,000 的数字的地方。我使用 lambda 表达式代替显式委托，因为它更紧凑和可读。

```
using System;
using System.Text.RegularExpressions;

namespace RenameAspxFile
{
    sealed class Program
    {
        private static readonly Regex _aspxFileNameRegex = new Regex(@"(\S+\.)(\d+)(\.aspx)", RegexOptions.Compiled | RegexOptions.IgnorePatternWhitespace | RegexOptions.IgnoreCase);
        private static readonly string[] _aspxFileNames= {"Photo.123.aspx", "Photo.456.aspx", "BigPhoto.789.aspx"};

        static void Main(string[] args)
        {
            Program program = new Program();
            program.Run();
        }

        void Run()
        {
            foreach (string aspxFileName in _aspxFileNames)
            {
                Console.WriteLine("Renamed '{0}' to '{1}'", aspxFileName, AddTenThousandToPhotoNumber(aspxFileName));
            }
        }

        string AddTenThousandToPhotoNumber(string aspxFileName)
        {
            return _aspxFileNameRegex.Replace(aspxFileName, match => String.Format("{0}{1}{2}", match.Result("$1"), Int32.Parse(match.Result("$2")) + 10000, match.Result("$3")));
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-24T15:35:19.463

有什么理由`VB.NET`吗？

### Perl

```
s(
  Photo\. (\d{2,3}) \.aspx
){
  "Photo." . ($1 + 10000) . ".aspx"
}xe 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-24T15:41:12.543

尝试以下操作：

```
"Photo\./d\.aspx" and replace with "Photo.1000$1.aspx"
"Photo\./d/d\.aspx" and replace with "Photo.100$1.aspx"
"Photo\./d/d/d\.aspx" and replace with "Photo.10$1.aspx" 
```

这是我看到这种情况发生的唯一方式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-24T15:16:09.690

如果只有两位或三位数字：

（我假设您使用的是 .NET Regex，因为我们正在讨论 .aspx 文件）

检查：`Photo\.{\d\d\d}\.aspx`

用。。。来代替：`Photo.10\1.aspx`

然后检查：`Photo\.{\d\d}\.aspx`

用。。。来代替：`Photo.100\1.aspx`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-24T15:37:57.370

James Curran 比我快一点，但这就是我为你准备的。认为这是您可以使用 Regex 执行所需操作的最小代码。

```
 Regex          regex = new Regex(@"(\d\d\d?)", RegexOptions.None);
        string result = regex.Replace(@"Photo.123.asp", delegate(Match m) 
                                                {
                                                    return "Photo.1"
                                                        + m.Groups[1].Captures[0].Value.PadLeft(4, '0')
                                                        + ".aspx";
                                                }
        ); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-24T15:08:02.343

您是否尝试仅使用[PadLeft](http://msdn.microsoft.com/en-us/library/system.string.padleft.aspx)？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-24T15:27:25.597

这似乎可以满足您的要求：

```
static public string Evaluator(Match match) 
{
     return "Photo.1" 
            + match.Groups[1].Captures[0].Value.PadLeft(4, '0')
            + ".aspx";
}

public void Code(params string[] args)
{
     string pattern = @"Photo\.([\d]+)\.aspx";
     string test = "Photo.123.aspx";
     Regex regex = new Regex(pattern);
     string converted = regex.Replace(test, Evaluator) 
     Console.WriteLine(converted);
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-24T15:46:15.543

这将匹配字符串的正确部分，但不会告诉您它是两位数还是三位。

```
[^\d][\d]{2,3}[^\d] 
```

不过，您可以使用它来获取数字，将其转换为 int，添加 10000，然后将其转换为您需要的字符串。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-08-02T15:33:26.967

发现这个问题，因为我试图在 Vim 中做类似的事情。生病把解决方案放在这里。

```
:s/Photo\.\d\+\.aspx/\=Photo\.submatch(0)+10000\.aspx/g 
```

# c++ - 即用户代理 wxWidgets

> ID：233911
> 
> 赞同：2
> 
> 时间：2008-10-24T15:00:46.587
> 
> 标签：c++, internet-explorer, com, wxwidgets, user-agent

我目前使用 ie 作为 wxWidgets 上的活动 x com 事物，并且想知道是否有任何简单的方法可以更改始终有效的用户代理。

Atm 我正在更改标题，但这仅在我手动加载链接时才有效（即调用 setUrl）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-25T00:58:39.780

据我所知，唯一“始终有效”的方法是[更改​​注册表中的用户代理字符串](http://www.walkernews.net/2007/07/05/how-to-change-user-agent-string/)。当然，这会影响该机器上运行的*每个*Web 浏览器实例。

您也可以尝试在 上进行 Google 搜索`DISPID_AMBIENT_USERAGENT`。从[这个微软页面](http://support.microsoft.com/kb/q183412/)：

> MSHTML 还会`DISPID_AMBIENT_USERAGENT` 在导航到单击的超链接时请求新的用户代理。此环境属性可以被覆盖，但在以编程方式调用 Navigate 方法时不使用；它也不会导致 DOM 的导航器对象的 userAgent 属性或 clientInformation 行为被更改 - 此属性将始终反映 Internet Explorer 自己的 UserAgent 字符串。

我不熟悉 MSHTML 组件，所以我不确定这是否有用。

我希望这至少能给你一个开始的地方。:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T12:40:22.820

我今天做了一些谷歌搜索，你提供了头部极客的提示，我想出了如何去做。

wxWidgets 使用一个名为 FrameSite 的 activex rapper 类来处理调用请求。我所做的是创建一个继承自此的新类，处理 DISPID_AMBIENT_USERAGENT 事件并传递所有其他事件。因此，现在我可以返回一个不同的用户代理。

谢谢您的帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T11:10:55.110

Head Geek 已经告诉过您 IE 默认在注册表中的位置。

不过，这只是一个默认设置。如果您实施 [IDocHostUIHandler::GetOptionKeyPath]( [http://msdn.microsoft.com/en-us/library/aa753258(VS.85%29.aspx)](http://msdn.microsoft.com/en-us/library/aa753258(VS.85%29.aspx))或 [IDocHostUIHandler2::GetOverrideKeyPath]( [http://msdn. microsoft.com/en-us/library/aa753274(VS.85%29.aspx)](http://msdn.microsoft.com/en-us/library/aa753274(VS.85%29.aspx))，IE 将使用该注册表项。

您可能需要使用 SysInternal 的 RegMon 来调试它。

# winforms - 路径递归应该发生在类还是表示层中？

> ID：233916
> 
> 赞同：2
> 
> 时间：2008-10-24T15:02:24.460
> 
> 标签：winforms, recursion

我有一个带有输入文本框、按钮和多行输出文本框的 WinForms 应用程序。在文本框中输入根路径。按钮单击调用一个函数来递归检查所有子目录以进行一些正确的目录命名验证检查。结果输出到多行文本框中。

如果递归工作在单独的类中完成，我有两个选择：

1.  跟踪类属性中不正确的目录（例如 ArrayList），完成后返回 ArrayList，并使用所有结果更新输出文本框。

2.  传入 ByRef 输出文本框并为每个不正确的目录更新/刷新它。即使 1 和 2 是单线程的，但对于 2，我至少会根据目录更新我的结果。

如果递归工作在表示层完成，验证在单独的类中完成，我可以多线程。

哪种方式更清洁？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T15:15:43.840

您不需要传递 TextBox ByRef。它已经是一个参考对象。仅当您计划为引用分配不同的或新的 TextBox 时，传递 ByRef 才会产生效果。

如果你打算在一个单独的类中完成这项工作，它看起来就像将 TextBox 的内容作为字符串传递，然后将结果作为字符串或一组字符串（数组`List<string>`等）一样简单. 如果有一天您决定使用不同类型的控件来存储此信息，这比传入 TextBox 更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-24T15:16:57.567

我会建议接近选项 1 的东西。我会有一个方法，将根目录作为输入并返回“坏”目录的列表。此外，我会在后台线程上调用该方法，以免在执行操作时挂起 UI。添加进度条或某种等待指示器，以便用户知道操作正在进行中。

将文本框传递给该方法将不允许您将该方法重用于其他任何事情。为了代码重用（如果这对您很重要），我认为简单地让方法返回一个列表并让回调方法弄清楚如何显示数据会更干净。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T17:32:53.737

[不确定这是否是跟进原始问题的地方]

那么，是否可以肯定地说递归业务层函数将无法在每次递归迭代时更新表示级别控件？

# sql - 插入与插入

> ID：233919
> 
> 赞同：102
> 
> 时间：2008-10-24T15:02:31.030
> 
> 标签：sql, sql-server, tsql

我在 MS SQL 中使用 T-SQL 已经有一段时间了，不知何故，每当我必须将数据插入表中时，我倾向于使用语法：

```
INSERT INTO myTable <something here> 
```

我知道关键字`INTO`在这里是可选的，我不必使用它，但不知何故它在我的情况下成为了习惯。

我的问题是：

*   `INSERT`使用语法与有什么影响`INSERT INTO`吗？
*   哪一个完全符合标准？
*   它们在 SQL 标准的其他实现中都有效吗？

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2008-10-24T15:06:15.903

`INSERT INTO`是标准。尽管`INTO`在大多数实现中是可选的，但在少数实现中是必需的，因此最好包含它以确保您的代码是可移植的。

[您可以在此处](http://en.wikipedia.org/wiki/SQL#Standardization)找到多个 SQL 标准版本的链接。[我在这里](http://www.contrib.andrew.cmu.edu/~shadow/sql/sql1992.txt)找到了旧标准的 HTML 版本。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-10-24T15:10:30.077

它们是相同的东西，`INTO`在 T-SQL 中是完全可选的（其他 SQL 方言可能不同）。

与其他答案相反，我认为它会损害使用`INTO`.

我认为这是一个概念性的事情：在我看来，我不是在名为“Customer”的表中插入*一行*，而是插入一个*Customer*。（这与我用单数而不是复数来命名我的表的事实有关）。

如果您遵循第一个概念，您`INSERT INTO Customer`很可能会“感觉正确”。

如果您遵循第二个概念，那么它很可能`INSERT Customer`适合您。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-24T15:08:37.193

它在 mySQL 中可能是可选的，但在其他一些 DBMS 中是必需的，例如 Oracle。因此，不管它的价值如何，使用 INTO 关键字的 SQL 将更具可移植性。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-24T15:52:47.603

我对这个问题的一个教训是，你应该始终保持一致！如果您使用 INSERT INTO，也不要使用 INSERT。如果你不这样做，一些程序员可能会再次问同样的问题。

这是我的另一个相关示例案例：我有机会在 MS SQL 2005 中更新了一个非常长的存储过程。问题是向结果表中插入了太多数据。我必须找出数据的来源。我试图找出新记录的添加位置。在 SP 的开头部分，我看到了几个 INSERT INTO。然后我试图找到“INSERT INTO”并更新它们，但我错过了一个只使用“INSERT”的地方。那一个实际上在某些列中插入了 4k+ 行空数据！当然，我应该只搜索 INSERT。然而，这发生在我身上。我责怪以前的程序员白痴:):)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-25T00:39:03.757

在 SQL Server 2005 中，您可以在 INSERT 和 INTO 之间设置如下内容：

```
INSERT top(5) INTO tTable1 SELECT * FROM tTable2;

```

虽然它可以在没有 INTO 的情况下工作，但我更喜欢使用 INTO 以提高可读性。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-24T15:05:05.000

他们都做同样的事情。INTO 是可选的（在 SQL Server 的 T-SQL 中），但有助于提高可读性。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-02-10T08:35:54.900

我开始在 ORACLE 上使用 SQL，所以当我看到没有 INTO 的代码时，它看起来只是“破碎”和混乱。

是的，这只是我的意见，我并不是说你*应该*总是使用 INTO。但是如果您不知道，您应该知道许多其他人可能会这么想，尤其是如果他们还没有开始使用较新的实现编写脚本的话。

对于 SQL，我认为意识到您正在向 TABLE 添加 ROW 而不是使用对象也非常重要。我认为对于新开发人员来说，将 SQL 表行/条目视为对象是没有帮助的。再说一次，只是我的意见。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-24T15:11:06.300

我更喜欢使用它。它与 SQL 语言的其他部分（如`group BY`, `order BY`.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-25T16:04:42.623

如果可用，请使用标准功能。并不是说您需要特定数据库的可移植性，但您可能需要 SQL 知识的可移植性。一个特别讨厌的 T-SQL 示例是使用 isnull，使用 coalesce！

# jquery - 查找和替换 jquery

> ID：233922
> 
> 赞同：6
> 
> 时间：2008-10-24T15:02:51.107
> 
> 标签：jquery

我有这段代码可以让我对提交按钮进行翻转，并且我正在尝试使其更通用：

```
$('.rollover').hover(
            function(){ // Change the input image's source when we "roll on"
                srcPath = $(this).attr("src");
                            srcPathOver = ???????
                /*need to manipulate srcPath to change from
                img/content/go-button.gif
                into 
                img/content/go-button-over.gif
                */
                $(this).attr({ src : srcPathOver});
            },
            function(){ // Change the input image's source back to the default on "roll off"
                $(this).attr({ src : srcPath});
            }
     ); 
```

真的有两件事，

我想了解如何操纵`srcPath`变量以将文本“-over”附加到 gif 文件名上，从而为翻转提供新图像。谁能建议一种方法来做到这一点？

另外，有人能告诉我这段代码是否可以改进吗？我对 jQuery 有点陌生，想知道是否可以改进语法。

非常感谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-24T15:33:16.660

```
$('.rollover').hover(
            function(){ // Change the input image's source when we "roll on"
                var t = $(this);
                t.attr('src',t.attr('src').replace(/([^.]*)\.(.*)/, "$1-over.$2"));
            },
            function(){ 
                var t= $(this);
                t.attr('src',t.attr('src').replace('-over',''));
            }
     ); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-24T15:28:03.300

要操作文件名并附加“-over”，您只需执行一些 Javascript 字符串操作，如下所示：

```
function appendOver(srcPath){
    var index = s.indexOf('.');

    var before = s.substr(0, index);
    var after = s.substr(index);

    return before + "-over" + after;
} 
```

这应该返回原始文件名（以所有可能的格式）并在扩展点之前添加“-over”字符串。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-24T15:27:21.353

您应该能够使用正则表达式替换来修改您的源路径。像这样：

```
srcPathOver = srcPath.replace(/([^.]*)\.(.*)/, "$1-over.$2"); 
```

更多关于 JavaScript 正则表达式的[信息在这里](http://www.regular-expressions.info/javascript.html)

至于你是怎么做的，我会确保你像这样定义你的 srcPath 变量

```
var srcPath;
$('.rollover').hover(... 
```

您上面的代码使它看起来像 srcPath 是一个全局变量，这不是您想要的。

# jquery - jQuery 交换元素

> ID：233936
> 
> 赞同：5
> 
> 时间：2008-10-24T15:04:43.317
> 
> 标签：jquery

好的，让我举个例子：

```
<head>
<script type="text/javascript">
$(document).ready(function(){

    $("#options_2").hide();
    $("#options_3").hide();

});
</script>
</head>
<body>
<div id="options_1">option 1</div>
<div id="options_2">option 2</div>
<div id="options_3">option 3</div>
<a href="" class="selected">choose option 1</a>
<a href="">choose option 2</a>
<a href="">choose option 3</a>
</body> 
```

如您所见，默认情况下只有选项 1 是可见的，并且您单击以显示选项 1 的链接默认具有 class="selected"，向用户显示该选项当前已被选中。我基本上想要它，以便当他们单击“选择选项 2”时，选项 1 div 隐藏自己，选项 2 div 显示自己，然后为第二个链接提供选定的类并从图像链接中删除该类。

它基本上只是使用链接和 div 的选项卡，但由于我必须在其中显示它的格式，我无法使用我在网上找到的任何选项卡插件。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-24T15:26:56.720

首先给你的链接一个类或ID（我用过一个类），这样可以更容易地进行交换

```
<div id="options_1" class="tab" >option 1</div>
<div id="options_2" class="tab">option 2</div>
<div id="options_3" class="tab">option 3</div>

$(document).ready(function () {

    var clickHandler = function (link) {
         $('.tab').hide();
         $('#option_' + link.data.id).show();
         $('.selected').removeClass('selected');
         $(this).attr('class','selected');
   }

   $('.link1').bind('click', {id:'1'} ,clickHandler);
   $('.link2').bind('click', {id:'2'} ,clickHandler);
   $('.link3').bind('click', {id:'3'} ,clickHandler);
}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-24T15:23:36.867

鉴于您给定的格式，我将执行以下操作，为每个链接分配一个可以理解地引用它的关联 div 的 id（如“option_1”的“link_1”）并使用以下 jQuery：

```
$('a#link_1').click(function() {
     $(this).attr("class", "selected");
     $(this).siblings('a').removeClass("selected");
     $('div#option_1').show();
     $('div#option_1').siblings('div').hide();
});
    $('a#link_2').click(function() {
     $(this).attr("class", "selected");
     $(this).siblings('a').removeClass("selected");
     $('div#option_2').show();
     $('div#option_2').siblings('div').hide();
});
    $('a#link_3').click(function() {
     $(this).attr("class", "selected");
     $(this).siblings('a').removeClass("selected");
     $('div#option_3').show();
     $('div#option_3').siblings('div').hide();
}); 
```

我已经有一段时间没有做 jQuery 了，但这应该是对的 :)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-24T15:32:25.600

如果您以“options_1_select”和“opener”类的形式将 ID 添加到链接中，您可以帮助自己。然后，您可以为所有链接分配一个事件处理程序：

```
$('a.opener').click(function() {
  // mark current link as selected and unmark all others
  $(this)
    .addClass('selected')
    .siblings('a').removeClass('selected');

  // find a div to show, and hide its siblings
  $('#' + $(this).attr('id').substring(0, 9))
    .show()
    .siblings('div').hide();
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-04T04:02:20.110

听起来你想要一架手风琴。

jQuery UI 提供了一个：http: [//jqueryui.com/demos/accordion/](http://jqueryui.com/demos/accordion/)

# unix - 同步全球大量数据的最佳方式是什么？

> ID：233966
> 
> 赞同：10
> 
> 时间：2008-10-24T15:12:38.277
> 
> 标签：unix, networking, synchronization, large-files

我有大量数据要在全球 4 或 5 个站点上保持同步，每个站点大约 0.5 TB。这种变化（添加或更改）每天大约 1.4 GB，并且数据可以在四个站点中的任何一个站点发生变化。

很大一部分（30%）的数据是重复的包（可能是打包的 JDK），所以解决方案必须包括一种方法来识别本地机器上存在这样的东西并取而代之从另一个站点下载。

版本控制不是问题，这不是代码库本身。

我只是感兴趣是否有任何解决方案（最好是开源的）接近这样的事情？

我的使用 rsync 的婴儿脚本不再那么简单了，我想做更复杂、更智能的同步。

谢谢

编辑：这应该是基于 UNIX 的 :)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-24T15:19:44.927

你试过[Unison](http://www.cis.upenn.edu/~bcpierce/unison/)吗？

我用它取得了很好的效果。它基本上是一个更智能的 rsync，这可能是你想要的。[这里](http://www.tomkelsey.pwp.blueyonder.co.uk/projects/synchronizer_review.html)有一个比较文件同步工具的列表。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-24T15:19:47.593

听起来像是 BitTorrent 的工作。

对于每个站点的每个新文件，创建一个 bittorrent 种子文件并将其放入集中的 Web 可访问目录中。

然后每个站点下载（通过 bittorrent）所有文件。这将为您生成带宽共享和自动本地副本重用。

实际配方将取决于您的需要。例如，您可以为每个主机上的每个文件创建1个bittorrent种子，并将种子文件的修改时间设置为与文件本身的修改时间相同。由于您每天（每小时？）都会这样做，因此最好使用“make”之类的东西来（重新）为新文件或更新文件创建种子文件。

然后，您将所有主机中的所有种子文件复制到集中位置（“tracker dir”），并使用“仅在较新时覆盖”选项。这将为您提供所有文件的所有最新副本的一组种子。

然后每个主机下载所有种子文件（同样，使用“如果更新设置覆盖”）并开始对所有种子文件进行 bittorrent 下载。这将下载/重新下载所有新的/更新的文件。

每天重复一遍。

顺便说一句，正如您在评论中所说，不会有“从自身下载”。如果本地主机上已经存在文件，则将验证其校验和，并且不会进行下载。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-24T15:49:28.267

[像 Red Hat 的Global Filesystem](http://www.redhat.com/gfs/)那样的东西怎么样，这样整个结构就可以在每个站点上拆分到多个设备上，而不是在每个位置都进行复制？

或者可能是商业网络存储系统，例如来自[LeftHand Networks](http://www.lefthandnetworks.com/home.aspx)的（免责声明 - 我不知道成本，也没有使用它们）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-24T15:19:03.710

你有很多选择：

*   您可以尝试设置**复制数据库**来存储数据。
*   使用**rsync**或**lftp**和自定义脚本的组合，但这不适合您。
*   使用具有最大压缩率的**git** repos 并使用一些脚本在它们之间进行同步
*   由于数据量相当大，而且可能很重要，因此请在聘请专家时进行一些自定义开发；）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-30T08:31:18.860

Check out super flexible.... it's pretty cool, haven't used it in a large scale environment, but on a 3-node system it seemed to work perfectly.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-24T15:26:21.450

听起来像是[Foldershare的工作](http://foldershare.com/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-25T11:41:41.503

您是否尝试过`detect-renamed`rsync 的补丁（[http://samba.anu.edu.au/ftp/rsync/dev/patches/detect-renamed.diff](http://samba.anu.edu.au/ftp/rsync/dev/patches/detect-renamed.diff)）？我自己没有尝试过，但我想知道它是否不仅会检测到重命名的文件，还会检测到重复的文件。如果它不会检测到重复的文件，那么，我猜，有可能修改补丁来做到这一点。

# windows-mobile - 使用 HTTP 压缩的 Windows Mobile WinInet 库

> ID：233968
> 
> 赞同：0
> 
> 时间：2008-10-24T15:13:23.347
> 
> 标签：windows-mobile, compression, wininet

在 Windows Mobile 的方法 InternetSetOption [http://msdn.microsoft.com/en-us/library/ms918381.aspx](http://msdn.microsoft.com/en-us/library/ms918381.aspx)上不支持选项`INTERNET_OPTION_HTTP_DECODING`是否有一些简单的方法可以在 WM 6.0 或任何外部库下打开压缩，以解压缩接收到的内容WinInet。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-24T16:21:06.907

没有机制可以“打开减压” - CE 下的 wininet 根本不支持它。由于服务器很可能会使用[deflate 算法，您可以使用](http://en.wikipedia.org/wiki/DEFLATE)[zlib](http://www.zlib.net/)（[OpenNETCF 免费提供 CE 端口）之](http://www.opennetcf.com/zlibce)类的东西手动解压缩数据。

# sharepoint - Sharepoint OnWorkflowItemChanged 失控

> ID：233976
> 
> 赞同：1
> 
> 时间：2008-10-24T15:15:51.890
> 
> 标签：sharepoint, events

在这里，

我正在研究状态机工作流程。我有一个监听`OnWorkflowItemChanged`事件的状态。其余的监听`OnWorkflowModified`事件。如果我在与事件状态不同的状态下更新项目，则`OnWorkflowItemChanged`该事件仍然被`OnWorkflowItemChanged`. 这发生在工作流返回到拥有该`OnWorkflowItemChanged`事件的状态时。

我能做些什么来说明`OnWorkflowItemChanged`它应该只在自己的状态下监听事件的活动。

提前谢谢斯特凡

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T10:59:37.840

我为这个问题找到了一个很好的解决方案：

[http://unclepaul84.blogspot.com/2007/12/disable-event-firing-in-sharepoint-when.html](http://unclepaul84.blogspot.com/2007/12/disable-event-firing-in-sharepoint-when.html)

对我来说，这很好用。

# javascript - javascript window.open() 和 # 符号

> ID：233979
> 
> 赞同：1
> 
> 时间：2008-10-24T15:16:43.607
> 
> 标签：javascript, url-rewriting

我正在尝试通过 window.open() 调用链接到具有“#”字符的文件。该文件确实存在，并且可以使用普通的锚标记链接到就好了。

我尝试使用 '%23' 转义 '#' 字符，但是当 window.open(myurl) 被处理时，'%23' 变为 '%2523'。这告诉我我的 url 字符串正在被 window.open 调用转义，将 '%' 更改为 '%25'。

有没有办法解决这种额外的转义。

示例代码：

```
<script language="javascript">
function escapePound(url)
{
   // original attempt
   newUrl = url.replace("#", "%23");
   // first answer attempt - doesn't work
   // newUrl = url.replace("#", "\\#");

   return newUrl;
 }
</script>
<a href="#top" onclick="url = '\\\\MyUNCPath\\PropertyRushRefi-Add#1-ABCDEF.RTF'; window.open(escapePound(url)); return true;">Some Doc</a> 
```

找不到大喊“file://MyUNCPath/PropertyRushRefi-Add%25231-ABCDEF.RTF”的 URL

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-24T15:29:35.577

您寻求[encodeURI](http://www.w3schools.com/jsref/jsref_encodeURI.asp)的黑暗魔法：

```
window.open("http://your-url.com/" + encodeURIComponent("foo#123.jpg")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-24T15:21:40.147

您是否尝试过使用标准文本转义字符“\”？

```
\# 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T15:25:52.667

您是否尝试过通过 JavaScript 进行 URL 编码，如此[处](http://www.albionresearch.com/misc/urlencode.php)和[此处](http://cass-hacks.com/articles/code/js_url_encode_decode/)所做的那样？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T15:40:44.930

您是否尝试过不转义网址？

```
<a href="#top onclick="url = '\\\\MyUNCPath\\PropertyRushRefi-Add#1-ABCDEF.RTF'; window.open(url); return true;">Some Doc</a> 
```

# .net - 如何创建理解单点登录的站点网络？

> ID：233996
> 
> 赞同：4
> 
> 时间：2008-10-24T15:20:02.787
> 
> 标签：.net, authentication, single-sign-on

我有几个网站（Asp.Net），我想单点登录...

我希望用户访问 Site1 并让 Site1 联系中央单点登录服务器 (SSS)。

然后 SSS 将确定用户未登录（不确定如何登录）并将用户重定向到登录屏幕（仍在 SSS 上）。

如果通过身份验证，用户将被重定向回 Site1。

Site1 会将此视为新到达，并可能会询问 SSS 用户是否已登录。这一次 SSS 会建议相关用户确实已登录。因此 Site1 可以将这个事实存储在它的会话中以供将来参考（也许有一些合适的超时）

Site1 将包含一个指向 Site2 的链接，用户可能会选择关注该链接。

到达站点 2 应触发站点 2 对用户进行身份验证的尝试。

**如何将到达 Site2 的用户识别为已经访问过 Site1 的同一用户，并发现他们已经通过身份验证以便他们不必再次登录？**

**注意：SSS 必须是我控制帐户创建的私有系统。所以恐怕我不能依赖外部 OpenID 服务器**

更新：我目前无法保证 Site1、Site2 和 SSS 会在同一个域内......所以我*认为*cookie 不会削减它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-25T10:18:28.137

不要这么快放弃 OpenID - 作为网站所有者，您可以选择支持哪些 OpenID 提供商。您可以选择运行自己的 OpenID 服务器并只信任它。

另外，请记住 OpenID 是一个身份验证系统 - 用户 X 如何证明他们是他们所说的人。

在 StackOverflow 上，当有人使用 OpenID 登录时，他们会自动创建帐户——但您不必这样做。您可以通过与每个帐户关联的 OpenID 来完全控制帐户创建。

还要记住，（通常）您不必编写和维护的任何软件都是一件好事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T17:45:36.617

以与其他人相同的方式执行此操作，使用 GET 或 POST 在站点之间传递 DB 生成的令牌，然后将这些令牌验证回直接与 DB 对话的 Web 服务。

所以用户想要进入站点 1 (www.domain1.com)。站点 1 检查本地域登录会话/cookie，找不到任何内容，将用户重定向到[http://logindomain.com/?return=www.domain1.com](http://logindomain.com/?return=www.domain1.com)。如果存在较早的登录域 cookie（从登录到附属站点），请将其发送回站点 1。如果不存在，请执行您需要的任何用户身份验证（KERBEROS 检查、表单身份验证、openID 等）以生成唯一令牌。将其存储在 logindomain 的 cookie 中，并将它们重定向回“return”指向的任何位置，并附加您的令牌：http: [//www.domain1.com/](http://www.domain1.com/?token=123456) ?token=123456 。一旦 domain1 针对 Web 服务（或直接的令牌数据库）验证令牌，它就可以使用用户凭据设置自己的本地登录会话/cookie。

因此，现在您在站点 2 (www.domain2.com) 上并登录。您将再次使用 ?return var 设置重定向到 logindomain，但这次它不要求您输入密码 - 它已经有了您在其 SSO cookie 中的令牌。您会立即被重定向回：[http](http://www.domain2.com/?token=123456) ://www.domain2.com/?token= 123456（与使用的 site1 相同的令牌）。Domain2 再次验证令牌，让您无需密码检查即可进入。

如果您要即时更改登录 URL 或尝试制作一个混合 AD/Forms Auth 怪物，就像我的任务是构建的那样，它会变得有点复杂，但这似乎工作正常并且完全匹配（在高级别） IBM 和 MS 文档说他们的专有 SSO 系统做了什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T15:23:40.190

您可以尝试使用共享会话状态服务器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T15:24:34.557

您可以使用 cookie 为用户存储和创建身份验证票证。我们已经这样做了好几次，而且效果很好。`*******