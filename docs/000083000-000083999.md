# StackOverflow 问答 000083000-000083999

# visual-studio - 在 Visual Studio 中折叠所有项目的最佳/最快/最简单的方法是什么？

> ID：83009
> 
> 赞同：9
> 
> 时间：2008-09-17T13:13:18.937
> 
> 标签：visual-studio

我目前正在使用[DPack](http://www.usysware.com/dpack/)，因为这会将“折叠所有项目”选项添加到解决方案资源管理器中的解决方案节点。它工作得很好，但可能需要一段时间才能执行，并且并不总是完全折叠所有内容。

有没有更好的选择？最好是免费且易于安装/设置。那里有很多，但效果最好并且没有任何错误或性能问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-02-26T09:14:33.483

我使用以下适用于 Visual Studio 2005 和 Visual Studio 2008 的宏：

1.  查看 > 其他窗口 > 宏资源管理器 (Alt+F8)
2.  右键单击宏资源管理器中的 MyMacros 节点
3.  新模块...
4.  将其命名为 CollapseAll（或任何您喜欢的名称）
5.  将默认代码替换为如下所示的代码
6.  文件 > 保存全部折叠 (Ctrl+S)
7.  关闭宏编辑器

要设置键盘快捷键：

1.  工具 > 自定义... > 命令
2.  键盘...
3.  显示包含以下内容的命令：Macros.MyMacros.CollapseAll.CollapseAll
4.  分配键盘快捷键（我使用 Alt+C）

代码

```
Imports System
Imports EnvDTE
Imports EnvDTE80
Imports System.Diagnostics

Public Module CollapseAll
    Sub CollapseAll()

        ' Get the the Solution Explorer tree
        Dim solutionExplorer As UIHierarchy
        solutionExplorer = DTE.Windows.Item(Constants.vsext_wk_SProjectWindow).Object()

        ' Check if there is any open solution
        If (solutionExplorer.UIHierarchyItems.Count = 0) Then
            Return
        End If

        ' Get the top node (the name of the solution)
        Dim rootNode As UIHierarchyItem = solutionExplorer.UIHierarchyItems.Item(1)

        rootNode.DTE.SuppressUI = True

        ' Collapse each project node
        Collapse(rootNode, solutionExplorer)

        ' Select the solution node, or else when you click 
        ' on the solution window
        ' scrollbar, it will synchronize the open document 
        ' with the tree and pop
        ' out the corresponding node which is probably not what you want.

        rootNode.Select(vsUISelectionType.vsUISelectionTypeSelect)
        rootNode.DTE.SuppressUI = False

    End Sub

    Sub CollapseSelected()

        ' Get the the Solution Explorer tree
        Dim solutionExplorer As UIHierarchy
        solutionExplorer = DTE.Windows.Item(Constants.vsext_wk_SProjectWindow).Object()

        ' Check if there is any open solution
        If (solutionExplorer.UIHierarchyItems.Count = 0) Then
            Return
        End If

        ' Get the top node (the name of the solution)
        Dim selected As Array = solutionExplorer.SelectedItems

        If (selected.Length = 0) Then Return

        Dim rootNode As UIHierarchyItem = selected(0)
        rootNode.DTE.SuppressUI = True

        ' Collapse each project node
        Collapse(rootNode, solutionExplorer)

        ' Select the solution node, or else when you click 
        ' on the solution window
        ' scrollbar, it will synchronize the open document 
        ' with the tree and pop
        ' out the corresponding node which is probably not what you want.

        rootNode.Select(vsUISelectionType.vsUISelectionTypeSelect)
        rootNode.DTE.SuppressUI = False

    End Sub

    Private Sub Collapse(ByVal item As UIHierarchyItem, ByRef solutionExplorer As UIHierarchy)

        For Each innerItem As UIHierarchyItem In item.UIHierarchyItems
            If innerItem.UIHierarchyItems.Count > 0 Then

                ' Re-cursive call
                Collapse(innerItem, solutionExplorer)

                ' Collapse
                If innerItem.UIHierarchyItems.Expanded Then
                    innerItem.UIHierarchyItems.Expanded = False
                    If innerItem.UIHierarchyItems.Expanded = True Then
                        ' Bug in VS 2005
                        innerItem.Select(vsUISelectionType.vsUISelectionTypeSelect)
                        solutionExplorer.DoDefaultAction()
                    End If
                End If

            End If
        Next

    End Sub

End Module 
```

我没有编写这段代码，我不确定这段代码来自哪里，但是网上有它的变体。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-17T13:15:04.343

[Visual Studio](http://code.msdn.microsoft.com/PowerCommands)的电源命令可以解决问题。没有注意到它们有任何性能\稳定性问题。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-17T18:31:22.993

对于 VS2005，我一直在使用[CoolCommands 4.0](http://weblogs.asp.net/gmilano/archive/2006/10/17/Easily-Add-a-string-resource-with-CoolCommands.aspx)。对于[旧的 3.0 版本](http://weblogs.asp.net/gmilano/archive/2006/05/10/446010.aspx)，功能描述更加完整。版本 3 有一个 .msi 安装程序。版本 4 是一个[.zip 文件](http://download.deklarit.com/files/gmilano/coolcommands40.zip)（无论如何这对我的环境来说更容易）。

我最喜欢的功能（完整列表的一个子集）：

*   从解决方案资源管理器：
    *   折叠所有项目
    *   打开包含文件夹（仅限项目/文件级别）
*   从编辑器上方的文件名选项卡
    *   在解决方案资源管理器中找到
*   从编辑器的上下文菜单中
    *   演示字体

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-06T01:25:33.513

这是[CoolCommands 4.0](http://geekswithblogs.net/brians/archive/2007/03/04/107922.aspx)的更好的功能列表。

要为 VS 2005 安装它，请执行 include setup.bat。

要为 VS 2008 安装它，请修改以下行

```
regpkg CoolCommands.dll /codebase 
```

到：

```
regpkg CoolCommands.dll /root:Software\Microsoft\VisualStudio\9.0 /codebase 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-04-14T16:35:08.840

[PowerCommands for Visual Studio](http://visualstudiogallery.msdn.microsoft.com/e5f41ad9-4edc-4912-bca3-91147db95b99/)适用于 VS2008 和 VS2010。这是 Microsoft 支持的快速执行此操作的方法。

# sql-server - 使用日期参数执行存储过程：命令对象与连接对象

> ID：83038
> 
> 赞同：0
> 
> 时间：2008-09-17T13:15:28.947
> 
> 标签：sql-server, vba, ms-access, ado

当通过参数向存储过程提供日期时，我对日期使用哪种格式有点困惑。我原来的 VBA 语法使用 ADO Connection 对象来执行存储过程：

```
Set SentDetailRS = Me.ADOConnectionToIntegrity.Execute("dbo.s_SelectAggregatedSentDetailList '" & fCSQLDate(EffectiveDate) & "'", , adCmdText) 
```

使用日期语法这对我来说很好，`yyyy-mm-dd`但是当另一个用户执行代码时，他们会收到错误：13 'Type Mismatch'。

经过一些实验，我发现以格式提供日期`dd/mm/yyyy`可以为用户修复此错误，但现在给了我错误！

无论日期格式如何，使用带参数的命令对象执行存储过程都有效（我假设 ADO 正在处理幕后的格式设置）。我认为使用该格式`yyyy-mm-dd`可以与 SQL Server 通用吗？

我也很困惑为什么这个问题似乎是用户特定的？我注意到我在 SQL Server 上的默认语言是“英语”，而其他用户的默认语言是“英式英语”，这会导致问题吗？

我将 ADO 2.8 与 Access 2003 和 SQL Server 2000 一起使用，SQL Server 登录是通过 Windows 集成安全性进行的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T13:56:58.113

小心，不要相信 ADO 正在解决这个问题。通用 SQL 日期格式为 'YYYYMMDD'，而 SQL 和 ACCESS 在显示日期和将其转换为字符串的方式上都受到机器区域设置的影响。

不要忘记日期分隔符在 Access 中是 #，而在 SQL 中是 '

我最好的建议是在将指令发送到您的服务器之前，系统地将您的 Access #MM-DD-YYYY#（或类似）转换为“YYYYMMDD”。您可以构建一个小功能，例如：

```
Public function SQLdateFormat(x_date) as string

SQLDateFormat = _
   trim(str(datePart("yyyy",x_date))) & _
   right(str(datePart("m",date)),2) & _
   right(str(datePart("d",date)),2)

   ''be carefull, you might get something like '2008 9 3'
SQLDateFormat = replace(functionSQLDateFormat," ","0")
   '' you will have the expected '20080903'

End function 
```

如果您在将 INSERT/UPDATE 字符串发送到服务器之前没有以编程方式构建它，那么我会建议您将所有机器的区域设置转换为托管 SQL 的机器的区域设置。您可能还需要检查 SQL 服务器上是否有特定的日期格式（我不确定）。个人而言，我通过在将 SQL 指令发送到服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T13:27:24.033

我猜 fCSQLDate 函数是特定于文化的——即它将根据用户的区域设置解析日期。这就是你看到问题的原因。

无论如何，使用连接字符串的查询总是一个坏主意（注入攻击）。如果你使用参数，你会更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T13:28:19.210

Access 使用 # 作为日期字段分隔符。格式应该是#mm/dd/yyyy# 可能#mm-dd-yyyy# 也可以正常工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T14:02:58.677

抱歉，我不知道 mysql，但是对于 oracle，我总是会明确说明我期望的格式，例如：'DD-MM-YYYY'，以避免（区域）日期格式问题

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T23:13:40.240

为什么不使用格式

```
dd mmm yyyy 
```

只有一种方式可以解释它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-12T16:57:59.180

您可以使用 Date() 函数根据机器日期和时间设置返回通用日期。机器上的区域设置将决定它在客户端的格式化方式。如果您将该字段保留为严格的 DateTime 字段，则客户端区域设置可以格式化日期。

进入服务器，使用 Date() 函数应该也可以工作（返回通用日期值）。

此外，在传递它们时在查询中使用命令对象和参数，以避免对字符串字段的 SQL 注入攻击。

# php - 使用 PHP 连接到 Oracle

> ID：83040
> 
> 赞同：9
> 
> 时间：2008-09-17T13:15:45.623
> 
> 标签：php, oracle

如何从 PHP 连接到远程 Oracle 数据库实例？

我需要查询（只读）远程 Oracle 数据库以获取一些信息；我需要安装 Oracle Instant Client 吗？

PHP 的 OCI 扩展是否足够？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-17T13:29:03.187

来自[PHP 手册](http://php.net/manual/en/oci8.setup.php)

*   您将需要 Oracle 客户端库才能使用此扩展。

*   安装所有必需文件的最方便的方法是使用 Oracle Instant Client，它可从[Oracle 的站点获得](http://www.oracle.com/technology/software/tech/oci/instantclient/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-10T23:22:29.357

将 PHP 与 Oracle 结合使用的最佳手册是[Underground PHP Oracle Manual](http://www.oracle.com/technology/tech/php/pdf/underground-php-oracle-manual.pdf)。定期更新。例如上次更新描述了新的酷 OCI（Oracle 调用接口）特性。我偶然发现了它，从那以后我就再也没有后悔过。从那本好的手册开始。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T13:23:22.297

要完成这项工作，您需要执行几个步骤。

首先，您需要为您拥有的任何操作系统安装 oracle 驱动程序。然后，为 odbc 创建一个 DSN，用于将 php 函数调用连接到 oracle 数据库。在 Windows 上，您可以在控制面板 -> ODBC 源中找到它

完成此操作后，重新启动数据库、Web 服务器，然后您应该能够使用以下命令对其进行测试：

`odbc_connect($dsn,$user,$pass);`

如果您有 linux，则需要相同的步骤，但我不确定您如何在 unix 中创建 DSN。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T13:22:51.113

[我在PHP 文档](http://php.net/manual/en/function.oci-connect.php)的“注释”部分看到了这一点：

> **如果**您将 PHP 与 Oracle Instant Client 一起使用，您可以使用简单的连接命名方法 (...)

所以我认为很明显，您可以在没有 Oracle Instant Client 的情况下仅使用 PHP Oracle 扩展来连接到 Oracle DB。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-21T17:20:18.143

如果您尝试使用 PHP 连接到 ubuntu 上的 oracle，以下链接非常有用：

一）[http://pecl.php.net/bugs/bug.php?id=9253](http://pecl.php.net/bugs/bug.php?id=9253)

那是真正的主力 - 它为您提供几乎所有您需要的数据。

B）[http://fabrizioballiano.net/2008/01/26/how-to-install-php-pdo_oci-on-ubuntu-gutsy/](http://fabrizioballiano.net/2008/01/26/how-to-install-php-pdo_oci-on-ubuntu-gutsy/)

这对于 Oracle 与 ubuntu 一起工作需要安装的细节也很有帮助。

如果您将它与 PHP 一起使用，您需要确保 TNS_ADMIN 和 ORACLE_HOME 环境变量可供 apache 的用户使用 - 在 apache2 目录中有一个名为“envvars”的文件，您可以在其中设置这些变量。（为了我自己的使用方便，我将两者指向同一个目录。）

# command-line-arguments - 用于切换记事本自动换行的命令开关

> ID：83045
> 
> 赞同：0
> 
> 时间：2008-09-17T13:16:10.193
> 
> 标签：command-line-arguments

我有一个客户向记事本展示大量数据，如果打开自动换行并且我想强制关闭它，这些数据看起来完全不对齐。是否有命令开关来执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T13:24:16.600

我认为根本没有命令开关来执行此操作。如果您想一直强制关闭它，那么您可能需要编辑注册表：

```
Hive: HKEY_CURRENT_USER
Key: SOFTWARE\Microsoft\Notepad
Name: fWrap
Type: REG_DWORD
Value: 0 
```

您甚至可以创建一个 .reg 文件并将其放入批处理文件中以运行它并在每次记事本运行时重置它。

通常，如果您关闭了自动换行，当您再次打开它时，它仍然会被关闭。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T13:20:30.667

您可以通过转到格式 -> 自动换行来关闭它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T13:28:31.300

我不相信有任何命令行选项可以做到这一点。

但是，您可以通过将注册表值 HKEY_CURRENT_USER\Software\Microsoft\Notepad\fWrap 设置为 0 来设置默认行为。

根据您的确切要求，您可以通过在启动记事本之前制作一个修改注册表的 bat 文件来解决您的问题。不过，这将是一个相当大的黑客攻击。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T13:28:32.487

您可以只使用写字板而不是记事本，默认情况下它具有自动换行功能。

# sql - 关系数据库中的行程时间计算？

> ID：83050
> 
> 赞同：2
> 
> 时间：2008-09-17T13:16:35.107
> 
> 标签：sql, mysql, sql-server, oracle, postgresql

我想到了这个问题，因为我刚刚发现了这个网站，所以我决定把它贴在这里。

假设我有一个表，其中包含给定“对象”的时间戳和状态（一般含义，不是 OOP 对象）；是否有一种最佳方法可以使用单个 SQL 语句（内部 SELECT 和 UNION 不计算在内）计算一个状态与下一次出现另一个（或相同）状态（我称之为“旅行”）之间的时间？

例如：对于以下情况，Initial 和 Done 之间的行程时间为 6 天，但 Initial 和 Review 之间的行程时间为 2 天。

> 2008-08-01 13:30:00 - 初始
> 2008-08-02 13:30:00 - 工作
> 2008-08-03 13:30:00 - 审查
> 2008-08-04 13:30:00 - 工作
> 2008- 08-05 13:30:00 - 审核
> 2008-08-06 13:30:00 - 接受
> 2008-08-07 13:30:00 - 完成

无需通用，只需说明您的解决方案特定于什么[SGBD](https://stackoverflow.com/questions/980813/what-is-sgbd)（如果不是通用的）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T15:50:28.033

PostgreSQL 语法：

```
DROP TABLE ObjectState;
CREATE TABLE ObjectState (
    object_id integer not null,--foreign key
    event_time timestamp NOT NULL,
    state varchar(10) NOT NULL,
    --Other fields 
    CONSTRAINT pk_ObjectState PRIMARY KEY (object_id,event_time)
); 
```

**对于给定状态，找到给定类型的第一个后续状态**

```
select parent.object_id,parent.event_time,parent.state,min(child.event_time) as ch_event_time,min(child.event_time)-parent.event_time as step_time
from 
    ObjectState parent
    join ObjectState child on (parent.object_id=child.object_id and parent.event_time<child.event_time)
where 
    --Starting state 
    parent.object_id=1 and parent.event_time=to_timestamp('01-Aug-2008 13:30:00','dd-Mon-yyyy hh24:mi:ss')
    --needed state
    and child.state='Review'
group by parent.object_id,parent.event_time,parent.state; 
```

这个查询不是最短的，但它应该很容易理解并用作其他查询的一部分：

**列出给定对象的事件及其持续时间**

```
select parent.object_id,parent.event_time,parent.state,min(child.event_time) as ch_event_time,
       CASE WHEN parent.state<>'Done' and min(child.event_time) is null THEN (select localtimestamp)-parent.event_time ELSE min(child.event_time)-parent.event_time END  as step_time
from 
    ObjectState parent
    left outer join ObjectState child on (parent.object_id=child.object_id and parent.event_time<child.event_time)
where parent.object_id=4    
group by parent.object_id,parent.event_time,parent.state
order by parent.object_id,parent.event_time,parent.state; 
```

**列出未“完成”的对象的当前状态**

```
select states.object_id,states.event_time,states.state,(select localtimestamp)-states.event_time as step_time
from
    (select parent.object_id,parent.event_time,parent.state,min(child.event_time) as ch_event_time,min(child.event_time)-parent.event_time as step_time
     from 
        ObjectState parent
        left outer join ObjectState child on (parent.object_id=child.object_id and parent.event_time<child.event_time)       
     group by parent.object_id,parent.event_time,parent.state) states
where     
    states.object_id not in (select object_id from ObjectState where state='Done')
    and ch_event_time is null; 
```

测试数据

```
insert into ObjectState (object_id,event_time,state)
select 1,to_timestamp('01-Aug-2008 13:30:00','dd-Mon-yyyy hh24:mi:ss'),'Initial' union    all
select 1,to_timestamp('02-Aug-2008 13:40:00','dd-Mon-yyyy hh24:mi:ss'),'Work' union all
select 1,to_timestamp('03-Aug-2008 13:50:00','dd-Mon-yyyy hh24:mi:ss'),'Review' union all
select 1,to_timestamp('04-Aug-2008 14:30:00','dd-Mon-yyyy hh24:mi:ss'),'Work' union all
select 1,to_timestamp('04-Aug-2008 16:20:00','dd-Mon-yyyy hh24:mi:ss'),'Review' union all
select 1,to_timestamp('06-Aug-2008 18:00:00','dd-Mon-yyyy hh24:mi:ss'),'Accepted' union all
select 1,to_timestamp('07-Aug-2008 21:30:00','dd-Mon-yyyy hh24:mi:ss'),'Done';

insert into ObjectState (object_id,event_time,state)
select 2,to_timestamp('01-Aug-2008 13:30:00','dd-Mon-yyyy hh24:mi:ss'),'Initial' union all
select 2,to_timestamp('02-Aug-2008 13:40:00','dd-Mon-yyyy hh24:mi:ss'),'Work' union all
select 2,to_timestamp('07-Aug-2008 13:50:00','dd-Mon-yyyy hh24:mi:ss'),'Review' union all
select 2,to_timestamp('14-Aug-2008 14:30:00','dd-Mon-yyyy hh24:mi:ss'),'Work' union all
select 2,to_timestamp('15-Aug-2008 16:20:00','dd-Mon-yyyy hh24:mi:ss'),'Review' union all
select 2,to_timestamp('16-Aug-2008 18:02:00','dd-Mon-yyyy hh24:mi:ss'),'Accepted' union all
select 2,to_timestamp('17-Aug-2008 22:10:00','dd-Mon-yyyy hh24:mi:ss'),'Done';

insert into ObjectState (object_id,event_time,state)
select 3,to_timestamp('12-Sep-2008 13:30:00','dd-Mon-yyyy hh24:mi:ss'),'Initial' union    all
select 3,to_timestamp('13-Sep-2008 13:40:00','dd-Mon-yyyy hh24:mi:ss'),'Work' union all
select 3,to_timestamp('14-Sep-2008 13:50:00','dd-Mon-yyyy hh24:mi:ss'),'Review' union   all
select 3,to_timestamp('15-Sep-2008 14:30:00','dd-Mon-yyyy hh24:mi:ss'),'Work' union all
select 3,to_timestamp('16-Sep-2008 16:20:00','dd-Mon-yyyy hh24:mi:ss'),'Review';

insert into ObjectState (object_id,event_time,state)
select 4,to_timestamp('21-Aug-2008 03:10:00','dd-Mon-yyyy hh24:mi:ss'),'Initial' union all
select 4,to_timestamp('22-Aug-2008 03:40:00','dd-Mon-yyyy hh24:mi:ss'),'Work' union all
select 4,to_timestamp('23-Aug-2008 03:20:00','dd-Mon-yyyy hh24:mi:ss'),'Review' union all
select 4,to_timestamp('24-Aug-2008 04:30:00','dd-Mon-yyyy hh24:mi:ss'),'Work'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T15:01:36.180

这是使用分析函数的 Oracle 方法。

```
with data as (
SELECT 1 trip_id, to_date('20080801 13:30:00','YYYYMMDD HH24:mi:ss') dt, 'Initial'  step from dual UNION ALL
SELECT 1 trip_id, to_date('20080802 13:30:00','YYYYMMDD HH24:mi:ss') dt, 'Work'     step from dual  UNION ALL
SELECT 1 trip_id, to_date('20080803 13:30:00','YYYYMMDD HH24:mi:ss') dt, 'Review'   step from dual  UNION ALL
SELECT 1 trip_id, to_date('20080804 13:30:00','YYYYMMDD HH24:mi:ss') dt, 'Work'     step from dual UNION ALL
SELECT 1 trip_id, to_date('20080805 13:30:00','YYYYMMDD HH24:mi:ss') dt, 'Review'   step from dual  UNION ALL
SELECT 1 trip_id, to_date('20080806 13:30:00','YYYYMMDD HH24:mi:ss') dt, 'Accepted' step from dual  UNION ALL
SELECT 1 trip_id, to_date('20080807 13:30:00','YYYYMMDD HH24:mi:ss') dt, 'Done'     step from dual )
select trip_id,
       step,
       dt - lag(dt) over (partition by trip_id order by dt) trip_time
from  data
/

1   Initial 
1   Work        1
1   Review      1
1   Work        1
1   Review      1
1   Accepted    1
1   Done        1 
```

这些在传统上我们可能使用自联接的情况下非常常用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-21T00:10:09.493

我试图在 MySQL 中做到这一点。你需要使用一个变量，因为 MySQL 中没有 rank 函数，所以它会像这样：

```
set @trip1 = 0; set @trip2 = 0;
SELECT trip1.`date` as startdate, datediff(trip2.`date`, trip1.`date`) length_of_trip
FROM
(SELECT @trip1 := @trip1 + 1 as rank1, `date` from trip where state='Initial') as trip1
INNER JOIN
(SELECT @trip2 := @trip2 + 1 as rank2, `date` from trip where state='Done') as trip2
ON rank1 = rank2; 
```

我假设您要计算“初始”和“完成”状态之间的时间。

```
+---------------------+----------------+
| startdate           | length_of_trip |
+---------------------+----------------+
| 2008-08-01 13:30:00 |              6 |
+---------------------+----------------+ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T13:45:36.597

如果你有一个序列号和时间戳可能会更容易：在大多数 RDBMS 中，你可以创建一个自动增量列而不更改任何`INSERT`语句。然后你用它自己的副本加入表以获取增量

```
select after.moment - before.moment, before.state, after.state
from object_states before, object_states after
where after.sequence + 1 = before.sequence 
```

（SQL 语法的详细信息将根据数据库系统而有所不同）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T13:33:37.997

I'm not sure I understand the question exactly, but you can do something like the following which reads the table in one pass then uses a derived table to calculate it. SQL Server code:

```
CREATE TABLE #testing
(
    eventdatetime datetime NOT NULL,
    state varchar(10) NOT NULL
)

INSERT INTO #testing (
    eventdatetime,
    state
) 
SELECT '20080801 13:30:00', 'Initial' UNION ALL
SELECT '20080802 13:30:00', 'Work' UNION ALL
SELECT '20080803 13:30:00', 'Review' UNION ALL
SELECT '20080804 13:30:00', 'Work' UNION ALL
SELECT '20080805 13:30:00', 'Review' UNION ALL
SELECT '20080806 13:30:00', 'Accepted' UNION ALL
SELECT '20080807 13:30:00', 'Done'

SELECT DATEDIFF(dd, Initial, Review)
FROM (
SELECT  MIN(CASE WHEN state='Initial' THEN eventdatetime END) AS Initial,
        MIN(CASE WHEN state='Review' THEN eventdatetime END) AS Review
FROM #testing
) AS A

DROP TABLE #testing 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T13:33:58.590

```
create table A (
    At datetime not null,
    State varchar(20) not null
)
go
insert into A(At,State)
select '2008-08-01T13:30:00','Initial' union all
select '2008-08-02T13:30:00','Work' union all
select '2008-08-03T13:30:00','Review' union all
select '2008-08-04T13:30:00','Work' union all
select '2008-08-05T13:30:00','Review' union all
select '2008-08-06T13:30:00','Accepted' union all
select '2008-08-07T13:30:00','Done'
go
--Find trip time from Initial to Done
select DATEDIFF(day,t1.At,t2.At)
from
    A t1
        inner join
    A t2
        on
            t1.State = 'Initial' and
            t2.State = 'Review' and
            t1.At < t2.At
        left join
    A t3
        on
            t3.State = 'Initial' and
            t3.At > t1.At and
            t4.At < t2.At
        left join
    A t4
        on
            t4.State = 'Review' and
            t4.At < t2.At and
            t4.At > t1.At
where
    t3.At is null and
    t4.At is null 
```

Didn't say whether joins were allowed or not. Joins to t3 and t4 (and their comparisons) let you say whether you want the earliest or latest occurrence of the start and end states (in this case, I'm asking for latest "Initial" and earliest "Review")

In real code, my start and end states would be parameters

Edit: Oops, need to include "t3.At < t2.At" and "t4.At > t1.At", to fix some odd sequences of States (e.g. If we removed the second "Review" and then queried from "Work" to "Review", the original query will fail)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T14:29:28.130

我认为您的步骤（您旅行的每个记录都可以视为一个步骤）可以作为同一活动的一部分组合在一起。然后可以对它的数据进行分组，例如：

```
SELECT Min(Tbl_Step.dateTimeStep) as tripBegin, _   
       Max(Tbl_Step.dateTimeStep) as tripEnd _
FROM 
       Tbl_Step 
WHERE 
       id_Activity = 'AAAAAAA' 
```

使用此原理，您可以计算其他聚合，例如活动中的步骤数等。但是您不会找到一种 SQL 方法来计算诸如 2 步之间的差距之类的值，因为这样的数据既不属于第一步也不属于第二步。一些报告工具使用他们所谓的“运行总和”来计算此类中间数据。根据您的目标，这可能是您的解决方案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T13:59:12.040

```
 -- Oracle SQl

    CREATE TABLE ObjectState
    (
        startdate date NOT NULL,
        state varchar2(10) NOT NULL
    );

   insert into ObjectState 
   select to_date('01-Aug-2008 13:30:00','dd-Mon-rrrr hh24:mi:ss'),'Initial' union all
   select to_date('02-Aug-2008 13:30:00','dd-Mon-rrrr hh24:mi:ss'),'Work' union all
   select to_date('03-Aug-2008 13:30:00','dd-Mon-rrrr hh24:mi:ss'),'Review' union all
   select to_date('04-Aug-2008 13:30:00','dd-Mon-rrrr hh24:mi:ss'),'Work' union all
   select to_date('05-Aug-2008 13:30:00','dd-Mon-rrrr hh24:mi:ss'),'Review' union all
   select to_date('06-Aug-2008 13:30:00','dd-Mon-rrrr hh24:mi:ss'),'Accepted' union all
   select to_date('07-Aug-2008 13:30:00','dd-Mon-rrrr hh24:mi:ss'),'Done';

-- Days in between two states

  select  o2.startdate - o1.startdate as days
  from ObjectState o1, ObjectState o2
  where o1.state = 'Initial'
  and o2.state = 'Review'; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-30T16:36:54.607

好吧，这有点令人讨厌，但我构建了一个 Web 应用程序来跟踪我妻子在我们生孩子之前的宫缩，这样我就可以在快到医院的时候看到工作。无论如何，我很容易将这个基本的东西构建为两个视图。

```
create table contractions time_date timestamp primary key;

create view contraction_time as
SELECT a.time_date, max(b.prev_time) AS prev_time
   FROM contractions a, ( SELECT contractions.time_date AS prev_time
           FROM contractions) b
  WHERE b.prev_time < a.time_date
  GROUP BY a.time_date;

create view time_between as 
SELECT contraction_time.time_date, contraction_time.prev_time, contraction_time.time_date - contraction_time.prev_time
   FROM contraction_time; 
```

这显然也可以作为子选择来完成，但是我也将中间视图用于其他事情，所以效果很好。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-17T13:24:31.297

我不认为您可以通过一条 SQL 语句得到答案，因为您正试图从许多记录中获取一个结果。在 SQL 中实现这一点的唯一方法是获取两个不同记录的时间戳字段并计算差异 (datediff)。因此，需要 UNIONS 或 Inner Joins。

# ruby-on-rails - 删除 Rails 中的静态文件缓存清除

> ID：83058
> 
> 赞同：1
> 
> 时间：2008-09-17T13:17:15.480
> 
> 标签：ruby-on-rails, caching

我有一个`rails`应用程序，它仍然在静态模式的 URL 末尾显示 cachebusting 数字字符串，即使我已将其放入生产环境。有人可以告诉我需要设置什么配置选项来防止这种行为...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T13:30:36.617

该文件不会在日常操作中破坏缓存。至少在理论上，代理服务器可以缓存 HTTP GET 请求（只要参数保持不变）。

相反，该数字允许您将 CSS 和 JavaScript 文件从一个版本顺利升级到下一个版本。据我了解，它应该保持在生产模式。仅当文件上的时间戳更改时，数字才应更改。

您是否看到完全无法使用单个参数缓存任何 HTTP GET 请求的常见代理服务器？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T13:43:37.287

要在生产中禁用 ?timestamp 缓存破坏，请将其添加到您的 config/environments/production.rb

```
ENV['RAILS_ASSET_ID'] = '' 
```

如果您想深入了解它的作用，请查看 ActionPack gem 中的asset_tag_helper.rb，第 527 行（ish）

# grammar - 解析树和语法信息

> ID：83064
> 
> 赞同：5
> 
> 时间：2008-09-17T13:18:02.777
> 
> 标签：grammar, parsing, concrete-syntax-tree

有谁知道在哪里可以找到好的在线资源以及如何制作语法和解析树的示例？最好是介绍材料。对 n00b 友好的信息，我自己在 Google 上没有发现任何好处。

**编辑：**我在考虑理论，而不是特定的解析器软件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T13:36:04.607

不在网上，但也许你应该看看Aho 等人的[编译器：原理、技术和工具（第 2 版）](https://rads.stackoverflow.com/amzn/click/com/0321486811)。这是一部经过30年演变的标准文本（如果算上1977年出版的第一部[龙书）](https://rads.stackoverflow.com/amzn/click/com/0201000229)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T13:19:53.570

嗯，这就是我学到的地方......

[http://www.cs.uiuc.edu/class/sp08/cs273/](http://www.cs.uiuc.edu/class/sp08/cs273/)

单击讲座标签，滚动浏览，直到找到有关您正在谈论的材料的讲座。

爱我的母校。上帝保佑他们，他们在任何课堂上都不会记下他们的课，你可以随时去阅读其中的任何一个。

编辑：看起来你想要讲座11

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T13:21:30.040

蚂蚁？

[http://www.antlr.org/](http://www.antlr.org/)

有一个很好的 IDE 用于设计语法，还有很多不同语言的生成器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T13:32:40.573

[www.goldparser.com](http://www.goldparser.com)

The tools are free and good to work on. It has technical and theoretical tutorials, lots of info, tools and code generators for many langs.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-02-13T14:17:06.387

在 C、C++ 中使用[lex 和 bison](http://dinosaur.compilertools.net/) 在 java 中使用[ANTLR](http://www.antlr.org/) 这是一个漂亮的 antlr 视频[教程](http://vimeo.com/groups/29150/videos/8377605)

# oracle - ORA-03113: 在 ASP.Net 应用程序中长时间不活动后，通信通道上的文件结束

> ID：83068
> 
> 赞同：24
> 
> 时间：2008-09-17T13:18:42.027
> 
> 标签：oracle, oracle10g, odp.net, oracleexception

我在 IIS5 上有一个负载平衡（不使用会话状态）ASP.Net 2.0 应用程序，它使用 ODAC/ODP.Net 驱动程序的 10.1.0.301 版本运行回单个 Oracle 10g 服务器。在长时间不活动（几个小时）之后，应用程序似乎随机地抛出一个 Oracle 异常：

> 异常：ORA-03113：Oracle.DataAccess.Client.OracleException.HandleErrorHelper（Int32 errCode，OracleConnection conn，IntPtr opsErrCtx，OpoSqlValCtx* pOpoSqlValCtx* pOpoSqlValCtx，Object src，String 过程）在 Oracle.DataAccess.Client 的通信通道上的文件结尾Oracle.DataAccess.Client.OracleCommand.System.Data.IDbCommand.ExecuteReader() 处的 .OracleCommand.ExecuteReader（布尔重新查询，布尔填充请求，CommandBehavior 行为）
> 
> ...堆栈的 Oracle 部分到此结束...

我们正在为每个请求创建新连接，将打开和关闭包装在 try/catch/finally 中以确保正确关闭连接，并且整个事情都包装在 using (OracleConnection yadayada) {...} 块中。此问题似乎与 ASP.Net 应用程序因不活动而停止后重新启动有关。

我们还没有自己重现这个问题。思想、祈祷、帮助？

* * *

**更多：**与 IT 核实，防火墙未设置为终止这些服务器之间的连接。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-18T11:56:28.847

> ORA-03113: 通信通道上的文件结尾

数据库是否让您知道网络连接已不存在。这可能是因为：

1.  网络问题 - 连接错误或防火墙问题
2.  为您提供服务的数据库上的服务器进程意外死亡。

对于 1)（**防火墙**）在 tahiti.oracle.com 中搜索`SQLNET.EXPIRE_TIME`. 这是一个 sqlnet.ora 参数，它将以可配置的时间间隔定期发送网络数据包，即：设置这将使防火墙相信连接是活动的。

对于 1) ( **network** ) 与您的网络管理员交谈（连接可能不可靠）

2）检查`alert.log`错误。如果服务器进程失败，则会出现错误消息。还将编写一个跟踪文件以支持识别问题。错误消息将引用跟踪文件。

可以使用合适的客户服务标识符 (CSI)在*metalink.oracle.com*上提出支持问题

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-08-08T21:44:51.240

将**Validate Connection=true**添加到您的连接字符串。

查看[此博客](http://www.eggheadcafe.com/tutorials/aspnet/df2b05d8-93ea-49e1-aeaa-d116a4d6ac3b/adonet-connection-poolin.aspx)以了解更多信息。

**详细信息：** 在 OracleConnection.Close() 之后，真正的数据库连接不会终止。连接对象被放回连接池。ODP.NET 隐含了连接池的使用。如果您创建一个新连接，您将获得一个池。如果此连接“尚未打开”，则 OracleConnection.Open() 方法不会真正创建新连接。如果实际连接中断（出于任何原因），您在第一次选择、更新、插入或删除时会失败。

使用验证连接，真正的连接在 Open() 方法中得到验证。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-17T14:00:20.350

检查是否有防火墙在一段时间后终止连接（这是我们遇到类似问题的原因）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-12T14:45:31.850

> 通信通道上的文件结尾：

此错误的过程之一是由于数据库在打开阶段无法写入日志；

解决方案检查数据库是否在 ARCHIVELOG 或 NOARCHIVELOG 中运行

检查使用

```
select log_mode from v$database; 
```

如果它在`ARCHIVELOG`尝试变成`NOARCHIVELOG`

通过使用 sqlplus

*   启动挂载
*   更改数据库 noarchivelog；
*   更改数据库打开；

如果它适用于此

然后你可以调整你的 flashrecovery 区域，它可能是你的 flashrecovery 区域已满 -> 然后在确认你的 flashrecovery 区域有空间之后，你可以将你的数据库更改为`ARCHIVELOG`

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-03-24T21:38:41.043

当实际问题是 oracle 数据库服务器空间不足时，可能会在应用程序日志中引发此错误消息。

更正空间问题后，此特定错误消息消失了。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-18T15:51:11.857

你可以试试这个注册表黑客：

```
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters]
"DeadGWDetectDefault"=dword:00000001
"KeepAliveTime"=dword:00120000 
```

如果有效，请继续增加`KeepAliveTime`. 当前设置为 2 分钟。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-09T12:13:58.500

前面提到的文章不错。[http://forums.oracle.com/forums/thread.jspa?threadID=191750](http://forums.oracle.com/forums/thread.jspa?threadID=191750) （就目前而言）

如果这不是经常运行的东西（不要在你的主页上这样做），你可以关闭连接池。

文章中没有提到另一个“陷阱”。如果您尝试对连接执行的第一件事是调用存储过程，ODP 将挂起！！！！你不会得到一个错误条件来管理，只是一个完整的 HANG！修复它的唯一方法是关闭连接池。一旦我们这样做了，所有问题都消失了。

在某些情况下，池化很好，但代价是每个连接的第一条语句的复杂性增加。

如果错误处理方法这么好，为什么不让 ODP 为我们处理它？？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-12-17T16:19:34.400

//首先以mount方式启动数据库startup mount

//禁用archivelog alter database noarchivelog //然后把db放到open alter database open

# html - 为什么不在 HTML 中使用表格进行布局？

> ID：83073
> 
> 赞同：665
> 
> 时间：2008-09-17T13:19:09.297
> 
> 标签：html, css

似乎[普遍认为](https://stackoverflow.com/questions/82391/should-tables-be-avoided-in-html-at-any-cost#82402)不应将表格用于 HTML 中的布局。

为什么？

我从来没有（或很少说实话）看到这方面的好论据。通常的答案是：

*   [将内容与布局分开](https://stackoverflow.com/questions/82391/should-tables-be-avoided-in-html-at-any-cost#82422)很好，
    但这是一个错误的论点；[陈词滥调](http://www.don-lindsay-archive.org/skeptic/arguments.html#cliche)。我想确实使用表格元素进行布局与表格数据几乎没有关系。所以呢？我的老板在乎吗？我的用户关心吗？

    也许我或我的开发人员必须维护一个网页关心... 是一个表更难维护吗？我认为使用表格比使用 div 和 CSS[更容易。](https://stackoverflow.com/questions/82391/should-tables-be-avoided-in-html-at-any-cost#82571)

    顺便说一句...为什么不使用 div 或 span 将内容与布局和表格很好地分离？仅使用 div 获得良好的布局通常需要大量嵌套的 div。

*   代码的可读性
    我认为是相反的。大多数人了解 HTML，很少有人了解 CSS。

*   SEO最好不要使用表格
    为什么？任何人都可以证明它是一些证据吗？或者来自谷歌的声明从 SEO 的角度来看不鼓励使用表格？

*   表比较慢。
    必须插入一个额外的 tbody 元素。这是现代网络浏览器的小菜一碟。向我展示一些使用表格显着减慢页面速度的基准。

*   如果没有表格，布局大修会更容易，请参阅[css Zen Garden](http://csszengarden.com/)。
    大多数需要升级的网站也需要新内容 (HTML)。一个新版本的网站只需要一个新的 CSS 文件的情况不太可能发生。Zen Garden 是一个不错的网站，但有点理论化。更不用说它对CSS 的[滥用](https://stackoverflow.com/questions/83073/div-vs-table#83639)。

我对使用 divs + CSS 而不是表格的好论据非常感兴趣。

* * *

## 回答 #1

> 赞同：495
> 
> 时间：2008-09-17T16:23:06.623

我将一个接一个地检查您的论点，并尝试显示其中的错误。

> 将内容与布局分开很好，但这是一个错误的论点；陈词滥调的思考。

这一点都不荒谬，因为 HTML 是有意设计的。滥用某个元素可能并非完全没有问题（毕竟，其他语言中也出现了新的习语），但必须抵消可能的负面影响。此外，即使`<table>`今天没有反对滥用该元素的论据，由于浏览器供应商对元素应用特殊处理的方式，明天可能会有。毕竟，他们知道“<code><table> 元素仅用于表格数据”，并且可能会利用这一事实来改进渲染引擎，在此过程中巧妙地改变`<table>`s 的行为方式，从而打破以前被滥用的情况。

> 所以呢？我的老板在乎吗？我的用户关心吗？

依靠。你的老板是尖头发吗？那么他可能不在乎。如果她有能力，那么她会关心，因为用户[会](http://www.hotdesign.com/seybold/)。

> 也许我或我的开发人员必须维护一个网页关心... 是一个表更难维护吗？我认为使用表格比使用 div 和 css 更容易。

~~大多数专业的 Web 开发人员似乎都反对你~~^([*需要引用*])。表*实际上*不太可维护应该是显而易见的。使用表格进行布局意味着更改公司布局实际上意味着更改每个页面。这可能*非常*昂贵。另一方面，明智地使用语义上有意义的 HTML 和 CSS*可能会将*此类更改限制在 CSS 和所使用的图片上。

> 顺便说一句...为什么不使用 div 或 span 将内容与布局和表格很好地分离？仅使用 div 获得良好的布局通常需要大量嵌套的 div。

`<div>`就像表格布局一样，深度嵌套的 s 是一种反模式。好的网页设计师不需要很多。另一方面，即使是这种深度嵌套的 div 也不会有很多表格布局的问题。事实上，它们甚至可以通过在逻辑上将内容分成几部分来为语义结构做出贡献。

> 代码的可读性我认为是相反的。大多数人了解html，很少了解css。它更简单。

“大多数人”并不重要。专业人士很重要。对于专业人士来说，表格布局比 HTML + CSS 产生的问题要多得多。这就像说我不应该使用 GVim 或 Emacs，因为记事本对大多数人来说更简单。或者我不应该使用 LaTeX，因为 MS Word 对大多数人来说更简单。

> SEO最好不要使用表格

我不知道这是否属实，也不会将其用作论据，但这是合乎逻辑的。搜索引擎搜索*相关*数据。虽然表格数据当然可能是相关的，但它很少是用户搜索的内容。用户搜索页面标题或类似突出位置中使用的术语。因此，从过滤中排除表格内容是合乎逻辑的，从而大大减少了处理时间（和成本！）。

> 表比较慢。必须插入一个额外的 tbody 元素。这是现代网络浏览器的小菜一碟。

额外的元素与表变慢无关。另一方面，表格的布局算法要困难得多，浏览器通常必须等待整个表格加载后才能开始布局内容。此外，布局的缓存不起作用（CSS 可以很容易地被缓存）。这一切都在前面提到过。

> 向我展示一些使用表格显着减慢页面速度的基准。

不幸的是，我没有任何基准数据。我自己会对它感兴趣，因为这个论点缺乏一定的科学严谨性是正确的。

> 大多数需要升级的网站也需要新内容 (html)。一个新版本的网站只需要一个新的 css 文件的情况不太可能发生。

一点也不。我处理过几个案例，通过分离内容和设计来简化设计更改。通常仍然需要更改一些 HTML 代码，但更改总是会受到更多限制。此外，有时必须动态地进行设计更改。考虑模板引擎，例如 WordPress 博客系统使用的模板引擎。表格布局实际上会扼杀这个系统。我曾为商业软件处理过类似的案例。能够在不更改 HTML 代码的情况下更改设计是业务需求之一。

另一件事。表格布局使网站的自动解析（屏幕抓取）变得更加困难。这听起来可能微不足道，因为毕竟是谁做的呢？我自己也很惊讶。如果有问题的服务没有提供 WebService 替代方案来访问其数据，那么屏幕抓取可以提供很大帮助。我在生物信息学领域工作，这是一个可悲的现实。现代 Web 技术和 WebServices 尚未普及到大多数开发人员，通常，屏幕抓取是自动化获取数据过程的唯一方法。难怪许多生物学家仍然手动执行此类任务。对于数千个数据集。

* * *

## 回答 #2

> 赞同：289
> 
> 时间：2008-09-17T14:03:51.187

这是我的*程序员*在[类似线程中的回答](https://stackoverflow.com/questions/5323/is-there-a-business-reason-for-striving-for-pure-css-layout#75488)

**语义 101**

先看看这段代码，想想这里出了什么问题……

```
class car {
    int wheels = 4;
    string engine;
}

car mybike = new car();
mybike.wheels = 2;
mybike.engine = null; 
```

当然，问题在于自行车不是汽车。汽车类是不适合自行车实例的类。代码没有错误，但*语义*不正确。它对程序员的反映很差。

**语义 102**

现在将其应用于文档标记。如果您的文档需要显示表格数据，那么适当的标签将是`<table>`. 但是，如果您将导航放置在表格中，那么您就误用了该`<table>`元素的预期用途。在第二种情况下，您没有呈现表格数据 - 您正在（错误地）使用`<table>`元素来实现呈现目标。

**结论**

游客会注意到吗？不，你的老板在乎吗？也许。作为程序员，我们有时会偷工减料吗？当然。但我们应该吗？不。如果您使用语义标记，谁会受益？你——还有你的职业声誉。现在去做正确的事。

* * *

## 回答 #3

> 赞同：104
> 
> 时间：2008-09-17T13:33:01.620

显而易见的答案：参见[CSS Zen Garden](http://csszengarden.com)。如果你告诉我你可以很容易地用基于表格的布局来做同样的事情（记住——HTML 没有改变），那么一定要使用表格进行布局。

另外两个重要的事情是可访问性和 SEO。

两者都关心以什么顺序显示信息。如果基于表格的布局将导航放置在页面上第二个嵌套表格的第二行的第三个单元格中，您将无法轻松地在页面顶部显示导航。

所以你的答案是可维护性、可访问性和 SEO。

不要偷懒。以正确和正确的方式做事，即使它们有点难学。

* * *

## 回答 #4

> 赞同：91
> 
> 时间：2008-09-17T13:23:53.917

[请参阅这个重复的问题。](https://stackoverflow.com/questions/30251/tables-instead-of-divs#30271)

您忘记的一项是可访问性。例如，如果您需要使用屏幕阅读器，则基于表格的布局也无法翻译。如果您为政府工作，可能*需要*支持屏幕阅读器等可访问的浏览器。

我也认为你低估了你在问题中提到的一些事情的影响。例如，如果您既是设计师又是程序员，您可能无法完全了解它如何将表示与内容分开。但是一旦你进入一家他们是两个不同角色的商店，优势就开始变得更加明显。

如果您知道自己在做什么并且拥有好的工具，那么 CSS 在布局方面确实比表格具有显着优势。虽然每个项目本身可能无法证明放弃桌子是合理的，但总的来说它是值得的。

* * *

## 回答 #5

> 赞同：54
> 
> 时间：2008-09-17T14:09:16.867

不幸的是，CSS Zen Garden 不能再被用作良好的 HTML/CSS 设计的例子。几乎他们最近的所有设计都使用图形作为章节标题。这些图形文件在 CSS 中指定。

因此，一个旨在展示将设计排除在内容之外的优势的网站，现在经常犯下将内容融入设计的不可言喻的罪恶。（如果 HTML 文件中的节标题发生更改，则显示的节标题不会）。

这只能表明，即使是那些崇尚严格的 DIV 和 CSS 宗教的人，也不能遵循自己的规则。您可以将其用作您遵循它们的程度的指导方针。

* * *

## 回答 #6

> 赞同：48
> 
> 时间：2008-09-17T13:23:22.407

无论如何，这不是最终的论点，但使用 CSS，您可以采用相同的标记并根据媒介更改布局，这是一个很好的优势。例如，对于打印页面，您可以安静地抑制导航，而无需创建适合打印的页面。

* * *

## 回答 #7

> 赞同：45
> 
> 时间：2008-09-17T15:36:31.900

一张用于布局的桌子不会那么糟糕。但大多数时候，您无法通过一张桌子获得所需的布局。很快你就会有 2 或 3 个嵌套表。这变得非常麻烦。

*   阅读起来要困难得多。这不取决于意见。只有更多的嵌套标签，上面没有识别标记。

*   将内容与演示分开是一件好事，因为它可以让您专注于您正在做的事情。将两者混合会导致页面臃肿，难以阅读。

*   样式的 CSS 允许您的浏览器缓存文件并且后续请求更快。这是巨大的。

*   表格将您锁​​定在设计中。当然，不是每个人都需要 CSS Zen Garden 的灵活性，但我从来没有在一个网站上工作过，我不需要在这里和那里稍微改变设计。使用 CSS 更容易。

*   表格很难设计。您对它们没有太大的灵活性（即您仍然需要添加 HTML 属性来完全控制表格的样式）

我可能已经有 4 年没有使用表格来存储非表格数据了。我没有回头。

我真的很想推荐阅读Andy Budd 的[CSS Mastery](http://cssmastery.com/)。这是梦幻般的。

[图片位于 ecx.images-amazon.com http://ecx.images-amazon.com/images/I/41TH5NFKPEL._SL500_BO2,204,203,200_PIsitb-dp-500-arrow,TopRight,45,-64_OU01_AA240_SH20_.jpg](http://ecx.images-amazon.com/images/I/41TH5NFKPEL._SL500_BO2,204,203,200_PIsitb-dp-500-arrow,TopRight,45,-64_OU01_AA240_SH20_.jpg)

* * *

## 回答 #8

> 赞同：36
> 
> 时间：2008-09-17T13:47:25.407

> 将内容与布局分开很好，
> 但这是一个错误的论点；陈词滥调

这是一个错误的论点，因为 HTML 表格是布局！内容是表格中的*数据*，表现形式是表格本身。这就是为什么有时很难将 CSS 与 HTML 分开的原因。您不是将内容与演示文稿分开，而是将演示文稿与演示文稿分开！一堆嵌套的 div 与一个表没有什么不同——它只是一组不同的标签。

将 HTML 与 CSS 分离的另一个问题是它们需要彼此熟悉——你真的无法将它们完全分离。无论您做什么，HTML 中的标签布局都与 CSS 文件紧密耦合。

我认为表格与 div 取决于您的应用程序的需求。

在我们在工作中开发的应用程序中，我们需要一个页面布局，其中各个部分可以根据其内容动态调整大小。我花了几天时间试图让它与 CSS 和 DIV 跨浏览器一起工作，这完全是一场噩梦。我们换了桌子，一切都刚刚*好*。

然而，我们的产品拥有非常封闭的受众（我们销售带有 Web 界面的硬件），并且可访问性问题不是我们关心的问题。我不知道为什么屏幕阅读器不能很好地处理表格，但我想如果是这样的话，那么开发人员必须处理它。

* * *

## 回答 #9

> 赞同：23
> 
> 时间：2010-11-25T14:25:39.297

CSS/DIV - 这只是设计男孩的工作，不是吗。我花了数百个小时调试 DIV/CSS 问题，在 Internet 上搜索以使某些标记与一个不起眼的浏览器一起工作——这让我发疯。你做了一点点改动，整个布局就大错特错了——这其中的逻辑到底在哪里。花几个小时以这种方式移动 3 个像素的东西，然后再移动 2 个像素的东西，以使它们全部对齐。不知何故，这对我来说似乎是完全错误的。仅仅因为你是一个纯粹主义者并且某事“不应该做”并不意味着你应该在任何情况下都充分利用它，尤其是如果它能让你的生活轻松 1000 倍。

所以我最终决定，纯粹出于商业原因，虽然我一直使用到最低限度，如果我预计需要 20 小时的工作才能正确放置 DIV，我会坚持使用一张桌子。这是错误的，它让纯粹主义者感到不安，但在大多数情况下，它花费的时间更少，管理成本更低。然后我可以专注于让应用程序按照客户的要求运行，而不是取悦纯粹主义者。毕竟他们确实支付了账单，而我对强制使用 CSS/DIV 的经理的争论——我只想指出客户也支付他的薪水！

所有这些 CSS/DIV 争论出现的唯一原因是首先是因为 CSS 的缺点，并且因为浏览器彼此不兼容，如果它们相互兼容，世界上一半的网页设计师将失业.

当你设计一个windows窗体时，你不会在布局后尝试移动控件，所以我觉得你为什么要使用Web窗体来做这件事对我来说很奇怪。我简直无法理解这个逻辑。让布局正确开始，问题出在哪里。我认为这是因为设计师喜欢与创造力调情，而应用程序开发人员更关心的是让应用程序实际工作、创建业务对象、实施业务规则、弄清楚客户数据之间的关系，确保产品满足客户需求要求 - 你知道 - 就像现实世界的东西。

不要误会我的意思，这两个论点都是有效的，但请不要批评开发人员选择了一种更简单、更合乎逻辑的方法来设计表单。我们经常需要担心比在 div 上使用 table 的正确语义更重要的事情。

举个例子——基于这个讨论，我将一些现有的 tds 和 trs 转换为 div。45 分钟搞乱它试图让所有东西都排成一列，我放弃了。TD 会在 10 秒后返回 - 立即生效 - 在所有浏览器上，无需再做任何事情。请试着让我理解——你有什么可能的理由让我以其他方式去做！

* * *

## 回答 #10

> 赞同：21
> 
> 时间：2011-02-10T23:52:02.743

布局应该很容易。有文章介绍如何在 CSS 中实现带页眉和页脚的动态三列布局，这表明它是一个糟糕的布局系统。当然你可以让它工作，但是网上有数百篇关于如何做到这一点的文章。几乎没有类似的表格布局的文章，因为它是显而易见的。无论您说什么反对表格和支持 CSS，这一事实都消除了这一切：CSS 中的基本三列布局通常被称为“圣杯”。

如果这还不能让你说“WTF”，那么你现在真的需要放下酷爱了。

我喜欢 CSS。它提供了惊人的样式选项和一些很酷的定位工具，但作为一个布局引擎它是有缺陷的。需要某种类型的动态网格定位系统。一种直接在多个轴上对齐框的方法，而无需先知道它们的大小。我不在乎你称它为 <table> 或 <gridlayout> 什么的，但这是 CSS 中缺少的基本布局功能。

更大的问题是，由于不承认缺少功能，CSS 狂热者一直在阻碍 CSS 的发展。如果 CSS 像世界上所有其他布局引擎一样提供体面的多轴网格定位，我会非常乐意停止使用表格。（你确实意识到这个问题已经被除 W3C 之外的所有人用多种语言多次解决过，对吧？没有其他人否认这样的功能很有用。）

叹。足够的通风。继续，把头伸回沙子里。

* * *

## 回答 #11

> 赞同：19
> 
> 时间：2008-09-17T13:21:35.657

根据 508 合规性（适用于视觉障碍的屏幕阅读器），表格只能用于保存数据，而不是用于布局，因为它会导致屏幕阅读器崩溃。或者我被告知。

如果您为每个 div 指定名称，您也可以使用 CSS 将它们一起蒙皮。他们只是更痛苦地以你需要的方式坐下。

* * *

## 回答 #12

> 赞同：18
> 
> 时间：2008-09-18T10:10:56.557

这是最近项目中的一段 html：

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>{DYNAMIC(TITLE)}</title>
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="stylesheet" type="text/css" href="./styles/base.css" />
</head>
<body>
    <div id="header">
        <h1><!-- Page title --></h1>
        <ol id="navigation">
            <!-- Navigation items -->
        </ol>
        <div class="clearfix"></div>
    </div>
    <div id="sidebar">
        <!-- Sidebar content -->
    </div>
    <!-- Page content -->
    <p id="footer"><!-- Footer content --></p>
</body>
</html> 
```

这是与基于表格的布局相同的代码。

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>{DYNAMIC(TITLE)}</title>
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="stylesheet" type="text/css" href="./styles/base.css" />
</head>
<body>
    <table cellspacing="0">
        <tr>
            <td><!-- Page Title --></td>
            <td>
                <table>
                    <tr>
                        <td>Navitem</td>
                        <td>Navitem</td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>

    <table>
        <tr>
            <td><!-- Page content --></td>
            <td><!-- Sidebar content --></td>
        </tr>
        <tr>
            <td colspan="2">Footer</td>
        </tr>
    </table>
</body>
</html> 
```

我在基于表格的布局中看到的唯一清洁是我对缩进过分热心。我确信内容部分将有另外两个嵌入式表格。

另一件要考虑的事情：**文件大小**。我发现基于表格的布局通常是 CSS 对应布局的两倍。在我们的高速宽带上，这不是一个大问题，但在那些有拨号调制解调器的人身上。

* * *

## 回答 #13

> 赞同：14
> 
> 时间：2008-09-17T13:28:37.260

我想补充一点，基于 div 的布局更易于维护、发展和重构。只需在 CSS 中进行一些更改以重新排序元素即可。根据我的经验，重新设计使用表格的布局是一场噩梦（如果有嵌套表格则更是如此）。

[从语义](http://en.wikipedia.org/wiki/Semantic_Web)的角度来看，您的代码也具有意义。

* * *

## 回答 #14

> 赞同：13
> 
> 时间：2008-09-17T13:37:01.547

CSS 布局通常在可访问性方面要好得多，前提是内容以自然顺序出现并且在没有样式表的情况下也有意义。不仅是屏幕阅读器在与基于表格的布局作斗争：它们还使移动浏览器更难正确呈现页面。

此外，使用基于 div 的布局，您可以非常轻松地使用打印样式表做一些很酷的事情，例如从打印页面中排除页眉、页脚和导航 - 我认为用基于表格的布局。

如果您怀疑使用 div 比使用表格更容易将内容与布局分离，请查看[CSS Zen Garden](http://www.csszengarden.com/)中基于 div 的 HTML ，了解更改样式表如何彻底改变布局，并考虑是否可以如果 HTML 是基于表格的，则实现相同种类的布局...如果您正在执行基于表格的布局，则不太可能使用 CSS 来控制单元格中的所有间距和填充（如果您是几乎肯定会发现首先使用浮动 div 等更容易）。如果不使用 CSS 来控制所有这些，并且由于表格指定了 HTML 中从左到右和从上到下的顺序，表格往往意味着您的布局在 HTML 中变得非常固定。

实际上，我认为在不改变 div 的情况下完全改变基于 div 和 CSS 的设计的布局是非常困难的。然而，使用基于 div 和 CSS 的布局，调整诸如各种块之间的间距和它们的相对大小之类的东西要容易得多。

* * *

## 回答 #15

> 赞同：13
> 
> 时间：2008-09-17T13:48:40.457

DIV 中没有任何论据对我有利。

我会说：如果鞋子合脚，就穿上它。

值得注意的是，即使不是不可能，也很难找到一个好的 DIV+CSS 方法来呈现两列或三列中的内容，这在所有浏览器上都是一致的，并且看起来仍然符合我的预期。

这在我的大多数布局中都向表格倾斜了一点平衡，尽管我对使用它们感到内疚（不知道为什么，人们只是说这很糟糕，所以我试着听他们说），最后，务实的观点是它只是对我来说更容易和更快地使用 TABLEs。我没有按小时计费，所以桌子对我来说更便宜。

* * *

## 回答 #16

> 赞同：13
> 
> 时间：2010-08-09T13:10:10.447

这是一个备受争议的问题，这一事实证明了 W3C 未能预见将尝试的布局设计的多样性。使用 divs+css 进行语义友好的布局是一个很好的概念，但实现的细节存在缺陷，实际上限制了创作自由。

我试图将我们公司的一个网站从表格切换到 div，这真是令人头疼，以至于我完全放弃了投入其中的工作时间并回到表格。试图与我的 div 搏斗以获得对垂直对齐的控制，这使我遭受了重大心理问题的诅咒，只要这场辩论继续进行，我就永远不会动摇。

人们必须经常想出复杂而丑陋的变通方法来完成简单的设计目标（例如垂直对齐）这一事实强烈表明规则不够灵活。如果规格足够，那么为什么知名网站（如 SO）发现有必要使用表格和其他变通方法来改变规则？

* * *

## 回答 #17

> 赞同：12
> 
> 时间：2008-09-17T13:23:33.997

> 我想确实使用表格元素进行布局与表格数据几乎没有关系。所以呢？我的老板在乎吗？我的用户关心吗？

谷歌和其他自动化系统**确实**在乎，而且在许多情况下它们同样重要。非智能系统更容易解析和处理语义代码。

* * *

## 回答 #18

> 赞同：8
> 
> 时间：2008-09-17T13:26:08.593

不得不与一个涉及由某些应用程序生成的 6 层嵌套表的网站合作，并让它生成无效的 HTML，实际上是一个 3 小时的工作来纠正它，因为一个小改动就中断了。

这当然是边缘情况，但基于表格的设计是不可维护的。如果您使用 css，则将样式分开，因此在修复 HTML 时您不必担心破坏。

另外，用 JavaScript 试试这个。将单个表格单元格从一个位置移动到另一个表格中的另一个位置。在 div/span 只能以复制粘贴方式工作的地方执行起来相当复杂。

“我的老板在乎吗”

如果我是你的老板。你会关心的。;) 如果你珍惜你的生命。

* * *

## 回答 #19

> 赞同：7
> 
> 时间：2008-09-17T15:09:34.880

**布局灵活性**
假设您正在制作一个包含大量缩略图的页面。
**DIVs**：
如果你把每个缩略图放在一个 DIV 中，向左浮动，那么其中的 10 个可能会排成一行。使窗口更窄，然后 BAM - 它是连续 6 个，或 2 个，或者很多适合。
**表：**
您必须明确说明一行中有多少个单元格。如果窗口太窄，用户必须水平滚动。

**可维护性**
与上述情况相同。现在您想将三个缩略图添加到第三行。
**DIV：**
添加它们。布局将自动调整。
**表格：** 将新单元格粘贴到第三行。**哎呀！**现在那里的项目太多了。从那一排剪下一些，放在第四排。现在那里的项目太多了。从该行中删除一些...（等）
（*当然，如果您使用服务器端脚本生成行和单元格，这可能不会成为问题。*）

* * *

## 回答 #20

> 赞同：7
> 
> 时间：2008-09-17T15:43:11.617

我想那艘船已经航行了。如果您查看行业所采取的方向，您会注意到 CSS 和开放标准是该讨论的赢家。这反过来意味着对于大多数 html 工作，除了表单之外，设计师将使用 div 而不是表格。我很难做到这一点，因为我不是 CSS 专家，但事实就是如此。

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2008-09-17T13:30:49.643

另外，不要忘记，表格在移动浏览器上的渲染效果并不好。当然，iPhone 有一个很棒的浏览器，但不是每个人都有 iPhone。表格渲染对于现代浏览器来说可能是小菜一碟，但对于移动浏览器来说却是一堆西瓜。

我个人发现很多人使用了太多的`<div>`标签，但是适度的话，它可以非常干净且易于阅读。你提到人们阅读 CSS 比阅读表格更难；就“代码”而言，这可能是真的；但是在阅读内容（视图>源代码）方面，使用样式表比使用表格更容易理解结构。

* * *

## 回答 #22

> 赞同：5
> 
> 时间：2008-09-17T13:31:18.487

看起来你只是习惯了桌子，就是这样。将布局放在表格中会限制您仅使用该布局。使用 CSS 你可以移动位，看看[http://csszengarden.com/](http://csszengarden.com/) 不，布局通常不需要很多嵌套的 div。

没有用于布局和适当语义的表格，HTML 更干净，因此更易于阅读。为什么不懂 CSS 的人要尝试阅读它？如果有人认为自己是 web 开发人员，那么对 CSS 的良好掌握是必须的。

搜索引擎优化的好处来自于将最重要的内容放在页面上方的能力和更好的内容标记比。

[http://www.hotdesign.com/seybold/](http://www.hotdesign.com/seybold/)

* * *

## 回答 #23

> 赞同：5
> 
> 时间：2008-09-17T14:10:45.443

*   508 合规性 - 屏幕阅读器能够理解您的标记。
*   等待渲染 - 表格不会在浏览器中渲染，直到它到达`</table>`元素的末尾。

* * *

## 回答 #24

> 赞同：5
> 
> 时间：2008-09-17T14:52:38.963

围绕语义标记的整个想法是标记和表示的分离，其中包括布局。

Div 并没有取代表格，它们在将内容分成相关内容块（, ）方面有自己的用途。当您没有技能并且依赖表格时，您通常必须将您的内容分成单元格以获得所需的布局，但在使用语义标记时您不需要触摸标记来实现表示。当生成标记而不是静态页面时，这一点非常重要。

开发人员需要停止提供暗示布局的标记，以便我们这些具有呈现内容技能的人可以继续我们的工作，并且当演示需要更改时，开发人员不必回到他们的代码中进行更改。

* * *

## 回答 #25

> 赞同：4
> 
> 时间：2008-09-17T23:03:20.390

这并不是关于“divs 是否比布局表格更好”。了解 CSS 的人可以非常直接地使用“布局表”复制任何设计。真正的胜利是使用 HTML 元素来实现它们的用途。您不会将表格用于非表格数据的原因与您不将整数存储为字符串的原因相同 - 当您将技术用于其设计目的时，它会更容易工作。如果曾经有必要使用表格进行布局（因为 1990 年代初期的浏览器缺陷），那么现在肯定不是了。

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2008-09-17T14:54:10.660

由于创建布局所需的代码量，使用表格布局的工具可能会变得异常繁重。SAP 的 Netweaver Portal 默认使用 TABLE 来布局其页面。

我当前演出的生产 SAP 门户有一个主页，其 HTML 超过 60K，有 7 个表，页面内有 3 次。添加 Javascript，滥用 16 个 iframe，其中有类似的表格问题，过重的 CSS 等，页面重量超过 5MB。

花时间降低页面重量，以便您可以使用带宽与用户进行互动活动是值得的。

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2008-09-17T15:28:41.917

弄清楚 CSS 和 div 是值得的，以便在页面布局中的侧边栏之前加载和呈现中心内容列。但是，如果您正在努力使用浮动 div 将徽标与一些赞助文字垂直对齐，只需使用表格并继续生活。禅宗花园的宗教并没有带来太多的收益。

将内容与表示分离的想法是对应用程序进行分区，以便不同类型的工作影响不同的代码块。这实际上是关于变更管理。但是编码标准只能以肤浅的方式检查代码的当前状态。

依赖于编码标准以“将内容与表示分离”的应用程序的更改日志将显示跨垂直孤岛的并行更改模式。如果“内容”的变化总是伴随着“表现”的变化，那么分区的成功率如何？

如果您真的想高效地对代码进行分区，请使用 Subversion 并查看您的更改日志。然后使用最简单的编码技术——div、表格、JavaScript、包含、函数、对象、延续，等等——来构建应用程序，以便以简单和舒适的方式进行更改。

* * *

## 回答 #28

> 赞同：3
> 
> 时间：2008-09-18T09:43:50.553

*表格通常*并不比 CSS 更容易或更易于维护。但是，在一些*特定*的布局问题中，表格确实是最简单、最灵活的解决方案。

在表现性标记和 CSS 支持相同类型的设计的情况下，CSS 显然更可取，没有人会认为`font`-tags 比在 CSS 中指定排版更好，因为 CSS 提供与`font`-tags 相同的功能，但在一种更清洁的方式。

然而，表格的问题基本上是在 Microsoft Internet Explorer 中不支持 CSS 中的表格布局模型。因此，表格和 CSS 在功能上是*不*等价的。缺少的部分是**表格的类似网格的行为**，其中单元格的边缘垂直和水平对齐，而单元格仍然扩展以包含其内容。这种行为在纯 CSS 中并不容易在没有硬编码某些维度的情况下实现，这使得设计变得僵硬和脆弱（只要我们必须支持 Internet Explorer - 在其他浏览器中，这很容易通过使用来实现`display:table-cell`）。

因此，这并不是表格或 CSS 是否更可取的问题，而是识别使用表格可能使布局更灵活的特定情况的问题。

*不*使用表格的最重要原因是可访问性。Web 内容可访问性指南[http://www.w3.org/TR/WCAG10/](http://www.w3.org/TR/WCAG10/)建议使用表格进行布局。如果您担心可访问性（在某些情况下您可能有法律义务），即使表格更简单，您也应该使用 CSS。请注意，您*始终*可以使用 CSS 创建与使用表格相同的布局，但这可能需要更多的工作。

* * *

## 回答 #29

> 赞同：3
> 
> 时间：2010-11-29T18:45:50.510

因为维护一个使用表格的站点是地狱，并且需要更长的时间来编写代码。如果你害怕浮动 div，那就去学习一下它们。它们并不难理解，而且效率提高了大约 100 倍，而且痛苦少了一百万倍（除非你不理解它们——但是，嘿，欢迎来到计算机世界）。

任何考虑使用表格进行布局的人最好不要指望我维护它。这是呈现网站的最落后的方式。感谢上帝，我们现在有一个更好的选择。我永远不会回去。

令人恐惧的是，有些人可能没有意识到使用现代工具创建网站所带来的时间和精力优势。

* * *

## 回答 #30

> 赞同：3
> 
> 时间：2011-03-29T14:49:00.447

在基于表格的布局中，DOM 操作很困难。

使用语义 div：

```
$('#myawesomediv').click(function(){
    // Do awesome stuff
}); 
```

带表：

```
$('table tr td table tr td table tr td.......').click(function(){
    // Cry self to sleep at night
}); 
```

现在，当然，第二个例子有点愚蠢，你总是可以将 ID 或类应用于 table 或 td 元素，但这会增加语义价值，这是 table 支持者强烈反对的。

* * *

## 回答 #31

> 赞同：3
> 
> 时间：2011-04-11T11:59:25.903

我很惊讶地发现有些问题还没有被涵盖，所以这是我的 2 美分，以及之前提出的所有非常有效的观点：

.1。**CSS & 搜索引擎优化：**

a) CSS 过去对 SEO 产生了非常重要的影响，它允许将内容放置在页面中您想要的任何位置。几年前，搜索引擎非常重视“页面上”因素。页面顶部的内容被认为与页面的相关性高于底部的内容。蜘蛛的“页面顶部”意味着“在代码的开头”。使用 CSS，您可以在代码的开头组织富含关键字的内容，并且仍然可以将其放置在页面中您喜欢的任何位置。这仍然有些相关，但页面因素对页面排名的重要性越来越低。

b) 当布局转移到 CSS 时，HTML 页面更轻，因此对于搜索引擎蜘蛛来说加载速度更快。（蜘蛛不会费心下载外部 css 文件）。快速加载页面是包括谷歌在内的多个搜索引擎的重要排名考虑因素

c) SEO 工作通常需要测试和更改内容，这对于基于 CSS 的布局更方便

.2\. **生成的内容：**

与等效的 CSS 布局相比，以编程方式生成表格要容易得多。

```
foreach ($comment as $key=>$value)
{
   echo "<tr><td>$key</td><td>$value</td></tr>";
} 
```

生成表格既简单又安全。它是独立的，可以很好地集成到任何模板中。对 CSS 做同样的事情要困难得多，而且可能根本没有好处：很难在飞行中编辑 CSS 样式表，并且内联添加样式与使用表格没有什么不同（内容没有与布局分开）。

此外，当生成表格时，内容（以变量形式）已经与布局（以代码形式）分离，使其易于修改。

这就是为什么一些设计良好的网站（例如 SO）仍然使用表格布局的原因之一。

当然，如果需要通过 JavaScript 对结果进行操作，那么 div 是值得的。

.3\. **快速转换测试**

在确定对特定受众有效的方法时，能够以各种方式更改布局以找出获得最佳结果的方法很有用。基于 CSS 的布局使事情变得相当容易

.4\. **针对不同问题的不同解决方案**

布局表通常不受欢迎，因为“每个人都知道 div 和 CSS”是要走的路。

然而事实仍然是，表格比大多数 CSS 布局更快地创建、更容易理解并且更健壮。（是的，CSS 可以同样强大，但通过网络在不同浏览器和屏幕分辨率上的快速浏览表明情况并不常见）

桌子有很多缺点，包括维护、缺乏灵活性……但我们不要把婴儿和洗澡水一起扔。快速可靠的解决方案有很多专业用途。

前段时间，我不得不使用表格重写干净简单的 CSS 布局，因为很大一部分用户会使用旧版本的 IE，对 CSS 的支持非常糟糕

一方面，我厌倦了下意识的反应“哦，不！用于布局的表格！”

至于“它不是为了那个目的，所以你不应该这样使用它”的人群，这不是虚伪吗？你如何看待你必须使用的所有 CSS 技巧来让该死的东西在大多数浏览器中工作？他们是为了那个目的吗？

* * *

## 回答 #32

> 赞同：2
> 
> 时间：2008-09-17T13:29:08.303

内容和布局之间的分离还可以更轻松地为您的站点生成打印机友好的布局或不同的皮肤（样式），而无需创建不同的 html 文件。一些浏览器（如 Firefox）甚至支持从视图菜单中选择样式表。

而且我确实认为维护无表布局更容易。您不必担心行跨度、列跨度等。您只需创建一些容器 div 并将内容放置在您需要的位置。这就是说我认为它也更具可读性（`<div id="sidebar">`vs `<tr><td>...</td><td>...<td>sidebar</td></tr>`）。

这只是你必须学习的一个小“技巧”​​（一旦你掌握了这个技巧，我认为它更容易并且更有意义）。

* * *

## 回答 #33

> 赞同：2
> 
> 时间：2008-09-17T15:39:08.243

对我来说，一个大问题是表格，尤其是嵌套表格，渲染时间比正确布局的 css 实现要长得多。（你*可以*让 css 一样慢）。

所有浏览器都更快地呈现 css，因为每个 div 都是一个单独的元素，因此可以在用户阅读时加载屏幕。（对于庞大的数据集等）。在那个实例中，我使用 css 而不是表，甚至不处理布局。

在找到最后一个“/table”之前，嵌套表格（单元格内的表格等）不会呈现到浏览器窗口。更糟糕的是 - 定义不明确的表有时甚至不会呈现！或者，当它发生时，事情就会不正常。（不能与“TD”等正确跨接）

我在大多数事情上都使用表格，但是当涉及到大数据和希望为最终用户快速呈现屏幕的愿望时——我会尽力利用 CSS 所提供的功能。

* * *

## 回答 #34

> 赞同：2
> 
> 时间：2008-09-20T05:27:39.973

> 一个例子：您想将页面的主要内容区域居中，但为了在其中包含浮动，它需要浮动。CSS 中没有“浮动：中心”。

这不是在居中元素内“包含浮动”的唯一方法。所以，根本不是一个好的论据！

在某种程度上，这是一个错误的前提，即“div 与表格”的事情。

快速而肮脏地将页面分成三列？老实说，表格*更容易。*但是没有专业人士再将它们用于布局，因为它们将页面元素的定位锁定在页面中。

真正的论点是“由 CSS 完成的定位（希望在远程文件中）”而不是“由页面中的 HTML 完成的定位”。当然，每个人都可以看到前者而不是后者的好处？

1.  大小——如果你的页面布局在 HTML 中，在页面中，它不能被缓存，并且必须在每个页面上重复。如果您的布局在缓存的 CSS 文件中，而不是在页面中，您将节省大量带宽。
2.  多个开发人员可以同时在同一个页面上工作——我负责 HTML，其他人负责 CSS。不需要存储库，覆盖，文件锁定等没有问题。
3.  进行更改更容易——在不同的浏览器中布局会出现问题，但您只需修复一个文件，即 CSS 文件，即可将它们整理出来。
4.  可访问性，如前所述。表格假定二维布局适用于所有人。这不是某些用户查看您的内容的方式，也不是 Google 查看您的内容的方式。

考虑一下：

```
[ picture ] [ picture ] [ picture ]
[ caption ] [ caption ] [ caption ] 
```

它代表有 6 个单元格的表格的两行。可以看到二维表格布局的人会在每张图片下看到一个标题。但是使用语音合成，或者 PDA，对于搜索引擎蜘蛛，那就是

```
picture picture picture caption caption caption 
```

并且在表格到位时明显的关系消失了。

DIV 和 CSS 是否更适合在*HTML 页面上简单地布置矩形以在最短的时间内实现给定的设计？*不，他们可能不是。但我不从事快速布置矩形以实现给定设计的业务。我在想一个更大的图景。

* * *

## 回答 #35

> 赞同：2
> 
> 时间：2008-10-17T16:37:38.373

我不得不以这两种方式来做网站，再加上第三种方式，可怕的“混合”布局与表格、div 和样式：Divs/CSS 轻松获胜。

您必须立即将 div 嵌套三个深度才能匹配一个表格单元格的代码权重。这种效果随嵌套表而扩展。

我也更愿意进行一次布局更改，而不是为我网站中的每个页面进行一次更改。

我可以使用 divs/css 完全控制演示的各个方面。表格以可怕的方式把它搞砸了，尤其是在 IE 中，我从来没有选择不支持的浏览器。

我维护或重新设计 divs/css 网站的时间只是表格中的一小部分。

最后，我可以使用 CSS 和几乎任何脚本语言来创新多个可切换的布局。这对我来说是不可能的。

在您做出决定时祝您的投资回报率好运。

* * *

## 回答 #36

> 赞同：2
> 
> 时间：2010-11-01T18:08:39.807

1.  尝试合并/拆分一个 10/20 深的 colspan/rowspan。不止一次，我不得不压制自己的本能与某人打架。[？！]
2.  尝试更改源代码顺序而不更改可见顺序。[搜索引擎优化，可用性，...]
3.  我们正在查看的非常（非常简单）的页面约为 150K。我敢打赌，使用适当的 CSS 几乎可以将它减半。[搜索引擎优化（是的，搜索引擎优化，阅读最新的谷歌规范等），性能，...]
4.  尝试制作一个可以在任何宽度下工作的迭代器模板。
5.  在这种基于表格的 SO 媒体中对此事的讨论可能[会导致奇点并摧毁我们所有人](http://www.geekherocomic.com/2009/08/19/a-coding-paradox/)

* * *

## 回答 #37

> 赞同：2
> 
> 时间：2011-07-02T00:47:33.160

在我看来，严格分离表示和内容的问题大致类似于在 C++ 中将头文件与实现文件分离。这是有道理的，但它也可能是一种痛苦。见证 Java 和 C#，其中类在单个源文件中定义。新语言的作者注意到了一些让程序员头疼的东西，他们摆脱了它。这似乎是这次讨论的要点。一方面是说 CSS 太难，另一方面是说必须成为 CSS 高手。

对于简单的布局问题，为什么不改变表示必须完全分开的规则呢？允许我们直接在 HTML 中控制显示的新标签（或 div 标签的某些扩展）怎么样？毕竟，我们不是已经将演示文稿泄漏到 HTML 中了吗？看看 h1，h2...h6。这些控件介绍大家都知道。

阅读代码（而 HTML 就是代码）的能力非常重要。大师们往往忽略了让编程环境尽可能为大众所接受的重要性。认为只有专业程序员才重要是非常短视的。

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2008-09-17T13:21:29.197

表格适用于您为简单或临时的事情而拼凑在一起的 HTML。如果你正在构建一个大型网站，你应该使用 div 和 CSS，因为随着网站的变化，随着时间的推移，它会更容易维护。

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2008-09-17T13:31:07.643

要响应“表格速度较慢”的论点 - 您正在考虑渲染时间，这是错误的指标。很多时候，开发人员会写出一个巨大的表格来完成页面的整个布局——这会显着增加要下载的页面的大小。不管你喜不喜欢，那里仍然有大量的拨号用户。

另请参阅：过度使用 ViewState

* * *

## 回答 #40

> 赞同：1
> 
> 时间：2008-09-17T14:52:08.357

div 和 CSS 定位允许更灵活的设计，从而更容易修改和模板化您的网页。

也就是说，如果您对灵活性不感兴趣，那么使用表格而不是一些由 CSS 变形为表格的 div 肯定会更容易和更快地敲出。我倾向于在敲击设计时使用表格，只是为了让它看起来更快一点。

* * *

## 回答 #41

> 赞同：1
> 
> 时间：2008-09-17T15:21:54.273

我曾经了解到一个表格会立即加载，换句话说，当连接速度很慢时，表格所在的空间会一直保持空白，直到整个表格都加载完毕，另一方面，一个 div 从上到下加载数据的速度与数据的速度一样快不管它是否已经完成。

* * *

## 回答 #42

> 赞同：1
> 
> 时间：2008-09-17T15:25:42.550

如果您在此支持桌面角度，请找到一个带有表格的站点，然后给自己一个屏幕阅读器 - 关闭屏幕阅读器并关闭您的显示器。

然后尝试使用语义正确的 div 布局站点。

你会看到区别。

如果表格中的数据是表格而不是布局页面，那么表格就不是邪恶的。

* * *

## 回答 #43

> 赞同：1
> 
> 时间：2008-09-17T15:46:38.567

我确实相信这是一个与一般问题相关的问题。当 HTML 诞生时，没有人能预见到它的广泛使用。另一项在自身成功的重压下几乎崩溃的技术。当 HTML 页面在绿色文本终端上用**vi**编写时，只需要一个 TABLE 就可以将数据呈现给页面的访问者，而且它主要是在表格形式中有意义的数据。

我们都知道事情是如何演变的。TABLE 最近过时了，但有很多理由更喜欢基于 DIV 和 CSS 的布局（可访问性不是最后一个）。当然，我不能编写 CSS 来挽救我的生命 :-) 我认为图形设计专家应该随时待命。

也就是说......即使在现代网站中，也应该在表格中呈现大量数据。

* * *

## 回答 #44

> 赞同：1
> 
> 时间：2008-09-17T16:12:35.167

当您需要确保元素需要在布局中保持特定的物理关系时，请使用表格。对于数据，表格通常是最好使用的布局元素，因为您不希望列以意想不到的方式包装并混淆关联。

还可以争辩说，必须保留在特定关系中的非数据元素也应该呈现在表格中。

灵活的 css 布局非常适合适合移动设备和大屏幕以及打印和其他显示类型的内容，但有时，内容只需要以非常特定的方式显示，如果这要求屏幕阅读器无法轻松访问它，这很可能是合理的。

* * *

## 回答 #45

> 赞同：1
> 
> 时间：2008-09-17T19:01:50.207

我尽量避免使用 TABLE，但是当我们设计复杂的表单时，这些表单混合了多种控件类型和不同的标题位置，并且对分组进行了非常严格的控制，使用 DIV 是不可靠的，或者通常几乎是不可能的。

现在，我不会争辩说这些表单不能重新设计以更好地适应基于 DIV 的布局，但对于其中一些，我们的客户坚持不改变以前版本（用经典 ASP 编写）的现有布局，因为它类似于用户熟悉的纸质表格。

因为表单的呈现是动态的（其中某些部分的显示基于案例的状态或用户的权限），所以我们使用堆叠的 DIV 集，每个 DIV 都包含一个逻辑分组的表单元素的 TABLE。TABLE 的每一列都进行了分类，以便它们可以由 CSS 控制。这样我们就可以关闭表单的不同部分，而不会出现在 DIV 中包装行的问题。

* * *

## 回答 #46

> 赞同：1
> 
> 时间：2008-09-17T20:36:59.430

根据过去的经验，我必须去DIV。即使在 OOP 中，主要目的是减少对象之间的耦合，因此这个概念可以应用于 DIVS 和表。表格用于保存数据，而不是用于围绕页面排列数据。DIV 专门设计用于在页面周围排列项目，因此设计应使用 DIV，表应用于存储数据。

此外，编辑用表格制作的网站非常困难（在我看来）

* * *

## 回答 #47

> 赞同：1
> 
> 时间：2008-09-18T08:45:16.997

我认为没有人关心一个网站是如何设计/实施的，它表现得很好并且运行得很快。

我在 HTML 标记中同时使用“table”和“div”/“span”标签。

让我给你几个我为什么选择 div 的论点：

1.  对于一个表，你必须写至少 3 个标签（table、tr、td、thead、tbody），为了一个好的设计，有时你有很多嵌套表

2.  我喜欢在页面上有组件。我不知道如何准确解释，但会尝试。假设您需要一个徽标，并且必须将其放置在下一页内容上，只是其中的一小部分。使用表格，您必须剪切 2 个图像并将其放入 2 个不同的 TD。使用 DIV，您可以使用简单的 CSS 来根据需要对其进行排列。您最喜欢哪种解决方案？

3.  当超过 3 个嵌套表用于做某事时，我正在考虑使用 DIV 重新设计它

但我仍在使用表格：

1.  表格数据

2.  扩展自我的内容

3.  快速解决方案（原型），因为每个浏览器上的 DIV 框模型不同，因为许多生成器正在使用表等

* * *

## 回答 #48

> 赞同：1
> 
> 时间：2008-09-24T07:18:29.923

当我使用 CSS 设计布局时，我通常为每个主要部分赋予其自己的根（主体级别）div，并使用相对/绝对定位将其放置在适当的位置。这比表格更灵活一点，因为我不限于可以使用行和列表示的排列。

此外，如果我决定要重新排列布局（比如说我希望导航栏现在位于右侧），我可以简单地去改变一个地方（CSS 文件）中元素的位置，而 HTML 不会不必改变。如果我对表格进行此操作，我将不得不进入并查找信息并进行大量属性修改、复制和粘贴以获得相同的效果。

事实上，使用 CSS，我什至可以让我的*用户*选择他们希望他们的布局如何工作。只要内容区域的一般大小没有改变，我完全可以使用一些 PHP 脚本来根据用户偏好输出我的 CSS，并允许他们根据自己的喜好重新排列站点。再一次，可以使用表格，但更难维护。

最后，CSS 提供了一个表格永远不会提供的主要好处：基于显示设备重新格式化内容的能力。CSS 允许我为打印机使用与用于显示器的样式集完全不同的样式集（包括位置、格式等）。这也可以扩展到其他媒体，一个很好的例子是 Opera Show，它允许将设计巧妙（并且非常标准）的 CSS 增强页面作为幻灯片查看。

所以最终，灵活性和管理才是真正的赢家。通常，CSS 允许您对布局进行更多操作。*基于表格的布局在技术上*没有什么不标准的地方，但你为什么要限制自己呢？

* * *

## 回答 #49

> 赞同：1
> 
> 时间：2008-10-15T03:29:37.620

过去，屏幕阅读器和其他无障碍软件很难高效地处理表格。在某种程度上，这在屏幕阅读器中通过阅读器根据它在表格中看到的内容在“表格”模式和“布局”模式之间切换来处理。这通常是错误的，因此用户在浏览表格时必须手动切换模式。在任何情况下，通常是高度嵌套的大型表格在很大程度上仍然很难使用屏幕阅读器进行导航。

当 div 或其他块级元素用于重新创建表并且高度嵌套时，也是如此。div 的目的是用作格式和布局元素，因此，旨在用于保存类似的信息，并将其布置在屏幕上以供视觉用户使用。当屏幕阅读器遇到一个页面时，它通常会忽略任何布局信息，包括基于 CSS 的以及基于 html 属性的（并非所有屏幕阅读器都是如此，但对于最流行的屏幕阅读器，如 JAWS、Windows Eyes 和Orca for Linux 就是这样）。

为此，表格数据，即逻辑上有意义的数据，可以在二维或更多维度上排序，带有某种标题，最好放在表格中，并使用 div 来管理页面上的内容布局。（思考什么是“表格数据”的另一种方法是尝试以图表形式绘制它......如果你不能，它可能不是最好在表格中表示）

最后，使用基于表格的布局，为了实现对页面元素位置的细粒度控制，经常使用高度嵌套的表格。这有两个影响： 1.) 增加每个页面的代码大小 - 由于导航和公共结构通常使用表格完成，因此每个请求通过网络发送相同的代码，而基于 div/css 的布局会拉取 css 文件一次，然后使用较少罗嗦的 div。2.) 高度嵌套的表格需要更长的时间来渲染客户端的浏览器，从而导致加载时间稍慢。

在这两种情况下，“最后一英里”带宽的增加以及更快的个人计算机都缓解了这些因素，但尽管如此，它们仍然是许多站点存在的问题。

考虑到所有这些，正如其他人所说，表格更容易，因为它们更面向网格，允许更少的思考。如果有问题的网站预计不会存在很长时间，或者不会被维护，那么做最简单的事情可能是有意义的，因为它可能是最具成本效益的。但是，如果预期的用户群可能包括很大一部分残障人士，或者如果网站将由其他人长期维护，那么花时间以简洁、易于访问的方式做事最终可能会获得更多回报。

* * *

## 回答 #50

> 赞同：1
> 
> 时间：2008-12-05T20:17:35.863

1：是的，您的用户确实在乎。如果他们使用屏幕阅读器，它就会丢失。如果我使用任何其他试图从页面中提取信息的工具，遇到不用于表示表格数据的表格会产生误导。

div 或 span 可以用于分隔内容，因为*这正是这些元素的含义*。当我，一个搜索引擎，一个屏幕阅读器或其他任何东西，遇到一个表格元素时，我们期望这意味着“以下是表格数据，以表格表示”。*当我们遇到一个div*时，我们期望“这是一个用于将我的内容划分为单独的部分或区域的元素。

2：可读性：错误。如果所有的演示代码都在 css 中，我可以阅读 html 并理解页面的内容。或者我可以阅读 css 并理解演示文稿。如果 html 中的所有内容都杂乱无章，我必须先在脑海中剔除所有与演示相关的部分，然后才能看到什么是内容，什么不是。此外，我会害怕遇到不懂 css 的 web 开发人员，所以我真的不认为这是一个问题。

3：表更慢：是的，它们是。原因很简单：表格必须被完全解析，*包括*它们的内容才能被渲染。一个 div 可以在遇到它时被渲染，甚至*在*它的内容被解析之前。这意味着 div 将在页面完成加载之前显示。

然后还有一个好处，就是表格更脆弱，并且在不同的浏览器中不会总是以相同的方式呈现，具有不同的字体和字体大小以及所有其他可能导致布局变化的因素。表格是确保您的网站在某些浏览器中偏离一两个像素、在用户更改字体大小或以任何其他方式更改其设置时无法很好缩放的绝佳方式。

当然＃1是大的。许多工具和应用程序都依赖于网页的语义。常见的例子是视障用户的屏幕阅读器。如果您是 Web 开发人员，您会发现许多可能雇用您在网站上工作的大公司即使在这种情况下也*要求*该网站是可访问的。这意味着您必须考虑 html 的语义。借助语义网，或更相关的微格式、RSS 阅读器和其他工具，您的页面内容不再只能通过浏览器查看。

* * *

## 回答 #51

> 赞同：1
> 
> 时间：2009-02-16T16:30:50.643

我对我的英语感到抱歉，但还有另一个原因：

我曾在一些政府组织工作，不使用 TABLE 的第一个原因是为残疾人服务。他们使用机器“翻译”网页。

问题是如果由 TABLE 完成，这个“翻译机”就无法读取网站。为什么 ？因为 TABLE 用于数据。

事实上，如果你使用 TABLES，你必须为每个 CELLS 指定一些信息，让残疾人知道他们在 TABLE 中的位置。想象一下，你有一张大桌子，必须放大才能看到屏幕中的一个单元格：你必须知道你在哪一行/哪一列。

因此，使用了 DIV，并且残疾人可以简单地阅读文本，并且当它们不必存在时，不会得到关于行/列的一些奇怪信息。

我也更喜欢 TABLE 来制作快速简单的模板，但我现在已经习惯了 CSS……它很强大，但你真的必须知道你在做什么……:)

* * *

## 回答 #52

> 赞同：1
> 
> 时间：2009-02-22T09:48:31.140

几年前我研究了屏幕阅读器和表格的问题，并提出了与大多数开发人员的看法相矛盾的信息：

[http://www.webaim.org/techniques/tables/](http://www.webaim.org/techniques/tables/)

“你可能会听到一些可访问性倡导者说布局表格是一个坏主意，应该使用 CSS 布局技术。他们说的是事实，但说实话，使用表格进行布局并不是最糟糕的在可访问性方面您可以做的事情。各种残障人士都可以轻松访问表格，只要表格的设计考虑到可访问性。“

* * *

## 回答 #53

> 赞同：1
> 
> 时间：2010-09-09T19:30:37.837

Google 对包含在表格中的文本内容给予非常低的优先级。我正在向当地的慈善机构提供一些 SEO 建议。在检查他们的网站时，它使用表格来布局网站。查看每个页面，无论我在 Google 搜索框中使用的页面中的哪些单词或单词组合，这些页面都不会出现在任何热门搜索页面中。（但是，通过在搜索中指定站点，该页面被返回。）按照正常标准，一个页面被很好地复制以在搜索中产生良好的结果，但它仍然没有出现在返回的搜索结果的任何第一页中. （请注意，此文本在表格中。）然后我在页面上发现了一段文本，该文本位于 div 而不是表格中。我们在搜索引擎中放入了该 div 中的一些单词。结果？它在搜索结果中排名第二。

* * *

## 回答 #54

> 赞同：1
> 
> 时间：2011-02-11T21:51:25.557

当您考虑测试量以确保更改适用于所有浏览器时，我仍然不太了解 div / CSS 如何更容易更改页面设计，尤其是在所有 hack 等情况下。这是一个非常令人沮丧和乏味的过程，浪费了大量的时间和金钱。值得庆幸的是，508 立法仅适用于美国（自由的土地 - 是的），所以作为我在英国的工作人员，我可以以我选择的任何风格开发网站。与流行的（美国）看法相反，华盛顿制定的立法不适用于世界其他地区——谢天谢地。立法生效之日，在网页设计界一定是个好日子。我想我' 随着我在 IT 行业工作了 25 年，我变得越来越愤世嫉俗，但我确信这种立法只是为了保护工作。实际上，任何人都可以用几张桌子拼凑出一个合理的网页。使用 DIV/CSS 来做这件事需要更多的努力和知识。根据我的经验，在谷歌上搜索非常简单的问题可能需要数小时和数小时，并在充满理想主义狂热者的论坛中阅读难以理解的文章，他们都在争论“正确”的做事方式。您不能只是将脚趾浸入水中并让事情在每种情况下都能正常工作。在我看来，缺乏关于“开箱即用”使用 DIVS / CSS 的明确指南，适用于所有情况，在浏览器上工作，并使用没有极客语言的“普通”语言编写，
我是一名应用程序开发人员，我会说找出布局问题和测试所有浏览器所需的时间几乎是创建基本应用程序、设计和实现业务对象以及创建数据库后端所需时间的两倍。我的时间 = 金钱，对我和我的客户都是如此，所以如果我不拒绝所有赞成 DIV / CSS 赞成削减成本并为我的客户提供物有所值的论点，我很抱歉。也许这只是开发人员的工作方式，但在我看来，更改复杂的表结构比修改 DIV/CSS 容易得多。值得庆幸的是，现在似乎可以使用这些问题的解决方案 - 它称为 WPF。

* * *

## 回答 #55

> 赞同：1
> 
> 时间：2011-02-28T08:22:17.263

Flex 有一个标签，用于在垂直列中放置东西。老实说，我认为他们的整个布局/内容也不正确，但至少他们已经解决了这个问题。

像许多对 CSS 感到沮丧的人一样，我也四处寻找一个简单的答案，当我以为我找到了它时，我感到很高兴，然后当我在 Chrome 中打开页面时，我的希望破灭了。我绝对没有足够的技能说这是不可能的，但我还没有看到有人提供示例代码供同行评审，明确证明它可以可靠地完成。

那么来自这个岛的 CSS 方面的人可以推荐一种布局垂直列的思维方式/方法吗？我已经尝试在第二行和第三行进行绝对定位，但最终我的东西到处都重叠，并且如果页面缩小，浮动也会出现类似的问题。

如果有答案，我会欣喜若狂**-*做正确的事*-**只要告诉我，“嘿，你有没有尝试过 **flow:vertical|horizo​​ntal”，而我完全没有你的头发。

* * *

## 回答 #56

> 赞同：1
> 
> 时间：2011-04-25T10:19:30.983

根据我对表格的了解，如果嵌套的表格太多，浏览器在呈现页面时会产生很大的开销。

1 - 浏览器等待渲染最终视图，直到整个表被加载。

2 - 渲染表格的算法很昂贵，而且不是一次性的。浏览器在获取内容时会尝试渲染计算内容的宽度和高度。因此，如果您有嵌套表格，例如，浏览器已收到第一行并且第一个单元格包含大量内容且未定义宽度和高度，它将计算宽度并呈现第一行，平均而言当它获得第二行时，单元格#2 将包含大量内容！它现在将计算第二行单元格的宽度。第一行呢？它将递归计算宽度。这在客户端很糟糕。（举个例子）作为一个程序员，你会优化一些东西，比如获取数据的时间，优化的数据结构等等。你优化一些东西以在服务器端完成，比如在 2 秒内，但最终用户在 8 秒内获得最终视图。这里有什么问题？1.可能是网络慢！如果网络没问题呢？什么是网络在接下来的 1 秒内传送内容？这额外的 5 秒消耗在哪里？需要担心的事情——浏览器可能会花费大量时间来估计和呈现表格！

如何优化表？如果您使用的是表格，我建议您始终为单元格定义宽度。这并不能保证浏览器只会盲目地采用这个宽度，但对浏览器决定初始宽度有很大帮助。

但是，最后，div 是很好的方式，因为 CSS 可以被浏览器缓存；虽然表没有缓存！

* * *

## 回答 #57

> 赞同：1
> 
> 时间：2011-05-03T22:47:00.077

通过仍然使用表格进行布局，我们缺少 div 方面的创新。

许多人提出了使为 div 创建布局更容易的解决方案。最受欢迎的是网格架构。有基于这种架构的动态布局生成器。查看：1) 960.gs 和 (http://grids.heroku.com/) 2) 蓝图等等。

在表格布局的架构和工具方面，我没有看到太多创新。

我想说，抛开所有理论不谈，实际上使用 CSS 和 div 进行布局更快。在这个方向上的创新使它比任何事情都容易。

* * *

## 回答 #58

> 赞同：0
> 
> 时间：2008-09-17T17:31:46.163

用作纯布局的表格确实会给可访问性带来一些问题（我听说过）。但我理解这里要问的是，您以某种方式通过使用表格来确保页面上的某些内容正确对齐，从而削弱了网络。

我以前听过人们争论说 FORM 标签和输入实际上是数据，应该允许它们进入表格。

使用表格来确保一些元素正确排列导致代码大量增加的论点往往包括单个 DIV 如何满足其所有需求的示例。它们并不总是包含 10 行 CSS 和他们必须为 IE5、IE5.5、IE6、IE7 编写的特殊浏览器技巧……

我认为这仍然是在你的设计中使用平衡。表格在工具箱中，只需记住它们的用途...

* * *

## 回答 #59

> 赞同：0
> 
> 时间：2008-09-18T07:44:51.290

当然，OP有点结束，争论似乎如此周而容易反驳。

网页是 Web 开发人员的领域，如果他们说 div 和 CSS 比表格更好，那对我来说已经足够好了。

如果布局是通过服务器应用程序生成的表格实现的，那么新布局意味着对应用程序的更改，即应用程序的重建和重新部署，而不仅仅是对 css 文件的更改。

另外，可访问性。用于布局的表格会使网站无法访问，所以不要使用它们。不费吹灰之力，更不用说违法了。

* * *

## 回答 #60

> 赞同：0
> 
> 时间：2008-09-18T09:15:53.040

使用 DIV，您可以轻松切换事物。例如，您可以这样做：

```
Menu | Content

Content | Menu

Menu
----
Content 
```

在 CSS 中更改它很容易，而不是在 HTML 中。您还可以提供多种样式（右手、左手、小屏幕专用）。

在 CSS 中，您还可以将菜单隐藏在用于打印的特殊样式表中。

另一件好事是，您的内容在代码中的顺序始终相同（菜单在前，内容在后），即使在视觉上以其他方式呈现。

* * *

## 回答 #61

> 赞同：0
> 
> 时间：2008-09-19T22:25:26.210

超级简短的回答：使用表格设计可维护的网站很困难，而使用标准方法则很简单。

网站不是表格，它是相互交互的组件的集合。把它描述成一张桌子是没有意义的。

* * *

## 回答 #62

> 赞同：0
> 
> 时间：2008-11-10T02:15:03.773

在维护内容的同时进行网站维护和设计大修（这种情况一直在发生，尤其是在电子商务中）：

内容和设计通过表格混合在一起 = 更新内容和设计。

与设计分开的内容=更新设计，也许还有一点内容。

如果我按照自己的方式进行操作，我会将我的内容保存在 PHP 生成 XML 中，转换为 XSLT 中的标记，并使用 CSS 和 Javascript 进行交互设计。对于 Java 方面的事情，JSP 到 JSTL 来生成标记。

* * *

## 回答 #63

> 赞同：-1
> 
> 时间：2008-09-18T18:33:05.400

所见即所得！！！我不能让我们的设计师停止在模板中使用嵌套的 DIVS 和 elementID css 样式，这些模板应该由客户在 CMS 项目中使用。这就是所见即所得在线编辑器的全部意义所在。您同时控制内容和布局！在这种情况下，首先根本没有分离。在某些外部样式表中定位和样式化的 Div 对所见即所得编辑的整个理念是一种厌恶。可以看到表格、插入的行、合并的单元格等等。祝你好运，以一种不会让用户感到沮丧的方式尝试使用 div。

* * *

## 回答 #64

> 赞同：-1
> 
> 时间：2010-05-01T21:47:09.837

数据：使用表格。布局：使用样式。使用非常精简的浏览器，即没有样式的[Links](http://en.wikipedia.org/wiki/Links_%28web_browser%29) 2 或[Lynx](http://en.wikipedia.org/wiki/Lynx_%28web_browser%29)，只有简单的标记，表格可以呈现最快。

* * *

## 回答 #65

> 赞同：-3
> 
> 时间：2008-11-10T02:18:57.850

这不一定是一场战争。和谐是可能的。

使用一张表进行整体布局和其中的 div。

```
<table> 
    <tr><td colspan="3"><div>Top content</div></td></tr>
    <tr> 
        <td><div>Left navigation</div></td> 
        <td><div>Main content</div></td> 
        <td><div>Right navigation</div></td> 
    </tr>
    <tr><td colspan="3"><div>Bottom content</div></td></tr>
</table> 
```

看 - 没有嵌套表。

我已经阅读了很多关于如何使用 div 实现这一目标的文章，但从未发现任何每次都能正常工作且没有问题的东西。

一旦你有了整体结构，div 就很棒，但坦率地说，流畅的页眉/页脚和三个流体列是 div 的一大痛点。Div 不是为流动性而设计的，那么为什么要使用它们呢？

请注意，这种方法将在[链接文本中为您提供 100% 的 CSS 合规性](http://validator.w3.org/)

* * *

## 回答 #66

> 赞同：-5
> 
> 时间：2008-09-17T16:15:38.933

我发现，即使是最好的规划 div 在几个方面也存在不足。例如。div 没有办法让底部栏始终位于浏览器底部，即使其余内容没有进入浏览器底部。此外，你不能优雅地做任何比三列更好的事情，你不能让列根据其内容的宽度来增长和缩小。最后，我们尝试先使用 div。但是，我们不会根据某些宗教内容与布局理想来限制我们的 html 设计。

# visual-studio-2008 - VS 2008 与 VS 2008 快递

> ID：83086
> 
> 赞同：7
> 
> 时间：2008-09-17T13:20:05.627
> 
> 标签：visual-studio-2008, visual-studio-express

我在工作中使用 Visual Studio Team System 2008 进行 Web 开发。我已经很习惯了，但现在连 VS 2008 Standard 都买不起。

我以前从未使用过任何 Express 版本，但我正在考虑下载 VS C# Express 和 VS Web Developer Express。

我是在浪费时间，还是可以使用这些工具进行一些认真的开发？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-17T13:25:58.063

您可以在快速版本上进行认真的开发。他们取出了一些最值得注意的东西，即插件系统。如果您习惯使用一堆插件，您可能会发现无法使用它们是一种威慑。

这是快速版和其他版本比较的链接。

[http://msdn.microsoft.com/en-us/library/zcbsd3cz(VS.80).aspx](http://msdn.microsoft.com/en-us/library/zcbsd3cz(VS.80).aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T13:38:10.670

您确实可以使用 Visual Studio 2008 速成版进行认真的开发，这包括商业产品，请参阅[常见问题解答](http://msdn.microsoft.com/en-us/vs2008/products/cc149003.aspx)中的第 7 号问题：

> 七）我可以将 Express Editions 用于商业用途吗？
> 是的，使用 Visual Studio Express Edition 构建的应用程序没有许可限制。

[功能矩阵](http://msdn.microsoft.com/en-us/vs2008/products/cc149003.aspx)显示，虽然您确实失去了 Pro 和 Express Edition 之间的一些功能。最大的一个问题是没有插件支持（并且 EULA 禁止添加它），这限制了对环境的许多不错的添加，例如 ReSharper、VisualAssist 等。

您也没有获得“Studio”，而是四个单独的版本，Web Developer、VB、VC++ 和 C#，如果您希望以标准/专业版支持的方式混合和匹配语言/项目，那么您就不走运了. 然而，在表面之下，MSBuild 是可用的，并且可以为您提供多语言解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T13:21:39.540

如果您不想在解决方案中使用不同的项目类型/语言，并且不需要内置源代码控制，则 Express Editions 可以正常工作。

否则，它几乎是一样的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T13:24:43.323

以下是 Visual Studio 不同版本的可用功能的详细列表：[产品比较](http://msdn.microsoft.com/en-us/vs2008/products/cc149003.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T13:25:35.163

[您可以在此处找到](http://www.microsoft.com/downloads/details.aspx?FamilyId=727BCFB0-B575-47AB-9FD8-4EE067BB3A37&displaylang=en)Visual Studio 2008 各个版本的功能比较。我觉得 Express Edition 最烦人的一点是，一个解决方案文件中不能有多个项目，并且不能使用像 Resharper 这样的附加组件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-17T13:27:40.087

这取决于您如何定义“严重发展”。快速（甚至标准）版本缺少的一件大事是缺乏对移动开发的支持。您还会错过在解决方案中对不同项目类型进行分组的便利。

我认为您还错过了 Express 版中的一些项目类型（Windows 服务、Sql Server/CLR 项目）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-17T13:27:48.573

我还没有在家里买完整版的 VS2008，所以我有 Express 并将它用于一些中间应用程序开发（没有网络东西）。我觉得它足够好，它拥有我使用的大部分东西。我尝试了 SharpDevelop，但它不允许一个以上的启动项目，所以我放弃了它，转而使用 Express。

如果这对您来说是个问题，大多数插件似乎在 Express 版本中不起作用。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-17T13:29:25.713

您实际上可以使用 VS 2008 Express 版本进行商业工作。

请参阅此链接中常见问题解答第 7 题的答案：http: [//www.microsoft.com/express/support/faq/](http://www.microsoft.com/express/support/faq/)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-17T13:36:03.937

[您可以通过Microsoft Dreamspark](https://downloads.channel8.msdn.com/)免费下载专业版的 VS2008（如果您有 .edu 地址）。

就此而言，VS2005 和 VS2008 Pro 的（全功能）90 天试用......可以“延长”......无限期......通过设置您的系统时钟，但没有真正的理由这样做。

Express 作为一个“精简”版本很好，但在各种方面都步履蹒跚。对于任何严重的事情，得到真实的东西。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-17T13:41:28.633

我使用 Express 版本做认真的工作。自从我进入管理层后，我就不是一名专业的程序员，但我仍然坚持偶尔编写实用程序或网页。我在专业版中唯一错过的是远程 Web 调试。

# apache-flex - 是否有另一种方法可以将 PDF 查看集成到 Flex 应用程序中？

> ID：83087
> 
> 赞同：3
> 
> 时间：2008-09-17T13:20:16.780
> 
> 标签：apache-flex, air

我正在寻找在 Flex 应用程序中嵌入 PDF 查看的方法。

目前我看到的唯一选择是使用[flash.html.HTMLLoader](http://livedocs.adobe.com/flex/3/langref/flash/html/HTMLLoader.html)类，它仅在您使用 AIR 时才有效。这没什么大不了的——如果必须的话，我愿意使用 AIR——但根据我以这种方式查看 PDF 的实验，AIR 似乎只是集成了嵌入式 Adob​​e PDF 浏览器插件以供查看，它不仅显示 PDF 页面，还提供了我不想看到的所有操作控件（缩放、打印等）。

我正在寻找一些与 Java 的[JPedal](http://www.jpedal.org)库类似的东西——一个简单地单独呈现 PDF 的嵌入式组件。有没有人找到一种方法来使用 AIR 的内置组件或通过其他方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T18:17:52.730

有几种方法，但*在*Flex 应用程序中实际上都没有 PDF：

1.  将 PDF 转换为 SWF。使用[此工具](http://www.swftools.org/pdf2swf.html)或类似工具来转换文件。
2.  使用[HTMLComponent](http://drumbeatinsight.com/htmlcomponent)，一种在你的 flash/flex 上使用 iframe 的方法，使它看起来像你的应用程序中的外部页面。然而，这种方法也有一些缺点——其中大部分都[在 Deitte.com](http://www.deitte.com/archives/2008/07/dont_use_iframe.htm)上进行了详细描述。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-03-15T17:49:26.603

AIR 可以实现您想要的，并在此 Adob​​e 文章中进行了描述：http: [//www.adobe.com/devnet/air/flex/quickstart/scripting_pdf.html](http://www.adobe.com/devnet/air/flex/quickstart/scripting_pdf.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T13:58:34.193

看看[http://www.adobe.com/devnet/flex/quickstart/embedding_assets/](http://www.adobe.com/devnet/flex/quickstart/embedding_assets/)看看它是否有帮助。

我不认为你可以直接嵌入 PDF 文件（但我不太确定），但如果你完全需要这样做并且你不想打开一个新窗口，你可以将 PDF 转换为另一种格式插入您的应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T12:46:53.200

如果您的目标是在 Flex 环境中简单地显示 PDF，那么您可以使用 IFrame 方法。你可以在这里找到一个例子[http://www.deitte.com/archives/2006/08/finally_updated.htm](http://www.deitte.com/archives/2006/08/finally_updated.htm)

通过使用这种方法，您可以加载任何包含 PDF 的 HTML 内容。

看一看。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-27T08:09:27.127

Okay guys here is the exact one we're looking

[http://subinsugunan.blogspot.com/2009/06/embed-pdf-in-flex-application.html](http://subinsugunan.blogspot.com/2009/06/embed-pdf-in-flex-application.html)

# php - PHP/mySQL - 在新用户提交数据时定期重新计算基准值

> ID：83088
> 
> 赞同：2
> 
> 时间：2008-09-17T13:20:17.513
> 
> 标签：php, mysql, stored-procedures, cron

我遇到了一种在我非常年轻的编程“职业生涯”中还没有遇到过的新问题，我想知道你对如何最好地解决它的看法。

**情况** 一个研究应用程序 (php/mysql) 从用户那里收集与压力相关的健康数据。用户在填写问卷后得到分析。使用基准（现有数据集的平均值和标准偏差）将每个参数的值转换为百分位值。

**任务** 由于越来越多的人填写问卷，因此有可能通过使用新的用户数据重新计算基准值（平均值/标准差）来使它们更加准确。我希望数据库定期运行更新基准值的脚本。

**到目前为止我从未使用过存储的程序**的问题，我对它们是什么只有一点概念，但不知何故，我觉得它们可能会帮助我解决这个问题？**还是应该将脚本编写为 php，然后设置 cron 作业？**

 **[编辑]在前几个答案之后，看起来 cron 显然是要走的路。[/编辑]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T13:22:31.347

将 PHP 设置为 cron 作业可让您将其保存在源代码管理系统中，如果您使用数据库抽象层，如果您决定切换，它将可以移植到其他数据库。由于这些原因，我倾向于使用脚本而不是存储过程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T13:24:45.367

完成这项工作的最简单方法可能是用您的网站使用的相同语言（听起来像 PHP）编写脚本并从 cron 调用它。

通过将逻辑放在两个地方（您现有的计算和存储过程），无需使其变得比需要的更复杂。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T13:26:02.120

您正在考虑的可以通过多种方式完成。

1.  您可以在数据库中设置触发器，以便在更新新记录时重新计算值。如有必要，您可以将更新值所需的代码存储在存储过程中。

2.  您可以编写一个 PHP 脚本并通过 cron 定期运行它。

#1 会减慢插入数据库的速度，但会确保您的数据*始终*是最新的。#2 可能会在更新新值时锁定表，并且您的数据只有在下一次更新之前才会准确。#2 更容易备份，因为脚本可以很容易地存储在您的版本控制系统中，而您需要将触发器和存储过程创建脚本存储在您所做的任何备份中。

显然，在选择方法之前，您必须权衡您的要求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T13:22:34.250

如果数据量足够大以至于动态计算太多，那么：

1.  使用 php 脚本进行 Cron 作业以对总数进行非规范化
2.  触发增加总数的插入

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T13:22:43.297

使用**cron 工作**方式。简单，扎实，有效。在 PHP/MySQL 世界中，我会说存储过程是不可行的。

# hibernate - 使用分区的 postgresql 休眠插入批处理

> ID：83093
> 
> 赞同：12
> 
> 时间：2008-09-17T13:21:04.800
> 
> 标签：hibernate, postgresql, insert, database-partitioning

在分区的 postgresql 表中是否有通过休眠进行批量插入的解决方案？目前我遇到这样的错误......

```
ERROR org.hibernate.jdbc.AbstractBatcher - Exception executing batch:
org.hibernate.StaleStateException: Batch update returned unexpected row count from update [0]; actual row count: 0; expected: 1
   at org.hibernate.jdbc.Expectations$BasicExpectation.checkBatched(Expectations.java:61)
   at org.hibernate.jdbc.Expectations$BasicExpectation.verifyOutcome(Expectations.java:46)
   at org.hibernate.jdbc.BatchingBatcher.checkRowCounts(BatchingBatcher.java:68).... 
```

我找到了这个链接[http://lists.jboss.org/pipermail/hibernate-dev/2007-October/002771.html](http://lists.jboss.org/pipermail/hibernate-dev/2007-October/002771.html)但我在网上找不到任何地方解决这个问题或如何解决它

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T04:31:51.630

您可能想通过设置 hibernate.jdbc.factory_class 属性来尝试使用自定义 Batcher。确保 hibernate 不会检查批处理操作的更新计数可能会解决您的问题，您可以通过使自定义 Batcher 扩展类 BatchingBatcher 来实现这一点，然后覆盖方法 doExecuteBatch(...) 看起来像：

```
 @Override
    protected void doExecuteBatch(PreparedStatement ps) throws SQLException, HibernateException {
        if ( batchSize == 0 ) {
            log.debug( "no batched statements to execute" );
        }
        else {
            if ( log.isDebugEnabled() ) {
                log.debug( "Executing batch size: " + batchSize );
            }

            try {
//              checkRowCounts( ps.executeBatch(), ps );
                ps.executeBatch();
            }
            catch (RuntimeException re) {
                log.error( "Exception executing batch: ", re );
                throw re;
            }
            finally {
                batchSize = 0;
            }

        }

    } 
```

请注意，新方法不检查执行准备好的语句的结果。请记住，进行此更改可能会以某种意想不到的方式（或者可能不会）影响休眠。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T12:22:02.030

谢谢！它成功了，到目前为止没有出现任何问题:)....你有一件事...我必须实现`BatcherFactory`类并将其放入`persistence.xml`文件中，如下所示：

```
property name="hibernate.jdbc.factory_class" value="path.to.my.batcher.factory.implementation" 
```

从那个工厂，我用上面的代码调用了我的批处理器实现

ps休眠核心3.2.6 GA

再次感谢

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-05-25T14:05:07.503

他们说在分区表或@SQLInsert 注释中使用两个触发器：[http](http://www.redhat.com/f/pdf/jbw/jmlodgenski_940_scaling_hibernate.pdf) ://www.redhat.com/f/pdf/jbw/jmlodgenski_940_scaling_hibernate.pdf第 21-26 页（它还提到了一个指定字符串的 @SQLInsert方法）。

这是一个带有后触发器的示例，用于删除 master 中的额外行：[https ://gist.github.com/copiousfreetime/59067](https://gist.github.com/copiousfreetime/59067)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-09-30T14:45:33.000

如果您可以使用 RULES 而不是用于插入的触发器，那么它可以返回正确的数字，但只能使用没有 WHERE 语句的单个 RULE。

[参考1](http://www.technology-ebay.de/the-teams/mobile-de/blog/postgresql-table-partitioning-hibernate.html)

[参考2](http://www.postgresql.org/docs/8.3/interactive/ddl-partitioning.html#DDL-PARTITIONING-ALTERNATIVES)

[参考文献3](http://grokbase.com/t/postgresql/pgsql-general/0863bjzths/insert-into-master-table-0-rows-affected-hibernate-problems)

另一种选择可能是创建一个“包装”分区表的视图，然后返回新行以指示成功的行更新，而不会意外向主表添加额外的不需要的行。

```
create view tablename_view as select * from tablename; -- create trivial wrapping view

CREATE OR REPLACE FUNCTION partitioned_insert_trigger() -- partitioned insert trigger
RETURNS TRIGGER AS $$
BEGIN
   IF (NEW.partition_key>= 5500000000 AND
       NEW.partition_key <  6000000000) THEN
      INSERT INTO tablename_55_59 VALUES (NEW.*);
   ELSIF (NEW.partition_key >= 5000000000 AND
          NEW.partition_key <  5500000000) THEN
      INSERT INTO tablename_50_54 VALUES (NEW.*);
   ELSIF (NEW.partition_key >= 500000000 AND
          NEW.partition_key  <  1000000000) THEN
      INSERT INTO tablename_5_9 VALUES (NEW.*);
   ELSIF (NEW.partition_key >= 0 AND
          NEW.partition_key <  500000000) THEN
      INSERT INTO tablename_0_4 VALUES (NEW.*);
   ELSE
      RAISE EXCEPTION 'partition key is out of range.  Fix the trigger function';
   END IF;
   RETURN NEW; -- RETURN NEW in this case, typically you'd return NULL from this trigger, but for views we return NEW
END;
$$
LANGUAGE plpgsql;

CREATE TRIGGER insert_view_trigger
   INSTEAD OF INSERT ON tablename_view
   FOR EACH ROW EXECUTE PROCEDURE partitioned_insert_trigger(); -- create "INSTEAD OF" trigger 
```

参考：[http ://www.postgresql.org/docs/9.2/static/trigger-definition.html](http://www.postgresql.org/docs/9.2/static/trigger-definition.html)

如果您使用视图包装器路线，则一种选择是也为删除和更新定义简单的“而不是”触发器，那么您可以在所有事务中使用视图表的名称代替普通表。

使用视图的另一个选项是创建一个插入规则，以便主表上的任何插入都转到视图[使用其触发器]，例如（假设您已经`partitioned_insert_trigger`创建了上面列出的 tablename_view 和 insert_view_trigger）

```
create RULE use_right_inserter_tablename AS
      ON INSERT TO tablename
      DO INSTEAD insert into tablename_view VALUES (NEW.*); 
```

然后它将使用您的新工作视图包装插入。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-05-02T06:16:31.760

在经过大量搜索后，我在通过休眠插入文档时遇到了同样的问题，发现它期望应该返回更新的行，因此在触发器过程中将其更改为新的而不是 null，这将解决问题，如下所示

返回新

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-10-03T12:57:29.733

[我在这个网页上](https://blog.akquinet.de/2015/08/04/postgresql-partitioned-tables-and-hibernate/)找到了同样问题的另一个解决方案：

这暗示了@rogerdpack 所说的相同解决方案，将**Return Null**更改为**Return NEW**，并添加一个新触发器，该触发器使用查询删除 master 中的重复元组：

```
DELETE FROM ONLY master_table; 
```

# chartfx - 构建服务器上的 ChatFx Lite LicenseException

> ID：83104
> 
> 赞同：1
> 
> 时间：2008-09-17T13:22:06.277
> 
> 标签：chartfx

我下载了 ChartFx Lite，并在我的开发机器上的 Windows 窗体应用程序中成功使用了它。我已将 ChartFX.Lite.dll 程序集添加到我的源存储库中，并尝试在未安装 ChartFx Lite 的构建服务器上构建项目。我得到错误：

> 创建类型“SoftwareFX.ChartFX.Lite.Chart, ChartFX.Lite, Version=6.0.839.0, Culture=neutral, PublicKeyToken=a1878e2052c08dce”时发生异常 System.ComponentModel.LicenseException：无法获得“SoftwareFX.ChartFX”的设计时许可证。精简版图表'

如果不在我的构建服务器上安装 ChartFx Lite，我需要做什么才能使其正常工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T15:00:15.857

如果您只想测试构建，您可以从 Visual Studio 创建的 .licx 文件中隐藏有关 ChartFx 的行。它应该以这种方式构建，但可能无法正确执行，因为不会包含许可证。

.licx 文件包含在构建期间包含二进制许可证资源的说明。恐怕如果你想要一个真正的构建，你必须在构建服务器上安装 ChartFx。

# gwt - 小部件通知其他小部件

> ID：83106
> 
> 赞同：1
> 
> 时间：2008-09-17T13:22:18.867
> 
> 标签：gwt

GWT 中的小部件应该如何通知其他小部件刷新自己或执行一些其他操作。

我应该使用 sinkEvent / onBrowserEvent 吗？如果是这样，有没有办法创建自定义事件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T19:55:28.767

这是一个非常开放式的问题 - 例如，您可以创建自己的静态事件处理程序类，小部件订阅自己。例如：

```
Class newMessageHandler {
    void update(Widget caller, Widget subscriber) {
        ...
    }
}

customEventHandler.addEventType("New Message", newMessageHandler);

Widget w;
customEventHandler.subscribe(w, "New Message");

...
Widget caller;

// Fire "New Message" event for all widgets which have
// subscribed
customEventHandler.fireEvent(caller, "New Message"); 
```

customEventHandler 跟踪订阅每个命名事件的所有小部件，并调用命名类的更新​​方法，然后可以调用您想要的任何其他方法。你可能想在析构函数中调用 unsubscribe - 但你可以让它随心所欲。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T07:46:02.350

我已经使用[观察者模式](http://en.wikipedia.org/wiki/Observer_pattern)和中央[控制器](http://en.wikipedia.org/wiki/Model-view-controller)解决了这个问题。中央控制器是唯一了解应用程序中所有小部件并确定它们组合在一起的方式的类。如果有人更改了小部件 A 上的某些内容，小部件 A 会触发一个事件。在事件处理程序中，您通过“notifyObservers()”调用调用中央控制器，它通知中央控制器（以及可选的其他控制器，但为简单起见，我不打算这样做）某个动作（传递一个“MyEvent”枚举实例） 已经发生了。

这样，应用程序流逻辑包含在单个中心类中，小部件不需要相互引用的意大利面条。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T21:08:16.897

所以这是我的（示例）实现，首先让我们创建一个新事件：

```
import java.util.EventObject;
import com.google.gwt.user.client.ui.Widget;

public class NotificationEvent extends EventObject {
    public NotificationEvent(String data) {
        super(data);
    }
} 
```

然后我们创建一个事件处理接口：

```
import com.google.gwt.user.client.EventListener;

public interface NotificationHandler extends EventListener {
    void onNotification(NotificationEvent event);
} 
```

如果我们现在有一个实现 NotificationHanlder 的小部件，我们可以通过调用来触发事件：

```
((NotificationHandler)widget).onNotification(event); 
```

# java - 记录多线程应用程序中的活动

> ID：83117
> 
> 赞同：5
> 
> 时间：2008-09-17T13:23:24.637
> 
> 标签：java, logging, log4j

我有一个 Java 分层应用程序，它有一个从不同点调用的多线程数据访问层。对该层的一次调用可能会产生多个线程来并行处理对 DB 的请求。

我正在寻找的是一个日志工具，它允许我定义由各种线程组成的“活动”。因此，数据访问层中的相同方法应根据其调用者记录不同的输出。对不同输出进行分组以总结操作总成本的能力也很重要。

虽然应用程序是 Java 语言，但语言不是限制；我需要的是设计指南，以便最终实现它。我们目前正在使用 log4j，但无法从中获得这种行为。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-17T13:36:27.197

您还应该看看 log4j 的[嵌套诊断上下文](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/NDC.html)功能。为不同的调用者将不同的上下文推送到记录器可能对你有用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-17T13:39:05.333

您应该能够传递一个记录器，因此您基于任务数据的一些“通用”创建一个记录器 - 即用户名等。然后，将此记录器作为参数传递给您需要的所有方法。这样，您就可以在 log4j 配置文件中设置不同的过滤器和/或规则。或者根据记录器名称抓取输出文件。

编辑：还要检查 log4j 中的 MDC 和 NDC 类。您可以在那里添加上下文数据。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T13:33:52.023

在 log4j 中，您可以使用“%t”模式记录线程名称。请参阅[log4j 模式布局](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/PatternLayout.html)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-17T18:00:19.917

在我的一个（网络）应用程序中，我使用了一个 ThreadLocal 记录器，它将记录信息捕获到一个 StringBuilder 中。logger 对象在 HttpServlet#service 方法中初始化，如果设置了 trace 参数（如果没有设置，则有一个非常快的 null-logger）。结果输出要么作为 HTML 注释转储到请求页面中，要么写入一个段中的日志文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T13:33:59.743

在 Java5（及更高版本）中，您可以调用

```
StackTraceElement[] stackTrace = Thread.currentThread().getStackTrace(); 
```

检查堆栈跟踪到您想要的任何深度并相应地记录。

在 Java 1.4 中，您可以获得相同的信息

```
StackTraceElement[] stackTrace = new Exception().getStackTrace(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T13:34:26.187

您想将记录器对象与我认为的线程相关联。为每个线程保存一个 log4j 记录器实例的 ThreadLocal 变量可能会有所帮助：

[http://java.sun.com/javase/6/docs/api/java/lang/ThreadLocal.html](http://java.sun.com/javase/6/docs/api/java/lang/ThreadLocal.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T13:58:31.433

您需要将一些结构传递给标识当前“活动”的数据访问层。您可能已经有一个有意义的“活动”类，您可以使用[Sunny 建议](https://stackoverflow.com/questions/83117/logging-activities-in-multithreaded-applications#83312)的 Logger 实例，或者您可以使用第三种结构来跟踪活动上下文。

无论如何，由于您的“活动”是跨多个线程处理的，因此您不能使用线程本地存储来跟踪当前的“活动”，就像大多数其他当前答案所暗示的那样。您将需要明确地传递它。

我建议在 log4j 之上制作一个小外观，使用以下方法扩展接口

```
void debug(Activity activity, String message); 
```

并将活动上下文从数据访问层传递给它。

您需要对数据访问层进行一些修改以允许您将当前活动传递给它，但如何最好地做到这一点很大程度上取决于当前接口。如果您使用 Workspace 模式，您可能只需要在 Workspace-class 上添加一个 setActivity() 方法，但其他接口模式可能需要您向所有方法添加一个 Activity 参数。

如果您由于某种原因无法或不愿意更改数据访问层，您当然可以在调用数据访问层之前将活动上下文存储在线程本地存储中，并在生成子线程或排队之前检索它数据访问层的工作。这是一个可行的解决方案，但是以这种方式传递信息是否有点危险。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-10-21T19:04:12.563

您可以在您的场景中使用**MDC 或 NDC ，** **NDC 的工作原理是堆栈，而 MDC 工作在 Map 上**，这里是两者的官方文档

[http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/MDC.html](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/MDC.html) [http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/NDC.html](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/NDC.html)

# wcf - WCF Oracle 适配器和 UDT

> ID：83122
> 
> 赞同：0
> 
> 时间：2008-09-17T13:24:03.153
> 
> 标签：wcf, oracle, biztalk

有什么方法可以使用带有当前 WCF 适配器的 Oracle UDT？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T15:00:07.727

如果我正确理解您的问题，您想在 WCF 服务中表达 Oracle 用户定义类型吗？这实际上取决于要使用的协议。例如，如果您正在使用一种 SOAP 协议，如 WS* 协议，那么您就会被 SOAP 中定义的那些数据类型所困扰。从任何数据类型开始，无论是数据库中的内置类型、C# 中的自定义类型，还是 SQL Server、Oracle 中的用户定义类型，您都会遇到此限制。您的简单类型将映射到不*那么复杂*的东西，例如数字或字符串。如果您有一个复杂的类型，您可以选择为该类型编写自己的序列化。

# winapi - 更改 USERPostMessageLimit 的后果

> ID：83126
> 
> 赞同：4
> 
> 时间：2008-09-17T13:24:14.963
> 
> 标签：winapi

我们的一个遗留应用程序严重依赖于`PostThreadMessage()`线程间通信，因此我们将注册表中的 USERPostMessageLimit（方式）增加到超过正常的 10.000。

但是，MSDN 上的文档指出“这个限制应该足够大。如果您的应用程序超出限制，则应重新设计它以避免消耗如此多的系统资源。” [ [1](http://msdn.microsoft.com/en-us/library/ms644946(VS.85).aspx) ]

谁能告诉我消耗过多的系统资源究竟是如何表现出来的？究竟什么是系统资源？我可以以某种方式监控应用程序对系统资源的使用情况吗？任何信息都将非常有助于确定是否值得花时间和精力重新设计此应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T15:06:03.283

它所指的资源是线程用于接收/处理消息的资源。您可以使用任务管理器监控线程池大小和其他资源（查看查看->选择列）。如果消费者被资源锁定，它可以帮助您识别特定资源，即使您的线程正在增加，也可以寻找达到顶峰的资源计数。

然而; 如果您需要增加 USERPostMessageLimit 则消息生产者只是重载消息消费者；通过增加此限制，您正在加剧您的问题而不是解决它。将 USERPostMessageLimit 降低回默认值，如果您的消息生产者无法发布消息，请在重试之前尝试休眠，允许消费线程清除一些消息。

# c# - ORA-00161: 事务分支长度 103 非法（允许的最大值为 64

> ID：83130
> 
> 赞同：1
> 
> 时间：2008-09-17T13:24:32.340
> 
> 标签：c#, oracle

错误：

```
ORA-00161: transaction branch length 103 is illegal (maximum allowed 64… 
```

我正在使用 Oracle 的 DAC，您知道是否有针对此的补丁吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T17:31:56.100

[对于 .net 2.0、vista 和 oracle http://forums.oracle.com/forums/thread.jspa?threadID=516250](http://forums.oracle.com/forums/thread.jspa?threadID=516250)，这看起来是一个类似的问题

# javascript - 是什么导致错误“无法从已释放的脚本中执行代码”

> ID：83132
> 
> 赞同：66
> 
> 时间：2008-09-17T13:24:40.843
> 
> 标签：javascript, internet-explorer

我以为我不久前找到了解决方案（请参阅我的[博客](https://tjrobinson.net/programming/technology/2006/09/03/cant-execute-code-from-a-freed-script.html)）：

> 如果您遇到 JavaScript（或者应该是 JScript）错误“无法从已释放的脚本中执行代码” - 请尝试移动头部中的任何元标记，以便它们位于您的脚本标记之前。

...但是根据最近的博客评论之一，我建议的修复可能不适用于所有人。我认为这将是一个向 StackOverflow 社区开放的好方法......

什么导致错误“无法从释放的脚本执行代码”以及解决方案/解决方法是什么？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-09-17T15:12:56.603

当您调用在不再存在的窗口或框架中创建的函数时，您会收到此错误。

如果你事先不知道窗口是否仍然存在，你可以做一个 try/catch 来检测它：

```
try
{
  f();
}
catch(e)
{
  if (e.number == -2146823277)
    // f is no longer available
    ...
} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-09-01T05:35:05.217

**该错误是在脚本的“父”窗口被释放（即：关闭）但调用对仍然持有的脚本的引用（例如在另一个窗口中）时引起的。**即使“对象”还活着，它想要执行的上下文也不是。

它有点脏，但它适用于我的 Windows 边栏小工具：

这是一般的想法：“主”窗口设置了一个函数，它将评估一些代码，是的，它就是那么难看。然后一个“孩子”可以调用这个“构建器函数”（它/绑定到主窗口的范围/）并取回一个也绑定到“主”窗口的函数。当然，一个明显的缺点是，被“反弹”的函数不能在它看似定义的范围内关闭......无论如何，足够的胡言乱语：

这部分是伪代码，但我在 Windows 边栏小工具上使用了它的一个变体（我一直这么说是因为边栏小工具在“不受限制的区域 0”中运行，这可能会——也可能不会——极大地改变场景。）

```
 // This has to be setup from the main window, not a child/etc!
mainWindow.functionBuilder = function (func, args) {
  // trim the name, if any
  var funcStr = ("" + func).replace(/^function\s+[^\s(]+\s*\(/, "function (")
  try {
    var rebuilt
    eval("rebuilt = (" + funcStr + ")")
    return rebuilt(args)
  } catch (e) {
    alert("oops! " + e.message)
  }
}

// then in the child, as an example
// as stated above, even though function (args) looks like it's 
// a closure in the child scope, IT IS NOT. There you go :)
var x = {blerg: 2}
functionInMainWindowContenxt = mainWindow.functionBuilder(function (args) {
  // in here args is in the bound scope -- have at the child objects! :-/
  function fn (blah) {
    return blah * args.blerg
  }
  return fn
}, x)

x.blerg = 7
functionInMainWindowContext(6) // -> 42 if I did my math right 
```

作为一种变体，主窗口应该能够将 functionBuilder 函数传递给子窗口——只要在主窗口上下文中定义了 functionBuilder 函数！

我觉得我用了太多的词。YMMV。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-05-10T22:50:25.907

这是一个非常具体的案例，我在其中看到了这种行为。它在 IE6 和 IE7 中对我来说是可重现的。

从 iframe 中：

```
window.parent.mySpecialHandler = function() { ...work... } 
```

然后，用新内容重新加载 iframe 后，在包含 iframe 的窗口中：

```
window.mySpecialHandler(); 
```

此调用因“无法从已释放的脚本执行代码”而失败，因为 mySpecialHandler 是在不再退出的上下文（iframe 的原始 DOM）中定义的。（重新加载 iframe 会破坏此上下文。）

但是，您可以在父窗口中安全地设置“可序列化”值（原语、不直接引用函数的对象图）。如果你真的需要一个单独的窗口（在我的例子中是一个 iframe）来为远程窗口指定一些工作，你可以将工作作为字符串传递并在接收器中“评估”它。请注意这一点，它通常不会带来干净或安全的实现。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-02-25T16:32:31.883

如果您尝试访问 JS 对象，最简单的方法是创建一个副本：

```
var objectCopy = JSON.parse(JSON.stringify(object)); 
```

希望它会有所帮助。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-17T14:02:32.950

当子窗口尝试与不再打开的父窗口通信时，MSIE 中可能会发生此错误。

（不完全是世界上最有用的错误消息文本。）

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2011-07-12T17:53:28.487

从 IE9 开始，当对存储在另一个对象的数组中的 Date 对象调用 .getTime() 时，我们开始收到此错误。解决方案是在调用 Date 方法之前确保它是 Date ：

失败：`rowTime = wl.rowData[a][12].getTime()`

经过：`rowTime = new Date(wl.rowData[a][12]).getTime()`

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-05-30T19:19:12.650

我在子框架内遇到了这个问题，我向顶层窗口添加了一个引用类型，并在子窗口重新加载后尝试访问它

IE

```
// set the value on first load
window.top.timestamp = new Date();

// after frame reloads, try to access the value
if(window.top.timestamp) // <--- Raises exception
... 
```

我能够通过仅使用原始类型来解决问题

```
// set the value on first load
window.top.timestamp = Number(new Date()); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-04-29T03:26:42.833

这并不是一个真正的答案，而是更多的例子来说明这种情况究竟发生在哪里。

我们有框架 A 和框架 B（这不是我的想法，但我必须接受它）。框架 A 永不改变，框架 B 不断变化。我们不能将代码更改直接应用到框架 A，因此（根据供应商的说明）我们只能在框架 B 中运行 JavaScript——即不断变化的确切框架。

我们有一段 JavaScript 需要每 5 秒运行一次，因此框架 B 中的 JavaScript 创建一个新的脚本标签并插入到框架 B 的头部部分。 setInterval 存在于这个新脚本（注入的那个）中，如以及要调用的函数。尽管注入的 JavaScript 在技术上是由帧 A 加载的（因为它现在包含脚本标记），但一旦帧 B 更改，setInterval 将无法再访问该函数。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-04-12T13:54:53.027

我在最终打开 iFrame 的页面中的 IE9 中遇到此错误。只要 iFrame 没有打开，我就可以使用 localStorage。打开和关闭 iFrame 后，由于此错误，我无法再使用 localStorage。要修复它，我必须将此代码添加到 iFrame 内部的 Javascript 中，并使用 localStorage。

```
if (window.parent) {
    localStorage = window.parent.localStorage;
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-05-14T05:39:26.447

打开对话时在 DHTMLX 中出现此错误，找不到父 ID 或当前窗口 ID

```
 $(document).ready(function () {

            if (parent.dxWindowMngr == undefined) return;
            DhtmlxJS.GetCurrentWindow('wnManageConDlg').show();

}); 
```

只需确保在打开对话时发送正确的当前/父窗口 ID

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-06-13T09:50:29.813

在更新 iframe 的 src 时，我收到了该错误。

通过像这样访问主窗口中元素的事件（在我的情况下单击）得到该错误（直接调用主/最外窗口）：

```
top.$("#settings").on("click",function(){
    $("#settings_modal").modal("show");
}); 
```

我只是像这样更改它并且它工作正常（调用 iframe 窗口的父级的父级）：

```
$('#settings', window.parent.parent.document).on("click",function(){                    
   $("#settings_modal").modal("show");      
}); 
```

我的包含模态框的 iframe 也在另一个 iframe 中。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-10-14T15:23:28.287

前面的答案中的解释非常相关。只是想提供我的场景。希望这可以帮助其他人。

我们正在使用：

```
<script> window.document.writeln(table) </script> 
```

, 并在事件中调用脚本中的其他函数，`onchange`但 writeln 完全覆盖了 IE 中的 HTML，因为它在 chrome 中具有不同的行为。

我们将其更改为：

```
<script> window.document.body.innerHTML = table;</script> 
```

因此保留了解决问题的脚本。

# database - 外键有什么问题？

> ID：83147
> 
> 赞同：269
> 
> 时间：2008-09-17T13:25:54.570
> 
> 标签：database, database-design, foreign-keys, referential-integrity, data-integrity

[我记得在播客 014](https://stackoverflow.fogbugz.com/default.asp?W4)中听到[Joel Spolsky](http://en.wikipedia.org/wiki/Joel_Spolsky)提到他几乎没有使用过外键（如果我没记错的话）。但是，对我来说，它们对于避免整个数据库中的重复和后续数据完整性问题似乎非常重要。

人们是否有充分的理由说明原因（以避免根据堆栈溢出原则进行讨论）？

**编辑：** [*“我还没有理由创建外键，所以这可能是我实际设置外键的第一个原因。”*](https://stackoverflow.fogbugz.com/default.asp?W13086)

* * *

## 回答 #1

> 赞同：372
> 
> 时间：2008-09-17T13:46:37.390

使用外键的原因：

*   你不会得到孤立的行
*   您可以获得很好的“删除级联”行为，自动清理表
*   了解数据库中表之间的关系有助于优化器计划您的查询以最有效地执行，因为它能够更好地估计连接基数。
*   FK 对在数据库上收集哪些统计信息最重要提供了相当大的提示，这反过来又会带来更好的性能
*   它们支持各种自动生成的支持——ORM 可以自己生成，可视化工具能够为您创建漂亮的模式布局，等等。
*   刚接触项目的人会更快地进入事物的流程，因为否则隐含的关系会被明确记录

不使用外键的原因：

*   您正在使数据库在每个[CRUD](https://en.wikipedia.org/wiki/Create,_read,_update_and_delete)操作上额外工作，因为它必须检查 FK 一致性。如果您有很多客户流失，这可能是一笔不小的开支
*   通过强制执行关系，FK 指定了您必须添加/删除事物的顺序，这可能导致数据库拒绝执行您想要的操作。（当然，在这种情况下，您要做的是创建一个孤立行，这通常不是一件好事）。当您进行大批量更新时，这尤其痛苦，并且您先加载一个表，而第二个表创建一致的状态（但是如果第二个加载可能失败并且您的数据库现在不一致？）。
*   有时你事先知道你的数据会变脏，你接受它，你希望数据库接受它
*   你只是懒惰:-)

我认为（我不确定！）大多数已建立的数据库都提供了一种方法来指定未强制执行的外键，并且只是一些元数据。由于不强制执行消除了不使用 FK 的所有理由，如果第二部分中的任何原因适用，您可能应该走这条路。

* * *

## 回答 #2

> 赞同：83
> 
> 时间：2008-09-17T16:55:17.437

这是教养的问题。如果在你的教育或职业生涯的某个地方，你花时间喂养和关心数据库（或与这样做的有才华的人密切合作），那么实体和关系的基本原则在你的思维过程中根深蒂固。其中包括如何/何时/为什么指定数据库中的键（主键、外键，可能还有备用键）。这是第二天性。

但是，如果您过去在与 RDBMS 相关的工作中没有如此彻底或积极的经验，那么您可能没有接触过此类信息。或者您的过去可能包括沉浸在一个强烈反对数据库的环境中（例如，“那些 DBA 是白痴 - 我们很少，我们选择了几个 java/c# 代码吊索将拯救这一天”），在这种情况下，您可能会强烈反对一些 dweeb 神秘的喋喋不休告诉你，如果你只是听，FKs（以及它们可能暗示的约束）真的很重要。

大多数人小时候都被教导刷牙很重要。没有它你能过得去吗？当然可以，但是在某个地方，如果您在每餐后刷牙，您可用的牙齿会更少。如果妈妈和爸爸足够负责数据库设计和口腔卫生，我们就不会进行这样的对话。:-)

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2008-09-17T13:38:10.450

我确信有很多应用程序可以让你摆脱它，但这不是最好的主意。您不能总是指望您的应用程序来正确管理您的数据库，坦率地说，管理数据库不应该是您的应用程序非常关心的问题。

如果您使用的是**关系**数据库，那么您似乎应该在其中定义一些**关系**。不幸的是，这种态度（您不需要外键）似乎被许多应用程序开发人员所接受，他们宁愿不为诸如数据完整性之类的愚蠢事情而烦恼（但需要这样做，因为他们的公司没有专门的数据库开发人员）。通常在由这些类型组合在一起的数据库中，您很幸运只有主键；）

* * *

## 回答 #4

> 赞同：42
> 
> 时间：2008-09-17T13:29:34.013

Foreign keys are **essential** to any relational database model.

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2008-09-17T13:40:21.943

我总是使用它们，但后来我为金融系统制作数据库。数据库是应用程序的关键部分。如果财务数据库中的数据不完全准确，那么您在代码/前端设计中投入多少精力并不重要。你只是在浪费时间。

还有一个事实是，多个系统通常需要直接与数据库交互——从其他只读取数据的系统（Crystal Reports）到插入数据的系统（不一定使用我设计的 API；它可能由刚刚发现 VBScript 并拥有 SQL 框的 SA 密码的愚蠢经理）。如果数据库不像它可能的那样防白痴，那么，再见了数据库。

如果您的数据很重要，那么是的，使用外键，创建一套存储过程来与数据交互，并尽可能制作最坚固的数据库。如果您的数据不重要，为什么要从创建数据库开始？

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2012-10-26T13:11:25.317

**更新**：我现在总是使用外键。我对“他们使测试复杂”的反对意见的回答是“编写你的单元测试，这样他们就根本不需要数据库。任何使用数据库的测试都应该正确使用它，并且包括外键。如果设置很痛苦，找到一种不那么痛苦的方法来进行设置。”

* * *

# 外键使自动化测试复杂化

假设您正在使用外键。你正在编写一个自动化测试，上面写着“当我更新一个财务账户时，它应该保存交易记录。” 在这个测试中，您只关心两个表：`accounts`和`transactions`.

但是，`accounts`有一个外键到`contracts`，并且`contracts`有一个 fk 到`clients`，并且`clients`有一个 fk 到`cities`，并且`cities`有一个 fk 到`states`。

**现在数据库将不允许您在未在与您的测试无关的四个表中设置数据的情况下运行您的测试**。

对此至少有两种可能的观点：

*   “这是一件好事：你的测试应该是现实的，并且这些数据约束将存在于生产中。”
*   “这是一件坏事：你应该能够在不涉及其他部分的情况下对系统的各个部分进行单元测试。你可以为整个系统添加集成测试。”

也可以在运行测试时暂时关闭外键检查。MySQL 至少[支持这个](http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_foreign_key_checks)。

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2008-09-17T13:59:23.443

“它们会使删除记录变得更加麻烦——你不能删除“主”记录，因为在其他表中存在外键会违反该约束的记录。”

请务必记住，SQL 标准定义了在删除或更新外键时采取的操作。我知道的有：

*   `ON DELETE RESTRICT`- 防止删除其他表中在此列中具有键的任何行。这就是上面肯·雷所描述的。
*   `ON DELETE CASCADE`- 如果另一个表中的行被删除，请删除该表中引用它的所有行。
*   `ON DELETE SET DEFAULT`- 如果另一个表中的一行被删除，请将引用它的任何外键设置为该列的默认值。
*   `ON DELETE SET NULL`- 如果另一个表中的行被删除，则将该表中引用它的任何外键设置为空。
*   `ON DELETE NO ACTION`- 这个外键只标明它是外键；即用于 OR 映射器。

这些相同的操作也适用于`ON UPDATE`.

默认值似乎取决于您使用的[sql server。](/questions/tagged/sql "显示标记为“sql”的问题")

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2008-09-17T13:36:15.107

@imphasing - 这正是导致维护噩梦的心态。

为什么哦，为什么您会忽略声明性引用完整性，其中可以**保证**数据至少是一致的，而支持所谓的“软件执行”，这充其量只是一种薄弱的预防措施。

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2008-09-17T13:34:04.813

不使用它们有一个很好的理由： **如果您不了解它们的作用或如何使用它们。**

在错误的情况下，外键约束可能导致意外的瀑布式复制。如果有人删除了错误的记录，撤消它可能会成为一项艰巨的任务。

同样，相反，当您需要删除某些东西时，如果设计不当，约束可能会导致各种阻止您的锁定。

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2008-09-17T13:27:57.793

There are no **good** reasons *not* to use them... unless orphaned rows aren't a big deal to you I guess.

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2018-01-12T13:23:51.337

“在添加记录之前，检查另一个表中是否存在对应的记录”是业务逻辑。

以下是您不希望在数据库中使用它的一些原因：

1.  如果业务规则发生变化，则必须更改数据库。在很多情况下，数据库需要重新创建索引，这在大表上很慢。（更改规则包括：允许客人发布消息或允许用户删除他们的帐户，尽管已经发布了评论等）。

2.  更改数据库并不像通过将更改推送到生产存储库来部署软件修复那么容易。我们希望尽可能避免改变数据库结构。数据库中的业务逻辑越多，您就越有可能需要更改数据库（并触发重新索引）。

3.  TDD。在单元测试中，您可以用数据库代替模拟并测试功能。如果您的数据库中有任何业务逻辑，则您没有进行完整的测试，并且需要使用数据库进行测试或在代码中复制业务逻辑以进行测试，复制逻辑并增加逻辑在数据库中不起作用的可能性同样的方法。

4.  使用不同的数据源重用您的逻辑。如果数据库中没有逻辑，我的应用程序可以从数据库中的记录创建对象，从 Web 服务、json 文件或任何其他来源创建它们。我只需要换出数据映射器实现，就可以将我所有的业务逻辑与任何源一起使用。如果数据库中有逻辑，这是不可能的，您必须在数据映射层或业务逻辑中实现逻辑。无论哪种方式，您都需要在代码中进行这些检查。如果数据库中没有逻辑，我可以使用不同的数据库或平面文件实现将应用程序部署在不同的位置。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2014-10-13T10:02:02.170

根据我的经验，最好避免在数据库关键应用程序中使用 FK。我不会不同意这里的人说 FK 是一种很好的做法，但在数据库很大并且每秒有大量 CRUD 操作的情况下它是不切实际的。我可以不命名分享......最大的投资银行之一在数据库中没有一个 FK。这些约束由程序员在创建涉及 DB 的应用程序时处理。基本原因是，当一个新的 CRUD 完成时，它必须影响多个表并验证每个插入/更新，尽管这对于影响单行的查询来说不是一个大问题，但是当你处理时它确实会产生巨大的延迟任何大型银行都必须作为日常任务进行的批处理。

最好避免 FK，但它的风险必须由程序员来处理。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2009-10-04T05:52:43.437

更大的问题是：你会戴着眼罩开车吗？如果您开发一个没有引用约束的系统，情况就是这样。请记住，业务需求更改、应用程序设计更改、代码中的相应逻辑假设更改、逻辑本身可以重构等等。通常，数据库中的约束是在当代逻辑假设下设置的，对于特定的逻辑断言和假设集似乎是正确的。

在应用程序的整个生命周期中，引用和数据检查限制了通过应用程序收集数据，尤其是当新需求推动逻辑应用程序更改时。

**对于这个清单的主题**——从实时事务处理系统的角度来看，外键本身不会“提高性能”，也不会显着“降低性能”。但是，在高容量“批处理”系统中进行约束检查会产生总成本。因此，这是实时与批量交易过程的区别；批处理 - 由约束检查引起的按顺序处理的批处理的总成本会对性能造成影响。

在一个设计良好的系统中，数据一致性检查将在处理批次“之前”完成（尽管如此，这里也有相关的成本）；因此，在加载期间不需要外键约束检查。事实上，所有约束，包括外键，都应该暂时禁用，直到批处理完成。

**查询性能**- 如果表是在外键上连接的，请注意外键列不是索引的事实（尽管相应的主键是按定义索引的）。就此而言，通过索引外键，通过索引任何键，并在索引上连接表有助于提高性能，而不是通过连接具有外键约束的非索引键。

**更改主题**，如果数据库仅支持网站显示/呈现内容/等和记录点击，那么对所有表具有完全约束的数据库对于此类目的来说是过度的。想想看。大多数网站甚至不为此使用数据库。对于类似的要求，如果数据只是被记录而不是被引用，请使用没有约束的内存数据库。这并不意味着没有数据模型，是逻辑模型，但没有物理数据模型。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-09-17T13:33:40.713

I agree with the previous answers in that they are useful to mantain data consistency. However, there was an [interesting post by Jeff Atwood](http://www.codinghorror.com/blog/archives/001152.html) some weeks ago that discussed the pros and cons of normalized and consistent data.

In a few words, a denormalized database can be faster when handling huge amounts of data; and you may not care about precise consistency depending on the application, but it forces you to be much more careful when dealing with data, as the DB won't be.

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2008-09-17T13:34:29.447

Clarify 数据库是没有主键或外键的商业数据库的示例。

[http://www.geekinterview.com/question_details/18869](http://www.geekinterview.com/question_details/18869)

有趣的是，技术文档不遗余力地解释表是如何相关的，使用哪些列来连接它们等。

换句话说，他们本**可以**使用显式声明 (DRI) 连接表，但他们**选择不这样做**。

因此，Clarify 数据库充满了不一致，并且表现不佳。

但我想它使开发人员的工作更轻松，不必编写代码来处理引用完整性，例如在删除、添加之前检查相关行。

我认为，这是关系数据库中没有外键约束的主要好处。它使开发更容易，至少从不顾一切的角度来看是这样。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-09-17T13:31:08.470

They can make deleting records more cumbersome - you can't delete the "master" record where there are records in other tables where foreign keys would violate that constraint. You can use triggers to have cascading deletes.

If you chose your primary key unwisely, then changing that value becomes even more complex. For example, if I have the PK of my "customers" table as the person's name, and make that key a FK in the "orders" table", if the customer wants to change his name, then it is a royal pain... but that is just shoddy database design.

I believe the advantages in using fireign keys outweighs any supposed disadvantages.

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-09-17T15:17:56.780

使用外键的其他原因： - 允许更多地重用数据库

不使用外键的其他原因： - 您试图通过减少重用来将客户锁定到您的工具中。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-09-17T13:34:15.623

验证外键约束需要一些 CPU 时间，因此有些人会省略外键以获得额外的性能。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2014-11-23T14:01:56.697

我只知道 Oracle 数据库，不知道其他数据库，而且我知道外键对于维护数据完整性至关重要。在插入数据之前，需要制作一个数据结构，并正确制作。完成后——因此创建了所有主键和外键——工作就完成了！

含义：孤立行？不，在我的生活中从未见过。除非一个糟糕的程序员忘记了外键，或者他在另一个层面上实现了它。两者都是 - 在 Oracle 的上下文中 - 巨大的错误，这将导致数据重复、孤立数据，从而：数据损坏。我无法想象没有强制执行 FK 的数据库。对我来说，这看起来很混乱。这有点像 Unix 权限系统：想象每个人都是 root。想想混乱。

外键是必不可少的，就像主键一样。这就像说：如果我们删除主键怎么办？好吧，完全的混乱将会发生。就是这样。您不能将主键或外键职责移至编程级别，它必须在数据级别。

缺点 ？是的，一点没错 ！因为在插入时，将会发生更多的检查。但是，如果数据完整性比性能更重要，那就不费吹灰之力了。Oracle 的性能问题与 PK 和 FK 附带的索引更相关。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2015-09-14T13:16:57.490

如果您绝对确定，一个底层数据库系统将来不会改变，我会使用外键来确保数据完整性。

**但这是另一个完全不使用外键的非常好的现实理由：**

您正在开发一个产品，它应该支持不同的数据库系统。

如果您正在使用能够连接到许多不同数据库系统的实体框架，您可能还希望支持“开源免费”无服务器数据库。并非所有这些数据库都支持您的外键规则（更新、删除行......）。

**这可能会导致不同的问题：**

1.) 创建或更新数据库结构时，您可能会遇到错误。也许只会有静默错误，因为您的外键只是被数据库系统忽略了。

2.）如果您依赖外键，您可能会在业务逻辑中进行更少甚至没有数据完整性检查。现在，如果新的数据库系统不支持这些外键规则或只是以不同的方式运行，您必须重写您的业务逻辑。

你可能会问：谁需要不同的数据库系统？好吧，并不是每个人都能买得起或想要在他的机器上安装一个完整的 SQL-Server。这是软件，需要维护。其他人已经在其他一些数据库系统上投入了时间和金钱。无服务器数据库非常适合仅在一台机器上使用的小客户。

没有人知道所有这些数据库系统的行为方式，但是您的业务逻辑以及完整性检查始终保持不变。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2008-09-17T16:23:39.493

我还认为外键在大多数数据库中都是必需的。唯一的缺点（除了强制一致性带来的性能损失之外）是拥有外键允许人们编写假设存在功能性外键的代码。这绝不应该被允许。

例如，我看到人们编写代码插入到被引用的表中，然后尝试插入到引用表中而不验证第一次插入是否成功。如果稍后删除外键，则会导致数据库不一致。

您也无法选择在更新或删除时假设特定行为。无论是否存在外键，您仍然需要编写代码来执行您想要的操作。如果您假设删除是级联的，而实际上它们不是级联的，那么您的删除将失败。如果您假设对引用列的更新被传播到引用行而不是引用行，那么您的更新将失败。出于编写代码的目的，您可能还没有这些功能。

如果打开了这些功能，那么您的代码无论如何都会模拟它们，并且您将失去一点性能。

所以，总结......如果你需要一个一致的数据库，外键是必不可少的。永远不应假定外键在您编写的代码中存在或起作用。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2008-09-17T13:32:07.610

The argument I have heard is that the front-end should have these business rules. Foreign keys "add unnecessary overhead" when you shouldn't be allowing any insertions that break your constraints in the first place. Do I agree with this? No, but that is what I have always heard.

**EDIT:** My guess is he was referring to *foreign key constraints*, not foreign keys as a concept.

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2008-09-17T14:13:02.177

对我来说，如果你想遵循[ACID](http://en.wikipedia.org/wiki/ACID)标准，拥有外键以确保引用完整性至关重要。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2008-09-17T16:08:21.027

跨应用程序生命周期的可维护性和稳定性如何？大多数数据的生命周期都比使用它的应用程序长。关系和数据完整性太重要了，不能寄希望于下一个开发团队在应用程序代码中正确处理。如果您没有使用不尊重自然关系的脏数据的数据库，您会的。数据完整性的重要性将变得非常清楚。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2008-09-17T16:58:36.727

我回应了 Dmitriy 的回答——说得很好。

对于那些担心 FK 经常带来的性能开销的人，有一种方法（在 Oracle 中）可以获得 FK 约束的查询优化器优势，而无需在插入、删除或更新期间进行约束验证的成本开销。即创建具有 RELY DISABLE NOVALIDATE 属性的 FK 约束。这意味着查询优化器假定在构建查询时已强制执行约束，而数据库实际上并未强制执行约束。当您使用这样的 FK 约束填充表时，您必须非常小心地承担责任，以确保您的 FK 列中没有违反约束的数据，就好像您这样做一样可能会从涉及此 FK 约束所在的表的查询中获得不可靠的结果。

我通常在我的数据集市模式中的某些表上使用此策略，而不是在我的集成暂存模式中。我确保我从中复制数据的表已经强制执行相同的约束，或者 ETL 例程强制执行约束。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2008-09-17T14:17:50.763

我必须对这里的大部分评论置之不理，外键是确保您拥有完整数据的必要项目。ON DELETE 和 ON UPDATE 的不同选项将允许您绕过人们在此处提到的有关其使用的一些“跌倒”。

我发现在我所有项目的 99% 中，我都会使用 FK 来强制执行数据的完整性，但是，在极少数情况下，我的客户必须保留他们的旧数据，不管它有多糟糕......但是后来我花了很多时间编写代码，无论如何只获取有效数据，所以它变得毫无意义。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2013-03-26T17:55:27.330

许多在这里回答的人都过于关注通过引用约束实现的引用完整性的重要性。在具有参照完整性的大型数据库上工作表现不佳。Oracle 在级联删除方面似乎特别糟糕。我的经验法则是应用程序永远不应该直接更新数据库，而应该通过存储过程。这将代码库保留在数据库中，并意味着数据库保持其完整性。

在许多应用程序可能正在访问数据库的情况下，由于参照完整性约束确实会出现问题，但这取决于控制。

还有一个更广泛的问题，应用程序开发人员可能有非常不同的需求，而数据库开发人员可能不一定那么熟悉。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2008-09-17T13:55:18.430

FK 可能会给您带来问题的一种情况是，当您拥有引用该键的历史数据（在查找表中）时，即使您不再希望该键可用。
显然，解决方案是预先设计更好的东西，但我在这里考虑的是现实世界的情况，你并不总是可以控制完整的解决方案。
例如：也许您有一个`customer_type`列出不同类型客户的查找表 - 假设您需要删除某个客户类型，但是（由于业务限制）无法更新客户端软件，并且没有人设想这种情况在开发软件时，它是某个其他表中的外键这一事实可能会阻止您删除该行，即使您知道引用它的历史数据是不相关的。
在被这个烧了几次之后，你可能会远离关系的 db 强制。
（我并不是说这很好 - 只是给出一个你可能决定避免 FK 和 db 约束的理由）

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2008-09-17T16:08:22.633

我会回应 Dmitriy 所说的话，但要补充一点。

我在一个批量计费系统上工作，该系统需要在 30 多个表上插入大量行。我们不允许执行数据泵 (Oracle)，因此我们必须执行批量插入。这些表上有外键，但我们已经确保它们不会破坏任何关系。

在插入之前，我们禁用外键约束，这样 Oracle 就不会永远进行插入。插入成功后，我们重新启用约束。

PS：在具有许多外键和单个记录的子行数据的大型数据库中，有时外键可能不好，您可能希望禁止级联删除。对于我们在计费系统中的我们来说，如果我们进行级联删除会花费太长时间并且对数据库过于繁重，因此我们只需在主驱动程序（父）表上使用字段将记录标记为坏记录。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2008-09-17T13:38:46.923

我也听说过这个论点——那些忘记在外键上放置索引然后抱怨某些操作很慢的人（因为约束检查可以利用任何索引）。所以总结一下：没有充分的理由不使用外键。所有现代数据库都支持级联删除，所以...

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2012-08-22T22:50:16.207

在我从事的一个项目中，通常存在隐式而不是显式的关系，因此可以在同一列上连接多个表。

取下表

**地址**

*   地址 ID (PK)
*   实体 ID
*   实体类型
*   城市
*   状态
*   国家
*   ETC..

EntityType 的可能值可能是 Employee、Company、Customer，而 EntityId 指的是您感兴趣的任何表的主键。

我真的不认为这是做事的最佳方式，但它适用于这个项目。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2008-09-18T04:17:27.513

像许多事情一样，这是一种权衡。这是您要在哪里进行工作以验证数据完整性的问题：

（1）使用外键（单点配置表，功能已经实现，测试，证明可以工作）

(2) 将其留给数据库的用户（可能有多个用户/应用程序更新同一个表，这意味着更多潜在的故障点并增加了测试的复杂性）。

数据库执行 (2) 更高效，更易于维护且风险更小 (1)。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2013-12-04T18:47:38.713

在 DB2 中，如果使用 MQT（物化查询表），优化器需要外键约束才能为任何给定查询选择正确的计划。由于它们包含基数信息，优化器大量使用元数据来使用 MQT。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2010-06-11T19:27:26.040

数据结构设计的一个好的原则是确保表或对象的每个属性都受到易于理解的约束。这很重要，因为如果您或您的程序可以依赖数据库中的有效数据，那么您就不太可能出现由错误数据引起的程序缺陷。您还花费更少的时间编写代码来处理错误情况，并且您更有可能预先编写错误处理代码。

在许多情况下，这些约束可以在编译时定义，在这种情况下，您可以编写一个过滤器以确保属性始终在范围内，否则保存属性的尝试会失败。

但是，在许多情况下，这些约束可能会在运行时发生变化。例如，您可能有一个“汽车”表，它具有“颜色”作为属性，该属性最初采用“红色”、“绿色”和“蓝色”等值。在程序执行期间，可以将有效颜色添加到该初始列表中，并且添加的新“汽车”可以采用最新颜色列表中的任何颜色。此外，您通常希望这个更新的颜色列表在程序重新启动后仍然存在。

要回答您的问题，事实证明，如果您需要可以在运行时更改的数据约束，并且这些更改必须在程序重新启动后仍然存在，那么外键是解决该问题的最简单和最简洁的解决方案。开发成本是添加一个表（例如“colors”、对“cars”表的外键约束和索引），运行时成本是针对最新颜色的额外表查找来验证数据，并且这种运行时成本通常通过索引和缓存来减轻。

如果您不使用外键来满足这些要求，则必须编写软件来管理列表，查找有效条目，将其保存到磁盘，如果列表很大，则有效地构建数据，确保对列表的任何更新都不会损坏列表文件，在有多个读取器和/或写入器的情况下提供对列表的串行访问，等等。ie 你需要实现很多 RDBMS 功能。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2015-04-15T07:38:38.127

**我们经常收到带有 FK 约束的错误**无法****添加** 或更新子行：外键约束失败 假设有两个表 inventory_source 和 contract_lines，我们*从 inventory_source 引用contract_lines 中的 inventory_source_id*并假设我们想从 inventory_source 删除记录并且该记录已经存在于 contract_lines 中，或者我们想从 Base 表中删除 PK 列，我们会收到 FK 约束错误，我们可以使用下面记下的步骤来避免它。**

 **```
CREATE TABLE inventory_source (
inventory_source_id int(11) NOT NULL AUTO_INCREMENT,
display_name varchar(40) NOT NULL,
state_id int(11) NOT NULL,
PRIMARY KEY (inventory_source_id),
KEY state_id (state_id),
CONSTRAINT ba_inventory_source_state_fk FOREIGN KEY (state_id) REFERENCES   ba_state (state_id)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8;

CREATE TABLE contract_lines(
contract_line_id int(11) NOT NULL AUTO_INCREMENT,
inventory_source_id int(11) NULL ,
PRIMARY KEY (contract_line_id),
UNIQUE KEY contract_line_id (contract_line_id),
KEY AI_contract_line_id (contract_line_id),
KEY contract_lines_inventory_source_fk (inventory_source_id),
CONSTRAINT contract_lines_inventory_source_fk FOREIGN KEY       (inventory_source_id) REFERENCES ba_inventory_source (inventory_source_id)
) ENGINE=InnoDB AUTO_INCREMENT=135 DEFAULT CHARSET=utf8 ; 
```

我们可以通过以下步骤克服它：-

1.  从inventory_source 中删除或更新行将自动删除或更新contract_lines 表中的匹配行，这称为级联删除或更新。
2.  另一种方法是在inventory_source 表中删除对应的记录时，将contract_lines 表中的列即inventory_source_id 设置为NULL。
3.  我们可以限制父表的删除或更新，换句话说，可以拒绝对inventory_source 表的删除或更新操作。
4.  如果引用的表中存在相关的外键值，则不允许尝试删除或更新主键值。

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2019-08-08T11:59:57.887

Wowowo...
到处都有答案。其实这是我遇到过的最复杂的话题。我在需要时使用 FK，但在生产环境中我很少使用它们。

以下是我很少使用 FKS 的原因：

1\. 大多数时候我在小型服务器上处理大量数据以提高性能，我需要删除 FK。因为当您有 FK 并且您创建、更新或删除 RDBMS 时，首先检查是否没有违反约束以及是否有可能是致命的巨大数据库

2\. 有时我需要从其他地方导入数据，因为我不是太确定它们的结构有多好，我只是放弃了 FK。

3\. 如果您正在处理多个 DB 并且在另一个 DB 中具有引用键将不会顺利（目前），直到您删除 FK（跨数据库关系）
4\. 当您编写一个应用程序时也是如此将坐在任何 RDBMS 上，或者您希望您的数据库在任何 RDBMS 系统中导出和导入，在这种情况下，每个特定的 RDBMS 系统都有自己处理 FK 的方式，您可能不得不放弃使用 FK。

5\. 如果您使用 RDBMS 平台 (ORM)，您知道其中一些根据他们提供的解决方案和技术性提供自己的映射，并且您不关心创建表及其 FK。

6\. 在最后一点之前，将是处理具有 FK 的 DB 的知识以及编写无需 FK 7 即可完成所有工作的应用程序的知识。最后，正如我开始所说的，这一切都取决于您的场景，以防万一知识不是障碍。您将始终希望尽最大努力做到最好！

谢谢大家！

* * *

## 回答 #37

> 赞同：-1
> 
> 时间：2008-09-17T13:29:58.413

I always thought it was lazy not to use them. I was taught it should always be done. But then, I didnt listen to Joel's discussion. He may have had a good reason, I don't know.

* * *

## 回答 #38

> 赞同：-9
> 
> 时间：2008-09-17T13:32:11.183

I can see a few reasons to use foreign keys (Orphaned rows, as someone mentioned, are annoying) but I never use them either. With a relatively sane DB schema, I don't think they are 100% needed. Constraints are good, but enforcing them via software is a better method, I think.

Alex

# c# - 在 .Net 中阅读 PDF 文档

> ID：83152
> 
> 赞同：98
> 
> 时间：2008-09-17T13:26:10.747
> 
> 标签：c#, .net, pdf

是否有一个开源库可以帮助我阅读/解析 .NET/C# 中的 PDF 文档？

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2011-11-02T18:30:50.307

自从这个问题最后一次回答是在 2008 年以来，iTextSharp 已经显着改进了他们的 api。如果您从[http://sourceforge.net/projects/itextsharp/](http://sourceforge.net/projects/itextsharp/)下载他们最新版本的 api ，您可以使用以下代码片段将所有文本从 pdf 提取到字符串中。

```
using iTextSharp.text.pdf;
using iTextSharp.text.pdf.parser;

namespace PdfParser
{
    public static class PdfTextExtractor
    {
        public static string pdfText(string path)
        {
            PdfReader reader = new PdfReader(path);
            string text = string.Empty;
            for(int page = 1; page <= reader.NumberOfPages; page++)
            {
                text += PdfTextExtractor.GetTextFromPage(reader,page);
            }
            reader.Close();
            return text;
        }   
    }
} 
```

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2008-09-17T15:23:05.380

**[iTextSharp](https://github.com/itext/itextsharp)**是最好的选择。用它为 lucene.Net 制作了一个蜘蛛，以便它可以抓取 PDF。

```
using System;
using System.IO;
using iTextSharp.text.pdf;
using System.Text.RegularExpressions;

namespace Spider.Utils
{
    /// <summary>
    /// Parses a PDF file and extracts the text from it.
    /// </summary>
    public class PDFParser
    {
        /// BT = Beginning of a text object operator 
        /// ET = End of a text object operator
        /// Td move to the start of next line
        ///  5 Ts = superscript
        /// -5 Ts = subscript

        #region Fields

        #region _numberOfCharsToKeep
        /// <summary>
        /// The number of characters to keep, when extracting text.
        /// </summary>
        private static int _numberOfCharsToKeep = 15;
        #endregion

        #endregion

        #region ExtractText
        /// <summary>
        /// Extracts a text from a PDF file.
        /// </summary>
        /// <param name="inFileName">the full path to the pdf file.</param>
        /// <param name="outFileName">the output file name.</param>
        /// <returns>the extracted text</returns>
        public bool ExtractText(string inFileName, string outFileName)
        {
            StreamWriter outFile = null;
            try
            {
                // Create a reader for the given PDF file
                PdfReader reader = new PdfReader(inFileName);
                //outFile = File.CreateText(outFileName);
                outFile = new StreamWriter(outFileName, false, System.Text.Encoding.UTF8);

                Console.Write("Processing: ");

                int totalLen = 68;
                float charUnit = ((float)totalLen) / (float)reader.NumberOfPages;
                int totalWritten = 0;
                float curUnit = 0;

                for (int page = 1; page <= reader.NumberOfPages; page++)
                {
                    outFile.Write(ExtractTextFromPDFBytes(reader.GetPageContent(page)) + " ");

                    // Write the progress.
                    if (charUnit >= 1.0f)
                    {
                        for (int i = 0; i < (int)charUnit; i++)
                        {
                            Console.Write("#");
                            totalWritten++;
                        }
                    }
                    else
                    {
                        curUnit += charUnit;
                        if (curUnit >= 1.0f)
                        {
                            for (int i = 0; i < (int)curUnit; i++)
                            {
                                Console.Write("#");
                                totalWritten++;
                            }
                            curUnit = 0;
                        }

                    }
                }

                if (totalWritten < totalLen)
                {
                    for (int i = 0; i < (totalLen - totalWritten); i++)
                    {
                        Console.Write("#");
                    }
                }
                return true;
            }
            catch
            {
                return false;
            }
            finally
            {
                if (outFile != null) outFile.Close();
            }
        }
        #endregion

        #region ExtractTextFromPDFBytes
        /// <summary>
        /// This method processes an uncompressed Adobe (text) object 
        /// and extracts text.
        /// </summary>
        /// <param name="input">uncompressed</param>
        /// <returns></returns>
        public string ExtractTextFromPDFBytes(byte[] input)
        {
            if (input == null || input.Length == 0) return "";

            try
            {
                string resultString = "";

                // Flag showing if we are we currently inside a text object
                bool inTextObject = false;

                // Flag showing if the next character is literal 
                // e.g. '\\' to get a '\' character or '\(' to get '('
                bool nextLiteral = false;

                // () Bracket nesting level. Text appears inside ()
                int bracketDepth = 0;

                // Keep previous chars to get extract numbers etc.:
                char[] previousCharacters = new char[_numberOfCharsToKeep];
                for (int j = 0; j < _numberOfCharsToKeep; j++) previousCharacters[j] = ' ';

                for (int i = 0; i < input.Length; i++)
                {
                    char c = (char)input[i];
                    if (input[i] == 213)
                        c = "'".ToCharArray()[0];

                    if (inTextObject)
                    {
                        // Position the text
                        if (bracketDepth == 0)
                        {
                            if (CheckToken(new string[] { "TD", "Td" }, previousCharacters))
                            {
                                resultString += "\n\r";
                            }
                            else
                            {
                                if (CheckToken(new string[] { "'", "T*", "\"" }, previousCharacters))
                                {
                                    resultString += "\n";
                                }
                                else
                                {
                                    if (CheckToken(new string[] { "Tj" }, previousCharacters))
                                    {
                                        resultString += " ";
                                    }
                                }
                            }
                        }

                        // End of a text object, also go to a new line.
                        if (bracketDepth == 0 &&
                            CheckToken(new string[] { "ET" }, previousCharacters))
                        {

                            inTextObject = false;
                            resultString += " ";
                        }
                        else
                        {
                            // Start outputting text
                            if ((c == '(') && (bracketDepth == 0) && (!nextLiteral))
                            {
                                bracketDepth = 1;
                            }
                            else
                            {
                                // Stop outputting text
                                if ((c == ')') && (bracketDepth == 1) && (!nextLiteral))
                                {
                                    bracketDepth = 0;
                                }
                                else
                                {
                                    // Just a normal text character:
                                    if (bracketDepth == 1)
                                    {
                                        // Only print out next character no matter what. 
                                        // Do not interpret.
                                        if (c == '\\' && !nextLiteral)
                                        {
                                            resultString += c.ToString();
                                            nextLiteral = true;
                                        }
                                        else
                                        {
                                            if (((c >= ' ') && (c <= '~')) ||
                                                ((c >= 128) && (c < 255)))
                                            {
                                                resultString += c.ToString();
                                            }

                                            nextLiteral = false;
                                        }
                                    }
                                }
                            }
                        }
                    }

                    // Store the recent characters for 
                    // when we have to go back for a checking
                    for (int j = 0; j < _numberOfCharsToKeep - 1; j++)
                    {
                        previousCharacters[j] = previousCharacters[j + 1];
                    }
                    previousCharacters[_numberOfCharsToKeep - 1] = c;

                    // Start of a text object
                    if (!inTextObject && CheckToken(new string[] { "BT" }, previousCharacters))
                    {
                        inTextObject = true;
                    }
                }

                return CleanupContent(resultString);
            }
            catch
            {
                return "";
            }
        }

        private string CleanupContent(string text)
        {
            string[] patterns = { @"\\\(", @"\\\)", @"\\226", @"\\222", @"\\223", @"\\224", @"\\340", @"\\342", @"\\344", @"\\300", @"\\302", @"\\304", @"\\351", @"\\350", @"\\352", @"\\353", @"\\311", @"\\310", @"\\312", @"\\313", @"\\362", @"\\364", @"\\366", @"\\322", @"\\324", @"\\326", @"\\354", @"\\356", @"\\357", @"\\314", @"\\316", @"\\317", @"\\347", @"\\307", @"\\371", @"\\373", @"\\374", @"\\331", @"\\333", @"\\334", @"\\256", @"\\231", @"\\253", @"\\273", @"\\251", @"\\221"};
            string[] replace = {   "(",     ")",      "-",     "'",      "\"",      "\"",    "à",      "â",      "ä",      "À",      "Â",      "Ä",      "é",      "è",      "ê",      "ë",      "É",      "È",      "Ê",      "Ë",      "ò",      "ô",      "ö",      "Ò",      "Ô",      "Ö",      "ì",      "î",      "ï",      "Ì",      "Î",      "Ï",      "ç",      "Ç",      "ù",      "û",      "ü",      "Ù",      "Û",      "Ü",      "®",      "™",      "«",      "»",      "©",      "'" };

            for (int i = 0; i < patterns.Length; i++)
            {
                string regExPattern = patterns[i];
                Regex regex = new Regex(regExPattern, RegexOptions.IgnoreCase);
                text = regex.Replace(text, replace[i]);
            }

            return text;
        }

        #endregion

        #region CheckToken
        /// <summary>
        /// Check if a certain 2 character token just came along (e.g. BT)
        /// </summary>
        /// <param name="tokens">the searched token</param>
        /// <param name="recent">the recent character array</param>
        /// <returns></returns>
        private bool CheckToken(string[] tokens, char[] recent)
        {
            foreach (string token in tokens)
            {
                if ((recent[_numberOfCharsToKeep - 3] == token[0]) &&
                    (recent[_numberOfCharsToKeep - 2] == token[1]) &&
                    ((recent[_numberOfCharsToKeep - 1] == ' ') ||
                    (recent[_numberOfCharsToKeep - 1] == 0x0d) ||
                    (recent[_numberOfCharsToKeep - 1] == 0x0a)) &&
                    ((recent[_numberOfCharsToKeep - 4] == ' ') ||
                    (recent[_numberOfCharsToKeep - 4] == 0x0d) ||
                    (recent[_numberOfCharsToKeep - 4] == 0x0a))
                    )
                {
                    return true;
                }
            }
            return false;
        }
        #endregion
    }
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-17T13:29:24.530

[PDFClown](http://sourceforge.net/projects/clown/)可能会有所帮助，但我不建议将它用于大型或大量使用的应用程序。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2011-02-15T11:23:43.700

```
public string ReadPdfFile(object Filename, DataTable ReadLibray)
{
    PdfReader reader2 = new PdfReader((string)Filename);
    string strText = string.Empty;

    for (int page = 1; page <= reader2.NumberOfPages; page++)
    {
    ITextExtractionStrategy its = new iTextSharp.text.pdf.parser.SimpleTextExtractionStrategy();
    PdfReader reader = new PdfReader((string)Filename);
    String s = PdfTextExtractor.GetTextFromPage(reader, page, its);

    s = Encoding.UTF8.GetString(ASCIIEncoding.Convert(Encoding.Default, Encoding.UTF8, Encoding.Default.GetBytes(s)));
    strText = strText + s;
    reader.Close();
    }
    return strText;
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-17T13:33:44.067

iText 是我所知道的最好的图书馆。最初是用 Java 编写的，还有一个 .NET 端口。

见[http://www.ujihara.jp/iTextdotNET/en/](http://www.ujihara.jp/iTextdotNET/en/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-08-30T02:09:34.083

文本？

[http://www.itextpdf.com/terms-of-use/index.php](http://www.itextpdf.com/terms-of-use/index.php)

指导

[http://www.vogella.com/articles/JavaPDF/article.html](http://www.vogella.com/articles/JavaPDF/article.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-17T13:27:36.373

你可以看看这个： http: [//www.codeproject.com/KB/showcase/pdfrasterizer.aspx](http://www.codeproject.com/KB/showcase/pdfrasterizer.aspx) 它不是完全免费的，但它看起来很不错。

亚历克斯

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-17T13:45:15.257

[http://www.c-sharpcorner.com/UploadFile/psingh/PDFFileGenerator12062005235236PM/PDFFileGenerator.aspx](http://www.c-sharpcorner.com/UploadFile/psingh/PDFFileGenerator12062005235236PM/PDFFileGenerator.aspx)是开源的，对您来说可能是一个很好的起点。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-17T15:27:13.747

[aspose pdf](http://www.aspose.com/)效果很好。再一次，你必须为此付出代价

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-17T13:31:18.470

还有LibHaru

[http://libharu.org/wiki/Main_Page](http://libharu.org/wiki/Main_Page)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-12-14T16:59:07.907

看看[Docotic.Pdf 库](https://bitmiracle.com/pdf-library/)。它不需要您打开应用程序的源代码（例如，具有病毒 AGPL 3 许可证的 iTextSharp）。

Docotic.Pdf 可用于阅读 PDF 文件并提取带或不带格式的文本。请查看展示[如何从 PDF 中提取文本](https://bitmiracle.com/blog/extract-text-from-pdf-in-net)的文章。

免责声明：我为图书馆供应商 Bit Miracle 工作。

# .net - 实体框架和应用架构（松耦合等）

> ID：83153
> 
> 赞同：2
> 
> 时间：2008-09-17T13:26:12.167
> 
> 标签：.net, entity-framework, architecture

我正在考虑在一个新项目中应用实体框架，因为我喜欢它的 OR/M-API 以及存储/概念模型映射功能（当然还有 Linq 和 Entity SQL）。

但是，如果 EF 实体在两者中都用作数据持有者，如何在 UI 层和业务层之间实现松散耦合。如果我在实体驻留在 UI 中时将实体附加到其 ObjectContext，则 UI 可能会绕过业务层并直接连接到数据库。如果我在将实体从它们的 ObjectContext 传递到 UI 之前将它们从它们的 ObjectContext 中分离出来，则不会有更改跟踪，因此我必须“重放”业务层中的所有更改，以便将它们持久化到数据库中（很难实现，尤其是亲子关系）。虽然我不希望业务层降级为“对象树持久性引擎”，但在某些情况下拥有这种能力会有所帮助。

这当然也适用于其他 OR-mapper，但一些替代产品似乎具有更好的分离/附加机制。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T13:40:11.577

“重播”更改比您想象的要容易。以下是您需要执行的操作的大致大纲：

1.  在分离实体实例并将其交给 UI 之前，存储实体实例的“原始”版本。
2.  让 UI 做它的事。
3.  当您想要将 UI 所做的更改持久保存到数据库时，请获取您存储的原始版本，并将其附加到 EntityContext。将 UI 返回的修改版本中的更改应用到此实例。现在保存更改。实体框架将处理三向合并。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-07T06:46:08.367

我不知道有任何 ORM 可以优雅地处理您希望具有平台独立性的 n 层解决方案。当一切都在 ObjectContext 中发生时，EF 工作得很好，当您有一个 n 层解决方案（物理分离、WCF/XML Web 服务调用）时，您必须做一些检查才能使对象正常运行。

您可以通过使用存储库模式分离出对 Ef 的 api 依赖项来实现松散耦合（[http://blog.keithpatton.com/2008/05/29/Polymorphic+Repository+For+ADONet+Entity+Framework.aspx](http://blog.keithpatton.com/2008/05/29/Polymorphic+Repository+For+ADONet+Entity+Framework.aspx)） . 但是，如果您直接在 UI 层中使用 EF 类，您将依赖于某些类型，例如 EntityReference、EntityKey 和 EntityObject，除非您决定深入研究让 EF 与纯 C# 类 (POCO) 一起工作的世界这对我来说似乎比它的价值更麻烦。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T02:20:38.067

ADO.Net 团队的 Daniel Simmons 提供了一种[扩展方法“AttachAsModified”](http://blogs.msdn.com/dsimmons/archive/2008/10/31/attachasmodified-a-small-step-toward-simplifying-ef-n-tier-patterns.aspx)来附加已修改的对象。

这不像重放更改那么聪明，但这使得它：我正在将它用于示例项目。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-09-17T13:38:52.633

谷歌“实体框架”和“不信任投票”，看看你得到了什么。

# file - 同一父目录中具有相同名称的文件和目录 - Solaris 8，ufs

> ID：83156
> 
> 赞同：4
> 
> 时间：2008-09-17T13:26:38.420
> 
> 标签：file, directory, filesystems, solaris

好的，我已经使用 Solaris 工作了 10 多年，但从未见过这个......

我有一个目录列表，其中包括同名的文件和子目录：

```
-rw-r--r--   1 root     other    15922214 Nov 29  2006 msheehan
drwxrwxrwx  12 msheehan sysadmin    2048 Mar 25 15:39 msheehan 
```

我使用文件来发现文件的内容，我得到：

```
bash-2.03# file msheehan
msheehan:       directory
bash-2.03# file msh*
msheehan:      ascii text
msheehan:       directory 
```

我不担心文件，但我想保留目录，所以我尝试rm：

```
bash-2.03# rm msheehan
rm: msheehan is a directory 
```

所以这是我的两部分问题：

1.  这是怎么回事？
2.  如何小心删除文件？

乔纳森

编辑：感谢大家的回答，（到目前为止）都很有帮助，但是将列表传递给编辑就可以了，ala：

```
bash-2.03# ls -l > jb.txt
bash-2.03# vi jb.txt 
```

其中包含：

```
-rw-r--r--   1 root     other    15922214 Nov 29  2006 msheehab^?n
drwxrwxrwx  12 msheehan sysadmin    2048 Mar 25 15:39 msheehan 
```

始终小心退格键！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-17T13:36:12.920

我猜这实际上是两个“看起来”相同的不同文件名，因为当 shell 传递名称的扩展版本时，命令文件能够区分它们。尝试将 ls 管道传输到 od 或另一个十六进制/八进制转储实用程序来查看它们是否真的具有相同的名称，或者是否涉及非打印字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T14:09:58.440

我想知道是什么原因造成的。除了文件系统错误之外，它可能是由以某种方式通过的非 ascii 字符引起的。在这种情况下，请使用另一种具有更简单字符串语义的语言来执行操作。

看看这个 ruby​​ 代码段的输出会很有趣：

```
ruby -e 'puts Dir["msheehan*"].inspect' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-17T18:40:30.030

您可以使用 iNode 删除

如果在“ls”中使用“-i”选项

```
$ ls -li
total 1
20801 -rw-r--r-- 1 root root 0 2010-11-08 01:55 a?
20802 -rw-r--r-- 1 root root 0 2010-11-08 01:55 a\?
$ find . -inum 20802 -exec rm {} \;
$ ls -li
total 1
20801 -rw-r--r-- 1 root root 0 2010-11-08 01:55 a? 
```

我有一个示例（西班牙语）如何在 Solaris [http://sparcki.blogspot.com/2010/03/como-eliminar-archivos-utilizando-su.html上使用 iNode 删除文件](http://sparcki.blogspot.com/2010/03/como-eliminar-archivos-utilizando-su.html)

乌尔科，

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T13:27:42.257

并快速回答我自己问题的第 2 部分......

我想我可以重命名目录，删除文件，然后将目录重命名回原来的位置。

...我仍然有兴趣看看其他人想出什么。

JB

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T13:32:46.953

我怀疑其中一个名字中有一个奇怪的字符。您可以尝试使用 shell 通配符扩展来查看：

```
cat msh* 
```

然后按通配符扩展键（在我的 shell 中是 Ctrl-X *）。您应该列出两个名称，其中一个可能包含转义字符。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T04:36:16.457

要查看文件中是否有特殊字符，请尝试 ls 的 -b 或 -q 选项，假设 solaris 8 具有这些选项。

作为删除文件的另一种解决方案，您可以打开图形文件浏览器（喘气！）并将不需要的文件拖放到垃圾箱中。

另一种解决方案可能是将一个文件移动到不同的名称（没有未知特殊字符的文件），然后使用通配符删除特殊字符目录名称。

```
mv msheehan temp
rm mshee*
mv temp msheehan 
```

当然，您要确保只有您要删除的文件与通配符匹配。而且，对于您的特定情况，由于一个是目录而另一个是文件，因此此命令可能已经解决了所有问题：

```
rmdir msheeha* 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-20T05:42:42.027

查看非打印字符和空格的一种快速简便的方法是通过*cat -vet*管道输出，例如：

```
# ls -l | 猫兽医

```

很好，很容易记住！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-12T23:14:06.670

对于第 2 部分，由于一个名称包含两个额外字符，您可以使用：

```
mv sheehan abc
mv sheeha??n xyz 
```

完成此操作后，您将再次获得合理的文件名，您可以根据需要进行修复。

# java - Which heap size do you prefer?

> ID：83157
> 
> 赞同：1
> 
> 时间：2008-09-17T13:27:00.573
> 
> 标签：java, memory, performance

I know there is no "right" heap size, but which heap size do you use in your applications (application type, jdk, os)?

The JVM Options `-Xms` (initial/minimum) and `-Xmx` (maximum) allow for controlling the heap size. What settings make sense under which circumstances? When are the defaults appropriate?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-17T13:41:06.670

您必须尝试您的应用程序并查看它的性能。例如，我以前总是开箱即用地运行 IDEA，直到我得到这份新工作，我在这个庞大的单体项目上工作。在编译整个项目时，IDEA 运行非常缓慢并且经常抛出内存错误。

我做的第一件事是将堆增加到 1 gig。这摆脱了内存不足的问题，但它仍然很慢。我还注意到 IDEA 经常冻结 10 秒左右，之后使用的内存被减半，然后再次增加，这引发了垃圾收集的想法。我现在将它与 -Xms512m、-Xmx768m 一起使用，但我还添加了 -Xincgc，以激活增量垃圾收集

结果，我的旧 IDEA 又回来了：它运行平稳，不再冻结，并且从不使用超过 600m 的堆。

对于您的应用程序，您必须使用类似的方法。尝试确定典型的内存使用情况并调整堆以使应用程序在这些条件下运行良好。但也让高级用户调整设置，以解决不寻常的数据负载。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T13:57:19.203

这取决于应用程序类型。桌面应用程序与 Web 应用程序有很大不同。应用程序服务器与独立应用程序有很大不同。

它还取决于您使用的 JVM。JDK5 和更高版本 6 包含有助于了解如何调整应用程序的增强功能。

堆大小很重要，但了解它如何与垃圾收集器一起使用也很重要。

[JDK1.4 垃圾收集器调优](http://java.sun.com/docs/hotspot/gc1.4.2/)

[JDK5 垃圾收集器调优](http://java.sun.com/docs/hotspot/gc5.0/gc_tuning_5.html)

[JDK6 垃圾收集器调优](http://java.sun.com/javase/technologies/hotspot/gc/gc_tuning_6.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T13:33:21.290

Actually I always considered it very strange that Java limits the heap size. A native application can usually use as much heap as it wants, until it runs out of virtual address space. The only reason to limit the heap in Java seems the garbage collector, which has a certain kind of "laziness" and may not garbage collect objects, unless there is a necessity to do so. That means if you choose the heap too big, your app constantly uses more memory than is really necessary.

However, Sun has improved the GC a lot over the years and to emulate the behavior of a native C app, I would set the initial heap size to 32 MB (for small programs) or 64 MB (for bigger ones) and the maximum to something between 1-2 GB. If your app really needs over a 1 GB of memory, it is most likely broken (unless you deal with data objects that large), but I see no reason why your app should be killed, just because it goes over a certain heap size.

Of course, this is referring to normal PCs. If you create Java code for mobile phones or other limited devices, you should probably adopt the initial and maximum heap size to the limitations of that device.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T13:29:50.673

Typically i try not to use heaps which are larger than 1GB. It will cost you on major garbage collections.

Sometime it is better to split your application to a few JVM on the same machine and not you large heap sizes.

Major collection with a large heap size can take >10 mintues (on unoptimized GC applications).

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T13:33:48.810

This is entirely dependent on your application and any hardware limitations you may have. There is no one size fits all.

jmap can be used to have a look at what heap you are actually using and is a good starting point for right-sizing the heap.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-17T14:18:00.683

您需要在 JConsole 或 visualvm 中花费相当长的时间才能清楚地了解高原内存使用情况。等到一切都稳定了，你就会看到堆内存使用的特征锯齿曲线。峰值应该是您的 70-80% 堆，具体取决于您使用的垃圾收集器。

当堆使用量达到一定百分比时，大多数垃圾收集器都会触发完整的 GC。这个百分比是最大堆的 60% 到 80%，具体取决于所涉及的策略。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-10-02T10:12:23.830

1.3Gb 用于重型 GUI 应用程序。

不幸的是，在 Linux 上，JVM 似乎在这种情况下预先请求了 1.3G 的虚拟内存，即使不需要，这看起来也很糟糕（并且会引起用户的很多困惑的抱怨）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-10-02T10:18:39.327

在我最占用内存的应用程序上：

```
-Xms250M -Xmx1500M -XX:+UnlockExperimentalVMOptions -XX:+UseG1GC 
```

# java - 如何将 XmlCursor 内容插入 DOM 文档

> ID：83159
> 
> 赞同：2
> 
> 时间：2008-09-17T13:27:04.817
> 
> 标签：java, xml, xmlbeans

一些 API 返回指向 XML 文档根目录的 XmlCursor。我需要将所有这些插入到另一个 org.w3c.DOM 表示的文档中。

开始时：XmlCursor 指向

 ``<a> <b> some text </b> </a>`

DOM 文档：

 ``<foo>` 

`</foo>`

最后，我希望原始 DOM 文档更改如下：

 ``<foo>

  <someOtherInsertedElement>

    <a> <b> some text </b> </a>

  </someOtherInsertedElement>` 

`</foo>`

注意：`document.importNode(cursor.getDomNode())`不起作用 - 抛出异常：*NOT_SUPPORTED_ERR：实现不支持请求的对象或操作类型。*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-17T13:34:37.090

尝试这样的事情：

```
Node originalNode = cursor.getDomNode();
Node importNode = document.importNode(originalNode.getFirstChild());
Node otherNode = document.createElement("someOtherInsertedElement");
otherNode.appendChild(importNode);
document.appendChild(otherNode); 
```

换句话说：

1.  从光标处获取 DOM 节点。在本例中，它是一个 DOMDocument，因此执行 getFirstChild() 来获取根节点。
2.  将其导入 DOMDocument。
3.  用 DOMDocument 做其他事情。
4.  将导入的节点附加到正确的节点。

导入的原因是节点总是“属于”给定的 DOMDocument。仅添加原始节点会导致异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-02T16:38:11.530

我遇到了同样的问题。

这是失败的：

`Node importNode = document.importNode(originalNode);`

这解决了问题：

`Node importNode = document.importNode(originalNode.getFirstChild());`

# video - 从 IP 网络摄像头嵌入实时视频

> ID：83172
> 
> 赞同：1
> 
> 时间：2008-09-17T13:27:59.120
> 
> 标签：video, streaming, webcam, sony

我们正在使用 Sony SNC-RZ30N 基于 IP 的网络摄像头来监控鱼鹰巢穴，并希望通过我们自己的网络服务器流式传输视频。

与其使用摄像机的内置网络服务器（客户端需要 ActiveX 或 Java）来显示实时提要，我想只淘汰实时提要并将其显示在我们的校园网络服务器（Win2k8/IIS7 ）。也许在 iFrame 等中。

不幸的是，除了 FTP 从这台相机获取静态图像快照之外的任何文档似乎几乎不存在。

还有其他“视频监控”软件包（即：ProSight SMB）将在他们自己的内置网络服务器上提供带有实时提要的网页（以及用于定位摄像机的控件，我们不希望显示） -但这是不可取的。

我只是想从摄像头捕获实时流并将其嵌入我们网站的页面，以便我们可以控制页面的外观以及其他相关超链接。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T13:49:10.940

*我没有足够的声誉来发表评论，所以一个新的答案......*

在这种情况下，我认为只有两个选择：运行将现有视频源转换为更可用的源（例如 wmv，被大多数客户接受）的服务，或创建某种“小程序”（如在 Flash 中） ) 每秒钟左右更新一次图像？

WebcamXP 似乎支持您的相机 ( [http://www.webcamxp.com/ipcams.aspx](http://www.webcamxp.com/ipcams.aspx) )，所以也许这是一个选项？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T13:31:16.083

一些基于 IP 的网络摄像头（我知道 Axis 摄像头可以），还通过 HTTP 提供静态 JPG 或动态 JPEG。喜欢`http://<ip>/img/static.jpg`。

也许这对你有帮助？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T02:01:19.357

您可以使用 cam 的内置 FTP 功能，将图片上传到您的网络服务器，并编写一些简单的 php 代码来读取上传的图像，将其显示在 HTML 页面上，并将其更新为等于输出帧速率相机。大多数相机输出为图片格式而不是视频。

# javascript - 如何设置浏览器滚动条来滚动页面的一部分？

> ID：83225
> 
> 赞同：6
> 
> 时间：2008-09-17T13:32:48.733
> 
> 标签：javascript, html, css

我已经在一些网站上看到过这种做法，例如[artofadambetts.com](http://www.artofadambetts.com/weblog/?p=169)。页面上的滚动条只滚动页面的一个元素，而不是整个页面。我查看了源代码，但还没有弄清楚。这是怎么做到的？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-17T13:35:06.560

这很漂亮。他在大多数 div 上都使用了“position:fixed”，而滚动的就是没有它的那个。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-17T13:38:07.083

事实上，“做这项工作”的不是滚动部分，而是页面的固定部分。

为此，您应该使用 CSS 并向您不希望滚动的元素添加`position: fixed;`属性（与`top`、`bottom`和`left`/或属性一起使用）。`right`

而且你不应该忘记给他们一个更大的`z-index`，如果你不这样做，可能有一些滚动元素可以在你滚动时越过你的固定元素（你当然不希望这样）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T13:40:48.823

要了解人们如何在 CSS 和/或 Javascript 中做这些事情，Firebug 工具非常出色：

[Firefox 的 Firebug 插件](https://addons.mozilla.org/en-US/firefox/addon/1843)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T13:42:39.020

应该注意的是，如果没有[进一步的黑客攻击](http://www.howtocreate.co.uk/fixedPosition.html)，IE6 的定位将无法正常工作，IE6 仍能保持 15-30% 的市场份额，具体取决于您的网站。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T13:46:25.657

您可以使用固定定位或绝对定位将各种元素绑定到页面上的固定位置。或者，您可以指定一个固定大小的元素（例如 DIV）并使用它`overflow: scroll`来强制滚动条。

如前所述，让一切在 Internet Explorer 和 Firefox/Opera/Safari 中运行需要明智地使用 hack。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T13:35:01.253

对于 div，您可以在 cSS 中添加

```
overflow: auto 
```

例如，

```
<div style="overflow:auto; height: 500px">一些很长的文字</div>

```

编辑：查看您发布的网站后，您可能不想要这个。他在他的网站中所做的是将布局设置为固定（位置：固定）并为其分配比文本更高的 z-index，即较低的 z-index。

例如：

```
<div class="highz"> //在这里放随机的东西。会修复的</div>
<div class="lowz"> 把你想滚动和定位的东西放在这里。</div>

```

带有 css 文件

```
div.highz {position: fixed; z-index: 2;}
div.lowz {position: fixed; z-index: 1;} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T13:35:48.680

这可以在 CSS 中使用“position:absolute;”来完成。条款

这是一个示例模板：

[http://www.demusdesign.com/bipolar/index.html](http://www.demusdesign.com/bipolar/index.html)

来自[http://www.demusdesign.com/](http://www.demusdesign.com/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T13:36:21.220

浏览器*正在*滚动页面，它只是它的那一部分是固定的。

这是通过在您不希望滚动的部分上使用“位置：固定”CSS 属性来完成的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T13:36:45.493

他们通过 CSS 将侧边和顶部元素设置为具有固定位置（参见他们的 style.css 文件的第 94 行）。这将它们保持在视口中，而其余部分滚动。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-11-29T07:00:55.373

试试这个滚动网页的特定部分......

```
 <html>
      <head>
      <title>Separately Scrolled Area Demo</title>
        </head>
          <body>
              <div style="width: 100px; border-style: solid">

            <div style="overflow: auto; width: 100px; height: 100px">
                        sumit..................
                        amit...................
                        mrinal.................
                        nitesh................
                        maneesh................
                        raghav...................
                        hitesh...................
                        deshpande................
                        sidarth....................
                        mayank.....................
                        santanu....................
                        sahil......................
                        malhan.....................
                        rajib.....................
                         </div>
                      </div>
                  </body>
      </html> 
```

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2008-09-17T13:34:41.100

要在 div 等元素上放置滚动条：

`<div style="overflow-x: auto; overflow-y: auto;>the content</div>`

如果你只想要一个水平或垂直滚动​​条，只使用你需要的overflow-x 和overflow-y 中的任何一个。

# c# - .NET 中是否有可序列化的通用键/值对类？

> ID：83232
> 
> 赞同：80
> 
> 时间：2008-09-17T13:33:24.240
> 
> 标签：c#, .net

我正在寻找可以包含在 Web 服务中的键/值对对象。

我尝试使用 .NET 的[`System.Collections.Generic.KeyValuePair<>`](http://msdn.microsoft.com/en-us/library/5tbh8a42.aspx)类，但它没有在 Web 服务中正确序列化。在 Web 服务中，Key 和 Value 属性没有被序列化，这使得这个类毫无用处，除非有人知道解决这个问题的方法。

是否有任何其他通用类可用于这种情况？

我会使用 .NET 的[`System.Web.UI.Pair`](http://msdn.microsoft.com/en-us/library/system.web.ui.pair.aspx)类，但它使用 Object 作为其类型。如果只是为了类型安全，使用 Generic 类会很好。

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2008-09-17T13:35:05.140

只需定义一个结构/类。

```
[Serializable]
public struct KeyValuePair<K,V>
{
  public K Key {get;set;}
  public V Value {get;set;}
} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-09-17T13:41:47.510

我不认为它`Dictionary<>`本身不是 XML 可序列化的，当我需要通过 Web 服务发送字典对象时，我最终自己包装了`Dictionary<>`对象并添加了对`IXMLSerializable`.

```
/// <summary>
/// Represents an XML serializable collection of keys and values.
/// </summary>
/// <typeparam name="TKey">The type of the keys in the dictionary.</typeparam>
/// <typeparam name="TValue">The type of the values in the dictionary.</typeparam>
[XmlRoot("dictionary")]
public class SerializableDictionary<TKey, TValue> : Dictionary<TKey, TValue>, IXmlSerializable
{
    #region Constants

    /// <summary>
    /// The default XML tag name for an item.
    /// </summary>
    private const string DEFAULT_ITEM_TAG = "Item";

    /// <summary>
    /// The default XML tag name for a key.
    /// </summary>
    private const string DEFAULT_KEY_TAG = "Key";

    /// <summary>
    /// The default XML tag name for a value.
    /// </summary>
    private const string DEFAULT_VALUE_TAG = "Value";

    #endregion

    #region Protected Properties

    /// <summary>
    /// Gets the XML tag name for an item.
    /// </summary>
    protected virtual string ItemTagName
    {
        get
        {
            return DEFAULT_ITEM_TAG;
        }
    }

    /// <summary>
    /// Gets the XML tag name for a key.
    /// </summary>
    protected virtual string KeyTagName
    {
        get
        {
            return DEFAULT_KEY_TAG;
        }
    }

    /// <summary>
    /// Gets the XML tag name for a value.
    /// </summary>
    protected virtual string ValueTagName
    {
        get
        {
            return DEFAULT_VALUE_TAG;
        }
    }

    #endregion

    #region Public Methods

    /// <summary>
    /// Gets the XML schema for the XML serialization.
    /// </summary>
    /// <returns>An XML schema for the serialized object.</returns>
    public XmlSchema GetSchema()
    {
        return null;
    }

    /// <summary>
    /// Deserializes the object from XML.
    /// </summary>
    /// <param name="reader">The XML representation of the object.</param>
    public void ReadXml(XmlReader reader)
    {
        XmlSerializer keySerializer = new XmlSerializer(typeof(TKey));
        XmlSerializer valueSerializer = new XmlSerializer(typeof(TValue));

        bool wasEmpty = reader.IsEmptyElement;

        reader.Read();

        if (wasEmpty)
        {
            return;
        }

        while (reader.NodeType != XmlNodeType.EndElement)
        {
            reader.ReadStartElement(ItemTagName);

            reader.ReadStartElement(KeyTagName);
            TKey key = (TKey)keySerializer.Deserialize(reader);
            reader.ReadEndElement();

            reader.ReadStartElement(ValueTagName);
            TValue value = (TValue)valueSerializer.Deserialize(reader);
            reader.ReadEndElement();

            this.Add(key, value);

            reader.ReadEndElement();
            reader.MoveToContent();
        }

        reader.ReadEndElement();
    }

    /// <summary>
    /// Serializes this instance to XML.
    /// </summary>
    /// <param name="writer">The writer to serialize to.</param>
    public void WriteXml(XmlWriter writer)
    {
        XmlSerializer keySerializer = new XmlSerializer(typeof(TKey));
        XmlSerializer valueSerializer = new XmlSerializer(typeof(TValue));

        foreach (TKey key in this.Keys)
        {
            writer.WriteStartElement(ItemTagName);

            writer.WriteStartElement(KeyTagName);
            keySerializer.Serialize(writer, key);
            writer.WriteEndElement();

            writer.WriteStartElement(ValueTagName);
            TValue value = this[key];
            valueSerializer.Serialize(writer, value);
            writer.WriteEndElement();

            writer.WriteEndElement();
        }
    }

    #endregion
} 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-01-20T03:03:16.800

[您将在此MSDN 博客文章](http://blogs.msdn.com/seshadripv/archive/2005/11/02/488273.aspx)中找到 KeyValuePairs 无法序列化的原因

Struct 答案是最简单的解决方案，但不是唯一的解决方案。“更好”的解决方案是编写一个可序列化的自定义 KeyValurPair 类。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-02-21T11:35:22.057

```
 [Serializable]
 public class SerializableKeyValuePair<TKey, TValue>
    {

        public SerializableKeyValuePair()
        {
        }

        public SerializableKeyValuePair(TKey key, TValue value)
        {
            Key = key;
            Value = value;
        }

        public TKey Key { get; set; }
        public TValue Value { get; set; }

    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-04T21:22:26.210

在 4.0 框架中，还添加了可序列化和可等价的 Tuple 系列类。您可以使用`Tuple.Create(a, b)`或`new Tuple<T1, T2>(a, b)`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T13:57:43.697

KeyedCollection 是一种字典，可以直接序列化为xml，没有任何废话。唯一的问题是您必须通过以下方式访问值： coll["key"].Value;

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-06-17T08:44:16.667

**XmlSerializer 不适用于字典。哦，KeyValuePairs 也有问题**

[http://www.codeproject.com/Tips/314447/XmlSerializer-doesnt-work-with-Dictionaries-Oh-and](http://www.codeproject.com/Tips/314447/XmlSerializer-doesnt-work-with-Dictionaries-Oh-and)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-04-23T11:10:02.687

使用 DataContractSerializer 因为它可以处理键值对。

```
 public static string GetXMLStringFromDataContract(object contractEntity)
    {
        using (System.IO.MemoryStream writer = new System.IO.MemoryStream())
        {
            var dataContractSerializer = new DataContractSerializer(contractEntity.GetType());
            dataContractSerializer.WriteObject(writer, contractEntity);
            writer.Position = 0;
            var streamReader = new System.IO.StreamReader(writer);
            return streamReader.ReadToEnd();
        }
    } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-05-09T21:42:02.140

`DataTable`是我最喜欢的（仅）包装要序列化为 JSON 的数据的集合，因为它很容易扩展而无需额外的`struct`& 就像一个可序列化的替代品`Tuple<>[]`

也许不是最干净的方式，但我更喜欢直接在类中包含和使用它（应序列化），而不是声明一个新的`struct`

```
class AnyClassToBeSerialized
{
    public DataTable KeyValuePairs { get; }

    public AnyClassToBeSerialized
    {
        KeyValuePairs = new DataTable();
        KeyValuePairs.Columns.Add("Key", typeof(string));
        KeyValuePairs.Columns.Add("Value", typeof(string));
    }

    public void AddEntry(string key, string value)
    {
        DataRow row = KeyValuePairs.NewRow();
        row["Key"] = key; // "Key" & "Value" used only for example
        row["Value"] = value;
        KeyValuePairs.Rows.Add(row);
    }
} 
```

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2011-11-04T11:49:11.873

您可以使用`Tuple<string,object>`

`Tuple`有关用法的更多详细信息，请参见此处： [Working with Tuple in C# 4.0](http://www.abhisheksur.com/2010/11/working-with-tuple-in-c-40.html)

# mysql - mysql转储 | mysql 产生“打开的文件太多”错误。为什么？

> ID：83242
> 
> 赞同：6
> 
> 时间：2008-09-17T13:33:55.547
> 
> 标签：mysql, mysqldump, rhel

我有一个 RHEL 5 系统和一个全新的硬盘驱动器，我专门用于 MySQL 服务器。为了开始，我使用了“mysqldump --host otherhost -A | mysql”，尽管我注意到手册页从未明确建议尝试此操作（mysqldump 到文件中是不行的。我们正在谈论 500G 的数据库）。

这个过程以随机的时间间隔失败，抱怨打开了太多文件（此时 mysqld 得到相关信号，然后死掉并重生）。

我尝试在 sysctl 和 ulimit 上提高它，但问题仍然存在。我该怎么办？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-17T13:45:56.127

默认情况下，mysqldump 对所有涉及的表执行逐表锁定。如果您有许多表可以超过 mysql 服务器进程的文件描述符数量。试试 --skip-lock-tables 或者如果锁定是必要的 --lock-all-tables。
[http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html](http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html)

> ```
> --锁定所有表，-x锁定所有数据库中的所有表。这是通过在整个转储期间获取全局读锁来实现的。此选项会自动关闭 --single-transaction 和 --lock-tables。
> ```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-17T13:46:11.587

据报道 mysqldump 会为较大的数据库（[1](http://bugs.mysql.com/bug.php?id=26026)、[2](http://bugs.mysql.com/bug.php?id=26114)、[3](http://bugs.mysql.com/bug.php?id=27763)）产生该错误。[MySQL Bugs](http://bugs.mysql.com/bug.php?id=26026)的解释和解决方法：

> [2007 年 2 月 3 日 22:00] Sergei Golubchik 这并不是真正的错误。
> 
> mysqldump 默认启用了 --lock-tables，这意味着它会在开始转储之前尝试锁定所有要转储的表。并且对非常多的表执行 LOCK TABLES t1, t2, ... 将不可避免地耗尽所有可用的文件描述符，因为 LOCK 需要打开所有表。
> 
> 解决方法： --skip-lock-tables 将完全禁用此类锁定。或者， --lock-all-tables 将使 mysqldump 使用 FLUSH TABLES WITH READ LOCK 锁定所有数据库中的所有表（不打开它们）。在这种情况下，mysqldump 将自动禁用 --lock-tables，因为使用 --lock-all-tables 时没有任何意义。

*编辑*：请在下面的评论中查看 Dave 针对 InnoDB 的解决方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T21:05:51.857

如果您的数据库那么大，那么您会遇到一些问题。

1.  您必须锁定表才能转储数据。

2.  mysqldump 将需要很长时间，在此期间您的表需要锁定。

3.  在新服务器上导入数据也需要很长时间。

由于您的数据库在 #1 和 #2 发生时将基本上无法使用，我实际上建议停止数据库并使用 rsync 将文件复制到另一台服务器。它比使用 mysqldump 快，也比导入快得多，因为您没有生成索引的额外 IO 和 CPU。

在 Linux 的生产环境中，许多人将 Mysql 数据放在 LVM 分区上。然后他们停止数据库，做一个 LVM 快照，启动数据库，并在闲暇时复制停止的数据库的状态。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-07-20T18:02:00.633

我刚刚重新启动了“MySql”服务器，然后我就可以`mysqldump`完美地使用该命令了。

认为这可能是有用的提示。

# .net - 如何在 .net 中获取数组的唯一值？

> ID：83260
> 
> 赞同：5
> 
> 时间：2008-09-17T13:34:46.763
> 
> 标签：.net, arrays, unique

假设我有这个数组： MyArray(0)="aaa" MyArray(1)="bbb" MyArray(2)="aaa"

是否有一个 .net 函数可以给我独特的价值？我想要这样的东西作为函数的输出：OutputArray(0)="aaa" OutputArray(1)="bbb"

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-17T13:40:04.270

一个解决方案可能是使用 LINQ，如下例所示：

```
int[] test = { 1, 2, 1, 3, 3, 4, 5 };
var res = (from t in test select t).Distinct<int>();
foreach (var i in res)
{
    Console.WriteLine(i);
} 
```

这将打印预期的：

```
1
2
3
4
5 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-17T13:45:14.507

假设您有 .Net 3.5/LINQ：

```
string[] OutputArray = MyArray.Distinct().ToArray(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T13:36:05.793

您可以使用字典将它们与键一起添加，并在添加它们时检查键是否已存在。

```
string[] myarray = new string[] { "aaa", "bbb", "aaa" };
            Dictionary mydict = new Dictionary();
            foreach (string s in myarray) {
                if (!mydict.ContainsKey(s)) mydict.Add(s, s);
            }
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T13:36:22.203

使用 .NET 3.5 中包含的 HashSet 类。

# open-source - Codeplex/Sourceforge 供内部使用

> ID：83269
> 
> 赞同：6
> 
> 时间：2008-09-17T13:35:31.800
> 
> 标签：open-source, project-management, version-control, codeplex

我正在寻找一个可以在我的工作场所内部部署的免费/开源协作项目经理，其行为类似于 Codeplex 或 Sourceforge。有没有人知道这样的事情，如果知道，你有没有经验。

**要求：**

*   开源*或*免费
*   本地可部署
*   具有与 Sourceforge / Codeplex 中相同类型的功能
    *   问题/特征跟踪
    *   社区互动（即投票、角色等）
    *   单片机集成*（可选）*
*   .NET/Windows 友好*（可选）*

每个企业最终都会拥有内部实用程序和开发人员创建的特定领域应用程序，以使生活更轻松。鉴于内部开发人员社区的投入，他们有可能变得更好（你能说[GMail](http://en.wikipedia.org/wiki/History_of_Gmail#Internal_development) ...），我只是想通过为这种交互提供一个简单的地方来在内部培养这样的环境。

**更新：**

所以我喜欢我在 Trac 和 GForge 中看到的东西，但两者都非常适合 UNIX/Subversion 环境。我应该指定这一点，但我们从上到下都是一家 MS 商店。您认为在 MS .NET 环境中尝试和使用这些功能有多实用？这就像试图将方形钉穿过圆孔一样吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-17T13:40:10.557

我喜欢 redmine：[http](http://www.redmine.org) ://www.redmine.org 。您的标准中唯一缺少的是投票，但甚至可能有一个插件。

Trac 也很受欢迎（[http://trac.edgewall.org](http://trac.edgewall.org)），但它缺乏对跨项目数据聚合的支持。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-17T13:38:13.290

试试[GForge](http://gforge.org/)，它是 SourceForge 的一个分支，并具有它的大部分功能。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T14:47:48.037

我同意，Trac 应该可以工作。恕我直言，在 Windows 上设置 Subversion 也应该相对容易，它有很棒的 Windows 客户端（tortoiseSvn），而且 Trac 在 python 上运行，所以它也可以在 Windows 上运行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-09T12:33:32.797

Sourceforge Enterprise 的其他优点是这些插件。可以在[此处](http://desktop-vs.open.collab.net/)和[此处](http://www.collab.net/downloads/integrations/)找到 Visual Studio 的额外插件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T13:40:52.410

SourceForge Enterprise Edition 4.4 最多可供 15 位用户免费使用。我们将它用于我们的开发团队和我工作的另一个开发团队。

这对我们来说效果很好。它内置了颠覆和 cvs（无论您想使用哪个）。如果您打算通过 Internet 访问它，您可能需要启用 HTTPS。为了让 HTTPS 正常工作，我不得不做一些小动作（找到要安装的正确 CentOS 软件包）。如果您想将此解决方案与 HTTPS 一起使用，我不介意您向我发送消息寻求帮助。

它带有一个用于 VMWare Player 的 VM：http: [//www.collab.net/downloads/sfee/index4.4.html](http://www.collab.net/downloads/sfee/index4.4.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-18T02:06:40.413

[Launchpad](https://launchpad.net/launchpad-project)支持代码托管和版本控制、错误跟踪、蓝图、答案、投票、翻译等。

Launchpad 由 Ubuntu 项目使用。

几周前，Launchapad 作为开源发布。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-03-13T07:41:44.040

我只是想知道同样的事情，比如 Trac 但在 .NET 中，经过快速的 GOOGLE 搜索（我从未尝试过这些工具）我发现

sharpforge（这看起来不再免费！）

我喜欢网站 .netTiers 的外观。他们使用螺丝转维基。如果您满足所有 GPLv2 声明，它是完全免费的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T13:40:13.880

[Assembla](http://www.assembla.com/)和[BeanStalk](http://beanstalkapp.com/)都不错，都有类似的东西；wiki、讨论、警报、聊天、票务、Trac、Git 和 Subversion

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T13:56:34.417

[特拉克](http://trac.edgewall.org/)呢？这很简单，但它是很多开源项目的工作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-17T14:02:38.270

我同意[Trac](http://trac.edgewall.org)的建议。我将它用于开源项目和内部项目。它有不错的问题跟踪和与 Subversion 的集成，允许票证和 subversion 签入之间的链接。它还有一个集成的 wiki，可用于文档。虽然我们不将它用于投票/社区类型的功能，但我知道它有许多插件可以用于此目的。

# layout - 使用实现 3 列网站的最佳方法 标签？

> ID：83279
> 
> 赞同：21
> 
> 时间：2008-09-17T13:36:04.997
> 
> 标签：layout, html, css

我正在使用这样的布局开发一个 3 列的网站：

```
 <div id='left'   style='left:      0; width: 150px; '> ... </div>
    <div id='middle' style='left:  150px; right: 200px'  > ... </div>
    <div id='right'  style='right:     0; width: 200px; '> ... </div> 
```

但是，考虑到默认的 CSS 'position' 属性`<DIV>'s`是'static' `<DIV>'s`，正如预期的那样，我的显示在另一个下方。

所以我将 CSS 属性 'position' 设置为 'relative'，并将 'middle' 和 'right' 的 'top' 属性更改`<DIV>'s`为 -（减去）前面的高度`<DIV>`。它工作得很好，但是这种方法给我带来了两个问题：

1) 即使 Internet Explorer 7 正确显示了三列，它仍然保持垂直滚动条就好像它们`<DIV>'s`被定位在另一个之下一样，并且在内容结束后有很多空白区域。我想要那个。

2）这些元素的高度是可变的，所以我真的不知道为每个`<DIV>`'top'属性设置哪个值；我不想硬编码它。

所以我的问题是，实现这种布局的最佳（简单+优雅）方式是什么？我想避免绝对定位，我也想保持我的设计无表格。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-09-17T13:40:23.410

如果您还没有查看[A List Apart](http://www.alistapart.com/)，您应该查看，因为它包含一些优秀的网站设计教程和指南。

[这篇文章](http://alistapart.com/articles/holygrail)尤其应该可以帮助你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T10:07:49.957

试试BluePrint [CSS 。](http://blueprintcss.org/)它上手非常简单，但对于大多数应用程序来说足够强大。

易于理解的教程和示例。有一个排版库，可以直接开箱即用地产生不错的结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T07:49:35.693

到目前为止，我发现做 3 列（或任何其他数量的列以奇怪的方式在可用空间上拆分）的最简单方法是[YUI Grids](http://developer.yahoo.com/yui/grids/)。有一个[YUI Grids Builder](http://developer.yahoo.com/yui/grids/builder/)可以为您提供基本布局。下面将为您提供一个 750 像素宽的基本 3 列布局（拆分 1/3 1/3 1/3），左侧边栏为 160 像素。将其更改为其他宽度、侧边栏配置和列拆分非常容易。

```
1    <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" 
2    "http://www.w3.org/TR/html4/strict.dtd"> 
3   <html> 
4   <head> 
5      <title>YUI Base Page</title> 
6      <link rel="stylesheet" href="http://yui.yahooapis.com/2.5.1/build/reset-fonts-grids/reset-fonts-grids.css" type="text/css"> 
7   </head> 
8   <body> 
9   <div id="doc" class="yui-t1"> 
10     <div id="hd"><h1>YUI: CSS Grid Builder</h1></div> 
11     <div id="bd"> 
12      <div id="yui-main"> 
13      <div class="yui-b">    <div class="yui-gb"> 
14          <div class="yui-u first"> 
15      <!-- YOUR DATA GOES HERE --> 
16              </div> 
17          <div class="yui-u"> 
18      <!-- YOUR DATA GOES HERE --> 
19              </div> 
20          <div class="yui-u"> 
21      <!-- YOUR DATA GOES HERE --> 
22              </div> 
23      </div> 
24  </div> 
25      </div> 
26      <div class="yui-b"><!-- YOUR NAVIGATION GOES HERE --></div> 
27       
28      </div> 
29     <div id="ft">Footer is here.</div> 
30  </div> 
31  </body> 
32  </html> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T12:56:20.060

有许多示例和库可供您搜索——其中已经列出了一些（A List Apart 是必读的）。

我在最近的几个网站上使用了[Yahoo 用户界面库 (YUI)](http://developer.yahoo.com/yui/)，并且非常喜欢它。雅虎完全支持它，而且它易于理解和使用。这里有[用于 Grids 的 CSS](http://developer.yahoo.com/yui/grids/)，它允许您将页面格式化为任意数量的列和部分。

YUI 很好，因为您不必为网站的基础重新发明轮子，而且他们会做所有工作来确保他们的基础在所有浏览器上都能正常工作。最重要的是，它是免费的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-19T10:19:28.353

我喜欢[960 网格系统](http://960.gs/)。这是一个轻量级、易于使用的 css，它将屏幕分成 12（或 16）列。您可以将其用于 3 列设计，并相应地对齐其余内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T13:37:13.980

尝试将 div 浮动到左侧，这将使它们保持在同一行 - 假设有足够的间距。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-25T06:18:18.890

对于固定列，只需设置 height:xxxpx 将使它们相等。

使用此[3 列布局生成器](http://www.pagecolumn.com/3_column_div_generator.htm)进行尝试。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-02-13T20:48:47.430

这段代码在我的电脑上运行 IE 8、Chrome、Firefox。

```
<!DOCTYPE HTML PUBLIC"-//W3C//DTD HTML 4.01//EN">
<html>
    <head>
        <title> Test </title>
    </head>
    <body>
        <div id="grad2" style="width:15%; height:100%; position:fixed; top:0px; left:0px; background-color:rgb(147,81,73);">
        <a href="http://abv.bg"> Column1 </a> </div>
        <div id="grad4" style="width:70%; height:100%; position:fixed; top:0px; left:15%; background-color:rgb(0,0,0);">
        <font color="#FFFFFF">Column 2 </font> </div>
        <div id="grad3" style="width:100%; height:100%; position:fixed; top:0px; left:85%; background-color:rgb(60,255,4);">
        <a href="http://abv.bg"> Column 3 </a> </div>
    </body>
</html> 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-09-17T13:38:27.190

首先，相对定位做了你所描述的：它在原始位置保留空间，但显示 DIV 偏移量。

如果您浮动 DIV，那么它们将从左到右堆叠，但这可能会导致问题。

使用 CSS 的三列布局非常困难。看看 [ [http://www.glish.com/css/7.asp]](http://www.glish.com/css/7.asp])

# sql-server - 在什么情况下，您会让不同的用户在 SQL Server 的表中看到不同的行？

> ID：83295
> 
> 赞同：1
> 
> 时间：2008-09-17T13:37:36.273
> 
> 标签：sql-server, sql-server-2000

SQL 服务器版本 2000。

我们有一堆桌面与 MSSQL Server 对话。在查找特定记录时，一些桌面会返回正确的数据，但有些则不会。

SQL 命令是“SELECT * FROM PODORDH WHERE ([NO]=6141)” 在一个或两个桌面上，这会返回一条记录。在服务器和所有其他桌面上，不返回任何记录。

我需要查看哪些区域？什么会导致这种情况发生？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T13:45:34.973

此错误可能来自在事务中删除/插入该记录但尚未提交所述事务的用户。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T13:42:58.270

检查您在每台机器上连接的数据库和服务器 - 查询很简单，除非您连接到不同的数据库或服务器，否则您必须在任何地方得到相同的答案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T13:48:38.773

如果只是一个工作站返回该行，那么听起来该工作站有一个尚未提交的打开事务。

否则，不同工作站的隔离级别是否可能不同，即。有些人会看到未提交的数据而其他人不会？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-17T13:50:18.567

如果您以与每台计算机不同的用户身份连接到服务器，您可能需要查看您从中选择的表的权限。

如果某些用户而不是其他用户有权读取该表，您可能会得到您描述的结果。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T16:29:30.710

After you exhaust all the options mentioned above, I would look into row and table locks. If this is the case it should return an error saying it encountered a lock. Are you running an application that could be swallowing errors?

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T13:57:25.990

也许一两个查找记录的用户使用不同的模式名称，因此使用不同的表。IE 大多数用户都在使用 dbo.PODORDH，但有一两个用户在使用 otheruser.PODORDH。

# svn - Microsoft Office 中的 SVN 修订

> ID：83296
> 
> 赞同：5
> 
> 时间：2008-09-17T13:37:38.440
> 
> 标签：svn, ms-office

我在 MS Powerpoint 2003 中有一些代码文档，我在 SVN 存储库中进行修订控制。每当我打开它时，我想将最新的修订号自动插入到该文档中。我正在使用 TortoiseSVN。我已经能够在谷歌上搜索一两个可能有效但需要专家建议的宏。：） 谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T15:50:15.907

如果您喜欢对二进制文件（例如**.doc ）使用“*****关键字扩展***”，则必须使用以下格式：

 ****$keyword::______________________$** （下划线 = 空格）

**::**确保字符数始终相同，否则您将损坏二进制 word 文件。

但这仅在**Word 2003**之前有效。

这不适用于**Word 2007**，因为 .docx 文件是包含 word 数据（例如 xml）的 ZIP 文件。但是将某些内容直接嵌入到 ZIP 内容中是没有意义的。

也许将来会有一个**SVN 的贡献**，它也可以用于**.docx**文件；-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T13:52:34.473

我相信 SVN 不会触及二进制文件，如果您在其中嵌入 $REV$ 字符串，可能会出现问题。

我也对“Office Macros”一无所知，但它可能会更好

1.  有一个带有该修订字符串的文本文件。
2.  *在保存之前*，让office 宏将以前的修订字符串（为了安全起见，没有 $REV$）复制到 office 文件中。
3.  每次保存文件时，都有相同的 office 宏将随机垃圾注入文本文件 #1。

IMO 最好将 rev 字符串写入 /save/ 上的文档，因为这将消除仅仅为了将修订字符串放入文件中而进行额外提交的需要，并且它还将减少对该修订文件的依赖事件您在没有上述文本文件的情况下分享此 PPT。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T13:41:46.073

我认为应该可以将其中的 $Rev$ 宏与 Office 2007 XML 格式一起使用，但我不太确定可能包含二进制数据的旧格式会发生什么。您可能需要稍微调整 svn 设置，以便将 .ppt 文件视为文本而不是二进制文件才能正常工作，我不确定默认行为是什么。请参阅 svn:mime-type ：[http ://svnbook.red-bean.com/en/1.2/svn.advanced.props.html](http://svnbook.red-bean.com/en/1.2/svn.advanced.props.html)

阅读此内容以获取有关 $Rev$ 更换的详细信息：http: [//svnbook.red-bean.com/en/1.4/svn.advanced.props.special.keywords.html](http://svnbook.red-bean.com/en/1.4/svn.advanced.props.special.keywords.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-03T19:36:31.980

有点晚了，但我认为原来的问题在今天仍然有意义。

你试过[SvnProperties4MSOffice](https://insights.oetiker.ch/windows/SvnProperties4MSOffice/)吗？第二个版本 (V2) 似乎被设计为 MS Office 2007 及更高版本的关键字替换的替代方案。它在后台使用 TortoiseSVN：SubWCRev 工具（与 TortoiseSVN 一起打包）通过它的 COM 接口通过 VB 宏进行访问。
我知道“宏”这个词本身就很吓人，但请稍等：这个是开源的，非常简单。这使得它易于编辑，因此可维护。

如果您有兴趣进一步了解“MS Office 和 SVN”主题，我邀请您[阅读我的一篇博文](https://gotomation.info/2019/01/svn-version-control-office-documents/ "博文：MS Office 文档的 SVN 版本控制")。您将有机会：

*   在 MS Word、MS Excel 和 MS PowerPoint 中安装 SVN 菜单
*   区分两个 MS Office 文档

*免责声明：我是博客的所有者。*

# java - 在 Java 应用程序中使用 C 源代码的最简单方法是什么？

> ID：83299
> 
> 赞同：9
> 
> 时间：2008-09-17T13:38:09.967
> 
> 标签：java, c, translation

我找到了我想在我的 Java 应用程序中使用的这个开源库。该库是用 C 编写的，是在 Unix/Linux 下开发的，我的应用程序将在 Windows 上运行。它是一个主要包含数学函数的库，据我所知，它不使用任何依赖于平台的东西，它只是非常基本的 C 代码。而且，它并没有那么大，不到 5,000 行。

在我的应用程序中使用该库的最简单方法是什么？我知道有 JNI，但这涉及到找到一个编译器来在 Windows 下编译库、更新 JNI 框架、编写代码等。可行，但并不那么容易。有没有更简单的方法？考虑到库的小尺寸，我很想将它翻译成 Java。有什么工具可以帮助解决这个问题吗？

**编辑**

我最终将我需要的库部分翻译成 Java。到目前为止，它大约占图书馆的 10%，尽管它可能会随着时间的推移而增加。C 和 Java 非常相似，所以只花了几个小时。主要困难是修复因翻译错误而引入的错误。

感谢大家的帮助。提议的解决方案似乎都很有趣，当我需要链接到更大的库时，我会研究它们。对于一小段 C 代码，手动翻译是最简单的解决方案。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-17T13:43:54.713

在[Java GNU Scientific Library](http://sf.net/projects/jgsl)项目中，我使用[Swig](http://www.swig.org/)围绕 C 库生成 JNI 包装类。很棒的工具，还可以生成包括 Python 在内的多种语言的包装器代码。强烈推荐。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-17T13:42:52.233

您最好的选择可能是拿起一本好的 c 书（K&R：C 编程语言）喝杯茶，然后开始翻译！我会对信任翻译程序持怀疑态度，更多时候不是最好的翻译就是你自己！如果你做了这个，那么它就完成了，你不需要继续重新做。如果库是开源的，可能会有一些复杂性，您需要仔细检查许可证。要考虑的另一点是，翻译中总会存在一些风险和潜在错误，因此可能有必要考虑编写一些测试以确保翻译正确。

没有 JAVA 等效的数学函数吗？

正如您自己评论的那样，JNI 方式是可能的，至于 ac 编译器，您可能使用“Bloodshead Dev-c++”可能会工作，但对于大约 5000 行来说这是一个很大的努力。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-17T13:43:14.933

我会编译它并使用JNA。

JNA（Java Native Access）基本上是在运行时执行 JNI 在编译时所做的，并且不需要任何非 Java 代码（也不需要太多 Java）。

我不知道它在您的情况下的性能或可用性，但我会试一试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T16:54:13.757

你确定要使用 C 库，即使它很小？

一旦 64 位变得更加普遍，您还需要开始构建/部署 32 位和 64 位版本的库。并且根据 C 代码的样子，您可能需要也可能不需要更新代码以使其构建为 64 位。

如果 C 库很简单，将 C 库移植到纯 java 可能会更容易，而不必处理构建/部署 JNI 库、C 库和 java 代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T13:48:51.003

确实，JNA 看起来令人印象深刻，它比直接使用 JNI 需要更少的努力。但无论如何，您都会失去平台独立性，并且由于您可能只使用其中的一小部分，您可能会考虑翻译您实际需要的内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T13:54:14.703

嗯，有AMPC。它是适用于 Windows、MacOS X 和 Linux 的 C 编译器，可以将 C 代码编译成 Java 字节码（在 Java 虚拟机上运行的那种代码）。

[AMPC](http://www.axiomsol.com/ "C 到 Java 字节码编译器")

但是，它是商业的，每个许可证的成本为 199 美元。我怀疑这会给你带来回报；）我不知道有任何这样的免费编译器。

OTOH、Java 和 C 非常相似。您可能可以将 C 代码重构为 Java（可以将结构替换为具有公共实例变量的对象），并且通常可以将指针操作转换为其他内容（例如数组操作）。虽然我猜你不想经历 5,000 行代码，是吗？

使用 JNI 使代码依赖于平台，但是如果你说它是独立于平台的 C，那么你的 Java 代码没有理由依赖于平台。OTOH，根据这些计算的成本，使用 JNI 实际上可能会为您带来性能提升，因为在原始数字处理吞吐量方面，C 仍然可以在速度上击败 Java。但是 JNI 调用非常昂贵，因此如果计算只是一个非常简单、快速的计算，那么 JNI 调用本身可能会花费与执行的计算相同的时间（甚至更长），在这种情况下，使用 JNI 不会为您带来任何好处，但会减慢关闭您的应用程序并导致内存开销。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-09-17T13:46:39.167

您是否尝试过使用：

```
System.loadLibrary("mylibrary.dll"); 
```

不确定这是否适用于纯 C 库，但可能值得一试。:)

# .net - 你在Reflector上花了多少时间？（。网）

> ID：83313
> 
> 赞同：1
> 
> 时间：2008-09-17T13:39:19.577
> 
> 标签：.net, reflector

作为一名顾问，我会根据客户的要求使用许多不同的产品和 API，我们使用 X 和 Y。我认为这很有趣，我从中学到了很多东西。

在我看来，随着时间的推移，成为一名优秀开发人员的因素是理解和学习新事物的意愿。因此，当我使用 3rd 方产品时，我将始终尝试了解“幕后”发生的事情。

我在 Reflector 中花费了大约 10-15% 的时间来了解当我调用方法 X 时我到底在做什么。

你平均花费多少时间？这也可能适用于阅读（开放）源代码、文档等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T13:56:03.543

对我来说，这取决于。当我学习新的技术堆栈或 API 时，我通常会使用 Reflector，并且我对它的使用会增加。

例如，我最近开始使用 Commerce Server 2007 API。出于好奇，我发现关于 Profile System 的许多文档不完整或缺乏足够的细节。于是我爆出反射器，用它来检查Commerce Membership Provider的实现（更不用说原生asp.net sql members provider的实现了）。

检查代码帮助我更好地理解会员提供者如何以及为什么按照他们的方式工作，而不是仅仅依赖文档所说的内容。

然后，我能够继续并为商业服务器实现一个自定义成员资格提供程序，我相信它弥补了股票商业服务器成员资格提供程序的一些限制。当然，我的实现并不像通用和功能丰富的那样，因为我的目标是为我的公司建立商业用户配置文件的“标准”设置和配置。

所以当我最初使用商务服务器时，我大概有 20% 的时间花在了反射器上。现在我有了更好的理解，至少我很少用它来检查商业服务器。

其次，当我第一次开始使用 asp.net ajax 和 ajax Web 控制工具包时。该工具包是开源的。我最初在控制工具包代码中花费了相当多的时间，文档还可以，但是示例非常薄弱。划分源代码有助于我更好地理解如何充分利用其各种 Web 控件。它还帮助我更好、更深入地学习如何使用 asp.net ajax javascript 库。最初，我将大约 10% 的时间花在工具包的源代码上。

每天我会花多少时间使用反光板？没那么多，取决于项目以及所涉及的技术是熟悉的还是新的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-13T05:29:55.277

我以前有时会使用它，但现在它是一个付费软件，所以花费的时间对我来说肯定会减少，主要是因为我觉得 Reflector 应该保持免费。

[http://reflector.red-gate.com/download.aspx?TreatAsUpdate=1](http://reflector.red-gate.com/download.aspx?TreatAsUpdate=1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T13:46:59.870

由于我同时为 .net 和紧凑型 .net 框架进行开发，因此我有时会反编译完整的 .net 程序集以将现有功能“复制”到紧凑型框架中。

除此之外，我不会花太多时间反编译库。大多数情况下，只有当某些东西不起作用并且问题清楚地指向一个组件并且我不想在我真正舒尔之前打扰其他人时。

如果你想让我坚持一个数字，我会说我的 5% 的时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T13:47:54.453

我想说我只有不到 1% 的时间花在了 Reflector 上。我明白为什么它可能是一个很好的学习工具，但我并不经常需要知道幕后发生的事情，只要它按我预期的那样工作，我就会很高兴。不过，这是一个有趣的想法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T13:49:41.110

我使用reflektor 有点好玩，但现在我根本没有使用它。

由于我们获得了 c# 程序的所有源代码，因此不需要反编译任何东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T13:51:36.440

我想我可能在某个时候花了 5%-10% 的时间在 Reflector 上——当我第一次学习 .Net 时。这些天可能每月不到 1/2 小时。但后来我不使用很多 3rd 方库。

源代码/文档，很难说。（是的，就像开源代码 HAS 文档......）人们不得不将我的一般博客阅读的某些部分归因于这一点，但很难说百分之多少。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T13:54:07.653

也许2-3％？主要使用这个 DSM 插件： [http ://www.tom-carter.net](http://www.tom-carter.net)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T13:55:45.573

当您在 WindowsBase.dll 上使用 Reflector 时，P/Invoking 变得非常容易。查看用于 COM 互操作的 MS.Internal.Interop 命名空间，以及用于 Win32 互操作的 MS.Win32.NativeMethods 和 MS.Win32.UnsafeNativeMethods。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T14:28:19.037

我用它所有的时间。当您可以看到实际来源时，为什么还要查看可能存在缺陷的文档？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-17T13:58:01.357

如果我针对库写作，我有源代码我很少使用它，因为我有源代码。

如果我针对 .Net 库进行写作，我可能会花费 5% 的时间，只有在使用我不熟悉的东西并且 Google/MSDN/StackOverflow 让我失望时。

在使用 3rd 方库时，我可能会花费 20% 的时间使用 Reflector，因为它通常比提供的贫乏文档要好得多。在一个项目中，我可能花费了 50% 的时间使用 Reflector，因为对这个特定产品不利的文档/论坛/知识缺少我需要的东西或完全错误。

我发现当我不需要使用 Reflector 时我很高兴——它是一个很棒的工具，但使用通常意味着我遇到了一个不好玩的棘手问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-17T14:25:51.210

我大概有 1% 的时间花在 Reflector 上。这是一个非常漂亮的工具，但是因为我们在内部编写了这么多代码，所以不需要反编译任何 dll。

# wpf - WPF 3.5 WebBrowser 控件和 ZIndex

> ID：83319
> 
> 赞同：10
> 
> 时间：2008-09-17T13:40:14.987
> 
> 标签：wpf, browser, z-index

我试图弄清楚为什么控件不支持 ZIndex。

示例 1 - 效果很好

```
 <Canvas>
       <Rectangle Canvas.ZIndex="1" Height="400" Width="600" Fill="Yellow"/>
       <Rectangle Canvas.ZIndex="2" Height="100" Width="100" Fill="Red"/>
   </Canvas> 
```

示例 2 - 不起作用

```
 <Canvas>
       <WebBrowser Canvas.ZIndex="1" Height="400" Width="600" Source="http://www.stackoverflow.com"/>
       <Rectangle Canvas.ZIndex="2" Height="100" Width="100" Fill="Red"/>
  </Canvas> 
```

谢谢， - 埃德

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-09-17T13:41:55.763

不幸的是，这是因为 WebBrowser 控件是 Internet Explorer COM 控件的包装。这意味着它拥有自己的 HWND，并且不允许 WPF 在其上绘制任何内容。它与在 WPF 中托管任何其他 Win32 或 WinForms 控件具有相同的限制。

[MSDN](http://msdn.microsoft.com/en-us/library/ms742522.aspx)有更多关于 WPF/Win32 互操作的信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-11-17T14:21:30.113

您遇到了一个常见的 WPF 陷阱，通常称为“空域问题”。一个可能的解决方案是不使用 WebBrowser 控件，而是使用一些更疯狂的东西 - 即直接渲染到 WPF 的嵌入式 WebKit 浏览器。有两个包可以做到这一点；Awesomonium（商业）和 Berkelium（开源）。这两个都有一个 .NET 包装器。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-07T17:18:45.463

您可以 SetWindowRgn 通过隐藏重叠区域来伪造重叠区域，如下所示：

*   [比目鱼网](http://www.flounder.com/setwindowrgn.htm)
*   [微软](http://msdn.microsoft.com/en-us/library/aa930600.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T20:14:54.197

我解决了在我的 WPF 应用程序中托管第 3 方 WinForms 控件的类似问题。我创建了一个 WPF 控件，它在内存中呈现 WinForms 控件，然后将其绘制为位图。然后我在 OnRender 方法中使用 DrawImage 来绘制渲染的内容。最后，我将鼠标事件从我的控件路由到托管控件。对于 Web 浏览器，您还必须路由键盘事件。

我的案例相当简单——一个带有一些简单鼠标交互的图表。Web 浏览器控件可能还有其他我没有考虑到的问题。无论如何，我希望这会有所帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-04-03T19:02:49.007

我也遇到了这个问题。在我的情况下，我将图像从一个面板拖到 WebBrowser 中，但当然，一旦我的图像移动到浏览器中，它就被隐藏了。

目前正在研究以下解决方案：

1.  当图像拖动开始时，使用“RenderTargetBitmap”创建 WebBrowser 的位图
2.  使用与网络浏览器相同的宽度/位置将位图添加到画布
3.  webControl.Visibility = Visibility.Hidden。
4.  释放拖动后，移除位图并设置 webControl.Visibility = Visible。

这个解决方案非常适合我的情况，但也许它会给你一些想法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-11-12T17:53:41.613

我设法通过使用这个结构来解决这个问题，检查每个元素中的属性配置：

```
<Canvas ClipToBounds="False">
     <Popup AllowsTransparency="True" ClipToBounds="False" IsOpen="True">
         <Expander>
            <Grid x:Name="YourContent"/>
         </Expander>
     <Popup>
</Canvas> 
```

您只需要管理扩展器即可显示或隐藏您的内容，我将它用于菜单栏，我认为扩展器是可选的，具体取决于具体情况。

查看这张带有结果的图片，您甚至可以在 WebBrowser 的顶部甚至主窗口之外显示您的控件：

![在此处输入图像描述](https://i.stack.imgur.com/ZO53h.png)

# fonts - TrueType 字体和 Type-1 字体有什么区别？

> ID：83320
> 
> 赞同：18
> 
> 时间：2008-09-17T13:40:17.327
> 
> 标签：fonts, truetype

TrueType 字体和 Type-1 字体有什么区别？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-17T14:05:08.903

Postscript Type-1 规范由 Adob​​e 在 1985 年左右创建。Type-1 字体是基于矢量的。您可以在“ [Adobe Type 1\. Font Format.](https://www-cdf.fnal.gov/offline/PostScript/T1_SPEC.PDF) ”中找到规范。

TrueType 字体是几年前由 Apple 定义的，因此 True Type 和 PostScript 在 1990 年代是竞争对手。微软在 1990 年代初为原生 Windows 字体格式选择了 True Type（为了使用 PostScript，需要 Adob​​e Type manager 等附加工具）。

今天，微软正在淡出对 PostScript 字体的支持。尝试在 Vista 中使用一种作为 UI 字体。祝你好运 ;-）

作为 TrueType 的继承者，微软（我认为与 Adob​​e 一起）创建了 Open Type（大约 2000 年左右）格式，Adobe 将他们的整个字体库转换为新格式（您仍然可以将它们作为 Type-1 字体获取）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-29T00:18:41.437

一个非常关键的区别是 PostScript（和 PostScript 风格的 OpenType）支持[三次贝塞尔曲线](http://en.wikipedia.org/wiki/B%C3%A9zier_curve)，其中每个字形的每个弧线由四个控制点描述。TrueType（和 tt 风格的 OpenType）使用二次曲线，每条弧只有三个控制点。这提供了对曲线形状的较少控制。

另一个关键区别是它们执行提示的方式。由于 TrueType 最初是针对低分辨率屏幕渲染的，它的提示系统通过调整曲线以很好地适应像素格点来工作，使用相当复杂的字节码机制。PostScript 字体旨在用于更高分辨率的纸张打印，并使用指南在适当的位置将曲线捕捉到直角。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T13:59:45.563

Type-1 是较旧的格式，可以追溯到 Adob​​e 开创带有 PostScript 和矢量字体的 DTP 的时代。当时 Type 1 和 Type 3 是 PostScript 打印机能够理解的唯一格式，只有 Type 1 可以包含使字体看起来不错所需的提示，并且格式是商业机密。通过这种方式，Adobe 将其他字体铸造厂降级为使用 Type 3 格式的非提示字体。

TrueType 由 Microsoft 发明，目的是 (a) 打破 Adob​​e 对暗示字体格式的垄断，(b) 避免在 Windows 上使用与 Macintosh 和 PostScript 相关的格式。TrueType 在内部使用二次曲线而不是三次贝塞尔曲线，因此可以更快地在屏幕上以及在 Windows 系统上使用的更便宜的不支持 PostScript 的打印机上进行渲染。TrueType 还对 Unicode 和自 Type 1 创建以来发明的其他东西有更好的支持。现代 Mac 也支持 TrueType。

新格式 OpenType 结合了 TrueType 和 Type 1（矢量数据可以是二次或三次形式，因此您可以直接将其中一种旧格式转换为 OpenType）。OpenType 还支持花哨的自动连字和字形替换，这在英文文本中非常有用，对于使用阿拉伯文或印度文字的文本至关重要。

# unix - 如何从 Unix 上的文本文件中提取预定范围的行？

> ID：83329
> 
> 赞同：611
> 
> 时间：2008-09-17T13:40:59.947
> 
> 标签：unix, command-line, sed, text-processing

我有一个约 23000 行的 SQL 转储，其中包含几个数据库的数据。我需要提取该文件的某个部分（即单个数据库的数据）并将其放在一个新文件中。我知道我想要的数据的开始行号和结束行号。

有谁知道一个 Unix 命令（或一系列命令）从一个文件中提取所有行，比如 16224 和 16482 行，然后将它们重定向到一个新文件中？

* * *

## 回答 #1

> 赞同：889
> 
> 时间：2008-09-17T13:42:34.123

```
sed -n '16224,16482p;16483q' filename > newfile 
```

从[sed 手册](https://www.gnu.org/software/sed/manual/sed.html#Common-Commands)：

> **p** - 打印出模式空间（到标准输出）。此命令通常仅与 -n 命令行选项一起使用。
> 
> **n** - 如果未禁用自动打印，则打印模式空间，然后无论如何用下一行输入替换模式空间。如果没有更多输入，则 sed 退出，不再处理任何命令。
> 
> **q** - 退出`sed`而不处理任何更多的命令或输入。请注意，如果未使用 -n 选项禁用自动打印，则会打印当前模式空间。

[和](https://www.gnu.org/software/sed/manual/sed.html#Addresses)

> sed 脚本中的地址可以是以下任何一种形式：
> 
> **number** 指定行号将仅匹配输入中的该行。
> 
> 可以通过指定用逗号 (,) 分隔的两个地址来指定地址范围。地址范围匹配从第一个地址匹配的位置开始的行，并一直持续到第二个地址匹配（包括）。

* * *

## 回答 #2

> 赞同：216
> 
> 时间：2008-09-17T13:46:37.327

```
sed -n '16224,16482 p' orig-data-file > new-file 
```

其中 16224,16482 是起始行号和结束行号，包括。这是 1 索引的。 `-n`抑制将输入作为输出回显，这显然是您不想要的；数字表示执行以下命令的行范围；该命令`p`打印出相关行。

* * *

## 回答 #3

> 赞同：113
> 
> 时间：2008-09-17T13:46:05.440

使用头/尾非常简单：

```
head -16482 in.sql | tail -258 > out.sql 
```

使用 sed：

```
sed -n '16224,16482p' in.sql > out.sql 
```

使用 awk：

```
awk 'NR>=16224&&NR<=16482' in.sql > out.sql 
```

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2008-09-17T13:42:18.133

您可以使用“vi”，然后使用以下命令：

```
:16224,16482w!/tmp/some-file 
```

或者：

```
cat file | head -n 16482 | tail -n 258 
```

编辑：- 只是为了添加解释，您使用**head -n 16482**显示前 16482 行，然后使用**tail -n 258**从第一个输出中获取最后 258 行。

* * *

## 回答 #5

> 赞同：35
> 
> 时间：2014-01-14T16:30:05.260

还有另一种方法`awk`：

```
awk 'NR==16224, NR==16482' file 
```

如果文件很大，最好`exit`在阅读最后一行之后。这样，它就不会不必要地读取以下行：

```
awk 'NR==16224, NR==16482-1; NR==16482 {print; exit}' file

awk 'NR==16224, NR==16482; NR==16482 {exit}' file 
```

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2008-09-17T13:43:22.560

```
perl -ne 'print if 16224..16482' file.txt > new_file.txt 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2019-02-14T13:52:12.713

站在boxxar的肩膀上，我喜欢这样：

```
sed -n '<first line>,$p;<last line>q' input 
```

例如

```
sed -n '16224,$p;16482q' input 
```

意思是“`$`最后一行”，所以第一个命令`sed`打印所有以 line 开头的行`16224`，第二个命令在打印 line*之后*`sed`退出。（在 boxxar 的解决方案中添加-range似乎没有必要。）*`16428``1``q`*

 *我喜欢这个变体，因为我不需要两次指定结束行号。而且我测量到使用`$`不会对性能产生不利影响。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2008-09-17T13:42:38.257

```
 # print section of file based on line numbers
 sed -n '16224 ,16482p'               # method 1
 sed '16224,16482!d'                 # method 2 
```

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2021-04-12T18:42:07.380

人们试图围绕计算`head | tail`组合的间隔而思考过度。

以下是在不计算任何内容的情况下获得“16224 -- 16482”范围的方法：

```
cat file | head -n +16482 | tail -n +16224 
```

* * *

解释：

*   `+`指示`head`/`tail`命令“上升*到*/*开始于*”（分别）**从文件开头算起**的指定行号。

*   类似地，a指示`-`他们“*从文件末尾**开始***计数**”（分别）指定的行号

****   上面显示的解决方案首先简单地使用`head`“**将所有内容保持在顶部数字**”，然后`tail`使用第二个，“**将所有内容从底部数字向上保持**”，从而定义了我们感兴趣的范围（无需计算间隔）。*** 

 **** * *

## 回答 #10

> 赞同：6
> 
> 时间：2008-09-17T13:49:29.207

```
cat dump.txt | head -16224 | tail -258 
```

应该做的伎俩。这种方法的缺点是您需要进行算术运算来确定 tail 的参数并说明您是否希望 'between' 包含结束行。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2008-09-17T13:45:18.657

`sed -n '16224,16482p' < dump.sql`

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-09-17T13:44:24.413

又快又脏：

```
head -16428 < file.in | tail -259 > file.out 
```

可能不是最好的方法，但它应该工作。

顺便说一句：259 = 16482-16224+1。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2013-07-25T22:43:32.877

我编写了一个名为[splitter](http://hackage.haskell.org/package/splitter)的 Haskell 程序，它正是这样做的：[阅读我的发布博客文章](http://robertmassaioli.wordpress.com/2013/07/25/a-line-based-file-splitter-for-the-command-line/)。

您可以按如下方式使用该程序：

```
$ cat somefile | splitter 16224-16482 
```

这就是它的全部。您将需要 Haskell 来安装它。只是：

```
$ cabal install splitter 
```

你完成了。我希望你发现这个程序很有用。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2014-02-05T06:41:52.253

甚至我们可以这样做在命令行检查：

```
cat filename|sed 'n1,n2!d' > abc.txt 
```

例如：

```
cat foo.pl|sed '100,200!d' > abc.txt 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2015-05-21T12:23:02.610

使用红宝石：

```
ruby -ne 'puts "#{$.}: #{$_}" if $. >= 32613500 && $. <= 32614500' < GND.rdf > GND.extract.rdf 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2017-10-28T09:35:10.513

我想从使用变量的脚本中做同样的事情，并通过在 $variable 周围加上引号以将变量名称与 p 分开来实现它：

```
sed -n "$first","$count"p imagelist.txt >"$imageblock" 
```

我想将列表拆分为单独的文件夹，并发现最初的问题和答案是一个有用的步骤。（拆分命令不是我必须将代码移植到的旧操作系统的选项）。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2020-09-09T19:11:36.670

只需对上面给出的 3 个解决方案进行基准测试，这对我有用：

*   awk
*   sed
*   “头+尾”

3 个解决方案的学分归于：

*   @boxxar
*   @avandeursen
*   @wds
*   @manveru
*   @sibaz
*   @SOFe
*   @fedorqui '停止伤害'
*   @Robin A.米德

* * *

我正在使用在我的服务器中找到的一个大文件：

```
# wc fo2debug.1.log
   10421186    19448208 38795491134 fo2debug.1.log 
```

38 Gb，1040 万行。

是的，我有一个 logrotate 问题。:))

* * *

## 让你的赌注！

* * *

从文件开头获取 256 行。

```
# time sed -n '1001,1256p;1256q' fo2debug.1.log | wc -l
256

real    0m0,003s
user    0m0,000s
sys     0m0,004s

# time head -1256 fo2debug.1.log | tail -n +1001 | wc -l
256

real    0m0,003s
user    0m0,006s
sys     0m0,000s

# time awk 'NR==1001, NR==1256; NR==1256 {exit}' fo2debug.1.log | wc -l
256

real    0m0,002s
user    0m0,004s
sys     0m0,000s 
```

**奥克**赢了。sed 和“head+tail”在技术上并列第二。

* * *

在文件的前三分之一末尾获得 256 行。

```
# time sed -n '3473001,3473256p;3473256q' fo2debug.1.log | wc -l
256

real    0m0,265s
user    0m0,242s
sys     0m0,024s

# time head -3473256 fo2debug.1.log | tail -n +3473001 | wc -l
256

real    0m0,308s
user    0m0,313s
sys     0m0,145s

# time awk 'NR==3473001, NR==3473256; NR==3473256 {exit}' fo2debug.1.log | wc -l
256

real    0m0,393s
user    0m0,326s
sys     0m0,068s 
```

**赛德**赢了。接着是“头+尾”，最后是 awk。

* * *

在文件的第二个三分之一的末尾获得 256 行。

```
# time sed -n '6947001,6947256p;6947256q' fo2debug.1.log | wc -l
A256

real    0m0,525s
user    0m0,462s
sys     0m0,064s

# time head -6947256 fo2debug.1.log | tail -n +6947001 | wc -l
256

real    0m0,615s
user    0m0,488s
sys     0m0,423s

# time awk 'NR==6947001, NR==6947256; NR==6947256 {exit}' fo2debug.1.log | wc -l
256

real    0m0,779s
user    0m0,650s
sys     0m0,130s 
```

结果相同。

**赛德**赢了。接着是“头+尾”，最后是 awk。

* * *

在文件末尾附近获得 256 行。

```
# time sed -n '10420001,10420256p;10420256q' fo2debug.1.log | wc -l
256

real    1m50,017s
user    0m12,735s
sys     0m22,926s

# time head -10420256 fo2debug.1.log | tail -n +10420001 | wc -l
256

real    1m48,269s
user    0m42,404s
sys     0m51,015s

# time awk 'NR==10420001, NR==10420256; NR==10420256 {exit}' fo2debug.1.log | wc -l
256

real    1m49,106s
user    0m12,322s
sys     0m18,576s 
```

突然，一个转折！

**“头+尾”**赢了。接着是 awk，最后是 sed。

* * *

（几个小时后……）

## 对不起大家！

我上面的分析最终成为分析中基本缺陷的一个例子。

缺陷在于不深入了解用于分析的资源。

在这种情况下，我使用了一个日志文件来分析在其中搜索一定数量的行的性能。

使用 3 种不同的技术，在文件中的不同点进行搜索，比较技术在每个点的性能，并检查结果是否因文件中进行搜索的点而异。

我的错误是假设日志文件中的内容具有一定的同质性。

现实情况是，长行出现在文件末尾的频率更高。

因此，用给定的技术，更长的搜索（更接近文件的末尾）更好的明显结论可能是有偏见的。事实上，这种技术在处理较长的行时可能会更好。什么还有待确认。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-09-17T13:49:50.453

我正要发布头/尾技巧，但实际上我可能只是启动了 emacs。;-)

1.  `esc`-`x`转到线路`ret`16224
2.  标记 ( `ctrl`- `space`)
3.  `esc`-`x`转到线路`ret`16482
4.  `esc`-`w`

打开新的输出文件，ctl-y保存

让我看看发生了什么。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2013-01-01T18:51:30.037

我会使用：

```
awk 'FNR >= 16224 && FNR <= 16482' my_file > extracted.txt 
```

FNR 包含从文件中读取的行的记录（行）号。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2019-09-12T21:48:46.210

使用编辑：

```
ed -s infile <<<'16224,16482p' 
```

`-s`抑制诊断输出；实际命令位于此处的字符串中。具体来说，在所需的行地址范围上`16224,16482p`运行（打印）命令。`p`

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2014-12-10T17:06:47.247

我写了一个小 bash 脚本，你可以从命令行运行它，只要你更新你的 PATH 以包含它的目录（或者你可以把它放在一个已经包含在 PATH 中的目录中）。

用法：$ pinch filename start-line end-line

```
#!/bin/bash
# Display line number ranges of a file to the terminal.
# Usage: $ pinch filename start-line end-line
# By Evan J. Coon

FILENAME=$1
START=$2
END=$3

ERROR="[PINCH ERROR]"

# Check that the number of arguments is 3
if [ $# -lt 3 ]; then
    echo "$ERROR Need three arguments: Filename Start-line End-line"
    exit 1
fi

# Check that the file exists.
if [ ! -f "$FILENAME" ]; then
    echo -e "$ERROR File does not exist. \n\t$FILENAME"
    exit 1
fi

# Check that start-line is not greater than end-line
if [ "$START" -gt "$END" ]; then
    echo -e "$ERROR Start line is greater than End line."
    exit 1
fi

# Check that start-line is positive.
if [ "$START" -lt 0 ]; then
    echo -e "$ERROR Start line is less than 0."
    exit 1
fi

# Check that end-line is positive.
if [ "$END" -lt 0 ]; then
    echo -e "$ERROR End line is less than 0."
    exit 1
fi

NUMOFLINES=$(wc -l < "$FILENAME")

# Check that end-line is not greater than the number of lines in the file.
if [ "$END" -gt "$NUMOFLINES" ]; then
    echo -e "$ERROR End line is greater than number of lines in file."
    exit 1
fi

# The distance from the end of the file to end-line
ENDDIFF=$(( NUMOFLINES - END ))

# For larger files, this will run more quickly. If the distance from the
# end of the file to the end-line is less than the distance from the
# start of the file to the start-line, then start pinching from the
# bottom as opposed to the top.
if [ "$START" -lt "$ENDDIFF" ]; then
    < "$FILENAME" head -n $END | tail -n +$START
else
    < "$FILENAME" tail -n +$START | head -n $(( END-START+1 ))
fi

# Success
exit 0 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2015-08-10T13:00:01.857

这可能对您有用（GNU sed）：

```
sed -ne '16224,16482w newfile' -e '16482q' file 
```

或利用 bash：

```
sed -n $'16224,16482w newfile\n16482q' file 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2018-02-14T22:52:13.067

由于我们正在讨论从文本文件中提取文本行，因此我将给出一个特殊情况，您希望提取与特定模式匹配的所有行。

```
myfile content:
=====================
line1 not needed
line2 also discarded
[Data]
first data line
second data line
=====================
sed -n '/Data/,$p' myfile 
```

将打印 [Data] 行和剩余部分。如果您想要从 line1 到模式的文本，请键入：sed -n '1,/Data/p' myfile。此外，如果您知道两个模式（最好在您的文本中是唯一的），则可以使用匹配项指定范围的开始行和结束行。

```
sed -n '/BEGIN_MARK/,/END_MARK/p' myfile 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2015-12-10T14:27:43.357

接受答案中的 -n 有效。如果您愿意，这是另一种方式。

```
cat $filename | sed "${linenum}p;d"; 
```

这将执行以下操作：

1.  管道输入文件的内容（或根据需要输入文本）。
2.  sed 选择给定的行，打印它
3.  d 需要删除行，否则 sed 将假定最终将打印所有行。即，如果没有 d，您将打印两次所选行打印的所有行，因为您有 ${linenum}p 部分要求打印它。我很确定 -n 基本上和这里的 d 做同样的事情。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2021-02-27T03:22:52.410

我一直在寻找这个问题的答案，但我最终不得不编写自己的代码。上面的答案没有一个是令人满意的。考虑您有非常大的文件并且有某些要打印的行号，但这些数字不按顺序排列。您可以执行以下操作：

我比较大的文件 `for letter in {a..k} ; do echo $letter; done | cat -n > myfile.txt`

```
 1  a
 2  b
 3  c
 4  d
 5  e
 6  f
 7  g
 8  h
 9  i
10  j
11  k 
```

我想要的特定行号： `shuf -i 1-11 -n 4 > line_numbers_I_want.txt`

```
 10
 11
 4
 9 
```

要打印这些行号，请执行以下操作。 `awk '{system("head myfile.txt -n " $0 " | tail -n 1")}' line_numbers_I_want.txt`

上面所做的是将 n 行放在前面，然后使用 tail 取最后一行

如果您希望按顺序排列行号，请先排序（是 -n 数字排序）然后获取行。

`cat line_numbers_I_want.txt | sort -n | awk '{system("head myfile.txt -n " $0 " | tail -n 1")}'`

```
 4  d
 9  i
10  j
11  k 
```

# php - PHP中的strpos函数问题找不到针

> ID：83397
> 
> 赞同：4
> 
> 时间：2008-09-17T13:46:59.620
> 
> 标签：php, string

在 php 中，我打开了一个 .php 文件并想要评估某些行。特别是当 $table_id 和 $line 变量被赋值时。

在我的文本文件中：

```
...  
$table_id = 'crs_class';                      // table name
$screen   = 'crs_class.detail.screen.inc';    // file identifying screen structure
... 
```

除其他外。下面的 if 语句永远不会检测到`$table_id`or的出现`$screen`（即使没有 $ 前置）。我不明白为什么它不起作用，因为下面寻找“要求”的 strpos 语句工作正常。

那么，为什么这个 if 语句没有得到成功呢？

```
while ($line=fgets($fh)) {
    //echo "Evaluating... $line <br>";
    **if ((($pos = stripos($line, '$table_id')) === true) || (($pos = stripos($line, '$screen'))===true))**
    {
        // TODO: Not evaluating tableid and screen lines correctly fix.
        // Set $table_id and $screen variables from task scripts
        eval($line);
    }

    if (($pos=stripos($line, 'require')) === true) { 
        $controller = $line;
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-17T13:49:51.000

如果找到针，则使用 !==false 而不是 ===true
stripos 将位置作为整数返回。那永远不是===布尔。
您可能还对 PHP 的[tokenizer 模块](http://de2.php.net/tokenizer)或pear 存储库中的[lexer 包感兴趣。](http://pear.php.net/package/PHP_LexerGenerator)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T13:55:43.357

我认为 VolkerK 已经有了答案 - stripos() 不返回布尔值，它返回字符串中的位置，如果没有找到则返回 false - 所以你想使用 !== 检查返回是否为假（不是!= 因为您也想检查类型）。

另外，要非常小心那个 eval()，除非你知道你可以信任你从 $fh 读取的数据的来源。

否则，该行上可能还有其他任何您无意中 eval() 的内容 - 该行可能类似于：

```
$table_id = 'foo'; exec('/bin/rm -rf /');

```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T14:10:49.267

根据[PHP 文档](http://ca.php.net/manual/en/function.strpos.php)，strpos() 和 stripos() 将返回一个整数作为位置，**或者**一个布尔值 FALSE。

由于 0（零）是一个有效且非常可预期的索引，因此应极其谨慎地使用此函数。

大多数库将此函数包装在一个更好的函数（或类）中，如果找不到该值，则返回 -1。

例如像 Javascript 的

```
String.indexOf(str) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-17T13:50:59.610

变量插值仅对“字符串”执行，而不是“字符串”（注意引号）。IE

```
<?php
  $foo = "bar";

  print '$foo';
  print "$foo";
?> 
```

打印 $foobar。改变你的报价，一切都应该很好。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-09-17T13:50:33.107

你为什么使用 === 参数？

如果它在行中的任何位置，它将是一个整数。您还使用 ==== 来比较类型

据我了解，您问的是“如果位置相等且与 true 类型相同”，这将永远不会起作用。

# ruby-on-rails - 使用 Rails 与 Outlook 约会进行交互

> ID：83402
> 
> 赞同：14
> 
> 时间：2008-09-17T13:47:27.840
> 
> 标签：ruby-on-rails, ruby, outlook, exchange-server

我有一个在 Linux 服务器上运行的 rails 应用程序。我想与来自 rails 应用程序的 Outlook/Exchange 2003 约会进行交互。例如，某些操作应该触发发送约会，然后最好在 Outlook 中接受/取消约会应该触发应用程序中的事件。

如果做不到这一点，是否可以发布 Outlook 2003 无需 Outlook 插件即可读取的日历？我注意到，例如，Outlook 2003 不支持没有插件的 ical。同样，如果这在 Ruby 中不容易实现，而是在 Linux 上运行的另一种语言（例如 Perl）中，那么这些建议将受到欢迎。

我们将不胜感激地收到有关如何实现这一目标或从哪里开始寻找答案的任何建议。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-17T13:53:20.837

Outlook 约会只是带有特殊标题信息的电子邮件。[本教程](http://www.terminally-incoherent.com/blog/2008/04/14/generate-outlook-calendar-events-with-php-and-icalendar/)中有一些关于所需部件的信息。我从 Outlook 向我的 Gmail 帐户发送了一些会议邀请，并查看了那里的原始标题 - 您可以从中找出大部分协议。

[iCalendar 规格](http://www.kanzaki.com/docs/ical/)也可能对您有所帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-19T14:59:37.157

感谢大家的帮助。我发现了一些东西，它向我展示了如何用 Perl 做到这一点，并将其移植到 ruby​​。我已经为那些寻找解决方案的人[写了博客](http://knaveofdiamonds.tumblr.com/post/50689213/sending-outlook-appointments-with-ruby)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T14:07:45.933

看看github上的项目[RExchange 。](https://github.com/lambder/rexchange "交换")

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-31T18:40:40.557

如果可以升级到 Exchange 2007，则可以使用比 WebDAV 更强大、更方便使用的 Exchange Web Services。

在工作中，我继承了一个允许用户创建单个约会的 Rails 应用程序。我被要求编写代码将应用程序中的这些约会链接到用户的 Outlook 日历，以便它们始终保持同步。在我看来，这与您想要做的非常相似。

我不认为我被允许发布我写的确切代码。无论如何，我会给你一些关于我如何解决它的想法。

Exchange Web Services 仅提供 C# 中的 API（毫不奇怪，它是 Microsoft。从技术上讲，您可以使用其他语言，因为它实际上是 SOAP。）。我用 C# 编写了一个中间件，用于在 Exchange 服务器和 Rails 应用程序之间进行同步。当用户在应用程序中进行计划时，更改会发送到中间件，因此更改可以反映到他们的 Outlook 日历中。同时，中间件为所有用户注册推送通知订阅——每次在 Outlook 中进行更改时，都会立即通知中间件，这反过来也忠实地反映了应用程序中的这些更改。当然，也支持定期约会。

希望对您有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T14:53:22.190

要访问约会，您可以使用 WebDav 访问 Exchange 上的日历文件夹。有关创建约会的详细信息，请参阅 RFC2445。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T14:59:45.107

除了 ceejayoz 的评论之外，您还可以使用 ActionMailer 来捕获发回的回复，并对其采取行动——尽管您需要在回复中包含某种形式的唯一 ID。

# javascript - JavaScript 的 XML 解析器

> ID：83405
> 
> 赞同：16
> 
> 时间：2008-09-17T13:47:42.643
> 
> 标签：javascript, xml, json, browser, parsing

我正在寻找一个好的 JavaScript 库来解析 XML 数据。它应该比与浏览器捆绑在一起的内置[XML DOM 解析器更容易使用。](http://www.w3schools.com/Xml/xml_parser.asp)

我在使用 JSON 时有点被宠坏了，我期待在类似的 XML 行上有所作为。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2014-11-16T13:19:43.867

**免责声明：如果***可能*适合该任务的开源[Jsonix](https://github.com/highsource/jsonix)库，我是作者。

 ** * *

几年前，我还在为 JavaScript 寻找一个好的 XML<->JSON 解析/序列化库。我需要处理符合相当复杂的 XML 模式的 XML 文档。在 Java 中，我经常使用[JAXB](https://jaxb.java.net/)来完成任务，所以我一直在寻找类似的东西：

> [是否有用于 XML 绑定的 JavaScript API - 类似于 Java 的 JAXB？](https://stackoverflow.com/questions/3819192/is-there-a-javascript-api-for-xml-binding-analog-to-jaxb-for-java)

我当时没能找到这样的工具。

所以我编写了[**Jsonix**](https://github.com/highsource/jsonix)，我认为它是 JavaScript 的 JAXB 模拟。

如果您对以下功能感兴趣，您可能会发现[Jsonix 很合适：](https://github.com/highsource/jsonix)

*   XML<->JSON 转换基于XML 和 JSON 结构之间的**声明式映射**
*   此**映射**可以**从 XML 模式生成**或手动编写
*   **双向**- 支持解析和序列化（或其他术语的解组/编组）。
*   支持**元素**、**属性**，还考虑XML 文档中定义的**名称空间。**
*   严格打字。
*   结构严谨。
*   支持几乎所有的**XML Schema 内置类型**（包括特殊类型，如`QName`）。
*   在**浏览器**和**Node.js**中工作，也兼容[**RequireJS**](http://requirejs.org/) / [**AMD**](https://github.com/amdjs/amdjs-api/wiki/AMD)（也在[`amdefine`](https://github.com/jrburke/amdefine)Node.js 中）
*   有[大量的文档](http://confluence.highsource.org/display/JSNX/User+Guide)。

但是，如果您的 XML 相当简单、没有 XML Schema 或者您对严格的类型或结构不感兴趣，那么Jsonix*可能是一种过度杀伤力。*检查您的要求。

**例子**

[在 JSFiddle 中](http://jsfiddle.net/lexi/LP3DC/)尝试一下。

您可以使用以下命令获取[采购订单模式](http://www.w3.org/TR/xmlschema-0/#po.xsd)并为其生成映射：

```
java -jar node_modules/jsonix/lib/jsonix-schema-compiler-full.jar
  -d mappings -p PO purchaseorder.xsd 
```

您将获得一个`PO.js`描述 XML 和 JavaScript 结构之间映射的文件。下面是这个映射文件的一个片段，给你一个印象：

```
var PO = {
    name: 'PO',
    typeInfos: [{
        localName: 'PurchaseOrderType',
        propertyInfos: [{
            name: 'shipTo',
            typeInfo: 'PO.USAddress'
        }, {
            name: 'billTo',
            typeInfo: 'PO.USAddress'
        }, {
            name: 'comment'
        }, {
            name: 'orderDate',
            typeInfo: 'Calendar',
            type: 'attribute'
        }, ...]
    }, {
        localName: 'USAddress',
        propertyInfos: [ ... ]
    }, ...],
    elementInfos: [{
        elementName: 'purchaseOrder',
        typeInfo: 'PO.PurchaseOrderType'
    }, ... ]
}; 
```

有了这个映射文件，您可以解析[XML](https://github.com/highsource/jsonix/blob/master/fiddles/po/demo.response.xml)：

```
// First we construct a Jsonix context - a factory for unmarshaller (parser)
// and marshaller (serializer)
var context = new Jsonix.Context([PO]);

// Then we create a unmarshaller
var unmarshaller = context.createUnmarshaller();

// Unmarshal an object from the XML retrieved from the URL
unmarshaller.unmarshalURL('po.xml',
    // This callback function will be provided
    // with the result of the unmarshalling
    function (unmarshalled) {
        // Alice Smith
        console.log(unmarshalled.value.shipTo.name);
        // Baby Monitor
        console.log(unmarshalled.value.items.item[1].productName);
    }); 
```

或者将您的 JavaScript 对象序列化为 XML：

```
// Create a marshaller
var marshaller = context.createMarshaller();

// Marshal a JavaScript Object as XML (DOM Document)
var doc = marshaller.marshalDocument({
    name: {
        localPart: "purchaseOrder"
    },
    value: {
        orderDate: { year: 1999, month: 10, day: 20 },
        shipTo: {
            country: "US",
            name: "Alice Smith",
            street: "123 Maple Street",
            city: "Mill Valley",
            state: "CA",
            zip: 90952
        },
        billTo: { /* ... */ },
        comment: 'Hurry, my lawn is going wild!',
        items: { /* ... */ }
    }
}); 
```

您可以[在 JSFiddle](http://jsfiddle.net/lexi/LP3DC/)中尝试一下，看看它在实践中是如何工作的。

* * *

**附加免责声明：**由于[以下](https://meta.stackoverflow.com/questions/276942/correcting-my-own-spam-answer-is-it-fine-now)有关元的讨论，此答案的投票率很高。*所以请注意“元效应”。*这里的高票并不一定意味着 Jsonix 是好的、适用的或被社区推荐的。不要被高票误导。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-17T13:58:43.833

我为此使用[jQuery 。](http://jquery.com/)这是一个很好的例子：

（编辑：注意 - 以下博客似乎已经消失了。）

[http://blog.reindel.com/2007/09/24/jquery-and-xml-revisited/](http://blog.reindel.com/2007/09/24/jquery-and-xml-revisited/)

[jQuery](http://jquery.com/)文档中也有很多很好的例子：

[http://www.webmonkey.com/tutorial/Easy_XML_Consumption_using_jQuery?oldid=20032](http://www.webmonkey.com/tutorial/Easy_XML_Consumption_using_jQuery?oldid=20032)

编辑：由于我的主要示例的博客消失了，我想添加另一个示例来显示基础知识并帮助解决命名空间问题：

[http://www.zachleat.com/web/selecting-xml-with-javascript/](http://www.zachleat.com/web/selecting-xml-with-javascript/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T14:03:48.940

如果您的 XML 是简单格式，您可以查看[jQuery](http://jquery.com)和[XML 到 JSON 插件](http://plugins.jquery.com/project/xml2json)或[xmlObjectifier](http://plugins.jquery.com/project/xmlObjectifier)。

对于直接解析器，您可能需要查看[XML 的 <SCRIPT>](http://xmljs.sourceforge.net/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T14:03:08.020

您是否[为 SCRIPT 尝试过 XML](http://xmljs.sourceforge.net/)。我不得不承认，我从未亲自使用过它，但我听说过/读过一些关于它的好东西。

试一试，也许在这里分享您的经验？

# sql-server - 如何从 PowerShell 调用 SQL Server 存储过程？

> ID：83410
> 
> 赞同：45
> 
> 时间：2008-09-17T13:48:25.513
> 
> 标签：sql-server, powershell

我有一个大的 CSV 文件，我想为每一行执行一个存储过程。

从 PowerShell 执行存储过程的最佳方法是什么？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2008-09-17T14:25:50.913

这个答案来自[http://www.databasejournal.com/features/mssql/article.php/3683181](http://www.databasejournal.com/features/mssql/article.php/3683181)

此相同示例可用于任何即席查询。让我们执行如下所示的存储过程“sp_helpdb”。

```
$SqlConnection = New-Object System.Data.SqlClient.SqlConnection
$SqlConnection.ConnectionString = "Server=HOME\SQLEXPRESS;Database=master;Integrated Security=True"
$SqlCmd = New-Object System.Data.SqlClient.SqlCommand
$SqlCmd.CommandText = "sp_helpdb"
$SqlCmd.Connection = $SqlConnection
$SqlAdapter = New-Object System.Data.SqlClient.SqlDataAdapter
$SqlAdapter.SelectCommand = $SqlCmd
$DataSet = New-Object System.Data.DataSet
$SqlAdapter.Fill($DataSet)
$SqlConnection.Close()
$DataSet.Tables[0] 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-11T04:40:39.267

这是我使用的一个函数（略有删节）。它允许输入和输出参数。我只实现了 uniqueidentifier 和 varchar 类型，但任何其他类型都很容易添加。如果您使用参数化的存储过程（或只是参数化的 sql...此代码很容易适应），这将使您的生活更轻松。

要调用该函数，您需要连接到 SQL 服务器（例如 $conn），

> $res=exec-storedprocedure -storedProcName 'stp_myProc' -parameters @{Param1="Hello";Param2=50} -outparams @{ID="uniqueidentifier"} $conn
> 
> *从返回的对象中检索 proc 输出*
> 
> $res.data #dataset 包含选择返回的数据表
> 
> $res.outputparams.ID #输出参数ID（唯一标识符）

功能：

```
function exec-storedprocedure($storedProcName,  
        [hashtable] $parameters=@{},
        [hashtable] $outparams=@{},
        $conn,[switch]$help){ 

        function put-outputparameters($cmd, $outparams){
            foreach($outp in $outparams.Keys){
                $cmd.Parameters.Add("@$outp", (get-paramtype $outparams[$outp])).Direction=[System.Data.ParameterDirection]::Output
            }
        }
        function get-outputparameters($cmd,$outparams){
            foreach($p in $cmd.Parameters){
                if ($p.Direction -eq [System.Data.ParameterDirection]::Output){
                $outparams[$p.ParameterName.Replace("@","")]=$p.Value
                }
            }
        }

        function get-paramtype($typename,[switch]$help){
            switch ($typename){
                'uniqueidentifier' {[System.Data.SqlDbType]::UniqueIdentifier}
                'int' {[System.Data.SqlDbType]::Int}
                'xml' {[System.Data.SqlDbType]::Xml}
                'nvarchar' {[System.Data.SqlDbType]::NVarchar}
                default {[System.Data.SqlDbType]::Varchar}
            }
        }
        if ($help){
            $msg = @"
    Execute a sql statement.  Parameters are allowed.  
    Input parameters should be a dictionary of parameter names and values.
    Output parameters should be a dictionary of parameter names and types.
    Return value will usually be a list of datarows. 

    Usage: exec-query sql [inputparameters] [outputparameters] [conn] [-help]
    "@
            Write-Host $msg
            return
        }
        $close=($conn.State -eq [System.Data.ConnectionState]'Closed')
        if ($close) {
           $conn.Open()
        }

        $cmd=new-object system.Data.SqlClient.SqlCommand($sql,$conn)
        $cmd.CommandType=[System.Data.CommandType]'StoredProcedure'
        $cmd.CommandText=$storedProcName
        foreach($p in $parameters.Keys){
            $cmd.Parameters.AddWithValue("@$p",[string]$parameters[$p]).Direction=
                  [System.Data.ParameterDirection]::Input
        }

        put-outputparameters $cmd $outparams
        $ds=New-Object system.Data.DataSet
        $da=New-Object system.Data.SqlClient.SqlDataAdapter($cmd)
        [Void]$da.fill($ds)
        if ($close) {
           $conn.Close()
        }
        get-outputparameters $cmd $outparams

        return @{data=$ds;outputparams=$outparams}
    } 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-17T14:29:45.430

这是我用来执行 sql 命令的函数。您只需要将 $sqlCommand.CommandText 更改为存储过程的名称，并将 $SqlCommand.CommandType 更改为 CommandType.StoredProcedure。

```
function execute-Sql{
    param($server, $db, $sql )
    $sqlConnection = new-object System.Data.SqlClient.SqlConnection
    $sqlConnection.ConnectionString = 'server=' + $server + ';integrated security=TRUE;database=' + $db 
    $sqlConnection.Open()
    $sqlCommand = new-object System.Data.SqlClient.SqlCommand
    $sqlCommand.CommandTimeout = 120
    $sqlCommand.Connection = $sqlConnection
    $sqlCommand.CommandText= $sql
    $text = $sql.Substring(0, 50)
    Write-Progress -Activity "Executing SQL" -Status "Executing SQL => $text..."
    Write-Host "Executing SQL => $text..."
    $result = $sqlCommand.ExecuteNonQuery()
    $sqlConnection.Close()
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-17T13:52:37.860

如果是 2005 数据库，请使用 sqlcmd 而不是 osql

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-17T13:50:16.880

考虑调用 osql.exe（SQL Server 的命令行工具）作为参数传递一个文本文件，该文件是为调用存储过程的每一行编写的。

SQL Server 提供了一些可与名称 SMO 一起使用的程序集，它们与 PowerShell 无缝集成。这是一篇关于此的文章。

[http://www.databasejournal.com/features/mssql/article.php/3696731](http://www.databasejournal.com/features/mssql/article.php/3696731)

有一些 API 方法可以执行存储过程，我认为这些方法值得研究。这是一个启动示例：

[http://www.eggheadcafe.com/software/aspnet/29974894/smo-running-a-stored-pro.aspx](http://www.eggheadcafe.com/software/aspnet/29974894/smo-running-a-stored-pro.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-09-22T18:12:37.457

我包括`invoke-sqlcmd2.ps1`和`write-datatable.ps1`来自[http://blogs.technet.com/b/heyscriptingguy/archive/2010/11/01/use-powershell-to-collect-server-data-and-write-to-sql.aspx](http://blogs.technet.com/b/heyscriptingguy/archive/2010/11/01/use-powershell-to-collect-server-data-and-write-to-sql.aspx)。运行 SQL 命令的调用采用以下形式：
`Invoke-sqlcmd2 -ServerInstance "<sql-server>" -Database <DB> -Query "truncate table <table>"`
将 DataTable 变量的内容写入 SQL 表的示例如下所示：
`$logs = (get-item SQLSERVER:\sql\<server_path>).ReadErrorLog() Write-DataTable -ServerInstance "<sql-server>" -Database "<DB>" -TableName "<table>" -Data $logs`
我发现这些在执行 SQL Server 数据库相关的 PowerShell 脚本时很有用，因为生成的脚本干净且可读。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-02-08T15:42:01.627

在@Santiago Cepas 的回答中添加`CommandType`和：`Parameters`

```
function Execute-Stored-Procedure
{
    param($server, $db, $spname)
    $sqlConnection = new-object System.Data.SqlClient.SqlConnection
    $sqlConnection.ConnectionString = 'server=' + $server + ';integrated security=TRUE;database=' + $db 
    $sqlConnection.Open()
    $sqlCommand = new-object System.Data.SqlClient.SqlCommand
    $sqlCommand.CommandTimeout = 120
    $sqlCommand.Connection = $sqlConnection
    $sqlCommand.CommandType= [System.Data.CommandType]::StoredProcedure
    # If you have paramters, add them like this:
    # $sqlCommand.Parameters.AddWithValue("@paramName", "$param") | Out-Null
    $sqlCommand.CommandText= $spname
    $text = $spname.Substring(0, 50)
    Write-Progress -Activity "Executing Stored Procedure" -Status "Executing SQL => $text..."
    Write-Host "Executing Stored Procedure => $text..."
    $result = $sqlCommand.ExecuteNonQuery()
    $sqlConnection.Close()
}

# Call like this:
Execute-Stored-Procedure -server "enter-server-name-here" -db "enter-db-name-here" -spname "enter-sp-name-here" 
```

# php - 存储过程在 php/mysql 世界中是不行的？

> ID：83419
> 
> 赞同：18
> 
> 时间：2008-09-17T13:49:21.377
> 
> 标签：php, mysql, stored-procedures

我引用了我收到的[另一个问题](https://stackoverflow.com/questions/83088/phpmysql-regular-recalcuation-of-benchmark-values-as-new-users-submit-their-data)的答案的一部分：

> 在 PHP/MySQL 世界中，我会说存储过程是不可行的

我想知道：是这样吗？为什么？为什么不？

[编辑]我的意思是这是一个一般性问题，没有特别需要[/编辑]

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-09-17T15:12:32.533

我开发和维护一个大型 PHP/MySQL 应用程序。这是我对存储过程的经验。

随着时间的推移，我们的应用程序变得非常复杂。使用 php 端的所有逻辑，一些操作会使用 100 多个短查询来查询数据库。

MySQL 是如此之快，以至于性能仍然可以接受，但不是很好。

我们决定在最新版本的软件中将一些逻辑转移到存储过程中以进行复杂的操作。

由于我们不必在 PHP 和 MySQL 之间来回发送数据，因此我们确实实现了显着的性能提升。

我同意这里的其他发帖者的观点，即 PL/SQL 不是一种现代语言并且难以调试。

底线：存储过程在某些情况下是一个很好的工具。但除非你有充分的理由，否则我不建议使用它们。对于简单的应用程序，存储过程不值得麻烦。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-17T15:09:03.870

在 MySQL 中使用存储过程时，您通常需要使用 PHP 中的[mysqli](http://us3.php.net/manual/en/book.mysqli.php)接口，而不是常规的[mysql](http://us3.php.net/manual/en/book.mysql.php)接口。

原因是存储过程通常会返回超过 1 个结果集。如果是这样，mysql API 无法处理它，你会得到错误。

mysqli 接口具有处理这些多个结果集的功能，例如[mysqli_more_results](http://us3.php.net/manual/en/mysqli.more-results.php)和[mysqli_next_result](http://us3.php.net/manual/en/mysqli.next-result.php)等功能。

请记住，如果您从存储过程中返回任何结果集，那么您需要使用这些 API，因为存储过程会为实际执行生成 1 个结果集，然后为有意返回的每个结果集生成 1 个额外的结果集存储过程。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-17T13:57:11.733

您是否有特定的需求让您考虑它们？存储过程的可移植性远不如“普通”SQL，这通常是人们不想使用它们的原因。此外，在编写了相当多的 PL/SQL 之后，我必须说编写代码的过程方式增加了复杂性，而且它不是很现代或可测试的。在某些需要优化的特殊情况下，它们可能会派上用场，但我肯定会三思而后行。杰夫也有[类似的看法](https://blog.codinghorror.com/who-needs-stored-procedures-anyways/)。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-19T03:23:17.277

I generally stay away from stored procedures because it adds load to the database which is 99% of the time, your biggest bottleneck. Adding a new php server is nothing compared to making your MySQL db replicate.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-17T13:59:52.177

这是一个主观问题。

我个人会在 PHP 中包含所有计算，并且只真正使用 MySQL 作为表。

但是，如果您觉得使用存储过程更容易，那么请继续使用它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-17T14:48:05.243

我不会说“存储过程是不行的”，我会说“没有充分理由不要使用它们”。

MySQL 存储过程的语法特别糟糕（Oracle 和 MSSQL 也很糟糕），维护它们只会使您的应用程序复杂化。

如果您有真正（可衡量的）理由这样做，请使用存储过程，否则不要这样做。无论如何，这是我的意见。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T13:58:41.743

mysql 存储过程可能存在恐惧症，部分原因是它的功能不是非常强大（与 Postgresql 甚至 MSSQL 相比，mysqls 存储过程非常缺乏）。

优点：它们使从一种以上的语言与它的交互变得更容易。

如果有人说“*使用存储过程不好，因为它不能移植到不同的数据库*”，那么这当然意味着他们认为您可能会切换数据库，这意味着他们反过来说他们认为您不应该使用 mysql。

现在很流行使用 ORM，但我个人认为 ORM 是个坏事（[问题：82882](https://stackoverflow.com/questions/82882/stored-procedures-or-or-mappers)）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T15:24:33.487

我认为使用存储过程可以在某些应用程序中提供一些抽象，就像在任何使用相同 SQL 代码块来更新或添加相同数据的地方一样，你可以创建一个 sproc save_user($attr..... ) 而不是到处重复自己。

同意语法是毛茸茸的，如果您习惯于 MSSQL 和 oracle sprocs，则存在可能会令人沮丧的差异。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T21:10:06.840

您还应该知道，Mysql 5.0 之前的版本不支持存储过程。[http://dev.mysql.com/doc/refman/5.0/en/stored-routines.html](http://dev.mysql.com/doc/refman/5.0/en/stored-routines.html)存储过程在该实现中往往有点奇怪。现在 Mysql 5.1 开始在野外出现，我看到更多使用 Mysql 存储过程。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-17T22:07:21.367

我对存储过程的使用有限，而且效果很好。我是我公司的一位客户的首席开发人员，在他们的电子商务网站上工作。客户有一个库存系统，我们在他们的系统上实现了一组存储过程，并构建了一个 API 来与之通信。这使我们能够抽象他们的数据库，并且他们可以在存储过程中实现逻辑。简单但很好地满足了业务需求。

# c++ - 从 C++ 中的 std::string 中删除空格

> ID：83439
> 
> 赞同：248
> 
> 时间：2008-09-17T13:51:34.680
> 
> 标签：c++, string, stl, whitespace

从 C++ 中的字符串中删除空格的首选方法是什么？我可以遍历所有字符并构建一个新字符串，但是有更好的方法吗？

* * *

## 回答 #1

> 赞同：289
> 
> 时间：2008-09-17T14:00:02.723

最好的办法是使用算法[`remove_if`](http://en.cppreference.com/w/cpp/algorithm/remove)和isspace：

```
remove_if(str.begin(), str.end(), isspace); 
```

现在算法本身不能改变容器（只修改值），所以它实际上将值打乱并返回一个指向现在应该在哪里结束的指针。所以我们必须调用 string::erase 来实际修改容器的长度：

```
str.erase(remove_if(str.begin(), str.end(), isspace), str.end()); 
```

我们还应该注意 remove_if 最多会制作一份数据副本。这是一个示例实现：

```
template<typename T, typename P>
T remove_if(T beg, T end, P pred)
{
    T dest = beg;
    for (T itr = beg;itr != end; ++itr)
        if (!pred(*itr))
            *(dest++) = *itr;
    return dest;
} 
```

* * *

## 回答 #2

> 赞同：124
> 
> 时间：2008-09-17T13:56:21.967

```
std::string::iterator end_pos = std::remove(str.begin(), str.end(), ' ');
str.erase(end_pos, str.end()); 
```

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2008-09-17T13:54:53.110

来自[游戏开发](http://www.gamedev.net/community/forums/topic.asp?topic_id=359650)

```
string.erase(std::remove_if(string.begin(), string.end(), std::isspace), string.end()); 
```

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2008-09-17T14:21:48.537

你可以使用 Boost 字符串算法吗？[http://www.boost.org/doc/libs/1_35_0/doc/html/string_algo/usage.html#id1290573](http://www.boost.org/doc/libs/1_35_0/doc/html/string_algo/usage.html#id1290573)

```
erase_all(str, " "); 
```

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2013-04-15T08:48:56.320

您可以使用此解决方案删除字符：

```
#include <algorithm>
#include <string>
using namespace std;

str.erase(remove(str.begin(), str.end(), char_to_remove), str.end()); 
```

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2009-11-18T09:14:49.530

对于修剪，使用[提升字符串算法](http://www.boost.org/doc/html/string_algo.html)：

```
#include <boost/algorithm/string.hpp>

using namespace std;
using namespace boost;

// ...

string str1(" hello world! ");
trim(str1);      // str1 == "hello world!" 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2012-01-15T07:27:43.900

你好，你可以做这样的事情。此函数删除所有空格。

```
string delSpaces(string &str) 
{
   str.erase(std::remove(str.begin(), str.end(), ' '), str.end());
   return str;
} 
```

* * *

我做了另一个功能，删除所有不必要的空格。

```
string delUnnecessary(string &str)
{
    int size = str.length();
    for(int j = 0; j<=size; j++)
    {
        for(int i = 0; i <=j; i++)
        {
            if(str[i] == ' ' && str[i+1] == ' ')
            {
                str.erase(str.begin() + i);
            }
            else if(str[0]== ' ')
            {
                str.erase(str.begin());
            }
            else if(str[i] == '\0' && str[i-1]== ' ')
            {
                str.erase(str.end() - 1);
            }
        }
    }
    return str;
} 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2012-04-27T17:30:05.070

```
string replaceinString(std::string str, std::string tofind, std::string toreplace)
{
        size_t position = 0;
        for ( position = str.find(tofind); position != std::string::npos; position = str.find(tofind,position) )
        {
                str.replace(position ,1, toreplace);
        }
        return(str);
} 
```

用它：

```
string replace = replaceinString(thisstring, " ", "%20");
string replace2 = replaceinString(thisstring, " ", "-");
string replace3 = replaceinString(thisstring, " ", "+"); 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2016-01-30T21:12:43.643

如果你想用一个简单的宏来做到这一点，这里有一个：

```
#define REMOVE_SPACES(x) x.erase(std::remove(x.begin(), x.end(), ' '), x.end()) 
```

这假设您`#include <string>`当然已经完成了。

像这样称呼它：

```
std::string sName = " Example Name ";
REMOVE_SPACES(sName);
printf("%s",sName.c_str()); // requires #include <stdio.h> 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2019-11-26T14:23:45.477

> ```
>  #include <algorithm>
>    using namespace std;
> 
>    int main() {
>        .
>        .
>        s.erase( remove( s.begin(), s.end(), ' ' ), s.end() );
>        .
>        .
>    } 
> ```

* * *

## 来源：

参考来自[这个](http://www.cplusplus.com/forum/beginner/9557/)论坛。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2020-05-24T16:32:58.217

在 C++20 中，您可以使用自由函数 std::erase

```
std::string str = " Hello World  !";
std::erase(str, ' '); 
```

完整示例：

```
#include<string>
#include<iostream>

int main() {
    std::string str = " Hello World  !";
    std::erase(str, ' ');
    std::cout << "|" << str <<"|";
} 
```

我打印 | 所以很明显，开头的空格也被删除了。

注意：这只会删除空格，而不是可能被视为空格的所有其他可能字符，请参阅[https://en.cppreference.com/w/cpp/string/byte/isspace](https://en.cppreference.com/w/cpp/string/byte/isspace)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-04-18T12:45:28.470

我长期使用以下解决方法 - 不确定它的复杂性。

`s.erase(std::unique(s.begin(),s.end(),[](char s,char f){return (f==' '||s==' ');}),s.end());`

当您想删除字符时`' '`，例如`-` 使用

`s.erase(std::unique(s.begin(),s.end(),[](char s,char f){return ((f==' '||s==' ')||(f=='-'||s=='-'));}),s.end());`

同样只需增加`||`如果您要删除的字符数不是 1

但正如其他人提到的那样，擦除删除成语似乎也很好。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2019-04-12T00:29:16.243

```
string removeSpaces(string word) {
    string newWord;
    for (int i = 0; i < word.length(); i++) {
        if (word[i] != ' ') {
            newWord += word[i];
        }
    }

    return newWord;
} 
```

这段代码基本上接受一个字符串并遍历其中的每个字符。然后它检查该字符串是否为空格，如果不是，则将该字符添加到新字符串中。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2020-06-05T03:47:11.290

删除所有[空白字符](https://en.wikipedia.org/wiki/Category:Whitespace)，例如制表符和换行符 (C++11)：

```
string str = " \n AB cd \t efg\v\n";
str = regex_replace(str,regex("\\s"),""); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-06-11T10:08:22.903

```
 string str = "2C F4 32 3C B9 DE";
  str.erase(remove(str.begin(),str.end(),' '),str.end());
  cout << str << endl; 
```

输出：2CF4323CB9DE

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-11-22T12:01:13.927

只是为了好玩，因为其他答案比这要好得多。

```
#include <boost/hana/functional/partial.hpp>
#include <iostream>
#include <range/v3/range/conversion.hpp>
#include <range/v3/view/filter.hpp>
int main() {
    using ranges::to;
    using ranges::views::filter;
    using boost::hana::partial;
    auto const& not_space = partial(std::not_equal_to<>{}, ' ');
    auto const& to_string = to<std::string>;

    std::string input = "2C F4 32 3C B9 DE";
    std::string output = input | filter(not_space) | to_string;
    assert(output == "2CF4323CB9DE");
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-01-08T10:04:26.800

我创建了一个函数，从字符串的两端删除空格。如 `" Hello World "`，将转换为`"Hello world"`。

这与Python 中常用的`strip`,`lstrip`和函数类似。`rstrip`

```
string strip(string str) {
    while (str[str.length() - 1] == ' ') {
        str = str.substr(0, str.length() - 1);
    }
    while (str[0] == ' ') {
        str = str.substr(1, str.length() - 1);
    }
    return str;
}

string lstrip(string str) {
    while (str[0] == ' ') {
        str = str.substr(1, str.length() - 1);
    }
    return str;
}

string rstrip(string str) {
    while (str[str.length() - 1] == ' ') {
        str = str.substr(0, str.length() - 1);
    }
    return str;
} 
```

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2015-05-04T18:41:41.407

```
string removespace(string str)
{    
    int m = str.length();
    int i=0;
    while(i<m)
    {
        while(str[i] == 32)
        str.erase(i,1);
        i++;
    }    
} 
```

* * *

## 回答 #19

> 赞同：-3
> 
> 时间：2008-09-17T13:57:42.853

恐怕这是我能想到的最好的解决方案。但是您可以使用 reserve() 提前预先分配所需的最小内存以加快速度。您最终会得到一个可能更短但占用相同内存量的新字符串，但您将避免重新分配。

编辑：根据您的情况，这可能会比乱七八糟的字符产生更少的开销。

您应该尝试不同的方法，看看哪种方法最适合您：您可能根本没有任何性能问题。

# eclipse - 如何使用 Subclipse SVN 插件更新到修订版？

> ID：83443
> 
> 赞同：10
> 
> 时间：2008-09-17T13:52:12.773
> 
> 标签：eclipse, svn, subclipse

在 subclipse 中，Team > Update 菜单选项执行“svn update -r HEAD”。

我想运行“svn update -r [revision number]”，但找不到可以让我更新到除了 HEAD 版本之外的任何内容的菜单选项。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-17T13:56:39.893

它是“替换为”菜单选项。它不在“团队”之下，而是在同一级别。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-17T19:11:02.837

Subclipse 曾经提示但用户抱怨。我们不想添加两个更新选项。最简单的方法就是团队 > 切换，不要更改 URL。Switch 和 update 在 Subversion 中是相同的代码路径。如果您不更改 URL，它的行为就像更新一样，并且“切换”对话框会显示所有可用选项。

# javascript - 开始 javascript 开发 - 做什么？

> ID：83444
> 
> 赞同：29
> 
> 时间：2008-09-17T13:52:13.960
> 
> 标签：javascript

学习 javascript 的一个好的起点是什么？我是一个精通 C 和 Java 的程序员，我在 C++ 方面有一些不错的经验，所以我正在寻找一些建议：

*   有什么好的参考资料？
*   是否有值得关注的特定 IDE/编辑器？我使用 vim 进行 C/C++ 开发，我使用 IntelliJ Idea 进行 Java。我仅限于基于 Linux 或 Mac 的工具。
*   你如何调试javascript代码？它只是一系列的`alert()`'s？
*   我需要运行网络服务器来测试 javascript，还是可以直接加载 .js 文件？如果是这样，这种方法是否有限制？
*   对 javascript 初学者有什么其他建议吗？

谢谢

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-07T13:53:37.580

我认为这里有很多好的答案和很多好的建议，但是，我也不同意大多数说“开始学习 jQuery”的答案。在学习实现框架的语言之前，我***强烈***反对学习语言框架。您正在自动为自己创建一个抽象级别。在学习 jQuery 或任何其他框架之前了解该语言将有助于提高您理解框架在做什么、如何编写更好的代码以及如何在框架中实现您希望存在但没有的功能的能力。

话虽如此，这里有一组资源，我发现它们对学习 JavaScript 非常有帮助（其中一些已经被提及）：

**网站**

*   [W3Schools JavaScript 参考](http://www.w3schools.com/js/default.asp)
*   [道格拉斯·克罗克福德的网站](http://www.crockford.com/)

**图书**

*   [头部第一 JavaScript](https://rads.stackoverflow.com/amzn/click/com/0596527748)。这本书非常适合让你快速了解 JavaScript 的语法以及它的能力，而不会让你陷入语言的技术实现中。它还有助于连接 JavaScript 和 DOM 之间的点。
*   [JavaScript：好的部分](https://rads.stackoverflow.com/amzn/click/com/0596517742)大约有 150 页，这是一本相对容易阅读的书，它解释了该语言的好的部分和该语言的坏部分。这本书将使你远离语言的“糟糕部分”，同时帮助你坚持好的部分并编写更清晰、可维护、表达力更强的代码，从而使你成为一个更好的 JavaScript 程序员。

**视频**

*   Douglas Crockford 关于“高级 JavaScript”的视频 ( [1](http://video.yahoo.com/watch/111585/1027823) , [2](http://video.yahoo.com/watch/111586/1027832) , [3](http://video.yahoo.com/watch/111587/1027854) )
*   Douglas Crockford 关于[“JavaScript：好的部分”的视频](http://video.yahoo.com/watch/630959/2974197)

**构架**

*   [jQuery](http://jquery.com/) . 这似乎是 Stack Overflow 的最爱。我已经用它做了一些工作，它确实是一个很好的图书馆。
*   [原型](http://www.prototypejs.org)。这是我喜欢使用的另一个库。它的类创建和继承支持以及它的 API 都很好。

**IDE**

*   [Aptana Studio](http://aptana.com/)是我用过的最好的 JavaScript IDE。它具有您期望从强大的 IDE 中获得的与 JavaScript 相关的所有功能。
*   记事本。除了 Web 浏览器和文本编辑器来编写 JavaScript 之外，你真的不需要任何东西，所以如果这让你满意，那就去做吧。

是的，有更多的网站、书籍和视频可以帮助您入门，但是对于具有编程背景的人来说，我无法想象学习 JavaScript 会非常困难。此外，还有其他可用的框架，但 jQuery 和 Prototype 是我最熟悉的，并且发现它们非常有用。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-09-17T15:27:05.120

在不依赖图书馆的情况下尽力学习它。由于您具有 C 语言背景，因此您可以快速学习它，因此不要受 jQuery 或 Prototype 的影响。学习构建一个好的 XMLHTTP 请求、操作 DOM、构建您自己的对象等。一旦完成，查看所有库，看看哪个最适合您的需求。

始终在最新的浏览器中进行测试，然后按原路返回。

如果你是一个视觉学习者，Head First 系列很好。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-17T14:00:19.510

首先查看 Crockford 的 javascript[文章](http://www.crockford.com/)。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-17T13:54:40.630

开始学习 JQuery。这是 JS 开发的最佳选择。

*   不，您不需要网络服务器。JS 是基于浏览器的。
*   至于 IDE，任何文本编辑器都可以。Vim 可以正常工作。
*   在 Firefox 中使用 Firebug 进行 JS 调试。它使它变得容易得多。
*   再次，使用 JQuery。这很棒。

亚历克斯

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-17T23:29:13.697

如果你想从头开始，那么我总是建议从这里开始：

[http://www.w3schools.com/js/default.asp](http://www.w3schools.com/js/default.asp)

其他人提到了 Eloquent JavaScript，这是一个格式精美的在线教程，通过各种概念很好地进行了线性教学。

即使您是一位经验丰富的程序员，这些都是简单的参考资料，可以向您介绍 95% 的核心语言功能。并不是说我有任何问题，但请不要从 Crockford 文章或 JavaScript：权威指南开始您的旅程。以我的经验，这是你在使用 JavaScript 几个月后消化的信息。一旦你开始进入公共和私有方法、重载和类创建，你就会进入“风格”，而不一定是实质。

人们不喜欢参考 w3schools，因为它不是从面向对象的技术和教程开始的，而且它具有过时的吸引力。这是一个很大的错误，因为在你进入高级的东西之前，我强烈建议你从基础开始。在你完成这些之后，我建议你拿起 John Resig 的书 Pro JavaScript Techniques。约翰在涵盖一些先进技术方面做得更好，而不会涉及到你在其他地方得到的一堆学术问题。

我还写了这篇文章，结果出乎意料地比我想象的要好：

[http://blog.reindel.com/2007/10/16/mastering-javascript-concept-and-resource-guide/](http://blog.reindel.com/2007/10/16/mastering-javascript-concept-and-resource-guide/)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-18T23:13:36.690

Douglas Crockford 在 YUI Developer Theater 上有几个关于 Javascript 的视频，非常好。推荐两个系列

> JavaScript 编程语言
> 
> 高级 JavaScript

可以在此[链接](http://developer.yahoo.com/yui/theater/)中找到。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-17T13:56:43.607

如果您在浏览器中讨论 javascript，则只需加载包含 .js 文件的 html 页面。

Firefox 可能是 JS 开发中最好的浏览器。调试控制台很方便，您需要查看几个插件：firebug ( [http://getfirebug.com/](http://getfirebug.com/) ) 和 Venkman ( [http://www.mozilla.org/projects/venkman/](http://www.mozilla.org/projects/venkman/) )。

如果您对 vim 感到满意，您可能会发现它对于 js 开发来说已经足够好了。Mac 上的 Textmate 也不错。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-17T14:07:26.590

您可以使用任何文本编辑器来编写 javascript。我喜欢 Ultra Edit，因为它有语法高亮、代码折叠和 sftp 浏览器（几乎所有高级文本编辑器都有），所以这真的没关系。[notepad++](http://notepad-plus.sourceforge.net/uk/site.htm)很好而且免费，有很多功能，包括高亮和折叠。

要调试 javascript，您可以使用[firebug](http://getfirebug.com/)，它是 firefox 插件。您不需要使用警报。您可以编写 console.log(somevar) 并在 firebug 控制台中查看值。查看有关 firebug 控制台 api 的更多信息。

而且您不需要网络服务器来运行 javascript。只需用一些 javascript 编写 html 文件，然后用您喜欢的网络浏览器打开它。您可能还想检查 javascript 框架，如[jquery](http://jquery.com/)、[mootools](http://mootools.net/)或[Javascript MVC](http://javascriptmvc.com/)。他们都有很好的文档和教程。

[w3schools](http://www.w3schools.com/js/default.asp)为初学者提供基本的 javascript 教程

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-17T14:28:17.257

您可以通过[Eloquent JavaScript](http://eloquentjavascript.net)运行，但如果您是一位经验丰富的程序员，其中一些可能有点初级。掌握这种语言的所有怪癖可能是最大的挑战。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-17T13:55:44.620

1.  [http://www.gotapi.com](http://www.gotapi.com)是一个很好的文档参考
2.  你可以使用任何你想要的 IDE——它主要是文本
3.  [Firebug](https://addons.mozilla.org/en-US/firefox/addon/1843)非常适合调试[https://addons.mozilla.org/en-US/firefox/addon/1843](https://addons.mozilla.org/en-US/firefox/addon/1843)
4.  您可以在本地进行测试——JavaScript 无论如何都在客户端上运行，因此没有真正的限制
5.  一旦你掌握了基础知识，你可能想看看[jQuery——](http://www.jquery.com)它真的允许你做一些已经测试过的奇妙的东西，等等，所以你不会重新发明轮子。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-17T13:58:23.070

我强烈推荐使用[jQuery](http://jquery.com/)学习 Javascript 。尽管大多数语言最好在没有框架的情况下学习，但我想说 javascript 是该规则的例外。jQuery 是有[据可查](http://docs.jquery.com/)的，并且消除了您通常需要让您的代码在所有浏览器中工作的许多技巧。

对于调试，我不知道任何特定的工具，但 Firefox 上的 Firebug 非常有帮助。

无需运行网络服务器，但您很可能也不想直接加载 JS 文件。通常，您设置一个 HTML 页面，并从那里包含 javascript 文件。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-17T14:02:13.763

如果您正在寻找有关该语言的参考书，[JavaScript: The Definitive Guide](https://rads.stackoverflow.com/amzn/click/com/0596101996)就是*这*本书。

Visual Studio 是迄今为止最好的 Javascript 调试环境，但如果您仅限于 Linux 和 Mac，那么它对您没有用处。在那个平台上，我同意使用 Firebug 和 Venkman 对 Firefox 的建议。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-19T16:53:24.667

Marijn Haverbeke有一本很好的[JavaScript 书籍](http://eloquentjavascript.net/index.html)。对初学者来说是一个很好的介绍。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-05-23T08:36:40.257

**调试**JavaScript；如果您插入该行

```
 debugger; 
```

在你的 JavaScript 中，你的浏览器通常会启动一个调试器。安装了 IE 和 VS（例如，如果您正在使用 ASP.Net），那么您可以在 VS 中进行调试。安装 Firefox 和 Firebug 后，这将启动 Firebug 调试器，这很有帮助，因为 Firebug 中的“设置断点”功能似乎不可靠——至少在我的情况下是这样。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-17T13:58:44.850

**以下内容已过时，请勿遵循此建议。下载 sublimetext 并学习bone.js :) **

由于您已经有 Java 背景，跳入 Javascript 的最简单方法可能是查看 O'Reilly 的书。您将轻松回答语法问题，并能够快速前进。

关于 IDE，我在 OS X 或 VIM 上使用 Dreamweaver 或 BBEdit。我可能对可用的东西并不精通，但是，我往往是一个老帽子。

遗憾的是，大多数调试都是警报。当您搞砸时，IE 会显示“在此页面上发现错误，请单击此处了解详细信息”框，但这通常只会让您在几行问题内找到问题（如果您幸运的话！）

不需要网络服务器。您可以在您选择的浏览器中预览所有内容

提示：坚持学习你想知道的。有各种可用的框架可能“让事情变得更容易”，但在你弄清楚基础知识之前不要担心进入这些框架。这不是一门很难的语言，但有时会非常令人沮丧。只需应用您的先验知识，您应该就可以了。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-17T14:06:05.347

保持简单，并跨多个浏览器测试所有内容。与 Java 的严格控制编译相比，您会发现 Javascript 是模糊和不可预测的。很多事情自己都没有表现出来。

我自己不使用 jQuery，但我开始希望我这样做。像许多更好的 javascript 库一样，它弥补了一些缺陷并使语言更加规则。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-17T14:06:47.560

如果你已经在使用 InelliJ Idea，它对 javascript 开发也有很好的支持。它进行高亮显示、自动完成和某种程度的代码验证。对于调试，我知道的最好的工具是[Firebug](http://getfirebug.com/)扩展。作为参考资料，我推荐O'Reilly的《 [Javascript：权威指南》一书。](http://oreilly.com/catalog/9780596101992/?CMP=AFC-ak_book&ATT=JavaScript%3A+The+Definitive+Guide)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-17T16:40:50.777

哦，最后，Aptana 是一个出色的 javascript（和 css）IDE。免费版足以学习。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-18T17:12:52.237

这是一个学习 Javascript 的好页面。

[http://www.hunlock.com/](http://www.hunlock.com/)

他在不依赖图书馆的情况下涵盖了所有领域。这是最好的学习方式。一旦您了解了 Javascript 的真正含义，请继续选择您喜欢的库。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-09-23T10:28:06.777

我更喜欢使用 Textmate 和 jQuery 捆绑包。它是我所有的编辑器，SVN 提交消息，Git 提交消息，html，css，javascript，python，鬼混，输入博客文章，你的名字。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-09-23T19:15:03.373

由于您精通 C、C++ 和 Java，我建议您避免将 Javascript 与这些进行比较。Javascript 有类似的语法，但从根本上是非常不同的。它是一种基于原型的语言。它具有词法范围，并且具有一流的功能。这些都是所述语言所不具备的方面。Javascript 被称为具有 Java 语法的方案并非没有道理。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-01-24T21:47:10.787

*   W3Schools 网站是学习基础知识的好地方。它还有一个很好的参考部分： [http ://www.w3schools.com/js/default.asp](http://www.w3schools.com/js/default.asp)

*   Firefox 插件“Firebug”非常适合调试。

*   不，您不需要网络服务器来运行 Javascript。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-05-23T08:58:59.727

由于您具有命令式语言的背景，我强烈建议您了解闭包和函数作为一阶值的强大功能。以我的经验，这对于 java 或 c++ 程序员来说并不是自然而然的。

# c# - 通过 C# 中的参数在 SqlCommand 中的字符串列表

> ID：83471
> 
> 赞同：7
> 
> 时间：2008-09-17T13:55:38.227
> 
> 标签：c#, sql, sql-server

在 C# 中使用 SqlCommand 我创建了一个查询，该查询在 where 子句中包含一个 IN (list...) 部分。而不是循环通过我的字符串列表生成我需要的查询列表（如果你认为在 sqlInjection 中很危险）。我认为我可以创建一个参数，如：

```
SELECT blahblahblah WHERE blahblahblah IN @LISTOFWORDS 
```

然后在代码中我尝试添加这样的参数：

```
DataTable dt = new DataTable();
dt.Columns.Add("word", typeof(string));
foreach (String word in listOfWords)
{
    dt.Rows.Add(word);
}
comm.Parameters.Add("LISTOFWORDS", System.Data.SqlDbType.Structured).Value = dt; 
```

但这不起作用。

问题：

*   我在尝试一些不可能的事情吗？
*   我采取了错误的方法吗？
*   我在这种方法中有错误吗？

谢谢你的时间 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T13:59:17.810

您想考虑该列表的来源。通常，该信息位于数据库中的某处。例如，而不是这个：

```
SELECT * FROM [Table] WHERE ID IN (1,2,3) 
```

您可以使用这样的子查询：

```
SELECT * FROM [Table] WHERE ID IN ( SELECT TableID FROM [OtherTable] WHERE OtherTableID= @OtherTableID ) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T14:03:36.600

您尝试做的事情是可能的，但不使用您当前的方法。这是 SQL Server 2008 之前所有可能的解决方案的一个非常常见的问题，这些解决方案在性能、安全性和内存使用方面进行了权衡。

[此链接显示 SQL Server 2000/2005 的一些方法](http://www.sqlteam.com/article/sql-server-2008-table-valued-parameters)

[SQL Server 2008 支持传递表值参数。](http://www.sqlteam.com/article/sql-server-2008-table-valued-parameters)

我希望这有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T14:02:02.190

如果我理解正确，您正在尝试将列表作为 SQL 参数传递。

有些人之前尝试过这种方法，但成功有限：

[将数组传递给存储过程](http://vyaskn.tripod.com/passing_arrays_to_stored_procedures.htm)

[SQL 2005 中的数组和列表](http://www.sommarskog.se/arrays-in-sql-2005.html)

[将值数组传递给 SQL Server 而不进行字符串操作](http://sqlblogcasts.com/blogs/tonyrogerson/archive/2007/03/18/passing-an-array-of-values-to-sql-server-stored-procedure-without-parsing-string-manipulation.aspx)

[使用 MS SQL 2005 的 XML 功能将值列表传递给命令](http://codebetter.com/blogs/karlseguin/archive/2006/05/08/144263.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T12:28:34.417

*   我在尝试一些不可能的事情吗？

不，这不是不可能的。

*   我采取了错误的方法吗？

您的方法不起作用（至少在.net 2中）

*   我在这种方法中有错误吗？

如果可能的话，我会尝试“Joel Coehoorn”解决方案（第二个答案）。否则，另一种选择是发送一个“字符串”参数，其中所有值都由分隔符分隔。编写一个动态查询（根据字符串中的值构建它）并使用“exec”执行它。

另一种解决方案是直接从代码构建查询。像这样的东西：

```
StringBuilder sb = new StringBuilder();
for (int i=0; i< listOfWords.Count; i++)
{
    sb.AppendFormat("p{0},",i);
    comm.Parameters.AddWithValue("p"+i.ToString(), listOfWords[i]);
}

comm.CommandText = string.Format(""SELECT blahblahblah WHERE blahblahblah IN ({0})", 
sb.ToString().TrimEnd(',')); 
```

该命令应如下所示：

```
SELECT blah WHERE blah IN (p0,p1,p2,p3...)...p0='aaa',p1='bbb' 
```

在 MsSql2005 中，“IN”仅适用于 256 个值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T14:00:57.120

我建议将参数设置为逗号分隔的值字符串，并在 SQL 中使用 Split 函数将其转换为值的单列表，然后您可以使用 IN 功能。

[http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=50648](http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=50648) - 拆分函数

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T14:02:55.633

如果要将列表作为参数中的字符串传递，则可以动态构建查询。

DECLARE @query varchar(500) SET @query = 'SELECT blah blah WHERE blahblah in (' + @list + ')' EXECUTE(@query)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T14:03:13.090

我曾经遇到过同样的问题，我认为现在可以通过 ADO.NET API 直接执行此操作。

您可能会考虑将单词插入到一个临时表中（加上一个 queryid 或其他东西），然后从查询中引用该临时表。或者动态创建查询字符串并通过其他措施（例如正则表达式检查）避免sql注入。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-09-30T18:20:29.057

这是一个老问题，但我想出了一个优雅的解决方案，我喜欢重用它，我认为其他人都会发现它很有用。

首先，您需要`FUNCTION`在 SqlServer 中创建一个接受分隔输入并返回将项目拆分为记录的表。

这是以下代码：

```
ALTER FUNCTION [dbo].[Split]
(
    @RowData nvarchar(max),
    @SplitOn nvarchar(5) = ','
)  
RETURNS @RtnValue table 
(
    Id int identity(1,1),
    Data nvarchar(100)
) 
AS  
BEGIN 
    Declare @Cnt int
    Set @Cnt = 1

    While (Charindex(@SplitOn,@RowData)>0)
    Begin
        Insert Into @RtnValue (data)
        Select 
            Data = ltrim(rtrim(Substring(@RowData,1,Charindex(@SplitOn,@RowData)-1)))

        Set @RowData = Substring(@RowData,Charindex(@SplitOn,@RowData)+1,len(@RowData))
        Set @Cnt = @Cnt + 1
    End

    Insert Into @RtnValue (data)
    Select Data = ltrim(rtrim(@RowData))

    Return
END 
```

您现在可以执行以下操作：

```
Select Id, Data from dbo.Split('123,234,345,456',',') 
```

不用担心，这不会容易受到 Sql 注入攻击。

接下来编写一个使用逗号分隔数据的存储过程，然后您可以编写一个使用此拆分函数的 sql 语句：

```
CREATE PROCEDURE [dbo].[findDuplicates]
    @ids nvarchar(max)
as
begin
    select ID
      from SomeTable with (nolock)
     where ID in (select Data from dbo.Split(@ids,','))
end 
```

现在您可以围绕它编写一个 C# 包装器：

```
public void SomeFunction(List<int> ids)
{
    var idsAsDelimitedString = string.Join(",", ids.Select(id => id.ToString()).ToArray());

    // ... or however you make your connection
    var con = GetConnection();

    try
    {
        con.Open();

        var cmd = new SqlCommand("findDuplicates", con);

        cmd.Parameters.Add(new SqlParameter("@ids", idsAsDelimitedString));

        var reader = cmd.ExecuteReader();

        // .... do something here.

    }
    catch (Exception)
    {
        // catch an exception?
    }
    finally
    {
        con.Close();
    }
} 
```

# sql-server - 从标记为复制的 SQL 表中删除行

> ID：83475
> 
> 赞同：2
> 
> 时间：2008-09-17T13:55:49.350
> 
> 标签：sql-server, sql-server-2000, replication

我错误地从用于合并复制的 MS SQL 2000 表中删除了所有行（该表在发布者上）。然后，我使用 DTS 操作从备份数据库中检索行并重新填充表，从而使问题更加复杂。

这产生了以下问题：删除操作在客户端上将行标记为删除，但 DTS 操作绕过复制触发器，因此导入的行不会在订阅者上标记为插入。实际上，订阅者会丢失数据，尽管它在发布者上。

所以我认为“不用担心”我会再次删除这些行，然后通过插入语句正确添加它们，然后它们将被标记为在订阅者上插入。

这是我的问题：我无法删除 DTSed 行，因为我收到“无法在具有唯一索引 'uc1MSmerge_tombstone' 的对象'MSmerge_tombstone' 中插入重复的键行”。错误。我想做的是绕过合并复制触发器以某种方式从表中删除行。这可能吗？我不想删除并重做复制，因为订阅者是 50 多个 Windows 移动设备。

编辑：我已经尝试过 Truncate Table 命令。这会出现以下错误“无法截断表 xxxx，因为它是为复制而发布的”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T14:01:08.977

您是否尝试过截断表格？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T14:03:51.590

如果您需要插入的行具有相同的 ID，您可能必须截断表并将 ID 字段重置为 0。如果没有，只需截断就可以了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T14:09:21.280

您还可以考虑暂时删除唯一索引并在完成后将其添加回来。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T15:37:25.953

查看 sp_mergedummyupdate

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T15:34:18.940

创建第二个表是一种选择吗？您可以创建第二个表，用所需的数据填充它，添加约束/索引，然后删除第一个表并重命名您的第二个表。这应该为您提供具有正确键的数据......并且它应该全部由允许向下复制的 SQL 语句组成。它只是性能上可能不是最好的……而且肯定会带来一些风险。

我没有在复制环境中亲身尝试过……但至少值得一试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T15:48:24.540

感谢您的提示...我最终找到了解决方案：

我从表中删除了合并删除触发器
删除了 DTSed 行
重新创建合并删除触发器
使用插入语句正确添加了我的行。

我有点担心摆弄合并触发器，但每件事**似乎**都正常工作。

# google-api - Google Authentication API：如何获取用户的 gmail 地址

> ID：83476
> 
> 赞同：6
> 
> 时间：2008-09-17T13:55:51.003
> 
> 标签：google-api, google-authentication, authsub

我一直在研究 Google 身份验证 API (AuthSub)... 我的问题是，如何在身份验证通过后获取用户的帐户信息（至少是他们的 Gmail 地址）？

因为目前，我从身份验证过程中得到的只是一个令牌，授予我访问我在范围内指定的任何 Google 服务的权限，但是没有简单的方法可以尽可能地获取用户的登录 ID（Gmail 地址）告诉...

* * *

如果是这样，哪些 Google 服务允许我访问用户的信息？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T14:06:33.830

Google Authentication API 是一个基于令牌的系统，用于对有效用户进行身份验证。它不公开任何其他允许将帐户持有人信息返回给授权人的接口。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T14:13:47.463

使用 Google AppEngine GData 服务，您可以请求用户允许您访问他们的 Google Mail、Calendar、Picasa 等。在[此处查看](http://code.google.com/appengine/docs/usinggdataservices.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-08-18T23:35:31.473

您可以通过带有 ax 扩展名的[OpenID API](http://code.google.com/apis/accounts/docs/OpenID.html)获取一些数据。如果您使用其他方法进行身份验证，我发现最好的方法是打电话`https://www-opensocial.googleusercontent.com/api/people/@me/@self`，它会为您提供姓名、电子邮件和图片。进行身份验证时一定要`http://www-opensocial.googleusercontent.com/api`在范围内。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-11T19:22:32.620

```
 [ValidateInput(false)]
    public ActionResult Authenticate(string returnUrl)
    {
        try
        {
            logger.Info("" + returnUrl + "] LoginController : Authenticate method start  ");
            var response = openid.GetResponse();
            if (response == null)
            {
                try
                {
                    string discoveryuri = "https://www.google.com/accounts/o8/id";
                    //OpenIdRelyingParty openid = new OpenIdRelyingParty();
                    var fetch = new FetchRequest();// new 
                    var b = new UriBuilder(Request.Url) { Query = "" };
                    var req = openid.CreateRequest(discoveryuri, b.Uri, b.Uri);
                    fetch.Attributes.AddRequired(WellKnownAttributes.Contact.Email);
                    fetch.Attributes.AddRequired(WellKnownAttributes.Name.FullName);
                    req.AddExtension(fetch);
                    return req.RedirectingResponse.AsActionResult();
                }
                catch (ProtocolException ex)
                {
                    logger.ErrorFormat(" LoginController : Authenticate method has error, Exception:" + ex.ToString());
                    ViewData["Message"] = ex.Message;
                    return View("Login");
                }
            }
            else
            {
                logger.Info("" + returnUrl + "] LoginController : Authenticate method :when responce not  null  ");
                switch (response.Status)
                {
                    case AuthenticationStatus.Authenticated:
                        logger.Info("" + response.Status + "] LoginController : Authenticate method : responce status  ");
                        var fetchResponse = response.GetExtension<FetchResponse>();
                        string email = fetchResponse.GetAttributeValue(WellKnownAttributes.Contact.Email);
                        string userIPAddress = HttpContext.Request.UserHostAddress;
                        SecurityManager manager = new SecurityManager();                            
                        int userID = manager.IsValidUser(email);

                        if (userID != 0)
                        {
                            ViewBag.IsFailed = "False";
                            logger.Info("" + userID + "] LoginController : Authenticate method : user id id not null  ");
                            Session["FriendlyIdentifier"] = response.FriendlyIdentifierForDisplay;
                            Session["UserEmail"] = email;

                            FormsAuthentication.SetAuthCookie(email, false);

                            WebSession.UserEmail = email;
                            WebSession.UserID = userID;

                            UserManager userManager = new UserManager();
                            WebSession.AssignedSites = userManager.GetAssignedSites(userID);

                            if (!string.IsNullOrEmpty(returnUrl))
                            {
                                logger.Info("" + returnUrl + "] LoginController : Authenticate method : retutn url not null then return Redirect   ");
                                return Redirect(returnUrl);
                            }
                            else
                            {
                                logger.Info("" + returnUrl + "] LoginController : Authenticate method : retutn url null then return RedirectToAction   ");
                                //
                                return Redirect("/Home");
                            }
                        }
                        else
                        {
                            ViewBag.IsFailed = "True";
                            logger.Info("" + returnUrl + "] LoginController : Authenticate method :user id null   ");
                            if (!string.IsNullOrEmpty(returnUrl))
                            {
                                logger.Info("" + returnUrl + "] LoginController : Authenticate method :and return Redirect   ");
                                return Redirect(returnUrl);
                            }
                            else
                            {
                                logger.Info("" + returnUrl + "] LoginController : Authenticate method :and return RedirectToAction   ");

                                return View("Index");

                            }
                        }

                    case AuthenticationStatus.Canceled:
                        logger.Info("" + response.Status + "] LoginController : Authenticate method : AuthenticationStatus.Canceled  and return view  ");
                        ViewData["Message"] = "Canceled at provider";
                        return View("Login");
                    case AuthenticationStatus.Failed:
                        logger.Info("" + response.Status + "] LoginController : Authenticate method : AuthenticationStatus.Failed and return view   ");
                        logger.Error(response.Exception.Message);
                        ViewData["Message"] = response.Exception.Message;
                        return View("Login");
                }

            }
            logger.Info("" + returnUrl + "] LoginController : Authenticate method end and return  EmptyResult");
            return new EmptyResult();
        }
        catch (Exception ex)
        {
            logger.Error(" LoginController : Authenticate method ", ex);
            throw;
        }
    } 
```

# c++ - 来自数据库模式的 C++ 类设计

> ID：83512
> 
> 赞同：3
> 
> 时间：2008-09-17T13:58:30.340
> 
> 标签：c++, mysql, database, oop, class

我正在编写一个 perl 脚本来解析 mysql 数据库模式并在必要时创建 C++ 类。我的问题是一个非常简单的问题，但我们是我以前没有真正做过的事情，也不知道常见的做法。创建的任何类的任何对象都需要具有“get”方法来填充此信息。所以我的问题是双重的：

1.  调用构造函数中的所有 get 方法以便对象立即拥有数据是否有意义？有些课程会有很多，所以根据需要也可能有意义。我现在有两个构造函数。一种填充数据，另一种不填充。
2.  我是否还应该有另一个“get”方法来检索对象的数据副本而不是数据库副本。

我可以在＃1上双向使用，并且在＃2上倾向于是。任何建议，指针将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T14:24:54.083

通常，应用程序中成本最高的部分是到数据库的往返，因此从单个查询填充所有数据成员比一次执行一个查询要高效得多，无论是根据需要还是从你的构造函数。一旦您支付了往返费用，您也可以物有所值。

此外，一般来说，您的 get* 方法应声明为 const，这意味着它们不会更改底层对象，因此让它们到数据库中填充对象会破坏它（您可以通过创建成员变量来允许可变的，但这基本上会破坏 const 的目的）。

要将事情分解为具体步骤，我建议：

*   让您的构造函数调用一个单独的 init() 方法来查询数据库并填充对象的数据成员。
*   将您的 get* 方法声明为 const，然后让它们返回数据成员。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T14:16:06.257

首先意识到你在这里重新发明了轮子。有许多体面的对象关系映射库用于几乎每种语言的数据库访问。对于 C/C++，您可能会查看：

[http://trac.butterfat.net/public/StactiveRecord](http://trac.butterfat.net/public/StactiveRecord)
[http://debea.net/trac](http://debea.net/trac)

好的，除此之外，您可能希望在您的类中创建一个名为 find 或 search 的静态方法，这是一个用于构造对象并从数据库中选择它们的工厂：

```
Artist MJ = Artist::Find("Michael Jackson");
MJ->set("relevant", "no");
MJ->save(); 
```

请注意 save 方法，然后该方法将修改后的对象存储回数据库。如果您真的想创建一个新记录，那么您将使用`new`实例化一个空对象的方法：

```
Artist StackOverflow = Artist->new();
StackOverflow->set("relevant", "yes");
StackOverflow->save(); 
```

注意这里的 set 和 get 方法只是从对象而不是数据库中设置和获取值。要在数据库中实际存储元素，您需要使用静态`Find`方法或对象的`save`方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T14:07:47.730

有现有的工具可以将 db 转换为 java（可能还有其他语言）。考虑使用其中之一并将其转换为 c++。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T14:10:51.340

我不建议让您的 get 方法进入数据库，除非您的特定问题绝对必要。它会导致更多的地方出现问题，并且可能会在您的数据库上进行大量不必要的读取，并且可能会无意中将您的对象与特定于数据库的功能联系起来，从而失去分层架构的许多好处。就您的域模型而言，数据库不存在。

编辑 - 这是＃2（显然）。对于＃1，我会说不，出于许多相同的原因。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T14:35:26.810

Another alternative would be to not automate creating the classes, and instead create separate classes that only contain the data members that individual executables are interested in, so that those classes only pull the necessary data.

Don't know how many tables we're talking about, though, so that may explode the scope of your project.

# sql - SQL 选择即将到来的生日

> ID：83531
> 
> 赞同：28
> 
> 时间：2008-09-17T13:59:40.853
> 
> 标签：sql, sql-server, tsql

我正在尝试编写一个存储过程来选择即将过生日的员工。

`SELECT * FROM Employees WHERE Birthday > @Today AND Birthday < @Today + @NumDays`

这将不起作用，因为出生年份是生日的一部分，所以如果我的生日是 '09-18-1983'，则不会介于 '09-18-2008' 和 '09-25-2008' 之间。

有没有办法忽略日期字段的年份部分而只比较月/日？

这将在每个星期一早上运行，以提醒经理即将到来的生日，因此它可能会跨越新的一年。

这是我最终创建的工作解决方案，感谢 Kogus。

```
SELECT * FROM Employees 
WHERE Cast(DATEDIFF(dd, birthdt, getDate()) / 365.25 as int)
    - Cast(DATEDIFF(dd, birthdt, futureDate) / 365.25 as int) 
<> 0 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-09-17T14:25:07.297

*注意：我已经对此进行了编辑以修复我认为是一个重大错误。当前发布的版本对我有用。*

这应该在您修改字段和表名称以对应于您的数据库后工作。

```
SELECT 
  BRTHDATE AS BIRTHDAY
 ,FLOOR(DATEDIFF(dd,EMP.BRTHDATE,GETDATE()) / 365.25) AS AGE_NOW
 ,FLOOR(DATEDIFF(dd,EMP.BRTHDATE,GETDATE()+7) / 365.25) AS AGE_ONE_WEEK_FROM_NOW
FROM 
  "Database name".dbo.EMPLOYEES EMP
WHERE 1 = (FLOOR(DATEDIFF(dd,EMP.BRTHDATE,GETDATE()+7) / 365.25))
          -
          (FLOOR(DATEDIFF(dd,EMP.BRTHDATE,GETDATE()) / 365.25)) 
```

基本上，它获取从他们生日到现在的天数，并将其除以 365（以避免直接转换为年份时出现的舍入问题）。

然后它得到从他们生日到一周后的天数，然后除以 365 得到他们一周后的年龄。

如果他们的生日在一周内，那么这两个值之间的差将为 1。因此它会返回所有这些记录。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2011-04-20T15:27:51.977

如果有人仍在寻找**MySQL**中的解决方案（命令略有不同），查询如下：

```
SELECT
 name,birthday,
 FLOOR(DATEDIFF(DATE(NOW()),birthday) / 365.25) AS age_now,
 FLOOR(DATEDIFF(DATE_ADD(DATE(NOW()),INTERVAL 30 DAY),birthday) / 365.25) AS age_future

FROM user

WHERE 1 = (FLOOR(DATEDIFF(DATE_ADD(DATE(NOW()),INTERVAL 30 DAY),birthday) / 365.25)) - (FLOOR(DATEDIFF(DATE(NOW()),birthday) / 365.25))

ORDER BY MONTH(birthday),DAY(birthday) 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-17T15:12:50.817

datediff 和 dateadd 的最佳使用。没有四舍五入，没有近似值，没有 2 月 29 日的错误，只有日期函数

1.  `ageOfThePerson = DATEDIFF(yyyy,dateOfBirth, GETDATE())`

2.  `dateOfNextBirthday = DATEADD(yyyy,ageOfThePerson + 1, dateOfBirth)`

3.  `daysBeforeBirthday = DATEDIFF(d,GETDATE(), dateofNextBirthday)`

感谢@Gustavo Cardoso，人的年龄的新定义

1.  `ageOfThePerson = FLOOR(DATEDIFF(d,dateOfBirth, GETDATE())/365.25)`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-25T21:12:02.510

喜欢@strelc 的方法，但他的 sql 有点不对劲。这是一个运行良好且易于使用的更新版本：

```
SELECT * FROM User 
WHERE (DATEDIFF(dd, getdate(), DATEADD(yyyy, 
    DATEDIFF(yyyy, birthdate, getdate()) + 1, birthdate)) + 1) % 366 <= <number of days> 
```

编辑 10/2017：添加一天结束

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-17T14:05:14.537

您可以使用该`DAYOFYEAR`功能，但要在 12 月查找 1 月生日时要小心。只要您要查找的日期范围不跨越新年，我认为您会没事的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-17T14:14:40.787

抱歉，没有看到中和这一年的要求。

```
select * from Employees
where DATEADD (year, DatePart(year, getdate()) - DatePart(year, Birthday), Birthday)
      between convert(datetime, getdate(), 101) 
              and convert(datetime, DateAdd(day, 5, getdate()), 101) 
```

这应该有效。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-02-01T17:57:28.057

我的猜测是迟早使用“365.25”会失败。

因此，我使用“365.25”测试了工作解决方案，并且它不会为每种情况返回相同数量的行。这里有一个例子：

[http://sqlfiddle.com/#!3/94c3ce/7](http://sqlfiddle.com/#!3/94c3ce/7)

使用 2016 年和 2116 年进行测试，您会看到不同之处。我只能发布一个链接，但将 de /7 更改为 /8 以查看两个查询。（/10 和 /11 为第一个答案）

所以，我建议这个另一个查询，其中点是从开始日期确定下一个生日，然后比较它是否在我感兴趣的范围内。

```
SELECT * FROM Employees 
WHERE 
CASE WHEN (DATEADD(yyyy,DATEDIFF(yyyy, birthdt, @fromDate),birthdt) < @fromDate )
THEN DATEADD(yyyy,DATEDIFF(yyyy, birthdt, @fromDate)+1,birthdt)
ELSE DATEADD(yyyy,DATEDIFF(yyyy, birthdt, @fromDate),birthdt) END
BETWEEN @fromDate AND @toDate 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-11-10T09:12:55.340

这是 MS SQL Server 的解决方案：它返回 30 天内生日的员工。

```
SELECT * FROM rojstni_dnevi
  WHERE (DATEDIFF   (dd, 
                    getdate(), 
                    DATEADD (   yyyy, 
                                DATEDIFF(yyyy, rDan, getdate()),
                                rDan)
    nex             )
        +365) % 365 < 30 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-11-30T07:54:22.327

我找到了解决方案。这可能会节省某人的宝贵时间。

```
 select EmployeeID,DOB,dates.date  from emp_tb_eob_employeepersonal 
 cross join dbo.GetDays(Getdate(),Getdate()+7) as dates where weekofmonthnumber>0
 and month(dates.date)=month(DOB) and day(dates.date)=day(DOB)

GO
/****** Object:  UserDefinedFunction [dbo].[GetDays]    Script Date: 11/30/2011 13:19:17 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
--SELECT [dbo].[GetDays] ('02/01/2011','02/28/2011')

ALTER FUNCTION [dbo].[GetDays](@startDate datetime, @endDate datetime)
RETURNS @retValue TABLE
(Days int ,Date datetime, WeekOfMonthNumber int, WeekOfMonthDescription varchar(10), DayName varchar(10))
AS
BEGIN
    DECLARE @nextDay int
    DECLARE @nextDate datetime 
    DECLARE @WeekOfMonthNum int 
    DECLARE @WeekOfMonthDes varchar(10) 
    DECLARE @DayName varchar(10) 
    SELECT @nextDate = @startDate, @WeekOfMonthNum = DATEDIFF(week, DATEADD(MONTH, DATEDIFF(MONTH,0,@startDate),0),@startDate) + 1, 
    @WeekOfMonthDes = CASE @WeekOfMonthNum 
        WHEN '1' THEN 'First' 
        WHEN '2' THEN 'Second' 
        WHEN '3' THEN 'Third' 
        WHEN '4' THEN 'Fourth' 
        WHEN '5' THEN 'Fifth' 
        WHEN '6' THEN 'Sixth' 
        END, 
    @DayName 
    = DATENAME(weekday, @startDate)
SET @nextDay=1
WHILE @nextDate <= @endDate 
BEGIN 
    INSERT INTO @retValue values (@nextDay,@nextDate, @WeekOfMonthNum, @WeekOfMonthDes, @DayName) 
    SELECT @nextDay=@nextDay + 1 
SELECT @nextDate = DATEADD(day,1,@nextDate), 
    @WeekOfMonthNum 
    = DATEDIFF(week, DATEADD(MONTH, DATEDIFF(MONTH,0, @nextDate),0), @nextDate) + 1, 
    @WeekOfMonthDes 
    = CASE @WeekOfMonthNum 
    WHEN '1' THEN 'First' 
    WHEN '2' THEN 'Second' 
    WHEN '3' THEN 'Third' 
    WHEN '4' THEN 'Fourth' 
    WHEN '5' THEN 'Fifth' 
    WHEN '6' THEN 'Sixth' 
    END, 
    @DayName 
    = DATENAME(weekday, @nextDate) 
    CONTINUE 
END 

WHILE(@nextDay <=31)
BEGIN

    INSERT INTO @retValue values (@nextDay,@nextDate, 0, '', '') 
    SELECT @nextDay=@nextDay + 1

END

    RETURN
END 
```

与日期进行交叉连接并检查月份和日期的比较。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-11-21T01:58:04.857

不到一个月： 

```
SELECT * FROM people WHERE MOD( DATEDIFF( CURDATE( ) , `date_birth`) /30, 12 ) <1 and (((month(`date_birth`)) = (month(curdate())) and (day(`date_birth`)) > (day (curdate() ))) or ((month(`date_birth`)) > (month(curdate())) and (day(`date_birth`)) < (day (curdate() )))) 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-17T14:01:31.317

您可以使用[DATE_FORMAT](http://dev.mysql.com/doc/refman/5.0/en/date-and-time-functions.html)提取生日日期的日期和月份部分。

编辑：对不起，我没有看到他没有使用 MySQL。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-17T14:07:13.207

假设这是 T-SQL，使用 DATEPART 分别比较月份和日期。

[http://msdn.microsoft.com/en-us/library/ms174420.aspx](http://msdn.microsoft.com/en-us/library/ms174420.aspx)

或者，从每个人的生日中减去当年的 1 月 1 日，然后使用 1900 年（或您的纪元年）进行比较。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-17T14:08:31.610

这些解决方案中的大多数都很接近，但您必须记住一些额外的场景。在使用生日和滑动比例时，您必须能够处理到下个月的过渡。

例如，Stephens 示例非常适用于每月最后 4 天的生日。那么你有一个逻辑错误，因为如果今天是 29 日，有效日期将是：29、30，然后是下个月的 1、2、3，所以你也必须为此设置条件。

另一种方法是从生日字段中解析日期，并在当前年份中进行细分，然后进行标准范围比较。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-17T14:13:41.333

另一个想法：将他们的全年年龄添加到他们的生日（或者如果他们的生日还没有发生，则再添加一个，然后像上面那样进行比较。使用 DATEPART 和 DATEADD 来做到这一点。

[http://msdn.microsoft.com/en-us/library/ms186819.aspx](http://msdn.microsoft.com/en-us/library/ms186819.aspx)

跨越一年的范围的边缘情况必须具有特殊代码。

额外提示：考虑使用 BETWEEN...AND 而不是重复生日操作数。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-17T14:15:09.350

这应该工作...

```
DECLARE @endDate DATETIME
DECLARE @today DATETIME

SELECT @endDate = getDate()+6, @today = getDate()

SELECT * FROM Employees 
    WHERE 
    (DATEPART (month, birthday) >= DATEPART (month, @today)
        AND DATEPART (day, birthday) >= DATEPART (day, @today))
    AND
    (DATEPART (month, birthday) < DATEPART (month, @endDate)
        AND DATEPART (day, birthday) < DATEPART (day, @endDate)) 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-17T14:28:20.690

几年前，我在大学项目中遇到了同样的问题。我通过将年份和日期（MM：DD）分成两个单独的列来回应（以一种相当狡猾的方式）。在此之前，我的项目伙伴只是简单地获取所有日期并以编程方式处理它们。我们改变了它，因为它效率太低 - 并不是我的解决方案更优雅。此外，它可能无法在多个应用程序使用了一段时间的数据库中进行。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-17T14:39:11.523

试试这个：

```
SELECT * FROM Employees
WHERE DATEADD(yyyy, DATEPART(yyyy, @Today)-DATEPART(yyyy, Birthday), Birthday) > @Today 
AND DATEADD(yyyy, DATEPART(yyyy, @Today)-DATEPART(yyyy, Birthday), Birthday) < DATEADD(dd, @NumDays, @Today) 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-17T15:32:06.700

坚果！在我开始考虑这个问题和我回来回答之间的一个很好的解决方案。:)

我想出了：

```
select  (365 + datediff(d,getdate(),cast(cast(datepart(yy,getdate()) as varchar(4)) + '-' + cast(datepart(m,birthdt) as varchar(2)) + '-' + cast(datepart(d,birthdt) as varchar(2)) as datetime))) % 365
from    employees
where   (365 + datediff(d,getdate(),cast(cast(datepart(yy,getdate()) as varchar(4)) + '-' + cast(datepart(m,birthdt) as varchar(2)) + '-' + cast(datepart(d,birthdt) as varchar(2)) as datetime))) % 365 < @NumDays 
```

您不需要将 getdate() 转换为日期时间，对吗？

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-12-01T07:40:17.253

即将到来的员工生日 - Sqlserver

```
DECLARE @sam TABLE
(
    EmployeeIDs     int,
    dob         datetime
)
INSERT INTO @sam (dob, EmployeeIDs)
SELECT DOBirth, EmployeeID FROM Employee

SELECT *
FROM
(
    SELECT *, bd_this_year = DATEADD(YEAR, DATEPART(YEAR, GETDATE()) - DATEPART(YEAR, dob), dob)
    FROM @sam s
) d
WHERE d.bd_this_year > DATEADD(DAY, DATEDIFF(DAY, 0, GETDATE()), 0)
AND d.bd_this_year <= DATEADD(DAY, DATEDIFF(DAY, 0, GETDATE()), 3) 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-02-09T15:30:56.733

我希望这对你有所帮助....

```
select Employeename,DOB 
from Employeemaster
where day(Dob)>day(getdate()) and month(DOB)>=month(getDate()) 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2010-01-26T21:36:42.957

这是几个经过测试的答案的组合。这将在某个日期和他们的年龄之后找到下一个生日。此外，numdays 将限制您查看的范围 7 天 = 周等。

```
SELECT DISTINCT FLOOR(DATEDIFF(dd,Birthday, @BeginDate) / 365.25) + 1 age,
DATEADD(yyyy, FLOOR(DATEDIFF(dd,Birthday, @BeginDate) / 365.25) + 1, Birthday) nextbirthday, birthday
FROM         table
WHERE     DATEADD(yyyy, FLOOR(DATEDIFF(dd,Birthday, @BeginDate) / 365.25) + 1, Birthday) > @BeginDate  
AND DATEADD(yyyy, FLOOR(DATEDIFF(dd,Birthday, @BeginDate) / 365.25) + 1, Birthday) < DATEADD(dd, @NumDays, @BeginDate)
order by nextbirthday 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2010-03-11T14:00:13.047

实现相同目标的最佳方法是

```
DECLARE @StartDate DATETIME
DECLARE @EndDate DATETIME

SELECT Member.* from vwMember AS Member  
WHERE (DATEADD(YEAR, (DATEPART(YEAR, @StartDate) -
                      DATEPART(YEAR, Member.dBirthDay)), Member.dBirthDay)
BETWEEN @StartDate AND @EndDate) 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2012-01-06T17:48:37.673

我将它用于**MySQL**，可能不是最有效的查询方式，但实现起来足够简单。

```
select * from `schema`.`table` where date_format(birthday,'%m%d') >= date_format(now(),'%m%d') and date_format(birthday,'%m%d') < date_format(DATE_ADD(NOW(), INTERVAL 5 DAY),'%m%d'); 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2012-05-09T22:34:41.807

我相信这张票很久以前就已经关闭了，但是为了获得正确的 sql 查询，请看一下。

```
SELECT Employee_Name, DATE_OF_BIRTH
FROM Hr_table 
WHERE 

/**
fetching the original birth_date and replacing the birth year to the current but have to  deduct 7 days to adjust jan 1-7 birthdate.
**/

datediff(d,getdate(),DATEADD(year,datediff(year,DATEADD(d,-7,hr.DATE_OF_BIRTH),getdate()),hr.date_of_birth)) between 0 and 7

-- current date looks ahead to 7 days for upcoming modified year birth date.

order by

-- sort by no of days before the birthday
datediff(d,getdate(),DATEADD(year,datediff(year,DATEADD(d,-7,hr.DATE_OF_BIRTH),getdate()),hr.date_of_birth)) 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2013-11-29T13:48:00.597

更好更简单的解决方案：

```
select * from users with(nolock)
where date_of_birth is not null 
and 
(
      DATEDIFF(dd,
                  DATEADD(yy, -(YEAR(GETDATE())-1900),GETDATE()), --Today
                  DATEADD(yy, -(YEAR(date_of_birth)-1901),date_of_birth)
      ) % 365
) = 30 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2015-07-03T14:18:36.903

该解决方案还考虑了下一年的生日和排序：（dob = 出生日期；bty = 今年生日；nbd = 下一个生日）

```
with rs (bty) as (
    SELECT DATEADD(Year, DATEPART(Year, GETDATE()) - DATEPART(Year, dob), dob) as bty FROM Employees
),
rs2 (nbd) as (
  select case when bty < getdate() then DATEADD(yyyy, 1, bty) else bty end as nbd from rs
)
select nbd, DATEDIFF(d, getdate(), nbd) as diff from rs2 where DATEDIFF(d, getdate(), nbd) < 14 order by diff 
```

此版本避免了日期比较，可能会更快：

```
with rs (dob, bty) as (
    SELECT dob, DATEADD(Year, DATEPART(Year, GETDATE()) - DATEPART(Year, DOB), DOB) as bty FROM employee
),
rs2 (dob, nbd) as (
  select dob,  DATEADD(yyyy, FLOOR(ABS((-1*(SIGN(DATEDIFF(d, getdate(), bty))))+0.1)), bty) as nbd from rs
),
rs3 (dob, diff) as (
  select dob, datediff(d, getdate(), nbd) as diff from rs2
)
select dob, diff  from rs3 where diff < 14 order by diff 
```

如果范围涵盖明年的 2 月 29 日，则使用：

```
with rs (dob, ydiff) as (
  select dob, DATEPART(Year, GETDATE()) - DATEPART(Year, DOB) as ydiff from Employee
),
rs2 (dob, bty, ydiff) as (
  select dob, DATEADD(Year, ydiff, dob) as bty, ydiff from rs
),
rs3 (dob, nbd) as (
  select dob, DATEADD(yyyy, FLOOR(ABS((-1*(SIGN(DATEDIFF(d, getdate(), bty))))+0.1)) +  ydiff, dob) as nbd from rs2
),
rs4 (dob, ddiff, nbd) as (
  select dob, datediff(d, getdate(), nbd) as diff, nbd from rs3
)
select dob, nbd, ddiff from rs4 where ddiff < 68 order by ddiff 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2015-07-31T11:40:17.583

您还可以使用`DATEPART`：

```
-- To find out Today's Birthday
DECLARE @today DATETIME
SELECT  @today = getdate()

SELECT *
FROM SMIS_Registration 
WHERE (DATEPART (month, DOB) >= DATEPART (month, @today)
      AND DATEPART (day, DOB) = DATEPART (day, @today)) 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2016-09-22T11:30:08.457

选择 BirthDate,Name fromEmployees order by Case WHEN convert(nvarchar(5),BirthDate,101) > convert(nvarchar(5),GETDATE(),101) 然后 2 WHEN convert(nvarchar(5),BirthDate,101) < convert(nvarchar(5),GETDATE(),101) 然后 3 WHEN 转换(nvarchar(5),BirthDate,101) = convert(nvarchar(5),GETDATE(),101) 然后 1 else 4 end ,convert(nvarchar (2),出生日期,101),转换(nvarchar(2),出生日期,105)

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2018-09-12T16:07:47.883

下面的查询将返回员工的所有下一个生日，它是最短的查询。

```
SELECT 
    Employee.DOB,
    DATEADD(
                mm, 
                (
                    (
                        (
                            (
                                DATEPART(yyyy, getdate())-DATEPART(yyyy, Employee.DOB )
                            )
                            +
                            (
                                1-
                                (
                                    ((DATEPART(mm, Employee.DOB)*100)+DATEPART(dd, Employee.DOB))
                                    /
                                    ((DATEPART(mm, getdate())*100) + DATEPART(dd, getdate()))
                                )
                            )
                        )
                    *12
                    )
                ), 
                Employee.DOB
            ) NextDOB
FROM 
    Employee 
ORDER BY 
    NextDOB ; 
```

以上查询将涵盖下个月除当前日期外的所有内容。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2019-04-07T10:33:59.937

**SQLite3**的解决方案：

```
SELECT
    *, 
    strftime('%j', birthday) - strftime('%j', 'now') AS days_remaining
FROM
    person
WHERE :n_days >= CASE
    WHEN days_remaining >= 0 THEN days_remaining
    ELSE days_remaining + strftime('%j', strftime('%Y-12-31', 'now'))
    END
; 
```

除以 325.25 以获得年龄或将出生日期带到当年等的解决方案对我不起作用。它的作用是计算这两天的增量（1-366）。如果今年还没有生日，您会自动获得正确的剩余天数，您可以进行比较。如果生日已经过了，remaining_days 将为负数，你可以通过仍然添加当年的总天数来得到正确的剩余天数。这也正确处理闰年，因为在这种情况下，额外的一天也将被添加（通过使用 dayOfYear(Dec 31.)）

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2021-11-10T05:27:03.880

您可以将此查询用于今天的生日

```
select * 
from tableName
where DAY(convert(date,GETDATE(),105))=DAY(convert(date,DOB,105))
and month(convert(date,GETDATE(),105))=month(convert(date,DOB,105)) 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2021-12-29T23:07:20.747

这里我们需要 real 和 next 来比较它是否已经通过

```
CREATE FUNCTION dbo.FN_NEXT_BIRTHDAY(@BIRTHDAY DATE)
RETURNS DATE
AS
BEGIN
    DECLARE @ACTUAL DATE = DATEADD(YEAR, DATEDIFF(YEAR, @BIRTHDAY , GETDATE()), @BIRTHDAY);
    DECLARE @NEXT DATE = DATEADD(YEAR, DATEDIFF(YEAR, @BIRTHDAY , GETDATE())+1, @BIRTHDAY);

    RETURN CASE WHEN @ACTUAL > GETDATE() THEN @ACTUAL 
                ELSE @NEXT 
                END;
END; 
```

* * *

## 回答 #33

> 赞同：-1
> 
> 时间：2010-12-04T09:33:27.780

**试试我的解决方案...我有 Informix 数据库...**

```
SELECT person, year(today)-year(birthdate) as years, birthdate,

CASE
WHEN MOD(year(birthdate)+((year(today)-year(birthdate))+1),4)<>0 AND MONTH(birthdate)=2 AND DAY(birthdate)=29 THEN 
   CASE 
   WHEN mdy(month(birthdate), 28, year(birthdate)+((year(today)-year(birthdate))+1))-today >= 365 THEN (mdy(month(birthdate), 28, year(birthdate)+((year(today)-year(birthdate))+1))-today)-365
   WHEN mdy(month(birthdate), 28, year(birthdate)+((year(today)-year(birthdate))+1))-today < 365 THEN mdy(month(birthdate), 28, year(birthdate)+((year(today)-year(birthdate))+1))-today
   END
ELSE
   CASE 
   WHEN mdy(month(birthdate), day(birthdate), year(birthdate)+((year(today)-year(birthdate))+1))-today >= 365 THEN (mdy(month(birthdate), day(birthdate), year(birthdate)+((year(today)-year(birthdate))+1))-today)-365
   WHEN mdy(month(birthdate), day(birthdate), year(birthdate)+((year(today)-year(birthdate))+1))-today < 365 THEN mdy(month(birthdate), day(birthdate), year(birthdate)+((year(today)-year(birthdate))+1))-today
   END
END until

FROM table_name
WHERE mdy(month(birthdate), day(birthdate), 2000) >= mdy(month(today), day(today), 2000)
AND mdy(month(birthdate), day(birthdate), 2000) <= mdy(month(today), day(today), 2000)+30
OR
mdy(month(birthdate), day(birthdate), 2000) <= mdy(month(today), day(today), 2000)-(365-30)
ORDER BY 4, YEAR(birthdate) 
```

* * *

## 回答 #34

> 赞同：-1
> 
> 时间：2013-03-31T08:21:06.790

```
CREATE PROCEDURE [dbo].[P_EmployeesGetBirths]
        @Date Date,
        @Days int
    as
    Begin
        SET NOCOUNT ON;

        Declare
            @From int = Month(@Date) * 100 + Day(@Date),
            @To int = Month(DateAdd(DD, @Days, @Date)) * 100 + Day(DateAdd(DD, @Days, @Date)),
            @NeutralDate Date = Cast('1900-'+cast(Month(@Date) as nvarchar(2))+'-' + cast(Day(@Date) as nvarchar(2)) as Date)

        Select
            DOB,
            DATEADD(DD, DateDiff(DD, @NeutralDate, DateAdd(YY, 1900-Year(DOB), DOB)), @Date) OnDate
        From
            Employees(nolock)
        Where
            DOB is not null and
            Month(DOB) * 100 + Day(DOB) between @From and @To
        order by
            Month(DOB) * 100 + Day(DOB)
    End
    Go 
```

* * *

## 回答 #35

> 赞同：-1
> 
> 时间：2016-02-26T10:31:27.000

本月生日

```
SELECT * FROM tblMember m
WHERE m.GDExpireDate != '' 
AND CONVERT(CHAR(2),CONVERT(datetime, m.dob, 103), 101) = CONVERT(CHAR(2), GETDATE(), 101)    
AND CONVERT(CHAR(2),CONVERT(datetime, m.dob, 103), 103) >= CONVERT(CHAR(2), GETDATE(), 103) 
```

* * *

## 回答 #36

> 赞同：-2
> 
> 时间：2008-09-17T14:02:33.577

更好的是，将年份差异添加到生日日期，以制作今年的所有内容，然后进行比较

```
SELECT * FROM Employees WHERE
  DATEADD ( year, YEAR(@Today) - YEAR(@Birthday), birthday) BETWEEN @Today AND @EndDate 
```

# c# - 从大小为 n 的列表中找出哪些数字与另一个数字相加的算法

> ID：83547
> 
> 赞同：13
> 
> 时间：2008-09-17T14:00:40.053
> 
> 标签：c#, algorithm, math, np-complete

我有一个十进制数（我们称之为**目标**）和一个其他十进制数的数组（我们称之为数组**元素**），我需要从总和为目标的**元素中找到所有数字组合。**

我偏爱 C# (.Net 2.0) 中的解决方案，但无论如何最好的算法都可能获胜。

您的方法签名可能类似于：

```
public decimal[][] Solve(decimal goal, decimal[] elements) 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-17T15:00:49.207

有趣的答案。感谢您对维基百科的指点——虽然很有趣——但它们实际上并没有像我在寻找精确匹配时所说的那样解决问题——更多的是会计/账簿平衡问题，而不是传统的装箱/背包问题。

我一直在关注堆栈溢出的发展，并想知道它会有多大用处。这个问题出现在工作中，我想知道堆栈溢出是否可以比我自己编写更快地提供现成的答案（或更好的答案）。还要感谢建议将其标记为作业的评论-鉴于上述情况，我想这是相当准确的。

对于那些感兴趣的人，这是我使用递归的解决方案（自然）我也改变了对方法签名的想法，并选择 List> 而不是 decimal[][] 作为返回类型：

```
public class Solver {

    private List<List<decimal>> mResults;

    public List<List<decimal>> Solve(decimal goal, decimal[] elements) {

        mResults = new List<List<decimal>>();
        RecursiveSolve(goal, 0.0m, 
            new List<decimal>(), new List<decimal>(elements), 0);
        return mResults; 
    }

    private void RecursiveSolve(decimal goal, decimal currentSum, 
        List<decimal> included, List<decimal> notIncluded, int startIndex) {

        for (int index = startIndex; index < notIncluded.Count; index++) {

            decimal nextValue = notIncluded[index];
            if (currentSum + nextValue == goal) {
                List<decimal> newResult = new List<decimal>(included);
                newResult.Add(nextValue);
                mResults.Add(newResult);
            }
            else if (currentSum + nextValue < goal) {
                List<decimal> nextIncluded = new List<decimal>(included);
                nextIncluded.Add(nextValue);
                List<decimal> nextNotIncluded = new List<decimal>(notIncluded);
                nextNotIncluded.Remove(nextValue);
                RecursiveSolve(goal, currentSum + nextValue,
                    nextIncluded, nextNotIncluded, startIndex++);
            }
        }
    }
} 
```

如果您希望应用程序测试此功能，请尝试以下控制台应用程序代码：

```
class Program {
    static void Main(string[] args) {

        string input;
        decimal goal;
        decimal element;

        do {
            Console.WriteLine("Please enter the goal:");
            input = Console.ReadLine();
        }
        while (!decimal.TryParse(input, out goal));

        Console.WriteLine("Please enter the elements (separated by spaces)");
        input = Console.ReadLine();
        string[] elementsText = input.Split(' ');
        List<decimal> elementsList = new List<decimal>();
        foreach (string elementText in elementsText) {
            if (decimal.TryParse(elementText, out element)) {
                elementsList.Add(element);
            }
        }

        Solver solver = new Solver();
        List<List<decimal>> results = solver.Solve(goal, elementsList.ToArray());
        foreach(List<decimal> result in results) {
            foreach (decimal value in result) {
                Console.Write("{0}\t", value);
            }
            Console.WriteLine();
        }

        Console.ReadLine();
    }
} 
```

我希望这可以帮助其他人更快地得到他们的答案（无论是家庭作业还是其他）。

干杯...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T14:05:03.053

我认为你手头有一个[装箱问题](http://en.wikipedia.org/wiki/Bin_packing_problem)（这是 NP 难的），所以我认为唯一的解决方案是尝试所有可能的组合，直到找到一个可行的组合。

编辑：正如评论中指出的那样，您不必*总是*为遇到的每组数字*尝试*每种*组合*。但是，您提出的任何方法都有最坏情况下的数字集，您*必须*尝试*每种*组合 - 或者至少是随着集合大小呈指数增长的组合子集。

 ***否则，它不会是 NP 难的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T14:22:21.423

子集和问题以及稍微更一般的背包问题通过动态规划来解决：不需要对所有组合进行暴力枚举。请查阅 Wikipedia 或您最喜欢的算法参考。

尽管这些问题是 NP 完全的，但它们是非常“容易”的 NP 完全的。元素数量的算法复杂度低。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-17T14:05:21.820

您描述了一个[背包问题](http://en.wikipedia.org/wiki/Knapsack_problem)，唯一真正的解决方案是蛮力。有一些更快的近似解决方案，但它们可能不适合您的需求。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-17T16:44:13.250

虽然没有解决蛮力问题（正如其他人已经提到的那样），但您可能希望先对数字进行排序，然后检查剩下的可能数字（因为一旦通过 Sum 值，您就不能添加任何大于 Goal 的数字 -和）。

这将改变您实现算法的方式（为了只排序一次然后跳过标记的元素），但平均而言会提高性能。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2010-04-13T11:34:58.143

```
public class Logic1 {
    static int val = 121;
    public static void main(String[] args)
    {
        f(new int[] {1,4,5,17,16,100,100}, 0, 0, "{");
    }

    static void f(int[] numbers, int index, int sum, String output)
    {
        System.out.println(output + " } = " + sum);
        //System.out.println("Index value1 is "+index);
        check (sum);
        if (index == numbers.length)
        {
            System.out.println(output + " } = " + sum);
            return;
        }

        // include numbers[index]
        f(numbers, index + 1, sum + numbers[index], output + " " + numbers[index]);
        check (sum);
        //System.out.println("Index value2 is "+index);
        // exclude numbers[index]
        f(numbers, index + 1, sum, output);
        check (sum);
    }

    static void check (int sum1)
    {
        if (sum1 == val)
            System.exit(0);
    }
} 
```

# c# - 如何绑定到域服务器的登录以获得程序访问权限

> ID：83553
> 
> 赞同：1
> 
> 时间：2008-09-17T14:01:07.103
> 
> 标签：c#

我需要编写一个内部使用的程序，不同的用户在程序中将具有不同的能力。

我如何不让用户拥有新的用户名和密码，而是如何绑定到现有域服务器的登录系统？

假设 .NET（C#、VB、ASP 等）

-亚当

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T14:04:10.060

对于 WinForms，使用 System.Threading.Thread.CurrentPrincipal 和 IsInRole() 方法来检查它们属于哪些组。您确实需要先将 AppDomain 的主体策略设置为 WindowsPrincipal。

使用它来获取当前用户名：

```
private string getWindowsUsername()
{
    AppDomain.CurrentDomain.SetPrincipalPolicy(PrincipalPolicy.WindowsPrincipal);
    return Thread.CurrentPrincipal.Identity.Name;
} 
```

然后像这样检查一个角色：

```
if (Thread.CurrentPrincipal.IsInRole("Domain Users") == true)
{} 
```

在 ASP.NET 中，线程将属于 IIS，因此您应该

1.  将虚拟文件夹或网站设置为需要身份验证
2.  使用 Request.ServerVariables("LOGON_USER") 获取浏览器提供的用户名
3.  使用[DirectorySearcher](http://msdn.microsoft.com/en-us/library/system.directoryservices.directorysearcher.aspx)类查找用户组

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T14:04:36.067

我会使用 LDAP

和 DirectorySearcher 类：

[http://msdn.microsoft.com/en-us/library/system.directoryservices.directorysearcher.aspx](http://msdn.microsoft.com/en-us/library/system.directoryservices.directorysearcher.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T14:06:50.867

假设这是通过 IIS 提供的，我会告诉 IIS 通过域进行身份验证，但我会在应用程序本身中保留授权（用户关联的角色、可访问的功能等）。

您可以通过以下方式检索用于身份验证的用户名

```
Trim(Request.ServerVariables("LOGON_USER")).Replace("/", "\").Replace("'", "''") 
```

或者

```
CStr(Session("User")).Substring(CStr(Session("User")).LastIndexOf("\") + 1) 
```

# asp.net - 如何知道给定的客户端启动脚本是否已经在 asp.net 页面中注册？

> ID：83558
> 
> 赞同：1
> 
> 时间：2008-09-17T14:01:29.583
> 
> 标签：asp.net, startupscript

我有一个 asp.net 页面，想知道“script1”是否已经注册为启动脚本？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-17T14:02:00.130

Me.ClientScript.IsStartupScriptRegistered("clientScript")

# algorithm - 是否有生成二维凹壳的有效算法？

> ID：83593
> 
> 赞同：66
> 
> 时间：2008-09-17T14:04:45.880
> 
> 标签：algorithm, geometry, 2d, gis, concave-hull

从 GIS 文件（城市地图）中获得一组（2D）点，我需要生成定义该地图（其边界）的“轮廓”的多边形。它的输入参数将是点集和“最大边长”。然后它将输出相应的（可能是非凸的）多边形。

到目前为止，我发现的最佳解决方案是生成 Delaunay 三角形，然后删除比最大边长更长的外部边。在所有外部边缘都比这短之后，我只需删除内部边缘并获得我想要的多边形。问题是，这非常耗时，我想知道是否有更好的方法。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-17T14:24:59.340

我们实验室的一位前学生在他的博士论文中使用了一些适用的技术。我相信其中之一被称为“阿尔法形状”，并在以下论文中被引用：

[http://www.cis.rit.edu/people/faculty/kerekes/pdfs/AIPR_2007_Gurram.pdf](http://www.cis.rit.edu/people/faculty/kerekes/pdfs/AIPR_2007_Gurram.pdf)

该论文提供了一些您可以参考的进一步参考资料。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-02-15T10:19:45.437

[本文](http://www.geosensor.net/papers/duckham08.PR.pdf)讨论了**简单多边形的高效生成，用于表征平面中一组点的形状，**并提供了算法。[这里](http://www.geosensor.net/phpws/index.php?module=pagemaster&PAGE_user_op=view_page&PAGE_id=13)还有一个使用相同算法的 Java 小程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T14:39:44.453

[这里](http://ubicomp.algoritmi.uminho.pt/local/concavehull.html)的人声称已经开发出ak最近邻方法来确定一组点的凹壳，其行为“在点的数量上几乎呈线性”。可悲的是，他们的论文似乎受到了很好的保护，您必须向[他们](http://repositorium.sdum.uminho.pt/handle/1822/6429)索取。

这是一[组很好的参考资料](http://www.comp.leeds.ac.uk/ontology/FOGI-WS/statements/Antony-Galton.pdf)，其中包括上述内容，可能会引导您找到更好的方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-01-29T15:40:02.747

对于其他人来说，答案可能仍然很有趣：一个人可能会应用**行进平方算法的变体**，应用（1）在凹壳内，（2）然后在（例如 3）不同的**尺度上**，我取决于平均密度点。比例尺必须是彼此的整数倍，这样您就可以构建一个可用于有效采样的网格。这允许快速找到空样本=正方形，完全在点的“集群/云”内的样本，以及介于两者之间的样本。后一类然后可以用来容易地确定代表凹壳的一部分的折线。

在这种方法中，一切都是线性的，不需要三角测量，它不使用 alpha 形状，并且与此处描述的商业/专利产品不同 ( [http://www.concavehull.com/](http://www.concavehull.com/) )

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T14:25:20.837

一个快速的近似解决方案（也适用于凸包）是找到每个东西向的小元素的南北边界。

根据您想要多少细节，创建一个固定大小的上限/下限数组。对于每个点，计算它所在的 EW 列，然后更新该列的上限/下限。处理完所有点后，您可以为那些错过的列插入上/下点。

对于非常长的薄形状并决定是否将 NS 或 Ew 分类，也值得事先快速检查。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-17T14:37:14.677

好问题！我根本没有尝试过，但我的第一个镜头是这种迭代方法：

1.  创建一个集合 N（“不包含”），并将集合中的所有点添加到 N。
2.  从 N 中随机选取 3 个点，形成一个初始多边形 P。将它们从 N 中移除。
3.  使用[一些多边形点算法](http://en.wikipedia.org/wiki/Point_in_polygon)并查看 N 中的点。对于 N 中的每个点，如果它现在包含在 P 中，则将其从 N 中删除。一旦在 N 中找到仍然不包含在 P 中的点，继续执行第 4 步。如果 N 为空，则完成。
4.  将找到的点称为 A。在 P 中找到最靠近 A 的线，并在中间添加 A。
5.  返回第 3 步

我认为只要它表现得足够好，它就会起作用——对你最初的 3 点进行一个好的启发式可能会有所帮助。

祝你好运！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-17T14:42:29.160

一个简单的解决方案是绕着多边形的边缘走动。给定连接点 P0 和 P1 的边界的当前边，边界 P2 上的下一个点将是具有最小可能 A 的点，其中

```
H01 = bearing from P0 to P1
H12 = bearing from P1 to P2
A = fmod( H12-H01+360, 360 )
|P2-P1| <= MaxEdgeLength 
```

然后你设置

```
P0 <- P1
P1 <- P2 
```

并重复，直到你回到你开始的地方。

这仍然是 O(N^2) 所以你需要对你的点列表进行一点排序。如果您对点进行排序，例如，它们与城市质心的方位角，您可以限制每次迭代时需要考虑的点集。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-02-18T23:01:09.123

您可以使用此插件在 QGIS 中进行操作； [https://github.com/detlevn/QGIS-ConcaveHull-Plugin](https://github.com/detlevn/QGIS-ConcaveHull-Plugin)

根据您需要它与数据交互的方式，可能值得在这里查看它是如何完成的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-11-29T18:14:11.540

作为广泛采用的参考，PostGIS 从凸包开始，然后将其嵌入，您可以在此处查看。

[https://github.com/postgis/postgis/blob/380583da73227ca1a52da0e0b3413b92ae69af9d/postgis/postgis.sql.in#L5819](https://github.com/postgis/postgis/blob/380583da73227ca1a52da0e0b3413b92ae69af9d/postgis/postgis.sql.in#L5819)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-02-13T22:06:17.457

Bing Maps V8 交互式 SDK 在高级形状操作中具有凹壳选项。

[https://www.bing.com/mapspreview/sdkrelease/mapcontrol/isdk/advancedshapeoperations?toWww=1&redig=D53FACBB1A00423195C53D841EA0D14E#JS](https://www.bing.com/mapspreview/sdkrelease/mapcontrol/isdk/advancedshapeoperations?toWww=1&redig=D53FACBB1A00423195C53D841EA0D14E#JS)

在 ArcGIS 10.5.1 中，3D Analyst 扩展模块具有最小边界体积工具，其几何类型包括凹壳、球体、包络或凸壳。它可以在任何许可级别使用。

这里有一个凹壳算法：[https ://github.com/mapbox/concaveman](https://github.com/mapbox/concaveman)

# wcf - WCF DataContracts 和基础数据结构

> ID：83604
> 
> 赞同：13
> 
> 时间：2008-09-17T14:05:34.927
> 
> 标签：wcf, data-access

我想知道通过 WCF 服务公开哪些对象有意义 - 我应该将 WCF 序列化规范添加到我的业务实体，还是应该实现一个转换器，将我的业务实体映射到我想通过我的 WCF 公开的 DataContracts服务？

现在我有不同级别的实体：DataAccess、Business 和 Contract。我有转换器可以将实体从 DataAccess 映射到 Business，从 Business 映射到 Contract，反之亦然。实施和维护这些非常耗时且非常乏味。与此相关的最佳实践是什么？

如果我使用的是诸如 NHibernate 或实体框架之类的 OR/M，我应该直接从 ORM 中公开实体，还是应该像现在一样抽象它们？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-17T14:27:20.177

一般来说，我认为从最佳实践的角度来看，您不应该将业务对象的结构公开为数据合约，而是定义“特定于数据合约的”类并将业务转换为合约。它可能需要额外的工作，但从关注点分离和保护变化的角度来看，额外的工作可能是值得的。

Microsoft 模式和实践“[服务工厂建模版”](http://www.codeplex.com/servicefactory)实现了这一点，还提供了自动生成业务 <=> 合同转换器类的工具——它是一个出色的 VS 插件，也代表了 Microsoft 的 WCF 最佳实践。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-17T14:27:26.650

我通常不会通过网络公开我的业务/数据实体，因为我喜欢遵守单一责任原则 (srp)。为了解释，创建数据实体以映射到底层关系 (db) 模型。所以他们应该“改变”的唯一原因是关系模型的改变，就是这样。

当您暴露这些实体以便它们可以越线时，它们有两个目的。这可能看起来有点矫枉过正，但它让事情变得更清洁和透明......这会产生更简单的设计。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T17:05:16.310

还需要考虑的一点是，我同意这种分离，但它通常会导致“翻译器”或一些这样的代码将数据从 DTO 复制到业务实体。这就是像 AutoMapper ( [http://automapper.org/](http://automapper.org/) ) 这样的库真正派上用场的地方，并且不需要编写翻译层。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-08T16:47:58.030

只是添加到上述答案：Web 服务公开的对象称为数据传输对象 (DTO)。拥有一个 DTO 来映射您的业务实体对象 (BEO) 是很好的，因为它在您的 Web 服务和 Web 服务背后的实际实现/逻辑之间提供了分离。

最后，这里介绍了如何装饰 DTO，以便当它被 WSDL 公开时，名称反映了它所代表的实际对象（而不是 objectNameDTO 或类似的丑陋的东西）。

```
//Business Entity
class Person
{
   public string Name{ get; set; }
   public int Age{ get; set; }
}

//Data transfer object
[DataContract(Name="Person")] //<-- this is what makes the WSDL look nice and clean
class PersonDTO
{
   [DataMember(Name = "Name", Order = 0)]
   public string Name{ get; set; }
   [DataMember(Name = "Age", Order = 1)]
   public int Age{ get; set; }
} 
```

# c++ - C++ 是否在 std::set、std::map 等的恒定时间内执行 begin/end/rbegin/rend？

> ID：83640
> 
> 赞同：8
> 
> 时间：2008-09-17T14:09:20.237
> 
> 标签：c++, stl

对于像 std::set 和 std::map 这样的数据类型，在对数时间内进行查找，是否需要实现来维护开始和结束迭代器？访问开始和结束是否意味着可能在对数时间内发生的查找？

我一直认为开始和结束总是在恒定的时间内发生，但是我在 Josuttis 中找不到任何证实。现在我正在做一些我需要对性能保持冷静的事情，我想确保覆盖我的基础。

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-17T14:16:45.430

它们发生在恒定的时间。我正在查看 ISO/IEC 14882:2003 标准的第 466 页：

**表 65 - 容器要求**

a.开始（）； *（恒定的复杂性）*

a.end(); *（恒定的复杂性）*

**表 66 - 可逆容器要求**

a.rbegin(); *（恒定的复杂性）*

a.rend(); *（恒定的复杂性）*

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-17T14:12:05.347

是的，根据[http://www.cplusplus.com/reference/stl/，begin](http://www.cplusplus.com/reference/stl/) ()、end() 等都是 O(1)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-17T14:13:37.730

在 C++ 标准中，23.1（容器要求）中的表 65 将 begin() 和 end() 列为需要恒定时间。如果您的实现违反了这一点，则它不符合要求。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-17T14:14:45.590

只看代码，在这里你可以看到 GNU libstdc++ 中 std::map 中的迭代器

[`std::map`](http://en.cppreference.com/w/cpp/container/map)

你会看到所有 end rend cend ... 都是在恒定时间内实现的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T14:58:55.530

不过要小心 hash_map 。begin() 不是恒定的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T14:14:55.230

对于 std::set

开始：常量，结束：常量，rbegin：常量，rend：常量，

对于 std::map

它们也是恒定的（全部）

如果您有任何疑问，请查看[www.cplusplus.com](http://www.cplusplus.com)

# c# - if + 可空类型的简写 (C#)

> ID：83653
> 
> 赞同：7
> 
> 时间：2008-09-17T14:11:23.617
> 
> 标签：c#, conditional-operator

以下返回

> 无法确定条件表达式的类型，因为 'double' 和 '<null>' 之间没有隐式转换

```
aNullableDouble = (double.TryParse(aString, out aDouble) ? aDouble : null) 
```

* * *

我不能只使用 aNullableBool 而不是使用 aDouble 往返的原因是因为 aNullableDouble 是生成的 EntityFramework 类的属性，它不能用作 out par。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-17T14:13:28.433

```
aNullableDouble = double.TryParse(aString, out aDouble) ? (double?)aDouble : null; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-17T14:14:28.977

只需将语法吹成完整的语法而不是速记......它会更容易阅读：

```
aNullableDouble = null;
if (double.TryParse(aString, out aDouble))
{
    aNullableDouble = aDouble;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T14:42:57.597

使用可空类型的一个有趣的副作用是您不能真正使用速记 IF。速记 IF 必须从两个条件返回相同的类型，并且在任何一种情况下都不能为空。所以，投射或写出来:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T14:13:07.870

```
aNullableDouble = (double.TryParse(aString, out aDouble)?new Nullable<double>(aDouble):null) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T14:15:11.143

.NET 支持可为[空的类型](http://msdn.microsoft.com/en-us/library/1t3y8s4s.aspx)，但是通过这样声明它们，您必须对它们进行一些不同的处理（可以理解，现在通常是值类型的东西有点像引用）。

如果您最终不得不在可空双精度和常规双精度之间进行太多转换，这也可能无济于事......就像自动生成的一组类很容易发生的情况一样。

# graphics - 体积粒子

> ID：83673
> 
> 赞同：6
> 
> 时间：2008-09-17T14:13:55.640
> 
> 标签：graphics, 3d, effects

我正在玩弄体积粒子的想法。我所说的“体积”并不是指每个粒子的实际 3D 模型——通常它更昂贵且更难与其他粒子混合。我的意思是看起来尽可能接近体积的二维粒子。现在我/我们尝试的是带有额外局部 Z 纹理（例如球形）的粒子，我们根据 alpha 值和 Z 的接近度的组合来进行 alpha 透明度，这通过粒子不有一个平面 Z。我认为一个很酷的添加是与照明（以及阴影）的交互，但这里的问题是照明公式看起来如何（考虑到透明度，让'

我也想添加法线，所以我实际上可以挤入两个纹理：

*   漫反射和 Alpha 纹理。
*   正常和 256 级精度 Z 通道纹理。

我问这个问题是为了看看可以考虑哪些其他方向，并就可能使用的适当照明方程获得您的想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T14:22:34.293

听起来您在询问有关模拟[参与介质](http://www.cescg.org/CESCG-2000/SMaierhofer/node6.html)的技术的信息：“参与介质可能会吸收、发射和/或散射光。最简单的参与介质只吸收光。这意味着通过介质的光会衰减，具体取决于介质的密度。”

以下是[一些示例图像](http://graphics.ucsd.edu/~henrik/images/parti.html)和 Frisvad、Christensen、Jensen 的[SIGGRAPH 2007 论文](http://graphics.ucsd.edu/~henrik/papers/lorenz_mie_theory/)（[包括 PDF](http://graphics.ucsd.edu/~henrik/papers/lorenz_mie_theory/computing_scattering_properties_using_lorenz_mie_theory.pdf)）的链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T00:26:18.783

一篇关于使用球形广告牌来表示体积效果的好论文：

[http://www.iit.bme.hu/~szirmay/firesmoke_link.htm](http://www.iit.bme.hu/~szirmay/firesmoke_link.htm)

但是，不处理参与的媒体。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-19T16:07:37.420

请参阅[体积渲染](http://en.wikipedia.org/wiki/Volume_rendering)和[体素](http://en.wikipedia.org/wiki/Voxel)。

# ruby-on-rails - 混合 ActiveRecord 查找条件

> ID：83674
> 
> 赞同：10
> 
> 时间：2008-09-17T14:14:12.800
> 
> 标签：ruby-on-rails, ruby, activerecord

我想在某些名称列表中查找 created_on >= some date AND name 组合的记录。

对于 ">=" 我必须使用 sql 条件。对于“IN”，我必须使用条件哈希，其中键是 :name，值是名称数组。

有没有办法将两者结合起来？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-09-17T14:20:40.257

您可以在 rails 2.1 及更高版本中使用命名范围

```
Class Test < ActiveRecord::Base
  named_scope :created_after_2005, :conditions => "created_on > 2005-01-01"
  named_scope :named_fred, :conditions => { :name => "fred"}
end 
```

那么你可以做

```
Test.created_after_2005.named_fred 
```

或者你可以给 named_scope 一个允许你传入参数的 lambda

```
Class Test < ActiveRecord::Base
  named_scope :created_after, lambda { |date| {:conditions => ["created_on > ?", date]} }
  named_scope :named, lambda { |name| {:conditions => {:name => name}} }
end 
```

那么你可以做

```
Test.created_after(Time.now-1.year).named("fred") 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-17T17:47:46.140

如果您使用的是旧版本的 Rails，Honza 的查询很接近，但您需要为置于 IN 条件中的字符串添加括号：

```
Person.find(:all, :conditions => ["created_at > ? AND name IN (?)", date, names]) 
```

使用 IN 可能是一个混合包：整数最快，字符串列表最慢。如果您发现自己只使用一个名称，请务必使用等号运算符：

```
Person.find(:all, :conditions => ["created_at > ? AND name = ?", date, name]) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-24T14:57:07.200

named_scopes 最酷的地方在于它们也适用于集合：

```
class Post < ActiveRecord::Base
  named_scope :published, :conditions => {:status => 'published'}
end

@post = Post.published

@posts = current_user.posts.published 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-17T14:39:02.910

有关 named_scopes 的更多信息，请参阅[Ryan 的公告](http://ryandaigle.com/articles/2008/3/24/what-s-new-in-edge-rails-has-finder-functionality)和[有关 named_scopes 的 Railscast](http://railscasts.com/episodes/108)

```
class Person < ActiveRecord::Base
  named_scope :registered, lambda { |time_ago| { :conditions => ['created_at > ?', time_ago] } }
  named_scope :with_names, lambda { |names| { :conditions => { :names => names } } }
end 
```

如果要将变量传递给作用域，则必须使用 lambda。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-05-01T02:33:29.277

您可以链接`where`子句：

`Person.where(name: ['foo', 'bar', 'baz']).where('id >= ?', 42).first`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-17T15:09:03.807

已经提出的命名范围非常好。经典的方法是：

```
names = ["dave", "jerry", "mike"]
date = DateTime.now
Person.find(:all, :conidtions => ["created_at > ? AND name IN ?", date, names]) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T04:11:45.640

我想我要么使用简单的 AR finders 要么[Searchgasm](http://www.binarylogic.com/2008/9/1/searchgasm-released)。

# ios - 如何在 UILabel 中显示替代密码字符？

> ID：83687
> 
> 赞同：8
> 
> 时间：2008-09-17T14:15:05.107
> 
> 标签：ios, objective-c

我需要显示一个`UITableView`包含用户的帐户凭据。为此，我使用`UILabels`in `UITableViewCell`。当我显示他们的密码时，我显然只想显示一个占位符密码字符而不是他们的实际密码，类似于将`UITextField`其设置为安全文本输入模式时。事实上，我想使用与使用相同的字符`UITextField`，而不是“*”。

我的问题是，`UITextField`当它处于安全模式时，密码字符的字符代码是什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-02-16T01:03:57.007

这是一种方法，例如，在 Prototype Cell 的 detailTextLabel 中显示“点缀”的密码：

```
// self.password is your password string
NSMutableString *dottedPassword = [NSMutableString new];

for (int i = 0; i < [self.password length]; i++)
{
    [dottedPassword appendString:@"●"]; // BLACK CIRCLE Unicode: U+25CF, UTF-8: E2 97 8F
}

cell.detailTextLabel.text = dottedPassword; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-17T14:24:22.523

为什么不直接使用 UITextField，使字段不可编辑并更改边框样式以使其看起来像 UILabel？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T07:32:37.560

密码字符可能是子弹。在 Mac 上，option-8 将在您输入的任何位置插入一个。Character Palette 显示它是 Unicode **2022**和 UTF8 **E2 80 A2**。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-08-16T15:34:31.630

在 iOS 10 中，黑圈 Unicode 字符不再与安全文本字段一致。要使用的字符是⦁“Z NOTATION SPOT”（U+2981）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-04-10T17:10:50.363

虽然是一个非常古老的问题，但我遇到了同样的问题。benzado 有正确的想法，虽然我认为 Unicode 应该是[25cf](http://www.fileformat.info/info/unicode/char/25cf/index.htm)。在我看来，这正是苹果在安全 UITextField 中使用的点。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-05-31T10:40:11.520

在 Swift 3 中，您可以使用：

```
passwordLabel.text = String(password.characters.map { _ in return "•" }) 
```

# html - 修复 IE6 布局错误的策略？

> ID：83696
> 
> 赞同：7
> 
> 时间：2008-09-17T14:15:43.903
> 
> 标签：html, internet-explorer-6

一般来说，解决 IE6 中的布局错误的最佳方法是什么？在试图弄清楚为什么您的页面突然看起来像猴子编码时，应该寻找哪些最常见的错误或问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-17T14:21:42.220

## 第一件事

获得[Internet Explorer 开发人员工具栏](http://www.microsoft.com/en-us/download/details.aspx?id=18359)。这是一个救命稻草，适用于 IE6 和/或 IE7。它不能替代 Web Developer Toolbar 或 Firefox 的 Firebug，但总比没有好。

## 认识你的敌人

阅读 IE 的怪癖——尤其是[hasLayout](http://www.satzansatz.de/cssd/onhavinglayout.html)和[溢出](http://www.positioniseverything.net/explorer/expandingboxbug.html)等。还有许多 CSS 细节，你要么[不做，](http://wordpress.com/tag/max-width-not-working-in-ie6/)要么找到[替代品](http://www.seopher.com/articles/ie6_min_max_width_hack)。看看有多少流行的 JavaScript[工具包](http://dojotoolkit.org/)/[框架](http://mootools.net/)/[库](http://jquery.com/)可以解决不同的[问题](http://xlib.wordpress.com/2006/04/12/bug-fix-select-box-displayed-through-dynamic-div-in-internet-explorer/)。

## 罗马不是一天建成的

您使用它的次数越多，您就会记住越多，并且不必经常查找。这方面的经验是无可替代的。不过，正如一些人指出的那样，网络上有大量资源。 [位置就是一切](http://www.positioniseverything.net/)，肯定在那里。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-17T14:19:23.067

[http://www.positioniseverything.net/](http://www.positioniseverything.net/)肯定会解决您的问题。

它提供了对浏览器错误的全面而深入的描述以及解决这些错误的选项。在我看来，必须阅读，

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T14:20:01.023

开始了解 IE 如何破坏页面的一种好方法是使用 CSS ( `border: 1px solid red;`) 在不同元素上打开红色边框。这将立即告诉您是边距问题还是填充问题，元素的*实际*宽度等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T14:19:18.637

盒子模型通常是罪魁祸首。基本上，这意味着您尝试定位和使用不受支持的 CSS 的任何 div 都会导致此问题。

如果您使用 min-{width,height} 或 max-{width,height}，您可能会发现它会发生。

这为检查与不同版本的兼容性提供了很好的参考。

[http://www.aptana.com/reference/html/api/CSS.index.html](http://www.aptana.com/reference/html/api/CSS.index.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-12-30T20:44:23.470

注意到 Marc 的帖子是 -2 =D。他只是说“求助于表格”，尽管它们很糟糕，因为在像 IE6 这样的糟糕浏览器中，一些损坏的 CSS 命令只能在表格中工作（谁知道这就是为什么......你该死的比尔盖茨！！！）。这是一个很好的参考，可以了解就 CSS 而言哪些有效，哪些无效。 [http://www.quirksmode.org/css/contents.html](http://www.quirksmode.org/css/contents.html) . 这是一个很好的参考，可以检查哪些很酷的效果在各种广泛使用的浏览器中有效/无效。此外，始终为使用 IE6 浏览的用户制定一个首选计划（即使它与机械污垢一样古老），因为许多企业仍在使用旧版浏览器（包括非营利组织/第三世界国家等）所以无论如何，创建一个看起来比标准水平菜单更好的下拉菜单，但创建一个专门为 IE6 的辅助菜单，当页面接收到来自 IE6 浏览器的请求时，它成为默认菜单。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T14:32:13.397

一个常见的问题是填充没有被添加到块元素的宽度中。所以对于布局 div，避免使用填充，而是使用其中的元素来定义填充。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T14:34:39.177

当我需要调整 IE/Standards 浏览器之间的差异时，我会使用[Rafel Lima 的浏览器选择器。](http://rafael.adm.br/css_browser_selector)它大大减少了在 HTML 中使用“hacks”来解决常见问题。

您可以针对不同的浏览器，甚至不同版本的浏览器（Hello IE 6）定位 CSS 语句。它实现起来非常简单，但需要用户打开 JavaScript（大多数都这样做）。

。事物 { ....}

.ie .thing { ....}

.ie6 .thing { ....}

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T14:20:45.390

你如何定义布局错误？IE 中最令人沮丧的布局实现（我不知道这是否应该被定义为错误）是我们需要始终在 HTML <form> 标签中指定*style="display:inline"*以便不会出现空行扰乱表单布局。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T14:21:43.937

我认为这个问题的范围太大了。

验证您的代码，如果疼痛仍然存在，那么祝您好运。

与任何其他球场错误类型一样，唯一真正的解决方案是谷歌寻找解决方案，或询问知道的人，（即：在 stackoverflow 向我们提供确切的问题）。

您可以使用 IE Dev 工具栏来收集一个想法，但许多错误是随机的、莫名其妙的和深奥的。IE：断头台错误、随机项目重复错误等等，不胜枚举，你可以花几个小时在任何地方用愚蠢的变量胡闹，却一无所获。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-17T14:27:59.927

我有一个简单的策略，每次都有效。

首先，我使用普遍接受的 CSS 开发网站，使其在 Safari 和 Firefox 3 中看起来不错。有关浏览器支持的详细信息，请参见[w3schools.com 。](http://www.w3schools.com/css)

然后，我进入 IE6 和 IE7 并使用[条件包含](http://msdn.microsoft.com/en-us/library/ms537512.aspx)更改 CSS 。

这是免费的，可让您处理不同的浏览器（IE6 和 IE7 有不同的问题）。

您会发现大多数问题来自 IE 中不受支持的功能（例如最小宽度）、框模型中的错误（IE 向某些框添加了看不见的额外填充 (3px)）或定位问题。先去找那些，因为它们通常是问题所在。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-09-17T14:20:13.517

我们有一个浮动 div 问题，该问题仅在特定版本的 IE6 中很明显。它已通过下载最新的服务包修复。

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2008-09-17T14:22:58.643

理论上，使用与 IE6 布局错误兼容的 CSS，仅使用众所周知的解决方法（css 和 html 过滤器）并以不会破坏前向兼容性的方式为它们编写代码，测试 quirks/strict 模式。

实际上，请使用桌子。

# slickedit - 任何用于创建 Visual Slick 宏的好资源？

> ID：83699
> 
> 赞同：0
> 
> 时间：2008-09-17T14:15:56.943
> 
> 标签：slickedit

有谁知道任何用于创建 Visual Slick 宏的好资源？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T14:51:38.373

我将从SlickEdit 宏的[官方社区论坛开始。](http://community.slickedit.com/index.php?board=4.0)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-10T07:36:24.587

After the community forum - I would find the macros directory and go to town looking at all the .e files. Depending on what you want to do - there is a lot of samples in the actual implementation (just the same way I would do it for emacs).

For example, many years ago I wanted to have something like 'project-load' (dialog that lets you open from all files in the project) but instead of project files - let me open any of the currently checked-out files (not just open, but also diff etc), went and found the project-load source and used that as a sample on implementing a similar dialog

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-14T19:29:54.490

这是一个很好的资源。我[在这里写了我的第一个](http://blog.slickedit.com/2010/04/lets-make-a-macro-part-1-outputting-debug-values/)

# solid-principles - 到底是谁的责任？

> ID：83709
> 
> 赞同：2
> 
> 时间：2008-09-17T14:16:55.523
> 
> 标签：solid-principles, single-responsibility-principle

在我正在编写的应用程序中，我有一个 Policy 类。有 4 种不同类型的策略。每个策略都根据其他策略加权，例如 PolicyA > PolicyB > PolicyC > PolicyD。

谁负责执行逻辑来确定一个策略是否大于另一个？我最初的想法是重载 > 和 < 运算符并在 Policy 类型本身中实现逻辑。

这是否违反 SRP？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-17T14:18:26.393

我认为 PolicyComparer 类应该进行评估。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T14:34:29.210

你想要一个 PolicyComparator 类。如果您想覆盖 < 和 >，那很好，但是在 Policy 基类中进行覆盖，并让这些实现利用 PolicyComparator 来完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T14:21:39.317

我认为您在过载的情况下走在正确的轨道上，但是扩展显然要长得多

如果 (A > B || B > C || C > D) ...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T14:24:05.880

您还可以在您的类中存储一个 PolicyWeight 属性，它是一个简单的内置类型（int、unsigned int、...），然后可以很容易地进行比较。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T14:24:37.813

Certianly 是一个专门的比较器类。如果您需要提供额外的逻辑（例如，有两种或三种不同的策略比较方式），这种方法可以让您更加灵活（通过运算符重载无法实现）。

# php - 在电子邮件验证中允许 user@example 或 user@localhost？

> ID：83723
> 
> 赞同：2
> 
> 时间：2008-09-17T14:18:56.237
> 
> 标签：php, email, web-applications

我正在进行电子邮件验证检查，我们需要决定是否允许将 user@localhost 和 user@example（注意没有 .anything）验证为有效的电子邮件地址。这适用于一个开源项目，该项目在大型 Web 和 Intranet 上都有许多用例。

[RFC 2822](http://www.ietf.org/rfc/rfc2822.txt)（互联网消息格式标准）允许它，但[RFC 2821](http://www.ietf.org/rfc/rfc2821.txt)（SMTP 标准）说它应该失败。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-15T21:30:09.367

我会禁用它。很少有组织使用内部域，而那些通常使用“acme.localhost”或“intranet.com”或其他类似名称的组织。他们使用 DNS 进行某种配置以使其正常工作。

无论如何，内部电子邮件几乎已经死了：随着即时消息、Twitter 和 SMS 的出现以及公司每个成员的外部电子邮件可用性的增加，您几乎完全有可能永远不会获得无 TLD 的域在一封电子邮件中。

对于确实需要它的人，他们总是可以自己调整正则表达式，因为他们足够精明，可以设置自定义主机名来处理内部电子邮件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T14:22:18.457

这取决于您的应用程序。如果你认为你的几个用户会有一个电子邮件@localhost，你不介意。然后去吧。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T14:22:21.360

让它成为一个可配置的选项，这样人们就可以自己决定。我个人*默认*它是失败的，因为我还没有遇到过一个案例——内联网或公共互联网——我让有人使用了有效的 user@localhost 类型的地址。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T16:57:17.680

看看这个，您似乎需要两个详细的快速检查：

```
<?php 
function valid_email($email) { 
    // First, we check that there's one @ symbol, and that the lengths are right 
    if (!ereg("^[^@]{1,64}@[^@]{1,255}$", $email)) { 
     // Email invalid because wrong number of characters in one section, or wrong number of @ symbols.
     return false; 
    }

    // take a given email address and split it into the username and domain. 
    list($userName, $mailDomain) = split("@", $email); 
    if (checkdnsrr($mailDomain, "MX")) { 
        // this is a valid email domain! 
        return true;
    } 
    else { 
        // this email domain doesn't exist!
        return false;
    }
} 
?> 
```

（[来源 1](http://www.sitepoint.com/article/users-email-address-php/)，[来源 2](http://www.phpit.net/code/valid-email/)）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T14:22:33.793

好吧，如果您有 DNS 在内部工作，您总是可以只进行 DNS 查找。

但是，如果使用 SMTP 会失败，那么我建议确保您不包含它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T14:24:29.873

我见过 user@localhost 形式的电子邮件地址，通常是在查看邮件列表的存档时，并且管理员在同一台机器上托管和发布。所以它肯定会发生 - 我承认它打破了我的解析程序！所以现在我对电子邮件地址更加灵活了。

# x86 - 你会从 DOS 挂起什么中断来获取实时时钟

> ID：83728
> 
> 赞同：4
> 
> 时间：2008-09-17T14:19:24.237
> 
> 标签：x86, interrupt, assembly

你会从 DOS 挂起什么中断来获取实时时钟？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T14:40:59.613

实时时钟不能产生中断。它（也许仍然是）与 cmos-ram 耦合，因为它由电池缓冲。它只能通过端口 0x70 和 0x71 访问。

但是，您可以挂钩 PIT（可编程中断定时器）的中断。那是中断0x08（例如硬件IRQ0）。据我记得，dos 将中断配置为每秒调用约 27 次。您也可以将其编程为其他频率，但这会使 dos-clock 有点混乱（端口 0x40 和 0x43）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T13:01:48.940

[http://www.control.com/thread/1026238869](http://www.control.com/thread/1026238869)对此有一些信息。Hook int 08h（别忘了重新调度它）；每 55 毫秒调用一次。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T14:31:34.677

阅读[英特尔 8259](http://en.wikipedia.org/wiki/Intel_8259)系列可编程中断控制器。据此，它是中断 8（主）和 112（从）。这是一份关于 8259A 的技术文档：[http://pdos.csail.mit.edu/6.828/2008/readings/hardware/8259A.pdf](http://pdos.csail.mit.edu/6.828/2008/readings/hardware/8259A.pdf)

# logging - 从多个服务器聚合多个日志文件的最佳方法

> ID：83741
> 
> 赞同：40
> 
> 时间：2008-09-17T14:21:39.910
> 
> 标签：logging, log4j, monitoring, distributed

我需要一种简单的方法来监视分布在多个 HP-UX 服务器上的多个文本日志文件。它们是来自多个分布式遗留系统的文本和 XML 日志文件的混合体。目前我们只是通过 ssh 连接到服务器并使用*tail -f*和*grep*，但是当您有很多日志要跟踪时，这并不能扩展。

由于日志的格式不同，并且只是文件夹中的文件（当它们达到一定大小时自动旋转），我需要远程收集它们并以不同的方式解析每个文件。

我最初的想法是创建一个简单的守护进程，我可以在每台服务器上运行它，使用针对每种文件类型的自定义文件阅读器将其解析为可以通过套接字通过网络导出的通用格式。另一个本地运行的查看器程序将连接到这些套接字，并在一些简单的选项卡式 GUI 中显示已解析的日志或聚合到控制台。

如果我要以这种方式实现它，我应该尝试转换成什么日志格式？

还有其他更简单的方法吗？我应该尝试将日志文件转换为 log4j 格式以与[Chainsaw](http://logging.apache.org/chainsaw/)一起使用，还是有更好的日志查看器可以连接到远程套接字？我可以按照[另一个日志问题](https://stackoverflow.com/questions/18632/how-to-monitor-a-text-file-in-realtime#18690)中的建议使用[BareTail](http://www.baremetalsoft.com/baretail/)吗？这不是一个[大规模分布式系统](https://stackoverflow.com/questions/35292/log-files-in-massively-distributed-systems)，更改所有应用程序的当前日志记录实现以使用 UDP 广播或将消息放在 JMS 队列上不是一种选择。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2010-08-13T17:36:32.480

实时日志监视的最轻量级的解决方案可能是在并发模式下使用[Dancer 的 shell和 tail -f：](http://www.netfort.gr.jp/~dancer/software/dsh.html.en)

```
dsh -Mac -- tail -f /var/log/apache/*.log 
```

*   -a 适用于您在 ~/.dsh/machines.list 中定义的所有机器名称
*   -c 用于tail的并发运行
*   -M 将主机名添加到每一行输出。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-02T19:02:31.307

我们使用一个简单的 shell 脚本，如下所示。显然，您必须对其进行一些调整以告诉它不同的文件名并决定在哪个框上查找，但您会得到基本的想法。在我们的例子中，我们在多个盒子的同一位置跟踪一个文件。这需要通过存储的密钥进行 ssh 身份验证，而不是输入密码。

```
#!/bin/bash
FILE=$1
for box in box1.foo.com box2.foo.com box3.foo.com box4.foo.com; do
     ssh $box tail -f $FILE &
done 
```

关于 Mike Funk 关于无法用 ^C 终止拖尾的评论，我将上述内容存储在一个名为 multitails.sh 的文件中，并将以下内容附加到它的末尾。这将创建一个 kill_multitails.sh 文件，您在完成拖尾后运行该文件，然后它会自行删除。

```
# create a bash script to kill off 
# all the tails when you're done
# run kill_multitails.sh when you're finished

echo '#!/bin/sh' > kill_multitails.sh
chmod 755 kill_multitails.sh
echo "$(ps -awx | grep $FILE)" > kill_multitails_ids
perl -pi -e 's/^(\d+).*/kill -9 $1/g' kill_multitails_ids
cat kill_multitails_ids >> kill_multitails.sh
echo "echo 'running ps for it'" >> kill_multitails.sh
echo "ps -awx | grep $FILE" >> kill_multitails.sh
echo "rm kill_multitails.sh" >> kill_multitails.sh
rm kill_multitails_ids

wait 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-12T12:26:16.520

[Logscape](http://www.logscape.com "原木景观") - 就像没有价格标签的 splunk

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T12:41:50.423

选项：

1.  使用 SocketAppender 将所有日志直接发送到 1 个服务器。（这可能会严重影响性能并增加单点故障。）
2.  使用脚本聚合数据。我使用 scp、ssh 和身份验证密钥来允许我的脚本在没有任何登录提示的情况下从所有服务器获取数据。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-09T16:29:16.380

[多尾](http://www.ubuntugeek.com/multitail-view-multiple-logfiles-windowed-on-console.html) 或

" [chip](https://github.com/katzgrau/chip/blob/master/README.md)是一款面向系统管理员和开发者的本地和远程日志解析和监控工具。
它把 swatch、tee、tail、grep、ccze 和 mail 的功能封装成一个，并带有一些附加功能"

例如。

芯片 -f -m0='RUN' -s0='red' -m1='.*' -s1 user1@remote_ip1:'/var/log/log1 /var/log/log2 /var/log/log3 user2@remote_ip2 :'/var/log/log1 /var/log/log2 /var/log/log3'' | egrep "运行 |==> /"

这将以红色突出显示 -m0 模式的出现，从所有日志文件中预先过滤 'RUN |==> /' 模式。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-02-14T09:37:04.677

我正是为此目的编写了 vsConsole——轻松访问日志文件——然后添加了应用程序监控和版本跟踪。想知道您对此有何看法。[http://vs-console.appspot.com/](http://vs-console.appspot.com/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-17T15:00:15.840

Awstats 提供了一个 perl 脚本，可以将多个 apache 日志文件合并在一起。这个脚本可以很好地扩展，因为内存占用非常低，日志文件永远不会加载到内存中。我知道这并不完全是您所需要的，但也许您可以从这个脚本开始并根据您的需要进行调整。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-01-15T05:58:43.633

您可以使用 Chainsaw 提供的各种接收器（VFSLogFilePatternReceiver 通过 ssh、SocketReceiver、UDPReceiver、CustomSQLDBReceiver 等跟踪文件），然后通过更改默认选项卡标识符或通过提供创建“自定义表达式日志面板”将日志聚合到单个选项卡中与各种源选项卡中的事件匹配的表达式。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-06-25T07:47:25.167

gltail - 使用来自多个服务器的 Ruby、SSH 和 OpenGL 实时可视化服务器流量、事件和统计信息

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-02-15T13:52:15.667

用于 Java 的[XpoLog](http://www.xpolog.com)

# c# - 如何从 webhandler 中的全局类访问自定义字段？

> ID：83749
> 
> 赞同：2
> 
> 时间：2008-09-17T14:22:25.820
> 
> 标签：c#, asp.net

我在 global.asax.cs 中的全局类中添加了一些自定义字段（公共布尔值），这些字段在 Application_Start 事件期间被初始化。如何在 webhandler (ashx) 中访问它们？还是将它们保存在应用程序状态对象中更好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T14:34:27.383

您可能需要将类作为 Global.asax.cs 的类型而不是它继承的类型来访问。

我相信将 Application State 对象用于应用程序范围的变量更为常见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T18:59:29.400

你试过 ((global)Application).PublicBooleanField 吗？

# frameworks - 语义网框架

> ID：83752
> 
> 赞同：11
> 
> 时间：2008-09-17T14:22:38.380
> 
> 标签：frameworks, semantic-web

有哪些语义网络框架，每个框架的优点/缺点是什么？我已经广泛使用了[Jena](http://jena.sourceforge.net/)，并且简要介绍了[Sesame](http://www.openrdf.org/)。还有其他我应该考虑的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-16T00:51:07.690

[Redland](http://librdf.org/)是一个很好的 RDF 框架（就像 Andreas 所说的那样）。我主要使用它的 Python 绑定，并通过 MacPorts 将它安装在 Mac OS X 上（例如，port install redland-bindings +python）。

您也可以将它与其他语言一起使用（参见它对 Perl、Ruby 等的绑定）。

有关指向更大的 RDF 框架列表的指针，请参阅[语义 Web 常见问题解答：工具](http://www.w3.org/2001/sw/SW-FAQ#tools)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-18T11:06:33.380

一个更底层的方法是[redland](http://librdf.org/)，它提供对许多语言的绑定，比如 Perl、PHP、Python 和 Ruby。redland 本身是用 C 编写的。我在 ruby​​ 中使用它编写了脚本，以提供带有 rdf 后端而不是经典数据库的简单 web 服务。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-15T21:00:20.567

[http://www.cubicweb.org](http://www.cubicweb.org)是一个用 Python 编写的语义网络框架。它可用于开发为人类和计算机提供内容的应用程序，为每个应用程序提供所需的格式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T14:49:47.253

这个问题可能与[what-are-some-good-java-rdf-libraries有关](https://stackoverflow.com/questions/73445/what-are-some-good-java-rdf-libraries)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-22T00:16:33.883

如果您正在研究 Microsoft 技术堆栈，我肯定会看看[Intellidimensions产品。](http://www.intellidimension.com/)

他们有一个成熟的基于 SQL Server 的框架，用于存储和处理（使用规则）语义 Web 数据。他们还有一个很棒的 .NET SDK，我已经广泛使用了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-14T18:12:58.917

如果您使用 Java，并且对 OWL 推理感兴趣，您应该查看[Pellet](http://pellet.owldl.com)。它绑定到 Jena 和[OWL-API](http://owlapi.sourceforge.net/)，它本身就是一个有用的 semweb 框架。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-23T15:41:26.913

到目前为止，我见过的最以 Web 为中心的是[RAP（RDF API for PHP）。](http://www4.wiwiss.fu-berlin.de/bizer/rdfapi/)

# python - 如何以编程方式启用/禁用网络接口？(Windows XP)

> ID：83756
> 
> 赞同：13
> 
> 时间：2008-09-17T14:22:56.647
> 
> 标签：python, networking, windows-xp

我需要从 Windows XP 中的脚本完全启用/禁用网络接口。我正在寻找一个 python 解决方案，但任何通用方式（例如 WMI、一些命令行 à la netsh、一些 Windows 调用）都是受欢迎的，并且会进行调整。谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-17T19:20:31.907

使用 netsh 接口 Usage set interface [name = ] IfName [ [admin = ] ENABLED|DISABLED [connect = ] CONNECTED|DISCONNECTED [newname = ] NewName ]

尝试在外括号内包含所有内容： netsh interface set interface name="thename" admin=disabled connect=DISCONNECTED newname="thename"

另请参阅此 MS KB 页面： http: [//support.microsoft.com/kb/262265/](http://support.microsoft.com/kb/262265/) 您可以遵循他们的任何建议。要禁用适配器，您需要确定引用硬件设备的方法。如果计算机上没有多个具有相同名称的适配器，您可能会关闭接口的描述（或 PCI ID 工作良好）。之后，使用 devcon（禁用|启用）。Devcon 是设备管理器的附加控制台界面。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-17T15:14:44.963

到目前为止，我找到了以下 Python 解决方案：

```
>>> import wmi; c=wmi.WMI()
>>> o=c.query("select * from Win32_NetworkAdapter where NetConnectionID='wifi'")[0]
>>> o.EnableDevice(1)
(-2147217407,) 
```

它被翻译为 AFAIU 为通用 WMI 错误 0x80041001。可能是权限。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-11-30T18:34:44.407

我在互联网上找到了这个 .VBS 脚本。它有一个很酷的优势，即在我无法让 NETSH 用于此目的的机器上实际工作。

```
Const ssfCONTROLS = 3 

sConnectionName = "Local Area Connection" 

sEnableVerb = "En&able" 
sDisableVerb = "Disa&ble" 

set shellApp = createobject("shell.application") 
set oControlPanel = shellApp.Namespace(ssfCONTROLS) 

set oNetConnections = nothing 
for each folderitem in oControlPanel.items 
  if folderitem.name = "Network Connections" then 
        set oNetConnections = folderitem.getfolder: exit for 
end if 
next 

if oNetConnections is nothing then 
msgbox "Couldn't find 'Network Connections' folder" 
wscript.quit 
end if 

set oLanConnection = nothing 
for each folderitem in oNetConnections.items 
if lcase(folderitem.name) = lcase(sConnectionName) then 
set oLanConnection = folderitem: exit for 
end if 
next 

if oLanConnection is nothing then 
msgbox "Couldn't find '" & sConnectionName & "' item" 
wscript.quit 
end if 

bEnabled = true 
set oEnableVerb = nothing 
set oDisableVerb = nothing 
s = "Verbs: " & vbcrlf 
for each verb in oLanConnection.verbs 
s = s & vbcrlf & verb.name 
if verb.name = sEnableVerb then 
set oEnableVerb = verb 
bEnabled = false 
end if 
if verb.name = sDisableVerb then 
set oDisableVerb = verb 
end if 
next 

'debugging displays left just in case... 
' 
'msgbox s ': wscript.quit 
'msgbox "Enabled: " & bEnabled ': wscript.quit 

'not sure why, but invokeverb always seemed to work 
'for enable but not disable. 
' 
'saving a reference to the appropriate verb object 
'and calling the DoIt method always seems to work. 
' 
if bEnabled then 
' oLanConnection.invokeverb sDisableVerb 
oDisableVerb.DoIt 
else 
' oLanConnection.invokeverb sEnableVerb 
oEnableVerb.DoIt 
end if 

'adjust the sleep duration below as needed... 
' 
'if you let the oLanConnection go out of scope 
'and be destroyed too soon, the action of the verb 
'may not take... 
' 
wscript.sleep 1000 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T14:40:45.683

除了 RAS API 之外，我似乎在 MSDN 上找不到任何用于控制接口的基本 API，但我认为它们不适用于非拨号连接。正如您自己建议的那样，netsh 可能是一种选择，据说它也有一个编程接口：http: [//msdn.microsoft.com/en-us/library/ms708353 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms708353(VS.85).aspx)

如果你想成为纯 Python，你也许可以打开一组管道与 netsh 进程进行通信。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T14:26:31.833

[devcon](http://support.microsoft.com/kb/311272)工具可以控制网卡，但不能直接控制接口。它是设备管理器小程序的命令行版本。

```
devcon disable (id or portion of name)
devcon enable (id or portion of name) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T14:35:20.890

这是 VB.Net

```
Dim objectQuery As New ObjectQuery("SELECT * FROM Win32_NetworkAdapter WHERE NetConnectionId IS NOT NULL")
         Dim searcher As New ManagementObjectSearcher(scope, objectQuery)
         Dim os As ManagementObject
         Dim moColl As ManagementObjectCollection = searcher.Get()
         Dim _list As String = ""
         For Each os In moColl
             Console.WriteLine(os("NetConnectionId"))
         Next os 
```

这将获得您计算机上的所有接口。然后你可以做 netsh 来禁用它。

> netsh 接口设置接口禁用

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T14:52:35.407

您可能需要使用 WMI。这可以作为一个很好的起点：http: [//msdn.microsoft.com/en-us/library/aa394595.aspx](http://msdn.microsoft.com/en-us/library/aa394595.aspx)

# asp.net - 将 CalendarExtender 动态添加到 Textbox 子类服务器控件？

> ID：83770
> 
> 赞同：2
> 
> 时间：2008-09-17T14:24:21.917
> 
> 标签：asp.net, asp.net-ajax, textbox, calendar, custom-server-controls

我正在尝试创建一个从 TextBox 继承的服务器控件，它将自动附加一个[CalendarExtender 。](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/Calendar/Calendar.aspx)是否可以这样做，或者我的新控件是否需要从 CompositeControl 继承？我已经尝试过前者，但我不清楚应该在控件生命周期的哪个部分创建 CalendarExtender 的新实例，以及应该将它添加到哪个控件集合中。我似乎无法将它添加到 Page 或 Form 的控件集合中，如果我将它添加到 (TextBox) 控件的集合中，我将得不到任何弹出日历功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T14:40:33.767

我不久前在一个项目中完成了这一点。为此，我创建了一个包含 TextBox 和 CalendarExtender 的 CompositeControl。

在`CreateChildControls`CompositeControl 的方法中，我使用与此类似的代码：

```
TextBox textbox = new TextBox();
textbox.ID = this.ID + "Textbox";
textbox.Text = this.EditableField.TextValue;
textbox.TextChanged += new EventHandler(HandleTextboxTextChanged);
textbox.Width = new Unit(100, UnitType.Pixel);
CalendarExtender calExender = new CalendarExtender();
calExender.PopupButtonID = "Image1";
calExender.TargetControlID = textbox.ID;
this.Controls.Add(textbox);
this.Controls.Add(calExender); 
```

当然要确保包含这个 CompositeControl 的表单有一个工具包脚本管理器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-12T20:07:07.803

我知道这是一个旧线程，但是当我有类似的问题时，我遇到了它。这就是我最终实现的，并且效果很好。如果您希望控件成为 TextBox，则只需在调用 Render 期间抽出扩展程序。

```
Imports System.Web.UI.WebControls
Imports AjaxControlToolkit

Public Class DateTextBox
    Inherits TextBox

    Private _dateValidator As CompareValidator
    Private _calendarExtender As CalendarExtender

    Protected Overrides Sub OnInit(ByVal e As System.EventArgs)
        MyBase.OnInit(e)

        _dateValidator = New CompareValidator
        With _dateValidator
            .ControlToValidate = ID
            Rem set your other properties
        End With
        Controls.Add(_dateValidator)

        _calendarExtender = New CalendarExtender
        With _calendarExtender
            .TargetControlID = ID
        End With
        Controls.Add(_calendarExtender)
    End Sub

    Protected Overrides Sub Render(ByVal writer As System.Web.UI.HtmlTextWriter)
        MyBase.Render(writer)
        _dateValidator.RenderControl(writer)
        _calendarExtender.RenderControl(writer)
    End Sub
End Class 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-07T08:53:22.767

您可以轻松地在自定义服务器控件中添加 ajax 日历。您需要在应用程序中添加两个引用。1\. AjaxControlToolkit.dll 2\. System.Web.Extensions 在第二个参考的帮助下，我们将在您的自定义服务器控件中获得“CalendarExtender”的所有属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-02-20T10:03:43.510

当您尝试不允许用户在文本框中键入任何内容，但只能由日历扩展器填充，然后您尝试从文本框控件获取选定日期时，如果您已将文本框属性设置为 ReadOnly，则它可能是空字符串=“真”。

这是因为只读控件不会发回服务器。解决方法如下：

protected void Page_Load(object sender, EventArgs e)

{

TextBox1.Attributes.Add("readonly", "readonly");

}

希望能帮助到你。

# c# - 是否有任何为 C# 编写的模糊搜索或字符串相似函数库？

> ID：83777
> 
> 赞同：69
> 
> 时间：2008-09-17T14:24:48.873
> 
> 标签：c#, .net, string, comparison

有类似的问题，但与我可以在源代码中使用的 C# 库无关。

感谢大家的帮助。

我已经看到了 lucene，但是我需要一些更容易搜索类似字符串并且没有索引部分开销的东西。

我标记的答案有两个非常简单的算法，一个也使用LINQ，所以它很完美。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-09-17T14:38:51.443

Levenshtein 距离实现：

*   [使用 LINQ](http://www.dotnetperls.com/levenshtein)（不是真的，请参阅评论）
*   [不使用 LINQ](http://web.archive.org/web/20110720094521/http://www.merriampark.com/ldcsharp.htm)

我有一个 .NET 1.1 项目，我在其中使用后者。它很简单，但非常适合我的需要。据我记得它需要一些调整，但没有什么不明显的。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-07-08T02:04:03.210

您还可以查看名为 Sam's String Metrics 的令人印象深刻的库[https://github.com/StefH/SimMetrics.Net](https://github.com/StefH/SimMetrics.Net)。这包括许多算法。

*   汉明距离
*   莱文斯坦距离
*   Needleman-Wunch 距离或卖方算法
*   史密斯-沃特曼距离
*   Gotoh 距离或 Smith-Waterman-Gotoh 距离
*   街区距离或L1距离或城市街区距离
*   蒙格埃尔坎距离
*   Jaro 距离度量
*   雅罗·温克勒
*   SoundEx 距离指标
*   匹配系数
*   骰子系数
*   Jaccard 相似度或 Jaccard 系数或 Tanimoto 系数
*   重叠系数
*   欧几里得距离或 L2 距离
*   余弦相似度
*   变分距离
*   海灵格距离或巴塔查亚距离
*   信息半径（Jensen-Shannon 散度）
*   谐波平均值
*   偏差散度
*   混淆概率
*   陶
*   Fellegi 和 Sunters (SFS) 指标
*   TFIDF 或 TF/IDF
*   快速A
*   爆破
*   最大匹配
*   q-gram
*   Ukkonen 算法

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2011-05-28T01:42:25.017

它们不是我自己的发明，但它们是我的最爱，我刚刚在博客上发布了关于它们的博客，并在名为[“查找模糊字符串的四个函数”的博客文章中发布了我自己的 Dice Coefficient、Levenshtein Distance、Longest Common Subsequence 和 Double Metaphone 的调整版本C# Extensions 中的匹配项](http://www.tsjensen.com/blog/post/2011/05/27/Four+Functions+For+Finding+Fuzzy+String+Matches+In+C+Extensions.aspx)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-17T14:33:15.360

你看过[Lucene.net](http://incubator.apache.org/lucene.net/)吗？它是 Java Lucene 搜索引擎 API 到 .Net 平台的一个端口。该库提供了很多搜索功能。大约一年前我玩过它，所以不要将我的建议视为基于大量经验。*我在Windows Developer Power Tools*一书中看到了它，并将其用于试驾。您可以查看他们的[API 文档](http://incubator.apache.org/lucene.net/)，看看它是否提供了您正在寻找的模糊搜索之类的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T14:35:14.417

此[代码项目论文](http://www.codeproject.com/KB/recipes/improvestringsimilarity.aspx)具有使用[Levenshtein distance](http://en.wikipedia.org/wiki/Levenshtein_distance)的字符串相似度函数。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-17T14:37:04.523

有以下 Levenshtein 距离算法，它为两个字符串的相似性分配一个值（实际上是差异），可用于构建：[http ://www.merriampark.com/ldcsharp.htm](https://web.archive.org/web/20060616180103/http://merriampark.com:80/ldcsharp.htm)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T14:28:09.567

[Beagle Project](http://beagle-project.org/Main_Page) for Linux 是用 c# (mono) 编写的，是一个类似于 google-desktop 的搜索工具。它可能有一些用于这些字符串匹配的代码。

如果我没记错的话，它使用[Lucene](http://en.wikipedia.org/wiki/Lucene)库来搜索和检索数据。也许这对您的项目也有用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T16:26:57.800

我使用“C# 中的三元搜索树字典”（[http://www.codeproject.com/KB/recipes/tst.aspx](http://www.codeproject.com/KB/recipes/tst.aspx)）来搜索类似的字符串。

问候，帕特里西奥

# pivot-table - 如何以编程方式快速构建临时查询？

> ID：83779
> 
> 赞同：2
> 
> 时间：2008-09-17T14:24:54.427
> 
> 标签：pivot-table, adhoc-queries

我使用 Excel 数据透视表来分析数据库中的数据，因为它允许我非常快速地“切片和切块”。由于我们知道数据库表中有什么，我们都可以编写 SQL 查询来完成数据透视表的工作。

但我想知道为什么数据透视表可以如此快速地构建查询，而它对数据以及我们给它的数据字段之间的含义/关系*一无所知？*

换句话说，我们如何才能以如此快速有效的方式构建*临时SQL 查询？*（“当然，使用数据透视表！”，是的，但我想要的是一种编程方式）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T14:28:20.470

只需根据需要操纵您的订单和组子句。

Excel 速度很快，因为所有数据都在内存中，并且可以快速高效地进行排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T21:36:39.820

@Mark Ransom 肯定会使用 Excel 将数据保存在内存中的概念，使其计算速度更快。Excel 也有可能以使其比您的数据库更具响应性的方式预先索引数据集。

为什么它更快有一个重要的、非算法的可能性：在数据透视表的使用中，Excel 没有连接的概念。当您从数据库中获取临时数据时，表之间的任何连接或关联都会导致进一步的查找、扫描、索引加载等。由于 Excel 将所有数据都放在一个位置（RAM 或没有），它可以无需预先形成数据集即可执行查找。如果您要将数据库数据加载到临时表中，那么看看针对该表的即席查询如何在性能方面与 Excel 叠加起来会很有趣。

不过有一点是肯定的：尽管数据库是生成准确报告的优秀工具，但传统规范化的数据库对于即席查询来说远不如最佳选择。因为规范化的数据结构将完整性放在首位（如果我可以冒昧的话），它们牺牲了特别优化，以牺牲所有数据的合理性为代价。尽管这是一个糟糕的示例，但请考虑以下规范化模式：

```
+--------+ +---------+
|tbl用户| |lu性别|
+--------+ +---------+
|用户名 | |性别ID |
|性别ID||性别|
+--------+ +---------+

从 luGenders 中选择 *；
> 1 名女性
> 2 男

```

在这个例子中，如果我们想知道系统中女性/男性用户的数量，数据库将需要处理连接并做出相应的行为（同样，这是一个糟糕的例子，因为连接数量和数量很少可能的值，通常应该带来一些数据库引擎优化）。但是，如果您要将这些数据转储到 Excel，您仍然会在提取数据时受到一些数据库损失，但实际上在 Excel 中旋转数据会相当快。可能是您认为 Excel 比直接的临时查询更快的想法错过了这种预先固定成本惩罚的概念，但我没有要评论的数据。

然而，最切题的一点是，虽然通用数据库有利于准确性，但它们通常会吸收临时报告。要生成临时报告，通常需要以更可查询的结构对数据进行去规范化（“仓库”）。查找有关数据仓库的信息将在该主题上提供很多好的结果。

故事的寓意：拥有一个完全算法的、快速的临时查询系统是一个了不起的理想，但在空间和时间限制（内存和人时）的情况下并不实用。要有效地生成临时系统，您确实需要了解数据的用例，然后有效地对其进行非规范化。

我强烈推荐[The Data Warehouse Toolkit](https://rads.stackoverflow.com/amzn/click/com/0471200247)。郑重声明，我不是 DBA，我只是一个卑微的分析师，每周花费 80 小时处理 Excel 和 Oracle。我知道你的痛苦。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T14:55:54.133

我的直觉告诉我，答案与数据透视表大纲有关，它具有*固定*数量的区域，即：

```
- the Page Fields zone  
- the Column Fields zone  
- the Row Fields zone and
- the Data zone 
```

在我的疯狂猜测中：

```
- The Page zone builds the WHERE part of the ad-hoc query.  
- The Column zone will put whichever fields drag-dropped to it in the GROUP BY clause.  
- The Row zone will build a SELECT DISTINCT <field names>
- The Data zone will apply an AGGREGATE function to the field drag-dropped to it. 
```

当我们将字段拖到这些区域时，您认为“幕后”会发生什么？

# java - 如何获取在java中创建的日期图片

> ID：83787
> 
> 赞同：10
> 
> 时间：2008-09-17T14:25:29.450
> 
> 标签：java, date

我想提取创建 jpg 文件的日期。Java 具有 File 对象的 lastModified 方法，但似乎不支持从文件中提取创建日期。我相信信息存储在文件中，因为我在 Win XP 中将鼠标指针悬停在文件上时看到的日期与在 DOS 中使用带有“dir / TC”的 JNI 获得的日期不同。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-17T14:32:26.467

[信息以称为EXIF](http://en.wikipedia.org/wiki/Exchangeable_image_file_format)或[链接文本](http://www.exif.org)的格式存储在图像中。有几个库可以读取这种格式，比如[这个](http://www.drewnoakes.com/code/exif/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-17T14:27:34.950

日期存储在jpeg中的[EXIF数据中。](http://en.wikipedia.org/wiki/Exif)Java中有一个[Java库](http://www.drewnoakes.com/code/exif/)和一个[查看器](http://sourceforge.net/projects/jexifviewer/)可能会有所帮助。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-17T14:30:41.637

我使用这个元数据库：[http ://www.drewnoakes.com/code/exif/](http://www.drewnoakes.com/code/exif/)

似乎工作得很好，但请记住，并非所有 JPEG 图像都有此信息，因此它不能 100% 万无一失。

如果 EXIF 元数据不包含创建日期，那么您可能不得不使用 Java 的 lastUpdated - 除非您想求助于 Runtime.exec(...) 并使用系统函数来查找（我不会不过不推荐这个！）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T14:28:23.310

您可能需要一些东西来访问[exif](http://en.wikipedia.org/wiki/Exchangeable_image_file_format)数据。谷歌建议[这个库](http://www.drewnoakes.com/code/exif/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T14:38:01.057

下面的代码示例询问用户文件路径，然后输出创建日期和时间：

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class Main {

    public static void main(final String[] args) {
        try {
            // get runtime environment and execute child process
            Runtime systemShell = Runtime.getRuntime();
            BufferedReader br1=new BufferedReader(new InputStreamReader(System.in));
            System.out.println("Enter filename: ");
            String fname=(String)br1.readLine();
            Process output = systemShell.exec("cmd /c dir /a "+fname);
             // open reader to get output from process
            BufferedReader br = new BufferedReader (new InputStreamReader(output.getInputStream()));

            String out="";
            String line = null;

            int step=1;
             while((line = br.readLine()) != null ) 
              {
                 if(step==6)
                {
                out=line;
                }
                 step++;
                 }          // display process output

            try{
            out=out.replaceAll(" ","");
            System.out.println("CreationDate: "+out.substring(0,10));
            System.out.println("CreationTime: "+out.substring(10,15));
            }
            catch(StringIndexOutOfBoundsException se)
            {
                System.out.println("File not found");
            }
            }
          catch (IOException ioe){ System.err.println(ioe); }
          catch (Throwable t) { t.printStackTrace();}
    }
} 
```

# oracle - 如何在 Oracle 中找到命名约束的定义？

> ID：83807
> 
> 赞同：20
> 
> 时间：2008-09-17T14:27:20.927
> 
> 标签：oracle

我只知道约束的名称（`SYS_C003415`），但我想看看它的定义。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-09-17T14:27:53.513

看起来我应该查询`ALL_CONSTRAINTS`。

```
select OWNER, CONSTRAINT_NAME, CONSTRAINT_TYPE, TABLE_NAME, SEARCH_CONDITION from ALL_CONSTRAINTS where CONSTRAINT_NAME = 'SYS_C003415'; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-02-24T05:26:49.120

使用以下查询在 oracle 中获取约束的定义：

```
Select DBMS_METADATA.GET_DDL('CONSTRAINT', 'CONSTRAINT_NAME') from dual 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-20T14:51:52.893

另一种选择是对 DDL 进行逆向工程......

```
DBMS_METADATA.GET_DDL('CONSTRAINT', 'SYS_C003415') 
```

这里有一些例子......

[http://www.psoug.org/reference/dbms_metadata.html](http://www.psoug.org/reference/dbms_metadata.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T14:30:20.123

或者查看所有约束使用 SYS.DBA_CONSTRAINTS （如果你有权限）

# visual-studio - Home 键转到 Visual Studio 中的行首？

> ID：83808
> 
> 赞同：20
> 
> 时间：2008-09-17T14:27:24.810
> 
> 标签：visual-studio, key, keyboard-shortcuts

Visual Studio 中的选项在哪里使 Home 键转到行首？

现在你必须做

`Home`,`Home`

或者

`Home`, `Ctrl`+`Left Arrow`

我宁愿家在线路的起点。我以前看过，但现在找不到了。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-09-17T14:30:46.097

在工具/自定义/键盘中，将“Home”键从 Edit.LineStart”重新分配给“Edit.LineFirstColumn”

**由 OP 编辑​​：**您必须将**Scope**更改为**Text Editor**才能工作。

* * *

**视觉工作室 2010**

Visual Studio 2010 删除了*“范围”*选项。相反，您需要*“使用新的快捷方式”*选项：

![在此处输入图像描述](https://i.stack.imgur.com/Zzvz0.png)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-19T20:29:50.763

在 MSDN 论坛上提出同样的问题：

TaylorMichaelL 说：

> 您感兴趣的命令是 Edit.LineFirstColumn。 **您需要将范围更改为文本编辑器。** 您应该首先删除与该命令关联的任何现有快捷键。如果您不更改范围，则 Home 键将不起作用。然后尝试使用 Home 键。它应该工作。
> 
> 迈克尔·泰勒 - 2008 年 9 月 18 日 [http://p3net.mvps.org](http://p3net.mvps.org)

**将范围**更改为**文本编辑器**是拼图中缺失的部分。

*   转到工具/自定义/键盘
*   将范围更改为“**文本编辑器**”。
*   将“Home”键从**Edit.LineStart**重新分配给**Edit.LineFirstColumn**

# c# - .NET 有函数式编程库吗？

> ID：83840
> 
> 赞同：14
> 
> 时间：2008-09-17T14:30:24.477
> 
> 标签：c#, .net, functional-programming

例如，在 Java 中有[Functional Java](http://functionaljava.org/)和[Higher-Order Java](http://www.cs.chalmers.se/~bringert/hoj/)。两者本质上都提供了一个小的 API，用于操作高阶、柯里化函数，也许还有一些新的数据类型（元组、不可变列表）。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2016-08-02T20:29:34.940

LanguageExt 看起来**很有**希望让 C# 中的函数式编程更容易。

[https://github.com/louthy/language-ext](https://github.com/louthy/language-ext)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-17T14:35:33.497

你看过[F#](http://research.microsoft.com/fsharp/fsharp.aspx)吗？

[这里](http://geekswithblogs.net/akraus1/articles/79880.aspx)还有一篇简洁的博客文章，讨论如何使用 c# 3.0 中内置的新泛型 / lambda 表达式。

如果您只是将 using System.Linq 添加到源文件的顶部，则会添加很多不错的新功能来处理集合，例如折叠/过滤/等。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-11-12T10:19:47.247

假设您出于某种原因不能使用 F#，而只想在 C# 代码中使用函数式范例和习语来提高质量和可靠性：

[C# 的功能样式模式匹配](http://patternmatching.codeplex.com/)

[C#/.Net 的 Monad 库](http://sharpmalib.codeplex.com/)

还有[“提升”](http://elevate.codeplex.com/)，它有一些功能性的东西，比如选项类型（也许）等。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-17T14:31:07.237

我想你想要[F#](http://research.microsoft.com/fsharp/fsharp.aspx)

此外，最新版本的 C# 在基础语言中包含许多功能概念。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-17T14:33:12.253

可能有这样一个 C# 库，但您可能应该考虑只使用 F# [http://research.microsoft.com/fsharp/fsharp.aspx](http://research.microsoft.com/fsharp/fsharp.aspx)和[http://msdn.microsoft.com/en-us/fsharp/default .aspx](http://msdn.microsoft.com/en-us/fsharp/default.aspx)。

Microsoft 计划使 F# 成为 Visual Studio 中的一流语言，因此使用其中一个 CTP 构建初始内容的风险应该很小。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-17T14:33:58.337

如果您正在寻找扩展 C# 的东西，那么没有，但是有 F#，它是一种基于 .NET 的函数式语言。从“关于 F#”[页面](http://research.microsoft.com/fsharp/about.aspx)：

> F# 是用于 .NET Framework 的类型化函数式编程语言。它将类型化函数式编程的简洁性、表达性和组合性与 .NET 的运行时支持、库、互操作性、工具和对象模型相结合。F# 源自 ML 语言家族，具有与 OCaml 兼容的核心语言，但也借鉴了 C# 和 Haskell。F# 从一开始就被设计为 .NET 上的一等公民，提供与其他 .NET 语言的流畅互操作性。例如，C# 和 F# 可以直接相互调用。这意味着 F# 可以立即访问所有 .NET Framework API，例如，包括 Windows Presentation Foundation 和 DirectX。同样，在 F# 中开发的库也可以从其他 .NET 语言中使用。
> 
> 由于 F# 和 OCaml 共享相似的核心语言，一些 OCaml 库和应用程序可以直接交叉编译，也可以通过少量的条件编译更改进行交叉编译。这提供了交叉编译和/或将现有 OCaml 代码移植到 .NET 的路径，还允许程序员在这些语言之间转移技能。该项目的一个主要重点是将类似 OCaml 的语言的范围扩展到传统上未使用它们的领域。在整个项目中，F# 的设计者感谢 Xavier Leroy 和 OCaml 社区中其他人的支持和鼓励。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-18T16:12:19.183

本身不是一个收缩包装的库，但 Microsoft 的 Luca Bolognese 有[一系列博客文章](http://blogs.msdn.com/lucabol/archive/2008/04/01/a-c-library-to-write-functional-code-part-i-background.aspx)，他在其中构建了一个用于函数式编程的 C# 库，其中包含元组、记录、类型联合等类型：

此外，Linq 基本上是一个在 C# 中具有语法支持的函数式编程库。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-05T15:25:01.567

查看[http://code.msdn.microsoft.com/FunctionalCSharp](http://code.msdn.microsoft.com/FunctionalCSharp)获取一些示例。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T14:31:29.513

F#，微软提供了一个 CTP 版本。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-12-06T15:22:26.533

另一个要考虑的选择是[FuncSharp](https://github.com/siroky/FuncSharp)。它不像 LanguageExt 那么重，它确实涵盖了最重要的模式/方面。

# oracle - 如何在Oracle中一起替换多个字符串

> ID：83856
> 
> 赞同：9
> 
> 时间：2008-09-17T14:31:29.590
> 
> 标签：oracle, string, replace

我有一个来自表格的字符串，例如“无法付款{1}，因为您的付款{2}到期 {3}”。我想用一些值替换 {1}，用一些值替换 {2}，用一些值替换 {3}。

是否可以替换所有 3 合一替换功能？或者有什么方法可以直接编写查询并获取替换值？我想在 Oracle 存储过程中替换这些字符串原始字符串来自我的一个表我只是在该表上进行选择

然后我想将该字符串中的 {1},{2},{3} 值替换为另一个表中的另一个值

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-17T14:37:25.253

虽然它不是一个调用，但您可以嵌套`replace()`调用：

```
SET mycol = replace( replace(mycol, '{1}', 'myoneval'), '{2}', mytwoval) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-02-18T13:19:07.880

如果要替换的变量很多，并且您将它们放在另一个表中，并且变量的数量是可变的，则可以使用递归 CTE 来替换它们。下面是一个例子。在表 fg_rulez 中，您将替换的字符串放入其中。在表 fg_data 中，您有输入字符串。

```
set define off;
drop table fg_rulez
create table fg_rulez as 
  select 1 id,'<' symbol, 'less than' text from dual
  union all select 2, '>', 'great than' from dual
  union all select 3, '$', 'dollars' from dual
  union all select 4, '&', 'and' from dual;
drop table fg_data;
create table fg_Data AS(
   SELECT 'amount $ must be < 1 & > 2' str FROM dual
   union all
   SELECT 'John is >  Peter & has many $' str FROM dual
   union all
   SELECT 'Eliana is < mary & do not has many $' str FROM dual

   );

WITH  q(str, id) as (
  SELECT str, 0 id 
  FROM fg_Data 
     UNION ALL
  SELECT replace(q.str,symbol,text), fg_rulez.id
  FROM q 
  JOIN fg_rulez 
    ON q.id = fg_rulez.id - 1
)
SELECT str from q where id = (select max(id) from fg_rulez); 
```

所以，单`replace`.

结果：

```
amount dollars must be less than 1 and great than 2 
John is great than Peter and has many dollars 
Eliana is less than mary and do not  has many dollars 
```

术语符号而不是变量来自[这个重复的问题。](https://stackoverflow.com/q/28580987/319875)

**甲骨文 11gR2**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-15T09:30:55.787

如果要替换的值太多或者您需要能够轻松维护它，您还可以拆分字符串，使用字典表并最终汇总结果

在下面的示例中，我假设字符串中的单词用空格分隔，并且字符串中的字数不会大于 100（数据透视表基数）

```
with Dict as
 (select '{1}' String, 'myfirstval' Repl from dual
   union all
  select '{2}' String, 'mysecondval' Repl from dual
   union all
  select '{3}' String, 'mythirdval' Repl from dual
   union all  
  select '{Nth}' String, 'myNthval' Repl from dual  

 )
,MyStrings as
 (select 'This  is the first example {1} ' Str, 1 strnum from dual
  union all
  select 'In the Second example all values are shown {1} {2} {3} {Nth} ', 2  from dual
  union all
  select '{3} Is the value for the third', 3 from dual
  union all
  select '{Nth} Is the value for the Nth', 4 from dual  
  )
,pivot as (
  Select Rownum Pnum
  From dual
  Connect By Rownum <= 100   
  )
,StrtoRow as
(
SELECT rownum rn
      ,ms.strnum
      ,REGEXP_SUBSTR (Str,'[^ ]+',1,pv.pnum) TXT
  FROM MyStrings ms
      ,pivot pv
where REGEXP_SUBSTR (Str,'[^ ]+',1,pv.pnum) is not null
)
Select Listagg(NVL(Repl,TXT),' ') within group (order by rn) 
from
(
Select sr.TXT, d.Repl, sr.strnum, sr.rn
  from StrtoRow sr
      ,dict d
 where sr.TXT = d.String(+) 
order by strnum, rn 
) group by strnum 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-11-08T20:22:14.517

让我们编写与 CTE 相同的示例：

```
with fg_rulez as (
  select 1 id,'<' symbol, 'less than' text from dual
  union all select 2, '>', 'greater than' from dual
   union all select 3, '$', 'dollars' from dual
  union all select 4, '+', 'and' from dual
),  fg_Data AS (
   SELECT 'amount $ must be < 1 + > 2' str FROM dual
   union all
   SELECT 'John is > Peter + has many $' str FROM dual
   union all
   SELECT 'Eliana is < mary + do not has many $' str FROM dual
), q(str, id) as (
  SELECT str, 0 id 
  FROM fg_Data 
     UNION ALL
  SELECT replace(q.str,symbol,text), fg_rulez.id
  FROM q 
  JOIN fg_rulez 
    ON q.id = fg_rulez.id - 1
)
SELECT str from q where id = (select max(id) from fg_rulez); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-09-17T14:41:17.103

如果您在选择中执行此操作，则可以将其拼凑在一起，如果您的替换值是列，则使用字符串连接。

# database - 如何在 Visual Studio 中创建和开发新的数据库项目？

> ID：83863
> 
> 赞同：0
> 
> 时间：2008-09-17T14:32:50.303
> 
> 标签：database, visual-studio, projects

我想找到一种在 Visual Studio 中快速开发数据库项目的方法。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T14:34:54.810

我有一种在 Visual Studio 2005 中创建和更新数据库项目的方法，我认为这是常识。在询问了一些同事是否知道如何使用这种方法更新他们的数据库项目并没有收到任何答复后，我想我会在博客中介绍它并传递一些有用的提示和最佳实践。

我经常使用数据库，尤其是为与业务逻辑/数据访问 .NET 框架一起使用而构建的存储过程。我喜欢使用数据库，并且总是创建数据库项目来配合我的 .NET 项目。我对使数据库项目保持最新状态感到很紧张。在我年轻的时候，我被烧毁了太多时间，我需要创建一个已删除或与使用数据库的应用程序不同步的存储过程。

在 Visual Studio 2005 中创建数据库项目后，如图所示：

[替代文字 http://www.cloudsocket.com/images/image-thumb16.png](http://www.cloudsocket.com/images/image-thumb16.png)

在项目中创建 3 个新目录：表、存储过程和函数。我通常只为我的项目存储这些。

[替代文字 http://www.cloudsocket.com/images/image-thumb17.png](http://www.cloudsocket.com/images/image-thumb17.png)

我现在在 Visual Studio 中打开服务器资源管理器并创建一个到所需数据库的新连接。我以罗斯文为例。我不打算为这个示例演示连接的创建过程。

[替代文字 http://www.cloudsocket.com/images/image-thumb18.png](http://www.cloudsocket.com/images/image-thumb18.png)

我将使用存储过程作为如何更新数据库项目的示例。首先，我在 Northwind 数据库的服务器资源管理器中展开“存储过程”目录。我选择了一个存储过程。

[替代文字 http://www.cloudsocket.com/images/image-thumb19.png](http://www.cloudsocket.com/images/image-thumb19.png)

我将存储过程拖到解决方案资源管理器中的“存储过程”目录并将其删除。

[替代文字 http://www.cloudsocket.com/images/image-thumb20.png](http://www.cloudsocket.com/images/image-thumb20.png)

[替代文字 http://www.cloudsocket.com/images/image-thumb21.png](http://www.cloudsocket.com/images/image-thumb21.png)

如果你打开被拖拽的存储过程的文件，你会发现 IDE 创建的脚本如下：

```
/****** Object:  StoredProcedure [dbo].[CustOrdersOrders]    Script Date: 08/25/2007 15:22:59 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CustOrdersOrders]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[CustOrdersOrders]
GO
/****** Object:  StoredProcedure [dbo].[CustOrdersOrders]    Script Date: 08/25/2007 15:22:59 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CustOrdersOrders]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE CustOrdersOrders @CustomerID nchar(5)
AS
SELECT OrderID,
    OrderDate,
    RequiredDate,
    ShippedDate
FROM Orders
WHERE CustomerID = @CustomerID
ORDER BY OrderID
'
END
GO 
```

您现在可以从数据库中拖动所有表、函数和剩余的存储过程。您还可以右键单击解决方案资源管理器中的每个脚本，然后在数据库项目的引用数据库上运行脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T14:35:23.963

数据大哥？[http://msdn.microsoft.com/en-us/vsts2008/db/default.aspx](http://msdn.microsoft.com/en-us/vsts2008/db/default.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-01T02:08:10.713

嘿 Chris，我也用同样的方法来保存一个数据库项目，唯一的问题是你经常对存储过程进行更改，有时你会忘记你更改了哪些，所以你可能会拖一个而忘记另一个。您是否知道一种将数据库项目与数据库同步的方法，或者一种在您的项目中为存储的过程导入最新脚本的方法，在第一次通过拖动添加它们之后。

# php - 有没有办法在静态方法中检测目标类？

> ID：83887
> 
> 赞同：1
> 
> 时间：2008-09-17T14:34:48.320
> 
> 标签：php, oop, php-5.3, php-5.2

下面是一个示例类层次结构和代码。我正在寻找的是一种方法来确定“ChildClass1”或“ChildClass2”是否具有调用它的静态方法 whoAmI() 而无需在每个子类中重新实现它。

```
<?php

abstract class ParentClass {

    public static function whoAmI () {

        // NOT correct, always gives 'ParentClass'
        $class = __CLASS__;

        // NOT correct, always gives 'ParentClass'. 
        // Also very round-about and likely slow.
        $trace = debug_backtrace();
        $class = $trace[0]['class'];

        return $class;
    }
}

class ChildClass1 extends ParentClass {

}

class ChildClass2 extends ParentClass {

}

// Shows 'ParentClass'
// Want to show 'ChildClass1'
print ChildClass1::whoAmI(); 
print "\n";

// Shows 'ParentClass'
// Want to show 'ChildClass2'
print ChildClass2::whoAmI();
print "\n"; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-17T14:36:30.890

我相信你指的是一个已知的 php 错误。Php 5.3 旨在通过新的后期静态绑定功能解决此问题。

[http://www.colder.ch/news/08-24-2007/28/late-static-bindings-expl.html](http://www.colder.ch/news/08-24-2007/28/late-static-bindings-expl.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-21T00:39:08.317

类识别通常是多态性没有被很好理解的症状。

ChildClass1 和 ChildClass2 的客户端不需要区分它们。

没有任何班级应该询问的地方`someObject.whoAmI()`。

每当你有写作的冲动时，`if someObject.whoAmI() == 'ChildClass1' { do X(someObject) }`你真的应该`X()`在各种 ChildClass 中使用各种实现向 ParentClass 添加一个方法。

这种“运行时类型识别”几乎总是可以用适当的多态类设计来代替。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-06T04:16:26.233

既然 PHP 5.3 在野外广泛使用，我想汇总这个问题的答案以反映新可用的技术。

如其他答案中所述，PHP 5.3通过新关键字引入了[后期静态绑定。](http://php.benscom.com/manual/en/language.oop5.late-static-bindings.php)[`static`](http://php.benscom.com/manual/en/language.oop5.static.php)此外，[`get_called_class()`](http://php.benscom.com/manual/en/function.get-called-class.php)还提供了一个只能在类方法（实例或静态）中使用的新函数。

为了确定这个问题中所问的类，该`get_called_class()`函数是合适的：

```
<?php

abstract class ParentClass {

    public static function whoAmI () {
        return get_called_class();
    }

}

class ChildClass1 extends ParentClass {

}

class ChildClass2 extends ParentClass {

}

// Shows 'ChildClass1'
print ChildClass1::whoAmI(); 
print "\n";

// Shows 'ChildClass2'
print ChildClass2::whoAmI();
print "\n"; 
```

用户提供的[注释`get_called_class()`](http://php.benscom.com/manual/en/function.get-called-class.php)包括一些示例实现，这些示例实现也应该在 PHP 5.2 中使用，并且使用`debug_backtrace()`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-10T15:03:16.327

从 PHP 5.3 开始，可以使用[static 关键字](http://php.net/manual/en/language.oop5.static.php)，但现在还不行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T14:45:52.270

不，等待 PHP 5.3。

# linux - Linux 上的视频捕获？

> ID：83899
> 
> 赞同：6
> 
> 时间：2008-09-17T14:36:10.080
> 
> 标签：linux, video, video-capture, image-capture

我们需要在 Linux 上*轻松捕获实时视频并显示。*我们需要具有简单 API 的廉价卡或 USB 设备。有人想分享一些经验吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-17T14:37:02.777

使用[video4linux](http://en.wikipedia.org/wiki/Video4Linux)库。我已经将它与 c++ 程序一起使用，并且能够在大约一个小时内捕获网络摄像头帧。（非常易于使用和设置）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T13:18:22.037

如果你需要编程，你最好使用[GStreamer](http://gstreamer.freedesktop.org "GStreamer")，这是一个 Linux 下的多媒体框架。

Jackbravo 提到的 Cheese 是基于 GStreamer 的，我工作的流媒体服务器[Flumotion也是如此。](http://www.flumotion.net/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-20T21:10:39.177

如前所述，使用 dvgrab 从相机的 Firewire 接口捕获，然后根据需要使用 ffmpeg（命令行）或 kino（简单 gui 视频编辑器）等工具处理视频。基于 PCI 的 Firewire 卡相对便宜且容易找到。

这里有些例子：

*   从火线连续捕获，每隔几分钟自动分割

    ```
    dvgrab --size 500 --autosplit <filename> 
    ```

*   看摄像机直播

    ```
    dvgrab - | mplayer - 
    ```

请注意，一些最近的发行版（例如 Fedora8）正在使用新的但不成熟的火线驱动程序。但是，Ubuntu 运行良好。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-17T18:25:25.113

那里有“密封”相机解决方案，背面带有迷你网络服务器和以太网端口。只需将其插入网络，设置其 IP，然后打开浏览器……在 linux 或任何地方

如果你想在 linux 中**捕捉**，我曾经有一个便宜的网络摄像头在 perl 脚本中捕捉单帧，它可以被实时修改——尽管那是大约 10 年前的事了。无论如何，它是可能的：-/

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T14:38:35.300

有[奶酪](http://www.gnome.org/projects/cheese/)侏儒应用程序。使用起来真的很简单。没有太多功能，只是视频捕获。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T02:05:22.183

openCV 将允许您从相机捕获单个帧并保存到磁盘。如果您需要随后操作这些来创建视频，我建议您使用 netpbm，这是一套非常强大的命令行工具，您可以使用一些 shell 脚本来制作视频或做任何您需要的事情。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T13:22:32.570

另一种选择是使用 Firewire (IEEE1394) 摄像机，例如最常见的 DV 摄像机。它们往往工作得非常好，并且提供比廉价网络摄像头更好的视频，并且 Linux 中有大量用于处理 dv 视频的工具，例如**dvgrab**。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-24T00:47:16.743

如果您使用 java，[v4l4j](http://v4l4j.googlecode.com) 使得从任何 V4L 设备捕获帧变得非常简单。它还允许您从 java 控制设备。我将它与 PTZ 网络摄像头（罗技 quickam orbit）一起使用，我可以控制亮度、饱和度和自动白平衡等常用参数，还可以控制相机的倾斜和平移。非常便利 ！

# sql - 如何使用随机数据更新字段？

> ID：83914
> 
> 赞同：0
> 
> 时间：2008-09-17T14:37:28.610
> 
> 标签：sql, sql-server

我在包含 1000 多条记录的数据库中有一个新的 varchar(10) 字段。我想更新表格，以便可以在该字段中包含随机数据。我正在寻找一个 SQL 解决方案。

我知道我可以使用光标，但这似乎不优雅。

MS-SQL 2000，顺便说一句

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-17T14:41:48.160

```
update MyTable Set RandomFld =  CONVERT(varchar(10), NEWID()) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T14:39:01.600

您可能可以调整[类似这样](http://www.mitchelsellers.com/blogs/articletype/articleview/articleid/249/creating-random-sql-server-test-data.aspx)的内容来加载值的测试数据集，具体取决于您要查找的内容

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T14:39:51.363

此外，如果您只是为了测试或一次性使用而这样做，我会说一个优雅的解决方案并不是真正必要的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T14:42:18.037

为什么不使用当前时间戳的 md5 校验和的前 10 个字符和一个随机数？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T14:47:54.857

类似（未经测试的代码）：

```
UPDATE yourtable
SET yourfield= CHAR(32+ROUND(RAND()*95,0)); 
```

显然，如果您想要最多十个字符，请连接更多随机字符。查询优化器可能会将所有字段设置为相同的值；在那种情况下，我会尝试

```
SET yourfield=LEFT(yourfield,0)+CHAR… 
```

欺骗优化器在每次表达式时重新计算。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T14:39:30.367

如果这是一次性的事情，只是为了将数据输入系统，我真的认为使用游标没有问题，因为我讨厌游标，它们确实有它们的位置。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T14:41:48.957

这个怎么样：

```
UPDATE TBL SET Field = LEFT( CONVERT(varchar(255), @myid),10) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T14:42:51.700

如果您在 SQL Server 中，则可以使用

```
CAST(RAND() as varchar(10)) 
```

**编辑**：这只会在迭代中起作用。作为多行插入的一部分，它将对每一行使用相同的 RAND() 结果。

# java - log4j 日志文件名？

> ID：83918
> 
> 赞同：14
> 
> 时间：2008-09-17T14:37:45.863
> 
> 标签：java, logging, log4j

我们有几个同时运行的作业，它们必须为 log4j 使用相同的配置信息。他们都使用相同的附加程序将日志转储到一个文件中。有没有办法让每个作业动态命名其日志文件，以便它们保持独立？

谢谢
汤姆

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-17T14:49:20.623

您可以为每个作业传递一个 Java 系统属性吗？如果是这样，您可以像这样进行参数化：

```
java -Dmy_var=somevalue my.job.Classname 
```

然后在你的 log4j.properties 中：

```
log4j.appender.A.File=${my_var}/A.log 
```

您可以使用来自主机环境（例如）的值填充 Java 系统属性，该值将唯一标识作业的实例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T14:48:43.620

如果提前知道作业名称，则可以在执行 getLogger() 调用时包含作业名称。然后，您可以使用不同的文件名（或其他目的地）将不同的附加程序绑定到不同的记录器。

如果您无法提前知道作业名称，您可以在运行时配置记录器，而不是使用配置文件：

```
FileAppender appender = new FileAppender();
appender.setFileName(...);
appender.setLayout(...);
Logger logger = Logger.getLogger("com.company.job."+jobName);
logger.addAppender(appender); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T16:23:16.500

我们在我们的系统中实现了类似的东西。我们将特定的记录器存储在 HashMap 中，并根据需要为每个记录器初始化附加程序。

这是一个例子：

```
public class JobLogger {
private static Hashtable<String, Logger> m_loggers = new Hashtable<String, Logger>();
private static String m_filename = "...";  // Root log directory

public static synchronized void logMessage(String jobName, String message)
{
    Logger l = getJobLogger(jobName);
    l.info(message);
}

public static synchronized void logException(String jobName, Exception e)
{
    Logger l = getJobLogger(partner);
    l.info(e.getMessage(), e);
}

private static synchronized Logger getJobLogger(String jobName)
{
    Logger logger = m_loggers.get(jobName);
    if (logger == null) {
        Layout layout = new PatternLayout("...");
        logger = Logger.getLogger(jobName);
        m_loggers.put(jobName, logger);
        logger.setLevel(Level.INFO);
        try {
            File file = new File(m_filename);
            file.mkdirs();
            file = new File(m_filename + jobName + ".log");
            FileAppender appender = new FileAppender(layout, file.getAbsolutePath(), false);
            logger.removeAllAppenders();
            logger.addAppender(appender);
    }
        catch (Exception e)
    { ... }
    }
    return logger;
}
} 
```

然后要在你的工作中使用它，你只需要使用这样的一行条目：

```
JobLogger.logMessage(jobName, logMessage); 
```

这将为每个作业名称创建一个日志文件，并将其放入其自己的文件中，该文件位于您指定的任何目录中。

您可以摆弄其他类型的附加程序等，如所写，它将继续附加，直到 JVM 重新启动，如果您在始终处于启动状态的服务器上运行相同的作业，这可能无法正常工作，但这给出了它如何可以的一般概念工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-17T15:24:16.437

您可以让每个作业设置 NDC 或 MDC，然后编写一个附加程序，根据 NDC 或 MDC 值改变名称。创建一个新的 appender 并不难。在 log4j 沙箱中也可能有一个符合要求的附加程序。开始查看[http://svn.apache.org/viewvc/logging/log4j/trunk/contribs/](http://svn.apache.org/viewvc/logging/log4j/trunk/contribs/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T14:52:33.003

您可以编写自己的附加程序来组成自己的文件名，也许使用 [File.createTempFile]( [http://java.sun.com/j2se/1.5.0/docs/api/java/io/File.html# createTempFile(java.lang.String,%20java.lang.String))](http://java.sun.com/j2se/1.5.0/docs/api/java/io/File.html#createTempFile(java.lang.String,%20java.lang.String)))方法。如果`FileAppender`该类编写正确，您应该能够扩展它——或者`RollingFileAppender`——并覆盖该`getFile`方法以返回一个您根据要添加的任何新属性选择的方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-30T07:32:59.620

以[shadit](https://stackoverflow.com/questions/83918/log4j-log-file-names/84044#84044)的回答为基础。如果可以通过启动哪个类的 main 方法来识别每个作业，则可以使用包含`sun.java.command`启动的类的全名的系统属性。例如像这样：

```
log4j.appender.LOGFILE.File=${sun.java.command}.log 
```

我将它与[TimestampFileAppender](http://markmail.org/message/5on2bmatywehnbn7)一起使用，如下所示：

```
log4j.appender.LOGFILE=TimestampFileAppender
log4j.appender.LOGFILE.TimestampPattern=yyyy_MM_dd__HH_mm
log4j.appender.LOGFILE.File=${sun.java.command}_{timestamp}.log 
```

这样，当我在 Eclipse 中进行开发时，我会为我运行的每个新进程获得一个新的日志文件，由具有 main 方法的类的类名和它的启动时间来标识。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T14:44:55.703

您可以在初始化作业时以编程方式配置 log4j。

您还可以通过系统属性在运行时设置 log4j.properties 文件。从[手册](http://logging.apache.org/log4j/1.2/manual)：

> 将资源字符串变量设置为*log4j.configuration*系统属性的值。指定默认初始化文件的首选方法是通过 log4j.configuration 系统属性。如果未定义系统属性 log4j.configuration，则将字符串变量资源设置为其默认值“log4j.properties”。

假设您从不同的 java 命令运行作业，这将使它们能够使用不同的 log4j.properties 文件和每个文件的不同文件名。

如果不了解您的工作是如何运行的，就很难说！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T14:47:14.030

汤姆，您可以为每个作业指定和附加程序。假设你有 2 个作业对应于两个不同的 java 包 com.tom.firstbatch 和 com.tom.secondbatch，你会在 log4j.xml 中有这样的东西：

```
 <category name="com.tom.firstbatch">
      <appender-ref ref="FIRST_APPENDER"/>
   </category>
   <category name="com.tom.secondtbatch">
      <appender-ref ref="SECOND_APPENDER"/>
   </category> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T15:35:39.263

您可以执行以下操作：

*   一个 ThreadLocal 持有者，用于标识您的工作。
*   扩展 FileAppender，您的 FileAppender 必须为每个工作身份保留一个包含 QuietWriter 的 Map。在方法 subAppend 中，您从 ThreadLocal 获取工作的标识，查找（或创建）QuietWriter 并写入它...

如果您愿意，我可以通过邮件向您发送一些代码...

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-09-29T06:01:20.370

log4j.logger.com.foo.admin=,AdminFileAppender log4j.logger.com.foo.report=,ReportFileAppender

这是完成此任务的另一种方法.. 这里 com.foo.admin 是完整的包名

# c# - 列表视图多选

> ID：83945
> 
> 赞同：6
> 
> 时间：2008-09-17T14:40:16.387
> 
> 标签：c#, winforms

有什么方法可以强制 listview 控件将所有点击视为通过 Control 键完成的？

我需要复制使用控制键的功能（选择一个项目设置并取消其选择状态），以允许用户轻松地同时选择多个项目。

先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T14:57:02.213

这不是 ListView 控件的标准行为，即使 MultiSelect 设置为 true。

如果您想创建自己的自定义控件，您需要执行以下操作：

1.  从 ListView 派生控件
2.  向“Selected”事件添加处理程序。
3.  在“OnSelected”中，维护您自己的选定项目列表。
4.  如果新选择的项目不在您的列表中，请添加它。如果是，请将其删除。
5.  在代码中，选择列表中的所有项目。

应该足够简单，无需使用控制键即可实现并感觉像多选！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-03T02:04:10.130

这是一个完整的解决方案，它是对上述 Matthew M. 提供的解决方案的修改。

它提供了改进以及一些附加功能。

改进：

*   左键单击控件将焦点放在控件上。
*   鼠标右键单击行为一致（单选）

新增功能：

*   该控件有一个属性 ( `MultiSelectionLimit`)，允许您限制一次可以选择的项目数。

在我第一次发布后，我意识到代码存在一个小问题。清除多个选择会导致`ItemSelectionChanged`事件被多次调用。
我无法通过当前的继承来避免这种情况，因此我采用了一种解决方案，在该解决方案中 bool 属性`SelectionsBeingCleared`将为真，直到所有选定的项目都被取消选择为止。

这样，对该属性的简单调用就可以避免在清除所有多项选择之前更新效果。

```
public class ListViewMultiSelect : ListView
{
    public const int WM_LBUTTONDOWN = 0x0201;
    public const int WM_RBUTTONDOWN = 0x0204;

    private bool _selectionsBeingCleared;
    /// <summary>
    /// Returns a boolean indicating if multiple items are being deselected.
    /// </summary>
    /// <remarks> This value can be used to avoid updating through events before all deselections have been carried out.</remarks>
    public bool SelectionsBeingCleared
    {
        get
        {
            return this._selectionsBeingCleared;
        }
        private set
        {
            this._selectionsBeingCleared = value;
        }
    }
    private int _multiSelectionLimit;
    /// <summary>
    /// The limit to how many items that can be selected simultaneously. Set value to zero for unlimited selections.
    /// </summary>
    public int MultiSelectionLimit
    {
        get
        {
            return this._multiSelectionLimit;
        }
        set
        {
            this._multiSelectionLimit = Math.Max(value, 0);
        }
    }

    public ListViewMultiSelect()
    {
        this.ItemSelectionChanged += this.multiSelectionListView_ItemSelectionChanged;
    }

    public ListViewMultiSelect(int selectionsLimit)
        : this()
    {
        this.MultiSelectionLimit = selectionsLimit;
    }

    private void multiSelectionListView_ItemSelectionChanged(object sender, ListViewItemSelectionChangedEventArgs e)
    {
        if (e.IsSelected)
        {
            if (this.MultiSelectionLimit > 0 && this.SelectedItems.Count > this.MultiSelectionLimit)
            {
                this._selectionsBeingCleared = true;
                List<ListViewItem> itemsToDeselect = this.SelectedItems.Cast<ListViewItem>().Except(new ListViewItem[] { e.Item }).ToList();

                foreach (ListViewItem item in itemsToDeselect.Skip(1)) { 
                    item.Selected = false; 
                }

                this._selectionsBeingCleared = false;
                itemsToDeselect[0].Selected = false;
            }
        }
    }

    protected override void WndProc(ref Message m)
    {
        switch (m.Msg)
        {
            case WM_LBUTTONDOWN:
                if (this.SelectedItems.Count == 0 || !this.MultiSelect) { break; }
                if (this.MultiSelectionLimit > 0 && this.SelectedItems.Count > this.MultiSelectionLimit) { this.ClearSelections(); }

                int x = (m.LParam.ToInt32() & 0xffff);
                int y = (m.LParam.ToInt32() >> 16) & 0xffff;
                ListViewHitTestInfo hitTest = this.HitTest(x, y);

                if (hitTest != null && hitTest.Item != null) { hitTest.Item.Selected = !hitTest.Item.Selected; }
                this.Focus();
                return;
            case WM_RBUTTONDOWN:
                if (this.SelectedItems.Count > 0) { this.ClearSelections(); }
                break;
        }
        base.WndProc(ref m);
    }

    private void ClearSelections()
    {
        this._selectionsBeingCleared = true;
        SelectedListViewItemCollection itemsToDeselect = this.SelectedItems;
        foreach (ListViewItem item in itemsToDeselect.Cast<ListViewItem>().Skip(1)) { 
            item.Selected = false; 
        }
        this._selectionsBeingCleared = false;
        this.SelectedItems.Clear();
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T15:15:21.170

您可能还想考虑在列表视图上使用[复选框。](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.checkboxes.aspx)这是向可能不了解 Ctrl+Click 的普通用户传达多选概念的一种明显方式。

从 MSDN 页面：

> CheckBoxes 属性提供了一种无需使用 CTRL 键即可在 ListView 控件中选择多个项目的方法。根据您的应用程序，使用复选框而不是标准的多选方法来选择项目可能对用户来说更容易。即使 ListView 控件的 MultiSelect 属性设置为 false，您仍然可以显示复选框并为用户提供多选功能。如果您不希望选择多个项目但仍希望允许用户从列表中选择多个项目以在应用程序中执行操作，则此功能可能很有用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-04-20T19:50:17.823

这是我用来使用 WndProc 解决此问题的完整解决方案。基本上，它会在单击鼠标时进行命中测试。然后，如果 MutliSelect 处于打开状态，它将自动打开/关闭项目 [.Selected]，而不必担心维护任何其他列表或弄乱 ListView 功能。

我没有在所有情况下都对此进行测试，......它对我有用。YMMV。

```
public class MultiSelectNoCTRLKeyListView : ListView {
  public MultiSelectNoCTRLKeyListView() {

  }

  public const int WM_LBUTTONDOWN = 0x0201;
  protected override void WndProc(ref Message m) {
    switch (m.Msg) {
      case WM_LBUTTONDOWN:
        if (!this.MultiSelect)
          break;

        int x = (m.LParam.ToInt32() & 0xffff);
        int y = (m.LParam.ToInt32() >> 16) & 0xffff;

        var hitTest = this.HitTest(x, y);
        if (hitTest != null && hitTest.Item != null)
          hitTest.Item.Selected = !hitTest.Item.Selected;

        return;
    }

    base.WndProc(ref m);
  }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T15:06:04.470

向下钻取 ListviewItemCollection，您可以将单个项目的 Selected 属性设置为 true。我相信，这将模拟您尝试重现的“多选”功能。（另外，正如上述评论者所提到的，请确保将 lisetview 的 MultiSelect 属性设置为 true。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-10-07T07:01:00.647

以防万一其他人搜索并找到了这篇文章，接受的解决方案不再有效。（事实上​​我不确定它曾经是）。为了做你想做的事（选择多个不带修饰键）只需将列表视图选择类型设置为多个，而不是扩展。单击时多个选择一个接一个的项目，扩展需要先按下修饰键。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-09-17T14:54:55.697

Ctrl+Click 行为由浏览器实现，与实际的 .NET Control 几乎没有关系。您尝试实现的结果可以通过大量额外的 JavaScript 获得 - 最简单的方法可能是从默认构建一个以这种方式工作的 JavaScript 控件，而不是尝试破解列表视图。这是可取的吗？在这种情况下，我可以调查一下，然后给你一个解决方案。

# php - PHP $_GET 问题

> ID：83953
> 
> 赞同：0
> 
> 时间：2008-09-17T14:40:43.390
> 
> 标签：php, arrays, printing, foreach, get

```
foreach ($_GET as $field => $label)
{
   $datarray[]=$_GET[$field];
   echo "$_GET[$field]";
   echo "<br>";
}
print_r($datarray); 
```

* * *

这是我得到的输出。我看到数据在数据阵列中，但是当我`echo $_GET[$field]`

我只得到“数组”

但`print_r($datarray)`打印所有数据。知道我如何提取这些值吗？

## 输出

```
Array ( 
        [0] => Array ( 
                 [0] => Grade1 
                 [1] => ln 
                 [2] => North America 
                 [3] => yuiyyu 
                 [4] => iuy 
                 [5] => uiyui 
                 [6] => yui 
                 [7] => uiy 
                 [8] => 0:0:5 
                 ) 
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T15:04:24.083

用于`var_export($_GET)`更轻松地查看您获得的阵列类型。

从脚本的输出中，我可以看到您有多个嵌套数组。它似乎是这样的：

```
$_GET = array( array( array("Grade1", "ln", "North America", "yuiyyu", "iuy", "uiyui", "yui","uiy","0:0:5"))) 
```

所以要得到这些变量，你需要这样的东西：

```
echo $_GET[0][0][0]; // => "Grade1" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T15:34:12.327

编辑：当我完成你的测试时，这是最终的 URL：

[http://hofstrateach.org/Roberto/process.php?keys=Grade1&keys=Nathan&keys=North%20America&keys=5&keys=3&keys=no&keys=foo&keys=blat&keys=0%3A0%3A24](http://hofstrateach.org/Roberto/process.php?keys=Grade1&keys=Nathan&keys=North%20America&keys=5&keys=3&keys=no&keys=foo&keys=blat&keys=0%3A0%3A24)

这可能是一个格式错误的 URL。当您在查询中传递重复键时，PHP 会将它们变成一个数组。上面的 URL 应该是这样的：

[http://hofstrateach.org/Roberto/process.php?grade=Grade1&schoolname=Nathan®ion=North%20America&answer[]=5&answer[]=3&answer[]=no&answer[]=foo&answer[]=blat&time=0%3A0%3A24](http://hofstrateach.org/Roberto/process.php?grade=Grade1&schoolname=Nathan&region=North%20America&answer[]=5&answer[]=3&answer[]=no&answer[]=foo&answer[]=blat&time=0%3A0%3A24)

这将为大多数字段创建单独的条目，并使 $_GET['answer'] 成为用户提供的答案的数组。

底线：修复您的 Flash 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T14:48:48.643

使用`<pre>`标签之前`print_r`，然后您将打印一棵树（或只查看源代码。从这一点您将清楚地了解您的数组是如何并且能够提取您想要的值。

我建议进一步阅读[`$_GET`](http://www.php.net/manual/en/language.variables.external.php)变量和[数组](http://www.php.net/types.array)，以便更好地理解其值

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T15:00:04.560

在数组上调用 echo 将始终输出“Array”。print_r（来自 PHP 手册）打印关于变量的人类可读信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T15:46:39.923

试试这个：

```
foreach ($_GET as $field => $label)
{
    $datarray[]=$_GET[$field];

    echo $_GET[$field]; // you don't really need quotes

    echo "With quotes: {$_GET[$field]}"; // but if you want to use them

    echo $field; // this is really the same thing as echo $_GET[$field], so

    if($label == $_GET[$field]) {
         echo "Should always be true<br>";
    }
    echo "<br>";
}
print_r($datarray); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T17:53:17.890

它只打印“Array”，因为当你说

```
 echo "$_GET[$field]"; 
```

PHP 不知道你的意思是`$_GET`元素`$field`，它认为它是你想要打印的变量`$_GET`。所以，它会尝试打印它，当然它是一个数组，这就是你得到的。一般来说，当你想回显一个数组元素时，你会这样做：

```
echo "The foo element of get is: {$_GET['foo']}"; 
```

花括号告诉 PHP 整个事情是一个需要解释的变量；否则它将假定变量名是`$_GET`单独的。

在您的情况下，尽管您不需要，但您需要的是：

```
foreach ($_GET as $field => $label)
{
    $datarray[] = $label;
} 
```

如果你想打印它，就做

```
echo $label; // or $_GET[$field], but that's kind of pointless. 
```

问题不在于您的闪存文件，将其更改回原来的样子；您知道这是正确的，因为您的 $dataarray 变量包含所有数据。你为什么要从`$_GET`另一个数组中提取数据呢？

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-09-17T14:51:41.117

也许 GET 变量本身就是数组？即[http://site.com?var[]=1&var[]=2](http://site.com?var[]=1&var[]=2)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-09-17T15:04:05.503

看起来您的 GET 参数本身就是一个数组。有输入和输出会很有帮助。

# c - 我有 gcc 优化错误或 C 代码问题吗？

> ID：83962
> 
> 赞同：10
> 
> 时间：2008-09-17T14:41:46.697
> 
> 标签：c, gcc

测试以下代码：

```
#include <stdio.h>
#include <stdlib.h>
main()
{
    const char *yytext="0";
    const float f=(float)atof(yytext);
    size_t t = *((size_t*)&f);
    printf("t should be 0 but is %d\n", t);
} 
```

编译它：

```
gcc -O3 test.c 
```

好的输出应该是：

```
"t should be 0 but is 0" 
```

但是使用我的 gcc 4.1.3，我有：

```
"t should be 0 but is -1209357172" 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-17T14:44:55.080

使用编译器标志 -fno-strict-aliasing。

在启用严格别名的情况下，默认情况下至少为 -O3，在该行中：

```
size_t t = *((size_t*)&f); 
```

编译器假定 size_t* 不指向与 float* 相同的内存区域。据我所知，这是符合标准的行为（正如 Thomas Kammeyer 指出的那样，遵循 ANSI 标准中严格的别名规则从 gcc-4 开始）。

如果我没记错的话，您可以使用 char* 的中间转换来解决这个问题。（编译器假设 char* 可以给任何东西起别名）

换句话说，试试这个（现在不能自己测试，但我认为它会起作用）：

```
size_t t = *((size_t*)(char*)&f); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-17T15:08:05.370

在 C99 标准中，这包含在 6.5-7 中的以下规则中：

> 对象的存储值只能由具有以下类型之一的左值表达式访问：73)
> 
> *   与对象的有效类型兼容的类型，
>     
>     
> *   与对象的有效类型兼容的类型的限定版本，
>     
>     
> *   与对象的有效类型相对应的有符号或无符号类型，
>     
>     
> *   对应于对象有效类型的限定版本的有符号或无符号类型，
>     
>     
> *   聚合或联合类型，在其成员中包括上述类型之一（递归地包括子聚合或包含联合的成员），或
>     
>     
> *   一种字符类型。

最后一项是为什么首先转换为 (char*) 有效。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-17T14:47:38.553

根据 C99 关于指针别名的规则，不再允许这样做。两种不同类型的指针不能指向内存中的同一位置。此规则的例外是 void 和 char 指针。

因此，在您要转换为 size_t 指针的代码中，编译器可以选择忽略这一点。如果您想将浮点值作为 size_t 获取，只需分配它，浮点数将被强制转换（截断而不是四舍五入），如下所示：

size_t 大小 = (size_t)(f); // 这行得通

这通常被报告为一个错误，但实际上它确实是一个允许优化器更有效地工作的特性。

在 gcc 中，您可以使用编译器开关禁用它。我相信-fno_strict_aliasing。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-17T14:50:28.983

这是糟糕的 C 代码:-)

有问题的部分是您通过将其转换为整数指针并取消引用来访问一个浮点类型的对象。

这打破了别名规则。编译器可以自由假设指向不同类型（如 float 或 int）的指针不会在内存中重叠。你已经做到了。

编译器看到的是你计算了一些东西，将它存储在 float f 中并且不再访问它。很可能编译器已经删除了部分代码并且分配从未发生过。

在这种情况下，通过 size_t 指针取消引用将从堆栈中返回一些未初始化的垃圾。

你可以做两件事来解决这个问题：

1.  使用带有浮点数和 size_t 成员的联合，并通过类型双关语进行强制转换。不好但有效。

2.  使用 memcopy 将 f 的内容复制到您的 size_t 中。编译器足够聪明，可以检测和优化这种情况。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-17T14:45:24.393

为什么你会认为 t 应该是 0？

或者，更准确地说，“你为什么认为浮点零的二进制表示与整数零的二进制表示相同？”

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-17T14:48:11.017

这是糟糕的 C 代码。你的演员打破了 C 别名规则，优化器可以自由地做一些破坏这段代码的事情。您可能会发现 GCC 已经在浮点写入之前调度了 size_t 读取（以隐藏 fp 管道延迟）。

您可以设置 -fno-strict-aliasing 开关，或使用联合或 reinterpret_cast 以符合标准的方式重新解释值。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-06T07:23:33.137

除了指针对齐之外，您还期望 sizeof(size_t)==sizeof(float)。我不认为它是（在 64 位 Linux 上 size_t 应该是 64 位但浮动 32 位），这意味着您的代码将读取未初始化的内容。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-09-17T14:47:06.933

-O3 不被认为是“理智的”，-O2 通常是上限，除了一些多媒体应用程序。

有些应用程序甚至不能走那么远，如果你超过 -O1 就会死掉。

如果你有足够新的 GCC（我在这里是 4.3），它可能支持这个命令

```
 gcc -c -Q -O3 --help=optimizers > /tmp/O3-opts 
```

如果你小心点，你可能会通过这个列表找到你正在启用的给定的单一优化，它会导致这个错误。

来自`man gcc`：

```
 The output is sensitive to the effects of previous command line options, so for example it is possible to find out which
       optimizations are enabled at -O2 by using:

               -O2 --help=optimizers

       Alternatively you can discover which binary optimizations are enabled by -O3 by using:

               gcc -c -Q -O3 --help=optimizers > /tmp/O3-opts
               gcc -c -Q -O2 --help=optimizers > /tmp/O2-opts
               diff /tmp/O2-opts /tmp/O3-opts | grep enabled 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2008-09-17T14:52:58.523

我使用以下代码测试了您的代码：“i686-apple-darwin9-gcc-4.0.1 (GCC) 4.0.1 (Apple Inc. build 5465)”

没有问题。输出：

```
t should be 0 but is 0 
```

因此，您的代码中没有错误。这并不意味着它是好的代码。但我会添加主函数的返回类型和“返回 0；” 在函数的最后。

# database - 如何手动卸载 Oracle？

> ID：83967
> 
> 赞同：20
> 
> 时间：2008-09-17T14:41:55.883
> 
> 标签：database, oracle, oracle10g, uninstallation, oracle9i

有时我在 Windows 上的 Oracle 数据库会被淹没。如何手动卸载 Oracle？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-09-17T19:13:13.640

从 Windows 机器中删除所有 Oracle 内容的六步过程：

A.**删除 Oracle 服务**：在注册表中，转到 `\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services` 并删除以“Oracle”开头的所有内容

B.**从注册表中删除其他 Oracle 内容**：转到`\HKEY_LOCAL_MACHINE\SOFTWARE\`并删除键 ORACLE

C.**重启**

D.从您安装它的目录中**删除所有 Oracle 软件**

E.**删除 Oracle 软件清单**：删除目录`C:\Program Files\Oracle`。无论您将 Oracle 软件安装在何处，都必须执行此操作 - Oracle 安装程序会自动在此处写入信息。

F.从开始菜单中**删除所有快捷方式。**

G.从 PATH 环境变量中**删除Oracle 目录。**

为了简化将来的清理工作，我强烈建议您将 Oracle 产品安装在一个或多个虚拟机中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-17T18:08:00.367

看一下：

[http://www.oracle-base.com/articles/misc/ManualOracleUninstall.php](http://www.oracle-base.com/articles/misc/ManualOracleUninstall.php)

基本上，它归结为：

使用安装程序删除所有内容。从注册表中删除 Oracle 密钥。从您的计算机中删除 Oracle 目录。

（当然）根据需要进行必要的重新启动；-)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-05-18T12:09:39.023

值得注意的是，有一个官方的 Oracle 独立卸载程序：[https](https://docs.oracle.com/cd/E11882_01/install.112/e47689/remove_oracle_sw.htm#LADBI1332) ://docs.oracle.com/cd/E11882_01/install.112/e47689/remove_oracle_sw.htm#LADBI1332 ，我只是用来卸载 Oracle 11 客户端。这不一定比此页面上的顶级建议更好或更容易使用，但它是“官方的”。

需要注意的一件事 - 如果您使用官方卸载程序，它不喜欢临时文件夹中有空格。因此，如果您将其设置为“文档和设置...\temp”，它将失败。首先使用控制面板环境设置按钮设置 TEMP 文件夹。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-01-08T13:39:23.577

**从 Windows 7、Xp 卸载 Oracle 10g**

**步骤1：**打开开始菜单，在程序文件中查找oracle – oraDb10g_home 文件夹，然后选择oracle 安装产品–> Universal Installer。

**第二步：**选择卸载产品，弹出新窗口，勾选oracleDb10g_home1复选框，如下图。单击删除按钮。这将删除 oracle。

**第 3 步：**从 Regedit 中删除注册文件，以便完全删除 oracle 10g。运行注册表。

**如果卸载后退出，请删除以下键**。

> HKEY_CURRENT_USER\SOFTWARE\ORACLE HKEY_LOCAL_MACHINE\SOFTWARE\ORACLE HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog\Application\Oracle.oracle HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\OracleDBConsole HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Oracle10g_home HKEY_LOCAL_MACHINE\System\CurrentControlSet \Oracle 服务

**第 4 步**：现在删除安装软件的文件夹。默认情况下，它作为 C:\oracle 和 C:\programs files\oracle 安装在 c 驱动器中。

因此，通过成功执行此步骤，Oracle 10g 将被完全删除。如果您在删除或卸载程序（oracle）时遇到任何问题，请在下面发表评论，我们将对此进行处理。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T13:28:38.517

使用虚拟机环境的技巧是最好的：不用担心卸载。只需安装一个完整的 Oracle 环境并在一次成功运行后：winrar the VM ... 再次破坏 Oracle 主目录后：只需删除当前 VM 并解压缩备份

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-02-15T21:41:07.767

This seems way too simple, but in Windows I was able to uninstall Oracle by going into `Settings > Apps and Features` finding the Oracle database clicking it and then `uninstall`. I didn't even need a password.

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2008-09-17T15:03:00.903

假设一个 unix 类型的操作系统，并且您使用名为 oracle 的帐户正确安装了它...

查找 / -user oracle -exec rm -fr {} \;

话虽如此，这必须以 root 身份完成，您最好不要介意丢失任何和所有属于 oracle 的文件。不会有... 无法从这种方法中恢复。

# log4net - 带有 SyslogAppender 的 Log4net，1kb 消息限制

> ID：83969
> 
> 赞同：0
> 
> 时间：2008-09-17T14:42:01.030
> 
> 标签：log4net, syslog

有没有人找到解决这个问题的方法？还是一种更好的技术来可靠地整合来自多个 Web 服务器的日志记录？

关于好的 log4net 日志文件分析工具的任何想法（纯文本不是 XML）——当然除了好的 'ol grep :)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T11:01:59.533

我在另一个问题上阅读了有关[logFaces](http://www.moonlit-software.com/logfaces/web/index.php)的信息，或者您可以使用套接字附加程序并编写自己的服务器。logFaces 将自己描述为“日志服务器、聚合器和查看器”，但我还没有尝试过。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T13:18:22.320

基于数据库的附加程序非常适合从多个服务器收集日志。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-26T03:17:45.677

1024 字节限制是 syslog [RFC](http://www.ietf.org/rfc/rfc3164.txt)（第 4.1 节）的一部分，UDP 传输也不能保证交付（以防您担心日志行在以太网中丢失）。我认为 syslog-ng 可以解决这两个问题，但我不是 syslog 专家。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T15:08:26.430

限制是由 syslog 本身而不是 appender 施加的。

我不了解 log4net，但[NLog](http://www.nlog-project.org/)与“共享”文件目标完美配合 - 即多个进程可以写入同一个[文件](http://www.nlog-project.org/target.File.html)。

# asp.net - 如何为网站提供动态 CSS 样式或自定义主题？

> ID：83982
> 
> 赞同：0
> 
> 时间：2008-09-17T14:43:12.637
> 
> 标签：asp.net, themes, branding

有很多方法可以为网站提供动态样式/主题，但我正在寻找一些对其他人有效的最佳实践或技术的帮助。

我正在创建一个网站，该网站需要为客户提供创建或指定自己的颜色、样式、主题或布局的能力。我不确定我需要多大的灵活性，但基本上我需要提供品牌能力。

我将使用 ASP.NET，并对任何适合 ASP.NET 框架的想法持开放态度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T14:45:50.163

使用 ASP.NET 2 及更高版本的主题将为您提供所需的一切。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T14:49:16.677

处理它的最佳方法是制作一个漂亮的 CSS 文档，该文档将指定您想要提供自定义的所有区域，例如标题背景图像、背景和文本颜色等。然后构建应用程序代码以允许指定哪个主题加载并调出该 CSS 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T14:50:55.347

我个人会选择基于 CSS 的解决方案。

您可以为 Web 应用程序中的每个页面定义元素的 ID 和 CSS 类，以便客户可以提供他们自己的 CSS 文件集。

这种方法与平台无关，因此创建自定义主题的开发人员不会被迫适应 ASP.NET 主题模型——她可能是一个没有编程知识的网页设计师。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T14:52:51.503

[主题](http://msdn.microsoft.com/en-us/library/ykzx33wh.aspx)可能是一个很好的解决方案，但重新阅读您的问题后，我认为您可能会要求一种允许客户动态提交自己的品牌的方法，即无需修改任何文件，一种不干涉的方法？拥有一个由 Web 表单组成的管理界面，客户可以自己上传图像和 CSS 怎么样？然后，您可以使用 HttpHandler 或类似方法检索该内容。

# python - 为什么 Python 中的字典和列表不继承 'len' 函数

> ID：83983
> 
> 赞同：17
> 
> 时间：2008-09-17T14:43:18.487
> 
> 标签：python

例子：

```
a_list = [1, 2, 3]
a_list.len() # doesn't work
len(a_list) # works 
```

Python（非常）面向对象，我不明白为什么'len'函数不被对象继承。另外，我一直在尝试错误的解决方案，因为它对我来说似乎是合乎逻辑的

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-09-17T14:59:53.907

Guido的解释在[这里](http://mail.python.org/pipermail/python-3000/2006-November/004643.html)：

> 首先，出于 HCI 的原因，我选择了 len(x) 而不是 x.len()（def __len__() 来得晚得多）。实际上有两个相互交织的原因，都是 HCI：
> 
> (a) 对于某些运算，前缀符号比后缀读起来更好——前缀（和中缀！）运算在数学中有着悠久的传统，它喜欢视觉帮助数学家思考问题的符号。比较我们将像 x*(a+b) 这样的公式重写为 x*a + x*b 的简单性与使用原始 OO 表示法做同样事情的笨拙。
> 
> (b) 当我读到 len(x) 的代码时，我知道它是在询问某物的长度。这告诉我两件事：结果是一个整数，而参数是某种容器。相反，当我阅读 x.len() 时，我必须已经知道 x 是某种实现接口或继承自具有标准 len() 的类的容器。当一个没有实现映射的类有一个 get() 或 keys() 方法，或者不是文件的东西有一个 write() 方法时，我们偶尔会感到困惑。
> 
> 以另一种方式说同样的话，我将“len”视为内置操作。我不想失去那个。/…/

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-17T14:59:54.263

简短的回答：1）向后兼容性和 2）没有足够的区别让它真正重要。有关更详细的说明，请继续阅读。

此类操作的惯用 Python 方法是不打算直接调用的特殊方法。例如，要`x + y`为您自己的类工作，您编写一个`__add__`方法。要确保`int(spam)`正确转换您的自定义类，请编写一个`__int__`方法。为了确保这样`len(foo)`做是明智的，请编写一个`__len__`方法。

这就是 Python 一直以来的情况，我认为这对某些事情很有意义。特别是，这似乎是实现运算符重载的明智方法。至于其余的，不同的语言不同意；在 Ruby 中，您可以通过`spam.to_i`直接调用而不是说`int(spam)`.

没错，Python 是一种非常面向对象的语言，并且必须在对象上调用外部函数来获取其长度似乎很奇怪。另一方面，`len(silly_walks)`并​​不比 更繁琐`silly_walks.len()`，Guido 说他实际上更喜欢它 ( [http://mail.python.org/pipermail/python-3000/2006-November/004643.html](http://mail.python.org/pipermail/python-3000/2006-November/004643.html) )。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-17T14:46:56.777

它只是不是。

但是，您可以这样做：

```
>>> [1,2,3].__len__()

3 
```

向类添加`__len__()`方法是使`len()`魔术起作用的原因。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-17T15:04:16.907

这种方式更适合语言的其余部分。python 中的约定是`__foo__`向对象添加特殊方法以使它们具有某些功能（而不是例如从特定的基类派生）。例如，一个对象是

*   如果它有`__call__`方法 ，则可调用
*   如果它有`__iter__`方法，则可迭代，
*   如果有`__getitem__`和 ，则支持使用 [] 访问`__setitem__`。
*   ...

这些特殊方法之一是`__len__`使其具有可访问的长度`len()`。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-17T14:46:43.173

也许您正在寻找`__len__`. 如果该方法存在，则 len(a) 调用它：

```
>>> class Spam:
...   def __len__(self): return 3
... 
>>> s = Spam()
>>> len(s)
3 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-17T14:48:37.413

好吧，实际上有一个长度方法，它只是被隐藏了：

```
>>> a_list = [1, 2, 3]
>>> a_list.__len__()
3 
```

len() 内置函数似乎只是一个包装器，用于调用对象的隐藏**len** () 方法。

不知道为什么他们决定以这种方式实施事情。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-17T15:16:26.457

下面有一些很好的信息，说明为什么某些事物是函数而其他事物是方法。它确实会导致语言中的一些不一致。

[http://mail.python.org/pipermail/python-dev/2008-January/076612.html](http://mail.python.org/pipermail/python-dev/2008-January/076612.html)

# javascript - 是文件名还是整个 URL 用作浏览器缓存中的键？

> ID：83990
> 
> 赞同：27
> 
> 时间：2008-09-17T14:44:06.907
> 
> 标签：javascript, url, browser, caching, filenames

通常希望浏览器缓存资源 - JavaScript、CSS、图像等，直到有新版本可用，然后确保浏览器获取并缓存新版本。

一种解决方案是在资源的文件名中嵌入版本号，但是以这种方式将要管理的资源放置在具有修订号的目录中会做同样的事情吗？文件的整个 URL 是用作浏览器缓存中的键，还是只是文件名本身和一些元数据？

如果我的代码从 fetching 更改`/r20/example.js`为`/r21/example.js`，我是否可以确定修订版 20 已`example.js`被缓存，但现在修订版 21 已被获取并且现在已缓存？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-09-17T17:02:05.517

是的， URL*任何部分*的任何更改（不包括 HTTP 和 HTTPS 协议更改）都会被浏览器（以及任何中间代理）解释为不同的资源，因此会在浏览器缓存中产生一个单独的实体。

**更新：**

[这篇 ThinkVitamin 文章](http://www.thinkvitamin.com/features/webapps/serving-javascript-fast)中声称 Opera 和 Safari/Webkit 浏览器不缓存带有 ?query=strings 的 URL的说法是**false**。

将版本号参数添加到 URL 是一种完全可以接受的缓存清除方法。

可能让 ThinkVitamin 文章的作者感到困惑的是，在 Safari 和 Opera 的地址/位置栏中按 Enter 会导致带有查询字符串的 URL 出现不同的行为。

但是，（*这是重要的部分！*）Opera 和 Safari在缓存网页中嵌入/链接的图像以及样式表和脚本时的**行为与 IE 和 Firefox 类似——无论它们是否有“？”。**URL 中的字符。（这可以通过在普通 Apache 服务器上的简单测试来验证。）

（如果我有声望，我会评论当前接受的答案。:-)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-01-18T09:55:18.267

浏览器缓存键是请求方法和资源 URI 的组合。URI 由方案、权限、路径、查询和片段组成。

[HTTP 1.1 规范](https://www.rfc-editor.org/rfc/rfc7234#section-2)的相关摘录：

> 主缓存键由请求方法和目标 URI 组成。但是，由于当今常用的 HTTP 缓存通常仅限于缓存对 GET 的响应，因此许多缓存只是拒绝其他方法并仅使用 URI 作为主缓存键。

[URI 规范](https://www.rfc-editor.org/rfc/rfc3986#section-3)的相关摘录：

> 通用 URI 语法由称为方案、权限、路径、查询和片段的组件的分层序列组成。

> ```
> URI         = scheme ":" hier-part [ "?" query ] [ "#" fragment ] 
> ```

> ```
> hier-part   = "//" authority path-abempty 
> ```

```
 / path-absolute
              / path-rootless
              / path-empty 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T14:46:23.703

我 99.99999% 确定它是用于在浏览器中缓存资源的整个 url，因此您的 url 方案应该可以正常工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-17T15:40:15.963

标识 HTTP 对象所需的最小值是完整路径，包括任何查询字符串参数。一些浏览器可能不会使用查询字符串缓存对象，但这与缓存的键无关。

同样重要的是要记住路径不再足够。HTTP 响应中的 Vary: 标头会提醒浏览器（或代理服务器等）除 URL 之外的任何其他内容，应用于确定缓存键，例如 cookie、编码值等。

对于您的基本问题，是的，更改 .js 文件的 URL 就足够了。对于决定缓存键的更大问题，它是 URL 加上 Vary: 标头限制。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T14:46:14.687

依靠。它应该是完整的 URL，但某些浏览器（Opera、Safari [2](http://www.thinkvitamin.com/features/webapps/serving-javascript-fast)）对具有不同参数的 url 应用不同的缓存策略。

**最好的办法是更改文件名**。

这里有一个非常聪明的解决方案（使用 PHP、Apache）

[http://verens.com/archives/2008/04/09/javascript-cache-problem-solved/](http://verens.com/archives/2008/04/09/javascript-cache-problem-solved/)

**策略说明：** “根据 HTTP 缓存规范的规定，用户代理不应该缓存带有查询字符串的 URL。虽然 Internet Explorer 和 Firefox 会忽略这一点，但 Opera 和 Safari 不会——为了确保所有用户代理都可以缓存您的资源，我们需要将查询字符串排除在其 URL 之外。”</p>

[http://www.thinkvitamin.com/features/webapps/serving-javascript-fast](http://www.thinkvitamin.com/features/webapps/serving-javascript-fast)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T14:46:42.317

是的。从缓存的角度来看，不同的路径是相同的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T14:47:41.597

当然它必须使用整个路径'/r20/example.js'与'/r21/example.js'可能是完全不同的图像开始。您的建议是处理版本控制的可行方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T16:38:56.943

整个网址。我在一些区分大小写的旧浏览器中看到了一种奇怪的行为。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-10-24T12:55:06.583

除了现有的答案之外，我只想补充一点，如果您使用 ServiceWorkers 或例如离线插件，它可能不适用。然后，您可能会遇到不同的缓存规则，具体取决于 ServiceWorker 的设置方式。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-09-17T14:52:04.283

在大多数浏览器中，都会使用完整的 url。在某些浏览器中，如果您在 url 中有查询，则该文档将永远不会被缓存。

# oracle - 如何更改 Oracle 10g 上的 IP 地址

> ID：83991
> 
> 赞同：6
> 
> 时间：2008-09-17T14:44:08.547
> 
> 标签：oracle, oracle10g, ip-address

我需要采取哪些步骤来更改 Oracle 10g 的 IP 地址？从 dhcp 地址转到静态 IP 并重新启动后，我无法连接到数据库。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T15:54:07.537

如果服务器的 IP 地址发生变化，我首先要看的就是这些：

客户端上的 TNSNAMES.ORA 文件——它有硬编码的 IP 地址吗？如果是这样，请更改它。它使用机器名称吗？如果是这样，机器名称是否解析为客户端机器上的正确 IP 地址？

服务器上的 LISTENER.ORA 文件——它是否明确指定旧 IP 地址作为其监听地址？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T14:46:49.833

请提供更多信息。您的意思是您已经更改了数据库所在主机的 ip 地址，现在您必须从不同的机器连接到它，或者您在 ip 更改后无法启动数据库？

...您收到什么错误消息？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-20T14:42:57.577

最明显的要检查的文件是：

$ORACLE_HOME/network/admin/tnsnames.ora $ORACLE_HOME/network/admin/listener.ora

除此之外，我们还需要更多信息……

*   我想您的意思是 Oracle 10g DB 而不是 Oracle 10g 应用服务器？
*   数据库启动正常吗？
*   数据库警报日志中有任何内容吗？
*   错误是从客户端连接还是从服务器连接？
*   您收到什么错误消息？
*   您可以从客户端+服务器上ping机器的新地址（通过名称+ IP地址）吗？
*   TNSPING 有效吗？
*   您可以在服务器上使用 SQL*Plus 进行连接吗？
*   您尝试过连接哪些其他工具？

**评论后更新**

请问可以发帖吗...

*   您的旧 IP 地址（如果您知道的话）
*   您的新 IP 地址
*   您的 FQDN（例如 machine.domain.com）
*   “ipconfig/all”（或等效）的输出
*   您的 listener.ora 文件
*   “$ORACLE_HOME/bin/lsnrctl start”的输出
*   “$ORACLE_HOME/bin/lsnrctl status”的输出

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-02-04T06:43:38.587

检查 LOCAL_LISTENER 是否未在数据库中定义（或正确定义） - 由于此处输入不正确，它可能未正确注册。还可以尝试“ALTER SYSTEM REGISTER”以尝试向侦听器注册（而不是等待长达 3 分钟的自动注册）。检查 listener.log 以查看已注册的实例 (service_update * ) 和“lsnrctl status”以查看它是否存在。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-06-21T07:43:26.850

您是否更改了 DNS 中的主机名？你能从另一台机器上ping主机名吗？**********```****