# StackOverflow 问答 000545000-000545999

# c# - 如何从单独的 C# 项目调用 VSTO AddIn 方法？

> ID：545014
> 
> 赞同：7
> 
> 时间：2009-02-13T07:06:19.960
> 
> 标签：c#, .net, visual-studio-2008, vsto, add-in

我有一个 C# Excel 插件项目“MyExcelAddIn”，它有一个公共方法 Foo() 来做一些复杂的事情。出于测试目的，加载项还定义了一个工具栏按钮，该按钮连接到 Foo()，因此我可以对此进行测试并验证单击该按钮是否调用 Foo() 并执行我希望它执行的操作。这可以。

现在我想从 C# Windows 窗体项目中调用此方法。在 Windows 窗体项目中，我可以创建一个 Excel 实例并使其可见并验证我的 VSTO 加载项是否正在运行，因为我可以看到该按钮并且它工作正常。但我不知道如何从 Windows 窗体项目中以编程方式调用 Foo()。我用谷歌搜索了一下，得到了“MyExcelAddIn”COMAddIn 对象，但不知道如何调用 Foo()。

它看起来像这样：

```
// Create Excel and make it visible
Application excelApp = new Application();
excelApp.Visible = true;

// I know my VSTO add-in is running because I can see my test button
// Now get a reference to my VSTO add-in
Microsoft.Office.Core.COMAddIns comAddIns = _excelApp.COMAddIns;
object addinName = "MyExcelAddIn";
Microsoft.Office.Core.COMAddIn myAddin = comAddIns.Item(ref addinName);
// This works, but now what? How do I make a call on myAddin?
// Note that myAddin.Object is null... 
```

所以我想知道如何从我的 Windows 窗体应用程序中调用 Foo()。请注意，我可以完全控制 Windows 窗体应用程序和加载项，并且我怀疑我必须对它们进行更改（尤其是加载项），但我不知道如何执行此操作。

请注意，这是一个 VS2008 C# 应用程序，我使用的是 Excel 2003。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T04:53:36.557

如果您正在构建应用程序级加载项，我相信这可能是您的答案：[MSDN VSTO 文章](http://msdn.microsoft.com/en-us/library/bb608621.aspx)

它涉及两个步骤：（来自文章）

1.  在您的加载项中，将对象公开给其他解决方案。
2.  在另一个解决方案中，访问由您的加载项公开的对象，并调用该对象的成员。

另一个解决方案可能是：（再次来自文章）

*   在与加载项不同的进程中运行的任何解决方案（这些类型的解决方案也称为进程外客户端）。其中包括自动化 Office 应用程序的应用程序，例如 Windows 窗体或控制台应用程序，以及在不同进程中加载​​的加载项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-14T16:21:26.580

我正在使用 SendMessage Win32 API 来执行此操作。我的 C# 插件创建了一个“NativeWindow”，它具有 WinForm 应用程序可以找到的唯一窗口标题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T07:45:29.867

我假设您的方法 Foo 以某种方式与 Excel 交互。否则，您只需使用 Foo 方法添加对包含该类的程序集的引用，然后从那里调用它，而无需实例化 Excel。

我能想到的唯一其他方法是通过 excelApp 对象获取对 CommandBarButton 的引用。CommandBarButton 有一个名为 Execute 的方法，它类似于单击按钮。像这样的东西：

```
 Excel.Application excelApp = new Excel.Application(); 
        CommandBarButton btn = excelApp.CommandBars.FindControl(...) as CommandBarButton;
        btn.Execute(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-01T20:43:44.843

对于发现这个的其他人，这就是我所做的：

```
 object addInName = "AddinName";
        var excelApplication = (Microsoft.Office.Interop.Excel.Application)Marshal.GetActiveObject("Excel.Application");
        COMAddIn addIn = excelApplication.COMAddIns.Item(ref addInName);

        addIn.Object.AddinMethodName(params); 
```

还必须在 COM 下添加对 Microsoft.Office.Core 的引用，在 Assemblies 下添加对 Excel.Interop 的引用。

# c - 如何在 sscanf 中传递可变长度宽度说明符？

> ID：545018
> 
> 赞同：14
> 
> 时间：2009-02-13T07:09:02.200
> 
> 标签：c

```
sscanf(input_str, "%5s", buf); //reads at max 5 characters from input_str to buf 
```

但我需要使用 %MACRO_SIZEs 而不是 %5s

一个简单的解决方案是为相同的创建格式字符串

```
char fmt_str[100] = "";    
snprintf(fmt_str, 100, "%%%ds", MACRO_SIZE);
sscanf(input_str, fmt_str, buf); 
```

有没有更好的方法来实现同样的目标？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-13T07:23:43.943

就像 Stefan 说的那样，但是为了`sscanf()`更正确地回答这个问题，并使用更多的宏观技巧：

```
#define MACRO_SIZE 5

#define FORMAT(S) "%" #S "s"
#define RESOLVE(S) FORMAT(S)

char buf[MACRO_SIZE + 1];
sscanf(input_str, RESOLVE(MACRO_SIZE), buf); 
```

这使用 C 将相邻字符串文字自动连接在一起，在编译时形成所需的格式化字符串。这仅适用`MACRO_SIZE`于预处理器宏，而不是正常的运行时变量。

需要通过额外的宏调用，`RESOLVE()`否则参数将无法解析为其`#define`d 值，并且我们最终会得到一个格式化字符串`"%MACRO_SIZEs"`，这不是我们想要的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-13T07:14:56.630

如果你的 MACRO_SIZE 在编译时是 const 的，你可以试试这个：

```
#define MACRO_SIZE "5"
snprintf(fmt_str, 100, "%" MACRO_SIZE "s", buf); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-13T08:14:46.270

“正确”的解决方案就是您所说的微不足道的解决方案。所有这些聪明的宏（我自己会使用 m4）只会让你的代码更难管理，如果你只是把它作为一个常量。

您在这里遇到的问题是字符串不是 C 中的第一类数据结构。它们是一个字节数组。因此，您必须构建想要获得所需含义的数组，然后使用 sprintf 构建该数组。这不漂亮，但它是正确的。

如果您遇到性能问题并且您已经追踪到这里，那么可以，消除函数调用。但除非 MACRO_SIZE 的值重复一百次或分布在多个文件中，否则我只会更改文字。宏只是假装具有更大的灵活性，使用 sprintf 实际上为您提供了灵活性。

# sharepoint - WSS 2.0 - 使用用户令牌创建 SPSite

> ID：545022
> 
> 赞同：2
> 
> 时间：2009-02-13T07:10:58.327
> 
> 标签：sharepoint

我正在开发一个使用对象模型将文档上传到共享点文档库的应用程序。我的应用程序在 LocalSystem 用户下作为 Windows 服务运行。在这里，上传时我需要将上下文设置给另一个用户。我有我的用户名。在 MOSS 2007 中，我有一个选项可以在初始化 SPSite 对象时指定用户令牌。我正在为 WSS 2.0 寻找类似的东西，但找不到。

如何为 WSS 2.0 设置用户上下文？请帮忙。

谢谢，贾格纳特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T09:50:20.440

此功能首先在 WSS 3.0 对象模型中引入。WSS 2.0 中没有类似的功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T14:37:26.460

***EDIT:*** *There is bound to be an easier way but this is a nice reusable class and I use it extensively for just this type of operation (but not with the SP OM, at least not yet).*

You would have to write a seperate piece of .Net code (some umanaged calls too) to perform impersonation of your user then call the SP object model whilst impersonating that user. You can then restore the user account afterwards:

## VB Sample

```
Public Class UserImpersonation

    Private Declare Auto Function LogonUser Lib "advapi32.dll" (ByVal lpszUsername As [String], _
        ByVal lpszDomain As [String], ByVal lpszPassword As [String], _
        ByVal dwLogonType As Integer, ByVal dwLogonProvider As Integer, _
        ByRef phToken As IntPtr) As Boolean

    <DllImport("kernel32.dll")> _
    Private Shared Function FormatMessage(ByVal dwFlags As Integer, ByRef lpSource As IntPtr, _
        ByVal dwMessageId As Integer, ByVal dwLanguageId As Integer, ByRef lpBuffer As [String], _
        ByVal nSize As Integer, ByRef Arguments As IntPtr) As Integer

    End Function

    Private Declare Auto Function CloseHandle Lib "kernel32.dll" (ByVal handle As IntPtr) As Boolean

    Private Declare Auto Function DuplicateToken Lib "advapi32.dll" (ByVal ExistingTokenHandle As IntPtr, _
            ByVal SECURITY_IMPERSONATION_LEVEL As Integer, _
            ByRef DuplicateTokenHandle As IntPtr) As Boolean

    <PermissionSetAttribute(SecurityAction.Demand, Name:="FullTrust")> _
    Public Shared Function ImpersonateUser(ByVal strDomain As String, ByVal strUserid As String, ByVal strPassword As String) As WindowsImpersonationContext

        Dim tokenHandle As New IntPtr(0)
        Dim dupeTokenHandle As New IntPtr(0)

        Try
            ' Get the user token for the specified user, domain, and password using the 
            ' unmanaged LogonUser method.  
            ' The local machine name can be used for the domain name to impersonate a user on this machine.

            Const LOGON32_PROVIDER_DEFAULT As Integer = 0
            'This parameter causes LogonUser to create a primary token.
            Const LOGON32_LOGON_INTERACTIVE As Integer = 2

            tokenHandle = IntPtr.Zero

            ' Call LogonUser to obtain a handle to an access token.
            Dim returnValue As Boolean = LogonUser(strUserid, strDomain, strPassword, LOGON32_LOGON_INTERACTIVE, LOGON32_PROVIDER_DEFAULT, tokenHandle)

            If returnValue = False Then
                Dim ret As Integer = Marshal.GetLastWin32Error()
                Throw New System.ComponentModel.Win32Exception(ret)
            Else
                ' Use the token handle returned by LogonUser.
                Dim newId As New WindowsIdentity(tokenHandle)
                Dim ImpersonatedUser As WindowsImpersonationContext = newId.Impersonate()

                Return ImpersonatedUser
            End If

        Catch ex As Exception
            Console.WriteLine("UserImpersonation.impersonateUser Exception Occurred: " + ex.Message)

            Return Nothing
        End Try

        ' Free the tokens.
        If Not System.IntPtr.op_Equality(tokenHandle, IntPtr.Zero) Then
            CloseHandle(tokenHandle)
        End If
    End Function

    Public Shared Function UndoImpersonate(ByVal WIC As WindowsImpersonationContext) As Boolean
        Try
            ' Stop impersonating the user.
            WIC.Undo()

            Return True
        Catch ex As Exception
            Console.WriteLine(("Exception occurred. " + ex.Message))

            Return False
        End Try

    End Function
End Class 
```

# asp.net - 使用 JQuery 更改表格边框颜色

> ID：545024
> 
> 赞同：1
> 
> 时间：2009-02-13T07:11:00.977
> 
> 标签：asp.net, jquery

我有一个包含 HTML 的用户控件，如下所示：

```
<table id="tblProgramInfo" runat="server" cellpadding="0" cellspacing="0" class="ProgramInfo">
<tr>
    <td>
        <table cellpadding="0" cellspacing="0" width="100%" class="tblProgram" abc="def">
            <tr>
                <td>
                    Some data
                </td>
            </tr>
        </table>
    </td>
</tr> 
```

由于它是一个用户控件，它们可以是具有相同类“ProgramInfo”和“tblProgram”的多个表。现在，我使用 Jquery 为“ProgramInfo”类附加了 mouseover 和 mouseout 事件。我想要的是，**在 mousemove 和 mouseout 上更改包含类“tblProgram”的内部表格的边框颜色**。
我的 mousemove 和 mouseevent 是：

```
$(document).ready(function()
{
    $(".ProgramInfo").mouseover(function()
     {
    // Code here?
     });
    $(".ProgramInfo").mouseout(function()
    { 
    // Code here?
    });
}); 
```

另外，**我想通过 JQuery 改变上表的宽度和高度**。当我尝试这个时，我得到了宽度：自动。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T07:30:26.330

查看 jQuery hover() 方法：

[http://docs.jquery.com/Events/hover](http://docs.jquery.com/Events/hover)

它为 mouseover/-out 提供了更清晰的抽象

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T07:17:02.960

```
$(this).find('.tblProgram').css({ borderColor:"cdd6e8" }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T08:26:08.567

虽然其他答案包括动态更改 CSS 属性，但更改类可能是更好的做法。这样可以避免样式污染您的 JS，并帮助您避免为了以后的基本设计更新而不得不寻找这些样式来更改它们。

```
$(document).ready(function() {
    $(".ProgramInfo").mouseover(function() {
        $(this).width($('#baseTable').width());
        $(".tblProgram", this).addClass('hover');
    });
    $(".ProgramInfo").mouseout(function() {
        $(this).width(100);
        $(".tblProgram", this).removeClass('hover');
    });
}); 
```

（我刚刚为此修改了 Aexander Prokofyev 的代码，不确定宽度的东西......）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-13T07:29:15.473

你可以这样做：

```
$(document).ready(function()
{
    $(".ProgramInfo").mouseover(function()
    {
        $(this).width($('#baseTable').width());
        $(".tblProgram", this).css("border", "solid black 1px");
     });
    $(".ProgramInfo").mouseout(function()
    { 
        $(this).width(100);
        $(".tblProgram", this).css("border", "solid red 1px");
    });
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-13T08:38:03.717

我想知道它是**gridview**还是**data control**，在这种情况下是完成的最佳方式，并且如果您想从放置控件的实际页面中抽象悬停功能（想象一下，对于您使用控件的所有页面，您需要将该代码放在页面本身中）。

因此，最好的方法是使用 DataItem 事件（或类似于所有数据控件）

假设您有一个名为 myGrid 的 GridView。

**ASP.NET 事件**

```
protected void myGrid_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    { 
        // it's a row that contains data, so let's attach the mouse hover effects here to each row
        GridViewRow tr = e.Row;

        // a little of jQuery to add a class when the mouse is over the row, and to remove it once is out of the row
        tr.Attributes.Add("onmouseover", "$(this).addClass('gvSelectedDisabled');");
        tr.Attributes.Add("onmouseout", "$(this).removeClass('gvSelectedDisabled');");
    }
} 
```

**HTML**

```
<asp:GridView ID="myGrid" runat="server" 
    onrowdatabound="myGrid_RowDataBound">
</asp:GridView> 
```

**附言**

例如，如果您想为对象数据中包含一些标志和其他颜色的项目显示绿色背景，请参阅我在本主题中的回答：

> [有选择地将css应用于gridview中的一行](https://stackoverflow.com/questions/208038/selectively-apply-css-to-a-row-in-a-gridview/208067#208067)

# java - Hibernate：集合的集合

> ID：545047
> 
> 赞同：20
> 
> 时间：2009-02-13T07:24:09.090
> 
> 标签：java, hibernate, collections

这是我一直遇到的问题：

我想让hibernate管理一个代表集合集合的表。例如：

*   地图地图
*   集列表
*   列表地图

例如，我希望能够表示这一点：

```
类拥有类{  
    长实体ID；  
    Map<String, List<Element>> mapOfLists;
}

类元素{
    字符串数据_1；
    布尔数据_2；
}

```

作为一个表：

```
OWNER（此元素所有者的外键）
MAP_KEY (varchar(30) )
LIST_INDEX (int)
ELEMENT_DATA_1 (varchar(1020)
ELEMENT_DATA_2（位）

```

如果没有自定义休眠代码，这似乎是不可能的，我不介意。但我希望有人对自定义代码的外观有一些指导。

*   我应该扩展 AbstractPersistentCollection 吗？
*   复合用户类型？

如果多个表都可以，则可以进行管理，但从数据库的角度来看，这显然是蹩脚的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2018-07-31T15:15:54.863

[在https://xebia.com/blog/mapping-multimaps-with-hibernate/](https://xebia.com/blog/mapping-multimaps-with-hibernate/)上找到了答案

这是 11 年前的一篇长博文。关键代码是：

```
public class MultiMapType implements UserCollectionType {

public boolean contains(Object collection, Object entity) {
    return ((MultiMap) collection).containsValue(entity);
}

public Iterator getElementsIterator(Object collection) {
    return ((MultiMap) collection).values().iterator();
}

public Object indexOf(Object collection, Object entity) {
    for (Iterator i = ((MultiMap) collection).entrySet().iterator(); i.hasNext();) {
        Map.Entry entry = (Map.Entry) i.next();    
        Collection value = (Collection) entry.getValue();
        if (value.contains(entity)) {
            return entry.getKey();
        }
    }
    return null;
}

public Object instantiate() {
    return new MultiHashMap();
}

public PersistentCollection instantiate(SessionImplementor session, CollectionPersister persister) throws HibernateException {
    return new PersistentMultiMap(session);
}

public PersistentCollection wrap(SessionImplementor session, Object collection) {
    return new PersistentMultiMap(session, (MultiMap) collection);
}

public Object replaceElements(Object original, Object target, CollectionPersister persister, Object owner, Map copyCache, SessionImplementor session) throws HibernateException {

    MultiMap result = (MultiMap) target;
    result.clear();

    Iterator iter = ( (java.util.Map) original ).entrySet().iterator();
    while ( iter.hasNext() ) {
        java.util.Map.Entry me = (java.util.Map.Entry) iter.next();
        Object key = persister.getIndexType().replace( me.getKey(), null, session, owner, copyCache );
        Collection collection = (Collection) me.getValue();
        for (Iterator iterator = collection.iterator(); iterator.hasNext();) {
            Object value = persister.getElementType().replace( iterator.next(), null, session, owner, copyCache );
            result.put(key, value);
        }
    }

    return result;
} 
```

}

这里也有一些讨论：[Multimap in Hibernate](https://stackoverflow.com/questions/475879/multimap-in-hibernate/475921#475921)

# java - 如何使用 VIM/GVIM 调试 Java 应用程序？

> ID：545056
> 
> 赞同：29
> 
> 时间：2009-02-13T07:28:28.610
> 
> 标签：java, debugging, vim, editor

我之前问过这个问题（[any-good-tutorial-for-moving-from-eclipse-to-vim](https://stackoverflow.com/questions/495268/any-good-tutorial-for-moving-from-eclipse-to-vim)）

从输入开始，我开始使用 GVIM 而不是 Eclipse。我添加`ctags`了它，现在我可以舒适地导航了。

留给我的唯一问题是“调试”？我尝试搜索一些链接，但找不到有用的链接？

如果有人使用或熟悉使用 vim/Gvim 进行 Java 调试，可以提供他们的输入/链接/教程，这将非常有帮助。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-13T07:39:36.493

您最好的选择似乎是命令行调试器的集成`jdb`，一个这样的解决方案是[yavdb](http://www.vim.org/scripts/script.php?script_id=1954)，另一个是[JavaKit](http://www.vim.org/scripts/script.php?script_id=1154)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-04-19T17:23:18.313

Eclim 现在支持 Java 调试器。见[http://eclim.org/vim/java/debug.html](http://eclim.org/vim/java/debug.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-13T07:37:36.373

您可能无法避免安装[独立的调试器](https://stackoverflow.com/questions/370072/recomend-a-standalone-java-debugger)

（就像一个只用于远程调试应用程序的 Eclipse）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T17:46:58.667

Eclim 提供 Vim 和 Eclipse 之间的集成。它应该允许你在 Vim 中使用 Eclipse 的调试器

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-08-19T15:58:18.877

# Vim 中的调试：

同时有[vimspector](https://github.com/puremourning/vimspector)，即

> Vim 的多语言图形调试器。

## 在 Vim 中调试 Java：

有关将它与 Java 一起使用，请参阅[本节](https://github.com/puremourning/vimspector#java)。

*注意：*请注意，它需要以下版本之一：

1.  使用 Python 3.6 或更高版本编译的 Vim 8.2 Huge build
2.  Neovim 0.4.3 和 Python 3.6 或更高版本（实验性）

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2010-04-16T11:51:18.553

[在http://jvi.sourceforge.net/](http://jvi.sourceforge.net/)上有一个很棒的用于 netbeans 的 vim 插件叫做 jVi

# asp.net-mvc - 为 ASP.NET MVC 寻找商业 UI 丰富的控件

> ID：545060
> 
> 赞同：0
> 
> 时间：2009-02-13T07:32:21.940
> 
> 标签：asp.net-mvc

我正在寻找一套用于 ASP.NET MVC 的丰富 UI 控件的商业套件。（*商业*套件，我知道 jQuery 有很多免费的东西）这意味着没有回发。最好用 jQuery 构建。

一些网络表单示例： [www.infragistics.com](http://www.infragistics.com) [http://www.componentart.com/](http://www.componentart.com/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T07:51:57.680

[Telerik RadControls](http://www.telerik.com/products/aspnet-ajax.aspx) for ASP .NET[支持 ASP .NET MVC](http://blogs.telerik.com/AtanasKorchev/Posts/08-11-06/ASP_NET_Ajax_Controls_in_ASP_NET_MVC.aspx)。

# character-encoding - 如何使 nntplib 作者姓名易于阅读？

> ID：545061
> 
> 赞同：0
> 
> 时间：2009-02-13T07:33:07.227
> 
> 标签：character-encoding, python-2.5

python NNTPLib 给了我作者的名字，例如，

"=?Utf-8?B?RGVubmlzIEJhc2hhbQ==?= <someone@someforum.com >"

（为清楚起见引用）。

我如何以人类可读的格式编码这个文本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T07:38:56.870

最后的双重等于是一个死的赠品。Base 64 使用它来填充没有 4 个字节的偶数倍数的字符串。

**在蟒蛇中：**

```
print "RGVubmlzIEJhc2hhbQ==".decode('base_64') 
```

**在 PHP 中：**

```
<?php echo base64_decode("RGVubmlzIEJhc2hhbQ=="); ?> 
```

享受。

PS...丹尼斯巴沙姆

# c# - 如果您使用 `using` 语句，何时需要调用 IDisposable？

> ID：545062
> 
> 赞同：4
> 
> 时间：2009-02-13T07:33:39.690
> 
> 标签：c#, .net

我正在阅读另一个答案。这让我想知道，如果我使用`using`语句，什么时候需要显式调用 Dispose？

编辑：

只是为了证明自己完全一无所知，我问的原因是因为另一个线程上的某个人说了一些话，暗示有充分的理由必须手动调用 Dispose ......所以我想，为什么不问一下呢？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-13T07:34:47.740

你没有。该`using`声明为您完成。

* * *

根据[MSDN](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)，此代码示例：

```
using (Font font1 = new Font("Arial", 10.0f)) 
{
    byte charset = font1.GdiCharSet;
} 
```

编译时扩展为以下代码（注意额外的花括号以创建对象的有限范围）：

```
{
  Font font1 = new Font("Arial", 10.0f);
  try
  {
    byte charset = font1.GdiCharSet;
  }
  finally
  {
    if (font1 != null)
      ((IDisposable)font1).Dispose();
  }
} 
```

* * *

**注意：**正如[@timvw 提到](https://stackoverflow.com/questions/545062/when-do-you-need-to-call-idisposable-if-you-are-using-using-statments/545139#545139)的，如果您在 using 语句本身中链接方法或使用对象初始值设定项并抛出异常，则不会释放该对象。如果您查看它将扩展到什么，这是有道理的。例如：

```
using(var cat = new Cat().AsDog())
{
   // Pretend a cat is a dog
} 
```

扩展到

```
{
  var cat = new Cat().AsDog(); // Throws
  try
  {
    // Never reached
  }
  finally
  {
    if (cat != null)
      ((IDisposable)cat).Dispose();
  }
} 
```

`AsDog`显然会抛出一个异常，因为猫永远不会像狗一样令人敬畏。这只猫将永远不会被处理掉。当然，有些人可能会争辩说猫永远不应该被丢弃，但这是另一个讨论......

无论如何，只要确保您所做的事情`using( here )`是安全的，并且您一切顺利。（显然，如果构造函数失败，对象将不会被创建开始，因此无需处置）。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-13T07:37:57.950

通常你不会。这是 using 语句的要点。然而，有一种情况你必须小心：

如果您将变量重新分配给另一个值，则 using 语句将仅对原始值调用 Dispose 方法。

```
using (someValue = new DisposableObject())
{
    someValue = someOtherValue;
} 
```

编译器甚至会给你一个**警告**：

> 可能不正确地分配给本地“someValue”，这是 using 或 lock 语句的参数。Dispose 调用或解锁将发生在本地的原始值上。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-13T08:14:12.107

不过在使用 c# 3.0 对象初始化器时要小心。一个例子可以在这里找到：http: [//ayende.com/Blog/archive/2009/01/15/avoid-object-initializers-amp-the-using-statement.aspx](http://ayende.com/Blog/archive/2009/01/15/avoid-object-initializers-amp-the-using-statement.aspx)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-13T07:34:55.960

绝不。一旦 using 块中的语句完成执行，它将调用 Dispose。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-13T07:37:54.267

using 语句的全部要点是，如果您的对象实现了 IDisposable，则将在代码块的末尾调用 dipose。这就是它的用途，自动为您完成。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-13T07:50:02.990

据我所知

```
using (var myDisposable = new MyDisposable())
{
   ...
} 
```

基本上是由编译器翻译成

```
var myDisposable = new MyDisposable()
try
{
   ...
}
finally
{
   myDisposable.Dispose();
} 
```

# asp.net-mvc - HTML 页面布局在 IE7 中看起来不错，但在 IE6 中却不行

> ID：545076
> 
> 赞同：1
> 
> 时间：2009-02-13T07:41:16.227
> 
> 标签：asp.net-mvc, css, internet-explorer-6, internet-explorer-7

我有一个在 IE7 上运行良好的 ASP.NET MVC 视图，但是当我尝试用 IE6 来查看它时看起来真的很糟糕。在 IE6 中，页面的白色区域（ContentPlaceHolder 部分）会聚集在右侧，并且会在我调整窗口大小时做一些奇怪的事情，比如四处移动。我查看了 .aspx、Site.Master 和 Site.css 以查看问题所在，但在任何地方都找不到！有人可以帮忙吗？这是我的文件：

登录.aspx：

```
<%@ Page Language="C#" MasterPageFile="~/Views/Shared/Site.Master" AutoEventWireup="true" CodeBehind="Login.aspx.cs" Inherits="EventScheduler.View.Views.Account.Login" %>

<asp:Content ID="loginContent" ContentPlaceHolderID="MainContent" runat="server">
    <h2>Login</h2>
    <p>
        Please enter your username and password below.
    </p>
    <%= Html.ValidationSummary() %>

    <% using (Html.BeginForm()) { %>
        <div>
            <table>
                <tr>
                    <td>Username:</td>
                    <td>
                        <%= Html.TextBox("username") %>
                        <%= Html.ValidationMessage("username") %>
                    </td>
                </tr>
                <tr>
                    <td>Password:</td>
                    <td>
                        <%= Html.Password("password") %>
                        <%= Html.ValidationMessage("password") %>
                    </td>
                </tr>
                <tr>
                    <td></td>
                    <td><input type="submit" value="Login" /></td>
                </tr>
            </table>
        </div>
    <% } %>
</asp:Content> 
```

Site.Master：

```
<%@ Master Language="C#" AutoEventWireup="true" CodeBehind="Site.master.cs" Inherits="EventScheduler.View.Views.Shared.Site" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <title><%= Html.Encode(ViewData["Title"]) %></title>
    <link href="../../Content/Site.css" rel="stylesheet" type="text/css" />
</head>

<body>
    <div class="page">

        <div id="header">
            <div id="title">
                <h1>ASCCC Event Scheduler Application</h1>
            </div>

            <div id="logindisplay">
                <% Html.RenderPartial("LoginUserControl"); %>
            </div> 

            <div id="menucontainer">

                <ul id="menu">              
                </ul>

            </div>
        </div>

        <div id="main">
            <asp:ContentPlaceHolder ID="MainContent" runat="server" />

            <div id="footer">
                ASCCC Event Scheduler Application &copy; Copyright 2009
            </div>
        </div>
    </div>
</body>
</html> 
```

网站.css：

```
/*----------------------------------------------------------
The base color for this template is #5c87b2\. If you'd like
to use a different color start by replacing all instances of
#5c87b2 with your new color.
----------------------------------------------------------*/
body
{
    background-color: #5c87b2;
    font-size: .75em;
    font-family: Verdana, Helvetica, Sans-Serif;
    margin: 0;
    padding: 0;
    color: #696969;
}

a:link
{
    color: #034af3;
    text-decoration: underline;
}

a:visited
{
    color: #505abc;
}

a:hover
{
    color: #1d60ff;
    text-decoration: none;
}

a:active
{
    color: #12eb87;
}

p, ul
{
    margin-bottom: 20px;
    line-height: 1.6em;
}

/* HEADINGS   
----------------------------------------------------------*/
h1, h2, h3, h4, h5, h6
{
    font-size: 1.5em;
    color: #000;
    font-family: Arial, Helvetica, sans-serif;
}

h1
{
    font-size: 2em;
    padding-bottom: 0;
    margin-bottom: 0;
}
h2
{
    padding: 0 0 10px 0;
}
h3
{
    font-size: 1.2em;
}
h4
{
    font-size: 1.1em;
}
h5, h6
{
    font-size: 1em;
}

/* this rule styles <h2> tags that are the 
first child of the left and right table columns */
.rightColumn > h1, .rightColumn > h2, .leftColumn > h1, .leftColumn > h2
{
    margin-top: 0;
}

/* PRIMARY LAYOUT ELEMENTS   
----------------------------------------------------------*/

/* you can specify a greater or lesser percentage for the 
page width. Or, you can specify an exact pixel width. */
.page
{
    width: 90%;
    margin-left: auto;
    margin-right: auto;
}

#header
{
    position: relative;
    margin-bottom: 0px;
    color: #000;
    padding: 0;
}

#header h1
{
    font-weight: bold;
    padding: 5px 0;
    margin: 0;
    color: #fff;
    border: none;
    line-height: 2em;
    font-family: Arial, Helvetica, sans-serif;
    font-size: 32px !important;
}

#main
{
    padding: 30px 30px 15px 30px;
    background-color: #fff;
    margin-bottom: 30px;
    _height: 1px; /* only IE6 applies CSS properties starting with an underscrore */
}

#footer
{
    color: #999;
    padding: 10px 0;
    text-align: center;
    line-height: normal;
    margin: 0;
    font-size: .9em;
}

/* TAB MENU   
----------------------------------------------------------*/
ul#menu
{
    border-bottom: 1px #5C87B2 solid;
    padding: 0 0 2px;
    position: relative;
    margin: 0;
    text-align: right;
}

ul#menu li
{
    display: inline;
    list-style: none;
}

ul#menu li#greeting
{
    padding: 10px 20px;
    font-weight: bold;
    text-decoration: none;
    line-height: 2.8em;
    color: #fff;
}

ul#menu li a
{
    padding: 10px 20px;
    font-weight: bold;
    text-decoration: none;
    line-height: 2.8em;
    background-color: #e8eef4;
    color: #034af3;
}

ul#menu li a:hover
{
    background-color: #fff;
    text-decoration: none;
}

ul#menu li a:active
{
    background-color: #a6e2a6;
    text-decoration: none;
}

ul#menu li.selected a
{
    background-color: #fff;
    color: #000;
}

/* MISC  
----------------------------------------------------------*/
.clear
{
    clear: both;
}

.error
{
    color:Red;
}

#menucontainer
{
    margin-top:40px;
}

#title
{
    display:block;
    float:left;
    text-align:left;
}

#logindisplay
{
    font-size:1.1em;
    display:block;
    text-align:right;
    margin:10px;
    color:White;
}

#logindisplay a:link
{
    color: white;
    text-decoration: underline;
}

#logindisplay a:visited
{
    color: white;
    text-decoration: underline;
}

.field-validation-error
{
    color: #ff0000;
}

.input-validation-error
{
    border: 1px solid #ff0000;
    background-color: #ffeeee;
}

.validation-summary-errors
{
    font-weight: bold;
    color: #ff0000;
}

body
{
}

.button
{
    width:75px
}

.eventLink
{

}

.alert
{
    color:Red   
}

.message
{
    color:Green 
}

.registrationField
{
    width:700px
}

.registrationField_Enabled
{
    background-color:#336699;
    width:700px
}

.fieldName
{

}

.requiredBox
{

}

.detailType
{

}

.fieldOptions
{

}

.pageTitle
{
    color:Black;
    font-size:large
}

.pageSubTitle
{
    color:Black;
    font-size:medium
}

.staticFieldLabel
{
    color:Black;
    width:150px
}

.staticFieldTextBox
{
    width:250px
}

.dynamicFieldLabel
{
    color:Black;
    width:150px
}

.dynamicFieldDropDown
{
    width:250px
}

.dynamicFieldPhoneNumberUS1
{
    width:30px;
}

.dynamicFieldPhoneNumberUS2
{
    width:30px;
}

.dynamicFieldPhoneNumberUS3
{
    width:40px;
}

.dynamicFieldPhoneNumberUS4
{
    width:40px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T07:50:29.323

在页面换行上设置 90% 的宽度可能不是最好的主意。设置一个像素值（比如 800 像素）将消除您在跳转内容时可能遇到的一些问题。

此外，您应该修改 div#title 和 div#logindisplay

```
#title
{
    width: 600px;
    float:left;
}

#logindisplay
{
   font-size:1.1em;
   float:right;
   text-align:right;
   padding:10px;
   color:White;
   width:150px;
} 
```

似乎您希望页面居中。IE6 需要一点帮助。（文本对齐：中心；）

```
body
{
    background-color: #5c87b2;
    font-size: .75em;
    font-family: Verdana, Helvetica, Sans-Serif;
    margin: 0;
    padding: 0;
    color: #696969;
    text-align:center;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T07:53:20.907

是否值得尝试使它在 IE6 中看起来不错。它正在淘汰中，很少有人使用它。如果您为 IE7 + 8 和 Firefox 2 + 3 创建网站，那么您已经覆盖了 80% 的市场。

# asp.net - 正则表达式用它们的标签替换链接

> ID：545077
> 
> 赞同：-1
> 
> 时间：2009-02-13T07:41:44.743
> 
> 标签：asp.net, regex

我想通过使用正则表达式将链接转换为明确的文本。在绑定数据网格时，我有一个函数可以将（查看：文本）转换为链接。我的函数在这里。

```
Private Function Convertlook(ByVal str As String) As String

        Dim look As String
        Dim pattern As String = "\(look: ([a-z0-9$&.öışçğü\s]+)\)"
        Dim regex As New Regex(pattern, RegexOptions.IgnoreCase)
        Dim htmlanc As New System.Web.UI.HtmlControls.HtmlAnchor()
        Dim postbackRef As String = Page.GetPostBackEventReference(htmlanc, "$1")
        htmlanc.HRef = postbackRef
       str = regex.Replace(str, "(look: <a href=""javascript:" & htmlanc.HRef & """><font color=""#CC0000"">$1</font></a> )")      
        look = str
        Return look 

end function 
```

问题是我想编辑文本，我怎样才能将它反转为（看：文本）？我应该再次使用正则表达式吗？什么是正确的正则表达式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T08:25:46.447

看起来正则表达式可以简化为“尖括号之间的任何内容”

```
Dim regex As New Regex(".*>(.*)</font.*", RegexOptions.IgnoreCase)
str = regex.Replace(str, "(look: $1)") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T08:30:04.797

保留文本的转换版本和未转换版本（即在 ViewState 或 ControlState 中）不是更容易吗？那会为你省去很多麻烦。如果您的原始文本包含像 '<font' 这样的字符串会发生什么？

我建议：不要去那里，不值得努力。跟踪来源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T08:40:21.263

我在 C# 中更改了您的代码，这就是您想要的：

```
string str = "(look: trialText)";
string look = string.Empty;
string pattern = @"\(look: ([a-z0-9$&.öışçğü\s]+)\)";
Regex regex = new Regex(pattern, RegexOptions.IgnoreCase);
System.Web.UI.HtmlControls.HtmlAnchor htmlanc = new System.Web.UI.HtmlControls.HtmlAnchor();
string postbackRef = Page.GetPostBackEventReference(htmlanc, "$1");
htmlanc.HRef = postbackRef;

// Here I capture the text inside the anchor :
Match matchedText = regex.Match(str);
string textInsideLink = regex.Replace(matchedText.Value, "$1"); // textInsideLink = "trialText"

str = regex.Replace(str, "(look: <a href=\"javascript:" + htmlanc.HRef + "\"><font color=\"#CC0000\">$1</font></a> )");

// I replace captured text with another text :
str = Regex.Replace(str, "(" + textInsideLink + ")", "anotherTextInsideLink"); 
// str = "(look: <a href=\"javascript:__doPostBack('','anotherTextInsideLink')\"><font color=\"#CC0000\">anotherTextInsideLink</font></a> )" 
```

# database - 关于迁移到多层 Delphi 架构的建议

> ID：545080
> 
> 赞同：11
> 
> 时间：2009-02-13T07:43:35.580
> 
> 标签：database, delphi, architecture, delphi-2009, n-tier-architecture

我们有一个相对较大的应用程序，它与 Firebird 紧密相关（存储过程、视图等）。我们现在收到很多支持其他数据库的请求，我们还希望将很多功能从客户端转移到服务器。

现在似乎是迁移到 3(4) 层架构的好时机。我们已经看过 DataSnap 2009 和 RemObjects SDK/DataAbstract。两者似乎都可以胜任，但是我们应该注意哪些优点/缺点？您还有其他可以推荐的框架吗？

干杯，保罗

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-13T09:16:42.453

我可以推荐使用 Components4Developers 的 KBM Middleware 组件。有一点学习曲线，但它们非常灵活，并且在现实世界条件下使用得很好。

[来自用户的评论 (](http://www.components4programmers.com/usercomments/commentfromapowerusertoaquestion.htm) [http://www.components4programmers.com/usercomments/commentfromapowerusertoaquestion.htm](http://www.components4programmers.com/usercomments/commentfromapowerusertoaquestion.htm) )

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-13T19:49:34.697

使用新框架（RM、DS、kbmMW 或其他任何方式）将您的应用程序更改为多层，将对我们的应用程序架构进行大量更改，我建议将来使用此方法，但您可以实现对多层的支持数据库，以及其他产品，如

[DevArt](http://www.devart.com/unidac/)的 UniDac（直接连接数据库的最佳组件）。 [AnyDac](http://www.remobjects.com/anydac.aspx)（来自提供 RemObjects 的同一家公司 [。SqlDirect](http://www.sqldirect-soft.com/)（支持 9 MajorDB 和 ODBC） [。ZeosDB](http://sourceforge.net/projects/zeoslib)（开源）。

使用上述组件之一，将为您提供对大多数主要数据库的支持，除此之外，它不会使您进行大量更改，并且在某些情况下，您只需用新的数据库组件替换旧的数据库组件，并且可能会更改一些属性。

但是，改为多层不仅会使您只支持更多的数据库，而且会将您的业务逻辑与表示层分开，因此您可以为您的应用程序（如 Web 界面或智能设备）提供更多的表示层。

但在多层架构中最重要的是，您将拥有一个可扩展的系统，其增长超过您使用的数据库可以处理的连接，此外还有其他好处，例如使用其他语言编写客户端应用程序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-13T08:45:35.167

在迁移到多层应用程序的过程中，您可以考虑在层之间使用传输协议，该协议独立于语言/技术（如 web 服务，（我认为 remobjects 支持））。

这可以使以后层的重新实现更简单（例如，如果您以后必须在浏览器/java/silverlight 中创建另一个版本的客户端应用程序）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-13T19:39:17.090

您还可以调查中间件[http://www.overbyte.be/frame_index.html](http://www.overbyte.be/frame_index.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-17T15:33:52.917

对于多层架构，我还建议查看面向消息的中间件。

借助面向消息的中间件，可以使用点对点或发布/订阅通信模型实现跨语言和跨平台的应用程序集成。消息系统是松耦合、异步和可靠的。例如，它们是 Java(tm) 应用服务器（如 JBoss）中的核心组件。

对于 Firebird，我最近写了一篇关于替换 Firebird 数据库事件、它们的局限性以及用基于消息代理的解决方案（可作为开源）替换它们的方法的博客文章：

*   [Firebird 数据库事件和面向消息的中间件（第 1 部分）](http://mikejustin.wordpress.com/2012/11/06/firebird-database-events-and-message-oriented-middleware/)
*   [Firebird 数据库事件和面向消息的中间件（第 2 部分）](http://mikejustin.wordpress.com/2012/11/08/firebird-database-events-and-message-oriented-middleware-part-2/)

（免责声明：我是开源消息代理的 Delphi 和 Free Pascal 客户端库的开发人员）。

# java - 如何使用 Smack XMPP 库创建 SSL 连接？

> ID：545082
> 
> 赞同：6
> 
> 时间：2009-02-13T07:44:19.027
> 
> 标签：java, ssl, xmpp

我正在构建一个充当 XMPP 客户端的小程序，并且我正在使用[Smack](http://www.igniterealtime.org/projects/smack/index.jsp)库。现在，我要连接的服务器需要 SSL（在 Pidgin 中我必须检查“强制旧（端口 5223）SSL”）。我无法让 Smack 连接到此服务器。是否可以？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-09-29T23:31:16.850

看看这个线程。

[http://www.igniterealtime.org/community/thread/37678](http://www.igniterealtime.org/community/thread/37678)

本质上，您需要将这两行添加到您的代码中：

```
connConfig.setSecurityMode(ConnectionConfiguration.SecurityMode.enabled);
connConfig.setSocketFactory(new DummySSLSocketFactory()); 
```

其中 connConfig 是您的 ConnectionConfiguration 对象。从 Spark 源代码存储库中获取 DummySSLSocketFactory。它所做的只是接受几乎任何证书。这似乎对我有用。祝你好运！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-10-15T12:05:48.913

您可以通过以下方式实现此目的：

**将 CA 证书存储在 Keystore 中**

要将证书存储在密钥库中，请执行以下步骤。

**第 1 步：**下载 bouncycastle JAR 文件。可以从这里下载：Bouncy Castle JAVA Releases

**第 2 步：**使用以下命令将证书存储在密钥库中

> ```
> keytool -importcert -v -trustcacerts -file "<certificate_file_with_path>" -alias "<some_name_for_certificate>" -keystore "<file_name_for_the_output_keystore>" -provider org.bouncycastle.jce.provider.BouncyCastleProvider -providerpath "<bouncy_castle_jar_file_with_path>" -storetype BKS -storepass "<password_for_the_keystore>" 
> ```

**第 3 步：**验证密钥库文件

> ```
> keytool -importcert -v -list -keystore "<file_name_for_the_keystore_with_path>" -provider org.bouncycastle.jce.provider.BouncyCastleProvider -providerpath "<bouncy_castle_jar_file_with_path>" -storetype BKS -storepass "<password_for_the_keystore>" 
> ```

这将列出我们包含在密钥库中的证书。

我们有一个可以在代码中使用的密钥库。

**使用密钥库**

生成此密钥库后，将其保存在应用程序的原始文件夹中。使用以下代码获取与 openfire 服务器的证书握手。

要使用 XMPP 创建与 openfire 的连接，您可能需要获取配置。同样，使用以下方法：

> ```
> public ConnectionConfiguration getConfigForXMPPCon(Context context) {
>         ConnectionConfiguration config = new ConnectionConfiguration(URLConstants.XMPP_HOST, URLConstants.XMPP_PORT);
>         config.setSASLAuthenticationEnabled(false);
>         config.setSecurityMode(ConnectionConfiguration.SecurityMode.enabled);
>         config.setCompressionEnabled(false);
>         SSLContext sslContext = null;
>         try {
>             sslContext = createSSLContext(context);
>         } catch (KeyStoreException e) {
>             e.printStackTrace();
>         } catch (NoSuchAlgorithmException e) {
>             e.printStackTrace();
>         } catch (KeyManagementException e) {
>             e.printStackTrace();
>         } catch (IOException e) {
>             e.printStackTrace();
>         } catch (CertificateException e) {
>             e.printStackTrace();
>         }
> 
>         config.setCustomSSLContext(sslContext);
>         config.setSocketFactory(sslContext.getSocketFactory());
> 
>         return config;
>  }
> 
> private SSLContext createSSLContext(Context context) throws KeyStoreException,
>             NoSuchAlgorithmException, KeyManagementException, IOException, CertificateException {
>         KeyStore trustStore;
>         InputStream in = null;
>         trustStore = KeyStore.getInstance("BKS");
> 
>         if (StringConstants.DEV_SERVER_IP.equals(URLConstants.XMPP_HOST) || StringConstants.TEST_SERVER_IP.equals(URLConstants.XMPP_HOST))
>             in = context.getResources().openRawResource(R.raw.ssl_keystore_dev_test);
>         else if(StringConstants.STAGE_SERVER_IP.equals(URLConstants.XMPP_HOST) || StringConstants.STAGE2_SERVER_IP.equals(URLConstants.XMPP_HOST))
>             in = context.getResources().openRawResource(R.raw.ssl_keystore_stage);
>         else if(StringConstants.PROD_SERVER_IP.equals(URLConstants.XMPP_HOST) || StringConstants.PROD1_SERVER_IP.equals(URLConstants.XMPP_HOST))
>             in = context.getResources().openRawResource(R.raw.ssl_keystore_prod);
> 
>         trustStore.load(in, "<keystore_password>".toCharArray());
> 
>         TrustManagerFactory trustManagerFactory = TrustManagerFactory
>                 .getInstance(KeyManagerFactory.getDefaultAlgorithm());
>         trustManagerFactory.init(trustStore);
>         SSLContext sslContext = SSLContext.getInstance("TLS");
>         sslContext.init(null, trustManagerFactory.getTrustManagers(),
>                 new SecureRandom());
>         return sslContext;
> } 
> ```

全部做完..！！只需连接.. 现在您的连接是安全的。

在我的博客[smackssl.blogspot.in中都遵循相同的](http://smackssl.blogspot.in/2015/10/ssl-implementation-in-android-for-smack.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-31T22:02:33.723

是的，这很容易实现。看一下[ConnectionConfiguration](http://www.igniterealtime.org/builds/smack/docs/latest/javadoc/org/jivesoftware/smack/ConnectionConfiguration.html)类，特别是 setSecurityMode 方法，它接受 ConnectionConfiguration.SecurityMode 枚举作为参数。将此设置为“必需”会强制 Smack 使用 TLS。

来自 Javadoc：

> 连接需要通过 TLS 加密的安全性。如果服务器不提供 TLS 或 TLS 协商失败，则与服务器的连接将失败。

# ios - 清除 NSUserDefaults

> ID：545091
> 
> 赞同：292
> 
> 时间：2009-02-13T07:49:08.343
> 
> 标签：ios, objective-c, cocoa-touch, nsuserdefaults

我`+[NSUserDefaults standardUserDefaults]`用来存储应用程序设置。这由大约十几个字符串值组成。是否可以永久删除这些值，而不仅仅是将它们设置为默认值？

* * *

## 回答 #1

> 赞同：522
> 
> 时间：2011-07-26T02:55:23.017

您可以像这样删除应用程序的持久域：

```
NSString *appDomain = [[NSBundle mainBundle] bundleIdentifier];
[[NSUserDefaults standardUserDefaults] removePersistentDomainForName:appDomain]; 
```

在 Swift 3 及更高版本中：

```
if let bundleID = Bundle.main.bundleIdentifier {
    UserDefaults.standard.removePersistentDomain(forName: bundleID)
} 
```

这与@samvermette 的答案相似，但更干净一点。

* * *

## 回答 #2

> 赞同：103
> 
> 时间：2010-06-10T04:40:08.447

此代码将默认值重置为注册域：

```
[[NSUserDefaults standardUserDefaults] setPersistentDomain:[NSDictionary dictionary] forName:[[NSBundle mainBundle] bundleIdentifier]]; 
```

换句话说，它`removeObjectForKey`适用于您在该应用程序中注册的每一个键。

在此 Apple 开发者论坛主题中感谢 Ken Thomases [。](https://devforums.apple.com/message/223038)

* * *

## 回答 #3

> 赞同：97
> 
> 时间：2009-02-13T07:51:56.653

您是否尝试使用 - `removeObjectForKey`？

```
 [[NSUserDefaults standardUserDefaults] removeObjectForKey:@"defunctPreference"]; 
```

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2015-04-15T14:36:31.483

这是 Swift 中的答案：

```
let appDomain = NSBundle.mainBundle().bundleIdentifier!
NSUserDefaults.standardUserDefaults().removePersistentDomainForName(appDomain) 
```

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2011-09-06T14:54:11.693

如果你在开发过程中需要它，你也可以重置你的模拟器，删除所有的`NSUserDefaults`.

**iOS 模拟器 -> 重置内容和设置...**

请记住，它还将删除模拟器上的所有应用程序和文件。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2014-01-20T03:56:32.257

```
NSDictionary *defaultsDictionary = [[NSUserDefaults standardUserDefaults] dictionaryRepresentation];
for (NSString *key in [defaultsDictionary allKeys]) {
                    [[NSUserDefaults standardUserDefaults] removeObjectForKey:key];
} 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2016-08-18T10:36:08.037

在斯威夫特：

```
let defaults = NSUserDefaults.standardUserDefaults()
defaults.dictionaryRepresentation().keys.forEach { defaults.removeObjectForKey($0) } 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2016-08-22T22:33:40.937

当它们使代码更清晰时，我喜欢扩展：

```
extension NSUserDefaults {
    func clear() {
        guard let domainName = NSBundle.mainBundle().bundleIdentifier else {
            return
        }

        self.removePersistentDomainForName(domainName)
    }
} 
```

**斯威夫特 5**

```
extension UserDefaults {
    func clear() {
        guard let domainName = Bundle.main.bundleIdentifier else {
            return
        }
        removePersistentDomain(forName: domainName)
        synchronize()
    }
} 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2015-08-11T06:02:53.333

**注意：这个答案也已针对 Swift 进行了更新。**

将它放在一条线上怎么样？

扩展@Christopher Rogers 的答案——被接受的答案。

```
[[NSUserDefaults standardUserDefaults] removePersistentDomainForName:[[NSBundle mainBundle] bundleIdentifier]]; 
```

是的，有时你可能需要`synchronize`它，

```
[[NSUserDefaults standardUserDefaults] synchronize]; 
```

我已经创建了一个方法来做到这一点，

```
- (void) clearDefaults {
    [[NSUserDefaults standardUserDefaults] removePersistentDomainForName:[[NSBundle mainBundle] bundleIdentifier]];
    [[NSUserDefaults standardUserDefaults] synchronize];
} 
```

* * *

**斯威夫特**？

使用 swift 它更容易。

```
extension UserDefaults {
    class func clean() {
        guard let aValidIdentifier = Bundle.main.bundleIdentifier else { return }
        standard.removePersistentDomain(forName: aValidIdentifier)
        standard.synchronize()
    }
} 
```

**和用法**：

```
UserDefaults.clean() 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2014-12-04T18:33:16.600

我找到了这个：

```
osascript -e 'tell application "iOS Simulator" to quit'
xcrun simctl list devices | grep -v '^[-=]' | cut -d "(" -f2 | cut -d ")" -f1 | xargs -I {} xcrun simctl erase "{}" 
```

来源：[https ://gist.github.com/ZevEisenberg/5a172662cb576872d1ab](https://gist.github.com/ZevEisenberg/5a172662cb576872d1ab)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-10-16T08:44:45.780

以上所有答案都非常相关，但如果有人仍然无法重置已删除应用的用户默认设置，那么您可以重置模拟器的内容设置，它会起作用。![在此处输入图像描述](https://i.stack.imgur.com/nGfET.png)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-03-09T08:28:05.430

这是一个错误或其他问题，但在清除所有值`removePersistentDomainForName`时不起作用。`NSUserDefaults`

因此，更好的选择是重置`PersistentDomain`并且您可以通过以下方式进行操作：

```
NSUserDefaults.standardUserDefaults().setPersistentDomain(["":""], forName: NSBundle.mainBundle().bundleIdentifier!) 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-02-18T01:42:55.813

扩展@folse的答案...我相信更正确的实现将是...

```
NSString *appDomain = [[NSBundle mainBundle] bundleIdentifier];
NSDictionary *defaultsDictionary = [[NSUserDefaults standardUserDefaults] persistentDomainForName: appDomain];
    for (NSString *key in [defaultsDictionary allKeys]) {
      NSLog(@"removing user pref for %@", key);
      [[NSUserDefaults standardUserDefaults] removeObjectForKey:key];
    } 
```

...调用 NSUserDefault 的 persistentDomainForName: 方法。正如文档所述，该方法“返回包含指定持久域中的键和值的字典”。相反，调用 dictionaryRepresentation: 将返回一个字典，该字典可能包含其他设置，因为它适用于更广泛的范围。

如果您需要过滤掉任何要重置的值，那么遍历键是一种方法。显然，如果您只想删除应用程序的所有首选项而不考虑，那么上面发布的其他方法之一是最有效的。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-08-14T23:15:20.577

如果需要重置的应用程序设置是 nsuserdefault 以访问麦克风（我的情况），一个简单的解决方案是 Anthony McCormick 的回答（[Iphone - 如何启用应用程序访问设备上的媒体？ - ALAssetsLibraryErrorDomain Code=-3312 "Global denied access"](https://stackoverflow.com/questions/3561321/iphone-how-to-enable-application-access-to-media-on-the-device-alassetslibr)）。

在设备上，转到设置>常规>重置>重置位置警告

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-03-01T05:57:31.223

试试这个，它对我有用。

单行代码

```
[[NSUserDefaults standardUserDefaults] removePersistentDomainForName:[[NSBundle mainBundle] bundleIdentifier]]; 
```

# assembly - 有人可以解释这个直接组装的 x86 JMP 操作码吗？

> ID：545093
> 
> 赞同：8
> 
> 时间：2009-02-13T07:49:39.527
> 
> 标签：assembly, x86, gnu, opcode, protected-mode

在学校，我们一直在使用引导程序来运行没有操作系统的独立程序。我一直在研究这个程序，当启用保护模式时，通过直接将操作码和操作数组装为程序中的数据来执行远跳转。这是给 GNU 汇编器的：

```
 /* this code immediately follows the setting of the PE flag in CR0 */

```
.byte   0x66, 0xEA
.long   TARGET_ADDRESS
.word   0x0010          /* descriptor #2, GDT, RPL=0 */ 
``` 首先，为什么要这样做（而不是指令助记符）？

我一直在查看英特尔手册，但仍然对代码感到有些困惑。特别是在第 2A 卷第 3-549 页中，有一个操作码表。相关条目：

```
EA *cp* JMP ptr16:32 Inv. 有效跳转远，绝对，地址
操作数

```

实际的操作码很明显，但第一个字节 0x66 让我感到困惑。参考英特尔手册中的表格， cp 显然意味着后面会跟着一个 6 字节的操作数。接下来的两行显然是 6 个字节。0x66 编码一个“操作数大小覆盖前缀”。这和表中的cp有什么关系？我原以为cp会有一些十六进制值，但是有这个覆盖前缀。有人可以帮我解决这个问题吗？

这是来自 od 的转储：

```
c022 **ea66 0000 0001 0010** ba52 03f2 c030

```

TARGET_ADDRESS 被定义为 0x00010000。

我也对最后两个字节的重要性感到困惑。然而，这似乎完全是另一个问题。现在已经很晚了，我已经盯着代码和英特尔手册看了好几个小时，所以我希望我能明白我的意思。

感谢您的关注！

            回答 #1

赞同：12

时间：2009-02-13T07:59:05.090

0x66 表示 JMP (0xEA) 指的是六个字节。默认值是指实模式下的 64K（16 位）或保护模式下的 32 位（如果我没记错的话）。增加它后，它还包括段描述符，即 GDT 或 LDT 中的段索引，这意味着该代码正在执行传统上所谓的“长跳转”：跨越x86 架构。在这种情况下，该段指向 GDT 上的第二个条目。如果您之前查看该程序，您可能会看到 GDT 是如何根据段起始地址和长度定义的（查看英特尔手册以研究 GDT 和 LDT 表，描述每个段的 32 位条目）。

            回答 #2

赞同：2

时间：2009-05-14T16:58:29.153

我遇到了一点。一些汇编程序只会跳转到 LABEL 。在这种情况下，人们想要绝对跳转到特定的硬编码偏移量。我猜 jmp TARGET_ADDRESS 不起作用，所以他们只是把它作为字节来解决这个问题。

            回答 #3

赞同：0

时间：2014-08-19T08:58:18.387

0x66 指定当前代码段大小的操作数大小覆盖。假设当前代码大小是 16 位，新指令指针将是 32 位，而不是 16 位。如果当前代码段大小为 32 位，则 0x66 会将目标指令指针呈现为 16 位。当前代码大小属性取决于使用的 CS 选择器及其从 GDT/LDT 表加载的属性。在实模式下，代码段大小通常为 16 位，“虚幻”模式的特殊情况除外。

        opengl - GLUT死了吗？

ID：545111

赞同：16

时间：2009-02-13T07:56:12.617

标签：opengl, sdl, glut

在阅读了 Ubuntu 论坛上关于[GLUT 与 FreeGLUT](http://ubuntuforums.org/showthread.php?t=495249)的讨论之后。  

GLUT 对图形编程来说已经死了吗？SDL 现在对于 OpenGL 编程是否风靡一时？

            回答 #1

赞同：19

时间：2009-02-13T08:05:25.170

在我看来，GLUT 仍然很适合学习 OpenGL 编程。据我所知，它不再维护。看看：[http](http://www.opengl.org/resources/libraries/glut/) ://www.opengl.org/resources/libraries/glut/官方用词

从上面的链接中提取-“GLUT 库同时具有 C、C++（与 C 相同）、FORTRAN 和 Ada 编程绑定。GLUT 源代码分发可移植到几乎所有 OpenGL 实现和平台。当前版本是 3.7。附加预计不会发布该库。GLUT 不是开源的。Mark Kilgard 维护版权。”

另请参阅：[http](http://www.opengl.org/resources/libraries/windowtoolkits/) ://www.opengl.org/resources/libraries/windowtoolkits/以获取替代方案。

您可能还想查看 GLUX：[http ://code.google.com/p/glux/](http://code.google.com/p/glux/)

就 SDL 而言，它非常适合跨平台的东西，而且很多人都在使用它。我个人将 Qt 用于我的 OpenGL 工作。还存在其他窗口系统替代方案。也可以为 windows 或 X 本地编程。

**2017 年 2 月 28 日编辑：**

我应该澄清一下，希望从 SDL 或 Qt 开始学习 OpenGL 实用性的学生会得到更好的服务。正如@TM 在他的评论中正确指出的那样，使用 GLUT 与在 OpenGL 中编写真实世界渲染应用程序的现实相去甚远。我认为 GLUT 有利于学习的观点是，当人们将学习 OpenGL 的关注点与了解窗口系统细节的关注点分开时，学习会更容易。当然，这可能不符合您的需求。

            回答 #2

赞同：12

时间：2009-03-26T10:47:05.957

GLUT 对于严肃的游戏开发来说相当简单。许多商业游戏移植公司都在使用 SDL。GLUT 恰好适合学习 OpenGL 和简单的演示。SDL 之类的东西非常适合实际游戏。

SDL 及其对其他事物（例如音频）的抽象，以及 SDL 的各种插件库（SDL_image、SDL_mixer、...）在编写完整游戏时有很大帮助。控制主循环也很重要。

如果您正在开发一个还需要一些本机 GUI 的 OpenGL 应用程序（例如，3D 建模器），您可能对使用 wxWidgets 或 batbrat 建议的 Qt 更感兴趣。

            回答 #3

赞同：0

时间：2009-06-02T05:20:18.813

GLUT 是一个非常有用的学习指南，但对于大多数实际应用程序来说，它的功能不够全面或有用。在某些环境中，我还遇到了一些不同的 GLUT 实现和支持的小问题，所以我学会了远离它，只做快速演示。

我的 OpenGL 经验通常是在嵌入式系统上，我可以完全控制输出，并且我使用 X Instrinsics 来启动基本的 OpenGL 窗口。这有点痛苦，但只需少量代码即可到达 OpenGL，其中大部分工作已完成。

        actionscript-3 - ActionScript 3 错误 1037：无法嵌套包

ID：545124

赞同：0

时间：2009-02-13T08:04:50.567

标签：actionscript-3

我是 AS3 的新手。在学习 AS3 时，我从 Adob​​e 示例中获得以下代码并尝试运行它会出现类似错误

```
 "1037: Packages cannot be nested." 
```

这是什么意思？

请告诉我如何执行？或者这段代码有什么问题？

```
package {
    import flash.display.Sprite;
    import flash.text.TextField;
    import flash.text.TextFieldType;

    public class TextField_alwaysShowSelection extends Sprite {
        public function TextField_alwaysShowSelection() {
            var label1:TextField = createTextField(0, 20, 200, 20);
            label1.text = "This text is selected.";
            label1.setSelection(0, 9);
            label1.alwaysShowSelection = true;

            var label2:TextField = createTextField(0, 50, 200, 20);
            label2.text = "Drag to select some of this text.";
        }

        private function createTextField(x:Number, y:Number, width:Number, height:Number):TextField {
            var result:TextField = new TextField();
            result.x = x; result.y = y;
            result.width = width; result.height = height;
            addChild(result);
            return result;
        }
    }
} 
```

            回答 #1

赞同：3

时间：2011-11-18T19:28:28.000

您需要创建一个动作脚本文件，然后将该类添加到您的 fla 文件属性中的文档类，然后它不会给您一个错误

            回答 #2

赞同：2

时间：2009-02-13T08:17:45.170

您的代码应该可以编译，前提是它位于根源文件夹中（flex builder 中的“src”）。你确定这是整个文件吗？

该错误表示您已将一个 package {} 语句嵌套在另一个 package {} 语句中。

            回答 #3

赞同：1

时间：2014-03-21T23:29:16.810

如果您想在时间线本身中包含 AS3，请使用以下命令：

```
import flash.display.Sprite;
import flash.text.TextField;
import flash.text.TextFieldType;

     function TextField_alwaysShowSelection() {
        var label1:TextField = createTextField(0, 20, 200, 20);
        label1.text = "This text is selected.";
        label1.setSelection(0, 9);
        label1.alwaysShowSelection = true;

        var label2:TextField = createTextField(0, 50, 200, 20);
        label2.text = "Drag to select some of this text.";
    }

     function createTextField(x:Number, y:Number, width:Number, height:Number):TextField {
        var result:TextField = new TextField();
        result.x = x; result.y = y;
        result.width = width; result.height = height;
        addChild(result);
        return result;
    } 
```

            回答 #4

赞同：0

时间：2009-02-13T09:50:07.430

你是如何运行这个文件的？这不是一个完整的文件。如果您使用的是 flex，那么您需要支持的 MXML 代码。但是，错误表明您正在使用 src 文件夹。如果您提供完整的程序会很好。

            回答 #5

赞同：0

时间：2009-10-22T17:41:34.187

如果您使用的是 Flash，则将该代码放入名为“TextField_alwaysShowSelection.as”的文件中，将其放在您的 FLA 旁边，并将该类名称设置为您 FLA 的“属性”面板中的 DocumentClass ......所以它说“类：”写“TextField_alwaysShowSelection”。

        .net - .Net DirectoryInfo 路径

ID：545127

赞同：1

时间：2009-02-13T08:05:57.553

标签：.net

当我想映射到 webRoot 上名为 images 的文件夹时，有谁知道如何设置 DirectoryInfo 的路径。/图片

非常感谢任何帮助，谢谢

            回答 #1

赞同：3

时间：2009-02-13T08:12:27.943

如果您有相对于您的网络应用程序的路径，则需要使用 MapPath(...) 方法对其进行映射。

在页面类中：

```
string fullyQualifiedFilename = Server.MapPath(relativeFilename); 
```

或页面类之外：

```
string fullyQualifiedFilename = HttpContext.Current.Server.MapPath(relativeFilename); 
```

            回答 #2

赞同：2

时间：2009-02-13T08:11:09.103

```
String  virtualPath= "~\\images";
String RealPath=Server.MapPath(virtualPath); //it must be done at web application
System.IO.DirectoryInfo directory= new System.IO.DirectoryInfo(RealPath); 
```

            回答 #3

赞同：1

时间：2009-02-13T08:14:58.733

新 DirectoryInfo(Path.Combine(Server.MapPath(Request.ApplicationPath), "images"));

        maven-2 - Maven2继承

ID：545131

赞同：17

时间：2009-02-13T08:09:44.440

标签：maven-2

如果我有一个父 pom 并希望将其继承到多个项目。我通常通过在项目顶部添加来做到这一点`<parent> ... </parent>`。我不喜欢这种方法的是，如果我的父级发生了一些变化，我必须编辑该父级继承的所有项目以修改版本号。有更好的方法吗？我希望我试图解释的内容是可以理解的。

提前致谢。

            回答 #1

赞同：17

时间：2009-07-30T22:23:17.083

我不喜欢这种方法的是，如果我的父母发生了一些变化，我必须编辑该父母继承的所有项目以修改版本号。有更好的方法吗？

就在这里！看看[Maven 版本插件](http://mojo.codehaus.org/versions-maven-plugin/)，特别是：

**版本：更新子模块**更新项目的子模块的父部分，以便版本与当前项目的版本匹配。

  例如，如果您有一个聚合器 pom，它也是它聚合的项目的父级，并且子级和父级版本不同步，则此 mojo 可以帮助修复子模块的版本。

  （请注意，如果您的项目严重损坏以至于由于版本不匹配而无法构建，您可能需要使用 -N 选项调用 Maven 以运行此目标）。

**编辑：**当然，使用 Maven3，您现在可以在子模块中包含 < version >-less < parent > 元素：

在多模块或多 pom 项目中工作的开发人员不必在 Maven 3 的每个子模块中指定父版本。相反，您可以添加无版本的父元素。

[参考](http://java.dzone.com/articles/maven-3-rides-town?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed:+eclipsezone/frontpage+)

            回答 #2

赞同：8

时间：2009-02-14T23:10:23.053

您可以在发布时使用[Maven 发布插件](http://maven.apache.org/plugins/maven-release-plugin/)。它将自动更新所有版本号并在您的源代码管理中创建一个标签（如果您在 POM 中配置了 SCM）。

我执行发布的命令通常如下，然后我从 SCM 导出标签并使用“mvn clean package”或“mvn clean deploy”构建它。

```
 svn update   (or whatever SCM you use)
  mvn clean
  mvn release:prepare -DautoVersionSubmodules=true
  mvn release:clean 
```

例如，如果您的版本首先是“1.0-SNAPSHOT”，那么发布插件将创建一个带有“1.0”版本的标签“projectname-1.0”，最后将当前版本增加到“1.1-SNAPSHOT”。该插件会询问您的版本和标签名称，因此您可以覆盖默认值。

            回答 #3

赞同：6

时间：2009-02-14T21:36:18.677

自动父版本控制（即标记的省略）在 Maven 空间中是一个有争议的问题。  [有针对它记录的缺陷](http://jira.codehaus.org/browse/MNG-624)。目前，它被认为是 2.1 版本分支的修复或改进，

            回答 #4

赞同：3

时间：2009-04-12T01:57:45.980

在发布之前，您应该将您的版本保留为快照。这样您就不必每次更改 pom 时都更改它。但是，一旦您发布了父 pom，您将希望对所有子 pom 进行更改（假设父 pom 在“reactor”构建之外......否则它会被发布插件撞到一起）。有一个相对较新的插件称为versions-maven-plugin，可以帮助更改版本。

            回答 #5

赞同：2

时间：2009-02-13T08:23:01.163

我认为要意识到的重要一点是，在多模块构建中，maven*始终*使用来自*本地存储库*的版本。这也适用于多模块构建！因此，当您引用“父”pom 时，您将从本地 maven 存储库中获取已发布的父工件。因此，当您执行**mvn install**时，您会  重复将每个模块发布到本地存储库。

在开发过程中，*您自己的模块*可能会被版本化为 XX-SNAPSHOT。对父 pom 的引用是 XX-SNAPSHOT。在准备发布之前不要更改这些。

所以一个简单的例子是：在初始版本之前，所有模块都被称为 1.0-SNAPSHOT。在制作初始版本“golden build”时，将所有 1.0-SNAPSHOT 模块重命名为 1.0。在 1.1 版本上开始开发时，您将所有版本号更改为 1.1-SNAPSHOT。等等...

习惯是在您发布之前使用快照版本，此时您可以在任何地方更新版本号。在日常开发中，您不会更改版本号，因为快照版本的处理方式与硬版本版本不同。

**编辑：**
经过一番思考，我认为您在“评论”部分的一些困惑源于此：您的 pom 中的版本号反映了整个*应用程序版本*。任何给定的*pom*更改不一定会更改*应用程序*版本号。如果您需要跟踪 pom 中的更改，我建议您使用源代码控制系统。因此，在您使用 1.0 版本的 3 个月期间，将版本号保持在 1.0-SNAPSHOT 是合理的。在（例如）3 周期间，您使用 1.1，版本号是 1.1-SNAPSHOT。

        database-design - 将 XML 结构映射到数据库模式

ID：545145

赞同：1

时间：2009-02-13T08:15:23.833

标签：database-design, xsd

是否有直接将 XML 结构映射到数据库模式的工具？

我问这个的原因是因为我的数据最好用 XML 结构来描述。但是，我想将它们存储在数据库中以获得快速查询结果和其他好处。

            回答 #1

赞同：3

时间：2009-02-13T08:43:52.893

我在一个有一些要求的 Java 项目中，我们发现[HyperJAXB](https://hyperjaxb3.dev.java.net/)非常适合。它使用 JAXB 从 XML 模式获取 Java 对象，然后使用 Hibernate 持久化 Java 对象。最新版本也适用于任何支持 EJB3/JPA 的东西。

通常它会在不生成数据库模式文件的情况下执行此操作，但如果需要，您可以让 Hibernate 将其吐出。因为模式自动生成它可能看起来有点难看，直到你弄清楚它为什么按照它的方式完成。

如果您不使用 Java，但您愿意使用类似于 HQL（Hibernate 查询语言）的东西来访问数据库，那么您可以使用它来制作 XSD 到 DDL 转换器，因为生成的模式是使用 HQL 样式操作创建的心里。如果这听起来还不够难看，您可以打开休眠日志并查看它为各种 HQL 查询生成的 SQL，并使用它来确保您获得正确的访问模式。

所以基本上它不适合除了 Java 之外的任何东西:)

            回答 #2

赞同：1

时间：2009-02-13T08:23:05.220

看看来自 altova www.Altova.com/XMLSpy 的[xmlspy](http://www.altova.com/products/xmlspy/xml_editor.html)
我相信这个工具可以帮助你。（这不是广告！！）

            回答 #3

赞同：1

时间：2011-03-25T14:06:28.467

试试 Altova MapForce 产品。它是专门为此设计的，它似乎是少数能够进行 xml 到 db、db 到 xml 以及大量其他转换的强大商业产品之一。

鲍勃。

        cocoa-touch - 如何在两个视图控制器之间传递变量？

ID：545146

赞同：0

时间：2009-02-13T08:16:56.170

标签：cocoa-touch

我想将一个变量从一个视图控制器传递到另一个我做的方式是在第一个视图控制器头文件中我声明了一个变量

1.h：

**NSString *字符串；**

在第二个视图控制器中，我在我的 2.m 文件中导入了 1.h，我调用变量的方式是

2米：

**NSString *string2 = 1.string**

但是它返回一个错误有人可以教我怎么做，因为我没有强大的面向对象编程基础，谢谢

            回答 #1

赞同：1

时间：2009-02-13T10:26:11.070

仅仅定义和声明这两个字符串是不够的。这确保了每个类都有一个名为 string 或 string2 的变量——但是当你的程序运行时，它是必须引用 string1（或 string2）的特定实例的实际对象。

这就像设计带有信箱的房子 - 信箱在房子的平面图上，但在特定的信被发送到特定的房子之前什么都不会发生。

您需要做的是连接类的实际实例，可能在 init 方法中，如下所示：

```
// 1.h

@interface ViewController1 : UIViewController
{
// declare our variable
NSString* string1;
}

// declare 'string1' as a property
@property (retain) NSString* string1;

// 1.m
// implements the property for string1
@synthesize string1;

// 2.h
@interface ViewController2 : UIViewController
{
// declare our variable
NSString* string2;
}

// declare 'string2' as a property
@property (retain) NSString* string2;

// 2.m

- (id)initWithTitle:(NSString*)aTitle andString1:aString
    {
if (self = [super init])
    {
        self.title = aTitle;
        self.string1 = aString;
    }

return self;
} 
```

然后在 1.m 中，创建第二个控制器，并将字符串连接起来，如下所示：

```
// 1.m
mySecondController = [[ViewController2 alloc] initWithTitle:@"Controller 2" andString:string1]; 
```

            回答 #2

赞同：0

时间：2009-02-13T09:10:52.297

尽管可以直接访问这样的成员变量（使用 -> 运算符），但不建议这样做。

正确的方法是提供一个访问器来获取/设置您的成员变量。

在 Objective-C 2.0（iPhone 和 OSX 10.5）中，您可以使用“property”关键字轻松完成此操作。作为属性语法的一部分，您还可以表达您希望如何处理“设置”对象。

保留 - 前一个对象将被释放，新的对象将被保留副本 - 将复制对象分配 - 将分配对象。

这些是基础知识，我建议您阅读有关属性的更多信息。

下面显示了如何在示例中使用属性。请注意，因为我们正在处理一个 NSString，它是一个 NSObject 派生类，所以我们使用“保留”选项来确保正确更新引用计数。

```
// 1.h

@interface ViewController1 : UIViewController
{
// declare our variable
NSString* _string;
}

// declare 'string' as a property
@property (retain) NSString* string;

// 1.m
// implements the property for string
@synthesize string = _string;

// constructor for ViewController1
-(id)initWithNibName:(NSString *)nibName bundle:(NSBundle *)nibBundle {
  if (self = [super initWithNibName: name bundle: bundle]) {
    // Initialize the string here.
    self.string = @"Hello World";
  }
}

// 2.m
NSString* oldString = view.string;
view.string = @"New String"; 
```

        c# - 使用 C# 和 WM Encoder SDK 获取 WM/图片

ID：545150

赞同：1

时间：2009-02-13T08:19:37.617

标签：c#, windows, windows-media-player

我希望有人可以帮助我指出正确的方向和/或提供样本供我查看。我需要在使用 WM 编码器和 C# 解码的 WMA 文件中获取 WM/Picture 字段。我已经能够很好地获取所有其他标签，但是 media.getAttributeCountByType("WM/Picture", "") 函数总是返回 0。但是 Windows Media Player 可以正确显示图片，我看到两个隐藏的 JPG 文件在同一音乐文件夹。MSDN 没有提供太多关于它的信息。谢谢。

            回答 #1

赞同：0

时间：2009-05-28T06:13:39.200

用c#编程聊天语音

        automated-tests - 帮助参与系统验证测试团队获得更好的程序员？

ID：545152

赞同：2

时间：2009-02-13T08:22:02.990

标签：automated-tests, testing

我现在正在开发应用程序 9 年 - 意思是 Java。现在被要求参与 SVT 团队的下一个版本。总体而言，这意味着安装复杂的系统设置并在这些设置上运行特定的用户场景，以及进行长时间运行和负载运行。

总的来说，我对此持积极态度，因为我会学到新的东西。但我也害怕失去对编程的一些掌握和知识，因为那时没有做很多。

我知道在诸如帮助开源项目之类的业余项目中进行编程将是一种选择，但是在家庭生活和全职工作之外找到时间并不是那么容易。

你认为，做具体的测试工作有助于培养更好的软件工程师吗？

在此先感谢，迈克尔

            回答 #1

赞同：1

时间：2009-02-13T08:30:06.217

测试与编程无关。

您仍然可以对自动化系统进行编程，以便进行递归测试。从单元测试到真正复杂的自动化系统，我所知道的最好的是 selenium，它生成的代码可以用来构建大多数语言的测试脚本。

还有其他适用于非 webapps 的工具。但我个人认为，测试离“停止编码”有点远。除非你只是在做用户视角测试。

您还可以进行错误注入，这将使您编写小型单例以将它们注入应用程序的内存中。

因此，您可以在测试的同时进行编码；) 并学习新的东西。在测试团队工作过，我认为这真的很有帮助，因为您将学会轻松地利用代码，这将在您以后构建自己的 API 或应用程序时反映出来。

            回答 #2

赞同：0

时间：2009-02-13T08:45:10.610

我会说这取决于你的技能和气质。编程知识将在测试时为您提供良好的服务。同时，我知道它需要不同的方法和心态，并且处于完全不同的职业轨道上。您始终可以通过为您喜欢的项目编写代码来保持您的编程技能（即使您必须编造一个）。

        git - git有什么了不起的？

ID：545157

赞同：32

时间：2009-02-13T08:23:26.420

标签：git, version-control, dvcs

对于来自更传统的 VCS 背景（CVS/SVN）的人来说，学习和迁移到 git 的最令人信服的理由是什么？

请评论团队为使 git 工作所需的技术能力。我见过聪明的人爬上学习曲线，但仍然掉头发。任何人都可以攀登这条曲线，还是 git 不适合所有团队？

当然，我也想听听有关功能优势、工具支持、集成其他系统（CI 等）的信息……

*（这似乎是一个显而易见的问题，但尽管进行了几次搜索，但我没有找到此问题的副本）*

**编辑**链接到好的资源也很感激。

            回答 #1

赞同：19

时间：2009-02-13T08:27:37.690

在我的头顶上：

*   它的分布式方面（每个开发人员都有一个存储库的副本）
*   快速处理复杂合并的能力
*   从一个任务切换到另一个任务的可能性，搁置他的工作，回到它......
*   便宜的分支（即时切换：它只是在文件中写入一些位！并且它不像 SVN 那样将分支视为目录）

主要的困难是在不同的 repo 之间建立一个**[工作流](http://gweezlebur.com/2009/01/19/my-git-workflow.html)**，而不破坏已经发布的历史（推送到公共 repo）。
[![替代文字](https://i.stack.imgur.com/uS9fg.png)](https://i.stack.imgur.com/uS9fg.png)

[（来源：[infoq.com](https://www.infoq.com/resource/articles/dvcs-guide/en/resources/CVCSvsDVCS.png;jsessionid=46EDE35FAB7B0B36F325BC0714382131)）]
特别是**rebase**一开始可能很难正确使用，因为它确实重写了分支的历史，并且改变了与之关联的 SHA1：到公共分支，这意味着来自其他开发人员的大量合并它。

            回答 #2

赞同：8

时间：2009-02-13T08:24:44.203

Git 很深，一开始可能会很棘手。我会说这绝对不适合所有人，特别是如果您有设计师或其他非技术人员需要办理入住和退房手续。在我们当前的项目中，我们运行一个 svn 后端，三个开发人员选择使用 git，而两个继续使用 svn，并且非常满足和高效。

也就是说，git 有很多东西可以提供。无需深入了解 git 魔法，您就可以快速学会利用它的一些最受欢迎的方面：无需将上游推送到主存储库即可在本地签入的能力，以及几乎完全无忧的分支和合并。

只需几个基本的命令，您就可以获得非常令人满意的 git 体验。

在所有资源中，Scott Chacon 的[Getting Git](http://en.oreilly.com/rails2008/public/asset/attachment/2816)让我了解了 git 的好处，并给了我推动学习曲线陡峭部分的动力。

            回答 #3

赞同：5

时间：2010-02-26T15:03:40.707

**GitHub！**真的，我只是学会了使用 github 来欣赏 git。

            回答 #4

赞同：4

时间：2009-02-13T09:04:58.007

Git 速度非常快，并且以非常紧凑的方式存储存储库（想想相同代码库大小的十分之一到百分之一 + svn 中的历史记录）。Git（和大多数分布式 VCS）为您提供廉价的分支，这些分支可以轻松生成、处理和合并。这一切都发生在本地，团队成员不会被队友正在进行的工作分心，除非有主动的努力来分享它。

迁移到分布式 VCS 将导致开发风格发生一些变化，一些开发人员会喜欢，但其他人可能会很讨厌。毫无疑问，git 是一头复杂的野兽，有许多路径可以达到相同的结果。在带领团队迁移到 git 时，您需要花一些时间来学习这些路径，然后为常见场景勾勒出工作流程和命令备忘单。

我建议首先作为客户熟悉它，与[github](http://www.github.com/)或类似工具交谈。

关于你关于设计师和技术较少的人使用它的问题，我会说如果工作流程和命令有很好的文档记录，那么通过一些培训，他们应该能够加快速度。他们是否会欣赏它是另一个问题！:-)

一个值得一试的工具是[review board](http://code.google.com/p/reviewboard/)，它是一个很棒的团队代码审查工具，并且似乎有一个 git 插件。

            回答 #5

赞同：3

时间：2009-02-13T08:29:27.000

一个月前我刚开始使用 git 并且喜欢它。它对团队和个人都快速且易于使用。学习并不难，我不需要学习任何新的技术技能来使用 git。我知道它支持从 CVS/SVN 迁移。最好的部分是，如果您愿意，您仍然可以维护 CVS/SVN 风格的工作流程。

我建议查看 git wiki： http: [//git.or.cz/gitwiki](http://git.or.cz/gitwiki)
和官方网站： http: [//git-scm.com/](http://git-scm.com/)

我希望这对您有所帮助，并且您喜欢使用 git。

            回答 #6

赞同：3

时间：2010-03-01T05:53:46.313

我意识到这是一个关于 Git 的问题，但 OP 应该意识到许多好处适用于所有主要的分布式版本控制系统。Git、Mercurial 和 Bazaar 都有自己的优点和缺点，所以你应该研究所有这三个，然后决定哪一个最适合你的工作方式和项目。

            回答 #7

赞同：2

时间：2010-02-26T14:44:55.010

GIT的故事是FOSS历史上的经典。在 Wikipedia 中查看 Git 的[历史](http://en.wikipedia.org/wiki/Git_%28software%29#History "历史")。该故事的标签：*BitKeeper、Andrew Tridgell、Torvalds、Git、2 天内自托管*。

好吧，不是答案，具有 FOSS/Hacker 态度的人肯定会喜欢阅读它。

            回答 #8

赞同：2

时间：2009-02-19T08:56:13.377

很多人都在谈论 git 的使用有多复杂，但如果你坚持一个非常简单的使用模式，git 并不比 RCS 复杂。

将 git 用于您自己的语言环境修订控制（对于您使用 RCS 的同类事物）我认为比使用 RCS 更容易。

当然，当您将它用于具有大量人员和大量分支等的大型项目时，它可能会比传统的修订控制系统更复杂。

就我个人而言，我主要将它用于个人项目和在工作中进行本地修订控制。我们在工作中使用 perforce，他们对我们可以签入的分支数量非常严格。我们必须签入完成的、可编译的、可测试的代码块。

我经常一边做更大的重构工作，一边做较小的修复。我发现这很难与 perforce 兼顾。但是使用 git，我能够为我正在做的不同实验、重构和错误修复提供大量小型语言环境分支。

所以对我来说 git 的最大卖点是：

*   支持语言环境签入（我可以在提交到主存储库之前分步签入我的工作。
*   轻松方便地制作大量语言环境分支并在它们之间切换。

最后一点的原因是 git 将所有分支保留在同一个目录中，因此您可以使用 git 命令在它们之间交换并保持在同一个位置。我喜欢这样，因为这意味着我不必在每次分支时都为我的 IDE 设置新目录的配置文件，而且我不会因为拥有疯狂数量的分支而浪费大量空间。

        sql-server - 是否有适用于 SQL Server 2005 的数据筛选器工具？

ID：545163

赞同：5

时间：2009-02-13T08:26:47.660

标签：sql-server, database, database-design, sizing

当填充每个表的预测值时，我必须估计数据库的数据大小。它至少应该包括用于数据和索引的大小。

在 SQL Server 2000 中曾经有这样的工具，当提供每个表的记录数量时，它会产生估计的大小（我认为它与 SQL 2000 资源工具包一起提供）。我在 2000 年或 2005 年都找不到这个工具 :(

我知道 sp_spacedused 但这对我不起作用，因为我必须用值预先填充数据库，而且我可能有很多场景要计算。

            回答 #1

赞同：2

时间：2009-02-13T08:45:01.970

您是否考虑过使用工具生成虚拟数据？

您可以创建包含足够数据的表，以提供对生产数据库大小的良好估计（即创建一些代表性数据，然后将其分解）。

您可能会发现 Red Gates SQL 数据生成器等工具很有用。

[http://www.red-gate.com/products/SQL_Data_Generator/index.htm](http://www.red-gate.com/products/SQL_Data_Generator/index.htm)

干杯，约翰

            回答 #2

赞同：2

时间：2009-02-13T08:51:03.733

上次我这样做是excel，铅笔，信封背面和有根据的猜测工作。答案并不太准确。我猜你说的是严重的数据量，因为这些天磁盘非常便宜/可用，除了最大的数据库之外，所有的数据库都将在小型（ish）服务器上运行。

您能否提供更多关于预期行数和您将存储的数据类型的详细信息。顺便说一句，不要与数据库中的 Blob/图像/视频一起使用 - 一旦扩展，它就是一件丑陋的事情。

            回答 #3

赞同：2

时间：2009-02-13T17:59:52.633

在您的情况下，我可能只是创建数据库并尝试用具有代表性的数据样本填充它，然后检查表大小的样子。

此 SQL 脚本对所有表执行此操作 - 您不必在每个表上调用 sp_spaceused：

```
SELECT 
    t.NAME AS TableName,
    i.name as indexName,
    sum(a.total_pages) as TotalPages, 
    sum(a.used_pages) as UsedPages, 
    sum(a.data_pages) as DataPages,
    (sum(a.total_pages) * 8) / 1024 as TotalSpaceMB, 
    (sum(a.used_pages) * 8) / 1024 as UsedSpaceMB, 
    (sum(a.data_pages) * 8) / 1024 as DataSpaceMB
FROM 
    sys.tables t
INNER JOIN      
    sys.indexes i ON t.OBJECT_ID = i.object_id
INNER JOIN 
    sys.partitions p ON i.object_id = p.OBJECT_ID AND i.index_id = p.index_id
INNER JOIN 
    sys.allocation_units a ON p.partition_id = a.container_id
WHERE 
    t.NAME NOT LIKE 'dt%' AND
    i.OBJECT_ID > 255 AND   
    i.index_id <= 1
GROUP BY 
    t.NAME, i.object_id, i.index_id, i.name 
ORDER BY 
    object_name(i.object_id) 
```

        php - PHP，如何设置时区？

ID：545164

赞同：2

时间：2009-02-13T08:27:22.790

标签：php, timezone

我正在使用 PHP 和 mysql。

设想：

注册表只需要2个字段。电子邮件和密码，然后，第一个用户来自英国，第二个用户来自中国，等等。

有没有办法在 PHP 中为不同国家的用户自动设置时区？我检查了 php.net，但没有运气..

            回答 #1

赞同：6

时间：2009-02-13T08:41:10.560

您可以尝试[从他们的 IP 推断他们的国家](http://www.maxmind.com/app/geolitecountry)，并从中得出他们的时区。

或者，在表单中添加类似这样的内容并获取 Javascript 来告诉您浏览器使用的时区偏移量......

```
<script language="JavaScript">
<!-- 
    var d= new Date();
    document.write('<input type="hidden" name="timeZoneOffset" ');
    if (d) {
        document.write('value="' + d.getTimezoneOffset()/60 + '">');
    } else {
        document.write('value="n/a">');
    }
// -->
</script>
<noscript>
    <input type="hidden" name="timeZoneOffset" value="n/a">
</noscript> 
```

            回答 #2

赞同：1

时间：2009-02-13T08:34:20.170

不，这不可能通过 php，因为浏览器并不总是发送该信息。上次我们通过发送 ajax 调用和更新会话的 timezone 属性解决了这个问题，因为 javascript 引擎**确实**可以访问该浏览器属性。

        c# - 您如何在 .Net 项目中打包外部库？

ID：545166

赞同：6

时间：2009-02-13T08:27:38.720

标签：c#, .net, dependency-management, refix

我的很多项目都包含 Castle/NHibernate/Rhino-Tools 堆栈。令人困惑的是，Castle 依赖于一些 NHibernate 库，NHibernate 依赖于一些 Castle 库，而 Rhino-Tools 依赖于两者。

我已经在我的机器上构建了所​​有三个项目，但是我觉得复制 NHibernate/Castle 库有点多余，因为我使用 NHibernate 和 Castle 构建中的生成库构建了 Rhino-Tools。

现在，我在项目树的 /thirdparty/libs 文件夹中的单独文件夹中包含所有项目。我应该只是在我的项目中使用 /thirdparty/libs/rhino-tools 并从那里使用 Castle/NHibernate 库吗？这在不复制文件方面似乎是合乎逻辑的，但我也喜欢将每个项目放在自己不同的文件夹中。

您对此有何看法？

            回答 #1

赞同：3

时间：2010-06-11T13:25:15.590

这是我们[在 CodePlex 上的 Refix 开源项目](http://refix.codeplex.com)中试图解决的问题之一。

这个想法是 Refix 将解析您解决方案中的所有项目，并且在您的项目编译之前，将必要的二进制文件从您计算机上的单个本地存储库复制到解决方案树中的一个文件夹中，并将项目指向它们。这样，就无需提交二进制文件。您的本地 Refix 存储库将从远程存储库中提取二进制文件（我们正在 repo.refixcentral.com 上设置一个），您可以为您的团队/部门/公司设置一个中间存储库，该存储库可以保存任何未集中保存的其他软件.

它还将尝试解决冲突的版本号 - Visual Studio 可能*过于*容忍不匹配的组件版本号，导致解决方案在无法加载依赖项时编译但在运行时失败，因为需要两个不同的版本。

因此，要回答“如何在 .Net 项目中打包外部库”这个问题，我们的愿景是您不需要 - 您只需在构建脚本中包含一个 Refix 步骤，让它为您担心。

            回答 #2

赞同：1

时间：2009-02-13T08:33:18.347

我为每个文件夹使用一个文件夹，这似乎是惯例。

1.  如果你复制它们真的有区别吗？
2.  如果你想换一个怎么办？假设您使用新的 O/R 映射器。只删除 NHibernate 文件夹比有选择地删除 Rhino-Tools 文件夹中的 DLL 要容易得多。
3.  将其作为合乎逻辑的结论，您的 lib 文件夹中不会有任何文件夹组织，因为一切都使用 log4net :)

            回答 #3

赞同：1

时间：2009-02-17T21:21:55.147

我肯定会建议在您的每个项目树中都有一个第三方或供应商文件夹。如果你觉得拥有 32 个 rhino-tools 包的副本很烦人，你可以在你的代码库中拥有它的一个副本，并在你的项目树中对它进行外部引用。

假设您使用的是 SVN，您可以创建一个名为“第三方库”的存储库，其中包含库的版本副本。然后，您在项目树中的“第三方”文件夹上创建一个外部属性，然后自动检查您的集中式第三方库。这样，例如，如果出现安全性或错误修复，您只需在一个地方进行更新，但每个项目仍然可以选择哪些第三方库以及要使用哪些版本。

关于第三方库内部的部门，我不介意那些。第一次编译项目时，由于隐式依赖关系，某些库没有复制到 bin 文件夹中，您可以将外部属性添加到 bin 文件夹中，然后它将自动检查丢失的库。这样你仍然只需要在一个地方更新你的第三方库。

            回答 #4

赞同：1

时间：2009-02-13T09:39:50.277

向您的 app.config 文件添加额外的探测路径以定位依赖项 dll。这样，您就可以只拥有您想要的所有内容的一份副本。尽管使用此功能有一些怪癖（您必须以某种方式创建文件夹结构）。[在此处](http://msdn.microsoft.com/en-us/library/aa374182.aspx)查看有关标签的更多详细信息。

        java - java.net.SocketException: recv failed: Insufficient buffer space 的原因是什么？

ID：545168

赞同：2

时间：2009-02-13T08:29:03.117

标签：java, sockets

客户在 Windows 上收到错误“java.net.SocketException: recv failed: Insufficient buffer space”。使用 netstat 命令，我们只能看到大约。100 个套接字连接。我已将**MaxUserPort**更改为 60000，如[http://support.microsoft.com/default.aspx?scid=kb;EN-US;196271所述](http://support.microsoft.com/default.aspx?scid=kb;EN-US;196271)

我知道这个 Java 错误等于套接字错误 10055 WSAENOBUFS。但我不知道我应该在哪里寻找这个问题的原因。有任何想法吗？

            回答 #1

赞同：-1

时间：2020-05-04T20:58:59.643

我知道已经有一段时间了（11 年），但我在该页面上找到了解决方案：[https ://wiki.scn.sap.com/wiki/display/ABAP/WSAENOBUFS%3A+10055%3A+No+buffer +空间+可用](https://wiki.scn.sap.com/wiki/display/ABAP/WSAENOBUFS%3A+10055%3A+No+buffer+space+available)

它适用于 SAP，但补救措施是相同的。

简而言之，它说：您试图在关闭后重用同一个端口。这可能是您的应用程序广泛打开和关闭网络连接。补救措施是调整网络参数，使操作系统更快地释放关闭的端口。

我认为最好调查一下为什么应用程序会使用大量端口。

        javascript - 时间用完时如何重定向到另一个页面

ID：545171

赞同：0

时间：2009-02-13T08:29:27.357

标签：javascript, jsp, timeout

我正在尝试使用 JSP 开发一个在线考试应用程序。所以我想在某个时间段用完时，用与当前页面（考试页面）相同的参数链接到结果页面。我想知道如何添加计时器以及如何在超时时链接到另一个页面。谢谢。

            回答 #1

赞同：3

时间：2009-02-13T08:44:13.330

您需要使用 Javascript 来实现这一点。在那里你需要创建一个看起来像这样的 JS 段：

```
<script type="text/javascript">
  var myTimer = window.setTimeout(timer, 3000);

  function timer() {
    window.location.href = "new_page.htm"
  }
</script> 
```

该脚本用于进入正文部分工作。您的 head 部分的脚本将需要一个 onload 事件来处理启动计时器。该示例将在 3 秒后重定向。

            回答 #2

赞同：1

时间：2009-02-13T08:53:04.367

**JavaScript 只是客户端，它可以被禁用或更改以欺骗您的应用程序。**

您还必须跟踪服务器上的时间，并且您还应该尝试尽快将输入输入到您的应用程序中，以了解答案是否“及时”。

重型 AJAX 是我解决这个问题的方法。

另一种方式可能是具有类似后端的 Flash/Flex 组合。

        windows - 如何在 Windows 应用程序中对加扰数据包进行反向工程？

ID：545172

赞同：5

时间：2009-02-13T08:29:33.723

标签：windows, dll, encryption, reverse-engineering, code-injection

我有一个 Windows exe 应用程序，用于将数据包明文发送到服务器。这个应用程序（让我们称之为客户端应用程序）绝对是封闭源的，但是一些聪明的黑客对二进制文件进行了十六进制编辑，并让它发送被加扰的数据包。

现在，显然，这些数据包以一种可破译的方式进行了加扰（否则服务器将无法理解它），但我想做的是编写一个仿真器来模拟这个二进制应用程序，将相同的数据包发送到服务器，并且能够解读响应（如果它被加扰）。

十六进制客户端需要额外的 dll 才能运行，而旧客户端则不需要。我假设十六进制客户端设法以某种方式加载该dll（让我们称之为client.dll）并且该dll的功能是通过连接到一些重新路由从发送的所有数据包的windows api来实现加扰/解扰client.exe 进程。

如果有人可以指导我如何开始研究这一切是如何工作的，以及我如何对加扰进行逆向工程，那将非常感激。

我不知道要提供什么样的信息，但如果有任何不足，请回复，我会发布更多详细信息，如果有人想要二进制文件，我很乐意提供。

任何感兴趣的各方的二进制下载：

[http://dl.getdropbox.com/u/46623/client.dll](http://dl.getdropbox.com/u/46623/client.dll)

[http://dl.getdropbox.com/u/46623/newClient.exe](http://dl.getdropbox.com/u/46623/newClient.exe)

[http://dl.getdropbox.com/u/46623/originalClient.exe](http://dl.getdropbox.com/u/46623/originalClient.exe)

这些不会运行，因为需要资源文件 - 它们大约 3 gig，所以太大而无法上传到任何地方。名称已更改以保护有罪 =) ，但这可能不保护 dll 的名称...

            回答 #1

赞同：3

时间：2009-02-13T08:39:53.417

我假设编写这个**钩子**的人为上述程序添加了对数据包 I/O 的加密，要么**钩住**了相关的 Windows 的套接字 API（`WSASend`，`send`等），要么钩住了用于发送/接收数据的内部程序函数.

话虽如此，我建议您使用钩子检测程序（例如*RkUnhooker*）来找出实际被钩子的内容。一旦您知道挂钩了哪些 API，您还应该知道这些挂钩的去向，并且从那里开始您将不得不手动对挂钩函数进行逆向工程。

至于学习如何做到这一点，我不能只指导你一个教程来教你所有东西，但我强烈建议你看看[Tuts4You](http://tuts4.you.com/ "Tuts4You")网站，它有大量的教程可以满足你的所有需求。

如果可能，请上传已编辑的客户端和挂钩 DLL 的副本，如果我有时间，我会为您编写副本加密和解密功能。

            回答 #2

赞同：2

时间：2009-02-13T08:39:31.500

您需要挂钩附加 DLL 导出的函数，并查看被调用的函数和传递给它们的参数。这并不容易，因为您没有类型信息（例如 DLL 导出的函数签名。）

[在此处](http://www.codeproject.com/KB/system/hooksys.aspx)查看有关 API 挂钩的一些信息。你还需要一个好的调试器试试微软的[Windbg](http://www.codeproject.com/KB/debug/windbg_part1.aspx)。

据我所知，您在这里唯一的选择是黑盒测试，即向两个系统提供已知输入，并相互比较响应以找出差异和相似之处。

```
               +---------------+
输入--------->| 原始应用程序|--------->响应1
               +---------------+

               +------------+
输入--------->| 修改后的应用程序 |--------->Response2
               +------------+

```

现在，一旦您弄清楚如何使用附加 dll 中的功能，您就可以像原始应用程序一样自己使用它。

        c# - 使用 .NET 发送传真

ID：545173

赞同：1

时间：2009-02-13T08:30:00.600

标签：c#, crystal-reports, fonts, printing, fax

我正在尝试使用 Crystal Reports 和 Unimessage Pro（或任何其他传真程序）通过 .NET (C#) 程序发送传真。

我的问题是 Unimessage Pro（和其他传真程序）将打印机字体用于传真命令。由于 .NET 不支持打印机字体，因此报告中的传真命令将转换为 Courier New。这样做的结果是传真程序无法识别传真命令，而是将它们视为纯文本并且传真没有发送。

如何使用 Crystal Reports 和 .NET 发送传真？

            回答 #1

赞同：3

时间：2009-03-05T21:29:21.630

我从 WordCraft（Unimessage Pro 背后的公司）得到了这个答案

1.  在 Windows 主文件夹中创建一个名为 WilCapAX.INI 的文件，例如 C:\Windows\WilCapAX.INI 该文件应包含以下内容： [WilCapAX] Commands=C:\Commands.DAT 其中“C:\Commands.DAT”为您将在 .NET 应用程序中创建的文本文件的名称，以将

      嵌入式命令传递给 Unimessage Pro。如有必要，您可以编辑路径，但请保留简短的文件和

      文件夹名称。

2.  在您的 .NET 应用程序中，当您有要通过

      Unimessage Pro 发送的内容时，您需要：

    2.1 根据 WilCapAX.INI 中定义的名称，创建一个名为 C:\Commands.DAT 的文本文件，其中包含：

    ```
     BLANK LINE
     [[TO=Fax Number or Email address]]
     [[SUBJECT=Whatever you want the subject to be]] 
    ```

    文件的第一行必须为空白或包含嵌入命令以外的内容 - 它将被跳过。C:\Commands.DAT 文件中的其他行都应包含一个嵌入式命令。

    2.2 向 Unimessage Pro 打印机打印一条消息 - Unimessage Pro 打印机接受打印作业并将查找在 WilCapAX.INI 中指定的文件。如果找到在 WilCapAX.INI (C:\Commands.DAT) 中指定的文件，则从中提取嵌入的命令，然后删除“C:\Commands.DAT”文件，并将打印捕获与从其中提取的命令一起处理C:\Commands.DAT 文件。

    2.3 等待 C:\Commands.DAT 文件消失（表明它已被 Unimessage Pro 打印机处理），然后根据需要重复。

这解决了问题！:)

            回答 #2

赞同：1

时间：2012-09-25T00:07:42.970

Joyfax 客户端控制台 1.0（测试版）

注意：请在运行此应用程序之前启动 Joyfax Client v5.2 或更高版本。

JoyfaxConsole [选项] -f [;...][;FileN] -r ""

```
-f  file or folder  Files or files in sub folders to be faxed.
        i.e: C:\Test\;C:\MyPDFs\*.pdf
-r      Recipients  Recipient list. For more see Fax Recipients. Must begin and end with double quotation marks("). 
```

选项：

```
-a  Synchronous Wait until fax sent completed;
-s  Subject Subject of fax, i.e.: "Joyfax Sell Sheet";
-m  Meno Memo of fax, i.e.: "Joyfax Server 5-user license";
-c  CoverPage Cover Page profile to be used;
-d  Header Header & footer profile to be used,
    0 = None; 1 = General; 2 = Compact; 3 = Detailed
-k  Kill Delete input files if fax sent successfully. 
```

返回：

```
0 - Success;
1 - Initialize failed;
2 - Invalid parameter;
3 - Unknown erorr (may unsupported file type). 
```

例子：

JoyfaxClientConsole -d 2 -f "C:\My PDFs\D90.PDF" -r "Samm Kivin<866-6554-564>;格林先生<(846)6554-564>"

JoyfaxClientConsole -f C:\MyPDFs*.pdf;D:\Sell.xls -r "Samm Kivin<866-6554-564>"

JoyfaxClientConsole -s "Joyfax 销售表" -m "Joyfax 服务器 5 用户许可证" -f D:\Sell.xls -r "Kivin<866-6554-564>"

            回答 #3

赞同：0

时间：2009-02-13T15:54:02.873

当您说使用打印机字体时，我假设您需要发送一些 PCL（或类似）命令，例如：

```
<esc>(s..... 
```

如果是这种情况，我认为您不能直接将其嵌入到 Crystal 中。

过去我们不得不通过 Crystal 发送特殊序列（没有 Escape），在这些情况下，我们创建一个新的公式框并且不更改除字体之外的任何元素（选择 Courier）。这些元素应该直接传递给打印机，而不会被驱动程序转换太多。这可能; 但是，不能解决您的问题。

另一个可行的选择是使用 Microsoft 的驱动程序开发工具包构建您自己的打印机驱动程序。您可以创建自己的迷你驱动程序并将字体与特定的字体调用相关联，因此当您指定该字体时，您可以将代码正确插入到您的代码中。

您也可以按照我们的方式处理此问题（不是使用 Crystal，也可以使用其他类似的报告）。我们使用 RightFax 作为我们的传真服务器，它允许通过元数据文件“附加”文件。我们生成报告，将其以 PDF 或其他格式放入特定位置，然后向 RightFax 传递一个元数据文件，其中包含收件人的传真号码和一个命令，告诉它将文件附加到文件系统上。

RightFax 的“附加”文件如下所示：

```
{{begin}}
{{nocover}}
{{fax (403) 555-1212}}
{{subject Test Fax}}
{{attach c:\reports\report1.pdf delete}}
{{imagetype pdf}}
{{end}} 
```

        java - useBean 类属性的值...无效

ID：545177

赞同：26

时间：2009-02-13T08:30:47.277

标签：java, jsp, tomcat, properties

我想使用一个`SaveProp`写在 package 中的 Java 文件`user`。类文件已放置在`WEBINF/classes`. 以下是导致问题的两行。

```
jsp:useBean id="user" class="user.SaveProp" scope="session"

jsp:setProperty name="user" property="*" 
```

它抛出：

```
The value for the useBean class attribute user.SaveProp is invalid 
```

我正在使用Tomcat 6.0。

            回答 #1

赞同：45

时间：2009-11-19T15:43:25.173

3 件事

1.  确保类文件在 WEBINF/classes/user 下
2.  确保有一个没有参数的公共默认构造函数
3.  如果 bean 已经存在于范围内，您也可以使用 type= 而不是 class=

            回答 #2

赞同：14

时间：2009-02-13T09:07:50.540

您应该将文件放在 WEBINF/classes/user 下

            回答 #3

赞同：14

时间：2010-09-15T09:32:38.600

确保默认的无参数构造函数存在并且是公共的。

        security - 您如何限制对 clickonce Web 存储库的访问权限？

ID：545179

赞同：5

时间：2009-02-13T08:32:08.897

标签：security, deployment, .htaccess, clickonce

我已经构建并成功部署了 ClickOnce 应用程序。

应用程序在需要时成功更新，一切正常。

但是，我不喜欢互联网上的每个人都可以自由访问文件的事实（即使他不是我的客户之一）

由于我只有少数客户（大型公司），因此我使用 .htaccess 文件限制了对客户 IP 的访问，如下所示：

```
AddType application/x-ms-application application
AddType application/x-ms-manifest manifest
AddType application/octet-stream deploy

<LIMIT GET POST>
order deny,allow
deny from all
allow from 1.2.3.4
allow from 5.6.7.8
....
....
</LIMIT> 
```

不幸的是，这个解决方案不是自动化的，并且不适用于移动用户。

你如何处理这种情况？

    cocoa-touch - 如何设置 UIImageView 相对于兄弟视图的位置

ID：545180

赞同：0

时间：2009-02-13T08:32:22.607

标签：cocoa-touch

如何设置 UIImageView相对于同级视图的~~层位置？~~

我的意思是像 flash 中的 swapDepths() / setChildIndex()

非常感谢您的阅读

            回答 #1

赞同：2

时间：2009-02-13T08:52:18.300

用绝对的术语描述你正在尝试的东西会很有用，而不是通过引用人们可能不熟悉的另一个框架（特别是因为“层”在 Cocoa.

如果“层”是指它相对于同级视图的位置，那么您可以使用以下功能。

```
bringSubviewToFront
sendSubviewToBack
exchangeSubviewAtIndex 
```

请注意，这些是在您希望重新定位的 UIView / UIImageView 的父级上调用的。例如，这会将 imageview 带到它的兄弟姐妹面前；

```
[imageView.superview bringSubviewToFront: imageView]; 
```

        javascript - 如何在javascript中捕获异常？

ID：545181

赞同：14

时间：2009-02-13T08:33:06.647

标签：javascript, exception, error-handling

如果未完成插入查询，我想在 javascript 中捕获异常。

我写了下面的代码：

```
var adoConn = new ActiveXObject("ADODB.Connection");
var adoRS = new ActiveXObject("ADODB.Recordset");
var rec = new ActiveXObject("ADODB.Record");
adoConn.Open="DRIVER={MySQL ODBC 3.51 Driver};SERVER=172.25.37.145;" + "DATABASE=confluence;UID=root;PASSWORD=somePassword;OPTION=3";
//Connectionstring
alert('Database Connected');
adoConn.Execute("insert into `session` (SessionId,Timestamp) values ('"+SessionId+"','"+SessionCurrenttime+"')"); 
```

如果我得到相同的会话 id，则不会执行查询，因为它是数据库中的主键。

            回答 #1

赞同：25

时间：2009-02-13T11:57:30.523

为了完整，这是完整的结构

```
try {
  // your code that can throw exception goes here
} catch(e) {
  //do stuff with the exception
} finally {
  //regardless if it worked or not, do stuff here (cleanup?)
} 
```

            回答 #2

赞同：3

时间：2009-02-13T08:38:41.453

```
<script language="JavaScript">

try
{
 colours[2] = "red";
}
catch (e)
{
  alert("Oops! Something bad just happened. Calling 911...");
}

</script> 
```

（摘自[http://www.devshed.com/c/a/JavaScript/JavaScript-Exception-Handling/](http://www.devshed.com/c/a/JavaScript/JavaScript-Exception-Handling/)）

            回答 #3

赞同：2

时间：2009-02-13T08:42:19.277

```
try {
  // your code that can throw exception goes here
} catch(e) {
  //do stuff with the exception
} 
```

仅供参考 - 您发布的代码看起来，好吧，因为想要一个更好的词，丑陋！（无意冒犯）您不能使用[DWR](http://directwebremoting.org/)或其他一些 JavaScript 框架（取决于您的语言选择）来隐藏后端的所有数据库连接内容，并且只让 javascript 调用后端代码并对响应做一些事情吗？

            回答 #4

赞同：1

时间：2009-02-13T08:37:08.337

```
try {
    adoConn.Execute("insert into session (SessionId,Timestamp) values ('"
                     + SessionId + "','" 
                     + SessionCurrenttime + "')");
} catch(e) {
    /*use error object to inspect the error: e.g. return e.message */
} 
```

        xml - XML 与 RDMS 相比的优缺点

ID：545184

赞同：3

时间：2009-02-13T08:33:59.483

标签：xml, database

使用 XML 而不是 RDMS 有缺点吗？我问这个的原因是因为我的数据更自然地由 XML 结构表示，而不是 RDBMS。我最初想把[数据存储在关系数据库](https://stackoverflow.com/questions/545145/map-xml-structure-to-database-schema)中，但是关系数据库在处理树状数据结构方面缺乏灵活性，这让我很受不了。所以我正在考虑将数据存储在 XML 中。

我担心的一件事是性能损失。虽然 RDBMS 可以处理大型数据集，但我不确定 XML 是否也可以这样说。此外，数据库查询非常完善，并且相当容易使用和构建，那么 XML 查询呢？我不知道。

我正在做.Net 应用程序。

            回答 #1

赞同：5

时间：2011-04-13T20:16:59.890

如果您正在使用 XML 数据，那么几乎毫无疑问您应该研究原生 XML 数据库。

两个最流行的 Native XML 数据库 MarkLogic server 和 eXist 都提供了极其健壮和高效的索引机制，以及这个列表中提到的许多特性。

事实上，用于许多搜索应用程序的 MarkLogic 服务器在执行 SQL 数据库时大大超过了 SQL 数据库，尤其是在大型 xml 数据集上。这是因为它是专门为使用 XML 而构建的，并且知道索引它的最佳方法，而没有规范化 SQL 则不会。

根据当前的市场趋势，很明显，虽然 SQL 并没有消失，但它的市场份额肯定会输给 NoSQL 方法，尤其是在涉及以文档为中心的数据时。

更多细节  -  - 

大多数情况下，人类与之交互的数据是非结构化和高度的。从信息架构的角度来看，将这些数据规范化和非规范化为平面关系结构不仅耗时，而且还迫使我们以不自然的方式查询数据。

当前的本机 xml 数据库允许轻松添加大量未结构化（但经过模式验证）的数据并对其进行有效索引。

使用 xpath 查询这些文档是一种更自然的遍历和提取​​数据的方式，因为查询是结构的表示。

它还可以使用 XQuery 和 XSLT 轻松转换。

最终结果是开发人员的投资回报率更高。你写的代码更少，得到的更多。我以前主要写 php/sql 应用程序。一旦我们将架构转移到 Native XML 和 XQuery，我就能够用更简单、高效且简洁的 XQuery 替换数千行代码。

如果您有预算 (~250k)，请查看 MarkLogic 服务器。它是有史以来最令人印象深刻和可扩展的数据库系统之一，并且都是原生 XML。据我所知，它支持事务、回滚等，以及 SQL 提供的所有其他功能。

eXist (http://exist-db.org) 是一个开源项目，它具有：

*   完整的 XQuery/XPath/XSLT 支持
*   高效的索引机制
*   内置全文搜索
*   支持 REST/WebDAV/SOAP/ATOM/XMLRPC
*   版本控制

            回答 #2

赞同：4

时间：2009-02-13T08:40:43.087

您不应该将 XML 与 RDBMS 进行比较，因为这是两种互补的技术；XML 不应被视为或视为 RDMBS 的替代品。

RDMBS 用于以一致的方式存储大量数据。RDBMS 应注意数据的一致性等...

例如，XML 可以用于不同计算机系统之间的数据交换，但它不应该用于长时间存储大量数据。

Xml 不允许您像 RDMBS 那样处理数据一致性；它不处理事务等等……Xml 实际上只不过是一个文本文件，它以某种结构化的方式包含数据。

            回答 #3

赞同：2

时间：2009-02-13T08:40:39.360

在我看来，这些是需要考虑的因素

    1.  更符合您的应用需求
    2.  您需要处理多大的数据集？
    3.  您是在应用程序之间传输数据还是要查询它？

考虑到这些因素后，如果您有大量数据处理和查询需求，我建议您决定使用 RDBMS，如果您需要导出数据或在应用程序之间传输数据，我建议您决定使用 XML。我还想建议您像尼克建议的那样考虑对您的数据和完整性需求的限制。

我在这方面的经验很少，但这是我从学校其他人那里听到的。

祝一切顺利。

            回答 #4

赞同：1

时间：2009-02-13T20:30:55.690

RDBMS 提供而 XML 不提供的东西，或多或少按重要性排列：

*   执行已定义的模式（尽管这对 XML 肯定是可用的）
*   支持多个作家
*   原子事务
*   参照完整性
*   定义明确的查询语言
*   通过索引、编译查询等优化访问的能力。
*   基于角色的安全性
*   触发器、存储过程、计算列等。

另外，您无需将整个数据库加载到内存中即可访问其中的任何一个。

XML 是一种适合对象模型的序列化格式。将您也可以使用 XPath 访问的相对自由格式的数据模型组合在一起非常有用，尤其是当您打算通过 XSLT 将该数据转换为 XML 或 HTML 时。它具有标准和平台独立的优点。  

但是如果你对它过于雄心勃勃，你很快就会进入那种导致你写出关于 XML 有多糟糕的咆哮的领域。（我在和你说话，[杰夫阿特伍德](http://www.codinghorror.com/blog/archives/001114.html)。）

            回答 #5

赞同：0

时间：2009-02-13T08:38:34.433

RDBMS 的两大固有优势是：

1.  索引。大大提升性能。
2.  约束。您可以定义元素之间的关系，这有助于维护数据的完整性。

请记住，您可以将 xml 放入 sql server 并使用 xpath 查询它，因此根据数据的形状，您可能能够两全其美。

            回答 #6

赞同：0

时间：2009-02-13T08:47:38.297

您可以两全其美，您的数据可以存储在数据库中，这必须是一个更好的解决方案。由于数据库更快，更安全，具有备份和恢复，回滚，管理工具等......

听起来好像您的数据本质上是分层的，可以强制数据库存储层次结构而不会出现太多问题。

如果您将数据提取为 XML，则在使用数据时。我知道您是否使用的是开箱即​​用的 Sql Server，对于 Oracle 不太确定。

        cocoa-touch - UILabel 和从右到左的文本

ID：545187

赞同：0

时间：2009-02-13T08:34:37.720

标签：cocoa-touch

我有一个包含阿拉伯文本的 NSString 对象的集合。但是，当我尝试使用 UILabel 显示它们中的任何一个时，文本显示从左到右而不是从右到左（NSLog 正确显示字符串）

我正在考虑一种变通方法，对 UILabel 应用变换以使 y 轴对称，但是如何检测 NSString 是否包含 RTL 字符串？

            回答 #1

赞同：1

时间：2010-10-07T00:04:44.407

尝试在每个字符串的开头添加 unicode 字符 0x200F。此字符是指示文本方向性的不可见标记字符。

            回答 #2

赞同：0

时间：2009-02-13T09:12:45.333

您是否尝试将您的地区设置为阿拉伯语？我原以为这种事情会自动处理。

        java - 强制 JUnit 一次运行一个测试用例

ID：545194

赞同：8

时间：2009-02-13T08:38:11.173

标签：java, unit-testing, testing, ant, junit

我在一些非常高级的单元测试中遇到了问题（使用 PowerMock 进行模拟和 JUnit 4.5）。无需过多介绍，测试类的第一个测试用例总是会成功，但同一测试类中的任何后续测试用例都会失败。但是，例如，如果我选择只运行 10 个测试用例中的 5 个，它将通过。因此，所有测试在单独运行时都会通过。有没有办法强制 JUnit 一次运行一个测试用例？我从一个蚂蚁脚本中调用 JUnit。

我知道依赖测试用例的问题，但我无法确定这是为什么。测试用例中没有保存的变量，因此在 @Before 注释处无事可做。这就是为什么我正在寻找一种紧急解决方案，例如强制 JUnit 单独运行测试。

            回答 #1

赞同：18

时间：2013-01-30T17:10:52.990

我知道所有建议，但最终在这里回答您的问题是实现您想要的简单方法。只需将此代码放入您的测试用例中：

```
Lock sequential = new ReentrantLock();

@Override
protected void setUp() throws Exception {
    super.setUp();
    sequential.lock();
}

@Override
protected void tearDown() throws Exception {
    sequential.unlock();
    super.tearDown();
} 
```

这样，在获取锁之前无法开始测试，并且一次只能获取一个锁。

            回答 #2

赞同：10

时间：2009-02-13T08:47:44.223

看来你的测试用例是依赖的，即：case-X的执行影响case-Y的执行。应该避免使用这样的测试系统（例如：无法保证 JUnit 运行您的案例的顺序）。

您应该重构您的案例以使它们彼此独立。很多时候使用@Before 和@After 方法可以帮助你解开这些依赖。

            回答 #3

赞同：5

时间：2009-02-13T10:44:28.813

您的问题不是 JUnit 一次运行所有测试，您的问题是您看不到测试失败的*原因。*解决方案：

1.  向测试添加更多断言，以确保每个变量实际上都包含您的想法
2.  从网上下载一个IDE，使用内置的调试器查看各种变量
3.  在测试失败之前转储对象的状态。
4.  使用断言的“消息”部分输出更多信息为什么它失败（见下文）
5.  禁用除少数测试之外的所有测试（在 JUnit 3 中：将源中的所有字符串“void test”替换为“void dtest”；在 JUnit 4 中：将“@Test”替换为“//D@TEST”）。

例子：

```
assertEquals(list.toString(), 5, list.size()); 
```

            回答 #4

赞同：3

时间：2009-02-13T22:51:41.293

恭喜。你发现了一个错误。;-)

如果测试“不应该”相互影响，那么您可能已经发现了您的代码可能进入损坏状态的情况。尝试添加断言和日志以找出代码出错的地方。您甚至可能需要在调试器中运行测试并在第一次测试后检查代码的内部值。

            回答 #5

赞同：2

时间：2009-02-13T08:48:07.423

如果我不直接回答您的问题，请原谅，但您的问题不正是 TestCase.setUp() 和 TestCase.tearDown() 应该解决的问题吗？这些是 JUnit 框架将始终在每个测试用例之前和之后调用的方法，通常用于确保您以相同的状态开始每个测试用例。

另请参阅 TestCase 的[JavaDoc](http://junit.org/junit/javadoc/4.5/junit/framework/TestCase.html)。

            回答 #6

赞同：1

时间：2009-02-13T23:35:01.393

您应该检查您的整个代码库，确保没有引用可变状态的静态变量。理想情况下，程序应该没有静态可变状态（或者至少应该[像我在这里所做的那样](http://dimdwarf.sourceforge.net/documentation)记录它们）。此外，如果测试写入文件系统或数据库，你应该非常小心地清理你写的东西。否则运行测试可能会泄漏一些副作用，这使得测试难以独立和可重复。

Maven 和 Ant 包含一个用于运行 JUnit 测试的“forkmode”参数，该参数指定每个*测试类*是否有自己的 JVM 或所有测试都在同一个 JVM 中运行。但是他们没有在自己的 JVM 中运行每个*测试方法的选项。*

            回答 #7

赞同：0

时间：2009-02-13T08:48:50.213

您的描述告诉我，您的单元测试相互依赖。**强烈不建议**在单元测试中这样做。

单元测试必须是独立的和隔离的。您必须能够单独执行它们，所有它们（按什么顺序，没关系）。

我知道，这对你没有帮助。问题将出现在您的`@BeforeClass`or`@Before`语句中。会有依赖。所以重构它们并尝试隔离问题。

可能您的模拟是在您的`@BeforeClass`. 考虑将其放入`@Before`语句中。所以没有比测试用例持续时间更长的实例。

            回答 #8

赞同：0

时间：2009-02-13T10:02:54.700

我知道依赖测试用例的问题，但我无法确定这是为什么。测试用例中没有保存的变量，因此在 @Before 注释处无事可做。这就是为什么我正在寻找一种紧急解决方案，例如强制 JUnit 单独运行测试。

@Before 语句是无害的，因为每个测试用例都会调用它。@Before**类**很危险，因为它必须是静态的。

            回答 #9

赞同：0

时间：2009-02-13T23:25:15.100

在我看来，也许不是您没有正确设置或拆除测试（尽管额外的设置/拆除可能是解决方案的一部分），但也许您在代码中共享了您没有的状态意识到。如果早期测试设置了您不知道的静态 / 单例 / 共享变量，那么如果他们没有预料到，后面的测试将失败。即使使用 Mocks，这也是非常可能的。你需要找到这个原因。我同意其他答案，因为您的测试暴露了一个不应通过尝试以不同方式运行测试来解决的问题。

        web-services - 将 Biztalk 编排用作 Web 服务

ID：545197

赞同：0

时间：2009-02-13T08:38:54.823

标签：web-services, biztalk, orchestration

我在 Biztalk 中发布了一个编排作为 Web 服务。有谁知道我如何使用 XML 序列化或其他东西从文件中加载 XML 并将其“转换”为 web 服务期望的消息类型？人们通常如何使用这个网络服务？我尽量避免使用无类型消息，因为我同时使用 XML 和平面文件，并且读到这可能意味着麻烦。

            回答 #1

赞同：0

时间：2009-02-20T11:52:06.303

好吧，我想一般来说，Web 服务的想法是您向它们添加一个 Web 引用，这将生成一组您可以用来与 Web 服务交互的代理类。

您通常不必担心将 xml 文件与 Web 服务格式进行序列化，生成的代码会为您完成。

但是，如果您确实希望使用 XML，您可以使用 .net 序列化将 xml 文件反序列化为生成的代理类型（以及序列化您收到的任何响应）。

这是一个如何将 xml 反序列化为类实例的基本示例，然后您可以将此实例传递给生成的代理中的方法。

```
 System.Xml.Serialization.XmlSerializer xser = new System.Xml.Serialization.XmlSerializer(typeof(<generated request type here>));
        xser.UnknownAttribute += new System.Xml.Serialization.XmlAttributeEventHandler(xser_UnknownAttribute);
        xser.UnknownElement += new System.Xml.Serialization.XmlElementEventHandler(xser_UnknownElement);
        xser.UnknownNode += new System.Xml.Serialization.XmlNodeEventHandler(xser_UnknownNode);
        xser.UnreferencedObject += new System.Xml.Serialization.UnreferencedObjectEventHandler(xser_UnreferencedObject);
        <generated request type here> request = (<generated request type here>)xser.Deserialize(<xml stream here>); 
```

我希望这是有道理的

            回答 #2

赞同：0

时间：2010-02-22T13:21:43.090

你的问题有点混乱。您开始说您将编排发布为 Web 服务，但提出了关于使用它的问题。

**如果您谈论的是已发布**
的 Web 服务：由 BizTalk Web 服务向导生成的 Web 服务与您在 .NET 中编写的 Web 服务没有什么不同。根据您编排所期望的消息类型以及您在向导中如何构建操作。该向导将使用 WSDL 和模式为您自动生成一个 Web 服务（内部会有一些 BizTalk 特定位，但您无需担心实现）。

您的消费者（独立于平台）应该能够使用该 Web 服务而不会出现任何重大问题。

**如果您尝试使用 Orchestration 中的 Web 服务，**
请查看本文[http://msdn.microsoft.com/en-us/library/ms935219(BTS.10).aspx](http://msdn.microsoft.com/en-us/library/ms935219(BTS.10).aspx) 

        exception - 在 BAM 中获取接收管道错误信息

ID：545205

赞同：1

时间：2009-02-13T08:41:10.467

标签：exception, biztalk, biztalk-bam

我有两个编排，其中一个用作另一个编排的错误处理程序，并从中获取失败的消息。我已经在 BAM 中进行了设置。问题是当文件在接收端口失败时，我在活动搜索中没有得到任何有用的信息。只是已经注册了一些东西。来自 BAM 的数据：

ActivityID：2738a492-04c7-4887-9ff3-6902f435bda4 错误代码：

  ErrorDesc：

  文件名：

  进度错误：已处理的 TransactionId：

  rcvPort：

  sndPort：

在跟踪分析器中，我使用 errorReporter 中的属性。Ex ErrorReport.FailureCode。错误处理程序编排应按原样移动文件。

有人现在我做错了吗？

当文件在接收阶段失败时，是否可以获得任何信息？

大多数情况下，我需要文件名和错误代码/说明。（进度错误是我创建的进度活动）。

            回答 #1

赞同：0

时间：2009-02-13T14:19:16.893

我解决了。出于某种原因，如果我为消息制作了进度维度，我无法将其追踪到 bam。当我刚刚存储纯数据时，它工作正常。

        javascript - 您在任何时候可以在旅途中拥有的 JavaScript 对象的数量是否有限制？

ID：545214

赞同：1

时间：2009-02-13T08:43:45.640

标签：javascript, object, browser

我正在考虑将我拥有的 Flash 应用程序转换为 JavaScript，但被告知由于我在旅途中必须拥有的对象数量，这可能是不可能的。

这是真的吗？如果是，限制是什么？

            回答 #1

赞同：3

时间：2009-02-13T08:54:08.577

*[JavaScript 内存限制](http://blog.votanweb.com/2007/2/24/javascript_memory_limit)*表明您可以在 Firefox 中分配至少 20 MB 的内存。

虽然肯定有一个限制，但我怀疑你会满足内存限制。如果您正在转换一个非常动态的 Flash 应用程序，那么您的性能很可能会太差。

            回答 #2

赞同：3

时间：2009-02-13T09:11:53.573

Flash 在移动对象方面非常有效，因为这是它的主要功能。使用 JavaScript 在 HTML 中移动对象将会变得越来越慢。然而，使用 JavaScript 可以实现相当惊人的事情。

见[旅鼠](http://www.elizium.nu/scripts/lemmings/)。

            回答 #3

赞同：1

时间：2009-02-13T11:05:16.017

[链接文本](http://blog.votanweb.com/2007/2/24/javascript_memory_limit)处脚本的改进版本。这更快，因为它使用连接，并让浏览器有时间不时更新页面。

```
function allocate_mem() {
    var mega=[];
    // Strings are stored as UTF-16 = 2 bytes per character.
    // Below a 1Mibi byte string is created
    for(var i=0; i<65536; i++){
        mega.push('12345678')
    }
    mega=mega.join("");

    var x=document.getElementById("max_mem");

    var size=0;
    var large=[];
    function allocate( ) {
        ++size;
        //if (size>400) {alert(large.join("").length/1048576); return; }
        large.push("."+mega.slice(0));
            x.innerHTML = "max memory = " + size + " MB";
        setTimeout(allocate, size %10 ? 0: 200);
    }

    allocate();

} 
```

        emacs - 从 elisp 加载动态库

ID：545216

赞同：7

时间：2009-02-13T08:44:01.473

标签：emacs, elisp

我需要使用一些本机代码，我想尝试将 elisp 作为脚本语言。是否可以调用在动态库（Windows 中的 dll）中实现的本机函数？或者唯一的可能是实现本机代码，用 DEFUN (...) 宏包装它并重新编译 emacs？

            回答 #1

赞同：12

时间：2009-02-13T09:14:01.230

您不能使用 Emacs Lisp 代码动态加载库。为了解决这个问题，人们通常调用外部程序（进程）并通过向其发送命令并读取其输出来控制它。

您可以查看 slime、tramp、gnuserv、movemail 和其他一些类似的 hack 示例。

            回答 #2

赞同：6

时间：2009-02-13T17:04:53.420

[GNU Emacs 23](http://www.gnu.org/software/emacs/)支持[D-BUS](http://en.wikipedia.org/wiki/D-BUS)。虽然主要是 Unix 的东西，但 D-BUS 在 Windows 上受支持，并为用户级应用程序提供 IPC 系统。

你可能可以用它来构建你想要的东西。

            回答 #3

赞同：0

时间：2009-02-13T10:48:02.797

此功能仅存在于 SXEmacs 中，它不支持 Windows，但在 Unixes 中它可以正常工作

        url - 将相对链接转换为绝对链接？

ID：545227

赞同：1

时间：2009-02-13T08:48:52.600

标签：url, relative-path, hyperlink

我正在使用 PHP 和正则表达式编写一个小脚本

该脚本的目的是提取页面中的所有链接并将这些链接转换为绝对链接——当它是相对链接时——我知道相对链接是如何工作的，但它们也是一些问题

假设我们有这个页面[http://www.example.com/xxx1/xxx2/xxx3.html](http://www.example.com/xxx1/xxx2/xxx3.html)
如果这个页面有以下链接

index.html --- 绝对链接是[http://www.example.com/xxx1/xxx2/index.html](http://www.example.com/xxx1/xxx2/index.html)

./index.html --- 绝对链接是[http://www.example.com/xxx1/xxx2/index.html](http://www.example.com/xxx1/xxx2/index.html)

../index.html --- 绝对链接是[http://www.example.com/xxx1/index.html](http://www.example.com/xxx1/index.html)

/index.html --- 绝对链接是[http://www.example.com/index.html](http://www.example.com/index.html)

所以

index.html = 将在当前目录中打开

./index.html = 也会在当前目录打开

../index.html = 将在父目录中打开

/index.html = 将在根目录中打开

问题是如果 URL 对搜索引擎友好怎么办？

说我们有这个网址

（（案例1））：[http ://www.example.com/xxx1/xxx2/xxx3/index/](http://www.example.com/xxx1/xxx2/xxx3/index/)

或者

（（案例2））：[http ://www.example.com/xxx1/xxx2/xxx3/index](http://www.example.com/xxx1/xxx2/xxx3/index)

case1 中的“索引”是目录还是页面？它是 case2 中的目录还是页面？以及在情况 1 和 2 中以下链接如何作为绝对链接

index.html --- ?

./index.html --- ?

../index.html --- ?

/index.html --- ?

我不确定这对你们中的一些人来说是不是一个简单的问题，但对我来说它是令人困惑的？

谢谢 ：）

            回答 #1

赞同：3

时间：2009-02-13T08:57:13.233

直接回答你的例子

在**情况 1**中，`index`是 URL 的“目录组件”，而在**情况 2** `index`中，是 URL 的“文件组件”。这与它实际上是 Web 服务器上的常规文件还是目录无关——请参阅下面的说明。如果服务器在这些 URL 上提供 HTML 页面，我将两者都称为“页面”。

**案例 1：（**  来自 的链接`[http://www.example.com/xxx1/xxx2/xxx3/index/](http://www.example.com/xxx1/xxx2/xxx3/index/)`）

1.  `index.html`->`[http://www.example.com/xxx1/xxx2/xxx3/index/index.html](http://www.example.com/xxx1/xxx2/xxx3/index/index.html)`
2.  `./index.html`->`[http://www.example.com/xxx1/xxx2/xxx3/index/index.html](http://www.example.com/xxx1/xxx2/xxx3/index/index.html)`
3.  `../index.html`->`[http://www.example.com/xxx1/xxx2/xxx3/index.html](http://www.example.com/xxx1/xxx2/xxx3/index.html)`
4.  `/index.html`->`[http://www.example.com/index.html](http://www.example.com/index.html)`

**案例 2：（**  来自 的链接`[http://www.example.com/xxx1/xxx2/xxx3/index](http://www.example.com/xxx1/xxx2/xxx3/index)`）

1.  `index.html`->`[http://www.example.com/xxx1/xxx2/xxx3/index.html](http://www.example.com/xxx1/xxx2/xxx3/index.html)`
2.  `./index.html`->`[http://www.example.com/xxx1/xxx2/xxx3/index.html](http://www.example.com/xxx1/xxx2/xxx3/index.html)`
3.  `../index.html`->`[http://www.example.com/xxx1/xxx2/index.html](http://www.example.com/xxx1/xxx2/index.html)`
4.  `/index.html`->`[http://www.example.com/index.html](http://www.example.com/index.html)`

所以唯一保持不变的是绝对链接 - 4。

解释

链接相对于浏览器所在的 URL，它可能不是您最初输入的 URL（例如在 HTTP 重定向中）。一旦您点击链接或被重定向，大多数网络浏览器都会使用当前地址更新 URL 栏，因此除非您只是编辑了该地址，否则您看到的地址才是最重要的。

以斜杠结尾的 URL 被认为是指目录（由[RFC2396](ftp://ftp.ietf.org/rfc/rfc2396.txt)对 URI 语法进行暗示，尽管它实际上并不这样称呼它们），否则它们被认为是指目录中的文件。

**--旁注：** *这不一定对应于Web服务器用于提供文件的文件系统路径（如果有的话）类型。*  大多数 Web 服务器，当被要求提供到其文件系统上的目录的 URL 映射时，将在目录中提供具有某些设置名称的文件（通常是 index.html，但通常可以配置选择），或者生成 HTML 目录列表由服务器（如果禁用，则访问错误）。当请求没有尾部斜杠的类似路径的“文件 URL”时，通常会提供相同的服务，在这种情况下，“文件 URL”实际上映射到目录文件系统路径。**--**

This can lead to inconsistencies such as the above example, where the "file URL" `[http://www.example.com/xxx1/xxx2/xxx3/index](http://www.example.com/xxx1/xxx2/xxx3/index)` is probably equivalent to the "directory URL" `[http://www.example.com/xxx1/xxx2/xxx3/index/](http://www.example.com/xxx1/xxx2/xxx3/index/)`, but relative links may refer to different paths from those two URLs, and one may work and the other may be broken.

For that reason, when a linking to a directory, it is recommended to always use the "directory URL" (with the terminating slash) and not the equivalent "file URL" - e.g. link to `[http://www.ietf.org/meetings/](http://www.ietf.org/meetings/)` and not `[http://www.ietf.org/meetings](http://www.ietf.org/meetings)` even if both would serve the same page.  Many web servers are in fact configured to redirect clients requesting the latter to the former using a an HTTP 301 redirect response.  You can see this if you enter the latter in your browser's URL bar - the URL bar will change to the former once it gets that response.

        testing - 为开发人员性能测试建立实验室

ID：545228

赞同：3

时间：2009-02-13T08:49:05.110

标签：testing, load-testing, stress-testing

我们的产品在性能方面赢得了不好的声誉。嗯，这是一个 13 岁的大型企业应用程序，需要提神醒脑，特别是提高其性能。

我们决定在这个版本中战略性地解决性能问题。我们正在评估一些关于如何做到这一点的选项。

我们确实有经验丰富的负载测试工程师，他们配备了市场上最好的工具，但通常他们会在版本开发生命周期的后期获得稳定版本，因此在上一个版本中，开发人员没有足够的时间来修复他们的所有发现。（是的，我知道我们需要提供更早的稳定版本，我们也在处理这个过程，但它不在我的范围内）

我正在推动的方向之一是设置一个安装了每晚构建的实验室环境，以便开发人员可以测试其代码的性能影响。我希望模拟真实用户体验的脚本不断加载这个环境。在这个加载的环境中，每个开发人员都必须编写一个特定的脚本来测试他的代码（即真实世界环境中的单一用户体验）。我想生成一份报告，显示每次迭代对现有功能的影响，以及新功能的性能。

我有点担心我的目标太高了，结果会变得太复杂。

您如何看待这样的想法？有没有人有设置这样一个环境的经验？你能分享你的经验吗？

            回答 #1

赞同：2

时间：2009-02-13T08:56:03.580

这听起来是个好主意，但老实说，如果您的组织无法为其专门为此目的而雇用的昂贵的负载测试团队进行构建，那么您的想法将永远无法实现。

首先去寻找低垂的果实。在流程的早期为性能测试团队获取可用的夜间构建。

事实上，如果这个版本是关于性能的，为什么不让团队只使用这个版本来解决上一个版本迭代后期出现的所有性能问题。

编辑：“开发人员对性能测试代码没有责任”是评论。是的，没错。我个人希望每个开发人员都拥有 YourKit java profiler 的副本（它既便宜又有效）并且知道如何使用它。然而，不幸的是，性能调优是一项非常非常有趣的技术活动，当您可以更好地开发功能时，可能会花费大量时间来做这件事。

如果您的开发团队反复开发明显缓慢的代码，那么对性能或更好的程序员的教育是唯一的答案，而不是更昂贵的过程。

            回答 #2

赞同：2

时间：2009-02-13T09:20:07.080

生产力的最大提升之一是可以在一夜之间运行的自动化构建系统（这称为持续集成）。昨天犯的错误今天一大早就被发现，那时我还很新鲜，当我可能还记得我昨天所做的事情时（而不是几周/几个月后）。

所以我建议首先实现这一点，因为它是其他任何事情的基础。如果你不能可靠地构建你的产品，你会发现很难稳定开发过程。

完成此操作后，您将拥有创建性能测试所需的所有知识。

但有一条建议：不要试图一次完成所有事情。一步一步工作，一个接一个地解决问题。如果有人提出“我们也必须这样做”，您必须像处理任何其他功能请求一样进行分类：这有多重要？有多危险？实施需要多长时间？我们将获得多少？

推迟艰巨但重要的任务，直到您理清了基础知识。

            回答 #3

赞同：1

时间：2009-02-17T05:29:14.487

每晚构建是性能测试的正确方法。我建议您需要每晚自动运行的脚本。然后将结果记录在数据库中并提供定期报告。你真的需要两种报告：

*   每个指标随时间变化的图表。这将帮助您了解趋势
*   每个指标与基线的比较。您需要知道一天内什么时候出现急剧下降，或者什么时候超过了性能阈值。

其他一些建议：

*   确保您的机器与您的预期环境相似。池中有低端和高端机器。
*   一旦开始测量，切勿更换机器。你需要比较喜欢。您可以添加新机器，但不能修改任何现有机器。

            回答 #4

赞同：0

时间：2009-02-13T08:58:40.673

我们构建了一个小型测试平台，用于进行完整性测试 - 即当按下按钮时，应用程序是否启动并按预期工作，验证是否工作等。我们的应用程序是一个网络应用程序，我们使用[Watir](http://wtr.rubyforge.org/)一个基于 ruby​​ 的工具包来驱动浏览器。这些运行的输出被创建为 Xml 文档，我们的 CI 工具（巡航控制）可以将结果、错误和性能作为每个构建日志的一部分输出。整个事情运行良好，并且可以扩展到多台 PC 以进行适当的负载测试。

然而，我们之所以这样做，是因为我们拥有的身体多于工具。有一些大型压力测试工具可以满足您的所有需求。它们的成本，但这将少于手动滚动所花费的时间。我们遇到的另一个问题是让我们的开发人员编写 Ruby/Watir 测试，最终落到了一个人身上，因此测试工作几乎成了瓶颈。

            回答 #5

赞同：0

时间：2009-02-13T09:12:15.710

夜间构建非常好，实验室环境非常好，但我认为你有可能将性能测试与直接错误测试混淆。

确保您的实验室条件是独立且稳定的（即您一次只改变一个因素，无论是您的应用程序还是 Windows 更新），并且硬件能够反映您的目标。请记住，您的基准比较仅在实验室内部是防弹的。

由编写代码的开发人员编写的测试脚本往往是有害的。它并不能帮助您消除实施中的误解（因为同样的误解也会出现在测试脚本中），而且实际发现问题的动力有限。更好的是采用 TDD 方法并首先作为一个组（或一个单独的组）编写测试，但如果失败，您仍然可以通过协作编写脚本来改进该过程。希望您在设计阶段有一些用户故事，并且可以重放日志以获得真实世界的体验（应用程序不同）。

        apache-flex - 在 FLEX 中调度自定义事件的问题

ID：545253

赞同：0

时间：2009-02-13T09:02:58.277

标签：apache-flex, events, actionscript, mxml

首先让我说我对 flex 和 action 脚本还很陌生。无论如何，我正在尝试创建一个自定义事件来获取选定的员工并填充表单。正在调度事件（dispatchEvent(event) 返回 true），但在处理程序内部设置的断点永远不会被命中。

这是我的代码的一些片段（逻辑排列以便更好地理解）：

**员工表单自定义组件**

```
<mx:Metadata>
     [Event(name="selectEmployeeEvent", type="events.EmployeeEvent")]
<mx:Metadata>
<mx:Script>
   [Bindable]
   public var selectedEmployee:Employee;
</mx:Script>
...Form Fields 
```

**应用**

```
<mx:DataGrid id="grdEmployees" width="160" height="268"
            itemClick="EmployeeClicked(event);">
<custom:EmployeeForm
     selectEmployeeEvent="SelectEmployeeEventHandler(event)"
     selectedEmployee="{selectedEmployee}" />

<mx:Script>
    [Bindable]
private var selectedEmployee:Employee;

private function EmployeeClicked(event:ListEvent):void
    {
     var employeeData:Employee;
     employeeData = event.itemRenderer.data as Employee;
     var employeeEventObject:EmployeeEvent = 
             new EmployeeEvent( "selectEmployeeEvent", employeeData);
     var test:Boolean = dispatchEvent(employeeEventObject);
         //test == true in debugger
}
    private function SelectEmployeeEventHandler(event:EmployeeEvent):void
    {
         selectedEmployee = event.Employee; //This event never fires
    }

</mx:Script> 
```

            回答 #1

赞同：3

时间：2009-02-13T13:01:28.547

这里有几件事合谋造成麻烦。:)

首先，您的自定义组件中的此声明：

```
<mx:Metadata>
     [Event(name="selectEmployeeEvent", type="events.EmployeeEvent")]
<mx:Metadata> 
```

... 向编译器宣布您的自定义组件*调度*此特定事件，但您实际上是使用包含文档而不是自定义组件来调度它 - 所以您的事件侦听器永远不会被调用，因为没有任何设置可以调用它。

另一件事是，在这样的列表项选择情况下，更典型的行为是从 ListEvent 的 currentTarget 的 selectedItem 属性中提取对象（即，您的网格 - 和 currentTarget 而不是目标，因为[事件冒泡](http://www.google.com/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Flivedocs.adobe.com%2Fflex%2F3%2Fhtml%2Fevents_08.html&ei=OmWVScm9EIHwsAOJjamtBw&usg=AFQjCNG5r5-on9W47OcOHXRHNsA3M0NhrQ&sig2=TeLvJkEB9b11CMXxFnbmPA)的工作方式）。在您的情况下，网格的 selectedItem 属性应包含一个 Employee 对象（假设您的网格的 dataProvider 是 Employee 对象的 ArrayCollection），因此您可以通过这种方式直接引用它：

```
private function employeeClicked(event:ListEvent):void
{
   var employee:Employee = event.currentTarget.selectedItem as Employee;
   dispatchEvent(new EmployeeEvent("selectEmployeeEvent"), employee);
} 
```

使用 itemRenderer 作为数据源是出了名的不可靠，因为项目渲染器是视觉元素，框架会以您无法预测的方式重用它们。相反，正如我上面演示的那样，直接从事件中提取项目要安全得多——在这种情况下，您根本不需要“employeeData”对象，因为您已经有了 Employee 对象。

不过，也许建议一种更符合框架运行方式的方法可能会更好——其中不需要事件分派，因为您可以使用开箱即用的数据绑定功能。框架。例如，在您的包含文档中：

```
<mx:Script>
    <![CDATA[

        import mx.events.ListEvent;

        [Bindable]
        private var selectedEmployee:Employee;

        private function dgEmployees_itemClick(event:ListEvent):void
        {
            selectedEmployee = event.currentTarget.selectedItem as Employee;
        }

    ]]>
</mx:Script>

<mx:DataGrid id="dgEmployees" dataProvider="{someArrayCollectionOfEmployees}" itemClick="dgEmployees_itemClick(event)" />

<custom:EmployeeForm selectedEmployee="{selectedEmployee}" /> 
```

...您将定义一个 selectedEmployee 成员，标记为 Bindable，您在 DataGrid 的 itemClick 处理程序中设置该成员。这样，您在 EmployeeForm 上指定的绑定表达式将确保表单始终具有对所选员工的引用。然后，在表单本身中：

```
<mx:Script>
    <![CDATA[

        [Bindable]
        [Inspectable]
        public var selectedEmployee:Employee;

    ]]>
</mx:Script>

<mx:Form>
    <mx:FormItem label="Name">
        <mx:TextInput text="{selectedEmployee.name}" />
    </mx:FormItem>
</mx:Form> 
```

...您只需接受所选员工（再次标记为可绑定，以确保表单字段始终包含有关该所选员工的最新信息）。

这有意义吗？鉴于我不熟悉您的应用程序的要求，我可能过于简单化了，但这是一个常见的场景，我想我会抛出一个替代方案来说明，让您更好地理解传统的方法处理它。  

但是，如果由于某种原因您确实需要调度自定义事件，除了简单地设置选定的项目 - 例如，如果有其他组件正在监听该事件 - 那么您指定的 dispatchEvent 调用应该没问题，只要您了解它是发送事件的包含文档，因此任何希望收到通知的人都需要将特定的侦听器附加到该文档：

```
yourContainingDoc.addEventListener("selectEmployeeEvent", yourOtherComponentsSelectionHandler); 
```

希望它有所帮助 - 随时发表评论，我会留意。

            回答 #2

赞同：1

时间：2009-02-13T09:48:39.930

您正在从较低代码示例（我猜是 DataGrid）中的类分派事件，但事件是在 EmployeeForm 类中定义的，并且事件处理程序同样附加到 EmployeeForm 实例。据我所知，事件在层次结构中向上传播，而不是向下传播，因此当您从表单的父级触发事件时，它永远不会触发表单本身的处理程序。从表单触发事件或将事件处理程序附加到父组件。

        ruby - 西纳特拉成功案例

ID：545254

赞同：25

时间：2009-02-13T09:03:05.467

标签：ruby, sinatra, web-frameworks

您成功使用 Sinatra 了吗？这是一个什么样的项目？在什么情况下你会推荐使用 Sinatra 而不是 Rails 或 Merb？

            回答 #1

赞同：20

时间：2009-02-13T16:39:39.147

我涉足过 Sinatra，但还没有真正写过任何严肃的东西。正如你上面所说，在[http://www.sinatrarb.com/wild.html](http://www.sinatrarb.com/wild.html)上有一个列表，尽管其中列出的许多应用程序似乎都链接到 GitHub 页面，我认为这些页面通常是人们尝试使用 Sinatra 并发布他们的结果在线。然后，还有[Sinatra 邮件列表](http://groups.google.com/group/sinatrarb)，您可以在其中找到一些有趣项目的链接。[*]

至于您关于何时使用 Sinatra 的问题，我个人会回答“针对较小的项目”。当您想要快速启动并运行某些东西时，Sinatra 似乎是一个绝佳的选择。对于喜欢 Ruby 的人来说，它也很棒。我的意思是，当你在 Rails 中做某事时，你必须使用“Rails 方式”。Rails 是一个**框架**你正在构建你的应用程序，你必须遵守它的习惯和惯例。另一方面，Sinatra 感觉就像一个图书馆。你觉得你在写 Ruby，如果你想连接到数据库，你使用你喜欢/认为适合工作的库，如果你想输出 HTML，你选择你喜欢的模板库，如果你想要一个简单的 web 框架，你选择 Sinatra。Sinatra 不是您构建整个应用程序的基础，它是您在应用程序的其余部分**旁边使用的东西。**

所以，正如您可能已经收集到的，我非常喜欢 Sinatra，我会将它用于个人（或小规模）项目。只要您知道自己在做什么，它就易于设置且易于使用。浏览[http://www.sinatrarb.com/wild.html](http://www.sinatrarb.com/wild.html)，似乎大多数人都在使用它，例如[Is Lost on yet?](http://islostonyet.com/) 和[日历什么都没有](http://calendaraboutnothing.com/)。

[*]**编辑：我在**[这里](http://groups.google.com/group/sinatrarb/browse_thread/thread/bf29456bd6e158e3/b10e944b165fa0cd)找到了一个线程，人们链接到他们的项目。似乎有更大和更小的项目。非常有趣的东西。

            回答 #2

赞同：2

时间：2009-02-13T09:35:27.120

[http://www.sinatrarb.com/wild.html](http://www.sinatrarb.com/wild.html)上有一个列表。

不过，我还是想听听更多关于他们的信息。我还怀疑在这个列表之外还有很多成功的 Sinatra 项目。

            回答 #3

赞同：2

时间：2009-02-24T15:27:03.273

我刚刚发布了用 Sinatra 编写的 TweepDiff ( [http://tweepdiff.com](http://tweepdiff.com) )。其他任何事情都会是矫枉过正，但我​​也会将 Sinatra 用于更大的项目。

            回答 #4

赞同：2

时间：2009-03-02T13:15:51.183

我认为 sinatra 最适合微应用程序开发（不足为奇，它是一个微框架）

Sinatra 为您提供了足够的抽象级别来快速构建几乎所有您想要的东西。我喜欢 sinatra 的一点是，该框架让您可以严格控制您的应用程序实际在做什么，您可以真正“感受”您正在编写的内容。所以，我会说 Sinatra 是一个微妙平衡的框架。

我还认为 Sinatra 对“喜欢编写 Ruby 的人”很有吸引力，如前所述。您在实现 sinatra 接口之前开始编写 ruby​​ 类。（这种工作流程的好例子：http: [//dev-logger.blogspot.com/2009/01/ric-rac-roe-in-soup-of-technologies.html](http://dev-logger.blogspot.com/2009/01/ric-rac-roe-in-soup-of-technologies.html)）

            回答 #5

赞同：1

时间：2009-07-08T15:20:18.633

我希望能够从我的 Web 服务器运行简洁的独立 Ruby 脚本。就功能而言，它类似于 CGI 库。西纳特拉是完美的。稍后有一个 sinatra 应用程序，我有一组通过简单的 sinatra 样式路由访问的脚本。

每当我需要编写一个不依赖于数据库的 Web 应用程序时，我怀疑 sinatra 将是我的第一个停靠点。

            回答 #6

赞同：0

时间：2009-03-02T20:52:24.207

我不得不回应上述大部分评论。我们正在实施用于浏览和基本数据报告的 Sinatra/HAML 堆栈。  

我真的很喜欢简单和直接连接到 Ruby 的组合。如果某些东西在浏览器中不起作用，很容易将其移植到直接的 Ruby 程序中进行调试。  

绝对有一种用 Sinatra 建造狗屋与用 Rails 建造泰姬陵的感觉。它很容易理解（它也帮助我理解了对 MVC 和 Rails 的需求）。

总的来说非常酷的东西而且非常快。我还没有强调它，所以我不能说它在现实世界中的表现如何。

            回答 #7

赞同：0

时间：2009-09-17T10:56:55.853

我使用 sinatra 制作了[http://istay.com](http://istay.com)，我只能说，对于任何不直接使用或没有数据库的网站来说，它都是一个很棒的小框架。

虽然我确实觉得 sinatra 已经达到了当前站点的极限，并且任何扩展都将使用 Rails 或其他框架编写。

            回答 #8

赞同：0

时间：2010-07-31T11:22:38.530

我将 Sinatra 用于小型“单一功能”类型的应用程序（[我当前的博客引擎](http://github.com/nathanhoad/nathanhoad)可能是一个很好的例子）。我认为 Sinatra 的简单性最适合小型实用程序和基本 API 前端（Twitter 应用程序等）。

对于更大规模的应用程序，甚至还有基于 Sinatra 的[Padrino 框架](http://www.padrinorb.com/)，其中包含一些您通常需要 Rails 提供的细节。

        php - 如何为 LAMP 删除 WIMP

ID：545256

赞同：3

时间：2009-02-13T09:03:59.787

标签：php, apache, iis-6

有没有人有使用 PHP5 在 Windows2000 服务器上无法完成的示例？

更新：澄清一下，我的问题不在于 IIS，或者我是一个“唯一开源”的人。这是托管是一个全面的可怕软件包。存储和带宽太荒谬了，没有控制面板，所以为了做任何事情，即使是像设置一个 cron 作业这样简单的事情，都需要联系技术支持，他们抱怨必须实施它，而且似乎在同一时间线上运行就像岛上的人一样迷失了。

为什么不直接告诉客户我听到你问了！试过了，失败了。托管公司不是托管公司，它是客户的朋友，我所说的任何内容都不会产生盲目的影响。我知道我的客户正在为一大堆废话付出代价，但他们就是不听。最重要的是，我不得不对代码库进行一些微小但基本的更改，以适应服务器的时髦设置，这意味着我现在必须维护两个代码库。我的开发版和现场版。这是可行的，但这是浪费精力，而且在紧迫的期限内，我有更好的事情要做。  

我要让我的客户“做正确的事”的唯一方法是想出一些由于服务器而无法工作的东西。如果没有，我会完成工作，上传它，洗掉它，然后再也不碰它，因为它比它的价值更麻烦。我不想这样做，因为我喜欢为我的工作感到自豪，但我不会浪费我的时间来补偿一个懒惰的服务器管理员，他真的不在乎事情是否有效，我也不会接受也怪他们。这是我最后一次尝试帮助不想被帮助的客户。也许我的标题具有误导性，但我不想让每个人都厌烦细节，我只需要一个答案，并认为 WIMP for LAMP 将是最快的提问方式。迁移到另一个 WIMP 环境不会打扰我，

            回答 #1

赞同：2

时间：2009-02-13T09:51:15.133

在 Windows 2000 Server 附带的 IIS 6 上，PHP 将作为 CGI 运行……因此它可以完成在 apache 下的 *nix 服务器上可以完成的任何事情。您还必须安装支持扩展和服务，如 MySQL ...

            回答 #2

赞同：2

时间：2009-02-13T15:11:03.243

将客户所犯的错误归咎于技术并不是一个好习惯。

1.  向客户解释你的问题（一次又一次）
2.  向他收取更多费用并告诉他这是因为您面临的问题
3.  延迟交付项目（提前通知他）告诉他这是因为托管的支持不力。
4.  找到更好、更便宜的托管服务并向您的客户展示比较。
5.  如果没有任何效果！！退出！:)

            回答 #3

赞同：1

时间：2009-02-13T09:31:01.483

听起来您的团队正在使用 Windows，而您是一个想要切换 Linux/Apache 但没有好的技术理由的开源粉丝。所以你在这里钓鱼。

我的评论是，如果您自己没有充分的理由，为什么不坚持使用 Windows。如果您自己确实有充分的理由，请论证适用于您的项目的充分理由。每种技术都有其自身的优点和缺点，并且都在生产中得到了成功应用。

当然，如果我误读了情况，我深表歉意——您能否编辑您的问题以更好地解释情况。

            回答 #4

赞同：0

时间：2009-03-09T11:18:02.983

我假设您目前没有利用 Apache 的 mod_rewrite 实用程序。这是您在 Windows 上无法做到的事情（您可以，但即使使用最新的路由/REST，这也是一项更大的工作）

如果他们想要宁静的 URL，这将是一个非常有力的案例，这通常被认为对搜索引擎有好处！

除此之外，收取更多费用。如果您采用固定费率，请解释您无法满足预算的原因并为额外工作报价。这些问题通常是由不公平的价格产生的（即在这种情况下对您不公平）。

            回答 #5

赞同：0

时间：2009-02-13T09:51:12.620

可能很难找到一个精通 IIS*和*PHP 的优秀系统管理员。

        java - jsp:invoke中的el表达式

ID：545258

赞同：2

时间：2009-02-13T09:04:20.317

标签：java, jsp, invoke

我正在尝试在我的标签文件中使用以下代码段：

```
<%@ attribute name="content" fragment="true"%>
...
<c:set var="part" value="content"/>
<jsp:invoke fragment="${part}" var="partValue"/>
... 
```

并且编译器给了我以下错误：

```
Syntax error, insert ") Statement" to complete IfStatement 
```

所以据我了解，不允许在片段属性中使用 el 表达式。有人可以指出我在规范中的这个限制吗？或者如果我在运行时计算的片段名称，请给出如何调用片段内容的建议

            回答 #1

赞同：1

时间：2009-02-13T09:34:47.293

从技术上来说，fragment 属性并不是一个 rtexprvalue，这可以从 schema 中看出；这意味着它是在编译时评估的。

对于您要实现的目标，实际上只有一组非常有限的用例。很可能您想为标签文件提供多个片段，并让一些条件决定输出哪个标签。

```
<c:choose>
    <c:when test="${condition1}"><jsp:invoke fragment="frag1"/></c:when>
    <c:otherwise><jsp:invoke fragment="frag2"/></c:otherwise>
</c:choose> 
```

        unit-testing - 如何在 Pivotal CRM 上对 ASR 进行单元测试

ID：545259

赞同：1

时间：2009-02-13T09:04:21.393

标签：unit-testing, pivotal-crm

我正在使用 Pivotal CRM，但我没有找到简单的方法为该软件的 ASR 编写单元测试代码。你有这个软件的编程测试经验吗？

编辑：我想到了一种简单但不完美的测试方式。但我愿意将赏金提供给任何提供最小洞察力的人。

            回答 #1

赞同：1

时间：2009-03-11T17:41:43.230

好问题。我会在实现的方法上注入存根或模拟来设置测试。因此，如果我实现如下所示的 IRFormScript 接口。我可以使用实现 IRForm 接口的存根来设置对注入到我的方法中的表单对象的期望。其中一些参数也只是字符串，所以很容易。您还必须删除 Pivotal 的任何其他接口，以测试您的功能，而无需实际访问真实系统。（IRSystem7、DataAccess 等）希望这会有所帮助！  [布兰登乔伊斯](http://blog.sonerdy.com)

```
public class TDD : Pivotal.Interop.RDALib.IRFormScript
{        
    public object AddFormData(Pivotal.Interop.RDALib.IRForm pForm, object Recordsets, ref object ParameterList)
    {
        throw new NotImplementedException();
    }

    public void DeleteFormData(Pivotal.Interop.RDALib.IRForm pForm, object RecordId, ref object ParameterList)
    {
        throw new NotImplementedException();
    }

    public void Execute(Pivotal.Interop.RDALib.IRForm pForm, string MethodName, ref object ParameterList)
    {
        throw new NotImplementedException();
    }

    public object LoadFormData(Pivotal.Interop.RDALib.IRForm pForm, object RecordId, ref object ParameterList)
    {
        throw new NotImplementedException();
    }

    public object NewFormData(Pivotal.Interop.RDALib.IRForm pForm, ref object ParameterList)
    {
        throw new NotImplementedException();
    }

    public void NewSecondaryData(Pivotal.Interop.RDALib.IRForm pForm, object SecondaryName, ref object ParameterList, ref Pivotal.Interop.ADODBLib.Recordset Recordset)
    {
        throw new NotImplementedException();
    }

    public void SaveFormData(Pivotal.Interop.RDALib.IRForm pForm, object Recordsets, ref object ParameterList)
    {
        throw new NotImplementedException();
    }

    public void SetSystem(Pivotal.Interop.RDALib.RSystem pSystem)
    {
        throw new NotImplementedException();
    }     
} 
```

            回答 #2

赞同：0

时间：2011-01-28T16:31:19.180

对于将任何内容编程到 Pivotal CRM 中，我会三思而后行。CDC 只是不适应现代编程技术。将其视为“仅在绝对必要时进行调整”的平台，您会做得很好。

我并不是要严厉，但如果您在 stackoverflow.com 上发布有关 Pivotal CRM 的问题，那么您可能使用错了 Pivotal CRM。

我这样说是因为我亲身了解错误使用它所带来的痛苦。我用它工作了 6 年。

            回答 #3

赞同：0

时间：2009-02-19T12:12:36.807

我找到的唯一可能的答案是将逻辑移至 ASR 调用的其他类。这样你就可以对类进行单元测试。ASR 变得更加复杂，只能作为集成测试的一部分进行测试。

        flash - 从word文档（段）中填充flash中的文本元素

ID：545264

赞同：0

时间：2009-02-13T09:07:47.437

标签：flash, ms-word, macromedia

我需要将单独的 word 文档中的文本段转换为 flash 文本元素。

这可能吗？如果有怎么办？

            回答 #1

赞同：1

时间：2009-02-13T12:22:43.257

仅使用服务器端脚本。您需要一种服务器端机制来从 Word 文档中提取所需的部分，并使用来自您的 flash 应用程序的适当参数调用此脚本以获取这些部分。

            回答 #2

赞同：1

时间：2009-02-13T13:24:03.780

根据 Hanak 的回答：请参阅“让 Office 为您完成繁重的工作”部分

[http://www.joelonsoftware.com/items/2008/02/19.html](http://www.joelonsoftware.com/items/2008/02/19.html)

            回答 #3

赞同：0

时间：2009-02-13T09:36:37.603

我认为您最好的选择是将文本放入 xml 文档并将该文本从那里加载到闪存中。您将无法直接从 .doc 文件加载文本。至于将文本转换为 xml，我认为这必须是一项手动工作，或者，如果文本的结构有一些逻辑，您可以编写一个宏来为您提取文本。

        sql - MSSQL 服务代理激活“作为 SELF 执行”

ID：545269

赞同：1

时间：2009-02-13T09:10:08.803

标签：sql, service-broker

我有一个服务代理激活的存储过程，在管理工作室中执行时运行良好。但是，当它在队列上激活时，sql server 错误日志显示以下消息：

```
"The activated proc [dbo].[FileUploadAsyncWorker] running on queue
AsyncProcessing.dbo.FileUploadRequestQueue output the following:  'You do not have
permission to use the bulk load statement." 
```

我认为 FileUploadAsyncWorker 中的“违规”语句是：插入 FileContent (filename, content) select @filename, content from openrowset (bulk...

如何判断存储过程在哪个用户帐户下运行？

            回答 #1

赞同：0

时间：2009-02-13T10:58:03.833

让存储过程将用户名插入到表中：

```
CREATE TABLE mytemptable (username varchar(max))    
INSERT INTO [MyTempTable] SELECT user 
```

我的猜测是 SP 将作为 SQL Server 服务帐户运行。

您还可以使用 SQL Profiler 找出正在执行您的 sp 的帐户。

        c# - C#：匿名类型和属性名称

ID：545270

赞同：3

时间：2009-02-13T09:10:30.333

标签：c#, linq, anonymous-types

这之间有什么区别吗：

```
dataContext.People.Select(ø => new
{
     Name = ø.Name,
}); 
```

还有这个：

```
dataContext.People.Select(ø => new
{
     ø.Name,
}); 
```

?

            回答 #1

赞同：6

时间：2009-02-13T09:13:03.010

它们是相同的；如果未指定名称（并且右侧是简单的成员访问），则假定现有成员的名称。该名称仅用于：

*   将名称更改为*其他*名称（例如`Name = grp.Key`）
*   为非成员访问表达式命名（例如`Count = grp.Count()`）

            回答 #2

赞同：1

时间：2009-02-13T09:13:45.003

没有。第二个只是为您派生属性的名称，生成的实际代码是相同的。

            回答 #3

赞同：1

时间：2009-02-13T09:14:29.293

不，编译器会将匿名类型的属性命名为与赋值右侧相同的名称。

        authentication - RESTful 方式的许可证和会话

ID：545275

赞同：7

时间：2009-02-13T09:11:05.540

标签：authentication, rest, licensing, restful-authentication

            回答 #1

赞同：4

时间：2009-02-13T09:29:13.347

假设我正确解释了您的问题，让我尝试为您连接这些点。您发布的链接有一个有效的答案，每个请求都应该使用 HTTP 身份验证。如果您需要许可证的概念来为您的用户维护某种状态，您很可能会将其链接到用户。您有一个（经过验证的）用户名可供使用。您只需要为每个请求调用该控制器并保存其状态。你有你的会议。

任何关键信息都不应信任 Cookie 输入，但对于像安全令牌这样的额外验证非常有用。我认为在您的现场链接中添加一个随机安全令牌字段将是一种宁静的方法。当然，它应该随着“会话”到期。

            回答 #2

赞同：1

时间：2009-02-13T15:09:57.817

您可能需要考虑将许可证处理问题向下推到基础架构堆栈上一级。如果你愿意的话，有点像面向方面的编程（AOP）方法。您可以将其推送到 Web 服务器层，而不是在应用程序层处理它。  

在不了解您的基础架构的详细信息的情况下，很难给出具体的建议。以 *nix 平台为例，许可证处理逻辑可以作为 Apache HTTP 服务器的一个模块来实现。

这种方法促进了跨基础架构堆栈的关注点分离。它允许每一层都专注于它的意图。应用层根本不需要担心许可问题，允许它严格关注内容，从而保持 URL 的干净和“RESTful”。  

            回答 #3

赞同：1

时间：2009-02-15T09:55:32.023

如果您的许可是基于并发用户的，那么实现 HTTP 摘要是微不足道的，并且只允许您启用最大数量的并发登录。Digest 提供了传递过期数据的功能，因此您的会话可以超时。

身份验证状态由 http authetnication 持有，其他任何地方都没有，因为它是透明且无处不在的。

            回答 #4

赞同：0

时间：2010-09-08T18:27:12.710

也许一种更 RESTful 的许可方式是限制处理请求的速率，而不是限制并发会话的数量。跟踪过去一小时内的请求数量，如果超过客户支付的数量，则提供`503 Service Unavailable`响应，以及一些建议用户稍后再试的文本。

        naming-conventions - 您对 asp .net Web 表单中的命名控件有何看法？

ID：545281

赞同：0

时间：2009-02-13T09:12:33.027

标签：naming-conventions

我使用 FxCop 已经有一段时间了，它建议的几乎所有规则都是有意义的，但是在命名控件时它会产生不稳定。

我倾向于这样命名：

```
btnSavePerson
lblForename
txtPostcode
ddlEthnicity 
```

等等。

现在，我只对控件使用前缀，我发现识别它们有点痛苦。我在我的所有其他代码中都没有这个问题，所以对于代表一个人的类，我会有这样的事情：

```
public class Person
{
    private string forename;
    public string Forename
    {
        get;
        set;
    }
} 
```

有两种不同的命名约定对我来说似乎很愚蠢，FxCop 抱怨控件名称上的前缀，我不喜欢命名约定。

那么人们如何命名表单上的控件呢？

            回答 #1

赞同：2

时间：2009-02-13T09:22:32.783

我实际上以与您相同的方式命名控件。我发现它提供了一种更快的方法来从后面的代码中识别控件。如果您真的不想遵守此约定，包括某种前缀可能会有所帮助，尤其是在大型表单上。例如，如果您正在注册用户，获取他们的抄送信息和计费信息，则在计费信息输入前加上“Bill”将提供与“txt...”相同的结果。

对我来说，这是一个速度的事情。如果没有前缀，当我在同一页面上与 10 或 20 个其他人打交道时，我很容易忘记我所谓的输入框。当我忘记时，我必须切换回 VS 中没有乐趣的设计视图。

            回答 #2

赞同：2

时间：2009-06-11T03:20:47.497

我总是用匈牙利符号表示我的表单控件，并且对 FxCop 和 StyleCop 将要告诉我的内容深恶痛绝。

假设我有一个包含电子邮件、姓名和消息的联系表。我们为我们的开发使用 MVP 模式，所以我将实现一个具有三个属性的视图，电子邮件、名称和消息，所以我不能将它们用作控件名称。

我不喜欢命名控件`EmailTextBox`，因为我看不出这比做`txtEmail`. 毕竟，您仍然包括带有名称的类型，如果它在前面（和缩写）或在后面有什么区别？

我喜欢使用前缀 like`txt`的原因是我**所有**的文本框都在智能感知窗口中分组。如果我有十几个表单字段并且忘记了我命名的字段，那么只需键入`txt`并滚动列表就很容易了。比从智能感知的顶部开始或切换回设计界面要容易得多。

这就是说，我**永远不会，永远不会**将匈牙利符号用于除表单字段之外的任何内容。表单字段通常不会进入公共 API，所以我不关心它们。

            回答 #3

赞同：0

时间：2009-02-13T09:18:28.380

我不使用匈牙利语前缀，我不认为它们比变量名或公共属性更有价值，我当然不会在那里使用它们。

            回答 #4

赞同：0

时间：2009-02-13T09:20:28.310

通常我会使用一个标识名称，后跟控件类型。例如“ForenameTextbox”、“SubmitButton”。

            回答 #5

赞同：0

时间：2009-02-13T09:23:21.393

我遵循与您相同的方法（例如图像按钮的“imgBtnSaveFinal”），但我知道这场辩论可以永远持续下去，我觉得在决定我们是否感到舒服之后应该使用众多标准之一使用它，以及该符号将来对我们有多大用处，即如果该符号对任何人都没有意义，那么使用它也没有多大意义！

        php - 在 PHPUnit 中测试具有依赖关系的对象

ID：545282

赞同：9

时间：2009-02-13T09:12:43.573

标签：php, unit-testing, phpunit, qa

对于组成另一个对象作为其实现的一部分的对象，编写单元测试以便只测试主要对象的最佳方法是什么？简单的例子：

```
class myObj { 
    public function doSomethingWhichIsLogged()
    {
        // ...
        $logger = new logger('/tmp/log.txt');
        $logger->info('some message');
        // ...
    }
} 
```

我知道可以设计该对象，以便可以注入记录器对象依赖项并因此在单元测试中进行模拟，但情况并非总是如此 - 在更复杂的场景中，您确实需要组合其他对象或调用静态方法.

由于我们不想测试记录器对象，只测试 myObj，我们如何进行？我们是否使用测试脚本创建了一个存根的“双重”？就像是：

```
class logger
{
    public function __construct($filepath) {}
    public function info($message) {}
}

class TestMyObj extends PHPUnit_Framework_TestCase 
{
    // ...
} 
```

这对于小对象来说似乎是可行的，但对于 SUT 依赖于返回值的更复杂的 API 来说会很痛苦。另外，如果你想测试对依赖对象的调用，你可以使用模拟对象吗？有没有办法模拟由 SUT 实例化而不是传入的对象？

我已经阅读了关于模拟的手册页，但它似乎没有涵盖依赖组合而不是聚合的这种情况。你怎么做呢？

            回答 #1

赞同：6

时间：2009-02-13T12:01:52.887

遵循**troelskn**的建议，这里是您应该做什么的基本示例。

```
<?php

class MyObj
{
    /**
     * @var LoggerInterface
     */
    protected $_logger;

    public function doSomethingWhichIsLogged()
    {
        // ...
        $this->getLogger()->info('some message');
        // ...
    }

    public function setLogger(LoggerInterface $logger)
    {
        $this->_logger = $logger;
    }

    public function getLogger()
    {
        return $this->_logger;
    }
}

class MyObjText extends PHPUnit_Framework_TestCase
{
    /**
     * @var MyObj
     */
    protected $_myObj;

    public function setUp()
    {
        $this->_myObj = new MyObj;
    }

    public function testDoSomethingWhichIsLogged()
    {
        $mockedMethods = array('info');
        $mock = $this->getMock('LoggerInterface', $mockedMethods);
        $mock->expects($this->any())
             ->method('info')
             ->will($this->returnValue(null));

        $this->_myObj->setLogger($mock);

        // do your testing
    }
} 
```

有关模拟对象的更多信息可以[在手册](http://www.phpunit.de/manual/3.0/en/mock-objects.html)中找到。

            回答 #2

赞同：4

时间：2009-02-13T11:52:33.330

正如您似乎已经意识到的那样，具体类依赖关系使测试变得困难（或完全不可能）。您需要解耦这种依赖关系。一个不会破坏现有 API 的简单更改是默认为当前行为，但提供一个挂钩来覆盖它。有多种方法可以实现这一点。

有些语言有可以将模拟类注入代码的工具，但我不知道 PHP 有这样的东西。在大多数情况下，无论如何重构代码可能会更好。

            回答 #3

赞同：0

时间：2009-02-13T11:58:07.060

看起来我误解了这个问题，让我再试一次：

如果还不算太晚，您应该为记录器使用单例模式或工厂：

```
class LoggerStub extends Logger {
    public function info() {}
}
Logger::setInstance(new LoggerStub());
...
$logger = Logger::getInstance(); 
```

如果您无法更改代码，则可以使用重载[__call()的包罗万象的类](http://us.php.net/manual/en/language.oop5.overloading.php)

```
class GenericStub {
    public function __call($functionName, $arguments) {}
} 
```

            回答 #4

赞同：0

时间：2010-03-05T03:18:56.327

实际上，构建 PHPUnit 的人发布了一个相当新的 PHP 类重载扩展。它允许您在无法重构代码的情况下覆盖 new 运算符，不幸的是，在 Windows 上安装并不是那么简单。

网址是[http://github.com/johannes/php-test-helpers/blob/master/](http://github.com/johannes/php-test-helpers/blob/master/) 

        asp.net - ClientScriptmanager 在部分回发中调用时是否工作？

ID：545290

赞同：3

时间：2009-02-13T09:14:25.487

标签：asp.net, javascript, ajax

我想在 ASP.NET 操作成功后关闭浏览器窗口。下面的代码由位于 Ajax UpdatePanel 中的按钮触发。

```
Page.ClientScript.RegisterClientScriptBlock(typeof(LeaveApproval), "ShowSuccess", "<script language=javascript>window.opener=self; self.close();</script>"); 
```

但是，此代码似乎没有任何效果。窗口没有关闭。当我在浏览器的 URL 栏中输入 javascript 时，它工作正常，所以我猜这与使用 ClientScriptManager 和 Ajax 有关。

知道我做错了什么吗？

            回答 #1

赞同：4

时间：2009-02-13T10:40:53.703

Scott Klueppel 的[这个链接帮助我解决了这个问题......](http://www.gotjeep.net/Blogs/CommentView,guid,4be2f278-12e4-40d5-b154-0e8ecaf18fac.aspx)

而是用...

```
ScriptManager.RegisterStartupScript 
```

代替

```
Page.ClientScript.RegisterClientScriptBlock. 
```

        project-management - 您如何为您的项目创建变更日志？

ID：545293

赞同：2

时间：2009-02-13T09:14:49.807

标签：project-management, bugzilla, change-management

我使用 subversion 作为 RCS 和 Bugzilla 进行问题跟踪。我只是问自己如何为用户创建自动更改日志？

我已经尝试过“svn2cl”工具。但是它创建的更改日志对我来说是技术性的（例如，没有用户想知道开发人员 XY 昨天更改了 20 个文件以修复内存泄漏）。用户想要一个包含如下内容的更改日志：

版本 1.0 
- 新增功能 1

版本 1.1 
- 修复了错误 #4711 
- 添加了功能 2 
...

有人知道从我的 bugzilla 条目创建更改日志的工具、插件或脚本吗？或者有什么好的方法可以做到这一点？我知道 trac 支持创建更改日志，但我不太喜欢 trac。

**更新**
为这项工作写了我自己的小工具。您可以在[ChangelogGenerator](http://www.cfgnet.de/project_changeloggen.html)获得它。

            回答 #1

赞同：1

时间：2009-02-13T09:20:36.533

使用自定义工具记录每个项目、模块等的数据库更改。然后，这些更改可以使用用于 finalbuilder 的自定义插件导出到文件以进行自述文件生产，或导出到 Web 服务，该 Web 服务将它们导入到本地数据库中以供 Web 服务器使用，以便用户可以在线查看/搜索每个模块的变化。

            回答 #2

赞同：1

时间：2009-02-13T09:26:41.340

我认为您可以让 Bugzilla 为您生成它。使用高级错误搜索屏幕，筛选里程碑/版本、状态和解决方案。然后您可以将其导出为 CSV 格式并在 Excel 中处理

            回答 #3

赞同：1

时间：2009-02-13T09:29:50.113

有一个名为 Bugzilla Changelog 的 sourceforge 项目，它将此日志生成为 HTML 或 Wiki - 文本。

请参阅：[Bugzilla 变更日志项目](http://sourceforge.net/projects/bugzillachnglog/)

            回答 #4

赞同：0

时间：2009-02-13T09:20:01.370

Excel？:)

我假设您首先为每个版本创建一个要实现的功能列表、要进行的更改、要修复的错误等。必须在某个地方跟踪这些状态的状态，以便您知道什么是完整的，什么已推送到更高版本和等等，以及何时测试和发货。

您的跟踪文档中的这些信息几乎包含了您需要的一切。

        python - 使用 python 进行 Kerberos 身份验证

ID：545294

赞同：17

时间：2009-02-13T09:15:43.783

标签：python, security, kerberos

我需要在 python 中编写一个脚本来检查受 kerberos 保护的网页。有没有可能从 python 中做到这一点以及如何做到这一点？该脚本将部署在安装了 python 2.4.something 的 linux 环境中。

德托尼

            回答 #1

赞同：15

时间：2009-02-13T10:33:42.223

我认为`python-krbV`大多数 Linux 发行版也有一个`python-kerberos`包。例如，Debian 有一个相同的名称。这是关于[它的文档](http://packages.debian.org/testing/python/python-kerberos)

从链接中提取：

“这个 Python 包是 Kerberos (GSSAPI) 操作的高级包装器。目标是避免构建一个包装整个 Kerberos.framework 的模块，而是提供一组有限的函数来执行客户端所需的操作/server 基于[http://www.ietf.org/rfc/rfc4559.txt](http://www.ietf.org/rfc/rfc4559.txt)的 Kerberos 身份验证。"

        vba - “DoCmd.OutputTo acOutputQuery”正在删除查询

ID：545310

赞同：2

时间：2009-02-13T09:21:17.763

标签：vba, ms-access

我遇到了`DoCmd.OutputTo acOutputQuery`第二次运行时删除查询本身的问题。

这个错误是否有任何解决方法/补丁（至少对我来说似乎是一个错误）？

            回答 #1

赞同：1

时间：2009-02-13T09:27:04.817

我认为您描述的行为“......删除查询本身，第二次运行”当查询返回没有记录时发生。

            回答 #2

赞同：1

时间：2009-02-13T21:43:37.933

回复：你的评论。

您是否进行了文件复制，或者您是否在两个数据库之间复制了对象？如果是第二个，您可能想尝试对原始文件副本进行压缩和修复。

您甚至可能想在真正的原版上尝试一下。

            回答 #3

赞同：1

时间：2011-03-16T21:27:08.683

即使是 2007 年也有这个问题，它也发生在我身上，但非常随机。有时我可以在错误发生之前运行它很多次，有时它会立即发生，它是一个小型数据库，29条记录和一个很小的查询，所以它绝对是访问中的一个错误

            回答 #4

赞同：1

时间：2014-03-25T23:07:14.393

我知道距离最初的帖子已经有一段时间了，但我找到了一个我在这里没有看到的解决方案。我正在使用 Access 2010。似乎几乎每次执行`DoCmd.OutputTo acOutputQuery...`时，我保存的查询仍然出现在我的查询列表中，但是 SQL 被清除了，这随后也从网络中删除了我的输出文件。

我只是在调用之前重置了 SQL`DoCmd.OutputTo acOutputQuery...`

```
CurrentDb.QueryDefs("MyQuery").SQL = "SELECT..." 
```

然后打电话

```
DoCmd.OutputTo acOutputQuery, "MyQuery"... 
```

到现在为止还挺好。

            回答 #5

赞同：0

时间：2010-04-16T10:11:18.430

它也发生在我身上。我正在使用 Access 2003。

我发现的唯一解决方法是保留原始 mdb 的副本，这样我可以在它发生时恢复 mdb。

Access 2007 似乎没有这个问题。

            回答 #6

赞同：0

时间：2015-04-23T06:59:00.287

另一种解决方法是将原始查询更改为生成表查询，然后使用

```
DoCmd.OutputTo acOutputTable, TableName, ... 
```

这意味着你有一个额外的表，但你总是可以在代码中删除表或通过查询来清理。

        html - 为什么_不_使用 html 表格进行布局

ID：545315

赞同：10

时间：2009-02-13T09:24:54.043

标签：html, layout, html-table

这两天我一直在思考这个问题。我目前正在编写一个 Web 应用程序（实际上是在一个现有的、广泛的应用程序中添加一个屏幕）。我知道使用“表格”进行布局是一个很大的禁忌。但在这个应用程序中，所有页面都使用表格进行布局。我决定改用 div 来创建我的新页面。但我遇到了两个障碍。

1.  我需要做的很多布局工作已经在其他页面上完成了，如果我使用 div 代替，我不能重用其中的任何一个（CSS 和 JS 之类的东西）。这会导致更多的工作并推迟我的完成日期。

2.  布局中一些更复杂的部分使用 div 确实很难做到，而使用表格却很容易做到。也许这只是我是“老派”，因为我不是一个 web/html 类型的人（我过得很好）。

那么，为什么我**不能**使用表格？我不想争论，只是想看看除了“这是正确的做法”类型的东西之外是否还有任何令人信服的论点。我知道这是正确的做法。我想知道为什么？

            回答 #1

赞同：12

时间：2009-02-13T09:34:26.873

使用 div、span 等实现布局，为表格提供了更多的灵活性。考虑浮动、块内容的自动换行与水平滚动、指定元素应存在于页面上的位置等。在不使用表格时，通过 CSS 更容易操作内容。

使用表格时，您会被严格的结构所束缚。  

现在这并不意味着这绝对是*错误*的事情。根据您的信息，为了保持一致性，我可能会坚持应用程序的主题并使用表格来实现。根据当前流行的情况做出最佳选择，而不是遵循“规则”。

希望有帮助！伊恩

            回答 #2

赞同：7

时间：2009-02-13T09:27:30.400

进行 css 布局可以更轻松地在以后更改页面布局。表格还使您的 html 更难阅读和编辑。
[根据这个页面..](http://www.hotdesign.com/seybold/)

*   让您的重新设计更高效、更便宜

*   帮助您保持整个网站的视觉一致性

*   当您最小化标记并正确使用标题标签时，可以获得更好的搜索引擎结果。这降低了代码与内容的比率。

*   让所有查看者和用户代理更容易访问您的网站。

*   您的页面加载速度更快，文件大小会更小，因为不是每个页面都需要表格信息。

*   随着世界上越来越多的人转向使用 Web 标准，并为您提供竞争优势（即工作保障）。

            回答 #3

赞同：5

时间：2009-02-13T10:21:19.100

我要发表一个逆向观点，只是为了让你有一些弹药。我意识到这并不能回答您的问题（为什么*不*使用表格），但它确实解决了您将看到的其他回复。

*   [CSS 的未来从未到来](http://www.decloak.com/Dev/CSSTables/CSS_Tables_01.aspx)  （注：从 2005 年开始）
*   [其他人都使用表格](http://iamelgringo.blogspot.com/2009/02/tables-vs-css-css-trolls-begone.html)，并且[针对其他人列出的每个响应都有有效的论据](http://iamelgringo.blogspot.com/2009/02/reasoned-response-to-unreasonable.html)。
*   [通过使用“display:table”将 DIV 转换为 TABLE，](http://www.digital-web.com/articles/everything_you_know_about_CSS_Is_wrong/)您可能会找到一些中间立场。当然，[你不能这样做，因为 IE 直到 v8 才支持它](http://thinkvitamin.com/design/css/tables-the-next-evolution-in-css-layout/)。
*   我在某处读到了一个很好的观点：当人们将等高的并排列称为“[圣杯](http://www.google.com/search?q=css+holy+grail)”时，[布局引擎一定有问题](http://www.johndcook.com/blog/2008/08/14/the-holy-grail-of-css/)。
*   我的意思是，看看[一些人为了让它工作而经历的不可维护的扭曲](http://www.alistapart.com/articles/holygrail)：负边距、必须在五个不同规则中对应的像素数等。

所以[要实用](http://giveupandusetables.com/)。

也就是说，我的大部分设计都使用纯 CSS。几乎所有事情都*可以*在 CSS 中完成，就像使用表格一样容易（甚至更容易）。从假设 DIV 可以做到这一点开始，并且可能会退回到 1 个表格以实现棘手的多列布局。即使这样，[也可能有人已经为您的布局找到了解决方案，](http://matthewjamestaylor.com/blog/ultimate-multi-column-liquid-layouts-em-and-pixel-widths)因此请先搜索。

            回答 #4

赞同：4

时间：2009-02-13T09:36:18.210

由于可访问性的原因，它们也很糟糕，即屏幕阅读器无法正确读取它们，但这仅适用于您所代表的数据*不是*表格数据的情况。

话虽如此，由于截止日期等（现实世界），我不得不将它们用于表单布局，因为它更容易。

            回答 #5

赞同：4

时间：2009-02-13T09:38:58.487

**因为标签`<table>`暗示它应该包含*表格*数据。**

就像彼得说的那样，如果你确实创建了基于表格的布局，宇宙不会内爆，但从语义上讲，应该避免这种情况。

语义变得越来越重要，因为网页不再总是显示在桌面浏览器中。Web 标准正在以 HTML 描述文档的**语义结构**而不是标记的方式发展。`<table>`如前所述：对表格数据使用标签在语义上是正确的。

**有趣的相关阅读：**

*   [是否应该不惜一切代价避免在 HTML 中使用表格？](https://stackoverflow.com/questions/82391/should-tables-be-avoided-in-html-at-any-cost)
*   [http://en.wikipedia.org/wiki/Semantic_Web](http://en.wikipedia.org/wiki/Semantic_Web)

            回答 #6

赞同：3

时间：2009-02-13T09:43:56.413

首先，一旦你知道了必要的 CSS，你通常可以毫不费力地将表格布局转换为 div。

但更重要的是，表格不好的一些原因：

*   并非所有用户都会使用浏览器的渲染引擎看到页面。有些人会使用屏幕阅读器，它可能会假设当它遇到表格时，它实际上应该将内容作为表格数据读出。本质上，您应该将表格在浏览器中具有特定布局“外观”视为巧合。
*   在解析完表格及其所有子项之前，无法呈现表格。一个 div 可以独立于其子元素进行渲染，因此您可以避免页面内容在页面被解析时在页面上上下跳跃，并更快地显示内容。

喜欢桌子有充分且正当的理由，但是当你习惯了桌子时，也有一定的学习曲线，所以如果你时间紧迫，这可能不是进行转换的时候。

            回答 #7

赞同：2

时间：2009-02-13T09:33:19.013

如果你有你提到的那种限制，最后期限迫在眉睫，现有的大量代码库，然后使用表，宇宙不会内爆，但从长远来看，使用 css 和 welformed 标记将允许你创建一个更好、更清洁、更可维护的网站。

            回答 #8

赞同：2

时间：2009-02-13T09:38:20.327

如果您想支持文本到语音阅读器，那么表格非常难看（如果您有任何类型的可访问性要求，您几乎必须将表格用于表格，仅此而已）。  

这也有一个 SEO 方面。对于 SEO，最好将您的内容放在页面顶部而不是底部。（可悲的是，研究表明，将菜单放在首位实际上是一个可访问性的好主意，因此这两个必要条件发生了冲突。）

如果您在跨浏览器支持方面遇到问题，我建议您使用 Firefox 进行开发。它对 CSS 开发的支持比其他浏览器好得多，并且更符合标准（因此更可预测）。稍后，您可以修补低级浏览器。

而且，正如彼得所说，宇宙不会内爆。但从长远来看，使用 CSS 进行布局会更干净。用硬编码的布局重新设计某些东西可能会很痛苦。查看 CSS Zen Garden 了解您可以做什么的示例。当然，在未来，我们将拥有两全其美的 CSS 表格布局。

            回答 #9

赞同：1

时间：2009-02-13T09:31:11.047

表格也会影响搜索引擎的行为。使用 CSS 而不是表格实际上也是一种 SEO 技术。我听说的原因是搜索引擎在一定级别的标签后停止索引，使用表格的布局可能会变得非常嵌套。

            回答 #10

赞同：1

时间：2009-02-13T09:35:45.950

使用 CSS 进行布局，而不是 HTML 表格，可以在页面内容和该内容的布局之间提供一定程度的分离。

使用表格，您的 HTML 标记将您的内容和布局混合在 HTML 代码中。这意味着如果您想为相同的内容使用不同的布局，则需要大量编辑混合代码。

通过在 HTML 标记上使用 CSS 样式表，您可以将提供内容 (HTML) 的代码与提供布局 (CSS) 的代码分开。这使得完全更改网页的布局方面变得更加容易，而无需编辑内容代码。

最好的例子是[CSS Zen Garden](http://www.csszengarden.com/)网站。

尽管如此，在表格中而不是在 CSS 中做一些布局技术仍然容易得多，所以那里肯定有一个“平衡行为”。（例如，即使 Google 在其页面布局中也使用表格！）

            回答 #11

赞同：1

时间：2009-02-13T09:36:32.580

通过使用表格进行布局，您可以将内容与格式联系起来，这是大多数缺点的主要来源。它弄乱了源代码，使可以使用 CSS 轻松完成的站点范围的格式更新变得复杂，等等。使用表格进行布局也通常意味着在奇怪的地方切片图像只是为了将它们放入单元格中，哎呀。

            回答 #12

赞同：1

时间：2009-02-13T09:39:16.473

您可以使用表格，但 div 有更多优势。但这一切都是正确的。就像你说的，你的时间很宝贵，所以可能（在短时间内）桌子将是你的选择。但是，如果您设法使其 div-wise，您将拥有一个更可维护的页面，您也可以使用它来重构其他页面。

            回答 #13

赞同：1

时间：2009-02-13T09:53:15.753

[Jeffrey Zeldman](http://zeldman.com)就这个主题写了一本很棒的书：[Designing With Web Standards](http://www.zeldman.com/dwws/)。这本书应该是每个网页设计师的必读。

**以下是设计表不好**的一些原因 *   表格生成更多标记 -> 更多带宽使用

*   表格使搜索引擎更难为您的网页编制索引 -> 您的网站变得不那么“可搜索”了

*   表格使更改和调整网站的可见外观变得更加困难 -> 重新设计成本更高

*   ...但最重要的是：**使用表格进行设计会为您的标记添加表示逻辑**

这很糟糕，因为您想将演示文稿与内容分开！HTML 应该只定义你的内容是什么，而不是它的外观。

如果您获得这种级别的分离，您的网站将...

*   ...更容易被不同类型的浏览器和其他类型的用户代理访问。

*   ...使重新设计*更*容易

* * *

## 回答 #14

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T09:54:32.973

最好不要听 CSS 的狂热分子。这些纯粹主义者生活在某个想象的世界中，他们会为您提供一些抽象纯度、语义等方面的论据。你不希望你的团队中有这样的人。目前我只看到黄嘴学生带着“纯 CSS 设计”的想法到处乱跑。他们将向您展示非常原始的 CSS 设计网站的示例，当您询问他们如何使用它完成一些复杂的企业软件设计时，他们会忽略您。经验丰富的开发人员已经知道这种完美是不可能的。

你该怎么办？遵循 KISS 原则。如果 CSS 可以帮助您实现您的特定设计理念，那很好，问题就解决了。如果您需要求助于一些相对不复杂的黑客，它可能没问题。但是当涉及到一些包含数十条规则的巨大代码来制作一个基本的东西时，你可以很容易地用表格自然地实现它，放弃它。

创建一个其他人（以及几个月后的你自己）将无法理解和支持的极其复杂和复杂的棘手 CSS 设计毫无用处。

至于“轻松重新设计”，除非您只想更改颜色和字体，否则无论是使用表格还是不使用表格，您都不可避免地必须重新构建您的标记。在后一种情况下，您的大部分标记将毫无用处，除了实施 CSS 技巧之外，这对您的新重新设计想法毫无用处。

老实说，负责 HTML/CSS 进一步开发的人员没有做好他们的工作并不是你的错。您不应该浪费您和其他人的时间来尝试寻找多年前应该存在的解决方法。

HTML/CSS 是一个很好的例子，说明与拥有资源和承诺的单一公司相比，一些委员会的工作做得多么糟糕，阻碍了技术的发展。

* * *

## 回答 #15

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T16:53:50.623

“正确的做法”取决于您的情况。

是的，div 提供了更大的灵活性，但归根结底，你真的需要它吗？就代码行数而言，我发现一个简单的表格通常比等效的 div 设计要小很多。

组装起来更快，并且在几乎所有浏览器中都尽可能可靠地工作，这意味着您不必编写无数的技巧来使其始终如一地工作并且当新的显示引擎出现时它不会崩溃.

从技术上讲，使用表格进行显示是一种技巧，但它确实可以完成工作，易于理解和维护，并且在很大程度上是面向未来的，因此对于简单的布局，考虑到网站的其余部分已经使用表格进行布局，我会继续使用表格。    

此外，使用新的“display=table”属性将表格转换为“div”表格可以通过一些正则表达式轻松完成（如果您绞尽脑汁，您甚至可以通过一次传递来完成）。如果你知道你的正则表达式，你可以在几分钟内通过整个网站用 div 替换表格，所以灵活性的整个问题真的不是那么大：当（如果）你真的需要使用 div 和 CSS 定位时，只需运行一些正则表达式，你就设置好了。如果你需要比正则表达式更多的控制，你可以花几个小时来编写一个快速而肮脏的解析器，它将你的表完全按照你想要的方式转换为 div。

底线是，尽管有污名，但对于简单的布局，表格仍然可以完成工作，它们可以快速且可靠地完成，如果您不必与 CSS 纯粹主义者抗衡，您可以为自己节省大量工作。

* * *

## 回答 #16

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T09:32:51.200

CSS 布局通过样式表（数据与显示分离）更容易改变布局。

此外，浏览器通常无法在`</table>`标签被解析之前呈现表格。如果您使用包含大量内容的表格，这可能会成为问题。CSS 布局通常可以随时呈现。

# sql - 是否可以在 sql server 2005 中恢复 Sql Server 2008 备份

> ID：545316
> 
>         
> 
> 赞同：26
> 
>         
> 
> 时间：2009-02-13T09:26:27.597
> 
>         
> 
> 标签：sql, sql-server-2005, sql-server-2008

是否可以将 SQL Server 2008 数据库的备份恢复到 SQL Server 2005 实例上？

我需要处理数据库备份在 sql server 2008 中的示例应用程序。但我将无法安装 2008。那么是否可以在 2005 年恢复该备份？

* * *

## 回答 #1

> 赞同：35
> 
>             
> 
> 时间：2009-02-13T09:29:09.727

不可以。无法从较新版本的备份中恢复数据库。

> 如果你死心塌地，我认为你最好的选择是在 SQL 2008 的对象资源管理器中选择数据库，右键单击，选择 Tasks->Generate Scripts。在选项对话框中可以包含所有内容，包括 Script Data。
> 
>   
>   
> 
> 并确保选择“SQL 2005 脚本”。

[来源](http://social.msdn.microsoft.com/Forums/en-US/sqldatabaseengine/thread/32a67469-0636-4ded-923f-2e257f7e68e1/)

将对象导入目标服务器时，如果对象很大，您可能会发现无法通过 Management Studio 打开 SQL 文件（完全无用的“操作无法完成”错误，不少）。没关系，只需通过[`sqlcmd`](http://msdn.microsoft.com/en-GB/library/ms170572(v=sql.90).aspx).

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2013-06-24T09:10:31.783

所有答案都缺少一件重要的事情，那就是在 SSMS 中生成脚本并没有正确排序脚本这一事实。

必须以正确的依赖顺序对脚本进行排序，以便在父表等之后创建子表。

这对于小型数据库来说不是问题，因为它很容易手动重新排序脚本，但在处理具有 100 多个对象的数据库时，这可能是一个大问题。

我的经验是使用可以读取备份并以正确顺序生成脚本的第三方工具最方便。我正在使用[ApexSQL 的 ApexSQL Diff](http://www.apexsql.com/sql_tools_diff.aspx)和 Data Diff，但任何流行的供应商都不会出错。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2009-02-13T09:29:02.427

不，不是直接的。SQL Server 2008 数据库备份不向后兼容 SQL Server 2005。但是，使用 SQL Server 2008 Management Studio，您可以在 SQL Server 2005 模式下编写数据和架构脚本。本文详细[介绍](http://www.devx.com/dbzone/Article/40531)了该过程。

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2011-11-10T06:52:16.900

是的，有可能

在 SQL Server 2008 中使用导出。转到`All Programs`--> `Microsoft SQL Server 2008`-->  `Import and Export Data`

*   然后`SQL Server Import AND Export Wizard`将打开窗口。按`Next`

*   选择一个数据源（在您的情况下来自 SQL Server 2008）。选择一个目标（在您的情况下来自 SQL Server 2005）。

*   选择`Copy data from one or more tables or view`

*   选择源表和目标表

*   点击`Next`&`Finish` 

去完成。

* * *

## 回答 #5

> 赞同：4
> 
>             
> 
> 时间：2012-11-08T14:42:50.870

我有这个问题很长时间了。

您不能将 SQL2008 备份恢复到 SQL2005 实例上。

对我来说，诸如导入/导出向导或使用带有 for SQL2005 选项的生成脚本从 SQL2008 编写数据库脚本之类的解决方法将不起作用。因为简单地说，我的数据库在它们的视图和存储过程或 udf 中相互交叉引用。它们不完全属于我的责任，因此我无法将它们合并到 1 个数据库中。它们是一组 6 个 db，在它们的视图和存储过程中直接相互引用。当我将它们从一个 SQL2005 实例转移到另一个实例时，我通常会进行完整备份/恢复。

如果我要为它们编写脚本，即使使用 with dependencies 选项，我也会在重新创建时遇到错误，因为 db1 不会在 db3 中找到视图，因为碰巧我先执行了 create db1 脚本。如果我先尝试 db3，我会得到类似的异常。

编写脚本以便我不会出现此类依赖项异常的唯一方法是找出一个有效的序列并以这种方式部分编写脚本：例如：db1_tables 后跟 db2_tables 后跟 db2_views 后跟 db1_views、sp、udfs 等.

我有这样的顺序。当我需要创建一组这样的 6 个新数据库时，我会依次执行较小的部分脚本。

这解释了为什么带有依赖项和数据并设置为 SQL2005 版本脚本的生成脚本对我不起作用。

在我的情况下，导入/导出向导更好，因为它会复制表，然后您仍然必须编写所有视图、sp、udfs 等脚本。

我真正需要的是一个SQL2008备份文件的转换工具，将它们转换为SQL2005格式。然后我的问题就会消失。或者某种允许从 SQL2008 完整备份文件中恢复的工具，而不用问我太多问题。

如果有人知道这些工具并使用过它们，请告诉我。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2010-06-19T08:08:07.013

您可以使用[DBSave](http://www.sql-server-backup.de/en/)，它是一个很棒的免费软件工具，可以在不同的机器上备份和恢复 ms sql server。设置和使用非常简单。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2010-06-19T08:26:19.593

不，你不能，但是像 red Gate 的 SQL 比较/数据比较这样的工具可以直接读取备份文件并将信息传输到实时数据库，处理与 SS2005 不兼容的任何语法或设置

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2013-05-14T15:37:30.200

对导入/导出的东西没有运气（平面文件导出在导入时失败，声称字符集映射问题[即使始终使用相同的字符集]和/或截断问题[即使源和目标具有完全相同的结构]），并且有使用[Garry Shutler 建议](https://stackoverflow.com/a/545324/157247)的“生成脚本”选项没有运气（它生成了一个有语法错误的脚本），我**终于能够使用**[SQL Server`bcp`实用程序](http://msdn.microsoft.com/en-GB/library/ms162802.aspx)复制我想从 2008 年复制到 2005 年的大表。所以这是这种情况的另一种选择，尽管对于整个数据库来说，它将是逐表的，并且可能对视图等没有帮助。

我使用的步骤：

1.  在源服务器上，使用“Script Table As...CREATE”获取结构，在目标服务器上运行。

2.  在目标服务器上，`bcp`使用新创建的表创建格式文件：

    ```
    bcp database.owner.table 格式 nul -f table.fmt -n
    ```

    *（如果您不使用 Windows 身份验证，您可能需要`-U`和`-P`选项来指定用户名和密码。）*

3.  将该格式文件复制到源服务器（如有必要）。

4.  将数据导出到源服务器上的文件：

    ```
    bcp database.owner.table out table.dat -f table.fmt
    ```

    *（同样，可能使用`-U`and `-P`。）*

5.  将数据文件复制到目标服务器（如有必要）。

6.  导入目标服务器上的数据：

    ```
    bcp database.owner.table in table.dat -f table.fmt
    ```

    *（同样，可能使用`-U`and `-P`。）*

希望这对其他人有用。

# ajax - Ajax 和文件名 - 最佳实践

> ID：545318
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-13T09:26:57.703
> 
>         
> 
> 标签：ajax, filenames

我正在使用 jQuery 通过 $.get 方法调用 PHP 文件

```
function fetchDepartment(company_id)
{
    $.get("ajax/fetchDepartment.php?sec=departments&company_id="+company_id, function(data){
        $("#department_id").html(data);
    });
} 
```

我在想的是我可以进一步保护文件名吗？

目前我在 .php 文件中有一个全局访问检查，检查用户是否登录，他是否可以访问这些数据等。

但是我想知道是否可以采取进一步的步骤使用户看不到此文件名，或者您建议采取哪些其他步骤。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T16:03:10.077

**编码请求**

您可以通过对几乎所有 URL 进行编码，然后在服务器端解码请求详细信息，使临时不法分子有效地看不到请求详细信息。

请求详细信息将包括您希望执行的操作以及与该操作相关的参数。

所有请求都将发送到单个 URL，服务器端进程将在其中解码请求详细信息并根据需要执行相关操作。

> 示例
> 原始 URL：
> 
>   /ajax/delete.php?parameter1=foo¶meter2=bar
> 
>   
>   
> 
> 请求详情：
> 
>   action=delete¶meter1=foo¶meter2=bar
> 
>   
>   
> 
> 编码请求详情（使用 base64 编码）：
> 
>   YWN0aW9uPWRlbGV0ZSZwYXJhbWV0ZXIxPWZvbyZwYXJhbWV0ZXIyPWJhcg==
> 
>   
>   
> 
> 编码 URL：
> 
>   /ajax/?request=YWN0aW9uPWRlbGV0ZSZwYXJhbWV0ZXIxPWZvbyZwYXJhbWV0ZXIyPWJhcg==

我不相信在 JavaScript 中编码为 base64 的本机功能，但要找到合适的方法或编写自己的方法远非不可能。

使用混淆/缩小的客户端 JavaScript 来确定如何“手动”发出请求将非常棘手。

**隐藏实现细节**

您可以遵循许多实践来使您的应用程序不易受到 URL 滥用的攻击。

让我们从一个 URL 开始：ajax/fetchDepartment.php?sec=departments&company_id=99

无需透露您正在使用的服务器端技术 (PHP)，也无需通过查询字符串 (sec, company_id) 透露查询字符串值的实际*含义*。

**屏蔽服务器端技术**

假设您已`index.php`定义为默认值，以下 URL 是等效的：

*   `ajax/fetchDepartment.php?sec=departments&company_id=99`

*   `ajax/fetchDepartment/index.php?sec=departments&company_id=99`

*   `ajax/fetchDepartment/?sec=departments&company_id=99`

第三个 URL 不会显示您正在使用的服务器端技术。这限制了可能的攻击范围。它还使您可以更轻松地切换到不同的服务器端技术，而无需更改 URL。

**隐藏请求参数的含义**

*   `ajax/fetchDepartment/?sec=departments&company_id=99`

*   `ajax/99/departments/`

后一个 URL 仍然传达了足够的信息来执行请求，而不会透露信息的含义。

虽然有人仍然可以改变价值观，但他们不知道他们在改变什么。这将使攻击者更难评估和理解他们所做的任何 URL 更改的结果。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T09:41:44.173

几乎唯一可以隐藏用户某条信息的 URL 的方法是不通过 h​​ttp 加载它。也许您可以在调用页面或具有更通用 url 的另一个页面上加载一组数据。

# database - 您将如何从数据库中查询 1 和 0 字符的数组？

> ID：545320
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-13T09:27:22.787
> 
>         
> 
> 标签：database, arrays, bitvector

假设您有一长串 1 或 0 的字符，有点像位向量，但在数据库列上。您将如何查询以了解已设置/未设置哪些值？假设您需要知道 char 500 和 char 1500 是否为“真”。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-02-13T09:37:13.810

```
SELECT
  Id
FROM
  BitVectorTable
WHERE
  SUBSTRING(BitVector, 500, 1) = '1'
  AND SUBSTRING(BitVector, 1000, 1) = '1' 
```

但是，没有索引可以用于这种查询。当你有很多行时，这会很快变慢。

编辑：至少在 SQL Server 上，所有内置字符串函数都是[确定性](http://msdn.microsoft.com/en-us/library/ms178091.aspx)的。这意味着您可以研究根据 SUBSTRING() 结果为整个组合值创建计算列的可能性，[并在每个列上放置一个索引](http://msdn.microsoft.com/en-us/library/ms189292.aspx)。插入会变慢，表大小会增加，但搜索会非常快。

```
SELECT
  Id
FROM
  BitVectorTable
WHERE
  BitVector_0500 = '1'
  AND BitVector_1000 = '1' 
```

编辑 #2：[SQL Server 的限制](http://msdn.microsoft.com/en-us/library/ms143432.aspx)是：

*   每个普通表 1,024 列

*   30.000 columns per "wide" table

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T09:35:44.967

在 MySQL 中，使用[子字符串](http://dev.mysql.com/doc/refman/5.1/en/string-functions.html#function_substring)的东西

```
select foo from bar 
where substring(col, 500,1)='1' and substring(col, 1500,1)='1'; 
```

不过，这将非常低效，您可能需要重新考虑您的架构。例如，您可以单独存储每个位以权衡空间以换取速度......

```
create table foo
(
   id int not null,
   bar varchar(128),
   primary key(id)
);

create table foobit
(
   int foo_id int not null,
   int idx int not null,
   value tinyint not null,

   primary key(foo_id,idx),
   index(idx,value)
); 
```

哪个会被查询

```
 select foo.bar from foo
   inner join foobit as bit500
      on(foo.id=bit500.foo_id and bit500.idx=500)
   inner join foobit as bit1500
      on(foo.id=bit1500.foo_id and bit1500.idx=1500)
   where
      bit500.value=1 and bit1500.value=1; 
```

显然会消耗更多存储空间，但对于那些查询操作来说应该更快，因为将使用索引。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T09:36:27.073

我会将列转换为多个位列并重写相关代码 - 位掩码比字符串比较快得多。但是如果你不能这样做，你必须使用 db-specific 函数。正则表达式可能是一种选择

```
-- Flavor: MySql
SELECT * FROM table WHERE column REGEXP "^.{499}1.{999}1" 
```

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T09:40:55.190

```
select substring(your_col, 500,1) as char500,
substring(your_col, 1500,1) as char1500 from your_table; 
```

# sql - 如何在 SQL Server 全文搜索中禁用词干？

> ID：545322
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-13T09:28:24.487
> 
>         
> 
> 标签：sql, sql-server, full-text-search

我需要在没有词干的情况下进行全文搜索...我尝试将我正在搜索的术语用双引号括起来，但没有任何乐趣...当我搜索“bolognalo”时，我仍然得到类似“bologna”的结果"'

任何帮助表示赞赏..

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-15T00:49:28.697

从使用切换[`FREETEXT`](http://msdn.microsoft.com/en-us/library/ms176078.aspx)到[`CONTAINS`](http://msdn.microsoft.com/en-us/library/ms187787.aspx).

我假设您当前正在使用`FREETEXT`词干，因为词干自动应用于`FREETEXT`查询，而`CONTAINS`默认情况下不使用词干。

* * *

第二个较低的选项是在`FREETEXT`查询中指定语言中立性：

```
SELECT *
FROM my_table
WHERE FREETEXT(my_column, 'my search', LANGUAGE 0x0) 
```

如果您使用它，那么也不会应用其他特定于语言的规则（例如，断词、停用词等）。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-18T18:16:47.173

经过太多天的尝试，我终于可以做到这一点：我重新创建目录，将语言设置为 0（中性）

```
CREATE FULLTEXT INDEX ON table_name
(DescriptionField LANGUAGE 0)
KEY INDEX idx_DescriptionField
ON catalog_name 
```

在每个包含包含的查询中，我将语言设置为 0

```
select * from table_name where contains(DescriptionField,'bolognolo',LANGUAGE 0) 
```

在我因为没有做第一步而无法做到这一点之前

非常感谢！

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T09:31:33.700

也许将全文索引的语言设置为中性就可以了...

（虽然，那么你永远不会得到词干......）

# f# - 为实时采集和“控制”设计系统架构

> ID：545326
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-02-13T09:29:23.923
> 
>         
> 
> 标签：f#, real-time, fpga, architecture

**要求的简要说明**

*（这里有很多好的答案，谢谢大家，如果我能飞，我会更新）。*

探测器沿着轨道运行，实时测量几个不同的物理参数（确定性），作为曲线距离的函数。在此过程中，用户可以单击一个按钮来“标记”航点，然后使用 GUI 输入每个航点的详细信息（以人工方式，但在数据采集继续时）。

在此之后，系统对获取的数据执行一系列计算/过滤/修改，同时考虑到为每个航路点输入的约束条件。该过程的输出是一系列校正，也是曲线距离的函数。

该过程的第三部分涉及再次沿着轨道运行，但这次将校正写入校正轨道的物理系统（仍然是曲线距离的函数）。

**我目前对您的输入/评论/警告的想法**

我想确定的是我是否可以用 PC + FPGA 做到这一点。FPGA 会进行“数据采集”，我会在 PC 上使用 C# 从缓冲区读取数据。航路点信息可以通过 WPF/Winforms 应用程序输入，并存储在数据库/平面文件/任何待处理的“处理”中。

对于处理，我会使用 F#。

FPGA 将用于将信息“写入”回物理机器。

我目前可以预见的一个问题是，处理算法是否需要一个采样频率，这会使要缓冲的数据量太大。这意味着将一些处理卸载到 FPGA - 至少是不需要用户输入的位。不幸的是，唯一的预处理算法是卡尔曼滤波器，根据我的谷歌搜索，很难用 FPGA 实现。

如果您愿意提供任何反馈，我将不胜感激。

**更新（此处添加的额外信息）**

在卡尔曼滤波器的入口处，我们每 1 毫秒查看一次。但在卡尔曼滤波器的另一边，我们将每 1m 采样一次，在我们所说的速度下，采样速度约为每秒 2 次。

所以我想更精确的问题是：

1.  在 FPGA 上实现[卡尔曼滤波器-](http://en.wikipedia.org/wiki/Kalman_filter)[似乎](http://www.xilinx.com/publications/magazines/dsp_01/xc_pdf/p37-39_dsp-accelchip.pdf) [有](http://portal.acm.org/citation.cfm?id=1369784) [可能](http://www.ingentaconnect.com/content/els/01419331/1997/00000021/00000004/art00040)，但我对这两个主题的了解还不够，无法弄清楚它是如何可能的。

2.  我也不确定卡尔曼的 FPGA 实现是否能够每 1ms 循环一次——尽管我想应该没问题。

3.  如果我理解正确的话，FPGA 没有大量的内存。对于该过程的第三部分，我将发送一个（大约）4 x 400 的双精度数组以用作查找表，这可行吗？

4.  此外，两个进程之间的交换（读/写数据）是否意味着每次都重新编程 FPGA，或者是否可以指示在两者之间切换？（也许只是可以并行运行并忽略其中一个）。

5.  我见过的[另一个](http://www.avalda.com/index.php/blogs/15-fsharp-to-fpga-tutorial-on-euclids-greatest-common-divisor-algorithm-part-i.html)[选择是使用](http://www.avalda.com/index.php/blogs/16-fsharp-to-fpga-tutorial-on-euclids-greatest-common-divisor-algorithm-part-ii.html)[Avalda FPGA Developer](http://www.avalda.com/)将 F# 编译为 VHDL ，我想我很快就会尝试。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-23T03:01:55.633

你没有提到你的目标、客户、预算、可靠性或最后期限，所以这很难回答，但是......

忘记 FPGA。简化您的设计、开发环境和接口，除非您知道您将使用另一个解决方案来满足您的实时要求。

如果你有预算，我会先看看 LabView。  

[http://www.ni.com/labview/](http://www.ni.com/labview/)

[http://www.ni.com/dataacquisition/](http://www.ni.com/dataacquisition/)

LabView 将在一台 PC 上为您提供数据采集系统和用户 GUI。根据我的经验，开发人员不会选择 LabView，因为它感觉不像是一个“真正的”编程环境，但对于您描述的问题，我绝对会推荐它。

如果您决定使用编译语言，那么我会将实时数据采集组件隔离到具有 RTOS 的嵌入式目标，最好是利用 MMU 进行调度和线程隔离并让您用 C 编写的。如果你得到一个真正的 RTOS，你应该能够真正地安排需要运行的进程，并且如果需要也能够调试它们！使用定义的接口使这个脱靶系统尽可能简单。让它足以获得您需要的数据。  

然后，我将使用通用接口文件将接口实现回 PC GUI 以进行维护。使用标准接口将数据传输到 PC，例如 USB2 或以太网。FTDI 芯片非常适合这些东西。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T19:21:17.947

由于您正在沿着轨道移动，因此我必须假设采样频率不超过 10 kHz。您可以轻松地将数据以该速率卸载到 PC，甚至是 12 Mb USB（全速）。

对于数学数据的严肃处理，Matlab 是要走的路。但由于我没有听说过 F#，我无法发表评论。

4 x 400 双打没有问题。即使是低端 FPGA 也有 100 KB 的内存。

您无需更改图像即可在读取和写入之间切换。这一直在 FPGA 中完成。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-23T05:20:16.627

这是一个建议。

转储 FPGA 概念。从 TI 获取 DSP 评估板 选择具有足够 gigaflops 的 DSP 评估板，让您满意。足够的 RAM 来存储您的工作集。

用 C 语言对其进行编程。TI 提供了一个小型 RT 内核。

它通过串行端口或以太网等方式与 PC 通信。

它通过握手发送 PC 熟数据，因此数据不会丢失。DPS 中有足够的内存来存储您的数据，而 PC 有高级时刻。

DSP没有性能问题。

实时位做实时，与 ram 的 MP。处理速度很快，GUI 对时间要求不高。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-17T12:56:06.547

你与PC的连接是什么？如果.Net 是基于网络的连接，它将非常适合，因为您可以使用流来处理数据输入。

关于 F# 或任何涉及大型数据集的函数式编程语言，我对您的唯一警告是内存使用。它们很棒并且在数学上可以证明，但是当您从多次递归中获得堆栈溢出异常时，这意味着您的程序将无法运行并且您会浪费时间和精力。

如果您需要开发 GUI，C# 将非常棒，winforms 和 GDI+ 应该让您无需付出巨大努力即可获得可用的东西。

给我们一些关于数据速率和连接的更多信息，也许我们可以提供更多帮助？

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-02-21T13:21:23.383

Microsoft Robotics Studio 中可能有一些有用的东西：[链接文本](http://msdn.microsoft.com/en-us/robotics/default.aspx)，尤其是实时方面。CCR - 并发协调运行时已经有很多这样的想法，模拟工具可能会帮助您构建一个有助于您分析的模型。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-02-22T14:48:50.340

在我看来，您可以离线进行所有处理。如果是这种情况，那么离线是要走的路。换句话说，将过程分为 3 个步骤：

1.  数据采集

2.  数据分析

3.  基于数据分析的物理系统修正。

数据采集

如果您无法使用标准界面收集数据，那么您可能必须使用自定义界面。很难说您是否应该在不了解更多接口的情况下使用 FPGA。构建自定义界面的成本很高，因此您应该进行权衡研究以选择方法。无论如何，如果这是基于 FPGA 的，那么保持 FPGA 简单并将其用于原始数据采集。使用当前的硬盘驱动器技术，您可以轻松存储 100 GB 的数据以进行后期处理，因此将原始数据存储在磁盘驱动器上。如果您不需要的话，您甚至不想在 FPGA 中实现一维卡尔曼滤波器。

数据分析

一旦您将数据保存在硬盘上，您就有很多数据分析选项。如果您已经了解 F#，请使用 F#。Python 和 Matlab 都有很多可用的数据分析库。

与必须实时进行所有处理的解决方案相比，这种方法还使测试数据分析软件变得更加容易。如果结果看起来不正确，您可以轻松地重新运行分析，而无需再次收集数据。

物理系统校正

获取数据分析的结果并沿着轨道运行检测器，再次通过接口卡为其提供适当的输入。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-02-23T02:00:27.167

我做过很多嵌入式工程，包括你描述的那种混合系统。以您需要处理的数据速率和大小，我怀疑您是否需要 FPGA……只需找到现成的数据采集系统即可插入您的 PC。

我认为您将遇到的最大问题与硬件 API 的语言绑定更相关。过去，我不得不用 C 和汇编（甚至一些 Forth）开发很多软件，因为这是从硬件获取数据的最简单方法。

# c# - 将 DataTable 转换为通用列表？

> ID：545328
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-02-13T09:30:19.490
> 
>         
> 
> 标签：c#, .net, generics, datatable

```
 public static IList<T> ConvertTo<T>(DataTable table)
    {
        if (table == null)
        {
            return null;
        }

        List<DataRow> rows = new List<DataRow>();

        foreach (DataRow row in table.Rows)
        {
            rows.Add(row);
        }

        return ConvertTo<T>(rows);
    }

    public static T ConvertItem<T>(DataTable table)
    {
        T obj = default(T);
        if (table != null && table.Rows.Count > 0)
        {
            obj = CreateItem<T>(table.Rows[0]);
        }
        return obj;
    }

    public static T CreateItem<T>(DataRow row)
    {
        T obj = default(T);
        if (row != null)
        {
            obj = Activator.CreateInstance<T>();
            Type entityType = typeof(T);
            PropertyInfo[] properties = entityType.GetProperties();

            for (int i = 0; i < properties.Length; i++)
            {
                object[] customAttributes = properties[i].GetCustomAttributes(typeof(ColumnAttributes), false);
                ColumnAttributes dataField = null;
                if (null != customAttributes && customAttributes.Length > 0 && null != (dataField = customAttributes[0] as ColumnAttributes))
                {
                    if (row.Table.Columns.Contains(dataField.FieldName) && !row[dataField.FieldName].GetType().FullName.Equals("System.DBNull"))
                    {
                        properties[i].SetValue(obj, row[dataField.FieldName], null);
                    }
                }
            }
        }
        return obj;
    } 
```

那就是我们现在唯一能想到的就是我们必须做一些我们需要收集自己的垃圾的事情？

想法？

为什么我们认为可能存在泄漏？：

我们遇到内存不足错误。如果一个页面不需要业务逻辑来使用这种类型的转换，那么 II6 流程就不会增长，但是当我们点击一​​个使用它的页面时，它就会增长。

我们目前正在获取 ANTS Profiler 以提供更多详细信息。

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-02-13T10:07:02.397

这不会是真正的*泄漏*，但它可能会不必要地强调事情......

您正在处理多少行？请注意，反射是一种痛苦，并且每次调用类似的东西`GetCustomAttributes`都可以返回一个新数组（所以你想这样做一次，而不是每个属性每行一次）。

就个人而言，我会预先构建我打算做的工作......如下所示。

请注意，如果我做了很多，我会切换到[HyperDescriptor](http://www.codeproject.com/KB/cs/HyperPropertyDescriptor.aspx)，或者如果.NET 3.5 是一个选项，也许是编译的表达式。由于`DataTable`不是强类型，`HyperDescriptor`因此在以下之后将是合乎逻辑的下一步（对于性能）......

```
sealed class Tuple<T1, T2>
{
    public Tuple() {}
    public Tuple(T1 value1, T2 value2) {Value1 = value1; Value2 = value2;}
    public T1 Value1 {get;set;}
    public T2 Value2 {get;set;}
}
public static List<T> Convert<T>(DataTable table)
    where T : class, new()
{
    List<Tuple<DataColumn, PropertyInfo>> map =
        new List<Tuple<DataColumn,PropertyInfo>>();

    foreach(PropertyInfo pi in typeof(T).GetProperties())
    {
        ColumnAttribute col = (ColumnAttribute)
            Attribute.GetCustomAttribute(pi, typeof(ColumnAttribute));
        if(col == null) continue;
        if(table.Columns.Contains(col.FieldName))
        {
            map.Add(new Tuple<DataColumn,PropertyInfo>(
                table.Columns[col.FieldName], pi));
        }
    }

    List<T> list = new List<T>(table.Rows.Count);
    foreach(DataRow row in table.Rows)
    {
        if(row == null)
        {
            list.Add(null);
            continue;
        }
        T item = new T();
        foreach(Tuple<DataColumn,PropertyInfo> pair in map) {
            object value = row[pair.Value1];
            if(value is DBNull) value = null;
            pair.Value2.SetValue(item, value, null);
        }
        list.Add(item);
    }
    return list;        
} 
```

# c++ - 为什么 StackWalk64 总是返回 true？

> ID：545329
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-13T09:30:38.287
> 
>         
> 
> 标签：c++, winapi, crash, stack-trace

我试图让我的程序转储并在崩溃时保存它的堆栈跟踪。我安装了我自己的 win32 SE 处理程序`_set_se_translator`并尝试转储堆栈跟踪，`StackWalk64`最后抛出一个 C++ 异常（它实际上在捕获时进行日志记录）。

代码如下所示：

```
...
_set_se_handlers(WIN32EXCEPTION::Win32ExceptionStuff);
...

void WIN32EXCEPTION::Win32ExceptionStuff(unsigned int Code, struct _EXCEPTION_POINTERS* Info) // static
{
    STACKFRAME64 sf64;
    sf64.AddrPC.Offset     = Info->ContextRecord->Eip;
    sf64.AddrStack.Offset  = Info->ContextRecord->Esp;
    sf64.AddrFrame.Offset  = Info->ContextRecord->Ebp;
    sf64.AddrPC.Mode= sf64.AddrStack.Mode= sf64.AddrFrame.Mode= AddrModeFlat;
    while (StackWalk64(IMAGE_FILE_MACHINE_I386,GetCurrentProcess(),GetCurrentThread(),
        &sf64,Info->ContextRecord,0,SymFunctionTableAccess64,SymGetModuleBase64,0))
    {
        //... Do something with the stack frames
    }
    throw WIN32EXCEPTION(/*...*/);
} 
```

正如我在一些示例中看到的，但存在一个问题：StackWalk64 总是返回 true，并且该`while`循环变得无限。StackWalk64 只重复同一帧。

问题是什么，如何解决？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T11:24:33.817

这看起来与我拥有的代码非常相似，并且确实有效。我能看到的唯一区别是我的代码使用 ZeroMemory() 在填充 STACKFRAME64 结构的任何部分之前清除它 - 这可能是必需的。

# cloud - 我应该在我的 SitkaSoapServiceClient 上使用“使用”吗？

> ID：545333
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-13T09:32:28.453
> 
>         
> 
> 标签：cloud, ssds, sql-data-services, sql-server-data-services

（这与 Microsoft 的 SitkaSoapService 有关，在[https://database.windows.net/soap/v1/](https://database.windows.net/soap/v1/)的服务参考中）

我正在使用 SitkaSoapServiceClient 通过 SOAP 访问我的 SQL 数据服务数据库。

每次使用这个代理类时是否应该使用“使用”语句？还是它在内部以安全的方式进行自己的连接处理？

即我需要说：

```
using (SitkaSoapServiceClient proxy = GetProxy())
    proxy.Update(scope, entity); 
```

...或者可以肯定地说：

```
GetProxy().Update(scope, entity); 
```

[GetProxy() 返回一个 SitkaSoapServiceClient 对象。]

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T09:36:02.173

代理类代码在包装在 using 语句中时是否编译？如果是这样，它会实现`IDisposable`并且我会使用它。

编辑：如果 Dispose() 什么都不做，调用 Dispose() 应该会产生很少的开销，并且如果类的设计者在以后决定分配非托管资源，您将受到保护，不会泄漏。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T09:53:57.950

您应该始终`using`在类实现 IDisposable 时使用，因为该类的作者告诉您它包含一些应该被释放的资源。

# e-commerce - 我应该使用什么电子商务平台来建立一个新网站？

> ID：545358
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-13T09:39:38.187
> 
>         
> 
> 标签：e-commerce

我有一份建立电子商务网站的合同。从头开始构建它（重新构建轮子）没有多大意义。

有很多开源平台，例如 osCommerce 或 Magnetocommerce。还有一些商业平台（如果值得id我不介意小额支出）

有没有人有在这样的电子商务平台上构建的经验？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T10:08:56.043

我用过 osCommerce，没问题。但是 CreLoaded 要好得多。CreLoaded 基于 osCommerce，但预装了所有最好的插件。

osCommerce 和 CreLoaded 作为顶级产品真正脱颖而出的原因有两点：

*   模板

*   可选加载项。

**模板CreLoaded 在**[template monster](http://www.templatemonster.com/creloaded-templates.php)
有 256 个模板。考虑到图形的质量和数量，仅花费 140 美元，这很便宜。

**可选加载项。**
加载项很难实现，因为您必须手动修补代码。但是，可取之处在于存在[CreLoaded](http://www.creloaded.com/)。这是 oscommerce 预装了所有最好的插件。

**Erol我还为我的**[空白媒体商店](http://www.hicrest.net/media/)
购买了[Erol](http://www.erol.co.uk/) v4 。该网站看起来不错，但它只是可怕的。用 Microsoft Access 编写。完全垃圾。顺便说一句，我已经关闭了商店，所以请不要购买任何东西！

我看了很多商务包！在我自己看来，CreLoaded 是最适合的。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2016-12-10T19:03:02.543

我会去 Wordpress 上的 WooCommerce。您可以通过许多免费功能获得强大的支持。Woocommerce 还准备了许多 wordpress 主题，因此您可以选择多种主题和插件

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T12:18:05.060

您可能对[什么是最好的免费和开源 PHP 电子商务解决方案的答案感兴趣？（为什么？）](https://stackoverflow.com/questions/143656/whats-the-best-free-and-opensource-php-ecommerce-solution-and-why "什么是最好的免费和开源 PHP 电子商务解决方案？ （为什么？）")，至少它为一个平台提供了答案。

# sql - 连接到另一台服务器的 TSQL 命令 (SQL Server 2005)

> ID：545364
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-02-13T09:42:26.510
> 
>         
> 
> 标签：sql, sql-server, tsql

是否有连接到另一台服务器的 TSQL 命令？

或者当您在查询窗口中时，连接到另一台服务器并显示查询窗口的键盘快捷键是什么？

我已经看到 Ctrl+N 在某些屏幕中弹出“**连接到服务器**”对话框，但是当我已经在查询窗口中并按 Ctrl+N 时，它只会打开另一个查询窗口。

USE 命令可以让你连接到当前服务器上的其他数据库，但是有没有一个命令可以让你连接到另一个服务器？

我正在使用 SQL Server 2005。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-02-13T09:53:36.703

您可以将[OpenDataSource](http://msdn.microsoft.com/en-us/library/ms179856.aspx)与链接服务器一起使用

```
OpenDataSource(provider_name, init_string) 
```

例如

```
SELECT
FirstName,
Gender
FROM
OpenDataSource (
'SQLOLEDB',
'DataSource = NOLI\SQL2;UserID=myUserID;Password=myPassword'
).Organisation.dbo.Employees 
```

来自[MSDN](http://msdn.microsoft.com/en-us/library/ms179856.aspx) -

> 与 OPENROWSET 函数一样，OPENDATASOURCE 应该只引用不经常访问的 OLE DB 数据源。为多次访问的任何数据源定义链接服务器。OPENDATASOURCE 和 OPENROWSET 都不提供链接服务器定义的所有功能，例如安全管理和查询目录信息的能力。每次调用 OPENDATASOURCE 时都必须提供所有连接信息，包括密码。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-02-13T10:45:07.017

通过菜单...

**查询 > 连接 > 更改连接**

或通过鼠标...

**（右键单击鼠标按钮）> 连接 > 更改连接**

两者都会弹出**连接到数据库引擎**对话框

如果您想在服务器之间编写一些 TSQL，那么您需要创建一个链接服务器，然后在您的 SQL 中使用 OPENQUERY 或 OPENROWSET。以前的帖子中有一些关于如何做到这一点的好建议。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2013-01-18T05:33:44.600

根据您想要执行的操作，另外两个可能可行的选项是 SQLCMD 模式和注册服务器。

可以在 SSMS 的查询菜单下启用 SQLCMD 模式。启用后，您可以使用它执行以下操作：

```
:CONNECT SERVER1
SELECT @@SERVERNAME;
GO

:CONNECT SERVER2
SELECT @@SERVERNAME;
GO 
```

使用已注册的服务器（应该在“查看”菜单下），您可以设置服务器组并同时针对这些组执行查询。

两者在许多 DBA 场景中都很有用，但我不确定这是否是您所追求的。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T09:46:58.060

您可以选择创建[链接服务器](http://msdn.microsoft.com/en-us/library/aa213778(SQL.80).aspx)并使用[OPENQUERY](http://msdn.microsoft.com/en-us/library/ms188427.aspx)或使用[OPENROWSET](http://msdn.microsoft.com/en-us/library/ms190312.aspx)。

如果您正在谈论将连接更改为查询窗口，只需在查询窗口中单击鼠标右键并选择更改连接。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T10:14:50.287

设置链接服务器后，您可以通过完全限定每个表/视图来对其运行 TSQL

从 [Server].[Database].[Owner].Table 中选择 *

通过这种方式，您可以从任何查询窗口与任何服务器对话——如果您需要的话。在大多数 Sql 中，您只提供表，因为其他所有内容都是默认的。使用这种技术，您甚至可以在服务器之间编写连接子句，只要分布式事务协调器 (MSDTC) 正在运行。当然，您只需这样做一次即可证明它有效，因为它运行得非常缓慢。

# wpf - WPF 将 DataTable 绑定到重复的用户控件

> ID：545366
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-13T09:43:34.013
> 
>         
> 
> 标签：wpf, data-binding, user-controls

我正在自学 WPF，我遇到了一个小问题，我找不到答案。

我的测试应用程序允许将图像文件放入 StackPanel。一旦图像被删除，一个新的用户控件被添加到堆栈中，并显示一些关于文件的元数据。一切正常，我可以遍历子控件来检索值。

我希望能够做的是允许用户将此数据保存到文件中，以便他们可以暂停处理数据。我这样做的明显方法是将数据存储在 DataTable 中并将其序列化/反序列化为 xml。但是，我不知道如何从 DataTable 或 DataSet 对象驱动用户控件的集合——事实上，我什至不知道这是否是在 WPF 应用程序中进行此操作的正确方法。我非常愿意在这里承认我的无知，并在有任何建议时提出更好的建议。

应用程序逻辑摘要。

1) 将文件（从 Win 资源管理器）拖放到 StackPanel 

2) 文件触发创建新用户控件，该控件将添加到 StackPanel 

3) 数据填充到用户控件中

4) 处理数据涉及遍历控件集合。  

我想要什么

1) 文件被（从 Win 资源管理器）拖放到 StackPanel 

2) 文件数据被插入到某个持久对象（数据表？）

3) 更新的数据表驱动用户控件的生成被添加到显示的集合中。

4) 保存/加载功能保留数据以供以后重复使用。  

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T10:05:21.060

第二种方法您走在正确的轨道上，您需要查看的是 ItemsControl - 这是可以添加项目的东西。它是 ListBox 等的基础，您可以[根据需要对其进行模板化](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.groupstyle.aspx)。然后是 DataTemplate，它处理在将项目添加到底层数据结构时显示哪些控件以及与这些控件的数据绑定。网上有很多例子，试试[Dr WPF](http://www.drwpf.com/blog/Home/tabid/36/EntryID/24/Default.aspx)。

为了使一切正常工作，底层数据结构必须支持更改通知。由于一切都是自动发生的，一旦设置了 Xaml，您就会发现自己处于一个奇怪的境地。您已将数据添加到数据结构中，这反过来又导致控件和数据出现在您的 ItemsControl 中。您如何链接数据项及其可视控件。答案是使用一些内置的静态方法[ItemFromContainer](http://blog.nostatic.org/2007/12/wpf-listview-getting-clicked-item.html)将图形链接到底层数据项，这对处理点击事件很有用，而[ContainerFromItem](https://stackoverflow.com/questions/165424/how-does-itemcontainergeneratorcontainerfromitem-work-with-a-grouped-list)则相反。

# javascript - JavaScript 拖放照片调整器裁剪器

> ID：545370
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-02-13T09:44:51.390
> 
>         
> 
> 标签：javascript, image, resize, photo, crop

我在页面上有任意大小的图像。作为输出，我需要一个固定大小的图像，比如*90x120px*。我希望用户通过拖放*90x120 像素*“窗口”后面的大图像来选择图像区域。该窗口将指定生成的图像。像这样的东西是在[facebook image upload](http://www.facebook.com/editpicture.php)中实现的。

一旦我得到裁剪坐标，我就知道如何在后端处理图像，这没问题。我想我需要在隐藏的表单字段中发布裁剪坐标。用户的拖放操作应该让 JavaScript 填充字段，对吗？我是 JS 新手，所以分步指南会很有帮助。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-02-13T10:38:06.440

对于裁剪，请使用[jQuery](http://jquery.com/)和[Jcrop](http://deepliquid.com/content/Jcrop.html)。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T10:19:18.857

1.  熟悉 jQuery。它将节省您在任何 js/dhtml 项目中的时间

2.  [http://interface.eyecon.ro/demos/drag.html ](http://interface.eyecon.ro/demos/drag.html) [http://interface.eyecon.ro/demos/resize.html ](http://interface.eyecon.ro/demos/resize.html) [http://interface.eyecon.ro/download](http://interface.eyecon.ro/download)

3.  ？？？

4.  利润

# asp.net - 在 JavaScript 中设置 RegularExpressionValidator ValidationExpression

> ID：545379
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-13T09:48:52.347
> 
>         
> 
> 标签：asp.net, validation, webforms

是否可以`ValidationExpression`使用`RegularExpressionValidator`JavaScript 设置？我正在使用 ASP.NET 3.5。

这就是我想这样做的原因......

在支付页面上，我有一个`DropDownList`允许我的用户选择他们的卡类型。在那下面是`TextBox`他们输入他们的卡号的地方。

我想使用 a`RegularExpressionValidator`来验证他们的卡号对于他们给定的卡类型是否有效。卡支付处理是在不同的系统中手动执行的，所以我不能依靠它来捕获不正确的卡详细信息。

因此我需要`ValidationExpression`为每种卡类型使用不同的。我想设置`ValidationExpression`使用 JavaScript，触发`DropDownList`onchange 事件。

My`DropDownList`绑定到一个 XML 文档：

```
<asp:DropDownList ID="ddlCardType" runat="server"
    DataTextField="Text" DataValueField="Value"
    DataSourceID="xdsCardTypes" AppendDataBoundItems="True">
    <asp:ListItem Text="(select)" Value=""></asp:ListItem>
</asp:DropDownList>
<asp:XmlDataSource ID="xdsCardTypes" runat="server"
    DataFile="~/App_Data/PaymentCards.xml">
</asp:XmlDataSource> 
```

这是 XML 文档：

```
<?xml version="1.0" encoding="utf-8" ?>
<PaymentCards>
  <PaymentCard Text="American Express" Value="AmericanExpress" RegEx="3[47](\d{13})"  />
  <PaymentCard Text="MasterCard" Value="MasterCard" RegEx="5[1-5](\d{14})" />
  <PaymentCard Text="Maestro" Value="Maestro" RegEx="(5018|5020|5038|6304|6759|6761)\d{8,15}" />
  <PaymentCard Text="Visa" Value="Visa" RegEx="4(\d{15}|\d{12})" />
</PaymentCards> 
```

在代码隐藏中，我正在创建一个 JavaScript 函数调用并将其添加到 onchange 事件中`DropDownList`：

```
XDocument paymentCards = XDocument.Parse(xdsCardTypes.GetXmlDocument().InnerXml, LoadOptions.None);

List<string> regExes = paymentCards.Descendants("PaymentCard")
    .Select(pc => pc.GetAttribute("RegEx").Value).ToList();

string setRegExValidatorScript = string.Format("setRegExValidator('{0}', '{1}', {2});",
    ddlCardType.ClientID,
    txtCardNumber_RegularExpressionValidator.ClientID,
    regExes.ToJavaScriptArgumentList());

ddlCardType.AddAttribute("onchange", setRegExValidatorScript); 
```

在引用的 .js 文件中，我有以下内容：

```
function setRegExValidator(ddlCardTypeID, regExValidatorID, regExes)
{
    var regEx = regExes[$get(ddlCardTypeID).selectedIndex];

    var val = $get(regExValidatorID);

    // TODO: Set the ValidationExpression!
} 
```

`ValidationExpression`所以我缺少的一个环节是从 JavaScript设置的能力。是的，我可以使用回发来实现这一点，但这似乎没有必要。

（也欢迎提出替代方法的建议！）

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T10:22:08.537

```
function setRegExValidator(ddlCardTypeID, regExValidatorID, regExes)
{
    var regEx = regExes[$get(ddlCardTypeID).selectedIndex];

    var val = $get(regExValidatorID);

    val['validationexpression'] = regEx;
} 
```

*注意：您还需要确保在服务器端正确验证卡号。*

# linux - Linux：计算给定文件夹和内容的单个哈希？

> ID：545387
> 
>         
> 
> 赞同：120
> 
>         
> 
> 时间：2009-02-13T09:51:40.780
> 
>         
> 
> 标签：linux, bash, hash

当然必须有一种方法可以轻松地做到这一点！

我已经尝试过 Linux 命令行应用程序，例如`sha1sum`and`md5sum`但它们似乎只能计算单个文件的哈希值并输出一个哈希值列表，每个文件一个。

我需要为文件夹的全部内容（不仅仅是文件名）生成一个哈希值。

我想做类似的事情

```
sha1sum /folder/of/stuff > singlehashvalue 
```

**编辑：**澄清一下，我的文件位于目录树中的多个级别，它们并不都位于同一个根文件夹中。

* * *

## 回答 #1

> 赞同：152
> 
>             
> 
> 时间：2009-02-13T09:59:36.643

一种可能的方法是：

```
sha1sum 路径/到/文件夹/* | sha1sum

```

如果有整个目录树，最好使用 find 和 xargs。一种可能的命令是

```
查找路径/到/文件夹 -type f -print0 | 排序-z | xargs -0 sha1sum | sha1sum

```

最后，如果您还需要考虑权限和空目录：

```
(find path/to/folder -type f -print0  | sort -z | xargs -0 sha1sum;
 find path/to/folder \( -type f -o -type d \) -print0 | sort -z | \
   xargs -0 stat -c '%n %a') \
| sha1sum 
```

的参数`stat`将导致它打印文件名，后跟八进制权限。这两个查找将一个接一个地运行，导致磁盘 IO 量翻倍，第一个查找所有文件名并对内容进行校验和，第二个查找所有文件和目录名称，打印名称和模式。然后将对“文件名和校验和”列表，然后是“具有权限的名称和目录”进行校验和，以获得较小的校验和。

* * *

## 回答 #2

> 赞同：35
> 
>             
> 
> 时间：2009-02-13T10:04:00.750

*   使用像[助手](http://sourceforge.net/projects/aide/)这样的文件系统入侵检测工具。

*   散列目录的 tar 球：

    `tar cvf - /path/to/folder | sha1sum`

*   自己编写代码，例如[vatine 的 oneliner](https://stackoverflow.com/a/545413)：

    `find /path/to/folder -type f -print0 | sort -z | xargs -0 sha1sum | sha1sum`

* * *

## 回答 #3

> 赞同：19
> 
>             
> 
> 时间：2016-12-08T00:09:08.677

如果您只想检查文件夹中的某些内容是否更改，我推荐这个：

```
ls -alR --full-time /folder/of/stuff | sha1sum 
```

它只会为您提供 ls 输出的哈希值，其中包含文件夹、子文件夹、它们的文件、它们的时间戳、大小和权限。几乎所有你需要确定的东西是否发生了变化。

请注意，此命令不会为每个文件生成哈希，但这就是为什么它应该比使用 find 更快。

* * *

## 回答 #4

> 赞同：15
> 
>             
> 
> 时间：2009-02-13T11:04:56.220

你可以做`tar -c /path/to/folder | sha1sum`

* * *

## 回答 #5

> 赞同：9
> 
>             
> 
> 时间：2020-11-10T18:19:22.003

到目前为止，最快的方法仍然是使用 tar。并且通过几个附加参数，我们还可以摆脱元数据造成的差异。

要使用 tar 对目录进行哈希处理，需要**确保**在 tar 期间对路径进行排序，否则它总是不同的。

```
tar -C <root-dir> -cf - --sort=name <dir> | sha256sum 
```

# 忽略时间

如果您不关心访问时间或修改时间，也可以使用类似`--mtime='UTC 2019-01-01'` 的方法来确保所有时间戳都相同。

# 忽略所有权

通常我们需要添加`--group=0 --owner=0 --numeric-owner`来统一所有者元数据。

# 忽略一些文件

采用`--exclude=PATTERN`

* * *

## 回答 #6

> 赞同：6
> 
>             
> 
> 时间：2018-01-07T11:39:45.363

# 稳健而干净的方法

*   首先，**不要占用可用内存**！以块的形式散列文件，而不是提供整个文件。

*   针对不同需求/目的的不同方法（以下所有方法或选择适用的方法）：

    *   仅对目录树中所有条目的条目名称进行哈希处理

    *   散列所有条目的文件内容（留下meta like、inode number、ctime、atime、mtime、size等，你懂的）

    *   对于符号链接，其内容是引用名称。散列或选择跳过

    *   在散列条目内容时遵循或不遵循（解析名称）符号链接

    *   如果它是一个目录，它的内容只是目录条目。在递归遍历时，它们最终会被散列，但是该级别的目录条目名称是否应该被散列以标记该目录？在需要散列以快速识别更改而无需深入遍历以散列内容的用例中很有帮助。一个例子是文件名更改，但其余内容保持不变，它们都是相当大的文件

    *   处理好大文件（再次注意内存）

    *   处理非常深的目录树（注意打开的文件描述符）

    *   处理非标准文件名

    *   如何处理套接字、管道/FIFO、块设备、字符设备的文件？还必须对它们进行哈希处理吗？

    *   遍历时不要更新任何条目的访问时间，因为这对于某些用例会产生副作用和适得其反（直觉？）。

这就是我的想法，任何花一些时间在这方面工作的人实际上都会发现其他陷阱和极端案例。

[这是一个工具](https://github.com/six-k/dtreetrawl)，非常节省内存，可以解决大多数情况，可能有点粗糙，但很有帮助。

### 的示例用法和输出`dtreetrawl`。

> ```
> Usage:
>   dtreetrawl [OPTION...] "/trawl/me" [path2,...]
> 
> Help Options:
>   -h, --help                Show help options
> 
> Application Options:
>   -t, --terse               Produce a terse output; parsable.
>   -j, --json                Output as JSON
>   -d, --delim=:             Character or string delimiter/separator for terse output(default ':')
>   -l, --max-level=N         Do not traverse tree beyond N level(s)
>   --hash                    Enable hashing(default is MD5).
>   -c, --checksum=md5        Valid hashing algorithms: md5, sha1, sha256, sha512.
>   -R, --only-root-hash      Output only the root hash. Blank line if --hash is not set
>   -N, --no-name-hash        Exclude path name while calculating the root checksum
>   -F, --no-content-hash     Do not hash the contents of the file
>   -s, --hash-symlink        Include symbolic links' referent name while calculating the root checksum
>   -e, --hash-dirent         Include hash of directory entries while calculating root checksum 
> ```

*一段人类友好的输出：*

> ```
> ...
> ... //clipped
> ...
> /home/lab/linux-4.14-rc8/CREDITS
>         Base name                    : CREDITS
>         Level                        : 1
>         Type                         : regular file
>         Referent name                :
>         File size                    : 98443 bytes
>         I-node number                : 290850
>         No. directory entries        : 0
>         Permission (octal)           : 0644
>         Link count                   : 1
>         Ownership                    : UID=0, GID=0
>         Preferred I/O block size     : 4096 bytes
>         Blocks allocated             : 200
>         Last status change           : Tue, 21 Nov 17 21:28:18 +0530
>         Last file access             : Thu, 28 Dec 17 00:53:27 +0530
>         Last file modification       : Tue, 21 Nov 17 21:28:18 +0530
>         Hash                         : 9f0312d130016d103aa5fc9d16a2437e
> 
> Stats for /home/lab/linux-4.14-rc8:
>         Elapsed time     : 1.305767 s
>         Start time       : Sun, 07 Jan 18 03:42:39 +0530
>         Root hash        : 434e93111ad6f9335bb4954bc8f4eca4
>         Hash type        : md5
>         Depth            : 8
>         Total,
>                 size           : 66850916 bytes
>                 entries        : 12484
>                 directories    : 763
>                 regular files  : 11715
>                 symlinks       : 6
>                 block devices  : 0
>                 char devices   : 0
>                 sockets        : 0
>                 FIFOs/pipes    : 0 
> ```

* * *

## 回答 #7

> 赞同：6
> 
>             
> 
> 时间：2019-07-07T00:01:30.090

如果这是一个 git repo 并且你想忽略 中的任何文件`.gitignore`，你可能想使用这个：

```
git ls-files <your_directory> | xargs sha256sum | cut -d" " -f1 | sha256sum | cut -d" " -f1 
```

这对我来说效果很好。

* * *

## 回答 #8

> 赞同：4
> 
>             
> 
> 时间：2009-02-13T09:54:41.677

如果您只想散列文件的内容，忽略文件名，那么您可以使用

```
cat $FILES | md5sum 
```

确保在计算哈希时文件的顺序相同：

```
cat $(echo $FILES | sort) | md5sum 
```

但是您的文件列表中不能有目录。

* * *

## 回答 #9

> 赞同：3
> 
>             
> 
> 时间：2015-07-29T13:35:42.157

实现此目的的另一个工具：

[http://md5deep.sourceforge.net/](http://md5deep.sourceforge.net/)

就像听起来一样：像 md5sum 但也是递归的，加上其他功能。

`md5deep -r {direcotory}`

* * *

## 回答 #10

> 赞同：2
> 
>             
> 
> 时间：2011-01-25T17:12:41.453

有一个python脚本：

[http://code.activestate.com/recipes/576973-getting-the-sha-1-or-md5-hash-of-a-directory/](http://code.activestate.com/recipes/576973-getting-the-sha-1-or-md5-hash-of-a-directory/)

如果您更改文件的名称而不更改其字母顺序，则哈希脚本将无法检测到它。但是，如果您更改文件的顺序或任何文件的内容，运行脚本将为您提供与以前不同的哈希值。

* * *

## 回答 #11

> 赞同：2
> 
>             
> 
> 时间：2018-01-28T15:17:03.560

我必须检查整个目录以进行文件更改。

但不包括时间戳、目录所有权。

如果文件相同，目标是在任何地方获得相同的总和。

包括托管到其他机器上，不管是文件还是对它们的更改。

```
md5sum * | md5sum | cut -d' ' -f1 
```

它按文件生成哈希列表，然后将这些哈希连接成一个。

这比 tar 方法快得多。

为了在我们的哈希中获得*更强的隐私*，我们可以在同一个配方上使用**sha512sum 。**

```
sha512sum * | sha512sum | cut -d' ' -f1 
```

**使用sha512sum**的任何地方的哈希值也是相同的，但没有已知的方法来反转它。

* * *

## 回答 #12

> 赞同：2
> 
>             
> 
> 时间：2021-03-04T15:51:10.203

[向kvantour 的答案](https://stackoverflow.com/q/545387/7771202)添加多处理和进度条

大约快 30 倍（取决于 CPU）

```
100%|██████████████████████████████████| 31378/31378 [03:03<00:00, 171.43file/s] 
```

```
# to hash without permissions
find . -type f -print0 | sort -z | xargs -P $(nproc --all) -0 sha1sum | tqdm --unit file --total $(find . -type f | wc -l) | sort | awk '{ print $1 }' | sha1sum 
```

```
# to hash permissions
(find . -type f -print0  | sort -z | xargs -P $(nproc --all) -0 sha1sum | sort | awk '{ print $1 }'; 
  find . \( -type f -o -type d \) -print0 | sort -z | xargs -P $(nproc --all) -0 stat -c '%n %a') | \
  sort | sha1sum | awk '{ print $1 }' 
```

确保已安装[tqdm](https://github.com/tqdm/tqdm)`pip install tqdm` ，或查看文档

`awk`将删除文件路径，这样如果父目录或路径不同，它就不会影响哈希

* * *

## 回答 #13

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T09:57:08.473

尝试分两步制作：

1.  为文件夹中的所有文件创建一个带有哈希的文件

2.  散列这个文件

像这样：

```
# for FILE in `find /folder/of/stuff -type f | sort`; do sha1sum $FILE >> hashes; done
# sha1sum hashes 
```

或者一次完成所有操作：

```
# cat `find /folder/of/stuff -type f | sort` | sha1sum 
```

* * *

## 回答 #14

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T09:58:39.313

我会将单个文件的结果通过管道传输`sort`（以防止仅仅重新排序文件以更改哈希）到`md5sum`or `sha1sum`，无论您选择哪个。

* * *

## 回答 #15

> 赞同：1
> 
>             
> 
> 时间：2016-03-28T20:53:26.963

为此，我编写了一个 Groovy 脚本：

```
import java.security.MessageDigest

public static String generateDigest(File file, String digest, int paddedLength){
    MessageDigest md = MessageDigest.getInstance(digest)
    md.reset()
    def files = []
    def directories = []

    if(file.isDirectory()){
        file.eachFileRecurse(){sf ->
            if(sf.isFile()){
                files.add(sf)
            }
            else{
                directories.add(file.toURI().relativize(sf.toURI()).toString())
            }
        }
    }
    else if(file.isFile()){
        files.add(file)
    }

    files.sort({a, b -> return a.getAbsolutePath() <=> b.getAbsolutePath()})
    directories.sort()

    files.each(){f ->
        println file.toURI().relativize(f.toURI()).toString()
        f.withInputStream(){is ->
            byte[] buffer = new byte[8192]
            int read = 0
            while((read = is.read(buffer)) > 0){
                md.update(buffer, 0, read)
            }
        }
    }

    directories.each(){d ->
        println d
        md.update(d.getBytes())
    }

    byte[] digestBytes = md.digest()
    BigInteger bigInt = new BigInteger(1, digestBytes)
    return bigInt.toString(16).padLeft(paddedLength, '0')
}

println "\n${generateDigest(new File(args[0]), 'SHA-256', 64)}" 
```

您可以自定义用法以避免打印每个文件、更改消息摘要、取出目录散列等。我已经根据 NIST 测试数据对其进行了测试，它按预期工作。  [http://www.nsrl.nist.gov/testdata/](http://www.nsrl.nist.gov/testdata/)

```
gary-macbook:Scripts garypaduana$ groovy dirHash.groovy /Users/garypaduana/.config
.DS_Store
configstore/bower-github.yml
configstore/insight-bower.json
configstore/update-notifier-bower.json
filezilla/filezilla.xml
filezilla/layout.xml
filezilla/lockfile
filezilla/queue.sqlite3
filezilla/recentservers.xml
filezilla/sitemanager.xml
gtk-2.0/gtkfilechooser.ini
a/
configstore/
filezilla/
gtk-2.0/
lftp/
menus/
menus/applications-merged/

79de5e583734ca40ff651a3d9a54d106b52e94f1f8c2cd7133ca3bbddc0c6758 
```

* * *

## 回答 #16

> 赞同：1
> 
>             
> 
> 时间：2018-03-08T11:17:38.007

这是 Python 3 中的一个简单、简短的变体，它适用于小型文件（例如，源树或其他东西，每个文件都可以轻松地放入 RAM），忽略空目录，基于其他解决方案的想法：

```
import os, hashlib

def hash_for_directory(path, hashfunc=hashlib.sha1):                                                                                            
    filenames = sorted(os.path.join(dp, fn) for dp, _, fns in os.walk(path) for fn in fns)         
    index = '\n'.join('{}={}'.format(os.path.relpath(fn, path), hashfunc(open(fn, 'rb').read()).hexdigest()) for fn in filenames)               
    return hashfunc(index.encode('utf-8')).hexdigest() 
```

* * *

它是这样工作的：

1.  递归查找目录下所有文件并按名称排序

2.  计算每个文件的哈希值（默认值：SHA-1）（将整个文件读入内存）

3.  使用“filename=hash”行创建文本索引

4.  将该索引编码回 UTF-8 字节字符串并散列

如果 SHA-1 不是您喜欢的茶，您可以传入[不同的哈希函数作为第二个参数。](https://docs.python.org/3/library/hashlib.html)

* * *

## 回答 #17

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T09:57:21.017

您可以`sha1sum`生成哈希值列表，然后`sha1sum`再次生成该列表，这取决于您想要完成的具体内容。

* * *

## 回答 #18

> 赞同：-1
> 
>             
> 
> 时间：2022-02-14T06:11:53.970

您可以尝试[hashdir](https://ultimateanu.github.io/hashdir/)，这是一个为此目的而编写的开源命令行工具。

`hashdir /folder/of/stuff`

它有几个有用的标志，允许您指定散列算法，打印所有子节点的散列，以及保存和验证散列。

```
hashdir:
  A command-line utility to checksum directories and files.

Usage:
  hashdir [options] [<item>...] [command]

Arguments:
  <item>    Directory or file to hash/check

Options:
  -t, --tree                                         Print directory tree
  -s, --save                                         Save the checksum to a file
  -i, --include-hidden-files                         Include hidden files
  -e, --skip-empty-dir                               Skip empty directories
  -a, --algorithm <md5|sha1|sha256|sha384|sha512>    The hash function to use [default: sha1]
  --version                                          Show version information
  -?, -h, --help                                     Show help and usage information

Commands:
  check <item>    Verify that the specified hash file is valid. 
```

# wpf - WPF 和 ToolboxItem(false)

> ID：545388
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-02-13T09:52:08.220
> 
>         
> 
> 标签：wpf, visual-studio

我在我的控件库中的几个类上设置 ToolboxItem(false) 属性，以防止将其添加到工具箱中。此属性与 ASP.NET 设计器完美配合，但使用 WPF 设计器似乎没有效果。

是否有其他方法可以使用 WPF 实现这一目标，或者只是不受支持？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-02-13T20:10:47.907

自己找到了答案。您应该使用Microsoft.Windows.Design 命名空间中的[ToolboxBrowsable(false)](http://msdn.microsoft.com/en-us/library/microsoft.windows.design.toolboxbrowsableattribute.aspx)属性，而不是 System.ComponentModel 中的 ToolboxItem(false)。

# java - 我是否应该始终初始化 Java 中的实例变量？

> ID：545391
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-02-13T09:53:26.750
> 
>         
> 
> 标签：java, variables, initialization

我最近开始了一个新项目，我试图让我的实例变量始终初始化为某个值，因此它们在任何时候都不是空的。下面的小例子：

```
public class ItemManager {

  ItemMaster itemMaster;
  List<ItemComponentManager> components;

  ItemManager() {
    itemMaster = new ItemMaster();
    components = new ArrayList<ItemComponentManager>();
  }

  ...
} 
```

重点主要是避免在代码中某处使用实例变量之前对*null进行繁琐的检查。*到目前为止，它运行良好，并且您大多不需要*null*值，因为您还可以检查空字符串或空列表等。我没有将这种方法用于方法范围的变量，因为它们的范围非常有限，所以不会影响代码的其他部分。

这一切都是实验性的，所以我想知道这种方法是否可行，或者是否有一些我还没有看到的陷阱。保持实例变量初始化通常是个好主意吗？

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-02-13T10:00:16.330

我通常将空集合和空集合视为两个独立的事物：

一个空集合意味着我知道有零个可用项目。一个空集合会告诉我我不知道集合的状态，这是另一回事。

所以我真的不认为这是非此即彼的。如果我在构造函数中初始化它们，我会声明变量**final 。**如果您将其声明为 final，那么读者将非常清楚该集合不能为空。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-02-13T12:52:07.053

首先，如果您想保留控制权，**所有**非最终实例变量都必须声明为**私有！**

还要考虑惰性实例化——这也避免了“坏状态”，但只在使用时初始化：

```
class Foo {
    private List<X> stuff;
    public void add(X x) {
        if (stuff == null)
            stuff = new ArrayList<X>();
        stuff.add(x);
    }
    public List<X> getStuff() {
        if (stuff == null)
            return Collections.emptyList();
        return Collections.unmodifiableList(stuff);
    }
} 
```

（注意 Collections.unmodifiableList 的使用——除非你真的希望调用者能够从你的列表中添加/删除，你应该让它不可变）

考虑将创建多少个相关对象的实例。如果有很多，并且您总是创建列表（并且最终可能会得到许多空列表），那么您可能会创建比您需要的更多的对象。

除此之外，这实际上是一个品味问题，以及在构建时是否可以具有有意义的值。

如果您正在使用 DI/IOC，您希望框架为您完成工作（尽管您可以通过构造函数注入来完成；我更喜欢 setter）—— Scott

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T09:59:17.143

我会说这完全没问题 - 只要您记得那里有“空”占位符值而不是真实数据。

将它们保持为空的好处是迫使您处理它们 - 否则程序会崩溃。如果您创建了空对象，但忘记了它们，您会得到未定义的结果。

并且只是评论防御性编码 - 如果您是创建对象的人并且从不将它们设置为 null，则无需每次都检查 null。如果由于某种原因你得到空值，那么你就知道发生了灾难性的错误，程序无论如何都会崩溃。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T10:09:49.487

如果可能的话，我会把它们做成**最终**的。然后它们必须在构造函数中初始化并且不能为空。

在任何情况下，您还应该将它们设为私有，以防止其他类将 null 分配给它们。如果您可以检查您的班级中从未分配过 null ，那么该方法将起作用。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T10:19:01.760

我遇到过一些导致问题的情况。在反序列化期间，一些框架不会调用构造函数，我不知道他们如何或为什么选择这样做，但它确实发生了。这可能导致您的值是`null`. 我也遇到过调用构造函数但由于某种原因未初始化成员变量的情况。

实际上，我会使用以下代码而不是您的代码：

```
public class ItemManager {

  ItemMaster itemMaster = new ItemMaster();
  List<ItemComponentManager> components = new ArrayList<ItemComponentManager>();

  ItemManager() {
     ...
  }
  ...
} 
```

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T17:56:29.367

我处理我声明的任何变量的方式是决定它是否会在对象（或类，如果它是静态的）的生命周期内发生变化。如果答案是“否”，那么我将其定为最终结果。

使其最终强制您在创建对象时给它一个值......我个人会执行以下操作，除非我知道我会改变要点：

```
  私人最终ItemMaster itemMaster；
  私有最终列表组件；

  // 实例初始化块 - 发生在构造时
  {
      itemMaster = new ItemMaster();
      组件 = 新的 ArrayList();
  }

```

您的代码现在的方式必须始终检查 null，因为您没有将变量标记为私有（这意味着同一包中的任何类都可以将值更改为 null）。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T09:58:11.140

是的，在构造函数中初始化所有类变量是一个很好的主意。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T10:01:22.270

> 重点主要是避免在代码中某处使用类变量之前对 null 进行繁琐的检查。

您仍然需要检查是否为空。第三方库甚至 Java API 有时会返回 null。

此外，实例化一个可能永远不会使用的对象是一种浪费，但这取决于你的类的设计。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T10:45:22.053

对象在构建后应该 100% 准备好使用。用户不必检查空值。防御性编程是要走的路——保持检查。

为了 DRY 的利益，您可以将检查放在设置器中，并让构造函数调用它们。这样您就不会对检查进行两次编码。

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T09:56:54.167

如果在您设置的一种方法中会发生什么

```
itemMaster = null; 
```

或者您将对 ItemManager 的引用返回给其他类，并将 itemMaster 设置为 null。（您可以防止这很容易返回您的 ItemManager 等的克隆）

我会保留支票，因为这是可能的。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T09:59:09.250

如果这是您的所有代码并且您想设置该约定，那么拥有它应该是一件好事。不过，我同意 Paul 的评论，没有什么可以阻止某些错误代码意外地将您的类变量之一设置为 null。作为一般规则，我总是检查空值。是的，这是一个 PITA，但防御性编码可能是一件好事。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T19:23:13.027

从“ItemManager”类的名称来看，ItemManager 在某些应用程序中听起来像是一个单例。如果是这样，您应该进行调查，并且真的，真的，知道依赖注入。使用 Spring ( [http://www.springsource.org/](http://www.springsource.org/) ) 之类的东西来创建 ItemComponentManagers 列表并将其注入 ItemManager。

如果没有 DI，在严肃的应用程序中手动初始化是调试的噩梦，连接各种“管理器”类以进行狭窄的测试是地狱。

始终使用 DI（即使在构建测试时）。对于数据对象，创建一个 get() 方法，如果列表不存在则创建该列表。但是，如果对象很复杂，几乎可以肯定的是，使用 Factory 或 Builder 模式会让您的生活变得更好，并让 F/B 根据需要设置成员变量。

# c++ - 组合谓词

> ID：545394
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-02-13T09:54:04.830
> 
>         
> 
> 标签：c++, stl, functional-programming, predicate

有什么方法可以组合谓词吗？

可以说我有这样的事情：

```
class MatchBeginning : public binary_function<CStdString, CStdString, bool>
{   public:
          bool operator()(const CStdString &inputOne, const CStdString &inputTwo) const
    {   return inputOne.substr(0, inputTwo.length()).compare(inputTwo) == 0;    }
};

int main(int argc, char* argv[])
{
    CStdString myString("foo -b ar -t az"); 

    vector<CStdString> tokens;

    // splits the string every time it encounters a "-"
    split(myString, tokens, "-", true, true);   

    vector<CStdString>::iterator searchResult = find_if(tokens.begin(), tokens.end(), not1(bind2nd(MatchBeginning(), "-")));        

    return 0;
} 
```

这行得通，但现在我想做类似的事情：

```
searchResult = find_if(tokens.begin(), tokens.end(), bind2nd(MatchBeginning(), "-b") || not1(bind2nd(MatchBeginning(), "-"))); 
```

所以我想找到第一个以“-b”开头的字符串或第一个不以“-”开头的字符串。但是，这给了我一个错误（二进制“||”未定义）。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-02-13T10:22:27.493

我可以推荐 boost.lambda 为此类任务组合函数对象。虽然对于这样一个简单的问题来说它有点重量级。（**编辑**）有关使用 STL 的一个很好的例子，请参阅 xhantt 开始的社区 wiki 答案。

（旧的，不推荐使用的，答案）您可以为此编写自己的实用程序，类似：

```
// here we define the combiner...
template<class Left, class Right>
class lazy_or_impl {
  Left m_left;
  Right m_right;
public:
  lazy_or_impl(Left const& left, Right const& right) : m_left(left), m_right(right) {}
  typename Left::result_type operator()(typename Left::argument_type const& a) const {
    return m_left(a) || m_right(a);
  }
};

// and a helper function which deduces the template arguments
// (thx to xtofl to point this out)
template<class Left, class Right>
lazy_or_impl<Left, Right> lazy_or(Left const& left, Right const& right) {
  return lazy_or_impl<Left, Right>(left, right);
} 
```

然后使用它：`... lazy_or(bind1st(...), bind1st(...)) ...`

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-02-13T14:16:45.573

那么你有[std::logical_or](http://www.sgi.com/tech/stl/logical_or.html)和[std::compose2](http://www.sgi.com/tech/stl/binary_compose.html)可以完成这项工作

```
find_if(tokens.begin(), tokens.end(), 
  compose2(logical_or<bool>(),
    bind2nd(MatchBeginning(), "-b"),
    bind2nd(MatchBeginning(), "-")
  ) 
); 
```

但我认为 boost::lambda 和/或 phoenix 最终更具可读性，并且是我推荐的解决方案。

学分应该转到 SGI 文档。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-02-13T10:38:42.413

如果您想编写谓词，最好的编写方法可能是使用 Boost Lambda 或 Boost Phoenix：

```
// Lambda way:
// Needs:
// #include <boost/lambda/lambda.hpp>
// #include <boost/lambda/bind.hpp>
{
    using namespace boost::lambda;
    foo_vec::const_iterator it
        = std::find_if(
                    tokens.begin(),
                    tokens.end(),
                    bind(MatchBeginning(), _1, "-b") || !bind(MatchBeginning(), _1, "-")
                    );
}
// Boost bind way:
// Needs:
// #include <boost/bind.hpp>
{
    foo_vec::const_iterator it
        = std::find_if(
                    tokens.begin(),
                    tokens.end(),
                    boost::bind(
                                std::logical_or<bool>(),
                                boost::bind(MatchBeginning(), _1, "-b"),
                                !boost::bind(MatchBeginning(), _1, "-") // ! overloaded in bind
                               )
                    ); 
```

对于 Phoenix 方式，一种可能性是使用 phoenix 惰性函数，解决方案可能类似于以下解决方案：

```
// Requires:
// #include <boost/spirit/include/phoenix_core.hpp>
// #include <boost/spirit/include/phoenix_function.hpp>
// #include <boost/spirit/include/phoenix_operator.hpp>
namespace phx = boost::phoenix;

struct match_beginning_impl
{
    template <typename Arg1, typename Arg2>
    struct result
    {
        typedef bool type;
    };

    template <typename Arg1, typename Arg2>
    bool operator()(Arg1 arg1, Arg2 arg2) const
    {
        // Do stuff
    }
};
phx::function<match_beginning_impl> match_beginning;

using phx::arg_names::arg1;

foo_vec::const_iterator it
    = std::find_if(
                tokens.begin(),
                tokens.end(),
                match_beginning(arg1, "-b") || !match_beginning(arg1, "-")
                ); 
```

然而，为了完成您的任务，使用不同的工具可能更有意义 - 例如：正则表达式（Boost Regex 或 Boost Xpressive）。如果要处理命令行选项，请使用 Boost Program Options。

# silverlight - 如何强制 Silverlight 容器扩展/收缩到其子控件的大小？

> ID：545400
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-02-13T09:55:37.527
> 
>         
> 
> 标签：silverlight

我有一个 300 高的根用户控件。

在里面我有一个边框，我想扩展到它自己的控件的大小，所以如果我堆叠更多的控件，它会扩展——更少的控件，它会收缩。

但是，当我将其设置为“自动”时，它会将其扩展到*其父容器*的大小，而不是其*子控件*的大小。

如何让 Border 扩展和收缩到其子控件的大小，类似于 HTML 表格的功能？

```
<UserControl   x:Class="Second105.Page"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    xmlns:basics="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls"
    Width="400" Height="300">
    <Grid x:Name="LayoutRoot" Background="White">
        <Border 
            Background="Tan" 
            CornerRadius="10" 
            Padding="10"
            Width="300" 
            Height="Auto">
        <StackPanel>
                <TextBlock HorizontalAlignment="Center" Margin="0 0 0 5">Please select a <Run FontStyle="Italic">week day</Run>:</TextBlock>
            <basics:Calendar
                Name="theCalendar" 
                SelectedDatesChanged="Calendar_SelectedDatesChanged"/>
            <TextBlock
                Name="theMessage"
                Margin="0 10 0 0"
                HorizontalAlignment="Center"
                Text="..."/>
        </StackPanel>
        </Border>
    </Grid>
</UserControl> 
```

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-02-13T10:12:29.903

将它包装在 StackPanel 中应该这样做：

```
<UserControl
   xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
   xmlns:basics="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls"
   xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
   Width="400"
   Height="300">
   <Grid x:Name="LayoutRoot" Background="White">
      <StackPanel>
         <Border
            Width="300"
            Height="Auto"
            Background="Tan"
            CornerRadius="10"
            Padding="10">
            <StackPanel>
               <TextBlock HorizontalAlignment="Center" Margin="0 0 0 5">Please select a 
                  <Run FontStyle="Italic">week day
                  </Run>:
               </TextBlock>
               <TextBlock
                  Name="theMessage"
                  HorizontalAlignment="Center"
                  Margin="0 10 0 0"
                  Text="..."/>
            </StackPanel>
         </Border>
      </StackPanel>
   </Grid>
</UserControl> 
```

# objective-c - 是否有可以在 Windows 上运行的 Mac 模拟器或 Objective-C 环境？

> ID：545401
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-02-13T09:55:45.963
> 
>         
> 
> 标签：objective-c, macos, emulation

我正在学习Objective-c，但想通过Windows上的某种模拟器运行代码片段——最好是基于Web的。  

我想了解 Objective-C 语法并浏览常见的代码示例，可能是通过某种控制台。当我在家中使用 MacBook 时，我可能会留下任何框架类型的学习。

我做了一个快速的谷歌没有成功。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-02-13T10:07:23.957

这取决于你的意思。Objective-C 可以通过 GCC 编译，因此您可以愉快地在 Windows 上创建 Objective-C 测试应用程序。但是，如果您谈论的是在 OSX 上开发时包含大部分功能的框架，那么不幸的是，它不是。[您可以从gnustep.org](http://gnustep.org/)获得与某些部分兼容的库（并在 Linux/BSD 上运行它们），但它仍然不是完整的 OSX“堆栈”。

你可以让 OS X 在 VMWare 中运行，但这是非法的，所以你最好选择一台可以运行 Tiger/Leopard 的廉价 Mac 并使用它。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T10:04:37.287

看过[GNUStep](http://en.wikipedia.org/wiki/GNUStep)吗？

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T15:00:31.880

另一种可能性是使用卡布奇诺。

[http://cappuccino.org](http://cappuccino.org)

它是一个类似可可的 javascript 框架，看起来与 Objective-c 非常相似。该语言称为objective-j。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T10:07:21.163

AFAIK 你可以使用 GNU 编译器来编译 Objective-C，所以它也应该可以在 Windows 上使用。这应该足以让您开始编程语言。

然而，对于 Mac OS X，语言只是方程式的一部分，您需要针对 Mac OS X 的库进行编程，为此您真的需要一台运行它的机器。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T10:34:45.560

我不确定哪些库存在，哪些不存在，但您*可以*在 VM 中运行 OS X Server（当然前提是您拥有 OS X Server 许可证）。这将允许您在 Windows 系统上拥有一个虚拟 Mac 环境。

如上所述，由于底层系统明显不同，因此无法在 Windows 中实现您想要的本机。

祝你好运。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2010-10-19T18:39:41.670

还有[The Cocotron](http://code.google.com/p/cocotron/)。

# javascript - JS中的浮点数

> ID：545408
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-13T09:57:48.877
> 
>         
> 
> 标签：javascript, floating-point

我正在写一个小网页，让学生能够回答问题并获得对他们答案的反馈。

此检测的一部分检查常见错误以提供指导。具体来说，我想检查他们的答案是否是实际答案的 10 次方。

如果答案是 3.93E-6，则如果他们键入 3.93E2、3.93E-9、3.93 等，则应激活此条件。

对我来说，测试这一点的明显方法是做这样的事情：

```
var correct = 3.93E-6;
var entry = 3.93E-2; //really comes from an input box.

if (!(entry / correct)%10) {
    alert ("power of ten error");
} 
```

但是，这不起作用，因为错误/正确不适用于大/小数字。

我怎样才能解决这个问题？

实时代码：[http ://bradshawenterprises.com/test.html](http://bradshawenterprises.com/test.html)

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T10:06:05.427

```
var num = 12.4123;
var numString = num.toExponential()
// numString = "1.24123e+1" 
```

这会使数字标准化，但您必须手动解析它。（比如结果必须有多准确……）

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T10:15:50.283

这是查看两个数字是否相差大约 10 次方的一种方法：

```
var correct = 3.93E-6;
var entry = 3.93E-2;
var epsilon = .01;

var log10_ratio = Math.log(correct/entry)/Math.log(10);
if (Math.abs(Math.round(log10_ratio) - log10_ratio) < epsilon) {
    alert ("power of ten error");
} 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T10:04:39.733

如果要求他们输入带有“E”符号的答案，为什么不检查“E”之前的所有内容在学生的答案和正确答案中是否相同。

当然，您可能还想告诉他们应该保留多少小数位，否则 1.2E5 和 1.21E7 不会触发“十次方错误”

# php - 尝试使用 PHP Soap 类捕获 soapfault 的错误消息

> ID：545416
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-13T10:01:14.190
> 
>         
> 
> 标签：php, soap

出于某种原因，我无法捕捉到错误。我正在关注 O'Reillys PHP 食谱中的一个示例，所以我还没有进行任何牛仔编码。

错误是：

```
SoapFault exception: [SOAP-ENV:Server] SoapFault::SoapFault() [soapfault.soapfault]: Invalid parameters. Invalid fault code. in C:\xampp\htdocs\soap\client_database.php:13 Stack trace: #0 C:\xampp\htdocs\soap\client_database.php(13): SoapClient->__soapCall('select_query', Array) #1 {main} 
```

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T15:40:05.607

我找到了解决方案，您只能在抛出错误时使用某些错误代码。

[http://www.w3.org/TR/soap12-part1/#faultcodes](http://www.w3.org/TR/soap12-part1/#faultcodes)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T15:43:10.013

根据[标准](http://www.w3.org/TR/soap12-part1/#faultcodes)，故障代码只有 5 种可能的选项：

1.  版本不匹配

2.  必须了解

3.  数据编码未知

4.  发件人

5.  接收者

选择最适合您的情况并在抛出 SoapFault 异常时将其用作 $faultCode 的值。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T15:34:07.150

我在 php 5.2.0 中遇到了其他（奇怪的）SOAP 错误，这些错误在 php 5.2.8 中得到了解决

如果你不是最新版本的 php，我建议升级看看会发生什么

# python - 在 Python 中使用基类构造函数作为工厂？

> ID：545419
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2009-02-13T10:03:19.487
> 
>         
> 
> 标签：python, factory

我使用基类构造函数作为工厂，并在这个构造函数/工厂中更改类以选择合适的类——这种方法是好的 python 实践还是有更优雅的方法？

我试图阅读有关元类的帮助，但没有取得很大成功。

这是我在做什么的例子。

```
class Project(object):
  "Base class and factory."
  def __init__(self, url):
      if is_url_local(url):
        self.__class__ = ProjectLocal
      else:
        self.__class__ = ProjectRemote
      self.url = url

class ProjectLocal(Project):
  def do_something(self):
    # do the stuff locally in the dir pointed by self.url

class ProjectRemote(Project):
  def do_something(self):
    # do the stuff communicating with remote server pointed by self.url 
```

有了这段代码，我可以通过基类 Project 创建 ProjectLocal/ProjectRemote 的实例：

```
project = Project('http://example.com')
project.do_something() 
```

我知道另一种方法是使用将基于 url 返回类对象的结构函数，然后代码看起来相似：

```
def project_factory(url):
      if is_url_local(url):
        return ProjectLocal(url)
      else:
        return ProjectRemote(url)

project = project_factory(url)
project.do_something() 
```

我的第一种方法只是口味问题还是有一些隐藏的陷阱？

* * *

## 回答 #1

> 赞同：19
> 
>             
> 
> 时间：2009-02-13T12:49:18.293

你不应该为此需要元类。看看[`__new__`](http://docs.python.org/reference/datamodel.html#object.__new__)方法。这将允许您控制对象的创建，而不仅仅是初始化，因此返回您选择的对象。

```
class Project(object):
  "Base class and factory."
  def __new__(cls, url):
    if is_url_local(url):
       return super(Project, cls).__new__(ProjectLocal, url) 
    else:
       return super(Project, cls).__new__(ProjectRemote, url) 

  def __init__(self, url):
    self.url = url 
```

* * *

## 回答 #2

> 赞同：13
> 
>             
> 
> 时间：2009-02-13T10:15:37.570

我会坚持使用工厂函数方法。这是非常标准的python，易于阅读和理解。您可以通过多种方式使其更通用以处理更多选项，例如通过传入鉴别器函数和结果到类的映射。  

如果第一个示例有效，则更多的是运气而不是设计。如果你想`__init__`在你的子类中有一个定义怎么办？  

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T10:26:50.930

以下链接可能会有所帮助：
 [http ://www.suttoncourtenay.org.uk/duncan/accu/pythonpatterns.html#factory](http://www.suttoncourtenay.org.uk/duncan/accu/pythonpatterns.html#factory) 
[http://code.activestate.com/recipes/86900/](http://code.activestate.com/recipes/86900/)

此外，当您使用新样式类时，使用 __new__ 作为工厂函数（而不是在基类中，单独的类更好）是通常所做的（据我所知）。

工厂功能通常更简单（正如其他人已经发布的那样）

此外，按照您所做的方式设置 __class__ 属性也不是一个好主意。

我希望你能找到答案和有用的链接。

祝一切顺利。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2010-06-23T08:53:37.463

是的，正如@scooterXL 所提到的，在这种情况下，工厂函数是最好的方法，但我想指出工厂作为类方法的一个案例。

考虑以下类层次结构：

```
class Base(object):

    def __init__(self, config):
        """ Initialize Base object with config as dict."""
        self.config = config

    @classmethod
    def from_file(cls, filename):
        config = read_and_parse_file_with_config(filename)
        return cls(filename)

class ExtendedBase(Base):

    def behaviour(self):
        pass # do something specific to ExtendedBase 
```

现在您可以从 config dict 和 config 文件创建 Base 对象：

```
>>> Base({"k": "v"})
>>> Base.from_file("/etc/base/base.conf") 
```

而且，您可以免费使用 ExtendedBase 做同样的事情：

```
>>> ExtendedBase({"k": "v"})
>>> ExtendedBase.from_file("/etc/extended/extended.conf") 
```

所以，这个类方法工厂也可以被认为是辅助构造函数。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T10:19:40.277

我通常有一个单独的工厂类来执行此操作。这样您就不必使用元类或作业来`self.__class__`

我还尽量避免将有关哪些类可用于创建的知识放入工厂中。相反，我让所有可用的类在模块导入期间向工厂注册。给那里的类和一些关于何时选择这个类到工厂的信息（这可以是一个名称、一个正则表达式或一个可调用的（例如注册类的类方法））。

对我来说效果很好，还实现了封装和信息隐藏等功能。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T10:14:23.127

我认为使用工厂函数的第二种方法比让基类的实现依赖于它的子类要干净得多。

# c# - 在 C# 中加入/合并数组

> ID：545421
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-02-13T10:04:30.093
> 
>         
> 
> 标签：c#, .net, linq, arrays, c#-3.0

我有两个或多个数组——一个带有 ID，一个或多个带有字符串值。我想将这些合并到一个哈希表中，这样我就可以按 ID 查找值。

以下函数可以完成这项工作，但更短更甜的版本（LINQ？）会很好：

```
Dictionary<int, string[]> MergeArrays( IEnumerable<int> idCollection,
                                       params IEnumerable<string>[] valueCollections )
{
    var dict = new Dictionary<int, string[]>();

    var idL = idCollection.Count();
    while ( idL-- > 0 )
    {
        dict[idCollection.ElementAt( idL )] = new string[valueCollections.Length];

        var vL = valueCollections.Length;
        while ( vL-- > 0 )
            dict[idCollection.ElementAt( idL )][vL] = valueCollections[vL].ElementAt( idL );
    }

    return dict;
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T10:10:35.913

目前这是非常低效的——所有对 ElementAt 的调用可能每次都经过整个序列（只要他们需要）。（这取决于序列的实现。）

但是，我根本不确定我是否理解这段代码在做什么（使用 foreach 循环几乎肯定会使其更清晰，就像向前而不是向后迭代一样。你能提供一些示例输入吗？和预期的输出？

编辑：好的，我想我知道这里发生了什么；您正在有效地旋转 valueCollections。我怀疑你会想要类似的东西：

```
static Dictionary<int, string[]> MergeArrays(
    IEnumerable<int> idCollection,
    params IEnumerable<string>[] valueCollections)
{
    var valueCollectionArrays = valueCollections.Select
         (x => x.ToArray()).ToArray();
    var indexedIds = idCollection.Select((Id, Index) => new { Index, Id });

    return indexedIds.ToDictionary(x => Id, 
        x => valueCollectionArrays.Select(array => array[x.Index]).ToArray());
} 
```

虽然它很丑。如果您可以将 idCollection 设为一个数组，坦率地说，它会更容易。

编辑：好的，假设我们可以使用数组来代替：

```
static Dictionary<int, string[]> MergeArrays(
    int[] idCollection,
    params string[][] valueCollections)
{
    var ret = new Dictionary<int, string[]>();
    for (int i=0; i < idCollection.Length; i++)
    {
         ret[idCollection[i]] = valueCollections.Select
             (array => array[i]).ToArray();
    }
    return ret;
} 
```

我已经（希望）纠正了第一个版本中的一个错误——我对哪些值是数组而哪些不是数组感到困惑。第二个版本不是声明性的，但我个人认为它更清晰。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T10:27:05.640

怎么样：

```
 public static Dictionary<int, string[]> MergeArrays2(IEnumerable<int> idCollection,
        params IEnumerable<string>[] valueCollections)
    {
        var dict = new Dictionary<int, string[]>();
        var valEnums = (from v in valueCollections select v.GetEnumerator()).ToList();
        foreach (int id in idCollection)
        {
            var strings = new List<string>();
            foreach (var e in valEnums)
                if (e.MoveNext())
                    strings.Add(e.Current);
            dict.Add(id, strings.ToArray());
        }
        return dict;
    } 
```

或稍微编辑 skeet 答案（它对我不起作用）：

```
 static Dictionary<int, string[]> MergeArrays_Skeet(IEnumerable<int> idCollection,params IEnumerable<string>[] valueCollections)
    {
        var valueCollectionArrays = valueCollections.Select(x=>x.ToArray()).ToArray();
        var indexedIds = idCollection.Select((Id, Index) => new { Index, Id });
        return indexedIds.ToDictionary(x => x.Id,x => valueCollectionArrays.Select(array => array[x.Index]).ToArray());
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T10:15:57.087

除非我遗漏了什么，否则您不需要复制数组的代码——它们本身就是对象，不会意外消失。

使用`Select()`匿名类将值组合在一起，然后`ToDictionary()`将它们装瓶。

试试这个：

```
 IDictionary<int, IEnumerable<string>> MergeArrays2(
        IEnumerable<int> idCollection,
        params IEnumerable<string>[] valueCollections)
    {
        var values = valueCollections.ToList();
        return idCollection.Select(
            (id, index) => new { Key = id, Value = values[index] })
            .ToDictionary(x => x.Key, x => x.Value);
    } 
```

请注意，返回类型使用 IEnumerable 而不是 string[] - 恕我直言，您会发现这比使用数组更灵活。

此外，返回类型使用接口。

**更新**：John Skeet 提出了一个很好的观点（见下面的评论）数组是可变的，这可能是一个问题。请参阅下面的简单更改来创建新数组：

```
 IDictionary<int, IEnumerable<string>> MergeArrays2(
        IEnumerable<int> idCollection,
        params IEnumerable<string>[] valueCollections)
    {
        var values = valueCollections.ToList();
        return idCollection.Select(
            (id, index) => new 
            { 
                Key = id, 
                Value = values[index].ToArray()  // Make new array with values
            })
            .ToDictionary(x => x.Key, x => x.Value);
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T13:43:45.900

这里有一些优雅。它比我喜欢的要长，但它非常具有探索性。

```
 public Dictionary<int, string[]> MergeArrays(
        IEnumerable<int> idCollection,
        params IEnumerable<string>[] valueCollections
            )
    {
        Dictionary<int, int> ids = idCollection
            .ToDictionaryByIndex();
        //
        Dictionary<int, List<string>> values =
            valueCollections.Select(x => x.ToList())
            .ToList()
            .Pivot()
            .ToDictionaryByIndex();
        //
        Dictionary<int, string[]> result =
            ids.ToDictionary(
                z => z.Value,
                z => values[z.Key].ToArray()
            );

        return result;
    } 
```

这是我使用的辅助方法。

```
 public static List<List<T>> Pivot<T>
        (this List<List<T>> source)
    {
        return source
            .SelectMany((it) =>
              it.Select((t, i) => new { t, i })
            )
            .GroupBy(z => z.i)
            .Select(g => g.Select(z => z.t).ToList())
            .ToList();
    }

    public static Dictionary<int, T> ToDictionaryByIndex<T>
        (this IEnumerable<T> source)
    {
        return source
            .Select((t, i) => new { t, i })
            .ToDictionary(z => z.i, z => z.t);
    } 
```

免责声明：如果您使用非矩形结构调用 Pivot，我不知道/关心会发生什么。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T14:34:24.033

这并不像您要求的那么普遍，但它将两个可枚举项连接成一个可枚举的对。将可枚举的结果转换为字典非常简单。

```
public static class ExtensionMethods
{
    public static IEnumerable<Pair<TOuter, TInner>> InnerPair<TInner, TOuter>(this IEnumerable<TOuter> master,
                                                                         IEnumerable<TInner> minor)
    {
        if (master == null)
            throw new ArgumentNullException("master");
        if (minor == null)
            throw new ArgumentNullException("minor");
        return InnerPairIterator(master, minor);
    }

    public static IEnumerable<Pair<TOuter, TInner>> InnerPairIterator<TOuter, TInner>(IEnumerable<TOuter> master,
                                                                                 IEnumerable<TInner> minor)
    {
        IEnumerator<TOuter> imaster = master.GetEnumerator();
        IEnumerator<TInner> iminor = minor.GetEnumerator();
        while (imaster.MoveNext() && iminor.MoveNext())
        {
            yield return
                new Pair<TOuter, TInner> { First = imaster.Current, Second = iminor.Current };
        }
    }
}

public class Pair<TFirst, TSecond>
{
    public TFirst First { get; set; }
    public TSecond Second { get; set; }
} 
```

# c# - Windows 工作流基础 NullReferenceException

> ID：545436
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-13T10:10:22.530
> 
>         
> 
> 标签：c#, .net, workflow, workflow-foundation

我在使用 WWF 和外部引发的事件时遇到了 NullReference 问题。WWF 状态机与在状态机中引发事件的服务实例一起工作，以提供数据——当然——改变状态。虽然使用事件“正常”操作可以正常工作，但我遇到了一个奇怪的问题。

为了处理超时场景，我让状态初始化器使用外部超时机制在提到的服务中注册回调。在给定时间之后，回调函数运行并应在状态机中引发超时事件。事件定义如下：

```
event EventHandler<ExternalDataEventArgs> DeviceSysmapBrdcstTimeoutEvent; 
```

如前所述，如果没有从超时机制中调用，则可以正常工作。ExternalDataEventArgs 是使用有效的 Guid 创建的。引发 Excetion 访问事件中的委托：

```
System.Workflow.Activities.EventDeliveryFailedException was unhandled by user code
    Message="Event \"DeviceSysmapBrdcstTimeoutEvent\" on interface type \"...\" for instance id \"efa3da3d-8546-4fcf-bc56-bbec04df6d69\" cannot be delivered."
Source="System.Workflow.Activities"
    StackTrace:
        at System.Workflow.Activities.WorkflowMessageEventHandler.EventHandler(Object sender, ExternalDataEventArgs eventArgs) 
```

任何人的想法？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-03-14T05:00:52.447

您应该检查内部异常以获取更多详细信息。检查您的事件服务类是否标记为 [Serializable]，并在事件 args 中将 WaitForIdle 属性设置为 true。

```
CustomEventDataArgs eventArgs = new CustomEventDataArgs();
//
eventArgs.WaitForIdle = true; 
```

检查这是否解决了问题。

谢谢。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-17T16:55:04.383

您可能会因为多种原因而获得上述异常，您需要检查 Inner exceptions 属性的详细信息

一个可能的原因可能是，您可能希望在超时时从状态 A 转换到状态 B，但在状态更改之前，您需要验证您实际上处于状态 A

为了清楚起见，发布内部异常详细信息

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-14T09:07:34.310

您可以检查此链接是否有帮助？

[http://www.mono-project.com/Gendarme.Rules.Concurrency#ProtectCallToEventDelegatesRule](http://www.mono-project.com/Gendarme.Rules.Concurrency#ProtectCallToEventDelegatesRule)

# java - 如何从 Java 发送 SMS？

> ID：545441
> 
>         
> 
> 赞同：11
> 
>         
> 
> 时间：2009-02-13T10:13:38.247
> 
>         
> 
> 标签：java, sms, send

我想从 Web 应用程序向特定移动设备发送 SMS，并仅接收他的回复和查看 Web 应用程序。是否可以使用 Java 技术进行创建？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-02-13T10:21:04.750

很少的 URLs 要经过，

[http://opensmpp.logica.com/](http://opensmpp.logica.com/)

[http://smslib.org/](http://smslib.org/)

我推荐SMSLIB

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2011-11-07T09:34:14.137

实现此目的的最佳方法是使用 SMS 网关。SMS 网关一方面封装了与 SMS 载体介质接口的技术细节，另一方面它为 http、SMTP、ftp 等应用程序级协议提供了一个接口与之交互。例如，您可以让 Web 应用程序通过 HTTP 与 SMS 网关通信，而另一端的网关将通过某种专有协议与 SMS 中心通信，以发送从应用程序接收到的 SMS 文本。此外，您可以配置网关以将传入的 SMS 消息发布回您的 Web 应用程序。这样，应用程序不需要知道发送 SMS 的低级协议。

如果您需要发送大量群发短信并将您的短信网关配置为使用该租用线路发送短信，您可以租用一条线路到短信中心 (SMSC)。但是租一条线路要贵得多。如果您需要发送少量消息，则可以使用手机代替专线。将您的手机连接到您的 PC/服务器并配置网关以使用您的手机。您需要参考您的网关文档，了解如何将您的电话与网关连接。这不是很困难，但相当简单。

市场上有很多商业网关可供使用。但是使用开源 SMS 网关是一个不错的选择。[您可以使用名为 - Kannel](http://www.kannel.org/)的开源网关。相信我，设置它并开始使用并不难。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T10:19:26.063

像[Esendex](http://www.esendex.co.uk/)这样的人可以提供这样的功能，还可以为您提供多种语言（包括 Java）的 SDK/示例代码。

# apache - .HTACCESS 文件导致内部服务器错误

> ID：545442
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-02-13T10:13:53.223
> 
>         
> 
> 标签：apache, .htaccess, mod-rewrite, apache2

我已将文件和数据库从[BradPPresents.com](http://BradPPresents.com)复制到[BradP.com](http://BradP.com)。

由于 joomla! 启用了“漂亮的 URL”，因此需要 .htaccess 文件才能正确显示页面。

[您可以在http://bradp.com/index.php](http://bradp.com/index.php)看到数据库和所有连接都在工作，但是[http://bradp.com/home.html](http://bradp.com/home.html)不起作用，因为它依赖 .htaccess 文件来解析网址。

我将相同的 htaccess 文件从 bradppresents.com（当前工作正常）复制到 bradp.com，当文件存在时我得到“内部服务器错误”。一旦它被删除，错误就会消失，但该网站当然不能按需要工作。

我希望有人可以为我阐明这一点。

这是 .htaccess 文件

```
RewriteEngine On
RewriteBase /

RewriteCond %{REQUEST_URI} (/|\.htm|\.php|\.html|\.aspx|\.asp|/[^.]*)$  [NC]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule (.*) index.php

## This attempts to block the most common type of exploit `attempts` to Joomla!
#
# Block out any script trying to set a mosConfig value through the URL
RewriteCond %{QUERY_STRING} mosConfig_[a-zA-Z_]{1,21}(=|\%3D) [OR]
# Block out any script trying to base64_encode crap to send via URL
RewriteCond %{QUERY_STRING} base64_encode.*\(.*\) [OR]
# Block out any script that includes a <script> tag in URL
RewriteCond %{QUERY_STRING} (\<|%3C).*script.*(\>|%3E) [NC,OR]
# Block out any script trying to set a PHP GLOBALS variable via URL
RewriteCond %{QUERY_STRING} GLOBALS(=|\[|\%[0-9A-Z]{0,2}) [OR]
# Block out any script trying to modify a _REQUEST variable via URL
RewriteCond %{QUERY_STRING} _REQUEST(=|\[|\%[0-9A-Z]{0,2})
# Send all blocked request to homepage with 403 Forbidden error!
RewriteRule ^(.*)$ index.php [F,L]

#max files size restrictions
php_value upload_max_filesize 20M
php_value post_max_size 20M 
```

这是来自 Apache 的站点配置文件。

```
<VirtualHost *:80>
        ServerAdmin webmaster@localhost

        DocumentRoot /home/nick/public_html/bradp.com/html/
        <Directory />
                Options FollowSymLinks
                AllowOverride All
        </Directory>
        <Directory /home/nick/public_html/bradp.com/html/>
                Options Indexes FollowSymLinks MultiViews
                AllowOverride All
                Order allow,deny
                allow from all
        </Directory>

        ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/
        <Directory "/usr/lib/cgi-bin">
                AllowOverride None
                Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch
                Order allow,deny
                Allow from all
        </Directory>

        ErrorLog /var/log/apache2/error.log

        # Possible values include: debug, info, notice, warn, error, crit,
        # alert, emerg.
        LogLevel warn

        CustomLog /var/log/apache2/access.log combined
        ServerSignature On

    Alias /doc/ "/usr/share/doc/"
    <Directory "/usr/share/doc/">
        Options Indexes MultiViews FollowSymLinks
        AllowOverride None
        Order deny,allow
        Deny from all
        Allow from 127.0.0.0/255.0.0.0 ::1/128
    </Directory>

</VirtualHost> 
```

它本质上是带有一些更改的默认文件。

我非常感谢我能得到的任何帮助；谢谢一百万，尼克

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-02-13T10:16:44.103

查看您的错误日志以查看确切的错误消息。

但是由于您在第一句话中说“复制”，我假设您正在从一个主机移动到另一个主机。最可能的原因是`rewrite`模块未加载到新服务器上。

# c# - 在 .NET 中查找进程树

> ID：545449
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-02-13T10:16:02.280
> 
>         
> 
> 标签：c#, .net, windows, interop

我正在寻找一种使用 C# 或其他 .NET 语言查找进程树的简单方法（如 Process Explorer 等工具所示）。查找另一个进程的命令行参数也很有用（System.Diagnostics.Process 上的 StartInfo 似乎对当前进程以外的进程无效）。

我认为这些事情只能通过调用 win32 api 来完成，但我很高兴被证明是错误的。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2010-03-26T00:28:37.657

如果您不想 P/Invoke，您可以使用性能计数器获取父 ID：

```
foreach (var p in Process.GetProcesses())
{
   var performanceCounter = new PerformanceCounter("Process", "Creating Process ID", p.ProcessName);
   var parent = GetProcessIdIfStillRunning((int)performanceCounter.RawValue);
   Console.WriteLine(" Process {0}(pid {1} was started by Process {2}(Pid {3})",
              p.ProcessName, p.Id, parent.ProcessName, parent.ProcessId );
}

//Below is helper stuff to deal with exceptions from 
//looking-up no-longer existing parent processes:

struct MyProcInfo
{
    public int ProcessId;
    public string ProcessName;
}

static MyProcInfo GetProcessIdIfStillRunning(int pid)
{
    try
    {
        var p = Process.GetProcessById(pid);
        return new MyProcInfo() { ProcessId = p.Id, ProcessName = p.ProcessName };
    }
    catch (ArgumentException)
    {
        return new MyProcInfo() { ProcessId = -1, ProcessName = "No-longer existant process" };
    }
} 
```

现在只需将其放入所需的任何树结构中即可。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T11:39:58.727

您也可以尝试查看 WMI（例如 Win32_Process 类）。

这是一个通过进程 ID 获取进程命令行的示例：

```
 using (var mos = new ManagementObjectSearcher(
                    "SELECT CommandLine FROM Win32_Process WHERE ProcessId = " + pid))
                {
                    foreach (var obj in mos.Get())
                    {
                        object data = obj.Properties["CommandLine"].Value;
                        if (data != null)
                        {
                            Console.WriteLine("{0}: commandline = {1}", pid, data.ToString());
                        }
                    }
                }
            }
        } 
```

我从我最近编写的一些代码中提取了这个。出于您的目的，您可能会使用其他技术（例如一次获取多个属性和/或进程）。但你明白了。

编辑：例如，构建树所需的父进程 ID 是“ParentProcessId”属性。

不过，我想，使用 Win32 API 会更快。请注意，并非您需要的所有功能都在那里正确可用。对于某些东西，您将不得不求助于（有点）不受支持的 NtQueryProcessInformation() 函数或来自 NTDLL 的其他函数。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-22T09:49:06.113

我不明白你为什么不想 p/invoke。如果您查看 Reflector 中的 System.Diagnostics，您会发现它在内部使用 p/invokes。无论如何，Process 类没有**办法**检索进程的父 PID。反而：

结构定义：

```
[StructLayout(LayoutKind.Sequential)]
struct PROCESS_BASIC_INFORMATION
{
    public int ExitStatus;
    public int PebBaseAddress;
    public int AffinityMask;
    public int BasePriority;
    public int UniqueProcessId;
    public int InheritedFromUniqueProcessId;
} 
```

（简化的）函数导入：

```
[DllImport("ntdll.dll")]
static extern int NtQueryInformationProcess(
    IntPtr ProcessHandle,
    int ProcessInformationClass,
    out PROCESS_BASIC_INFORMATION ProcessInformation,
    int ProcessInformationLength,
    out int ReturnLength
    ); 
```

编码：

```
Process p = Process.GetProcessById(1234);
PROCESS_BASIC_INFORMATION pbi;
int size;

NtQueryInformationProcess(p.Handle, 0, out pbi, Marshal.SizeOf(typeof(PROCESS_BASIC_INFORMATION)), out size);
// pbi.InheritedFromUniqueProcessId now contains the process' parent PID 
```

您需要在文件顶部插入这些使用：

```
using System.Runtime.InteropServices;
using System.Diagnostics; 
```

如果您想枚举进程，最好使用 NtQuerySystemInformation - 尽管该代码有点太长，无法在此处发布。

* * *

## 回答 #4

> 赞同：-1
> 
>             
> 
> 时间：2009-02-13T10:33:34.533

我很确定您需要为此使用 WinAPI。请参阅[此代码片段](http://msmvps.com/blogs/siva/archive/2006/10/02/Getting-Windows-Process-Owner-Name.aspx?)作为示例。从对象列表及其父对象构建树将是一种相当标准的算法。

# deployment - 作为安装的一部分，如何将 ClickOnce 应用程序部署到客户站点？

> ID：545451
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-13T10:18:19.140
> 
>         
> 
> 标签：deployment, installation, clickonce

我有一个与我们的软件相关联的 ClickOnce 应用程序，我们在内部部署和使用。我们希望将其提供给客户，但客户托管 clickonce 更新站点。据我从[The Instructions](http://msdn.microsoft.com/en-us/library/xc3tc5xx.aspx)中可以看出，我必须在创建部署清单后对其进行签名，并且要创建它，我需要知道更新站点。

在安装时间（在客户站点上）之前，我不知道更新站点，但我不希望我们的证书出现在客户站点上。

如何以这种方式部署应用程序？还是我误解了这是如何工作的？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T12:11:37.557

[演练：手动部署不需要重新签名且保留品牌信息的 ClickOnce 应用程序](http://msdn.microsoft.com/en-us/library/bb384246.aspx)看起来与我的场景非常匹配。

# frameworks - 为什么我们现在不能创建跨平台的程序？

> ID：545455
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-02-13T10:19:37.407
> 
>         
> 
> 标签：frameworks, machine-code

我只是想知道，如果任何语言的所有编译器都将代码转换为计算机内部“对话”的唯一语言（机器代码 - 零和一），为什么将 .NET Windows 应用程序传递给 Mac 应用程序如此困难？

不应该有人提出一个绝妙的主意（自从我 3 年前结婚以来，我就没有绝妙的主意！）并且有一个......我不知道......一个机器代码框架，而不是编译器转换为机器代码，它将转换为该框架，该框架将安装在任何平台（SuSE、fsb、Ubuntu、AIX、SCO、OS X、Windows 9x、Vista、7 等）中。

我想知道为什么我们不能这么简单地做事，这些天...

有什么想法吗？

* * *

## 回答 #1

> 赞同：13
> 
>             
> 
> 时间：2009-02-13T10:27:58.773

事实上，它已经完成了。至少在一定程度上。

其中一项工作称为 Java，它是一种跨平台语言。Java 编译器将源代码编译成一种叫做“字节码”的东西，它只不过是一种与机器无关的“汇编语言”。那个“可执行文件”后来被Java虚拟机（JVM）执行，这是不同平台的部分（即Windows JVM明显不同于MacOS JVM）。

但是，跨平台应用程序并不是那么简单。编写一个可以为每个可能的平台执行某种抽象字节码的基本 VM 相对简单。但是，如果语言本身缺乏丰富的类库，它实际上什么都不是。因此，由于各种原因，实现上述类库是一件非常困难的事情。

* * *

## 回答 #2

> 赞同：11
> 
>             
> 
> 时间：2009-02-13T10:46:07.153

这个问题比大多数人提出的要深，Java 仍然不是真正独立于平台的，因为它不会在所有 x86 或 x64 操作系统上运行，你仍然需要一个虚拟机才能在操作系统上运行。它甚至不接近您的建议，因为您仍然需要依赖于操作系统的运行时来执行“独立”字节码。

问题在于大多数可执行文件都覆盖了操作系统并将其用作一种框架。一旦您将某种操作系统相关的代码放入您的应用程序中，您就失去了使其独立的机会。磁盘 IO、网络 IO、图形 UI、获取系统信息，这些事情中的任何一个都会影响您的代码如何以及为什么不能独立。

还有一个可执行文件是什么的问题，在 windows 上你有[PE](http://en.wikipedia.org/wiki/Portable_Executable)，而在大多数 linux 操作系统上你有[ELF](http://en.wikipedia.org/wiki/Executable_and_Linkable_Format)。它们具有不同的结构和不同的加载方式。它们如何加载和执行取决于操作系统，而不是可执行文件的问题。

您可以在此图像中看到两种格式之间的区别（取自[此处](http://software.intel.com/en-us/articles/keeping-memory-in-mind/)：
 http: [//software.intel.com/file/9800](http://software.intel.com/file/9800)

基本上，问题在于对于可执行/二进制文件的结构化和加载到计算机的方式没有标准。然后，最重要的是操作系统的框架和功能。这是一个复杂得多的问题，但只要公司想要拥有特定于操作系统的功能，就无法解决这个问题。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2009-02-13T11:48:22.387

应用程序依赖于操作系统来提供服务。

您可以创建一个对操作系统的依赖性最小的应用程序。但即使（通过一些严肃的 Fu、Magic 和挥手）你让它在“每台计算机”上运行，这也不是我们想要的。

脚本和类脚本语言（如前面提到的 Python 和 Perl）就是这样：它们使用操作系统的最少功能，并在其之上构建它们提供的所有内容。这对于命令行应用程序来说非常有用，因为您需要（或多或少）读取和写入文件和用户控制台。

然而，今天的丰富应用程序需要更多的服务，它们需要“在操作系统上运行”而不是单独“在 CPU 上”：我们希望它们与操作系统集成，用户界面应该看起来是原生的，你想使用剪贴板， “打开文件”对话框应提供其他打开文件对话框提供的所有功能。  

像 Java 这样的环境试图通过使用更高级别的抽象以可移植的方式提供它：有窗口​​和小部件以及所有美丽的东西。但这有其自身的一些问题：

首先，您必须始终在“虚拟化平台一致性”（即应用程序无论在何处运行都一样）和“主机平台一致性”（即应用程序像本地应用程序一样工作）之间取得平衡。

您可以尝试完全放弃“原生内容”以避免该问题，但随后您的目标是所有平台提供的功能的交集。你在苹果上运行？取消第二个鼠标按钮。等等。此外，您的抽象平台将始终落后于主机平台的创新。

* * *

它的要点是没有灵丹妙药：你总要做出妥协。市场上有不同的折衷方案。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T10:25:52.570

我们可以这样做，以 Java 为例。**微软**是否会这样做是另一个问题。他们通过不这样做来保持 Windows 的竞争优势。

其他示例是 Perl 和 Python，仅举两个例子。仅仅有一种语言是不够的，你需要有库来让程序员的生活更轻松。Java、Python 和 Perl 似乎相对较好地实现了这一点，我相信微软有能力为 .NET 做同样的事情。但问题仍然存在：他们为什么要这样做？

远离字节码类型的虚拟机，您还拥有诸如 VMWare、Virtual PC 等可以在硬件级虚拟处理器上运行代码的东西。其中一些需要在后台使用相同的处理器，其他（我相信像 VirtualBox 和 Bochs）在不同的处理器之上运行虚拟处理器。

我还没有真正看到的是主机和虚拟环境之间的无缝集成。VMWare 在两者之间的拖放是可以的，但如果能够在 x86 之上托管 SPARC 环境并且基本上让 SPARC 应用程序看起来与 x86 应用程序完全一样（类似于 Cygwin 的 X-windows基于 - 的应用程序看起来就像普通的 Windows 窗口。

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T10:31:25.223

问题总是你会得到一个低于标准的应用程序。

如果一个应用程序需要在所有平台上运行，那么您最终会得到一个无法正确适配任何平台的 GUI，以及一个缺少平台上预期功能的应用程序，即仅存在于一个平台上的功能 - 在 OS X 上，您希望与所有最新功能，smae 适用于 Windows 和 *nix

我猜你能得到的最接近的是拥有跨平台的核心功能，然后在上面构建 GUI 和任何其他特定于平台的功能。

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T10:37:44.087

正如其他人已经提到的，这是可能的（尤其是基于 JVM 的语言和 Python），并且许多人确实创建了跨平台应用程序。令我吃惊的是坚持使用平台相关框架的人数之多。显然，它们的营销效果更好。

这些事情更多地与政治问题有关，而不是与技术问题有关。在实践中，跨平台开发最苛刻的技术问题来自低级硬件通信（驱动程序到特定设备等），但典型的应用程序无论如何都不需要直接与硬件通信。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T10:27:50.223

Microsoft 仅在 Windows 上实现了 .NET。因此，要让 .NET 应用程序在其他平台上运行，就需要一个新的实现。[Mono](http://www.mono-project.com)正在采取措施使这成为可能。当前版本运行大多数 .NET 2.0 程序集并支持许多特定于 Windows 的接口。

至于您的其余问题：重新实现其他所有人使用的所有 API 都很难，现有项目也不完整。[Wine](http://www.winehq.org)支持大多数 Windows 应用程序，但仅支持。[GNUstep](http://www.gnu.org/software/gnustep/)实现了大部分 OpenStep 规范，并且与 Mac OS 的 Cocoa API 有一些兼容性，但它的不完整令人痛苦，并且会持续很长时间。

如果每个人都使用一种标准的 API，也许情况会有所不同。但是，坦率地说，现有的所有 API 在某种程度上都很糟糕。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T12:20:17.803

> 为什么将 .NET windows 应用程序传递给 Mac 应用程序如此困难？

.NET 旨在作为程序员构建*Windows*程序的框架。.NET 的完整实现（由 MS 完成）仅适用于 Windows。似乎没有太大希望，这会改变。

为了获得更好的跨平台支持，您可能需要查看其他语言，例如 Java [1](http://en.wikipedia.org/wiki/Java)：

> Java 应用程序通常被编译为可以在任何 Java 虚拟机 (JVM) 上运行的字节码

...这与 python 所做的非常相似[2](http://en.wikipedia.org/wiki/Python)：

> CPython 将 Python 程序编译成中间字节码，然后由虚拟机执行。

即使 .NET 做同样的事情[3](http://en.wikipedia.org/wiki/.NET_Framework)：

> 此运行时环境也是 .NET Framework 的一部分，称为公共语言运行时 (CLR)。CLR 提供应用程序虚拟机的外观

问题是“虚拟机”——由 MS 定义和构建——仅在 Windows 上可用：

> .NET 的完整形式仅在 Windows 平台上可用

* * *

## 回答 #9

> 赞同：-1
> 
>             
> 
> 时间：2009-02-13T10:29:31.720

好吧，您可以使用 Silverlight。至于 Silverlight 是否从浏览器转移到原生应用程序，这是微软的政治决定，而不是技术问题。Mono 的家伙们还致力于让 .net 构建 iPhone 二进制文件，因此毫无疑问将来会获得更多的跨平台。

Adobe Air、Java 和其他类似的东西也制作跨平台客户端应用程序 - 地狱，如果你真的想的话，你甚至可以用 C++ 做跨平台:-)

# c# - 使用多个“使用”，这如何影响性能？

> ID：545457
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-02-13T10:20:31.630
> 
>         
> 
> 标签：c#, clr

我不反对使用“Using”语句，但我想知道当我们在另一个中使用它时这会如何影响性能。

例如：

```
 using (test1 (type1))
        {
            using (test2(type2))
            {
                using (test2(type3))
                {
                }
            }
        } 
```

这将像这样在 IL 中翻译：

```
 try
        {
            try
            {
                try
                {
                }
                finally
                {
                }
            }
            finally
            {
            }
        }
        finally
        { 
        } 
```

这会增加程序集的大小，并且我相信会影响应用程序的性能，对吧？

我们不应该使用这个吗？

```
 type1 test1 = new type1;
        type2 test2 = new type2;
        type3 test3 = new type3;

        try
        {

        }
        finally
        {
          test1.Dispose;
          test2.Dispose;
          test3.Dispose;
        } 
```

* * *

## 回答 #1

> 赞同：25
> 
>             
> 
> 时间：2009-02-13T10:27:09.807

不，*不要*使用您的第二种形式。如果`test1.Dispose()`由于某种原因抛出异常，`test2.Dispose()`并且`test3.Dispose()`不会被调用。

性能差异（如果有的话）将是微观的。不要因为微不足道的表现而抛弃正确性:)

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2009-02-13T10:29:31.983

我认为您正在寻找以下内容：

```
using (test1(type1))
using (test2(type2))
using (test3(type3))
{
    // Code using test1/test2/test3 goes here.
} 
```

它相当于您问题中的第一个 try-finally 语句，但显然更具可读性。真的不用担心这里的表现；使用嵌套方法（正如之前的海报所指出的那样）是很好的设计实践和健壮的，另外还有易于阅读的代码（感谢 multi-using 语句）。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2009-02-13T10:27:16.530

我不认为担心程序集的大小是我们通常需要担心的，但要以编写更复杂的代码来维护代码为代价！

您的示例代码准确地说明了**为什么**我们需要编译器来生成它所做的代码。如果您对**new type2()**的调用失败，则永远不会调用**test1上的****Dispose**方法，这将导致资源泄漏。

 *** * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T10:22:40.423

除非抛出异常，否则 try/catch/finally 并不昂贵。即便如此，也有几个人（包括 Jon Skeet）说抛出的异常并没有那么昂贵。

话虽如此，显然您不应该对控制流使用异常。

# database - 与各种 RDBM 中的嵌入式 SQL 相比，存储过程的性能如何？

> ID：545461
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-13T10:22:00.753
> 
>         
> 
> 标签：database, performance, stored-procedures

根据我在 Z/OS 上使用 DB2 的经验，嵌入式 SQL 和存储过程之间没有区别，因为它们都被编译为本机代码。另一方面，我知道在 Oracle 中存在巨大差异——这是真的吗？在其他数据库中又如何？请提供一些链接来支持您的主张。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T10:29:15.463

`Embedded SQL`在 Oracle 中意味着您可以将 SQL 语句直接嵌入到您的`C/C++`代码中。有一个名为的工具`Pro*C`可以解析这些语句并将它们包装到`OCI`调用中。

这当然是一个客户端工具，我看不出它与服务器端存储过程相比如何。

如果你的意思是“嵌入式 SQL” `anonymous blocks`，那么当第一次调用一个块时，性能会有所下降，因为它需要被编译。存储过程在数据库中保持预编译。

一旦第一次调用匿名块并保存在缓存中，就没有性能差异。

**PS**有一种叫做本机编译的东西，`PL/SQL`它允许编译过程并将它们存储在磁盘上的共享库中。

这只能应用于存储过程，但它只适用于`CPU`密集型任务，而不适用于复杂`SQL`查询。

# java - 如何从 Java 中在服务器上启动批处理文件？

> ID：545463
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-13T10:22:13.873
> 
>         
> 
> 标签：java

是否可以允许客户端单击按钮，然后触发批处理文件在服务器上运行？我可以从服务器机器内运行服务器上的批处理文件，但我想在服务器上运行它，但从网站的客户端机器启动。我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T10:26:23.287

您的客户端如何与您的服务器交互是一个问题。无论如何，我假设一个 servlet 应用程序，虽然它可能被认为是一个 Web 应用程序，但是您将拥有一个作为客户端的浏览器，不是吗。

因此，在收到该特定请求后，只需运行假设执行批处理文件的方法。问题出在哪里。或者，如果您能说出您的应用程序的架构，以及客户端如何与服务器交互，我们可以详细说明。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T11:24:27.327

是的你可以。

假设它是一个 Web 应用程序，您可以让 JSP 页面/Servlet 执行您在服务器机器上运行的相同操作。

唯一的问题是您可能必须异步执行它（即您的 servlet 提出执行批处理任务的请求）并返回以更新 UI。如果您的批处理任务是一项长期运行的任务，这一点尤其重要。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T12:37:21.270

您可以使用 ProcessBuilder 从 servlet 调用批处理文件。

```
 ProcessBuilder pb = new ProcessBuilder("myCommand", "myArg1", "myArg2");
 Map<String, String> env = pb.environment();
 env.put("VAR1", "myValue");
 env.remove("OTHERVAR");
 env.put("VAR2", env.get("VAR1") + "suffix");
 pb.directory("myDir");
 Process p = pb.start(); 
```

[http://www.java-tips.org/java-se-tips/java.util/from-runtime.exec-to-processbuilder.html](http://www.java-tips.org/java-se-tips/java.util/from-runtime.exec-to-processbuilder.html)

编辑：您始终可以使用 p.getOutputStream()、p.getErrorStream() 读取进程的 stdout、stderr 和返回码。如果您需要在标准输入上写入，请使用 p.getInputStream()。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T21:20:10.750

早在“应用程序服务器”出现之前，Web 服务器就一直在运行基于客户端输入的服务器端脚本。这就是 CGI 的全部意义所在。不用说，当人们开始开发应用服务器时，他们肯定会在其中包含一些访问 Web 开发人员已经习惯的 CGI 功能的方式。

因此，您的问题的答案是，您几乎可以肯定可以根据客户端输入运行服务器端脚本。回答你的问题的问题是你还没有真正告诉任何人你的服务器端是什么。了解您的应用程序服务器所使用的操作系统对于给您一个完整的答案也很重要。

由于您的问题发布在 Java 标记下，因此每个人都假设您的服务器端是某个 J2EE 应用程序服务器。如果是这种情况，那么到目前为止的所有答案都为您需要做什么提供了很好的线索。（如果您没有在应用程序服务器上运行，那么您需要查看您的 Web 服务器的 CGI 功能（并将您的标签更改为 CGI）。）

Scott 的回答告诉您执行脚本或任何可执行文件的旧方法。Kalecser 的回答告诉您更新的“犹太洁食”方式。gnlogic 和 Vinegar 建议您的应用程序服务器可能会为此提供内置 API。

gnlogic 还提出了同步点。我无法评论未知的应用服务器 API，但 Runtime.exec 和 ProcessBuilder 都创建了一个异步进程。处理异步进程是一个完全不同的问题。

* * *

## 回答 #5

> 赞同：-1
> 
>             
> 
> 时间：2009-02-13T12:24:31.193

听起来你真正想要的是***exec***调用。如：

```
 Runtime rt = Runtime.getRuntime();
    try {
        rt.exec("ifconfig");
    } catch (IOException e) {
        e.printStackTrace();
    } 
```

从您的按钮单击或您触发事件的任何内容中调用它。我不知道如何收到任何回报，但那是另一回事。

# yahoo-pipes - Yahoo Pipes，在运行时根据需要使用尽可能多的 URL 配置管道

> ID：545487
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-13T10:27:52.487
> 
>         
> 
> 标签：yahoo-pipes, aggregators

我很难做一些我认为需要 5 分钟的事情。

我想创建一个**在运行时**根据需要接受尽可能多的 URL 的管道。我知道如何在编辑器中组合许多 URL，但我想要一个任何人都可以根据自己的需要进行配置的管道。

我以为我可以在循环中使用 URL 输入模块，但这是不可能的。然后我考虑使用文本输入模块并将其链接到 URL 构建器，但这也不是我想要的。

我必须在这里遗漏一些非常明显的东西。

谢谢，

胡安

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-15T15:44:04.540

最简单的方法是接受一个外部 URL 列表，即包含参数 URL 的 URL。然后您接受源 URL 作为管道的参数。

我创建了[这个示例](http://pipes.yahoo.com/pipes/pipe.info?_id=4gMMJnb73RGt30tTPxJ3AQ)来帮助您入门，它合并了 URL 中列出的提要。

另一种选择是获取一个字符串参数，然后在空格、逗号或其他分隔符上对其进行标记，然后对每个 URL 执行您需要执行的任何操作。[样品管](http://pipes.yahoo.com/pipes/pipe.info?_id=KGOw7qn73RGup0S4rbQIDg)。

# java - JAX-RPC 处理程序发生异常

> ID：545496
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-13T10:32:30.197
> 
>         
> 
> 标签：java, soap, jakarta-ee, glassfish, jax-rpc

我有一些使用 JAX-RPC 构建的 SOAP Web 服务。这些工作正常。但是一旦我添加了一个处理程序，我就会得到一个异常。从 webservices.xml 中删除绑定后，一切都会再次正常运行。

奇怪的是，处理程序本身不包含在异常的堆栈跟踪中。我还注意到，在引发异常之前调用了处理程序的`init`和方法。`getHeaders`

使用以下 xml 将处理程序添加到 webservices.xml：

```
<handler>
  <handler-name>My Message Handler</handler-name>
  <handler-class>kpn.MyMessageHandler</handler-class>
</handler> 
```

处理程序本身只是一个存根，由 IDE 从接口生成，所以我不会包括整个实现：

```
public class MyMessageHandler implements javax.xml.rpc.handler.Handler {
  @Override
  public boolean handleRequest(MessageContext context) {
    System.out.println("handel-Request");
    return true;
  }
  ...
} 
```

这实际上在我的日志记录中生成了三个异常（具有完全相同的时间戳）。由于篇幅关系，我只包括一部分。

```
Log Level  WARNING 
Logger  javax.enterprise.system.container.web 
Message ID  preWebHandlerError java.lang.ClassCastException 
Complete Message  com.sun.xml.messaging.saaj.soap.impl.TextImpl cannot be cast to javax.xml.soap.SOAPElement at
    com.sun.xml.rpc.server.StreamingHandler.getOpcodeForRequestMessage(StreamingHandler.java:657) at
    com.sun.enterprise.webservice.WsUtil.getInvMethod(WsUtil.java:1277) at
    com.sun.enterprise.webservice.ServletPreHandler.handleRequest(ServletPreHandler.java:86) at
    com.sun.xml.rpc.client.HandlerChainImpl.handleRequest(HandlerChainImpl.java:103) at
    com.sun.xml.rpc.server.StreamingHandler.callRequestHandlers(StreamingHandler.java:962) at
    com.sun.xml.rpc.server.StreamingHandler.preHandlingHook(StreamingHandler.java:868) at
    kpn.kpc.SOAPKPCReadCustomerClassification_v01PortType_Tie.preHandlingHook(SOAPKPCReadCustomerClassification_v01PortType_Tie.java:242) at
    com.sun.xml.rpc.server.StreamingHandler.handle(StreamingHandler.java:127) at
    com.sun.xml.rpc.server.http.JAXRPCServletDelegate.doPost(JAXRPCServletDelegate.java:467) at
    com.sun.enterprise.webservice.JAXRPCServlet.doPost(JAXRPCServlet.java:119) at
    javax.servlet.http.HttpServlet.service(HttpServlet.java:738) at
    ...

Log Level  SEVERE 
Logger  com.sun.xml.rpc.server 
Message ID  com.sun.xml.messaging.saaj.soap.impl.TextImpl cannot be cast to javax.xml.soap.SOAPBodyElement java.lang.ClassCastException 
Complete Message  com.sun.xml.messaging.saaj.soap.impl.TextImpl cannot be cast to javax.xml.soap.SOAPBodyElement at
    com.sun.enterprise.webservice.WsUtil.throwSOAPFaultException(WsUtil.java:1312) at
    com.sun.enterprise.webservice.WsUtil.throwSOAPFaultException(WsUtil.java:1288) at
    com.sun.enterprise.webservice.ServletPreHandler.handleRequest(ServletPreHandler.java:99) at
    ...

Log Level  SEVERE 
Logger  com.sun.xml.rpc.server 
Message ID  JAXRPCTIE01 
Complete Message  caught exception while handling request: java.lang.ClassCastException: com.sun.xml.messaging.saaj.soap.impl.TextImpl cannot be cast to javax.xml.soap.SOAPBodyElement java.lang.ClassCastException: com.sun.xml.messaging.saaj.soap.impl.TextImpl cannot be cast to javax.xml.soap.SOAPBodyElement at
    com.sun.enterprise.webservice.WsUtil.throwSOAPFaultException(WsUtil.java:1312) at
    com.sun.enterprise.webservice.WsUtil.throwSOAPFaultException(WsUtil.java:1288) at
    com.sun.enterprise.webservice.ServletPreHandler.handleRequest(ServletPreHandler.java:99) at
    ... 
```

有人有解决这个问题的想法吗？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T13:39:36.770

Your libraries are in an incompatible state.

The important part is: java.lang.ClassCastException: 
 `com.sun.xml.messaging.saaj.soap.impl.TextImpl cannot be cast to javax.xml.soap.SOAPBodyElement` 

This means that either the jre contains an implementation for javax.xml (ie jre 6.0), or the glassfish contains a runtime with a newer implementation or you include a library that is not compatible.

Someone broke the xml implementation between 1.4 -> 1.5\. I suggest a search in all the jars for javax.xml.soap.SOAPBodyElement. You'll find duplicates which are not compatible (eg xml-beans stax or something).

# cocoa-touch - 如何让我的应用程序在导航期间防止切换回纵向模式？

> ID：545497
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-13T10:33:12.177
> 
>         
> 
> 标签：cocoa-touch

当用户移动他们的 iPhone 时，我的视图在纵向和横向模式之间适当切换，使用以下代码没有问题：

```
-(BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    // Return YES for supported orientations
return (interfaceOrientation == UIInterfaceOrientationPortrait || 
        interfaceOrientation == UIInterfaceOrientationLandscapeLeft ||
        interfaceOrientation == UIInterfaceOrientationLandscapeRight);
} 
```

问题是，如果他们在旋转到横向后按下一个按钮将他们带到另一个屏幕，那么下一个屏幕将返回纵向模式并且状态栏正确地保持在横向模式。如何在 onviewload 期间检测 iPhone 当前处于哪种模式，以便我可以运行更改以适当地更改视图方向？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T11:01:35.213

在设备方向更改之前，您的视图控制器会发送此消息：

```
- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration 
```

toInterfaceOrientation 是旋转后应用程序用户界面方向的状态。

# .net - ADO.NET - 获取数据读取器值的最佳实践是什么？

> ID：545500
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-02-13T10:34:22.753
> 
>         
> 
> 标签：.net, ado

只是想知道获取数据读取器值的最佳实践是什么。例如：

我一直在这样做：

```
MyValue = Dr("ColumnName") 
```

但是注意到其他人在做：

```
MyValue = Dr.GetString("ColumnName") 
```

我很想知道第二种方法的好处

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-02-13T11:14:52.170

只有知道列的索引才能使用 DbDataReader.GetString(int) 方法。使用 DbDataReader.GetString("ColumnName") 是不可能的，因为没有这样的重载。即你有以下两种选择：

```
 string myValue1 = (string) Dr["ColumnName"];
 string myValue2 = Dr.GetString(columIndex); 
```

第一行在内部调用 DbDataReader.GetOrdinal("ColumnName")。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T11:13:45.340

一段时间以来，我一直在使用一个做类似事情的包装器，它很好地完成了这个技巧。

```
 RowHelper helper = new RowHelper(Dr);
     MyValue = helper.IntColumn("ColumnName"); 

```

这样做的好处是帮助程序将为 NULL 列返回预定义的默认值（这是可配置的）。我有所有主要 SQL 数据类型的方法。

为了回答您的问题，第二种方法有一些装箱/拆箱开销，但为典型的业务应用程序优化它可能会浪费您的时间。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T12:45:08.647

我为此做了几个通用的扩展方法：

```
public static class DataReaderExtensions
{
    public static T GetValueOrNull<T>(this IDataRecord reader, string fieldName)
        where T : class
    {
        int index = reader.GetOrdinal(fieldName);
        return reader.IsDBNull(index) ? null : (T)reader.GetValue(index);
    }
} 
```

你明白了……我也有一个`GetValueOrDefault`for 值类型。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T10:37:04.930

DataReader 返回类型对象，因此您需要将 DataReader 中的值转换为 MyValue 的任何类型，在 int 的情况下

```
MyValue = (int)Dr("ColumnName"); 
```

或者

```
MyValue = Convert.ToInt(Dr("ColumnName")); 
```

或者

```
MyValue = Dr("ColumnName").ToInt(); 
```

我不确定性能差异，但我认为这可以解释为微优化，除非处理非常大的数据集

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-10-20T15:34:58.713

使用[自动映射](http://elegantcode.com/2009/10/16/mapping-from-idatareaderidatarecord-with-automapper/)器：

```
var dataReader = ... // Execute a data reader
var views = Mapper.Map<IDataReader, IEnumerable<SomeView>>(_dataReader); 
```

# sql - 就应用程序和测试中的静态数据提供建议

> ID：545502
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-13T10:35:06.790
> 
>         
> 
> 标签：sql, persistence, static-data

我正在一个非常典型的 asp.net 网站上工作，并使用 sql server 2005 作为数据库。我创建了一个模型 dll，其中包含应用程序的典型业务逻辑。

应用程序依赖于存储在数据库中的一些静态数据，缺乏更好的持久性存储，但由于应用程序依赖于这些数据才能正常运行，我觉得这些是模型的属性，应该始终可以访问应用程序，我应该能够运行单元/集成测试以确保这些数据可用，这有点违背对数据库进行单元测试的原则。

那么有没有人有处理模型持久静态数据的好方法？我也一直在考虑使用嵌入式 xml 文件，但这也有明显的缺点。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T10:43:18.177

如果这些属性很少，彼此无关，并且可以表示为简单的键值对，我会将它们作为 appSettings 放在配置文件（web.config）中。

# c++ - 如何更改 Windows Mobile 的 MFC 对话框上的字体/颜色？

> ID：545504
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-13T10:36:38.283
> 
>         
> 
> 标签：c++, windows-mobile, mfc

有谁知道如何在 Windows Mobile 的 MFC 对话框的静态文本和其他控件上设置字体和颜色？

我在哪里可以获得支持的字体列表？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T13:21:46.577

颜色通过[SetBkColor](http://msdn.microsoft.com/en-us/library/aa920825.aspx)和[SetTextColor](http://msdn.microsoft.com/en-us/library/aa911461.aspx)更改。

[这是枚举字体的示例](http://blog.opennetcf.com/ctacke/2007/06/22/EnumeratingAndAddingFontsInWindowsCE.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T18:18:53.883

这取决于控件，但请查看以 WM_CTLCOLOR 开头的 Windows 消息（例如，WM_CTLCOLORSTATIC）。对于字体，请使用 EnumFontFamilies。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-14T02:38:15.853

[http://www.wikihow.com/Change-Fonts-in-Windows-Mobile-2003-Second-Edition](http://www.wikihow.com/Change-Fonts-in-Windows-Mobile-2003-Second-Edition)

# actionscript-3 - 将 ISO8851 文本文件加载到 TextField()

> ID：545508
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-13T10:37:47.423
> 
>         
> 
> 标签：actionscript-3, flex3

如何将 .txt ( ISO8859-1 ) 文本文件从 flex 加载到 TextField()？文件与 .SWF 文件位于同一文件夹中

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T12:12:56.447

*从这里删除了旧帖子，详情请参阅历史记录。*

我为你找到了答案。好消息：不需要 PHP 魔法！这是如何做到的：

```
var ldr:URLLoader = new URLLoader();
ldr.dataFormat = URLLoaderDataFormat.BINARY;
ldr.addEventListener(IOErrorEvent.IO_ERROR, errorHandler);
ldr.addEventListener(SecurityErrorEvent.SECURITY_ERROR, errorHandler);
ldr.addEventListener(Event.COMPLETE, function (event:Event):void {
    var bytes:ByteArray = ByteArray(ldr.data); 
    var text:String = bytes.readMultiByte(bytes.length, "iso-8859-1");
    ...
});
ldr.load(new URLRequest('http://server.dom/path/to/your-file')); 
```

您需要用适当的编码替换“iso-8859-1”。您可以在[此处找到有效编码列表](http://livedocs.adobe.com/flex/2/langref/charset-codes.html)。

# javascript - Ajax onSuccess 回调，而对 ajax 调用没有任何控制

> ID：545510
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-13T10:38:21.120
> 
>         
> 
> 标签：javascript, ajax, asp.net-ajax, jquery, dotnetnuke-5

我有一个简单的 JS 函数，当 AJAX 调用成功时需要调用它，但是我无法控制 AJAX 调用，因为框架（DNN5）处理了所有这些。

如何在 AJAX 成功时调用我的函数？

我使用的是 DNN5 和 jQuery，如果你不熟悉 DNN，就假设页面上的所有控件都包裹在 asp:UpdatePanel 中。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T10:55:50.610

我不熟悉 DNN5，但我熟悉 UpdatePanels。您能否在 ASP.NET AJAX 中挂钩异步回发的客户端事件，即向 PageRequestManager endRequest 事件添加事件处理程序。

举个例子，

```
 var prm = Sys.WebForms.PageRequestManager.getInstance();

  prm.add_endRequest(EndRequest);

  // runs when async postback completes.
  function EndRequest(sender, args)
  {
  if (sender._postBackSettings.sourceElement.id) // the id of the element that raised the postback that is completing
      {
        //Do what you need to do here
      }  
  } 
```

**编辑：**

考虑一下，我不确定这是否适合您。这将取决于 DNN5 如何在 ASP.NET 中执行 AJAX 调用

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T11:01:37.087

@Russ：刚刚看到你的答案，我会测试它，如果它有效，我会接受它。

在发布这个问题后不久，我回忆起我在之前的项目中遇到了类似的问题，所以我回去并从那里获取代码：

```
<script type="text/javascript">

Sys.Net.WebRequestManager.add_completedRequest(onComplete);

function onComplete(sender, args) { //call JS here
}

function pageUnload() {
    Sys.Net.WebRequestManager.remove_completedRequest(onComplete);
}

</script> 
```

# c# - 在 WPF 中制作图表的最佳方法是什么？（或者通常也适用于 WPF）

> ID：545513
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-02-13T10:38:39.077
> 
>         
> 
> 标签：c#, .net, wpf

所以我在 WPF 中制作了一个软件，我希望能够从我存储的数据中制作图表。只是带有 x 和 y 轴的线图。理想情况下，我希望他们对他们有一个很好的优雅简洁。  

我知道 WPF 不附带图表，并且我在 WinForms 项目中尝试过 ZedGraph，但坦率地说，我认为它看起来很难看。

在 WPF 中制作简单、优雅的图形的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-08-13T20:06:24.753

试试[VisiFire](http://www.VisiFire.com)。这看起来不错的样子。它运作良好。

![在此处输入图像描述](https://i.stack.imgur.com/kUZH4.png)

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-02-13T10:43:12.777

您可以[在 WPF 上运行](http://blogs.msdn.com/llobo/archive/2008/11/18/silverlight-chart-control-running-in-wpf.aspx)Silverlight 图表控件，它们非常好（而且免费）。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-08-28T17:31:59.733

WPF 工具包可用。它是免费的 CodePlex。它包含一些不错的图表类。

可以在[这里](http://wpf.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=29117)下载。[这里](http://blogs.msdn.com/delay/archive/2009/06/25/wpf-charting-it-s-official-june-2009-release-of-the-wpf-toolkit-is-now-available.aspx)有一些评论。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T10:43:09.110

微软从 Dundas 购买了一些 IP，并将他们的 winforms/asp.net 图表作为[Microsoft Chart Controls提供](http://www.microsoft.com/downloads/details.aspx?FamilyId=130F7986-BF49-4FE5-9CA8-910AE6EA442C&displaylang=en)

由于它们将渲染为图像，因此它们应该无需太多努力即可集成。

我已经使用了底层的 dundas 功能并且喜欢它，所以会假设这些是受人尊敬的免费控件。

# emulation - 无法让 Altair（模拟器）从磁盘 0 运行映像

> ID：545516
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-13T10:40:12.333
> 
>         
> 
> 标签：emulation

我正在使用[Altair 模拟器](http://www.altair32.com)，在文档中它说：“将地址 0xff00 切换到前面板并切换 RUN”以从磁盘加载图像。

因此，如果您将十六进制 0xff00 转换为十进制，您将得到 65280，因此我在模拟器上选择了该数字并单击运行，但它不想运行链接到我的磁盘 0 的图像。

任何可以提供帮助的老歌将不胜感激。:)

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T11:45:49.443

您的 altair32.ini 文件包含什么？包装随附的有：

```
[fileformat]
version=3.0
[windows]
main=org=8,20, size=644,339
[ROMS]
ROM0=88dskrom,0000,0 
```

但我的理解是磁盘引导 ROM 应该放在 RAM 的最后 256 字节。由于我没有运行 Windows，因此无法对其进行测试，但我会将最后一行更改为：

```
ROM0=88dskrom,ff00,0 
```

再试一次。

# cocoa-touch - 默认情况下缩放 WebView

> ID：545524
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-13T10:44:18.593
> 
>         
> 
> 标签：cocoa-touch, webkit

默认情况下是否可以放大 WebView。我试图在我的应用程序中放置和广告，并希望它默认缩放到 100%，以便填充空间。

能够禁用缩放也是一个好处，但我不能禁用所有交互，因为我希望他们能够单击链接

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T13:57:33.387

我没有尝试过，但是，如果您可以控制 HTML，请确保它的大小正确并使用`UIWebview`'s  `scalesPageToFit`属性。如果没有，您可以获取 HTML 并在您的服务器或应用程序中对其进行按摩，然后再将其显示在`UIWebview`

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T11:53:55.213

我没有找到解决缩放问题的方法，但我确实设法调整了我的 html 横幅代码，以使用 head 标签中的以下代码强制它显示正确的大小：

```
<meta name="viewport" content="width=320px,height=65px" /> 
```

# java - 目前是否可以通过 Maven 构建 Eclipse 插件并具有良好的 IDE 集成？

> ID：545531
> 
>         
> 
> 赞同：15
> 
>         
> 
> 时间：2009-02-13T10:50:43.900
> 
>         
> 
> 标签：java, eclipse, maven-2, build, eclipse-rcp

我目前正在评估 maven 以改进我们的构建过程。到目前为止，普通 jar 文件的构建和创建工作正常，尽管我对 Maven IDE 并不完全满意。

我现在正处于构建项目所需的所有库的地方，并且我将继续进行 Eclipse RCP 项目。现在我不知道该怎么做。

在继续实际的 RCP 部分之前，我需要先构建一些插件。因此我实际上有3个问题。

我想构建这些插件，唯一真正的解决方案似乎是 maven-bundle-plugin： http: [//felix.apache.org/site/apache-felix-maven-bundle-plugin-bnd.html](http://felix.apache.org/site/apache-felix-maven-bundle-plugin-bnd.html)

但是，对于良好的 IDE 集成，我还需要应该自动生成的适当文件（plugin.xml、build.properties 等）。

对于构建 RCP 部件，到目前为止，似乎唯一的解决方案是 pde-maven-plugin [http://mojo.codehaus.org/pde-maven-plugin/](http://mojo.codehaus.org/pde-maven-plugin/)据我所知，它使用 ant-pde . 这很愚蠢，不是吗？

我能找到的唯一其他东西是 tycho ( [http://www.sonatype.com/people/2008/11/building-eclipse-plugins-with-maven-tycho/](http://www.sonatype.com/people/2008/11/building-eclipse-plugins-with-maven-tycho/) )，但这还处于非常早期的阶段。

再一次，一个好的 Eclipse 集成是必要的。我真的，真的，真的不想指定依赖两次。

那么如何使用 maven 构建 Eclipse RCP 项目呢？

**更新**

目前，似乎没有这样的解决方案可用。Tycho 看起来很有前途，但我浪费了 2 天时间并没有让它运行（此时的当前版本）。也许半年左右就可以准备好。

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-02-13T19:06:36.220

不，没有这样的工具。第谷也是我所知道的唯一方法。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-20T08:42:51.343

我使用[m2eclipse](http://m2eclipse.codehaus.org/)，它非常适合我的需求。您在 pom.xml 中指定依赖项，它们会自动在 Eclipse 的构建路径中考虑在内。

警告：我不能告诉任何关于 RCP 的事情（从来没有为那个平台构建过任何东西）。

最好的祝福，

西里尔

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-20T23:29:18.467

您是否一心想要使用 maven 构建您的 RCP 应用程序？我问这个是因为，根据我使用 maven 构建比琐碎的 RCP 应用程序更多的东西的经验，可能会很痛苦。当我开始研究 RCP 应用程序时，我最初使用 maven 作为构建解决方案进行了调查，但发现当时在 maven 中对 eclipse 构建的支持非常基础。此外，我的一些同事正在我们公司的另一个基于 RCP 的项目中使用 maven，虽然对 eclipse 的支持变得更好，但他们不得不跳过一些障碍才能让它按照自己的喜好工作。所以，我的意见是，目前，坚持为您的 RCP 应用程序使用基于 ant 的 pde 构建。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2017-12-01T14:35:04.623

如今，Tycho 允许基于构建的捆绑包的清单（必需的捆绑包、导入的包等）解决依赖关系。

此外，Tycho 可以配置为使用[目标平台](https://wiki.eclipse.org/Tycho/Target_Platform#Target_platform_configuration)进行构建。这允许对 maven 和 pde 构建使用相同的目标平台。

从 v0.24.0 开始，Tycho 甚至可以构建[无 POM 的](https://wiki.eclipse.org/Tycho/Release_Notes/0.24#POM-less_Tycho_builds)插件和功能，避免重复版本和 artifactId 元数据。

鉴于上述情况，考虑到即使是[Eclipse 平台也使用它](https://wiki.eclipse.org/Platform-releng/Platform_Build)构建了几年，Maven Tycho 是目前构建无头 RCP 的最佳方式。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-02-17T08:10:33.753

在我们的项目中，我们将目标平台和应用程序插件分开。简而言之：我们使用 Maven 构建目标平台，而应用程序插件使用 PDE 构建。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-02-17T14:32:00.547

我用了一段时间的[Mavenide](http://sourceforge.net/projects/mevenide/)，还可以。不过不知道今天怎么样。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2012-04-26T23:07:30.767

[第谷](http://www.eclipse.org/tycho/)做你需要的。现在在 2012 年，它是一套成熟且可用的 maven 插件。我只能推荐它。

自 2009 年以来，文档的质量显然没有太大变化。让 Tycho 运行可能会很困难。我们设法了解了 Tycho，并且我们已经成功地使用它来构建一个相当大的 Eclipse RCP 应用程序超过一年半了。我们采用了清单优先的方法，其中所有插件（项目）依赖项都在 MANIFEST.MF 中定义。我们构建的最终产品是一个可执行的应用程序，也是一个易于更新的[p2 站点](http://www.eclipse.org/equinox/p2/)。全部由 Maven 构建完成。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2017-12-09T18:19:19.593

如果您构建 Eclipse 插件或应用程序 (RCP) Maven Tycho 是构建它的推荐方式。

它在解决 osgi 依赖项方面非常聪明。你可以参考我的[Maven Tycho 教程](http://www.ancitconsulting.com/tutorials_maventycho.html) 

Maven Tycho 需要安装 m2eclipse 和 Tycho 配置器。

原型应该是 eclipse-plugin 或 eclipse-feature 或 eclipse-repository

# c++ - 创建 STL - 身份映射的最简单方法是什么？

> ID：545532
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-13T10:51:19.123
> 
>         
> 
> 标签：c++, stl, map

我想初始化一个映射 - 对象“id”，其身份从 0 到 n-1，即     

```
 id[0] = 0
 id[1] = 1
 .
 .
 id[n-1] = n-1 
```

有没有一种简单的方法 - 单线，地图对象内的方法，只是非常简单的东西 - 可以做到吗？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-02-13T12:41:18.190

出什么问题了

```
for(unsigned int i = 0; i < n; ++i)
    id[i] = i; 
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T11:00:01.257

你可以使用

```
template <class InputIterator>
map(InputIterator f, InputIterator l,
    const key_compare& comp) 
```

构造函数的形式，但您需要构建一个 InputIterator 用作您想要的范围内的生成器函数。这比仅仅使用 for 循环要多得多。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T14:28:23.877

使用键是简单索引的映射似乎有点奇怪。你确定你不能使用向量吗？这样做，您可以使用[`boost::counting_iterator`](http://www.boost.org/doc/libs/1_37_0/libs/iterator/doc/counting_iterator.html)填充向量：

```
std::vector<int> v(boost::counting_iterator<int>(0), 
                   boost::counting_iterator<int>(N-1));
// v is filled with integers from 0 to N-1 
```

但是，与简单的 for 循环相比，我不确定这是否是一个巨大的收获。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-16T19:08:09.470

寻找 std::iota 作为数字库的一部分（C++0x 功能）：

```
template <ForwardIterator Iter, HasPreincrement T>
requires OutputIterator<Iter, const T&>
void iota(Iter first, Iter last, T value); 
```

# c# - 延迟函数调用

> ID：545533
> 
>         
> 
> 赞同：104
> 
>         
> 
> 时间：2009-02-13T10:51:41.150
> 
>         
> 
> 标签：c#, function, delay

有没有一种很好的简单方法可以在让线程继续执行的同时延迟函数调用？

例如

```
public void foo()
{
    // Do stuff!

    // Delayed call to bar() after x number of ms

    // Do more Stuff
}

public void bar()
{
    // Only execute once foo has finished
} 
```

我知道这可以通过使用计时器和事件处理程序来实现，但我想知道是否有标准的 c# 方法来实现这一点？

如果有人好奇，那么需要这样做的原因是 foo() 和 bar() 位于不同的（单例）类中，我需要在特殊情况下相互调用。问题是这是在初始化时完成的，所以 foo 需要调用 bar ，它需要一个正在创建的 foo 类的实例......因此延迟调用 bar() 以确保 foo 完全实例化......读回来几乎是糟糕的设计！

***编辑***

我会在建议下接受关于糟糕设计的观点！我一直认为我可以改进系统，但是，这种讨厌的情况*只*发生在抛出异常时，其他时候两个单例很好地共存。我认为我不会弄乱讨厌的异步模式，而是要重构其中一个类的初始化。

* * *

## 回答 #1

> 赞同：228
> 
>             
> 
> 时间：2015-12-24T23:20:10.353

感谢现代 C# 5/6 :)

```
public void foo()
{
    Task.Delay(1000).ContinueWith(t=> bar());
}

public void bar()
{
    // do stuff
} 
```

* * *

## 回答 #2

> 赞同：103
> 
>             
> 
> 时间：2011-07-11T06:12:22.300

我自己一直在寻找这样的东西 - 我想出了以下内容，虽然它确实使用了一个计时器，但它只使用一次来进行初始延迟，并且不需要任何`Sleep`调用......

```
public void foo()
{
    System.Threading.Timer timer = null; 
    timer = new System.Threading.Timer((obj) =>
                    {
                        bar();
                        timer.Dispose();
                    }, 
                null, 1000, System.Threading.Timeout.Infinite);
}

public void bar()
{
    // do stuff
} 
```

（感谢[Fred Deschenes](https://stackoverflow.com/users/912440/fred-deschenes)在回调中设置计时器的想法）

* * *

## 回答 #3

> 赞同：15
> 
>             
> 
> 时间：2014-03-05T18:09:07.230

除了同意之前评论者的设计意见之外，没有一个解决方案对我来说足够干净。.Net 4 提供[`Dispatcher`](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher%28v=vs.100%29.aspx)和[`Task`](http://msdn.microsoft.com/en-us/library/system.threading.tasks.task%28v=vs.100%29.aspx)类使得**在当前线程上**延迟执行非常简单：

```
static class AsyncUtils
{
    static public void DelayCall(int msec, Action fn)
    {
        // Grab the dispatcher from the current executing thread
        Dispatcher d = Dispatcher.CurrentDispatcher;

        // Tasks execute in a thread pool thread
        new Task (() => {
            System.Threading.Thread.Sleep (msec);   // delay

            // use the dispatcher to asynchronously invoke the action 
            // back on the original thread
            d.BeginInvoke (fn);                     
        }).Start ();
    }
} 
```

对于上下文，我使用它来消除`ICommand`绑定到 UI 元素上的鼠标左键的抖动。用户正在双击，这造成了各种破坏。（我知道我也可以使用`Click`/`DoubleClick`处理程序，但我想要一个与`ICommand`s 全面配合的解决方案）。

```
public void Execute(object parameter)
{
    if (!IsDebouncing) {
        IsDebouncing = true;
        AsyncUtils.DelayCall (DebouncePeriodMsec, () => {
            IsDebouncing = false;
        });

        _execute ();
    }
} 
```

* * *

## 回答 #4

> 赞同：7
> 
>             
> 
> 时间：2009-02-13T10:57:29.157

听起来对这些对象的创建及其相互依赖性的控制需要在外部进行控制，而不是在类本身之间进行控制。

* * *

## 回答 #5

> 赞同：5
> 
>             
> 
> 时间：2009-02-13T10:58:57.140

这确实是一个非常糟糕的设计，更不用说单例本身就是糟糕的设计。

但是，如果您确实需要延迟执行，您可以执行以下操作：

```
BackgroundWorker barInvoker = new BackgroundWorker();
barInvoker.DoWork += delegate
    {
        Thread.Sleep(TimeSpan.FromSeconds(1));
        bar();
    };
barInvoker.RunWorkerAsync(); 
```

但是，这将`bar()`在单独的线程上调用。如果您需要调用`bar()`原始线程，您可能需要将`bar()`调用移动到`RunWorkerCompleted`处理程序或使用`SynchronizationContext`.

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T10:58:04.787

好吧，我必须同意“设计”这一点……但是您可能可以使用监视器来让一个人知道另一个人何时超过了关键部分……

```
 public void foo() {
        // Do stuff!

        object syncLock = new object();
        lock (syncLock) {
            // Delayed call to bar() after x number of ms
            ThreadPool.QueueUserWorkItem(delegate {
                lock(syncLock) {
                    bar();
                }
            });

            // Do more Stuff
        } 
        // lock now released, bar can begin            
    } 
```

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2012-01-10T15:06:30.363

```
public static class DelayedDelegate
{

    static Timer runDelegates;
    static Dictionary<MethodInvoker, DateTime> delayedDelegates = new Dictionary<MethodInvoker, DateTime>();

    static DelayedDelegate()
    {

        runDelegates = new Timer();
        runDelegates.Interval = 250;
        runDelegates.Tick += RunDelegates;
        runDelegates.Enabled = true;

    }

    public static void Add(MethodInvoker method, int delay)
    {

        delayedDelegates.Add(method, DateTime.Now + TimeSpan.FromSeconds(delay));

    }

    static void RunDelegates(object sender, EventArgs e)
    {

        List<MethodInvoker> removeDelegates = new List<MethodInvoker>();

        foreach (MethodInvoker method in delayedDelegates.Keys)
        {

            if (DateTime.Now >= delayedDelegates[method])
            {
                method();
                removeDelegates.Add(method);
            }

        }

        foreach (MethodInvoker method in removeDelegates)
        {

            delayedDelegates.Remove(method);

        }

    }

} 
```

用法：

```
DelayedDelegate.Add(MyMethod,5);

void MyMethod()
{
     MessageBox.Show("5 Seconds Later!");
} 
```

* * *

## 回答 #8

> 赞同：2
> 
>             
> 
> 时间：2018-04-20T15:50:56.197

这将适用于旧版本的 .NET
缺点：将在自己的线程中执行

```
class CancellableDelay
    {
        Thread delayTh;
        Action action;
        int ms;

        public static CancellableDelay StartAfter(int milliseconds, Action action)
        {
            CancellableDelay result = new CancellableDelay() { ms = milliseconds };
            result.action = action;
            result.delayTh = new Thread(result.Delay);
            result.delayTh.Start();
            return result;
        }

        private CancellableDelay() { }

        void Delay()
        {
            try
            {
                Thread.Sleep(ms);
                action.Invoke();
            }
            catch (ThreadAbortException)
            { }
        }

        public void Cancel() => delayTh.Abort();

    } 
```

用法：

```
var job = CancellableDelay.StartAfter(1000, () => { WorkAfter1sec(); });  
job.Cancel(); //to cancel the delayed job 
```

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2012-01-26T14:36:31.413

我虽然完美的解决方案是让计时器处理延迟的动作。FxCop 不喜欢间隔时间少于一秒。我需要延迟我的操作，直到我的 DataGrid 完成按列排序之后。我认为一次性计时器（AutoReset = false）将是解决方案，并且效果很好。而且，FxCop 不会让我压制警告！

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T10:58:36.687

除了使用计时器和事件之外，没有标准的方法来延迟对函数的调用。

这听起来像是延迟调用方法的 GUI 反模式，以便您可以确定表单已完成布局。不是一个好主意。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2013-09-27T13:19:19.490

基于 David O'Donoghue 的回答，这里是延迟委托的优化版本：

```
using System.Windows.Forms;
using System.Collections.Generic;
using System;

namespace MyTool
{
    public class DelayedDelegate
    {
       static private DelayedDelegate _instance = null;

        private Timer _runDelegates = null;

        private Dictionary<MethodInvoker, DateTime> _delayedDelegates = new Dictionary<MethodInvoker, DateTime>();

        public DelayedDelegate()
        {
        }

        static private DelayedDelegate Instance
        {
            get
            {
                if (_instance == null)
                {
                    _instance = new DelayedDelegate();
                }

                return _instance;
            }
        }

        public static void Add(MethodInvoker pMethod, int pDelay)
        {
            Instance.AddNewDelegate(pMethod, pDelay * 1000);
        }

        public static void AddMilliseconds(MethodInvoker pMethod, int pDelay)
        {
            Instance.AddNewDelegate(pMethod, pDelay);
        }

        private void AddNewDelegate(MethodInvoker pMethod, int pDelay)
        {
            if (_runDelegates == null)
            {
                _runDelegates = new Timer();
                _runDelegates.Tick += RunDelegates;
            }
            else
            {
                _runDelegates.Stop();
            }

            _delayedDelegates.Add(pMethod, DateTime.Now + TimeSpan.FromMilliseconds(pDelay));

            StartTimer();
        }

        private void StartTimer()
        {
            if (_delayedDelegates.Count > 0)
            {
                int delay = FindSoonestDelay();
                if (delay == 0)
                {
                    RunDelegates();
                }
                else
                {
                    _runDelegates.Interval = delay;
                    _runDelegates.Start();
                }
            }
        }

        private int FindSoonestDelay()
        {
            int soonest = int.MaxValue;
            TimeSpan remaining;

            foreach (MethodInvoker invoker in _delayedDelegates.Keys)
            {
                remaining = _delayedDelegates[invoker] - DateTime.Now;
                soonest = Math.Max(0, Math.Min(soonest, (int)remaining.TotalMilliseconds));
            }

            return soonest;
        }

        private void RunDelegates(object pSender = null, EventArgs pE = null)
        {
            try
            {
                _runDelegates.Stop();

                List<MethodInvoker> removeDelegates = new List<MethodInvoker>();

                foreach (MethodInvoker method in _delayedDelegates.Keys)
                {
                    if (DateTime.Now >= _delayedDelegates[method])
                    {
                        method();

                        removeDelegates.Add(method);
                    }
                }

                foreach (MethodInvoker method in removeDelegates)
                {
                    _delayedDelegates.Remove(method);
                }
            }
            catch (Exception ex)
            {
            }
            finally
            {
                StartTimer();
            }
        }
    }
} 
```

通过为代表使用唯一键可以稍微改进该类。因为如果您在第一次触发之前第二次添加相同的委托，您可能会遇到字典问题。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2014-01-31T16:18:58.377

```
private static volatile List<System.Threading.Timer> _timers = new List<System.Threading.Timer>();
        private static object lockobj = new object();
        public static void SetTimeout(Action action, int delayInMilliseconds)
        {
            System.Threading.Timer timer = null;
            var cb = new System.Threading.TimerCallback((state) =>
            {
                lock (lockobj)
                    _timers.Remove(timer);
                timer.Dispose();
                action()
            });
            lock (lockobj)
                _timers.Add(timer = new System.Threading.Timer(cb, null, delayInMilliseconds, System.Threading.Timeout.Infinite));
} 
```

# regex - 哪个是更有效的正则表达式？

> ID：545535
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-02-13T10:52:30.320
> 
>         
> 
> 标签：regex, performance, perl

我正在解析一些**大**日志文件并有一些非常简单的字符串匹配，例如

```
if(m/Some String Pattern/o){
    #Do something
} 
```

看起来很简单，但实际上我的大部分比赛都可能是针对线路的开始，但比赛会“更长”，例如

```
if(m/^Initial static string that matches Some String Pattern/o){
    #Do something
} 
```

显然，这是一个更长的正则表达式，因此需要做更多的匹配工作。但是，我可以使用行锚的开头，这将允许表达式更快地被丢弃为失败的匹配。

我的预感是后者会更有效率。任何人都可以支持我/击落我:-)

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-02-13T10:55:08.367

我想你会发现用 ^ 开始你的正则表达式肯定会更快，因为正则表达式引擎不需要比字符串的左边缘更远的地方进行匹配。

当然，这是您可以轻松测试和测量的东西。进行 1000 万次左右的正则表达式匹配，测量需要多长时间，然后使用不同的正则表达式重试。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-02-13T10:57:22.370

线锚使它更快。我必须补充一点，这里不需要 //o 修饰符，实际上它什么也没做。这对我来说是代码味道。

//o 曾经有有效的用法，但现在由 qr// 提供

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T10:59:43.907

RE 的速度取决于两个因素，RE 本身和通过 RE 传递的数据。一般来说，没有回溯的锚定 RE（开始或结束）会比其他的更快。`/^hello/`但是，如果您正在处理一个每行都为空的文件，则和之间没有速度差异`/hello/`（至少如果正确编写了 RE 引擎）。

但我遵循的规则是：衡量，不要猜测。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T11:52:28.617

我按照建议做了一些时间安排。这是我的应用程序的结果。它是整个应用程序，而不仅仅是正则表达式搜索。它扫描 60,000 行。11 正则表达式的平均短长度约为 30 个字符。较长但锚定的约为 120。

```
Short
   real    0m58.780s
   user    0m54.940s
   sys     0m0.790s

Long (anchored)
   real    0m54.260s
   user    0m53.630s
   sys     0m0.490s

Long (not anchored)
   real    0m54.705s
   user    0m54.130s
   sys     0m0.400s 
```

所以锚定长弦会稍微快一些。虽然不是很多。看来，如果我的琴弦更大，那可能是另一回事。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2010-04-13T18:08:01.947

`use re debug`您可以通过pragma深入了解正则表达式引擎在 Perl 中所做的事情。它记录[在这里](http://perldoc.perl.org/perlretut.html#Pragmas-and-debugging)

[查看Perl 建议的性能技术](http://search.cpan.org/~jesse/perl-5.12.0/pod/perlperf.pod)（包括建议的计时方法  ）总是很有帮助的。

如果我运行这个小测试：

```
#!/usr/bin/perl 

use strict;
use warnings;
use Benchmark;

my $target="aeiou";

my $str="lkdjflzdjfljdsflkjasdjf asldkfj lasdjf dslfj sldfj asld alskdfj lasd f";

my $str2=$str.$target;

timethese(10_000_000, {
            'float'       => sub {
                die "no match" unless $str2=~m/$target/o;
            },
            'anchored'  => sub {
                die "no match" unless $str2=~m/^.*$target/o;
            },
            'prefixed'   => sub {
                die "no match" unless $str2=~m/^$str$target/o ;
            },  

    }); 
```

我得到以下输出：

```
Benchmark: timing 10000000 iterations of anchored, float, prefixed...
  anchored:  4 wallclock secs ( 3.46 usr +  0.01 sys =  3.47 CPU) @ 2881844.38/s 
     float:  2 wallclock secs ( 1.87 usr +  0.00 sys =  1.87 CPU) @ 5347593.58/s 
  prefixed:  4 wallclock secs ( 3.05 usr +  0.01 sys =  3.06 CPU) @ 3267973.86/s 
```

这导致了非锚定（浮动）版本更快的结论。但是，正则表达式和来源可能会改变这一点。YMMV和测试测试测试...

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T13:24:10.427

你是说你可以通过添加静态前缀来锚定正则表达式，就像这样？

```
/^blah blah The Real Regex/ 
```

这当然不会*损害*性能，它可能会有所帮助，但不是你想的那样。尽管它们以锚点、环视和捕获组等“神奇”的东西而闻名，但正则表达式引擎最擅长的是匹配字符的文字序列。序列越长，匹配越快（当然，在一定程度上）。  

换句话说，是添加了静态前缀，而不是锚，这给了你提升。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T10:55:43.263

我投票支持一开始就锚定的那个，这正是你所说的原因！

# database - 在数据库与网络服务器中加入表

> ID：545553
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-13T10:59:06.623
> 
>         
> 
> 标签：database, performance, caching

我在 Web 服务器的缓存中有 2 个表。桌子的大小相当巨大。每次检索数据时，我都必须对这两个表进行连接。

我拥有的其他选项是缓存中没有任何内容，并且每次都进行数据库调用，这将对数据库表进行连接。

所以我想知道的是，如果性能处于高优先级，在网络服务器上进行连接是否比进行数据库调用更昂贵。请提出建议....

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-02-13T11:26:23.220

简单的规则是**让数据库成为数据库**

数据库旨在进行连接。它们是由非常聪明的人写的，他们把所有的时间都花在担心这些事情上。有很多方法可以优化数据库以更快地加入。

如果您已经这样做并且仍然遇到性能问题，那么请查看优化但查看整个系统，因为您不太可能比数据库更好地完成数据库工作。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T11:04:42.057

我建议您使用连接创建一个视图并将该视图存储在内存中。在 MySQL 中，这是通过使用名为 MEMORY 的引擎来完成的。这应该为您提供两全其美的优势，因为您的调用背后仍然有一个事务系统，可确保数据的一致性，并且您在内存中维护视图时具有高性能，从而提供了非常好的响应时间。

您从创建视图中获得的另一个非常重要的优势是优化的连接，您需要在 Web 服务器上自行编程。但是，仅当您的联接达到一定程度的复杂性时，此优势才有意义。

# perl - 如何找到挂载点上的可用空间？

> ID：545559
> 
>         
> 
> 赞同：-4
> 
>         
> 
> 时间：2009-02-13T11:02:43.683
> 
>         
> 
> 标签：perl, diskspace

我之前提出[过这个问题](https://stackoverflow.com/questions/536160/how-can-i-find-the-free-space-available-on-mounted-volumes-using-perl)，但没有一个解决方案适用于已安装的点。既不工作`du`也不`df`在安装点上工作。有没有办法找出来？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T11:19:14.127

我不明白您所说的“不适用于安装点”是什么意思。切换到要解压的目录（如果还没有的话）并执行：

```
df . | grep -v '^Filesystem' | awk 'NF=6{print $4}NF==5{print $3}{}' 
```

grep 去掉了标题，awk 打印出可用于拆分行和非拆分行的千字节。

这是基于以下类型的输出，如果您的 UNIX 输出不同，您可能需要进行调整：

```
`Filesystem    1K-blocks      Used  Available  Use%  Mounted on
/dev/sda4     206434224  56965356  139065176   30%  /
varrun          1037296       132    1037164    1%  /var/run
varlock         1037296         0    1037296    0%  /var/lock
udev            1037296        68    1037228    1%  /dev
devshm          1037296        12    1037284    1%  /dev/shm
/dev/sda2         93327     43535      44973   50%  /boot
/dev/sdc1     155056484  29417456  117824612   20%  /media/extra160
gvfs-fuse-daemon
              206434224  56965356  139065176   30%  /home/pax/.gvfs` 
```

# `.net - 是否可以通过覆盖将访问器添加到 .NET 中的属性？`

 `> ID：545562
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-02-13T11:03:37.643
> 
>         
> 
> 标签：.net, properties, polymorphism, overriding, accessor

有可能做这样的事情吗？

```
class A
{
    public virtual string prop
    {
        get
        {
            return "A";
        }
    }
}
class B: A
{
    private string X;
    public override string prop
    {
        get
        {
            return X;
        }
        set
        {
            X = value;
        }
    }
} 
```

也就是说，基类提供了一个只有 GET 访问器的虚拟属性，但子类覆盖了 GET 并还提供了一个 SET。

当前示例无法编译，但也许我在这里遗漏了一些东西。

**补充：**为了澄清，不，我不想用 new 重新定义。我想添加一个新的访问器。我知道它不在基类中，所以它不能被覆盖。好的，让我试着解释一下没有语法糖的情况：

```
class A
{
    public virtual string get_prop()
    {
            return "A";
    }
}
class B: A
{
    private string X;
    public override string get_prop()
    {
        return X;
    }
    public virtual string set_prop()
    {
        X = value;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T11:08:10.270

不，没有办法做到这一点。想想你的虚拟财产的语法糖是如何被处理的，即它被转换为：

```
public virtual string get_prop(); 
```

没有要覆盖的 set_Prop 方法，也不能覆盖不存在的方法。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T11:13:43.610

不，这是不可能的。不幸的是，您甚至无法覆盖和更改访问者级别（例如，从*受保护*到*公共*），如[MSDN](http://msdn.microsoft.com/en-us/library/75e8y5dd(VS.80).aspx)上所述。我建议您考虑稍微重构代码/类，并寻找另一种方法来完成此任务，例如使用派生类中的 SetProperty 方法声明带有*受保护修饰符的集合访问器。*

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T11:10:48.327

您可以通过在派生类中使用“new”关键字来隐藏基类实现。以下应该成功编译：

```
class A
{
    public virtual string prop
    {
        get
        {
            return "A";
        }
    }
}
class B : A
{
    private string X;
    public new string prop
    {
        get
        {
            return X;
        }
        set
        {
            X = value;
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T11:13:51.440

引入一个新领域有点混乱。无论哪种方式，您都需要小心不要破坏多态性和继承（如果基类与私有字段对话怎么办？）。

关于在覆盖时添加新的访问器；简单的答案是“不，你不能”。当您覆盖时，您只能影响现有的访问器，因为这是在成员的虚拟表中定义的（被覆盖的成员仍然由基/声明类“拥有”，而不是覆盖类）。

一种选择（不理想）是重新声明该属性，但您仍然需要一种方法来与基类交谈。因此，如果基类中的访问器是`protected`：

```
class A
{
    public string prop
    {
        get;
        protected set;
    }
}
class B : A
{
    public new string prop
    {
        get { return base.prop; }
        set { base.prop = value; }
    }
} 
```

# asp.net-mvc - MVC + 实体框架：多对多关系

> ID：545564
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-13T11:04:32.617
> 
>         
> 
> 标签：asp.net-mvc, entity-framework, linq-to-entities

我是 MVC 和 EF 的新手。我有一个基本应用程序，其中列出了与某些服务器相关的几 (4) 个表中的信息。其中一种关系是多对多（服务器到角色）。

我通过在控制器中使用它来将我的 ViewData 传递给视图：

```
ViewData.Model = (from s in _db.Servers.Include("Locations").Include("OperatingSystems").Include("Roles")
                          select s).ToList(); 
```

但是我不确定如何在我的视图中显示每个服务器的多个角色？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-03-30T10:33:38.967

假设您的 ViewData.Model 工作并且模型是 List 类型。

```
<% foreach (var server in Model)
{%>
    <% foreach (var role in server.Roles)
    {%>
    <li><%= role.Name %></li>
    <%}%>
<%}%> 
```

# tfs - 将程序集版本号与 TFS 内部版本号对齐

> ID：545566
> 
>         
> 
> 赞同：13
> 
>         
> 
> 时间：2009-02-13T11:04:50.387
> 
>         
> 
> 标签：tfs, msbuild, versioning

我想知道是否有一种方法可以在不使用 BuildNumberOverrideTarget 的情况下同步内部版本号（20080213.1），而我必须生成自己的内部版本号？我基本上想使用默认/内置的 tfs buildnumber 生成器，但想访问它以使我的程序集版本与之对齐。可以这样做吗？这样做是否明智？

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-02-13T13:13:23.400

您所要求的非常明智，并且有多种方法可以实现这一目标。

就个人而言，当我这样做时，我不喜欢将文件签入到版本控制中，其中包含构建服务器生成的编号 - 它只是在跨分支合并代码时引入了太多的头痛，但我也喜欢已知的版本号当开发人员进行工作站构建与适当的构建服务器派生程序集时使用，以便真正轻松区分它们。

有关我喜欢如何做的更多信息，请查看 TFS Build Recipies wiki：

*   [TFS 构建：程序集版本控制](http://www.tfsbuild.com/AssemblyVersioning%20.ashx)

或我关于该主题的博客文章

*   [Martin Woodward：将内部版本号与装配版本对齐](http://www.woodwardweb.com/vsts/000417.html)

希望有帮助，

马丁。

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2009-02-13T11:28:34.040

是的你可以。在某些时候，可能在 AfterGet，您可以使用 BuildNumber 并创建自定义任务来更新源代码中的 AssemblyInfo.cs 文件。

我们已经连接到 AfterGet 并导致我们的目标是依赖的：

```
<Target Name="AfterGet" DependsOnTargets="VersionAssemblies" /> 
```

我们的 VersionAssemblies Target 从 $(SolutionRoot) 中提取所有 AssemblyInfo.cs 文件：

```
<CreateItem Include="$(SolutionRoot)\**\AssemblyInfo.cs;">
    <Output TaskParameter="Include" ItemName="AssemblyInfos"/>
 </CreateItem> 
```

检查它们：

```
<Exec Command="$(TfCommand) checkout &quot;AssemblyInfo.cs&quot; -r"
          WorkingDirectory="$(MSBuildProjectDirectory)\..\sources" ContinueOnError="true"/> 
```

编辑它们并用 $(BuildNumber) 替换文件版本：

```
<File.Replace Path="%(AssemblyInfos.FullPath)"
                  NewValue="AssemblyFileVersion(&quot;$(BuildNumber)&quot;)"
                  RegularExpression="AssemblyFileVersion\(\&quot;(\d+.\d+.\d+.\d+)\&quot;\)"
                  IgnoreCase="true"
                  Force="true"/> 
```

然后重新检查文件：

```
<Exec Command="$(TfCommand) checkin /override:&quot;Automated&quot; /comment:&quot;Update AssemblyInfo files to version number $(BuildNumber) - $(NoCICheckinComment) &quot; /noprompt &quot;AssemblyInfo.cs&quot; /recursive"
          WorkingDirectory="$(MSBuildProjectDirectory)\..\sources" ContinueOnError="false"/> 
```

[对于文件版本的替换，我使用 CodePlex 上 Microsoft SDC 任务](http://www.codeplex.com/sdctasks)附带的 File.Replace 任务。

另请注意，如果您有在签入时触发的构建，则在签入 AssemblyInfo.cs 文件时，请确保注释包含 $(NoCICheckinComment) ，因为这会导致 TFS 不会触发另一个构建，否则您将最终进入无限的构建循环。

# sql-server-2005 - 在 SQL Server 2005 中使用 try...catch 创建触发器

> ID：545571
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-13T11:05:38.620
> 
>         
> 
> 标签：sql-server-2005, triggers, try-catch

我已经实现了以下触发器：

```
CREATE TRIGGER [OnContactDeleted]
    ON [TABLE].[Contact]
    INSTEAD OF DELETE
    AS 
    BEGIN
        SET NOCOUNT ON
        /*Store contact ID to variable*/
        Update [TABLE].[Account] Set [PrimaryContactID] = null where [TABLE].[Account].[PrimaryContactID] = (Select ContactID from Deleted)
        Delete from [TABLE].[Contact] where [TABLE].[Contact].[ContactID] = (Select ContactID from Deleted)
    END 
```

很显然是从另一个表中取出一组外键然后删除当前记录。这样做是因为在删除时将外键设置为 null 不起作用。

我的问题是关于将此触发器包装在 try...catch 块中，如果发生异常，我可以在其中回滚。这是一种好的做法吗？我应该为这种触发器做吗？

谢谢，杰森

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T11:19:06.060

我宁愿让它失败并让异常在消费者中处理（执行 DELETE 语句的代码）。在此删除的上下文中不应该有任何逻辑原因并触发此操作失败，因此这将是导致失败的外部因素。因此，异常也应该在外部处理。通常 DELETE 也会发生在事务中，所以这就是发生回滚的地方。

# actionscript-3 - 当有很多文本时，TextField() 不显示内容的开头

> ID：545572
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-13T11:05:39.213
> 
>         
> 
> 标签：actionscript-3, apache-flex, flex3

当它有多行时，如何强制 TextField 在其上显示文本的特定部分？现在它似乎总是只显示最后一行而没有用户交互

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T11:16:16.940

查看[scrollV 属性](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/text/TextField.html#scrollV)。将其设置为零，您的文本应向上滚动以显示文本的开头，将其设置为[maxScrollV](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/text/TextField.html#maxScrollV)以显示最后一行，或将其设置为这两者之间的任何值以显示您选择的一行。

# wpf - 在 WPF 中，这条线是否泄漏？

> ID：545573
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-13T11:06:07.370
> 
>         
> 
> 标签：wpf, memory-leaks

`TextBox`如果我们从视觉和逻辑树中删除，这条线会泄漏吗？对我来说，这泄漏是因为`Mouse.MouseDown`有一个引用`myHandler`并且没有做任何事情来删除处理程序。

```
<TextBox Mouse.MouseDown="myHandler" /> 
```

我不确定，因为这段代码是常见的做法。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T12:41:08.733

它会泄漏吗？该 XAML 直接转换为以下代码（请参阅 obj 目录中生成的 Window1.g.cs 文件）

```
((System.Windows.Controls.TextBlock)(target)).AddHandler(System.Windows.Input.Mouse.MouseDownEvent, new System.Windows.Input.MouseButtonEventHandler(this.TextBlock_MouseDown)); 
```

所以，实际发生的是我们正在向 TextBlock 添加“this”的引用（在我的例子中是 Window1 的实例）。您在 XAML 中看到的语法实际上是为路由事件或附加事件附加 RoutedEvent 处理程序的语法。恰好语法使您看起来像是在分配一些参考。看看这个：[Routed Events Overview](http://msdn.microsoft.com/en-us/library/ms742806.aspx)和[Attached Events Overview](http://msdn.microsoft.com/en-us/library/bb613550.aspx)。

编辑：总之，它不会泄漏。:)

Edit2：如果您对 TextBlock 有任何引用，则会泄漏。但是，如果当您切换出 TextBlock 时，确保没有更多对该元素的引用，那么您会没事的。

# sql - 如何在 MS SQL Server 中将具有本地化数字格式的文本转换为数字？

> ID：545575
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-13T11:07:30.910
> 
>         
> 
> 标签：sql, sql-server, tsql, localization

假设我有一个德国数字格式“1,00”的数字，它在 en-US 语言环境中等于 1.0。

有没有内置的方法可以将 T-SQL 中的文本转换为相应的数字？看起来 CONVERT 和 CAST 只接受带有 '.' 的数字。作为小数分隔符，我认为没有办法告诉他们。

我正在考虑简单地将“，”替换为“。” 但是，如果我有一个带有千位分隔符的德国号码，例如“1.000,00”，这会变得很难看。

在检索到“错误”的 SQL 结果后进行转换不是一种选择。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T17:42:24.533

如果要在 SQL Server 中执行此操作，则必须创建一个 CLR 存储过程/用户定义函数，它将字符串作为参数并返回所需的数字类型。您可能还需要一个参数来指示您可能希望使用哪些区域名称（例如 en-US）来指示用于确定解析模式的区域性。

然后，在代码中，您将调用 Double/Decimal/Int32 上的 TryParse 方法，并使用适当的 CultureInfo 来指示解析模式。您可以循环浏览一堆，或使用其他一些信息来确定正确的模式。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T11:57:14.673

我建议您在应用程序级别执行此操作，因为应用程序知道语言环境。您使用什么语言/框架？   

# silverlight - 如何从命令行执行 silverlight 单元测试

> ID：545579
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2009-02-13T11:09:12.590
> 
>         
> 
> 标签：silverlight, unit-testing, msbuild, continuous-integration

我对使用 Silverlight 的测试框架的 silverlight 应用程序进行了一组测试。我可以在 Visual Studio 中执行这些，它们运行得很好。我还可以按照 Jeff Wilcox 博客文章中的提示使用 MSBuild 从 Visual Studio 外部构建我的代码：http: 
 [//www.jeff.wilcox.name/2009/01/silverlight-msbuild-tricks-video/](http://www.jeff.wilcox.name/2009/01/silverlight-msbuild-tricks-video/)

我想从命令行执行我的单元测试（使用 MSBuild 或 NAnt 等），如果测试失败，则构建失败。对于当前的 Silverlight MSBuild 资产，这似乎是不可能的。

所以我的问题是：

**如何使用 MSBuild 等构建工具从命令行执行 silverlight 单元测试？**

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2010-01-11T08:12:23.677

我在 StatLight 上取得了成功。
[http://statlight.codeplex.com/](http://statlight.codeplex.com/)

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T13:39:01.247

这是我在 silverlight.net 论坛上提出的一个问题，并得到了 Jeff Wilcox 的一些回应。我认为这个问题仍然存在：

[http://silverlight.net/forums/p/57811/166439.aspx](http://silverlight.net/forums/p/57811/166439.aspx)

最新帖子推荐了一个有前途的[powershell 解决方案](http://blog.lab49.com/archives/2292)

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2011-12-20T13:22:55.060

您还可以查看项目 Lighthouse： http: [//lighthouse.codeplex.com/](http://lighthouse.codeplex.com/)（另请参阅[此](http://blog.roboblob.com/2011/03/22/lighthouse_silverlight_unit_test_runner_project_released/)作为参考）

我没有尝试过它与 Statlight 相比，所以我无法评论哪个更好。一月份来，我会试一试。

# cocoa-touch - 如何从 iPhone 应用程序链接到谷歌地图方向

> ID：545583
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-02-13T11:12:03.630
> 
>         
> 
> 标签：cocoa-touch

我一直在开发基于位置的应用程序，理想情况下希望使用 Google 应用程序直接链接到方向。

我已经看到了一些应用程序，例如 AroundMe，它们似乎已经做到了这一点，但我无法弄清楚他们是如何设法实现它的

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-02-13T14:11:36.787

问题是关于打开显示导航方向的地图，而不仅仅是地图。iPhone 的 URL 方案支持源地址和目标地址 - 试试，例如：

```
NSString* urlString = @"http://maps.google.com/maps?saddr=London+UK&daddr=Birmingham+UK";
[[UIApplication sharedApplication] openURL:[NSURL URLWithString: urlString]]; 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T12:41:54.210

使用 OpenURL 以正确的位置启动谷歌地图，就像[在 stackoverflow 上的这个问题中](https://stackoverflow.com/questions/30058/how-can-i-launch-the-google-maps-iphone-application-from-within-my-own-native-a)描述的那样。

从那里提取：使用

```
[someUIApplication openURL:[[NSURL alloc] initWithString: @"http://maps.google.com/maps?g=London"]] 
```

除了您还可以使用`g=London`更多的 URL 格式来放置图钉，或移动到 GPS 位置（可能是您之前通过询问核心位置从应用程序中获得的当前位置）

无关：

如果有人对如何处理有关堆栈溢出的重复和/或相关问题有任何建议，请发表评论。我还是新来的:-)

# c - 带有匹配括号的正则表达式

> ID：545584
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-13T11:12:46.123
> 
>         
> 
> 标签：c, regex, matlab

我正在尝试从 C 源代码中提取特定的硬编码变量。我剩下的问题是我想解析数组初始化，例如：

```
#define SOMEVAR { {T_X, {1, 2}}, {T_Y, {3, 4}} } 
```

将这个例子解析成“{T_X, {1, 2}}”和“{T_Y, {3, 4}}”就足够了，因为这样就可以递归得到完整的结构。但是，它需要足够通用，以便能够解析任何用户定义的类型。

更好的是正则表达式列表，可用于从通用 C 代码结构（如`#define`、枚举和全局变量）中获取额外值。

C 代码是提供给我的，所以我无法控制它。我宁愿不编写一个一次解析一个字符的函数。但是，拥有一系列正则表达式是可以的。

这不是将文件导入 MATLAB 或基本正则表达式的问题。我正在使用一个特定的正则表达式，它通过括号保留分组。

编辑：看起来正则表达式不进行递归或任意深度匹配。根据[这里](https://stackoverflow.com/questions/546433/regular-expression-to-match-outer-brackets)和[这里](https://stackoverflow.com/questions/524548/regular-expression-to-detect-semi-colon-terminated-c-for-while-loops)。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T11:27:06.633

也许 vim 的语法文件会帮助解决这个问题。我不确定它是否有你想要的那些元素（我不做 C），但它有很多元素，所以它绝对是一个起点。下载 vim (www.vim.org)，然后在 vim/syntax/c.vim 中查看一下。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T11:29:06.100

我认为正则表达式不适用于任意 C 代码。
[Clang](http://clang.llvm.org/)允许您从 C 代码构建语法树并以编程方式使用它。

这可以很容易地用于全局变量，但#defines 由预处理器处理，所以我不确定它们将如何工作。

```
cristi:tmp diciu$ cat test.c
#define t 1
int m=5;

int fun(char * y)
{
    float g;

    return t;
}

int main()
{
    int g=7;
    return t;
}

cristi:tmp diciu$ ~/Downloads/checker-137/clang -ast-dump test.c
(CompoundStmt 0xc01ec0 <test.c:6:1, line:10:1>
  (DeclStmt 0xc01e70 <line:7:2>
    0xc01e30 "float g"
  (ReturnStmt 0xc01eb0 <line:9:2, line:1:11>
        (IntegerLiteral 0xc01e90 <col:11> 'int' 1)))
(CompoundStmt 0xc020a0 <test.c:13:1, line:16:1>
  (DeclStmt 0xc02060 <line:14:2>
    0xc02010 "int g =
      (IntegerLiteral 0xc02040 <col:8> 'int' 7)"
  (ReturnStmt 0xc01b50 <line:15:2, line:1:11>
    (IntegerLiteral 0xc02080 <col:11> 'int' 1)))
typedef char *__builtin_va_list;
Read top-level variable decl: 'm'

int fun(char *y)

int main() 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T13:04:34.577

我假设您可以访问相关的 C 代码。如果是这样，那么定义两个宏：

```
#define BEGIN_MATLAB_DATA
#define END_MATLAB_DATA 
```

在这些宏之间包装您要提取的所有数据。当 C 代码被编译时，它们扩展为空，因此它们不会在那里造成伤害。

现在您可以使用一个非常简单的正则表达式来获取数据。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T15:03:16.507

编辑：现在问题已经更新，看来我之前的回答没有抓住重点。我不知道您是否已经在 Stack Overflow 上搜索过其他与正则表达式相关的问题。如果您没有，我遇到了两个可以帮助您解决问题的指导（这似乎是一个问题，至少部分是尝试匹配和跟踪打开和关闭花括号的问题）：[这个一个](https://stackoverflow.com/questions/546433/regular-expression-to-match-outer-brackets)和[这个](https://stackoverflow.com/questions/524548/regular-expression-to-detect-semi-colon-terminated-c-for-while-loops)。祝你好运！

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T15:13:17.403

这个正则表达式：

```
(\{\s*[A-Za-z_]+)\s*,\s*\{\s*\d+\s*,\s*\d+\s*\}\s*\} 
```

seems reasonable, but I don't know if it's enough for you. It's littered with \s* to allow arbitrary whitespace between tokens, from C's point of view that's allowable. It will match stuff that looks more or less just your examples; some kind of identifier followed by exactly two digit strings.

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T16:59:25.680

The [formal language](http://en.wikipedia.org/wiki/Regular_language) that defines brace matching is not a regular language.  Therefore, you cannot use a regular expression to solve your problem.

The problem is that you need some way to count the number of opening braces you have already encountered.  Some regular expression engines support extended features, such as peeking, which could be used to solve your problem, but these can be tough to deal with.  You might be better off writing a simple parser for this task.

# mediawiki - mediawiki 网站上超链接中的自定义协议

> ID：545588
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-02-13T11:13:45.963
> 
>         
> 
> 标签：mediawiki

我们的网络上有自定义协议，可以在我们的应用程序中打开窗口。我们想把这个应用程序的链接放在我们的 Wiki 中，但是 mediawiki 似乎识别的唯一协议是 http://file://ftp://。

我们做了一个软糖，将参数传递给 html 文件并执行链接，但是如果有人知道在 mediawiki 站点中拥有自定义协议超链接的方法，那就太好了。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-02-13T15:18:54.330

我认为您可以在 LocalSettings.php 中使用 $wgUrlProtocols。

有关说明，请参见此处：[http ://www.mediawiki.org/wiki/$wgUrlProtocols](http://www.mediawiki.org/wiki/$wgUrlProtocols)

# extjs - 非 Java DocBook WebHelp 输出

> ID：545591
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-13T11:14:50.207
> 
>         
> 
> 标签：extjs, docbook

有没有人设法将 DocBook 内容输出到不使用 Java 小程序的 webhelp？我们目前正在设计一个使用 Ext JS 的 Web 应用程序，并希望将 DocBook XML 内容输出为可以与我们的应用程序并行使用的格式（即没有 Java 小程序）。

坚持使用 DocBook 是我们管理层的愿望，但我们需要一个独立于平台的集成帮助输出（不是 .chm），它可以与我们的 webapp 集成。

任何建议，建议和意见将不胜感激。

劳里。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2010-08-26T06:07:10.400

我在一年多后回答这个问题，但有些人可能会觉得这很有用。

在 Google Summer of Code 计划下，我们为 DocBook 创建了 WebHelp 输出格式。它不依赖于 java-applet 也不依赖于基于框架集的方法。它是纯 css，基于 JavaScript，因此很可能满足您的要求。这对搜索引擎更友好，因为它不依赖于框架集。从 1.76.0 版开始，DocBook XSL 提供此功能。

以下链接会给你一个想法。

该演示可在此处获得：[http](http://snapshots.docbook.org/xsl/webhelp/docs/content/ch01.html) ://snapshots.docbook.org/xsl/webhelp/docs/content/ch01.html WebHelp 的文档包含在演示中。

1.76.1 的发行说明位于：[DocBook WebHelp 项目](http://blog.kasunbg.org/2010/08/docbook-webhelp-project.html)

SVN 位置：[http ://docbook.svn.sourceforge.net/viewvc/docbook/trunk/xsl/webhelp/](http://docbook.svn.sourceforge.net/viewvc/docbook/trunk/xsl/webhelp/)

该提案位于：[针对 DocBook 的 WebHelp 输出提案](http://blog.kasunbg.org/2010/04/proposal-web-help-output-for-docbook.html)。

对不起，没有。的链接。如果您需要进一步的帮助，请通过 DocBook 邮件列表联系我们。这正在积极维护中。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2012-07-17T20:56:25.977

Adobe RoboHelp 使用框架集来呈现 webhelp。自定义 CSS 本身是一个巨大的痛苦。再加上无响应的 Adob​​e 支持。此外，您的 webhelp 站点的整体外观和感觉都非常 1990 年代。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2013-05-30T00:36:49.553

我很高兴我们改用 Docbook。我们现在使用由 David Crammer 和 KasunBG 开发的 DocBook WebHelp 项目。

这解决了我们所有的 techpubs 问题。

*   我们的文档现在与 git 中的源代码相关联  

*   开发团队可以向文档提出补丁

*   我们现在可以使用持续集成自动生成文档

*   更不用说网站的外观和感觉了。

*   我们的多格式和多设备发布后顾之忧得到解决！

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-06T02:44:54.323

您看过[Adob​​e RoboHelp](http://www.adobe.com/products/robohelp/)吗？相当肯定它是独立于平台的。

# sql - 如何使用 where 子句插入

> ID：545593
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-02-13T11:15:39.877
> 
>         
> 
> 标签：sql

我正在使用以下查询将值插入表 A 中的一个字段。

```
insert
into A (name)
values ('abc')
where
   A.id=B.code
   and B.dept='hr' ; 
```

这个查询对吗？如果没有，请给我一个正确的方法。

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-02-13T11:19:26.730

`UPDATE`如果要更改使用`WHERE`子句选择的记录中的字段值，您应该使用,。

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2009-02-13T11:50:01.230

```
MERGE
INTO a
USING (
  SELECT *
  FROM b
  WHERE b.dept = 'hr'
)
ON a.id = b.code
WHEN NOT MATCHED THEN
  INSERT (id, name)
  VALUES (code, 'abc')
WHEN MATCHED THEN
  UPDATE
  SET name = 'abc' 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-03-12T13:30:40.050

插入部分应该没问题

```
插入
进入A（姓名）
值（'abc'）

```

这实际上取决于您尝试使用 where 子句和 B 表引用实现的目标。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2017-04-18T03:33:31.537

```
INSERT INTO A (name)
SELECT name 
FROM A as a
LEFT JOIN B as b ON b.id=a.id
WHERE a.id=b.code AND b.dept='hr' 
```

A 是第一个表，然后 B 是第二个表，使用 LEFT JOIN 连接在一起，然后名称是列。这就是他想要对他的问题做的事情。

这就是“插入选择语句”所做的。

在进行选择并结合 WHERE 和 JOIN 时可以插入的查询。

```
INSERT TABLE1 (column1)
SELECT column1
FROM TABLE1 as a
LEFT JOIN TABLE2 as b ON b.column1=a.column1
WHERE a.column2=b.column3 AND b.column4='hr' 
```

# c# - ASP.NET TextBox 控件 - 在后面的代码中获取默认文本值？

> ID：545596
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-02-13T11:18:18.823
> 
>         
> 
> 标签：c#, .net, asp.net, web-controls

我一直在监视 MSDN，但看不到 TextBox 的属性/方法，它允许您获取在字段上设置的默认文本值；我希望能够将当前的 txtMyTextBox.Text 与默认值进行比较（就像这个伪代码所示）：

```
var myValue = (String.Compare(txtMyTextBox.Text, txtMyTextBox.DefaultText) ? "" : txtMyTextBox.Text) 
```

这是 ASP.NET 控件中存在的东西吗？还是我要求太多了？:)

感谢您的帮助（一如既往）！

皮特

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T11:21:36.057

默认文本是指编辑前的初始文本吗？

也许在某处的常量/字段/等中声明它，并以编程方式而不是在标记中设置它 - 即在第一次加载时`txtMyTextBox.Text = defaultText;`- 然后你可以再次比较`defaultText`以跟踪更改。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T11:21:03.263

文本框（或任何其他控件）上没有“DefaultText”属性。您可能已经通过常量字符串定义了默认值，因此只需将 Text 属性与该常量字符串进行比较。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T11:23:08.767

在回发期间没有内置方法可以检索文本框的默认值。

一种选择是使用 ViewState 在初始 PageLoad 期间存储该值，并在回发期间从那里检索它以进行比较。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T11:23:38.297

您可以检查的唯一属性是 Text 属性。如果您需要比较原始值，那么最好将其存储为隐藏字段或会话变量。然后，您可以对照 textbox.Text 属性中的任何内容进行检查。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T11:24:35.207

将原始值放在隐藏字段或视图状态中。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T11:29:49.343

TextBox 类仅支持 .Text 属性，因此您的“默认”值必须在首次呈现页面之前存储在某处，以便您可以在页面回发时检查文本框的 .text 属性。这个“默认”值可以存储在 cookie 中（如果足够小）、页面的 ViewState、页面上的隐藏表单字段，甚至是应用程序或会话状态。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T11:28:47.410

TextBox 没有 DefaultText 属性，所以我很困惑。您如何设置默认文本值？如果您只是在代码中设置它，即

```
<asp:TextBox ...>Default Value</asp:TextBox> 
```

然后它将是 .Text 属性的值。

# language-agnostic - 记录好的软件开发的关键要素？

> ID：545601
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-13T11:20:57.727
> 
>         
> 
> 标签：language-agnostic, architecture, documentation, coding-style

我正在为我们公司的软件开发编写一份架构和设计文档，其中将包含开发人员应遵循的规则和指南。它针对 J2EE Web 应用程序，但我不断提到相同的基本“成分”（因为没有更好的词，并且避免流行语）来介绍和捍卫某些选择。

这些是：

*   **抽象**：关注“什么”而不是“如何”。

*   **封装**：隐藏“如何”。

*   **关注点分离**：划分为不同的非重叠结构。

*   **低耦合和高内聚**：使任何划分都有意义。

包含它们的好处是，当文档没有具体提及某些内容时，很容易指出这些关键成分，因此它们可以作为一种包罗万象的东西。

缺点会是“是的，很好，但我只需要知道我需要扩展什么类来实现这个控制器”之类的反应。

我首先确定和讨论这些一般性问题是正确的，还是应该“坚持重点”？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T11:28:08.753

是的，我做过一次。没有帮助。

我认为软件开发很难，列出这四个概念，无论多么重要，都无法提高组织中的代码质量。你真正需要的是积累知识和经验。如果我必须制作一个列表，它将包含：

*   接受**规则 0 是为了产生更好的代码**。如果单个编码人员不同意这一点，您可能会遇到麻烦。

*   进行代码审查。这将解决您列出的大多数问题，并具有许多其他优势。

*   交流你正在做的事情——越频繁越好。放下你的自负，毫不犹豫地向你的资深同事寻求建议。如果您是高级开发人员，请倾听年轻同行的意见，他们通常更了解最新的技术、想法、实践和成语。

*   尊重你的代码库。每一行代码都很重要，而且必须是正确的。

这些都是人为因素。我认为这就是在组织中实现更好编程的起点。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T11:31:45.110

这是需要教导和解释的东西。

有些人可以从书本上学习，但书本需要写得好，没有冒犯，但大多数人实际上并不擅长这一点，因此请考虑使用现有的经过良好审查的书（++表示代码完整），也许有一些迹象表明哪些章节是相关的。

有些人不能（或不会）从书本中学习。如果他们不能，那么您需要发现这些人并在他们值得您投入时间的情况下帮助他们。如果他们不考虑解雇他们，因为他们只是在浪费**你的**时间。

这些概念在你真正使用它们之前是非常短暂的（最好还是**不要使用它们**，稍后意识到第一次没有做对会造成多大的痛苦，并从你的错误中吸取教训）。简单地重述现有文献，但更糟糕的是，IMO 并不能有效地利用您的时间。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T11:34:57.880

我也遇到过类似的情况：为开发人员编写文档。面对现实，他们不会阅读它，或者即使他们阅读了，他们也不会应用这些原则。您需要带头并进行小型培训课程，向他们展示您的意思/寻找的内容。我成功地做到了这一点。与高级开发人员进行 1-2 小时的小型会议。我们查看了好代码和坏代码，并讨论了*为什么*它是好的和坏的。  

文档可以作为一个很好的备份，但面对面的学习永远不会被打败。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T11:24:52.910

作为一名建筑师，让这些事情发生是你的责任，如果需要用流行语来敲定它，那就这样吧。

在您的级别上，实际代码只是一个实现细节，*这**就是***重点。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T11:25:11.337

[只需将Code Complete 2](http://cc2e.com/)的副本放入您的库中，然后将您的开发人员指向它。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T12:48:20.153

您提到的内容对任何开发人员来说都应该是显而易见的，但他们往往会在开始输入时忘记这一点。根据我的经验，这些指南将帮助您改进：

*   编写自动单元测试

*   拥有一个自动构建系统，可以在一夜之间构建整个产品以备生产

*   目标是测试中的代码覆盖率在 80% 到 90% 之间

重要提示：这些是*指导方针*，而不是*规则*。准则在不断变化的环境中起作用，而规则则不起作用。

推理：当你写一个测试时，你需要抽象你的类。您会自动开始隐藏内部细节，因为其他任何事情都会使您的测试更加复杂。

每晚构建系统将帮助您在 24 小时或更短时间内发现错误。如果你在早上发现你昨天工作的东西坏了，你很可能仍然记得你在做什么。这将使查找和解决问题变得更加容易。

至于代码覆盖率：您将需要 20% 的时间来编写覆盖 80% 代码的测试，并且需要 80% 的时间来编写接下来 10% 和 1000% 的时间（十次）的测试才能获得 100%（或者更确切地说是 99.999%）。如果你真的做到了那一步，每一次代码更改都会破坏如此多的测试，以至于你将停止测试。最后，80-90% 的覆盖率将为您带来更好的投资回报率。

我还建议阅读以下内容：[关于开发人员测试的思考](http://java.dzone.com/articles/thoughts-developer-testing)

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-05-03T09:44:08.053

在我看来，您的问题过于关注源代码。源代码是开发过程的最终结果。我认为您还应该关注-过程-，即软件的开发方式。

*   开发过程中有哪些活动，可以定义哪些阶段和里程碑？

*   谁参与了开发过程，他们的角色是什么？

*   不同活动需要多少时间？发布间隔是多少？

*   不同活动的最终交付是什么，例如设计文档、图表、演示文稿、手册、源代码、二进制文件等？

*   谁负责每个阶段？

此外，对于每个开发活动，可以指定一些工具来支持开发团队，例如：

*   每周进度会议

*   设计理念的展示和辩论

*   问题列表和错误跟踪器

*   版本管理

*   清单

*   等等

我的经验是，结构化的开发过程最终也会有助于提高源代码的质量。例如，当开发人员定期向整个开发团队展示他们的工作时，他们将获得建设性的反馈并向同事学习。更好地理解 OO 概念（抽象、关注点分离、继承等）的开发人员有机会将他/她的知识传授给他/她的同事。

# database - 在数据库中存储条件逻辑表达式/规则

> ID：545603
> 
>         
> 
> 赞同：14
> 
>         
> 
> 时间：2009-02-13T11:21:24.573
> 
>         
> 
> 标签：database, hibernate, rdbms

如何使用 RDBMS 存储逻辑表达式？

我标记对象并希望能够基于这些标记构建真实陈述。（这些可能被视为虚拟标签。）

**标签**

`new`

`for_sale`

`used`

`offer`

**规则**

`second_hand_goods = (!new or used) and for_sale`

`new_offer = new and offer`

`second_hand_offer = second_hand_goods and offer`

*   规则应该能够引用标签和其他规则。

*   可以通过 hibernate 轻松访问的模式将是可取的。

*   最好可以在一次选择/调用中检索整个规则？

你们如何在数据库中存储表达式和业务规则？

提前致谢。

**更新**

需要明确的是，这些规则不是供数据库内部使用的，而是由需要保留这些标签和规则的外部应用程序创建和使用的。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-02-13T11:44:25.157

从实用的角度来看，如果计算所需的所有列都位于同一个表上，您可以在数据库中创建计算字段 - 计算字段只能从单个记录中工作。大多数现代 DBMS 平台都支持此功能。

从理论的角度来看，您正在进入[语义数据建模](http://en.wikipedia.org/wiki/Semantic_data_model)。这方面最好的论文是 Hammer 和 MacLeods[`Ruritanian Oil Tankers`](http://imsc-dmim.usc.edu/publications/p351-hammer.pdf)的论文，它描述了一种富有想象力的语义数据建模符号，称为 SDM。SDM 使用结构化的英文类型符号来标记您描述的那种数据库规则。如果您想概括您的能力并且不介意为 SDM 编写解析器，您可以创建一个可以配置这种逻辑的规则引擎。这种类型的模型也应该可以很好地适应 O/R 映射器。

不利的一面是，制作这种工具会非常耗时，因此只有在您对管理数据语义的需求非常大的情况下才值得这样做。对于您引用的示例，它很适合过度杀伤力的领域，但如果您的问题更大，那么构建这样的东西可能是值得的。如果您不想编写解析器，您可以创建一个 XML 模式来标记类似 SDM 的语言。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-02-13T11:33:03.407

管理嵌套/括号会变得非常复杂并且容易出错。我过去这样做的方法是使用 XML 来定义逻辑，因为它可以很好地处理嵌套。使用 SQL Server 2005 或更高版本，您还可以将其很好地存储在单个表中。

您的二手商品逻辑可以存储为...

```
<logic type="and">
    <logic type="or">
        <logic type="not">
            <value type="new" />
        </logic>
        <value type="used" />
    </logic>
    <value type="for_sale" />
</logic> 
```

很抱歉，这不是对您问题的实际答案，而只是另一种做事方式。我刚刚发现它过去对我有用。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T11:29:24.400

默认情况下，在我充分理解问题并找出解决方案之前，我不会将业务规则存储在数据库中。这些属于代码。但是，任何规则总是有例外，您可以使用 RDBMS 的存储过程和/或函数来封装这些规则（前提是您的数据库有它们）。但是，正如我所说，理想情况下，您将在代码中以有意义的方式解释数据。

**更新**

对不起，意识到我没有回答你的问题。如果您的数据库有函数，您可以使用允许您传入参数并返回标量值或使用存储过程的函数。每个表达式可能有 1 个，并且有一个更大的过程来以某种方式组合表达式。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-03-10T07:51:20.053

我会用一张桌子

```
tags(id,name,type,expression,order) 
```

*   **type**将显示标签是正常的还是计算的。

*   **如果您添加新的计算标签，订单**将重新排序，它指定这些标签的计算顺序...

*   **在插入行之前解析和检查表达式**，它也可以使用 GUI 构建（类似于 Oracle 发现者如何做这些事情）。

*   您仅将普通标签链接到项目

对于您的示例二手商品需要在二手报价之前计算，所有其他都可以在没有任何依赖关系的情况下计算。

```
1,'new',1,'',NULL
2,'for_sale',1,'',NULL
3,'used',1,'',NULL
4,'offer',1,'',NULL
5,'second_hand_goods',2,'(!new or used) and for_sale',1
6,'new_offer',2,'new and offer',1
7,'second_hand_offer',2,'second_hand_goods and offer',2 
```

一个项目只能由 for_sale 标记，计算将给出：

```
second_hand_goods,second_hand_offer 
```

我将有一个函数列出该项目的所有标签，包括直接标签和计算标签：

```
for_sale,second_hand_goods,second_hand_offer 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T14:16:20.753

像这样的东西怎么样：

```
Tables:
 tags( id, name )
 goods ( id, ... )
 goods_tags_mm ( tag_id, good_id )
 rules ( id, name )
 rules_cnf ( id, rule_id )
 rules_cnf_terms ( rules_cnf_id, tag_id ) 
```

# memcached - 内存缓存共享

> ID：545615
> 
>         
> 
> 赞同：12
> 
>         
> 
> 时间：2009-02-13T11:25:39.603
> 
>         
> 
> 标签：memcached, sharing

是否可以在多个项目之间共享一个 Memcache 实例。

假设我在一个项目中将一个对象推送到内存缓存中，我是否可以从不同的项目中检索相同的对象。?

* * *

## 回答 #1

> 赞同：14
> 
>             
> 
> 时间：2009-02-13T11:32:49.960

Memcache 只是一个内存存储。它可以跨多台机器运行。两个完全不同的进程没有理由不能通过它相互通信。

让我澄清一下。您可以在一台或多台服务器上运行 memcache。您可以将您的客户端配置为与一组特定的实例对话。您可以在同一主机上运行两个（或更多）不同的 memcache 进程（监听不同的 IP 地址和/或端口），它们是完全独立的。

如果您的两个应用程序与同一个实例通信，那么它们没有理由无法通信。

如果您与多个实例通信并对数据进行分区（即，将其拆分为不同的实例），那么您的客户需要知道从哪个实例获取数据或将数据放入哪个实例。如果您使用相同的客户端库（例如，您的两个客户端都是 PHP5），那么这不是戏剧。如果它们不相同，那么您必须以某种方式处理该问题。

如果您使用不同的技术，另一个问题是您必须考虑交换格式，因为 PHP 中的自定义序列化在 Java 或 C# 中不会那么可读。典型的选择是 XML 甚至 JSON。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-02-13T11:50:02.757

是的，只要每个项目以相同的方式配置memcache节点，并以相同的方式为缓存元素生成key，它们就可以共享数据。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2012-08-04T08:52:36.300

如果您担心安全问题（一个应用程序读取另一个应用程序的数据）或应用程序之间的缓存中毒，那么这些都是可能的。  

如果要在应用程序之间隔离 memcache，则可以在单个服务器上运行多个 memcached 守护程序，每个守护程序使用服务器的一部分内存。每个实例在不同的端口号上运行。您可以使用防火墙规则来确保只有特定的应用程序服务器才能访问特定的 memcache 端口，以确保应用程序无法读取或毒害对方的数据。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2012-10-04T19:04:33.563

对于每个项目，我都会提供一种方法来按名称空间生成键和分区项目。因此，对于项目 B 中的 key = foo，它由 A.foo 存储/获取，而项目 B 中的 foo 称为 B.foo 等。

这样它应该可以工作。然而，当涉及到生产时，这种方法非常不受欢迎，因为你可能会陷入调试的地狱（性能/可靠性等）。

更好的方法是在不同的端口上运行多个 memcache 实例，恕我直言，这更干净。

# c# - 为什么 var 会是一件坏事？

> ID：545616
> 
>         
> 
> 赞同：58
> 
>         
> 
> 时间：2009-02-13T11:26:01.753
> 
>         
> 
> 标签：c#, coding-style, implicit-typing

前几天我一直在和我的同事聊天，听说他们的编码标准明确禁止他们`var`在 C# 中使用关键字。他们不知道为什么会这样，而且我总是发现隐式声明在编码时非常有用。我从来没有遇到任何问题找出变量是什么类型（你只需将鼠标悬停在 VS 中的变量上，你就会以这种方式获得类型）。

有谁知道为什么在 C# 中使用 var 关键字是个坏主意？

* * *

## 回答 #1

> 赞同：73
> 
>             
> 
> 时间：2009-02-13T11:41:53.637

2008 年 11 月出版的[.Net Framework Design Guidelines](https://rads.stackoverflow.com/amzn/click/com/0321545613)（很棒的书）的作者建议`var`在类型明显且明确时考虑使用。

另一方面，如果使用`var`会导致阅读代码时出现歧义，正如 Anton Gogolev 所指出的，那么最好不要使用它。

在书中（附件A），他们实际上给出了这个例子：

```
var names = new List<string>(); // good usage of var

string source = GetSource();
var tokens = source.Split(' '); // ok; most developers know String.Split

var id = GetId(); // Probably not good; it's not clear what the type of id is 
```

有可能，为了确保可读性不受低级开发人员的一时兴起，您的组织认为您不值得`var`并禁止它。

可惜，这就像拥有一个不错的工具供您使用，但将其保存在上锁的玻璃柜中。

在大多数情况下，使用`var`简单类型实际上有助于提高可读性，我们不能忘记使用`var`.

* * *

## 回答 #2

> 赞同：34
> 
>             
> 
> 时间：2009-02-13T11:29:14.883

```
var q = GetQValue(); 
```

确实是一件坏事。然而，

```
var persistenceManager = ServiceLocator.Resolve<IPersistenceManager>(); 
```

对我来说很好。

底线是：使用描述性标识符名称，你会相处得很好。

作为旁注：我想知道当不允许使用`var`关键字时他们如何处理匿名类型。或者他们完全不使用它们？

* * *

## 回答 #3

> 赞同：23
> 
>             
> 
> 时间：2009-02-13T11:46:55.277

在大多数情况下，当合理使用（即类型和值相同的简单类型初始化器）时，就可以了。

有时不清楚您是否通过更改它来破坏事物 - 主要是当初始化类型和（原始）变量类型不同时，因为：

*   该变量最初是基类

*   该变量最初是一个接口

*   该变量最初是另一种具有隐式转换运算符的类型

在这些情况下，您可能会遇到任何类型解析的问题 - 例如：

*   对两种竞争类型具有不同重载的方法

*   为两种竞争类型定义不同的扩展方法

*   已在其中一种类型上重新声明（隐藏）的成员

*   泛型类型推断将以不同的方式工作

*   运营商决议的工作方式不同

在这种情况下，您可以更改代码的含义，并执行不同的操作。那么这是一件坏事。

例子：

隐式转换：

```
static void Main() {
    long x = 17;
    Foo(x);
    var y = 17;
    Foo(y); // boom
}
static void Foo(long value)
{ Console.WriteLine(value); }
static void Foo(int value) {
throw new NotImplementedException(); } 
```

方法隐藏：

```
static void Main() {
    Foo x = new Bar();
    x.Go();
    var y = new Bar();
    y.Go(); // boom
}
class Foo {
    public void Go() { Console.WriteLine("Hi"); }
}
class Bar : Foo {
    public new void Go() { throw new NotImplementedException(); }
} 
```

ETC

* * *

## 回答 #4

> 赞同：18
> 
>             
> 
> 时间：2009-02-13T11:28:57.520

这当然是一个错误。这是因为有些人没有意识到它实际上是强类型的，根本不像 VB 中的 var。

并非所有的公司编码标准都有意义，我曾经为一家公司工作，该公司想在所有类名前加上公司名称。当公司更名时，进行了大规模的返工。

* * *

## 回答 #5

> 赞同：10
> 
>             
> 
> 时间：2009-02-13T11:55:59.310

首先，作为一般规则，编码标准应该得到团队的讨论和同意，并且应该写下它们背后的原因，这样任何人都可以知道它们为什么存在。他们不应该是一位大师的神圣真理。

其次，这条规则可能是合理的，因为**代码的读取次数多于写入次数**。`var`加快写作速度，但可能会减慢阅读速度。这显然不是像“始终初始化变量”这样的代码行为规则，因为这两种选择（写入`var`和写入类型）具有完全相同的行为。所以这不是一个关键规则。我不会禁止`var`，我只会使用“Prefer...”

* * *

## 回答 #6

> 赞同：8
> 
>             
> 
> 时间：2009-02-13T13:48:27.543

几个月前，我写了一篇关于这个主题的博客文章。对我来说，我尽可能使用它，并专门围绕类型推断设计我的 API。我使用类型推断的基本原因是

1.  它不会降低类型安全性

2.  它实际上会通过提醒您隐式转换来提高代码中的类型安全性。foreach 语句中的最佳示例

3.  在 C# 中维护 DRY 原则。这是专门针对申报情况的，何必说两遍呢？

4.  在某些情况下，它是完全需要的。示例匿名类型

5.  更少的打字而不损失功能。

[http://blogs.msdn.com/jaredpar/archive/2008/09/09/when-to-use-type-in​​ference.aspx](http://blogs.msdn.com/jaredpar/archive/2008/09/09/when-to-use-type-inference.aspx)

* * *

## 回答 #7

> 赞同：6
> 
>             
> 
> 时间：2009-02-13T11:31:06.767

`var`是最新的“如何布置你的牙套”/匈牙利符号/骆驼套管辩论。没有正确的答案，但有些人站在极端。

你的朋友很不幸，他们在其中一名极端分子手下工作。

* * *

## 回答 #8

> 赞同：5
> 
>             
> 
> 时间：2009-02-13T11:34:08.583

完全禁止它意味着禁止使用匿名类型（当您更多地使用 LINQ 时，它变得非常有用）。

这是简单明了的愚蠢，除非有人可以正式提出一个从不使用匿名类型的充分理由。

* * *

## 回答 #9

> 赞同：5
> 
>             
> 
> 时间：2016-06-17T14:20:13.027

**用简单的英语理解“var”**

我将向您展示使用 AND 不使用 'var' 是为了清楚地沟通。

我将展示使用 'var' 使代码更易于阅读的示例，以及使用 var 使事情难以理解的其他示例。

不仅如此，您还会看到“var”的清晰程度在很大程度上取决于您在代码中为其他所有内容命名的内容。

举个例子：

> 杰克向比尔打招呼。他不喜欢他，所以他转身往另一条路走。

谁走的另一条路？杰克还是比尔？在这种情况下，“Jake”和“Bill”就像类型名称。而“He”和“him”就像 var 关键字一样。在这种情况下，更具体可能会有所帮助。下面的例子就更清楚了。

> 杰克向比尔打招呼。杰克不喜欢比尔，所以他转身走另一条路。

在这种情况下，更具体使句子更清晰。但情况并非总是如此。在某些情况下，具体化会使阅读变得更加困难。

> 比尔喜欢书，所以比尔去了图书馆，比尔拿出一本比尔一直很喜欢的书。

在这种情况下，如果我们使用“他”并且在某些情况下将他的名字全部省略掉，这将更容易阅读句子，这相当于使用`var`关键字。

> 比尔喜欢书，所以他去图书馆拿出一本他一直很喜欢的书。

这些类比涵盖了要点，但并不能说明全部。看到在这些例子中，只有一种方式来指代这个人。要么用他们的名字，例如比尔，要么用更笼统的方式，如“他”和“他”。但我们只使用一个词。

在代码的情况下，您有两个“词”，类型和变量名。

```
Person p = GetPerson(); 
```

现在的问题变成了那里是否有足够的信息让您轻松确定`p`是什么？您是否仍然知道在这种情况下人们是什么：

```
var p = GetPerson(); 
```

这个怎么样：

```
var p = Get(); 
```

这个怎么样：

```
var person = Get(); 
```

或者这个：

```
var t = GetPerson(); 
```

或者这个：

```
var u = Person.Get(); 
```

关键字`var`在给定场景中是否有效在很大程度上取决于代码的上下文，例如变量、类和方法的名称，以及代码的复杂性。

我个人喜欢使用对**我来说**`var`更全面的关键字。但我也倾向于以类型命名我的变量，所以我并没有真正丢失任何信息。

 **也就是说，有时我会例外，这就是任何复杂事物的本质，软件如果不复杂就什么都不是。

* * *

## 回答 #10

> 赞同：4
> 
>             
> 
> 时间：2009-02-13T11:29:07.957

如果使用不当，可能会损害可读性。但是完全禁止它有点奇怪，因为如果没有它，您的同事将很难使用匿名类型。

* * *

## 回答 #11

> 赞同：4
> 
>             
> 
> 时间：2014-09-09T08:59:24.953

您可能会认为 Microsoft 的意见是相关的，因为 C# 是他们的语言：

> “但是，使用**var**至少有可能使其他开发人员更难以理解您的代码。因此，C# 文档通常仅在需要时才使用**var 。”**

请参阅[MSDN - Implicitly Typed Local Variables (C# Programming Guide)](http://msdn.microsoft.com/en-us/library/bb384061.aspx "隐式类型局部变量")的最后一段。

* * *

您还应该知道**var**删除了初始分配上的编译时数据类型测试。

```
var x = "mistake";     // error not found by compiler
int x = "mistake";     // error found 
```

由于大多数变量只分配一次，因此一致使用**var**几乎消除了对变量分配的所有数据类型测试。

这使您的代码容易受到意外更改的影响，例如合并工具或疲倦的开发人员所做的更改。

* * *

## 回答 #12

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T12:04:54.423

这确实是您的代码的可读性问题。

我个人的偏好是只对匿名类型使用“var”（实际上，如果您想使用匿名类型，则需要使用 var），而这些大多来自 LINQ 查询。在这些情况下，如果您的查询投射到新的（隐式和匿名）类型，您别无选择，只能使用 var。

然而，C# 3.0 很乐意让你在任何你喜欢的地方使用 var，在 LINQ 和匿名类型之外，例如：

```
var myint = 0;
var mystring = ""; 
```

是完全有效的，并且 myint 和 mystring 将被用于初始化它们的推断值强类型化。（因此，myint 是 System.Int32 而 mystring 是 System.String）。当然，在查看用于初始化变量的值时，它们将被隐式键入的类型是相当明显的，但是，我认为如果将上面的代码写成这样的话，代码的可读性会更好：

```
int myint = 0;
string mystring = ""; 
```

因为您可以一目了然地看到这些变量的确切类型。

考虑一下这个有点令人困惑的场景：

```
var aaa = 0;
double bbb = 0; 
```

完全有效的代码（如果有点不合常规的话），但在上面，我知道 bbb 是一个 double，尽管初始化值看起来是一个 int，但 aaa 绝对不会是一个 double，而是一个 int。

* * *

## 回答 #13

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T13:01:31.620

来自[Department of Declaration Redundancy Department](https://blog.codinghorror.com/department-of-declaration-redundancy-department/)（来自Jeff's [Coding Horror](http://www.codinghorror.com/)）：

> “无论何时何地，我都会使用隐式变量类型，它使我的代码更简洁。应该积极追求任何从我们的代码中删除冗余的东西——包括切换语言。”

我自己认为这*是*值得考虑的，但制定一个关于何时使用或不使用的综合指南将是**矫枉过正**。

* * *

## 回答 #14

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T12:57:16.917

隐式输入很棒，而那些完全禁止它的人会损害生产力并邀请脆弱的代码。

它几乎就像类型安全、经过编译器检查的鸭子类型，在重构时非常有用。例如，如果我有一个返回 List 的方法，并且我将它重构为返回 IEnumerable，那么该方法的任何调用者使用 var 关键字并且只使用 IEnumerable 方法都可以。如果我已明确指定，例如，List，那么我必须将其更改为 IEnumerable。

显然，如果任何隐式类型调用者需要 List 方法，那么我在构建时会遇到编译错误，但如果是这种情况，我可能无论如何都不应该更改返回类型。

* * *

## 回答 #15

> 赞同：2
> 
>             
> 
> 时间：2013-01-22T21:48:01.517

Eric Lippert[总结得很好](http://blogs.msdn.com/b/ericlippert/archive/2011/04/20/uses-and-misuses-of-implicit-typing.aspx)：

*   必要时使用 var；当您使用匿名类型时。

*   当声明的类型在初始化程序中很明显时，请使用 var，尤其是在创建对象时。这消除了冗余。

*   如果代码强调变量的语义“业务目的”并淡化其存储的“机械”细节，请考虑使用 var。

*   如果需要这样做以正确理解和维护代码，请使用显式类型。

*   无论您是否使用“var”，都使用描述性变量名称。变量名应该代表变量的语义，而不是其存储的细节；“decimalRate”不好；“利率”很好。

`int`我自己的观点：我发现使用,甚至 a之类的类型更难阅读，而且有点毫无`string`意义。毕竟它是关于可读性的（除了在 LINQ 中使用它的地方），所以当 vars 被喷溅时，它可能更难阅读，并且违背了语言设计者打算使用的关键字的目的。`bool``User`

* * *

## 回答 #16

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T12:56:10.307

当使用 var 导致类型属于某个基类而不是实际的 DataRow 类型时，我遇到过一些案例（当我通过 Table.Rows 集合进行 foreach 时）。那是我唯一一次遇到 var 问题。

* * *

## 回答 #17

> 赞同：-5
> 
>             
> 
> 时间：2012-08-01T22:58:38.470

`var`以下是我针对显式类型与显式类型的效率进行的测试的结果：

```
 private void btnVar_Click(object sender, EventArgs e)
    {
        Stopwatch obj = new Stopwatch();
        obj.Start();
        var test = "Test";
        test.GetType();
        obj.Stop();
        lblResults.Text = obj.Elapsed.ToString();
    }

    private void btnString_Click(object sender, EventArgs e)
    {
        Stopwatch obj = new Stopwatch();
        obj.Start();
        string test = "Test";
        obj.Stop();
        lblResults.Text = obj.Elapsed.ToString();

    } 
```

第一个标签结果是：00:00:00 000034

第二个标签结果是：00:00:00 00008

# cocoa-touch - NSURLRequest 和请求的页面

> ID：545634
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-13T11:32:45.200
> 
>         
> 
> 标签：cocoa-touch

我在 shouldStartLoadWithRequest 委托的 UIWebView 中捕获链接单击信息。我正在使用 mainDocumentURL 来获取点击链接的 url。这显示了完整的 url，但我只需要页面的名称，即请求的 .html、.htm 等。我看不到任何会返回这个的属性。我是否需要自己解析和提取这个，或者有人知道 NSURLRequest 中是否有一个属性或方法会返回这个。

非常感谢您的帮助。托尼

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T16:37:42.177

如果我对您的理解正确，您想转换为 NSString 然后使用它的方法。从你的 NSURLRequest 开始，你会做这样的事情（注意，我把它输入到一个网页中并且没有编译它）：

```
NSURL *url = [request URL];
NSString *filename = [[url path] lastPathComponent]; 
```

如果您的 URL 类似于[http://www.foo.com/bar/baz.html](http://www.foo.com/bar/baz.html)，这将为您提供“baz.html”。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T13:59:23.413

我认为您的意思是 URL 的路径。下面的代码提取一个字符串 s，其值为 @"/cheese.html"。

```
NSURL* u = [NSURL URLWithString:@"http://www.wibble.com/cheese.html"];
NSString* s = [u path]; 
```

查看 RFC 1808 的文档，它告诉您 URL 是如何构成的，然后阅读 Apple 的 NSURL 文档，它告诉您如何提取 URL 的这些部分。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T14:04:13.980

NSURL 可以提取大部分 URL 元素。我怀疑您的意思是可以通过路径消息访问的路径。

如果您真的想要路径中的扩展名，我建议您使用路径，然后检查返回的 NSString，或者通过发送`absoluteString`消息将整个 URL 转换为字符串。可以通过多种方式从 NSString 修剪扩展。

# drupal - 如何一起使用 Drupal 6 视图和面板参数？

> ID：545640
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-02-13T11:34:29.893
> 
>         
> 
> 标签：drupal, drupal-6, drupal-views

我需要为我的网站的一部分实现以下布局/设置：

使用以下面板布局：

**跨越全宽的顶列**包含：

- 与当前节点相关的图像的视图（使用 jquery 循环的问题主题）

**以下 3 列**包含：  

1.  左栏：4 个单层级分类术语列表：

    *   第一学期  

    *   第二学期（选择）  

    *   第三学期  

    *   第 4 学期

2.  中间列：在左列中选择的标记有分类术语的节点标题的列表视图  

    *   Node1 标题（用术语 2 标记）（已选择）

    *   Node2 标题（用术语 2 标记）

    *   等等

3.  右栏：中栏所选节点的内容

    *   节点 1

我是新手。我认为理论上我可以只用视图和面板来做到这一点，将术语 id 和节点 id 作为参数传递。但是我需要有人指出我正确的方向，因为我不知道如何使视图和面板的论点和上下文协同工作。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-26T01:13:15.167

您可能最好放弃面板并自己制作一个块以显示顶部面板。[Acquia Marina 主题](http://drupal.org/project/acquia_marina)的布局可让您进行此精确设置 - 内容上方但标题下方的块，其下方最多 3 列。只需继续从完成的页面复制他们的布局代码即可获得您正在寻找的效果，而无需使用面板模块。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2011-09-09T18:35:43.420

对于顶栏，您可以使用 Views Slideshow 模块。你应该会发现它非常简单。在 Views 样式设置中，只需选择 Slideshow 即可，然后您可以修改默认设置以达到您想要的效果。

下一个问题将取决于您如何实施分类。实际上，我发现使用术语 ID 作为参数是最直接的方法，而且我通常不需要设置特定的验证。

当使用必要的参数创建视图时，您需要定义如何检索它们。

面板让您可以选择 URL 的各个部分并定义它们的分类类型（例如），以便您可以将它们传递给视图。

在面板的基本设置中，使用将代表您的分类术语的占位符创建您的路径。

```
例如：
example.com/content/%term1/%term3/%term4

```

在上下文窗格中，定义您的术语并选择它们所属的词汇。

现在，当向面板添加视图时，在“设置”窗格中，您应该会找到一个菜单，允许您选择视图所需的术语。

# c++ - 使用 Informix 和 IBM CSDK 的多线程

> ID：545643
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-13T11:39:22.503
> 
>         
> 
> 标签：c++, multithreading, informix

我正在使用带有 IBM CSDK 客户端库的 C++ 中的 Informix。我使用库的多线程版本，每个线程都使用自己的 ITConnection 对象。如果产生了多个线程，应用程序仍然会崩溃。有没有人遇到过类似的问题？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2011-06-21T15:39:31.313

我解决了这个问题（对于 Solaris OS）。需要链接多读版本的库。它们被命名为 libth* 而不是 libif*。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-14T00:06:43.533

问题多于答案...

请确定哪个平台（操作系统和版本，如果可能需要硬件类型）以及哪个版本的 CSDK？（许多与产品相关的问题的标准规则。）

您在 C++ 代码中使用了哪些编译选项？您使用的链接线是什么？您对产品有支持吗？（如果有，请联系 IBM 技术支持。）您是否有针对该问题的堆栈回溯？

不，我没有看到这个问题，但我没有非常努力地推动代码的多线程版本 - 或者，对于大多数目的来说，根本没有。

*（由于您是新手，请通过编辑您的问题来添加额外信息，而不是添加“答案”。只有在您无法编辑问题时才添加答案。）*

# dns - 每个产品都需要自己的域吗？

> ID：545644
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-02-13T11:39:37.603
> 
>         
> 
> 标签：dns, subdomain, naming

我们正在开始一个我工作的新项目，其中一个正在谈论的事情是产品的名称。公司的其他人似乎非常重视可用的域名，例如。[产品].com。我是说 [product].[companydomain] 或 [companydomain]/[product] 都一样好并且显然可用。

我在胡说八道吗？拥有您想要的名称的域是否有强有力的论据？

* * *

## 回答 #1

> 赞同：14
> 
>             
> 
> 时间：2009-02-13T11:45:23.940

营销人员确实喜欢域名，因为在宣传册上打印 [product].com 比 [something]/[somethingelse]/[product] 更酷。鉴于域的成本约为每年 10 美元，这没什么大不了的。

另一方面，如果您的品牌已经很强大，[strongbrand]/[newproduct] 可能比 [unknownproduct].com 更好。你甚至可以将两者结合起来；只需获取新域，并将其重定向到您公司的站点（反之亦然）。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T11:55:40.967

要访问您的 gmail 帐户，您是访问 google.com/mail 还是仅访问 gmail.com。

microsoft.com/xbox 会和 xbox.com 一样有效吗？

我认为这在很大程度上取决于您的公司和您正在创造的产品。但是，product.com 域会产生很多影响。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T12:20:10.593

除了已经提到的原因，您绝对应该确保域名可用，否则其他人最终会获得您的一部分流量。他们可能想付费将其重定向给您，他们可能会向您出售域名以赚取巨额财富，或者他们可能会试图起诉您使用他们的名字......

无论您以何种方式看待它（收入损失、付费重定向），如果其他人拥有您产品的域名，您都会损失一些钱。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T11:54:58.627

如今，我们应该说域名是一个“域名”……人们将在互联网上了解您的产品，这意味着尽可能“干净”。所以我的建议是每个产品都有一个域名，即使您可以将产品名称与您的一般品牌结合起来......

# unix - 以不同语言打印纪元时间

> ID：545655
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-02-13T11:46:12.610
> 
>         
> 
> 标签：unix, datetime, time, epoch

如您所知，今晚，UTC 时间正好 23:31:30，大纪元时间将达到 1234567890！欢呼！

观察纪元时间的一种方法是使用 Perl：

```
perl -le 'while(true){print time();sleep 1;}' 
```

你能用另一种编程语言做同样的事情吗？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-02-13T12:44:22.597

这个[网站](http://www.epochconverter.com/)在我的收藏夹中，并且有很多答案

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T12:10:19.450

python单行：

```
python -c "while True: import time;print time.time();time.sleep(1)" 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T12:07:53.010

外壳脚本：

```
while :; do printf "%s\r" $(date +%s); sleep 1; done 
```

Python：

```
import time
import sys

while True:
    sys.stdout.write("%d\r" % time.time())
    sys.stdout.flush()
    time.sleep(1) 
```

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T12:36:31.460

php单行

```
php -r 'while(true) { echo time(), "\n"; sleep(1);}' 
```

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2012-02-03T21:47:44.703

Zsh - 高级 Unix Shell：

```
zmodload zsh/datetime && while true; do print $EPOCHSECONDS ; sleep 1; done 
```

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T11:50:48.420

爪哇：

```
System.out.println((new java.util.Date(0)).toString()); 
```

那是时代:) ...*当前*时间是：

```
System.out.println((new java.util.Date()).toString()); 
```

要获取自纪元以来经过的毫秒数，请执行以下操作：

```
System.out.println("" + (new java.util.Date()).getTime()); 
```

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T11:55:22.963

这将是 c# 中的相同代码：

```
 DateTime epoch = new DateTime(1970, 1, 1, 0, 0, 0);
    while (true)
    {
        Console.WriteLine((int)(DateTime.UtcNow - epoch).TotalSeconds);
        Thread.Sleep(1000);
    } 
```

就像 tehvan 说的那样，这是*当前*时间，而不是“纪元”时间

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T12:02:08.627

爪哇

```
import java.util.Date;

public class EpochTime {
    public static void main(String[] args) {
        while (true) {
            System.out.println(new Date().getTime() / 1000);
            try {
                Thread.sleep(1000);
            }
            catch (InterruptedException ignore) {
            }
        }
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2011-11-09T17:16:24.073

更多perl：

```
perl -MAnyEvent -MDateTime -E 'my $cv = AE::cv; my $w = AE::timer 0, 1, sub { say DateTime->now->epoch }; $cv->wait' 
```

# .net - 如何将 MS Windows 操作系统版本号转换为 .NET 中的产品名称？

> ID：545666
> 
>         
> 
> 赞同：31
> 
>         
> 
> 时间：2009-02-13T11:51:16.000
> 
>         
> 
> 标签：.net, windows, version, system.diagnostics, diagnostics

如何将 MS Windows 操作系统版本号翻译成产品名称？

例如，在 .NET 中，可以使用以下两个属性来确定产品是 MS Windows Vista Ultimate Edition：

`Environment.OSVersion.Platform returns Win32NT`

`Environment.OSVersion.Version returns 6.0.6001.65536`

* * *

## 回答 #1

> 赞同：53
> 
>             
> 
> 时间：2009-02-13T12:05:09.273

[howto net 操作系统版本](http://www.vb-helper.com/howto_net_os_version.html)

VB：

```
Public Function GetOSVersion() As String
    Select Case Environment.OSVersion.Platform
        Case PlatformID.Win32S
            Return "Win 3.1"
        Case PlatformID.Win32Windows
            Select Case Environment.OSVersion.Version.Minor
                Case 0
                    Return "Win95"
                Case 10
                    Return "Win98"
                Case 90
                    Return "WinME"
                Case Else
                    Return "Unknown"
            End Select
        Case PlatformID.Win32NT
            Select Case Environment.OSVersion.Version.Major
                Case 3
                    Return "NT 3.51"
                Case 4
                    Return "NT 4.0"
                Case 5
                    Select Case _
                        Environment.OSVersion.Version.Minor
                        Case 0
                            Return "Win2000"
                        Case 1
                            Return "WinXP"
                        Case 2
                            Return "Win2003"
                    End Select
                Case 6
                    Select Case _
                        Environment.OSVersion.Version.Minor
                        Case 0
                            Return "Vista/Win2008Server"
                        Case 1
                            Return "Win7/Win2008Server R2"
                        Case 2
                            Return "Win8/Win2012Server"
                        Case 3
                            Return "Win8.1/Win2012Server R2"
                    End Select
                Case 10  //this will only show up if the application has a manifest file allowing W10, otherwise a 6.2 version will be used
                  Return "Windows 10"
                Case Else
                    Return "Unknown"
            End Select
        Case PlatformID.WinCE
            Return "Win CE"
    End Select
End Function 
```

* * *

[C＃](http://snippets.dzone.com/user/mstampar/tag/version)

```
public string GetOSVersion()
{
  switch (Environment.OSVersion.Platform) {
    case PlatformID.Win32S:
      return "Win 3.1";
    case PlatformID.Win32Windows:
      switch (Environment.OSVersion.Version.Minor) {
        case 0:
          return "Win95";
        case 10:
          return "Win98";
        case 90:
          return "WinME";
      }
      break;

    case PlatformID.Win32NT:
      switch (Environment.OSVersion.Version.Major) {
        case 3:
          return "NT 3.51";
        case 4:
          return "NT 4.0";
        case 5:
          switch (Environment.OSVersion.Version.Minor) {
            case 0:
              return "Win2000";
            case 1:
              return "WinXP";
            case 2:
              return "Win2003";
          }
          break;

        case 6:
          switch(Environment.OSVersion.Version.Minor) {
            case 0:
              return "Vista/Win2008Server";
            case 1:
              return "Win7/Win2008Server R2";
            case 2:
              return "Win8/Win2012Server";
            case 3:
              return "Win8.1/Win2012Server R2";
          }
          break;
        case 10:  //this will only show up if the application has a manifest file allowing W10, otherwise a 6.2 version will be used
          return "Windows 10";
      }
      break;

    case PlatformID.WinCE:
      return "Win CE";
  }

  return "Unknown";
} 
```

* * *

## 回答 #2

> 赞同：13
> 
>             
> 
> 时间：2010-01-06T21:50:52.180

您可以使用 WMI 获取友好的产品名称（“Microsoft® Windows Server® 2008 Enterprise”）：

```
using System.Management;
var name = (from x in new ManagementObjectSearcher("SELECT * FROM Win32_OperatingSystem").Get().OfType<ManagementObject>()
                      select x.GetPropertyValue("Caption")).First();
return name != null ? name.ToString() : "Unknown"; 
```

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-02-13T12:14:33.213

[在 msdn http://msdn.microsoft.com/en-us/library/ms724429(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms724429(VS.85).aspx)上有一个 C++ 示例，以及有人添加的关于如何将其包装起来以便在 [VB] 中使用的注释。网。看起来您需要的“缺失”位是 Win32 函数[GetProductInfo](http://msdn.microsoft.com/en-us/library/ms724358(VS.85).aspx)（[对此的 PInvoke.net 参考](http://pinvoke.net/default.aspx/kernel32/GetProductInfo.html)）。

在此和 Avram 的答案之间，您应该能够组装完整版本的字符串。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2012-05-08T10:56:39.913

这是我的解决方案，最快且没有特定案例。

结果可以根据需要定制

```
 public static string SistemaOperativo
    {
        get
        {
            #region Dichiarazioni
            var osInfo = Environment.OSVersion;
            int platformID = (int)osInfo.Platform;
            int versionM = osInfo.Version.Major;
            int versionm = osInfo.Version.Minor;
            string servicePack = osInfo.ServicePack;
            #endregion

            #region Spiegazione logica
            /*
             * IT: 
             * La chiave del dizionario è il risultato del concatenamento di 
             * PlatformID,MajorVersion,MinorVersion, tutto convertito in Int32, 
             * per esempio Platform ID=1 MajorVersion=4 MinorVersion=0, 
             * il risultato è 140 ossia Windows 95
             * 
             * EN:
             * The key in Dictionary is the 'join' 
             * of PlatformID,MajorVersion,MinorVersion, in int32,
             * eg. Platform ID=1 MajorVersion=4 MinorVersion=0, 
             * the result is '140' (Windows 95)
            */
            #endregion
            Dictionary<int, string> sistemiOperativi = new Dictionary<int, string>(){
                        {0, "Windows 3.1"},
                        {140, "Windows 95"},
                        {1410, "Windows 98"},
                        {1490, "Windows ME"},
                        {2351, "Windows NT 3.51"},
                        {240, "Windows 4.0"},
                        {250, "Windows 2000"},
                        {251, "Windows XP"},
                        {252, "Windows 2003"},
                        {260, "Windows Vista/Server 2008"},
                        {261, "Windows 7"},
                        {-1, "Unknown"}
                   };
            int idUnivoco = int.Parse(string.Format("{0}{1}{2}", platformID, versionM, versionm));
            string outValue = "";
            if (sistemiOperativi.TryGetValue(idUnivoco, out outValue))
                return string.Format("{0}{1}", outValue, servicePack);
            return sistemiOperativi[-1];
        }
    } 
```

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2011-03-04T17:54:58.590

如果您只想要我使用的 GUI 友好信息消息

My.Computer.Info.OSFullName & " (" + My.Computer.Info.OSVersion + ")"

似乎是未来版本 Windows 的未来证明

# java - 如何使用 Windows 登录进行单点登录和桌面 Java 应用程序的 Active Directory 条目？

> ID：545667
> 
>         
> 
> 赞同：30
> 
>         
> 
> 时间：2009-02-13T11:52:08.540
> 
>         
> 
> 标签：java, active-directory, single-sign-on, windows-authentication

我想让我的桌面 Java 应用程序具有与 Active Directory 用户相关的单点登录。分两步，我想：

1.  确保特定用户已使用某些用户条目登录到 Windows。

2.  从 Active Directory 中查看该用户的一些设置信息

使用[Java：确定当前 Windows 用户的编程方式](https://stackoverflow.com/questions/31394/java-programatic-way-to-determine-current-windows-user)我可以获得当前 Windows 用户的名称，但我可以依赖它吗？我觉得

```
System.getProperty("user.name") 
```

不够安全？（“user.name”似乎是从环境变量中获得的，所以我不能依赖它，我想？）

问题[在 Linux 上使用 Java 对 Active Directory 进行](https://stackoverflow.com/questions/390150/authenticating-against-active-directory-with-java-on-linux)
身份验证为我提供了给定名称+通行证的身份验证，但我想基于 Windows 登录进行身份验证？

对于 Active Directory 访问，LDAP 可能是选择吗？

* * *

## 回答 #1

> 赞同：14
> 
>             
> 
> 时间：2009-10-06T02:11:31.903

不支持。Java 6 有改进，但还不够。

Java 有自己的 GSS 堆栈。问题在于单点登录，您需要从操作系统（而不是 Java 堆栈）获取 Kerberos 票证。否则，用户必须进行第二次身份验证（违背单点登录的目的）。

查看[http://java.sun.com/developer/technicalArticles/J2SE/security/](http://java.sun.com/developer/technicalArticles/J2SE/security/)。往下看“Access Native GSS-API”，它谈到了一个新的系统属性 sun.security.jgss.native，当它设置为 true 时，会导致 Java 使用底层的 OS GSS 实现，从而可以访问 OS 级别的身份验证。完美！....除了它仅支持 Solaris 和 Linux，不支持 Microsoft Windows。

然而，Java 6 似乎有足够的支持充当*服务器*，从 IE 接收 SPNEGO 身份验证请求，然后针对 Active Directory 对该用户进行身份验证。它只是仍然不完整的桌面客户端支持。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-02-13T15:14:27.197

将[JAAS](http://java.sun.com/javase/6/docs/technotes/guides/security/jaas/JAASRefGuide.html)与[LDAP LoginModule](http://java.sun.com/javase/6/docs/jre/api/security/jaas/spec/com/sun/security/auth/module/LdapLoginModule.html)一起使用。这将允许您插入底层 Java 安全基础设施。

当您需要使应用程序脱机或“调试”应用程序时，您可以轻松地将 LDAP 模块换成虚拟模块。这允许您继续测试您的“安全性”，而不依赖于 Active Directory。高度可测试，解耦，并且您可以在稍后的时间验证方案，几乎没有任何悲伤。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2010-11-15T13:19:22.937

Project [Waffle](http://waffle.codeplex.com)具有在 Windows 上执行 SSO 的客户端和服务器端代码。它基于 JNA，不需要本地库。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T12:01:54.040

[在http://jcifs.samba.org/](http://jcifs.samba.org/)检查 jCifs 

除此之外，坚持使用 LDAP（实际上，这应该是我的第一次尝试，但是......）

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T13:02:22.070

您是否考虑过使用 JNA api（允许您轻松地对操作系统进行本机调用）？

[您可以在http://msdn.microsoft.com/en-us/library/ms724432(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms724432(VS.85).aspx)上调用 win32 方法`GetCurrentUser`MSDN 文档。它位于 Advapi32.dll 中。

如果需要，它还有一个 unicode 版本，GetCurrentUserW。

你是对的。似乎可以更改环境变量，因此可能会误导使用。

我不确定跨平台对 32/64 位窗口的影响。如果您需要代码中的解决方案，我相信我可以为它写一些东西。

但是，是的，只是一个想法:)

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T15:24:45.330

使用[Spring Security](http://static.springframework.org/spring-security/site/index.html)可能会获得最大的灵活性。您可以将它与 JAAS 和 LDAP 身份验证一起使用。

# c# - 断言 IEnumerables

> ID：545671
> 
>         
> 
> 赞同：22
> 
>         
> 
> 时间：2009-02-13T11:53:17.070
> 
>         
> 
> 标签：c#, unit-testing

由于我们公司不使用单元测试，我正在自学对自己的代码进行单元测试。我正在使用标准的.net 测试框架进行一些非常基本的单元测试。

我的一个方法返回一个`IEnumerable<string>`，我想测试它的输出。所以我创建了一个`IEnumerable<string>`预期来测试它。我以为我记得有一种方法`Assert.ArePartsEqual`或类似的方法，但我似乎找不到它。

简而言之，我如何测试两个是否`IEnumerable<string>`包含相同的字符串？

* * *

## 回答 #1

> 赞同：30
> 
>             
> 
> 时间：2009-02-17T08:54:11.310

我不知道您指的是哪个“标准 .net 测试框架”，但如果它是 Visual Studio Team System 单元测试的东西，您可以使用[CollectionAssert](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.collectionassert.aspx)。

您的测试将是这样的：

```
CollectionAssert.AreEqual(ExpectedList, ActualList, "..."); 
```

**更新：**我忘记了 CollectionAssert 需要一个 ICollection 接口，所以你必须调用 ActualList.ToList() 来编译它。返回 IEnumerable 是一件好事，所以不要仅仅为了测试而改变它。

* * *

## 回答 #2

> 赞同：13
> 
>             
> 
> 时间：2009-02-13T11:55:26.317

您想要[`SequenceEqual()`](https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.sequenceequal?view=net-5.0)扩展方法（LINQ）：

```
 string[] x = { "abc", "def", "ghi" };
    List<string> y = new List<string>() { "abc", "def", "ghi" };

    bool isTrue = x.SequenceEqual(y); 
```

要不就：

```
 bool isTrue = x.SequenceEqual(new[] {"abc","def","ghi"}); 
```

（如果它们的长度不同，或者任何项目不同，它将返回 false）

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2009-02-13T11:56:50.790

我有一个示例，用于我的“在 60 分钟内实现 LINQ to Objects”演讲。

它也在我的[MoreLinq](https://github.com/morelinq/MoreLINQ)项目中。试图在这里把它塞进去，它包裹得很可怕。直接从Github[上抢](https://github.com/morelinq/MoreLINQ/blob/master/MoreLinq.Test/TestExtensions.cs)...

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2021-01-11T13:11:19.963

使用 NUnit 3+ 'constraint' 断言有一个简单但不明显的方法：

```
Assert.That(result, Is.EqualTo(expected).AsCollection, "My failure message"); 
```

这将为您提供与其他答案中提到的 linq 相同的内容：

```
Assert.That(result.SequenceEqual(expected), "My failure message"); 
```

但是该`AsCollection`版本会告诉您第一个区别在哪里，以及长度是否不同。

请参阅[https://docs.nunit.org/articles/nunit/writing-tests/constraints/EqualConstraint.html#comparing-arrays-collections-and-ienumerables](https://docs.nunit.org/articles/nunit/writing-tests/constraints/EqualConstraint.html#comparing-arrays-collections-and-ienumerables)

# wpf - 保存应用了着色器效果的 WPF 图像

> ID：545676
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-02-13T11:55:09.530
> 
>         
> 
> 标签：wpf, imaging

我有一个带有附加模糊效果的 WPF 图像控件。有没有办法在不使用 RenderTargetBitmap 的情况下保存图像（模糊）？

谢谢你。

更新：我现在使用派生自 System.Windows.Media.Effects.ShaderEffect 的新自定义效果。我想保存应用了着色器效果的图像。

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-02-21T18:44:19.300

渲染位图的唯一方法是使用 RenderTargetBitmap。

看看这个例子：

```
BitmapSource bitmap=GetYourBitmap();
Rectangle r=new Rectangle();
r.Background=new ImageBrush(bitmap);
r.Effect=yourEffect;

Size sz=new Size(bitmap.PixelWidth, bitmap.PixelHeight);
r.Measure(sz);
r.Arrange(new Rect(sz);

var rtb=new RenderTargetBitmap();
rtb.Render(r);
return rtb;//here is your bitmap with effects applied 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-11-06T20:28:06.530

我知道这是一个老问题......但我想我会向人们指出 Jamie Rodriguez 的帖子（[http://blogs.msdn.com/jaimer/archive/2009/07/03/rendertargetbitmap-tips.aspx](http://blogs.msdn.com/jaimer/archive/2009/07/03/rendertargetbitmap-tips.aspx)）学科。

我遇到过使用 RenderTargetBitmap 会导致图像为空的情况……而 Jamie 的帖子就是我的答案。

希望它也对其他人有所帮助。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2010-01-28T19:52:04.050

这也是我想要的。据此：[http](http://social.msdn.microsoft.com/Forums/en/wpfprerelease/thread/e2ebf264-e087-4bfe-a69b-24c884675c80) : //social.msdn.microsoft.com/Forums/en/wpfprerelease/thread/e2ebf264-e087-4bfe-a69b-24c884675c80 RenderTargetBitmap 不使用硬件（GPU）进行渲染，仅使用软件。太遗憾了。

千伏

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T14:00:29.027

由于着色器效果是根据定义应用在显卡上的，因此在主内存中获取它的唯一方法是从屏幕内存中获取它。所以 RenderTargetBitmap 是您的解决方案。你有什么特别的原因要避免它吗？

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2013-07-16T11:45:32.510

给你：[http](http://perspectivefx.codeplex.com/) ://perspectivefx.codeplex.com/和 GPU 完成的所有工作

# c# - 我可以更改 Visual Studio 中网站的警告设置吗？

> ID：545683
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-13T11:56:31.900
> 
>         
> 
> 标签：c#, asp.net, visual-studio, web, warnings

我可以将警告作为错误打开，并为我的解决方案中的所有项目排除某些警告，但网站（不是 Web 应用程序）除外。

无论如何打开“警告作为错误”作为网站的错误，是否有关闭整个网站或子文件夹的某些错误？

**更新**我正在使用带有 C# 的 ASP.Net

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T14:17:44.307

我知道的唯一方法是将其直接添加到您的`configuration`元素下的 web.config 中：

```
<system.codedom>
    <compilers>
        <compiler
           language="c#;cs;csharp" extension=".cs"
           compilerOptions="/warnaserror"
           type="Microsoft.CSharp.CSharpCodeProvider,
         System, Version=2.0.0.0, Culture=neutral,
         PublicKeyToken=b77a5c561934e089" />
    </compilers>
</system.codedom> 
```

[这是我最初发现这个技巧的地方。](http://odetocode.com/Blogs/scott/archive/2006/08/10/5557.aspx)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T14:27:02.583

前段时间我问过这个问题，关于如何在 Visual Studio 中禁用某些警告——它专门用于 VB.NET，但我认为你可以应用它 C#。

[如何在visual-studio-for-a-visual-basic-web-deployment-project中禁用警告](https://stackoverflow.com/questions/450632/how-to-disable-warnings-in-visual-studio-for-a-visual-basic-web-deployment-projec)

# bnf - 描述一些东西，我应该使用 Backus-Naur 形式吗？

> ID：545688
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-02-13T12:00:02.373
> 
>         
> 
> 标签：bnf, scripting-language

我想描述一个复杂的脚本和可能的编程语言。在做任何事情之前，我正在考虑用 Backus-Naur 形式描述它（不包括虚拟/示例脚本代码）

除了巴库斯-瑙尔形式，还有另一种描述语言的形式吗？我应该考虑哪些替代方案？

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-02-13T12:09:07.937

显而易见的替代方案是[扩展 Backus-Naur 形式](http://en.wikipedia.org/wiki/Extended_Backus%E2%80%93Naur_form)，但是可以使用的其他形式很少，我找到了一些快速搜索的链接：

[增强的 BNF](http://en.wikipedia.org/wiki/Augmented_Backus%E2%80%93Naur_Form)

[Wirth 语法符号](http://en.wikipedia.org/wiki/Wirth_syntax_notation)

[Van Wijngaarden 语法](http://en.wikipedia.org/wiki/Van_Wijngaarden_grammar)

我个人会坚持使用 BNF / EBNF，因为以某种形式使用它的信息和工具的流行。像[bison](http://www.gnu.org/software/bison/)或[yacc](http://dinosaur.compilertools.net/)这样的工具可以帮助从这样的语法生成解析器，并使生成解释器变得非常简单。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-02-13T12:06:22.250

这取决于您希望描述该语言的正式程度。Backus-Naur 形式旨在描述上下文无关语法。因此，如果您想描述上下文无关的语法，巴库斯-瑙尔形式可能是最好的方法，因为它是描述这些的最广为人知的形式。

但是，如果您希望描述您的语义或更复杂的语法，您将需要使用其他方式。如果您还想描述您的语义，则需要根据语言特征（例如使用递归）在小步语义或大步语义之间进行选择。

请注意，如果您的语法不能使用上下文无关语法来表达，那么 BNF 根本不足以表达您的语言，您可能必须考虑使用上下文相关语法来描述您的语言。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T12:06:19.740

BNF 是一个好的开始，有几个解析器生成器可以将其用作输入。如果您打算使用 C++，[Boost.Spirit就是一个很好的例子。](http://spirit.sourceforge.net/)

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T12:13:55.883

您可能想查看 Microsoft 的“M”。这是一种语言/语法，允许您描述另一种语言（如 BNF 一样）。这被用作开发您自己的领域驱动语言的基础。

[来自微软的“M”](http://msdn.microsoft.com/en-us/library/dd129523(VS.85).aspx)

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T13:20:03.463

您还可以考虑使用[ANTLR](http://en.wikipedia.org/wiki/ANTLR)，它使用接近 BNF 的语法/形式语言。它将帮助您构建解释器/编译器。

# php - 需要指导以开始使用 Zend ACL

> ID：545702
> 
>         
> 
> 赞同：30
> 
>         
> 
> 时间：2009-02-13T12:07:17.210
> 
>         
> 
> 标签：php, zend-framework, authentication, user-controls, acl

我目前正在一个需要 ACL 的站点上工作，并且由于我正在使用 Zend，因此使用他们的 ACL 类对我来说是有意义的，但我对如何做到这一点几乎没有任何想法。我已经阅读了文档，但它让我更加困惑......基本上我想做的就是设置两个用户组，例如“普通”和“管理员”，普通用户可以访问所有具有非管理员控制器的页面，而admin 显然可以访问管理控制器页面。

我有很多问题：

1.  我该如何设置？

2.  我应该通过数据库还是 config.ini 运行它？

3.  我在哪里放置我的 ACL.php？

4.  我该如何编写这样的脚本？

5.  然后我该如何调用，这是在索引中完成的吗？

如果您能引导我访问一个网站或一个好的教程，我将不胜感激。

* * *

## 回答 #1

> 赞同：38
> 
>             
> 
> 时间：2009-02-13T12:59:40.500

我不久前实施了类似的事情。示例代码中遵循基本概念。

我创建了自己的 configAcl.php 文件，该文件加载到引导文件中，在我的例子中是 index.php。根据您的情况，情况如下：

```
$acl = new Zend_Acl();

$roles  = array('admin', 'normal');

// Controller script names. You have to add all of them if credential check
// is global to your application.
$controllers = array('auth', 'index', 'news', 'admin');

foreach ($roles as $role) {
    $acl->addRole(new Zend_Acl_Role($role));
}
foreach ($controllers as $controller) {
    $acl->add(new Zend_Acl_Resource($controller));
}

// Here comes credential definiton for admin user.
$acl->allow('admin'); // Has access to everything.

// Here comes credential definition for normal user.
$acl->allow('normal'); // Has access to everything...
$acl->deny('normal', 'admin'); // ... except the admin controller.

// Finally I store whole ACL definition to registry for use
// in AuthPlugin plugin.
$registry = Zend_Registry::getInstance();
$registry->set('acl', $acl); 
```

另一种情况是，如果您想在所有控制器上只允许普通用户“列出”操作。这很简单，你可以像这样添加一行：

```
$acl->allow('normal', null, 'list'); // Has access to all controller list actions. 
```

接下来，您应该创建新插件，该插件会在请求某些控制器操作时自动进行凭据检查。此检查发生在每次调用控制器操作之前调用的 preDispatch() 方法中。

这是 AuthPlugin.php：

```
class AuthPlugin extends Zend_Controller_Plugin_Abstract
{
    public function preDispatch(Zend_Controller_Request_Abstract $request)
    {
        $loginController = 'auth';
        $loginAction     = 'login';

        $auth = Zend_Auth::getInstance();

        // If user is not logged in and is not requesting login page
        // - redirect to login page.
        if (!$auth->hasIdentity()
                && $request->getControllerName() != $loginController
                && $request->getActionName()     != $loginAction) {

            $redirector = Zend_Controller_Action_HelperBroker::getStaticHelper('Redirector');
            $redirector->gotoSimpleAndExit($loginAction, $loginController);
        }

        // User is logged in or on login page.

        if ($auth->hasIdentity()) {
            // Is logged in
            // Let's check the credential
            $registry = Zend_Registry::getInstance();
            $acl = $registry->get('acl');
            $identity = $auth->getIdentity();
            // role is a column in the user table (database)
            $isAllowed = $acl->isAllowed($identity->role,
                                         $request->getControllerName(),
                                         $request->getActionName());
            if (!$isAllowed) {
                $redirector = Zend_Controller_Action_HelperBroker::getStaticHelper('Redirector');
                $redirector->gotoUrlAndExit('/');
            }
        }
    }
} 
```

最后的步骤是加载您的 configAcl.php 并在引导文件（可能是 index.php）中注册 AuthPlugin。

```
require_once '../application/configAcl.php';

$frontController = Zend_Controller_Front::getInstance();
$frontController->registerPlugin(new AuthPlugin()); 
```

所以这是基本概念。我没有测试上面的代码（复制粘贴和重写只是为了展示）所以它不是防弹的。只是提供一个想法。

**编辑**

为了清晰。AuthPlugin 中的上述代码假设 $identity 对象填充了用户数据（数据库中的“角色”列）。这可以在登录过程中完成，如下所示：

```
[...]
$authAdapter = new Zend_Auth_Adapter_DbTable($db);
$authAdapter->setTableName('Users');
$authAdapter->setIdentityColumn('username');
$authAdapter->setCredentialColumn('password');
$authAdapter->setIdentity($username);
$authAdapter->setCredential(sha1($password));
$authAdapter->setCredentialTreatment('? AND active = 1');
$auth = Zend_Auth::getInstance();
$result = $auth->authenticate($authAdapter);
if ($result->isValid()) {
    $data = $authAdapter->getResultRowObject(null, 'password'); // without password
    $auth->getStorage()->write($data);
[...] 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2013-11-18T22:09:05.533

这个解决方案可能被证明是 Zend_Acl 的最简单的实现。

例子：

```
class UserController extends Zend_Controller_Action {

    public function preDispatch(){

        $resource = 'user_area';
        $privilege = $this->_request->getActionName();
        if (!$this->_helper->acl($resource, $privilege)) $this->_redirect();

    }

} 
```

Zend/Controller/Action/Helper/Acl.php

```
class Zend_Controller_Action_Helper_Acl extends Zend_Controller_Action_Helper_Abstract {

    protected $acl;
    protected $role;

    protected function getAcl(){

        if (is_null($this->acl)){

            $acl = new Zend_Acl();

            $acl->addResource(new Zend_Acl_Resource('user_area'));
            $acl->addResource(new Zend_Acl_Resource('customer_area'), 'user_area');
            $acl->addResource(new Zend_Acl_Resource('web_area'));

            $acl->addRole(new Zend_Acl_Role('guest'));      
            $acl->addRole(new Zend_Acl_Role('user'), 'guest');

            $acl->allow('guest', 'web_area');
            $acl->allow('guest', 'user_area', array(
                'forgot-password',
                'login'
            ));
            $acl->allow('user', 'user_area');
            $acl->allow('customer', 'customer_area');

            $this->acl = $acl;

        }

        return $this->acl;

    }

    protected function getRole(){

        if (is_null($this->role)){

            $session = new Zend_Session_Namespace('session');
            $role = (isset($session->userType)) ? $session->userType : 'guest';
            $this->role = $role;

        }

        return $this->role;

    }

    public function direct($resource, $privilege = null){

        $acl = $this->getAcl();
        $role = $this->getRole();
        $allowed = $acl->isAllowed($role, $resource, $privilege);
        return $allowed;

    }

} 
```

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2014-08-25T05:45:13.593

玩这个结构。从数据库中获取角色和资源并将其保存在会话中或任何缓存中。![在此处输入图像描述](https://i.stack.imgur.com/gzBL4.png)

# c# - 列表组合
>

> ID：545703
> 
>         
> 
> 赞同：26
> 
>         
> 
> 时间：2009-02-13T12:07:45.867
> 
>         
> 
> 标签：c#, linq, generics, list, combinations

我有一个这种类型的列表 List> 包含这个

```
List<int> A = new List<int> {1, 2, 3, 4, 5};
List<int> B = new List<int> {0, 1};
List<int> C = new List<int> {6};
List<int> X = new List<int> {....,....}; 
```

我想要这样的所有组合

```
1-0-6
1-1-6
2-0-6
2-1-6
3-0-6 
```

等等。

根据您的说法，这可以使用 Linq 解决吗？

* * *

## 回答 #1

> 赞同：39
> 
>             
> 
> 时间：2009-02-13T12:27:20.203

这与我对另一个问题的[回答](https://stackoverflow.com/questions/312732/whats-a-good-way-for-figuring-out-all-possible-words-of-a-given-length/312761#312761)非常相似：

```
var combinations = from a in A
                   from b in B
                   from c in C
                   orderby a, b, c
                   select new List<int> { a, b, c };

var x = combinations.ToList(); 
```

对于可变数量的输入，现在添加了泛型：

```
var x = AllCombinationsOf(A, B, C);

public static List<List<T>> AllCombinationsOf<T>(params List<T>[] sets)
{
    // need array bounds checking etc for production
    var combinations = new List<List<T>>();

    // prime the data
    foreach (var value in sets[0])
        combinations.Add(new List<T> { value });

    foreach (var set in sets.Skip(1))
        combinations = AddExtraSet(combinations, set);

    return combinations;
}

private static List<List<T>> AddExtraSet<T>
     (List<List<T>> combinations, List<T> set)
{
    var newCombinations = from value in set
                          from combination in combinations
                          select new List<T>(combination) { value };

    return newCombinations.ToList();
} 
```

* * *

## 回答 #2

> 赞同：15
> 
>             
> 
> 时间：2009-02-13T12:16:05.083

如果维数是固定的，这很简单`SelectMany`：

```
var qry = from a in A
          from b in B
          from c in C
          select new {A=a,B=b,C=c}; 
```

但是，如果维数是由数据控制的，则需要使用递归：

```
static void Main() {
    List<List<int>> outerList = new List<List<int>>
    {   new List<int>(){1, 2, 3, 4, 5},
        new List<int>(){0, 1},
        new List<int>(){6,3},
        new List<int>(){1,3,5}
    };
    int[] result = new int[outerList.Count];
    Recurse(result, 0, outerList);
}
static void Recurse<TList>(int[] selected, int index,
    IEnumerable<TList> remaining) where TList : IEnumerable<int> {
    IEnumerable<int> nextList = remaining.FirstOrDefault();
    if (nextList == null) {
        StringBuilder sb = new StringBuilder();
        foreach (int i in selected) {
            sb.Append(i).Append(',');
        }
        if (sb.Length > 0) sb.Length--;
        Console.WriteLine(sb);
    } else {
        foreach (int i in nextList) {
            selected[index] = i;
            Recurse(selected, index + 1, remaining.Skip(1));
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：9
> 
>             
> 
> 时间：2011-11-30T17:18:59.197

下面如何使用 .Join 方法生成组合？

```
static void Main()
{
    List<List<int>> collectionOfSeries = new List<List<int>>
                                {   new List<int>(){1, 2, 3, 4, 5},
                                    new List<int>(){0, 1},
                                    new List<int>(){6,3},
                                    new List<int>(){1,3,5}
                                };
    int[] result = new int[collectionOfSeries.Count];

    List<List<int>> combinations = GenerateCombinations(collectionOfSeries);

    Display(combinations); 
} 
```

此方法**GenerateCombinations(..)**主要工作是生成组合。**此方法是通用的，因此可用于生成任何类型的组合。** 

```
private static List<List<T>> GenerateCombinations<T>(
                                List<List<T>> collectionOfSeries)
{
    List<List<T>> generatedCombinations = 
        collectionOfSeries.Take(1)
                          .FirstOrDefault()
                          .Select(i => (new T[]{i}).ToList())                          
                          .ToList();

    foreach (List<T> series in collectionOfSeries.Skip(1))
    {
        generatedCombinations = 
            generatedCombinations
                  .Join(series as List<T>,
                        combination => true,
                        i => true,
                        (combination, i) =>
                            {
                                List<T> nextLevelCombination = 
                                    new List<T>(combination);
                                nextLevelCombination.Add(i);
                                return nextLevelCombination;
                            }).ToList();

    }

    return generatedCombinations;
} 
```

显示助手..

```
private static void Display<T>(List<List<T>> generatedCombinations)
{
    int index = 0;
    foreach (var generatedCombination in generatedCombinations)
    {
        Console.Write("{0}\t:", ++index);
        foreach (var i in generatedCombination)
        {
            Console.Write("{0,3}", i);
        }
        Console.WriteLine();
    }
    Console.ReadKey();
} 
```

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2014-06-17T19:16:42.180

```
//Done in 2 while loops. No recursion required
#include<stdio.h>
#define MAX 100
typedef struct list
{
  int elements[MAX];
}list;
list n[10];
int number,count[10],temp[10];
void print();
int main()
{
  int i,j,mult=1,mult_count;
  printf("Enter the number of lists - ");
  scanf("%d",&number);
  for(i=0;i<number;i++)
  {
    printf("Enter the number of elements - ");
    scanf("%d",&count[i]);
    for(j=0;i<count[i];j++)
    {
      printf("Enter element %d - "j);
      scanf("%d",&n[i].elements[j]);
    }
  }
  for(i=0;i<number;i++)
  temp[i]=0;
  for(i=0;i<number;i++)
  mult*=count[i];
  printf("%d\n",mult);
  mult_count=0;
  while(1)
  {
    print();
    mult_count++;
    if(mult_count==mult)
    break;
    i=0;
    while(1)
    {
      temp[i]++;
      if(temp[i]==count[i])
      {
        temp[i]=0;
        i++;
      }
      else break;
    }
  }
  return 0;
}
void print()
{
  int i;
  for(i=0;i<number;i++)
  {
    printf("%d\n",n[i].elements[temp[i]]);
    printf("\n");
  }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2016-08-17T15:23:22.433

只是为了好玩：

```
using CSScriptLibrary;
using System;
using System.Collections.Generic;

namespace LinqStringTest
{
    public class Program
    {
        static void Main(string[] args)
        {

            var lists = new List<List<int>>() {
                new List<int> { 0, 1, 2, 3 },
                new List<int> { 4, 5 },
                new List<int> { 6, 7 },
                new List<int> { 10,11,12 },
            };
            var code = GetCode(lists);
            AsmHelper scriptAsm = new AsmHelper(CSScript.LoadCode(code));

            var result = (IEnumerable<dynamic>)scriptAsm.Invoke("Script.LinqCombine", lists);

            foreach (var item in result)
            {
                Console.WriteLine(item);
            }

            Console.ReadLine();
        }

        private static string GetCode(List<List<int>> listsToCombine)
        {
            var froms = "";
            var selects = "";

            for (int i = 0; i < listsToCombine.Count; i++)
            {
                froms += string.Format("from d{0} in lists[{0}]{1}", i, Environment.NewLine);
                selects += string.Format("D{0} = d{0},", i);
            }

            return @"using System;
              using System.Linq;
              using System.Collections.Generic;
              public class Script
              {
                  public static IEnumerable<dynamic> LinqCombine(List<List<int>> lists)
                  {
                        var x = " + froms + @"
                                select new { " + selects + @" };
                        return x;
                  }
              }";
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2017-09-15T20:56:23.030

```
 public static List<List<string>> CrossProduct(List<List<string>> s)
    {
        if (!s.Any())
            return new List<List<string>>();

        var c1 = s.First();
        var cRest = s.Skip(1).ToList();
        var sss = from v1 in c1
                  from vRest in CrossProduct(cRest)
                  select (new[] { v1 }.Concat(vRest)).ToList();
        var r = sss.ToList();
        return r;
    } 
```

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2017-12-01T07:51:16.337

Abhijeet Nagre 的绝佳解决方案。在某些系列为空或系列为空的情况下的小改进。

```
List<List<T>> generatedCombinations = 
    collectionOfSeries.Where(l => l.Any())
                      .Take(1)
                      .DefaultIfEmpty(new List<T>())
                      .First()
                      .Select(i => (new T[]{i}).ToList())                          
                      .ToList(); 
```

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2020-12-24T21:03:11.367

从输入列表中生成所有组合

```
var combinations = AllCombinationsOf(A, B, C);

public static IEnumerable<List<T>> AllCombinationsOf<T>(params List<T>[] inputs)
{
    var seed = Enumerable.Repeat(new List<T>(), 1);
    return inputs.Aggregate(seed, CreateCombinations);
}

private static IEnumerable<List<T>> CreateCombinations<T>(IEnumerable<List<T>> oldCombinations, List<T> newValues)
    =>  from value in newValues
        from combination in oldCombinations
        select new List<T>(combination) {value}; 
```

[@Garry Shutler的](https://stackoverflow.com/users/6369)[这个答案](https://stackoverflow.com/a/545740/4769802)的简化版本。

[在线尝试！](https://tio.run/##jVVZb9pAEH7nV4xQpdqVYzVJm4cQkAiKeuVqQO1DkofFGchKZu3srpNGyL@dzi42@OLYB/AxxzfzfTMO1EEQSVwkiospDN@VxlmnVbzzB1EYYqB5JJT/DQVKHlQsLrl46bRags1QxSxA@MU0a81bQCcImVJwK6OpZDP7ZL6Ik3HIA1Caafr7cSGSGUo2DvHskit9Nur1oB@Gg2g25oLZxDcTeurEjGIoyIzuH4GLONHKzVK9MgkK8Qm6sA7p32GMTDsC33JHx/Xg0O1YH4k6kSIL5PenU4lTptExcTwYSHLFIhByS1utWPJXerG1grqvSd1oGoVPRTsvBwoE@g8LE6QSDdhuD2AioxlVSg8J9NrAvjfHvg/W0YxVJf7KVqEhFoqtKXi6MLd50s5i5bCs9zXiT3DFuHCUlqQDYoLJaQbSUry6MmfIZ3GII1RaOVnb8/OboJtc5uWAKSwZUKPzy0rDLYBS2A2pB1RuRCL4K7lGkik67aUbaON32q7gmdAssOAZHKMlYmqM8mZieqOyblOp80MPvqbubr@LEGcotLpFaUIUInwmAdaDlKHnig5t9qKka2bm@HdMTNGhyCXYbrPx0DLvcCOp4qxUY1RKcP1RZP4dd0PcUdSXkr0bFhuLMV2/Q5WEmiqqzbhja23yLfHoNOb@0H7Q1xY2RJPiBBB1iu6lNFp/4/oZ5qUWpVmLyWu@oe4UMHtwClXJNMvsiuln/zZ6czZErNIE3W6hObRzE2G6XE6V7jsaDWO1YUAMKX3iYrUDuNA9K/EjD449@GJk2qm5nNddjKYbLAd1y5O0wrCxe8kgb1FH34Nz2slrEVbC1FkgTYgHkXfjowL8x8z01@Y@16Zt1hLx/eOO4VxvAyr9JPW2GBxuNTjaFeFoV4TjLEJZLVtWW16r2UmruvfZRsb4mr7z1KPl7vd/RvQdaB@0vVWg0nbhxNbQWpKcd42OIUx/ZwrmeZ5034Er68fvi3e7TQyEFS6SlH1I4yU0fb6UW5@wzYpyMmyxjGLMt3x119Th1qH2l@MNn@B8dTXIrmgNVCppXgUlNg2AyFBZdt3FZ626B93U61KqbA@aZDZr83egSuo8c0v3JHPL3lv@pov/)（测试用例与问题示例一起包含）

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2021-01-04T09:08:11.667

没有 Linq 和递归的解决方案：

```
private List<List<T>> GetAllCombinations<T>(List<List<T>> source)
{
    List<List<T>> result = new List<List<T>>();

    foreach (var value in source[0])
    {
        result.Add(new List<T> { value });
    }

    for (int i = 1; i < source.Count; i++)
    {
        var resultCount = result.Count;

        for (int j = 1; j < source[i].Count; j++)
        {
            for (var k = 0; k < resultCount; k++)
            {
                result.Add(new List<T>(result[k]));
            }
        }

        var t = (result.Count / source[i].Count);

        for (int j = 0; j < source[i].Count; j++)
        {
            for (int k = 0; k < t; k++)
            {
                result[j * t + k].Add(source[i][j]);
            }
        }
    }

    return result;
} 
```

# java - xml命名空间到java，如何建模“选择”？

> ID：545705
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-13T12:08:42.073
> 
>         
> 
> 标签：java, xml, namespaces, axis2, choice

在java中表示“选择”命名空间标签的最佳方式是什么？IE。

```
<xs:complexType name="MyType">
  <xs:sequence>
    <!-- common elements here -->
    <xs:element type="xs:string" name="name" ... />
  </xs:sequence>
  <xs:choice>
    <xs:element name="stringValue" type="xs:string"></xs:element>
    <xs:element name="intValue" type="xs:int"></xs:element>
  </xs:choice>
</xs:complexType> 
```

如何在 Java 中对此建模？我在想类似的事情：

```
public class MyType
  String name;

  String stringValue;
  int intValue;
... 
```

但这肯定不是最好的方法，还是我错了？另外，如果我想通过使用该类型的 Axis2 公开服务，是否需要实现一些自定义消息接收器？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T12:27:37.910

我们通常使用 jaxb 或其他一些绑定机制（在 axis2 中有几个）将 xsd 转换为 Java 对象。这些生成的对象与您所展示的完全一样：也就是说，选择中的所有属性都在那里，您看不到任何表明只能存在其中一个的东西。如果您将这些内容翻译回 xml，则只有在打开验证时才会注意到这一点。如果您知道不应该在 Java 中同时设置两个变体，那么选择就没有问题 - 结果有时甚至可能是它们都没有进入生成的 XML。

# c# - 使用回调访问主线程

> ID：545708
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-13T12:09:37.827
> 
>         
> 
> 标签：c#, web-services, callback

我有一个 C# 程序，它使用 DuplexChannelFactory 连接到服务器，并且该服务器可以通过回调从客户端调用方法，问题是我不知道如何访问主线程，如果连接是从回调方法创建的. 有没有办法通过传递一个对象来做到这一点，或者我是否必须实现一个额外的通信层（BD、文件等）？

希望这不会让人感到困惑。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T12:49:26.670

我不确定我是否完全理解你的问题，但我会尝试一下：

我对这个问题的理解：

你有一个客户端和服务器。您的客户端对服务器进行 Web 服务调用，然后服务器可以在计算它所计算的任何内容的过程中对客户端进行某种回调。你有这个级别的基础设施工作，但你现在很难在回调的状态和原始请求的状态之间进行通信。

我在这里看到了一些选项，具体取决于您尝试共享的状态的性质。

1）如果您尝试共享的状态没有旋转（IE，如果在您发出请求时知道它）并且不是非常大，我认为最明智的选择是将该状态与webservice 调用，以便服务器可以将其传递回回调。

2) 如果状态正在旋转，您可以通过某种令人讨厌但线程安全的全局机制来提供对它的访问。也许是饱受诟病的单身人士，或者类似的东西。

3) 如果状态没有旋转，但很大，您可能需要考虑在发送初始请求之前预先计算服务器的请求。

有各种各样的技术，其中只是极少数，但问题中确实没有足够的信息来给出一个好的答案。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-14T19:17:46.697

What is your reason for wanting to access the main thread? Do you need to update a UI, and can only do that on the main thread?

In that case, look at System.Windows.Forms.Control.Invoke, which can queue a delegate to be executed on the UI thread.

# asp.net - JqG rid addJSONData + ASP.NET 2.0 WS

> ID：545714
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-13T12:11:17.667
> 
>         
> 
> 标签：asp.net, jquery, web-services, json, jqgrid

我有点失落。我尝试实现基于 JqGrid 的解决方案，并尝试将函数用作数据类型。我猜我已经按照这本书设置了所有内容，我调用了 WS 并返回了 JSON，我在 ajax 调用中在客户端获得了成功，我使用“绑定”jqGrid，`addJSONData`但网格仍然为空。我现在没有任何线索......同一页面上的其他“本地”样本可以正常工作（jsonstring ...）

我的 WS 方法如下所示：

```
[WebMethod]
        [ScriptMethod(ResponseFormat = ResponseFormat.Json)]
        public string GetGridData()  
         {  
             // Load a list 
             InitSessionVariables();
             SA.DB.DenarnaEnota.DenarnaEnotaDB db = new SAOP.SA.DB.DenarnaEnota.DenarnaEnotaDB();
             DataSet ds = db.GetLookupForDenarnaEnota(SAOP.FW.DB.RecordStatus.All);

             // Turn into HTML friendly format  
             GetGridData summaryList = new GetGridData();

             summaryList.page = "1";
             summaryList.total = "10";
             summaryList.records = "160";
             int i = 0;
             foreach (DataRow dr in ds.Tables[0].Rows)  
             {
                 GridRows row = new GridRows();
                 row.id = dr["DenarnaEnotaID"].ToString();
                 row.cell = "[" + "\"" + dr["DenarnaEnotaID"].ToString() + "\""
                                       + "," + "\"" + dr["Kratica"].ToString() + "\""
                                       + "," + "\"" + dr["Naziv"].ToString() + "\""
                                       + "," + "\"" + dr["Sifra"].ToString() + "\""

                          + "]";
                 summaryList.rows.Add(row);
             }  
             return JsonConvert.SerializeObject(summaryList);

         } 
```

我的 ASCX 代码是这样的：

```
jQuery(document).ready(function() {
  jQuery("#list").jqGrid({
    datatype: function(postdata) {
      jQuery.ajax({
        url: '../../AjaxWS/TemeljnicaEdit.asmx/GetGridData',
        data: '{}',
        dataType: 'json',
        type: 'POST',
        contentType: "application/json; charset=utf-8",
        complete: function(jsondata, stat) {
          if (stat == "success") {
            var clearJson = jsondata.responseText;

            var thegrid = jQuery("#list")[0];
            var myjsongrid = eval('(' + clearJson + ')');
            alfs
            thegrid.addJSONData(myjsongrid.replace(/\\/g, ''));
          }
        }
      });
    },
    colNames: ['DenarnaEnotaID', 'Kratica', 'Sifra', 'Naziv'],
    colModel: [{
        name: 'DenarnaEnotaID',
        index: 'DenarnaEnotaID',
        width: 100
      },
      {
        name: 'Kratica',
        index: 'Kratica',
        width: 100
      },
      {
        name: 'Sifra',
        index: 'Sifra',
        width: 100
      },
      {
        name: 'Naziv',
        index: 'Naziv',
        width: 100
      }
    ],

    rowNum: 15,
    rowList: [15, 30, 100],
    pager: jQuery('#pager'),
    sortname: 'id',
    //  loadtext:"Nalagam zapise...",
    // viewrecords: true, 
    sortorder: "desc",
    // caption:"Vrstice", 
    // width:"800",
    imgpath: "../Scripts/JGrid/themes/basic/images"
  });

}); 
```

从 WS 我得到这样的 JSON：

```
{”page”:”1″,”total”:”10″,”records”:”160″,”rows”:[{"id":"18","cell":"["18","BAM","Konvertibilna marka","977"]“},{”id”:”19″,”cell”:”["19","RSD","Srbski dinar","941"]“},{”id”:”20″,”cell”:”["20","AFN","Afgani","971"]“},{”id”:”21″,”cell”:”["21","ALL","Lek","008"]“},{”id”:”22″,”cell”:”["22","DZD","Alžirski dinar","012"]“},{”id”:”23″,”cell”:”["23","AOA","Kvanza","973"]“},{”id”:”24″,”cell”:”["24","XCD","Vzhodnokaribski dolar","951"]“},{”id”:”25″,”cell”:”

………………

["13","PLN","Poljski zlot","985"]“},{”id”:”14″,”cell”:”["14","SEK","Švedska krona","752"]“},{”id”:”15″,”cell”:”["15","SKK","Slovaška krona","703"]“},{”id”:”16″,”cell”:”["16","USD","Ameriški dolar","840"]“},{”id”:”17″,”cell”:”["17","XXX","Nobena valuta","000"]“},{”id”:”1″,”cell”:”["1","SIT","Slovenski tolar","705"]“}]} 
```

我已经注册了这个 JavaScript：

```
clientSideScripts.RegisterClientScriptFile("prototype.js", CommonFunctions.FixupUrlWithoutSessionID("~/WebUI/Scripts/prototype-1.6.0.2.js"));

clientSideScripts.RegisterClientScriptFile("jquery.js", CommonFunctions.FixupUrlWithoutSessionID("~/WebUI/Scripts/JGrid/jquery.js"));
clientSideScripts.RegisterClientScriptFile("jquery.jqGrid.js", CommonFunctions.FixupUrlWithoutSessionID("~/WebUI/Scripts/JGrid/jquery.jqGrid.js"));
clientSideScripts.RegisterClientScriptFile("jqModal.js", CommonFunctions.FixupUrlWithoutSessionID("~/WebUI/Scripts/JGrid/js/jqModal.js"));
clientSideScripts.RegisterClientScriptFile("jqDnR.js", CommonFunctions.FixupUrlWithoutSessionID("~/WebUI/Scripts/JGrid/js/jqDnR.js")); 
```

基本上我认为它一定是愚蠢的......但我现在想不通......

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-02-14T08:25:55.783

在过去的几个小时里，我一直在尝试解决同样的问题。我现在已经放弃了让 AddJSONData 工作——我的 Web 服务方法返回一个数组，所以看起来使用 addRowData 可以工作。

```
function ReceivedClientData(data) {
        var thegrid = $("#list4");
        for (var i = 0; i < data.length; i++) {
            thegrid.addRowData(i+1, data[i]);
        }
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-15T03:24:02.583

jqGrid 的设置看起来不错。

你确定你得到的`jsondata.responseText`就是你所描述的吗？

我在 .NET 中编写的 Web 服务返回格式如下的 JSON：

```
{"d": "{”page”:”1″,”total”:”10″,”records”:”160″,”rows”:[{"id":"18","cell":"["18","BAM","Konvertibilna marka","977"]“}" 
```

在我的功能中，我必须这样做：

```
complete: function(data) {
    var stuff = JSON.parse(data.responseText);
    jQuery("#grid")[0].addJSONData(JSON.parse(stuff.d));
} 
```

在我真正得到我需要的数据之前，我必须将字符串转换为 JSON 两次。

如果你有很大的问题。我建议逐个调试这个。执行一个简单的语句，例如：

```
jQuery("#list")[0].addJSONData(JSON.parse("{total: 1, page: 1, records: 1, rows : [ {id: '1', cell:['1', '2007-10-01', 'test', 'note', 'new', '200.00', '10.00', '210.00']} ] }")); 
```

这至少应该有效。之后，只需分析您从 Web 服务获得的输出，并确保您可以让该语句执行“完成”。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-14T15:28:08.030

实际上，关键似乎是 addJSONData 上未出现在文档中的参数：

```
function ReceivedClientData(data) {
        var thegrid = $("#rowed2");
        thegrid[0].addJSONData(data,thegrid.bDiv,9)            
    } 
```

随之而来的网络方法是：

```
 [WebMethod(EnableSession = true)]
    public object GetTestClients(int pagenum, int rows)
    {
        var lst = Session["lst"] as List<Entities.Client>;
        if (lst == null)
        {
            lst = new List<Entities.Client>();
            for (int i = 1; i <= 5; i++)
            {
                lst.Add(new TF.WebApps.Entities.Client()
                {
                    ClientID = "Client" + i,
                    Firstname = "first" + i,
                    Lastname = "last" + i
                });
            }
            Session["lst"] = lst;
        }
        var v = from c in lst
                select new
                {
                    id = c.ClientID,
                    cell = new object[] 
                    {
                        c.ClientID,
                        c.Firstname,
                        c.Lastname
                    }
                };

        var result = new
        {
            total = v.Count() / rows,
            page = pagenum,
            records = rows,
            rows = v.Skip((pagenum-1)*rows).Take(rows).ToArray()
        };

        return result;
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-09-30T14:58:02.997

我还使用 web 服务将数据传递给 jqGrid。我遇到了同样的问题，这是 .ajax 函数的完整部分中的代码。

```
complete: function(jsondata, stat) {
             if (stat == "success") {
                var thegrid = jQuery("#list2")[0];
                var jsonObject = eval('(' + jsondata.responseText + ')');
                thegrid.addJSONData(jsonObject.d);
             }
           } 
```

关键是在responseText 被评估为 JSON 对象之后  的**.d 。**

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-04-21T20:57:29.077

这对我有用：

```
mygrid[0].addJSONData(result, mygrid.bDiv, 0); 
```

或者试试这个：

```
mygrid[0].addJSONData($.toJSON(result), mygrid.bDiv, 0); 
```

我的网格数据类型是 jsonstring。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2010-03-10T23:40:23.690

我知道它很旧，但这可能是你的问题......

使 row.cell 成为一个列表，然后你可以做...

```
row.cell = new List {
    dr["DenarnaEnotaID"]
    ,dr["Kratica"]
    ,dr["Naziv"]
    ,dr["Sifra"]
};
```

在剧本方面...

```
var myjsongrid = eval('('+clearJson+')');
...
thegrid.addJSONData(myjsongrid.replace(/\\/g,'')); 
```

myjsongrid 此时是一个对象，对象上通常没有 .replace 方法。此外，您可能应该使用嵌入 eval 的 JSON 解析器。我自己使用 Crockford 的 json2.js 的修改版本，但使用 YMMV。

这应该使每一行都符合您的要求，让序列化程序处理转换...我实际上将我的数据表序列化为 { columns:['colname',...], rows:[['row1val',...] ,['row2val',...],...] } 并在客户端使用它，因为我使用一些相同的调用来填充各种网格...我有一个客户端 selectForJqGrid(table, keycol, [ col list]) 将其设置为直接用于 jqGrid。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2011-02-24T05:20:01.867

您的问题是您应该使用`addJSONData`responseText。`eval`然后将 JSON 字符串解析为 JavaScript 中的 JSON。那应该可以正常工作。

对于法国人的回答，我仍然会添加一些提示：

```
complete: function(jsondata, stat) {
         if (stat == "success") {              
            var jsonObject = (eval("(" + jsondata.responseText + ")"));
             $('#list2')[0].addJSONData(JSON.parse(jsonObject.d));
         }
       } 
```

这就是你的 JSON。并且 JqGrid 应该正确配置，`JsonReader`以便在您加载数据时不会出错：请提供您拥有的任何索引。这应该可以解决您的问题。

```
jsonReader: {
            root: "rows", //arry containing actual data
            page: "page", //current page
            total: "total", //total pages for the query
            records: "records", //total number of records
            repeatitems: false,
            id: "DenarnaEnotaID" //index of the column with the PK in it
        }, 
```

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2014-04-02T11:45:01.340

我对 jqGrid 的一些建议的误导性感到非常惊讶。

有两种方法可以为 jqGrid 提供来自服务的 JSON 数据。  

您可以编写一个方法来为 jqGrid 返回一个“块”数据，其中的数据刚好够一页结果。

或者，您可以让自己的生活变得轻松，一次返回所有 JSON 数据，并让 jqGrid 处理分页，而无需进一步调用您的 JSON 服务。

它的关键是*loadonce* jqGrid 设置：

```
loadonce: true, 
```

例如，我有一个 JSON Web 服务，它返回特定客户 ID 的订单列表：

[http://www.iNorthwind.com/Service1.svc/getOrdersForCustomer/BERGS](http://www.iNorthwind.com/Service1.svc/getOrdersForCustomer/BERGS)

..我想用它创建这个jqGrid：

![在此处输入图像描述](https://i.stack.imgur.com/S85r8.png)

这是我的 jqGrid 声明的样子：

```
$("#tblOrders").jqGrid({
    url: 'http://www.iNorthwind.com/Service1.svc/getOrdersForCustomer/BERGS',
    contentType: "application/json",
    datatype: "json",
    jsonReader: {
        root: "GetOrdersForCustomerResult",
        id: "OrderID",
        repeatitems: false
    },
    mtype: "GET",
    colNames: ["ID", "Date", "ShipName", "ShipAddress", "ShipCity", "ShippedDate"],
    colModel: [
        { name: "OrderID", width: 80, align: "center" },
        { name: "OrderDate", width: 90, align: "center" },
        { name: "ShipName", width: 250 },
        { name: "ShipAddress", width: 250 },
        { name: "ShipCity", width: 95 },
        { name: "ShippedDate", width: 95 },
    ],
    pager: "#pager",
    height: 'auto',
    rowNum: 8,
    rowList: [8, 16, 24],
    loadonce: true,
    sortname: "OrderID",
    sortorder: "desc",
    viewrecords: true,
    gridview: true,
    autoencode: true,
    caption: "Northwind orders"
}); 
```

注意上面这三行：

```
 jsonReader: {
        root: "GetOrdersForCustomerResult",
        id: "OrderID",
        repeatitems: false
    }, 
```

这可以防止出现讨厌的“addJSONdata”异常，并告诉 jqGrid 实际上，我们的 JSON 数据数组存储在我的 JSON 结果的*GetOrdersForCustomerResult*部分中。

```
{
  GetOrdersForCustomerResult: [
  {
    OrderDate: "8/12/1996",
    OrderID: 10278,
    ShipAddress: "Berguvsvägen 8",
    ShipCity: "Luleå",
    ShipName: "Berglunds snabbköp",
    ShipPostcode: "S-958 22",
    ShippedDate: "8/16/1996"
  },
  {
    OrderDate: "8/14/1996",
    OrderID: 10280,
    ...etc... 
```

就是这样。根本不需要调用 AddJSONdata。  

这个例子的完整演练可以在我的博客上找到：

[http://mikesknowledgebase.com/pages/Services/WebServices-Page10.htm](http://mikesknowledgebase.com/pages/Services/WebServices-Page10.htm)

（我希望在三个小时前，当我开始研究这些问题时，我能读到这篇文章！！）

# c# - 在 nHibernate 中使用 DetachedCriteria 进行复杂查询

> ID：545720
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-13T12:14:54.960
> 
>         
> 
> 标签：c#, .net, nhibernate

我目前正在尝试从手工制作的 hql 转移到通过 DetachedCriteria 构建的查询。我有和 HQL：

```
from GenericObject genericObject 
      left join fetch genericObject.Positions positions
      where (positions.Key.TrackedSourceID, positions.Key.PositionTimestamp) in 
      (select gp.Key.TrackedSourceID, max(gp.Key.PositionTimestamp)
       from GenericPosition gp 
group by gp.Key.TrackedSourceID) 
```

现在使用 DetachedCriteria：

```
var subquery = DetachedCriteria
                .For (typeof (GenericPosition), "gp")
                .SetProjection (Projections.ProjectionList ()
                                    .Add (Projections.Property ("gp.Key.TrackedSourceID"))
                                    .Add (Projections.Max ("gp.Key.PositionTimestamp"))
                                    .Add (Projections.GroupProperty ("gp.Key.TrackedSourceID"))
                );
            var criteriaQuery = DetachedCriteria
                .For (typeof (GenericObject), "genericObject")
                .CreateAlias ("genericObject.Positions", "positions")
                .SetFetchMode ("genericObject.Positions", FetchMode.Eager)
                .Add (Subqueries.In (??, subquery)) 
```

我不知道该键入什么而不是 ?? 创建像 (positions.Key.TrackedSourceID, position.Key.PositionTimestamp) 这样的表达式

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T12:22:49.200

如果后者更难编写，我看不到从 hql 迁移到 DetachedCriteria 的优势。并阅读。

在我的项目中，我最好使用 DetachedCriteria，除非语法变得太复杂。然后我使用 hql。直到它再次变得复杂。然后我在sql中试了一下，如果没有提高可读性就返回hql。

请记住，您将来必须维护这些查询。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2010-04-25T05:21:42.153

HQL 在内部完成了很多字符串操作，因此由于字符串是不可变类型，因此可能会产生内存问题。建议使用 DetachedCriteria 而不是 HQL。

# cocoa-touch - 将动作绑定到 UIButton

> ID：545721
> 
>         
> 
> 赞同：12
> 
>         
> 
> 时间：2009-02-13T12:14:59.517
> 
>         
> 
> 标签：cocoa-touch

在我的 AppController 中，我正在使用以下代码加载视图。

```
- (void) loadSettingsController {
    settingsViewController = [[SettingsViewController alloc] initWithNibName:@"SettingsView" bundle:nil];
    UIButton *button = settingsViewController.loginButton;
    [button addTarget:self action:@selector(saveSettings:) forControlEvents:UIControlEventTouchUpInside];
}

- (IBOutlet) saveSettings:(id) sender 
```

该视图稍后会使用代码添加到窗口中

```
[window addSubview:[settingsViewController view]]; 
```

一切正常，但是当我在使用调试器时按下按钮时，操作 saveSettings 不会被调用。“loginButton”属性连接到 Interface Builder 中的按钮。

你能看出这段代码有什么问题吗？

* * *

## 回答 #1

> 赞同：20
> 
>             
> 
> 时间：2009-02-13T12:35:07.517

将 IBOutlet 更改为 IBAction

```
- (IBAction) saveSettings:(id) sender 
```

这是因为您尝试在调用 viewDidLoad 之前访问您的对象。你必须在 viewDidLoad 被调用之前等待，有很多方法可以实现。

将此添加到您的 SettingViewController viewDidLoad 函数

```
 [[NSNotificationCenter defaultCenter] postNotificationName:@"SettingsViewDidLoad" object:nil]; 
```

这就是你想要访问按钮的 ViewController

```
- (void) loadSettingsController {
       settingsViewController = [[SettingsViewController alloc] initWithNibName:@"SettingsView" bundle:nil];
       [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(initControls) name:@"SettingsViewDidLoad" object:nil];
}

-(void)initControls{
       UIButton *button = settingsViewController.loginButton;
       [button addTarget:self action:@selector(saveSettings:) forControlEvents:UIControlEventTouchUpInside];
} 
```

# c# - 使用 c# .net 库检查来自 gmail 服务器的 IMAP 消息

> ID：545724
> 
>         
> 
> 赞同：33
> 
>         
> 
> 时间：2009-02-13T12:17:53.517
> 
>         
> 
> 标签：c#, .net, email, imap

有没有人有任何示例代码使用通过 IMAP SSL 连接到 googlemail 服务器的 .Net 框架来检查新电子邮件？

* * *

## 回答 #1

> 赞同：26
> 
>             
> 
> 时间：2014-04-29T21:51:01.253

我建议查看[MailKit](https://github.com/jstedfast/MailKit)，因为它可能是最强大的邮件库，而且它是开源 (MIT)。

MailKit 最棒的事情之一是所有网络 API 都是可取消的（我在任何其他 IMAP 库中都没有看到可用的东西）。

它也是我所知道的唯一支持消息线程的库。

```
using System;
using System.Net;
using System.Threading;

using MailKit.Net.Imap;
using MailKit.Search;
using MailKit;
using MimeKit;

namespace TestClient {
    class Program
    {
        public static void Main (string[] args)
        {
            using (var client = new ImapClient ()) {
                using (var cancel = new CancellationTokenSource ()) {
                    client.Connect ("imap.gmail.com", 993, true, cancel.Token);

                    // If you want to disable an authentication mechanism,
                    // you can do so by removing the mechanism like this:
                    client.AuthenticationMechanisms.Remove ("XOAUTH");

                    client.Authenticate ("joey", "password", cancel.Token);

                    // The Inbox folder is always available...
                    var inbox = client.Inbox;
                    inbox.Open (FolderAccess.ReadOnly, cancel.Token);

                    Console.WriteLine ("Total messages: {0}", inbox.Count);
                    Console.WriteLine ("Recent messages: {0}", inbox.Recent);

                    // download each message based on the message index
                    for (int i = 0; i < inbox.Count; i++) {
                        var message = inbox.GetMessage (i, cancel.Token);
                        Console.WriteLine ("Subject: {0}", message.Subject);
                    }

                    // let's try searching for some messages...
                    var query = SearchQuery.DeliveredAfter (DateTime.Parse ("2013-01-12"))
                        .And (SearchQuery.SubjectContains ("MailKit"))
                        .And (SearchQuery.Seen);

                    foreach (var uid in inbox.Search (query, cancel.Token)) {
                        var message = inbox.GetMessage (uid, cancel.Token);
                        Console.WriteLine ("[match] {0}: {1}", uid, message.Subject);
                    }

                    client.Disconnect (true, cancel.Token);
                }
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：20
> 
>             
> 
> 时间：2009-02-13T12:43:32.597

您可能对此处列出的 URL 感兴趣

[http://www.codeplex.com/InterIMAP](http://www.codeplex.com/InterIMAP) 

这是延伸到

[http://www.codeproject.com/KB/IP/imaplibrary.aspx?fid=91819&df=90&mpp=25&noise=5&sort=Position&view=Quick&fr=26&select=2562067#xx2562067xx](http://www.codeproject.com/KB/IP/imaplibrary.aspx?fid=91819&df=90&mpp=25&noise=5&sort=Position&view=Quick&fr=26&select=2562067#xx2562067xx)

* * *

## 回答 #3

> 赞同：17
> 
>             
> 
> 时间：2009-02-13T12:58:25.153

作为上述项目的作者，我可以说是的，它确实支持 SSL。

我目前正在开发一个完全异步的新版本库，以提高它与 IMAP 服务器交互的速度。

该代码虽然不完整，但可以与原始同步库（也支持 SSL）一起从上面链接的代码 plex 站点下载。

* * *

## 回答 #4

> 赞同：14
> 
>             
> 
> 时间：2011-07-15T18:12:55.470

*交叉从另一个类似的问题发布。看看当他们变得如此相似时会发生什么？*

我一直在寻找 IMAP 解决方案一段时间，在尝试了很多之后，我将使用[AE.Net.Mail](https://github.com/andyedinborough/aenetmail "AE.Net.Mail")。

没有文档，我认为这是一个缺点，但我能够通过查看源代码（开源！）并使用 Intellisense 来解决这个问题。下面的代码专门连接到 Gmail 的 IMAP 服务器：

```
// Connect to the IMAP server. The 'true' parameter specifies to use SSL
// which is important (for Gmail at least)
ImapClient ic = new ImapClient("imap.gmail.com", "name@gmail.com", "pass",
                ImapClient.AuthMethods.Login, 993, true);
// Select a mailbox. Case-insensitive
ic.SelectMailbox("INBOX");
Console.WriteLine(ic.GetMessageCount());
// Get the first *11* messages. 0 is the first message;
// and it also includes the 10th message, which is really the eleventh ;)
// MailMessage represents, well, a message in your mailbox
MailMessage[] mm = ic.GetMessages(0, 10);
foreach (MailMessage m in mm)
{
    Console.WriteLine(m.Subject);
}
// Probably wiser to use a using statement
ic.Dispose(); 
```

我不隶属于这个库或任何东西，但我发现它非常快速和稳定。

* * *

## 回答 #5

> 赞同：12
> 
>             
> 
> 时间：2009-04-08T17:52:38.990

[Lumisoft.net](http://www.lumisoft.ee/lsWWW/Download/Downloads/Net/)具有您可以使用的 IMAP 客户端和服务器代码。

我用它从 Gmail 下载电子邮件。对象模型不是最好的，但它是可行的，并且似乎相当灵活和稳定。

这是我使用它的秒杀的部分结果。它获取前 10 个带有信封的标头，然后获取完整的消息：

```
using (var client = new IMAP_Client())
{
    client.Connect(_hostname, _port, _useSsl);
    client.Authenticate(_username, _password);
    client.SelectFolder("INBOX");
     var sequence = new IMAP_SequenceSet();
    sequence.Parse("0:10");
    var fetchItems = client.FetchMessages(sequence, IMAP_FetchItem_Flags.Envelope | IMAP_FetchItlags.UID,
                                        false, true);
    foreach (var fetchItem in fetchItems)
    {
        Console.Out.WriteLine("message.UID = {0}", fetchItem.UID);
        Console.Out.WriteLine("message.Envelope.From = {0}", fetchItem.Envelope.From);
        Console.Out.WriteLine("message.Envelope.To = {0}", fetchItem.Envelope.To);
        Console.Out.WriteLine("message.Envelope.Subject = {0}", fetchItem.Envelope.Subject);
        Console.Out.WriteLine("message.Envelope.MessageID = {0}", fetchItem.Envelope.MessageID);
    }
    Console.Out.WriteLine("Fetching bodies");
    foreach (var fetchItem in client.FetchMessages(sequence, IMAP_FetchItem_Flags.All, false, true)
    {             
        var email = LumiSoft.Net.Mail.Mail_Message.ParseFromByte(fetchItem.MessageData);             
        Console.Out.WriteLine("email.BodyText = {0}", email.BodyText);

    }
} 
```

* * *

## 回答 #6

> 赞同：7
> 
>             
> 
> 时间：2009-10-06T08:01:31.760

IMAP 没有 .NET 框架支持。您需要使用一些第 3 方组件。

试试[Mail.dll 电子邮件组件](https://www.limilabs.com/mail)，它非常**实惠**且易于使用，它还支持**SSL**：

```
using(Imap imap = new Imap())
{
    imap.ConnectSSL("imap.company.com");
    imap.Login("user", "password");

    imap.SelectInbox();
    List<long> uids = imap.Search(Flag.Unseen);
    foreach (long uid in uids)
    {
        string eml = imap.GetMessageByUID(uid);
        IMail message = new MailBuilder()
            .CreateFromEml(eml);

        Console.WriteLine(message.Subject);
        Console.WriteLine(message.Text);
    }
    imap.Close(true);
} 
```

请注意，这是我创建的商业产品。

您可以在此处下载：[https](https://www.limilabs.com/mail) ://www.limilabs.com/mail 。

* * *

## 回答 #7

> 赞同：5
> 
>             
> 
> 时间：2010-11-18T15:19:09.340

[MailSystem.NET](http://mailsystem.codeplex.com)包含您对 IMAP4 的所有需求。它是免费和开源的。

（我参与了这个项目）

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T12:54:42.540

ssl 版本的来源在这里：[http ://atmospherian.wordpress.com/downloads/](http://atmospherian.wordpress.com/downloads/)

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2011-01-11T19:32:07.677

LumiSoft.ee - 效果很好，相当简单。使用 .NET 4.0 编译。

以下是他们的库和示例所需的链接。主要下载：

[http://www.lumisoft.ee/lsWWW/Download/Downloads/](http://www.lumisoft.ee/lsWWW/Download/Downloads/)

代码示例：

位于： ...lsWWW/Download/Downloads/Examples/

。网：

位于： ...lsWWW/Download/Downloads/Net/

我正在使用他们的 lib 在 codeplex (IMAPClientLumiSoft.codeplex.com) 上放置一个简单的示例。您必须直接从他们的站点获取他们的库。我不包括他们，因为我不维护他们的代码，也对代码没有任何权利。转到上面的链接并直接下载。我在我的 VS2010 中设置了 LumiSoft 项目属性，以便在 .NET 4.0 中构建所有项目属性，并且没有任何错误。他们的样本相当复杂，如果只是一个例子，甚至可能编码过于紧凑。尽管我希望这些通常针对高级开发人员。

他们的项目进行了细微的调整。调整：他们的 IMAP Client Winform 示例在项目属性中设置为“Release”，以防止 VS 在调试点上中断。您必须使用解决方案“配置管理器”将项目设置为“活动（调试）”才能使断点工作。他们的示例对事件处理程序使用匿名方法，这是非常紧凑的编码......作为教学工具并不是很好。我的项目使用“命名”事件方法处理程序，因此您可以在处理程序内设置断点。然而，他们是处理内联代码的绝佳方式。他们可能使用了自 .NET 3.0 以来可用的较新的 Lambda 方法，但没有使用，我也没有尝试转换它们。

从他们的示例中，我将 IMAP 客户端简化为最低限度。

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2014-01-09T22:11:21.753

另一种选择：HigLabo

[https://higlabo.codeplex.com/documentation](https://higlabo.codeplex.com/documentation)

很好的讨论：[https ://higlabo.codeplex.com/discussions/479250](https://higlabo.codeplex.com/discussions/479250)

```
//====Imap sample================================//
//You can set default value by Default property
ImapClient.Default.UserName = "your server name";
ImapClient cl = new ImapClient("your server name");
cl.UserName = "your name";
cl.Password = "pass";
cl.Ssl = false;
if (cl.Authenticate() == true)
{
    Int32 MailIndex = 1;
    //Get all folder
    List<ImapFolder> l = cl.GetAllFolders();
    ImapFolder rFolder = cl.SelectFolder("INBOX");
    MailMessage mg = cl.GetMessage(MailIndex);
}

//Delete selected mail from mailbox
ImapClient pop = new ImapClient("server name", 110, "user name", "pass");
pop.AuthenticateMode = Pop3AuthenticateMode.Pop;
Int64[] DeleteIndexList = new.....//It depend on your needs
cl.DeleteEMail(DeleteIndexList);

//Get unread message list from GMail
using (ImapClient cl = new ImapClient("imap.gmail.com")) 
{
    cl.Port = 993;
    cl.Ssl = true; 
    cl.UserName = "xxxxx";
    cl.Password = "yyyyy";
    var bl = cl.Authenticate();
    if (bl == true)
    {
        //Select folder
        ImapFolder folder = cl.SelectFolder("[Gmail]/All Mail");
        //Search Unread
        SearchResult list = cl.ExecuteSearch("UNSEEN UNDELETED");
        //Get all unread mail
        for (int i = 0; i < list.MailIndexList.Count; i++)
        {
            mg = cl.GetMessage(list.MailIndexList[i]);
        }
    }
    //Change mail read state as read
    cl.ExecuteStore(1, StoreItem.FlagsReplace, "UNSEEN")
}

//Create draft mail to mailbox
using (ImapClient cl = new ImapClient("imap.gmail.com")) 
{
    cl.Port = 993;
    cl.Ssl = true; 
    cl.UserName = "xxxxx";
    cl.Password = "yyyyy";
    var bl = cl.Authenticate();
    if (bl == true)
    {
        var smg = new SmtpMessage("from mail address", "to mail addres list"
            , "cc mail address list", "This is a test mail.", "Hi.It is my draft mail");
        cl.ExecuteAppend("GMail/Drafts", smg.GetDataText(), "\\Draft", DateTimeOffset.Now); 
    }
}

//Idle
using (var cl = new ImapClient("imap.gmail.com", 993, "user name", "pass"))
{
    cl.Ssl = true;
    cl.ReceiveTimeout = 10 * 60 * 1000;//10 minute
    if (cl.Authenticate() == true)
    {
        var l = cl.GetAllFolders();
        ImapFolder r = cl.SelectFolder("INBOX");
        //You must dispose ImapIdleCommand object
        using (var cm = cl.CreateImapIdleCommand()) Caution! Ensure dispose command object
        {
            //This handler is invoked when you receive a mesage from server
            cm.MessageReceived += (Object o, ImapIdleCommandMessageReceivedEventArgs e) =>
            {
                foreach (var mg in e.MessageList)
                {
                    String text = String.Format("Type is {0} Number is {1}", mg.MessageType, mg.Number);
                    Console.WriteLine(text);
                }
            };
            cl.ExecuteIdle(cm);
            while (true)
            {
                var line = Console.ReadLine();
                if (line == "done")
                {
                    cl.ExecuteDone(cm);
                    break;
                }
            }
        }
    }
} 
```

# python - 用于 Python 中可重现环境的工具（或工具组合）

> ID：545730
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2009-02-13T12:20:56.130
> 
>         
> 
> 标签：python, continuous-integration, installation, development-environment, automated-deploy

我曾经是一名 Java 开发人员，我们使用 ant 或 maven 等工具以标准化的方式管理我们的开发/测试/UAT 环境。这使我们能够处理库依赖关系、设置操作系统变量、编译、部署、运行单元测试以及所有必需的任务。此外，生成的脚本保证了所有环境的配置几乎相同，并且所有任务都由团队的所有成员以相同的方式执行。

我现在开始在 Python 中工作，我希望得到您的建议，我应该使用哪些工具来完成与 java 中描述的相同的操作。

* * *

## 回答 #1

> 赞同：18
> 
>             
> 
> 时间：2009-02-13T13:24:24.263

1.  [virtualenv](http://pypi.python.org/pypi/virtualenv)创建一个包含的虚拟环境（防止不同版本的 Python 或 Python 包相互踩踏）。人们越来越多地转向这个工具。作者与 Aaron 提到的旧版 working-env.py 相同。

2.  [pip](http://pypi.python.org/pypi/pip)在 vi​​rtualenv 中安装包。S. Lott 回答的传统是 easy_install，但 pip 与 virtualenv 配合得更好。不过，easy_install 仍然具有 pip 中没有的功能。

3.  [scons](http://www.scons.org/)作为构建工具，尽管如果你保持纯粹的 Python 就不需要它。

4.  用于部署的[织物](http://pypi.python.org/pypi/Fabric/0.0.3)糊或[摊铺机。](http://www.blueskyonmars.com/projects/paver/)

5.  [buildbot](http://buildbot.net/trac)用于持续集成。

6.  用于版本控制的 Bazaar、mercurial 或 git。

7.  [鼻子](http://somethingaboutorange.com/mrl/projects/nose/)作为单元测试的扩展。

8.  用于[FIT](http://fit.c2.com)测试的[PyFit 。](http://pypi.python.org/pypi/PyFIT/0.8a2)

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T12:29:30.743

我也使用 java 和 python。对于 python 开发，maven 等价物是 setuptools ( [http://peak.telecommunity.com/DevCenter/setuptools](http://peak.telecommunity.com/DevCenter/setuptools) )。对于 Web 应用程序开发，我将它与 paster ( [http://pythonpaste.org/](http://pythonpaste.org/) ) 结合用于部署过程

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T12:28:45.363

除了[easy_install](http://peak.telecommunity.com/DevCenter/EasyInstall)吗？

对于我们的 Linux 服务器，我们使用 easy_install 和 yum。

对于我们的 Windows 开发笔记本电脑，我们将 easy_install 和一些 MSI 用于某些项目。

我们使用的大多数 Python 库都是纯源代码，因此我们可以在所有盒子上使用相同的分布。如果我们可以有一个网络共享设备，我们会把它们都放在那里。可悲的是，我们的基础设施有点分散，所以我们必须移动 .TAR 文件或重新安装以重建环境。

在少数情况下（例如，PIL），我们必须重新编译并检查版本号。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T12:30:18.900

您将需要[easy_setup](http://pypi.python.org/pypi/setuptools)来获取鸡蛋（大致 Maven 称之为工件）。

要设置您的环境，请查看[working-env.py](http://blog.ianbicking.org/working-env.html)

Python 没有被编译，但是你可以将一个项目的所有文件放在一个 egg 中。这是使用[setuptools完成的](http://pypi.python.org/pypi/setuptools)

对于 CI，请检查[此答案](https://stackoverflow.com/questions/535/continuous-integration-system-for-a-python-codebase)。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T18:00:31.963

更不用说由[TurboGears](http://www.turbogears.org/)的 Kevin Dangoor 创建的[Paver](http://www.blueskyonmars.com/projects/paver/)了。该项目仍处于 alpha 阶段，但看起来很有希望。项目页面的片段：

> Paver 是一个基于 Python 的构建/分发/部署脚本工具，类似于 Make 或 Rake。Paver 的独特之处在于它与常用的 Python 库的集成。以前很容易的常见任务仍然很容易。更重要的是，现在处理您的应用程序的特定需求和要求要容易得多。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T13:06:36.707

我使用 setuptools 和 Hudson 的组合来做到这一点。我知道 Hudson 是一个 java 应用程序，但它可以很好地运行 Python 的东西。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2010-05-14T00:53:17.210

您可能想查看我们的[**Devenv**](http://www.viewtier.com/products/devenv/index.htm)。它允许您标准化用于开发、QA 和 UAT 的构建环境。它是免费的，就像“免费啤酒”一样。

高温高压

# c# - 如何在 XML 中更深入地导航并在其中附加数据

> ID：545735
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-13T12:23:27.607
> 
>         
> 
> 标签：c#, append, xmldocument, selectnodes

我已将 XmlDocument 加载到内存中并创建了新的 XmlElement。现在我正在尝试将 XmlElement 添加到路径 /report/section/hosts 但我不知道如何。我可以很容易地将它添加到 XML 的根节点下，但我无法弄清楚如何在 XML 中导航更深层次并只是附加到那里。在伪中，我正在尝试这样做：

*doc.SelectNodes("/report/section/hosts").AppendChild(subRoot);*

编码：

```
 XmlDocument doc = new XmlDocument();

        doc.Load("c:\\data.xml");

        //host
        XmlElement subRoot = doc.CreateElement("host");

        //Name
        XmlElement ElName = doc.CreateElement("name");
        XmlText TxtName = doc.CreateTextNode("text text");
        ElName.AppendChild(TxtName);
        subRoot.AppendChild(ElName);
        doc.DocumentElement.AppendChild(subRoot);

        doc.Save("c:\\data.xml"); 
```

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T12:31:14.920

尝试 SelectSingleNode 而不是 SelectNodes

```
XmlElement parent = (XmlElement)doc.SelectSingleNode("/report/section/hosts")
parent.AppendChild(subRoot); 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T12:31:53.000

SelectNodes 方法返回节点列表。您应该改用 SelectSingleNode ...

例如（我的头顶，没有在 Visual Studio 中测试）

```
doc.SelectSingleNode("/report/section/hosts").AppendChild(subRoot); 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T12:34:12.013

你快到了。尝试使用 SelectSingleNode 代替：

```
XmlNode node = doc.SelectSingleNode("/report/section/hosts");
node.AppendChild(subRoot); 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T12:31:53.860

您需要在要附加到的文档（根除外）中获取对 XmlElement 的引用。XmlDocument 上有[许多可用的方法](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument_methods.aspx)，例如`GetElementById`，`SelectSingleNode`它们以不同的方式为您做到这一点，研究品味。

也就是说，这方面的整个 API 通常被认为有点痛苦，你有 LINQ 可用吗？

# c# - 从插件调用自定义 Web 服务时出错

> ID：545737
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-13T12:24:52.753
> 
>         
> 
> 标签：c#, web-services, dynamics-crm-4, crm

我尝试调用作为 CRM4 的一部分部署的自定义 Web 服务并收到以下错误：

```
Client found response content type of 'text/html; charset=utf-8', but expected 'text/xml'.
    The request failed with the error message:
    --
        <html>
            <head>
                <title>No Microsoft Dynamics CRM user exists with the specified domain name and user ID</title>
                <style>
        ...
                </style>
            </head>

            <body bgcolor="white">

                    <span><H1>Server Error in '/RecurrenceService' Application.<hr width=100% size=1 color=silver></H1>

                    <h2> <i>No Microsoft Dynamics CRM user exists with the specified domain name and user ID</i> </h2></span>

        ...

        <table width=100% bgcolor="#ffffcc">
                       <tr>
                          <td>
        [CrmException: No Microsoft Dynamics CRM user exists with the specified domain name and user ID]
           Microsoft.Crm.Authentication.WindowsAuthenticationProvider.Authenticate(HttpApplication application) +895
           Microsoft.Crm.Authentication.AuthenticationStep.Authenticate(HttpApplication application) +125
           Microsoft.Crm.Authentication.AuthenticationPipeline.Authenticate(HttpApplication application) +66
           Microsoft.Crm.Authentication.AuthenticationEngine.Execute(Object sender, EventArgs e) +513
           System.Web.SyncEventExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +92
           System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +64

                          </td>
                       </tr>
                    </table>

                    <br>

                    <hr width=100% size=1 color=silver>

                    <b>Version Information:</b> Microsoft .NET Framework Version:2.0.50727.1433; ASP.NET Version:2.0.50727.1433

                    </font>

            </body>
        </html>
        <!-- 
        [CrmException]: No Microsoft Dynamics CRM user exists with the specified domain name and user ID
           at Microsoft.Crm.Authentication.WindowsAuthenticationProvider.Authenticate(HttpApplication application)
           at Microsoft.Crm.Authentication.AuthenticationStep.Authenticate(HttpApplication application)
           at Microsoft.Crm.Authentication.AuthenticationPipeline.Authenticate(HttpApplication application)
           at Microsoft.Crm.Authentication.AuthenticationEngine.Execute(Object sender, EventArgs e)
           at System.Web.HttpApplication.SyncEventExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
           at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously)
        -->
        --. 
```

调用我的网络服务的代码：

```
RecurrenceService serv = new RecurrenceService();
serv.Credentials = System.Net.CredentialCache.DefaultCredentials;
string result = serv.UpdateSeries(); 
```

CRM4 网址：`http://cw-dev-5/loader.aspx`

定制服务网址：`http://cw-dev-5/RecurrenceService/RecurrenceService.asmx`

以下代码片段`System.Security.Principal.WindowsIdentity.GetCurrent().Name`返回`NT AUTHORITY\NETWORK SERVICE`（我想这是错误的原因）

有人可以建议我解决我的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T12:29:27.467

这是从 ASP.Net 站点调用它吗？您可能需要将应用程序池标识更改为有权访问 CRM 站点的域用户（它当前正在尝试使用 NT AUTHORITY\NETWORK SERVICE）

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T13:37:40.737

是的，正在调用 CRM 服务的网络服务

> 自定义服务网址：“ [http://cw-dev-5/RecurrenceService/RecurrenceService.asmx](http://cw-dev-5/RecurrenceService/RecurrenceService.asmx) ”

这需要以 CRM 用户管理员中设置的 crm 用户身份登录。

如果您从插件调用 - 这也需要是在 CRM 中具有用户设置的身份

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-07T12:40:19.110

也许您正在运行非英语操作系统？

不知何故，无论出于何种原因，当操作系统被翻译成其他语言时，网络服务的登录名有时会被本地化。

现在很多程序都希望将登录名硬编码为“NT AUTHORITY\NETWORK SERVICE”——例如在德语版本的 Windows 中，帐户的名称是“NT-AUTORITÄT\NETZWERKDIENST”。所以你的程序正在寻找英文名称，找不到它，并显示错误。

不确定这是否适用于您的问题，但可能值得检查！

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-11-17T01:08:27.757

如果您的 CRM 服务器上有多个组织，您需要将组织名称放在您的 URL 中：

```
http://cw-dev-5/SomeOrgName/RecurrenceService/RecurrenceService.asmx 
```

如果 Web 应用程序位于 CRM 网站中，您必须执行此操作，因为 CRM 将对用户进行身份验证并查看他们是否存在于该组织中。如果您关闭组织，它将使用默认组织。

以下是有关其工作原理的一些 MSDN 文档：[使用 Microsoft Dynamics CRM URL](http://msdn.microsoft.com/en-us/library/cc905759.aspx)。

# .net - 令人费解的子对象实例化

> ID：545752
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-13T12:33:03.200
> 
>         
> 
> 标签：.net, vb.net

我有一个对象（事件），它有一个子对象（动作）。一个事件可能有零个或一个动作对象。我正在尝试使用以下代码测试 Incident 对象是否具有子 Action 对象：

`If Not MyIncident.Action Is Nothing`

理论上这应该可行，但由于某种原因，子 Action 对象被神秘地实例化（没有值）。这个实例化似乎发生在 If Else 语句的 Else 行上，我在其中检查 Incident 对象的 ID 属性以确定它是否已保存到数据库中：

```
If MyIncident.ID = 0 Then

  Me.cmdAddNote.Visible = False
  Me.dgvNotes.Visible = False
  Me.DefaultHitsAndMisses()

Else 
  Me.cmdAddNote.Visible = True

  If Not MyIncident.Action Is Nothing Then
    Me.cboCorrectiveActionStatus.SelectedValue =  Me.MyIncident.Action.Status.ID  
  End If
End If 
```

MyIncident.Action 在 If 语句的第一行中是 Nothing，但似乎在 this 和 Else 行之间被实例化（在此示例中，仅执行 else 情况）。

如果需要，则在填充 Incident 对象时实例化 Action 对象，如果 Incident 对象没有关联的 Action，则显式保留未实例化的 Action 对象。

我希望根据 Action 对象是否为空来建立一些逻辑，但这似乎不是一个可靠的检查。

任何人都可以对此有所了解吗？

注意：很抱歉，但代码示例似乎不想正确标记！

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T12:39:10.643

你的 Action 是一个结构还是一个类？结构不能为空。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T12:45:33.467

它是用 定义的`As New`吗？或者也许是一个结构？

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T12:47:59.937

哈！我试图变得聪明，实际上是愚蠢的，我的 Action 属性在每次调用它时都在构造一个新的对象实例，并检查数据库中的适当数据。如果无法加载数据，我未能将 Action 成员变量设置回空。如果发生这种情况，我已经修改了该属性以不返回任何内容，现在一切都按预期工作。我试图通过“延迟加载”Action 对象来变得聪明。那会学我的。

感谢所有提供帮助的人。

# c# - 哪个 .config 元素会影响 UnhandledExceptionMode 设置为 UnhandledExceptionMode.Automatic 的异常处理？

> ID：545760
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2009-02-13T12:38:08.523
> 
>         
> 
> 标签：c#, winforms, configuration

我有一个 Windows 窗体应用程序，该应用程序在程序启动时包含以下代码：

```
Application.SetUnhandledExceptionMode(UnhandledExceptionMode.Automatic); 
```

在[UnhandledExceptionMode.Automatic](http://msdn.microsoft.com/en-us/library/system.windows.forms.unhandledexceptionmode(VS.85).aspx)的 MSDN 文档中，它指出：

> **自动**- 将所有异常路由到 ThreadException 处理程序，除非应用程序的配置文件另有说明。

有谁确切知道配置文件中的哪个元素/属性会影响此设置？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2011-10-13T23:09:42.327

您可以将 JitDebugging 部分添加到配置文件中，如下所示：

```
<configuration>
  <system.windows.forms jitDebugging="true"/>
</configuration> 
```

这等效于将 UnhandledExceptionMode 设置为`UnhandledExceptionMode.ThrowException`（顺便说一下，如果您在附加了调试器的情况下运行应用程序，则会自动启用此选项）。

请注意，`UnhandledExceptionMode.Automatic`除非您另有说明，否则这是 .Net 使用的默认值；据我所知，将 Unhandled Exception Mode 显式设置为 Automatic 的唯一原因是，如果您想撤消之前将其更改为其他内容的调用。请注意，如果您将其设置为自动以外的其他设置，则不会读取配置文件设置。

请注意，如果您将 ThreadException 附加到当前 AppDomain，则结果会自动就像您将 UnhandledExceptionMode 设置为 一样`UnhandledExceptionMode.CatchException`。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-07-29T18:52:21.807

我也想知道这一点，我从来没有找到任何关于你可以设置的特定内置配置选项的信息（可能有一个，但我从来没有提到它是什么）。我认为我们还发现默认行为（如果您不这样做）等同于 ThrowException 模式，这与 MSDN 在该引用中暗示的相反。另外，我认为将其设置为“自动”就等于根本不碰它；它已经在自动开始。

但是，我确实发现有两个`SetUnhandledExceptionMode`. 正常的一个在每个线程的基础上运行（通常你只有一个 UI 线程，无论如何），但第二个也需要一个布尔值，它确定该设置是仅应用于当前线程（true）还是应用于所有 UI 线程（错误的）。传递 false 的行为就像为未来的 UI 线程设置默认设置，如果它们在`Automatic`启动时设置为模式（我的意思是消息循环，即调用`Application.Run`），并且您可以将自己的配置选项挂钩到进行此调用设置您的全局默认值。我不得不怀疑这是否是他们对模糊的“配置”参考的真正理解。

`SetUnhandledExceptionMode`不过需要注意的是，必须在同一上下文中创建任何窗口句柄之前进行调用。因此，必须在*任何*线程上创建任何窗口句柄之前使用 false 调用它。此外，Visual Studio 调试器显然会在您的代码启动之前导致窗口句柄存在，因此在调试时此调用永远不会成功（为 false）。但是，该窗口句柄不在您的线程上，因此可以在调试场景中安全地完成正常调用（或 true）。我不确定在 WinForms 应用程序位于创建的子域而不是作为顶级/初始域的其他情况下，这是如何表现的，无论子域继承了 any-handle-created 标志还是重新开始。也许这就是 Visual Studio 案例中的实际问题。

在该线程上创建任何窗口句柄之前，仍然必须进行正常调用（或使用 true 调用）。我相信如果您随后在同一个线程上重新进入，此设置将在退出应用程序上下文时持续存在`Application.Run`（就像句柄创建的标志一样，它会中断进一步的更改调用）。但请注意，订阅是基于每个线程、每个上下文的，并且在退出`Application.ThreadException`时会丢失。`Application.Run`它也可以只有一个订阅者（覆盖任何以前的订阅者），并且在消息循环运行时不能更改。因此，如果您`Application.Run`再次致电，您必须`Application.ThreadException`在致电前重新订阅`Application.Run`，否则它们将被捕获并发送到默认的 WinForms 处理程序（我不是指 UnhandledException），因为“异常模式”设置仍然存在。通常，您不会在同一个线程上不断进入和退出消息循环，所以这不是问题，但我们遇到了它，因为我们必须在[Gibraltar.Agent](http://www.gibraltarsoftware.com/)中这样做。

`AppDomain.UnhandledException`但是，它是具有多个订阅者的正常事件，并且不是特定于线程的。订阅一次，您就可以使用整个 AppDomain（例如 CurrentDomain）。

# c# - 隐藏 c# windows 应用程序源代码

> ID：545767
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-13T12:41:19.157
> 
>         
> 
> 标签：c#, obfuscation

我使用 C# .Net 2.0 编写了一个 Windows 应用程序，我想做一些隐藏源代码的事情，所以当任何人使用重构工具时都看不到源代码。我使用了 dotfuscator，但它只是更改了函数名称，而不是所有源代码。

更新：我想隐藏源代码，不是因为隐藏密钥，而是隐藏代码的工作方式。

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T12:50:41.677

根据定义，IL 在身体中剩余的东西方面非常具有表现力。你只需要：

*   找到一个更好（阅读：更昂贵）的混淆器

*   将关键源保持在您的控制之下（例如，通过 Web 服务，因此关键逻辑永远不会在客户端）。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T13:08:06.097

好吧，源代码是你的，除非你明确提供它，否则你可能只提供编译后的二进制文件。

现在，这些编译的二进制文件是 IL 代码。为了防止有人“反编译”并将您的 IL 代码反向工程回源代码，您需要对 IL 代码进行混淆处理。这是通过代码混淆器完成的。市场上有很多。

您已经使用 dotfuscator 完成了此操作，但是，您说它只更改了函数名称，而不是所有源代码。听起来您正在使用 Visual Studio 附带的 dotfuscator 版本。这实际上是“社区版”，仅包含“专业版”功能的一个子集。请参阅[此链接](http://msdn.microsoft.com/en-us/library/ms227240(VS.80).aspx)以获取社区版和专业版功能的比较矩阵。

如果您想对代码进行更多的混淆（特别是为了防止人们使用 Reflector 等工具），您将需要 Dotfuscator 的专业版，或其他包含类似功能的代码混淆器产品。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T12:56:34.220

一旦人们掌握了您的二进制文件，他们就可以对其进行逆向工程。编译为字节码的语言（C# 和 Java）更容易，编译为特定于 CPU 的二进制文件的语言更难，但总是有可能的。面对它。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T12:59:25.493

尝试 SmartAssembly
 [http://www.smartassembly.com/index.aspx](http://www.smartassembly.com/index.aspx)

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T12:50:43.110

混淆软件可以隐藏方法内容的长度是有限的，从根本上改变内部结构而不影响正确性（当然还有性能）是非常困难的。

值得注意的是，带有许多小方法的代码一旦被混淆，就会变得更难理解，尤其是当采用了在方法之间共享名称的技术时，这些方法看起来会与眼睛发生冲突，但不会与运行时发生冲突。

一些混淆器允许生成在任何目标语言中都无法表示的构造，例如 CIL 中允许的所有操作的集合远远超过通过 c# 甚至 C++/CLI 表达的那些。但是，这通常需要显式设置才能启用（因为它可能会导致问题）。这可能会导致反编译器失败，但有些人会尽力而为并解决它（也许内联它无法处理的 il ）。

如果您将 pdb 与应用程序一起分发，那么由于额外的符号，可以推断出更多。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-11-20T09:19:18.880

只是符号重命名不足以对您的应用程序进行逆向工程。您还需要控制流混淆、字符串加密、资源保护、元数据减少、反反射器防御等。试试支持所有这些以及更多功能的[Crypto Obfuscator 。](http://www.ssware.com/cryptoobfuscator/obfuscator-net.htm)

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2013-12-10T11:34:34.397

为您的应用程序创建一个设置项目，并将设置安装在您朋友的计算机上，就像一个软件一样。使用 microsoft visual studio 创建安装项目有 5 个步骤。

第 1 步：创建一个示例 .Net 项目。在以发布模式构建您的项目之后，我将此项目命名为“TestProject”。第 2 步：使用右键单击您的解决方案添加新项目并选择安装项目并将其命名为“TestSetup”。第 3 步：右键单击设置项目并添加主输出，然后选择显示的项目。步骤 4：右键单击安装项目并选择查看-> 文件系统 -> 应用程序文件夹。现在复制您想要在安装文件夹中的内容。第 5 步：现在转到我们的项目文件夹并打开发布文件夹，您可以在此处获取 setup.exe 文件。双击“TestSetup”文件并将您的项目安装到您和其他计算机上。

# cocoa - 你如何测试你的 Cocoa GUI？

> ID：545768
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2009-02-13T12:41:46.707
> 
>         
> 
> 标签：cocoa, testing, gui-testing

我想为我的 Cocoa 程序的 GUI 编写一些测试。

Cocoa 应用程序有什么好的 GUI 测试框架吗？我发现的唯一东西是[Squish](http://www.froglogic.com/pg?id=Products&category=squish&sub=editions&subsub=mac)，2.400 欧元，远远超出了我的预算……</p>

有任何想法吗？*你*如何测试你的 Cocoa GUI？

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-06-01T05:40:44.777

这取决于您所说的“测试 Cocoa GUI”是什么意思。

如果您想要 MPW 中包含的旧[虚拟用户](http://www.mactech.com/articles/mactech/Vol.12/12.09/UsingVirtualUser/index.html "使用虚拟用户")工具之类的工具，那么这些工具很少见；您将看到像 Squish 和 Eggplant 这样的工具。  

如果您想为应用程序的人机界面编写*单元测试，我建议您遵循“**信任*[，但验证](http://eschatologist.net/blog/?p=16 "信任但要验证。")”方法，只要您建立正确的用户可以交互的连接（根据您的框架）正确使用您的框架。*这意味着您可以通过验证*您的模型和控制器代码是否正确连接到您的视图来完成大部分测试。

 **在我的博客上，我写了几个例子来说明如何专门用 Cocoa 来做这件事，一个用于[测试用 target-action 构建的用户界面](http://eschatologist.net/blog/?p=10 "单元测试 Cocoa 用户界面：Target-Action")，一个用于[测试用 Cocoa 绑定构建的用户界面](http://eschatologist.net/blog/?p=12 "单元测试 Cocoa 用户界面：Cocoa Bindings")。（当然，请记住，这两种技术并不是独占的：如果您想在通过 Cocoa 绑定管理的表视图中进行拖放操作，您还需要一个数据源，并且可能还有一个通过 target-action 连接的委托.)

我不写单元测试的东西——通常——是它们的超级视图中控件的定位或类型。但是，有时这对于获取和保持正确很重要；在这种情况下，我可以只查询控件的适当属性并使用标准断言验证它们。

我**几乎从不**编写代码来“模拟事件”。我最接近的方法是构造一个虚假的拖动信息对象并将其传递给大纲视图数据源，以确保它能够正确处理拖动。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-02-13T20:28:46.270

我建议您看一下 Google 的[Macintosh 工具箱](http://code.google.com/p/google-toolbox-for-mac/)。除了其他一些不错的东西之外，它还为 NSView 和 CALayers 添加了一组非常不错的状态和渲染测试。在您的单元测试中，您断言视图/图层状态或渲染图像与保存的（按名称）模板匹配。如果模板在测试包中不存在或与保存的版本不匹配，则会生成新的编码状态或呈现的 TIFF 以供查看。GTM 为 NSView 和 CALayer 提供了类别来进行状态编码和渲染。显然，您可以在您自己的 NSView 或 CALayer 子类上覆盖这些类别来编码相关状态（使用 NSCoder 协议）或渲染。

它还允许您（轻松）以编程方式发送关键事件并使用单元测试运行运行循环，并且它支持 OS X 和 iPhone 上的单元测试。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2011-05-10T16:52:32.950

我创建了一个开源 Python 包，它使用 Apple Accessibility API 等来创建一个经典的 GUI 自动化库，让您可以看到 Cocoa GUI 并与之交互。[PyATOM 主页](http://pyatom.com/)

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T15:00:25.640

[您可以在http://www.testplant.com/](http://www.testplant.com/)上查看并考虑 TestPlant（以前称为 Redstone Software）的 Eggplant 。

[这](http://developer.apple.com/business/macmarket/eggplant.html)是苹果去年在他们身上发表的一篇文章。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-02-14T00:07:26.743

最新的 CocoaCast 播客采访了“Scripted GUI Testing with Ruby”一书的作者 Ian Dees。您可以在[CocoaCast了解更多信息](http://cocoacast.com/)

# java - 检测作为参数传递的对象的变化值

> ID：545779
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-02-13T12:46:03.170
> 
>         
> 
> 标签：java, parameter-passing, checkstyle, findbugs, pmd

我现在正在使用看起来像这样的代码

```
public String getName(User user) {
     user.setSth(...);
     return user.getName();
} 
```

我认为更改作为参数传递的对象是不好的做法。是否有检测这种代码的工具？我查看了 findbugs、pmd 和 checkstyle，但找不到任何检查。

PS对不起不好的例子。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T13:36:18.570

我认为您已经走在正确的轨道上：检测此类代码的最佳工具几乎肯定是[Findbugs](http://findbugs.sourceforge.net/)。但是，您可能需要为此模式编写自己的检测器。  [这是一个](http://www.ibm.com/developerworks/library/j-findbug2/)如何编写检测器的示例，尽管它并不完全是您正在寻找的检测器。

**警告**：我真的不同意具有副作用的吸气剂总是不好的风格。但是，如果您真的想找到那种东西，我会推荐 Findbugs。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T12:58:29.740

您将找不到任何东西，因为从工具的角度来看，“getName”和“setSth”只是方法调用。人类会说“这是一个 getter”和“这是一个 setter”，但工具不会。事实上，getName() 不是一个 getter，因为 getter 不接受参数。

因此该工具看不到任何异常，因为方法一直在更改对象。

如果您想强制执行此规则，请查看扩展 findbugs 和 PMD。两者都允许您定义额外的约束。您正在寻找的可能是：

*   如果方法名称以“get”开头

*   AND 方法体调用任何对象的方法作为参数传递

然后打印警告。这不应该花太长时间。运行此程序，您将看到有多少“误报”（有关实际可行的方法的警告）。这将帮助您确定是否值得进一步追求。另外，您将有一个新项目添加到您的简历中:)

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T13:33:50.667

您可以使其`User`不可变（声明它`final`，声明所有属性`final`并远程设置设置器。我知道这并非在任何地方都可行，但在许多地方都很好，并且将其传递给其他函数不会有任何问题）。

如果您必须“更改”某些内容，则可以实现`newId`该示例中的功能：

```
public final class User {
    private final String name;
    private final int id;

    User(String name, int id) {
        this.name = name;
        this.id = id;
    }

    public User newId(int newId) {
        return new User(this.name, newId);
    }

    //getters here;
} 
```

内置的`String`, `Integer`, ... 类也可以做到这一点。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T13:11:45.823

您可以创建一个名为 UserView 的仅包含“getter”的接口，让 User 实现它并使用新的 UserView 接口作为参数类型。

```
interface UserView{
 public String getName();
...

class User implements UserView...

public String getName(UserView user) {
     user.setSth(...); // Will not compile
     return user.getName();
} 
```

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T13:32:29.953

实际上，这在 C++ 中通过`const`限定符很容易做到。您将定义一个参数，`const`并且对于该参数，您只能调用定义为的方法`const`- 通常是 getter。

在 Java 中，这是不存在的，坦率地说，我并不介意。如前所述，有可以检查此行为的源代码分析器，以及执行此操作的元编程方法。

就个人而言，我相信*如果方法命名正确，*将对象传递给它是没有问题的，以便对其进行修改。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T13:10:54.700

有些工具可以在比编译器通常所做的更高级别上“推理”代码。例如，声明性元编程是一门学科，它允许编写程序来检查另一个程序是否符合某种设计，或者相反，可以挖掘代码异味和反模式。

一些链接：

[http://prog.vub.ac.be/DMP/](http://prog.vub.ac.be/DMP/)

[http://www.cs.bris.ac.uk/Publications/pub_master.jsp?id=1000273](http://www.cs.bris.ac.uk/Publications/pub_master.jsp?id=1000273)

其余的

[http://www.google.com/search?num=100&hl=en&q=声明式+元编程](http://www.google.com/search?num=100&hl=en&q=Declarative+Metaprogramming)

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T13:31:32.700

您正在 C++ 中寻找类似“const”的东西，它将强制使参数值与传入的引用一样不可变。不可变对象保证，如果您可以使用它们。

您认为这是“不好的”，因为这样的副作用会让用户感到惊讶。这是有效的，但只有当它是一个*不受欢迎的*惊喜时才会有害。  

# makefile - 如何为单独的调试和发布构建目录创建目标？

> ID：545780
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-02-13T12:46:09.207
> 
>         
> 
> 标签：makefile, gnu-make

我正在寻找建议以在递归makefile系统中正确处理单独的调试和发布构建子目录，该系统使用gnumake手册中记录的$（SUBDIRS）目标将make目标应用于（源代码）子目录。

具体来说，我对实现“all”、“clean”、“realclean”等目标的可能策略感兴趣，这些目标要么假设其中一棵树，要么应该在两棵树上工作，这会导致问题。

我们当前的 makefile 使用一个 COMPILETYPE 变量，该变量设置为 Debug（默认）或 Release（'release' 目标），它可以正确地进行构建，但清理并使所有内容仅在默认的 Debug 树上工作。传递 COMPILETYPE 变量会变得笨拙，因为是否以及如何这样做取决于实际目标的值。

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T13:30:05.497

一种选择是在每个构建类型的子目录中都有特定的目标。因此，如果您在顶层执行“make all”，它会查看 COMPILETYPE 并酌情调用“make all-debug”或“make all-release”。

或者，您可以在顶层设置一个 COMPILETYPE 环境变量，并让每个子 Makefile 处理它。

真正的解决方案是不进行递归生成，而是将生成文件包含在顶级文件的子目录中。这将使您可以轻松地在与源代码所在的目录不同的目录中构建，因此您可以拥有*build_debug*和*build_release*目录。它还允许并行 make 工作（make -j）。有关完整说明，请参阅[Recursive Make Considered Harmful](http://miller.emu.id.au/pmiller/books/rmch/)。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T16:59:41.733

如果您在 Makefile 中对使用 $(COMPILETYPE) 变量在所有规则中引用适当的构建目录（从生成目标文件的规则到 clean/dist/etc 的规则）进行了规范，那么您应该没问题。

在我从事的一个项目中，我们有一个 $(BUILD) 变量被设置为（相当于）build-(COMPILETYPE)，这使得规则更容易一些，因为所有规则都可以引用 $(BUILD)，例如，clean 将 rm -rf $(BUILD)。

只要您使用 $(MAKE) 来调用子制作（并使用 GNU make），您就可以自动将 COMPILETYPE 变量导出到所有子制作，而无需执行任何特殊操作。有关详细信息，请参阅[GNU make 手册的相关部分](http://www.gnu.org/software/make/manual/make.html#Variables_002fRecursion)。

其他一些选项：

*   当编译器标志更改时强制重新构建，方法是在跟踪最后使用的编译器标志集的元文件上添加所有对象的依赖项。例如，参见[Git 如何管理目标文件](http://git.kernel.org/?p=git/git.git;a=blob;f=Makefile;h=b040a96e50a30c5413f109d4e49d9c538625918f;hb=HEAD)。

*   如果您使用的是 autoconf/automake，您可以轻松地为不同的构建类型使用单独的构建异地构建目录。例如，`cd /scratch/build/$COMPILETYPE && $srcdir/configure --mode=$COMPILETYPE && make`这会将构建类型从 Makefiles 中取出并放入配置中（您必须添加一些支持以根据您的值指定所需的构建`--mode`标志`configure.ac`）

如果你给出一些更具体的例子来说明你的实际规则，也许你会得到一些更具体的建议。

# tfs - 如何确定 TFS 中的标签应用于哪个变更集？

> ID：545785
> 
>         
> 
> 赞同：18
> 
>         
> 
> 时间：2009-02-13T12:48:53.850
> 
>         
> 
> 标签：tfs, label, changeset

我们正在使用 Team Foundation Server，我们正在使用标签在我们的版本历史记录中创建特定版本（内部或外部）的生成点。

现在我们想知道一个特定的变更集是在特定标签之前还是之后完成的（因此是否包含在该版本中），但我们一定是找错地方了。此信息通常在错误跟踪系统中提供，但这次该字段保持打开状态，因此我们认为我们可以使用 TFS 来解决它。

文件的版本历史不包括应用的标签。要查找标签，我知道要查找的地方是使用“获取特定版本”对话框，将类型设置为标签并使用标签选择对话框查看我们制作了哪些标签，但是这个对话框没有告诉我变更集在应用标签之前/之后。

确定特定更改是否属于该版本的唯一方法是创建新工作区，将包含文件的目录映射到磁盘上的临时目录，使用“获取特定版本”对话框提取该版本并执行文件差异？

请告诉我我有多愚蠢，并指出我正确的方向。

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2012-12-12T17:22:17.270

在本地工作区运行

```
tf history . /stopafter:1 /noprompt /r /version:Lmylabel 
```

要得到

```
Changeset User          Date       Comment
--------- ------------- ---------- --------------------------------------------
88888     brian_low     11/11/2012 did some work 
```

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2009-02-13T12:57:46.790

您是否尝试过打开源代码管理资源管理器，文件 -> 源代码管理 -> 标签 -> 查找标签？[编辑：这可能是测试版，我这里没有 TFS...]

另外，您在使用[SideKicks](http://www.attrice.info/cm/tfs/)吗？标签 SideKick 允许您查找标签并查看相关的变更集。

* * *

## 回答 #3

> 赞同：9
> 
>             
> 
> 时间：2009-02-13T13:39:14.307

TFS 中的标签并不代表特定的时间点——标签实际上可以在事件发生后进行编辑。有关更多信息，请参阅以下帖子：

*   [Buck Hodges：在 TFS VC 中查找两个标签之间的变化](http://blogs.msdn.com/buckh/archive/2006/08/28/diff-between-labels.aspx)

*   [Brian Harry：为什么 TFS 标签不像 VSS 标签。](http://blogs.msdn.com/bharry/archive/2005/11/18/494439.aspx)

出于这个原因，在记录特定版本的时间点时，我倾向于在 TFS 中使用变更集（实际上，我们使用构建它们的实际变更集编号标记我们的二进制文件和安装程序，以便更容易跟踪）。（变更集确实代表了存储库状态的唯一时间点）。

希望这可以帮助，

马丁。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2014-11-21T01:08:16.057

今天第一次遇到这个问题。从现在开始，我将在标签注释中包含变更集编号。不是很优雅的解决方法，但满足我的需求。

# web-services - 如何使用 vbscript（同步）调用 Web 服务？

> ID：545790
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-02-13T12:50:05.890
> 
>         
> 
> 标签：web-services, vbscript, synchronous, xmlhttprequest

实际上有很多例子，我已经使用了其中一个。但它是异步工​​作的，我的意思是它不等待我调用的函数完成。

```
function ProcessSend() 
    Set oXMLHTTP = CreateObject("MSXML2.XMLHTTP.4.0")
    Set oXMLDoc = CreateObject("MSXML2.DOMDocument")

    oXMLHTTP.onreadystatechange = getRef("HandleStateChange") 

    strEnvelope = "callNo="&callNo&"&exp="&exp

    call oXMLHTTP.open("POST","http://localhost:11883/ServiceCall.asmx/"&posFirm,true)
    call oXMLHTTP.setRequestHeader("Content-Type","application/x-www-form-urlencoded")

    call oXMLHTTP.send(strEnvelope)
end function

Sub HandleStateChange 
    if(oXMLHTTP.readyState = 4) then
        dim szResponse: szResponse = oXMLHTTP.responseText
        call oXMLDoc.loadXML(szResponse)
        if(oXMLDoc.parseError.errorCode <> 0) then
            'call msgbox("ERROR")
            response = oXMLHTTP.responseText&" "&oXMLDoc.parseError.reason
            'call msgbox(oXMLDoc.parseError.reason)
        else
            response = oXMLDoc.getElementsByTagName("string")(0).childNodes(0).text
        end if

    end if
End Sub 
```

我在 javascript 函数中调用 ProcessSend 函数。它连接到 web 服务，并返回“响应”变量。但我的 javascript 函数不等待 ProcessSend 函数结果。我怎样才能使它同步？

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-02-13T12:58:09.410

干得好：

```
function ProcessSend() 
    Set oXMLHTTP = CreateObject("MSXML2.XMLHTTP.4.0")
    Set oXMLDoc = CreateObject("MSXML2.DOMDocument")

    oXMLHTTP.onreadystatechange = getRef("HandleStateChange") 

    strEnvelope = "callNo="&callNo&"&exp="&exp

    call oXMLHTTP.open("POST","http://localhost:11883/ServiceCall.asmx/"&posFirm,false)'<< changed true to false here.
    call oXMLHTTP.setRequestHeader("Content-Type","application/x-www-form-urlencoded")

    call oXMLHTTP.send(strEnvelope)
end function

Sub HandleStateChange 
    if(oXMLHTTP.readyState = 4) then
        dim szResponse: szResponse = oXMLHTTP.responseText
        call oXMLDoc.loadXML(szResponse)
        if(oXMLDoc.parseError.errorCode <> 0) then
                'call msgbox("ERROR")
                response = oXMLHTTP.responseText&" "&oXMLDoc.parseError.reason
                'call msgbox(oXMLDoc.parseError.reason)
        else
                response = oXMLDoc.getElementsByTagName("string")(0).childNodes(0).text
        end if

    end if
End Sub 
```

如果其余代码在 JScript 中，为什么还要在 VBScript 中执行此操作？像这样：

```
function ProcessSend(){ 
    var oXMLHTTP = ActiveXObject("MSXML2.XMLHTTP.4.0") 
    strEnvelope = "callNo=" + callNo + " & exp=" + exp;
    oXMLHTTP.open("POST", "http://localhost:11883/ServiceCall.asmx/" + posFirm, false);
    oXMLHTTP.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
    oXMLHTTP.send(strEnvelope);
    if(oXMLHTTP.readyState == 4){
        if(oXMLHTTP.responseXML.parseError.errorCode != 0){
                response = oXMLHTTP.responseText & " " & oXMLHTTP.responseXML.parseError.reason;
        }else{
                response = oXMLHTTP.responseXML.getElementsByTagName("string")(0).childNodes(0).text;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2009-11-12T13:21:18.253

如果您正在执行同步调用，则不需要回调，您可以将代码压缩为：

```
function ProcessSend() 
    Set oXMLHTTP = CreateObject("MSXML2.XMLHTTP.4.0")
    Set oXMLDoc = CreateObject("MSXML2.DOMDocument")

    strEnvelope = "callNo=" & callNo & "&exp=" & exp

    call oXMLHTTP.open("POST", "http://localhost:11883/ServiceCall.asmx/"&posFirm, false)
    call oXMLHTTP.setRequestHeader("Content-Type","application/x-www-form-urlencoded")
    call oXMLHTTP.send(strEnvelope)

    dim szResponse: szResponse = oXMLHTTP.responseText
    call oXMLDoc.loadXML(szResponse)

    if(oXMLDoc.parseError.errorCode <> 0) then
        'call msgbox("ERROR")
        response = oXMLHTTP.responseText&" "&oXMLDoc.parseError.reason
        'call msgbox(oXMLDoc.parseError.reason)
    else
        response = oXMLDoc.getElementsByTagName("string")(0).childNodes(0).text
    end if
End Sub 
```

# vb.net - 如何在 VB.NET 中使用 Rhino Mocks 模拟方法（自定义行为）

> ID：545794
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-13T12:51:19.723
> 
>         
> 
> 标签：vb.net, mocking, rhino-mocks

如何在 VB.Net 中使用 RhinoMocks 模拟一种方法？我找到的参考是在 C# 中：

```
 Expect.Call(delegate{list.Add(0);}).IgnoreArguments() 
     .Do((Action<int>)delegate(int item) { 
     if (item < 0) throw new ArgumentOutOfRangeException(); 
 }); 
```

SharpDevelop 将其转换为：

```
Expect.Call(Function() Do
            list.Add(0)
            End Function).IgnoreArguments().Do(DirectCast(Function(item As Integer) Do
                        If item < 0 Then
                            Throw New ArgumentOutOfRangeException()
                        End If
                       End Function, Action(Of Integer))) 
```

但这也不起作用（它无法编译）。

这就是我想要做的：创建一个新对象并调用一个方法来设置该方法的一些属性。在现实生活中，此方法将使用在数据库中找到的值填充属性。在测试中，我想使用自定义方法/委托来模拟此方法，以便我可以自己设置属性（无需访问数据库）。

在伪代码中，这就是我想要做的：

```
 Dim _lookup As LookUp = MockRepository.GenerateMock(Of LookUp)()
 _luvalue.Expect(Function(l As LookUp) l.GetLookUpByName("test")).Do(Function(l As LookUp) l.Property = "value") 
```

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T13:43:40.957

不幸的是，您正在尝试同时执行 Sub lambda 和 Statement Lambda。VS2008 都不支持（但将在即将发布的 VS 版本中）。这是适用于 VB 的扩展版本

我在猜测 m_list 的类型

```
Class MockHelper
  Dim m_list as new List(Of Object)

  Public Sub New() 
    Expect(AddressOf CallHelper).IgnoreArguments().Do(AddressOf Do Hepler)
  End Sub

  Private Sub CallHelper() 
    m_list.Add(0)
  End Sub

  Private Sub DoHelper(ByVal item as Integer)
    if item < 0 Then
      Throw New ArgumentOutOfRangeException
    End If
  End Sub
End Class 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T14:18:42.417

我从来没有模拟过带有委托和 lambda 的东西，所以我不能给出这个问题的完整解决方案，但我确实想为 vb 开发人员分享 Rhino Mocks 3.5 中常用的“AssertWasCalled”函数的一些示例代码，因为我花了一些时间试图理解这个......（请记住，为简洁起见，以下内容保持简单）

**这是正在测试的方法 - 可能在用户对象的服务类中找到**

```
Public Sub DeleteUserByID(ByVal id As Integer) Implements Interfaces.IUserService.DeleteUserByID
      mRepository.DeleteUserByID(id)
End Sub 
```

**这是断言存储库方法被调用的交互式测试**

```
 <TestMethod()> _
  Public Sub Should_Call_Into_Repository_For_DeleteProjectById()
    Dim Repository As IUserRepository = MockRepository.GenerateStub(Of IUserRepository)()
    Dim Service As IUserService = New UserService(Repository)

    Service.DeleteUserByID(Nothing)

    Repository.AssertWasCalled(Function(x) Wrap_DeleteUserByID(x))
  End Sub 
```

**这是用于确保这与 vb 一起工作的 wrap 函数**

```
 Function Wrap_DeleteUserByID(ByVal Repository As IUserRepository) As Object
    Repository.DeleteUserByID(Nothing)

    Return Nothing
  End Function 
```

我发现这是一个非常讨厌的解决方案，但是如果它可以帮助遇到我遇到的相同问题的人，那么花时间发布这个是值得的；）

# asp.net - ASP.NET 示例应用程序

> ID：545796
> 
>         
> 
> 赞同：-3
> 
>         
> 
> 时间：2009-02-13T12:51:47.460
> 
>         
> 
> 标签：asp.net, starter-kits

任何人都知道我可以从 code.google.com 或其他地方下载的一些写得很好的（但不太复杂）的 ASP.NET Web 应用程序/网站？我只是想看看其他一些项目看起来如何，以便在项目上线之前获得一些关于如何构建项目的想法。非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-02-13T12:53:44.710

在这里查看：[微软官方 ASP.NET 初学者工具包](http://www.asp.net/community/projects/)

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2010-09-26T07:33:10.417

我建议使用**ASP.NET MVC 2**进行新的 Web 开发。

[您可以找到名为 NerdDinner 的适当“真实世界”示例应用程序和 185 页 PDF 演练“如何在Code Plex](http://nerddinner.codeplex.com/)上编写每一行代码。Nerd Dinner 有许多不错的功能，例如与地图或 OpenID 的集成。

运行应用程序在这里： http: [//www.nerddinner.com/](http://www.nerddinner.com/)

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T14:08:23.503

看看[代码项目](http://www.codeproject.com/KB/aspnet/)。那里有很多好东西。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T14:12:02.043

[CodePlex](http://www.codeplex.com/site/search)有很多 microsoft asp.net 开源项目，也是一个很好的起点

# winforms - Win32/.NET Win 表单中的 UC（用户组件）概念

> ID：545798
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-13T12:52:22.047
> 
>         
> 
> 标签：winforms, winapi, code-reuse

几年前，我什么时候作为网络开发人员在公司工作。它有我的第一个 Sirius Web 开发工作 (ASPx/C#)，所以它非常令人兴奋，从开发人员的角度来看，我学到了很多关于这个世界的知识。

在那个组中，我们对加载在页面 UC（用户控件）中的页面有一个概念，我不知道在每个使用每种语言的 Web 开发团队中是否都相同，我假设是这样。

合同结束，我回来开发win32“winForm”应用程序。

但是自从他们开始我尝试将相同的原则应用到我在那里学习的 win32 开发中，这意味着我在表单中加载了一堆 UC（视觉用户控件）。它们是常规的可视化组件，没有加载到工具箱中，代码在项目中可用，但组件不是以表单开发的，它们是在那里加载的。

我想知道关于这种方法的意见，其他人在做什么与此类似或更好，以及可以帮助我们加快开发速度和增加代码重用的改进，因为这就是全部内容。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T13:26:00.360

如果您在 Winforms 中使用布局组件，这*可能*是一种可以接受的方法，尽管我认为区分 Web 和 Windows 窗体（注意：不是 WPF！）是在前者中你做了很多“合成”这就是为什么 UserControl 概念如此有用，而在后者中，您可以在非常复杂的控件上进行操作（例如，第 3 方 - 在我的上一次演出中，我们通过一家名为[Infralution](http://www.infralution.com/)的小公司使用了令人难以置信的网格控件）

我会看到的主要问题是布局，因为渲染模型与 Web 有点不同。我对您的应用程序一无所知，但如果它“有效”，那才是最重要的。我假设在这种情况下，您可以正确使用 FlowLayoutPanel 和 TableLayoutPanel 之类的东西。

如果您想走更规范的路线，请看一下如何使用继承模型以更健壮的方式组合您的应用程序的简单创建组件 - 拥有一个基础 Form 类，其中包含您的“UserControl”类型的容器组件去，然后在应用程序运行时使用某种基于接口的依赖注入来交换它们。

最后，看看那里的一些开源 Windows 窗体应用程序，看看您是否对自己过于苛刻，因为通用 UI 和可重用组件是每个应用程序的目标。尽管我一直认为 Microsoft 的 Patterns & Practices 东西有些臃肿，但还是有一些好的想法，你应该学习他们提出的[Composite UI Application Block的一些方法。](http://msdn.microsoft.com/en-us/library/aa480450.aspx)

好吧，不是最后，我还想补充一件事：仔细研究 WPF，它将带回您在 Web 开发时代的许多概念，并在桌面应用程序中为您提供那种强大的功能。

# php - 使用 Imagick 创建两个 pdf 页面

> ID：545800
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-02-13T12:53:16.973
> 
>         
> 
> 标签：php, pdf, imagick

目前我可以使用此功能从 Imagick 中的图像创建 PDF 文件

```
$im->setImageFormat("pdf");
$im->writeImage("file.pdf"); 
```

并且可以像这样使用 imagick 获取多个页面

```
$im = new imagick("file.pdf[0]");
$im2 = new imagick("file.pdf[1]"); 
```

但是可以将两个图像对象保存到两个页面吗？（我在想的例子，不可能像这样）

```
$im->setImageFormat("pdf");
$im->writeImage("file.pdf[0]");

$im2->setImageFormat("pdf");
$im2->writeImage("file.pdf[1]"); 
```

* * *

## 回答 #1

> 赞同：15
> 
>             
> 
> 时间：2010-02-05T23:11:14.387

我知道这早就过期了，但是当我试图做同样的事情时，这个结果就出现了。以下是在 PHP 和 Imagick 中创建多页 PDF 文件的方法。

```
 $images = array(
    'page_1.png',
    'page_2.png'
);
$pdf = new Imagick($images);
$pdf->setImageFormat('pdf');
if (!$pdf->writeImages('combined.pdf', true)) {
    die('Could not write!');
} 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2013-06-13T13:56:04.090

接受的答案对我不起作用，因此，它总是生成一页pdf（来自构造函数的最后一张图片），为了完成这项工作，我必须首先获取文件描述符，如下所示：

```
$images = array(
  'img1.png', 'img2.png'
); 
$fp = fopen('combined.pdf', 'w');
$pdf = new Imagick($images);
$pdf->resetiterator();
$pdf->setimageformat('pdf');
$pdf->writeimagesfile($fp);
fclose($fp); 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T13:10:08.523

这管用吗？

```
$im->setImageFormat("pdf");
$im->writeImage("file1.pdf");

$im2->setImageFormat("pdf");
$im2->writeImage("file2.pdf");

exec("convert file*.pdf all.pdf"); 
```

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-15T05:56:09.597

[CAM::PDF](http://search.cpan.org/dist/CAM-PDF/)是一个纯 Perl 解决方案，用于像这样的低级 PDF 操作。您可以使用[appendpdf.pl](http://search.cpan.org/~cdolan/CAM-PDF-1.52/bin/appendpdf.pl)命令行工具，也可以像这样以编程方式执行此操作：

使用 CAM::PDF；我的 $doc1 = CAM::PDF->new('file1.pdf'); 我的 $doc2 = CAM::PDF->new('file2.pdf'); $doc1->appendPDF($doc2); $doc1->cleanoutput('out.pdf');

如果您能弄清楚如何让 ImageMagick 写入字符串而不是文件（我不是 ImageMagick 专家...），那么您可以通过将其全部保存在 Perl 中来节省一些性能开销。

（我是 CAM::PDF 的作者。它是免费软件：GPL+Artistic 双许可）。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T23:33:00.523

我不知道 php 或这个 Imagick 库，但如果调用外部程序是可以接受的，我可以推荐程序[pdfjoin](http://go.warwick.ac.uk/pdfjam)来合并 pdf 文件。

它确实依赖于 pdflatex，所以如果这是您打算在服务器上运行的东西，您可能需要安装额外的乳胶东西，但 pdfjoin 的最终结果非常好，所以我认为这是值得的。

# xml - XML Schema：根据父元素的属性值限制子元素？

> ID：545825
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-13T12:59:57.630
> 
>         
> 
> 标签：xml, xsd

有没有办法根据 XML Schema 中父元素的属性值来限制 XML 元素的子元素的使用？架构必须是什么样子？

```
<option name="mike" value="excset">
  <excludingsets>
    <excludingset>
      <option name="hd"/>
    </excludingset>
  </excludingsets>
</option>
<option name="mike" value="args">
  <arguments>
    <argument name="kjk" validatortype="regex">
      <regex value="dkas"/>
    </argument>
  </arguments>
</option> 
```

正如您在此示例中所看到的，该元素`<excludingset>`仅在属性值为 时才有效`<option>`，`value="excset"`并且该元素`<arguments>`具有时才有效`value="args"`。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T14:20:02.320

不在 W3C XML Schema 1.0 中。您可以在[ISO RelaxNG](http://relaxng.org/)中，我相信在[W3C XML Schema 1.1](http://www.w3.org/TR/xmlschema11-1/#cTypeAlternative)中。

# java - JBoss AS 目标部署

> ID：545831
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-13T13:03:17.263
> 
>         
> 
> 标签：java, jboss, jakarta-ee

有没有办法将 Maven 目标（带有类）路径指向 JBoss 应用程序服务器，而不是每次我编辑一些源时构建 .ear 并部署它？

在此先感谢，埃塔姆。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-18T01:04:01.540

尝试在 pom.xml 中指定构建目录。

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="
http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="
http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>com.mycomp.build</groupId>
    <artifactId>build-base</artifactId>
    <version>1.0-SNAPSHOT</version>
    <packaging>pom</packaging>
    <build>
        <directory>/path/to/jboss/server/default/deploy</directory>
    </build>
</project> 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T14:34:56.917

好吧，您可以在 jboss 部署目录中对目录进行符号链接（或更改 maven 目标目录属性）。但是，如果您正在编辑 java 源代码，那么每次更改都需要重新部署。

[为此，使用maven cargo 插件](http://cargo.codehaus.org/Maven2+plugin)更容易，它可以（重新）将您的 ear 部署到正在运行的 j2ee 服务器。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-19T16:57:27.677

有一个名为[JavaRebel](http://www.zeroturnaround.com/javarebel/)的工具，它是一个 Java 代理，可在类更改时自动重新加载。我忘记了它们是否支持未分解的 ear 文件，但是在 Jboss 中，您始终可以将 ear 部署为分解的 jar（目录），因此要进行更改，您只需重新编译类并更新它们，JavaRebel 就会即时更新正在运行的应用程序. 它也很不错。

# javascript - 在 JavaScript 中执行默认操作后如何捕获事件

> ID：545841
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-13T13:06:49.767
> 
>         
> 
> 标签：javascript, events

我在文章（[文章](http://dev.opera.com/articles/view/timing-and-synchronization-in-javascript/)）中阅读了以下有关事件处理程序的概念：

> 对于非冒泡事件，调度的顺序是这样的：
> 
>   
>   
> 
> 1.  捕获阶段：所有“捕获”事件处理程序从上到下在所有祖先元素上触发。
> 
> 2.  该事件在目标元素上触发，这意味着在该元素上为特定事件注册的所有事件处理程序都将被执行（以未定义的顺序！）
> 
> 3.  执行默认操作（如果未在任何处理程序中取消）
> 
>   
>   
> 
> 对于冒泡事件，顺序如下：
> 
>   
>   
> 
> 1.  捕获阶段：所有“捕获”事件处理程序从上到下在所有祖先元素上触发。
> 
> 2.  在目标元素上触发事件
> 
> 3.  冒泡阶段：事件在所有祖先元素上触发，从目标和向上。
> 
> 4.  执行默认操作（如果未在任何处理程序中取消）

这里，默认操作本质上是用户在产生事件时所期望的浏览器活动，即当按键被按下时字符出现在文本区域中。

现在是否有任何机构如何附加在执行默认操作后将调用的回调？所以我想在文本区域中出现字符时捕捉一个事件。

onchange 不是解决方案，因为它在失去焦点时被触发。onkeyup 也不是解决方案

有任何想法吗？

[UPD] 我试图在更改发生后立即捕获 textarea 值更改。这是为了将 textarea 的值复制到 div 中。因此，当我使用 onkeydown 事件时，div 内容会延迟一键更新。我想在按键后立即拥有。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T14:00:21.103

这是一个 hack，但如果您在常规事件处理程序中添加以下行，它应该可以工作：

```
setTimeout(functionToExecuteAfterDefaultAction, 0); 
```

* * *

Sergii 有一个正确的想法：`keypress`/`keyup`实际上在修改 textarea 的值后触发。这是一个没有 jQuery 的例子：

```
<form>
<textarea></textarea>
<textarea></textarea>
</form>
<script>
var elements = document.forms[0].elements;
elements[0].onkeypress = elements[0].onkeyup = function() {
    elements[1].value = elements[0].value;
};
</script> 
```

当我实现一个不断增长的文本区域时，我知道这种方法存在一些问题，但我不记得到底出了什么问题:(

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T14:31:15.133

您需要 onkeyup/onkeypress 组合：

```
<script type="text/javascript">
$(document).ready(function(){
    // single button (abcd)
    $("#source").keyup(function() {
        $("#target").html( $(this).val() );
    });
    // pressed button (aaaaaaaa)
    $("#source").keypress(function() {
        $("#target").html( $(this).val() );
    });
});
</script>
<textarea id="source"></textarea>
<div id="target"></div> 
```

此示例使用 jQuery。

# testing - 如何使用自动化测试涉及高度复杂计算的应用程序？

> ID：545842
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-13T13:07:37.767
> 
>         
> 
> 标签：testing, testing-strategies, automated-tests

我想遵循以下内容来测试涉及复杂计算的应用程序：

1.  如何使用测试自动化工具来测试计算？（使用自动化工具如 QTP 或开源工具）

2.  如何在测试计算时确定覆盖率，如何设计测试用例？

提前致谢，Testmann

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T13:36:56.837

有时，您必须估计预期的结论，然后从程序运行中填充测试用例。

只要你确信它是正确的，这并不是什么大罪。如果代码更改破坏了代码，这些测试将立即让您知道。此外，如果您正在测试一个子集，那么信任度就不是那么大了。

和覆盖？至少覆盖每个分支一次（即任何 if 或循环语句）。覆盖每个阈值，它的两侧（对于整数除法，将 -1、0 和 1 作为分母）。然后添加一些更好的措施。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T14:44:17.083

我们必须在我们构建的应用程序中测试一些非常复杂的计算。为此，我们使用了一个名为 FitNesse 的工具，它是一个 wiki 测试工具（也是开源的）。当您以表格样式格式提供数据时，它的效果非常好。

我们在 C# 中有一些代码可以执行一些非常复杂的计算。所以我们所做的是在 FitNesse 中编写了一个测试工具，然后我们为它提供了大量的测试数据。我们非常努力地涵盖所有情况，因此我们使用了一种内部真值表来确保我们获得了所有可能的数据输入组合。

FitNesse 测试工具对我们来说非常宝贵，因为随着时间的推移，计算的复杂性会因需求的变化而发生变化。我们能够确保计算的正确性，因为我们的 FitNesse 测试充当了一个非常好的回归套件。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T14:50:26.567

要测试现有代码，您应该假设代码（大部分）是正确的。所以你只需给它一些数据，运行它并记录结果。然后在测试用例中使用记录的结果。

当您进行下一次更改时，您的输出也应该更改并且测试将失败。将新结果与您预期的结果进行比较。如果存在差异，那么你错过了一些东西 -> 编写另一个测试来弄清楚发生了什么。

这样，您可以建立关于未知系统的专业知识。

当您要求覆盖时，我假设您无法为实际计算创建覆盖数据。在这种情况下，只需确保执行所有计算并为它们提供多个输入。这应该让你知道如何进行。

# encryption - 我应该在 Ubuntu 中使用哪个归档实用程序？

> ID：545849
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-13T13:09:25.547
> 
>         
> 
> 标签：encryption, archiving

我是 Mac/Ubuntu 用户。我有诸如“AWK”、“awk”、“awk_tip”和“awk_notes”之类的文件夹。我需要将它们存档，但各种实用程序让我感到困惑。我看过 Tar、cpio 和 pax，但 Git 开始让我着迷。我偶尔需要加密和备份。

请列出不同归档实用程序的优缺点。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-02-13T13:21:21.557

Tar、cpio 和 pax 是古老的 Unix 实用程序。例如，tar（这可能是其中最常见的一种）最初用于在磁带上进行备份（因此得名 tar = 磁带存档）。

当今最常用的存档格式是：

*   tar（在 Unix/Linux 环境中）

*   tar.gz 或 tgz（一个 gzip 压缩的 tar 文件）

*   zip（在 Windows 环境中）

如果您只想要一个简单的工具，请使用 zip。它在大多数平台上开箱即用，并且可以受密码保护（尽管保护在技术上很弱）。

如果您需要更强的保护（加密），请查看[TrueCrypt](http://www.truecrypt.org/)。这很棒。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T13:17:34.747

你在什么操作系统/工具链下工作？这可能会限制现有解决方案的范围。你的名字暗示了 Unix，但是哪一个？此外，您是否需要便携性？

标准的 linux 解决方案（至少对于像我这样的新手来说）可能是对文件夹进行 tar 和 gzip 或 bzip2 处理，然后如果你真的需要的话，用 gnupg 加密它们（加密 awk 教程对我来说似乎有点矫枉过正）。您还可以使用成熟的备份解决方案，例如 bacula，使用 rsync 同步到不同的位置（也许同步到备份服务器？）。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T14:11:36.100

如果您从 ext2/ext3 文件系统备份目录，您可能需要考虑使用转储。一些不错的功能：

*   它可以备份一个目录或整个分区

*   它保存权限和时间戳，

*   它允许您进行增量备份，

*   它可以压缩（gzip 或 bzip2）

*   如果需要，它会根据大小限制自动将存档拆分为多个部分

*   它将通过网络备份或备份到磁带和文件

它不支持加密，但您可以随时加密转储文件。

# visual-studio - 解决方案项跨越 Visual Studio 中的多个 Web 项目

> ID：545855
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-13T13:11:04.153
> 
>         
> 
> 标签：visual-studio, projects-and-solutions

我有两个 Web 项目，这两个项目共享客户端 JavaScript，目前在两个项目中几乎相同的副本。我说几乎是因为我显然对这些文件有版本控制问题。

我已设法将文件放在解决方案文件夹中，并从我的项目中创建了指向它们的链接，这在我发布项目时有效。但是，当我在本地运行 WebDev 服务器时，这些文件不是硬文件系统链接吗？它们似乎在 Visual Studio 项目中维护，仅供参考。

问题是 WebDev 服务器将向文件的假定有效位置发出请求，但它不会在那里找到它，因为它在该位置不作为物理文件存在。

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T13:13:52.807

如果您使用 SVN，您可以将文件作为外部文件进行管理。基本上，这将允许您将共享文件保存在一个位置，并拥有对它们的外部（物理文件）引用。

[http://svnbook.red-bean.com/en/1.0/ch07s03.html](http://svnbook.red-bean.com/en/1.0/ch07s03.html)

忍者戴夫

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2011-07-06T15:09:52.887

这是一个可以帮助您的帖子：

**在 Web 应用程序项目中使用链接文件**

[http://consultingblogs.emc.com/jamesdawson/archive/2008/06/03/using-linked-files-with-web-application-projects.aspx](http://consultingblogs.emc.com/jamesdawson/archive/2008/06/03/using-linked-files-with-web-application-projects.aspx)

# imap - imap - 如何验证是否传输了完整的消息？

> ID：545858
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-13T13:11:44.963
> 
>         
> 
> 标签：imap, checksum

IMAP 协议是否提供任何方法来验证/验证完整的消息是否已从服务器传输到本地客户端？即是否有任何等效的 ETag / MD5 或其他校验和？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-16T20:13:37.363

当您发出 FETCH 命令时，IMAP 协议将告诉您将要传输多少个八位字节。这应该使您能够验证消息的完整性。但是，没有任何命令（AFAIK）可以提供任何类型的校验和/哈希功能。

# c# - 在模式之间转换 XML - XSLT 还是对象？

> ID：545860
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-13T13:12:01.720
> 
>         
> 
> 标签：c#, xml, xslt

鉴于：

*   两个相似且复杂的模式，我们称它们为 XmlA 和 XmlB。

*   我们想从 XmlA 转换为 XmlB

*   并非生成 XmlB 所需的所有信息都包含在 XmlA 中（需要进行数据库查找）

鉴于我需要引用数据库中的其他数据，我可以为此使用 XSLT 吗？如果是这样，支持使用 XSLT 而不是普通的旧对象映射和转换的论据是什么？我认为以下标准可能会影响此决定：

*   性能/速度

*   内存使用情况

*   代码重用/复杂性

该项目将基于 C#。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-02-13T13:21:09.340

使用 C#，您始终可以为 XSLT 转换提供扩展对象，因此这不是问题。

如果没有可用的模式和 XML，很难定性地说，但我想编译的转换将比对象映射更快，因为您必须进行大量的轮子重新发明。

此外，XSLT 的巨大优势之一是它的可维护性和可移植性。如果您正在监视文件，您将能够通过模式更改非常快速地调整 XSLT 文档，并且无需进行任何重建和删除。

根据您给我们的内容，可以选择任何一种方式。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T14:19:12.477

我的问题是转换集改变的可能性有多大？  

如果它们不会有太大变化，我倾向于在一个源代码中完成所有这些——这里是 C#。我会使用 XSD.exe（.NET XSD 工具）生成的序列化类以及数据层来处理这类事情。

另一方面，如果转换集可能会改变——或者可能需要在安装后“更正”——那么我倾向于将 XSLT 和 C# 扩展组合到 XSLT。Extension 机制很简单，如果使用 XslCompiledTransform 类型，性能非常好。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T13:18:12.297

如果数据不在 xml 中，那么 xslt 将会很痛苦。您可以使用 提供其他文档`xsl:document()`，也可以使用 xslt 扩展方法（但供应商之间不太支持）。因此，除非您在 xslt 上死心塌地，否则在这种情况下它听起来不是一个好的选择（尽管如果使用得当，我是 xslt 的忠实粉丝）。

所以：如果可能的话，我可能会使用常规的命令式代码 - 流式 ( `IEnumerable<T>`)。当然，除非你有大量数据，否则这种细微差别是没有意义的。

# algorithm - 在球体上计算 Voronoi 图的算法？

> ID：545870
> 
>         
> 
> 赞同：39
> 
>         
> 
> 时间：2009-02-13T13:14:13.943
> 
>         
> 
> 标签：algorithm, math, geometry, computational-geometry, voronoi

我正在寻找一种简单的（如果存在）算法来找到球体表面上一组点的 Voronoi 图。源代码会很棒。我是一个德尔福人（是的，我知道......），但我也吃 C 代码。

* * *

## 回答 #1

> 赞同：26
> 
>             
> 
> 时间：2014-11-27T12:29:10.700

## 2016 年 7 月更新：

感谢许多志愿者（尤其是 Nikolai Nowaczyk 和我），现在有更健壮/正确的代码来处理 Python 中球体表面上的 Voronoi 图。这`scipy.spatial.SphericalVoronoi`从`0.18`scipy 版本开始正式可用。[官方文档](http://scipy.github.io/devdocs/generated/scipy.spatial.SphericalVoronoi.html)中有一个使用和绘图的工作示例。

该算法遵循二次时间复杂度。虽然对数线性是球体表面上 Voronoi 图的理论最优值，但这是目前我们能够实现的最佳值。如果您想了解更多信息并帮助开发工作，有一些与改进 Python 处理球形 Voronoi 图和相关数据结构的方式相关的未解决问题：

*   [努力改进 matplotlib 中球形多边形的绘制](https://github.com/matplotlib/matplotlib/pull/6248) 

*   [努力改进scipy中球面多边形表面积计算的处理](https://github.com/scipy/scipy/issues/6069)

有关与此 Python 代码和相关计算几何工作相关的理论/开发/挑战的进一步背景，您还可以查看 Nikolai 和我的一些谈话：

*   [Nikolai PyData 伦敦 2016 演讲](https://www.youtube.com/watch?v=zaGd5tXkCnE&index=35&list=PLGVZCDnMOq0qfJkoiFj-hN7lSHgQzXtqQ)

*   [Tyler PyData 伦敦 2015 演讲](https://www.youtube.com/watch?v=gxNa9BD5CnQ)

*   [Tyler PyCon 2016 计算几何教程](https://www.youtube.com/watch?v=nb3GRgtjlTw)

* * *

## 原答案：

实际上，我最近为球体表面的 Voronoi 图编写了一些开源 Python 代码：[https ://github.com/tylerjereddy/py_sphere_Voronoi](https://github.com/tylerjereddy/py_sphere_Voronoi)

用法、算法和限制记录在 readthedocs ( [http://py-sphere-voronoi.readthedocs.org/en/latest/voronoi_utility.html](http://py-sphere-voronoi.readthedocs.org/en/latest/voronoi_utility.html) ) 上。那里有一些详细的示例，但我也会在下面放置一两个。该模块还处理 Voronoi 区域表面积的计算，尽管在当前开发版本中存在一些数值弱点。

我还没有看到很多有据可查的球形 Voronoi 图的开源实现，但是 Jason Davies 的网站 ( [http://www.jasondavies.com/maps/voronoi/](http://www.jasondavies.com/maps/voronoi/) )上的 JavaScript 实现引起了一些关注。 . 我不认为他的代码是开放的。我还看到了一篇关于使用 Python 处理部分问题的博客文章（[http://jellymatter.com/2014/01/29/voronoi-tessellation-on-the-surface-of-a-sphere-python-code /](http://jellymatter.com/2014/01/29/voronoi-tessellation-on-the-surface-of-a-sphere-python-code/)）。上述帖子中引用的许多主要文献来源似乎很难实施（我尝试了其中一些），但也许有些人会发现我的实施很有用，甚至提出改进它的方法。

**例子：**

1)**为单位球面上的一组伪随机点生成 Voronoi 图：**

```
import matplotlib
import matplotlib.pyplot as plt
import matplotlib.colors as colors
from mpl_toolkits.mplot3d import Axes3D
from mpl_toolkits.mplot3d.art3d import Poly3DCollection
import numpy as np
import scipy as sp
import voronoi_utility
#pin down the pseudo random number generator (prng) object to avoid certain pathological generator sets
prng = np.random.RandomState(117) #otherwise, would need to filter the random data to ensure Voronoi diagram is possible
#produce 1000 random points on the unit sphere using the above seed
random_coordinate_array = voronoi_utility.generate_random_array_spherical_generators(1000,1.0,prng)
#produce the Voronoi diagram data
voronoi_instance = voronoi_utility.Voronoi_Sphere_Surface(random_coordinate_array,1.0)
dictionary_voronoi_polygon_vertices = voronoi_instance.voronoi_region_vertices_spherical_surface()
#plot the Voronoi diagram
fig = plt.figure()
fig.set_size_inches(2,2)
ax = fig.add_subplot(111, projection='3d')
for generator_index, voronoi_region in dictionary_voronoi_polygon_vertices.iteritems():
   random_color = colors.rgb2hex(sp.rand(3))
   #fill in the Voronoi region (polygon) that contains the generator:
   polygon = Poly3DCollection([voronoi_region],alpha=1.0)
   polygon.set_color(random_color)
   ax.add_collection3d(polygon)
ax.set_xlim(-1,1);ax.set_ylim(-1,1);ax.set_zlim(-1,1);
ax.set_xticks([-1,1]);ax.set_yticks([-1,1]);ax.set_zticks([-1,1]); 
plt.tick_params(axis='both', which='major', labelsize=6) 
```

![在此处输入图像描述](https://i.stack.imgur.com/ZGJDi.png)

2)**计算 Voronoi 区域多边形的表面积并验证重构的表面积是否合理：**

```
import math
dictionary_voronoi_polygon_surface_areas = voronoi_instance.voronoi_region_surface_areas_spherical_surface()
theoretical_surface_area_unit_sphere = 4 * math.pi
reconstituted_surface_area_Voronoi_regions = sum(dictionary_voronoi_polygon_surface_areas.itervalues())
percent_area_recovery = round((reconstituted_surface_area_Voronoi_regions / theoretical_surface_area_unit_sphere) * 100., 5)
print percent_area_recovery
97.87551 #that seems reasonable for now 
```

* * *

## 回答 #2

> 赞同：12
> 
>             
> 
> 时间：2009-02-13T13:34:58.370

这是一篇关于[球形 Voronoi 图](https://doi.org/10.1016/S0925-7721(02)00077-9)的论文。

或者，如果您了解 Fortran（哎呀！），这里有[这个网站](https://people.sc.fsu.edu/~jburkardt/f_src/sphere_voronoi/sphere_voronoi.html)。

原文链接（死）：[https ://people.sc.fsu.edu/~jburkardt/f_src/sxyz_voronoi/sxyz_voronoi.html](https://people.sc.fsu.edu/~jburkardt/f_src/sxyz_voronoi/sxyz_voronoi.html)

* * *

## 回答 #3

> 赞同：8
> 
>             
> 
> 时间：2012-12-20T10:32:38.810

请注意，球体上的 Delaunay 三角剖分只是凸包。因此，您可以计算 3D 凸包（例如使用 CGAL）并采用对偶。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2012-03-19T05:32:46.580

简而言之，试试[NCAR Graphics](http://ngwww.ucar.edu/)的[cssgrid](http://ngwww.ucar.edu/ngmath/cssgrid/csshome.html)。[我在 codereview.stackexchange.com 上为类似问题](https://codereview.stackexchange.com/a/10142/10803)写了更长的答案。

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2013-06-20T20:25:44.590

INRIA 有一篇关于球面上点的德劳内三角剖分 (DT) 的论文：[CAROLI、Manuel 等。对球体上或球体附近的点进行稳健且高效的 Delaunay 三角剖分。2009.](http://hal.inria.fr/inria-00405478/)他们谈论在[CGAL](http://www.cgal.org/)中的实现。

本文参考了 DT 算法的各种可用实现。

引用论文：

> 一个简单而标准的答案是计算点的 3D 凸包，这是众所周知的等价。

为了计算凸包，本文建议：

1.  [Hull，凸包程序。](http://www.netlib.org/voronoi/hull.html)

2.  [库尔](http://www.qhull.org/)。

3.  [三维凸包。](http://home.mims.meiji.ac.jp/~sugihara/opensoft/opensofte.html)在 FORTRAN 中。三维凸包。

4.  [FORTRAN 中的STRIPACK](http://orion.math.iastate.edu/burkardt/f_src/stripack/stripack.html)。

CGAL的DT C++类有[`dual`](http://www.cgal.org/Manual/latest/doc_html/cgal_manual/Triangulation_3_ref/Class_Delaunay_triangulation_3.html)获取Voronoi Diagram的方法。

根据Monique Teillaud（上述论文的作者之一）的这篇文章，在我看来，2012 年 11 月的实施还没有准备好[。](http://cgal-discuss.949826.n4.nabble.com/Triangulation-on-a-sphere-using-CGAL-tt4656139.html#a4656141)

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2013-09-23T00:50:08.813

已经有一段时间没有回答这个问题了，但是我发现了两篇论文在球体表面上实现了[Fortune 的算法（效率 O(N lg N)，内存 O(N)）。](http://en.wikipedia.org/wiki/Fortune%27s_algorithm)也许未来的观众会发现这些信息很有用。

*   Dinis 和 Mamede 的“Sweeping the Sphere”，发表在 2010 年科学与工程中的 Voronoi 图国际研讨会上。可在[http://dx.doi.org/10.1109/ISVD.2010.32购买](http://dx.doi.org/10.1109/ISVD.2010.32)

*   郑等人的“球体 Voronoi 镶嵌的平面扫描算法”。由于第一个，我不确定它是否已发布，但它的日期为 2011 年 12 月 13 日。可在[http://www.e-lc.org/tmp/Xiaoyu__Zheng_2011_12_05_14_35_11.pdf免费获得](http://www.e-lc.org/tmp/Xiaoyu__Zheng_2011_12_05_14_35_11.pdf)

我目前正在自己​​处理它们，所以我无法很好地解释它。基本思想是，只要您正确计算点的边界抛物线，Fortune 的算法就可以在球体表面上工作。因为球体的表面包裹，您也可以使用圆形列表来包含海滩线，而不必担心处理矩形空间边缘的单元格。这样，您可以从球体的北极向南扫过并再次返回，跳到向海滩线引入新点的站点（向海滩线添加抛物线）或引入单元顶点（移除海滩线的抛物线）。

这两篇论文都希望对线性代数理解这些概念有很高的舒适度，并且在他们开始解释算法本身的时候，他们都一直在迷失我。不幸的是，它们都不提供源代码。

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2009-06-23T21:04:22.553

我认为可以使用非欧几里得几何构造每个点的 Voronoi 平面。通常是二维平面上的一条线，现在是球体上的一个“大圆”（参见维基百科：[椭圆几何](http://en.wikipedia.org/wiki/Non-Euclidean_geometry#Elliptic_geometry "椭圆几何")）。很容易找到两个点之间的任何大圆的错误一侧的点，只需旋转球体，使分割大圆是赤道，然后它是另一个半球上的所有点而不是你所在的点构建 Voronoi 平面。

这不是完整的答案，但这是我要开始的地方..

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T13:20:11.870

[这里](http://www.torry.ru/authorsmore.php?id=2322)有一个很好的 Voronoi 图示例程序（包括 Delphi 5/6 的源代码）。

我认为“球体表面上的点”意味着您首先必须将它们重新映射到 2D 坐标，创建 Voronoi 图，然后将它们重新映射到球体表面坐标。[维基百科 UV 映射文章](http://en.wikipedia.org/wiki/UV_mapping)中的两个公式在这里有效吗？

另请注意，Voronoi 图将具有错误的拓扑结构（它在矩形内并且不会“环绕”），在这里它可以帮助将所有点从 (0,0)-(x, y) 复制到邻居高于 (0, -y * 2)-(x, 0)、低于 (0, y)-(x, y * 2)、左侧 (-x, 0)-(0, y) 和右侧 (x, 0)-(x*2, y)。我希望你知道我的意思，随时问:)

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2009-06-19T12:11:18.143

[CGAL](http://www.cgal.org)正在研究“球形内核”包，它可以精确地计算这些东西。不幸的是，**还没有发布**，但可能会在他们的下一个版本中，因为他们已经[在三月份的谷歌技术演讲中提到了它](http://www.youtube.com/watch?v=3DLfkWWw_Tg#t=50m33s)

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2013-04-01T05:35:30.920

引用此参考：[http ://www.qhull.org/html/qdelaun.htm](http://www.qhull.org/html/qdelaun.htm)

> 要计算球体上点的 Delaunay 三角剖分，请计算它们的凸包。如果球体是原点的单位球体，则面法线是输入的 Voronoi 顶点。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2011-04-15T18:28:44.423

如果您的点在一个半球内，您可以从球面坐标到平面坐标进行晷投影，然后进行三角测量，因为大圆变成最短距离的直线。

# .net - ASP.NET MVC 性能突然变得很慢

> ID：545876
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-02-13T13:14:59.777
> 
>         
> 
> 标签：.net, asp.net-mvc, performance, windows-vista, s#arp-architecture

我正在使用 Billy McCafferty 相当出色的[S#arp Architecture](http://code.google.com/p/sharp-architecture/)。一切都在快速运转。

然后我更新到最新的 ASP.NET MVC RC。这意味着我必须获得最新的 S#arp 主干。

另外，两周前，我从 XP 更新到 Vista（32 位）

我的问题是性能突然变得很糟糕。

一切似乎都有效，但它变得非常缓慢。每个 http 请求需要 1 秒。是的，一公制秒 - 你可以想象页面加载就像网络服务器正在由一个巨大的，匆忙构建的鼠标滚轮中的关节炎驴提供动力。

页面上的每个脚本或图像都会增加一秒的加载时间。

*   我没有打开 log4net，所以我不认为是这样。

*   这是在主页上运行的，因此只有非常少的数据库内容（无论如何都非常快）

*   这也发生在简单的图像上，所以我认为它必须是路由或网络服务器级别的东西。

任何想法它可能是什么？

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2009-02-13T14:01:43.800

这只是一个猜测，但我已经看到启用 IPv6 的速度很慢，尤其是在 localhost 上使用 Firefox 时。

[http://weblogs.asp.net/dwahlin/archive/2007/06/17/fixing-firefox-slowness-with-localhost-on-vista.aspx](http://weblogs.asp.net/dwahlin/archive/2007/06/17/fixing-firefox-slowness-with-localhost-on-vista.aspx)

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-02-13T13:19:06.380

您可以下载 dotTrace 并配置您的网站。

几周前我遇到了类似的问题，这个应用程序让我可以在几分钟内找到问题的根源。

下载试用版并试一试。

[http://www.jetbrains.com/profiler/](http://www.jetbrains.com/profiler/)

强烈推荐！

忍者戴夫

# .net - 您遇到的最令人印象深刻的 LINQ 语句是什么？

> ID：545885
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-02-13T13:17:45.260
> 
>         
> 
> 标签：.net, linq

[我最近在 LINQ 中](http://blogs.msdn.com/lukeh/archive/2007/10/01/taking-linq-to-objects-to-extremes-a-fully-linqified-raytracer.aspx)遇到了这个光线追踪器。只是想知道是否有人可以做到这一点？

```
var pixelsQuery =
from y in Enumerable.Range(0, screenHeight)
let recenterY = -(y - (screenHeight / 2.0)) / (2.0 * screenHeight)
select from x in Enumerable.Range(0, screenWidth)
       let recenterX = (x - (screenWidth / 2.0)) / (2.0 * screenWidth)
       let point = Vector.Norm(Vector.Plus(scene.Camera.Forward, 
                                           Vector.Plus(Vector.Times(recenterX, scene.Camera.Right),
                                                       Vector.Times(recenterY, scene.Camera.Up))))
       let ray = new Ray { Start = scene.Camera.Pos, Dir = point }
       let computeTraceRay = (Func<Func<TraceRayArgs, Color>, Func<TraceRayArgs, Color>>)
        (f => traceRayArgs =>
         (from isect in
              from thing in traceRayArgs.Scene.Things
              select thing.Intersect(traceRayArgs.Ray)
          where isect != null
          orderby isect.Dist
          let d = isect.Ray.Dir
          let pos = Vector.Plus(Vector.Times(isect.Dist, isect.Ray.Dir), isect.Ray.Start)
          let normal = isect.Thing.Normal(pos)
          let reflectDir = Vector.Minus(d, Vector.Times(2 * Vector.Dot(normal, d), normal))
          let naturalColors = 
              from light in traceRayArgs.Scene.Lights
              let ldis = Vector.Minus(light.Pos, pos)
              let livec = Vector.Norm(ldis)
              let testRay = new Ray { Start = pos, Dir = livec }
              let testIsects = from inter in
                                   from thing in traceRayArgs.Scene.Things
                                   select thing.Intersect(testRay)
                               where inter != null
                               orderby inter.Dist
                               select inter
              let testIsect = testIsects.FirstOrDefault()
              let neatIsect = testIsect == null ? 0 : testIsect.Dist
              let isInShadow = !((neatIsect > Vector.Mag(ldis)) || (neatIsect == 0))
              where !isInShadow
              let illum = Vector.Dot(livec, normal)
              let lcolor = illum > 0 ? Color.Times(illum, light.Color) : Color.Make(0, 0, 0)
              let specular = Vector.Dot(livec, Vector.Norm(reflectDir))
              let scolor = specular > 0 
                           ? Color.Times(Math.Pow(specular, isect.Thing.Surface.Roughness), light.Color) 
                           : Color.Make(0, 0, 0)
              select Color.Plus(Color.Times(isect.Thing.Surface.Diffuse(pos), lcolor),
                                Color.Times(isect.Thing.Surface.Specular(pos), scolor))
          let reflectPos = Vector.Plus(pos, Vector.Times(.001, reflectDir))
          let reflectColor = 
              traceRayArgs.Depth >= MaxDepth
              ? Color.Make(.5, .5, .5)
              : Color.Times(isect.Thing.Surface.Reflect(reflectPos), 
                            f(new TraceRayArgs(new Ray { Start = reflectPos, Dir = reflectDir }, 
                                               traceRayArgs.Scene, 
                                               traceRayArgs.Depth + 1)))
          select naturalColors.Aggregate(reflectColor, (color, natColor) => Color.Plus(color, natColor)))
                              .DefaultIfEmpty(Color.Background).First())
       let traceRay = Y(computeTraceRay)
       select new { X = x, Y = y, Color = traceRay(new TraceRayArgs(ray, scene, 0)) };

foreach (var row in pixelsQuery)
    foreach (var pixel in row)
        setPixel(pixel.X, pixel.Y, pixel.Color.ToDrawingColor()); 
```

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-02-13T13:24:52.593

我怀疑光线追踪器是否有任何东西可以超越。不过，我非常喜欢[我的 Mandelbrot 表达方式](http://msmvps.com/blogs/jon_skeet/archive/2008/02/26/visualising-the-mandelbrot-set-with-linq-yet-again.aspx)：

```
from row in Enumerable.Range(0, ImageHeight)
from col in Enumerable.Range(0, ImageWidth)
// Work out the initial complex value from the row and column
let c = new Complex((col * SampleWidth) / ImageWidth + OffsetX,
                    (row * SampleHeight) / ImageHeight + OffsetY)
// Work out the number of iterations
select Generate(c, x => x * x + c).TakeWhile(x => x.SquareLength < 4)
                                  .Take(MaxIterations)
                                  .Count() into count
// Map that to an appropriate byte value
select (byte)(count == MaxIterations ? 0 : (count % 255) + 1); 
```

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-02-13T13:42:13.597

[Mads Torgersen 演示](http://blogs.msdn.com/madst/archive/2007/05/11/recursive-lambda-expressions.aspx)了如何在 LINQ 中编写一个自包含的递归 lambda 表达式来计算（例如）阶乘：

```
i => new Func<Func<int,int>,Func<int,int>>(fac => x => x == 0 ? 1 : x * fac(x
- 1))(new SelfApplicable<Func<Func<Func<int,int>,Func<int,int>>,Func<int,int>
>>(y => f => x => f(y(y)(f))(x))(y => f => x => f(y(y)(f))(x))(fac => x => x
== 0 ? 1 : x * fac(x - 1)))(i) 
```

麦斯笔记：

> 我什至不知道如何换行以使其接近可读，所以我没有。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T13:31:59.300

说我疯了，但我是可读性的忠实拥护者——所以我倾向于只拥有一系列看起来很独立的表达，然后我将它们组合起来。当然，这取决于您如何定义 LINQ：如果您指的是 C# 中的查询语法，那么我不会过分……但如果您指的是元编程（即*创建*LINQ 表达式的 C# 代码），我有几个很好的例子：

*   [使用 DbLinq 进行](http://groups.google.com/group/microsoft.public.dotnet.languages.csharp/msg/d8d38ce6b9b15489)一些对象构造怎么样

*   我有我为[Finguistics](http://marcgravell.blogspot.com/)编写的（LINQ）基于表达式的数学解释器/编译器在某处踢...

*   我为 MiscUtil 编写的[通用运算符](http://www.yoda.arachsys.com/csharp/miscutil/usage/genericoperators.html)代码都是基于表达式的

*   各种对象复制示例（[像这样](http://groups.google.com/group/microsoft.public.dotnet.languages.csharp/msg/0edae91abc1c0f1a)）

*   [复杂的 OrderBy 构造](http://groups.google.com/group/microsoft.public.dotnet.languages.csharp/msg/7d931ec0e2356d21)

# sql - 在 select 语句中更新表

> ID：545904
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-02-13T13:21:59.777
> 
>         
> 
> 标签：sql, mysql

有什么方法可以更新 mysql 选择查询的 select_expr 部分中的表。这是我要实现的目标的示例：

```
SELECT id, name, (UPDATE tbl2 SET currname = tbl.name WHERE tbl2.id = tbl.id) FROM tbl; 
```

这给了我一个mysql错误，但我不明白为什么只要我不改变tbl就不可能。

编辑：我将澄清为什么我不能为此使用普通的构造。

这是我正在处理的问题的更复杂示例：

```
SELECT id, (SELECT @var = col1 FROM tbl2), @var := @var+1, 
(UPDATE tbl2 SET col1 = @var) FROM tbl WHERE ... 
```

因此，我基本上处于这样一种情况，即我在 select 语句期间递增一个变量，并希望在我选择行时反映这种变化，因为我在执行期间使用这个变量的值。此处给出的示例可能可以通过其他方式实现，但是由于不必要的代码太多，我不会在此处发布的真实示例需要此功能。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-02-13T13:31:34.650

如果您的目标是每次查询 tbl1 时更新 tbl2，那么最好的方法是创建一个存储过程来执行此操作并将其包装在事务中，如果需要原子性，可能会更改隔离级别。

您不能在选择中嵌套更新。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T13:24:40.987

你想要什么结果？选择或更新的结果。

如果要根据查询结果进行更新，可以这样做：

```
update table1 set value1 = x.value1 from (select value1, id from table2 where value1 = something)  as x where id = x.id 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2016-08-03T12:21:42.387

开始交易；

-- 获取当前值

从计数器中选择值，其中 id = 1 FOR UPDATE；

-- 增加计数器

更新计数器 SET value = value + 1 WHERE id = 1;

犯罪;

# c++ - 使用 cin 在 C++ 中进行输入验证的最佳方法是什么？

> ID：545907
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-02-13T13:23:21.677
> 
>         
> 
> 标签：c++, coding-style, validation

我的兄弟最近开始学习 C++。他告诉我他在尝试验证一个简单程序中的输入时遇到的一个问题。他有一个文本菜单，用户在其中输入了一个整数`choice`，如果他们输入了一个无效的选择，他们将被要求再次输入（执行 while 循环）。但是，如果用户输入的是字符串而不是 int，则代码会中断。我阅读了有关 stackoverflow 的各种问题，并告诉他按照以下方式重写他的代码：  

```
#include<iostream>
using namespace std;

int main()
{
    int a;
    do
    {
    cout<<"\nEnter a number:"
    cin>>a;
        if(cin.fail())
        {
            //Clear the fail state.
            cin.clear();
            //Ignore the rest of the wrong user input, till the end of the line.
            cin.ignore(std::numeric_limits<std::streamsize>::max(),\
                                                    '\n');
        }
    }while(true);
    return 0;
} 
```

虽然这行得通，但我也尝试了其他一些想法：

1\. 使用 try catch 块。它没有用。我认为这是因为输入错误没有引发异常。2\. 我试过`if(! cin){//Do Something}`了，也没有用。这个我还没想清楚。

3\. 第三，我尝试输入一个固定长度的字符串，然后解析它。我会使用 atoi()。该标准是否兼容且可移植？我应该编写自己的解析函数吗？

4、如果写一个使用cin的类，但是动态地做这种错误检测，或许是通过在运行时判断输入变量的类型，会不会有太多的开销？甚至可能吗？

我想知道进行这种检查的最佳方法是什么，最佳做法是什么？

我想补充一点，虽然我对编写 C++ 代码并不陌生，但我对编写符合标准的良好代码并不陌生。我正在努力摆脱不良做法并学习正确的做法。如果回答者给出详细解释，我将非常感激。

**编辑**：我看到 litb 已经回答了我以前的编辑之一。我将在此处发布该代码以供参考。

```
#include<iostream>
using namespace std;

int main()
{
    int a;
    bool inputCompletionFlag = true;
    do
    {
    cout<<"\nEnter a number:"
    cin>>a;
        if(cin.fail())
        {
            //Clear the fail state.
            cin.clear();
            //Ignore the rest of the wrong user input, till the end of the line.
            cin.ignore(std::numeric_limits<std::streamsize>::max(),\
                                                    '\n');
        }
        else
        {
            inputCompletionFlag = false;
        }
    }while(!inputCompletionFlag);
    return 0;
} 
```

此代码在“1asdsdf”之类的输入上失败。我不知道如何解决它，但 litb 发布了一个很好的答案。:)

* * *

## 回答 #1

> 赞同：19
> 
>             
> 
> 时间：2009-02-13T15:57:46.470

这是您可以用来确保您也拒绝诸如此类的代码的代码

```
42crap 
```

数字后跟非数字字符的地方。如果您阅读整行，然后对其进行解析并适当地执行操作，则可能需要您更改程序的工作方式。如果您的程序到目前为止从不同的地方读取您的号码，那么您必须放置一个中央位置来解析一行输入并决定操作。但也许这也是一件好事 - 所以你可以通过将事物分开来增加代码的可读性**：****输入**-处理-**输出**

无论如何，这里是你如何拒绝上面的数字-非数字。将一行读入字符串，然后用 a 解析它`stringstream`：

```
std::string getline() {
  std::string str;
  std::getline(std::cin, str);
  return str;
}

int choice;
std::istringstream iss(getline());
iss >> choice >> std::ws;
if(iss.fail() || !iss.eof()) {
  // handle failure
} 
```

它吃掉所有尾随空格。当它在读取整数或尾随空格时遇到字符串流的文件结尾时，它会设置 eof 位，我们会检查它。如果它首先未能读取任何整数，则将设置失败或错误位。

此答案的早期版本`std::cin`直接使用 - 但`std::ws`不能很好地与`std::cin`连接到终端一起使用（它将阻止而不是等待用户输入某些内容），因此我们使用 a`stringstream`来读取整数。

* * *

回答你的一些问题：

**问题：**   1\. 使用 try catch 块。它没有用。我认为这是因为输入错误没有引发异常。

***回答：***嗯，您可以告诉流在读取某些内容时抛出异常。您使用该`istream::exceptions`函数，告诉您希望抛出异常的错误类型：

```
iss.exceptions(ios_base::failbit); 
```

我从来没有使用过它。如果您在 上执行此操作`std::cin`，您将必须记住为其他依赖它而不抛出的读者恢复标志。*发现使用函数失败*更容易，询问流的状态是*不好的。*

**问题：** 2\. 我试过`if(!cin){ //Do Something }`了，也不管用。这个我还没想清楚。

***答：***这可能是因为你给了它“42crap”之类的东西。对于流，在提取整数时这是完全有效的输入。

**问题：** 3\. 第三，我尝试输入一个固定长度的字符串，然后解析它。我会使用 atoi()。该标准是否兼容且可移植？我应该编写自己的解析函数吗？

***答：*** atoi 符合标准。但是当您想检查错误时，这并不好。与其他功能相比，它没有错误检查。如果你有一个字符串并且想检查它是否包含一个数字，然后像上面的初始代码那样做。

有一些类似 C 的函数可以直接从 C 字符串中读取。它们的存在是为了允许与旧的遗留代码交互并编写快速执行的代码。人们应该在程序中避免使用它们，因为它们的工作级别相当低，并且需要使用原始裸指针。就其本质而言，它们也无法增强以使用用户定义的类型。具体来说，这讨论了函数“strtol”（string-to-long），它基本上是 atoi，具有错误检查和与其他基础（例如十六进制）一起使用的能力。

**问题：**   4\. 如果我写了一个使用cin的类，但是动态地做这种错误检测，也许是通过在运行时确定输入变量的类型，会不会有太多的开销？甚至可能吗？

***答：***一般来说，你不需要太在意这里的开销（如果你指的是运行时开销）。但这具体取决于您在哪里使用该类。如果您正在编写一个处理输入并需要高吞吐量的高性能系统，那么这个问题将非常重要。但是，如果您需要从终端或文件读取输入，您已经看到这归结为：等待用户输入内容需要很长时间，此时您无需再关注运行时成本规模。

如果您的意思是代码开销 - 这取决于代码的实现方式。您需要扫描您读取的字符串 - 它是否包含数字，是否包含任意字符串。根据您要扫描的内容（也许您也有“日期”输入或“时间”输入格式。请查看`boost.date_time`），您的代码可能会变得任意复杂。对于简单的事情，比如在数字之间进行分类，我认为你可以使用少量代码。

* * *

## 回答 #2

> 赞同：12
> 
>             
> 
> 时间：2009-02-13T13:29:14.050

这就是我对 C 所做的，但它可能也适用于 C++。

**将所有内容作为字符串输入。**

然后，并且只有在那时，才将字符串解析为您需要的内容。有时编写自己的代码比试图让别人的代码服从你的意愿要好。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-02-13T13:31:25.243

*   为了[使用 iostreams 获取异常，](http://www.cplusplus.com/reference/iostream/ios/exceptions.html)您需要为流设置正确的异常标志。

*   我会使用*get_line*获取整行输入，然后相应地处理它 - 使用 lexical_cast、正则表达式（例如[Boost Regex](http://www.boost.org/doc/libs/1_38_0/libs/regex/doc/html/boost_regex/introduction_and_overview.html)或[Boost Xpressive ，用](http://www.boost.org/doc/libs/1_38_0/doc/html/xpressive/user_s_guide.html)[Boost Spirit](http://www.boost.org/doc/libs/1_38_0/libs/spirit/classic/index.html)解析它，或者只使用某种适当的逻辑

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T13:28:32.943

我要做的是双重的：首先，如果输入不是微不足道的，则尝试使用正则表达式验证输入并提取数据。即使输入只是一系列数字，它也很有帮助。

然后，我喜欢使用[boost::lexical_ cast](http://www.boost.org/doc/libs/1_38_0/libs/conversion/lexical_cast.htm)，如果输入无法转换，它会引发 bad_ lexical_ cast 异常。

在您的示例中：

```
std::string in_str;
cin >> in_str;

// optionally, test if it conforms to a regular expression, in case the input is complex

// Convert to int? this will throw bad_lexical_cast if cannot be converted.
int my_int = boost::lexical_cast<int>(in_str); 
```

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T13:30:22.063

忘记在实际代码中直接使用格式化输入（>> 运算符）。您将始终需要使用 std::getline 或类似方法读取原始文本，然后使用您自己的输入解析例程（可能使用 >> 运算符）来解析输入。

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T14:58:39.450

各种方法的组合怎么样：

1.  `std::cin`使用`std::getline(std::cin, strObj)`where `strObj`is a `std::string`object获取输入。

2.  用于`boost::lexical_cast`执行从`strObj`最大宽度的有符号或无符号整数的词法转换（例如，`unsigned long long`或类似的东西）

3.  用于`boost::numeric_cast`将整数向下转换为预期范围。

您可以只获取输入，`std::getline`然后`boost::lexical_cast`根据您想要捕获错误的位置调用适当的窄整数类型。三步法的好处是接受任何整数数据，然后分别捕获缩小错误。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T15:28:28.037

我同意 Pax，最简单的方法是将所有内容读取为字符串，然后使用 TryParse 验证输入。如果格式正确，则继续，否则只需通知用户并在循环中使用 continue。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T17:03:54.500

还没有提到的一件事是，在使用应该从流中获取某些内容的变量之前，测试以查看 cin >> 操作是否有效通常很重要。

此示例与您的示例相似，但进行了该测试。

```
#include <iostream>
#include <limits>
using namespace std;
int main()
{
   while (true)
   {
      cout << "Enter a number: " << flush;
      int n;
      if (cin >> n)
      {
         // do something with n
         cout << "Got " << n << endl;
      }
      else
      {
         cout << "Error! Ignoring..." << endl;
         cin.clear();
         cin.ignore(numeric_limits<streamsize>::max(), '\n');
      }
   }
   return 0;
} 
```

这将使用通常的运算符 >> 语义；它会先跳过空格，然后尝试读取尽可能多的数字，然后停止。所以“42crap”会给你 42 然后跳过“废话”。如果这不是您想要的，那么我同意前面的答案，您应该将其读入字符串然后验证它（也许使用正则表达式 - 但对于简单的数字序列来说这可能是矫枉过正）。

# c# - 我应该使用什么模型/模式来处理多个数据源？

> ID：545935
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-13T13:34:26.517
> 
>         
> 
> 标签：c#, asp.net, sql

作为电子商务系统的一部分，我需要设计和实现某种黑盒。这需要接受来自各种内部和外部数据源（即网站、外联网、雅虎商店、亚马逊 xml 提要等）的客户和订单，并插入/更新后端系统。用于插入/更新客户和订单数据的 api 已为网站准备就绪并且运行良好。现在我们需要添加处理来自其他数据源的订单的能力。

我一直倾向于提供者模型（每个数据源一个提供者），并在调用 api 实际添加客户和下订单之前使用它将数据标准化到 sql server 表中。我应该考虑其他模型或模式吗？你以前处理过这个问题吗？你是如何解决的？有没有我应该看的资源（文章、书籍、项目等）？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T13:49:17.120

您可能会发现 ETL（Extract-Transform-Load）工具比尝试在代码中解决问题更容易：

*   [SSIS](http://msdn.microsoft.com/en-us/library/ms141026.aspx)（SQL 服务器集成服务）

*   [ODI](http://www.oracle.com/webapps/dialogue/dlgpage.jsp?p_ext=Y&p_dlg_id=6853205&src=6652651&Act=5&sckw=NAMK08051462MPP001.GCM.8316.100)（甲骨文数据集成器）

*   [Informatica PowerCenter](http://vip.informatica.com/?elqPURLPage=1032&gclid=CIzH8oXR2ZgCFQG7GgodwX8tcw)

*   [好多其它的](http://www.google.com/search?hl=en&q=etl+tools&btnG=Search)

这些是专门为您描述的数据加载工作类型而设计的。

**编辑**

虽然我仍然认为 ETL 工具将最好地满足您的需求，但如果您坚持在代码中执行它，您应该考虑将 ETL 实现为一种模式。这样做的原因是，ETL 是从各种来源加载数据的成熟最佳实践。您应该花一些时间来研究 ETL 是如何实现的。

在基本级别上，您应该具有三个层，一个提取层、一个转换层和一个加载层。

**提取**层应负责从源中检索数据。它不应该担心此时数据的形状。为了保持层干净，你应该只实现在这里“获取”数据的代码。担心在转换层对其进行整形。

**转换**层应该负责从各种来源提取数据并将其转换为目标的形状。ETL 工具通过将数据视为管道来非常有效地做到这一点。这些可以拆分和并行化。您可能没有时间或资源来执行此操作。另一种方法可能是将数据加载到临时表（数据的标准化程度较低的表示）中。

**加载**层获取转换后的数据（在上述情况下来自临时表）并将它们加载到最终目标位置。

这充分分离了您的层，以便您可以保护自己免受未来变化的影响。但是请记住，您实际上只是在做 ETL 工具开箱即用的工作。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T16:19:28.133

如前所述，ETL 可能是要走的路，除非您可以标准化订单在前面的方式，如 EDI 或 Web 服务。

使用 ETL 工具将源（电子邮件、FTP 文件等）转换为 SQL Server 中的公共管道，然后有一个单独的进程来处理管道中的待处理批次。

# comments - 代码中的更多注释或只是简单、可读、可维护的代码就足够了？

> ID：545936
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2009-02-13T13:34:34.597
> 
>         
> 
> 标签：comments

有时真的很难决定你什么时候写了足够多的评论让别人理解你的意图。

我认为人们需要更多地专注于编写可读、易于理解的代码，而不是包含大量注释来解释发生的每一个细节。

您对此有何看法？

* * *

## 回答 #1

> 赞同：30
> 
>             
> 
> 时间：2009-02-13T13:37:51.720

没有评论来解释你在做什么。他们在那里解释你为什么这样做。

* * *

## 回答 #2

> 赞同：12
> 
>             
> 
> 时间：2009-02-13T13:51:35.413

这个论点是基于一个错误的困境：要么你的代码是一个可怕的可憎之物，你写了大量的注释来解释每一个语句和表达式，或者你的代码是美丽的诗歌，你的祖母可以理解，根本不需要文档。

实际上，您应该争取后者（好吧，也许不是您的祖母，而是其他开发人员），但要意识到有时几条注释会消除歧义或使接下来的十行代码更加简单。根本不主张*评论的*人是极端分子。

当然，应避免无端评论。再多的评论都不会帮助糟糕的代码更容易理解。他们可能只会让情况变得更糟。但是，除非您只是在编写琐碎的系统，否则有时评论会澄清正在做出的设计决策。

这在捕获错误时会很有帮助。有文化的代码看起来完全合法，但完全错误。没有评论，其他人（或六个月后的你）不得不猜测你的意图：你是故意这样做的，还是意外？这是错误，还是其他地方？也许我应该参考设计文档...评论是内联文档，在您需要的地方可见。  

正确决定何时真正需要评论是关键。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2009-02-13T13:41:50.383

尝试使代码自我解释。最重要的事情之一是为类、函数、变量等使用有意义的名称。

评论不能自我解释的部分。琐碎的注释（例如 i++; // 将 1 添加到 i）使代码更难阅读。

顺便说一句 - 您可以工作的伪代码越接近，您的代码就越容易自我解释。这是高级语言的特权；很难编写自解释的汇编代码。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T13:56:29.490

并非所有代码都是自记录的。

我现在正在解决性能问题。开发者以为他发现了瓶颈的根源；由于某种原因要休眠的代码块。没有关于这段代码的评论，也没有关于它**为什么**存在的上下文。我们删除了块并重新测试。现在，该应用程序在以前没有的负载下失败了。

我的猜测是有人以前遇到过性能问题并放入此代码以缓解问题。这是否是正确的解决方案是一回事，但一些关于**为什么**有这段代码的评论现在将为我们节省一个痛苦的世界和大量的时间......

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T14:55:36.523

Aim for code that needs no comments, but don't beat yourself up too much if you miss.

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T13:54:06.283

为什么需要评论。方法的名称应该足够清楚，您不需要注释。  

前任：

```
//  This method is used to retrieve information about contact
public getContact()
{
} 
```

在这种情况下 getContact 不需要评论

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T16:08:36.567

基本上，在类/方法/函数声明的开头放置一个好的但可能是简短的注释，并且 - 如果有必要 - 在文件开头的介绍性注释，当一个不那么常见或不那么清楚透明的操作被编码。

因此，例如，您应该避免评论明显的内容（i++; 在前面的示例中），但是您所知道的不太明显和/或更棘手的内容应该得到一些清晰、不令人困惑、出色、完整的评论，这自然会出现历史上最清晰的代码获得诺贝尔奖；）。

并且不要低估评论也应该很有趣的事实；如果你能在智力上取笑他们，程序员会更乐意阅读。

因此，作为一般原则，评论往往不会被压倒，但是当你必须写一个时，请确保它是你能写下的最清晰的评论。

就我个人而言，我不是自我记录代码的忠实粉丝（又名代码 w/oa 一个该死的斜线星）：几个月后你已经写了它（这只是我个人规模的几天）很可能你无法告诉选择这样的设计来代表你的智慧的真正原因，那么其他人怎么可能呢？

注释不仅仅是代码行中的绿色东西；它们是您的大脑更愿意编译的代码部分。有资格成为大脑代码（笑）我不能肯定评论不是你正在编写的程序的一部分。它们只是不针对 CPU 的部分。  

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T13:39:20.483

我认为足够的评论以便在以后必须审查代码时能够理解它就足够了。

我认为如果您为每个人发表评论会浪费很多时间；走这条路可能会让你的代码更难理解。

我同意编写可读代码可能是最重要的部分，但不要遗漏注释。多花点时间。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T13:40:39.777

可读代码应该是第一优先级。正如 Paul Tomblin 已经写过的那样，评论的重点是为什么部分。

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T13:46:16.847

我尽量避免评论。代码应该是不言自明的。正确命名变量和方法。打破具有好名字的方法中的大代码块。编写做一件事的方法，也就是你为它们命名的那件事。

如果你需要写评论。让它简短。我经常有这样的感觉，如果你需要详细说明为什么这个代码块会这样做，那么你已经对设计有问题了。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T14:01:43.503

仅在添加内容时发表评论。

像这样的东西是无用的，并且肯定会**降低**可读性：

```
/// <summary>Handles the "event" event</summary>
/// <param name="sender">Event sender</param>
/// <param name="e">Event arguments</param>
protected void Event_Handler (object sender, EventArgs e)
{
} 
```

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T21:25:14.887

通常，我喜欢清楚地说明您正在编写的代码的意图的文档注释。NDoc 和 Sandcastle 等漂亮的工具提供了一种很好的、​​一致的方式来编写该文档。

然而，这些年来我注意到了一些事情。

*   大多数文档注释并没有真正告诉我任何我无法从代码中真正收集到的东西。当然，这假设我可以从源代码中找出正面或反面。

*   注释应该用于记录*意图*，而不是行为。不幸的是，在绝大多数情况下，这不是它们的使用方式。NDoc 和 Sandcastle 之类的工具只会通过提供过多的标签来传播注释的错误使用，这些标签鼓励您提供注释，告诉读者他应该能够从代码本身中辨别出的事情。

*   随着时间的推移，注释往往会与代码不同步。无论我们是否使用文档软件，这往往都是正确的，它声称使文档更容易，因为它使文档更接近它所描述的代码。即使文档就*在方法、属性、事件、类或其他类型旁边，*开发人员仍然很难记住在内在行为发生变化时更新它。因此，文档失去了它的价值。

值得注意的是，这些问题基本上是由于评论的滥用造成的。如果仅将评论用作传达意图的一种方式，那么这些问题就会像渡渡鸟一样，因为任何给定类型或其成员的意图都不太可能随着时间而改变。（如果是这样，更好的计划是编写一个新成员并通过引用新成员来弃用旧成员。）

如果使用得当，评论会产生巨大的价值。但这意味着知道它们最适合用于什么，并将它们的使用限制在该范围内。如果你不这样做，你最终会得到大量不正确、误导性的评论，并且是忙碌工作的来源（成本增加），因为你现在必须删除它们或以某种方式纠正它们。

制定一种以有意义的方式使用评论的策略，以防止它们成为时间、精力和金钱的沉没，这是值得的。

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T21:53:54.303

研究表明，当您对 10 行代码有大约 1 行注释时，就会出现最佳可读性。当然，这并不是说你需要将你的口粮保持在 1/10，如果你超过了就会恐慌。但这是让您了解应该发表多少评论的好方法。

还要记住，注释是一种代码味道。也就是说，它们可能表示代码错误，但不一定如此。原因是越难理解的代码注释越多。

# .net - 在为规则引擎创建 DSL 时使用什么技术？

> ID：545937
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-02-13T13:34:36.517
> 
>         
> 
> 标签：.net, f#, dsl, rules, boo

[您会推荐什么技术来为 .NET 的业务规则和验证应用程序块](http://abdullin.com/journal/2008/11/23/net-application-block-for-validation-and-business-rules.html)创建 DSL ？为什么？

框架的架构由产品建立和验证测试。我只想创建一个 .NET 处理器来将人类可读的规则转换为已编译的规则实现。

我知道的选项是：

*   使用[.NET Boo的编译器管道](http://boo.codehaus.org/) 

*   使用 F# 附带的解析器构建器 - [FsLex 和 FsYacc](http://stepheneasey.wordpress.com/2009/02/11/fslex-and-fsyacc-tutorial-parsing-sql/)

不幸的是，考虑到 DSL 语法（它会不断发展），这些方法都没有提供任何东西来构建或多或少友好的 IDE 来编辑 DSL。

有什么想法或提示吗？

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-02-13T14:49:19.410

另一个可能有趣的替代方法是使用 F# 引号。

引用允许您将程序的一部分视为数据，因此您可以获取 AST，对其进行分析并将其翻译成其他语言或以某种非标准方式执行它。再加上 F# 的灵活性，您应该能够表达很多东西，因此您必须开发一个内部 F# DSL/组合器库来描述规则，并开发一个 F# 引用的翻译器/解释器来运行它们。

不确定商务规则的外观，但您可以编写如下内容：

```
let rule = <@
  if (exists customer having validEmail) then success
  else require whatever 
@> 
```

我在我的博客上写了一篇关于这个主题的介绍。不幸的是，F# CTP 发生了一些重大变化，我还没有更新源代码，但它应该能让您很好地了解这种方法的可能性和局限性。

*   [CodePlex 上的 F# 引用示例](http://tomasp.net/blog/fsharp-quotation-samples.aspx)- TomasP.Net

DSL 的一个很好的例子是 F# 单元测试框架：

*   [宣布 FsTest - F# 的测试 DSL](http://weblogs.asp.net/podwysocki/archive/2008/06/19/announcing-fstest-a-testing-dsl-for-f.aspx) - Matthew Podwysocki

*[编辑]*
只是为了澄清为什么我认为这可能是一个好方法：

*   如果您使用 Visual Studio 编辑 DSL（并且您可以使用免费安装 F# 的 Shell 版本），您将免费获得非常好的编辑体验。不仅是语法高亮，还有 IntelliSense，它会建议可能的结构，还有一个背景类型检查，作为你的 DSL 的“语法”检查器。

*   与其他方法相比，这可能是最容易实现的方法之一。

*   唯一的限制是您受 F# 语法的限制。但是，设计自己的语言确实很困难，所以这可能一点也不坏。尤其是考虑到 F# 的灵活性。

*[/编辑]*

希望这可以帮助！

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2009-02-16T23:42:58.843

微软下一代应用开发平台，代号[Oslo（现 Delve）](https://www.microsoft.com/en-us/microsoft-365/blog/2014/03/11/introducing-codename-oslo-and-the-office-graph/)

> 使人们更容易以对他们所从事的问题领域有意义的方式写下来

Oslo 似乎由一个名为“Quadrant”的可视化设计工具、一种名为“M”的建模语言和存储规则的“Oslo”存储库（一个 SQL Server 数据库）组成。

因此，如果我没看错的话，您可以在 M 中定义一种建模语言，使用 Quadrant 使用您自己的建模语言定义和编辑您的验证规则，并编写一个使用 Oslo 存储库的应用程序，生成您的业务规则和验证应用程序.NET 的块。

* * *

## 回答 #3

> 赞同：7
> 
>             
> 
> 时间：2009-02-13T14:03:42.593

业务规则的图形语言不是一个好主意。我会避免它 业务规则中有很多 if 检查和循环，它们不能很好地可视化。

使用文本语言来描述业务规则会好得多。

要获得编辑代码的非凡用户体验，您需要：

1.  具有良好错误恢复能力的解析器

2.  进行增量重新编译的能力

良好的错误恢复允许您从语法不完整的结构中有效地确定程序员的意图。这对于实现智能至关重要。

进行增量重新编译的能力使您能够进行有效的后台编译以响应用户编辑。

获得良好错误恢复的最简单方法是手动编写解析器。这样，您可以使用任意数量的前瞻或算法规则来确定在出现语法错误时该怎么做。

当您使用解析器生成器创建解析器时，您在处理语法错误方面失去了很多灵活性。这种灵活性决定了良好的智能体验和糟糕的智能体验。因此，我建议您使用递归下降手工编写它。

实现有效的重新编译要求您能够： 1) 正确地将语义分析分解为多个阶段（对于 C# 之类的东西，这将是：首先构造名称空间和类型符号，然后解析 using 语句，然后解析基类等）。2）构建相位感知依赖图的能力 3）处理依赖图的算法，并根据用户编辑使其部分无效

对于成熟的编程语言，实现重新编译可能会变得非常棘手。在您的情况下，因为您正在描述业务规则，所以它可能对您来说更简单（或者如果编译速度足够快，您甚至可能不需要它）。

所以，我会从解析器开始，然后在它之上构建智能。

如果您可以避免VS集成，我会的。集成到 VS 需要大量的管道，并且互操作可能会引起头痛。有几家公司出售您连接解析器的 Windows 窗体编辑器控件。这比 VS 更容易集成。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T15:06:59.117

我会使用 Boo，我认为它是目前最灵活的 DSL 创建工具之一。关于这个主题有一[本非常好的书](http://www.manning.com/rahien/)。[Ayende](http://ayende.com/Blog/category/547.aspx)和[Rodrigo 的](http://blogs.codehaus.org/people/bamboo/)博客也是很好的灵感来源。

关于 IDE，你可以扩展[SharpDevelop](http://www.icsharpcode.net/OpenSource/SD/)，看看[这个](http://ayende.com/Blog/archive/2007/08/14/Rhino-ETL--IDE.aspx)。

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2009-02-16T16:02:26.857

将 DSL 的接缝构建为[ANTLR](http://www.antlr.org/)的标准工具- 它是一个强大的词法分析器/解析器生成器，具有许多用于编译器输出的目标语言。它具有 C#、Java、C/C++、Python 等的后端（请参阅[代码生成目标](http://www.antlr.org/wiki/display/ANTLR3/Code+Generation+Targets)列表），并允许您轻松地将自定义代码以目标语言注入编译器。

还有一个非常强大的 IDE (ANTLRWorks) 和大量文档。（查看来自 ANTLR 的作者 Terrence Parr 的[The Defenitive ANTLR Reference](http://www.pragprog.com/titles/tpantlr/the-definitive-antlr-reference)）关于还有谁使用它的参考，请参见[Testimonlals](http://www.antlr.org/testimonial/list)页面。

您仍然需要自己完成 IDE 的大部分工作，但考虑到您将从 ANTLR 获得的强大的编译器框架，这应该会容易得多。此处发布的大多数解决方案都应该是这种情况...

我目前正在使用用 ANTLR 编写的编译器将我们自己的 DSL 预处理为 C/C++ 输出，对此我感到非常满意。广告够了，你应该自己试试看：）玩得开心！

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2009-02-16T07:23:55.980

JetBrains[元编程系统](http://www.jetbrains.com/mps/index.html)

> 您可以为任何新语言定义自定义语言编辑器和其他约束，以便使用这些 DSL 变得非常简单。不熟悉传统编程的领域专家可以使用特定领域的术语轻松地使用他们的领域特定语言在 MPS 中工作。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-02-16T14:57:21.710

我是新手，但[OMeta](http://www.cs.ucla.edu/~awarth/ometa/)似乎是开发 DSL 的理想工具。周围似乎没有 IDE，但好消息是可以在 OMeta 中编写的“规则”非常易读。（它处理左递归，这非常酷。）

目前至少在 Javascript（对我来说非常令人兴奋）和 Python 中存在 OMeta 实现，也许还有其他实现。至于 C#，[Jeff Moser](http://www.moserware.com/2008/06/ometa-who-what-when-where-why.html)正在开发一个，您可以在[他的博客](http://www.moserware.com/2008/06/ometa-who-what-when-where-why.html)上阅读并在[CodePlex](http://www.codeplex.com/ometasharp)上查看。祝你好运。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2011-05-17T21:15:42.730

Boo + OMeta = Boo.OMeta.Parser

目前解析器正在开发中，但它已经可以用于创建复杂的外部 DSL。OMeta 是一个强大的工具，它使程序员能够轻松地实现词法分析器和解析器。Boo 的可扩展编译器管道架构允许用 Boo.OMeta.Parser 替换标准的 Boo.Parser。它可以用几乎任何一种语法来扩展 Boo 语法。该示例可以在[此处](http://rulezzz.org/post/2011/05/05/How-to-compile-Shakespeare.aspx)找到。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2011-12-14T14:19:40.060

我的项目[meta#](http://metasharp.codeplex.com)正在尝试解决这个问题。

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T13:41:16.953

如果您想创建一个编辑 DSL 的友好 IDE，使 IDE 完全图形化，并编译为 .NET 对象（或使用 IronPython 之类的东西作为胶水语言）。

如果规则足够简单，您可以以图形方式实现整个规则结构。如果规则足够复杂，“人类可读性”就成为一个不可能的目标。

无论哪种方式，如果创建中间代码的一组 .NET 类或 IronPython 对象不够“人类可读”，那么很可能，您需要比语法更防伪的东西。

也就是说，如果您只是想创建一种程序员可以用来创建业务规则的简单语言，请随意使用上述任何一种语言，并使语法足够简单，不需要 Visual Studio 的 IDE。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2009-02-22T14:32:34.047

Ruby 是一种用于创建 DSL 的出色语言。例如，[Rake](http://rake.rubyforge.org/)是一个用 Ruby 编写的构建脚本 DSL。

使用即将推出的[IronRuby](http://www.ironruby.net/)，可以编写直接调用 C# 代码的脚本。

[这是](http://jroller.com/rolsen/entry/building_a_dsl_in_ruby) [一些](http://jroller.com/rolsen/entry/building_a_dsl_in_ruby1) [关于](http://obiefernandez.com/presentations/obie_fernandez-agile_dsl_development_in_ruby.pdf)在 Ruby 中编写 DSL 的文章。

# oracle - 您如何为 Oracle 选择存储引擎？

> ID：545938
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-02-13T13:34:43.490
> 
>         
> 
> 标签：oracle, storage-engines

好的，这个问题显然是错误的，但我想知道如何在 Oracle 上选择存储实现，就像我在 MySQL 上一样，说我想要一个像 MyIsam 一样的表，另一个只用于存档，一个黑洞样式用于测试目的. 我将如何在单个模式中执行此操作，或者可以满足这些需求的类似方法？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-02-13T14:40:18.247

Oracle 没有像 Mysql 那样的存储引擎概念。它以自己的格式将所有表存储在数据文件中。您可以做的是使用不同的表空间并将它们存储在性能特征可能不同的不同磁盘上。

概念指南可以帮助您了解 Oracle 的工作原理。

[http://download.oracle.com/docs/cd/B19306_01/server.102/b14220/toc.htm](http://download.oracle.com/docs/cd/B19306_01/server.102/b14220/toc.htm)

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T13:41:40.180

您可以使用[`ORGANIZATION EXTERNAL`](http://download.oracle.com/docs/cd/B19306_01/server.102/b14215/et_concepts.htm)：

```
CREATE TABLE ORGANIZATION EXTERNAL 
```

并选择要使用的访问驱动程序。

就目前而言，`Oracle`必须`ORACLE_LOADER`访问`CSV`和喜欢文本表（只读），以及`ORACLE_DATAPUMP`读取和写入二进制数据（以自定义格式）。

# .net - 在使用 SetFirstResult 和 SetMaxResults 时，您是否知道在不使用 ResultTransformer 的情况下获得不同的结果集？

> ID：545940
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-02-13T13:35:14.690
> 
>         
> 
> 标签：.net, nhibernate, criteria, distinct

当我使用 SetFirstResult 和 SetMaxResult 并且查询已加入时，结果将具有重复的结果而不是唯一的。

然后我将所有类型的 Distinct 助手用于标准 api。但它不会过滤整个结果集，它只是过滤分页结果。

我该如何克服这个问题？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-02-13T14:21:59.583

我发现了一个[hacky 的东西来克服](http://opensource.atlassian.com/projects/hibernate/browse/HB-520)这个问题。

> 我能想出的唯一“解决方法”是从条件相同的条件对象发出两个查询。第一个获得 id，第二个被限制在 id 上。
> 
>   
>   
> 
> //根据需要设置条件，包括分页 myCriteria = doStuffToSetupCriteria(); myCriteria.setFirstResult((page-1)*itemsPerPage); myCriteria.setMaxResults(itemsPerPage);
> 
>   
>   
> 
> //获取主键列表 myCriteria.setProjection(Projections.distinct(Projections.property("myAllias.id")); List ids = gacc.list();
> 
>   
>   
> 
> //现在将 id 添加到限制 myCriteria.add(Restrictions.in("myAlias.id, ids));
> 
>   
>   
> 
> //清理上一个条件运行 gacc.setProjection(null); gacc.setFirstResult(0); gacc.setMaxResults(Integer.MAX_VALUE);
> 
>   
>   
> 
> //你的结果 List objects = gacc.list()
> 
>   
>   
> 
> 我同意有点 hacky，但鉴于这种限制，我能找到唯一可接受的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-07-16T20:08:11.580

我构建了一个类似的解决方案，但仅在一次 DB 之旅中：

DetachedCriteria subQuery = ...//-->添加您想要的所有标准，包括“SetFirstResult”和“SetMaxResults”

DetachedCriteria rootQuery = DetachedCriteria.For(); // 其中 T 是一个实体

subQuery.SetProjection(
     **Projections.Distinct(Projections.ProjectionList().Add(Projections.Alias(Projections.Property(“ID”),“ID”)))** 
                      );

// 注意：我的所有实体都继承自包含属性“ID”的基类 rootQuery.Add(Subqueries.PropertyIn("ID", subQuery));

// ...然后使用rootQuery获取T的列表，不会检索到重复的项目。

我希望有人觉得这个实现有帮助:)

罗曼

# .net - asp.net MVC - ValidationSummary 不显示

> ID：545941
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2009-02-13T13:36:03.737
> 
>         
> 
> 标签：.net, asp.net-mvc, validation

我有一个奇怪的问题，即没有显示 ValidationSummary。但是，正在显示 ValidationMessage。我已经检查了输出页面的源代码，但并不是它们的颜色会掩盖它们。我正在使用RC。有任何想法吗？

编辑：在 ValidationSummary 设置的断点显示：

```
ViewData.ModelState.Values[1].ErrorMessage = ""
ViewData.ModelState.Values[1].Exception.InnerException.Message = "4a is not a valid value for Int32" 
```

ValidationSummary 是否使用 ErrorMessage，而 ValidationMessage 是否使用 InnerException.Message？

我的视图代码是：

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master"
Inherits="System.Web.Mvc.ViewPage<App.Models.PurchaseOrdersView>" %>

<asp:Content ID="Content1" ContentPlaceHolderID="head" runat="server">
    <title>Edit</title>
</asp:Content>

<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">

    <h2>Edit</h2>

    <%= Html.ValidationSummary() %>

    <% Html.BeginForm("Edit", "PurchaseOrder", FormMethod.Post); %>
    <table>
        <tr>
            <td>
                Purchase Order Id:
            </td>
            <td>
                <%= Html.TextBox("PurchaseOrderId", Model.PurchaseOrderId)%>
                <%= Html.ValidationMessage("PurchaseOrderId")%>
            </td>
        </tr>
        <tr>
            <td>
                Date:
            </td>
            <td>
                <%= Html.TextBox("Date", Model.Date.ToString("dd-MMM-yyyy"))%>
                <%= Html.ValidationMessage("Date")%>
            </td>
        </tr>
    </table>
    <input type="submit" value="Save" />

    <% Html.EndForm(); %>

</asp:Content> 
```

* * *

## 回答 #1

> 赞同：11
> 
>             
> 
> 时间：2010-09-27T14:42:25.113

尝试

```
<%= Html.ValidationSummary(false) %> 
```

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2009-02-13T13:51:52.513

您没有说没有显示的错误是什么，但是有一些错误将显示在 ValidationMessage 中，但不会显示在 ValidationSummary 中。我认为这是候选版本中的一个错误，但我对其他解释持开放态度。特别是，请考虑 ValidationSummary 源代码中的这一行：

```
string errorText = GetUserErrorMessageOrDefault(modelError, null /* modelState */); 
```

请注意，没有为 modelState 传递任何内容。现在将其与 ValidationMessage 进行对比：

```
... GetUserErrorMessageOrDefault(modelError, modelState) ... 
```

最后，我们看一下GetUserErrorMessageOrDefault：

```
 private static string GetUserErrorMessageOrDefault(ModelError error, ModelState modelState) {
        if (!String.IsNullOrEmpty(error.ErrorMessage)) {
            return error.ErrorMessage;
        }
        if (modelState == null) {
            return null;
        }

        string attemptedValue = (modelState.Value != null) ? modelState.Value.AttemptedValue : null;
        return String.Format(CultureInfo.CurrentCulture, MvcResources.Common_ValueNotValidForProperty, attemptedValue);
    } 
```

这告诉我们的是，如果您在向模型状态添加错误时指定自定义错误消息，它将被显示。但是，如果添加了一个异常（AddModelError 有一个重载接受异常，另一个重载接受一个字符串；实现 IDataErrorInfo 的工作方式类似于字符串大小写），而不是字符串错误消息，只有在 modelState 为非空，然后我们会给你一个通用消息而不是异常的错误消息。

**更新**

> ValidationSummary 是否使用 ErrorMessage，而 ValidationMessage 是否使用 InnerException.Message？

是的，或多或少是这样的效果。就像我说的，我认为这是一个错误。

***更新2***

Microsoft 更新了 GetUserErrorMessageOrDefault 函数，如此[处所示](http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/f1511797ea32#src%2fSystem.Web.Mvc%2fHtml%2fValidationExtensions.cs)。

```
private static string GetUserErrorMessageOrDefault(HttpContextBase httpContext, ModelError error, ModelState modelState)
    {
        if (!String.IsNullOrEmpty(error.ErrorMessage))
        {
            return error.ErrorMessage;
        }
        if (modelState == null)
        {
            return null;
        }

        string attemptedValue = (modelState.Value != null) ? modelState.Value.AttemptedValue : null;
        return String.Format(CultureInfo.CurrentCulture, GetInvalidPropertyValueResource(httpContext), attemptedValue);
    } 
```

# ruby-on-rails - Ruby on rails link_to 语法

> ID：545951
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2009-02-13T13:38:34.790
> 
>         
> 
> 标签：ruby-on-rails, scaffolding, link-to

在遵循我找到的[教程](http://guides.rails.info/getting_started.html)之后。我现在重做一遍，没有脚手架部分，以更好地学习它。

但是，编辑我的 \app\views\home\index.html.erb 以包含：

```
<h1>Rails test project</h1>
<%= link_to "my blog", posts_path> 
```

我收到一个错误：

```
undefined local variable or method `posts_path' for #<ActionView::Base:0x4e1d954> 
```

在我这样做之前，我运行`rake db:create`，定义了一个迁移类并运行`rake db:migrate`，一切都没有问题。

所以数据库应该包含一个posts表。但是该`link_to`命令似乎找不到`posts_path`。该变量（或者它甚至是一个函数？）可能是通过脚手架例程定义的。

我现在的问题是；我如何自己手动完成，定义`posts_path`？

* * *

## 回答 #1

> 赞同：21
> 
>             
> 
> 时间：2009-02-13T13:40:59.497

您将需要定义您的帖子的路径`config/routes.rb`

Rails 2.x 语法：

```
map.resources :posts 
```

Rails 3.x 语法：

```
resources :posts 
```

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-02-13T22:01:45.550

_path 方法通常是动态生成的。当没有指定对象的路由或在这种情况下您显式调用的方法时，会出现方法丢失错误。

定义路线应该可以解决这个问题。上面的 HermanD 展示了一种方法来做到这一点。

您可以从 Rails 应用程序的根目录运行“rake routes”以查看所有已配置的路由

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2010-06-06T07:36:59.317

**<%= link_to "我的博客", posts_path>**

如果这正是您的 erb 所包含的内容，那么它缺少 scriptlet 元素末尾的百分号。不知道这是否导致了你的问题，或者我可能太从字面上理解了......

# java - Java split() 方法最后去除空字符串？

> ID：545957
> 
>         
> 
> 赞同：122
> 
>         
> 
> 时间：2009-02-13T13:40:35.457
> 
>         
> 
> 标签：java, split

看看下面的程序。

```
try {
    for (String data : Files.readAllLines(Paths.get("D:/sample.txt"))){
        String[] de = data.split(";");
        System.out.println("Length = " + de.length);
    }
} catch (IOException e) {
    e.printStackTrace();
} 
```

示例.txt：

```
1;2;3;4
甲;乙;;
a;b;c;

```

输出：

```
长度 = 4
长度 = 2
长度 = 3

```

为什么第二个和第三个输出给出 2 和 3 而不是 4。在`sample.txt`文件中，第二行和第三行的条件是应该`\n`在给第三个字段的分隔符后立即给出换行符（或输入）。谁能帮助我如何在不更改`sample.txt`文件条件的情况下将第 2 行和第 3 行的长度设为 4 以及如何打印`de[2]`(throws   `ArrayIndexOutOfBoundsException`) 的值？

* * *

## 回答 #1

> 赞同：303
> 
>             
> 
> 时间：2009-02-13T13:49:53.657

您可以通过以下方式指定尽可能频繁地应用模式：

```
String[] de = data.split(";", -1); 
```

[有关详细信息，请参阅采用两个参数的 split 方法的 Javadoc](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#split(java.lang.String,%20int))。

* * *

## 回答 #2

> 赞同：26
> 
>             
> 
> 时间：2009-02-13T13:45:59.173

看看[文档](http://java.sun.com/javase/6/docs/api/java/lang/String.html#split(java.lang.String,%20int))，这里是重要的引述：

```
[...] the array can have any length, and trailing empty strings will be discarded. 
```

如果您不喜欢这样，请查看 Fabian 的评论。调用时`String.split(String)`，它调用`String.split(String, 0)`and 丢弃尾随的空字符串（如文档所说），使用它调用`String.split(String, n)`时`n < 0`不会丢弃任何内容。

# authentication - 以不同的 AD 用户身份查看 Reporting Services 报告

> ID：545968
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-13T13:43:40.987
> 
>         
> 
> 标签：authentication, reporting-services, active-directory, credentials, kiosk

我有一些在机器特定的 AD 帐户下运行的“信息亭”，我想在这些帐户上部署报告。出于安全原因，我需要在允许访问报告之前验证个人用户凭据。有没有办法通过报告服务做到这一点？我们正在运行 Reporting Services 2005，但很快就会升级。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T13:55:54.280

如何使用自定义安全扩展：

[http://technet.microsoft.com/en-us/library/ms152899(SQL.90).aspx](http://technet.microsoft.com/en-us/library/ms152899(SQL.90).aspx)

# nhibernate - 持久性无知可以扩展吗？

> ID：545976
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2009-02-13T13:45:59.250
> 
>         
> 
> 标签：nhibernate, entity-framework, domain-driven-design, scale, persistence-ignorance

我已经简要介绍了 NHibernate 和 Linq2Sql。我也打算看看实体框架。

当我谈到这些 ORM 时，提出的问题是“它们无法扩展”，那么它们可以吗？从谷歌我得到的印象是他们能够很好地扩展，但最终我认为必须付出代价，是否值得为更丰富、更简单的业务层付出代价。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-02-13T13:59:02.993

这是一个很好的问题，恕我直言，它们可以像任何自定义 DAL 一样进行扩展。我只使用过 nHibernate，所以我将只关注它以及它具有的有助于扩展系统的功能。

*   延迟加载 - 由于它支持延迟加载，您可以避免加载任何不必要的项目。当然，您需要注意 Select n+1 问题，但是系统中有一些东西可以防止这种情况发生。

*   Eager Fetching - 有多种方法可以急切地获取您可能需要的对象，从而避免额外的 SQL 访问。

*   二级缓存 - nHibernate 支持二级缓存，可用于通过减少对数据库的访问来提高可伸缩性。有各种可用的支持提供商可以为您提供一些灵活性。

*   编写您自己的 SQL - 在 nHibernate 中，您可以调用存储过程，或提供将返回您的实体的内联 SQL 查询。这将让您在生成的 sql 没有剪切它时使用自己的 SQL。例如，使用递归查询急切加载自连接树。

话虽如此，我认为最初调整自定义 DAL 层更容易，因为您熟悉它的结构并且可以对其进行微调；然而，一个好的 ORM 将提供大量的钩子，让您可以进行相当多的优化。你只需要花一些时间来学习它。

我还认为，如果您有一个性能关键的代码区域并且您不能让您的 ORM 在您的要求范围内工作，那么对于您应用程序的那个小区域，您可以自定义构建您自己的 DAL 层。如果您正在使用一个像样的设计模式，例如由工厂创建的存储库，那么您需要做的就是更换存储库的实现

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-13T15:43:07.160

[Hibernate Shards](http://www.hibernate.org/414.html)正在[移植到 NHibernate](http://darioquintana.com.ar/blogging/?p=25)，这将允许水平扩展。

还有一些非常酷的 hack，比如[这个](http://www.blechie.com/WPierce/archive/2008/06/08/Poor-Mans-Shards-in-NHibernate.aspx)来实现分片。

所以答案是肯定的，NHibernate 可以扩展，以一种持久性无知和完全透明的方式。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-16T01:36:36.800

说在 ORM 中构建的应用程序不能很好地扩展是完全不正确的。当然，在粗心或懒惰的开发人员通过编写生成极低效率的 SQL 的代码滥用 ORM 之前，这种情况就已经发生了。构建高性能应用程序意味着了解所有可爱的抽象*实际上在幕后所做*的事情。然而，远离这个陷阱并不需要太多。使用 ORM 并不意味着永远不会打开 SQL 分析器或[NHibernate Profiler](http://www.nhprof.com/)。

关于 SP 的速度要快得多的说法，请阅读[this](https://blog.codinghorror.com/who-needs-stored-procedures-anyways/)和[this](http://weblogs.asp.net/fbouma/archive/2003/11/18/38178.aspx)。此外，如果您需要，ORM（至少是 NHibernate）为您提供了使用 SP 的非常简单的方法。

# jquery - 使用 Jquery 查找父 div 的 id

> ID：545978
> 
>         
> 
> 赞同：100
> 
>         
> 
> 时间：2009-02-13T13:46:22.447
> 
>         
> 
> 标签：jquery, dom, semantics

我有一些这样的html：

```
<div id="1">
    <p>
        Volume = <input type="text" />
        <button rel="3.93e-6" class="1" type="button">Check answer</button>
    </p>
    <div></div>
</div> 
```

和一些像这样的JS：

```
$("button").click(function () {
    var buttonNo = $(this).attr('class');
    var correct = Number($(this).attr('rel'));

    validate (Number($("#"+buttonNo+" input").val()),correct);
    $("#"+buttonNo+" div").html(feedback);
}); 
```

我真正想要的是，如果我不必在按钮上有 class="1" （我知道数字类无效，但这是一个 WIP！），所以我可以根据父 div 的 id。在现实生活中，有多个部分看起来像这样。

1.  如何找到作为按钮的 div 的 id。

2.  将答案存储在按钮代码中的更语义化方式是什么。我想让非程序员在不破坏任何东西的情况下复制和粘贴尽可能地万无一失！

* * *

## 回答 #1

> 赞同：212
> 
>             
> 
> 时间：2009-02-13T14:10:17.087

您可以在父 div 上使用[事件委托。](http://learn.jquery.com/events/event-delegation/)或者使用[最接近](http://docs.jquery.com/Traversing/closest)的方法找到按钮的父级。

两者中最简单的可能是最接近的。

```
var id = $("button").closest("div").prop("id"); 
```

* * *

## 回答 #2

> 赞同：47
> 
>             
> 
> 时间：2009-02-13T13:51:39.877

1.

```
$(this).parent().attr("id"); 
```

2.

一定有很多方法！一种可能是隐藏包含答案的元素，例如

```
<div>
    Volume = <input type="text" />
    <button type="button">Check answer</button>
    <span style="display: hidden">3.93e-6&lt;/span>
    <div></div>
</div> 
```

然后有与上面类似的 jQuery 代码来获取它：

```
$("button").click(function () 
{
    var correct = Number($(this).parent().children("span").text());
    validate ($(this).siblings("input").val(),correct);
    $(this).siblings("div").html(feedback);
}); 
```

请记住，如果您将答案放在客户端代码中，那么他们可以看到它:) 最好的方法是在服务器端验证它，但对于范围有限的应用程序，这可能不是问题。

* * *

## 回答 #3

> 赞同：11
> 
>             
> 
> 时间：2009-02-13T13:51:28.300

试试这个：

```
$("button").click(function () {
    $(this).parents("div:first").html(...);
}); 
```

* * *

## 回答 #4

> 赞同：10
> 
>             
> 
> 时间：2014-01-27T08:57:56.673

```
$(this).parents('div').attr('id'); 
```

* * *

## 回答 #5

> 赞同：7
> 
>             
> 
> 时间：2009-02-13T13:50:36.697

要获取父 div 的 id：

```
$(buttonSelector).parents('div:eq(0)').attr('id'); 
```

此外，您可以相当多地重构您的代码：

```
$('button').click( function() {
 var correct = Number($(this).attr('rel'));
 validate(Number($(this).siblings('input').val()), correct);
 $(this).parents('div:eq(0)').html(feedback);
}); 
```

现在不需要按钮类

**解释**

eq(0)，意味着您将从 jQuery 对象中选择一个元素，在本例中为元素 0，因此是第一个元素。[http://docs.jquery.com/Selectors/eq#index](http://docs.jquery.com/Selectors/eq#index)

$(selector).siblings(siblingsSelector) 将选择所有与SiblingsSelector匹配的兄弟姐妹（具有相同父元素的元素）[http://docs.jquery.com/Traversing /siblings#expr](http://docs.jquery.com/Traversing/siblings#expr)

$(selector).parents(parentsSelector) 将选择与父选择器匹配的选择器匹配的所有父元素。[http://docs.jquery.com/Traversing/parents#expr](http://docs.jquery.com/Traversing/parents#expr)

因此： $(selector).parents('div:eq(0)'); 将匹配选择器匹配的元素的第一个父 div。

你应该看看 jQuery 文档，特别是选择器和遍历：

*   [http://docs.jquery.com/](http://docs.jquery.com/)

*   [http://docs.jquery.com/Selectors](http://docs.jquery.com/Selectors)

*   [http://docs.jquery.com/Traversing](http://docs.jquery.com/Traversing)

* * *

## 回答 #6

> 赞同：6
> 
>             
> 
> 时间：2013-03-25T10:24:22.527

[http://jsfiddle.net/qVGwh/6/](http://jsfiddle.net/qVGwh/6/)
检查这个

```
 $("#MadonwebTest").click(function () {
    var id = $("#MadonwebTest").closest("div").attr("id");
    alert(id);
    }); 
```

* * *

## 回答 #7

> 赞同：5
> 
>             
> 
> 时间：2012-10-25T10:01:45.147

这可以通过以下方式轻松完成：

```
$(this).closest('table').attr('id'); 
```

您将它附加到表内的任何对象上，它将返回该表的 id。

* * *

## 回答 #8

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T14:03:21.703

JQUery 有一个 .parents() 方法用于向上移动 DOM 树，您可以从那里开始。  

如果您有兴趣以更语义化的方式执行此操作，我认为在按钮上使用 REL 属性不是在代码中语义定义“这就是答案”的最佳方式。我会推荐一些类似的东西：

```
<p id="question1">
    <label for="input1">Volume =</label> 
    <input type="text" name="userInput1" id="userInput1" />
    <button type="button">Check answer</button>
    <input type="hidden" id="answer1" name="answer1" value="3.93e-6" />
</p> 
```

和

```
$("button").click(function () {
    var correctAnswer = $(this).parent().siblings("input[type=hidden]").val();
    var userAnswer = $(this).parent().siblings("input[type=text]").val();
    validate(userAnswer, correctAnswer);
    $("#messages").html(feedback);
}); 
```

不太确定你的验证和反馈是如何工作的，但你明白了。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2017-11-08T21:51:10.303

find() 和最接近的() 似乎比：

```
$(this).parent().attr("id"); 
```

# wpf - WPF 数据网格样式

> ID：545979
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-02-13T13:47:00.277
> 
>         
> 
> 标签：wpf, datagrid, wpf-controls, styles, wpftoolkit

有没有人知道/有一个例子来说明如何将 WPF DataGrid 布局更改为卡片视图或其他任何东西，而不仅仅是行堆栈？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-02-16T23:11:38.497

结果看起来像这样。[替代文字 http://iwebthereforeiam.com/files/ScreenShot.gif](http://iwebthereforeiam.com/files/ScreenShot.gif)  

这是应该演示这个想法的代码。

XAML：

```
<Window x:Class="StackOverflow_545979.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:StackOverflow_545979"
    xmlns:debug="clr-namespace:System.Diagnostics;assembly=System"
    Title="Window1" Height="300" Width="300">

    <Window.Resources>
        <local:GreekGods  x:Key="GreekGods"/>
        <DataTemplate x:Key="itemTemplate">
            <Border BorderBrush="RoyalBlue" BorderThickness="2" Margin="2" Padding="5">
                <WrapPanel Orientation="Vertical">
                    <TextBlock Width="200" Text="{Binding Path=Name}"/>
                    <TextBlock Width="200" Text="{Binding Path=Description}"/>
                    <TextBlock Width="200" Text="{Binding Path=RomanName}"/>
                </WrapPanel>
            </Border>
        </DataTemplate>
    </Window.Resources>

    <ListBox ItemTemplate="{StaticResource itemTemplate}" 
             ItemsSource="{StaticResource GreekGods}" />
</Window> 
```

C#代码：

```
using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
namespace StackOverflow_545979
{
    public class GreekGod
    {
        public string Name { get; set; }
        public string Description { get; set; }
        public string RomanName { get; set; }

        public GreekGod() { }
        public GreekGod(string name, string description, string romanName)
        {
            this.Name = name;
            this.Description = description;
            this.RomanName = romanName;
        }
    }

    public class GreekGods : ObservableCollection<GreekGod>
    {
        public GreekGods()
        {
            this.Add(new GreekGod("Aphrodite", "Goddess of love, beauty and fertility", "Venus"));
            this.Add(new GreekGod("Apollo", "God of prophesy, music and healing", "Apollo"));
            this.Add(new GreekGod("Ares", "God of war", "Mars"));
            this.Add(new GreekGod("Artemis", "Virgin goddess of the hunt", "Diana"));
            this.Add(new GreekGod("Athena", "Goddess of crafts and the domestic arts", "Athena"));
            this.Add(new GreekGod("Demeter", "Goddess of agriculture", "Ceres"));
            this.Add(new GreekGod("Dionysus", "God of wine", "Bacchus"));
            this.Add(new GreekGod("Hephaestus", "God of fire and crafts", "Vulcan"));
            this.Add(new GreekGod("Hera", "Goddess of marriage", "Juno"));
            this.Add(new GreekGod("Hermes", "Messenger of the Gods", "Mercury"));
            this.Add(new GreekGod("Poseidon", "God of the sea, earthquakes and horses", "Neptune"));
            this.Add(new GreekGod("Zeus", "Supreme God of the Olympians", "Jupiter"));
        }
    }
} 
```

[从Bea Stollnitz 的例子](http://bea.stollnitz.com/blog/)中提取的GreekGod 和 GreekGods 类。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T14:55:46.960

Instead of a datagrid, try using a combination of a listview or listbox (depending on which functionality you want - both derive from ItemsSource) and datatemplates. Both of these are standard WPF, not part of the toolkit.

[http://blah.winsmarts.com/2007-3-WPF__The_DataTemplate,_choosing_how_your_data_will_look_like.aspx](http://blah.winsmarts.com/2007-3-WPF__The_DataTemplate,_choosing_how_your_data_will_look_like.aspx)

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T15:02:54.120

我不知道如何使用 WPF Toolkit 的 DataGrid 来做到这一点，我怀疑这是否是您真正需要的。您可以使用 ListView 或 ListBox 来完成。将 ListView.View 设置为 IsItemsSource="True" 的 WrapPanel。然后使用 DataTemplate 制作卡片。有一个很好的例子可以帮助你了解大部分[情况](http://learnwpf.com/Posts/Post.aspx?postId=386bae2f-5dc1-4b1d-8dd9-6ceed0428d88)。

# php - Xampp apache 崩溃 php rar

> ID：545983
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-13T13:48:22.910
> 
>         
> 
> 标签：php

我使用 xampp go-pear 在 php 上安装了 rar 扩展

它在 php 信息中显示 rar 已启用。

我的代码如下

```
<?php
$rar_file = rar_open('htdocs.rar') or die("Can't open Rar archive");

$entries = rar_list($rar_file);

foreach ($entries as $entry) {
    echo 'Filename: ' . $entry->getName() . "\n";
    echo 'Packed size: ' . $entry->getPackedSize() . "\n";
    echo 'Unpacked size: ' . $entry->getUnpackedSize() . "\n";

    $entry->extract('C:/xampp/htdocs');
}

rar_close($rar_file);

?> 
```

rar_open 导致 apache 崩溃。如果我注释掉 rar_open，apache 不会崩溃并正常运行。

有谁知道是什么让它崩溃？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T16:05:37.743

[这里](http://pecl.php.net/bugs/bug.php?id=15864&edit=1)有一个开放的错误，描述了您遇到的问题。解决这个问题应该是一个简单的 PECL 库升级。

> 当前 CVS 版本包括 3.7.8；如果您有一个较旧的版本，您可能希望等待 PECL Win32 构建重新出现并尝试使用更新版本的扩展。

# vb.net - 一个班级应该如何向另一个班级请求信息？

> ID：545985
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-02-13T13:49:09.740
> 
>         
> 
> 标签：vb.net, design-patterns

我正在为 CAD 图纸开发一个 VB.NET 批量 PDF 导出程序。程序运行良好，但架构一团糟。基本上，一个大功能需要从头到尾的整个过程。我想创建一个或几个单独的类来完成导出工作。

**这是问题所在：**

有时我的程序将创建的 pdf 文件已经存在。在这种情况下，我想询问用户他/她是否想覆盖现有的 PDF。如果实际上有一些东西会被覆盖并且我只想这样做一次，我只想这样做。换句话说，“是”=“对所有人都是”。让表单（将调用这个新的 PDF 导出类）弄清楚 PDF 文件将被调用什么以及是否会有任何覆盖似乎是错误的。事实上，最好在处理单个 CAD 图纸时确定 PDF 文件的名称（因为我可能希望使用只有在后台将文件加载到 CAD 程序中之后才可用的信息）。

**问题来了：**

提示用户的过程应该如何处理？我想将所有 GUI 逻辑（甚至像对话框这样简单的东西）排除在我的 PDF 导出类之外。我需要一种方法让 PDF 导出类说，“嘿，我需要知道我是否应该覆盖或跳过这个文件，”并且表单类（或任何其他类）说，“嗯，好的，我会询问用户并回复您。”

似乎应该有一些模式来处理这种情况。它是什么？

**后续行动：**

事件：这似乎是一个好方法。这是关于 PDF 导出类中的代码应该是什么样子的吗？

```
    Dim e As New FileExistsEventArgs(PDFFile)
    RaiseEvent FileExists(Me, e)
    If e.Overwrite Then
        '在这里做事
    万一

```

一个疯狂的想法：将委托函数传递给 PDF 导出类的导出方法以处理覆盖情况怎么样？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-02-13T14:05:34.053

您可以使用一个事件，创建一个自定义事件参数类，其中包含应用程序可以调用的属性。然后当您的应用程序处理事件时提示用户，然后告诉导出器要做什么。我是 ac# 的家伙，所以让我先给你一个样本：

```
void form_Load(object sender,EventArgs e)
{
   //We are subscribing to the event here. In VB this is done differently
   pdfExporter.FileExists+=new FileExistsEventHandler(pdfExporter_fileExists)
}

void pdfExporter_fileExists(object sender, FileExistsEventArgs e)
{
   //prompUser takes the file and asks the user
   if (promptUser(e.FileName)) 
   {
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T14:04:36.023

你的 PDF 制作课程应该引发一个[事件](http://msdn.microsoft.com/en-us/library/ms172877(VS.80).aspx)。这个事件应该有一个 eventargs 对象，它可以有一个名为“Overwrite”的布尔属性，GUI 可以按照你想要的任何方式设置它。当事件在您的 PDF 类中返回时，您将拥有用户的决定，并且可以根据需要覆盖或不覆盖。Gui 可以随心所欲地处理事件。

另外，我赞扬您努力使两者分开！

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T14:04:35.773

因此，您的类上的适当方法需要一个可选参数

```
[OverwriteExisting as Boolean = False] 
```

但是，您的表单将需要处理确定文件是否存在的逻辑。在我看来，无论如何这都不是您希望封装在 PDF 导出类中的函数。假设您的表单或其他函数/类确定需要覆盖，则调用导出方法，将 True 作为布尔值传递给导出类。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T14:06:26.830

你可以做一个两阶段提交类型的事情。

该类有两个接口，一个用于准备文件名和文件系统，另一个用于执行实际工作。

所以第一阶段，GUI 调用初始化接口，并快速回答是否需要重写。甚至可能是将被覆盖的文件的完整列表。用户回答，其他响应中的布尔变量是已知的，然后导出器开始实际工作，用户可以去做其他事情。

会有一些重复的计算，但尽快完成用户的部分操作可能是值得的。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T14:24:04.883

您不能将 GUI 内容排除在 PDF 导出代码之外。但是您可以精确地定义所需的最小值，而不必依赖于您使用的任何框架。

我是如何做到的，我有一个 Status 类和一个 Progress 类。两者之所以存在，是因为 Status 旨在更新状态消息，而 Progress Bar 旨在与进度指示器一起使用。

它们都分别使用具有 IStatusDisplay 和 IPrograssDisplay 类类型的对象。

我的 GUI 定义了一个实现 IStatusDisplay（或 IProgressDisplay）的对象，并使用具有状态和进度的 DLL 注册为当前显示。具有 Status 和 Progress 的 DLL 也有两个单例，称为 NullStatus 和 NullProgress，可以在不需要 UI 反馈时使用。

使用这个方案，我可以在我的代码中添加我想要的尽可能多的状态或进度更新，我只担心 GUI 层的实现。如果我想要一个静默过程，我可以只使用 Null 对象。此外，如果我完全改变我的 GUI 框架，所有新的 GUI 所要做的就是创建实现 IStatusDisplay 的新对象，即 IProgressDisplay。

另一种方法是引发事件，但我发现在 GUI 级别处理起来令人困惑和复杂。特别是如果您有多个屏幕，用户可以在它们之间切换。通过使用接口，您可以使连接更清晰，更易于维护。

**编辑**
您可以创建一个 Prompt 类和一个 IPromptDisplay 来处理询问是否要覆盖文件等情况。

例如

```
Dim P as New Prompt(MyPromptDisplay,PromptEnum.YesNo)
'MyPromptDisplay is of IPromptDisplay and was registered by the GUI when the application was initialized

If PromptYesNo.Ask("Do you wish to overwrite files")= PromptReply.Yes Then
    'Do stuff here
End If 
```

# .net - 我可以使用 UriTemplate 将非字符串传递给 WCF RESTful 服务吗？

> ID：545988
> 
>         
> 
> 赞同：72
> 
>         
> 
> 时间：2009-02-13T13:49:53.453
> 
>         
> 
> 标签：.net, wcf, web-services, rest

我可以执行以下操作吗？

```
[OperationContract]
[WebGet(UriTemplate = "/foo/{id}")]
string GetFoo(int id); 
```

我希望我的服务既可以用作 RESTful 服务，也可以用作 RPC 样式的 SOAP 服务。如果可能的话，我想将 int 保留为 int，而不是手动解析。

* * *

## 回答 #1

> 赞同：79
> 
>             
> 
> 时间：2009-05-05T00:55:56.030

正如 dthrasher 提到的，将 id 移动到 URI 的查询部分。这对我有用：

```
[OperationContract]
[WebGet(UriTemplate = "/foo?id={id}")]
string GetFoo(int id); 
```

有关 URI 不同部分的更多信息，请参阅维基百科上的“URI 方案”：
 [http ://en.wikipedia.org/wiki/URI_scheme](http://en.wikipedia.org/wiki/URI_scheme)

* * *

## 回答 #2

> 赞同：69
> 
>             
> 
> 时间：2009-02-18T15:43:23.580

如果我没记错的话，路径中的 UriTemplate 变量在使用 WebGet 或 WebInvoke 时总是解析为字符串。当 UriTemplate 变量位于 UriTemplate 的查询部分时，您只能将它们绑定到 int、long 等。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2013-05-22T16:07:59.753

正如其他人提到的，您必须使用查询字符串才能传递非字符串参数。下面的文章详细介绍了解析是如何完成的。

[WCF 可扩展性 – QueryStringConverter](http://blogs.msdn.com/b/carlosfigueira/archive/2011/08/09/wcf-extensibility-querystringconverter.aspx)

> 回到“正确的”WCF 可扩展性，本周的文章是关于 QueryStringConverter 的。这实际上是一个简单的主题，因为它的目的非常具体（与之前看到的其他可扩展点不同，它可以用于各种情况）——在 WCF**中，QueryStringConverter 仅用于应用了 WebHttpBehavior 的端点给他们。即使在这些情况下，也仅适用于通过查询字符串传递参数的**操作（带有标记为 [WebGet] 的参数的操作或带有明确将某些参数绑定到查询字符串的 UriTemplate 的 [WebInvoke] 操作）。QueryStringConverter 是可以在操作参数及其在查询字符串中的表示之间进行转换的部分。
> 
>   
>   
> 
> ...
> 
>   
>   
> 
> WebHttpBehavior 使用的默认 QueryStringConverter 原生支持多种类型，包括所有简单的数字类型**（Byte、SByte、Int16、Int32、Int64、UInt16、UInt32、UInt64、Single、Double、Decimal）、Boolean、Char、Object、String、DateTime 、DateTimeOffset、TimeSpan、Guid、Uri 和 Byte 数组**（本质上是 DataContractSerializer 认为是“原语”的所有类型，XmlQualifiedName 除外）。**默认也支持枚举类型**（使用枚举值的字符串表示）。最后，还有一组默认的 QueryStringConverter 支持的类型——任何使用类型转换器声明 [TypeConverter] 属性的类型，该类型转换器可以将类型转换为字符串或从字符串转换（更多内容见下文）。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-02-13T14:02:26.950

不幸的是，如果您想使用`UriTemplate`.

# .net - wpf 完整参考

> ID：545991
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-13T13:50:35.463
> 
>         
> 
> 标签：.net, wpf, xaml, documentation

我正在寻找一个完整的 wpf 标签文档以将其与 wpf 控件一起使用。有人见过这样的东西吗？

10倍

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T13:53:47.280

[MSDN 参考书](http://msdn.microsoft.com/en-us/library/ms746683.aspx)感觉有点机械，但很完整。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-14T06:42:11.147

WPF 没有“标签”完整文档。标记 - XAML - 本质上是无限的。如果我创建一个新控件，繁荣，我可以在 XAML 中使用它。或者，我可以使用 XAML 使用与 UI 无关的自定义类型来创建我自己的任意对象图。

有一个 XAML 语言规范，但这不是您想要的。BC 对 MSDN 的回答是一个开始，但非常不完整。查看 System.Windows.Controls* 下的所有内容以获得更好的想法。****`** 
```