# StackOverflow 问答 000240000-000240999

# vb.net - 如何在 VB.NET 中使接口属性可选地只读？

> ID：240012
> 
> 赞同：2
> 
> 时间：2008-10-27T14:13:19.727
> 
> 标签：vb.net, oop, interface

这是我之前关于接口的问题的后续。我收到了一个我喜欢的答案，但我不确定如何在 VB.NET 中实现它。

上一个问题：

[这个属性应该是我的对象接口的一部分吗？](https://stackoverflow.com/questions/239909/should-this-property-be-part-of-my-objects-interface)

```
public interface Foo{
  bool MyMinimallyReadOnlyPropertyThatCanAlsoBeReadWrite {get;}
} 
```

如何使用 VB.NET 语法实现这一点？据我所知，我唯一的选择是将属性标记为 ReadOnly（我无法实现 setter）或不（我必须实现 setter）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T14:19:58.840

只需在一个接口中定义 getter，然后创建一个同时具有 getter 和 setter 的第二个接口。如果你的具体类是可变的，让它实现第二个接口。在处理类的代码中，检查它是否是第二个接口的实例，如果是，则强制转换，然后调用 setter。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T14:24:10.253

在 VB.NET 中，我会以这种方式实现它：

```
Public Interface ICanBeSecure

    ReadOnly Property IsSecureConnection() As Boolean
End Interface

Public Interface IIsSecureable
    Inherits ICanBeSecure

    Shadows Property IsSecureConnection() As Boolean
End Interface 
```

# c# - 跨多个数据库的交叉引用

> ID：240013
> 
> 赞同：8
> 
> 时间：2008-10-27T14:13:25.673
> 
> 标签：c#, sql, sql-server, ms-access, ado.net

我有两个数据库，一个是 MS Access 文件，另一个是 SQL Server 数据库。我需要创建一个 SELECT 命令，该命令根据 Access 数据库中的数据过滤 SQL Server 数据库中的数据。使用 ADO.NET 完成此任务的最佳方法是什么？

我可以将每个数据库中的所需数据提取到两个新表中吗？将这些放在一个数据集中。然后在 Dataset 上执行另一个 SELECT 命令来组合数据？

附加信息：Access 数据库不是永久性的。要使用的 Access 文件由用户在运行时设置。

这里有一些背景信息来解释为什么有两个数据库。我的公司使用 CAD 程序来设计建筑物。该程序将 CAD 模型中使用的材料存储在 Access 数据库中。每个模型都有一个文件。我正在编写一个程序，它将为每个模型生成成本信息。这是基于存储在 SQL Server 数据库中的当前材料价格。

* * *

**我的解决方案**

我最终只是将访问数据库中的数据导入到 SQL 服务器数据库中的临时表中。执行所有必要的处理，然后删除临时表。这不是一个很好的解决方案，但它确实有效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-27T14:55:16.180

如果您不必这样做，您不想同时拉动两个数据集。由于文件位置可能会更改，甚至可能无法随时供服务器本身使用，因此您在实施 Tomalak 的解决方案时也会遇到麻烦。

我的猜测是您的用户使用人员/产品或他们有兴趣使用的任何内容设置了一个 Access 数据库，这就是您需要在两个数据库中进行选择的原因。如果是这种情况，则 Access 表可能小于 SQL Server 表。最好的办法是提取 Access 数据，然后使用它生成对 SQL Server 的过滤查询，以便您可以最大限度地减少通过网络发送的数据。

所以，最重要的是：

1.  过滤服务器上的数据，以便您可以最大限度地减少网络流量，并且因为数据库在过滤方面将比 ADO.NET 更快
2.  如果您必须选择要拉入应用程序的数据集，请拉入较小的数据集，然后使用该数据集过滤另一个表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T10:06:12.697

假设 Sql Server 可以访问 Access 数据库，您可以在它们之间构造一个[OPENROWSET](http://msdn.microsoft.com/en-us/library/ms190312.aspx)查询。

```
 SELECT a.* 
 FROM SqlTable 
 JOIN OPENROWSET(
     'Microsoft.Jet.OLEDB.4.0', 
     'C:\Program Files\Microsoft Office\OFFICE11\SAMPLES\Northwind.mdb';'admin';'',
     Orders
 ) as b ON
     a.Id = b.Id 
```

您只需在运行时更改 Access 数据库的路径即可访问不同的 MDB。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T14:18:56.270

首先，您需要在服务器上执行一些操作 - 将 Access DB 引用为“链接服务器”。

然后，您将能够从 SQL 服务器中查询它，随意提取或填充数据。这个网页很好地概述了如何做到这一点。

[http://blogs.meetandplay.com/WTilton/archive/2005/04/22/318.aspx](http://blogs.meetandplay.com/WTilton/archive/2005/04/22/318.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-27T19:54:24.393

如果您通过 ODBC 从 Access 前端链接到 SQL Server 并像两个表都是本地表一样编写 SQL，您是否尝试过基准测试？然后，您可以在服务器上进行跟踪以准确查看 Jet 发送到服务器的内容。你可能会惊讶于 Jet 在这种事情上的效率。如果您正在链接关键字段（例如，ID 字段，无论是否来自 SQL Server），Jet 很可能会发送 ID 列表。或者你可以编写你的 SQL 来这样做（在你的 WHERE 子句中使用 IN SELECT ...）。

基本上，事情的效率取决于您的 WHERE 子句将在哪里执行。例如，如果您将本地 Jet 表与单个字段上的链接 SQL Server 表连接起来，并根据本地表中的值过滤结果，那么它很可能非常有效，因为 Jet 唯一会发送到服务器是过滤 ​​SQL Server 表所必需的。

不过，这将完全取决于您要执行的操作（即您要过滤的字段）。但是给 Jet 一个机会来看看它是否聪明，而不是假设 Jet 会搞砸它。很可能需要进行一些调整才能让 Jet 有效地工作，但是如果您可以将所有逻辑保留在客户端，那么您最好不要试图从服务器跟踪所有 Access 数据库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T06:09:33.330

如果我正确阅读了该问题，则您不会尝试跨多个数据库进行交叉引用。

您只需要参考有关特定文件的详细信息，在这种情况下，可能包含：

主键、父文件校验和（如果是修改）、文件校验和、最后已知作者、修订号、最后更改日期...

然后添加从使用您的程序分析该文件获得的信息时的主键。

如果您确实需要分布式数据库，也许您更愿意使用非关系型数据库，例如 LDAP。

如果您不能使用 LDAP，但必须使用关系数据库，则可以考虑使用 GUID 来确保您的主键是正确的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-10T00:04:19.583

由于您没有提供足够的信息，我将不得不做出一些假设。

假设：

1.  SQL Server 和 Access 数据库不在同一台计算机上
2.  SQL Server 无法通过文件共享看到 Access 数据库，否则很难实现这一点。
3.  您不需要在 access 数据库和 sql server 之间进行连接，只需使用 access 数据库中的数据作为 where 子句的查找元素

如果上述假设是正确的，那么您可以简单地使用 ADO 打开 Access 数据库并检索您需要的数据，可能在数据集或数据表中。然后提取您需要的数据，并通过动态 Where 子句、预准备语句或通过存储过程的参数将其提供给 SQL Server 的不同 ADO 查询。

人们给出的其他解决方案都假设您需要对数据进行连接或以其他方式执行包含两个数据库的 SQL。为此，您必须使用链接数据库，或者将数据导入表中（可能是临时的）。

# c# - 集合集合是否可能和/或最好的方式？C# .Net 3.5

> ID：240016
> 
> 赞同：5
> 
> 时间：2008-10-27T14:14:20.427
> 
> 标签：c#, .net, collections

我为仪表板项目创建了一个类，该类将保存诸如在仪表板上的位置、描述等信息。我目前正在使用一对集合来保存“库”中包含的仪表板项目以及显示在仪表板上的那些项目本身。我被要求制作这个仪表板多选项卡，我的第一个倾向是为每个选项卡创建一个新集合。为此，我想要某种类型的数组或集合，当更多选项卡添加到仪表板时，可以将许多仪表板项目集合添加到其中。

这是否可能，如果可以，我可以获得一些代码片段来声明这样一个集合吗？我考虑过使用带有变量的单个集合来显示项目将显示在哪个选项卡中......但是，管理屏幕和库之间的仪表板项目移动的显示和例程当前需要这些单独的集合。

编辑：谢谢你的回答。虽然我确实觉得它们都很有趣，但我相信我会选择 James 的解决方案并将其标记为已接受的答案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-27T14:21:16.093

```
List< List<Placement>> ListofListOfPlacements = new List< List<Placement>> ();

List<Placement> dashboard1 = new List<Placement>();
List<Placement> dashboard2 = new List<Placement>();
List<Placement> dashboard3 = new List<Placement>();
List<Placement> dashboard4 = new List<Placement>();

ListofListOfPlacements.Add(dashboard1);
ListofListOfPlacements.Add(dashboard2);
ListofListOfPlacements.Add(dashboard3);
ListofListOfPlacements.Add(dashboard4); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-27T14:41:47.953

由于您在谈论选项卡，因此在我看来，您想要更接近以选项卡名称为键的字典，每个选项卡都有一组项目。.NET 3.5 增加了`ILookup<,>`接口：

```
 ILookup<string, Foo> items = null; //TODO
        foreach (Foo foo in items["SomeTab"])
        {
            Console.WriteLine(foo.Bar);
        } 
```

请注意，MS 实现是不可变的 - 创建后您无法对其进行编辑；`EditableLookup<,>`但是，我在[MiscUtil](http://www.pobox.com/~skeet/csharp/miscutil/)中编写了一个可以让您更有效地工作（就像常规 .NET 集合一样）：

```
 var items = new EditableLookup<string, Foo>();
        items.Add("SomeTab", new Foo { Bar = "abc" });
        items.Add("AnotherTab", new Foo { Bar = "def" });
        items.Add("SomeTab", new Foo { Bar = "ghi" });
        foreach (Foo foo in items["SomeTab"])
        { // prints "abc" and "ghi"
            Console.WriteLine(foo.Bar);
        } 
```

如果没有`EditableLookup<,>`，您需要通过`Enumerable.ToLookup`扩展方法构建查找。

如果这听起来像是一个选项，我可以添加更多细节......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T14:17:58.643

为什么不创建一个包含您的第二个集合和任何先前信息的类，并且只拥有这些项目的集合？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-27T14:35:04.303

为什么不将您的仪表板项目集合放在标签页类中呢？

像这样：

```
public class DashboardTabPage : TabPage
{
    public List<DashboardItem> DashboardItems { get; set; }

    public DashboardTabPage() : this (new List<DashboardItem>())
    {

    }

    public DashboardTabPage(List<DashboardItem> items) :base ("Dashboard Thing")
    {
        DashboardItems = items;
    }

} 
```

公共类 DashboardItem { }

那么你可以这样做：

```
c.TabPages.Add(new DashboardTabPage()); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-16T12:07:17.890

我认为您应该使用作文，如下所示

每个用户仪表板主页（具有多个选项卡）对象包含仪表板对象列表，其中包含仪表板项目对象列表，其中定义了各种操作。同样，仪表板项目可以是一个用户控件，其中定义了所有可能的事件，这些事件在仪表板项目对象中处理和/或留给将与单个仪表板对象一起使用的仪表板 UI 对象。

如果您要遵循 SOA 和基于可重用组件的架构，我想这将更易于管理。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-08-08T09:54:31.267

你也可以使用这样的元组：`List<(string Father, IEnumerable<string> Children)>`.

例子：

```
var list = new List<(string Parent, IEnumerable<string> Children)>
{
   ("Bob", new[] { "Charlie", "Marie" }),
   ("Robert", new[] { "John", "Geoff", "Oliver" }),
}; 
```

# algorithm - 比例为 1:2 的随机数

> ID：240022
> 
> 赞同：3
> 
> 时间：2008-10-27T14:16:26.523
> 
> 标签：algorithm, math, random, numbers, distribution

我必须生成两组随机矩阵，每组包含 3 个数字，范围从 2 到 10

像那样

矩阵 1：994,878,129,121

矩阵 2：272,794,378,212

两个矩阵中的数字必须大于 100 且小于 999

但

两个矩阵的平均值必须是 1:2 或 2:3 的比例

我的数学技能有点有限，所以我有什么想法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T14:31:53.247

为此，您必须知道每个列表中有多少个数字。我从你的例子中假设每个都有四个数字。

1.  用四个随机数填充第一个列表。
2.  计算第一个列表的平均值。
3.  将平均值乘以 2 或 3/2，以用户输入为准。这是第二个列表所需的平均值。
4.  乘以 4。这是第二个列表所需的总数。
5.  生成 3 个随机数。
6.  从第 4 步的总数中减去第 5 步中的三个数字的总数。这是第二个列表的第四个数字。
7.  如果步骤 6 中的数字不在正确范围内，请从步骤 5 重新开始。

请注意，第二个列表中的最后一个数字并不是真正随机的，因为它基于列表中的其他值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T14:33:53.680

你有一组随机数，s1。

```
s1= [ random.randint(100,999) for i in range(n) ] 
```

对于其他一些集合，s2，要具有不同的意味着它必须具有不同的范围。您可以从不同的范围内随机选择值，也可以过滤随机值以获得不同的范围。

无论您从 100 到 999 范围内选择多少个**随机**数，均值始终只有 550 左右。不同值的几率恰好是均值两侧的正态分布概率。

对于从同一范围内选择的值，您不能有完全不同的平均值。

# directshow - 用于自定义解码器的 DirectShow 中的自动 YUV -> RGB

> ID：240024
> 
> 赞同：3
> 
> 时间：2008-10-27T14:17:15.587
> 
> 标签：directshow, rgb, yuv, ogg-theora

在网上搜索了几个小时后，我非常渴望找到解决方案。我已经在 DirectShow 中启动并运行 OGG Theora 解码器，它输出 YV12 和 YUY2 颜色模型。

现在，我想为此输出制作一个 RGB 像素操作过滤器并将其处理到视频渲染器中。根据[this](http://msdn.microsoft.com/en-us/library/ms940088.aspx)和 [this](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=3134367&SiteID=1)，它应该非常简单和透明，但事实并非如此。

例如，我在`CheckInputType()`这个检查中实现了：

```
if( IsEqualGUID(*mtIn->Type(), MEDIATYPE_Video )
        && IsEqualGUID(*mtIn->Subtype(), MEDIASUBTYPE_RGB565 ) )
{
   return S_OK;
} 
```

我希望它在 Theora 和我的解码器之间插入 MSYUV 并为我完成这项工作（即将其转换为 RGB）。问题是我每次都出错（在 GraphEdit 应用程序中）。而且我 100% 确定它是 YV12 作为输入（在调试器中检查）。我能想到的唯一解释是提到了 AVI 解压缩器，但没有关于它的更多信息。

*   这是否意味着如果我想获得这个自动功能，我必须使用 AVI 容器？
*   奇怪的是它适用于例如 WMV 视频（在他们的输出上带有 YUV），只有这个 OGG 解码器有问题。所以这可能是一个问题，这个OGG解码器错过了什么？

太糟糕了，MSYUV 过滤器不能用作颜色空间转换器，即在 GraphEdit 中可见且可直接使用...

我很欣赏这方面的任何提示，编程自己的 YV12 -> RGB 转换器我作为最后的手段。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-07T01:57:53.750

Directshow 中没有内置 YUV 到 RGG 颜色空间转换器。WMV 文件为您工作的原因是 WMV 解码器过滤器会根据您连接的过滤器类型吐出 RGB 或 YUV 数据。

您可以在这里做的最好的事情是自己编写一个色彩空间转换器过滤器，或者在获得 YUV 数据后对其进行转换。

[Fourcc.org](http://fourcc.org)有一篇关于[从 YUV 转换为 RGB](http://www.fourcc.org/fccyvrgb.php)的好文章。此外[，Keith Jack 所著的 Video Demystified](https://rads.stackoverflow.com/amzn/click/com/0750683953)一书包含有关色彩空间转换的所有详细信息。

# msdn - 关于MSDN和商业用途的问题

> ID：240030
> 
> 赞同：15
> 
> 时间：2008-10-27T14:18:46.393
> 
> 标签：msdn

我在一家小型数字营销公司担任程序员，我们不是 Microsoft 合作伙伴或任何类型（金/银/铜）。但是，我们使用 .NET。

我感到困惑的是，我之前的开发人员已经离开，他获得了最新的 Microsoft 工具的订阅 DVD，并交付给了公司（Sql Server 等）。

我假设这不是个人订阅，因为如果是，他会更改地址。

无论如何，订阅是专业的，我们将这些工具用于商业目的。这是允许的吗？另外，我可以在家里使用我们得到的工具吗？我想在家中将 Windows Server 用于开发目的（为考试而学习）。

谢谢

* * *

谢谢各位的建议。

许可证是以我老板的名义注册的，但我认为一个网络人已将自己添加为附加用户。

MSDN FAQ 说我最多可以安装 10 个工具实例。我在想如果我使用 MSDN 之外的产品密钥，那么该密钥将永远使用，并且无法安装额外的许可证。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-27T14:21:43.987

请阅读包含许可条款的[MSDN 订阅常见问题解答以获得最终答案。](http://msdn.microsoft.com/en-us/subscriptions/aa948864.aspx)

我的理解是，您可以使用该软件来支持您公司的开发工作，但不能运行生产服务器。IE。您可以开发 Exchange 加载项，但不能使用 MSDN 附带的 Exchange Server 运行公司的电子邮件。

在家里使用该软件可能是一个灰色地带。如果它在公司拥有的设备上并支持您的开发目标，那么听起来不错。如果它在您自己的设备上，那么它可能违反 EULA 的详细信息。您可以随时尝试致电 Microsoft 并询问。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-04-25T23:14:25.413

### 阅读 Microsoft 关于 Visual Studio 2013 许可的白皮书

示例：订阅了 MSDN 的开发人员白天在工作中使用 MSDN 软件，但有时也需要在家中使用不同的计算机进行开发。在 MSDN 许可下，工作中的 PC 和家用 PC 没有区别；家用 PC 只是开发人员有权在其上使用 MSDN 软件的另一台设备。但是，在开发者的家用 PC 上运行的 MSDN 软件的限制与在工作环境中一样：安装在家用 PC 上的 MSDN 软件只能用于设计、开发和测试目的；只有拥有适当 MSDN 订阅的其他用户才能使用该软件。

[Visual Studio 和 MSDN 许可白皮书](http://www.microsoft.com/en-us/download/details.aspx?id=13350)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-16T19:14:24.737

简而言之，不，您根本不能将任何 MSDN 磁盘用于生产服务。仅限开发和测试。如果您使用它们开发应用程序，然后将其投入生产（例如，您为自己开发一个时间表应用程序），一旦它开始用作时间表应用程序，您需要购买它所需的所有内容的完整版本。

你还需要考虑一件事。您需要为每个开发人员购买一份 MSDN。仅仅因为它说您最多可以使用 10 个实例并不意味着其他任何人都可以（否则我可以使用您的一些许可证，如果您不介意:)）。

因此，如果您的团队中有 3 个开发人员，您需要购买 3 个 MSDN 许可证。如果您使用其他开发人员访问的 MSDN 许可证运行服务器，这也适用 - 我认为如果其他开发人员购买 CAL 来访问它，您可能会没事，但至少可以说 T&C 令人困惑。

您还需要记住，MSDN 许可证是经常性的 - 我们是根据 3 年选择协议购买的，您可能有不同的条款。

我们目前正在接受 MS 的审核。事实证明，为 Windows 开发可能会变得非常昂贵:(

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-27T14:30:10.803

如果订阅由公司支付，您应该能够将指定个人更改为您自己（或公司中的其他人）。这将允许您使用订阅访问 MSDN 以下载软件和提交问题报告。我们有一个许可证，当其中一个有执照的人离开时，我们换了一个。不幸的是，我们的软件许可办公室处理了它，所以我不知道它是如何完成的细节。我们还在 Select 许可证下购买了它，所以无论如何它可能会有所不同。

听取@Rob Walker 的建议并查看常见问题解答，了解您可以使用该软件做什么。

# python - WindowsError：在脚本中保存 FreeImagePy 图像时的特权指令，在 IDLE 中工作

> ID：240031
> 
> 赞同：1
> 
> 时间：2008-10-27T14:18:54.100
> 
> 标签：python, exception, windowserror

我正在开发一个程序来在 Python 中进行一些图像处理工作。我正在使用 FreeImagePy，因为 PIL 不支持多页 TIFF。每当我尝试从我的程序中保存文件时，我都会收到此错误消息（或类似的消息，具体取决于我尝试保存的方式）：

```
Error returned.  TIFF FreeImage_Save: failed to open file C:/OCRtmp/ocr page0
Traceback (most recent call last):
  File "C:\Python25\Projects\OCRPageUnzipper\PageUnzipper.py", line 102, in <mod
ule> OCRBox.convertToPages("C:/OCRtmp/ocr page",FIPY.FIF_TIFF)
  File "C:\Python25\lib\site-packages\FreeImagePy\FreeImagePy\FreeImagePy.py", l
ine 2080, in convertToPages self.Save(FIF, dib, fileNameOut, flags)
  File "C:\Python25\lib\site-packages\FreeImagePy\FreeImagePy\FreeImagePy.py", l
ine 187, in Save return self.__lib.Save(typ, bitmap, fileName, flags)
WindowsError: exception: priviledged instruction 
```

当我尝试从 IDLE 做同样的事情时，它工作得很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T06:04:56.623

看起来像权限问题，请确保您没有在另一个应用程序中打开文件，并且您对尝试写入的文件位置具有写入权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-28T19:29:43.443

我也是这么想的，但我几个小时前就想通了。显然，如果我要写入的目录/文件不存在，FreeImagePy 不够聪明，无法创建它（大多数时候。创建一个新的多页图像似乎工作正常）但我想在 IDLE 中运行它, IDLE 计算出来并处理它什么的。我设法通过使用 os.mkdir 来明确地确保我需要的东西存在来解决它。

# language-agnostic - 你如何为你的命名空间想出名字？

> ID：240033
> 
> 赞同：7
> 
> 时间：2008-10-27T14:18:57.970
> 
> 标签：language-agnostic, project-organization

我将首先说我通常在 C#/.Net 中工作。

通常，我使用一种命名方案，将通用的、可重用的组件放入一个命名空间中，该命名空间将我们的组织和项目特定的组件反映到与项目相关的命名空间中。我这样做的原因之一是我有时会与部门外但在组织内的其他人共享我的组件。项目特定的命名空间通常以部门名称或缩写开头。当我在项目之间重用代码时，我通常将其迁移到基于组织的命名空间之一。

例如：

`UIOWA.DirectoryServices`包含处理我们的 Active Directory 的特定实现的类。

`UIOWA.Calendar`包含处理大学主日历的课程。

`LST.Inventory.Datalayer`包含实现学习空间技术组库存应用程序的数据层的类。

我现在正在为一个与大学（一个举办慈善活动的学生团体）有更模糊联系的实体开展一个项目，该实体有可能在我们大学之外出售，因此，它并不真正适合进入我的正常命名约定，即，该部门只是可能使用该项目的许多潜在客户中的第一个客户。

我的倾向是走组织命名路线并为此应用程序创建一个“组织项目”命名空间。我想听听其他人如何处理这个问题以及您可能有的任何建议。

谢谢。

**另请参阅**有关[命名空间组织](https://stackoverflow.com/questions/123114/how-do-you-organize-your-namespaces)的相关问题。

**编辑**

我最终创建了 org/project 命名空间`UIOWA.MasterEvent`并从那里派生了更多的命名空间。仍然对未来项目的其他意见感兴趣。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-27T14:28:51.693

我的部门在过去五年中三次更改了他的名字，所以我们都很高兴有人决定不使用带有组织名称的命名空间......

我们的命名空间是按项目名称组织的。可重用的东西被放入`Toolbox`命名空间。也许有点粗糙，但到目前为止效果很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T14:20:09.607

我是一名 .NET 开发人员，我总是使用组织项目命名空间 (com.bolidian.projectspace)，因为它保证了唯一性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-31T09:26:41.910

我使用组织，其次是产品，例如 Acme.Crm。在子命名空间中将类组合在一起时，请始终使用复数或动作，以免与类发生冲突。例如

*   Acme.Crm.Letters
*   Acme.Crm.Invoicing

我遵循 Microsoft 的惯例，不使用首字母缩略词，例如用 Crm 代替 CRM，用 Sql 代替 SQL——但这更多是个人喜好。

# oracle - Oracle utl_match 特殊字符

> ID：240046
> 
> 赞同：1
> 
> 时间：2008-10-27T14:23:31.253
> 
> 标签：oracle

我想使用 Oracle 的 utl_match.edit_distance 函数。它应该比较两个字符串并返回[Levenshtein distance](http://en.wikipedia.org/wiki/Levenshtein_Distance)。

```
select utl_match.edit_distance('a','b') from dual 
```

按预期返回 1，但是

```
select utl_match.edit_distance('á','b') from dual 
```

返回 2。显然我想得到 1。

似乎是，它不适用于特殊字符。我正在使用 Oracle 10.2.0.4 和 AL32UTF8 字符集。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T15:43:33.463

这似乎与字符集有关。如果我使用 ISO8859P15 作为字符集在 10.2.0.3 和 11.1.0.7 数据库中运行相同的测试，我也会得到 1 的距离。我猜 Oracle 是根据字节而不是可变宽度字符集中的字符来计算距离。

您可以使用 CONVERT 函数转换为固定宽度字符集（AL16UTF16 或本地字符集）来解决此问题

```
SQL> ed
Wrote file afiedt.buf

  1  declare
  2    l_char1 varchar2(1 char) := 'á';
  3    l_char2 varchar2(1 char) := 'b';
  4  begin
  5    dbms_output.put_line(
  6      'In AL32UTF8: ' ||
  7        utl_match.edit_distance( l_char1, l_char2 ) );
  8    dbms_output.put_line(
  9      'In WE8ISO8859P15: ' ||
 10        utl_match.edit_distance(
 11            CONVERT( l_char1, 'WE8ISO8859P15', 'AL32UTF8' ),
 12            CONVERT( l_char2, 'WE8ISO8859P15', 'AL32UTF8' ) ) );
 13    dbms_output.put_line(
 14      'In AL16UTF16: ' ||
 15        utl_match.edit_distance(
 16            CONVERT( l_char1, 'AL16UTF16', 'AL32UTF8' ),
 17            CONVERT( l_char2, 'AL16UTF16', 'AL32UTF8' ) ) );
 18* end;
SQL> /
In AL32UTF8: 2
In WE8ISO8859P15: 1
In AL16UTF16: 1

PL/SQL procedure successfully completed. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T14:44:03.660

我同意，这似乎是错误的。但是，Oracle 未记录此软件包，因此目前可能不受支持。

# sql-server - 参考表

> ID：240047
> 
> 赞同：3
> 
> 时间：2008-10-27T14:23:39.787
> 
> 标签：sql-server

在 SQL Server 中，为什么会这样：

```
[dbo].[table_name] 
```

比这更可取：

```
dbo.table_name 
```

沿着这些思路，如果只有一个模式，为什么还要列出 dbo？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-27T14:26:18.983

如果表名包含关键字，则必须将其括在 [ ] 内。大多数工具（如 ORM）都使用这种技术来避免任何错误或保持一致性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-27T14:24:40.533

以防万一您有一个关键字作为表名，例如 [user]

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-27T14:26:21.980

它允许在表名中使用关键字或标点符号。

它经常被代码生成器用于所有名称，因此他们不必弄清楚它是否真的需要。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-27T14:26:25.303

这些通常出现在生成的代码中 - 因为使代码生成产生完全限定和转义的引用比推断何时需要转义/限定更容易。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-27T14:26:25.613

如果只有一个模式，那么我认为没有必要或没有用为表名添加前缀。当您的标识符是 sql server 中的保留字时，使用方括号 [] 很有用。例如，如果您有一个名为 Select 的表，则可以将其称为`SELECT * FROM [Select]`但不能称为`SELECT * FROM Select`。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-27T14:50:35.817

我不使用方括号，仅当您将关键字用作模式或表名时才需要使用方括号，而您不应该这样做。

但我建议不要将 dbo 放在前面。原因是最终您可能希望开始将代码组织到模式中，然后您将需要前缀。如果您养成使用 schema.table 格式的习惯，那么在代码中搜索使用表的位置会*容易*得多。

假设您有一个名为 dbo.user 的表，并且您决定将其移动到另一个模式。如果您必须在一堆存储过程或动态 sql 中搜索“用户”，您可能会得到大量误报。你不能完全确定你做了所有你需要的改变。搜索“dbo.user”要简洁得多。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-29T18:52:35.357

仅当对象名称包含空格等字符或它是关键字时，才需要 []。通常认为最好不要使用这些作为对象名称，因此您永远不需要 []。话虽如此，它们也没有害处，如果它是生成的代码并包含括号，那么您不妨留下它们。
使用 dbo 是个好主意，因为

1.  性能更好（有关一些数据，请参见[此处）](http://sqlblog.com/blogs/linchi_shea/archive/2007/07/05/performance-impact-of-procedure-calls-without-owner-qualification-sql-server-2000.aspx)
2.  在某些情况下需要 dbo，例如调用用户定义的函数。我认为总是包含它会更整洁。
3.  如果您确实创建了多个模式，那么不限定对象名称可能会导致将来出现错误。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-27T14:27:22.523

这难道不允许您在其中拥有您想要的任何“坏”物品吗？
关键字、空格等...

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-27T14:27:58.857

我宁愿避免在表名和列名中使用标点符号和保留字，也不要使用方括号。这使得 SQL 更容易阅读。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-07-27T16:05:58.923

[除了标识符名称中的空格、保留关键字和系统函数外，标识符还可以包含一些常规标识符](http://msdn.microsoft.com/en-us/library/ms175874(v=sql.105).ASPx)中不允许的字符，必须用方括号分隔。

[您可以在本文](http://technet.microsoft.com/en-us/library/ms176027(v=sql.105).aspx)中找到常规标识符和定界标识符的详细解释和规则。

来自文章：

> 例如，分隔标识符可以包含空格、对常规标识符有效的任何字符以及以下任一字符：
> 
> 波浪号 (~) 连字符、(-) 感叹号 (!)、左大括号 ({)、百分号 (%)、右大括号 (})、插入符号 (^)、撇号 (')、和号 (&)、句点 (. )、左括号 (()、反斜杠 ()、右括号 ())、重音符 (`)、

使用两个名称限定约定可以提高性能（避免名称解析）并避免在两个或多个模式中有相同表名的情况下出现歧义。在这种情况下，SQL Server 将在 dbo 中搜索您的对象，如果它不存在，它将停止搜索。

此外，如果您以后想将该对象与 SCHEMABINDING 选项一起使用，则它不允许使用不合格的对象名称。

希望这可以帮助

# svn - 颠覆外部问题

> ID：240049
> 
> 赞同：6
> 
> 时间：2008-10-27T14:23:44.713
> 
> 标签：svn, externals

我是 SVN 的新手，并且大量使用了 externals 属性。我的 PC 上有一个存储库，外部属性的名称中有一个硬编码的“localhost”，现在这给我带来了问题。例如：

```
/project1/trunk
/shared/trunk 
```

`project1/trunk`取决于共享文件夹，因此具有**svn://localhost/shared/trunk**`svn:externals`的属性。这适用于 TortoiseSVN，我可以结帐并获得.**`project1/trunk``shared/trunk`**

 **现在我已将存储库移动到另一台服务器，并且由于明显的原因外部链接不再起作用（TortoiseSVN 正在尝试检查`svn://localhost/shared/trunk`不再存在的）。

所以我需要更新我所有的外部文件——但我不想硬编码任何机器名称——那么我该如何做呢？请记住，存储库可能会在某个时候再次移动。挖掘 SVN 手册时，我遇到了**^/**语法，所以我尝试了以下方法：

```
svn:externals shared ^/shared/trunk 
```

这已被接受，但是当我尝试在我的 PC 上签出副本时`project1`，我收到以下错误：

```
Unrecognized format for the relative external URL 'shared'.
Check the path and/or URL you've entered. 
```

除非我在外部硬编码存储库机器名称，否则我无法完成这项工作 - 这似乎是一种黑色艺术，因此欢迎任何建议。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-27T14:34:43.617

您引用的 ^/ 语法是 SVN 1.5 中的新语法，因此您可能使用的是不理解该语法的旧版本的客户端和/或服务器。此外，为了支持 1.5 中的新 externals 语法，他们更改了 externals 定义中的参数顺序。我想你首先想要路径，然后是它的文件夹名称。详细信息在[文档](http://svnbook.red-bean.com/en/1.5/svn-book.html#svn.advanced.externals)中。

# c - linux下1ms分辨率定时器推荐方式

> ID：240058
> 
> 赞同：19
> 
> 时间：2008-10-27T14:26:22.137
> 
> 标签：c, linux, timer

我需要一个在 linux 下分辨率为 1ms 的计时器。它用于增加一个计时器值，该值又用于查看是否应该触发各种事件。由于 glibc 的要求，POSIX timerfd_create 不是一个选项。我尝试了 timer_create 和 timer_settimer，但我从中得到的最好的结果是 10 毫秒的分辨率，较小的值似乎默认为 10 毫秒的分辨率。根据手册页，Getittimer 和 setitimer 的分辨率为 10 毫秒。

我目前能想到的执行此计时器的唯一方法是在我的主循环中使用 clock_gettime 和 CLOCK_MONOTONIC 来测试是否经过了毫秒，如果是则增加计数器（然后检查各种事件是否应该触发）。

有没有比在主循环中不断查询更好的方法呢？推荐的解决方案是什么？

我使用的语言是普通的 c

**更新**
我使用的是 2.6.26 内核。我知道你可以让它以 1kHz 的频率中断，然后可以将 POSIX timer_* 函数编程为最高 1ms，但这似乎不可靠，我不想使用它，因为它可能需要一些新内核系统。一些股票内核似乎仍然配置了 100Hz。我需要检测到这一点。该应用程序可能在我的系统之外的其他东西上运行:)

我无法入睡 1 毫秒，因为我可能需要对网络事件做出反应。

**我是如何解决** 的 因为它不是那么重要，所以我简单地声明全局计时器的分辨率为 100 毫秒。所有使用自己的计时器的事件都必须设置至少 100 毫秒的计时器到期时间。我或多或少想知道是否会有更好的方法，因此提出了这个问题。

**为什么我接受这个答案** 我认为来自 freespace 的答案最好地描述了为什么没有实时 Linux 系统是不可能的。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-27T14:52:02.473

在主循环中轮询也不是一个答案——你的进程可能不会获得太多的 CPU 时间，因此在你的代码运行之前会经过超过 10 毫秒，使它变得毫无意义。

10ms 大约是大多数非[实时操作系统](http://en.wikipedia.org/wiki/Real-time_operating_system)(RTOS) 的标准计时器分辨率。但它在非 RTOS 中没有实际意义——调度程序和调度程序的行为将极大地影响您对计时器到期的响应速度。例如，即使您有一个低于 10 毫秒的分辨率计时器，如果您的代码没有运行，您也无法响应计时器到期。由于您无法预测代码何时运行，因此您无法准确响应计时器到期。

当然还有实时 linux 内核，请参阅[http://www.linuxdevices.com/articles/AT8073314981.html](http://www.linuxdevices.com/articles/AT8073314981.html)获取列表。RTOS 提供了一些工具，您可以通过这些工具获得有关代码何时运行的软或硬保证。这是可靠和准确地响应计时器到期等的唯一方法。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2011-01-18T12:33:19.383

要获得 1ms 分辨率计时器，请执行[libevent](http://monkey.org/~provos/libevent/)所做的操作。

将您的计时器组织成一个[min-heap](http://en.wikipedia.org/wiki/Min-heap)，也就是说，堆的顶部是具有最早到期（绝对）时间的计时器（rb-tree 也可以工作，但开销更大）。在调用之前`select()`或`epoll()`在您的主事件循环中计算最早计时器的到期时间与现在之间的增量（以毫秒为单位）。将此增量用作`select()`. 超时有 1ms 的分辨率`select()`。`epoll()`

我有一个计时器分辨率测试，它使用上面解释的机制（但不是 libevent）。该测试测量期望的计时器到期时间与其实际到期的 1ms、5ms 和 10ms 计时器之间的差异：

```
1000 deviation samples of  1msec timer: min=  -246115nsec max=  1143471nsec median=   -70775nsec avg=      901nsec stddev=    45570nsec
1000 deviation samples of  5msec timer: min=  -265280nsec max=   256260nsec median=  -252363nsec avg=     -195nsec stddev=    30933nsec
1000 deviation samples of 10msec timer: min=  -273119nsec max=   274045nsec median=   103471nsec avg=     -179nsec stddev=    31228nsec
1000 deviation samples of  1msec timer: min=  -144930nsec max=  1052379nsec median=  -109322nsec avg=     1000nsec stddev=    43545nsec
1000 deviation samples of  5msec timer: min= -1229446nsec max=  1230399nsec median=  1222761nsec avg=      724nsec stddev=   254466nsec
1000 deviation samples of 10msec timer: min= -1227580nsec max=  1227734nsec median=    47328nsec avg=      745nsec stddev=   173834nsec
1000 deviation samples of  1msec timer: min=  -222672nsec max=   228907nsec median=    63635nsec avg=       22nsec stddev=    29410nsec
1000 deviation samples of  5msec timer: min= -1302808nsec max=  1270006nsec median=  1251949nsec avg=     -222nsec stddev=   345944nsec
1000 deviation samples of 10msec timer: min= -1297724nsec max=  1298269nsec median=  1254351nsec avg=     -225nsec stddev=   374717nsec 
```

该测试在 Fedora 13 内核 2.6.34 上作为实时进程运行，1ms 计时器的最佳实现精度为 avg=22nsec stddev=29410nsec。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-27T14:53:05.140

我不确定这是不是最好的解决方案，但您可能会考虑编写一个使用内核高分辨率计时器进行计时的小型内核模块。基本上，您将创建一个设备文件，其读取只会以 1 毫秒的间隔返回。

Asterisk PBX 中通过 ztdummy 模块使用了这种方法的一个示例。如果你用谷歌搜索 ztdummy，你可以找到执行此操作的代码。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-27T14:49:47.597

我认为即使在主循环中不断查询，使用标准 Linux 实现 1 毫秒的精度也会有困难，因为内核不能确保您的应用程序始终获得 CPU。例如，由于抢先式多任务处理，您可能会陷入数十毫秒的睡眠，而您对此无能为力。

您可能想研究[Real-Time Linux](http://rt.wiki.kernel.org/index.php/Main_Page)。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-01-18T12:02:39.753

如果您的目标是 x86 平台，您应该检查 HPET 计时器。这是一个高精度的硬件定时器。你的主板必须支持它（现在它们都支持它），你的内核也应该包含它的驱动程序。我已经使用它几次，没有任何问题，并且能够实现比 1ms 更好的分辨率。

以下是一些文档和示例：

*   [http://www.kernel.org/doc/Documentation/timers/hpet.txt](http://www.kernel.org/doc/Documentation/timers/hpet.txt)
*   [http://www.kernel.org/doc/Documentation/timers/hpet_example.c](http://www.kernel.org/doc/Documentation/timers/hpet_example.c)
*   [http://fpmurphy.blogspot.com/2009/07/linux-hpet-support.html](http://fpmurphy.blogspot.com/2009/07/linux-hpet-support.html)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-20T05:26:10.693

我似乎记得使用基于 gettimeofday/usleep 的轮询获得了不错的结果——我不需要每秒 1000 个计时器或任何东西，但我需要在我确实需要的滴答声的计时上保持良好的准确性——我的应用程序是一个 MIDI 鼓机控制器，我似乎记得获得亚毫秒精度，如果你不希望它听起来像一个非常糟糕的鼓手（特别是计算 MIDI 的内置延迟），你需要一个鼓机 - iirc（它是2005 所以我的记忆有点模糊）我在目标时间的 200 微秒内进入睡眠状态。

但是，我没有在系统上运行太多其他东西。如果您有一个受控的环境，您可能能够摆脱这样的解决方案。如果系统上发生了更多事情（观看 cron 启动更新数据库等），那么事情可能会分崩离析。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-27T14:50:18.873

您是否在 Linux 2.4 内核上运行？

来自 VMware 知识库文章 #1420 ( [http://kb.vmware.com/kb/1420](http://kb.vmware.com/kb/1420) )。

> Linux 客户操作系统通过计数定时器中断来保持时间。未修补的 2.4 和更早的内核对虚拟系统计时器进行编程，以请求 100Hz 的时钟中断（每秒 100 个中断）。另一方面，2.6 内核以 1000Hz 的频率请求中断——频率是后者的十倍。分发供应商修改为包含 2.6 功能的一些 2.4 内核也请求 1000Hz 中断，或者在某些情况下，以其他速率中断，例如 512Hz。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-27T14:56:56.100

linux内核有ktimer补丁：

[http://lwn.net/Articles/167897/](http://lwn.net/Articles/167897/)

[http://www.kernel.org/pub/linux/kernel/projects/rt/](http://www.kernel.org/pub/linux/kernel/projects/rt/)

高温高压

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-01-18T11:24:29.930

首先，获取内核源代码并使用调整后的 HZ 参数对其进行编译。

*   如果`HZ=1000`，定时器每秒中断 1000 次。可以`HZ=1000`用于 i386 机器。
*   在嵌入式机器上，HZ 可能被限制为 100 或 200。

为了良好的操作，PREEMPT_KERNEL 选项应该打开。有些内核不正确支持此选项。您可以通过搜索查看它们。

最近的内核，即 2.6.35.10，支持 NO_HZ 选项，它打开动态刻度。这意味着空闲时不会有计时器滴答，但会在指定时刻生成计时器滴答。

内核有一个 RT 补丁，但硬件支持非常有限。

通常，RTAI 是解决您问题的万能解决方案，但它的硬件支持非常有限。然而，好的 CNC 控制器，如 emc2，使用 RTAI 作为其时钟，可能是 5000 Hz，但安装它可能很困难。

如果可以，您可以添加硬件来生成脉冲。这将使系统能够适应任何操作系统版本。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-01-11T03:00:42.990

简单的实时应用程序不需要 RTOS。所有现代处理器都有通用定时器。获取您正在使用的任何目标 CPU 的数据表。查看内核源代码，在 arch 目录下，您将找到特定于处理器的源代码如何处理这些计时器。

您可以采用两种方法：

1）你的应用程序只运行你的状态机，没有别的。Linux 只是您的“引导加载程序”。创建一个安装字符设备的内核对象。插入内核后，将您的 GP 计时器设置为连续运行。你知道它的工作频率。现在，在内核中，明确禁用你的看门狗。现在禁用中断（硬件和软件） 在单 CPU Linux 内核上，调用 spin_lock() 将完成此操作（永远不要放弃它。）CPU 是你的。繁忙的循环，检查 GPT 的值，直到通过了所需的刻度数，当它们通过时，为下一个超时设置一个值并进入您的处理循环。只需确保您的代码的突发时间低于 1ms

2）第二个选项。这假设您正在运行一个抢占式 Linux 内核。在运行的操作系统旁边设置一个未使用的 GPT。现在，设置一个中断以在您的 1ms 超时发生之前触发一些可配置的余量（例如 50-75 uSec。）当中断触发时，您将立即禁用中断并旋转等待 1ms 窗口发生，然后进入您的状态机，随后在等待 OUT 时启用中断。这说明了您正在与内核中禁用中断的其他事物合作。这假设没有其他内核活动可以长时间（超过 100us）锁定中断。现在，您可以测量触发事件的准确性并扩大窗口，直到满足您的需要。

相反，如果您想了解 RTOS 的工作原理……或者如果您尝试解决具有多个实时责任的控制问题……那么请使用 RTOS。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-27T14:48:12.887

您至少可以在循环中使用 nanosleep 睡眠 1ms 吗？还是那是 glibc 的事情？

**更新：**没关系，我从手册页中看到“在进程再次可运行之前，它可能需要比指定的时间长 10 毫秒”

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-05-31T11:18:32.710

使用“/dev/rtc0”（或“/dev/rtc”）设备及其相关的ioctl() 接口怎么样？我认为它提供了一个准确的计时器计数器。不能将速率设置为 1 毫秒，而是设置为接近值或 1/1024 秒 (1024Hz) 或更高的频率，如 8192Hz。

# c - 依赖性检查 - 如何清理带有错误 makefile 的项目

> ID：240061
> 
> 赞同：6
> 
> 时间：2008-10-27T14:26:49.153
> 
> 标签：c, build-process, dependencies, makefile

我有一个非常大的 C 项目，其中包含许多单独的 C 文件和头文件以及许多贡献者。许多贡献者对 makefile 和依赖项没有深入的了解，这导致了一个常见的问题，即您几乎总是必须“make clean”才能相信“make”产生正确的输出。

如果 make 需要几分钟，这不会是一个问题，但现在在一台快速的机器上将近 2 个小时，人们开始检查他们制作时可以工作的代码，但他们没有先清理，他们的代码最终会中断构建。不要问为什么在新基线被削减之前构建经理没有捕捉到这些......

是的，我们不应该让它走这么远。

是的，我们正在教育我们的开发人员。

像往常一样，我们没有时间停止一切并手动修复它。

我认为有这些方面的工具：

*   是否有自动化工具可以帮助从 C 和 H 文件为现有项目构建正确的依赖关系信息？
*   是否有根据 makefile 描述依赖信息的自动化工具？
*   是否有一个工具可以描述上述两个依赖树之间的差异？

但是还可以/应该做些什么来解决这个问题？

提前致谢...

-亚当

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-27T14:33:09.487

从 Make 切换到自动检测依赖项的工具可能是最简单的。例如，[SCons](http://www.scons.org/)不会让您列出依赖项，而是自动解析正在编译的文件并查找包含。您只需指定应该编译哪些文件以及哪些文件进入哪些可执行文件。由于您的开发人员并不是真正的 Make 专家，因此切换构建系统会更容易。

如果您坚持使用 Make，另一种选择是使用`gcc -M`自动检测依赖项的选项。[自动发现 C 依赖](https://stackoverflow.com/questions/204823/automatically-discovering-c-dependencies)项问题的答案有一个示例，说明如何让您的 makefile 自动发现依赖项，以便您无需手动指定它们。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-27T14:44:43.567

自动制作和自动配置组合：

[http://sources.redhat.com/automake/automake.html#Introduction](http://sources.redhat.com/automake/automake.html#Introduction)

更多的：

[http://sources.redhat.com/automake/automake.html#Why-Autotools](http://sources.redhat.com/automake/automake.html#Why-Autotools)

高温高压

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-27T14:42:45.190

我们在我的工作场所也有同样的问题。合并或签入后，Trunk 总是坏掉。

我们设置了一个[持续集成](http://en.wikipedia.org/wiki/Continuous_Integration)构建机器，它在大约 45 分钟内完成清理，而在开发机器上大约需要 2 小时。集成服务器每 2 小时轮询 SVN 存储库以获取新签入并启动清理。

这样，我们可以准确地监控构建何时被破坏并立即修复它。我们使用[Hudson](http://hudson-ci.org/)作为我们的持续集成服务器，它是免费和开源的，它是一件艺术品，而且很容易设置。加上用户界面非常直观，所有其他开发人员都喜欢它。

干杯，

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-27T16:59:53.013

解决这个问题的规范方法是让编译器自动为你生成依赖信息。像这样的东西（假设 gcc，你会想检查你的编译器是否有类似的选项）

```
SOURCES=foo.c bar.c

%.d: %.c
    $(CC) $(CFLAGS) -MM $< >$@ 

include $(SOURCES:.c=.d) 
```

GNU Make 手册有一章是关于[自动生成先决条件](http://www.gnu.org/software/make/manual/html_node/Automatic-Prerequisites.html#Automatic-Prerequisites)的。

编辑：我通常建议人们在遇到此类问题时开始使用[CMake 。](http://www.cmake.org)

# .net - 使用密钥保护 .NET 应用程序

> ID：240080
> 
> 赞同：0
> 
> 时间：2008-10-27T14:31:30.860
> 
> 标签：.net, licensing, license-key

我正需要向我的应用程序添加密钥。你们使用了哪些可能的解决方案？到目前为止，我已经查看了较早[的帖子，在我决定之前还有其他任何内容。](https://stackoverflow.com/questions/118031/best-activation-key-software-for-net-application)我的两个影响因素是：

1.  价格
2.  使用方便

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T10:28:36.553

如果您正在谈论软件保护，请花一点时间重新考虑它。

保护计划大多是浪费时间。如果 .NET 在这方面与 Java 相似，那么反编译代码并删除任何类型的保护都是微不足道的。唯一或多或少的健壮解决方案是基于网络的——这些可能非常烦人，因为您正在为您的应用程序引入一个新的故障点——如果您的身份验证服务器关闭或它们失去互联网连接会发生什么？

我知道《The Powers That Be》喜欢这种东西，但请仔细分析情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-27T14:49:37.300

[阿拉丁](http://www.aladdin.com/ "阿拉丁 HASP")

[阿拉丁软硬件方案对比图](http://www.aladdin.com/hasp/protection-keys-benefits-models.aspx "软硬件比较")

我们购买了这些密钥，它们非常易于使用，并通过它们的实用程序为您生成的示例代码。除此之外，他们是一家非常专业的公司（不，我不为他们工作，但在 2 家不同的公司中使用过他们的产品）

基本硬件密钥本身的成本约为 30 美元/小数量，但您必须购买更昂贵的“主”套件（目前我不记得成本）。

# c# - Web 应用程序时区问题

> ID：240090
> 
> 赞同：5
> 
> 时间：2008-10-27T14:33:55.257
> 
> 标签：c#, asp.net, timezone

我们在中西部（东部标准时间）的服务器上启动并运行了一个 ASP.Net 2.0 Web 应用程序。此时，我们所有的客户都与服务器处于同一时区。我们将在亚利桑那州（山区标准时间）上线另一台服务器。

我们通过 C# 代码隐藏 DateTime.UtcNow 将所有时间存储在 SQL 2005 数据库中。

在测试过程中，我们遇到了一些时区转换问题。我们的问题是，在网络浏览器中，我们的时间显示的是山区标准时间，而不是我们正在测试的时区，即东部标准时间。

当我们输入新信息时，它会以 UTC 格式存储在数据库中，但是当我们在浏览器中查看该信息时，它会显示山区标准时间。下面是从数据库中获取 UTC 值并将其显示在浏览器中的代码。

```
lblUpdatedDate.Text = Convert.ToDateTime(dr["UpdatedDate"]).ToLocalTime().ToString(); 
```

上面的代码返回服务器所在的山区标准时间，而不是运行浏览器的东部标准时间。我们如何获得时间来显示用户的位置？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-27T14:47:13.280

我遇到过同样的问题。我们将我们的应用程序卖给了与 Web 服务器处于不同时区的用户。我们没有在 UTC 中存储任何时间信息，但它实际上工作正常。服务器时区显示的时间正好落后 3 小时。我们所要做的就是添加一个时区下拉列表，以便他们可以为整个站点选择他们的时区（因为应用程序的唯一用户将在他们的时区中）。我们保存了这个设置，然后插入了一个函数来获取所有日期时间显示并使用 TimeZoneInfo 命名空间从一个时区转换到另一个时区。它完美地工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-27T14:40:16.413

到本地时间将始终在服务器端转换为物理位置。你有几个选择。

1.  将 UTC 的偏移值存储到用户，保持 UTC 时间
2.  通过 JS 进行客户端转换（我认为不优雅，也不合适）
3.  查看一些[MSDN 建议](http://msdn.microsoft.com/en-us/library/ms973825.aspx)和 Timezone 命名空间

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-27T14:38:53.843

如果您使用的是 .NET 3.5*并且*您知道用户所在的时区，那么[TimeZoneInfo](http://msdn.microsoft.com/en-us/library/system.timezoneinfo.aspx)是您的朋友。如果您不使用 .NET 3.5，则可以使用一些 P/Invoke 示例来获取[TimeZone](http://msdn.microsoft.com/en-us/library/system.timezone.aspx)的实例，但如果您可以访问 3.5，则值得避免这样做。（TimeZoneInfo 有历史数据等，通常是首选方式。）

现在确定您的用户所在的时区是一个不同的问题 - 避免混淆的最简单方法是给他们选项。（“现在”获取偏移量只会为您提供有限的信息。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-27T14:45:18.277

在使用 ASP.NET 之前，我遇到过类似的情况。这是我的一般方法。

我发送 JavaScript 来执行 document.write。JavaScript 确定客户端与 GMT 的偏移量。所以你可以发送一个特定的时间，然后让 JavaScript 对其进行加/减。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-04-27T09:14:50.817

始终将日期时间存储为 GMT 格式。

有2个步骤：

使用 Javascript 在客户端检测不同的时区：

```
var dt = new Date();
var diffInMinutes = -dt.getTimezoneOffset(); 
```

然后在服务器端，C# 代码根据上面检测到的时区偏移量将服务器时间转换为客户端时间：

```
string queryStr = Request.QueryString["diffInMinutes"];
int diffInMinutes = 0;
if (Int32.TryParse(queryStr, out diffInMinutes))
{
    clientTime = serverTime.ToUniversalTime().AddMinutes(diffInMinutes);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-27T15:03:44.027

我们遇到了相同或类似的问题，远程客户端通过 Web 服务调用我们的数据库，其中数据库和客户端位于不同的时区。

我们发现指示数据集不关心时区是最简单的方法，这样时间就不会跨时区边界改变......

我们构建了一个实用方法 (SetAllDateModes)，它按表转换数据集中的所有日期时间字段 - 这是业务端 (Foreach) 和设置 dateMode 的调用：

```
foreach (DataColumn dc in dt.Columns)
{
  if (dc.DataType == typeof(DateTime))
  {
    dc.DateTimeMode = dateMode;
  }
}
SetAllDateModes(dt, DataSetDateTime.Unspecified); 
```

DateSetDateTime.Unspecified 不包括偏移量，因此没有转换。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-27T15:13:42.790

我认为一般的想法是在向用户展示之前不要本地化日期和时间。因此，除非有人要阅读它，否则它会停留在 UTC、GMT、CUT 中。另一个注意事项使用日期/时间库，因此您不必担心夏令时时间更改问题。

# c# - 为什么在这个正则表达式中左括号被转义？

> ID：240098
> 
> 赞同：4
> 
> 时间：2008-10-27T14:35:55.283
> 
> 标签：c#, .net, regex

我正在使用此处找到的 HTML 清理白名单代码：
[http ://refactormycode.com/codes/333-sanitize-html](http://refactormycode.com/codes/333-sanitize-html)

我需要将“字体”标签添加为要匹配的附加标签，因此我尝试在`<img`标签检查 后添加此条件

```
if (tagname.StartsWith("<font"))
{
    // detailed <font> tag checking
    // Non-escaped expression (for testing in a Regex editor app)
    // ^<font(\s*size="\d{1}")?(\s*color="((#[0-9a-f]{6})|(#[0-9a-f]{3})|red|green|blue|black|white)")?(\s*face="(Arial|Courier New|Garamond|Georgia|Tahoma|Verdana)")?\s*?>$
    if (!IsMatch(tagname, @"<font
                            (\s*size=""\d{1}"")?
                            (\s*color=""((#[0-9a-f]{6})|(#[0-9a-f]{3})|red|green|blue|black|white)"")?
                            (\s*face=""(Arial|Courier New|Garamond|Georgia|Tahoma|Verdana)"")?
                             \s*?>"))
    {
        html = html.Remove(tag.Index, tag.Length);
    }
} 
```

除了上述条件之外，我的代码几乎与我链接到的页面中的代码相同。当我尝试在 C# 中对此进行测试时，它会抛出一个异常“ `Not enough )'s`”。我已经数过括号数次，并且通过一些基于 Javascript 的在线正则表达式测试器运行表达式，但似乎没有一个告诉我任何问题。

我是否在我的正则表达式中遗漏了导致括号逃逸的内容？我需要做什么来解决这个问题？

**更新**
经过大量试验和错误，我记得该`#`标志是正则表达式中的注释。解决这个问题的关键是转义`#`角色。万一其他人遇到同样的问题，我已经包含了我的修复（只是逃避`#`标志）

```
if (tagname.StartsWith("<font"))
{
    // detailed <font> tag checking
    // Non-escaped expression (for testing in a Regex editor app)
    // ^<font(\s*size="\d{1}")?(\s*color="((#[0-9a-f]{6})|(#[0-9a-f]{3})|red|green|blue|black|white)")?(\s*face="(Arial|Courier New|Garamond|Georgia|Tahoma|Verdana)")?\s*?>$
    if (!IsMatch(tagname, @"<font
                            (\s*size=""\d{1}"")?
                            (\s*color=""((\#[0-9a-f]{6})|(\#[0-9a-f]{3})|red|green|blue|black|white)"")?
                            (\s*face=""(Arial|Courier\sNew|Garamond|Georgia|Tahoma|Verdana)"")?
                             \s*?>"))
    {
        html = html.Remove(tag.Index, tag.Length);
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-27T15:05:00.607

您的 IsMatch 方法正在使用 option `RegexOptions.IgnorePatternWhitespace`，它允许您在正则表达式中添加注释，因此您必须对 #chatacter 进行转义，否则它将被解释为注释。

```
if (!IsMatch(tagname,@"<font(\s*size=""\d{1}"")?
    (\s*color=""((\#[0-9a-f]{6})|(\#[0-9a-f]{3})|red|green|blue|black|white)"")?
    (\s*face=""(Arial|Courier New|Garamond|Georgia|Tahoma|Verdana)"")?
    \s?>"))
{
    html = html.Remove(tag.Index, tag.Length);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-27T14:46:25.527

我看不出正则表达式有任何明显错误。我会尝试通过删除正则表达式的部分来隔离问题，直到问题消失，然后专注于导致问题的部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T14:49:03.947

它对我来说很好......您使用的是什么版本的 .NET 框架，*确切的*例外是什么？

另外 - 你的`IsMatch`方法是什么样的？这只是一个通行证`Regex.IsMatch`吗？

[更新] 问题是 OP 的示例代码没有显示他们正在使用 IgnorePatternWhitespace 正则表达式选项；使用此选项不起作用；没有这个选项（即显示的），代码很好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-27T15:25:53.263

下载 Chris Sells [Regex Designer](http://www.sellsbrothers.com/tools/#regexd)。它是测试 .NET 正则表达式的绝佳免费工具。

我不确定这个正则表达式是否会做你想要的，因为它取决于与你在正则表达式中的属性匹配的属性的顺序。例如，如果`face="Arial"`先行，`size="5"`则不`face=`匹配。

您的正则表达式中有一些转义问题。你需要逃避你`"`的`\` 你需要逃避你`#`的`\` 你需要`\s`在 Courier New 中使用，而不仅仅是空间。您需要使用`RegexOptions.IgnorePatternWhitespace`和`RegexOptions.IgnoreCase options`。

```
<font
(\s+size=\"\d{1}\")?
(\s+color=\"((\#[0-9a-f]{6})|(\#[0-9a-f]{3})|red|green|blue|black|white)\")?
(\s+face=\"(Arial|Courier\sNew|Garamond|Georgia|Tahoma|Verdana)\")? 
```

这些`#`字符是导致异常的原因，缺少一些具有误导性的 ) 消息。

# vb6 - ActiveX 通讯

> ID：240102
> 
> 赞同：0
> 
> 时间：2008-10-27T14:37:56.073
> 
> 标签：vb6, activex

我正在开发一个`ActiveX EXE`向第三方软件公开特定类的工具。这个第三方软件实例化了这个类的一个对象并使用它的方法。

奇怪的是，这个第三方软件一调用特定方法就破坏了我暴露的类的对象，但我不知道为什么会发生这种情况。

我唯一的线索是这个方法是唯一一个返回值的方法。所有其他的都是简单的“subs”，不返回任何值，当它们被调用时，不会发生任何错误。

我正在使用VB6。

你们知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T14:42:30.310

当最后一个对它的引用被删除时，您的对象将被“销毁”。那是正常的 COM 行为。或者您的对象是否毫无例外地死去，而第三方应用程序出现了 activex 错误？

还有一些问题：

*   我不知道您所说的“数据服务器”是什么意思？
*   您可以访问第三方应用程序的源代码吗？
*   您确定第三方应用程序包含对您的对象的引用吗？
*   您的对象是否调用了 Class_Terminate 方法？

**编辑：** 好的，当 Class_Terminate 被调用时，很明显，第三方应用程序已经放弃了对您的对象的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-27T15:47:29.647

正如 Jan 在 COM 中所说，如果没有人引用它，则终止您的对象是正常的。如果您想做某种缓存（例如保持 DB 连接打开），您可以使用在 bas-module 中定义的全局变量。

**basGlobal.bas**

```
Global AGlobalVariable As Object 
```

**连接器.cls**

```
Public Function GetFoo() As Object
  If AGlobalVariable Is Nothing then
    Set AGlobalVariable = ...
  End If 
  Set GetFoo = AGlobalVariable
End Function 
```

# asp.net - MS Reportviewer - 在 ViewState 中保存展开/折叠的节点？

> ID：240106
> 
> 赞同：1
> 
> 时间：2008-10-27T14:39:14.420
> 
> 标签：asp.net, viewstate, reportviewer

我有一个从`ObjectDataSource`. 该报告包括每个用户的可展开/可折叠节点。

我允许查看器通过`FilterExpression`在数据源上设置 来过滤报告，然后调用`ReportViewer1.LocalReport.Refresh()`. 这是在回发期间完成的。

这会过滤结果，但展开/折叠节点的状态会丢失。有没有办法在 ViewState 中存储展开/折叠的节点？或者有没有更好的方法来完全做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T21:38:16.063

我知道这个问题被问到已经有一段时间了，但是由于我最近不得不经历这个问题，所以我想与可能正在处理这个问题的人分享我的经验。

这很棘手，但如果您在报表中添加一个多值参数并且值与可切换字段中的值匹配，那么您可以在网格中编写一个组表达式（并且在标签中，这样它们也会消失）。完成后，您只需跟踪切换的内容（这很难，但可以使用 javascript）。

基本上，reportviewer 控件中有两个隐藏的子控件（vs2008 中的索引 4 和 5）具有事件名称和单击的表格单元格的 id，这样您就可以在 javascript 中构建一个数组并跟踪所有可切换字段的状态。

# user-interface - 任何用于创建“Vista 风格”网页的设计器或库？

> ID：240112
> 
> 赞同：2
> 
> 时间：2008-10-27T14:41:25.333
> 
> 标签：user-interface, windows-vista

我正在寻找一种方法来创建具有Windows Vista*酷炫样式*的网站，如此屏幕截图所示（取自 Microsoft 的一个网站）：

![微软更新目录](https://www.istartedsomething.com/wp-content/uploads/2008/08/windows7update.jpg)

有什么建议么？我更喜欢集成设计器/IDE，但库或模板也可能有所帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-27T15:15:27.230

**FYI, the answers before this were in response to a very poorly worded question. The OP did not make it clear that they were after a web page. Thanks to [Shog9](https://stackoverflow.com/users/811/shog9) for picking up the slack there.**

This is NOTHING to do with WPF or VS 2008\. Its a WEB application!

Lots of control vendors have produced some great looking controls, check out the [ASP.NET controls gallery](http://www.asp.net/Community/Control-gallery/) there is some cool stuff there. Another well-known vendor is [Telerik](http://www.telerik.com/) who have created some real nice [ASP.NET AJAX controls](http://www.telerik.com/products/aspnet-ajax/overview.aspx).

Note, this is not to promote their tools, I personally have not used them, they are popular, and it's just to give you the heads up.

In short, the look is pretty much fancy imagery. Unless [Silverlight](http://silverlight.net/) is used, which uses a subset of WPF and requires the plugin to be installed on the users browser, and requires VS2008 to create.

In terms of the screen shot, most of that is nice imagery, the buttons are probably rendered like that because you are running Vista, however, they could also be replicated without Vista. **The page you show is not a Silverlight page, so it is not a requirement.**

Have a Google for "ASP.NET vista style controls" there's tons of people after the same stuff :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T16:17:56.637

这不是使用什么软件的问题——使用你通常用来设计网站的任何软件。如果你想制作一个看起来像你在网上看到的网页，你可以很容易地获得：

1.  页面上的 HTML 标记
2.  页面使用的 CSS 样式表
3.  页面上使用的图像
4.  页面上使用的 Javascript（尽管这不太可能有用，因为在大多数情况下它会被压缩和混淆）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T14:42:14.227

“酷 Vista 样式”是使用[WPF](http://en.wikipedia.org/wiki/Windows_Presentation_Foundation)完成的，为此您需要[Visual Studio 2008](http://msdn.microsoft.com/en-us/vstudio/default.aspx)。90 天试用下载在[这里](http://msdn2.microsoft.com/vstudio/products/aa700831.aspx)。“Express Products”（免费的精简版）在[此处](http://www.microsoft.com/express/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-27T14:43:07.983

还有德尔福 2009 ;-)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-27T14:46:17.337

如前所述，Visual Studio 2008 中有基于 WPF（Windows Presentation Foundation）的开发工具。查看 WPF 应用程序的项目模板以及 WPF 浏览器应用程序和 WPF 用户控件库。所有这些都与 Vista WPF 有关。

# java - How to convert string result of enum with overridden toString() back to enum?

> ID：240122
> 
> 赞同：21
> 
> 时间：2008-10-27T14:44:24.033
> 
> 标签：java, enums, enumeration, converter

Given the following java enum:

```
public enum AgeRange {

   A18TO23 {
        public String toString() {        
            return "18 - 23";
        }
    },
   A24TO29 {
        public String toString() {        
            return "24 - 29";
        }
    },
   A30TO35 {
        public String toString() {        
            return "30 - 35";
        }
    },

} 
```

Is there any way to convert a string value of "18 - 23" to the corresponding enum value i.e. AgeRange.A18TO23 ?

Thanks!

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-10-27T14:56:20.467

The best and simplest way to do it is like this:

```
public enum AgeRange {
    A18TO23 ("18-23"),
    A24TO29 ("24-29"),
    A30TO35("30-35");

    private String value;

    AgeRange(String value){
        this.value = value;
    }

    public String toString(){
        return value;
    }

    public static AgeRange getByValue(String value){
        for (final AgeRange element : EnumSet.allOf(AgeRange.class)) {
            if (element.toString().equals(value)) {
                return element;
            }
        }
        return null;
    }
} 
```

Then you just need to invoke the `getByValue()` method with the `String` input in it.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-27T14:48:14.947

You could always create a map from string to value - do so statically so you only need to map it once, assuming that the returned string remains the same over time. There's nothing built-in as far as I'm aware.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-03-20T05:46:54.303

According to effective java (2nd ed) item 30, it can be (it is much faster than the loop)

```
public enum AgeRange {
       A18TO23("18-23"),
       A24TO29("24-29"),
       A30TO35("30-35");

       private final String value;

       AgeRange(String value){
          this.value = value;
       }

       @Override public String toString(){
           return value;
       }

       private static final Map<String, AgeRange> stringToEnum =
           new HashMap<String, AgeRange>();

       static {
           for (AgeRange r : values()) {
               stringToEnum.put(r.toString(), r);
           }
       }

       public static AgeRange getByValue(String value){
           return stringToEnum.get(value);
       }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-27T14:50:44.350

```
for (AgeRange ar: EnumSet.allOf(AgeRange)) {
    if (ar.toString().equals(inString)) {
         myAnswer = ar;
         break;
    }
} 
```

Or something like that? Just typed in, haven't run through a compiler. Forgive (comment on) typos...

Or use logic like this to build a map once. Avoid iteration at runtime. Good idea, Jon.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-27T14:54:29.550

The class overrides "toString()" - so, to get the reverse operation, you need to override `valueOf()` to translate the output of `toString()` back to the Enum values.

```
public enum AgeRange {

   A18TO23 {
        public String toString() {        
                return "18 - 23";
        }
        public AgeRange valueOf (Class enumClass, String name) {
                return A18T023
        }
    },

    .
    .
    .
} 
```

Buyer beware - uncompiled and untested...

The mechanism for `toString()` and `valueOf()` is a documented part of the [API](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Enum.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-27T15:06:31.510

You could try something like the following?

```
static AgeRange fromString(String range) {
    for (AgeRange ageRange : values()) {
        if (range.equals(ageRange.toString())) {
            return ageRange;
        }
    }
    return null;   
} 
```

Or, as others suggested, using a caching approach:

```
private static Map<String, AgeRange> map;

private static synchronized void registerAgeRange(AgeRange ageRange) {
    if (map == null) {
        map = new HashMap<String, AgeRange>();
    }
    map.put(ageRange.toString(), ageRange);
}

AgeRange() {
    registerAgeRange(this);
}

static AgeRange fromString(String range) {
    return map.get(range);
} 
```

# php - 从表单发布信息时，使用 $_REQUEST 还是 $_POST 更好？

> ID：240125
> 
> 赞同：2
> 
> 时间：2008-10-27T14:45:11.053
> 
> 标签：php

我有一个表格，用户可以输入他们的姓名，然后它将其添加到 $message 以通过电子邮件发送。

是使用`$_POST`还是更好`$_REQUEST`？

这是使用的片段`$_REQUEST`

```
$message.= "Name: ".$_REQUEST["fname"]." ".$_REQUEST["mname"]." ".$_REQUEST["lname"]."\n"; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-27T14:55:10.033

我过去的方法是对我认为是大错误的所有事情都使用**$_REQUEST**。最近，我一直在努力更加努力地将 GET 仅用于读取请求，将 POST 仅用于写入请求。

为此，我认为将**$_GET**用于 GET 请求和使用**$_POST**用于 POST 请求使我的代码中的意图更加清晰。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-27T14:51:14.190

答案是：这取决于您希望如何使用它。

如果您使用的是`$_POST`，这意味着它只能通过 POST 进入。如果您使用`$_REQUEST`，则表示您接受 POST、GET（和 COOKIE，但主要是我们感兴趣的前两个）。

对于这样的事情，`$_POST`可能会更整洁，但如果您正在制作搜索引擎，允许设置搜索 URL 可能是一个好主意。但是，您可能希望允许大量特殊参数来缩小搜索范围，如果这会占用大量 URL 空间，您可能还希望允许 POSTDATA。

正如 Dylan 提到的，请记住，两者都不能替代任何类型的安全性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T14:50:01.090

不管你用哪一个。只需确保您对表单使用某种形式的安全性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-27T15:15:45.920

我刚刚收听了[Security Now](http://www.grc.com/securitynow.htm)第 166 集，这一切都是关于跨站点请求伪造的，在其中，Steve 为使用`$_POST`表单而不是`$_REQUEST`. （间接地，他没有谈论 PHP 本身，但确实说您不应该同时接受 GET 和 POST 的表单。）原因是使用 GET 请求进行 CSRF 攻击很容易，但使用 POST 并不那么容易。

使用`$_POST`它本身并不能消除 CSRF 攻击的可能性，但它确实减少了它。Steve 还建议在请求中使用加密的强伪随机隐藏字段，以消除“盲目”请求的可能性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-27T14:52:06.950

_POST 如果数据正在某处更新（即，如果操作有副作用），否则为 _REQUEST，**如果**您不关心数据是否来自 GET、POST 或任何其他方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-27T14:55:20.017

除非您有充分的理由不这样做（例如 Michael 提到的搜索引擎），否则最好将 $_GET 和 $_POST 用于它们各自的方法而不是 $_REQUEST，以避免任何歧义或混淆可能具有相同GET 和 POST 数据中的参数名称。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-29T11:30:56.357

我唯一一次使用 $_REQUEST 是当我需要能够支持来自 $_POST 或 $_GET 的数据时。

例如，如果我有一个应该修改记录的表单，我可能最初将 url 中的记录 ID 作为 id=X 传递。因此，当第一次加载表单时，我可以使用 $_GET['id'] 来确定我们要修改的记录。

但是，当提交修改操作时，表单应该是 POST 的，因为它会改变数据并且不是幂等的。在这种情况下，在处理表单提交时，记录 ID 可以作为 $_POST['id'] 访问。

但是，如果表单提交中出现错误并且我需要重新加载表单并显示有用的错误消息，会发生什么？在这种情况下，表单生成代码需要通过查看不在 URL 中的 POSTed id 来确定要使用的记录。

在这种情况下，我会在表单显示逻辑中使用 $_REQUEST['id'] ，这样它就可以支持任何一种情况。但对于表单处理，我会使用 $_POST['id'] 进行严格检查。

# .net - 人们正在使用 Jeffrey Richter 的 PowerThreading 库中的哪些类？

> ID：240142
> 
> 赞同：1
> 
> 时间：2008-10-27T14:50:05.193
> 
> 标签：.net, multithreading, concurrency

Jeffrey Richter 正在寻找有关人们如何使用他的 PowerThreading 库的一些信息。如果有人在使用它，您使用的是它的哪些部分？他正在清理图书馆并想知道人们正在使用哪些类。

[http://www.wintellect.com/PowerThreading.aspx](http://www.wintellect.com/PowerThreading.aspx)

编辑：见[http://tech.groups.yahoo.com/group/PowerThreading/message/88](http://tech.groups.yahoo.com/group/PowerThreading/message/88)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T15:00:02.240

一个间接的答案（我自己不使用那个库）——如果我正在研究复杂的线程，我很想看看[TPL](http://msdn.microsoft.com/en-us/magazine/cc163340.aspx)在当前 CTP 中提供的内容，特别是期待 .NET 4.0。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-08T16:18:16.657

我观看了从 MSDN 新闻提要链接的视频，然后不久下载了他的库。

我真的没有机会深入了解它，但我可以告诉你，他的样品需要做*很多*工作。我花了 15 分钟的时间来弄清楚我应该构建/运行什么，然后才能真正查看示例。当我确实运行了一个示例时，我无法决定如何在我自己的项目中实现它。

如果我没有先观看[视频](http://blogs.msdn.com/charlie/archive/2008/12/03/jeff-richter-video-on-asynchronous-programming-and-his-power-threading-library.aspx)，我将不知道他的图书馆做了什么或它有多强大。

# oop - 为什么我要使用接口？

> ID：240152
> 
> 赞同：77
> 
> 时间：2008-10-27T14:51:29.120
> 
> 标签：oop, interface

我知道他们强迫您实施方法等，但我不明白您为什么要使用它们。谁能给我一个很好的例子或解释我为什么要实现这个。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2008-10-27T14:56:05.773

**一个具体的例子：**接口是一种指定其他人的代码必须满足的契约的好方法。

如果我正在编写代码库，我可能会编写对具有特定行为集的对象有效的代码。最好的解决方案是在接口中指定这些行为（没有实现，只是描述），然后在我的库代码中使用对实现该接口的对象的引用。

然后任何随机的人都可以出现，创建一个实现该接口的类，实例化该类的一个对象并将其传递给我的库代码并期望它能够工作。*注意：当然可以严格实现一个接口而忽略接口的意图，所以仅仅实现一个接口并不能保证事情会成功。笨蛋总有办法！:-)*

**另一个具体的例子：**两个团队在必须合作的不同组件上工作。如果两个团队在第一天坐下来就一组接口达成一致，那么他们就可以分道扬镳，围绕这些接口实现他们的组件。团队 A 可以构建测试工具来模拟团队 B 的组件进行测试，反之亦然。并行开发，错误更少。

关键是接口提供了一个**抽象**层，这样您就可以编写忽略不必要细节的代码。

**大多数教科书中使用的典型示例**是排序例程。只要您有比较任意两个对象的方法，您就可以对任何类别的对象进行排序。因此，您可以通过实现接口来使任何类可排序`IComparable`，这迫使您实现一个比较两个实例的方法。所有的排序例程都是为了处理对 IComparable 对象的引用而编写的，因此一旦实现了 IComparable，您就可以在类的对象集合上使用这些排序例程中的任何一个。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-27T14:57:48.500

接口定义了**契约**，这是关键词。

当您需要在程序中定义契约时，您会使用接口，但您并不真正关心满足该契约的类的其余属性，只要它确实如此。

那么，让我们看一个例子。假设您有一个方法可以提供对列表进行排序的功能。首先..什么是清单？你真的关心它包含哪些元素来对列表进行排序吗？您的答案应该是否定的......在.NET（例如）中，您有一个名为 IList 的接口，它定义了列表必须支持的操作，因此您不必关心表面下的实际细节。

回到这个例子，你并不真正知道列表中对象的类别……你也不在乎。如果您可以只比较对象，则不妨对它们进行排序。所以你声明了一份合同：

```
interface IComparable
{
  // Return -1 if this is less than CompareWith
  // Return 0 if object are equal
  // Return 1 if CompareWith is less than this
  int Compare(object CompareWith);
} 
```

该合同指定必须实现接受对象并返回 int 的方法才能进行比较。现在你已经定义了一个契约，现在你不关心对象本身，而是关心**契约**，所以你可以这样做：

```
IComparable comp1 = list.GetItem(i) as IComparable;

if (comp1.Compare(list.GetItem(i+1)) < 0)
  swapItem(list,i, i+1) 
```

PS：我知道这些例子有点天真，但它们是例子......

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-27T14:58:11.213

一个典型的例子是插件架构。开发人员 A 编写主应用程序，并希望确保开发人员 B、C 和 D 编写的所有插件都符合他的应用程序对它们的期望。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-02-29T08:16:10.383

理解接口的最简单方法是它们允许不同的对象公开 COMMON 功能。这允许程序员编写更简单、更短的代码来编程到接口，然后只要对象实现了该接口，它就可以工作。

**示例 1：** 有许多不同的数据库提供程序，MySQL、MSSQL、Oracle 等。但是所有数据库对象都可以做相同的事情，因此您会发现许多数据库对象的接口。如果一个对象实现了 IDBConnection，那么它将公开方法 Open() 和 Close()。因此，如果我希望我的程序与数据库提供者无关，我会针对接口而不是针对特定提供者进行编程。

```
IDbConnection connection = GetDatabaseConnectionFromConfig()
connection.Open()
// do stuff
connection.Close() 
```

通过对接口（IDbconnection）进行编程来查看我现在可以在我的配置中交换任何数据提供程序，但我的代码保持完全相同。这种灵活性非常有用且易于维护。这样做的缺点是我只能执行“通用”数据库操作，并且可能无法充分利用每个特定提供商提供的优势，因此在编程中的所有内容都需要权衡取舍，您必须确定哪种方案对您最有利。

**示例 2：** 如果您注意到几乎所有集合都实现了这个称为 IEnumerable 的接口。IEnumerable 返回具有 MoveNext()、Current 和 Reset() 的 IEnumerator。这使 C# 可以轻松地在您的集合中移动。它可以这样做的原因是因为它公开了 IEnumerable 接口，它知道该对象公开了它需要通过它的方法。这有两件事。1) foreach 循环现在将知道如何枚举集合 2) 您现在可以将强大的 LINQ 表达式应用于您的集合。同样，接口在这里如此有用的原因是因为所有集合在 COMMON 中都有一些东西，它们可以被移动。每个集合可以通过不同的方式移动（链表与数组），但接口的美妙之处在于实现是隐藏的，与接口的使用者无关。MoveNext() 为您提供集合中的下一个项目，不管它是如何做到的。很不错吧？

**示例 3：** 当您设计自己的界面时，您只需问自己一个问题。这些东西有什么共同点？一旦你找到了对象共享的所有东西，你就可以将这些属性/方法抽象到一个接口中，以便每个对象都可以从它继承。然后，您可以使用一个接口对多个对象进行编程。

当然，我必须给出我最喜欢的 C++ 多态示例，动物示例。所有动物都具有某些特征。可以说他们可以移动，说话，而且他们都有一个名字。因为我刚刚确定了我所有动物的共同点，我可以将这些特性抽象到 IAnimal 接口中。然后我创建了一个 Bear 对象、一个 Owl 对象和一个 Snake 对象，它们都实现了这个接口。您可以将实现相同接口的不同对象存储在一起的原因是因为接口表示 IS-A 关系。熊是动物，猫头鹰是动物，所以我可以将它们全部收集为动物。

```
var animals = new IAnimal[] = {new Bear(), new Owl(), new Snake()} // here I can collect different objects in a single collection because they inherit from the same interface

foreach (IAnimal animal in animals) 
{
    Console.WriteLine(animal.Name)
    animal.Speak() // a bear growls, a owl hoots, and a snake hisses
    animal.Move() // bear runs, owl flys, snake slithers
} 
```

您可以看到，即使这些动物以不同的方式执行每个动作，我也可以在一个统一的模型中针对它们进行编程，这只是接口的众多好处之一。

因此，接口最重要的一点是对象的共同点，以便您可以以相同的方式针对不同的对象进行编程。节省时间，创建更灵活的应用程序，隐藏复杂性/实现，模拟现实世界的对象/情况，以及许多其他好处。

希望这可以帮助。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-27T15:04:05.773

The pedals on a car implement an interface. I'm from the US where we drive on the right side of the road. Our steering wheels are on the left side of the car. The pedals for a manual transmission from left to right are clutch -> brake -> accelerator. When I went to Ireland, the driving is reversed. Cars' steering wheels are on the right and they drive on the left side of the road... but the pedals, ah the pedals... they implemented the same interface... all three pedals were in the same order... so even if the class was different and the network that class operated on was different, i was still comfortable with the pedal interface. My brain was able to call my muscles on this car just like every other car.

Think of the numerous non-programming interfaces we can't live without. Then answer your own question.

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-02-29T08:22:13.743

```
When you need different classes to share same methods you use Interfaces. 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-27T14:52:28.527

在期望充分利用多态性的面向对象系统中，接口是绝对必要的。

一个经典的例子可能是 IVehicle，它有一个 Move() 方法。您可以拥有实现 IVehicle 的 Car、Bike 和 Tank 类。它们都可以 Move()，而且你可以编写不关心它正在处理什么样的车辆的代码，这样它就可以 Move()。

```
void MoveAVehicle(IVehicle vehicle)
{
    vehicle.Move();
} 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-10-27T14:58:07.983

接口是多态的一种形式。一个例子：

假设您想编写一些日志记录代码。日志记录将转到某个地方（可能是文件，或者运行主要代码的设备上的串行端口，或者是套接字，或者像 /dev/null 一样被丢弃）。您不知道在哪里：您的日志记录代码的用户需要自由地确定这一点。事实上，您的日志记录代码并不关心。它只想要可以写入字节的东西。

因此，您发明了一个名为“可以写入字节的东西”的接口。日志代码被赋予了这个接口的一个实例（也许在运行时，也许在编译时配置。它仍然是多态性，只是不同的种类）。您编写一个或多个实现该接口的类，只需更改日志代码将使用哪一个，您就可以轻松地更改日志的去向。其他人可以通过编写自己的接口实现来更改日志记录的位置，而无需更改您的代码。这基本上就是多态性的含义——对一个对象的了解足以以一种特定的方式使用它，同时允许它在你不需要知道的所有方面发生变化。一个界面描述了你需要知道的事情。

C 的文件描述符基本上是一个接口“我可以读取和/或写入字节和/或写入的东西”，几乎每种类型的语言都有这样的接口潜伏在其标准库中：流或其他任何东西。无类型语言通常具有表示流的非正式类型（可能称为协定）。所以在实践中，您几乎不必自己实际发明这个特定的界面：您使用语言提供给您的东西。

日志和流只是一个例子——只要你可以用抽象的术语描述一个对象应该做什么，但又不想将它与特定的实现/类/任何东西联系起来，就会出现接口。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-27T14:52:04.987

这样做的原因有很多。当您使用接口时，您就可以在将来需要重构/重写代码时做好准备。您还可以为简单的操作提供一种标准化的 API。

例如，如果你想编写一个类似快速排序的排序算法，你只需要对任何对象列表进行排序，就可以成功地比较两个对象。如果你创建一个接口，比如 ISortable，那么任何创建对象的人都可以实现 ISortable 接口，并且他们可以使用你的排序代码。

如果您正在编写使用数据库存储的代码，并且写入存储接口，则可以替换该代码。

接口鼓励代码的松散耦合，以便您可以拥有更大的灵活性。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-10-27T15:15:26.140

Imagine the following basic interface which defines a basic CRUD mechanism:

```
interface Storable {
    function create($data);
    function read($id);
    function update($data, $id);
    function delete($id);
} 
```

From this interface, you can tell that any object that implements it, must have functionality to create, read, update and delete data. This could by a database connection, a CSV file reader, and XML file reader, or any other kind of mechanism that might want to use CRUD operations.

Thus, you could now have something like the following:

```
class Logger {
    Storable storage;

    function Logger(Storable storage) {
        this.storage = storage;
    }

    function writeLogEntry() {
        this.storage.create("I am a log entry");
    }
} 
```

This logger doesn't care if you pass in a database connection, or something that manipulates files on disk. All it needs to know is that it can call create() on it, and it'll work as expected.

The next question to arise from this then is, if databases and CSV files, etc, can all store data, shouldn't they be inherited from a generic Storable object and thus do away with the need for interfaces? The answer to this is no... not every database connection might implement CRUD operations, and the same applies to every file reader.

Interfaces define what the object is capable of doing and how you need to use it... not what it is!

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-27T15:10:27.773

In an article in my blog I briefly describe three purposes interfaces have.

> Interfaces may have different purposes:
> 
> *   Provide different implementations for the same goal. The typical example is a list, which may have different implementations for different performance use cases (LinkedList, ArrayList, etc.).
> *   Allow criteria modification. For example, a sort function may accept a Comparable interface in order to provide any kind of sort criteria, based on the same algorithm.
> *   Hide implementation details. This also makes it easier for a user to read the comments, since in the body of the interface there are only methods, fields and comments, no long chunks of code to skip.

Here's the article's full text: [http://weblogs.manas.com.ar/ary/2007/11/](http://weblogs.manas.com.ar/ary/2007/11/)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-10-29T03:03:03.433

我见过的最好的 Java 代码几乎将所有对象引用都定义为接口的实例而不是类的实例。这是为灵活性和变化而设计的质量代码的强烈标志。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-27T16:39:56.733

我认为你需要对设计模式有一个很好的理解，这样才能看到力量。

查看 [Head First 设计模式](https://rads.stackoverflow.com/amzn/click/com/0596007124)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-10-27T14:56:15.633

正如您所指出的，当您想强制某人以某种格式制作时，界面很有用。

当数据不是某种格式可能意味着在代码中做出危险的假设时，接口是好的。

例如，目前我正在编写一个将数据从一种格式转换为另一种格式的应用程序。我想强迫他们把这些字段放进去，这样我就*知道*它们会存在并且有更大的机会被正确实施。我不在乎是否会出现另一个版本并且它不会为他们编译，因为无论如何它更有可能需要数据。

因此很少使用接口，因为通常您可以做出假设，或者*不需要*数据来完成您需要做的事情。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-10-27T14:57:24.227

接口，仅定义*接口*。稍后，您可以定义方法（在其他类上），它接受接口作为参数（或更准确地说，实现该接口的对象）。通过这种方式，您的方法可以对各种各样的对象进行操作，它们唯一的共同点是它们实现了该接口。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-10-27T14:57:32.463

首先，它们为您提供了**额外的抽象层。**您可以说“对于此函数，此参数必须是具有这些方法和这些参数的对象”。而且您可能还想以某种抽象的术语设置这些方法的含义，同时允许您对代码进行推理。在**鸭式**语言中，您可以免费获得。不需要显式的语法“接口”。然而，您可能仍会创建一组**概念接口，**例如合同（如在合同设计中）。

此外，接口有时用于不太“纯粹”的目的。在 Java 中，它们可用于模拟多重继承。在 C++ 中，您可以使用它们来减少编译时间。

通常，它们减少了代码中的耦合。这是好事。

您的代码也可能更容易以这种方式进行测试。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-10-27T14:58:35.813

假设您想跟踪一组东西。所述集合必须支持一堆事情，例如添加和删除项目，以及检查项目是否在集合中。

然后，您可以使用 add()、remove() 和 contains() 方法指定接口 ICollection。

不需要知道哪种集合（列表、数组、哈希表、红黑树等）的代码可以接受实现接口的对象并在不知道它们的实际类型的情况下使用它们。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-10-27T15:02:47.693

In .Net, I create base classes and inherit from them when the classes are somehow related. For example, base class Person could be inherited by Employee and Customer. Person might have common properties like address fields, name, telephone, and so forth. Employee might have its own department property. Customer has other exclusive properties.

Since a class can only inherit from one other class in .Net, I use interfaces for additional shared functionality. Sometimes interfaces are shared by classes that are otherwise unrelated. Using an interface creates a contract that developers will know is shared by all of the other classes implementing it. I also forces those classes to implement all of its members.

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-10-27T15:47:11.677

在 C# 中，接口对于允许不共享相同基类的类的多态性也非常有用。这意味着，由于我们不能拥有多重继承，因此您可以使用接口来允许使用不同的类型。这也是一种允许您公开私有成员以供在没有反射的情况下使用（显式实现）的方法，因此它是实现功能同时保持对象模型清洁的好方法。

例如：

```
public interface IExample
{
    void Foo();
}

public class Example : IExample
{
    // explicit implementation syntax
    void IExample.Foo() { ... }
}

/* Usage */
Example e = new Example();

e.Foo(); // error, Foo does not exist

((IExample)e).Foo(); // success 
```

# .net - 当依赖属性发生变化时，是否有通知机制？

> ID：240156
> 
> 赞同：2
> 
> 时间：2008-10-27T14:51:49.103
> 
> 标签：.net, silverlight, silverlight-2.0, dependency-properties

在 Silverlight 应用程序中，我试图找出用户控件上的属性何时发生更改。我对一个特定的 DependencyProperty 感兴趣，但不幸的是，控件本身并没有实现 INotifyPropertyChanged。

有没有其他方法可以确定值是否已更改？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-12-02T18:59:10.397

你可以。至少我做到了。还是需要看利弊。

```
 /// Listen for change of the dependency property
    public void RegisterForNotification(string propertyName, FrameworkElement element, PropertyChangedCallback callback)
    {

        //Bind to a depedency property
        Binding b = new Binding(propertyName) { Source = element };
        var prop = System.Windows.DependencyProperty.RegisterAttached(
            "ListenAttached"+propertyName,
            typeof(object),
            typeof(UserControl),
            new System.Windows.PropertyMetadata(callback));

        element.SetBinding(prop, b);
    } 
```

现在，您可以调用 RegisterForNotification 来注册元素属性的更改通知，例如 .

```
RegisterForNotification("Text", this.txtMain,(d,e)=>MessageBox.Show("Text changed"));
            RegisterForNotification("Value", this.sliderMain, (d, e) => MessageBox.Show("Value changed")); 
```

在同一[http://amazedsaint.blogspot.com/2009/12/silverlight-listening-to-dependency.html上查看我的帖子](http://amazedsaint.blogspot.com/2009/12/silverlight-listening-to-dependency.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-27T15:05:47.547

在 WPF 中有[DependencyPropertyDescriptor.AddValueChanged](http://msdn.microsoft.com/en-us/library/system.componentmodel.dependencypropertydescriptor.addvaluechanged.aspx)，但不幸的是在 Silverlight 中没有这样的东西。所以答案是否定的。

也许如果你解释你想做什么，你可以解决这种情况，或者使用绑定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T13:11:51.187

正如 Jon Galloway 在另一个线程上发布的那样，您也许可以使用 Wea​​kReference 之类的东西来包装您感兴趣的属性并在您自己的类中重新注册它们。这是 WPF 代码，但该概念不依赖于 DependencyPropertyDescriptor。

[文章链接](http://agsmith.wordpress.com/2008/04/07/propertydescriptor-addvaluechanged-alternative/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T21:56:49.167

查看以下链接。它展示了如何在没有 DependencyPropertyDescriptor.AddValueChanged 的​​ silverlight 中解决问题

[http://themechanicalbride.blogspot.com/2008/10/building-observable-model-in.html](http://themechanicalbride.blogspot.com/2008/10/building-observable-model-in.html)

# android - 安卓应用部署

> ID：240161
> 
> 赞同：9
> 
> 时间：2008-10-27T14:52:45.140
> 
> 标签：android, deployment

> **可能重复：**
> [如何在不发布和 Eclipse 的情况下在真实设备上安装应用程序？](https://stackoverflow.com/questions/2084745/how-to-install-the-application-on-real-device-without-publishing-and-eclipse)

除了 Android Marketplace，我还有哪些选择可以远程部署 Android 应用程序？

我遇到的特殊问题是我有一个我写的应用程序，它为我的妹妹解决了一个有限的问题。她主要是计算机知识，但不是开发人员，并且住在几个小时之外。

如果一家公司想要为其闪亮的新 G1 开发应用程序然后部署他们的应用程序，我可以看到同样的问题很常见。当然，有一种非以开发人员为中心的方法可以做到这一点。

# java - 损坏的表单数据：提前结束

> ID：240163
> 
> 赞同：0
> 
> 时间：2008-10-27T14:53:06.217
> 
> 标签：java, actionscript-3, apache-flex

我正在尝试使用 FileReference 类上传文件。>2MB 的文件都可以正常工作，但 <2MB 的文件会导致此错误：

> “java.io.IOException：损坏的表单数据：过早结束”

在服务器上，我使用 com.oreilly.servlet 包来处理请求。

我已经多次使用这个包来成功处理来自 flex 的文件上传，但由于某种原因，现在我遇到了这个问题。

这是有关更多信息的堆栈跟踪：

```
java.io.IOException: Corrupt form data: premature ending
    at com.oreilly.servlet.multipart.MultipartParser.<init>(MultipartParser.java:205)
    at com.oreilly.servlet.MultipartRequest.<init>(MultipartRequest.java:222)
    at com.oreilly.servlet.MultipartRequest.<init>(MultipartRequest.java:173)
    at com.mydomain.FileUploadServlet.doPost(FileUploadServlet.java:46)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:710)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:269)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)
    at org.apache.struts2.dispatcher.ActionContextCleanUp.doFilter(ActionContextCleanUp.java:99)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:215)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)
    at org.apache.struts2.dispatcher.FilterDispatcher.doFilter(FilterDispatcher.java:414)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:215)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-27T16:05:31.030

[http://www.servlets.com/cos/faq.html](http://www.servlets.com/cos/faq.html)

***为什么在使用 com.oreilly.servlet.MultipartRequest 或 MultipartParser 时大型上传会失败？*** *这些类本身专门设计为没有最大上传大小限制（与大多数其他文件上传实用程序不同），但为了保护您的服务器，构造函数允许您设置最大 POST 大小以接受。任何大于限制的上传都会停止。默认最大值为 1 兆。有关服务器在通知客户端错误时遇到的困难的讨论，请参见 Java Servlet Programming, 2nd Edition, page 119 中的讨论。*

那么，您是否指定了要接受的最大 POST 大小？

PS 好的，现在我发现是小型上传导致了问题。在上面的常见问题解答链接中，有一个部分专门用于解决上传问题，包括一些有用的方法来隔离原因（客户端、浏览器、Web 服务器、库）。试试看。

安装显示发送到服务器的请求的 Firefox 插件（Tamper Data 或 Firebug）。可以帮助您了解 <2M 和 >2M 上传之间是否有任何不同。

PPS 文件的结构是否相同？会不会是较小的具有破坏 Flash 库的不同数据（例如特殊符号）？例如，尝试仅上传空间的小文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-27T18:05:35.640

@弗拉基米尔：

我使用了一个 http 嗅探器来检查发布请求，它正在发送整个文件并且发布请求格式是正确的。我尝试了许多 <2MB 的不同文件（.jpg、.mp3 等），但没有一个文件有效。

最大帖子大小设置为 1.5GB。

这是发布请求的内容：

```
------------cH2ae0ei4ae0cH2ae0Ef1KM7gL6GI3
Content-Disposition: form-data; name="Filename"

IMG0001.jpg
------------cH2ae0ei4ae0cH2ae0Ef1KM7gL6GI3
Content-Disposition: form-data; name="Filedata"; filename="IMG0001.jpg"
Content-Type: application/octet-stream

<file data here>
------------cH2ae0ei4ae0cH2ae0Ef1KM7gL6GI3
Content-Disposition: form-data; name="Upload"

Submit Query
------------cH2ae0ei4ae0cH2ae0Ef1KM7gL6GI3-- 
```

我已经确认这是一个服务器端问题，因为我使用常规 html 表单测试了 servlet，并且得到了相同的结果。

还有其他想法吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-23T03:37:38.117

原因是请求是使用“Transfer Encoding: chunked”标头发送的，而不是 Content-length 标头。许多服务器不理解分块内容，o'reilly 也不理解。如果您的请求是使用传输编码标头发送的，请使用嗅探器检查。我不知道有什么解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-28T11:33:54.027

一起使用 com.orielly.servlet.MultipartRequest 类和 org.apache.struts2.dispatcher.ActionContextCleanUp 过滤器时似乎存在一个错误。这就是导致小文件上传失败的原因。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-19T06:24:19.097

如果您不使用结构，则可以通过从项目的库中删除结构库来解决。

# java - 当地址正常时使用 javax.mail 获取无效地址

> ID：240166
> 
> 赞同：7
> 
> 时间：2008-10-27T14:55:03.327
> 
> 标签：java, email

我正在使用 javax.mail 系统，并且遇到“无效地址”异常的问题。这是代码的基础知识：

```
 // Get system properties
    Properties props = System.getProperties();

    // Setup mail server
    props.put("mail.smtp.host", m_sending_host);

    // Get session
    Session session = Session.getDefaultInstance(props, new Authenticator(){
        @Override
        protected PasswordAuthentication getPasswordAuthentication() {
            return new PasswordAuthentication(m_sending_user, m_sending_pass);
        }
    });

    // Define message
    MimeMessage message = new MimeMessage(session);
    message.setFrom(new InternetAddress(m_sending_from));
    message.addRecipient(Message.RecipientType.TO, 
        new InternetAddress(vcea.get(i).emailaddr));
    message.setSubject( replaceEnvVars(subject) );
    message.setText(replaceEnvVars(body));

    // Send message
    try {
        Transport.send(message);
    } catch (Exception e){
        Log.Error("Error sending e-mail to addr (%s): %s",
                vcea.get(i).emailaddr, e.getLocalizedMessage() );

    } 
```

问题是上面的代码有时确实有效。但是对于一些我知道有效的电子邮件地址（因为我可以通过标准电子邮件客户端发送给他们），上面的代码在尝试发送时会抛出“无效地址”异常。

任何线索或提示将不胜感激。

--更新：身份验证问题。

好的，这就是我发现的情况。接收电子邮件时，上面的代码正确设置了身份验证，并且实际调用了 Authenticator.getPasswordAuthentication() 回调。

发送电子邮件时并非如此。你必须做更多的事情。添加这个：

```
 // Setup mail server
    props.put("mail.smtp.host", m_sending_host);
    props.put("mail.smtp.auth", "true"); 
```

这将强制 javax.mail API 进行登录验证。然后使用实际的 Transport 实例而不是静态的 .send() 方法：

```
 Transport t = session.getTransport(m_sending_protocol);
    t.connect(m_sending_user, m_sending_pass); 
```

...

```
 // Send message
        try {
            t.sendMessage(message, message.getAllRecipients());
        } catch (Exception e){ 
```

在不强制进行身份验证的情况下，邮件服务器将我视为未经授权的中继，然后将我关闭。“有效”的地址和无效的地址之间的区别在于，“有效”的地址都是邮件服务器的本地地址。因此，它只是接受了他们。但是对于任何非本地“中继”地址，它会拒绝该消息，因为我认为 javax.mail API 没有提供我的身份验证信息。

感谢您提供提示我查看邮件服务器端的线索。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-27T16:16:19.090

--更新：身份验证问题。

好的，这就是我发现的情况。接收电子邮件时，上面的代码正确设置了身份验证，并且实际调用了 Authenticator.getPasswordAuthentication() 回调。

发送电子邮件时并非如此。你必须做更多的事情。添加这个：

```
// Setup mail server
props.put("mail.smtp.host", m_sending_host);
props.put("mail.smtp.auth", "true"); 
```

这将强制 javax.mail API 进行登录验证。然后使用实际的 Transport 实例而不是静态的 .send() 方法：

```
Transport t = session.getTransport(m_sending_protocol);
t.connect(m_sending_user, m_sending_pass); 
```

...

```
 // Send message
    try {
        t.sendMessage(message, message.getAllRecipients());
    } catch (Exception e){ 
```

在不强制进行身份验证的情况下，邮件服务器将我视为未经授权的中继，然后将我关闭。“有效”的地址和无效的地址之间的区别在于，“有效”的地址都是邮件服务器的本地地址。因此，它只是接受了他们。但是对于任何非本地“中继”地址，它会拒绝该消息，因为我认为 javax.mail API 没有提供我的身份验证信息。

感谢您提供提示我查看邮件服务器端的线索。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-27T15:26:17.990

我会更改对 InternetAddress 的调用以使用“严格”解释，看看您是否在遇到问题的地址上遇到更多错误。

```
message.addRecipient(Message.RecipientType.TO, 
        new InternetAddress(vcea.get(i).emailaddr, true ));
//                                                 ^^^^ turns on strict interpretation 
```

[InternetAddress 构造函数的 Javadoc](http://java.sun.com/products/javamail/javadocs/javax/mail/internet/InternetAddress.html#InternetAddress(java.lang.String,%20boolean))

如果这失败了，它会抛出一个`AddressException`which 有一个调用的方法`getPos()`返回失败的位置（[Javadoc](http://java.sun.com/products/javamail/javadocs/javax/mail/internet/AddressException.html#getPos())）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T15:03:53.293

试试这个：

```
String to="stackoverflow@so.com";
String cc="one@mail.com,two@mail.com"; //The separator ',' works good

message.setRecipients(Message.RecipientType.TO,new InternetAddress[] { 
new InternetAddress(to) }); // This is only one mail

InternetAddress[] addr = parseAddressList(cc); //Here add all the rest of the mails
message.setRecipients(Message.RecipientType.CC,addr); 
```

对不起我的英语不好。这样不好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-07-29T09:41:48.480

对于那些在 smtp 配置中使用 ssl 加密的人来说，这是一个很好的提示，您应该通过指定 property 来启用它`mail.smtp.ssl.enable`，如下所示：

```
props.put("mail.smtp.ssl.enable", "true"); 
```

否则可能会导致与上述类似的问题。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-27T21:29:22.703

在我看来，这就像我工作中发生的一个问题。如果您正在显示的代码是并发的，那么直接使用 System.getProperties 可能会出现问题，因为您放在它们上的主机值可能会被下一个请求覆盖，同时仍然保留用户和密码来自被覆盖的主机。

在我们的例子中，我们使用 System.getProperties() 哈希表的克隆解决了这个问题。

希望有所帮助（这个问题真的很难追踪）。

# c# - 从 C# 启动应用程序 (.EXE)？

> ID：240171
> 
> 赞同：182
> 
> 时间：2008-10-27T14:55:38.113
> 
> 标签：c#, .net, windows-vista, windows-xp

如何使用 C# 启动应用程序？

要求：必须在[Windows XP](http://en.wikipedia.org/wiki/Windows_XP)和[Windows Vista](http://en.wikipedia.org/wiki/Windows_Vista)上工作。

我从 DinnerNow.net 采样器中看到了一个仅适用于 Windows Vista 的示例。

* * *

## 回答 #1

> 赞同：236
> 
> 时间：2008-10-27T16:55:15.890

这是一段有用的代码：

```
using System.Diagnostics;

// Prepare the process to run
ProcessStartInfo start = new ProcessStartInfo();
// Enter in the command line arguments, everything you would enter after the executable name itself
start.Arguments = arguments; 
// Enter the executable to run, including the complete path
start.FileName = ExeName;
// Do you want to show a console window?
start.WindowStyle = ProcessWindowStyle.Hidden;
start.CreateNoWindow = true;
int exitCode;

// Run the external process & wait for it to finish
using (Process proc = Process.Start(start))
{
     proc.WaitForExit();

     // Retrieve the app's exit code
     exitCode = proc.ExitCode;
} 
```

您可以使用这些对象做更多事情，您应该阅读文档：[ProcessStartInfo](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.aspx)，[Process](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.aspx)。

* * *

## 回答 #2

> 赞同：182
> 
> 时间：2008-10-27T14:58:40.480

使用[`System.Diagnostics.Process.Start()`](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.start.aspx)方法。

查看[这篇文章](http://www.codeproject.com/KB/cs/start_an_external_app.aspx)，了解如何使用它。

```
Process.Start("notepad", "readme.txt");

string winpath = Environment.GetEnvironmentVariable("windir");
string path = System.IO.Path.GetDirectoryName(
              System.Windows.Forms.Application.ExecutablePath);

Process.Start(winpath + @"\Microsoft.NET\Framework\v1.0.3705\Installutil.exe",
path + "\\MyService.exe"); 
```

* * *

## 回答 #3

> 赞同：62
> 
> 时间：2008-10-27T14:58:35.767

```
System.Diagnostics.Process.Start("PathToExe.exe"); 
```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2009-10-13T06:30:33.100

```
System.Diagnostics.Process.Start( @"C:\Windows\System32\Notepad.exe" ); 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2014-06-03T21:23:45.110

如果您像我一样在使用 System.Diagnostics 时遇到问题，请使用以下简单代码，在没有它的情况下也可以使用：

```
using System.Diagnostics;

Process notePad = new Process();
notePad.StartInfo.FileName   = "notepad.exe";
notePad.StartInfo.Arguments = "mytextfile.txt";
notePad.Start(); 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-10-27T16:22:52.947

此外，如果可能，您将希望为您的路径使用环境变量：[http ://en.wikipedia.org/wiki/Environment_variable#Default_Values_on_Microsoft_Windows](http://en.wikipedia.org/wiki/Environment_variable#Default_Values_on_Microsoft_Windows)

例如

*   %WINDIR% = Windows 目录
*   %APPDATA% = 应用程序数据 - 在 Vista 和 XP 之间变化很大。

还有更多查看链接以获得更长的列表。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2016-04-15T01:33:33.510

只需将您的 file.exe 放入 \bin\Debug 文件夹并使用：

```
Process.Start("File.exe"); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-08-27T03:38:43.513

使用**Process.Start**启动一个进程。

```
using System.Diagnostics;
class Program
{
    static void Main()
    {
    //
    // your code
    //
    Process.Start("C:\\process.exe");
    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-06-07T17:35:36.093

试试这个：

```
Process.Start("Location Of File.exe"); 
```

（确保使用 System.Diagnostics 库）

# python - 列表更改意外地反映在子列表中

> ID：240178
> 
> 赞同：846
> 
> 时间：2008-10-27T14:57:22.883
> 
> 标签：python, list, nested-lists, mutable

我需要在 Python 中创建一个列表列表，所以我输入了以下内容：

```
my_list = [[1] * 4] * 3 
```

该列表如下所示：

```
[[1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1]] 
```

然后我更改了最里面的值之一：

```
my_list[0][0] = 5 
```

现在我的列表如下所示：

```
[[5, 1, 1, 1], [5, 1, 1, 1], [5, 1, 1, 1]] 
```

这不是我想要或期望的。有人可以解释发生了什么，以及如何解决它吗？

* * *

## 回答 #1

> 赞同：718
> 
> 时间：2008-10-27T15:03:30.080

当你写的时候`[x]*3`，你基本上得到了 list `[x, x, x]`。也就是说，一个包含 3 个引用的列表`x`。然后，当您修改此单曲`x`时，可以通过对它的所有三个引用看到它：

```
x = [1] * 4
l = [x] * 3
print(f"id(x): {id(x)}")
# id(x): 140560897920048
print(
    f"id(l[0]): {id(l[0])}\n"
    f"id(l[1]): {id(l[1])}\n"
    f"id(l[2]): {id(l[2])}"
)
# id(l[0]): 140560897920048
# id(l[1]): 140560897920048
# id(l[2]): 140560897920048

x[0] = 42
print(f"x: {x}")
# x: [42, 1, 1, 1]
print(f"l: {l}")
# l: [[42, 1, 1, 1], [42, 1, 1, 1], [42, 1, 1, 1]] 
```

要修复它，您需要确保在每个位置创建一个新列表。一种方法是

```
[[1]*4 for _ in range(3)] 
```

它将`[1]*4`每次重新评估，而不是评估一次并对 1 个列表进行 3 次引用。

* * *

您可能想知道为什么`*`不能像列表推导式那样制作独立对象。那是因为乘法运算符`*`对对象进行操作，而没有看到表达式。当您使用`*`乘以`[[1] * 4]`3 时，`*`只会看到 1 元素列表的`[[1] * 4]`计算结果，而不是`[[1] * 4`表达式文本。`*`不知道如何复制该元素，不知道如何重新评估`[[1] * 4]`，甚至不知道您甚至想要副本，而且通常甚至可能没有复制元素的方法。

唯一的选择`*`是对现有子列表进行新的引用，而不是尝试创建新的子列表。其他任何事情都会不一致或需要对基本语言设计决策进行重大重新设计。

相反，列表推导式在每次迭代时重新评估元素表达式。每次都`[[1] * 4 for n in range(3)]`重新评估，因为同样的原因每次都重新评估。的每次评估都会生成一个新列表，因此列表推导可以满足您的要求。`[1] * 4``[x**2 for x in range(3)]``x**2``[1] * 4`

顺便说一句，`[1] * 4`也不会复制 的元素`[1]`，但这没关系，因为整数是不可变的。你不能做类似`1.value = 2`把 1 变成 2 的事情。

* * *

## 回答 #2

> 赞同：162
> 
> 时间：2013-08-26T23:17:52.037

```
size = 3
matrix_surprise = [[0] * size] * size
matrix = [[0]*size for _ in range(size)] 
```

使用 Python Tutor 进行[实时可视化：](http://pythontutor.com/visualize.html#code=size%20%3D%203%0Amatrix_surprise%20%3D%20%5B%5B0%5D%20*%20size%5D%20*%20size%0Amatrix%20%3D%20%5B%5B0%5D*size%20for%20_%20in%20range%28size%29%5D&cumulative=false&curInstr=9&heapPrimitives=false&mode=display&origin=opt-frontend.js&py=3&rawInputLstJSON=%5B%5D&textReferences=false)

[![框架和对象](https://i.stack.imgur.com/AE8xf.png)](https://i.stack.imgur.com/AE8xf.png)

* * *

## 回答 #3

> 赞同：67
> 
> 时间：2008-10-27T15:07:02.647

实际上，这正是您所期望的。让我们分解这里发生的事情：

你写

```
lst = [[1] * 4] * 3 
```

这相当于：

```
lst1 = [1]*4
lst = [lst1]*3 
```

这意味着`lst`是一个包含 3 个元素的列表，所有元素都指向`lst1`. 这意味着以下两行是等效的：

```
lst[0][0] = 5
lst1[0] = 5 
```

`lst[0]`什么都`lst1`没有。

要获得所需的行为，您可以使用列表推导：

```
lst = [ [1]*4 for n in range(3) ] 
```

在这种情况下，每个 都会重新评估表达式`n`，从而生成不同的列表。

* * *

## 回答 #4

> 赞同：44
> 
> 时间：2008-10-27T15:02:54.310

```
[[1] * 4] * 3 
```

甚至：

```
[[1, 1, 1, 1]] * 3 
```

创建一个引用内部`[1,1,1,1]`3 次的列表 - 而不是内部列表的三个副本，因此无论何时修改列表（在任何位置），您都会看到更改 3 次。

与此示例相同：

```
>>> inner = [1,1,1,1]
>>> outer = [inner]*3
>>> outer
[[1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1]]
>>> inner[0] = 5
>>> outer
[[5, 1, 1, 1], [5, 1, 1, 1], [5, 1, 1, 1]] 
```

这可能不那么令人惊讶。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2017-04-06T05:36:57.047

`my_list = [[1]*4] * 3`在内存中创建一个列表对象`[1,1,1,1]`并将其引用复制 3 次。这相当于`obj = [1,1,1,1]; my_list = [obj]*3`。任何修改`obj`都将反映在三个地方，无论`obj`是在列表中引用的任何地方。正确的说法是：

```
my_list = [[1]*4 for _ in range(3)] 
```

或者

```
my_list = [[1 for __ in range(4)] for _ in range(3)] 
```

**这里要注意的重要一点**是，该`*`运算符*主要*用于创建**文字列表**。虽然`1`是不可变的，`obj = [1]*4`但仍然会创建一个`1`重复 4 次的列表来形成`[1,1,1,1]`。但是，如果对不可变对象进行了任何引用，则该对象将被新对象覆盖。

这意味着如果我们这样做`obj[1] = 42`，那么`obj`将变得`[1,42,1,1]` **不像** ~~`[42,42,42,42]`~~某些人想象的那样。这也可以验证：

```
>>> my_list = [1]*4
>>> my_list
[1, 1, 1, 1]

>>> id(my_list[0])
4522139440
>>> id(my_list[1])  # Same as my_list[0]
4522139440 
```

* * *

```
>>> my_list[1] = 42  # Since my_list[1] is immutable, this operation overwrites my_list[1] with a new object changing its id.
>>> my_list
[1, 42, 1, 1]

>>> id(my_list[0])
4522139440
>>> id(my_list[1])  # id changed
4522140752
>>> id(my_list[2])  # id still same as my_list[0], still referring to value `1`.
4522139440 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2015-06-17T17:08:52.533

除了正确解释问题的公认答案之外，而不是使用以下代码创建包含重复元素的列表：

```
[[1]*4 for _ in range(3)] 
```

此外，您可以使用[`itertools.repeat()`](https://docs.python.org/3/library/itertools.html#itertools.repeat)创建重复元素的迭代器对象：

```
>>> a = list(repeat(1,4))
[1, 1, 1, 1]
>>> a[0] = 5
>>> a
[5, 1, 1, 1] 
```

PS 如果您使用的是 NumPy，并且只想创建一个由 1 或 0 组成的数组，您可以使用[`np.ones`](https://numpy.org/doc/stable/reference/generated/numpy.ones.html)和[`np.zeros`](https://numpy.org/doc/stable/reference/generated/numpy.zeros.html)/或其他数字使用[`np.repeat`](https://numpy.org/doc/stable/reference/generated/numpy.repeat.html)：

```
>>> import numpy as np
>>> np.ones(4)
array([1., 1., 1., 1.])
>>> np.ones((4, 2))
array([[1., 1.],
       [1., 1.],
       [1., 1.],
       [1., 1.]])
>>> np.zeros((4, 2))
array([[0., 0.],
       [0., 0.],
       [0., 0.],
       [0., 0.]])
>>> np.repeat([7], 10)
array([7, 7, 7, 7, 7, 7, 7, 7, 7, 7]) 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2016-04-06T13:40:43.340

Python 容器包含对其他对象的引用。看这个例子：

```
>>> a = []
>>> b = [a]
>>> b
[[]]
>>> a.append(1)
>>> b
[[1]] 
```

这`b`是一个列表，其中包含一个对 list 的引用的项目`a`。该列表`a`是可变的。

列表与整数相乘相当于多次将列表添加到自身（请参阅[常见的序列操作](https://docs.python.org/3/library/stdtypes.html#typesseq-common)）。所以继续这个例子：

```
>>> c = b + b
>>> c
[[1], [1]]
>>>
>>> a[0] = 2
>>> c
[[2], [2]] 
```

我们可以看到列表`c`现在包含两个对 list 的引用，`a`相当于`c = b * 2`.

Python FAQ 还包含对此行为的解释：[如何创建多维列表？](https://docs.python.org/3/faq/programming.html#faq-multidimensional-list)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2015-06-10T14:38:24.890

让我们用以下方式重写您的代码：

```
x = 1
y = [x]
z = y * 4

my_list = [z] * 3 
```

然后有了这个，运行以下代码以使一切更清楚。代码所做的基本上是打印[`id`](https://docs.python.org/3/library/functions.html#id)获得的对象的s，即

> 返回[s]对象的“身份”

并将帮助我们识别它们并分析发生的情况：

```
print("my_list:")
for i, sub_list in enumerate(my_list):
    print("\t[{}]: {}".format(i, id(sub_list)))
    for j, elem in enumerate(sub_list):
        print("\t\t[{}]: {}".format(j, id(elem))) 
```

您将获得以下输出：

```
x: 1
y: [1]
z: [1, 1, 1, 1]
my_list:
    [0]: 4300763792
        [0]: 4298171528
        [1]: 4298171528
        [2]: 4298171528
        [3]: 4298171528
    [1]: 4300763792
        [0]: 4298171528
        [1]: 4298171528
        [2]: 4298171528
        [3]: 4298171528
    [2]: 4300763792
        [0]: 4298171528
        [1]: 4298171528
        [2]: 4298171528
        [3]: 4298171528 
```

* * *

所以现在让我们一步一步来。你有`x`which is`1`和一个`y`包含`x`. 您的第一步是为`y * 4`您提供一个新列表`z`，基本上是`[x, x, x, x]`，即它创建一个新列表，其中包含 4 个元素，这些元素是对初始`x`对象的引用。下一步非常相似。您基本上是这样做`z * 3`的，即是`[[x, x, x, x]] * 3`和返回`[[x, x, x, x], [x, x, x, x], [x, x, x, x]]`，原因与第一步相同。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2016-04-24T13:31:04.353

每个人都在解释正在发生的事情。我会建议一种方法来解决它：

```
my_list = [[1 for i in range(4)] for j in range(3)]

my_list[0][0] = 5
print(my_list) 
```

然后你得到：

```
[[5, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1]] 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2016-06-14T06:36:52.540

简而言之，这是因为在 python 中一切都是**通过引用**工作的，所以当你以这种方式创建列表时，你基本上会遇到这样的问题。

要解决您的问题，您可以执行以下任一操作： 1.[对 numpy.empty 使用 numpy 数组文档](http://docs.scipy.org/doc/numpy-1.10.0/reference/generated/numpy.empty.html) 2\. 将列表添加到列表中。3.如果你愿意，你也可以使用字典

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2019-08-09T08:37:56.333

来自 Python 列表乘法的@spelchekr [：[[...]]*3 生成 3 个列表，这些列表在修改时相互镜像](https://stackoverflow.com/questions/6688223/python-list-multiplication-3-makes-3-lists-which-mirror-each-other-when)，我也有同样的问题：“为什么只有外部`*3`创建更多引用而内部没有创建更多引用？为什么不都是1s吗？”

```
li = [0] * 3
print([id(v) for v in li])  # [140724141863728, 140724141863728, 140724141863728]
li[0] = 1
print([id(v) for v in li])  # [140724141863760, 140724141863728, 140724141863728]
print(id(0))  # 140724141863728
print(id(1))  # 140724141863760
print(li)     # [1, 0, 0]

ma = [[0]*3] * 3  # mainly discuss inner & outer *3 here
print([id(li) for li in ma])  # [1987013355080, 1987013355080, 1987013355080]
ma[0][0] = 1
print([id(li) for li in ma])  # [1987013355080, 1987013355080, 1987013355080]
print(ma)  # [[1, 0, 0], [1, 0, 0], [1, 0, 0]] 
```

这是我在尝试上面的代码后的解释：

*   内部`*3`也会创建引用，但它的引用是不可变`[&0, &0, &0]`的，比如`li[0]``0``&1`
*   while`ma = [&li, &li, &li]`和`li`是可变的，所以当你调用 时`ma[0][0] = 1`，`ma[0][0]`等于`&li[0]`，所以所有`&li`实例都会将它的第一个地址更改为`&1`。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2020-06-21T11:34:38.280

这些问题有很多答案，我将添加我的答案以图解方式解释相同的内容。

您创建 2D 的方式创建了一个浅列表

```
 arr = [[0]*cols]*row 
```

相反，如果你想更新列表的元素，你应该使用

```
 rows, cols = (5, 5) 
   arr = [[0 for i in range(cols)] for j in range(rows)] 
```

**说明**：

可以使用以下方法创建列表：

```
 arr = [0]*N 
```

或者

```
 arr = [0 for i in range(N)] 
```

在第一种情况下，数组的所有索引都指向同一个整数对象

[![在此处输入图像描述](https://i.stack.imgur.com/FAYdnm.png)](https://i.stack.imgur.com/FAYdnm.png)

并且当您为特定索引分配值时，会创建一个新的 int 对象，例如`arr[4] = 5`创建

[![在此处输入图像描述](https://i.stack.imgur.com/WkaFam.png)](https://i.stack.imgur.com/WkaFam.png)

现在让我们看看当我们创建一个列表列表时会发生什么，在这种情况下，我们顶部列表的所有元素都将指向同一个列表

[![在此处输入图像描述](https://i.stack.imgur.com/OiCywl.png)](https://i.stack.imgur.com/OiCywl.png)

如果您更新任何索引的值，则会创建一个新的 int 对象。但由于所有顶级列表索引都指向同一个列表，所有行看起来都一样。你会感觉到更新一个元素就是更新该列中的所有元素。

[![在此处输入图像描述](https://i.stack.imgur.com/iUSlRl.png)](https://i.stack.imgur.com/iUSlRl.png)

**致谢：**感谢[Pranav Devarakonda在](https://auth.geeksforgeeks.org/user/Pranav%20Devarakonda/articles)[这里](https://www.geeksforgeeks.org/python-using-2d-arrays-lists-the-right-way/)的简单解释

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2016-08-10T07:09:51.783

试图更描述性地解释它，

操作一：

```
x = [[0, 0], [0, 0]]
print(type(x)) # <class 'list'>
print(x) # [[0, 0], [0, 0]]

x[0][0] = 1
print(x) # [[1, 0], [0, 0]] 
```

操作2：

```
y = [[0] * 2] * 2
print(type(y)) # <class 'list'>
print(y) # [[0, 0], [0, 0]]

y[0][0] = 1
print(y) # [[1, 0], [1, 0]] 
```

注意到为什么不修改第一个列表的第一个元素并没有修改每个列表的第二个元素？那是因为`[0] * 2`真的是两个数字的列表，不能修改对 0 的引用。

如果要创建克隆副本，请尝试操作 3：

```
import copy
y = [0] * 2   
print(y)   # [0, 0]

y = [y, copy.deepcopy(y)]  
print(y) # [[0, 0], [0, 0]]

y[0][0] = 1
print(y) # [[1, 0], [0, 0]] 
```

另一种创建克隆副本的有趣方法，操作 4：

```
import copy
y = [0] * 2
print(y) # [0, 0]

y = [copy.deepcopy(y) for num in range(1,5)]
print(y) # [[0, 0], [0, 0], [0, 0], [0, 0]]

y[0][0] = 5
print(y) # [[5, 0], [0, 0], [0, 0], [0, 0]] 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2016-07-15T13:48:36.223

通过使用内置列表功能，您可以这样做

```
a
out:[[1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1]]
#Displaying the list

a.remove(a[0])
out:[[1, 1, 1, 1], [1, 1, 1, 1]]
# Removed the first element of the list in which you want altered number

a.append([5,1,1,1])
out:[[1, 1, 1, 1], [1, 1, 1, 1], [5, 1, 1, 1]]
# append the element in the list but the appended element as you can see is appended in last but you want that in starting

a.reverse()
out:[[5, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1]]
#So at last reverse the whole list to get the desired list 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-10-22T19:57:45.760

我来到这里是因为我想看看如何嵌套任意数量的列表。上面有很多解释和具体例子，但是你可以用下面的递归函数来泛化N维list of lists of ...

```
import copy

def list_ndim(dim, el=None, init=None):
    if init is None:
        init = el

    if len(dim)> 1:
        return list_ndim(dim[0:-1], None, [copy.copy(init) for x in range(dim[-1])])

    return [copy.deepcopy(init) for x in range(dim[0])] 
```

你第一次调用这个函数是这样的：

```
dim = (3,5,2)
el = 1.0
l = list_ndim(dim, el) 
```

其中`(3,5,2)`是结构维度的元组（类似于 numpy`shape`参数），并且`1.0`是您希望用于初始化结构的元素（也适用于 None ）。请注意，该`init`参数仅由递归调用提供以继承嵌套的子列表

上面的输出：

```
[[[1.0, 1.0], [1.0, 1.0], [1.0, 1.0], [1.0, 1.0], [1.0, 1.0]],
 [[1.0, 1.0], [1.0, 1.0], [1.0, 1.0], [1.0, 1.0], [1.0, 1.0]],
 [[1.0, 1.0], [1.0, 1.0], [1.0, 1.0], [1.0, 1.0], [1.0, 1.0]]] 
```

设置特定元素：

```
l[1][3][1] = 56
l[2][2][0] = 36.0+0.0j
l[0][1][0] = 'abc' 
```

结果输出：

```
[[[1.0, 1.0], ['abc', 1.0], [1.0, 1.0], [1.0, 1.0], [1.0, 1.0]],
 [[1.0, 1.0], [1.0, 1.0], [1.0, 1.0], [1.0, 56.0], [1.0, 1.0]],
 [[1.0, 1.0], [1.0, 1.0], [(36+0j), 1.0], [1.0, 1.0], [1.0, 1.0]]] 
```

上面展示了列表的非类型化性质

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-11-22T19:45:18.463

**请注意，序列中的项目不会被复制；它们被多次引用**。这常常困扰着新的 Python 程序员。考虑：

```
>>> lists = [[]] * 3
>>> lists
[[], [], []]
>>> lists[0].append(3)
>>> lists
[[3], [3], [3]] 
```

发生的事情是`[[]]`一个包含一个空列表的单元素列表，所以 的所有三个元素`[[]] * 3`都是对这个空列表的引用。修改列表的任何元素都会修改此单个列表。

另一个解释这一点的例子是使用*多维数组*。

您可能试图制作这样的多维数组：

```
>>> A = [[None] * 2] * 3 
```

如果您打印它，这看起来是正确的：

```
>>> A
[[None, None], [None, None], [None, None]] 
```

但是当你分配一个值时，它会出现在多个地方：

```
>>> A[0][0] = 5
>>> A
[[5, None], [5, None], [5, None]] 
```

原因是复制列表 `*` 不会创建副本，它只会创建对现有对象的引用。3 创建一个列表，其中包含 3 个对长度为 2 的相同列表的引用。对一行的更改将显示在所有行中，这几乎肯定不是您想要的。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-01-07T16:39:52.010

虽然原始问题使用乘法运算符构造了*子列表*，但我将添加一个使用**相同**列表作为子列表的示例。添加此答案以确保完整性，因为此问题通常用作该问题的规范

```
node_count = 4
colors = [0,1,2,3]
sol_dict = {node:colors for node in range(0,node_count)} 
```

列表中的每个字典值都是同一个对象，试图更改其中一个字典值会在所有中看到。

```
>>> sol_dict
{0: [0, 1, 2, 3], 1: [0, 1, 2, 3], 2: [0, 1, 2, 3], 3: [0, 1, 2, 3]}
>>> [v is colors for v in sol_dict.values()]
[True, True, True, True]
>>> sol_dict[0].remove(1)
>>> sol_dict
{0: [0, 2, 3], 1: [0, 2, 3], 2: [0, 2, 3], 3: [0, 2, 3]} 
```

构建字典的正确方法是为每个值使用列表的副本。

```
>>> colors = [0,1,2,3]
>>> sol_dict = {node:colors[:] for node in range(0,node_count)}
>>> sol_dict
{0: [0, 1, 2, 3], 1: [0, 1, 2, 3], 2: [0, 1, 2, 3], 3: [0, 1, 2, 3]}
>>> sol_dict[0].remove(1)
>>> sol_dict
{0: [0, 2, 3], 1: [0, 1, 2, 3], 2: [0, 1, 2, 3], 3: [0, 1, 2, 3]} 
```

# oracle - 为什么Oracle的to_char()函数要加空格？

> ID：240182
> 
> 赞同：60
> 
> 时间：2008-10-27T14:57:47.300
> 
> 标签：oracle

为什么Oracle的`to_char()`函数要加空格？

```
select length('012'), 
       length(to_char('012')), 
       length(to_char('12', '000')) 
  from dual; 
```

`3, 3, 4`

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2008-10-27T15:03:41.343

额外的前导空格用于潜在的减号。要删除空间，您可以使用 FM 格式：

```
SQL> select to_char(12,'FM000') from dual;

TO_C
----
012 
```

顺便说一句，请注意 to_char 需要一个 NUMBER 参数；to_char('012') 隐式转换为 to_char(to_number('012')) = to_char(12)

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2008-10-27T15:07:17.810

为了使给出的答案更清楚：

```
select '['||to_char(12, '000')||']', 
       '['||to_char(-12, '000')||']', 
       '['||to_char(12,'FM000')||']' 
from dual

[ 012]                      [-012]                       [012] 
```

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2008-10-27T15:00:44.220

您使用的格式掩码是固定宽度并允许使用减号

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-01-16T19:03:14.843

请注意，使用 'fm' 语法时，除非使用零指定，否则它不会包含小数点后的任何值。例如：

```
SELECT TO_CHAR(12345, 'fm99,999.00') FROM dual 
```

返回：**'12,345.00'**

```
SELECT TO_CHAR(12345, 'fm99,999.99') FROM dual 
```

返回：**“12,345。”**

As you can see this would be an issue if you are expecting two zeros after the decimals place (maybe in fee reports for example).

# c++ - 释放堆上的内存。我应该怎么做？

> ID：240184
> 
> 赞同：2
> 
> 时间：2008-10-27T14:57:53.303
> 
> 标签：c++, winapi, memory-management, windows-ce

我正在为 Windows Mobile 应用程序编写 CESetup.dll。它必须是无人管理的，我对此几乎没有经验。所以我不确定我是否应该释放我分配的内存以及我如何去做。

这是我写的函数：

```
 Uninstall_Init(
    HWND        hwndParent,
    LPCTSTR     pszInstallDir
)
{
    LPTSTR folderPath = new TCHAR[256];
    _stprintf(folderPath, _T("%s\\cache"), pszInstallDir);
    EmptyDirectory(folderPath);
    RemoveDirectory(folderPath);

    _stprintf(folderPath, _T("%s\\mobileadmin.dat"), pszInstallDir);
    DeleteFile(folderPath);

// To continue uninstallation, return codeUNINSTALL_INIT_CONTINUE
// If you want to cancel installation,
// return codeUNINSTALL_INIT_CANCEL
return codeUNINSTALL_INIT_CONTINUE;
} 
```

据我了解，folderPath 是在堆上分配的。EmptyDirectory() 是我自己的函数，用于删除目录中的所有内容。RemoveDirectory() 和 DeleteFile() 是系统调用。

我的问题是我应该`folderPath`在函数退出之前解除分配吗？如果我应该，我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-27T15:10:42.530

我在不习惯 C/C++ 编程的人身上看到了一个常见的误解——当他们看到一个带有指针参数的函数时，他们认为该变量必须用*new*分配。情况并非如此，局部变量是合适且首选的，因为您不必担心它的生命周期。

你可以通过这样做极大地简化你的生活

```
TCHAR folderPath[256]; 
```

我首选的解决方案是使用 std::string，但我已将其放在单独的答案中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-27T15:10:50.300

我想你想用这个：

```
delete [] folderPath; 
```

看起来您正在分配一个 TCHAR 数组，这是有道理的，因为它是一个字符串。分配数组时，必须使用数组删除运算符（通过在删除语句中包含方括号来获得）删除。我很确定 Treb 的解决方案会导致内存泄漏。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T15:02:06.540

是的你应该。通过调用

```
 delete[] folderPath; 
```

在您的功能结束时。所有分配的内存都`new`必须用 释放`delete`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-27T15:11:22.187

是的，你应该释放内存。您调用的任何函数都不会为您执行，也不应该为您执行 - 这没有任何意义。内存是使用向量 new 运算符分配的，因此应该使用向量删除运算符释放，即：

删除 [] 文件夹路径；

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-27T15:25:59.097

通常最好使用std::string，或者在你的情况下使用std::basic_string。在这种情况下，当您的最终路径大于 256 个字符时，它消除了潜在的缓冲区溢出。

```
 Uninstall_Init(
    HWND        hwndParent,
    LPCTSTR     pszInstallDir
)
{
    std::basic_string<TCHAR> folderPath = pszInstallDir;
    folderPath.append(_T("\\cache"));
    EmptyDirectory(folderPath.c_str());
    RemoveDirectory(folderPath.c_str());
    folderPath = pszInstallDir;
    folderPath.append(_T("\\mobileadmin.dat"));
    DeleteFile(folderPath.c_str());
// To continue uninstallation, return codeUNINSTALL_INIT_CONTINUE
// If you want to cancel installation,
// return codeUNINSTALL_INIT_CANCEL
return codeUNINSTALL_INIT_CONTINUE;
} 
```

# php - PHP：从 DOMNode 对象中删除属性

> ID：240185
> 
> 赞同：3
> 
> 时间：2008-10-27T14:57:58.437
> 
> 标签：php, dom

我有一个`DOMNode`具有某些属性的对象。`$Node->attributes`是 a `DOMNamedNodeMap`，它没有用于删除映射中的条目之一的方法。该类`DOMNode`也没有从元素中删除属性的方法。我查看了许多其他相关类，但它们似乎都没有提供从其父节点中删除属性节点的机制。

`DOMNode::removeChild`不工作；`DOMAttr`如果我将对象传递给它，它会引发“未找到错误” 。

除了构建一个新`DOMNamedNodeMap`的并向它添加所有属性*之外*，我不想要的属性除外……有什么想法吗？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-27T15:39:38.400

# c++ - new/delete 和 malloc/free 有什么区别？

> ID：240212
> 
> 赞同：292
> 
> 时间：2008-10-27T15:05:30.310
> 
> 标签：c++, memory-management

`new`/`delete`和`malloc`/和有什么不一样`free`？

相关（重复？）：[在什么情况下我使用 malloc 与 new？](https://stackoverflow.com/questions/184537/in-what-cases-do-i-use-malloc-vs-new)

* * *

## 回答 #1

> 赞同：485
> 
> 时间：2008-10-27T15:28:19.560

## `new`/`delete`

*   分配/释放内存
    1.  从“免费存储”分配的内存。
    2.  返回一个完全类型化的指针。
    3.  `new`（标准版）从不返回 a `NULL`（将抛出失败）。
    4.  使用 Type-ID 调用（编译器计算大小）。
    5.  有一个明确的版本来处理数组。
    6.  重新分配（以获得更多空间）没有直观地处理（因为复制构造函数）。
    7.  他们是否调用`malloc`/`free`是实现定义的。
    8.  可以添加一个新的内存分配器来处理低内存（`std::set_new_handler`）。
    9.  `operator new`/`operator delete`可以合法地被覆盖。
    10.  **构造函数/析构函数用于初始化/销毁对象。**

## `malloc`/`free`

*   分配/释放内存
    1.  从“堆”分配的内存。
    2.  返回一个`void*`.
    3.  失败返回`NULL`。
    4.  必须以字节为单位指定所需的大小。
    5.  分配数组需要手动计算空间。
    6.  重新分配更大的内存块很简单（无需担心复制构造函数）。
    7.  他们**不会**调用`new`/ `delete`。
    8.  无法将用户代码拼接到分配序列中以帮助解决内存不足的问题。
    9.  `malloc`/`free`不能**合法**地被覆盖。

## 功能表对比：

| 特征 | `new`/`delete` | `malloc`/`free` |
| --- | --- | --- |
| 分配的内存 | '免费商店' | '堆' |
| 退货 | 全类型指针 | `void*` |
| 失败时 | 投掷（永不返回`NULL`） | 退货`NULL` |
| 所需尺寸 | 由编译器计算 | 必须以字节为单位指定 |
| 处理数组 | 有明确的版本 | 需要手动计算 |
| 重新分配 | 处理不直观 | 简单（无复制构造函数） |
| 反转的呼唤 | 实现定义 | 不 |
| 内存不足的情况 | 可以添加新的内存分配器 | 不由用户代码处理 |
| 可覆盖 | 是的 | 不 |
| 构造函数/析构函数的使用 | 是的 | 不 |

从技术上讲，分配的内存`new`来自“免费存储”，而分配的内存`malloc`来自“堆”。这两个区域是否相同是一个实现细节，这是另一个`malloc`不能`new`混为一谈的原因。

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2008-10-27T15:07:35.827

最相关的区别是`new`运算符分配内存然后调用构造函数，`delete`调用析构函数然后释放内存。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2008-10-27T15:08:30.163

`new`调用对象的ctor，`delete`调用dtor。

`malloc`&`free`只是分配和释放原始内存。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2008-10-27T15:08:43.203

`new`/`delete`是 C++，`malloc`/`free`来自古老的 C。

在 C++ 中，`new`调用对象构造函数并`delete`调用析构函数。

`malloc`并且`free`，来自OO之前的黑暗时代，只分配和释放内存，不执行对象的任何代码。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2008-10-27T15:08:36.527

在 C++ `new`/`delete`中相应地调用构造函数/析构函数。

`malloc`/`free`简单地从堆中分配内存。`new`/`delete`也分配内存。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2008-10-27T15:11:30.453

唯一的相似之处是`malloc`/`new`都返回一个指向堆上一些内存的指针，并且它们都保证一旦返回了这样的内存块，除非您先释放/删除它，否则它不会再次返回。也就是说，它们都“分配”内存。

但是，`new`/`delete`还可以通过构造函数、析构函数和运算符重载执行任意其他工作。`malloc`/`free`只分配和释放内存。

事实上，`new`它是充分可定制的，它不一定从堆中返回内存，甚至根本不需要分配内存。但是，默认值`new`会。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2014-10-08T08:52:34.953

new 和 malloc 的主要区别在于 new 调用对象的构造函数，而相应的 delete 调用调用对象的析构函数。

还有其他区别：

*   `new`是类型安全的，`malloc`返回类型的对象`void*`

*   `new`出错时抛出异常，`malloc`返回`NULL`并设置 errno

*   `new`是运算符，可以重载，`malloc`是函数，不能重载

*   `new[]`，它分配数组，比`malloc`

*   `malloc`-派生的分配可以通过调整大小`realloc`， -`new`派生的分配不能调整大小

*   `malloc`可以分配一个 N 字节的内存块，`new`必须要求分配一个数组，比如说，`char`类型

看看差异，总结一下 malloc 是 C-esque，new 是 C++-esque。使用适合您的代码库的那个。

尽管 new 和 malloc 使用不同的内存分配算法实现是合法的，但在大多数系统上，new 在内部使用 malloc 实现，不会产生系统级别的差异。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2014-01-15T14:48:06.233

有一些事情`new`不会`malloc`：

1.  `new`通过调用该对象的构造函数来构造该对象
2.  `new`不需要对分配的内存进行类型转换。
3.  它不需要分配大量内存，而是需要构造多个对象。

所以，如果你使用`malloc`，那么你需要明确地做上面的事情，这并不总是实用的。此外，`new`可以重载但`malloc`不能重载。

总之，如果你使用C++，尽量使用`new`。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-10-27T15:35:53.867

还，

全局 new 和 delete 可以被覆盖， malloc/free 不能。

每种类型都可以覆盖更多的 new 和 delete。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-10-27T15:09:31.143

`new`并且`delete`是 C++*原语*，它声明一个类的新实例或删除它（从而为实例调用类的析构函数）。

`malloc`并且`free`是 C*函数*，它们分配和释放内存块（按大小计）。

两者都使用堆进行分配。`malloc`并且`free`仍然更加“低级”，因为它们只是保留了一块可能与指针相关联的内存空间。没有围绕该内存创建任何结构（除非您将 C 数组视为结构）。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-09-10T11:13:28.330

new 和 delete 是 C++ 中的运算符；这也可以超载。malloc 和 free 是 c 中的函数；

当 new 抛出异常时 malloc 失败时返回 null ptr。

malloc 返回的地址需要再次进行类型转换，因为它返回 (void*)malloc(size) New 返回类型化指针。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2015-12-19T06:20:31.700

*   new 是一个运算符，而 malloc() 是一个函数。
*   new 返回确切的数据类型，而 malloc() 返回 void *（类型为 void 的指针）。
*   malloc()，内存未初始化，默认值为垃圾，而在 new 的情况下，内存使用默认值初始化，如 int 的情况下使用“零 (0)”。
*   delete 和 free() 都可以用于 'NULL' 指针。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-06-18T21:43:47.560

*   要使用`malloc()`，我们需要在程序中*包含* `<stdlib.h>`或 `<alloc.h>`不需要的`new`。
*   `new`并且`delete`可以重载但`malloc`不能。
*   使用放置`new`，我们可以传递我们要分配内存的地址，但在`malloc`.

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-11-12T10:27:43.577

此代码用于删除关键字或免费功能。但是，当使用“malloc”或“new”创建指针对象并使用 delete 释放对象内存时，即使该对象指针也可以在类中调用函数。之后使用 free 而不是 delete 然后它也可以在 free 语句之后工作，但是当同时使用两者时，只有指针对象不能调用类中的函数..代码如下：

```
#include<iostream>

using namespace std;

class ABC{
public: ABC(){
    cout<<"Hello"<<endl;
  }

  void disp(){
    cout<<"Hi\n";
  }

};

int main(){

ABC* b=(ABC*)malloc(sizeof(ABC));
int* q = new int[20];
ABC *a=new ABC();
b->disp();

cout<<b<<endl;
free(b);
delete b;
//a=NULL;
b->disp();
ABC();
cout<<b;
return 0;
} 
```

> 输出 ：
> 
> ```
> Hello
> Hi
> 0x2abfef37cc20 
> ```

* * *

## 回答 #15

> 赞同：-4
> 
> 时间：2017-07-15T14:45:18.560

1.new syntex 比 malloc() 更简单

2.new/delete 是一个运算符，其中 malloc()/free() 是一个函数。

3.new/delete 执行速度比 malloc()/free() 快，因为新的汇编代码直接由编译器粘贴。

4.我们可以通过操作符叠加来改变程序中新/删除的含义。

# c# - Get Binary data from a SQL Database

> ID：240219
> 
> 赞同：1
> 
> 时间：2008-10-27T15:07:49.133
> 
> 标签：c#, .net, linq, pdf

I have an ASP .Net (3.5) website. I have the following code that uploads a file as a binary to a SQL Database:

```
Print("        
            protected void UploadButton_Click(object sender, EventArgs e)
            {

            //Get the posted file
            Stream fileDataStream = FileUpload.PostedFile.InputStream;

            //Get length of file
            int fileLength = FileUpload.PostedFile.ContentLength;

            //Create a byte array with file length
            byte[] fileData = new byte[fileLength];

            //Read the stream into the byte array
            fileDataStream.Read(fileData, 0, fileLength);

            //get the file type
            string fileType = FileUpload.PostedFile.ContentType;

            //Open Connection
            WebSysDataContext db = new WebSysDataContext(Contexts.WEBSYS_CONN());

            //Create New Record
            BinaryStore NewFile = new BinaryStore();

            NewFile.BinaryID = "1";
            NewFile.Type = fileType;
            NewFile.BinaryFile = fileData;

            //Save Record
            db.BinaryStores.InsertOnSubmit(NewFile);

            try
            {
                db.SubmitChanges();
            }
            catch (Exception)
            {
                throw;
            }
        }"); 
```

The files that will be uploaded are PDFs, Can you please help me in writing the code to get the PDF out of the SQL database and display it in the browser. (I am able to get the binary file using a linq query but not sure how to process the bytes)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T15:12:10.530

So are you really just after how to serve a byte array in ASP.NET? It sounds like the database part is irrelevant, given that you've said you are able to get the binary file with a LINQ query.

If so, look at [HttpResponse.BinaryWrite](http://msdn.microsoft.com/en-us/library/system.web.httpresponse.binarywrite.aspx). You should also set the content type of the response appropriately, e.g. application/pdf.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-27T16:10:49.100

protected void Test_Click(object sender, EventArgs e) {

```
 WebSysDataContext db = new WebSysDataContext(Contexts.WEBSYS_CONN());

        var GetFile = from x in db.BinaryStores
                      where x.BinaryID == "1"
                      select x.BinaryFile;

        FileStream MyFileStream;
        long FileSize;

        MyFileStream = new FileStream(GetFile, FileMode.Open);
        FileSize = MyFileStream.Length;

        byte[] Buffer = new byte[(int)FileSize];
        MyFileStream.Read(Buffer, 0, (int)FileSize);
        MyFileStream.Close();

        Response.Write("<b>File Contents: </b>");
        Response.BinaryWrite(Buffer);

    } 
```

我试过了，但这没有用。我在这一行“MyFileStream = new FileStream(GetFile, FileMode.Open);”上得到一个编译错误 我不确定我哪里出错了，是因为我存储它的方式吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T15:14:45.517

How big are the files? Huge buffers (i.e. byte[fileLength]) are usually a bad idea.

Personally, I'd look at things like [this](http://groups.google.co.uk/group/microsoft.public.dotnet.languages.csharp/msg/314e7e3782e59a93) and [this](http://groups.google.co.uk/group/microsoft.public.dotnet.languages.csharp/msg/fcd173f1db2951f1), which show reading/writing data as streams (the second shows pushing the stream as an http response). But updated to use varchar(max) ;-p

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T13:24:38.730

当您在 SQL Server 中存储二进制文件时，它会将 OLE 标头添加到二进制数据中。因此，在将 byte[] 实际读入文件之前，您必须剥离该标头。这是你如何做到这一点的。

```
// First Strip-Out the OLE header
const int OleHeaderLength = 78;

int strippedDataLength = datarow["Field"].Length - OleHeaderLength;

byte[] strippedData = new byte[strippedDataLength];

Array.Copy(datarow["Field"], OleHeaderLength, 
    strippedData , 0, strippedDataLength ); 
```

运行此代码后，strippedData 将包含实际的文件数据。然后，您可以使用 MemoryStream 或 FileStream 对 byte[] 执行 I/O。

# c# - Double/incomplete Parameter Url Encoding

> ID：240224
> 
> 赞同：7
> 
> 时间：2008-10-27T15:08:55.263
> 
> 标签：c#, asp.net-mvc, encoding

In my web app, my parameters can contain all sorts of crazy characters (russian chars, slashes, spaces etc) and can therefor not always be represented as-is in a URL.
Sending them on their merry way will work in about 50% of the cases. Some things like spaces are already encoded somewhere (I'm guessing in the Html.BuildUrlFromExpression does). Other things though (like "/" and "*") are not.

Now I don't know what to do anymore because if I encode them myself, my encoding will get partially encoded again and end up wrong. If I don't encode them, some characters will not get through.

What I did is manually .replace() the characters I had problems with.
This is off course not a good idea.

Ideas?

**--Edit--**
**I know there are a multitude of encoding/decoding libraries at my disposal.** It just looks like the mvc framework is already trying to do it for me, but not completely.

```
<a href="<%=Html.BuildUrlFromExpression<SearchController>(c=>c.Search("", 1, "a \v/&irdStr*ng"))%>" title="my hat's awesome!"> 
```

will render me

```
<a href="/Search.mvc/en/Search/1/a%20%5Cv/&irdStr*ng" title="my hat's awesome!"> 
```

Notice how the forward slash, asterisk and ampersand are not escaped. Why are some escaped and others not? How can I now escape this properly?

Am I doing something wrong or is it the framework?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T15:16:49.023

Parameters should be escaped using `Uri.EscapeDataString`:

```
 string url = string.Format("http://www.foo.bar/page?name={0}&address={1}",
                Uri.EscapeDataString("adlknad /?? lkm#"),
                Uri.EscapeDataString(" qeio103 8182"));

            Console.WriteLine(url);
            Uri uri = new Uri(url);
            string[] options = uri.Query.Split('?','&');
            foreach (string option in options)
            {
                string[] parts = option.Split('=');
                if (parts.Length == 2)
                {
                    Console.WriteLine("{0} = {1}",parts[0],
                        Uri.UnescapeDataString(parts[1]));
                }
            } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-23T09:16:17.200

正如其他人所提到的，如果您首先对字符串进行编码，则可以避免该问题。

MVC 框架正在对它知道需要编码的字符进行编码，但保留那些有效的 URL 字符（例如 & % ? * /）。这是因为这些是有效的 URL 字符，尽管它们是 URL 中的特殊字符，可能无法达到您所追求的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-24T18:48:43.487

我看过类似的帖子。对我来说，这看起来像是 MVC 中的一个缺陷。该函数将更恰当地命名为“BuildUrlFromEncodedExpression”。更糟糕的是，被调用的函数需要对其输入参数进行解码。玉。

如果在 BuildUrlFromExpression() 编码的字符和调用者编码的字符之间有任何重叠（为了简单起见，我认为调用者可能只是对任何非字母数字进行编码），那么你就有可能出现讨厌的错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T10:11:51.220

出于安全原因，禁止在 url 的路径部分中转义正斜杠和点（尽管它在单声道中工作）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-27T15:13:07.110

Have you tried using the `Server.UrlEncode()` method to do the encoding, and the `Server.UrlDecode()` method to decode?

I have not had any issues with using it for passing items.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-27T15:13:35.143

[Server.URLEncode](http://msdn.microsoft.com/en-us/library/ms525738.aspx) or [HttpServerUtility.UrlEncode](http://msdn.microsoft.com/en-us/library/zttxte6w.aspx)

I see what you're saying now - I didn't realize the question was specific to MVC. Looks like a limitation of that part of the MVC framework - particularly BuildUrlFromExpression is doing some URL encoding, but it knows that also needs some of those punctation as part of the framework URLs.

And also unfortunately, URLEncoding doesn't produce an invariant, i.e.

```
URLEncode(x) != URLEncode(URLEncode(x)) 
```

Wouldn't that be nice. Then you could pre-encode your variables and they wouldn't be double encoded.

There's probably an ASP.NET MVC framework best practice for this. I guess another thing you could do is encode into base64 or something that is URLEncode-invariant.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-27T15:19:07.723

Try using the [Microsoft Anti-Cross Site Scripting library](http://www.microsoft.com/downloads/details.aspx?familyid=EFB9C819-53FF-4F82-BFAF-E11625130C25&displaylang=en). It contains several Encode methods, which encode all the characters (including #, and characters in other languages). As for decoding, the browser should handle the encoded Url just fine, however if you need to manually decode the Url, use [Uri.UnescapeDataString](https://stackoverflow.com/questions/239567/decode-escaped-url-without-using-httputilityurldecode)

Hope that helps.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-19T06:41:14.073

然后需要修复 Html.BuildUrlFromExpression，将其提交到 MVC 项目的上游......或者在传递给 BuildUrlFromExpression 之前对字符串进行编码，并在它从另一端返回时对其进行解码。

它可能不容易修复，因为 IIS 可能会事先处理 url 字符串的解码......可能需要在实用程序方法中对替代路径字符进行一些更高级的编码/解码，并代表您进行解码。

# javascript - 在 Javascript 中处理子窗口和孙窗口

> ID：240242
> 
> 赞同：2
> 
> 时间：2008-10-27T15:12:08.953
> 
> 标签：javascript, jquery, window

我的网页上有一个主窗口 (#1)，我从中打开一个新的浏览器窗口 (#2)，从中打开一个新窗口 (#3)。

现在，如果我的用户在 window#3 之前关闭 window#2，我的问题是 window#3 不再可以在其 window.opener 中调用函数，因为它已经消失了。

我想做的是在 window#2 关闭时将 window#3.opener 设置为 window#1。

我尝试在窗口#2 中执行此操作（顺便说一下我使用 jquery）：

```
var children = [];
$(window).unload( function( ) {
    $.each( children, function( p, win ) {
        if ( win ) {
            win.opener = window.opener;
            }
    } );
} ); 
```

加载 window#3 时，我将窗口添加到 window#2 的子数组中。

但是当window#2 在window#3 之前关闭时，windows#3 的window.opener 并不指向window#1。

如何确保我的大子窗口（窗口＃3）在窗口＃2关闭后仍然可以调用主窗口（窗口＃1）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-27T15:23:34.500

在您输入的第三个窗口中：

```
<script type="text/javascript">
  var grandMother = null;
  window.onload = function(){
    grandMother = window.opener.opener;
  }
</script> 
```

因此，您拥有祖母窗口的句柄，然后您可以直接将其用于任何事情：

```
if(grandMother)
      grandMother.document.getElementById("myDiv").firstChild.nodeValue ="Greetings from your grandchild !-"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T15:27:06.427

当第三个打开时，您应该创建对主窗口的引用：

```
parent = window.opener.opener 
```

这将在第二个窗口关闭后继续存在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T15:17:41.033

这可能是切线的，但是为什么需要打开 3 个单独的窗口呢？你可以改用 jQuery 对话框吗？当应用程序在我身上打开窗口时，我感到非常沮丧。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-27T15:19:54.290

`window.opener`可能是只读的。我会设置您自己的属性以在加载孙子时引用祖父母。

```
function onLoad() {
  window.grandparent = window.opener.opener;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-11-08T15:33:31.837

```
var main_window = get_main_window();
function get_main_window(){
    var w = window;
    while(w.opener !== null){
        w = w.opener;
    }
    return w;
} 
```

# vim - vim -- 如何将文件中的行范围读入当前缓冲区

> ID：240244
> 
> 赞同：62
> 
> 时间：2008-10-27T15:12:27.970
> 
> 标签：vim

我想将文件 foo.c 中的第 n1->n2 行读入当前缓冲区。

我试过：`147,227r /path/to/foo/foo.c`

但我得到：“E16：无效范围”，尽管我确信 foo.c 包含超过 1000 行。

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2008-10-27T15:19:43.900

```
:r! sed -n 147,227p /path/to/foo/foo.c 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2014-01-22T08:24:52.270

您可以在纯 Vimscript 中执行此操作，而无需使用 sed 之类的外部工具：

```
:put =readfile('/path/to/foo/foo.c')[146:226] 
```

请注意，我们必须从行号**减一**，因为数组从 0 开始，而行号从 1 开始。

*缺点*：此解决方案比接受的答案长 7 个字符。它将临时将整个文件读入内存，如果该文件很大，这可能是一个问题。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-10-27T15:16:56.947

{range} 指的是当前文件中的目标，而不是源文件中的行范围。

经过一些实验，似乎

```
:147,227r /path/to/foo/foo.c 
```

表示在此文件中*插入第`/path/to/foo/foo.c`227 行之后的内容。*即：它忽略了147。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2017-07-10T11:55:29.703

发布的其他解决方案非常适合特定的行号。通常情况下，您想从另一个文件的顶部或底部读取。在这种情况下，读取 head 或 tail 的输出非常快。例如 -

```
:r !head -20 xyz.xml 
```

将从 xyz.xml 读取前 20 行到光标所在的当前缓冲区

```
:r !tail -10 xyz.xml 
```

将从 xyz.xml 读取最后 10 行到光标所在的当前缓冲区

head 和 tail 命令非常快，因此即使将它们组合起来也可以比其他方法更快地处理非常大的文件。

```
:r !head -700030 xyz.xml| tail -30 
```

将从文件 xyz.xml 读取从 700000 到 700030 的行号到当前缓冲区

即使对于相当大的文件，此操作也应立即完成。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-01-15T06:13:04.047

我只需要在我的代码项目中执行此操作并这样做：

在`/path/to/foo/foo.c`打开的缓冲区中：

```
:147,227w export.txt 
```

在我正在使用的缓冲区中：

```
:r export.txt 
```

在我的书中要容易得多......它需要打开两个文件，但如果我要导入一组行，我通常都会让它们都打开。这种方法对我来说更通用，更容易记住，特别是如果我尝试使用`g/<search_criteria/:.w >> export.txt`或其他更复杂的选择线的方式导出/导入一组更复杂的线。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-27T15:23:28.557

您将需要：

```
:r /path/to/foo/foo.c
:d 228,$
:d 1,146 
```

三个步骤，但它会完成它......

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-06-18T09:56:38.853

> 范围允许将命令应用于当前缓冲区中的一组行。

因此，读取指令的范围是指在当前文件中插入内容的位置，而不是您要读取的文件范围。

# c# - 从 C# 中的字节数组中删除尾随空值

> ID：240258
> 
> 赞同：17
> 
> 时间：2008-10-27T15:16:09.273
> 
> 标签：c#, bytearray

好的，我正在将 dat 文件读入字节数组。出于某种原因，生成这些文件的人在文件末尾放置了大约半兆的无用空字节。有谁知道快速修剪这些的方法吗？

第一个想法是从数组的末尾开始并向后迭代，直到找到除 null 以外的其他内容，然后将所有内容复制到该点，但我想知道是否没有更好的方法。

回答一些问题：您确定文件中肯定存在 0 字节，而不是文件读取代码中存在错误吗？是的，我很确定。

你能确定修剪所有尾随的 0 吗？是的。

文件的其余部分可以有任何 0 吗？是的，其他地方可以有 0，所以，不，我不能从头开始，在第一个 0 处停止。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-27T17:32:31.870

我同意乔恩的观点。关键是您必须“触摸”从最后一个字节到第一个非零字节的每个字节。像这样的东西：

```
byte[] foo;
// populate foo
int i = foo.Length - 1;
while(foo[i] == 0)
    --i;
// now foo[i] is the last non-zero byte
byte[] bar = new byte[i+1];
Array.Copy(foo, bar, i+1); 
```

我很确定这和你能做到的一样有效。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-27T17:10:38.980

鉴于现在回答了额外的问题，听起来你基本上做对了。特别是，您必须从最后一个 0 开始触摸文件的每个字节，以检查它是否只有 0。

现在，您是否必须复制所有内容取决于您对数据所做的操作。

*   您也许可以记住索引并将其与数据或文件名一起保存。
*   您可以将数据复制到一个新的字节数组中
*   如果要“修复”文件，可以调用[FileStream.SetLength](http://msdn.microsoft.com/en-us/library/system.io.filestream.setlength.aspx)来截断文件

“您*必须*读取截断点和文件末尾之间的每个字节”是关键部分。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-27T17:33:50.243

@因子神秘主义者，

我认为有一个最短的方法：

```
var data = new byte[] { 0x01, 0x02, 0x00, 0x03, 0x04, 0x00, 0x00, 0x00, 0x00 };
var new_data = data.TakeWhile((v, index) => data.Skip(index).Any(w => w != 0x00)).ToArray(); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-27T15:30:50.210

这个怎么样：

```
[Test]
public void Test()
{
   var chars = new [] {'a', 'b', '\0', 'c', '\0', '\0'};

   File.WriteAllBytes("test.dat", Encoding.ASCII.GetBytes(chars));

   var content = File.ReadAllText("test.dat");

   Assert.AreEqual(6, content.Length); // includes the null bytes at the end

   content = content.Trim('\0');

   Assert.AreEqual(4, content.Length); // no more null bytes at the end
                                       // but still has the one in the middle
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-27T15:23:50.070

假设 0=null，这可能是您最好的选择...作为一个小调整，您可能希望`Buffer.BlockCopy`在最终复制有用数据时使用..

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-02-07T07:24:03.510

测试一下：

```
 private byte[] trimByte(byte[] input)
    {
        if (input.Length > 1)
        {
            int byteCounter = input.Length - 1;
            while (input[byteCounter] == 0x00)
            {
                byteCounter--;
            }
            byte[] rv = new byte[(byteCounter + 1)];
            for (int byteCounter1 = 0; byteCounter1 < (byteCounter + 1); byteCounter1++)
            {
                rv[byteCounter1] = input[byteCounter1];
            }
            return rv;
        } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-27T16:38:41.307

总有一个 LINQ 答案

```
byte[] data = new byte[] { 0x01, 0x02, 0x00, 0x03, 0x04, 0x00, 0x00, 0x00, 0x00 };
bool data_found = false;
byte[] new_data = data.Reverse().SkipWhile(point =>
{
  if (data_found) return false;
  if (point == 0x00) return true; else { data_found = true; return false; }
}).Reverse().ToArray(); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-27T16:56:01.133

您可以只计算数组末尾的零个数，然后在以后迭代数组时使用它而不是 .Length 。你可以随心所欲地封装它。要点是您实际上并不需要将其复制到新结构中。如果它们很大，它可能是值得的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-27T17:49:52.223

如果文件中的空字节可以是有效值，您是否知道文件中的最后一个字节不能为空。如果是这样，则向后迭代并查找第一个非空条目可能是最好的，如果不是，则无法判断文件的实际结尾在哪里。

如果您对数据格式了解更多，例如不能有长于两个字节的空字节序列（或一些类似的约束）。然后，您实际上可以对“过渡点”进行二进制搜索。这应该比线性搜索快得多（假设您可以读取整个文件）。

基本思想（使用我之前关于没有连续空字节的假设）是：

```
var data = (byte array of file data...);
var index = data.length / 2;
var jmpsize = data.length/2;
while(true)
{
    jmpsize /= 2;//integer division
    if( jmpsize == 0) break;
    byte b1 = data[index];
    byte b2 = data[index + 1];
    if(b1 == 0 && b2 == 0) //too close to the end, go left
        index -=jmpsize;
    else
        index += jmpsize;
}

if(index == data.length - 1) return data.length;
byte b1 = data[index];
byte b2 = data[index + 1];
if(b2 == 0)
{
    if(b1 == 0) return index;
    else return index + 1;
}
else return index + 2; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-07-09T16:21:01.467

当文件很大（比我的 RAM 大得多）时，我用它来删除尾随的空值：

```
static void RemoveTrailingNulls(string inputFilename, string outputFilename)
{
    int bufferSize = 100 * 1024 * 1024;
    long totalTrailingNulls = 0;
    byte[] emptyArray = new byte[bufferSize];

    using (var inputFile = File.OpenRead(inputFilename))
    using (var inputFileReversed = new ReverseStream(inputFile))
    {
        var buffer = new byte[bufferSize];

        while (true)
        {
            var start = DateTime.Now;

            var bytesRead = inputFileReversed.Read(buffer, 0, buffer.Length);

            if (bytesRead == emptyArray.Length && Enumerable.SequenceEqual(emptyArray, buffer))
            {
                totalTrailingNulls += buffer.Length;
            }
            else
            {
                var nulls = buffer.Take(bytesRead).TakeWhile(b => b == 0).Count();
                totalTrailingNulls += nulls;

                if (nulls < bytesRead)
                {
                    //found the last non-null byte
                    break;
                }
            }

            var duration = DateTime.Now - start;
            var mbPerSec = (bytesRead / (1024 * 1024D)) / duration.TotalSeconds;
            Console.WriteLine($"{mbPerSec:N2} MB/seconds");
        }

        var lastNonNull = inputFile.Length - totalTrailingNulls;

        using (var outputFile = File.Open(outputFilename, FileMode.Create, FileAccess.Write))
        {
            inputFile.Seek(0, SeekOrigin.Begin);
            inputFile.CopyTo(outputFile, lastNonNull, bufferSize);
        }
    }
} 
```

它使用 ReverseStream 类，可在[此处](https://stackoverflow.com/a/68319223/171846)找到。

而这个扩展方法：

```
public static class Extensions
{
    public static long CopyTo(this Stream input, Stream output, long count, int bufferSize)
    {
        byte[] buffer = new byte[bufferSize];
        long totalRead = 0;
        while (true)
        {
            if (count == 0) break;

            int read = input.Read(buffer, 0, (int)Math.Min(bufferSize, count));

            if (read == 0) break;
            totalRead += read;

            output.Write(buffer, 0, read);
            count -= read;
        }

        return totalRead;
    }
} 
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2010-04-27T22:02:08.130

就我而言，LINQ 方法从未完成 ^))) 使用字节数组很慢！

伙计们，为什么不使用 Array.Copy() 方法？

```
 /// <summary>
    /// Gets array of bytes from memory stream.
    /// </summary>
    /// <param name="stream">Memory stream.</param>
    public static byte[] GetAllBytes(this MemoryStream stream)
    {
        byte[] result = new byte[stream.Length];
        Array.Copy(stream.GetBuffer(), result, stream.Length);

        return result;
    } 
```

# selenium - NAnt、MbUnit、CruiseControl、Selenium - 将设置传递给测试程序集

> ID：240263
> 
> 赞同：1
> 
> 时间：2008-10-27T15:17:09.473
> 
> 标签：selenium, cruisecontrol.net, nant, mbunit

我正在为我们的自动化测试平台整理一些想法，并且一直在寻找 Selenium 的测试运行器。

我将记录的 Selenium C# 脚本包装在 MbUnit 测试中，该测试是通过 MbUnit NAnt 任务触发的。Selenium 测试客户端创建如下：

```
selenium = new DefaultSelenium("host", 4444, "*iexplore", "http://[url]/"); 
```

如何将主机、端口和 url 设置传递到测试中，以便可以通过 NAnt 任务控制它们的值？

例如，我可能有多个 Selenium RC 服务器在监听，并且我想使用相同的测试代码在每个服务器地址中传递，而不是在测试本身中嵌入设置。

我有一个使用我编写的自定义 NAnt 任务模拟的方法，但它不是目前最优雅的解决方案，我想知道是否有更简单的方法来完成我想做的事情。

如果有人可以提供帮助，非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T15:36:19.030

感谢您到目前为止的回复。

环境变量可以工作，但是，我们可以通过单个测试程序集运行并行测试，因此我不希望在执行期间覆盖设置，这可能会破坏另一个测试。不过，有趣的思路，谢谢，我想我可以在其他领域使用它。

我当前的解决方案涉及在 MbUnit 任务之上构建的自定义 NAnt 任务，它允许我将其他主机、端口、url 设置指定为属性。然后将它们保存为构建目录中的配置文件，然后由测试程序集读入。这对我来说有点“笨拙”，因为我的测试需要从特定的类继承。还不错，但我希望减少依赖并专注于测试。

可能是我多虑了！！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T12:49:22.217

我有一个所有测试夹具的基类，它具有以下设置代码：

```
 [FixtureSetUp]
    public virtual void TestFixtureSetup ()
    {
        BrowserType = (BrowserType) Enum.Parse (typeof (BrowserType),
            System.Configuration.ConfigurationManager.AppSettings["BrowserType"],
            true);
        testMachine = System.Configuration.ConfigurationManager.AppSettings["TestMachine"];
        seleniumPort = int.Parse (System.Configuration.ConfigurationManager.AppSettings["SeleniumPort"],
            System.Globalization.CultureInfo.InvariantCulture);
        seleniumSpeed = System.Configuration.ConfigurationManager.AppSettings["SeleniumSpeed"];
        browserUrl = System.Configuration.ConfigurationManager.AppSettings["BrowserUrl"];
        targetUrl = new Uri (System.Configuration.ConfigurationManager.AppSettings["TargetUrl"]);

        string browserExe;
        switch (BrowserType)
        {
            case BrowserType.InternetExplorer:
                browserExe = "*iexplore";
                break;
            case BrowserType.Firefox:
                browserExe = "*firefox";
                break;

            default:
                throw new NotSupportedException ();
        }

        selenium = new DefaultSelenium (testMachine, seleniumPort, browserExe, browserUrl);
        selenium.Start ();

        System.Console.WriteLine ("Started Selenium session (browser type={0})",
            browserType);

        // sets the speed of execution of GUI commands
        if (false == String.IsNullOrEmpty (seleniumSpeed))
            selenium.SetSpeed (seleniumSpeed);
    } 
```

然后我简单地为测试运行器提供一个配置。文件：

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T15:25:07.930

每当我需要使用 NAnt 与外部实体集成时，我要么最终使用**exec 任务**，要么编写**自定义任务**。鉴于您发布的信息，您自己编写似乎确实是一个很好的解决方案，但是您表示您对此不满意。您能否详细说明为什么您认为您当前的解决方案不是一个*优雅*的解决方案？

## 更新

不知道*内部*细节，您似乎已经通过自定义任务很好地解决了它。据我所知，我会这样做。

也许一个新的解决方案会及时出现，但现在对自己轻点！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-27T15:26:35.773

对于 MSBuild，我使用环境变量，我在 CC.NET 配置中创建它们，然后它们将在脚本中可用。我认为这对你也有用。

# eclipse - Eclipse 3.4 中的 Windows 工作集在哪里

> ID：240264
> 
> 赞同：2
> 
> 时间：2008-10-27T15:17:26.387
> 
> 标签：eclipse, eclipse-3.4

我在哪里可以找到在 Eclipse 3.4 (Ganymede) 中的 Windows 工作集之间切换的选项？在以前的版本中，它位于窗口菜单下，但它似乎已经移动。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-28T00:01:43.800

在包资源管理器中，您将在菜单栏的右上角看到一个小三角形。

点击这个会弹出一个菜单。

然后您可以选择“顶级元素”并在“项目”和“工作集”之间切换

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-27T15:41:15.883

您仍然可以在“Windows”菜单下找到它。

Windows/工作集/[您的不同工作集]

您选择要在包资源管理器中显示的不同工作集。所以它不再是一个“开关”，而是一个过滤器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T21:34:00.997

我忽略了阅读 slashnick 的评论：

正确，尽管我必须自定义透视图才能显示它（窗口 > 自定义透视图）– slashnick（10 月 28 日 9:26）

窗口 > 自定义透视命令选项卡。检查可用命令组部分中的窗口工作集

# javascript - 错误“htmlfile：无效参数”是什么意思？我在 excanvas.js 中得到这个

> ID：240269
> 
> 赞同：1
> 
> 时间：2008-10-27T15:18:59.410
> 
> 标签：javascript

我遇到了这个错误，我不确定为什么。我有一个 excanvas.js 的缩小版本，IE 中出现了一些问题，特别是：

`var b=a.createStyleSheet();`

我不确定为什么。有没有人有任何见解？我可以提供更多信息，我只是不确定哪些信息会有所帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-17T00:21:14.617

这是一个稍微旧的线程，但我认为发布它会很有用。页面可以包含多少样式信息似乎存在限制，这会导致 IE6 中出现此错误。我可以使用这个简单的测试页面产生一个无效的参数错误：

```
<html>
<head>
<title></title>
<script>
for(var i=0;i<32;i++) {
document.createStyleSheet();
}
</script>
</head>
<body>
</body>
</html> 
```

我认为这是问题的根源。HTH，罗素

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-11-02T04:26:59.873

最新版本的 excanvas.js 在 IE8 中没有为我解决此问题，因此我将 excanvas.js 的第 111 行更新为下面的代码，并且不再出现异常。此解决方案的代码来自[http://dean.edwards.name/weblog/2010/02/bug85/](http://dean.edwards.name/weblog/2010/02/bug85/)。

```
 var ss = null;
  var cssText = 'canvas{display:inline-block;overflow:hidden;' +
      // default size is 300x150 in Gecko and Opera
      'text-align:left;width:300px;height:150px}';
  try{
    ss = doc.createStyleSheet();
    ss.owningElement.id = 'ex_canvas_';
    ss.cssText = cssText;
  } catch(e) {
    ss = document.styleSheets[document.styleSheets.length - 1];
    ss.cssText += "\r\n" + cssText;
  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T08:31:59.813

我要做的第一件事是使用未缩小的版本。看起来这来自一个从 onreadystatechange 调用的 init 函数，试图设置画布元素的样式，尽管这并不像人们希望的那样具有启发性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-11T06:00:44.900

最新版本的 excanvas 为我解决了这个问题。您总是可以从[svn trunk](http://code.google.com/p/explorercanvas/source/browse/#svn/trunk)获得最新版本。

# iis-6 - IIS 6，复制所有站点主机头的工具？

> ID：240278
> 
> 赞同：2
> 
> 时间：2008-10-27T15:20:36.317
> 
> 标签：iis-6, hostheaders

我有一个 Server 2003 框，其中包含大约 6 个站点，每个站点大约有 15-20 个主机标头。

是否有一个工具可以复制所有主机头记录并自动将它们移动到新服务器，这样我就不必在新服务器中再次手动输入每个主机头？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T17:06:34.573

如果您通过 IIS 管理器保存配置（右键单击所有任务 -> 将配置保存到文件），这将导出所有主机头信息以及有关网站的所有其他信息。然后在新服务器上，您可以导入此配置以重新创建网站。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T15:53:52.863

你可以试试Web Deployment Tool，它可以在IIS服务器之间同步设置： [http ://www.iis.net/downloads/default.aspx?tabid=34&g=6&i=1602](http://www.iis.net/downloads/default.aspx?tabid=34&g=6&i=1602)

您还应该能够从一个 IIS 框中导出设置并在另一个框中导入它们。

# visual-studio - What does the VisualStudio Dataset visualizer exclaimation mark mean?

> ID：240279
> 
> 赞同：1
> 
> 时间：2008-10-27T15:21:58.810
> 
> 标签：visual-studio, dataset, visualizer

Some rows in the dataset visualizer have an exclamation mark for each column, other rows have the data as expected. I have been unable to track down a description for the exclamation mark or indeed any symbol within the dataset visualizer.

What does the VisualStudio Dataset visualizer exclaimation mark mean?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T13:34:25.907

不知道，但尝试打开表而不是数据集（似乎效果更好）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T13:09:34.763

这意味着数据被删除。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-18T21:02:55.840

我不会说这意味着数据被删除，因为我多次遇到同样的问题，这促使我创建自己的可视化工具来查看是否有同样的问题。

[无论如何，它发展了一点，可以从www.srsoftware.co.uk](http://www.srsoftware.co.uk/portal/index.php?option=com_content&view=category&layout=blog&id=38&Itemid=65)免费下载

# rest - 授权 REST 请求

> ID：240283
> 
> 赞同：15
> 
> 时间：2008-10-27T15:22:21.710
> 
> 标签：rest, authentication, http-headers, authorization, rest-security

我正在开发一个有一些要求的 REST 服务：

1.  它必须是安全的。
2.  用户不应该能够伪造请求。

我目前提出的解决方案是有一个看起来像这样的自定义授权标头（这与亚马逊网络服务的工作方式相同）：

```
Authorization: MYAPI username:signature 
```

我的问题是如何形成签名。当用户登录服务时，他们会获得一个密钥，他们应该能够使用它来签署请求。这将阻止其他用户代表他们提交请求，但不会阻止他们伪造请求。

将使用此服务的应用程序是一个 iPhone 应用程序，所以我想我们可以在应用程序中嵌入一个公钥，我们可以用它来做一个额外的签名，但这是否意味着我们必须有两个签名，一个一个用户密钥和一个应用程序密钥？

任何建议将不胜感激，我很想第一次就做到这一点。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-01T09:04:32.317

答案很简单：做不到。一旦您向最终用户提供任何解决方案，他或她就可以随时攻击与之通信的服务器。此问题最常见的版本是在 Flash 游戏中使用高分列表作弊。您可以通过在客户端中嵌入某种加密并混淆代码来使其*更难......但是所有编译和混淆的代码都可以被反编译和不混淆。*这只是你愿意花费多少时间和金钱的问题，同样的还有潜在的攻击者。

So your concern is *not* how to try to prevent the user from sending faulty data to your system. It is how to prevent the user from *damaging* your system. You have to design your interfaces so that all damage done by faulty data only affects the user sending it.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-27T15:29:21.603

[HTTP 摘要式身份验证](http://en.wikipedia.org/wiki/Digest_access_authentication)有什么问题？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T15:27:34.447

我认为最简单的方法是使用 HTTPS 客户端身份验证。苹果的网站有一个关于这个主题的主题[。](http://discussions.apple.com/thread.jspa?threadID=1643618)

编辑：为了处理授权，我会在服务器上为每个用户创建一个单独的资源 (URI)，并且只允许该（经过身份验证的）用户操作该资源。

编辑（2014）：苹果在过去六年改变了他们的论坛软件；该线程现在位于[https://discussions.apple.com/thread/1643618](https://discussions.apple.com/thread/1643618)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-31T20:24:42.827

这里有一个更好的讨论：

[保护 REST API/Web 服务的最佳实践](https://stackoverflow.com/questions/7551/best-practices-for-securing-a-rest-api-web-service)

# javascript - JavaScript 中的日期解析和验证

> ID：240293
> 
> 赞同：1
> 
> 时间：2008-10-27T15:24:23.500
> 
> 标签：javascript

我将如何在 JavaScript 中实现下面的伪代码？我想在第二个代码摘录中包含日期检查，其中 txtDate 用于 BilledDate。

```
If ABS(billeddate – getdate)  >  31 then yesno “The date you have entered is more than a month from today, Are you sure the date is correct,”.

if (txtDate && txtDate.value == "")
{
    txtDate.focus();
    alert("Please enter a date in the 'Date' field.")
    return false;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T15:39:26.077

一般来说，您在 javascript 中使用日期对象，这些对象应使用以下语法构造：

```
 var myDate = new Date(yearno, monthno-1, dayno);
    //you could put hour, minute, second and milliseconds in this too 
```

请注意，月份部分是一个索引，所以一月是 0，二月是 1，十二月是 11！-)

然后你可以取出你想要的任何东西，.getTime() 东西返回自 Unix 时代开始以来的毫秒数，1/1 1970 00:00，你可以减去这个值，然后看看这个值是否大于你要：

```
//today (right now !-) can be constructed by an empty constructor
var today = new Date();
var olddate = new Date(2008,9,2);
var diff = today.getTime() - olddate.getTime();
var diffInDays = diff/(1000*60*60*24);//24 hours of 60 minutes of 60 second of 1000 milliseconds

alert(diffInDays); 
```

这将返回一个十进制数，因此您可能需要查看整数值：

```
alert(Math.floor(diffInDays)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T15:42:13.793

要在纯 JavaScript 中获取以天为单位的日期差异，您可以这样做：

```
var billeddate = Date.parse("2008/10/27");
var getdate = Date.parse("2008/09/25");

var differenceInDays = (billeddate - getdate)/(1000*60*60*24) 
```

但是，如果您想在日期操作中获得更多控制权，我建议您使用日期库，我喜欢[DateJS](http://www.datejs.com/)，以多种格式解析和操作日期非常好，而且它确实是语法糖：

```
// What date is next thrusday?
Date.today().next().thursday();
//or
Date.parse('next thursday');

// Add 3 days to Today
Date.today().add(3).days();

// Is today Friday?
Date.today().is().friday();

// Number fun
(3).days().ago(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T15:44:16.720

您可以使用它来检查有效日期

```
function IsDate(testValue) {

        var returnValue = false;
        var testDate;
        try {
            testDate = new Date(testValue);
            if (!isNaN(testDate)) {
                returnValue = true;            
            }
            else {
                returnValue = false;
            }
        }
        catch (e) {
            returnValue = false;
        }
        return returnValue;
    } 
```

这就是您可以操纵 JS 日期的方式。您基本上创建了一个现在的日期对象（getDate），添加 31 天并将其与输入的日期进行比较

```
function IsMoreThan31Days(dateToTest) {

  if(IsDate(futureDate)) {
      var futureDateObj = new Date();
      var enteredDateObj = new Date(dateToTest);

      futureDateObj.setDate(futureDateObj.getDate() + 31); //sets to 31 days from now.
      //adds hours and minutes to dateToTest so that the test for 31 days is more accurate.
      enteredDateObj.setHours(futureDateObj.getHours()); 
      enteredDateObj.setMinutes(futureDateObj.getMinutes() + 1);

      if(enteredDateObj >= futureDateObj) {
        return true;
      }
      else {
        return false;
      }
   }
} 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2008-10-27T15:32:26.760

大家好，美好的一天

您可以尝试使用 Refular Expressions 来解析和验证日期格式

这是一个网址，您可以观看一些示例以及如何使用

[http://www.javascriptkit.com/jsref/regexp.shtml](http://www.javascriptkit.com/jsref/regexp.shtml)

一个非常简单的模式是：\d{2}/\d{2}/\d{4}

对于 MM/dd/yyyy 或 dd/MM/yyyy

没有了……再见

# java - 给定一个 Java InputStream，如何确定流中的当前偏移量？

> ID：240294
> 
> 赞同：16
> 
> 时间：2008-10-27T15:24:55.403
> 
> 标签：java, io, inputstream

我想要一个通用的、可重用的`getPosition()`方法，它会告诉我从流的起点读取的字节数。理想情况下，我希望它能够与所有 InputStreams 一起使用，这样当我从不同的来源获取它们时，我就不必包装它们中的每一个。

这样的野兽存在吗？如果没有，任何人都可以推荐现有的计数实现`InputStream`吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-27T16:05:15.273

您需要遵循建立的装饰器模式`java.io`来实现这一点。

让我们在这里尝试一下：

```
import java.io.FilterInputStream;
import java.io.IOException;
import java.io.InputStream;

public final class PositionInputStream
  extends FilterInputStream
{

  private long pos = 0;

  private long mark = 0;

  public PositionInputStream(InputStream in)
  {
    super(in);
  }

  /**
   * <p>Get the stream position.</p>
   *
   * <p>Eventually, the position will roll over to a negative number.
   * Reading 1 Tb per second, this would occur after approximately three 
   * months. Applications should account for this possibility in their 
   * design.</p>
   *
   * @return the current stream position.
   */
  public synchronized long getPosition()
  {
    return pos;
  }

  @Override
  public synchronized int read()
    throws IOException
  {
    int b = super.read();
    if (b >= 0)
      pos += 1;
    return b;
  }

  @Override
  public synchronized int read(byte[] b, int off, int len)
    throws IOException
  {
    int n = super.read(b, off, len);
    if (n > 0)
      pos += n;
    return n;
  }

  @Override
  public synchronized long skip(long skip)
    throws IOException
  {
    long n = super.skip(skip);
    if (n > 0)
      pos += n;
    return n;
  }

  @Override
  public synchronized void mark(int readlimit)
  {
    super.mark(readlimit);
    mark = pos;
  }

  @Override
  public synchronized void reset()
    throws IOException
  {
    /* A call to reset can still succeed if mark is not supported, but the 
     * resulting stream position is undefined, so it's not allowed here. */
    if (!markSupported())
      throw new IOException("Mark not supported.");
    super.reset();
    pos = mark;
  }

} 
```

InputStreams 旨在是线程安全的，因此可以自由使用同步。我玩过`volatile`和`AtomicLong`位置变量，但同步可能是最好的，因为它允许一个线程在流上操作并查询它的位置而不放弃锁。

```
PositionInputStream is = …
synchronized (is) {
  is.read(buf);
  pos = is.getPosition();
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-27T17:31:35.990

看看Commons IO 包中的[CountingInputStream](http://commons.apache.org/io/apidocs/org/apache/commons/io/input/CountingInputStream.html)。他们还收集了很多其他有用的 InputStream 变体。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-09-17T08:28:27.357

[番石榴](https://github.com/google/guava)中也`CountingInputStream`有。

apidocs： [https ://google.github.io/guava/releases/19.0/api/docs/com/google/common/io/CountingInputStream.html](https://google.github.io/guava/releases/19.0/api/docs/com/google/common/io/CountingInputStream.html)

来源：[https ://github.com/google/guava/blob/master/guava/src/com/google/common/io/CountingInputStream.java](https://github.com/google/guava/blob/master/guava/src/com/google/common/io/CountingInputStream.java)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-27T15:29:23.770

No.`InputStream`旨在处理可能无限量的数据，因此计数器会妨碍您。除了将它们全部包装起来之外，您还可以对方面做一些事情。

# wpf - SCE - 自定义数据馈送

> ID：240306
> 
> 赞同：5
> 
> 时间：2008-10-27T15:27:58.860
> 
> 标签：wpf, windows-client

我正在使用联合客户端体验 (SCE) SDK。有没有人为此创建自定义数据馈送成功？我希望能够在 URL 上托管 masterfeed 和其他提要，而不是像示例那样编译为嵌入式资源。例如，客户端应用程序将从`http://somesite/masterfeed.xml`.

我相信这是可以做到的，但是在调试 SCE 客户端期间，我不断收到 AccessViolation 异常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-12T08:52:33.517

The application just happened to be writing to a bad memory space.

# sxs - 如何为本地 SxS dll 编写策略重定向文件？

> ID：240313
> 
> 赞同：1
> 
> 时间：2008-10-27T15:29:35.143
> 
> 标签：sxs

我在哪里可以找到一个很好的参考资料来解释如何编写和安装从一个本机程序集版本重定向到另一个的 SxS 策略？

我已经使用 wix 安装程序成功构建和安装了两个版本的本机程序集。但我不确定如何从这里开始。我发现的大部分信息都是关于托管程序集和 GAC 的。我正在寻找的过程与托管 dll 的过程是否相同？

谢谢你的帮助，丹

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T07:07:59.953

[我是微软 Native SxS 的当前维护者]

嗨，丹，

发布者策略是一种特殊类型的程序集。它的安装方式与任何其他程序集相同，但使用 type="win32-policy" 和 name="policy.MAJMINVERSION.name" 您可以[在此处](http://msdn.microsoft.com/en-us/library/aa375682.aspx)阅读有关它的更多信息， 或者您可以查看 CRT 的策略是如何编写的。在我的 Vista 机器上，它位于

```
 %windir%\winsxs\manifests\x86_policy.8.0.microsoft.vc80.crt_....manifest 
```

由于您似乎正在创作一个新程序集，因此可能还没有必要提供发布者策略，因为它仅在为您的程序集提供服务时发挥作用（通过将旧版本重定向到新版本）。

# struts - 如何修剪struts中的输入字段值？

> ID：240314
> 
> 赞同：4
> 
> 时间：2008-10-27T15:29:56.640
> 
> 标签：struts

我使用 Struts v1.3 并具有以下输入形式：

在 struts-config.xml 中：

```
 <form-bean name="testForm" 
               type="org.apache.struts.validator.DynaValidatorForm">
        <form-property name="displayName" type="java.lang.String" />
    </form-bean> 
```

在validation.xml 中：

```
 <form name="testForm">
        <field property="displayName" depends="required">
            <arg key="input.displayName" />
        </field>
    </form> 
```

如何修剪“displayName”的值？如何修剪表单的所有“java.lang.String”输入字段的值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T21:04:11.373

您现在可能有机会修剪字符串，请求处理器将数据从输入字段更新到表单。这没有经过测试，但是当您将设置器 setDisplayName(String displayName) 修改为类似

```
public void setDisplayName(String displayName) {
    this.displayName = displayName.trim();
} 
```

这不是一个很好的解决方案，因为它会将逻辑迁移到 setter 中。

问候

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-06-11T07:40:41.053

如果您想将 trim 用于**验证**目的，我认为正确的方法是为需要 trim 的必填字段创建和使用您自己的（或扩展现有的）验证器。例如，您可以使用此页面：[http](http://struts.apache.org/1.2.4/userGuide/dev_validator.html) ://struts.apache.org/1.2.4/userGuide/dev_validator.html ，“Pluggable Validators”部分。

如果您想**在业务逻辑中使用它们**之前使用 trim 修剪 String 值，您可以扩展*org.apache.struts.validator.DynaValidatorForm*并覆盖检索值的方法，如*get(String name)*，*getString(String name )*等等。之后，您在*form-b​​ean*声明中使用您的类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T17:05:12.313

如果您不介意在 Form 类中使用 String 操作逻辑，可以尝试 Apache 的 Commons Lang JAR 中的 StringUtils 方法：

[StringUtils JavaDoc](http://commons.apache.org/lang/api/org/apache/commons/lang/StringUtils.html)

这将允许您以多种特定方式修剪您的字符串，无论您是想要 trimToEmpty、trimToNull 等。这意味着您可以访问 null 安全方法，这对某些值很有用。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-09T16:36:00.137

或者尝试在将修剪 onfocus 或 onblur 的 jsp 中使用 javascript regexp

> < html:text name="testForm" property="displayName" onfocus="javascript:this.value=this.value.replace(/^\s+|\s+$/g,'')" onblur="javascript:this .value=this.value.replace(/^\s+|\s+$/g,'')" />

# java - 如何包装一个方法，以便在它超过指定的超时时终止它的执行？

> ID：240320
> 
> 赞同：15
> 
> 时间：2008-10-27T15:34:02.030
> 
> 标签：java, multithreading, concurrency, callable

我有一个我想调用的方法。但是，如果执行时间过长，我正在寻找一种干净、简单的方法来杀死它或强制它返回。

我正在使用 Java。

为了显示：

```
logger.info("sequentially executing all batches...");
for (TestExecutor executor : builder.getExecutors()) {
logger.info("executing batch...");
executor.execute();
} 
```

我认为这`TestExecutor`门课应该`implement Callable`并继续朝着这个方向前进。

但我想做的就是`executor.execute()`在时间太长时停下来。

建议...？

**编辑**

收到的许多建议都假设正在执行的需要很长时间的方法包含某种循环，并且可以定期检查变量。然而，这种情况并非如此。因此，某些不一定是干净的，并且只会在可以接受的地方停止执行。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-27T22:03:36.033

你应该看看这些类： [FutureTask](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/FutureTask.html)、[Callable](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/Callable.html)、[Executors](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/Executors.html)

这是一个例子：

```
public class TimeoutExample {
    public static Object myMethod() {
        // does your thing and taking a long time to execute
        return someResult;
    }

    public static void main(final String[] args) {
        Callable<Object> callable = new Callable<Object>() {
            public Object call() throws Exception {
                return myMethod();
            }
        };
        ExecutorService executorService = Executors.newCachedThreadPool();

        Future<Object> task = executorService.submit(callable);
        try {
            // ok, wait for 30 seconds max
            Object result = task.get(30, TimeUnit.SECONDS);
            System.out.println("Finished with result: " + result);
        } catch (ExecutionException e) {
            throw new RuntimeException(e);
        } catch (TimeoutException e) {
            System.out.println("timeout...");
        } catch (InterruptedException e) {
            System.out.println("interrupted");
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-27T15:56:54.137

Java 的[中断机制](http://www.ibm.com/developerworks/java/library/j-jtp05236.html)就是为这种场景设计的。如果您希望中止的方法正在执行一个循环，只需让它在每次迭代时检查线程的[中断状态。](http://java.sun.com/javase/6/docs/api/java/lang/Thread.html#isInterrupted())如果它被中断，则抛出一个 InterruptedException。

然后，当你想中止时，你只需要在适当的线程上调用[中断。](http://java.sun.com/javase/6/docs/api/java/lang/Thread.html#interrupt())

或者，您可以使用 Sun 建议的[方法](http://java.sun.com/javase/6/docs/technotes/guides/concurrency/threadPrimitiveDeprecation.html)作为已弃用的停止方法的替代方法。这不涉及抛出任何异常，该方法只会正常返回。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-27T15:40:03.187

我假设在以下语句中使用了多个线程。

我在这方面做了一些阅读，大多数作者说杀死另一个线程是个坏主意。

如果您要终止的函数可以设计为定期检查变量或同步原语，然后在设置了该变量或同步原语时干净地终止，那将非常干净。然后某种监视器线程可以休眠数毫秒，然后设置变量或同步原语。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-27T15:54:53.610

真的，你不能......唯一的方法是使用thread.stop，同意“合作”方法（例如偶尔检查Thread.isInterrupted或调用抛出InterruptedException的方法，例如Thread。 sleep())，或者以某种方式完全调用另一个 JVM 中的方法。

对于某些类型的测试，调用 stop() 是可以的，但它可能会损坏测试套件的状态，因此如果要避免交互影响，则必须在每次调用 stop() 后重新启动 JVM。

有关如何实现协作方法的详细说明，请查看[Sun 的关于已弃用的 Thread 方法的常见问题解答](http://java.sun.com/javase/6/docs/technotes/guides/concurrency/threadPrimitiveDeprecation.html)。

对于现实生活中这种方法的一个示例，[Eclipse RCP 的 Job API 的](http://www.eclipse.org/articles/Article-Concurrency/jobs-api.html)“IPProgressMonitor”对象允许某些管理服务（通过“取消”方法）向子流程发出信号，它们应该停止。当然，这依赖于定期实际检查 isCancelled 方法的方法，而他们经常无法做到这一点。

一种混合方法可能是用中断很好地询问线程，然后在几秒钟后用停止坚持。同样，您不应该在生产代码中使用 stop ，但在这种情况下它可能没问题，尤其是。如果您很快退出 JVM。

为了测试这种方法，我编写了一个简单的工具，它接受一个可运行文件并尝试执行它。随意评论/编辑。

```
public void testStop(Runnable r) {
    Thread t = new Thread(r);
    t.start();
    try {
        t.join(2000);
    } catch (InterruptedException e) {
        throw new RuntimeException(e);
    }

    if (!t.isAlive()) {
        System.err.println("Finished on time.");
        return;
    }

    try {
        t.interrupt();
        t.join(2000);
        if (!t.isAlive()) {
            System.err.println("cooperative stop");
            return;
        }
    } catch (InterruptedException e) {
        throw new RuntimeException(e);
    }
    System.err.println("non-cooperative stop");
    StackTraceElement[] trace = Thread.getAllStackTraces().get(t);
    if (null != trace) {
        Throwable temp = new Throwable();
        temp.setStackTrace(trace);
        temp.printStackTrace();
    }
    t.stop();
    System.err.println("stopped non-cooperative thread");
} 
```

为了测试它，我编写了两个相互竞争的无限循环，一个是合作的，一个从不检查其线程的中断位。

```
public void cooperative() {
    try {
        for (;;) {
            Thread.sleep(500);
        }
    } catch (InterruptedException e) {
        System.err.println("cooperative() interrupted");
    } finally {
        System.err.println("cooperative() finally");
    }
}

public void noncooperative() {
    try {
        for (;;) {
            Thread.yield();
        }
    } finally {
        System.err.println("noncooperative() finally");
    }
} 
```

最后，我编写了测试（JUnit 4）来练习它们：

```
@Test
public void testStopCooperative() {
    testStop(new Runnable() {
        @Override
        public void run() {
            cooperative();
        }
    });
}

@Test
public void testStopNoncooperative() {
    testStop(new Runnable() {
        @Override
        public void run() {
            noncooperative();
        }
    });
} 
```

我以前从未使用过 Thread.stop()，所以我不知道它的操作。它的工作原理是从目标线程当前正在运行的任何地方抛出一个 ThreadDeath 对象。这扩展了错误。因此，虽然它并不总是干净地工作，但它通常会使简单的程序具有相当合理的程序状态。例如，调用任何 finally 块。如果你想成为一个真正的混蛋，你可以*抓住*ThreadDeath（或错误），然后继续运行，无论如何！

如果不出意外，这真的让我希望更多的代码遵循 IProgressMonitor 方法 - 向*可能*需要一段时间的方法添加另一个参数，并鼓励方法的实现者偶尔轮询 Monitor 对象以查看用户是否希望系统提供向上。将来我会尝试遵循这种模式，尤其是可能是交互式的方法。当然，您不一定事先知道将以这种方式使用哪些方法，但我猜这就是 Profiler 的用途。

至于“完全启动另一个JVM”方法，这将需要更多的工作。我不知道是否有人编写了委托类加载器，或者是否包含在 JVM 中，但这种方法需要这样做。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-27T17:16:00.437

没有人直接回答它，所以这是我可以用少量伪代码给你的最接近的东西：

将方法包装在可运行/可调用中。如果要停止该方法本身，则必须检查中断状态（例如，如果此方法是循环，则在循环内部检查 Thread.currentThread().isInterrupted ，如果是，则停止循环（不要'不要检查每次迭代，否则你只会减慢速度。在包装方法中，使用 thread.join(timeout) 等待你想让方法运行的时间。或者，在那里的循环中，调用 join如果您在等待时需要做其他事情，则以较小的超时重复。如果方法未完成，加入后，使用上述建议快速/干净地中止。

所以代码明智，旧代码：

```
void myMethod()
{
    methodTakingAllTheTime();
} 
```

新代码：

```
void myMethod()
{
    Thread t = new Thread(new Runnable()
        {
            public void run()
            {
                 methodTakingAllTheTime(); // modify the internals of this method to check for interruption
            }
        });
    t.join(5000); // 5 seconds
    t.interrupt();
} 
```

但同样，为了使其正常工作，您仍然必须修改 methodTakingAllTheTime 否则该线程将在您调用中断后继续运行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-19T03:58:56.000

我相信正确的答案是创建一个 Runnable 来执行子程序，并在单独的线程中运行它。Runnable 可能是 FutureTask，您可以使用超时（“get”方法）运行它。如果超时，你会得到一个 TimeoutException，我建议你在其中

*   调用 thread.interrupt() 以尝试以半合作的方式结束它（许多库调用似乎对此很敏感，因此它可能会起作用）
*   稍等（Thread.sleep(300)）
*   然后，如果线程仍然处于活动状态 (thread.isActive())，则调用 thread.stop()。这是一种已弃用的方法，但显然是城里唯一没有运行一个单独的进程的游戏。

在我的应用程序中，我运行由我的初学者编写的不受信任、不合作的代码，我执行上述操作，确保被杀死的线程永远无法（写入）访问任何在其死亡后幸存下来的对象。这包括包含被调用方法的对象，如果发生超时，该对象将被丢弃。（我告诉我的学生避免超时，因为他们的代理将被取消资格。）我不确定内存泄漏......

我区分了长运行时（方法终止）和硬超时 - 硬超时更长，旨在捕捉代码根本没有终止的情况，而不是慢速。

根据我的研究，Java 似乎没有不推荐的运行非协作代码的规定，这在某种程度上是安全模型中的一个巨大漏洞。要么我可以运行外来代码并控制它拥有的权限（SecurityManager），要么我不能运行外来代码，因为它最终可能会占用整个 CPU 而没有不推荐的方法来阻止它。

```
double x = 2.0;  
while(true) {x = x*x}; // do not terminate
System.out.print(x); // prevent optimization 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-05-06T11:41:25.847

我能想到一个不太好的方法来做到这一点。如果您可以检测到何时花费了太多时间，则可以让该方法在每个步骤中检查布尔值。如果花费太多时间，让程序将 boolean tooMuchTime 的值更改为 true（我对此无能为力）。然后使用这样的东西：

```
 Method(){
 //task1
if (tooMuchTime == true) return;
 //task2
if (tooMuchTime == true) return;
 //task3
if (tooMuchTime == true) return;
//task4
if (tooMuchTime == true) return;
//task5
if (tooMuchTime == true) return;
//final task
  } 
```

# language-agnostic - 如何以聪明的方式报告错误

> ID：240323
> 
> 赞同：5
> 
> 时间：2008-10-27T15:35:41.013
> 
> 标签：language-agnostic, bug-reporting

我想以类似于 ESR 的[How To Ask Questions The Smart Way的风格编写（或查找）有效错误报告的指南](http://www.catb.org/~esr/faqs/smart-questions.html)

您对有效的错误报告有哪些重要提示？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-27T15:39:16.777

*   有关如何重新创建错误的分步说明
*   确保您已尝试将错误与您实际编写错误的对象隔离开来，而不是可能是其他原因。
*   列出尝试将错误与您正在编写错误的软件之外的其他东西隔离开来
*   让自己可以回答问题并可以帮助解决/重新创建错误

最重要的是，当遇到错误时，您必须进行某种程度的批判性思考。一旦你用尽了所有可能是你的错的可能性，写一个错误。如果您发现它是您的错，但您正在使用/测试的软件可能已经做了一些更有用的事情来表明它是您的错，仍然写一个错误。

此外，要成为真正出色的错误报告者，您必须利用那些测试错误的人来帮助他们重新创建它。很可能您刚刚“掌握了重新创建该错误的诀窍”，并且可能存在您没有意识到的步骤。你不能只是抱怨然后走开，参与这个过程并通过测试、重建和故障排除来帮助团队。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-27T15:48:43.450

报告可观察到的事实**，然后**报告您对这些事实的解释。

有时最好的错误报告包括一些对问题理解的直觉。仅提供事实的错误报告会低估这一宝贵的人力资源。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-27T15:44:31.620

*   用于重新创建错误的程序，包括正在执行的操作、正在使用的应用程序的哪个区域以及当时正在发生的事件。
*   可再现性声明（可靠，不可靠） - 帮助开发人员了解再现的难度，因此他们不会很快放弃
*   生成的错误消息/堆栈跟踪的屏幕截图或文档
*   错误的严重性/优先级（是否可以避免、避免步骤、是否是灾难性的、是否有业务影响、业务风险是什么等）
*   环境 - 在哪个环境中发现错误。远程、本地等。

很多时候，我们的 QA 人员认为他们可以只写一张票说，这是我的例外，没有任何备份文档。它几乎不可能重现，更不用说在没有更多信息的情况下解决问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-27T16:05:40.983

**不要假设您的错误报告的读者和您一样了解该软件**。如果自编写软件以来已经过了足够长的时间，即使是编写软件的人也可能不知道您在说什么。编写它以便*任何人都*可以理解和重现问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-16T01:51:03.670

推荐这篇文章：[如何有效地报告错误](http://www.chiark.greenend.org.uk/~sgtatham/bugs.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-27T18:48:42.137

对于所有不会在没有复制步骤的情况下查看某些内容的人：
我的第一份编程合作工作给我分配了一个错误，该错误本质上是一个随机竞争条件，导致系统不稳定。它发生在系统执行的任何时候，我们所拥有的只是一些堆栈跟踪，指向一段显然很好的代码。在某个地方，另一个线程正在处理不应该出现的数据，如果该线程处于正确的位置，它就会崩溃。我们的 QA 大约每月发生一次崩溃。花了两周时间梳理系统才找到罪魁祸首（是的，未经检查的共享资源访问，大约 2 行修复）并修复它。从来没有一个像样的复制步骤，因为没有通用的方法来复制它（除了在正确的位置推一堆yield（））。如果你要在多线程系统上工作，

请注意，上述内容不是 QA 尽可能不包含尽可能多细节的借口，只是指出在现代软件中并不总是可以做到这一点。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-27T15:37:34.690

编写重现错误的步骤。如果你不能复制它，它就不会得到修复。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-27T18:29:03.020

*   始终报告被测软件的版本号
*   始终报告任何其他软件（浏览器、操作系统等）的版本
*   始终列出所有硬件
*   重现步骤
*   虫子的症状
*   屏幕截图、痕迹、日志、其他附件（如果有）
*   有多重要——崩溃、UI 等。
*   报告是否可重现
*   任何其他尝试过的，是否重现了错误

# c# - 如何挂钩全球 PASTE EVENT？

> ID：240328
> 
> 赞同：5
> 
> 时间：2008-10-27T15:36:54.490
> 
> 标签：c#, events, hook

我正在开发一个需要知道 PASTE EVENT（通过上下文菜单或 ctrl+V）何时发生的软件（仅适用于文件/目录）。或多或少，类似的事情发生在 TeraCopy 或 Copy Handler 上。当您复制然后粘贴时，处理粘贴的是 TeraCopy。
我或多或少知道如何捕获 COPY EVENT，您只需要设置一个 ClipboardViewer 并捕获所有全局 COPY EVENTS（实际上称为：WM_DRAWCLIPBOARD）。您可以在此处了解： [http](http://www.radsoftware.com.au/articles/clipboardmonitor.aspx) : //www.radsoftware.com.au/articles/clipboardmonitor.aspx 但 ClipBoardViewer 无法让您捕捉 PASTE EVENT。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T18:58:02.167

通过“粘贴”更改状态的过程特定于单个应用程序，因此没有神奇的方法可以发现访问剪贴板后应用程序的状态是否发生了变化。

您可以做的最好的事情是检测应用程序是否已从剪贴板检索数据。同样，无法知道应用程序对这些数据做了什么。这类似于知道有人打开了他们的前门，却不知道他们去了哪里，如果在任何地方。

如果你确实想试试这个，你可以做一些事情，比如挂钩 GetClipboardData 函数。有关如何放置系统范围的 API 挂钩的信息，请查看 Micrsoft Detours 中的示例 - [http://research.microsoft.com/sn/detours](http://research.microsoft.com/sn/detours)

# performance - 您如何衡量页面加载速度？

> ID：240333
> 
> 赞同：35
> 
> 时间：2008-10-27T15:38:08.620
> 
> 标签：performance, measurement

我正在尝试量化“站点缓慢”。在过去，您只需确保您的 HTML 是轻量级的、图像经过优化并且服务器不会超载。在建立在现代内容管理系统之上的高端网站中，存在更多变量：第三方广告、跟踪器和各种其他标注、CDN 的性能（有趣的是，有时内容交付网络会使事情变得更糟）、javascript 执行、css 过载，以及各种服务器端问题，如长查询。

显而易见的答案是每个开发人员都清除缓存并不断查看 Firebug 插件的“网络”部分。您还使用了哪些其他方法来衡量“网站拖屁股”？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-10-27T15:39:30.350

[Yslow](http://developer.yahoo.com/yslow/)是一个可以帮助你的工具（浏览器扩展）。

> YSlow 根据 Yahoo! 的高性能网站规则分析网页以及网页速度慢的原因。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-28T15:07:08.900

[Firebug](https://addons.mozilla.org/en-US/firefox/addon/1843)是 Web 开发人员必备的 Firefox 扩展，可以测量网页上不同元素的加载时间。至少您可以排除 CSS、JavaScript 和其他元素加载时间过长。

如果您确实需要缩短 JavaScript 和 CSS 加载时间，网络上有各种 JavaScript 和 CSS 压缩器可以简单地从中删除不必要的文本，例如换行符和注释。当然，为了开发，保留一个普通版本。

如果您使用 PNG，我最近遇到了一个可以缩小 PNG 大小的 PNG 优化器，称为[OptiPNG](http://optipng.sourceforge.net/)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-27T20:26:22.877

一般来说，“页面加载时间”确实不容易定义。这取决于您使用的浏览器，因为不同的浏览器可能会并行执行更多请求，因为 javascript 在不同的浏览器中具有不同的速度，并且因为渲染时间不同。

因此，您只能使用您感兴趣的浏览器真正测量您的真实页面加载时间。页面加载的结束也可能难以定义，因为在页面上所有内容都可见之后可能会有 Ajax 请求。这是否计算页面加载？

最后但并非最不重要的一点是，实际页面加载时间可能并不重要，因为“感知性能”才是最重要的。对于用户来说，重要的是什么时候她有足够的信息来继续

[马库斯](http://kohlerm.blogspot.com/)

我不知道有任何方法（至少我不能告诉你：]）可以自动测量您的页面感知加载时间。

对 IE使用[AOL Pagetest](http://performance.webpagetest.org:8080/)，对 firefox 使用 YSlow（链接见上文），以获得加载时间的“感觉”。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-27T21:19:16.030

为自己安装一个合适的调试代理（我强烈推荐[Charles](http://www.charlesproxy.com/)）

您不仅可以查看响应时间/大小的完整细分，还可以保存数据以供以后分析/比较，以及摆弄请求/响应等。

（编辑：Charles 对调试 SOAP 请求的支持值得其共享软件费用的微薄 - 仅本周就为我节省了半天的脱发时间！）

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-01-12T09:46:28.873

我经常使用[webpagetest.org](http://webpagetest.org)，您可以使用它在不同的位置、在不同的浏览器（虽然只有msie 7-9）上使用不同的设置（迭代次数、连接速度、第一次运行与第二次访问，不包括特定的）执行性能测试如果需要，请求，如果需要凭据，...）。

结果是[一个非常详细的页面加载时间报告](http://www.webpagetest.org/result/110112_FR_8FTG/)，还提供了如何优化的建议。

它真的是一个很棒的（免费）工具！

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-11-12T04:56:01.680

上次我在一个大容量网站上工作时，我们做了几件事，包括：

*   我们使用**Yslow**来分析影响页面加载的各个因素：[https ://addons.mozilla.org/en-US/firefox/addon/5369](https://addons.mozilla.org/en-US/firefox/addon/5369)
*   **使用名为Gomez**的外部商业工具进行性能监控- [http://www.gomez.com/instant-test-pro/](http://www.gomez.com/instant-test-pro/)
*   **我们使用 Apache JMeter**使用持续集成构建进行压力测试。[http://jmeter.apache.org/](http://jmeter.apache.org/)

如果您想快速浏览一下，比如说**第一个近似值，我会选择 YSlow**，看看影响您的应用程序页面加载时间的主要因素是什么。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-27T15:41:37.477

好吧，叫我老式但是..

时间卷曲 -L [http://www.example.com/path](http://www.example.com/path)

在 linux 中 :) 除此之外，如前所述，我是 YSlow 的忠实粉丝。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-01-11T18:43:29.970

*PageSpeed*是 Google 出品的在线查询工具，非常准确可靠：

[https://developers.google.com/pagespeed/](https://developers.google.com/pagespeed/)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-27T15:39:43.517

如果是 asp.net，您可以使用 Trace.axd。

雅虎提供 yslow 可以很好地检查 javascript

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-30T12:02:37.057

YSlow 如上所述。

并将其与 Fiddler 结合使用。如果您想查看哪些页面对象占用了最多的带宽、哪些页面对象在服务器上被压缩、意外的往返以及正在缓存的内容，这将是很好的选择。与服务器和客户端之间的时间相比，它可以让您大致了解客户端 Web 浏览器中的处理时间

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-27T21:55:54.850

[阿帕奇基准](http://httpd.apache.org/docs/2.0/programs/ab.html)。利用

`ab -c <number of CPUs on server> -n 1000 url`

以获得对您的页面速度有多快的近似值。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-27T22:15:30.160

在[Safari](http://www.apple.com/safari/)中，[网络时间线](http://www.macobserver.com/tip/2008/03/26.1.shtml)（在开发菜单下可用，您必须专门启用）提供有关各个页面组件加载时间的有用信息，以及显示每个组件何时开始加载。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-31T18:52:09.177

Yslow 很好，IE 的 HttpWatch 也很棒。然而，两者都错过了对用户来说最重要的指标“页面（**首屏**）何时可供用户使用？”。我觉得还没有解决...

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-01-12T08:29:47.377

显然有几种方法可以确定响应时间，但挑战一直是如何衡量在浏览器中花费的渲染时间。

我们有一个受控的测试阶段，在这个阶段我们使用几个自动化工具来测试应用程序。我们从此测试生成的输出之一是每个事务的提琴手跟踪（单击）。然后，我们可以分析提琴手跟踪以了解最后一个字节的时间，并将其减去页面花费的总时间。

像这样 1\. A= 由自动化工具测量的总响应时间（在我们的例子中，我们使用 QTPro） 2\. B= 到最后一个字节的时间（服务器 + 网络时间，来自 fiddler 跟踪） 3\. C= AB (大约渲染时间，或在浏览器中花费的时间）

以上我解释的所有内容都可以作为标准测试过程，测试结束后我们可以生成每一层花费的时间分解，例如渲染时间、网络时间、数据库调用等......

# sql - SQL 日期公式

> ID：240341
> 
> 赞同：3
> 
> 时间：2008-10-27T15:39:50.490
> 
> 标签：sql, oracle, tsql, date, formulas

我需要 Oracle SQL 或 T-SQL 中的日期公式，它将返回前一周的日期（例如上周一的日期）。

我有每周运行的参数报告，通常使用参数日期为前一周的周一至周五或周日至周六。我不想在每周运行报告时输入日期。

数据在 Oracle 中，我使用 SQL Server 2005 Reporting Services (SSRS) 进行报告。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T17:32:56.690

Here is an Oracle solution for Monday.

```
select sysdate - 5 - to_number(to_char(sysdate,'D')) from dual 
```

Here are examples that retrieve any particular day from the previous week.

```
SELECT sysdate - 6 - to_number(to_char(sysdate,'D')) LastSunday FROM dual;
SELECT sysdate - 5 - to_number(to_char(sysdate,'D')) LastMonday FROM dual;
SELECT sysdate - 4 - to_number(to_char(sysdate,'D')) LastTuesday FROM dual;
SELECT sysdate - 3 - to_number(to_char(sysdate,'D')) LastWednesday FROM dual;
SELECT sysdate - 2 - to_number(to_char(sysdate,'D')) LastThursday FROM dual;
SELECT sysdate - 1 - to_number(to_char(sysdate,'D')) LastFriday FROM dual;
SELECT sysdate - 0 - to_number(to_char(sysdate,'D')) LastSaturday FROM dual; 
```

If you need the time part to be 00:00:00 wrap the statment in TRUNC(...).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-27T15:47:21.583

T-SQL：

```
SELECT 
  DateColumn,
  DateColumn - CASE DATEPART(dw, DateColumn) 
                WHEN 1 THEN 6
                ELSE DATEPART(dw, DateColumn) - 2
              END MondayOfDateColumn
FROM 
  TheTable 
```

您是否也需要时间部分为“00:00:00”？

如果是这样，请将此表达式添加到计算中：

```
DATEADD(dd, 0, DATEDIFF(dd, 0, DateColumn)) - CASE DATEPART(dw, /* etc. etc. */ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T15:47:50.287

查看[这篇文章](https://stackoverflow.com/questions/202243/custom-datetime-formatting-in-sql-server#202288)中的日期函数列表。你想要这个。

```
SELECT (DATEADD(wk,DATEDIFF(wk,0,GETDATE()) -1 ,0)) 
```

它们几乎总是数学而不是面向字符串的，因此它们比套管或铸造操作工作得更快

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-27T18:40:48.503

（甲骨文）

trunc(sysdate,'IW') -- 给出本周的星期一

trunc(sysdate,'IW')-7 --给出上周的星期一

这假设您认为星期一是一周的第一天，这就是“IW”（ISO 周）的含义。如果你认为星期天是一周的第一天......

trunc(sysdate,'W')+1 --给出本周的星期一，星期天这将是未来

trunc(sysdate,'W')+1-7 --给出上周的星期一

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-27T15:57:06.163

这是我的解决方案，经过 8 天的测试。

```
SET DateFirst 7

DECLARE @Today datetime

SET @Today = '2008-10-22'
SELECT DateAdd(wk, DateDiff(wk, 0, DateAdd(dd, -1, @Today)) - 1, 0) as PreviousMonday, @Today as Today
SET @Today = '2008-10-23'
SELECT DateAdd(wk, DateDiff(wk, 0, DateAdd(dd, -1, @Today)) - 1, 0) as PreviousMonday, @Today as Today
SET @Today = '2008-10-24'
SELECT DateAdd(wk, DateDiff(wk, 0, DateAdd(dd, -1, @Today)) - 1, 0) as PreviousMonday, @Today as Today
SET @Today = '2008-10-25'
SELECT DateAdd(wk, DateDiff(wk, 0, DateAdd(dd, -1, @Today)) - 1, 0) as PreviousMonday, @Today as Today

SET @Today = '2008-10-26'
SELECT DateAdd(wk, DateDiff(wk, 0, DateAdd(dd, -1, @Today)) - 1, 0) as PreviousMonday, @Today as Today
SET @Today = '2008-10-27'
SELECT DateAdd(wk, DateDiff(wk, 0, DateAdd(dd, -1, @Today)) - 1, 0) as PreviousMonday, @Today as Today
SET @Today = '2008-10-28'
SELECT DateAdd(wk, DateDiff(wk, 0, DateAdd(dd, -1, @Today)) - 1, 0) as PreviousMonday, @Today as Today
SET @Today = '2008-10-29'
SELECT DateAdd(wk, DateDiff(wk, 0, DateAdd(dd, -1, @Today)) - 1, 0) as PreviousMonday, @Today as Today 
```

这是星期天的麻烦：

```
SELECT
  DateDiff(wk, 0, '2008-10-25') as SatWeek, --5677
  DateDiff(wk, 0, '2008-10-26') as SunWeek, --5688
  DateDiff(wk, 0, '2008-10-27') as MonWeek  --5688

SELECT
  DatePart(dw, '2008-10-25') as SatPart,  --7
  DatePart(dw, '2008-10-26') as SunPart,  --1
  DatePart(dw, '2008-10-27') as MonPart,  --2
  convert(datetime,'2008-10-25') - (DatePart(dw, '2008-10-25') - 2)  as SatMonday,
  --'2008-10-20'
  convert(datetime,'2008-10-26') - (-1)  as SunMonday,
  --'2008-10-27'
  convert(datetime,'2008-10-27') - (DatePart(dw, '2008-10-27') - 2)  as MonMonday
  --'2008-10-27' 
```

其中许多解决方案为同一周的星期日和星期一提供相同的答案。旧的星期一不应该在另一个星期一发生之前​​辞职。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-27T16:38:34.303

在甲骨文中：

*编辑：使它更简洁一点*

*编辑：Leigh Riffel 发布了一个比我更好的解决方案。*

```
select
  case when 2 = to_char(sysdate-1,'D') then sysdate - 1
       when 2 = to_char(sysdate-2,'D') then sysdate - 2
       when 2 = to_char(sysdate-3,'D') then sysdate - 3
       when 2 = to_char(sysdate-4,'D') then sysdate - 4
       when 2 = to_char(sysdate-5,'D') then sysdate - 5
       when 2 = to_char(sysdate-6,'D') then sysdate - 6
       when 2 = to_char(sysdate-7,'D') then sysdate - 7
  end as last_monday
from dual 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-27T15:54:26.437

T-SQL 解决方案：

假设 SET DATEFIRST 为默认值（星期日 = 7），则为上星期一的日期：

```
SELECT
DATEADD(dy, DATEPART(dw, GETDATE()) - 9, GETDATE()) 
```

“-9”是返回一周（-7），然后由于星期一是 2，我们再减去 2 并添加当天的星期几。

# .net - 使用 VBScript 启动 ClickOnce Deployed Windows 应用程序

> ID：240345
> 
> 赞同：2
> 
> 时间：2008-10-27T15:40:43.763
> 
> 标签：.net, vbscript, clickonce, launch

我有一个 ClickOnce 部署的应用程序，我想从 VBScript 启动，类似于在以下示例中启动 Microsoft Word：

```
Dim word
Set word = CreateObject("Word.Application")
word.Visible = True 
```

问题是我不知道将什么参数传递给`CreateObject`函数来启动我的应用程序。我在哪里可以找到安装在我的 PC 上的应用程序的主列表/调用以启动它们的快捷方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T15:46:54.673

ClickOnce 根本就不是那样安装的。它们通常没有 COM 挂钩（用于 CreateObject），并且安装在用户配置文件（不是该机器的配置文件）的隔离部分中。不要忘记，您还可以通过 ClickOnce（来自不同位置）一次获得同一应用程序的多个副本/版本。

一种选择（在 3.5/VS2008 中）可能是使用新的文件关联的东西......将您的应用程序与“.foo”文件相关联，创建一个空的“.foo”文件并启动它。那可能行得通。查看 VS2008 中的 Publish=>Options 对话框。

否则 - 基本上，如果您想要这种类型的使用，我怀疑您将需要使用 msi（即常规安装程序；而不是 ClickOnce）将您的应用程序注册为 COM 库 (dll)。请注意，.NET 不是一个好的 COM 服务器 (exe)，因此不能直接与 Word 进行比较。如果你想要一个 .NET COM 服务器，那么“服务组件”是你最好的选择——但这些在 UI 上并不大。

有关信息，隔离区域位于“%userprofile%\Local Settings\Apps\2.0”附近，但这只是为了让您可以看到它。不要尝试从那里运行它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T17:15:51.880

谢谢（你的）信息。这让我意识到我可以使用 .Net 可执行文件而不是 vbscript 来启动我的应用程序。

```
 Dim program As New Process

    'Try to run a .Net click-once application
    Try
        Dim shortcut As String = Environment.GetFolderPath(Environment.SpecialFolder.StartMenu)
        shortcut = shortcut + "specific\shorctut\path\shortcut.appref-ms"
        program .StartInfo.FileName = lpsShortcut
        program .Start()
    Catch
        'If not go to the web site for a fresh install
        Try
            .Diagnostics.Process.Start("IExplore.exe", "http://url/program.application")
        Catch ex As Exception
            'Log or Email alert here...
        End Try
    End Try 
```

# c - 将预处理器标记转换为字符串

> ID：240353
> 
> 赞同：74
> 
> 时间：2008-10-27T15:43:19.860
> 
> 标签：c, c-preprocessor, stringification

我正在寻找一种将预处理器令牌转换为字符串的方法。

具体来说，我在某个地方得到了：

```
#define MAX_LEN 16 
```

我想用它来防止缓冲区溢出：

```
char val[MAX_LEN+1]; // room for \0
sscanf(buf, "%"MAX_LEN"s", val); 
```

我愿意接受其他方式来完成同样的事情，但仅限于标准库。

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2008-10-27T15:47:38.133

具体见[http://www.decompile.com/cpp/faq/file_and_line_error_string.htm](http://www.decompile.com/cpp/faq/file_and_line_error_string.htm) ：

```
#define STRINGIFY(x) #x
#define TOSTRING(x) STRINGIFY(x)
#define AT __FILE__ ":" TOSTRING(__LINE__) 
```

所以你的问题可以通过做来解决 `sscanf(buf, "%" TOSTRING(MAX_LEN) "s", val);`

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-10-27T15:45:33.443

我在网上找到了答案。

> > ```
> > #define VERSION_MAJOR 4
> > #define VERSION_MINOR 47
> > 
> > #define VERSION_STRING "v" #VERSION_MAJOR "." #VERSION_MINOR 
> > ```
> > 
> > 以上不起作用，但希望能说明我想做的事情，即使 VERSION_STRING 最终成为“v4.47”。
> 
> 要生成正确的数字形式，请使用类似
> 
> ```
> #define VERSION_MAJOR 4
> #define VERSION_MINOR 47
> 
> #define STRINGIZE2(s) #s
> #define STRINGIZE(s) STRINGIZE2(s)
> #define VERSION_STRING "v" STRINGIZE(VERSION_MAJOR) \
> "." STRINGIZE(VERSION_MINOR)
> 
> #include <stdio.h>
> int main() {
>     printf ("%s\n", VERSION_STRING);
>     return 0;
> } 
> ```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-27T15:46:45.703

已经有一段时间了，但这应该有效：

```
 sscanf(buf, "%" #MAX_LEN "s", val); 
```

如果没有，则需要“双重扩展”技巧：

```
 #define STR1(x)  #x
 #define STR(x)  STR1(x)
 sscanf(buf, "%" STR(MAX_LEN) "s", val); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-27T20:32:57.870

您应该使用双扩展字符串化宏技巧。或者只是有一个

```
#define MAX_LEN    16
#define MAX_LEN_S "16"

char val[MAX_LEN+1];
sscanf(buf, "%"MAX_LEN_S"s", val); 
```

并保持同步。（这有点麻烦，但只要定义彼此相邻，您可能会记得。）

实际上，在这种特殊情况下，还`strncpy`不够吗？

```
strncpy(val, buf, MAX_LEN);
val[MAX_LEN] = '\0'; 
```

但是，如果是`printf`，这将更容易：

```
sprintf(buf, "%.*s", MAX_LEN, val); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-28T14:59:16.407

虽然上述一些“工作”，但我个人建议只使用简单的字符串 API 而不是 libc 中的 deck。有许多可移植的 API，其中一些还为便于包含在您的项目中而进行了优化……而像[ustr](http://www.and.org/ustr/)这样的一些 API具有很小的空间开销并支持堆栈变量。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-05-14T20:11:47.807

我的两分钱。

```
#define MAX_LEN 16

#define AUX_VALUE(x) x
#define QUOTATION_VALUE() "
#define STRINGIFY(x) #x //Ok in all.
//#define STRINGIFY(x) QUOTATION_VALUE()AUX_VALUE(x)QUOTATION_VALUE() //Ok only in VC++

std::string str = STRINGIFY(MAX_LEN);
const char* str2 = STRINGIFY(MAX_LEN);
sscanf(buf, "%" STRINGIFY(MAX_LEN) "s", val); 
```

# javascript - 获取帖子 - 重定向 - 刷新以调用重定向页面而不是原始请求

> ID：240354
> 
> 赞同：1
> 
> 时间：2008-10-27T15:43:21.857
> 
> 标签：javascript, html, oracle, refresh

我们有一个 POST 到 PL/SQL 数据库过程，它 (a) 基于 POST 参数执行一些数据库操作，并且 (b) 将用户重定向到显示结果的页面。

问题是，当用户对结果页面进行浏览器“刷新”时，仍然有原始请求，所以它调用数据库过程并重新发送参数。

我们可以通过保存状态来做一些事情，这样如果再次发送请求，就不会发生坏事。但这让我想知道。

有没有办法告诉浏览器将 url 设置为重定向调用，而不是原始用户请求？这可能在重定向本身中，或者在目标页面上的 Javascript 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T17:20:53.500

The canonical solution is described pretty well on Wikipedia. See [Post/Redirect/Get](http://en.wikipedia.org/wiki/Post/Redirect/Get). You want the code that's handling the POST to redirect to a GET when it's work is done, as refreshing a GET will not resubmit form data.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T15:46:41.270

您没有提及您使用什么来提供页面，但请确保您执行外部重定向。某些平台将在站点内进行内部重定向。

例如，对于 Apache HTTP Server，您需要在 mod_rewrite 中指定 force-redirect 标志：[http ://httpd.apache.org/docs/1.3/mod/mod_rewrite.html#RewriteRule](http://httpd.apache.org/docs/1.3/mod/mod_rewrite.html#RewriteRule)

[这里](http://www.webmasterworld.com/apache/3524863.htm)的第 4 个响应对此也有很好的解释。

# javascript - XPCSafeJSObjectWrapper 做什么？

> ID：240362
> 
> 赞同：3
> 
> 时间：2008-10-27T15:45:35.360
> 
> 标签：javascript, firefox, firefox-addon, gecko

Mozilla Firefox 的 XPCSafeJSObject 包装器实际上做了什么？

[MDC](https://developer.mozilla.org/en/XPConnect_wrappers#XPCSafeJSObjectWrapper)的文档如下：

> 创建此包装器是为了解决 XPCNativeWrapper 的一些问题。特别是，一些扩展希望能够安全地访问非本机实现的内容定义对象（以及访问 XPCNativeWrapper 下的底层 JavaScript 对象而无需其强大的行为保证）。XPCSJOW 充当 chrome 代码之间的缓冲区。

这并没有告诉我很多。特别是，我不知道通过 XPCSafeObject 访问对象与直接访问它们有何不同。

**编辑**：我知道包装器的一般目的是保护特权代码免受非特权代码的影响。我不明白（并且似乎没有记录）是XPCSafeJSObject 究竟是如何做到这一点的*。*

它只是在访问属性之前放弃特权吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-10-09T19:51:40.583

实际上 XPCSafeJSObjectWrapper 用于所有内容对象，包括窗口和文档（实际上这是最常需要它的地方。）我相信它的发明主要是为了阻止 XSS 攻击自动变成特权升级攻击（通过对浏览器本身进行 XSS） . 至少现在如果发现 XSS 攻击（不幸的是人们会继续寻找），它不会危及整个浏览器。它是 XPCNativeWrapper 的自然发展，它最初是一种手动（因此容易被扩展意外滥用）的方式，供浏览器保护自己免受 XSS 攻击。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-09T17:10:26.603

包装器只是确保在没有 chrome 权限的情况下评估任何被评估的代码。在没有此包装器的情况下直接访问对象可以允许代码以 chrome 权限运行，然后让该代码执行任何操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T16:47:54.127

一般来说，包装器的目的是在与非特权代码交互时保护特权代码。非特权代码的作者可能会重新定义一个 JavaScript 对象来做一些恶意的事情，比如重新定义一个属性的 getter 来执行一些不好的事情作为副作用。当特权代码尝试访问该属性时，它会将错误代码作为特权代码执行。包装器可以防止这种情况。[这个页面](https://developer.mozilla.org/en/Safely_accessing_content_DOM_from_chrome)描述了这个想法。

XPCSafeJSObject 为非本地实现的 JavaScript 对象（即不是窗口、文档等，而是用户定义的对象）提供了一个包装器。

编辑：关于它是如何实现的，请查看[源代码（目前它还没有完全加载。）还可以在](http://zenit.senecac.on.ca/wiki/dxr/source.cgi/mozilla/js/src/xpconnect/src/XPCSafeJSObjectWrapper.cpp)[DXR](http://zenit.senecac.on.ca/wiki/dxr/)上搜索 XPCSafeJSObject 以获取其他相关的源文件。

# wcf - WCF 会话或每次调用传递用户名/密码？

> ID：240373
> 
> 赞同：13
> 
> 时间：2008-10-27T15:47:55.700
> 
> 标签：wcf, authentication, session

对于企业类型的 WCF 服务，可能有 10K 的数千个客户端将进行身份验证并将数据发送到中央服务器，当涉及到会话或身份验证时，什么是“最佳”实践？

1.  WCF 是否支持会话，如果支持，我应该使用它吗？还是我应该在每次通话的基础上简单地传递用户名/密码？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-27T17:54:22.340

As [blowdart](https://stackoverflow.com/users/2525/blowdart) mentioned, WCF Sessions are not the same as ASP.NET Sessions. You can read up on them here: [http://msdn.microsoft.com/en-us/library/ms733040.aspx](http://msdn.microsoft.com/en-us/library/ms733040.aspx). Before you roll your own security, you'll want to get familiar with what WCF gives you out-of-the-box: [http://msdn.microsoft.com/en-us/library/ms734736.aspx](http://msdn.microsoft.com/en-us/library/ms734736.aspx). They may get you close to your goal without writing a lot of code. Specifically, check out [How to: Create a Secure Session](http://msdn.microsoft.com/en-us/library/ms733783.aspx). With secure sessions, the Client and Server cache credentials so you don't have to fully authenticate with each request. By default, you'll lose a secure session if the web server recycles. If you want a secure session that lasts through a recycle, you'll want to look at [How to: Create a Stateful Security Context Token for a Secure Session](http://msdn.microsoft.com/en-us/library/ms731814.aspx).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T15:53:12.163

WCF 确实支持会话是的；但它们**不像**ASP.NET 会话。会话在那里按顺序传递消息（以及其他位和 bobs），它们不是为了在调用之间添加共享存储。

对于经过身份验证的服务调用，您应该每次都发送您的身份验证详细信息；安全性是基于每条消息应用的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-28T09:38:49.470

如果您在 IIS 中托管服务，您仍然可以通过为服务行为启用 aspnetcompatibility 来使用来自 ASP.NET 的会话。

# remote-desktop - RDP 连接/响应测试

> ID：240377
> 
> 赞同：4
> 
> 时间：2008-10-27T15:48:45.060
> 
> 标签：remote-desktop

我想编写一个应用程序来测试 Windows 机器是否正确响应**RDP（远程桌面）** - 即检查机器是否不仅允许连接，而且响应正常，并且没有挂起或以其他方式响应异常。

是否有可以用来执行此操作的库或实用程序？我的搜索结果已满`RDC clients`，但我希望至少有一些东西可以提供用于测试的 API。我最想使用 Java 或脚本语言来做到这一点，但我愿意接受建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T15:54:13.410

[在专家交流](http://www.experts-exchange.com/Programming/Languages/Scripting/Shell/Batch/Q_22627695.html)中找到了这个：

```
use Net::Telnet ();
$t = new Net::Telnet (Timeout => 10, Prompt => '', Port >= 3389);
if($t->open("computer.name.or.ip")) {
    print "Connect successful\n";
}
else {
    print "Could not connect\n";
} 
```

这个想法是尝试连接，如果它无法在“x”秒内连接，则假设它无法正常工作。如果您尝试查看特定用户的登录是否有效，则会变得有点复杂，但这至少应该让您入门。

**注意**：正如评论中指出的那样，原始解决方案省略了 RDP 端口，因此我将其包含在此...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T14:18:26.270

您可以在这个问题中找到一些好的答案：[Programmatically create and launch and RDP session (without gui)](https://stackoverflow.com/questions/2767035/programmatically-create-and-launch-and-rdp-session-without-gui)

因为 RDP 是一个[不断发展的专有协议](http://en.wikipedia.org/wiki/Remote_Desktop_Protocol)，我猜没有一些简单的开源代码可以让你获取和使用。这给我们留下了两条可能的路径：

1.  [使用 Microsoft RDP ActiveX 控件](http://www.codeproject.com/Articles/43705/Remote-Desktop-using-C-NET)（在 Windows 上）
2.  启动 mstsc.exe 并向其发送键盘事件（也在 Windows 上，使用您喜欢的语言）

对于第二个选项，我建议[AutoHotkey](http://www.autohotkey.com/)。它非常适合自动化 Windows 程序，并带有一个强大的库。它背后也有一个强大的社区，因此您可以在互联网上找到许多有用的脚本。我用它来控制 winamp（比如“我讨厌这首歌！删除它并移至下一首”）（好吧，从技术上讲，“移至下一首歌曲并删除上一首”，因为您不能在使用时删除文件，但您明白了）。如果您选择此路径，我可以帮助您编写脚本。

# .net - 您如何更改 .Net 页面将在其下运行的扩展名？

> ID：240382
> 
> 赞同：6
> 
> 时间：2008-10-27T15:51:10.483
> 
> 标签：.net, asp.net, config, file-extension

我需要我的 .net 应用程序使用 .html 扩展名而不是 .aspx

我正在转换一个 php 应用程序，并且有一些外部应用程序依赖于该扩展来运行。

做这个的最好方式是什么？

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-27T16:08:16.500

在 IIS 中，当您为虚拟目录创建应用程序时，单击应用程序的“配置”，然后编辑“应用程序映射”，即为 html 添加新映射。

或者，在您的 web.config 中，添加以下部分：

```
<httpHandlers>
   <remove verb="*" path="*.html" />
   <add verb="*" path="*.html" type="System.Web.UI.PageHandlerFactory" />
</httpHandlers>
<compilation>
   <buildProviders>
       <buildProvider 
           extension=".html" 
           type="System.Web.Compilation.PageBuildProvider" />
   </buildProviders>
</compilation> 
```

编辑：根据评论添加了该部分。谢谢克里斯。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T15:53:16.313

你想使用[httpHandlers](http://msdn.microsoft.com/en-us/library/ms972953.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T16:01:49.230

请注意，我不是 100% 确定这将与 PHP 扩展一起使用，我们在此处使用此过程进行自定义扩展。

您可以更改 IIS 配置：打开 IIS 控制台（右键单击我的电脑 > 管理... > 服务和应用程序）

*   如果您在网站中，请打开网站属性和“主目录”选项卡。
*   如果您在虚拟目录中，则属性然后是“虚拟目录”选项卡。

单击“配置按钮”，查找 .aspx 扩展名并为“.php”扩展名使用相同的配置（提示：您可以在两个对话框之间复制粘贴可执行的 dll 名称）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-27T16:10:43.080

前段时间，我们将一个 web 应用程序从 Coldfusion 迁移到 PHP，并且不得不保留旧的 URL。我们这样做的方法是使用 mod_rewrite 将 .cfm URL 重写为 .php URL。也许你可以做类似的事情？

# tomcat - 如何在tomcat下重新加载kerberos配置？

> ID：240388
> 
> 赞同：3
> 
> 时间：2008-10-27T15:53:46.717
> 
> 标签：tomcat, active-directory, jndi, kerberos

我的应用程序在tomcat 下运行。它使用 GSS API (JNDI) 通过 Kerberos 连接到 Active Directory LDAP 服务器。它允许用户定义 AD 服务器并尝试连接到它们。但是，一旦第一次使用连接尝试的 Kerberos 完成后，应用程序就不会再次读取 Kerberos 配置 ( `/etc/krb5.conf`)。因此，对其进行任何更改都需要重新启动 tomcat。

我怎样才能避免这样的重启？如何在每次连接尝试之前强制应用程序重新加载 Kerberos 配置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-17T08:02:53.907

我也面临同样的问题！请参阅此相关的 StackOverflow 帖子，希望上面的链接有所帮助。

[在 JAVA 中重新加载 Kerberos 配置而不重新启动 JVM](https://stackoverflow.com/questions/1437281/reload-kerberos-config-in-java-without-restarting-jvm)

# sql - 为什么这条 SQL 语句不起作用？

> ID：240393
> 
> 赞同：5
> 
> 时间：2008-10-27T15:54:29.977
> 
> 标签：sql, oracle

我有以下 SQL 语句：

```
SELECT DISTINCT name FROM log WHERE NOT name = '' AND name LIKE '%.EDIT%'; 
```

它在 Postgres 上运行良好（从日志中返回所有不同的名称，它们不为空并且包含字符串 '.EDIT'）。但在 Oracle 上，这条语句不起作用。知道为什么吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-27T16:05:04.760

```
SELECT DISTINCT name FROM log WHERE NOT name = '' AND name LIKE '%.EDIT%'; 
```

1）Oracle将''视为NULL，这意味着比较“NOT name = ''”永远不会是真或假；改用“IS NOT NULL”。但...

2) 第二个条件 "name LIKE '%.EDIT%' 无论如何都不会匹配一个空字符串，从而使第一个条件变得多余。

所以重写为：

```
SELECT DISTINCT name FROM log WHERE name LIKE '%.EDIT%'; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-27T16:00:55.033

Oracle中的空字符串相当于NULL，导致比较失败。将查询的那部分更改为 NAME IS NOT NULL

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-27T16:00:57.810

您可以在没有“NOT NAME=''”子句的情况下重写该查询。

```
 SELECT DISTINCT name 
 FROM log
 WHERE name LIKE '%.EDIT%'; 
```

那对你有用吗？

如果没有，它以什么方式不起作用？它会导致错误吗？是否返回错误的结果？

请使用此信息扩展您的问题:-)

# asp.net - CSS 文件中的 ASP.NET MVC URL 自动解析

> ID：240394
> 
> 赞同：27
> 
> 时间：2008-10-27T15:54:36.670
> 
> 标签：asp.net, asp.net-mvc

**在正常的 WebForms 场景中**，CSS 文件中的任何根相对 URL（例如 ~/folder/file.txt） ，例如：

```
.form { background-image: url(~/Content/Images/form_bg.gif); } 
```

如果我指定，将在运行时自动解决

```
<head runat="server"> 
```

在参考页面。

但是，这不再发生在 ASP.NET MVC Beta1 网站上。

有没有一种方法可以在不求助于黑客或 CSS-loader 文件的情况下启用此功能？可能是 HttpModules 之类的？

还是我没有正确设计我的网站？什么应该是好的设计？

由于原始的 ASP.NET WebForms 已经具有此功能，因此如果可能，我更愿意利用任何现有功能。但我没有太多线索。

此 Web 应用程序将部署在 ~ 根文件夹可能不明显的多个环境中。

* * *

**编辑：**我的意思是文件内容中的 url，而不是文件的 url 本身。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-11-06T19:40:34.737

我不会为自动寻根`~`字符而烦恼。我了解您希望相同的解决方案在部署之间的根目录不同的情况下工作，但在 CSS 文档中使用相对路径应该没有任何问题。CSS 文档中的路径（指向您示例中的图像 URL）将始终相对于 CSS 文件的位置，而不管加载该 CSS 文件的任何页面的路径如何。因此，如果您的图像在`~/Content/Images`并且您的样式表在 中`~/Content/Stylesheets`，您将始终能够使用`background-image: url(../Images/form_bg.gif);`并且无论加载样式表的页面的位置如何，它都可以正常工作。

有没有理由这不起作用？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-08T05:51:50.030

我过去使用的一个技巧是让我的 CSS 文件具有 .ASPX 扩展名，并在页面签名中设置 ContentType 属性：

```
<%@ Page Language="C#" ContentType="text/css" %>

body {
    margin: 0;
    padding: 0;
    background: #C32605 url(<%= ResolveUrl("~/Content/themes/base/images/BodyBackground.png") %>) repeat-x;
    font-family: Verdana, Arial, sans-serif;
    font-size: small;
    color: #d7f9ff;
} 
```

这将确保 CSS 文件通过 ASP.NET 框架，并用您的相对路径替换服务器端代码。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-27T17:04:31.317

[以下](http://msdn.microsoft.com/en-us/library/aa719858(VS.71).aspx) [是](http://www.15seconds.com/issue/020417.htm) [一些](http://www.csharpfriends.com/Articles/getArticle.aspx?articleID=268) 有关实现 IHttpModule 以拦截对您的应用程序的 Web 请求的[资源...](http://support.microsoft.com/kb/307996)

编写/调整一个以检查文件类型（例如伪代码：if（请求以“.css”结尾）...）

然后使用正则表达式将“~/”的所有实例替换为 System.Web.VirtualPathUtility.ToAbsolute("~/")

我不知道这会对性能产生什么影响，通过这种过滤器运行每个请求，但是您可能可以摆弄您的 web.config 文件和/或您的 MVC URL 路由以通过这种方式汇集所有 .css 请求一个过滤器，同时跳过它以获取其他文件。

想一想，通过将所有 CSS 引用指向为您执行此类预处理的特殊 controller.action，您可能可以在 ASP.NET MVC 应用程序中实现相同的效果。我怀疑它会像 IHttpModule 一样高效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T19:38:00.453

如果您尝试从任何文件（包括文本文件、javascript 等）中解析**~/**，您可以编写一个为其分配过滤器的处理程序，您可以使用它来搜索这些路径……例如。 ..

```
public class StringParsingFilter : MemoryStream {

    public Stream OriginalStream {
        get { return this.m_OriginalStream; }
        set { this.m_OriginalStream = value; }
    }
    private System.IO.Stream m_OriginalStream;

    public StringParsingFilter() : base() {
        this.m_OriginalStream = null;
    }

    public override void Flush() {
        this.m_OriginalStream.Flush();
    }

    public override void Write(byte[] buffer, int offset, int count) {

        //otherwise, parse for the correct content
        string value = System.Text.Encoding.Default.GetString(buffer);
        string contentType = HttpContext.Current.Response.ContentType;

        //Do any parsing here
        ...

        //write the new bytes to the stream
        byte[] bytes = System.Text.Encoding.Default.GetBytes(value);
        this.m_OriginalStream.Write(bytes, offset, count + (bytes.Length - buffer.Length));

    }

} 
```

您将编写一个自定义处理程序来知道何时分配此过滤器......如下所示......

```
 public class FilterControlModule : IHttpModule {

    public void Init(HttpApplication context) {
        HttpApplication oAppContext = context;
        oAppContext.BeginRequest += new EventHandler(_HandleSettingFilter);                        
    }

    private void _HandleSettingFilter(object sender, EventArgs e) {

        //You might check the file at this part to make sure
        //it is a file type you want to parse
        //if (!CurrentFile.isStyleSheet()) { return; }
        ...

        //assign the new filter
        StringParsingFilter filter = new StringParsingFilter();
        filter.OriginalStream = HttpContext.Current.Response.Filter;
        HttpContext.Current.Response.Filter = (Stream)filter;

    }

} 
```

说“查找 IHttpModules”实际上可能更容易，但这是我用来解析文件以查找 ASP.net 文件以外的路径的一些代码。

您还必须更改 IIS 设置中的一些内容，以通过将 ASP.net ISAPI 设置为所有要处理的文件的通配符来解析文件。如果您使用的是 IIS6，您可以[在这个网站上](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/5c5ae5e0-f4f9-44b0-a743-f4c3a5ff68ec.mspx?mfr=true)看到更多信息......

您还可以使用它来修改任何文件类型，这样您就可以为图像分配一些过滤器，为 javascript 或样式表分配一些过滤器或......真的任何东西......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-27T17:22:07.507

您可以使用[URL 重写器](http://www.helicontech.com/isapi_rewrite/)在请求进入时修复 URL，尽管我不太确定在这种情况下它是否像 hack 一样优雅。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-28T15:36:43.367

我创建了一个 PathHelper 实用程序类，它为我提供了我需要的所有路径。例如

```
<link href="<%=PathHelper.CssUrl("FormulaIndex.css")%>" rel="Stylesheet" type="text/css"/> 
```

在 System.Web.VirtualPathUtility.ToAbsolute() 和我自己的约定 (content/css/yourFile.css) 的帮助下给我正确的完整 url。

我对 js、xml、t9n、pics 做了同样的事情......它的中心、可重用，现在我只需要更改一行来捕捉脚本文件夹从 content/js 到我所有网站和页面中的脚本的移动。

*如果您问我，这是一个愚蠢的举动，但这是当前测试版中的现实:(*

# servicebus - 什么是 .NET 服务？

> ID：240395
> 
> 赞同：2
> 
> 时间：2008-10-27T15:54:41.817
> 
> 标签：servicebus, workflowservice, .net-services, accesscontrolservice

今天在 PDC 上宣布。最初由服务总线、工作流服务和访问控制服务组成。这些是什么？我为什么要使用它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T13:46:47.940

我看了一点。我觉得有一些帖子传达了很多意义。这股新的技术浪潮看起来确实像某些圈子所报道的那样“大如新台币”。

以最简单的形式，为此类解决方案映射当前的 Microsoft 服务器服务，并想象它们托管在 Microsoft 的数据中心上。所以我们有

*   Biztalk 服务总线/服务-> [.Net 服务总线](http://www.microsoft.com/azure/servicebus.mspx)
*   Windows 工作流 -> 工作流服务
*   SQL Server -> [SQL 服务](http://www.microsoft.com/azure/sql.mspx)
*   Active Directory 服务 -> 访问控制服务

（注意：这些是用于说明而非直接映射的近似值）

现在最初并不是您当前的 Biztalk 有线代码可以直接移动到云中，而是可以使用服务合同来针对 Sql 运行您自己的代码，例如，在 Microsoft 工具包上运行。（请记住，我们正在与云对话，因此所有 API 都会自然地通过 Web 服务公开）。

因此，软件也许最终会转向订阅模式——虽然定价不可用，但它正在被推广为即用即付计划。

官方链接： - [MSDN - Windows Azure](http://msdn.microsoft.com/en-us/azure/cc994380.aspx) - [VS 2008 Tools（包括项目模板）](http://www.microsoft.com/downloads/details.aspx?FamilyId=63D0D248-1B08-4F7D-ABDE-62EB75CB1E69&displaylang=en)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-27T18:59:41.710

[http://channel9.msdn.com/posts/Charles/John-Shewchuk-and-Dennis-Pilarinos-Inside-NET-Services/](http://channel9.msdn.com/posts/Charles/John-Shewchuk-and-Dennis-Pilarinos-Inside-NET-Services/)

# sql - MYSQL：如果不存在则创建表

> ID：240400
> 
> 赞同：4
> 
> 时间：2008-10-27T15:55:31.783
> 
> 标签：sql, mysql

如果我执行**Create Table If Not Exists**，并且存在具有相同名称且行（或列）较少的表，会发生什么情况？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-27T15:57:23.247

如果已经存在同名表，则无论表布局如何，都不会创建该表。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-27T15:56:37.087

没有。如果“IF Not Exists”子句失败，则跳过其余的创建。

# sql - DBI 的 column_info 与引用标识符上的 pgAdmin

> ID：240404
> 
> 赞同：1
> 
> 时间：2008-10-27T15:56:48.473
> 
> 标签：sql, perl, postgresql, dbi, pgadmin

我的 Postgres 数据库中有一个表，其中包含名为“type”、“desc”和“start”的列。当我调用时`$dbh->column_info`，只有“desc”被引用，而在 pgAdmin 中，它们三个都被引用。其中一个是错的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T16:00:27.953

我想我有点回答了我自己的问题，但我想我会把它放在这里以防万一有人有更多的见解。[保留列表](http://www.postgresql.org/docs/8.3/interactive/sql-keywords-appendix.html)显示“ desc”是唯一实际保留的关键字（另外两个：'我们将解析器明确知道但允许作为列或表名的那些关键字归类为“非保留”'），所以我的猜测是 pgAdminIII 谨慎并引用以防“类型”和“开始”有一天被保留。

# language-agnostic - UML：类图中的内部类

> ID：240411
> 
> 赞同：16
> 
> 时间：2008-10-27T15:59:35.583
> 
> 标签：language-agnostic, uml, diagram

在类图中，有没有办法指定一个类是另一个类的内部类？

还是将其视为纯粹的实现选择？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-28T02:15:51.610

考虑使用嵌套关系（在父端的圆圈中带有“+”的线）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-27T16:15:45.987

由于 UML 不应该是直接特定于实现的，因此我将使用命名约定，例如：

```
OuterClass vs OuterClass::InnerClass 
```

我可以想象，如果您希望对 UML 进行逆向工程或代码生成，那么不同的工具将使用不同的技术（如果它们完全支持的话）。

使用 Enterprise Architect (EA v7) 对某些逆向工程进行快速测试，确认它们`InnerClass::OuterClass`在处理带有公共内部类的某些 C# 时使用了上述语法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T16:05:49.423

对于这种事情，您有单独的图表来显示类的内部结构或处理。

通常，那些额外的图表是显示处理的活动图。有时一种方法。您可能还有一个显示 API 交互的内部序列图。

没有理由你不能有一个额外的类图来显示一个类的内部结构。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-28T02:21:30.163

或者您可以显示被外部类完全包围的内部类，一个矩形在另一个矩形内。

# vb.net - 使用 external.menuArguments 在 Internet Explorer 窗口中修改 HTML

> ID：240419
> 
> 赞同：3
> 
> 时间：2008-10-27T16:00:58.090
> 
> 标签：vb.net, internet-explorer, mshtml

我有一个在 Internet Explorer 中使用上下文菜单扩展调用的 VB.NET 类。

代码可以访问页面的对象模型，读取数据不成问题。这是测试函数的代码...它更改状态栏文本（OK），打印页面 HTML（OK），通过添加文本更改 HTML 并再次打印页面 HTML（OK，在第二个 pop-我添加的文本在 HTML 中）

但 Internet Explorer 窗口不显示它。我在哪里做错了？

```
Public Sub CallingTest(ByRef Source As Object)
    Dim D As mshtml.HTMLDocument = Source.document
    Source.status = "Working..."
    Dim H As String = D.documentElement.innerHTML()
    MsgBox(H)
    D.documentElement.insertAdjacentText("beforeEnd", "ThisIsATest")
    H = D.documentElement.outerHTML()
    MsgBox(H)
    Source.status = ""
End Sub 
```

该函数在 JavaScript 中是这样调用的：

```
<script>
    var EB = new ActiveXObject("MyObject.MyClass");
    EB.CallingTest(external.menuArguments);
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T21:01:34.537

我不认为亚历克斯是对的，还有别的问题。

当我尝试做类似的事情时， insertBefore 对我不起作用，但 appendChild 工作得很好，所以添加一个元素是可能的。

我在 Javascript 中工作，但我不认为这会有所作为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T20:28:59.803

据我了解，为了使用 insertAdjacentText 或任何其他编辑方法，文档对象应处于设计模式。在设计模式下，您可以自由编辑文档，用户也可以。查看[此](http://msdn.microsoft.com/en-us/library/aa753630(VS.85).aspx)网站了解更多详情

# svn - 颠覆合并删除命令

> ID：240425
> 
> 赞同：6
> 
> 时间：2008-10-27T16:02:44.360
> 
> 标签：svn, merge

当我将主干合并到功能分支时，主干上发生的删除将不会复制到我的工作副本中。

为什么合并时主干上的删除不会删除分支上的相同文件？我正在使用颠覆 1.5 客户端和服务器。

我假设重新集成分支时将跳过对分支中文件的更改？

在主干上兑换文件的最佳方法是什么，因为一位同事从主干中删除了文件，只是因为它还没有“准备好”。

情况：

```
cd project; svn copy trunk branches/f1; svn ci -m "branching out" branches f1;
echo "modifying a file on branch." >> branches/f1/file1; svn ci branches/f1 -m "Branch modified"; 
echo "Above modify is not even needed to state the case";
svn rm trunk/file1; svn ci trunk -m "creating (conflicting) delete on trunk";
cd branches/f1; svn merge svn+ssh://repos/trunk .
[ -f file1 ] && echo "file f1 does exist while it should have been deleted by merge."; 
```

因此，即使我在文件已被主动删除的主干中合并，该文件仍然存在于我的工作副本中。非常出乎意料。就我而言，我什至没有对文件进行任何更改，这是我能想到为什么 svn 会保存文件的唯一原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T09:22:13.200

据我了解，您所做的是在 file1 中创建本地冲突。在您的分支中，它已被修改。在您的后备箱中，它已被删除。当你合并时，它会发生冲突。所以文件仍然存在。

我建议2个测试：

1.  运行上面的代码后，包含`svn status`.
2.  尝试与上面相同的代码，但根本不修改该分支。（`svn status`在这里也会有帮助。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-12-02T17:29:21.200

确定合并后主干上删除的文件还在版本控制下吗？它可能是未版本化的，但仍然存在，这是预期的行为。查看 的输出`svn status`将让您了解该文件是否仍处于版本控制之下。

你不妨看看这个错误报告，它彻底解释了这种情况：[http ://subversion.tigris.org/issues/show_bug.cgi?id=2282](http://subversion.tigris.org/issues/show_bug.cgi?id=2282)

# sharepoint - MOSS 2007 面包屑问题

> ID：240427
> 
> 赞同：0
> 
> 时间：2008-10-27T16:03:51.800
> 
> 标签：sharepoint, sharepoint-2007, master-pages

我有一个行为奇怪的发布网站的页面布局。

想象一个发布站点 (site) 有一个子站点 (subsite1)，它具有以下页面 (page1 [默认]、page2 和 page3)

对于第 2 页和第 3 页，面包屑正确呈现：

```
site > subsite1 > page2 
site > subsite1 > page3 
```

但是对于默认页面，面包屑仅呈现为

```
site > subsite1 
```

知道如何强制它也显示默认页面的标题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-29T15:54:25.077

经过多次搜索和反复失败，我决定使用 AJAX 包含。在有人因为使用魔鬼语言（VB.Net）而对我进行标记之前，我只使用它，因为我有其他开发人员正在使用和维护这段代码，所以他们必须能够阅读它......

包含执行以下操作：

1.  将当前 url 拆分为其组成部分
2.  对于每个部分，获取 Sharepoint URL 和 Sharepoint Web
3.  打印 sharepoint 网站的标题
4.  如果该部分是页面，则获取页面标题并打印

这不是最终代码（今晚我将对其进行重构）：

```
 Dim lsPage = Request.Item("CurrentPage")
  Dim TravelURL as string = "http://site/"
  Dim aryURLSections() = lsPage.Replace(TravelUrl, "").Split("/")
  Dim i as integer

  Response.Write("<span class='breadcrumbCurrent'>You are in &gt;</span> <span class='ms-sitemapdirectional'><a href='" & TravelUrl & "' title='Home'>Home</a> &gt; </span>")

  for i = 0 to (aryURLSections.Length -1)
    Dim PositionString as string = aryURLSections(i)
    if PositionString.Contains(".aspx") then
        'Render page
        Dim psite as SPSite = new SPSite(TravelUrl)
        Dim pobjSite As SPWeb = psite.OpenWeb() 
        Dim lList as SPList
        Dim lPage As SPListItem
        lList = pobjSite.Lists("Pages")
            If Not lList Is Nothing Then
                For Each lPage In lList.Items
                IF lsPage.ToUpper.Contains(lPage.Url.ToUpper) Then
                Response.Write("<span class='breadcrumbCurrent' >" & lPage.Title & "</span>")
                Else
                'Response.Write("<br>" & lPage.Url & " " & lsPage)
                End If
            Next
        End if
    Else if PositionString.Equals("Pages")
        ' do nothing
    else
        'render site
        TravelUrl = TravelUrl & PositionString & "/"
        'Response.Write(TravelUrl & " > ")
        Dim site as SPSite = new SPSite(TravelUrl)

        Dim objSite As SPWeb = site.OpenWeb()   
        Dim PubWeb = PublishingWeb.GetPublishingWeb(objSite)

        Response.Write("<span class='ms-sitemapdirectional'><a href='" & TravelUrl & "' title='" & PubWeb.Title & "'>" & PubWeb.Title & "</a> &gt; </span>")
    End if

    Next i 
```

# database - 您如何在数据库中构造配置数据？

> ID：240428
> 
> 赞同：26
> 
> 时间：2008-10-27T16:04:16.620
> 
> 标签：database, language-agnostic, configuration

人们在数据库中存储应用程序配置数据的首选方法是什么。从我自己过去做这件事开始，我使用了两种方法来做这件事。

1.  您可以创建一个存储键/值对的表，其中键是配置选项的名称，值是其值。这样做的优点是添加新值很容易，您可以使用相同的例程来设置/获取数据。缺点是您将未键入的数据作为值。
2.  或者，您可以硬编码配置表，每列是值的名称及其数据类型。这样做的缺点是需要更多维护来设置新值，但它允许您输入数据。

两者都使用过后，我的偏好在于第一个选项，因为它可以更快地设置，但它也有风险，并且在查找数据时会（略微）降低性能。有没有人有任何替代方法？

**更新**

有必要将信息存储在数据库中，因为如下所述，可能存在需要以相同方式配置的程序的多个实例，以及可能使用相同值的存储过程。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-27T16:07:37.063

您可以扩展选项 1 以获得第三列，给出数据类型。然后，您的应用程序可以使用此数据类型列来转换值。

但是，是的，如果配置文件不是一个选项，我会选择选项 1。选项 1 的另一个优点是您可以将其读入 Dictionary 对象（或等效对象）中，以便在您的应用程序中非常轻松地使用。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-27T16:15:55.067

由于配置通常可以存储在文本文件中，因此字符串数据类型应该足以存储配置值。如果您使用的是托管语言，那么知道数据类型应该是什么的是代码，而不是数据库。

更重要的是，通过配置考虑这些事情：

*   **层次结构**：显然，配置将受益于层次结构
*   **版本控制**：考虑能够回滚到在特定日期生效的配置的好处。
*   **分发**：有时，能够对应用程序进行集群可能会很好。一些属性可能应该是集群中每个节点的本地属性。
*   **文档**：根据您是否有网络工具或其他东西，将有关属性的文档存储在使用它的代码附近可能会很好。（代码注释对此非常有用。）
*   **通知**：代码如何知道配置库中某处发生了更改？

就个人而言，我喜欢一种颠倒的方式来处理配置，其中配置属性被注入到不知道值来自哪里的模块中。这样，配置管理系统可以非常复杂或非常简单，具体取决于您的（当前）需求。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-27T16:05:58.860

我使用选项 1。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-27T16:08:49.603

将数据库用于配置数据似乎有点矫枉过正。

编辑（对不起，评论框太长）：当然，对于如何实现程序的任何部分没有严格的规定。为了争论，一字螺丝刀适用于一些飞利浦螺丝！我想我在知道你的情况之前判断得太早了。

关系型数据库擅长于海量数据存储，可以快速存储、更新和检索，因此如果您的配置数据不断更新和读取，那么请务必使用 db。

db 可能有意义的另一种情况是，当您有一个服务器场时，您希望数据库在其中存储中央配置，但是您可以对指向 xml 配置文件的共享网络驱动器执行相同操作。

当您的配置是分层结构时，XML 文件会更好。您可以轻松地组织、定位和更新您需要的内容，并且为了获得额外的好处，您可以对配置文件以及源代码进行版本控制！

总而言之，这完全取决于配置数据的使用方式。

以对您的应用程序的有限了解来结束我的观点。我相信你可以做出正确的决定。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-27T16:07:38.903

我想这更像是一项民意调查，所以我会说列方法（选项 2）。但是，这取决于您的配置更改的频率、动态程度以及有多少数据等。

我当然会将这种方法用于用户配置/偏好等。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-27T16:45:27.597

我的项目使用具有四列的数据库表：

1.  身份证 [PK]
2.  范围（默认“应用程序”）
3.  环境
4.  价值

范围为“应用程序”的设置是全局设置，例如最大同时用户数。

每个模块都有自己的范围；所以我们的 ResultsLoader 和 UserLoader 有不同的作用域，但都有一个名为“inputPath”的设置。

默认值要么在源代码中提供，要么通过我们的 IoC 容器注入。如果数据库中没有注入或提供任何值，则使用代码中的默认值（如果存在）。因此，默认值永远不会存储在数据库中。

这对我们来说效果很好。每次我们备份数据库时，我们都会得到一份非常方便的配置副本。两者总是同步的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-27T16:29:10.907

选择选项 2。选项 1 实际上是在数据库之上实现数据库的一种方式，这是一种众所周知的反模式，从长远来看只会给您带来麻烦。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-27T17:19:59.163

我至少可以想到另外两种方法：

(a) 创建一个包含 key、string-value、date-value、int-value、real-value 列的表。将未使用的类型保留为 NULL。

(b) 使用 XML、YAML 或 JSON 等序列化格式并将其全部存储在一个 blob 中。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-27T16:12:43.433

您将应用程序连接到数据库所需的配置设置存储在哪里？

为什么不在那里存储其他配置信息呢？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-27T16:14:00.140

我会选择选项 1，除非配置选项的数量非常少（七个或更少）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-27T16:52:21.747

在我的公司，我们正在尝试使用选项一（一个简单的类似字典的表格）。我们允许使用包含要替换的配置变量名称的标记进行字符串替换。

例如，表可能包含行 ('database connection string', 'jdbc://%host%...') 和 ('host', 'foobar')。用一个简单的服务或存储过程层封装它可以实现极其简单但灵活的递归配置。它支持我们对多个隔离环境（开发、测试、产品等）的需求。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-27T17:00:01.467

我过去使用过 1 和 2，我认为它们都是糟糕的解决方案。我认为选项 2 更好，因为它允许键入，但它比选项 1 丑得多。我遇到的最大问题是对配置文件进行版本控制。您可以使用标准版本控制系统对 SQL 进行相当好的版本控制，但合并更改通常是有问题的。如果有机会做到这一点“正确”，我可能会创建一堆表，为每种类型的配置参数（不一定为每个参数本身）创建一个表，从而获得键入的好处和键/值的好处适当的范式。您还可以通过这种方式实现更高级的结构，例如列表和层次结构，

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-27T17:49:16.563

我投票支持选项 2。易于理解和维护。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-27T23:12:23.260

选项 1 适用于易于扩展的中央存储位置。除了 RB、Hugo 和 elliott 等人提出的一些很棒的专栏建议之外，您还可以考虑：

在用户字段甚至用户/机器字段（用于特定于机器的 UI 类型设置）中包含全局/用户设置标志。

当然，这些可以存储在本地文件中，但是由于无论如何您都在使用数据库，这使得它们可以在调试时为用户别名 - 如果错误与设置相关，这可能很重要。它还允许管理员在必要时管理设置。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-27T23:23:25.657

我在 SQL Server 中混合使用选项 2 和 XML 列。您也可能不想添加检查约束以将表保持在一行。

```
CREATE TABLE [dbo].[MyOption] (
  [GUID] uniqueidentifier CONSTRAINT [dfMyOptions_GUID] DEFAULT newsequentialid()  ROWGUIDCOL NOT NULL,
  [Logo] varbinary(max) NULL,
  [X] char(1)  CONSTRAINT [dfMyOptions_X] DEFAULT 'X' NOT NULL,
  CONSTRAINT [MyOptions_pk] PRIMARY KEY CLUSTERED ([GUID]),
  CONSTRAINT [MyOptions_ck] CHECK ([X]='X')
) 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-01-25T05:31:26.887

对于与任何数据库表无关的设置，如果您需要数据库处理这些值，我可能会选择 EAV 方法。否则，如果它实际上只是应用程序代码的存储，则序列化的字段值很好。

但是单个字段的格式来存储数据库使用的多个配置设置呢？

就像每个用户的一个字段包含与他们的留言板视图相关的所有设置（如默认排序顺序、被阻止的主题等），也可能是另一个包含他们主题的所有设置（如文本颜色、bg 颜色等）的字段

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2010-06-25T10:55:20.337

在关系数据库中存储层次结构和文档是疯狂的。首先，您要么必须将它们切碎，然后才能在以后的某个阶段重新组合它们。或者在一个 BLOB 中插入，更愚蠢。

不要将关系数据库用于非关系数据，该工具不适合。为此考虑使用 MongoDB 或 CouchDB 之类的东西。无模式无关系数据存储。如果它以任何方式传输到客户端，请将其存储为 JSON，将 XML 用于服务器端。

CouchDB 为您提供开箱即用的版本控制。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2011-03-29T17:24:01.297

除非您有充分的理由，否则不要将配置数据存储在数据库中。如果您确实有充分的理由，并且绝对确定您会这样做，那么您可能应该将其存储为 JSON 或 YAML 等数据序列化格式（不是 XML，除非您确实需要一种标记语言来配置您的应用程序 - - 相信我，你不会）作为字符串。然后，您可以读取字符串，并使用您使用的任何语言的工具来读取和修改它。使用时间戳存储字符串，您就有了一个简单的版本控制方案，能够在一个非常简单的系统中存储分层数据。即使您不需要分层配置数据，至少现在如果您将来需要它，您也不必更改配置界面来获取它。当然，您将失去对配置数据进行关系查询的能力，**这么**多的配置数据，那么你可能做错了什么。

公司倾向于将其系统的大量配置数据存储在数据库中，我不知道为什么，我认为这些决策没有太多考虑。在 OSS 世界中，我不经常看到这种事情发生。即使像 Apache 这样需要大量配置的大型 OSS 程序也不需要连接到包含 apache_config 表的数据库即可工作。在您的应用程序中处理大量配置是一种糟糕的代码气味，将这些数据存储在数据库中只会导致更多问题（如该线程所示）。

# windows - 什么是 Windows Azure？

> ID：240455
> 
> 赞同：47
> 
> 时间：2008-10-27T16:12:49.347
> 
> 标签：windows, azure

今天宣布。到目前为止的描述令人困惑。让我们为了解 Windows Azure 提供一个很好的起点。

[与什么是“云操作系统”](https://stackoverflow.com/questions/280037/what-is-a-cloud-os)密切相关？，但不足以保证关闭。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-10-27T16:35:22.420

## 描述

Azure™ 服务平台 (Azure)**是托管在 Microsoft 数据中心的互联网规模云服务平台**，它提供了一个操作系统和一组可以单独或一起使用的开发人员服务。Azure 灵活且可互操作的平台可用于构建从云中运行的新应用程序，或使用基于云的功能增强现有应用程序。其开放式架构使开发人员可以选择构建 Web 应用程序、在连接的设备、PC、服务器或混合解决方案上运行的应用程序，从而提供最佳的在线和本地部署。

Azure**减少了对前期技术购买的需求**，它使开发人员能够快速**轻松地创建在云中运行的应用程序**通过使用他们在 Microsoft Visual Studio 开发环境和 Microsoft .NET Framework 方面的现有技能。除了 .NET 支持的托管代码语言之外，Azure 将在不久的将来支持更多的编程语言和开发环境。Azure 通过提供按需计算和存储来托管、扩展和管理 Web 和连接的应用程序，从而简化了应用程序的维护和操作。基础设施管理通过一个为高可用性和动态扩展而设计的平台实现自动化，以匹配使用需求和按需付费定价模式选项。Azure 提供了一个开放、基于标准且可互操作的环境，支持多种 Internet 协议，包括 HTTP、REST、SOAP 和 XML。

## 特征

Azure 服务平台的关键组件包括：

*   用于服务托管和管理、低级可扩展存储、计算和网络的 Windows Azure
*   用于各种数据库服务和报告的 Microsoft SQL 服务
*   Microsoft .NET 服务是熟悉的 .NET Framework 概念（例如工作流和访问控制）的基于服务的实现
*   Live Services 为用户提供一种一致的方式在其 PC、手机、PC 应用程序和网站之间存储、共享和同步文档、照片、文件和信息
*   Microsoft SharePoint Services 和 Microsoft Dynamics CRM Services 用于云中的业务内容、协作和快速解决方案开发。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-11T17:55:55.417

是时间共享。我们再一次重新发明了一些东西。;) 谁预测大型机会死。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-27T16:14:14.663

这似乎是微软的主页： [Azure Services Platform](http://www.microsoft.com/azure/default.mspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-13T15:05:26.683

**简单来说：**

基于Microsoft*服务的操作环境*（也称为云计算平台），允许开发人员在 Microsoft 的基础架构上构建和托管服务。

Windows Azure 是一个*开放平台*，支持 Microsoft 和非 Microsoft 语言和环境。

根据 Microsoft Windows Azure 官方网站，开发人员可以使用 Visual Studio 2008 以及流行的标准和协议（包括 SOAP、REST 和 XML）构建他们的应用程序和服务。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-07-23T02:44:55.743

Azure 是一个云托管，如果我们有一个 Web 应用程序，我们可以在上面托管。Azure 还支持各种脚本语言（C#、PHP、Phyton 等）。今天 Azure 还支持 wordpress 和各种数据库。我们可以按期订阅 azure 或“按需付费”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-05-15T09:51:10.020

Microsoft Azure 是 Microsoft 创建的一项云计算服务，用于通过 Microsoft 管理的数据中心的全球网络构建、部署和管理应用程序和服务。它提供软件即服务、平台即服务和基础设施即服务，并支持许多不同的编程语言、工具和框架，包括微软特定的和第三方软件和系统。请参阅下面的链接以了解 Azure-

[http://www.tutorialspoint.com/microsoft_azure/](http://www.tutorialspoint.com/microsoft_azure/)

# sql-server-ce - Sql CE 3.5 的最大并发连接数是多少？

> ID：240463
> 
> 赞同：12
> 
> 时间：2008-10-27T16:17:02.943
> 
> 标签：sql-server-ce

由于谷歌没有提供我想知道的东西，我试着问 stackoverflow :) 到 sql ce 3.5 数据库的最大并发连接数是多少？谢谢j。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-27T19:07:28.823

SQL Server Compact 3.5 支持最多 256 个连接限制的多个连接。（[来源](http://msdn.microsoft.com/en-us/library/aa983341.aspx)）

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-27T17:48:55.830

我相信您正在寻找的信息是 SQL Server 版本比较。

对于标准版 -[比较功能](http://www.microsoft.com/sql/prodinfo/features/compare-features.mspx?PHPSESSID=0324345d45ef1bf1f764044e03584cd0)

对于精简版 -[比较功能](http://www.microsoft.com/sql/prodinfo/features/compare-features.mspx?PHPSESSID=0324345d45ef1bf1f764044e03584cd0)

**编辑**

抱歉，这个[Word 文档](http://download.microsoft.com/download/A/4/7/A47B7B0E-976D-4F49-B15D-F02ADE638EBE/Compact_Express_Comparison.doc)很可能是您需要的。

**再次编辑**

答案是 Compact 有 256 个并发连接，express 无限制。请参阅链接的 word doc 中的表 1。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-27T18:42:42.820

我知道 SQL CE 3.5 允许来自多个进程的多个并发连接（与允许但不推荐仅来自一个进程的倍数的早期版本相反）。我的*猜测*是它的资源有限，但我不确定。实际上，我直接打电话给 SQLCE 团队，以了解这是否有计数限制（我会在收到回复时回复，可能在今天晚些时候，尽管 PDC 正在进行，它可能会更长）。

也就是说，我质疑你为什么需要知道这一点。你想建立多少连接？您应该至少有 2 个 - 建议始终保持 1 个连接，即使它是一个从未使用过的虚拟连接，以出于性能原因保持连接缓存 - 但我从未做过任何超过 4 或 5 个的实现任何给定的时间。如果您有更多，您可能需要重新考虑您的架构，或者该应用程序更有可能成为成熟服务器产品的候选者。

**更新**

我终于收到了团队的回复，他们从源代码中确认了这个数字是 256。他们是这样说的：

“...因为我们在 C/C++ 中实现它，所以计数器从 0 开始，以 255 结束。这些是**并行连接**数，而**不是**总连接数。对于每次打开，计数器增加 1，每次关闭它下降 1。如果您还没有关闭，但只是在 Dispose 上发生了未引用的关闭。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-10T11:14:51.433

当第 200 + 57 个 SQL-Ce 连接请求到达时，您可以等待。

[更多](http://ourtech24.com/Programming/OT-182638/Wait-for-upcoming-request-when-SQL-CE-connection-limit-is-exceeded/)信息 - http://ourtech24.com/Programming/OT-182638/Wait-for-upcoming-request-when-SQL-CE-connection-limit-is-exceeded/

# javascript - 如何使用 jQuery / 普通旧 javascript 更改元素（例如 h1 -> h2）？

> ID：240467
> 
> 赞同：1
> 
> 时间：2008-10-27T16:18:21.067
> 
> 标签：javascript, jquery

当然，存在与文档有效性相关的一系列可能错误，但是当将段落 ( `p`) 更改为`address`元素时，我的直接绊脚石就出现了。我目前的方法是（或多或少）：

```
var p = $('p#test');
p.replaceWith('<address>' + p.html() + '</address>'); 
```

但对于这种特定情况，它失败了；它适用于 p -> blockquote 或 h2 -> h3。Firebug 建议`<address/>`出于某种原因，已在文档中添加了一个自闭合元素 ( )。

任何人都可以发现错误或建议替代方法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-27T16:26:03.330

```
var p = $('p#test');
var a = $('<address>').
    append(p.contents());
p.replaceWith(a); 
```

您的解决方案受到各种可怕的 HTML 转义问题和可能的注入攻击的影响。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-27T16:22:34.087

您可以在标题周围使用占位符：

```
<span id="demo"><h1>标题</h1></span>

```

然后使用 JavaScript DOM 为 innerHTML 属性创建新值。

```
<script type="javascript">

setTitle = 功能（ID，标签，标题）{
  var container = document.getElementById(id);
  container.innerHTML = '<' + 标签 + '>' + 标题 + '</' + 标签 + '>';
}

setTitle('demo', 'h1', '我的标题');

</脚本>

```

# android - JavaFX 可以在 Android 上运行吗？

> ID：240469
> 
> 赞同：13
> 
> 时间：2008-10-27T16:18:25.297
> 
> 标签：android, javafx

如果不这样做，那就太可惜了，因为它会使 Android 应用程序看起来更有吸引力。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-01T21:23:38.043

不是现在，让它发挥作用将是一项不平凡的任务。Android 没有典型桌面 JRE 所具备的所有库。尽管由于 Android 是开源的，它可以运行任何可以编译为 Dalvik 字节码的东西，但这并非不可能。

真的，我真的不认为 JavaFX 会让 Android 应用程序看起来更有吸引力——最重要的是应用程序如何集成到硬件中，并且 Android 显示框架有很多东西可以让这更容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-03-07T11:39:15.433

JavaFX 2.0 现在是一个库。这些实现是特定于平台的，因为除其他外，使用硬件加速图形。有一个适用于 Windows 的版本（使用*DirectX*）和适用于 Linux 和 Mac 的开发者预览版（使用*OpenGL*）：[oracle](http://www.oracle.com/technetwork/java/javafx/overview/index.html)

由于大量使用硬件加速，我猜如果会有一个android版本（很有可能），目标将是相对较新的表，而不是所有的android设备。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-17T03:07:04.967

也许吸引力并不那么重要。我认为现在便携性很重要，这种技术使它非常便携。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-27T06:11:36.380

请通过以下链接：[openjdk](https://wiki.openjdk.java.net/display/OpenJFX/Cross+Building+for+Android)，[oracle](https://blogs.oracle.com/jfxprg/entry/javafx_on_android)

# php - 在 PHP 页面之间传输变量

> ID：240470
> 
> 赞同：12
> 
> 时间：2008-10-27T16:19:40.767
> 
> 标签：php, variables

我想在一个页面中获取用户输入，将其存储在一个 php 变量中并在另一个 php 页面中使用它。我尝试过使用“会话”，但它似乎不起作用。还有其他安全的选择吗？此信息可能是用户名和密码。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-27T16:27:20.847

尝试更改您的会话代码，因为这是最好的方法。

例如：

## 索引.php

```
<?php
session_start();

if (isset($_POST['username'], $_POST['password']) {
    $_SESSION['username'] = $_POST['username'];
    $_SESSION['password'] = $_POST['password'];
    echo '<a href="nextpage.php">Click to continue.</a>';
} else {
    // form
}
?> 
```

## 下一页.php

```
<?php
session_start();

if (isset($_SESSION['username'])) {
    echo $_SESSION['username'];
} else {
    header('Location: index.php');
}
?> 
```

但是，我可能会在会话中存储一些更安全的东西，例如用户 ID，而不是用户的登录凭据。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-27T16:24:42.223

我同意卡森，会议应该为此工作。确保在要使用会话变量的任何页面上调用[session_start()之前。](http://uk3.php.net/session_start)

另外，我不会直接存储密码信息，而是使用某种身份验证令牌机制。*恕我直言，在会话中存储密码数据本质*上并不是不安全的，但如果没有必要这样做，您可能应该尽量避免它。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-27T16:29:02.357

有几种方法：

*   使用[会话](http://de2.php.net/manual/en/book.session.php)（但不要忘记在您将使用会话数据存储（[$_SESSION ）的每个页面上调用](http://de2.php.net/manual/en/reserved.variables.session.php)[session_start()](http://de2.php.net/manual/en/function.session-start.php)）
*   将您的数据附加到“下一页”页面的查询字符串（[$_GET](http://de2.php.net/manual/en/reserved.variables.get.php)）
*   将您的数据发布到“下一页”（[$_POST](http://de2.php.net/manual/en/reserved.variables.post.php)）

会话方式是数据不会“离开”服务器的唯一方式，因为它存储在服务器本身上。对于上述所有其他方式，您必须注意清理和验证接收页面上的数据。

最简单的方法是

```
//page1.php
session_start();
$_SESSION['user']='user';
$_SESSION['password']='password';

//page2.php
session_start();
echo $_SESSION['user'] . ' ' . $_SESSION['password']; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-27T16:26:51.813

您可以尝试使用 POST 和 GET 方法在 PHP 脚本中传输用户输入。

[PHP 获取](http://www.php.net/manual/en/reserved.variables.get.php)

[PHP 发布](http://www.php.net/manual/en/reserved.variables.post.php)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-27T16:29:27.830

我也同意，会话是最好的解决方案。有关一些示例，请参阅[使用 PHP 和 MySQL 的 Web 数据库应用程序的](http://oreilly.com/catalog/webdbapps/chapter/ch08.html)这一章。

# sql - 我应该使用 MSMQ 还是 SQL Service Broker 进行事务处理？

> ID：240471
> 
> 赞同：25
> 
> 时间：2008-10-27T16:19:43.233
> 
> 标签：sql, transactions, msmq, service-broker

我的团队负责人要求我调查 MSMQ 作为我们新版本产品的一个选项。我们在当前版本中使用 SQL Service Broker。我已经完成了相当多的实验和谷歌搜索，以找到哪种产品更适合我的需求，但我想我会询问我所知道的最好的网站来获得编程答案。

一些细节：

*   我们的客户端是 .NET 1.1 和 2.0 代码；这是发送消息的地方。
*   SQL Server 2005 实例中的目标。所有消息最终都是数据库更新或插入。
*   我们将发送一些必须作为交易处理的更新。
*   我们必须有完美的消息可恢复性；没有消息可以丢失。
*   即使目标 SQL 服务器关闭，我们也必须是异步的并且能够接受消息。
*   开发我们自己的排队解决方案不是一种选择。我们是一个小团队。

到目前为止我发现的事情：

*   MSMQ 和 SQL Service Broker 都可以完成这项工作。
*   似乎服务代理处理事务消息的速度更快。
*   Service Broker 需要在某处运行的 SQL 服务器，而 MSMQ 需要在某处运行的任何已配置的 Windows 机器。
*   MSMQ 似乎更好/更快/更容易在集群中设置/运行。

我错过了什么吗？这里有明显的赢家吗？任何想法、经验或链接都会受到重视。谢谢！

编辑：我们最终坚持使用服务代理，因为我们在一些客户端代码中使用了自定义数据库框架（我们更好地处理事务）。该代码捕获了事务的 SQL，但没有捕获 . 客户端代码也是 .NET 的所有 1.1 版本，因此我们必须升级所有客户端代码。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2010-03-23T21:23:15.383

刚刚将我的应用程序从 Service Broker 迁移到 MSMQ，我不得不投票支持使用 MSMQ。有几个因素需要考虑，但其中大部分与您使用数据的方式以及处理的位置有关。

*   如果在数据库中进行处理？**服务经纪人**
*   如果只是数据移动？**服务经纪人**
*   处理是在 .NET/COM 代码中完成的吗？**MSMQ**
*   您是否需要远程分布式事务（例如，在不同于 SQL 的机器上处理）？**MSMQ**
*   您是否需要能够在目的地关闭时发送消息？**MSMQ**
*   您想使用 nServiceBus、MassTransit、Rhino-ESB 等吗？**MSMQ**

无论您选择什么都需要考虑的事项

*   您如何知道队列的健康状况？这两个选项处理故障转移的方式不同。例如，**Service Broker**将在某些情况下禁用您的队列，这可能会导致您的应用程序瘫痪。
*   您将如何进行报告？如果您已经在报表中使用 SQL 表，**Service Broker**可以轻松适应，因为它只是另一个动态表。如果您已经在使用性能监视器， **MSMQ**可能更适合。**Service Broker**确实有很多性能计数器，所以不要让这成为您的唯一因素。
*   您如何衡量正常运行时间？仅仅是确保您不会丢失交易，还是需要同步响应？我发现**MSMQ**的分布式特性允许更长的正常运行时间，因为主队列可以离线并且不会丢失任何东西。而使用**Service Broker** ，您的数据库必须在线，否则您将失败。
*   您是否已经有使用这些技术之一的经验？两者都有很多实现细节，可以回来咬你。
*   无论您做出何种选择，切换底层队列技术有多容易？我建议您使用一个通用的 IQueue 接口来编写具体的实现。这样，如果您发现自己做出了错误的选择，以后可以轻松地更改您所做的选择。毕竟，队列只是一个队列，不应将您锁定在特定的实现中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-27T18:55:33.247

我以前使用过 MSMQ，我要添加到您的列表中的唯一项目是版本控制的先决条件检查。我遇到了一个问题，其中一个站点具有 Win 2000 Server 和 MSMQ v.2，而不是 Win 2003 Server 和 MSMQ v3。我所有的 .NET 代码都针对 v.3 并且它们不兼容......或者至少不容易兼容。

如果您走 MSMQ 路线，请考虑一下。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-11-23T03:12:27.987

MSMQ 中的消息大小限制已经停止了我在那个方向上的挖掘。我正在为该项目学习 Service Broker。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-19T08:07:06.803

> 您是否需要能够在目的地关闭时发送消息？MSMQ

我不明白为什么？SSB 可以毫无问题地将消息发送到断开连接的目的地。所有这些消息都进入传输队列，并在目的地保持可达时被传递。

# language-agnostic - 如何从嘈杂的 X、Y 数据中确定路径

> ID：240473
> 
> 赞同：9
> 
> 时间：2008-10-27T16:20:12.653
> 
> 标签：language-agnostic, math, geometry, 2d

我有一个未排序的嘈杂 X、Y 点列表。然而，它们确实形成了一条穿越世界的道路。我想要一种算法来使用线段绘制这些数据的近似值。

这类似于您如何使用线拟合算法来选择线性数据的近似值。我的问题更加困难，因为这条路在世界各地弯曲和蜿蜒。 [替代文字 http://www.praeclarum.org/so/pathfinder.png](http://www.praeclarum.org/so/pathfinder.png)

有谁知道任何标准/强大/易于理解的算法来实现这一点？

**问答**：

**你说的吵是什么意思？**如果我有一个理想的路径实现，那么我的一组点将从该理想路径中采样，并将高斯噪声添加到 X 和 Y 元素。我不知道该噪声的平均值或标准偏差。我也许可以猜到std dev ...

**这些点是否靠近但不在您寻求近似的理想但复杂的路径上？**是的。

**你有关于路径形状的任何先验信息吗？还有其他方法可以获取此类信息吗？**不幸的是没有。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-27T16:26:00.380

[贝塞尔插值](http://en.wikipedia.org/wiki/Bezier_curves)可能适合您的问题。

![贝塞尔插值](https://i.stack.imgur.com/wM1gG.gif)

但是，这并没有解决将点排序为路径的问题；有多种方法需要考虑：

*   任何“最优”类型的路径（例如路径上每个点的最小方向变化，* 通过所有点的最短路径）都可能归结为 NP 完全[旅行商问题](http://en.wikipedia.org/wiki/Traveling_salesman_problem)(TSP)。
*   集群节点然后在集群之间和集群内路由的“合理”路径。当然，集群越大，或者集群的数量越多，这个较小的问题就越像一个大的 n TSP。
*   按一个轴对点进行排序。如果轴多于 2 个，则某些[降维](http://en.wikipedia.org/wiki/Manifold_learning)策略可能有用。例如独立成分分析。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-27T16:33:51.987

使用未排序的列表，您将不会真正知道每个段中要包含哪些点，所以我想您可以选择最近的点。

一种方法是随机选择一个起点，然后在每一步中选择最近的点作为下一个点。将前两个点添加到集合 S。

将一条线拟合到 S 中的点，直到 RMS 超过某个值，然后清除 S 并开始一条新线。

连续线的交点将是线段的端点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-27T16:25:50.943

如果您的点彼此靠近，则可以使用普通的“直线”（正交线）。使用正常的[平滑算法](https://stackoverflow.com/questions/204184/how-to-smooth-data-and-calculate-line-gradient#204229)。你可以看到世界是平的。

如果它们相距很远，您需要通过使用[大圆圈](http://en.wikipedia.org/wiki/Great_circle)从一个点导航到另一个点来补偿地球的圆度。否则你的直线会走得更远。

如果一个点太远而无法创建直线，这是您的选择。

此外，您必须知道您是否需要“访问”每个点，或者只需要靠近，以及该附近有多近。

如果您需要将课程发送给飞机、轮船或其他旅行者，您可能需要访问每个点。如果您从一个对象获取 GPS 数据，您可能只想在屏幕上绘制一条路线，并消除噪音。

* * *

**看到你的编辑后：** 如果这是一个移动你想要绘制的轨迹的对象，你可能想要平滑方向和速度而不是 x/y 值。（使您的测量值 (x) 具有固定且增加的 Y 间隔使平滑变得更容易。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-27T16:58:50.907

这是一个启发式技巧，可以解决数据的排序问题，如果

*   你有足够的积分
*   与路径预期的最小曲率半径相比，点之间的平均距离很小
*   与std相比，点之间的平均距离并不大。开发。噪音的
*   路径不是自我交叉的（你可能会很幸运，但不能保证）

像这样进行：

1.  选择（希望通过有意义而不是随机的方式）一个起点**p1**。
2.  找到位于某个聚类距离**r_c** of **p1**内的所有点。选择**r_c**与预期的转弯半径相比较小，但与散射相比较大。
3.  将此集群**称为 C1**。
4.  找到点**q1中****C1**位置的平均值。
5.  将一条线拟合到**C1**中的点并投影到（或刚好超出）集群的边缘，并在原始数据中找到最近的点。标记该点**p2**。
6.  重复步骤 2-5，直到用完数据。

现在你有一个新的点**q1** .. **qn**列表。

在我的头顶上，非常粗糙，只有在相当好的条件下才能工作......

* * *

通过在步骤 (5) 中要求新投影线位于前一个投影线的某个最大角度内，可能可以改进自交叉行为。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-27T23:35:17.690

贝塞尔曲线的问题在于它实际上并没有通过您采样的点，即使点样本有点失真；贝塞尔曲线实际上可能相距几英里。

Catmull-Rom Spline是一个更好的近似值，并且似乎更接近原始图像的解决方案是[Catmull-Rom Spline](http://www.mvps.org/directx/articles/catmull/)，因为它确实通过了曲线中的所有点。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-27T17:14:08.927

我的方法是首先对点列表进行排序，然后使用贝塞尔曲线。

诀窍当然是排序。从一个随机点开始，找到最近的点。假设这两个是连接的。使用这两个端点，找到离它们最近的点。假设到它的端点距离较小的那个连接到那个点。重复直到所有点都连接。

我认为这种方法仍然存在一些问题，但也许您可以将其用作起点（双关语）。

**编辑：**你可以用不同的起点做几次，然后看看结果有什么不同。这至少给了你一些信心，哪些点是相互连接的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-27T19:18:38.690

一种完全不同的方法，不需要其他约束，但细节可能取决于您的应用程序。如果您在路径周围有“密集的点云”，它应该效果最好。

使用定义曲线和点云之间差异的“成本”函数。使用参数化曲线和标准优化算法。- 或 - 从头到尾从一条直线开始，然后使用遗传算法对其进行修改。

典型的成本函数是取每个点和曲线之间的最小距离，并对平方求和。

我没有足够的经验来建议优化或遗传算法，但我相信可以做到:)

我可以想象一个遗传算法如下：路径将从航点构建。首先将 N 个航路点从头到尾排成一条直线。（可以根据问题选择N）。突变可能是：

1.  对于每个段，如果 rnd() < x，则在中间引入一个新的航路点。
2.  对于每个航路点，X 和 Y 坐标略有不同。

您需要在成本函数中包含总长度。可能不需要拆分，或者随着更多航路点的引入，x（“拆分机会”）可能需要减少。您可能希望也可能不希望将 (2) 应用于起点和终点。

尝试一下会很有趣...

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-08T00:14:00.647

我认为“未排序的列表”意味着虽然您的点集是完整的，但您不知道它们经过的顺序是什么？

基本上必须忽略高斯噪声。我们绝对没有任何信息可以让我们尝试重建原始的、无噪音的路径。所以我认为我们能做的最好的就是假设这些观点是正确的。

此时，任务包括“通过一组点找到最佳路径”，其中“最佳”保持模糊。我编写了一些代码，试图在欧几里得空间中对一组点进行排序，更喜欢产生直线的排序。虽然该指标很容易实现，但我想不出一个基于此改进排序的好方法，所以我只是随机交换点以寻找更好的安排。

所以，这里有一些 PLT Scheme 代码可以做到这一点。

```
#lang scheme

(require (only-in srfi/1 iota))

; a bunch of trig
(define (deg->rad d)
  (* pi (/ d 180)))

(define (rad->deg r)
  (* 180 (/ r pi)))

(define (euclidean-length v)
  (sqrt (apply + (map (lambda (x) (expt x 2)) v))))

(define (dot a b)
  (apply + (map * a b)))

(define (angle-ratio a b)
  (/ (dot a b)
     (* (euclidean-length a) (euclidean-length b))))

; given a list of 3 points, calculate the likelihood of the
; angle they represent. straight is better.
(define (probability-triple a b c)
  (let ([av (map - a b)]
        [bv (map - c b)])
    (cos (/ (- pi (abs (acos (angle-ratio av bv)))) 2))))

; makes a random 2d point. uncomment the bit for a 3d point
(define (random-point . x)
  (list (/ (random 1000) 100)
        (/ (random 1000) 100)
        #;(/ (random 1000) 100)))

; calculate the likelihood of an entire list of points
(define (point-order-likelihood lst)
  (if (null? (cdddr lst))
      1
      (* (probability-triple (car lst)
                             (cadr lst)
                             (caddr lst))
         (point-order-likelihood (cdr lst)))))

; just print a list of points
(define (print-points lst)
  (for ([p (in-list lst)])
    (printf "~a~n"
            (string-join (map number->string
                              (map exact->inexact p))
                         " "))))

; attempts to improve upon a list
(define (find-better-arrangement start
                                 ; by default, try only 10 times to find something better
                                 [tries 10]
                                 ; if we find an arrangement that is as good as one where
                                 ; every segment bends by 22.5 degrees (which would be
                                 ; reasonably gentle) then call it good enough. higher
                                 ; cut offs are more demanding.
                                 [cut-off (expt (cos (/ pi 8))
                                                (- (length start) 2))])
  (let ([vec (list->vector start)]
        ; evaluate what we've started with
        [eval (point-order-likelihood start)])
    (let/ec done
      ; if the current list exceeds the cut off, we're done
      (when (> eval cut-off)
        (done start))
      ; otherwise, try no more than 'tries' times...
      (for ([x (in-range tries)])
        ; pick two random points in the list
        (let ([ai (random (vector-length vec))]
              [bi (random (vector-length vec))])
          ; if they're the same...
          (when (= ai bi)
            ; increment the second by 1, wrapping around the list if necessary
            (set! bi (modulo (add1 bi) (vector-length vec))))
          ; take the values from the two positions...
          (let ([a  (vector-ref vec ai)]
                [b  (vector-ref vec bi)])
            ; swap them
            (vector-set! vec bi a)
            (vector-set! vec ai b)
            ; make a list out of the vector
            (let ([new (vector->list vec)])
              ; if it evaluates to better
              (when (> (point-order-likelihood new) eval)
                ; start over with it
                (done (find-better-arrangement new tries cut-off)))))))
      ; we fell out the bottom of the search. just give back what we started with
      start)))

; evaluate, display, and improve a list of points, five times
(define points (map random-point (iota 10)))
(define tmp points)
(printf "~a~n" (point-order-likelihood tmp))
(print-points tmp)
(set! tmp (find-better-arrangement tmp 10))
(printf "~a~n" (point-order-likelihood tmp))
(print-points tmp)
(set! tmp (find-better-arrangement tmp 100))
(printf "~a~n" (point-order-likelihood tmp))
(print-points tmp)
(set! tmp (find-better-arrangement tmp 1000))
(printf "~a~n" (point-order-likelihood tmp))
(print-points tmp)
(set! tmp (find-better-arrangement tmp 10000))
(printf "~a~n" (point-order-likelihood tmp))
(print-points tmp) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-27T17:00:29.827

似乎您从问题的答案中知道“黄金曲线”，我建议按照@jamesh 的建议找到“黄金曲线”的贝塞尔曲线并绘制它。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-27T18:54:20.457

你有多少分？
如前所述，如果您的点数相对较少，则贝塞尔曲线是一个好主意。如果您有很多点，请按照 dmckee 的建议构建集群。

但是，您**还**需要另一个约束来定义点的顺序。关于如何选择点有很多很好的建议，但除非你引入另一个约束，否则任何一个都可以提供可能的解决方案。

我能想到的可能限制：

*   最短路径
*   最直线段
*   最小总绝对旋转
*   方向偏好（即水平/垂直比纵横交错更有可能）

在所有情况下，为了满足约束，您可能需要测试序列的所有排列。如果您从“好猜测”开始，您可以快速终止其他人。

# java - 将字符串转换为 GregorianCalendar

> ID：240510
> 
> 赞同：18
> 
> 时间：2008-10-27T16:29:12.030
> 
> 标签：java, calendar, timezone

我有一个来自电子邮件标题的字符串，例如`Date: Mon, 27 Oct 2008 08:33:29 -0700`. 我需要的是一个 GregorianCalendar 的实例，它将代表同一时刻。就这么简单——我该怎么做？

而对于最快的——这将**无法**正常工作：

```
SimpleDateFormat format = ... // whatever you want
Date date = format.parse(myString)
GregorianCalendar calendar = new GregorianCalendar();
calendar.setTime(date) 
```

因为它将时区标准化为 UTC（或您的本地机器时间，取决于 Java 版本）。我需要的是 calendar.getTimeZone().getRawOffset() 来返回`-7 * milisInAnHour`。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-27T16:43:50.627

如果可以的话，我建议您查看 Joda Time 库。在核心平台提供类似功能的情况下，我通常反对使用第三方库，但我将其作为一个例外，因为 Joda Time 的作者也在 JSR310 背后，而 Joda Time 基本上最终会滚入 Java 7。

[http://joda-time.sourceforge.net/](http://joda-time.sourceforge.net/)

所以无论如何，如果 Joda Time 是一个选项，这样的事情*应该可以*工作：

```
DateTimeFormatter formatter =
    DateTimeFormat.forPattern("your pattern").withOffsetParsed();
DateTime dateTime = formatter.parseDateTime("your input");
GregorianCalendar cal = dateTime.toGregorianCalendar(); 
```

我希望这有帮助。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-27T17:29:20.440

> 对于最快的 - 这不会正常工作......因为它会将时区标准化为 UTC（或您的本地机器时间，取决于 Java 版本）。我需要的是 calendar.getTimeZone().getRawOffset() 返回 -7 * milisInAnHour。

从技术上讲，这确实有效，因为虽然它会返回一个 TimeZone 等于当前系统 TimeZone 的对象，但时间将被修改以考虑偏移量。

这段代码：

```
String dateString = "Mon, 27 Oct 2008 08:33:29 -0700";
DateFormat df = new SimpleDateFormat("E, dd MMM yyyy hh:mm:ss Z");
Date parsed = df.parse(dateString);
System.out.println("parsed date: " + parsed);

Calendar newCalendar = Calendar.getInstance();
newCalendar.setTime(parsed); 
```

输出：

> 解析日期：2008 年 10 月 27 日星期一 11:33:29 EDT

这在技术上是正确的，因为我的系统时区是 EDT / UTC 减去四个小时（比你的时间早三个小时）。如果您将时间表示为自 1970 年 1 月 1 日 00:00:00 GMT 以来的毫秒数（这是`Date`对象存储日期/时间的方式），那么这些日期/时间是相等的，只是 TimeZone 不同。

您的问题实际上是*如何将日期/日历转换为我的时区？*为此，请查看我对上一个问题[如何使用 Java 处理日历时区的回复？](https://stackoverflow.com/questions/230126/how-to-handle-calendar-timezones-using-java#230383)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2021-05-10T14:48:17.160

# *java.time*

**使用[现代日期时间 API](https://www.oracle.com/technical-resources/articles/java/jf14-date-time.html)`java.time`的解决方案：**

现代日期时间 API 提供[`OffsetDateTime`](https://docs.oracle.com/javase/8/docs/api/java/time/OffsetDateTime.html)了表示具有时区偏移的日期时间对象。它可以转换为[`Instant`](https://docs.oracle.com/javase/8/docs/api/java/time/Instant.html)代表时间轴上的瞬时点的哪一个。An`Instant`独立于任何时区，即它具有`+00:00`小时的时区偏移量，`Z`在[ISO 8601](https://en.wikipedia.org/wiki/ISO_8601#Time_zone_designators)标准中指定。

[`Instant#toEpochMilli`](https://docs.oracle.com/javase/8/docs/api/java/time/Instant.html#toEpochMilli--)将此瞬间转换为从 1970-01-01T00:00:00Z 开始的毫秒数。该值可以设置为一个对象，`GregorianCalendar`然后该对象将代表同一时刻。

**演示：**

```
import java.time.Instant;
import java.time.OffsetDateTime;
import java.time.format.DateTimeFormatter;
import java.util.Calendar;
import java.util.GregorianCalendar;
import java.util.Locale;

public class Main {
    public static void main(String[] args) {
        String strDateTime = "Mon, 27 Oct 2008 08:33:29 -0700";
        OffsetDateTime odt = OffsetDateTime.parse(strDateTime, DateTimeFormatter.RFC_1123_DATE_TIME);
        System.out.println(odt);

        // In case you want a time zone neutral object, convert to Instant
        Instant instant = odt.toInstant();
        System.out.println(instant);

        // Edit: If the requirement is a GregorianCalendar having the offset from
        // the string — typically for an old API not yet upgraded to java.time: 
        ZonedDateTime zdt = ZonedDateTime.parse(strDateTime, DateTimeFormatter.RFC_1123_DATE_TIME);
        GregorianCalendar gc = GregorianCalendar.from(zdt);

        System.out.println("As Date:      " + gc.getTime());
        System.out.println("Time zone ID: " + gc.getTimeZone().getID());
        System.out.println("Hour of day:  " + gc.get(Calendar.HOUR_OF_DAY));
        // ...
    }
} 
```

**输出：**

```
2008-10-27T08:33:29-07:00
2008-10-27T15:33:29Z
As Date:      Mon Oct 27 15:33:29 GMT 2008
Time zone ID: GMT-07:00
Hour of day:  8 
```

调用转换为没有时区的`getTime()`（另一个旧且容易出错的类），因此偏移量丢失。打印时区 ID 和时间表明偏移量和时间都保存在.`GregorianCalendar``Date``GregorianCalendar`

**[从Trail: Date Time](https://docs.oracle.com/javase/tutorial/datetime/index.html)**了解有关现代日期时间 API 的更多信息。

* * *

^(* 出于任何原因，如果您必须坚持使用 Java 6 或 Java 7，则可以使用[***ThreeTen-Backport，***](http://www.threeten.org/threetenbp/)它将大部分*java.time*功能向后移植到 Java 6 和 7。如果您正在为 Android 项目和 Android API 工作level 仍然不符合 Java-8，请检查[Java 8+ APIs available through desugaring](https://developer.android.com/studio/write/java8-support-table)和[How to use ThreeTenABP in Android Project](https://stackoverflow.com/questions/38922754/how-to-use-threetenabp-in-android-project)。)

# java - 模式：从轴对象转换 Java 类

> ID：240519
> 
> 赞同：7
> 
> 时间：2008-10-27T16:30:50.277
> 
> 标签：java, axis

我使用轴自动生成 Web 服务工件，然后将其转换为应用程序中使用的对象。这样做有合理的模式吗？我们编写了转换方法来从轴创建的对象中输出我们的对象，在其他时候我们编写了一组中间的转换器类，将轴对象转换为我们的应用程序对象？有没有一种通用的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-05T02:34:19.723

如果我理解正确，您想使用 Axis WSDL2Java 功能从 WSDL 生成代码，然后将其映射到您现有的应用程序对象模型。在这种情况下，您可能需要考虑将 Axis 与[JiBX](http://jibx.sourceforge.net/)绑定一起使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T16:00:21.360

如果目标是将“生成的轴”转换为您的业务对象，您可以尝试像推土机（[http://dozer.sourceforge.net/](http://dozer.sourceforge.net/)）这样的工具，它是一个“映射器”，可以从对象实现复制到另一个实现。它不知道如何使用它（我认为您必须在 xml 文件中解释翻译）然后它应该可以工作（我自己没有使用但一些同事将它用于类似目的并且它似乎有效）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T07:41:09.370

我想有一种*常识性*的方法可以做到这一点。抽象一点你的思想并想象层次。

1.  您将获得一个包含基本 IO 以及基本会话功能和/或凭据的库。
2.  创建一个转换层。在这里，您将放置构建应用程序相关对象所需的所有代码。为您的应用程序提供一个漂亮的界面来完成这一层。

转换层可以通过多种方式完成。

*   如果转换很简单，您几乎可以将第一层和第二层合并为一个。扩展 POJOS 以提供转换功能。这将为您提供至少两段代码，自动生成的和扩展+功能

*   如果我们谈论需要转换为多个小型应用程序对象的大型 XML。好的，保持第一层不变，在第二次使用中：

    *   **命令模式**：封装转换。
    *   如果转换也变得混乱：**责任链**将帮助您生成转换树。

我希望这有帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-27T18:59:48.387

我们过去也遇到过类似的问题。最近，对于我们让 Axis 为其生成工件的复杂 Web 服务，我们最终得到了 157 个 Java 类，其名称类似于“MaintainOffersRequestTypeReqReqDataMaintEnhancementCancellationReason”。

我们最终编写了将这些 Axis 生成的对象转换为业务对象的类，类似于您的上一个想法。我不知道这是否是最好的方法，但它肯定是一个可行的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-05T14:00:29.653

如果您使用的是 Axis 1，那么您的业务类与 Axis 数据类具有相同的限定名称，并且适用一些其他条件，您可以使用您的业务类代替 Axis 类，而无需进行设置。我们已经做过很多次了。

对于 Axis 2，我们遇到了除 ADB（默认）之外的数据绑定问题，因此我们广泛使用 Apache Commons Beanutils 在 Axis 类和我们的业务类之间来回复制数据。

# c# - 如何在 C# 中对日期字段进行周末舍入（不使用 LINQ）？

> ID：240531
> 
> 赞同：2
> 
> 时间：2008-10-27T16:35:10.970
> 
> 标签：c#, .net, datetime

我有一个奇怪的日期舍入问题，希望有人能解决。我的客户使用从周一到周日的工作周。星期天的日期被认为是一周的结束，并用于标识在特定星期输入的所有记录（因此上周输入的任何内容的 WEEKDATE 值为 '10/26/2008'，即星期日的日期）。

一个小转折是用户输入前一周的记录，直到当周星期一的上午 11 点。

所以我需要一个以 DateTime.Now 开头的函数，并根据上述规则返回周末的日期（无时间部分）。谢谢你的帮助。我有一个可行的解决方案，但我不好意思发布它。

哦，我不能使用 LINQ。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-27T16:42:23.047

```
public DateTime WeekNum(DateTime now)
{
    DateTime NewNow = now.AddHours(-11).AddDays(6);

    return (NewNow.AddDays(- (int) NewNow.DayOfWeek).Date);
}

public void Code(params string[] args)
{

    Console.WriteLine(WeekNum(DateTime.Now));   
    Console.WriteLine(WeekNum(new DateTime(2008,10,27, 10, 00, 00)));
    Console.WriteLine(WeekNum(new DateTime(2008,10,27, 12, 00, 00)));
    Console.WriteLine(WeekNum(new DateTime(2008,10,28)));
    Console.WriteLine(WeekNum(new DateTime(2008,10,25)));

} 
```

您可以硬编码 DateTime.Now 而不是传递 DateTime 对象。它只是使测试更容易这种方式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-27T16:53:56.970

这也适用于我：

```
[Test]
public void Test()
{
   DateTime sunday = DateTime.Parse("10/26/2008");
   DateTime nextSunday = DateTime.Parse("11/2/2008");

   Assert.AreEqual(sunday, GetSunday(DateTime.Parse("10/21/2008")));
   Assert.AreEqual(sunday, GetSunday(DateTime.Parse("10/22/2008")));
   Assert.AreEqual(sunday, GetSunday(DateTime.Parse("10/23/2008")));
   Assert.AreEqual(sunday, GetSunday(DateTime.Parse("10/24/2008")));
   Assert.AreEqual(sunday, GetSunday(DateTime.Parse("10/25/2008")));
   Assert.AreEqual(sunday, GetSunday(DateTime.Parse("10/26/2008")));
   Assert.AreEqual(sunday, GetSunday(DateTime.Parse("10/27/2008 10:59 AM")));
   Assert.AreEqual(nextSunday, GetSunday(DateTime.Parse("10/27/2008 11:00 AM")));
}

private DateTime GetSunday(DateTime date)
{
   if (date.DayOfWeek == DayOfWeek.Monday && date.Hour < 11)
      return date.Date.AddDays(-1);

   while (date.DayOfWeek != DayOfWeek.Sunday)
      date = date.AddDays(1);

   return date.Date;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T18:21:17.247

```
DateTime GetMidnightFollowingSunday()
{
    DateTime now = DateTime.Now;
    return now.AddDays(7 - (int)now.DayOfWeek).Date;
} 
```

如果您需要在星期一早上 11 点之后开始新的一周，只需从现在减去 11 小时，但是将方法命名为其他名称可能是有意义的。

```
DateTime GetRecordDate()
{
    DateTime nowMinusOffset = DateTime.Now.AddHours(-11);
    return nowMinusOffset.AddDays(7-(int)nowMinusOffset.DayOfWeek).Date;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-27T17:41:41.837

我已经成功地使用了这些扩展：

[http://www.codeplex.com/DateTimeExtensions](http://www.codeplex.com/DateTimeExtensions)

# web-applications - 用于运行 ant 任务的 Web 应用

> ID：240537
> 
> 赞同：0
> 
> 时间：2008-10-27T16:37:32.387
> 
> 标签：web-applications, command-line, ant

有谁知道支持运行 ant 任务的简单网络应用程序？或者，它可以运行命令行程序。我需要允许用户选择运行 ant 任务的参数。我实际上想要一个 Web 界面来运行 ant 任务并提供任何参数。

我可以写一个，但这足够通用，似乎应该已经有一些标准包可以做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-30T21:45:50.797

你可以给[Anthill](http://www.anthillpro.com/html/products/anthillos/download.html)一个机会。他们有一个开源版本。这将定期检查您的源代码存储库，并在代码库更改时运行指定的 ant 任务。您也可以手动触发构建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-27T16:41:17.933

你可以把它放在一个 PHP 文件中：

```
echo shell_exec('ant'); 
```

它将运行 ant 并将输出返回给浏览器。

# mysql - 我什么时候应该在 MySQL 表中使用“NOT NULL”，有什么好处吗？

> ID：240544
> 
> 赞同：8
> 
> 时间：2008-10-27T16:38:49.920
> 
> 标签：mysql, ruby-on-rails, null, migration

我有以下 Rails 迁移：

```
create_table :articles do |t|
  t.integer :user_id, :allow_null => false
  t.integer :genre_id, :allow_null => false
  t.string :url, :limit => 255, :allow_null => false
  t.string :title, :limit => 60, :allow_null => false
  t.text :summary, :limit => 350, :allow_null => false
  t.integer :votes_count, :default => 0
  t.datetime :published_at, :default => nil
  t.timestamps
end 
```

首先在模型中验证所有“NOT NULL”的字段，所以我想知道我是否需要在迁移中使用allow_null？我不确定“NOT NULL”给数据库带来了什么好处（如果有的话）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-27T16:41:12.130

如果您的意思是性能或存储效率，那就不多了。但是，将尽可能多的低级约束推送到数据库层只是一个好习惯。一方面，它保证 Rails 中的一个细微错误不会导致`NULL`非空字段中的一些随机数据。同样，如果您曾经针对同一个数据库运行另一个应用程序，那么将约束放在一个中心位置以进行维护并避免重复将非常有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-27T17:06:54.963

NOT NULL 是计算机可以监视您并防止您出错的另一件事。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T17:37:29.817

这似乎不会影响 mySQL，但您应该注意 2 个最近修复的迁移问题（一个当您未指定默认值时）

[http://blog.codefront.net/2008/05/04/living-on-the-edge-of-rails-19-change_table-for-migrations-and-more/](http://blog.codefront.net/2008/05/04/living-on-the-edge-of-rails-19-change_table-for-migrations-and-more/)

[http://antoniocangiano.com/2008/07/14/a-close-look-at-three-rails-21-bugs/](http://antoniocangiano.com/2008/07/14/a-close-look-at-three-rails-21-bugs/)

# java - 从字符串中删除 HTML 标记

> ID：240546
> 
> 赞同：461
> 
> 时间：2008-10-27T16:39:29.170
> 
> 标签：java, html, regex, parsing

有没有从 Java 字符串中删除 HTML 的好方法？一个简单的正则表达式

```
replaceAll("\\<.*?>", "") 
```

会工作，但`&amp;`不会正确转换，两个尖括号之间的非 HTML 将被删除（即`.*?`正则表达式中的 将消失）。

* * *

## 回答 #1

> 赞同：624
> 
> 时间：2010-06-30T13:24:48.390

使用 HTML 解析器而不是正则表达式。这对于[Jsoup](http://jsoup.org)来说非常简单。

```
public static String html2text(String html) {
    return Jsoup.parse(html).text();
} 
```

Jsoup 还[支持](https://jsoup.org/cookbook/cleaning-html/whitelist-sanitizer)针对可自定义的白名单删除 HTML 标记，如果您只想允许例如`<b>`和.`<i>``<u>`

### 也可以看看：

*   [RegEx 匹配打开的标签，XHTML 自包含标签除外](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags)
*   [领先的 Java HTML 解析器的优缺点是什么？](https://stackoverflow.com/questions/3152138/what-are-the-pros-and-cons-of-the-leading-java-html-parsers)
*   [JSP/Servlet Web 应用程序中的 XSS 预防](https://stackoverflow.com/questions/2658922/xss-prevention-in-jsp-servlet-web-application)

* * *

## 回答 #2

> 赞同：293
> 
> 时间：2011-06-17T12:48:08.653

如果你正在为**Android**写作，你可以这样做......

androidx.core.text.HtmlCompat.fromHtml(指令，HtmlCompat.FROM_HTML_MODE_LEGACY).toString()

* * *

## 回答 #3

> 赞同：92
> 
> 时间：2008-10-27T17:00:33.213

如果用户输入`<b>hey!</b>`，你想显示`<b>hey!</b>`还是`hey!`？如果是第一个，请转义小于号，然后对 & 符号（以及可选的引号）进行 html 编码，这样就可以了。修改您的代码以实现第二个选项将是：

```
replaceAll("\\<[^>]*>","") 
```

但如果用户输入格式错误的内容，例如`<bhey!</b>`.

您还可以查看[JTidy](http://jtidy.sourceforge.net/)，它将解析“脏”的 html 输入，并且应该为您提供一种删除标签、保留文本的方法。

尝试剥离 html 的问题在于浏览器的解析器非常宽松，比您能找到的任何库都宽松，所以即使您尽最大努力剥离所有标签（使用上面的替换方法、DOM 库或 JTidy） ，您*仍然*需要确保对任何剩余的 HTML 特殊字符进行编码，以确保您的输出安全。

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2009-01-18T14:16:52.167

另一种方法是使用 *javax.swing.text.html.HTMLEditorKit*来提取文本。

```
import java.io.*;
import javax.swing.text.html.*;
import javax.swing.text.html.parser.*;

public class Html2Text extends HTMLEditorKit.ParserCallback {
    StringBuffer s;

    public Html2Text() {
    }

    public void parse(Reader in) throws IOException {
        s = new StringBuffer();
        ParserDelegator delegator = new ParserDelegator();
        // the third parameter is TRUE to ignore charset directive
        delegator.parse(in, this, Boolean.TRUE);
    }

    public void handleText(char[] text, int pos) {
        s.append(text);
    }

    public String getText() {
        return s.toString();
    }

    public static void main(String[] args) {
        try {
            // the HTML to convert
            FileReader in = new FileReader("java-new.html");
            Html2Text parser = new Html2Text();
            parser.parse(in);
            in.close();
            System.out.println(parser.getText());
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
} 
```

ref :[从文件中删除 HTML 标记以仅提取 TEXT](http://www.rgagnon.com/javadetails/java-0424.html)

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2010-11-04T10:13:09.053

我认为过滤 html 标签的最简单方法是：

```
private static final Pattern REMOVE_TAGS = Pattern.compile("<.+?>");

public static String removeTags(String string) {
    if (string == null || string.length() == 0) {
        return string;
    }

    Matcher m = REMOVE_TAGS.matcher(string);
    return m.replaceAll("");
} 
```

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2011-08-05T21:11:49.643

[使用Jericho](http://jericho.htmlparser.net/docs/index.html)也非常简单，您可以保留一些格式（例如换行符和链接）。

```
 Source htmlSource = new Source(htmlText);
    Segment htmlSeg = new Segment(htmlSource, 0, htmlSource.length());
    Renderer htmlRend = new Renderer(htmlSeg);
    System.out.println(htmlRend.toString()); 
```

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2014-05-13T04:12:35.823

接受的答案只是`Jsoup.parse(html).text()`有 2 个潜在问题（使用 JSoup 1.7.3）：

*   它从文本中删除换行符
*   它将文本`&lt;script&gt;`转换为`<script>`

如果你用它来防御 XSS，这有点烦人。这是我使用 JSoup 和 Apache StringEscapeUtils 改进解决方案的最佳方法：

```
// breaks multi-level of escaping, preventing &amp;lt;script&amp;gt; to be rendered as <script>
String replace = input.replace("&amp;", "");
// decode any encoded html, preventing &lt;script&gt; to be rendered as <script>
String html = StringEscapeUtils.unescapeHtml(replace);
// remove all html tags, but maintain line breaks
String clean = Jsoup.clean(html, "", Whitelist.none(), new Document.OutputSettings().prettyPrint(false));
// decode html again to convert character entities back into text
return StringEscapeUtils.unescapeHtml(clean); 
```

请注意，最后一步是因为我需要将输出用作纯文本。如果您只需要 HTML 输出，那么您应该能够将其删除。

这是一堆测试用例（输入到输出）：

```
{"regular string", "regular string"},
{"<a href=\"link\">A link</a>", "A link"},
{"<script src=\"http://evil.url.com\"/>", ""},
{"&lt;script&gt;", ""},
{"&amp;lt;script&amp;gt;", "lt;scriptgt;"}, // best effort
{"\" ' > < \n \\ é å à ü and & preserved", "\" ' > < \n \\ é å à ü and & preserved"} 
```

如果你有办法让它变得更好，请告诉我。

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2015-05-04T04:29:30.327

在 Android 上，试试这个：

```
String result = Html.fromHtml(html).toString(); 
```

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2008-10-27T17:03:56.373

HTML 转义真的很难做到正确——我绝对建议使用库代码来做到这一点，因为它比你想象的要微妙得多。查看 Apache 的[StringEscapeUtils](http://commons.apache.org/proper/commons-lang/javadocs/api-release/org/apache/commons/lang3/StringEscapeUtils.html)以获得在 Java 中处理此问题的非常好的库。

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2017-06-30T11:42:51.877

这应该工作 -

用这个

```
 text.replaceAll('<.*?>' , " ") -> This will replace all the html tags with a space. 
```

还有这个

```
 text.replaceAll('&.*?;' , "")-> this will replace all the tags which starts with "&" and ends with ";" like &nbsp;, &amp;, &gt; etc. 
```

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2019-03-29T08:37:20.813

**您可以简单地使用 Android 的默认 HTML 过滤器**

```
 public String htmlToStringFilter(String textToFilter){

    return Html.fromHtml(textToFilter).toString();

    } 
```

上述方法将为您的输入返回经过 HTML 过滤的字符串。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2008-10-27T23:52:37.500

您可能希望在剥离 HTML 之前用换行符替换`<br/>`和`</p>`标记，以防止它像 Tim 建议的那样变得难以辨认。

我能想到删除 HTML 标签但在尖括号之间保留非 HTML 的唯一方法是检查[HTML 标签列表](http://www.w3schools.com/tags/default.asp)。沿着这些路线的东西......

```
replaceAll("\\<[\s]*tag[^>]*>","") 
```

然后对特殊字符进行 HTML 解码，例如`&amp;`. 结果不应被视为已消毒。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2014-02-17T20:19:48.627

或者，可以使用[HtmlCleaner](http://htmlcleaner.sourceforge.net/index.php)：

```
private CharSequence removeHtmlFrom(String html) {
    return new HtmlCleaner().clean(html).getText();
} 
```

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2015-11-23T12:11:20.753

采用**`Html.fromHtml`**

***HTML***标签是

```
<a href=”…”&gt; <b>,  <big>, <blockquote>, <br>, <cite>, <dfn>
<div align=”…”&gt;,  <em>, <font size=”…” color=”…” face=”…”&gt;
<h1>,  <h2>, <h3>, <h4>,  <h5>, <h6>
<i>, <p>, <small>
<strike>,  <strong>, <sub>, <sup>, <tt>, <u> 
```

根据**[Android 的官方文档](http://developer.android.com/intl/es/reference/android/text/Html.html)****， HTML**中的任何标签都将显示为通用替换**字符串**，然后您的程序可以通过它并用真正的***字符串***替换。

**`Html.formHtml`**方法将一个**`Html.TagHandler`**和一个 Html.ImageGetter 作为参数以及要解析的文本。

## 例子

```
String Str_Html=" <p>This is about me text that the user can put into their profile</p> "; 
```

然后

```
Your_TextView_Obj.setText(Html.fromHtml(Str_Html).toString()); 
```

输出

**这是关于我的文本，用户可以将其放入他们的个人资料中**

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2010-04-23T21:22:55.853

这是一个稍微更充实的更新，以尝试处理中断和列表的一些格式。我使用 Amaya 的输出作为指导。

```
import java.io.IOException;
import java.io.Reader;
import java.io.StringReader;
import java.util.Stack;
import java.util.logging.Logger;

import javax.swing.text.MutableAttributeSet;
import javax.swing.text.html.HTML;
import javax.swing.text.html.HTMLEditorKit;
import javax.swing.text.html.parser.ParserDelegator;

public class HTML2Text extends HTMLEditorKit.ParserCallback {
    private static final Logger log = Logger
            .getLogger(Logger.GLOBAL_LOGGER_NAME);

    private StringBuffer stringBuffer;

    private Stack<IndexType> indentStack;

    public static class IndexType {
        public String type;
        public int counter; // used for ordered lists

        public IndexType(String type) {
            this.type = type;
            counter = 0;
        }
    }

    public HTML2Text() {
        stringBuffer = new StringBuffer();
        indentStack = new Stack<IndexType>();
    }

    public static String convert(String html) {
        HTML2Text parser = new HTML2Text();
        Reader in = new StringReader(html);
        try {
            // the HTML to convert
            parser.parse(in);
        } catch (Exception e) {
            log.severe(e.getMessage());
        } finally {
            try {
                in.close();
            } catch (IOException ioe) {
                // this should never happen
            }
        }
        return parser.getText();
    }

    public void parse(Reader in) throws IOException {
        ParserDelegator delegator = new ParserDelegator();
        // the third parameter is TRUE to ignore charset directive
        delegator.parse(in, this, Boolean.TRUE);
    }

    public void handleStartTag(HTML.Tag t, MutableAttributeSet a, int pos) {
        log.info("StartTag:" + t.toString());
        if (t.toString().equals("p")) {
            if (stringBuffer.length() > 0
                    && !stringBuffer.substring(stringBuffer.length() - 1)
                            .equals("\n")) {
                newLine();
            }
            newLine();
        } else if (t.toString().equals("ol")) {
            indentStack.push(new IndexType("ol"));
            newLine();
        } else if (t.toString().equals("ul")) {
            indentStack.push(new IndexType("ul"));
            newLine();
        } else if (t.toString().equals("li")) {
            IndexType parent = indentStack.peek();
            if (parent.type.equals("ol")) {
                String numberString = "" + (++parent.counter) + ".";
                stringBuffer.append(numberString);
                for (int i = 0; i < (4 - numberString.length()); i++) {
                    stringBuffer.append(" ");
                }
            } else {
                stringBuffer.append("*   ");
            }
            indentStack.push(new IndexType("li"));
        } else if (t.toString().equals("dl")) {
            newLine();
        } else if (t.toString().equals("dt")) {
            newLine();
        } else if (t.toString().equals("dd")) {
            indentStack.push(new IndexType("dd"));
            newLine();
        }
    }

    private void newLine() {
        stringBuffer.append("\n");
        for (int i = 0; i < indentStack.size(); i++) {
            stringBuffer.append("    ");
        }
    }

    public void handleEndTag(HTML.Tag t, int pos) {
        log.info("EndTag:" + t.toString());
        if (t.toString().equals("p")) {
            newLine();
        } else if (t.toString().equals("ol")) {
            indentStack.pop();
            ;
            newLine();
        } else if (t.toString().equals("ul")) {
            indentStack.pop();
            ;
            newLine();
        } else if (t.toString().equals("li")) {
            indentStack.pop();
            ;
            newLine();
        } else if (t.toString().equals("dd")) {
            indentStack.pop();
            ;
        }
    }

    public void handleSimpleTag(HTML.Tag t, MutableAttributeSet a, int pos) {
        log.info("SimpleTag:" + t.toString());
        if (t.toString().equals("br")) {
            newLine();
        }
    }

    public void handleText(char[] text, int pos) {
        log.info("Text:" + new String(text));
        stringBuffer.append(text);
    }

    public String getText() {
        return stringBuffer.toString();
    }

    public static void main(String args[]) {
        String html = "<html><body><p>paragraph at start</p>hello<br />What is happening?<p>this is a<br />mutiline paragraph</p><ol>  <li>This</li>  <li>is</li>  <li>an</li>  <li>ordered</li>  <li>list    <p>with</p>    <ul>      <li>another</li>      <li>list        <dl>          <dt>This</dt>          <dt>is</dt>            <dd>sdasd</dd>            <dd>sdasda</dd>            <dd>asda              <p>aasdas</p>            </dd>            <dd>sdada</dd>          <dt>fsdfsdfsd</dt>        </dl>        <dl>          <dt>vbcvcvbcvb</dt>          <dt>cvbcvbc</dt>            <dd>vbcbcvbcvb</dd>          <dt>cvbcv</dt>          <dt></dt>        </dl>        <dl>          <dt></dt>        </dl></li>      <li>cool</li>    </ul>    <p>stuff</p>  </li>  <li>cool</li></ol><p></p></body></html>";
        System.out.println(convert(html));
    }
} 
```

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2010-08-06T18:23:34.620

另一种方法是使用 com.google.gdata.util.common.html.HtmlToText 类

```
MyWriter.toConsole(HtmlToText.htmlToPlainText(htmlResponse)); 
```

不过，这不是防弹代码，当我在维基百科条目上运行它时，我也会获得样式信息。但是，我相信对于小型/简单的工作，这将是有效的。

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2010-08-12T23:24:27.963

对于我指出的测试用例，接受的答案对我不起作用：“a < b or b > c”的结果是“ab or b > c”。

所以，我改用 TagSoup。这是一个适用于我的测试用例（以及其他几个）的镜头：

```
import java.io.IOException;
import java.io.StringReader;
import java.util.logging.Logger;

import org.ccil.cowan.tagsoup.Parser;
import org.xml.sax.Attributes;
import org.xml.sax.ContentHandler;
import org.xml.sax.InputSource;
import org.xml.sax.Locator;
import org.xml.sax.SAXException;
import org.xml.sax.XMLReader;

/**
 * Take HTML and give back the text part while dropping the HTML tags.
 *
 * There is some risk that using TagSoup means we'll permute non-HTML text.
 * However, it seems to work the best so far in test cases.
 *
 * @author dan
 * @see <a href="http://home.ccil.org/~cowan/XML/tagsoup/">TagSoup</a> 
 */
public class Html2Text2 implements ContentHandler {
private StringBuffer sb;

public Html2Text2() {
}

public void parse(String str) throws IOException, SAXException {
    XMLReader reader = new Parser();
    reader.setContentHandler(this);
    sb = new StringBuffer();
    reader.parse(new InputSource(new StringReader(str)));
}

public String getText() {
    return sb.toString();
}

@Override
public void characters(char[] ch, int start, int length)
    throws SAXException {
    for (int idx = 0; idx < length; idx++) {
    sb.append(ch[idx+start]);
    }
}

@Override
public void ignorableWhitespace(char[] ch, int start, int length)
    throws SAXException {
    sb.append(ch);
}

// The methods below do not contribute to the text
@Override
public void endDocument() throws SAXException {
}

@Override
public void endElement(String uri, String localName, String qName)
    throws SAXException {
}

@Override
public void endPrefixMapping(String prefix) throws SAXException {
}

@Override
public void processingInstruction(String target, String data)
    throws SAXException {
}

@Override
public void setDocumentLocator(Locator locator) {
}

@Override
public void skippedEntity(String name) throws SAXException {
}

@Override
public void startDocument() throws SAXException {
}

@Override
public void startElement(String uri, String localName, String qName,
    Attributes atts) throws SAXException {
}

@Override
public void startPrefixMapping(String prefix, String uri)
    throws SAXException {
}
} 
```

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2011-06-07T14:13:22.583

我知道这很旧，但我只是在做一个需要我过滤 HTML 的项目，而且效果很好：

```
noHTMLString.replaceAll("\\&.*?\\;", ""); 
```

而不是这个：

```
html = html.replaceAll("&nbsp;","");
html = html.replaceAll("&amp;".""); 
```

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2018-06-20T07:36:44.627

这是如何替换所有内容的另一种变体（HTML 标签 | HTML 实体 | HTML 内容中的空白空间）

`content.replaceAll("(<.*?>)|(&.*?;)|([ ]{2,})", "");`其中内容是一个字符串。

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2009-01-18T02:16:17.447

听起来您想从 HTML 转换为纯文本。
如果是这种情况，请查看 www.htmlparser.org。这是一个从 URL 中找到的 html 文件中去除所有标签的示例。
它使用*org.htmlparser.beans.StringBean*。

```
static public String getUrlContentsAsText(String url) {
    String content = "";
    StringBean stringBean = new StringBean();
    stringBean.setURL(url);
    content = stringBean.getStrings();
    return content;
} 
```

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2011-10-16T11:37:58.513

这是另一种方法：

```
public static String removeHTML(String input) {
    int i = 0;
    String[] str = input.split("");

    String s = "";
    boolean inTag = false;

    for (i = input.indexOf("<"); i < input.indexOf(">"); i++) {
        inTag = true;
    }
    if (!inTag) {
        for (i = 0; i < str.length; i++) {
            s = s + str[i];
        }
    }
    return s;
} 
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2012-09-04T08:42:58.800

也可以为此目的使用[Apache Tika 。](http://tika.apache.org/)默认情况下，它会保留剥离 html 中的空格，这在某些情况下可能需要：

```
InputStream htmlInputStream = ..
HtmlParser htmlParser = new HtmlParser();
HtmlContentHandler htmlContentHandler = new HtmlContentHandler();
htmlParser.parse(htmlInputStream, htmlContentHandler, new Metadata())
System.out.println(htmlContentHandler.getBodyText().trim()) 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2015-09-04T20:53:40.770

使用 JSoup 保留换行信息的一种方法是在所有新行标记之前添加一些虚拟字符串，执行 JSoup 并用“\n”替换虚拟字符串。

```
String html = "<p>Line one</p><p>Line two</p>Line three<br/>etc.";
String NEW_LINE_MARK = "NEWLINESTART1234567890NEWLINEEND";
for (String tag: new String[]{"</p>","<br/>","</h1>","</h2>","</h3>","</h4>","</h5>","</h6>","</li>"}) {
    html = html.replace(tag, NEW_LINE_MARK+tag);
}

String text = Jsoup.parse(html).text();

text = text.replace(NEW_LINE_MARK + " ", "\n\n");
text = text.replace(NEW_LINE_MARK, "\n\n"); 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2018-01-26T12:27:26.690

```
classeString.replaceAll("\\<(/?[^\\>]+)\\>", "\\ ").replaceAll("\\s+", " ").trim() 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2020-09-10T14:36:16.177

**试试这个javascript：**

```
const strippedString = htmlString.replace(/(<([^>]+)>)/gi, "");
console.log(strippedString); 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2011-08-09T14:40:15.407

我的 5 美分：

```
String[] temp = yourString.split("&amp;");
String tmp = "";
if (temp.length > 1) {

    for (int i = 0; i < temp.length; i++) {
        tmp += temp[i] + "&";
    }
    yourString = tmp.substring(0, tmp.length() - 1);
} 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2013-04-25T16:57:13.947

要获得**格式化的纯 html 文本**，您可以这样做：

```
String BR_ESCAPED = "&lt;br/&gt;";
Element el=Jsoup.parse(html).select("body");
el.select("br").append(BR_ESCAPED);
el.select("p").append(BR_ESCAPED+BR_ESCAPED);
el.select("h1").append(BR_ESCAPED+BR_ESCAPED);
el.select("h2").append(BR_ESCAPED+BR_ESCAPED);
el.select("h3").append(BR_ESCAPED+BR_ESCAPED);
el.select("h4").append(BR_ESCAPED+BR_ESCAPED);
el.select("h5").append(BR_ESCAPED+BR_ESCAPED);
String nodeValue=el.text();
nodeValue=nodeValue.replaceAll(BR_ESCAPED, "<br/>");
nodeValue=nodeValue.replaceAll("(\\s*<br[^>]*>){3,}", "<br/><br/>"); 
```

要获得**格式化的纯文本**，通过 \n 更改 <br/> 并通过以下方式更改最后一行：

```
nodeValue=nodeValue.replaceAll("(\\s*\n){3,}", "<br/><br/>"); 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2020-05-25T11:14:50.933

我知道这个问题被问到已经有一段时间了，但我找到了另一个解决方案，这对我有用：

```
Pattern REMOVE_TAGS = Pattern.compile("<.+?>");
    Source source= new Source(htmlAsString);
 Matcher m = REMOVE_TAGS.matcher(sourceStep.getTextExtractor().toString());
                        String clearedHtml= m.replaceAll(""); 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2020-07-15T17:53:29.950

值得注意的是，如果您尝试在[服务堆栈](https://servicestack.net/)项目中完成此操作，它已经是一个内置的字符串扩展

```
using ServiceStack.Text;
// ...
"The <b>quick</b> brown <p> fox </p> jumps over the lazy dog".StripHtml(); 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2020-08-23T21:14:52.193

我经常发现我只需要去掉注释和脚本元素。这对我来说已经可靠工作了 15 年，并且可以轻松扩展以处理 HTML 或 XML 中的任何元素名称：

```
// delete all comments
response = response.replaceAll("<!--[^>]*-->", "");
// delete all script elements
response = response.replaceAll("<(script|SCRIPT)[^+]*?>[^>]*?<(/script|SCRIPT)>", ""); 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2020-09-03T09:03:15.107

有时 html 字符串来自带有这样的 .xml 的 xml `&lt`。使用 Jsoup 时，我们需要对其进行解析，然后对其进行清理。

```
Document doc = Jsoup.parse(htmlstrl);
Whitelist wl = Whitelist.none();
String plain = Jsoup.clean(doc.text(), wl); 
```

虽然只使用`Jsoup.parse(htmlstrl).text()`不能删除标签。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2021-03-01T15:44:46.343

您可以使用此方法从字符串中删除 HTML 标签，

```
public static String stripHtmlTags(String html) {

    return html.replaceAll("<.*?>", "");

} 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2021-09-06T11:00:27.260

您可以使用此代码删除 HTML 标记，包括换行符。

```
function remove_html_tags(html) {
    html = html.replace(/<div>/g, "").replace(/<\/div>/g, "<br>");
    html = html.replace(/<br>/g, "$br$");
    html = html.replace(/(?:\r\n|\r|\n)/g, '$br$');
    var tmp = document.createElement("DIV");
    tmp.innerHTML = html;
    html = tmp.textContent || tmp.innerText;
    html = html.replace(/\$br\$/g, "\n");
    return html;
} 
```

* * *

## 回答 #34

> 赞同：-1
> 
> 时间：2010-11-17T01:44:07.917

您可以简单地使用多个 replaceAll() 来创建一个方法，例如

```
String RemoveTag(String html){
   html = html.replaceAll("\\<.*?>","")
   html = html.replaceAll("&nbsp;","");
   html = html.replaceAll("&amp;"."");
   ----------
   ----------
   return html;
} 
```

使用此链接获取您需要的最常见替换：http: [//tunes.org/wiki/html_20special_20characters_20and_20symbols.html](http://tunes.org/wiki/html_20special_20characters_20and_20symbols.html)

它简单但有效。我首先使用此方法删除垃圾但不是第一行即replaceAll("\<.*?>","")，然后我使用特定关键字搜索索引然后使用.substring(start, end ) 方法去除不必要的东西。因为这更健壮，您可以在整个 html 页面中准确指出您需要的内容。

* * *

## 回答 #35

> 赞同：-1
> 
> 时间：2014-09-03T16:02:18.667

从字符串中删除 HTML 标签。在某个地方，我们需要解析一些字符串，这些字符串是由服务器的 Httpresponse 等响应接收到的。

所以我们需要解析它。

在这里，我将展示如何从字符串中删除 html 标签。

```
 // sample text with tags

    string str = "<html><head>sdfkashf sdf</head><body>sdfasdf</body></html>";

    // regex which match tags

    System.Text.RegularExpressions.Regex rx = new System.Text.RegularExpressions.Regex("<[^>]*>");

    // replace all matches with empty strin

    str = rx.Replace(str, "");

    //now str contains string without html tags 
```

# visual-studio-2008 - Visual Studio 2008 是否支持经典 ASP 开发？

> ID：240552
> 
> 赞同：9
> 
> 时间：2008-10-27T16:40:27.200
> 
> 标签：visual-studio-2008, asp-classic

Visual Studio 2008 是否支持经典的 asp 开发？

自从我创建一个经典的 ASP 网站以来已经有好几年了，我想知道我是否可以使用我当前的工具集，或者我是否必须将自己交给记事本。

谢谢

马特

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-27T16:43:59.173

我知道 VS 2008 现在包括经典 ASP 的 Intellisense 和调试功能，所以这让我觉得是的。

确保您获得了 Service Pack 1 版本。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-27T16:44:37.177

是的，VS 2008 SP1 确实支持 ASP。您需要 SP1，因为他们删除了一些智能感知，但将其添加回 SP1

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-07-09T02:26:04.263

在可能相关的旁注中，Visual Studio 2010 还支持经典 asp

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-03T00:18:06.397

是的，正如其他人所提到的，VS 2008 SP1 支持经典 ASP。

但是，如果像我一样，您发现它对于相对简单的经典 ASP 来说有点庞然大物，请 尝试使用[Notepad++](http://notepad-plus.sourceforge.net/uk/site.htm) - 无需将自己交给普通的旧记事本！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-27T15:02:08.967

这是在 Visual Studio 2008 中设置经典 ASP 站点的一个很好的参考：

[http://www.codeproject.com/KB/debug/DebugVBScriptVS2008.aspx](http://www.codeproject.com/KB/debug/DebugVBScriptVS2008.aspx)

此外，我必须让“所有人”访问我在本地计算机中设置的 IIS 中的虚拟目录，以便它正确运行：

[http://answers.google.com/answers/threadview?id=181211](http://answers.google.com/answers/threadview?id=181211)

# rd - 研发公司摆脱纯“D”模式的最佳途径？

> ID：240567
> 
> 赞同：3
> 
> 时间：2008-10-27T16:44:09.487
> 
> 标签：rd

我在一家能源行业的研发公司工作。我们已经开发了一些成功的产品，但现在似乎把所有的时间都花在了解决与这些产品相关的问题上。我们似乎没有任何时间来开发新产品。有没有人对如何处理现有产品出现的问题有任何好的想法，但仍然有时间和资源来开发新产品？

泰，弗雷德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T16:55:01.460

如果您有一个成功的产品，并且配备了负责开发或维护的人员，那么解决方案似乎指向招聘。

也许会引进一些新的血液/新鲜的毕业生来“培养”他们进入研发公司更关键的任务方面？因此，新血液将获得现有产品的经验（在更高级人员的指导下），并成长为研发方面的优秀开发人员！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T16:53:16.660

我建议最好的方法是让一个团队/人致力于新的发展。他们应该可以回答问题，但是……唯一的问题可能是一些嫉妒，但是一个好的经理应该能够弄清楚如何处理它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T19:32:25.420

为什么现有产品需要全部人力？

完成后人员是否减少？- 雇用新人

产品 - 嗯 - 非常有缺陷吗？- 修复您的流程，并首先修复您的错误（对不起）

您是否开发了许多产品，越来越多的时间进入维护，现在没有开发？- 取消对旧产品的支持，雇佣新人，或让客户为维护支付高昂的费用（即让*他们*取消支持）

您是否正在疯狂地为产品添加新功能？- 对不起，你在做新的东西。新功能需要平衡

公司是否**需要**更多的“R”？许多研发公司最终选择了 M&F - 维护和功能。其他人开心吗？如果是这样，也许您需要寻找更适合您的职位。

我不确定你的职位——你是在做内部开发，还是你的公司在销售软件？无论如何，必须有一些新的发展空间，才能保持健康。向你的管理层明确表示，如果工作纯粹是维护，最好的人会离开。

不过，不要期望太多 - 特别是如果您正在进行内部开发。估计80%的职位都是维修（希望能找到参考）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-27T16:45:16.287

“时间管理”

尝试[*完成*](http://www.amazon.com/s/ref=nb_ss_gw_0_19?url=search-alias%3Dstripbooks&field-keywords=getting+things+done+david+allen&sprefix=getting+things+done)大卫艾伦的工作

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-27T16:56:37.403

让管理层提出需要完成的修复列表。

工程部为每个修复分配了一个估计的小时数。

决定哪些修复进入，哪些被推出。有些可能在文档中“修复”（解决方法、已知问题等）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-27T17:03:20.807

如果您负担得起，请雇用人员来处理支持和维护，以腾出资源进行研究。

如果不能，则需要降低每位客户的边际成本。跟踪所有体力劳动和支持请求，并优先考虑将这些减少到最低限度的新功能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-27T17:33:38.857

Be very careful of this. I've seen a few companies do this where the support of the active products (the ones making money) became secondary. The "Support" function is minimized because support income counts against you in an IPO situation.

The next thing you know, your company isn't making any money, the support staff that are trying to make a little are treated like crap (and fired when the money runs out), and the "New product" team isn't required to release anything (no customer demand) so they succumb to feature-creep and multi-year long release dates.

This leads to a refocus where 2/3 of the companies staff is cut and the remainder all work on support and a token few on the "Next generation" that's always around the corner--which works until the bank calls in the loan for the money you borrowed to hire the marketing people before you even had a "new" product to market.

It doesn't have to happen this way--just be careful.

# sql - 你如何 OR 两个 LIKE 语句？

> ID：240582
> 
> 赞同：48
> 
> 时间：2008-10-27T16:47:25.190
> 
> 标签：sql, mysql

我尝试了以下两种说法：

*   `SELECT col FROM db.tbl WHERE col (LIKE 'str1' OR LIKE 'str2') AND col2 = num`导致语法错误
*   `SELECT col FROM db.tbl WHERE page LIKE ('str1' OR 'str2') AND col2 = num`对于每个结果，都会导致“截断不正确的 DOUBLE 值：str1”和“截断不正确的 DOUBLE 值：str2”。但是，实际上没有返回任何结果。

我认为这两种说法中的一种会起作用，但事实并非如此。

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2008-10-27T16:48:39.837

> ```
> SELECT col FROM db.tbl WHERE (col LIKE 'str1' OR col LIKE 'str2') AND col2 = num 
> ```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-27T16:49:34.890

我相信你需要`WHERE ((page LIKE 'str1') OR (page LIKE 'str2'))`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-27T16:49:19.600

简单的想：

```
SELECT col FROM db.tbl WHERE (col LIKE 'str1' OR col LIKE 'str2') AND col2 = ... 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-27T16:55:42.350

“OR”运算符适用于表达式。"LIKE 'str1'" 和 "LIKE 'str2'" 不是有效的表达式，因为 "LIKE" 运算符需要左侧和右侧。

```
page LIKE ('str1' OR 'str2') 
```

将首先尝试将“str1”和“str2”进行或运算，得到值 TRUE。然后它会尝试评估`page LIKE TRUE`，并报告错误。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-12-19T10:23:46.733

USE`%`在字符串的开头和结尾。这样它也会检查子字符串

```
SELECT col FROM db.tbl WHERE (col LIKE '%str1%' OR col LIKE '%str2%') AND col2 = num 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-27T16:49:10.320

尝试 SELECT col FROM db.tbl WHERE (col LIKE 'str1' or col LIKE 'str2') AND col2 = num

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-03-07T04:49:00.840

我假设你想要的是，

```
SELECT col FROM db.tbl WHERE col LIKE '%str[12]%' AND col2 = num 
```

这将真正找到所有情况，其中 (col like %str1% or col like %str2%) AND col2 = num

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-07-10T12:15:16.900

在最新版本的 SQL 中，您可以使用`IN`运算符：

```
SELECT col FROM db.tbl WHERE col IN('str1','str2') AND col2 = num 
```

# javascript - 是否可以在 JavaScript 中监听对象属性的变化？

> ID：240592
> 
> 赞同：23
> 
> 时间：2008-10-27T16:49:47.527
> 
> 标签：javascript, dom-events

我正在开发一个主要使用 JavaScript 构建的繁琐的 Web 界面。它基本上是一种（非常）大的形式，有很多部分。每个部分都是根据表单其他部分的选项构建的。每当这些选项更改时，新值都会记录在“注册表”类型对象中，并且其他部分会相应地重新填充。

在许多表单字段上设置事件侦听器开始减慢速度，并且为每次更改刷新整个表单对于用户来说太重/太慢了。

我想知道是否可以将侦听器添加到注册表对象的属性而不是表单元素以加快速度？而且，如果是这样，您能否提供/指向我一些示例代码？

更多的信息：

*   这是一个 jQuery 插件，所以我可以从该库构建的任何功能都会有所帮助，但不是必需的。
*   我们的用户正在使用 IE6/7、Safari 和 FF2/3，所以如果可能但仅限于“现代”浏览器，我将不得不寻找不同的解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-27T17:18:42.037

据我所知，没有在 Object 属性更改时触发任何事件（编辑：显然除了 for `Object.watch`）。

为什么不尽可能使用事件委托？也就是说，表单上的事件而不是单个表单元素上的事件，在它们冒泡时捕获事件？

例如（我的 jQuery 生锈了，请原谅我使用 Prototype 代替，但我相信你将能够轻松地适应它）：

```
$(form).observe('change', function(e) {
    // To identify changed field, in Proto use e.element()
    // but I think in jQuery it's e.target (as it should be)
}); 
```

如果您希望在文本字段失去焦点之前触发它，您还可以捕获`input`和`keyup`和事件。`paste`我的解决方案通常是：

1.  **基于 Gecko/Webkit 的浏览器**：观察`input`.`form`
2.  **同样在基于 Webkit 的浏览器中：**在 s 上观察`keyup`和`paste`事件（由于某种原因，`textarea`它们不会`input`在s 上触发）。`textarea`
3.  **IE：**观察`keyup`并`paste`在`form`
4.  观察（这在 s`change`上`form`触发`select`）。
5.  对于`keyup`和事件，通过将文本字段与其`paste`默认值进行比较，将字段的当前值与其默认值（页面加载时的值）进行比较`value``defaultValue`

编辑：这是我为防止未修改的表单提交等而开发的示例代码：

[通过javascript跟踪表单更改的最佳方法是什么？](https://stackoverflow.com/questions/194101/what-is-the-best-way-to-track-changes-in-a-form-via-javascript#194347)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-28T10:56:08.720

感谢您的评论。我已经完成了以下操作：

```
var EntriesRegistry = (function(){

    var instance = null;

    function __constructor() {

        var
            self = this,
            observations = {};

        this.set = function(n,v)
        {
            self[n] = v;

            if( observations[n] )
                for( var i=0; i < observations[n].length; i++ )
                    observations[n][i].apply(null, [v, n]);

        }

        this.get = function(n)
        {
            return self[n];
        }

        this.observe = function(n,f)
        {

            if(observations[n] == undefined)
                observations[n] = [];

            observations[n].push(f);
        }

    }

    return new function(){
        this.getInstance = function(){
            if (instance == null)
            {
                instance = new __constructor();
                instance.constructor = null;
            }
            return instance;
        }
    }
})();

var entries = EntriesRegistry.getInstance();

var test = function(v){ alert(v); };

entries.set('bob', 'meh');

entries.get('bob');

entries.observe('seth', test);

entries.set('seth', 'dave'); 
```

考虑到您的意见，我将在表单对象上使用事件委托来更新注册表并触发注册的观察方法。

到目前为止，这对我来说效果很好......你们能看到这有什么问题吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-27T17:10:35.860

您可以将侦听器附加到容器（主体或表单），然后使用事件参数对更改做出反应。你得到了所有监听器的好处，但只需要为容器附加一个，而不是为每个元素附加一个。

```
$('body').change(function(event){
    /* do whatever you want with event.target here */
    console.debug(event.target); /* assuming firebug */
 }); 
```

event.target 保存被点击的元素。

[SitePoint](http://www.sitepoint.com/blogs/2008/07/23/javascript-event-delegation-is-easier-than-you-think/)对事件委托有一个很好的解释：

> JavaScript 事件委托是一种简单的技术，通过它您可以将单个事件处理程序添加到父元素，以避免必须将事件处理程序添加到多个子元素。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-27T17:16:44.820

Mozilla 引擎浏览器支持[Object.watch](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Object/watch)，但我不知道跨浏览器兼容的等价物。

您是否使用 Firebug 对页面进行了概要分析以了解导致缓慢的确切原因，或者“大量事件处理程序”是一种猜测？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-09-01T16:10:00.153

对上一个答案的小修改：通过将可观察代码移动到一个对象，可以对其进行抽象，并使用它通过 jQuery 的 extend 方法扩展其他对象。

```
ObservableProperties = {
    events : {},
    on : function(type, f)
    {
        if(!this.events[type]) this.events[type] = [];
        this.events[type].push({
            action: f,
            type: type,
            target: this
        });
    },
    trigger : function(type)
    {
        if (this.events[type]!==undefined)
        {
            for(var e = 0, imax = this.events[type].length ; e < imax ; ++e)
            {
                this.events[type][e].action(this.events[type][e]);
            }
        }
    },
    removeEventListener : function(type, f)
    {
        if(this.events[type])
        {
            for(var e = 0, imax = this.events[type].length ; e < imax ; ++e)
            {
                if(this.events[type][e].action == f)
                    this.events[type].splice(e, 1);
            }
        }
    }
};
Object.freeze(ObservableProperties);

var SomeBusinessObject = function (){
    self = $.extend(true,{},ObservableProperties);
    self.someAttr = 1000
    self.someMethod = function(){
        // some code
    }
    return self;
} 
```

见小提琴：[https ://jsfiddle.net/v2mcwpw7/3/](https://jsfiddle.net/v2mcwpw7/3/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-27T17:25:51.540

jQuery 真是太棒了。虽然你可以看看 ASP.NET AJAX Preview。

有些功能只是 .js 文件，与 .NET 没有依赖关系。可能你会发现观察者模式实现很有用。

```
var o = { foo: "Change this string" };

Sys.Observer.observe(o);

o.add_propertyChanged(function(sender, args) {
    var name = args.get_propertyName();
    alert("Property '" + name + "' was changed to '" + sender[name] + "'.");
});

o.setValue("foo", "New string value."); 
```

此外，客户端模板已准备好用于一些有趣的场景。

最后一点，这与 jQuery 完全兼容（$ 没有问题）

链接：[首页](http://www.codeplex.com/aspnet/Wiki/View.aspx?title=AJAX)，[我目前使用的版本](http://www.codeplex.com/aspnet/Release/ProjectReleases.aspx?ReleaseId=14924)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-28T20:19:52.877

我正在寻找同样的东西并遇到了你的问题......没有一个答案能满足我的需求，所以我想出了这个我想分享的解决方案：

```
var ObservedObject = function(){
    this.customAttribute = 0
    this.events = {}
    // your code...
}
ObservedObject.prototype.changeAttribute = function(v){
     this.customAttribute = v
     // your code...
     this.dispatchEvent('myEvent')
}
ObservedObject.prototype.addEventListener = function(type, f){
    if(!this.events[type]) this.events[type] = []
    this.events[type].push({
        action: f,
        type: type,
        target: this
    })
}
ObservedObject.prototype.dispatchEvent = function(type){
    for(var e = 0; e < this.events[type].length; ++e){
        this.events[type][e].action(this.events[type][e])
    }
}
ObservedObject.prototype.removeEventListener = function(type, f){
    if(this.events[type]) {
        for(var e = 0; e < this.events[type].length; ++e){
            if(this.events[type][e].action == f)
                this.events[type].splice(e, 1)
        }
    }
}

var myObj = new ObservedObject()

myObj.addEventListener('myEvent', function(e){// your code...}) 
```

它是 DOM 事件 API 的简化版，运行良好！这是一个更完整的[例子](http://jsfiddle.net/nNfFv/)

# sql-server - 如何自定义 sql server 代理作业

> ID：240619
> 
> 赞同：1
> 
> 时间：2008-10-27T16:56:49.850
> 
> 标签：sql-server, sql-server-2005, scheduled-tasks, sql-server-agent

我需要能够在每个月的 10 日安排一项工作，并让它运行一定天数或直到指定日期。

有没有办法使用某种 API 或其他东西来自定义 sql server 代理作业？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-28T00:52:41.403

您可以通过为作业使用多个计划来完成使用 SQL 作业计划属性。您可以安排作业在该月的第 10 天运行（可选择结束日期）。然后，您可以创建多个时间表，一个用于 11 日、12 日等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T23:05:54.223

SQL Server 代理没有您需要的计划选项，因此我认为您的解决方法与将其保留在 SQL Server 中一样好。

但是，Windows 任务计划程序确实可以选择在每月的“x”日运行作业，也许通过 Windows 任务计划程序使用 sqlcmd 启动您的 sproc 是另一种解决方案？

希望这可以帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T17:16:43.213

我仍然找不到任何自定义作业计划的方法，但我已经通过将条件添加到作业步骤来解决它：

> IF (DAY(GetDate()) >= 10)
> 执行 MySP

并设置每天运行的时间表。

# c# - 在 IIS7 或 Windows 服务中使用 WPF？

> ID：240621
> 
> 赞同：1
> 
> 时间：2008-10-27T16:58:20.817
> 
> 标签：c#, asp.net, wpf, iis-7

目前，我们使用 .Net 中的 GDI+ 类在 ASP.NET 中生成大量或动态的 png 图像，没有出现重大问题。我曾希望在我们的 ASP.NET 应用程序中利用 WPF 中的许多新绘图、FormattedText、RenderTargetBitmap、优化算法等，但显然这不受支持，并且在 .Net 3.5sp1 ( [WPF不再在 IIS](http://www.ktsc.com/blogs/ChristopherKeslin/?p=12)和[connect.microsoft.com](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=361469)下运行）。我们正在运行 Server 2008 x64。

我知道 ASP.NET 应用程序不支持“技术上”的 GDI+，但它确实有效，甚至还有基于它构建的商业产品。

所以我的问题是，是否有人在 ASP.NET 或 Windows 服务应用程序中成功使用 WPF？有没有人有任何建议的解决方法或替代方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T12:17:42.143

显然微软正在努力修复：

[http://forums.asp.net/t/1299963.aspx](http://forums.asp.net/t/1299963.aspx)

多久才能准备好？......不知道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-27T17:34:29.137

我不确定，我认为应该有可能。我知道您可以使用 WindowInteropHelper 类来获取 WPF 窗口的句柄。其余的应该和你想的差不多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T12:55:52.740

我曾与一家在 IIS 托管渲染器中使用 WPF 的公司合作，尽管您必须安装 Microsoft 的修补程序。我的理解是这个修补程序不是公开可用的，但很可能会在 12 月发布。

# django - 如何自定义 django 管理员更改页面以在“保存”时返回特定 URL

> ID：240631
> 
> 赞同：6
> 
> 时间：2008-10-27T17:01:27.097
> 
> 标签：django

我想使用 django contrib.admin 页面来编辑我的模型，但是从我自己的视图中调用单独的更改页面，然后在用户单击“保存”后返回那里。

理想情况下，这应该通过将返回 URL 附加到管理页面的 url 来实现（如 "...?_return_url=)

有什么提示吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-27T17:24:16.597

`django.contrib.admin.options.ModelAdmin`对象有一个[`response_change`](https://github.com/django/django/blob/master/django/contrib/admin/options.py#L1084)方法，您可以在子类中覆盖该方法以确定成功保存对象后应返回的响应 - 您可以覆盖此方法以返回适合`HttpResponseRedirect`刚刚保存的对象的响应。

# c# - 我应该从哪个版本的 C#（和 .Net）开始？

> ID：240638
> 
> 赞同：4
> 
> 时间：2008-10-27T17:04:53.330
> 
> 标签：c#

我试图让自己跟上 C# 的速度，以前从未开发过它。在之前的问题中，我询问了关于好的书评网站，通过这个问题，我发现了对“Essential C#”的非常积极的（面向初学者的）评论，但它是针对以前的版本的。

虽然我确信即使版本之间质量下降，它仍然是一本好书，但它对我提出了一个有趣的问题：

开始一门新语言时，最好从最新版本开始（例如 C# 3.0/.Net 3.5）还是我应该回到一两个版本并尝试学习之后添加到该语言中的内容？

从立即更新的角度来看，前者似乎更好，但后者似乎更务实，因为商店可能更有可能使用稍旧版本的语言。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-27T17:08:26.957

我建议你用最新的开始一个项目。您不一定需要学习所有最新的增强功能，但当您准备好时，它们将随时可供您使用。

3.5 实际上是 2.0 框架，有“添加”。

此外，如果您正在实际处理示例，它们*应该*是最新的。然后，当您感到舒适时，您可以寻找使用最新版本来增强的区域。EG 也许可以增强带有嵌套 IF 的循环以使用 LINQ。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-27T17:07:57.147

从最新开始。如果您需要使用基于先前版本构建的代码，那么您可以了解版本 X 和版本 Y 之间的区别。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-27T17:08:29.517

.NET 框架 3.0 和 3.5 是基于 2.0 的，所以我会说你最好专注于 2.0 的功能，然后在你去的时候添加 3.0 和 3.5 的东西。

只需确保避免 2.0 之前的任何内容，因为它们破坏了与 2.0 版本的向后兼容性。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-27T17:09:26.363

从最新开始。

后期版本中有一些 1.0 中没有的好东西。您不想养成使用最新版本中修复的变通办法的“坏”习惯。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-27T17:35:00.087

学习最新的——但要确保你在 C# 1 和 2 的语言特性上坚如磐石，而不是仅仅从 C# 3 中学习很酷的东西。除此之外，你仍然会直接看到 C# 1许多维护工作。

值得了解的是如何实现不同的特性 - 在 C# 2 中，可空类型和泛型需要 CLR 更改，但其余的（迭代器块、匿名方法、部分类型等）只是编译器的魔法。在 C# 3 中，这都是编译器的魔力（具有对 LINQ 等的框架支持）。您应该真正了解 CLR 术语的基础知识（什么是结构？什么是类？），[通过 C# 的 CLR](https://rads.stackoverflow.com/amzn/click/com/0735621632)是学习这一点的好方法。在过多担心 ASP.NET、WinForms、WPF 等之前，先专注于核心技术（System.* 类型、IO、集合等）。我会将 LINQ to Objects 作为“核心”API，但不包括 LINQ to SQL，例如。

在某些时候，我的阅读清单上有 Essential C#（出于复习目的）——我快速浏览了它提供的内容，它看起来扎实而透彻。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-27T17:09:01.357

使用 .NET 3.5 和 C# 3.0。否则只会让你落后。此外，不同版本的核心设施是相同的。但是，例如，当您准备好使用 LINQ 时，它就为您准备好了！

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-27T17:09:07.830

我会通过问你一个问题来回答你的问题。

您愿意在使用最新版本 C#/.Net 的企业还是使用旧版本的企业工作？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-27T17:09:39.560

为了解决您的采用问题，由于从 2.0 版过渡到 3.5 版对于许多软件商店来说并不是非常痛苦，我会继续从 3.5 开始。您将隐含地了解 2.0，尽管可能某些习语会发生变化。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-27T17:12:53.110

学习最新的，绝对。例如，为什么您要养成使用前通用 C# 容器的习惯，然后又不得不忘记它？当你在旧代码中遇到旧的东西时，请阅读它。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-27T17:11:22.600

如果您从事自由合同工作，我认为学习旧的东西会更好。您将要接触的代码必须是旧的。如果您受雇并且必须使用该语言来开发新应用程序，或者您只是为了好玩而这样做，那么我会选择最新最好的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-27T17:13:40.333

你可能想看看这个[问题和答案](https://stackoverflow.com/questions/237908/differences-between-net-versions-predominantly-c#237910)

# java - 正则表达式查找静态（非最终）变量

> ID：240648
> 
> 赞同：7
> 
> 时间：2008-10-27T17:08:24.353
> 
> 标签：java, regex, eclipse

我正在尝试在我的 Eclipse (Java) 工作区中进行搜索，以查找非最终静态变量的所有实例。

我尝试了各种正则表达式，但它们没有产生任何匹配。有人可以建议一个正则表达式来匹配所有包含`static`和不包含`final`，并且不以 a 结尾的行`{`吗？

关于不以 a 结尾的最后一部分`{`将消除静态方法。

一个例子：

```
public class FlagOffendingStatics {
  private static String shouldBeFlagged = "not ok";
  private static final String ok = "this is fine";
  public static void methodsAreOK() {

  }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-27T17:58:16.980

这种模式有效：

```
[^(final)] static [^(final)][^(\})]*$ 
```

这是一个测试：

```
$ cat test.txt
private int x = "3";
private static x = "3";
private final static String x = "3";
private static final String x = "3";
private static String x = "3";
public static void main(String args[]) {
        blah;
}

$ grep "[^(final)] static [^(final)][^(\})]*$" test.txt
private static x = "3";
private static String x = "3"; 
```

（我意识到这`private static x = "3";`不是有效的语法，但模式仍然可以。）

`final`该模式解释了可以出现在 之前或之后`static`的事实`[^(final)] static [^(final)]`。模式的其余部分 ,`[^(\})]*$`旨在防止任何`{`字符出现在该行的其余部分。

但是，如果有人喜欢这样编写他们的方法语句，则此模式将不起作用：

```
private static void blah()
{
     //hi!
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-27T17:15:59.563

Eclipse 应该有某种内置的 Java 搜索功能，您可以在其中指定... 否则，不要编写一个庞大的怪物正则表达式，而是尝试将一堆 grep 链接在一起：

`grep -r static . | grep -v final`

在第一条语句中， -r 使 grep 在从本地目录开始的目录树上递归，结果通过管道传送到第二个 grep，该 grep 删除了所有 `final`'s。继续添加 -v 直到从结果中删除所有多余的内容。这通常比找出一个复杂的正则表达式来处理所有事情更容易——尽管不那么优雅。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-27T20:46:15.800

我不会检查是否缺少大括号，而是会在末尾查找分号：

```
^(?![ \t]*import\b)(?!.*\bfinal\b).*\bstatic\b.*;[ \t]*$ 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-05-30T15:49:50.947

来自@matt-b 的改进模式

```
[^(final|import)] static [^(final|class|{|enum)][^(\})]*$ 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-27T17:55:00.203

[FindBugs](http://findbugs.sourceforge.net/)将为您找到静态的非最终变量。（以及许多其他有趣的事情。）使用独立版本我取得了很好的效果。还有一个 Eclipse 插件，但我没用过。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-27T18:24:56.320

IntelliJ 代码检查之一已经这样做了。如果需要，您实际上可以单独运行代码检查器并让它生成报告（对于夜间构建很有用）。

正如之前的海报所说，Find Bugs 会这样做，我想其他代码检查工具也会这样做。您可能最好集成其中一个更完整的代码检查工具，而不是仅针对这一件事的一次性脚本。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-19T04:02:28.653

这不是一个正则表达式，但这里有一个名为 checkstyle 的插件，它会为你做这件事，以及许多其他的源代码检查。它甚至可以自动修复许多它发现的问题。

[http://eclipse-cs.sourceforge.net/update/](http://eclipse-cs.sourceforge.net/update/)

# python - m2m 字段上的 post_save 信号

> ID：240659
> 
> 赞同：6
> 
> 时间：2008-10-27T17:09:41.323
> 
> 标签：python, django, django-signals

我有一个非常通用的文章模型，与标签模型有 m2m 关系。我想记录每个标签的使用情况，我认为最好的方法是对标签模型上的计数字段进行非规范化，并在每次保存文章时更新它。我怎样才能做到这一点，或者也许有更好的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-04-28T20:10:44.940

这是 Django 1.2 中的一个新功能：http: [//docs.djangoproject.com/en/dev/ref/signals/#m2m-changed](http://docs.djangoproject.com/en/dev/ref/signals/#m2m-changed)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-27T21:17:58.873

您可以通过为 M2M 关系创建[中间模型](http://docs.djangoproject.com/en/dev/topics/db/models/#extra-fields-on-many-to-many-relationships)并将其用作`post_save`和`post_delete`信号的挂钩来更新表中的非规范化列`Article`。

例如，我对[soclone](http://code.google.com/p/soclone/)`Question`中的收藏计数执行此操作，其中s 与 s 具有 M2M 关系：`User``Question`

```
from django.contrib.auth.models import User
from django.db import connection, models, transaction
from django.db.models.signals import post_delete, post_save

class Question(models.Model):
    # ...
    favourite_count = models.PositiveIntegerField(default=0)

class FavouriteQuestion(models.Model):
    question = models.ForeignKey(Question)
    user     = models.ForeignKey(User)

def update_question_favourite_count(instance, **kwargs):
    """
    Updates the favourite count for the Question related to the given
    FavouriteQuestion.
    """
    if kwargs.get('raw', False):
        return
    cursor = connection.cursor()
    cursor.execute(
        'UPDATE soclone_question SET favourite_count = ('
            'SELECT COUNT(*) from soclone_favouritequestion '
            'WHERE soclone_favouritequestion.question_id = soclone_question.id'
        ') '
        'WHERE id = %s', [instance.question_id])
    transaction.commit_unless_managed()

post_save.connect(update_question_favourite_count, sender=FavouriteQuestion)
post_delete.connect(update_question_favourite_count, sender=FavouriteQuestion)

# Very, very naughty
User.add_to_class('favourite_questions',
                  models.ManyToManyField(Question, through=FavouriteQuestion,
                                         related_name='favourited_by')) 
```

在 django-developers 邮件列表上进行了一些讨论，讨论了实现一种以声明方式声明非规范化的方法，以避免编写像上面这样的代码：

*   [非规范化，魔法，真的那么有用吗？](http://groups.google.com/group/django-developers/browse_thread/thread/9a672d5bbbe67562)
*   [非规范化魔法，第二轮](http://groups.google.com/group/django-developers/browse_thread/thread/6630273ab1869c19)

# php - 在 PHP 中，如何更改数组元素的键？

> ID：240660
> 
> 赞同：399
> 
> 时间：2008-10-27T17:09:48.857
> 
> 标签：php, arrays, associative-array

我有一个形式的关联数组，`key => value`其中键是一个数值，但它不是一个连续的数值。键实际上是一个 ID 号，值是一个计数。这对于大多数情况来说都很好，但是我想要一个函数来获取数组的可读名称并将其用作键，而不更改值。

我没有看到执行此操作的函数，但我假设我需要提供旧密钥和新密钥（我都有）并转换数组。有没有一种有效的方法来做到这一点？

* * *

## 回答 #1

> 赞同：646
> 
> 时间：2008-10-27T17:12:45.590

```
$arr[$newkey] = $arr[$oldkey];
unset($arr[$oldkey]); 
```

* * *

## 回答 #2

> 赞同：110
> 
> 时间：2014-01-23T04:57:49.223

执行此操作并保留数组顺序的方法是将数组键放入单独的数组中，查找并替换该数组中的键，然后将其与值组合回来。

这是一个可以做到这一点的函数：

```
function change_key( $array, $old_key, $new_key ) {

    if( ! array_key_exists( $old_key, $array ) )
        return $array;

    $keys = array_keys( $array );
    $keys[ array_search( $old_key, $keys ) ] = $new_key;

    return array_combine( $keys, $array );
} 
```

* * *

## 回答 #3

> 赞同：59
> 
> 时间：2010-11-16T17:00:44.860

如果您`array`是从数据库查询构建的，则可以直接从`mysql`语句中更改键：

代替

```
"select ´id´ from ´tablename´..." 
```

使用类似的东西：

```
"select ´id´ **as NEWNAME** from ´tablename´..." 
```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2010-12-26T07:03:14.313

KernelM 的回答很好，但是为了避免 Greg 在评论中提出的问题（冲突键），使用新数组会更安全

```
$newarr[$newkey] = $oldarr[$oldkey];
$oldarr=$newarr;
unset($newarr); 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2008-10-27T17:12:05.653

您可以使用第二个关联数组，将人类可读的名称映射到 id。这也将提供多对一的关系。然后做这样的事情：

> ```
> echo 'Widgets: ' . $data[$humanreadbleMapping['Widgets']]; 
> ```

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2016-04-05T19:57:40.133

```
$array = [
    'old1' => 1
    'old2' => 2
];

$renameMap = [
    'old1' => 'new1',   
    'old2' => 'new2'
];

$array = array_combine(array_map(function($el) use ($renameMap) {
    return $renameMap[$el];
}, array_keys($array)), array_values($array));

/*
$array = [
    'new1' => 1
    'new2' => 2
];
*/ 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2015-01-27T10:43:41.130

如果您还希望新数组键的位置与旧数组键的位置相同，您可以这样做：

```
function change_array_key( $array, $old_key, $new_key) {
    if(!is_array($array)){ print 'You must enter a array as a haystack!'; exit; }
    if(!array_key_exists($old_key, $array)){
        return $array;
    }

    $key_pos = array_search($old_key, array_keys($array));
    $arr_before = array_slice($array, 0, $key_pos);
    $arr_after = array_slice($array, $key_pos + 1);
    $arr_renamed = array($new_key => $array[$old_key]);

    return $arr_before + $arr_renamed + $arr_after;
} 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2012-10-25T05:16:47.237

如果你的数组是递归的，你可以使用这个函数：测试这个数据：

```
 $datos = array
    (
        '0' => array
            (
                'no' => 1,
                'id_maquina' => 1,
                'id_transaccion' => 1276316093,
                'ultimo_cambio' => 'asdfsaf',
                'fecha_ultimo_mantenimiento' => 1275804000,
                'mecanico_ultimo_mantenimiento' =>'asdfas',
                'fecha_ultima_reparacion' => 1275804000,
                'mecanico_ultima_reparacion' => 'sadfasf',
                'fecha_siguiente_mantenimiento' => 1275804000,
                'fecha_ultima_falla' => 0,
                'total_fallas' => 0,
            ),

        '1' => array
            (
                'no' => 2,
                'id_maquina' => 2,
                'id_transaccion' => 1276494575,
                'ultimo_cambio' => 'xx',
                'fecha_ultimo_mantenimiento' => 1275372000,
                'mecanico_ultimo_mantenimiento' => 'xx',
                'fecha_ultima_reparacion' => 1275458400,
                'mecanico_ultima_reparacion' => 'xx',
                'fecha_siguiente_mantenimiento' => 1275372000,
                'fecha_ultima_falla' => 0,
                'total_fallas' => 0,
            )
    ); 
```

这是功能：

```
function changekeyname($array, $newkey, $oldkey)
{
   foreach ($array as $key => $value) 
   {
      if (is_array($value))
         $array[$key] = changekeyname($value,$newkey,$oldkey);
      else
        {
             $array[$newkey] =  $array[$oldkey];    
        }

   }
   unset($array[$oldkey]);          
   return $array;   
} 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2019-10-30T06:52:43.617

两种解决方案的简单基准比较。

解决方案 1 复制和删除（订单丢失，但速度更快）[https://stackoverflow.com/a/240676/1617857](https://stackoverflow.com/a/240676/1617857)

```
<?php
$array = ['test' => 'value', ['etc...']];

$array['test2'] = $array['test'];
unset($array['test']); 
```

解决方案 2 重命名密钥[https://stackoverflow.com/a/21299719/1617857](https://stackoverflow.com/a/21299719/1617857)

```
<?php
$array = ['test' => 'value', ['etc...']];

$keys = array_keys( $array );
$keys[array_search('test', $keys, true)] = 'test2';
array_combine( $keys, $array ); 
```

基准：

```
<?php
$array = ['test' => 'value', ['etc...']];

for ($i =0; $i < 100000000; $i++){
    // Solution 1
}

for ($i =0; $i < 100000000; $i++){
    // Solution 2
} 
```

结果：

```
php solution1.php  6.33s  user 0.02s system 99% cpu 6.356  total
php solution1.php  6.37s  user 0.01s system 99% cpu 6.390  total
php solution2.php  12.14s user 0.01s system 99% cpu 12.164 total
php solution2.php  12.57s user 0.03s system 99% cpu 12.612 total 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2011-03-08T01:43:59.817

我喜欢 KernelM 的解决方案，但我需要一些可以处理潜在密钥冲突的东西（新密钥可能与现有密钥匹配）。这是我想出的：

```
function swapKeys( &$arr, $origKey, $newKey, &$pendingKeys ) {
    if( !isset( $arr[$newKey] ) ) {
        $arr[$newKey] = $arr[$origKey];
        unset( $arr[$origKey] );
        if( isset( $pendingKeys[$origKey] ) ) {
            // recursion to handle conflicting keys with conflicting keys
            swapKeys( $arr, $pendingKeys[$origKey], $origKey, $pendingKeys );
            unset( $pendingKeys[$origKey] );
        }
    } elseif( $newKey != $origKey ) {
        $pendingKeys[$newKey] = $origKey;
    }
} 
```

然后，您可以像这样循环遍历数组：

```
$myArray = array( '1970-01-01 00:00:01', '1970-01-01 00:01:00' );
$pendingKeys = array();
foreach( $myArray as $key => $myArrayValue ) {
    // NOTE: strtotime( '1970-01-01 00:00:01' ) = 1 (a conflicting key)
    $timestamp = strtotime( $myArrayValue );
    swapKeys( $myArray, $key, $timestamp, $pendingKeys );
}
// RESULT: $myArray == array( 1=>'1970-01-01 00:00:01', 60=>'1970-01-01 00:01:00' ) 
```

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2015-11-30T18:21:13.267

这是一个辅助函数来实现这一点：

```
/**
 * Helper function to rename array keys.
 */
function _rename_arr_key($oldkey, $newkey, array &$arr) {
    if (array_key_exists($oldkey, $arr)) {
        $arr[$newkey] = $arr[$oldkey];
        unset($arr[$oldkey]);
        return TRUE;
    } else {
        return FALSE;
    }
} 
```

漂亮基于[@KernelM 答案](https://stackoverflow.com/a/240676/55075)。

用法：

```
_rename_arr_key('oldkey', 'newkey', $my_array); 
```

成功重命名将返回*true*，否则返回*false*。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2015-06-22T07:18:20.680

此代码将有助于将旧密钥更改为新密钥

```
$i = 0;
$keys_array=array("0"=>"one","1"=>"two");

$keys = array_keys($keys_array);

for($i=0;$i<count($keys);$i++) {
    $keys_array[$keys_array[$i]]=$keys_array[$i];
    unset($keys_array[$i]);
}
print_r($keys_array); 
```

显示像

```
$keys_array=array("one"=>"one","two"=>"two"); 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2015-07-20T04:45:48.163

简单的东西：

这个函数将接受目标 $hash 并且 $replacements 也是一个包含**newkey=>oldkey associations**的哈希。

此函数将**保留原始顺序**，但对于非常大（如超过 10k 条记录）数组的**性能和内存**可能会出现问题。

```
function keyRename(array $hash, array $replacements) {
    $new=array();
    foreach($hash as $k=>$v)
    {
        if($ok=array_search($k,$replacements))
            $k=$ok;
        $new[$k]=$v;
    }
    return $new;    
} 
```

这个替代函数会做同样的事情，具有**更好的性能**和内存使用，但会丢失原始订单（这应该不是问题，因为它是哈希表！）

```
function keyRename(array $hash, array $replacements) {

    foreach($hash as $k=>$v)
        if($ok=array_search($k,$replacements))
        {
          $hash[$ok]=$v;
          unset($hash[$k]);
        }

    return $hash;       
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2016-07-13T02:05:02.790

如果您想一次更换多个键（保留顺序）：

```
/**
 * Rename keys of an array
 * @param array $array (asoc)
 * @param array $replacement_keys (indexed)
 * @return array
 */
function rename_keys($array, $replacement_keys)  {
      return array_combine($replacement_keys, array_values($array));
} 
```

用法：

```
$myarr = array("a" => 22, "b" => 144, "c" => 43);
$newkeys = array("x","y","z");
print_r(rename_keys($myarr, $newkeys));
//must return: array("x" => 22, "y" => 144, "z" => 43); 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2017-03-28T05:31:44.467

在使用完整数组时，还有另一种方法可以更改数组元素的键 - 无需更改数组的顺序。它只是将数组复制到一个新数组中。

例如，我正在使用包含索引键和关联键的混合多维数组 - 我想用它们的值替换整数键，而不会破坏顺序。

我通过切换所有数字数组条目的键/值来做到这一点 - 这里：['0'=>'foo']。请注意，订单是完整的。

```
<?php
$arr = [
    'foo',
    'bar'=>'alfa',
    'baz'=>['a'=>'hello', 'b'=>'world'],
];

foreach($arr as $k=>$v) {
    $kk = is_numeric($k) ? $v : $k;
    $vv = is_numeric($k) ? null : $v;
    $arr2[$kk] = $vv;
}

print_r($arr2); 
```

输出：

```
Array (
    [foo] => 
    [bar] => alfa
    [baz] => Array (
            [a] => hello
            [b] => world
        )
) 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2018-09-09T20:08:33.960

您可以基于 array_walk 使用此函数：

```
function mapToIDs($array, $id_field_name = 'id')
{
    $result = [];
    array_walk($array, 
        function(&$value, $key) use (&$result, $id_field_name)
        {
            $result[$value[$id_field_name]] = $value;
        }
    );
    return $result;
}

$arr = [0 => ['id' => 'one', 'fruit' => 'apple'], 1 => ['id' => 'two', 'fruit' => 'banana']];
print_r($arr);
print_r(mapToIDs($arr)); 
```

它给：

```
Array(
    [0] => Array(
        [id] => one
        [fruit] => apple
    )
    [1] => Array(
        [id] => two
        [fruit] => banana
    )
)

Array(
    [one] => Array(
        [id] => one
        [fruit] => apple
    )
    [two] => Array(
        [id] => two
        [fruit] => banana
    )
) 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2020-03-19T21:48:17.283

此函数将通过结合索引搜索重命名数组键，保持其位置。

```
function renameArrKey($arr, $oldKey, $newKey){
    if(!isset($arr[$oldKey])) return $arr; // Failsafe
    $keys = array_keys($arr);
    $keys[array_search($oldKey, $keys)] = $newKey;
    $newArr = array_combine($keys, $arr);
    return $newArr;
} 
```

用法：

```
$arr = renameArrKey($arr, 'old_key', 'new_key'); 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2016-05-15T21:14:25.090

这适用于重命名第一个键：

```
$a = ['catine' => 'cat', 'canine'  => 'dog'];
$tmpa['feline'] = $a['catine'];
unset($a['catine']);
$a = $tmpa + $a; 
```

然后， print_r($a) 呈现一个修复后的有序数组：

```
Array
(
    [feline] => cat
    [canine] => dog
) 
```

这适用于重命名任意键：

```
$a = ['canine'  => 'dog', 'catine' => 'cat', 'porcine' => 'pig']
$af = array_flip($a)
$af['cat'] = 'feline';
$a = array_flip($af) 
```

print_r($a)

```
Array
(
    [canine] => dog
    [feline] => cat
    [porcine] => pig
) 
```

广义函数：

```
function renameKey($oldkey, $newkey, $array) {
    $val = $array[$oldkey];
    $tmp_A = array_flip($array);
    $tmp_A[$val] = $newkey;

    return array_flip($tmp_A);
} 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2019-05-31T03:16:21.560

最好的方法是使用参考，而不是使用 unset （这使清理内存的另一个步骤）

```
$tab = ['two' => [] ]; 
```

解决方案：

```
$tab['newname'] = & $tab['two']; 
```

您有一份原件和一份新名称的参考资料。

或者，如果您不想在一个值中有两个名称，则可以在参考上创建另一个选项卡和 foreach

```
foreach($tab as $key=> & $value) {
    if($key=='two') { 
        $newtab["newname"] = & $tab[$key];
     } else {
        $newtab[$key] = & $tab[$key];
     }
} 
```

对键进行迭代比克隆所有数组更好，如果您有 100 行 +++ 等长数据，则清理旧数组。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2019-10-30T17:04:44.037

这个基本函数处理交换数组键并将数组保持在原始顺序......

```
public function keySwap(array $resource, array $keys)
{
    $newResource = [];

    foreach($resource as $k => $r){
        if(array_key_exists($k,$keys)){
            $newResource[$keys[$k]] = $r;
        }else{
            $newResource[$k] = $r;
        }
    }

    return $newResource;
} 
```

然后，您可以循环并用 'z' 交换所有 'a' 键......

```
$inputs = [
  0 => ['a'=>'1','b'=>'2'],
  1 => ['a'=>'3','b'=>'4']
]

$keySwap = ['a'=>'z'];

foreach($inputs as $k=>$i){
    $inputs[$k] = $this->keySwap($i,$keySwap);
} 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2022-02-26T06:01:43.103

此页面对所需内容进行了广泛的解释，因为问题正文中没有最小的、可验证的示例。有些答案只是试图解决“标题”而没有理解问题要求。

> 键实际上是一个 ID 号，值是一个计数。这对于大多数情况来说都很好，但是我想要一个函数来获取数组的可读名称并将其用作键，而不更改值。

PHP 键不能*更改*，但可以替换 - 这就是为什么这么多答案建议使用`array_search()`（性能相对较差的）和`unset()`.

最终，您希望创建一个新数组，其名称作为与原始计数相关的键。这是通过查找数组最有效地完成的，因为搜索键总是优于搜索值。

代码：（[演示](https://3v4l.org/RcaRL)）

```
$idCounts = [
    3 => 15,
    7 => 12,
    8 => 10,
    9 => 4
];

$idNames = [
    1 => 'Steve',
    2 => 'Georgia',
    3 => 'Elon',
    4 => 'Fiona',
    5 => 'Tim',
    6 => 'Petra',
    7 => 'Quentin',
    8 => 'Raymond',
    9 => 'Barb'
];

$result = [];
foreach ($idCounts as $id => $count) {
    if (isset($idNames[$id])) {
        $result[$idNames[$id]] = $count;
    }
}
var_export($result); 
```

输出：

```
array (
  'Elon' => 15,
  'Quentin' => 12,
  'Raymond' => 10,
  'Barb' => 4,
) 
```

这种技术保持原始数组顺序（如果排序很重要），不会进行任何不必要的迭代，并且由于`isset()`.

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2018-08-15T10:55:31.160

一个很容易理解的保存者订购的：

```
function rename_array_key(array $array, $old_key, $new_key) {
  if (!array_key_exists($old_key, $array)) {
      return $array;
  }
  $new_array = [];
  foreach ($array as $key => $value) {
    $new_key = $old_key === $key
      ? $new_key
      : $key;
    $new_array[$new_key] = $value;
  }
  return $new_array;
} 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2019-06-28T02:58:56.133

您可以编写简单的函数，将回调应用于给定数组的键。类似于[array_map](https://www.php.net/manual/en/function.array-map.php)

```
<?php
function array_map_keys(callable $callback, array $array) {
    return array_merge([], ...array_map(
        function ($key, $value) use ($callback) { return [$callback($key) => $value]; },
        array_keys($array),
        $array
    ));
}

$array = ['a' => 1, 'b' => 'test', 'c' => ['x' => 1, 'y' => 2]];
$newArray = array_map_keys(function($key) { return 'new' . ucfirst($key); }, $array);

echo json_encode($array); // {"a":1,"b":"test","c":{"x":1,"y":2}}
echo json_encode($newArray); // {"newA":1,"newB":"test","newC":{"x":1,"y":2}} 
```

这是一个要点[https://gist.github.com/vardius/650367e15abfb58bcd72ca47eff096ca#file-array_map_keys-php](https://gist.github.com/vardius/650367e15abfb58bcd72ca47eff096ca#file-array_map_keys-php)。

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2017-01-16T03:52:21.183

嗯，我以前没有测试过，但我认为这段代码有效

```
function replace_array_key($data) {
    $mapping = [
        'old_key_1' => 'new_key_1',
        'old_key_2' => 'new_key_2',
    ];

    $data = json_encode($data);
    foreach ($mapping as $needed => $replace) {
        $data = str_replace('"'.$needed.'":', '"'.$replace.'":', $data);
    }

    return json_decode($data, true);
} 
```

# perl - 更改脚本中的工作目录的最佳做法是什么？

> ID：240661
> 
> 赞同：12
> 
> 时间：2008-10-27T17:09:55.160
> 
> 标签：perl, bash, shell, zsh

您认为更改 bash 或 Perl 脚本中的目录是否可以接受？还是应该不惜一切代价避免这样做？

这个问题的最佳实践是什么？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-10-27T21:41:36.437

就像雨果说的，你不能影响你的父进程的 cwd 所以没有问题。

如果您不控制整个过程，例如在子例程或模块中，则问题更适用。在这些情况下，您希望退出与您输入相同的目录中的子例程，否则微妙的远距离动作会导致错误。

你可以手动完成这个...

```
use Cwd;
sub foo {
    my $orig_cwd = cwd;
    chdir "some/dir";

    ...do some work...

    chdir $orig_cwd;
} 
```

但这有问题。如果子例程提前返回或终止（并且异常被捕获），您的代码仍将位于`some/dir`. 此外，`chdir`s 可能会失败，您必须记住检查每次使用。呜呜。

幸运的是，有几个模块可以让这更容易。File::pushd 是其中之一，但我更喜欢[File::chdir](http://search.cpan.org/perldoc?File::chdir)。

```
use File::chdir;
sub foo {
    local $CWD = 'some/dir';

    ...do some work...
} 
```

File::chdir 将目录更改为分配给`$CWD`. 而且您可以进行本地化`$CWD`，因此无论如何它都会在您的范围结束时重置。它还会自动检查是否`chdir`成功，否则抛出异常。有时它会在脚本中使用它，因为它非常方便。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-27T17:19:16.123

当前工作目录是执行 shell 的本地目录，因此您不能影响用户，除非他“打点”（在当前 shell 中运行它，而不是正常运行它创建一个新的 shell 进程）您的脚本。

这样做的一个很好的方法是使用子shell，我经常在别名中这样做。

```
alias build-product1='(cd $working-copy/delivery; mvn package;)' 
```

括号将确保命令是从子 shell 执行的，因此不会影响我的 shell 的工作目录。它也不会影响最后一个工作目录，所以**cd -;** 按预期工作。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-27T17:12:39.757

我不经常这样做，但有时它可以避免相当多的头痛。只要确保如果您更改目录，您总是会更改回您开始的目录。否则，更改代码路径可能会将应用程序留在不应该出现的地方。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-27T22:02:54.553

对于 Perl，你有来自 CPAN 的[File::pushd](http://search.cpan.org/dist/File-pushd/)模块，它使得本地更改工作目录非常优雅。引用概要：

```
 use File::pushd;

  chdir $ENV{HOME};

  # change directory again for a limited scope
  {
      my $dir = pushd( '/tmp' );
      # working directory changed to /tmp
  }
  # working directory has reverted to $ENV{HOME}

  # tempd() is equivalent to pushd( File::Temp::tempdir )
  {
      my $dir = tempd();
  }

  # object stringifies naturally as an absolute path
  {
     my $dir = pushd( '/tmp' );
     my $filename = File::Spec->catfile( $dir, "somefile.txt" );
     # gives /tmp/somefile.txt
  } 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-27T22:11:29.420

我将支持上面 Schwern 和 Hugo 的评论。请注意 Schwern 关于在意外退出时返回原始目录的警告。他提供了适当的 Perl 代码来处理这个问题。我将指出 shell（Bash、Korn、Bourne）陷阱命令。

陷阱“cd $saved_dir”0

将在 subshel​​l 退出时返回到 saved_dir（如果你正在 .'ing 文件）。

麦克风

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-27T21:35:52.363

还要考虑 Unix 和 Windows 有一个内置的目录堆栈：[pushd 和 popd](http://en.wikipedia.org/wiki/Pushd_and_popd)。它非常易于使用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-28T04:06:35.367

尝试使用完全量化的路径并且不对您当前所在的目录做出任何假设是否可行？例如

```
use FileHandle;
use FindBin qw($Bin);
# ...
my $file = new FileHandle("< $Bin/somefile"); 
```

而不是

```
use FileHandle;
# ...
my $file = new FileHandle("< somefile"); 
```

从长远来看，这可能会更容易，因为您不必担心发生奇怪的事情（您的脚本在将当前工作目录放回原来的位置之前死亡或被杀死），并且很可能更便携.

# language-agnostic - 您会推荐为哪个开源项目做出贡献？

> ID：240674
> 
> 赞同：4
> 
> 时间：2008-10-27T17:12:24.640
> 
> 标签：language-agnostic, open-source

您会推荐哪些开源项目作为开始开源开发人员的好地方？我认为重要的因素是一些显而易见的因素，例如编写良好的代码和对新手有帮助的社区。但是，如果代码库是这样的，我可以在没有真正了解一切如何运作的细节的情况下开始解决一些小问题，那可能会很好。

我更喜欢可以使用 C/C++/Java/Python/Scala 在 Linux 上开发的东西。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-27T17:14:59.707

试图选择这样的项目永远不会奏效，因为这不是你热衷的事情。您每天使用或喜欢使用的开源项目是什么？和那个一起工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-27T17:16:00.017

这实际上取决于您对潜入什么项目的兴趣。

大型项目（例如 Firefox、OpenOffice 等）的基本原理是它有许多开发人员、完善的代码库以及许多需要解决的小任务/错误。

较小项目的基本原理是您将更加熟悉代码和应用程​​序。您可能会了解团队中的其他开发人员并更好地理解整体概念。此外，您对项目的添加可能会更加引人注目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T17:25:02.947

**sourceforge**有一个寻找新开发人员的项目列表。您要求的编程语言有几种：

[http://sourceforge.net/people/?category_id=1](http://sourceforge.net/people/?category_id=1)

除了开发人员之外，他们还有更多帮助请求：

[http://sourceforge.net/people/](http://sourceforge.net/people/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-27T18:54:38.147

选择一个你已经使用并喜欢的。

# java - 使用 HttpsURLConnection 下载 xml.gz 文件

> ID：240692
> 
> 赞同：3
> 
> 时间：2008-10-27T17:16:31.730
> 
> 标签：java, ssl, https

我正在尝试使用 java 中的 HttpsURLConnection 从远程服务器下载 xml.gz 文件，但我得到一个空响应。这是我的代码示例：

```
URL server = new URL("https://www.myurl.com/path/sample_file.xml.gz");
HttpsURLConnection connection = (HttpsURLConnection)server.openConnection();
connection.connect(); 
```

当我尝试从连接中获取 InputStream 时，它是空的。（如果我尝试 connection.getInputStream().read() 我得到-1）我期望的文件大约是 50MB。

为了测试我的理智，我还尝试在浏览器中输入完全相同的 url，它确实返回了我需要的文件。我错过了什么吗？我是否必须在连接中设置某种参数？非常感谢任何帮助/指导。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T17:37:32.063

Is any exception being logged? Is the website presenting a self-signed SSL certificate, or one that is not signed by a CA? There are several reasons why it might work fine in your browser (the browser might have been told to accept self-signed certs from that domain) and not in your code.

What are the results of using [curl](http://curl.haxx.se/) or [wget](http://www.gnu.org/software/wget/) to fetch the URL?

The fact that the InputStream is empty / result from the InputStream.read() == -1 implies that there is nothing in the stream to read, meaning that the stream was not able to even be set up properly.

**Update**: [See this page](http://www.howardism.org/Technical/Java/SelfSignedCerts.html) for some info on how you can deal with invalid/self-signed certificates in your connection code. Or, if the site is presenting a certificate but it is invalid, you can import it into the keystore of the server to tell Java to trust the certificate. [See this page for more info](http://www.chrissearle.org/blog/technical/adding_self_signed_https_certificates_java_keystore).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-27T18:03:22.197

1.  Verify the `response code` is 200
2.  Check that `connection.contentType` to verify the content type is recognized
3.  You may need to add a Content-Handler for the GZ mime type, which I can't recall off the top of my head.

After the comment describing the response code as 3xx,

1.  Set 'connection.setFollowRedirects(true)'

Should fix it.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-28T18:27:08.857

原来下载不起作用，因为远程服务器正在将我重定向到一个新的 url 来下载文件。即使设置了 connection.setFollowRedirects(true)，我仍然必须手动为重定向的 URL 设置新连接，如下所示：

```
if (connection.getResponseCode() == 302 && connection.getHeaderField("location") != null){
            URL server2 = new URL(connection.getHeaderField("location"));
            HttpURLConnection connection2 = (HttpURLConnection)server2.openConnection();
            connection2.connect();
            InputStream in = connection2.getInputStream();
} 
```

之后，我能够从输入流中检索文件。感谢您的所有帮助！

# perl - 在部署 Perl 项目之前如何确定 CPAN 依赖项？

> ID：240704
> 
> 赞同：13
> 
> 时间：2008-10-27T17:19:19.197
> 
> 标签：perl, deployment, dependencies, cpan

有没有人对找到定制开发项目中可能出现的所有 CPAN 依赖项的好方法有任何建议。通常情况下，您的本地开发环境很少与您的实际环境相匹配，并且随着您构建越来越多的项目，您倾向于构建本地已安装模块的库。然后，这些会导致您不一定注意到您的最新项目对非核心模块有要求。由于通常需要将整个项目打包以部署到另一个组（在我们的例子中是我们的运营团队），因此了解包中应包含哪些模块非常重要。

有没有人对这个问题有任何见解。

谢谢

彼得

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-27T20:57:38.290

我自己也遇到过这个问题。 [Devel::Modlist](http://search.cpan.org/perldoc?Devel::Modlist)（如[this answer](https://stackoverflow.com/questions/240704/how-can-i-determine-cpan-dependencies-before-i-deploy-a-perl-project#240723)建议）采用动态方法。它报告在脚本的特定运行期间实际加载的模块。这会捕获以任何方式加载的模块，但它可能无法捕获条件需求。也就是说，如果你有这样的代码：

```
if ($some_condition) { require Some::Module } 
```

并且`$some_condition`恰好是假的，`Devel::Modlist`不会`Some::Module`作为要求列出。

我决定改用[Module::ExtractUse](http://search.cpan.org/perldoc?Module::ExtractUse)。它进行静态分析，这意味着它总是会`Some::Module`在上面的示例中捕获。另一方面，它对以下代码无能为力：

```
my $module = "Other::Module";
eval "use $module;"; 
```

当然，您可以同时使用这两种方法，然后将这两个列表结合起来。

无论如何，这是我想出的解决方案：

```
#! /usr/bin/perl
#---------------------------------------------------------------------
# Copyright 2008 Christopher J. Madsen <perl at cjmweb.net>
#
# This program is free software; you can redistribute it and/or modify
# it under the same terms as Perl itself.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See either the
# GNU General Public License or the Artistic License for more details.
#
# Recursively collect dependencies of Perl scripts
#---------------------------------------------------------------------

use strict;
use warnings;
use File::Spec ();
use Module::CoreList ();
use Module::ExtractUse ();

my %need;
my $core = $Module::CoreList::version{'5.008'};

# These modules have lots of dependencies.  I don't need to see them now.
my %noRecurse = map { $_ => 1 } qw(
  Log::Log4perl
  XML::Twig
);

foreach my $file (@ARGV) {
  findDeps($file);
}

foreach my $module (sort keys %need) {
  print "  $module\n";
}

#---------------------------------------------------------------------
sub findDeps
{
  my ($file) = @_;

  my $p = Module::ExtractUse->new;

  $p->extract_use($file);

  foreach my $module ($p->array) {
    next if exists $core->{$module};
    next if $module =~ /^5[._\d]+/; # Ignore "use MIN-PERL-VERSION"
    next if $module =~ /\$/;        # Run-time specified module

    if (++$need{$module} == 1 and not $noRecurse{$module}) {
      my $path = findModule($module);
      if ($path) { findDeps($path) }
      else       { warn "WARNING: Can't find $module\n" }
    } # end if first use of $module
  } # end foreach $module used
} # end findDeps

#---------------------------------------------------------------------
sub findModule
{
  my ($module) = @_;

  $module =~ s!::|\'!/!g;
  $module .= '.pm';

  foreach my $dir (@INC) {
    my $path = File::Spec->catfile($dir, $module);
    return $path if -f $path;
  }

  return;
} # end findModule 
```

你会这样运行：

```
perl finddeps.pl scriptToCheck.pl otherScriptToCheck.pl 
```

它打印运行列出的脚本所需的所有非核心模块的列表。（除非他们在模块加载方面做了一些花哨的技巧来阻止 Module::ExtractUse 看到它们。）

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-27T17:39:43.977

[您可以使用deps.cpantesters.org](http://deps.cpantesters.org/)上的在线网络服务，该服务将为您提供许多有用的依赖数据。CPAN 上的所有模块都已经有到依赖站点的链接（在模块页面的右侧）。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-27T17:25:59.183

过去我使用过[Devel::Modlist](http://search.cpan.org/dist/Devel-Modlist/)，它相当不错，可以让你去

```
perl -d:Modlist script.pl 
```

获取所需模块的列表。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-27T18:19:17.203

我的所有 C/C++ 应用程序（基于 PC 和各种嵌入式项目）都有一个基于 Make 的构建系统，虽然我喜欢能够在新机器上进行顶级构建并验证所有依赖项都在地方（我将我的工具链检查到版本控制中：D），我对没有为我的构建系统中当前没有生成文件的解释语言做同样的事情感到沮丧。

我很想写一个脚本：

*   在我的修订控制存储库中搜索扩展名为 .pl 或 .pm 的文件
*   跑`perl -d:Modlist`在他们身上（感谢瓦格纳！）
*   将其连接到所需模块的列表
*   最后将其与已安装模块的列表进行比较。

然后我会将该脚本作为我的顶级构建的一部分来执行，这样任何构建任何东西的人都会知道他们是否拥有运行从修订控制获得的每个 perl 脚本所需的一切。如果有一些 perl 脚本他们从不运行并且不想 CPAN 安装运行它所需的内容，他们必须从硬盘驱动器中删除不需要的脚本，因此依赖项检查器无法找到它们。我知道如何修改 perforce 客户端以在您进行“同步”时省略某些子目录，我必须弄清楚这一点以进行颠覆......

我建议将依赖项检查器制作为搜索 pl 文件的单个脚本，而不是单独的 makefile 来检查每个脚本的依赖项，或者基于脚本名称的硬编码列表。如果您选择的方法需要用户操作以检查脚本的依赖关系，人们将忘记执行该操作，因为即使他们不进行依赖关系检查，他们也能够运行脚本。

就像我说的，我还没有实现上述内容，但是这个问题促使我尝试这样做。完成后我会回贴我的经验。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-27T17:40:01.510

“显而易见”的方式——痛苦但适度有效——是在一些偏僻的位置安装一个全新的基础 Perl 构建（你不会在生产中使用它），然后尝试使用它来安装你的模块Perl 的“原始”版本。您将找到所有缺少的依赖项。第一次，这可能会很痛苦。在第一次之后，您将已经涵盖了大部分依赖项，并且痛苦会大大减少。

考虑运行您自己的 CPAN 模块本地存储库 - 这样您就不必总是下载代码。还要考虑如何清理过时的模块。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-28T22:43:18.200

```
use Acme::Magic::Pony; 
```

严重地。如果 Perl 模块丢失，它将自动安装它们。请参阅 CPAN 中的[Acme::Magic::Pony](http://search.cpan.org/~jlavallee/Acme-Magic-Pony-0.02/lib/Acme/Magic/Pony.pm)页面。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-27T19:08:43.610

这是一个“被拴住的马”的答案，但我已经养成了用我所有的依赖项创建一个 Bundle 文件的习惯。因此，当我进入新环境时，我只需将其复制并安装即可。

例如。我有一个 Baz.pm

```
package Bundle::Baz;
$VERSION = '0.1';
1;
__END__
=head1 NAME
Bundle::Baz
=head1 SYNOPSIS
perl -MCPAN -e 'install Bundle::Baz'
=head1 CONTENTS
# Baz's modules
XML::Twig
XML::Writer
Perl6::Say
Moose 
```

把它放在 ~/.cpan/Bundle/ （或者你的 .cpan 所在的任何地方），然后像普通的 CPAN 模块一样安装 'Bundle::Baz'。然后安装“=head1 CONTENTS”下列出的所有模块。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-28T22:48:53.073

这是一个快速的 bash 函数（使用出色的[ack](http://petdance.com/ack/)）：

```
# find-perl-module-use <directory> (lib/ by default)
function find-perl-module-use() {
    dir=${1:-lib}
    ack '^\s*use\s+.*;\s*$' $dir | awk '{ print $2 }' | sed 's/();\?$\|;$//' | sort | uniq
    ack '^\s*use\s+base\s+.*;\s*$' $dir | awk '{ print $3 }' | sed 's/();\?$\|;$//' | sort | uniq
} 
```

# sharepoint - SharePoint 列表订阅

> ID：240707
> 
> 赞同：5
> 
> 时间：2008-10-27T17:20:29.710
> 
> 标签：sharepoint, permissions, alerts

如果我对某个列表拥有“完全控制”权限，我有没有办法查看为该列表设置了警报的所有个人？

我部门中的一些人比其他人更擅长管理自己的订阅，这是我从几个团队负责人那里收到的问题。他们希望能够查看并确认谁为列表设置了警报。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-27T18:01:35.167

如果您转到“站点操作”>“站点设置”>“用户警报”，则会显示一个下拉列表，其中包含在站点中任何位置设置了警报的所有用户。然后，您可以选择一个用户并单击更新 - 这将向您显示警报在站点中的位置。

不幸的是，它没有让您选择查看站点特定部分的所有警报。因此，您可以轻松回答“约翰是否在我的公告中设置了警报？” 但回答“谁在我的公告上设置了警报？”并不是那么简单。

# asp.net - 如何在 asp.net 中加密查询字符串？

> ID：240713
> 
> 赞同：8
> 
> 时间：2008-10-27T17:22:34.510
> 
> 标签：asp.net, encryption

我需要加密和解密 ASP.NET 中的查询字符串。

查询字符串可能如下所示：

> [http://www.mysite.com/report.aspx?id=12345&year=2008](http://www.mysite.com/report.aspx?id=12345&year=2008)

如何加密整个查询字符串，使其看起来像下面这样？

> [http://www.mysite.com/report.aspx?crypt=asldjfaf32as98df8a](http://www.mysite.com/report.aspx?crypt=asldjfaf32as98df8a)

然后，当然，我如何解密它？对于这样的事情，最好的加密是什么？三重DES？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-27T17:33:39.823

这是在 VB 中执行此操作的一种方法来自： http: [//www.devcity.net/Articles/47/1/encrypt_querystring.aspx](http://www.devcity.net/Articles/47/1/encrypt_querystring.aspx)

**加密代码的包装器：**将您的查询字符串参数传递给它，并更改密钥！！！

```
Private _key as string = "!#$a54?3"
Public Function encryptQueryString(ByVal strQueryString As String) As String
    Dim oES As New ExtractAndSerialize.Encryption64()
    Return oES.Encrypt(strQueryString, _key)
End Function

Public Function decryptQueryString(ByVal strQueryString As String) As String
    Dim oES As New ExtractAndSerialize.Encryption64()
    Return oES.Decrypt(strQueryString, _key)
End Function 
```

**加密代码：**

```
Imports System
Imports System.IO
Imports System.Xml
Imports System.Text
Imports System.Security.Cryptography

Public Class Encryption64
    Private key() As Byte = {}
    Private IV() As Byte = {&H12, &H34, &H56, &H78, &H90, &HAB, &HCD, &HEF}

    Public Function Decrypt(ByVal stringToDecrypt As String, _
        ByVal sEncryptionKey As String) As String
        Dim inputByteArray(stringToDecrypt.Length) As Byte
         Try
            key = System.Text.Encoding.UTF8.GetBytes(Left(sEncryptionKey, 8))
            Dim des As New DESCryptoServiceProvider()
            inputByteArray = Convert.FromBase64String(stringToDecrypt)
            Dim ms As New MemoryStream()
            Dim cs As New CryptoStream(ms, des.CreateDecryptor(key, IV), _
                CryptoStreamMode.Write)
            cs.Write(inputByteArray, 0, inputByteArray.Length)
            cs.FlushFinalBlock()
            Dim encoding As System.Text.Encoding = System.Text.Encoding.UTF8
            Return encoding.GetString(ms.ToArray())
        Catch e As Exception
            Return e.Message
        End Try
    End Function

    Public Function Encrypt(ByVal stringToEncrypt As String, _
        ByVal SEncryptionKey As String) As String
        Try
            key = System.Text.Encoding.UTF8.GetBytes(Left(SEncryptionKey, 8))
            Dim des As New DESCryptoServiceProvider()
            Dim inputByteArray() As Byte = Encoding.UTF8.GetBytes( _
                stringToEncrypt)
            Dim ms As New MemoryStream()
            Dim cs As New CryptoStream(ms, des.CreateEncryptor(key, IV), _
                CryptoStreamMode.Write)
            cs.Write(inputByteArray, 0, inputByteArray.Length)
            cs.FlushFinalBlock()
            Return Convert.ToBase64String(ms.ToArray())
        Catch e As Exception
            Return e.Message
        End Try
    End Function

End Class 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-05-08T11:01:00.500

使用 AES 加密的 C# 中的加密-

```
protected void Submit(object sender, EventArgs e)
{
    string name = HttpUtility.UrlEncode(Encrypt(txtName.Text.Trim()));
    string technology = HttpUtility.UrlEncode(Encrypt(ddlTechnology.SelectedItem.Value));
    Response.Redirect(string.Format("~/CS2.aspx?name={0}&technology={1}", name, technology));
} 
```

**AES算法加解密功能**

```
private string Encrypt(string clearText)
{
    string EncryptionKey = "hyddhrii%2moi43Hd5%%";
    byte[] clearBytes = Encoding.Unicode.GetBytes(clearText);
    using (Aes encryptor = Aes.Create())
    {
        Rfc2898DeriveBytes pdb = new Rfc2898DeriveBytes(EncryptionKey, new byte[] { 0x49, 0x76, 0x61, 0x6e, 0x20, 0x4d, 0x65, 0x64, 0x76, 0x65, 0x64, 0x65, 0x76 });
        encryptor.Key = pdb.GetBytes(32);
        encryptor.IV = pdb.GetBytes(16);
        using (MemoryStream ms = new MemoryStream())
        {
            using (CryptoStream cs = new CryptoStream(ms, encryptor.CreateEncryptor(), CryptoStreamMode.Write))
            {
                cs.Write(clearBytes, 0, clearBytes.Length);
                cs.Close();
            }
            clearText = Convert.ToBase64String(ms.ToArray());
        }
    }
    return clearText;
}

private string Decrypt(string cipherText)
{
    string EncryptionKey = "hyddhrii%2moi43Hd5%%";
    cipherText = cipherText.Replace(" ", "+");
    byte[] cipherBytes = Convert.FromBase64String(cipherText);
    using (Aes encryptor = Aes.Create())
    {
        Rfc2898DeriveBytes pdb = new Rfc2898DeriveBytes(EncryptionKey, new byte[] { 0x49, 0x76, 0x61, 0x6e, 0x20, 0x4d, 0x65, 0x64, 0x76, 0x65, 0x64, 0x65, 0x76 });
        encryptor.Key = pdb.GetBytes(32);
        encryptor.IV = pdb.GetBytes(16);
        using (MemoryStream ms = new MemoryStream())
        {
            using (CryptoStream cs = new CryptoStream(ms, encryptor.CreateDecryptor(), CryptoStreamMode.Write))
            {
                cs.Write(cipherBytes, 0, cipherBytes.Length);
                cs.Close();
            }
            cipherText = Encoding.Unicode.GetString(ms.ToArray());
        }
    }
    return cipherText;
} 
```

**解密**

```
lblName.Text = Decrypt(HttpUtility.UrlDecode(Request.QueryString["name"]));
lblTechnology.Text = Decrypt(HttpUtility.UrlDecode(Request.QueryString["technology"])); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T17:28:08.167

我无法在脑海中为您提供交钥匙解决方案，但您应该避免使用 TripleDES，因为它[不如其他加密方法安全](http://en.wikipedia.org/wiki/Triple_DES)。

如果我这样做，我只需将整个 URL（域和查询字符串）作为[URI 对象，使用](http://msdn.microsoft.com/en-us/library/system.uri.aspx)[内置的 .NET 库](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rijndael.aspx)之一对其进行加密并将其作为`crypt`对象提供。当我需要解密它时，这样做，然后创建一个新的 URI 对象，它可以让您从原始查询字符串中取回所有内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-27T17:59:10.520

这是上面 Brian 示例中的解密函数的一种花哨版本，如果您只打算将其用于 QueryString，则可以使用它，因为它返回 NameValueCollection 而不是字符串。它还包含一个轻微的修正，因为布赖恩的例子将在没有

```
stringToDecrypt = stringToDecrypt.Replace(" ", "+") 
```

如果要解密的字符串中有任何“空格”字符：

```
Public Shared Function DecryptQueryString(ByVal stringToDecrypt As String, ByVal encryptionKey As String) As Collections.Specialized.NameValueCollection
    Dim inputByteArray(stringToDecrypt.Length) As Byte
    Try
        Dim key() As Byte = System.Text.Encoding.UTF8.GetBytes(encryptionKey.Substring(0, encryptionKey.Length))
        Dim IV() As Byte = {&H12, &H34, &H56, &H78, &H90, &HAB, &HCD, &HEF}
        Dim des As New DESCryptoServiceProvider()
        stringToDecrypt = stringToDecrypt.Replace(" ", "+")
        inputByteArray = Convert.FromBase64String(stringToDecrypt)
        Dim ms As New MemoryStream()
        Dim cs As New CryptoStream(ms, des.CreateDecryptor(key, IV), CryptoStreamMode.Write)
        cs.Write(inputByteArray, 0, inputByteArray.Length)
        cs.FlushFinalBlock()
        Dim encoding As System.Text.Encoding = System.Text.Encoding.UTF8
        Dim decryptedString As String = encoding.GetString(ms.ToArray())
        Dim nameVals() As String = decryptedString.Split(CChar("&"))
        Dim queryString As New Collections.Specialized.NameValueCollection(nameVals.Length)
        For Each nameValPair As String In nameVals
            Dim pair() As String = nameValPair.Split(CChar("="))
            queryString.Add(pair(0), pair(1))
        Next
        Return queryString

    Catch e As Exception
        Throw New Exception(e.Message)
    End Try
End Function 
```

希望这个对你有帮助！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-27T18:07:08.400

我最初打算同意 Joseph Bui 的观点，理由是使用 POST 方法会提高处理器效率，Web 标准规定，如果请求不更改服务器上的数据，则应使用 GET 方法。

与仅使用 POST 相比，加密数据的代码要多得多。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-27T17:39:35.973

你为什么要加密你的查询字符串？如果数据是敏感的，您应该使用 SSL。如果您担心有人从用户的肩膀上看过去，请使用表单 POST 而不是 GET。

我认为对于您的基本问题，很可能有比加密查询字符串更好的解决方案。

# asp-classic - 在 MapPath 方法的 Path 参数中发现无效的“/”或“\”

> ID：240714
> 
> 赞同：1
> 
> 时间：2008-10-27T17:22:48.973
> 
> 标签：asp-classic

就像标题所说，我得到的错误如下：

```
An invalid '/' or '\' was found in the Path parameter for the MapPath method. 
```

我正在使用 ASP 经典，基本上是在尝试访问我们其中一台服务器上的文件夹。我用谷歌搜索了一下，从大多数人所说的来看，我应该从我的服务器路径中去掉 \ 前缀。但是当我这样做时，代码找不到服务器。我正在使用的代码是：

```
Dim fileSystem
Set fileSystem = Server.CreateObject("Scripting.FileSystemObject")

fileSystem.GetFolder(Server.MapPath("\\servername")) 
```

所以我的问题是，如何使用 FileSystemObject 访问服务器的文件和文件夹？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T17:29:06.480

首先，Server.MapPath 永远不会喜欢“\\servername”，因为那是 Windows 服务器的 UNC 路径，而不是 URL 的一部分。如果你想得到它，这可能有效：

```
fileSystem.GetDrive("\\servername") 
```

其次，如果您真的在寻找一个 URL，它应该是一个以 / 开头的绝对 URL 或一个不带 / 的相对 URL，并且与当前的 .ASP 页面相关。如果您不处理请求，则只能使用绝对 URL。

# sql - 如何从 DTS 对象导出 SQL 语句？

> ID：240719
> 
> 赞同：1
> 
> 时间：2008-10-27T17:25:15.097
> 
> 标签：sql, sql-server, dts

我正在运行 SQL Server 2000，我需要从所有 DTS 对象中导出 SQL 语句，以便在需要时对其进行解析并放入 wiki 文档中。

有没有办法做到这一点？

可能将每个 DTS 对象转储到一个文本文件中，其中对象名称作为文件名，进程名称和提取日期作为文件头。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T17:45:29.567

DTS 包有一个带有对象模型的 API。您可以通过此获取 SQL 文本。在线书籍文档在某种程度上描述了这一点[。](http://msdn.microsoft.com/en-us/library/aa298646(SQL.80).aspx)[您可以通过将 DTS 包保存到 Visual BASIC 文件](http://msdn.microsoft.com/en-us/library/aa216414(SQL.80).aspx)并查看 VB 文件对对象模型的作用 来获取对象模型使用的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T18:46:15.240

如果您想节省一些工作并且不介意花几块钱，那么有一个[工具](http://www.dtsdoc.com)可以完整记录您的 DTS 包。它也输出为 XML，因此获取这些 SQL 语句应该相对容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-01T17:45:01.140

我有一个[Python 2.6](http://www.python.org/)脚本（很容易移植到 Python 2.5），它从已保存为 Visual Basic 代码的 DTS 包中的任务中转储 SQL。

请参阅 ConcernedOfTunbridgeWells 的帖子，了解如何将 DTS 包保存到 VB 文件。保存 VB 文件后，在其上运行此函数。它将在与包含包中代码的 VB 文件相同的位置创建一个文件夹，并将转储它找到的 SQL 代码。它假定 SQL 的输出进入 CSV 文件（请参阅`outExt`参数）或来自“执行 SQL 任务”任务，并在输出文件或 SQL 任务之后命名 SQL 查询。如果您的包没有做任何其他事情，这是一个有用的解决方案。

如果您愿意，请随时清理此代码。

```
# from __future__ import with_statement  # Version 2.5 requires this.
import os, re

def dump_sql(infile, outExt=r'csv'):
    """Parse a DTS package saved as a .bas file, and dump the SQL code.

    Pull out the SQL code and the filename for each task.  This process
    depends on the way that DTS saves packages as VB modules.

    Keyword arguments:
    infile - The .bas file defining a DTS package.
    outExt - The extension (without a period) of the files exported by the
             data pumps in the DTS package. These are used to rename the
             extracted SQL scripts. If an extract file does not use this
             extension, then the whole name of the extract file is used to
             name the SQL script. (default: csv)

    The function produces a folder in the same folder that contains the
    .bas file. It's named like this: if the .bas file is "DTS package.bas",
    then the directory will be named "DTS package_SQL". The SQL scripts are
    stored in this folder.

    """
    #Declare all of the RE's used in the script here.
    basExtRE = re.compile(r'\.bas$', re.IGNORECASE)
    outExtRE = re.compile(r'\.' + outExt + r'$', re.IGNORECASE)
    startTaskRE = re.compile(r'Set oCustomTask(\d+) = oTask.CustomTask')
    startSqlRE = re.compile(
        r'oCustomTask(\d+)\.(?:Source)?SQLStatement = "(.*)"( & vbCrLf)?')
    nextSqlRE = re.compile(
        r'oCustomTask(\d+)\.(?:Source)?SQLStatement = oCustomTask\1\.'
        r'(?:Source)?SQLStatement & "(.*)"( & vbCrLf)?')
    filenameRE = re.compile(
        r'oCustomTask(\d+)\.DestinationObjectName = "(.*)"')
    descripRE = re.compile(r'oCustomTask(\d+)\.Description = "(.*)"')
    invalidCharsRE = re.compile(r'[][+/*?<>,.;:"=\\|]')

    #Read the file
    with open(infile, 'r') as f:

        #Produce the directory for the SQL scripts.
        outfolder = '%s_SQL\\' % basExtRE.sub('', infile)
        if not os.path.exists(outfolder):
            os.makedirs(outfolder)

        taskNum = -1
        outfile = ''
        sql = []

        for line in f:
            line = line.rstrip().lstrip()

            if taskNum == -1:
                #Seek the beginning of a task.
                m = startTaskRE.match(line)
                if m is not None:
                    taskNum = int(m.group(1))
            elif line == '' and outfile != '':
                #Save the SQL code to a file.
                if sql:
                    if os.path.exists(outfile):
                        os.unlink(outfile)
                    with open(outfile, 'w') as fw:
                        fw.writelines(["%s" % sqlQ for sqlQ in sql])
                    print "%2d - %s" % (taskNum, outfile)
                else:
                    print "%2d > No SQL (%s)" % (
                        taskNum, os.path.basename(outfile))
                sql = []
                outfile = ''
                taskNum = -1
            else:
                #Acquire SQL code and filename
                m = startSqlRE.match(line)
                if m:
                    #Start assembling the SQL query.
                    tnum, sqlQ, lf = m.groups()
                    assert int(tnum) == taskNum
                    sql = [sqlQ.replace('""', '"')
                           + ('\n' if lf is not None else '')]
                    continue
                m = nextSqlRE.match(line)
                if m:
                    #Continue assembling the SQL query
                    tnum, sqlQ, lf = m.groups()
                    assert int(tnum) == taskNum
                    sql.append(sqlQ.replace('""', '"')
                               + ('\n' if lf is not None else ''))
                    continue
                m = descripRE.match(line)
                if m:
                    # Get a SQL output filename from the task's
                    # description.  This always appears near the top of the
                    # task's definition.
                    tnum, outfile = m.groups()
                    assert int(tnum) == taskNum
                    outfile = invalidCharsRE.sub('_', outfile)
                    outfile = "%s%s.sql" % (outfolder, outfile)
                    continue
                m = filenameRE.match(line)
                if m:
                    # Get a SQL output filename from the task's output
                    # filename.  This always appears near the bottom of the
                    # task's definition, so we overwrite the description if
                    # one was found earlier.
                    tnum, outfile = m.groups()
                    assert int(tnum) == taskNum
                    outfile = os.path.basename(outfile)
                    outfile = outExtRE.sub('', outfile)
                    outfile = "%s%s.sql" % (outfolder, outfile)
                    continue
    print 'Done.' 
```

# c# - 如何以编程方式阅读 C# 中 WSDL 的文档部分

> ID：240720
> 
> 赞同：1
> 
> 时间：2008-10-27T17:25:19.810
> 
> 标签：c#, .net, web-services, wsdl

我正在使用一个 WSDL 文件来创建一个代理类文件，这个服务有一个很大的枚举。每个枚举值的描述​​都在文档部分，我如何以编程方式阅读该部分？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-27T20:25:50.163

WSDL 文件始终是 XML 文件，因此您可以打开它并读取元素数据。例如，给定[eBay Services WSDL 文件](http://developer.ebay.com/webservices/latest/eBaySvc.wsdl)`COD`，您可以像这样查询枚举值的文档`BuyerPaymentMethodCodeType`：

```
 XmlDocument wsdlDoc = new XmlDocument();
    wsdlDoc.Load(@"D:\temp\eBaySvc.wsdl");

    XmlNamespaceManager nsMgr = new XmlNamespaceManager(wsdlDoc.NameTable);
    nsMgr.AddNamespace("xs", "http://www.w3.org/2001/XMLSchema");

    XmlNode node = wsdlDoc.SelectSingleNode("//xs:simpleType[@name='BuyerPaymentMethodCodeType']/xs:restriction/xs:enumeration[@value='COD']/xs:annotation/xs:documentation", nsMgr);
    string description = node.InnerText; 
```

# asp.net - ASP.NET 网络表单中的 jQuery 自动完成功能？

> ID：240721
> 
> 赞同：1
> 
> 时间：2008-10-27T17:25:50.963
> 
> 标签：asp.net, jquery, webforms

有没有人使用 jQuery 在使用 ASP.NET 网络表单的文本框上填充自动完成列表？如果是这样，任何人都可以推荐一个好的方法吗？从我目前的阅读来看，似乎大多数人都在使用分隔列表而不是 JSON 来恢复项目。我愿意接受任何能让我快速启动和运行的想法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T07:40:51.583

我用 asp.net mvc 做了一个教程，但它应该与传统的 webforms 几乎相同：

[http://blogs.msdn.com/joecar/archive/2009/01/08/autocomplete-with-asp-net-mvc-and-jquery.aspx](http://blogs.msdn.com/joecar/archive/2009/01/08/autocomplete-with-asp-net-mvc-and-jquery.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T18:05:44.423

网上有很多很多例子。我以前用过这个，如果我记得你只需要创建一个 aspx，它将返回匹配的术语作为一个`<BR/>`单独的列表：

[http://www.dyve.net/jquery/?autocomplete](http://www.dyve.net/jquery/?autocomplete)

文档在示例中显示了 php，但插件本身的工作方式没有区别，因此我不必做任何特别的事情。

从文档中：

```
> $("#input_box").autocomplete("my_autocomplete_backend.php"); 
```

> 在上面的示例中，自动完成功能需要一个 id 为“input_box”的输入元素存在。当用户开始在输入框中输入内容时，自动完成程序将使用名为 q 的 GET 参数请求 my_autocomplete_backend.php，其中包含输入框的当前值。假设用户输入了“foo”（不带引号）。然后自动完成将请求 my_autocomplete_backend.php?q=foo。
> 
> 后端应该为自动完成器输出可能的值，每个值都在一行上。输出不能包含管道符号“|”，因为它被视为分隔符（稍后会详细介绍）。
> 
> 一个适当的简单输出是：

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-05T08:51:55.803

我编写了一个 Asp.Net WebControl 和一些包装 JQuery UI 自动完成小部件的 Asp.Net MVC 扩展方法。

我还编写了有关如何实现提供 JSON 结果的工作资源的文档。

您可以在以下位置找到它：

[http://autocompletedotnet.codeplex.com/](http://autocompletedotnet.codeplex.com/)

希望它可以帮助

# comparison - 面向 Web 开发人员的 Windows Azure 与 Amazon EC2

> ID：240724
> 
> 赞同：31
> 
> 时间：2008-10-27T17:26:10.620
> 
> 标签：comparison, amazon-ec2, cloud, azure

我刚刚观看了 Windows Azure 介绍视频，它让我觉得它是托管 IIS 实例的前端外壳。任何了解更多（可能是测试版的一部分）的人都可以解释为什么你会使用这个和 EC2。

它看起来很简单，但实际上并没有具体说明它是如何工作的，为什么它会起作用，或者为什么你会使用它而不是传统的解决方案？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-10-27T17:42:47.417

根据愿景（我只能在这里谈论愿景，因为产品还没有真正推出），这里有几个你可能会考虑使用 Azure 而不是 EC2 的原因。

Azure 包含内置的负载平衡功能。如果你想在亚马逊上这样做，你必须推出自己的解决方案或购买第三方解决方案，如 www.RightScale.com。

Azure 友好编码的应用程序可以在内部或在 Microsoft 的云中交付。如果您编写的应用程序包含财务数据或医疗保健数据等机密信息，则并非所有客户都愿意将他们的数据放在公共云中。在这种情况下，他们可以在 Windows 内部部署您的应用程序。这作为技能组合的胜利出售，因为您可以从公共项目转到私人项目。不要误解我的意思——如果您掌握了 Amazon EC2 开发，那么您可以在数据中心内使用 Linux 虚拟服务器在内部部署您的应用程序，但它不是统包式的。（如果尚未获得许可，很难将技术预览描述为交钥匙，哈哈哈。）

话虽如此，尚不清楚负载平衡功能是否包含在内部部署的盒子中。如果您必须结合使用 Azure 和 ISA Server，那将是更难的部署和管理销售。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-02-24T21:45:36.753

[AppHarbor](http://appharbor.com)是一个位于 Amazon EC2 上的 .NET 云托管环境。好消息是他们提供了一个免费计划（就像 Heroku 所做的那样），所以你可以自己检查一下，几乎没有摩擦。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-27T23:56:42.407

我的公司现在正在使用 Amazon EC2，我正在 PDC 观看有关 Azure 的详细信息。我还没有看到任何可以说服我们离开亚马逊的东西。Azure 看起来确实很吸引人，但事实是我现在可以使用 Amazon 上的 Windows 和 SQL 服务器，并提供 SLA。Ray Ozzie 明确表示，Azure 将根据开发人员社区的反馈做出很多改变。但是，Azure 有很大的潜力，我们将密切关注。

此外，亚马逊将在即将到来的服务更新中添加负载平衡、自动缩放和仪表板功能（请参阅此链接：[http](http://aws.amazon.com/contact-us/new-features-for-amazon-ec2/) ://aws.amazon.com/contact-us/new-features-for-amazon-ec2/ ）。永远不要低估亚马逊，因为他们在云计算方面拥有良好的领先优势，并且已经拥有庞大的用户群来帮助改进他们的产品。永远不要低估微软，因为他们拥有庞大的开发者社区和全球影响力。

总的来说，我不认为一家公司的云服务是相互排斥的。最棒的是，如果我们愿意，我们可以利用所有这些。

微软应该提供在其云中托管基于 Linux 的服务器的能力。那真的会天翻地覆！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-27T17:32:30.513

那么它不仅仅是网络服务。它还允许您托管其他类型的连接应用程序。此外，它还提供对云上其他 MS 软件的集成访问；即 SharePoint、Exchange、CRM、SQL 数据服务，并允许您完全自定义和扩展这些产品，就像在本地托管它们时您可以自定义和扩展它们一样。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-21T12:42:46.753

在去年的 Archtect Insight Conference 上，他们提到他们已经开始改变核心服务器产品以应对大规模故障转移环境，这至少对我来说非常有趣。

它的一堆东西正在进入云端。我认为这更像是云中的平台。

*   Sql 服务器
*   客户关系管理
*   苔藓
*   交换
*   商谈
*   日内瓦（身份）

这里提到的术语是“存储”和“计算”

对我来说，这对 Internet 服务总线的想法很感兴趣。

这也是关于转移到开发工作流程过程。

*   OSLO DSL 和 Qudrant - 转向模型驱动视图
*   实体框架 - 只需单击按钮，即可为开发人员提供代码中的强类型模型
*   使用 MVC 的 ADO 数据服务和数据动态 Web 模板
*   然后使用 Azure 模板和新的“WebRoles”将应用程序部署到云端。
*   然后对于管理员来说，一键式服务器配置非常棒。

关于数据隐私规则......这是房间里的一头大大象，已经被提到......通常每个国家/地区都有关于信息安全的裁决。

英国 RIPA

美国爱国者法案

这些真的在概念上不同吗？无论如何，这两个国家确实共享信息……恕我直言（从法律上讲，它们是不同的，但是对于客户而言，这两项法律都允许访问客户数据，这只是谁的问题）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-27T17:32:53.180

在这一点上，关于 Windows Azure 的信息非常稀缺。我在公告期间参加了主题演讲，此时我的最佳猜测是，他们正在尝试提供比简单托管 IIS 实例更广泛的虚拟化环境。

不过，在这一点上，我不能说更多。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-21T11:59:18.497

我们非常成功地使用 S3 进行存储，并且我一直关注 EC2 以支持 Windows 和 SQL Server。所以现在这些都是可用的，我进一步挖掘。

当我读到这篇文章时我很担心： [http ://www.brentozar.com/archive/2008/11/bad-storage-performance-on-amazon-ec2-windows-servers/](http://www.brentozar.com/archive/2008/11/bad-storage-performance-on-amazon-ec2-windows-servers/)

也许，当我们正在开发有望成为一个非常受欢迎的网站时，我们应该考虑新的数据存储模型——Azure 或亚马逊的 SimpleDB。嗯 - 完全重写！

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-11-01T14:23:20.343

未来的主要区别是 Amazon EC2 从今天 11 月 1 日起免费，请查看。

[http://www.buzzingup.com/2010/10/amazon-announces-free-cloud-services-for-new-developers/](http://www.buzzingup.com/2010/10/amazon-announces-free-cloud-services-for-new-developers/)

# php - 在 OS X 10.5 上带有 Zend 调试器的 PHP

> ID：240725
> 
> 赞同：3
> 
> 时间：2008-10-27T17:27:04.860
> 
> 标签：php, macos, osx-leopard, php-5.2, zend-debugger

我已经使用 PHP 5 和 Apache 2 的预编译版本设置了 OS X 10.5。我正在尝试设置 Zend 调试器，但没有运气。这是我所做的：

*   我下载了`ZendDebugger-5.2.14-darwin8.6-uni.tar`
*   我创建了目录`/Developer/Extras/PHP`并将权限设置为：
    *   权限：`drwxrwxr-x`
    *   所有者：`root:admin`
*   `ZendDebugger.so`我从`5_2_x_comp`目录复制到`/Developer/Extras/PHP`
*   我更新`/etc/php.ini`了文件，添加了以下几行：

    ```
    zend_extension=/Developer/Extras/PHP/ZendDebugger.so
    zend_debugger.expose_remotely=always
    zend_debugger.connector_port=10013
    zend_debugger.allow_hosts=127.0.0.1 
    ```

*   我通过系统偏好设置“共享”面板重新启动了 Apache

当我`phpinfo()`在 PHP 文件中运行时，我没有提到 Zend 调试器。当我从命令行运行`php -m`时，它显示 Zend 调试器已加载。两者都声明他们正在运行相同版本的 PHP，并加载相同的 INI 文件。

有人有其他建议让我试试吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-27T17:53:38.037

如果我没记错的话，这个问题是因为 Zend Debugger 是为 32 位 Apache 编译的，而 Max OS 10.5 附带的 Apache 是为 64 位应用程序编译的。在 Zend 推出 64 位版本之前，您有两种选择：

1）[手动重启Apache进入32位](http://www.entropy.ch/phpbb2/viewtopic.php?t=2905)

2) 在 32 位模式下重新编译 Apache 和 PHP。

我实际上还没有开始这样做，但我认为我倾向于重新编译以避免将来出现问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T21:26:59.110

以 32 位模式重新启动就可以了。对于那些希望能够轻松做到这一点的人，这里有一点 AppleScript：

```
do shell script "apachectl stop" with administrator privileges
do shell script "arch -i386 /usr/sbin/httpd" with administrator privileges 
```

坐在某个地方真是太好了，这样您就可以在需要时快速进入 32 位模式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-20T03:51:24.970

Zend 发布了 Mac OSX 的 64 位版本，所以只需从[http://www.zend.com/en/products/studio/downloads](http://www.zend.com/en/products/studio/downloads)下载文件并照常进行。

您必须注册并回答一些问题，但这对我有用。

祝你好运。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T18:49:12.750

我也是，小时！！非常感谢！！此外，如果由于某种原因您需要在运行后重新启动 apache/httpd（例如，您需要在 php.ini 中进行更改）但是当您运行“sudo arch -i386 /usr/sbin/httpd”时，您会得到这个错误：

(48)地址已在使用：make_sock: 无法绑定到地址[::]:80

在终端窗口中输入：sudo killall httpd

然后“sudo arch -i386 /usr/sbin/httpd”应该可以正常重启apache/httpd。

# java - 在 Java 中制作自定义 Sin() 函数

> ID：240755
> 
> 赞同：2
> 
> 时间：2008-10-27T17:34:34.580
> 
> 标签：java, trigonometry

我必须在我的 Comp Sci 课程中从头开始创建 sin 函数，并且我正在接近解决方案。但是，我仍然遇到一些问题。如果我输入 0.5PI 或更少的值，它会起作用，否则我会得到不正确的结果。这是我到目前为止的代码：

```
double i=1;
double sinSoFar = 0;
int term = 1;
while(i >= .000001)
{
    i = pow(-1, term + 1) * pow(sinOf, 2*term-1) / factorial(2*term-1);
    sinSoFar=sinSoFar + i;
    term++;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-27T17:59:42.360

就像 Federico 指出的那样，问题可能出在您的 factorial() 或 pow() 上。我运行了一个测试，用 Math 类中提供的 pow() 函数和这个 factorial() 替换了你的函数，效果很好：

```
public static long factorial(long n) {
        if      (n <  0) throw new RuntimeException("Underflow error in factorial");
        else if (n > 20) throw new RuntimeException("Overflow error in factorial");
        else if (n == 0) return 1;
        else             return n * factorial(n-1);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-27T17:53:41.187

一些建议：

*   从 term = 0 开始。典型的 MacLaurin 展开式也可以
*   *在您骑车时*计算幂和阶乘（即在每一步更新它们）。也许问题出在 pow() 或 factorial() 之内。

编辑。建议：一旦你计算了第 k 项，你可以通过以下方式计算第 (k+1) 项：

*   乘以 (-1)
*   乘以 sinOf^2
*   除以 (2k+2)(2k+3)

通过这种方式，您可以完全*避免*计算幂和阶乘。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T18:43:16.423

至于 0 - 1/2PI 之外的值，它们都可以从该范围内的值计算出来。

```
// First, normalize argument angle (ang) to -PI to PI, 
// by adding/subtracting 2*PI until it's within range
if ( ang > 1/2PI ) {
    sin = sin ( PI - ang );
}
else if ( ang < 0 ) {
    sin = -1 * sin( -1 * ang );
}
else {
    // your original code
} 
```

# seo - 是否需要 meta type="title" 标签以及标题标签的最佳格式是什么？

> ID：240764
> 
> 赞同：4
> 
> 时间：2008-10-27T17:38:24.103
> 
> 标签：seo, meta-tags, page-title, meta-title

我看到一些网站使用以下标签：

```
<meta type="title" content="Title of the page" /> 
```

当你有一个时需要它`<title>`吗？

另外，页面标题的最佳格式是什么？一些想法：

*   页面说明 :: 公司名称
*   页面描述 - 公司名称
*   页面描述 <> 公司名称
*   公司名称： 页面说明
*   ...

对谷歌/雅虎/等有影响吗？您是否在每页的标题中包含公司名称或网站的一般描述？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-27T18:02:04.790

搜索引擎通常会忽略元标记，就像过去它们用于发送垃圾邮件一样。标题的最佳标签正是`<title>`.

作为标题的最佳格式，没有最佳方法，而是尝试使标题尽可能描述页面的真实内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-01T14:22:46.157

该`<meta type="title">`标签与搜索引擎爬虫几乎没有排名或相关性。好的旧`<title>`标签无疑是[好的网页中最重要的元素](http://www.w3.org/QA/Tips/good-titles)。

至于标题的格式，我觉得[Standards Schmandards 的这篇文章](http://www.standards-schmandards.com/2004/title-text-separators/)有很好的建议：

> 如果标题中包含站点名称，则站点名称应放在标题末尾。这样可以确保在书签文件夹中轻松浏览来自同一站点的多个书签，并且您页面的听众会首先获得最重要的信息。

我强烈建议您*在*每个标题的末尾包含公司名称或站点名称，因为：

1.  一致性总是一个好主意。
2.  Firefox 3 等较新的浏览器允许您按页面标题搜索历史记录和书签，因此用户只需输入您的公司名称或站点名称即可轻松查看他们在您的站点上访问过的所有页面。
3.  如果页面上没有列出，使用屏幕阅读器的人将不知道他们正在访问的网站。

但是，我不会在主页上对网站进行任何描述，因为这会使标题过长，并且会使屏幕阅读器用户感到沮丧，因为他们必须付出额外的努力才能在他们访问的每个页面上跳过该信息。

如果您决定将公司名称放在您的头衔中，请记住以下几点（也来自[Standards Schmandards](http://www.standards-schmandards.com/2004/title-text-separators/)）：

> *   分隔符应该是不同的，以便用户理解它是一个分隔符。（即它不应作为标题中文本项的一部分出现）。
> *   用作分隔符的主要候选者是竖线 (|)、点 (·) 和破折号 (-)。
> *   不管你选择什么字符*，用空格包围它是很重要的*。这将有助于有视力的访客和听众，因为它将字符与标题文本区分开来。

根据此处的所有信息，这基本上使您问题中的第二个示例成为明显的选择：

```
<title>
    Page Description - Company Name
</title> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T18:42:25.753

Meta Robots：此标签享有全面支持，但仅当您不希望您的页面被索引时才需要它。

元描述：这个标签得到了很多支持，非常值得使用。

元关键字：这个标签只被一些主要的爬虫支持，可能不值得花时间去实现。

Meta Else：您看到的任何其他元标记都会被主要爬虫忽略，尽管它们可能会被专门的搜索引擎使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-28T21:27:39.460

是您想要使用的，因为它比大多数搜索引擎的元标记更突出。

我的建议是把重要的关键词放在第一位，避免在主页之外重复你的公司名称，因为这只会稀释标题文本的价值。

# sql - Oracle 计划作业

> ID：240765
> 
> 赞同：3
> 
> 时间：2008-10-27T17:38:26.880
> 
> 标签：sql, oracle, plsql

我有很多类似的 Oracle 工作需要创建，我想以编程方式完成。

Oracle 将作业库（模式/表）存储在哪里？

（是的，我知道我可能会用剪刀跑步）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-27T18:21:54.953

对于[DBMS_JOBS](http://www.psoug.org/reference/dbms_job.html)，您可以使用...

```
dbms_job.submit(
JOB       OUT BINARY_INTEGER,
WHAT      IN  VARCHAR2,
NEXT_DATE IN  DATE           DEFAULT SYSDATE,
INTERVAL  IN  VARCHAR2       DEFAULT 'NULL',
NO_PARSE  IN  BOOLEAN        DEFAULT FALSE,
INSTANCE  IN  BINARY_INTEGER DEFAULT 0,
FORCE     IN  BOOLEAN        DEFAULT FALSE); 
```

对于较新的[DBMS_SCHEDULER](http://www.psoug.org/reference/dbms_scheduler.html)作业，您可以使用...

```
dbms_scheduler.create_job(
job_name            IN VARCHAR2,
job_type            IN VARCHAR2,
job_action          IN VARCHAR2,
number_of_arguments IN PLS_INTEGER DEFAULT 0,
start_date          IN TIMESTAMP WITH TIME ZONE DEFAULT NULL,
repeat_interval     IN VARCHAR2    DEFAULT NULL,
end_date            IN TIMESTAMP WITH TIME ZONE DEFAULT NULL,
job_class           IN VARCHAR2    DEFAULT 'DEFAULT_JOB_CLASS',
enabled             IN BOOLEAN     DEFAULT FALSE,
auto_drop           IN BOOLEAN     DEFAULT TRUE,
comments            IN VARCHAR2    DEFAULT NULL); 
```

我还没有找到使用 SQL 添加网格控制作业的方法。如果答案未在此处显示，我可能会将此作为一个单独的问题提出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-27T17:40:49.793

视图：USER_JOBS、DBA_JOBS 或 ALL_JOBS

# java - Java中的强制可克隆接口

> ID：240774
> 
> 赞同：4
> 
> 时间：2008-10-27T17:40:18.547
> 
> 标签：java, interface, overriding, clone

我在 Java 中遇到了一个小问题。我有一个名为 Modifiable 的接口。实现此接口的对象是可修改的。

我还有一个 ModifyCommand 类（带有命令模式），它接收两个 Modifiable 对象（在列表中进一步交换它们 - 这不是我的问题，我已经设计了那个解决方案）。

ModifyCommand 类首先复制 Modifiable 对象。从逻辑上讲，我让我的 Modifiable 接口扩展了 Cloneable。然后接口定义了一个 clone() 方法，它的实现类必须重新定义。

然后，在 ModifyCommand 中，我可以这样做：firstModifiableObject.clone()。我的逻辑是实现 Modifiable 的类必须重新定义 Object 的 clone 方法，因为它们将是 Cloneable （这就是我想要做的）。

问题是，当我定义类实现 Modifiable 并且我想重写 clone() 时，它不会让我说 Object 类中的 clone() 方法隐藏了 Modifiable 中的方法。

我该怎么办？我的印象是“我做错了”......

谢谢，

纪尧姆。

编辑：它认为我会忘记 clone() 的事情。我将a）假设传递给Modifiable对象（实现接口）的对象已经被克隆或b）创建另一个称为copy（）的方法，该方法基本上会对Modifiable对象进行深层复制（或者通用解决方案可能会起作用......）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-27T18:08:58.300

如果您使用的是 java 1.5 或更高版本，则可以通过以下方式获得所需的行为并删除强制转换：

```
public interface Modifiable<T extends Modifiable<T>> extends Cloneable {
    T clone();
}

public class Foo implements Modifiable<Foo> {
    public Foo clone() { //this is required
        return null; //todo: real work
    }
} 
```

由于 Foo 扩展了 Object，这仍然满足 Object 类的原始约定。由于 Modifiable 接口施加的额外约束，未正确优化 clone() 方法的代码将无法编译。作为奖励，调用代码不必强制转换 clone 方法的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T17:51:21.223

您不需要在接口 Modifiable 上重新定义 clone 方法。

检查文档：http: [//java.sun.com/j2se/1.4.2/docs/api/java/lang/Cloneable.html](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Cloneable.html)

我了解您试图强​​迫所有人覆盖克隆方法（），但您不能这样做。

在另一种方式中，您不能覆盖接口上的类：

clone() 方法始终与 Object.class 相关联，而不是与可克隆接口相关联。您可以在另一个对象上覆盖它，而不是在界面中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-23T06:44:37.147

添加到 Sean Reilly 的答案中，这应该可以解决您的问题，并且类型更安全。它在 JDK6 上编译并运行良好：

```
public interface Modifiable<T extends Modifiable<T>> extends Cloneable {
    T clone();
}
public class Test implements Modifiable<Test> {
    @Override
    public Test clone() {
        System.out.println("clone");
        return null;
    }
    public static void main(String[] args) {
        Test t = new Test().clone();
    }
} 
```

我无法使用 Java 5 对其进行测试，因为我没有安装它，但我想它可以正常工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-27T17:47:37.737

您是否完全按照对象中的方式定义了签名？

```
public Object clone() throws CloneNotSupportedException {
    return super.clone();
} 
```

这应该编译 - 将自定义代码添加到正文。 [维基百科](http://en.wikipedia.org/wiki/Clone_(Java_method))在这方面提供了惊人的帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-27T17:48:37.407

您的克隆方法的方法签名是什么样的？为了匹配 Clonable 接口，它必须返回一个对象。如果您将其声明为返回 Modifiable 则可能是问题所在。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T03:11:52.777

公共类 CloningExample 实现 Cloneable {

```
private LinkedList names = new LinkedList();

public CloningExample() {
    names.add("Alex");
    names.add("Melody");
    names.add("Jeff");
}

public String toString() {
    StringBuffer sb = new StringBuffer();
    Iterator i = names.iterator();
    while (i.hasNext()) {
        sb.append("\n\t" + i.next());
    }
    return sb.toString();
}

public Object clone() {
    try {
        return super.clone();
    } catch (CloneNotSupportedException e) {
        throw new Error("This should not occur since we implement Cloneable");
    }
}

public Object deepClone() {
    try {
        CloningExample copy = (CloningExample)super.clone();
        copy.names = (LinkedList)names.clone();
        return copy;
    } catch (CloneNotSupportedException e) {
        throw new Error("This should not occur since we implement Cloneable");
    }
}

public boolean equals(Object obj) {

    /* is obj reference this object being compared */
    if (obj == this) {
        return true;
    }

    /* is obj reference null */
    if (obj == null) {
        return false;
    }

    /* Make sure references are of same type */
    if (!(this.getClass() == obj.getClass())) {
        return false;
    } else {
        CloningExample tmp = (CloningExample)obj;
        if (this.names == tmp.names) {
            return true;
        } else {
            return false;
        }
    }

}

public static void main(String[] args) {

    CloningExample ce1 = new CloningExample();
    System.out.println("\nCloningExample[1]\n" + 
                       "-----------------" + ce1);

    CloningExample ce2 = (CloningExample)ce1.clone();
    System.out.println("\nCloningExample[2]\n" +
                       "-----------------" + ce2);

    System.out.println("\nCompare Shallow Copy\n" +
                       "--------------------\n" +
                       "    ce1 == ce2      : " + (ce1 == ce2) + "\n" +
                       "    ce1.equals(ce2) : " + ce1.equals(ce2));

    CloningExample ce3 = (CloningExample)ce1.deepClone();
    System.out.println("\nCompare Deep Copy\n" +
                       "--------------------\n" +
                       "    ce1 == ce3      : " + (ce1 == ce3) + "\n" +
                       "    ce1.equals(ce3) : " + ce1.equals(ce3));

    System.out.println();

} 
```

}

# c# - 使用 Graphics.DrawImage 时如何保持来自 Http 处理程序的图像的透明度？

> ID：240777
> 
> 赞同：1
> 
> 时间：2008-10-27T17:40:32.680
> 
> 标签：c#, asp.net, image, gdi+, httphandler

我有一系列需要即时裁剪的 GIF，我在 C# 中使用 HTTP 处理程序，因此我可以更好地封装代码 - 为结果提供缓存等。

`Image`目前，当我通过对象将现有图像绘制到新图像时，`Graphics`所有透明度都会丢失。

我尝试了各种技术来尝试保持透明度，但无济于事。

我尝试过的事情：

*   使用`MakeTransparent (Color)`方法调用
*   使用and`ImageAttriutes`的组合`ColorMap``SetColorKey`

我真的不想开始使用不安全的运算符或 Win32 调用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-28T00:39:09.107

这似乎已经回答了[你如何使用 System.Drawing 绘制透明图像？](https://stackoverflow.com/questions/189392/how-do-you-draw-transparent-image-using-systemdrawing)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-27T18:21:16.373

当我使用透明度时，我一直使用`Bitmap`. IE

```
System.Drawing.Image SourceImage = System.Drawing.Image.FromFile("the.gif");
System.Drawing.Bitmap NewImage = new System.Drawing.Bitmap(SourceImage);
// Do Processing
NewImage.MakeTransparent();
// Store changes
NewImage.Save(..., System.Drawing.Imaging.ImageFormat.Png); 
```

当然，如果您无法远离该`Graphics`对象，那么这可能没有多大用处。

# algorithm - 平行四边形内的随机点

> ID：240778
> 
> 赞同：47
> 
> 时间：2008-10-27T17:40:37.063
> 
> 标签：algorithm, matlab, random, 2d, polygon

我有一个由 2D 中的 4 个点定义的 4 侧凸多边形，我希望能够在其中生成随机点。

如果它真的简化了问题，我可以将多边形限制为平行四边形，但更一般的答案是首选。

生成随机点直到一个点位于多边形内是行不通的，因为它所花费的时间真的无法预测。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2011-12-07T18:18:38.323

The question by the OP is a bit ambiguous so the question I will answer is: **How to generate a point from a uniform distribution within an arbitrary quadrilateral**, which is actually a generalization of **How to generate a point from a uniform distribution within an arbitrary (convex) polygon**. The answer is based on the case of generating a sample from a uniform distribution in a triangle (see [http://mathworld.wolfram.com/TrianglePointPicking.html](http://mathworld.wolfram.com/TrianglePointPicking.html), which has a very nice explanation).

In order to accomplish this we:

1.  Triangulate the polygon (i.e. generate a collection of non-overlapping triangular regions which cover the polygon). For the case of a quadrilateral, create an edge across any two non-adjacent vertices. For other polygons, see [http://en.wikipedia.org/wiki/Polygon_triangulation](http://en.wikipedia.org/wiki/Polygon_triangulation) for a starting point, or [http://www.cgal.org/](http://www.cgal.org/) if you just need a library.

    ![enter image description here](https://i.stack.imgur.com/CYaVQ.png)

2.  To pick one of the triangles randomly, let us assign an index to each triangle (i.e. 0,1,2,...). For the quadrilateral, they will be 0,1\. For each triangle we assign a weight equal as follows:

    ![weight calculation](https://i.stack.imgur.com/Hqvqs.png)

3.  Then generate a random index i from the finite distribution over indexes given their weights. For the quadrilateral, this is a Bernoulli distribution:

    ![enter image description here](https://i.stack.imgur.com/onKl9.png)

4.  Let v0, v1, v2 be vertices of the triangle (represented by their point locations, so that v0 = (x0,y0), etc. Then we generate two random numbers a0 and a1, both drawn uniformly from the interval [0,1]. Then we calculate the random point x by x = a0 (v1-v0) + a1 (v2-v0).

    ![enter image description here](https://i.stack.imgur.com/stTLI.png)

5.  Note that with probability 0.5, x lies outside outside the triangle, however if it does, it lies inside the parallelogram composed of the union of the triangle with it's image after a rotation of pi around the midpoint of (v1,v2) (dashed lines in the image). In that case, we can generate a new point x' = v0 + R(pi)(x - v3), where R(pi) is a rotation by pi (180 deg). The point x' will be inside the triangle.

6.  Further note that, if the quadrilateral was already a parallelogram, then we do not have to pick a triangle at random, we can pick either one deterministically, and then choose the point x without testing that it is inside it's source triangle.

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-10-27T17:43:46.870

A. 如果您可以将输入限制为平行四边形，这真的很简单：

1.  取两个介于 0 和 1 之间的随机数。我们将调用 then`u`和`v`。
2.  如果你的平行四边形由 ABCD 点定义，AB、BC、CD 和 DA 是边，那么你的点是：

    ```
     p = A + (u * AB) + (v * AD) 
    ```

哪里`AB`是从 A 到 B`AD`的向量和从 A 到 D 的向量。

B. 现在，如果你不能，你仍然可以使用重心坐标。对于四边形，重心坐标对应于 4 个坐标`(a,b,c,d)`，使得`a+b+c+d=1`. 然后，`P`四边形中的任何点都可以用 4-uple 来描述，这样：

```
P = a A + b B + c C + d D 
```

在您的情况下，您可以绘制 4 个随机数并将它们归一化，以便它们加起来为 1。这会给您一个要点。请注意，在这种情况下，点的分布不会是均匀的。

C. 您也可以按照其他地方的建议，将四边形分解为两个三角形，并使用半平行四边形方法（即，作为平行四边形，但添加条件`u+v=1`）或三角形的重心坐标。但是，如果您想要均匀分布，则在其中一个三角形中有一个点的概率必须等于三角形的面积除以四边形的面积。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-10-27T18:09:42.170

Assuming you want a uniform distribution: Form two triangles from your polygon. Pick which triangle to generate the point in according to their area ratio.

Call the corners of the triangle A, B, C, the side vectors AB, BC, AC and generate two random numbers in [0,1] called u and v. Let p = u * AB + v * AC.

If A+p is inside the triangle, return A+p

If A+p is outside the triangle, return A + AB + AC - p

(This is basically PierreBdR's formula except for the preprocessing and the last step that folds the point back into a triangle, so it can handle other shapes than parallelograms).

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-27T17:46:16.397

你的多边形是两个三角形，所以为什么不随机选择其中一个，然后在三角形中找到一个随机点。

可能不是最好的解决方案，但它会起作用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-27T17:44:40.830

一种不太“[天真](http://en.wikipedia.org/wiki/Na%C3%AFve_algorithm)”的方法是使用[多边形填充算法](http://alienryderflex.com/polygon_fill/)，然后从填充线上随机选择点。

## C 代码示例

```
//  public-domain code by Darel Rex Finley, 2007

int  nodes, nodeX[MAX_POLY_CORNERS], pixelX, pixelY, i, j, swap ;

//  Loop through the rows of the image.
for (pixelY=IMAGE_TOP; pixelY<IMAGE_BOT; pixelY++) {

  //  Build a list of nodes.
  nodes=0; j=polyCorners-1;
  for (i=0; i<polyCorners; i++) {
    if (polyY[i]<(double) pixelY && polyY[j]>=(double) pixelY
    ||  polyY[j]<(double) pixelY && polyY[i]>=(double) pixelY) {
      nodeX[nodes++]=(int) (polyX[i]+(pixelY-polyY[i])/(polyY[j]-polyY[i])
      *(polyX[j]-polyX[i])); }
    j=i; }

  //  Sort the nodes, via a simple “Bubble” sort.
  i=0;
  while (i<nodes-1) {
    if (nodeX[i]>nodeX[i+1]) {
      swap=nodeX[i]; nodeX[i]=nodeX[i+1]; nodeX[i+1]=swap; if (i) i--; }
    else {
      i++; }}

  //  Fill the pixels between node pairs.
  //  Code modified by SoloBold 27 Oct 2008
  //  The flagPixel method below will flag a pixel as a possible choice.
  for (i=0; i<nodes; i+=2) {
    if   (nodeX[i  ]>=IMAGE_RIGHT) break;
    if   (nodeX[i+1]> IMAGE_LEFT ) {
      if (nodeX[i  ]< IMAGE_LEFT ) nodeX[i  ]=IMAGE_LEFT ;
      if (nodeX[i+1]> IMAGE_RIGHT) nodeX[i+1]=IMAGE_RIGHT;
      for (j=nodeX[i]; j<nodeX[i+1]; j++) flagPixel(j,pixelY); }}}

   // TODO pick a flagged pixel randomly and fill it, then remove it from the list.
   // Repeat until no flagged pixels remain. 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-27T18:09:37.427

By "general" do you mean all non-parallelogram 4-side polygons in general or all possible polygons?

How about drawing a random line connecting the 4 sides e.g. If you have this:

```
.BBBB.
A    C
A    C
.DDDD. 
```

Then generate a random point on a unit square, then mark the point on the line B and D at the percentage of distance on the X axis. Do the same on line A and C using value from the Y axis.

Then connect the point on line A to line C and line B to line D, the intersection point is then used as the random point.

It's not uniform because rounding errors will aid certain points but it should be close if you are working with floating points values.

Implementation should be rather easy, too, since you are already working with polygons. You should already have code that does those simple tasks.

Here's a quick pseudocode:

```
void GetRandomPoint(Polygon p, ref float x, ref float y) {

    float xrand = random();
    float yrand = random();

    float h0 = p.Vertices[0] + xrand * p.Vertices[1];
    float h1 = p.Vertices[2] + yrand * p.Vertices[3];

    float v0 = p.Vertices[0] + xrand * p.Vertices[2];
    float v1 = p.Vertices[1] + yrand * p.Vertices[3];

    GetLineIntersection(h0, h1, v0, v1, x, y);

} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-01-14T03:20:46.327

This works for general, convex quadrilaterals:

You can borrow some concepts from the Finite Element Method, specifically for quadrilateral (4-sided) elements ([**refer to section 16.5 here**](http://www.colorado.edu/engineering/cas/courses.d/IFEM.d/IFEM.Ch16.d/IFEM.Ch16.pdf)). Basically, there is a bilinear parameterization that maps a square in u-v space (for u, v \in [-1, 1] in this case) to your quadrilateral that consists of points p_i (for i = 1,2,3,4). Note that In the provided reference, the parameters are called \eta and \xi.

Basic recipe:

1.  Choose a suitable random number generator to generate well-distributed points in a square 2D domain
2.  Generate random u-v pairs in the range [-1, 1]
3.  For each u-v pair, the corresponding random point in your quad = 1/4 * ((1-u)(1-v) * p_1 + (1+u)(1-v) * p_2 + (1+u)(1+v) * p_3 + (1-u)(1+v) * p_4)

The only problem is that uniformly distributed points in the u-v space won't produce uniformly distributed points in your quad (in the Euclidean sense). If that is important, you can work directly in 2D within the bounding box of the quad and write a point-in-quad (maybe by splitting the problem into two point in tris) test to cull random points that are outside.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-27T17:54:19.283

点是否需要均匀分布，或者任何分布都可以？

Can the polygon be concave, or is it guarenteed to be convex?

If the answer to both the above is no, then pick any two of the vertexes and pick a random point on the line segment between them. This is limited to the line segements connecting the vertexes (ie, VERY non-uniform); you can do a bit better by picking a third vertex and then picking a point between that and the first point -- still non-uniform, but at least any point in the polygon is possible

Picking a random point on a line between two points is easy, just A + p(B-A), where A and B are the points and p is a random number between 0.0 and 1.0

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-27T18:08:34.043

What kind of distribution do you want the points to have? If you don't care, the above methods will work fine. If you want a uniform distribution, the following procedure will work: Divide the polygon into two triangles, a and b. Let A(a) and A(b) be their areas. Sample a point p from the uniform distribution on the interval between 0 and A(a)+A(b). If p < A(a), choose triangle a. Otherwise, choose triangle b. Choose a vertex v of the chosen triangle, and let c and d be the vectors corresponding to the sides of the triangle. Sample two numbers x and y from the exponential distribution with unit average. Then the point (xc+yd)/(x+y) is a sample from the uniform distribution on the polygon.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-01-07T15:50:37.103

The MATLAB function [cprnd](http://www.mathworks.com.au/matlabcentral/fileexchange/34208-cprnd) generates points from the uniform distribution on a general convex polytope. For your question a more specialized algorithm based on decomposing the quadrilateral into triangles is more efficient.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-04-13T12:13:14.313

For PostGIS, this is what I am using (you might want a ward for possible infinite loops). You might export the algorithm to your programming language:

```
CREATE or replace FUNCTION random_point(geometry)
RETURNS geometry
AS $$
DECLARE 
    env geometry;
    corner1 geometry;
    corner2 geometry;
    minx real;
    miny real;
    maxx real;
    maxy real;
    x real;
    y real;
    ret geometry;
begin

select ST_Envelope($1) into env;
select ST_PointN(ST_ExteriorRing(env),1) into corner1;
select ST_PointN(ST_ExteriorRing(env),3) into corner2;
select st_x(corner1) into minx;
select st_x(corner2) into maxx;
select st_y(corner1) into miny;
select st_y(corner2) into maxy;
loop
    select minx+random()*(maxx-minx) into x;
    select miny+random()*(maxy-miny) into y;
    select ST_SetSRID(st_point(x,y), st_srid($1)) into ret;
    if ST_Contains($1,ret) then
        return ret ;
    end if;
end loop;
end;
$$
LANGUAGE plpgsql
volatile
RETURNS NULL ON NULL INPUT; 
```

# database - 如何通过数据库链接执行 Oracle 存储过程

> ID：240788
> 
> 赞同：33
> 
> 时间：2008-10-27T17:43:26.293
> 
> 标签：database, oracle, stored-procedures, database-link

我可以通过数据库链接调用 Oracle 中的存储过程吗？

数据库链接是有效的，因此语法如...

```
SELECT * FROM myTable@myRemoteDB 
```

正在运行。但是有没有语法...

```
EXECUTE mySchema.myPackage.myProcedure('someParameter')@myRemoteDB 
```

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2008-10-27T17:45:39.423

语法是

```
EXEC mySchema.myPackage.myProcedure@myRemoteDB( 'someParameter' ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-02-16T15:27:51.877

检查[http://www.tech-archive.net/Archive/VB/microsoft.public.vb.database.ado/2005-08/msg00056.html](http://www.tech-archive.net/Archive/VB/microsoft.public.vb.database.ado/2005-08/msg00056.html)

需要使用类似的东西

```
cmd.CommandText = "BEGIN foo@v; END;" 
```

在 vb.net，c# 中为我工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-25T17:47:48.080

对我来说，这行得通

```
exec utl_mail.send@myotherdb(
  sender => 'myfromemail@giggle.com',recipients => 'mytoemail@giggle.com, 
  cc => null, subject => 'my subject', message => 'my message'
); 
```

# log4net - log4net 打开数据库连接

> ID：240796
> 
> 赞同：0
> 
> 时间：2008-10-27T17:45:14.590
> 
> 标签：log4net

我正在使用 AdoNetAppender 写入 SQL Server 2005 数据库表。我将 bufferSize 设置为 1，以便立即写入条目。

我的 DBA 担心 log4net 保持其数据库连接处于打开状态。我们今天有大约 50 个与数据库的连接，但只有 22 个日志条目。在某些情况下，来自同一个客户端的多个连接具有不同的登录时间。

在我看来，连接池不起作用，或者我没有在代码中释放资源。我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T18:05:56.373

SQL Server Profiler 将向您展示所有这些。创建一个控制台应用程序，记录一些语句，并验证连接是否打开和关闭。

作为旁注，我建议不要将缓冲区大小设置为 1。对于一个很大的应用程序（让我们看看 NHibernate），它可以轻松地为单个操作记录 100 条或更多语句（取决于日志级别）。这相当于每个请求有 100 个单独的数据库连接，并且很容易使服务器瘫痪。

5 或 10 的缓冲区大小会产生奇迹。当然，您有丢失一些日志消息的风险，但在大多数情况下，它们最终会被刷新（避免断电或硬件故障）。

# c# - 我应该上传到 CodePlex 项目的最少源文件是哪些？

> ID：240832
> 
> 赞同：0
> 
> 时间：2008-10-27T17:53:47.070
> 
> 标签：c#, stylecop, codeplex

我正在寻找改造几个月前开始的旧开源项目。我是一个整洁的狂热者，我真的很努力地“[像女孩一样编码](http://headrush.typepad.com/creating_passionate_users/2006/03/code_like_a_gir.html)”。这就是为什么我一直使用 StyleCop 来监管我的代码，这让我非常高兴。现在由于某种原因，我感觉我在第一次提交时上传了一堆垃圾，所以这次我只想上传实际需要的文件，没有别的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T17:58:43.877

由于它是一个开源项目，我会说所有源文件，至少是你的 csproj 和 .sln 文件。您可以避免签入 .suo 文件，因为这些只是您的 IDE 选项。

# vb.net - 使用 VB.NET 通过字符串名称动态调用属性

> ID：240836
> 
> 赞同：25
> 
> 时间：2008-10-27T17:54:39.377
> 
> 标签：vb.net, reflection, invoke

我目前正在开发一个项目，其中一部分代码如下所示：

```
Select Case oReader.Name
    Case "NameExample1"
        Me.Elements.NameExample1.Value = oReader.ReadString
        ' ...
    Case "NameExampleN"
        Me.Elements.NameExampleN.Value = oReader.ReadString
        ' ...
End Select 
```

它会持续一段时间。代码显然很冗长，*感觉*可以改进。有没有办法在 VB.NET 中动态调用一个属性，这样就可以完成这样的事情：

```
Dim sReadString As String = oReader.ReadString
Me.Elements.InvokeProperty(sReadString).Value = sReadString 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-10-30T06:04:28.153

我不敢相信其他海报告诉你使用反射。VB 作为[CallByName](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualbasic.interaction.callbyname?view=netcore-3.1)函数，完全符合您的要求。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-27T19:33:14.387

其他人的回答非常合理，但如果这是一段对性能敏感的代码，您可能希望将反射调用编译为委托。

我有一篇关于将[MethodBase.Invoke](http://msdn.microsoft.com/en-us/library/system.reflection.methodbase.invoke.aspx)转换为委托的[博客文章。](http://codeblog.jonskeet.uk/2008/08/09/making-reflection-fly-and-exploring-delegates)代码是用 C# 编写的，但同样的技术也可以应用于 VB.NET。要将其与属性一起使用，请使用 PropertyInfo.GetSetMethod 获取适当的“setter”方法，[然后](http://msdn.microsoft.com/en-us/library/system.reflection.propertyinfo.getsetmethod.aspx)构建一个调用该方法的委托。您可以将字段名称映射到“委托调用以设置字段”。

重申一下，只有在对性能至关重要的代码中才真正有必要这样做。否则，您可能仍想创建一个`Dictionary<string, PropertyInfo>`以避免`GetProperty`多次调用，但将其转换为委托的步骤可能不值得担心。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-03-24T18:42:03.630

是的，CallByName 是最适合您的解决方案。这是执行此操作的说明：

```
CallByName(yourClassOrObjectName,"NameExample1",CallType.Set,oReader.ReadString) 
```

您可以写“NameExample”代替“NameExample1”。
提到，第三个参数让你'Get'，'Let'那个参数（甚至调用任何方法）。
因此，您可以使用`CallType.Get`.

# java - autoboxing and performance

> ID：240837
> 
> 赞同：2
> 
> 时间：2008-10-27T17:54:50.077
> 
> 标签：java

I have an application where I perform hundreds of thousands of calculations. Currently all of our values are Doubles. I am utilizing JFormula engine for most of the calculations, and have noticed the api takes a double parameter, so there is some autoboxing taking place when I pass in a Double. I have read some articles, and created some simple tests, and do notice a performance hit, but am still trying to figure out it the time it takes to go through my code and fix this, will be worth any performance improvements. I am wondering if anyone else has had any experience with something similar and performance gains by using primitives?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-27T18:02:47.910

> It is not appropriate to use autoboxing and unboxing for scientific computing, or other performance-sensitive numerical code. -- [Sun FAQ](http://java.sun.com/j2se/1.5.0/docs/guide/language/autoboxing.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-27T18:01:21.687

As well as the other suggestions (which are good - profiling and benchmarking are very important) I'd say that if JFormula is doing *anything* significant within each method call then the boxing/unboxing when making the call is likely to be insignificant. Unboxing in particular is fast as it doesn't require any memory allocation - just copying the existing value from the box, really.

In short: certainly do the tests, but I wouldn't *expect* the hit to be significant.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T17:58:53.347

What you can try is to make simple benchmarks with and without autoboxing. run them through a time-profiler (visualvm recommended). Find the time difference and scale it to your program to find approximate time hit in your program

# asp.net - Asp.net Usercontrol LoadControl 问题

> ID：240850
> 
> 赞同：15
> 
> 时间：2008-10-27T17:58:28.527
> 
> 标签：asp.net, user-controls, loadcontrol

我在使用时遇到问题`LoadControl( type, Params )`。让我解释...

我有一个超级简单的用户控件（ascx）

```
<%@ Control Language="C#" AutoEventWireup="True" Inherits="ErrorDisplay" Codebehind="ErrorDisplay.ascx.cs" EnableViewState="false" %>

<asp:Label runat="server" ID="lblTitle" />
<asp:Label runat="server" ID="lblDescription" /> 
```

后面有代码（ c# ）：

```
public partial class ErrorDisplay : System.Web.UI.UserControl
{

    private Message _ErrorMessage;    

    public ErrorDisplay()
    {
    }

    public ErrorDisplay(Message ErrorMessage)
    {
        _ErrorMessage = ErrorMessage;
    }    

    protected override void OnPreRender(EventArgs e)
    {
        base.OnPreRender(e);

        if (_ErrorMessage != null)
        {
            lblTitle.Text = _ErrorMessage.Message;
            lblDescription.Text = _ErrorMessage.Description;
        }
    }
} 
```

在我的 Web 应用程序的其他地方，我使用以下代码将用户控件的实例添加到页面：

```
divValidationIssues.Controls.Add(LoadControl(typeof(ErrorDisplay), new object[] { MessageDetails })); 
```

我正在使用 LoadControl 的重载版本，因为我想将 Message 参数传递给构造函数。这一切*似乎*工作正常。

但是，当在`OnPreRender()`ErrorDisplay 用户控件上触发时， lblTitle 和 lblDescription 变量都是`null`，尽管它们具有等效的标记。消息变量已正确填充。

谁能解释为什么会发生这种情况？

谢谢

**编辑：**

为清楚起见，我还将添加以编程方式将用户控件添加到页面的代码正在运行以响应按钮按下，因此“托管页面”已通过 Init、Page_Load 进行，现在正在处理事件处理程序。

我无法在早期的 asp 生命周期阶段添加用户控件，因为它们是为响应按钮单击事件而创建的。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-27T18:41:45.787

我也尝试过以下代码 - 产生相同的结果（即 lblTitle 和 lblDescription 均为空）

```
protected void Page_Load(object sender, EventArgs e)
{
    if (_ErrorMessage != null)
    {
        lblTitle.Text = _ErrorMessage.Message;
        lblDescription.Text = _ErrorMessage.Description;
    }
} 
```

我的理解是 LoadControl 函数将它正在加载的控件带到包含它的页面的当前“状态”。因此 Init、Page_Load 等都作为 LoadControl 调用的一部分运行。

有趣的是，这个（未回答的）asp.net 论坛帖子与我遇到的问题相同。

[MSDN 论坛帖子](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=2333625&SiteID=1)

另外——来自 MSDN：

> 当您将控件加载到容器控件中时，容器会引发所有添加的控件的事件，直到它赶上当前事件为止。但是，添加的控件无法赶上回发数据处理。要使添加的控件参与回发数据处理（包括验证），必须将控件添加到 Init 事件而不是 Load 事件中。

因此 LoadControl 不应该正确初始化控件吗？

**编辑：**

好的，所以我在这里回答我自己的问题..

我找到了我在上面链接到的论坛帖子的回答版本[这里](http://forums.asp.net/t/1174838.aspx)

本质上，答案是`LoadControl( type, params )`无法推断要解析的“page infront” ascx，因此它不会打扰初始化任何控件。当您使用该`LoadControl( "ascx path" )`版本时，它会在前面给出页面，因此会进行所有解析和初始化。

所以总而言之，我需要更改初始化控件的代码并将其拆分为单独的部分。IE

```
Control ErrorCntrl = LoadControl("ErrorDisplay.ascx");
ErrorCntrl.ID = SomeID;
(ErrorCntrl as ErrorDisplay).SetErrorMessage = MessageDetail;
divErrorContainer.Controls.Add(ErrorCntrl); 
```

它应该可以正常工作。它不像我之前的尝试那样整洁，但至少它会起作用。

我仍然愿意接受改进上述内容的建议。

干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-27T18:17:18.283

同意 Mitchel 的观点，您应该能够在控件代码本身中放置一个 page_load，它会在控件完全可用后触发。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T21:49:41.587

好吧，在您运行构造函数并将控件添加到页面后，总会添加您自己的加载事件并调用它，但它与您所拥有的并没有太大不同，尽管我可能出于风格原因选择它。

很高兴您找到了问题的答案！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-26T14:46:25.973

[这](http://www.grumpydev.com/2009/01/05/passing-parameters-using-loadcontrol/)是 Steven Robbins 写的博客文章。该帖子解释了如何使用 为用户控件传递参数`LoadControl`，类似于将`LoadControl(Type, object[])`要执行的操作，**但它可以工作**:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-20T15:29:01.397

我对日历控件 DayRender 事件有类似的问题，因为我想将用户控件添加到 e.Cell.Controls 集合。在尝试了几种失败的方法后，用户控件 page_load 未触发或 ascx 上的列表框抛出空异常，我发现如果我使用 LoadControl(ascx) 初始化表单上的控件，然后开始访问标记控件上ascx，一切正常。这种方法根本不依赖于 ascx 上的 Page_Load 事件。

ASCX 标记

后面的代码

公共类 CPCalendarCell 继承 System.Web.UI.UserControl

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

End Sub

Public Sub Add(txt As String)
    Dim li As New ListItem(txt, txt)
    lstDay.Items.Add(li)
End Sub 
```

结束类

页面 ASPX 标记

表单上的日历 DayRender 事件背后的代码

```
Private Sub Calendar1_DayRender(sender As Object, e As System.Web.UI.WebControls.DayRenderEventArgs) Handles Calendar1.DayRender
    Dim div As CPCalendarCell = LoadControl("~/UserControls/CPCalendarCell.ascx")
    div.ID = "dv_" & e.Day.Date.ToShortDateString.Replace(" ", "_")

    **e.Cell.Controls.Add(div)**

    div.Add(e.Day.Date.Month.ToString & "/" & e.Day.Date.Day.ToString)
    div.Add("Item 1")
    div.Add("Item 2")
    e.Cell.Style.Add("background-color", IIf(e.Day.IsWeekend, "whitesmoke", "white").ToString)
End Sub 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-27T18:02:03.433

根据 asp.net 页面生命周期，您的控件没有完全添加到预渲染中，为什么不直接加载 page_load 中的值？

# .net - 会使用堆栈 比列表好 就.NET的内存使用而言

> ID：240863
> 
> 赞同：3
> 
> 时间：2008-10-27T18:01:07.413
> 
> 标签：.net

因此，在 .NET 应用程序中，我有大约 200 万个项目需要将它们保存在内存中以进行处理，1 对 1，将这些项目保存在 Stack 集合中，比将它们保存在 List 集合中更好，假设每次从堆栈对象中弹出一个项目时，堆栈对象使用的内存将保持最小化，或者堆栈分配的内存将保持不变，直到堆栈设置为空或清除。

抱歉，如果我不能以正确的方式表达这个问题.. 但这是另一种方式，当使用 Stack 集合时，每次从堆栈中拉出项目时，堆栈使用的内存是否会最小化。

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-27T18:03:09.233

如果您确实想要 FILO 行为，它们基本上是相同的`Stack<T>`- 因为当您从 a 的末尾删除一个元素时，`List<T>`它不需要复制任何内容。

现在，如果您在谈论 a `Queue<T>`，那将是不同的 - 从a的*头部*`List<T>`删除涉及复制其余项目，这是低效的。

它们中的任何一个的实际内存使用情况都是相同的——我不相信或者`List<T>`在`Stack<T>`删除元素时自动“修剪到大小”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-27T18:04:33.163

没有不同。Stack 的“Pop”方法永远不会减小内部数组的大小。当达到限制时，“推”方法将大小加倍。

我使用[.NET Reflector](http://en.wikipedia.org/wiki/.NET_Reflector)发现了这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T18:15:02.207

从堆栈中弹出一个对象将从堆栈中删除对该对象的引用。然后，由垃圾收集器决定何时释放内存。*但是，根据对象，您可以在每次循环迭代后调用.Dispose* () 以释放对象正在使用的任何未管理的资源，这可能对您的情况有帮助，也可能没有帮助。如果您使用自己设计的类，它可以实现[IDisposable](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx)以提供此功能。

正如另一位发帖者指出的那样，Pop 永远不会自动减少它分配的内存量，但它可能会通过调用 Stack 的[TrimExcess()](http://msdn.microsoft.com/en-us/library/ms132388.aspx)方法来强制这样做。您可以将其称为每 100 次迭代以释放堆栈正在使用的内存。Stacks 的另一个好处是 Pop() 始终是 O(1) 操作。

减少内存使用的另一种方法是一次只加载 1000 个对象，然后在遍历这些对象后加载下一个 1000 个对象，然后重复直到所有对象都已加载。

# c++ - 有没有一种简单的方法来使用基类的变量？

> ID：240874
> 
> 赞同：3
> 
> 时间：2008-10-27T18:04:03.133
> 
> 标签：c++, inheritance, variables

当您有派生类时，是否有一种更简单的方法可以从以下方法中引用变量：

```
BaseClass::variable 
```

**编辑**
碰巧，我找到了一个使用函数来解释此问题的页面： [Template-Derived-Classes Errors](http://www.parashift.com/c++-faq-lite/templates.html#faq-35.19)。显然，在使用模板类时会有所不同。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-27T18:05:44.110

如果基类成员变量是受保护的或公共的，那么您可以在派生类的任何成员函数中按名称引用它。如果它是基类私有的，编译器根本不会让派生类访问它。例子：

```
 class Base
{
protected:
  int a;

private:
  int b;
};

class Derived : public Base
{
  void foo()
  {
    a = 5;  // works
    b = 10; // error!
  }
}; 
```

对于保持所有成员变量私有，并根据需要提供 getter 和 setter，还有一些话要说。

另外，请注意“隐藏”数据成员：

```
 class Base
{
public:
  int a;
};

class Derived : public Base
{
public:
  int a;
}; 
```

这将创建两个名为 的变量`a`：一个 in `Base`，一个 in `Derived`，并且可能会导致混淆和错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T18:16:06.603

相关：[在 C++ 中使用“super”](https://stackoverflow.com/questions/180601/using-super-in-c)

# c++ - 如何在 C++ 中打印非常大的数字

> ID：240876
> 
> 赞同：6
> 
> 时间：2008-10-27T18:04:18.983
> 
> 标签：c++, biginteger, limits

我有这个代码

```
#include <iostream>

using namespace std;

int main(int argc,char **argv) {

    unsigned long long num1 = 99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999995LL;
    unsigned long long num2 = 99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999996LL;
    unsigned long long num3 = 99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999997LL;
    unsigned long long num4 = 99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999998LL;
    unsigned long long num5 = 99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999LL;

    cout << (unsigned long long)(num1 * num2 * num3 * num4 * num5) << endl;
    return 0;
} 
```

如您所见，数字很大，但是当我在那里进行数学运算时，我得到了：18446744073709551496

在编译时，我收到以下警告：

```
warning: integer constant is too large for its type|
In function `int main(int, char**)':|
warning: this decimal constant is unsigned only in ISO C90|
... 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-27T18:08:00.190

您的结果大于 long long 类型 - 您需要查看[BigInteger](http://mattmccutchen.net/bigint/)或任意精度库，例如[gmp](http://gmplib.org/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-27T18:07:48.490

这些数字不适合任何 C++ 数据类型。如果您只想打印它们，请将数字存储在字符串中。如果您想对其进行数学运算，请找到一个任意精度的数学库并使用它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-27T19:22:51.147

如果您希望在代码中使用这么大的文字，则必须将它们作为字符串文字输入并将它们加载到某种 BigInt 类中。现在没有办法在源代码中表达这么大的整数文字（尽管 C++0x 有望解决这个不足）。

如果您使用的是[BigInteger](http://mattmccutchen.net/bigint/)库，请查看用于从字符串构建大整数的`stringToBigUnsigned`函数。`BigIntegerUtils.hh`

```
#include "BigUnsigned.hh"
#include "BigIntegerUtils.hh"     

 BigUnsigned  num1 = stringToBigUnsigned (
    "99999999999999999999999999999999999999999999999999999999999999999999999999999999"
    "99999999999999999999999999999999999999999999999999999999999999999999999999999999"
    "99999999999999999999999999999999999999999999999999999999999999999999999999999999"
    "99999999999999999999999999999999999999999999999999999999999999999999999999999999"
    "99999999999999999999999999999999999999999999999999999999999999999999999999999999"
    "99999999999999999999999999999999999999999999999999999999999999999999999999999999"
    "99999999999999999999999999999999999999999999999999999999999999999999999999999999"
    "99999999999999999999999999999999999999999999999999999999999999999999999999999999"
    "99999999999999999999999999999999999999999999999999999999999999999999999999999999"
    "99999999999999999999999999999999999999999999999999999999999999999999999999999999"
    "99999999999999999999999999999999999999999999999999999999999999999999999999999999"
    "99999999999999999999999999999999999999999999999999999999999999999999999999999999"
    "99999999999999999999999999999999999995"
    ); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-28T00:58:12.780

你想做什么？您了解二进制和十进制数的基础知识吗？为什么 8 位只保存 0 到 255、12 位 0 到 4095 等值？保存您感兴趣的数字需要多少位？或者更好的是，您有兴趣创建多大的数字？您是否使用 9 来使数字更大？十六进制 0xF... 怎么样？如果您想要最大的无符号数（在标准整数类型之一内），为什么不：

unsigned long long a,b;

a = -1; //混合有符号和无符号似乎是错误的，但它是有效的，数字在存储之前转换为无符号

b = 0; b--; //做和上面一样的事情

你真的需要那个级别的精度吗？您意识到乘法可能需要两倍于每个操作数大小的结果吗？0xFF * 0xFF = 0xFE01，如果在这种情况下您使用的是 8 位整数，则无法进行数学运算。当您继续乘以 0xFF * 0xFF * 0xFF = 0xFD02FF 时，情况只会变得更糟。

想做什么？

* * *

看到你的回复：

我以前没有见过 8 号欧拉。听起来像是一个很好的面试问题，因为它只需要几行代码就可以解决。

* * *

您的其他回复：

数字...

可能是因为我们有 10 个手指（也许还有 10 个脚趾），所以我们以“10 基数”长大。我们的时钟大部分以 60 为基数，但它已与以 10 为基数混合，以使其更加混乱。无论如何，以 10 为底，意味着对于每个数字占位符，您有 10 个唯一数字之一，当您达到该位置的最大值时，您将滚动到下一个位置。这都是小学的东西。

000
001
002
003
...
008
009
010
011
012
...

看看最右边的数字如何有 10 个符号（0、1、2、3、4、5、6、7、8、9），当它到达最后一个符号时，它会重新开始，左边的数字增加一。此规则适用于所有基本编号系统。

除了只有两个符号 0 和 1 之外，对于底数 2 是正确的

000
001
010
011
100
101
...

八进制也是如此，但有 8 个符号 (0,1,2,3,4,5,6,7)

000
001
002
003
004
005
006
007
010
011
012
013
...

十六进制也是如此，16个符号（0,1,2,3,4,5,6,7,8,9,a,b,c,d,e,f）

000
001
002
003
004
005
006
007
008
009
00a
00b
00c
00d
00e
00f
010
011
012
013
...

我正要讨论在计算机中使用二进制而不是其他基数（如 10）的原因。底线很容易有两种状态开或关，或高和低。两种状态就像基数 2 中的两个符号 1 和 0。试图在可用电压范围内将电子设备调整到两个以上的状态是很困难的，至少以前是这样，将其保持在零伏附近或高于一些小伏特是相对容易，所以数字电子使用两种状态，二进制。

即使是一个简单的二进制任务也是冗长的，简单的二年级数学仍然有很多 1 和 0。因此八进制变得流行，因为它允许您以三位为一组进行思考，并且您可以使用我们熟悉的符号作为数字 0、1、2、3、4、5、6、7。但是四组是 2 的另一个幂，它比八进制赋予人类更多的心理计算能力，十六进制基于 4 位，这也是 2 的幂。我们必须在我们借用的 10 个符号中添加更多符号传统的阿拉伯文以 10 为基数，因此使用了字母表的前 6 个。八进制很少使用，如果他们认为八进制而不是十六进制，您可以告诉他们年龄。（我来自十六进制一代，但与八进制一代的人一起工作，因为他们无法在他们的脑海中从八进制到二进制再到十六进制）。

计算机中的以 10 为基数就像人类在十六进制中的平均思维。计算机不以 10 为基数（对于他们曾经使用 bcd 的懒人来说很好），它们以 2 为基数。计算机中的十进制数 1234 实际上是 0x4D2 或 0b010011010010。那是一个值，假设您要添加 1234 加上一些其他数字，您需要该值与符号 1、2、3 和 4 无关。但是要在 stackoverflow 上发布此答案，我们不使用我们的数字使用 ASCII，所以 ascii 中的 1234 是 0x31、0x32、0x33、0x34，假设 1000 位数字作为 ascii 字符串提供，这对于您的 euler 解决方案很重要，它必须是，否则您必须转换它从二进制到 ascii，因为问题是一个以 10 为底的问题，而不是根据定义以 2 为底的问题。

所以回到我问的问题。假设你有 4 位内存来存储一个数字，你能存储多大的数字？如果您认为仅以 10 为底，您可能会认为该数字是 9，因为您被训练认为在每个存储位置中使用最大的符号，如果您有 5 个以 10 为底的存储位置，则 99999 是最大的数字。回到四位但是，单个位的最大符号是 1，将该数字放入每个存储位置，您会得到 1111（四个 1）。只需查看这四个，您就应该能够在脑海中轻松看到相同数字 17 八进制或 F hex 的八进制和十六进制版本。要查看十进制需要数学，或者在这种情况下记忆，该数字是十进制的 15。所以你可以拥有的最大四位数是 0xF 或 15 而不是 9。8 位数呢？0xFF 或 255（2 的 8 次方减一）。最大的 16 位数字？65535等

所以当我问你要使用多少位时，这就是我的意思。看看这个数字 99999。再次以 10 为底，你会认为这是最大的数字，但对于计算机来说，它只是其中的一部分，十进制的 99999 是 0x1869F，它需要 17 位内存来存储，这是你可以存储的最大 17 位数字store 是 0x1FFFF，即 131071，比 99999 大一点。因此，当您想在计算机上考虑大数和数学时，您必须考虑二进制（或十六进制）。

最初你在做乘法，这仍然是欧拉问题的一部分，但我问的是与精度和位存储有关的问题。以下是一些基础知识，我不会深入探讨，但您可以了解为什么我们依赖计算机中的浮点单元。

取最大的 4 位数字 1111（二进制），即十进制的 15。加上最大的四位数，你得到 15+15 = 30 = 0x1E 或 11110 二进制。因此，要添加两个四位数字，您需要五个位来保存您的答案。计算机为这个额外的位保留一个“进位”位。本质上，计算机中的加/减整数数学函数允许您拥有 N+1 位。因此，如果它是一台 32 位计算机，则基本上有 33 位用于加/减数学。

问题是乘法和除法，即使在今天，许多处理器也不支持（是的，许多处理器没有 fpu，只做加减法，有时乘法，但除法很少见。乘法和除法需要很多电子设备，但要权衡的是你可以用软件中的加法和减法来做它们）。以四位系统的最坏情况乘法 1111 * 1111 = 11100001 因此需要 8 位来存储 4 位乘法的结果，你会很快发现，如果你有一个 4 位系统，你想要做的乘法的大部分将产生一个无法以 4 位存储的数字。因此，当我看到您采用 64 位整数（无符号 long long 通常为 64 位）并乘以四次时，这意味着您需要 64*5 或 320 位整数来存储您的答案，您试图将答案放入64 大结果，这很常见，

浮点数只不过是科学计数法，而是二进制，如果你想用科学计数法将数字 1234 和 5678 相乘，你需要 1.234*10^3 乘以 5.678*10^3 并得到 7.007*10^6。你保持你的精确度，并且能够代表更广泛的数字。我不会讨论它是如何在二进制中工作的。但这不适用于您的原始问题。

啊，最后一件事澄清我在我的问题/回复中做了什么。二进制中的负整数。由于加减法和基本系统之间的关系，您可以玩一些技巧。假设我想使用二进制从数字 7（十进制）中减去 1。好吧，没有减法电路之类的东西，而是添加一个负数，因此实际上不是 7 - 1，而是 7 + (-1)，它会有所不同：

0111 + ???? = 0110

你可以将什么数字加到 7 以得到 6...二进制？

0111 + 1111 = 0110

二进制中的负数称为“二进制补码”，长话短说答案是“反转并加 1”。你如何用二进制表示负1？取加一个 0001 然后反转它意味着使一个为零和零一个（也称为补码）1110 然后加一个 1111。减一是计算机中的一个特殊数字（无处不在），无论你有多少位它表示为全1。所以当你看到有人这样做时：

无符号字符 a;

a = -1;

编译器首先查看 -1 并认为 ...11111(binary) 然后查看等号和另一边，哦，您希望 a 全部为 1，它看到您有一个有符号整数和一个无符号整数但转换只是将位移动，所以你在上面说你想要 a = 0xFF; （假设一个 8 位无符号字符）。

一些编译器可能会抱怨您试图将负数存储在无符号数中。其他编译器将查看 -1 并将其视为 32 位，或者这些天可能是 64 位有符号整数常量，然后当它将等于计算为 8 位无符号时，您将收到警告，您不能将 -1 存储在有符号中或无类型转换的无符号字符。但如果你这样做：

a = 0; 一种 - ;

所有编译器都会喜欢这样。并且不会抱怨，它只是在运行时而不是编译时消耗计算周期。

现在在某个地方，一位朋友告诉我一本连续进行二进制数学的书。例如，要否定一个数字，通常你会做反转和广告一个技巧，但用铅笔和纸有些人可能会告诉你另一个技巧。从右边开始复制零直到并包括第一个 1，然后反转，所以减去 2

0010
1110

从右边开始复制 0 然后是第一个，然后向左反转剩余的位。

负 6

0110
1010

负 4

0100
1100

据说有一些技巧可以做加法和减法（嗯，这些很容易），但也有乘法和除法。如果您连续执行它们，那么您可以使用相同的 alu 以二进制方式进行无限长的数学运算。如果您知道如何做到这一点，您可以在软件中实现它，并且您最初的乘以大常数的问题（假设保留所有精度）在任何计算机上都是微不足道的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-27T19:16:03.283

您得到的答案 18446744073709551496 是由于您的 999...9 在分配给 long long 时被截断，加上多个操作溢出。它是确定性的，但实际上只是位的随机集合。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-27T18:07:00.397

unsigned int 表示系统字。今天，这个词的最大值将是 2^32 -1 或 2^64 - 1，这取决于您的系统是 32 位还是 64 位。你正在击中上限。

您必须编写一个 bignum 类或使用一个脱离网络的类。

你为什么要做这个问题呢？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-17T11:16:39.303

这些数字不适合`unsigned long long`范围，因此您可以使用 GMP 库或使用字符串来表示大数字，就像我在计算 50 等数字的阶乘时所做的那样：

[http://codepad.org/bkWNV0JC](http://codepad.org/bkWNV0JC)

```
#include <cmath>
#include <iostream>
using namespace std;
int main()
{
  unsigned int nd, nz;   
  unsigned char *ca;   
  unsigned int j, n=50, q, temp;
  int i;
  double p;
    p = 0.0;
    for(j = 2; j <= n; j++)
    {
      p += log10((double)j);  
    }
    nd = (int)p + 1;

    ca = new unsigned char[nd+1];
    if (!ca)
    {
      cout << "Could not allocate memory!!!";
      exit(0);
    }
    for (i = 1; (unsigned)i < nd; i++)
    {
      ca[i] = 0;
    }
    ca[0] = 1;

    p = 0.0;
    for (j = 2; j <= n; j++)
    {
      p += log10((double)j);   
      nz = (int)p + 1;        
      q = 0;                  
      for (i = 0;(unsigned) i <= nz; i++)
      {
        temp = (ca[i] * j) + q;
        q = (temp / 10);
        ca[i] = (char)(temp % 10);
      }
    }

    cout << "\nThe Factorial of " << n << " is: ";
    for( i = nd - 1; i >= 0; i--)
    {
      cout << (int)ca[i];
    }
  //  delete []ca;    
  return 0;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-11-23T07:57:48.350

如果您可以使用 Boost，则可以尝试[cpp_int](https://www.boost.org/doc/libs/1_71_0/libs/multiprecision/doc/html/boost_multiprecision/tut/ints/cpp_int.html)。它可能比 GMP 慢一点，但它只是一个标头库。

```
#include <boost/multiprecision/cpp_int.hpp>
#include <iostream>

int main()
{
   using namespace boost::multiprecision;
// Repeat at arbitrary precision:
   cpp_int u = 1;
   for(unsigned i = 1; i <= 100; ++i)
      u *= i;

   // prints 93326215443944152681699238856266700490715968264381621468592963895217599993229915608941463976156518286253697920827223758251185210916864000000000000000000000000 (i.e. 100!)
   std::cout << u << std::endl;

   return 0;
} 
```

# database - 在 Web 应用程序中，如何使数据库结构保持最新？

> ID：240886
> 
> 赞同：6
> 
> 时间：2008-10-27T18:06:00.663
> 
> 标签：database, model

如果您的数据在应用程序部署后发生变化，您如何使数据库保持最新？

我的意思是，您可以添加或删除表格，这是一项简单的任务。更改现有表也很简单。但是如果你经常改变结构，你如何控制它呢？

我曾经在数据库中保留一个包含当前数据库版本的表。然后每次升级都是一个执行其工作的 SQL 文件——创建新表、添加列或移动数据。文件以这些版本命名 - 因此，如果我的升级脚本获得了数据库版本 10，它只需将所有文件从 11.sql 带到 N.sql 并同时应用每个递增数据库版本号。

这似乎工作正常，但我想知道 - 你对这些任务的策略是什么？
此外，如果我在一个“补丁”中对表进行规范化，然后出于任何原因再次对其进行非规范化，那么这个系统似乎并不完美。然后它做了两次。

但是，每次更改某些内容时都编写完整的升级脚本似乎很痛苦，而且容易出错。至少比这样的原子变化还要多。

此外，我可以期待不同的客户随时运行不同的数据库版本，所以我真的应该有办法从任何时候开始。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-27T18:11:22.197

就我个人而言，我使用的过程与您列出的过程非常相似，我可以看到您关于更改的论点，但我很少进行更改，然后在生产站点上将其更改回旧方式。在测试中，是的，会发生这种情况，但就实际生产站点而言，我认为这没什么大不了的。

保留单独的版本脚本，恕我直言，不仅有利于部署，而且有利于提供可以签入源代码控制的项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-27T18:20:47.700

许多框架使用“迁移”的概念——将数据库模式从一个修订版升级到下一个更高修订版的脚本。同样，降级脚本通常也很有用，以防您需要取消更改。有时这些脚本在 SQL 中，有时它们是抽象的（例如 Ruby on Rails）。您可以手动设计这些脚本，也可以使用其他人提到的 SQL Compare 之类的工具。

在您的数据库中创建一个一列一行的表来指示架构修订也很有帮助。一些支持迁移的框架依赖于此来了解要应用哪些迁移脚本来升级或降级架构。

您的应用程序应该有一套可以运行以验证应用程序功能的测试。您还可以向该套件添加功能测试，以检查架构并确认预期的表、列、过程等是否存在。当你修改项目时，修改测试。正如必须在源代码控制中跟踪应用程序功能的测试以及它们测试的代码一样，必须跟踪模式结构的测试。

最后，数据库设计构成了应用程序设计的基础。在部署之前，适当的软件工程应该会产生一个相对稳定的数据库模式。对数据库模式的后续更改应该既小又不频繁。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-27T18:32:03.620

首先，我们引入了一个版本表，该模式跟踪设置了模式的应用程序的版本号，并且我们跟踪每个单独的表的版本。我们有一个架构版本，我们将其硬编码到应用程序中以检查此应用程序版本。我们不希望应用程序访问错误版本的数据库。然后，我们为从以前的表版本迁移到当前版本的每个表都有一组脚本。然后，我们有一个嵌入应用程序的目标表，以了解每个表在新版本中的预期版本，以查看我们是否匹配所有内容。如果没有，我们将各种迁移脚本应用到模式中，以使数据库达到标准。

复杂？有些。救命。绝对。没有什么比在应用程序中追逐错误更重要的了，因为架构是错误的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-27T18:12:00.247

您应该研究一个名为 Powerdesigner 的工具。您可以下载 15 天的全面运行试用版。它将帮助您建模、使更改保持最新等。

这是一个很好的工具，可以满足您的要求以及更多功能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-27T18:15:08.693

我们在版本控制存储库中为每个版本创建一个目录。我们编写了一个脚本来读取该文件夹中的脚本并按文件名顺序运行它们（因此我们编写的脚本名称为 32.0.0_AddColumnXxxxYyyy）。这种点分格式允许我们根据需要将脚本插入到序列中。

当我们更新站点时，会检测并运行新脚本。这比 SQL Compare（我非常喜欢它）之类的工具具有优势，因为我们可以对数据进行一次性修改。但是，我们会在更新*后*运行 SQL 比较和 SQL 数据比较（在选定的表上），以确保该过程正常工作。成功运行后，将提交整个操作，并且数据库会更新“运行脚本”信息，因此这些脚本不会再次运行。

这样做的好处是我们不能“忘记”一个脚本。此外，当我们尝试滚动到测试或暂存数据库时，我们经常会发现隐藏的假设，即备用数据集在它到达生产之前就已经被找出来了。

这样做的另一个好处是，我们可以为不同的客户保留不同功能级别的各种安装，但是当我们进行升级时，所有脚本都已就位并准备好运行。我在这个方案中遇到的唯一问题是一个“乱序”补丁被应用到用户的数据库......您必须编写脚本来检测原始状态是否*符合预期*，如果不是则中止。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-27T18:34:23.617

您可能应该阅读 Atwood 在 DB 版本控制上写的关于编码恐怖的文章：[您的数据库是否处于版本控制之下？](http://www.codinghorror.com/blog/archives/000743.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-27T18:10:15.537

使用 RedGate 的 SQLCompare 或 xSQL Software 的 xSQL Object 等工具即时生成差异/增量 T-SQL 脚本。

如果您愿意，您甚至可以将其集成为构建过程的一部分。

对于具有不同数据库的不同客户，您只需为其比较不同的参考数据库即可。向客户发布更新后，您可以使用相同的差异脚本更新您自己的参考站点。

简而言之就是这样。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-27T18:21:34.190

我的做法和你差不多。我保留了一个数据库发行说明文件，其中包含我最近的所有更改，并在顶部列出了颠覆修订号。它还包含为应用此更改而运行的 SQL。

同时，我维护一个数据库模型（我在 Eclipse 中使用[Azzurri Clay](http://www.azzurri.jp/en/clay/index.html)），以便我可以随时重新生成我的模型。任何需要的更改，我首先在模型中进行，然后更新我的发行说明。尽管只有 CREATE，但 Azzurri 无法生成 ALTERations。

这一切都存储在 subversion 下，以便我可以在需要时回滚。我可能应该在我的应用程序的 svn 修订版和我的模型的修订版之间保持某种联系。

# c++ - 链接器错误 C++ Visual Studio 2005

> ID：240887
> 
> 赞同：2
> 
> 时间：2008-10-27T18:06:52.253
> 
> 标签：c++, visual-studio-2005, linker, visual-c++-2005

对于我什至没有直接调用的方法，我在 Visual Studio 中遇到了一大堆链接器错误。我白天是一名 Java 开发人员，但我有一个需要用 C++ 完成的项目，旨在在 Windows 机器上运行。因此，我被困在 Visual Studio 上。

Bascally，我有一个 os 项目，我添加了一个访问器方法。我将该项目编译为 .lib 文件（编译和链接很好）。

然后我有自己的项目使用该库。我已将库包含在 Project->Properties -> Linker -> Input 下，并在 General -> Additional Lib Directories 中设置适当的目录。我已将标头包含在适当的文件中，我只是调用其中一个类的构造函数……甚至没有调用我创建的方法。

代码可以编译，但我得到以下大量链接器错误——主要是 LNK2019 和 LNK2001 错误。我尝试在不同的设置（lib、exe 等）下重新编译，链接器错误似乎只会成倍增加。当我切换回以前的设置时，错误数量仍处于峰值。任何想法如何解决这一问题？

构建日志

> 构建开始：项目：SpamCapture，配置：调试|Win32

命令行：

> 创建临时文件“c:\SpamCapture\SpamCapture\SpamCapture\Debug\RSP0000103081740.rsp”，内容为 [ /VERBOSE:LIB /OUT:"C:\SpamCapture\SpamCapture\SpamCapture\Debug\SpamCapture.exe" /INCREMENTAL /LIBPATH: "C:\SpamCapture\Config\Debug\" /MANIFEST /MANIFESTFILE:"Debug\SpamCapture.exe.intermediate.manifest" /NODEFAULTLIB:"libcmtd.lib" /NODEFAULTLIB:"nafxcwd.lib" /DEBUG /PDB:"c :\SpamCapture\SpamCapture\SpamCapture\Debug\SpamCapture.pdb" /SUBSYSTEM:CONSOLE /MACHINE:X86 KeyCapture_Config.lib kernel32.lib user32.lib gdi32.lib winspool.lib comdlg32.lib advapi32.lib shell32.lib ole32.lib oleaut32 .lib uuid.lib odbc32.lib odbccp32.lib
> 
> “.\Debug\Interaction.obj”
> 
> “.\Debug\InteractionSet.obj”
> 
> “.\Debug\LogReader.obj”
> 
> ".\Debug\SpamCapture.obj"
> 
> “.\调试\stdafx.obj”
> 
> ".\Debug\SpamCapture.res"
> 
> ".\Debug\SpamCapture.exe.embed.manifest.res" ] 创建命令行 "link.exe @c:\SpamCapture\SpamCapture\SpamCapture\Debug\RSP0000103081740.rsp /NOLOGO /ERRORREPORT:PROMPT"

输出窗口：

> 正在链接... LINK：警告 LNK4067：入口点不明确；选择 'mainCRTStartup' 搜索库 搜索 C:\SpamCapture\Config\Debug\KeyCapture_Config.lib: 搜索 C:\Program Files\Microsoft Visual Studio 8\VC\lib\kernel32.lib: 搜索 C:\Program Files\Microsoft Visual Studio 8\VC\PlatformSDK\lib\user32.lib：搜索 C:\Program Files\Microsoft Visual Studio 8\VC\PlatformSDK\lib\gdi32.lib：搜索 C:\Program Files\Microsoft Visual Studio 8\VC\PlatformSDK\ lib\winspool.lib：搜索 C:\Program Files\Microsoft Visual Studio 8\VC\PlatformSDK\lib\comdlg32.lib：搜索 C:\Program Files\Microsoft Visual Studio 8\VC\PlatformSDK\lib\advapi32.lib：搜索 C:\Program Files\Microsoft Visual Studio 8\VC\PlatformSDK\lib\shell32.lib: 搜索 C:

链接器错误从这里开始：

> KeyCapture_Config.lib(KeyCapture_ConfigDlg.obj) : 错误 LNK2001: 无法解析的外部符号 "public: virtual int __thiscall CWnd::Create(char const *,char const *,unsigned long,struct tagRECT const &,class CWnd *,unsigned int,struct CCreateContext *)" (?Create@CWnd@@UAEHPBD0KABUtagRECT@@PAV1@IPAUCCreateContext@@@Z)

......更像这样的一堆

> KeyCapture_Config.lib(KeyCapture_ConfigDlg.obj) : 错误 LNK2019: 无法解析的外部符号 "public: struct HICON__ * **thiscall CWinApp::LoadIconA(unsigned int)const " (?LoadIconA@CWinApp@@QBEPAUHICON** @@I@Z) 在函数中引用"公共：__thiscall CKeyCapture_ConfigDlg::CKeyCapture_ConfigDlg(class CWnd *)" (??0CKeyCapture_ConfigDlg@@QAE@PAVCWnd@@@Z)

......更多这样的

> (?DoDataExchange@SetupDialog@@MAEXPAVCDataExchange@@@Z) C:\SpamCapture\SpamCapture\SpamCapture\Debug\SpamCapture.exe：致命错误 LNK1120：34 个未解决的外部

结果：

> 构建日志保存在“file://c:\SpamCapture\SpamCapture\SpamCapture\Debug\BuildLog.htm” SpamCapture - 44 个错误，1 个警告

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-27T19:31:37.590

该库`KeyCapture_Config.lib`使用 MFC GUI 类（`CWnd`、`CWinApp`等），但您将其链接到的应用程序是控制台应用程序（请参阅`/SUBSYSTEM:CONSOLE`链接器命令行中的选项）。这行不通。您应该创建一个新的 MFC GUI 应用程序项目并将库添加到该项目。

编辑：我刚刚检查了您评论中的链接：[http](http://dynamicnetservices.com/~will/academic/textinput/keycapture/) ://dynamicnetservices.com/~will/academic/textinput/keycapture/ 似乎 KeyCapture_Config 实际上是一个使用 KeyCapture DLL 的 MFC 对话框应用程序。可以通过直接链接到`KeyCapture.lib`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T18:16:40.220

链接错误似乎是在抱怨缺少很多 MFC 功能，并且您的链接行包括： /NODEFAULTLIB:"nafxcwd.lib" 这将排除 MFC。您要链接的库是用 MFC 构建的吗？

其他要检查的事情是您正在使用相同的字符集（即都是多字节或都是 unicode）编译应用程序和库。

构建库时没有链接步骤，因此可以将任意对象集合放入库中，而无需考虑它们可能还需要什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T18:27:10.807

看起来您的项目正在与调试多线程运行时链接。这是你的意图吗？如果是这样，可能与您似乎正在使用的 KeyCapture_Config 库不一致。

KeyCapture_Config 是第 3 方库吗？如果是这样，您是从源代码构建它还是为您提供了 lib/dll？

可能只需要对正在构建的 C/C++ 运行时进行一些调查。您可以参考[Microsoft 知识库文章](http://support.microsoft.com/kb/154419)，该文章可能有助于阐明可能的运行时构建差异。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-27T18:55:36.867

我认为 Rob Walker 已经解决了这个问题。如果 KeyCapture_Config.lib 的文档说没有与 MFC 的链接，请检查需要链接到 MFC 的指令的源。像这样的东西：

```
#pragma comment(lib, "nafxcwd.lib") 
```

会导致对 MFC 的依赖，并且 KeyCapture_Config.lib 文档可能已过时。

# c# - 什么是 .net 的好的 RDF 库？

> ID：240903
> 
> 赞同：14
> 
> 时间：2008-10-27T18:11:26.033
> 
> 标签：c#, .net, rdf, semantic-web, owl

我正在寻找一个可以处理 RDF 和 OWL 数据的库。

到目前为止，我发现：

*   [semweb](http://razor.occams.info/code/semweb/)（我所知道的不支持猫头鹰）
*   [rowlex](http://rowlex.nc3a.nato.int/HowToUse.aspx)（更多的是“浏览器”应用程序）

您的建议：

*   [LinqToRdf](https://code.google.com/p/linqtordf/)（非常有趣，谢谢马克！）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-13T12:27:04.090

[ROWLEX](http://rowlex.nc3a.nato.int)实际上很酷（内部使用[SemWeb](http://razor.occams.info/code/semweb/)）。它不仅仅是一个浏览器应用程序，而是一个用 C# 编写的 SDK。如果您使用 ROWLEX，您将不再直接与 RDF 的三元组交互（尽管您可以），而是提供面向对象的外观和感觉。主要有两种使用场景：

1.  **业务类优先：**您拥有 .NET 业务类。您可以像使用 XML 序列化属性一样以声明方式向类添加属性。在此之后，ROWLEX 可以提取与您的业务类对应的本体和/或可以将您的业务对象序列化为 RDF。
2.  **本体优先：**您拥有本体，[ROWLEX](http://rowlex.nc3a.nato.int)为您生成 .NET 类，您可以使用这些类来构建/浏览 RDF 文档。很棒的是，这些自动生成的类比代码生成器的典型结果要好得多。通过提供隐式和显式转换运算符来覆盖整个继承图，他们可以轻松地使用和模仿 OWL 的多重继承特性。

典型的用法是本体优先方法。例如，假设您的本体描述了以下多重继承场景：

> 汽车是车辆的子类
> 
> 汽车是公司资产的子类

使用 ROWLEX，您将获得 Car、Vehicle 和 CompanyAsset 的 .NET 类。以下 C# 代码将毫无问题地编译：

```
 RdfDocument rdfDoc = new RdfDocument();
    Car car = new Car("myCarUri", rdfDoc);
    Vehicle vehicle = car; // implicit casting
    CompanyAsset companyAsset = car; // implicit casting 
    vehicle.WheelCount = 4;
    companyAsset.MonetaryValue = 15000;
    Console.WriteLine(rdfDoc.ToN3()); 
```

这将打印：

```
myCarUri typeOf Car 
myCarUri WheelCount 4 
myCarUri MonetaryValue 15000 
```

“汽车”业务对象在 RdfDocument 中表示为三元组。自动生成的 C#/VB 类表现为视图。您可以在同一个业务对象上拥有多个 C# 视图——每个视图的类型完全不同。当您与这些视图交互时，实际上是在修改 RdfDocument。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-03-01T14:19:48.900

BrightstarDB 是一个原生的 .NET NoSQL RDF 三元存储，支持 SPARQL，一个支持 LINQ 和 OData 的 .NET 实体框架。它对开发人员和开源项目是免费的，商业用途的运行时成本很小。

BrightstarDB 提供三个级别的 API。

1.  SPARQL 查询和简单事务 API。
2.  将三元组集合分组为数据对象的通用对象 api
3.  一个 Visual Studio 集成，它采用接口定义并生成一个强类型的 .NET 域模型，该模型将其数据作为 RDF 存储在 BrightstarDB 实例中。.NET 模型支持 LINQ，也可以作为 OData 服务公开。

所有 BrightstarDB 文档均在线，无需注册即可在[http://www.brightstardb.com下载软件](http://www.brightstardb.com)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-08-23T14:43:38.303

我制作了一个开源库[dotNetRDF](http://www.dotnetrdf.org) - OWL 支持目前有些有限，但可能不适合您的使用

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-27T18:30:37.323

几个月前，我对此进行了研究。我能找到的更有趣的项目之一是：http: [//www.hookdonlinq.com/linqtordf.ashx](http://www.hookedonlinq.com/linqtordf.ashx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-09T21:11:21.787

在 Codeplex尝试[RDFSharp](http://rdfsharp.codeplex.com)。看起来很年轻，但很有前途。

# c# - 为什么使用 Hashtable.Synchronized？

> ID：240906
> 
> 赞同：4
> 
> 时间：2008-10-27T18:12:18.030
> 
> 标签：c#, .net

从 MSDN 文档：

“同步支持多个写入线程，前提是没有线程正在读取 Hashtable。同步包装器在一个或多个读取器和一个或多个写入器的情况下不提供线程安全访问。”

来源：http: [//msdn.microsoft.com/en-us/library/system.collections.hashtable.synchronized.aspx](http://msdn.microsoft.com/en-us/library/system.collections.hashtable.synchronized.aspx)

听起来我仍然必须使用锁，所以我的问题是我们为什么要使用 Hashtable.Synchronized 呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-27T18:14:52.750

出于同样的原因，有不同级别的数据库事务。您可能关心保证写入，但不介意读取陈旧/可能坏的数据。

* * *

**编辑**我注意到他们的具体例子是一个枚举器。他们无法在包装器中处理这种情况，因为如果您提前中断枚举，包装器类将无法知道它可以释放它的锁。

想想而不是柜台的情况。多个线程可以在表中增加一个值，并且要显示该值的计数。如果您显示 1,200,453 并且计数实际上是 1,200,454 并不重要 - 您只需要关闭它即可。但是，您不希望数据损坏。在这种情况下，线程安全对写入很重要，但对读取不重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-27T18:16:17.257

对于您可以保证在写入数据结构时（或者当您不关心读取错误数据时）没有读者会访问数据结构的情况。例如，结构不是不断修改的，而是您稍后必须访问的一次性计算，尽管它足够大，足以保证许多线程对其进行写入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-19T17:18:50.207

当您在一个线程（读取）上对哈希表进行 for-eaching 并且存在可能向其中添加/删除项目（写入）的其他线程时，您将需要它......

# sharepoint - Sharepoint、创建视图、筛选属性

> ID：240918
> 
> 赞同：2
> 
> 时间：2008-10-27T18:15:10.287
> 
> 标签：sharepoint

我想在 Sharepoint 中创建一个视图，该视图具有基于日期字段的过滤器。

过滤器应该 >= 今天和 <- 今天 + 90 天。

我找到了一个参考

```
<Today OffsetDays=”5” /> 
```

CAML 函数，并且可以通过使用 API 设置视图来使用它。

我的问题是如何使用基于浏览器的管理页面进行设置？

[替代文字 http://www.isuppli.com/Img/Development/CreateViewSample.gif](http://www.isuppli.com/Img/Development/CreateViewSample.gif)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T19:07:11.773

这可以在修改或创建视图时使用过滤器下拉菜单完成 OTB：

[过滤图像](http://img91.imageshack.us/my.php?image=filterew5.png)

[替代文字 http://img91.imageshack.us/my.php?image=filterew5.png](http://img91.imageshack.us/my.php?image=filterew5.png)

编辑：固定图像

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-30T08:56:04.360

好的...当您使用该列的公式时...它不能使用 [Today] 因为它不存在于列表列中...]

所以我建议你必须先要求Today这个栏目，这样你就可以使用[Today]这个公式了。。

我想你只是没有使用 CAML 或列公式，但它可以像 AdamBT 所说的那样通过过滤来完成......

嘿嘿嘿……

# vmware - vmware and performance for developing

> ID：240932
> 
> 赞同：24
> 
> 时间：2008-10-27T18:20:24.520
> 
> 标签：vmware

Curious, how many of you develop under a VMware environment?

Is it popular for employers to setup vmware for everyone?

Seems like a great way to rollout new desktop computers and perform backups etc.

Just worried about the performance though (PC vmwares).

**Update**

I was just looking at vmware's site, 1.3 BILLION in sales..wow!

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-27T19:29:29.887

我几乎只使用虚拟机进行开发，并且很高兴这样做。多个沙盒环境的灵活性绝对值得在性能上进行少量交易。

显然，VM 永远不会为您提供与在本机系统上运行相同的结果，但您应该能够轻松获得与真实系统相差 10-15% 的性能。根据我的经验，人们遇到的许多性能问题都是由于系统和 VM 配置不足或配置不当造成的。

我主要在具有 4GB 内存的 2.4Ghz Core 2 Duo 上使用 Vista x64 虚拟机进行开发。其中，我为我的主 VM 分配了 2GB 的 RAM 和两个虚拟内核。如果我运行多个 VM，我通常将其更改为 1-1.5GB 和一个内核。

这是一些快速的 GeekBench 测试结果；（请注意，OSX 和 Vista 下的 GeekBench 结果似乎没有可比性，它们在此处列出以显示配置对两个系统的影响）。

全新启动，无活动应用程序：

Native OSX - 3115 Native OSX running Vista 64 VM - 3042 Native Vista 64 (2.4GHz x 2, 4GB) - 2596 Vista 64 VM (2 VCore, 3GB) - 2362 Vista 64 VM (1 VCore, 2GB) - 1892

根据我的经验，这些是导致 VM 性能不佳的最常见原因；

*   规格不足的机器。理想情况下，您应该能够将一个内核和 1GB 内存专用于您计划在其中工作的每个 VM。与您可能读到的相反，我发现 Vista 在 1GB 内存的 XP 的百分之几内运行。
*   在你的虚拟机上运行太多东西。将您的电子邮件、网页浏览和即时消息保存在您的本地操作系统上。
*   在您的虚拟机上关闭屏幕保护程序、后台应用程序和非必要服务等项目。如果您的虚拟机已备份，您可能需要关闭系统还原。
*   如果可能的话，让您的虚拟机位于与您的本地操作系统不同的硬盘驱动器上，以便在其中一个或另一个开始分页时，它们的磁盘访问是独立的。
*   对 VM 驱动器进行碎片整理。它的确有所作为。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-27T18:56:13.137

VMware Workstation 6.5 在我的旧款 Athlon X2 上运行得非常好。我在我的主机上使用 Visual Studio，并安装了许多带有各种操作系统、框架和浏览器组合的 VM。VMware Workstation 也将 VM 调试添加到 Visual Studio 中，因此我只需按 F6 即可在我的任何一个 VM 中启动我的应用程序，并在我想要的任何操作系统下对其进行调试。唯一需要注意的是，您需要至少 4gb 的 RAM 才能使一次使用超过 1 个 VM 变得切实可行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-27T18:52:42.783

我的公司使用 VMware 使用不同的浏览器/操作系统版本来测试我们的 webapp。为此，每个人的机器上都至少有 1 个 VM。然而，我们都在本机机器上开发——即使在具有 4GB RAM 的四核机器上，也需要大约 20 分钟才能完成我们的应用程序的干净构建！对我来说，我不喜欢使用 VM 映像，因为它们进行了多少分页。这里的一些开发人员已经开始使用具有主机操作系统并在其中运行 Windows 虚拟机的 Linux，并且由于减少了分页，他们获得了更好的性能（Linux 在内存和磁盘缓存管理方面要好得多，而且还有更好的调度程序）。用于测试的额外虚拟机通常会在我们的 Windows 实例中运行，因此被移动到 Linux 主机上并排运行，从而提高了性能。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-27T18:59:34.067

在我开始使用诸如 BizTalk Server、Sharepoint 和各种事物的 beta/CTP 之类的技术工作时，我转向专门在 VM 中进行开发……不可能让所有东西共存于同一个盒子上.

自从切换以来，我享受了在 VM 中开发的许多其他好处——快照、可移植性、动态封送资源等。

最终的好处是由于 VMWare 存在于许多不同的主机操作系统上，因此我可以自由选择我选择的主机操作系统 - XP、Vista、Linux、OSX 等。

现在我在 MacBook Pro 上运行 OSX，它允许我在同一个机器上进行 Mac 和 iPhone 开发以及 Windows 开发。

**这是让我回答这个问题的冗长的背景故事**——只要你的硬件配置得当，你就不应该遇到任何性能问题——即使是用 BizTalk 和 SQL Server 做疯狂的事情。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-27T18:29:20.803

我们在我工作的地方使用它。我们甚至制作了带有该设备的 DVD，以减少新开发人员上手所需的时间。

关于性能，我看到性能受到影响。如果您启用了快照，它似乎主要受硬盘驱动器的限制。当然，在我将虚拟机移至 VelociRaptor 后，即使是性能下降也不再明显。

哦，我使用 Visual Studio 2005 和 2008 开发 ASP 网站和 C/C++ 应用程序。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-27T18:52:52.410

可悲的是，它还不是“普通”意义上的“流行”，但它绝对是那些尝试过的人“喜欢”的意义上的“流行”。作为一名顾问，我喜欢它，因为它允许我在几分钟内交换工具链，并且在约会结束时，刻录 DVD，将其放入项目文件中，然后完成。

一些响应者似乎在强调使用虚拟机进行测试，我认为它*开始*获得一些牵引力，至少在更复杂的商店中是这样。这显然是部署和兼容性测试的*巨大*胜利。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-27T18:22:21.020

Depends on the employer, I suppose. On a machine that is adequately-equipped, VMWare (or any virtualization software) performs perfectly fine. On machines that you are more likely to be forced to use at the majority of programming jobs, not so much.

I personally do not use VMWare at work. My work machine barely has enough power to natively handle the tools I need to use.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-27T18:25:44.447

Its very popular unless employer is cheap, i used it in a few companies. its great for .NET or any language where you have to check if the thing works on different OS versions/platforms. The most common way is not to use VMWare on your own computer but to remotely join it.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-08-25T01:56:42.440

一旦你开始使用虚拟机，你就再也回不去了。我在 MacBook Pro 上使用 VMware 进行 Windows 和 Linux 开发，我对结果非常满意。

观察：

*   获得足够的内存。4GB 是相当可用的，但 8 更好。您是开发人员，您打开了很多应用程序和网页，对吗？
*   为 VM 分配 1 个核心 - 它比 2 个更快。
*   遵循 VMware 为来宾分配 RAM 的建议
*   为来宾操作系统使用虚拟硬盘驱动器。它比从 BootCamp 分区运行来宾要快得多。
*   VMware 没有启用 Aero 所需的 WDDM 驱动程序。
*   当我进行评估时，VMware Linux 主机视频驱动程序似乎没有 Windows 或 OSX 主机那么快。与其他两个操作系统相比，Linux 主机上的 Windows 来宾视频明显较慢。这是我选择 Mac 而不是 Linux 机器的主要原因。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-08-03T13:31:39.460

我已经开始在我的个人 PC 上几乎所有东西都使用 VMware。

我只为游戏保留我的本机 Windows 安装，并为其他所有内容使用单独的虚拟机：

*   一般办公工作站（MSOffice、会计软件、一般垃圾软件）。这个几乎一直都在。
*   WAMP 堆栈开发环境
*   MS堆栈开发环境
*   用于 beta 测试和玩弄可能破坏操作系统安装的东西的一次性环境。

一切都很快。我使用了精简的 WinXP 基础安装，它占用的空间/内存非常少。

磁盘 I/O 似乎是我的瓶颈，但我觉得我们距离相当实惠的 SSD 只有一代（6 个月？）。

我无法回到物理计算。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-27T20:11:50.520

我们尝试过使用虚拟机，但发现 SQL Server 在同一个物理机器上运行多次基本上会使其陷入无用状态。但是，我认为一旦从 VM 堆栈中删除数据库，我们就没有看到任何严重的问题。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-30T06:41:33.057

桌面/工作站上的虚拟化：Sun Virtualbox 或 VPC。轻松，轻松。我们分享我们最喜欢的图像，保持因果关系，有时甚至对它们进行 sysprep。

主要的 QA 环境使用 Manager 变得严肃起来。开始工作是一头野兽，但没有它就不能生活。我们无法在真机上负担得起我们的测试矩阵，或者在没有模板管理的情况下维护它。如果没有这样的资源，您可能应该做和不做的事情。

长期使用的服务器或 QA DB：VM Ware ESX。（没有简短的解释）。

我们在数据库和虚拟化方面没有性能问题。好吧，我在 Lab Manager 中做过——这也是 DB 在我们商店中使用 ESX 的部分原因。在 I/O 方面，我们的 IT 人员使用 SAN、iSCSI 和高品质线来创造奇迹。如果数据库服务器是裸机，那么避免在数据库服务器上出现性能问题肯定更简单，并且可能从专用主机中挤出更多性能。

这带来了虚拟化的用途和不适合的用途：虚拟化不适用于您已经最大化硬件的场景。例如，我不会在 dev 上使用它，因为我需要我的 dev box 能给我的一切。它是用在更少主机上的数十个易于配置的虚拟克隆来替换数十个未充分利用、难以配置的物理服务器。它允许热插拔更多容量，或允许工程灵活性。

我还有一些 90 年代后期的电脑游戏，我在虚拟化的 Windows 98 中运行。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-27T18:35:42.960

VMWare 作为 Windows 开发环境在我的 2GB 内存（XP 客户机，XP 主机）的双核上运行很糟糕。即使主机上除了 VMware 之外什么都没有运行，每次切换应用程序时，持续的分页需要大约一分钟才能解决。哎呀，本机 VS2008 在大量使用智能感知时（偶尔会出现明显的延迟）甚至都不会运行得那么好。虽然使用固定的 VM 映像作为我的日常工作环境有很多好处，但秒到秒的性能延迟实在是太令人沮丧了。

我的雇主正在给我买一个不错的 64 位系统和大量的内存，所以我会在一个月内重新讨论这个主题。现在我只是每隔几个月重新映像我的机器。

...控制台开发显然表现得很好。对于高内存应用程序没有启动和关闭 vmware 的服务器应用程序（部署）很可爱并且性能很好。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-27T18:38:29.367

在我的开发环境中，我使用了几个 VM。通常每个角色有一个（linux）服务器（例如 subversion、MySQL 数据库、web 服务器、trac 服务器等）。这样我的主机保持干净，不会通过运行 amok 来影响我的工作，并且数据在 VM 主机上保持安全。

VmWare 是相当高级的，对于生产，我建议使用更低级的裸机解决方案，例如 Xen。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-27T18:40:04.790

就我个人而言，我喜欢在我的日常开发中使用虚拟化解决方案，因为它能够同时在多个操作系统上进行测试和开发。但是，由于我的日常开发涉及相当多的 opengl，因此目前这不是一个可行的解决方案，因为大多数情况下，由于缺少驱动程序和硬件加速，VM 上的操作系统将默认返回软件渲染。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-27T19:25:34.077

我正在做一些 SharePoint 开发，我真的很喜欢在我的笔记本电脑上使用 VMPlayer 所带来的灵活性。我有一个带有 WSS 和 VS2005 工具链的图像，以及另一个带有 MOSS 和 VS2008/SQL server 2008 的图像，当我需要它到最大时。当 2008 年的图像损坏时（我猜是很多 beta 版本），我可以删除它并从之前的备份中创建一个新的。在火车上能够在服务器环境中进行开发就说明了一切。

PS：运行 VMWare 只需要 4 GB，而且性能非常好，即使使用慢速 5600 rpm 磁盘驱动器

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-10-27T19:30:47.823

我在整个网络的 VMWare 版本下开发，包括：AD 服务器、数据库服务器等，不用说，即使在我们运行 4gb 内存的 VMWare 服务器上，性能也很糟糕。但它确实让我无需担心意外破坏我公司的实时数据库或关闭现实世界中的重要服务器而进行开发。如果发生了一些疯狂的事情，没什么大不了的，我可以把它回滚到昨天。如果我的整个网络没有安装在 VMWare 环境中，性能将是令人难以置信的，但运行所有其他系统确实会使它陷入困境。

# wpf - WPF ComboBox 绑定未按预期工作

> ID：240946
> 
> 赞同：4
> 
> 时间：2008-10-27T18:22:48.163
> 
> 标签：wpf, vb.net, data-binding, xaml, combobox

我希望我的 WPF ComboBox 的 ItemsSource 属性绑定到 MyListObject 的 MyList 属性。问题是当我在代码中更新 MyList 属性时，WPF ComboBox 没有反映更新。我在执行更新后引发了 PropertyChanged 事件，我认为 WPF 应该通过更新 UI 来自动响应。我错过了什么吗？

这是 CLR 对象：

```
Imports System.ComponentModel

Public Class MyListObject
    Implements INotifyPropertyChanged

    Private _mylist As New List(Of String)

    Public Sub New()
        _mylist.Add("Joe")
        _mylist.Add("Steve")
    End Sub

    Public Property MyList() As List(Of String)
        Get
            Return _mylist
        End Get
        Set(ByVal value As List(Of String))
            _mylist = value
        End Set
    End Property

    Public Sub AddName(ByVal name As String)

        _mylist.Add(name)

        NotifyPropertyChanged("MyList")

    End Sub

    Private Sub NotifyPropertyChanged(ByVal info As String)
        RaiseEvent PropertyChanged(Me, New PropertyChangedEventArgs(info))
    End Sub

    Public Event PropertyChanged(ByVal sender As Object, _
            ByVal e As System.ComponentModel.PropertyChangedEventArgs) _
            Implements System.ComponentModel.INotifyPropertyChanged.PropertyChanged

End Class 
```

这是 XAML：

```
<Window x:Class="Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300"
    xmlns:local="clr-namespace:WpfApplication1"
        >

    <Window.Resources>
        <ObjectDataProvider x:Key="MyListObject" ObjectType="{x:Type local:MyListObject}"/>
    </Window.Resources>

        <Grid>

        <ComboBox Height="23"
                  Margin="24,91,53,0"
                  Name="ComboBox1"
                  VerticalAlignment="Top" 
                  ItemsSource="{Binding Path=MyList, Source={StaticResource MyListObject}}"
                  />
        <TextBox Height="23"
                 Margin="24,43,134,0"
                 Name="TextBox1"
                 VerticalAlignment="Top" />
        <Button Height="23"
                HorizontalAlignment="Right"
                Margin="0,43,53,0"
                Name="btn_AddName"
                VerticalAlignment="Top"
                Width="75">Add</Button>
    </Grid>
</Window> 
```

这是简单的代码隐藏：

```
Class Window1 

    Private obj As New MyListObject

    Private Sub btn_AddName_Click(ByVal sender As System.Object, ByVal e As System.Windows.RoutedEventArgs) _ 
    Handles btn_AddName.Click

        obj.AddName(TextBox1.Text)

    End Sub
End Class 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-27T18:36:00.790

您正在绑定到字符串列表。该列表类不实现 Inotifyproperty。您应该改用 observablecollection。我还注意到在您声明的代码中

```
Private obj As New MyListObject 
```

这不是您将组合框绑定到的静态资源。因此，您的 add 调用不会反映在您的视图中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-27T18:44:46.200

ObservableCollection 很可能是解决方案，但如果它仍然让您感到悲痛，您可以在列表更新后通过调用以下代码直接访问您的静态资源：

```
DirectCast(Me.FindResource("MyListObject"), ObjectDataProvider).Source = _myList 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T18:39:39.520

尝试使用[BindingList(Of T)](http://msdn.microsoft.com/en-us/library/ms132679.aspx)而不是 List(Of T)。

编辑：我是 WPF 的新手，看起来 BindingList 并不是您问题的完整解决方案，但它可能是朝着正确方向迈出的一步。我能够在 WinForm 中测试转换为 BindingList 的 MyListObject，并将 ListChanged 事件引发到 ComboBox，然后更新其列表。

我找到了这个（可能的）解决方案，可以将您的类包装在 ObservableCollection 中，这可能会帮助您解决问题

[使用 WCF 启用 WPF Magic - 第 1 部分](http://blogs.sqlxml.org/bryantlikes/archive/2006/09/20/Enabling-WPF-Magic-Using-WCF-_2D00_-Part-1.aspx)

这是将您的对象更新为 BindingList 的代码。将您的代码与该资源中的代码结合起来，您应该一切顺利。

```
Public Class MyListObject
    ...

    'Private _mylist As New List(Of String)
    Private _mylist As New BindingList(Of String)

    ...

    'Public Property MyList() As List(Of String)
    '    Get
    '        Return _mylist
    '    End Get
    '    Set(ByVal value As List(Of String))
    '        _mylist = value
    '    End Set
    'End Property

    Public Property MyList() As BindingList(Of String)
        Get
            Return _mylist
        End Get
        Set(ByVal value As BindingList(Of String))
            _mylist = value
        End Set
    End Property

    ...

End Class 
```

# css - 网页和条形码字体

> ID：240948
> 
> 赞同：8
> 
> 时间：2008-10-27T18:23:00.783
> 
> 标签：css, xhtml, fonts, cross-browser, barcode

我正在开发一个可以生成条形码列表的小型应用程序。我的电脑上安装了正确的字体。现在我将它们直接打印到网页上，它可以在 Chrome 和 IE 7 中正常工作，但不能在 Firefox 中正常工作。有谁知道 Firefox 与 IE 和 Chrome 有什么不同？

这是我的代码：

```
<html>
    <head>
        <title>Barcode Font Test</title>

        <style type="text/css" media="screen">
            .barcode { font-family: "wasp 39 m", verdana, calibri; font-size: 36pt; }
        </style>
    </head>

    <body>
        <div class="barcode">*574656*</div>
    </body>
</html> 
```

**编辑：** 我可能应该提到，目前这更像是一个个人项目，并不打算向全世界发布。虽然我会采用一个可行的解决方案，但我想要一些不涉及 Javascript/Flash/等的解决方案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-27T21:33:19.030

有几种条形码格式。有些很简单，有些可能会变得非常复杂。如果适合您的应用，最容易使用的一种是 3 of 9 条码。它没有被压缩，并且与条形码中的字符存在 1 对 1 的关系。这有两种变体，仅数字和包含 alpha 的扩展集。我将继续假设您可以使用这种格式。（从您的示例代码看来，这就是您正在使用的内容）对于最简单的实现，请仅使用数字。然后，您将只需要 11 个字符（0-9 和星号）。查看现有 3 of 9 字体的定义。（对于非商业用途，请搜索名为 FREE3OF9 的字体。您可以将其用作应用程序的基础...）

接下来是乏味的部分 - 更多的工作为您预先准备，但几乎可以在任何浏览器中显示。如果您在网上找不到任何内容，请为每个字符创建一个 GIF（或 BMP 或 PNG）图像。（请记住在字符右侧包含适当的空白，以使其与行中的下一个字符保持距离！）它只需要一个像素高。到了显示条形码的时候，将字符串在一起作为`<IMG>`彼此相邻的 's。3 of 9 要求条形码中的字符在每一端都用星号包围或包裹（无论如何它是 FREE3OF9 字体中的星号）。将`<IMG>`'s 的高度设置为足够高以适合您的打印输出。

这样，客户端不需要安装字体，但大多数条码解码器都可以读取生成的图形。

您的示例 ( `*574656*`) 可能如下所示： ![574656](https://i.stack.imgur.com/BHHHr.png)

*（嗯，不完全一样——它是一个实体图形，而不是几个内联单个图形的组合，但你明白了）*

单个数字图形如下所示：（尽管这些还没有“清理”）

`*` ![*](https://i.imgur.com/Q3m0MFb.gif)

`0` ![0](https://i.stack.imgur.com/uEDiK.png)

`1` ![1](https://i.stack.imgur.com/K80Pf.png)

`2` ![2](https://i.stack.imgur.com/2hLvE.png)

`3` ![3](https://i.stack.imgur.com/tkHYt.png)

`4` ![4](https://i.stack.imgur.com/XhBTx.png)

`5` ![5](https://i.stack.imgur.com/QFN6e.png)

`6` ![6](https://i.stack.imgur.com/HKf4y.png)

`7` ![7](https://i.stack.imgur.com/8L2qi.png)

`8` [![8](https://i.stack.imgur.com/ui3Ms.png)](https://i.stack.imgur.com/ui3Ms.png)

`9` [![9](https://i.stack.imgur.com/neRmn.png)](https://i.stack.imgur.com/neRmn.png)

并且代码更改可能如下所示：

```
<html>    
    <head>        
        <title>Barcode Font Test</title>        
    </head>    
    <body>   
        <img src="3o9cb_ast.png" alt="*"/>     
        <img src="3o9cb_5.png" alt="5"/>
        <img src="3o9cb_7.png" alt="7"/>
        <img src="3o9cb_4.png" alt="4"/>
        <img src="3o9cb_6.png" alt="6"/>
        <img src="3o9cb_5.png" alt="5"/>
        <img src="3o9cb_6.png" alt="6"/>
        <img src="3o9cb_ast.png" alt="*"/>
    </body>
</html> 
```

* * *

我使用[SearchFreeFonts.com](http://www.searchfreefonts.com)作为资源来刷新我对 9 个条形码字符中的 3 个如何格式化的记忆。这些图形最初来自该站点。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-27T19:00:18.447

Mozilla 开发人员选择了不工作的符号字体。您可以在配置中启用它们，如[让符号字体在 Mozilla Firefox 中工作中所述](http://nothing.golddave.com/?p=53)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-27T20:00:01.307

一个更简单的解决方案可能是在服务器端生成图像以生成条形码。这样您就不必依赖安装了字体的用户，也不必访问 html 中的字体。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-27T18:32:50.360

在我现在工作的公司，我们使用 lesnikowski.com 的 BarCode.dll。它生成条形码图像。它不依赖于字体是否安装在客户端电脑上并适用于所有浏览器。

希望这可以帮助。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-05-17T14:04:01.593

自从最初提出这个问题以来，发生了很大变化。今天，在网络上使用条形码字体并直接渲染它相当简单。

运行下面的代码片段以查看实时示例：

```
.barcode39 {
  font-family: 'Libre Barcode 39 Extended Text', cursive;
  font-size: 40px;
}
```

```
<link href="https://fonts.googleapis.com/css2?family=Libre+Barcode+39+Extended+Text&display=swap" rel="stylesheet">

<div class="barcode39">
 *hello world*
</div>
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-27T18:26:57.220

在网页上使用非标准字体是一件很痛苦的事情。为了更容易，您可以使用[sIFR](http://wiki.novemberborn.net/sifr)或新的[typeface.js](http://typeface.neocracy.org/)。

编辑：这在 4 年前发布时有效，但现在不再有效。我将其留给后代，但不要将其视为正确答案。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-27T19:04:29.517

我们公司也有同样的问题。幸运的是，只有 1-2 人需要使用条形码字体。

我们发现，当他们收到新的 PC 时，字体无法通过任何浏览器运行。他们必须打开一个客户端应用程序（如 Word），选择一种条形码字体，然后进行一些输入以“初始化”该字体。

我认为最好的解决方案是按需在服务器上创建条形码图像。此解决方案的问题可能是清理旧图像。在我看来，这个解决方案需要更多的前期工作，但与客户端解决方案相比，持续的问题和维护更少。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-26T00:09:16.013

字体往往会出现问题，因为它依赖于浏览器进行渲染。图像更好。我使用[Morovia Barcode Active Lite](http://www.morovia.com/activex/barcode-lite.asp)从 IIS 创建条形码。

[示例条码 http://www.morovia.com/activex/active-demo/barcode.asp?Symbology=7&ShowHRText=1&NarrowBarWidth=20&BarHeight=750&Message=0+07+70007+07723](http://www.morovia.com/activex/active-demo/barcode.asp?Symbology=7&ShowHRText=1&NarrowBarWidth=20&BarHeight=750&Message=0+07+70007+07723)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-05-17T15:38:33.297

只需这样做：[http](http://davidscotttufts.com/2009/03/31/how-to-create-barcodes-in-php/) ://davidscotttufts.c​​om/2009/03/31/how-to-create-barcodes-in-php/ David 创建了一种超级简单的方式来实现条形码。您将需要在 MySQL 中运行的 GD 库。（MAMP 和 LAMP 应该已经安装了这个）

# c# - Expanding a message template

> ID：240949
> 
> 赞同：2
> 
> 时间：2008-10-27T18:23:01.457
> 
> 标签：c#, regex

I have a set of templates for emails that my app sends out. The templates have codes embedded in them that correspond to properties of my business object.

Is there a more elegant way than calling

```
string.Replace("{!MyProperty!}", item.MyProperty.ToString()) 
```

a zillion times? Maybe XMLTransform, regular expressions, or some other magic? I'm using C# 3.5 .

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-27T18:25:13.743

First of all, when I do this I use StringBuilder.Replace() as I have found that its performance is much better suited when working with 3 or more replacements.

Of course there are other ways of doing it, but I've found that it is not usually worth the extra effort to try other items.

You might be able to use Reflection I guess to automate the replacement, that might be the only "better" way.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-27T19:42:37.987

```
public static string Translate(string pattern, object context)
{
    return Regex.Replace(pattern, @"\{!(\w+)!}", match => {
        string tag = match.Groups[1].Value;
        if (context != null)
        {
            PropertyInfo prop = context.GetType().GetProperty(tag);
            if (prop != null)
            {
                object value = prop.GetValue(context);
                if (value != null)
                {
                    return value.ToString();
                }
            }
        }
        return "";
    });
} 
```

```
Translate("Hello {!User!}. Welcome to {!GroupName!}!", new {
    User = "John",
    GroupName = "The Community"
}); // -> "Hello John. Welcome to The Community!" 
```

[https://ideone.com/D9J31c](https://ideone.com/D9J31c)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T21:18:54.783

有一个内置的 WebControl [System.Web.UI.WebControls.MailDefinition](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.maildefinition.aspx)可以进行[字符串替换](http://msdn.microsoft.com/en-us/library/ms156159.aspx)（除其他外）。可惜他们将它与 app.config 中的 Smtp 设置和 Web 控件紧密耦合，然后将其密封以防止继承人。

但是，它确实处理了一些您在邮件模板引擎中最可能需要的东西 - 来自文件的正文文本、html 电子邮件、嵌入式对象等。Reflector 显示实际替换是通过 foreach 循环和 Regex.Replace 处理的 -这对我来说也是一个合理的选择。

快速浏览一下就会发现，如果您可以使用 app.config 中的发件人地址（您可以在之后在返回的 MailMessage 上更改它），那么您只需要嵌入资源的所有者控件或 BodyFileName。

如果您使用的是 ASP.NET 或者可以忍受这些限制 - 我会选择 MailDefinition。否则，只需对字典和 Regex.Replace 进行 foreach。由于身体的重复分配，它有点内存不足 - 但它们是短暂的，不应该造成太大的问题。

```
var replacements = new Dictionary<string, object>() {
    { "Property1", obj.Property1 },
    { "Property2", obj.Property2 },
    { "Property3", obj.Property3 },
    { "Property4", obj.Property4 },
}

foreach (KeyValuePair<string, object> kvp in replacement) {
    body = Regex.Replace(body, kvp.Key, kvp.Value.ToString());
} 
```

如果您确实有*很多*属性，请先使用 Regex.Match 读取您的正文并反映到属性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-27T18:31:59.567

您可以使用正则表达式来执行此操作，但您的正则表达式替换对于每个属性也不同。我会坚持使用`string.Replace`.

使用反射检索属性并在循环中替换它：

```
foreach (string property in properties)
{
  string.Replace("{!"+property+"!}",ReflectionHelper.GetStringValue(item,property));
} 
```

只需实现您的`ReflectionHelper.GetStringValue`方法并使用反射来检索项目对象类型的所有属性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-12-28T22:33:10.537

在查看了之前包含的示例之后，我想我应该看看真正的代码。@mark-brackett 你比你知道的更接近。

```
//The guts of MailDefinition.CreateMailMessage
//from https://github.com/Microsoft/referencesource/blob/master/System.Web/UI/WebControls/MailDefinition.cs

if (replacements != null && !String.IsNullOrEmpty(body)) {
                    foreach (object key in replacements.Keys) {
                        string fromString = key as string;
string toString = replacements[key] as string;

                        if ((fromString == null) || (toString == null)) {
                            throw new ArgumentException(SR.GetString(SR.MailDefinition_InvalidReplacements));
                        }
                        // DevDiv 151177
                        // According to http://msdn2.microsoft.com/en-us/library/ewy2t5e0.aspx, some special 
                        // constructs (starting with "$") are recognized in the replacement patterns. References of
                        // these constructs will be replaced with predefined strings in the final output. To use the 
                        // character "$" as is in the replacement patterns, we need to replace all references of single "$"
                        // with "$$", because "$$" in replacement patterns are replaced with a single "$" in the 
                        // final output. 
                        toString = toString.Replace("$", "$$");
                        body = Regex.Replace(body, fromString, toString, RegexOptions.IgnoreCase);
                    }
                } 
```

# wpf - 如何在从可视树中删除之前让 WPF 控件动画完成

> ID：240955
> 
> 赞同：3
> 
> 时间：2008-10-27T18:26:19.203
> 
> 标签：wpf, animation, controls

我有一个场景，我想在 WPF 控件从视觉/逻辑树中删除之前对其进行动画处理。控件是自定义的，控件样式（包括动画）将由设计者提供（即，在编写控件代码时我不知道它们的细节）。我想提供路由事件，允许设计人员在对象被删除之前触发动画（例如，用户正在用鼠标拖动控件，当鼠标按钮被释放时，控件可能会慢慢消失而不是突然消失从视觉/逻辑树中删除）。这是否可能仅使用路由事件？是否可以检测动画何时完成而不需要设计者设置一个古怪的依赖属性或在动画结束时触发控件的删除？如果设计者未能设置属性，则使用依赖属性会造成内存泄漏。有没有更好的办法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-27T18:31:20.440

每个故事板都有一个 Completed 事件，当动画完成时会调用该事件。您应该处理该事件并从该事件中删除控件。这样您就可以在释放鼠标按钮时开始动画。

# python - 有人使用 Python 进行嵌入式项目吗？

> ID：240996
> 
> 赞同：41
> 
> 时间：2008-10-27T18:41:02.027
> 
> 标签：python, embedded

我的公司正在将 Python 用于一个相对简单的嵌入式项目。还有其他人在嵌入式平台上使用 Python 吗？总的来说，它对我们来说效果很好，可以快速开发应用程序，快速调试。我喜欢这种语言的整体“简洁”。

我在日常工作中遇到的唯一真正问题是，与常规编译器相比，缺少静态检查可能会导致在运行时引发问题，例如一个简单的字符串 cat 和 print 语句中的 int 可能会带来整个应用程序下来。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-09-22T12:47:28.990

我们在很多带有 ARM 处理器和 16 MB RAM（运行 linux）的[嵌入式板上使用 python。](http://www.embeddedarm.com/products/arm-sbc.php)

它工作得非常好，并且非常容易快速制作自定义代码 - 这是 python 的强项之一。

至于代码的可靠性——我们试图有 100% 的测试覆盖率。用 python 编写测试非常快，它会给你一种美妙的自信感。我们使用[扭曲试验](http://twistedmatrix.com/trac/wiki/TwistedTrial)来运行测试并报告覆盖率，但还有许多其他工具可用。

以我的经验，python + 测试比任何其他替代方案更可靠且编写速度更快。

嵌入式工作的唯一缺点是有时 python 可能很慢，有时它使用大量内存（相对而言）。这还没有给我们造成显示停止问题，如果它成为问题，python 很容易分析速度和内存。

[pychecker](http://pychecker.sourceforge.net/)也非常有用，它可以捕获很多常见错误。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-27T19:51:43.087

顺便说一句，有关类型推断和静态类型的有趣讨论，请参阅这篇博客文章：“ [Python](http://lambda-the-ultimate.org/node/1519)的类型推断”，包括一些 Guido van Rossum 博客文章的链接，这些文章描述了向 Python 添加可选的静态类型。

我同意[Bruce Eckel](http://www.mindview.net/WebLog/log-0025)的观点，即练习“强测试”比依赖强类型更好。我认为这同样适用于嵌入式开发。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-28T02:42:01.697

Personally, I've worked on some of the software that runs in the device used by [BusRadio](http://www.busradio.com/). It's an example of an embedded project built on [Twisted](http://twistedmatrix.com/) and Python. The device is an embedded [XScale](http://en.wikipedia.org/wiki/XScale) processor running a [debian-derived](http://www.debian.org/) distribution, so it might not meet certain definitions of "embedded", but it is pretty dang small: it fits into the dashboard of a school bus.

There were some interesting issues with using Python with large libraries - the interpreter can take quite a while to start up and load all the code for Twisted on a really slow chip, and some things needed special-case optimizations. However, at no point was the dynamic nature of Python a problem. The software in question certainly wasn't perfect, but at least when using Twisted, a simple programming error will not "bring the whole application down". A traceback will get logged, and processing continues.

So, if you're in an embedded environment sufficiently unconstrained that you can use Python in the first place, it's no different than developing "regular" programs (games, desktop applications, web apps). You don't need static typing there, and you don't need it here either.

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-09-16T01:31:30.290

[Telit](http://www.telit.com/)制作的[GSM/GPRS 调制解调器模块](http://www.telit.com/cellular/)包括[嵌入式 Python 解释器](http://www.telit.com/fileadmin/user_upload/products/Downloads/3G/Telit_Easy_Script_Python_r18.pdf)。

我自己没有尝试过，所以我不知道 Python 解释器与 PC 实现的比较或不同之处，例如其中包括模块、RAM 和 ROM 内存限制、执行速度等。

然而，正如用户 foresightyj 在评论中指出的那样，他们似乎使用的是 Python 1.5.x，这是一个真正古老的版本，所以我很难认真对待它们。如果没有这么多现代 Python 特性，Python 开发人员不会喜欢降级到如此古老的版本。我会担心这样一个旧版本的安全问题。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-10-27T19:45:21.477

在我以前的雇主，我曾想花一些时间在[tinypy](http://www.tinypy.org/)中构建嵌入式系统，这是“64k 代码中 Python 的极简实现”。（但我从来没有得到它，我不再有时间。）

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2010-11-24T16:15:08.413

我一直在研究基于旧的慢速 powerpc 和 16Mb RAM 的微波电信设备。

我已经能够在 VxWorks 上移植 Python 2.6.1 解释器，以便直接从目标 shell 获得命令行解释器，或者执行上传到目标 flash 的 python 脚本。

我们使用这些脚本对目标执行自动测试或执行诊断程序。这里有一些关于整个过程的细节：[如何：将 Python 移植到 VxWorks](http://www.gsalcazar.altervista.org/tools/how-to-port-python-to-vxworks/)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-11-10T16:50:23.287

> The only real problem I have in day to day work is that the last of static checking vs a regular compiler can cause problems to be thrown at run-time, e.g. a simple accidental cat of a string and an int in a print statement can bring the whole application down.

Unit tests are your only safety against these things.

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-31T00:23:45.620

我的团队编写了一个由 C++ 和 Python 组成的嵌入式软件。我们决定用 C++ 编写基本类和繁重的计算例程。我们用 Python 编写逻辑。将库提升为胶水。使用 boost 绝非易事，但结果非常好。快速且易于修改。使用python表示自定义需求，我们能够实时满足客户的需求，使用注入技术更改代码。真的很令人兴奋！（好吧，我是个极客；）

我们开始在 python 中进行原型设计，但我们突然意识到它显然太慢了。所以我们决定在不同的计算层中构建程序，以达到速度要求。C++ 是最好的解决方案。

为了同时使用 python 和 c++，我们必须严格控制输入。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-28T08:57:19.570

事实上，当您需要编写某种测试时，Python 经常被用作“支持语言”——即我参与了一个项目，该项目（基于 Python 的）测试框架代码库（是？）几乎和主要产品。Python“代理”在 QNX、VxWorks 上工作——我们遇到的大多数问题是正确移植我们代码的线程和网络相关部分。

可能值得看一看[OpenMoko 项目](http://www.openmoko.org/)，很多 Python 嵌入式开发都是在那里完成的。

需要注意的事项： - 根据平台/操作系统，对 Python/C 扩展模块的支持可能会表现得很奇怪 - 大多数嵌入式平台都提供了相当过时的 Python 版本 - 最后你会发现'proper ' 每一位都很重要的嵌入式软件，以及在大于 128MB 的 >412Mhz XScale CPU 上执行的“现代”嵌入式软件，然后 Python 与您想要定位的硬件不匹配:(

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-11-10T16:44:21.863

我们在大学里将 Python 用于基于 Gumstix 硬件平台的嵌入式应用程序。虽然比传统的嵌入式系统功能更强大，但我们发现小尺寸、低（ish）功耗以及在桌面机器上的开发和目标硬件之间轻松传输代码的组合非常宝贵。

Python 也是一种很好的教授学生的语言，并且使用 Gumstix 非常棒，他们可以让代码在低功耗系统上运行，而不是使用 NesC 等专用语言带来的头痛和心碎。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-09-22T06:05:29.390

我曾在一家公司工作，该公司在基于 Atmel AVR32 并运行嵌入式 Linux 的嵌入式产品上使用 Python。固件最初是在 PC 上开发的（由于缺乏可工作的硬件原型），然后转移到在交叉编译的 Python 解释器上运行的嵌入式硬件。

在设备上“实时”调试和修改源代码的能力是开发过程中的一大优势，并节省了大量时间。最大的缺点是 Python 解释器的速度和内存使用。

在生产固件的第一个版本发布后，我们将代码的关键部分移植到 C/C++。移植工作非常简单，并导致速度关键代码的改进了几个数量级（如您所料）。

顺便说一句，大多数设计和生产测试代码都是用 Python 编写的，主要在 PC 上的测试工具中运行。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2014-09-30T14:06:28.593

根据我的经验，Python 传统上在桌面环境中的使用多于在嵌入式领域。有两个原因与解释 Python 的事实有关：

*   C/C++ 语言比 Python 具有更高的性能（这在具有慢速微控制器的嵌入式系统中很重要）
*   C/C++ 语言具有更多确定性的响应时间（这在控制某些东西的实时嵌入式系统中很重要）。

当然，随着嵌入式系统将变得更快、上市时间更短，Python 将在嵌入式领域得到更多采用。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-10-27T19:57:43.167

我有一个 Python 服务器（使用[Twisted](http://twistedmatrix.com/trac/)）和一些在 XP Embedded 下运行的帮助脚本，它运行良好。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2015-07-07T20:42:15.767

# 最近的发展

*   [MicroPython](http://micropython.org/)是 Python 3 编程语言的精简和快速实现，经过优化可在微控制器上运行。
*   欧洲航天局 (ESA) 正在[资助 MicroPython 的进一步开发](http://forum.micropython.org/viewtopic.php?f=8&t=744)。它这样做是为了评估该语言对天基应用的适用性，特别是对有效载荷的适用性。
*   **WiPy 1.0 和 2.0、LoPy 和 SiPy**是 Pycom 销售的无线 MicroPython[平台](https://www.pycom.io/)。

![WiPy 1.0](https://i.stack.imgur.com/Ujdyb.png)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-10-27T20:08:29.183

[EVE Online](http://www.eve-online.com/)客户端不是实时、高性能 Python 的展示品吗？

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2015-10-02T04:09:08.657

我正在使用一个 Gatetel GT-HE910 系列模块，它嵌入了 Telit 调制解调器，包括 3G、GPS、AD、IO 和 Python 2.7。这用于远程数据采集应用程序。Python 在这些模块上的速度非常慢，但我们只需要每 15 分钟更新一次或处于警报状态，因此它们运行良好。

[http://www.gatetel.com/#!gt-series/cscb](http://www.gatetel.com/#!gt-series/cscb)

* * *

## 回答 #17

> 赞同：-5
> 
> 时间：2014-09-19T18:41:22.257

> Blockquote 我在日常工作中遇到的唯一真正问题是静态检查与常规编译器的最后一个问题可能会导致在运行时引发问题，例如，一个简单的意外 cat 字符串和 print 语句中的 int 可以降低整个应用程序

对我来说，这是一笔大买卖。您可以在编译时发现并修复问题现在必须在运行时依赖。不知道数据类型并且必须编写额外的函数来检查数据类型是很麻烦的。在 C 中没有必要这样做。你将如何在 python 中声明'volatile'？

> Blockquote 嵌入式工作的唯一缺点是有时 python 可能很慢，有时它使用大量内存（相对而言）。这还没有给我们造成显示停止问题，如果它成为问题，python 很容易分析速度和内存。

这也是巨大的。对于嵌入式系统或 RTOS，时间限制非常重要。

Python不需要快速编码。这实际上取决于您对哪种语言感到满意。老实说，我需要 1 天的时间来编写函数和不必要的面向对象的东西，我可以在 2 小时内用 C 完成。测试太不方便了，我必须编写代码，py_compile，在目标中复制 pyc，然后运行程序，然后 python 退出抱怨变量未定义或类型转换错误或类似的小事。

我的建议是 C 工具链可用于任何目标。C 是快速的、面向硬件的、具有挑战性的和有趣的。在嵌入式系统中坚持使用 C。无需安装 configure silly python 包来运行它。**