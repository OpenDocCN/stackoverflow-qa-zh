# StackOverflow 问答 10080000-10080999

# java - 在 JBoss AS 7 中找不到持久性提供程序

> ID：10080004
> 
> 赞同：3
> 
> 时间：2012-04-09T21:18:14.020
> 
> 标签：java, hibernate, jpa, jboss

我刚刚从 Tomcat 迁移到 JBoss AS 7。所以，我在 JBoss 中配置了 Mysql 数据源（添加带有关联 Jar 的 module.xml，将驱动程序块添加到 Standalone.xml 并通过 JBoss 接口配置数据源。

部署时没有错误，但无法获得 entityManager（JPA 与 Hibernate 在后台）。

实际上，当执行此代码时：

```
Persistence.createEntityManagerFactory("RoomManagement"); 
```

我收到此错误：

> javax.persistence.PersistenceException：没有名为 RoomManagement 的 EntityManager 的持久性提供程序 javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:69) javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:47)

很奇怪，因为我很好地验证了我的 persistence.xml 确实发生在 WEB-INF/classes/META-INF 目录的 War 中。

我的 persistence.xml 如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence xmlns="http://java.sun.com/xml/ns/persistence" version="2.0">

    <persistence-unit name="RoomManagement" transaction-type="JTA">
        <provider>org.hibernate.ejb.HibernatePersistence</provider>
        <jta-data-source>java:jboss/datasources/MySqlDS</jta-data-source>
        <class>com.parisdescartes.roommanagement.domain.entities.Address</class>
        <class>com.parisdescartes.roommanagement.domain.entities.Building</class>
        <class>com.parisdescartes.roommanagement.domain.entities.Civility</class>
        <class>com.parisdescartes.roommanagement.domain.entities.EventType</class>
        <class>com.parisdescartes.roommanagement.domain.entities.Job</class>
        <class>com.parisdescartes.roommanagement.domain.entities.Reservation</class>
        <class>com.parisdescartes.roommanagement.domain.entities.Room</class>
        <class>com.parisdescartes.roommanagement.domain.entities.RoomType</class>
        <class>com.parisdescartes.roommanagement.domain.entities.Tool</class>
        <class>com.parisdescartes.roommanagement.domain.entities.User</class>
        <class>com.parisdescartes.roommanagement.domain.entities.UserDetail</class>
        <class>com.parisdescartes.roommanagement.domain.entities.Schedule</class>
        <properties>
            <property name="hibernate.connection.autocommit" value="true" />
            <property name="hibernate.archive.autodetection" value="class"/>
            <property name="hibernate.show_sql" value="true"/>
            <property name="hibernate.format_sql" value="true"/>
            <property name="hbm2ddl.auto" value="update"/>
            <property name="hibernate.dialect" value="org.hibernate.dialect.MySQLDialect" />
        </properties>
    </persistence-unit>
</persistence> 
```

我是否犯了错误或忘记指定某些内容？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T22:02:01.687

从`WEB-INF/lib`. JBoss 已经捆绑了它，所以如果你把它放在类路径上，它可能会混淆类加载器。

# sql - SQL - 删除后将顺序列重新编号为顺序列

> ID：10080009
> 
> 赞同：5
> 
> 时间：2012-04-09T21:18:41.460
> 
> 标签：sql

我研究并意识到我有一个独特的情况。

首先，由于我是新用户，因此我还不允许将图像发布到板上，因此请参阅下面的相应链接

我有多个表，其中列（不总是标识符列）按顺序编号，并且编号不应有任何中断。我的目标是确保这保持真实。

Down and Dirty 我们有一个“事件”表，我们在其中随机选择一定百分比的行并将这些行插入到表“结果”中。“结果”中的“ID”列被传递给一堆删除查询。

这或多或少确保了多个表中缺少行。

我的问题：找出一个 sql 查询，它将重新编号我指定的列。我宁愿不删除该列。

删除查询示例：

```
delete ItemVoid
from ItemTicket
join ItemVoid
on ItemTicket.item_ticket_id = itemvoid.item_ticket_id
where itemticket.ID in (select ID
            from results) 
```

之前的示例表：

![在此处输入图像描述](../Images/b865a777f4dd6df223b0edfe65eb1e7f.png)

之后的示例表：

![在此处输入图像描述](../Images/b88887fc4e4c627d5cf8e258db93c9d1.png)

如您所见，根据 ID 列从两个表中删除了 2 行。所以现在我要弄清楚如何重新编号 item_ticket_id 和 item_void_id 列，其中较高的数字减少到缺失值，下一个最高的减少，等等。问题 #2，如果 item_ticket_id 更改以便在 ItemTickets 中连续，然后它必须更新 ItemVoid 的 item_ticket_id 中的更改。

我很感激您对此提供的任何建议。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-04-02T09:02:16.927

*（回答一个老问题，因为这是我查找时的第一个搜索结果）*
**（MS T-SQL）**

要对具有间隙的 ID 列（不是标识列）重新排序，可以仅使用带有 a 的简单 CTE 执行`row_number()`以生成新序列。通过`UPDATE`CTE 的“虚拟表”工作，没有任何额外的问题，实际上更新了底层的原始表。
不用担心更新期间 ID 字段冲突，如果您想知道设置已经存在的 ID 时会发生什么，它不会遇到这个问题 - 原始序列一次更改为新序列。

```
WITH NewSequence AS
(
  SELECT
    ID, 
    ROW_NUMBER() OVER (ORDER BY ID) as ID_New
  FROM YourTable
)
UPDATE NewSequence  SET ID = ID_New; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T21:27:33.190

由于您正在寻找这方面的建议，我的建议是您需要重新设计它，因为我发现您的设计存在很大缺陷。

而不是删除记录，然后经历重新编号剩余记录的麻烦，使用`bit`将记录标记为的标志`Inactive`。然后，当您查询记录时，只需包含一个`WHERE`子句以仅包含活动的记录：

```
SELECT *
FROM yourTable
WHERE Inactive = 0 
```

这样您就不必担心重新编号记录。这也使您能够返回并查看将被删除的记录并且您不会丢失历史记录。

如果您真的想删除记录并重新编号，则可以通过以下方式执行此任务：

1.  创建一个新表
2.  使用新数字将原始数据插入新表
3.  放下你的旧桌子
4.  用更正的数字重命名新表

如您所见，对记录重新编号会涉及很多步骤。`UPDATE`当您可以执行一个位标志 时，您正在以这种方式创建更多的工作。

您可以将`DELETE`查询更改为类似于以下内容：

```
UPDATE ItemVoid
SET InActive = 1
FROM ItemVoid
JOIN ItemTicket
    on ItemVoid.item_ticket_id = ItemTicket.item_ticket_id
WHERE ItemTicket.ID IN (select ID from results) 
```

标志要容易得多，这`bit`将是我推荐的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T21:34:13.637

您正在寻找的功能是一个窗口功能。在标准 SQL（SQL Server、MySQL）中，函数是 row_number()。您可以按如下方式使用它：

```
select row_number() over (partition by <col>)
from <table> 
```

为了在您的情况下使用它，您将从表中删除行，然后使用 with 语句重新计算行号，然后使用更新分配它们。为了事务完整性，您可以将删除和更新包装到单个事务中。

Oracle 支持类似的功能，但语法略有不同。Oracle 将这些函数称为分析函数，它们支持对它们进行更丰富的操作。

我强烈警告您不要使用游标，因为它们的性能很差。当然，这不适用于标识列，因为无法修改这样的列。

# emacs - Emacs Gnus Faces（字体）

> ID：10080012
> 
> 赞同：2
> 
> 时间：2012-04-09T21:18:47.060
> 
> 标签：emacs, gnus, emacs-faces

slrn新闻*阅读*器具有吸引人的界面，在浏览新闻组中的文章列表时，作者、主题和日期列有不同的颜色。我正在为 gnus 中的这些字段寻找 Emacs 字体/面部变量，但无法找到它们。[面部](http://www.gnus.org/manual/gnus_290.html#SEC290)的 gnus 手册没有列出可用的面部，并且 Emacs 中没有任何面部列表（`M-x` `customize-face` `gnus-`...看起来相关。我在 Emacs 23.2.1 中使用 gnus 5.13。

（这个问题与在 Emacs 或 gnus 中显示“面孔”（图标/头像）无关。）

**已解决：**请参阅下面的答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T18:27:58.237

可以通过修改相应的[变量](http://www.gnu.org/software/emacs/manual/html_node/gnus/Formatting-Variables.html#Formatting-Variables)来自定义 gnus 中各种元素的格式字符串。摘要行的变量是`gnus-summary-format-line`。我没有使用此变量的[默认](http://www.gnu.org/software/emacs/manual/html_node/gnus/Summary-Buffer-Lines.html)值，而是使用 value `%U%R%z %(%&user-date; %-15,15f %* %B%s%)\n`。

[如此处](http://www.gnu.org/software/emacs/manual/html_node/gnus/Formatting-Fonts.html#Formatting-Fonts)所述，可以将新面应用到格式行的任何（子）部分，方法是用`%1{`和括住该部分`%}`，`1`本例中的 对应于`gnus-face-1`。`gnus-face-1`在我的安装中默认为“斜体”，因此将以下内容添加到我的`~/.emacs`文件中会导致作者在摘要行中以斜体显示：

`(setq gnus-summary-line-format "%U%R%z %(%&user-date; %1{%-15,15f%} %* %B%s%)\n")`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T16:55:49.817

我认为它们在 gnus 代码库中有点分散。文章缓冲区中使用的面可能在 gnus-art.el 等中。

听起来您最大的问题是您找不到特定面孔的符号。您可以随时`M-x describe-face`查看光标下的内容来解决该问题。

此外，`(face-list)`返回所有已定义面的列表。您可以扫描该列表，寻找看起来可能是您感兴趣的特定面孔的候选对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T17:04:36.397

`M-x list-faces-display`当我想查看需要更改哪些面以使模式正常工作时，我会使用（它会打开一个新缓冲区，其中所有当前定义的面变量都字体化为它们设置的颜色，按字母顺序排列）。

然后我`setq`使用来自`color-theme`或来自新的 emacs 内置主题格式的格式，具体取决于我所在的 emacs 版本。

# php - 正则表达式匹配未包含在另一个不同的特定字符串中的特定字符串

> ID：10080013
> 
> 赞同：1
> 
> 时间：2012-04-09T21:18:49.297
> 
> 标签：php, regex, preg-match, preg-match-all, regular-language

我需要一个正则表达式来匹配一个没有被另一个不同的特定字符串包围的字符串。例如，在以下情况下，它会将内容分成两组：1）第二个 {Switch} 之前的内容和 2）第二个 {Switch} 之后的内容。它与第一个 {Switch} 不匹配，因为它包含在 {my_string} 中。该字符串将始终如下所示（即{my_string}此处的任何内容{/my_string}）

```
Some more  
  {my_string}
  Random content
  {Switch} //This {Switch} may or may not be here, but should be ignored if it is present
  More random content
  {/my_string}
Content here too
{Switch}
More content 
```

到目前为止，我已经得到了下面的内容，我知道这根本不是很接近：

```
(.*?)\{Switch\}(.*?) 
```

我只是不确定如何将 [^] （不是运算符）与特定字符串与不同字符一起使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T21:21:34.033

看起来你真的在尝试使用正则表达式来解析语法——这是正则表达式真的不擅长做的事情。您最好编写一个解析器来将您的字符串分解为构建它的标记，然后处理该树。

也许像[http://drupal.org/project/grammar_parser](http://drupal.org/project/grammar_parser)这样的东西可能会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T21:39:41.390

您可以尝试积极的前瞻和后瞻断言 (http://www.regular-expressions.info/lookaround.html)

它可能看起来像这样：

```
$content = 'string of text before some random content switch text some more random content string of text after';
$before  = preg_quote('String of text before');
$switch  = preg_quote('switch text');
$after   = preg_quote('string of text after');
if( preg_match('/(?<=' $before .')(.*)(?:' $switch .')?(.*)(?=' $after .')/', $content, $matches) ) {
    // $matches[1] == ' some random content '
    // $matches[2] == ' some more random content '
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T21:31:14.737

```
$regex = (?:(?!\{my_string\})(.*?))(\{Switch\})(?:(.*?)(?!\{my_string\}));
/* if "my_string" and "Switch" aren't wrapped by "{" and "}" just remove "\{" and "\}" */
$yourNewString = preg_replace($regex,"$1",$yourOriginalString); 
```

这可能会奏效。无法测试它知道，但我会稍后更新！如果这是您要查找的内容，我不知道，但是要否定多个字符，正则表达式语法为：

```
(?!yourString) 
```

它被称为“负前瞻断言”。

/编辑：

这应该有效并返回 true：

```
$stringMatchesYourRulesBoolean = preg_match('~(.*?)('.$my_string.')(.*?)(?<!'.$my_string.') ?('.$switch.') ?(?!'.$my_string.')(.*?)('.$my_string.')(.*?)~',$yourString); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T22:14:34.227

试试这个简单的功能：

## 函数查找内容（）

```
function find_content($doc) {
  $temp = $doc;
  preg_match_all('~{my_string}.*?{/my_string}~is', $temp, $x);
  $i = 0;
  while (isset($x[0][$i])) {
    $temp = str_replace($x[0][$i], "{REPL:$i}", $temp);
    $i++;
    }
  $res = explode('{Switch}', $temp);
  foreach ($res as &$part) 
    foreach($x[0] as $id=>$content)
      $part = str_replace("{REPL:$id}", $content, $part);
  return $res;
  } 
```

## 以这种方式使用它

```
$content_parts = find_content($doc); // $doc is your input document
print_r($content_parts); 
```

## 输出（你的例子）

```
Array
(
    [0] => Some more
{my_string}
Random content
{Switch} //This {Switch} may or may not be here, but should be ignored if it is present
More random content
{/my_string}
Content here too

    [1] => 
More content
) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T21:46:44.760

看看[PHP PEG](https://github.com/maetl/php-peg/)。它是一个用 PHP 编写的小解析器。您可以编写自己的语法并对其进行解析。在您的情况下，这将非常简单。

语法语法和解析方式都在README.md中说明

自述文件的摘录：

> ```
>  token*  - Token is optionally repeated
>   token+ - Token is repeated at least one
>   token? - Token is optionally present 
> ```

令牌可能是：

> ```
>  - bare-words, which are recursive matchers - references to token rules defined elsewhere in the grammar,
>  - literals, surrounded by `"` or `'` quote pairs. No escaping support is provided in literals.
>  - regexs, surrounded by `/` pairs.
>  - expressions - single words (match \w+) 
> ```

示例语法：（文件 EqualRepeat.peg.inc）

```
class EqualRepeat extends Packrat {
/* Any number of a followed by the same number of b and the same number of c characters
 * aabbcc - good
 * aaabbbccc - good
 * aabbc - bad
 * aabbacc - bad
 */

/*Parser:Grammar1
A: "a" A? "b"
B: "b" B? "c"
T: !"b"
X: &(A !"b") "a"+ B !("a" | "b" | "c")
*/
} 
```

# javascript - 如何在javascript中为谷歌地图标记数组赋值

> ID：10080018
> 
> 赞同：0
> 
> 时间：2012-04-09T21:18:59.443
> 
> 标签：javascript, arrays, google-maps, google-maps-api-3

我正在尝试将数组分配给下面的 javascript 函数中的标记。它不适用于 push 或注释掉的语句。我不确定是否允许地图标记具有数组。marker.mycategory 工作正常，只是数组不起作用。

```
function createMarker(latlng, name, html, category, animals) 
  {

      var markerImg = setMarker(category);

      var contentString = html;

      var marker = new google.maps.Marker({
          position: latlng,
          map: map,
          title: name,
          icon: markerImg,
          });

      for (var i = 0; i < animals.length; i++)
          marker.myanimals.push(animals[i]); 
          //marker.myanimals[i] = animals[i];

      marker.mycategory = category;                                 
      marker.myname = name;

      gmarkers.push(marker);

      google.maps.event.addListener(marker, 'click', function() {
          infowindow.setContent(contentString); 
          infowindow.open(map,marker);
          });

  } // end createMarker() 
```

感谢您对此的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T08:01:42.903

[google.maps.Marker](https://developers.google.com/maps/documentation/javascript/reference#Marker)扩展了[google.maps.MVCObject](https://developers.google.com/maps/documentation/javascript/reference#MVCObject)，所以最好使用`MVCObject`.

代替：

```
for (var i = 0; i < animals.length; i++)
      marker.myanimals.push(animals[i]); 
      //marker.myanimals[i] = animals[i];

  marker.mycategory = category;                                 
  marker.myname = name; 
```

采用 ：

```
marker.setValues({
   mycategory : category,
   myname : name,
   myanimals : JSON.parse(JSON.stringify(animals))  //Deep copy of 'animals' array
}); 
```

要访问属性，请使用`get`方法（例如`marker.get('mycategory')`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T21:34:08.100

在你的 for 循环之前添加一个`marker.myanimals = [];`，而不是它应该工作

# c# - 设计模式：保存私有成员

> ID：10080023
> 
> 赞同：1
> 
> 时间：2012-04-09T21:19:17.337
> 
> 标签：c#, database, design-patterns

假设我们有一个 Potato 类（以及因此的实例），它具有用于其他方法但不假装为 public 的属性 smoothness。此属性在创建实例时设置，并且仅在实例内部使用。

此外，我的系统应该支持多个数据库驱动程序，因此我有一个接口“数据库适配器”，它将使用使用我目前要使用的驱动程序的类进行实例化。

现在问题来了。我需要使对象（马铃薯）持久化并将其保存到数据库中，因此我应该使用数据库适配器类来保存马铃薯的平滑度，但是..它是私有的！如何发送马铃薯的光滑度而不使其可用于其他目的？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T03:09:18.980

您可以创建一个导入器/导出器接口对，将其“状态”外部化，`Potato`而无需访问其实现细节（在这种情况下，它的私有成员和数据类型）。他们是建设者的类型。

```
public class Potato {
  public interface IExporter {
    void AddSmoothness(string value);
  }
  public interface IImporter {
    string ProvideSmoothness();
  }

  public Potato(IImporter importer) {
    this.smoothness = int.Parse(importer.ProvideSmoothness());
  }

  public void Export(IExporter exporter) {
    exporter.AddSmoothness(this.smoothness.ToString());
  }

  public Potato(int smoothness) {
    this.smoothness = smoothness;
  }

  private int smoothness;
} 
```

然后，您的数据库适配器类将实现相关接口并使用相应的方法。[在这里](http://www.javaworld.com/javaworld/jw-01-2004/jw-0102-toolbox.html)寻找最初的想法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T22:15:42.003

编写一个允许对象保存自己的方法，将某种编写器作为参数。由于这是一个数据库，您可能需要同时拥有 Insert 和 Update 方法，而不仅仅是 Save 方法。您也可以将它们放入接口中。

粗略的例子：

```
public interface IDatabaseSaveable
{
   void InsertToDatabase(Database pDatabase);
   void UpdateDatabase(Database pDatabase);
}

public class Potato : IDatabaseSaveable
{
   private int mID;
   private double mSmoothness;

   public void InsertToDatabase(Database pDatabase)
   {
      pDatabase.InsertToPotatoes(mID, mSmoothness, ...);
   }

   public void UpdateDatabase(Database pDatabase)
   {
      pDatabase.UpdatePotatoes(mID, mSmoothness, ...);
   }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T21:58:03.513

这是将平滑度属性标记为 的变体`internal`。假设土豆必须有一个`smoothness`集合才能使用它，那么内部构造函数可能会更好。我会相信有一个很好的理由来隐藏平滑度。或许是马铃薯的谦虚？

```
public class Potato
{
    internal int Smoothness { get; set; }

    internal Potato(int smoothness)
    {
        this.Smoothness = smoothness;
    }
    private Potato() { }
} 
```

只有同一程序集中的类才能`Potato`使用内部构造函数实例化 a。并且只有同一个程序集中的类才能访问 Smoothness（这样他们就可以保存马铃薯了。）

# javascript - 如何在没有附加父 div 的情况下拖动链接？

> ID：10080024
> 
> 赞同：1
> 
> 时间：2012-04-09T21:19:23.037
> 
> 标签：javascript, jquery, tinymce

我有一个由 div 包含的链接图像。我希望能够**将链接的图像拖到**一个 tinyMCE 控件，而不需要其周围的 DIV。

HTML：

```
<div id="image_preview"><a href="somelink"><img src="someimage" /></a></div> 
```

无论出于何种原因，它都会将 DIV 与 IMG 和 A 一起拖动。有没有办法让它不拖动 DIV。我已经尝试在 DIV 上阻止默认的 ondrag、onmousedown 等，但没有任何阻力。

我试过了：

```
$(document).ready(function(){
    $('#image_preview').on('mousedown', function(){
        return false;
    });
}); 
```

和：

```
$(document).ready(function(){
    $('#image_preview').on('dragstart', function(e){
        e.preventDefault();
    });
}); 
```

还有其他一些事情，但我当然知道除了防止在 DIV 中拖动任何东西之外，这些都不会做任何事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T22:14:23.920

HTML：

```
<div id="image_preview"><a href="somelink"><img src="someimage" /></a></div>

    <div id="anotherdiv"></div> 
```

jQuery：

```
$(function() {
        $( "img" ).draggable({
            stop: function(event, ui) {
            $(this).appendTo('#anotherdiv');
        }            
        });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-14T04:30:38.123

在制作与 TinyMCE 一起使用的拖放图像窗格时，我遇到了这个问题。这个解决方案使用 Firefox 的原生拖放对我有用：我没有像上面提到的那样用 td、tr 等包装 img 标签，而是在图像前放置了一个小注释：. 这足以让它在拖放中排除父元素，这是一个 DIV。我希望这可以帮助别人！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T21:24:54.753

将您的标记更改为：

```
<div draggable="false"><a href="somelink" draggable="false"><img src="someimage" draggable="true" /></a></div> 
```

您应该能够通过使用以下内容来防止 IE 的默认拖动行为：

```
document.ondragstart = function () { 
    return false; 
}; 
```

# c++ - 可以在 C++ 代码而非 C 代码上“轻松”完成的编译器优化示例

> ID：10080025
> 
> 赞同：5
> 
> 时间：2012-04-09T21:19:30.477
> 
> 标签：c++, c, optimization, compiler-optimization

这个问题谈到了在 C 中无法轻易实现的排序功能的优化： [qsort 与 std::sort 的性能？](https://stackoverflow.com/questions/4708105/performance-of-qsort-vs-stdsort)

与 C++ 相比，是否有更多的编译器优化示例在 C 中是不可能或至少难以实现的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-09T21:32:23.160

正如@sehe 在评论中提到的那样。它与抽象有关。换句话说，如果该语言允许编码人员更好地表达**意图**，那么它可以发出以更优化的方式实现该意图的代码。

一个简单的例子是`std::fill`。当然对于基本类型，您可以使用`memset`，但是，假设它是一个 32 位的数组`unsigned long`。`std::fill` **知道**数组大小是 32 位的倍数。根据编译器的不同，它甚至可以假设数组在 32 位边界上正确对齐。

所有这些结合起来**可能**允许编译器发出一次将值设置为 32 位的代码，而无需运行时检查以确保这样做是有效的。如果幸运的话，编译器会识别到这一点，并用一个特别有效的架构特定版本的代码替换它。

（实际上 gcc 和可能其他主流编译器实际上对任何可能被认为等同于 a 的东西都这样做了`memset`，包括`std::fill`）。

通常，`memset`以对这些类型的事物进行运行时检查以选择最佳代码路径的方式实现。虽然这种差异可能可以忽略不计，但我们的想法是我们更好地表达了用特定值“填充”数组的**意图，因此编译器能够做出稍微更好的选择。**

其他更复杂的语言特性很好地利用意图的表达来获得更大的收益，但这是最简单的例子。

需要明确的是，我的观点不是`std::fill`“更好” ，而是 C++ 如何允许**更好地向编译器表达意图**`memset`的示例，允许它在编译时拥有更多信息，从而使一些优化更容易实现.

 *** * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T22:16:35.193

这在一定程度上取决于您认为这里的优化是什么。如果您纯粹将其视为“std::sort vs. qsort”，那么还有数以千计的其他类似优化。在以下情况下，使用 C++ 模板可以支持内联，其中 C 中唯一合理的选择是使用指向函数的指针，并且几乎没有已知的编译器会内联被调用的代码。根据您的观点，这要么是单个优化，要么是它们的整个（开放式）系列。

另一种可能性是使用模板元编程将某些东西转换为通常必须在运行时使用 C 计算的编译时常量。理论上，您通常*可以*通过嵌入幻数来做到这一点。这可以通过 a `#define`into C 实现，但可能会失去上下文、灵活性或两者兼而有之（例如，在 C++ 中，您可以在编译时定义一个常量，从该输入执行任意计算，并生成其余部分使用的编译时常量代码。鉴于您可以在 a 中执行的计算更加有限`#define`，因此几乎不可能经常这样做。

还有一种可能性是函数重载和模板特化。这些是分开的，但给出了相同的基本结果：使用专用于特定类型的代码。在 C 中，为了使您处理的函数数量保持合理，您经常最终编写代码（例如）将所有整数转换为 a `long`，然后对其进行数学运算。模板、模板特化和重载使得使用保持较小类型其本机大小的代码变得相对容易，这可以显着提高速度（特别是当它可以启用数学向量化时）。

最后一个明显的可能性源于简单地提供相当多的预先构建的数据结构和算法，并允许将这些东西打包以便相对容易、有效地重用。我怀疑我什至可以用我知道的相对低效的数据结构和/或算法来计算我用 C 编写代码的次数，仅仅是因为不值得花时间去寻找（或适应）一个更有效的手头的任务。是的，如果它真的成为一个*主要*瓶颈，我会费心去寻找或编写更好的东西——但是做一些比较，用 C++ 编写时速度翻倍仍然是相当普遍的。

然而，我应该补充一点，所有这些无疑都*可以*用 C 语言实现，至少在理论上是这样。如果您从语言复杂性理论和计算理论模型（例如图灵机）之类的角度来处理这个问题，那么毫无疑问 C 和 C++ 是等价的。只要有足够的工作为每个函数编写专门的版本，理论上你就可以/可以用 C 做所有这些事情，就像用 C++ 做的一样。

从你可以计划在实际项目中真正编写什么代码的角度来看，故事变化非常快——你能做什么的限制主要取决于你可以合理管理的东西，而不是像所代表的计算理论模型那样由语言。在 C 中几乎完全是理论上的优化级别不仅实用，而且在 C++ 中非常常规。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-09T21:56:43.937

即使是`qsort`vs`std::sort`示例也是无效的。如果需要 C 实现，它可以放置 in 的内联版本`qsort`，`stdlib.h`并且任何体面的 C 编译器都可以处理内联比较函数。通常不这样做的原因是它非常臃肿并且性能优势令人怀疑——C++ 人往往不关心的问题......**

# mysql - 在 MySQL 中，将两列合并为索引是否有好处？

> ID：10080026
> 
> 赞同：2
> 
> 时间：2012-04-09T21:19:44.673
> 
> 标签：mysql, indexing

在阅读[MySQL 如何使用索引](http://dev.mysql.com/doc/refman/5.0/en/mysql-indexes.html)之后，我有一个疑问：将 A 列和 B 列转换为索引是否有好处，以防它们在我的大多数查询中被求和？

我的问题主要是因为上面的链接列出了 MIN 和 MAX 函数，以及 COUNT() 并且它们与 SUM 属于同一组（聚合函数）：

[http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_sum](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_sum)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:39:53.450

您使用索引来帮助查找内容。因此，您需要在 where 子句和连接以及 order/group by 中使用的列中使用它。一旦你有了你想要的行，那就是当你开始计数和求和时，索引就无济于事了。

因此，如果在选择中使用了列：否

在哪里或加入：是

按顺序/分组：可能。

PS：对于表上所有行的选择 min()/max()，索引有助于您不必扫描表而直接找到它。这同样不适用于 sum。

# soa - SOA 的最佳通用消息格式？

> ID：10080028
> 
> 赞同：0
> 
> 时间：2012-04-09T21:20:14.517
> 
> 标签：soa, distributed, distributed-computing, distributed-system

如果我有一堆服务器（最终是服务器组），每一个都是不同的服务 (SOA)，我希望它们能够：

*   通过 TCP 在高吞吐量、低延迟、不限流量的网络上发送请求和接收响应。
*   使用以下通用消息格式：
    *   编码和解码/解析速度快
    *   支持列表和二进制字符串
    *   不一定需要一次更新所有服务（例如，添加一个字段不应阻止过时的服务读取消息并选择他们期望的所有字段）

你们会推荐哪种格式？我目前正在研究将消息编码为 BSON，但想听听一些建议。

谢谢 ：-）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T03:11:38.163

感谢@Radu 对此答案的评论。

*   [消息包](http://www.msgpack.org "消息包")
*   [Google 的协议缓冲区](http://code.google.com/p/protobuf/ "Google 的协议缓冲区")
*   [节约](http://thrift.apache.org/ "节约")

都是不错的选择。[更多信息在这里](http://www.igvita.com/2011/08/01/protocol-buffers-avro-thrift-messagepack/ "更多信息在这里")。

# java - 向 JFrame 添加更多 JComponent

> ID：10080029
> 
> 赞同：0
> 
> 时间：2012-04-09T21:20:18.240
> 
> 标签：java, swing, jframe, jcomponent

单个键（在代码 KeyboardButtons 中）扩展了 JComponent。当我尝试将主 JFrame 添加到主 JFrame 时，我可以为单个键执行此操作，当尝试添加另一个键时，第一个键没有显示。

你能看看代码告诉我问题出在哪里吗？

### MainFrame.java：

```
package keyboard;

import java.awt.*;
import javax.swing.JFrame;

public class MainFrame extends JFrame {

public MainFrame() throws HeadlessException {
    setTitle("Keyboard");
    setSize(1024, 768);

}

public static void main(String[] args) throws InterruptedException {
    JFrame mainWindow = new MainFrame();
    mainWindow.setDefaultCloseOperation(EXIT_ON_CLOSE);

    Point left5 = new Point(210, 210);
    Point left4 = new Point(410, 110);
    Point left3 = new Point(580, 120);
    Point left2 = new Point(680, 200);
    Point left1 = new Point(800, 500);

    Keyboard kb = new Keyboard(left1, left2, left3, left4, left5);
    KeyboardButton[] buttons = kb.registerKeys();

    Container c = mainWindow.getContentPane();
    c.add(buttons[0]);
    c.add(buttons[1]);
    mainWindow.setVisible(true);

}

} 
```

键盘按钮.java：

```
package keyboard;

import java.awt.Color;
import java.awt.Graphics;
import java.awt.Polygon;
import java.awt.event.*;
import javax.swing.JComponent;

public class KeyboardButton extends JComponent implements MouseListener {

Polygon polygon;
boolean isActive;
final Color ACTIVE_COLOR = Color.red;
final Color INACTIVE_COLOR = Color.blue;

public KeyboardButton(Polygon p) {
    polygon = p;
    addMouseListener(this);
}

private void checkMousePosition(MouseEvent e) {
    if (polygon.contains(e.getX(), e.getY())) {
    setState(true);
    }
}

public void mouseClicked(MouseEvent e) {
}

public void mouseEntered(MouseEvent e) {
}

public void mouseExited(MouseEvent e) {
}

public void mousePressed(MouseEvent e) {
    checkMousePosition(e);
    System.out.println(this + " pressed");
}

public void mouseReleased(MouseEvent e) {
    setState(false);
    System.out.println(this + " released");

}

@Override
public void paint(Graphics g) {
    super.paint(g);
    g.setColor(isActive ? ACTIVE_COLOR : INACTIVE_COLOR);
    g.drawPolygon(polygon);

}

void setState(boolean state) {
    isActive = state;
    repaint();
}
} 
```

键盘.java：

```
package keyboard;

import java.awt.Color;
import java.awt.Graphics;
import java.awt.Point;
import java.awt.Polygon;
import javax.swing.JComponent;

public class Keyboard extends JComponent {

Point[] leftFingers;
Point leftCenter = new Point(300, 600);

public Keyboard(Point left1, Point left2, Point left3, Point left4, Point left5) {
    leftFingers = new Point[5];
    leftFingers[0] = left1;
    leftFingers[1] = left2;
    leftFingers[2] = left3;
    leftFingers[3] = left4;
    leftFingers[4] = left5;
}

public KeyboardButton[] registerKeys() {
    Polygon[] polygons = generateKeyPolygons(calculateBordersOfKeys(calculateCentersBetweenEachTwoFingers(leftFingers)));
    KeyboardButton[] buttons = new KeyboardButton[5];
    for (int i = 0; i < polygons.length; i++) {
    buttons[i] = new KeyboardButton(polygons[i]);
    }
    return buttons;
}

private Point[] calculateBordersOfKeys(Point[] fingers) {
    Point[] centers = calculateCentersBetweenEachTwoFingers(fingers);
    Point[] result = new Point[6];

    result[0] = calculateCentralSymmetry(centers[0], fingers[0]);
    System.arraycopy(centers, 0, result, 1, centers.length);
    result[5] = calculateCentralSymmetry(centers[3], fingers[4]);
    return result;
}

@Override
public void paint(Graphics g) {
    super.paint(g);
    g.setColor(Color.red);
    g.drawOval(leftCenter.x - 25, leftCenter.y - 25, 50, 50);

    for (int i = 0; i < leftFingers.length; i++) {
    g.drawOval(leftFingers[i].x, leftFingers[i].y, 10, 10);

    }
}

private Polygon[] generateKeyPolygons(Point[] borders) {
    Polygon[] polygons = new Polygon[5];
    for (int i = 0; i < borders.length - 1; i++) {
    Polygon p = new Polygon();
    p.addPoint(leftCenter.x, leftCenter.y);
    p.addPoint(borders[i].x, borders[i].y);
    p.addPoint(borders[i + 1].x, borders[i + 1].y);
    polygons[i] = p;
    }

    return polygons;
}

private Point[] calculateCentersBetweenEachTwoFingers(Point[] fingers) {
    Point[] centers = new Point[4];
    for (int i = 0; i < fingers.length - 1; i++) {
    centers[i] = new Point(((fingers[i].x + fingers[i + 1].x) / 2), ((fingers[i].y + fingers[i + 1].y) / 2));
    }
    return centers;
}

private Point calculateCentralSymmetry(Point toReflected, Point center) {
    Point reflection = new Point();

    if (toReflected.x > center.x) {
    reflection.x = center.x - Math.abs(center.x - toReflected.x);
    } else {
    reflection.x = center.x + Math.abs(center.x - toReflected.x);
    }

    if (toReflected.y > center.y) {
    reflection.y = center.y - Math.abs(center.y - toReflected.y);
    } else {
    reflection.y = center.y + Math.abs(center.y - toReflected.y);
    }

    return reflection;
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:34:10.080

尝试使用另一个 LayoutManager，或者在我看来，您正在尝试在屏幕上手动绘制形状，我建议将它们全部绘制在一层上。（有一个 JComponent 的 paintComponent() 方法调用 KeyboardButton.paint() 和其他绘画方法，然后你可以添加一个 JComponent）

# javascript - Javascript 将变量视为字符串，为什么？

> ID：10080030
> 
> 赞同：3
> 
> 时间：2012-04-09T21:20:19.507
> 
> 标签：javascript, string, variables

我有变量 y，它是一个小计。它的值根据 html 发生的情况而有所不同，但在整个脚本中我声明它是这样的：

```
var y = 21.78; 
```

等等。为什么在我将总数相加的最后一个方程式中，当我想添加值时，它会将它们视为字符串？

```
var tax = (0.055*y).toFixed(2);
var totalprice = y+tax;
/* totalprice holds "21.781.20" instead of 22.98 */ 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-09T21:23:24.077

根据：

[https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Number/toFixed](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Number/toFixed)

`toFixed()`返回：

> 数字的字符串表示形式，不使用指数表示法，并且在小数点后具有精确的数字。

因此，`y+tax`被转换为字符串，因为其中一个操作数是字符串。

在我看来，这是有道理的，因为 Javascript 的固有数字类型无法存储特定数量的小数位数，因此字符串将是最合适的数据结构来存储它。

我建议您在调用*之前*`toFixed()`完成所有添加，因为该方法最适合格式化显示输出。

```
var taxRate = 0.055;
var subtotal = 21.78;

var tax = (taxRate * subtotal).toFixed(2),
totalprice = ((1+taxRate) * subtotal).toFixed(2);
document.write(totalprice);
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T21:37:37.490

这是一个简单的修复。将“+”放在 tax 变量前面以将其转换为数字。

```
var y = 21.78;
var tax = (0.055*y).toFixed(2);
var totalprice = y+ (+tax);
totalprice === 22.98; 
```

如果您在使用 toFixed 时不希望出现任何舍入错误，请在脚本中包含对它的重新实现。 [http://bateru.com/news/2012/03/reimplementation-of-number-prototype-tofixed/](http://bateru.com/news/2012/03/reimplementation-of-number-prototype-tofixed/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-09T21:23:40.367

.toFixed() 方法返回一个字符串。尝试将该方法作为所有其他计算之后的最后一步。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T21:25:09.133

根据我的经验，如果有任何机会，Javascript 会将“+”号视为连接而不是添加。它不止一次让我发疯。我通常会这样做而不是机会串联：

```
var totalprice = parseInt(y)+parseInt(tax); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2016-06-18T13:01:05.517

当字母取代价值时，乘以`1`当你需要时`+`。

```
var totalprice = (y*1) + tax . 
```

其他操作数工作正常，只是`+`变量替换值时需要特殊处理的操作数。

# database - Django 论坛数据库设计

> ID：10080033
> 
> 赞同：0
> 
> 时间：2012-04-09T21:20:32.900
> 
> 标签：database, django, notifications, forum

我正在扩展现有的 Django 论坛应用程序 (DjangoBB)，以允许用户选择加入/退出特定论坛和/或特定线程的通知。我的网站上已经有一个现有的通知基础设施，以及一个现有的全局设置来打开/关闭论坛通知。

我想要做的是允许每个用户订阅/取消订阅特定论坛或线程，有效地覆盖他们的全局设置。例如，如果我的全局设置为“通知关闭”，那么我将不会收到任何通知，除非我将特定论坛设置为“通知开启”，在这种情况下，我将收到该论坛中所有内容的通知，除非我设置该论坛中的主题为“关闭通知”。如果任何线程或主题没有设置集，则默认为链上。

我的问题是在 Django 的数据库中表示所有这些的最佳方式是什么？我有两个想法：

```
class ForumNotificationSetting(models.Model):
    user = models.ForeignKey(User)
    forum = models.ForeignKey(Forum)
    setting = models.NullBooleanField(default=None) 
```

我也会有一个类似的 TopicNotificationSetting 模型。这样，每当用户更改他们的论坛设置时，我都会创建（或修改）一个 NotificationSetting 对象以反映他们的新设置。这种方法看起来很简单，但缺点是如果很多人为很多论坛创建设置，那么每当发布新的论坛帖子时，为每个人创建通知将是 O(n^2)。（我认为...？）

我能想到的第二种方法是在每个用户的个人资料中为他们设置了设置的所有论坛创建一个 ManyToMany 字段。这种方式似乎更复杂（因为我必须有 4 个 M2M 字段，用于“论坛开启”、“论坛关闭”、“主题开启”和“主题关闭”），我不确定是否会有是否有任何性能优势。

你将如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T08:10:37.267

也许您可以在 Thread 或 Forum 对象级别上创建 M2M 关系，例如：

```
class Thread(models.Model):
    subscribers = models.ManyToManyField(User)
    other attributes... 
```

然后，当用户（取消）订阅 Thread 时，您可以从 Thread 对象的订阅者属性中添加或删除它们。

在您的应用程序逻辑中，当用户创建帖子、帖子或论坛时，您可以检查他们的整体通知设置，如果设置为 True，则将它们添加到新创建的帖子、帖子或论坛的订阅者属性中。

每次更新线程、帖子或论坛时，您都可以通知所有订阅者。

我假设您需要一些逻辑来处理升级（我找不到合适的词，抱歉），即我假设线程更新的通知也应该触发论坛更新的通知（或者应该？）。然后，您当然应该注意不要让用户收到针对单个帖子更新的帖子、线程和论坛通知的垃圾邮件……

# android - 如何从数据库中获取列表中特定行中的项目？

> ID：10080035
> 
> 赞同：0
> 
> 时间：2012-04-09T21:20:45.673
> 
> 标签：android, sqlite, listview

我一直在寻找很多问题，但他们没有问或回答我在寻找什么，所以这就是我想要做的。到目前为止，我在女巫中有一个项目，我添加了一个预填充的数据库，其中包含一个包含 6 列数据的表，主 xml 只显示列表视图，我正在使用适配器、光标、SQLiteHelper 等。一切正常并且显示我的自定义 itemlist.xml 一切都很好，现在在列表的每个项目中，我只显示每条记录的 3 件事（第二、第四和第五列数据）（它们都包含我之前提到的 6 个列），我希望能够使用 onclickitemlistener 在 toast 中显示该项目第三列中的数据，我该如何实现？我能够显示列表项 id，所以有人可以在这里帮助我，谢谢这里是 som 代码：​​来自 y 主要活动的代码

```
public class DBlistActivity extends Activity {

private mediosHelper dbmediosHelper = null;
private Cursor ourCursor = null;
FancyAdapter adapter = null;

  @Override
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    ListView myListView = (ListView) findViewById(R.id.mylistView);

    dbmediosHelper = new mediosHelper(this);
    try {
        dbmediosHelper.createDataBase();
} catch (IOException ioe) {
    throw new Error("Unable to create database");
}
try {
    dbmediosHelper.openDataBase();
}catch(SQLException sqle){
    throw sqle;
}
try {   
ourCursor = dbmediosHelper.getCursor();
startManagingCursor(ourCursor);
}catch(SQLException sqle){

    throw sqle;

}

adapter = new FancyAdapter(ourCursor);
myListView.setAdapter(adapter);

myListView.setOnItemClickListener(onListClick);

}

class FancyAdapter extends CursorAdapter {
        FancyAdapter(Cursor c) {
                super (DBlistActivity.this, c);
        }
                public void bindView(View row, Context ctxt, Cursor c) {
                    ViewHolder holder = (ViewHolder) row.getTag();
                    holder.populateForm(c, dbmediosHelper);
}
                public View newView(Context ctxt, Cursor c, ViewGroup parent){
                    LayoutInflater inflater = getLayoutInflater();
                    View row = inflater.inflate(R.layout.listitem, parent, false);
                    ViewHolder holder = new ViewHolder(row);
                    row.setTag(holder);
                    return(row);
                }
}

class ViewHolder{
    public TextView nombre=null;
    public TextView estado=null;
    public TextView ciudad=null;
    ViewHolder (View row){
        nombre = (TextView) row.findViewById(R.id.medioName);
        estado = (TextView) row.findViewById(R.id.medioEstado);
        ciudad = (TextView) row.findViewById(R.id.medioCiudad);
    }
    void populateForm(Cursor c, mediosHelper r){
        nombre.setText(r.getName(c));
        estado.setText(r.getEstado(c));
        ciudad.setText(r.getCiudad(c));
    }
}

private AdapterView.OnItemClickListener onListClick=new AdapterView.OnItemClickListener() {
    public void onItemClick(AdapterView<?> parent, View view, int position, long id){
        Toast.makeText(getApplicationContext(), String.valueOf(id), Toast.LENGTH_SHORT) .show();    
    }
}; 
```

从我的 mediosHelper

```
public Cursor getCursor() {
    SQLiteQueryBuilder queryBuilder = new SQLiteQueryBuilder();
    queryBuilder.setTables(TABLE_NAME);
    String[] asColumsToReturn = new String[] { COLUMN_ID, COLUMN_CODE, COLUMN_NAME, COLUMN_URL, COLUMN_ESTADO, COLUMN_CIUDAD};
    Cursor mCursor = queryBuilder.query(myDataBase, asColumsToReturn, null, null, null, null, null);
    return mCursor;
}
public CharSequence getId(Cursor c) {
    return (c.getString(0));
}
public CharSequence getCode(Cursor c) {
    return (c.getString(1));
}
public String getName(Cursor c){
    return(c.getString(2));
}
public String getUrl(Cursor c) {
    return (c.getString(3));
}
public String getEstado(Cursor c) {
    return (c.getString(4));
}
public String getCiudad(Cursor c) {
    return (c.getString(5));
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:25:09.490

您需要获取用于填充适配器的光标。一旦你用 c.moveToPosition(position) 将它移动到你在 onItemClickedCallback 中的位置。比您可以访问所有列 (cursor.getColumnIndex("_id"))

编辑：

```
class MyActivity extends Activity implements OnItemClickListener{
FancyAdapter adapter = null;
...

adapter = new FancyAdapter(ourCursor);
myListView.setAdapter(adapter);

myListView.setOnItemClickListener(this);

@Override
public void onItemClick(AdapterView<?> parent, View v, int position, long id) {
    // TODO Auto-generated method stub
Cursor c = adapter.getCursor();
    c.moveToPosition(position);
    int id = c.getInt(c.getColumnIndex("_id");
}
} 
```

# xml - 如何在matlab中将xml文件转换为矩阵

> ID：10080036
> 
> 赞同：0
> 
> 时间：2012-04-09T21:20:46.527
> 
> 标签：xml, matlab

我有 2600 个带有数据的 xml 文件，我想知道是否有一种简单的方法可以将它们转换为 excel 中的表格或 Matlab 中的矩阵。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:22:09.840

看看[`xmlread()`](http://www.mathworks.co.uk/help/techdoc/ref/xmlread.html)，看看这对你有没有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T21:23:08.760

如果不了解有关 XML 模式的更多信息，就无法回答。

除了解析 XML 并将您获得的树映射到某种表之外，没有“简单的方法”。您必须弄清楚该映射将是什么。解析和设置值很容易；映射只有您知道。

# facebook - 未使用 Facebook 元标签

> ID：10080048
> 
> 赞同：0
> 
> 时间：2012-04-09T21:21:43.090
> 
> 标签：facebook, wordpress, meta

在 wordpress 中，我的标题中有这些元标记：

```
<meta property="og:url" content="http://frontgroupdesign.com/1percent/profile/the-billionaire-runner-up-meg-whitman/" />
<meta property="og:type" content="website" />
<meta property="og:title" content="I voted for Meg Whitman as Ms. 1% of California | Who will you vote for?" />
<meta property="og:image" content="http://frontgroupdesign.com/1percent/wp-content/themes/california-1p/images/ca_squeeze.png" /> 
```

出于某种原因，它使用了我昨天设置的元标记。我尝试使用 facebooks lint/debugger 工具来更新它们，但它仍然使用旧的。

关于为什么会发生这种情况的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:23:22.457

在我看来很好。

![](../Images/40336a193c896efcc6e4b51b3978666f.png)

[https://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Ffrontgroupdesign.com%2F1percent%2Fprofile%2Fthe-billionaire-runner-up-meg-whitman%2F](https://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Ffrontgroupdesign.com%2F1percent%2Fprofile%2Fthe-billionaire-runner-up-meg-whitman%2F)

# jquery - 在 jQuery Mobile 中的页面加载之间保留 Google 地图

> ID：10080052
> 
> 赞同：0
> 
> 时间：2012-04-09T21:22:13.250
> 
> 标签：jquery, google-maps, jquery-mobile, google-maps-api-3, google-maps-mobile

我正在开发一个真正依赖谷歌地图的 jQuery Mobile 应用程序。尽管我一遍又一遍地尝试，但似乎我无法处理页面转换和地图持久性。

我真的致力于这样做，而我让它工作的方式就像某种我根本不喜欢的肮脏的解决方法。

我有这个在 pageShow 上为地图页面运行的函数：

```
initMap : function (){
    if (!Mapper.map || !$('#canvasMapa div').length){ // Or has been removed weirdessly
        var mapOptions = {
            zoom : 13,
            center: new google.maps.LatLng (37.38264, -5.996295), 
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            disableDefaultUI: true // Disabling buttons and stuff
        };
        // We create a new one
        Mapper.map = new google.maps.Map(document.getElementById('canvasMapa'),mapOptions);
        if (Mapper.localStorage && !Mapper.favsLoaded)
            Mapper.loadFavorites();
        if (Mapper.markers.length)
            Mapper.recolocateMarkers();
    }
    else {
        console.log(Mapper.map);
        Mapper.map.fitBounds(Mapper.mapBounds);
    }

    $('#mapa').die('pageshow');
} 
```

就是这样。有用。第一个 if 检查地图是否已初始化以及是否丢失了内部 div，这种情况不时发生，但它会重新加载地图。加载地图时，它会检查应用程序中是否有任何标记，以便可以在新地图中重新分配。

这适用于在同一页面中加载对话框。随心所欲。

然后是应用程序的导航。每当您转到另一个页面时，就会发生奇怪的事情。这是我在切换到页面并返回地图时在控制台上看到的错误。

但是，地图仍然有效：

```
Uncaught TypeError: Cannot call method 'getSouthWest' of undefined
c
I.fitBounds
I.fitBounds%7Bmain,geometry%7D.js:38
S%7Bmain,geometry%7D.js:24
I.fitBounds%7Bmain,geometry%7D.js:38
BuSeViCi.initMapapp.js:78
f.event.dispatchjquery-1.7.1.min.js:3
f.event.add.h.handle.ijquery-1.7.1.min.js:3
f.event.triggerjquery-1.7.1.min.js:3
f.fn.extend.triggerjquery-1.7.1.min.js:3
e.extend.eachjquery-1.7.1.min.js:2
e.fn.e.eachjquery-1.7.1.min.js:2
f.fn.extend.triggerjquery-1.7.1.min.js:3
a.Widget._triggerjquery.mobile.min.js:17
(anonymous function)jquery.mobile.min.js:43
f.Callbacks.njquery-1.7.1.min.js:2
f.Callbacks.o.fireWithjquery-1.7.1.min.js:2
f.Callbacks.o.firejquery-1.7.1.min.js:2
wjquery.mobile.min.js:41
f.fn.extend.on.ejquery-1.7.1.min.js:3
f.event.dispatchjquery-1.7.1.min.js:3
f.event.add.h.handle.ijquery-1.7.1.min.js:3 
```

指向 app.js 的行是这样说的：`Mapper.map.fitBounds(Mapper.mapBounds);`

我所做的唯一解决方法是在`Mapper.map`导航到另一个页面时清除该变量。正如我所说，这听起来真的很脏，我想检查未定义的对象以恢复地图，因为它正在工作并且记录该对象向我显示了一个 Google Maps 对象。

我**严格**要避免使用`rel="external"`，因为这会破坏应用程序。你不能在主页上安装它，也不能用这些属性制作PhoneGaps应用程序所以......你怎么看？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T07:03:12.527

该错误意味着它`Mapper.mapBounds`为空，但这里没有足够的信息来确定为什么会这样。

# .net - Hadoop 将代码引入数据是实现规模化的唯一途径吗？

> ID：10080059
> 
> 赞同：0
> 
> 时间：2012-04-09T21:22:57.937
> 
> 标签：.net, architecture, hadoop

这是使用 map 和 reduce 实现缩放的唯一方法吗？

我讨厌这一点的是，坚持不懈的无知都被抬高了。应该是 HDFS 通过一个接口暴露自己，你不应该关心它是用什么语言编写的，或者为什么。就像您如何编写 ODBC 一样，它将插入 Oracle、Sql Server 以及不在任何操作系统上运行的东西。

我知道 Hive，但我不认为它非常适合更繁重的计算，例如矩阵操作、高斯分析等。

另一个问题是编写复杂的指令集和这样的事情所带来的依赖。这意味着您必须弄清楚如何移植代码并将其与任何依赖项一起安装到服务器本身上。这是一个很大的基础设施成本！而且在（平台即服务）Paas 云中也很难做到。

例如使用 Hadoop 流的示例。你必须确保你的二进制文件是针对目标服务器内核编译的。例如。Linux 与 Windows 等。您还必须确保所有项目都引用相同版本的依赖项。这又是牛市。如果您有多个团队，则需要大量协调和开销。我们迁移到 SOA 是为了摆脱其中的一些问题。

我知道数据比代码重，将代码放在数据本身旁边效率更高，但这是实现规模的唯一方法吗？在处理 Hadoop 应该处理的数据量时，您是否绝对必须牺牲关注点分离。

例如，是的，您可以将 CLR 嵌入到 Sql server 中，但实际上这仅保留给真正严重的瓶颈，无法以任何其他方式解决。aka - 如果你想这样称呼它，它是一种 hack 或反模式。这样做太多，您的产品会与 Microsoft Sql Server 高度耦合。您不能只是将其换成 Oracle 或其他业务需要更改的东西。不好。

同样在所有计算历史中，我们总是将数据带到代码中，而不是相反。例如。您将数据从数据库加载到 Orm，加载到服务，加载到内存，加载到缓存，然后加载到指令集。这是有原因的，即 SOC

我的问题是，map & reduce + no sql 是否是您只需将代码放在数据旁边的情况之一，而不是根据需要将数据加载到指令集（例如，某处的负载平衡服务）云端）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T15:56:04.383

这取决于你有多少数据。

在某些时候，通过网络移动数据变得不切实际。如果您需要对几 TB 的数据进行 map reduce，那么即使使用千兆网络，数据传输时间也很重要。

如果您的数据在云中，那么您还需要考虑从云服务传输数据的成本。

# jquery - 每次我在给定元素内移动鼠标时，鼠标悬停和鼠标离开触发

> ID：10080067
> 
> 赞同：15
> 
> 时间：2012-04-09T21:23:25.140
> 
> 标签：jquery, mouseenter, mouseleave

我正在创建一个站点，您将鼠标悬停在图像上并显示一个元素（在这种情况下，通过将其高度从 0 扩展到 154px）。

```
jQuery(document).ready(function(){
    jQuery("#dropdown-menu-create .dropimage").mouseover(function(){
        jQuery("#dropdown-menu-create .toggle").animate({height:"154px"},200);
    });
    jQuery("#dropdown-menu-create .dropimage").mouseout(function(){
        jQuery("#dropdown-menu-create .toggle").animate({height:"0"},200);
    });
}); 
```

鼠标进入时内容会展开，鼠标离开时内容会折叠，但每次鼠标*在元素内*移动时，内容都会反复展开和折叠，直到鼠标离开元素。

我以前从来没有遇到过这个问题，而且我过去也使用过这些功能，所以我不知道发生了什么。有任何想法吗？

编辑：

```
jQuery(document).ready(function(){
    jQuery("#dropdown-menu-create .dropimage").mouseenter(function(){
        jQuery("#dropdown-menu-create .toggle").stop(true,true).animate({height:"154px"},200);
    });
    jQuery("#dropdown-menu-create .dropimage").mouseleave(function(){
        jQuery("#dropdown-menu-create .toggle").stop(true,true).animate({height:"0"},200);
    });
}); 
```

我现在正在使用上面的代码，但仍然遇到完全相同的问题。我已经尝试了 .stop 函数的所有变体 (false,false)(false,true)(true,false)(true,true)。每个问题发生的问题不同，但仍然会发生。

终极编辑：

问题在于，一旦调用该函数，鼠标经过的内容就会被不同的内容所覆盖。因此，在任何给定点，鼠标同时进入和离开图像。通过将函数调用移动到不同的元素解决了这个问题。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-09T21:25:50.147

尝试使用[.mouseenter](http://api.jquery.com/mouseenter/)事件而不是 .mouseover

我认为那会做！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-09T21:26:18.540

您可能需要使用`mouseenter`代替`mouseover`和`mouseleave`代替`mouseout`

或者您可以尝试使用`.hover`以下功能，

```
jQuery(document).ready(function(){
    jQuery("#dropdown-menu-create .dropimage").hover(function(){ //mouseenter
        jQuery("#dropdown-menu-create .toggle").animate({height:"154px"},200);
    }, function(){ //mouseleave
        jQuery("#dropdown-menu-create .toggle").animate({height:"0"},200);
    });
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-09T21:27:32.970

由于您试图在容器上实现这一点，因此您正确的事件处理程序是`mouseenter`and `mouseleave`。

例子：

```
$("#dropdown-menu-create .dropimage").mouseenter(function(){
    $("#dropdown-menu-create .toggle").animate({height:"154px"},200);
});
$("#dropdown-menu-create .dropimage").mouseleave(function(){
    $("#dropdown-menu-create .toggle").animate({height:"0"},200);
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-09T21:25:43.507

在 .animate() 之前添加 .stop() 将有助于解决此问题。通过停止前一个动画，如果用户快速将鼠标移动到元素上多次，这可以防止动画多次触发

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-05-09T20:03:51.020

尽管这可能不完全相关，但我遇到了类似的问题。我会在 div 上移动最多的所有内容，该事件都会触发。为了解决这个问题，我意识到当“悬停”事件被触发时，切换的 div 已经成为我的鼠标所在的那个。为了修复它，我只是在那个事件上添加了一个事件，以便在鼠标离开时将其淡出。

```
 .profile-about {
      position: absolute;
      width: 100%;
      height: 100%;
      top: 5%;
      left: 0;
      z-index: 2;
      display: none;
    }

.profile-image {
  max-height: 300px;
  max-width: 300px;
  -webkit-box-shadow: 0px 0px 13px 0px rgba(0, 0, 0, 0.75);
  -moz-box-shadow: 0px 0px 13px 0px rgba(0, 0, 0, 0.75);
  box-shadow: 0px 0px 13px 0px rgba(0, 0, 0, 0.75);
} 

    $('.profile-image').hover(function(){
      $(this).next().fadeIn(100);
    });

    $('.profile-about').mouseleave(function(){
      $(this).fadeOut(100);
    });

    <img src="img/somebody.jpg" class="profile-image">
                    <div class="profile-about">
                        <p>
                         Hello I am somebody!
                        </p>
                    </div> 
```

# neural-network - “Index Exceeds Matrix Dimensions”神经网络函数错误

> ID：10080079
> 
> 赞同：2
> 
> 时间：2012-04-09T21:24:14.150
> 
> 标签：neural-network, matlab

我有两个数据集，我从[CSV](http://en.wikipedia.org/wiki/Comma-separated_values)文件加载，并将它们拆分为 X 和 T：

```
X (3x5000) double
T (1x5000) double 
```

我正在尝试配置此功能，但我不能

[http://www.mathworks.co.uk/help/toolbox/nnet/ref/layrecnet.html](http://www.mathworks.co.uk/help/toolbox/nnet/ref/layrecnet.html)

X 具有三个特征和 5000 个示例。T 有一个特征和 5000 个示例。例如，目标是特征 1 提前 20 步。所以基本上`X(1,21) == T(1)`。

```
[X,T] = simpleseries_dataset; 
```

这非常有效，在这种情况下，我有 1x100、1x100。

但是，如果我使用自己的数据集，我会得到：

```
X = data(:,1:3)';
T = data(:,4)';
net = layrecnet(1:2,10);
[Xs,Xi,Ai,Ts] = preparets(net,X,T);

??? Index exceeds matrix dimensions.

Error in ==> preparets at 273
  ti = tt(:,FBS+((1-net.numLayerDelays):0)); 
```

我不明白，我做错了什么？

**更新**

我注意到我的数据集是 T (1x5000) **double**而示例数据集是 T (1x100) **cell**。双胞胎和细胞有什么区别？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T22:16:00.300

我通过以下方式解决了它：

```
X = num2cell(X);
T = num2cell(T); 
```

我不知道为什么; 它必须是 MATLAB 语法...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-27T13:37:35.840

为了澄清“（...）它必须是 MATLAB 语法...”：

这里的问题是从双精度数组到元胞数组的转换。Matlab 不会自动执行此操作，因为单元格可以包含此处提到的任何类型的值：http: [//www.mathworks.com/help/matlab/matlab_prog/what-is-a-cell-array.html](http://www.mathworks.com/help/matlab/matlab_prog/what-is-a-cell-array.html)

因此，正如您在回答中提到的，您可以使用 num2cell() 将双精度数组转换为元胞数组，也可以使用 cell() 从一开始就将 X 和 T 分配为元胞数组，然后将双精度值复制到其中。这种显式类型转换是必要的，因为preparets 期望元胞数组作为输入，就像ANN 包中的许多绘图函数一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T19:58:54.690

您可以通过以下方式解决它：

```
 P = con2seq(p);
   T = con2seq(t); 
```

.....％ 例如

```
p=(1 2;3 4;5 6);
t=(3;7;11); 
```

.....％现在

```
P = con2seq(p);
T = con2seq(t);
net = elmannet(1:2,12);
[Xs,Xi,Ai,Ts] = preparets(net,P,T);
net = train(net,Xs,Ts,Xi,Ai);
view(net)
Y = net(Xs,Xi,Ai);
perf = perform(net,Ts,Y); 
```

# c++ - 虚拟分配地址

> ID：10080083
> 
> 赞同：2
> 
> 时间：2012-04-09T21:24:40.933
> 
> 标签：c++, c, winapi, virtualalloc

我写了下面的代码

```
void * ptr1 = VirtualAlloc((void*)0x70000000, 32*1024*1024, MEM_RESERVE, PAGE_READWRITE);
 void * ptr2 = VirtualAlloc((void*)0x80000000, 4*1024*1024, MEM_RESERVE, PAGE_READWRITE);

```

但是 VirtualAlloc 失败并且 ptr1,ptr2 的值始终为 NULL。我想使用地址 0x70000000,0x80000000。有谁知道我可以如何使用这些地址？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-13T22:28:19.030

用户模式应用程序无法访问这部分内存。从以下[MSDN 页面](http://msdn.microsoft.com/en-us/library/aa909190.aspx)：

> 用户应用程序不能使用共享堆地址范围（0x70000000 到 0x7fffffff）调用**VirtualAlloc**，因为这对于用户应用程序是只读的，对于内核模式是读/写的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T22:24:08.807

您确定请求的内存块中的某些页面尚未保留（或提交）吗？VirtualAlloc 不能保留保留页。

为什么 0x70000000 和 0x80000000 很特别？在平面内存模型中，没有理由说一个地址比其他地址更可取。

# java - 如何将 Double.POSITIVE_INFINITY 转换为 BigDecimal？

> ID：10080084
> 
> 赞同：10
> 
> 时间：2012-04-09T21:24:44.210
> 
> 标签：java

我试过`BigDecimal.valueOf(Double.POSITIVE_INFINITY)`了，但一直在`NumberFormatException`

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-09T21:26:58.793

你不能在 中表示无穷大`BigDecimal`。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-04-09T21:29:28.663

此行为对应于该方法应该工作的[记录](http://docs.oracle.com/javase/1.5.0/docs/api/java/math/BigDecimal.html#valueOf%28double%29)方式：`valueOf`

> 参数： val - 转换为 BigDecimal 的 double。
> 
> 返回： 一个 BigDecimal，其值等于或大约等于 val 的值。
> 
> 抛出： NumberFormatException - 如果 val 是**无限**的或 NaN。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-27T11:25:28.833

您不能简单地从 BigDecimal 派生一个子类来支持 NaN 和 Infinite。在派生子类时，必须实现父类的构造函数。并且必须首先在子构造函数中调用父构造函数。BigDecimal 有许多构造函数，例如 BigDecimal(double val)。但是，正如 JAVA doc 指出的那样，double val 不应该是 NaN 或无穷大。否则，将引发 NumberFormatException。如果将 BigDecimal 扩展到 MyBigDecimal，我认为您还需要一个类似的构造函数，即 MyBigDecimal(double val)。问题是，MyBigDecimal(double val) 必须调用 super(val) 作为第一条语句（Java 要求）。您不能添加类似 if(val == Double.NaN) 的内容或在 super(val) 之前尝试 catch。所以 MyBigDecimal(double val) 函数必须像：

```
public MyBigDecimal(double val) {
    super(val);
    ...
} 
```

因此，无法将 val 设置为 Double.NaN 或 Infinite，因为这无论如何都会导致 NumberFormatException。

更不幸的是，BigDecimal 是一个只读类，也就是说，您无法使用 setValue(...) 之类的函数来重置其值。因此，您永远不能将 NaN 或无限分配给 BigDecimal 扩展类。

唯一的解决方案是使用包装器，即

```
class MyBigDecimal {
    public BigDecimal mbigDecNormalValue;
    public double mdNaNOrInf;
    ... 
```

显然，这将不是一个非常简单的实现。

很奇怪，Oracle 在 JAVA 7 中不支持 BigDecimal NaN 或无限大。但我相信 BigDecimal 最终会支持这些值。我建议您此时使用 BigDecimal 时不要触摸 NaN 或无穷大。否则在支持 NaN 和无限后，用户定义的 MyBigDecimal 可能会与新的 BigDecimal 接口冲突，并且不可避免地会导致相当多的开销编码

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-10-20T16:04:44.957

使用 Double.MIN_VALUE 和 Double.MAX_VALUE

# r - R knn 从 2 个变量开始的前向逐步特征选择

> ID：10080088
> 
> 赞同：1
> 
> 时间：2012-04-09T21:25:03.033
> 
> 标签：r, knn

我正在尝试对`knn`模型进行逐步向前的特征选择。我正在使用`FSelector`包和`forward.search()`功能。

在特征消除之前，数据集是约 400k 行 x 约 100 列。

问题是表现最好的特征没有很多级别，因此有很多联系导致模型失败。

我的问题是这样的：

如果我知道性能最好的功能是什么，有没有办法用 2 个变量而不是一个变量来启动 forward.search()？

换句话说，如果我有 5 个变量。forward.search 将通过它们寻找最好的，例如：

```
depVar ~ var1
depVar ~ var2
depVar ~ var3
depVar ~ var4
depVar ~ var5 
```

一旦确定了最好的（即`var3`）算法就会这样做：

```
depVar ~ var3 + var1
depVar ~ var3 + var2
depVar ~ var3 + var4
depVar ~ var3 + var5 
```

等等。如果我知道表现最好的单变量，有没有办法跳到第二步？

任何建议，将不胜感激。

# jquery - 支持 IE 9 的 MVC3 多文件上传插件？

> ID：10080099
> 
> 赞同：1
> 
> 时间：2012-04-09T21:26:18.553
> 
> 标签：jquery, asp.net-mvc-3, plugins, file-upload, controls

我一直在寻找支持多个文件上传的文件上传插件，但这些插件中的大多数不支持 IE9（也就是说，您不能在选择对话框中选择多个文件）。

不支持 IE9：jquery 文件上传（per blueimp）telerik 开源

有人可以提供插件解决方法、建议、代码示例吗？

任何信息，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T21:28:58.477

我真的很喜欢[Plupload](http://www.plupload.com/)，它为您提供了一个 HTML5 文件上传控件，并为旧版/不受支持的浏览器提供了各种回退（Flash、Silverlight、Gears）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T21:29:07.900

尝试上传。这真是太棒了。如果你不能让它工作，请给我发消息，但如果你仔细阅读文档，它是非常简单的！

[http://www.uploadify.com/](http://www.uploadify.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T21:29:50.817

我使用[Microsoft.Web.Helpers](http://msdn.microsoft.com/en-us/library/microsoft.web.helpers%28v=vs.99%29.aspx)命名空间中包含的[FileUpload](http://msdn.microsoft.com/en-us/library/microsoft.web.helpers.fileupload%28v=vs.99%29.aspx)。适用于所有现代浏览器。

好消息是它是 Microsoft Web 堆栈的一部分...

示例视图代码：

```
@FileUpload.GetHtml(
                    initialNumberOfFiles: 3,
                    allowMoreFilesToBeAdded: true,
                    includeFormTag: false,
                    addText: @Localization.AddAnotherPhoto,
                    uploadText: @Localization.UploadFile
                   ) 
```

# c++ - xcode - “尝试使用已删除的功能” - 这是什么意思？

> ID：10080102
> 
> 赞同：8
> 
> 时间：2012-04-09T21:26:34.390
> 
> 标签：c++, xcode4.2, llvm-3.0

我正在 Xcode 4.2 中编写一个 C++ 库

我的一个类无法编译并出现此错误：“尝试使用已删除的函数”。

没有具体说明它在谈论什么功能。我不想在这里发布课程代码，但是有人知道这个错误是什么意思吗？*在 Google 上找不到*它... :(

谢谢一堆

罗伊

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2014-09-03T16:46:47.140

我对线程（C++ 11）有类似的消息。事实证明，我将错误数量的参数传递给线程调用的函数，因此线程没有找到任何合适的函数并给出了该消息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-02-24T13:02:29.587

为了补充卡洛斯的答案，我有正确数量的参数，但其中一个参数是通过引用传递的。在变量周围添加 ref() 为我修复了它。见[这里。](http://en.cppreference.com/w/cpp/thread/thread/thread)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-09T21:39:42.623

在 C++11 中，您可以将函数声明为已删除：

```
struct Foo {
    Foo(const Foo &) = delete;
}; 
```

尝试使用这样的功能是错误的。这样做的目的是，在这个例子中，这种类型的复制构造是不可能的。这是 C++11 之前使用的不可复制技巧的更直接替代。

此外，C++ 规范中有一些规则会导致成员函数被隐式删除。

该错误告诉您您的程序尝试使用已删除的功能。您必须发布您收到的错误以获得更详细的帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-05-17T03:32:45.030

对我来说，当我将“this”指针作为参数传递给函数时，它解决了这个问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-05-05T16:18:27.353

For me, the issue was that one of the arguments was a pointer, and I passed NULL directly as an argument. To solve this, I simply created a new NULL pointer which I passed to the function as an l-value instead.

# php - 在 .htaccess 中使用 AddType .css 时，浏览器无法解释 .css 文件

> ID：10080103
> 
> 赞同：0
> 
> 时间：2012-04-09T21:26:37.090
> 
> 标签：php, css, apache, .htaccess, stylesheet

我有一个与 Deflate Compression、Apache (htaccess) 和 CSS 文件相关的非常有趣的问题。

我的服务器上有两个 CSS 文件。一种叫做styles.php，在styles/目录下通过mod_rewrite根据数据库值添加动态值（从styles.php重写为site.css，文件开头有text/css头）。我还有一个常规的旧 css 文件，其静态内容在名为 styles.css 的同一目录中不会更改。

我想为我的站点添加压缩，所以我添加了以下行来开始压缩我的 css 和 js 文件。我将此添加到我网站的 root_directory 中。

```
<ifModule mod_deflate.c>
    <filesMatch "\.(js|css)$">
        SetOutputFilter DEFLATE
    </filesMatch>
</ifModule> 
```

好吧，最初那行不通。所以我将根 htaccess 文件中的这一行从这个更改为下一个。（下面的代码位于文件顶部）

```
AddType application/x-httpd-php5 .html .php
AddType application/x-httpd-php5 .html .php .js .css 
```

然后我的 js 和其中一个 css 文件开始被压缩（用 YSlow 验证......耶！）。奇怪的是，被重写的 css 文件被压缩（styles.php 文件），但styles.css 文件（静态文件）不再被浏览器读取。一旦我从该 AddType 行中删除“.css”，浏览器就会再次开始读取文件并且我的 css 恢复正常，但是它不再通过 apache 压缩。

如果我添加类型，为什么浏览器不读取静态 css 文件有什么想法吗？我只用 text/css 而不是 .css 进行了尝试，它没有压缩文件（但浏览器解释了它）。

更新：

我将此添加到根 htaccess 文件中。我们现在已经压缩、解释了甜蜜。

```
<filesMatch "\.css$">
FileETag None
<ifModule mod_headers.c>
Header set Content-type "text/css"
</ifModule>
</filesMatch> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T21:32:20.033

当您通过 PHP 预处理器运行 CSS 文件时，PHP 将`text/html`通过默认标头自动将其输出为文件，因为您没有手动指定它。所以实际上，您的浏览器正在接收一个带有`.css`扩展名的文件，该文件的标题声称它是一个 HTML 文件，因此它试图将其解释为 HTML 而不是 CSS。

如果您的 CSS 文件实际上需要作为 PHP 运行并且其中包含 PHP，则需要重新发出适当的文件类型，以便在输出时仍然是 CSS：

```
<?php
header('Content-type: text/css');
?> 
```

您不能只通过 PHP 发送 CSS 文件并期望它*完全*一样地工作。如果您实际上没有使用 PHP 对其进行预处理，那么您不应该通过那里发送它。

* * *

至于通货紧缩问题，我实际上永远无法让 mod_deflate 亲自工作（不知道为什么）。我不得不改用 mod_gzip。

# android - Android 支持包使用

> ID：10080105
> 
> 赞同：1
> 
> 时间：2012-04-09T21:26:47.993
> 
> 标签：android

在 2.3.6 Razor 上运行时，我无法使用 android-support-v4.jar 中的类。我添加了 libs 文件夹并将这个 android-support-v4.jar jar 文件放入其中，但是当我从 Eclipse 部署到真实手机时，遇到 Notification.Builder... 代码时，我得到了 ClassNotFoundException。

# hibernate - Hibernate HQL createQuery

> ID：10080112
> 
> 赞同：0
> 
> 时间：2012-04-09T21:27:33.563
> 
> 标签：hibernate, nhibernate-caches

我正在尝试以旧方式转换执行 SQL 查询的旧应用程序，如下所示：

```
java.sql.Connection connection = ....
String queryStr="select acct from Person where acct in (select acct from Document where dbcreate_date > DATEADD(hh,-12, GETDATE())) and status not in ('A','P')";
...
...
java.sql.Statement statement = connection.createStatement(
                ResultSet.TYPE_SCROLL_INSENSITIVE,
                ResultSet.CONCUR_READ_ONLY);
        rs = statement.executeQuery(queryStr); 
```

上面的代码大约需要 10 毫秒。这包括获取数据库连接、创建语句和执行查询。

我现在使用 Hibenate HQL 并创建了一个这样的 HQL 查询：

```
Query query = session.createQuery("select p.acct   from Person p  where p.acct in (select  acct from Document d where create_date > :date and status not in ('A','P'))"); 
```

现在只是这个语句“session.createQuery(....)”大约需要 105 毫秒，这大约是上面提到的以旧方式执行整个查询的 10 倍。

现在我不太确定 Hibernate 查询缓存是如何工作的，但如果我再次运行同样的 HQL 语句，大约需要 5 毫秒。

现在我的问题是为什么使用 Hibernate HQL 会发生这种行为？任何人都知道“session.createQuery(...)”方法内部发生了什么，第一次需要更长的时间，但第二次运行的时间要少得多？我还注意到，Hibernate 在执行“query.list()”时两次都对数据库执行 SQL。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T23:37:51.163

尝试在 Hibernate 中使用本机查询来比较性能：

```
Query query = session.createSQLQuery("select acct from Person where acct in (select acct from Document where dbcreate_date > DATEADD(hh,-12, GETDATE())) and status not in ('A','P')"); 
```

* * *

关于性能：

您并没有真正将 like 与 like 与您的两个查询进行比较。

您的第一个示例，直接 JDBC 查询只是一个简单的查询（plain Statement）。另一方面，HQL 在其中**有一个参数**- 因此它将转换为 JDBC PreparedStatement，并且此 SQL 被编译一次，以便您可以在多次调用它时快速运行它，并传递不同的变量值.

如果您多次执行这两项操作，您可能会发现 HQL 查询平均比简单的 JDBC 查询要快。

如果您只执行一次，那么简单的 JDBC 版本可能会比 HQL 更快，因为 HQL 将在最初进行编译。

这里有一些关于 Statement vs PreparedStatement 的有趣信息：

[http://oreilly.com/catalog/jorajdbc/chapter/ch19.html](http://oreilly.com/catalog/jorajdbc/chapter/ch19.html)

> 语句与 PreparedStatement
> 
> 人们普遍认为使用 PreparedStatement 对象比使用 Statement 对象更快。毕竟，准备好的语句只需要根据数据库验证其元数据一次，而语句必须每次都进行。那么怎么可能是其他方式呢？好吧，事情的真相是，在它的总执行时间赶上一条语句之前，它需要大约 65 次准备好的语句迭代。这对您的应用程序有性能影响，探索这些问题就是本节的全部内容。
> 
> 当谈到在典型使用下哪个 SQL 语句对象性能更好时，Statement 或 PreparedStatement，事实是 Statement 对象产生最佳性能。当您考虑在应用程序中通常如何使用 SQL 语句时（此处为 1 或 2 个，每个事务可能使用 10 到 20 个（很少更多）），您会意识到 Statement 对象将在比 PreparedStatement 对象更短的时间内执行它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T21:31:12.550

您可以使用`session.createCriteria`以避免解析 HQL 和构建 SQL。

不过，对于复杂的查询，只需在第一次命中时支付一些小罚金（尽管不太可能是 ~100 毫秒），而不是构建复杂的`createCriteria`结构。

[http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/querycriteria.html](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/querycriteria.html)

# version-control - IntelliJ IDEA 中的专用库文件夹

> ID：10080114
> 
> 赞同：0
> 
> 时间：2012-04-09T21:27:44.907
> 
> 标签：version-control, intellij-idea, libraries, java

是否可以像我们在 NetBeans 中一样在 IntelliJ IDEA 中为库创建一个专用文件夹（创建新项目，您可以启用它，以便它可以自动将所有库存储在那里，然后将它们添加到 VCS）。

我们需要通过 VCS 在其他计算机之间共享库，这样其他人就不必在获取代码之前设置他们的环境，或者在更新他们的代码之后添加库。我们还需要确保设置可以在 Windows、Mac 和 Linux 机器上运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T08:32:50.063

您可以设置可用于不同项目的[全局库。](http://www.jetbrains.com/idea/webhelp/libraries-global-libraries-and-the-configure-library-dialog.html)

# reporting-services - Reporting Services 数据模型

> ID：10080120
> 
> 赞同：0
> 
> 时间：2012-04-09T21:28:13.143
> 
> 标签：reporting-services, reportbuilder

仍在使用 SQL2008（不是 SP2）的 Reporting Services。我最近开始使用报表生成器 2.0，但看起来报表生成器无法修改数据模型——而且 VS2010 缺乏商业智能功能。我的问题是：数据模型是否已贬值？如果没有，目前管理它们的工具是什么？我有新的报告要写，所以我试图提前考虑。数据集能否用于临时报告并控制访问？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T08:16:05.027

没有办法使用 vs2010 修改报表模型，您仍然必须安装 vs2008 BIDS 才能修改这些模型。看起来报告模型可能会从 SQL 2012（[http://social.msdn.microsoft.com/Forums/en/sqlreportingservices/thread/0d0650d1-6d40-4d12-a471-54fb29b3356d](http://social.msdn.microsoft.com/Forums/en/sqlreportingservices/thread/0d0650d1-6d40-4d12-a471-54fb29b3356d "SQL 2012 报表模型支持")）开始贬值。

如果您开始一个新项目，那么我个人会考虑使用基于视图或存储过程的共享数据集，因为这些将更容易维护和使用。然后，您可以使用这些权限来控制谁可以访问什么。

# javascript - Rails 地理编码器显示用户经纬度以用于距离

> ID：10080132
> 
> 赞同：0
> 
> 时间：2012-04-09T21:29:11.477
> 
> 标签：javascript, ruby-on-rails, html, geolocation

我已经安装并安装了地理编码器，并且可以运行类似的功能

```
 <%= Geocoder::Calculations.distance_between([47.858205,2.294359], [@company.latitude,@company.longitude]) %> 
```

哪个输出到公司的距离。但是，我希望使用地理位置数据能够用从移动浏览器获得的实际坐标替换“47.858205,2.294359”。

我目前正在使用 Google Geolocation Javascript HTML5 来请求用户位置。[http://code.google.com/p/geo-location-javascript/source/browse/trunk/js/geo.js?r=74](http://code.google.com/p/geo-location-javascript/source/browse/trunk/js/geo.js?r=74)

如何在我的视图中显示这个纬度和经度？我希望它看起来像这样

```
 <%= Geocoder::Calculations.distance_between([@lat,@long], [@company.latitude,@company.longitude]) %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T01:20:15.717

我只会使用 Geocoder gem 在服务器端进行地理定位。`request`Geocoder gem 为控制器操作中可用的对象添加了一个定位方法。因此，在您的控制器操作中，您可以执行以下操作：

```
@lat = request.location.latitude
@long = request.location.longitude 
```

然后在您拥有的视图代码中使用这些值。

Geocoder 使用请求的 IP 地址进行地理定位。我不确定这是否会比通过浏览器使用地理定位更准确（它也可能使用 IP 地址，我真的不知道实现是如何工作的）。

# android - 不同模拟器中内容提供者实例之间的通信

> ID：10080138
> 
> 赞同：0
> 
> 时间：2012-04-09T21:29:35.030
> 
> 标签：android, android-contentprovider

我们如何与另一个模拟器中的内容提供者通信？我知道我们可以使用内容提供者中的数据库或文件：但是有没有办法处理内容提供​​者实例而不是数据库？例如：要求不同的内容提供者存储当前内容提供者出于某种原因选择不保存的一些数据。

# c - 为什么我可以将字符串分配给浮点指针？

> ID：10080139
> 
> 赞同：0
> 
> 时间：2012-04-09T21:29:40.133
> 
> 标签：c, pointers, typing

为什么下面的代码有效？那应该是编译错误（或至少是运行时错误）吗？

```
#include <stdio.h>

int main(int argc, char** argv){
        float *buf = "happy holiday";        // notice the float
        printf("content of buf = %s\n",buf); //its working
        return 0;
} 
```

我编译它并得到一个警告：

```
~/Desktop/cTest>gcc -o run run.c
run.c: In function `main':
run.c:4: warning: initialization from incompatible pointer type 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T21:31:57.667

你应该总是编译`-Wall -Werror -Wextra`（至少）。然后你得到这个：

```
cc1: warnings being treated as errors
test.c: In function 'main':
test.c:4: warning: initialization from incompatible pointer type
test.c:5: warning: format '%s' expects type 'char *', but argument 2 has type 'float *'
test.c: At top level:
test.c:3: warning: unused parameter 'argc'
test.c:3: warning: unused parameter 'argv' 
```

它“有效”是因为在实践中，你的平台上的引擎盖下的a`char *`和 a之间没有区别。`float *`您的代码实际上与以下内容没有什么不同：

```
#include <stdio.h>

int main(int argc, char** argv){
        float *buf = (float *)"happy holiday";
        printf("content of buf = %s\n",(char *)buf);
        return 0;
} 
```

这是明确定义的行为，除非 和 的对齐要求`float`不同`char`，在这种情况下，它会导致未定义的行为（参见 C99，6.3.2.3 p7）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T21:32:37.617

该程序不严格符合要求，编译器需要输出诊断信息并有权拒绝编译。所以不要这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T21:39:44.727

这是 的一种不幸行为`gcc`，如果有人可以修复它，我们都会处理更少错误的软件。不幸的是，缺乏解决许多此类问题的意愿。提交错误报告不会受到伤害。

# search - 使用 EE 搜索模块搜索自定义字段

> ID：10080143
> 
> 赞同：0
> 
> 时间：2012-04-09T21:29:55.657
> 
> 标签：search, expressionengine, safecracker

我确定这很简单，但我还没有找到文档：

我有一个带有会员目录的网站。所有会员数据都存储在会员频道中，该频道使用各种自定义字段——其中一些是 P&T 字段包的一部分。

我使用 Safecracker 表单输入数据，它可以漂亮地呈现自定义字段：

![P&T 字段示例 1](../Images/ec43525645863b7500963b924785c92c.png)

![P&T 字段示例 1](../Images/0b0c80e510aadf77fed1394c1ef1906c.png)

我想要的是本质上相同的表单，但让它执行搜索，而不是输入字段数据。

我浏览了搜索模块文档，但找不到有关如何搜索单个字段的信息，更不用说如何呈现它们了。我还搜索了 Safecracker 文档以了解如何将其配置为搜索（理想的解决方案）。

我该怎么做呢？

任何帮助，将不胜感激。

谢谢！

泰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T13:34:46.753

EE 的搜索模块不会做你想做的事——它更像是一个通用的搜索工具，它的“高级搜索”表单不是关于自定义字段，而是更多关于频道和类别之类的东西。

你想看看 Solspace 的[超级搜索](http://www.solspace.com/software/detail/super_search/)。它更强大，并且可以让您在查询方面完全按照您的意愿行事 - 尽管您必须手动构建表单（即，您不会获得使用 SafeCracker 风格的简单性`{field:field_name}`来让您的表单字段为您输出）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T20:27:16.737

我还建议查看 SuperSearch。

# ruby-on-rails - 在 ruby 中解析 json 以进行排序、过滤等

> ID：10080152
> 
> 赞同：1
> 
> 时间：2012-04-09T21:30:49.613
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, json

我正在使用 koala 从 facebook 获取以下 JSON 对象：

```
@friends = [{"name"=>"Jolie Chide", "gender"=>"female", "id"=>"4216323"},
            {"name"=>"Seth Spring", "gender"=>"male", "id"=>"3429277"}] 
```

我想做的是以下几点：

```
<% @friends.where(:gender == "female").order("@friends['name'] ASC").each do |friend| %>
  <%= friend['name'] %>
<% end %> 
```

**如您所知，这是行不通的。**我习惯于标准的 Ruby 对象，而不是上面的 JSON。如果有人对如何使上述工作有任何建议，即使这意味着从 JSON 转换数据，那也很好。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T21:41:35.897

你所拥有的不是 JSON，而是一个`Array`of `Hash`es。这些是内置的 Ruby 集合，而不是 ActiveRecord 关系，并且它们具有类似`select`和的方法`sort_by`，允许您在其中做您想做的事情。你应该熟悉这些类和它们的方法，因为它们对于 Ruby 来说比 ActiveRecord 的东西更基础，而且它们无处不在。

你想要的操作可以表示如下：

```
@friends.select {|hash| hash['gender'] == 'female'}.sort_by {|hash| hash['name']} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-19T10:00:10.017

This is the best way to grab the `json data` and assign to instance variable and use following .

**Ascending**

```
@graph = @abc.sort_by { |hash| hash['created_time'] } 
```

or

```
graph = abc.sort_by { |hash| hash['created_time'] } 
```

**Descending**

```
@graph = @abc.sort_by { |hash| hash['created_time'] }.reverse! 
```

or

```
graph = abc.sort_by { |hash| hash['created_time'] }.reverse! 
```

# c++ - 结构中的cin和char数组指针

> ID：10080154
> 
> 赞同：1
> 
> 时间：2012-04-09T21:30:50.580
> 
> 标签：c++, arrays, pointers, struct, cin

作为一个 c++ 初学者，我编写了以下代码：

```
int main(void){
struct car{
    char * make[200];
    int manfYear;
};

int num=0;

cout << "How many cars do you wish to catalogue? ";
cin >> num;
car * Cars = new car [num]; 

for (int i=1;i<=num;i++){
    cout << "Car #" << i << ":" << endl << "Please enter the make: ";
    cin.getline(*Cars->make,200);
    cout << "Please enter the year made: ";
    cin >> Cars->manfYear;
} 
```

我的问题是我无法解决一个问题，即在我需要输入汽车模型的地方运行程序时出现段错误。有人可以解释我做错了什么吗？

据我了解，我正在传递一个指向数组“make”的指针，它应该使它工作。我的理解有偏差吗？

提前感谢丹

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T21:49:41.340

我马上看到的四个问题：

**第一期**

在您的`struct`中，您有：

`char * make[200];`

在英语中，这就是“创建一个包含 200 个字符的指针的数组”，而我认为您想说的是“创建一个包含 200 个字符的数组”。所以你应该改为：

`char make[200]`.

**第 2 期**

您从 开始循环`1`。这将跳过数组中的第一辆车——记住数组是零索引的。所以你应该改为：

`for (int i = 0 ; i < num ; i++)`

出于显示目的，您可以说：

`cout << "Car #" << (i+1) << ":" << endl << "Please enter the make: ";`

**第 3 期**

你说的地方：

`cin.getline(*Cars->make,200);`

和

`cin >> Cars->manfYear;`

您在这些行中的哪个位置指定了用户正在使用的汽车？无处。如果您正在循环使用`i`，那么您实际上需要提及`i`. 这些应该工作：

`cin.getline(Cars[i].make,200);`

和

`cin >> Cars[i].manfYear;`

请注意，我们使用的是`.`，而不是`->`。这是因为`Cars`数组中的项目是实际实例，而不是指针。`Cars`数组本身是一个指针，但不是它的内容。

**第 4 期**

所有功劳归功于[@Ben C](https://stackoverflow.com/users/1301901/ben-c)，他首先指出了这一点：将`>>`运算符与`getline()`函数混合在一起`cin`会导致奇怪的行为，剩余`CR`的`>>`会进入`getline()`调用。您可以使用 all `>>`（缺点：在阅读 make 时没有`200`强制执行限制）或 all `cin.getline()`（缺点：您必须使用字符串缓冲区，然后将它们转换为汽车数量和年份），或者`cin.ignore()`在每次调用之后放置的`>>`，像这样：

```
cin >> num;
cin.ignore(); 
```

和

```
cin >> Cars[i].manfYear;
cin.ignore(); 
```

再次[感谢@Ben C](https://stackoverflow.com/users/1301901/ben-c)首先注意到这一点。

**最后但并非最不重要的**

按照惯例，类/结构具有大写名称，而变量具有小写/驼峰式名称。考虑重命名`struct`from `car`to`Car`和数组 from `Cars`to `cars`。换句话说，与您现在的大小写相反。

最后，我同意这里的所有其他海报：您应该考虑使用`string`而不是`char`数组。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T21:34:42.060

首先，使用`string`而不是可怜的旧 C `char[]`。

下一个：你不想要`char * make[200];`. 你想要`char make[200];`。`char * make[200]`是一个包含 200 个指向`char`s 的指针的数组，它可以用作 200 个以 null 结尾的字符串 - 但是，您必须对`new[]`它们中的每一个都进行处理。只需使用`char make[200];`和`cin.getline(Cars->make, 200);`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T21:43:36.830

`char * make[200]`声明一个包含 200 个指针的数组；我猜这不是你想要的。

如果您只是想存储一个字符串，我建议您查看 C++`string`类型。

```
#include <iostream>
#include <string> 

int main()
{
    using namespace std;

    struct car
    {
        string make;
        int manfYear;
    };

    int num=0;

    cout << "How many cars do you wish to catalogue? ";
    cin >> num;
    car * Cars = new car [num]; 

    for (int i=1;i<=num;i++)
    {
        cout << "Car #" << i << ":" << endl << "Please enter the make: ";
        std::cin.ignore();
        getline(cin, Cars[i-1].make);
        cout << "Please enter the year made: ";
        cin >> Cars[i-1].manfYear;
    }
} 
```

您的代码还有其他一些小问题。

1）您一直在使用`Cars->manfYear`- 这只会将您指向数组的第一个元素。我假设你不想要那个；按照 per 使用下标语法`Cars[i-1].manfYear`将访问数组中的单个汽车对象。（请记住，数组索引从零开始！-实际上，对于您的**for**循环变量，从零开始实际上更符合习惯用法）

2）小心方式`std::getline`和`>>`符号一起工作。（`>>`流提取运算符）通常会留下任何换行符，这意味着您可能会在调用 getline 时看到“奇怪”的行为。如果您将两者混合在一起，那么使用类似`std::cin.ignore()`的东西将帮助您丢弃换行符。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T21:35:56.650

首先`char *make[200]`不是一个最多 200 个字符的字符串，而是 200 个指向`char`.

第二件事：您正在取消引用其中的指针：发生`cin.getline`的`*`情况是您获得了 200 个`char*`指针的第一个单元格中包含的值。但是你没有初始化单个指针，只是更高级别的指针，所以你得到了一个段错误。

只需更改`char* make[200]`为`char make[200]`和。`*Cars->make``Cars[i].make`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-09T21:43:27.563

首先，C++ 中的数组从 0..n-1 开始索引，因此您的循环需要从

```
for (int i = 0; i < num; i++) { ... } 
```

其次，您已经声明了一个包含 200 个元素的*指针*`make`数组；这很可能*不是*您想要的。如果应该存储一个字符串，请将其声明为一个普通数组：*`char`*`make``char`**

 **```
struct car{
      char make[200];
      int manfYear;      
}; 
```

`getline`最后，将您的电话重写为

```
cin.getline(Cars[i].make, sizeof Cars[i].make); // fixed per comment below 
```

即使`Cars`被声明为指针，您也可以在其上使用下标运算符，就*好像*它是一个数组一样；通过这样做，您隐式取消引用`Cars`，因为`a[i]`被解释为`*(a + i)`. 这也意味着您将使用`.`组件选择运算符而不是`->`运算符，因为类型`Cars[i]`is `car`， not `car *`。**

# python - 是否可以仅在模块中使用 doctest 测试特定功能？

> ID：10080157
> 
> 赞同：24
> 
> 时间：2012-04-09T21:31:02.127
> 
> 标签：python, testing, flags, skip, doctest

我正在尝试使用 doctest 模块在 Python 中进行测试。目前我做

1.  编写函数的测试。
2.  实现功能代码。
3.  如果测试通过，请编写更多测试和更多代码。
4.  完成该功能后，继续执行下一个功能。

因此，在同一个模块中的 3 或 4 个（独立）函数和许多测试之后，我得到了 doctest 的巨大输出。这有点烦人。

有没有办法告诉 doctest **“不要测试函数`a()`，`b()`并且`c()`**”，以便它只运行**未标记**的函数？

我只找到了[`doctest.SKIP`](http://docs.python.org/library/doctest.html#doctest.SKIP)标志，这不足以满足我的需要。我必须把这个标志放在很多行中。如果我想再次检查一个**标记**的函数，我将不得不手动检查代码并删除我在里面设置的任何标志。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-04-10T00:12:23.687

[看起来](http://docs.python.org/library/doctest.html#doctest.run_docstring_examples)你可以将函数传递给`run_docstring_examples`：

```
def f(a, b, c):
    '''
    >>> f(1,2,3)
    42
    '''

if __name__ == '__main__':
    import doctest
#    doctest.testmod()
    doctest.run_docstring_examples(f, globals()) 
```

[通过谷歌找到的例子](http://koichitamura.blogspot.com/2008/12/using-docstring-module-for-if-name-main.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-09-30T15:01:49.870

我整理了一个[帮助脚本](https://github.com/jncraton/doctestfn)，以减轻痛苦。可以使用以下方式安装：

```
pip install doctestfn 
```

然后它可以被称为：

```
doctestfn {module or filename} {function to test} 
```

# php - PHP：将文本文件上传到页面，显示每个文本条目的新行，并按字母顺序排序

> ID：10080158
> 
> 赞同：0
> 
> 时间：2012-04-09T21:31:07.777
> 
> 标签：php, arrays, string-formatting, implode

我正在使用 PHP，我想上传一个文本文件，输出/视图在新行上显示文本文件中的每一行（与文本文件中显示的完全一样）。

但是，我还希望文本文件按字母顺序排序。

我有工作代码，可以在每个新行上上传文件，并按大写排序，然后是小写 - 使用排序功能

而且我有按字母顺序排序的代码（不管大小写），但不幸的是，这些行被组合在一起，而不是像我想要的那样分开。- 使用 natcasesort

我已经尝试了很多事情，但没有得到任何结果，所以希望有人可以帮助将两者放在一起，或者让我知道我需要对任何一段代码做什么，这将使每一行显示在一个新的行上。

第一个代码需要按字母顺序排序，不管大写/小写第二个代码需要显示换行符

```
<?php
$file = file("users.txt");
sort($file);
for($i=0; $i<count($file); $i++)
    {
      $states = explode(",", $file[$i]);
      echo $states[0], $states[1],"<br />";
    }
?>

<?php
$filename="users.txt"; 
$lines = array();
$file = fopen($filename, "r");

while(!feof($file)) { 
    $lines[] = fgets($file,4096);
    } 
natcasesort($lines);
print_r($lines);
fclose ($file); 
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T21:33:29.670

你必须使用

```
$text = implode("<br />", $lines);
echo $text 
```

它将粘合数组并`<br />`在每个新行中粘贴一个。当然，如果它是用 HTML 打印的，如果不使用载体`\n`来代替。

你的代码看起来像：

```
.
.
.
while(!feof($file)) { 
    $lines[] = fgets($file,4096);
    } 
natcasesort($lines);
$text = implode("<br />", $lines);
print_r($text)
.
.
. 
```

# oracle - 在 oracle 中使用 if 选择查询

> ID：10080159
> 
> 赞同：0
> 
> 时间：2012-04-09T21:31:12.437
> 
> 标签：oracle, if-statement

我需要帮助！例如，有四个表：cars、users、departments 和 join_user_department。最后一个表用于 M: N 表用户和部门之间的关系，因为某些用户的访问权限有限。我需要获取用户可以访问的部门的汽车数量。表“cars”有一个列 department_id。如果表 join_user_department 没有 user_id 的任何记录，这意味着他可以访问所有部门，并且选择查询必须没有任何条件。我需要做这样的事情：

```
declare
DEP_NUM  number;--count of departments where user have access
 CARS_COUNT number;--count of cars
BEGIN
SELECT COUNT (*) into DEP_NUM from join_user_departments where user_id=?;
SELECT COUNT(*) into CARS_COUNT FROM cars where 
  IF(num!=0)—it meant that user access is limited
  THEN department_id IN (select dep_id from join_user_departments where user_id=?); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T22:45:36.863

用户要么可以访问所有汽车（我假设所有汽车都绑定到一个部门，并且用户可以访问所有部门），要么用户具有有限的访问权限。您可以使用 UNION ALL 将这两个组放在一起，并按用户分组进行最终计数。我已经交叉加入了可以无限制访问汽车表的用户，以将它们与所有汽车相关联：

（更新也计算部门）

```
select user_id, 
    count(distinct department_id) as dept_count, 
    count(distinct car_id) as car_count,
from (
    select ud.user_id, ud.department_id, c.car_id
    from user_departments ud
    join cars c on c.department_id = ud.department_id
    UNION ALL
    select u.user_id, v.department_id, v.car_id
    from user u
    cross join (
        select d.department_id, c.car_id
        from department d
        join cars c on c.department_id = d.department_id
    ) v
    where not exists (
        select 1 from user_departments ud 
        where ud.user_id = u.user_id
    )
)
group by user_id 
```

UNION ALL 比 UNION 更有效；一个 UNION 查找属于这两个组的记录并丢弃重复项。由于每个用户都属于一个或另一个存储桶，因此 UNION ALL 应该可以解决问题（在外部查询中进行不同的计数也可以排除重复项）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T23:03:15.573

> “如果表 join_user_department 没有 user_id 的任何记录，这意味着他可以访问所有部门”

这似乎是非常糟糕的做法。本质上，您正在使用记录的缺失来模拟记录的存在。很乱。如果用户无法从任何部门访问汽车，会发生什么情况？也许当前的业务逻辑不允许这样做，但是您有一个“数据模型”，它不允许在不更改应用程序逻辑的情况下实现这样的场景。

# php - 正则表达式匹配可选子组的一部分

> ID：10080164
> 
> 赞同：0
> 
> 时间：2012-04-09T21:31:18.537
> 
> 标签：php, regex

我正在尝试从网站上获取多个事件。事件有一个常规的格式

```
... EVENT TITLE & LINK ... START DATE ... END DATE ... <span class="location">LOCATION</span> ... 
```

其中“...”是一些带有样式信息和换行符的 html 标签。我想从这些事件字符串中提取 LINK、START DATE、END DATE 和 LOCATION。由于周围的 html 代码“...”的格式是完全规则的，因此抓取这四条信息很容易：我匹配周围的标签并提取我想要的部分，例如：

```
'|...<abbr class="dtstart">(.{10}).*?</abbr>...|s' 
```

其中“(.{10})”是开始日期。

问题是位置，因为某些事件列出了位置，而其他事件没有列出，因此在某些事件中跨度标签 <span class="location">LOCATION</span> 存在，而在其他事件中它只是丢失了.

所以我的问题是：

如何匹配 LOCATION？

如果我尝试

```
preg_match_all('|...<span class="location">(.+?)</span>...|s', $contents, $matches, PREG_SET_ORDER); 
```

在没有位置的事件上，它与该事件不匹配（但我得到了具有位置的事件的位置）。另一方面，如果我尝试

```
preg_match_all('|...(?:<span class="location">(.+?)</span>)...|s', $contents, $matches, PREG_SET_ORDER); 
```

在任何情况下，该代码都匹配所有事件，但 LOCATION（即使它存在）不是我的 $matches 的一部分。

**那么如何匹配常规但可选子字符串的不规则部分？**

谢谢！

*编辑（作为回答 zigdon 的问题）：*

问题是 LOCATION 必须与其他事件数据相匹配。想象一下这就是我想要的结果：“正则表达式协会大会（链接到网站），4 月 7 日至 4 月 10 日，柏林”和“在线教程（链接到网站，5 月 9 日”。第二个活动没有位置，但是第一个事件的位置必须与标题，链接和日期匹配。这是我要从中抓取事件的页面的链接，您可以查看源代码以了解问题：[https ://www.fs-psycho.uni-tuebingen.de/events/previous](https://www.fs-psycho.uni-tuebingen.de/events/previous) - 目前我抓住事件

```
preg_match_all('|<dt class="vevent">\s*?<span class="summary">\s*?(<a href=".+?</a>)\s*?</span>\s*?<span class="documentByLine">\s*?<span>(?:von )?<abbr class="dtstart" title=".{0,30}">(.{10}).{0,6}</abbr>.{5,100}<abbr class="dtend" title=".+?">(.{0,10}).{5,6}</abbr></span>\s*?(?:<span>— <span class="location">(.*?)</span>,</span>)?\s*?</span>\s*?</dt>|', $contents, $matches, PREG_SET_ORDER); 
```

这行得通，但我对此不满意，因为正如答案中提到的，使用“野生代码”（来自不是我自己的网站）标签之间可能会发生任何事情。我更喜欢只匹配事件部分的直接周围并且将中间的任何内容都非常开放的解决方案，即“。*？| s”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:34:35.103

使用正则表达式来解析 HTML（或任何实际标记）通常是一个非常糟糕的主意。大多数语言都提供了一个库，可以实际解析 HTML，并允许您获取所需的特定元素，而无需尝试将标签与正则表达式匹配。也许，因为看起来你可能正在使用 PHP，你可以看看这样的东西？[http://simplehtmldom.sourceforge.net/](http://simplehtmldom.sourceforge.net/)

另请参见[RegEx 匹配打开的标签，XHTML 自包含标签除外](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags)

# c++ - 建模音乐（音符）以在特定时间快速搜索音符的最佳方法

> ID：10080165
> 
> 赞同：3
> 
> 时间：2012-04-09T21:31:29.987
> 
> 标签：c++, performance, loops, vector

我正在开发一个 iOS 音乐应用程序（用 C++ 编写），我的模型看起来或多或少像这样：

```
--Song
----Track
----Track
------Pattern
------Pattern
--------Note
--------Note
--------Note 
```

所以基本上 a`Song`有多个`Tracks`， a`Track`可以有多个`Patterns`和 a`Pattern`有多个`Notes.`这些东西中的每一个都由一个类表示，除了 Song 对象之外，它们都存储在向量中。

每个`Note`都有一个`"frame"`参数，以便我可以计算何时应该播放一个音符。例如，如果我有 44100 个样本/秒并且特定音符的帧是 132300，我知道在第三秒开始时我需要那个音符。

我的问题是我应该如何表示这些音符以获得最佳性能？现在我正在考虑将注释存储在每个模式的向量数据成员中，然后循环所有的`Tracks`，然后`Song`查看`Patterns`并循环`Notes`查看哪个具有大于 132300 且小于 176400 的帧数据成员（第 4 秒开始）。

如您所知，这是很多循环，一首歌可能长达 10 分钟。所以我想知道这是否足够快来计算所有帧并按时将它们发送到缓冲区。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T12:31:42.683

您应该记住的一件事是，为了提高性能，通常必须增加内存消耗。在这种情况下，它也是相关的（并且是合理的），因为我相信您想以不同的方式存储相同的数据**两次**。

首先，你应该拥有一首歌曲的基本结构：

```
map<Track, vector<Pattern>> tracks; 
```

它将每个映射`Track`到`Pattern`s 的向量。地图很好，因为您不关心轨道的顺序。

遍历`Track`s 和`Pattern`s 应该很快，因为它们的数量不会很高（我假设）。主要的性能问题是循环数以千计的音符。以下是我建议的解决方法：

首先，对于每个`Pattern`对象，您应该有一个`vector<Note>`作为您的主要数据存储。您将首先将`Pattern`'s 内容的所有更改写入此内容`vector<Note>`。

```
vector<Note> notes; 
```

出于性能考虑，您可以采用第二种存储笔记的方式：

```
map<int, vector<Notes>> measures; 
```

这会将 a 中的每个**度量**（按其编号）映射到该度量中包含的 s`Pattern`的向量。`Note`每次主`notes`存储中的数据更改时，您都会将相同的更改应用到`measures`. 您也可以每次在播放前，甚至*在*播放时，在单独的线程中只执行一次。

当然，您只能将音符存储在小节中，而无需同步两个数据源。但是当您必须对一堆音符应用大量操作时，使用它可能不太方便。

在播放过程中，在下一个小节开始之前，将（大致）发生以下算法：

1.  在每个音轨中，找到所有模式，其中`pattern->startTime <= [current playback second] <= pattern->endTime`.
2.  对于每个模式，计算当前的度量值并从地图中获取`vector<Notes>`相应的度量值。`measures`
3.  现在，直到下一个小节（第二个？）开始之前，您只需要循环浏览当前小节的音符。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T02:58:03.710

Just keep those vectors sorted.

During playback, you can just keep a pointer (index) into each vector for the last note player. To search for new notes, you check have to check the following note in each vector, no looping through notes required.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T23:38:34.903

Keep your vectors sorted, and try things out - that is more important and any answer you can receive here.

For all of your questions you should *seek* to answer then with **tests** and **prototypes**, then you will know if you even have a problem. And also while trying it out you will see things that you wouldn't normally see with just the theory alone.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T04:14:33.357

> 我的模型看起来或多或少是这样的：

您的模型中缺少几个至关重要的概念：

1.  速度。
2.  [动力学](http://en.wikipedia.org/wiki/List_of_musical_symbols#Dynamics)。
3.  [踏板](http://en.wikipedia.org/wiki/List_of_musical_symbols#Pedal_marks)
4.  乐器
5.  [时间签名](http://en.wikipedia.org/wiki/Time_signature)。
6.  （可选）音调。
7.  效果（混响/合唱，音高轮）。
8.  立体定位。
9.  歌词。
10.  和弦图。
11.  作曲家信息/标题。

> 每个音符都有一个“帧”参数，以便我可以计算何时播放音符。

您的模型中缺少几个至关重要的概念：

1.  关节。
2.  触后。
3.  注意持续时间。

我建议看看[lilypond](http://lilypond.org/)。它是排版软件，但它也是以人类可读的文本格式表示音乐的最精确方式之一。

> 我的问题是我应该如何表示这些音符以获得最佳性能？

将它们全部放入`std::map<Timestamp, Note>`并使用 lower_bound/upper_bound 找到您想要播放的片段。或者，只要对数据进行排序，您就可以在平面 std::vector 中对它们进行二进制搜索。

除非您想制作“蜂鸣器”，否则制作音乐应用程序比您想象的要困难得多。我强烈建议尝试另一个项目。

# algorithm - 计算 2 个矩阵的最近点的映射

> ID：10080166
> 
> 赞同：2
> 
> 时间：2012-04-09T21:31:41.413
> 
> 标签：algorithm, matlab, sift

我有两个矩阵 A 和 B。每个矩阵都有 2 列，其中包含一个点的坐标`( x , y )`。

我需要计算一个`mapping of points from A to B`点，使它们之间的欧几里得距离最小。

本质上，我试图模仿 sift 对图像的作用，但不会执行 sift 为匹配点所做的步骤......

因此，对于 A 中的所有点，我计算 B 中所有点的欧几里德距离，然后删除距离最小的 2 个点的映射。然后我继续这样做，直到 A 和 B 都是空的。

有人能告诉我这样做最有效的方法是什么吗？

编辑

有人可以帮我吗...我面临的问题是，在选择它们中的最小值作为第一个映射之前，我需要计算所有 v/s 所有距离。然后我需要重新做一遍，使计算真的很长......

有什么方法可以在 MATLAB 中有效地完成？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T22:00:24.753

您是指两种不同配置点之间的 Procrustes 距离吗？如果是这样，Matlab 有一个内置函数可以计算使点对齐的最小范数变换（这是 Procrustes 距离）。

请参阅[此文档](http://www.mathworks.com/help/toolbox/stats/procrustes.html)以了解如何使用它。如果您没有 Statistics Toolbox，那么您应该先检查 Matlab Central File Exchange，看看是否有人编写了该`procrustes()`函数的非工具箱版本，然后再尝试编写自己的函数。

# c# - 企业配置的想法

> ID：10080167
> 
> 赞同：3
> 
> 时间：2012-04-09T21:31:42.560
> 
> 标签：c#, xml, configuration, app-config, enterprise

我正在构建一个非常大的企业应用程序。

我有控制所有其他机器的主机。

现在我将开始编写一些管理功能作为配置管理器。

在每台服务器中，我都有一些服务，并且每个服务都有一些我希望可以配置的变量。

我想可能会为每个服务添加一个 xml 配置文件（它将在服务启动时读取），当我进行配置分发时，我将使用新的配置数据更改该 xml 文件。

我还需要一种方法来重新启动服务以获取新配置。

我的问题是：

有没有更好的方法来完成企业配置能力？如果我的想法很好，任何提示和改进都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T09:01:16.323

这是我的解决方案：

我决定为每个服务创建配置文件 (xml)。

我创建了 FileWatcher 来监听文件中的蚂蚁变化。

为了设置新配置，我使用了 XmlSerializer 。

由于更改 FilwWatcher 更改事件引发，我反序列化配置文件并将新配置设置为服务。

# php - 如何使用当前日期变量在表中添加新列？

> ID：10080168
> 
> 赞同：-1
> 
> 时间：2012-04-09T21:31:55.963
> 
> 标签：php, mysql, phpmyadmin

我想用当前日期和小时更改表添加列，如下面的不添加列，但是当我删除变量并使其成为简单文本时添加它，还请告诉我如何使该列名称唯一，以便我们无法添加再次在 mysql 中再次出现同一列

```
 //get current date 
            $cname = date("Ymdh");
            echo "v1" . $cname ;

    //add curent date column if yet not added 
        mysql_query("ALTER TABLE  groups_ids add " . $cname . "VARCHAR(35)") ; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:38:25.117

问题出在您编写的查询中。首先，您使用反引号 (`) 对列名进行转义，之后数据类型之前没有空格

```
mysql_query("ALTER TABLE  groups_ids add `" . $cname . "` VARCHAR(35)") ;
                                                       //^ No space here 
```

# c# - MvcMailer 可以在类库中使用吗？

> ID：10080176
> 
> 赞同：8
> 
> 时间：2012-04-09T21:32:50.173
> 
> 标签：c#, asp.net-mvc-3, mvcmailer

我想在类库中使用 MvcMailer，它本质上是我为我的解决方案撰写和发送电子邮件的一站式商店。我认为这就是 MvcMailer 的设计目的，但它似乎找不到我的任何 .cshtml 文件——我猜它希望它们出现在我的启动项目中。

有什么方法可以让 MvcMailer 与我的其他项目 100% 分开？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:23:23.787

[根据 MvcMailer 文档https://github.com/smsohan/MvcMailer/wiki/MvcMailer-Step-by-Step-Guide](https://github.com/smsohan/MvcMailer/wiki/MvcMailer-Step-by-Step-Guide) （摘录如下），这是不可能的，也许您可​​以拥有一个单独的 Web 项目，其唯一目的是发送电子邮件并仅接受来自您的应用程序的请求

> 从后台进程发送电子邮件您需要从后台进程发送电子邮件吗？你是对的。您不想阻止发送该通知电子邮件的请求/响应周期。相反，您想要的是一个为您执行此操作的后台进程，即使它是在短暂延迟后发送的。以下是您可以执行的操作：
> 
> 将您的电子邮件相关数据保存到数据库中。创建发送电子邮件的 REST/SOAP Web 服务。这将确保您的 Mailer 可以访问 HttpContext，这是核心 ASP.NET MVC 框架正常工作所必需的。例如，查找您的视图、生成 URL 和执行身份验证/授权。创建一个调用 Web 服务的简单应用程序。这可能是 Windows 服务应用程序或在 Windows 计划任务下运行的可执行应用程序。MvcMailer 的未来版本可能会支持这一点。但这很难有两个原因：
> 
> MailMessage 不是开箱即用的可序列化的，并且有很多复杂的字段和关联。核心 ASP.NET 框架仍然需要 HttpContext :(

# c# - 了解处理管道

> ID：10080180
> 
> 赞同：0
> 
> 时间：2012-04-09T21:33:23.123
> 
> 标签：c#, linq

拿

```
 var query = Process.GetProcesses()
                            .OrderBy(p => p.WorkingSet64)
                            .ThenByDescending(p => p.Threads.Count);
                            .Where(p => p.ProcessName.Length < 9); 
```

它工作正常。拿

```
 var query = Process.GetProcesses()
                            .OrderBy(p => p.WorkingSet64)
                            .ThenByDescending(p => p.Threads.Count);
                            //.Where(p => p.ProcessName.Length < 9);

        query = query.Where(p => p.ProcessName.Length < 9); 
```

这不起作用。我不明白为什么第一种方法有效。在我看来，这些查询是相同的。ThenByDescending 返回`IOrderedEnumerable<T>`通过管道传输到 Where() 中的内容。第一种方法不应该工作，因为 Where 只适用于`IEnumerable<T>`. 唉......它确实有效。

这个处理管道如何运作？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-09T21:49:32.980

不同之处在于对`var`关键字和 LINQ 查询的误解。

[var（C# 参考）](http://msdn.microsoft.com/en-us/library/bb383973.aspx)

使用`var`关键字与指定与赋值右侧相同的类型相同。这并不意味着您可以为变量分配任何类型。

在 LINQ 查询中，大多数基本表达式返回一个`IEnumerable`，但在很多情况下，它们不只返回一个`IEnumerable`。相反，它们返回一个继承自`IEnumerable`.

在这种情况下，您正在执行与此等效的操作：

```
IEnumerable<Process> query = Process.GetProcesses()
                            .OrderBy(p => p.WorkingSet64)
                            .ThenByDescending(p => p.Threads.Count);
                            .Where(p => p.ProcessName.Length < 9); 
```

和

```
IOrderedEnumerable<Process> query = Process.GetProcesses()
                                    .OrderBy(p => p.WorkingSet64)
                                    .ThenByDescending(p => p.Threads.Count);

// Won't work because Where doesn't return an IOrderedEnumerable.
query = query.Where(p => p.ProcessName.Length < 9); 
```

第一个片段起作用的原因是因为`IOrderedEnumerable`继承自`IEnumerable`，所以你可以这样使用它。

要解决第二个示例中的问题，您需要显式声明`query`为`IEnumerable<Process>`.

# c# - ASP.NET SessionState SQLServer 模式 - System.Xml.XmlBoundElement 未标记为可序列化

> ID：10080185
> 
> 赞同：2
> 
> 时间：2012-04-09T21:33:44.373
> 
> 标签：c#, asp.net, serializable

我目前正在修改 ASP.NET (3.5) 应用程序以在 SQLServer SessionState
模式下运行。在现有代码中，我们有一个序列化的数据集，该数据集当前
使用 C# 存储在 Session 中。我有一个属性，用于提取此序列化数据集并将其加载到 XmlDataDocument 中。我的财产是这样的“东西”：

```
public abstract class TransCommand 
{
 public static XmlDataDocument TransDoc
   {
     get
        {
          XmlDataDocument doc = null;
          if (Session["DataSetStore"] != null)
            {
              DataSet tds3 = new DataSet();
              MemoryStream tms3 = new MemoryStream(HttpContext.Current.Session["DataSetStore"] as byte[]);
              doc = new XmlDataDocument();
              doc.LoadXml(System.Text.Encoding.UTF8.GetString(tms3.ToArray()));
             }
             return doc;
         }
            set
            {
                Session["DataSetStore"] = System.Text.Encoding.UTF8.GetBytes(value.OuterXml);
            }
        } 
```

这很好用，除非我尝试将 XmlNode 附加到从此
TransDoc 方法创建的节点上。

```
public class AddChildren
  {
    XmlDataDocument doc = TransactionCommand.TransactionDoc;
    doc.DataSet.EnforceConstraints = false;
    XmlNode dataNode = doc.SelectSingleNode("//WebServiceResponse/Data");

    ......

    ArrayList lstNewInfants = new ArrayList();
    1stNewInfants.add(newInfants); //Adding new Infants XmlNodes into an arraylist.

    foreach (XmlNode nodInfant in lstNewInfants)
    {
      dataNode.AppendChild(nodInfant);
    }

doc.DataSet.EnforceConstraints = true;
TransactionCommand.TransactionDoc = doc; //Adds the modified doc back into the session 
```

追加此节点后，我在遇到下一页aspx页面的Databind后收到以下异常：

```
Error Message:Type 'System.Xml.XmlBoundElement' in Assembly 'System.Data, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' is not marked as serializable.
Stack Trace:   at System.Runtime.Serialization.FormatterServices.InternalGetSerializableMembers(RuntimeType type)
   at System.Runtime.Serialization.FormatterServices.GetSerializableMembers(Type type, StreamingContext context)
   at System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.InitMemberInfo()
   at System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.InitSerialize(Object obj, ISurrogateSelector surrogateSelector, StreamingContext context, SerObjectInfoInit serObjectInfoInit, IFormatterConverter converter, ObjectWriter objectWriter)
   at System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.Serialize(Object obj, ISurrogateSelector surrogateSelector, StreamingContext context, SerObjectInfoInit serObjectInfoInit, IFormatterConverter converter, ObjectWriter objectWriter)
   at System.Runtime.Serialization.Formatters.Binary.ObjectWriter.Serialize(Object graph, Header[] inHeaders, __BinaryWriter serWriter, Boolean fCheck)
   at System.Runtime.Serialization.Formatters.Binary.BinaryFormatter.Serialize(Stream serializationStream, Object graph, Header[] headers, Boolean fCheck)
   at System.Web.Util.AltSerialization.WriteValueToStream(Object value, BinaryWriter writer) 
```

有任何想法吗？

# c++ - 在 C++ 中阅读和维护图形

> ID：10080188
> 
> 赞同：1
> 
> 时间：2012-04-09T21:33:53.660
> 
> 标签：c++, algorithm, data-structures, graph

我有一个文本文件，可以从中读取无向图。格式如下：

```
1 2 3
2 1
3 1 
```

行中的每个第一个元素对应一个顶点，其余的基本上是顶点的邻接表。

所以我的两个问题是：

*   1) 在 C++ 中阅读此信息的最佳方式是什么？使用以下代码段，我可以依次读取所有信息，但这当然不是我最终想要实现的。我希望能够以一种体面的方式分离不同行的信息。（这部分实际上与我的第二个问题密切相关，如下所示）

    ```
    void inputHandle(ifstream& f, int arr[], string fileName)
    {

        f.open(fileName);

        if (!f) {
            cout << "Unable to open file";
            exit(1); // terminate with error
        }

        string temp;
        int i = 0, numTemp;

        while(f >> temp){
            numTemp= atoi(temp.c_str());
            arr[i] = numTemp;
            cout<<arr[i];
            i++;
        }

        f.close();
    } 
    ```

*   2) 保存此图的最佳数据结构是什么？我将实现一个 mincut 算法，因此我将在每次迭代时修改图形（删除/修改行）。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T21:50:55.737

我会将图形存储为[邻接列表](http://en.wikipedia.org/wiki/Adjacency_list)或[矩阵](http://en.wikipedia.org/wiki/Adjacency_matrix)，在 C++ 中，这是一种编码方式。根据性能/存储要求，您可能需要对此进行调整。

```
vector< list<int> > graph; 
```

或者您可以使用邻接矩阵。

```
vector< vector<bool> > graph; 
```

至于读取您的文件格式，我会使用`getline()`逐行读取文件，然后解析每一行的整数值（可能使用`istringstream`），可能是这样的：

```
ifstream f;

vector< list<int> > graph;

f.open(fileName);
while(!f.eof() && !f.fail())
{
    char line[1024]; // Reserve enough space for longest line
    f.getline(line, 1024);

    istringstream iss(line, istringstream::in);

    int vertex;
    iss >> vertex;
    if(!f.fail())
    {
        if(vertex > graph.size()) // Max number of vertex is unknown
        {
            graph.resize(vertex); 
        }
        vertex--; // From your 1-base to zero-based
        list<int>& vertex_list = graph[vertex];
        do
        {
            int to_vertex;
            iss >> to_vertex;
            if(!iss.fail())
            {
               vertex_list.push_back(to_vertex - 1);
            }
        } while(!iss.eof() && !iss.fail());
    }
} 
```

# php - 如何在 php 和 mysql 中使用分页创建搜索表单？

> ID：10080190
> 
> 赞同：-1
> 
> 时间：2012-04-09T21:34:06.877
> 
> 标签：php, mysql, search, post

我正在尝试使用 php 和 mysql 创建一个搜索表单并进行分页

所以我有一个看起来像这样的表格：

```
<form action="search_results.php" method="post">
                        <select name="cat" id="cat">
                            <option>Select Category</option>
                            <?php
                            foreach($categories as $category) {
                            echo "<option value=\"{$category -> name}\">{$category -> name}</option>";
                            }
                            ?>
                        </select>
                        <select name="sub-cat" id="sub-cat">
                            <option>Select Sub Category</option>
                        </select>
                        <label>Price Range</label>
                        <input type="text" name="from" placeholder="From" />
                        <input type="text" name="to" placeholder="To" />
                        <input type="submit" value="" name="submit" />
                    </form> 
```

我的问题是我得到了 search_result.php 的第一页

当我尝试转到第二页时，不会设置 $_POST['submit'] 因为它没有得到任何提交

任何人都知道如何解决这个问题

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T21:43:40.170

在这种情况下，出于您指定的原因，您可能应该将 GET 用于表单和后续的分页链接。

POST 最好用作一次性操作，其中 GET 是对可以过滤和黑客攻击的资源的请求。

```
search_results.php?cat=1&sub-cat=2&page=2

search_results.php?cat=1&sub-cat=2&page=3

search_results.php?cat=1&sub-cat=2&page=4

search_results.php?cat=1&sub-cat=2&page=5 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T21:47:51.180

最简单的方法是生成在查询字符串中包含搜索信息的“下一个”和“上一个”URL，然后让接收页面从 $_GET 而不是 $_POST 中读取它们。$_GET 数组的工作方式与 $_POST 数组完全相同，只是用于在 URL 中传递的变量。

另一种选择是创建一个表单，其中搜索信息存在于隐藏字段中，并使用 javascript 使“下一个”和“上一个”链接更改要获取的页面的值，然后提交表单。这将允许您使用与您现在使用的完全相同的基于 POST 的代码，尽管它会阻止用户为搜索页面添加书签并且可能会产生其他意想不到的效果。

# jquery - jQuery 将切换与单击相结合

> ID：10080194
> 
> 赞同：0
> 
> 时间：2012-04-09T21:34:16.133
> 
> 标签：jquery

这是代码：http: [//jsfiddle.net/sxqwp/1/](http://jsfiddle.net/sxqwp/1/)

我的问题是，当我按“关闭”然后按“切换”时，没有任何反应，第二次单击显示文本。当我单击“切换”时它隐藏文本然后我单击“打开”它显示文本但是当再次单击“切换”它仍然显示等等。我该如何解决这个问题

如果这样的事情怎么办？

[http://jsfiddle.net/sxqwp/6/](http://jsfiddle.net/sxqwp/6/)

```
$("a").toggle(
  function () {
      $('p').animate({width: "200px"});
  },
  function () {
    $('p').animate({width: "100px"});
  }
);

$("a.openA").click(function() {
    $('p').stop().animate({width: "200px"});
});

$("a.closeA").click(function() {
    $('p').stop().animate({width: "100px"});
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T21:37:03.800

通过不弄乱切换功能。:) [http://jsfiddle.net/sxqwp/2/](http://jsfiddle.net/sxqwp/2/)

```
$("a").click( function() { 
    $('p').toggle();
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-09T21:40:46.950

或者，您可以使用以下`.toggleClass()`方法：

```
.hide {
  display: none;
}

$("a").click(function() {
    $('p').toggleClass("hide");
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-01T08:09:02.067

试试这个——

**HTML 代码：**

```
<a href="#demo" class="nav-toggle">Toggle</a>
<a href="#demo" class='nav-open'>Open</a>
<a href="#demo" class='nav-close'>Close</a>

<div id="demo" style="display:none;">
<p>Hello</p>
<p>Good Bye</p>
</div> 
```

**查询脚本：**

```
$(document).ready(function() {
   $('.nav-toggle').click(function(){
    var content_toggle= $(this).attr('href');                    
    $(content_toggle).slideToggle('slow');
 });

   $('.nav-open').click(function(){
     var content_show = $(this).attr('href');                    
     $(content_show).slideDown();
  });

   $('.nav-close').click(function(){
      var content_hide = $(this).attr('href');                    
      $(content_hide).slideUp();
  });
}); 
```

观看直播，例如。- [http://jsfiddle.net/sxqwp/11/](http://jsfiddle.net/sxqwp/11/)

# c# - 渐进式 GC 调用

> ID：10080197
> 
> 赞同：2
> 
> 时间：2012-04-09T21:34:33.050
> 
> 标签：c#, arrays, memory-management, hashtable

有没有一种有效的方法将数组的部分内存返回给系统？我正在使用 C# 遍历一个大字符串数组和一个包含（> 100k 个元素）的哈希表，并且在我完成它们后将单个元素设置为 null。我已经尝试在各个级别和整个循环中调用垃圾收集器，但它们都没有将内存返回给系统（完全调用垃圾收集器并等待挂起的终结器会导致我的代码变得非常缓慢且无响应）。
我考虑过将数组分成 n 部分并在每个部分完成后调用 gc 但这似乎很乱

```
GC.Collect(1);
GC.Collect(2);
....
GC.Collect();
GC.WaitForPendingFinalizers();
GC.Collect(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T21:48:52.447

让垃圾收集器做它的事情。最有效的方法正是 GC 已经做的：推迟收集，直到它们真正必须完成。这样一来，它就不必进行不必要的收集，并且所有内存回收工作都可以集中到相对较少的收集调用中，因此它不必过于频繁地遍历对象图。

只需确保清除对该对象的所有引用，这样您就不会意外地使其存活时间超过必要的时间，但只要您这样做，您就不需要做任何其他事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T22:02:48.543

除了一些非常特殊和例外的情况外，最好的策略是让垃圾收集器按照自己的时间表运行。这是一款经过高度优化的软件，比你我更了解 CLR 的内部工作原理，而且几乎总是会做出比我们更好的决策。

如果您在处理完对象后担心对象消耗的内存，则可以在完成对它们的工作时将各个数组元素清空（可能使对象可以更快地被收集）。

更重要的是，是否需要一次将所有数据保存在内存中？是否可以一次只加载一点 - 例如，从文件中增量读取？如果是这样，您绝对可以选择将数组替换为`IEnumerable<T>`，从而允许您根据需要延迟加载数据，并在完成后自动忘记它。这种方法可以保证降低您的内存消耗，但代价是一些轻微的额外计算。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T22:04:41.953

如果您将字符串存储在一个数组中，那么当您遍历它们时，它们都将保留在内存中。

实际的迭代不会大大增加内存压力：您创建的任何新对象都将被有效地进行垃圾回收。

`null`对于数组的特定情况，您可以在读取数组条目后将其设置为。我会反对它：如果您在迭代开始时没有出现内存不足的问题，那么您可能也会在其余部分中幸存下来。一旦不再需要它，请确保对数组的**所有引用都清空。**在调试时，您可以在您认为不再引用该数组的位置添加 GC.Collect()。您应该观察到分配的内存大幅下降。如果这没有发生，则您在其他地方有更多对数组的引用或对数组内容的引用。

对于哈希表，这种方法根本行不通。在迭代它们时，您不能安全地从哈希表中删除条目。

现在，如果您使用的是哈希表，这意味着您并不真正关心项目的顺序。在这种情况下，您可以重新设计算法以在读取数据时对其进行处理，而无需将其保留在数组或哈希表中。

# javascript - 查看哪个页面在 iframe 中加载了我的

> ID：10080199
> 
> 赞同：0
> 
> 时间：2012-04-09T21:34:38.513
> 
> 标签：javascript, html, iframe

我有一个人们在 iframe 中加载的页面（它就像他们可以放在页面上的小部件），我想看看哪些页面正在加载它......这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:37:51.710

不，由于[Same origin policy](http://en.wikipedia.org/wiki/Same_origin_policy) ，这并不可靠。

（您必须读取 . 的值[`parent`](https://developer.mozilla.org/en/DOM/window.parent)，[`location.href`](https://developer.mozilla.org/en/DOM/window.location)这是[不可能的](https://developer.mozilla.org/en/Same_origin_policy_for_JavaScript)。）

# sublimetext2 - 如何在整个文件中进行列选择？

> ID：10080202
> 
> 赞同：64
> 
> 时间：2012-04-09T21:35:08.817
> 
> 标签：sublimetext2, sublimetext, sublimetext3

有没有办法可以在长文件中的所有行中使用中键或（++）到特定***`Ctrl`列`Alt`？`Up`***目前，我正在单击鼠标中键，然后将其拖到屏幕末尾并等待它选择所有行。

具体来说，对于长文件，我将如何在整个文件中选择一个特定的列？

* * *

## 回答 #1

> 赞同：159
> 
> 时间：2012-04-10T07:07:13.427

这应该这样做：

1.  `Ctrl+A`- 全选。
2.  `Ctrl+Shift+L`- 将选择分成几行。
3.  然后用 移动所有光标`left/right`，用 选择`Shift+left/right`。将所有光标移动到行首`Home`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-09-28T06:11:04.263

**操作系统**

您可以单击以下内容并拖动以创建一列或多列字符的选择：

*   鼠标左键 +`option`
*   鼠标中键

要添加到现有选择，`command`请在执行上述操作时按住。

要从现有选择中减去，`command + shift`请在执行上述操作时按住

**视窗**

您可以单击以下内容并拖动以创建一列或多列字符的选择：

*   鼠标右键 +`shift`
*   鼠标中键

要添加到现有选择，`Ctrl`请在执行上述操作时按住。

要从现有选择中减去，`Alt`请在执行上述操作时按住。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-03-18T04:24:24.807

在 Mac OS X 中，将 Ctrl 替换为 CMD 键。就这样，

CMD+A - 全选。CMD+Shift+L - 将选择分割成行。然后用左/右移动所有光标，用 Shift+左/右选择。将所有光标移动到带有 Home 的行首。

# jqgrid - 将方法附加到所有 jqgrid 实例？

> ID：10080203
> 
> 赞同：0
> 
> 时间：2012-04-09T21:35:11.547
> 
> 标签：jqgrid, jquery

我想从我的所有 jqGrids 中的所有不可排序的列标题中删除指针光标，如[本答案所示](https://stackoverflow.com/questions/5639761/change-cursor-style-depending-on-sort-or-not/5640442#5640442)。我目前在活动中为其中一些人这样做`gridComplete`。

有没有办法设置默认事件，或者抓取页面上的所有 jqGrids，并将该函数附加到`gridComplete`事件中？[我在选项](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:options)中找不到任何内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T23:03:23.983

如果您不*动态*`sortable`更改列的属性值，则无需在每次刷新网格时都执行此操作。列将在创建 jqGrid 时创建一次。因此，您只需将将光标固定在网格定义*之后*的不可排序列上[的代码即可。](https://stackoverflow.com/a/5640442/315935)所以你不需要使用或任何其他回调。**`gridComplete`**

 **顺便说一句，我使用 jqGrid 文档中使用的“回调”一词而不是“事件”，因为您可以为每个网格定义一个真正的回调。因此，您不能轻松地`gridComplete`在*通用*`gridComplete`操作的共同位置定义某个位置并在网格定义中使用另一个。因此，如果您将其定义`gridComplete`为默认选项`$.jgrid.defaults`（请参见[此处](https://stackoverflow.com/a/2678731/315935)），它将默认为您不会在某些 jqGrid 的定义中*覆盖*它。为了解决这个问题，我发布了如何扩展 jqGrid 的功能以支持真实事件的详细[建议。](http://www.trirand.com/blog/?page_id=393/feature-request/usage-of-jquery-events-in-jqgrid-together-with-callback-functions-used-currently/#p25559)后来我发布了带有更改的拉取请求。经过长时间的讨论，该功能已包含在[代码中](https://github.com/tonytomov/jqGrid)jqGrid 的。因此，jqGrid 的下一个版本（应该会在短时间内发布）除了回调之外，还会支持事件。**

# jquery - 将 ScrollSpy 添加到多个 div

> ID：10080204
> 
> 赞同：1
> 
> 时间：2012-04-09T21:35:12.520
> 
> 标签：jquery

我有一个根据 scroll spy 参数取消隐藏的 div，但是如果我想添加另一个在不同条件下出现的 div 怎么办？我不希望两个 div 同时出现，只有在它们被滚动之后。

下面是我的JQ：

```
<script type='text/javascript'>
    $(document).ready(function() {
            $('.nav').hide();
            $('#sticky-navigation').scrollspy({
                min: $('.nav').offset().top,
                onEnter: function(element, position) {
                    $(".nav").show('hide');
                },

            });
        });
</script> 
```

谢谢！乔伊

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T22:27:27.590

乔，

很难从您发布的片段中确切知道您要做什么，但我认为您应该查看插件站点中的颜色示例：[https ://github.com/sxalexander/jquery-scrollspy/blob/主/示例/colors.html](https://github.com/sxalexander/jquery-scrollspy/blob/master/examples/colors.html)

这是执行 Javascript 的主要代码片段”

```
$('.color').each(function(i) {
    var position = $(this).position();
    console.log(position);
    console.log('min: ' + position.top + ' / max: ' + parseInt(position.top + $(this).height()));
    $(this).scrollspy({
        min: position.top,
        max: position.top + $(this).height(),
        onEnter: function(element, position) {
            if (console) console.log('entering ' + element.id);
            $("body").css('background-color', element.id);
        },
        onLeave: function(element, position) {
            if (console) console.log('leaving ' + element.id);
            //    $('body').css('background-color','#eee');
        }
    });
}); 
```

他给他试图触发一类“颜色”的每个 div，然后使用循环为每个特定的 div 分配一个函数。在这个例子中，他指定了背景颜色，但您可以轻松地显示或隐藏 div 本身。如果您不能将行为填充到循环中，则始终可以为每个 div 单独分配 scrollspy 函数。

保罗

# c# - 四舍五入到最接近的美元

> ID：10080205
> 
> 赞同：2
> 
> 时间：2012-04-09T21:35:19.277
> 
> 标签：c#, math, rounding, floor, ceil

我正在寻找一种通过以下规定四舍五入到最接近的美元的方法：（
如果 Wholenumber.50 及以上四舍五入到下一个整数）
（如果 Wholenumber.49 及以下四舍五入到当前整数）

我努力了：

```
Math.Round(wholenumber.xx, MidpointRounding.ToEven); 
```

这并不总是四舍五入，例如 1.5 = 2 和 2.5 = 2 因为它四舍五入到最接近的偶数。

我也试过：

```
Math.Round(wholenumber.xx, MidpointRounding.AwayFromZero); 
```

这总是四舍五入到更高的整数。

我正在尝试做的事情是否有任何内置功能，或者我是否需要编写自己的自定义方法来检查数字并根据地板或天花板做地板或天花板？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-09T21:46:41.200

首先，我注意到您应该始终`decimal`用于此任务；从不使用`double`. 如果您正在使用`double`，请立即停止您正在做的事情并修复您的程序，以便您停止使用专为*物理*问题设计的类型并开始使用专为*金钱*问题设计的类型来解决您的金钱问题。

第二，你说的完全是错误的

> 这总是四舍五入到更高的整数。

它不是。它四舍五入到最接近的整数，如果因为您处于中点而没有最接近的整数，那么它会选择*离零较远*的整数。

试试看，如果你不相信我：

```
using System;
class P
{
  static void Main()
  {
    decimal buckFifty = 1.50m;
    decimal buckFortyNine = 1.49m;
    Console.WriteLine(Math.Round(buckFortyNine, MidpointRounding.AwayFromZero));
    Console.WriteLine(Math.Round(buckFifty, MidpointRounding.AwayFromZero));
    Console.WriteLine(Math.Round(-buckFortyNine, MidpointRounding.AwayFromZero));
    Console.WriteLine(Math.Round(-buckFifty, MidpointRounding.AwayFromZero));
  }
} 
```

结果是

```
1
2
-1
-2 
```

# javascript - 使用特殊字符解析 JSON

> ID：10080208
> 
> 赞同：2
> 
> 时间：2012-04-09T21:35:43.763
> 
> 标签：javascript, json, model-view-controller, flot

我正在使用 flot 进行一些绘图，并且在通过我的 json 传递 tickSize 时遇到了一些问题。我正在使用 MVC 并在模型中传递 json。这是一些在我的 javascript 函数中获取 json 的代码：

```
var json = '<%=Model.Json %>';
var data = jQuery.parseJSON(json); 
```

这是 Json 离开控制器的样子：

```
{\"GraphData\":[{\"X\":1333929600000,\"Y\":0.0},{\"X\":1333670400000,\"Y\":0.46}],\"Max\":1333324800000,\"Min\":1333929600000,\"TickSize\":\"[1, 'day']\"} 
```

我遇到问题的部分是“TickSize”。如您所见，“[1, 'day']” 带有方括号。我认为存在一些解析问题，因为 [] 通常表示数组。Flot 想要这种格式的刻度大小。如何构建我的 Json 以便我可以获取 TickSize？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T21:42:52.150

问题是字符串值中的单引号，因为您也尝试将 JSON 字符串包装在其中。生成的 JavaScript 将被（截断）：

```
var json = '...,\"TickSize\":\"[1, 'day']\"}'; 
```

由于现在有 4 个单引号，`day`它实际上并不是字符串的一部分，并且会产生语法错误。

但是，您甚至不需要引用和解析 JSON，因为它源自 JavaScript 语法：

```
var data = <%= Model.Json %>; 
```

如果您需要字符串表示，您可以在 JavaScript 中对其进行字符串化：

```
var json = JSON.stringify(data): 
```

或者在字符串服务器端转义单引号：

```
var json = '<%= Model.Json.Replace("'", "\\'") %>'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T07:24:10.503

**解决方案：** 将单个反斜杠“\”替换为双“\\”反斜杠。
对于换行符 '\n' 到 '\\n'
适用于工具提示消息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T21:45:02.570

这是因为你用`'`而不是包围了字符串`"`。这导致字符串以您的第一个`'`.

将第一行重写为

```
var json = "<%=Model.Json %>"; 
```

# java - 我可以将 Jython 动作侦听器添加到 Java 程序吗？

> ID：10080211
> 
> 赞同：2
> 
> 时间：2012-04-09T21:35:58.363
> 
> 标签：java, jython, actionlistener

我有一个 Java 程序，我想从 Jython 程序中调用它。我希望能够将这两个接口相互连接，并希望从 Jython 调用 Java 程序，并将动作侦听器作为参数，但到目前为止我还没有运气。

Jython 代码：

```
import sys
sys.path.append("sgJython.jar")
from java.awt.event import ActionListener
from java.awt.event import ActionEvent
from sg.gui import MainGui

class MyListener(ActionListener):
    def ActionPerformed(e):
          print("gotit")

ml = MyListener()
MainGui(ml) 
```

Java代码：

```
package sg;
import java.awt.event.ActionListener;
import java.awt.event.ActionEvent;
class MainGui
{
public MainGui(ActionListener listener)
{
    top = new JFrame();
    top.setBounds(300, 300, 600, 300);
    JButton doneButton = new JButton("Done");
    doneButton.addActionListener(listener);
    top.add(doneButton)
}
} 
```

还有其他方法吗？如果没有，是否有更好的方法将 Java 和 Python 集成到单个应用程序中，或者这不是一件好事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:27:23.037

它已经工作的方式，您只需要修复`actionPerformed`签名错误且未声明`self`参数的方法。

```
class MyListener(ActionListener):
    def actionPerformed(self, e):
          print("gotit") 
```

在您的 Java 代码中，您错过了几个分号，并且由于您没有显示框架，因此除非您从 Jython 代码中明确要求它，否则它将不可见。因此，出于测试目的，我对其进行了一些更改：

```
public class MainGui {

    private JFrame top;

    public MainGui(ActionListener listener) {
        top = new JFrame();
        top.setBounds(300, 300, 600, 300);
        JButton doneButton = new JButton("Done");
        doneButton.addActionListener(listener);
        top.add(doneButton);
        top.pack();
        top.setVisible(true);
    }
} 
```

我在 Eclipse 的 Java 项目中编写了 Java 代码，在 Eclipse 的 PyDev 项目中编写了 Python 代码，然后我运行了 Python 脚本，它就像一个魅力一样工作。

# php - 这是下面正确的目标路径吗

> ID：10080215
> 
> 赞同：0
> 
> 时间：2012-04-09T21:36:48.223
> 
> 标签：php

我不知道这是否有效，但我有一个位于“Exam_app”文件夹中的脚本。现在在“Exam_app”文件夹中的另一个脚本中，我有一个确定文件路径的变量：

```
$destination_path = $_SERVER['DOCUMENT_ROOT']."/../uploads/"; 
```

现在我在“Exam_app”中有一个“上传”文件夹。我想知道的是，上面的文件路径是否意味着它将把用户带到“上传”文件夹中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T21:46:29.623

如果您的文件夹“上传”在“exam_app”内，请删除“../”！

我要么喜欢这个：

```
$destination_path = str_replace("//", "/", $_SERVER['DOCUMENT_ROOT']."/")."uploads"; 
```

或者这个（如果你的服务器有 php5.3 或更高版本）：

```
$destination_path = __DIR__ . '/uploads/'; 
```

否则：

```
$destinaton_path = dirname(__FILE__) . '/uploads/'; 
```

# objective-c - 使用 NSURLRequest 请求

> ID：10080216
> 
> 赞同：10
> 
> 时间：2012-04-09T21:36:50.440
> 
> 标签：objective-c, ios, nsurlconnection, nsurlrequest

我正在尝试使用数据库（实际上在我的本地主机中）的应用程序，我尝试使用 ASIHTTPRequest 但在 iOS 5 上遇到了很多麻烦（我在那里学习了如何使用 ASIHTTPRequest 表单：[http ://www.raywenderlich.com /2965/how-to-write-an-ios-app-that-uses-a-web-service](http://www.raywenderlich.com/2965/how-to-write-an-ios-app-that-uses-a-web-service)

现在我正在尝试使用 Apple 提供的 API：NSURLRequest / NSURLConnection 等，...

我阅读了 Apple 在线指南并编写了第一个代码：

```
- (void)viewDidLoad
{

    [super viewDidLoad];

     // Do any additional setup after loading the view, typically from a nib.

    NSURLRequest *request = [NSURLRequest requestWithURL:[NSURL

                                URLWithString:@"http://localhost:8888/testNSURL/index.php"]

                                cachePolicy:NSURLRequestUseProtocolCachePolicy

                                timeoutInterval:60.0];

    [request setValue:@"Hello world !" forKey:@"myVariable"];

    NSURLConnection *theConnection=[[NSURLConnection alloc] initWithRequest:request delegate:self];

    if (theConnection) {

        receiveData = [NSMutableData data];   

    }

} 
```

我添加了 API 所需的委托

```
- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data

- (void)connection:(NSURLConnection *)connection

- (void)connectionDidFinishLoading:(NSURLConnection *)connection 
```

这是我的php代码：

```
<?php
if(isset($_REQUEST["myVariable"])) {
    echo $_REQUEST["myVariable"];
}
else    echo '$_REQUEST["myVariable"] not found';
?> 
```

那么有什么问题呢？当我启动应用程序时，它会立即崩溃并显示以下输出：

**

```
**> 2012-04-09 22:52:16.630 NSURLconnextion[819:f803] *** Terminating app
> due to uncaught exception 'NSUnknownKeyException', reason:
> '[<NSURLRequest 0x6b32bd0> setValue:forUndefinedKey:]: this class is
> not key value coding-compliant for the key myVariable.'
> *** First throw call stack: (0x13c8022 0x1559cd6 0x13c7ee1 0x9c0022 0x931f6b 0x931edb 0x2d20 0xd9a1e 0x38401 0x38670 0x38836 0x3f72a
> 0x10596 0x11274 0x20183 0x20c38 0x14634 0x12b2ef5 0x139c195 0x1300ff2
> 0x12ff8da 0x12fed84 0x12fec9b 0x10c65 0x12626 0x29dd 0x2945) terminate
> called throwing an exception** 
```

**

我想，这意味着这条线有问题：

```
[request setValue:@"Hello world !" forKey:@"myVariable"]; 
```

如果我评论这一行，它实际上是有效的。

我的问题是：如何使用 NSURLRequest 和 NSURLConnexion 将数据发送到 PHP API？

感谢您的帮助。

PS 顺便说一句，我对服务器、PHP 等知之甚少……

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-09T21:42:05.863

尝试这个：

```
NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:[NSURL

                            URLWithString:@"http://localhost:8888/testNSURL/index.php"]

                            cachePolicy:NSURLRequestUseProtocolCachePolicy

                            timeoutInterval:60.0];

[request setHTTPMethod:@"POST"];
NSString *postString = @"myVariable=Hello world !";
[request setHTTPBody:[postString dataUsingEncoding:NSUTF8StringEncoding]];

NSURLConnection *theConnection=[[NSURLConnection alloc] initWithRequest:request delegate:self];

if (theConnection) {

    receiveData = [NSMutableData data];   

} 
```

在这里看到[https://stackoverflow.com/a/6149088/1317080](https://stackoverflow.com/a/6149088/1317080)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-07-29T09:51:51.377

试试下面的代码，它是使用 Web 服务（json）的简单方法之一

```
NSURL *url = [NSURL URLWithString:@"yourURL"];

NSMutableURLRequest *urlReq=[NSMutableURLRequest requestWithURL:url];

NSURLResponse *response;

NSError *error = nil;

 NSData *receivedData = [NSURLConnection sendSynchronousRequest:urlReq
                                              returningResponse:&response
                                                         error:&error];
if(error!=nil)
{
   NSLog(@"web service error:%@",error);
}
else
{
 if(receivedData !=nil)
 {
    NSError *Jerror = nil;

    NSDictionary* json =[NSJSONSerialization
                         JSONObjectWithData:receivedData
                         options:kNilOptions
                         error:&Jerror];

   if(Jerror!=nil)
   {
    NSLog(@"json error:%@",Jerror);
   }
 }
} 
```

希望这可以帮助。

# c# - 协助对测试进行分类

> ID：10080225
> 
> 赞同：2
> 
> 时间：2012-04-09T21:37:39.517
> 
> 标签：c#, .net, unit-testing, tdd, integration-testing

我有一个我创建的 .net c# 库，我目前正在为其创建一些单元测试。我目前正在为我创建的缓存提供程序类编写单元测试。作为编写单元测试的新手，我有两个问题：

1.  我的缓存提供程序类是我的分布式缓存 - AppFabric 的抽象层。因此，为了测试我的缓存提供程序类的各个方面，例如添加到 appfabric 缓存、从缓存中删除等，涉及到与 appfabric 的通信。因此，测试此类的测试，它们仍然归类为单元测试或集成测试吗？

2.  由于与appfabric交互，我正在测试上述方法，我想对这些方法进行计时。如果它们花费的时间超过指定的基准，则测试失败。我再次问这个问题，这个性能基准测试可以归类为单元测试吗？

我设置测试的方式我想将所有单元测试、集成测试等一起包括在内，因此我提出这些问题，我希望能提供意见。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T23:05:04.920

1.  这些可能被认为是集成测试，因为您不是单独测试代码，而是至少两个不同类别的生产代码的集成。如果您让 AppFabric 的类实现接口，然后使用实现接口的存根和/或模拟测试您的缓存提供程序类，那么这将被视为单元测试。

2.  [Michael Feathers 在他的书Working Effectively With Legacy Code](https://rads.stackoverflow.com/amzn/click/com/0131177052) （第 13 页）中将 1/10 秒或更长的时间定义为单元测试太慢了。虽然从技术上讲它可能被实现为单元测试，但您可能希望使用集成测试，这也往往需要更长的时间来执行。

    原因是，如果您有数千个测试（例如 10,000 个）并且每个测试需要 1/10 秒，那么您将需要大约 17 分钟来运行它们。如果您每次提交最新更改时都运行测试（以便在您破坏某些内容时获得快速反馈），那可能太长了。这并不意味着您不应该编写较慢的单元测试，您可能需要它们，但这只是意味着您不希望随着项目的增长而像更快的单元测试那样频繁地运行它们。

    如果他们需要很长时间，我也不会让他们失败，因为他们的时间可能会在某种程度上因跑步而异。如果它们通常较慢，请将它们与集成测试分组。

    此外，Feathers 在第 14 页总结：

    > 单元测试运行速度很快。如果它们运行不快，它们就不是单元测试。
    > 
    > 其他类型的测试通常伪装成单元测试。如果满足以下条件，则测试不是单元测试：
    > 
    > 1.  它与数据库对话。
    > 2.  它通过网络进行通信。
    > 3.  它涉及文件系统。
    > 4.  你必须对你的环境做一些特殊的事情（比如编辑配置文件）来运行它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T23:05:44.887

如果您必须依赖其他类/组件，那么它不能是单元测试，您正在测试与系统其他部分的类集成。

我不建议以这种方式测试性能，因为针对相同代码的相同测试会根据外部因素而失败或成功。探查器是 IMO 的必经之路

# javascript - jQuery水平和垂直定位脚本在IE8中不起作用

> ID：10080233
> 
> 赞同：1
> 
> 时间：2012-04-09T21:39:09.417
> 
> 标签：javascript, jquery, html, css

**继承人设计** [http://vvcap.net/db/OuxLO​​YioWmjIAavL5N9U.htp](http://vvcap.net/db/OuxLOYioWmjIAavL5N9U.htp)

**这是一个演示！** [http://designobvio.us/GoldGrid2/](http://designobvio.us/GoldGrid2/)

我试图让一个垂直和水平的 jQuery 脚本在 IE8 上运行：

**脚本代码**

```
<script  type="text/javascript">

    $(document).ready(function(){

     $(window).resize(function(){

      $('.padder').css({
       position:'absolute',
       left: ($(window).width() 
         - $('.padder').outerWidth())/2,
       top: ($(window).height() 
         - $('.padder').outerHeight())/2
      });

     });

     // To initially run the function:
     $(window).resize();

    });

</script> 
```

关于为什么这个脚本不能在 IE8 中工作的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T22:01:31.440

您可能希望将高度和宽度声明为数字，以便确定数学可以正常工作，而且由于您正在更改 CSS，因此值需要是包含“px”的字符串

```
left: ((Number($(window).width()) - Number($('.padder').outerWidth()))/2)+'px',
top: ((Number($(window).height()) - Number($('.padder').outerHeight()))/2)+'px' 
```

沿着这些思路，我可能会在 CSS 之前设置值。

```
var leftVal = Number($(window).width()) - Number($('.padder').outerWidth())/2;
var topVal = Number($(window).height()) - Number($('.padder').outerHeight()))/2; 
```

然后：

```
left: leftVal+'px',
top: topVal+'px' 
```

全功能：

```
$(window).resize(function(){

    var leftVal = Number($(window).width()) - Number($('.padder').outerWidth())/2;
    var topVal = Number($(window).height()) - Number($('.padder').outerHeight()))/2;

    $('.padder').css({
        position:'absolute',
        left: leftVal+'px',
        top: topVal+'px'
    });

}); 
```

# php - Wordpress 上的多页横幅图像调用

> ID：10080240
> 
> 赞同：0
> 
> 时间：2012-04-09T21:39:51.110
> 
> 标签：php, wordpress

我在一个应该有 72 个横幅的页面上使用了一个名为 Content slider 的 word-press 横幅旋转器，横幅的名称如下所示。但这同时调用了整个横幅。

```
<?php if(function_exists('wp_content_slider')) { wp_content_slider(); } ?> 
```

它也可以仅在特定页面上调用，如下所示

```
<?php
if(is_front_page())
{
if(function_exists('wp_content_slider')) { wp_content_slider(); }
}
?> 
```

有没有办法在特定页面上调用特定图像？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T07:10:34.223

关于您在帖子中提到的功能的信息不足，无法就该功能是否具备现有功能给出明确的答案。

如果我必须提出解决方案，我会研究两种方法。

*   侵入性最小/最骇人听闻的方法是将该函数包装在输出缓冲区中，并在输出之前修改返回的结果。

*   更好的解决方案是为生成内容的数据查找/添加过滤器。

此外，我会采用实施的任何解决方案来过滤图像并将其包装在 AJAX 调用中。这样，您可以使用预加载器按原样加载页面并进行 AJAX 调用以检索下一个图像。

# c++ - 如何更改 QDialogBox 中的默认 QPushButton

> ID：10080242
> 
> 赞同：1
> 
> 时间：2012-04-09T21:40:20.327
> 
> 标签：c++, qt

我的目标是有两个按钮，“取消”和“连接”，并在用户按下 ENTER 时让取消成为默认按钮。我还希望用户能够按 Tab 键转到下一个按钮（“连接”）并按 ENTER 并按下“连接”。这是我的代码：

```
 QPushButton * cancelButton = new QPushButton(tr("&Cancel"));
    cancelButton->setAutoDefault(true);
    cancelButton->setDefault(true);
    cancelButton->setFocus();

    QPushButton * continueButton = new QPushButton(tr("Co&nnect"));
    continueButton->setAutoDefault(true);
    continueButton->setDefault(false);

    ui->buttonBox->addButton(cancelButton, QDialogButtonBox::RejectRole);
    ui->buttonBox->addButton(continueButton, QDialogButtonBox::AcceptRole); 
```

将取消按钮设置为默认按钮实际上似乎不起作用。

例如，在所有按钮上设置 autoDefault 属性似乎是必要的，以允许在按下 TAB 和 ENTER 后按下按钮。这似乎与[autoDefault](http://doc.qt.nokia.com/4.7/qpushbutton.html#autoDefault-prop)的文档不一致。但是，[默认属性](http://doc.qt.nokia.com/4.7/qpushbutton.html#default-prop)的文档似乎表明只有在没有设置了 autoDefault 属性的按钮时才会推送默认按钮。否则，按下 ENTER 时按下的按钮将是当前选择的自动默认按钮。所以看起来我需要做的是让cancelButton默认具有焦点，但我似乎无法弄清楚如何做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T21:53:49.263

您必须`cancelButton->setFocus();`在将按钮添加到 之后调用`QDialogButtonBox`，而不是之前调用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-10T06:37:32.070

在调用 dialog->show 之前尝试添加以下行

```
button->isEnabled(true) 
```

# php - PHP 计算器及其结果在不同的 html 页面上

> ID：10080246
> 
> 赞同：-1
> 
> 时间：2012-04-09T21:40:57.147
> 
> 标签：php, html

最近我一直在为我的一个客户设计和编码一个网站。他需要的功能之一是 PHP 中的计算器。问题是，我可以让计算器启动并运行，我也可以用 jQuery 制作计算器，但他想要下一页上的计算结果。计算器应该能够进行简单的计算，包括：乘法、除法、减法和加法。到目前为止，我已经设计并制作了计算器的 HTML 结构，但是当涉及到 PHP 代码时......我不知道。那么这里有没有人有编写计算器的经验但在不同的页面上显示其结果？

**最好，您可以使用我构建的 HTML 结构：**

```
<input type="text" title="result" class="input-result" name="result" readonly="readonly" value=""/>
<div class="row-container">
    <ul class="row1-ul">
        <li class="row1 calc-1 numbers">1</li>
        <li class="row1 calc-2 numbers">2</li>
        <li class="row1 calc-3 numbers">3</li>
        <li class="row1 calc-x">X</li>
    </ul>
    <ul class="row2-ul">
        <li class="row2 calc-4 numbers">4</li>
        <li class="row2 calc-5 numbers">5</li>
        <li class="row2 calc-6 numbers">6</li>
        <li class="row2 calc-/">/</li>
    </ul>
    <ul class="row3-ul">
        <li class="row3 calc-7 numbers">7</li>
        <li class="row3 calc-8 numbers">8</li>
        <li class="row3 calc-9 numbers">9</li>
    </ul>
    <ul class="row4-ul">
        <li class="row4 calc-0 numbers">0</li>
        <li class="row4 calc-+">+</li>
        <li class="row4 calc--">-</li>
    </ul>
    <div class="column-last calc-=">=</div>
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T21:52:47.043

既然您说您可能可以在 jQuery 中做到这一点，那将是最好的主意。把整个计算器包成这样

```
<form action='result.php' method="post">
    <input type="hidden" name="finalresult"> 
```

并在执行之前有一个按钮将最终结果输入到隐藏的输入中`form.submit()`（这是 submit 类型的输入按标准所做的）。“result.php”中的 PHP 脚本将能够以`$_POST['finalresult']`. 请记住，这来自脚本，因此它是用户输入，并且可能是他们试图破坏您的脚本的任何事情。

编辑：`$_POST['finalresult']`将是一个变量，您可以在 results.php 的 PHP 脚本中使用它。使用在输入中输入结果，`.val(num)`并在 results.php 中执行类似`var $calc_result = (float) $_POST['finalresult'];`操作以避免用户摆弄。

您至少需要 PHP 的基础知识，因此我建议您阅读 w3 PHP 教程：[http](http://www.w3schools.com/php/php_syntax.asp) ://www.w3schools.com/php/php_syntax.asp （另请参阅侧栏中的 $_POST ）。

# python - 在 URL 中传递多个参数

> ID：10080248
> 
> 赞同：0
> 
> 时间：2012-04-09T21:41:09.083
> 
> 标签：python, url, parameter-passing

我尝试使用 python 通过 URL 传递多个参数，我这样写：

```
 self.response.out.write("""<html><br><body><center> <li ><a href="download.py?blob_key=%s & width=%s & height=%s" >%s</a></center></body></html>      
""" % (str(blob_key),str(w),str(h), str(name))) 
```

但我无法通过这种方法，我不确切知道错误。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T21:44:27.910

这里的问题是空格。HTTP 协议不允许在请求字符串中使用它。

我会这样写：

```
'<a href="download.py?key={}&width={}&height={}">{}</a>'.format(key, w, h, name) 
```

（[**`str.format`**](http://docs.python.org/library/stdtypes.html#str.format)是新的首选替代方案`str%something`）。

# c# - C# Streamreader“找不到类型或命名空间名称”错误，但我有 System.IO 命名空间

> ID：10080250
> 
> 赞同：4
> 
> 时间：2012-04-09T21:41:17.987
> 
> 标签：c#, using, streamreader

我是 C# 的新手，但我认为我在这里有正确的“使用”语句，所以我认为问题出在我的类结构或语法的某个地方？我收到“找不到类型或命名空间名称‘Textreader’”错误。谢谢你。

```
using System;
using System.IO;

namespace Layouts.Test_control {

    public partial class Test_controlSublayout : System.Web.UI.UserControl 
    {
        private void Page_Load(object sender, EventArgs e) {

            Textreader tr = new StreamReader("date.txt");

            Console.WriteLine(tr.ReadLine());

            tr.Close();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T21:43:44.150

C# 是区分大小写的，所以你可能想要这个：

```
TextReader tr = new StreamReader("date.txt"); 
```

除此之外，您在问题中提到您将使用正确的[“使用”语句](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)，但显然您根本没有处理/关闭`StreamReader`。您也只读取文件的一行。

```
// The using statement also closes the StreamReader.
using(var sr = new StreamReader("date.txt"))
{
    String line;
    while ((line = sr.ReadLine()) != null)
    {
         Console.WriteLine(line);
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T21:43:16.550

使用 TextReader 而不是 Textreader。注意大写的 R。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T21:45:35.913

将 Textreader 更改为 TextReader，它可以工作

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T21:49:39.947

C# 是一种区分大小写的语言。您的“Textreader”对象拼写错误。它应该是“ **TextReader** ”见下文..

```
using System;
using System.IO;

namespace Layouts.Test_control {

  public partial class Test_controlSublayout : System.Web.UI.UserControl 
    {
    private void Page_Load(object sender, EventArgs e) {

TextReader tr = new StreamReader("date.txt");

Console.WriteLine(tr.ReadLine());

tr.Close();
    }
  }
} 
```

# authentication - Web 应用程序的 Active Directory

> ID：10080251
> 
> 赞同：0
> 
> 时间：2012-04-09T21:41:18.437
> 
> 标签：authentication, architecture

我们正在为我们的客户（消费者）构建一个 Web 应用程序。我只是想知道在 Active Directory 中存储用户凭据有什么用？我们也可以将加密的凭据存储在数据库中，对吗？

背景：我们将 Active Directory 用于我们的内部 Web 应用程序，其中用户仅为员工。

如果我在这里遗漏了什么，请告诉我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T02:17:17.783

AD 将为您提供一个很好的复制凭证/属性存储。如果您不打算使用 AD 并且看不到复制功能的用途，我会坚持使用简单的数据库存储。

# jquery - 编写多个jquery函数的有效方法

> ID：10080257
> 
> 赞同：0
> 
> 时间：2012-04-09T21:41:54.040
> 
> 标签：jquery, simplify

我有多个 div，我必须为每个 div 编写这样的代码，并让 php 通过循环 $NBR++ 来更改 id；在末尾。有没有一种更快的方法来编写一次，而不是为每个 div 设置唯一的？

```
 // when $NBR = 1
   <div class="playbutton<?php echo $NBR?>">
       <script>
           $(".playbutton<?php echo $NBR?>").click(function()
              {  $(".playbutton<?php echo $NBR?>").hide();
                 $('#songpicture').attr("src", "<?php echo $thumb[$NBR]?>");
              });
       </script>
   </div>

   // when $NBR = 2
   <div class="playbutton<?php echo $NBR?>">
       <script>
           $(".playbutton<?php echo $NBR?>").click(function()
              {  $(".playbutton<?php echo $NBR?>").hide();
                 $('#songpicture').attr("src", "<?php echo $thumb[$NBR]?>");
              });
       </script>
   </div> 
```

这持续了 15 次......等等......所有 php 变量都设置在 PHP 的每个 div 的开头。

那么有没有一种方法可以将其“压缩”成一个可以编写一次的代码？还是必须在每个div之后写？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T21:46:48.920

在顶部添加它并删除所有其他脚本，

```
 <script>
  $(function () {
     $(".playback_divs").click(function() {  
       $(this).hide();
       $('#songpicture').attr("src", $(this).data('thumb-nbr'));
     });
  }
 </script> 
```

并将您的 html 更改为，

```
<div class="playback_divs playbutton<?php echo $NBR?>" data-thumb-nbr="<?php echo $thumb[$NBR]?>"> 
```

注意html的变化

1) 新类`playback_divs`添加到 div。

2）数据属性`data-thumb-nbr`。

# iphone - 构建应用程序时出错

> ID：10080258
> 
> 赞同：1
> 
> 时间：2012-04-09T21:42:03.433
> 
> 标签：iphone, c++, objective-c, ios, ffmpeg

我在尝试构建我的程序时遇到问题，该程序使用 C++ 类与 FFmpeg 对象进行 dela：

```
 Undefined symbols for architecture armv7:
  "__Z13avcodec_open2P14AVCodecContextP7AVCodecPP12AVDictionary", referenced from:
      __Z10openStreamPKcb in RTPReader.o
  "__Z21avcodec_decode_audio4P14AVCodecContextP7AVFramePiP8AVPacket", referenced from:
      __Z13getStreamDataRPhRi in RTPReader.o
  "__Z20avformat_close_inputPP15AVFormatContext", referenced from:
      __Z11closeStreamv in RTPReader.o
  "__Z21avformat_network_initv", referenced from:
      __Z10openStreamPKcb in RTPReader.o
  "__Z26avcodec_get_frame_defaultsP7AVFrame", referenced from:
      __Z13getStreamDataRPhRi in RTPReader.o
  "__Z15av_register_allv", referenced from:
      __Z10openStreamPKcb in RTPReader.o
  "__Z19av_find_best_streamP15AVFormatContext11AVMediaTypeiiPP7AVCodeci", referenced from:
      __Z10openStreamPKcb in RTPReader.o
  "__Z14av_free_packetP8AVPacket", referenced from:
      __Z13getStreamDataRPhRi in RTPReader.o
      __Z11closeStreamv in RTPReader.o
  "__Z6av_logPviPKcz", referenced from:
      __Z10openStreamPKcb in RTPReader.o
      __Z13getStreamDataRPhRi in RTPReader.o
  "__Z19avformat_open_inputPP15AVFormatContextPKcP13AVInputFormatPP12AVDictionary", referenced from:
      __Z10openStreamPKcb in RTPReader.o
  "__Z26av_samples_get_buffer_sizePiii14AVSampleFormati", referenced from:
      __Z13getStreamDataRPhRi in RTPReader.o
  "__Z19avcodec_alloc_framev", referenced from:
      __Z13getStreamDataRPhRi in RTPReader.o
  "__Z25avformat_find_stream_infoP15AVFormatContextPP12AVDictionary", referenced from:
      __Z10openStreamPKcb in RTPReader.o
  "__Z13av_read_frameP15AVFormatContextP8AVPacket", referenced from:
      __Z13getStreamDataRPhRi in RTPReader.o
ld: symbol(s) not found for architecture armv7
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

不知何故，它为我所有的 C++ 方法添加了前缀 _Z##，我不知道为什么，有人可以指导一下问题可能是什么吗？提前谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T22:07:17.717

你看到的所有 __Z## 东西都是正常的。它在 C++ 中称为“名称修饰”，请参阅[http://en.wikipedia.org/wiki/Name_mangling](http://en.wikipedia.org/wiki/Name_mangling)以获得很好的解释。

我必须在这里做几个猜测，缺乏更详细的信息（对不起，我还不能评论，只能回答）。查看 ffmpeg api 文档，似乎 FFmpeg 有一个 C API，而不是 C++。如果确实如此，您的解决方案可能是使用 extern "C" 包装 FFmpeg 文件的所有#includes，例如（有关解释，请参见[http://developers.sun.com/solaris/articles/mixing.html ）：](http://developers.sun.com/solaris/articles/mixing.html)

```
extern "C" {
    #include <someffmpegheader.h>
} 
```

至于链接失败的原因，您是链接到预先构建的 ffmpeg 库，还是在项目中包含 ffmpeg 源文件？如果您链接到一个库，它可能没有正确的体系结构。如果您在终端窗口中运行以下命令，它将告诉您库中可用的架构：

```
file libffmpeg.a 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T22:01:39.003

在我看来，这个库是用 extern "C" 链接的，但是你试图在没有这个子句的情况下链接。也许您从一个版本中获取 .H 文件，而从另一个版本中获取 .LIB 文件。

尝试对导入的函数使用 extern "C" 子句 - 在 C++ 中，当您尝试从 C++ 代码访问 C 函数时您应该使用此子句

# javascript - 如何在 ASP-Classic 或 WSH 环境中使用来自 VBScript 的 Javascript OO 类？

> ID：10080262
> 
> 赞同：1
> 
> 时间：2012-04-09T21:42:29.670
> 
> 标签：javascript, iis, asp-classic, vbscript

我知道[我可以从 VBScript 调用 JS 中定义的顶级函数](http://phrogz.net/tmp/serversidejsandvb.html)，反之亦然，如下所示：

```
<%@ language="Chakra" %>

<script language='JavaScript' runat='server'>
  function jsFunction1() {
      for (var i=0;i<10;i++) Response.Write(i+"<br>");
      vbFunction2();
  }
</script>

<script language='VBScript' runat='server'>
  Sub vbFunction1 ()
      Response.Write("VB Hello <br/>" & VbCrLf)
      jsFunction1()
  End Sub
  Sub vbFunction2 ()
      Response.Write("VB Goodbye <br/>" & VbCrLf)
  End Sub
</script>

<script language="JavaScript" runat="server">
  vbFunction1();
</script> 
```

我还可以将 JS 包含到 VBScript 模块中，如下所示：

```
<%@ language="VBScript" %>

<script language="Javascript" runat="server" src="includedModule.js"></script>

<script language="VBScript" runat="server">

    ....
</script> 
```

...并且在 includedModule.js 中定义的函数在 VBScript 中可用。

但是假设我有一个使用原型 OO 定义的 Javascript 类，如下所示：

```
(function() {

  MyObj = function() {
    this.foo = ...
    ...
  };

  MyObj.prototype.method1 = function() { .. };
  MyObj.prototype.method2 = function() { .. };
}()); 
```

如何从 VBScript 中使用该对象（又名类型或类）？

香草方法...

```
Dim foo
Set foo = New MyObj 
```

...不起作用。

也没有

```
Dim foo
foo = MyObj() 
```

...因为`this`从 VBScript 调用 JS 函数时显然没有定义。或者其他的东西。

那么我该怎么做呢？

这很有价值的原因是：Javascript 中有可用的 OO 库，从 VBScript 中使用会很有趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T21:46:54.957

我不知道如何避免VBScript不能直接调用Javascript“构造函数”的问题。我处理它的方法是简单地定义一个 shim：Javascript 中的顶级函数，它从 Javascript 中调用构造函数并返回引用。

所以：

```
<script language='javascript' runat='server'>(function() {  
  MyObj = function() {  
    this.foo = ...  
    ...  
  };  

  MyObj.prototype.method1 = function() { .. };  
  MyObj.prototype.method2 = function() { .. };  

  // define a shim that is accessible to vbscript
  Shim = {construct: function() { return new MyObj(); } };

}());  
</script>

<script language='vbscript' runat='server'>
  Dim foo
  Set foo = Shim.construct()
   ...
</script> 
```

# sql-server - sql server登录windows认证

> ID：10080266
> 
> 赞同：0
> 
> 时间：2012-04-09T21:43:11.860
> 
> 标签：sql-server, sql-server-2008

我是 sql server express 的新手，我以机器管理员身份安装了带有 windows 身份验证的 sql server express 2008 R2。

我的目标是创建一个数据库，运行一些脚本来创建表和数据，并从一个 asp 应用程序连接到这个数据库。

我创建了一个新的数据库 abc，默认拥有所有者。我创建了一个新的登录名，并通过 sql server 身份验证将其称为 bob。（我做得对吗？）在这里，我为该登录名选择了默认数据库为 abc 然后我在我的数据库文件夹中创建了一个新用户（同名 bob）并映射到现有的登录鲍勃。

我做的对吗？？？

当我尝试使用 sql server 身份验证通过 sql server management studio 连接并输入用户 bob 的用户名和密码时，我收到一条错误消息，提示我无法连接。请澄清我缺少哪些步骤。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T01:42:55.177

据我了解您的问题，您的服务器使用 Windows 身份验证，但您尝试使用 SQL Server 身份验证进行连接。如果需要使用 SQL Server 身份验证进行连接，则需要将其打开。在 SQL Server Management Studio (SSMS) 中，选择此实例，选择属性，然后在安全选项卡上选中“SQL Server 和 Windows 身份验证模式”。之后，您需要重新启动 SQL Server 服务（使用 SSMS 或管理工具中的服务）。

# couchdb - 如何将“长”文档添加到 CouchDB？

> ID：10080268
> 
> 赞同：1
> 
> 时间：2012-04-09T21:43:24.553
> 
> 标签：couchdb

如何创建长而复杂的文档并将它们添加到 CouchDB？有没有我可以使用的编辑器，然后使用 CRUD 放置文件？

谢谢

雨果

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T02:29:39.250

您可以在蒲团中做到这一点。

1.  单击现有文档，或单击“新建文档”链接。您将使用标准键/值编辑器。
2.  单击右上角的“源”选项卡。
3.  双击文档正文。它将变为一个大的 <textarea> 输入字段，您可以在其中自由编辑文档。
4.  完成后，单击绿色复选标记。它将确认您的编辑是有效的 JSON。
5.  单击保存文档。这将创建或更新文档（取决于您在步骤 1 中单击的内容）

# mysql - cakephp 消息系统方案/模型/控制器最佳实践？

> ID：10080272
> 
> 赞同：1
> 
> 时间：2012-04-09T21:43:28.927
> 
> 标签：mysql, cakephp, model, controller, has-and-belongs-to-many

我正在尝试为我的用户实现一个简单的消息传递系统。

我不是 habtm 专家，所以任何帮助将不胜感激！

这是我到目前为止所得到的，请提出任何建议！(蛋糕1.3)

```
CREATE TABLE IF NOT EXISTS `app_messages` (
  `id` int(8) unsigned NOT NULL AUTO_INCREMENT,
  `from_user_id` int(8) unsigned DEFAULT NULL,
  `title` varchar(255) DEFAULT NULL,
  `body` text,
  `created` datetime DEFAULT NULL,
  PRIMARY KEY (`id`)
);
CREATE TABLE IF NOT EXISTS `app_messages_users` (
  `id` int(8) unsigned NOT NULL,
  `message_id` int(8) unsigned NOT NULL,
  `to_user_id` int(8) unsigned NOT NULL,
  `read` tinyint(1) DEFAULT '0',
  `replied` tinyint(1) NOT NULL DEFAULT '0',
  `trash` tinyint(1) NOT NULL DEFAULT '0',
  PRIMARY KEY (`id`)
);

Message.php
var $hasAndBelongsToMany = array(
        'User' =>
            array(
                'className'              => 'User',
                'joinTable'              => 'messages_users',
                'foreignKey'             => 'message_id',
                'associationForeignKey'  => 'to_user_id',
                'unique'                 => true
            )
    );

User.php
var $hasMany = array(        
        'Message' => array(            
            'className' => 'message',            
            'foreignKey' => 'from_user_id',
            'dependent'     => true       
        ) 
```

所以现在，我的问题是，我这样做对吗？

如何创建 SEND MESSAGE 函数，将正确的值插入两个表？关于 HABTM 关系，我完全是个菜鸟，但我正在努力学习。花了几个小时在网上阅读它，但仍然需要问我是否走对了路。

谢谢你的时间！！-汤姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T15:55:39.230

鉴于您的连接表具有附加字段 ( `read`, `replied`, `trash`)，您不应使用 HABTM 关系。如果这样做，您将无法从您的应用程序中访问它们。因此，您应该通过连接表的新模型配置两个 hasMany 关联。[CookBook 中对此进行了](http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html#hasmany-through-the-join-model)很好的解释。

所以你最终会得到这样的东西：

```
// User.php
class User extends AppModel {
    public $hasMany = array(
        'MessageUser' /* you can call this 'SentMessage' or something that makes more sense */
    );
}

// Message.php

class Message extends AppModel {
    public $hasMany = array(
        'MessageUser'
    );
}

// MessageUser.php

class MessageUser extends AppModel {
    public $belongsTo = array(
        'User', 'Message'
    );
} 
```

# linux - 将 1 到 1000 万的整数列表写入文件时如何获得良好的性能？

> ID：10080273
> 
> 赞同：7
> 
> 时间：2012-04-09T21:43:32.820
> 
> 标签：linux, performance, haskell

## 问题

我想要一个程序，它将编写一个序列，例如，

```
1
...
10000000 
```

到一个文件。*可以编写并获得不错性能的最简单的代码是什么*？我的直觉是存在一些缺乏缓冲的问题。我的 C 代码以 100 MB/s 的速度运行，而通过参考，Linux 命令行实用程序`dd`以~~9 GB/s~~ 3 GB/s 的速度运行（抱歉，不精确，请参阅评论——我对全局顺序更感兴趣- 量级）。

有人会认为现在这将是一个已解决的问题......即任何现代编译器都会立即编写出执行相当好的此类程序......

## C代码

```
#include <stdio.h>

int main(int argc, char **argv) {
    int len = 10000000;
    for (int a = 1; a <= len; a++) {
        printf ("%d\n", a);
    }
    return 0;
} 
```

我正在用`clang -O3`. 调用 8 次的性能骨架`putchar('\n')`可以获得相当的性能。

## 哈斯克尔代码

一个简单的 Haskell 实现以 13 MiB/秒的速度运行，使用`ghc -O2 -optc-O3 -optc-ffast-math -fllvm -fforce-recomp -funbox-strict-fields`. （我没有用 重新编译我的库`-fllvm`，也许我需要这样做。）代码：

```
import Control.Monad
main = forM [1..10000000 :: Int] $ \j -> putStrLn (show j) 
```

我最好的 Haskell 测试运行速度更慢，为 17 MiB/秒。问题是我找不到将`Vector`'s转换为`ByteString`'s 的好方法（也许有使用 iteratees 的解决方案？）。

```
import qualified Data.Vector.Unboxed as V
import Data.Vector.Unboxed (Vector, Unbox, (!))

writeVector :: (Unbox a, Show a) => Vector a -> IO ()
writeVector v = V.mapM_ (System.IO.putStrLn . show) v

main = writeVector (V.generate 10000000 id) 
```

**看起来写`ByteString`'s 很快**，正如这段代码所证明的，写了等量的字符，

```
import Data.ByteString.Char8 as B
main = B.putStrLn (B.replicate 76000000 '\n') 
```

这将获得 1.3 GB/s，虽然没有 1.3 GB/s 快`dd`，但显然要好得多。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-10T03:08:15.337

### 首先进行一些完全不科学的基准测试：

所有程序都已使用默认优化级别（gcc 为 -O3，GHC 为 -O2）编译并运行

```
time ./prog > outfile 
```

作为基准，C 程序需要 1.07 秒来生成约 76MB（78888897 字节）的文件，吞吐量约为 70MB/s。

1.  “幼稚”的 Haskell 程序 ( `forM [1 .. 10000000] $ \j -> putStrLn (show j)`) 耗时 8.64 秒，约为 8.8MB/s。
2.  相同`forM_`而不是`forM`5.64s，大约 13.5MB/s。
3.  `ByteString`dflemstr 回答的版本耗时 9.13 秒，大约 8.3MB/秒。
4.  dflemstr的`Text`答案版本耗时 5.64 秒，约为 13.5MB/秒。
5.  问题中的`Vector`版本耗时 5.54 秒，约为 13.7MB/秒。
6.  `main = mapM_ (C.putStrLn . C.pack . show) $ [1 :: Int .. 10000000]`，其中`C`，`Data.ByteString.Char8`耗时 4.25s，约 17.9MB/s。
7.  `putStr . unlines . map show $ [1 :: Int .. 10000000]`耗时 3.06s，约 24.8MB/s。
8.  手动循环，

    ```
    main = putStr $ go 1
      where
        go :: Int -> String
        go i
            | i > 10000000 = ""
            | otherwise = shows i . showChar '\n' $ go (i+1) 
    ```

    耗时 2.32s，约 32.75MB/s。

9.  `main = putStrLn $ replicate 78888896 'a'`耗时 1.15s，约 66MB/s。
10.  `main = C.putStrLn $ C.replicate 78888896 'a'`其中`C`，`Data.ByteString.Char8`耗时 0.143s，约 530MB/s，与lazy `ByteString`s 的数据大致相同。

### 我们可以从中学到什么？

首先，不要使用`forM`or`mapM`除非你真的想收集结果。就性能而言，这很糟糕。

然后，`ByteString`输出可能非常快（10.），但如果`ByteString`to 输出的构建速度很慢（3.），您最终会得到比原始`String`输出更慢的代码。

3\. 有什么可怕的？好吧，所有涉及`String`的s都很短。所以你会得到一个列表

```
Chunk "1234567" Empty 
```

在任何两个这样的对象之间，`Chunk "\n" Empty`放入 a，然后将结果列表连接起来，这意味着在构建`Empty`a 时，所有这些 s 都会被丢弃。`... (Chunk "1234567" (Chunk "\n" (Chunk "1234568" (...))))`这是很多浪费的构造-解构-重建。可以通过ing 到 strict s 并使用（以及换行符）来实现与 the`Text`和固定“天真”版本相当的速度。通过消除代价高昂的单例可以获得更好的性能，略好于 6.。如果将换行符粘贴到s 上，使用而不是，则连接必须处理一半稍长的 s，这是有回报的。`String``pack``ByteString``fromChunks``Data.List.intersperse``String``\k -> shows k "\n"``show``ByteString`

我对文本或向量的内部结构不够熟悉，无法提供关于观察到的性能原因的半受过教育的猜测，所以我将它们排除在外。可以说，与固定的幼稚`String`版本相比，性能提升最多是微不足道的。

现在，6\. 表明`ByteString`输出比`String`输出快，足以在这种情况下，`pack`ing 的额外工作得到补偿。但是，不要被它愚弄，相信总是如此。如果`String`要打包的 s 很长，则打包可能比`String`输出花费更多的时间。

但是一千万次调用`putStrLn`，无论`String`是版本还是`ByteString`版本，都需要很多时间。`stdout` `Handle`只抓取一次并`String`在非 IO 代码中构造输出会更快。`unlines`已经做得很好，但我们仍然为列表的构建而苦恼`map show [1 .. 10^7]`。不幸的是，编译器没有设法消除它（但它消除了`[1 .. 10^7]`，这已经很不错了）。所以我们自己做吧，通向8。这并不算太糟糕，但仍然是C程序的两倍多。

可以通过低级直接填充`ByteString`s 而不通过`String`via来制作更快的 Haskell 程序`show`，但我不知道 C 速度是否可以达到。无论如何，那个低级代码不是很漂亮，所以我会为你省去我所拥有的，但有时如果速度很重要，就必须亲自动手。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T22:01:15.183

使用惰性字节字符串为您提供了一些缓冲，因为字符串将立即写入，并且只会在需要时生成更多数字。此代码显示了基本思想（可能会进行一些优化）：

```
import qualified Data.ByteString.Lazy.Char8 as ByteString

main =
  ByteString.putStrLn .
  ByteString.intercalate (ByteString.singleton '\n') .
  map (ByteString.pack . show) $
  ([1..10000000] :: [Int]) 
```

我仍然使用`String`s 来表示这里的数字，这会导致可怕的减速。如果我们切换到[`text`](http://hackage.haskell.org/package/text)库而不是[`bytestring`](http://hackage.haskell.org/package/bytestring)库，我们可以访问整数的“本机”显示函数，并且可以这样做：

```
import Data.Monoid
import Data.List
import Data.Text.Lazy.IO as Text
import Data.Text.Lazy.Builder as Text
import Data.Text.Lazy.Builder.Int as Text

main :: IO ()
main =
  Text.putStrLn .
  Text.toLazyText .
  mconcat .
  intersperse (Text.singleton '\n') .
  map Text.decimal $
  ([1..10000000] :: [Int]) 
```

我不知道您如何测量这些程序的“速度”（使用该`pv`工具？），但我想这些程序之一将是您可以获得的最快的简单程序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-25T07:52:57.470

如果您要获得最佳性能，那么从整体角度来看会有所帮助；即，您想编写一个函数，该函数映射`[Int]`到将内存块写入文件的一系列系统调用。

惰性字节串是一系列内存块的良好表示。将惰性字节串映射到一系列写入内存块的系统调用是`L.hPut`正在做的事情（假设是`import qualified Data.ByteString.Lazy as L`）。因此，我们只需要一种方法来有效地构造相应的惰性字节串。这就是惰性字节串构建器所擅长的。使用新的字节串构建器（这里是[API 文档](http://people.inf.ethz.ch/meiersi/downloads/private/bytestring-0.10.0.0-public/)），下面的代码可以完成这项工作。

```
import qualified Data.ByteString.Lazy          as L
import           Data.ByteString.Lazy.Builder       (toLazyByteString, charUtf8)
import           Data.ByteString.Lazy.Builder.ASCII (intDec)
import           Data.Foldable                      (foldMap)
import           Data.Monoid                        (mappend)
import           System.IO                          (openFile, IOMode(..))

main :: IO ()
main = do
    h <- openFile "/dev/null" WriteMode
    L.hPut h $ toLazyByteString $
        foldMap ((charUtf8 '\n' `mappend`) . intDec) [1..10000000] 
```

请注意，我输出到`/dev/null`以避免磁盘驱动程序的干扰。将数据移动到操作系统的工作保持不变。在我的机器上，上面的代码运行时间为 0.45 秒，比原来的 5.4 秒快 12 倍。这意味着 168 MB/s 的吞吐量。我们可以使用有界编码额外提高 30% 的速度（220 MB/s）]。

```
import qualified Data.ByteString.Lazy.Builder.BasicEncoding as E

L.hPut h $ toLazyByteString $
    E.encodeListWithB 
        ((\x -> (x, '\n')) E.>$< E.intDec `E.pairB` E.charUtf8) 
        [1..10000000] 
```

它们的语法看起来有点古怪，因为 a`BoundedEncoding a`指定将 Haskell 类型的值转换为`a`有界长度的字节序列，以便可以*在 compile-time 计算*边界。这允许诸如`E.encodeListWithB`执行一些额外的优化以实现缓冲区的实际填充的功能。有关更多信息，请参阅`Data.ByteString.Lazy.Builder.BasicEncoding`上述 API 文档链接中的文档（唷，愚蠢的新用户超链接限制）。

这是[我所有基准测试的来源](https://gist.github.com/2487861)。

结论是，只要我们了解实现的成本模型并使用正确的数据结构，我们就可以从声明式解决方案中获得非常好的性能。每当构造一个打包的值序列（例如，表示为字节串的字节序列）时，要使用的正确数据结构是字节串`Builder`。

# actionscript-3 - 如何在 ActionScript 3.0 中写入文本文件？

> ID：10080274
> 
> 赞同：3
> 
> 时间：2012-04-09T21:43:36.877
> 
> 标签：actionscript-3, actionscript

我正在研究一种身份验证方法，我有 2 个名为“用户名”和“通过”的文本字段，我想这样做，以便当用户输入他们的用户名和密码时，该信息会存储到一个文本文件中。因此，当他们重新登录时，它会从该文本文件中读取用户名和密码以进行登录。我该怎么做？感谢：D

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T21:57:30.553

可以保存到文本文件（使用 AIR 中的 File 类），但这确实不是一个好方法。相反，您应该检查 SharedObject 类

快速示例：

```
 var sharedObject:SharedObject = SharedObject.getLocal("userInfo"); //this will look for a shared object with the id userInfo and create a new one if it doesn't exist 
```

一旦您掌握了 sharedObject 的句柄

```
sharedObject.data.userName = "Some username";
sharedObject.data.password= "Some password"; //it's really not a good idea to save a password like this
sharedObject.flush(); //saves everything out 
```

现在在代码的其他地方取回您的数据

```
var sharedObject:SharedObject = SharedObject.getLocal("userInfo");
trace(sharedObject.data.userName);
trace(sharedObject.data.password); 
```

此对象本地保存到用户计算机。它与浏览器 cookie 非常相似。

现在以纯文本形式保存该对象的密码并不是一个好主意。更好的计划是验证服务器上的登录信息并在此对象中存储某种会话 ID。

在伪代码中：

```
function validateLogin(){
    var sessionID = server->checkLogin(username, password); //returns a string if authed, nothing if not
    if(sessionID){
         sharedObject->sessionID = sessionID;
    } else {
        //bad login
    }
} 
```

更多阅读：

[http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/SharedObject.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/SharedObject.html)

[http://www.republicofcode.com/tutorials/flash/as3sharedobject/](http://www.republicofcode.com/tutorials/flash/as3sharedobject/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T14:40:37.900

理想情况下，您不能使用 flash 编写文件（除非它是 AIR 应用程序）。FLash 应该在浏览器上运行，因此允许它访问系统资源（如您的文件系统）是一种安全威胁。但是，AIR 是一种将 Flash 作为桌面应用程序运行的技术，在这种情况下，它可以写入文件。

共享对象是一种闪存可以在浏览器环境中保存一些临时数据的方法，但是，如果您清除缓存并删除浏览器文件，我想它也会被刷新。

# mysql - phpmyadmin 权限仅适用于某些数据库

> ID：10080279
> 
> 赞同：1
> 
> 时间：2012-04-09T21:44:15.723
> 
> 标签：mysql, phpmyadmin

当我使用 PHPMyAdmin 编辑或删除记录时，我收到一条错误消息“您无权访问此服务器上的 /phpmyadmin/sql.php”。但这仅发生在某些数据库中。根据 PHPMyAdmin 并通过我的 Linux 机器上的命令提示符，我是唯一的用户。

首先，我更改了 PHPMyAdmin 访问文件夹，因为我的访问日志显示其他人试图进入。日志没有显示任何成功的尝试。

它一直工作到今天......现在它抛出了错误。我仍然可以在五个数据库中的两个中完全添加和删除表，只是不能编辑记录。我也检查了用户权限，那里似乎没有问题。

有人有想法吗？

编辑：我已将其缩小到 mod_security 和 PHPMyAdmin 之间的冲突，现在到谷歌寻找解决方案，谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T06:05:24.160

我所做的是打开 modsecurity.d/modsecurity_crs_47_common_exceptions.conf 并将以下内容添加到底部：

SecRuleEngine 关闭

中提琴它解决了所有问题

# ruby-on-rails - 我无法运行我的 Rails Web 服务器

> ID：10080281
> 
> 赞同：-1
> 
> 时间：2012-04-09T21:44:28.907
> 
> 标签：ruby-on-rails, configuration, webserver

我已经安装了 ruby​​193 并通过命令提示符安装了 rails。但是，每当我尝试命令时：

```
ruby script/server 
```

我收到此错误：

```
ruby: No such file or directory -- script/server (LoadError) 
```

我检查了我的脚本文件夹，它只有一个名为 rails 的文件。

我对 Ruby on Rails 很陌生，我不完全确定我是否正确安装了所有东西。有没有简单的方法来检查我安装了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:45:35.520

尝试运行`rails server`或`rails s`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T23:51:47.773

为了澄清现有的答案，`ruby script/server`不再是在 Rails 中启动服务器的正确方法。在 Rails 3 中，我们使用`rails server`，可以缩写为`rails s`. 有关 Rails 3 命令行界面的更广泛的概要，请参阅[Rails 指南](http://guides.rubyonrails.org/command_line.html#rails-server)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T21:51:19.340

如果您正确安装了 Ruby 和 rails，则将`ruby -v`生成您已安装的版本，并且同样`rails -v`会提供已安装的 rails 版本。

要运行 rails 服务器，请尝试运行`rails server`或`rails s`

# java - 如何随机生成关卡？

> ID：10080283
> 
> 赞同：-1
> 
> 时间：2012-04-09T21:44:47.360
> 
> 标签：java, android, platform, auto-generate

我目前正在硬编码 10 个不同的实例，如下面的代码，但我想创建更多。我想知道是否可以为每个块生成一个随机 X 值，而不是为新关卡设置相同的布局（这将是它进入关卡的距离）。一个 100,000 像素宽的关卡就足够了，但如果有人知道一个系统可以让关卡继续下去，我也想知道。这基本上就是我现在定义块的方式（删除了不相关的代码）：

```
block = new Block(R.drawable.block, 400, platformheight);
block2 = new Block(R.drawable.block, 600, platformheight);
block3 = new Block(R.drawable.block, 750, platformheight); 
```

这`400`是 X 位置，我想在关卡中随机放置，`platformheight`变量定义了我不想更改的 Y 位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:12:09.187

考虑到每个块都需要比前一个块更远，

```
List<Block> blocks = new LinkedList<Block>();
Random rnd = new Random(System.currentTimeMillis());

int x = 400;

while (youNeedMoreBlocks)
{
    int offset = rnd.nextInt(400) + 100; //500 is the maximum offset, this is a constant
    x += offset;                         //ofset will be between 100 and 400

    blocks.add(new Block(R.drawable.block, x, platformheight));

    //if you have enough blocks, set youNeedMoreBlocks to false
} 
```

但这在我看来过于简单。要么我不明白你的问题，要么实际上就是这么简单。

编辑：

对于这样的任务：

```
block.setY(three_quarters - 10); 
block2.setY(three_quarters - 10); 
block3.setY(three_quarters - 10); 
```

您需要修改循环：

```
List<Block> blocks = new LinkedList<Block>();
Random rnd = new Random(System.currentTimeMillis());

int x = 400;

while (youNeedMoreBlocks)
{
    int offset = rnd.nextInt(400) + 100; //500 is the maximum offset, this is a constant
    x += offset;                         //ofset will be between 100 and 400

    Block tmp = new Block(R.drawable.block, x, platformheight);
    tmp.setY(three_quarters - 10);                 
            //do with tmp everything you need to apply to each block

    blocks.add(tmp);

    //if you have enough blocks, set youNeedMoreBlocks to false
} 
```

另一个明智的想法是在玩家靠近地图边缘时按需生成块，这样你的加载时间就会更快。

# html - Webkit 输入文件，在转换时隐藏标签： translateX

> ID：10080284
> 
> 赞同：3
> 
> 时间：2012-04-09T21:44:50.450
> 
> 标签：html, css, file-upload, webkit, css-transitions

`-webkit-transform: translateX(0%)`在父容器上使用时，文件名“标签”文本从`<input type="file">`Chrome 的标准元素中消失。在 Safari 中，文本也被隐藏，但在选择文件时会显示文件的图标。

[http://jsfiddle.net/9sZxv/](http://jsfiddle.net/9sZxv/)

仅添加和删除一个类，例如：

```
.transX
{
    -webkit-transform: translateX(0%);
}​ 
```

到父 div：

```
<div id="test1">
    <input type="file">
</div> 
```

`No file chosen`如果选择了文件，将导致文本或文件名消失。

测试 - Win7：Chrome 19 和 Safari 5.1

有修复或解决方法吗？文件选择元素对 CSS 样式不友好，并且没有任何元素可以直接引用文本部分，所以我不知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T19:50:37.987

如果您对 Chrome 中的输入框应用缩放，您可以看到它正在移动下面的文本：

[http://jsfiddle.net/9sZxv/4/](http://jsfiddle.net/9sZxv/4/)

这绝对是一个 hack，但您可以使用此 css 将文件输入按钮向下移动到与文本相同的级别：

```
.transX input::-webkit-file-upload-button {
    -webkit-transform: translateY(26px);
} 
```

然后将文件输入设置为负数，使其看起来正常。

```
.transX
{
    position: relative;
    overflow: hidden;
    height: 22px;
    -webkit-transform: translateX(20px);
}

.transX input
{
    padding-bottom: 26px;
    top: -26px;
    position: absolute;
} 
```

这是一个例子：http: [//jsfiddle.net/9sZxv/2/](http://jsfiddle.net/9sZxv/2/)

如果这不起作用，您可以尝试使用此处描述的不透明度技巧进行自己的文件输入：[http ://www.quirksmode.org/dom/inputfile.html](http://www.quirksmode.org/dom/inputfile.html)

# java - java中数组的反射

> ID：10080288
> 
> 赞同：1
> 
> 时间：2012-04-09T21:45:07.673
> 
> 标签：java, exception, reflection

我对java相当陌生并且遇到了一个问题。我的任务是创建一个包含方法 write(Object obj) 的类，该方法将对象的类型以及所有属性的名称和类型写入文件。由于对象可能具有对象/对象数组作为属性，因此涉及递归。

这是代码：

```
 public void write(Object obj) throws Exception {

    if(obj == null)
    {
        out.close();
        return;
    }

    Class c = obj.getClass();
    Class d;
    Field fields_c[] = c.getDeclaredFields();
    System.out.println("class_name:" + c.getName());

    int i, j;
    String tab = new String("");

    for(i = 0; i < indent_level; i++)
    {
        tab = tab + "\t";
    }

    out.write(tab + "class_name:" + c.getName() + "\n");

    for(i = 0; i < fields_c.length; i++) {
        System.out.println("field name: " + fields_c[i].getName() + " ");

        c = fields_c[i].getType();
        fields_c[i].setAccessible(true);

        if(c.isPrimitive()) {
            out.write("\t" + tab + "field_name:" + c.toString() + "\n");
        }
        else if(c.isArray()) {
            System.out.println("field of type array with elements of type:" + c.getComponentType());

            for(j = 0; j < Array.getLength(c); j++)
            {
                d = Array.get(c, j).getClass();
                indent_level = indent_level + 1;
                this.write(d);
                indent_level = indent_level - 1;            
            }
        }
        else
        {
            System.out.println("field is not primitive of type:" + c.getName());
            Object foo = fields_c[i].get(obj);
            indent_level = indent_level + 1;
            this.write(foo);
            indent_level = indent_level - 1;
        }
    }
} 
```

如果我调用该方法并给出一个具有数组属性的对象，则会出现异常；直到数组被正确写入输出文件的所有属性。例外是“java.lang.IllegalArgumentException：参数不是数组”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:50:11.557

In`d = Array.get(c, j).getClass();` `c`是 java.lang.Class 类型，但需要一个数组。

您应该将其更改为`d = Array.get(fields_c[i].get(obj), j)`并`c#getComponentType`用于获取数组的类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T21:51:07.157

这可能不是您所追求的，但如果这与序列化有关，那么我推荐“简单”；

[http://simple.sourceforge.net/](http://simple.sourceforge.net/)

它使 Java <=> XML 序列化变得异常简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T21:53:01.137

为什么要传递元素类而不是元素：

```
 Object[] array = fields_c[i].get(obj);
        for(j = 0; j < Array.getLength(array); j++)
        {
            Object foo = Array.get(array, j); // not .getClass()
            indent_level = indent_level + 1;
            this.write(foo);
            indent_level = indent_level - 1;            
        } 
```

# java - 无法解释的 ClosedByInterruptException。Java FileChannel 错误？

> ID：10080290
> 
> 赞同：0
> 
> 时间：2012-04-09T21:45:18.860
> 
> 标签：java, exception, nio, filechannel

很少，我的生产应用程序`ClosedByInterruptException`在调用`FileChannel`. 根据 Java 文档，当调用线程处于中断状态时会发生这种情况。有趣的是，我的应用程序从不中断任何线程。这似乎是从应用程序下方发生的。也许某种系统中断？有没有人遇到过这个问题？

```
java.nio.channels.ClosedByInterruptException
    at java.nio.channels.spi.AbstractInterruptibleChannel.end( \
      AbstractInterruptibleChannel.java:184)
    at sun.nio.ch.FileChannelImpl.size(FileChannelImpl.java:314) 
    ... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T01:42:59.477

您的应用程序可能永远不会中断线程，但 JVM 可能出于自身原因这样做了。这根本不可能是一个`FileChannel`错误，而是 JVM 本身的一些不可预见的情况。

# domain-driven-design - 我们真的需要一个带有事件溯源和 CQRS 模式的独立事件存储吗？

> ID：10080291
> 
> 赞同：1
> 
> 时间：2012-04-09T21:45:22.587
> 
> 标签：domain-driven-design, cqrs, event-sourcing

假设我们需要实现一些需要检查对象历史（事件存储）的域规则。例如，我们有一个带有 CurrentStatus 属性的 Order 对象，我们需要检查 Order.CurrentStatus 更改历史记录。

您很可能会回答我需要将这些知识转移到领域并引入包含状态记录集合的 Order.StatusHistory 属性，并且我不应该查询事件存储。我会同意你的。

*我的问题是 Event Store 的需求。*

我们在事件存储中写入具有业务意义（领域价值）的事件，我们不记录 UserMovedMouse 事件（在大多数情况下）。与 OrderStatusChanged 事件一样，很可能在某些时候需要来自 EventStore 的大多数事件用于域逻辑，我们最终会得到一个域对象，该对象具有 EventHistory 属性和事件集合。

当您有单个只写事件存储和多个只读查询存储时，我可以在单独的事件存储中看到 CQRS 等模式的值，这为您提供了一些可伸缩性。然而，在代码中引入这样的东西对我来说也是个问题。所有像样的数据库都支持单写服务器、多读服务器的可扩展性（主从复制）。为什么我要在源代码级别引入这样的东西？为什么不忘记 Web 服务和消息总线，并使用编写自己的 Sockets 包装器。

我非常尊重“老派” DDD，因为它被 Eric Evans 描述，我在新浪潮 DDD+SQRC+EventSourcing 模式聚合中看到了一些新鲜和好的想法。然而，CQRS 的主要思想对我来说是个大问题。我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T03:30:48.583

简而言之：如果不需要事件溯源（因为它的额外好处或作为某些怪癖的解决方法），那么您绝对不应该仅仅为了它而将它带入您的系统。

ES 只是在有界上下文中增强 CQRS 架构风格的众多方法之一。这不是一个要求。

# ruby-on-rails - 为什么我会收到 RuntimeError：“...”上的会话冲突

> ID：10080300
> 
> 赞同：0
> 
> 时间：2012-04-09T21:46:08.607
> 
> 标签：ruby-on-rails, ruby-on-rails-3, session, memcached

我收到了很多会话冲突异常。通常每天至少一个，但有时我部署并连续获得 2-3 个，然后什么也没有。

该应用程序在 Rails 3.2.2 和 unicorn 上运行，会话存储在 memcached 中。

异常发生在不同控制器的不同位置，我真的无法找到它们的共同点。这可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T14:25:42.330

我不知道 ruby​​/rails 如何使用 memcached 处理会话数据，但通常工作如下：

```
new session    -> using command ADD
update session -> using GET with token and than the command CAS (check and set) 
```

如果存在哈希冲突，则命令 ADD 将失败，因为会话已经存在。另一个可能的问题是，如果另一个进程更新了 GET 和 CAS 之间的同一会话。

# c# - Web服务第一次运行需要很长时间

> ID：10080301
> 
> 赞同：1
> 
> 时间：2012-04-09T21:46:13.247
> 
> 标签：c#

我是编写和部署 Web 服务的新手，我有一个 Web 服务，当我从 C# 应用程序运行它时，响应第一个调用需要 4-8 秒。随后的调用在半秒范围内。如果我从 Internet Explorer 调用 Web 服务，它会立即返回。

我的 Web 服务是在 windows web server 2008 服务器上运行的 Soap Web 服务。几天来我一直在寻找解决方案，但我尝试过的没有任何帮助。尝试过的两件事似乎不起作用是预编译 XmlSerializers（生成序列化程序集已打开）并使用 aspnet_compiler 预编译 Web 服务。我将 aspnet_compiler 的输出复制到服务器并粘贴到相应的文件夹中。

我的应用程序使用添加 Web 引用向导时创建的自动生成代码 Web 参考代码调用 Web 服务。

还有什么我可以尝试的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T21:51:32.027

一个常见的罪魁祸首是在没有与 Internet 的开放连接的情况下检查 Publisher Evidence（基本上是程序集签名）。

尝试将以下行添加到您的 ASPNET.CONFIG 或 APP.CONFIG 文件中：

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
    <runtime>
        <generatePublisherEvidence enabled="false"/>
    </runtime>
</configuration> 
```

有关背景和详细信息，请参阅在线文章，例如

*   [http://blogs.msdn.com/b/pfedev/archive/2008/11/26/best-practice-generatepublisherevidence-in-aspnet-config.aspx](http://blogs.msdn.com/b/pfedev/archive/2008/11/26/best-practice-generatepublisherevidence-in-aspnet-config.aspx)

# java - 关于如何将文本字段中的内容添加到 JList

> ID：10080307
> 
> 赞同：0
> 
> 时间：2012-04-09T21:46:51.277
> 
> 标签：java, swing, user-interface, jlist

我有一个程序需要接受用户输入（来自输入框）并将其添加到`JList`. 但是，当我单击程序上的“添加”按钮时，会出现错误。

这是我希望能工作的代码

```
JButton addButton = new JButton( "<-Add" );
         addButton.addActionListener(
         new ActionListener() {
            public void actionPerformed( ActionEvent event )
                         {
                         final String name=inputField.getText();
                         // prompt user for new philosopher's name

                         // add new philosopher to model
                         philosophers.addElement( name );
                     }
                 }
                 ); 
```

编辑：虽然我测试了这部分并且我相信它可以工作，但这是所有代码（除了我试图添加到文本框中的列表器）

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

    public class PhilosophersJList extends JFrame {

     private DefaultListModel philosophers;
     private JList list;
     private JTextField inputField;

     public PhilosophersJList()
         {
         super( "Favorite Philosophers" );

         // create a DefaultListModel to store philosophers
         philosophers = new DefaultListModel();
         philosophers.addElement( "Socrates" );
         philosophers.addElement( "Plato" );
         philosophers.addElement( "Aristotle" );
         philosophers.addElement( "St. Thomas Aquinas" );
         philosophers.addElement( "Soren Kierkegaard" );
         philosophers.addElement( "Immanuel Kant" );
         philosophers.addElement( "Friedrich Nietzsche" );
         philosophers.addElement( "Hannah Arendt" );

         // create a JList for philosophers DefaultListModel
         list = new JList( philosophers );
         JButton addButton = new JButton( "<-Add" );
         addButton.addActionListener(
         new ActionListener() {
            public void actionPerformed( ActionEvent event )
                         {
                         final String name=inputField.getText();
                         // prompt user for new philosopher's name

                         // add new philosopher to model
                         philosophers.addElement( name );
                     }
                 }
                 );

         // create JButton for removing selected philosopher
         JButton removeButton =
         new JButton( "Rem->" );

         removeButton.addActionListener(
             new ActionListener() {

             public void actionPerformed( ActionEvent event )
                 {
                 // remove selected philosopher from model
                 setTitle("Now Removing Contact");
                 try 
                {
                Thread.sleep(1000); // do nothing for 1000 miliseconds (1 second)
                } 
                catch(InterruptedException e)
                {
                e.printStackTrace();
                }
                 philosophers.removeElement(list.getSelectedValue());
                 setTitle("My Contacts List");
             }
         }
         );
         JTextField inputField=new JTextField();
         inputField.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {

            }

        });

         // allow user to select only one philosopher at a time
         list.setSelectionMode(
         ListSelectionModel.SINGLE_SELECTION );
         //Create the text field

         // create JButton for adding philosophers

         // lay out GUI components
         JPanel inputPanel = new JPanel();
         inputPanel.add( addButton);
         inputPanel.add( removeButton);
         inputPanel.setLayout(new BoxLayout(inputPanel,BoxLayout.Y_AXIS));

         inputField.setLayout(new FlowLayout());
         inputField.setBounds(5, 5, 100, 100);
         inputField.setPreferredSize(new Dimension(120,20));
         JScrollPane scrollPane=new JScrollPane(list);
         scrollPane.setPreferredSize(new Dimension(200,200));

         Container container = getContentPane();
         add(scrollPane);
         container.add( inputPanel);
         add( inputField);
         container.setLayout(new FlowLayout());

         setDefaultCloseOperation( EXIT_ON_CLOSE );
         setSize( 500, 250 );
         setVisible( true );

     } // end PhilosophersJList constructor

     // execute application
       public static void main( String args[] )
             {
             new PhilosophersJList();
         }
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T22:54:31.870

您不初始化 inputField 字段。问题出在第 69 行，在这里您声明了一个名为 inputField的*新局部变量，而不是分配该字段。*您需要实际引用 inputField 字段。

所以而不是

```
JTextField inputField = new JTextField(); 
```

你应该只写

```
inputField = new JTextField(); 
```

# objective-c - 代表的 __unsafe_unretained 不会构建

> ID：10080312
> 
> 赞同：14
> 
> 时间：2012-04-09T21:47:40.493
> 
> 标签：objective-c, ios

我有一个来自 .h 文件的代码（片段）：

```
#import <UIKit/UIKit.h>
#import "ILView.h"

/**
 * Controls the orientation of the picker
 */
typedef enum {
    ILHuePickerViewOrientationHorizontal     =   0,
    ILHuePickerViewOrientationVertical       =   1
} ILHuePickerViewOrientation;

@class ILHuePickerView;

/**
 * Hue picker delegate
 */
@protocol ILHuePickerViewDelegate

/**
 * Called when the user picks a new hue
 *
 * @param hue 0..1 The hue the user picked
 * @param picker The picker used
 */
-(void)huePicked:(float)hue picker:(ILHuePickerView *)picker;

@end

/**
 * Displays a gradient allowing the user to select a hue
 */
@interface ILHuePickerView : ILView {
    id<ILHuePickerViewDelegate> delegate;
    float hue;
    ILHuePickerViewOrientation pickerOrientation;
}

/**
 * Delegate
 */
//@property (assign, nonatomic) IBOutlet id<ILHuePickerViewDelegate> delegate;
@property (assign, nonatomic) IBOutlet __unsafe_unretained id<ILHuePickerViewDelegate> delegate;

/**
 * The current hue
 */
@property (assign, nonatomic) float hue; 
```

.m 文件如下所示：

```
#import "ILHuePickerView.h"
#import "UIColor+GetHSB.h"

@interface ILHuePickerView(Private)

-(void)handleTouches:(NSSet *)touches withEvent:(UIEvent *)event;

@end

@implementation ILHuePickerView

@synthesize color, delegate, hue, pickerOrientation;

#pragma mark - Setup

-(void)setup
{
    [super setup]; 
```

我查看了类似情况的 SO，发现我需要在属性中添加“__unsafe_unretained”......我这样做了（希望是正确的），但它仍然在构建中失败。完整的错误信息是：Existing ivar 'delegate' for property 'delegate' with assign 属性 must be __unsafe_unretained

![截屏](../Images/6eb9a3cdb27393ebb5b488605872ec55.png)

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-04-09T21:55:53.667

正如错误消息告诉您的那样，*ivar*：

```
@interface ILHuePickerView : ILView {
    id<ILHuePickerViewDelegate> delegate;    // <-- This is the ivar 
```

需要声明`__unsafe_unretained`：

```
__unsafe_unretained id<ILHuePickerViewDelegate> delegate; 
```

不是财产：

```
@property (assign, nonatomic) IBOutlet id<ILHuePickerViewDelegate> delegate; 
```

因为 ARC 所有权限定符不适用于属性；它们仅适用于变量。

由于该`@synthesize`指令为您*创建*了 ivar（使用正确的 ARC 限定符），但是，您可以跳过它的声明：

```
@interface ILHuePickerView : ILView 

/**
 * Delegate
 */
@property (assign, nonatomic) IBOutlet id<ILHuePickerViewDelegate> delegate;

// etc. 
```

事实上，这是现在*推荐*的程序；请参阅在 TOCPL 中[定义类。](http://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/ObjectiveC/Chapters/ocDefiningClasses.html#//apple_ref/doc/uid/TP30001163-CH12-TPXREF122)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T21:55:30.697

我过去使用过 ILColorPicker，但它绝对不是 ARC 就绪的。`-fno-objC-arc`在 ILColorPicker 类的编译器标志设置中设置。

# google-app-engine - 如何在 Android Emulator 和 Appengine Dev 中使用虚拟 google 帐户

> ID：10080313
> 
> 赞同：2
> 
> 时间：2012-04-09T21:47:41.637
> 
> 标签：google-app-engine, android-emulator

我正在开发一个使用 App Engine (Java) 的网络 + 移动应用程序，并使用 Android Accounts API 进行自动身份验证，使用的代码如下：

```
AccountManager manager = AccountManager.get(activity);
Account[] accounts = manager.getAccountsByType("com.google"); 
```

我希望能够离线开发 - 使用 android 模拟器和 appengine 开发服务器。如何在我的模拟器上设置一个帐户，例如`xyz@example.com`（或`xyz@google.com`），以便能够将其与`localhost:8888/`url 一起使用？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T06:35:07.183

在模拟器内部时，可以使用 ip 地址 10.0.2.2 访问主机 localhost 接口（您的开发服务器正在侦听的接口）。我认为开发服务器接受任何谷歌帐户。

# regex - 如何比较两个文件之间字段的特定部分

> ID：10080317
> 
> 赞同：3
> 
> 时间：2012-04-09T21:48:03.117
> 
> 标签：regex, unix, awk

我正在努力完成以下任务，即在具有制表符分隔字段的两个文件之间比较字段的一部分（3 美元）。文件与其他字段 $1-2 逐行匹配，但 $3 略有不同。**我只对 $3 的一部分感兴趣，即AF**的数值。$3 中的所有子字段（？）都用分号分隔，但如您所见，**AF**值并不总是在该位置（有时是#2，有时是#3）。我想拔出文件之间第三个字段中**AF的值不同的行。**

例如，这是示例文件 1：

```
dmel_mitochondrion_genome       18984   AB=0.743;AC=4;AF=0.50;AN=8;BaseQRankSum=$
dmel_mitochondrion_genome       19066   AB=0.684;AC=4;AF=0.50;AN=8;BaseQRankSum=$
dmel_mitochondrion_genome       19074   AB=0.321;AC=4;AF=0.50;AN=8;BaseQRankSum=$
dmel_mitochondrion_genome       19212   AC=8;AF=1.00;AN=8;DP=382;DS;Dels=0.00;FS$
dmel_mitochondrion_genome       19285   AC=8;AF=1.00;AN=8;DP=342;DS;Dels=0.00;FS$
dmel_mitochondrion_genome       19384   AC=8;AF=1.00;AN=8;DP=400;DS;Dels=0.00;FS$
dmel_mitochondrion_genome       19395   AC=8;AF=1.00;AN=8;DP=398;DS;Dels=0.00;FS$
dmel_mitochondrion_genome       19461   AB=0.524;AC=4;AF=0.50;AN=8;BaseQRankSum=$
dmel_mitochondrion_genome       19472   AB=0.527;AC=4;AF=0.50;AN=8;BaseQRankSum=$
dmel_mitochondrion_genome       19475   AC=8;AF=1.00;AN=8;BaseQRankSum=0.936;DP=$ 
```

和示例文件2：

```
dmel_mitochondrion_genome       18984   AB=0.730;AC=4;**AF=1.00**;AN=8;BaseQRankSum=$
dmel_mitochondrion_genome       19066   AB=0.742;AC=4;AF=0.50;AN=8;BaseQRankSum=$
dmel_mitochondrion_genome       19074   AB=0.345;AC=4;AF=0.50;AN=8;BaseQRankSum=$
dmel_mitochondrion_genome       19212   AC=8;AF=1.00;AN=8;BaseQRankSum=1.722;DP=$
dmel_mitochondrion_genome       19285   AC=8;AF=0.50;AN=8;BaseQRankSum=1.721;DP=$
dmel_mitochondrion_genome       19384   AC=8;AF=1.00;AN=8;BaseQRankSum=1.458;DP=$
dmel_mitochondrion_genome       19395   AC=8;AF=1.00;AN=8;DP=391;DS;Dels=0.00;FS$
dmel_mitochondrion_genome       19461   AB=0.510;AC=4;AF=0.50;AN=8;BaseQRankSum=$
dmel_mitochondrion_genome       19472   AB=0.526;AC=4;AF=0.50;AN=8;BaseQRankSum=$
dmel_mitochondrion_genome       19475   AC=8;AF=0.50;AN=8;BaseQRankSum=-1.732;DP$ 
```

我想得到的输出是 file1 中的以下几行：

```
dmel_mitochondrion_genome       18984   AB=0.743;AC=4;AF=0.50;AN=8;BaseQRankSum=$
dmel_mitochondrion_genome       19285   AC=8;AF=1.00;AN=8;DP=342;DS;Dels=0.00;FS$
dmel_mitochondrion_genome       19475   AC=8;AF=1.00;AN=8;BaseQRankSum=0.936;DP=$ 
```

甚至是这样的：

```
dmel_mitochondrion_genome       18984   AF=0.50  
dmel_mitochondrion_genome       19285   AF=1.00  
dmel_mitochondrion_genome       19475   AF=1.00 
```

我尝试使用 awk 但我不知道如何比较部分字段而不是整个字段。我终于想出了如何使用正则表达式从一个文件的每一行中查找 AF 的值，但不知道如何捕获该值以将其与另一个文件中的另一个值进行比较。任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T22:01:18.353

以下命令应该为您提供所需格式的每个文件。然后你可以对它们做一个diif ...

```
awk '{s=$0; split(s, a, "AF="); split(a[1], a1); split(a[2], a2, ";"); print a1[1] " " a1[2] " AF=" a2[1]}' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T22:08:24.977

您可以使用 AWK 数组作为哈希表来存储第一次出现的**AF**值，然后将其与下一次出现比较：

```
BEGIN { store[0] = 0 }
{
    key = $1 "-" $2
    match($3, /AF=[^;*]+/)
    val = substr($3, RSTART+3, RLENGTH-3)
    if ((key in store) && (store[key] != val))
        print $1,$2,"AF=" store[key]
    else
        store[key] = val
} 
```

然而，filter-then-diff 解决方案似乎更优雅，因为这个解决方案有可能消耗大量内存。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T22:20:59.470

略有不同的方法

```
awk '{subList=$3; 
 sub(/.*AF=/, "AF=", subList); sub(/;.*$/, "", subList)
 print $1 "\t" $2 "\t" subList}'  awkTest_20120409_1.txt > awkTest_20120409_1_cln.txt

awk '{subList=$3; 
 sub(/.*AF=/, "AF=", subList); sub(/;.*$/, "", subList)
 print $1 "\t" $2 "\t" subList}'  awkTest_20120409_2.txt > awkTest_20120409_2_cln.txt

diff awkTest_20120409_1_cln.txt awkTest_20120409_2_cln.txt | grep '^<' | sed 's/< //' 
```

** 输出 **

```
dmel_mitochondrion_genome       18984   AF=0.50
dmel_mitochondrion_genome       19285   AF=1.00
dmel_mitochondrion_genome       19475   AF=1.00 
```

当然，您需要将文件名替换为输入和输出，以及`diff`.

我希望这有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T22:25:10.727

TXR：为处理糟糕文本文件的分子生物学家而创建。还有其他人。

因为文件可能很大，我们避免在内存中保留从一对行到下一行的任何内容（由`:vars ()`collect 子句中的确保）。

这里使用了一个技巧，使两个文件看起来像是一个流，带有交错的行。然后我们可以对该流进行模式匹配，就好像它是一个文件一样。

变量（第 3 列材料）被解析为 Lisp 关联列表，因此我们可以使用它`assoc`来查找感兴趣字段的值。它是按字符串比较的；如有必要，可以转换为数值，以便将 0.5 和 0.50 视为相同。

```
@(next :args)
@(cases)
@file1
@file2
@(or)
@  (throw error "two file names needed")
@(end)
@;
@; functional programming trick: make a bottomless lazy list which returns
@; strings, which are the lines from files f1 and f2, alternating.
@;
@(do (defun make-interleaved-lazy-stream (f1 f2)
       (let ((streams '#(,(open-file f1 "r") ,(open-file f2 "r"))))
         (let ((toggle 0) line)
           (gen (prog1
                  (set line (get-line [streams toggle]))
                  (set toggle (- 1 toggle)))
                line)))))
@(define parse-line (gen id alist))
@gen @id @(coll)@{var /[A-Z]+/}=@val;@(end)
@  (bind alist @[mapcar cons var val])
@(end)
@(next :list @(make-interleaved-lazy-stream file1 file2))
@(collect :vars ())
@  (cases)
@    (parse-line gen id alist1)
@    (parse-line gen id alist2)
@  (or)
@    (throw error `assumption violated: mismatching lines between @file1 and @file2`)
@  (end)
@  (do (let ((AF1 (cdr (assoc "AF" alist1)))
             (AF2 (cdr (assoc "AF" alist2))))
         (if (not (equal AF1 AF2))
           (put-string `@{gen 30} @{id -6}   AF1=@AF1\n`))))
@(end) 
```

跑：

```
$ txr gendiff.txr file1 file2
dmel_mitochondrion_genome       18984   AF1=0.50
dmel_mitochondrion_genome       19285   AF1=1.00
dmel_mitochondrion_genome       19475   AF1=1.00 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T23:14:46.543

这可能会有所帮助 -

```
awk -F'[; =]' '
NR==FNR{ for (i=1;i<=NF;i++) if ($i=="AF") b[++x]=$(i+1); c[x]=$0; next } 
{for (j=1;j<=NF;j++) if ($j=="AF") d[++y]=$(j+1)} 
END {for (z=1;z<=length(b);z++) if (b[z]!=d[z]) print c[z]}' f1 f2 
```

### 文件 1：

```
[jaypal:~/Temp] cat f1
dmel_mitochondrion_genome       18984   AB=0.743;AC=4;AF=0.50;AN=8;BaseQRankSum=$
dmel_mitochondrion_genome       19066   AB=0.684;AC=4;AF=0.50;AN=8;BaseQRankSum=$
dmel_mitochondrion_genome       19074   AB=0.321;AC=4;AF=0.50;AN=8;BaseQRankSum=$
dmel_mitochondrion_genome       19212   AC=8;AF=1.00;AN=8;DP=382;DS;Dels=0.00;FS$
dmel_mitochondrion_genome       19285   AC=8;AF=1.00;AN=8;DP=342;DS;Dels=0.00;FS$
dmel_mitochondrion_genome       19384   AC=8;AF=1.00;AN=8;DP=400;DS;Dels=0.00;FS$
dmel_mitochondrion_genome       19395   AC=8;AF=1.00;AN=8;DP=398;DS;Dels=0.00;FS$
dmel_mitochondrion_genome       19461   AB=0.524;AC=4;AF=0.50;AN=8;BaseQRankSum=$
dmel_mitochondrion_genome       19472   AB=0.527;AC=4;AF=0.50;AN=8;BaseQRankSum=$
dmel_mitochondrion_genome       19475   AC=8;AF=1.00;AN=8;BaseQRankSum=0.936;DP=$ 
```

### 文件 2：

```
[jaypal:~/Temp] cat f2
dmel_mitochondrion_genome       18984   AB=0.730;AC=4;AF=1.00;AN=8;BaseQRankSum=$
dmel_mitochondrion_genome       19066   AB=0.742;AC=4;AF=0.50;AN=8;BaseQRankSum=$
dmel_mitochondrion_genome       19074   AB=0.345;AC=4;AF=0.50;AN=8;BaseQRankSum=$
dmel_mitochondrion_genome       19212   AC=8;AF=1.00;AN=8;BaseQRankSum=1.722;DP=$
dmel_mitochondrion_genome       19285   AC=8;AF=0.50;AN=8;BaseQRankSum=1.721;DP=$
dmel_mitochondrion_genome       19384   AC=8;AF=1.00;AN=8;BaseQRankSum=1.458;DP=$
dmel_mitochondrion_genome       19395   AC=8;AF=1.00;AN=8;DP=391;DS;Dels=0.00;FS$
dmel_mitochondrion_genome       19461   AB=0.510;AC=4;AF=0.50;AN=8;BaseQRankSum=$
dmel_mitochondrion_genome       19472   AB=0.526;AC=4;AF=0.50;AN=8;BaseQRankSum=$
dmel_mitochondrion_genome       19475   AC=8;AF=0.50;AN=8;BaseQRankSum=-1.732;DP$ 
```

### 测试：

```
[jaypal:~/Temp] awk -F'[; =]' '
NR==FNR{ for (i=1;i<=NF;i++) if ($i=="AF") b[++x]=$(i+1); c[x]=$0; next } 
{for (j=1;j<=NF;j++) if ($j=="AF") d[++y]=$(j+1)} 
END {for (z=1;z<=length(b);z++) if (b[z]!=d[z]) print c[z]}' f1 f2
dmel_mitochondrion_genome       18984   AB=0.743;AC=4;AF=0.50;AN=8;BaseQRankSum=$
dmel_mitochondrion_genome       19285   AC=8;AF=1.00;AN=8;DP=342;DS;Dels=0.00;FS$
dmel_mitochondrion_genome       19475   AC=8;AF=1.00;AN=8;BaseQRankSum=0.936;DP=$ 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-10T00:33:55.897

这可能对您有用：

```
awk -vfile2=file2 -vOFS='\t' '{sub(/.*AF=[^0-9.-]*/,"",$3);sub(/[^0-9.-]+.*/,"",$3);getline line <file2;sub(/.*AF=[^0-9.-]*/,"",line);sub(/[^0-9.-]+.*/,"",line)};$3!=line{$3="AF="$3;print}' file1 
```

由于`file1`和`file2`匹配除了`AF`值：

*   读取一行`file1`
*   减至价值`$3`_`AF`
*   将一行读`file2`入变量`line`
*   减至价值`line`_`AF`
*   如果它们不匹配`$3`，则比较`line`和输出`$0`（`file1`在前面`$3`加上）。`AF=`

# ios - 第二个视图的视图会出现在第一个视图的视图消失之前吗？

> ID：10080318
> 
> 赞同：0
> 
> 时间：2012-04-09T21:48:12.607
> 
> 标签：ios, viewwillappear

我将它用于某种初始化，但它以这种方式失败。是否可以使用另一个？

它是某种 UDP 客户端的初始化。

# jquery - JQuery动态调整DIV宽度

> ID：10080323
> 
> 赞同：0
> 
> 时间：2012-04-09T21:49:06.403
> 
> 标签：jquery, css, html, width, scrollbar

我知道这可以有一个简单的解决方案，但我找不到方法。

我正在使用这个 JQuery 插件（TinyScrollbar）构建一个水平“滚动框”：http: [//baijs.nl/tinyscrollbar/](http://baijs.nl/tinyscrollbar/)

我在每一页上都有两个“滚动框”，但里面有不同的“子”框（在一行中）。

这是第一个“小部件”的 HTML 代码。

```
<div id="scrollbar1">
    <div class="scrollbar">
        <div class="track"><div class="thumb"><div class="end"></div></div></div>
    </div>
    <div class="viewport">
        <div class="overview">
        <div class="item">Content</div>
        <div class="item">Content</div>
        <div class="item">Content</div>
    </div>
</div> 
```

这是第二个“小部件”的 HTML 代码。

```
<div id="scrollbar1">
    <div class="scrollbar">
        <div class="track"><div class="thumb"><div class="end"></div></div></div>
    </div>
    <div class="viewport">
        <div class="overview">
            <div class="item">Content</div>
                <div class="item">Content</div>
                <div class="item">Content</div>
                <div class="item">Content</div>
                <div class="item">Content</div>
                <div class="item">Content</div>
            </div>
        </div>
    </div>
</div> 
```

每个“项目”都有固定的高度和宽度（即 100 像素）和向左浮动（用于一行显示）。所有项目都由具有“概述”类的 div 包含。“概述”的 CSS

```
#scrollbar1 .overview {
    left: 0;
    list-style: none outside none;
    margin: 0;
    padding: 0;
    position: absolute;
    top: 0;
    width: 300px;
} 
```

我的问题是：当“项目”> 三个或 < 三个以连续显示所有项目时，如何动态更改 div 的宽度？我知道我可以使用插件的更新功能，但我不知道如何实现它。

我正在使用这个 JavaScript

```
$(document).ready(function($) {
    $('#scrollbar1').tinyscrollbar({ axis: 'x'});
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T22:03:08.147

您的 HTML 代码有点不正确，请将其更改为：

```
<div id="scrollbar1">
    <div class="scrollbar"><div class="track"><div class="thumb"><div class="end"></div></div></div></div>
    <div class="viewport">
        <div class="overview">
                    <div class="item">Content</div>
                    <div class="item">Content</div>
                    <div class="item">Content</div>
        </div>
    </div>
</div> 
```

和

```
<div id="scrollbar1">
    <div class="scrollbar"><div class="track"><div class="thumb"><div class="end"></div></div></div></div>
    <div class="viewport">
        <div class="overview">
            <div class="item">Content</div>
            <div class="item">Content</div>
            <div class="item">Content</div>
            <div class="item">Content</div>
            <div class="item">Content</div>
            <div class="item">Content</div>
        </div>
    </div>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T11:14:07.620

一页上有2个滚动条？那么为什么两个小部件具有相同的 id 呢？

# c# - 为什么验证会在部分视图上中断？

> ID：10080333
> 
> 赞同：1
> 
> 时间：2012-04-09T21:50:25.473
> 
> 标签：c#, asp.net-mvc-3, validation, partial-views

此验证应该有效，但如果下拉列表中没有选定的值，则帖子会立即触发。当移动到另一个非部分验证工作得很好。为简洁起见进行了编辑。

视图模型：

```
public class BuilderVM
{
    [Display(Name = "Select A Task")]
    [Required]
    public int? TaskId { get; set; }
    public GenericSelectList Tasks { get; set; }
} 
```

父视图（部分视图在发布后呈现在此页面的底部。您可能已经注意到，ajax 选项规定部分视图将在 div 中呈现`id="MoveOn"`）：

```
@{
 ViewBag.Title = "Builder";
 AjaxOptions ajaxOpts = new AjaxOptions
 {
    LoadingElementDuration = 2,
    LoadingElementId = "removeChoice",
    UpdateTargetId = "MoveOn"
 };
}
<div id="removeChoice">
@using (Ajax.BeginForm("Selected", ajaxOpts))
{
<fieldset>
    <div>
     //Data For Submission (This data validates perfectly before post)
    </div>
    <p><input type="submit" value="Go" /></p>
</fieldset>
}
</div>
<div id="MoveOn"></div> 
```

部分视图（在父视图发布后呈现）：

```
@model namespace.BuilderVM
@{
 AjaxOptions ajaxOpts = new AjaxOptions
  {
    UpdateTargetId = "Entry",
    LoadingElementDuration = 2,
    LoadingElementId = "RemoveEntry"
  };
}

<div id="RemoveEntry">
<h2>Details</h2>
@using (Ajax.BeginForm("Data", ajaxOpts))
{
@Html.ValidationSummary(true)
<fieldset>
<legend>Data</legend>
<div>
    <span class="label">@Html.LabelFor(model => model.TaskId)</span>
    <span class="content">
    @Html.DropDownListFor(
        model => model.TaskId,
        new SelectList(
            Model.Tasks.Values,
            "Id",
            "DisplayFields",
            Model.Tasks.StartValue
        ),
        Model.Tasks.Message
    )
    </span>@Html.ValidationMessageFor(model => model.TaskId)
</div>
<p><input type="submit" value="Add Work Completed Data" /></p>
</fieldset>
}
</div>
<div id="Entry"></div> 
```

虽然 dropdownlistfor 绑定到 model.TaskId ，`[Required]`当点击 post 按钮 ( `input type="submit"`) 并且在下拉列表中没有选择任何值时，该 post 将通过而不是停止并附加验证消息。我不知道该怎么做才能解决这个问题，因为当复制粘贴到常规视图时它工作得很好。为什么部分视图验证不起作用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T21:54:18.323

问题是验证器只是在开头加载（使用 $(document).ready()）。您可以执行以下操作（在局部视图中插入）：

```
 <script>
        $(function() {
            $.validator.unobtrusive.parse('.Content');
        });
    </script> 
```

根据给定的信息，我认为这是您的问题。希望这对您有所帮助。

# java - 如何动态地将我的 TableLayout 和 TableRow 固定到特定位置？

> ID：10080338
> 
> 赞同：0
> 
> 时间：2012-04-09T21:50:52.087
> 
> 标签：java, android, tablelayout, tablerow

我在使用 TableLayout 中的一些 TextView 动态设置 TableRow 时遇到问题。我有两张图片，一张是我目前的情况，另一张是我的模型，预期的情况（我需要实现的目标）。我没有任何 XML 布局；所有这些都是以编程方式创建的，这也是我需要实现的。

显示的快照是针对高分屏幕的，在该屏幕中，我获得了高分玩家的列表，并将它们完全显示在 TableLayout 中。我只是在行/列位置遇到问题。

![没有](../Images/feb87e0ed103455ecc4232a862fe26d7.png)

这是我的代码：

```
public void onResume() {
    super.onResume();

    //=============================================
    TextView number = new TextView(this);
    number.setText("1");
    TextView place = new TextView(this);
    place.setText("4th");
    TextView testScore = new TextView(this);
    testScore.setText("113489");
    table = new TableLayout(this);
    //rows = new Stack<TableRow>();
    TableRow row = new TableRow(this);
    row.addView(number);
    row.addView(place);
    row.addView(testScore);
    table.addView(row);
    this.setContentView(table);
} 
```

如果有人知道我应该如何将我的代码从 Current Situation 更改为 mockup Expected Situation，我将不胜感激。如果我做错了什么，请发表评论。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T22:05:19.010

将每个 textview 的布局权重设置为 1，将布局宽度设置为 0dp。这将导致他们平均分配可用空间。您可以酌情使用布局重力左、中和右，以进一步确保最大分离。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T22:53:54.303

我刚刚找到了一个关于 TableLayout 和 TableRow 的好链接，动态创建特定位置。[链接在这里。](http://wowjava.wordpress.com/2011/04/01/dynamic-tablelayout-in-android/)当然，这里的代码只是它的准系统，用来演示一个简单的位置布局。

这是我的代码和给定的结果图片：

```
public void onResume() {
        super.onResume();

        //=============================================

        dip = (int) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, (float) 1, this.getResources().getDisplayMetrics());
        if (dip <= 0)
            dip = 1;

        TextView number = new TextView(this);
        TextView place = new TextView(this);
        TextView testScore = new TextView(this);

        number.setText("1");
        place.setText("4th");
        testScore.setText("113489");

        number.setWidth(50 * dip);
        place.setWidth(75 * dip);
        testScore.setWidth(150 * dip);

        number.setPadding(20*dip, 0, 0, 0);

        table = new TableLayout(this);
        TableRow row = new TableRow(this);
        row.addView(number);
        row.addView(place);
        row.addView(testScore);
        table.addView(row, new TableLayout.LayoutParams(TableLayout.LayoutParams.WRAP_CONTENT, TableLayout.LayoutParams.WRAP_CONTENT));
        this.setContentView(table);
    } 
```

我真的很惊讶有一种方法可以获取 DIP 单元。应该首先搜索那个。:P

![没有](../Images/e88a0c9cef8f364e7affd44fef30ec82.png)

# c# - 有没有更好的方法来使用 LINQ 分割这个字符串？

> ID：10080341
> 
> 赞同：9
> 
> 时间：2012-04-09T21:51:13.270
> 
> 标签：c#, linq

我有一些经度\纬度坐标聚集在一个字符串中，我想将其分成经度\纬度对。感谢stackoverflow，我已经能够想出一些将其拆分为多维字符串数组的linq。有没有办法将字符串直接拆分为接受经度纬度与字符串数组的对象，然后创建对象？

```
string segment = "51.54398, -0.27585;51.55175, -0.29631;51.56233, -0.30369;51.57035, -0.30856;51.58157, -0.31672;51.59233, -0.3354"

string[][] array = segment.Split(';').Select(s => s.Split(',')).ToArray();
foreach (string[] pair in array)
{
//create object here
} 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-09T21:54:36.173

你很亲密。这样的事情可能会有所帮助：

```
var pairSequence = segment.Split(';')
        .Select(s => s.Split(','))
        .Select(a => new { Lat = double.Parse(a[0]), Long = double.Parse(a[1]) }); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-09T21:55:27.047

假设您有一个`Coordinate`带有`public Coordinate(double x, double y)`构造函数的类，您可以这样做：

```
Coordinate[] result = segment
    .Split(';')
    .Select(s => s.Split(','))
    .Select(a => new Coordinate(x: double.Parse(a[0], NumberStyles.Number),
                                y: double.Parse(a[1], NumberStyles.Number))
    .ToArray(); 
```

或同样

```
var query = from item in segment.Split(';')
            let parts = item.Split(',')
            let x = double.Parse(parts[0], NumberStyles.Number)
            let y = double.Parse(parts[1], NumberStyles.Number)
            select new Coordinate(x, y);

Coordinate[] result = query.ToArray(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-09T22:01:14.187

你可以这样做：

```
public class GeoCoordinates {
  public decimal Latitude { get; set; }
  public decimal Longitude { get; set; }

  public GeoCoordinates( string latLongPair ) {
    decimal lat, lng;
    var parts = latLongPair.Split( new[] { ',' } );
    if( decimal.TryParse( parts[0], out lat ) &&
      decimal.TryParse( parts[1], out lng ) ) {
      Latitude = lat;
      Longitude = lng;
    } else {
      // you could set some kind of "ParseFailed" or "Invalid" property here
    }
  }
} 
```

然后，您可以这样创建 GeoCoordinate 类的集合：

```
var coords = segment.Split( new[] {';'} ).Select( x => new GeoCoordinates( x ) ); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-09T22:04:39.803

这是一个“有点”不错的片段显示：

*   预编译的正则表达式
*   LINQ 到匿名类型投影
*   文化感知（**正确**）数字解析和打印

*您可能希望在现实生活中提取某些代码（例如数字解析）。*

在 Ideone.com上**[现场观看](http://ideone.com/1HCvu)**。

```
using System;
using System.Linq;
using System.Text.RegularExpressions;
using System.Globalization;

namespace SODemo
{
    class MainClass
    {
        private static readonly CultureInfo CInfo = CultureInfo.CreateSpecificCulture("en-US");

        public static void Main (string[] args)
        {
            string segment = "51.54398, -0.27585;51.55175, -0.29631;51.56233, -0.30369;51.57035, -0.30856;51.58157, -0.31672;51.59233, -0.3354";

            var re = new Regex(@"\s*(?<lat>[-+]?[0-9.]+),\s*(?<lon>[-+]?[0-9.]+)\s*;", RegexOptions.Compiled | RegexOptions.CultureInvariant | RegexOptions.IgnoreCase);

            var locations = re.Matches(segment).Cast<Match>().Select(m => new 
            {
                Lat  = decimal.Parse(m.Groups["lat"].Value, CInfo),
                Long = decimal.Parse(m.Groups["lon"].Value, CInfo),
            });

            foreach (var l in locations)
                Console.WriteLine(l);
        }
    }
} 
```

输出：

```
{ Lat = 51,54398, Long = -0,27585 }
{ Lat = 51,55175, Long = -0,29631 }
{ Lat = 51,56233, Long = -0,30369 }
{ Lat = 51,57035, Long = -0,30856 }
{ Lat = 51,58157, Long = -0,31672 } 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-09T21:55:44.033

您是否有必要使用 LINQ？您可以使用标准的字符串拆分功能完成所有操作：

```
string[] pairsOfCoords = segment.Split(';');
List<CoordsObject> listOfCoords = new List<CoordsObject>();
foreach (string str in pairsOfCoords)
{
  string[] coords = str.Split(',');
  CoordsObject obj = new CoordsObject(coords[0], coords[1]);
  listOfCoords.Add(obj);
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-09T22:00:52.950

我可能会再加一点。感谢 dtb 的开始，赞成。如果你打破你的解析函数，你可以更干净地处理错误情况，例如数组中的元素数量错误，或者不能解析为小数的东西。

```
Coordinate[] result = segment
.Split(';')
.Select(s => s.Split(','))
.Select(BuildCoordinate)
.ToArray();

Coordrinate BuildCoordinate(string[] coords)
{
    if(coords.Length != 2)
        return null;

    return new Coordinate(double.Parse(a[0].Trim(), double.Parse(a[1]);
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-07-06T06:06:41.330

有些任务更容易解决旧方法：

```
var split = segment.Split();
var coordinates = new List<Coordinate>(split.Length);
foreach(string s in split)
{
    coordinates.Add(new Coordinate(s));
} 
```

# java - Java ObjectInputStream - EOFException

> ID：10080342
> 
> 赞同：0
> 
> 时间：2012-04-09T21:51:17.763
> 
> 标签：java, object

我正在使用 ObjectInputStream 并试图加载我存储在文件中的 HashMap。但我收到 EOF 异常

```
 java.io.EOFException 
```

这是我的代码....

```
 ObjectInputStream inputStream = null;
  inputStream = new ObjectInputStream(new FileInputStream("C:\\Users\\User1\\workspace\\Resource\\text.txt"));
  HashMap<String,VocabMap> MapObj = (HashMap<String,VocabMap>) inputStream.readObject(); 
```

有人可以告诉我我做错了什么吗？

另外，当我尝试打印时 - System.out.println("Contents: "+ObjectSteam.toString()); 我得到空值。我不确定为什么程序没有读取文件。

谢谢你，

# javascript - 在 Selenium WebDriver 中使用 execute_async_script

> ID：10080347
> 
> 赞同：4
> 
> 时间：2012-04-09T21:51:48.543
> 
> 标签：javascript, python, asynchronous, selenium, webdriver

我想使用 execute_async_script 命令（在 Selenium 远程 webdriver 中）来执行一些带有回调的 JS。

在我当前的 selenium.selenium 模型设置中，我有类似的东西：

```
self.selenium = selenium("localhost", 4444, "*firefox", "http://localhost:8000") 
```

但是如何在 selenium.selenium 旁边使用 WebDriver 实现，以便调用 execute_async_script？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T10:04:57.653

听起来您现在正在使用遥控器设置，是吗？您应该能够从该代码中实例化 WebDriver 实例，但您需要引用 WebDriver dll。您将需要实例化浏览器驱动程序对象的实例（即：FirefoxDriver、InternetExplorerDriver、ChromeDriver 等），然后将您的 IWebDriver“驱动程序”属性设置为等于该实例。然后创建一个名为“js”（或任何您想要的）的接口对象作为 IJavaScriptExecutor 对象并调用非静态方法“ExecuteScript”或“ExecuteAsyncScript”（在您的情况下）。

我下面的代码在 C#.NET 中（假设您使用的是 NUnit）。你必须找到 Python 实现，因为我不知道那种语言。

**类数据成员：**

```
private IWebDriver driver;
private StringBuilder verificationErrors;
private string baseURL; 
```

**代码：**

```
driver = new FirefoxDriver(new FirefoxProfile());
baseURL = "http://???";  // replace "???" with website domain
ISelenium selenium = new WebDriverBackedSelenium(driver, baseURL);
selenium.Start();

IJavaScriptExecutor js = driver as IJavaScriptExecutor;
js.ExecuteScript("$('#id').click();");  // assumes JQuery is used in page
js.ExecuteAsyncScript(...); 
```

# c++ - c++中的动态对象不起作用

> ID：10080350
> 
> 赞同：-1
> 
> 时间：2012-04-09T21:52:02.353
> 
> 标签：c++, class, object, dynamic

```
#include <iostream>
#include <string.h>
#include <stdlib.h>

using namespace std;

class STRING {
    private:
        char *S[10];
    public:
        STRING();
        void set_str(int n, const char* str1);
        char* get_str(int n);
};

STRING :: STRING(){
    for (int i=0; (i < 9); i ++ ){
        S[i] = '\0';
        cout <<  S[i];
    }

}
void STRING :: set_str(int n,const char*str1) {
    S[n] = (char*)malloc(strlen(str1 + 1));
    strcpy(S[n], str1);
    cout << S[n];
}
char* STRING :: get_str(int n){
    return S[n];
}

int main () {

    cout << " Init \n";
    STRING* str = new STRING();
    cout << "Error \n";
return 0; 
```

该程序编译成功，运行，但运行时只在对象**STRING* str = new STRING();初始化之前工作。**. 所以在这种情况下我看不到**错误**消息。有人可以指出我的错误吗？如果有更好的方法来初始化字符串数组，我很高兴知道。

我的目标是初始化 tha 数组。并且最初将整个数组的值设置为 NULL。问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T21:57:05.887

假设 STRING 的意思是“10 个字符串的集合”，那么它就是你的构造函数。您将指针设置为字符 '\0' 的值，而不是空指针。您正在将 char 类型分配给 char* 类型。现在这可能有效，但是你有 cout 声明。它试图 DEREFERENCE 指针。但是指针指向内存 '\0' 中的任何位置，而不是此时的空字符。

编辑：针对 OP 的问题，我认为应该如何初始化 10 个空字符数组。您的构造函数将更改为：

```
STRING :: STRING(){
    for (int i=0; i < 10; i ++ ){ // changed to 10\.  9 would miss the 10th element
        S[i] = new char[1]; // Length-1 char array
        S[i][0] = 0; // or '/0' or whatever
        cout <<  S[i];  // Prints nothing
    }
} 
```

您还需要一个析构函数来释放内存：

STRING::STRING~() { for(int i = 0; i < 10; i++) { delete [] S[i]; }

并将您的“set”方法更改为使用“new”而不是“malloc”。或所有 malloc 和免费的东西。但不要混合它们。并记住使用“数组删除”而不仅仅是删除。

和 FTLOG，转到并收藏[此链接](http://en.cppreference.com/w/cpp)。使用内置的字符串类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T21:54:48.850

成员的正确声明应该是：

```
 char S[10]; 
```

你拥有它的方式

```
 char *S[10]; 
```

声明一个 10 的数组`char *`。因此，当您这样做时`S[i] = '\0';`，您正在初始化`S[i]`，它是指向 a `char`、 to的指针`'\0'`，它可能为 NULL，因此您基本上`cout << NULL`是在下一行调用。

# c++ - 链接一个自注册的抽象工厂

> ID：10080351
> 
> 赞同：9
> 
> 时间：2012-04-09T21:52:10.653
> 
> 标签：c++, g++, cmake, unix-ar

我一直在使用和测试一个基于此处描述的自注册抽象工厂：

[https://stackoverflow.com/a/582456](https://stackoverflow.com/a/582456)

在我所有的测试用例中，它就像一个魅力，并提供了我想要的功能和重用。

使用 cmake 在我的项目中链接这个工厂非常棘手（尽管它似乎更像是一个 ar 问题）。

我有与链接的示例相同的 base.hpp、derivedb.hpp/cpp 和等效的 deriveda.hpp/cpp。主要是，我只是实例化工厂并调用 createInstance() 两次，每次使用“DerivedA”和“DerivedB”。

该行创建的可执行文件：

```
g++ -o testFactory main.cpp derivedb.o deriveda.o 
```

按预期工作。将我的派生类移动到库中（使用 cmake，但我也单独使用 ar 进行了测试）然后链接失败：

```
ar cr libbase.a deriveda.o derivedb.o
g++ -o testFactory libbase.a main.cpp 
```

只调用第一个静态实例化（来自derivedA.cpp），从不调用第二个静态实例化，即

```
// deriveda.cpp (if listed first in the "ar" line, this gets called)
DerivedRegister<DerivedA> DerivedA::reg("DerivedA");

// derivedb.cpp (if listed second in the "ar" line, this does not get called)
DerivedRegister<DerivedB> DerivedB::reg("DerivedB"); 
```

请注意，在 ar 行中交换两者仅调用derivedb.cpp 静态实例化，而不调用deriveda.cpp 实例化。

我是否遗漏了 ar 或静态库的某些内容，而这些库在 C++ 中不能很好地处理静态变量？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-09T22:13:50.187

与直觉相反，在链接命令中包含存档与包含存档中的所有对象文件不同。仅包含存档中解析未定义符号所需的那些目标文件。如果您考虑到一旦没有动态链接，那么这是一件好事，否则所有库（想想 C 库）都会被复制到每个可执行文件中。这是 ld(1) 联机帮助页（Linux 上的 GNU ld）必须说的：

> 链接器只会在命令行中指定的位置搜索存档一次。如果存档定义了在命令行上出现在存档之前的某个对象中未定义的符号，则链接器将包含存档中的适当文件。但是，稍后在命令行中出现的对象中未定义的符号不会导致链接器再次搜索存档。

不幸的是，没有标准的方法可以将档案的每个成员都包含在链接的可执行文件中。在 linux 上可以使用`g++ -Wl,-whole-archive`，在 Mac OS X 上可以使用`g++ -all_load`.

所以使用 GNU binutils ld，链接命令应该是

```
g++ -o testFactory -Wl,-whole-archive libbase.a -Wl,-no-whole-archive main.cpp 
```

确保稍后出现在 g++ 生成的最终链接命令中的`-Wl,-no-whole-archive`任何存档都将以正常方式链接。

# python - 如何根据该地区的人口密度计算地图搜索的动态默认半径？

> ID：10080358
> 
> 赞同：2
> 
> 时间：2012-04-09T21:53:07.853
> 
> 标签：python, search, geometry, geospatial, computational-geometry

我希望为社区转租广告网站执行此操作，但理论上该算法对于任何本地搜索都是相似的。

搜索的区域人口越少，搜索的默认半径就应该越高。另一方面，人口密度高的区域应该具有较低的默认半径，以保持本地相关性。

这可能更像是一个数学问题而不是编程问题，但代码非常受欢迎。到目前为止，我已经计算了每个城镇或村庄 15 英里范围内的转租数量，并将其保存在数据库中作为密度的近似值。当有人搜索城镇或村庄时，我打算使用这个数字来计算搜索的距离。

为了测试任何提议的解决方案，我提取了一些我希望算法得出的近似数字。如果在一个点的 15 英里内有很多转租，比如 30k，我希望搜索的默认半径约为 3 英里。如果只有很少的 1 或 2，默认半径应该高达 25 英里，如果周围没有地方，甚至更多英里。具有约 1k 转租的中程区域的默认半径为 15 英里。这些只是示例，密度会随着数据库中事物的数量而增长或缩小。

```
Population -> Default search radius
0          -> very high (~60 miles or more)
1          -> 25 miles
1k         -> 15 miles
30k        -> 3 miles 
```

我是否朝着正确的方向前进？对于以代码为中心的答案，Python 或 PHP 将是首选。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T23:15:31.483

一个合理的方法是**定义区域，使它们包含相同数量的人**，然后每个区域中的可用公寓数量大致相同。

用数学方式写这个：

```
N = total number of people within a region
d = population density of the region (taken to be what you list as population)
A = Area of region
R = Radius of the region A 
```

所以 ,`N = d*A = d*pi*R*R`并且我们想要`N`保持不变，所以`R = K*sqrt(1/D)`, 哪里`K`是一个常数来匹配你的数字，或者大约 500 英里。然后，

```
30K    ->   2.9  miles
 1K    ->   16   miles
  1    ->   500  miles 
```

所以它适用于前两个，虽然不是人口为 1 的极端情况（但不清楚 1 是否真的是一个需要考虑的重要情况，而不是它自己的特殊情况）。无论如何，我认为这种方法是有一定道理的，并且至少给出了一些值得考虑的地方。

# notepad++ - 如何在 Notepad++ 中格式化文档

> ID：10080359
> 
> 赞同：11
> 
> 时间：2012-04-09T21:53:23.927
> 
> 标签：notepad++

我注意到这个网站上关于 Notepad++ 的其他问题，所以我认为这是合适的地方问。模组，如果这不是正确的地方，请重新定位。

您如何在 Notepad++ 中格式化您的文档？我正在寻找类似于 Visual Studio 的 Edit > Advanced > Format Document

我有一个大的 xml 文档，它都在一行上，我希望它使用正确的缩进/空白进行格式化，并且每行只有一个元素。

编辑：使用没有插件的股票版本 5.9.5。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-09-19T13:36:33.717

`Ctrl`从 NotePad ++ - > `Alt`Plugins- >XML Tools 下载 XML Tools 插件。使用 ++++格式化您的 XML 文档。`Shift``B`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-03-17T03:17:49.680

+1 用于 XML 工具。

您可以从插件管理器下载插件，然后使用“：

1.  插件 > 插件管理器 > 显示插件管理器
2.  选择 XML 工具并安装
3.  插件 > XML 工具 > Pretty Print（仅限 XML - 带换行符）。

这对应于快捷键`Ctrl`++ 。`Alt``Shift``B`

如果这不适用于您的 Notepad++ 版本（该死，您有一个旧的旧版本！），您可以下载该插件并自行安装：

1.  转到[http://sourceforge.net/projects/npp-plugins/files/XML%20Tools/](http://sourceforge.net/projects/npp-plugins/files/XML%20Tools/)
2.  将dll文件放入/plugins
3.  重启记事本++，就是这样

# wcf - WCF 服务 404 错误

> ID：10080360
> 
> 赞同：1
> 
> 时间：2012-04-09T21:53:35.843
> 
> 标签：wcf, http, service, handler

我正在尝试设置 WCF 服务，但遇到了一些问题。该服务在我输入时工作并加载 wsdl 页面

```
www.mydomain.com/Service1.svc 
```

但是，当我使用

```
www.mydomain.com/Service1.svc/ 
```

或尝试使用我得到的任何 get 方法

```
The resource cannot be found.

Description: HTTP 404. 
```

我的 web.config 文件如下

```
<?xml version="1.0"?>
<configuration>

  <system.webServer>
    <handlers>
      <remove name="PageHandlerFactory-ISAPI-4.0"/>
      <add name="PageHandlerFactory-ISAPI-4.0" path="*" verb="GET,HEAD,POST,DEBUG" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness32" responseBufferLimit="0" />
      <remove name="ASP.NET-ISAPI-4.0-Wildcard"/>
      <add name="ASP.NET-ISAPI-4.0-Wildcard"
         path="*" verb="GET,HEAD,POST,DEBUG"
         modules="IsapiModule"
         scriptProcessor="%windir%\Microsoft.NET\Framework\v4.0.30319\aspnet_isapi.dll"
         preCondition="classicMode,runtimeVersionv4.0,bitness32" responseBufferLimit="0" />
      <remove name="svc-Integrated-4.0" />
      <add name="svc-Integrated-4.0" path="*" verb="*" type="System.ServiceModel.Activation.ServiceHttpHandlerFactory, System.ServiceModel.Activation, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" resourceType="Unspecified" requireAccess="Script" preCondition="integratedMode,runtimeVersionv4.0" />
    </handlers>
    <validation validateIntegratedModeConfiguration="false"/>
  </system.webServer>
  <system.web>
    <customErrors mode="Off"/>
    <compilation debug="true" targetFramework="4.0">
    </compilation>
    <httpHandlers>
      <remove verb="*" path="*.svc"/>
      <add path="*.svc" verb="*" type="System.ServiceModel.Activation.HttpHandler, System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" validate="false" />
    </httpHandlers>
  </system.web>
  <system.serviceModel>
    <services>
      <service name="RestService.Service1" behaviorConfiguration="ServiceBehaviour" >
        <endpoint address="" binding="webHttpBinding" contract="RestService.IService1" behaviorConfiguration="web">

        </endpoint>
        <host>
          <baseAddresses>
            <add baseAddress="http://mydomain.com/Service1"/>
          </baseAddresses>
        </host>
      </service>

    </services>

    <behaviors>
      <serviceBehaviors>
        <behavior name="ServiceBehaviour" >
          <serviceMetadata httpGetEnabled="true"/>
        </behavior>
      </serviceBehaviors>
      <endpointBehaviors>
        <behavior name="web">
          <webHttp/>
        </behavior>
      </endpointBehaviors>
    </behaviors>

    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
  </system.serviceModel>
 <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>

</configuration> 
```

Service.svc 文件如下：

```
namespace RestService
{
    public class Service1 : IService1
    {
        public bool LoginUser( string Username, string password )
        {
            return true;
        }
    }
} 
```

IService.cs 如下：

```
namespace RestService
{
    [ServiceContract]
    public interface IService1
    {
        [OperationContract]
        [WebInvoke(Method = "GET",
            ResponseFormat = WebMessageFormat.Json,
            //BodyStyle = WebMessageBodyStyle.Wrapped,
            UriTemplate = "login/{username}/{password}")]
        bool LoginUser(string username, string password);
    }
 } 
```

如果有帮助，服务器上的管道模式是“集成的”。我不确定我的托管服务提供商 (pipeten) 使用什么 IIS 版本，但我认为它是 7.5 我觉得这与 URL 验证有关，但是我的托管服务上没有选项可以更改它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T14:59:25.493

好吧，事实证明这是我犯的一个简单错误，我错过了 . 添加处理程序时。而不是 path = " *" 它应该是 path=".* "

```
<add name="ASP.NET-ISAPI-4.0-Wildcard"
         path=".*" verb="GET,HEAD,POST,DEBUG"
         modules="IsapiModule"
         scriptProcessor="%windir%\Microsoft.NET\Framework\v4.0.30319\aspnet_isapi.dll"
         preCondition="classicMode,runtimeVersionv4.0,bitness32" responseBufferLimit="0" /> 
```

# c# - Listbox in other Listbox, Itemsource, Binding

> ID：10080369
> 
> 赞同：0
> 
> 时间：2012-04-09T21:54:17.793
> 
> 标签：c#, wpf, silverlight, windows-phone-7

我想知道如何刷新我们的 ListBox 项。我尝试了 OnPropertyChanged 方法 ObservableCollection，但它不起作用。我尝试再次设置 itemsource 属性，这样就可以了，但是现在我有 2 个 ListBox，现在它很复杂。这是一个wp7项目，有主界面。你可以看到我有 2 个列表框

```
 <ListBox Name="lsbNameDays" ItemsSource="ComplexNameDays">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel>
                                <TextBlock Text="{Binding NameDay.Name}" FontSize="50"/>
                                <ListBox ItemsSource="ComplexNameDays.FacebookFriends" x:Name="asdf">
                                        <ListBox.ItemTemplate>
                                            <DataTemplate>
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Lastname}"/>
                                                </StackPanel>
                                            </DataTemplate>
                                        </ListBox.ItemTemplate>
                                    </ListBox>
                                </StackPanel>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox> 
```

有属性：

```
 List<SelectedNameDays> complexNameDays;

      public List<SelectedNameDays> ComplexNameDays
            {
                get { return complexNameDays; }
                set 
                { 
                    complexNameDays = value;
                    OnPropertyChanged("ComplexNameDays");
                }

               }

     public class SelectedNameDays : Notifier
        {
            NameDay _nameday;

            public NameDay NameDay
            {
                get { return _nameday; }
                set { _nameday = value; OnPropertyChanged("NameDay"); }
            }

            public List<FacebookFriend> FacebookFriends { get; set; }

            public SelectedNameDays()
            {
                _nameday = new NameDay();
            }
        }

    public class FacebookFriend
        {
            public long Id { get; set; }
            public string Name { get; set; }
            public string Firstname { get; set; }
            public string Lastname { get; set; }
            public string Birthday { get; set; }
            public string Gender { get; set; }
            public Uri Picture { get; set; }
        } 
```

代码的开头是正确的，这是有效的，因为当构造函数设置我设置的数据时重试 lbsNameDays 的 itemsource，但我找不到“asdf”列表框，我无法再次设置它们的数据。

所以两个主要问题是。1.如果改变了属性，我怎么能触发，并且可观察的收集器不起作用。2.如何在datatemplate中使用asdf listbox

谢谢回答，对不起我的语法错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T12:44:33.320

您的 Bindings 不起作用，因为您没有使用正确的语法：

```
 ItemsSource="ComplexNameDays" 
```

应该

```
 ItemsSource="{Binding ComplexNameDays}" 
```

第二个绑定也是错误的：

```
 ItemsSource="ComplexNameDays.FacebookFriends" 
```

# javascript - 在 Rails 表单中使用 jQuery 的 serializeArray

> ID：10080372
> 
> 赞同：1
> 
> 时间：2012-04-09T21:54:34.653
> 
> 标签：javascript, jquery, ruby-on-rails-3, json

我正在尝试在结帐过程的最终屏幕上显示订单摘要（在 Rails 3 中内置）。在此之前没有提交任何内容，所以我使用 jQuery`serializeArray()`从表单字段中获取所有名称和值，效果很好。我收集了各种嵌套属性，因此返回的数组相当繁忙，名称如`order[donations_attributes][0][amount_in_dollars]`.

有没有一种简单的方法，在 Javascript（或使用 jQuery）中将这些名称和值转换为 JSON 字符串（这将使生成我的摘要输出变得更容易）。例如，类似：

```
{
  "order": {
    "donations_attributes": [
      {
        "amount_in_dollars": 50.95,
        "category": "Some Fund"
      },
      {
        "amount_in_dollars": 90.92,
        "category": "Some Other Fund"
      }
    ],
    "billing_address_attributes": {
      "first_name": "Bob",
      "last_name": "Smith",
      "address1": "123 Whatever Street",
      "and so on": "etc"
    }
  }
} 
```

请记住，我还没有提交任何东西（我也不能），所以我不能在 Ruby 中提交。是否有一种明显、直接的方法可以做到这一点，还是我需要手动解析并构建字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T00:20:22.413

您可以按原样将该数据传递给`data`in 的参数`JQuery.ajax(...)`，它最终会出现在`parama`控制器方法和视图中，用于您调用的操作，例如`params[:order][:donations_attributes][0][:category] == "Some Fund"`.

如果您想将新的 url 加载到浏览器中，您可以使用`JQuery.serialize()`数据并将其附加到您的 url（在两者之间使用 `"?" ）以使用适当的查询字符串创建 URL。

# python - 一次迭代多个列表的最佳方法是什么？

> ID：10080379
> 
> 赞同：66
> 
> 时间：2012-04-09T21:55:06.443
> 
> 标签：python

假设我有两个或多个相同长度的列表。什么是遍历它们的好方法？

`a`,`b`是列表​​。

```
 for i, ele in enumerate(a):
    print ele, b[i] 
```

或者

```
for i in range(len(a)):
   print a[i], b[i] 
```

还是我缺少任何变体？

使用其中一个有什么特别的优势吗？

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2012-04-09T21:55:56.903

通常的方法是使用[`zip()`](http://docs.python.org//library/functions.html#zip)：

```
for x, y in zip(a, b):
    # x is from a, y is from b 
```

`a`当两个可迭代对象中较短的一个`b`被耗尽时，这将停止。另外值得注意的是：（[`itertools.izip()`](http://docs.python.org/library/itertools.html#itertools.izip)仅限 Python 2）和[`itertools.izip_longest()`](http://docs.python.org//library/itertools.html#itertools.izip_longest)（`itertools.zip_longest()`在 Python 3 中）。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-04-09T21:57:40.647

您可以使用`zip`：

```
>>> a = [1, 2, 3]
>>> b = ['a', 'b', 'c']
>>> for x, y in zip(a, b):
...   print x, y
... 
1 a
2 b
3 c 
```

# java - JAX-RS/Jersey 异步响应处理

> ID：10080380
> 
> 赞同：2
> 
> 时间：2012-04-09T21:55:23.160
> 
> 标签：java, servlets, asynchronous, jersey, jax-rs

今天在 Jersey API 中是否有一种方法可以将客户端请求与响应分离并异步发送回响应？

我想我正在寻找替代 Jersey 中 HTTPRequest 对象的 startAsync() 方法的方法——虽然我遇到了 Atmosphere 项目，但还没有看到过这种方法——看起来有些有希望，但还有其他选择吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T08:28:14.907

如果您正在寻找客户端异步 API，请查看 Jersey 客户端 API 中的 AsyncWebResource。

如果您的意思是暂停服务器端的请求处理，我们仅在 Jersey 2.0 中添加。

# asp.net - ASP.NET 缓存的位置

> ID：10080385
> 
> 赞同：6
> 
> 时间：2012-04-09T21:55:44.013
> 
> 标签：asp.net, caching, iis-7

在 IIS 7 中如何/在哪里管理 ASP.NET 缓存？我知道它存储在服务器的内存中，但是管理它的进程是什么？它是在 w3wp.exe 的地址空间中，还是在另一个进程/位置？Session 数据是使用缓存，还是 Session 工作方式不同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T22:04:51.223

您可以`web.config`使用[sessionState 元素](http://msdn.microsoft.com/en-us/library/h6bb9cz9%28v=vs.100%29.aspx)配置 Session 数据的存储位置。如果设置为`InProc`，它将存储在`w3wp.exe`与您的应用程序的 App Pool 对应的进程中的内存中。例如，您还可以将其存储在 SQL Server 实例中。

如果该元素未在您的配置文件中定义，请检查`web.config`您的目标框架版本/架构的机器级别。

# c - 循环展开和优化

> ID：10080390
> 
> 赞同：5
> 
> 时间：2012-04-09T21:56:18.040
> 
> 标签：c, optimization

给定代码：

```
for (int i = 0; i < n; ++i) 
{ 
  A(i) ; 
  B(i) ; 
  C(i) ; 
} 
```

和优化版本：

```
for (int i = 0; i < (n - 2); i+=3) 
{ 
  A(i) 
  A(i+1) 
  A(i+2) 
  B(i) 
  B(i+1) 
  B(i+2) 
  C(i) 
  C(i+1) 
  C(i+2)
} 
```

我不清楚：哪个更好？我看不到使用其他版本可以更快地工作的任何东西。我在这里错过了什么吗？

我所看到的是每条指令都取决于前一条指令，这意味着我需要等待前一条指令完成才能启动之后的指令...

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-09T22:02:38.707

在语言的高级视图中，您不会看到优化。速度提升来自编译器对你所拥有的东西所做的事情。

在第一种情况下，它类似于：

```
LOCATION_FLAG;
DO_SOMETHING;
TEST FOR LOOP COMPLETION;//Jumps to LOCATION_FLAG if false 
```

在第二个它是这样的：

```
LOCATION_FLAG;
DO_SOMETHING;
DO_SOMETHING;
DO_SOMETHING;
TEST FOR LOOP COMPLETION;//Jumps to LOCATION_FLAG if false 
```

您可以看到在后一种情况下，测试和跳转的开销仅为每 3 条指令 1 条。在第一种情况下，每 1 条指令有 1 条；所以它发生得更频繁。

因此，如果您有可以依赖的不变量（使用您的示例的 mod 3 数组），那么展开循环会更有效，因为底层程序集是更直接地编写的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-09T22:04:08.520

循环展开用于减少跳转和分支指令的数量，这可能会使循环更快，但会增加二进制文件的大小。根据实施和平台，任何一个都可能更快。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-09T22:01:25.203

好吧，这段代码是“更好”还是“更差”完全取决于`A`、`B`和的实现、您期望`C`的值、`n`您使用的编译器以及运行的硬件。

通常，循环展开的好处是减少了执行循环的开销（即增加`i`并与 比较`n`）。在这种情况下，可以减少 3 倍。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-09T22:07:03.607

只要函数 A()、B() 和 C() 不修改相同的数据集，第二个版本就提供了更多的并行化选项。

在第一个版本中，三个函数可以同时运行，假设没有相互依赖关系。在第二个版本中，所有三个函数都可以同时使用所有三个数据集运行，假设您有足够的执行单元来执行此操作，并且没有相互依赖关系。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-10T07:18:23.767

一般来说，尝试“发明”优化不是一个好主意，除非你有确凿的证据表明你会获得提升，因为很多时候你最终可能会引入降级。通常，获得此类证据的最佳方法是使用良好的分析器。我将使用分析器测试此代码的两个版本以查看差异。

此外，很多时候循环展开不是很容易，如前所述，它很大程度上取决于平台、编译器等。

您还可以使用编译器选项。一个有趣的 gcc 选项是“-floop-optimize”，您可以使用“-O、-O2、-O3 和 -Os”自动获得

**编辑**此外，查看“-funroll-loops”编译器选项。

# maven - 使用 Maven 构建后如何构建 Mahout /usr/lib 资源文件夹

> ID：10080398
> 
> 赞同：1
> 
> 时间：2012-04-09T21:57:24.743
> 
> 标签：maven, build, hadoop, mahout, cloudera

我是这个东西的新手，所以我希望有人能提供帮助；

我想从源代码构建我自己的 Apache Mahout 安装。我有 Maven2.2.1。按照 Mahout wiki 上的说明，我能够查看代码 (Mahout-0.6-SNAPSHOT) 并使用 Maven 构建 Mahout。至少那是我认为在包含已签出的 src 代码的文件夹的根目录中的“mvn install”之后发生的。进行了测试，这需要一段时间。因此，我现在在 ~/.m2/repository 上的 Maven 存储库中拥有所有这些 jar（如果我没记错的话，称为工件）。

所以我现在的第一个问题是；当我在 redhat 上运行 RPM 时，我如何从这里获得一个“已安装”的包。我的意思是 /usr/lib/ 下的一个新文件夹，然后是 /lib 一个 /bin 等文件夹。

第二个问题是关于依赖 jar 的。我可以在存储库中看到 Mahout 是使用 hadoop-core-0.20.204.0.jar 构建的，但这不是我想要的 jar，因为我使用 Cloudera 的另一个 hadoop-core jar 运行 Hadoop 集群。我将如何使用正确的 hadoop-core jar 再次构建 Mahout？或者只是将一个hadoop-core jar换成另一个正在创建的/lib文件夹中的问题（在我的第一个问题得到回答之后）

谢谢

# xcode - XCode 3 用户项目模板在哪里？

> ID：10080402
> 
> 赞同：1
> 
> 时间：2012-04-09T21:58:11.023
> 
> 标签：xcode, xcode3.2

我已经为 XCode 3.2.6 安装了一组项目模板。我可以在磁盘上的什么位置找到模板，它们是我可以编辑的简单脚本吗？例如，我想更改“新建项目”窗口中显示的模板名称；在模板安装期间，我还被要求提供一些配置设置，我想查看/更改这些设置。

Xcode 3 中是否有“模板管理器”，或者我应该直接在某个特殊目录中编辑文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:30:50.397

它们位于`/Library/Application Support/Developer/Shared/Xcode/Project Templates/`. 他们也可能住在另一个地方，但我不记得了。

# ios - CGContextDrawRadialGradient 用于非圆形发光

> ID：10080405
> 
> 赞同：1
> 
> 时间：2012-04-09T21:58:27.883
> 
> 标签：ios, core-graphics

我可以用来`CGContextDrawRadialGradient`制作一个可以进行 alpha 淡入淡出的球体`UIColor.clearColor`并且它可以工作。

但是，我正在尝试做这种事情：

![在此处输入图像描述](../Images/85614f3e2419e71b3fadb7250cdfd5a3.png)

虽然在周围放置一些战略球会产生有趣的效果（类似于战略位置的 LED 背光），但我希望获得真正的光芒。**如何在圆角矩形周围绘制发光`drawRect`？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T22:38:10.153

您可以使用 围绕任何路径创建发光效果`CGContextSetShadowWithColor`，但无法精确控制外观。特别是，默认阴影相当轻：

![默认阴影](../Images/622b296d07e06a6afefe31e9cbb89b07.png)

我知道让它变暗的唯一方法是把它重新画在自己身上：

![在此处输入图像描述](../Images/50e43a19b99c92ce22576955e1f9205c.png)

不是最佳的，但它非常接近您想要的。

这些图像由以下生成`drawRect`：

```
- (void)drawRect:(CGRect)rect
{
    CGContextRef context = UIGraphicsGetCurrentContext();

    CGMutablePathRef path = CGPathCreateMutable();

    int padding = 20;
    CGPathMoveToPoint(path, NULL, padding, padding);
    CGPathAddLineToPoint(path, NULL, rect.size.width - padding, rect.size.height / 2);
    CGPathAddLineToPoint(path, NULL, padding, rect.size.height - padding);

    CGContextSetShadowWithColor(context, CGSizeZero, 20, UIColor.redColor.CGColor);
    CGContextSetFillColorWithColor(context, UIColor.blueColor.CGColor);

    CGContextAddPath(context, path);
    CGContextFillPath(context);
    // CGContextAddPath(context, path);
    // CGContextFillPath(context);

    CGPathRelease(path);
} 
```

要记住的一件事是渲染模糊阴影相当昂贵，这可能是也可能不是问题，具体取决于重绘视图的频率。如果阴影不需要动画，请考虑将它们渲染`UIImage`一次，然后将结果显示在`UIImageView`.

# autocomplete - primefaces (3.2) 自动完成 pojo

> ID：10080412
> 
> 赞同：1
> 
> 时间：2012-04-09T21:59:14.420
> 
> 标签：autocomplete, primefaces, pojo

我正在尝试使用 POJO 实现 PF Autocomplete 组件（v3.2）。当用户从提供的可能下拉选项中选择一个条目时，一切正常。但是，用户在输入字段中输入一些文本并简单地按 Enter 的情况对我来说效果不佳。

如果用户只是在自动完成输入框中输入一些文本并按回车键，我所要做的就是将它们重定向到具有 1 个查询参数的新页面。我注意到，如果我在AutoComplete 有机会显示建议**之前按 Enter 键，那么重定向就会发生得很好。**显示下拉建议后，按 Enter 即可清除输入框。

我希望这样的事情可以正常工作，所以我一定是在做一些愚蠢的事情。

```
<h:form>
    <p:autoComplete id="globalAutoComplete" value="#{autoCompleteBackingBean.selectedResult}" completeMethod="#{autoCompleteBackingBean.globalSearch}" var="aResult" itemValue="#{aResult}" converter="autoCompleteConverter" queryDelay="200" maxResults="6" minQueryLength="3">
        <p:column>
            <a href="#{aResult.url}" style="position: relative; display:block; text-decoration: none;"> #{aResult.label} <br/> #{aResult.desc} <span class='ui-icon #{aResult.icon} autocompleteResultsIcon'/> </a>
        </p:column>
    </p:autoComplete>

    <p:commandButton id="submitAutoComplete" type="submit" icon="ui-icon-suitcase" action="#{autoCompleteBackingBean.doRedirect}"/>    
</h:form> 
```

转换器：

```
public Object getAsObject(FacesContext fc, UIComponent uic, String value) {
    if (value == null || value.length() == 0 ) {
            return null;
        }

        Object obj = null;

        try {
            List<AutoComplete> results = AutoCompleteBackingBean.getResults();

            for (AutoComplete aResult : results){
                if((aResult.getDreRef()).equals(value))
                    return aResult;
            }

        } catch (Exception e) {
            System.err.println("AutoCompleteConverter getAsObject Error: " + e);
        }

        if (obj == null) {
            AutoComplete empty = new AutoComplete();
            empty.setDreRef(value);
            return empty;
        }
        return obj;
}

public String getAsString(FacesContext fc, UIComponent uic, Object object) {
    if (object == null) {
            return null;
        }

        Class entityClass = getEntityClass();
        String value = null;

        if (entityClass.isInstance(object)) {
            try {                    
                value = ((AutoComplete)object).getDreRef();                    
            }catch (Exception e){
                System.err.println("AutoCompleteConverter getAsString Error: " + e);
                value = "Unable to obtain String from Object";
            }
        }
         else {
            value = "AutoCompleteConverter.getAsString(): Object " + object + " is of type "
                + object.getClass().getSimpleName() + "; expected type: "
                + entityClass.getSimpleName();
            throw new ConverterException(new FacesMessage(FacesMessage.SEVERITY_ERROR, value, null));
        }
        return value;            
} 
```

支持豆：

```
 private AutoComplete selectedResult = null;
    //getter and setter

    public String doRedirect() {
        System.out.println("doRedirect()");
        return "entities.jsf?query=" + selectedResult.getDreRef() + "&amp;faces-redirect=true";
    } 
```

# jdbc - Apache Tomcat 5.5 中的 Oracle JDBC Web 服务无法通过 DB 进行身份验证

> ID：10080419
> 
> 赞同：0
> 
> 时间：2012-04-09T22:00:13.387
> 
> 标签：jdbc, oracle11g, ora-01017

我在同一网络上通过 JDBC 访问 Oracle DB 的机器上安装了 java web 服务。该服务运行了几个月，直到今天早上我安装了另一个使用 ODP.NET 访问数据库的应用程序。我试图找出导致我得到的 ORA-01017 异常的原因。这通常意味着登录凭据无效，但登录凭据没有更改。我还验证了服务的 log4j 输出，它确实仍在尝试正确连接到数据库。

我意识到我在这里没有什么可做的，但我正试图弄清楚还有哪些其他依赖项。Web 服务与 ojdbc14.jar 打包在一起，因此这告诉我它针对 java1.4，但可能在以后的 java 版本中可以正常工作。不太确定它是否可以与更高版本的 java 一起使用，但是，直到今天它都可以正常工作。

OJDBC 是否依赖于 tnsnames.ora。如果它取决于服务如何使用 OJDBC，那么我不确定它在做什么。我想我可能删除了 tnsnames.ora，但这有点远。我还尝试管理 Apache Tomcat（在 Win Server 2003 x64 上运行）以针对不同的 java jvm 版本，但无济于事。它最初的目标是默认的 jvm。

是否还有其他我在这里遗漏的依赖项，或者我可以尝试的任何诊断措施？相同的 Web 服务正在同一网络上的另一台机器上运行，我很确定它的配置完全相同。同样，直到今天，它都在两台机器上工作，现在只在一台机器上工作。

Tomcat 以 JDK 7 为目标。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T12:09:07.200

看起来用 ojdbc6_g.jar 替换 ojdbc14.jar 就可以了。不知道为什么只有两台机器中的一台是这种情况。ojdbc6 以 JDK 6 为目标，但 ojdbc14 做到了，而且应该继续工作。如果有人在这里有任何其他见解，请告诉我。

# java - jUnit和Guava，在transform()之后比较列表相等性

> ID：10080421
> 
> 赞同：7
> 
> 时间：2012-04-09T22:00:22.720
> 
> 标签：java, junit, guava

在 jUnit 测试中，我想根据列从数据库中获取一些行`name`。然后我想测试我得到的行是否具有我期望的名称。我有以下内容：

```
Set<MyClass> typesToGet = MyClassFactory.createInstances("furniture",
    "audio equipment");
Collection<String> namesToGet = Collections2.transform(typesToGet,
    new NameFunction<MyClass, String>());
List<MyClass> typesGotten = _svc.getAllByName(typesToGet);
assertThat(typesGotten.size(), is(typesToGet.size()));
Collection<String> namesGotten = Collections2.transform(typesGotten,
    new NameFunction<ItemType, String>());
assertEquals(namesToGet, namesGotten); // fails here 
```

我目前遇到此故障：

> java.lang.AssertionError：预期：com.google.common.collect.Collections2$TransformedCollection<[音频设备，家具]>，但原为：com.google.common.collect.Collections2$TransformedCollection<[音频设备，家具]>

那么，什么是最简洁、最简洁的方法来测试我从数据库中取回的行是否`name`与我说的我想要的名称相匹配？我可以有一个`for`循环遍历并检查一个列表中的每个名称是否存在于另一个列表中，但我希望更简洁。类似以下伪代码的东西会很好：

```
List<MyClass> typesGotten = ...;
["furniture", "audio equipment"].equals(typesGotten.map(type => type.getName())) 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-09T22:09:21.580

您可以使用`containsAll()`两次来检查您没有任何缺失值或任何意外值。

```
assertTrue(namesToGet.containsAll(namesGotten));
assertTrue(namesGotten.containsAll(namesToGet)); 
```

* * *

但是，如果您决定使用`List`or`Set`来代替`Collection`，接口协定指定 a`List`等于另一个`List`（[相同的`Set`](http://docs.oracle.com/javase/7/docs/api/java/util/Set.html#equals%28java.lang.Object%29)）[当且仅当两者包含相同的值](http://docs.oracle.com/javase/7/docs/api/java/util/List.html#equals%28java.lang.Object%29)。

> 比较指定对象与此列表是否相等。`true`当且仅当指定对象也是一个列表时返回，两个列表具有相同的大小，并且两个列表中所有对应的元素对都相等。（如果 ，则两个元素 e1 和 e2 相等`(e1==null ? e2==null : e1.equals(e2))`。）**换句话说，如果两个列表以相同的顺序包含相同的元素，则它们被定义为相等。**此定义确保 equals 方法在`List`接口的不同实现中正常工作。

* * *

**资源：**

*   [Java 文档：`Collection.containsAll()`](http://docs.oracle.com/javase/7/docs/api/java/util/Collection.html#containsAll%28java.util.Collection%29)
*   [Java 文档：`List.equals()`](http://docs.oracle.com/javase/7/docs/api/java/util/List.html#equals%28java.lang.Object%29)
*   [Java 文档：`Set.equals()`](http://docs.oracle.com/javase/7/docs/api/java/util/Collection.html#containsAll%28java.util.Collection%29)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-09T22:23:57.357

如果您希望它们包含相同的元素，但不一定以相同的顺序，那么只需`ImmutableSet`复制它们两者并检查这些集合是否相等。如果您希望它们具有相同的顺序，请`ImmutableList`复制并检查它们是否相等。

`Collection`根本没有任何平等的概念。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-10T18:03:51.687

编写这样一个断言的最简洁和最有表现力的方式是使用 Hamcrest 匹配器：

```
assertThat(namesGotten, containsInAnyOrder(namesToGet)) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-12T13:45:11.080

Guava 有一种方法，我发现它可以很好地传达您想要获得的概念：[symmetricDifference](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Sets.html#symmetricDifference%28java.util.Set,%20java.util.Set%29)。如果 symmetricDifference 为空，则集合相等。

```
assetTrue(Sets.symmetricDifference(namesToGet, namesGotten).isEmpty()); 
```

然而，它可能不是“最便宜的”，因为它执行并集、交集和差分操作。您还可以检查集合的大小是否相同——如果不是，它们不包含相同的元素，如果是，您可以验证（不对称）[差异](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Sets.html#difference%28java.util.Set,%20java.util.Set%29)是否为空。

```
assertEquals(namesToGet.size(), namesGotten.size());
assertTrue(Sets.difference(namesToGet, namesGotten)); 
```

# javascript - 将 JavaScript 变量传递给 ruby -on-rails 控制器

> ID：10080423
> 
> 赞同：7
> 
> 时间：2012-04-09T22:00:26.277
> 
> 标签：javascript, ruby-on-rails, ruby-on-rails-3, json

如何从 JavaScript 侦听器传递变量（id）：

```
Gmaps.map.callback = function() { 
    ...
    ...
    google.maps.event.addListener(marker, 'click', function() {
      var id = this.currentMarker;
      alert(id); 
    });
   }
  } 
```

到 ruby​​-on-rails 控制器中的实例变量 (@foo)

```
def create
  @foo = ???
  ...
end 
```

在视图（表单）中正确创建关系：

```
<%= form_for user.relationships.build(:followed_id => @foo.id) do |f|    %>
<div><%= f.hidden_field :followed_id %></div>
<div class="actions"><%= f.submit "Follow" %></div>
<% end %> 
```

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-10T01:31:50.470

如果我理解正确，一个好方法是使用 AJAX 将 id 提交给您的操作并使用该操作来呈现您的表单。

在您的 javascript 中看起来像这样：

```
jQuery.ajax({
  data: 'id=' + id,
  dataType: 'script',
  type: 'post',
  url: "/controller/action"
}); 
```

你需要一条路线：

```
post 'controller/action/:id' => 'controller#action' 
```

然后在您的操作中，您可以获取该 id 并呈现您的表单，如下所示：

```
def action
  @user = User.relationships.build(:followed_id => params[:id])
  render :viewname, :layout => false
end 
```

然后你可以只为@user 建立一个部分或其他的表单

```
<%= form_for @user do |f| %> 
```

您必须在那里填写详细信息，但这应该会让您非常接近。

# java - Java中的稀疏矩阵乘法

> ID：10080427
> 
> 赞同：2
> 
> 时间：2012-04-09T22:01:03.157
> 
> 标签：java, matrix, multiplication, sparse-matrix

你好我知道有很多关于稀疏矩阵乘法的问题，但很多答案都说只使用库。我想在不使用库函数的情况下做到这一点。到目前为止，我已经完成了简单的部分，将我的矩阵转换为
元素数组
列数组
行数组的形式。

我需要帮助的是逻辑部分。如果矩阵 A 是 M*N，矩阵 B 是 N*P，我该怎么做？我考虑迭代矩阵 A 中的元素并检查它是否为 rowA== colB，如果是，如果 colA==rowB，如果是，则相乘。我目前知道我的版本是错误的，但我想不出一种方法来纠正它。

```
for(int i = 0; i < rows; i++)
{
    sum = 0;    
    for(int k = 0; k < cols; k++)
        if (row_values.get(i) == col_valuesb.get(k))
            if (col_values.get(i) == row_valuesb.get(k))
            {
                sum += (short) (elements.get(i)*elementsb.get(k));
            }
    elementsc.add(sum);
    row_valuesc.add(row_values.get(i));
    col_valuesc.add(col_values.get(k));
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T06:43:55.647

你说：

> “我考虑遍历矩阵 A 中的元素并检查它是否是 rowA== colB，>如果是 colA==rowB”

好吧，因为根据定义，两个矩阵能够相乘当且仅当 colA==rowB，那么你不应该修改

```
if (row_values.get(i) == col_valuesb.get(k)){
            if (col_values.get(i) == row_valuesb.get(k))
            { 
```

就做吧

```
if (row_values.get(i) == col_valuesb.get(k)){ 
```

反而？

# ajax - 在 zurb 基础中，我可以在“显示”弹出窗口中插入一个表格吗？

> ID：10080436
> 
> 赞同：0
> 
> 时间：2012-04-09T22:01:28.727
> 
> 标签：ajax, forms, zurb-foundation

以及如何在弹出窗口和调用弹出窗口的页面之间传输数据？我想在 zurb 基础的弹出窗口“显示”中为用户注册做一个 ajax 表单。你认为可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-12T18:09:22.197

这个答案可能有点晚了，但你绝对可以在显示弹出窗口中输入一个表格。例如，如果您希望在他们单击登录按钮时显示登录对话框：

在 HTML 的底部（在所有行之后），为弹出窗口创建内容：

```
<div id="login-modal" class="reveal-modal" style="width: 400px; background: black; color: white;">
    <h2>Login</h2>
    <form id="login-form" class="six">
        <div class="row">
            <label for="username">Username</label>
            <input type="text" name="username" />
            <label for="password">Password</label>
            <input type="password" name="password" />
        </div>
        <div class="row">
             <div class="right" style="margin-top: 20px;">
                 <button type="reset" class="button radius alert">Reset</button>
                 <button type="submit" class="button radius">Login</button>
             </div>
         </div>
     </form>
     <a class="close-reveal-modal">&#215;</a>
</div> 
```

然后您可以使用他们的一种方法显示它。新的foundation 3.0让你展示它超级简单，比如：

```
<a href="#" 
   data-reveal-id="login-modal" 
   data-animation="fadeAndPop" 
   data-animationspeed="300" 
   data-closeonbackgroundclick="true" 
   data-dismissmodalclass="close-reveal-modal">Login</a> 
```

希望有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T18:40:53.173

在 app.js 中试试这个。然后在任何锚点上使用显示类

```
 $('a.reveal').click(function(event) {
      event.preventDefault();
      var $div = $('<div>').addClass('reveal-modal').appendTo('body'),
        $this = $(this);
        $div.empty().html('<p align="center"><img src="application/public/loading.gif" /></p>').append('<a class="close-reveal-modal">&#215;</a>').reveal();

          $.get($this.attr('href'), function(data) {
            return $div.empty().html(data).append('<a class="close-reveal-modal">&#215;</a>').reveal();
          });
    }); 
```

# wpf - 如果绑定值为 DateTime.MinValue，则不触发 WPF 动画

> ID：10080439
> 
> 赞同：0
> 
> 时间：2012-04-09T22:01:37.800
> 
> 标签：wpf, xaml

我有以下 XAML 代码，它在 LastDataUpdate 字段更改时触发矩形动画。LastDataUpdate 是实现 INotifyPropertyChanged 的​​类中的 DateTime。如果 LastDataUpdate==DateTime.MinValue，我希望动画不运行。有什么方法可以在 XAML 中实现吗？

```
<Rectangle x:Name="NewDataAnimation" Tag="{Binding Path=LastDataUpdate, NotifyOnTargetUpdated=True}" Opacity="0" Width="5" Height="5" Fill="LawnGreen" HorizontalAlignment="Left" VerticalAlignment="Top">
<Rectangle.Style>
  <Style>
    <Style.Triggers>
      <EventTrigger RoutedEvent="Binding.TargetUpdated">
        <EventTrigger.Actions>
          <BeginStoryboard>
            <Storyboard>
              <DoubleAnimation Storyboard.TargetProperty="Opacity" Duration="0:0:0" To="1.0" />
              <DoubleAnimation Storyboard.TargetProperty="Opacity" Duration="0:0:4" From="1.0" To="0.0" BeginTime="0:0:2" />
            </Storyboard>
          </BeginStoryboard>
        </EventTrigger.Actions>
      </EventTrigger>
    </Style.Triggers>
  </Style>
</Rectangle.Style> 
```

安德鲁

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T23:00:05.703

为什么，不触发属性本身并让转换器确定是否执行动画？

下面的 XAML 假设您创建了一个转换器，它将根据您不想要的值评估 LastDataUpdate。如果将 LastDataUpdate 设置为 DateTime.MinValue，动画将不会开始。一旦您进行更改，绑定将被迫通过 PropertyChanged 重新评估，并让转换器进行决策...

```
<Rectangle Opacity="0" Width="5" Height="5" Fill="LawnGreen" HorizontalAlignment="Left" VerticalAlignment="Top">
    <Rectangle.Style>
        <Style>
            <Style.Triggers>
                <Trigger Property="{Binding LastDataUpdate, Converter={StaticResource LastDataUpdateToDoAnimation}}" Value="True" >
                    <Trigger.EnterActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetProperty="Opacity" Duration="0:0:0" To="1.0" />
                                <DoubleAnimation Storyboard.TargetProperty="Opacity" Duration="0:0:4" From="1.0" To="0.0" BeginTime="0:0:2" />
                            </Storyboard>
                        </BeginStoryboard>
                    </Trigger.EnterActions>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Rectangle.Style>
</Rectangle> 
```

# regex - Vim 多行正则表达式给出重叠匹配

> ID：10080444
> 
> 赞同：2
> 
> 时间：2012-04-09T22:01:57.103
> 
> 标签：regex, vim, vi

当我注意到我贪婪的多行正则表达式在 Vim 中给出重叠匹配时，我感到很惊讶。正则表达式旨在匹配整个文本块或连续的非空行。

正则表达式显然匹配了我期望的所有内容（突出显示看起来正确），但是当使用[`n`](http://vimdoc.sourceforge.net/htmldoc/pattern.html#n)跳到下一个匹配而不是跳到下一个块时，它转到了当前块的下一行。

这是我使用的正则表达式（相当于`(.+\n){1,}`大多数正则表达式引擎）：

```
\(.\+\n\)\{1,} 
```

这应该匹配至少一个非空行，以及尽可能多的连续非空行，这是一个示例文本文件：

```
block 1
some stuff
more stuff

block 2
foo bar
baz qux 
```

应用此正则表达式 ( `/\(.\+\n\)\{1,}`+ `Enter`) 后，两个块被正确突出显示，但我希望正则表达式只有两个匹配项，每个块一个。但是，当我按下`n`前进到下一个正则表达式匹配时，似乎每个非空行都与正则表达式匹配，所以我的光标将从第一行开始，`n`将其带到第二行，然后是第三行，然后到块的开头2等

**如何更改我的正则表达式，以便我看到每个块的预期行为是一个匹配，以便`n`前进到下一个块，而不是下一行？**

我也有兴趣知道此行为是否在某个地方的文档中，或者是否有更改此行为的选项。请注意，在搜索/替换中使用相同的正则表达式时，行为是我所期望的（替换只会应用两次，每个块一次）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T22:08:45.290

以下正则表达式似乎有效：

```
\(\%^\|^\n\)\zs\(.\+\n\)\+ 
```

解释：

```
\(             # start of group
  \%^          # beginning of file
    \|         # OR
  ^\n          # a blank line
\)             # end of group
\zs            # start matching here
\(.\+\n\)\+    # at least one non-blank line 
```

通过使用[非常神奇](http://vimdoc.sourceforge.net/htmldoc/pattern.html#/magic)的选项，长度可以减少一点：

```
\v(%^|^\n)\zs(.+\n)+ 
```

期待看看是否有人能提出更短的解决方案！

zigdon 的回答帮助我更好地理解了为什么这种行为是这样的。当`n`用于跳转到下一个匹配时，它从光标的当前位置搜索正则表达式的第一个匹配，即使下一个匹配位置包含在上一个匹配中。这就是为什么将正则表达式锚定到块的开头似乎是必要的。

感谢 Nolen Royalty 帮助我摆脱了第一组中不必要的前瞻。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T22:24:46.373

由于您的匹配项显示“匹配一个或多个非空行”，因此它当然可以在同一段落中匹配多次。要解决此问题，您可以指定将光标放在匹配的*末尾*- 这意味着下一个匹配将从段落的末尾开始。您可以`\zs`使用 vim 中可用的零宽度字符来执行此操作：

```
\zs     Matches at any position, and sets the start of the match there: The
        next char is the first char of the whole match. |/zero-width| 
```

所以你的比赛将变成：

```
\(.\+\n\)\{1,}\zs 
```

# c# - 从另一个项目中读取页面或用户控件上使用的控件

> ID：10080446
> 
> 赞同：1
> 
> 时间：2012-04-09T22:02:02.110
> 
> 标签：c#, reflection, user-controls

我在一个解决方案中有 2 个项目。一个 web 项目和一个表单项目，我希望表单项目列出 web 项目中用户控件 (.ascx) 中使用的 web 控件。

我可以将 .ascx 作为文本文件读取并对其进行解析，但我想知道是否有更好的方法来做到这一点。我可以在表单项目中引用 Web 项目，但我不知道如何读取/循环浏览页面或用户控件的控件，因为它们受到保护。

这可以通过反思来完成吗？还是我应该采取另一种方法？

# javascript - 为什么我的 jQuery 代码无法读取撇号？

> ID：10080449
> 
> 赞同：3
> 
> 时间：2012-04-09T22:02:09.363
> 
> 标签：javascript, jquery, json, html-encode, apostrophe

我有一个 web 表单，当页面加载时，它会根据存储在 MYSQL 数据库中的数据自动检查复选框。除了包含撇号的数据外，一切正常。这是我的代码：

**JSON：**

```
 [{"pkFavorietemerken":"1","merken":"Adidas"},{"pkFavorietemerken":"2","merken":"Boss"},{"pkFavorietemerken":"3","merken":"Burberry"},{"pkFavorietemerken":"4","merken":"Christian Dior"},{"pkFavorietemerken":"5","merken":"D&G"},{"pkFavorietemerken":"6","merken":"Diesel"},{"pkFavorietemerken":"7","merken":"Dolce & Gabanna"},{"pkFavorietemerken":"8","merken":"Emporio Armani"}] 
```

**查询：**

```
 $.getJSON("jason.php", function(data) {

      $.each(data, function(){

     $("[value='" + this.merken + "']").attr("checked","checked");

       });

   }); 
```

**HTML：**

```
 <form name="form1" method="post" action="something.php">                        
    <ul>
        <li><input type="checkbox" name="merk[]" value="Adidas"/>Adidas</li>
        <li><input type="checkbox" name="merk[]" value="Airforce"/>Airforce</li>
        <li><input type="checkbox" name="merk[]" value="Armani"/>Armani</li>
        <li><input type="checkbox" name="merk[]" value="Asics"/>Asics</li>
        <li><input type="checkbox" name="merk[]" value="Bikkemberg"/>Bikkemberg</li>
        <li><input type="checkbox" name="merk[]" value="Bjorn Borg"/>Bjorn Borg</li>
        <li><input type="checkbox" name="merk[]" value="BlueBlood"/>BlueBlood</li>
        <li><input type="checkbox" name="merk[]" value="Boss"/>Boss</li>
        <li><input type="checkbox" name="merk[]" value="Brunotti"/>Brunotti</li>
        <li><input type="checkbox" name="merk[]" value="Burberry"/>Burberry</li>
    </ul> 
```

**这不起作用：**

```
 <li><input type="checkbox" name="merk[]" value="Levi's"/>Levi's</li> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T22:06:01.457

对于`Levi's`，结果选择器最终是`"[value='Levi's']"`。我猜选择器引擎会窒息它。我不确定它是否支持转义（`Levi\'s`）-如果不支持，您可以执行类似的操作

```
var merken = this.merken;
$("input:checkbox").each(function(){
    if(this.value == merken) this.checked = true;
}); 
```

反而。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T22:06:57.757

```
$("[value='" + this.merken + "']").attr("checked","checked"); 
```

时`this.merken = "Levi's"`，代码将解决此问题：

```
$("[value='Levi's']").attr("checked","checked"); 
```

您不能在单引号内使用单引号。一个简单的解决方法应该是更改您的代码以创建双引号，只要您没有名为`Levi"s`:)的选择器

```
$('[value="' + this.merken + '"]').attr("checked","checked"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T22:04:39.020

好吧，您可以通过将您的值用单引号括起来来形成一个选择器。嵌入的单引号将导致它成为无效的选择器字符串。

我*认为*确保嵌入的单引号用反斜杠引用会起作用，但我必须尝试一下。

*编辑*——试试这个：

```
$("[value='" + this.merken.replace(/'/g, "\\'") + "']").attr("checked","checked"); 
```

此外，如果您使用的是比 1.6 更新的 jQuery ，您应该（几乎可以肯定）使用`.prop()`而不是设置“checked”属性：`.attr()`

```
$("[value='" + this.merken.replace(/'/g, "\\'") + "']").prop("checked", true); 
```

（无需将属性设置为字符串“checked”，但如果您愿意，您也可以这样做，因为浏览器无论如何都会将其转换为布尔值。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T22:19:40.577

正确的代码应该是：

```
$('[value="' + this.merken.replace('"','\"') + '"]').attr("checked","checked"); 
```

这接受单引号和双引号。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T22:20:46.610

问题是撇号，你必须逃避它。

这是一个简单的方法

```
function addslashes( str ) {
    return (str+'').replace(/([\\"'])/g, "\\$1").replace(/\0/g, "\\0");
}
$("[value='" + addslashes(this.merken) + "']").attr("checked","checked"); 
```

# android - Android - 检测小型平板电脑与大型手机？

> ID：10080451
> 
> 赞同：6
> 
> 时间：2012-04-09T22:02:17.337
> 
> 标签：android, tablet, screen-size, android-screen-support

我正在开发的应用程序包含两种不同的布局：一种用于普通手机，另一种用于 NOOKcolor 等小型平板电脑。哪个是根据屏幕宽度分辨率（当前为 600dip）做出的决定。它在 Nook 上看起来很棒，但在具有 720 x 1280 显示屏的 HTC Rezound 上看起来很糟糕。在后者上，无论分辨率如何，所有内容（文本、图像等）看起来都要大得多，因此它们都被捆绑在一起。

什么是选择合适设备的好方法？也许检测物理尺寸（4.3" vs 7"）与分辨率？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T22:12:17.197

使用以下方法检测您设备的屏幕尺寸：

```
 /**
     * Checks if the screen size is equal or above given length
     * @param activity activity screen
     * @param screen_size diagonal size of screen, for example 7.0 inches
     * @return True if its equal or above, else false
     */
    public static boolean checkScreenSize(Activity activity, double screen_size)
    {
        Display display = activity.getWindowManager().getDefaultDisplay();
        DisplayMetrics displayMetrics = new DisplayMetrics();
        display.getMetrics(displayMetrics);

        int width = displayMetrics.widthPixels / displayMetrics.densityDpi;
        int height = displayMetrics.heightPixels / displayMetrics.densityDpi;

        double screenDiagonal = Math.sqrt( width * width + height * height );
        return (screenDiagonal >= screen_size );
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T22:11:51.920

查看[支持多个屏幕](http://developer.android.com/guide/practices/screens_support.html)的文档。您可以遵循预先确定的文件夹命名结构，以便 Android 为不同的屏幕尺寸/密度加载不同的布局和可绘制对象。

例如：

```
res/layout/my_layout.xml             // layout for normal screen size ("default")
res/layout-small/my_layout.xml       // layout for small screen size
res/layout-large/my_layout.xml       // layout for large screen size
res/layout-xlarge/my_layout.xml      // layout for extra large screen size
res/layout-xlarge-land/my_layout.xml // layout for extra large in landscape orientation

res/drawable-mdpi/my_icon.png        // bitmap for medium density
res/drawable-hdpi/my_icon.png        // bitmap for high density
res/drawable-xhdpi/my_icon.png       // bitmap for extra high density 
```

# c++ - 在模板上下文中通过引用传递的参数的“const”限定符的位置

> ID：10080453
> 
> 赞同：1
> 
> 时间：2012-04-09T22:02:27.867
> 
> 标签：c++, templates, pointers, reference, constants

考虑以下两个原型：

```
template<class T>
void whatever1(const T& something);

template<class T>
void whatever2(T const& something); 
```

它们都是相同的。然而，如果`T`不是通常的类型，而是指针类型呢？例如， let be `T`then`Somewhere*`会有不同的解释：`whatever1``whatever2`

```
// nonconst pointer (passed by reference) to const object
void whatever1(const Somewhere*& something);

// const pointer (passed by reference) to nonconst object
void whatever2(Somewhere* const& something); 
```

在这种情况下，我可以推断出以下属性：

**1 `whatever1`：**

a) 可以`something`在内部进行修改，并将这些更改传播到外部；

b) 指向的对象`something`不能被修改。

**2 `whatever2`：**

a) 不能`something`在内部进行修改，因此在外部是安全的；

b)`something`可以修改指向的对象。

通常`const`和`&`一起使用，以避免在传递参数时复制，同时保护该参数不被修改。那么就这种哲学而言，它只`whatever2`发挥了它的作用。但是，如果我希望所指向的对象`something`也是不可修改的，那么两个都不适合！那么会是什么呢？也许这个笑话：

```
template<class T>
void whatever3(const T const& something); 
```

除了这种混乱之外，有些人使用`whatever1`风格，而另一些人则使用`whatever2`一种。根据经验，在创建泛型类和方法时应该使用哪一个？

请注意，如果我们开始考虑`Somewhere**`事情`T`变得更加混乱。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T22:06:00.440

当模板被实例化时，用 Somewhere* 替换 T 不是文本的 - 所以在这两种情况下， const 都将应用于指针而不是它指向的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T22:06:47.400

您不能`const`以这种方式将 -qualifier 注入命名类型。举个简单的例子，如果你有：

```
typedef int* P;
const P x; 
```

然后`x`是类型`int* const`，不是`const int*`。`const`应用于整个类型`P`，而不仅仅是类型的一部分`P`。这同样适用于模板类型参数。

如果你想`const`在类型中注入一个限定符，你可以毫不费力地做到这一点，例如通过使用像`remove_pointer`and之类的类型特征`add_const`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-09T22:08:39.753

你的假设是错误的。When `T = U *`, then`T const &`和`const T &`are both `U * const &`，仅此而已。类似地，`const T`and`T const`都是`U * const`，而当`T = const W`，then`T *`是`W const *`or `const W *`。（当然，这都受引用折叠规则的约束，因此假设既不是引用类型`U`也不`W`是引用类型）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T22:08:29.193

> 它们都是相同的。然而，如果`T`不是通常的类型，而是指针类型呢？例如， let be `T`then`Somewhere*`会有不同的解释：`whatever1``whatever2`
> 
> ```
> // nonconst pointer (passed by reference) to const object
> void whatever1(const Somewhere*& something);
> 
> // const pointer (passed by reference) to nonconst object
> void whatever2(Somewhere* const& something); 
> ```

不，实际上它不会`void whatever1(const Somewhere*& something);`，它会`void whatever1(const (Somewhere*)& something);`在无效的类 C++ 代码中。编写它的 C++ 方式是你的`whatever2`，但它们的意思是一样的。

# javascript - JQuery show hide with unordered list：需要添加动态文本/隐藏功能

> ID：10080456
> 
> 赞同：3
> 
> 时间：2012-04-09T22:03:00.237
> 
> 标签：javascript, jquery, toggle

我有一个无序列表，如果超过 3 个，我会在其中隐藏任何其他列表项。之后，我调用一个 JQuery 函数，该函数在底部放置一个“显示更多”链接并切换要显示的任何其他列表项。

但是，我有点卡住了，一旦所有列表项都显示并单击它，我想将显示链接转换为“隐藏”，然后隐藏其他列表项，然后链接变回“显示更多.. 。“ 再次。

这是我到目前为止的代码，可用于扩展和显示其他列表项。

```
 $('ul li:gt('+index+')').hide();
    $('ul').append('<li class="more"><a href="#">Show more...</a></li>');
    $('ul li.more a').click(function() {
    $('ul li.more a').remove();
    $('ul li:gt('+index+')').show();
    }); 
```

注意我并没有停留在这段代码上，如果有更好的方法来实现整个显示/隐藏代码，那很好。

我用到目前为止的代码写了一个[小提琴。](http://jsfiddle.net/TQXQD/4/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T22:17:03.453

先生，您去吧:) 已修复且运行良好！

[http://jsfiddle.net/TQXQD/7/](http://jsfiddle.net/TQXQD/7/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T22:17:51.547

这里 jquery`toggle()`函数派上用场 - 您可以附加到将在每隔一次单击元素时调用的事件处理程序。用于`text()`更改链接的文本（如果您不计划回退，则不应该是链接 - 改用 span）

更新[了小提琴](http://jsfiddle.net/TQXQD/6/)。

# yesod - 尝试使用 hamlet 在 yesod 中发送电子邮件

> ID：10080459
> 
> 赞同：3
> 
> 时间：2012-04-09T22:03:09.753
> 
> 标签：yesod, hamlet

我正在 Yesod (0.10) 建立一个调查站点，并且迷失在类型中。这是我正在尝试做的简化版本。

```
invitation url = do
   render <- getUrlRender
   return $ renderHtml [hamlet|
<p>Dear foo, please take our 
   <a href=@{ShowSurveyR url}>survey.
|] render 
```

另一个函数将调用它，希望得到一些可以从 Network.Mail.Mime 传递给 simpleMail 的东西。上面的函数给出了一个类型错误：

```
Handler/Root.hs:404:13:
    The function `renderHtml' is applied to two arguments,
    but its type `Html -> LT.Text' has only one 
```

这很令人困惑，因为模板教程似乎是这样做的。但是如果我修改代码，像这样......

```
invitation url = do
   return $ renderHtml [hamlet|
<p>Dear foo, please take our
   <a href=@{ShowSurveyR url}>survey.
|] 
```

我收到这种类型的错误。

```
Handler/Root.hs:403:24:
    The lambda expression `\ _render[a4TO] -> ...' has one argument,
    but its type `Html' has none
    In the first argument of `renderHtml', namely 
```

我认为 renderHtml 是错误的函数，但我找不到正确的函数。有谁知道我错过了什么？我应该如何将路由功能传递到我的 hamlet 代码中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T01:27:12.073

为了让下一个搜索它的人更容易......

有两个问题。第一个答案指出了一个；hamlet quasiquoter 本身具有一个功能。另一个问题是我需要使用函数 getUrlRenderParams，而不是 getUrlRender。最终代码是

```
invitation :: Text -> Handler LT.Text
invitation url = do
   render <- getUrlRenderParams
   return $ renderHtml $ [hamlet|
<p>Dear foo, please take our
   <a href=@{ShowSurveyR url}>survey.
|] render 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-10T00:15:21.897

quasiquote ( `[hamlet|...|]`) 返回一个函数，其参数*也是*一个函数。您必须首先应用该 quasiquote 值，并将结果传递给 renderHtml：

[编辑：正如@MattoxBeckman 发现的那样，另一个问题是需要使用 getUrlRenderParams 而不是 gutUrlRender。]

```
invitation url = do
  render <- getUrlRenderParams
  return $ renderHtml $ [hamlet|
<p>Dear foo, please take our 
<a href=@{ShowSurveyR url}>survey.
|] render 
```

（注意附加`$`）。

PS renderHtml 是 type `Html -> Text`，而 quasiquote 的结果`[hamlet|..|]`, 是 type `Render url -> Html`。您看到的第一条错误消息指出您尝试将两个参数传递给 renderHtml，而第二条错误消息指出您没有将任何参数传递给 quasiquote 值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-07T08:07:30.280

只需替换`shamlet`而不是`hamlet`; 它根本不需要`render`争论。

（正如 joelteon 在#yesod 向我指出的那样。）

# php - 使用单选按钮检查更新多行

> ID：10080463
> 
> 赞同：0
> 
> 时间：2012-04-09T22:04:03.280
> 
> 标签：php, jquery-mobile

我正在获取每条记录的单个 tsid 的值，但是数组中未返回选中的单选按钮值，我只得到 0？任何帮助表示赞赏。

PHP：

```
// Set the timesheets to set status approved/rejected
// find out how many records there are to update
$size = count($_POST['tsid']);

// start a loop in order to update each record
$i = 0;
while ($i < $size) {
// define each variable
$tsid = intval($_POST['tsid'][$i]);
$personnelid = intval($_POST['personnel'][$i]);
print "TSID: " . $tsid . "<br>";
print "TSuser: " . $personnelid . "<br>";
if ($tsid > 0 && $personnelid > 0) {
// do the update and print out some info just to provide some visual feedback
$query = "Update timesheets set status='1' where id= '$tsid' LIMIT 1";
mysql_query($query) or die ("Error in query: $query");
}
++$i;
}
mysql_close(); 
```

HTML：

```
<input type="hidden" name="tsid[]" value="<?PHP echo $row['id']; ?>">
<li data-role="fieldcontain">
    <a href="tsapprove.php?id=<?PHP echo $row['id']; ?>"><p><?PHP echo $row['personnel']; ?></p>
    <p><?PHP echo $row['name']; ?></p>
    <p class="ui-li-aside"><strong><?PHP echo $row['totalhrs']; ?> H</strong></p>
<fieldset data-role="controlgroup" data-type="horizontal">
    <input type="radio" name="personnel[]" id="1" value="<?PHP echo $row['personnel']; ?>"  />
      <label for="1">Approve</label>
      <input type="radio" name="personnel[]" id="2" value="<?PHP echo $row['personnel']; ?>"  />
      <label for="2">Reject</label>
    </fieldset>
</a>
<a href="tsapprove.php?id=<?PHP echo $row['id']; ?>">View Details</a>
</li> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T22:35:38.450

希望你能把它拼凑起来：

```
<?

$size = count($_POST['tsid']);

echo "<pre>";print_r($_POST);echo "</pre>";

$i = 0;
while ($i < $size) {
  $tsid = $_POST['tsid'][$i];
  $pid = $_POST['personnel_'.$i];

  print "TSID: " . $tsid . "<br />";
  print "TSuser: " . $pid . "<br />";

  $i++;
}

?>
<form method="post">
<!--tsid[0] - $i = 0-->
<input type="hidden" name="tsid[]" value="1" />
<input type="radio" name="personnel_0" value="111" />
<input type="radio" name="personnel_0" value="222" />

<!--tsid[1] - $i = 1-->
<input type="hidden" name="tsid[]" value="2" />
<input type="radio" name="personnel_1" value="333" />
<input type="radio" name="personnel_1" value="444" />
<input type="submit" />
</form> 
```

基本上，您返回人员的方式并没有真正起作用。所以我稍微简化了一点，基本上为人员设置了不同的收音机。它使用 TSID 值设置实际名称，而不是数组。

我对 1 和 2 进行了硬编码，但您可以用 $row['id'] 替换，“personnel_”之后的数字也会是 0..1..2 等

希望这会有所帮助

编辑：代码的一些问题

# xml - etl.xml 中的 Scriptella 和 &

> ID：10080465
> 
> 赞同：1
> 
> 时间：2012-04-09T22:04:17.493
> 
> 标签：xml, dtd, scriptella

我在值中使用 & 符号`<query>`，所以我将它编码为`&amp;`但得到

```
5/04/2012 10:07:03 AM <WARNING> XML configuration warning in file:.../etl.xml(26:169): The entity "AMP" was referenced, but not declared. 
```

解决方案可能是创建自己的 DTD 并在那里定义实体。但问题是我使用了 scriptella 的 DTD：

```
<!DOCTYPE etl SYSTEM "http://scriptella.javaforge.com/dtd/etl.dtd"> 
```

除了在本地下载、添加实体和主机之外的任何解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:10:42.967

尝试使用`&#38;`而不是`&amp;`.

或者，您应该能够将 amp 的声明添加到内部子集：

```
<!DOCTYPE etl SYSTEM "http://scriptella.javaforge.com/dtd/etl.dtd" [
<!ENTITY amp "&#38;">
]> 
```

# facebook - facebook - 添加“用户正在使用 myapp”

> ID：10080466
> 
> 赞同：1
> 
> 时间：2012-04-09T22:04:20.970
> 
> 标签：facebook

有什么办法可以在用户的​​墙上添加类似文本“（用户名）开始使用我的应用程序。”？或者当用户允许对 myapp 的权限时，它是否会在用户的墙上自动显示 facebook？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:17:30.500

当使用具有非测试用户帐户的非沙盒应用程序时，它应该自动发布到活动侧边栏。

# sql - 我可以旋转整个查询以返回不同的结果吗？

> ID：10080467
> 
> 赞同：0
> 
> 时间：2012-04-09T22:04:22.563
> 
> 标签：sql, sql-server, tsql

这个查询返回的正是我需要的，但我也试图从中创建一个数据透视表。我希望能够对 CASE 子句中定义为 SLAStatus 的列进行求和（不知道这是否可能）以及计算 OrderID 列以及计算（SLAStatus 列的总和）/（OrderID 列的计数）返回具有 SLA 的订单的百分比。一直在网上到处找，但似乎无法弄清楚

```
SELECT oi.OrderID, o.Address1 as StreetAddress, c.Name as County, o.State,                         p.Abbreviation, oi.OrderDate as Dateentered, 
DATEADD(dd, DATEDIFF(dd, 0, oi.DeliveredDate), 0) as DateCompleted, DATEADD(dd,                  DATEDIFF(dd, 0, oi.RequiredByDate), 0) as EstimatedDeliveryDate, 

     CASE
WHEN oi.DeliveredDate <= oi.RequiredByDate THEN '1'
ELSE '0'
END AS SLAStatus,

cl.Name as Client, clb.Name as Client2,  v.ContactFirstName + ' ' + v.ContactLastName      as Appraiser

FROM OrderItems oi
JOIN Orders o on o.OrderID = oi.OrderID
JOIN Counties c on c.FIPS = o.FIPS
JOIN Products p on p.ProductID = oi.ProductID
JOIN Clients cl on cl.ClientID = o.ClientID
JOIN ClientBranches clb on clb.ClientID = cl.ClientID
JOIN Vendors v on v.VendorID = oi.VendorID
JOIN Milestones m on m.MilestoneID = oi.LastMilestoneID

WHERE cl.Name not like '%TEST%'
and '2012-03-01' <=
        (select MAX(MilestoneDate)
            from OrderItemMilestones
            where OrderID = oi.OrderID
                and OrderItemID = oi.OrderItemID
                and MilestoneID in (100,130,140,150))

and '2012-04-10' >=
        (select MAX(MilestoneDate)
            from OrderItemMilestones
            where OrderID = oi.OrderID
                and OrderItemID = oi.OrderItemID
                and MilestoneID in (100,130,140,150)) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T00:55:53.923

我建议使用公用表表达式 (CTE)。只需将您的原始查询包装在 CTE 中，然后您就可以进行您正在寻找的分组。

```
with originalCTE as
(
    SELECT oi.OrderID, o.Address1 as StreetAddress, c.Name as County, o.State,    
                         p.Abbreviation, oi.OrderDate as Dateentered, 
    DATEADD(dd, DATEDIFF(dd, 0, oi.DeliveredDate), 0) as DateCompleted, DATEADD(dd, 
                     DATEDIFF(dd, 0, oi.RequiredByDate), 0) as EstimatedDeliveryDate, 

         CASE
    WHEN oi.DeliveredDate <= oi.RequiredByDate THEN '1'
    ELSE '0'
    END AS SLAStatus,

    cl.Name as Client, clb.Name as Client2,  v.ContactFirstName + ' ' + v.ContactLastName      as Appraiser

    FROM OrderItems oi
    JOIN Orders o on o.OrderID = oi.OrderID
    JOIN Counties c on c.FIPS = o.FIPS
    JOIN Products p on p.ProductID = oi.ProductID
    JOIN Clients cl on cl.ClientID = o.ClientID
    JOIN ClientBranches clb on clb.ClientID = cl.ClientID
    JOIN Vendors v on v.VendorID = oi.VendorID
    JOIN Milestones m on m.MilestoneID = oi.LastMilestoneID

    WHERE cl.Name not like '%TEST%'
    and '2012-03-01' <=
            (select MAX(MilestoneDate)
                from OrderItemMilestones
                where OrderID = oi.OrderID
                    and OrderItemID = oi.OrderItemID
                    and MilestoneID in (100,130,140,150))

    and '2012-04-10' >=
            (select MAX(MilestoneDate)
                from OrderItemMilestones
                where OrderID = oi.OrderID
                    and OrderItemID = oi.OrderItemID
                    and MilestoneID in (100,130,140,150))

)
select sum(SLAStatus), sum(SLAStatus) / count(orderID)
from originalCTE; 
```

如果我正确理解您在寻找什么，那么我就是这样做的。希望这可以帮助。

# objective-c - 试图解决 [DetailViewController setDataController:]: unrecognized selector sent to instance

> ID：10080475
> 
> 赞同：0
> 
> 时间：2012-04-09T22:04:52.940
> 
> 标签：objective-c, storyboard, runtime-error

我有一个 Xcode Universal Storyboard 项目，它可以正确显示 iPhone 的数据，但不显示 iPad 的数据。我已经使用下面的代码初始化了数据数组。

它在 iPhone 中正常工作，但在 iPad 中不显示数据并出现错误：

> -[DetailViewController setDataController:]：无法识别的选择器发送到实例

这是 AppDelegate.m

```
 if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPad) {
     UISplitViewController *splitViewController = (UISplitViewController *)self.window.rootViewController;
     UINavigationController *navigationController = [splitViewController.viewControllers lastObject];

     MasterViewController *masterViewController = (MasterViewController *)[navigationController topViewController];
      DataController *controller = [[DataController alloc] init];
      masterViewController.dataController = controller;

 splitViewController.delegate = (id)navigationController.topViewController;
 } else {
      // Create the data controller and pass it to the master view controller.
      UINavigationController *navigationController = (UINavigationController  *)self.window.rootViewController;
      MasterViewController *masterViewController = (MasterViewController *)            [navigationController topViewController];
      DataController *controller = [[DataController alloc] init];
      masterViewController.dataController = controller;
 } 
```

**编译器在这里抱怨 DetailViewController 就是那个文件。**

```
 #import "DetailViewController.h"
 #import "Play.h"

@interface DetailViewController ()
@property (strong, nonatomic) UIPopoverController *masterPopoverController;
@end

@implementation DetailViewController
@synthesize masterPopoverController = _masterPopoverController;
@synthesize play;

#pragma mark -
#pragma mark View lifecycle

  - (void)viewWillAppear:(BOOL)animated
 {
  [super viewWillAppear:animated];
// Scroll the table view to the top before it appears
  [self.tableView reloadData];
  [self.tableView setContentOffset:CGPointZero animated:YES];
//self.part = play.part;

  }

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
} else {
    return YES;
}
}

#pragma mark - Split view

- (void)splitViewController:(UISplitViewController *)splitController willHideViewController:(UITableViewController *)viewController withBarButtonItem:(UIBarButtonItem *)barButtonItem forPopoverController:(UIPopoverController *)popoverController
{
barButtonItem.title = NSLocalizedString(@"Trading Rules That Work", @"Trading Rules That Work");
[self.navigationItem setLeftBarButtonItem:barButtonItem animated:YES];
self.masterPopoverController = popoverController;
}

- (void)splitViewController:(UISplitViewController *)splitController willShowViewController:(UITableViewController *)viewController invalidatingBarButtonItem:(UIBarButtonItem *)barButtonItem
 {
 // Called when the view is shown again in the split view, invalidating the button and popover controller.
 [self.navigationItem setLeftBarButtonItem:nil animated:YES];
 self.masterPopoverController = nil;
 }

 #pragma mark -
 #pragma mark Table view data source

 - (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
// There are 2 sections, for rule, and media, in that order.
return 2;
 }

 - (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {

//The number of rows varies by section.

NSInteger rows = 0;
switch (section) {
    case 0:
        // For part and date there is just one row.
        rows = 1;
        break;
    case 1:
        // For the media section, there are as many rows as there are media.
        rows = [play.media count];
        break;
    default:
        break;
 }
 return rows;
 }

 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

static NSString *CellIdentifier = @"CellIdentifier";

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    cell.autoresizingMask = UIViewAutoresizingFlexibleHeight;
    cell.selectionStyle = UITableViewCellSelectionStyleNone;
    cell.textLabel.font = [UIFont boldSystemFontOfSize:11];
    cell.textLabel.numberOfLines = 13;

}

NSString *cellText = nil;

switch (indexPath.section) {
    case 0:
        cellText = play.part;
        break;
    case 1:
        cellText = [play.media objectAtIndex:indexPath.row];
        break;
    default:
        break;
}

cell.textLabel.text = cellText;
return cell;
}

 #pragma mark -
 #pragma mark Section header titles

 /*
  HIG note: In this case, since the content of each section is obvious, there's probably       no need to provide a title, but the code is useful for illustration.
  */
 - (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section {

NSString *title = nil;
switch (section) {
    case 0:
        title = NSLocalizedString(@"Video Description", @"Part section title");
        break;
    case 1:
        title = NSLocalizedString(@"Media", @"Main Media section title");
        break;
    default:
        break;
}
return title;
}

 @end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:26:41.447

当你这样做

```
object.property = value; 
```

在 Objective-C 代码中，这是一个捷径：

```
[object setProperty:value]; 
```

由于您似乎没有 dataController 属性，因此没有 setDataController 选择器。

所以要么：

*   在 DetailViewController 的 .h 中声明一个 dataController 属性，然后在您的实现中合成它，或者
*   创建一个 setter 并手动将其分配给实例变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T22:28:02.737

您收到此错误是因为在您的 iPad 故事板中，您没有为导航控制器的 rootViewController 正确设置类。确保该 viewController 的类`DataController`在 Identity Inspector 中设置为。您可能在 iPhone 版本的故事板中正确设置了此设置，这就是为什么您在运行 iPhone 版本时不会收到错误消息。

# jakarta-ee - 基于 Web 的 Java 工作流的工具/API/框架

> ID：10080476
> 
> 赞同：0
> 
> 时间：2012-04-09T22:05:01.440
> 
> 标签：jakarta-ee, websphere, soa, business-process-management

我正在开发一个需要基于 Web 的工作流应用程序的项目。我们现在正在评估该项目的软件堆栈，我的大多数同事都同意使用 IBM SOA-BPM 产品作为基础软件（包括 Process Server 和 Websphere Business Modeler）。客户拥有几乎所有工具的许可证，因此这种方法很有意义。

但是，我很好奇这种应用程序是否还有其他软件堆栈。在一个快速的谷歌搜索中，我发现了这个：

*   [Spring Workflow](http://www.springsource.org/extensions/se-workflow)，听起来不错，但它处于孵化阶段
*   [使用像Imixs](http://www.imixs.org/)这样的开源工作流引擎，但是已经拥有 Process Server 没有任何意义
*   [本文](http://www.javaworld.com/javaworld/jw-04-2005/jw-0411-spring.html?page=1)提出了一个纯基于 Spring-Beans 的解决方案，但感觉有点像重新发明轮子

有什么建议，还是我应该选择完整的 IBM 解决方案？

**编辑：**

另一个问题，BPM 是工作流应用程序的唯一方式，还是有其他可能性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:12:48.347

[Activiti](http://www.activiti.org/)是一个我们已经使用了一段时间的嵌入式工作流引擎。它有一个非常好的活跃社区和一本非常好的书《Activiti in Action》。它重量轻，基于 BPMN 开放标准。检查我之前的问题[选择哪个工作流引擎？](https://stackoverflow.com/questions/4940173/which-workflow-engine-to-choose)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T10:07:56.410

将 BPM 与工作流混合时要小心。 [Imixs Workflow](http://www.imixs.org)是一个基于 java 的工作流框架，用于构建业务应用程序。与 IBM SOA-BPM 或 Activiti 不同，该框架的重点是支持用户处理应用程序提供的任务。

这意味着 Imixs Workflow 允许您管理基于人的工作流任务。例如，您可以将流程实例保护给不同的参与者。您可以定义电子邮件通知。或者，您可以设计一个工作流历史记录，显示用户迄今为止在特定流程实例中所做的事情。工作流引擎通知参与者有关新任务并为他们提供任务列表。Imixs Workflow 帮助用户在业务应用程序中完成他们的任务。

当您的项目专注于基于人的工作流时，Imixs 工作流框架很有用。它不是一个自动化业务流程的框架。

# bash - 如何使用其他用户的显示器

> ID：10080484
> 
> 赞同：4
> 
> 时间：2012-04-09T22:06:06.020
> 
> 标签：bash, ssh

我在以 root 身份登录的 SSH 连接中使用 xdotool，我正在设置登录用户所说的`DISPLAY=":0.0"`内容。`echo $DISPLAY`但除非我`su`对其他用户，否则我会收到错误：

```
root@sb:~# export DISPLAY=":0.0"
root@sb:~# xdotool getactivewindow
No protocol specified
No protocol specified
Error: Can't open display: (null)
Segmentation fault (core dumped) 
```

* * *

```
geerm@sb:~$ export DISPLAY=":0.0"
geerm@sb:~$ xdotool getactivewindow
41943046 
```

这甚至可能吗？如果是这样，我需要更改什么才能使用登录用户的会话？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T22:17:44.817

默认情况下，大多数 X 服务器不允许其他用户在彼此的屏幕上显示。如果您想禁用此保护，您可以使用[xhost](http://www.xfree86.org/current/xhost.1.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T03:22:11.477

尝试：

```
export DISPLAY=his_xserver_ip:0.0 
```

并且可能您需要通过 xhost +ip_to_connnect_from 将允许连接到他的 xserver 的 IP 添加到他的 xhosts

[http://www.xfree86.org/current/X.7.html](http://www.xfree86.org/current/X.7.html)

# ruby-on-rails - Rails3 Cocoon 验证嵌套字段计数

> ID：10080488
> 
> 赞同：1
> 
> 时间：2012-04-09T22:06:22.250
> 
> 标签：ruby-on-rails, ruby-on-rails-3, cocoon-gem

我在验证 cocoon 和模型允许的字段数时遇到问题。使用 cocoon、rails3，我有一个嵌套表单，我的位置有很多链接。

我需要将每个位置的链接数限制为 5。

在我的 location.rb 模型中，我有这个：

```
 class Location < ActiveRecord::Base

   has_many :links
   accepts_nested_attributes_for :links, :reject_if => lambda { |a| a[:link_name].blank? }, :allow_destroy => true   
   validate :check_link_count

   ...

   def check_link_count
      if self.links.count > 5
        self.errors.add :base, "No more than 5 links allowed."
      end
   end

   ... 
```

最多添加5个链接，一切正常。

如果我添加 6 个链接并保存，我会收到错误消息。也很好。

问题是当我尝试删除链接时 - 似乎链接仅在保存后才被删除（我认为）。如果我因此删除所有字段，我仍然会收到错误消息。

有什么建议么？有没有其他方法可以验证？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T22:23:25.937

嗯。你可以试试这样的

```
 def check_link_count
    if self.links.reject(&:marked_for_destruction?).count > 5
      self.errors.add :base, "No more than 5 links allowed."
    end
 end 
```

# java - Tree 类应该包含什么？

> ID：10080490
> 
> 赞同：1
> 
> 时间：2012-04-09T22:06:35.037
> 
> 标签：java, binary-tree

我的班级目前正在将二叉树作为我们数据结构单元的一部分。我知道 Node 类的构造函数中必须有 3 个参数（值、左节点、右节点）。作为要求的一部分，我们必须有一个 Tree 类。树类的目的是什么？是为了管理整个节点集吗？它是否仅包含插入、删除和搜索特定节点所需的功能？

先感谢您。

我的节点类：

```
class Node {
protected int data;
protected leftNode;
protected rightNode;

Node (int data, Node leftNode, Node rightNode){
this.data = data;
this.leftNode = leftNode;
this.rightNode = rightNode;
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T22:11:00.640

是的，它应该通过[*封装*](http://en.wikipedia.org/wiki/Information_hiding)所有与内部结构相关的行为和算法来给出Tree的功能接口。

**为什么这很好？** 因为您将定义一些仅提供一些功能并且以独立方式工作的东西，这样每个人都应该能够使用您的树类，而无需关心节点、算法等。

理想情况下，该类应该是参数化的，这样您就可以拥有`Tree<T>`并且可以拥有通用方法，例如

```
T getRoot() 
```

基本上你必须投影它，这样它才能让你

*   插入值
*   删除值
*   搜索值
*   参观整棵树
*   任何

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T22:12:48.550

正如我所看到的，一个`Tree`类应该包含对树的根节点的引用，以及对整个树上操作的方法和属性的引用，而不是属于每个节点的方法，例如`getLeft()`, `getValue()`。

例如，我会`size`在类中定义一个属性，`Tree`向树添加或删除节点的方法（也恰好在这个类中）将负责保持大小是最新的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T22:10:50.843

任何数据结构的目的都是为您提供一种方法来保存相关值的集合并以有意义的方式操作它们。

树是一种特殊的数据结构。对于分层数据：具有自然父子关系的数据，这是一个不错的选择。二叉树的每个父节点最多有两个子节点。

树的另一个值得特别提及的特性是它是自相似的：树中的每个节点本身就是子树的根。递归利用了这个事实。

是的，这些都是开始的好方法。您可能想查看`java.util.Map`其他可能有用的界面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T22:27:00.010

正如你所怀疑的那样，这个假设有点缺陷。您定义的`Node`类型是二叉树的完美实例。

Jack 提到您希望`Tree`在整个节点集周围有一个类型，以便提供诸如`getRoot`插入、删除等操作。这当然不是一个坏主意，但绝不是要求。其中许多操作可以`Node`自行进行，您不一定必须拥有所有这些操作；例如，有支持和反对进行`getRoot`手术的论据。反对它的一个论点是，如果你有一个算法在某一时刻只需要一个子树，那么`Tree`持有根的对象会阻止你的算法不再需要`Node`的 s 的垃圾收集。`Node`

但更一般地说，这里需要问的真正问题是：你处理的哪些是*接口*，哪些是*实现*？因为如果你想将二叉树作为接口暴露给调用者是一回事，如果你想提供某种有限映射作为接口则是另一回事，而二叉树只是一个实现细节。在前一种情况下，客户端将“知道”一棵树要么是要么`null`是`Node`具有值和分支的，并且将被允许，例如，对树的结构进行递归；在后一种情况下，客户“知道”的只是你的类支持某种形式的`put`,`get`和`delete`操作，但不允许依赖于将其存储为搜索树这一事实。在后一种情况的许多变体中，您确实会使用`Tree`类型作为前端来对客户端隐藏节点。（例如，Java 的内置`java.util.TreeMap`类就是这样做的。）

所以最短的答案是，真的，这取决于。稍长一点的答案是它取决于二叉树实现与其用户之间的*合约是什么；*调用者允许对树进行哪些假设，二叉树的哪些细节是作者希望将来能够改变的事情，等等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T22:10:29.557

“是用来管理整套节点的吗？”

是的。

“它是否仅包含插入、删除和搜索特定节点所需的功能？”

基本上，是的。因此，它应该至少包含对根节点的引用。

# android - ContentProvider.getWriteableDatabase 抛出 NullPointerException

> ID：10080495
> 
> 赞同：2
> 
> 时间：2012-04-09T22:07:01.827
> 
> 标签：android, android-contentprovider, sqliteopenhelper

所以基本上，我正在尝试编写一个封装 SQLite 数据库的 ContentProvider。我在网上到处查看，遵循了几个不同的教程，并不断遇到同样的问题。我注意到很多人问同样的问题，但那里的建议都没有帮助我。

基本上，每当我在我的 SQLiteOpenHelper 上调用“getWriteableDatabase”时，它都会抛出一个空指针异常并且什么都没有创建。这是我的代码：

```
public class DatabaseProvider extends ContentProvider{

private static int DATABASE_VERSION = 1;

public static final String GRADE_COMPOSITION_TABLE = "gradecompositiontable";
public static final String GRADE = "Grade";
public static final String CLASS = "Class";
public static final String CLASS_CODE = "Class_Code";

public static final String ACTIVITY_CODE_TABLE = "activitycodetable";
//CLASS_CODE
public static final String ACTIVITY_CODE = "Activity_Code";

MainDatabaseHelper dbHelper;
public SQLiteDatabase dBase;

@Override
public Uri insert(Uri uri, ContentValues values)  throws SQLiteException{
    System.out.println("Helper: " + dbHelper);
    dBase = dbHelper.getWritableDatabase();  <<<Null exception here
    return null;
}

@Override
public boolean onCreate(){
    dbHelper = new MainDatabaseHelper(getContext());
    return (dbHelper == null)?false:true;
}

protected static final class MainDatabaseHelper extends SQLiteOpenHelper{

    public static String overallDBName = "TeachMEDatabase";

    private static final String SQL_CREATE_GRADE_COMP_TABLE = 
            "CREATE TABLE " +
            GRADE_COMPOSITION_TABLE +
            "(" +
            GRADE + " INTEGER, " +
            CLASS + " TEXT, " +
            CLASS_CODE + " INTEGER PRIMARY KEY)";

    public MainDatabaseHelper(Context context){
        super(context, overallDBName, null, DATABASE_VERSION);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        db.execSQL(SQL_CREATE_GRADE_COMP_TABLE);

    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int arg1, int arg2) {
        db.execSQL("DROP TABLE IF EXISTS " + GRADE_COMPOSITION_TABLE);
        onCreate(db);
    }

} 
```

我从我的主要活动中创建了这个对象，一切正常，直到我调用“插入”，也就是它崩溃的时候。

编辑：这是堆栈跟踪

```
04-09 21:53:46.301: E/AndroidRuntime(3397): Uncaught handler: thread main exiting due to uncaught exception
04-09 21:53:46.307: E/AndroidRuntime(3397): java.lang.RuntimeException: Unable to start activity ComponentInfo{sioy.teachme/sioy.teachme.TeachMEFirstActivity}: java.lang.NullPointerException
04-09 21:53:46.307: E/AndroidRuntime(3397):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2496)
04-09 21:53:46.307: E/AndroidRuntime(3397):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2512)
04-09 21:53:46.307: E/AndroidRuntime(3397):     at android.app.ActivityThread.access$2200(ActivityThread.java:119)
04-09 21:53:46.307: E/AndroidRuntime(3397):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1863)
04-09 21:53:46.307: E/AndroidRuntime(3397):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-09 21:53:46.307: E/AndroidRuntime(3397):     at android.os.Looper.loop(Looper.java:123)
04-09 21:53:46.307: E/AndroidRuntime(3397):     at android.app.ActivityThread.main(ActivityThread.java:4363)
04-09 21:53:46.307: E/AndroidRuntime(3397):     at java.lang.reflect.Method.invokeNative(Native Method)
04-09 21:53:46.307: E/AndroidRuntime(3397):     at java.lang.reflect.Method.invoke(Method.java:521)
04-09 21:53:46.307: E/AndroidRuntime(3397):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
04-09 21:53:46.307: E/AndroidRuntime(3397):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
04-09 21:53:46.307: E/AndroidRuntime(3397):     at dalvik.system.NativeStart.main(Native Method)
04-09 21:53:46.307: E/AndroidRuntime(3397): Caused by: java.lang.NullPointerException
04-09 21:53:46.307: E/AndroidRuntime(3397):     at sioy.teachme.data.DatabaseProvider.insert(DatabaseProvider.java:54)
04-09 21:53:46.307: E/AndroidRuntime(3397):     at sioy.teachme.TeachMEFirstActivity.onCreate(TeachMEFirstActivity.java:15)
04-09 21:53:46.307: E/AndroidRuntime(3397):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
04-09 21:53:46.307: E/AndroidRuntime(3397):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2459)
04-09 21:53:46.307: E/AndroidRuntime(3397):     ... 11 more 
```

# c# - 表单关闭操作？C＃

> ID：10080498
> 
> 赞同：0
> 
> 时间：2012-04-09T22:07:07.180
> 
> 标签：c#, forms

我正在寻找 Wumpus，我遇到了一个问题。（我是高中生）我负责琐事课，我在这里做错了。在我当前的代码中，我正在显示一个表单，要求用户输入，并将 answerstatus 设置为 true/false。我希望另一个班级根据给定的答案计算正确答案的数量。我的问题是，当用户关闭窗口时，如何让这个类计数？

```
public void passOrFailWumpusEncounter(bool result)
{
    if (currentTested == WUMPUS_TEST_AMOUNT)
    {
        return;
    }
    if(result)
    {
        currentPassed++;
        currentTested++;
    }
    else
    {
        currentTested++;
    }
} 
```

我从

```
public bool getQuestionStatus()
{
    return questionStatus;
} 
```

（在另一堂课上）我试过了

```
private void Form1_FormClosing(Object sender, FormClosingEventArgs e)
{
    trivia.passOrFailWumpusEncounter(prompt.getQuestionStatus());
} 
```

但它没有做任何事情！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T22:13:21.923

如果我理解得很好，您想要的是在用户关闭窗口时运行一些代码（这会计算一些东西）？

以编程方式，您应该在初始化时运行（例如在加载表单时）

```
form1.Close += ANewFunction;  // registering the handler 
```

并编写处理程序本身：

```
public void ANewFunction(EventsArg e)   { ... } 
```

但是在这样一个简单的情况下，你应该让 Visual Studio 来完成这项肮脏的工作：在表单属性中，双击关闭事件（你可能需要单击属性选项卡上的按钮来显示事件，它会注册form1.designer.cs 中的处理程序，并在您的用户代码附近创建处理程序的原型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T22:10:19.703

查找任何监听表单关闭的事件。制作一个处理程序，编写调用另一个类中设置正确答案数量的方法的代码。如果这不详细，请让您的问题更详细...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T22:29:02.520

创建表格并显示后，它仍然是现场直播。因此，您可以在调用函数中从该表单中读取答案。

例如：

```
Form myForm = new Form();
myForm.ShowDialog();
if (myForm.CheckBox.Checked) //myForm still exists and you check it's state
{
    Console.Out.WriteLine("The answer is yes!");
} 
```

# bash - gnu并行中的两对双引号冲突

> ID：10080502
> 
> 赞同：2
> 
> 时间：2012-04-09T22:07:29.940
> 
> 标签：bash, awk, parallel-processing

由于双引号与 OFS="\t" 的双引号并行冲突，命令失败。有什么建议可以使它起作用吗？谢谢！

```
ls *bed | parallel -j 10 "intersectBed -a good-genes.gff -b {} -c | awk 'BEGIN{OFS="\t";} {print $1,$9,$4,$5,$7,$10}' > test.txt" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T22:27:17.480

由于您有“外部”双引号，因此您也会遇到 awk`$`变量的问题。我会把它分成几块：

```
awk_body='BEGIN{OFS="\t";} {print $1,$9,$4,$5,$7,$10}'
ls *bed | parallel -j 10 "intersectBed -a good-genes.gff -b {} -c | awk '$awk_body' > test.txt" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T16:38:39.913

GNU Parallel 只需引用部分脚本即可：

```
ls *bed | parallel -j 10 intersectBed -a good-genes.gff -b {} -c \| awk \''BEGIN{OFS="\t\";} {print $1,$9,$4,$5,$7,$10}'\' > test.txt 
```

（引用最后一个 > 将导致竞争条件，因为所有正在运行的作业都将尝试写入 test.txt。要么给它一个唯一的名称（{}.out 或 job{#}.out），要么将 > 留在外面（在在这种情况下，所有作业的所有输出都将在这里结束））。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T22:15:19.983

您可以`"`使用以下引号在引号内转义`\`：

```
ls *bed | parallel -j 10 "intersectBed -a good-genes.gff -b {} -c | awk 'BEGIN{OFS=\"\t\";} {print $1,$9,$4,$5,$7,$10}' > test.txt" 
```

# javascript - Javascript文件修改了一个不被调用的html文件？jQuery 选择器

> ID：10080505
> 
> 赞同：1
> 
> 时间：2012-04-09T22:08:11.130
> 
> 标签：javascript, jquery, html, file, selector

是否有可能拥有一个知道两个不同 HTML 文件的 javascript 文件？我该怎么做？

我希望能够有两个页面。index.html 和图片.html。我有一个 index.js 可以更改 index.html 的显示属性（它将基于人员的数据放入表中并使其看起来不错）。我希望这个当前的 index.js 文件也能够编辑pictures.html 文件并在那里更改信息。index.html 将链接到 pictures.html 以显示一个人的图片（基于我保存的人名 smith1.jpg、smith2.jpg、reagan2.jpg 等）。无论如何，这个javascript文件是否可以根据它们的id或第二个文件（pictures.html）的类来获取DOM元素，即使它“存在于”index.html中？当我说生活时，它在 index.html 页面的顶部被调用。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T22:13:32.953

您需要探索服务器端编程来实现您的目标。 [http://en.wikipedia.org/wiki/Server-side_scripting](http://en.wikipedia.org/wiki/Server-side_scripting)

...或者您可以编写一个客户端应用程序，其中“页面”是一个实际页面的单独视图，或者是从支持数据结构生成的。如果您想要创建/编辑的内容的持久性，您仍然需要服务器端编程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T22:19:12.243

如果脚本以某种连接方式加载，则它可以访问另一个页面上的元素。

例如，如果您使用 制作弹出窗口`var popup = window.open()`，则返回值将包含对打开的弹出窗口的引用，这允许访问弹出窗口中的元素。例如`popup.document.getElementById('something')`。在框架、iframe 等中加载的页面具有类似的访问方式。

所以是的，如果您的页面加载第二页，它的脚本也可以在那里工作。我建议除了从脚本打开和关闭弹出窗口之外避免这种情况；脚本应该留在其页面的框内，如果它需要在另一个页面上执行更大的操作，这通常意味着您需要稍微更改代码架构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T22:36:06.100

您也可以使用 html5（技术组）postmessage api。这允许您将消息发送到另一个页面，并在该页面中定义一个知道如何处理消息的事件处理程序。

这也适用于跨域。

这是一个博客，其中包含我刚刚通过谷歌随机找到的示例： [http ://robertnyman.com/2010/03/18/postmessage-in-html5-to-send-messages-between-windows-and-iframes/](http://robertnyman.com/2010/03/18/postmessage-in-html5-to-send-messages-between-windows-and-iframes/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T23:17:06.147

如果编辑实际的 HTML 文件是您的目标，则在客户端是不可能的。如果根据用户在另一个页面上所做的事情来显示图片是您所关心的，那么有很多选择。

*   您可以通过 cookie 传递少量数据，例如用户通过 cookie 输入表格的内容，以便在预先建立的方案中访问正确的图像文件集。这实际上会一直持续到用户清除 cookie 为止。

*   您可以将两个页面包装在同域 iframe 元素中，而父元素仅包含 JS。这将允许您在页面之间持久化数据并对 iframe 加载事件做出反应，但就像客户端 JS 中的所有内容一样，当您重新加载页面时，一切都消失了。

*   较新的浏览器具有工作文件访问对象，这些对象并不是完全的安全噩梦。这些都是新的和非标准的，需要做一些工作才能使其适用于多个浏览器。这可用于保存包含信息的文件，当用户返回站点时可能需要提示他们上传这些信息。

*   如果数据不敏感，您可以发挥创意并使用其他服务来存储数据集合。使用 twitter API 将数据推文到 twitter 帐户的某些公开可见页面（如果您在这里做的不仅仅是一个孤立的类项目，请查看服务条款）。然后在任何公开可见的 URL 上执行 Ajax 获取请求，并解析 HTML 以获取您的 twitter 数据。

我会研究的其他内容：dataURIs、html5 本地存储。

注意：对于专业站点，无论用户从何处访问数据，这些方法都不是我会认真考虑的方法。

# c# - 无法让两行代码一起工作

> ID：10080515
> 
> 赞同：-3
> 
> 时间：2012-04-09T22:09:26.057
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, asp.net-mvc-2, asp.net-mvc-3-areas

大家好，我的控制器中有以下代码：

```
 public ViewResult Index(string Ordering, int? CounterForPage)
        {

            var FullDatabaseItem = from b in db.tblGames
                                   select b;

            {
                var Info = db.tblGames.Include(x => x.tblConsole).Where(UserInfo => UserInfo.UserName.Equals(User.Identity.Name)).ToList();
                return View(Info);

            }
            switch (Ordering)
            {
                case "HeadlineName":
                    FullDatabaseItem = FullDatabaseItem.OrderBy(b => b.GameName);
                    break;
                case "DatePosted":
                    FullDatabaseItem = FullDatabaseItem.OrderBy(b => b.ReleaseYear);
                    break;
                case "DiscriptionDate":
                    FullDatabaseItem = FullDatabaseItem.OrderBy(b => b.ReleaseYear);
                    break;
                default:
                    FullDatabaseItem = FullDatabaseItem.OrderByDescending(b => b.ReleaseYear);
                    break;
            }

            int pageSize = 3;
            int pageNumber = (CounterForPage ?? 1);
            var PageNumberResults = FullDatabaseItem.ToPagedList(pageNumber, pageSize);
            ViewBag.PageNumberResults = FullDatabaseItem.Count();
            if (PageNumberResults.Any())
            {

                return View(PageNumberResults);
            }

            return View("ErrorView");
        } 
```

当我删除以下代码时，分页工作：

```
`var Info = db.tblGames.Include(x => x.tblConsole).Where(UserInfo => UserInfo.UserName.Equals(User.Identity.Name)).ToList();`
                return View(Info); 
```

但是下面有一条绿色下划线`switch (ordering)`，上面写着：

```
Unreachable Code Dectected 
```

我需要两者，因为它们是我的应用程序的一部分。请你能给我一些帮助谢谢你的努力

我的观点代码：

```
 @model PagedList.IPagedList<Games.Models.tblGame>

    @{
        ViewBag.Title = "Index";
    }

    @*<h2>Index</h2>*@

    <p>
        @Html.ActionLink("Create New", "Create")
    </p>
    <table>
       @* <tr>*@
          @*  <th>
                GameID
            </th>*@
    @*        <th>
                GameName
            </th>
            <th>
                ReleaseYear
            </th>
            <th>
                Cost
            </th>
            <th>
                Description
            </th>
            <th>
                Downloads
            </th>
            <th>
                Image
            </th>
            <th>
                tblConsole
            </th>*@
           @* <th>
                UserName
            </th>*@
        @*    <th></th>
        </tr>*@

    @foreach (var item in Model) {
        <tr>
           @* <td>
                @Html.HiddenFor(modelItem => item.GameID)
            </td>*@

               <td id = "TableLayout1">
                <img width="100" height="100"alt="ImageFromDatabase" src='@item.Image' />
              </td>

             <td id = "TableLayout2">
                @*@Html.DisplayFor(modelItem => item.GameName)*@
                 @Html.ActionLink(item.GameName, "Details", new { id = item.GameID })
            </td>

            <td id = "TableLayout3">
                @Html.DisplayFor(modelItem => item.ReleaseYear)
            </td>

            <td id = "TableLayout4">
              @Html.Raw(item.Description.Substring(0, item.Description.IndexOf(".") + 1))
               @* @Html.DisplayFor(modelItem => item.Description)*@
            </td>

          <td id = "TableLayout5">
                @Html.DisplayFor(modelItem => item.Cost)
            </td>

            <td id = "TableLayout6">
                @Html.DisplayFor(modelItem => item.Downloads) @*want this as a link so I can then click on it and show the game downloads*@

            </td>

               <td id = "TableLayout7">
                @Html.DisplayFor(modelItem => item.tblConsole.ConsoleName)
            </td>
        @*    <td>
                @Html.HiddenFor(modelItem => item.UserName)
            </td>*@
            <td id = "TableLayout8">
              @Html.ActionLink("Edit", "Edit", new { id=item.GameID  }) |
                @Html.ActionLink("Details", "Details", new { id = item.GameID }) |
                @Html.ActionLink("Delete", "Delete", new { id = item.GameID })
            </td>
        </tr>
    }

    </table>
    <div class="PageCounter">
        Page @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber)
        of @Model.PageCount
        &nbsp;
        @if (Model.HasPreviousPage)
        {

            @Html.ActionLink("<<", "Index", new { CounterForPage = 1, Ordering = ViewBag.CurrentSort, WordFilter = ViewBag.WordFilter })
            @Html.Raw("&nbsp;");
            @Html.ActionLink("< Previous Page", "Index", new { CounterForPage = Model.PageNumber - 1, Ordering = ViewBag.CurrentSort, WordFilter = ViewBag.WordFilter })
        }
        else
        {
            @:<<
            @Html.Raw("&nbsp;");
            @:< Prev
        }
        &nbsp;
        @if (Model.HasNextPage)
        {
            @Html.ActionLink("Next Page >", "Index", new { CounterForPage = Model.PageNumber + 1, Ordering = ViewBag.CurrentSort, WordFilter = ViewBag.CurrentFilter })
            @Html.Raw("&nbsp;");
            @Html.ActionLink(">>", "Index", new { CounterForPage = Model.PageCount, Ordering = ViewBag.CurrentSort, WordFilter = ViewBag.CurrentFilter })
        }
        else
        {
            @:Next>
            @Html.Raw("&nbsp;")
            @:>>
        }

    </div>

<script type="text/javascript">
    var uvOptions = {};
    (function () {
        var uv = document.createElement('script'); uv.type = 'text/javascript'; uv.async = true;
        uv.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'widget.uservoice.com/ZRhsC1RL1m4gK5megTxxlw.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(uv, s);
    })();
</script> 
```

创建类：

```
namespace Games.Models
{
   using System;
    using System.Collections.Generic;
    using System.ComponentModel.DataAnnotations;
    using System.Web;
    using PagedList;
    using System.Web.Mvc;

    public class MyViewModel
    {
       public MyInfo Info { get; set; }
   public PageNumberResults { get; set; }

    }
} 
```

课堂上的错误：

```
Error 1 Invalid token '{' in class, struct, or interface member declaration 
Error 2 Invalid token ';' in class, struct, or interface member declaration
Error 3 Invalid token ';' in class, struct, or interface member declaration 
Error 4 Type or namespace definition, or end-of-file expected 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T22:14:45.020

您在此代码块中遗漏了一些内容：

```
{
    var Info = db.tblGames.Include(x => x.tblConsole).Where(UserInfo => UserInfo.UserName.Equals(User.Identity.Name)).ToList();
    return View(Info);
} 
```

像这样写，你只是在创建一个新的范围。对于您当前的代码，这相当于：

```
 var Info = db.tblGames.Include(x => x.tblConsole).Where(UserInfo => UserInfo.UserName.Equals(User.Identity.Name)).ToList();
  return View(Info); 
```

并且总是让方法返回，从不运行你的`switch`. 您应该弄清楚该代码块应该做什么并调整您的代码。

另一件事：`UserInfo.UserName.Equals(User.Identity.Name)`。这在 C# 中不是必需的，因为`==`运算符被重载了`string`（与 java 相比，这是不可能的），所以你可以只写`UserInfo.UserName == User.Identity.Name`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T22:11:41.520

您正在从这里的方法返回：

```
{
    var Info = db.tblGames.Include(x => x.tblConsole).Where(UserInfo => UserInfo.UserName.Equals(User.Identity.Name)).ToList();
    return View(Info);
} 
```

您是否错过了`if`在此之前的测试？还是你真的想回到这里？

看起来你应该有：

```
if (some condition)
{
    var Info = db.tblGames.Include(x => x.tblConsole).Where(UserInfo => UserInfo.UserName.Equals(User.Identity.Name)).ToList();
    return View(Info);
} 
```

这是有道理的，因为它只会返回一些时间，允许方法中的其余代码执行。我不知道`some condition`可能是什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T22:11:59.423

return 语句存在当前函数。return 语句之后的任何行都不会执行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T22:17:31.000

如何创建一个视图模型来保存结果和信息对象并将其返回给视图？

```
// Example view model containing data for Info and pagenumberResults needed on the view
// Replace MyInfo with the type of object your info variable is.
public class MyViewModel
{
   public MyInfo Info { get; set; }
   public PageNumberResults Pages { get; set; }
}

public ViewResult Index(string Ordering, int? CounterForPage)
    {

        var FullDatabaseItem = from b in db.tblGames
                               select b;

        var Info = db.tblGames.Include(x => x.tblConsole).Where(UserInfo => UserInfo.UserName.Equals(User.Identity.Name)).ToList();

        switch (Ordering)
        {
            case "HeadlineName":
                FullDatabaseItem = FullDatabaseItem.OrderBy(b => b.GameName);
                break;
            case "DatePosted":
                FullDatabaseItem = FullDatabaseItem.OrderBy(b => b.ReleaseYear);
                break;
            case "DiscriptionDate":
                FullDatabaseItem = FullDatabaseItem.OrderBy(b => b.ReleaseYear);
                break;
            default:
                FullDatabaseItem = FullDatabaseItem.OrderByDescending(b => b.ReleaseYear);
                break;
        }

        int pageSize = 3;
        int pageNumber = (CounterForPage ?? 1);
        var PageNumberResults = FullDatabaseItem.ToPagedList(pageNumber, pageSize);

        if (PageNumberResults.Any())
        {

            return View(new MyViewModel()
                       {
                           Info = info,
                           PageNumberResults = FullDatabaseItem.Count()
                        });
        }

        return View("ErrorView");
    } 
```

然后在您看来，只需用 Model.Info 或 Model.Pages 等替换对 Model 的所有调用，然后试一试。

# c# - 使用 Linq to Entities 进行分组和多重排序

> ID：10080517
> 
> 赞同：6
> 
> 时间：2012-04-09T22:09:45.090
> 
> 标签：c#, linq, linq-to-entities, ef-code-first

我有这两个实体：

```
public class Course
{
    public int Id { get; set; }
    public string Name { get; set; }
    public DateTime StartDate { get; set; }
    public DateTime EndDate { get; set; }
    public virtual ICollection<Class> Classes { get; set; }
}

public class Class
{
    public int Id { get; set; }
    public string Name { get; set; }
    public DateTime StartTime { get; set; }
    public DateTime EndTime { get; set; } ]
    public Course Course { get; set; }
} 
```

现在我需要按课程列出每个班级分组并按（降序）Course.StartDate 然后按 Class.StartTime 排序。我可以按课程分组并按 Course.StartDate 排序：

```
var myList = context.Classes
    .GroupBy(c => c.Course)
    .OrderByDescending(g => g.Key.StartDate).ToList() 
```

但是无法通过 StartTime 对每个类进行排序。我试过这个：

```
var myList = context.Classes
    .OrderBy(c => c.StartTime)
    .GroupBy(c => c.Course)
    .OrderByDescending(g => g.Key.StartDate).ToList() 
```

甚至这样：

```
var myList = context.Classes
    .GroupBy(c => c.Course)
    .OrderByDescending(g => g.Key.StartDate)
    .ThenBy(g => g.Select(c => c.StartTime)).ToList() 
```

但是这些类永远不会按它的 StartTime 排序。

*为更好地说明而编辑：这是针对 WebService 的，我必须返回 a`List<IGrouping<Course, Class>>`并且我真的想要一种优雅的方式来执行此操作（即仅使用 Linq），而无需手动创建列表。除非当然不可能。

任何帮助都将不胜感激（我使用的是 EF 代码优先 4.3 顺便说一句）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T22:13:32.113

看起来您确实需要*一个列表列表*，其中每个嵌套列表都按照您提到的附加条件进行排序。由于您按 分组`Course`，因此您可以按开始日期对*组*进行排序，因为组中的每个条目都具有相同的开始日期。然后您可以将*分组的元素*投影到按开始时间排序的列表中：

```
var myList = context.Classes
    .GroupBy(c => c.Course)
    .OrderByDescending(g => g.Key.StartDate)
    .Select(g => g.OrderBy(c => c.StartTime).ToList())
    .ToList(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T13:12:44.117

如果您需要保留签名，我建议如下：

```
var myList = context.Classes
                    .GroupBy(cc => cc.Course)
                    .OrderByDescending(gg => gg.Key.StartDate)
                    .ToArray() // <- stops EF and starts L2O
                    .SelectMany(gg => gg.OrderBy(cc => cc.StartTime))
                    .ToLookup(cc => cc.Course, cc => cc)
                    .ToList(); 
```

这会产生一种类型的签名：`List<IGrouping<Course, Class>>`并让它们按 . 正确排序`StartTime`。这依赖于`ToLookup`维护找到的订单的行为，并且可能会发生变化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T12:50:52.883

由于 EF 创建直接 SQL，因此不可能在同一 SQL 中进行包含排序的分组。

我建议使用 EF 在一个 Linq 语句中进行分组，并以 ToList() 结尾。而不是使用 Linq To Objects（在内存中）作为第二个 Linq 语句进行排序。

这应该运行得很快，因为对象已经分组。

所以这样的事情应该有效：

```
var myList = context.Classes
    .GroupBy(c => c.Course).ToList()
    .OrderByDescending(g => g.Key.StartDate).ToList() 
```

# c - 在 arm7 问题中使用 gcc 实现 malloc：malloc return NULL

> ID：10080518
> 
> 赞同：2
> 
> 时间：2012-04-09T22:09:49.533
> 
> 标签：c, gcc, malloc, arm

我在我的固件中添加了 malloc 支持，我想我错过了一些东西！

我为 arm7tdmi 处理器使用代码源 g++ lite 库，我的代码基于此链接中的示例：http: [//e2e.ti.com/support/microcontrollers/stellaris_arm_cortex-m3_microcontroller/f/473/t/44452。 aspx#539503](http://e2e.ti.com/support/microcontrollers/stellaris_arm_cortex-m3_microcontroller/f/473/t/44452.aspx#539503)

我添加了我的 _sbrk 版本：

```
char * _sbrk(int incr)
{
    //extern char _end; /* Defined by the linker */
    static char *heap_end;
    char *prev_heap_end;
    register char* stackPtr;

    if (heap_end == 0)
    {
        // first allocation
        heap_end =HEAP_END;
    }

    prev_heap_end = heap_end;

    // get current stack pointer
    asm ("mov %0, sp\n\t" : "=r" (stackPtr) );

    if (heap_end + incr > stackPtr) {
        return NULL;// error - no more memory
        //write (1, "Heap and stack collision\n", 25);
        //abort ();
    }
    heap_end += incr;
    return (char*) prev_heap_end;
} 
```

sbrk 使用的一些定义：

```
#define SDRAM_SIZE 16*1024*1024        
#define HEAP_BASE  _ebss
#define HEAP_END ((_stext + SDRAM_SIZE) -1)
#define HEAP_SIZE HEAP_END - HEAP_BASE 
```

（_ebss 和 _stext 来自我的链接器文件）

这是我进行简单 malloc/free 调用的主要内容：

```
void C_main ( void)
{
  char * testmalloc=0;
  /* Initialize "Heap Descriptor" pointer */
  pHeapDescriptor =  __rt_embeddedalloc_init ((void*)HEAP_BASE,HEAP_SIZE);
  testmalloc = malloc(2048);
  free(testmalloc);
} 
```

我以步进模式运行这个程序。当我调用malloc时，它最终调用了我的_sbrk实现，返回值（prev_heap_end）有一个期望值，但是当程序返回main时，testmalloc值为NULL（在gcc库的某个地方，prev_heap_end丢失了）。

有人知道我做错了什么吗？

不知道这是否有帮助，但这是我的 gcc 编译参数：

```
arm-none-eabi-gcc  -march=armv4t -mcpu=arm7tdmi -dp -c 
-Wa,-adhlns="../../Base/Lib/Pa/main.o.lst" -fmessage-length=0 
-fno-zero-initialized-in-bss -MMD -MP -MF"../../Base/Lib/Pa/main.d" 
-MT"../../Base/Lib/Pa/main.d" -fpic -mlittle-endian -Wall -g3 -gdwarf-2  
../../Base/Hardintrf/Mezzanine/main.c -o"../../Base/Lib/Pa/main.o" 
```

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T04:14:41.490

```
if (heap_end == 0)
{
    // first allocation
    heap_end = HEAP_END;
} 
```

这应该是：

```
if (heap_end == 0)
{
    // first allocation
    heap_end = HEAP_BASE;
} 
```

所以你不要在堆的末尾开始你的堆......你可能想为那个变量想一个更好的名字然后是 heap_end 以避免首先出现这种混淆。

此外，您不需要使用 register 修饰符来使您的内联汇编正常工作。编译器足够聪明，可以为您做到这一点。

# asp.net - 定位 CSS 中的活动链接

> ID：10080519
> 
> 赞同：2
> 
> 时间：2012-04-09T22:09:52.797
> 
> 标签：asp.net, html, css, asp.net-mvc-3

我写了一个自定义 HtmlHelper 来应用......

```
class = "active" 
```

如果这是当前页面，则添加到菜单项。查看源代码后，我知道这可以正常工作，但在我当前的设置中，我似乎无法针对 .active 类对其应用任何样式。

**当前的 HTML**

```
<ul id="menu">
    <li>@Html.MenuItem("Home", "Index", "Home")</li>
    <li>@Html.MenuItem("About", "About", "Home")</li>
</ul> 
```

**当前的 CSS**

```
#menu { width: 100%;
      padding: 0;
      margin: 0;
      list-style-type: none;
      padding-top: 6px; }

#menu a { width: 100%;
            font-weight: bold;
            text-decoration: none;
            color: #ffffff;
            padding: 6px 8px 6px 8px;
            text-shadow: 1px 1px 1px #8292a2; }

#menu a:hover { background-color: #e8eff6; color: #2a3744; text-shadow: 1px 1px 1px #e8eff6; }

#menu li { display: inline; } 
```

我假设我在这里遇到了一个特殊性问题，但我似乎无法针对“活动”类应用任何类型的样式。

```
#menu a.active
#menu li a.active 
```

似乎没有任何效果。有任何想法吗？

**编辑：** 我正在使用的自定义 HtmlHelper

```
public static class MenuExtensions
    {
        public static MvcHtmlString MenuItem(
            this HtmlHelper htmlHelper,
            string text,
            string action,
            string controller
        )
        {
            string value;
            var routeData = htmlHelper.ViewContext.RouteData;
            var currentAction = routeData.GetRequiredString("action");
            var currentController = routeData.GetRequiredString("controller");
            if (string.Equals(currentAction, action, StringComparison.OrdinalIgnoreCase) &&
                string.Equals(currentController, controller, StringComparison.OrdinalIgnoreCase))
            {
                value = htmlHelper.ActionLink(text, action, new { controller = controller }, new { @class = "active" }).ToHtmlString();
                return MvcHtmlString.Create(value.ToString());
            }

            value = htmlHelper.ActionLink(text, action, controller).ToHtmlString();
            return MvcHtmlString.Create(value.ToString());
        }
    } 
```

通过查看源代码输出 HTML

```
<ul id="menu">
   <li><a class="active" href="/">Home</a></li>
   <li><a href="/Home/About">About</a></li>
</ul> 
```

正如我所说，我知道它正在工作，即使它存在，我似乎也无法针对“活动”类......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T22:16:49.513

你放了a.active，你应该像悬停一样使用“：”。`a:active`

编辑：在重新阅读您的问题之后，您的意思是用于链接到用户当前所在页面的菜单项的自定义 CSS 类吗？在这种情况下，按照我使用 ASP 的方式，它会自动为您处理这些菜单项。否则，我看不到您将该类分配给菜单项的位置？这肯定是第一个问题。

# ruby-on-rails - 博客内容的 html 字段

> ID：10080529
> 
> 赞同：0
> 
> 时间：2012-04-09T22:11:24.133
> 
> 标签：ruby-on-rails, ruby

我正在用 ruby​​ on rails 制作自己的博客。但是当我为表单中的内容创建一个字段时，我只能显示纯文本。如何从我的字段内容中显示 html 文本。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:26:55.860

```
In controller:
@some_variable = "<p>Hi there</p>"

In the view:
<%= @some_variable.html_safe %> 
```

html_safe 告诉 rails 你的字符串可以在不先转义的情况下显示。

# ruby-on-rails - 在 Rails 3.2 上使用 simple_form gem 创建一个 optgroup

> ID：10080536
> 
> 赞同：10
> 
> 时间：2012-04-09T22:12:13.633
> 
> 标签：ruby-on-rails, simple-form, optgroup

[在http://simple-form.plataformatec.com.br/#usage/collections](http://simple-form.plataformatec.com.br/#usage/collections)上似乎只有一些关于 simple_form 2.0 中 grouped_select 功能的文档。该文档提供了以下内容：

```
f.input :country_id, :collection => @continents, :as => :grouped_select, :group_method => :countries 
```

但这似乎并没有给我足够的背景来让它发挥作用。这就是我所拥有的。

我有三个模型：查询、广告和插入

Ads has_many Insertions, and Insertions belongs_to Ads Inquiry belongs_to Insertion, and Insertions has_many Inquiries

此下拉列表用于查询视图。使用 simple_form 我`= f.input :insertion, :collection => @ads`至少可以在下拉列表中输出广告标题列表。我希望 ad.title 充当 optgroup。然后我想让广告插入作为可选内容......就像这样：

```
<select>
  <optgroup label="Ad.Title">
    <option value="Ad.Insertion.id">Ad.Insertion.Title</option>
    <option value="Ad.Insertion.id">Ad.Insertion.Title</option>
    <option value="Ad.Insertion.id">Ad.Insertion.Title</option>
    <option value="Ad.Insertion.id">Ad.Insertion.Title</option>
  </optgroup>
  <optgroup label="Ad.Title">
    <option value="Ad.Insertion.id">Ad.Insertion.Title</option>
    <option value="Ad.Insertion.id">Ad.Insertion.Title</option>
    <option value="Ad.Insertion.id">Ad.Insertion.Title</option>
    <option value="Ad.Insertion.id">Ad.Insertion.Title</option>
  </optgroup>
</select> 
```

任何人都可以提供有关使此 simple_form 功能正常工作的任何建议吗？我真的很感激！

如果您对如何执行此属性有深入了解，请告诉我是否可以告诉您有关该应用程序的任何其他信息。

提前致谢！

更新：我已经能够使用以下方法部分工作：

```
= f.input(:insertion_id, :collection => Ad.order(:name), :as => :grouped_select, :group_method => :insertions) 
```

这样做的问题是，我无法指定将哪一列用作显示文本。我欢迎任何意见。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-10T02:39:14.667

经过一些额外的研究，更好地查看文档，并使用我已经解决了我正在寻找的语法。

标准 Rails`grouped_collection_select`如下所示：

```
= f.grouped_collection_select(:insertion_id, Ad.order(:name), 
                              :insertions, :name, :id, :title, 
                              include_blank: "Please Choose...") 
```

这可以使用 simple_form 2.0 重做，语法如下：

```
= f.input(:insertion_id, :collection => Ad.order(:name),
                         :as => :grouped_select,
                         :group_method => :insertions,
                         :group_label_method => :name,
                         :label_method => :title,
                         :include_blank => "Please Choose...") 
```

我希望这对将来的其他人有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-08T11:57:56.627

另一种方法是：

```
<%= f.input :product_category do %>
    <%= f.select :product_category, grouped_options_for_select(Product.PRODUCT_CATEGORY), include_blank: true %>
  <% end %> 
```

当您尝试在不使用活动记录模式的情况下形成 optgroup 选择时，这很有效。

参考： [https](https://github.com/plataformatec/simple_form#wrapping-rails-form-helpers) ://github.com/plataformatec/simple_form#wrapping-rails-form-helpers 和 [http://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html#method-i-option_groups_from_collection_for_select](http://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html#method-i-option_groups_from_collection_for_select)

# c# - 如何将具有绝对定位的附加图像和页脚信息添加到 Itextsharp Pdf 文档中的所有生成页面

> ID：10080538
> 
> 赞同：1
> 
> 时间：2012-04-09T22:12:27.527
> 
> 标签：c#, vb.net, pdf-generation, itextsharp, pdflib

我正在 VB.net 中使用 Itextsharp 创建一个 pdf 文档，并根据从数据库中检索到的信息生成一个包含几页以适应数据量的文档，我还在标题中创建了 2 个带有一些图像的表和在文档的页脚，我需要将这些具有指定格式的表格附加到所有生成的页面。

# facebook-graph-api - Facebook 与应用程序的通信

> ID：10080541
> 
> 赞同：0
> 
> 时间：2012-04-09T22:12:52.120
> 
> 标签：facebook-graph-api

我目前工作的初创公司以餐厅等待时间为导向。对于我们的 v1.25 规范，拥有 Facebook 页面的客户（餐厅）希望能够从他们的 Facebook 页面与他们的应用程序资料进行通信。

我最接近回答这个问题的是 Graph API。但是，Graph API 只允许我们在 FB 页面中读取和写入数据。那么，餐厅 FB 页面有没有办法写入其应用程序配置文件？其次，我们模仿我们的一些设计的 Loso 具有这种能力，有人知道他们是如何做到的吗？

——鲍里斯·M。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T07:08:02.007

这是您可以考虑的一个选项...

当您设计应用程序时，您还可以开发一个页面选项卡来配合它...您将在应用程序的基本设置中找到此选项。您可以通过获取他使用该配置文件创建的所有页面的列表，然后将其安装在他选择的页面上，从而为您的应用程序的所有首次用户安装它。

当安装在页面上时，此页面选项卡将出现在页面上其他选项卡出现的位置（例如，事件、注释等发生）
您可以根据需要在此选项卡上提供所需的功能。因此，用户只需在页面上选择该选项卡并使用其功能在应用程序的个人资料页面上发布。

希望这对你有用......你也可以查看它做类似事情的jobcaster应用程序！

# php - .HTACCESS SEO查询

> ID：10080548
> 
> 赞同：2
> 
> 时间：2012-04-09T22:13:42.200
> 
> 标签：php, html, seo

如果我在 .HTACCESS 文件中使用 RedirectMatch301 代码：

原来的： `/automobiles/pickups/?category=classic`

重定向： `RedirectMatch 301 ^/automobiles/(.*)/?$ /?s=$1 [L]`

它会损害我的 SEO 状态吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T22:21:56.427

301 是在您的场景中使用的最佳重定向，例如永久重定向。我可以推测通过 301 传递的链接值有非常轻微的恶化，因此最好更新原始链接以指向它们的新目的地。如果您不让其他人更新外部链接，也不会受到伤害。虽然肯定会更新内部链接以指向新的 url。

编辑：

我通常使用 RewriteRule 而不是 RedirectMatch 301。

`RewriteRule ^/automobiles/pickups/([a-z-]+)$ /automobiles/pickups/?category=$1 [R=301,L]`

将您的 URL 重写`/automobiles/pickups/?category=classic`为 `/automobiles/pickups/classic`

使用 Firefox LiveHeaders 确保访问`/automobiles/pickups/?category=classic`将返回 301，`/automobiles/pickups/classic`并将所有内部链接更改为指向 /automobiles/pickups/classic

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T22:22:33.180

SEO重定向，从坏到好：

*   Javascript
*   元
*   htaccess 重定向
*   htaccess 重写

如果可以，请使用重写而不是重定向。显然，重定向 301 并没有那么糟糕，但是，因为没有人真正知道机器人的标准，所以最好避免它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-18T11:33:38.327

**不，它不会影响您的网站 SEO。如果您使用 301 永久重定向技术。**

301 重定向是最有效和搜索引擎友好的网页重定向方法。实施起来并不难，它应该保留您对该特定页面的搜索引擎排名。如果您必须更改文件名或移动页面，这是最安全的选择。代码“301”被解释为“永久移动”。

# javascript - js 中奇怪的 JSON 解析行为，“Unexpected token :”

> ID：10080551
> 
> 赞同：36
> 
> 时间：2012-04-09T22:14:00.973
> 
> 标签：javascript, json

如[这个 jsfiddle 所示](http://jsfiddle.net/aAQa3/1/)，如果你有一个 JS 文件并且你创建了一个 JSON 对象而不使用它，它的行为会有所不同，具体取决于键（成员）是否用引号括起来。

有效代码：`{ a: 1};`
无效代码：`{ "a": 1 };`

您将收到一条错误消息（在 Chrome 中，FF/IE 不同，但语法仍然失败）

> Uncaught SyntaxError: Unexpected token :

但是如果您以某种方式使用该对象，例如：`alert({ "a": 1 });`一切正常。

为什么会这样？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2012-04-09T22:15:32.993

该声明：

```
{ a: 1 }; 
```

不是**对象**文字。这是一个块语句，其中有一个标记表达式。这是有效的。

这：

```
{ "a": 1 }; 
```

是一个语法错误，因为它只是不可解析。带引号的“a”在块内开始一个表达式语句，但字符串后面的下一个标记是一个冒号，并且没有看起来像一个表达式后跟一个冒号的表达式形式。

现在：

```
var x = { "a": 1 }; 
```

有效，因为“{”不被解释为块语句的开始。该语句以 开头`var`，因此它是一个变量声明。在“=”标记右侧的表达式中，“{”唯一可以表示的是对象字面量的开头。同样，请注意：

```
({ "a": 1 }); 
```

没关系，因为左括号使解析器期望嵌套子表达式，因此“{”再次明确表示它是对象文字的开头。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-07-30T22:18:35.590

我刚刚意识到，当我通过加载 JSON`require`并且文件名没有结束时，`.json`我得到了这个错误。将文件重命名为`bla.json`，它工作正常。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-10-09T00:21:31.473

`jsonp`在不需要时使用 jQuery AJAX 调用时会弹出此错误`jsonp`。如果是正常情况，请尝试在 AJAX 调用中切换数据类型`json`

```
$.ajax({
     dataType: 'json', // try using json rather than json p
     ...
}); 
```

# android - 在android中使用ksaop2 php

> ID：10080553
> 
> 赞同：0
> 
> 时间：2012-04-09T22:14:12.947
> 
> 标签：android, ksoap2

我正在使用 ksoap2 为 android 开发 Web 服务。我正在编写的代码返回一个错误（xml exeption），我不知道错误在哪里，我认为它可能是操作或 url。我一直在寻找一个完整的 php web 服务示例来处理但没有用

这是 server.php 文件

```
<?php

// Pull in the NuSOAP code 
require_once("lib/nusoap.php"); 

// Create the server instance 
$server = new soap_server(); 
// Initialize WSDL support
 $server->configureWSDL('server', 'urn:server'); 
 // Put the WSDL schema types in the namespace with the tns prefix 
 $server->wsdl->schemaTargetNamespace = 'urn:server'; 
 // Register the method to expose 
 $server->register('pollServer', 
 // method name 
 array('value' => 'xsd:string'), 
 // input parameters
 array('return' => 'xsd:string'),
 // output parameters 
 'urn:server',
 // namespace 
 'urn:server#pollServer', 
 // soapaction 
 'rpc', 
 // style
 'encoded',
 // use 
 'Says hello to the caller'
 // documentation 
 ); 
 // Define the method as a PHP function 
function pollServer($value){

if($value['value'] == 'Good'){

return $value['value'].""."The value of the server poll resulted in good information";
}
else{

return $value['value'].""."The value of the server poll showed poor information";
}
}

 // Use the request to (try to) invoke the service 
 $HTTP_RAW_POST_DATA = isset($HTTP_RAW_POST_DATA) ? $HTTP_RAW_POST_DATA : ''; $server->service($HTTP_RAW_POST_DATA);
?> 
```

这是客户端 java 文件：

```
package com.restaurantApp;

import java.io.IOException;

import org.ksoap2.SoapEnvelope;
import org.ksoap2.serialization.SoapObject;
import org.ksoap2.serialization.SoapSerializationEnvelope;
import org.ksoap2.transport.HttpTransportSE;
import org.xmlpull.v1.XmlPullParserException;

import android.util.Log;

public class Example {

private static final String SOAP_ACTION = "urn:server#pollServer";
private static final String METHOD_NAME = "pollServer";
private static final String NAMESPACE = "urn:server";
private static final String URL = "http://sara-alabbasi.com/server.php";

public Example(){

SoapObject soapclient = new SoapObject(NAMESPACE,METHOD_NAME);
//Yes you need this one in order to send the whole string or else only the first letter
//is going to be send
SoapObject parameters = new SoapObject(NAMESPACE, METHOD_NAME);
parameters.addProperty("value","Good");
soapclient.addProperty(METHOD_NAME,parameters);

SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
envelope.setOutputSoapObject(soapclient);
HttpTransportSE httpTransportSE = new HttpTransportSE(URL);

try {
httpTransportSE.call(SOAP_ACTION, envelope);

Log.v("TEST","runs ok attributes "+envelope.getResponse().toString());

} catch (IOException e) {
// TODO Auto-generated catch block
e.printStackTrace();
Log.v("TEST","io wrong");
} catch (XmlPullParserException e) {
Log.v("TEST","xml wrong");
// TODO Auto-generated catch block
e.printStackTrace();
}

}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T12:16:43.970

嗨检查下面的源代码，它的工作原理！我正在使用 android ksoap App 访问 php nusoap Web 服务。

```
 package org.ralapanawa.mobile.android;

 import android.app.Activity;
 import android.os.Bundle;
 import android.util.Log;

 import org.ksoap2.SoapEnvelope;
 import org.ksoap2.serialization.SoapObject;
 import org.ksoap2.serialization.SoapSerializationEnvelope;
 import org.ksoap2.transport.HttpTransportSE;

public class CompareLast5DaysWater extends Activity {

private static final String SOAP_ACTION = "urn:Ralamobile#graphfunc";
private static final String METHOD_NAME = "graphfunc";
private static final String NAMESPACE = "urn:Ralamobile";
private static final String URL = "http://175.157.219.126:8099/Ralapanawa_SOAP/Ralapanawalogin.php";

//http://175.157.219.126:8099/Ralapanawa_SOAP/Ralapanawalogin.php

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.compare_water_level);

    getEncodedImageFromService("IRT001");
}

public void getEncodedImageFromService(String imageID) {
    SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME);
    request.addProperty("date1", imageID);

    SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(
            SoapEnvelope.VER11);
    envelope.dotNet = true;
    envelope.setOutputSoapObject(request);
    HttpTransportSE androidHttpTransport = new HttpTransportSE(URL);
    try {
        androidHttpTransport.call(SOAP_ACTION, envelope);
    } catch (Exception e) {
        e.printStackTrace();
    }

    SoapObject result;
    result = (SoapObject) envelope.bodyIn;

    if (result != null) {
        String encodedImage = result.getProperty(0).toString();
        Log.v("TAG", encodedImage);
    }
  }
} 
```

# android - 使用 getField 访问资源

> ID：10080556
> 
> 赞同：2
> 
> 时间：2012-04-09T22:14:33.680
> 
> 标签：android

当我尝试在 Android 应用程序中获取资源字段时收到异常。这似乎是访问可绘制 id 的正确方法。有什么建议可能是错的吗？

```
04-09 22:45:59.816: W/System.err(5014): java.lang.NoSuchFieldException: lumiere 
```

在我的 res/drawable 文件夹中，我有“lumiere.jpg”。来自 R.java：

```
public static final class drawable {
    [...]
    public static final int lumiere=0x7f02000a; 
```

方法调用：

```
Class c = R.drawable.class;
field = c.getField(name);
i = new Integer(field.getInt(null)); 
```

我认为这并不重要，因为它是一个静态类方法调用，但以防万一——上面的代码在一个普通的 Java 类中，而不是一个 Activity。只是想我会提到，因为对资源的访问似乎在活动之外受到限制。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T00:18:49.340

我相信你的意思是使用`c.getDeclaredField(name)`. 此外（这可能是更“正确”的方法），`Resources`当你有名字时，你可以使用对象来获取 ID。请参阅[此问题/答案](https://stackoverflow.com/questions/8317301/get-resource-by-name)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T21:09:48.553

不幸的是，您实际上似乎无法使用它从普通 Java 类访问 R.java 文件中包含的资源。当我将代码复制到一个 Activity 类中时，它没有抛出异常并返回了一个值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T22:36:06.050

**我认为调用getInt**方法时需要提供类的对象：

```
 Integer i = null;       

    try {
        Class c = R.drawable.class;
        Field field = c.getField(name);
        if(field != null){
            i = new Integer(field.getInt(c));  //provide 'c' in getInt
        }
    } catch (SecurityException e) {
        e.printStackTrace();
    } catch (NoSuchFieldException e) {
        e.printStackTrace();
    } catch (IllegalArgumentException e) {
        e.printStackTrace();
    } catch (IllegalAccessException e) {
        e.printStackTrace();
    } 
```

阅读[这篇](http://www.java2s.com/Code/JavaAPI/java.lang.reflect/FieldgetIntObjectobj.htm)文章

# assembly - 将十进制字符串转换为有符号 2 的补码二进制整数

> ID：10080559
> 
> 赞同：0
> 
> 时间：2012-04-09T22:14:44.163
> 
> 标签：assembly, input, x86

我只是想知道将十进制整数（由用户输入）转换为内存中 2 的补码表示的代码是什么。

示例：用户输入 1234 作为小数。我想在 AX 中存储 04D2 （二进制 2 的补码表示）（因为我只允许使用字长字符串）

我正在使用 80x86 架构。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T22:27:55.123

将一串数字转换为整数非常简单：一次读取一个数字，然后将其转换为十进制数（通常通过从中减去“0”）。您将现有值乘以十，然后加上当前数字的值。

处理负数只会增加一点难度。大多数人这样做是通过保留一个标志来表示如果它以'-'开头的数字是负数。然后，当他们转换数字时，如果设置了该标志，他们就会否定。

但是，这确实有一个问题：转换最大负数需要一些额外的工作，因为（在 2 的补码中）最大负数的幅度大于您可以表示为正数的幅度（不使用更多位）。例如，16 位 2 的补码范围从 -32768 到 +32767，但您需要（至少）17 位或无符号 16 位数字来表示 +32768。

编辑：将十进制数字转换为整数后，您需要将整数转换为十六进制数字才能以十六进制显示。这种转换要容易一些。您反复除以 16，余数成为下一个十六进制数字。您通常会使用像“0123456789abcdef”这样的表格，并使用该余数来索引表格以获取要显示的数字。您重复除法并使用余数，直到您的股息为零。一个技巧是，这会以*相反*的顺序（从最低有效位到最高有效位）产生数字，因此您通常将它们放入缓冲区中，从缓冲区的末尾开始，然后朝着开头前进。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2019-12-27T08:55:53.167

它需要注意位，然后加 1 ......但只有当你知道它是否为正时。如果它的负数你必须取1，那么不是它，相反的操作。它应该是2个周期来做。

# llvm - 无法使用 MS Linker 链接 LLVM 编译器生成的 obj 文件

> ID：10080561
> 
> 赞同：1
> 
> 时间：2012-04-09T22:14:52.713
> 
> 标签：llvm

我使用 llvm 在线编译器来编译我的示例 C 代码，

```
int main() { return 0; } 
```

生成的 LLVM 程序集，

```
 ; ModuleID = '/tmp/webcompile/_31588_0.bc'
target datalayout = "e-p:64:64:64-i1:8:8-i8:8:8-i16:16:16-i32:32:32-i64:64:64-f32:32:32-f64:64:64-v64:64:64-v128:128:128-a0:0:64-s0:64:64-f80:128:128-n8:16:32:64-S128"
target triple = "x86_64-unknown-linux-gnu"

define i32 @main() nounwind uwtable {
  %1 = alloca i32, align 4
  store i32 0, i32* %1
  ret i32 0
} 
```

然后我将 LLVM 程序集编译为 obj 文件，

```
llc -filetype=obj a.ll 
```

当我尝试使用链接 obj 文件时`link.exe a.o`出现错误

```
 fatal error LNK1107: invalid or corrupt file: cannot read at 0x438 
```

如何生成正确的 obj 文件以输入 link.exe？

* * *

更多信息

*   我使用 Visual Studio 11 构建了 LLVM。我没有安装 cygwin。
*   link.exe 也来自 Visual Studio 11
*   LLVM 是从最新的源代码构建的。

如果我使用 VC++ 编译器将相同的代码编译成程序集，它看起来像这样，

```
; Listing generated by Microsoft (R) Optimizing Compiler Version 17.00.50402.0 

include listing.inc

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC  main
; Function compile flags: /Odtp
_TEXT   SEGMENT
main    PROC
; File c:\tmp\u.c
; Line 1
    xor eax, eax
    ret 0
main    ENDP
_TEXT   ENDS
END 
```

`llc -filetype=asm j.ll`生成以下代码。它也因 ml.exe 而失败。

```
 .def     _main;
    .scl    2;
    .type   32;
    .endef
    .text
    .globl  _main
    .align  16, 0x90
_main:                                  # @main
# BB#0:
    pushl   %eax
    movl    $0, (%esp)
    xorl    %eax, %eax
    popl    %edx
    ret 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T07:50:19.310

如目标三元组中所述，您的 IR 适用于 x86-64/linux。因此，llc 将为您生成（默认情况下）ELF 目标文件，而不是 COFF。当然 link.exe 不会接受它。

请注意，您不能只将目标三元组更改为某些窗口并假设一切正常：

1.  COFF 目标代码发射是 WIP
2.  C/C++ 不是独立于目标的语言，因此，您无法在此处获得独立于目标的 IR：http: [//llvm.org/docs/FAQ.html#platformindependent](http://llvm.org/docs/FAQ.html#platformindependent)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T03:20:40.563

你在一个陌生的地方，你可以阅读： http: [//llvm.org/docs/GettingStartedVS.html](http://llvm.org/docs/GettingStartedVS.html)这可能会有所帮助

# json - 具有 JSON 端点的 Workflow Foundation 服务

> ID：10080562
> 
> 赞同：0
> 
> 时间：2012-04-09T22:15:09.380
> 
> 标签：json, wcf, asp.net-ajax, workflow-foundation-4, workflowservice

我们可以从 JavaScript json 调用调用 Workflow 服务接收活动方法吗？我正在尝试定义与 WCF 服务相同的 json 端点（因为 WF 服务是 WCF + WF，认为它应该与常规 WCF 调用相同），但遇到了问题。任何示例/链接都会非常有帮助。

# jquery - jQuery mouseover/hover 在几次结束后停止工作

> ID：10080563
> 
> 赞同：0
> 
> 时间：2012-04-09T22:15:15.727
> 
> 标签：jquery, hover, mouseover

我使用 jQuery mouseover 来做一些事情。但是，如果我将鼠标移动大约 5-7 次 - 它就会冻结。

为什么会出现这个问题？

我试过鼠标悬停和悬停。

代码示例：

```
$('span.info_icon').mouseover(function() {
    $('#info_box').show(600);
}).mouseout(function(){
    $('#info_box').hide(600);
}); 
```

活生生的例子：[http](http://dev.dolina-imeniy.ru/fotogalereya/kp_usadba_tishnevo) ://dev.dolina-imeniy.ru/fotogalereya/kp_usadba_tishnevo （红色“I”）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T22:20:44.177

问题：`#info_box`重叠`.info_icon`导致 mouseout 事件立即触发。因此，最好将信息图标设置为高于`z-index`信息框。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T22:27:27.997

首先，您定义了 jQuery 和内联脚本：

`<span class="info_icon" onmouseout="showMess('info_box');" onmouseover="showMess('info_box');"></span>`

两者兼而有之会引起问题。（它将显示两次，隐藏两次等）。这最终可能会使事情不同步，但更重要的是它只是完全多余的。

此外，您的 info_box 涵盖了触发范围，因此每次显示时，您都会触发`mouseout`. 这最终会一遍又一遍地切换信息。

这些东西的组合会导致问题，可能会导致您所看到的。先解决这些问题。

# delphi - 使用多个客户端在 Internet 上使用 firebird 服务器的经验？

> ID：10080571
> 
> 赞同：9
> 
> 时间：2012-04-09T22:15:42.627
> 
> 标签：delphi, security, firebird

有人在互联网上使用火鸟数据库的真实经验吗？

我有一个典型的 Windows 会计/ERP 软件（用 delphi 完成），它可以很好地与 firebird 数据库服务器配合使用。现在我的用户（现在大约 300 个，但应该增加）也希望“在云中”工作（从办公室、笔记本电脑、房子等）。将所有内容重新创建到标准 Web 应用程序（例如，HTML+CSS+JS+PHP+MYSQL）需要大量工作，所以我正在考虑保留 win 客户端（我不关心其他操作系统）但不是将服务器放在客户端 LAN 中，而是将其移动到我将签约的一对专用服务器（一个主服务器和一个辅助服务器以防止启动失败）。

搜索我遇到了这个常见问题解答[http://www.firebirdfaq.org/faq53/](http://www.firebirdfaq.org/faq53/)，它解释了它不适合在互联网上工作的 fb 协议，但我今天的所有用户仍然至少有 1MBbit/秒ADSL 互联网连接（我认为这并不像常见问题解答所指的那样慢）。

有人做过这个吗？体验如何？fb 服务器对互联网开放的安全性如何？他们的规模如何？

我知道例如使用 SOAP 构建“中间件”会更正常，但我在这里评估的解决方案仍然更加快速和简单（我仍然在复制、备份、听力服务方面进行了一些工作，但它很多比为网络重做所有事情要少）。

谢谢！编辑：FB 版本：2.5。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-10T00:12:22.570

我曾试图“推动” Firebird Core 开发人员改进 Firebird 协议，以通过高延迟网络（又名 Internet）获得更好的速度。最近，Dmitry Yemanov 在他的博客（[dyemanov.blogspot.com](http://dyemanov.blogspot.com)）上发表了一些文章。似乎有优化的余地，我真的很想看到这会出现在 FB 2.5.3 和 FB 3.0 中，尽管这些版本或很快就会发生这种情况并不能保证。您可以在此处对此类改进进行投票：http: [//tracker.firebirdsql.org/browse/CORE-2530](http://tracker.firebirdsql.org/browse/CORE-2530)

安全？您可以尝试设置 VPN。它也可能有助于提高速度，因为那里的大多数 VPN 软件（[Zebedee](http://www.winton.org.uk/zebedee/)等）都可以压缩正在传输的数据，在某些情况下有助于加快数据传输速度。

我的一些客户确实在互联网上使用 Firebird 传统的 C/S。与本地网络相比，它要慢得多，当然，慢多少基本上取决于链接速度和延迟。您也可以在客户端进行一些优化，使用元数据缓存等，但不要指望当前协议会出现奇迹。我想说，对于一整天的工作，现在使用终端服务会是一个更好的选择。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-13T13:29:39.877

关于扩展问题 Firebird 在大型大型铁服务器上运行的响应：512G​​ 的 ram 100.000 个并发用户

> 我们运行 Firebird 为更大的系统（为 12 个政府机构和 3 个银行）提供动力。它有大约 100000 个最终用户通过 2500 个（最大）池连接多路复用 [https://plus.google.com/111558763769231855886/posts/Q1ACy1yyTgP](https://plus.google.com/111558763769231855886/posts/Q1ACy1yyTgP)

Firebird 2.5 中的协议得到改进，3.0 仍有空间，但您可以检查已经完成的工作

[http://asfernandes.blogspot.com/2009/07/network-latency-influence-on-firebird.html](http://asfernandes.blogspot.com/2009/07/network-latency-influence-on-firebird.html)

以及 3.0 中的未来增强功能 [http://www.firebirdnews.org/?p=6953](http://www.firebirdnews.org/?p=6953)

为了保护您的连接，我想最好的选择是具有高压缩选项的 ssl/ssh 隧道（它可以是 opnvpn） [http://mapopa.blogspot.com/2010/11/securing-firebird-using-ssh-tunnel.html](http://mapopa.blogspot.com/2010/11/securing-firebird-using-ssh-tunnel.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-10T05:12:12.033

FB 协议问题不在于带宽，而在于延迟。根据我的经验，与 LAN 或本地连接相比，通过 Internet/VPN 进行的某些操作可能非常慢。我没有进一步检查问题，因为我并没有真正通过互联网连接运行应用程序。

但是，我建议应用三层模型。创建自己的应用程序服务器，它运行在数据库服务器/同一网络上。让客户端与应用程序服务器对话，您将获得最大的性能。

Delphi 有一些 N 层应用程序/中间件框架：

*   [RemObjects SDK 和 DataAbstract](http://www.remobjects.com)
*   [RealThinClient](http://www.realthinclient.com/)
*   [kbmMW](http://www.components4programmers.com/products/kbmmw/index.htm)
*   Delphi自己的DataSnap
*   [中间件](http://www.overbyte.be/frame_index.html)

有了这些，您可以获得数据压缩、加密、二进制消息（比 SOAP 更快）等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-04T07:28:51.957

您可以直接在 firebird 引擎中实现 TCP/IP 数据包加密/解密。个人而言，我已经下载了 Firebird 2.5 源代码，并直接在他的低级通信层（INET 套接字层）中注入了安全隧道化代码。现在，firebird 引擎直接在服务器端和客户端（fbclient.dll）对每个 TCP/IP 数据包进行加密/解密。然后无需重新构建客户端应用程序，只需添加一行代码，即可提供您选择的用于加密通信到 fbclient.dll 的密钥。必须在服务器安装的 firebird.conf 文件中声明相同的密钥。我还在 fbclient 中实现了代理协商解决方案。dll 以允许 TCP/IP 数据包通过任何代理服务器（例如 Microsoft ISA Server）。对我们来说，这种架构在实际生产系统中可以运行一年多。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-04-25T17:56:02.677

kbmMW CodeGear Edition 是免费的，但没有源代码。它可用于商业应用程序。注册后下载：[https ://portal.components4developers.com](https://portal.components4developers.com)

如果您看到证书错误（您不应该，但我知道我们听说有些确实如此），请接受并忽略它们。尽管存在 cert.error，该站点仍然有效。

kbmMW CodeGear Edition 包含 kbmMW Professional Edition 的子集，但支持以下 Delphi 数据库 API：

*   Borland 数据库引擎
*   DBExpress
*   kbmMem表
*   SQLite3

它支持与客户端通信的二进制、HTML 上的二进制、XML 和 SOAP 协议。它包含您需要的一切，包括。

*   统一远程自定义方法调用
*   统一的远程数据集查询、执行和数据更改解析
*   统一数据库元数据处理和创建（表、字段、索引、生成器/序列器）
*   可选的自动代理请求到另一台服务器并将结果代理回原始请求者
*   完整的原生 XML DOM 和 SAX 支持
*   完整的数据集公文包支持 CSV 或二进制数据
*   高级但易于使用的向导，用于创建新的应用程序服务器服务

不过有一个警告。最新版本的 kbmMW CodeGear 版本始终只支持最新的 Delphi 版本。您仍然可以下载与较旧的 Delphi 版本匹配的较旧的 kbmMW CodeGear 版本。

kbMMW 专业版和 kbmmW 企业版没有此类限制，目前支持 D7、D2006、D2007、D2010、DXE、DXE2 以及 Embarcadero C++ 对应版本。

最好的问候金马德森 www.components4developers.com

# java - 在 JSF 页面中找不到错误

> ID：10080573
> 
> 赞同：-2
> 
> 时间：2012-04-09T22:15:54.180
> 
> 标签：java, jsf, jsf-2

我正在尝试实现本教程中的代码：

这是托管 bean：

```
import java.io.Serializable;
import javax.enterprise.context.SessionScoped;
// or import javax.faces.bean.SessionScoped;
import javax.inject.Named;
/* include SQL Packages */
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.Date;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import javax.annotation.PostConstruct;
import javax.sql.DataSource;
import javax.annotation.Resource;
import javax.faces.bean.ViewScoped;
import javax.faces.component.UICommand;
import javax.faces.context.FacesContext;
import javax.inject.Inject;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpSession;
// or import javax.faces.bean.ManagedBean; 
import javax.faces.event.ActionEvent;

import org.glassfish.osgicdi.OSGiService;

// source http://balusc.blogspot.com/2008/10/effective-datatable-paging-and-sorting.html
@Named("SessionsController")
@ViewScoped
public class Sessions implements Serializable {

    /* Call the Oracle JDBC Connection driver */
    @Resource(name = "jdbc/Oracle")
    private DataSource ds;
    // Data.
    private List<ActiveSessionObj> dataList;
    private int totalRows;
    // Paging.
    private int firstRow;
    private int rowsPerPage;
    private int totalPages;
    private int pageRange;
    private Integer[] pages;
    private int currentPage;
    // Sorting.
    private String sortField;
    private boolean sortAscending;

    /* Constructor */
    public Sessions() {
        /* Set default properties */
        rowsPerPage = 10; // Default rows per page (max amount of rows to be displayed at once).
        pageRange = 10; // Default page range (max amount of page links to be displayed at once).
        sortField = "ASESSIONID"; // Default sort field.
        sortAscending = true; // Default sort direction.
    }

    private static class ActiveSessionObj {

        /* Oracle table structure
        CREATE TABLE ACTIVESESSIONSLOG(
        ASESSIONID VARCHAR2(30 ) NOT NULL,
        USERID VARCHAR2(30 ),
        ACTIVITYSTART TIMESTAMP(6),
        ACTIVITYEND TIMESTAMP(6),
        ACTIVITY CLOB
        )
         */
        private String aSessionID;
        private String userID;
        private Date activityStart;
        private Date activityEnd;
        private String activity;

        public ActiveSessionObj(String aSessionID, String userID, Date activityStart, Date activityEnd, String activity) {
            this.aSessionID = aSessionID;
            this.userID = userID;
            this.activityStart = activityStart;
            this.activityEnd = activityEnd;
            this.activity = activity;
        }

        public String getaSessionID() {
            return aSessionID;
        }

        public void setaSessionID(String aSessionID) {
            this.aSessionID = aSessionID;
        }

        public String getactivity() {
            return activity;
        }

        public void setactivity(String activity) {
            this.activity = activity;
        }

        public Date getactivityEnd() {
            return activityEnd;
        }

        public void setactivityEnd(Date activityEnd) {
            this.activityEnd = activityEnd;
        }

        public Date getactivityStart() {
            return activityStart;
        }

        public void setactivityStart(Date activityStart) {
            this.activityStart = activityStart;
        }

        public String getuserID() {
            return userID;
        }

        public void setuserID(String userID) {
            this.userID = userID;
        }

        private ActiveSessionObj() {
            throw new UnsupportedOperationException("Not yet implemented");
        }
    }

    // Paging actions -----------------------------------------------------------------------------
    public void pageFirst() {
        page(0);
    }

    public void pageNext() {
        page(firstRow + rowsPerPage);
    }

    public void pagePrevious() {
        page(firstRow - rowsPerPage);
    }

    public void pageLast() {
        page(totalRows - ((totalRows % rowsPerPage != 0) ? totalRows % rowsPerPage : rowsPerPage));
    }

    public void page(ActionEvent event) {
        page(((Integer) ((UICommand) event.getComponent()).getValue() - 1) * rowsPerPage);
    }

    private void page(int firstRow) {
        this.firstRow = firstRow;
        loadDataList(); // Load requested page.
    }

    // Sorting actions ----------------------------------------------------------------------------
    public void sort(ActionEvent event) {
        String sortFieldAttribute = (String) event.getComponent().getAttributes().get("sortField");

        // If the same field is sorted, then reverse order, else sort the new field ascending.
        if (sortField.equals(sortFieldAttribute)) {
            sortAscending = !sortAscending;
        } else {
            sortField = sortFieldAttribute;
            sortAscending = true;
        }

        pageFirst(); // Go to first page and load requested page.
    }

    // Loaders ------------------------------------------------------------------------------------
    private void loadDataList() {

        // Load list and totalCount.
        try {
            dataList = list(firstRow, rowsPerPage, sortField, sortAscending);
            totalRows = countDBRowNum(); //count the tablerows
        } catch (Exception e) {
            throw new RuntimeException(e); 
        }

        // Set currentPage, totalPages and pages.
        currentPage = (totalRows / rowsPerPage) - ((totalRows - firstRow) / rowsPerPage) + 1;
        totalPages = (totalRows / rowsPerPage) + ((totalRows % rowsPerPage != 0) ? 1 : 0);
        int pagesLength = Math.min(pageRange, totalPages);
        pages = new Integer[pagesLength];

        // firstPage must be greater than 0 and lesser than totalPages-pageLength.
        int firstPage = Math.min(Math.max(0, currentPage - (pageRange / 2)), totalPages - pagesLength);

        // Create pages (page numbers for page links).
        for (int i = 0; i < pagesLength; i++) {
            pages[i] = ++firstPage;
        }
    }

    // Getters ------------------------------------------------------------------------------------
    public List<ActiveSessionObj> getdataList() {
        if (dataList == null) {
            loadDataList(); // Preload page for the 1st view.
        }
        return dataList;
    }

    public int getTotalRows() {
        return totalRows;
    }

    public int getFirstRow() {
        return firstRow;
    }

    public int getRowsPerPage() {
        return rowsPerPage;
    }

    public Integer[] getPages() {
        return pages;
    }

    public int getCurrentPage() {
        return currentPage;
    }

    public int getTotalPages() {
        return totalPages;
    }

    // Setters ------------------------------------------------------------------------------------
    public void setRowsPerPage(int rowsPerPage) {
        this.rowsPerPage = rowsPerPage;
    }

    // Actions ------------------------------------------------------------------------------------
    /**
     * Returns list of ActiveSessionObj items starting at the given first index with the given row count,
     * sorted by the given sort field and sort order.
     * @param firstRow First index of rows to be returned.
     * @param rowCount Amount of rows to be returned.
     * @param sortField Field to sort the data on.
     * @param sortAscending Whether to sort data ascending or not.
     * @return list of ActiveSessionObj items starting at the given first index with the given row count,
     * sorted by the given sort field and sort order.
     * @throws DAOException If something fails at DAO level.
     */
    public List<ActiveSessionObj> list(int firstRow, int rowCount, String sortField, boolean sortAscending) throws SQLException {

        String SqlStatement = null;

        if (ds == null) {
            throw new SQLException();
        }

        Connection conn = ds.getConnection();
        if (conn == null) {
            throw new SQLException();
        }

        String sortDirection = sortAscending ? "ASC" : "DESC";

        SqlStatement = "SELECT * FROM ACTIVESESSIONSLOG WHERE ROWNUM >= ? AND ROWNUM <= ? ORDER BY %s %s";

        String sql = String.format(SqlStatement, sortField, sortDirection);

        PreparedStatement ps = null;
        ResultSet resultSet = null;
        List<ActiveSessionObj> dataList = new ArrayList<ActiveSessionObj>();

        try {
            conn.setAutoCommit(false);
            boolean committed = false;
            try {
                ps = conn.prepareStatement(sql);
                ps.setInt(1, firstRow);
                ps.setInt(2, rowCount);

                resultSet = ps.executeQuery();
                /* take the result from the SQL query and insert it into Array List collection */
                dataList = ActiveSessionsArrayList(resultSet);

                conn.commit();
                committed = true;

            } finally {
                if (!committed) {
                    conn.rollback();
                }
            }

        } finally {
            ps.close();
            conn.close();
        }

        return dataList;
    }

    /**
     * Returns total amount of rows in table.
     * @return Total amount of rows in table.
     * @throws DAOException If something fails at DAO level.
     */
    public int countDBRowNum() throws Exception {

        String SqlStatement = null;

        if (ds == null) {
            throw new SQLException();
        }

        Connection conn = ds.getConnection();
        if (conn == null) {
            throw new SQLException();
        }

        SqlStatement = "SELECT count(*) FROM ACTIVESESSIONSLOG";

        PreparedStatement ps = null;
        ResultSet resultSet = null;
        int count = 0;

        try {
            conn.setAutoCommit(false);
            boolean committed = false;
            try {
                SqlStatement = "SELECT count(*) FROM ACTIVESESSIONSLOG";

                ps = conn.prepareStatement(SqlStatement);
                resultSet = ps.executeQuery();

                if (resultSet.next()) {
                    count = resultSet.getInt(1);
                }

                conn.commit();
                committed = true;
            } finally {
                if (!committed) {
                    conn.rollback();
                }
            }
        } finally {
            ps.close();
            conn.close();
        }

        return count;
    }

    /**
     * Map the current row of the given ResultSet to ActiveSessionObj.
     * @param resultSet The ResultSet of which the current row is to be mapped to ActiveSessionObj.
     * @return The mapped ActiveSessionObj from the current row of the given ResultSet.
     * @throws SQLException If something fails at database level.
     */
    private static ArrayList<ActiveSessionObj> ActiveSessionsArrayList(ResultSet rs) throws SQLException {
        ArrayList<ActiveSessionObj> al = null;

        try {
            while (rs.next()) {
                al.add(new ActiveSessionObj(
                        rs.getString("ASESSIONID"),
                        rs.getString("USERID"),
                        timestampToDate(rs.getTimestamp("ACTIVITYSTART")),
                        timestampToDate(rs.getTimestamp("ACTIVITYEND")),
                        rs.getString("ACTIVITY")));
            }
        } catch (Exception x) {
            x.printStackTrace();
        }

        return al;

        /*
        CREATE TABLE ACTIVESESSIONSLOG(
        ASESSIONID VARCHAR2(30 ) NOT NULL,
        USERID VARCHAR2(30 ),
        ACTIVITYSTART TIMESTAMP(6),
        ACTIVITYEND TIMESTAMP(6),
        ACTIVITY CLOB
        )
         */
    }
    // select all button handle
    private Map<Long, Boolean> selectedIds = new HashMap<Long, Boolean>();

    // get the list from the JSF page
    public Map<Long, Boolean> getSelectedIds() {
        return selectedIds;
    }

    // call this method from the JSF page to delete the selected rows
    public String deleteAction() {

        // do something with the selected rows
        return null;
    }

    private static Date timestampToDate(java.sql.Timestamp ts) {
        Date d = null;
        try {
            d = new Date(ts.getTime());
        } catch (Exception e) {
            e.printStackTrace();
        }

        return d;
    }
} 
```

这是 JSF 页面：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"    
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets">
    <h:head>
        <ui:insert name="header">           
            <ui:include src="header.xhtml"/>         
        </ui:insert>
    </h:head>
    <h:body>

        <h1><img src="resources/css/images/icon.png" alt="NVIDIA.com" /> History Center</h1>
        <!-- layer for black background of the buttons -->
        <div id="toolbar" style="margin: 0 auto; width:1180px; height:30px; position:relative;  background-color:black">
            <!-- Include page Navigation -->
            <ui:insert name="Navigation">           
                <ui:include src="Navigation.xhtml"/>         
            </ui:insert>

        </div>  

        <div id="greenBand" class="ui-state-default ui-corner-allh" style="position:relative; top:35px; left:0px;"> 
            <h:graphicImage alt="Dashboard"  style="position:relative; top:-20px; left:9px;"  value="resources/images/logo_sessions.png" />
        </div>
        <div id="main" style="margin: 0 auto; width:1190px; height:700px; position:absolute;  background-color:transparent; top:105px">

            <div id="mainpage" style="margin: 0 auto; width:1190px; height:500px; position:absolute;  background-color:transparent; top:80px">

                <div id="settingsHashMap" style="width:750px; height:400px; position:absolute;  background-color:r; top:20px; left:1px">

                    <h:form id="form">

                        <!-- The sortable data table -->
                        <h:dataTable value="#{SessionsController.dataList}" var="item">

                            <h:column>
                                <f:facet name="header">
                                    <h:commandLink value="Account Session ID" actionListener="#{SessionsController.sort}">
                                        <f:attribute name="sortField" value="Account Session ID" />
                                    </h:commandLink>
                                </f:facet>
                                <h:outputText value="#{item.aSessionID}" />
                            </h:column>

                            <h:column>
                                <f:facet name="header">
                                    <h:commandLink value="User ID" actionListener="#{SessionsController.sort}">
                                        <f:attribute name="sortField" value="User ID" />
                                    </h:commandLink>
                                </f:facet>
                                <h:outputText value="#{item.userID}" />
                            </h:column>
                            <h:column>
                                <f:facet name="header">
                                    <h:commandLink value="Activity Start Time" actionListener="#{SessionsController.sort}">
                                        <f:attribute name="sortField" value="Activity Start Time" />
                                    </h:commandLink>
                                </f:facet>
                                <h:outputText value="#{item.activityStart}" />
                            </h:column>
                            <h:column>
                                <f:facet name="header">
                                    <h:commandLink value="Activity End Time" actionListener="#{SessionsController.sort}">
                                        <f:attribute name="sortField" value="Activity End Time" />
                                    </h:commandLink>
                                </f:facet>
                                <h:outputText value="#{item.activityEnd}" />
                            </h:column>
                            <h:column>
                                <f:facet name="header">
                                    <h:commandLink value="Activity" actionListener="#{SessionsController.sort}">
                                        <f:attribute name="sortField" value="Activity" />
                                    </h:commandLink>
                                </f:facet>
                                <h:outputText value="#{item.activity}" />
                            </h:column>
                        </h:dataTable>

                        <!-- The paging buttons -->
                        <h:commandButton value="first" action="#{SessionsController.pageFirst}"
                                         disabled="#{SessionsController.firstRow == 0}" />
                        <h:commandButton value="prev" action="#{SessionsController.pagePrevious}"
                                         disabled="#{SessionsController.firstRow == 0}" />
                        <h:commandButton value="next" action="#{SessionsController.pageNext}"
                                         disabled="#{SessionsController.firstRow + SessionsController.rowsPerPage >= SessionsController.totalRows}" />
                        <h:commandButton value="last" action="#{SessionsController.pageLast}"
                                         disabled="#{SessionsController.firstRow + SessionsController.rowsPerPage >= SessionsController.totalRows}" />
                        <h:outputText value="Page #{SessionsController.currentPage} / #{SessionsController.totalPages}" />
                        <br />

                        <!-- The paging links -->
                        <ui:repeat value="#{SessionsController.pages}" var="page">
                            <h:commandLink value="#{page}" actionListener="#{SessionsController.page}"
                                           rendered="#{page != SessionsController.currentPage}" />
                            <h:outputText value="#{page}" escape="false"
                                          rendered="#{page == SessionsController.currentPage}" />
                        </ui:repeat>
                        <br />

                        <!-- Set rows per page -->
                        <h:outputLabel for="rowsPerPage" value="Rows per page" />
                        <h:inputText id="rowsPerPage" value="#{SessionsController.rowsPerPage}" size="3" maxlength="3" />
                        <h:commandButton value="Set" action="#{SessionsController.pageFirst}" />
                        <h:message for="rowsPerPage" errorStyle="color: red;" />

                    </h:form>

                </div>   

                <div id="settingsdiva" style="width:350px; height:400px; position:absolute;  background-color:transparent; top:20px; left:400px">

                </div>   

                <div id="settingsdivb" style="width:350px; height:400px; position:absolute;  background-color:transparent; top:20px; left:800px">

                </div>   
            </div>  
        </div>

    </h:body>
</html> 
```

当我尝试显示数据库表中的数据时，JSF 表上没有显示数据。桌子是空的。这是 Glassfish 中的错误堆栈：

```
[#|2012-04-09T16:46:33.241+0300|SEVERE|glassfish3.1.2|javax.enterprise.system.std.com.sun.enterprise.server.logging|_ThreadID=173;_ThreadName=Thread-2;|java.lang.NullPointerException
    at com.DX_57.HM_57.Sessions.ActiveSessionsArrayList(Sessions.java:375)
    at com.DX_57.HM_57.Sessions.list(Sessions.java:293)
    at com.DX_57.HM_57.Sessions.loadDataList(Sessions.java:190)
    at com.DX_57.HM_57.Sessions.getDataList(Sessions.java:214)
    at sun.reflect.GeneratedMethodAccessor839.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at javax.el.BeanELResolver.getValue(BeanELResolver.java:363)
    at com.sun.faces.el.DemuxCompositeELResolver._getValue(DemuxCompositeELResolver.java:176)
    at com.sun.faces.el.DemuxCompositeELResolver.getValue(DemuxCompositeELResolver.java:203)
    at com.sun.el.parser.AstValue.getValue(AstValue.java:138)
    at com.sun.el.parser.AstValue.getValue(AstValue.java:183)
    at com.sun.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:224)
    at com.sun.faces.facelets.el.TagValueExpression.getValue(TagValueExpression.java:109)
    at javax.faces.component.ComponentStateHelper.eval(ComponentStateHelper.java:194)
    at javax.faces.component.ComponentStateHelper.eval(ComponentStateHelper.java:182)
    at javax.faces.component.UIData.getValue(UIData.java:731)
    at javax.faces.component.UIData.getDataModel(UIData.java:1798)
    at javax.faces.component.UIData.setRowIndexWithoutRowStatePreserved(UIData.java:484)
    at javax.faces.component.UIData.setRowIndex(UIData.java:473)
    at com.sun.faces.renderkit.html_basic.TableRenderer.encodeEnd(TableRenderer.java:191)
    at javax.faces.component.UIComponentBase.encodeEnd(UIComponentBase.java:875)
    at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1764)
    at javax.faces.render.Renderer.encodeChildren(Renderer.java:168)
    at javax.faces.component.UIComponentBase.encodeChildren(UIComponentBase.java:845)
    at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1757)
    at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1760)
    at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1760)
    at com.sun.faces.application.view.FaceletViewHandlingStrategy.renderView(FaceletViewHandlingStrategy.java:402)
    at com.sun.faces.application.view.MultiViewHandler.renderView(MultiViewHandler.java:131)
    at com.sun.faces.lifecycle.RenderResponsePhase.execute(RenderResponsePhase.java:121)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:139)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:594)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1542)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:849)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:746)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1045)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:228)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:722)
|#] 
```

我无法找到代码中的错误。我该如何解决这个问题？

最良好的祝愿

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T22:30:10.947

这不是 JSF 特定的。`null`您在第 375 行有参考`Sessions.java`。去确保你不调用`null`对象上的方法。在您的特定情况下，这将解决它：

```
ArrayList<ActiveSessionObj> al = new ArrayList<ActiveSessionObject>(); 
```

但是下一次，请尝试阅读异常告诉您的内容。它会告诉您失败的地方以及失败的原因。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T22:32:24.420

你还没有初始化你的 ArrayList 并且你有一个空指针。

```
 ArrayList<ActiveSessionObj> al = null; 
```

然后你添加它，我认为这是抛出错误：

```
 al.add(new ActiveSessionObj( 
```

将其更改为：

```
 ArrayList<ActiveSessionObj> al = new ArrayList<ActiveSessionObj>; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T22:31:22.020

我认为它就在这里：

```
 private static ArrayList<ActiveSessionObj> ActiveSessionsArrayList(ResultSet rs) throws SQLException {
    ArrayList<ActiveSessionObj> al = null;

    try {
        while (rs.next()) { 
```

可能就在行号所说的位置。您将 al 设置为 null，然后在该 while 语句之后立即尝试使用它。

# javascript - JQuery Draggable 以编程方式拖动到位置

> ID：10080578
> 
> 赞同：1
> 
> 时间：2012-04-09T22:16:38.860
> 
> 标签：javascript, jquery, jquery-ui, jquery-ui-draggable

我想在页面上的某处添加按钮来操作 JQuery Draggable 元素而无需鼠标拖动，即以编程方式。换句话说，我想根据用户单击的按钮向上或向下、向左或向右移动（或平移）其容器内的可拖动元素。我该怎么做？我似乎无法在文档中找到该选项。我是否只是简单地操纵 CSS left/top 来实现它并确保我不会离开容器？

```
$(".drag-view").draggable({drag:function(event, ui){containment:a /*...*/}}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T22:22:41.790

您可以在屏幕上绘制元素，然后使用 $.animate() 将其移动到位。该元素必须绝对定位才能以这种方式设置动画，并且正如您所提到的，它是 top 和 left 的结果。

# tfs - 父状态更改时子工作项状态是否会自动更改

> ID：10080585
> 
> 赞同：3
> 
> 时间：2012-04-09T22:17:32.570
> 
> 标签：tfs, workflow

我为两种类型的工作项（用户故事和任务）定义了相同的状态和转换，我希望当某些工作项在该特定状态下转换时，所有具有相同状态和转换的子工作项都设置为状态。

示例：用户故事和任务的状态为已推迟，例如，我的用户故事有 3 个子工作项，当我将父用户故事的状态更改为已推迟时，所有具有已推迟状态的子工作项都会自动更改为已推迟状态

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T23:16:04.320

这当然是有用的功能，但目前不支持它。您可以使用 TFS-API 来调用状态更改。这篇[文章](http://www.dotnetcurry.com/ShowArticle.aspx?ID=336)提供了一个相关的例子。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T11:43:15.730

如果您想构建服务器端扩展，您绝对可以这样做。我的建议是通过编译一个插件 DLL 并将其放在每个应用层服务器上的插件文件夹中来走[ISubscriber路线。](http://colinsalmcorner.blogspot.com/2011/12/isubscriber-getting-tfs-url-for-client.html)我们在Wrox 的[Professional Team Foundation Server 2010](http://bit.ly/TFS2010Book)`ISubscriber`一书的第 25 章中提供了一些关于创建 's 的附加信息。

# wpf - UI Binding 更新到重新分配的 ObservableCollection

> ID：10080586
> 
> 赞同：1
> 
> 时间：2012-04-09T22:17:35.960
> 
> 标签：wpf, binding, observablecollection

**描述**：首先我创建了一个 ObservableCollection，它可以通过公共属性 MyCollection 访问。现在，如果我将 DataGrid UI 绑定到 MyCollection，它将识别集合更改，但如果 MyCollection 本身发生更改（即 UpdateCollection 方法）则不会。为了解决这个问题，我将熟悉的 'PropertyChanged("MyCollection")' 应用于 MyCollection 属性。

现在我发现需要对需要集合视图层的 DataGrid 内容进行分组。当我添加并绑定到 CollectionView 时，当 MyCollection 被重新分配时 UI 不再更新。我读到只有 CollectionChanged 从源传播到视图。我想在我的情况下，MyCollection 上的 PropertyChange 需要以某种方式触发 Source 或 View 上的 CollectionChanged 事件。

**问题**：如何重新分配 MyCollection 以触发绑定到 MyCollection 视图的 UI 更新？

**注意**：重新分配 MyCollection 的原因是模块化 MEF/MVVM 架构。

```
public class MyViewModel
{
  public MyViewModel()
  {
    MyCollectionViewSource = new CollectionViewSource() { Source = MyCollection};
    // The DataGrid is bound to this ICollectionView
    MyCollectionView = MyCollectionViewSource.View;
  }

  // Collection Property
  // NotifyPropertyChanged added specifically to notify of MyCollection re-assignment
  ObservableCollection<MyObject> _MyCollection;
  public ObservableCollection<MyObject> MyCollection
  {
    get {return _MyCollection;}
    set {if (value != _MyCollection)
            {_MyCollection = value;
            NotifyPropertyChanged("MyCollection");}}
  }

  public MyCollectionViewSource PropertiesCollectionViewSource { get; private set; }
  public ICollectionView = MyCollectionView { get; private set; }

  // Method updates MyCollection itself (Called via ICommand from another ViewModel)
  public void UpdateCollection(ObservableCollection<MyObject> NewCollection)
  {
    MyCollection = NewCollection;
  }
} 
```

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T23:55:53.770

看看 Active Grouping Collection，它针对的是不同的问题，但可能会解决你的问题。

[构建更智能的 WPF CollectionView](http://stumblingaroundinwpf.blogspot.com.au/2009_11_01_archive.html)

[CodePlex 上的活动集合视图](http://activecollectionview.codeplex.com/)

# c# - 实体框架 DbContext 覆盖每个模型的 SaveChanges

> ID：10080588
> 
> 赞同：0
> 
> 时间：2012-04-09T22:17:42.320
> 
> 标签：c#, asp.net, entity-framework

我有几个与`DbContext`. 如何`SaveChanges`根据正在保存的模型覆盖以执行不同的操作？

例如，假设我有两个模型，`Document`并且`Paragraph`. 如何覆盖`SaveChanges`以便在添加 a 时创建目录并在`Document`添加 a 时创建文件`Paragraph`。

到目前为止，这是我这样做的尝试。

```
public int override SaveChanges()
{
    ChangeTracker.DetectChanges();

    var context = ((IObjectContextAdapter)this).ObjectContext;
    var stateEntries = context.ObjectStateManager.GetObjectStateEntries(
        EntityState.Added
        | EntityState.Modified
        | EntityState.Deleted
    ).ToList();

    foreach (var entry in stateEntries)
    {
        if (!entry.IsRelationship)
        {
            switch (entry.State)
            {
                case EntityState.Added:
                    break;

                case EntityState.Modified:
                    break;

                case EntityState.Deleted:
                    break;
            }
        }
    }

    return base.SaveChanges();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T22:32:00.557

该条目具有`Entity`保存已处理实体实例的属性，因此您可以检查实例的类型并理论上执行您想要执行的任何逻辑。

* * *

You should not use `SaveChanges` to do anything else than processing your entities for persistence to database - that breaks the separation of concerns. The context is adapter between your application logic and database - nothing more. Moreover whole this idea of integrating file system operations with database operations needs much more complex and careful handling to solve the situation when any operation fails. In your current scenario any failure in call to `base.SaveChanges` will result in orphan directories or files in your file system - you need to use transactional file system and run but database and file system operation in the same transaction or you must implement manual file system compensation.

您的代码的另一个问题是您必须先处理`Document`实例，`Paragraph`以确保在要插入文件等之前创建目录。这个逻辑不属于`SaveChanges`方法，不应该从`SaveChanges`方法中调用。

# iphone - iPhone 社交网络中使用了哪些技术？

> ID：10080597
> 
> 赞同：-1
> 
> 时间：2012-04-09T22:18:01.937
> 
> 标签：iphone, networking, social

我想创建一个 iPhone 社交网络。我知道如何使用服务器，而且我是一名 iPhone 开发人员，但我使用什么方法将数据从服务器移动到客户端？

（例如：XML Cvs 套接字等......）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:24:05.297

最常见的解决方案涉及返回 JSON 或 XML 的 RESTful Web 服务。[您可以在此处](http://www.raywenderlich.com/5492/working-with-json-in-ios-5)查看 JSON 和 iOS 示例，如果您想使用 Ruby on Rails 快速设置一个返回 XML 或 JSON 的 RESTful 服务，您可以在[此处](http://gavinmorrice.com/blog/posts/21-building-a-rest-api-in-rails-3)查看这是如何完成的。

# javascript - 如何提高自定义 URL 方案处理程序中大型函数的执行速度

> ID：10080598
> 
> 赞同：1
> 
> 时间：2012-04-09T22:18:13.040
> 
> 标签：javascript, ios, html, url

我正在 iphone 上开发一个使用 html5 和本机代码的应用程序。在某些时候，当我处于 html 级别并且我想做一些本机操作时，我会调用自定义协议，例如： test:// ... 。在本机部分，协议处理程序拦截调用并继续。我只是想知道是否由于某种原因要在本机部分执行的函数（在调用 url 之后）很大并且需要很长时间才能执行，我会卡在 html 部分等待处理程序完成执行所有功能。有什么建议可以解决这个问题吗？

javascript方面：

```
window.location=urlScheme://... 
```

ios端：

```
handler(){

// functions to be executed
} 
```

# c# - 如何首先使用迁移向 Entity Framework 4.3 代码中的列添加描述？

> ID：10080601
> 
> 赞同：26
> 
> 时间：2012-04-09T22:18:39.503
> 
> 标签：c#, .net, sql-server-2008-r2, entity-framework-4.3

我首先使用 Entity Framework 4.3.1 代码和显式迁移。如何在实体配置类或迁移中添加列的描述，使其最终成为 SQL Server 中列的描述（例如 2008 R2）？

我知道我可能可以为`DbMigration`类编写一个扩展方法，将`sp_updateextendedproperty`or`sp_addextendedproperty`过程调用注册为迁移事务中的 sql 迁移操作，并在迁移`Up`方法中创建表后调用该扩展。但是有没有一种我还没有发现的优雅的内置方式？如果有一个属性，迁移的更改检测逻辑可以获取并在脚手架迁移中生成适当的方法调用，那就太好了。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-09-26T09:27:34.723

我也需要这个。所以我花了一天时间，这里是：

**编码**

```
 public class DbDescriptionUpdater<TContext>
        where TContext : System.Data.Entity.DbContext
    {
        public DbDescriptionUpdater(TContext context)
        {
            this.context = context;
        }

        Type contextType;
        TContext context;
        DbTransaction transaction;
        public void UpdateDatabaseDescriptions()
        {
            contextType = typeof(TContext);
            this.context = context;
            var props = contextType.GetProperties(System.Reflection.BindingFlags.Instance | System.Reflection.BindingFlags.Public);
            transaction = null;
            try
            {
                context.Database.Connection.Open();
                transaction = context.Database.Connection.BeginTransaction();
                foreach (var prop in props)
                {
                    if (prop.PropertyType.InheritsOrImplements((typeof(DbSet<>))))
                    {
                        var tableType = prop.PropertyType.GetGenericArguments()[0];
                        SetTableDescriptions(tableType);
                    }
                }
                transaction.Commit();
            }
            catch
            {
                if (transaction != null)
                    transaction.Rollback();
                throw;
            }
            finally
            {
                if (context.Database.Connection.State == System.Data.ConnectionState.Open)
                    context.Database.Connection.Close();
            }
        }

        private void SetTableDescriptions(Type tableType)
        {
            string fullTableName = context.GetTableName(tableType);
            Regex regex = new Regex(@"(\[\w+\]\.)?\[(?<table>.*)\]");
            Match match = regex.Match(fullTableName);
            string tableName;
            if (match.Success)
                tableName = match.Groups["table"].Value;
            else
                tableName = fullTableName;

            var tableAttrs = tableType.GetCustomAttributes(typeof(TableAttribute), false);
            if (tableAttrs.Length > 0)
                tableName = ((TableAttribute)tableAttrs[0]).Name;
            foreach (var prop in tableType.GetProperties(System.Reflection.BindingFlags.Public | System.Reflection.BindingFlags.Instance))
            {
                if (prop.PropertyType.IsClass && prop.PropertyType != typeof(string))
                    continue;
                var attrs = prop.GetCustomAttributes(typeof(DisplayAttribute), false);
                if (attrs.Length > 0)
                    SetColumnDescription(tableName, prop.Name, ((DisplayAttribute)attrs[0]).Name);
            }
        }

        private void SetColumnDescription(string tableName, string columnName, string description)
        {
            string strGetDesc = "select [value] from fn_listextendedproperty('MS_Description','schema','dbo','table',N'" + tableName + "','column',null) where objname = N'" + columnName + "';";
            var prevDesc = RunSqlScalar(strGetDesc);
            if (prevDesc == null)
            {
                RunSql(@"EXEC sp_addextendedproperty 
@name = N'MS_Description', @value = @desc,
@level0type = N'Schema', @level0name = 'dbo',
@level1type = N'Table',  @level1name = @table,
@level2type = N'Column', @level2name = @column;",
                                                       new SqlParameter("@table", tableName),
                                                       new SqlParameter("@column", columnName),
                                                       new SqlParameter("@desc", description));
            }
            else
            {
                RunSql(@"EXEC sp_updateextendedproperty 
@name = N'MS_Description', @value = @desc,
@level0type = N'Schema', @level0name = 'dbo',
@level1type = N'Table',  @level1name = @table,
@level2type = N'Column', @level2name = @column;",
                                                       new SqlParameter("@table", tableName),
                                                       new SqlParameter("@column", columnName),
                                                       new SqlParameter("@desc", description));
            }
        }

        DbCommand CreateCommand(string cmdText, params SqlParameter[] parameters)
        {
            var cmd = context.Database.Connection.CreateCommand();
            cmd.CommandText = cmdText;
            cmd.Transaction = transaction;
            foreach (var p in parameters)
                cmd.Parameters.Add(p);
            return cmd;
        }
        void RunSql(string cmdText, params SqlParameter[] parameters)
        {
            var cmd = CreateCommand(cmdText, parameters);
            cmd.ExecuteNonQuery();
        }
        object RunSqlScalar(string cmdText, params SqlParameter[] parameters)
        {
            var cmd = CreateCommand(cmdText, parameters);
            return cmd.ExecuteScalar();
        }

    }
    public static class ReflectionUtil
    {

        public static bool InheritsOrImplements(this Type child, Type parent)
        {
            parent = ResolveGenericTypeDefinition(parent);

            var currentChild = child.IsGenericType
                                   ? child.GetGenericTypeDefinition()
                                   : child;

            while (currentChild != typeof(object))
            {
                if (parent == currentChild || HasAnyInterfaces(parent, currentChild))
                    return true;

                currentChild = currentChild.BaseType != null
                               && currentChild.BaseType.IsGenericType
                                   ? currentChild.BaseType.GetGenericTypeDefinition()
                                   : currentChild.BaseType;

                if (currentChild == null)
                    return false;
            }
            return false;
        }

        private static bool HasAnyInterfaces(Type parent, Type child)
        {
            return child.GetInterfaces()
                .Any(childInterface =>
                {
                    var currentInterface = childInterface.IsGenericType
                        ? childInterface.GetGenericTypeDefinition()
                        : childInterface;

                    return currentInterface == parent;
                });
        }

        private static Type ResolveGenericTypeDefinition(Type parent)
        {
            var shouldUseGenericType = true;
            if (parent.IsGenericType && parent.GetGenericTypeDefinition() != parent)
                shouldUseGenericType = false;

            if (parent.IsGenericType && shouldUseGenericType)
                parent = parent.GetGenericTypeDefinition();
            return parent;
        }
    }

    public static class ContextExtensions
    {
        public static string GetTableName(this DbContext context, Type tableType)
        {
            MethodInfo method = typeof(ContextExtensions).GetMethod("GetTableName", new Type[] { typeof(DbContext) })
                             .MakeGenericMethod(new Type[] { tableType });
            return (string)method.Invoke(context, new object[] { context });
        }
        public static string GetTableName<T>(this DbContext context) where T : class
        {
            ObjectContext objectContext = ((IObjectContextAdapter)context).ObjectContext;

            return objectContext.GetTableName<T>();
        }

        public static string GetTableName<T>(this ObjectContext context) where T : class
        {
            string sql = context.CreateObjectSet<T>().ToTraceString();
            Regex regex = new Regex("FROM (?<table>.*) AS");
            Match match = regex.Match(sql);

            string table = match.Groups["table"].Value;
            return table;
        }
    } 
```

**如何使用**

在您的`Migrations/Configuration.cs`文件中，将其添加到方法的末尾`Seed`：

```
DbDescriptionUpdater<ContextClass> updater = new DbDescriptionUpdater<ContextClass>(context);
updater.UpdateDatabaseDescriptions(); 
```

然后在包管理器控制台中键入`update-database`并按 Enter。而已。

该代码使用`[Display(Name="Description here")]`实体类属性上的属性来设置描述。

请报告任何错误或提出改进建议。

**谢谢**

我使用了其他人的这些代码，我想说谢谢：

[添加列描述](https://stackoverflow.com/a/3754311/281048)

[检查一个类是否派生自一个泛型类](https://stackoverflow.com/a/4897426/281048)

[从实体框架元数据中获取数据库表名](https://stackoverflow.com/a/9760774/281048)

[C#中的泛型，使用变量的类型作为参数](https://stackoverflow.com/a/2107864/281048)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-03-24T03:40:10.540

请注意对当前答案非常满意（但工作的道具！），我想要一种方法来提取我的类中的现有注释标记，而不是使用属性。在我看来，我不知道为什么微软不支持这个，因为它似乎很明显应该在那里！

首先，打开XML Documentation文件：Project Properties->Build->XML documentation file->App_Data\YourProjectName.XML

其次，将文件作为嵌入资源包含在内。构建您的项目，转到 App_Data，显示隐藏文件并包含生成的 XML 文件。选择嵌入式资源，如果较新则复制（这是可选的，您可以明确指定路径，但我认为这更简洁）。请注意，您必须使用此方法，因为该标记不存在于程序集中，这样您就无需定位 XML 的存储位置。

这是代码实现，它是已接受答案的修改版本：

```
public class SchemaDescriptionUpdater<TContext> where TContext : DbContext
{
    Type contextType;
    TContext context;
    DbTransaction transaction;
    XmlAnnotationReader reader;
    public SchemaDescriptionUpdater(TContext context)
    {
        this.context = context;
        reader = new XmlAnnotationReader();
    }
    public SchemaDescriptionUpdater(TContext context, string xmlDocumentationPath)
    {
        this.context = context;
        reader = new XmlAnnotationReader(xmlDocumentationPath);
    }

    public void UpdateDatabaseDescriptions()
    {
        contextType = typeof(TContext);
        var props = contextType.GetProperties(System.Reflection.BindingFlags.Instance | System.Reflection.BindingFlags.Public);
        transaction = null;
        try
        {
            context.Database.Connection.Open();
            transaction = context.Database.Connection.BeginTransaction();
            foreach (var prop in props)
            {
                if (prop.PropertyType.InheritsOrImplements((typeof(DbSet<>))))
                {
                    var tableType = prop.PropertyType.GetGenericArguments()[0];
                    SetTableDescriptions(tableType);
                }
            }
            transaction.Commit();
        }
        catch
        {
            if (transaction != null)
                transaction.Rollback();
            throw;
        }
        finally
        {
            if (context.Database.Connection.State == System.Data.ConnectionState.Open)
                context.Database.Connection.Close();
        }
    }

    private void SetTableDescriptions(Type tableType)
    {
        string fullTableName = context.GetTableName(tableType);
        Regex regex = new Regex(@"(\[\w+\]\.)?\[(?<table>.*)\]");
        Match match = regex.Match(fullTableName);
        string tableName;
        if (match.Success)
            tableName = match.Groups["table"].Value;
        else
            tableName = fullTableName;

        var tableAttrs = tableType.GetCustomAttributes(typeof(TableAttribute), false);
        if (tableAttrs.Length > 0)
            tableName = ((TableAttribute)tableAttrs[0]).Name;

        // set the description for the table
        string tableComment = reader.GetCommentsForResource(tableType, null, XmlResourceType.Type);
        if (!string.IsNullOrEmpty(tableComment))
            SetDescriptionForObject(tableName, null, tableComment);

        // get all of the documentation for each property/column
        ObjectDocumentation[] columnComments = reader.GetCommentsForResource(tableType);
        foreach (var column in columnComments)
        {
            SetDescriptionForObject(tableName, column.PropertyName, column.Documentation);
        }
    }

    private void SetDescriptionForObject(string tableName, string columnName, string description)
    {
        string strGetDesc = "";
        // determine if there is already an extended description
        if(string.IsNullOrEmpty(columnName))
            strGetDesc = "select [value] from fn_listextendedproperty('MS_Description','schema','dbo','table',N'" + tableName + "',null,null);";
        else
            strGetDesc = "select [value] from fn_listextendedproperty('MS_Description','schema','dbo','table',N'" + tableName + "','column',null) where objname = N'" + columnName + "';";
        var prevDesc = (string)RunSqlScalar(strGetDesc);

        var parameters = new List<SqlParameter>
        {
            new SqlParameter("@table", tableName),
            new SqlParameter("@desc", description)
        };

        // is it an update, or new?
        string funcName = "sp_addextendedproperty";
        if (!string.IsNullOrEmpty(prevDesc))
            funcName = "sp_updateextendedproperty";

        string query = @"EXEC " + funcName + @" @name = N'MS_Description', @value = @desc,@level0type = N'Schema', @level0name = 'dbo',@level1type = N'Table',  @level1name = @table";

        // if a column is specified, add a column description
        if (!string.IsNullOrEmpty(columnName))
        {
            parameters.Add(new SqlParameter("@column", columnName));
            query += ", @level2type = N'Column', @level2name = @column";
        }
        RunSql(query, parameters.ToArray());
    }

    DbCommand CreateCommand(string cmdText, params SqlParameter[] parameters)
    {
        var cmd = context.Database.Connection.CreateCommand();
        cmd.CommandText = cmdText;
        cmd.Transaction = transaction;
        foreach (var p in parameters)
            cmd.Parameters.Add(p);
        return cmd;
    }
    void RunSql(string cmdText, params SqlParameter[] parameters)
    {
        var cmd = CreateCommand(cmdText, parameters);
        cmd.ExecuteNonQuery();
    }
    object RunSqlScalar(string cmdText, params SqlParameter[] parameters)
    {
        var cmd = CreateCommand(cmdText, parameters);
        return cmd.ExecuteScalar();
    }

}

public static class ReflectionUtil
{
    public static bool InheritsOrImplements(this Type child, Type parent)
    {
        parent = ResolveGenericTypeDefinition(parent);

        var currentChild = child.IsGenericType
                               ? child.GetGenericTypeDefinition()
                               : child;

        while (currentChild != typeof(object))
        {
            if (parent == currentChild || HasAnyInterfaces(parent, currentChild))
                return true;

            currentChild = currentChild.BaseType != null
                           && currentChild.BaseType.IsGenericType
                               ? currentChild.BaseType.GetGenericTypeDefinition()
                               : currentChild.BaseType;

            if (currentChild == null)
                return false;
        }
        return false;
    }

    private static bool HasAnyInterfaces(Type parent, Type child)
    {
        return child.GetInterfaces()
            .Any(childInterface =>
            {
                var currentInterface = childInterface.IsGenericType
                    ? childInterface.GetGenericTypeDefinition()
                    : childInterface;

                return currentInterface == parent;
            });
    }

    private static Type ResolveGenericTypeDefinition(Type parent)
    {
        var shouldUseGenericType = true;
        if (parent.IsGenericType && parent.GetGenericTypeDefinition() != parent)
            shouldUseGenericType = false;

        if (parent.IsGenericType && shouldUseGenericType)
            parent = parent.GetGenericTypeDefinition();
        return parent;
    }
}

public static class ContextExtensions
{
    public static string GetTableName(this DbContext context, Type tableType)
    {
        MethodInfo method = typeof(ContextExtensions).GetMethod("GetTableName", new Type[] { typeof(DbContext) })
                         .MakeGenericMethod(new Type[] { tableType });
        return (string)method.Invoke(context, new object[] { context });
    }
    public static string GetTableName<T>(this DbContext context) where T : class
    {
        ObjectContext objectContext = ((IObjectContextAdapter)context).ObjectContext;

        return objectContext.GetTableName<T>();
    }

    public static string GetTableName<T>(this ObjectContext context) where T : class
    {
        string sql = context.CreateObjectSet<T>().ToTraceString();
        Regex regex = new Regex("FROM (?<table>.*) AS");
        Match match = regex.Match(sql);

        string table = match.Groups["table"].Value;
        return table;
    }
} 
```

从 Visual Studio 生成的 XML 文档文件中获取注释标记的类：

```
public class XmlAnnotationReader
{
    public string XmlPath { get; protected internal set; }
    public XmlDocument Document { get; protected internal set; }

    public XmlAnnotationReader()
    {
        var assembly = Assembly.GetExecutingAssembly();
        string resourceName = String.Format("{0}.App_Data.{0}.XML", assembly.GetName().Name);
        this.XmlPath = resourceName;
        using (Stream stream = assembly.GetManifestResourceStream(resourceName))
        {
            using (StreamReader reader = new StreamReader(stream))
            {
                XmlDocument doc = new XmlDocument();
                //string result = reader.ReadToEnd();
                doc.Load(reader);
                this.Document = doc;
            }
        }
    }

    public XmlAnnotationReader(string xmlPath)
    {
        this.XmlPath = xmlPath;
        if (File.Exists(xmlPath))
        {
            XmlDocument doc = new XmlDocument();
            doc.Load(this.XmlPath);
            this.Document = doc;
        }
        else
            throw new FileNotFoundException(String.Format("Could not find the XmlDocument at the specified path: {0}\r\nCurrent Path: {1}", xmlPath, Assembly.GetExecutingAssembly().Location));
    }

    /// <summary>
    /// Retrievethe XML comments documentation for a given resource
    /// Eg. ITN.Data.Models.Entity.TestObject.MethodName
    /// </summary>
    /// <returns></returns>
    public string GetCommentsForResource(string resourcePath, XmlResourceType type)
    {

        XmlNode node = Document.SelectSingleNode(String.Format("//member[starts-with(@name, '{0}:{1}')]/summary", GetObjectTypeChar(type), resourcePath));
        if (node != null)
        {
            string xmlResult = node.InnerText;
            string trimmedResult = Regex.Replace(xmlResult, @"\s+", " ");
            return trimmedResult;
        }
        return string.Empty;
    }

    /// <summary>
    /// Retrievethe XML comments documentation for a given resource
    /// Eg. ITN.Data.Models.Entity.TestObject.MethodName
    /// </summary>
    /// <returns></returns>
    public ObjectDocumentation[] GetCommentsForResource(Type objectType)
    {
        List<ObjectDocumentation> comments = new List<ObjectDocumentation>();
        string resourcePath = objectType.FullName;

        PropertyInfo[] properties = objectType.GetProperties();
        FieldInfo[] fields = objectType.GetFields();
        List<ObjectDocumentation> objectNames = new List<ObjectDocumentation>();
        objectNames.AddRange(properties.Select(x => new ObjectDocumentation() { PropertyName = x.Name, Type = XmlResourceType.Property }).ToList());
        objectNames.AddRange(properties.Select(x => new ObjectDocumentation() { PropertyName = x.Name, Type = XmlResourceType.Field }).ToList());

        foreach (var property in objectNames)
        {
            XmlNode node = Document.SelectSingleNode(String.Format("//member[starts-with(@name, '{0}:{1}.{2}')]/summary", GetObjectTypeChar(property.Type), resourcePath, property.PropertyName ));
            if (node != null)
            {
                string xmlResult = node.InnerText;
                string trimmedResult = Regex.Replace(xmlResult, @"\s+", " ");
                property.Documentation = trimmedResult;
                comments.Add(property);
            }
        }
        return comments.ToArray();
    }

    /// <summary>
    /// Retrievethe XML comments documentation for a given resource
    /// </summary>
    /// <param name="objectType">The type of class to retrieve documenation on</param>
    /// <param name="propertyName">The name of the property in the specified class</param>
    /// <param name="resourceType"></param>
    /// <returns></returns>
    public string GetCommentsForResource(Type objectType, string propertyName, XmlResourceType resourceType)
    {
        List<ObjectDocumentation> comments = new List<ObjectDocumentation>();
        string resourcePath = objectType.FullName;

        string scopedElement = resourcePath;
        if (propertyName != null && resourceType != XmlResourceType.Type)
            scopedElement += "." + propertyName;
        XmlNode node = Document.SelectSingleNode(String.Format("//member[starts-with(@name, '{0}:{1}')]/summary", GetObjectTypeChar(resourceType), scopedElement));
        if (node != null)
        {
            string xmlResult = node.InnerText;
            string trimmedResult = Regex.Replace(xmlResult, @"\s+", " ");
            return trimmedResult;
        }
        return string.Empty;
    }

    private string GetObjectTypeChar(XmlResourceType type)
    {
        switch (type)
        {
            case XmlResourceType.Field:
                return "F";
            case XmlResourceType.Method:
                return "M";
            case XmlResourceType.Property:
                return "P";
            case XmlResourceType.Type:
                return "T";

        }
        return string.Empty;
    }
}

public class ObjectDocumentation
{
    public string PropertyName { get; set; }
    public string Documentation { get; set; }
    public XmlResourceType Type { get; set; }
}

public enum XmlResourceType
{
    Method,
    Property,
    Field,
    Type
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-02T19:00:05.963

你能不使用这个`ExceuteSqlCommand`方法吗？在这里，您可以显式定义要在表中添加的任何元属性。

[http://msdn.microsoft.com/en-us/library/system.data.entity.database.executesqlcommand(v=vs.103).aspx](http://msdn.microsoft.com/en-us/library/system.data.entity.database.executesqlcommand(v=vs.103).aspx)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-03-02T21:03:01.103

谢谢**Mahmoodvcs先生**的出色解决方案。允许我修改它，只需将“DisplayAttribute”替换为“DescriptionAttribute”即可：

```
[Display(Name="Description here")] 
```

你将使用：

```
[Description("Description here")] 
```

所以它也包括表格。

```
 public class DbDescriptionUpdater<TContext>
   where TContext : System.Data.Entity.DbContext
{
    public DbDescriptionUpdater(TContext context)
    {
        this.context = context;
    }

    Type contextType;
    TContext context;
    DbTransaction transaction;
    public void UpdateDatabaseDescriptions()
    {
        contextType = typeof(TContext);
        this.context = context;
        var props = contextType.GetProperties(System.Reflection.BindingFlags.Instance | System.Reflection.BindingFlags.Public);
        transaction = null;
        try
        {
            context.Database.Connection.Open();
            transaction = context.Database.Connection.BeginTransaction();
            foreach (var prop in props)
            {
                if (prop.PropertyType.InheritsOrImplements((typeof(DbSet<>))))
                {
                    var tableType = prop.PropertyType.GetGenericArguments()[0];
                    SetTableDescriptions(tableType);
                }
            }
            transaction.Commit();
        }
        catch
        {
            if (transaction != null)
                transaction.Rollback();
            throw;
        }
        finally
        {
            if (context.Database.Connection.State == System.Data.ConnectionState.Open)
                context.Database.Connection.Close();
        }
    }

    private void SetTableDescriptions(Type tableType)
    {
        string fullTableName = context.GetTableName(tableType);
        Regex regex = new Regex(@"(\[\w+\]\.)?\[(?<table>.*)\]");
        Match match = regex.Match(fullTableName);
        string tableName;
        if (match.Success)
            tableName = match.Groups["table"].Value;
        else
            tableName = fullTableName;

        var tableAttrs = tableType.GetCustomAttributes(typeof(TableAttribute), false);
        if (tableAttrs.Length > 0)
            tableName = ((TableAttribute)tableAttrs[0]).Name;
        var table_attrs = tableType.GetCustomAttributes(typeof(DescriptionAttribute), false);
        if (table_attrs != null && table_attrs.Length > 0)
            SetTableDescription(tableName, ((DescriptionAttribute)table_attrs[0]).Description);
        foreach (var prop in tableType.GetProperties(System.Reflection.BindingFlags.Public | System.Reflection.BindingFlags.Instance))
        {
            if (prop.PropertyType.IsClass && prop.PropertyType != typeof(string))
                continue;
            var attrs = prop.GetCustomAttributes(typeof(DescriptionAttribute), false);
            if (attrs != null && attrs.Length > 0)
                SetColumnDescription(tableName, prop.Name, ((DescriptionAttribute)attrs[0]).Description);
        }
    }

    private void SetColumnDescription(string tableName, string columnName, string description)
    {

        string strGetDesc = "select [value] from fn_listextendedproperty('MS_Description','schema','dbo','table',N'" + tableName + "','column',null) where objname = N'" + columnName + "';";
        var prevDesc = RunSqlScalar(strGetDesc);
        if (prevDesc == null)
        {
            RunSql(@"EXEC sp_addextendedproperty 
                @name = N'MS_Description', @value = @desc,
                @level0type = N'Schema', @level0name = 'dbo',
                @level1type = N'Table',  @level1name = @table,
                @level2type = N'Column', @level2name = @column;",
                                                   new SqlParameter("@table", tableName),
                                                   new SqlParameter("@column", columnName),
                                                   new SqlParameter("@desc", description));
        }
        else
        {
            RunSql(@"EXEC sp_updateextendedproperty 
                    @name = N'MS_Description', @value = @desc,
                    @level0type = N'Schema', @level0name = 'dbo',
                    @level1type = N'Table',  @level1name = @table,
                    @level2type = N'Column', @level2name = @column;",
                                                   new SqlParameter("@table", tableName),
                                                   new SqlParameter("@column", columnName),
                                                   new SqlParameter("@desc", description));
        }
    }
    private void SetTableDescription(string tableName,  string description)
    {

        string strGetDesc = "select [value] from fn_listextendedproperty('MS_Description','schema','dbo','table',N'" + tableName + "',null,null);";
        var prevDesc = RunSqlScalar(strGetDesc);
        if (prevDesc == null)
        {
            RunSql(@"EXEC sp_addextendedproperty 
                    @name = N'MS_Description', @value = @desc,
                    @level0type = N'Schema', @level0name = 'dbo',
                    @level1type = N'Table',  @level1name = @table;",
                                                   new SqlParameter("@table", tableName),
                                                   new SqlParameter("@desc", description));
        }
        else
        {
            RunSql(@"EXEC sp_updateextendedproperty 
                    @name = N'MS_Description', @value = @desc,
                    @level0type = N'Schema', @level0name = 'dbo',
                    @level1type = N'Table',  @level1name = @table;",
                                                   new SqlParameter("@table", tableName),
                                                   new SqlParameter("@desc", description));
        }
    }
    DbCommand CreateCommand(string cmdText, params SqlParameter[] parameters)
    {
        var cmd = context.Database.Connection.CreateCommand();
        cmd.CommandText = cmdText;
        cmd.Transaction = transaction;
        foreach (var p in parameters)
            cmd.Parameters.Add(p);
        return cmd;
    }
    void RunSql(string cmdText, params SqlParameter[] parameters)
    {
        var cmd = CreateCommand(cmdText, parameters);
        cmd.ExecuteNonQuery();
    }
    object RunSqlScalar(string cmdText, params SqlParameter[] parameters)
    {
        var cmd = CreateCommand(cmdText, parameters);
        return cmd.ExecuteScalar();
    }

}
public static class ReflectionUtil
{

    public static bool InheritsOrImplements(this Type child, Type parent)
    {
        parent = ResolveGenericTypeDefinition(parent);

        var currentChild = child.IsGenericType
                               ? child.GetGenericTypeDefinition()
                               : child;

        while (currentChild != typeof(object))
        {
            if (parent == currentChild || HasAnyInterfaces(parent, currentChild))
                return true;

            currentChild = currentChild.BaseType != null
                           && currentChild.BaseType.IsGenericType
                               ? currentChild.BaseType.GetGenericTypeDefinition()
                               : currentChild.BaseType;

            if (currentChild == null)
                return false;
        }
        return false;
    }

    private static bool HasAnyInterfaces(Type parent, Type child)
    {
        return child.GetInterfaces()
            .Any(childInterface =>
            {
                var currentInterface = childInterface.IsGenericType
                    ? childInterface.GetGenericTypeDefinition()
                    : childInterface;

                return currentInterface == parent;
            });
    }

    private static Type ResolveGenericTypeDefinition(Type parent)
    {
        var shouldUseGenericType = true;
        if (parent.IsGenericType && parent.GetGenericTypeDefinition() != parent)
            shouldUseGenericType = false;

        if (parent.IsGenericType && shouldUseGenericType)
            parent = parent.GetGenericTypeDefinition();
        return parent;
    }
}

public static class ContextExtensions
{
    public static string GetTableName(this DbContext context, Type tableType)
    {
        MethodInfo method = typeof(ContextExtensions).GetMethod("GetTableName", new Type[] { typeof(DbContext) })
                         .MakeGenericMethod(new Type[] { tableType });
        return (string)method.Invoke(context, new object[] { context });
    }
    public static string GetTableName<T>(this DbContext context) where T : class
    {
        ObjectContext objectContext = ((IObjectContextAdapter)context).ObjectContext;

        return objectContext.GetTableName<T>();
    }

    public static string GetTableName<T>(this ObjectContext context) where T : class
    {
        string sql = context.CreateObjectSet<T>().ToTraceString();
        Regex regex = new Regex("FROM (?<table>.*) AS");
        Match match = regex.Match(sql);

        string table = match.Groups["table"].Value;
        return table;
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-06-29T09:44:01.447

虽然问题是关于 EF4，但此答案针对的是 EF6，考虑到自提出问题以来经过的时间，这应该是适当的。

我认为评论属于迁移`Up`和`Down`方法，而不是某种`Seed`方法。

因此，正如@MichaelBrown 所建议的那样，首先启用 XML 文档输出并将文档文件作为嵌入式资源包含在您的项目中。

然后，让我们使用`Convention`. 需要对多行注释和消除过多的空白等内容进行一些调整。

```
public class CommentConvention : Convention
{
    public const string NewLinePlaceholder = "<<NEWLINE>>";

    public CommentConvention()
    {
        var docuXml = new XmlDocument();

        // Read the documentation xml
        using (var commentStream = Assembly.GetExecutingAssembly().GetManifestResourceStream("Namespace.Documentation.xml"))
        {
            docuXml.Load(commentStream);
        }

        // configure class/table comment
        Types()
            .Having(pi => docuXml.SelectSingleNode($"//member[starts-with(@name, 'T:{pi?.FullName}')]/summary"))
            .Configure((c, a) =>
            {
                c.HasTableAnnotation("Comment", GetCommentTextWithNewlineReplacement(a));
            });

        // configure property/column comments
        Properties()
            .Having(pi =>
                docuXml.SelectSingleNode(
                    $"//member[starts-with(@name, 'P:{pi?.DeclaringType?.FullName}.{pi?.Name}')]/summary"))
            .Configure((c, a) => { c.HasColumnAnnotation("Comment", GetCommentTextWithNewlineReplacement(a)); });
    }

    // adjust the documentation text to handle newline and whitespace
    private static string GetCommentTextWithNewlineReplacement(XmlNode a)
    {
        if (string.IsNullOrWhiteSpace(a.InnerText))
        {
            return null;
        }
        return string.Join(
            NewLinePlaceholder,
            a.InnerText.Trim()
                .Split(new string[] {"\r\n", "\r", "\n"}, StringSplitOptions.None)
                .Select(line => line.Trim()));
    }
} 
```

`OnModelCreating`在方法中注册约定。

预期结果：创建新迁移时，注释将包含为注释，例如

```
CreateTable(
    "schema.Table",
    c => new
        {
            Id = c.Decimal(nullable: false, precision: 10, scale: 0, identity: true,
                annotations: new Dictionary<string, AnnotationValues>
                {
                    { 
                        "Comment",
                        new AnnotationValues(oldValue: null, newValue: "Commenting the Id Column")
                    },
                }),
// ... 
```

继续第二部分：调整 SQL 生成器以根据注释创建注释。

这个是给Oracle的，不过MS Sql应该很相似

```
class CustomOracleSqlCodeGen : MigrationSqlGenerator
{
    // the actual SQL generator
    private readonly MigrationSqlGenerator _innerSqlGenerator;

    public CustomOracleSqlCodeGen(MigrationSqlGenerator innerSqlGenerator)
    {
        _innerSqlGenerator = innerSqlGenerator;
    }

    public override IEnumerable<MigrationStatement> Generate(IEnumerable<MigrationOperation> migrationOperations, string providerManifestToken)
    {
        var ms = _innerSqlGenerator.Generate(AddCommentSqlStatements(migrationOperations), providerManifestToken);

        return ms;
    }

    // generate additional SQL operations to produce comments
    IEnumerable<MigrationOperation> AddCommentSqlStatements(IEnumerable<MigrationOperation> migrationOperations)
    {
        foreach (var migrationOperation in migrationOperations)
        {
            // the original inputted operation
            yield return migrationOperation;

            // create additional operations to produce comments
            if (migrationOperation is CreateTableOperation cto)
            {
                foreach (var ctoAnnotation in cto.Annotations.Where(x => x.Key == "Comment"))
                {
                    if (ctoAnnotation.Value is string annotation)
                    {
                        var commentString = annotation.Replace(
                            CommentConvention.NewLinePlaceholder,
                            Environment.NewLine);

                        yield return new SqlOperation($"COMMENT ON TABLE {cto.Name} IS '{commentString}'");
                    }
                }

                foreach (var columnModel in cto.Columns)
                {
                    foreach (var columnModelAnnotation in columnModel.Annotations.Where(x => x.Key == "Comment"))
                    {
                        if (columnModelAnnotation.Value is AnnotationValues annotation)
                        {
                            var commentString = (annotation.NewValue as string)?.Replace(
                                CommentConvention.NewLinePlaceholder,
                                Environment.NewLine);

                            yield return new SqlOperation(
                                $"COMMENT ON COLUMN {cto.Name}.{columnModel.Name} IS '{commentString}'");
                        }
                    }
                }
            }
        }
    }
} 
```

在`DbMigrationsConfiguration`构造函数中，注册新的代码生成器（同样，这是特定于 oracle 的，但对于其他 SQL 提供程序将类似）

```
internal sealed class Configuration : DbMigrationsConfiguration<EntityFramework.Dev.ZdbTestContext>
{
    public Configuration()
    {
        AutomaticMigrationsEnabled = false;
        var cg = GetSqlGenerator("Oracle.ManagedDataAccess.Client");
        SetSqlGenerator("Oracle.ManagedDataAccess.Client", new CustomOracleSqlCodeGen(cg));
    }
    // ... 
```

`Up`预期结果：和方法中的注释注释`Down`被转换为改变数据库中注释的 SQL 语句。

# ios - Delphi XE2 应用程序在 IPAD 上没有响应

> ID：10080602
> 
> 赞同：10
> 
> 时间：2012-04-09T22:18:47.387
> 
> 标签：ios, xcode, ipad, delphi, delphi-xe2

我尝试使用 Delphi XE2 开发 iPad 3 专业应用程序。
配置没问题。
我在 VMWare 上使用带有 Windows 7 的 MacBook Pro 工作。
我为 iOS 创建了一个高清应用程序。
我放了一个计时器、两个标签和一个按钮。
定时器刷新label1上的时间，按钮的“on_click”事件改变label2的标签。
它是用 Delphi 编译的。
我导出到共享文件夹中的 Xcode。
我启动 Xcode 并尝试使用 iPad 模拟器。
一切正常。
我尝试在真正的 iPad 上运行，应用程序已启动，但：
* 表单显示为一个非常小
的面板 * 计时器似乎不起作用，但如果我旋转 IPAD，屏幕会刷新并显示时间。
* 我的主要问题：如果我点击按钮，什么也不会发生。
我尝试了很多事件，都在 delphi 中工作，在 iPad 模拟器中，但不是在真正的 iPad 上。

那么，iPad 上的火灾事件有哪些好的选择呢？提前致谢

编辑：
我尝试在 iPhone 4S 上运行相同的应用程序，它运行良好！
问题只出在 iPad 3 上。我没有 iPad 1 或 2 进行测试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T13:37:19.727

我终于解决了这个麻烦。
Delphi XE2 update 4的安装需要安装XCODE 4.2。
如果您没有它，您将无法安装 FireMonkey-iOS.dmg。
您必须同时拥有最新版本的 XCODE 4.3.2。
当然，要小心，Xcode 的版本是什么！
很容易理解，要使用新的 IPAD (3)，您必须至少使用 Xcode 4.3.2。
如果您使用 Xcode 4.2，您的项目将被编译、运行但现在响应，因为它不了解 iPad 3。
享受吧。

# javascript - 使用 charCodeAt() 将特殊字符 '\u0098' 读取为 '\u02dc'

> ID：10080605
> 
> 赞同：2
> 
> 时间：2012-04-09T22:19:07.280
> 
> 标签：javascript, servlets, unicode, character-encoding, iso-8859-1

我正在从 Java 创建 test.js，如下所示。Test.js 实现了函数 d()，它接收作为参数的特殊字符 ∼ ('\u0098');

函数 d() 应显示此特殊字符的 charCodeAt()，即 152。但是，它显示 732。

请注意，**字符 152 和 732 都由特殊字符 ~ 表示**，如下所示。

[http://www.fileformat.info/info/unicode/char/098/index.htm](http://www.fileformat.info/info/unicode/char/098/index.htm)

[http://www.fileformat.info/info/unicode/char/2dc/index.htm](http://www.fileformat.info/info/unicode/char/2dc/index.htm)

如何强制函数 d() 显示 152 而不是 732？（字符集问题？）。谢谢

**测试.JAVA**

```
public void doPost(HttpServletRequest req, HttpServletResponse res)
throws ServletException, IOException
{
    res.setHeader("Content-Type", "text/javascript;charset=ISO-8859-1");
    res.setHeader("Content-Disposition","attachment;filename=test.js");
    res.setCharacterEncoding("ISO-8859-1");
    PrintWriter printer=res.getWriter();
    printer.write("function d(a){a=(a+\"\").split(\"\");alert(a[0].charCodeAt(0));};d(\""); // Writes beginning of d() function
    printer.write('\u0098'); // Writes special character as parameter of d()
    printer.write("\");"); // Writes end of d() function
    printer.close();
} 
```

**TEST.JS 由 TEST.JAVA 创建**

```
function d(a)
{
  a=(a+"").split("");
  alert(a[0].charCodeAt(0));
};
d("˜"); // Note special character representing '\u0098' 
```

**测试.HTML**

```
<html>
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /></head>
<body>
<script type="text/javascript" charset="ISO-8859-1" src="test.js"></script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T23:59:09.660

> 请注意，字符 152 和 732 都由特殊字符 ~ 表示，如下所示。

并不真地。`˜`是明确的字符 U+02DC (732)，`charCodeAt`做正确的事也是如此。字符 U+0098 (152) 是一个几乎从不使用的隐形控制代码。

诀窍在于`"ISO-8859-1"`它对 Java 和 Web 浏览器具有不同的含义。对于 Java，它确实是 ISO-8859-1 标准，它精确映射到 Unicode 的前 256 个代码点。这包括在 128–159 的一系列很少使用的 C1 控制字符。

然而，对于 Web 浏览器，`"ISO-8859-1"`实际上意味着 Windows 代码页 1252（西欧），一种将各种有用字符放在 128-159 块中的编码。这种行为源于早期的仅使用机器默认代码页的 Web 浏览器。当适当的 Unicode 和编码支持被添加到浏览器时，兼容性问题要求继续支持 Windows 字符，尽管它们被错误地标记为 ISO-8859 格式。

因此，当您在 ISO-8859-1 中从 Java 中写入 U+0098 字符时，您会得到一个 0x98 字节，然后浏览器会将其读取为 U+02DC。这通常是无害的，因为实际上没有人想要使用 U+0080–U+009F 范围内的 C1 控制代码。但这肯定令人困惑。

这个古老的怪癖，以及将`&#...;`128-159 范围内的字符引用视为 cp1252 字节的相关问题，最终被记录并标准化为 HTML5 的一部分，但仅适用于 HTML 解析规则。（不是 XHTML5，因为它遵循更合理的 XML 规则。）这就是为什么引用的 fileformat.info 页面*似乎*误导性地说 U+0098 呈现为`˜`.

如果您*确实*需要提取字符的 cp1252 字节数，则必须使用查找表来帮助您，因为 JavaScript 看不到该信息。例如：

```
var CP1252EXTRAS= '\u20ac\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u0152\u017d\u017d\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u0153\u017e\u0178';

function getCodePage1252Byte(s) {
    var ix= CP1252EXTRAS.indexOf(s);
    if (ix!==-1)
        return 128+ix;
    var c= s.charCodeAt(0);
    if (c<128 || c>=160 && c<256)
        return c;
    return -1;
} 
```

你可能不想这样做。无论如何，通常答案不是使用 ISO-8859-1，而是坚持使用良好的旧 UTF-8（The Only Sensible Encoding™）。

无论如何，`<script charset="...">`不​​是每个浏览器都支持，也不是每个浏览器`Content-Type: text/javascript;charset=...`都支持。没有可靠的方法以不同的编码为包含页面提供 JavaScript。如果您不是 100% 每个包含页面都将使用与脚本相同的编码，那么唯一安全的方法是保持 JavaScript ASCII 安全，输出 JavaScript`\unnnn`序列而不是文字字节。

（兼容 ASCII 的 JSON 编码器可以帮助您做到这一点。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T22:22:51.087

尝试：

```
 printer.write('\\u0098'); 
```

JavaScript`\uNNNN`也可以理解，因此您可以使用所需的字符代码显式地形成字符串。

# php - 这是避免在新选项卡或窗口中显示弹出内容的好习惯吗？

> ID：10080607
> 
> 赞同：0
> 
> 时间：2012-04-09T22:19:12.140
> 
> 标签：php, popup, referrer

我有带有照片缩略图的页面，假设脚本是 thumbnails.php。每个图标都有一个指向 popup.php?id=nnn 的链接，该链接在弹出窗口中打开以显示更大的图像和一些信息。

我不希望用户直接访问 domain.com/popup.php?id=nnn 来获取整个窗口或选项卡中的弹出小内容。所以这个脚本首先检查引用者是否是包含缩略图的页面。如果没有，则打开 descrption.php?id=nnn。此页面旨在适应带有扩展信息的常规屏幕。我这样做主要是考虑网络爬虫。

这是一个好习惯吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:24:32.490

在过去 18 个月中，我从事的许多项目都不再打开新窗口或标签。相反，他们使用[Jquery Dialog（模式模式）](http://jqueryui.com/demos/dialog/#modal)来显示图像、html 描述或其他属性信息。

如果用户不小心关闭了错误的窗口或选项卡，或者他们只是忘记通过原始窗口返回您的网站，这允许用户留在同一页面上而不会导致他们跳出的风险。

# jquery - 如何使用 jquery onReady 禁用按钮

> ID：10080610
> 
> 赞同：0
> 
> 时间：2012-04-09T22:19:16.457
> 
> 标签：jquery, flexigrid

我在我的项目中使用 flexigrid 和 jquery。我有网格，在网格之上，我有按钮。加载页面时，我想禁用这些按钮，并根据我的条件启用其中一个按钮。

```
buttons: [
    { name: 'Batch Browse', bclass: 'browse', onpress: showBatchBrowse }, 
```

您能帮我使用 flexigrid 和 JQuery 完成这项工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T22:28:33.550

在要禁用的按钮名称末尾添加“禁用”字符串。并在您想再次活跃时将它们重命名为原始。

# objective-c - 有没有办法使用 NSString stringByFoldingWithOptions 将单个法语“œ”字符展开为“oe”？

> ID：10080613
> 
> 赞同：3
> 
> 时间：2012-04-09T22:20:10.810
> 
> 标签：objective-c, ios, cocoa, nsstring, diacritics

对于与变音符号无关的全文搜索功能，我使用以下代码将重音字符（如`é`或）`Ö`转换为小写非重音形式`e`，并且`o`

```
[[inputString stringByFoldingWithOptions: 
    NSCaseInsensitiveSearch
    + NSDiacriticInsensitiveSearch
    + NSWidthInsensitiveSearch
locale: [NSLocale currentLocale]] lowercaseString]; 
```

这行得通。但是，我发现无法转换基本形式由多个字符组成的特殊字符，例如法语`œ`（如“sœur”）或德语`ß`（如“Fluß”）。我想将它们分别转换为`oe`和`ss`。我没有找到 stringByFoldingWithOptions 的标志，也没有在网上找到任何东西。

**编辑**

`ß`实际上是由上面的代码正确处理的。它转换为`ss`.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-01-15T16:30:32.320

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T23:36:12.523

看看`CFStringTransform()`它的`kCFStringTransformToLatin`选项。我认为这可能会满足您的需求。

# iphone - 如何将操作附加到 UIPicker 更改？

> ID：10080614
> 
> 赞同：0
> 
> 时间：2012-04-09T22:20:11.000
> 
> 标签：iphone, xcode, uipickerview

我正在尝试使用基于 UIPicker 中数据集的颜色来更新 UIImageView。Picker数据变化的动作怎么办？

例如，用户在选择器中旋转一个组件，数据的变化就会自动发送。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:27:06.840

您需要为 pickerView 实现委托方法，只要`– pickerView:didSelectRow:inComponent:`pickerView 发生更改，就会调用该方法，并且您将在更改后执行“操作”。

# iphone - 本地通知和故事板

> ID：10080615
> 
> 赞同：0
> 
> 时间：2012-04-09T22:20:16.267
> 
> 标签：iphone, ios, notifications, storyboard

我想知道实现我的目标的最佳方法是什么。我有一个使用情节提要的 iPhone 应用程序，并有一个标签栏控制器作为根视图。在其中一个选项卡下，我需要显示一个嵌入在导航控制器中的视图控制器，当按下本地通知时，它的深度约为 3 张幻灯片。

关于最好的方法的任何想法？将继续尝试以一种干净的方式实现这一点，如果没有人有回应，我会发布，但在正确方向上的一些帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T19:10:05.480

这是我所追求的方法：

*   (void)setViewControllers:(NSArray *)viewControllers 动画:(BOOL)animated

由于我想使用现有的视图控制器，这些视图控制器从情节提要中为我的视图提供了布局，因此我使用它将它们拉入并初始化了我需要的东西。帮助这有助于将来的其他人。

*   (id)instantiateViewControllerWithIdentifier:(NSString *)identifier

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T02:32:04.573

我会在课堂上使用该`userInfo`属性。`UILocalNotification`使用您要显示的控制器的名称设置一个字符串。

通过以下方式捕获通知：

```
- (void)application:(UIApplication *)application didReceiveLocalNotification:(UILocalNotification *)notification 
```

在 AppDelegate 中。然后在 UILocalNotification 上搜索你保存的字符串，并使用 next 方法`UINavigationController:`

```
- (void)pushViewController:(UIViewController *)viewController animated:(BOOL)animated 
```

为了显示适当的视图控制器。如果您希望您的应用程序始终显示相同的视图控制器，则无需设置`userInfo`，您只需要实现上述`UINavigationController`方法。

希望能帮助到你。

# html - 通过 CSS 为 h1 元素设置多种字体大小

> ID：10080622
> 
> 赞同：1
> 
> 时间：2012-04-09T22:21:23.463
> 
> 标签：html, css

我需要显示一个公司名称，以便名称的“主要”部分出现在一行上并且很大，而名称的次要部分在它下方居中并且更小。由于它不是口号或“副标题”，我觉得它应该都在同一个`h1`元素中，理想情况下，通过纯 CSS 进行转换（意味着`em`如果可以避免，则没有 spans 或 s。

例子：

```
<h1>Big Bill's Custom Auto Parts</h1> 
```

应显示为：

# 大比尔

### 定制汽车配件

是否有一种纯 CSS 方式来执行此操作（即使是尚未完全支持的伪类）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T22:23:44.253

不可能，您有两个不同的标题并且可以相应地设置样式似乎更有意义。

如果`<span>`不在`<h1>`?

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-09T22:38:59.923

是否允许在标题本身包含新行？如果是这样，您可以像这样使用第一行选择器：

HTML

```
<h1>Foo bar                                                                                            
baz</h1> 
```

CSS

```
h1 {
  font-size:1em;
  white-space:pre;
}
h1:first-line {
  font-size:3em;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-09T22:28:44.033

不使用额外标题的最短解决方案是使用 span 元素：

```
<h1><span>Big Bill's</span> Custom Auto Parts</h1> 
```

CSS：

```
h1.span {
  /* styling rules */
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T22:30:44.267

如果您可以使用 a 来换行`<br/>`，那么您可以使用[`::first-line`伪元素](https://developer.mozilla.org/en/CSS/%3a%3afirst-line)来完成此操作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-09T22:43:25.957

你说你想用纯 CSS 的方式来做，分离内容和表现。没有额外`spans`的，没有`br`。我理解，但如果您考虑您的问题，您想创建**基于 content 的演示规则**。这有意义吗？这不是您想要避免的将内容与演示文稿混合吗？

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2016-04-22T02:35:36.307

我在这个线程中尝试了其他东西，但这终于奏效了。

```
<h3>Tutorials <span style="font-size:14px;">(2 of them)</span></h3> 
```

# rendering - 检测渲染速度的准确方法

> ID：10080626
> 
> 赞同：0
> 
> 时间：2012-04-09T22:22:17.560
> 
> 标签：rendering, render, p2p

我目前正在集思广益，想出一个涉及 p2p 渲染农场的想法，有点像 renderfarm.fi，但区别在于您为服务付费，而处理池的贡献者获得报酬。目前渲染农场根据 GHZ/h 测量价格，但是当计算机渲染不受信任时，有没有一种好方法可以测量计算机的等效 GHZ/h，考虑到计算机可能部分加载其他程序会减慢实际渲染时间， ETC？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T22:31:36.780

Because your worker process can ask the OS counters how much execution time they've received and that can be matched up with progress on the work package you can pay out based upon work-units-completed, but charge in GHz/h. You know you can't trust the user's clock (or anything else for that matter), but you can verify the work units returned and approximate their computational complexity by combining the program counters from multiple peers.

You have no way to know for sure that the system is or is not particularly loaded, but you do know if work went out and came back. However you will have to verify that the work was done correctly. Probably means over-provisioning and running every render twice on two different machines to ensure someone isn't inserting garbage results that are faster to compute.

Good luck. I don't know how you'll be able to beat the likes of Amazon with them charging ~$0.10 per GHz/h.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T23:22:45.583

操作系统可以并且很可能会测量进程占用的实际*CPU 时间。*因此，这可以用来衡量进程本身在机器 CPU 上运行所花费的*实际时间。*由于其他进程在后台运行，CPU 时间不会向任何方向倾斜，因此非常适合此目的。

CPU 时间本身就是此类渲染服务出售的资源，因此按用户/客户端对其进行衡量，然后根据渲染农场的用户/客户端花费的 CPU 时间相应地为服务定价是合乎逻辑的。

# javascript - 意外的关闭行为

> ID：10080628
> 
> 赞同：1
> 
> 时间：2012-04-09T22:22:26.593
> 
> 标签：javascript, closures

我计划在正在构建的框架中做“扩展点”，我正在寻找一种方法如何为扩展提供“核心”，以便它可以添加功能但不暴露可以任意操作的核心对象（我知道提供接口是更好的主意）但是，当我在测试（以及学习）时，我想知道为什么会发生这种情况：

```
(function() {
    var core = {'bar': 'foo'}
    function getCore() {return core;}
    window.kit = {
        core: core,
        getCore: getCore
    }
}());

//initial check
console.log(kit.core)
console.log(kit.getCore());

//change the bar
kit.core.bar = 'baz';

//we will both see 'baz'
console.log(kit.core)
console.log(kit.getCore());

//null the core
kit.core = null;

//this time...
console.log(kit.core)       //core is null on this one
console.log(kit.getCore()); //why is the core still there on this one?​​​​​​​​​​​​ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T22:33:51.320

了解对象和对象引用之间的区别很重要。

一开始，`core`和`kit.core`引用同一个对象。对对象本身的任何更改都将反映在对该对象的所有引用中。但是，如果其中一个参考发生更改，其他参考不会自动更改。

这一行：

```
kit.core.bar = 'baz'; 
```

`kit.core`修改和引用的对象`core`。引用不会改变，但对象会改变。这反映在两个参考文献中。

这一行：

```
kit.core = null; 
```

修改对 reference`kit.core`的引用`null`但不更改`core`，它仍然引用原始对象。对象本身不会改变。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T22:24:36.593

“getCore()”函数是指名为“core”的局部变量，而不是名为“core”的对象属性。

如果您将“getCore()”更改为返回`this.core`而不是返回，`core`那么您会看到您所期望的。

# php - 如何在 mysql 中管理多个用户的工作/打开项目记录？

> ID：10080634
> 
> 赞同：0
> 
> 时间：2012-04-09T22:22:52.243
> 
> 标签：php, mysql, codeigniter

我有一些想法，但认为我可能会触及一个共同的话题（虽然我没有找到它）......

每周我们有大约 500 条单个用户正在处理的记录，我们使用分页设置为单个记录，当记录更新时页面重新加载下一条记录。工作简单易行。- *Codeigniter，PHP*。

啊，但是现在我希望多个用户在同一组记录上工作而不抓取同一记录，直到他们筋疲力尽，*记录不是用户。*

是否有这样做的一般惯例？

袖手旁观，我可能会将`status`工作记录更改`pending`为正在加载。我错过了什么吗？有没有更好/更清洁的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T08:34:50.900

除了在记录上设置某种“锁定”之外，我真的没有看到任何其他解决方案。您还可以考虑为每个用户提前锁定 10 条记录，然后为他们创建一个子队列。尽管在这种情况下，您可能还应该在锁上设置时间戳，并在一段时间后解锁它们（这样某人就不会带着 10 条其他人无法处理的记录去度假）

# wordpress - 自定义模板上的 Wordpress 分页问题

> ID：10080636
> 
> 赞同：0
> 
> 时间：2012-04-09T22:23:18.827
> 
> 标签：wordpress

以为这很简单，但不知何故我似乎无法弄清楚。我检查了 CSS 以确保没有设置任何隐藏显示，但似乎并非如此。我已经创建了 10 个不同的列表，只是试图强制分页。

在此页面上：http: [//moemar.mailmoto.com/showcase](http://moemar.mailmoto.com/showcase)

我只是想在我现在显示 3 个帖子的地方设置自定义显示，我也在设置下进行了设置，但是这个显示是使用查询参数强制的。

```
<?php $temp;
    $temp = $wp_query;
    $wp_query = null;
    $wp_query = new WP_Query();
    $wp_query->query('category_name=Listings'.'&posts_per_page=3'.'&paged='.$paged); ?> 
```

对于显示我正在使用：

```
<?php if (have_posts()) : while ($wp_query->have_posts()) : $wp_query->the_post(); ?>
<?php the_content(); ?>
<?php endwhile; ?> 
```

然后在循环下面我有：

```
<div class="navigation">
<div class="alignleft"><?php previous_posts_link('&laquo; Previous'); ?></div>
<div class="alignright"><?php next_posts_link('More &raquo;'); ?></div>
</div>

<?php $wp_query = null; $wp_query = $temp; ?> 
```

任何想法为什么我的链接根本不会显示？我可以在检查时看到 div 很好，但没有分页选项的迹象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T22:49:14.063

您可能需要从 WP_Query 传递最大页数。尝试将其添加到函数调用中：

```
<?php previous_posts_link('&laquo; Previous', $wp_query->max_num_pages); ?>
<?php next_posts_link('More &raquo;', $wp_query->max_num_pages); ?> 
```

# php - PHP 文件上传不起作用的可能原因

> ID：10080637
> 
> 赞同：0
> 
> 时间：2012-04-09T22:23:23.163
> 
> 标签：php, file-upload

这是HTML：

```
<h1>Upload Custom Logo</h1>
<form action="settings.php" enctype="multipart/form-data" method="post">
<input type="file" name="Logo" />
<input type="submit" value="Upload" name="logoUpload" />
</form> 
```

这是PHP：

```
<?php /* Handle Logo Upload */
if($_POST['logoUpload']) {

$target_path = "uploads/";
$Logo = $_FILES['Logo']['name'];

$target_path = $target_path . basename( $_FILES['Logo']['name']); 

if(move_uploaded_file($_FILES['uploadedfile']['tmp_name'], $target_path)) {
    echo '<div class="statusUpdate">The file '.  basename( $_FILES['Logo']['name']). 
        ' has been uploaded</div>';
    }   

} else{
    echo '<div class="statusUpdate">There was an error uploading the file to: '.$target_path.', please try again!  Error Code was: '.$_FILES['Logo']['error'].'</div>';
}

}
?> 
```

它总是转到该代码的“else”语句，我在与此 php 文件设置为 777 文件权限的同一目录中有一个上传文件夹。我正在测试上传的图像大小小于 10KB。但是 move_uploaded_file() 总是失败，并且除了使用 else 语句生成的自定义错误消息之外，它不会返回任何错误消息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T22:28:59.010

You're referring to the file in the `$_FILES` array by two different names -
`$Logo = $_FILES['Logo']['name'];`
`move_uploaded_file($_FILES['uploadedfile']['tmp_name'], $target_path)`

Which one is it? `Logo` or `uploadedfile` ?

You're probably referencing an array index which doesn't exist.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T22:27:28.263

可能的原因：

*   文件的上传以某种方式失败。
*   您无权将文件移动到目标路径。

正如 PHP.NET 所说：

> 如果 filename 不是有效的上传文件，则不会发生任何操作，并且 move_uploaded_file() 将返回 FALSE。
> 
> 如果 filename 是有效的上传文件，但由于某种原因无法移动，则不会发生任何操作，并且 move_uploaded_file() 将返回 FALSE。此外，还会发出警告。

参考： http: [//php.net/manual/en/function.move-uploaded-file.php](http://php.net/manual/en/function.move-uploaded-file.php)

# jquery - 在jQuery中触发多个按键并按住事件的方法

> ID：10080644
> 
> 赞同：13
> 
> 时间：2012-04-09T22:23:48.293
> 
> 标签：jquery, keyboard

寻找一种使用 jQuery 模拟多个按键的方法。例如 ALT+F1（按住 alt 并按 F1）。

由于以下原因，我设法模拟了 F1 按键： [Definitive way to trigger keypress events with jQuery](https://stackoverflow.com/questions/832059/definitive-way-to-trigger-keypress-events-with-jquery)

寻找这样的东西：

```
$(".f1").click(function() {   
    var e = jQuery.Event("keydown");
    e.keyCode = 18; // ALT key pressed
    // while ALT key is pressed, hit the F1 Key
    $("input").trigger(e, function(){
        var e = jQuery.Event("keydown");
        e.which = 112; // F1 key
        $("input").trigger(e);
        });
}); 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-09T23:40:42.220

使用修饰键`alt`、`ctrl`和`shift`，您可以专门为它们使用事件修饰符：

```
$(".f1").click(function() {
    var e = jQuery.Event("keydown");
    e.which = 112;       // # F1 code value
    e.altKey = true;     // Alt key pressed
    $("input").trigger(e);
}); 
```

演示：http: [//jsfiddle.net/jtbowden/2kcrg/](http://jsfiddle.net/jtbowden/2kcrg/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T23:42:29.593

1.  你不能直接模拟按键事件，你只能触发绑定到它们的 javascript 处理程序。因此，考虑简单地编写一个函数来封装您希望按键执行的操作，让按键处理程序调用该函数，并通过简单地调用相同的函数来“模拟”其他地方的按键。
2.  如果你真的必须模拟 ALT-F1 和类似的，你需要在`keypress`事件中设置其他属性（例如`altKey`or `metaKey`），和/或按下修饰键的第一个触发`keydown`事件（在 JQuery/firefox 中，按下`ALT`给我一个`keydown`事件`e.which == 18`.)。归根结底，您只需要创建处理程序响应的相同事件。

# android - 使用 LinearLayout 分割屏幕的问题

> ID：10080645
> 
> 赞同：1
> 
> 时间：2012-04-09T22:23:50.497
> 
> 标签：android, android-layout

我在使用linearLayout分割屏幕时遇到了一个问题，我的目标是将它分割成9个Pisces - 当我开始使用LinearLayout时，我得到了以下结果：

[http://imageshack.us/photo/my-images/4/firstna.png/](http://imageshack.us/photo/my-images/4/firstna.png/)

使用以下 xml 代码：

```
 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent">
    <LinearLayout
  android:orientation="horizontal"
  android:layout_width="fill_parent"
  android:layout_height="fill_parent"
  android:layout_weight="1"
  android:baselineAligned="false">
    <FrameLayout
      android:gravity="center_horizontal"
      android:background="#aa0000"
      android:layout_width="wrap_content"
      android:layout_height="fill_parent"
      android:layout_weight="1">
    </FrameLayout>
    <FrameLayout
      android:gravity="center_horizontal"
      android:background="#00aa00"
      android:layout_width="wrap_content"
      android:layout_height="fill_parent"
      android:layout_weight="4"/>
    <FrameLayout
      android:gravity="center_horizontal"
      android:background="#aaaa00"
      android:layout_width="wrap_content"
      android:layout_height="fill_parent"
      android:layout_weight="1"/>
    </LinearLayout>
    </LinearLayout> 
```

后来当我尝试向左侧 FrameLayout 添加内容时，它改变了这个 FrameLayout 的比例（这是问题..）：

[http://imageshack.us/photo/my-images/692/secondp.png/](http://imageshack.us/photo/my-images/692/secondp.png/)

使用以下代码：

```
 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent">
    <LinearLayout
  android:orientation="horizontal"
  android:layout_width="fill_parent"
  android:layout_height="fill_parent"
  android:layout_weight="1"
  android:baselineAligned="false">
  <FrameLayout
      android:gravity="center_horizontal"
      android:background="#aa0000"
      android:layout_width="wrap_content"
      android:layout_height="fill_parent"
      android:layout_weight="1">
      <LinearLayout
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:layout_weight="1">
<TextView
    android:text="row one"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_weight="1"/>
<TextView
    android:text="row two"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_weight="1"/>
<TextView
    android:text="row three"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_weight="1"/>
<TextView
    android:text="row four"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_weight="1"/>
    </LinearLayout>
    </FrameLayout>
    <FrameLayout
      android:gravity="center_horizontal"
      android:background="#00aa00"
      android:layout_width="wrap_content"
      android:layout_height="fill_parent"
      android:layout_weight="4"/>
    <FrameLayout
      android:gravity="center_horizontal"
      android:background="#aaaa00"
      android:layout_width="wrap_content"
      android:layout_height="fill_parent"
      android:layout_weight="1"/>
    </LinearLayout>
    </LinearLayout> 
```

我希望能够仅使用 layout_weight 属性来控制布局 - 如果将内容添加到 FrameLayout 会更改其比率，我需要您帮助找到另一个将保存该比率的容器。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T22:42:27.987

哇，你使用了很多嵌套布局！你的左手布局是否需要是一个框架布局，里面有另一个线性布局，然后是所有的文本视图？或者你可以只替换 FrameLayout 父级并将背景颜色移动到垂直 LinearLayout 吗？

实际上，为什么你也需要第二个线性布局？您可以只指定第一个线性布局的方向为水平方向（无论如何您在高度上都有 fill_parent），然后删除第二个嵌套线性布局。

此外，您可能应该考虑将 FrameLayouts 的布局宽度更改为 0dp，以便它们根据权重动态调整大小。

# c# - 在wp7的silverlight中用c#画一个形状

> ID：10080647
> 
> 赞同：1
> 
> 时间：2012-04-09T22:23:51.977
> 
> 标签：c#, windows-phone-7, windows-phone-7.1, silverlight-5.0, windows-mobile-6.5

我在msdn中找到了一个在.XAML文件中绘制形状的链接，但是如何用c#做同样的事情，在silverlight的wp7中用c#绘制一个形状而不使用xna？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T11:30:54.697

我认为这个[http://www.windowsphonegeek.com/tips/drawing-in-wp7-1-getting-started-and-line-shape](http://www.windowsphonegeek.com/tips/drawing-in-wp7-1-getting-started-and-line-shape)将帮助您使用 C# 绘制形状。

你的 XAML：

```
<Canvas x:Name="ContentPanelCanvas" Grid.Row="1" Background="Transparent"  Margin="12,0,12,0">
    <Line X1="10" Y1="100" X2="150" Y2="100" Stroke="Green" StrokeThickness="5"/>
</Canvas> 
```

C＃：

```
Line line = new Line();
line.Stroke = new SolidColorBrush(Colors.Purple);
line.StrokeThickness = 15;

Point point1 = new Point();
point1.X = 10.0;
point1.Y = 100.0;

Point point2 = new Point();
point2.X = 150.0;
point2.Y = 100.0;

line.X1 = point1.X;
line.Y1 = point1.Y;
line.X2 = point2.X;
line.Y2 = point2.Y;

this.ContentPanelCanvas.Children.Add(line); 
```

# python - AppEngine：动态运行 Python 代码

> ID：10080651
> 
> 赞同：2
> 
> 时间：2012-04-09T22:24:00.413
> 
> 标签：python, google-app-engine

你好 Python 开发者！

我是 Java 人，我知道有一种方法可以即时运行 Java 代码，但我的问题是，有没有办法用 Python 来做到这一点？

这里的主要目标是让中学生从 Python 的第一天就开始使用 chromebook 进行编码。

我一直在寻找一些资源，但到目前为止我一无所获。

非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T22:43:07.540

[http://shell.appspot.com](http://shell.appspot.com)可能会引起您的兴趣。（也有指向源代码的链接）

嘿，我刚刚恢复了一个指向我过去使用的漂亮页面的链接。它显示了 Python 脚本的执行流程。我教过的学生发现它在与其他新语言比较方面非常有用，例如 Java，堆栈和参数如何传递给函数，内存分配等：

[http://people.csail.mit.edu/pgbovine/python/tutor.html](http://people.csail.mit.edu/pgbovine/python/tutor.html)

（点击代码窗口下方的“可视化执行”按钮）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T22:39:16.173

[IPython](http://ipython.org/)允许您从 Web 环境交互地运行 python。你可以在这里尝试一个演示：[IPython](http://www.pythonanywhere.com/try-ipython/)。您可以在本地计算机上进行设置，并让学生从他们的计算机上查看它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T23:30:38.133

[Coderbuddy](http://coderbuddy.com)让您可以在线创建和运行 AppEngine 应用程序，而无需下载 AppEngine SDK、Python 或任何相关内容。

我在做研讨会时使用它，所以我不必费心确保每个人的机器上都有 SDK 和正确的配置。我们直接去编码。:)

# ruby-on-rails - 在 Ubuntu 上使用 nginx 和Passenger 时在哪里放置环境变量

> ID：10080656
> 
> 赞同：27
> 
> 时间：2012-04-09T22:24:24.190
> 
> 标签：ruby-on-rails, ubuntu, environment-variables

我试图建立一个类似于heroku的系统，我将在环境变量中存储密钥，然后从我的rails应用程序中访问它们，如下所示：

```
secret = ENV['EMAIL_PASSWORD'] 
```

我知道 heroku 可以让你这样做`heroku config:add EMAIL_PASSWORD=secret`，我想为我自己的运行 nginx 和 Passenger 的 ubuntu 盒子做类似的事情。

我应该将这些变量添加为`export`s`.bashrc`还是`.bash_login`在系统重新启动时自动设置这些变量？

我不确定每个文件何时被读入。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-05-20T17:54:26.890

您可以使用[dotenv gem](https://github.com/bkeepers/dotenv)将 .env 文件加载为环境变量。您可以为不同的环境生成 .env 文件，而不必将其签入您的存储库。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-09T22:51:30.380

请记住，nginx 可能不在与您相同的环境下运行，通常（发音为“Apache”）我们通过 SetEnv 在服务器配置文件中添加 env-vars。但是，nginx 没有这样的功能......我相信它也不需要它。

```
sudo -E /usr/local/sbin/nginx 
```

在运行 nginx 时，它会知道您自己的用户环境变量。

或者，查看`env`命令（[参见此处](http://wiki.nginx.org/CoreModule)）：

```
env EMAIL_PASSWORD=secret 
```

要回答您的问题，是的，您应该`export`在 shell 配置文件中使用语句。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-05-17T05:59:28.527

（这可能是一个矫枉过正，但也许它会很有用）

需要记住的一些事项：

环境变量在某种程度上是公开的，其他进程可以很容易地看到，就像在`ps(1)`命令中添加一个选项（如`ps e $$`在 bash 中）或查看`/proc/*/environ`，尽管在现代系统上两者都至少限制为同一个用户（或 root）。如果您有另一个相当简单的选择，请不要依赖它们是秘密的。

`~/.bashrc`是环境变量的错误位置，因为它们可以在登录时计算一次`~/.bash_login`，〜/ .bash_profile，或`~/.profile`根据您的使用情况，并传递给所有后代shell。相比之下，`~/.bashrc`动作往往会在每次 shell 调用时重新计算（除非明确禁用）。

将 bash 代码放入其中`~/.profile`可能会混淆其他 sh-descendent shell 和尝试读取该文件的非 shell 工具，因此让 bash-specific`~/.bash_login`或 -_profile 包含 bash-specific 的东西，并`. ~/.profile`用于更一般的东西（LESS， EDITOR、VISUAL、LC_COLLATE、LS_COLORS 等），对其他工具更友好。

中的环境变量`~/.profile`应采用旧的 Bourne shell 形式 ( `VAR=value ; export VAR`)。在 Linux 上，这通常并不重要，但在其他 Unixen 上，当旧版本的“sh”试图读取它们时，这可能是一个大问题。

一些 X 会话只会读取`~/.profile`，而不是`~/.bash_login`上面提到的其他会话。有些人会寻找一个`~/.xsession`需要修改的文件，`. $HOME/.profile`如果它还没有的话。

系统范围的设置将放在类似`/etc/profile.d/similar-to-heroku.sh`. 请注意，“.sh”仅存在，因为该文件将与“.”一起使用。或 "source" - shell 脚本在任何形式的 Unix/Linux 中都不应该*有*命令名扩展。

`sudo`正如 ybakos 指出的那样，大多数环境变量在root 时都会被丢弃。类似的问题出现在 crontabs、jobs 等中。如果有疑问，添加`env | sort > /tmp/envvars`或类似的可疑脚本确实有助于调试。

请注意，某些发行版的 shell 启动脚本如此扭曲，最终实际上违反了 bash(1) 手册页中给出的顺序。每当您发现默认用户`~/.profile`检查 $BASH 或 $BASH_VERSION 时，您可能处于其中一个，嗯...，“有趣”的环境中，并且可能必须通读它们以找出控制流的去向（他们应该使用特定于 bash 的`~/.bash_profile`or `~/.bash_login`，其中包含更通用`~/.profile`的引用，从而让 bash 可执行文件完成工作，而不必在 shell 代码中编写 $BASH 检查）。

`~/.bash_profile`（或`~/.bash_login`）当然可以包括`. ~/.bashrc`，但环境变量属于`~/.bash_profile`（如果特定于bash）或`~/.profile`包含在其中（如果您使用此机制并且其中包含其他所有内容的环境变量），正如DeWitt所说，只要记住把`. ~/.bashrc`.bash_profile`. ~/.profile`和其他环境变量之后，以便登录和所有其他调用都`~/.bashrc`可以依赖已经设置的环境变量。一个例子`~/.bash_profile`：

```
# .bash_profile
[ -r ~/.profile ] && . ~/.profile  # envvars
[ -r ~/.bashrc ]  && . ~/.bashrc   # functions, per-tty settings, etc.
#---eof 
```

在`[ -r ... ] && ...`任何 Bourne shell 后代中都可以使用，并且如果缺少 .profile 也不会导致错误/中止（我个人也有一个`~/.profile.d/*.sh`设置，但这留作完全可选的练习）。

请注意，bash 只读取它找到的这三个文件中的第一个文件：

```
~/.bash_profile
~/.bash_login
~/.profile 
```

...所以一旦你有了那个，从 bash 的角度来看，其他两个的使用完全在用户的控制之下。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-05-19T20:39:28.890

[这记录在 nginx 中](http://wiki.nginx.org/CoreModule#env)。它会删除所有环境变量，**除非** `TZ`在运行工作程序时。如果要添加环境变量，请将以下内容添加到 nginx 配置的**顶部**：

```
# The top of the configuration usually has things like:
user user-name;
pid pid-file-name;

# Add to this:
env VAR1=value1;
env VAR2=value2;

# OR simply add:
env VAR1;
# To inherit the VAR1 from whatever you set in bash 
```

`export`由于 init 脚本的编写方式（我们不知道他们是否在干净的环境中使用 sudo 等），您在 bash 中执行的正常操作或任何操作都不能保证传递给 nginx。所以我宁愿把这些放在nginx配置文件本身，而不是依赖shell来做。

编辑：修复链接

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-08-10T19:37:22.487

我将它们放在我的 nginx 配置中，特别是使用以下`passenger_env_var`命令在应用程序的服务器定义中：

```
服务器 {
    server_name www.foo.com;
    根/webapps/foo/public；
    乘客启用；

    乘客env_var DATABASE_USERNAME foo_db；
    乘客 env_var DATABASE_PASSWORD 秘密；
    乘客 env_var SECRET_KEY_BASE the_secret_keybase；
}

```

这对我有用。有关更多信息，请参阅 phusion 乘客[文档](https://www.phusionpassenger.com/library/config/nginx/reference/#passenger_env_var)。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-05-21T02:08:09.897

I have a script in `/usr/local/bin` folder that sets some env vars and then executes Ruby. I define the path to Ruby in my (Apache, not Nginx) conf file to that file in `/usr/local/bin`.

example:

```
#!/bin/sh

# setup env vars here
export FOO=bar
export PATH_TO_FOO=/bar/bin
export PATH=$PATH:PATH_TO_FOO

# and execute Ruby with any arguments passed to this script
exec "/usr/bin/ruby" "$@" 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-05-20T17:11:25.747

您应该阅读对另一个问题的回复，它会有所帮助：

[https://stackoverflow.com/a/11765775/1217298](https://stackoverflow.com/a/11765775/1217298)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-05-14T12:14:16.580

编辑：

好的抱歉我读得太快了，你可以在这里查看如何保存你的 ENV 变量：

[https://help.ubuntu.com/community/EnvironmentVariables](https://help.ubuntu.com/community/EnvironmentVariables)

[http://www.cyberciti.biz/faq/set-environment-variable-linux/](http://www.cyberciti.biz/faq/set-environment-variable-linux/)

如果你在本地计算机上使用 Nginx 作为服务器，你可以在你的 nginx 配置文件中定义你的环境变量。

```
location / {
...
   fastcgi_param   EMAIL_PASSWORD  secret; #EMAIL_PASSWORD = secret
...
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-04-14T16:23:43.030

I'm using rbenv as a version manager. Good solution to store environment variables for the project was installing the [rbenv-vars](https://github.com/sstephenson/rbenv-vars) plugin and putting them in `.rbenv-vars` file.

Here is a useful post:
[Deploying app ENV variables with Rbenv, Passenger and Capistrano](https://intercityup.com/blog/deploying-app-env-variables-with-rbenv-passenger-and-capistrano.html)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-03-28T13:26:00.433

为您的项目保留 env 变量的最佳位置是 /etc/profile.d/YOUR_FILE.sh， 您可以[在此处](https://help.ubuntu.com/community/EnvironmentVariables)找到文档，该文档详细说明了为不同场景保留 env 变量的位置。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-11-02T05:05:34.077

对于那些使用 RVM 的人来说。确保您的默认环境文件包含用户的 .bashrc 和 .profile 文件

```
file: $rvm_path/environments/default 
```

要查找路径，请运行以下命令：

```
ls -lah `whereis rvm`/environments/default 
```

在该文件的第一行之前添加这两行：

```
source $HOME/.bashrc
source $HOME/.profile 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-05-15T13:35:39.477

如果有人和我有同样类型的问题，这里有一个关于不同`.bash*`文件的不错的小文章：http: [//www.joshstaiger.org/archives/2005/07/bash_profile_vs.html](http://www.joshstaiger.org/archives/2005/07/bash_profile_vs.html)

总之：

大多数情况下： `.bash_profile`在您登录计算机`.bashrc`时读取，在您启动新终端时读取。对于 Mac OSX `.bash_profile`，您启动的每个终端窗口都会读取。

因此，推荐的过程是来源`.bashrc`，`.bash_profile`以便在您登录计算机时设置所有变量。只需将其添加到`.bash_profile`：

```
if [ -f ~/.bashrc ]; then
   source ~/.bashrc
fi 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2012-04-09T22:45:42.920

您必须将导出行添加到您的主文件夹下的 .profile 文件中...

登录时正在设置环境变量...

# java - 峰值内存使用不超过限制

> ID：10080657
> 
> 赞同：6
> 
> 时间：2012-04-09T22:24:32.257
> 
> 标签：java, memory-management, garbage-collection, jvm

我看到使用 -Xmx2g，峰值内存达到 1G 并进行主要收集（marksweep 收集器）。配合-Xmx3g，达到1.5G，做大合集。使用-Xmg4g，它达到2G并进行主要收集。但是，从这里开始，我尝试将最大内存增加到 6G、8G、12G，并且每次峰值内存达到 2G 时都会进行主要收集。

如何让它使用超过2G？我没有遇到任何设置。-Xms 在这里重要吗？对于那些 -Xmx，我将 -Xms 设为 -Xmx 的一半。

我正在使用 Jetty，Java 1.6.024。

更新：是的，我使用的是 64 位 JVM。我使用的 JVM 选项是： -Xmx6g -Xms3g -XX:MaxPermSize=256m 我确定峰值内存的方法是查看 JConsole 中的内存图。它达到2G并下降（主要收藏）。老一代达到 1.5G 最大值，然后发生下降。

谢谢，婴儿车。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T08:25:45.963

您有三个内存区域，伊甸园、幸存者和终身空间。

我怀疑正在发生的事情是，随着您增加最大尺寸，终身或伊甸园空间没有增长。

这两个区域很重要的原因是，当永久空间填满时，会触发 Full GC（我怀疑这个大小正在增长） GC 也会被触发。

如果这是您的问题的原因，那么您正在创建大量中等寿命的对象，这可能是性能问题，除非您可以减少创建的数量。另一种方法是指定一个更大的新大小，这会增加伊甸园的大小。

尝试`-mx12g -XX:NewSize=10g - verbosegc`

最后一个选项将在清理时为您提供各个空间的大小。

# javascript - 为什么我的 d3 力导向图不显示边？

> ID：10080660
> 
> 赞同：6
> 
> 时间：2012-04-09T22:24:45.127
> 
> 标签：javascript, d3.js, force-layout

我使用 d3 创建了一个简单的力导向图：http: [//goo.gl/afHTD](http://goo.gl/afHTD)

为什么图表的边缘不显示？这是我的整个 HTML 文件。当然，您也可以通过在我的链接页面上查看源代码来查看和修改它。它基于 d3 网站上的示例。

```
<!DOCTYPE html>
<html>
  <head>
    <title>Force-Directed Layout</title>
    <script type="text/javascript" src="d3.v2.js"></script>
    <style type="text/css">

div.node {
  border-radius: 6px;
  width: 12px;
  height: 12px;
  margin: -6px 0 0 -6px;
  position: absolute;
}

div.link {
  position: absolute;
  border-bottom: solid #999 1px;
  height: 0;
  -webkit-transform-origin: 0 0;
  -moz-transform-origin: 0 0;
  -ms-transform-origin: 0 0;
  -o-transform-origin: 0 0;
  transform-origin: 0 0;
}

    </style>
  </head>
  <body>
  <div id="chart"></div>
    <script type="text/javascript">

var width = 960,
    height = 500;

var color = d3.scale.category20();

var force = d3.layout.force()
    .charge(-120)
    .linkDistance(30)
    .size([width, height]);

var svg = d3.select("#chart").append("svg")
    .attr("width", width)
    .attr("height", height);

d3.json("newJson.json", function(json) {
  force
      .nodes(json.nodes)
      .links(json.links)
      .start();

  var link = svg.selectAll("line.link")
      .data(json.links)
    .enter().append("line")
      .attr("class", "link")
      .style("stroke-width", function(d) { return Math.sqrt(d.value); });

  var node = svg.selectAll("circle.node")
      .data(json.nodes)
    .enter().append("circle")
      .attr("class", "node")
      .attr("r", 5)
      .style("fill", function(d) { return color(d.group); })
      .call(force.drag);

  node.append("title")
      .text(function(d) { return d.name; });

  force.on("tick", function() {
    link.attr("x1", function(d) { return d.source.x; })
        .attr("y1", function(d) { return d.source.y; })
        .attr("x2", function(d) { return d.target.x; })
        .attr("y2", function(d) { return d.target.y; });

    node.attr("cx", function(d) { return d.x; })
        .attr("cy", function(d) { return d.y; });
  });
});

    </script>
  </body>
</html> 
```

不应该`var link...`显示边缘？我的 JSON 文件也很简单：

```
{"nodes":
   [{"name":"Myriel","group":1},
    {"name":"Napoleon","group":1},
    {"name":"Napoleon","group":2}],
 "links":
    [{"source":1,"target":0,"value":1},
     {"source":1,"target":0,"value":1},
     {"source":1, "target":2, "value":1}]} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-10T14:37:39.060

您需要通过 CSS 应用笔触样式。您当前的节点和链接样式仅限于 HTML DIV 元素，而节点和链接实际上分别表示为 SVG 圆形和线条元素。尝试这个：

```
.node {
  fill: #000;
  stroke: #fff;
  stroke-width: 1.5px;
}

.link {
  stroke: #aaa;
  stroke-width: 1.5px;
} 
```

# algorithm - 如果 f(n) ∈ ω(g(n))，那么 2 ^ f(n) ∈ ω(2 ^ g(n) )

> ID：10080666
> 
> 赞同：1
> 
> 时间：2012-04-09T22:25:24.377
> 
> 标签：algorithm, big-o

我必须找出以下是对还是错：

如果 f(n) ∈ ω(g(n))，那么 2 ^ f(n) ∈ ω(2 ^ g(n) )

我进行了计算 f(n) = 1/n 和 g(n) = 1/n^2 并得到 ans 为假。

它应该是 ：

如果 f(n) ∈ ω(g(n))，则 2 ^ f(n) ∈ Θ(2 ^ g(n) )

有人可以验证一下吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:59:07.113

# macos - 如何在 Mac OS X 上设置已保存文档的 kMDItemKind？

> ID：10080667
> 
> 赞同：0
> 
> 时间：2012-04-09T22:25:47.983
> 
> 标签：macos, cocoa, metadata, macos-carbon

我有一个旧版应用程序（至少从 Mac System 7 移植到 Carbon 到 Cocoa），其中用户报告说我的 mdls 报告的应用程序保存的文本文件的 kMDItemKind 元数据似乎设置为“Microsoft Excel 97-2004 工作簿”。旧文件的创建者和类型应该设置为“cBaS”和“TEXT”（就像在古代苹果公司注册的那样），旧文件扩展名是“.bas”。

什么设置了 Mac OS X 下保存文件的 kMDItemKind 元数据？

如何确保在保存这些文本文件时正确设置 kMDItemKind，以便我的应用程序可以打开它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T00:43:19.813

您不能直接设置`kMDItemKind`文件的。它源自其他元数据。文件类型代码`'TEXT'`非常通用。这些天来，创建者代码被忽略了。文件扩展名可能是系统所依赖的。

不幸的是，在您的情况下，您有多个处理 .bas 文件的应用程序。系统选择哪一个有点武断，可能会发生变化。Launch Services 正在根据实际使用的类型以及该应用程序如何定义与文件扩展名匹配的文档类型或 UTI 来分配类型。

通常，您应该将文件与特定应用程序的关联留给用户。如果他们想更改它，可以在按住 Option 键时使用 Finder 的文件菜单或上下文菜单中的“始终打开方式”进行更改。或者他们可以使用“获取信息”菜单。

您最好的选择是切换到使用更有可能是唯一的文件扩展名

# wpf - Storyboard.Gettarget 返回的结果为 Null

> ID：10080668
> 
> 赞同：0
> 
> 时间：2012-04-09T22:26:05.033
> 
> 标签：wpf, storyboard

```
DoubleAnimation da = new DoubleAnimation();
da.From = 0;
da.To = 400;
da.Duration = new Duration(TimeSpan.FromSeconds(1));
Storyboard.SetTargetName(da, "r13");
Storyboard.SetTargetProperty(da, new PropertyPath(Canvas.LeftProperty));
mySubStoryBoard.Children.Add(da);
DependencyObject do =Storyboard.GetTarget(mySubStoryBoard.Children[0]);
string str = Storyboard.GetTargetName(mySubStoryBoard.Children[0]); 
```

* * *

结果：do==null，str==r13。

为什么会这样？帮帮我，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T22:40:40.127

你能指望什么？您设置[了 Storyboard.SetTargetName 方法](http://msdn.microsoft.com/en-us/library/system.windows.media.animation.storyboard.settargetname.aspx)和[Storyboard.SetTargetProperty 方法](http://msdn.microsoft.com/en-us/library/system.windows.media.animation.storyboard.settargetproperty.aspx)，但没有设置[Storyboard.SetTarget 方法](http://msdn.microsoft.com/en-us/library/cc663141.aspx)。

这就是[Storyboard.GetTarget 方法](http://msdn.microsoft.com/en-us/library/system.windows.media.animation.storyboard.gettarget.aspx)返回 null 的原因。

# linux - 在 Haskell 中使用 GNU/Linux 系统调用`splice`进行零拷贝 Socket 到 Socket 数据传输

> ID：10080670
> 
> 赞同：7
> 
> 时间：2012-04-09T22:26:24.847
> 
> 标签：linux, sockets, haskell, network-programming, splice

**更新：尼莫先生的回答帮助解决了这个问题！下面的代码包含修复！请参阅下面的`nb False`和`nb True`调用。**

**还有一个新的 Haskell 包，称为[`splice`](http://hackage.haskell.org/package/splice)**(，它具有最知名的套接字到套接字数据传输循环的特定于操作系统和可移植的实现) **。**

我有以下（Haskell）代码：

```
#ifdef LINUX_SPLICE
#include <fcntl.h>
{-# LANGUAGE CPP #-}
{-# LANGUAGE ForeignFunctionInterface #-}
#endif

module Network.Socket.Splice (
    Length
  , zeroCopy
  , splice
#ifdef LINUX_SPLICE
  , c_splice
#endif
  ) where

import Data.Word
import Foreign.Ptr

import Network.Socket
import Control.Monad
import Control.Exception
import System.Posix.Types
import System.Posix.IO

#ifdef LINUX_SPLICE
import Data.Int
import Data.Bits
import Unsafe.Coerce
import Foreign.C.Types
import Foreign.C.Error
import System.Posix.Internals
#else
import System.IO
import Foreign.Marshal.Alloc
#endif

zeroCopy :: Bool
zeroCopy =
#ifdef LINUX_SPLICE
  True
#else
  False
#endif

type Length =
#ifdef LINUX_SPLICE
  (#type size_t)
#else
  Int
#endif

-- | The 'splice' function pipes data from
--   one socket to another in a loop.
--   On Linux this happens in kernel space with
--   zero copying between kernel and user spaces.
--   On other operating systems, a portable
--   implementation utilizes a user space buffer
--   allocated with 'mallocBytes'; 'hGetBufSome'
--   and 'hPut' are then used to avoid repeated 
--   tiny allocations as would happen with 'recv'
--   'sendAll' calls from the 'bytestring' package.
splice :: Length -> Socket -> Socket -> IO ()
splice l (MkSocket x _ _ _ _) (MkSocket y _ _ _ _) = do

  let e  = error "splice ended"

#ifdef LINUX_SPLICE

  (r,w) <- createPipe
  print ('+',r,w)
  let s  = Fd x -- source
  let t  = Fd y -- target
  let c  = throwErrnoIfMinus1 "Network.Socket.Splice.splice"
  let u  = unsafeCoerce :: (#type ssize_t) -> (#type size_t)
  let fs = sPLICE_F_MOVE .|. sPLICE_F_MORE
  let nb v = do setNonBlockingFD x v
                setNonBlockingFD y v
  nb False
  finally
    (forever $ do 
       b <- c $ c_splice s nullPtr w nullPtr    l  fs
       if b > 0
         then   c_splice r nullPtr t nullPtr (u b) fs)
         else   e
    (do closeFd r
        closeFd w
        nb True
        print ('-',r,w))

#else

  -- ..    

#endif

#ifdef LINUX_SPLICE
-- SPLICE

-- fcntl.h
-- ssize_t splice(
--   int          fd_in,
--   loff_t*      off_in,
--   int          fd_out,
--   loff_t*      off_out,
--   size_t       len,
--   unsigned int flags
-- );

foreign import ccall "splice"
  c_splice
  :: Fd
  -> Ptr (#type loff_t)
  -> Fd
  -> Ptr (#type loff_t)
  -> (#type size_t)
  -> Word
  -> IO (#type ssize_t)

sPLICE_F_MOVE :: Word
sPLICE_F_MOVE = (#const "SPLICE_F_MOVE")

sPLICE_F_MORE :: Word
sPLICE_F_MORE = (#const "SPLICE_F_MORE")
#endif 
```

**注意：** *上面的代码现在**可以正常工作了！**由于 Nemo，以下不再有效！*

我`splice`使用两个打开和连接的套接字（它们已经用于使用套接字 API`send`和`recv`调用或转换为句柄并与`hGetLine`and一起使用`hPut`）传输最少量的握手数据，并且我不断得到：

```
Network.Socket.Splice.splice: resource exhausted (Resource temporarily unavailable) 
```

在第一个`c_splice`调用站点：`c_splice`返回`-1`并将 some 设置为查找时读取`errno`的值（可能）。`EAGAIN``resource exhausted | resource temporarily unavailable`

`splice`我用不同的`Length`值测试了调用： `1024`, `8192`.

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-09T23:13:14.750

我不知道 Haskell，但“资源暂时不可用”是`EAGAIN`.

看起来[Haskell 默认将其套接字设置为非阻塞模式](http://hackage.haskell.org/packages/archive/network/2.3.0.11/doc/html/src/Network-Socket.html#line-427)。因此，如果您在没有数据时尝试从其中读取，或者在缓冲区已满时尝试写入其中，您将失败并显示`EAGAIN`.

弄清楚如何将套接字更改为阻塞模式，我敢打赌你会解决你的问题。

[更新]

或者，在尝试读取或写入套接字之前调用`select`或。`poll`但是您仍然需要处理`EAGAIN`，因为在极少数情况下，Linux`select`会指示套接字已准备就绪，而实际上它并没有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T23:27:47.673

`sendfile()`系统调用对您有用吗？如果是这样，您可以使用[sendfile 包](http://hackage.haskell.org/package/sendfile)。

# php - 使用 PHP 了解黑名单和白名单

> ID：10080682
> 
> 赞同：0
> 
> 时间：2012-04-09T22:27:31.380
> 
> 标签：php, preg-replace, whitelist

我知道使用白名单它只使用该列表中的所有内容，而使用黑名单它使用除列表中的所有内容之外的所有内容。

但在那之后会发生什么？假设您使用白名单 - 如果输入的值包含不在白名单中的内容，您能否阻止提交输入？

我知道这样的事情会减少所有不是带有空格的字符或数字的东西：

```
preg_replace( "/[^a-zA-Z0-9_]/", "", $stringToFilter ); 
```

但是，如果我不希望将值存储在带有空格的数据库中怎么办。有没有办法做到这一点，以便出现错误消息？例如使用 if 语句...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T23:11:21.993

> 我知道使用白名单它只使用该列表中的所有内容，而使用黑名单它使用除列表中的所有内容之外的所有内容。

*   白名单：批准的项目
*   黑名单：*未获*批准的项目

> preg_replace

您应该使用`preg_match`或`filter_var`与标志一起使用`FILTER_VALIDATE_REGEXP`...更多内容请参见下文。

> 但是，如果我不希望将值存储在带有空格的数据库中怎么办。有没有办法做到这一点，以便出现错误消息？例如使用 if 语句...

您正在谈论验证，因此您将查看：[php.net/filter.filters.validate](http://php.net/filter.filters.validate)：

```
// false    
var_dump( !filter_var('string with spaces', FILTER_VALIDATE_REGEXP, array('options' => array('regexp' => '/[\s]+/i'))) );

// true
var_dump( !filter_var('string_with_no_spaces', FILTER_VALIDATE_REGEXP, array('options' => array('regexp' => '/[\s]+/i'))) ); 
```

将以上内容包装在 if 语句中，就完成了。

# php - 正则表达式：要检测的模式 不在里面的标签 tags? I am trying to get the total number of videos that are on a dynamically generated page. To do this I parse the page's html and search for all , 问问题 user967451 问问题 2012-04-09T22:27:42.270 619 次 This question shows research effort; it is useful and clear 0 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I am trying to get the total number of videos that are on a dynamically generated page. To do this I parse the page's html and search for all , and <embed> tags. The page won't have any other type of iframe content other than video embed codes so I can be sure that any iframe tag is a video. The problem is some embed codes like Hulu for example have the <embed> tag inside the  tag. So with my current REGEX: '/( <param name="movie" value="http://www.hulu.com/embed/7qXAa2z1zXKPMw4mBakrRw"> <param name="allowFullScreen" value="true"> <param name="allowScriptAccess" value="never"> <embed src="http://www.hulu.com/embed/7qXAa2z1zXKPMw4mBakrRw" type="application/x-shockwave-flash" allowfullscreen="true" width="728" height="407" allowscriptaccess="never">  Rather than searching for all embed tags I only want to search for the ones that aren't encapsulated by tags. So the hulu one above will be avoided but one like this will be counted: <embed src="http://www.ebaumsworld.com/player.swf" allowscriptaccess="always" flashvars="id1=81748652" wmode="opaque" width="567" height="345" allowfullscreen="true"> What would the REGEX pattern look like for this, I'm using PHP. add 'disabled' string at the end of button names that you want be disable. and rename them to orginal when you want be active again. phpregex 4 1 回答 1 This answer is useful 0 带有 xpath 的 XML 解析器也是我的选择 于 2012-04-09T22:58:11.570 回答 Related 2 javascript - 使用按钮切换显示/隐藏 div 以获得多个结果 1 ios - 拍照前访问设备相机曝光值 1 c# - 需要获取百分比值的饼图 1 xml - Xpath 与 Internet Explorer 不兼容 1 c# - 模拟非 ASCII 字符的输入 1 php - Laravel 查询中出现问号 2 android - 如何在android清单中写入包名？ 1 actionscript-3 - 用于网络环境的 Google Drive AS3 API 1 css - Drupal Zen 子主题 - 在特定断点处停止响应 1 batch-file - 如何从批处理文件中for循环内的字符串中读取字符 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：10080683
> 
> 赞同：0
> 
> 时间：
> 
> 标签：php, regex

I am trying to get the total number of videos that are on a dynamically generated page. To do this I parse the page's html and search for all `<object>`, `<iframe>` and `<embed>` tags. The page won't have any other type of iframe content other than video embed codes so I can be sure that any iframe tag is a video. The problem is some embed codes like Hulu for example have the `<embed>` tag inside the `<object>` tag. So with my current REGEX:

```
'/(<iframe|<object|<embed)/i' 
```

this Hulu embed code is seen as 2 videos instead of one:

```
<object id="videoplayer1" width="728" height="407">
   <param name="movie" value='http://www.hulu.com/embed/7qXAa2z1zXKPMw4mBakrRw'></param>
   <param name="allowFullScreen" value="true"></param>
   <param name="allowScriptAccess" value="never"></param>
   <embed src='http://www.hulu.com/embed/7qXAa2z1zXKPMw4mBakrRw' type="application/x-shockwave-flash" allowfullscreen="true" width="728" height="407" allowscriptaccess='never'></embed>
</object> 
```

Rather than searching for all embed tags I only want to search for the ones that aren't encapsulated by `<object>` tags. So the hulu one above will be avoided but one like this will be counted:

```
<embed src="http://www.ebaumsworld.com/player.swf" allowScriptAccess="always" flashvars="id1=81748652" wmode="opaque" width="567" height="345" allowfullscreen="true" /> 
```

What would the REGEX pattern look like for this, I'm using PHP.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T22:58:11.570

带有 xpath 的 XML 解析器也是我的选择

# iphone - 将 ViewController 添加为 UITableViewCell 中的子视图 - 未显示

> ID：10080686
> 
> 赞同：1
> 
> 时间：2012-04-09T22:27:55.893
> 
> 标签：iphone, uitableview, uiviewcontroller, storyboard, subview

我正在尝试将 ViewController 添加到我的 TableView 单元格中，但是在测试时它没有显示出来。

PhotoLocation 是 UIViewController 的子类。我在 StoryBoard 上创建了一个视图控制器，上面配置了一堆 UILabel、UITextFields、UISwitch 等。PhotoLocation 与该 StoryBoard 视图控制器相关联，其标识符是 PhotoLocation。

在一个单独的控制器 - UITableViewController 中，我有一个工作表视图，其中包含填充各种信息的单元格，我试图将 PhotoLocation VC 添加为每个单元格的子视图。（注意：PhotoLocation 是一个自由格式的 VC，大小为 210x100）。

在我的`cellForRowAtIndexPath`方法中，我正在执行以下操作：

```
// snip code above which sets up the cell and performs various other things

PhotoLocation *photoLocation_ = [self.storyboard instantiateViewControllerWithIdentifier:@"PhotoLocation"];
[photoLocation_.view setFrame:CGRectMake(115, 0, 210, 109)];
[cell.contentView addSubview:photoLocation_.view];

return cell; 
```

当我运行应用程序时，子视图不会显示在单元格中。这里有什么我想念的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T22:43:47.130

如果我理解正确，请尝试创建一个 nib 文件（文件--> 新文件--> 用户界面--> 视图）。删除“视图”并拖出一个表格视图单元格。按照您在帖子中的描述进行布局。在你的 tableViewController 做：

```
if (cell == nil) {
    [[NSBundle mainBundle] loadNibNamed:@"TVCell" owner:self options:nil];
    cell = tvCell;
    self.tvCell = nil;
} 
```

原因是，除了控制器的控制器（选项卡栏、导航、拆分视图）之外，您不能同时在屏幕上显示 2 个“视图控制器”。您现在正试图将一个视图控制器放在另一个视图控制器中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T04:46:48.193

你试过这个吗？

```
PhotoLocation *photoLocation_ = [self.storyboardinstantiateViewControllerWithIdentifier:@"PhotoLocation"];

[photoLocation_.view setFrame:CGRectMake(115, 0, 210, 109)];

[cell addSubview:photoLocation_.view];

return cell; 
```

# android - BOOT_COMPLETED 从未收到

> ID：10080688
> 
> 赞同：2
> 
> 时间：2012-04-09T22:28:22.770
> 
> 标签：android, android-intent, broadcastreceiver, boot

每个设备都发送 BOOT_COMPLETED 吗？我想在启动完成时启动一个活动。

我在清单中添加了以下内容：

```
<uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />
<receiver android:name=".BootFinished">            
    <intent-filter>                
         <action android:name="android.intent.action.BOOT_COMPLETED" />           
    </intent-filter>        
</receiver> 
```

创建了以下类（接收器）：

```
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.content.pm.PackageManager;
import android.widget.Toast;

public class BootFinished extends BroadcastReceiver {

    @Override        
    public void onReceive(Context mContext, Intent intent) {
        if(intent.getAction().equals("android.intent.action.BOOT_COMPLETED")) {               
          //do something like start an activity or service
        }

        try {
            PackageManager pm = mContext.getPackageManager();
            Intent launch = pm.getLaunchIntentForPackage("com.example.afterboot");
            mContext.startActivity(launch);
        } catch (Exception e) {
            Toast.makeText(mContext, e.getMessage(), Toast.LENGTH_SHORT);
        } 
    }
} 
```

我错过了什么吗？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T22:49:26.973

1.  添加完整路径，然后在您的接收器中添加权限。

    ```
     <receiver android:name="com.example.BootFinished"
       android:permission="android.permission.RECEIVE_BOOT_COMPLETED">            
        <intent-filter>                
           <action android:name="android.intent.action.BOOT_COMPLETED" />           
        </intent-filter>        
     </receiver> 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T22:41:26.283

作为起点，尝试将接收器的完整路径放入清单中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T11:50:00.570

广播接收器事件可能失败的可能原因：

1.  AndroidManifest.xml 中未声明接收者在 Manifest 文件中声明接收者：

2.  Manifest xml 中的 Receiver 拼写错误 Android-System 区分大小写。因此，请检查 AndroidMainfest.xml 中的拼写和路径是否正确

3.  AVD 运行很长时间重置您的 avd/设备

4.此外，如果您的应用程序已移至 sdcard。假设您已注册 android.intent.action.BOOT_COMPLETED，甚至在 mediascanner 扫描 sdcard 之前触发启动事件。

并且所有运行 android 的设备都会发送 BOOT_COMPLETE :P 再次检查并尝试 :) 一切顺利 :)

# ruby - 如何在 Ruby 中用哈希集合值替换字符串？

> ID：10080692
> 
> 赞同：13
> 
> 时间：2012-04-09T22:28:49.477
> 
> 标签：ruby

我有一个哈希集合： `my_hash = {"1" => "apple", "2" => "bee", "3" => "cat"}`

我将使用什么语法来替换字符串中第一次出现的`key`with 哈希集合？`value`

例如我的输入字符串： `str = I want a 3`

结果字符串将是： `str = I want a cat`

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-09T22:36:58.150

我的一个班轮：

```
hash.each { |k, v| str[k] &&= v } 
```

或使用`String#sub!`方法：

```
hash.each { |k, v| str.sub!(k, v) } 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2015-03-17T19:22:52.883

```
"I want a %{b}" % {c: "apple", b: "bee", a: "cat"}
=> "I want a bee" 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-06-10T20:49:15.283

假设 Ruby 1.9 或更高版本：

```
str.gsub /\d/, my_hash 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-09T22:34:57.607

我不明白你的问题，但你可以试试这个：

```
my_hash = {"1" => "apple", "2" => "bee", "3" => "cat"}
str = "I want a 3"
str.gsub(/[[:word:]]+/).each do |word|
  my_hash[word] || word
end
#=> "I want a cat" 
```

:D

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-04-09T22:56:33.467

只是为了在 fl00r 的回答中添加无点风格滥用：

```
my_hash = {"1" => "apple", "2" => "bee", "3" => "cat"}
my_hash.default_proc = Proc.new {|hash, key| key}
str = "I want a 3"
str.gsub(/[[:word:]]+/).each(&my_hash.method(:[])) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-11-25T23:46:35.050

```
my_hash = {"1" => "apple", "2" => "bee", "3" => "cat"}
str = "I want a 3" 
```

如果您要替换的字符串没有任何通用模式，您可以使用：

```
str.sub /#{my_hash.keys.map { |s| Regexp.escape s }.join '|'}/, my_hash 
```

但是如果有的话，代码就会变得简单得多，例如：

```
str.sub /[0-9]+/, my_hash 
```

如果您想替换所有出现，而不仅仅是第一个，请使用 gsub。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-09T22:33:22.893

您可以在 ruby​​ 1.9中使用[String.sub ：](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-sub)

```
string.sub(key, hash[key]) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-09-20T05:58:28.820

以下代码替换给定字符串中第一次出现的`key`with 哈希集合`value``str`

```
 str.gsub(/\w+/) { |m| my_hash.fetch(m,m)}
    => "I want a cat" 
```

# html - 是否可以从 JSP 页面的选择菜单中动态选择某个选项？

> ID：10080694
> 
> 赞同：0
> 
> 时间：2012-04-09T22:29:00.150
> 
> 标签：html, jsp, tags, option

我有一个 JSP 页面上显示的记录列表。然后，用户可以单击“编辑”链接来修改这些记录的任何部分。当他们单击编辑链接时，他们会被带到一个不同的 JSP 页面，该页面具有记录的所有输入字段（名称、评级、价格等）。问题是其中一个字段是选择选项菜单。如何将此选择菜单动态设置为正确的选项？它对文本字段很容易，因为它只是

```
 value="<%=title%>" 
```

但不知道如何处理选项菜单。帮助？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T03:44:09.837

您需要将传递的数据与该页面中的数据集进行比较。

做这样的事情

运行一个循环。查看

```
if(passedValue==thisValue)
   <option selected=\"selected\"><%=your value%></option> 
else
   <option><%=your value%></option> 
```

# c# - 关于用户定义转换的错误

> ID：10080698
> 
> 赞同：1
> 
> 时间：2012-04-09T22:29:41.180
> 
> 标签：c#, sharepoint, web-parts

我的 Visual WebPart 的代码隐藏文件中有以下运算符：

```
public static implicit operator TemplateControl
(ScholarChip.PaymentProcessor.PaymentProcessor.PaymentProcessor target)
    {
        return ((target == null) ? null : target.TemplateControl);
    } 
```

我收到错误：

```
User-defined conversion must convert to or from the enclosing type 
```

我对上述错误不熟悉。谁能建议我如何纠正它？该代码正在 Sharepoint 2010 Visual WebPart 中使用。

非常感谢：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T22:33:01.190

问题是您正在定义 and 之间的转换`PaymentProcessor`，`TemplateControl`但您没有在`PaymentProcessor`类或`TemplateControl`类中定义该转换。TemplateClass 似乎是框架的一部分，所以我怀疑您可以在该类中定义转换。

用户定义的转换必须是被转换的两种类型之一的成员（这只是错误消息所说的另一种说法）。换句话说，如果您控制 PaymentProcessor 类，则将转换移至该类。如果你没有控制任何类，那么你就不走运了，你需要以正常的方法处理转换。

例如，这将给出与您看到的相同的编译器错误：

```
class A {}
class B {}
class C
{
    public static implicit operator A(B source) { return new A(); }
} 
```

这将编译：

```
class A {}
class B
{
    public static implicit operator A(B source) { return new A(); }
} 
```

这也会：

```
class A
{
    public static implicit operator A(B source) { return new A(); }
}
class B {} 
```

# c# - How I can implement this relation between data grid rows in C#?

> ID：10080705
> 
> 赞同：2
> 
> 时间：2012-04-09T22:30:27.993
> 
> 标签：c#, sql, criteria

I am looking for componet like this ![Grid_related_rows](../Images/f356b30c3443712fd1f4ef4d5f2c6ff9.png) this picture has taken from source control query builder. I would like to make relation between rows.As you see in this picture, we can make join between two separated sql statement ((work items type=issue and state=closed) or automated=12) and we can show the relation between rows by two bracket easily. How I can implement this idea , which component I should use? Actually I am developing criteria builder for Sql Queries. Please help me to implement this idea.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:49:20.387

由于您正在实现 SQL 查询生成器，我可能不需要告诉您有关树的信息；-)

括号可以在您使用的任何网格控件中实现为自定义列。没有更多信息，很难提供帮助。

实现 SQL 查询生成器可能很棘手——您可能想四处寻找现有的控件。它最终可能会更便宜地购买而不是建造。

# javascript - 调试 IE 崩溃

> ID：10080706
> 
> 赞同：3
> 
> 时间：2012-04-09T22:30:33.863
> 
> 标签：javascript, internet-explorer

我有一个在 Chrome 和 FireFox 中完美运行的 Web 应用程序，但在 IE 中崩溃。请注意，这不是 JavaScript 错误，而是 iexplore.exe 进程实际上崩溃了。

代码贴在下面。这将在 IE9 中崩溃（单击按钮时）。反转 JavaScript 或更改 CSS 可能会消除问题，但要意识到这是从一个大得多的应用程序中减少的代码，不能以这种方式轻松更改（例如，在实际应用程序中，两个 JavaScript 命令是在两个不同的函数中调用——第二个函数根据第一个函数的结果有条件地运行）。我什至不确定我的问题是什么，除了“有没有办法让微软快速修补这个问题？” 我有兴趣听听人们的想法：

```
<!DOCTYPE html>
<html>
    <head>
        <title>IE Crash</title>
    </head>
    <body>
        <div id="dvStep11" style="width:500px;">
            <label for="inpDOB">Date of Birth (mm/dd/yyyy)</label>
            <input type="text" id="inpDOB" style="width:350px;" />
        </div>
        <button onclick="document.getElementById('inpDOB').value = '12/7/1971';document.getElementById('dvStep11').style.display='none';">Click here</button>
    </body>
</html> 
```

编辑：我已经向微软开立了一个案例，并正在与那里的开发团队成员一起工作。当我收到更多信息时，我会更新这个。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-11T12:25:51.610

Microsoft 已向我确认这是 IE9 渲染引擎中的错误。根据我的进一步研究，这与父 DIV 的宽度与 INPUT 的宽度相结合会导致 INPUT 换行这一事实有关。由于某种原因，在这种情况下，当为 INPUT 赋值并立即隐藏父 DIV 时，IE 崩溃。

微软建议我通过这行代码强制 IE 使用 IE8 渲染引擎（不会崩溃）：

```
<meta http-equiv="X-UA-Compatible" content="IE=8" /> 
```

但是，我发现，我也可以通过将 INPUT 包装在其自己的非样式化 DIV 或 SPAN 中来避免该问题。这是首选，因为除了这个错误之外，IE9 渲染引擎比 IE8 更好（并且更快）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T22:34:29.597

有趣的是，IE9 带来的调试器在断点、变量跟踪等方面非常有用，所以我会尝试看看是否有帮助。（如果你能获得 IE9；我不确定 IE 7 和 8 中的开发工具）。

# mysql - 在 MySQL 中仅针对“限制和偏移”进行分组

> ID：10080712
> 
> 赞同：3
> 
> 时间：2012-04-09T22:30:58.930
> 
> 标签：mysql, sql, database

在尝试进行分页时，我遇到了这个问题。我的桌子-

```
ID   CarBrand    Car Model
---------------------------
1    Alfa Romeo  Guilietta
2    Alfa Romeo  Mito

3    Audi        A3
4    Audi        R8
5    Audi        TT

6    Fiat        Punto
7    Fiat        Panda

8    Ford        Mondeo
9    Ford        Mustang

10   Nissan      Almera
11   Nissan      Note
12   Nissan      Qashqai

13   Toyota      Aygo
14   Toyota      Prius

15   Volkswagen  Beetle
16   Volkswagen  Golf
17   Volkswagen  Polo
18   Volkswagen  Up 
```

我有这样显示的数据，以两组为一组：

```
-Fiat  - Punto
         Panda

-Ford  - Mondeo
         Mustang 
```

所以有 2 个品牌，但有 4 个数据库结果。在显示该品牌的所有模型时，是否可以有查询限制并将我的结果抵消到两个品牌？

对不起，如果我不清楚！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T22:44:27.180

很明显。试试这个：

```
select * from t t1
join (
  select distinct carBrand from t
  limit 2
) s on t1.carBrand = s.carBrand 
```

在`limit 2`应用您想要的顺序之前。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T01:08:57.340

要获得限制，不使用`limit`关键字，您可以强加一个计数。

例如，给定表定义

```
create table cars (id int,
                   carBrand char(10),
                   carModel char(10)); 
```

这将为您提供前 2 个汽车品牌的所有车型

```
select cars.carBrand, cars.carModel
from cars
where  ((select count(*) from 
           (select distinct carBrand from cars) as carBrands
        where carBrands.carBrand < cars.carBrand) < 2)
order by cars.carBrand, cars.carModel; 
```

这将创建一个仅列出的内联表`carBrands`，然后将其连接回汽车以获取前 2 个品牌中的所有汽车的列表。强制执行`count(*) .... < 2`限制。`'Ford'`例如，在您的上述数据中考虑。在 '`Ford'`的情况下，有 3 个品牌是`< 'Ford'`按字母顺序排列的，所以`count(*)`上面 = 3。由于 3 不小于 2，`'Ford'`因此输出中不会出现汽车。

您的测试数据的输出将是：

```
CARBRAND    CARMODEL
Alfa Romeo  Guilietta
Alfa Romeo  Mito
Audi        A3
Audi        R8
Audi        TT 
```

现在，你没有说你想如何选择这两个品牌——你只是在你的例子中列出了福特和菲亚特——我不知道你是怎么选择的。如果您想要的不是按字母顺序排序的标准，那是可行的，但更难。

SQL Fiddle 和所有这些的结果： [http ://sqlfiddle.com/#!2/33a8f/3](http://sqlfiddle.com/#!2/33a8f/3)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T22:42:42.840

这是数据库设计的问题。也许您应该将数据拆分为两个表`model`（型号名称）和`brand`（品牌名称）。然后你可以写一个这样的查询：

```
SELECT m.name, b.name
FROM model m
INNER JOIN brand b
WHERE b.id IN (
    SELECT id
    FROM brand
    ORDER BY name ASC
    LIMIT 2 OFFSET 0
) 
```

我没有测试代码。`GROUP BY`在我看来没有必要。

# ruby - Ruby 1.9.X combination in multicore?

> ID：10080714
> 
> 赞同：1
> 
> 时间：2012-04-09T22:31:27.057
> 
> 标签：ruby, multithreading, ruby-1.9.3

I'm doing analysis on combination blocks. Is it possible to have this run on multicore?

```
x = (1...30).to_a.combination(10).collect { |x| x }
puts x 
```

# python - pygame.event.Event().type == pygame.QUIT, confusion

> ID：10080715
> 
> 赞同：7
> 
> 时间：2012-04-09T22:31:30.073
> 
> 标签：python, class, pygame

Consider these lines in the pygame loop:

```
ev = pygame.event.poll()
ev.type == pygame.QUIT 
```

From: [http://openbookproject.net/thinkcs/python/english3e/pygame.html](http://openbookproject.net/thinkcs/python/english3e/pygame.html)

From what I understand the function `pygame.event.poll()` creates an instance of the Event class in the event module of the pygame package.

I. Now `ev.type` is an attribute call(?) but how do I know which values it can have? How can you even tell from the pygame documentation that it has the possibility to equal pygame.QUIT?

II. What exactly is pygame.QUIT? How does it get a value?

III. `help('pygame.QUIT')` says `pygame.QUIT = class int(object)`. How do you call this construction?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-09T22:34:29.837

```
ev = pygame.event.poll() 
```

是对从事件队列返回单个事件的函数的调用（基本上，您的应用程序可能想知道的已发生事件的列表）。它将那个事件（它是一个`Event`对象）分配给变量`ev`。

```
ev.type 
```

获取该对象的`type`属性值`Event`，它是一个数值常量。

```
== pygame.QUIT 
```

检查它是否等于定义为的数值常数`pygame.QUIT`。

[可能的事件类型在http://www.pygame.org/docs/ref/event.html](http://www.pygame.org/docs/ref/event.html)中列出- 我也在此处复制粘贴了列表（其中还列出了与每个事件一起传递的相关属性）：

```
QUIT             none
ACTIVEEVENT      gain, state
KEYDOWN          unicode, key, mod
KEYUP            key, mod
MOUSEMOTION      pos, rel, buttons
MOUSEBUTTONUP    pos, button
MOUSEBUTTONDOWN  pos, button
JOYAXISMOTION    joy, axis, value
JOYBALLMOTION    joy, ball, rel
JOYHATMOTION     joy, hat, value
JOYBUTTONUP      joy, button
JOYBUTTONDOWN    joy, button
VIDEORESIZE      size, w, h
VIDEOEXPOSE      none
USEREVENT        code 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-15T21:02:19.913

`pygame.QUIT`当用户单击窗口的“X”按钮或系统“要求”进程退出时发送。如果忽略，它仍然可以被系统杀死。它可以让您在退出之前保存。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-09T22:38:22.547

`pygame.QUIT`只是一个`int`恰好在`pygame`模块内部定义的常量。

```
>>> import pygame
>>> pygame.QUIT
12 
```

这是文档中的相关页面：http: [//www.pygame.org/docs/ref/event.html](http://www.pygame.org/docs/ref/event.html)。您可以看到所有可能的事件类型（就在评论上方）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2021-01-25T10:52:00.230

我不完全确定`pygame.event.poll()`实际做了什么，但是您可以检测到窗口何时关闭`for e in pygame.event.get(): if e.type == pygame.QUIT: print('the cross has been clicked'`，不知道这是否有帮助，但这可能是您的问题的解决方法

# .net - rabbitmq 的 REST API

> ID：10080718
> 
> 赞同：8
> 
> 时间：2012-04-09T22:31:59.153
> 
> 标签：.net, wcf, rest, rabbitmq, amqp

有没有办法如何从 $.ajax 向 RabbitMQ 发送数据？

我的应用程序由数千个 Web 客户端（用 js 编写）和 WCF REST 服务组成，现在我试图弄清楚如何为我的应用程序创建一个可扩展的点。这个想法是有一个 rabbitmq 实例，它接收来自一侧的 js 客户端的消息，以及从队列中获取待处理消息的 WCF 工作流服务实例。

我知道 AMQP 和 HTTP 是完全不同的东西。

所以问题是 - 是否有用于 rabbit mq 的 REST 接口或某种网关

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-10T02:08:49.807

[RabbitMQ 的开发者工具页面](http://www.rabbitmq.com/devtools.html)上列出了许多 3rd-party HTTP 插件，它们还提供了一个[实验性的 JSON-RPC 插件](http://www.rabbitmq.com/plugins.html#experimental)，允许 AMQP over HTTP 访问。

您还应该看看[RabbitJS](http://www.rabbitmq.com/blog/2010/11/12/rabbitmq-nodejs-rabbitjs/)和[SockJS](http://www.rabbitmq.com/blog/2011/09/13/sockjs-websocket-emulation/)，看看 Rabbit 团队正在做些什么来分别将消息传递到 node.js 和 WebSockets 的世界。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-19T10:41:42.433

可在此处找到 3.4.3 版本的 RabbitMQ REST API 文档：

[http://hg.rabbitmq.com/rabbitmq-management/raw-file/rabbitmq_v3_4_3/priv/www/api/index.html](http://hg.rabbitmq.com/rabbitmq-management/raw-file/rabbitmq_v3_4_3/priv/www/api/index.html)

除了管理任务之外，它还允许发布消息。

链接文档中的重要说明：

> 请注意，HTTP API 中的发布/获取路径用于注入测试消息、诊断等 - 它们不实现可靠的传递，因此应被视为系统管理员的工具，而不是用于消息传递的通用 API。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T22:43:34.653

是的。您可以在[RabbitMQ 插件中研究的 rabbitmq_jsonrpc_channel 插件](http://www.rabbitmq.com/plugins.html)

看起来好像它通过 JSON 提供了基于 HTTP 的 AMQP。

# jquery - Jquery - 在内部加载另一个 DIV 时动态调整容器 DIV 宽度容器的大小

> ID：10080720
> 
> 赞同：0
> 
> 时间：2012-04-09T22:32:08.337
> 
> 标签：jquery, scroll

当内部加载另一个 DIV（通过 PHP）时，如何使用 DIV 容器的 Jquery 更改宽度？

这是我的 HTML 代码

```
<div id="container">
    <div class="item"> Content 1 </div>
</div> 
```

现在，我必须为每个页面动态填充“容器”。另一个页面可能有这个 HTML 代码

```
<div id="container">
     <div class="item"> Content 1 </div>
     <div class="item"> Content 2 </div>
     <div class="item"> Content 3 </div>
</div> 
```

“项目”有浮动：左；我想要连续的所有“项目”。当内部加载“项目”时，如何动态更改“容器”宽度？

我正在使用滚动条 Jquery 插件来滚动 div。

请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:38:47.743

你需要这样的东西吗？

```
$(document).ready(function(){
    var youtWidth = 100;
    $('#container').width($('#container .item').length * yourWidth);
}) 
```

这会计算#container 内的元素并将#container 宽度设置为元素数量的倍数。在这个例子中，我为每个元素保留 100px。

法比奥

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T22:43:16.057

您可以计算子项的宽度并将总数应用于容器，如下所示：

```
var contentWidth = 0;

$('#container .item').each( function() {
    // outerWidth(true) includes margins
    contentWidth += $(this).outerWidth(true);
});

$('#container').width( contentWidth ); 
```

演示：http: [//jsfiddle.net/jtbowden/SQASY/](http://jsfiddle.net/jtbowden/SQASY/)

* * *

或者，使用一些基本的 CSS，您可以完全避免使用 JavaScript：

演示：http: [//jsfiddle.net/jtbowden/YBKxn/1/](http://jsfiddle.net/jtbowden/YBKxn/1/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T22:43:47.893

如果项目有不同的宽度，你总是可以这样做：

```
var totalWidth = 0;
$('#container').children('.item').each(function(){
   totalWidth += $(this).outerWidth();
});

$('#container').width(totalWidth); 
```

# objective-c - 如何根据动态需求动态/无限期地创建 UIImageViews？

> ID：10080721
> 
> 赞同：0
> 
> 时间：2012-04-09T22:32:15.657
> 
> 标签：objective-c, ios, uiimageview

我正在创建一个 iOS 程序。我想要一个滚动视图，填充 UIImageViews（一次 9 个，每行 3 个），并根据与远程服务器的通信，将图像加载到这些视图中，并根据需要创建新的 UIImageViews。

我觉得我必须为此创建一个自定义类，但我有点迷茫。谁能指出我正确的方向？

我看过 AQGridView，我想我想自己创建一些东西，这样我就可以完整地理解它，而不是笨拙地使用别人的代码。

注意：我将处理数百甚至数千张图像。我需要能够以一种不会破坏记忆的动态方式来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T23:07:36.157

1.  使用 UITableView。您可以免费获得行和滚动。
2.  使用 3 个 UIImageViews 创建一个自定义表格视图单元格。（搜索使用自定义表格视图单元格）
3.  在您的 tableView 委托中，实现 cellForRowAtIndexPath 方法。在这种方法中，创建您的图像视图，如：

`cell.imageView1.image = [UIImage imageWithData:[NSData dataWithContentsOfURL:[NSURL URLWithString:MyURL1]]];`

`cell.imageView2.image = [UIImage imageWithData:[NSData dataWithContentsOfURL:[NSURL URLWithString:MyURL2]]];`

`cell.imageView3.image = [UIImage imageWithData:[NSData dataWithContentsOfURL:[NSURL URLWithString:MyURL3]]];`

# android - Android HTTP 连接性能

> ID：10080724
> 
> 赞同：0
> 
> 时间：2012-04-09T22:32:36.610
> 
> 标签：android, android-networking

我有一个基于 php 的 Web 服务，它可以生成大量 JSON 数据。为了便于讨论，我在这里指的是一个 65KB 的数据样本。65KB 应该不需要太多下载。我在 JavaScript（通过 AJAX 调用它）上对此进行了测试，获取数据包需要几毫秒。我在服务器端和 android 客户端添加了代码，这些代码将标记发送和接收数据的时间戳。 **令我恐惧的是，即使在 localhost 上，Android 模拟器也需要 2 分钟才能获取 65KB**

这是我用来获取数据的方法。两个类，一个用于排队 HTTP 连接并使用线程一一运行它们，另一个用于实际发送和接收数据以及触发处理程序的方法。

**HTTPConnection.java：**

```
public class HttpConnection implements Runnable 
{

public static final int DID_START = 0;
public static final int DID_ERROR = 1;
public static final int DID_SUCCEED = 2;

private static final int GET = 0;
private static final int POST = 1;
private static final int PUT = 2;
private static final int DELETE = 3;
private static final int BITMAP = 4;

private String url;
private int method;
private Handler handler;
private List<NameValuePair> postData;
private String data;

private HttpClient httpClient;

public HttpConnection() 
{
    this(new Handler());
}

public HttpConnection(Handler _handler) 
{
    handler = _handler;
}

public void create(int method, String url, String data) 
{
    this.method = method;
    this.url = url;
    this.data = data;
    ConnectionManager.getInstance().push(this);
}
public void createPost(int method, String url, List<NameValuePair>data) 
{
    this.method = method;
    this.url = url;
    this.postData = data;
    ConnectionManager.getInstance().push(this);
}   

public void get(String url) 
{
    create(GET, url, null);
}

public void post(String url, List<NameValuePair> data) 
{
    createPost(POST, url, data);
}

public void put(String url, String data) 
{
    create(PUT, url, data);
}

public void delete(String url) 
{
    create(DELETE, url, null);
}

public void bitmap(String url) 
{
    create(BITMAP, url, null);
}

public void run() 
{
    handler.sendMessage(Message.obtain(handler, HttpConnection.DID_START));

    httpClient = new DefaultHttpClient();
    HttpConnectionParams.setSoTimeout(httpClient.getParams(), 10000);
    try {
        HttpResponse response = null;
        switch (method) {
        case GET:
            response = httpClient.execute(new HttpGet(url));
            break;
        case POST:
            HttpPost httpPost = new HttpPost(url);
            httpPost.setEntity(new UrlEncodedFormEntity(postData));
            response = httpClient.execute(httpPost);
            break;
        case PUT:
            HttpPut httpPut = new HttpPut(url);
            httpPut.setEntity(new StringEntity(data));
            response = httpClient.execute(httpPut);
            break;
        case DELETE:
            response = httpClient.execute(new HttpDelete(url));
            break;
        case BITMAP:
            response = httpClient.execute(new HttpGet(url));
            processBitmapEntity(response.getEntity());
            break;
        }
        if (method < BITMAP)
            processEntity(response.getEntity());
    } catch (Exception e) {
        handler.sendMessage(Message.obtain(handler,
                HttpConnection.DID_ERROR, e));
    }
    ConnectionManager.getInstance().didComplete(this);
}

private void processEntity(HttpEntity entity) throws IllegalStateException,IOException 
{
    BufferedReader br = new BufferedReader(new InputStreamReader(entity.getContent()));
    String line, result = "";
    while ((line = br.readLine()) != null)
        result += line;
    Message message = Message.obtain(handler, DID_SUCCEED, result);
    handler.sendMessage(message);
}

private void processBitmapEntity(HttpEntity entity) throws IOException 
{
    BufferedHttpEntity bufHttpEntity = new BufferedHttpEntity(entity);
    Bitmap bm = BitmapFactory.decodeStream(bufHttpEntity.getContent());
    handler.sendMessage(Message.obtain(handler, DID_SUCCEED, bm));
}

} 
```

**ConnectionManager.java：**

```
public class ConnectionManager 
{
public static final int MAX_CONNECTIONS = 5;
private ArrayList<Runnable> active = new ArrayList<Runnable>();
private ArrayList<Runnable> queue = new ArrayList<Runnable>();
private static ConnectionManager instance;
public static ConnectionManager getInstance() 
{
    if (instance == null) 
        instance = new ConnectionManager();
    return instance;
}
public void push(Runnable runnable) 
{
    queue.add(runnable);
    if (active.size() < MAX_CONNECTIONS)
        startNext();
}
private void startNext() 
{
    if (!queue.isEmpty()) 
    {
        Runnable next = queue.get(0);
        queue.remove(0);
        active.add(next);

        Thread thread = new Thread(next);
        thread.start();
    }
}
public void didComplete(Runnable runnable) 
{
    active.remove(runnable);
    startNext();
}
} 
```

**这些代码被称为：**

```
public void SendHTTPRequest(String function, List<NameValuePair> Data, Handler handler)
{
    new HttpConnection(handler).post(this.getServerAddress() + "/service-endpoint.php?function="+function,Data);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T01:03:54.640

您正在以低效的方式将输入流处理为字符串。尝试使用 StringBuilder 代替。像这样的东西应该更快（如果可能的话，也可以在设备上测试它）

```
StringBuilder sb = new StringBuilder();
String line = null;
while ((line = reader.readLine()) != null) {
    sb.append(line + "\r\n");
} 
```

我还建议研究在 Android（JSON、GSON、Jackson JSON）中解析 JSON 的众多方法之一，而不是将数据作为字符串处理。

# ruby-on-rails - Ruby - 如何在 gemfile 上使用 bundler 来创建环境？

> ID：10080730
> 
> 赞同：1
> 
> 时间：2012-04-09T22:34:07.337
> 
> 标签：ruby-on-rails, ruby

我正在加入一个 Ruby 项目，并获得了 gemfile 的 GitHub 网址。我将 gemfile 复制并粘贴到我的 ruby​​ 设置的根目录。

我不确定 gemfile 的扩展名应该是什么。应该是 "name.rb" 吗？

我也感到困惑的是我应该使用的命令。我用谷歌搜索了正确的语法，但对使用捆绑器从我拥有的 gemfile 创建应用程序的语法应该是什么感到困惑。

建议非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T23:18:54.150

Gemfile 应在没有扩展名的情况下保存。

Bundler 有许多不同的命令可供您使用，但听起来您对如何让 Bundler 安装所有项目依赖项感兴趣。来自 Bundler[文档](http://gembundler.com/man/bundle.1.html)：

> `bundle install`
> 
> `Gemfile`安装or指定的 gems`Gemfile.lock`

由于 Gemfile 被评估为 Ruby 代码，因此可以使用扩展名`.rb`. 但是，如果您这样做，Bundler 不会自动找到它。如果由于某种原因您确实需要使用`.rb`扩展名保存它，则[此答案](https://stackoverflow.com/questions/4976132/can-i-rename-my-gemfile-to-gemfile-rb)显示了它是如何可能的。

# c# - 实体框架 + LINQ + “包含” == 超级慢？

> ID：10080732
> 
> 赞同：17
> 
> 时间：2012-04-09T22:34:18.100
> 
> 标签：c#, linq, entity-framework

试图重构一些最近变得非常慢的代码，我遇到了一个需要 5 秒以上才能执行的代码块。

代码由 2 个语句组成：

```
IEnumerable<int> StudentIds = _entities.Filters
                    .Where(x => x.TeacherId == Profile.TeacherId.Value && x.StudentId != null)
                    .Select(x => x.StudentId)
                    .Distinct<int>(); 
```

和

```
_entities.StudentClassrooms
                    .Include("ClassroomTerm.Classroom.School.District")
                    .Include("ClassroomTerm.Teacher.Profile")
                    .Include("Student")
                    .Where(x => StudentIds.Contains(x.StudentId)
                    && x.ClassroomTerm.IsActive
                    && x.ClassroomTerm.Classroom.IsActive
                    && x.ClassroomTerm.Classroom.School.IsActive
                    && x.ClassroomTerm.Classroom.School.District.IsActive).AsQueryable<StudentClassroom>(); 
```

所以它有点乱，但首先我从一个表（过滤器）中得到一个不同的 Id 列表，然后我使用它查询另一个表。

这些是相对较小的表，但仍然需要 5 秒以上的查询时间。

我把它放在 LINQPad 中，它表明它首先执行底部查询，然后运行 ​​1000 个“不同”查询。

一时兴起，我通过在末尾添加 .ToArray() 更改了“StudentIds”代码。这将速度提高了 1000 倍……现在完成相同的查询需要 100 毫秒。

这是怎么回事？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-04-09T22:38:07.397

这是 Linq 中延迟执行的缺陷之一：在您的第一种方法`StudentIds`中，实际上是一个`IQueryable`，而不是内存中的集合。这意味着在第二个查询中使用它会在数据库上再次运行查询 - 每次。

通过 using 强制执行第一个查询`ToArray()`会`StudentIds`生成一个内存集合，并且`Contains`第二个查询中的部分将在包含固定项目序列的该集合上运行 - 这将映射到与 SQL`where StudentId in (1,2,3,4)`查询等效的内容。

这个查询当然会快得多，因为您预先确定了这个序列，而不是每次`Where`执行子句时。您不使用`ToArray()`（我认为）的第二个查询将映射到一个 SQL 查询，其中包含一个`where exists (...)`针对每一行进行评估的子查询。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-09T22:44:08.273

`ToArray()`将初始查询具体化到服务器内存。

我的猜测是查询提供程序无法解析表达式`StudentIds.Contains(x.StudentId)`。因此它可能认为`studentIds`是一个已经加载到内存中的数组。所以它可能在解析阶段一遍又一遍地查询数据库。确定的唯一方法是设置分析器。

如果您需要在数据库服务器上执行此操作，请使用连接，而不是“包含”。如果您需要使用 contains 来执行看起来像连接问题的操作，您可能会在某处丢失代理主键或外键。

您也可以声明`studentIds`为 IQueryable 而不是 IEnumerable。这可能会为查询提供者提供解释`studentIds`as 表达式所需的提示。数据尚未加载到内存中。我以某种方式怀疑这一点，但值得一试。

如果一切都失败了，请使用`ToArray()`. 这会将初始值加载`studentIds`到内存中。

# python - 根据Django中捕获的URL参数过滤QuerySet？

> ID：10080737
> 
> 赞同：1
> 
> 时间：2012-04-09T22:35:06.553
> 
> 标签：python, django, django-urls

我正在制作一个通用模板，它将显示来自查询集的对象列表：

```
{% for o in objects %}
    {{ o.name }}
{% endfor %} 
```

我希望能够在需要进行不同类型的过滤和排序的多种情况下使用该模板。我为此创建了一个视图函数：

```
def display_objects(request, filters, orders, template_name):
    objects = Object.objects.all()
    for filter in filters:
        objects = objects.filter(('%s__%s' % (filter['field'], filter['relationship']), filter['value']))
    for order in orders:
        objects = objects.order_by('-' if 'descending' in order else '' + order['field'])
    # render objects to template with context
    pass 
```

我不确定到目前为止我所做的是否会奏效，但我遇到了一个问题。我不知道用我当前的函数过滤由 URL 中捕获的参数设置的查询是否可行。

例如，如果我想显示与某个用户有关的对象，我会执行以下操作：

```
(r'^user/(?P<account_username>[^/]+)/$', display_objects, dict(filters=[{'field':'account__username','relationship':'iexact','value':account_username}], orders=[{'field':'foobar'}], template_name='user.html')) 
```

显然，在 URL 被解析并分派给 display_objects 函数之前，account_username 不是一个已定义的字段。制作一个带有 account_username 参数的视图函数很容易，但我希望能够使用该函数来显示其他对象查询集，这些对象查询集将使用不同的捕获参数进行过滤。

有什么方法可以将捕获的 URL 参数传递给视图函数以动态过滤或订购要显示的查询集？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:46:14.990

这是您可以执行此操作的一种方法：

在 urls.py 中：

```
(r'^user/(?P<account_username>[^/]+)/$', display_objects, dict(filters=[{'field':'account__username','relationship':'iexact'}], orders=[{'field':'foobar'}], template_name='user.html')) 
```

然后在views.py中：

```
def display_objects(request, filters, orders, template_name, **kwargs):

    objects = Object.objects.all()
    for filter in filters:
        objects = objects.filter(('%s__%s' % (filter['field'], filter['relationship']), kwargs.get(filter['field'])))
    for order in orders:
        objects = objects.order_by('-' if 'descending' in order else '' + order['field'])
    # render objects to template with context
    pass 
```

虽然老实说，我不确定这是否是一种做事的好方法......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T23:04:39.480

您不能将字符串直接传递给该`filter`方法。你需要把它翻译成 kwargs。

```
query_string = '%s__%s' % (filter['field'], filter['relationship'])
objects = objects.filter(**{query_string: filter['value']})) 
```

# php - 对 foreach 和多维数组感到困惑 - PHP

> ID：10080740
> 
> 赞同：0
> 
> 时间：2012-04-09T22:35:30.253
> 
> 标签：php, foreach

好的，所以数组是我的弱点，我正在为此苦苦挣扎。这可能也很简单。基本上，我有一个数组

代码：

```
 Array
    (
[data] => Array
    (
        [0] => Array
            (
                [name] => getalbum
                [fql_result_set] => Array
                    (
                        [0] => Array
                            (
                                [aid] => 187046464639937_101906
                                [name] => photo tab
                                [cover_pid] => 187046464639937_1661168
                            )

                        [1] => Array
                            (
                                [aid] => 187046464639937_99627
                                [name] => Cover Photos
                                [cover_pid] => 187046464639937_1661054
                            )

                    )

            )

        [1] => Array
            (
                [name] => getcover
                [fql_result_set] => Array
                    (
                        [0] => Array
                            (
                                [src] => http://photos-g.ak.fbcdn.net/hphotos-ak-prn1/526499_403098366368078_187046464639937_1661168_217706037_s.jpg
                            )

                        [1] => Array
                            (
                                [src] => http://photos-b.ak.fbcdn.net/hphotos-ak-ash3/562470_403049039706344_187046464639937_1661054_361917190_s.jpg
                            )

                    )

            )

    )

    ) 
```

我正在使用 foreach 通过 PHP 代码调用数组：

```
foreach($fql_query_obj['data'] as $albums){
    foreach($albums['fql_result_set'] as $album){
        //print_r($album);
        if (   ($album['name'] != "Wall Photos")
            && ($album['name'] != "Cover Photos") 
            && ($album['name'] != "photo tab"))
        {
             echo $album['name'].' :: '.$album['aid'];
             echo '<img src="'.$album['src'].'" /><br />';
        }    
     }
} 
```

现在它似乎通过 getalbum 数组然后是 getcover。我该怎么做才能将它们合并在一起？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T23:03:41.423

您如何获取数据，某种数据库？也许您可以在获取该数据时合并它？

无论如何，如果您的数据总是以这种方式排序（匹配数组，一个带有数据的第一部分，第二个带有附加数据），那么这样的事情怎么样？

```
foreach($fql_query_obj['data'][0]['fql_result_set'] as $key_album => $album){
    //print_r($album);
    if (   ($album['name'] != "Wall Photos")
        && ($album['name'] != "Cover Photos") 
        && ($album['name'] != "photo tab"))
    {
         echo $album['name'].' :: '.$album['aid'];
         echo '<img src="'.$fql_query_obj['data'][1]['fql_result_set'][$key_album]['src'].'" /><br />';
    }    
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T23:23:27.453

您似乎正在尝试迭代查询（`getalbum`和`getcover`）。相反，您可能希望迭代专辑并将封面和专辑数据视为一个统一的东西。我会尝试重组数据以使其更易于使用：

```
list($albumsQuery, $coversQuery) = $fql_query_obj['data'];
$albums = array();

foreach ($albumsQuery['fql_result_set'] as $album) {
    $albums[] = $album;
}

for ($i = 0, $numAlbums = count($albums); $i < $numAlbums; ++$i) {
    $albums[$i] = array_merge($albums[$i], $coversQuery['fql_result_set'][$i]);
}

foreach ($albums as $album) {
    // Here, $album contains data from both arrays
} 
```

请注意，这假设没有冲突的键（您的示例数据中没有），并且还有很多其他方法可以做到这一点。

# spotify - 在 Spotify 播放器上播放外部链接

> ID：10080742
> 
> 赞同：0
> 
> 时间：2012-04-09T22:35:39.927
> 
> 标签：spotify

我一直试图让 Spotify 播放器从 URL 播放一些东西。

```
var sp = getSpotifyApi(1);
var models = sp.require('sp://import/scripts/api/models');

var t = models.Link.fromURL("http://some link here.mp3");
models.player.play(t); 
```

这甚至可能吗？我是否正确使用 Link.fromURL？每次我运行它时，控制台似乎都建议 fromURL 不存在。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T09:02:54.900

Spotify Apps API 只能播放来自 Spotify URI 的曲目，如下所示：

```
var t = models.Link.fromURL("spotify:track:4QXxA6ixE222Ely7fAeopM");
models.player.play(t); 
```

不支持所有其他 URL。

# php - 在没有显式下载脚本的情况下更改链接文件的 http-header（在自己的文件中）

> ID：10080747
> 
> 赞同：0
> 
> 时间：2012-04-09T22:36:38.213
> 
> 标签：php, apache, http, http-headers

我想强制浏览器下载由 php-script 创建的 RSS-Feed 中链接的所有文件。

因此我需要更改这些文件的 HTTP 标头并设置

```
header("Content-Disposition: attachment; filename=$file"); 
```

（也许还有其他一些变化）。

目前我尝试使用下载脚本来设置这些参数。

然而，这种方法的缺点是，我必须链接到“download.php”而不是“target.file”，这在某种程度上误导了用户。此外，我必须向用户透露内部文件路径或使用相当多的 GET 变量。

如果可以更改生成 RSS-Feed 的脚本中的 HTTP 标头，那就更好了。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T23:04:08.943

您不能从 RSS 提要中更改标题。但是，您可以`download.php`使用一些重写魔法隐藏该部分：

```
RewriteEngine on
RewriteRule ^download/.*$ /download.php?file=$1 [L] 
```

这将导致任何以 开头的 URL`/download/`都通过您的下载脚本运行：

*   `/img/foo.jpg`- 普通文件
*   `/download/img/foo.jpg`- 强制下载

你也可以在没有 PHP 的情况下做类似的事情：

```
RewriteEngine on
RewriteRule ^download/.*$ /$1 [L]

<Location /download>
    Header add Content-Disposition "attachment"
</Location> 
```

# php - 如何使用 LDAP 查询对 LDAP 结果进行排序？

> ID：10080752
> 
> 赞同：4
> 
> 时间：2012-04-09T22:37:41.580
> 
> 标签：php, ldap, ldap-query, novell

我正在使用 PHP 创建一个 LDAP 目录搜索，并且我们使用 Novell 作为我们的 LDAP 服务器。我能够成功搜索并返回结果；这是我正在运行的当前过滤器，`(&(FERPA=N)(|(uid=*searchphrase*)(sn=*searchphrase*)(fullName=*searchphrase*)(telephoneNumber=*searchphrase*)))`.

我希望能够按姓氏或 LDAP 变量排序`sn`。我可以通过 PHP 对其进行排序，但我希望这是最后的手段。有没有办法根据列对结果进行排序。例如，在 SQL 中，您可以基于这样的列进行排序`SELECT * FROM TABLE WHERE COL='criteria' ORDER BY COL;`，LDAP 查询可以做类似的事情吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T09:12:03.887

需要以可重复方式对搜索请求的结果进行排序的 LDAP 客户端应用程序应使用[服务器端排序扩展](https://www.rfc-editor.org/rfc/rfc2891)。在大多数情况下，使用服务器端排序扩展需要应用程序编码人员通知目录管理员，以便可以设置正确的索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T22:43:37.933

据我所知，无法使用 LDAP 过滤器对结果进行排序。过滤器所做的只是限制返回的条目。

使用 php，您将运行搜索，然后使用[http://us3.php.net/manual/en/function.ldap-sort.php对结果进行排序](http://us3.php.net/manual/en/function.ldap-sort.php)

或者，您可以将所有条目读入一个数组，然后在它们上运行 php 的其他排序函数之一。[http://us1.php.net/manual/en/array.sorting.php](http://us1.php.net/manual/en/array.sorting.php)

# javascript - 如何使用 .load() 防止主页加载到自身中

> ID：10080756
> 
> 赞同：1
> 
> 时间：2012-04-09T22:38:02.327
> 
> 标签：javascript, jquery

我有以下js：

```
$(function() {
    $('#header a').click(function() {
        $('#contentspace').empty();
        // $("#contentspace").load(eventUrl + "#content");
        $("#contentspace").load(this.href, + ' #content', function(response){
            console.log($('#content', response).html())
            event.preventDefault();
        });
    });
}); 
```

和html：

```
<div id="header" class="ui-corner-all ui-buttonset">
    <a title="index" href="index.php" ><span>home</span></a>
    <a title="code" href="code.php" ><span>code</span></a>
    <a title="design" href="design.php" ><span>design</span></a>
    <a title="illustration" href="illustration.php" ><span>illustration</span></a>
    <a title="writing" href="writing.php" ><span>writing</span></a>
    <a title="links" href="links.php" ><span>links</span></a>
    <a title="about" href="about.php" ><span>about</span></a>
</div> 
```

我用它来加载网页的各个部分`#contentspace`，并给我的练习网站一种 ajax 的感觉。当用户单击返回主页并且主页在其内部加载时，就会出现问题。我想我可能已经通过添加 论点`- ' #header',`来解决它`.load`，但这似乎没有任何作用，即使它有我也可以看到它会如何产生其他问题。

摘要：我在使用 jquery 制作有效的登录页面时遇到问题。主页正在将其页眉和页脚加载到自身中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:41:01.110

也许您可以将主页分成类似`index.html`and `home.html`，仅包含页眉和页脚的索引，而另一个仅包含主页内容的索引。

然后，您可以`.load`在页面最初加载时（例如，在您将点击处理程序附加到导航之前）使用“home.html”执行一次索引。

# java - 无限滚动画廊的文本自定义

> ID：10080757
> 
> 赞同：1
> 
> 时间：2012-04-09T22:38:03.060
> 
> 标签：java, android, android-gallery, android-custom-view

我有基于这个例子的无限画廊：

[http://blog.blundell-apps.com/infinite-scrolling-gallery/](http://blog.blundell-apps.com/infinite-scrolling-gallery/)，一切正常：

正是我想**将文本应用到每个图像**并**能够自定义文本**，如图所示，并且**每个图像的文本都比其他图像不同**，但仍然无法通过无限画廊成功做到这一点

![在此处输入图像描述](../Images/4987f09bbfeedb0c1784e7623fab7392.png)

我尝试使用以下代码，但 在运行应用程序时它给了我**FORCE CLOSE ，**

（也许我写了错误的代码，但我仍在学习 Java 和 Android 开发的初学者）。

请任何帮助和建议将不胜感激

多谢。

**我的代码：**

**GALLERY_ITEM**

```
<?xml version="1.0" encoding="utf-8"?> 
  <RelativeLayout  xmlns:android="http://schemas.android.com/apk/res/android"   
      android:id="@+id/LinearLayout01" 
      android:layout_width="fill_parent"   
      android:layout_height="fill_parent" 
      android:orientation="vertical"   
      android:gravity="center_horizontal">  
  <ImageView  
     android:id="@+id/image" 
     android:layout_height="300dp" 
     android:layout_width="fill_parent"          /> 
  <TextView   
    android:text="TextView" 
    android:id="@+id/textView1"  
    android:layout_width="fill_parent"  
    android:layout_height="fill_parent"  
    android:textColor="#B22222"    
    android:textSize="20dp"   
    android:gravity="center"   
    android:layout_margin="30dp"  
    android:layout_below="@+id/image"          /> 
```

**然后在 InfiniteScrollingGalleryActivity.java 中更改如下：**

```
 public class InfiniteScrollingGalleryActivity extends Activity {  

     /** Called when the activity is first created. */  
   @Override 
     public void onCreate(Bundle savedInstanceState) {  
     super.onCreate(savedInstanceState);  
        // Set the layout to use   
     setContentView(R.layout.main);  

   InfiniteGallery galleryOne = (InfiniteGallery) findViewById(R.id.galleryOne); 
   galleryOne.setAdapter(new InfiniteGalleryAdapter(this));    
        }      } 
```

**然后更改 InfiniteGalleryResourceAdapter.java 如下：**

```
 public class InfiniteGalleryAdapter extends BaseAdapter {

    /** The width of each child image */  
   private static final int G_ITEM_WIDTH = 360; 
   /** The height of each child image */  
  private static final int G_ITEM_HEIGHT = 240; 
  /** The context your gallery is running in (usually the activity) */ 
       private Context mContext;  
       private int imageWidth; 
       private int imageHeight;  
       private int[] imageIds;  

      public InfiniteGalleryAdapter(Context c, int[] imageIds) { 
            this.mContext = c;  
            this.imageIds = imageIds; }

      public int getCount() {   
        return Integer.MAX_VALUE;     } 
      public Object getItem(int position) { 
        return position;    } 
      public long getItemId(int position) {  
        return position;    }      

      private Activity activity;   
      private  LayoutInflater inflater=null; 

   public InfiniteGalleryAdapter(Activity a) {     
      final int[] imageIds;
     activity = a;  
     inflater = (LayoutInflater)activity.getSystemService
          Context.LAYOUT_INFLATER_SERVICE);          }   
      public  class ViewHolder{    
      public TextView text;     
      public ImageView image;         }  
  public View getView(int position, View convertView, ViewGroup parent) {  
     ImageView i = getImageView();  
 try {  

   int itemPos = (position % imageIds.length); 

   i.setImageResource(imageIds[itemPos]); 

  ((BitmapDrawable) i.getDrawable()).setAntiAlias(true); }

          catch (OutOfMemoryError e) {  

    Log.e("InfiniteGalleryResourceAdapter", "Out of memory creating imageview. 
        Using empty view.", e);     }  

     View vi=convertView; 

      ViewHolder holder;   

     if(convertView==null){   
        vi = inflater.inflate(R.layout.gallery_items, null);   
    holder=new ViewHolder();  
    holder.text=(TextView)vi.findViewById(R.id.textView1); 
    holder.image=(ImageView)vi.findViewById(R.id.image);      
    vi.setTag(holder);             }  
    else    
    holder=(ViewHolder)vi.getTag(); 
    holder.text.setText(name[position]);  

   final int stub_id=images[position]; 
   holder.image.setImageResource(stub_id);  
  return vi;         }

    private int[] images = {   
         R.drawable.one_1, R.drawable.one_4,  
         R.drawable.one_2, R.drawable.one_5, 
         R.drawable.one_3                    }; 

   private String[] name = {   
         "this is my car", "i love this",   
         "please hekp me", "im in park", 
         " This is nice place to visit.",          }; 

   private ImageView getImageView() {  
      setImageDimensions();  
     ImageView i = new ImageView(mContext);  
     i.setLayoutParams(new Gallery.LayoutParams(imageWidth, imageHeight)); 
     i.setScaleType(ScaleType.CENTER_INSIDE);     return i;      } 

 private void setImageDimensions() {   
      if (imageWidth == 0 || imageHeight == 0) {   
     imageWidth = AndroidUtils.convertToPix(mContext, G_ITEM_WIDTH);  
     imageHeight = AndroidUtils.convertToPix(mContext,G_ITEM_HEIGHT); 
        }         }      
           } 
```

这是 logcat 错误：

```
04-10 02:25:13.057: E/AndroidRuntime(12302): FATAL EXCEPTION: main
04-10 02:25:13.057: E/AndroidRuntime(12302): java.lang.NullPointerException
04-10 02:25:13.057: E/AndroidRuntime(12302):
at com.infinite.test.AndroidUtils.convertToPix(AndroidUtils.java:11)
04-10 02:25:13.057: E/AndroidRuntime(12302): 
at com.infinite.test.InfiniteGalleryAdapter.setImageDimensions
(InfiniteGalleryAdapter.java:131)
4-10 02:25:13.057: E/AndroidRuntime(12302):
at com.infinite.test.InfiniteGalleryAdapter.getImageView
(InfiniteGalleryAdapter.java:117)
04-10 02:25:13.057: E/AndroidRuntime(12302):
at com.infinite.test.InfiniteGalleryAdapter.getView(InfiniteGalleryAdapter.java:66)
04-10 02:25:13.057: E/AndroidRuntime(12302):
at android.widget.AbsSpinner.onMeasure(AbsSpinner.java:192)
04-10 02:25:13.057: E/AndroidRuntime(12302):
at android.view.View.measure( View.java:8366)
04-10 02:25:13.057: E/AndroidRuntime(12302):
at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3138)
04-10 02:25:13.057: E/AndroidRuntime(12302):
at android.widget.LinearLayout.measureChildBeforeLayout(LinearLayout.java:1017)
04-10 02:25:13.057: E/AndroidRuntime(12302):
at android.widget.LinearLayout.measureVertical(LinearLayout.java:386)
04-10 02:25:13.057: E/AndroidRuntime(12302):
at android.widget.LinearLayout.onMeasure(LinearLayout.java:309)
04-10 02:25:13.057: E/AndroidRuntime(12302):
at android.view.View.measure(View.java:8366)
04-10 02:25:13.057: E/AndroidRuntime(12302):
at android.view.ViewGroup.measureChildWithMargins(viewGroup.java:3138)
04-10 02:25:13.057: E/AndroidRuntime(12302):
at android.widget.FrameLayout.onMeasure(FrameLayout.java:250)
04-10 02:25:13.057: E/AndroidRuntime(12302):
at android.view.View.measure(View.java:8366)
04-10 02:25:13.057: E/AndroidRuntime(12302):
at android.widget.LinearLayout.measureVertical(LinearLayout.java:531)
04-10 02:25:13.057: E/AndroidRuntime(12302):
at android.widget.LinearLayout.onMeasure(LinearLayout.java:309)
04-10 02:25:13.057: E/AndroidRuntime(12302):
at android.view.View.measure(View.java:8366)
04-10 02:25:13.057: E/AndroidRuntime(12302):
at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3138)
04-10 02:25:13.057: E/AndroidRuntime(12302):
at android.widget.FrameLayout.onMeasure(FrameLayout.java:250)
04-10 02:25:13.057: E/AndroidRuntime(12302):
at android.view.View.measure(View.java:8366)
04-10 02:25:13.057: E/AndroidRuntime(12302):
at android.view.ViewRoot.performTraversals(ViewRoot.java:844)
04-10 02:25:13.057: E/AndroidRuntime(12302):
at android.view.ViewRoot.handleMessage(ViewRoot.java:1865)
04-10 02:25:13.057: E/AndroidRuntime(12302):
at android.os.Handler.dispatchMessage(Handler.java:99)
04-10 02:25:13.057: E/AndroidRuntime(12302):
at android.os.Looper.loop(Looper.java:123)
04-10 02:25:13.057: E/AndroidRuntime(12302):
at android.app.ActivityThread.main(ActivityThread.java:3687)
04-10 02:25:13.057: E/AndroidRuntime(12302):
at java.lang.reflect.Method.invokeNative(Native Method)
04-10 02:25:13.057: E/AndroidRuntime(12302):
at java.lang.reflect.Method.invoke    (Method.java:507)
04-10 02:25:13.057: E/AndroidRuntime(12302):
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:842)
04-10 02:25:13.057: E/AndroidRuntime(12302):
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600)
04-10 02:25:13.057: E/AndroidRuntime(12302):
at dalvik.system.NativeStart.main(Native Method)
04-10 02:25:13.061: E/(129): Dumpstate > /data/log/dumpstate_app_error 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T09:30:35.860

问题似乎在于图像的上下文变量和位置。为您的适配器尝试以下代码：

```
public class InfiniteGalleryAdapter extends BaseAdapter { 
/** The width of each child image */ 
private static final int G_ITEM_WIDTH = 360;   
/** The height of each child image */  
private static final int G_ITEM_HEIGHT = 240; 
/** The context your gallery is running in (usually the activity) */   
private Context mContext;       
private int imageWidth;     
private int imageHeight;   
private int[] imageIds;    
public InfiniteGalleryAdapter(Context c, int[] imageIds) {    
    this.mContext = c;          
    this.imageIds = imageIds; }   
public int getCount() {   
    return Integer.MAX_VALUE;   
}      
public Object getItem(int position) { 
    return position;    }  
public long getItemId(int position) { 
    return position;    }       
//private Activity activity;  
private  LayoutInflater inflater=null;
public InfiniteGalleryAdapter(Context a) {  
    final int[] imageIds;  
    //activity = a;   
    this.mContext = a;   
    inflater = (LayoutInflater)mContext.getSystemService   (        Context.LAYOUT_INFLATER_SERVICE);  
}          public  class ViewHolder{ 
    public TextView text;
    public ImageView image;   
}    

private int[] images = {  
        R.drawable.one_1, R.drawable.one_4,   
        R.drawable.one_2, R.drawable.one_5,   
        R.drawable.one_3               
};    
private String[] name = {   
        "this is my car", "i love this",   
        "please hekp me", "im in park",    
        " This is nice place to visit.",  
};       
public View getView(int position, View convertView, ViewGroup parent) { 
    ImageView i = getImageView(); 
    int itemPos = (position % images.length);  
    try {      

        i.setImageResource(images[itemPos]);  
        ((BitmapDrawable) i.getDrawable()).setAntiAlias(true); } 
    catch (OutOfMemoryError e) {     
        Log.e("InfiniteGalleryResourceAdapter", "Out of memory creating imageview.          Using empty view.", e);  
    }         View vi=convertView;     
    ViewHolder holder;  
    if(convertView==null){ 
        vi = inflater.inflate(R.layout.gallery_items, null);  
        holder=new ViewHolder();      
        holder.text=(TextView)vi.findViewById(R.id.textView1);   
        holder.image=(ImageView)vi.findViewById(R.id.image); 
        vi.setTag(holder);    
    }       else   
        holder=(ViewHolder)vi.getTag();  
    holder.text.setText(name[itemPos]); 
    final int stub_id=images[itemPos];  
    holder.image.setImageResource(stub_id); 
    return vi;     
}   

private ImageView getImageView() { 
    setImageDimensions();   

    ImageView i = new ImageView(mContext);   
    i.setLayoutParams(new Gallery.LayoutParams(imageWidth, imageHeight)); 
    i.setScaleType(ScaleType.CENTER_INSIDE);  
    return i;      }  
private void setImageDimensions() { 
    if (imageWidth == 0 || imageHeight == 0) {        
        imageWidth = AndroidUtils.convertToPix(mContext, G_ITEM_WIDTH);
        imageHeight = AndroidUtils.convertToPix(mContext,G_ITEM_HEIGHT); 
    }         }                  } 
```

# bash - 带有环境变量的 bash 脚本中的 JRuby 语句

> ID：10080762
> 
> 赞同：0
> 
> 时间：2012-04-09T22:38:24.003
> 
> 标签：bash, jruby, environment-variables, double-quotes

我有一个使用 Resque 作为作业队列的 Rails 应用程序。Resque 工人类是“JobDo”，位于 app/workers/job_do.rb

我有一个脚本（jobdo.sh），它将把一个工作放到队列中：

```
jruby -e 'load "/home/abc/myapp/app/workers/job_do.rb"; Resque.enqueue(JobDo, Time.now.utc)' >> /home/abc/logs/resque.log 2>&1 
```

但是...我希望能够在不使用相同日志文件、用户或 rails 应用程序根目录的 rails 环境中运行它。我看到做这样的事情：

```
export $USER_HOME=/home/abc
export $LOGFILE=$USER_HOME/logs/resque.log
export $SERVER_HOME=/home/abc/myapp

jruby -e 'load "$SERVER_HOME/app/workers/job_do.rb"; Resque.enqueue(JobDo,Time.now.utc)' >> $LOGFILE 2>&1 
```

这将允许任何用户编辑 $USER_HOME 和 $SERVER_HOME 并在他们的环境中运行代码。

但是，这不起作用，因为我无法弄清楚如何旋转单引号和双引号来使用环境变量。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T23:42:55.263

这里有几个问题。首先，分配给变量时，不要使用`$`. 其次，您不需要导出变量，因为它们在 shell 中使用，而不是（作为环境变量）传递给它运行的程序。第三，shell 不会替换单引号内的变量，因此您需要切换到双引号（然后转义要传递给 jruby 的双引号）。最后，我会用双引号括`$USER_HOME`起来`$LOGFILE`，以防它包含空格或任何其他有趣的字符。这是我得到的：

```
USER_HOME=/home/abc
LOGFILE="$USER_HOME/logs/resque.log"
SERVER_HOME=/home/abc/myapp

jruby -e "load \"$SERVER_HOME/app/workers/job_do.rb\"; Resque.enqueue(JobDo,Time.now.utc)" >> "$LOGFILE" 2>&1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T23:09:02.793

我认为您可以用双引号替换单引号，并删除内部引号：

```
export USER_HOME=/home/abc
export LOGFILE=$USER_HOME/logs/resque.log
export SERVER_HOME=/home/abc/myapp

jruby -e "load $SERVER_HOME/app/workers/job_do.rb; Resque.enqueue(JobDo,Time.now.utc)" >> $LOGFILE 2>&1 
```

只要没有任何变量包含空格，这应该可以工作。

# java - 对对象的字段进行快速排序

> ID：10080764
> 
> 赞同：0
> 
> 时间：2012-04-09T22:38:33.920
> 
> 标签：java, arrays, algorithm, quicksort

我必须做一个快速排序来创建一个“石头”数组我的问题是：我只想在“ValueySize”字段上进行快速排序，女巫是“值/大小”的结果有没有办法得到一个排序数组石头的价值YSize？

提前致谢 ;）

公共类 Stone 实现 Comparable{

```
private float[] value;
private float[] size;
private float[] valueYSize; 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T22:46:12.810

使用[Comparator](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Comparator.html)和[Arrays#sort](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Arrays.html#sort%28java.lang.Object%5B%5D,%20java.util.Comparator%29)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T22:41:31.827

您可以使用 Arrays 类中的 sort 方法：

```
float[] valueYSize       = //some operation......
float[] sortedValueYSize = Arrays.sort(valueYSize); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T22:49:36.950

如果您的类实现了 Comparable，则需要覆盖类中的 compareTo 方法 - 当您这样做时，返回 2 个比较对象的 valueYSize 之间的差异。

# java - 为外键关联编写查询

> ID：10080766
> 
> 赞同：0
> 
> 时间：2012-04-09T22:38:56.617
> 
> 标签：java, sql, hibernate

我在数据库用户和链接中有 2 个表。userid 在链接表中是外来的。我已经使用 hibernate reverse engg xml 在 java 中创建模型类。它创建了 User、Link、LinkId 类。这里的 Link 类链接了 2 个表，而 LinkId 包含了 Link 的属性。我正在尝试使用用户 ID 查询链接表。我的查询是“createQuery(”from com.paypal.socialpay.models.LinkId li where li.userid=?”).setInteger(0, id).list();”

但是在执行查询时，我得到“java.lang.IllegalArgumentException：查询中没有位置参数：来自 com.paypal.socialpay.models.LinkId li where li.userid=?”

有人可以告诉我我做错了什么

```
class name="com.paypal.socialpay.models.Link" table="link" catalog="socialdb">
    <composite-id name="id" class="com.paypal.socialpay.models.LinkId">
        <key-property name="id" type="int">
            <column name="id" />
        </key-property>
        <key-property name="userid" type="java.lang.Integer">
            <column name="userid" />
        </key-property>
        <key-property name="title" type="string">
            <column name="title" length="100" />
        </key-property>
        <key-property name="price" type="string">
            <column name="price" length="100" />
        </key-property>
        <key-property name="description" type="string">
            <column name="description" length="500" />
        </key-property>
        <key-property name="contentname" type="string">
            <column name="contentname" length="100" />
        </key-property>
        <key-property name="contentpreviewname" type="string">
            <column name="contentpreviewname" length="100" />
        </key-property>
        <key-property name="contentdisplayname" type="string">
            <column name="contentdisplayname" length="100" />
        </key-property>
        <key-property name="contentpreviewdisplayname" type="string">
            <column name="contentpreviewdisplayname" length="100" />
        </key-property>
        <key-property name="downloadlink" type="string">
            <column name="downloadlink" length="100" />
        </key-property>
        <key-property name="contentsavelocation" type="string">
            <column name="contentsavelocation" length="150" />
        </key-property>
        <key-property name="previewsavelocation" type="string">
            <column name="previewsavelocation" length="150" />
        </key-property>
    </composite-id>
    <many-to-one name="user" class="com.paypal.socialpay.models.User" update="false" insert="false" fetch="select">
        <column name="id" not-null="true" />
    </many-to-one>
</class> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:48:40.157

尝试使用这个：

```
session.createQuery("from Link where userid=:userId")
    .setParameter("userId", id)
    .list() 
```

更新：我相信映射应该是这样的：

```
 <id name="id" column="id">
      <generator class="native"/> 
    </id>
    <property name="userid" column="userid"/> 
```

等具有属性，而不是`<key-property>`s

查询不起作用，因为您试图从 LinkId 中进行选择 - 这不是实体，而是 Link 的键。可能是一些逆向工程问题。

# c# - C# 正则表达式错误未终止 [] 集

> ID：10080770
> 
> 赞同：3
> 
> 时间：2012-04-09T22:39:37.000
> 
> 标签：c#

我收到此错误（我正在使用 C#）：

> 解析 "(--[[. *?]])|(--[[.* )" - 未终止的 [] 集。

尝试添加 Lua 的多条注释代码时。应该是这样的：

```
--[[
  Hello
]] 
```

但是，当我在此正则表达式末尾取出 ']]' 时：

```
(--[[.*?]])|(--[[.*) 
```

它会给我这个错误。但是，如果我在上面添加']]'，例如：

```
(--[[.*?]])|(--[[.*]]) 
```

它工作得很好。

这是完整的代码：

```
Regex CustomCommentRegex1, CustomCommentRegex2, CustomCommentRegex3;
CustomCommentRegex1 = new Regex(@"--.*$", RegexOptions.Multiline | RegexCompiledOption);
CustomCommentRegex2 = new Regex(@"(--[[.*?]])|(--[[.*)", RegexOptions.Singleline | RegexCompiledOption);
CustomCommentRegex3 = new Regex(@"(--[[.*?]])|(.*]])", RegexOptions.Singleline | RegexOptions.RightToLeft | RegexCompiledOption); 
```

'CustomCommentRegex2' 是我得到这个 'Unterminated [] set' 错误的地方。如果我在“CustomCommentRegex2”的末尾添加“]]”，我会遇到问题。它将突出显示“--[[ ]]”上方的文本及其内部的注释；无论如何，问题是这个'Unterminated [] set'错误。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-09T22:46:11.953

从正则[表达式](http://www.regular-expressions.info/characters.html)网站

> 因为我们想做的不仅仅是搜索文字片段，我们需要保留某些字符以供特殊使用。在本教程中讨论的正则表达式风格中，**有 11 个具有特殊含义*的字符：左方括号 [***、反斜杠 \、插入符号 ^、美元符号 $、句点或点 .、竖线或竖线符号 |、问号 ?、星号或星号 *、加号 +、左圆括号（和右圆括号）。这些特殊字符通常称为“元字符”。

用 \ 转义括号

```
(--\[\[.*?]])|(--\[\[.*) 
```

# xquery - Xquery 返回多个值而不是一个

> ID：10080771
> 
> 赞同：1
> 
> 时间：2012-04-09T22:39:52.187
> 
> 标签：xquery

考虑 xml 文件：

```
<warehouse>
- may be some tag on upper level of dep present, may be not
<dep no ="2">
    <item>
        <itemName> Item 1  </itemName>
        <supplier> Supp1 </supplier>
        <supplier> Supp2 </supplier>
    </item>
</dep>
<dep no ="1">
    <item>
        <itemName> Item 2  </itemName>
        <supplier> Supp1 </supplier>
        <supplier> Supp3 </supplier>
    </item>
</dep>
.......
</warehouse> 
```

注意： dep 标签上方可能有一些标签，或者它们可能丢失。

我需要在列表中显示供应商列表，他们生产的项目名称以及每个项目前面的部门名称，例如

```
Supp2
 Item1, 2
Supp1
 Item1, 2
 Item2, 1 
```

这是我的代码：

```
<ul>
{
for $sup in distinct-values(doc("warehouse.xml")//supplier)
for $item in doc("warehouse.xml")//item[supplier = $sup]

return <li>{data($sup)} <ul> {
let $n:= $item/itemName
let $y:= doc("warehouse.xml")//dep[//itemName=$n]/@no 
for $n1 in $n return <li>{data($n1), data($y)} </li>} </ul> </li>
}
</ul> 
```

我面临两个问题。首先是 y 显示所有部门编号，从 1 开始。另一个是如果我有 1 个供应商生产两个项目，而不是

```
Supp1
 Item1, 2
 Item2, 3 
```

我明白了

```
Supp1
 Item1, 1,2, ...
Supp1
 Item2, 1,2, ... 
```

你能建议什么可能是错的吗？我深表感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T12:53:15.430

作为 XQuery 的新手，我可以编写以下内容。

输入：

```
<warehouse>
  <something/>
  <dep no ="2">
    <item>
      <itemName>Item1</itemName>
      <supplier>Supp1</supplier>
      <supplier>Supp2</supplier>
    </item>
  </dep>
  <anything/>
  <dep no ="1">
    <item>
      <itemName>Item2</itemName>
      <supplier>Supp1</supplier>
      <supplier>Supp3</supplier>
    </item>
  </dep>
  <whatever/>
</warehouse> 
```

询问：

```
<ul>{
(: the ../text() can be dropped from everywhere :)
let $doc := doc("input.xml")    
for $supplier in distinct-values($doc//supplier/text())
let $items := $doc//item[supplier/text() = $supplier]/itemName/text()
return <li>{$supplier}: {string-join($items, ", ")}</li>
}</ul> 
```

输出：

```
<ul>
  <li>Supp1: Item1, Item2</li>
  <li>Supp2: Item1</li>
  <li>Supp3: Item2</li>
</ul> 
```

查询背后的理论*如下。*

*   因为您要列出基本上要按供应*商分组的*每个供应商的项目名称。为此，您必须遍历输入中存在的每个唯一供应商：

    ```
    distinct-values($doc//supplier/text()) 
    ```

*   在此之后，您要列出与给定供应商关联的每个项目：

    ```
    $doc//item[supplier/text() = $supplier]/itemName/text() 
    ```

    这意味着您获取输入中供应商名称与给定供应商名称相同的每个项目，然后您将获得这些（过滤的）项目的名称。

就是这样。希望我有点道理！

# tabs - Intellij IDEA 11.0.2，为自定义文件类型设置标签大小？

> ID：10080772
> 
> 赞同：2
> 
> 时间：2012-04-09T22:40:00.013
> 
> 标签：tabs, intellij-idea

我正在使用完全许可的 Idea 版本。

我刚刚为 *.jade 文件创建了一个自定义文件类型。通常，我使用 4 个空格的制表符大小，但对于 *.jade 文件，我想使用 2 个空格的大小。

而已。我不想变通。我希望能够仅为 *.jade 文件设置特定的选项卡大小。

[http://www.jetbrains.com/idea/features/code_style.html](http://www.jetbrains.com/idea/features/code_style.html)

说：“...可以为每个文件类型指定制表符和缩进大小。”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T08:27:45.247

目前无法为自定义文件类型单独指定缩进设置。此类功能由特定于语言的插件提供（甚至某些语言插件也不允许设置自定义缩进并使用“常规”选项卡中的设置）。

7 年前已经提交了一个[功能请求，并且投票数为零。](http://youtrack.jetbrains.com/issue/IDEABKL-1889)随意投票。

# javascript - 如何刷新/获取新的 google adsense 内容？

> ID：10080775
> 
> 赞同：0
> 
> 时间：2012-04-09T22:40:18.430
> 
> 标签：javascript, html, adsense

我有一个网站，当用户向下滚动时，新内容会通过 ajax 更新。只要用户滚动新数据，就会出现一种无限页面。我在侧面有一个 adsense 摩天大楼代码，但它位于页面顶部，我想在通过 Ajax 加载新内容时刷新，这样我就可以将其定位得更靠下。这可能吗？这合法吗？这是我需要的一个紧密示例：http: [//imgur.com/gallery](http://imgur.com/gallery) 如您所见，他们在右侧有一个广告，每次通过滚动更新新内容时，都会显示一个新广告并保留旧广告到位。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-28T06:44:45.880

请记住，从他们的银行账户转到您的账户的是 Google 的钱。他们**确实**会随机检查网站以确保其合规，并且他们已经并将继续关闭他们认为的网站 [并且没有上级法院可诉，他们做出最终决定] 锁定您的帐户，扣留您的收入，并永远禁止您的 (( CURRENT )) Google Adsense 帐户。

您可以赚取的额外几美分与您可能损失的风险 -

最终的选择是你的。愿原力与你同在。:o)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T22:44:10.373

这是不允许的。阅读广告词的[服务条款](https://www.google.com/adsense/localized-terms)。

但一种方法是

```
var googleCode = '...your google code';
document.getElementById('googlediv').innerHTML(googlecode); 
```

但是，请阅读[此](https://stackoverflow.com/a/441425/295264)答案以获取更多信息。

# ruby - Rubygem 可执行文件 $LOAD_PATH 问题

> ID：10080776
> 
> 赞同：1
> 
> 时间：2012-04-09T22:40:18.630
> 
> 标签：ruby, rubygems, load-path

我正在用 Ruby 编写一个 IDE，当我在命令行上运行该程序以及将其安装为 Rubygem 时，我对如何让我的所有文件都获得“必需”感到困惑。

我的 Rubygem 中有一个名为“vr”的可执行文件。我需要使这个“vr”可执行文件“需要”我项目中的所有其他文件。

当我在开发时，很容易需要我所有的项目文件。我只是像这样“要求”它们的相对路径：

```
require_all Dir.glob(File.expand_path(File.dirname(__FILE__)) + "/../bin/**/*.rb") 
```

require_all gem 将完美运行。但是，当我将此程序安装为 ruby​​gem 时，我遇到了一个大问题。当我的“vr”可执行文件由 ruby​​gems 安装时，它会将“vr”可执行文件复制到一个特殊目录：

```
/home/eric/.rvm/gems/ruby-1.9.3-p125/bin 
```

该目录与我项目的根文件夹完全分开。因此，“require”语句不再找到我所有项目的文件。

Rubygems 为我的 gem 的根目录创建了这个目录：

```
/home/eric/.rvm/gems/ruby-1.9.3-p125/visualruby-0.0.55 
```

我需要能够将该目录中的所有文件“要求”到我的项目中。

到目前为止，我的解决方案是制作第二个名为“visualruby.rb”的文件，该文件位于我项目的 lib 文件夹中。它有 require_all 语句来要求所有项目文件。然后我只需要通过将此代码添加到我的“vr”可执行文件中来将可执行文件链接到它：

```
base_file = File.dirname(__FILE__) + '/lib/visualruby.rb'
if File.file?(base_file) 
  require base_file  #load from project
else
  require 'visualruby.rb'  #load from gem
end 
```

有必要检查相对于当前文件是否有一个名为“visualruby.rb”的文件，因为当我开发时，它总是会找到已安装的gem版本的“visualruby.rb”所以当我对文件进行更改时, 没有效果。我必须强制它从我的开发项目中加载版本才能使更改生效。

此外，我的 IDE 从头开始​​创建项目，因此很高兴知道对此的一般解决方案。我希望所有项目都有一个一致的项目文件系统，但我不确定这是否可能。我有为所有项目创建一个名为“requires.rb”的文件的通用解决方案，但我认为它不会起作用，因为每个项目都会将相同的文件名添加到 $LOAD_PATH。

请帮助我了解如何在我可以开发和制作 ruby​​gems 的地方制作一致的文件结构。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T06:55:16.647

我找到了自己问题的答案：

问题是我正在使用 ruby​​gems API 安装我的 ruby​​gems：

```
Gem::Installer.new(file_name) 
```

这创建了搞乱我的路径的系统链接。可以选择制作包装器而不是 syslinks，这似乎是标准的安装方式：

```
Gem::Installer.new(file_name, :wrappers => true) 
```

现在 a 包装器被复制到我的 gem 的 bin 目录中，并且它使用正确的路径。现在我可以拥有一个可以制作成 gem 的通用文件。一切在开发和 gem 中运行都是一样的。

一个圆满的结局...

# maven-2 - 如何将自定义服务组合功能 (features.xml) 上传到内部 Archiva maven 存储库

> ID：10080777
> 
> 赞同：1
> 
> 时间：2012-04-09T22:40:20.247
> 
> 标签：maven-2, apache-servicemix, archiva

我有一个自定义创建的服务组合功能，它通常是一个 features.xml 文件。现在我想将它上传到 Archiva maven 存储库并使用它来安装它作为服务组合功能。引用具有 .xml 扩展名的文件的打包类型是什么。

要在服务组合中安装，我们使用命令 features：addUrl mvn:abc/abc/1.0/xml/features。

当我尝试使用 abc 作为组 ID、abc 作为工件 ID、1.0 作为版本和 pom 作为包装类型上传时，我无法使其工作。我该怎么做才能让它发挥作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T23:35:34.433

您可以使用以下原型生成 karaf 功能项目，对其进行自定义，然后使用 'mvn install' 使用 maven 构建它

```
mvn archetype:generate \
    -DarchetypeGroupId=org.apache.karaf.archetypes \
    -DarchetypeArtifactId=karaf-feature-archetype \
    -DarchetypeVersion=2.2.6 \
    -DgroupId=my.company \
    -DartifactId=my.company.feature \
    -Dversion=1.0-SNAPSHOT \
    -Dpackage=my.company.package 
```

有关更多信息，请参阅[http://karaf.apache.org/manual/2.2.6/developers-guide/archetypes.html](http://karaf.apache.org/manual/2.2.6/developers-guide/archetypes.html)

# javascript - jQuery 加载函数和表格

> ID：10080779
> 
> 赞同：0
> 
> 时间：2012-04-09T22:40:36.523
> 
> 标签：javascript, html

在我的网站上，它显示了一个数据表。

我有一个链接，它将从 URL 加载另一个数据表。

```
$("#another").click(function() {
    var newGeneration = $('<p />').load('another.php?cycle=' + i);
    $('tbody').append(newGeneration);
    i++;
}); 
```

有没有办法让它不添加 ap 标签而直接将文件加载到 tbody 中？我尝试将其更改为 tr，但这只是将 trs 放在 trs 中。

显示另一个结果的代码

```
echo "<tr>";
echo "<td>" . $keys[$k] . "</td>";
echo "<td>" . $jobs[$k] . "</td>";
echo "</tr>"; 
```

我不想发生的事情（就像现在一样）

![不想要 p 标签](../Images/86c3da0d196d8291e637b0e0243cf403.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:51:23.943

我认为最好发送一个 get 请求而不是使负载的使用复杂化。

```
$("#another").click(function() {
    $.get('another.php', { 'cycle' : i }, function(data) {
         $('tbody').append(data);
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T22:46:37.803

尝试从元素中获取 html() ：

```
$("#another").click(function() {
    var newGeneration = $('<p />').load('another.php?cycle=' + i);
    $('tbody').append(newGeneration.html());
    i++;
}); 
```

# python - Python：datetime.astimezone 相对于 US/Pacific 和 America/Los_Angeles 时区的奇怪行为？

> ID：10080790
> 
> 赞同：4
> 
> 时间：2012-04-09T22:41:45.613
> 
> 标签：python, datetime, timezone

请注意：

```
C:\dev\poc\SDR>python
Python 2.7.1 (r271:86832, Nov 27 2010, 17:19:03) [MSC v.1500 64 bit (AMD64)] on win32
Type "help", "copyright", "credits" or "license" for more information.
>>> from pytz import timezone
>>> from datetime import datetime
>>> tz1=timezone('America/Los_Angeles')
>>> tz2=timezone('US/Pacific')
>>> ts1=datetime(2011,8,1,tzinfo=tz1)
>>> ts2=datetime(2011,8,1,tzinfo=tz2)
>>> ts1
datetime.datetime(2011, 8, 1, 0, 0, tzinfo=<DstTzInfo 'America/Los_Angeles' PST-1 day, 16:00:00 STD>)
>>> ts2
datetime.datetime(2011, 8, 1, 0, 0, tzinfo=<DstTzInfo 'US/Pacific' PST-1 day, 16:00:00 STD>)
>>> ts1.astimezone(tz1)
datetime.datetime(2011, 8, 1, 0, 0, tzinfo=<DstTzInfo 'America/Los_Angeles' PST-1 day, 16:00:00 STD>)
>>> ts2.astimezone(tz2)
datetime.datetime(2011, 8, 1, 0, 0, tzinfo=<DstTzInfo 'US/Pacific' PST-1 day, 16:00:00 STD>)
>>> ts1.astimezone(tz2)
datetime.datetime(2011, 8, 1, 1, 0, tzinfo=<DstTzInfo 'US/Pacific' PDT-1 day, 17:00:00 DST>)
>>> ts2.astimezone(tz1)
datetime.datetime(2011, 8, 1, 1, 0, tzinfo=<DstTzInfo 'America/Los_Angeles' PDT-1 day, 17:00:00 DST>)
>>> 
```

这是我不明白的。US/Pacific ( `tz1`) 和 America/Los_Angeles ( `tz2`) 应该表示相同的时区，不是吗？`datetime.astimezone`那么，从一个区域移动到另一个区域的呼唤怎么会改变时间呢？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T22:43:55.350

夏令时。请注意，最后两个条目是 Listing `PDT-1`。

`astimezone`考虑到 DST，但前提是它实际上经过了完整的逻辑。

您的示例中的前两个`astimezone`调用*没有*经过完整的逻辑，因为它们短路（因为它们转换“到”的时区已经与它们转换“从”的时区匹配）。

(You might wonder why the initial datetimes aren't using PDT already. This is because the `datetime` constructor [doesn't take into account daylight savings time](http://pytz.sourceforge.net/#localized-times-and-date-arithmetic), even if you pass it a timezone - it just sets the timezone blindly.)

# ruby-on-rails - Ruby - 渲染引用我从未编写过的循环的视图时出错

> ID：10080791
> 
> 赞同：0
> 
> 时间：2012-04-09T22:42:04.483
> 
> 标签：ruby-on-rails, ruby

我有这个控制器：

```
class AlexesController < ApplicationController
  # GET /alexes
  # GET /alexes.json
  def index
    #@alexes = Alex.all

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @alexes }
    end
  end

  # GET /alexes/1
  # GET /alexes/1.json
  def show
  #  @alex = Alex.find(params[:id])

    respond_to do |format|
      format.html # show.html.erb
      format.json { render json: @alex }
    end
  end

  # GET /alexes/new
  # GET /alexes/new.json
  def new
    @alex = Alex.new

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @alex }
    end
  end

  # GET /alexes/1/edit
  def edit
    @alex = Alex.find(params[:id])
  end

  # POST /alexes
  # POST /alexes.json
  def create
    @alex = Alex.new(params[:alex])

    respond_to do |format|
      if @alex.save
        format.html { redirect_to @alex, notice: 'Alex was successfully created.' }
        format.json { render json: @alex, status: :created, location: @alex }
      else
        format.html { render action: "new" }
        format.json { render json: @alex.errors, status: :unprocessable_entity }
      end
    end
  end

  # PUT /alexes/1
  # PUT /alexes/1.json
  def update
    @alex = Alex.find(params[:id])

    respond_to do |format|
      if @alex.update_attributes(params[:alex])
        format.html { redirect_to @alex, notice: 'Alex was successfully updated.' }
        format.json { head :no_content }
      else
        format.html { render action: "edit" }
        format.json { render json: @alex.errors, status: :unprocessable_entity }
      end
    end
  end

  # DELETE /alexes/1
  # DELETE /alexes/1.json
  def destroy
    @alex = Alex.find(params[:id])
    @alex.destroy

    respond_to do |format|
      format.html { redirect_to alexes_url }
      format.json { head :no_content }
    end
  end
end 
```

按下此链接时会调用它：

```
<%= link_to "Alex Link", alexes_path(@alex) %> 
```

所以我假设控制器的 get-all 部分会被调用，我在控制器中注释掉了我认为会被调用的行，但我仍然得到这个错误：

```
undefined method `each' for nil:NilClass 
```

从第 10 行开始：

```
7:     <th></th>
8:   </tr>
9: 
10: <% @alexes.each do |alex| %>
11:   <tr>
12:     <td><%= link_to 'Show', alex %></td>
13:     <td><%= link_to 'Edit', edit_alex_path(alex) %></td> 
```

知道问题出在哪里吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:48:55.517

```
<%= link_to "Alex Link", alexes_path(@alex) %> 
```

=>

```
<%= link_to "Alex Link", alex_path(@alex) %> 
```

或者

```
<%= link_to "Alex Link", @alex %> 
```

# javascript - 如何使框架不可滚动？

> ID：10080795
> 
> 赞同：0
> 
> 时间：2012-04-09T22:42:46.230
> 
> 标签：javascript, html, css

虽然。滚动是“否”，溢出被隐藏，浏览器不显示滚动等，但我可以通过鼠标中键滚动。我希望用户无论如何都无法滚动。此外，框架集具有： rows="50,*" 并且框架内的东西再次不高于 50 像素，它可以滚动几个像素。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T23:06:35.437

在 iframe 中添加以下代码：

```
$(document).on('mousewheel keydown', function (event) {

    //if the mousewheel event is being fired or if a keydown event with one of the blacklisted keycodes
    if (event.type == 'mousewheel' || event.which in { 40 : 0, 38 : 0, 104 : 0, 98 : 0, 32 : 0 }) {

        //then prevent the scroll from occuring
        return false;
    }
});​​​ 
```

这是一个演示：http: [//jsfiddle.net/9Z2ru/](http://jsfiddle.net/9Z2ru/)

我尝试通过`return`ing`false`为`scroll`事件禁用滚动，但不能以这种方式禁用它（至少在 Chrome 18 中，尽管我怀疑大多数（如果不是全部）浏览器都是相同的）。

# ios - 在 UIViewController 上设置 UINavigation Controller 作为 rootView

> ID：10080796
> 
> 赞同：0
> 
> 时间：2012-04-09T22:42:48.693
> 
> 标签：ios, uiviewcontroller, uitabbarcontroller

我有一个 tabBarApplication 作为模板，每个选项卡上都有一个 UINavigation 模板。

我想使用该示例（有点）并将其转换为另一个应用程序中的单个 UIViewController。我已经展示了 2 段代码，第一个是我的模板，后者是我正在尝试制作的。谁能给我一些提示或帮助如何做到这一点？我不断收到错误，但它们对我来说没有意义，因为 tabBarApp 不需要它声明的 viewController。

第一个代码（示例）：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
[self setupFetchedResultsController];

if (![[self.fetchedResultsController fetchedObjects] count] > 0 ) {
    NSLog(@"!!!!! ~~> There's nothing in the database so defaults will be inserted");
    [self importCoreDataDefaultRoles];
}
else {
    NSLog(@"There's stuff in the database so skipping the import of default data");
}

// The Tab Bar
UITabBarController *tabBarController = (UITabBarController *)self.window.rootViewController;

// The Two Navigation Controllers attached to the Tab Bar (At Tab Bar Indexes 0 and 1)
UINavigationController *personsTVCnav = [[tabBarController viewControllers] objectAtIndex:0];
UINavigationController *rolesTVCnav = [[tabBarController viewControllers] objectAtIndex:1];
return YES;
} 
```

第二个代码（我想要做的）：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
[self setupFetchedResultsController];

if (![[self.fetchedResultsController fetchedObjects] count] > 0 ) {
    NSLog(@"!!!!! ~~> There's nothing in the database so defaults will be inserted");
    [self importCoreDataDefaultRoles];
}
else {

UIViewController *mainViewController = (UIViewController *)self.window.rootViewController;

UINavigationController *readingsTVCnav = [[mainViewController viewController] objectAtIndex:0];

// Override point for customization after application launch.
return YES;
} 
```

代码的获取部分与已经设置和工作的核心数据相关。此更改的原因是我希望将普通视图控制器设置为初始屏幕而不是 tabBarConfiguration。

干杯杰夫

编辑：为了清楚起见，我添加了一张图片

![在此处输入图像描述](../Images/cb46ee213b7436e80cb3521ddcd91af8.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T00:28:23.957

根据您在图像中描述和描绘的内容，您已将导航控制器设置为应用程序的根视图控制器。因此，您可以在应用程序委托的方法中访问它（如果需要），`didFinishLaunchingWithOptions:`如下所示：

```
UINavigationController *navController = (UINavigationController *)self.window.rootViewController; 
```

尽管对于您的应用程序，我认为您没有任何理由需要从您的应用程序委托中引用导航控制器。您需要的所有设置（除了您所说的已经工作的代码数据代码）都可以通过情节提要处理。

在您的 nagivationController 的根 viewController（具有所有按钮的那个）中，您应该设置从每个按钮到故事板中适当的 viewController 的 segue。Bure 确保将其设置为“push”segues，以便它将视图控制器推送到您的 navigationController 的导航堆栈上。如果发生 segue 时需要对子视图控制器进行任何特定设置，则可以实现如下`prepareForSegue:`方法：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"ShowMyViewController"]) {

        MyViewController *vc = (MyViewController*)segue.destinationViewController;       
        vc.title = @"My Title";
        vc.someProperty = @"Some Value";
    }
} 
```

您可以（并且应该）使用唯一标识符标识情节提要中的每个转场，以便在调用此方法时可以识别它们。

# c++ - make_shared、make_pair 等叫什么？

> ID：10080797
> 
> 赞同：1
> 
> 时间：2012-04-09T22:42:50.970
> 
> 标签：c++, terminology

设计用于利用模板推导实例化其模板类对应物的函数类型有一个正式名称。`std::make_pair`是这种方法的一个典型例子。我想到了“辅助方法”这个词，但我记得有一个更具体的词……我只是不记得了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T23:18:03.057

我不确定还有比“工厂功能”更正式的名称。我不会称它为“方法”，因为它不在课堂上。

[Boost 文档](http://www.boost.org/doc/libs/1_39_0/libs/smart_ptr/make_shared.html)以及Microsoft 的 STL 大师 Stephen T Lavavej 的[这篇博](http://blogs.msdn.com/b/vcblog/archive/2009/02/03/rvalue-references-c-0x-features-in-vc10-part-2.aspx)文中都支持这种用法。

# java - 在 mahout 上运行 wikipedia bayes 示例时出现 OutOfMemory 错误

> ID：10080800
> 
> 赞同：0
> 
> 时间：2012-04-09T22:42:58.490
> 
> 标签：java, hadoop, mahout

我用 7 gig wiki 备份运行 mahout wikipedia 示例..，但是在测试分类器时，我得到了 OutOfMemory 错误

我粘贴了下面的输出，我将 mahout 堆大小和 java 堆大小设置为 2500m

```
$MAHOUT_HOME/bin/mahout testclassifier -m wikipediamodel -d wikipediainput

run with heapsize 2500
-Xmx2500m
MAHOUT_LOCAL is not set; adding HADOOP_CONF_DIR to classpath.

Running on hadoop, using HADOOP_HOME=/home/hduser/hadoop/hadoop
No HADOOP_CONF_DIR set, using /home/hduser/hadoop/hadoop/conf 
MAHOUT-JOB: /home/nauman/mahout/examples/target/mahout-examples-0.7-SNAPSHOT-job.jar
12/04/10 00:06:18 INFO common.HadoopUtil: Deleting wikipediainput-output
12/04/10 00:06:18 INFO jvm.JvmMetrics: Initializing JVM Metrics with processName=JobTracker, sessionId=
12/04/10 00:06:18 WARN mapred.JobClient: Use GenericOptionsParser for parsing the arguments. 

Applications should implement Tool for the same.

12/04/10 00:06:18 INFO mapred.FileInputFormat: Total input paths to process : 1
12/04/10 00:06:18 INFO mapred.JobClient: Running job: job_local_0001
12/04/10 00:06:18 INFO mapred.FileInputFormat: Total input paths to process : 1
12/04/10 00:06:18 INFO mapred.MapTask: numReduceTasks: 1
12/04/10 00:06:18 INFO mapred.MapTask: io.sort.mb = 100
12/04/10 00:06:19 INFO mapred.MapTask: data buffer = 79691776/99614720
12/04/10 00:06:19 INFO mapred.MapTask: record buffer = 262144/327680
12/04/10 00:06:19 INFO bayes.BayesClassifierMapper: Bayes Parameter {basePath=wikipediamodel, classifierType=bayes, dataSource=hdfs, alpha_i=1.0, gramSize=1, verbose=false, encoding=UTF-8, confusionMatrix=null, defaultCat=unknown, testDirPath=wikipediainput}
12/04/10 00:06:19 INFO bayes.BayesClassifierMapper: {basePath=wikipediamodel, classifierType=bayes, dataSource=hdfs, alpha_i=1.0, gramSize=1, verbose=false, encoding=UTF-8, confusionMatrix=null, defaultCat=unknown, testDirPath=wikipediainput}
12/04/10 00:06:19 INFO bayes.BayesClassifierMapper: Testing Bayes Classifier
12/04/10 00:06:19 INFO mapred.JobClient:  map 0% reduce 0%
12/04/10 00:06:20 INFO bayes.SequenceFileModelReader: Read 50000 feature weights
12/04/10 00:06:20 INFO bayes.SequenceFileModelReader: Read 100000 feature weights
12/04/10 00:06:21 INFO bayes.SequenceFileModelReader: Read 150000 feature weights
12/04/10 00:06:21 INFO bayes.SequenceFileModelReader: Read 200000 feature weights
12/04/10 00:06:21 INFO bayes.SequenceFileModelReader: Read 250000 feature weights
12/04/10 00:06:21 INFO mapred.LocalJobRunner: file:/home/nauman/wikipediainput/part-r-00000:0+33554432
12/04/10 00:06:22 INFO bayes.SequenceFileModelReader: Read 300000 feature weights
12/04/10 00:06:22 INFO bayes.SequenceFileModelReader: Read 350000 feature weights
12/04/10 00:06:22 INFO bayes.SequenceFileModelReader: Read 400000 feature weights
12/04/10 00:06:22 INFO bayes.SequenceFileModelReader: Read 450000 feature weights
12/04/10 00:06:23 INFO bayes.SequenceFileModelReader: Read 500000 feature weights
12/04/10 00:06:23 INFO bayes.SequenceFileModelReader: Read 550000 feature weights
12/04/10 00:06:23 INFO bayes.SequenceFileModelReader: Read 600000 feature weights
12/04/10 00:06:23 INFO bayes.SequenceFileModelReader: Read 650000 feature weights
12/04/10 00:06:23 INFO bayes.SequenceFileModelReader: Read 700000 feature weights
12/04/10 00:06:23 INFO bayes.SequenceFileModelReader: Read 750000 feature weights
12/04/10 00:06:23 INFO bayes.SequenceFileModelReader: Read 800000 feature weights
12/04/10 00:06:23 INFO bayes.SequenceFileModelReader: Read 850000 feature weights
12/04/10 00:06:24 INFO bayes.SequenceFileModelReader: Read 900000 feature weights
12/04/10 00:06:25 INFO bayes.SequenceFileModelReader: Read 950000 feature weights
12/04/10 00:06:25 INFO bayes.SequenceFileModelReader: Read 1000000 feature weights
12/04/10 00:06:25 INFO bayes.SequenceFileModelReader: Read 1050000 feature weights
12/04/10 00:06:26 INFO bayes.SequenceFileModelReader: Read 1100000 feature weights
12/04/10 00:06:26 INFO bayes.SequenceFileModelReader: Read 1150000 feature weights
12/04/10 00:06:26 INFO bayes.SequenceFileModelReader: Read 1200000 feature weights
12/04/10 00:06:26 INFO bayes.SequenceFileModelReader: Read 1250000 feature weights
12/04/10 00:06:26 INFO bayes.SequenceFileModelReader: Read 1300000 feature weights
12/04/10 00:06:26 INFO bayes.SequenceFileModelReader: Read 1350000 feature weights
12/04/10 00:06:26 INFO bayes.SequenceFileModelReader: Read 1400000 feature weights
12/04/10 00:06:26 INFO bayes.SequenceFileModelReader: Read 1450000 feature weights
12/04/10 00:06:26 INFO bayes.SequenceFileModelReader: Read 1500000 feature weights
12/04/10 00:06:27 INFO bayes.SequenceFileModelReader: Read 1550000 feature weights
12/04/10 00:06:27 INFO bayes.SequenceFileModelReader: Read 1600000 feature weights
12/04/10 00:06:27 INFO bayes.SequenceFileModelReader: Read 1650000 feature weights
12/04/10 00:06:27 INFO bayes.SequenceFileModelReader: Read 1700000 feature weights
12/04/10 00:06:27 INFO bayes.SequenceFileModelReader: Read 1750000 feature weights
12/04/10 00:06:27 INFO bayes.SequenceFileModelReader: Read 1800000 feature weights
12/04/10 00:06:28 INFO bayes.SequenceFileModelReader: Read 1850000 feature weights
12/04/10 00:06:28 INFO bayes.SequenceFileModelReader: Read 1900000 feature weights
12/04/10 00:06:30 INFO bayes.SequenceFileModelReader: Read 1950000 feature weights
12/04/10 00:06:30 INFO bayes.SequenceFileModelReader: Read 2000000 feature weights
12/04/10 00:06:30 INFO bayes.SequenceFileModelReader: Read 2050000 feature weights
12/04/10 00:06:30 INFO bayes.SequenceFileModelReader: Read 2100000 feature weights
12/04/10 00:06:30 INFO bayes.SequenceFileModelReader: Read 2150000 feature weights
12/04/10 00:06:30 INFO bayes.SequenceFileModelReader: Read 2200000 feature weights
12/04/10 00:06:30 INFO bayes.SequenceFileModelReader: Read 2250000 feature weights
12/04/10 00:06:30 INFO bayes.SequenceFileModelReader: Read 2300000 feature weights
12/04/10 00:06:30 INFO bayes.SequenceFileModelReader: Read 2350000 feature weights
12/04/10 00:06:31 INFO bayes.SequenceFileModelReader: Read 2400000 feature weights
12/04/10 00:06:31 INFO bayes.SequenceFileModelReader: Read 2450000 feature weights
12/04/10 00:06:31 INFO bayes.SequenceFileModelReader: Read 2500000 feature weights
12/04/10 00:06:31 INFO bayes.SequenceFileModelReader: Read 2550000 feature weights
12/04/10 00:06:31 INFO bayes.SequenceFileModelReader: Read 2600000 feature weights
12/04/10 00:06:31 INFO bayes.SequenceFileModelReader: Read 2650000 feature weights
12/04/10 00:06:31 INFO bayes.SequenceFileModelReader: Read 2700000 feature weights
12/04/10 00:06:32 INFO bayes.SequenceFileModelReader: Read 2750000 feature weights
12/04/10 00:06:32 INFO bayes.SequenceFileModelReader: Read 2800000 feature weights
12/04/10 00:06:32 INFO bayes.SequenceFileModelReader: Read 2850000 feature weights
12/04/10 00:06:32 INFO bayes.SequenceFileModelReader: Read 2900000 feature weights
12/04/10 00:06:32 INFO bayes.SequenceFileModelReader: Read 2950000 feature weights
12/04/10 00:06:32 INFO bayes.SequenceFileModelReader: Read 3000000 feature weights
12/04/10 00:06:32 INFO bayes.SequenceFileModelReader: Read 3050000 feature weights
12/04/10 00:06:33 INFO bayes.SequenceFileModelReader: Read 3100000 feature weights
12/04/10 00:06:33 INFO bayes.SequenceFileModelReader: Read 3150000 feature weights
12/04/10 00:06:33 INFO bayes.SequenceFileModelReader: Read 3200000 feature weights
12/04/10 00:06:33 INFO bayes.SequenceFileModelReader: Read 3250000 feature weights
12/04/10 00:06:33 INFO bayes.SequenceFileModelReader: Read 3300000 feature weights
12/04/10 00:06:33 INFO bayes.SequenceFileModelReader: Read 3350000 feature weights
12/04/10 00:06:33 INFO bayes.SequenceFileModelReader: Read 3400000 feature weights
12/04/10 00:06:34 INFO bayes.SequenceFileModelReader: Read 3450000 feature weights
12/04/10 00:06:34 INFO bayes.SequenceFileModelReader: Read 3500000 feature weights
12/04/10 00:06:34 INFO bayes.SequenceFileModelReader: Read 3550000 feature weights
12/04/10 00:06:34 INFO bayes.SequenceFileModelReader: Read 3600000 feature weights
12/04/10 00:06:39 INFO bayes.SequenceFileModelReader: Read 3650000 feature weights
12/04/10 00:06:39 INFO bayes.SequenceFileModelReader: Read 3700000 feature weights
12/04/10 00:06:40 INFO bayes.SequenceFileModelReader: Read 3750000 feature weights
12/04/10 00:06:40 INFO bayes.SequenceFileModelReader: Read 3800000 feature weights
12/04/10 00:06:42 INFO bayes.SequenceFileModelReader: Read 3850000 feature weights
12/04/10 00:06:42 INFO bayes.SequenceFileModelReader: Read 3900000 feature weights
12/04/10 00:06:42 INFO bayes.SequenceFileModelReader: Read 3950000 feature weights
12/04/10 00:06:42 INFO bayes.SequenceFileModelReader: Read 4000000 feature weights
12/04/10 00:06:42 INFO bayes.SequenceFileModelReader: Read 4050000 feature weights
12/04/10 00:06:44 INFO bayes.SequenceFileModelReader: Read 4100000 feature weights
12/04/10 00:06:44 INFO bayes.SequenceFileModelReader: Read 4150000 feature weights
12/04/10 00:06:45 INFO bayes.SequenceFileModelReader: Read 4200000 feature weights
12/04/10 00:06:45 INFO bayes.SequenceFileModelReader: Read 4250000 feature weights
12/04/10 00:06:45 INFO bayes.SequenceFileModelReader: Read 4300000 feature weights
12/04/10 00:06:47 INFO bayes.SequenceFileModelReader: Read 4350000 feature weights
12/04/10 00:06:47 INFO bayes.SequenceFileModelReader: Read 4400000 feature weights
12/04/10 00:06:47 INFO bayes.SequenceFileModelReader: Read 4450000 feature weights
12/04/10 00:06:47 INFO bayes.SequenceFileModelReader: Read 4500000 feature weights
12/04/10 00:06:50 INFO bayes.SequenceFileModelReader: Read 4550000 feature weights
12/04/10 00:06:50 INFO bayes.SequenceFileModelReader: Read 4600000 feature weights
12/04/10 00:06:51 INFO bayes.SequenceFileModelReader: Read 4650000 feature weights
12/04/10 00:06:51 INFO bayes.SequenceFileModelReader: Read 4700000 feature weights
12/04/10 00:06:53 INFO bayes.SequenceFileModelReader: Read 4750000 feature weights
12/04/10 00:06:53 INFO bayes.SequenceFileModelReader: Read 4800000 feature weights
12/04/10 00:06:53 INFO bayes.SequenceFileModelReader: Read 4850000 feature weights
12/04/10 00:06:56 INFO bayes.SequenceFileModelReader: Read 4900000 feature weights
12/04/10 00:06:56 INFO bayes.SequenceFileModelReader: Read 4950000 feature weights
12/04/10 00:06:56 INFO bayes.SequenceFileModelReader: Read 5000000 feature weights
12/04/10 00:06:59 INFO bayes.SequenceFileModelReader: Read 5050000 feature weights
12/04/10 00:06:59 INFO bayes.SequenceFileModelReader: Read 5100000 feature weights
12/04/10 00:06:59 INFO bayes.SequenceFileModelReader: Read 5150000 feature weights
12/04/10 00:07:01 INFO bayes.SequenceFileModelReader: Read 5200000 feature weights
12/04/10 00:07:02 INFO bayes.SequenceFileModelReader: Read 5250000 feature weights
12/04/10 00:07:02 INFO bayes.SequenceFileModelReader: Read 5300000 feature weights
12/04/10 00:07:04 INFO bayes.SequenceFileModelReader: Read 5350000 feature weights
12/04/10 00:07:04 INFO bayes.SequenceFileModelReader: Read 5400000 feature weights
12/04/10 00:07:07 INFO bayes.SequenceFileModelReader: Read 5450000 feature weights
12/04/10 00:07:07 INFO bayes.SequenceFileModelReader: Read 5500000 feature weights
12/04/10 00:07:10 INFO bayes.SequenceFileModelReader: Read 5550000 feature weights
12/04/10 00:07:12 INFO bayes.SequenceFileModelReader: Read 5600000 feature weights
12/04/10 00:07:12 INFO bayes.SequenceFileModelReader: Read 5650000 feature weights
12/04/10 00:07:15 INFO bayes.SequenceFileModelReader: Read 5700000 feature weights
12/04/10 00:07:17 INFO bayes.SequenceFileModelReader: Read 5750000 feature weights
12/04/10 00:07:20 INFO bayes.SequenceFileModelReader: Read 5800000 feature weights
12/04/10 00:07:23 INFO bayes.SequenceFileModelReader: Read 5850000 feature weights
12/04/10 00:07:25 INFO bayes.SequenceFileModelReader: Read 5900000 feature weights
12/04/10 00:07:28 INFO bayes.SequenceFileModelReader: Read 5950000 feature weights
12/04/10 00:07:33 INFO bayes.SequenceFileModelReader: Read 6000000 feature weights
12/04/10 00:07:38 INFO bayes.SequenceFileModelReader: Read 6050000 feature weights
12/04/10 00:07:46 INFO bayes.SequenceFileModelReader: Read 6100000 feature weights
12/04/10 00:08:04 INFO bayes.SequenceFileModelReader: Read 6150000 feature weights
12/04/10 00:08:20 INFO bayes.SequenceFileModelReader: Read 6200000 feature weights
12/04/10 00:08:47 INFO bayes.SequenceFileModelReader: Read 6250000 feature weights
Exception in thread "main" java.lang.OutOfMemoryError: Java heap space
    at sun.misc.FloatingDecimal.toJavaFormatString(FloatingDecimal.java:887)
    at java.lang.Double.toString(Double.java:179)
    at java.text.DigitList.set(DigitList.java:272)
    at java.text.DecimalFormat.format(DecimalFormat.java:584)
    at java.text.DecimalFormat.format(DecimalFormat.java:507)
    at java.text.NumberFormat.format(NumberFormat.java:269)
    at org.apache.hadoop.util.StringUtils.formatPercent(StringUtils.java:119)
    at org.apache.hadoop.mapred.JobClient.monitorAndPrintJob(JobClient.java:1283)
    at org.apache.hadoop.mapred.JobClient.runJob(JobClient.java:1251)
    at org.apache.mahout.classifier.bayes.mapreduce.bayes.BayesClassifierDriver.runJob(BayesClassifierDriver.java:87)
    at org.apache.mahout.classifier.bayes.TestClassifier.classifyParallel(TestClassifier.java:288)
    at org.apache.mahout.classifier.bayes.TestClassifier.main(TestClassifier.java:191)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.hadoop.util.ProgramDriver$ProgramDescription.invoke(ProgramDriver.java:68)
    at org.apache.hadoop.util.ProgramDriver.driver(ProgramDriver.java:139)
    at org.apache.mahout.driver.MahoutDriver.main(MahoutDriver.java:188)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.hadoop.util.RunJar.main(RunJar.java:156)
12/04/10 00:17:15 WARN mapred.LocalJobRunner: job_local_0001
java.lang.RuntimeException: Error in configuring object
    at org.apache.hadoop.util.ReflectionUtils.setJobConf(ReflectionUtils.java:93)
    at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:64)
    at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:117)
    at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:354)
    at org.apache.hadoop.mapred.MapTask.run(MapTask.java:307)
    at org.apache.hadoop.mapred.LocalJobRunner$Job.run(LocalJobRunner.java:177)
Caused by: java.lang.reflect.InvocationTargetException
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.hadoop.util.ReflectionUtils.setJobConf(ReflectionUtils.java:88)
    ... 5 more
Caused by: java.lang.RuntimeException: Error in configuring object
    at org.apache.hadoop.util.ReflectionUtils.setJobConf(ReflectionUtils.java:93)
    at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:64)
    at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:117)
    at org.apache.hadoop.mapred.MapRunner.configure(MapRunner.java:34)
    ... 10 more
Caused by: java.lang.reflect.InvocationTargetException
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.hadoop.util.ReflectionUtils.setJobConf(ReflectionUtils.java:88)
    ... 13 more
Caused by: java.lang.OutOfMemoryError: Java heap space
    at java.nio.HeapCharBuffer.<init>(HeapCharBuffer.java:39)
    at java.nio.CharBuffer.allocate(CharBuffer.java:312)
    at java.nio.charset.CharsetDecoder.decode(CharsetDecoder.java:760)
    at org.apache.hadoop.io.Text.decode(Text.java:350)
    at org.apache.hadoop.io.Text.decode(Text.java:327)
    at org.apache.hadoop.io.Text.toString(Text.java:254)
    at org.apache.mahout.common.StringTuple.readFields(StringTuple.java:143)
    at org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:1836)
    at org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:1876)
    at org.apache.mahout.common.iterator.sequencefile.SequenceFileIterator.computeNext(SequenceFileIterator.java:95)
    at org.apache.mahout.common.iterator.sequencefile.SequenceFileIterator.computeNext(SequenceFileIterator.java:38)
    at com.google.common.collect.AbstractIterator.tryToComputeNext(AbstractIterator.java:141)
    at com.google.common.collect.AbstractIterator.hasNext(AbstractIterator.java:136)
    at com.google.common.collect.Iterators$5.hasNext(Iterators.java:525)
    at com.google.common.collect.ForwardingIterator.hasNext(ForwardingIterator.java:43)
    at org.apache.mahout.classifier.bayes.SequenceFileModelReader.loadFeatureWeights(SequenceFileModelReader.java:72)
    at org.apache.mahout.classifier.bayes.SequenceFileModelReader.loadModel(SequenceFileModelReader.java:46)
    at org.apache.mahout.classifier.bayes.InMemoryBayesDatastore.initialize(InMemoryBayesDatastore.java:72)
    at org.apache.mahout.classifier.bayes.ClassifierContext.initialize(ClassifierContext.java:44)
    at org.apache.mahout.classifier.bayes.mapreduce.bayes.BayesClassifierMapper.configure(BayesClassifierMapper.java:121)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.hadoop.util.ReflectionUtils.setJobConf(ReflectionUtils.java:88)
    at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:64)
    at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:117)
    at org.apache.hadoop.mapred.MapRunner.configure(MapRunner.java:34)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T09:41:04.720

您需要增加映射器可用的内存。设置`mapred.map.java.child.opts`一个足够大的东西来容纳模型。

可能是您试图将一些不切实际的大数据加载到内存中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T02:20:54.840

我也遇到了同样的问题，经过一番锻炼后，我尝试通过设置 mahout opts 来增加 JVM 内存。尝试这个：

“export MAVEN_OPTS=-Xmx1g”之类的会给JVM更多的内存。

尝试发布结果，因为我认为很多人都面临这个问题。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-11T08:20:36.900

如果您在一台机器上执行此操作，减少 hadoop 记录大小的大小也可能会有所帮助，因为它会增加映射任务的数量

# android - Android Speex 回声消除问题

> ID：10080808
> 
> 赞同：3
> 
> 时间：2012-04-09T22:43:42.870
> 
> 标签：android, echo, speex, cancellation

我在两个安卓设备之间有一个基本的 audiorecord-audiotrack、udp 数据包语音聊天。它有效，但我的回声很差。我正在尝试使用由 JNI 移植到 android 的 Speex 来消除回声。我导入的 speex 有效，但回声消除无效。本机 C 代码为：

```
#include <jni.h>
#include <speex/speex_echo.h> 

#define FRAME_SIZE 256
#define FILTER_LENGTH 800

SpeexEchoState *echoState;

// Initialization of echo cancelation
void Java_telefonie_voip_VoIPActivity_InitEcho(JNIEnv * env, jobject jobj)
{
    echoState = speex_echo_state_init(FRAME_SIZE, FILTER_LENGTH);
}

//  Queue the frame to soundcard for playing (receiving)
void Java_telefonie_voip_VoIPActivity_Playback(JNIEnv * env, jobject jobj, jshortArray     inputFrame)
{
    speex_echo_playback(echoState, inputFrame);
}

jshortArray Java_telefonie_voip_VoIPActivity_Capture(JNIEnv * env, jobject jobj,     jshortArray inputFrame)
{
    jshortArray outputFrame;

    speex_echo_capture(echoState, inputFrame, *&outputFrame);

    return outputFrame;
}

// Destroing echo cancelation
void Java_telefonie_voip_VoIPActivity_DestroyEcho(JNIEnv * env, jobject jobj)
{
speex_echo_state_destroy(echoState); 
} 
```

还有一些重要的java代码：

```
native void InitEcho();
native void DestroyEcho();
native void Playback(short[] inputData);  // listener/receiving
native short[] Capture(short[] inputData);  // recorder/sender
static {
    System.loadLibrary("speex");
}

public void Initialize ()
{
    minBufferSize = 4096;
    try
    {
        InitEcho();
    }
    catch (Exception e){Log.e(TAG, "jni " + e.getMessage());}
}

public void startRecording ()
{
    isStreaming = true;
streamingThread = new Thread(new Runnable(){
        @Override
        public void run ()
        {
            try
            {
                audioRecorder = new AudioRecord(
                        MediaRecorder.AudioSource.MIC,
                        sampleRate,
                        channelConfig,
                        audioFormat,
                        minBufferSize*10
                );

                buffer = new short[minBufferSize];
                audioRecorder.startRecording();

                while(isStreaming)
                {
                    sendPackets++;
                    minBufferSize = audioRecorder.read(buffer, 0, buffer.length);     
                    //  Echo cancelling
                    buffer = Capture(buffer);

                    //  Send
                    dataPacket = new DatagramPacket(ShortToByteArray(buffer), buffer.length*2, receiverAddressIA, serverPort1);
                    dataSocket.send(dataPacket);
                }
            }
            catch(Exception e)
            {
                Log.e(TAG, "2" + e.getMessage());
            }
        }
    });
    streamingThread.start();
}

public void startListen ()
{
    isListening = true;
receivingThread = new Thread(new Runnable(){
        @Override
        public void run ()
        {
            try
            {
                audioTrack = new AudioTrack(
                        AudioManager.STREAM_VOICE_CALL,
                        sampleRate,
                        channelConfig,
                        audioFormat,
                        minBufferSize*10,
                        AudioTrack.MODE_STREAM
                );

                audioTrack.play();

                buffer2 = new short[minBufferSize];

                while (isListening)
                {
                    receivedPackets++;
                    dataPacket2 = new DatagramPacket(ShortToByteArray(buffer2), buffer2.length*2);
                    dataSocket2.receive(dataPacket2);

                    //  Cancel echo
                    Playback(buffer2);

                    //  Queue to soundcard
                    audioTrack.write(buffer2, 0, minBufferSize);
                }
            }
            catch(Exception e)
            {
                Log.e(TAG, "3" + e.getMessage());
            }
        }
    });
    receivingThread.start();
}

public short[] ByteToShortArray(byte[] byteArray)
{
    short[] shortArray = new short[byteArray.length/2];
ByteBuffer.wrap(byteArray).order(ByteOrder.BIG_ENDIAN).asShortBuffer().get(shortArray);
    return shortArray;
} 
```

问题是当我启动记录器/流媒体线程时，它向我显示它发送了一个包，然后应用程序崩溃而没有任何消息。您有什么建议或建议吗？请帮助我，因为我需要尽快完成这个项目，我已经努力工作并记录了自己，但它仍然不想很好地工作。谢谢！

编辑：我刚刚发现

```
//  Echo cancelling
buffer = Capture(buffer); 
```

正在触发崩溃。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T12:33:51.300

更新：关于崩溃 - 这是由于 JNI 的误用。您不能将 jshortarray 视为 C 指针。您需要调用相关的 JNI 函数将其转换为 C 指针（GetShortArrayElements 等）。

关于回声消除器 - 您目前使用内部缓冲区，大约 2 帧，这对您来说可能还不够。Android 的上下文切换不像在 PC 上，你可能会得到 4 个连续的播放帧 -> 4 个连续的记录帧 -> 等等。因此，您会以这种方式丢失帧。

此外，Android 音频流具有比 PC 更高的延迟，因此 2 帧缓冲区是不够的。您需要实现自己的缓冲并使用延迟的帧数进行播放，因此回声消除器会在其过滤器长度的边界内看到回放后的回声。

除此之外，分析和调试回声消除器的最佳方法是： 1\. 实际上了解它在高层次上的工作原理以及要求是什么 - 不是火箭科学，您可以在 Speex 官方文档上找到所有内容。2\. 使用提供的 echo_diagnostic 工具，并在 Audacity 等工具中检查流，看看哪里出了问题。

正确使用 Speex AEC 可以很好地工作，我已经使用它完成了 3 个不同的项目，因此只需更正您的实施即可。

# c++ - 当一个线程 forks() 时其他线程会发生什么？

> ID：10080811
> 
> 赞同：22
> 
> 时间：2012-04-09T22:43:51.390
> 
> 标签：c++, multithreading, pthreads, fork

在使用 pthread 的 C++ 中，如果您的一个线程调用 fork，您的其他线程会发生什么？

似乎线程没有跟随。就我而言，我正在尝试创建一个守护进程，并使用 fork() 与父级退出来解除它。但是，在代码的新路径中，我在分叉之前和之后创建了一些线程。有没有一种简单的方法可以将线程的所有权更改为新的分叉进程，而不是在分叉之后移动我的所有线程创建？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-09T22:45:58.413

没有。只有调用 fork() 的线程才会重复。子进程必须启动任何新线程。父母线程被单独留下。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-04-09T23:02:10.347

在 POSIX 中，当多线程进程分叉时，子进程看起来与父进程完全相同，但其中所有线程都停止在其轨道上并消失了。

如果线程持有锁，这是非常糟糕的。

出于这个原因，有一种称为粗略的机制`pthread_atfork`，您可以在其中为这种情况注册处理程序。

任何使用互斥锁的正确编写的程序模块（尤其是可重用的中间件）都必须调用`pthread_atfork`以注册一些处理程序，以便在进程碰巧调用`fork`.

除了互斥锁之外，线程还可以拥有其他资源，例如隐藏在`pthread_setspecific`其中的特定于线程的数据只能由线程访问（并且线程负责通过析构函数对其进行清理）。

在子进程中，没有这样的析构函数运行。地址空间被复制，但线程及其线程特定值不存在，因此内存在子进程中泄漏。这也可以并且应该由处理`pthread_atfork`程序处理。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-10-14T08:01:38.350

引用自[http://thorstenball.com/blog/2014/10/13/why-threads-cant-fork/](http://thorstenball.com/blog/2014/10/13/why-threads-cant-fork/)

`If we call fork(2) in a multi-threaded environment the thread doing the call is now the main-thread in the new process and all the other threads, which ran in the parent process, are dead. And everything they did was left exactly as it was just before the call to fork(2).`

所以[我们在使用它们之前应该三思而后行](http://www.linuxprogrammingblog.com/threads-and-fork-think-twice-before-using-them)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-09T23:02:20.323

分叉一个线程通常是非常糟糕的。分叉的进程应该是父进程的完整副本，但它不是线程。有一个功能`pthread_atfork()`有时会有所帮助。如果你必须分叉一个线程，最好`exec()`在`fork()`.

我建议您阅读 POSIX 开发人员在文档中的警告`fork()`和`pthread_atfork()`（参见[http://pubs.opengroup.org/onlinepubs/007904975/functions/fork.html](http://pubs.opengroup.org/onlinepubs/007904975/functions/fork.html)和[http://pubs.opengroup.org/onlinepubs/007904975 /functions/pthread_atfork.html](http://pubs.opengroup.org/onlinepubs/007904975/functions/pthread_atfork.html)）。

从`fork()`文档中：

> 因此，该`fork()`函数仅用于运行新程序，并且在调用和调用函数之间需要某些资源的调用函数的效果`fork()`是`exec`未定义的。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-04-09T22:47:21.287

什么都没有，除非碰巧被运行新进程的线程抢占。

# .net - 获取 DrawingVisual 属性

> ID：10080817
> 
> 赞同：2
> 
> 时间：2012-04-09T22:44:14.883
> 
> 标签：.net, wpf, drawing, drawingcontext

例如，我使用此方法创建了一个[DrawingVisual对象：](http://msdn.microsoft.com/en-us/library/system.windows.media.drawingvisual.aspx)

```
Private Function CreateDrawingVisualRectangle() As DrawingVisual

   Dim drawingVisual As New DrawingVisual() 
   Dim drawingContext As DrawingContext = drawingVisual.RenderOpen()
   Dim rect As New Rect(New Point(160, 100), New Size(320, 80))
   drawingContext.DrawRectangle(Brushes.LightBlue, New Pen(Brushes.Black, 0.5), rect)

   Return drawingVisual

End Function 
```

有没有办法获取 DrawingContext[方法](http://msdn.microsoft.com/en-us/library/ms606813.aspx)绘制的形状类型及其属性？

IE：

```
Dim MyVisual as DrawingVisual = CreateDrawingVisualRectangle()

Dim MyVisualType as MyType = MyVisual.GetDrawingType()
Dim MyBrush as Brush = MyVisual.GetDrawingBrush()
Dim MyPen as Pen = MyVisual.GetDrawingPen()
Dim MyRect as Rect = MyVisual.GetDrawingRect()
... 
```

显然，我在上一个示例中使用的方法是指示性方法，实际上并不存在，但我会使用它来获取 MyVisual 属性。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T08:33:57.430

您可以递归地遍历DrawingVisual 的[Drawing](http://msdn.microsoft.com/en-us/library/system.windows.media.drawingvisual.drawing.aspx)属性提供的[DrawingGroup中的](http://msdn.microsoft.com/en-us/library/system.windows.media.drawinggroup.aspx)[绘图](http://msdn.microsoft.com/en-us/library/system.windows.media.drawing.aspx)对象，如果子绘图是 GeometryDrawing ，请检查其和属性：`Pen``Brush``Geometry`

```
void InspectDrawings(DrawingVisual drawingVisual)
{
    InspectDrawings(drawingVisual.Drawing);
}

void InspectDrawings(DrawingGroup drawingGroup)
{
    foreach (Drawing drawing in drawingGroup.Children)
    {
        if (drawing is GeometryDrawing)
        {
            GeometryDrawing geometryDrawing = (GeometryDrawing)drawing;
            // inspect properties here
        }
        else if (drawing is DrawingGroup)
        {
            // recurse into sub-group
            InspectDrawings((DrawingGroup)drawing);
        }
    }
} 
```

您现在可以检索几何类型并检查更多特殊属性。例如，如果它是 RectangleGeometry，请检查其`Rect`属性。

# php - PHP类奇怪的行为

> ID：10080823
> 
> 赞同：1
> 
> 时间：2012-04-09T22:45:08.107
> 
> 标签：php, class, object

我想知道这是一个`bug`还是`wrong implementation`......我试着检查一下`class_exist`

我的课

```
namespace servers\testing ;

class HelloWord
{
    function hello()
    {
        echo "hello World" ;
    }
} 
```

测试

```
use servers\testing\HelloWord as OkWorld ;

$okWolrd = new OkWorld() ;
$helloWorld  = new \servers\testing\HelloWord() ;

var_dump($okWolrd);  //object(servers\testing\HelloWord)[1]
var_dump(class_exists('servers\testing\HelloWord')); //true 
var_dump(class_exists('OkWorld')); //false

$declearedClasses = get_declared_classes() ;

var_dump(in_array('servers\testing\HelloWord', $declearedClasses)); //true
var_dump(in_array('OkWorld', $declearedClasses)); //false

var_dump($okWolrd instanceof $helloWorld); //true but OkWolrd needed to be initiated before it works 
```

问题

这是否意味着这`OkWord`不是一个有效的`PHP`课程？请注意，`new OkWorld()`工作正常。

你如何验证`OkWord`没有减速的存在？

**编辑 1**

我知道这`OkWorld`是一个`alias`但它的引用`servers\testing\HelloWord`是一个有效的类......

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T22:54:17.300

我认为这既不是错误也不是错误的实现。

`OKWorld`不是一个类，它是一个别名，解释器将`HelloWord`在它存在时替换它。但是解释器不会搜索字符串，所以函数`class_exists`会获取字符串`OKWorld`并搜索对应的类，实际上并不存在！实际存在的是别名。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T22:52:41.680

返回 false 以检查是否`OkWorld`是一个**类**是有效的，因为`OkWorld`它是一个别名，而不是一个实际的类。您可以尝试使用[instanceof](http://us2.php.net/instanceof)代替：

```
// Not sure if this works (haven't used namespace aliases yet)
//var_dump('OkWorld' instanceof HelloWorld); // No GOOD - Throws fatal

// This will work
$okWorld = new OkWorld();
var_dump($okWorld instanceof HelloWorld); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T22:52:28.640

`OkWorld`不是一个类；这是一个命名空间别名。实际班级是`HelloWord`.

# compiler-construction - 向向量添加参数 (Yacc/Bison)

> ID：10080828
> 
> 赞同：0
> 
> 时间：2012-04-09T22:45:57.040
> 
> 标签：compiler-construction, bison, yacc

我想将对象添加到表示 Yacc/Bison 中的参数列表的向量中。我有以下语法规则：

```
argument_list:  expression 
                {
                 //push back object representing expression onto arglist vector
                }

                |
                expression ',' argument_list
                {
                 //same here
                }; 
```

我不知道该怎么做，因为你不能在类型声明中将 argument_list 声明为向量。我想通过这样的规则将此向量传递给一个方法，该方法创建一个表示方法的 AST 节点：

```
arg_method_invocation: IDENT PERIOD IDENT LPAR argument_list RPAR 
              { 
              $$=new MethodCallStatement(yylineno,new MethodCallExpression(yylineno,$1,$3, $5 ));
                     if ($$==NULL)
                     fatal("method stmt: ", "error method stmt call");
              } 
```

这甚至可能吗？我是编译器设计的新手，这种方法可能不可行。欢迎任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T01:12:53.130

只需使其左递归：

```
argument_list:  expression 
            {
              $$ = new vector();
              $$.add($1); // or whatever the API is
            }

            |
            argument_list ',' expression
            {
             $1.add($3); // ditto
            }; 
```

我不明白你为什么不能声明`argument_list`为`vector`. 我假设您在这里指的是 %type 和 %union 指令？如果你不是，那你就是这样做的。

# c++ - C++：我需要一些关于如何创建动态大小的位图的指导

> ID：10080832
> 
> 赞同：0
> 
> 时间：2012-04-09T22:46:14.243
> 
> 标签：c++, bitmap, database

我正在尝试创建一个简单的 DBMS，尽管我已经阅读了很多关于它的内容并且已经设计了系统，但我在实现方面存在一些问题。

我需要知道 C++ 中使用一系列长度为动态的位的最佳方法是什么。这一系列位将被保存，以便确定文件中的哪些页面是空闲的，哪些不是空闲的。对于单个文件，使用的页数将是固定的，因此我可能可以为此使用 bitset。但是，每页和文件的记录数不会固定。所以我不认为 bitset 是最好的方法。

我想也许只使用一个字符序列，因为每个字符都是 1 字节 = 8 位，也许如果我使用它们的数组，我将能够创建我想要的位图。

我从来不需要在如此低的级别上操作位，所以我真的不知道是否还有其他更好的方法可以做到这一点，或者即使这种方法是否可行。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T23:21:54.970

我将实现一个包装器类，并将您的位图简单地存储在块的链接列表中，其中每个块将保存一个固定大小的数组（我将使用像 uint32_t 这样的 stdint 类型来确保给定的位数）然后您只需将链接添加到您的列表展开。我将把合同作为练习留给读者。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T16:11:24.647

如果您只是想了解有关位旋转的基础知识，以下是使用字符数组进行操作的一种方法。

假设您有一个位数组（长度必须为`(totalitems / 8 )`）：

```
unsigned char *bits;  // this of course needs to be allocated somewhere 
```

您可以计算数组的索引和该位置内的特定位，如下所示：

```
// compute array position
int pos = item / 8;  // 8 bits per byte
// compute the bit within the byte.  Could use "item & 7" for the same
// result, however modern compilers will typically already make
// that optimization.
int bit = item % 8; 
```

然后您可以检查是否使用以下设置了位（假设从零开始索引）：

```
if ( bits[pos] & ( 1 << bit ))
  return 1;  // it is set
else
  return 0;  // it is not set 
```

以下将设置一个特定位：

```
bits[pos] |= ( 1 << bit ); 
```

以下可用于清除特定位：

```
bits[pos] &= ~( 1 << bit ); 
```

# api - 如何将数据传递给 google-maps 回调函数并防止内存泄漏

> ID：10080834
> 
> 赞同：1
> 
> 时间：2012-04-09T22:46:29.410
> 
> 标签：api, events, google-maps

我正在使用大量 10.000+ 的标记，它们都应该是可点击的。目前我为每个标记创建一个单独的回调函数，它是我需要的所有数据的闭包。我试图阻止创建 10.000 个函数，它们都做同样的事情并将我需要的数据作为参数传递给 cb 函数，但这似乎是不可能的。

但是无论如何，有一种方法可以将数据获取到回调函数。'This' 在 cb 函数中指向实际单击的标记，如果我将它们附加到标记对象，我可以访问所需的数据。这很脏，但它似乎工作。

但这会导致更多问题：我怀疑这会导致内存泄漏。我在标记代表的对象中引用标记，例如 obj.marker，但是要访问 cb 函数中的对象，我必须引用像 marker.obj 这样的对象

```
// Callback function for clicks on markers
function cb(e){
    console.log(e); // the event with information about marker position
    console.log(this.obj); // the object the marker stands for
}

//add a eventListener to the marker which represents a object
this.initMarkerListener = function(obj) {
    obj.marker.obj = obj;     //the critical point
    google.maps.event.addListener(obj.marker, 'click', cb);
}; 
```

这会造成内存泄漏吗？我可以通过其他技术将所需的数据传递给回调函数吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-11-16T10:53:04.423

你采取的方法没有任何问题。当您希望“清理”（让 GB 清理未使用的引用）的引用被留下时，就会发生内存泄漏。

考虑一下，如果内存中存在标记，并且您删除了 obj，因为标记持有对 obj 的引用，那么 GB 将不会拾取 obj 来释放该内存部分。

# c++ - C++：在构造函数中进行完整性检查时是否需要/可以使用异常处理>？

> ID：10080842
> 
> 赞同：0
> 
> 时间：2012-04-09T22:48:20.713
> 
> 标签：c++, exception-handling

我正在为学校构建一个项目，我想我想加入一些异常处理（我们在课堂上谈到的一个话题）。

我一直在阅读它们以了解我可以在哪里以及如何使用它们，到目前为止，我认为我可以遵循这一理念，但只是为了检查我是否正确，我想我会发布这个问题。

在对象的构造函数中使用异常处理来防止其数据成员获取非法值是否有用（例如，确保质量不是负数等）？

在修改对象数据成员的函数中怎么样（例如，修改对象长度的函数必须确保长度不低于零）？

我如何捕捉这些错误（我们不想在用户可以控制处理的地方看到`catch`它们）？`main()`

或者我应该把以上所有的都放在一边，然后转回旧的`cout << you entered a wrong value, continuing with the standard value" << endl; val = 1;`？

*（或者这取决于项目是什么？）*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T22:55:28.107

它确实在某种程度上取决于项目，但是对于除了玩具程序之外的任何东西，您*很少*可以选择继续使用默认值。尤其是当您编写库代码时，让 ctor 直接显示错误消息几乎总是不合适的（例如，如果有人试图在 Windowed 程序中使用您的代码，`cout`通常根本不起作用。通过抛出异常，一些实现它是窗口程序的程序的其他部分可以调用适当的函数（例如，Windows 上的 MessageBox）来显示错误消息。

# css - 定位绝对定位元素的相对子元素

> ID：10080847
> 
> 赞同：0
> 
> 时间：2012-04-09T22:48:57.877
> 
> 标签：css, css-position

孩子应该如何`position: relative`表现在父母的内心`position: absolute`？

例如（[JSFiddle](https://jsfiddle.net/7nfrq868/)）：

```
<div style="position:relative; float:left; min-width:900px; max-width: 1400px; height:100%;">
  <div style="position:absolute; top:0; right:0; width:200px; height:300px;">
    <div style="position:relative; top:0; left:0; width:500px; height:100%;"></div>
  </div>
</div> 
```

当我将浏览器窗口缩小到最大宽度以下时，内部 div 会移到其父元素之外。这是正常的行为吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T23:35:05.623

取自：[http ://css-tricks.com/absolute-relative-fixed-positioining-how-do-they-differ/](http://css-tricks.com/absolute-relative-fixed-positioining-how-do-they-differ/)

> **相对** *[...]*它的真正含义是“相对于自身”。如果您`position: relative;`在一个元素上设置但**没有其他定位属性**（顶部、左侧、底部或右侧），则它根本**不会影响**它的定位，它将与您将其保留为 position: static; 但是如果你给它一些其他的定位属性，比如 ，`top: 10px;`它会将它的位置从它通常的位置向下移动 10 个*像素*。*[...]*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T23:39:12.740

尝试改变一些东西。首先，给你的第一个 div 一个实际的高度，而不仅仅是 100%。其次，尝试使子元素适合其父元素。现在它是 200px div 内的 500px div。对于此特定任务，它可能更好地定位在父级之外。

# php - 在用户输入上使用白名单

> ID：10080850
> 
> 赞同：4
> 
> 时间：2012-04-09T22:49:19.593
> 
> 标签：php, whitelist

我有一个使用用户名和密码登录的简单表单。我想应用白名单以仅允许某些字符。我不知道是否有人需要这个，但这里是检索用户名和密码的代码：

```
$stmt = $conn2->prepare("SELECT username FROM users WHERE username = ? AND password = ?");

$stmt->bind_param("ss", $username, $password);      
$stmt->execute();
$stmt->store_result(); 
```

我是否合并了这样的东西：

```
preg_replace( "/[^a-zA-Z0-9_]/", "", $stringToFilter ); 
```

如果是这样，我应该将它包含在我的代码中的什么位置？如果用户尝试输入白名单以外的内容会发生什么？

补充：好吧，如果它在注册期间并且使用 INSERT 存储用户名和密码怎么办？

```
//insert data
$stmt = $conn2->prepare("INSERT INTO users (username, email, password) VALUES (?, ?, ?)");

//bind the parameters
$stmt->bind_param('sss', $username, $email, $password); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-09T22:57:40.283

`INSERT`在注册期间添加过滤代码。过滤后检查字符串不为空，以便用户名`"!!*&%$#()*&#$"`不会作为空字符串插入。

```
$username_clean = preg_replace( "/[^a-zA-Z0-9_]/", "", $_POST['username'] );

if (!strlen($username_clean)){

    die("username is blank!");
}

$stmt = $conn2->prepare("INSERT INTO users (username, email, password) VALUES (?, ?, ?)");
$stmt->bind_param('sss', $username_clean, $email_clean, $password_clean); 
```

# entity-framework - MVC 2：基于包含集合属性的模型呈现 HTML TextBoxFor

> ID：10080855
> 
> 赞同：0
> 
> 时间：2012-04-09T22:50:10.390
> 
> 标签：entity-framework, validation, asp.net-mvc-2

我是 MVC 的新手，并且仍然在为我认为非常基本的 mvc 东西而苦苦挣扎。我的预期目的只是呈现代表数据对象集合的文本框，以便我可以使用 DataAnnoations 轻松验证它们。我已经阅读并理解了本教程，并且已经让它工作得很好——但它一次只验证一个人对象，由原语组成：

[http://weblogs.asp.net/scottgu/archive/2010/01/15/asp-net-mvc-2-model-validation.aspx](http://weblogs.asp.net/scottgu/archive/2010/01/15/asp-net-mvc-2-model-validation.aspx)

我的问题与这篇文章类似，但我没有成功地将其应用于没有 Razor 的情况：

[使用数据注释对集合进行 MVC 3 客户端验证 - 不起作用](https://stackoverflow.com/questions/5239995/mvc-3-client-side-validation-on-collection-with-data-annotations-not-working)

验证在 String 和 int 等“原语”上效果很好，但我不明白对集合的验证。

这是代表我的对象的一个​​实例和一些验证的类：

```
public class vc_EBTOCRecord
{
    [StringLength(10, ErrorMessage = "must be under 10 chars")]
    [Required(ErrorMessage = "Problem!")]
    public String ItemText;
} 
```

这是视图继承的模型：

```
public class EBTOCViewModel
{
    public List<vc_EBTOCRecord> VcEbtocRecordList { get; set; }

} 
```

这是我的控制器：

```
 public ActionResult Create()
    {
        EBTOCViewModel ebtocViewModel = new EBTOCViewModel();
        List<vc_EBTOCRecord> vcEbtocRecordList = new List<vc_EBTOCRecord>();

        vc_EBTOCRecord vcEbtocRecord = new vc_EBTOCRecord();
        vcEbtocRecord.ItemText = "bob";
        vcEbtocRecordList.Add(vcEbtocRecord);

        vc_EBTOCRecord vcEbtocRecord2 = new vc_EBTOCRecord();
        vcEbtocRecord.ItemText = "fred";
        vcEbtocRecordList.Add(vcEbtocRecord2);

        vc_EBTOCRecord vcEbtocRecord3 = new vc_EBTOCRecord();
        vcEbtocRecord.ItemText = "joe";
        vcEbtocRecordList.Add(vcEbtocRecord3);

        ebtocViewModel.VcEbtocRecordList = vcEbtocRecordList; 

        return View(ebtocViewModel);
    } 
```

最后，我认为这是我正在尝试的：

```
 <%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage<vcAdminTool.ViewModels.EBTOCViewModel>" %>
    <h2>Create</h2>

<% using (Html.BeginForm()) {%>
    <%: Html.ValidationSummary(true) %>

    <fieldset>
        <legend>Fields</legend>
        <% foreach(var thing in Model.VcEbtocRecordList)
           {
               Html.TextBoxFor(model => thing.ItemText);       
               //Html.TextBox("hello", thing.ItemText );  didn't work...
               //Html.TextBox("hello");  nope, still didn't work
              Response.Write("a record is here");
           }
             %>
        <p>
            <input type="submit" value="Create" />
        </p>
    </fieldset>

<% } %>

<div>
    <%: Html.ActionLink("Back to List", "Index") %>
</div> 
```

当视图渲染时，“a record is here”被打印了三遍，这表明 MVC 可以识别我创建的底层对象，但为什么它不会渲染三个文本框？

期望的结果是有三个空白的验证文本框。然后，如果表单有效，我将编写将信息写回数据库的代码。

如果你愿意，我错过了什么明显的东西？

# c# - MVC3 模型中的自定义 HTML 属性

> ID：10080856
> 
> 赞同：1
> 
> 时间：2012-04-09T22:50:36.910
> 
> 标签：c#, asp.net-mvc-3, html, model, data-annotations

我想创建一个模型：

```
public class TestModel
{
    Microdata(Data = "data-test=this is a test!")]
    public bool Test { get; set; }
} 
```

然后在视图中：

```
@Html.DisplayForModel() 
```

我正在寻找的结果是这样的：

```
<label>Test:</label> <input type="checkbox" data-test="this is a test!" /> 
```

我已经创建了一个自定义属性类，但这并没有产生任何东西。

```
[AttributeUsage(AttributeTargets.Property | AttributeTargets.Class, AllowMultiple = false, Inherited = true)]
public class MicrodataAttribute : Attribute
{
    public string Data { get; set; }

    public RouteValueDictionary GetAttributes()
    {
        var attributes = new RouteValueDictionary();

        if (this.Data != null)
        {
            string[] kv = this.Data.Split(',');
            attributes.Add(kv[0], kv[1]);
        }
        return attributes;
    }
}

public class MetadataProvider : DataAnnotationsModelMetadataProvider
{
    protected override ModelMetadata CreateMetadata(IEnumerable<Attribute> attributes, Type containerType, Func<object> modelAccessor, Type modelType, string propertyName)
    {
        var metadata = base.CreateMetadata(attributes, containerType, modelAccessor, modelType, propertyName);
        var additionalValues = attributes.OfType<HtmlPropertiesAttribute>().FirstOrDefault();
        if (additionalValues != null)
        {
            metadata.AdditionalValues.Add("HtmlAttributes", additionalValues);
        }
        return metadata;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T22:53:44.887

为什么会呢？没有使用您的属性的代码...

阅读下面的博客文章 - 它描述了 MVC 如何使用元数据，并提供了一个`object`您需要编写的自定义模板示例：

[http://bradwilson.typepad.com/blog/2009/10/aspnet-mvc-2-templates-part-1-introduction.html](http://bradwilson.typepad.com/blog/2009/10/aspnet-mvc-2-templates-part-1-introduction.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T21:41:39.940

在与@JakubKonecki 讨论了这个问题并阅读了他发表的博客文章之后。这是我的 EditTemplate，用于帮助在 MVC 2/3 和最有可能的 4 中创建数据破折号属性。

我将此文件保存在 root/Views/Shared/EditTemplates 下为 String.cshtml。cshtml，因为我使用的是剃须刀引擎。如果您使用的是区域，则位置可能会有所不同，并且它们不必存储在“共享”视图文件夹中。只需阅读 Brad Wilson 发布的整个博客 @JakubKonecki。

再次感谢@JakubKonecki！

```
@{
    Dictionary<string, object> AV = ViewData.ModelMetadata.AdditionalValues;
    Dictionary<string, object> htmlAttr = new Dictionary<string,object>();
    foreach (KeyValuePair<string, object> A in AV)
    {
        if (A.Value is System.Web.Routing.RouteValueDictionary)
        {
            foreach (KeyValuePair<string, object> B in (System.Web.Routing.RouteValueDictionary)A.Value)
            {
                htmlAttr.Add(B.Key, B.Value);
            }
        }
    }
    htmlAttr.Add("class", "text-box single-line");
    htmlAttr.Add("type", "text");
}

@Html.TextBox("", ViewData.TemplateInfo.FormattedModelValue, htmlAttr) 
```

# java - 从不同的方法访问变量（Java）

> ID：10080857
> 
> 赞同：0
> 
> 时间：2012-04-09T22:50:38.270
> 
> 标签：java

另一个问题要提出来。我正在做一个创建哈希函数和所有爵士乐的任务，我偶然发现了一个小问题。

`Line 35:21, where it reads arrpos += prearrpo & ______,`

在我的脑海中工作......我试图做的是`arr.length`从`HashTable()`方法中访问。我已经阅读了有关需要创建大小为 arr.length 的对象的建议；但是在我看来，这似乎过于复杂-

有没有另一种方法可以访问 HashTable 方法中的变量，但在 insert 方法中？

另一个不那么重要的问题涉及到`if()`letter( `char c`) 类中的大量语句。我确定必须有更短的方法来做到这一点......我最初会使用 ascii 值；但规范对于使用值 1-26 表示小写/大写字母非常特别 -

谢谢

```
import java.io.*;

public class HashTable {

    public HashTable() {
        //Create an array of size 101
        String arr[] = new String[101];
        //System.out.println("Size1: ");
    }

    public HashTable(int tsize) {
        int size = 2 * tsize;
        //System.out.println("Size: " + size);
        boolean isPrime = checkPrime(size);
        //System.out.println("IsPrime: " + isPrime);
        while (isPrime == false) {
            //System.out.println("Size: " + size);
            size++;
            isPrime = checkPrime(size);
        }
        //System.out.println("Size: " + size);
        String arr[] = new String[size];
    }

    public boolean insert(String line) {

        String str = line;
        char[] ch = str.toCharArray();
        int slen = str.length();
        int arrpos = 0;
        int hash = slen;
        for (int i = 0; i < slen; i++) {
            double prearrpo = letter(ch[i]) * Math.pow(32, (hash - 1));
            arrpos += prearrpo % arr.length();
            hash--;

        }
        System.out.println(arrpos);
        System.out.println("array size:");
        System.out.println();
        return false;

    }

    private int letter(char c) {
        char ch = c;
        if (ch == 'A' || ch == 'a') {
            return 1;
        }
        if (ch == 'B' || ch == 'b') {
            return 2;
        }
        if (ch == 'C' || ch == 'c') {
            return 3;
        }
        if (ch == 'D' || ch == 'd') {
            return 4;
        }
        if (ch == 'E' || ch == 'e') {
            return 5;
        }
        if (ch == 'F' || ch == 'f') {
            return 6;
        }
        if (ch == 'G' || ch == 'g') {
            return 7;
        }
        if (ch == 'H' || ch == 'h') {
            return 8;
        }
        if (ch == 'I' || ch == 'i') {
            return 9;
        }
        if (ch == 'J' || ch == 'j') {
            return 10;
        }
        if (ch == 'K' || ch == 'k') {
            return 11;
        }
        if (ch == 'L' || ch == 'l') {
            return 12;
        }
        if (ch == 'M' || ch == 'm') {
            return 13;
        }
        if (ch == 'N' || ch == 'n') {
            return 14;
        }
        if (ch == 'O' || ch == 'o') {
            return 15;
        }
        if (ch == 'P' || ch == 'p') {
            return 16;
        }
        if (ch == 'Q' || ch == 'q') {
            return 17;
        }
        if (ch == 'R' || ch == 'r') {
            return 18;
        }
        if (ch == 'S' || ch == 's') {
            return 19;
        }
        if (ch == 'T' || ch == 't') {
            return 20;
        }
        if (ch == 'U' || ch == 'u') {
            return 21;
        }
        if (ch == 'V' || ch == 'v') {
            return 22;
        }
        if (ch == 'W' || ch == 'w') {
            return 23;
        }
        if (ch == 'X' || ch == 'x') {
            return 24;
        }
        if (ch == 'Y' || ch == 'y') {
            return 25;
        }
        if (ch == 'Z' || ch == 'z') {
            return 26;
        }
        return 0;
    }

    public boolean lookUp(String string) {
        // 
        return false;
    }

    public String getNum() {
        // 
        return null;
    }

    public int length() {

        return 0;
    }

    private static boolean checkPrime(int size) {

        if (size % 2 == 0) {
            return false;
        }
        double c = Math.sqrt(size);
        for (int i = 3; i < c; i += 2) {
            if (size % i == 0) {
                return false;
            }
        }

        return true;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:57:23.440

`public HashTable()`是一个构造函数。你`arr[]`实际上应该是你的类的私有成员，你应该在所有构造函数中初始化它，或者确保你在没有初始化它的情况下永远不会访问。

```
public class HashTable {

    private String[] arr;

    public HashTable() 
    {
        //Create an array of size 101
        arr[] = new String[101];
        System.out.println("Size1: ");
    }
etc... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T23:02:03.443

由于您的实现似乎支持数组，因此您需要将数组声明为成员变量：

```
public class HashTable {
 String arr[] = null; 
```

然后在您的构造函数中将其初始化（注意在 Java 世界方法中，例如`HashTable()`称为构造函数）：

```
arr = new String[whatever_size]; 
```

# javascript - javascript“this”如何处理来自jquery的多个选择器返回？

> ID：10080858
> 
> 赞同：-1
> 
> 时间：2012-04-09T22:50:48.050
> 
> 标签：javascript, jquery

我今天正在制作菜单，偶然发现了这个奇怪的案例，其 HTML 如下：

```
<div id="list1">
    <ul>
        <li>1</li>
        <li>2 - Here is a Submenu
            <ul>
                <li>3</li>
                <li>4</li>
            </ul>
        </li>
    </ul>
</div> 
```

然后我使用了以下js：

```
$('#list1 li').click(function(){
   $('.list-item').removeClass('list-item');
   $(this).addClass('list-item');
}); 
```

当我这样做时，该类只会应用于 external `<li>`，但我希望它同时应用于 parent 和 child `LI`。

现在我的问题是，我该如何处理这个“返回”，以便将这些类应用于父级和子级`LI`？

js 如何处理这些类型的选择器？该事件是否真的运行了两次并删除了设置的最后一个类？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T22:57:07.273

问题是`$('#list1 li')`可以选择内部的两个级别的`li`标签`#list`并将点击处理程序应用于两者。此外，您允许点击向上传播，因此不仅仅是您点击的人可以看到它。

如果您只想要外部级别，那么您应该使用这样的直接子规范。这将隔离实际安装的点击处理程序：

```
$("#list > ul > li") 
```

这只会获得顶级`li`标签。而且，整个代码看起来像这样：

```
$('#list1 > ul > li').click(function(){
   $('.list-item').removeClass('list-item');
   $(this).addClass('list-item');
}); 
```

如果您想将 removeClass 操作隔离到同一级别的其他 LI 标记，而不是整个文档，那么您可以使用以下内容：

```
$('#list1 > ul > li').click(function(){
   $(this).addClass('list-item').siblings().removeClass('list-item');
}); 
```

你的评论让我对你想要点击的这个 LI 标签有点困惑。如果您确实希望较低级别可单击，然后将列表项类应用于被单击的级别和父 LI，那么您可以这样做：

```
$('#list1 > ul > li > ul > li').click(function() {
   $("#list1 .list-item").removeClass('list-item');
   $(this).parents("li").add(this).addClass('list-item');
   return(false);   // stop event propagation
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T22:57:23.553

jQuery 是否对元素列表中的一个元素或所有元素应用方法取决于方法。

`.click()`并且`.addClass()`都将应用于选择器中的所有 jQuery 对象。

`li`在您的情况下，点击处理程序应用于`#list`. `$(this)`适用于`li`被点击的具体内容。

**但是**，您有嵌套`li`元素，这意味着当您单击内部嵌套时会触发多个单击处理程序`li`，包括嵌套的`li`和它的父级`li`。

要防止此事件通过 dom 树传播，请在单击处理程序中调用 stopPropagation()：

```
$('#list1 li').click(function(e){
   e.stopPropagation();

   $('.list-item').removeClass('list-item');
   $(this).addClass('list-item');
}); 
```

您也可以`return false`从您的处理程序中停止传播并阻止默认操作。这是特定于 jQuery 的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T22:57:26.010

如果您要添加“当前”页面样式：

```
$('#list1 > ul > li').on('click',function(){
   $(this).addClass('list-item')    //adds class to clicked item
        .siblings()                 //find the others of the same level
        .removeClass('list-item');  //remove their styles
}); 
```

# java - Java“预期的.class”

> ID：10080862
> 
> 赞同：5
> 
> 时间：2012-04-09T22:51:25.533
> 
> 标签：java

```
import java.util.Random;
import java.util.Scanner;

public class Lottery
{
    private int[] lotteryNumbers = new int[5];
    private int counter;
    private int[] userNumbers = new int[5];
    private Scanner keyboard = new Scanner(System.in);  
    public Lottery()
    {
        for(counter = 0; counter < 5; counter++)
        {
            lotteryNumbers[counter] = nextInt(int 10);
        }
    } 
```

后面还有更多代码，但那里没有错误，所以我不会包含它。无论如何，上面写着“lotteryNumbers[counter] = nextInt(int 10);”的行 得到“.class 预期”错误。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-09T22:53:05.183

Java 已经知道方法参数的类型；调用方法时不需要指定它。

```
nextInt(int 10); 
```

应该：

```
nextInt(10); 
```

当然，这是假设您实际上`nextInt`定义了一个方法。（我在您的代码示例中没有看到它）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T22:56:05.097

Java 是一种面向对象的语言。你在调用什么对象`nextInt(10)`？我没有看到一个。编译器将隐式假设这一点。您在某处`Lottery`使用`Random`实例吗？我没看到。

我认为你需要这样的东西：

```
private Random random = new Random(System.currentTimeMillis()); 
```

然后你的循环应该这样做：

```
lotteryNumbers[counter] = this.random.nextInt(10); 
```

我对你正在做的事情还有其他问题：

*   到处都是不必要的“神奇”数字。有可能使这个类比你所拥有的更灵活。
*   像这样将输入混合到类中是一个坏主意。做一个抽象，你可以将值传递到你可以单独获取它们的地方。想想“单一责任”。
*   我不明白为什么`Lottery`用户号码需要一个私人数据成员。但是，我可以看到它可能有一种方法可以接受用户号码并判断他们是否获胜。在我看来，你创造了一个糟糕的抽象。

这可能会让你走上一段时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T22:53:56.117

有什么`int`用？

如果您尝试投射，它应该是`(int)`.

您收到该错误的原因是，当 Java 看到需要表达式的类型名称时，它认为您正在尝试引用该类型的类对象，例如`int.class`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T22:54:13.323

在不知道 nextInt() 的细节的情况下，我建议错误来自您传递给它的参数之前的“int”关键字。尝试：

```
lotteryNumbers[counter] = nextInt(10); 
```

# php - 正则表达式 - 修改指定附件中的字符串 - PHP

> ID：10080864
> 
> 赞同：0
> 
> 时间：2012-04-09T22:51:32.683
> 
> 标签：php, regex

我在 SO 上找到了与我当前需求类似的答案，但是我仍在尝试根据规则掌握修改字符串，除非在这些字符串中的某些附件中。

我现在尝试完成的示例：

```
preg_replace("/\s*,\s*/", ",", $text) 
```

我在很多地方都找到了上述内容。它将删除字符串中所有逗号前后的空格。

这很好用。但是，如果我想排除在“”中找到的修改逗号，我不确定如何修改该规则。

有什么帮助吗？谢谢！

编辑：我想澄清我的问题：我希望删除以下句子中逗号前后的所有空格，但双引号或单引号中的逗号除外：

```
a, b , c "d, e f g , " , h i j ,k lm,nop 
```

预期结果：

```
a,b,c "d, e f g , ",h i j,k lm,nop 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T22:57:31.180

[http://ideone.com/bRlYz](http://ideone.com/bRlYz)

```
$text = '"a"   ,      "   , b"';

$result = preg_replace("/(?<=\")\s*,\s*(?=\")/", ",", $text);

var_dump($result); 
```

但如果你有这样的情况，它会失败：`" , "`- 逗号的空格用引号括起来并且没有任何其他字符

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T23:53:15.290

我认为这可能有效（它替换了“/”之外的空格，但不是那些里面的空格）：

```
function yourFunction($string) {
    $arr = explode('"',str_replace(' ','@',$string));

    if (preg_match('~^("|\')~',$string)) {
    foreach ($arr as $key=>$value) {
        if (($key % 2) != 0) {
        $arr[$key] = preg_replace('~\s*,\s*~',',',str_replace('@',' ',$value));
    }
    }
    } else {
    foreach ($arr as $key=>$value) {
        if (($key % 2) == 0) {
        $arr[$key] = preg_replace('~\s*,\s*~',',',str_replace('@',' ',$value));
        }
    }
    }
    $newString = implode('"',$arr);
    $newString = str_replace('@',' ',$newString);

    return $newString;
} 
```

@ 是空格的占位符。（所以没有空格可以丢失，我不知道我为什么这样做，我只知道没有那个我会遇到问题）

"if (preg_match"-construct 检查你的字符串是否以 "/' oder with sth 开头。否则用于 foreach 中的逻辑。

如果字符串以 "/' 开头，则每个第二个条目都在 2 "/' 内，否则其他条目。

希望这就是你要找的

# ruby - 为什么这个归零？

> ID：10080865
> 
> 赞同：1
> 
> 时间：2012-04-09T22:51:36.290
> 
> 标签：ruby

我有代码：

```
img = f.read.scan(/<img/)
img = img.length
links = f.read.scan(/<a/)
links = links.length
div = f.read.scan(/<div/)
div = div.length 
```

该程序会打开一个链接，例如[http://stackoverflow.com](http://stackoverflow.com)。然后它会打印 img、links 和 div。出于某种原因，无论我选择哪个网站，它都会为链接和 div 返回 0，但为 img 返回正确的数字。为什么是这样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T22:56:43.680

因为当您读取文件时，您也会移动指针。这样写（我还添加了方法链）：

```
content = f.read
img = content.scan(/<img/).length
links = content.scan(/<a/).length
div = content.scan(/<div/).length 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T23:02:08.057

`f.read`第一次读取整个文件，所以第二个和第三个匹配得到一个空字符串来扫描标签，你得到零匹配。请参阅[http://www.ruby-doc.org/core-1.9.3/IO.html#method-i-read](http://www.ruby-doc.org/core-1.9.3/IO.html#method-i-read)：

> 如果长度被省略或为零，它会一直读取到 EOF 并应用编码转换。即使在开始时遇到 EOF，它也会返回一个字符串。

您可以在第一次读回开始后重新定位输入指针，但这仅适用于文件，因此基本上将整个数据读取到缓冲区，然后对其使用扫描。有关示例，请参见@Hauleth 的答案。

# c++ - 如何在 C++ 中使用套接字？

> ID：10080873
> 
> 赞同：0
> 
> 时间：2012-04-09T22:52:25.613
> 
> 标签：c++, sockets, network-programming

我能找到的所有网络编程指南都用 C 语言编写。全部。甚至可以在 C++ 中建立套接字连接吗？如果是这样，#include 是什么，我在哪里可以找到教程或文档？鉴于语言的流行，我认为必须有多个库来实现这一点——这被认为是最发达和易于使用的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T22:54:24.043

尝试使用[boost ASIO](http://www.boost.org/doc/libs/1_49_0/doc/html/boost_asio.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T22:54:20.310

在这方面，C 和 C++ 之间没有显着差异。

# java - 传递给 UserType 的内容，BlobType.setPreparedStatement 会话参数

> ID：10080878
> 
> 赞同：0
> 
> 时间：2012-04-09T22:53:04.777
> 
> 标签：java, hibernate

[http://blog.xebia.com/2009/11/09/understanding-and-writing-hibernate-user-types/](http://blog.xebia.com/2009/11/09/understanding-and-writing-hibernate-user-types/)

我正在尝试定义一个模仿的客户序列化 UserType，这里引用并提供了 XStreamUserType：

[http://code.google.com/p/aphillips/source/browse/commons-hibernate-usertype/trunk/src/main/java/com/qrmedia/commons/persistence/hibernate/usertype/XStreamableUserType.java](http://code.google.com/p/aphillips/source/browse/commons-hibernate-usertype/trunk/src/main/java/com/qrmedia/commons/persistence/hibernate/usertype/XStreamableUserType.java)

我的序列化器输出一个字节数组，大概应该写入一个 Blob。我打算这样做：

```
public class CustomSerUserType extends DirtyCheckableUserType {
    protected SerA ser=F.g(SerA.class);
    public Class<Object> returnedClass() {
        return Object.class;
    }
    public int[] sqlTypes() {
        return new int[] {Types.BLOB};
    }
    public Object nullSafeGet(ResultSet resultSet,String[] names,Object owner) 
        throws HibernateException,SQLException {
        if()
    }
    public void nullSafeSet(PreparedStatement preparedStatement,Object value,int index) 
        throws HibernateException,SQLException {
        BlobType.nullSafeSet(preparedStatement,ser.ser(value),index);
    }
} 
```

不幸的是，BlobType.nullSafeSet 方法需要会话。那么如何定义一个可以访问 servlet 请求会话的 UserType 呢？

编辑：这里讨论了这个问题，但似乎没有解决方案：[Best way to implement a Hibernate UserType after deprecations?](https://stackoverflow.com/questions/6083768/best-way-to-implement-a-hibernate-usertype-after-deprecations)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T23:32:30.593

这在 UserType 接口中的 4.1 API 中得到解决。

[http://docs.jboss.org/hibernate/orm/4.1/javadocs/](http://docs.jboss.org/hibernate/orm/4.1/javadocs/)

UserType 的方法签名将 SessionImplementor 传递给 nullSafeGet 并设置。

额外提示：确保查看当前的 Javadocs。

# optimization - SOLR 索引尺寸减小

> ID：10080881
> 
> 赞同：5
> 
> 时间：2012-04-09T22:53:22.210
> 
> 标签：optimization, memory, solr, indexing

对于一个大型项目，我们有一些海量的 SOLR 索引，它占用了 50 GB 以上的空间。

我们已经考虑了几种减小与更改索引中的内容相关的大小的方法，但我很好奇我们是否可以对 SOLR 索引进行任何更改，这会将其大小减小 2 个数量级或更多，这与（1）我们可以运行的维护命令或（2）可能未正确设置的简单配置参数直接相关。

另一个相关的问题是（3）有没有办法在 SOLR 内部用索引大小来换取性能，如果是这样，它将如何工作？

对此的任何想法将不胜感激......谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-09T23:42:09.180

您可以做几件事来用性能换取指数大小。例如，整数 (int) 字段使用的空间比 trie 整数 (tint) 少，但使用 int 时范围查询会更慢。

要大幅减少索引，您几乎肯定需要更仔细地查看您正在使用的字段。

*   您是否使用了很多存储字段？如果是这样，请尝试从索引中删除存储的字段，并在从 Solr 获得结果后查询数据库以获取必要的数据。
*   将 omitNorms="true" 添加到不需要长度规范化的文本字段
*   将 omitPositions="true" 添加到不需要词组匹配的文本字段
*   特殊字段，如 NGrams，会占用大量空间
*   您是否要从文本字段中删除停用词？

# ruby-on-rails - 如何使用“OR-join”将哈希作为查询传递？

> ID：10080883
> 
> 赞同：0
> 
> 时间：2012-04-09T22:53:37.750
> 
> 标签：ruby-on-rails, hash, conditional-statements

我有一个带有布尔值的哈希

```
({"u25" => true, "f26t49" => true, "o50" => true, ..}); 
```

总而言之，有 19 个布尔值，我想用我的数据库中的一个表检查这些并获取这些数据集，至少有一个匹配项。我试过了

“Model.all(:conditions => hash)”或“Model.where(hash)”

但我得到了查询

“..u25 == true AND f26t49 == true AND o50 == true...”

但我需要这样的东西：

“..u25 == 真或 f26t49 == 真...”

我希望你能帮助我！

添加：

我试图做一个解决方法并从哈希中生成一个查询字符串。如果我直接写这个字符串 (m = Model.where("u25 == 't'")) 它可以工作，但如果我通过一个变量

```
@query = '"u25 == ' + "'t'" + '"'

m = Model.where(@query) 
```

比 m 为零！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T23:53:17.797

我认为您的解决方法使您朝着正确的方向前进。这是我要做的：

```
# model.rb
def self.search_with_conditions(hash)
  query = hash.map{|k,v| "#{k} == #{v}"}.join(' OR ')
  where(query)
end 
```

然后在您的控制器中，只需调用：

```
m = Model.search_with_conditions(hash) 
```

旁注：这可能适用于某些数据库而不适用于其他数据库，因为有些数据库使用 1 作为 true 的值。另外，我没有时间尝试这个，所以在这种情况下我可能会遗漏一些引号。我认为它可能是`'#{v}'`。

编辑：在了解了更多关于 Rails 的信息后，我必须在此处添加免责声明：

**如果字符串 k 或 v 是某些用户输入的一部分，则此方法容易受到 SQL 注入的影响。小心使用此方法。**

# jquery - 滑动 div 面板返回单击 div 面板内的按钮

> ID：10080887
> 
> 赞同：0
> 
> 时间：2012-04-09T22:53:57.617
> 
> 标签：jquery, asp.net

我正在使用此代码在（button_panel）按钮单击时从右侧滑动我的 div，一切正常，但是当我单击 div 面板内的任何按钮时，面板会回到其原始位置。它不应该发生，因为单击事件仅用于 button_panel。知道为什么吗？

```
var sipPos = 0;
$(document).ready(function () {
    $("#button_panel").click(function (e) {
        e.preventDefault();
        $("#panel").animate({ right: sipPos }, 300, 'linear', function () {
            if (sipPos == 0) { sipPos = -150; }
            else { sipPos = 0; }
        });
    });
});

<div id="panel" style=" border-style: solid; border-color: #008000; background-color:#D5FFD5; width:150px; height:400px; right:-150px; top:142px; position:absolute" align="center" >
    <asp:ImageButton ID="button_panel" runat="server"  style=" background-image: url('images/ProgressBar1.jpg'); width:80px; height:30px; left:-83px;  margin-top:-12px; position:absolute; top:0px" Font-Bold="True" ImageUrl="~/images/green_left_arrow_104.jpg" />
    <asp:Label ID="Label6" runat="server" style="margin-top:5px"  Text="Timer" /><br />
    <asp:Button ID="Button1" runat="server" style="margin-top:5px" Text="AFK!" /><br />
    <asp:Button ID="Button2" runat="server" style="margin-top:5px" Text="REVIEW" /><br />
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T23:03:20.320

您的按钮会触发对其所有父元素（包括面板）的单击。换句话说，事件在 DOM 树中冒泡。

您需要`e.stopPropagation()`在处理程序中为您的按钮做：

```
$(document).ready(function () {
    $("#button_panel").click(function (e) {
        e.preventDefault();

        $("#panel").animate({ right: sipPos }, 300, 'linear', function () {
            if (sipPos == 0) { sipPos = -150; }
            else { sipPos = 0; }
        });
    });

    $("#button_panel button").click(function (e) {
        e.stopPropagation();  // ADD THIS
    });
}); 
```

假设是你实际上有`button`元素。否则，`a`如果您使用链接，请输入。或者，如果您两者都有：

```
$("#button_panel button,a").click(function (e) {
    e.stopPropagation();
}); 
```

演示：http: [//jsfiddle.net/jtbowden/RDKn6/](http://jsfiddle.net/jtbowden/RDKn6/)

# jquery-ui - 防止在 jquery-ui 自动完成期间执行 $.ajaxStart()

> ID：10080889
> 
> 赞同：6
> 
> 时间：2012-04-09T22:54:10.533
> 
> 标签：jquery-ui, jquery

我正在创建的页面上使用 jquery-ui 自动完成功能。在同一页面上，我正在进行一些 ajax 事件。在其他 ajax 事件期间，我正在向我的页面添加一个覆盖，以便用户不再可以点击网站上的所有链接。我不希望在自动完成期间发生这种情况。

自动完成：

```
$(function() {
    $( "#search_input" ).autocomplete({
    source: '/search_autocomplete/',});
}); 
```

阿贾克斯：

```
$.ajax({
    url: "/ajax_login/",
            login_user: $("#login_user").val(),
            password: $("#login_password").val(),
            }); 
```

ajax开始：

```
$("#loading_gif").ajaxStart(function() {
    $("#overlay").show();
    $(this).show();
}); 
```

防止在不需要的 ajax 事件期间执行 ajaxstart 函数。我加

```
global:false, 
```

到相应的ajaxfunctions。如何在不更改 jquery-ui 源的情况下在自动完成期间做类似的事情？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-08-25T07:37:23.543

为此，您必须省略速记调用`source`并像这样更改调用。

```
$('#search_input').autocomplete({
    source: function (request, response) {
        var DTO = { "term": request.term };
        //var DTO = { "term": $('#search_input').val() };
        $.ajax({
            data: DTO,
            global: false,
            type: 'GET',
            url: '/search_autocomplete/',
            success: function (jobNumbers) {
                //var formattedNumbers = $.map(jobNumbersObject, function (item) {
                //    return {
                //        label: item.JobName,
                //        value: item.JobID
                //    }
                //});
                return response(jobNumbers);
            }
        });
    }
    //source: '/search_autocomplete/'
}); 
```

这种长手方法的优点是

1.  您可以传递多个参数。此外，参数名称不必是术语。
2.  简写符号需要一个字符串数组。在这里，您也可以返回一个对象数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-19T23:26:58.540

我同意naveen的答案是最好的解决方案。就我而言，需要更改的大量代码并不划算，因为我们正在重写，我们需要一个短期解决方案。

您可以在 jQuery UI 中覆盖 ajax 调用，我复制了处理 AJAX 请求的 _initSource 函数调用的源代码。然后简单地将 global: false 添加到 $.ajax 选项中。这里的代码基于 jquery-ui 1.9.2，你可能需要为你的版本找到正确的源代码。

```
$.ui.autocomplete.prototype._initSource = function () {
    var array, url,
        that = this;
    if ( $.isArray(this.options.source) ) {
        array = this.options.source;
        this.source = function( request, response ) {
            response( $.ui.autocomplete.filter( array, request.term ) );
        };
    } else if ( typeof this.options.source === "string" ) {
        url = this.options.source;
        this.source = function( request, response ) {
            if ( that.xhr ) {
                that.xhr.abort();
            }
            that.xhr = $.ajax({
                url: url,
                data: request,
                dataType: "json",
                global: false,
                success: function( data ) {
                    response( data );
                },
                error: function() {
                    response( [] );
                }
            });
        };
    } else {
        this.source = this.options.source;
    }
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T23:10:56.543

如果您*大部分*`$.ajax()`时间都想以某种方式工作，但现在*一直都是*，那么您可能不应该更改其默认行为。

 **我建议创建一个函数，将 ajax 请求包装在一个函数中，该函数在适当的时间启用和禁用覆盖。在您希望使用叠加层的位置调用此函数，并使用 plain`$.ajax()`进行自动完成。**

# iphone - iPhone 上的 Dropbox API：如何下载和访问数据

> ID：10080892
> 
> 赞同：0
> 
> 时间：2012-04-09T22:54:18.123
> 
> 标签：iphone, dropbox, dropbox-api, nsdocumentdirectory

我正在使用以下方法将文件从 Dropbox 下载到用户的 Documents 文件夹中：

```
[[self restClient] loadFile:filepath intoPath:[self getDocumentPath]];

    -(NSString *)getDocumentPath {
        NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
        NSString *filepath = [[NSUserDefaults standardUserDefaults] stringForKey:@"filepathDropbox"];
        NSString *path = [[paths objectAtIndex:0] stringByAppendingPathComponent:filepath];
        [[NSUserDefaults standardUserDefaults] setObject:path forKey:@"filepathDropbox"];
        return path;
    } 
```

完成后，如何在本地 iphone 上访问此文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T23:09:39.677

你有没有尝试过类似的东西

```
NSData *data = [NSData dataWithContentsOfFile:[self getDocumentPath]]; 
```

?

# asp.net-mvc-3 - 使用静态属性返回 DbContext 是否有任何问题

> ID：10080898
> 
> 赞同：3
> 
> 时间：2012-04-09T22:54:55.430
> 
> 标签：asp.net-mvc-3, entity-framework

我一直在尝试使用 Entity Framework 4.1 实现一个新的 MVC3 项目，该项目在 Application_BeginRequest 上实例化 dbContext，并将其部署在 Application_EndRequest 上

```
 protected virtual void Application_BeginRequest()
    {
        HttpContext.Current.Items["_EntityContext"] = new EntityContext();
    }

    protected virtual void Application_EndRequest()
    {
        var entityContext = HttpContext.Current.Items["_EntityContext"] as EntityContext;
        if (entityContext != null)
            entityContext.Dispose();
    } 
```

EntityContext 类定义如下：

```
 public class EntityContext : MyEntities, IDisposable
{
    **//should this be static?**
    public static EntityContext Current
    {
        get { return HttpContext.Current.Items["_EntityContext"] as EntityContext; }
    }

    void IDisposable.Dispose()
    {
        Current.Dispose();
    } 
```

我的问题是，将我的 Current 属性定义为静态会在多用户场景中导致任何问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T22:56:57.017

您在 DbContext 上的寿命太长了。您应该为每个请求至少启动一个，甚至更好的是每次访问数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T23:48:15.663

正如 insta 指出的那样，您应该在实际使用上下文时实例化上下文`need`。让你的上下文生命周期那么长没有任何好处。

附带说明一下，不需要显式调用该`Dispose`方法，因为 .NET 垃圾收集器会更有效地为您执行此操作。

您可以为每个类实例化上下文，因为您使用的是 MVC，所以每个控制器实例化一次上下文。

```
public class MyTableObjectController : Controller
{
    MyContext context = new MyContext();

    public ActionResult Index()
    {
        var model = context.MyTableObjects;

        return View(model);
    }
} 
```

我可能会问，你为什么要在开始和结束请求之间保持你的上下文可用？您是否试图避免实例化它？

# c - openmp理论与实践效率？

> ID：10080899
> 
> 赞同：0
> 
> 时间：2012-04-09T22:55:04.167
> 
> 标签：c, performance, parallel-processing, openmp

当我增加一个令人尴尬的并行线性问题的核心数量时（一个 for 循环，其中每次迭代都进行大量计算，都独立于其他迭代），效率降低（效率为 Ts/(p*Tp) ）以某种方式线性尊重到核心数

我知道在实践中线程调度、操作系统和缓存问题会大大减慢实现速度。

我可以补充一点，我确实得到了加速，理论上的问题是线性加速，理论上随着 p 的增加效率为 1。

那么问题来了：随着处理器数量的增加，操作系统、线程调度、内存访问和其他类型的技术限制如何影响算法的效率？？？？它应该影响吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T23:12:45.120

您可能正在考虑类似[阿姆达尔定律的](http://en.wikipedia.org/wiki/Amdahl%27s_law)东西，但每个案例的具体情况很难确定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T23:19:03.567

您应该研究强大的缩放：

[https://www.sharcnet.ca/help/index.php/Measuring_Parallel_Scaling_Performance#Strong_Scaling](https://www.sharcnet.ca/help/index.php/Measuring_Parallel_Scaling_Performance#Strong_Scaling)

由于您提到的所有因素，当您向问题添加更多核心时，您基本上会获得递减收益。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T22:49:42.533

您的问题是 CPU 受限还是内存受限？您的系统架构是什么 - SMP 或 NUMA？您的处理器有多少缓存？您是否将线程绑定到核心？...

在任何人回答您的问题之前，需要考虑的参数太多。我建议您使用 Intel VTune Amplifier 或 Oracle Collector/Analyzer 之类的东西，以查看导致效率越来越低的原因和原因。

# c# - 将特定参数添加到 WPF 中的数据网格

> ID：10080900
> 
> 赞同：0
> 
> 时间：2012-04-09T22:55:10.730
> 
> 标签：c#, wpf, datagrid

所以我尝试了一段时间来寻找像我这样的案例，但真的找不到任何有用的东西。

我的问题是我有一个数据网格，其中我需要有 2 列，其中包含作业名称和作业的创建者。我已经创建了带有标题的列，如下所示。

```
 <DataGrid AutoGenerateColumns="False" Height="257" HorizontalAlignment="Left" 
   Margin="12,12,0,0" Name="dataGrid1" VerticalAlignment="Top" Width="479">

        <DataGrid.Columns>
            <DataGridTextColumn Header="Assignments" />
            <DataGridTextColumn Header="Creator" />
        </DataGrid.Columns>
    </DataGrid> 
```

此外，我尝试将此代码排列为测试。对于最终解决方案，我将从数据库中获取分配列表，但我还没有。

```
 public MainWindow()
    {
        InitializeComponent();
        assignment1 = new Assignment();
        assignment2 = new Assignment();
        assignments = new List<Assignment>();
        assignment1.AddBasicInformation("Engelsk A", "Hans Rueløkke", "Han gik en tur",      0);
        assignment1.AddBasicInformation("Historie B", "Lis Hansen", "Hvad hed den første mand på månen? ___.", 0);
        assignments.Add(assignment1);
        assignments.Add(assignment2);
        for(int i = 0; i < assignments.Count; i++)
        {
           dataGrid1.Items.Add(assignments);
        }
    } 
```

如您所见，分配包含 3 个字符串、一个整数，此外它们还包含几个列表。然而，我想在数据网格中显示的唯一信息是前 2 个字符串。任何人都可以帮助我如何实现这一目标？

编辑我的作业课的重要部分看起来像这样

```
 public class Assignment
{
    private string name;
    private string creator;
    private string assignmentText;
    private int type;
    private List<Answer> answerlist;

    public void AddBasicInformation(string aname, string acreator, string aassignmentText, int atype)
    {
        name = aname;
        creator = acreator;
        assignmentText = aassignmentText;
        type = atype;
        answerlist = new List<Answer>();
    }

    public string GetName()
    {
        return name;
    }

    public string GetCreator()
    {
        return creator;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T23:05:33.033

在构造函数中，将 for 循环替换为：

```
dataGrid1.ItemsSource = assignments; 
```

然后，您可以在 XAML 中声明列的绑定（假设 Assignment 类具有名为 Assignemnts 和 Creator 的属性）：

```
<DataGridTextColumn Header="Assignments" Binding="{Binding Name} />
<DataGridTextColumn Header="Creator" Binding="{Binding Creator}" /> 
```

在此示例中，ItemsSource 的绑定是一种反模式，但它会帮助您入门。

有关详细信息，请参阅[WPF DataGrid 类](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagrid.aspx)。

**编辑**：响应 OP 更新的代码示例

WPF 中的所有绑定都必须使用属性完成。更新您的作业类以使用属性而不是字段：

```
public class Assignment
{
    Public string Name {get; set;}
    Public string Creator {get; set;}
    Public string AssignmentText {get; set;}

    // ...
} 
```

# c# - 基于现有类创建新类

> ID：10080904
> 
> 赞同：1
> 
> 时间：2012-04-09T22:56:06.157
> 
> 标签：c#, linq, linq-to-sql, northwind

我将我的问题引用到 Northwind LINQ to SQL C# 示例（取自 MSDN）：

该数据库包含一个名为的表`Products`，其中有一个名为 的字段`CategoryID`。因此，NorthWindDataClasses.designer.cs 文件包含一个`Product`使用以下数据成员调用的类：

```
private System.Nullable<int> _CategoryID; 
```

还有一个名为的表`Categories`，其中包含以下两个字段：

*   `CategoryID`.
*   `CategoryName`.

我想创建一个新类（在我的 Accessor.cs 文件中），它具有`Product`类中的所有字段，但是`_CategoryID`将有`CategoryName`.

实施它的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T06:11:52.190

最好的方法是将 CategoryName 属性添加到 Product 类（它是部分的并且允许您添加到它）。

```
public partial class Product
{
  public string CategoryName
  {
    get {return this.Category.CategoryName;}
    set{this.Category.CategoryName = value;}
  }
} 
```

# c# - ASP.NET 控件在 CodeBehind 中不可用

> ID：10080906
> 
> 赞同：8
> 
> 时间：2012-04-09T22:56:20.753
> 
> 标签：c#, asp.net, webforms, code-behind

我在我的 ABC.ASPX 页面上拖放了一个 Label 控件。它编译正确。但控制（`Label2` ) 在代码隐藏 ABC.ASPX.cs 中不可用于赋值。

分辨率是多少？

```
<%@ Page language="c#" CodeBehind="ABC.aspx.cs" AutoEventWireup="false" %> 

 <asp:Label ID="Label2" runat="server" Font-Bold="True"></asp:Label> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-10T15:33:32.377

您可能在 Designer.cs 文件中缺少此条目。您可以在文件中添加类似这样的内容：

```
protected global::System.Web.UI.WebControls.Label Label2; 
```

或者删除designer.cs文件，右击父aspx文件，选择“转换为Web应用程序”。这应该使用所有适当的条目重新创建 Designer.cs 文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T15:52:38.700

您可能需要添加`Inherits="XXX.ABC"`Page Directive，其中 XXX 是您的根命名空间。另外，我假设您将类 ABC 命名为与 ABC.aspx.cs 一致。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-05T10:45:36.767

尝试删除控件，保存文件，再次添加控件，然后再次保存文件。问题可能出在您的 *.designer.cs 文件中，这种方法应该重新生成它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-19T16:46:04.420

创建用户组件后，我想在 CalendarTest 页面中对其进行测试。我也无法通过背后的代码访问用户组件。我没有在线找到解决方案，但通过反复试验，我通过以下步骤修复了它：

1) 在 aspx 文件中，<%@Page... 需要 "CodeFile=" 而不是 "Src=" 来指向文件后面的代码

2) 在 aspx.cs 文件后面的代码中，我需要将“public class CalendarTest”替换为“public partial class CalendarTest”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-17T08:33:54.390

右键单击项目，然后选择转换为 Web 应用程序

# php - 在 WordPress 的管理页面中打开标签后插入 HTML

> ID：10080909
> 
> 赞同：1
> 
> 时间：2012-04-09T22:56:48.140
> 
> 标签：php, wordpress, action, customization

我正在向现有网站添加 WordPress 网络，我的要求之一是将管理实用程序嵌入到我们现有网站的布局中。

我编写了一个自定义插件，将函数注册到`admin_head`和`admin_footer`动作。`admin_head`在`<head>`标签内`admin_footer`插入内容并在节的末尾附近插入内容`<body>`。

是否有其他操作可以在`<body>`标签之后或 WordPress 输出任何可见 HTML 之前立即插入内容？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2021-03-09T12:48:38.950

Wordpress 5.2.0 引入了`wp_body_open`钩子（在[WordPress codex](https://developer.wordpress.org/reference/hooks/wp_body_open/)中有详细介绍）

```
// Add code after opening body tag.
add_action( 'wp_body_open', 'wpdoc_add_custom_body_open_code' );

function wpdoc_add_custom_body_open_code() {
    echo '<!-- custom code -->';
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T15:42:31.953

我认为没有可以使用的钩子/过滤器。您可以做的最好的事情是使用 admin_footer。

**编辑**：我正在浏览[admin-header.php](http://core.svn.wordpress.org/trunk/wp-admin/admin-header.php)并找到了一个操作**in_admin_header**

尝试一下。我不确定这是否会解决您的问题。

# macos - 文件在我 ls 之前不会被命令找到

> ID：10080912
> 
> 赞同：0
> 
> 时间：2012-04-09T22:57:07.360
> 
> 标签：macos, osx-lion, cups

当我尝试使用 lpadmin 添加打印机时（在解压缩正确的 PPD 的封闭 .gz 存档后）我经常收到错误：

“无法打开 PPD 文件 [x] - 没有这样的文件或目录。”

但是当我导航到 /Library/Printers/PPDs/Contents/Resources/ 和 ls 时，我试图使用的 PPD 就在那里。所以我在历史上对 lpadmin 打了几次向上光标，然后逐字重新发出命令……它起作用了。

这可以在 10.6 和 10.7 中的众多 Mac 上复制。就好像 ls 命令“说服” lpadmin PPD 确实存在一样。我不知道这是文件系统滞后（缓冲）、终端问题还是其他问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T23:16:19.080

指定 PPD 文件时是否包含路径？即你需要使用类似的东西：

```
lpadmin [...] -P /Library/Printers/PPDs/Contents/Resources/SomePrinter.ppd 
```

如果您只指定`-P SomePrinter.ppd`，它将无法工作，直到/除非您`cd`进入 PPD 所在的文件夹...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T02:32:56.617

使用`-P`(PPD) 标志`lpadmin`需要 PPD 的（绝对或相对）路径。**如果** 且***仅***当您`/Library/Printers/PPDs/Contents/Resources/`使用 PPD 的简单名称时就足够了。

或者，您可以使用`-m`(model) 标志 to `lpadmin`，它不需要路径，而是需要打印机的型号名称。

# apache-fop - Apache FOP、自定义字体、字距调整？

> ID：10080913
> 
> 赞同：4
> 
> 时间：2012-04-09T22:57:10.903
> 
> 标签：apache-fop, kerning

我刚刚使用 Apache FOP 制作了要提交给照片打印服务的 PDF/X 相册。一切似乎都很好，但字距调整。使用自定义衬线字体，例如“portfolio”这个词没有正确呈现（问题在于 fo，因为 o 应该呈现在 f 的“head”下）。例如，在 Mac OS X 下安装相同的字体，并尝试 TextEdit，该单词被正确呈现。

这就是我配置字体的方式：

```
 <font metrics-url="Muli/Muli-Light.xml"  
                  kerning="yes" 
                  embed-url="Muli/Muli-Light.ttf">
                <font-triplet name="Muli" style="normal" weight="300"/>
            </font> 
```

其中 XML 文件是通过按照 FOP 文档处理 TTF 字体来实现的。该文件包含字距调整对，这是 AFAIK 应该需要的。

我错过了什么？我正在使用 FOP 1.0。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T11:55:14.517

我认为缺少这样的词`file:/`：

```
<fonts>
  <font metrics-url="Arialuni.xml" kerning="yes" embed-url="file:/Library/Fonts/Arialuni.ttf">
    <font-triplet name="Arialuni" style="normal" weight="normal"/>
  </font>
</fonts> 
```

# javascript - 如何在单击输入时重定向到其他网页

> ID：10080914
> 
> 赞同：-3
> 
> 时间：2012-04-09T22:57:13.917
> 
> 标签：javascript, html, dom

我有一个类型按钮的输入：

```
<input type='button' value='Click me' /> 
```

我需要在点击时重定向。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T23:01:16.563

html:

```
 <input type='button' id="myBtn" value='Click me' /> 
```

js：

```
var btn = document.getElementById('myBtn');
btn.onclick = function(){
   window.location = "http://stackoverflow.com/";
} 
```

不要忘记`window.onload`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T23:03:17.607

选项1：

改用链接标签

```
<a href="other_site">Click Me</a> 
```

并通过 CSS 使元素看起来像按钮。

选项 2：

```
<input type="button" value="Click Me" 
       onclick="window.location='http://www.example.org';" /> 
```

# c++ - 可以为泛型类中的一种类型提供一个函数吗？

> ID：10080923
> 
> 赞同：1
> 
> 时间：2012-04-09T22:58:02.583
> 
> 标签：c++, generics

是否可以创建一个仅在使用特定类型实例化类时才可用的函数？（不为该类型重写整个类？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T23:05:35.043

如果我了解您所追求的，一种可能性是使用包含其他功能的基类，然后拥有一个模板和一个都从该基类派生的专业化，并通过专业化添加您想要的额外功能：

```
struct X {
    int x() { return 1; }
};

template<class T>
struct Y : public X {
};

template<>
struct Y<int> : public X {
    int y() { return 2; }
};

int main() {
    Y<long> y;
    y.x();
    Y<int> z;
    z.y();
    return 0;
} 
```

# android - R.id 没有解决

> ID：10080926
> 
> 赞同：0
> 
> 时间：2012-04-09T22:58:41.570
> 
> 标签：android, android-videoview

我向其中一个应用程序页面添加了一个视频视图，当我尝试通过执行 R.id.videoview 来识别它时，.id 无法解析。有人可以帮帮我吗？

```
package jslsoftware.com;

import android.app.Activity;
import android.net.Uri;
import android.os.Bundle;
import android.widget.VideoView;
import android.widget.MediaController;

public class TestActivity extends Activity {
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    Uri vidFile = Uri.parse("http://jslserver1.yolasite.com/resources/3gp_videos/Animal.3gp");
    VideoView videoView = (VideoView) findViewById(R.id.VideoView)
    videoView.setVideoURI(vidFile);
    videoView.setMediaController(new MediaController(this));
    videoView.start();

} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T23:04:24.917

您是否尝试为此视图添加另一个 ID？像“testName”？您是否检查过您的 xml 文件是否已保存？项目没有错误？

我认为在将此视图放在“表单”上后，您总是必须编辑 ID，如果您不这样做，您将无法使用 R.id 识别它......

# iphone - GLKViewControllerDelegate 被阻止

> ID：10080932
> 
> 赞同：8
> 
> 时间：2012-04-09T22:59:15.820
> 
> 标签：iphone, opengl-es, mapkit, glkit

我有一个 GLKViewController 来处理一些 OpenGL 绘图。我已经实现了`glkView:drawInRect`and`update`方法并将`preferredFramesPerSecond`属性设置为 30（默认值）。

问题是当用户与应用程序的其他部分交互时，委托方法停止触发。我见过发生这种情况的两种情况是用户滚动 UITableView 或与 MKMapView 交互时。

有没有办法确保这些代表*总是*触发，而不管应用程序的其余部分在做什么。我希望这些停止的唯一时间是应用程序进入后台时（这是自动执行的）。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-07T21:52:29.927

这样做的原因是在表格视图或地图视图中滚动期间，runloop`UITrackingRunLoopMode`的优先级高于默认模式。这可以防止某些事件触发以保证高滚动性能。

要解决您的问题，您必须设置自己的渲染循环，而不是依赖`GLKViewController`.

*   第一组`enableSetNeedsDisplay`to `GLKView`（`NO`应该在使用 GLKViewController 时自动设置）。
*   设置为 0（或可能为 1）以禁用或根本不使用 GLKViewController`preferredFramesPerSecond`的渲染循环`GLKViewController`
*   导入 QuartzCore 框架：`#import <QuartzCore/QuartzCore.h>`
*   创建一个`CADisplayLink`并将其安排在`NSRunLoopCommonModes`：

```
CADisplayLink* displayLink = [CADisplayLink displayLinkWithTarget:self 选择器:@selector(render:)];
[displayLink addToRunLoop:[NSRunLoop currentRunLoop] forMode:NSRunLoopCommonModes];

```

*   可选：将 displayLink 的 frameInterval 设置为 2（= 帧速率的一半）
*   渲染方法：

```
- (void)render:(CADisplayLink*)displayLink {
    GLKView* 视图 = (GLKView*)self.view;
    [查看显示]；
}

```

我还没有测试过，所以告诉我它是否有效！

# c# - set onclick in codebehind for Anchor tag to download pdf

> ID：10080933
> 
> 赞同：1
> 
> 时间：2012-04-09T22:59:30.587
> 
> 标签：c#, asp.net, html

I am trying to use anchor in codebehind and download a pdf when that anchor is clicked. I have downloading stuff working fine on pageload, but i am not sure how to set onlick to download for pdf.

```
HtmlAnchor apdf = new HtmlAnchor();
apdf.ID = Guid.NewGuid().ToString("N");
apdf.InnerText = dsreport.Tables[0].Rows[0]["ImageName"].ToString();
apdf.Attributes.Add("style", "font-weight: bold; font-size: 13px; margin: 0px;font-family: Arial; color: #1e7c9b; text-decoration: underline");
apdf.Attributes.Add("onclick", ""); 
```

for each onclick, i have to set the below code, so the pdf gets download only on click.

```
byte[] aByteArrayOfTheFile = (byte[])(dsreport.Tables[0].Rows[0]["ImageData"]);
SendAsFileToBrowser(aByteArrayOfTheFile, "application/pdf", "downloaded.pdf"); 
```

**UPDATE :**

```
 public static string SendAsFileToBrowser(byte[] File, string Type, string FileName)
 {
    string disp = "attachment";
    if (string.IsNullOrEmpty(FileName))
    {
        disp = "inline";
    }

    // set headers
    //char r = HttpContext.Current.Response;

    HttpContext.Current.Response.ContentType = Type; // eg "image/Png"
    HttpContext.Current.Response.Clear();
    HttpContext.Current.Response.AddHeader("Content-Type", "binary/octet-stream");
    HttpContext.Current.Response.AddHeader("Content-Length", File.Length.ToString());
    HttpContext.Current.Response.AddHeader("Content-Disposition", disp + "; filename=" + FileName + "; size=" + File.Length.ToString());
    HttpContext.Current.Response.Flush();       

    // write data to requesting browser
    HttpContext.Current.Response.BinaryWrite(File);
    HttpContext.Current.Response.Flush();
    return "";
} 
```

using this opens on pageload, not on Onclick. Want to download only when the user clicks.

I am using c# 2.0 in VS 2005 and sql server 2005\. setting onclick in code behind is really a mess in my head. Thank you in advance for the help!!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T23:07:26.743

如果您希望在浏览器中查看 pdf，请尝试此操作

apdf.Attributes.Add("onclick", "window.location.href='../linktopdf/thepdf.pdf;'");

如果您想下载 pdf，您可以创建一个 ashx Web 服务，并将内容类型响应设置为 application/pdf 作为响应，然后从那里下载它作为再见。然后应该会出现下载窗口。

这是一个有用的线程的链接：

[如何强制自动下载pdf？](https://stackoverflow.com/questions/2598658/jquery-how-to-force-a-pdf-download-automatically)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T08:01:28.703

哦，我明白你现在需要什么了。尝试这个：

```
 apdf.Click += new EventHandler(this.SendAsFileToBrowser);   

    container.Controls.Add(apdf); 
```

并确保将此代码放在页面的 Pre_Init 方法而不是 Page_load 中。

试试这个，让我知道它是怎么回事。

# java - 如何插入单列mysql 我有两个使用java 的JCheckBox？

> ID：10080934
> 
> 赞同：0
> 
> 时间：2012-04-09T22:59:33.387
> 
> 标签：java, insert, resultset

**一个 JCheckBox 将被插入到数据库中**

```
String R=chckbxRsidentel.getSelectedObjects().toString();
String A=chckbxAffaire.getSelectedObjects().toString(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T23:05:32.173

我假设您要根据选中的复选框将“R”或“A”插入数据库。如果两者都没有被选中，也许你还想插入，比如说“”。

你可以这样做：

```
char check = chckbxRsidentel.isSelected() ? "R" :
             chckbxAffaire.isSelected() ? "A" : " "; 
```

# c++ - When is an object "out of scope"?

> ID：10080935
> 
> 赞同：32
> 
> 时间：2012-04-09T22:59:58.000
> 
> 标签：c++, scope, destructor

In C++, when is an object defined as "out of scope"?

More specifically, if I had a singly linked list, what would define a single list node object as "out of scope"? Or if an object exists and is being referenced by a variable `ptr`, is it correct to say that the object is defined as "out of scope" the moment the reference is deleted or points to a different object?

UPDATE: Assuming an object is a class that has an implemented destructor. Will the destructor be called the moment the object exits the scope?

```
if (myCondition) {
    Node* list_1 = new Node (3);
    Node* list_2 = new Node (4);
    Node* list_3 = new Node (5);

    list_1->next = list_2;
    list_2->next = list_3;
    list_3->next = null;
} 
```

In other words, would the Node being pointed to by `list_1` call its destructor after this line:

```
Node* list_1 = new Node (3); 
```

?

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-04-09T23:10:18.103

首先，请记住 C++ 中的对象既可以**在堆栈**上创建，也可以**在堆上创建。**

堆栈帧（或范围）由语句定义。那可以大到一个函数，也可以小到一个流控制块（`while`/ `if`/`for`等）。包含任意代码块的任意`{}`对也构成堆栈帧。一旦程序退出该框架，在框架内定义的任何局部变量都将超出范围。当堆栈变量超出范围时，将调用其析构函数。

所以这是一个堆栈帧（函数的执行）和在其中声明的局部变量的经典示例，一旦堆栈帧退出，它将超出范围 - 一旦函数完成：

```
void bigSideEffectGuy () {
    BigHeavyObject b (200);
    b.doSomeBigHeavyStuff();
}
bigSideEffectGuy();
// a BigHeavyObject called b was created during the call, 
// and it went out of scope after the call finished.
// The destructor ~BigHeavyObject() was called when that happened. 
```

这是一个示例，我们看到堆栈帧只是`if`语句的主体：

```
if (myCondition) {
    Circle c (20);
    c.draw();
}
// c is now out of scope
// The destructor ~Circle() has been called 
```

退出框架后堆栈创建的对象“保留在范围内”的唯一方法是它是否是函数的返回值。但这并不是真正的“保留在范围内”，因为正在复制对象。所以原件超出了范围，但制作了一份副本。例子：

```
Circle myFunc () {
    Circle c (20);
    return c;
}
// The original c went out of scope. 
// But, the object was copied back to another 
// scope (the previous stack frame) as a return value.
// No destructor was called. 
```

现在，也可以在堆上声明对象。为了便于讨论，将堆视为无定形的内存块。与堆栈不同，堆栈会在您进入和退出堆栈帧时自动分配和取消分配必要的内存，您必须手动保留和释放堆内存。

在堆上声明的对象确实在堆栈帧之间“存活”。可以说在堆上声明的对象永远不会超出范围，但这实际上是因为该对象从未真正与任何范围相关联。这样的对象必须通过`new`关键字创建，并且必须由指针引用。

完成后释放堆对象是您的责任。`delete`使用关键字释放堆对象。在释放对象之前，不会调用堆对象上的析构函数。

指向堆对象的指针本身通常是与作用域相关的局部变量。使用完堆对象后，就允许引用它的指针超出范围。如果您没有显式释放指针指向的对象，那么堆内存块将永远不会被释放，直到进程退出（这称为内存泄漏）。

可以这样想：在堆栈上创建的对象就像用胶带粘在房间里的椅子上的气球。当你离开房间时，气球会自动弹出。在堆上创建的对象就像丝带上的气球，系在房间的椅子上。丝带是指针。当你离开房间时，丝带会自动消失，但气球只是漂浮在天花板上并占据空间。正确的做法是用别针戳破气球，然后离开房间，丝带就会消失。但是，绳子上的气球的好处是您还可以解开丝带，将其握在手中，然后离开房间并随身携带气球。

因此，转到您的链表示例：通常，此类列表的节点在堆上声明，每个节点都持有指向下一个节点的指针。所有这些都在堆上，永远不会超出范围。唯一可能超出范围的是指向列表根的指针 - 您首先用来引用列表的指针。这可能超出范围。

这是在堆上创建东西的示例，并且根指针超出范围：

```
if (myCondition) {
    Node* list_1 = new Node (3);
    Node* list_2 = new Node (4);
    Node* list_3 = new Node (5);

    list_1->next = list_2;
    list_2->next = list_3;
    list_3->next = null;
}
// The list still exists
// However list_1 just went out of scope
// So the list is "marooned" as a memory leak 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-09T23:03:02.657

```
{ //scope is defined by the curly braces
    std::vector<int> vec;
}
// vec is out of scope here!
vec.push_back(15); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-09T23:05:07.477

当它离开它声明的范围时:)

如果没有看到实施，您的问题就无法回答。它归结为您声明此节点的位置。

```
void Foo()
{
    int i = 10;

    {
        int j = 20;
    } // j is out of scope

} // i is out of scope 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-09T23:05:52.953

“超出范围”是一个转喻：例如，使用一个概念的名称或术语来谈论密切相关但不同的事物。

在 C++ 中，作用域是程序文本的静态区域，因此“超出作用域”的字面意思是物理上位于文本区域之外。例如，`{ int x; } int y;`: 的声明`y`超出了`x`可见的范围。

转喻“超出范围”用于表达与某个范围相关的环境的动态激活/实例化正在终止的想法。因此，在该范围内定义的变量正在消失（因此“超出范围”）。

实际上“超出范围”的是指令指针，可以这么说；该计划的评估现在是在一个不可见的范围内进行的。但并不是范围内的所有东西都消失了！下次进入范围时，静态变量仍然存在。

“走出范围”不是很准确，但很简短，每个人都明白它的意思。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-09T23:08:56.083

当执行离开该部分代码时，在函数内部（或在函数内部某些花括号括起来的构造内部）声明的对象将超出范围。

```
void some_func() {
  std::string x("Hello!");
  // x is in scope here
}
// But as soon as some_func returns, x is out of scope 
```

这仅适用于在堆栈上声明的东西，因此它与单链表几乎没有关系，因为列表节点通常会在堆上用`new`.

在这个例子中，当函数退出时，返回的*指针*`new`将超出范围，但节点本身不会发生任何事情：

```
void make_a_node() {
  Node* p = new Node;
} // Oh noes a memory leak! 
```

# javascript - Using javascript to add form fields, but what will the new name be?

> ID：10080937
> 
> 赞同：1
> 
> 时间：2012-04-09T23:00:22.530
> 
> 标签：javascript, forms, field, add

After reading this post: [using javascript to add form fields.. but below, not to the side?](https://stackoverflow.com/questions/1950837/using-javascript-to-add-form-fields-but-below-not-to-the-side) I've made the button work! But I don't know how to receive the output. This is what I entered.

```
 var counter = 0;
        function addNew() {
            // Get the main Div in which all the other divs will be added
            var mainContainer = document.getElementById('mainContainer');
            // Create a new div for holding text and button input elements
            var newDiv = document.createElement('div');
            // Create a new text input
            var newText = document.createElement('input');
            newText.type = "input"; 
            newText.maxlength = "50"; 
            newText.maxlimit = "50"; 
            newText.size = "60"; 
            newText.value = counter;
            // Create a new button input
            var newDelButton = document.createElement('input');
            newDelButton.type = "button";
            newDelButton.value = "Delete";

            // Append new text input to the newDiv
            newDiv.appendChild(newText);
            // Append new button input to the newDiv
            newDiv.appendChild(newDelButton);
            // Append newDiv input to the mainContainer div
            mainContainer.appendChild(newDiv);
            counter++;

            // Add a handler to button for deleting the newDiv from the mainContainer
            newDelButton.onclick = function() {
                    mainContainer.removeChild(newDiv);
            }
        }
    </script> 
```

With this in the form:

```
<input type="button"  size="3" cols="30" value="Add" onClick="addNew()"> 
```

So, what will the new field names be? I don't understand enough of the coding to figure out what I'm telling it to. Good thing there are other smart folks out there for me to lean on!

Thanks for any answers.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T23:05:37.897

```
newText.name = "newInputName-" + counter; // for name
newText.id = "newInputId-" + counter;   // for id 
```

对于按钮

```
newDelButton.name = "btnDeleteName"; // for name, or "btnDeleteName-"+counter for multiple
newDelButton.id = "btnDeleteId";     // for id    or "btnDeleteId-"+counter for multiple 
```

`Name`并且`Id`对于任何项目都可以相同，即

```
newText.name = "newInput-" + counter; // for name
newText.id = "newInput-" + counter;   // for id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T23:04:46.043

你可以这样做：

```
 var counter = 0;
        function addNew() {
        // Get the main Div in which all the other divs will be added
        var mainContainer = document.getElementById('mainContainer');
        // Create a new div for holding text and button input elements
        var newDiv = document.createElement('div');
        // Create a new text input
        var newText = document.createElement('input');
        newText.type = "input";
        newText.id = "AddedInput_" + counter;
        ... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T23:09:33.810

您必须为此元素添加“名称”属性。你可以做类似的事情

newText.name = "newInput-" + 计数器；//这是另一个答案所说的。

这样，您将在提交后在服务器上收到 newInput-0、newInput-1 等

# c - C Inline Assembly label issue

> ID：10080939
> 
> 赞同：3
> 
> 时间：2012-04-09T23:00:26.437
> 
> 标签：c, assembly, inline-assembly

I'm currently a total beginner with assembly and am learning how to use assembly inline with C for a class. That being said, I'm having a hard time with this particular error when I'm compiling my file:

```
/tmp/cckHnU89.s: Assembler messages:
/tmp/cckHnU89.s:550: Error: symbol `.L16' is already defined
/tmp/cckHnU89.s:571: Error: symbol `.L18' is already defined
/tmp/cckHnU89.s:576: Error: symbol `.L17' is already defined

```

I tried replacing the names of the labels with other names since I noticed from the .s file that the labels .L16, .L17, and .L18 are used in my main method as well as in one of my functions. However, when did that I just ended up with a segmentation fault from running the program. Is there a way to change the names of the labels or something else to fix which apparently seems to be a naming conflict?

As far as my CPU, I'm running an Intel Pentium T4500 processor and I'm compiling with gcc version 4.4.3\. My code is 300+ lines for the inline assembly portion so I'll spare whoever reads this. Essentially, I'm just looking for a general answer on how one would normally fix the naming conflict that produces the error above. Anything insight would be greatly appreciated.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T01:03:09.983

我的预感是（我刚刚用`g++ -S`和验证了它`gcc -S`）您自己的标签完全模仿了`.L<num>`自动分配给 GCC 中的汇编代码的标签的命名方案 ( )。

请执行下列操作：

```
# for C:
gcc -S source.c
# for C++
g++ -S source.cpp 
```

...然后`cat`（或`less`）生成的`.s`文件（相同的基本名称，`.s`后缀，例如`source.s`）。您会发现该方案的许多标签 ( `.L<num>`)。现在，如果您自己创建的内联程序集包含与已经自动创建的标签（来自您的 C 代码）相同的名称，那显然会导致冲突。

所以要点：不要`.L<num>`用作标签的命名方案，因为它会发生冲突。

**一般来说**，以开头的名字`.L`似乎在这里自找麻烦。

* * *

示例 ( `test.cpp`)，编译`g++ -S test.cpp`：

```
#include <cstdio>

int main(int argc, char**argv)
{
        switch(argc)
        {
                case 0:
                        printf("test 0\n");
                        break;
                case 1:
                        printf("test %d\n", argc);
                        break;
                case 2:
                        printf("test %d -> %s\n", argc, argv[0]);
                        break;
                default:
                        printf("Default\n");
                        break;
        }
        return 0;
} 
```

在 x64 上编译（的内容`test.s`）：

```
 .file   "test.cpp"
        .section        .rodata
.LC0:
        .string "test 0"
.LC1:
        .string "test %d\n"
.LC2:
        .string "test %d -> %s\n"
.LC3:
        .string "Default"
        .text
.globl main
        .type   main, @function
main:
.LFB0:
        .cfi_startproc
        .cfi_personality 0x3,__gxx_personality_v0
        pushq   %rbp
        .cfi_def_cfa_offset 16
        movq    %rsp, %rbp
        .cfi_offset 6, -16
        .cfi_def_cfa_register 6
        subq    $16, %rsp
        movl    %edi, -4(%rbp)
        movq    %rsi, -16(%rbp)
        movl    -4(%rbp), %eax
        cmpl    $1, %eax
        je      .L4
        cmpl    $2, %eax
        je      .L5
        testl   %eax, %eax
        jne     .L8
.L3:
        movl    $.LC0, %edi
        call    puts
        jmp     .L6
.L4:
        movl    -4(%rbp), %eax
        movl    %eax, %esi
        movl    $.LC1, %edi
        movl    $0, %eax
        call    printf
        jmp     .L6
.L5:
        movq    -16(%rbp), %rax
        movq    (%rax), %rdx
        movl    -4(%rbp), %eax
        movl    %eax, %esi
        movl    $.LC2, %edi
        movl    $0, %eax
        call    printf
        jmp     .L6
.L8:
        movl    $.LC3, %edi
        call    puts
.L6:
        movl    $0, %eax
        leave
        ret
        .cfi_endproc
.LFE0:
        .size   main, .-main
        .ident  "GCC: (Debian 4.4.5-8) 4.4.5"
        .section        .note.GNU-stack,"",@progbits 
```

`.L`观察生成的汇编文件中以开头的名称。

# android - get image from thumbnails query on android

> ID：10080940
> 
> 赞同：3
> 
> 时间：2012-04-09T23:00:27.190
> 
> 标签：android, image-processing

I have this code (found on this site, somewhere):

```
 public static List<MyImages> getImages(Activity context) {
    List<MyImages> lst = new ArrayList<MyImages>();
    Cursor cursor = getCameraThumbImages(context);
    if (cursor != null) {
        int columnIndex = cursor
                .getColumnIndexOrThrow(MediaStore.Images.Thumbnails._ID);
        int columnIndexPath = cursor
                .getColumnIndexOrThrow(MediaStore.Images.Thumbnails.DATA);
        int columnIndexImagePath = cursor
                .getColumnIndexOrThrow(MediaStore.Images.Thumbnails.IMAGE_ID);
        int count = cursor.getCount();
        for (int i = 0; i < count; i++) {
            cursor.moveToPosition(i);

            int imageID = cursor.getInt(columnIndex);
            String path = cursor.getString(columnIndexPath);
            Uri imgThmbPath = Uri.withAppendedPath(
                    MediaStore.Images.Thumbnails.EXTERNAL_CONTENT_URI, ""
                            + imageID);
            String hope = cursor.getString(columnIndexImagePath);
            MyImages p2p = new MyImages(path, "" + imageID);
            lst.add(p2p);
        }
    }

    return lst;
} 
```

This code allow me to access the thumbnails of the images on my phone. The issue is that I don't see how to get the original image path from this.

The question is: given the thumbnail (or the cursor), how do i get the original image path?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T11:30:23.593

在 thumbnail 中有 MediaStore.Images.Thumbnails.IMAGE_ID 字段，您可以从中获取相关的图像 id。比查询 MediaStore.Images.Media 并从 MediaStore.Images.Media.DATA 字段获取照片的路径。

**编辑**

```
// First request thumbnails what you want
String[] projection = new String[] {MediaStore.Images.Thumbnails._ID, MediaStore.Images.Thumbnails.IMAGE_ID};
Cursor thumbnails = contentResolver.query(MediaStore.Images.Thumbnails.EXTERNAL_CONTENT_URI, projection, null, null, null);

// Then walk thru result and obtain imageId from records
for (thumbnails.moveToFirst(); !thumbnails.isAfterLast(); thumbnails.moveToNext()) {
    String imageId = thumbnails.getString(thumbnails.getColumnIndex(Thumbnails.IMAGE_ID));

    // Request image related to this thumbnail 
    String[] filePathColumn = { MediaStore.Images.Media.DATA };

    Cursor images = contentResolver.query(MediaStore.Images.Media.EXTERNAL_CONTENT_URI, filePathColumn, MediaStore.Images.Media._ID + "=?", new String[] {imageId}, null);

    if (cursor != null && cursor.moveToFirst()) {
        // Your file-path will be here
        String filePath = cursor.getString(cursor.getColumnIndex(filePathColumn[0]));
    }

}

//Of course you need to restrict queries using selection and selection args params and get only rows that you really need 
```

# windows-mobile - Northwind database for SQL Server CE?

> ID：10080941
> 
> 赞同：0
> 
> 时间：2012-04-09T23:00:30.260
> 
> 标签：windows-mobile, sql-server-ce, windows-mobile-6, windows-mobile-6.5, northwind

Is there somewhere I can get a version of the Northwind database for SQL Server CE to run on Windows Mobile 6.5 (and below) devices?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T23:54:05.693

在我的电脑上它在这里：

`C:\Program Files (x86)\Microsoft SQL Server Compact Edition\v3.5\Samples`

# templates - JSF and ways to remove content Iframe from an old JSP webapp

> ID：10080942
> 
> 赞同：1
> 
> 时间：2012-04-09T23:00:34.613
> 
> 标签：templates, jsf, iframe

I'm working on an old JSP webapp, that has basic 3 presentation areas:

top menu / side menu / content

Initially, this layout used IFRAMES. Other people has changed before the top menu and side menu from Iframe to DIV approach, but not the content IFRAME.

Every page of the system is an individual JSP page, with many Includes of other JSPs (access control, session time, etc), JS, CSS, etc.

When I try to use DIV to load content, many problems happens because this option insert the content into a base code (main page), that has your own CSS, JS, included JSPs.

a4j:include, ui:include (templates with facelets), and c:import are options that like DIV, mix the codes.

I want an option that like IFRAME, insert an independent and isolated page in an area of a main page. Without this, many hardwork (and tedious) would be necessary to adapt every single file content with the main page.

Unfortunately my boss don't want to remains on IFRAME :)....

Update: BalusC, it's a honor to me that you had answered my question. I'm living my first experience with work as a developer (always was a personal dream, since I'm child when I have first contacts with Basic in a TK90X plugged into tv) , started in this job 2 months ago, and some times I can see your comments around the web helping many people.

I'm very starter with JSF / JSP, but the question is about how to drop the IFRAME and use another solution to load content, with minimal project impact, because the webapp has more than 1k JSP files, someones already using JSF tags (the project is slowly been updated to use JSF). We are using JAVA 6, Tomcat 6 and JSF 1.2.

Some problems with use of a4j:include, for example, is that the included pages action as a part of the main page, and:

1- every page need to use a f:subview tag instead f:view. All of them that already migrated to JSF are using f:view (very manual changes were necessary).

2- with include, the URL path reference is the path of the main page, not the path of the included file (with IFRAME this problem don't exists). Every page of project was made to work with frames, using includes of JS, CSS, JSPs, many o them using relative path like: "../../javascript/jsfile.js".

As you can see, with includes or imports (a4j, ui), many hardwork will be necessary (more than 1k file changes. An option that acts like Iframe, including an independent page at the content area (the webapp was made for that), will help me a lot. I know that this not is the correct way, but the webapp is very large to do a drastic change quickly with templates or other solutions.

Forgive me for the bad English and possible basic questions that I don't know.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T22:35:56.780

我使用 HTML 标签“对象”解决了我的问题。与“iframe”一样，使用此标签“嵌入文档保持独立于主文档”。(w3c.org)

这个标签是 HTML Strict 的。

链接到关于“对象”的 w3c 页面：http: [//www.w3.org/TR/html401/struct/objects.html](http://www.w3.org/TR/html401/struct/objects.html)

不管怎么说，还是要谢谢你。

# mysql - creating an alias after row's computations?

> ID：10080943
> 
> 赞同：1
> 
> 时间：2012-04-09T23:00:36.663
> 
> 标签：mysql, sql

there's a way to create an alias after some computation?

in practice there is a better way to write this:

```
select
    case when aaa ... then then else end AS ALIAS1,
    case when bbb ... then then else end AS ALIAS2,
    case when ccc ... then then else end AS ALIAS3,
    /* the sum of previous aliases */
    case when aaa ... then then else end +
    case when bbb ... then then else end +
    case when ccc ... then then else end AS ALIAS_SUM 
```

thank you in advance

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T23:05:30.927

你可以做这样的事情。这样你就不会处理两次案件。

```
SELECT *, ALIAS1 + ALIAS2 + ALIAS3 AS ALIAS_SUM
FROM 
(
    SELECT 
        CASE WHEN aaa ... THEN ... ELSE END AS ALIAS1,
        CASE WHEN bbb ... THEN ... ELSE END AS ALIAS2,
        CASE WHEN ccc ... THEN ... ELSE END AS ALIAS3
    FROM...
) AS casequeries 
```

# python - Complicated parsing in python

> ID：10080944
> 
> 赞同：2
> 
> 时间：2012-04-09T23:00:49.697
> 
> 标签：python, parsing

I have a weird parsing problem with python. I need to parse the following text.

Here I need only the section between(not including) "pre" tag and column of numbers (starting with 205 4 164). I have several pages in this format.

```
<html>
<pre>

A Short Study of Notation Efficiency

CACM August, 1960

Smith Jr., H. J.

CA600802 JB March 20, 1978  9:02 PM

205 4   164
210 4   164
214 4   164
642 4   164
1   5   164

</pre>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T23:21:28.637

Quazi，这需要一个正则表达式，特别`<pre>(.+?)(?:\d+\s+){3}`是启用了 DOTALL 标志。

[您可以在http://docs.python.org/library/re.html](http://docs.python.org/library/re.html)找到有关如何在 Python 中使用正则表达式的信息，如果您进行了大量此类字符串提取，您会很高兴您做到了。逐个检查我提供的正则表达式：

`<pre>`只是直接匹配 pre 标签
`(.+?)`匹配并捕获
`(?:\d+\s+){3}`与一些数字后跟一些空格匹配的任何字符，连续 3 次

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T23:42:06.697

我可能会使用 lxml 或 BeautifulSoup。IMO，正则表达式被过度使用，特别是在解析 HTML 时。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T23:25:58.057

这是执行此操作的正则表达式：

```
findData = re.compile('(?<=<pre>).+?(?=[\d\s]*</pre>)', re.S)

# ...

result = findData.search(data).group(0).strip() 
```

[这是一个演示。](http://codepad.org/M71yUzqw)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-10T00:10:21.357

其他人提供了正则表达式解决方案，这些解决方案很好，但有时可能会出现意外行为。

如果页面完全如您的示例中所示，那就是：

*   不存在其他 HTML 标记 - 只有`<html>`and`<pre>`标记
*   行数始终一致
*   行间距始终保持一致

然后像这样的简单方法就可以了：

```
my_text = """<html>
<pre>

A Short Study of Notation Efficiency

CACM August, 1960

Smith Jr., H. J.

CA600802 JB March 20, 1978  9:02 PM

205 4   164
210 4   164
214 4   164
642 4   164
1   5   164

</pre>
</html>"""

lines = my_text.split("\n")

title   = lines[4]
journal = lines[6]
author  = lines[8]
date    = lines[10] 
```

如果不能保证行*间距*，但可以保证只需要;内的*前四个非空白行*`<html><pre>`。

```
import pprint

max_extracted_lines = 4
extracted_lines = []
for line in lines:
    if line == "<html>" or line == "<pre>":
        continue
    if line:
        extracted_lines.append(line)
    if len(extracted_lines) >= max_extracted_lines:
        break

pprint.pprint(extracted_lines) 
```

给出输出：

```
['A Short Study of Notation Efficiency',
 'CACM August, 1960',
 'Smith Jr., H. J.',
 'CA600802 JB March 20, 1978  9:02 PM'] 
```

不要在可以进行简单字符串操作的地方使用正则表达式。

# java - log4j additivity, category logging level and appender threshold

> ID：10080951
> 
> 赞同：3
> 
> 时间：2012-04-09T23:01:51.800
> 
> 标签：java, logging, log4j, categories

I'm having trouble understanding the relation between additivity, category logging level and appender threshold.

here's the scenario (my log4j.properties file):

```
log4j.category.GeneralPurpose.classTypes=INFO, webAppLogger
log4j.additivity.GeneralPurpose.classTypes=true

log4j.category.GeneralPurpose=ERROR, defaultLogger
log4j.additivity.GeneralPurpose=false

log4j.appender.webAppLogger=org.apache.log4j.RollingFileAppender
log4j.appender.webAppLogger.File=webapps/someWebApp/logs/webApp.log
log4j.appender.webAppLogger.MaxFileSize=3000KB
log4j.appender.webAppLogger.MaxBackupIndex=10
log4j.appender.webAppLogger.layout=org.apache.log4j.PatternLayout
log4j.appender.webAppLogger.layout.ConversionPattern=%d [%t] (%F:%L) %-5p - %m%n
log4j.appender.webAppLogger.Encoding=UTF-8

log4j.appender.defaultLogger=org.apache.log4j.RollingFileAppender
log4j.appender.defaultLogger.File=logs/server.log
log4j.appender.defaultLogger.MaxFileSize=3000KB
log4j.appender.defaultLogger.MaxBackupIndex=10
log4j.appender.defaultLogger.layout=org.apache.log4j.PatternLayout
log4j.appender.defaultLogger.layout.ConversionPattern=%d [%t] (%F:%L) %-5p - %m%n
log4j.appender.defaultLogger.Encoding=UTF-8 
```

insights: category GeneralPurpose.classTypes is INFO category GeneralPurpose.classTypes has additivity TRUE category GeneralPurpose is ERROR category GeneralPurpose has additivity FALSE

with the current configuration I would have assumed that INFO messages sent to category GeneralPurpose.classTypes.* would be only logged to webAppLogger since the parent logger (category) is set with ERROR level logging. However, this is not the case, the message is logged twice (one in each log file). Looks like the ERROR logging level for the parent category is not taken into consideration when the event is sent as part of additivity.

1.  is my observation correct or am I missing something ?
2.  how should I alter the configuration in order to achieve only ERROR level loggings in server.log?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T23:25:13.180

类别的级别决定是否记录或丢弃*源自该类别的事件；*它对从子类别接收到的事件没有任何过滤效果。

由于`GeneraPurpose.classTypes`级别为`INFO`，任何不严重的事件`INFO`都将被丢弃，但其余的将被保留。

由于`GeneralPurpose.classTypes`具有可加性`true`，启用的事件将被传递到其在层次结构中的父类别——特别是包括`GeneralPurpose`.

由于未在 上设置阈值`webAppLogger`，因此它将记录它接收到的所有事件。

由于未在 上设置阈值`defaultLogger`，因此它将记录它接收到的所有事件。

如果您希望`defaultLogger`仅包含`ERROR`事件或更糟，请将其阈值设置为`ERROR`。

# android - How to access a computer from an Android phone

> ID：10080952
> 
> 赞同：0
> 
> 时间：2012-04-09T23:01:59.383
> 
> 标签：android, controls, wifi

If I want to access a computer and control that computer using an Android application through a [LAN](http://en.wikipedia.org/wiki/Local_area_network) network, what is required to make something like that, do we always need to have a server application on the computer and the application is the client?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T23:58:48.793

不，计算机和 Android 应用程序都可以是客户端，并通过单独的服务器中继通信。

# asp.net - Cannot load Report using Report Viewer Visual Studio 2008

> ID：10080959
> 
> 赞同：0
> 
> 时间：2012-04-09T23:02:25.907
> 
> 标签：asp.net, reporting-services

I am using VS 2008 and SQL 2008,.I am trying to build a report using Report viewer using Parameters.I am completly new to this concept,so i was trying to develop using the basic steps as shown in various tutrials.

1> connect to dataset

2- Configure server

3 - table Adapter

4 - Add new report

5 - Drag a table in the Report screen and add the columns

6 * Here i am adding parameters ( fromdate,todate).Please tell me what mistake i am doing

I got to Reports -> ReportParamaters -> Add new Parameter - > fromdate -> type : Datetime. (Same for Todate)

7 - > In the web page. Added 2 textboxes and a button

8 - > Dragged Reportviewer - > choose Datasoure and Report name

Now the code Behind.

On button click

```
Protected Sub btnView_Click(ByVal sender As Object, ByVal e As EventArgs) Handles btnView.Click
        Try
            setReportParameters()
            Me.ReportViewer1.LocalReport.Refresh()
        Catch ex As Exception

        End Try
    End Sub

 Private Sub setReportParameters()
        Dim Fromdate As New ReportParameter("Fromdate", tbFromDate.Text)
        Dim Todate As New ReportParameter("Todate", tbtodate.Text)

        Me.ReportViewer1.LocalReport.SetParameters(New ReportParameter() {Fromdate, Todate})

    End Sub 
```

When i Run the Report I get this Following Error

"

```
An error occurred during local report processing.
    Error during processing of ‘FromDate’ report parameter. 
```

All i can see is the textboxes and Button.When i click on it,nothing happens...

Please help

"

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T12:58:26.717

还有几件事要检查。

1.  验证报告中的参数是否为 DateTime 数据类型。

2.  您可能还需要格式化日期。我过去成功地使用过它：

    `ReportParameter startAtParam = new ReportParameter("StartAt", startAt.ToString("MMM, dd yyyy"));`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T23:33:58.523

我看到两件事要检查：

1.）您使用参数“Fromdate”设置参数“fromdate”，我相信这是区分大小写的。

2.) 报告中的 Fromdate 是一个日期时间，您正在传递一个字符串 (tbFromDate.Text) 确保这是一个有效的日期。

```
 Dim Fromdate As New ReportParameter("Fromdate", cDate(tbFromDate.Text)) 
```

# c - 不同源文件中的共享变量

> ID：10080960
> 
> 赞同：0
> 
> 时间：2012-04-09T23:02:31.330
> 
> 标签：c, global, extern

我开始学习 openGL，也第一次开始将我的项目拆分为多个源文件。因此，我仍然有点困惑，有时我觉得我的变量分散在各处，尤其是因为 openGL 需要大量使用全局变量。目前我收到了大约 15 个文件。

我的主要问题是某些变量例如由某些模块共享，而其他一些变量仅由其中一些模块和其他一些模块共享。如果我将所有这些变量放在一个 common.h 文件中，是否会出现任何问题（性能方面），因为并非所有变量都将被所有模块使用？

使用上述方法我也有一个问题，如果我使用其他头文件中定义的类型，我也必须包含这些。我也可以使用 '#if (defined' 宏，但这似乎不是最合适的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T23:34:53.907

包括`extern`未使用变量的声明不应导致性能问题（绝对不会在运行时，但它会在编译时引入难以察觉的小开销）。

但是，它会导致您的代码难以维护。最佳实践是根据用途或目的将全局范围的变量和函数组织到标头中。概念上相关的东西放在同一个标​​题中，不相关的东西放在不同的标题中。这样可以更轻松地包含您需要的功能，而不会引入大量您不需要的垃圾。

我不认为您需要包含标头才能引入数据类型定义是一个问题。这只是 C 语言工作原理的一部分。通过确保所有标题都是自给自足的，您可以让自己更轻松。也就是说，如果标头使用特定数据类型，则该标头应包括定义该类型的标头。这样，您的 .c 文件就不必担心分析标头并确定需要包含哪些*其他标头。*不自给自足的标头也可能导致代码构建不同（或根本不构建）的问题，具体取决于包含标头的顺序。

# ruby - 在哪里下载 Ruby MRI 作为 zip 而不是安装程序？

> ID：10080973
> 
> 赞同：0
> 
> 时间：2012-04-09T23:04:09.480
> 
> 标签：ruby

哪里可以下载 Ruby 的 MRI 版本作为 zip 文件而不是安装程序？我可能忽略了它，但我在[下载页面](http://www.ruby-lang.org/en/downloads/)上没有看到这样的东西。

这适用于 Windows XP。我忘了具体说明。寻找独立的二进制文件（认为那部分很明显）。很抱歉有遗漏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T14:21:21.323

[http://rubyinstaller.org/downloads/](http://rubyinstaller.org/downloads/)

在下面`7-zip archives`

您将需要存档管理器来提取文件。

Ruby 可执行文件位于`\bin\`. 您可能需要先提取它，然后将提取的位置添加到您的系统环境变量中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T14:00:54.457

嗯，我找到了答案。RubyInstaller.org 的下载页面有[独立的档案](http://rubyinstaller.org/downloads/)。

# c++ - 在 Linux 上使用 gcc 4.6 和 4.7 运行简单的 std::thread 代码时的核心转储

> ID：10080979
> 
> 赞同：3
> 
> 时间：2012-04-09T23:04:33.583
> 
> 标签：c++, multithreading

我不知道我的简单 std::thread 代码有什么问题（如下所列）。在 Ubuntu 上使用 gcc 4.6 或最新的 4.7 时总是崩溃。我用 command`g++ -std=c++11 myfile.cpp`和`g++ -std=gnu++11 myfile.cpp`.

```
#include <iostream>
#include <thread>

using namespace std;

void func() {
    cout << "hello\n";
}

int main()
{
    std::thread thrd(func);

    thrd.join();
} 
```

核心转储的调用堆栈如下所示

```
 #0  0x00007ffff7539445 in raise () from /lib/x86_64-linux-gnu/libc.so.6
    #1  0x00007ffff753cbab in abort () from /lib/x86_64-linux-gnu/libc.so.6
    #2  0x00007ffff7b35b0d in __gnu_cxx::__verbose_terminate_handler() () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
    #3  0x00007ffff7b33c16 in ?? () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
    #4  0x00007ffff7b33c43 in std::terminate() () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
    #5  0x00007ffff7b33e6e in __cxa_throw () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
    #6  0x00007ffff7b8829c in std::__throw_system_error(int) () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
    #7  0x00007ffff7b89132 in std::thread::_M_start_thread(std::shared_ptr<std::thread::_Impl_base>) ()
       from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
    #8  0x000000000040118e in std::thread::thread<void (&)()> (this=0x7fffffffdeb0, __f=
        @0x400e2c: {void (void)} 0x400e2c <func()>) at /usr/include/c++/4.7/thread:133
    #9  0x0000000000400e5b in main () at main2.cpp:13 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-10T09:16:32.097

您必须使用该`-pthread`选项进行编译。

```
g++ -std=c++11 -pthread -o main main.cpp 
```

# php - PHP mail() 函数已停止工作

> ID：10080981
> 
> 赞同：3
> 
> 时间：2012-04-09T23:04:36.993
> 
> 标签：php, email, sendmail, mailer

我一直在使用 MAMP 解决方案堆栈 (v2.0.5) 开发一个 Web 应用程序，其中包括：

*   Mac OS X (v10.7.3)
*   阿帕奇 v2.2.21
*   MySQL v5.5.9
*   PHP v5.3.6

我一直在使用 PHP`mail()`函数向新注册的用户帐户发送激活 URL：

```
$body = "Thank you for registering. To active your account, please click on this link:\n\n";
$body .= BASE_URL . 'activate.php?x=' . urlencode($e) . "&y=$a" . "&z=$bs";
mail($trimmed['email'], 'Registration Confirmation', $body, 'From: admin@tester.com'); 
```

但是，似乎过了一段时间......这才停止，现在我无法将这些消息中的任何一条发送到我的测试用户帐户。

我的`php.ini`文件位于：/Applications/MAMP/bin/php/php5.3.6/conf/php.ini

使用默认设置：

```
[mail function]
; For Win32 only.
SMTP = localhost
smtp_port = 25

; For Win32 only.
;sendmail_from = me@example.com

; For Unix only.  You may supply arguments as well (default: "sendmail -t -i").
;sendmail_path = 
```

它曾经完美地工作到最近，但现在已经失败了。我没有故意更改任何我知道的可能导致此停止的设置。

经过大量的谷歌搜索和阅读之后，您似乎必须设置您的 SMTP 服务器，以便将电子邮件从您的本地主机发送到另一个电子邮件地址才能正常工作，但我非常肯定它确实可以正常工作，我收到了电子邮件。 .. 诚实地！

我希望有人能帮帮忙。非常感谢。

**更新解决：** 基本上对它进行了排序。开始尝试使用 PEAR 和 Mail 插件，但发现它太可怕了。最终使用外部 SMTP 服务器和 PHPMailer，好多了。

有用信息： [http ://www.askapache.com/php/phpfreaks-eric-rosebrocks-phpmailer-tutorial.html](http://www.askapache.com/php/phpfreaks-eric-rosebrocks-phpmailer-tutorial.html) [https://orangsetya.wordpress.com/2007/09/12/send-mail-using-smtp-身份验证-phpmailer-脚本](https://orangsetya.wordpress.com/2007/09/12/send-mail-using-smtp-authentication-phpmailer-script)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T23:11:44.040

使用 mail 命令创建一个新脚本并将值硬编码为字符串，以查看您是否正在接收电子邮件。还要检查您的操作系统的任何更新是否对您的 apache/php 安装进行了任何修改。

尝试这样一个简单的脚本：

```
<?php
    mail('youremail@example.com', 'My Subject', 'My Message');
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T10:37:33.077

基本上整理好了。开始尝试使用 PEAR 和 Mail 插件，但发现它太可怕了。最终使用外部 SMTP 服务器和 PHPMailer，好多了。

有用信息：[http](http://www.askapache.com/php/phpfreaks-eric-rosebrocks-phpmailer-tutorial.html) ://www.askapache.com/php/phpfreaks-eric-rosebrocks-phpmailer-tutorial.html https://orangsetya.wordpress.com/2007/09/12/send-mail-using-smtp-身份验证-phpmailer-脚本

干杯。

# php - SaveAll 不保存关联的 hasOne 数据

> ID：10080983
> 
> 赞同：1
> 
> 时间：2012-04-09T23:04:39.460
> 
> 标签：php, cakephp

在这家呆了几个小时，无法弄清楚为什么会发生这种情况，感谢任何帮助......

我有两个模型 - 图片和链接。

图片`hasOne`链接

链接`belongsTo`图片

我将以下格式的数据放入一个名为`$images`

```
Array
(
    Array
    (
        [Image] => Array
            (
                [timestamp] => ...
                [full] => ...
            )

        [Link] => Array
            (
                [loc] => ...
                [lastmod] => ...
            )

    )
    ...
) 
```

然后打电话`$this->Image->saveAll($images, array('deep'=>true));`

这会保存 Image 模型，但不会保存 Link 模型。

在 Image 模型的 beforeSave 回调中，$this->data 中的数据被适当地传递。但是在 afterSave 回调中，Link 模型出现了——但是它的字段是空的。

链接数据没有数据保存到 MySQL，只有图像数据。

我错过了什么吗？通过文档一百万次:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T04:07:31.503

我觉得回答这个问题有点愚蠢，但是就这样吧。

`afterSave()`我在模型中使用了一些调试代码`Image`。

在打印出数据之后，我打电话给`exit()`.

我没有注意到，在保存之后`Image`，CakePHP 也不会访问`Link`数据中的模型来保存它。

0_0

# html - 得到 's 彼此对齐

> ID：10080987
> 
> 赞同：1
> 
> 时间：2012-04-09T23:05:27.133
> 
> 标签：html, css

我有以下代码正在尝试正常工作：

```
<div id="newspost_bg">
                    <article>
                        <p>
                        <header><h3>The fast red fox!</h3></header>
                        This is where the article resides in the article tag. This is good for SEO optimization.
                        <footer>Read More..</footer>
                        </p>
                    </article>
                </div>
                <div id="newspost_bg">
                    hello
                </div>
                <div id="newspost_bg">
                    hello
                </div>
                <div id="advertisement">
                    <script type="text/javascript"><!--
google_ad_client = "ca-pub-2139701283631933";
/* testing site */
google_ad_slot = "4831288817";
google_ad_width = 120;
google_ad_height = 600;
//-->
</script>
                </div> 
```

这是随之而来的css：

```
#newspost_bg{
    position: relative;
    background-color: #d9dde1;
    width:700px;
    height:250px;
    margin: 10px;
    margin-left: 20px;
    border: solid 10px #1d2631;
    float:left;
}

#newspost_bg article{
    position: relative;
    margin-left: 20px;
}
#advertisement{
    float: left;
    background-color: #d9dde1;
    width: 125px;
    height: 605px;
    margin: 10px;
} 
```

我遇到的问题是我试图设置的广告将与最后一个与 newspost_bg 的 id 对齐，但我希望它与它所在的容器的顶部对齐。我不知道这是否足够信息，如果没有，请告诉我您可能需要什么。我是网络编码领域的新手，所以任何和所有的批评都对我有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T23:12:11.293

我立即看到的第一个问题是您将相同的 ID 分配给多个元素。您只能为每个元素分配一个唯一 ID。你想要的可能是类，它在 CSS 中是这样访问的：

```
.classname {
    /*styling rules*/
} 
```

接下来，页面将按照文章在 HTML 中的顺序显示文章。这意味着您不能（明智地）使用 CSS 使 HTML 中的最后一篇文章成为列表中的第一篇。您可以使用 javascript 对它们进行重新排序，但这并不容易。看起来您要创建的是需要服务器端功能的网页，否则您将不得不在旧文章之前手动编写每篇文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T23:12:25.447

您正在尝试将三个 div 宽度 700px 配置为彼此相邻对齐。除非屏幕真的很大，否则这是极其复杂的。

除此之外，您使用的是相同的 id，这在语义上是不正确的。改为给出类名。

然后将你的css修改成这样

```
.newspost_bg{
    position: relative;
    background-color: #d9dde1;
    width:700px;
    height:250px;
    margin: 10px;
    margin-left: 20px;
    border: solid 10px #1d2631;
    float:left;
}

.newspost_bg article{
    position: relative;
    margin-left: 20px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T01:09:37.113

这里有几个问题：

首先，你有一个div，里面有一篇文章，据我所知，这不是必需的，因为文章可以代替div。然后，即使在较旧的规范中，您也`p`可以保存`header`, 文章正文和`footer, when` p `s should never have header elements (`h1`, h3`等），这打破了使用`article`标签的想法。

其次，如前所述，您有三个 div 都具有相同的 id。

第三，您对主 div 使用相对定位，我认为这对浮动没有帮助（也许我错了），而相对定位实际上只对绝对定位的子元素有帮助。

说了最后一点，我可能是错的，因为以下内容对我有用：

### HTML：

```
<section id="articles">
    <article class="newspost_bg">
        <header><h3>The fast red fox!</h3></header>
            <p>This is where the article resides in the article tag. This is good for SEO optimization.</p>
        <footer>Read More..</footer>
    </article>
    <article class="newspost_bg">
        hello
    </article>
    <article class="newspost_bg">
    hello
    </article>
</section>
<aside id="advertisement">
    <script type="text/javascript"><!--
    google_ad_client = "ca-pub-2139701283631933";
    /* testing site */
    google_ad_slot = "4831288817";
    google_ad_width = 120;
    google_ad_height = 600;
    //-->
    </script>
</aside> 
```

请注意，我使用一个`section`元素来包装`article`元素并使用`aside`广告块。您可以将 div 放入其中以用于进一步的目的，但上面是一个轻量级、实用程序包装免费文档，我认为这是在添加更多 div 等之前开始的好地方。

### CSS：

```
#articles {
 position: absolute;   
}
#articles > article {
    background-color: #d9dde1;
    width:300px;
    height:250px;
    margin: 10px;
    margin-left: 20px;
    margin-right: -140px;
    border: solid 10px #1d2631;
}

#advertisement {
    float: right;
    background-color: #d9dde1;
    width: 125px;
    height: 605px;
    margin: 10px;
    border: 1px dashed black;
}​ 
```

请注意，该部分作为文章元素的包装器被设置为绝对，并且没有为文章设置其他定位、浮动或负边距。aside 设置为向右浮动，这使它浮动到它的父级（在这种情况下，我们假设 body 或 html 标记）也是该部分的父级的顶部，因此它们是并排的。

我承认我不清楚为什么必须将部分（或 div 或其他）设置为绝对值才能使浮动实际将其他部分推到一边，但我相信这里的其他人可以解决这个问题。

# c++ - 内联汇编性能优于 C

> ID：10080997
> 
> 赞同：4
> 
> 时间：2012-04-09T23:05:58.133
> 
> 标签：c++, c, assembly

首先，请原谅我，因为我的问题可能看起来很愚蠢，但我真的很好奇为什么我在这个非常简单的代码中获得了性能提升。

这是汇编代码：

```
__asm {
    mov eax, 0
    mov ecx, 0
    jmp startloop
    notequal:
    inc eax
    mov ecx, eax
    sub ecx, 2
    startloop:
    cmp eax, 2000000000
    jne notequal
}; 
```

这是C代码：

```
long x = 0;
long ii = 0;
for(; ii < 2000000000; ++ii)
{
    x = ii - 2;
}; 
```

在我的 i5 2500k 机器上完成 C 代码大约需要 1060 毫秒（在发布版本中），并且组装在 780 毫秒内完成。速度提高了约 25%。我不明白为什么我会得到这个结果，因为 25% 是一个很大的差异。编译器是否不够聪明，无法生成我编写的相同的汇编代码？

顺便说一句，我正在使用 MSVC 2010。

谢谢

* * *

这是由 MSVC 生成的 (asm) 代码

```
$LL3@main:
; Line 36
    lea esi, DWORD PTR [eax-2]
    inc eax
    cmp eax, 2000000000             ; 77359400H
    jl  SHORT $LL3@main 
```

在这种情况下，lea 指令会做什么？

更新 2

* * *

非常感谢大家。我刚刚在 Nehalem xeon cpu 上测试了这段代码，结果在这里是相同的。看起来不知什么原因，asm 代码在 Sandy 桥上运行得更快。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T23:27:20.880

@modelnine 的评论是正确的 -`lea`用于简化循环中的分配。你有：

```
x = ii - 2; 
```

并且`lea`（加载有效地址）指令正在有效地执行：

```
esi = &(*(eax - 2)); 
```

`&`和`*`相互抵消（这很重要 - 在这种情况下取​​消引用可能`eax`会导致问题），所以你得到：

```
esi = eax - 2; 
```

正是您的 C 代码尝试执行的操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T23:57:27.560

我比较了非asm版本：

```
#include <iostream>
#include <chrono>

int main() {
    auto start = std::chrono::high_resolution_clock::now();

    long x = 0;
    long ii = 0;
    for(; ii < 2000000000; ++ii)
    {
        x = ii - 2;
    };

    auto finish = std::chrono::high_resolution_clock::now();
    std::cout << (finish-start).count() << '\n';
    std::cout << x << ii << '\n';
} 
```

使用 asm 版本：

```
#include <iostream>
#include <chrono>

int main() {
    auto start = std::chrono::high_resolution_clock::now();

    asm (R"(
         mov $0, %eax
         mov $0, %ecx
         jmp startloop
         notequal:
         inc %eax
         mov %eax,%ecx
         sub $2,%ecx
         startloop:
         cmp $2000000000,%eax
         jne notequal
    )");

    auto finish = std::chrono::high_resolution_clock::now();
    std::cout << (finish-start).count() << '\n';
} 
```

使用铿锵声3.1

启用优化后，asm 版本大约需要 1.4 秒，而非 asm 版本需要 45 纳秒。这使得汇编版本慢了大约 3200 万%。

这是为非 asm 版本生成的程序集：

```
movl    $1999999997, %esi       ## imm = 0x773593FD
callq   __ZNSt3__113basic_ostreamIcNS_11char_traitsIcEEElsEl
movq    %rax, %rdi
movl    $2000000000, %esi       ## imm = 0x77359400
callq   __ZNSt3__113basic_ostreamIcNS_11char_traitsIcEEElsEl 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T23:57:03.333

你为什么不尝试`gcc -Ofast`或者也许`gcc -O1`

这是一个预告片：`gcc -Q -Ofast --help=optimizers`，就在 gnu 手册中！

这是一个比较：

```
section .text
global _start

_start:
    mov eax, 0
    mov ecx, 0
    jmp startloop
    notequal:
    inc eax
    mov ecx, eax
    sub ecx, 2
    startloop:
    cmp eax, 2000000000
    jne notequal

    int     0x80

    mov     ebx,0
    mov     eax,1
    int     0x80 
```

我得到了`1.306ms`它，并且 C 被定时为：

```
real    0m0.001s
user    0m0.000s
sys     0m0.000s 
```

使用`gcc -O1`定时是：

```
real    0m1.295s
user    0m1.262s
sys     0m0.006s 
```

它实际上执行代码。

对于 MSVC，使用 /O2 或 /O1 编译选项应该能够获得类似的结果。详细信息在这里[http://msdn.microsoft.com/en-us/library/k1ack8f1.aspx](http://msdn.microsoft.com/en-us/library/k1ack8f1.aspx)

# c# - 创建自动生成的复选框网格的简单方法？

> ID：10080998
> 
> 赞同：1
> 
> 时间：2012-04-09T23:06:07.950
> 
> 标签：c#, wpf, checkbox

当然是文字网格；`Grid`不是我的意思。是否有一个预先存在的控件允许我显示复选框/可切换事物的网格，以便每一行对应一个对象，每一列对应对象的一个​​属性？`DataGrid`我正在寻找比仅使用或`PropertyGrid`显示布尔“真”和“假”值更优雅/美观/合身的东西。（有点像矮人治疗师。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T23:22:34.143

Windows.Forms 命名空间中有一个[Checked Listbox](http://msdn.microsoft.com/en-us/library/system.windows.forms.checkedlistbox.aspx "MSDN 上的选中列表框")，您可能想要检查[WPF 替代品](http://www.codeproject.com/Articles/21074/A-WPF-Problem-Solved-Two-Very-Different-Ways-Using%20%22WPF%20Checked%20Listbox)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T01:39:06.240

你看过 DataGridCheckBoxColumn 吗？

[http://msdn.microsoft.com/en-us/library/system.windows.controls.datagridcheckboxcolumn.aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagridcheckboxcolumn.aspx)