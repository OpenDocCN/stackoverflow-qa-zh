# StackOverflow 问答 000915000-000915999

# string - 检查字符串以查看字符串数组中的字符串是否出现在其中

> ID：915002
> 
> 赞同：0
> 
> 时间：2009-05-27T10:26:00.443
> 
> 标签：string, generics, list, .net-2.0

我有一个通用的字符串列表： List listOfString = new List();

然后我将 4 个字符串添加到此列表中：

```
 listOfString .Add("test1");
        listOfString .Add("test2");
        listOfString .Add("test3");
        listOfString .Add("test4"); 
```

我想检查一个字符串变量是否包含我的字符串数组中的任何元素。

我已经看到描述的“任何”方法，但这不能在 C# 中编译，我只能在 for 循环中执行此操作吗？

谢谢，。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T10:36:55.650

我认为问题更多是关于测试字符串是否包含数组的任何元素。

在伪代码中应该看起来像这样（我对.Net不太熟悉）

```
function StringContainsAny(String toTest, List<String> tests)
{
    foreach( String test in tests )
    {
        if( toTest.Contains(test) )
        {
            return test;
        }
    }
    return null;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T11:06:49.270

如果您使用 LINQ 方法扩展 (.net 3.5)，则可以使用 Any 函数。像这样：

```
var foobar = "foobar";
new[] {"foo", "bar"}.Any(foobar.Contains); 
```

但是如果你解散 Any 你会发现它只是一个循环。

公共静态博

```
public static bool Any<TSource>(this IEnumerable<TSource> source, Func<TSource, bool> predicate)
{
    if (source == null)
    {
        throw Error.ArgumentNull("source");
    }
    if (predicate == null)
    {
        throw Error.ArgumentNull("predicate");
    }
    foreach (TSource local in source)
    {
        if (predicate(local))
        {
            return true;
        }
    }
    return false;
} 
```

因此，如果您不想使用 .net 3.5，.Net 2.0 中的上述函数将如下所示：

```
public static class Utilities
{
    public delegate bool AnyPredicate<T>(T arg);
    public static bool Any<TSource>(IEnumerable<TSource> source, AnyPredicate<TSource> predicate)
    {
        if (source == null)
        {
            throw new ArgumentException("source");
        }
        if (predicate == null)
        {
            throw new ArgumentException("predicate");
        }
        foreach (TSource local in source)
        {
            if (predicate(local))
            {
                return true;
            }
        }
        return false;
    }
} 
```

用法：

```
 var foobarlist = new[]{"foo", "bar"};
    var foobar = "foobar";
    var containsfoobar = Utilities.Any(foobarlist, foobar.Contains); 
```

我希望这会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T10:46:49.560

如果我正确理解你的问题，你需要这个：

```
 public static bool ContainsAnyElement(IList<string> l, string input)
    {
        foreach (var s in l)
        {
            if (l.Contains(s))
                return true;
        }
        return false;
    }

    // Usage

    IList<string> l = new List<string>() { "a", "b", "c" };

    string test = "my test string with aa bbb and cccc";

    Console.WriteLine(ContainsAnyElement(l, test)); 
```

# c# - 将 C# 的“使用”语句与自定义对象的函数一起使用，我是否需要实现 IDisposable？

> ID：915022
> 
> 赞同：8
> 
> 时间：2009-05-27T10:31:21.010
> 
> 标签：c#, idisposable, sqlconnection

我有一个这样的 sqlConnection 管理器类：

```
public class SQLConn {
  public string connStr = System.Configuration.ConfigurationSettings.AppSettings["ConnectionString"];

  private SqlConnection sqlConn;

  public SqlConnection Connection()
  {
      sqlConn = new SqlConnection(connStr);

      return sqlConn;
  }

  public void Open()
  {
        sqlConn .Open();
  }
} 
```

如果我使用带有“使用”语句的函数，例如：

```
var conn = new SQLConn();

using (conn.Connection()) 
{ 
    String query = "Select * from table";
    objSql = new SqlCommand(query, conn.Connection());      

    conn.Open(); 
    DoSomething(); 
} 
```

using 语句是否会自动处理连接，因为`conn.Connection()`返回一个 SqlConnection 对象？或者，我是否必须在 SqlConn 类上实现 IDisposable 和自定义 Dispose 方法？

这甚至是一个好方法吗？我正在使用遗留代码，我还不能使用 ORM，但是有没有办法简化这个现有的模式来管理/创建 SQL 连接？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-27T10:33:10.603

该`using`语句将查看表达式的最终类型——即从`.Connection()`;返回的任何内容。如果这返回的东西是`IDisposable`，那么你就可以了。

如果你弄错了，编译器会告诉你；-p（它不会让你用`using`在不是的东西上`IDisposable`）。

您可能应该注意创建*两个*连接的位置：

```
using (var c = conn.Connection()) // <==edit
{ 
    String query = "Select * from table";
    objSql = new SqlCommand(query, c); // <==edit

    c.Open(); 
    DoSomething(); 
} 
```

并且可能：

```
public SqlConnection Connection()
{
  if(sqlConn == null) sqlConn = new SqlConnection(connStr); // <== edit
  return sqlConn;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-27T10:36:46.600

它会起作用，但之后`using {}`你会留下一个内部持有一个 Disposed SqlConnection 的 sqlConn。不是一个真正有用的情况

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T10:37:45.460

你的代码错了！

应该是这样的：

```
Dim conn as New SQLConn();
Dim sqlConnection New SQLConnection();

sqlConnection = conn.Connection();

using (sqlConnection) 
{ 
    String query = "Select * from table";
    objSql = new SqlCommand(query, sqlConnection);      

    conn.Open(); 
    DoSomething(); 
} 
```

这样， using 语句将在最后处理连接。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T10:58:45.993

要回答您的标题问题，您必须在使用“using”的对象的类中实现 IDisposable。否则，您将收到编译时错误。

然后，是的，“使用”将在块的末尾处理您的 SqlConnection 。将“使用”视为“最终尝试”：在“最终”块中有对 Dispose() 的隐式调用。

最后，更简洁的代码将是：

```
using( SqlConnection = new SqlConnection( connStr ) {
    // do something
} 
```

正如 Henk Holterman 指出的，您的 SQLConn 对象拥有对已处置连接的引用，至少您的代码的读者不必费力地意识到这一点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-02-27T20:16:47.757

为了澄清上面所说的：

您需要与 using 一起使用的任何对象都应在 using 语句的末尾进行处理。因此，编译器需要确保您的类型在看到使用该类型对象时实现 IDisposable 接口，否则它不会让您离开。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T10:32:17.297

不，你不需要，只要返回的对象是 IDisposable。

返回的对象不需要实现 IDisposable，但是 using 块将毫无用处。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T10:34:48.790

来自[MSDN](http://msdn.microsoft.com/en-us/library/yh598w02(VS.80).aspx)：

> 提供给 using 语句的对象必须实现 IDisposable 接口。

但是，您不必调用 Dispose()，using 语句隐含地为您执行此操作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-27T10:39:45.143

似乎连接会正确关闭，但不建议这样做：

> 您可以实例化资源对象，然后将变量传递给 using 语句，但这不是最佳实践。在这种情况下，对象在控制离开 using 块后仍保留在范围内，即使它可能不再有权访问其非托管资源。换句话说，它将不再被完全初始化。如果您尝试在 using 块之外使用该对象，则可能会引发异常。出于这个原因，通常最好在 using 语句中实例化对象并将其范围限制在 using 块中。

[http://msdn.microsoft.com/en-us/library/yh598w02.aspx](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)

# mysql - MySQl 查询执行计划

> ID：915023
> 
> 赞同：2
> 
> 时间：2009-05-27T10:31:31.183
> 
> 标签：mysql

MySQL 优化器是否根据 WHERE 条件更改执行计划？如果我在 WHERE 条件中添加一列进行比较，是否会影响查询执行计划？

谢谢， 苏尼尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T10:36:17.087

用来`EXPLAIN <your query>`告诉你系统会做什么。然而，添加一个额外的列肯定会改变它的解释方式。

`EXPLAIN`MySQL 文档中有一个关于使用的页面：http: [//dev.mysql.com/doc/refman/5.0/en/using-explain.html](http://dev.mysql.com/doc/refman/5.0/en/using-explain.html)

# c# - 字符串数组到记事本

> ID：915024
> 
> 赞同：0
> 
> 时间：2009-05-27T10:31:48.640
> 
> 标签：c#

我在 C# 中有一个字符串数组，我打算将它复制到记事本中，以便每一行都位于一行中。我该怎么办？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T10:37:11.123

您可以创建一个字符串，其中每个元素位于单独的行上，如下所示：

```
string[] array = { "a", "b", "c" };
string lines = string.Join(Environment.NewLine, array); 
```

然后您可以使用 Clipboard 类将字符串复制到剪贴板。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T10:34:44.763

您可以使用 System.Windows.Forms.Clipboard.SetText 方法在剪贴板上存储文本。然后它将可用于其他应用程序，例如记事本，可以粘贴进去。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T10:34:46.323

也许是这样的？（取决于你的意思复制到记事本）

```
string output = "";

foreach(string s in yourArray)
{
output += s + "\n";
} 
```

（将这与符文所说的结合起来，根据评级高于......或低于）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T10:36:40.627

看一眼

*   **[读写文本文件](http://www.csharp-station.com/HowTo/ReadWriteTextFile.aspx)**

如果我理解正确，您只想写入文本文件。

1.  您需要遍历字符串数组，然后将字符串数组中每个索引的内容写入文件中的新行。

2.  完成后不要忘记妥善处理作家。

如果您需要更多信息，请告诉我，我会发布一个示例，但我认为值得先试一试，看看您的进展如何:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T10:40:21.883

```
string filepath = "some_path_in_here";
string filename = "test.txt";
StreamWriter sw = new StreamWriter(fileName, false);

for(int i = 0; i < strings_array.Count; i++)
{
sw.Write(strings_array[i]);
sw.Write(sw.NewLine);
} 
```

试试这个，但你最好读一些书，做这样简单的事情。不要指望别人给你确切的解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T11:47:35.460

您可以使用 StringBuilder 将字符串彼此连接（如果您只想将每一行放在一个新行中）：

```
StringBuilder sb=new StringBuilder();
foreach(string line in lines)
{
sb.AppendLine(line);
}

return sb.ToString(); 
```

由于 string 是一个不可变对象（如果它已更改，将创建一个新实例），因此不建议执行以下操作：

```
line=line+"\n\r"; 
```

# javascript - 使用 Visual Studio 和智能感知注册扩展 EJS？

> ID：915034
> 
> 赞同：15
> 
> 时间：2009-05-27T10:33:32.223
> 
> 标签：javascript, visual-studio-2008, templates, ide

有谁知道我如何将 EJS 映射到 Visual Studio 以像 HTML 文件一样工作。我想我设法做到了，但它有很多膨胀。它基本上是一个没有 HTML 和 BODY 标签的 HTML 文件。所以我选择了 VS 2008 中的 UserControl、工具、选项、文本编辑器、文件扩展名和添加了 EJS 并将其添加为用户控件。

如果我选择 html，那么它不会提供智能感知，直到它检测到 HTML 和 BODY ..

我的问题真的是我可以添加到这个列表中吗？并创建我自己的？它需要为 html 和 javascript 提供智能感知，仅此而已。

我也可以创建某种代码来在另一台电脑上自动安装 EJS 吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-11-10T18:21:49.687

在这一点上，它的价值是什么……

上述解决方案仍然有效。然而，一个更简单的解决方案（我只在 VS 2013 中测试过）是右键单击任何给定的 *.ejs 文件，然后选择“打开方式”。在打开的对话框中，选择“HTML (Web Forms) Editor”并将其选为默认值。

现在，当您打开 EJS 文件时，您将获得 HTML 的语法突出显示和智能感知。这不会为您提供对 EJS 代码片段的支持。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-08-21T18:17:51.160

我也在寻找这个问题的答案。这是我发现的...

> [源](http://www.nsilverbullet.net/2008/10/30/AddIntellisenseForAnyFileExtensionInVisualStudio2005Or2008.aspx)- Visual Studio 2008
> 
> 显然 Visual Studio 不支持 .blogtemplate 扩展。有一段时间，我通过在编辑时将文件重命名为具有 html 扩展名来绕过它，这很有效。主要问题是我一直忘记在开始测试我的更改之前将扩展名改回来 - 所以这造成了不必要的痛苦......我之前对配置类似的东西有一个模糊的记忆，并找到了这些说明。为了完整起见，我也将它们包括在这里：
> 
> 1.  转到“工具”->“选项”菜单。
> 2.  从选项对话框左侧的树中选择文本编辑器 -> 文件扩展名。
> 3.  在“扩展名”文本框中键入您的文件扩展名，在我的例子中是 .blogtemplate。
> 4.  从编辑器下拉列表中选择适当的编辑器。
> 5.  单击添加，然后单击确定关闭对话框并重新打开文件。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-29T21:14:13.430

这需要创建自定义智能感知和验证模式。以下是有关如何执行此操作的步骤。

*   **创建 HTML 智能感知架构文件：**转到`common7\packages\schemas\html`Visual Studio 安装目录。在我的机器上是：`C:\Program Files\Microsoft Visual Studio 9.0\Common7\Packages\schemas\html`
*   复制文件`html_401.xsd`并命名`EJS.xsd`
*   在 Visual Studio 或任何其他 XML 编辑器中打开刚刚命名为 EJS.xsd 的文件
*   对文件顶部进行以下更改：
    *   将出现的 2 次文本替换`html-401`为`EJS`
    *   更改`vs:ishtmlschema`为`"false"`
    *   更改`vs:SuccinctFriendlyName`为`"EJS"`
*   **为这个新架构添加注册表条目**- 您可以直接编辑注册表或创建`*.reg`文本文件。如果您选择后者，请命名文件`EJS.reg`并将其添加到其中：

Windows 注册表编辑器版本 5.00

```
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\9.0\Packages\{1B437D20-F8FE-11D2-A6AE-00104BCC7269}\Schemas\Schema23]
"File"="html\\ejs.xsd"
"URI"="http://schemas.microsoft.com/intellisense/EJS"
"Friendly Name"="EJS" 
```

**Visual Studio 2008**附带 22 个模式，这就是为什么您将其命名为“schema23”的原因，如果您安装了第 3 方模式编辑器，则该名称可能已经存在（如果您想确定，请检查该注册表项）。

完成后，重新启动 Visual Studio。将`*.ejs`扩展与“HTML 编辑器”而不是“用户控件编辑器”相关联。现在，当您打开或创建具有 *.ejs 扩展名的文件时，您应该会在“HTML 源代码编辑”工具栏中看到“用于验证的目标架构”下拉菜单。（如果您没有看到该工具栏，请转到 View->Toolbars->HTML Source Editing）。

您会注意到，您可以开始使用 HTML 标记，而不必从`<html>`第一个标记开始。Intellisense 也适用于`<script>`标签内的 javascript。

这不是一个完整的解决方案，但它将朝着实现最终目标的正确方向发展。您仍然需要返回并调整`EJS.xsd`文件并进行更多修改以完全按照您的意愿行事。

整理好之后，您可以创建一个简单的脚本来复制 EJS.xsd 文件并在另一台机器上创建注册表项。

*（**小字：**在弄乱它之前总是备份你的注册表）*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-26T01:22:02.950

我一直遇到**ejs extesion**的问题。我这样解决了：
- 打开菜单，*工具 >> 选项*
- 在左侧，展开选项*文本编辑器*并选择*文件扩展*
名 - 在扩展文本框中，键入 ejs *-*
在*编辑器*组合框中，选择*HTML 编辑器*
- 单击*添加*然后*确定*
- 重新打开您的文件

# excel-2003 - 是否可以在 Excel 的公式中设置行高？

> ID：915035
> 
> 赞同：1
> 
> 时间：2009-05-27T10:33:34.283
> 
> 标签：excel-2003, excel-formula

是否可以在 Excel 的公式中设置行高？

对于 Microsoft Office 2003。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T10:38:24.087

我不这么认为。您将需要使用 VBA。

有关示例，请参阅[RowHeight 属性用于获取高度](http://vbadud.blogspot.com/2007/07/excel-height-of-row-rowheight-using.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-09T15:50:48.133

您必须使用 VBA。您必须在 worksheet_change 事件中写入一些内容以读取特定单元格，然后根据条目更改高度。没有编码就没有办法做到这一点。

# java - 时间戳响应不正确 - BouncyCastle

> ID：915039
> 
> 赞同：3
> 
> 时间：2009-05-27T10:34:34.373
> 
> 标签：java, security, bouncycastle, trusted-timestamp, rfc3161

尝试通过使用 BouncyCastle 并连接到[http://timestamping.edelweb.fr/service/tsp](http://timestamping.edelweb.fr/service/tsp)来请求时间戳 (RFC 3161) 。我确实从服务器收到了 TimestampResponse，但它似乎没有实际日期。

这是代码：

```
public static void main(String[] args) {
    String ocspUrl = "http://timestamping.edelweb.fr/service/tsp";
    byte[] digest = "hello".getBytes();
    OutputStream out = null;

    try {
        TimeStampRequestGenerator reqgen = new TimeStampRequestGenerator();
        TimeStampRequest req = reqgen.generate(TSPAlgorithms.SHA1, digest);
        byte request[] = req.getEncoded();

        URL url = new URL(ocspUrl);
        HttpURLConnection con = (HttpURLConnection) url.openConnection();

        con.setDoOutput(true);
        con.setDoInput(true);
        con.setRequestMethod("POST");
        con.setRequestProperty("Content-type", "application/timestamp-query");

        con.setRequestProperty("Content-length", String.valueOf(request.length));
        out = con.getOutputStream();
        out.write(request);
        out.flush();

        if (con.getResponseCode() != HttpURLConnection.HTTP_OK) {
            throw new IOException("Received HTTP error: " + con.getResponseCode() + " - " + con.getResponseMessage());
        }
        InputStream in = con.getInputStream();
        TimeStampResp resp = TimeStampResp.getInstance(new ASN1InputStream(in).readObject());
        TimeStampResponse response = new TimeStampResponse(resp);
        response.validate(req);
        System.out.println(response.getTimeStampToken().getTimeStampInfo().getGenTime());
    } catch (IOException e) {
        e.printStackTrace();
    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

这是问题：有没有人使用 Bouncycastle 的时间戳库并碰巧知道不同的状态代码及其含义？或者只是一般来说为什么这似乎不起作用。

我希望看到日期的这一行只抛出一个 NullPointer：

```
System.out.println(response.getTimeStampToken().getTimeStampInfo().getGenTime()); 
```

有谁知道任何其他免费的符合 RFC 3161 的时间戳服务器？

如果您想运行代码，您需要可以从[这里](http://www.bouncycastle.org/latest_releases.html)下载的 bouncycastle jars 。您将需要：提供者、邮件、tsp。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-03-31T19:08:34.990

分析与wireshark的通信，这个例子给了我一个“坏消息摘要”错误。对我有用的摘要代码是：

```
 MessageDigest messageDigest = MessageDigest.getInstance("SHA-1");
    messageDigest.update("messageImprint".getBytes());
    byte[] digest = messageDigest.digest(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T14:28:47.070

问题似乎是内容的格式/长度错误。

```
TimeStampRequest req = reqgen.generate(TSPAlgorithms.SHA1, digest); 
```

但我发送的只是：

```
"hello".getBytes(); 
```

从 'hello' 创建一个正确的 SHA1Digest，这样就可以了。

```
static public byte[] calculateMessageDigest()
        throws NoSuchAlgorithmException, IOException {
    SHA1Digest md = new SHA1Digest();

    byte[] dataBytes = "helloooooooooooooo".getBytes();
    int nread = dataBytes.length;
    md.update(dataBytes, 0, nread);
    byte[] result = new byte[32];
    md.doFinal(result, 0);
    return result; 
```

我也最终使用[Digistamp](http://digistamp.com)作为我的 TSA，因为它们支持 http 身份验证，这是一个要求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T14:42:05.403

我发现[这个](http://security.polito.it/ts/)站点是一个很好的时间戳资源，它还有一个服务器列表，其中至少有一些似乎仍然可以运行。

# c# - Convert.ToInt32 与 TryParse

> ID：915056
> 
> 赞同：5
> 
> 时间：2009-05-27T10:37:17.910
> 
> 标签：c#, java, performance, exception, tryparse

我们都知道大量抛出的异常会对我们的应用程序的性能产生影响，因此，我们应该远离诸如使用异常进行控制流之类的事情。在此声明之后，我必须承认，在编码时我并不太关心这一点。我主要在 Java 平台上工作，但最近我在 .NET 平台上做，发现了这个方便的方法：`public static bool TryParse(string s,out int result)` ，它允许你将 String 转换为 int 而不会引发异常。从那一刻起，我一直在使用它。我只是想问你关于使用`public static bool TryParse(string s,out int result)`or的偏好`public static int ToInt32(string value)`。

从 Java 的角度来看，只是指出它缺少这样一个类似的方法，尽管我们可以通过以下方式获得它：

`boolean isInteger = Pattern.matches("^\d*$", myString);`

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T10:39:53.723

是的，Java 缺少一个类似的方法，尽管没有`out`参数它实际上很难表达（同时想要返回一个原语）。但是，通常，在 C# 中，`TryParse`如果您希望值有时不是整数，则应使用，`ToInt32`否则；这样，“异常”情况就被这样对待了。

特别是如果性能是您想要的主要原因`TryParse`，那么您发布的正则表达式匹配方法要差得多。异常的性能“开销”（实际上是非常小的）与错误地使用它们的程度相形见绌，这会模糊对控制流的简单理解。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T12:35:19.170

我不了解 C#，但在 Java 中，异常只有在实际抛出时才会昂贵，但它们确实非常昂贵。如果您预计大部分字符串无效，那么首先验证它们是值得的，即使您使用正则表达式也是如此。

但不要使用`String.matches()`或`Pattern.matches()`应用正则表达式；每次调用这些方法时，它们都会重新编译正则表达式。相反，提前编译正则表达式并将其保存为 Pattern 对象，然后使用它进行验证。`Integer.parseInt()`在我的测试中，解析 10,000 个字符串列表，其中 20% 无效，使用 Pattern 进行预验证几乎是单独使用并捕获异常的两倍。

但是，此讨论仅适用于您在紧密循环中进行大量转换的情况。如果你只是偶尔做一次，比如当你接受用户输入时，让`Integer.parseInt()`验证就可以了。而且，如果您确实选择使用正则表达式进行验证，那么您将需要一个比它更好的正则表达式`^\d*$`- 该正则表达式将匹配空字符串以及大于 的“数字” `Integer.MAX_VALUE`，并且它根本不会匹配负数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T11:03:40.353

为此，您可以在 Java 中使用众所周知的 StringUtils（在 commons-lang 上），此类有一个方法[isNumeric](http://commons.apache.org/lang/api/org/apache/commons/lang/StringUtils.html#isNumeric(java.lang.String))

也许你可以看看那些人为[那个函数](http://www.docjar.com/html/api/org/apache/commons/lang/StringUtils.java.html#5121)写的代码：

```
public static boolean isNumeric(String str) {
  if (str == null) {
    return false;
  }
  int sz = str.length();
  for (int i = 0; i < sz; i++) {
    if (Character.isDigit(str.charAt(i)) == false) {
      return false;
    }
  }
  return true;
 } 
```

我并不是说这是最有效的方法，但您还有另一种选择，无需使用正则表达式。祝你好运！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-11T15:03:16.783

> 从 Java 的角度来看，只是指出它缺少这样一个类似的方法，尽管我们可以通过以下方式获得它：
> 
> ```
> boolean isInteger = Pattern.matches("^\d*$", myString); 
> ```

要预测是否`Integer.parseInt(myString)`会抛出异常，还有更多工作要做。字符串可以以`-`. 此外，一个 int 的有效数字不能超过 10 个。所以更可靠的表达式是`^-?0*\d{1,10}$`. 但是即使这个表达式也不能预测每个异常，因为它仍然太不精确。

生成可靠的正则表达式是可能的。但这会很长。也可以实现一个精确确定 parseInt 是否会抛出异常的方法。它*可能*看起来像这样：

```
static boolean wouldParseIntThrowException(String s) {
    if (s == null || s.length() == 0) {
        return true;
    }

    char[] max = Integer.toString(Integer.MAX_VALUE).toCharArray();
    int i = 0, j = 0, len = s.length();
    boolean maybeOutOfBounds = true;

    if (s.charAt(0) == '-') {
        if (len == 1) {
            return true; // s == "-"
        }
        i = 1;
        max[max.length - 1]++; // 2147483647 -> 2147483648
    }
    while (i < len && s.charAt(i) == '0') {
        i++;
    }
    if (max.length < len - i) {
        return true; // too long / out of bounds
    } else if (len - i < max.length) {
        maybeOutOfBounds = false;
    }
    while (i < len) {
        char digit = s.charAt(i++);
        if (digit < '0' || '9' < digit) {
            return true;
        } else if (maybeOutOfBounds) {
            char maxdigit = max[j++];
            if (maxdigit < digit) {
                return true; // out of bounds
            } else if (digit < maxdigit) {
                maybeOutOfBounds = false;
            }
        }
    }
    return false;
} 
```

我不知道哪个版本更有效。这主要取决于上下文哪种检查是合理的。

在 C# 中要*检查*是否可以转换字符串，您将使用 TryParse。如果它返回 true，那么它作为副产品同时*被*转换。这是一个简洁的功能，我认为仅重新实现 parseInt 以返回 null 而不是抛出异常没有问题。

但是，如果您不想重新实现解析方法，那么手头有一组可以根据情况使用的方法仍然会很好。它们*可能*看起来像这样：

```
private static Pattern QUITE_ACCURATE_INT_PATTERN = Pattern.compile("^-?0*\\d{1,10}$");

static Integer tryParseIntegerWhichProbablyResultsInOverflow(String s) {
    Integer result = null;
    if (!wouldParseIntThrowException(s)) {
        try {
            result = Integer.parseInt(s);
        } catch (NumberFormatException ignored) {
            // never happens
        }
    }
    return result;
}

static Integer tryParseIntegerWhichIsMostLikelyNotEvenNumeric(String s) {
    Integer result = null;
    if (s != null && s.length() > 0 && QUITE_ACCURATE_INT_PATTERN.matcher(s).find()) {
        try {
            result = Integer.parseInt(s);
        } catch (NumberFormatException ignored) {
        // only happens if the number is too big
        }
    }
    return result;
}

static Integer tryParseInteger(String s) {
    Integer result = null;
    if (s != null && s.length() > 0) {
        try {
            result = Integer.parseInt(s);
        } catch (NumberFormatException ignored) {
        }
    }
    return result;
}

static Integer tryParseIntegerWithoutAnyChecks(String s) {
    try {
        return Integer.parseInt(s);
    } catch (NumberFormatException ignored) {
    }
    return null;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T16:48:40.703

> 我只是想问你关于使用 public static bool TryParse(string s,out int result) 或 public static int ToInt32(string value) 的偏好。

是的，我使用 TryParse，除非我希望该值*始终*有效。我发现它比使用异常更清晰。即使我想要异常，我通常也想自定义消息或抛出我自己的自定义异常；因此，我使用 TryParse 并手动抛出异常。

在 Java 和 C# 中，我尝试捕获尽可能*少*的异常集。在 Java 中，这意味着我必须分别捕获 NullPointerException 和 NumberFormatException 以响应 Number.ValueOf(...); 或者，我可以捕获“异常”并冒着捕获意外的风险。使用 C# 中的 TryParse，我完全不用担心。

# phpunit - 这段代码安全吗 - PHP && MySQL

> ID：915057
> 
> 赞同：0
> 
> 时间：2009-05-27T10:37:29.097
> 
> 标签：phpunit

```
<?php
class test_class {

        public function __construct() { 

        }
        public function doLogin($username,$password) {

            include("connection.php");

            $query = "SELECT *
                      FROM users
                      WHERE username = '".mysql_escape_string($username)."'
                      AND password = '".mysql_escape_string($password)."'";
            $result = mysql_fetch_array(mysql_query($query));
            if(!$result) {

            return 'no';
            }
            else 
                {
            return 'yes';
                }
            }

}
?> 
```

上面的代码有效，但有点担心它是否安全。

注意：我没有使用 POST 方法，所以我必须将它作为函数中的参数接收，我不能使用。

```
if (isset($_POST['username']) && isset($_POST['password']))
        {
        $username= $_POST['username'];
        $password= $_POST['password']; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T10:49:07.230

代码可能是安全的，但实现不是很好。***您永远不应将身份验证密码存储为明文。***你应该加盐和哈希。

我可以花一个小时解释原因，但你最好[只阅读这个](http://phpsec.org/articles/2005/password-hashing.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T10:49:11.957

查询本身看起来是安全的，但是如果您使用支持参数绑定的数据库接口，例如 PDO 或 Zend_Db，您就不必如此紧张地检查每条 SQL 语句。

此外，mysql-* 函数几乎已被弃用；您应该查看 mysqli-* 函数。

作为文体方面的说明，空构造函数没有意义，我建议返回布尔值 true 或 false 而不是字符串值。

最后，正如其他地方所提到的，存储明文密码是一个坏主意。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T10:47:13.897

呃....您正在存储明文密码？那肯定是不安全的。密码应使用 sha256 之类的盐进行哈希处理。存储明文密码从来都不是一个好主意。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T10:46:45.287

不，您不应该将原始密码存储在数据库中。将其存储为散列（最好用盐）。此外，准备好的语句是比转义更好的选择。请参阅此[PHP PDO 文档](http://us2.php.net/pdo.prepared-statements)。作为一个额外的好处（除了安全性），它们可以更有效率。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T10:50:54.840

代码本身看起来不错，但我看到的主要问题是您以纯文本形式传递密码。

客户端到服务器的连接是否安全（即使用 SSL） 服务器到数据库的连接是否安全

如果在任何一种情况下，有人可以坐在电线上观看路过的交通，那么你就有了安全问题。

如果是我，我肯定会在客户端和服务器之间建立 SSL 连接。

我会确保您将密码的哈希值存储在数据库中。

我会将您的代码更改为类似

```
//Pseduo Code
SELECT * FROM Table where UserName = $username
Get Row Back
if(MD5Hash($password) == DataRow[Password])
   //Valid 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-05-27T10:39:18.360

我认为可以，但是，如果我担心安全性，我会将“用户名”的密码存储到变量中并在查询之外进行比较。

# visual-studio-2008 - 一次在多个属性上使用“转换为自动属性”

> ID：915073
> 
> 赞同：5
> 
> 时间：2009-05-27T10:42:19.773
> 
> 标签：visual-studio-2008, c#-3.0, refactoring, resharper

我发现自己使用 Resharper 的“转换为自动属性”进行了很多重构，以删除 C# 3.0 之前的样板代码。

有没有办法可以一次将其应用于**单个类**中的所有属性？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-27T11:03:46.267

ReSharper 可以这样做：

```
Options -> Code Cleanup -> Use auto-property, if possible 
```

为类运行代码清理——你应该完成了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T20:37:56.373

Tanascius 有正确的答案，尽管您可以通过创建自己的自定义代码清理脚本来稍微调整一下，该脚本仅包含“如果可能，请使用自动属性”重构。

如果您不希望其余的重构运行，那可能会更可取。只需点击代码清理上的添加按钮，然后取消选中其他所有内容。

-最大限度

# vb.net - 使用 WndProc 覆盖组合框的绘制

> ID：915078
> 
> 赞同：3
> 
> 时间：2009-05-27T10:43:07.993
> 
> 标签：vb.net, combobox, drawing, messaging

我已经覆盖了 ComboBox 的 WndProc 并且正在绘制自己的组合框，代码片段如下：

```
Protected Overrides Sub WndProc(ByRef m As Message)

    MyBase.WndProc(m)
    Select Case m.Msg
        Case &HF

            Dim g As Graphics = Me.CreateGraphics

            If ComboBoxRenderer.IsSupported Then
                Dim pTextBoxRect As New Rectangle(Me.ClientRectangle.X, Me.ClientRectangle.Y, Me.ClientRectangle.Width, Me.ClientRectangle.Height)
                ComboBoxRenderer.DrawTextBox(g, pTextBoxRect, _tbState)
                 ' .... and so on
    End Select
End Sub 
```

虽然旧控件仍在绘制，因为我绘制的组合框只是与旧图重叠。有没有办法阻止它绘制默认组合框？

谢谢，罗伯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T16:31:34.187

您使用的方法是完成它的唯一方法，但您是对的，它绘制在默认组合框的顶部，并且在仍然使用组合框控件时无法解决这个问题。

要真正获得自定义绘制的组合框，您需要在对象树中上一层，但最终您必须重新创建组合框的几乎所有功能。

# sql - SQL 超时错误

> ID：915080
> 
> 赞同：0
> 
> 时间：2009-05-27T10:43:42.763
> 
> 标签：sql, iis, asp-classic, ado

我们在 W2003 Web 服务器上运行的大约 30 个站点中只有 1 个出现问题。

可能在一天中大约 25% 的时间里，网站不断返回： SQL Timeout Errors on various connections to SQL (using ODBC)

我已经检查并将 ODBC 驱动程序更新到我能找到的最新版本（3.5.x？），并且我还在检查 SQL 服务器以查看是否有问题（通过 Gb LAN 连接的同一网络上运行的另一台服务器）

IIS 日志文件返回“[Microsoft][ODBC_SQL_Server_Driver]Timeout_expired”

我今天早上遇到了这个问题，所以尝试重新启动 SQL 服务器以查看它是否是与负载相关的问题或其他问题 - 但该站点在重新启动后大约 20 分钟内继续生成这些错误（即使我们所有其他站点都在工作）此时） - 然后它停止超时，现在又开始工作了。

我试图为网站延长 SQL 连接的超时时间，看看这是否改变了一些东西，但它似乎没有做任何事情。

这个站点已经连续运行了大约 3 年，没有出现任何问题，而且我们已经有一段时间没有更改服务器上的任何内容了 - 这开始发生在圣诞节前后，但从那以后变得越来越规律。

我已经检查了所有代码以确保数据库连接正确打开/关闭（站点是经典的 ASP），并确保它没有打开太多并发连接 - 但一切都无济于事，我开始用完想法....有人吗？

我唯一的想法是更改为 OLEDB 连接而不是 ODBC - 但在此之前，我想检查是否有其他我错过的东西可以先尝试。

提前致谢！

卡尔。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T11:26:28.263

您提到更改 SQL 连接的超时，但不清楚究竟是什么超时：是与数据库的连接，还是查询时间过长？

一种可能有用的工具是 Sql Profiler。将其限制为遇到超时的用户或数据库。如果查询长度是一个问题，这应该可以让您准确了解哪些查询运行时间很长。

如果连接本身超时，请检查 Management Studio 中的当前活动。这显示了打开的连接数；如果它们很大，则可能某处存在泄漏。您可以通过运行包含以下内容的连接字符串在开发中对其进行测试：

```
MAX POOL SIZE=2; 
```

这将导致泄漏迅速耗尽连接池。

Mitch Wheat 的建议非常好，不准确的统计数据确实会随着时间的推移而降低性能。此查询可以告诉您统计信息是否是最新的：

```
SELECT 
    object_name = Object_Name(ind.object_id),
    IndexName = ind.name,
    StatisticsDate = STATS_DATE(ind.object_id, ind.index_id)
FROM SYS.INDEXES ind
order by STATS_DATE(ind.object_id, ind.index_id) desc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T10:46:25.740

SQL Server 是否有计划（并正在运行）的定期维护计划，包括重建索引？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T10:50:38.617

由于您没有更改代码，因此您的连接没有问题。

去找出为什么 SQL 语句需要这么长时间。很难说它更简单。您可能会发现在未更改的代码与已更改的数据库的其他使用之间存在死锁*情况*。但是你需要去追踪它，而不是触及没有改变的工作代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-04-12T14:23:19.163

如果上面的那些事情不起作用，我会在任务管理器下检查你的页面文件（PF）使用情况，看看它在哪里。您可能会因缺少虚拟内存而出现超时错误。如果它看起来接近顶部，请考虑将其增加得更高。在我的应用程序的不同部分，我偶尔会遇到很多 SQL 超时错误。事实证明这是一个性能问题。我建议至少 4000mb 的页面文件，具体取决于您服务器上的内存数量。

# dll - 使 DLL 保持最新的方法

> ID：915084
> 
> 赞同：4
> 
> 时间：2009-05-27T10:44:52.137
> 
> 标签：dll, filesystems, dependencies

我最近加入了一家公司，该公司多年来为他们提供了许多不同质量的开发人员。

已创建的项目依赖于其他项目的输出。但是，不是以正常方式创建依赖项并维护代码，而是将 DLL 从一个地方复制到另一个地方并从那里引用。

有没有一种简单的方法可以将父文件夹下的所有 DLL 更新为整个文件夹范围内的最新版本（按时间戳）？

所以总结一下流程：

1.  在根文件夹中编译所有项目和解决方案。
2.  查找并更新输出文件的所有其他副本。
3.  重新编译所有内容并找出中断的地方。
4.  更新源代码和更新参考。

问题步骤是 2。

（我很清楚这可能会破坏东西）

我正在使用 Visual Studio 2005 和 C# 创建 DLL，但是我想更新文件而不是代码。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T10:49:37.807

Microsoft 的最佳实践建议是尽可能参考项目而不是 DLL。

> **项目到项目参考和文件参考**
> 
> 文件引用是对程序集的直接引用；您可以使用“添加引用”对话框的“浏览”选项卡创建它们。项目到项目引用是对包含程序集的项目的引用；您可以使用“添加引用”对话框的“项目”选项卡创建它们。
> 
> 项目到项目引用的优点是它在构建系统中的项目之间创建依赖关系，因此如果依赖项目自上次构建引用项目后发生更改，则将构建依赖项目。文件引用不会创建构建依赖项，因此可以在不构建依赖项目的情况下构建引用项目，并且该引用可能会过时（即，该项目可以引用该项目的先前构建版本）。这可能导致 bin 目录中需要单个 DLL 的多个版本，这是不可能的。发生此冲突时，您将看到一条消息，例如警告：无法将项目 'project' 中的依赖项 'file' 复制到运行目录，因为它会覆盖引用'
> 
> 您应该避免将文件引用添加到同一解决方案中另一个项目的输出，因为这样做可能会导致编译错误。相反，请使用“添加引用”对话框的“项目”选项卡在同一解决方案中创建项目到项目的引用。通过允许更好地管理您在项目中创建的类库，这使团队开发变得更加容易。有关详细信息，请参阅对损坏的引用进行故障排除和如何：创建和删除项目依赖项。

从[这里](http://msdn.microsoft.com/en-us/library/ez524kew(VS.80).aspx)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-27T13:28:01.450

有时项目到项目的引用不起作用。例如项目的构建时间，或者希望多个项目依赖于特定的引用构建，或者引用项目的测试已经完成并且您不想再次测试。

如果您有持续集成系统和版本控制，那么另一种方法是将内置 dll 作为 CI 构建的一部分检入版本控制中。然后将dll（例如svn中的外部）引用到依赖项目，这应该意味着您的所有dll都保持最新。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-29T14:06:58.397

您能否在包含但并非真正包含的项目中添加构建后步骤以将 DLL 转储到预先安排的位置？从那里，您可以在相关项目中添加预构建步骤，以从所述位置获取新的 DLL。绝对不是最佳实践，但它应该可以完成工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-02T19:49:26.440

一种更简单的方法是创建一个包含您需要的所有项目的解决方案，修改它们之间的引用以使用项目引用，更改项目以使其输出文件夹都指向同一目录，然后设置项目引用，以便“复制本地”设置为 false。

然后您需要做的就是构建解决方案（在 VS 中或通过 msbuild 在命令行上）。

构建结果将是一个文件夹，其中包含您需要的所有文件，并且每个项目都将始终具有最新的引用。

# macos - 如何在 OS X 中检测打印机缺纸？

> ID：915085
> 
> 赞同：1
> 
> 时间：2009-05-27T10:45:03.853
> 
> 标签：macos, printing

在 Mac OS X 中：是否有一种编程方式来检测所选打印机是否缺纸？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T11:09:31.277

请注意，Mac OS X 使用[CUPS](http://www.cups.org)，并提供与打印机无关的 API。

请参阅 API 文档，特别是[表 1.1](http://www.cups.org/documentation.php/api-cups.html#PRINTERS_AND_CLASSES)，其中详细说明了错误情况

# iphone - 如何手动删除 UITableView 中的一行？

> ID：915095
> 
> 赞同：17
> 
> 时间：2009-05-27T10:48:32.567
> 
> 标签：iphone, objective-c, cocoa-touch, uitableview

这是我想出的：

```
NSIndexPath *indexPath = [NSIndexPath indexPathForRow:0 inSection:1]; // my table view has 2 sections
[tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationTop]; 
```

每次我构建和运行时，它都会引发以下异常：

> 无效更新：第 0 节中的行数无效。更新后现有节中包含的行数必须等于更新前该节中包含的行数，加上或减去添加或删除的行数那个部分。

这有点令人困惑。该部分设置为 1，但异常显示为 0。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-27T11:04:06.827

我想到了。

除了上述代码之外，我还需要对数据源进行更改

```
[items removeObjectAtIndex:0]; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-01-09T15:46:16.963

```
- (IBAction)deleteCustomCellWithUIButton:(id)sender
{
  NSLog(@"Message From Custom Cell Received");
  NSIndexPath *indexPath = [self.myTableView indexPathForCell:(UITableViewCell *)[[[sender superview] superview] superview]];
  NSUInteger row = [indexPath row];
  [self.myDataArray removeObjectAtIndex:row];
  [self.myTableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath]  withRowAnimation:UITableViewRowAnimationFade];
} 
```

# log4net - Postsharp 和 log4net 和 log4postsharp

> ID：915105
> 
> 赞同：2
> 
> 时间：2009-05-27T10:52:45.243
> 
> 标签：log4net, postsharp, log4postsharp

我偶然发现了 log4postsharp[站点](http://code.google.com/p/postsharp-user-plugins/wiki/Log4PostSharp)，它是一个很棒的工具，它使用 postsharp 在编译时将 log4net 语句注入到您的代码中。

当前版本的 log4postsharp 使用 Postsharp 1.0，它有一些限制。有谁知道是否有使用 Postsharp 1.5 的 log4postsharp 编译版本可用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-24T18:59:03.163

该项目已升级到 PostSharp 1.5。

# c++ - C++：从指向类的指针访问成员结构的语法

> ID：915106
> 
> 赞同：9
> 
> 时间：2009-05-27T10:53:22.277
> 
> 标签：c++, struct, member

我正在尝试访问成员结构变量，但我似乎无法获得正确的语法。这两个编译错误pr。访问是：错误 C2274：“函数样式转换”：作为“。”的右侧是非法的 运算符错误 C2228：“.otherdata”左侧必须有类/结构/联合我尝试了各种更改，但没有成功。

```
#include <iostream>

using std::cout;

class Foo{
public:
    struct Bar{
        int otherdata;
    };
    int somedata;
};

int main(){
    Foo foo;
    foo.Bar.otherdata = 5;

    cout << foo.Bar.otherdata;

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-27T10:56:52.800

您只在那里定义一个结构，而不是分配一个。试试这个：

```
class Foo{
public:
    struct Bar{
        int otherdata;
    } mybar;
    int somedata;
};

int main(){
    Foo foo;
    foo.mybar.otherdata = 5;

    cout << foo.mybar.otherdata;

    return 0;
} 
```

如果要在其他类中复用该结构，也可以在外面定义该结构：

```
struct Bar {
  int otherdata;
};

class Foo {
public:
    Bar mybar;
    int somedata;
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-27T10:57:41.393

`Bar`是内部定义的内部结构`Foo`。对象的创建`Foo`不会隐式创建`Bar`的成员。您需要使用`Foo::Bar`语法显式创建 Bar 的对象。

```
Foo foo;
Foo::Bar fooBar;
fooBar.otherdata = 5;
cout << fooBar.otherdata; 
```

除此以外，

创建 Bar 实例作为`Foo`类中的成员。

```
class Foo{
public:
    struct Bar{
        int otherdata;
    };
    int somedata;
    Bar myBar;  //Now, Foo has Bar's instance as member

};

 Foo foo;
 foo.myBar.otherdata = 5; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-27T10:58:05.217

您创建了一个嵌套结构，但您从未在类中创建它的任何实例。你需要这样说：

```
class Foo{
public:
    struct Bar{
        int otherdata;
    };
    Bar bar;
    int somedata;
}; 
```

然后你可以说：

```
foo.bar.otherdata = 5; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T11:00:11.437

你只是声明 Foo::Bar 但你没有实例化它（不确定这是否是正确的术语）

用法见这里：

```
#include <iostream>

using namespace std;

class Foo
{
    public:
    struct Bar
    {
        int otherdata;
    };
    Bar bar;
    int somedata;
};

int main(){
    Foo::Bar bar;
    bar.otherdata = 6;
    cout << bar.otherdata << endl;

    Foo foo;
    //foo.Bar.otherdata = 5;
    foo.bar.otherdata = 5;

    //cout << foo.Bar.otherdata;
    cout << foo.bar.otherdata << endl;

    return 0;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T11:00:20.610

```
struct Bar{
        int otherdata;
    }; 
```

在这里，您刚刚定义了一个结构，但没有创建它的任何对象。因此，当您说`foo.Bar.otherdata = 5;`这是编译器错误时。创建一个类似 struct Bar 的对象，`Bar m_bar;`然后使用`Foo.m_bar.otherdata = 5;`

# sql - 用于散列的脚本生成 SQL Server DB 架构的最快方法

> ID：915109
> 
> 赞同：4
> 
> 时间：2009-05-27T10:53:34.290
> 
> 标签：sql, sql-server, schema

我想获取数据库的整个 SQL 模式，然后生成它的哈希值。这样我就可以检查回滚脚本是否将架构返回到原始状态。有没有我可以使用的 SP 或其他一些狡猾的方法？我希望它尽可能快。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T11:56:09.700

如果您将表和键与代码和约束分开，那么您可以轻松地散列后者。

```
SELECT
    CHECKSUM_AGG(BINARY_CHECKSUM (*))
FROM   
    (SELECT
        definition 
    FROM
        sys.default_constraints
    UNION ALL
    SELECT
        definition 
    FROM
        sys.sql_modules
    UNION ALL
    SELECT
        definition 
    FROM
        sys.check_constraints
    ) foo 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T11:56:36.753

以下应该有效：

```
 Microsoft.SqlServer.Management.Smo.Server srv = new Microsoft.SqlServer.Management.Smo.Server("Server");

        Microsoft.SqlServer.Management.Smo.Database db = srv.Databases["DB_Name"];

        // Set scripting options as needed using a ScriptingOptions object.
        Microsoft.SqlServer.Management.Smo.ScriptingOptions so = new ScriptingOptions();
        so.AllowSystemObjects = false;
        so.ScriptDrops = false;
        so.Indexes = true;
        so.ClusteredIndexes = true;
        so.PrimaryObject = true;
        so.SchemaQualify = true;
        so.IncludeIfNotExists = false;
        so.Triggers = true;

        System.Collections.Specialized.StringCollection sc = new System.Collections.Specialized.StringCollection();
        StringBuilder sb = new StringBuilder();

        foreach (Table item in db.Tables)
            if (!item.IsSystemObject)
            {
                sc = item.Script(so);
                foreach (string s in sc)
                    sb.Append(s);
            }

        foreach (StoredProcedure item in db.StoredProcedures)
            if (!item.IsSystemObject)
                if (!item.IsSystemObject)
                {
                    sc = item.Script(so);
                    foreach (string s in sc)
                        sb.Append(s);
                }

        foreach (UserDefinedFunction item in db.UserDefinedFunctions)
            if (!item.IsSystemObject)
                if (!item.IsSystemObject)
                {
                    sc = item.Script(so);
                    foreach (string s in sc)
                        sb.Append(s);
                }

        foreach (Trigger item in db.Triggers)
            if (!item.IsSystemObject)
                if (!item.IsSystemObject)
                {
                    sc = item.Script(so);
                    foreach (string s in sc)
                        sb.Append(s);
                }

        //sb.GetHashCode();
        // For a better hash do this.
        System.Security.Cryptography.MD5CryptoServiceProvider hashProvider = new System.Security.Cryptography.MD5CryptoServiceProvider();

        byte[] hashData = hashProvider.ComputeHash(ASCIIEncoding.ASCII.GetBytes(sb.ToString())); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T11:10:14.303

我编写了一个名为[SMOscript](http://devio.wordpress.com/2009/05/22/smoscript-scripting-database-objects-using-smo/)的工具，它使用 SMO 库调用来编写数据库中所有对象的脚本。您可以使用它来创建单个 .sql 文件，并找到另一个工具来计算结果文件的哈希值。（例如，随机谷歌提出了[这个](http://www.nirsoft.net/utils/hash_my_files.html)）

# c - 合并多个 .so 共享库

> ID：915128
> 
> 赞同：46
> 
> 时间：2009-05-27T10:59:48.457
> 
> 标签：c, linux, unix, gcc, shared-libraries

假设我有 a.so 和 b.so。我可以将 c.so 生成为具有 a 和 b 导出的所有函数的单个共享库，当然可以解决所有内部依赖关系（即 a.so 调用的 b.so 的所有函数，反之亦然）？

我试过

```
gcc -shared -Wl,soname,c.so -o c.so a.so b.so
```

但它不起作用。

如果我将 ao 和 bo 存档在 aa 和 ba 中也是如此（不应该修改 ao 和 bo），然后执行

```
gcc -shared -Wl,soname,c.so -o c.so aa ba
```

谢谢

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-05-29T02:42:27.353

在除 AIX 之外的所有 UNIXen 上，将多个共享库合并为一个实际上是不可能的：链接器将 .so 视为“最终”产品。

但是将档案合并到 .so 应该不是问题：

```
gcc -shared -o c.so -Wl,--whole-archive a.a b.a -Wl,--no-whole-archive 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-27T11:17:57.063

在实践中这是不可能的。

从链接器的角度来看，SO 库是不包含链接所需的重定位信息的最终产品。

如果您可以访问这两个库的源文件或目标文件，则可以直接从它们编译/链接组合的 SO。

# python - 从 python 2.4 迁移到 python 2.6

> ID：915135
> 
> 赞同：4
> 
> 时间：2009-05-27T11:03:02.023
> 
> 标签：python

我正在将工作中的遗留代码库从 python 2.4 迁移到 python 2.6。这是为了消除“遗留”标签并为积极开发奠定可维护、可扩展的基础而完成的，因此我有机会“正确地做事”，包括重构以使用新的 2.6 功能。导致更干净、更健壮的代码。（我已经对“with”声明感到欣喜若狂:)）。迁移有什么好的技巧吗？最佳实践、设计模式等？我主要是一个 ruby​​ 程序员。我在使用此代码时学习了一些 python 2.4，但对现代 python 设计原则一无所知，因此请随意提出您认为显而易见的事情。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T11:22:46.743

阅读 Python 3.0 的更改。2.6的重点是瞄准3.0。

从 2.4 到 2.6，你获得了很多东西。这些是最重要的。我正在制作这个答案社区维基，以便其他人可以编辑它。

1.  生成器函数和 yield 语句。

2.  更一致地使用各种类型，例如`list`and `dict`-- 它们可以直接扩展。

3.  `from __future__ import with_statement`

4.  `from __future__ import print_function`

5.  异常是新风格的类，并且有更一致的异常处理。字符串异常已被删除。尝试使用它们会引发 TypeError

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T11:18:06.703

我想您已经找到了它们，但是对于其他人来说，以下是这两个版本中的新功能列表：

*   [http://docs.python.org/whatsnew/2.5.html](http://docs.python.org/whatsnew/2.5.html)
*   [http://docs.python.org/whatsnew/2.6.html](http://docs.python.org/whatsnew/2.6.html)

除了从这些文档中挑选功能外，我建议利用这个机会（如果需要）使代码符合[PEP 8](http://www.python.org/dev/peps/pep-0008/)中的标准 Python 代码样式。

有一些自动化工具可以帮助您正确使用 Python 样式：[pep8.py](http://svn.browsershots.org/trunk/devtools/pep8/pep8.py)实现 PEP 8 检查，而[pylint](http://svn.browsershots.org/trunk/devtools/pep8/pep8.py)提供更大的报告，其中还包括未定义的变量、未使用的导入等[内容。pyflakes](http://divmod.org/trac/wiki/DivmodPyflakes)是一个更小更快的 pylint。

# xml - 如何限制 DTD 中 XML 标记属性的允许值？

> ID：915140
> 
> 赞同：0
> 
> 时间：2009-05-27T11:04:22.350
> 
> 标签：xml, dtd

我有一个 DTD，我想将一些属性属性的可能值限制为“是”或“否”。

```
<!ATTLIST node postgrad CDATA ""> 
```

我怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T11:10:54.957

通过定义属性 postgrad 可以具有值是或否：

```
<!ATTLIST node postgrad (yes | no)> 
```

这样就可以了=）

# asp.net - 实现具有稍微奇怪的要求的自定义成员资格提供程序

> ID：915141
> 
> 赞同：2
> 
> 时间：2009-05-27T11:04:22.910
> 
> 标签：asp.net, asp.net-membership, membership-provider, mobile-website

为移动用户构建一个新的移动网络平台，以在他们的手机上购买和下载内容。过去，我们使用了完全定制的登录机制，但我正在研究为下一版本的平台使用自定义成员资格提供程序。

问题是，我们有一些稍微奇怪的“登录”机制要求，所以我不能 100% 确定 MembershipProvider 是最合适的。

只是通过“是的，会员提供者很合适”或“不，你在一个圆孔里敲一个方形钉子”来寻找一些关于以下要求的一般反馈

要求

1.  用户可能需要使用“手机号码”（用户名）和“Pin”（密码）登录 这非常适合，因为他们已经注册并通过短信确认，并且满足`ValidateUser(string username, string password)`方法实现

2.  用户可能只需要使用“手机号码”登录。在这种情况下，我们不会费心在我们这边进行身份验证。它减少了用户的步骤数量，并且在我们尝试向他们收费时由特定的操作员完成验证。（运营商可以验证输入的手机号码，当它到达运营商支付网站时与手机匹配）......所以即使用户有密码，我们也需要以某种方式欺骗会员提供商，让他们进来使用空白密码。

3.  用户根本不需要登录。在这种情况下，我们可以将用户透明地退回到一个特殊的网络运营商网页，当他们透明地退回给我们时，我们将在 Headers 中获取手机号码。在这种情况下，我们需要以编程方式从标题中获取该数字，在后面的代码中代表他们执行登录（同样没有任何 pin/密码），用户将神奇地自动登录。

要求 2 和 3 有点奇怪。我们基本上有 3 种不同的登录机制，一个会员提供者需要满足这些机制。

*   用户输入的手机和用户输入的密码
*   用户仅输入手机（我想后面的代码可以满足密码要求）
*   完全透明的登录（完成整个登录过程的代码）

Anyone got any comments/feed back on the above or have any advice on any bizarre membership provider implementation you've done in the past.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-06T19:40:03.290

I think it could work. We do #3 on one of our sites. Here is a chunk of code that we use to take care of it. To use this, create a login page (transparentlogin.aspx or something similar), make sure that the web.config file allows anonymous access to this page, and put code like this in the page_load function for the transparentlogin.aspx page:

```
const string specialpassword = "ThisIsOurSpecialPasswordForBehindTheScenesLogin";

if (MobileNumberFoundInHeader())
{
  string username = GetMobileNumberFromHeaders();
  // Authenticate the user behind the scenes
  System.Web.Security.FormsAuthentication.SetAuthCookie(username, false);
  System.Web.Security.FormsAuthentication.Authenticate(username, specialpassword);
}
else
{
  throw new Exception ("Mobile Number Missing");
} 
```

Then, in the ValidateUser function in the MembershipProvider, make sure you do a check like this:

```
public override bool ValidateUser(string username, string password)
{
 const string specialpassword = "ThisIsOurSpecialPasswordForBehindTheScenesLogin";

 bool ValidationSuccess = false;

 // If the password being passed in is the right secret key (same  
 // for all users), then we will say that the password matches the
 // username, thus allowing the user to login 
 if (password == specialpassword)
 {
   ValidationSuccess = true;
 }

 if (DoStandardUsernamePasswordVerification() == true)
 {
   ValidationSuccess = true;
 }

 return ValidationSuccess;
} 
```

As for requirement #2, I'm a little confused. What exactly is an operator? I thought we were dealing with a mobile phone using a web browser to browse to a website. Where does the operator fit into that? If the solution I propose above doesn't help, please post a response with more details about the Operator.

Tim

# php - 有没有办法将 zip 文件放入 PHP 的 include_path 中？

> ID：915143
> 
> 赞同：-1
> 
> 时间：2009-05-27T11:04:41.317
> 
> 标签：php, zend-framework

到处复制 Zenf 框架是一场噩梦，所以我有一个想法，如果整个框架只是一个 zip 文件，那么部署会更快。有没有办法做到这一点？会不会非常低效？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T11:19:44.610

你真的只需要在每台服务器上部署一次，所以这并不是一场噩梦。

但要回答你的问题：如果你的意思是你可以只包含一个 ZIP 文件，那么不。但是，为了减轻部署的痛苦，您可以将 ZF 以 zip 文件的形式上传到服务器，然后将其解压缩到远程计算机上。这比单独上传大量文件要快得多。

编辑：实际上，您可能可以实现自己的[Zend_Loader](http://framework.zend.com/manual/en/zend.loader.html)版本，它知道如何处理 zip 文件。不过，我高度怀疑它是否会合理执行。它很可能会导致比它解决的问题更多的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T11:20:36.777

从 5.3 开始（尽管它也可以作为 PECL 模块安装）PHAR 文件 - [http://pecl.php.net/phar](http://pecl.php.net/phar)和[http://www.php.net/phar](http://www.php.net/phar)。然而，运行像整个 ZF 框架一样大的东西，其中大部分时间大部分时间都不会使用，这将是矫枉过正。我认为很可能当 PHP5.3 发布时，它的重要部分也将作为 .PHAR 文件发布以供使用。

在那之前，没有。然而，复制它只是一次性交易。您也可以只下载原始 .tgz 文件并将其解压缩到服务器上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T11:25:07.470

我认为您仍然需要解压缩它，但不必将其复制到每个项目中。假设您有一个像这样的目录结构：

```
/htdocs
    /library
        /Zend
    /Project1
        [...]
        /public
            index.php
    /Project2
        [...]
        /public
            index.php 
```

然后只需将 Zend_Framework 的 index.php 中的包含路径从*../library 编辑*为：

```
../../library 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T20:46:11.987

如果您在基于 Unix 的环境中工作，在项目库文件夹下的 Zend 文件夹中添加符号链接也可以：

```
% cd /your/project/library
% ln -s /path/to/ZendFramework/library/Zend . 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T01:20:33.277

您可以使用 PHAR[1] 扩展来管理这个 :) PHAR 扩展允许您使用类似的东西：

```
include 'phar:///path/to/zend-latest.tgz/file.php'; 
```

PS：PHAR 也可以处理 .zip 或 .tgz 文件。
我希望它有所帮助。干杯。

1： http: [//php.net/phar](http://php.net/phar)

# clojure - F# 和 Clojure 之间的显着差异

> ID：915145
> 
> 赞同：32
> 
> 时间：2009-05-27T11:05:37.167
> 
> 标签：clojure, f#, functional-programming

F# 和 Clojure 之间最显着的区别是什么？

哪些构造具有 Clojure 没有的 F#，反之亦然？

F# 有宏吗？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-05-27T11:24:38.813

大多数差异将源于 F# 源自[ML](http://en.wikipedia.org/wiki/ML_programming_language)而 clojure 源自[lisp](http://en.wikipedia.org/wiki/Lisp_programming_languag)的事实。

所以 F# 有更多的 ML/OCaml/Haskell 感觉，重点是：

*   静态类型
*   类型推断
*   模式匹配

虽然 clojure 有更多的 Lisp 感觉，但强调：

*   s-表达式
*   宏
*   关闭

同样正如 Brian 所指出的，F# 是一种 .Net 语言，而 clojure 是一种 JVM 语言，因此每个语言都可以访问大量但不同的库。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-03T12:00:38.550

Clojure 是一种 lisp，实际上是 lisp-1 家族语言。F# 是 .net 平台采用的实用 OCaml。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-27T11:12:34.970

一个关键区别是 F# 是一种 .NET 语言，而 Clojure 在 JVM 上运行。因此，部署和支持的平台会有所不同。

但是请注意，单声道支持 F#。

至于宏，我认为[你不走运](https://stackoverflow.com/questions/88302/macro-support-in-f)。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-12-22T18:02:07.410

看起来在 CLR 上运行 Clojure 需要付出一些努力。看起来很有前途。

[http://github.com/richhickey/clojure-clr](http://github.com/richhickey/clojure-clr)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-05-01T16:12:40.183

它们都是[功能优先](https://vimeo.com/68226717)的编程语言，但它们的类型系统非常不同。F# 是一种强类型语言，而 Clojure 是一种动态类型语言，所以

1.  Boumbles 对 What is the [Difference between Strong vs. Static Typing AND Weak vs. Dynamic Typing](https://stackoverflow.com/a/11889763/575530)的回答；
2.  haylem 对[动态与静态类型语言研究](https://softwareengineering.stackexchange.com/a/12381/50096)的回答；或者
3.  Joey Adams 的问题[原型设计哪个更好：静态类型语言还是动态类型语言？](https://softwareengineering.stackexchange.com/q/105846/50096)

可能有助于回答“F# 和 Clojure 之间最显着的区别是什么？”。但是请注意，“静态类型”和“动态类型”之间的争论是一场长期存在的争论，因此可能看起来很宗教。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-27T20:09:00.160

如果你想要宏，你可以将它与[Boo](http://boo.codehaus.org/)或[Nemerle](http://nemerle.org/)一起使用。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-27T18:58:55.433

F# 真正对应于 JVM 上的 Scala。在 .NET 平台上最接近 Clojure 的是 IronScheme。

# ruby - 不将所需文件包含到 vim omnicompletion

> ID：915152
> 
> 赞同：8
> 
> 时间：2009-05-27T11:08:22.810
> 
> 标签：ruby, vim, editor, autocomplete

如果我尝试在具有 require 'xxx' 语句的 Ruby 文件中自动完成 smth，它会开始扫描所需的所有文件（以及所需文件所需的文件）。它每次都会这样做！

是否可以使 vim 自动完成不扫描所需文件或仅扫描特定路径中的文件（例如 app/ only）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-01T14:54:09.000

以下其中一项应该有效

*   `:set path=.,/myinclude1,/myinclude2`设置自己的包含路径
*   `:set complete-=i`在默认完成中禁用包含的文件
*   `:set include=`取消设置包含文件匹配模式

我建议你使用第二个，所以`CTRL-X CTRL-I`仍然可以正常工作

# c# - Linq2Sql：更改“删除”可扩展性方法以更新记录

> ID：915157
> 
> 赞同：2
> 
> 时间：2009-05-27T11:09:34.630
> 
> 标签：c#, linq-to-sql

我正在使用 winforms 编写 CRUD，通过 Linq2Sql 连接到 MS SqlServer 2008。
当我的应用程序的用户想要删除数据库中的记录时，我不希望它被物理删除。我只想将一个名为“DlDat”的列设置为当前日期时间，然后更新记录而不是删除它。为了在 Linq 中强制执行此行为，我扩展了 sqlmetal 自动生成的 Delete(table) 方法。
例如，如果我有一个名为“Unit”的数据库表和一个名为“PdpDataContext”的数据上下文，则代码如下所示：

```
public partial class PdpDataContext
{
    public PdpDataContext() : base()
    {
        OnCreated();
    }
    partial void DeleteUnit(Unit instance)
    {
        instance.DLDAT = DateTime.Now;
        this.ExecuteDynamicUpdate(instance);
    }
    partial void UpdateUnit(Unit instance)
    {
        instance.CHDAT = DateTime.Now;
        this.ExecuteDynamicUpdate(instance);
    }
} 
```

但是当我删除时：

```
PdpDataContext cx = new PdpDataContext();
cx.ObjectTrackingEnabled = true;
Unit u = new Unit();
u = cx.Unit.Single(x => x.INTUNITNO == 1);
cx.Unit.DeleteOnSubmit(u);
cx.SubmitChanges(); 
```

我得到一个 SqlException“WHERE 附近的语法错误”。记录上下文的 SQL 输出，我看到 Linq 尝试进行“空”更新：

```
UPDATE [dbo].[Unit]
SET 
WHERE ([INTUNITNO] = @p0) AND ([version] = @p1) 
```

这可能是因为当上下文的 ChangeSet 仅包含“删除”而没有“更新”时，我使用了 ExecuteDynamicUpdate。
我可以通过仅更新记录而不是在用户按下删除按钮或使用存储过程时删除它来解决此问题。但由于我是 Linq 世界的新手，我想知道是否有另一种使用数据上下文的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-06T14:51:40.150

这样做的问题是，linq 假设您将使用与您覆盖的相同的 CRUD 操作。看看这篇文章（[开发人员在覆盖默认行为（LINQ to SQL）中的责任](http://msdn.microsoft.com/en-us/library/bb546188.aspx)）

这就是我要做的：

```
partial void DeleteUnit(Unit instance)    
{        
   //instance.DLDAT = DateTime.Now;        
   //this.ExecuteDynamicUpdate(instance);

   PdpDataContext cx = new PdpDataContext();
   cx.ObjectTrackingEnabled = true;
   Unit u = new Unit();
   u = cx.Unit.Single(x => x.INTUNITNO == 1);
   u.DLDAT = DateTime.Now;
   cx.SubmitChanges();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T11:57:06.033

我想知道在表上使用“INSTEAD OF”触发器（删除）是否会更好......或者只是不要对 LINQ 撒谎：如果你想做一个 UPDATE（不是 DELETE），然后*更新对象*（不要删除它）。例如，在模拟删除的数据上下文上编写一个方法，而不是使用`DeleteOnSubmit`.

您也可以通过覆盖 SubmitChanges 和调查增量来做一些事情，但我不确定这是一个好主意

# logic - 单独的 EXISTS 子句的 skolemisation 是如何工作的？

> ID：915162
> 
> 赞同：1
> 
> 时间：2009-05-27T11:10:40.510
> 
> 标签：logic, satisfiability, conjunctive-normal-form

如果我有一个像这样的公式：

```
FAx FAy (Ez(!A(x,z) v !A(y,z)) v B(x,y)) 
```

（FA = 全部 / E = 存在）

skolemisation 的规则说：

1.  如果 E 在 FA 之外，则替换为常数或
2.  如果 E 在 FA 内部，则用新函数替换包含 FA 外部的所有变量作为参数。

那么在这种情况下我该怎么办？我可以只删除 Exists 量词还是用常数替换它？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T11:36:54.983

首先使用标准符号编写：

```
∀x∀y(∃z(!A(x,z)∨!A(y,z))∨B(x,y)) 
```

现在，应用你的第二个 skolemisation 规则：

```
∀x∀y((!A(x,f(x,y))∨!A(y,f(x,y)))∨B(x,y)) 
```

所以我用一个包含所有外部变量的函数替换了 ∃z。

现在，这仍然不是 Skolem 范式，因为它不是*合*取前置范式：公式仍然使用大量析取 (∨)。删除这些由您决定。

# delphi - 如何将 RTF 字符串复制到 delphi 2009 中的剪贴板？

> ID：915168
> 
> 赞同：1
> 
> 时间：2009-05-27T11:12:45.140
> 
> 标签：delphi, winapi, delphi-2009, clipboard

这是我在 2009 年之前在 Delphi 中工作的代码？它要么最终在**SetAsHandle**上引发堆错误。如果我将其更改为按原件使用 AnsiString，即

```
procedure RTFtoClipboard(txt: string; rtf: AnsiString); 
```

和

```
Data := GlobalAlloc(GHND or GMEM_SHARE, Length(rtf)*SizeOf(AnsiChar) + 1); 
```

那么没有错误，但剪贴板是空的。

***完整代码：***

```
unit uClipbrd;

interface

procedure RTFtoClipboard(txt: string; rtf: string);

implementation

uses
  Clipbrd, Windows, SysUtils, uStdDialogs;
VAR
  CF_RTF : Word = 0;

//------------------------------------------------------------------------------
procedure RTFtoClipboard(txt: string; rtf: string);
var
  Data: Cardinal;
begin
  with Clipboard do
  begin
    Data := GlobalAlloc(GHND or GMEM_SHARE, Length(rtf)*SizeOf(Char) + 1);
    if Data <> 0 then
      try
        StrPCopy(GlobalLock(Data), rtf);
        GlobalUnlock(Data);
        Open;
        try
          AsText := txt;
          SetAsHandle(CF_RTF, Data);
        finally
          Close;
        end;
      except
        GlobalFree(Data);
        ErrorDlg('Unable to copy the selected RTF text');
      end
    else
      ErrorDlg('Global Alloc failed during Copy to Clipboard!');
  end;
end;

initialization
  CF_RTF := RegisterClipboardFormat('Rich Text Format');
  if CF_RTF = 0 then
    raise Exception.Create('Unable to register the Rich Text clipboard format!');
end. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T20:10:39.127

引用[维基百科](http://en.wikipedia.org/wiki/Rich_Text_Format)：

> RTF 是一种 8 位格式。这会将其限制为 ASCII，但 RTF 可以通过转义序列对 ASCII 以外的字符进行编码。字符转义有两种类型：代码页转义和 Unicode 转义。在代码页转义中，撇号后面的两个十六进制数字用于表示取自 Windows 代码页的字符。例如，如果存在指定 Windows-1256 的控制代码，则序列 \'c8 将对阿拉伯字母 beh (ب) 进行编码。
> 
> 如果需要 Unicode 转义，则使用控制字 \u，后跟一个 16 位有符号十进制整数，给出 Unicode 代码点编号。对于不支持 Unicode 的程序，它后面必须跟在指定代码页中该字符的最接近的表示。例如，\u1576? 将给出阿拉伯字母 beh，指定不支持 Unicode 的旧程序应将其呈现为问号。

因此，您使用 AnsiString 的想法很好，但您还需要用 Unicode 转义符替换所有非 ASCII 且不属于当前 Ansi Windows 代码页的字符。理想情况下，这应该是另一个功能。您将数据写入剪贴板的代码可以保持不变，唯一的变化是使用 Ansi 字符串类型。

# java - JDBC 中的正则表达式

> ID：915169
> 
> 赞同：1
> 
> 时间：2009-05-27T11:14:09.037
> 
> 标签：java, mysql, database, oracle, jdbc

我有一个使用 JDBC 进行数据库交互的 java 应用程序。我想根据一系列正则表达式进行搜索，但是应用程序应该是通用的，我们不知道数据库引擎是否会通过 mysql、oracle、sql server 等，但我们很确定它会是mysql或甲骨文。

正则表达式是否会将我的应用程序限制在特定的数据库中，或者我可以在不担心兼容性的情况下使用它们吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T11:19:41.647

好吧，使用正则表达式会将您限制为支持它们的 DBMS :-)。也就是说，至少 Oracle、MySQL、PostgreSQL 和 MS-SQL 支持某种正则表达式，所以原则上应该不是问题。当然，您可能仍然会遇到兼容性问题。

您最好的选择可能是将正则表达式的使用限制在应用程序的某些已定义部分，例如一些存储过程或应用程序中生成 SQL 查询的一个模块。

无论如何，这是一个很好的做法，并且将使以后的更改变得可行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T11:22:20.893

虽然理论上我相信[MySQL](http://dev.mysql.com/doc/refman/5.1/en/regexp.html)和[Oracle](http://www.regular-expressions.info/oracle.html)都旨在支持 POSIX ERE，但 MySQL 使用 REGEXP，而 Oracle 使用 REGEXP_LIKE，并且正则表达式.info 指出 Oracle 的实现有一些怪癖（MySQL 可能有类似的实现）。

因此，您可能无法使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T12:09:00.690

是的，使用正则表达式搜索等非标准 SQL 功能会将您的应用程序限制为特定数据库。

就像 slekse 建议的那样，一个好的解决方案是将非标准 SQL 功能的使用限制在一个特定的模块中。然后，如果您更改 DBMS，则只需要更改该模块。

# ios - 如何将 MySQL 数据库与 Objective-C 项目连接起来？

> ID：915170
> 
> 赞同：0
> 
> 时间：2009-05-27T11:15:30.580
> 
> 标签：ios, mysql, objective-c

如何将 MySQl 数据库与我的 iphone 应用程序连接，读取、写入、将一些数据保存到数据库中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T11:21:49.897

[http://code.google.com/p/mysql-cocoa-framework/](http://code.google.com/p/mysql-cocoa-framework/)有一个包装器

# c++ - C++ 模板：编码错误还是编译器错误？

> ID：915172
> 
> 赞同：1
> 
> 时间：2009-05-27T11:15:49.813
> 
> 标签：c++, templates, stl, c++builder

我正在尝试使用模板来获取 std:list of items，其中每个项目都有一个指向包含它的列表的指针，但我一直在点击编译器消息。

这是代码的一个非常精简的版本。

```
template <class E> class Item  
{
    public:
        E* owner; // pointer to list that owns us.
};

template <class E> class BaseList: public std::list<E>
{
protected:
    typedef std::list<E> inherited;
public:

    void push_back(const E &e)
    {
        E tmp(e);
        tmp.owner = this;  // This line gives the error.
        inherited::push_back(tmp);
    }
};

class MyList;

class MyItem : public Item<MyList>
{
};

class MyList : public BaseList<MyItem>
{
};

void foo()  // test code to instantiate template
{
    MyList l;
    MyItem m;
    l.push_back(m);
} 
```

但是，我的编译器在该行中遇到了问题：-

```
 tmp.owner = this; 
```

错误是：

```
[BCC32 Error] Unit7.cpp(30): E2034 Cannot convert 'BaseList<MyItem> * const' to 'MyList *' 
```

就像“this”不知何故变成了const，但我不明白为什么。编译器是 Codegear C++Builder 2009。

我承认我不是 100% 满意使用模板，所以我不确定这是我的问题还是编译器的问题。没有使用模板的相同代码编译得很好，但显然这不是我想要的，因为我有几个项目/列表类想要以这种方式工作。

此外，是否有更好的技术可以避免在每个项目中包含所有“所有者”指针？

**编辑：**我认为我将示例剥离得太远了：“MyList”实际上引入了新方法，然后“MyItem”必须通过“所有者”指针访问。

**摘要：**感谢所有评论和回答。正如公认的答案所说，问题只是指向 BaseList 与 MyList 的指针之间的类型不兼容之一。

关于从 STL 容器和替代设计派生的问题也很有帮助，但我使用的解决方案与下面 Luc Touraille 的解决方案基本相同。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T11:24:43.273

在第 30 行，“this”是指向 a 的指针`BaseList<MyIteM>`，而不是 MyList。您可以用派生类替换一个类，但反过来不行。

您可以 typedef MyList 为 a `BaseList<MyItem>`，如下所示：

```
typedef BaseList<MyItem> MyList 
```

或者让 MyItem 派生自`Item<BaseList<MyItem> >`。

当您从一个类型派生时，您将创建一个不同的类型。当您 typedef 时，您为该类型创建了一个别名。所以当你 typedef 编译器会接受这个。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T11:30:10.877

除了您已经得到的答案之外，我还要指出标准库集合类不打算从中派生，因为它们没有虚拟析构函数，并且它们的成员函数都不是虚拟的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-27T11:28:08.057

不应该吧`tmp.owner = static_cast<MyList*>(this)`。E 的类型是 MyItem 中的 MyList ，因此 E* 将是 MyList* 。此指针的类型将是 BaseList*，因此编译器会给出无法将基类指针转换为派生类指针的错误。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T11:37:57.273

*当你不说你需要*什么时，很难说是否有更好的解决方案。为什么每个元素都需要一个指向它们存储的列表的指针？

无论如何，当您从标准容器继承时，可能会发生不好的事情。他们没有虚拟析构函数，所以你必须非常小心。

更好的解决方案可能是只提供一个执行 push_back 的免费函数：

```
template <typename T>
void push_back(std::list<T>& list, const T& t) {
        T tmp(t);
        tmp.owner = this;
        list.push_back(tmp);
} 
```

除了避免非虚拟析构函数问题外，它还解决了您的编译器错误，因为您现在只有一种类型的列表。

当然，如果我们一开始就知道为什么需要这个所有者指针，那么可能存在更好的解决方案。

**编辑**

为了回应您的编辑和评论，请使用组合，而不是继承：

```
struct House {
  std::string zipcode;
  std::list<Person> persons;

  void AddPerson(const Person& person) {
    Person tmp(person);
    tmp.owner = this; // The owner field should be a house, not the list of persons.
    persons.push_back(tmp);
  }
}; 
```

虽然我不喜欢你在 House 存储 Person 列表时获得的几乎循环引用，并且 Person 有一个指向它所在的 House 的指针。

我更愿意尽可能地解耦这些类。如果我想给某人寄信，我会调用 SendLetter(Person, House)。给那个房子里的这个人写一封信。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T19:47:06.380

**关于`const`：**`BaseList<MyItem> * const`编译器提到的类型是一个红鲱鱼 - 它不是指向对象的指针`const`，而是一个指针，*即* `const`不会改变的地址。（当你想到它时，`this`永远不要改变指向别的东西，不是吗？）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-27T12:05:14.380

我喜欢 jalf 的自由功能理念。我会做到的：

```
template <class X, class Y> // X must have a push_back(Y) member, Y must have an X* owner member
void push_back(X& container, Y value)
{
    value.owner = container;
    container.push_back(value);
} 
```

这对于通过的 X 是否是不可知的

*   容器本身，
*   源自原始代码中的容器
*   或包含一个容器并具有转发 push_back 功能

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-27T11:39:25.087

在旁注中，您不应该从 std 扩展任何类，它们不是为它构建的。

具体来说，它们没有虚拟析构函数，因此当您在指向基类的指针上调用 delete 时，您的派生类的析构函数将永远不会被调用。

您可以阅读更多关于[使用用户定义方法扩展 C++ STL 容器的更好方法的建议](https://stackoverflow.com/questions/679520/advice-on-a-better-way-to-extend-c-stl-container-with-user-defined-methods)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-27T16:46:21.363

正如已经指出的，做作

```
tmp.owner = this; 
```

失败，因为`this`没有与 . 相同的类型`tmp.owner`。一种解决方案是执行强制转换，但要这样做，您需要将容器类型提供给 BaseList。这可以使用 Item 中的 typedef 来完成。这是代码：

```
template <class Item> class BaseList
{      
  public:

    void push_back(Item i)
    {
        i.owner = static_cast<Item::containerType *>(this); // note the cast
        items.push_back(i);
    }

    Item & back() { return items.back(); }

  protected:
    std::list<Item> items;
};

template <class Container> class Item
{
    public:
        typedef Container containerType; // Typedef used by BaseList

        containerType* owner; // pointer to list that owns us. 
}; 
```

我还删除了公共推导`std::list`：正如许多人所说，这是（大多数情况下）最好避免的；您应该考虑使用组合，或者可能是私有继承。

PS：我尝试将Item设为`owner`私人和`BaseList<Item>::push_back`朋友，但我没能做到。有可能吗？（如果评论太长无法回答，请随时提出问题并回答）

# linux - 无法安装Linux的重命名为Mac

> ID：915174
> 
> 赞同：0
> 
> 时间：2009-05-27T11:16:49.313
> 
> 标签：linux, macos, rename

我阅读了建议我在 util-linux 包上运行的[教程](http://www.macosxhints.com/article.php?story=20050630022203488)

```
./configure 
```

我明白了

```
configuring util-linux-2.12q

You don't have <scsi/scsi.h>
You don't have <linux/blkpg.h>
You don't have <linux/kd.h>
You have <locale.h>You have <langinfo.h>
You have <sys/user.h>
You have <uuid/uuid.h>
You have <rpcsvc/nfs_prot.h>
You don't have <asm/types.h>
You don't have <linux/raw.h>
You have <stdint.h>
You don't have <sys/io.h>
You have inet_aton()
You have fsync()
You have getdomainname()
You have nanosleep()
You don't have personality()
You don't have updwtmp()
You have fseeko()
You have lchown()
You don't have rpmatch()
You have <term.h>
You have ncurses. Using <ncurses.h>.
You have termcap
You don't need -lcrypt
Strange... Static compilation fails here.
You don't have native language support
You have __progname
You don't have <pty.h> and openpty()
You have wide character support
You don't have SYS_pivot_root
You have a tm_gmtoff field in struct tm
Your rpcgen output does not compile - using pregenerated code
You have zlib
You don't have blkid 
```

然后它建议我在 misc-utils 运行以下命令

```
make rename 
```

我收到以下警告

```
cc -pipe -O2 -mtune=i386 -fomit-frame-pointer -I../lib -Wall -Wmissing-prototypes -Wstrict-prototypes -DNCH=1   -D_FILE_OFFSET_BITS=64 -DSBINDIR=\"/sbin\" -DUSRSBINDIR=\"/usr/sbin\" -DLOGDIR=\"/var/log\" -DVARPATH=\"/var\" -DLOCALEDIR=\"/usr/share/locale\" -O2  -s  rename.c   -o rename
ld warning: option -s is obsolete and being ignored 
```

**如何为 Mac 安装 rename -command？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T11:28:38.290

这是一个警告，而不是错误。

我自己刚刚尝试过，它已经构建了一个重命名可执行文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T19:46:41.543

[使用Homebrew](http://mxcl.github.io/homebrew/)轻松安装重命名

```
brew install rename 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T03:43:21.887

`rename`从linux编译。[本教程](http://hints.macworld.com/article.php?story=20050630022203488)中的指示有一些细微差别。我使用了[util-linux-2.22.tar.gz文件中的 2.22 版本](http://www.kernel.org/pub/linux/utils/util-linux/v2.22/util-linux-2.22.tar.gz)

下载并解压缩。转到终端中的未压缩文件夹。

不要只是运行`./configure`，而是使用带有标志的这个命令：

`./configure --disable-su --disable-sulogin --disable-login`

然后从同一个文件夹中，而不是更改为 misc-utils，您可以`make rename`

就是这样，在当前文件夹中，您将拥有可执行文件，如果需要，您将在 misc-utils 中获得 man 文档。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T11:23:31.873

你不能只使用`mv`而不是尝试编译`rename`吗？甚至可能将其别名为`rename`?

（编辑：忽略我对 build-essentials 的评论——[正如 yangyang 所指出的](https://stackoverflow.com/questions/915174/915219#915219)，它看起来应该已经构建好了）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-11T01:07:09.883

尝试这个：

```
function rename { from=$1; to=$2; shift 2; for i in "$@"; do j=`echo $i | sed "s/$from/$to/"`; mv "$i" "$j"; done } 
```

将其粘贴到您的 .profile 或 .bashrc 中并像 Red Hat 重命名实用程序一样运行它：

```
$rename foo bar *.txt 
```

将 foo1.txt、foo2.txt 和 foofoo.txt 变成 bar1.txt、bar2.txt，但有点恼人的是 barfoo.txt。
也许有人可以调整它来解决这个问题。

通过将 'echo' 放在 'mv' 之前对其进行测试，以便它输出将进行的所有更改的列表而不进行更改。

# perl - 如何使用 Perl 从 HTML 文件中提取链接？

> ID：915175
> 
> 赞同：0
> 
> 时间：2009-05-27T11:17:01.370
> 
> 标签：perl, excel

我有一些输入链接，我想打开该链接。例如，我有一个 HTML 文件，想要查找文件中的所有链接并在 Excel 电子表格中打开它们的内容。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T12:14:01.473

听起来您想要我的[HTML::SimpleLinkExtor](http://search.cpan.org/dist/HTML-SimpleLinkExtor)模块中的链接牵引器脚本。

您可能还对我的[webreaper](http://search.cpan.org/dist/webreaper/)脚本感兴趣。很久很久以前，我写这篇文章是为了做一些接近同样任务的事情。我真的不推荐它，因为其他工具现在好多了，但你至少可以看看代码。

[CPAN](http://search.cpan.org/)和[Google](http://www.google.com)是您的朋友。:)

[Mojo::UserAgent](http://www.metacpan.org/module/Mojo::UserAgent)在这方面也很不错：

```
use Mojo::UserAgent

print Mojo::UserAgent
    ->new
    ->get( $ARGV[0] )
    ->res
    ->dom->find( "a" )
    ->map( attr => "href" )
    ->join( "\n" ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T11:41:56.343

这听起来像是[WWW::Mechanize](http://search.cpan.org/dist/WWW-Mechanize/lib/WWW/Mechanize.pm)的工作。它提供了一个相当高级的接口来获取和研究网页。

一旦你阅读了文档，我想你就会知道如何去做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-19T18:08:41.680

还有[Web::Query](http://metacpan.org/releases/Web-Query)：

```
#!/usr/bin/env perl 

use 5.10.0;

use strict;
use warnings;

use Web::Query;

say for wq( shift )->find('a')->attr('href'); 
```

或者，从 cli：

```
$ perl -MWeb::Query -E'say for wq(shift)->find("a")->attr("href")' \
       http://techblog.babyl.ca 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-20T04:53:44.350

我过去曾为此使用过[URI::Find](https://metacpan.org/pod/release/MSCHWERN/URI-Find-20140709/lib/URI/Find.pm)（当文件不是 HTML 时）。

# c++ - 你最喜欢的用于 c/c++ 开发的 eclipse 插件是什么？

> ID：915176
> 
> 赞同：4
> 
> 时间：2009-05-27T11:17:29.890
> 
> 标签：c++, c, eclipse, plugins, eclipse-cdt

除了 CDT，您还发现使用 eclipse 进行 c 开发的必要条件是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T12:16:48.037

如果您在 Linux 上进行开发，那么[Linux Tools](http://www.eclipse.org/linuxtools/)非常有用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-30T12:43:20.817

这些是我最喜欢的：

*   `cppcheck`（静态代码分析）
*   `valgrind`（查找内存泄漏）
*   `google test`（使单元测试非常容易）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T12:11:54.490

[用于svn](http://subclipse.tigris.org/)集成的子剪辑

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-08-12T20:09:45.490

Qt Eclipse 集成插件：http: [//qt.nokia.com/developer/eclipse-integration](http://qt.nokia.com/developer/eclipse-integration)

需要 Qt4.5。插件和 Qt 都是免费的……就像啤酒和自由一样！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-28T17:12:04.137

我通常使用 cmake 来构建 C++ 项目。最近我一直在使用 Eclipse CDT4 生成器，它工作得非常好，请参阅[此链接](http://www.vtk.org/Wiki/Eclipse_CDT4_Generator)或[此](http://www.vtk.org/Wiki/CMake:Eclipse)链接。

我已经在 Linux 上尝试过，但我对 Windows 没有。我知道这个[项目](http://wascana.sourceforge.net/)正在尝试使用 Eclipse 在 Windows 上使用 C++ 进行更轻松的开发，但它仍然有待处理的事情。

# c# - Simulate keypress in a non-visible webbrowser object C#

> ID：915177
> 
> 赞同：3
> 
> 时间：2009-05-27T11:17:31.963
> 
> 标签：c#, .net, html, ajax, browser

I'm currently working in an application that has to navigate a webpage and recollect data about products, prices, ... with webbrowser object in .net 3.5.

The problem is that the page has some fields with a suggest script in ajax, and I can't simply modify the innerText property because the script also saves codes in a hidden input field.

I need a way to simulate the typing in that field and then send the "Enter" key, or launch the ajax script and then send the "Enter" key, or any better ways to do this.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T11:21:50.737

Use [Watin](http://watin.sourceforge.net/)

Then you can [use this solution](https://stackoverflow.com/questions/856766/can-i-pass-a-key-stroke-i-e-enter-key-into-application-using-watin-scripts/857953#857953).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T11:30:36.960

To submit a form or run a script you can do this: If you know the script name you can use InvoekScript of Document object:

```
myWebBrowser.Document.InvokeScript("script-name",null); 
```

the second argument is an array of objects to pass parameters values.

if you know the name of an element that it's click event fires the script you can do this:

```
HtmlElement element=myWebBrower.Document.GetElementById("element-name")[0];
element.InvokeMember("click"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-10T00:16:59.770

There are a few ways to do this with the standard WebBrowser control.

**For HTML:** If you want to fillout a textbox and then click submit then don't even bother with a keypress. Do this:

```
webbrowser1.Navigate("javascript:function%20E(){f0=document.forms[0];f0['login'].value='foo';}E()")
webbrowser1.Navigate("javascript:document.forms[0].submit()") 
```

This will be much more reliable then trying to send keypresses for HTML.

**For Flash:**If there's a flash element on the webpage that needs clicking then it won't work. In that case SendKeys is reliable but only sends to the active application so it won't work in the background. You can send windows messages like this (example will press the letter "f"):

```
Dim c as char = "f"c
Dim classname As New System.Text.StringBuilder(100)
Dim ExplorerHandle As IntPtr = webbrowser1.Handle
GetClassNameA(ExplorerHandle, classname, classname.Capacity)
Do While classname.ToString <> "Internet Explorer_Server"
    ExplorerHandle = GetWindow(GetExplorerHandle, GetWindow_Cmd.GW_CHILD)
    GetClassNameA(ExplorerHandle, classname, classname.Capacity)
Loop

PostMessageA(ExplorerHandle, WM_Constants.WM_KEYDOWN, IntPtr.Zero, IntPtr.Zero)
PostMessageA(ExplorerHandle, WM_Constants.WM_KEYUP, CType(VkKeyScanA(CType(Asc(c), Byte)), IntPtr), IntPtr.Zero) 
```

You can find the definitions for PostMessage, GetClassName, GetWindow, etc, online at pinvoke.net. Notice that the WM_KEYUP uses c but the WM_KEYDOWN sends a dummy key (0). KEYDOWN and KEYUP have to go in pairs or else the key won't be registered, but if you hold down Control while sending, for example, KEYDOWN "p", it will activate IE's print function. For all the letters and digits you can send 0 for KEYDOWN and the correct letter for KEYUP. Backspace seems to need a real KEYDOWN, not 0, but Control-Backspace doesn't seem to do much in IE so if c = vbBack, KEYDOWN needs to be different.

The keypresses aren't very accurate, either, and 1 time in about 500 it misses. But you can do it with the window minimized, no problem, and a standard WebBrowser control.

Another option is to use AxWebBrowser. The ActiveX control seems to avoid the Control-P problem but it's not as easy to manipluate because it isn't a nice .Net control.

# security - 一个业务线应用程序审计哪些安全事件？

> ID：915178
> 
> 赞同：3
> 
> 时间：2009-05-27T11:17:38.623
> 
> 标签：security, logging, auditing

我已经审核了授权成功、失败和注销。

我考虑过审计（记录）每个方法调用并保留曾经修改过的每一行和每一列的版本，但是这两个选项都会大大增加审计的复杂性。审计一个随机子集太随机了。

法律规范（FISMA、C&A）只是说需要审计一些东西。

还有其他我忘记的非域特定审计策略吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T11:28:17.403

考虑到审计通常与**问责制**有关，您可能希望记录那些可能导致**某人/某事需要负责的任何事件**的行为..

1.  更改客户记录
2.  配置变更
3.  数据删除

保留其中一些内容的版本是一个好主意，这样您就可以回滚对重要数据的更改。首先添加“谁改变了”非常简单。

除非有人可以直接访问数据库，否则通常应用程序记录任何影响数据库的事件……例如更改许多表的事务……可能就足够了。只要您可以将可审计的逻辑操作与责任的逻辑单元联系起来，无论它影响哪个子系统，您都应该能够追踪责任。

您不应该直接记录方法调用和数据库更改，而是记录导致这些调用和更改的业务逻辑，以及使用该逻辑的人。少量后端代码**链接调用/表更改和一些审计消息之间的因果关系**也将是有益的（如果你有资源）。

将您的应用程序的审计元素视为事件树。根是您记录的内容，例如“Dave 已删除客户记录 2938”。*可以*记录根的任何子节点，如果将其作为审计事件的一部分进行记录很重要，您可以将其绑定到根。例如，您可以断言某些审计事件“Dave deleted ...”与某些计费信息相关联，并且作为约束或某些东西的一部分也将被随身携带

但我不是专家。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T20:22:18.370

我同意 Aiden 所说的很多内容，但我坚信审计应该在数据库级别进行。使用动态 sql 访问的数据库太多，因此权限位于表级别（至少在 SQL Server 中）。因此，进行欺诈的人可以绕过所有规则在数据库中输入删除或更改数据。在一个设计良好的系统中，只有几个人（dba 和备份）有权更改 prod 中的审计触发器，因此如果他们更改未经授权更改的数据，大多数人可能会被抓住。通过应用程序进行审计永远不会抓住这些人。当然，如果 dbas 选择这样做，几乎没有办法防止他们进行欺诈，但是必须有人对数据库具有管理员权限，所以在选择这样的人时必须格外小心。

我们审计数据库中大多数表的所有数据更改、所有插入和所有删除。这允许轻松退出更改并提供审计跟踪。根据您的数据库存储的内容，您可能不需要这样做。但我会审计每一笔金融交易、每一笔人事交易，以及每一笔与订单、仓储或其他任何可能涉及犯罪活动的交易。

如果您真的想知道绝对必须审核的内容，请与将要审核您的人交谈，并询问他们想要查看的内容。

# c# - 在 C# 的 html 文档中匹配此模式的正则表达式是什么？

> ID：915191
> 
> 赞同：0
> 
> 时间：2009-05-27T11:21:30.880
> 
> 标签：c#, .net, regex

我真的不知道如何最好地做到这一点，我可以做相当简单的正则表达式，但更复杂的表达式真的难倒我。

以下内容出现在特定的 HTML 文档中：

```
<span id="label">
<span>
<a href="http://variableLink">Joe Bloggs</a>
now using
</span>
<span>
'
<a href="/variableLink/">Important Data</a>
'
</span>
<span>
on
<a href="/variableLink">Important data 2</a>
</span>
</span> 
```

我需要提取两个“重要数据”点，并且可能会花费数小时来计算正则表达式来完成它。（我在 C# 3.5 中使用.net Regex Library）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T11:26:14.613

如前所述，正则表达式通常不是解析 HTML、XML 和朋友的正确工具——考虑使用 HTML 或 XML 解析库。如果您真的想或必须使用正则表达式，以下内容在很多情况下会匹配标签的内容，但在某些情况下可能仍然会失败。

```
<a href="[^"]*">(?<data>[^<]*)</a> 
```

此表达式将匹配所有不以开头的链接`http://`- 这是我可以看到的链接之间唯一明显的区别。

```
<a href="(?!http://)[^"]*">(?<data>[^<]*)</a> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T11:51:11.630

下面使用[HtmlAgilityPack](http://www.codeplex.com/htmlagilitypack)。它会在“标签”ID 内的第二个或以后的链接中打印任何文本。当然，修改 XPath 以做一些不同的事情相对简单。

```
 HtmlDocument doc = new HtmlDocument();
    doc.Load(new StringReader(@"<span id=""label"">
<span>
<a href=""http://variableLink"">Joe Bloggs</a>
now using
</span>
<span>
'
<a href=""/variableLink/"">Important Data</a>
'
</span>
<span>
on
<a href=""/variableLink"">Important data 2</a>
</span>
</span>
"));
    HtmlNode root = doc.DocumentNode;

    HtmlNodeCollection anchors;
    anchors = root.SelectNodes("//span[@id='label']/span[position()>=2]/a/text()");
    IList<string> importantStrings;
    if(anchors != null)
    {
        importantStrings = new List<string>(anchors.Count);
        foreach(HtmlNode anchor in anchors)
        importantStrings.Add(((HtmlTextNode)anchor).Text);
    }
    else
        importantStrings = new List<string>(0);

    foreach(string s in importantStrings)
        Console.WriteLine(s); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T11:31:07.957

查找 .NET 的后视和前瞻语法，并使用它来查找 HTML 中的锚标记。[这个网站](http://regular-expressions.info)可以帮助你。作为正则表达式的替代方法，您可以考虑使用 a`System.Xml.XPath.XPathNavigator`直接寻址这些节点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T11:33:34.193

我的正则表达式有点生疏，但以下内容可能会有所帮助（尽管它可能需要一些微调）：

```
(?<=\<a href="/variableLink[/]?"\>)(.*)+(?=</a>) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T11:44:16.997

```
 <a\shref.*?"/variableLink/?">(.*)</a> 
```

第一组包含锚的名称。用 Expresso 测试。适用于您提供的示例文本。
**更新**：也适用于 Snippy。

```
Regex regex = new Regex(@"<a\shref.*?""/variableLink/?"">(.*)</a>", RegexOptions.Multiline);
foreach (Match everyMatch in regex.Matches(sText))
{
  Console.WriteLine("{0}", everyMatch.Groups[1]);
} 
```

输出：

```
Important Data
Important data 2 
```

# django - Django评论垃圾邮件

> ID：915204
> 
> 赞同：4
> 
> 时间：2009-05-27T11:25:27.267
> 
> 标签：django, spam-prevention

评论框架中 Django 的反垃圾邮件系统效果如何？你用过吗？它大致阻止了多少百分比的评论垃圾邮件？您还有什么其他措施可以帮助防止使用 Django 评论框架的网站上的垃圾评论吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T11:40:35.380

[Askimet](http://www.voidspace.org.uk/python/akismet_python.html)有一个 Python API 。这是 wordpress 用来阻止垃圾邮件的方法（而且效果很好）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-08-02T14:15:08.160

默认情况下，Django 仅提供蜜罐字段和哈希检查以防止垃圾邮件。它阻止了很多垃圾邮件，但绝对不是全部。我猜大概是50-70%左右。对于我每天只有不到 50 个独立访问者的非常小的网站，这就是所需要的。对于较大的站点，您肯定需要像 Akismet 这样的额外保护。

# javascript - Javascript：验证在 ASP.NET 中动态创建的单选按钮列表控件

> ID：915205
> 
> 赞同：0
> 
> 时间：2009-05-27T11:25:35.037
> 
> 标签：javascript, jquery, validation, radio-button

我有一个 ASPX 页面，在页面加载中我动态创建一些单选按钮列表控件并呈现给浏览器。我将在每个单选按钮列表中有 2 个列表项。一个是是，第二个是否。单选按钮列表的数量可以是 n.Now 在我的 java 脚本代码中，我想知道单击了哪个单选按钮。我已经在使用 jQuery 了。有什么简单的方法来处理这个问题吗？

我呈现给浏览器的 HTML 是

```
<table border="0" id="tblQuestions">
    <tr>
        <td>Do you have a valid passport ?</td>
    </tr><tr>
        <td><table id="answer-1" border="0">
            <tr>
                <td><input id="answer-1_0" type="radio" name="answer-1" value="1" /><label for="answer-1_0">Yes</label></td>
            </tr><tr>
                <td><input id="answer-1_1" type="radio" name="answer-1" value="0" /><label for="answer-1_1">No</label></td>
            </tr>
        </table></td>
    </tr><tr>
        <td>Are you married ?</td>
    </tr><tr>
        <td><table id="answer-2" border="0">
            <tr>
                <td><input id="answer-2_0" type="radio" name="answer-2" value="1" /><label for="answer-2_0">Yes</label></td>
            </tr><tr>
                <td><input id="answer-2_1" type="radio" name="answer-2" value="0" /><label for="answer-2_1">No</label></td>
            </tr>
        </table></td>
    </tr>
</table> 
```

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T13:27:18.113

以下代码并未具体回答您的问题，但它可能会有所帮助。我会为你修改它，但我现在没有时间。

我在考试中使用它，以警告用户某个特定问题没有选定的答案。

这些问题是使用发出普通 xhtml 的服务器控件动态生成的。我用相同的名称命名所有选项，（Q1，Q2...），并将它们标识为（Q1a，Q1b ...）

为了根据您的目的对其进行修改，也许您可​​以在 j 循环中构建一个选定选项的列表，即在“break”语句所在的位置添加名称-值对。

```
// Grabs all inputs - radio, checkbox, text, buttons and lists -sticks them in an array
allInputs = document.getElementsByTagName("input");
var last = "NameUnlikelyToBeUsedAsAnElementName";

// walk through the array
for (i = 0; i< allInputs.length; i++)
{
    var input = allInputs[i];
    if (input.name == last) continue; // if this object name is the same as the last checked radio, go to next iteration

    // checks to see if any  one of  similarly named radiobuttons is checked 
    else if (input.type == "radio" )
    {    
        last = input.name;  
        var radios = document.getElementsByName(input.name);
        var radioSelected=false;

         //iterate over question options
        for (j=0; j < radios.length; j++)
        {
            if(radios[j].checked)
            {
               radioSelected=true;
               break; // Found it, proceed to next question 
            }
        }
        if (!radioSelected) // no option selected
        {       // warn user, focus question
            alert("You did not answer question " + input.id.substring(0,input.id.length-1));
            input.focus();
            return false;
        }                   
    }

}

return true; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T11:38:33.620

这是假设您的页面中已经包含 jquery。

在您的单选按钮项目上定义一个类，基本上您的客户端 HTML 应该看起来像`<input id="answer-2_1" type="radio" name="answer-2" value="0" class="myrdo" />`

现在，在您的 js 代码中，只需在类上连接一个事件处理程序

```
$(".myrdo").bind("click",function(){if($(this).attr("checked")==true) {alert($(this).val);} }); 
```

上面的命令将简单地提醒所选单选按钮的值。

# performance - IIS监控工具

> ID：915207
> 
> 赞同：5
> 
> 时间：2009-05-27T11:25:53.227
> 
> 标签：performance, iis, monitoring

我需要一个工具来监控 IIS 上的请求，更重要的是记录请求。该工具必须报告有关请求的基本信息，例如请求的日期/时间、请求花费的时间、传输的千字节数……等

你们用什么来进行这种监控？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T13:17:50.300

您应该扩展并添加所有要记录的 IIS 属性。

为此，请执行以下操作：

1.  进入 IIS
2.  在您的网站上选择属性。
3.  在网站选项卡下，在日志记录部分中选择属性。
4.  选择扩展属性选项卡。
5.  选择扩展属性
6.  选择您要记录的所有项目。

重置 IIS。

您现在可以使用日志解析器来查看日志。[http://www.smartertools.com/](http://www.smartertools.com/)有一个不错的，叫做 smarter stats，对一个小网站是免费的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T11:28:14.687

您可以使用 IIS 的日志文件并使用[Log Parser](http://www.microsoft.com/DownLoads/details.aspx?FamilyID=890cd06b-abf8-4c25-91b2-f8d975cf8c07&displaylang=en)（从 MS 免费下载）读取它们。

回应评论：IIS 日志文件的格式可以在此处找到：[IIS 日志文件格式 (IIS 6.0)](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/be22e074-72f8-46da-bb7e-e27877c85bca.mspx?mfr=true)和[此处](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/676400bc-8969-4aa7-851a-9319490a9bbb.mspx?mfr=true)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T11:38:13.527

IIS 日志文件 + 日志分析器。

[像webtrends](http://www.webtrends.com/)这样的日志分析器会给你很多信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T13:28:11.607

您可以查看 System Center 系列的 Operations Manager。- [http://www.microsoft.com/systemcenter/operationsmanager/en/us/default.aspx](http://www.microsoft.com/systemcenter/operationsmanager/en/us/default.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-04T06:49:25.473

请参阅 eginnovations IIS Web 服务器监控工具 - [http://www.eginnovations.com/web/iismonitor.htm](http://www.eginnovations.com/web/iismonitor.htm)

# c# - 如何获取当前用户的“应用程序数据”文件夹的路径？

> ID：915210
> 
> 赞同：40
> 
> 时间：2009-05-27T11:26:19.760
> 
> 标签：c#, path, appdata

1）我怎样才能找到用户正在使用的 Windows 安装驱动器。？我需要这个导航到 DocumentsandSettings 中的**ApplicationData**。

2）另外我怎样才能获得**用户名**，以便我可以转到ApplicaitionData。？例如：“D:\Documents and Settings\user\Application Data”。

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-05-27T11:29:08.600

看看结合[Environment.GetFolderPath](http://msdn.microsoft.com/en-us/library/system.environment.getfolderpath.aspx)和[Environment.SpecialFolder](http://msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx)来做到这一点。

```
Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-05-27T11:46:29.707

根据你在做什么，你可能还想看看

```
Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData) 
```

如果用户在域中，它将仅存储在他们的本地`AppData`文件夹中，并且不会与他们的漫游配置文件同步。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-27T11:29:33.920

看看[`Environment.SpecialFolders`](http://msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx)

```
Environment.SpecialFolder.ApplicationData;
Environment.SpecialFolder.System 
```

这也应该让你绕过用户名要求。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-27T11:31:17.723

查看 System.Environment 类及其属性和方法，例如：

```
string systemDir = System.Environment.SystemDirectory;
string docs = System.Environment.GetFolderPath(
    System.Environment.SpecialFolder.MyDocuments));

string systemDrive = System.IO.Path.GetPathRoot(systemDir); 
```

例如，第一个返回“ **C:\Windows\system32** ”，第二个返回“ **C:\Documents and Settings\USERNAME\My Documents** ”。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-27T11:29:52.203

试试这个：

```
string filePath = Environment.GetFolderPath(System.Environment.SpecialFolder.ApplicationData); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-02-17T11:29:28.017

> 1）我怎样才能找到用户正在使用的 Windows 安装驱动器。？

```
 var systemDrive =  Environment.ExpandEnvironmentVariables("%systemdrive%"); 
```

> 我需要这个导航到 DocumentsandSettings 中的 ApplicationData。

您实际上并不需要获取系统驱动器的值或当前登录的用户名来实现此目的。有预定义的环境变量`%localAppData%`，`%appData%`它们为您提供这些目录的完全限定路径，如下面的代码所示：

```
var localApplicationData = Environment.ExpandEnvironmentVariables("%localappdata%"); 
//this gives C:\Users\<userName>\AppData\Local

var roamingApplicationData = Environment.ExpandEnvironmentVariables("%appdata%");
//this gives C:\Users\<userName>\AppData\Roaming 
```

> 2）另外我怎样才能获得用户名，以便我可以转到ApplicaitionData。？例如：“D:\Documents and Settings\user\Application Data”。

同样，您不需要用户名来获取我上面讨论的应用程序数据路径。不过，为了知识起见，您可以从`%username%`环境变量中获取它，如下所示：

```
 var currentUserName = Environment.ExpandEnvironmentVariables("%username%"); 
```

# c# - 从代码中为 WPF 中的 MatrixTransform 设置动画

> ID：915212
> 
> 赞同：2
> 
> 时间：2009-05-27T11:26:41.430
> 
> 标签：c#, wpf, animation, matrix, transform

我有一个 Canvas，我需要为它的 RenderTransform 属性设置动画。开始和结束矩阵将是任意的，所以我不能在 XAML 中预先编写故事板，所以我试图用代码来做，我找不到任何如何做到这一点的例子，下面是我最好的尝试这不起作用（它编译并运行，但 rendertransform 不会改变）。

关于如何做到这一点的任何建议？

```
MatrixAnimationUsingKeyFrames anim = new MatrixAnimationUsingKeyFrames();
MatrixKeyFrameCollection keyframes = new MatrixKeyFrameCollection();
DiscreteMatrixKeyFrame start = new DiscreteMatrixKeyFrame(fromMatrix, KeyTime.FromPercent(0));
DiscreteMatrixKeyFrame end = new DiscreteMatrixKeyFrame(toMatrix, KeyTime.FromPercent(1));

keyframes.Add(start);
keyframes.Add(end);
anim.KeyFrames = keyframes;

Storyboard.SetTarget(anim, World.RenderTransform);
Storyboard.SetTargetProperty(anim, new PropertyPath("Matrix"));

Storyboard sb = new Storyboard();
sb.Children.Add(anim);
sb.Duration = TimeSpan.FromSeconds(4);
sb.Begin(); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-12-06T21:24:41.000

我已经实现了支持平滑平移、缩放和旋转动画的 MatrixAnimation 类。它还支持缓动功能！在[http://pwlodek.blogspot.com/2010/12/matrixanimation-for-wpf.html找到](http://pwlodek.blogspot.com/2010/12/matrixanimation-for-wpf.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-12-30T23:08:21.687

我设法通过设置渲染源和使用 beginanimation 来让 matrixtransform 工作

像这样的东西：

```
 this.matrixTransform = new MatrixTransform();
        this.canvas.RenderTransform = this.matrixTransform;

        MatrixAnimationUsingKeyFrames anim = new MatrixAnimationUsingKeyFrames();
        anim.KeyFrames = new MatrixKeyFrameCollection();
        anim.Duration = TimeSpan.FromSeconds(4);

        Matrix fromMatrix = new Matrix(2, 0, 0, 2, 0, 0);
        Matrix toMatrix =  new Matrix(3, 0, 0, 3, 0, 0);

        anim.FillBehavior = FillBehavior.HoldEnd;
        DiscreteMatrixKeyFrame start = new DiscreteMatrixKeyFrame(fromMatrix, KeyTime.FromTimeSpan(TimeSpan.FromSeconds(0)));
        DiscreteMatrixKeyFrame end = new DiscreteMatrixKeyFrame(toMatrix, KeyTime.FromTimeSpan(TimeSpan.FromSeconds(4)));

        anim.KeyFrames.Add(start);
        anim.KeyFrames.Add(end);

        this.matrixTransform.BeginAnimation(MatrixTransform.MatrixProperty, anim); 
```

不确定我将如何自己对所有关键帧进行插值:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-04-19T16:15:30.117

今天早上我遇到了这个问题，尽管我使用的解决方案无法应对旋转或剪切。[关联](https://stackoverflow.com/questions/1988421/smooth-animation-using-matrixtransform/2666702#2666702)

# ruby-on-rails - 可点击的幻灯片放映，图像存储在数据库中

> ID：915234
> 
> 赞同：0
> 
> 时间：2009-05-27T11:31:26.663
> 
> 标签：ruby-on-rails

我有一个名为图像的表，其中包含从属性图像到房地产徽标的大量图像...我编写了一个 ruby​​ 代码来获取所有工作正常的属性图像...我唯一的问题是我想要图像显示为可点击的幻灯片，而不是显示所有图像

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T20:51:51.587

这更像是一个 Javascript/Flash 问题，而不是 Rails 问题。Lightview 是一个很好的解决方案：[http ://www.nickstakenburg.com/projects/lightview/](http://www.nickstakenburg.com/projects/lightview/)

# html - 如何选择具有两个类名的 html 元素？

> ID：915235
> 
> 赞同：6
> 
> 时间：2009-05-27T11:32:17.423
> 
> 标签：html, css, frontend

IE7 不支持 :last-child 伪选择器。我正在考虑显式添加一个类名以将其表示为最后一个元素，但不确定如何在 css 文件中选择此元素。有人对如何做到这一点有任何想法吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-27T11:34:00.493

```
.class1.class2 {color:red} 
```

和

```
<div class="class1 class2"></div> 
```

或安装[IE7-js](http://code.google.com/p/ie7-js/)和 :last-child 将“正常工作”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T11:35:35.483

如果你有

```
<div class="element"/>
<div class="element last"/> 
```

你可以做

```
div.element
{
   // styles effect both divs
}

div.last
{
    // style will only effect the second element and overides because lower in the css
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T11:55:13.587

关于多个类名需要注意的另一件事是 IE6 无法正确处理它们。它只会考虑列表中的最后一个类名：

```
.class1.class2 {color:red} => .class2 in IE6 
```

# javascript - 如何匹配javascript和正则表达式？

> ID：915245
> 
> 赞同：0
> 
> 时间：2009-05-27T11:37:11.753
> 
> 标签：javascript, html, regex

我有以下 HTML：

```
<span id="UnitCost5">$3,079.95 to $3,479.95</span> 
```

我想使用 Javascript 和 Regex 来获取所有数字匹配。

所以我希望我的脚本函数返回：3,079.95 AND 3,479.95

请注意，文本可能会有所不同，所以我需要尽可能通用的解决方案，可能是这样的：

```
<span id="UnitCost5">$3,079.95 And Price $3,479.95</span> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T11:46:16.633

所有数字将匹配：

```
\.?\d[\d.,]* 
```

这假设您要查找的数字可以以小数点开头。如果他们不能，这将起作用（并且可能产生更少的误报）：

```
\d[\d.,]* 
```

请注意，数字格式存在不同的当地习俗。

我假设您使用适当的方法来获取您希望处理的 HTML 节点的文本值，并且 HTML 解析不是练习的一部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T11:50:19.230

您不想捕获*所有*数字，否则您也会在 id 中获得 5。我猜，你要找的是这样的数字：`$#,###.##`

这是表达式：

```
/\$[0-9]{1,3}(,[0-9]{3})*(\.[0-9]+)?/ 
```

*   **`\$`**美元符号
*   **`[0-9]{1,3}`**一到三位数
*   **`(,[0-9]{3})*`**[可选]：数字三元组，以逗号开头
*   **`(\.[0-9]+)?`**[可选]：更多数字，前面有句点

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T11:52:58.287

```
/(?:\d{1,3},)*\d{1,3}(?:\.\d+)?/g; 
```

让我们把它分成几部分来解释：

*   (?:\d{1,3},)* - 匹配任何由千位分隔符分隔的数字
*   \d{1,3} - 匹配小数点前的数字
*   (?:.\d+) - 匹配任意数量的小数
*   标志 'g' - 进行全局搜索以查找字符串中的所有匹配项

你可以像这样使用它：

```
var regex = /(?:\d{1,3},)*\d{1,3}(?:\.\d+)?/g;
var numbers = "$3,079.95 And Price $3,479.95".match(regex);
// numbers[0] = 3,079.95
// numbers[1] = 3,479.95 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T11:46:49.063

以下是一个非常简单的解决方案。请注意，它还会匹配一些无效的数字字符串，例如`$..44,.777`.

```
\$[0-9,.]+ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T11:48:15.270

```
(function () {
    var reg = /\$([\d\.,]+)\s[\w\W]+\s\$([\d\.,]+)$/;

    // this function used to clean inner html
    function trim(str) {
        var str = str.replace(/^\s\s*/, ''),
            ws = /\s/,
            i = str.length;
        while (ws.test(str.charAt(--i)));
        return str.slice(0, i + 1);
    }

    function getNumbersFromElement(elementId) {
        var el = document.getElementById(elementId),
            text = trim(el.innerHTML), 
            firstPrice,
            secondPrice,
            result;

        result = reg.exec(text);

        if (result[1] && result[2]) {
            // inside this block we have valid prices
            firstPrice = result[1];
            secondPrice = result[2];
            // do whatever you need
            return firstPrice + ' AND ' + secondPrice;
        } else {
            return null; // otherwise 
        }
    }
    // usage:
    getNumbersFromElement('UnitCost5');
})(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T11:52:50.533

以下将返回在字符串中找到的所有价格的数组

```
function getPrices(str) {
    var reg = /\$([\d,.]+)/g;
    var prices =[];
    var price;
    while((price = reg.exec(str))!=null) {
        prices.push(price);
    }
    return prices;
} 
```

编辑：请注意，正则表达式本身可能会返回一些误报

# asp.net - 在 RowDataBound 上添加 CSS 类

> ID：915248
> 
> 赞同：10
> 
> 时间：2009-05-27T11:38:03.387
> 
> 标签：asp.net

我正在尝试将 CSS 类附加到 RowDataBound 上的一行。我正在对 GridView 使用交替的 css 类属性，所以我假设这应用于 RowDataBound。如果您以编程方式将 CSS 类分配给 RowDataBound 事件中行的 CssClass 属性，则不会应用交替行样式 css 类，*即使您附加了 CSS 类*。

这是我所拥有的：

```
Protected Sub gvGeneral_RowDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewRowEventArgs) Handles gvGeneral.RowDataBound
    If e.Row.RowType = DataControlRowType.DataRow Then
      If previousExpenseType <> e.Row.Cells(2).Text And previousExpenseType.Length > 0 Then
        e.Row.CssClass += "bottom-border"
      End If

      previousExpenseType = e.Row.Cells(2).Text
    End If
  End Sub 
```

`previousExpenseType`只是一个字符串，我正在与之进行比较。如果费用类型发生变化，那么我希望在`<tr>`元素底部应用边框。

任何想法如何解决这个问题？在 RowDataBound 之后似乎有一个事件将交替行样式 css 类应用于该行。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-27T13:30:07.360

在您的 RowDataBound 事件处理程序中尝试此操作...

```
protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
{
    GridView grid = GridView1;
    GridViewRow row = e.Row;
    if (row.RowType == DataControlRowType.DataRow)
    {
        bool isAlternating = row.RowState == DataControlRowState.Alternate;

        List<string> classes = new List<string>();

        /*  Setting the CssClass of a row overwrites any CssClass declared in the 
         *  markup, so lets save the value that is in the markup and add to it.
         */
        if (isAlternating) { classes.Add(grid.AlternatingRowStyle.CssClass); }
        else { classes.Add(grid.RowStyle.CssClass); }

        //
        //logic for adding other css classes to the row...
        //

        //set the CssClass property of the row to the combined css classes value
        row.CssClass = string.Join(" ", classes.ToArray());

        //
        //more row processing...
        //
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T11:58:07.327

您可能想要尝试的另一种解决方法是在所有行都数据绑定之后执行检查和 CSS 类操作，方法是使用后面的 gridview 事件之一并自己循环遍历行。我知道这会增加一些额外的处理时间，但根据您显示的数据集的大小，这可能是值得的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-27T11:47:31.280

Gridview rowdatabound 只允许您在 TR 中操作 HTML，因此您可能无法选择使用 gridView 执行您想要执行的操作。相反，我建议使用Repeater，它可以让您更好地控制您生成的HTML。这是您可以使用中继器执行的操作

```
<table>
    <thead>
        <tr><td>Head1</td><td>Head2</td></tr>
    </thead>
    <asp:Repeater ID="rptTaskItems" runat="server">
        <ItemTemplate>
             <tr><td>column 1 data</td>
                 <td>column 1 data</td>
             </tr>
             <asp:PlaceHolder ID="PHBar" runat="server" visible="false">
             <tr><td colspan="2"><hr/></td>
             </tr>
             </asp:PlaceHolder>
        </ItemTemplate>
    </asp:Repeater>
</table> 
```

在 ItemDataBound 中，仅当您的条件为真且仅此而已时，您才能使此占位符 [PHBar] 可见。

希望这可以帮助。

# php - PHP SOAP 问题：对象引用未设置为对象的实例

> ID：915256
> 
> 赞同：12
> 
> 时间：2009-05-27T11:39:53.167
> 
> 标签：php, soap

我正在尝试使用 php 和 SoapClient 类构建到[https://ws.farebuzz.com/FlightGateway.asmx?WSDL的接口。](https://ws.farebuzz.com/FlightGateway.asmx?WSDL)

我设法克服了身份验证标头，但是当我尝试调用方法时被卡住了..我总是得到：

未捕获的 SoapFault 异常：[soap:Server] 服务器无法处理请求。---> 对象引用未设置为对象的实例。

我试着这样称呼它（作为一个对象）：

```
class SearchFlights{
    public $NumberOfAdults;
        public $ClassOfService;
    public $TypeOfTrip;
    public $FromCity;
    public $ToCity;
}

$parameters = new SearchFlights();
$parameters->NumberOfAdults = 2;
$parameters->ClassOfService = 'ECONOMY';
$parameters->FromCity = 'ECONOMY';
$parameters->ToCity = '1te';
$parameters->TypeOfTrip = 'NONE';
$this->client->SearchFlights($parameters); 
```

并作为一个数组，如：

```
$parameters = array('ToCity' => 'testttt',...); 
```

但我得到了同样的错误。任何人都可以帮忙吗？

谢谢

索林

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-30T10:16:58.600

您的 WSDL 声明必须以这种方式调用它：

```
$this->client->SearchFlights(array('searchRequest' => $parameters)); 
```

请注意，`searchRequest`名称很**重要**。

该服务还有各种强制性输入，您应该确保这些输入存在。通过查看您的代码，您遗漏了一些。

看看`FlightSearchRequest`这里的复杂类型。每个参数`minOccurs=1`都是必需的。

```
<s:complexType name="FlightSearchRequest">
    <s:sequence>
        <s:element minOccurs="1" maxOccurs="1" name="TypeOfTrip" type="tns:TripType"/>
        <s:element minOccurs="0" maxOccurs="1" name="FromCity" type="s:string"/>
        <s:element minOccurs="0" maxOccurs="1" name="ToCity" type="s:string"/>
        <s:element minOccurs="0" maxOccurs="1" name="ReturnFromCity" type="s:string"/>
        <s:element minOccurs="0" maxOccurs="1" name="ReturnToCity" type="s:string"/>
        <s:element minOccurs="1" maxOccurs="1" name="DepartureDate" type="s:dateTime"/>
        <s:element minOccurs="1" maxOccurs="1" name="ReturnDate" type="s:dateTime"/>
        <s:element minOccurs="1" maxOccurs="1" name="NumberOfAdults" type="s:int"/>
        <s:element minOccurs="1" maxOccurs="1" name="NumberOfChildren" type="s:int"/>
        <s:element minOccurs="1" maxOccurs="1" name="NumberOfInfantsInLap" type="s:int"/>
        <s:element minOccurs="1" maxOccurs="1" name="NumberOfInfantsOnSeat" type="s:int"/>
        <s:element minOccurs="1" maxOccurs="1" name="NumberOfSeniors" type="s:int"/>
        <s:element minOccurs="0" maxOccurs="1" name="AirlinePreference" type="s:string"/>
        <s:element minOccurs="1" maxOccurs="1" name="ClassOfService" type="tns:FlightClass"/>
        <s:element minOccurs="1" maxOccurs="1" name="IsNonStop" type="s:boolean"/>
        <s:element minOccurs="1" maxOccurs="1" name="ConsolidatorFaresOnly" type="s:boolean"/>
        <s:element minOccurs="0" maxOccurs="1" name="FpAffiliate" type="s:string"/>
        <s:element minOccurs="0" maxOccurs="1" name="FpSubAffiliate" type="s:string"/>
    </s:sequence>
</s:complexType> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-08-05T18:45:02.500

尝试使用这个：

```
$this->client->SearchFlights(array('parameters' => $parameters)); 
```

我在尝试访问 .net 网络服务时遇到问题，这为我解决了问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T10:06:30.347

我也很想知道这个问题的答案，最后我知道了原因：我们通过 SOAP 请求发送的节点应该是我们知道的数据类型，以及它们是否是强制性的。所以在这里，如果不应该遵循严格的 WSDL 指令的这些节点中的任何一个，我们将收到错误消息，即“对象引用未设置为对象的实例”。我会给你一个我遇到的例子：我遇到了同样的问题，我知道我没有向节点发送任何值，除了至少一个值或一次出现之外，然后我验证最后，如果成功，我将发送该值，否则为空字符串，这告诉 WSDL 这至少出现 1 次并且有一个值。最后我解决了这个错误。这里的基线是，如果那些是强制性的并且没有完美发送的节点将引发这个异常，或者将空字符串发送到这些节点。谢谢

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-20T11:16:48.263

如果我正确理解 WSDL，则 SearchFlights 对象应该包含 FlightSearchRequest 对象。后者包含参数。

尝试这个：

```
$parameters->FlightSearchRequest->NumberOfAdults = 2;
$parameters->FlightSearchRequest->ClassOfService = 'ECONOMY';
// etc...
$this->client->SearchFlights($parameters); 
```

# sql - SQL; 只计算每列中指定的值

> ID：915260
> 
> 赞同：3
> 
> 时间：2009-05-27T11:40:46.767
> 
> 标签：sql, count

在 SQL 中，我有一个名为“answer”的列，其值可以是 1 或 2。我需要生成一个 SQL 查询来计算每个月 1 和 2 的数量。我有以下查询，但它不起作用：

```
SELECT MONTH(`date`), YEAR(`date`),COUNT(`answer`=1) as yes,
COUNT(`answer`=2) as nope,` COUNT(*) as total

FROM results

GROUP BY YEAR(`date`), MONTH(`date`) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T11:53:45.727

我会按年份、月份以及答案本身进行分组。这将导致每月两行：一个计算答案 1 的出现，另一个计算答案 2（对于其他答案值也是通用的）

```
SELECT MONTH(`date`), YEAR(`date`), answer, COUNT(*)
FROM results
GROUP BY YEAR(`date`), MONTH(`date`), answer 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-27T11:43:38.993

尝试 SUM-CASE 技巧：

```
SELECT 
    MONTH(`date`), 
    YEAR(`date`),
    SUM(case when `answer` = 1 then 1 else 0 end) as yes,
    SUM(case when `answer` = 2 then 1 else 0 end) as nope,
    COUNT(*) as total
FROM results
GROUP BY YEAR(`date`), MONTH(`date`) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T11:58:41.083

```
SELECT year,
       month,
       answer
       COUNT(answer) AS quantity
FROM results
GROUP BY year, month, quantity 
```

```
年|月|答案|数量
2001| 1| 1| 2
2001| 1| 2| 1
2004| 1| 1| 2
2004| 1| 2| 2

```

```
SELECT * FROM results; 
```

```
年|月|答案
2001| 1| 1
2001| 1| 1
2001| 1| 2
2004| 1| 1
2004| 1| 1
2004| 1| 2
2004| 1| 2

```

# xaml - 如何使用 XAML 触发器来表示大于或等于某个值？

> ID：915263
> 
> 赞同：0
> 
> 时间：2009-05-27T11:41:30.730
> 
> 标签：xaml, triggers

我可以创建简单的触发器来检查**属性是否具有这样的特定值**：

```
<Style x:Key="StatusIndicator" TargetType="TextBlock">
    <Style.Triggers>
        <DataTrigger Binding="{Binding Status}" Value="off">
            <Setter Property="TextBlock.Foreground" Value="Red"/>
        </DataTrigger>
    </Style.Triggers>
</Style> 
```

但是我将如何使用**更复杂的运算符**，例如：

*伪代码：*

```
<DataTrigger Binding="{Binding Amount}" Operator=">=" Value="35">
    <Setter Property="TextBlock.Foreground" Value="Red"/>
</DataTrigger> 
```

是否有诸如“运算符”之类的属性，或者我是否需要为此使用转换器或**如何在触发器中实现复杂的运算符**？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T12:00:31.097

触发器中不能有复杂的运算符。转换器是一个不错的选择；对于您的示例，可能从 int 到 bool，或者如果有两个以上的状态，则从 int 到 enum。

我认为您不想在 XAML 中嵌入复杂的逻辑。很快就会成为维护的噩梦。

# c# - 支持从右到左 Unicode 的 C# WinForms 富编辑器

> ID：915265
> 
> 赞同：0
> 
> 时间：2009-05-27T11:41:54.630
> 
> 标签：c#, winforms, unicode, localization, richtext

有没有支持从右到左并可以导出为 HTML 的 WinForms 富编辑器？

标准的 RichTextBox 无法导出为 HTML（是否有 RTF 到 HTML 的转换器？）

DevExpress 的 XtraRichEdit 不支持从右到左。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T11:58:19.353

您可以使用[NRTFTTree - C# 中用于 RTF 处理的类库](http://www.codeproject.com/KB/string/nrtftree.aspx)来管理富文本

**注意：** NRtfTree 不是将 RTF 转换为 HTML 的库，但在其中一个演示源文件中有一个使用 NRtfTree 实现此目的的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T12:07:41.957

看看下面的链接：

*   [用于保存和加载“HTML lite”文件的扩展 RichTextBox](http://www.codeproject.com/KB/edit/htmlrichtextbox.aspx)

# winapi - Win API 模拟将文件拖到窗口上

> ID：915272
> 
> 赞同：0
> 
> 时间：2009-05-27T11:44:41.317
> 
> 标签：winapi, drag-and-drop

是否有任何 Win API 可以模拟将文件拖到窗口上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T12:49:59.733

哦。一个强硬的人。有[IDropTarget](http://msdn.microsoft.com/en-us/library/ms679679(VS.85).aspx) COM 接口——您不应该直接调用它的方法，因为操作系统的窗口管理器部分会为您执行此操作。但是，如果您可以从相关窗口中获取 IDropTarget 接口指针，则可以传入一个包含对相关文件的引用的[IDataObject 。](http://msdn.microsoft.com/en-us/library/ms688421(VS.85).aspx)不过，这不会很容易或优雅。

# java - 在 Hibernate 中获得独特的结果

> ID：915286
> 
> 赞同：9
> 
> 时间：2009-05-27T11:51:03.660
> 
> 标签：java, hibernate, criteria

我们如何通过在休眠中使用标准来获得不同的结果。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-27T11:54:26.960

```
criteria.setResultTransformer(Criteria.DISTINCT_ROOT_ENTITY); 
```

另请参阅[https://forum.hibernate.org/viewtopic.php?t=941669](https://forum.hibernate.org/viewtopic.php?t=941669)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-27T11:58:10.603

更灵活的解决方案可能是：

```
criteria.setProjection(Projections.distinct(Projections.property("property"))); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T12:01:02.733

取决于您的查询/标准。如果你提供一个唯一的 id 你可以调用 criteria.uniqueResult() 否则你调用 criteria.setMaxResults(1) 和调用 criteria.uniqueResult()

# flash - 将用户定义的类型传递给 AS2 中的子 swf

> ID：915288
> 
> 赞同：0
> 
> 时间：2009-05-27T11:51:35.513
> 
> 标签：flash, actionscript-2

我有一个 AS2 swf 文件，它加载一个子 swf 并希望将一些结构化数据传递给孩子。我可以通过仅在子 MC 上设置属性来传递原始类型，但复杂类型会丢失它们的值 - 即：

在父母中：

```
var testObject = new Object();
testObject.valueName = "value";

child_mc.stringProperty = "test";
child_mc.objectProperty = testObject; 
```

在孩子：

```
trace(_root.stringProperty); // traces "test". Hooray!
trace(_root.objectProperty.valueName); // traces "undefined". Boo! 
```

有趣的是，如果我使用 for .. 追踪 _root.objectProperty 的所有属性名称，则子 swf 确实报告该对象有一个名为 valueName 的值，但与它关联的数据在转换中丢失了。我尝试使用类而不是简单的对象类型，并使用索引器语法来读取/写入属性，但无济于事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T22:49:52.830

尝试使用本地 SharedObject 或 LocalConnection 对象

# .net - LinqToSql - 避免对数据库的过度查询

> ID：915292
> 
> 赞同：2
> 
> 时间：2009-05-27T11:53:16.540
> 
> 标签：.net, performance, linq-to-sql

这种情况经常出现，现在我使用 LinkToSql 和它创建的类。

经典场景——两张表：

**会员**
ID
名称
...

**Membership**
ID
MemberID (外键)
Start (datetime)
Expiration (datetime)
...

活跃的成员资格将是现在介于开始和到期之间的成员。

为了确定一个用户是否有一个活跃的成员，我创建了这个部分类来扩展 LinkToSql 生成的成员类：

```
Partial Public Class Member
    Public ReadOnly Property HasActiveMembership() As Boolean
        Get
            Dim activeMembershipCount As Integer = (From m In Me.Memberships _
                                Where m.MemberId = Me.MemberId _
                                And m.StartDate < Now And m.ExpirationDate > Now() _
                                Select m).Count

            If activeMembershipCount > 0 Then Return True Else Return False

        End Get
    End Property
End Class 
```

这对一个成员很有用，但是当我想列出 700 个成员并且他们是否有活跃的成员资格时，它会对数据库进行 700 多次调用。

我应该如何更改我的模型/课程？

我可以只为列表创建一个查询，将整个事情变成一个查询，这非常简单，但如果可以的话，我想避免这种情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T12:02:40.093

你有几个选择；例如，您可以使用[`DataLoadOptions.LoadWith`](http://msdn.microsoft.com/en-us/library/bb534268.aspx)或[`DataLoadOptions.AssociateWith`](http://msdn.microsoft.com/en-us/library/bb548919.aspx)急切地获取数据 - 但是，最佳方法取决于您如何使用它。

例如，您可以编写“具有活动成员资格的用户”查询（在 LINQ 中使用`Any`，或使用 SPROC/UDF）。那将是 1 次往返，但可以说不是以对象为中心（而是以查询为中心）。哪个可能没问题...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T12:11:36.330

看起来您已经定义了一个关联，可能是由于表之间的 FK 关系。在这种情况下，您可以使用已在类上定义的实体引用使用 where 子句来扩展您的成员资格查询。

C# 示例：

```
var query = db.Members.Where( m => m.Memberships
                                    .Any( ms => ms.StartDate > now
                                                && ms.ExpirationDate < now )); 
```

# debugging - 调试器块

> ID：915309
> 
> 赞同：6
> 
> 时间：2009-05-27T11:58:30.837
> 
> 标签：debugging

您是否曾经遇到过一个错误，您只是没有想法并且不知道下一步该尝试什么，并且您真的很生气？关于如何摆脱这种模式有什么一般的想法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-27T12:02:24.353

当我被这样阻止时，我找到的最好的建议是离开一段时间。无论是去吃一顿长午餐还是离开一天。重新回来，焕然一新。大多数时候，答案会盯着你的脸。到目前为止，10 分钟的咖啡休息时间对我来说还不够，但你的里程可能会有所不同。

其次，与你的同龄人交谈。遍历您尝试过的所有内容。只要让他们听，当你说完的时候，很多时候，答案就会出现在你的面前。

这些只是我在调试受阻时最常使用的两个。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-27T12:30:12.427

*   **五分钟休息**

非常关键，以免您砸坏键盘。

*   **在给你姐姐的电子邮件中解释问题**

或者你两岁的儿子。除非您解释得很清楚，否则[不会理解一个词的](https://stackoverflow.com/questions/612537/why-is-it-that-properly-formulating-your-question-for-stackoverflow-often-yield/612555#612555)人。你不需要发送电子邮件，你只需要确定你完全理解它。你会惊讶于有多少次只是简单地重述问题突然让你明白你哪里出错了。这是发现您对问题的假设以及它们可能不一定正确的好方法。

*该链接指向 JaredPar 对另一个 SO 问题的出色回答。

*   **与同事交谈**

至此，您已经“通过电子邮件发送”了家庭宠物，因此您知道您希望已经涵盖了所有愚蠢的方面，是时候与真人交谈了。他们过去可能经历过一些不为人知的事情，让他们想起了这种情况，他们肯定会有不同的看法。试着确保你清楚问题是什么，而不是你*认为*的问题。你不想偏袒他们。您可以而且应该谈论他们尝试过的事情，并解释为什么您认为问题出在该领域（您可能是对的），但您不想对他们的建议置若罔闻，即使他们不这样做看起来是对的。

*   **再看代码**

到这个时候，你应该希望不那么暴力，你应该用新的想法武装起来。首先重新验证错误。一个简单的步骤，但我已经为我们的测试脚本中而不是我们的代码中的错误感到沮丧了几个小时。再次验证错误后，请从顶部开始。验证一切。在你 100% 确信的最后一个点设置一个断点，然后继续往前走，直到你发现输出再次被破坏。这是一个巨大的成功，因为您现在有希望研究的更小的代码块。然后，如有必要，请一位同事查看实际运行的代码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-27T12:04:48.140

我通常会休息一下......如果这不起作用，我会解决这个问题。（其实，老实说，我应该说我花了一个不眠之夜思考这个问题）。

我几乎总是在早上准备好可能的解决方案清单。:-)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T12:05:01.133

我通常采取几个步骤：

*   查看包含错误的功能所涉及的代码，并以有助于我缩小问题范围的方式放置记录器消息（这允许您稍后在不再那么恼火时查看记录器，也许找到有用的提示：P）
*   向我的高级同事寻求提示
*   致电客户以清楚了解何时出现问题

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T12:05:24.037

当我从一开始就没有采取结构性方法时，我通常会陷入那种情绪。通过迭代地缩小问题可能存在的区域并尝试编写可以重现错误的最小代码库，我还没有失败。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T12:11:02.370

我认为，如果您遇到这种问题，是时候进行一些认真的重构了……

它也可能表明错误的假设。尝试以编程方式假设您“只是”假设的所有内容。请注意，堆栈中的任何方法都不会破坏方法不变量。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T12:16:54.603

其他人提到休息或“睡在上面”。这种技术被称为（除其他外）孵化。一旦你接受了这个想法，你也可以更进一步。

真正把问题抛在脑后的一个重要方面，相信你以后会有答案。否则的危险，特别是如果睡在上面，你会一直担心到最后一分钟，然后这就会变成一个无休止的循环，你的思想会在一夜之间陷入困境。你可能最终会醒来并没有充分休息，做了很多圆形的梦。这样做太多，这是一条通往抑郁的道路。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-27T12:33:47.783

另一个不错的选择是向其他开发人员/团队成员提出想法。有时他们会问你没有考虑过的问题。

如果您独自工作，最好找几个开发人员一起聊天，用一些不同的方法进行故障排除。你会惊奇地发现，一个全新的视角经常会成为你需要的突破口。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-27T13:02:21.690

试试 David Ungars 的“淋浴方法”：

“如果你知道该打什么，那就打。如果你不知道该打什么，那就洗个澡，一直待在淋浴间，直到你知道该打什么为止”

这种召唤大多数人喜欢做的事情。休息一下 ！不管是什么样的休息，只要你不去想休息前所做的事情。任何形式的分心都是好的。

干杯！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-27T13:07:07.420

我通常会一步一步地对有问题的方法/功能进行试运行。并且不要假设错误来自那里，它可能来自之前的任何地方。

使用适当的调试器，不要使用一系列 printfs。

# php - 如何邀请来自 MSN、Yahoo 的人加入我的应用程序？

> ID：915311
> 
> 赞同：1
> 
> 时间：2009-05-27T11:58:45.517
> 
> 标签：php, social-networking, invite

我需要在我的社交网络应用程序中添加邀请用户功能，以便用户可以从他们的 hotmail 或 yahoo 帐户中邀请联系人。我该如何做到这一点，是否有任何免费的开源库可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T12:17:27.583

根据您希望从中获取联系信息的服务，他们可能已经为您提供了已发布的 API。

例如，雅虎有一个联系人列表 API，您可以使用：http: [//developer.yahoo.com/social/rest_api_guide/contact_api.html](http://developer.yahoo.com/social/rest_api_guide/contact_api.html)

谷歌也有一个：[http ://code.google.com/apis/contacts/](http://code.google.com/apis/contacts/)

Windows Live 也是如此：http: [//msdn.microsoft.com/en-us/library/bb463974.aspx](http://msdn.microsoft.com/en-us/library/bb463974.aspx)

如果您需要在没有 API 的情况下使用服务，那么您可能需要询问该用户的用户名和密码，暂时使用它来登录他的帐户，下载联系信息，然后丢弃登录详细信息。然而，这种方法存在明显的隐私和安全问题。尽管如此，它还是被许多社交网站频繁使用。

同样的方法也可用于从即时消息服务中检索好友信息。您登录（可能使用开源 IM API）并获取他们的好友列表和联系方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-10T05:20:58.820

以防万一有人感兴趣——我想分享我在网上找到的这段简洁的代码。它免费且非常易于设置和集成。[http://openinviter.com](http://openinviter.com)是基于 php 的，您可以从几乎任何地址簿中提取电子邮件联系人。

你只需要为此设置 curl。

# c++ - 在 C++ 中退出进程的不同方法

> ID：915312
> 
> 赞同：12
> 
> 时间：2009-05-27T11:58:58.977
> 
> 标签：c++, winapi, visual-c++

退出进程有多种方式：

例如：ExitProcess、ExitThread（从主线程）、退出、中止、从主返回、终止。

我想知道每种方法对静态/全局/自动对象销毁的影响。

例如，我有一个项目在调用 ExitProcess 时崩溃（可能是由于某些释放错误），但在调用 exit() 时却没有。（顺便说一句，与[这个问题](https://stackoverflow.com/questions/914613/what-exactly-is-the-effect-of-ctrl-c-on-c-win32-console-applications)有关）。

所以基本上我想知道在什么情况下会发生上述对象的释放，以及以什么顺序（对于 VC++）。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-27T12:31:57.850

简而言之：**唯一完全安全的做法是允许`main()`或您的线程函数到`return`.**

C++ 标准保证（3.6.3/1、18.3）如果`exit()`调用全局对象（包括静态对象）的析构函数，则它明确指出在这种情况下 *不会调用**局部*变量的析构函数。将调用任何用 注册的函数，并且还将刷新然后关闭任何打开的 stdio 流（至少包括、、）。*`exit()``atexit()``stdin``stdout``stderr`*

 *保证调用`abort()`不会调用本地或全局析构函数。它也不会调用注册`atexit()`或刷新 stdio 流的函数。

调用任何 Win32 原语，例如`ExitProcess()`or`ExitThread()`肯定不会调用局部变量的析构函数，并且几乎肯定不会调用全局对象的任何析构函数，或任何注册到`atexit()`. **不建议直接在 C++ 程序中调用这些函数**——基本上，这些 Win32 函数和 C++ 运行时库彼此一无所知。事实上，即使是[MSDN 文档`ExitThread()`](http://msdn.microsoft.com/en-us/library/ms682659(VS.85).aspx)也建议 C++ 程序应该从线程函数返回而不是调用`ExitThread()`.

（理论上，运行时库有可能专门安排`ExitProcess()`调用全局对象析构函数——这可以通过始终加载特定的 DLL 来完成，该 DLL 的入口点函数将执行这些调用，因为`ExitProcess()`将为每个加载的 DLL 调用入口点函数与`DLL_PROCESS_DETACH`- 但据我所知，没有实现这样做。）

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2009-05-28T16:13:39.700

查看 ExitProcess() 的源代码（发布在 compuserve、usenet 上）

# wpf - 在拖放过程中获取鼠标位置

> ID：915314
> 
> 赞同：18
> 
> 时间：2009-05-27T11:59:05.810
> 
> 标签：wpf, drag-and-drop, mouse, position

有谁知道如何在 WPF 中的拖放操作期间获得正确的鼠标位置？我用过`Mouse.GetPosition()`，但返回值不正确。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-27T12:02:11.797

没关系，我已经找到了解决方案。使用`DragEventArgs.GetPosition()`返回正确的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-02-01T09:40:19.900

DragOver 处理程序是针对一般情况的解决方案。但是，如果您在光标不在可放置表面时需要精确的光标点，您可以使用下面的 GetCurrentCursorPosition 方法。我[参考了 Jignesh Beladiya 的帖子](http://jigneshon.blogspot.com/2013/11/c-wpf-snippet-reliably-getting-mouse.html)。

```
using System;
using System.Runtime.InteropServices;
using System.Windows;
using System.Windows.Media;

public static class CursorHelper
{
    [StructLayout(LayoutKind.Sequential)]
    struct Win32Point
    {
        public Int32 X;
        public Int32 Y;
    };

    [DllImport("user32.dll")]
    [return: MarshalAs(UnmanagedType.Bool)]
    static extern bool GetCursorPos(ref Win32Point pt);

    public static Point GetCurrentCursorPosition(Visual relativeTo)
    {
        Win32Point w32Mouse = new Win32Point();
        GetCursorPos(ref w32Mouse);
        return relativeTo.PointFromScreen(new Point(w32Mouse.X, w32Mouse.Y));
    }
} 
```

# vba - VBA 有字典结构吗？

> ID：915317
> 
> 赞同：287
> 
> 时间：2009-05-27T12:00:03.687
> 
> 标签：vba, dictionary, data-structures, vb6

VBA 有字典结构吗？像键<>值数组？

* * *

## 回答 #1

> 赞同：358
> 
> 时间：2009-05-27T12:04:53.007

是的。

设置对 MS 脚本运行时（“Microsoft 脚本运行时”）的引用。根据@regjo 的评论，转到工具-> 参考并勾选“Microsoft 脚本运行时”框。

[![参考窗口](https://i.stack.imgur.com/ubtvU.png)](https://i.stack.imgur.com/ubtvU.png)

使用以下代码创建字典实例：

```
Set dict = CreateObject("Scripting.Dictionary") 
```

或者

```
Dim dict As New Scripting.Dictionary 
```

使用示例：

```
If Not dict.Exists(key) Then 
    dict.Add key, value
End If 
```

不要忘记将字典设置为`Nothing`使用完毕后。

```
Set dict = Nothing 
```

* * *

## 回答 #2

> 赞同：194
> 
> 时间：2011-11-29T04:10:44.920

VBA 有集合对象：

```
 Dim c As Collection
    Set c = New Collection
    c.Add "Data1", "Key1"
    c.Add "Data2", "Key2"
    c.Add "Data3", "Key3"
    'Insert data via key into cell A1
    Range("A1").Value = c.Item("Key2") 
```

该`Collection`对象使用散列执行基于键的查找，因此速度很快。

* * *

您可以使用`Contains()`函数来检查特定集合是否包含键：

```
Public Function Contains(col As Collection, key As Variant) As Boolean
    On Error Resume Next
    col(key) ' Just try it. If it fails, Err.Number will be nonzero.
    Contains = (Err.Number = 0)
    Err.Clear
End Function 
```

*2015 年 6 月 24 日编辑*：`Contains()`感谢@TWiStErRob 缩短。

*2015 年 9 月 25 日编辑*：`Err.Clear()`感谢@scipilot。

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2009-05-27T12:19:03.010

VBA 没有字典的内部实现，但在 VBA 中，您仍然可以使用 MS 脚本运行时库中的字典对象。

```
Dim d
Set d = CreateObject("Scripting.Dictionary")
d.Add "a", "aaa"
d.Add "b", "bbb"
d.Add "c", "ccc"

If d.Exists("c") Then
    MsgBox d("c")
End If 
```

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2012-01-25T21:36:09.860

一个额外的字典示例，可用于包含出现频率。

循环外：

```
Dim dict As New Scripting.dictionary
Dim MyVar as String 
```

在一个循环内：

```
'dictionary
If dict.Exists(MyVar) Then
    dict.Item(MyVar) = dict.Item(MyVar) + 1 'increment
Else
    dict.Item(MyVar) = 1 'set as 1st occurence
End If 
```

检查频率：

```
Dim i As Integer
For i = 0 To dict.Count - 1 ' lower index 0 (instead of 1)
    Debug.Print dict.Items(i) & " " & dict.Keys(i)
Next i 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2015-06-04T19:28:40.273

根据cjrh[的回答](https://stackoverflow.com/questions/915317/does-vba-have-dictionary-structure#answer-8305733)，我们可以构建一个不需要标签的 Contains 函数（我不喜欢使用标签）。

```
Public Function Contains(Col As Collection, Key As String) As Boolean
    Contains = True
    On Error Resume Next
        err.Clear
        Col (Key)
        If err.Number <> 0 Then
            Contains = False
            err.Clear
        End If
    On Error GoTo 0
End Function 
```

* * *

对于我的一个项目，我编写了一组辅助函数来使 a 的`Collection`行为更像`Dictionary`. 它仍然允许递归集合。您会注意到 Key 总是排在第一位，因为它是强制性的，并且在我的实现中更有意义。我也只用了`String`钥匙。如果你愿意，你可以把它改回来。

## 放

我将其重命名为设置，因为它会覆盖旧值。

```
Private Sub cSet(ByRef Col As Collection, Key As String, Item As Variant)
    If (cHas(Col, Key)) Then Col.Remove Key
    Col.Add Array(Key, Item), Key
End Sub 
```

## 得到

这些`err`东西是用于对象的，因为您将使用`set`和不使用变量来传递对象。我想你可以检查它是否是一个物体，但我时间紧迫。

```
Private Function cGet(ByRef Col As Collection, Key As String) As Variant
    If Not cHas(Col, Key) Then Exit Function
    On Error Resume Next
        err.Clear
        Set cGet = Col(Key)(1)
        If err.Number = 13 Then
            err.Clear
            cGet = Col(Key)(1)
        End If
    On Error GoTo 0
    If err.Number <> 0 Then Call err.raise(err.Number, err.Source, err.Description, err.HelpFile, err.HelpContext)
End Function 
```

## 拥有

发这个帖子的原因...

```
Public Function cHas(Col As Collection, Key As String) As Boolean
    cHas = True
    On Error Resume Next
        err.Clear
        Col (Key)
        If err.Number <> 0 Then
            cHas = False
            err.Clear
        End If
    On Error GoTo 0
End Function 
```

## 消除

如果它不存在则不会抛出。只要确保它被删除。

```
Private Sub cRemove(ByRef Col As Collection, Key As String)
    If cHas(Col, Key) Then Col.Remove Key
End Sub 
```

## 钥匙

获取一组键。

```
Private Function cKeys(ByRef Col As Collection) As String()
    Dim Initialized As Boolean
    Dim Keys() As String

    For Each Item In Col
        If Not Initialized Then
            ReDim Preserve Keys(0)
            Keys(UBound(Keys)) = Item(0)
            Initialized = True
        Else
            ReDim Preserve Keys(UBound(Keys) + 1)
            Keys(UBound(Keys)) = Item(0)
        End If
    Next Item

    cKeys = Keys
End Function 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2011-11-02T18:36:53.700

脚本运行时字典似乎有一个错误，可能会在高级阶段破坏您的设计。

> 如果字典值是一个数组，则不能通过对字典的引用来更新数组中包含的元素的值。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-05-27T12:02:13.200

是的。适用于[VB6](http://support.microsoft.com/kb/187234)、VBA (Excel) 和[VB.NET](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2015-11-23T01:27:04.140

所有其他人已经提到了 Dictionary 类的 scripting.runtime 版本的使用。如果您无法使用此 DLL，您也可以使用此版本，只需将其添加到您的代码中即可。

[https://github.com/VBA-tools/VBA-Dictionary/blob/master/Dictionary.cls](https://github.com/VBA-tools/VBA-Dictionary/blob/master/Dictionary.cls)

它与微软的版本相同。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2013-08-22T12:29:55.757

如果出于任何原因，您无法在 Excel 中安装附加功能或不想安装，您也可以使用数组，至少对于简单的问题。作为 WhatIsCapital，您输入国家/地区的名称，该函数将返回其首都。

```
Sub arrays()
Dim WhatIsCapital As String, Country As Array, Capital As Array, Answer As String

WhatIsCapital = "Sweden"

Country = Array("UK", "Sweden", "Germany", "France")
Capital = Array("London", "Stockholm", "Berlin", "Paris")

For i = 0 To 10
    If WhatIsCapital = Country(i) Then Answer = Capital(i)
Next i

Debug.Print Answer

End Sub 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2020-10-22T11:30:09.667

VBA 可以使用`Scripting.Runtime`.

它的**实现**实际上是一个**花哨**的实现——只要做`myDict(x) = y`，它就会检查字典中是否有一个键`x`，如果没有，它甚至会创建它。如果它在那里，它会使用它。

它不会“大喊”或“抱怨”这个额外的步骤，“在引擎盖下”执行。当然，您可以明确检查是否存在带有`Dictionary.Exists(key)`. 因此，这 5 行：

```
If myDict.exists("B") Then
    myDict("B") = myDict("B") + i * 3
Else
    myDict.Add "B", i * 3
End If 
```

与此 1 班轮相同 - `myDict("B") = myDict("B") + i * 3`。看看这个：

```
Sub TestMe()

    Dim myDict As Object, i As Long, myKey As Variant
    Set myDict = CreateObject("Scripting.Dictionary")

    For i = 1 To 3
        Debug.Print myDict.Exists("A")
        myDict("A") = myDict("A") + i
        myDict("B") = myDict("B") + 5
    Next i

    For Each myKey In myDict.keys
        Debug.Print myKey; myDict(myKey)
    Next myKey

End Sub 
```

[![在此处输入图像描述](https://i.stack.imgur.com/L0KpJ.png)](https://i.stack.imgur.com/L0KpJ.png)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2021-01-03T06:14:25.213

您可以`HashTable`通过`System.Collections.HashTable`.

[哈希表](https://docs.microsoft.com/en-us/dotnet/api/system.collections.hashtable?view=net-5.0)

> 表示基于键的哈希码组织的键/值对的集合。

不确定您是否会想要使用它，`Scripting.Dictionary`但为了完整起见在此处添加。您可以查看这些方法以防万一，例如`Clone, CopyTo`

例子：

```
Option Explicit

Public Sub UsingHashTable()

    Dim h As Object
    Set h = CreateObject("System.Collections.HashTable")

    h.Add "A", 1
    ' h.Add "A", 1  ''<< Will throw duplicate key error
    h.Add "B", 2
    h("B") = 2

    Dim keys As mscorlib.IEnumerable 'Need to cast in order to enumerate  'https://stackoverflow.com/a/56705428/6241235

    Set keys = h.keys

    Dim k As Variant

    For Each k In keys
        Debug.Print k, h(k)                      'outputs the key and its associated value
    Next

End Sub 
```

* * *

@MathieuGuindon 的这个[答案](https://stackoverflow.com/a/56705428/6241235)提供了有关 HashTable 的大量详细信息，以及为什么必须使用`mscorlib.IEnumerable`（对 mscorlib 的早期绑定引用）来枚举键：值对。

* * *

# iphone - iPhone 模态视图比屏幕小

> ID：915318
> 
> 赞同：11
> 
> 时间：2009-05-27T12:00:20.363
> 
> 标签：iphone, modal-dialog, modalviewcontroller

我正在尝试做一些不应该那么复杂的事情，但我无法弄清楚。我有一个 UIViewController 显示一个 UITableView。我想在用户按下一行时显示一个上下文菜单。我希望这是一个带有标签和按钮的半透明视图。我可以使用 AlertView，但我想完全控制标签和按钮的格式，并希望使用 Interface Builder。

因此，我创建了 250x290 的小视图，将 alpha 设置为 0.75，并创建了一个带有插座的视图控制器来处理不同的用户事件。

现在我想介绍它。如果我使用 presentModalViewController 会发生两种（不希望的）事情 1）视图覆盖了所有屏幕（但状态栏除外）。2）它是半透明的，但我在它“后面”看到的不是父视图，而是应用程序根视图。

我尝试将它添加为子视图，但没有任何反应，所以我没有做正确的事情：

```
RestaurantContextVC* modalViewController = [[[RestaurantContextVC alloc] initWithNibName:@"RestaurantContextView" bundle:nil] autorelease];
[self.view addSubview:modalViewController.view]; 
```

有可能做我想做的事吗？提前致谢。

贡索

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-14T22:58:21.590

我正在编写类似的代码。我的方法包括......

1.  不使用dismissModalViewControllerAnimated 和presentModalViewController:animated。

2.  在 IB 中设计定制的全尺寸视图。在其 viewDidLoad 消息体中，将背景颜色设置为 clearColor，以便视图上未被控制器覆盖的空间是透明的。

3.  我在浮动视图的控制器下放置了一个 UIImageView。UIImageView 包含一个经过 photoshop 处理的图像，该图像具有圆角并且背景设置为透明。此图像视图用作容器。

4.  我使用 CoreAnimation 以模态视图样式呈现/关闭浮动视图：（FloatingViewController.m）

    ```
    -  (void)viewDidLoad
    {
        [super viewDidLoad];
        [self.view setBackgroundColor:[UIColor clearColor]];

        [UIView beginAnimations:nil context:nil];
        [self.view setFrame:CGRectMake(0, 480, 320, 480)];

        [UIView setAnimationDuration:0.75f];
        [self.view setFrame:CGRectMake(0, 0, 320, 480)];
        [UIView commitAnimations];
    } 
    ```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T12:42:08.343

旺吉

这几乎就是我找到的解决方案。我使用 loadNibNamed 加载视图，然后使用 addSubView 将其添加到顶部，如下所示：

```
//Show a view on top of current view with a wait indicator. This prevents all user interactions.
-(void) showWaitView{
    NSArray* nibViews =  [[NSBundle mainBundle] loadNibNamed:@"WaitView" owner:self options:nil];
#ifdef __IPHONE_2_1
    waitView = [ nibViews objectAtIndex: 0];
#else
    waitView = [ nibViews objectAtIndex: 1];
#endif          
    CGFloat x = self.view.center.x - (waitView.frame.size.width / 2);
    CGFloat y = self.view.center.y - (waitView.frame.size.height / 2);
    [waitView setFrame:CGRectMake(x,y,waitView.bounds.size.width,waitView.bounds.size.height)];
    [self.view addSubview:waitView];    
} 
```

您能否详细说明第 3 点和第 4 点？

我为查看圆形矩形方面所做的工作是将其放在圆形矩形按钮内。

此代码实际上将允许您拥有一个小的浮动视图，但如果该视图小于其父视图，则用户可以与父视图的可见部分进行交互。

最后，我创建了相同大小的视图，但保留了代码以防万一。

贡索

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T12:11:27.423

我强烈考虑使用导航控制器在您的子视图中滑动而不是覆盖它。这是预期的模型，您可能认为通过自己的方式获得的任何小好处都将被（最小）意外原则大大抵消。

如果你真的必须这样做，我相信诀窍是将第一个表视图添加为视图控制器维护的透明“持有”视图的子视图。然后将您的新子视图添加为该子视图的另一个子视图。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T02:20:11.657

同样，如果你真的想这样做，而不是添加一个透明的“持有”视图，因为这个弹出窗口本质上是模态的，我会将它直接作为窗口的子视图。

您可能希望在其后面放置一个透明的黑色防护罩，以防止触摸背景并将输入焦点放在弹出窗口上。

但严肃地说，考虑在堆栈上弹出一个控制器或使用该警报视图。除非你聘请了一位美元设计师，否则它在 iPhone 上可能看起来不合适。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-08-03T10:16:39.087

我所做的是在我的应用程序委托中的 UINavigation 控制器之上创建一个 UIViewController 并使其成为单例对象的属性以方便起见：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {    

//--- create root navigation controller
self.window.rootViewController = self.navigationController;

//--- create view controller for popups:
popupViewController = [[BaseViewController alloc] init];
popupViewController.view.backgroundColor = [UIColor clearColor];
popupViewController.view.hidden = true; //for rendering optimisation
[self.window addSubview:popupViewController.view];
[AppState sharedInstance].popupViewController = self.popupViewController;

//--- make all visible:
[self.window makeKeyAndVisible];

return YES; 
```

}

在我的应用程序中的任何时候，我都可以调用例如

```
MyViewController * myVC = [[UIViewController alloc] init];
//... set up viewcontroller and its view...
// add the view of the created view controller to the popup view:
[AppState sharedInstance].popupViewController.view.hidden = false;
[[AppState sharedInstance].popupViewController.view addSubview:myVC.view]; 
```

顶部使用的 BaseViewController 只是继承自 UIViewController 并设置了全屏视图：

```
//----- in BaseViewController implementation
- (void)loadView {
   //------- create root view:
   CGRect frame = [[AppState sharedInstance] getScreenFrame]; 
   rootView = [[VCView alloc] initWithFrame:frame];
   rootView.backgroundColor = [UIColor whiteColor];
   self.view = rootView;
} 
```

# php - 通过posterous api发布到posterous.com

> ID：915325
> 
> 赞同：2
> 
> 时间：2009-05-27T12:02:28.987
> 
> 标签：php, curl

我正在使用curl，我想通过posterous api发布。我正在使用这种方法 posterous.com/api/newpost

我的代码是

```
$url="userid"
$posturl = "posterous.com/api/newpost";
$session = curl_init($posturl);
$postVars = array(

"site_id" => $url,

"body"=>$message        

);

curl_setopt($session, CURLOPT_POST, true);
curl_setopt($session, CURLOPT_POSTFIELDS, $postVars);
curl_setopt($session, CURLOPT_HEADER, false);
curl_setopt($session, CURLOPT_FOLLOWLOCATION, true);
curl_setopt($session, CURLOPT_RETURNTRANSFER, true);
$response = curl_exec($session);
$obj = json_decode($response,true);
curl_close($session); 
```

但我收到了这个错误

```
<rsp stat="fail">
 <err code="3001" msg="Invalid Posterous email or password" />
</rsp> 
```

请指导我

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T12:06:20.057

好吧，您实际上似乎并没有发送电子邮件地址或密码，所以我想这就是问题所在。

> 所有调用都需要用户身份验证，这是通过使用用户的后电子邮件地址和密码的基本 HTTP 身份验证来完成的。

你可以这样做：

```
$user = 'foo@bar.com';
$password = 'foobar';

curl_setopt($session, CURLOPT_USERPWD, $user . ":" . $password); 
```

# c# - WinForms 上的报告查看器问题：未指定某些参数或凭据

> ID：915328
> 
> 赞同：0
> 
> 时间：2009-05-27T12:03:05.927
> 
> 标签：c#, reportviewer, subreport

我正在尝试实现一个使用 Windows 窗体上的报表查看器显示报表的应用程序。该报告还包括一个子报告。

没有子报告，我可以毫无问题地显示报告。但是，在我添加子报告后，我收到错误“未指定某些参数或凭据”。

我以以下方式实现：在将数据源添加到父报表之前，我调用了 SubreportProcessingEventHandler。如果是 SubreportProcessing，我将为子报表添加数据源。

我还尝试使用不需要任何参数的子报告来实现。但是，我仍然收到相同的错误“尚未指定某些参数或凭据”。

我犯了什么错误吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-11-17T14:10:52.297

我有一个类似的错误，虽然它与子报告无关。

我通过改变使错误消失了

`ReportViewer.LocalReport.Refresh`

至

```
ReportViewer.LocalReport.ExecuteReportInCurrentAppDomain(System.Reflection.Assembly.GetExecutingAssembly().Evidence) 
```

注意：在报告查看器 2010 中，它说此方法已过时，但到目前为止在我的测试中似乎工作正常。

# sql - 是否可以使用实体框架运行本机 sql？

> ID：915329
> 
> 赞同：66
> 
> 时间：2009-05-27T12:04:26.097
> 
> 标签：sql, entity-framework, ado.net

我正在尝试在表中搜索 XML 字段，EF 不支持此功能。

不使用纯 Ado.net 是否可以通过 EF 获得本机 SQL 支持？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-10-16T17:00:55.137

对于 .NET Framework 4 及更高版本：[`ObjectContext.ExecuteStoreCommand()`](http://msdn.microsoft.com/en-us/library/system.data.objects.objectcontext.executestorecommand.aspx)如果您的查询没有返回结果，则使用，[`ObjectContext.ExecuteStoreQuery`](http://msdn.microsoft.com/en-us/library/system.data.objects.objectcontext.executestorequery.aspx)如果您的查询返回结果，则使用。

对于以前的 .NET Framework 版本，这里有一个示例说明如何操作。如果您的查询返回结果，请根据需要替换 ExecuteNonQuery()。

```
static void ExecuteSql(ObjectContext c, string sql)
{
    var entityConnection = (System.Data.EntityClient.EntityConnection)c.Connection;
    DbConnection conn = entityConnection.StoreConnection;
    ConnectionState initialState = conn.State;
    try
    {
        if (initialState != ConnectionState.Open)
            conn.Open();  // open connection if not already open
        using (DbCommand cmd = conn.CreateCommand())
        {
            cmd.CommandText = sql;
            cmd.ExecuteNonQuery();
        }
    }
    finally
    {
        if (initialState != ConnectionState.Open)
            conn.Close(); // only close connection if not initially open
    }
} 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-10-01T18:59:36.727

使用`Entity Framework 5.0`你可以[`ExecuteSqlCommand`](http://msdn.microsoft.com/en-us/library/system.data.entity.database.executesqlcommand%28v=vs.103%29.aspx)用来执行多行/多命令的纯`SQL`语句。这样您就不需要提供任何支持对象来存储返回的值，因为该方法返回一个 int（执行命令后由数据库返回的结果）。

样本：

```
context.Database.ExecuteSqlCommand(@
"-- Script Date: 10/1/2012 3:34 PM  - Generated by ExportSqlCe version 3.5.2.18
SET IDENTITY_INSERT [Students] ON;

INSERT INTO [Students] ([StudentId],[FirstName],[LastName],[BirthDate],[Address],[Neighborhood],[City],[State],[Phone],[MobilePhone],[Email],[Enrollment],[Gender],[Status]) VALUES (12,N'First Name',N'SecondName',{ts '1988-03-02 00:00:00.000'},N'RUA 19 A, 60',N'MORADA DO VALE',N'BARRA DO PIRAÍ',N'Rio de Janeiro',N'3346-7125',NULL,NULL,{ts '2011-06-04 21:25:26.000'},2,1);

INSERT INTO [Students] ([StudentId],[FirstName],[LastName],[BirthDate],[Address],[Neighborhood],[City],[State],[Phone],[MobilePhone],[Email],[Enrollment],[Gender],[Status]) VALUES (13,N'FirstName',N'LastName',{ts '1976-04-12 00:00:00.000'},N'RUA 201, 2231',N'RECANTO FELIZ',N'BARRA DO PIRAÍ',N'Rio de Janeiro',N'3341-6892',NULL,NULL,{ts '2011-06-04 21:38:38.000'},2,1);
"); 
```

有关这方面的更多信息，请查看此处：[实体框架代码优先：在创建数据库时执行 SQL 文件](http://www.drowningintechnicaldebt.com/ShawnWeisfeld/archive/2011/07/15/entity-framework-code-first-executing-sql-files-on-database-creation.aspx)

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2013-03-16T16:36:03.167

对于***实体框架 5*** ，请使用**`context.Database.SqlQuery`**.

对于***Entity Framework 4*** ，使用 **`context.ExecuteStoreQuery`** 以下代码：

```
 public string BuyerSequenceNumberMax(int buyerId)
    {
        string sequenceMaxQuery = "SELECT TOP(1) btitosal.BuyerSequenceNumber FROM BuyerTakenItemToSale btitosal " +
                                  "WHERE btitosal.BuyerID =  " + buyerId +
                                  "ORDER BY  CONVERT(INT,SUBSTRING(btitosal.BuyerSequenceNumber,7, LEN(btitosal.BuyerSequenceNumber))) DESC";

        var sequenceQueryResult = context.Database.SqlQuery<string>(sequenceMaxQuery).FirstOrDefault();

        string buyerSequenceNumber = string.Empty;

        if (sequenceQueryResult != null)
        {
            buyerSequenceNumber = sequenceQueryResult.ToString();
        }

        return buyerSequenceNumber;
    } 
```

要返回列表，请使用以下代码：

```
 public List<PanelSerialList> PanelSerialByLocationAndStock(string locationCode, byte storeLocation, string itemCategory, string itemCapacity, byte agreementType, string packageCode)
 {
       string panelSerialByLocationAndStockQuery = "SELECT isws.ItemSerialNo,  im.ItemModel " +
        "FROM Inv_ItemMaster im   " +
        "INNER JOIN  " +
        "Inv_ItemStockWithSerialNoByLocation isws  " +
        "   ON im.ItemCode = isws.ItemCode   " +
        "       WHERE isws.LocationCode = '" + locationCode + "' AND  " +
        "   isws.StoreLocation = " + storeLocation + " AND  " +
        "   isws.IsAvailableInStore = 1 AND " +
        "   im.ItemCapacity = '" + itemCapacity + "' AND " +
        "   isws.ItemSerialNo NOT IN ( " +
        "           Select sp.PanelSerialNo From Special_SpecialPackagePriceForResale sp  " +
        "           Where sp.PackageCode = '" + packageCode + "' )";

    return context.Database.SqlQuery<PanelSerialList>(panelSerialByLocationAndStockQuery).ToList();

} 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2012-01-08T14:37:08.810

从 .NET 4 开始，您可以使用[`ExecuteStoreQuery`](http://msdn.microsoft.com/en-us/library/dd487208.aspx)以下方法：

```
var list = myDBEntities.ExecuteStoreQuery<MyClass>(MyClass.sql); 
```

其中 myDBEntities 继承自 ObjectContext。

```
class MyClass
{
    /* You can change query to more complicated, e.g. with joins */
    public const string sql = @"select [MyTable].[MyField] from [MyTable]";
    public string MyField { get; set; }
} 
```

请注意，MyTable 是真实的表名，而不是 EF 类。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-04-19T11:04:05.247

把事情简单化

```
using (var context = new MyDBEntities())
{
    var m = context.ExecuteStoreQuery<MyDataObject>("Select * from Person", string.Empty);
    //Do anything you wonna do with 
    MessageBox.Show(m.Count().ToString());
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-10-05T08:35:33.987

```
public class RaptorRepository<T>
    where T : class
{
    public RaptorRepository()
        : this(new RaptorCoreEntities())
    {
    }

    public RaptorRepository(ObjectContext repositoryContext)
    {
        _repositoryContext = repositoryContext ?? new RaptorCoreEntities();
        _objectSet = repositoryContext.CreateObjectSet<T>();
    }

    private ObjectContext _repositoryContext;
    private ObjectSet<T> _objectSet;
    public ObjectSet<T> ObjectSet
    {
        get
        {
            return _objectSet;
        }
    }

    public void DeleteAll()
    {
        _repositoryContext
            .ExecuteStoreCommand("DELETE " + _objectSet.EntitySet.ElementType.Name);
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-01-06T12:29:41.827

那么我们对 2017 年的这一切有什么看法呢？80k 咨询表明在 EF 中运行 SQL 请求是很多人想做的事情。但为什么？为了什么利益？

贾斯汀，一位享有我 20 倍声誉的大师，在接受的答案中为我们提供了一种静态方法，该方法逐行查找，就像等效的 ADO 代码一样。一定要很好地复制它，因为有一些微妙之处不会出错。而且您有义务将您的查询与您的运行时参数连接起来，因为没有提供适当的参数。所以这个方法的所有用户都将使用字符串方法（脆弱、不可测试、sql注入）来构建他们的SQL，并且没有一个是单元测试的。

其他答案也有同样的错误，只是更多。SQL 埋在双引号中。SQL 注入机会散布在各处。尊敬的同行，这绝对是野蛮的行为。如果这是 C# 生成的，那将是一场火焰战争。我们甚至不接受以这种方式生成 HTML，但不知何故它可以用于 SQL。我知道查询参数不是问题的主题，但我们复制并重用我们看到的内容，这里的答案既是模型，也是人们正在做的事情的证明。

EF融化了我们的大脑吗？EF 不希望你用 SQL，那为什么要用 EF 做 SQL。

想要使用 SQL 与关系数据库对话是成年人的一种健康、正常的冲动。**[QueryFirst](https://marketplace.visualstudio.com/items?itemName=bbsimonbb.QueryFirst)**展示了如何智能地完成此操作，您的 .sql 文件中的 sql，在您键入时进行验证，并为表和列提供智能感知。C# 包装器由该工具生成，因此您的查询可以在代码中发现，并为您的输入和结果提供智能感知。端到端强类型，无需担心类型。无需记住列名或其索引。还有许多其他好处......连接的诱惑被*消除了*. 也可能错误地处理您的连接。您的所有查询和访问它们的代码都会针对您的开发数据库进行持续集成测试。数据库中的架构更改作为应用程序中的编译错误弹出。我们甚至在包装器中生成了一个自测方法，因此您可以针对现有的生产数据库*测试*您的应用程序的新版本，而不是等待电话响起。还有人需要说服吗？

免责声明：我写了 QueryFirst :-)

# xml - 如何通过 XPath 的链接文本找到链接 URL？

> ID：915338
> 
> 赞同：92
> 
> 时间：2009-05-27T12:05:42.473
> 
> 标签：xml, xhtml, xpath

我有一个格式良好的[XHTML](http://en.wikipedia.org/wiki/XHTML)页面。当我有链接的文本时，我想找到链接的目标 URL。

例子

```
<a href="http://stackoverflow.com">programming questions site</a>
<a href="http://cnn.com">news</a> 
```

我想要一个[XPath](http://en.wikipedia.org/wiki/XPath)表达式，这样如果给出`programming questions site`它就会给出`http://stackoverflow.com`，如果我给出它`news`就会给出`http://cnn.com`.

* * *

## 回答 #1

> 赞同：151
> 
> 时间：2009-05-27T12:08:30.253

应该类似于：

```
//a[text()='text_i_want_to_find']/@href

```

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2011-05-23T20:00:53.477

对你来说太晚了，但对于其他有同样问题的人来说......

```
//a[contains(text(), 'programming')]/@href 
```

当然，“编程”可以是任何文本片段。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-27T12:10:01.437

```
//a[text()='programming quesions site']/@href 
```

它基本上识别具有您想要的文本的锚节点`<a>`，并提取`href`属性。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-27T14:50:28.430

将方括号中的短语视为 SQL 中的 WHERE 子句。

所以这个查询说，“选择出现在任何地方（//）的“a”标签的“href”属性（@），但只有在（括号内的短语）“a”标签的文本内容等于“编程问题网站'”。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-01-03T21:42:44.667

对于不区分大小写的包含，请使用以下内容：

```
//a[contains(translate(text(),'PROGRAMMING','programming'), 'programming')]/@href 
```

translate 将 PROGRAMMING 中的大写字母转换为小写编程。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-13T22:13:44.357

如果您使用的是 html 敏捷包，请使用 getattributeValue：

```
$doc2.DocumentNode.SelectNodes("//div[@class='className']/div[@class='InternalClass']/a[@class='InternalClass']").GetAttributeValue("href","") 
```

# iphone - NSNumber 对于实例级计数器是否过度杀伤？

> ID：915341
> 
> 赞同：9
> 
> 时间：2009-05-27T12:06:41.723
> 
> 标签：iphone, objective-c, cocoa, nsnumber, nsinteger

我是 Objective-C 和 Cocoa 的新手。我读过 NSInteger 和 NSNumber 在处理简单整数时是首选，因为它们是原始数字类型的“平台安全”版本（在 NSNumber 的情况下，包装在一个对象中）。所以，我需要在我的班级中有一个计数器，当 NSTimer 触发时它会增加。在 Apple 论坛上，我发现一群人都向处于类似情况的人推荐他们应该在标头中声明一个 NSNumber 指针，使用 numberWithInt: 对其进行初始化，然后每次需要递增时，将其分配给一个新对象（类似于`counter = [NSNumber numberWithInt:[counter intValue]+1];`）。这对我来说似乎有点矫枉过正。如果我只需要一个 int 计数器（顺便说一句，我在它达到 15 后将它重置回 0，所以大小不是问题），我不能只使用一个 int 而不必分配一个我的计时器循环的每次迭代都有新对象？

如果是这样，我如何在整个班级中提供原始类型。我知道对于对象类型，我在我的界面中声明它并使用@property 和@synthesize ...当使用原语时，什么是等效的（如果存在的话）？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-27T12:17:08.567

使用 NSNumber 做一个简单的计数器确实看起来有点过头了。您可以将类成员声明为 NSInteger 并使用 ++ 或 += 简单地更新它们

例如：

```
@interface YourViewController : UIViewController  {
NSInteger counter;      
}

@property (nonatomic,assign) NSInteger counter; 
```

@synthesize 只是：

```
@synthesize counter 
```

并且可以通过以下方式增加：

```
self.counter += 1; 
```

或者

```
counter ++; 
```

后者将阻止任何观察者被告知，因此可能不是可取的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-27T12:21:32.520

NSNumber 是数字的对象表示。我在将数字存储在集合类中时使用它，因为它们只能保存对象指针。

所以在你的例子中，它需要一个计数器，它可能是矫枉过正的。

NSInteger 只是一个经过类型定义的整数，对于 32 位和 64 位程序是安全的，Apple 建议使用它来代替`int`. 它不是一个对象。这可能是您需要的计数器（实际上是 NSUInteger，它是一个`unsigned int`）可能会更好。

至于在整个班级中提供原语 - 好吧，如果您在标头中将其声明为 iVar，那么无论如何它在整个班级中都可用。`@property`并且`@synthesize`只是 Objective-C 2.0 将这些声明为可以在您的类之外以符合 KVC/KVO 的方式看到（并且可能更改）的属性的方式。原始类型可以用作属性，使用相同的`@property`语法`@synthesize`。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-27T12:23:21.300

我使用`NSInteger`（不是 int，更便于移植），`NSNumber`如果需要将其添加到集合中（例如`NSMutableDictionary`在退出应用程序时保存状态时），我将其包装到 a 中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T12:24:53.480

我同意您的直觉，将对象用于简单的计数器听起来有点矫枉过正，并且会添加不必要数量的消息调度调用来简单地增加计数器。对于不需要存储在集合中或作为对象操作的计数器，请坚持使用 C 标量类型。

要将标量声明为类的实例变量，只需在头文件中声明它：

```
@interface MyClass: NSObject{
  int counter;
}

@end 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-08-16T12:58:08.877

如果您*确实*需要增加 NSNumber（例如对于 NSManagedObject 属性），我发现这个类别有帮助：

```
@interface NSNumber (Incrementer)
- (NSNumber *)increment;
@end

@implementation NSNumber (Incrementer)
- (NSNumber *)increment {
    return [NSNumber numberWithInt:[self intValue]+1];
}
@end 
```

因此您可以将增量语句简化为：

```
counter = [counter increment]; 
```

# asp.net - 在 asp.net 应用程序中“找不到指定的模块”

> ID：915351
> 
> 赞同：1
> 
> 时间：2009-05-27T12:09:27.817
> 
> 标签：asp.net, assemblies

我只是试图将我的整个 Web 应用程序复制到另一台（虚拟）机器上的 Visual Studio 2008 的新实例。

它构建得很好，但是当我尝试运行应用程序时，我只收到消息“找不到指定的模块”。

有谁知道我如何找出这条消息指的是哪个模块？因为有很多，据我所知，它们都已安装。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T14:48:56.233

我建议您删除项目的所有临时 ASP.Net 文件，然后重新构建。这将确保重新编译所有新代码并且不再保留旧引用。

有时简单地构建解决方案不起作用，您需要重新构建以强制它向您显示真正的错误或获取正确的参考。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T15:00:39.110

如果您的项目使用 COM 和互操作程序集，您将能够构建（因为程序集在那里），但如果 COM 服务器未在新机器上注册，则会引发运行时异常。

# qt - 当我在 QTableWidget 上使用 restoreState() 时，为什么 Qt 添加了超过三列？

> ID：915352
> 
> 赞同：2
> 
> 时间：2009-05-27T12:09:29.503
> 
> 标签：qt, qtablewidget

我的代码看起来像下面这样：

```
table = QTableWidget()
table.horizontalHeader().restoreState(settings.value("savedState"))
table.setColumnCount(3)

settings.setValue("savedState", table.horizontalHeader().saveState()) 
```

如果我第一次运行它，它只有 3 个列标题。第二次有 6，第三次有 9...奇怪的`table.columnCount()`是总是 3。如果我删除`table.setColumnCount(3)`，则根本没有列。

为什么会发生这种情况，是错误还是故意的？

### 更新

`table.clearContents()`之前添加`table.setColumnCount(3)`使它工作。我仍然认为这是一个错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T14:39:47.547

这是哪个平台和什么 Qt 版本？[http://chaos.troll.no/~hhartz/tablecolumns.tar](http://chaos.troll.no/~hhartz/tablecolumns.tar)使用最新的 Qt 4.5 似乎可以正常工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T07:58:02.850

会发生什么？

```
table = QTableWidget();
table.setColumnCount(3);
table.horizontalHeader().restoreState(settings.value("savedState")); 
```

# javascript - js似乎找不到我的表单

> ID：915355
> 
> 赞同：0
> 
> 时间：2009-05-27T12:10:05.447
> 
> 标签：javascript

```
<div class="poll"> 

    <h1>Poll</h1>
    <form name="pollvoteform1" method="post" xxaction="/plugins/content_types/poll/poll.php">
    <p class="tekstaanmelden"><b>Het regent </b></p>
    <input type="hidden" name="poll" value="1">
    <input type="hidden" name="cmd" value="">
            <div class="pollOption"><input type="radio"  class="stelling" name="poll_option1" value="1"></div><div class="pollOptionText">Eens</div><br clear="all"><div class="pollOption"><input type="radio"  class="stelling" name="poll_option1" value="2"></div><div class="pollOptionText">Oneens</div><br clear="all"><div class="pollOption"><input type="radio"  class="stelling" name="poll_option1" value="3"></div><div class="pollOptionText">Waar</div><br clear="all"><div class="pollOption"><input type="radio"  class="stelling" name="poll_option1" value="4"></div><div class="pollOptionText">Niet waar</div><br clear="all">
            <input type="button" name="bt_submit" class="pollButtonNormal" onmouseover="this.className='pollButtonHigh';" onmouseout="this.className='pollButtonNormal';" value="Stem" onclick="javascript:vote1();" style="padding-bottom: 3px; margin-top: 5px;">
            <input type="button" name="bt_submit2" class="pollButtonNormal" onMouseOver="this.className='pollButtonHigh';" onMouseOut="this.className='pollButtonNormal';" value="Bekijk resultaten" onclick="javascript:viewResults1();"  style="padding-bottom: 3px; margin-top: 5px; width:98px;">
    </form>
</div>
<div style="display:none;width: 175px;">

    <form><input type="button" name="bt_submit" class="pollButtonNormal" onmouseover="this.className='pollButtonHigh';" onmouseout="this.className='pollButtonNormal';" value="Resultaten" onclick="javascript:viewResults1();" style="padding-bottom: 3px; margin-top: 10px; "></form>
</div> 
```

在我的脚本中，我有：

var r=document.forms.pollvoteform1.poll_option1;

但我得到了错误：

document.forms.pollvoteform1 未定义我不明白为什么。因为 pollvoteform1 和 poll_option_1 都在那里。

//更新：完整的js代码

```
 function vote() {
var r=document.forms.pollvoteform1.poll_option1;
var voted=false;
if (r.value!=null && r.checked){
voted=true;
} else {
for (i=0;i<r.length;i++){
if (r[i].checked) {
voted=true;
break;
}
}}

if (voted) {
document.forms.pollvoteform1.submit();
} else {
alert("you didn't make a choice yet");
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T12:18:40.950

它要么

```
var r=document.forms['pollvoteform1'].poll_option1; 
```

或者如果那不起作用

```
var r=document.forms[0].poll_option1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T12:35:14.223

尝试在表单中添加 ID 标签。它应该与名称标签相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T12:39:29.647

您的代码在 IE7 和 Firefox 3.0.10 中运行良好。

您使用的是哪个浏览器？

# linq - LINQ 如何实现 SingleOrDefault() 方法？

> ID：915357
> 
> 赞同：2
> 
> 时间：2009-05-27T12:10:11.250
> 
> 标签：linq

如何在 LINQ 中评估 SingleOrDefault() 方法？它在幕后使用二分搜索吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-27T12:17:43.510

比试图用文字解释更好，我想我只需在 .NET Framework 中发布确切的实现代码，使用 Reflector 程序检索（并稍微重新格式化）。

```
public static TSource SingleOrDefault<TSource>(this IEnumerable<TSource> source)
{
    if (source == null)
        throw Error.ArgumentNull("source");

    IList<TSource> list = source as IList<TSource>;
    if (list != null)
    {
        switch (list.Count)
        {
            case 0:
                return default(TSource);
            case 1:
                return list[0];
        }
    }
    else
    {
        using (IEnumerator<TSource> enumerator = source.GetEnumerator())
        {
            if (!enumerator.MoveNext())
                return default(TSource);

            TSource current = enumerator.Current;
            if (!enumerator.MoveNext())
                return current;
        }
    }

    throw Error.MoreThanOneElement();
} 
```

观察到如果对象是 type 则进行优化是很有趣的`IList<T>`，这似乎很明智。它只是退回到枚举对象，否则如果对象没有实现比 更具体的东西`IEnumerable<T>`，并且按照您的期望进行。

请注意，它不能使用二进制搜索，因为该对象不一定代表已排序的集合。（事实上​​，在几乎所有使用情况下，它都不会。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T12:14:04.533

我假设它只是执行查询，如果结果计数为零，则返回该类的默认实例。如果结果计数为 1，则返回该实例，如果结果计数大于 1，则引发异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T12:12:52.070

我认为它不会进行任何搜索，它只是获取源的第一个元素[列表、结果集等]。

我最好的猜测是它只是拉出第一个元素。如果没有第一个，则返回默认值（null、0、false 等）。如果有第一个，它会尝试提取第二个结果。如果有第二个结果，则会引发异常。否则返回第一个结果。

# c# - 注册计时器经过的事件

> ID：915359
> 
> 赞同：3
> 
> 时间：2009-05-27T12:10:34.273
> 
> 标签：c#, .net, delegates, timer

我想创建一个初始化计时器的类，该计时器将用作其他类成员的中心核心，以便为计时器已用事件注册自己。我的问题是我真的不知道如何将计时器经过事件公开给其他类。我认为可能可行的一种解决方案是，我只是将计时器公开为一个公共属性，该属性将返回计时器对象，并且我可以从该对象调用计时器经过事件，例如：

```
MyAppTimer appTimer = new MyAppTimer();
Timer timer = appTimer.GetAppTimer;
timer.Elapsed += SomeMethod; 
```

但是通过这个解决方案，我将暴露我不想要的整个计时器。如何在 MyAppTimer 类中传入一个方法，该方法将在内部使用计时器的经过事件注册该方法？和代表有关系吗？也许是这样的：

```
public void RegisterHandler(someStuffGoesHere) //What do I pass in here?
{
  timer.Elapsed += someStuffGoesHere;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T12:13:40.757

您可以使用显式访问器创建事件：

```
public event EventHandler TimerElapsed
{
    add { timer.Elapsed += value; }
    remove { timer.Elapsed -= value; }
} 
```

您班级的客户可以直接订阅 TimerElapsed 事件：

```
appTimer.TimerElapsed += SomeHandlerMethod; 
```

如果要使用代码中显示的 RegisterHandler 方法，则参数的类型应为 EventHandler

**编辑：**请注意，使用这种方法，sender 参数的值将是 Timer 对象，而不是 MyAppTimer 对象。如果这是一个问题，你可以这样做：

```
public MyAppTimer()
{
    ...
    timer.Elapsed += timer_Elapsed;
}

private void timer_Elapsed(object sender, EventArgs e)
{
    EventHandler handler = this.TimerElapsed;
    if (handler != null)
        handler(this, e);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T12:20:55.750

正如其他人所提到的，公开事件可能是您想要的方式，但要回答您关于 RegisterHandler 方法所需类型的问题，它看起来像：

```
using System.Timers;

...snip...

public void RegisterHandler(ElapsedEventHandler callback)
{
  timer.Elapsed += callback;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T12:14:57.400

您想在课堂上公开一个事件，例如：

```
class A
{
    public event EventHandler<EventArgs> Elapsed;

    private void OnElapsed()
    {
         if(Elapsed!=null)
                 Elapsed(new EventArgs());
    }
} 
```

在 OnElapsed 私有方法中，您有一个如何引发事件的示例。然后，您可以像使用 Timer 一样使用类 A。

# iphone - UIWebView 包括。内容编码/解码

> ID：915366
> 
> 赞同：1
> 
> 时间：2009-05-27T12:11:44.803
> 
> 标签：iphone, uiwebview, nscoding

我的目标：在应用程序中断时继续网络会话（例如，读取的传入短信）。

**方法 A：** 我尝试​​将 UIWebView 的内容存储在 NSUserDefaults 中，如下所示：

```
NSData *webViewData = [NSKeyedArchiver archivedDataWithRootObject:webView];
[[NSUserDefaults standardUserDefaults] setObject:webViewData forKey:kDefaultsWebViewObjectKey]; 
```

然后像这样恢复它：

```
NSData *dta = [[NSUserDefaults standardUserDefaults] objectForKey:kDefaultsWebViewObjectKey];
webView = [NSKeyedUnarchiver unarchiveObjectWithData:dta]; 
```

但这不包括内容。

**方法 B：** 我还尝试通过以下方式获取 UIWebView 的内容：

```
NSString *content = [webView stringByEvaluatingJavaScriptFromString:@"document.body.innerHTML;"]; 
```

然后存储它，并再次检索它，然后尝试在 UIWebView 中设置它：

`- (void)loadData:(NSData *)data MIMEType:(NSString *)MIMEType textEncodingName:(NSString *)encodingName baseURL:(NSURL *)baseURL`

但 innerHTML javascript 并未返回全部内容。

有什么想法、建议等吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T05:17:20.517

我最终使用了 NSURLRequests，然后将检索到的 HTTP 正文和 cookie 存储到 NSUserDefaults。

重新进入应用程序后，我阅读了这些并在 UIWebView 和 NSHTTPCookieStorage 上再次设置它们，然后清除这些键的 NSUserDefaults。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T14:30:01.967

如果您的文档没有引用任何资源（或明确引用），您应该能够恢复外层HTML：

```
NSString *content = [webView stringByEvaluatingJavaScriptFromString:@"document.documentElement.outerHTML;"]; 
```

为了获得最流畅的体验，您还必须恢复滚动和缩放属性，并在加载 web 视图时显示缓存的表示

# javascript - $.each 方法优于 for..in 循环的优势？

> ID：915367
> 
> 赞同：0
> 
> 时间：2009-05-27T12:11:51.323
> 
> 标签：javascript, jquery

各种 JavaScript 库（例如 jQuery）提供了一种`each`方法：

```
$.each(myObj, myFunc); 
```

与使用内置`for..in`循环相比有什么优势：

```
for(var i in myObj) {
    myFunc(i, myObj[i]);
} 
```

在这两种情况下，我都必须检查不需要的属性（通常是函数），所以我不明白为什么首先提供每个方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T12:15:55.370

正如[jQuery`$.each(object, callback)`解释](http://docs.jquery.com/Utilities/jQuery.each#objectcallback)所述

> 通用迭代器函数，可用于无缝迭代对象和数组。

为了与其他实用程序功能保持一致，它提供了一种简单的单行 jQuery-fied 语法来使用

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T12:24:50.690

我能想到至少 3 个优点，尽管它们相对较小。

1.  它遵循 jQuery 可链接性范例，允许您在需要时将多个迭代链接在一起。
2.  它为您分解键和值作为回调的参数，从循环中删除此代码。
3.  语法与您可能拥有的其他 jQuery 代码一致，可能会增加可读性。

缺点是一些小的开销——你必须为它为你做的事情付费——并且可能会将它与完全不同的 $().each() 方法混淆。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T12:15:56.977

在[每个示例](http://docs.jquery.com/Each)中，您可以使用`this`来调用当前选定的元素并使用它。

```
$("div img").each(function(i){
    this.id = this.id + "_" + i;
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T12:16:33.247

第一个需要 1 行，另一个需要 3 行。您可以执行链接之类的操作，因此您可以在第一个完成后调用另一个数组函数。

# c# - 如何使用 sql 查询从数据集中获取行？

> ID：915370
> 
> 赞同：0
> 
> 时间：2009-05-27T12:12:10.667
> 
> 标签：c#, .net, asp.net

我需要采取一些行。它们来自 sql TARIH（sql 列）是 smalldatetime 格式。但是给我错误： DataRow[] rows = dsChart.Tables[0].Select("TARIH<='" + datestart + " " + txtStartDateTime.Text + "' and TARIH>='" + dateend + " " + txtEndDateTime .文本+"'");

**无法对 System.DateTime 和 System.String 执行“<=”操作。**

```
 dsChart = eReport.ToDataSet();
                    if (txtStartDateTime.Text != "" && txtEndDateTime.Text != "")
                        if (ValidateHoursGap(txtStartDateTime.Text.Trim()) &&
                            ValidateHoursGap(txtEndDateTime.Text.Trim()))
                        {
                            DataRow[] rows = dsChart.Tables[0].Select("TARIH>='" + datestart + " " + txtStartDateTime.Text + "' and TARIH<='" + dateend + " " + txtEndDateTime.Text+"'");
                            dsChart.Tables[0].Rows.Clear();
                            dsChart.Tables[0].Rows.Add(rows);
                        }
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T12:26:07.893

我的猜测是它没有将您的字符串识别为有效的日期时间。最简单的方法是使用适当的 SQL 函数将字符串转换为日期。

假设是SQL2005，需要使用CONVERT：http: [//msdn.microsoft.com/pt-br/library/ms187928.aspx](http://msdn.microsoft.com/pt-br/library/ms187928.aspx)

所以它看起来类似于： TARIH>=CONVERT(smalldatetime,'" + datestart + " " + txtStartDateTime.Text + "',)

其中 format 是描述您用于字符串的格式的数字，上面的链接有一个有效格式列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T12:27:55.597

我的猜测是它无法解析`datestart + " " + txtStartDateTime.Text`为 DateTime，因此将其视为字符串。

我会在调用该`Select`方法之前进行此转换，然后使用`DateTime.ToString()`将使用的日期时间格式传递`DateTime.Parse`（由内部使用`Select`）。例如，如果 datestart 的格式为“dd/MM/yyyy”并且预期的输入`txtStartDateTime`格式为“HH:mm”

```
int hours = txtStartDateTime.Text.Substring(0,2);
int minutes = txtStartDateTime.Text.Substring(3,2);    
DateTime dtStart = new DateTime(Int32.Parse(datestart.Substring(5)), Int32.Parse(datestart.Substring(3,2)), Int32.Parse(datestart.Substring(0,2)), Int32.Parse(hours), Int32.Parse(minutes)); 
```

然后打电话

```
string dateFormat = "{0:s}";  
DataRow[] rows = dsChart.Tables[0].Select(string.Format("TARIH >= '{0}' AND TARIH <= '{1}'"), dtStart.ToString(dateFormat), dtEnd.ToString(dateFormat)); 
```

# django - 模板 Django

> ID：915371
> 
> 赞同：0
> 
> 时间：2009-05-27T12:12:33.227
> 
> 标签：django, django-models, django-admin, django-templates

我如何在不同的应用程序中使用不同的模板。在一个项目中我有两个应用程序 1）网站 2）广告。我想在广告中使用默认模板，但在网站中使用不同的模板。如何？**或者**在模板中有一种使用“if 条件”的方法，因为我只需要更改模板中的两行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T13:20:49.017

首先，您永远不必在不同的应用程序中使用相同的模板。不同的应用程序可以使用不同的模板，现在的常见做法是将模板目录放在相应的应用程序文件夹中。

此外，对于两行的更改，您可以始终使用 `

```
{% if condition %}
  something
{% else %}
  some other thing
{% endif %} 
```

或者

```
{% ifequal var 'var' %}
  something
{% else %}
  some other thing
{% endifequal %} 
```

都在同一个模板中。

**编辑**

如果你说你想在 diff 应用程序中使用相同的模板，你可以应用模板路径考虑以下事实， **首先 django 模板加载器会在同一个应用程序目录中查找模板，然后在项目的根目录中查找，如果没有找到，它将寻找它 django 自己的模板源。**

因此，如果您想在任何地方使用模板，您可以将它们放在一个名为模板的文件夹中，放置在您的应用程序目录所在的相同路径中。（即项目的根目录）。

```
projectroot/app1/templates/app1.html
projectroot/app2/templates/app2.html
projectroot/app3/
projectroot/templates/common.html 
```

同样，common.html 可用于所有应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T23:19:44.937

使用模板继承[http://www.djangobook.com/en/1.0/chapter04/](http://www.djangobook.com/en/1.0/chapter04/)定义一个基本模板并仅更改所需的块。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-13T07:31:36.970

PL。检查我提出的问题的链接，由 Yuji T 提供答案

[如何在同一个 django 项目中为 2 个应用程序使用 2 个不同的 change_list.html](https://stackoverflow.com/questions/8686362/how-to-use-2-different-change-list-html-for-2-applications-in-the-same-django-pr)

# php - 在 COMET 中将数组传递给 Javascript

> ID：915373
> 
> 赞同：1
> 
> 时间：2009-05-27T12:13:11.883
> 
> 标签：php, javascript, comet

我对 COMET 所做的事情有了基本的了解（服务器端不断循环，并打印出`<script>`标签的方式），所以我只是在摆弄它。

我可以通过这种方式将一个简单的字符串从 PHP 传递到 Javascript，但是 PHP 数组呢？有没有使用这种方法将 PHP 数组传递给 Javascript（将其转换为 JS 数组？？）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T12:54:32.330

JSON 是一种数据格式，它是 JavaScript 的一个子集，其中包括作为数据类型的数组。

请参阅[规范](http://json.org)和[创建它的 PHP 函数](http://www.php.net/manual/en/function.json-encode.php)。

您可以将数组转换为 JSON，然后将其传递给脚本数据中的 JS。

# java - 如何检查可执行 JAR 是否已在另一个 JVM 中完成

> ID：915378
> 
> 赞同：2
> 
> 时间：2009-05-27T12:14:12.660
> 
> 标签：java, process, jar, jvm

伙计们，我遇到了一个令人困惑的问题！我想调用一个可执行 JAR 来使用 runtime.exec() 从我的主要 java 应用程序计算 PI，这会创建一个新的 JVM 来运行可执行 JAR。我的问题是当 PI 计算完成后，JVM 仍然存在。我的主要 java 应用程序不知道 PI 计算是否完成。而且我还希望当 PI 计算完成后，JVM 可以关闭！我该如何实施！谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T12:23:16.450

当您调用 Runtime.exec() 时，您将获得一个 Process 对象。您需要为此调用[waitFor()](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Process.html#waitFor%28%29)。

您还需要捕获 stdout/stderr 流（在单独的线程中以防止阻塞 - 请参阅[此答案](https://stackoverflow.com/questions/882772/capturing-stdout-when-calling-runtime-exec/882795#882795)以获取更多信息）。

这一切都抛开了为什么要在单独的 JVM 中执行此操作，以及为什么不能将相关类加载到当前应用程序并在本地运行库的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T13:19:35.540

要回答问题的第二部分，JVM 总是在没有非守护线程仍在运行时退出。或者用更简单的话来说，当您的应用程序“完成”并且`main`方法退出且没有在后台运行任何线程时，JVM 将完成。

无论您是从桌面/命令行自己启动 Java 进程，还是通过`Runtime.exec()`（大致等效）启动它，这都是正确的。因此，当您的 Pi 计算终止时，它将关闭您生成的 JVM，并且当您的原始程序完成时，*它的*JVM 也将退出。

尽管我在这里完全同意 Brian 的观点，但是当您应该能够在原始 JVM 中运行 Java 应用程序时，我看不到将其作为单独进程运行的好处（除非有一些非常不寻常的环境因素，例如设置 niceness 或处理器各种过程的亲和力）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T13:26:11.203

检查 jar 当你独立运行它时做了什么，也许它正在等待输入，因此它永远不会退出

# javascript - Javascript 最佳实践：处理特定于 Firebug 的代码

> ID：915385
> 
> 赞同：12
> 
> 时间：2009-05-27T12:15:21.613
> 
> 标签：javascript, jquery, firebug

Firebug 无疑是一个很棒的 javascript 调试工具；我广泛使用 console.log()。

我想知道我是否可以将特定于 Firebug 的代码留在生产中。最佳做法是什么？评论调试代码？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-27T12:22:18.883

如果您在生产代码中保留 console.log() 调用，那么使用 Internet Explorer 访问该站点的人将遇到 JavaScript 错误。如果这些人配置了额外的调试工具，那么他们将看到令人讨厌的对话框或弹出窗口。

快速搜索显示该线程讨论了检测 Firebug 控制台是否存在的方法：[http ://www.nabble.com/Re:-detect-firebug-existance-td19610337.html](http://www.nabble.com/Re:-detect-firebug-existance-td19610337.html)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-27T12:24:04.183

以前被这个咬过。理想情况下，所有 console.log 语句都需要在生产之前删除，但这很容易出错，开发人员总是忘记或只在 FF + Firebug 中进行测试。

如果尚未定义一个虚拟控制台对象，一种可能的解决方案是创建一个虚拟控制台对象。

```
if( typeof window.console == 'undefined'){
    window.console = {
        log:function(){}
    };
} 
```

提醒一句：Safari 10.4 曾经是这样，任何对 console.log 的调用都会引发安全异常，因为控制台对象是 Mac OS Dashboard 小部件中使用的保留对象。不确定是否是这种情况，今晚将检查。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-27T12:25:16.240

不久前，我个人修改了我的压缩器，以去除预压缩的控制台引用。在那里添加一个正则表达式几分钟可以节省一生的麻烦。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-27T12:36:43.440

只是想我会为任何 js 调试添加一个非常好的技巧......使用关键字“调试器”，它就像代码中的断点，萤火虫也检测到它，MSIE（如果你有 Visual Studio）也检测到它，就像我一样说它是一个断点。

似乎没有多少人知道这一点，但我发现它非常宝贵......而且如果运行代码的机器上没有安装调试器，则不会发生任何事情并且代码可以正常运行。虽然我不建议把它们留在那儿。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-27T12:21:01.587

我为此而头疼过很多次。

我经常使用console.log()，直到最近，发现它会导致整个JS代码在不使用firebug的FF版本中失败。

我通常在上线之前运行一个查找，然后将其注释掉。

D

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-27T13:12:14.337

一些压缩器会去掉任何前缀为 ;;; 的行。（这是一个合法的序列，是三个空语句。）这样你就不会严格限于控制台引用（即你可以做一些计算，然后 console.log() 最后的结果，压缩器可以把它们都去掉。）我为此使用[JavaScript::Minifier](http://search.cpan.org/%7Epmichaux/JavaScript-Minifier/lib/JavaScript/Minifier.pm)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-08-18T08:19:37.163

我在 OOP Javascript 中使用它，为检查萤火虫是否存在的日志制作自己的包装器：

```
myclass.prototype.log = function()
{ 
    if( typeof window.console != 'undefined' )
    {
        console.log.apply( null, arguments ); 
    }
} 
```

只需致电：

```
this.log( arg1, arg2, ...) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-05-23T16:05:49.457

您可以尝试**JavaScript Debug**，它是 console.log [http://benalman.com/projects/javascript-debug-console-log/的简单包装器](http://benalman.com/projects/javascript-debug-console-log/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-12-24T08:58:27.883

只是提醒一下，IE 开发工具不支持 console.log 上的 apply()。

当开发工具处于活动状态时，调用 console.log.apply() 将在 IE8 中引发异常。

# wcf - 如何从 WCF 客户端应用程序中的 UserNamePasswordValidator 捕获异常？

> ID：915387
> 
> 赞同：2
> 
> 时间：2009-05-27T12:15:48.133
> 
> 标签：wcf, wcf-binding, wcf-security

我使用 netTcpBinding 和安全模式="Message" 和 clientCredentialType="UserName" 编写了简单的 WCF 服务。当我传递有效的用户名和密码时，一切正常，会话以我想要的方式建立。但是，当凭据错误时，尽管我无法在 try catch 块中的客户端应用程序中捕获它，但会引发异常。有没有人有同样的问题？这是我的自定义验证器...

```
public class UserValidator : UserNamePasswordValidator
    {
        static int counter = 0;
        public override void Validate(string userName, string password)
        {
            ++counter;            
            Console.WriteLine(counter.ToString() + " " + DateTime.Now.ToShortTimeString());
            if (userName != "test" || password != "test")

                throw new FaultException("Bad username or password");

                //throw new SecurityTokenException();

        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-20T21:18:03.320

为什么不抛出安全令牌异常？这就是它的用途。此时还没有发送消息，也没有打开通道，因此您无法返回故障。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T13:17:12.813

您是否有设置客户端和服务器之间通道的代码？如果是这样，通道是否无法正确创建 - 与消息安全一样，客户端和服务器必须执行 hadnshake，两者都提供其凭据以打开安全通道。这必须在启用任何进一步的通信之前建立，并且传递无效凭据的事实将停止创建我怀疑的通道。

# python - 如何使用 Python 将字符串中的特定字符序列转换为大写？

> ID：915391
> 
> 赞同：2
> 
> 时间：2009-05-27T12:16:37.850
> 
> 标签：python

我希望完成以下工作，并想知道是否有人对如何最好地进行此操作提出建议。

我有一个字符串，说'this-is,-toronto.-and-this-is,-boston'，我想将所有出现的',-[az]'转换为',-[AZ]'。在这种情况下，转换的结果将是“this-is,-Toronto.-and-this-is,-Boston”。

我一直在尝试使用 re.sub()，但还没有弄清楚如何

```
testString = 'this-is,-toronto.-and-this-is,-boston'
re.sub(r',_([a-z])', r',_??', testString) 
```

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-27T12:29:50.680

re.sub 可以接受一个返回替换字符串的函数：

```
import re

s = 'this-is,-toronto.-and-this-is,-boston'
t = re.sub(',-[a-z]', lambda x: x.group(0).upper(), s)
print t 
```

印刷

```
this-is,-Toronto.-and-this-is,-Boston 
```

# apache-flex - Flex / Flash：如何在多个 SWC 中嵌入相同的字体

> ID：915396
> 
> 赞同：3
> 
> 时间：2009-05-27T12:17:24.230
> 
> 标签：apache-flex, flash, fonts, swc, rsl

我有以下项目结构： - 一个 Flex 项目 (SDK 3.3) - 多个 SWC，带有在 Flex 项目中用作组件的图形和文本字段。

由于我有很多 SWC 在动态文本字段中都使用相同的字体，所以我不想在每个 SWC 中嵌入字体。相反，我想要一个库（RSL？），其中包含所有 SWC 加载字体的字体。

我尝试使用 Flash 中的“导出以供运行时共享”功能使用字体构建库文件。虽然当我留在 Flash 中时它运行良好，但当我尝试在 Flex 中使用这些 SWC 时，Flex 会引发“内部构建错误”。

关于加载字体的好策略有什么想法吗？

非常感谢，科尔特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T13:37:11.243

我过去所做的是使用 flash 来创建一个带有嵌入字体的 swf 文件。如果您不确定我的意思，请查看此链接）该链接还提供了您可能会发现有用的其他信息，它不是我试图找到的链接，但它涵盖了必要的信息[。](http://yourpalmark.com/2009/04/05/embedding-fonts-using-external-swf-files/)

一旦你有了你的字体 SWF，你就可以在每个项目中重复使用它。它不是一个 swc，但它和字体一样好。我使用 CS3 来做到这一点（我在尝试 CS4 试用时提到了这一点，我认为它们可能已经改变了您创建嵌入式字体 swfs 的方式）

您可以使用类似的方式在 CSS 文件中引用字体 swf

```
@font-face
{
  src: url("../theFolderWhereTheFileIs/YourFontFile.swf");
  fontFamily: "NameOfTheFontYouHaveEmbedded";
  font-weight : bold;
} 
```

我为每种类型的字体创建一个单独的 swf 文件并适当地命名它，例如 StoneSansSemiBold.swf 或 StoneSansItalic.swf

# javascript - 在 64 位环境中加载 32 位进程

> ID：915398
> 
> 赞同：3
> 
> 时间：2009-05-27T12:17:34.727
> 
> 标签：javascript, winapi, chm, win64

我有几个问题如下。CHM 是（已编译的 HTML 文件）

我的 CHM 文件有一个用于启动 32 位应用程序的链接。CHM 文件是用 Javascript 编码的。这在 32 位操作系统环境中运行良好。

但这在 64 位操作系统环境中不起作用。原因是：当我打开 chm 文件时，64 位版本的 hh.exe（操作系统可执行文件）执行并启动 chm。并且 chm 在 64 位环境中加载。
现在我无法从 CHM 文件启动 32 位应用程序，因为 64 位进程无法加载 32 位进程。

有什么办法可以让它也适用于 64 位操作系统吗？

我想到了以下几个解决方案，但我不知道如何实现它们。

1）在Javascript代码中，如果我可以检查操作系统是32位还是64位。然后我可以向用户弹出一个明确定义的错误，如果它是64位操作系统。

2）或者如果我可以强制操作系统运行 32 位版本的 hh.exe，以便 chm 在 32 位环境中加载，因此不会出现问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T23:54:59.340

> 现在我无法从 CHM 文件启动 32 位应用程序，因为 64 位进程无法加载 32 位进程

不确定“加载 32 位进程”是什么意思，但 32 位进程肯定可以创建 64 位进程。例如，如果我有 MyApp32.exe，一个 32 位应用程序，它绝对可以启动 MyApp64.exe，一个 64 位应用程序。

当您阅读 32 位和 64 位代码之间的不兼容性时，它指的是 32 位应用程序加载 64 位 DLL，反之亦然。

我怀疑您的问题实际上是您用于启动应用程序的路径与 WOW64 文件系统重定向相冲突。在此方案中，访问 C:\Windows\System32 的 32 位应用程序实际上被重定向到 C:\Windows\SysWow64\System32。[你可以在这里](http://msdn.microsoft.com/en-us/library/aa384187(VS.85).aspx)阅读更多

如果这不起作用，有关如何启动此 32 位进程以及它在文件系统上的位置的更多信息可能会增加一些清晰度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T12:23:04.780

或者 3) 分发由 CHM 启动的应用程序的 64 位版本？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T15:41:05.270

您需要执行 32 位版本的*hh.exe*。为此，使用此路径*%WINDIR%\System32\hh.exe启动**hh.exe*，但在启动应用程序之前，您必须 [禁用 Wow64 文件系统重定向](http://msdn.microsoft.com/en-us/library/aa365743(VS.85).aspx)。

 *这里有一个例子：

```
#define _WIN32_WINNT 0x0501
#include <Windows.h>

void main()
{
    PVOID OldValue;
    HANDLE hFile = INVALID_HANDLE_VALUE;

    BOOL bRet = Wow64DisableWow64FsRedirection (&OldValue);

    if (bRet == TRUE) 
    {
        // Open a file

        hFile = CreateFile(TEXT("C:\\Windows\\System32\\Notepad.exe"),
            GENERIC_READ,
            FILE_SHARE_READ,
            NULL,
            OPEN_EXISTING,
            FILE_ATTRIBUTE_NORMAL,
            NULL);

        // Restore the previous WOW64 file system redirection value.

        Wow64RevertWow64FsRedirection (OldValue);
    }

    if( INVALID_HANDLE_VALUE != hFile )  
    {
        // Use the file handle
    }
} 
```

注意：请记住在调用应用程序后[恢复重定向](http://msdn.microsoft.com/en-us/library/aa365745(VS.85).aspx)

# mysql - 在嵌套选择中使用父查询的结果

> ID：915401
> 
> 赞同：1
> 
> 时间：2009-05-27T12:18:16.600
> 
> 标签：mysql, innodb, nested-queries

我确信这是一个相当微不足道的问题，但我不确定用谷歌搜索什么来找到解决方案。

我有一个看起来像这样的表：

```
CREATE TABLE IF NOT EXISTS `transactions` (
  `name` text collate utf8_swedish_ci NOT NULL,
  `value` decimal(65,2) NOT NULL,
  `date` date NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_swedish_ci ROW_FORMAT=COMPACT; 
```

我通过从我的网上银行服务中剪切和粘贴数据来填充它。值可以是负值或正值，日期和名称包含的内容应该相当明显；）我构建了一个查询，让我看到每个月的底线：

```
SELECT sum(`value`) as 'change', DATE_FORMAT(`date`, '%M %Y') as 'month'
FROM `transactions` 
WHERE 1
GROUP BY year(`date`), month(`date`) 
```

现在我想将月底帐户中的总累积资金添加为附加列。

```
SELECT sum(`value`) as 'change', DATE_FORMAT(`date`, '%M %Y') as 'month', 
(SELECT sum(`value`) FROM `transactions` WHERE `date` <= 123) as 'accumulated'
FROM `transactions` 
WHERE 1
GROUP BY year(`date`), month(`date`) 
```

123 并不是我想要的，但我不明白如何从该子查询中的 DATE_FORMAT 获取结果。

这甚至是解决问题的正确方法吗？

这主要是一个个人练习（在一个非常小的数据集上运行），所以我不太关心性能，可读的 SQL 更为重要。

我在 MySQL 5.0.45 上运行 InnoDB 表

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T12:26:44.773

```
SELECT  change,
        CONCAT(mymonth, ' ', myyear) AS 'month',
        (
        SELECT  SUM(`value`)
        FROM    `transactions`
        WHERE   `date` < DATE_ADD(STR_TO_DATE(CONCAT('01.', mymonth, '.', myyear, '%D.%M.%Y'), INTERVAL 1 MONTH))
        )
FROM    (
        SELECT  sum(`value`) as 'change', YEAR(date) AS myyear, MONTH(date) AS mymonth
        FROM    `transactions` 
        WHERE 1
        GROUP BY 
                YEAR(`date`), MONTH(`date`)
        ) q 
```

您写道，您不追求性能，但这种语法并不复杂，但效率更高（以防万一）：

```
SELECT  SUM(value) AS change,
        CONCAT(MONTH(`date`), ' ', YEAR(`date`)) AS 'month',
        @r : = @r + SUM(value) AS cumulative
FROM    (
        SELECT  @r := 0
        ) AS vars,
        transactions
WHERE 1
GROUP BY 
        YEAR(`date`), MONTH(`date`)
ORDER BY
        YEAR(`date`), MONTH(`date`) 
```

这个也将计算累积`SUM`的，但它每个月只计算一次。

# stored-procedures - StoredProcedures.cs 为空

> ID：915407
> 
> 赞同：1
> 
> 时间：2009-05-27T12:19:17.050
> 
> 标签：stored-procedures, subsonic

当我通过 SubCommander/sonic.exe 生成 DAL 时，我得到一个空的 StoredProcedures.cs 里面的所有内容是：`using System; using System.Text; using System.Data; using System.Data.SqlClient; using System.Data.Common; using System.Collections; using System.Collections.Generic; using System.ComponentModel; using System.Configuration; using System.Xml; using System.Xml.Serialization; using SubSonic; using SubSonic.Utilities;`

有谁知道为什么会这样？

我正在使用 SubSonic 2.1，所有其他类都正确生成。

编辑：我试过： GRANT ALL ON PROCEDURE testDb.testStoredProc TO 'testUser'@'%'; 但即使用户拥有存储过程的所有特权，它也不会出现。

编辑 2：我正在使用 MySQL 5 数据库

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T15:57:37.403

您是否在配置选项中定义了 includeProcedureList 或 excludeProcedureList。我猜你有类似 excludeProcedureList="*" 或 includeProcedureList=""

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T14:13:12.033

这是 Oracle 提供程序的一个已知错误。你用的是什么数据库？

# vb.net - 如何在应用程序文件夹中为基于 Windows 的应用程序创建卸载命令

> ID：915409
> 
> 赞同：4
> 
> 时间：2009-05-27T12:20:23.927
> 
> 标签：vb.net, winforms

在 Visual Studio 2008 中创建新的安装项目时，谁能向我解释如何在应用程序文件夹中为基于 Windows 的应用程序创建卸载命令。

我在网上找到了信息，但到目前为止没有任何帮助。如果您可以向我提供链接或说明，那就太好了。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T12:25:10.423

使用 msiexec 进行卸载的命令行：

> msiexec /卸载 {GUID}

{GUID} 是安装包的产品代码，您可以在安装项目属性中找到它。卸载程序可以像使用该命令一样简单，也可以是单独的应用程序，执行命令并执行额外的自定义清理。

LE 另外，[这里](http://msdn.microsoft.com/en-us/library/aa372024(VS.85).aspx)是 Microsoft 的 msiexec 在线文档。

LE 好[文章](http://blogs.microsoft.co.il/blogs/shair/archive/2008/06/29/add-an-uninstall-shortcut-to-setup-project.aspx)，提供用于创建执行卸载的 C# 应用程序的代码片段

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T12:25:51.107

在 Visual Studio.NET 中：

*   文件 > 添加项目 > 新项目 > 设置和部署项目 > 设置项目（输入名称和位置）
*   添加（右键单击应用程序文件夹 > 添加 > 项目输出）：

    *   初级输出
*   如果应排除的文件出现错误 > 在解决方案资源管理器中选择您的安装项目 > 排除这些文件（右键单击 > 排除）

*   构建 > 构建“命名项目”</p>

在 Windows 中：

*   创建一个 Uninstall.bat 文件，其中包含：C:\WINDOWS\system32\MsiExec.exe /I{productcode}

    （路径取决于您的 Windows 版本，请检查您的 system32 文件夹所在的位置）

    （您将在刚刚创建的安装项目的 Visual Studio.NET > 选项卡属性中找到产品代码）

*   如果您关闭了安装项目，请在 Visual Studio.NET 中打开它

*   添加（在应用程序文件夹中单击鼠标右键）：

    *   添加 > 项目输出 > 文件 > Uninstall.bat

    *   创建新快捷方式 > 应用程序文件夹 > 主要输出（输入名称）

    *   创建新快捷方式 > 应用程序文件夹 > Uninstall.bat（输入名称）

    *   添加 > 文件 > 添加要用于快捷方式的 .ico 文件

*   快捷方式属性 > 'icon' 属性（使用您刚刚添加的图标）

*   将快捷方式移动到用户的桌面/用户的程序菜单（您也可以创建子文件夹）

*   构建 > 重建“命名项目”</p>

设置现已准备就绪。您可以通过 Setup.exe 安装（默认位于“Debug”文件夹下，您可以在 Visual Studio.NET 中更改它 - 右键单击​​您的安装项目 > 属性 > 输出文件名）。快捷方式将自动添加到相应的文件夹（桌面/开始菜单）中。

您可以通过 Uninstall.bat 卸载程序（或通过快捷方式 naar Uninstall.bat）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-02-03T17:13:38.087

直接向安装项目添加带有参数的卸载快捷方式要容易得多，而不是创建批处理文件或将代码添加到 main() 子或启动表单。这应该适用于使用 Visual Studio 的任何 .net 语言。我使用 VS2008 为 VB .net 工作了几个项目。就是这样：

1.  转到安装项目中的文件系统定义。右键单击文件夹部分（左窗格）并添加特殊文件夹 - 系统文件夹。
2.  在左侧窗格中选择新添加的系统文件夹，在右侧窗格中，右键单击并选择“添加文件”。
3.  添加文件 msiexec.exe 在您的 system32 文件夹中（很可能是 c:\windows\system32）
4.  返回左窗格并在用户的程序菜单文件夹中向下钻取到要保存卸载快捷方式的文件夹。选择它。
5.  在右窗格中右键单击并选择“创建新快捷方式”。在对话框中，单击系统文件夹，然后单击 msiexec.exe 文件。单击确定，然后将快捷方式重命名为您想要的任何内容，例如“卸载 MyProgram”。
6.  右键单击新的快捷方式并选择“属性窗口”。
7.  在属性窗口中，在参数变量类型 /x [ProductCode] 中（/x 和 [ProductCode] 之间有一个空格如果需要，您可以使用其他开关代替 /x - 检查 msiecec 的可用开关。可执行程序。

而已。现在，当您运行安装项目时，它会在用户的程序菜单中添加一个快捷方式来卸载程序。另一条评论，在编译时，您将收到一条警告，指出 msiexec.exe 应该被排除，因为它的源文件受 Windows 系统文件保护。忽略这个警告。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-18T12:25:45.327

您可以从您的**应用程序设置项目**的**属性窗口**中获取此产品代码

***设置项目***

. [在解决方案资源管理器中选择项目节点并单击 F4 并复制产品代码。] 这看起来类似于 ... {21F66170-1C81-40E1-AB96-3303FF098425}

![在此处输入图像描述](https://i.stack.imgur.com/3Z7mA.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-04-27T23:07:42.663

我也不知道如何找到这个难以捉摸的产品代码，但要回答你关于删除文件夹的其他问题，我发现这个文档可以帮助你

[http://www.codeproject.com/KB/install/NET_Uninstaller.aspx](http://www.codeproject.com/KB/install/NET_Uninstaller.aspx)

# iphone - 设备上的 NSTimer 比模拟器慢

> ID：915410
> 
> 赞同：2
> 
> 时间：2009-05-27T12:20:25.410
> 
> 标签：iphone, objective-c, core-graphics

我是 iPhone 开发的新手。我用于`[NSTimer scheduledTimerWithTimeInterval:0.01]`游戏循环。游戏包含画屏功能，我用它`CGContextClipToRect`来剪辑大图像以制作动画。

但是 0.01 秒的速度仅在模拟器中运行，而不在设备上运行。我该如何克服这个问题？

计时器代码在视图控制器中为

```
(void)viewDidLoad {
    GameView *main = [[GameView alloc] 
    initWithFrame:[[UIScreen mainScreen] applicationFrame]]; 
    main.backgroundColor = [UIColor blackColor]; 
    self.view = main; 
    [main release];    
    self.tim = [NSTimer scheduledTimerWithTimeInterval: 0.01         
    target: self selector: @selector (gameloop:) userInfo: nil repeats: YES]; 
    [super viewDidLoad];
} 
```

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T15:22:16.247

NSTimer 是这项工作的错误工具。它并不意味着是一个实时计时器。它无法保证何时触发，并且您很容易错过帧。

[关于如何在这个线程](https://stackoverflow.com/questions/96265/what-is-a-better-way-to-create-a-game-loop-on-the-iphone-other-than-using-nstimer)上开发这种程序有很多很好的建议。请特别注意对 Apple 示例代码的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T08:25:34.230

我的意思是，例如，当我为帧设置动画时，帧在模拟器中以正确的速度显示。但在设备中它显示非常慢（FPS），换句话说，一个男孩在模拟器中跑得很快。但在设备中他走路。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T15:16:25.523

正如 U62 所说，100fps 不是一个现实的期望，尝试以 30 帧的速度运行它，也许每秒 60 次更新，看看它是如何运行的。此外，如果您编写的游戏需要以高帧速率运行，您应该考虑使用 OpenGL 编写它。

一种选择可能是在每个滴答声中处理逻辑，但每隔几个滴答声就绘制到屏幕上。

# iphone - 有没有办法让一个不可见的 UIButton 仍然“存在”并为我的 UIImageView 捕获触摸事件？

> ID：915416
> 
> 赞同：30
> 
> 时间：2009-05-27T12:21:16.983
> 
> 标签：iphone, cocoa-touch, uikit, uiimageview

我认为很聪明，只是在具有确切帧大小的 UIImageView 上放置一个透明的 UIButton，这样我就可以轻松地将它与我喜欢的任何事件（例如 TouchUpInside）连接起来，并使其在调用视图控制器的操作方法时用户触摸它。好吧，它一直有效，直到 alpha 低于 0.1f。如果我做 0.01f，它将不起作用。所以为了让它发挥作用，当你在屏幕上看很长时间时，你会看到 0.1f 的 alpha 透过。这太恶心了；）

似乎 iPhone OS 试图变得聪明，并且如果它在视觉上不存在，则不会捕获按钮上的事件。知道如何解决吗？

当然，我可以创建 UIImageView 的子类并实现 touchesBegan:... 等，但感觉并不优雅。我的意思是......当我想在网络上超链接一张图片时，我永远不想为该图片创建我自己的 HTML 元素，只是在点击它时将它连接到一个 url。这对我来说没有多大意义。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-05-27T12:29:04.097

您应该能够在 Interface Builder 中将按钮的“类型”设置为自定义，并且它不会在 UIImageView 上显示任何文本或图形元素。这样，您无需调整 alpha。如果视图是从代码构建的，请使用：

```
button = [UIButton buttonWithType:UIButtonTypeCustom]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-04-10T21:57:43.597

最好的方法是：

```
myButton.hidden = YES; 
```

您不能使用 buttonType 属性，因为它是只读属性。使用它的唯一方法是动态创建按钮。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-18T15:48:05.407

除了 UIButtonTypeCustom，我将按钮文本颜色设置为以下：

```
[button setTitleColor:[UIColor clearColor] forState:UIControlStateNormal];
[button setTitleShadowColor:[UIColor clearColor] forState:UIControlStateNormal];
[button setTitleColor:[UIColor clearColor] forState:UIControlStateHighlighted];
[button setTitleShadowColor:[UIColor clearColor] forState:UIControlStateHighlighted]; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-11-08T09:15:43.963

您可以隐藏按钮（或任何对象）并通过向其图层添加蒙版来使其保持活动状态。该按钮将不可见，但仍会捕获事件。

```
let layer = CAShapeLayer()
layer.frame = .zero
myButton.layer.mask = layer 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T12:38:34.250

我也相信您可以将图像分配给按钮。

图像可以占据整个框架，如果设置正确，也可以没有其他纽扣伪像。

查看物业

```
UIButtonInstance.currentImage 
```

这样，您就不会使用本质上已经存在的元素来占用您的资源。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-04T07:16:10.183

这是我找到的唯一方法...

```
[yourButton setImage:[UIImage imageNamed:@"AnEmptyButtonWithTheSameSize.png"] forState:UIControlStateNormal]; 
```

照顾好形象。它必须是 .png

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-28T08:29:07.557

自定义 UIButton 响应用户交互，除非它们的 alpha 设置为 0。将自定义 UIButton 放在 imageView 顶部并连接到 buttonPressed 操作。我还为我的 UIView 设置了一个额外的高亮图像，现在它的行为就像一个 UIButton。首先，我定义了 UIView 保持突出显示的持续时间：

```
#define HIGHLIGHTED_DURATION 0.1 
```

然后在按下按钮时将图像视图设置为突出显示，并启动一个计时器以在该持续时间内使其保持突出显示。不要忘记为您的图像视图设置突出显示的图像。

```
- (IBAction)buttonPressed:(id)sender {

[_yourImageView setHighlighted:YES];
_timer = [NSTimer scheduledTimerWithTimeInterval:HIGHLIGHTED_DURATION
                                          target:self
                                        selector:@selector(removeHighlighted)
                                        userInfo:nil
                                         repeats:NO];
} 
```

并且在计时器完成时简单地撤消突出显示：

```
-(void) removeHighlighted{
    _yourImageView.highlighted = NO;

} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-04-10T22:12:41.423

Jasons 上面的回答几乎是正确的，但无法设置按钮类型。因此，要以编程方式创建一个空按钮，请使用以下代码：

```
UIButton* myButton = [UIButton buttonWithType:UIButtonTypeCustom];
myButton.frame=frame;
[self.view addSubview:myButton]; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-05-03T00:05:52.273

这就是我所做的，但使用 UIButton 的子类，后来我发现不应该根据网络对其进行子类化。我的子类被称为 Points

点数 *mypoint=[点数 buttonWithType:UIButtonTypeCustom];

然后，如果您有要添加到按钮的图像： [mypoint setImage:imageNamed:@"myimage"] forstate: UIControlStateNormal];

如果您不添加此图像，则该按钮将对用户不可见，但应响应触摸。这就是我在 imageView 上创建热点的方式，以便让它响应用户交互。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-03-25T10:51:10.577

lazyImageView = [[UIImageView alloc] init];

```
 button=[[UIButton alloc]init];
                        [UIButton buttonWithType:UIButtonTypeRoundedRect];
                        [button addTarget:self
                                   action:@selector(aMethodForVideo:)
                         forControlEvents:UIControlEventTouchUpInside];
                        [button setBackgroundImage:[UIImage    imageNamed:@"BackTransparent.png"] forState:UIControlStateHighlighted];
                        [button setTitle:@"" forState:UIControlStateNormal];

                                lazyImageView.frame=CGRectMake(x, y, w, h);
                                button.frame=CGRectMake(x, y, w, h); 
```

设置按钮的框架和图像都具有相同的框架。我使用此代码并且工作正常。还为状态设置按钮背景图像：UIControlStateHighlighted 所以当你点击它时，你会看到点击效果。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-03-18T12:35:53.167

我设法使用以下代码来做到这一点。如果 iPad 是横向的，该按钮将位于屏幕的右上角。

```
 UIButton *adminButton = [UIButton buttonWithType:UIButtonTypeRoundedRect];
    adminButton.frame = CGRectMake(974.0f, 0.0f, 50.0f, 50.0f);
    [adminButton setBackgroundColor:[UIColor clearColor]];
    [adminButton setTag:1];
    [adminButton addTarget:self action:@selector(buttonPressed:) forControlEvents:UIControlEventTouchUpInside];

    [self.view addSubview:adminButton]; 
```

按下“adminButton”将运行以下函数：

```
- (void)buttonPressed:(id)sender  {

int buttonId = ((UIButton *)sender).tag;

  switch(buttonId) {
    case 1:
       NSLog (@"Admin button was pressed");
        break;
    case 2:
        //if there was a button with Tag 2 this will be called
        break;

    default:
        NSLog(@"Key pressed: %i", buttonId);
        break;
   }

} 
```

# sas - SAS 我可以向后进行 sas 过程观察吗

> ID：915419
> 
> 赞同：7
> 
> 时间：2009-05-27T12:22:06.497
> 
> 标签：sas

我知道 Sas 在处理时从数据集顶部的观察开始，然后继续下一个直到它到达底部观察，但是有没有一种简单的方法可以让 sas 先处理底部观察，然后再到顶部?

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-27T13:44:51.247

您可以使用**nobs**和**point**向后处理它，而无需执行任何中间步骤。这是一个例子：

```
data backwards;
  do k= nobs to 1 by -1;
   set sashelp.class nobs = nobs point=k;
   output;
  end;
  stop;
run;
proc print data=sashelp.class;run;
proc print data=backwards;run; 
```

有关所有详细信息，请参阅[此 pdf](http://www2.sas.com/proceedings/sugi28/020-28.pdf)的第 2 页。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-27T13:27:40.920

您当然可以将数据更改为相反的顺序，然后自上而下处理。将变量添加到充当索引的数据集。然后按该变量对数据集进行降序排序。

```
data work.myData ;
 set work.myData ;
 indx = _n_ ;
run ;

proc sort data=work.myData ;
 by descending indx ;
run ; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-03-08T00:23:34.910

您可以使用 PROC SQL在一个**步骤**中翻转您的观察顺序：

```
proc sql;
   create table work.cars as
   select *
   from sashelp.cars
   order by monotonic() desc;
quit; 
```

这里的关键是**按 monotonic() desc**排序，翻译为“按观察值降序排序”。

或者，您可以创建一个视图（而不是创建一个表），该视图将引用原始表，但以相反的观察编号顺序：

```
proc sql;
   create view work.cars_rev as
   select *
   from sashelp.cars
   order by monotonic() desc;
quit; 
```

# javascript - 自动完成文本字段

> ID：915421
> 
> 赞同：0
> 
> 时间：2009-05-27T12:23:04.187
> 
> 标签：javascript, ruby-on-rails, ajax, autocomplete

我正在尝试为我的 Rails 应用程序创建一个自动完成文本字段，遵循 Agile Web Development with Rails, 3rd Ed 示例。但是，如果我只是将他们的演示代码粘贴到：

```
<%= stylesheet_link_tag 'autocomplete' %>
<h1>Editing user</h1>

<% form_tag :action => 'update', :id => @user do %>
  <%= error_messages_for 'user' %>

  <p>Username<br/>
  <%= @user.username  %></p>

  <%# codecite autocomplete %>

  <p><label for="user_favorite_language">Favorite language</label><br/>
  <%= text_field 'user', 'favorite_language'  %></p>   
  <div class="auto_complete" 
       id="user_favorite_language_auto_complete"></div>
  <%= auto_complete_field :user_favorite_language,   
        :url=>{:action=>'autocomplete_favorite_language'}, :tokens => ',' %>

  <%# codecite autocomplete %>
  <%= submit_tag 'Edit' %>
<% end %>

<%= link_to 'Show', :action => 'show', :id => @user %> |
<%= link_to 'Back', :action => 'list' %> 
```

我会收到一条错误消息：

```
undefined method `auto_complete_field' for #<ActionView::Base:0x20ab7dc> 
```

他们还应该告诉我其他什么让这个工作吗？ [http://media.pragprog.com/titles/rails3/code/pragforms/app/views/user/autocomplete_demo.rhtml](http://media.pragprog.com/titles/rails3/code/pragforms/app/views/user/autocomplete_demo.rhtml)

**编辑：**本节在 Scriptculous 下，所以我认为只需安装该库即可。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T12:28:49.933

这可能是一个过时的片段，或另一个自动完成插件。

Rails 的官方自动完成插件位于[http://github.com/rails/auto_complete/](http://github.com/rails/auto_complete/)

您可以像这样安装官方插件：

```
script/plugin install git://github.com/rails/auto_complete.git 
```

**更新：**

显然

```
script/plugin install auto_complete 
```

也可以。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T12:30:02.660

您是否安装了自动完成插件？什么版本的 Rails？此[链接](http://codeintensity.blogspot.com/2008/02/auto-complete-text-fields-in-rails-2.html)可能对 Rails 2 有帮助。

# jquery - 我需要在 jquery 中拖放吗？

> ID：915425
> 
> 赞同：1
> 
> 时间：2009-05-27T12:23:39.303
> 
> 标签：jquery, jquery-plugins, drag-and-drop

我正在寻找这样的插件，我认为找到了它 [http://batiste.dosimple.ch/blog/posts/2008-05-18-1/jquery-drag-and-drop-and-resize-event-委托.html](http://batiste.dosimple.ch/blog/posts/2008-05-18-1/jquery-drag-and-drop-and-resize-event-delegation.html)

但问题是..我如何定义事件？..当对象被丢弃或重新调整大小时，我调用一个函数来打印一些类似的所有更改

```
name:div1;
top:10;
left:12;  
width:100;
height:19; 
```

.. 这可能是这个插件或其他插件吗？

如果有任何插件可以做到这一切？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T15:28:29.397

为什么不使用[jQueryUI](http://jqueryui.com/)？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T15:31:15.803

你看过 JQuery UI 吗？他们有似乎正是您正在寻找的可拖动和可放置类。我包含了一个演示页面的链接，如果它看起来不像你所追求的，你能解释一下情况吗？

[演示站点](http://jqueryui.com/demos/droppable/)

# .net - 为什么我不能编辑我的 DataGridView 中的值，即使它没有设置为只读？

> ID：915426
> 
> 赞同：8
> 
> 时间：2009-05-27T12:23:44.357
> 
> 标签：.net, winforms, datagridview, editing

我有一个未设置为只读的 DataGridView。它的所有列都没有设置为 ReadOnly，并且它绑定的对象也没有设置为 ReadOnly。然而，我不能编辑 DataGridView 项目？DataGridView 的 .DataSource 属性设置为 ReadOnlyCollection<>，但我可以通过编程方式更改元素，但不能从 UI 中更改。这是怎么回事？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-27T12:24:44.543

事实证明，如果您的 DataGridView 绑定到 ReadOnlyCollection，那么即使您可以以编程方式编辑集合中的任何项目，DataGridView 也会限制您更改值。我不确定这种行为是否是故意的，但需要注意。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-06-15T13:16:14.740

我昨天刚刚安装了 VS 2013，最新版本（更新 5）并且仍然存在导致您描述的行为的错误。

简而言之，要解决该错误，首先确保将 datagridview 设置为 GUI 可编辑。这尤其包括控件右上角的表单设计器中的小箭头。在箭头下拉菜单中有一个“启用编辑”选项，确保它已启用。现在在表单设计器中以某种主要方式编辑列（例如添加或删除列）。就是这样，当您运行程序时，您应该会发现 GUI 编辑现在正在工作。

要重现此错误，请在表单设计器中使用 datagridview 控件右上角的小箭头将“启用编辑”设置为 false。现在对列进行重大更改（例如添加或删除列）。编译并运行程序。现在回到小箭头并重新启用“启用编辑”复选框。再次运行程序。在这一点上，错误就显现出来了，即使您在 VS 中进行了其他配置，您也会发现 datagridview 不是 GUI 可编辑的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-27T12:31:45.713

这只是与“DataGridView 将限制您更改某些值（字符串）而不是其他值（布尔值）”点相反的扩展评论（因此是 wiki）；两者都不可编辑；使它成为一个`List<T>`并且两者都是可编辑的......：

```
using System;
using System.Collections.ObjectModel;
using System.Windows.Forms;
class Test
{
    public string Foo { get; set; }
    public bool Bar { get; set; }

    [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        var data = new ReadOnlyCollection<Test>(
            new[] {
                new Test {Foo="abc", Bar=true},
                new Test {Foo="def", Bar=false},
                new Test {Foo="ghi", Bar=true},
                new Test {Foo="jkl", Bar=false},
            });
        Application.Run(
            new Form {
                Text = "ReadOnlyCollection test",
                Controls = {
                    new DataGridView {
                        Dock = DockStyle.Fill,
                        DataSource = data,
                        ReadOnly = false
                    }
                }
            });
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-27T12:52:33.970

你是如何绑定到你的 DataGridView 的？一件事是，如果您使用 Linq 列表作为从数据库查询的数据源并且您没有完整的对象，那么属性是只读的，除非您在 select 函数中指定“with new”。您的帖子中没有很多信息。我希望这有帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-09-15T12:28:12.093

如果您已将网格绑定到已全局定义的集合，请尝试在要绑定的点（函数）中创建该集合的本地克隆副本，并将网格绑定到新集合。这对我有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-06T08:38:08.350

没有什么对我有用。我没有使用绑定。只是将所有内容都设为非只读并将编辑模式设置为（尝试了所有值）。单元格始终是只读的。

我使它工作的方法是在事件处理程序中将单元格设置为 ReadOnly = false ：

```
private void gridViewSettings_CellClick(object sender,dataGridViewCellEventArgs e)
{
        gridViewSettings.CurrentCell = gridViewSettings.Rows[e.RowIndex].Cells[e.ColumnIndex];
        gridViewSettings.CurrentCell.ReadOnly = false;
        gridViewSettings.BeginEdit(true);
} 
```

在此处理程序结束时，单元格处于编辑模式（我单击的单元格）。在 GUI 中进行更改，其余部分（如果有）在 CellEndEdit 事件处理程序中处理。当鼠标离开单元格或您按 Enter 键时，将调用此处理程序。
此时新值保存在 CurrentCell.Value 中；

```
String newValue = (String)gridViewSettings.CurrentCell.Value; 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2016-02-11T12:31:39.483

接受`datagridview`任务并单击编辑列，然后[将列只读属性设置为 False](http://i.stack.imgur.com/FVxvJ.jpg)

# nant - 在 NANT 程序中执行一个简单的计算

> ID：915429
> 
> 赞同：5
> 
> 时间：2009-05-27T12:24:38.520
> 
> 标签：nant

我需要在 NANT 程序中做一个简单的加法，比如 1 + 1 =2。我发现这很困难，因为 NANT 中默认情况下每个变量都被视为字符串。我也尝试过使用 int::parse 但它不起作用。

问候

萨拉蒂

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T12:32:24.573

也许您可以使用[convert::to-int](http://nant.sourceforge.net/release/latest/help/functions/convert.to-int.html)。[这里](http://nant.sourceforge.net/release/latest/help/fundamentals/expressions.html#operators)还有操作员概述。

我还发现了两个可能有助于理解整体用法的示例（[示例 1](http://jayflowers.com/WordPress/?p=101)、[示例 2](http://osdir.com/ml/windows.dotnet.nant.devel/2004-09/msg00045.html)）：

从示例 1：

```
<if test=“${int::parse(UnitTestsResult) != 0}“&gt;
  <fail message=“Atleast one unit test failed!“/>
</if> 
```

来自示例 2：

```
<target name="repeat">
<property name="var1" value="0" overwrite="false" />
<echo message="${var1}" />
<property name="var1" value="${convert::to-int(var1) + 1)" />
<call target="repeat" if="${convert::to-int(var1) < 10}" />
</target> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-11-30T12:41:50.437

```
<property name="a" value="1"/> 
<echo message="${int::parse(a) + 2}" /> 
```

给出：

> [回声] 3

# objective-c - 我是否在基于 iPhone 视图的应用程序中正确使用了 NSTimer？

> ID：915442
> 
> 赞同：0
> 
> 时间：2009-05-27T12:26:38.517
> 
> 标签：objective-c, iphone

我正在为 iPhone 应用程序做一个简单的概念验证（以及重要的信息，我对 Mac OSX 开发很陌生）。我创建了一个带有计时器的基于视图的应用程序。我在应用程序控制器的界面中声明了我的 NSTimer，使用了@property 和@synthesize，并在控制器的 viewDidLoad 方法中使用 scheduleTimerWithTimeInterval 方法对其进行了初始化。我的选择器是一个带有签名的方法，`-(void)someMethod:(NSTimer *)timer`它在接口中声明并在控制器的实现文件中定义。我可以越过我分配计时器的行并看到它指向一个有效对象，但是我的程序不会超过 viewDidLoad 方法的结尾，并且永远不会到达我的方法的第一行调用的断点计时器。还有，我看`GDB: Program received bad signal: "EXC_BAD_ACCESS"`此时在xcode的状态栏中（到达viewDidLoad结束）。我没有在 IB 中做任何事情，只是添加了一个视图和一个选择器，这样我就可以查看 UI 是否真的加载了……它永远不会加载。

那么，我是在 NSTimer 上做错了什么，还是我在其他地方遇到了麻烦？如何使用 xcode 中的调试工具来获取更多信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T13:27:44.913

`EXC_BAD_ACCESS`通常表示内存管理错误，可能无法从应用程序的其他地方看到代码。对于初学者来说，这是一个非常常见的错误，但却是一个需要充分理解的重要主题，所以我建议在这里查看一些关于内存管理的问题，并找到一些指南或教程来查看。它实际上很容易学习。

此外，它不应该受到伤害，但除非您需要在触发事件之间访问计时器，否则您实际上不需要将其存储为实例变量。一旦您创建并启动了一个计时器，它就会被添加到应用程序的运行循环中并由其保留。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T12:41:47.643

你有 NSZombieEnabled 吗？

如果这在过度释放的对象上失败，则可能很有用。

# c++ - 如何创建一个包含自身列表的结构？

> ID：915445
> 
> 赞同：7
> 
> 时间：2009-05-27T12:27:05.787
> 
> 标签：c++, stl, visual-c++-6

我想创建一个包含相同结构列表的结构，如下所示：

```
#include <list>
struct Url
{
    CString strUrl;
    std::list<Url> children;
};

int main()
{
    Url u1, u2;
    u1.children.push_back(u2);
} 
```

此代码未编译。但是当我`std::list`用`std::vector`它替换时工作正常。我怎样才能使它与它一起工作`std::list`？

输出窗口包含以下错误。

```
c:\program files\microsoft visual studio\vc98\include\list(29) : error C2079: '_Value' uses undefined struct 'Url'
        E:\test\Test.cpp(23) : see reference to class template instantiation 'std::list<struct Url,class std::allocator<struct Url> >' being compiled
c:\program files\microsoft visual studio\vc98\include\functional(185) : error C2079: 'value' uses undefined struct 'Url'
        c:\program files\microsoft visual studio\vc98\include\list(285) : see reference to class template instantiation 'std::binder2nd<struct std::not_equal_to<struct Url> >' being compiled
        E:\test\Test.cpp(23) : see reference to class template instantiation 'std::list<struct Url,class std::allocator<struct Url> >' being compiled 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T12:52:44.033

如果您需要解决似乎是 VC6 错误的解决方法，请动态创建列表：

```
#include <list>
#include <string>     // I don't use MFC

struct Url
{
    std::string strUrl;
    std::list<Url> * children;

    Url() {
       children = new std::list <Url>;
    }

    ~Url() {
        delete children;
    }
};

int  main()
{
    Url u1, u2;
    u1.children->push_back(u2);
} 
```

有些人问为什么允许与成员相同类型的列表（在我看来他们是）

```
Url array[5]; 
```

例如作为会员就不会。我在标准中也找不到任何东西，但`sizeof( std:;list <T>)`不依赖于它是一个列表的东西。假设 list 被实现为（这里是一些伪 C++）：

```
list <T> {
   listEntry <T> * first;
}; 
```

那么没有未知的大小可以处理。考虑以下解决提问者问题的最小代码：

```
template <typename T> struct A {
};

struct B {
    A <B> b;
}; 
```

我看不出这不合法的任何可能原因。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-27T12:32:17.007

你能告诉我们你使用的是什么编译器吗？你所做的事情本身并没有错。我在VS2008 SP1上尝试了以下，编译没问题

```
#include <list>

struct Url
{
    std::string name;
    std::list<Url> children;
};

int _tmain(int argc, _TCHAR* argv[])
{
    Url u1,u2;
    u1.children.push_back(u2);
    return 0;
} 
```

您是否可能忘记包含列表？

**编辑**

OP 正在使用 Visual Studio 6.0，Neil 能够确认它确实是 VS6 中的一个错误

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-08-07T19:22:01.503

与其他答案中的主张相反，使用不完整类型实例化任何标准容器（包括）确实是**不**合法的。`std::list`（有关[语言律师](/questions/tagged/language-lawyer "显示标记为“语言律师”的问题")对此的讨论，请参阅例如[How can an incomplete type be used as a template parameter to vector here？](https://stackoverflow.com/q/31345193/3002139)）

此要求仅在 C++17 中放宽了`std::forward_list`,`std::list`和`std::vector`. 对于任何较早的标准，与较新版本的 VC 和 gcc 一起使用的原始代码是非标准扩展。这也适用于您的观察结果`std::vector`。

在 C++17 之前的版本中，要使某个类中`std::list`的某个类`T`成为该类的成员，您确实需要一种解决方法，例如`std::list<T*>`或使用 boost.container 库，该库已经可移植地实现了放宽的要求。

请注意，即使在 C++17 中，您也只能使用不完整的类型实例化类模板本身。当任何成员被实例化时，类型必须仍然是完整的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T12:53:34.297

有趣——您正在尝试创建一个`vector`或`list`不完整的类型。快速浏览一下标准，我找不到任何说明 C++ 标准库中包含的容器类型是否允许这样做的内容。任何一项裁决似乎都是合理的：

**为什么可能不允许：**您不能`X`在`X`.

例如，以下代码无法编译，因为它会创建一个无限深的数据结构：

```
struct X {
    X x;
}; 
```

**为什么允许它：**大多数容器都是可调整大小的，在实践中需要对实际数据元素进行一定程度的间接（指针）。`X`在 的定义中声明指向-的指针是合法的`X`。

正如最后一段所暗示的，解决这个问题的常用方法是使用指向`X`. 例如，以下两个片段编译得很好：

```
struct Y {
    Y* y;
};

struct Z {
    std::list<Z*> zl;
    std::vector<Z*> zv;
}; 
```

有谁（好吧，我的意思是 litb :-P）知道标准容器类型的实际要求是什么？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T13:06:51.057

该代码与 GCC 4.4 完美编译并完美执行。版本 7 之前的 MSVC++ 并不完全符合标准。您应该考虑使用更新的编译器。

# sql-server - 如何从 ruby 连接到 MS Sql Server

> ID：915446
> 
> 赞同：3
> 
> 时间：2009-05-27T12:27:06.363
> 
> 标签：sql-server, ruby, sql-server-2005, odbc

我正在尝试从 *NIX 机器连接到 sql server 2005 数据库：

我有以下配置：Linux 64bit

> ruby -v ruby​​ 1.8.6 (2007-09-24 patchlevel 111) [x86_64-linux] 重要的宝石：dbd-odbc (0.2.4) dbi (0.4.1) active record sql server adapter - as plugin

ruby-odbc 0.9996（安装时没有任何选项。） unixODBC 已安装 freeTDS 已安装

> 猫 /etc/odbcinst.ini

```
 [FreeTDS]
     Description     = TDS driver (Sybase/MS SQL)
     Driver          = /usr/lib/libtdsodbc.so
     Setup           = /usr/lib/odbc/libtdsS.so
     CPTimeout       =
     CPReuse         =
     FileUsage       = 1 
```

数字网络：

```
DRIVER=FreeTDS;TDS_Version=8.0;SERVER=XXXX;DATABASE=XXX;Port=1433;uid=XXX;pwd=XXXX;" 
```

或者

```
DRIVER=/usr/lib/libtdsodbc.so;TDS_Version=8.0;SERVER=XXXX;DATABASE=XXX;Port=1433;uid=XXX;pwd=XXXX;" 
```

我收到以下错误：

```
>>ActiveRecord::Base.sqlserver_connection({"mode"=>"ODBC", "adapter"=>"sqlserver", "dsn"=>my_dns)
DBI::DatabaseError: IM002 (0) [unixODBC][Driver Manager]Data source name not found, and no default driver specified
    from /usr/lib/ruby/1.8/DBD/ODBC/ODBC.rb:95:in `connect'
    from /usr/lib/ruby/1.8/dbi.rb:424:in `connect'
    from /usr/lib/ruby/1.8/dbi.rb:215:in `connect'
    from /opt/ublip/rails/current/vendor/plugins/activerecord-sqlserver-adapter/lib/active_record/connection_adapters/sqlserver_adapter.rb:47:in `sqlserver_connection' 
```

看起来 ODBC 无法找到合适的 ODBC 驱动程序，但我不知道为什么。

我遇到了 /usr/lib/libtdsodbc.so 的问题，它在默认的 debian 软件包 free-tds dev 中为空，但我通过从源代码中删除损坏的软件包和安装解决了这个问题。

将不胜感激任何想法！

注意：我将在 mac 10.5 上使用相同的步骤进行连接

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-02-06T14:05:21.137

这看起来很接近，并且我已经获得了相同类型的设置以在 Ubuntu 8.04（使用 Ruby 1.8.6）上工作。由于这是在 Debian 上，它应该是相似的。

应该安装这些软件包： unixodbc unixodbc-dev freetds-dev libdbd-odbc-ruby tdsodbc

/etc/odbcinst.ini 应该是这样的：

```
[FreeTDS]
Description = FreeTDS unixODBC Driver
Driver = /usr/lib/odbc/libtdsodbc.so
Setup = /usr/lib/odbc/libtdsodbc.so
UsageCount = 1 
```

和 /etc/freetds/freetds.conf：（其中 XXX 是数据库名称，NNN... 是服务器的 IP）：

```
[XXX]
  host = NNN.NNN.NNN.NNN
  tds version = 8.0
  client charset = UTF-8
  text size = 262144
  port = 1433 
```

然后连接：

```
ActiveRecord::Base.sqlserver_connection({"mode"=>"ODBC", 
  "adapter"=>"sqlserver", 
  "dsn"=>"DRIVER=FreeTDS;SERVERNAME=XXX;DATABASE=XXX;uid=XXX;pwd=XXX"
) 
```

# iphone - willAnimateSecondHalfOfRotationFromInterfaceOrientation 未在根视图控制器中调用

> ID：915447
> 
> 赞同：4
> 
> 时间：2009-05-27T12:27:10.683
> 
> 标签：iphone, objective-c

我创建了一个 rootviewcontroller ，然后通过编写使其具有地理敏感性

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation 
{
    return YES;
} 
```

在 rootviewcontroller`willAnimateSecondHalfOfRotationFromInterfaceOrientation`方法被调用并且图像正在调整大小。

我也有一些观点，但是当我旋转屏幕时，视图会旋转，但图像没有调整大小，尽管我使用了相同的

```
-(void)willAnimateSecondHalfOfRotationFromInterfaceOrientation:(UIInterfaceOrientation)fromInterfaceOrientation duration:(NSTimeInterval)duration
{
    UIInterfaceOrientation toOrientation = self.interfaceOrientation;
} 
```

方法，但它不能调用。那么，我能做些什么呢？请帮我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-05-26T21:30:32.127

这也吸引了我。如果您查看 UIViewController 的头文件，我想您会找到答案。那里有评论指出您可以覆盖任何**一个**

*   (void)willAnimateRotationToInterfaceOrientation:toInterfaceOrientation 持续时间：

**或**以下任何一项

*   (void)willAnimateFirstHalfOfRotationToInterfaceOrientation:duration:
*   (void)didAnimateFirstHalfOfRotationToInterfaceOrientation:
*   (void)willAnimateSecondHalfOfRotationFromInterfaceOrientation: 持续时间:

显然，如果您覆盖第一个，那将是唯一被调用的。如果您想从旋转的每个阶段获得反馈，请使用第二组中的任何一个，但不要使用第一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-12-10T07:06:38.897

要考虑的另一件事是，您已经覆盖了 shouldAutorotateToInterfaceOrientation 方法以允许旋转而不是默认的纵向。

例如 ：

```
 - (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    // Return YES for supported orientations
    return YES;
} 
```

如果你不这样做，你实现的方法将不会被调用。

# windows-mobile - 检索电话号码 Windows Mobile

> ID：915448
> 
> 赞同：0
> 
> 时间：2009-05-27T12:27:22.960
> 
> 标签：windows-mobile

如我错了请纠正我。并非所有运营商都实现了可让您检索连接到 SIM 卡的电话号码的功能。所以我很好奇是否有人在 Windows Mobile（主要版本 6.0/6.1）上对此问题有经验

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T13:09:59.957

您无法始终从 SIM 卡中获取电话号码，因为它可能不存在。详情见[http://www.newlc.com/topic-5211](http://www.newlc.com/topic-5211)（基本上，电话号码被网络用来路由到用该号码注册的SIM卡。电话不使用它，所以不需要它。 )

唯一保证在 SIM 上的是 IMSI。有一个如何得到这个的例子：http: [//xman892.blogspot.com/2007/07/how-to-series-retrieving-imsi-and-imei.html](http://xman892.blogspot.com/2007/07/how-to-series-retrieving-imsi-and-imei.html)

SDK 中有一个 C++ 示例，但不保证适用于所有手机。您可以在以下位置找到它：C:\Program Files\Windows Mobile 6 SDK\Samples\Common\CPP\Win32\GetPhoneNumber

这也可能有用：[http ://blog.opennetcf.com/ncowburn/CommentView,guid,309b8b8e-ebc7-4078-a8ba-f174761ea7af.aspx](http://blog.opennetcf.com/ncowburn/CommentView,guid,309b8b8e-ebc7-4078-a8ba-f174761ea7af.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T12:36:54.113

看到这个[问题](https://stackoverflow.com/questions/399863/wm-5-sdk-symbol)。您可以使用 TAPI 获取号码，但我不确定它是否适用于所有电话/运营商。

# .net - 从 .net 代码更改音量

> ID：915454
> 
> 赞同：4
> 
> 时间：2009-05-27T12:28:51.977
> 
> 标签：.net, audio, volume

有没有一种简单的方法可以从托管的 .net 代码中设置音量？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-21T16:42:09.587

这适用于我的 Windows 7：

下载 NAudio (http://naudio.codeplex.com/releases/view/79035) 并在您的项目中引用 DLL。比添加以下代码：

```
 try
        {
            //Instantiate an Enumerator to find audio devices
            NAudio.CoreAudioApi.MMDeviceEnumerator MMDE = new NAudio.CoreAudioApi.MMDeviceEnumerator();
            //Get all the devices, no matter what condition or status
            NAudio.CoreAudioApi.MMDeviceCollection DevCol = MMDE.EnumerateAudioEndPoints(NAudio.CoreAudioApi.DataFlow.All, NAudio.CoreAudioApi.DeviceState.All);
            //Loop through all devices
            foreach (NAudio.CoreAudioApi.MMDevice dev in DevCol)
            {
                try
                {
                    //Set at maximum volume
                    dev.AudioEndpointVolume.MasterVolumeLevel = 0;

                    //Get its audio volume
                    System.Diagnostics.Debug.Print("Volume of " + dev.FriendlyName + " is " + dev.AudioEndpointVolume.MasterVolumeLevel.ToString());

                    //Mute it
                    dev.AudioEndpointVolume.Mute = true;
                    System.Diagnostics.Debug.Print(dev.FriendlyName + " is muted");
                }
                catch (Exception ex)
                {
                    //Do something with exception when an audio endpoint could not be muted
                    System.Diagnostics.Debug.Print(dev.FriendlyName + " could not be muted");
                }
            }
        }
        catch (Exception ex)
        {
            //When something happend that prevent us to iterate through the devices
            System.Diagnostics.Debug.Print("Could not enumerate devices due to an excepion: " + ex.Message);
        } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T12:30:52.503

这篇相当长的文章展示了如何：[在 C# 中控制音量](http://www.dreamincode.net/forums/showtopic45693.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T12:33:53.230

[这篇 CodeProject 文章](http://www.codeproject.com/KB/audio-video/AudioLib.aspx)演示了如何完全控制 Windows 混音器设置，包括系统的主音量。它似乎包含了大部分可怕的 Win API 东西，所以它可能是最简单的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T12:34:15.007

简单的回答：你必须使用互操作。

我写了一个库来为你做各种声音的东西，虽然：

WinnMM.Net：http://winmm.codeplex.com/ [_](http://winmm.codeplex.com/)

# c# - 如何将对象转换为转换器中的 int？

> ID：915457
> 
> 赞同：4
> 
> 时间：2009-05-27T12:29:15.127
> 
> 标签：c#, wpf, converter

我放弃了，这个怎么投？

```
class AmountIsTooHighConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        //int amount = (int)value;
        //int amount = (int)(string)value;
        //int amount = (int)(value.ToString);
        //int amount = Int32.Parse(value);
        //int amount = (int)Convert.ChangeType(value, typeof(int));
        //int amount = Convert.ToInt32(value);
        if (amount >= 35)
        {
            return true;
        }
        else
        {
            return false;
        }
    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        return null;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T12:31:38.740

两者`Convert.ToInt32`或`Int32.Parse`都应该工作......如果他们没有，那么这个值绝对不是一个 int ;）
尝试在你的转换器中放置一个断点来观察这个值，它可能会告诉你为什么它不起作用

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T12:37:58.477

如果该值实际上是一个字符串对象（其内容表示一个整数值），则开销最小：

```
int amount = Int32.Parse((string)value); 
```

`Convert.ToInt32`应该能够处理大多数可能转换为 的内容，例如包含数字的字符串或在可以处理`int`的范围内的任何数字类型。`int`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T12:32:53.417

在 Convert 方法的左括号处放置一个断点。以调试模式启动您的应用程序。当断点被命中时，分析*value*的实际类型。做演员。如果值是字符串，则将其转换为字符串，然后解析结果以获取整数。再次运行程序。这次应该可以了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-30T14:24:19.140

如果该值是一个对象，`ToString()`最好在解析之前转换为字符串`Int int amount = Int32.Parse(value.ToString());`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-08-06T09:59:13.300

答案基本上很简单。因为`IValueConverter`它本身有一个名为的方法`Convert`，所以你不能`Convert`像那样简单地使用对象。

但是，如果您添加正确的前缀，它会起作用：

```
int amount = System.Convert.ToInt32(value); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-08-06T11:07:35.970

```
int amount;
if(int32.TryParse((string)value,out amount)
{
   if(amount>=35)
    {
        return true;
    }
    else
    {
      return false;
    }
}
else
{
  return false;
} 
```

我认为这是最安全的方式！

# asp.net-mvc - ASP.NET MVC 会话 vs 全局 vs 缓存

> ID：915470
> 
> 赞同：7
> 
> 时间：2009-05-27T12:32:42.013
> 
> 标签：asp.net-mvc, caching, session-state

我有一个用 vanilla ASP.NET 编写的应用程序，我想将它移植到 ASP.NET MVC。

然而，我对持久化对象的正确位置感到困惑。我需要坚持有几个原因：

1.  我希望所有人都有一个**单一**的数据库连接，包装在“存储库”或“管理器”样式的对象中。
2.  每个用户都有一个用户对象，需要在每个会话的基础上保存。

通常，我会说#1 将被保存为 Globals.asax 中的静态项目，可以使用`Global.Repository`或类似方法命中。

我通常会说#2 应该是在页面的基类中某处具有会话支持存储的属性。

现在我感到困惑的原因是我听说 MVC 中的会话发生了变化，并且 Global.asax 不再拥有相同的类。此外，页面的概念已被删除，因此向控制器的基类添加属性似乎......错误。

怎么说呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-27T12:50:32.977

您的数据库将进入您的控制器的基类。这个基类应该扩展 Controller，你所有的控制器都应该扩展基类。这是一个小例子：

```
public class BaseController : Controller
{
    private AuthServices _auth;
    private LogHelper _log;
    private Repository _repository;

    /// <summary>
    /// <see cref="AuthServices"/>
    /// </summary>
    protected AuthServices Authorization
    {
        get { return _auth ?? (_auth = new AuthServices()); }
    }

    /// <summary>
    /// <see cref="LogHelper"/>
    /// </summary>
    protected LogHelper Log
    {
        get { return _log ?? (_log = new LogHelper()); }
    }

    /// <summary>
    /// <see cref="Repository"/>
    /// </summary>
    protected Repository Repository
    {
        get { return _repository ?? (_repository = new Repository()); }
    }
} 
```

注意惰性实例化。这使我可以在运行测试之前潜入并使用模拟设置我的私有字段。

至于会话，您的用户对象仍然可以保存在会话中，就像在传统的 ASP.NET 应用程序中一样。几乎所有东西都还在（响应、缓存、会话等），但其中一些已经用 System.Web.Abstractions 中的类进行了包装，以便可以模拟它们进行测试。它们的行为方式仍然相同，尽管您不应该在它们的传统角色中使用它们中的一些（例如，不要使用 Response.Redirect，返回一个 ActionResult，例如执行重定向的 RedirectToRouteResult）。

至于你的问题背后的推理......

不要强调单个数据库连接。根据您的实施，这甚至可能不是一个好主意，因为请求可能会相互影响。只需打开您的连接，使用它，并在完成后处理/关闭它。

此外，MVC 带来的最大变化之一是拒绝了传统 ASP.NET 试图为 Web 开发带来的有状态模型。所有这些框架和视图状态都不再存在（不要注意幕后的人）。您持有的状态越少，您的 Web 应用程序就越不复杂且越健壮。试试看，你可能会喜欢。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T13:13:32.773

如果您使用会话，我建议您使用会话类，这样您只需在代码中指定一次字符串名称，这也会为您提供 IntelliSence。

```
 public static class SessionHandler
{   
    // User Values
    private static string _userID = "UserID";
    private static string _userRole = "UserRole";

    public static string UserID
    {
        get
        {
            if (HttpContext.Current.Session[SessionHandler._userID] == null)
            { return string.Empty; }
            else
            { return HttpContext.Current.Session[SessionHandler._userID].ToString(); }
        }
        set
        { HttpContext.Current.Session[SessionHandler._userID] = value; }

    }

    public static string UserRole
    {
        get
        {
            if (HttpContext.Current.Session[SessionHandler._userRole] == null)
            { return string.Empty; }
            else
            { return HttpContext.Current.Session[SessionHandler._userRole].ToString(); }
        }
        set
        { HttpContext.Current.Session[SessionHandler._userRole] = value; }

    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T12:39:55.043

MVC 中的会话根本没有改变。Global.asax 中的 GlobalApplication 类也仍然存在。页面也存在，您希望引用控制器中的存储库而不是页面。向基本控制器类添加属性很好；我一直都这样做。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-15T16:30:27.030

您可以创建模型绑定器来封装状态。

（请参阅 Steve Sanderson 关于他的购物车实现的 mvc 书）

使用模型绑定器，您可以访问具有 HttpContext 的 controllerContext。

# vb.net - 如何将变量从表单传递到表单？

> ID：915473
> 
> 赞同：3
> 
> 时间：2009-05-27T12:32:58.113
> 
> 标签：vb.net

在处理用户必须逐步完成的表单集合时，在创建该表单的新实例时传递数据更好，还是从以前的表单调用函数更好？我编写了一些代码来调用前面的例程，它看起来很难看，我想不出这样做的原因。我能想出的唯一原因是数据是否很大，并且用户很有可能不会使用这些数据，除非在特殊情况下。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T12:39:08.943

如果您将所有共享数据放在一个类中，然后将对该类实例的引用传递给每个表单上的构造函数，那么数据有多大并不重要，因为它只是每次传递的引用.

这样做的好处是您的表单不会相互关联。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T12:36:30.493

这在很大程度上是一个主观问题。我个人采取了一条似乎更容易维护的路线，供以后必须处理我的代码的人使用。我将实例化表单，使用我试图传递的任何内容加载公共属性，然后使表单可见。这样，任何编辑“新”表单的人都知道所有数据都已预先加载。任何编辑“旧”表单的人都知道在哪里加载任何新属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T12:37:18.260

如果新表单将立即需要数据，那么最好将其传递到此表单的构造函数中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T12:40:12.453

使用新表单，您可以使用 server.transfer 从其他表单传递值您可以在此处阅读有关 Server.Transfer 的信息：http: [//www.dotnet-guide.com/servertransfer.html](http://www.dotnet-guide.com/servertransfer.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T12:40:25.227

您可以拥有一个存储所有数据的全局数据变量。每个表单都可以独立访问它。如果您有一个多线程实现，您可以简单地在全局数据变量的访问器上添加线程安全。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T12:59:15.050

我通常使用的两个主要选项是将信息存储在数据库中，例如 SQLServer 或 MS-Access，如果有很多表单将使用的大量信息，或者如果信息仅用于下一个表单我会将信息传递给该表单，然后根据需要进行存储。即，如果它为它创建一个数据表用作源，将信息存储在隐藏字段中，或者甚至将信息放入它们在加载时需要进入的文本框、标签、组合框等。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-09T02:33:10.263

如果您谈论的是 winforms（不是 webforms），那么您可能应该使用[static class](http://msdn.microsoft.com/en-us/library/79b3xss3.aspx)。使用静态成员来保留上下文对象的引用（或您计划与其他表单共享的任何内容）。所有静态成员都保证在第一次使用之前被初始化。

类似的替代方法是使用单例设计模式来创建[单例类](http://www.yoda.arachsys.com/csharp/singleton.html)。

实际上，这两种解决方案只是使全局访问单个引用成为可能，这是一种有时会被过度使用的力量，所以......要小心。

# java - OSGi 配置管理服务的现有实现？

> ID：915474
> 
> 赞同：11
> 
> 时间：2009-05-27T12:33:03.637
> 
> 标签：java, configuration, osgi

我们正在考虑使用配置管理服务作为主要 API 来配置我们基于 OSGi 的应用程序中的组件。如果我们可以重用一些现有的实现，那就太好了，所以我正在尝试调查和评估最受欢迎的实现。我知道有：

*   [Apache Felix 配置管理员](http://felix.apache.org/site/apache-felix-configuration-admin-service.html)(org.apache.felix.cm)
*   [Equinox 配置管理员](http://www.eclipse.org/equinox/bundles/)(org.eclipse.equinox.cm)

是否有任何其他实现需要考虑？

此外，我无法为这些实现找到任何好的文档。我主要对特定于实现的细节感兴趣。例如，我想知道不同的实现如何持久化配置数据（例如多个属性文件？XML 文件？多个 XML 文件？数据库？，...）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T14:03:31.830

Felix 的 Configuration Admin 有一个保留到文件系统的[默认实现](http://svn.apache.org/viewvc/felix/releases/org.apache.felix.configadmin-1.0.8/src/main/java/org/apache/felix/cm/file/FilePersistenceManager.java?revision=734642)，但它们为您可以插入的替代后端定义了一个服务接口 ( [org.apache.felix.cm.PersistenceManager )。](http://svn.apache.org/viewvc/felix/releases/org.apache.felix.configadmin-1.0.8/src/main/java/org/apache/felix/cm/PersistenceManager.java?revision=734642&view=markup)

默认实现执行以下操作：

> FilePersistenceManager 类将配置数据存储在给定目录内的类似属性的文件中。所有配置文件都位于同一目录中。
> 
> 通过将扩展名“.config”附加到配置的 PID，在配置目录中创建配置文件。通过将封闭的点替换为斜杠，将 PID 转换为相对路径名。PID 中的非符号名称字符使用十六进制的 Unicode 字符代码进行编码。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-01T15:37:58.543

我知道的三个公共实现是

*   [阿帕奇费利克斯](http://felix.apache.org/site/apache-felix-configuration-admin-service.html)
*   Equinox […来源](http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.equinox/compendium/bundles/org.eclipse.equinox.cm/src)（最近移动了）
*   Knopflerfish [...首页](http://www.knopflerfish.org/snapshots/2.3.2.snapshot_trunk_2751/docs/components.html#knopflerfish)和[...来源](https://www.knopflerfish.org/svn/knopflerfish.org/trunk/osgi/bundles/cm)

Equinox 的`ConfigurationAdmin`服务实现似乎不支持对持久性策略的精细控制，就像 Felix 的那样，而且 Knopflerfish 的实现看起来（我只是简单地阅读了源代码）类似于 Equinox 的。

Felix 似乎是最新更新且最可靠的。

目前我能找到的只有这些；在 dm Server，我们决定使用 Felix 的包，现在可以从[SpringSource Enterprise Bundle Repository](http://www.springsource.com/repository/app/)获得，您可以在其中快速搜索`Apache Felix`或`ConfigAdmin`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-01T12:14:14.923

只是为了进一步完成答案：我个人也更喜欢 Felix 实现。有关如何使用 PersistenceManager 更改后端存储方式的示例，另请参阅使用标准 Java 属性文件作为后备存储的[此实现。](http://www.avineas.org/index.php?page=cm-persister)有一些限制，但至少允许您将配置与您的应用程序一起存储，并且与您的 OSGi 框架实现分开。

# wpf - WPF 中的非模态浮动对话框

> ID：915475
> 
> 赞同：7
> 
> 时间：2009-05-27T12:33:11.343
> 
> 标签：wpf, dialog

我想创建一个 UI 序列，用户单击一个按钮，它会在其下方弹出一个小面板，其中包含一个按钮和一个文本框，可能还有一个小项目列表。该对话框是非模态的，更重要的是，当您单击主窗口中的其他位置时，它就会消失。

例如，当您在 Internet Explorer 7 中单击“收藏夹”星形图标或在 Firefox 中单击位置栏中的星形两次时，它会弹出书签编辑器对话框。

实现这一目标的最干净的方法是什么？

我应该使用 UserControl 并在单击按钮时绝对修复它的位置吗？如果是这样，当用户点击其他地方时如何隐藏它？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-27T13:07:30.150

我想说做你正在寻找的最干净的方法是使用[Popup](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.popup.aspx)。Popup 类显示一个浮动在屏幕上其余元素之上的元素，但它是非模态的，并且可以配置为在用户点击离开它时消失 - 非常适合您的非模态对话框。Popup 类的属性允许您控制它相对于另一个控件的显示位置（在您的情况下，您希望用户按下以打开弹出窗口的按钮）。

这是一个全 XAML 示例：

```
<Grid>
    <ToggleButton HorizontalAlignment="Center" VerticalAlignment="Top" 
                  x:Name="PopButton" Content="Pop"/>
    <Popup Placement="Bottom" PlacementTarget="{Binding ElementName=PopButton}" StaysOpen="False" 
           IsOpen="{Binding ElementName=PopButton, Path=IsChecked, Mode=TwoWay}">
        <Rectangle Height="100" Width="200" Fill="Blue"/>
    </Popup>
</Grid> 
```

您还可以使用命令或事件处理程序从代码打开/关闭弹出窗口。

Placement 和 PlacementTarget 属性设置弹出窗口将出现的位置，以及它将相对于哪个控件出现（还有其他选项允许您使其相对于其当前位置和相对于鼠标出现）。将 StaysOpen 设置为 False 将使 WPF 在用户单击弹出窗口外部时自动关闭它。

默认情况下，弹出窗口没有自己的样式 - 它只是浮动内容的容器 - 因此您必须将其样式设置为看起来像您的窗口 chrome/toolbar/etc。作为适当的。

# database - 分层数据模型：邻接表与嵌套集

> ID：915481
> 
> 赞同：12
> 
> 时间：2009-05-27T12:34:16.910
> 
> 标签：database, django, django-models, hierarchy, hierarchical-data

我有一个产品目录。每个类别由不同数量（深度）的子类别组成。级别（深）的数量是未知的，但我很确定它不会超过 5,6 级别。数据更改比读取要少得多。

问题是：哪种类型的分层数据模型更适合这种情况。该项目基于 Django 框架，应考虑其特性（管理 i-face、模型处理......）。

非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T12:40:20.877

`Nested sets`如果您不需要频繁更新或分层排序，则性能更好。

如果您需要树更新或分层排序，最好使用`parent-child`数据模型。

它很容易在`Oracle`and中构建`SQL Server 2005+`，而不是那么容易（但仍然可能）在`MySQL`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T13:46:04.113

对于这种分层数据，我会使用改进的预序树遍历算法 MPTT。如果您不介意对结构的更改有一点惩罚，这可以在遍历树和查找子节点时提供出色的性能。

幸运的是，Django 有一个很棒的库[django-mptt](http://code.google.com/p/django-mptt/)。我已经在许多项目中使用了它，并取得了很大的成功。还有[django-treebeard](http://code.google.com/p/django-treebeard/)提供了几种替代算法，但我没有使用它（而且它似乎不像 mptt 那样受欢迎）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-08-15T05:23:19.643

根据这些文章：

[http://explainextended.com/2009/09/24/adjacency-list-vs-nested-sets-postgresql/](http://explainextended.com/2009/09/24/adjacency-list-vs-nested-sets-postgresql/) [http://explainextended.com/2009/09/29/adjacency-list-vs-nested-sets- mysql/](http://explainextended.com/2009/09/29/adjacency-list-vs-nested-sets-mysql/)

“MySQL 是四大（MySQL、Oracle、SQL Server、PostgreSQL）中唯一一个嵌套集模型表现出不错性能并且可以考虑存储分层数据的系统。”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-12T11:36:54.710

[http://www.sqlsummit.com/AdjacencyList.htm](http://www.sqlsummit.com/AdjacencyList.htm)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-04T02:32:04.057

邻接表更容易维护，嵌套集的查询速度更快。

问题一直在于将邻接列表转换为嵌套集花费了太长时间，这要归功于加载了 RBAR 的非常讨厌的“推送堆栈”方法。所以人们最终会在嵌套集合中进行一些非常困难的维护或不使用它们。

现在，你也可以吃蛋糕了！您可以在不到 4 秒的时间内对 100,000 个节点进行转换，并在不到一分钟的时间内对一百万行进行转换！顺便说一句，全部在 T-SQL 中！请参阅以下文章。

[类固醇的层次结构#1：将邻接列表转换为嵌套集](http://www.sqlservercentral.com/articles/Hierarchy/94040/)

[类固醇的层次结构＃2：嵌套集计算的替代品](http://www.sqlservercentral.com/articles/T-SQL/94570/)

# powershell - 提升 Powershell 脚本

> ID：915482
> 
> 赞同：12
> 
> 时间：2009-05-27T12:34:23.120
> 
> 标签：powershell, permissions, scripting

是否可以提升 powershell 脚本的权限，以便没有管理员权限的用户可以运行该脚本？我们的网络管理员正在尝试寻找更省时的方法来完成某些任务，他们现在必须使用远程桌面来完成……使用 PS 脚本将它们自动化会有所帮助，但用户没有管理员权限。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T14:10:05.000

该任务更像是 setuid 而不是 sudo ...谢天谢地，setuid**是**可能的：您可以简单地创建一个计划任务（*没有设置计划*），并将其设置为运行**提升**。然后，授予您的用户执行该任务的权限。不久前，我[在一篇博客文章](http://web.archive.org/web/20120521095408/http://huddledmasses.org/vista-setuid-how-to-elevate-without-prompting/)中概述了该过程以及一个 PowerShell 脚本，以帮助创建任务和运行它们的快捷方式。

问题（正如 JaredPar 建议的那样）是您必须确保您计划以提升权限或“以管理员身份”运行的应用程序受到保护，如果您将运行脚本，则尤其如此。确保除了管理员之外没有人可以编辑或替换该脚本，否则您将把众所周知的钥匙交给王国。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-27T14:05:22.123

如果您使用的是 V2，则可以使用[PowerShell 团队博客上的以下内容](http://blogs.msdn.com/powershell/archive/2009/04/23/v2-quick-tip-starting-a-new-elevated-process-from-a-powershell-script.aspx)

```
Start-Process "$psHome\powershell.exe" -Verb Runas -ArgumentList '-command "Get-Process"' 
```

这将以管理员身份运行“Get-Process”。

如果您没有 V2，您可以像这样创建一个 StartInfo 对象并将 Verb 设置为 Runas。

```
function Start-Proc  {   
     param ([string]$exe = $(Throw "An executable must be specified"),[string]$arguments)       

     # Build Startinfo and set options according to parameters  
     $startinfo = new-object System.Diagnostics.ProcessStartInfo   
     $startinfo.FileName = $exe  
     $startinfo.Arguments = $arguments  
     $startinfo.verb = "RunAs"  
     $process = [System.Diagnostics.Process]::Start($startinfo)  

} 
```

我[有一篇博文](http://get-powershell.com/2008/02/22/powershell-function-start-proc/)详细介绍了使用 System.Diagnostics.ProcessStartInfo 对象。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-08T15:24:31.520

Powershell 社区扩展为此包含一个 cmdlet，别名为“su”。 [http://www.codeplex.com/Pscx](http://www.codeplex.com/Pscx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T12:44:09.480

听起来您正在寻找 Windows 中的[sudo](http://en.wikipedia.org/wiki/Sudo)等效项。Sudo 不是 Windows 所固有的，因为它是大多数 Unix 风格的环境。但是有几个可用的工具非常相似。

*   [http://sourceforge.net/projects/sudowin](http://sourceforge.net/projects/sudowin)
*   [http://sudown.sourceforge.net/](http://sudown.sourceforge.net/)

不过，在使用这些类型的工具时要小心。未经强化的脚本 + sudo 存在安全风险。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-02-18T23:53:34.883

首先`choco install pscx`通过[http://chocolatey.org/](http://chocolatey.org/)（您可能需要重新启动 shell 环境）

然后启用 psxc

```
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser #allows scripts to run from the interwebs, such as pcsx 
```

然后使用`Invoke-Elevated`

```
Invoke-Elevated {Add-PathVariable $args[0] -Target Machine} -ArgumentList $MY_NEW_DIR 
```

# maven-2 - 创造新的原型

> ID：915488
> 
> 赞同：0
> 
> 时间：2009-05-27T12:35:30.230
> 
> 标签：maven-2

在我正在创建的原型 (archetype-resources/pom.xml) 的 pom 中，我正在引用`${project.build.directory}`，这在从原型创建/生成项目时导致错误。

```
org.apache.velocity.runtime.exception.ReferenceException: reference : template = archetype-resources/pom.xml [line 15,column 18] : ${project.build.directory} is not a valid reference. 
```

我是否遗漏了什么，或者在定义我自己的原型时我无法访问标准的 maven2 属性！？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T15:07:15.930

您确实可以访问标准 maven2 属性，但它指的是生成项目的 POM.xml 的属性，而不是您在创建原型时开始使用的项目。我创建了一个 Axis2 原型，项目名称也是axis2。*create-from-project*然后用${project.artifactid} 更改每个“axis2”字符串。我的依赖项之一是**axis2** -kernel.jar。当我想创建一个原型项目并将其命名为**my-service**时，依赖项更改为**my-service** -kernel.jar。我在创建原型之后和部署它之前通过在依赖项中手动更改 ${project.artifactid} 和axis2来解决它

# blackberry - 种子机制不适用于黑莓

> ID：915494
> 
> 赞同：-1
> 
> 时间：2009-05-27T12:36:55.843
> 
> 标签：blackberry, java-me, aes, random-seed

我使用种子机制在 java 中创建了 AES 密钥，并使用 BlackBerry 创建了相同的东西。在这两种情况下，我的 Seed 输入字符串都是相同的。但是我得到了不同的AES。但是创建的 AES 密钥应该是相同的。

是否有使用 BlackBerry 种子机制创建 AES 密钥的在线帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-05T03:56:14.957

你已经[问过这个问题了](https://stackoverflow.com/questions/915786/how-to-write-aes-cbc-pkcs5padding-encryption-and-decryption-with-initialization-v)。我在那里给出的答案仍然是最好的方法。我正在使用那里记录的内容在黑莓和使用 AES 加密的 Java 服务器程序之间传递数据。只要您遵循每一侧的 API 文档，就可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-14T06:18:03.883

java和黑莓中的嗨种子机制不一样。所以你永远不会在 java 和 blackberry 中得到相同的结果。所以最好自己创建一个密钥并发送给黑莓用户。他们将使用密钥。

谢谢 Sunil Kumar Sahoo

# c# - 如何选择最合适的异常类型来抛出？

> ID：915500
> 
> 赞同：22
> 
> 时间：2009-05-27T12:38:20.223
> 
> 标签：c#, exception

已经有很多关于例外的问题，但我找不到能回答我的问题的问题。如果我错过了另一个问题，请随时指出我的方向。

我的问题很简单：其他（C#）开发人员如何选择最合适的异常类型来抛出？之前我写了以下代码：

```
 if (Enum.IsDefined(enumType, value))
    {
        return (T)Enum.Parse(enumType, value);
    }
    else
    {
        throw new ArgumentException(string.Format("Parameter for value \"{0}\" is not defined in {1}", value, enumType));
    } 
```

从那以后，我意识到如果`InvalidEnumArgumentException`我当时知道它的存在，投掷一个可能会更合适。

是否有可用的权威资源来帮助开发人员选择异常类型，或者仅仅是经验问题？

## 编辑

我已经给了诺多林的积分，因为它在一个深思熟虑的答案中提供了一系列想法。这些积分可能真的属于你们中的任何一个人——感谢所有的建议。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-27T12:46:30.160

Krzysztof Cwalina 对此有一篇很好的文章，[请参阅“1.1.1 选择正确的异常类型抛出”一章](https://docs.microsoft.com/en-us/archive/blogs/kcwalina/choosing-the-right-type-of-exception-to-throw)

PS 考虑订阅他的博客。好阅读！

回答您的问题：**InvalidEnumArgumentException**
因为抛出最具体（最衍生）的异常是有意义的。

以及捕获 ArgumentException 的调用者，也捕获 InvalidEnumArgumentException ......

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-27T12:44:05.050

我会说这只是取决于经验。我仍然经常发现新的异常，而且我已经使用 .NET 的许多方面工作了一段时间！无论如何，您希望此消息来源告诉您什么？选择适当的异常类型似乎是高度特定于上下文的，所以我怀疑它可以提供的建议水平。列出更常见的将是它所能提供的最多的。异常类型的名称和 Intellisense 描述通常清楚地解释了它们的使用场景。

我的建议只是让自己熟悉所有基础知识（特别是`System`,`System.IO`以及您经常使用的任何其他名称空间中的那些），并在此过程中学习其他名称。我发现我通常只使用一小部分就可以逃脱。如果您在 BCL 中已经存在更具体的异常类型时不小心使用了更通用的异常类型，那么这不是什么大罪，以后可以很容易地更改。老实说，对于任何特别具体的错误，您通常需要创建自己的类继承自`Exception`无论如何。

希望有帮助。

**编辑：**如果您想要一个非常常见的简要指南，请参阅 MSDN 上的[Common Exception Classes](http://msdn.microsoft.com/en-us/library/aa664610.aspx)页面。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-27T12:40:46.523

[常见异常类型及其解释](http://www.developerfusion.com/article/1889/exception-handling-in-c/3/)

我认为这可能会帮助您找出最适合您使用的例外情况。如果需要，您还可以查看 MSDN 文档以获取有关 Exception 类及其所有类型的更多信息。

*   [MSDN 异常类（系统）](http://msdn.microsoft.com/en-us/library/system.exception.aspx)
*   [MSDN SystemException Class (System)](http://msdn.microsoft.com/en-us/library/system.systemexception.aspx) - 更详尽的异常类型列表

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-27T13:00:24.127

如果您查看[有关 System.Exception 的 MSDN 文章](http://msdn.microsoft.com/en-us/library/system.exception.aspx)，页面底部是继承 Exception 的 BCL 异常类型的完整列表。它不是一个关于什么应该用于什么的明确列表 - 但它确实为您提供了一个开始检查异常类型的好地方。浏览每一个都会告诉你它们应该用于什么：

*   [http://msdn.microsoft.com/en-us/library/system.exception.aspx](http://msdn.microsoft.com/en-us/library/system.exception.aspx)

还有一篇关于 .NET Exception Hierarchy 的相当全面的文章，位于：

*   [http://msdn.microsoft.com/en-us/library/z4c5tckx(VS.71).aspx](http://msdn.microsoft.com/en-us/library/z4c5tckx(VS.71).aspx)

事实上，MSDN 库中关于处理和抛出异常的整个部分都非常好：

*   [http://msdn.microsoft.com/en-us/library/5b2yeyab(VS.71).aspx](http://msdn.microsoft.com/en-us/library/5b2yeyab(VS.71).aspx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-27T12:45:04.050

我把大多数常见的例外写在我办公桌上的明信片上，当人们尝试以一种特殊的方式与我进行交互时使用它们。

这对于找出最适合的异常是非常好的做法......

我发现自己最常使用的是**OperationNotSupportedException**

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-27T12:45:09.040

我认为真正的问题是问自己“我要处理什么类型的异常？” 如果您不打算对 InvalidEnumArgumentException 或 ArgumentException 进行特殊处理，那么与普通的旧异常相比，它们没有任何优势。

我通常要么抛出异常，要么将异常包装在自定义异常中。

编辑补充：在某一时刻，我记得微软的指导是你的应用程序不应该抛出框架异常，而应该只抛出 ApplicationException 的扩展。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-27T12:42:17.877

我通常定义自己的异常结构，首先创建一些基本异常：

```
class MyProjectNameException:Exception
{
...constructors, etc
} 
```

然后派生类以获得更精确的异常。通过这种方式，您可以准确地知道什么时候会出现哪个异常，并且您知道异常是由您还是由框架引发的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-27T12:57:31.667

如果您发现一个非常合适的例外，您可以使用它。

如果有疑问，只需使用`ApplicationException`. 这是针对不属于标准库的代码的异常。

如果异常不打算以标准化的方式使用（例如捕获基类`IOException`以捕获任何与 I/O 相关的错误），那么您放入异常中的消息比异常类型更有用。

# javascript - jquery：以不同的顺序从xml获取元素

> ID：915508
> 
> 赞同：0
> 
> 时间：2009-05-27T12:40:16.837
> 
> 标签：javascript, jquery, dom

来自 ajax 请求的 xml 响应如下所示：

```
<element type='type1' />
<element type='type2' />
...
<element type='type1' /> 
```

我想根据 xml 插入 dom 元素，但我希望它们按以下顺序排列：首先是 type1 的所有元素，然后是 type2 的所有元素。

复合选择器可以做到这一点对我来说是有道理的（我还阅读了网络上的一些讨论）`$(xml).find('element[type=type1], element[type=type2]').each()`：. 不幸的是，这仍然以 xml 顺序获取元素。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T12:50:06.847

```
var arr=$(xml).find('element[type=type1]').get().concat(
           $(xml).find('element[type=type2]').get()
         ); 
```

这为您提供了一个按您想要的方式排序的数组。那么我认为你可以：

```
$(arr).each(); 
```

随心所欲

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T12:48:46.087

单独选择类型怎么样？与其将它们全部推送到一个选择器中，不如使用两条语句并分别遍历它们。

```
$(xml).find('element[type=type1]').each( ... );
$(xml).find('element[type=type2]').each( ... ); 
```

还是因为其他原因不可能？

# sql-server-2008 - SQL 2008 Express 是否支持更改跟踪

> ID：915512
> 
> 赞同：4
> 
> 时间：2009-05-27T12:40:35.367
> 
> 标签：sql-server-2008, sql-server-2008-express, change-tracking

由于 MSDN 上没有这方面的文档，我不得不在这里问。

Express 版本是否支持与其他版本相同的更改跟踪功能？

谢谢

雷比

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T12:42:36.113

好的，说得太快了，这是链接：

[http://msdn.microsoft.com/en-us/library/cc645993%28v=sql.100%29.aspx](http://msdn.microsoft.com/en-us/library/cc645993%28v=sql.100%29.aspx)

在**复制**部分下。

# asp.net - ASP.NET TimeOut 过期时间：Membership.ValidateUser(username, password)

> ID：915519
> 
> 赞同：2
> 
> 时间：2009-05-27T12:42:27.173
> 
> 标签：asp.net, asp.net-membership

在另一台服务器上运行的我的 asp.net Web 应用程序的相同副本时不时地抛出此错误：

*超时已过。在从池中获取连接之前超时时间已过。这可能是因为所有池连接都在使用中并且达到了最大池大小。*

错误发生在以下**第 67 行**

```
Line 65: 
Line 66:         //determine if the user's username/password are valid
Line 67:         if (Membership.ValidateUser(userName, password))
Line 68:         {
Line 69:             userInfo = MembersDB.GetMemberByUserName(Login1.UserName); 
```

有没有人发生过这种情况？

此外，可能需要注意的是，我在另一台有更多用户的服务器上运行了这个非常 Web 应用程序，但我没有这个*连接池*问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-11T01:55:33.380

我认为简单地提高最大连接池大小应该可以解决您的问题，如下所示：

`Data Source=Server;Initial Catalog=TestDB;User ID=TestUser;`**`Max Pool Size=300`**

# c# - 从数据集中将空值导出到 xml

> ID：915524
> 
> 赞同：0
> 
> 时间：2009-05-27T12:44:54.470
> 
> 标签：c#, .net, xml-serialization

如果您在数据集中的字段中有空值并将其导出到 xml，它会“删除”字段标签..无论如何以避免这种情况..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T12:48:48.520

空标签与 的含义不同`null`，尤其是对于字符串。如果标签存在但为空，您将如何发挥作用？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T13:31:20.663

```
//Try changing values of cells.

foreach (DataRow row in dtPr.Rows)
{
    for (int i = 0; i < dtPr.Columns.Count; i++)
    {

    dtPr.Columns[i].ReadOnly = false;

        if (string.IsNullOrEmpty(row[i].ToString()))
        {
            if (dtPr.Columns[i].DataType == typeof(string))
                row[i] = string.Empty;
            else if (dtPr.Columns[i].DataType == typeof(int))
                row[i] = 0;
            else if (dtPr.Columns[i].DataType == typeof(DateTime))
                row[i] = new DateTime(1753, 1, 1);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T12:58:02.103

将 NULL 视为一种状态，将其他所有内容视为一个值。因此，如果您想要一个空白值，只需发送一个空字符串（单个空格）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-27T13:00:38.947

你必须用一个属性来绘制你的方法，告诉它留在那里。不在我的 winblows 机器附近，所以不能给你实际的代码。但看起来像这样，

```
[XMLElement(IsNullable = true)]
myProperty {get;set;} 
```

# ruby-on-rails - 为什么这个对 ActiveRecord 关联的引用失败了？

> ID：915527
> 
> 赞同：3
> 
> 时间：2009-05-27T12:45:27.060
> 
> 标签：ruby-on-rails, activerecord, associations

在 Rails 2.2.2 在我的模型中，我有这个：

```
class Question < ActiveRecord::Base
  set_table_name "t346128_question"
  set_primary_key "question_id"
  has_many :sections, :order => 'position, section_id', :dependent => :destroy
  ...
end 
```

在我的控制器中，这是：

```
def answer()
   @question = Question.find(params[:id])
   puts "question=#{@question.name}..."
   puts "sections=#{@question.sections.size}..." # <<== THIS FAILS
   render :layout => false
end 
```

@question.sections 的行因“未初始化的常量 Question::Section”而失败

这些代码行实际上是从另一个可以正常工作的应用程序中复制的。在 database.yml 中，我指向应用程序使用的同一个数据库。

有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-10-20T09:34:48.727

您没有可用的 Section 模型。您还应该在`app/models/section.rb`.

# sql - SQL 连接生命周期

> ID：915531
> 
> 赞同：2
> 
> 时间：2009-05-27T12:47:34.730
> 
> 标签：sql, oracle, jdbc, memory-management, master-data-management

我正在开发一个 API 来查询数据库服务器（在我的例子中是 Oracle）以检索大量数据。（这实际上是 JDBC 之上的一层。）

我创建的 API 试图尽可能限制将每个查询信息加载到内存中。我的意思是，我更喜欢迭代结果集并逐一处理返回的行，而不是将每一行加载到内存中并稍后处理它们。

但我想知道这是否是最佳做法，因为它有一些问题：

*   结果集在整个处理过程中保持不变，如果处理时间与检索数据一样长，则意味着我的结果集将打开两倍
*   在我的处理循环中执行另一个查询意味着在我已经使用一个结果集时打开另一个结果集，同时开始打开太多结果集可能不是一个好主意。

另一方面，它有一些优点：

*   对于结果集，我的内存中的数据永远不会超过一行，因为我的查询往往会返回大约 100k 行，这可能是值得的。
*   由于我的框架很大程度上基于函数式编程概念，因此我从不依赖多个行同时在内存中。
*   在数据库引擎仍在返回其他行的同时开始对返回的第一行进行处理可以极大地提高性能。

作为对甘道夫的回应，我添加了更多信息：

*   我总是需要处理整个结果集
*   我没有对行进行任何聚合

我正在与主数据管理应用程序集成并检索数据，以便验证它们或使用许多不同的格式（到 ERP、到 Web 平台等）导出它们

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T12:29:04.457

没有普遍的答案。我亲自实施了这两种解决方案数十次。

这取决于对您更重要的因素：内存或网络流量。

如果您的网络连接速度很快`LAN`（

如果您在 上工作`Internet`，那么批量提取将对您有所帮助。

您可以设置预取计数或数据库层属性并找到一个中庸之道。

经验法则是：在不注意的*情况下获取您可以保留的所有内容*

如果您需要更详细的分析，则涉及六个因素：

*   **行生成响应时间/速率**（多快`Oracle`生成第一行/最后一行）
*   **行交付响应时间/速率**（多久可以得到第一行/最后一行）
*   **行处理响应时间/速率** （多久可以显示第一行/最后一行）

其中之一将成为瓶颈。

作为一项规则，`rate`并且`responce time`是对手。

通过预取，您可以控制**行传递响应时间**和**行传递速率**：较高的预取计数会提高速率但会减少响应时间，较低的预取计数会适得其反。

选择对您更重要的一项。

您还可以执行以下操作：为获取和处理创建单独的线程。

只选择足够多的行以使用户在低预取模式（具有高响应时间）下感到愉快，然后切换到高预取模式。

它将在后台获取行，您也可以在后台处理它们，同时用户浏览第一行。

# sql - Sql Server 查询语法

> ID：915533
> 
> 赞同：0
> 
> 时间：2009-05-27T12:48:31.170
> 
> 标签：sql, mysql, sql-server-2005

我需要执行这样的查询：

```
SELECT *, 
    (SELECT Table1.Column 
     FROM Table1 
     INNER JOIN Table2 ON Table1.Table2Id = Table2.Id 
    ) as tmp 
FROM Table2 WHERE tmp = 1 
```

我知道我可以采取一种解决方法，但我想知道这种语法在 Mysql 中是否可行（我认为）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T12:52:14.050

您发布的查询在 sql server 上不起作用，因为您的 select 子句中的子查询可能会返回多行。我不知道 MySQL 将如何处理它，但从我正在阅读的内容来看，如果子查询返回任何重复项，MySQL 也会产生错误。我知道 SQL Server 甚至不会编译它。

不同之处在于 MySQL 至少会尝试运行查询，如果您非常幸运（Table2Id 在 Table1 中是唯一的），它将成功。更可能的是会返回一个错误。SQL Server 根本不会尝试运行它。

这是一个应该在任一系统上运行的查询，如果 Table2Id 在 Table1 中不是唯一的，则不会导致错误。*在这种情况下，它将*返回“重复”行，唯一的区别是 Table1.Column 值的来源：

```
SELECT  Table2.*, Table1.Column AS tmp
FROM Table1 
INNER JOIN Table2 ON Table1.Table2Id = Table2.Id
WHERE Table1.Column = 1 
```

也许如果您分享了您要完成的工作，我们可以帮助您编写一个查询来完成它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T12:51:50.260

```
SELECT  *
FROM    (
        SELECT  t.*,
                (
                SELECT  Table1.Column
                FROM    Table1
                INNER JOIN
                        Table2
                ON      Table1.Table2Id = Table2.Id
                ) as tmp
        FROM    Table2 t
        ) q
WHERE   tmp = 1 
```

这是有效的语法，但如果子查询返回多于行，它将失败（in`MySQL`和 in ）`SQL Server``1`

你到底想做什么？

请提供一些示例数据和所需的结果集。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T13:18:15.073

我同意 Joel 的解决方案，但我想讨论一下为什么您的查询不适合使用（即使语法本质上是有效的）。这是一个相关的子查询。这些问题的第一个问题是，如果子查询可能为记录返回多个值，它们将不起作用。第二个也是更关键的问题（在我看来）是它们必须逐行而不是在数据集上工作。这意味着它们几乎总是会影响性能。因此，几乎不应该在生产系统中使用相关子查询。在这个简单的例子中，Joel 展示的连接是正确的解决方案。

如果子查询更复杂，您可能希望将其转换为派生表（这也解决了与记录问题关联的多个值）。虽然派生表看起来很像未初始化的相关子查询，但它的执行方式不同，因为它作用于数据集而不是逐行，因此通常会明显更快。您实际上是在使查询成为联接中的表。

下面是一个将查询重写为派生表的示例。（当然在生产代码中你也不会使用 select * 尤其是在连接中，拼出你需要的字段）

```
SELECT *     
FROM Table2 t2
JOIN
(SELECT Table1.[Column], Table1.Table2Id  as tmp      
FROM Table1      
INNER JOIN Table2 ON Table1.Table2Id = Table2.Id     ) as t
ON t.Table2Id = Table2.Id
WHERE tmp = 1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T12:52:37.170

这种语法基本上是有效的（尽管您需要将 to 移到`where tmp=...`外部“select * from (....)”上），尽管它是模棱两可的，因为您有两个名为“Table2”的集合 - 您可能应该在至少您对该表的一种用法可以消除歧义。

除非您打算从 table1 返回与 table2 中的列相对应的列......在这种情况下，您可能只想简单地加入表？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T22:30:41.107

你已经得到了各种各样的答案，其中一些比其他的更有用。但是直接回答你的问题：

不，SQL Server 不允许您在谓词（WHERE 子句）中引用列别名（在选择列表中定义）。我认为这足以回答您提出的问题。

**额外细节：**

（此讨论超出了您提出的原始问题。）

正如您所指出的，有几种解决方法可用。

您发布的查询的最大问题（正如其他人已经指出的那样）是我们不能保证 SELECT 列表中的子查询只返回一行。如果它确实返回多行，SQL Server 将抛出“太多行”异常：

```

    子查询返回超过 1 个值。
     子查询时不允许这样做
     跟随 =, !=, , >= 或当
     子查询用作表达式。

```

对于以下讨论，我将假设该问题已得到充分解决。

有时，使别名在谓词中可用的最简单方法是使用内联视图。

```
SELECT v.*
  FROM ( SELECT * 
              , (SELECT Table1.Column 
                   FROM Table1 
                   JOIN Table2 ON Table1.Table2Id = Table2.Id
                  WHERE Table1.Column = 1
                ) as tmp 
           FROM Table2
       ) v   
 WHERE v.tmp = 1 
```

请注意，SQL Server 不会将外部查询 ( `WHERE v.tmp = 1`) 的谓词推送到内联视图中的子查询中。因此，您需要通过在子查询中包含谓词来推动这一点 `WHERE Table1.Column = 1` ，特别是如果您依赖它使子查询仅返回一个值。

这只是解决问题的一种方法，还有其他方法。我怀疑此 SQL Server 查询的查询计划不会是最佳的，为了性能，您可能希望使用 JOIN 或 EXISTS 谓词。

注意：我不是使用 MySQL 的专家。我对 MySQL 对子查询的支持不是很熟悉。我确实知道（从痛苦的经历中）MySQL 3.23 不支持子查询，这使得将应用程序从 Oracle 8 迁移到 MySQL 3.23 尤其痛苦。

哦，顺便说一句......特别是对任何人都不感兴趣，Teradata DBMS 引擎*确实*有一个扩展，允许用 NAMED 关键字代替 AS 关键字，并且可以在 QUERY 的其他地方引用一个 NAMED 表达式，包括*WHERE*子句、GROUP BY 子句和 ORDER BY 子句。 *舒威特*

# version-control - 如何将源代码从 Vault 合并到 TFS 2008

> ID：915541
> 
> 赞同：2
> 
> 时间：2009-05-27T12:51:03.820
> 
> 标签：version-control, tfs, merge, sourcegear-vault

我正在考虑将我们的源代码控制提供程序和错误跟踪软件合并到 Team Foundation Server 2008。我们目前有 SourceGear Vault 作为我们的源代码控制提供程序和 OnTime 用于我们的错误跟踪软件。目前两者都满足我们的需求，但是随着我们的成长，TFS 似乎更有可能成为我们公司的候选者。如果微软开发了一个合并工具，这样我们就可以将我们所有的源代码，包括所有的历史记录都放到这个新系统中，那就太好了。

到目前为止，我可以通过 csv 导入将我们所有的错误跟踪项导入系统，我还可以将最新版本的源代码导入系统。

是否有一种简单的方法或工具包可用于将我们所有的源代码与从 SourceGear Vault 到 TFS 2008 的历史合并？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T14:52:00.690

查看[TFS 迁移和同步工具包](http://www.codeplex.com/MigrationSyncToolkit)。这是微软为做这类事情的人开发的一个开源项目。也就是说，我通常建议保留旧系统作为历史记录而不是导入，因为人们通常会以这种方式获得更好的体验，而不是经历导入的痛苦。

# apache-flex - 使文本区域在其他文本输入的顶部可见

> ID：915543
> 
> 赞同：1
> 
> 时间：2009-05-27T12:51:35.003
> 
> 标签：apache-flex, layout, textarea

我创建了自己的验证控件。

像这样的 control.mxml：

```
<mx:states>
    <mx:State name="ExceptionState">
        <mx:AddChild relativeTo="{hbox1}">
            <mx:TextArea id="txtError"  
                styleName="errorMessage" 
                width="140" minHeight="26" 
                wordWrap="true" editable="false" 
                /> 
        </mx:AddChild>
        <mx:SetProperty name="height" value="56" /> 
        <mx:SetProperty target="{txtInput}" name="y" /> 
        <mx:SetProperty name="width" value="100%" />  
    </mx:State>
</mx:states>
<mx:HBox width="100%" x="0" y="0" id="hbox1" styleName="nopadding">
    <mx:TextInput id="txtInput" 
        text="{text}" 
        displayAsPassword="{displayAsPassword}" 
        maxChars="{maxLength}" 
        cornerRadius="0" 
        height="22" 
        styleName="{inputStyleName}" 
        width="{_inputWidth}" 
        /> 
</mx:HBox> 
```

当我验证 txtinput 并且它无效时，textarea 将出现其中包含一些信息。

现在我在画布中有几个文本输入字段

> `<custom:control id="eerstes" errormessage("message1");/> <custom:control id="tweeds"errormessage("message2");/>`

等等，但是当 eerstes 无效时，会出现 textarea 并且我的带有 id tweeds 的自定义控件会发生一些变化。

是否可以让 textarea 浮动，但这仍然与 hbox1 相关？

谢谢，

JSMB

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T13:06:03.507

如果我是你，我会尝试使用 PopUpManager.addPopUp 将 TextField 放入框中。完成此操作后，您可以手动重新定位 TextField 而不会影响框的子项的对齐方式。您甚至可以使用 BindingUtils 让它工作，这样您就不必每次都重新定位它。

另一方面，您可以使用 Alert.show，它只会在整个 SWF 上弹出一个弹出窗口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T13:07:35.220

您的组件 custom:control 的基类是什么？它会扩展 Canvas 吗？

# javascript - 在 d'n'd 之后动态更改 css 文件中的位置属性

> ID：915545
> 
> 赞同：2
> 
> 时间：2009-05-27T12:52:03.770
> 
> 标签：javascript, css, dom

希望你能再次帮助我 :) 我想建立一个基于 web 的小 gui 设计器。用户可以切换到编辑器模式，并可以通过拖放将组件放置在他想要的任何位置。当（s）他切换回用户模式时，我希望通过 javascript 更新外部 css 文件中的位置详细信息。我研究了一些可以做我想做的事情的例子，但我似乎无法弄清楚如何让它工作。

提前谢谢，dg

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T13:01:20.147

为了使用 JS 编辑外部样式表，您需要使用此处列出的方法：[http](http://www.quirksmode.org/dom/w3c_css.html) ://www.quirksmode.org/dom/w3c_css.html （请参阅访问样式表和更改样式表）。正如您从 PPK 表中看到的那样，存在一些明显的 CSS 不兼容问题——这是极端情况，我不知道您将如何保存生成的 CSS 文件。

我会考虑将值发布（可能使用 ajax）返回到服务器，该服务器生成新的 CSS 文件，然后由用户模式页面调用。

在编辑模式下，我会将所有样式内联（style="..."），然后在提交页面时，枚举每个元素的样式属性以提取值并使用它们来构建 POST 请求。然后在服务器上创建新文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T13:22:36.407

您想使用 jquery ...它使用 css 来选择元素组，并允许您操作所选元素的 css 样式

假设你有一个类 awesomeDiv 的 div 元素：

```
<div class="awesomeDiv">some content</div> 
```

您可以使用带有以下行的 jquery 选择它：

```
$(".awesomeDiv") 
```

你可以像这样改变css：

```
$(".awesomeDiv").css({'background-color': '#000000', 'width': '250px'}); 
```

# c# - 如何使用 C# 在 ActiveDirectory 中获取组成员？

> ID：915547
> 
> 赞同：3
> 
> 时间：2009-05-27T12:52:31.927
> 
> 标签：c#, .net, active-directory

正如标题所提到的，我需要一种方法来获取一个组在 ActiveDirectory 中所属的所有组。

要获取用户所属的所有组，我使用

```
public static DirectoryEntry[] GetGroupsUserIsMemberOf(DirectoryEntry directoryEntry)
{
    ArrayList        groupsUserIsMemberOf = new ArrayList();
    object           groups               = null;
    DirectoryEntry[] userGroupEntries     = null;

    if (directoryEntry != null && directoryEntry.SchemaClassName == "user") {
        groups = directoryEntry.Invoke("Groups", null);

        foreach (object group in (IEnumerable)groups) {
            groupsUserIsMemberOf.Add(new DirectoryEntry(group));
        }

        userGroupEntries = (DirectoryEntry[])groupsUserIsMemberOf.ToArray(typeof(DirectoryEntry));
    }

    return userGroupEntries;
} 
```

但是尝试的时候

```
public static DirectoryEntry[] GetGroupsGroupIsMemberOf(DirectoryEntry directoyEntry)
{
    ArrayList        groupsGroupIsMemberOf = new ArrayList();
    object           groups               = null;
    DirectoryEntry[] groupEntry       = null;

    if (directoyEntry != null && directoyEntry.SchemaClassName == "group") {
        groups = directoyEntry.Invoke("Groups", null); // throws exception (see below)

        foreach (object group in (IEnumerable)groups) {
            groupsGroupIsMemberOf.Add(new DirectoryEntry(group));
        }

        groupEntry = (DirectoryEntry[])groupsGroupIsMemberOf.ToArray(typeof(DirectoryEntry));
    }

    return groupEntry;
} 
```

获取所有组一个组是该行的成员

```
 groups = directoyEntry.Invoke("Groups", null); // throws exception (see below) 
```

抛出异常：

```
"Unknown name. (exception HRESULT: 0x80020006 (DISP_E_UNKNOWNNAME))" 
```

有人知道获取组所属所有组的有效方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T13:04:02.513

认为我自己得到了它：

要获取所有组，组是您的成员，您可以使用

```
directoryEntry.Properties["memberOf"][0] 
```

你会得到一个字符串对象，其中包含你的组所属的所有 ADObjects。

将其拆分为单个 AD-Object 字符串，检查组是否得到它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T22:26:00.257

此代码将为您提供当前登录用户的组列表，它比查询域控制器的信息要快，因为它来自缓存的安全标识符：

```
WindowsIdentity currentIdent = WindowsIdentity.GetCurrent();
IdentityReferenceCollection currentGroups = currentIdent.Groups;

List<String> groups = new List<string>();
foreach (IdentityReference indentity in currentGroups)
{
   groups.Add(indentity.Translate(typeof(NTAccount)).ToString());
} 
```

# c# - 如何在 PPC Emulator 中使用 sqlCE？

> ID：915556
> 
> 赞同：0
> 
> 时间：2009-05-27T12:55:36.070
> 
> 标签：c#, windows-mobile

如何在 PPC (windows mobile) Emulator 中使用 sqlCE (sdf Files)？

（Visual Studio 2008 模拟器）

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T13:00:47.340

如果你去开始->程序->Visual Studio 20XX->Visual Studio Remote Tools，有一个叫做Remote Viewer的程序。当您启动它时，您可以看到虚拟设备的“文件系统”。只需将 SDF 文件传输到文件系统上的某个位置，然后将应用程序中的连接字符串设置为该位置即可。

编辑：为了更清楚一点，我会给你一个快速的例子。打开 Remote Viewer（确保您使用的设备类型与项目中的设备类型相同）并找到 ApplicationData 文件夹。然后，单击文件-> 导出文件并导航到 C:/Program Files/Microsoft Sql Server Compact Edition/V3.5/Samples 并选择 Northwind.sdf。这会将 Northwind 数据库传输到您的虚拟设备。

然后，转到您的项目并创建一个带有按钮和 DataGrid 的简单表单。然后，单击添加引用，并添加对 System.Data.SqlServerCe 的引用。然后，将此代码添加到您的 button1 点击事件中：

```
 private void button1_Click(object sender, EventArgs e)
    {
        string connectionString = String.Format(@"Data Source={0}\Northwind.sdf",
            Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData));
        SqlCeConnection connection = new SqlCeConnection(connectionString);
        DataTable table = new DataTable();
        SqlCeDataAdapter adapter = new SqlCeDataAdapter("SELECT * FROM PRODUCTS",connection);
        adapter.Fill(table);
        this.dataGrid1.DataSource = table;
    } 
```

运行它并单击按钮。祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-21T02:34:27.890

BFree，非常感谢您使用远程文件查看器的回答。我是 Windows 移动编程的新手，实际上我花了一个小时或更长时间才使我的连接字符串正确，因为我不知道模拟器会查看设备的结构。为什么它现在会这样做是完全有道理的，但同样，我仍在学习。我一直在寻找使用它自己的结构的参考，你不能参考 C:\ 或类似的东西，但没有人会告诉你该怎么做！您提供了解决方案以及描述，这让我松了一口气，非常感谢您，在我阅读您的帖子后大约 2 分钟内它就起作用了！

谢谢！保罗

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T14:40:41.693

作为单独的存储选项，打开模拟器，然后单击文件 -> 配置。您将看到一个标有“共享文件夹”的文本框。将其设置为台式 PC 上的任何文件夹。然后，模拟器会将该文件夹“挂载”到您的 PC 上，作为模拟器中名为“存储卡”的文件夹。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-05T02:30:05.457

Do you want something running on the device that enables you to interact with the database directly?

Or do you want to use desktop tools to interact with a database also visible by the emulator?

In the first case you could install SQL Server Compact Query Analyzer ([http://msdn.microsoft.com/en-us/library/ms172926.aspx](http://msdn.microsoft.com/en-us/library/ms172926.aspx)). This tool enables you to query and alter the structure of *.SDF files directly on the PDA.

In the second case Visual Studio 2008 or SQL Server Management Studio 2008 should both be able to directly connect to your emulator (if you cradle it via ActiveSync first).

# .net - 分层架构中的 ASP.NET 和实体框架 - 仅将实体框架用于 ORM

> ID：915558
> 
> 赞同：30
> 
> 时间：2009-05-27T12:56:18.753
> 
> 标签：.net, asp.net, entity-framework, orm, data-access-layer

我有一个使用分层架构的 ASP.NET 应用程序，例如表示层、业务逻辑层、数据访问层。

我不想让业务层知道数据访问层是如何实现的，我也不希望使用 EntityDataSource 或类似的东西将实体直接绑定到数据控件。（所以是存储库模式场景）

我只是希望使用实体框架作为 ORM 工具来生成类。我知道该怎么做。我不清楚的是

1.  是否建议通过应用程序向上传播这些类，以便业务逻辑层处理由实体框架直接创建的部分类？（例如，如果我在 sql 中有一个客户表，实体 fw 将创建一个客户类，该类可能直接在我的应用程序的所有层中使用）
2.  如果我的 BLL 正在调用多个不同的实体类但想将其视为一个事务，如何管理事务支持

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-27T17:50:57.333

1.  如果你是实际的：是的！它将避免您进行双重映射工作以及双重映射产生的潜在错误。（通过双重映射，我的意思是 DB -> ORM 和 ORM -> 业务逻辑）。
2.  使用[TransactionScope](http://msdn.microsoft.com/es-es/library/system.transactions.transactionscope(VS.80).aspx)。这是进行事务而不用担心嵌套事务的最佳方式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-05T11:49:50.917

我怀疑这可能是您问题的答案：

[http://code.msdn.microsoft.com/EFPocoAdapter/Release/ProjectReleases.aspx?ReleaseId=1580](http://code.msdn.microsoft.com/EFPocoAdapter/Release/ProjectReleases.aspx?ReleaseId=1580)

该工具生成的类没有您可以跨层传递的实体框架依赖项。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-04-08T17:24:15.817

另一种方法是使用映射器类，将 EF 纯粹用作数据访问并使用仅在 DAL 内生成的类 EF，然后通过映射器将这些 DAL 对象映射到 BLL 的对象。它对我们来说很好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-16T13:45:52.560

现在使用新的 EF4，您还可以使用 POCO 类，从而消除在层之间映射实体的额外负载。在我们的应用程序中，我们使用了 EF4 并在应用程序中使用了业务实体，而不是需要视图模型的视图。它显着提升了性能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-16T06:26:50.663

不是使用实体框架，但我试图创建一个示例，其中两个插入存储过程在数据访问层中分别执行（使用数据访问应用程序块 3.1），包装在 Service/BLL 的 TransactionScope 上下文中，但它不起作用。一个插入通过，另一个失败，数据被提交。

你自己做这件事有没有成功？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-08T08:55:56.670

即使您使用生成的 POCO 类，就像其他操作所建议的那样，您仍然必须维护对实体框架的某种依赖性：您发送到 DbContext / ObjectContext 的查询。因此，您应该考虑将查询封装在存储库中。

# asp.net - 寻找 Microsoft 索引服务器 ASP.NET 示例

> ID：915565
> 
> 赞同：0
> 
> 时间：2009-05-27T12:58:36.143
> 
> 标签：asp.net, windows, sharepoint

我不是程序员，但我可以熟练地编写 frankenstein 代码片段，如果在一些好人的帮助下，我可以遇到一些充当 ms 索引服务器 GUI 的示例 ASP 代码，我当然可以制作它工作并且看起来不错。

如果有人可以提供任何帮助，我会做一个后空翻。但我不会把它放在 youtube 上。那里有足够多的面部植物视频。

摘要：有谁知道我在哪里可以找到索引服务器的asp 页面？越完整越好。片段非常受欢迎。

顺便说一句：io 将此标记为共享点，因为这非常相似。一些苔藓管理员肯定会帮我一把！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T13:13:25.630

CodeProject 的一些示例怎么样？这会满足你的需要吗？很抱歉，在不了解更多细节和您正在尝试做什么的情况下，我无法提供任何更具体的帮助。

> [用于 ASP 的 Microsoft 索引服务器类](http://www.codeproject.com/KB/asp/clsTextSearch.aspx)（经典 ASP）
> 
> [您的免费搜索引擎 – Microsoft 索引服务器](http://www.codeproject.com/KB/aspnet/IndexingServer.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-09T17:35:46.147

要从 asp.net 与索引服务器目录通信，您可以使用 ole db 连接对象。

```
OleDbConnection conn = new OleDbConnection("Provider=MSIDXS;Integrated Security .=;Data Source=" + catalogName);
            cmdQuery = new OleDbCommand(query, conn); 
```

其中 catalogName 是您正在查询的计算机上的目录名称。并且 query 是一个包含您正在使用的索引查询的字符串。

```
 //Get reader 
 rQuery = cmdQuery.ExecuteReader(CommandBehavior.CloseConnection);

 //Create dataset and load values from reader into it
 dataQuery = new DataSet("IndexResults");
 dataQuery.Load(rQuery, LoadOption.OverwriteChanges, new string[] { "" });

 //Return the first table which will be the results from the query
 results = dataQuery.Tables[0].Copy(); 
```

不要忘记在 finally 语句中处理连接和阅读器:)

索引查询本身与 SQL 非常相似——您还可以在查询中设置属性以用作别名，以便于阅读。

# nhibernate - NHibernate 合并

> ID：915567
> 
> 赞同：0
> 
> 时间：2009-05-27T12:59:03.910
> 
> 标签：nhibernate

是否可以将此 sql 语句转换为`CreateCriteria`NHibernate 处理的第二个`ORDER BY COALESCE`？

```
SELECT obs1.OBSLOPNR, obs1.LOKALLOPNR, obs2.OBSLOPNR, obs2.LOKALLOPNR
FROM
   (SELECT * FROM OBS WHERE OBS.LOKALLOPNR = 9) AS obs1 
FULL OUTER JOIN
   (SELECT * FROM OBS WHERE OBS.LOKALLOPNR = 8) AS obs2 
ON obs1.ARTLOPNR = obs2.ARTLOPNR
ORDER BY COALESCE(obs1.OBSLOPNR, obs2.OBSLOPNR) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-10-27T19:00:14.543

I do not know about CreateCriteria, but Hibernate/HQL supports COALESCE, IFNULL, or ISNULL Depending on your underlying database only in the Where Clause.

You may be able to define a function in the dialect and it should also work in the select clause. **I have not Tested This**

See: [http://www.hibernate.org/hib_docs/v3/reference/en/html/queryhql.html](http://www.hibernate.org/hib_docs/v3/reference/en/html/queryhql.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-02-11T04:39:20.310

没有内置支持。但是，您可以创建自己的 Order 类。 [这是一个很好的例子](https://stackoverflow.com/questions/729687/how-do-i-select-a-random-row-using-nhibernates-icriteria-api)。

您可以创建一个接受任何 sql 字符串的类，也可以尝试创建一个 CoalesceOrder 类。

# c# - Microsoft 是否正在恢复托管 DirectX？

> ID：915575
> 
> 赞同：5
> 
> 时间：2009-05-27T13:00:26.500
> 
> 标签：c#, .net, windows, windows-7, directx

今天看到微软公布0.85版本：

[“用于 Microsoft® .NE​​T Framework 的 Windows® API 代码包”](http://code.msdn.microsoft.com/WindowsAPICodePack)

这个包是针对 Windows7 操作系统的，虽然大多数功能应该在 Vista 下工作。此包的功能之一是支持 DirectX 11。

知道几年前微软停止了 Managed DirectX 的开发，同时开发了 XNA Game Studio，很难看出这样做的目的。简化部署？也许 W7 桌面应用程序在很大程度上依赖于 DirectX？或者？

有人对这个复活的托管 DX 有什么好的评论吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T23:14:42.110

目前，微软实际上并没有任何带回 MDX 的计划。但是，他们有 XNA，您和其他一些人已经提到过。MDX 只是 DirectX 功能的一个薄包装。也就是说，你有一些设备函数，你有一些 IO 函数，这些被封装到托管类中，仅此而已。XNA 远不止于此，它拥有自己的内容管道，对着色器、3D 模型、纹理、设备管理等提供更高级别的支持。它也是跨平台的，因为它也可以在 PC、Xbox360 上运行作为Zune。因此，简而言之，没有复活 MDX 的计划，但有替代方案，例如提到的 XNA。还有另一个非 Microsoft 项目 SlimDX。它是 DirectX 的托管包装器，与 MDX 非常相似，但乍一看似乎更令人愉悦。我自己用的不多，但是看了别人的说法，感觉还不错。希望这能回答你的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-11T19:26:04.230

我想提一下，SlimDX 的下一个版本将完全支持 DirectX11，以及其他 Win7 API。它比代码包所提供的更广泛。 [http://ventspace.wordpress.com/2009/06/09/c-and-directx-11-yes-you-can/](http://ventspace.wordpress.com/2009/06/09/c-and-directx-11-yes-you-can/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T13:16:57.807

按照我的阅读方式，它们只是提供了瘦包装器，允许从 .NET 轻松访问 D3D API。

托管 DirectX 是一项更大的工作，基本上是一个单独设计的 API。我怀疑这就是他们打算这样做的方式。

# wpf - WPF 单元测试框架

> ID：915578
> 
> 赞同：5
> 
> 时间：2009-05-27T13:00:44.033
> 
> 标签：wpf, unit-testing, frameworks

是否有支持 WPF 应用程序单元测试的框架。建立起来应该不难，因为我不希望编写测试花费的时间是实现一个小功能的十倍。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-02-08T10:31:50.223

你可以试试[IcuTest](http://www.nxs-7.com/icu/)。它大大简化了 WPF 单元测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T13:06:50.353

1) Visual Studio 中的测试项目可用于对 WPF 应用程序进行单元测试，就像它们可用于测试 windows 窗体、asp.net 和 asp.net mvc 应用程序、服务等一样。
2) 测试需要时间。有时，测试一段代码所花费的时间是编写它所花费的十倍。没有 TDD 仙女。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T13:08:49.540

您可以尝试使用 NUnit，就像使用任何其他组件一样。

您可以选择尝试 MVC。

请参阅[MVCtoUnitTestinWPF的代码项目](http://www.codeproject.com/KB/WPF/MVCtoUnitTestinWPF.aspx)

希望它服务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T17:33:26.873

开源验证实用程序 ApprovalTests（www.approvaltests.com 或 nuget）将轻松测试 Wpf 视图。

您可以在这里看到它的实际效果：[http ://www.youtube.com/watch?v=Xc_ty03lZ9U](http://www.youtube.com/watch?v=Xc_ty03lZ9U)

不过，我建议您首先观看 winforms 视频，因为它涉及到更多关于如何测试一般视图的理论：[http ://www.youtube.com/watch?v=hKeKBjoSfJ8](http://www.youtube.com/watch?v=hKeKBjoSfJ8)

代码本身看起来像

```
WpfApprovals.Verify(yourWpfView); 
```

它会截图并与黄金大师进行比较。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-27T13:07:03.053

我不太确定 WPF 单元测试，但对于 Silverlight，你有[SilverUnit](http://www.codeplex.com/CThru/Wiki/View.aspx?title=SilverUnit%20examples&referringTitle=Home)和[Microsoft Silverlight Unit Test](http://code.msdn.microsoft.com/silverlightut)。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2010-09-13T08:33:35.780

我听说[白色](http://white.codeplex.com/)很好 - 虽然我自己还没有测试过..

# c# - 向电子表格中的数据添加小计

> ID：915583
> 
> 赞同：2
> 
> 时间：2009-05-27T13:01:55.670
> 
> 标签：c#, asp.net, ms-office, openxml

我正在使用 OpenXML Sdk v2 ctp 做一些服务器端的 excel 输出。这里有没有人有使用这个的经验 - 特别是mpre：

有没有办法使用 SDK 向电子表格中的数据添加小计？还是我需要手动迭代添加 OutlineLevel 属性的数据？

```
rows.Add(new Row(cells.ToArray()) { 
    RowIndex = (UInt32Value)Convert.ToUInt32(idx), 
    Spans = new ListValue<StringValue>() { InnerText = "1:2" }, 
    OutlineLevel = (ByteValue)groupLevelCount 
}); 
```

如果我必须手动进行，这将是一个真正的 PITA，因为我需要进行多级分组和排序

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T14:10:12.020

您是否尝试过使用 SDK 中包含的文档 DocumentReflector？DocumentReflector 工具可以加载 OpenXML 文档并对代码进行逆向工程，以使用 SDK 生成该文档。换句话说，它从 xlsx 文件生成 C# 代码。

DocumentReflector 工具位于 Open XML Format SDK 2.0 安装文件夹下的 Tools 文件夹中。

也许它可以帮助解决您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-09-09T15:16:29.273

最简洁的答案是不。OpenXML SDK 使您可以完全访问 XLSX 文件。您可以添加、删除和/或更改工作簿中的元素。但这就是全部 - 对元素的低级别访问。它没有任何类型的处理功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-12-08T14:06:19.873

如果您有一个覆盖工作簿中单元格区域的宏或公式，您可以将其设置为在打开电子表格时执行：

请参阅[OpenXmlSdk：制作 Excel 重新计算公式。](https://stackoverflow.com/questions/2668643/openxml-sdk-make-excel-recalculate-formula)

```
spreadSheet.WorkbookPart.Workbook.CalculationProperties.ForceFullCalculation = true;
spreadSheet.WorkbookPart.Workbook.CalculationProperties.FullCalculationOnLoad = true; 
```

# wpf - 那里有好的 WPF 控件库吗？

> ID：915586
> 
> 赞同：8
> 
> 时间：2009-05-27T13:02:37.023
> 
> 标签：wpf, controls

你知道任何好的 WPF 控件库（甚至是商业的）吗？你用它们有什么经验？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T13:27:08.427

[Telerik](http://www.telerik.com/)拥有 WPF 控件的商业系列，以及 WinForms 和 Silverlight。它们的质量非常高，而且在 $$ 方面处于高端，但如果您要使用它们，它们的黄金重量是值得的。

我用过他们的网络产品，而且做得很好。他们甚至在他们的网站和演示中都有示例代码，因此您可以轻松开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-07T12:10:51.600

[Odyssey](http://www.codeplex.com/odyssey)是一组不错的控件，带有功能区菜单控件和 Outlook 样式的栏。

*不过，在 XBAP 应用程序中使用它们可能会遇到问题。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-26T11:13:38.093

[DevExpress](http://www.devexpress.com)也有丰富的集合。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T13:26:32.763

[Infragistics](http://www.infragistics.com/dotnet/netadvantage/wpf.aspx#Overview)有一些优秀的 WPF 和 WinForm 控件（商业）。我承认我只使用过他们的 WinForm 控件，但如果他们的 WPF 控件有任何相似之处，它们会很棒。

# javascript - 调用 Javascript 函数时，如何设置“this”的自定义值？

> ID：915587
> 
> 赞同：5
> 
> 时间：2009-05-27T13:02:39.350
> 
> 标签：javascript, jquery, this, jquery-events

我正在使用 jQuery，并且我有一个用作事件回调的函数，因此在该函数中，“this”表示捕获事件的对象。但是，有一个实例，我想从另一个函数显式调用该函数 - 在这种情况下，如何设置函数中的“this”将等于什么？

例如：

```
function handleEvent(event) {
    $(this).removeClass("sad").addClass("happy");
}

$("a.sad").click(handleEvent); // in this case, "this" is the anchor clicked

function differentEvent(event) {
    $("input.sad").keydown(e) {
        doSomeOtherProcessing();
        handleEvent(e); // in this case, "this" will be the window object
                        // but I'd like to set it to be, say, the input in question
    }
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-27T13:09:20.363

采用~~[申请](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Function/apply)~~ [打电话](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Function/call)。

```
handleEvent.call(this, e); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T13:06:15.677

只需参数化您感兴趣的函数：

```
function doStuff(el) {
    $(el).removeClass("sad").addClass("happy");
}

function handleEvent(event) {
    doStuff(this);
}

$("a.sad").click(handleEvent); // in this case, "this" is the anchor clicked

function differentEvent(event) {
    $("input.sad").keydown(e) {
        doSomeOtherProcessing();
        doStuff(this);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T13:06:37.750

采用

```
e.target 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T13:10:31.157

我建议你将你的函数重构为一个 jQuery 插件。

但这里有一个快速修复：

```
handleEvent.apply(this,e) //transfers this from one scope, to another 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T18:34:20.553

如果您只是想像正常触发一样调用单个事件处理程序，`apply`/`call`将正常工作。[但是，根据您的需要，使用 jQuery 的click()](http://docs.jquery.com/Events/click)函数的零参数版本可能更健壮，这将触发该元素的**所有**点击处理程序：

```
function differentEvent(event) {
    $("input.sad").keydown(e) {
        doSomeOtherProcessing();
        $(this).click(); // simulate a click
    }
} 
```

# asp.net - ASP.NET GridView HeaderRow

> ID：915590
> 
> 赞同：0
> 
> 时间：2009-05-27T13:03:29.720
> 
> 标签：asp.net, gridview

是否可以从 aspx 代码中设置 gridview 的 headerrow 属性？我希望能够在标题中包含额外的控件，例如用于过滤器的文本框。我可以通过动态添加控件从后面的 C# 代码中做到这一点，但这样做似乎会引入一些我宁愿避免的合适问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T13:07:26.000

使用标题模板字段。

```
<columns>
    <asp:templatefield>
        <headerstyle backcolor="Navy" forecolor="White"/>
        <headertemplate>
            <asp:textbox id="txtFilter" runat="server"/>
        </headertemplate>
    </asp:templatefield>                      
</columns> 
```

见[这里](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.templatefield.headertemplate.aspx)。

# .net - SELECT DISTINCT 在 .NET 应用程序中不起作用，但在 SQL Mgmt Studio 中起作用

> ID：915595
> 
> 赞同：1
> 
> 时间：2009-05-27T13:05:23.727
> 
> 标签：.net, sql, tsql, sql-server-2000

我有一个网络应用程序，我在其中对两个连接表调用 SELECT DISTINCT 查询。如果我尝试从网页运行查询，则会收到以下错误：“无法将 text、ntext 或 image 数据类型选为 DISTINCT”。当我从 SQL Management Studio 中运行它时，查询运行良好 - 没有错误。更有趣的是，这两个表中都没有 text、ntext 或 image 数据类型。

应该注意的是，我正在单步执行代码，并且在执行查询之前，我正在将查询从“监视”窗口复制到 Mgmt Studio，当我单步执行并让 .NET 运行时，它就会运行它，错误被抛出。我正在使用 .NET 2 和 System.Data.SqlClient 命名空间。

这是我的查询：

```
SELECT DISTINCT ResponseFormParent.* 
FROM ResponseFormParent 
INNER JOIN ResponseForm 
  ON ResponseFormParent.ResponseFormParentId = ResponseForm.ResponseFormParentId 
WHERE ResponseForm.RegistrationDeadline >= '5/1/2009' 
```

ResponseFormParent 有 3 个整数、1 个日期时间和 1 个 nvarchar(50)。ResponseForm 有 4 个整数、1 个日期时间、1 个位和 1 个 nvarchar(255)。

是什么导致了问题？该错误没有意义。

* * *

更新：调用查询的代码

```
public DataSet ExecuteQuery(string sql)
{
 DataSet ds = null;
 try
 {
  using (SqlConnection dbconn = new SqlConnection(connectionString))
  using (SqlCommand dbcmd = new SqlCommand(sql, dbconn))
  {
   SqlDataAdapter dbadapter = new SqlDataAdapter(dbcmd);
   ds = new DataSet();
   dbadapter.Fill(ds);
  }
 }
 catch (Exception ex)
 {
  Utility.LogError(sql, ex);
 }
 return ds;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T13:07:55.093

您可能正在查询两个不同的数据库。您是否在应用程序中检查过您的连接，以确保您实际上查询的数据库与您在 SQL Mgmt Studio 中查询的数据库相同？您也可能指向不同的服务器。您可能还想在您的 Connection 中进行检查。

如果是这种情况，那么很可能是您要查询的两个数据库之间的数据库架构不匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T13:34:57.410

如果将选择代码包装到**存储过程**中并从 C# 代码中调用它会发生什么？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T13:14:08.920

刚刚在包含 ntext 列的表上测试了 DISTINCT 查询。只要您避免选择 ntext 列，它就可以工作。当您包含 ntext 列时，您会收到您命名的错误。

所以你确定你的代码在做什么：

```
 SELECT DISTINCT ResponseFormParent.* 
```

并不是

```
 SELECT DISTINCT * 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T14:44:41.763

您确定它与使用 DataAdapter 没有任何关系吗？您是否使用阅读器 ==> dbcmd.ExecuteReader() 尝试过您的代码？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T15:26:54.660

尝试指定列而不是使用 select * （无论如何都不应该在 prod 上使用）。可能是数据适配器只是假设您在使用 select * 时可能有那种类型的列（只是在这里猜测）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T13:36:19.453

您是否检查过两个连接中是否使用了相同的凭据？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T13:11:20.157

您确定 Web 应用程序连接到同一个数据库吗？（即开发与生产）？

也许有人将 nvarchar(255) 更改为一个数据库中的文本列，而不是另一个...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-27T13:12:40.157

无需单步执行代码并将输出复制到 Management Studio 中，而是针对数据库运行 Profiler 并捕获发送到服务器的确切查询。然后复制它（包括 sp_executesql，如果它在那里）并在 Management Studio 中运行它。

这不仅会为您提供准确的查询，还会确认它正在针对正确的数据库运行。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-27T13:16:29.727

如果尝试一次选择一列，问题仍然存在？

# sql-server - 具有已提交读隔离级别和表约束的事务

> ID：915596
> 
> 赞同：1
> 
> 时间：2009-05-27T13:05:44.710
> 
> 标签：sql-server, transactions, constraints, isolation-level

表约束是否在同一个事务中执行？

我有一个具有已提交读隔离级别的事务，它在表中插入一些行。该表有一个约束，它调用一个函数，该函数又从同一个表中选择一些行。

看起来函数在不了解事务的情况下运行，并且函数中的选择返回表中在事务之前存在的行。

有解决方法还是我错过了什么？谢谢。

以下是交易和约束的代码：

```
insert into Treasury.DariaftPardakhtDarkhastFaktor
    (DarkhastFaktor, DariaftPardakht, Mablagh, CodeVazeiat, 
    ZamaneTakhsiseFaktor, MarkazPakhsh, ShomarehFaktor, User) 
values
    (@DarkhastFaktor, @DariaftPardakht, @Mablagh, @CodeVazeiat,
    @ZamaneTakhsiseFaktor, @MarkazPakhsh, @ShomarehFaktor, @User);

constraint expression (enforce for inserts and updates):
([Treasury].[ufnCheckDarkhastFaktorMablaghConstraint]([DarkhastFaktor])=(1))

ufnCheckDarkhastFaktorMablaghConstraint:

returns bit
as
begin
    declare @SumMablagh float
    declare @Mablagh    float

    select @SumMablagh = isnull(sum(Mablagh), 0)
    from Treasury.DariaftPardakhtDarkhastFaktor
    where DarkhastFaktor= @DarkhastFaktor

    select @Mablagh = isnull(MablaghKhalesFaktor, 0) 
    from Sales.DarkhastFaktor
    where DarkhastFaktor= @DarkhastFaktor

    if @Mablagh - @SumMablagh < -1
      return 0

    return 1
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T13:26:16.883

删除操作不强制检查约束，请参阅[http://msdn.microsoft.com/en-us/library/ms188258.aspx](http://msdn.microsoft.com/en-us/library/ms188258.aspx)

> 在 DELETE 语句期间不验证 CHECK 约束。因此，对具有某些类型的检查约束的表执行 DELETE 语句可能会产生意想不到的结果。

编辑 - 要回答您有关解决方法的问题，如果您的函数调用显示不变量已损坏，您可以使用删除触发器回滚。

编辑#2 - @reticent，如果你要添加行，那么检查约束调用的函数实际上应该看到行。如果没有，检查约束将毫无用处。这是一个简单的例子，你会发现前 2 次插入成功，而第三次插入失败，正如预期的那样：

```
create table t1 (id int)
go
create function t1_validateSingleton () 
returns bit
as
begin
declare @ret bit
set @ret = 1
if exists (
    select count(*)
    from t1
    group by id
    having count(*) > 1
)
begin
    set @ret = 0
end
return (@ret)
end
go
alter table t1
add constraint t1_singleton
    check (dbo.t1_validateSingleton()=1)
go
insert t1 values (1)
insert t1 values (2)
insert t1 values (1) 
```

# wpf - WPF 数据网格

> ID：915597
> 
> 赞同：0
> 
> 时间：2009-05-27T13:05:48.797
> 
> 标签：wpf, datagrid

如何禁用数据网格单元格编辑？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T15:38:10.813

DataGrid 列（如 DataGridTextColumn）具有 IsReadOnly 属性，只需将其设置为“True”。

```
<tk:DataGridTextColumn IsReadOnly="True" Binding="{Binding Path=MyData}" Header="My header" /> 
```

# iphone - 是否可以以编程方式更改应用程序图标？

> ID：915601
> 
> 赞同：2
> 
> 时间：2009-05-27T13:06:15.643
> 
> 标签：iphone, cocoa-touch, uikit

我想制作两个不同的应用程序图标，然后以编程方式在它们之间切换。当用户在未完成工作流程的情况下退出应用程序时，我想切换到一个图标，该图标表示启动应用程序时有一些未完成的操作。好吧，只是理论上，只是为了测试。

我认为图标文件和其他文件一样只是一个普通文件，所以如果我只是以编程方式重命名它，然后给另一个图标文件命名为 Info.plist 的图标文件的名称，那么应用程序应该显示另一个图标，对吧？那可能吗？还是我无权访问该文件来重命名它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T14:38:41.060

图标文件存储在“应用程序包”文件夹中。并且您的应用程序对该文件夹具有只读权限 没有官方方法可以更改/重命名这些文件。

您可以将整数徽章添加到您的图标

```
[[UIApplication sharedApplication] setApplicationIconBadgeNumber:666] 
```

但这不是官方方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T13:25:44.310

这听起来是个好主意，我肯定会试一试，但我觉得这是不可能的。

我相信应用程序图标会存储在 iPhone 全局的另一个文件结构中。我这样说是因为在我安装了 3.0 beta 5 之后，我看到了一个错误，即应用程序图标从我开发的应用程序中消失了。然后从应用商店安装两个新应用后，新应用的图标出现在我的应用上，第二个新应用的图标出现在两个新应用上。本质上，新的应用程序图标会移动以填补缺失的应用程序图标。

删除并重新添加应用程序，然后重新启动手机，正确恢复了图标。

当然，我不知道应用程序图标是如何管理和存储在手机上的，但可以说它们存储在某种缓存列表中，偶尔会重建，可能在重启后。这意味着即使您可以在应用程序中更改图标，也需要花费更多精力才能看到​​手机上的效果。

# asp.net-mvc - 如何使用 ASP.Net 为 Windows 2008 服务器动态创建子域

> ID：915619
> 
> 赞同：2
> 
> 时间：2009-05-27T13:09:50.520
> 
> 标签：asp.net-mvc, subdomain

如何让 Web 用户为我的网站为 Windows Server 2008 动态创建子域？我的应用程序使用 C# 在 MVC 1.0 和 ASP.Net 3.5 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T15:26:40.493

看看这个... [http://blog.maartenballiauw.be/post/2009/05/20/ASPNET-MVC-Domain-Routing.aspx](http://blog.maartenballiauw.be/post/2009/05/20/ASPNET-MVC-Domain-Routing.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T13:54:48.730

最常见的方法（理论上）是将 *.domain.ext 映射到您的一个 Web 应用程序。它本身会解析请求以查看正在使用的子域以及要显示的“站点”。

在实践中，我不确定这对于 IIS 或 ASP.NET 有多简单。当我还在使用 ASP.NET 时，我使用[了 UrlRewritingNet.UrlRewrite](http://www.urlrewriting.net/149/en/home.html)。两年前它比竞争对手领先了几光年，现在在战斗中看起来仍然很方便。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T14:00:41.027

如果您只想映射通配符，您可以在 IIS（和 DNS）中执行此操作，那么您可以解析请求的 url 以获取子域。否则澄清问题。

# sharepoint - CAML 无法在自定义字段中引用自定义属性

> ID：915624
> 
> 赞同：3
> 
> 时间：2009-05-27T13:11:05.900
> 
> 标签：sharepoint, moss, sharepoint-2007

我正在尝试在 SharePoint 中创建自定义字段类型。我的自定义字段类型有一个名为 CustomProperty 的自定义属性。

```
<FieldTypes>
  <FieldType>
    <Field Name="TypeName">CustomField</Field>
    <Field Name="InternalType">CustomField</Field>
    ..............................
    ..............................
    <PropertySchema>
      <Fields>
        <Field Name="CustomProperty" DisplayName="CustomProperty" Type="Text" Hidden="TRUE" />
      </Fields>
      <RenderPattern Name="DisplayPattern">
      <Property Select="CustomProperty" />
    </RenderPattern>
  </FieldType>
</FieldTypes> 
```

我正在尝试在 DisplayPattern 中呈现此自定义属性的值。

但看起来 CAML 无法引用自定义属性。

即使正确设置，我也没有得到 CustomValue 属性的任何值。

知道如何在 CAML 中引用自定义属性吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-11-24T20:09:02.160

不幸的是，据我所见，没有直接的方法可以实现这一目标。

您最好的选择是考虑使用它。[覆盖的GetFieldValue](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spfield.getfieldvalue.aspx)函数（或注释字段的 GetFieldValueAsHtml）中的[GetCustomProperty](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spfield.getcustomproperty.aspx)（“CustomProperty” ）。

传递给 GetFieldValue 函数的值字符串是 CAML 的输出，因此您可以附加到它并将其传递出去。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T16:49:04.947

这是一个示例：

[http://blogs.msdn.com/toddca/archive/2009/01/23/customizing-the-rendering-of-a-custom-spfield.aspx](http://blogs.msdn.com/toddca/archive/2009/01/23/customizing-the-rendering-of-a-custom-spfield.aspx)

我自己没有尝试过，我不知道更改 SchemaXml 是否会导致任何意外问题。

# asp.net - 如何公开用户控件内的 GridView 控件的列集合

> ID：915628
> 
> 赞同：1
> 
> 时间：2009-05-27T13:12:19.937
> 
> 标签：asp.net, user-controls

见编辑。

我希望能够在使用用户控件的 aspx 中执行此操作。

```
<uc:MyControl ID="MyGrid" runat="server">
     <asp:BoundField DataField="FirstColumn" HeaderText="FirstColumn" />
     <asp:BoundField DataField="SecondColumn" HeaderText="SecondColumn" />
</uc> 
```

我有这个代码（不起作用）。任何想法我做错了什么？

VB

```
Partial Public Class MyControl
    Inherits UserControl

    <System.Web.UI.IDReferenceProperty(GetType(DataControlFieldCollection))> _
    Public Property Columns() As DataControlFieldCollection
        Get
            Return MyGridView.Columns
        End Get
        Set(ByVal value As DataControlFieldCollection)
            ' The Columns collection of the GridView is ReadOnly, so I rebuild it
            MyGridView.Columns.Clear()
            For Each c As DataControlField In value
                MyGridView.Columns.Add(c)
            Next
        End Set
    End Property

    ...

End Class 
```

C＃

```
public partial class MyControl : UserControl
{

    [System.Web.UI.IDReferenceProperty(typeof(DataControlFieldCollection))]
    public DataControlFieldCollection Columns {
        get { return MyGridView.Columns; }
        set {
            MyGridView.Columns.Clear();
            foreach (DataControlField c in value) {
                MyGridView.Columns.Add(c);
            }
        }
    }

    ...

} 
```

编辑：

实际上它确实有效，但自动完成在 uc:MyControl 开始和结束标记之间不起作用，并且我收到编译器警告：-

*   元素“MyControl”的开始标签和结束标签之间不允许有内容。

*   验证（XHTML 1.0 过渡）：不支持元素“列”。

*   元素“BoundField”不是已知元素。如果网站中存在编译错误，或者缺少 web.config 文件，则可能会发生这种情况。

所以我想我需要使用某种指令来告诉编译器期望标签之间的内容。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-05-23T11:34:43.513

我找到了解决这个问题的方法

第 1 步 - 将以下属性添加到您的 UserControl

```
[ MergableProperty(false), DefaultValue((string)null), 
Editor("System.Web.UI.Design.WebControls.DataControlFieldTypeEditor, System.Design, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a",
    typeof(UITypeEditor)), 
PersistenceMode(PersistenceMode.InnerProperty)]
public virtual DataControlFieldCollection Columns
{
    get
    {
        return GridView1.Columns;
    }
} 
```

Secand - 你可以在你的用户控件标签中设置你的列集合，比如

```
 <uc1:TControl ID="TControl1" runat="server" >
    <Columns>
      <asp:BoundField DataField="ID" HeaderText="UserID" />
      <asp:BoundField DataField="Name" HeaderText="UserName" />
    </Columns>
    </uc1:TControl> 
```

> Visual Studio 将为列属性启用自动完成，但设计器将抛出异常

最后，您可以在用户控件中绑定 gridview

# python - 请指点我关于等离子开发的 QT 布局的（好的）文档

> ID：915633
> 
> 赞同：0
> 
> 时间：2009-05-27T13:14:10.433
> 
> 标签：python, qt, kde4, plasma, plasmoid

我正在尝试在 python 中开发 plasmoid。我在这里 (techbase.kde.org/Development/Tutorials/Plasma) 得到了一些很好的教程，它们确实很有帮助，但是它们没有关于 QT 布局及其用法的文档或示例。

我没有使用 QT 编程，但我很了解 C++。因此，资源不一定是 python api。

具体来说，我想要一个包含两行的布局，第一行包含两列，第二行包含 3 行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T14:25:24.877

Plasma 作为一个大的 QGraphicsView 工作，而 applet 是 QGraphicsWidget 项，这意味着您应该查看的是[QGraphicsLayout的文档，而不是建议的 QLayout。](http://doc.qtsoftware.com/4.5/qgraphicslayout.html)

对于要使用[QGraphicsGridLayout](http://doc.qtsoftware.com/4.5/qgraphicsgridlayout.html)的网格布局。特别看一下[addItem](http://doc.qtsoftware.com/4.5/qgraphicsgridlayout.html#addItem)方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T13:23:55.937

[Qt 文档](http://doc.qtsoftware.com/4.5/qlayout.html#details)也许是一个很好的起点？

# mysql - 选择 * 不存在的地方

> ID：915643
> 
> 赞同：111
> 
> 时间：2009-05-27T13:17:24.547
> 
> 标签：mysql, not-exists

我想我正走在这条正确的道路上......请耐心等待，因为我的 SQL 不是最好的

我正在尝试查询数据库以从一个表中选择某些单元格不存在于另一个表中的所有内容。这么多没有多大意义，但我希望这段代码能

```
SELECT * from employees WHERE NOT EXISTS (SELECT name FROM eotm_dyn) 
```

所以基本上我有一张桌子，上面有员工名单及其详细信息。然后是另一个包含一些其他详细信息的表，包括他们的名字。如果 eotm_dyn 表中没有名称，这意味着它们没有条目，我想看看他们到底是谁，或者换句话说，看看到底缺少什么。

上面的查询什么也没返回，但我知道有 20 个名字不见了，所以我显然没有做对。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：176
> 
> 时间：2009-05-27T13:19:17.007

您没有在查询中加入表。

除非 in 中根本没有记录，否则您的原始查询将始终不返回任何内容`eotm_dyn`，在这种情况下，它将返回所有内容。

假设这些表应该在 上连接`employeeID`，请使用以下命令：

```
SELECT  *
FROM    employees e
WHERE   NOT EXISTS
        (
        SELECT  null 
        FROM    eotm_dyn d
        WHERE   d.employeeID = e.id
        ) 
```

您可以使用关键字连接这些表`LEFT JOIN`并过滤掉`NULL`'s，但这可能不如使用`NOT EXISTS`.

* * *

## 回答 #2

> 赞同：87
> 
> 时间：2009-05-27T13:20:41.870

```
SELECT * FROM employees WHERE name NOT IN (SELECT name FROM eotm_dyn) 
```

或者

```
SELECT * FROM employees WHERE NOT EXISTS (SELECT * FROM eotm_dyn WHERE eotm_dyn.name = employees.name) 
```

或者

```
SELECT * FROM employees LEFT OUTER JOIN eotm_dyn ON eotm_dyn.name = employees.name WHERE eotm_dyn IS NULL 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-05-27T13:19:59.313

您可以执行 LEFT JOIN 并断言连接的列是 NULL。

例子：

```
SELECT * FROM employees a LEFT JOIN eotm_dyn b on (a.joinfield=b.joinfield) WHERE b.name IS NULL 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-27T13:24:26.280

```
SELECT * from employees
WHERE NOT EXISTS (SELECT name FROM eotm_dyn) 
```

`eotm_dyn`除非为空，否则从不返回任何记录。`SELECT name FROM eotm_dyn`你需要一些标准

```
SELECT * from employees
WHERE NOT EXISTS (
    SELECT name FROM eotm_dyn WHERE eotm_dyn.employeeid = employees.employeeid
) 
```

假设这两个表是通过外键关系链接的。此时，您可以使用各种其他选项，包括 LEFT JOIN。然而，在大多数情况下，优化器通常会以相同的方式处理它们。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-27T13:26:17.633

你也可以看看[这个相关的问题](https://stackoverflow.com/questions/354002/mysql-select-where-not-in-table)。该用户报告说，使用联接提供了比使用子查询更好的性能。

# nhibernate - 我应该如何设计我的数据层，以便我可以用 linqToSql 换掉 nHibernate？

> ID：915644
> 
> 赞同：0
> 
> 时间：2009-05-27T13:17:47.260
> 
> 标签：nhibernate, linq-to-sql, ado.net

所以我要使用 nHibernate，但想设计我的数据层，这样我就有可能换出（或切换）到 linqToSql 层。

我应该如何设计这个？

我应该创建一个包含所有数据库调用的接口吗？

像这样的东西？

```
GetUser();
InsertUser(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T13:29:59.543

[存储库模式的好例子](https://web.archive.org/web/20110503184234/http://blogs.hibernatingrhinos.com/nhibernate/archive/2008/10/08/the-repository-pattern.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T13:30:14.177

看看本文中存储库模式的用法，你可能会有一个好主意。

[http://ayende.com/Blog/archive/2007/06/08/Rhino-Commons-RepositoryltTgt-and-Unit-Of-Work.aspx](http://ayende.com/Blog/archive/2007/06/08/Rhino-Commons-RepositoryltTgt-and-Unit-Of-Work.aspx)

# c++ - 使用 OpenMP 的阻塞函数

> ID：915646
> 
> 赞同：2
> 
> 时间：2009-05-27T13:18:06.447
> 
> 标签：c++, multithreading, openmp

我有一个 GUI 应用程序，它从第二个线程监听网络端口。我在看 OpenMP，我想知道是否有简单的方法来创建这样的线程。我正在搜索文档，但 OpenMP 站点浏览起来不是很方便。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T17:19:38.770

据我了解，OpenMP 是一个针对繁重计算的编译器辅助并行化框架/库。您提示编译器您的代码的哪些部分（通常是循环）可以并行运行。编译器发挥了它的魔力（插入库调用、共享/取消共享变量等），而且，噗，程序现在可以在多个内核上运行得更快（有时）。我不知道，使用 OpenMP 可能会做你想做的事，但我认为你正在寻找错误的工具。[直接用pthread](http://portal.acm.org/citation.cfm?id=263953)做事是一种选择。

# ruby - 正则表达式计数系统

> ID：915647
> 
> 赞同：0
> 
> 时间：2009-05-27T13:18:11.300
> 
> 标签：ruby, regex, counting

我正在尝试创建一个可以将 RegEx 值转换为整数的系统，反之亦然。其中零是最基本的正则表达式（可能 `"/./"`），任何后续数字都是更复杂的正则表达式

到目前为止，我最好的方法是将正则表达式中可能包含的所有可能值粘贴到数组中：

```
values = [ "!", ".", "\/", "[", "]", "(", ")", "a", "b", "-", "0", "9", .... ] 
```

然后从该数组中获取如下：

```
def get( integer ) 
  if( integer.zero? ) 
    return '';
  end

  integer = integer - 1;

  if( integer < values.length )
    return values[integer]
  end

  get(( integer / values.length ).floor) + get( integer % values.length);
end

sample_regex = /#{get( 100 )}/; 
```

这种方法的最大问题是很容易生成**无效的正则表达式。**

是否有已经建立的算法来实现我正在尝试的目标？如果没有，有什么建议吗？

感谢
史蒂夫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T13:22:45.003

由于正则表达式可以通过递归应用有限数量的元素来正式定义，因此可以这样做：不是简单地连接元素，而是根据正则表达式的规则组合它们。因为正则语言也是[递归可枚举](http://en.wikipedia.org/wiki/Recursively_enumerable_language)的，所以保证可以工作。

但是，实现这一点很可能是矫枉过正。你需要这个做什么？一个简单的`Number -> RegExp`键值对字典是否更适合将正则表达式与唯一数字相关联？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T03:50:08.447

我会说这`//`是最简单的正则表达式（它匹配任何东西）。 `/./`相当复杂，因为它只是 的简写`/[^\n]/`，它本身只是更长表达式的简写（该表达式的内容取决于您的字符集）。下一个最简单的表达式是字符集中的第一个字符在`/a/`哪里。`a`最后一条语句为您的枚举带来了一个有趣的问题：您将使用什么字符集？任何枚举都将绑定到给定的字符集。假设您从`//`0 开始， `/\x{00}/`（匹配 nul 字符）为 1，`/\x{01}/`如 2 等。然后，如果您使用 ASCII 集，您将开始在 129 左右进入有趣的正则表达式（匹配多个字符串的正则表达式），但对于 UNICODE 5.0，它最多需要 1114112。

总而言之，我想说一个更好的解决方案是将数字视为字节序列，将这些字节映射到您正在使用的任何字符集，使用正则表达式编译器来确定该数字是否是有效的正则表达式，并丢弃数字无效。

# c# - 清单上应该有什么可以帮助某人开发好的 OO 软件？

> ID：915649
> 
> 赞同：26
> 
> 时间：2009-05-27T13:18:38.053
> 
> 标签：c#, oop

几年前我使用过 OO 编程语言和技术（主要是在 C++ 上），但在此期间，我对 OO 并没有做太多事情。

我开始在 C# 中制作一个小实用程序。我可以在不使用良好的 OO 实践的情况下简单地对其进行编程，但是应用 OO 技术对我来说是一个很好的复习。

就像数据库规范化级别一样，我正在寻找一个清单，它可以提醒我“好的”面向对象程序的各种经验法则 - 一个简洁的是/否列表，我可以在设计和实施过程中偶尔阅读以防止我从程序上思考和工作。如果它包含正确的 OO 术语和概念，这样会更有用，以便可以轻松搜索任何检查项以获取更多信息。

**清单上应该有什么可以帮助某人开发好的 OO 软件？**

相反，可以应用哪些“测试”来表明软件不是面向对象的？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-10-30T01:43:33.743

*   **对象*做事*。（整个 OOP 中最重要的一点！）**不要将他们视为“数据持有者”——向他们发送消息以做某事。我的班级应该有哪些动词？“责任驱动设计”学派在这方面表现出色。（参见*对象设计：角色、职责和协作*，Rebecca Wirfs-Brock 和 Alan McKean，Addison-Wesley 2003，ISBN 0201379430。）
*   对于系统必须做的每一件事，**提出一堆具体的场景来描述对象如何相互交谈以完成工作**。这意味着要根据交互图进行思考并执行方法调用。- 不要从类图开始 - 这是 SQL 思维而不是 OO 思维。
*   **学习测试驱动开发。** *没有人能*直接得到他们的对象模型，但如果你做 TDD，你就是在做基础工作，以确保你的对象模型能做它需要做的事情，并确保在以后发生变化时可以安全地重构。
*   **只为你现在的需求而构建**——不要执着于“重用”或“以后有用”的东西。如果你只构建你现在需要的东西，你就可以让你以后可以做的事情的设计空间更加开放。
*   **在建模对象时忘记继承。**这只是实现通用代码的一种方式。当您对对象进行建模时，只需假装您正在通过一个界面查看每个对象，该界面描述了可以要求它做什么。
*   **如果一个方法需要大量参数，或者如果您需要重复调​​用一堆对象来获取大量数据，则该方法可能位于错误的类中。**方法的最佳位置就在它在同一类（或超类...）中使用的大多数字段旁边
*   **阅读适合您的语言的设计模式书籍。**如果是 C#，试试 Steve Metsker 的“Design Patterns in C#”。这将教您一系列技巧，您可以使用这些技巧在对象之间划分工作。
*   **不要测试一个对象以查看它是什么类型，然后根据该类型采取行动**——这是一种代码味道，对象可能应该在做这项工作。这是一个提示，您应该调用该对象并要求它完成工作。（如果只有某些类型的对象可以完成工作，您可以简单地在某些对象中“什么都不做”实现......这是合法的 OOP。）
*   **将方法和数据放在正确的类中可以使 OO 代码运行得更快（并让虚拟机有机会更好地优化）——这不仅仅是美学或理论上的。**Sharble 和 Cohen 的研究指出了这一点 - 请参阅[http://portal.acm.org/citation.cfm?doid=159420.155839](http://portal.acm.org/citation.cfm?doid=159420.155839)（请参阅“每个场景执行的指令数”的指标图表）

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-11-05T21:06:03.840

听起来你想要一些基本的是/否问题来问自己。每个人都给出了一些很棒的“这样做”和“那样想”列表，所以这是我对一些简单的是/否的破解。

我可以对所有这些都回答“是”吗？

*   我的类是否代表我关心的名词？
*   我的类是否提供了它可以执行的动作/动词的方法？

我可以对所有这些都回答否吗？

*   我是否有可以放入单例或存储在使用它的类实现中的全局状态数据？
*   我可以删除类上的任何公共方法并将它们添加到接口或将它们设为私有/受保护以更好地封装行为吗？
*   我应该使用接口将行为与其他接口或实现类分开吗？
*   我是否有在相关类之间重复的代码，我可以将这些代码移到基类中以更好地重用和抽象代码？
*   我是否在测试某事的类型以决定采取什么行动？如果是这样，这种行为是否可以包含在相关代码正在使用的基类型或接口中以允许更有效地使用抽象，或者是否应该重构相关代码以使用更好的基类或接口？
*   我是否反复检查一些上下文数据来决定实例化什么类型？如果是这样，是否可以将其抽象为工厂设计模式以更好地抽象逻辑和代码重用？
*   一个具有多个功能重点的类是否非常大？如果是这样，我可以把它分成多个类，每个类都有自己的单一目的吗？
*   我是否有从同一个基类继承的不相关的类？如果是这样，我可以将基类划分为更好的抽象，还是可以使用组合来访问功能？
*   我的继承层次变得深得可怕吗？如果是这样，我可以通过接口或拆分功能将其展平或分离吗？
*   我太担心我的继承层次结构了？
*   当我向橡皮鸭解释设计时，我是对设计感到愚蠢还是对与鸭子交谈感到愚蠢？

只是一些快速的从我的头顶。我希望它有所帮助，OOP 会变得非常疯狂。对于通常与大型应用程序有关的更高级的东西，我没有包括任何是/否，例如依赖注入，或者您是否应该将某些内容拆分为不同的服务/逻辑层/程序集......当然我希望你至少将您的 UI 与您的逻辑分开。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-11-02T11:41:50.663

收集自各种书籍、著名的 C# 程序员和一般建议（如果这些都是我的，那么这些建议并不多；从某种意义上说，这些是我在开发过程中问自己的各种问题，仅此而已）：

*   **结构还是类？**您正在创建的项目是它自己的价值吗，让它成为一个结构。如果它是具有属性和子值、方法以及可能的状态的“对象”，则将其设为对象。
*   **密封类**：如果您要创建一个类并且您不需要明确地需要能够从它继承，请使其密封。（我这样做是为了获得所谓的性能提升）
*   **不要重复自己**：如果您发现自己复制过去（a/e）代码，那么您可能应该（**但不总是**）重新考虑您的设计以尽量减少代码重复。
*   如果您不需要为给定的抽象类提供基本实现，请将其转换为接口。
*   **专业化原则**：您拥有的每个对象都应该只做一件事。这有助于避免“上帝对象”。
*   **使用属性进行公共访问**：这已经被反复讨论过，但它确实是最好的做法。属性允许你做你通常不能用字段做的事情，它还允许你更好地控制如何获取和设置对象。
*   **Singletons**：另一个有争议的话题，这里的想法是：只在你绝对需要的时候使用它们。大多数时候，一堆静态方法可以达到单例的目的。（尽管如果您绝对需要单例模式，请使用[Jon Skeet 的优秀](http://www.yoda.arachsys.com/csharp/singleton.html)模式）
*   **松散耦合**：确保你的类尽可能少地相互依赖；确保您的图书馆用户可以轻松地将图书馆的部分内容与其他人（或自定义构建的部分）交换。这包括在必要时使用接口、封装（其他人已经提到过）以及此答案中的大多数其他原则。
*   **设计时要考虑简单**：与蛋糕糖霜不同，现在设计简单的东西然后添加比现在设计复杂的东西以后删除更容易。

如果我是以下情况，我可能会将其中的一部分或全部扔出：

*   编写个人项目
*   真的很急于完成一些事情（但我稍后会回来......有时......;））

这些原则有助于指导我的日常编码，并在某些方面极大地提高了我的编码质量！希望有帮助！

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-27T13:36:27.190

Steve McConnell 的[Code Complete 2](https://rads.stackoverflow.com/amzn/click/com/0735619670)包含许多可立即使用的清单，用于构建良好的软件。

Robert C. Martin 的[C# 中的敏捷原则、模式和实践](https://rads.stackoverflow.com/amzn/click/com/0131857258)包含许多良好 OO 设计的原则。

两者都会给你一个坚实的基础。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-27T14:05:49.690

*   **数据属于对其进行操作的代码**（即属于同一类）。这提高了可维护性，因为许多字段和方法可以是私有的（**封装**），因此在查看组件之间的交互时在某种程度上不考虑考虑。
*   **使用多态性而不是条件**- 每当您必须根据对象的类做不同的事情时，尝试将该行为放入不同类以不同方式实现的方法中，这样您所要做的就是调用该方法
*   **谨慎使用继承，更喜欢组合**- 继承是 OO 编程的一个显着特征，通常被视为 OOP 的“本质”。它实际上被严重过度使用，应该被归类为最不重要的特征

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-11-03T17:15:09.943

*   **我是否明确定义了要求？**正式的需求文档可能不是必需的，但在开始编码之前您应该有一个清晰的愿景。如果您不需要正式的文档，思维导图工具和原型或设计草图可能是不错的选择。在软件过程中尽早与最终用户和利益相关者合作，以确保您正在实施他们需要的东西。

*   **我在重新发明轮子吗？**如果您正在编码以解决常见问题，请寻找已经解决此问题的强大库。如果您认为您可能已经在代码的其他地方解决了问题（或同事可能已经解决了），请首先寻找现有的解决方案。

*   **我的对象有明确的单一目的吗？**遵循封装原则，一个对象应该与它所操作的数据一起具有行为。一个对象应该只有一个主要职责。

*   **我可以对接口进行编码吗？**契约式设计是实现单元测试、记录详细的类级需求和鼓励代码重用的好方法。

*   **我可以测试我的代码吗？**测试驱动开发 (TDD) 并不总是那么容易。但是单元测试对于重构和验证更改后的回归行为非常有用。与按合同设计密切相关。

*   **我过度设计了吗？**不要尝试编写可重用的组件。不要试图预测未来的需求。这些事情可能看起来违反直觉，但它们会带来更好的设计。第一次编写代码时，只需尽可能简单地实现它，然后让它工作。第二次使用相同的逻辑，复制和粘贴。一旦您拥有两个具有共同逻辑的工作代码部分，您就可以轻松地重构，而无需尝试预测未来的需求。

*   **我是在引入冗余代码吗？**不要重复自己（DRY）是重构的最大驱动原则。仅将复制和粘贴用作重构的第一步。不要在不同的地方编写相同的代码，这是维护的噩梦。

*   **这是一种常见的设计模式、反模式还是代码异味？**熟悉面向对象设计问题的常见解决方案，并在编写代码时寻找它们——但不要试图强迫问题适合某种模式。注意属于常见“不良做法”模式的代码。

*   **我的代码是否过于紧密耦合？**松散耦合是一种试图减少两个或多个类之间的相互依赖关系的原则。一些依赖是必要的；但是你越依赖另一个类，当这个类发生变化时你就越需要修复。不要让一个类中的代码依赖于另一个类的实现细节——只根据它的契约使用一个对象。

*   **我是否暴露了太多信息？**练习信息隐藏。如果方法或字段不需要公开，请将其设为私有。仅公开对象履行其合同所需的最低限度的 API。不要让客户端对象可以访问实现细节。

*   **我在防御性地编码吗？**检查错误情况，并快速失败。不要害怕使用异常，并让它们传播。如果您的程序达到意外状态，最好中止操作，记录堆栈跟踪以供您使用，并避免下游代码中出现不可预测的行为。遵循清理资源的最佳实践，例如`using() {}`声明。

*   **我能在六个月内阅读此代码吗？**好的代码可以用最少的文档来阅读。必要时发表评论；还要编写直观的代码，并使用有意义的类、方法和变量名。练习良好的编码风格；如果您正在处理团队项目，则团队中的每个成员都应该编写看起来相同的代码。

*   **它仍然有效吗？**尽早测试，经常测试。引入新功能后，返回并触摸任何可能受到影响的现有行为。让其他团队成员同行评审并测试您的代码。进行更改后重新运行单元测试，并使其保持最新。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-06-04T23:05:11.297

最好的来源之一是 Martin Fowler 的“重构”一书，其中包含您可能要考虑重构的面向对象代码气味的列表（和支持细节）。

我还会推荐 Robert Martin 的“清洁代码”中的清单。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-11-03T23:40:43.223

*   坚硬的
*   干燥
*   TDD
*   组合优于继承

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-05-27T14:00:31.433

确保您阅读并理解以下内容

*   封装
    *   （确保您只公开最小的状态和功能来完成工作）
*   多态性
    *   （派生对象表现得像他们的父母的能力）
*   接口和抽象类的区别
    *   （抽象类允许与其后代共享功能和状态，接口只是实现功能的承诺）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-10-30T01:05:16.527

UML - 统一建模语言，用于对象建模和定义类的结构和关系

[http://en.wikipedia.org/wiki/Unified_Modeling_Language](http://en.wikipedia.org/wiki/Unified_Modeling_Language)

然后当然是面向对象的编程技术（大部分已经提到过）

*   信息隐藏
*   抽象
*   接口
*   封装
*   继承/多态

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-11-02T22:56:15.993

有些规则与语言无关，有些规则因语言而异。

以下是一些与之前发布的其他规则相矛盾的规则和评论：

*   OO有4个原则：抽象、封装、多态和继承。
    阅读它们并牢记它们。

*   建模 - 您的类应该对问题域中的实体进行建模：
    将问题划分为子域（包/命名空间/程序集）
    ，然后将每个子域中的实体划分为类。
    类应该包含模拟该类型的对象做什么的方法。

*   使用 UML，考虑需求、用例，然后是类图，它们是序列。（主要适用于高层设计——主要类和流程。）

*   设计模式 - 任何语言的好概念，不同语言的实现不同。

*   结构与类 - 在 C# 中，这是按值或按引用传递数据的问题。

*   接口与基类，是一个基类，做一个接口。

*   TDD——这​​不是OO，事实上，它会导致缺乏设计并导致大量重写。（例如，Scrum 建议不要这样做，对于 XP，这是必须的）。

*   C# 的反射在某些方面会覆盖 OO（例如基于反射的序列化），但它对于高级框架是必需的。

*   确保类不“知道”其他类，除非他们必须这样做，划分为多​​个程序集并缺乏引用会有所帮助。

*   AOP（面向方面​​的编程）以一种革命性的方式增强了 OOP（例如，参见 PostSharp），以至于您至少应该查看它并观看他们的剪辑。

*   对于 C#，请阅读 MS 指南（在 VS 的 MSDN 帮助索引中查找指南），那里有很多有用的指南和约定

*   推荐书籍：
    Framework Design Guidelines: Conventions, Idioms, and Patterns for Reusable .NET Libraries
    C# 3.0 in a Nutshell

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-27T13:29:06.033

我喜欢[这个](http://c2.com/cgi/wiki?PrinciplesOfObjectOrientedDesign)清单，虽然它可能有点密集用作清单。

# algorithm - 跟踪对象的状态 - SOS

> ID：915652
> 
> 赞同：0
> 
> 时间：2009-05-27T13:19:29.020
> 
> 标签：algorithm, language-agnostic, design-patterns

嗨，SO 的聪明人。这是一个SOS。

我有一个很深的麻烦。在我的 Web 应用程序中有一个对象（假设它是对某事的请求）。用户提交他/她的请求。在此之后，可以批准/不批准该请求的人。在从提交到批准/不批准期间，可以对请求采取许多行动。我必须向用户展示操作面板（链接集合），他/她可以使用它来修改请求的状态。

现在基于处理请求的哪个阶段是不允许的某些操作。此外，如果已经采取了某些行动，则排除了其他行动的可能性。

总的来说，它创建了一个非常复杂的允许/禁止行为矩阵，我的小脑袋无法处理它。

我创建了一些静态类/方法，它们根据请求的状态返回允许的操作数组。应用程序可以处于大约 20 种状态。我已经根据状态注意删除/禁用在该状态下不可能执行的操作的链接。现在出现的问题是假设请求处于状态 X。

现在，如果在过去的行动 l 已被要求采取我们可能不允许 l 或基于此一些任意行动 m,n,o。

在编写了获取 20 个状态的链接数组的所有方法之后，我必须根据过去的操作历史（存储在 sql db 中）过滤数组，这是一项非常非常大的任务。

请建议我一些更容易实现和高效的模式。这让我很紧张。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T07:21:52.207

据我了解，您有一个真实的工作流程场景。在这种情况下，我会：

1.  如果可能，将整个状态建模为单个实体（具有固定数量字段的单行）。我不会将此建模为一组动作。

2.  将每个动作建模为行中的一些变化。当用户输入一些数据时很明显，但我也会将每个接受建模为 - 布尔字段或状态字段 - 取决于接受是由独立部门完成还是单个部门的级联接受。

3.  也可能存在这样一种情况，即对某些特定参数给出接受，并且该参数将来可能会改变，需要新的接受。在这种情况下，我会将这样的场景建模为两个字段。On 表示参数值，第二个表示接受值。我会根据这两个领域的差异来决定是否仍然需要接受。这允许实现一些阈值。

4.  将状态建模为单行，我将为动作允许实现独立的谓词。

我认为第 4 点是最重要的。如果您能够为启用操作实现*独立*的谓词，那么您将来可以轻松地修改它们。

正确实现 1-3 后，您将能够轻松实现接受撤销，这可能是必需的，在这种情况下可能会使整体代码大小更小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T13:25:15.450

听起来像是状态机工作流的工作，或者是几个巨大的嵌套开关（你喜欢哪个）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T13:31:06.717

我想到的第一件事：状态机。每个状态都是某种对象。所有状态都有一些方法“processRequest”将执行转移到下一个状态。

我想到的第二件事 - 这些状态必须像树或图表一样组织。该图表示请求的历史记录。您从初始状态开始。你得到请求 A，你进入状态 A。之后，你得到请求 B，你进入 AB。您的描述不清楚状态 AB 是否等于 BA。

这样，你得到的状态比你现在拥有的 20 个状态要多得多，但每个状态都包含历史。我建议在您必须采取的路径之后使用命名约定（例如之前的 AB）。也许您可以在 AB 中重用状态 A 和 B，以最大限度地减少编码。

# java - 在不同的线程中启动一个 Java 类

> ID：915654
> 
> 赞同：2
> 
> 时间：2009-05-27T13:19:40.250
> 
> 标签：java, concurrency

我想知道如何从不同的线程调用一个类，并让所有调用在它自己的线程中运行？

假设我有三个线程，每个线程都需要调用 anotherClass.getBS()，但调用可能同时出现，没有理由同时执行它们。死锁不是问题。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T13:27:23.650

如果 anotherClass.getBS() 真的是线程安全的，你可以从你的三个线程中的每一个调用它。它将在您调用它的线程中运行。

一个在行动中的小例子。下面的代码产生这个输出：

```
$ javac Bar.java
$ java Bar
Thread ID 9 running
Thread ID 10 running
Thread ID 8 running
Doing something on thread 9
Doing something on thread 10
Doing something on thread 8
Thread ID 9 running
Doing something on thread 9
Thread ID 8 running
Doing something on thread 8
Thread ID 10 running
Doing something on thread 10 
```

这是代码：

```
public class Bar
{

  static private final class MyOtherClass
  {
    public void doSomething()
    {
      System.out.println("Doing something on thread "+Thread.currentThread().getId());
    }
  }

  static private MyOtherClass myOtherClass=new MyOtherClass();

  static private final class MyThreadClass implements Runnable
  {
    public void run()
    {
      while (true)
      {
        try
        {
          Thread.sleep(1000);
        }
        catch (InterruptedException ie)
        {
          System.err.println("Interrupted");
          return;
        }
        System.out.println("Thread ID "+Thread.currentThread().getId()+" running");
        myOtherClass.doSomething();
      }
    }
  }

  static public void main(String[] args)
  {
    Thread t1=new Thread(new MyThreadClass());
    Thread t2=new Thread(new MyThreadClass());
    Thread t3=new Thread(new MyThreadClass());
    t1.start();
    t2.start();
    t3.start();
  }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T13:28:26.147

如果您确定该`getBS()`方法没有任何并发​​问题，只需正常调用该方法。

如果方法`static`只是这样做：

```
AnotherClass.getBS(); 
```

别的

将 obj 的引用传递`anotherClass`给每个线程：

```
 class MyThread extends Thread {
     private AnotherClass anotherClass;

     MyThread(AnotherClass anotherClass) {
         this.anotherClass= anotherClass;
     }

     public void run() {
         anotherClass.getBS();
     }
 }

 MyThread p = new MyThread(anotherClass);
 p.start(); 
```

# java - 休眠一对一还是组件？

> ID：915656
> 
> 赞同：0
> 
> 时间：2009-05-27T13:20:21.387
> 
> 标签：java, hibernate

我想知道如何为表编写模型 hbm.xml

```
Company
-------
id(PK)
name
address
typeid(fk)

Type
----
id(PK)
type

class Company(){
int id;
String name;
String address;
Type type;
}

class Type(){
int id;
String type;
} 
```

（使用 get/set 方法）

如何写hbm？

我正在使用休眠 3.x。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T14:07:52.853

您可以拥有多个相同类型的公司吗？你真的不想要多对一的关系吗？

像这样的东西怎么样（改编自[这里](http://docs.jboss.org/hibernate/stable/core/reference/en/html/assoc-unidirectional.html)的 Hibernate 文档）：

```
<class name="Company" table="company">
    <id name="id" column="id">
    ...
    </id>
    ....
    <many-to-one name="type" 
        class="Type"
        column="typeid" 
        not-null="true"/>
</class>

<class name="Type">
    <id name="id" column="id">
        ...
    </id>
</class> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T14:01:52.553

给定的情况是多对一的情况，因为一种类型可以分配给多个公司

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T13:27:10.283

```
<class name="Company" table="company">
<id name="id" column="id">
    <generator class="foreign">
        <param name="property">type</param>
    </generator>
</id>
...
<one-to-one name="type"
    class="Type"
    constrained="true"/>
</class> 
```

更多细节[在这里](http://docs.jboss.org/hibernate/stable/core/reference/en/html/mapping.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T14:02:07.280

这并不明显，但它可以直接映射到`many-to-one`.

```
<class name="Company" table="company">
<id name="id">
    <generator class="native">
        <param name="sequence">Company_SEQ</param>
    </generator>
</id>
...
<many-to-one 
    name="type"
    class="Type"
    constrained="true"/>
</class> 
```

# pdf - Sql Server Reporting Services 2005 报表从 PDF 导入

> ID：915657
> 
> 赞同：2
> 
> 时间：2009-05-27T13:20:31.293
> 
> 标签：pdf, reporting-services, import

是否有可用的工具或编程方法来获取 PDF 中定义的布局并将其导入 Sql Server Reporting Services 2005？

相当多的布局由第三方创建为 PDF。如果我可以使用一些已经定义的布局，它会使开发变得容易得多。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T13:26:25.667

我不知道有什么可以做到这一点。

我能想到的唯一方法是将PDF文件转换为RDLC文件。RDLC 文件是一个 XML 文件，并遵循特定的架构。要做到这一点，将需要很多时间。您最好手动在报告服务中创建报告。

我一定会密切关注这个线程，但是，我很确定这个解决方案还不存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T13:31:39.807

Jon 关于将 PDF 转换为 XML 并将其用作基础的回答听起来像是一个可能的解决方案，但正如他所说，它背后的时间和精力可能根本不值得。

据我所知，我不记得 SSRS 有任何真正的布局导入功能，也没有听说过任何第三方工具可以使它更容易。如果我有，我早就购买了它，因为我自己的主要时间消耗是复制在客户的遗留系统上生成的表单和报告以在 SSRS 上工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-12T07:50:13.520

我目前有同样的问题，但如果必须，我将获取 pdf 并将它们保存为图像 - 允许我将它们插入到报告中 - 作为最后的手段。

# javascript - 页面顶部 Javascript 书签

> ID：915661
> 
> 赞同：2
> 
> 时间：2009-05-27T13:22:30.620
> 
> 标签：javascript, bookmarklet

谁能告诉我怎么转

```
<a href="javascript:scroll(0,0)"> Top</a> 
```

又名到 Bookmarklet 的页首链接。

对 JavaScript 不是很了解，也无法实现我想要的。

或者，如果我使用了错误的代码，那么您能否为我修复它并将其变成书签。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T13:25:23.250

创建带有位置的书签：

```
javascript:void(function(){window.scroll(0,0)}()) 
```

适用于 Firefox 3 和 IE 7。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-12-30T23:11:27.303

这是我书签中的一篇文章 .. 这是一个简单易用的解决方案，我已经使用了很长时间了。

[http://www.geeksww.com/tutorials/web_development/javascript/tips_and_tricks/javascript_go_to_top_of_page.php](http://www.geeksww.com/tutorials/web_development/javascript/tips_and_tricks/javascript_go_to_top_of_page.php)

希望这有效

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T13:36:23.947

另外的选择 ...

```
function scrollUp(){
  var offy;
  if(self.pageYOffset) {
        offy = self.pageYOffset;
  } else if(document.documentElement && document.documentElement.scrollTop){
        offy = document.documentElement.scrollTop;
  } else {
        offy = document.body.scrollTop;
  }

  if(offy <= 0) return;

  window.scrollBy(0, -50);
  setTimeout("scrollUp()", 10); 
```

}

```
<a href="javascript: scrollUp();">Start Scroller!</a> 
```

# c# - paypal动态退货地址

> ID：915667
> 
> 赞同：0
> 
> 时间：2009-05-27T13:24:20.740
> 
> 标签：c#, asp.net, url, paypal, return

我有一个产品，一个动态创建的文件，我需要一个贝宝在向文件地址付款后返回客户。简单的立即购买按钮很优雅，但如果我把

```
<input type="hidden" name="return" value="http://www.mysite.com/x727x7e.dat"> 
```

变成一个按钮的代码，简单的浏览器的Page-View Source就可以显示支付前的文件地址。

以下是按钮代码示例：

```
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="return" value="http://www.mysite.com/x727x7e.dat">
<input type="hidden" name="cancel_return" value="http://www.mysite.com/nothanx.html">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="hosted_button_id" value="1111111111">
<input type="image" src="https://www.paypal.com/en_AU/i/btn/btn_buynowCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online.">
<img alt="" border="0" src="https://www.paypal.com/en_AU/i/scr/pixel.gif" width="1" height="1"></form> 
```

我认为正确的方法是使用 PayPal api 并在交易成功后生成文件，但由于我是 paypal 的菜鸟，想知道这可以用一种优雅的方式解决吗？

我可以制作一个（asp.net c#）按钮，使带有此参数的 post 方法发送到 paypal，以便客户看不到返回 url？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T13:36:30.293

是的，创建一个名为的隐藏输入`return`并插入您的返回地址。您还可以设置一个名为的隐藏输入`cancel_return`，并插入一个取消返回地址，如果用户尝试取消事务，则使用该地址。最后，您可以添加一个名称，该名称将在购买后异步`notify_url`接收*POST 。*该`return`地址也将收到一个*POST*，但前提是用户单击返回。

*编辑*：

我刚刚注意到你想隐藏地址。一，正如我提到的，付款信息已发布到该地址，其中包括一个验证码，如果付款有效，您可以询问贝宝。因此，这意味着对地址保密并不重要（此外，在一次付款后，用户无论如何都可以看到他去了哪里）。

第二，您可以向贝宝注册一个 SSL 密钥，然后用它加密您的字段。请参阅他们的文档以了解如何执行此操作。

用户可以做的最糟糕的事情是通过贝宝完成错误的付款——他们仍然会被收取费用，但必须直截了当地声称你的网站说它（无论你卖的是什么）只是 0.01 美元10.00 美元。

这可能是也可能不是问题，具体取决于您销售的产品。

# c++ - 编写一个可以嵌入其他应用程序并作为单独进程运行的 shell

> ID：915670
> 
> 赞同：1
> 
> 时间：2009-05-27T13:24:28.820
> 
> 标签：c++, winapi, shell

我从惠普网站上发现了一篇有趣的文章。他们编写了一个 TouchSmart Shell 应用程序，它允许其他应用程序嵌入到该 shell 中，并作为一个单独的进程运行。当然，HP 对嵌入式应用程序定义了一些限制。不知道C++和Win32能不能做类似的事情？ [http://www.touchsmartcommunity.com/article/95/An-HP-TouchSmart-Application-Development-Guidelines-Primer/?textpage=1](http://www.touchsmartcommunity.com/article/95/An-HP-TouchSmart-Application-Development-Guidelines-Primer/?textpage=1)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T13:33:02.953

这不是所有的unix shell都做的吗？将应用程序嵌入到自身中。我希望我正确理解了你的问题。类似的事情绝对可以在 Win32 中完成。MSYS (Minimal SYStem) 和 Cygwin 都这样做。它们有自己的外壳，尽管我认为它们是用 C 而不是 C++ 编写的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T22:59:20.207

也许我错过了一些东西，但 TouchSmart 看起来就像是从其中启动 .NET 应用程序的一种方式。您可能需要调用一些 API 才能正确呈现或连接事件。

# c# - 是否可以在 SOAP Web 服务中创建只读元素？

> ID：915672
> 
> 赞同：3
> 
> 时间：2009-05-27T13:24:34.907
> 
> 标签：c#, web-services, soap, c#-2.0

我有一个定义了只读属性的类。在我的代码中，我将其定义为仅具有 getter 的属性。

我希望能够通过 Web 服务来回发送此对象。当我在服务中调用“Get”方法时，它将在服务端填充一个值。定义此属性后，我不希望 Web 服务的使用者能够设置/更改此属性。

当我将此 Web 服务的引用添加到项目时，该对象的属性以几种不同的方式序列化，具体取决于我尝试在服务端定义对象的方式：

*   **internal setter**：在 WSDL 中创建属性。Visual Studio 会为此属性生成一个具有 getter 和 setter 的类。
*   **no setter**：不在 WSDL 中创建属性。Visual Studio 显然根本没有定义这个属性。
*   **只读公共成员变量**- 不在 WSDL 中创建属性。同样，Visual Studio 不会对这个属性做任何事情，因为它不知道它。

允许 Web 服务的使用者为此属性设置值不会造成任何损害。如果设置了该值，则在 Web 服务端将被忽略。如果消费者不能更改/设置属性开始，我会更喜欢。

有没有办法将属性定义为只读？现在我们正在使用 C#/.NET 2.0 作为 Web 服务，并且（至少现在）我们可以控制该服务的所有消费者，所以如果需要我可以尝试更改配置，但我更喜欢只更改Web 服务上的东西，而不是消费者。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T13:41:13.390

我可能是错的，但我认为这里的问题是序列化是如何工作的——为了反序列化一个对象，序列化程序创建一个空对象，然后设置这个对象的所有属性——这就是为什么你需要一个设置器来包含属性在序列化中。客户端代码与反序列化器具有相同的对象“接口”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T14:12:24.247

警告，我是一个 Java 人，所以我的答案的第一部分集中在 C# 中可能发生的事情。

首先，使用 Java 中的自定义序列化程序，您几乎可以做任何您想做的事情，包括使用反射直接设置受保护或私有字段的值，只要安全管理器不阻止此活动。我不知道 C# 中是否有用于安全管理器、字段访问和自定义序列化程序的类似组件，但我怀疑有。

其次，我认为在您如何看待 Web 服务和将 Web 服务接口作为应用程序的一部分方面存在根本的不同。您可以右键单击从现有代码生成 Web 服务接口 - 称为“代码优先”。有很多关于为什么首先使用 WSDL 是首选方法的文章。 [这个](http://webservices.xml.com/pub/a/ws/2003/07/22/wsdlfirst.html)一个很好地总结了一些事情，但我也建议阅读其他内容。当您考虑在 Web 服务的客户端和服务器端之间共享代码库并维护对象结构和可访问性时，一旦您将 API 作为 Web 服务发布并且无法控制所有的消费者。WSDL 和 XSD 用作 Web 服务 API 的通用描述，并且您的服务器和客户端可以使用不同的数据绑定配置、对象类或语言来实现。您应该将您的 Web 服务接口和传入和传出它的 XML 视为描述交换的语义，但不一定是数据的语法（您的类结构），一旦它在您的客户端中被内部化（反序列化）或服务器。

此外，建议将与传输相关的结构与内部业务逻辑结构分离，以免您发现自己不得不同时重构服务器实现、Web 服务 API 和（和其他人的）客户端实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T13:30:39.823

据我所知，.NET 2.0 中没有内置的方法可以做到这一点。在我想序列化只读属性的情况下，我已经实现了`IXmlSerializable`接口，以便我可以控制`ReadXml()`and`WriteXml()`方法。

在更高版本的 .NET 框架中，您可以通过在支持字段上设置属性来序列化只读属性。

# ruby-on-rails - 从 Ubuntu 上的 rails 控制器“没有要加载的文件——net/ssh”

> ID：915673
> 
> 赞同：1
> 
> 时间：2009-05-27T13:24:57.150
> 
> 标签：ruby-on-rails, ubuntu-8.04, net-ssh

我有一个非常简单的控制器：

```
require 'net/ssh'

class MyController < ApplicationController
    def foo
        render :text => 'bar'
    end
end 
```

但是当我请求[http://server:3000/my/foo](http://server:3000/my/foo)我得到：

```
MissingSourceFile in MyController#foo 
no such file to load -- net/ssh 
```

宝石已安装

```
> gem list net-ssh

*** LOCAL GEMS ***
net-ssh (2.0.11) 
```

另外，我在 IRB 中尝试了 require 'net/ssh' ，它可以工作。

MyController 在 Windows 上运行良好，但在 Ubuntu 上失败。

有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T14:27:28.507

在我正在处理的一个项目中，我们使用了 config/environment.rb 文件来保存 gem 需要的东西。所以

```
Rails::Initializer.run do |config|
  # ...
  config.gem 'net-ssh'
  config.gem 'daemons'
  config.gem 'slave'
  config.gem 'vpim'
  config.gem 'json'
  # ...
end 
```

我认为您将需要“net-ssh”而不是“net/ssh”。但是，我们确实遇到了一个问题，即 gem 名称中的连字符导致失败。然后我们不得不做

```
 config.gem 'Ruby-IRC', :lib => 'IRC' 
```

因此您可能需要该版本。所以那将是

```
 config.gem 'net-ssh', :lib => 'net/ssh' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-08-09T08:07:22.637

在 Rails 3.0 的情况下，如果可以，则此解决方案。将此添加到 yourapp/Gemfile 中，

```
gem 'net-ssh 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-07T21:49:11.097

就我而言，因为它是一个独立的 ruby​​ 应用程序，所以我只需要 ruby​​gems。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T14:06:41.637

这可能会有所帮助：

[Rails Gem 依赖项和插件错误](http://www.webficient.com/2008/07/11/ruby-on-rails-gem-dependencies-and-plugin-errors)

这也值得一看：

[Railscasts：Gem 依赖项](http://railscasts.com/episodes/110-gem-dependencies)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T18:05:14.900

您还可以使用 Dr Nic 的“gemsonrails”并将供应商的 gem 作为插件加载，检查： [http ://gemsonrails.rubyforge.org](http://gemsonrails.rubyforge.org)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T21:00:20.150

我认为，最初的问题是我使用普通用户而不是 root：

```
$ gem install net-ssh
  WARNING:  Installing to ~/.gem since /usr/lib/ruby/gems/1.8 and
            /usr/bin aren't both writable.
  WARNING:  You don't have /home/alex/.gem/ruby/1.8/bin in your PATH,
            gem executables will not run. 
```

所以，我猜，rails 找不到这个宝石。

# oop - 设计问题

> ID：915676
> 
> 赞同：1
> 
> 时间：2009-05-27T13:25:43.717
> 
> 标签：oop

最近我遇到了这个面试问题（K-Means Clustering 解决方案）。我提出的设计没有达到面试官的期望（简单地说我没有得到这份工作，因为我在这个设计问题上输给了另一个候选人）。我想知道 SO 社区可以提出多少不同/有效/简单的解决方案（通过这样做我希望磨练我的技能）：

实现一个简单的算法来根据体重和身高对人进行聚类。该数据集包括一个体重和身高的人列表，如下所示：

```
Person   Weight   Height
         (kg)     (inches)
Person 1 70        70

Person 2 75        80

Person 3 120       85 
```

您可以将数据绘制为二维数据。重量是一个维度，高度是另一个维度。重量可以从最低 50 公斤到 150 公斤不等。高度可以从最低 38 英寸到 90 英寸不等

算法：

该算法（称为 K-means 聚类）将数据聚类到 K 个组中，如下所示：

1.  从 K 个集群开始。每个集群由其中心点定义，该中心点将从随机权重和随机高度开始。从上面定义的相应范围内选择随机数。

2.  对于每个人 使用公式计算到每个聚类中心的距离 distance = sqrt(pow((wperson−wcenter), 2) + (pow(hperson−hcenter),2)) 其中 wperson = 人的体重，hperson = 人的身高wcenter = 聚类中心点的权重，hcenter = 聚类中心点的高度

3.  将人分配到距离集群中心点最近的集群

4.  在第 2 步结束后，您将得到 K 个集群，每个集群分配有一组人

5.  对于每个聚类，将中心点的体重和身高设置为聚类中人的平均值 wcenter =（聚类中每个人的体重之和）/（聚类中的人数）hcenter =（每个人的身高之和集群中的人）/集群中的人数）

6.  重复步骤 2 到 5 进行 1000 次迭代，然后打印出每个集群的以下信息。

    簇中心的重量和高度。集群中的人员列表。

我不是在寻找实现/解决方案，而是在寻找高级设计。你能列出接口/类等吗？我现在不想给出我的解决方案，但会在当天晚些时候发布？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T14:43:39.003

这是我在设计上的尝试。我只展示了静态图，因为算法已经基本布置好了。我会计划让访问者来表示集群，可以允许不同类型的输出（xml、字符串、csv..etc）。也许访问者是矫枉过正，如果是这样的话，我就会有类似 ToString 方法的东西可以被覆盖。

注意：集群在 SetCenter 和 FindNewCenter 方法上创建一个 CenterClusterItem。CenterClusterItem 不是 PersonClusterItem，它只是拥有与 PersonClusterItem 相同数量的 AClusterValues（因为平均值并不是真正的人）。

另外，我忘记在 KCluster 上创建一个方法来开始该过程，但这是隐含的。

[类图 http://img11.imageshack.us/img11/499/kcluster.png](http://img11.imageshack.us/img11/499/kcluster.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T13:35:46.210

好吧，我将首先处理所有降低算法可重用性的常量/幻数：

*   而不是固定数量的迭代，使用停止标准（例如，如果集群没有太大变化，则终止）

*   不要将自己限制在二维数据中，使用向量

*   让用户定义要找到的簇数

然后，您可以在接口后面隐藏一些细节，例如距离的计算方式可能不同（例如，它可能在某些时候必须处理双精度以外的值）。

另一方面，如果你真的遇到了这个简单的问题，那么其中一些概括可能会有点矫枉过正——但这就是我要与告诉我实现该算法的人讨论的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T13:37:48.450

您可以创建以下类：

*   存储有关人员和中心的数据的人员。属性：身份证、体重和身高。方法：计算距离
*   用于存储一个中心和人员列表的集群： 属性：中心和人员列表。方法：计算中心。
*   KCluster 保存您的算法并存储集群列表： 属性：集群列表。方法：generateClusters。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T13:36:48.297

这听起来是一个非常好的方法。K-means 通常会很快收敛（尽管不一定达到全局最优），所以我的一个建议是运行算法直到不再发生变化，而不是固定数量的 1000 次迭代。然后，您可以使用不同的随机起点重复整个过程几次。

k-means 的一个弱点是它确实需要您预先指定（即猜测）k 的适当值。我认为如果你问面试官什么是合适的 k 值，或者，如果没有办法知道，描述一些拟合优度度量，然后计算不同 k 值的度量来找到一个“足够低”的价值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T13:32:25.513

我不确定您的问题实际上是什么，您指出的步骤有效地定义了您正在谈论的算法。

一个更好的主意可能是准确地包括您所做的事情，然后人们可以给您一些提示/提示，说明您可能在哪里出错或他们会采取哪些不同的做法。

# asp.net - 如何在 ASP.Net/AJAX Web 应用程序中实现用户可配置的网页

> ID：915689
> 
> 赞同：2
> 
> 时间：2009-05-27T13:27:29.017
> 
> 标签：asp.net, asp.net-ajax, configurable

我需要一些建议来避免我重新发明轮子。

我们的 Windows 应用程序正在重新设计为 Web 应用程序 [ASP.Net/AJAX dot Net 3.5 - SQL Server 2005 DB]，我们正处于进程的开始阶段。

要求之一是客户应该对页面布局有一定的控制权。即控件的类型、控件的位置以及控件绑定到的数据等，例如能够添加文本框/下拉菜单并将其绑定到数据库中的相应字段。转换将用于合并数据和布局。

我们最初的计划是从定义屏幕、控件、布局等的 4-5 个 SQL Server 表中驱动这一点，并在运行时使用转换来构建页面，并在适当的地方进行缓存。

是否有另一种方法可以做到这一点，或者有任何人对上述方法及其优点和/或限制有经验。

在此先感谢，利亚姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T16:09:24.947

听起来像一个门户——您是否考虑过[使用 ASP.NET WebParts](http://msdn.microsoft.com/en-us/library/e0s9t4ck.aspx)？

# c# - 为什么 DateTime.Now.ToString("u") 不起作用？

> ID：915693
> 
> 赞同：12
> 
> 时间：2009-05-27T13:27:47.503
> 
> 标签：c#, .net, vb.net, datetime, utc

我目前处于[英国夏令时](http://www.timeanddate.com/library/abbreviations/timezones/eu/bst.html)，即 UTC +1 小时。我用以下代码确认我的电脑是正确的，它返回 true。

```
System.TimeZone.CurrentTimeZone.IsDaylightSavingTime(Date.Now) 
```

那么我的问题是为什么 UTC 格式化程序不能像我预期的那样工作：

```
DateTime.Now.ToString("u") 
```

它按预期以 UTC 格式返回准确的当前系统日期，但最后的 Z（[祖鲁时间](http://en.wikipedia.org/wiki/Zulu_time#Time_zones)）不是 +01:00？

IE

```
2009-05-27 14:21:22Z 
```

不是

```
2009-05-27 14:21:22+01:00 
```

这是正确的功能吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-27T13:32:55.933

MSDN 声明如下：

> 表示由 DateTimeFormatInfo.UniversalSortableDateTimePattern 属性定义的自定义日期和时间格式字符串。该模式反映了定义的标准，并且该属性是只读的。因此，无论使用的文化或提供的格式提供程序如何，它总是相同的。自定义格式字符串为“yyyy'-'MM'-'dd HH':'mm':'ss'Z'”。
> 
> 使用此标准格式说明符时，格式化或解析操作始终使用不变区域性。
> 
> **格式化不会转换日期和时间对象的时区。因此，应用程序必须在使用此格式说明符之前将日期和时间转换为协调世界时 (UTC)。**

在格式化之前，您应该使用以下代码将当前日期转换为 UTC：

```
DateTime.UtcNow.ToString("u") 
```

或者

```
DateTime.Now.ToUniversalTime().ToString("u") 
```

要以您期望的格式显示（即 2009-05-27 14:21:22+01:00），您需要使用自定义日期格式：

```
DateTime.Now.ToString("yyyy-MM-dd HH:mm:sszzz"); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-27T13:33:37.680

“u”是通用可排序日期/时间模式，不是 UTC 格式；引用[文档](http://msdn.microsoft.com/en-us/library/az4se3k1.aspx)：

> 表示由 DateTimeFormatInfo..::.UniversalSortableDateTimePattern 属性定义的自定义日期和时间格式字符串。该模式反映了定义的标准，并且该属性是只读的。因此，无论使用的文化或提供的格式提供程序如何，它总是相同的。自定义格式字符串为“yyyy'-'MM'-'dd HH':'mm':'ss'Z'”。
> 
> 使用此标准格式说明符时，格式化或解析操作始终使用不变区域性。
> 
> 格式化不会转换日期和时间对象的时区。因此，应用程序必须在使用此格式说明符之前将日期和时间转换为协调世界时 (UTC)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-27T13:39:56.013

您需要使用 DateTime.Now.ToUniversalTime().ToString("u")。

# asp.net - LinqDataSource 和 DateTime 格式

> ID：915694
> 
> 赞同：3
> 
> 时间：2009-05-27T13:27:53.493
> 
> 标签：asp.net, sql, linq, linq-to-sql

我正在尝试创建一个 LinqDataSource 以绑定到 ASP.NET 表单中的 DropDownList。我只想根据日期（这是数据库中的字段之一）显示元素。

基本上，我要展示的元素是将来会发生的元素（即在 DateTime.Now 之后）。

我正在尝试以下标记：

```
<asp:DropDownList runat="server" ID="DropDownList1" 
    AppendDataBoundItems="True" DataSourceID="LinqDataSource1"
    DataTextField="TextField" DataValueField="ValueField">
</asp:DropDownList>
<asp:LinqDataSource ID="LinqDataSource1" runat="server" 
    ContextTypeName="DataContext1" TableName="Table" 
    Where="DateField &gt;= @DateField">
    <WhereParameters>
        <asp:Parameter DefaultValue="DateTime.Now" Name="DateField" 
            Type="DateTime" />
    </WhereParameters>
</asp:LinqDataSource> 
```

当我尝试运行它时，我收到一个格式异常，说“该字符串未被识别为有效的 DateTime”。但是，我数据库中的日期似乎很好，因为 DateTime.Parse 可以完美地处理它们。DateField 是 SQL 中的 datetime 类型。

我在这里想念什么？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T02:05:18.067

这`DefaultValue`是其他人建议的代码有什么问题。

但是，设置`DefaultValue`为

```
 "<%# DateTime.Now %>" 
```

就像 Andomar 建议的那样（这将使标记看起来像这样：

```
<WhereParameters>
                <asp:Parameter DefaultValue="<%# DateTime.Now %>" Name="DateField" Type="DateTime" />
</WhereParameters> 
```

也不会起作用，因为只有具有 DataBinding 事件的对象才支持 DataBinding 表达式，而这些对象都没有`Parameter`或`ControlParameter`没有。

对于字符串，创建一个 TextBox 或 Label 并将 <%# %> 表达式放在该新字段的值中相当容易（更多详细信息[在这里](http://www.neovolve.com/post/2006/11/07/Binding-data-to-ObjectDataSource-parameters.aspx)），但是使用 DateTime 值会稍微复杂一些，因为比较带有 .NET DateTime 的 SQL DateTime 导致异常。

可以在 Page_Load 事件中很容易地使用

```
DataContext DataContext1 = new DataContext();

    var c = from a in DataContext1.Field
            where a.DateField >= DateTime.Now
            select a;
    DropDownList.DataSource = c;
    DropDownList.DataBind(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T13:29:42.477

我怀疑它在 DefaultValue 上失败了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T13:35:07.223

尝试：

```
DefaultValue="<%# DateTime.Now %>" 
```

# database - 有哪些不错的 Oracle Db 维护工具

> ID：915702
> 
> 赞同：1
> 
> 时间：2009-05-27T13:29:31.870
> 
> 标签：database, oracle

我们已经从小时候的 2-3 名开发人员迅速发展到大约 30 名开发人员。我们应该从不需要源代码控制、数据库监控或模式图。

现在我们看到越来越多的糟糕代码被转移到生产环境中。是否有现成的 Oracle 产品可以帮助管理从 Test、UAT 到 Prod 的版本控制和部署管理？

架构图、文档工具和一些性能分析功能也很不错。但主要想要一个工具来管理 oracle 脚本、DDL、DML 等的代码源控制和迁移。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-04-18T17:30:36.437

我知道我参加这个聚会*很晚*了，但是，我想提请您注意我们的产品 dbMaestro TeamWork for Oracle，它提供了这里所需的功能。我们为 Oracle 工件提供与源代码控制工具等效的功能。许多公司通过代理使用 SCM（如上面由northpole 建议的，重新使用SVN），我们的解决方案是按照Reuben 在原始帖子中的要求与数据库“联系”。要了解更多信息，请访问我们的网站[http://www .dbmaestro.com](http://www.dbmaestro.com)或发送电子邮件至 info@go-esi.com。

披露 - 我的公司在美国代表该产品。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T14:52:47.583

我强烈推荐使用 Oracle'e [SQL Developer](http://www.oracle.com/technology/software/products/sql/index.html)。这与 Subversion 集成，提供了整个数据库的概览，包括程序、模式更改等。这将使您的生活更轻松。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T13:32:44.890

您是否考虑过使用[SVN](http://tortoisesvn.tigris.org/)对脚本、DDL 等进行源代码控制和管理？我们的 ORACLE DBA 在这里使用它，他们对此发誓。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T15:06:02.970

TOAD（由 Quest Software 提供）非常棒，包括您想要的大部分内容，包括源代码控制。

# asp.net-mvc - ASP.NET MVC 授权和超链接

> ID：915706
> 
> 赞同：1
> 
> 时间：2009-05-27T13:29:41.993
> 
> 标签：asp.net-mvc, authorization

我在 ASP.NET MVC 中成功使用了自定义授权。它只涉及 User.Identity 和上下文中对象的所有者之间的比较。

在简单条件下使用时，它就像一种魅力。当我尝试在一个 Web 请求中调用 2 个操作时，它变得更加复杂。

假设我想显示一个由我的应用程序即时生成的图像。此图像由控制器生成，因此，即使它在物理上不存在，也可以通过 URL 引用。我已经决定用户必须登录并成为所有者才能查看它，所以我将我的授权机制应用于它。

示例：<img src="http://myapplication.com/images/generate/3" />

当我通过其操作超链接在页面中包含这样的图像时，我希望在生成图像时经过身份验证的用户仍将处于服务器端的上下文中。在我的测试中不是这种情况。该图像永远不会显示，因为我的授权检查不起作用。在图像控制器中，User.Identity 是空的，就好像用户没有签名一样。

与此同时，同一个用户仍然登录到该网站，并且可以继续使用他的身份在上下文中浏览……但这些图像无法正常工作。

我想知道如何使这个过程安全地工作......

非常感谢！

Marc Lacoursiere RooSoft 计算公司

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T01:02:09.240

这可能是当浏览器中的站点链接为 http:\www.mysite.com （或 http:\subdomain.mysite.com ）并且您在应用程序中使用 http:\mysite.com\image\5 时。表单身份验证使用 cookie。而这些 cookie 可能属于域和子域。
要了解发生了什么，我建议使用安装了 FireBug 的 FireFox。为您的站点启用网络和控制台选项卡并完全刷新页面。在您将在这些选项卡之一（确切地说是网络选项卡）中看到请求之后。在请求的左侧，您可以看到“加号”按钮，单击它后，您将看到 Headers 和 Response 选项卡（[对 firebug 的更详细描述](http://getfirebug.com/net.html)）。查看 Headers 选项卡并尝试找到类似 FORMAUTH 的内容（或您在配置中设置为表单 cookie 名称的内容）。如果您没有看到它 - 问题出在域中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T13:41:48.583

只是想知道你是否检查过

```
Thread.CurrentPrincipal 
```

控制器中也是空的吗？它应该包含相同的值。

另一个建议是将 User.Identity 值存储在会话中？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T13:53:26.843

您需要在每次请求时在 global.asax 中设置您的身份。我为此使用了自定义主体和身份。

```
private void Application_AuthenticateRequest(object sender, EventArgs e)
{
    if (!Request.IsAuthenticated)
    {
        SetIdentity(new MyIdentity
                   { Type = UserType.Inactive, Id = int.MinValue });
    }
    else
    {
        HttpCookie authCookie = Request.Cookies[
            FormsAuthentication.FormsCookieName];
        if (authCookie != null)
        {
            FormsAuthenticationTicket authTicket =
                   FormsAuthentication.Decrypt(authCookie.Value);

            var identity = Repository.GetIdentity
                   (authTicket.Name, new HttpRequestWrapper(Request));
            SetIdentity(identity);
        }
    }
}

private void SetIdentity(MyIdentity identity)
{
    Context.User = new MyPrincipal { Identity = identity };
    Thread.CurrentPrincipal = Context.User;
} 
```

这可行，但我不保证它是安全的。在使用此代码之前，您应该查看有关[FormsAuthentication 漏洞的这篇文章。](http://www.foundstone.com/us/resources/whitepapers/aspnetformsauthentication.pdf)您必须了解此代码假定 cookie 有效且未被劫持。可以采取一些额外的安全措施来减少此代码未显示的这些漏洞。

# c# - 如何在 Visual Studio 中为项目引用设置“特定版本”属性

> ID：915712
> 
> 赞同：7
> 
> 时间：2009-05-27T13:30:24.190
> 
> 标签：c#, visual-studio, visual-studio-2008, assemblies, workflow-foundation

我有一个包含多个项目的 Visual Studio 解决方案，并将项目之间的引用设置为项目引用。

添加对程序集的引用时，引用的属性包含一个设置

`Specific Version = True|False`

项目引用缺少此属性。怎么设置？我希望我的解决方案能够在 bin 文件夹中加载任何可用的程序集（无论是什么版本）。

当反序列化工作流实例（Workflow Foundation）并且同时更新依赖项时，我遇到了问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T14:02:09.243

我认为问题在于，您所问的问题不能直接通过项目引用实现，我认为由于链接的性质，这总是隐含地变成“显式版本”。

您**可以**这样做的方式（调用当前引用的项目 A 和引用的项目 B）：

*   在解决方案中包含要引用的项目，就像现在使用项目引用一样
*   显式设置依赖链，以便首先构建“引用”项目
*   首先手动构建一次引用的项目A
*   在项目 B 中创建对项目 A 中构建结果的程序集引用
*   将程序集引用设置为“特定版本 = false”

构建顺序（依赖）将保证 A 总是在 B 之前构建，B 会从 A 的二进制输出目录中引用它。

（虽然，它有点脆弱，我不推荐它，因为如果设置不正确，或者太阳与星星对齐错误，或者诸如此类，很容易得到错误的结果）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T13:34:57.443

我可能误解了您的问题，但是当您添加项目引用时，该项目的程序集始终会加载到在构建项目时引用它的任何项目中。因此，您将始终在该项目的 bin 文件夹中拥有最新的可用程序集。VS 在这方面对待项目的方式与其他程序集不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-09T06:34:57.277

我找到了解决我的问题的方法。[这里](http://blogs.msmvps.com/theproblemsolver/2008/09/11/versioning-long-running-workflows-part-2/)描述得非常详细。问题不是错误的项目引用问题，而是工作流实例问题的反序列化问题。

感谢所有试图提供帮助的人。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T13:53:49.840

您可以添加对项目输出 dll 而不是项目的引用。然后您将能够设置特定版本设置。

# dependency-injection - 除了 TDD 之外，松散耦合代码还有其他好处吗？

> ID：915717
> 
> 赞同：4
> 
> 时间：2009-05-27T13:32:30.927
> 
> 标签：dependency-injection, loose-coupling

当我在做 TDD 时，它迫使我采用[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)原则，我最终得到了松散耦合的代码。

有人告诉我，很难理解具有松散耦合代码的应用程序。

你能告诉我松散耦合代码的优缺点吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T13:36:57.330

最大的优点是对一个模块进行更改不会以不可预知的方式破坏其他模块。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T13:43:45.960

依赖注入不会自动导致低耦合。我同意上面关于低耦合优点的答案。依赖注入的主要好处是它提高了可测试性，并帮助您遵循程序到接口而不是实现的 GoF 原则。但是您也可以与注入的依赖项高度耦合。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-27T13:34:32.123

另一个好处是，当您拥有多个实现时，能够更轻松地替换组件。

想象一下，您有一个购物车系统，它通常存储和读取数据库，这是默认设置。但是您可以注入以便它使用后端，这不是那么好，但是当您没有数据库时它可以工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T13:36:12.527

因为它是松耦合的，所以它是高度可变的。这就是重点。如果您不需要，松散耦合可能会引入许多间接性，从而导致系统具有更多“深度”：您需要向下看一个级别才能看到发生的所有事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T13:41:27.680

就像您说的那样，松散耦合代码的缺点是增加了复杂性，并且难以理解。当代码松散耦合时，通常不会立即看出代码的作用。

就像其他人所说的那样：好处是当代码/模块/对象/组件不相互依赖时，交换其他部分要容易得多。

与所有 OO 设计一样，您必须做出权衡 - 拥有易于换入和换出的高度模块化代码对您来说更重要吗？还是拥有更简单的易于理解的代码更重要？你必须做出决定。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T13:42:32.293

可重用、可扩展性和副作用的减少。

# python - 为 MS-Office 用户报告图表和数据

> ID：915726
> 
> 赞同：2
> 
> 时间：2009-05-27T13:34:06.337
> 
> 标签：python, web-services, scripting, reporting, ms-office

我们有大量数据和一些图表代表一个逻辑项目。图表和数据存储在各种文件中。因此，大多数用户可以轻松访问和重用其应用程序中的信息。

但是，这并不是存储数据的好方法。除了其他原因，图表属于一些数据，图表和数据有一些没有反映在文件系统中的元信息，有很多文件等。

理想情况下，我们想要

1.  一个可以存储所有信息（文本、数据和图表）的大“文件”

2.  “文件”是人类可读、可移植且可供非技术用户访问的

3.  允许典型的办公应用程序（如 MS Word 或 MS Excel）轻松提取文本、数据和图表。

4.  重量轻，易于解决。快速和肮脏就足够了。用户不多。

我很高兴使用 Python 之类的脚本语言来生成“文件”、第三方工具（最好像啤酒一样免费）以及您在典型的以 Windows 为中心的办公计算机上找到的一切。

我们目前思考的一些想法：

*   使用 VB 或 pywin32 编写 MS Word 或 Excel 脚本

*   创建 html 并将其发布到 RESTful Web 服务器上

你能扩展上面的想法吗？你还有其他建议吗？我们应该考虑什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T14:15:05.147

我只能同意 Reef 关于他提出的一般概念：

*   您几乎肯定会更喜欢数据库中的数据而不是单个大文件中的数据

*   您不必担心数据不是由用户直接操作的，因为正如 Reef 所说，它只会出错。你会惊讶于它会变得多么丑陋

关于 MS Office 集成工具的使用，我不同意 Reef。您可以很容易地创建一个可从 MS Office 套件访问的 ActiveX 服务器（如果您愿意，可以使用 Python）。只要您拥有允许某种文件共享的可靠基础架构，您就可以使用该共享区域来保存您的代码。我想 Reef 所谈论的混乱主要是关于保持用户版本的提取/导入代码同步。如果您不使用某种共享存储库（一个简单的共享文件夹），或者如果您的基础设施经常出现故障，以至于共享文件夹变得不可用，您将非常痛苦。请注意，如果您没有适当的工具但要与许多用户打交道，那也会有些痛苦：最好在每台机器上注册 ActiveX 服务器。

所以.. 我刚才说 MS Office 集成是非常可行的。但它是否是最好的做法是另一回事。我坚信，如果您建立一个为他们处理数据的网站，您将为您的用户提供更好的服务。然而，这种工具几乎肯定会成为一个“正在进行的项目”。通常，即使作为“正在进行的项目”，用户节省的时间仍然值得。但有时，从战略上讲，您希望为用户提供较差的体验以控制项目成本。在这种情况下，我提到的 ActiveX Server 可能就是您想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T12:49:33.620

您应该使用数据库，而不是使用一个大文件。是的，如果您愿意，您可以在数据库中存储各种类型的文件，例如 gifs。

非技术用户无法阅读或访问该文件，但这很好。

该数据库将有一个网站，您的非技术用户将使用该网站插入、更新和获取数据。他们将能够在页面上显示它或将其导出到 csv（甚至是 xls - 这并不难，我见过一些 csv->xls 转换器）。您可以查看一些开放的标准文档格式，我认为在其中输出数据应该很容易。不要尝试以“doc”格式输出（但您可以尝试“docx”）。您应该能够轻松地教用户如何将他们的数据导出为 CSV 并将其上传到网站，或者如果他们愿意，他们可以使用 Web 界面插入数据。

如果您允许您的用户弄乱原始数据，他们就会破坏它（我已经尝试过了，您不知道那些人是怎么做到的）。防止它的唯一方法是制作一个 Web 表单，只允许他们执行您完全知道他们应该如何执行的某些操作。

数据库+网页解决方案是不错的选择。使用 VB 或 pywin32 编写 MSOffice 脚本会给您带来很多我无法想象的麻烦。

您可以使用 gnuplot 或其他一些图形库进行绘制（实现起来非常简单，它为您完成了所有艰苦的工作）。

恐怕“快速”而肮脏的解决方案很诱人，但我只能说一件事：它不会很快。几周后，您会发现使用 MSOffice 脚本进行黑客攻击是混乱、错误且不可靠的，非技术人员会讨厌它，并说在其他公司中他们曾经有一个简单的 Web 面板可以做到这一点。然后您会发现您将无法询问脚本，因为现在每个人都使用 Web 界面，因为它们很容易实现和维护。

这不是一个小项目，它是一个中等规模的项目，你需要在编写时记住这一点。这需要一些时间来完成和测试它，你将不得不添加新功能，因为非技术人员将开始使用它。我认识一些充满热情的 php 青少年，他们可以在一周内编写此面板，但据我了解，您有一些更好的资源，所以我希望您能提供一个真正可靠、模块化、可扩展的解决方案，具有良好的可用性和快乐的用户。
祝你好运！

# .net - 使用实体框架作为数据访问层

> ID：915727
> 
> 赞同：13
> 
> 时间：2009-05-27T13:34:17.100
> 
> 标签：.net, asp.net, entity-framework

在我的 ASP.NET 应用程序中，我想通过数据访问层使用实体 framweok 来实现，这样我就可以将它用作 ORM 工具。但我不希望应用程序的其余部分关心我正在使用它或被任何特定实体框架所污染。

我似乎找不到任何人专门在他们的数据访问层中使用实体框架，所以我很想看到人们有这种/经验的任何在线示例。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T13:38:31.977

[http://ayende.com/Blog/archive/2007/06/08/Rhino-Commons-RepositoryltTgt-and-Unit-Of-Work.aspx](http://ayende.com/Blog/archive/2007/06/08/Rhino-Commons-RepositoryltTgt-and-Unit-Of-Work.aspx)

看上面的例子，你可以使用存储库模式以同样的方式实现实体框架

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T13:38:33.643

您可以使用类似于 ScottGu 在 NerdDinner 系列中使用 Linq 所做的存储库模式来抽象实体框架。

[http://nerddinnerbook.s3.amazonaws.com/Part3.htm](http://nerddinnerbook.s3.amazonaws.com/Part3.htm)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-31T01:12:54.313

[http://blog.keithpatton.com/2009/05/30/Entity+Framework+POCO+Repository+Using+Visual+Studio+2010+Net+40+Beta+1.aspx](http://blog.keithpatton.com/2009/05/30/Entity+Framework+POCO+Repository+Using+Visual+Studio+2010+Net+40+Beta+1.aspx)

这是受 DDD 启发的架构，我刚刚与 EF v4 合作，它使用 Unity IoC 注入 EF 存储库，希望对您有所帮助

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-04-21T19:17:29.457

The EF or any other ORM (i.e. NHibernate) doesn't replace your Data Access Layer. Rather, the ORM is an abstraction layer from the DAL to the data source.

Don't be fooled to believe that the EF does away with the DAL. The EF is just another data source framework. However, in best practice, you still want to abstract and centralize all access (read/write) in a common DAL.

Here's a perfect example of what I'm talking. Assume that you have to delete a given user in one of your use cases. However, when deleting the user, you may want to delete other records associated to the deleted user to avoid orphan records (To be honest with you, I would use a stored proc for this). Now this use case is stuck in some BO that is very specific to this use case and deleting as user is just one part of the total use case.

At some point in time you have a developer that is asked to incorporate a different use case that happends to involve, deleting a user! The developer may do a few things. 1) He might create a new use case that now involves deleting a user but forgot to delete any associated records to that user. 2) He may have noticed the previous use case but couldn't use it directly without over generalizing it for his use case, so he decided to copy part of that use case that properly deletes a user and its associated records, into his use case. Now we have duplicates parts the code that do practically the same thing - delete a user. Yuk! Now, having put this 'deleting user' in say a DAL.Users helper class, you avoid this bad design practice.

Anyway, the one nice thing about the EF, it reduces the number of Business Entities that I used to create manually and provides a different view of the data from an application level than what is seen in the data store level.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-07-01T18:13:08.337

我在最后两个项目中使用实体框架作为数据访问。这些是大型（至少对我而言）项目，有数百张桌子，5-15 名开发人员持续一年多。

在这两个项目中，我们的服务层都有一个 WCF 接口。我们不想在 WCF 合同中使用实体框架对象。因此，我们创建了数据传输对象，并在 DTO 和实体框架对象之间进行映射。

这打破了依赖关系并使合约尽可能稳定，但会产生一些额外的工作。

正如 Kieth 提到的，根据您的时间范围，我会这样做或在下一个版本中使用 POCO 对象。

# .net - 如何使用相同的 SqlConnection 对象在多个 SqlCommands 中声明和使用 T-SQL 变量来执行多个插入？

> ID：915729
> 
> 赞同：3
> 
> 时间：2009-05-27T13:34:32.170
> 
> 标签：.net, sql-server-2005, variables, scope, sqlcommand

我想加载一个可能很长的用户名列表（从一个到数千个用户名）的记录列表。忽略名称是如何选择的，并假设它们无法从数据库中的任何现有数据中确定。这适用于 SQL Server 2005。

我特别想***避免***在 where 子句中使用**带有数千个表达式的单个 select 语句**，这会导致 SqlCommand 对象的命令文本过长（例如`...where n='bob000001' or n='bob000002' or ... or n='bob003000'`）。听起来合理吗？

我决定通过使用用户名填充一个简单的表变量来执行选择，然后在表变量和带有用户数据的表之间执行选择/连接。

所以，我需要做的第一件事是填充表变量。我这里有一些问题：

*   SQL Server 2008 之前的 T-SQL 语法对于在单个语句中将多行插入表中是冗长的，需要类似[multiple selects 和 union alls 之](https://stackoverflow.com/questions/857120/how-to-insert-multiple-rows-at-once-to-a-table-in-sql-server-2005/857160#857160)类的东西。
*   我没有使用 SS2005 的冗长语法，甚至 SQL Server 2008 中可用的简洁语法，而是完全避免冗长的命令文本，而只是在单个连接上使用多个命令。
*   在一个 SqlCommand 中声明表变量，当我尝试在后续 SqlCommand 中使用它时会产生“必须声明标量变量”错误。
*   以任何方式涉及存储过程仍可能涉及传递巨大的字符串，或者可能会阻止变量在存储过程范围之外持续存在。假设创建存储过程不是一种选择。

第三点确实是我现在要解决的问题。我已经看到人们（声称）在单个 SqlCommand 中成功声明和使用变量而没有错误的示例。使用多个 SqlCommand 实例时如何实现这一点？我读到变量将针对多个命令的单个连接持续存在。可能以某种方式涉及交易帮助？

最后，请记住，我不想使用临时表；这样做会提供一个简单的解决方案，但它也避免了我提出的关于变量和多个 SqlCommand 的问题；但是，如果您真的认为这是最好的选择，请随意说出来。

这是一个显示正在发生的事情的代码片段：

```
public static List<Student> Load( SqlConnection conn, List<StudentID> usernames )
{
    //Create table variable
    SqlCommand  command = new SqlCommand( "declare @s table (id varchar(30))", conn );
    command.ExecuteNonQuery();

    //Populate a table variable with the usernames to load
    command = new SqlCommand( "insert into @s (id) values (@p)", conn );
    command.Parameters.Add( "@p", SqlDbType.VarChar );
    int len = usernames.Count;
    for (int i = 0; i < len; i++)
    {
        command.Parameters["@p"].Value = usernames[i].ToString();
        command.ExecuteNonQuery(); //ERROR: must declare scalar variable @s
    }

    //Select all students listed in the table variable
    command = new SqlCommand( "select StudentID, FName, LName, [etc.] from Student inner join @s on StudentID = @s.id order by StudentID", conn );

    //Execute the query to get the student info from the database.
    List<Student> students = new List<Student>()
    using(SqlDataReader reader = command.ExecuteReader())
    {
        //code to load results and populate students list
    }
    return students;
} 
```

注意：我知道涉及参数的 SqlCommand 在内部调用存储过程，这通常会阻止跨多个 SqlCommands 持久化变量，但声明表变量的第一个查询不涉及参数（即不引用 command.Parameters。 AddWithValue 已生成），因此它应该在以后可能调用存储过程的命令的范围内。

编辑：要使用临时表，只需将`@`s 更改为`#`s 并将`declare @`s table" 更改为`create table #`s，这很好。人们可能还想在最后删除临时表，但这不是必需的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T14:19:52.047

使用在会话/连接期间持续存在的临时表（多次调用）。表变量仅适用于批处理，这基本上是一次调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T15:02:31.493

*冗长的命令文本*有什么问题？我在一次调用中执行了几千字节的大查询。SQL2005支持它，我认为它比一直往返更好。

为什么不创建这样的查询？

```
select StudentID, FName, LName, [etc.] from Student 
where StudentID in ('bob000001', 'bob000002', [etc.]) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T14:26:46.403

我不知道如何解决您的问题，但是我对您的问题的替代方法是使用一个接受逗号分隔的 ID 列表的存储过程，将这些 ID 插入到临时表中，然后执行“SELECT WHERE IN”，例如（从另一个博客更改）：

```
CREATE PROC dbo.SelectStudents
(
    @StudentIdList varchar(8000)
)
AS
BEGIN
    SET NOCOUNT ON

    CREATE TABLE #StudentIdList (
        StudentId int,
    )

    DECLARE @StudentId varchar(10), @Pos int

    SET @StudentIdList = LTRIM(RTRIM(@StudentIdList)) + ','
    SET @Pos = CHARINDEX(',', @StudentIdList, 1)

    IF REPLACE(@StudentIdList, ',', '') <> ''
    BEGIN
        WHILE @Pos > 0
        BEGIN
            SET @StudentId = LTRIM(RTRIM(LEFT(@StudentIdList, @Pos - 1)))
            IF @StudentId <> ''
            BEGIN
                INSERT INTO #StudentIdList (StudentId) VALUES (CAST(@StudentId AS int))
            END
            SET @StudentIdList = RIGHT(@StudentIdList, LEN(@StudentIdList) - @Pos)
            SET @Pos = CHARINDEX(',', @StudentIdList, 1)
        END
    END 

    SELECT  * 
    FROM    dbo.Students
    WHERE   StudentId IN
    (
        SELECT StudentId FROM #StudentIdList
    )
END 
```

然后，您可以使用逗号分隔的 id 列表调用此存储过程：

```
exec dbo.SelectStudents '1,2' 
```

您需要确保格式化的 id 列表不超过 8000 个字符（如果是，请多次调用数据库）但是这种方法效率更高，并且只需要一个大参数，而不是长命令文本- 大量访问数据库以插入每个 Id 将**非常**缓慢。

存在类似的方法将 Id 列表作为 Xml 传递（尽管我的偏好可能是为了简化分隔字符串）。

此外，即使出于某种原因您无法在数据库上创建存储过程，也应该可以使用上述技术。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T13:47:36.793

不确定这是否是最好的解决方案，但我相信您可以通过将多个命令包装在 BEGIN/END 块中来批处理多个命令，并使用一个调用来运行所有命令。

# c# - 如何使单个控件出现在多个选项卡控件页面中？

> ID：915734
> 
> 赞同：1
> 
> 时间：2009-05-27T13:35:22.137
> 
> 标签：c#, wpf, tabcontrol

我有一个带有 3 个选项卡的 WPF 选项卡控件。在第一页的顶部是一个带有几个按钮的滚动查看器，这些按钮组成了一个常见任务菜单（保存、加载等）。我希望这个滚动查看器出现在每个选项卡的顶部。是否可以在不简单地将代码复制并粘贴到每个选项卡的情况下做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T13:38:20.197

您可以制作一个包含按钮的 UI 和逻辑的自定义控件，然后将该控件包含在每个选项卡上。最好的方法是创建 的子类`ScrollViewer`，并在 XAML 中定义每个按钮。在每个标签页上，您都可以创建和创建新子类的实例。

这将导致每个页面上的类的不同实例，但按钮的逻辑将只存在于代码中一次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T13:43:40.827

您可以在 tabcontrol 外部和顶部实现滚动查看器和按钮。

# java - 为什么我不能从 FileWriter 获取 FileChannel？

> ID：915736
> 
> 赞同：3
> 
> 时间：2009-05-27T13:35:33.650
> 
> 标签：java, io

我在想为什么 getChannel 只在 FileOutputStream 中实现而不在 FileWriter 中实现。

有什么真正的原因吗？有没有办法以另一种方式锁定 FileWriter ？

谢谢...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T13:50:27.410

我怀疑这是一个疏忽 - 请注意，除了将 a 传递给超类构造函数之外，`FileWriter`它的子类`OutputStreamWriter`什么都不做。`FileOutputStream`

另请注意，您几乎不应该使用`FileWriter`它，因为它不允许您指定编码。相反，“手动”将 a 包裹`FileOutputStream`在一个`OutputStreamWriter`- 中，然后您还可以获得相应的通道进行锁定。

# sql-server-2005 - 如何在 SQL Server 触发器中获取更新列的列表？

> ID：915738
> 
> 赞同：8
> 
> 时间：2009-05-27T13:36:05.490
> 
> 标签：sql-server-2005, triggers

我想知道在第一次在线扫描书籍的触发器上更新操作期间更新了哪些列，看起来 COLUMNS_UPDATED 是完美的解决方案，但这个函数实际上不检查值是否已更改，它只检查在更新子句中选择了哪些列，有人有其他建议吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-01-13T06:48:14.770

我们可以使用 Update 函数来查找特定列是否已更新：

```
IF UPDATE(ColumnName) 
```

有关详细信息，请参阅此链接：http: [//msdn.microsoft.com/en-us/library/ms187326.aspx](http://msdn.microsoft.com/en-us/library/ms187326.aspx)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-27T13:39:29.617

检查值是否已更改的唯一方法是比较触发器内的 DELETED 和 INSERTED 虚拟表中的值。SQL 在更新到新值之前不会检查现有值，它会很乐意在顶部写入一个新的相同值 - 换句话说，它接受您的更新并跟踪更新而不是实际更改。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-27T13:54:38.387

正如其他人发布的那样，您需要询问 INSERTED 和 DELETED。唯一有用的建议可能是您可以使用 EXCEPT 运算符仅获取已更改值的行（并丢弃未更改的行） - 如下所示：

```
SELECT * FROM Inserted
EXCEPT
SELECT * FROM Deleted 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T13:39:00.040

我能想到的唯一方法是您可以比较 DELETED 和 INSERTED 中的值以查看哪些列已更改。

不过，这似乎不是一个特别优雅的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T13:48:17.260

我问[了同样的问题](https://stackoverflow.com/questions/651524/most-efficient-method-to-detect-column-change-in-ms-sql-server)！

之前的海报是正确的——如果不直接比较值，您无法确定数据是否实际发生了变化。但是，有多种方法可以进行此类检查，具体取决于您在触发器中尝试执行的其他操作。我的问题在有关这些不同机制及其权衡的答案中提供了一些很好的建议。

# c# - 如何通过网络服务流式传输文档？

> ID：915740
> 
> 赞同：2
> 
> 时间：2009-05-27T13:36:19.267
> 
> 标签：c#, web-services

我正在开发一个代理服务，它接受客户请求以搜索具有特定标签的图像。我在 C# 2.0 中有一个现有的 Web 服务，它提供请求的信息，并且由于业务规则，我无法将我的 2.0 Web 服务公开给新客户端，因此需要我的代理服务来调用我的 2.0 Web 服务并获取句柄/位置到图像，然后尝试将其作为 WCF 服务调用的输出进行流式传输

图像的大小可能在 1MB 到 20MB 之间。在 WCF 中流式传输这些数据的最佳方式是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T13:38:01.227

使用 MTOM 附件。比较和解释见这篇文章：http: [//msdn.microsoft.com/en-us/library/ms733742.aspx](http://msdn.microsoft.com/en-us/library/ms733742.aspx)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-27T14:18:20.913

更改您的响应类型并编写您的文件

```
Response.ContentType = "image/jpeg";

Response.WriteFile(fileNameAndPath);
Response.End(); 
```

或者，如果您将图像加载到内存中

```
Response.ContentType = "image/jpeg";

Response.OutputStream.Write(imageBytes, 0, bytesLength);
Response.End(); 
```

# c# - 关于 Enumerable.Range 与传统 for 循环的 foreach 的思考

> ID：915745
> 
> 赞同：80
> 
> 时间：2009-05-27T13:36:44.133
> 
> 标签：c#, .net, c#-3.0, for-loop

在 C# 3.0 中，我喜欢这种风格：

```
// Write the numbers 1 thru 7
foreach (int index in Enumerable.Range( 1, 7 ))
{
    Console.WriteLine(index);
} 
```

在传统`for`循环上：

```
// Write the numbers 1 thru 7
for (int index = 1; index <= 7; index++)
{
    Console.WriteLine( index );
} 
```

假设“n”很小，所以性能不是问题，有人反对新风格而不是传统风格吗？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-05-27T14:00:53.817

为此，我发现后者的“最小到最大”格式比`Range`“最小计数”样式要清晰得多。另外，我不认为从不更快、不更短、不更熟悉和不明显更清晰的规范进行这样的改变真的不是一个好习惯。

也就是说，我一般不反对这个想法。如果您向我提出看起来像这样的语法，`foreach (int x from 1 to 8)`那么我可能会同意这将是对`for`循环的改进。但是，`Enumerable.Range`相当笨拙。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2009-05-27T15:24:34.647

这只是为了好玩。（我自己只是使用标准的“ `for (int i = 1; i <= 10; i++)`”循环格式。）

```
foreach (int i in 1.To(10))
{
    Console.WriteLine(i);    // 1,2,3,4,5,6,7,8,9,10
}

// ...

public static IEnumerable<int> To(this int from, int to)
{
    if (from < to)
    {
        while (from <= to)
        {
            yield return from++;
        }
    }
    else
    {
        while (from >= to)
        {
            yield return from--;
        }
    }
} 
```

您也可以添加`Step`扩展方法：

```
foreach (int i in 5.To(-9).Step(2))
{
    Console.WriteLine(i);    // 5,3,1,-1,-3,-5,-7,-9
}

// ...

public static IEnumerable<T> Step<T>(this IEnumerable<T> source, int step)
{
    if (step == 0)
    {
        throw new ArgumentOutOfRangeException("step", "Param cannot be zero.");
    }

    return source.Where((x, i) => (i % step) == 0);
} 
```

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2016-04-13T07:27:42.810

在 C# 6.0 中使用

```
using static System.Linq.Enumerable; 
```

您可以将其简化为

```
foreach (var index in Range(1, 7))
{
    Console.WriteLine(index);
} 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-05-27T15:25:13.023

您实际上可以在 C# 中执行此操作（通过分别提供和`To`作为`Do`扩展方法）：`int``IEnumerable<T>`

```
1.To(7).Do(Console.WriteLine); 
```

SmallTalk 永远！

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2012-10-10T10:07:17.390

我有点喜欢这个主意。它非常像 Python。这是我的几行版本：

```
static class Extensions
{
    public static IEnumerable<int> To(this int from, int to, int step = 1) {
        if (step == 0)
            throw new ArgumentOutOfRangeException("step", "step cannot be zero");
        // stop if next `step` reaches or oversteps `to`, in either +/- direction
        while (!(step > 0 ^ from < to) && from != to) {
            yield return from;
            from += step;
        }
    }
} 
```

它像 Python 一样工作：

*   `0.To(4)`→`[ 0, 1, 2, 3 ]`
*   `4.To(0)`→`[ 4, 3, 2, 1 ]`
*   `4.To(4)`→`[ ]`
*   `7.To(-3, -3)`→`[ 7, 4, 1, -2 ]`

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-05-27T14:13:00.563

我认为 foreach + Enumerable.Range 不太容易出错（您的控制更少，出错的方法也更少，比如减少主体内的索引，这样循环就永远不会结束，等等）

可读性问题与 Range 函数语义有关，它可以从一种语言更改为另一种语言（例如，如果只给定一个参数，它将从 0 或 1 开始，或者包含或排除结束，或者第二个参数是计数而不是结束价值）。

关于性能，我认为编译器应该足够聪明以优化两个循环，以便它们以相似的速度执行，即使范围很大（我认为 Range 不会创建集合，但当然是迭代器）。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-05-27T13:41:07.587

对于已经解决的问题，这似乎是一种相当冗长的方法。背后有一个`Enumerable.Range`不需要的完整状态机。

传统格式是开发的基础，并且为所有人所熟悉。我真的看不出你的新风格有什么好处。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2014-05-29T15:20:55.673

我认为 Range 对于使用一些内联范围很有用：

```
var squares = Enumerable.Range(1, 7).Select(i => i * i); 
```

你可以每一个过来。需要转换为列表，但在您想要的时候保持紧凑。

```
Enumerable.Range(1, 7).ToList().ForEach(i => Console.WriteLine(i)); 
```

但除了这样的事情，我会使用传统的 for 循环。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-05-30T00:08:13.733

我想要一些其他语言的语法，如 Python、Haskell 等。

```
// Write the numbers 1 thru 7
foreach (int index in [1..7])
{
    Console.WriteLine(index);
} 
```

幸运的是，我们现在得到了 F# :)

至于 C#，我将不得不坚持使用该`Enumerable.Range`方法。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-12-21T16:29:32.773

@Luke：我重新实现了您的`To()`扩展方法并使用该`Enumerable.Range()`方法来完成它。这样，它会变得更短一些，并尽可能多地使用 .NET 提供给我们的基础设施：

```
public static IEnumerable<int> To(this int from, int to)
{ 
    return from < to 
            ? Enumerable.Range(from, to - from + 1) 
            : Enumerable.Range(to, from - to + 1).Reverse();
} 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2019-09-03T17:39:49.450

# 今天如何使用新语法

由于这个问题，我尝试了一些东西来提出一个很好的语法，而无需等待一流的语言支持。这是我所拥有的：

```
using static Enumerizer;

// prints: 0 1 2 3 4 5 6 7 8 9
foreach (int i in 0 <= i < 10)
    Console.Write(i + " "); 
```

`<=`不是和的区别`<`。

我还在[GitHub 上创建了一个概念验证存储库，](https://github.com/BrunoZell/Enumerizer) **具有更多功能**（反向迭代、自定义步长）。

上述循环的最小且非常有限的实现看起来像这样：

```
public readonly struct Enumerizer
{
    public static readonly Enumerizer i = default;

    public Enumerizer(int start) =>
        Start = start;

    public readonly int Start;

    public static Enumerizer operator <(int start, Enumerizer _) =>
        new Enumerizer(start);

    public static Enumerizer operator >(int _, Enumerizer __) =>
        throw new NotImplementedException();

    public static IEnumerable<int> operator <=(Enumerizer start, int end)
    {
        for (int i = start.Start; i < end; i++)
            yield return i;
    }

    public static IEnumerable<int> operator >=(Enumerizer _, int __) =>
        throw new NotImplementedException();
} 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2012-03-19T10:30:01.193

在我看来，这种`Enumerable.Range()`方式更具声明性。对人们来说是新的和不熟悉的？当然。但我认为这种声明性方法与大多数其他与 LINQ 相关的语言功能具有相同的好处。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-05-27T13:39:57.667

我相信每个人都有自己的个人喜好（许多人更喜欢后者，因为它比几乎所有编程语言都熟悉），但我和你一样，开始越来越喜欢 foreach，尤其是现在你可以定义一个范围.

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-05-27T14:08:56.470

我同意在许多（甚至大多数情况下）在简单地迭代集合时`foreach`比标准循环更具可读性。`for`但是，您对使用的选择并不是over for`Enumerable.Range(index, count)`价值的一个强有力的例子。`foreach`

对于从`1, Enumerable.Range(index, count)`看起来很可读的简单范围。但是，如果范围以不同的索引开头，则它的可读性会降低，因为您必须正确执行`index + count - 1`以确定最后一个元素是什么。比如……</p>

```
// Write the numbers 2 thru 8
foreach (var index in Enumerable.Range( 2, 7 ))
{
    Console.WriteLine(index);
} 
```

在这种情况下，我更喜欢第二个例子。

```
// Write the numbers 2 thru 8
for (int index = 2; index <= 8; index++)
{
    Console.WriteLine(index);
} 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-05-27T13:56:20.223

`Enumerable.Range(index, count)`我想在处理参数表达式时可能会有更清晰的场景，特别是如果该表达式中的某些值在循环内被更改。在表达式的情况下，`for`将根据当前迭代后的状态进行评估，而预先评估`Enumerable.Range()`。

除此之外，我同意坚持`for`通常会更好（对更多人来说更熟悉/可读......可读性是需要维护的代码中的一个非常重要的值）。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-05-27T14:28:22.187

我确实喜欢`foreach`+`Enumerable.Range`方法并且有时会使用它。

```
// does anyone object to the new style over the traditional style?
foreach (var index in Enumerable.Range(1, 7)) 
```

我反对`var`你提案中的滥用行为。我很感激`var`，但是，该死的，就`int`在这种情况下写吧！;-)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-05-27T16:26:01.513

严格来说，你滥用了枚举。

Enumerator 提供了逐一访问容器中所有对象的方法，但它不保证顺序。

可以使用枚举来查找数组中的最大数。如果您使用它来查找第一个非零元素，那么您将依赖于您不应该知道的实现细节。在您的示例中，订单似乎对您很重要。

**编辑**：我错了。正如 Luke 指出的（见评论），在 C# 中枚举数组时依赖顺序是安全的。这与例如在 Javascript 中使用“for in”枚举数组不同。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-01-10T05:24:30.547

只是把我的帽子扔进戒指。

我定义这个...

```
namespace CustomRanges {

    public record IntRange(int From, int Thru, int step = 1) : IEnumerable<int> {

        public IEnumerator<int> GetEnumerator() {
            for (var i = From; i <= Thru; i += step)
                yield return i;
        }

        IEnumerator IEnumerable.GetEnumerator()
            => GetEnumerator();
    };

    public static class Definitions {

        public static IntRange FromTo(int from, int to, int step = 1)
            => new IntRange(from, to - 1, step);

        public static IntRange FromThru(int from, int thru, int step = 1)
            => new IntRange(from, thru, step);

        public static IntRange CountFrom(int from, int count)
            => new IntRange(from, from + count - 1);

        public static IntRange Count(int count)
            => new IntRange(0, count);

        // Add more to suit your needs. For instance, you could add in reversing ranges, etc.
    }
} 
```

然后在我想使用它的任何地方，我将它添加到文件的顶部......

```
using static CustomRanges.Definitions; 
```

并像这样使用它...

```
foreach(var index in FromTo(1, 4))
    Debug.WriteLine(index);
// Prints 1, 2, 3

foreach(var index in FromThru(1, 4))
    Debug.WriteLine(index);
// Prints 1, 2, 3, 4

foreach(var index in FromThru(2, 10, 2))
    Debug.WriteLine(index);
// Prints 2, 4, 6, 8, 10

foreach(var index in CountFrom(7, 4))
    Debug.WriteLine(index);
// Prints 7, 8, 9, 10

foreach(var index in Count(5))
    Debug.WriteLine(index);
// Prints 0, 1, 2, 3, 4

foreach(var _ in Count(4))
    Debug.WriteLine("A");
// Prints A, A, A, A 
```

这种方法的好处在于名称，您可以确切地知道是否包含结尾。

# c# - Web 服务器上的 WAV / MP3 转换

> ID：915750
> 
> 赞同：2
> 
> 时间：2009-05-27T13:37:28.373
> 
> 标签：c#, asp.net, mp3, wav, file-conversion

我正在寻找在我的共享托管服务器（ASP.NET / C#）上将上传的 WAV 文件转换为 MP3，并且很好奇之前是否有其他人解决过这个问题。

我见过一些用于执行音频转换的开源 C# 库（例如 AumpLib），但在大多数情况下，看起来人们在桌面应用程序上使用它们。

对于这种情况，是否有任何好的开源 C# 库/技术？任何反馈或建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T13:39:42.643

你试过跛脚吗？[http://lame.sourceforge.net/index.php](http://lame.sourceforge.net/index.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T13:40:47.557

[BASS 库](http://www.un4seen.com)可以对 MP3 进行编码。它不是开源的，但它会很好地完成这项工作。还有一个 .NET 包装器可用。

# c# - 解封类会导致运行时或编译时中断吗？

> ID：915761
> 
> 赞同：1
> 
> 时间：2009-05-27T13:39:15.657
> 
> 标签：c#, .net

我正在从事一个涉及许多不可变类的项目。我们有兴趣将这些类标记为密封，但担心如果我们决定在以后“解封”一个类，它将导致我们 API 的客户出现运行时或编译时错误。这个问题有什么好处，还是解封一个类不会导致运行时/编译时问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T13:43:16.413

解封一个类不会导致任何额外的编译时错误。解封一个类以允许以前无法编译的代码编译是可能的，但反之则不行。

可能会导致许多运行时问题，但我认为它们非常罕见，因为它需要消费者检查类型元数据。例如，如果类型未密封，用户可能会抛出，但我不确定这是一个主要问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T13:46:01.010

在框架的更新版本中从您的类中删除sealed 属性只会允许它们从您的类派生，而他们以前不能这样做。只要您的更新版本不要求您的客户从您的类派生，我想不出任何问题。

解封类的另一个影响是运行时将无法优化掉一些虚函数调用，但这也不会导致任何问题。

# wpf - 如何将多个 XAML 样式应用于一个元素？

> ID：915767
> 
> 赞同：6
> 
> 时间：2009-05-27T13:40:00.350
> 
> 标签：wpf, xaml, styles

我有一个工具包：DataGrid（来自 Codeplex）。

它开始有许多不同的风格：

*   一种用于根据 ViewModel 中的变量打开和关闭它
*   一种用于视觉造型
*   一个用于其他一些触发器等。

所有这些都需要采用**一种大风格**吗，这是唯一的方法吗？或者我可以有**多种样式**并根据需要附加它们吗？有没有办法做到这一点，以便您可以**在代码中交换样式**？

**款式：**

```
<Style x:Key="CodePlexDataGridSwapper" TargetType="toolkit:DataGrid">
    <Style.Triggers>
        <DataTrigger Binding="{Binding WhichGrid}" Value="Infragistics">
            <Setter Property="toolkit:DataGrid.Visibility" Value="Collapsed"/>
        </DataTrigger>
    </Style.Triggers>
</Style>

<Style x:Key="ToolkitDataGridLayout" TargetType="toolkit:DataGrid">
    <Setter Property="Background" Value="Yellow"/>
</Style> 
```

***伪代码：***

```
<toolkit:DataGrid 
    Style="{StaticResource CodePlexDataGridSwapper, ToolkitDataGridLayout}" 
    ItemsSource="{Binding Customers}"/> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-27T17:45:37.717

您可能想查看 Style 类的[BasedOn 属性](http://msdn.microsoft.com/en-us/library/system.windows.style.basedon.aspx)。基本上，它允许您从另一种风格继承一种风格。'child' 样式将拥有来自父级的所有设置器和触发器（除非它的设置器覆盖父级的设置器），而且它显然有自己的设置器和触发器。

也许这些信息会对您有所帮助。

# c# - IE 信息栏，下载文件...我如何为此编码？

> ID：915768
> 
> 赞同：0
> 
> 时间：2009-05-27T13:40:29.117
> 
> 标签：c#, asp.net, internet-explorer

我有一个网页（asp.net），它编译一个包，然后通过javascript（window.location = ....）将用户重定向到下载文件。这伴随着页面上的硬链接，以防重定向不起作用 - 模拟许多流行网站上的下载过程。当 IE 信息栏由于安全设置受限而出现在顶部，并且用户点击它下载文件时，它会将用户重定向到页面，而不是下载文件，这会刷新页面并删除硬链接。

信息栏在这里做什么？它不应该将用户发送到重定向的位置吗？我是在下载响应的标题中设置了错误，还是在发送文件时做错了什么？

C#代码：

```
m_context.Response.Buffer = false;
m_context.Response.ContentType = "application/zip";
m_context.Response.AddHeader("Content-Length", fs.Length.ToString());
m_context.Response.AddHeader("Content-Disposition", string.Format("attachment; filename={0}_{1}.zip", downloadPrefix, DateTime.Now.ToString("yyyy-MM-dd_HH-mm")));
//send the file 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-10-07T16:11:28.230

当用户同意使用 IE 信息栏下载文件时，IE 会重新加载当前页面，而不是用户尝试下载文件的页面。不同的是，一旦页面重新加载，IE 将允许下载脚本通过而不提示用户。从设计的角度来看，我不确定对此的想法是什么，但这就是它的工作方式。

# asp.net - 网址重写与路由

> ID：915771
> 
> 赞同：8
> 
> 时间：2009-05-27T13:41:11.347
> 
> 标签：asp.net, url-rewriting, url-routing

我正在制作一个新的 asp.net 网页表单网站，并想美化我的网址 - 我想接受一个像“www.mysite.com/1-2,3”这样的网址，然后把它变成这样的“ www.mysite.com/page.aspx?a=1&b=2&c=3"。**就性能**和**易于维护**而言，哪个选项最适合此任务 - IIS7 Url Rewriting 或 Routing 。顺便说一句，我打算使用中等信任的共享主机 IIS7，也许是 6。

过去我使用 PHP 的 mod_rewrite，对此我很满意，但现在整个网站都被翻译成 ASP.NET，我不知道该选择哪个选项。

PS - 我已经读过[这个](http://learn.iis.net/page.aspx/496/iis-url-rewriting-and-aspnet-routing/)和[这个](https://stackoverflow.com/questions/90112/iis-url-rewriting-vs-url-routing)，但是对我的问题还不够清楚。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T23:10:20.700

我会为使用路由提出强有力的论据。它将请求资源解析逻辑保留在您的应用程序中，因此在您需要时添加与应用程序相关的逻辑非常容易，并且无需在应用程序和单独的配置资源之间保持同步。

路由[适用于传统的网络表单](http://msdn.microsoft.com/en-us/library/cc668202.aspx)。

URL 重写通常（尽管不总是）是对问题的补偿，而不是解决方案——服务器软件和框架仍然围绕旧的网页概念构建*，*代表物理资源。但是，Web*应用程序*应该[以命令的形式响应请求](http://en.wikipedia.org/wiki/Representational_State_Transfer)；但只是相对较新的现代 Web 框架才开始原生支持该模型。路由是这些发展之一。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T23:49:13.570

**我强烈建议使用 routing**，实际上它会在下一个版本的框架中与 webforms 更加集成。由于缺乏路由，URL 重写更像是一种“hack”。如果您已经有一个想要“大放异彩”的项目，那么 url 重写就可以了。

但是当从头开始时，我肯定会使用路由。

路由隐藏了您的应用程序结构，让您更多地考虑您的 url，作为您想要显示的内容的路径，而不是带有参数的某些页面的路径。而且在更改内容时您不必跟踪两件事，就像重写一样。

更多在[这篇文章](http://mostlylucid.net/archive/2009/01/25/asp.net-4.0-webform-routing-quick-rsquon-dirty-version.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T14:11:16.310

IIS 5/6 使用 ISAPI 过滤，它基本上相当于 IIS 的 mod_rewrite。听说IIS7的url重写比ISAPI更容易管理和配置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T23:04:39.260

这取决于您使用的是经典的 ASP.Net 还是新的 MVC 框架。我对 MVC 框架没有任何经验，但听起来它支持你正在寻找的开箱即用的东西。

在经典的 ASP.Net 方面，我们目前正在使用一个名为[ISAPI_Rewrite](http://www.isapirewrite.com/)的 IIS 扩展。它的行为类似于 Apache 的 mod_Rewrite，并且它们有一个免费版本，您可以使用它具有付费版本的大部分功能（100 美元）。

# c# - 将验证从免费的 pdf asp.net mvc nerdinner (c#) 转换为 vb.net

> ID：915774
> 
> 赞同：0
> 
> 时间：2009-05-27T13:41:34.480
> 
> 标签：c#, asp.net-mvc, vb.net

由于 vb 没有**yield**关键字，您如何将此代码转换为 vb.net

谢谢

```
public IEnumerable<RuleViolation> GetRuleViolations() {
    if (String.IsNullOrEmpty(Title))
        yield return new RuleViolation("Title required", "Title");
    if (String.IsNullOrEmpty(Description))
        yield return new RuleViolation("Description required","Description");
    if (String.IsNullOrEmpty(HostedBy))
        yield return new RuleViolation("HostedBy required", "HostedBy");
    if (String.IsNullOrEmpty(Address))
        yield return new RuleViolation("Address required", "Address");
    if (String.IsNullOrEmpty(Country))
        yield return new RuleViolation("Country required", "Country");
    if (String.IsNullOrEmpty(ContactPhone))
        yield return new RuleViolation("Phone# required", "ContactPhone");
    if (!PhoneValidator.IsValidNumber(ContactPhone, Country))
        yield return new RuleViolation("Phone# does not match country", "ContactPhone");
    yield break;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T13:45:10.403

创建一个 List<RuleViolation> 而不是执行“yield return”，只需将这些规则添加到列表中。然后只需简单地返回列表。

# qt - 打印 pageRect 和 paperRect 问题

> ID：915775
> 
> 赞同：1
> 
> 时间：2009-05-27T13:41:45.090
> 
> 标签：qt, printing, qprinter

我有以下打印代码：

```
void Print(QPrinter *printer)
{
    QPainter q(printer);
    q.setRenderHint(QPainter::HighQualityAntialiasing, true);

    q.setPen(QPen(QColor("red")));
    q.drawRect(printer->pageRect());
    q.drawLine(printer->pageRect().topRight(), printer->pageRect().bottomLeft());

    q.setPen(QPen(QColor("blue")));
    q.drawRect(printer->paperRect());
    q.drawLine(printer->paperRect().topRight(), printer->paperRect().bottomLeft());
} 
```

结果与 QPrintPreviewDialog、渲染 PDF、输出到打印机（HP LaserJet、PdfFactory、PdfCreator）不同。大多数时候，生成的矩形没有纸。怎么做才能使输出与所有打印机相似？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-06-08T18:39:01.083

前段时间确实有人问过这个问题，但是我从上面获取了代码，我花了几个小时才弄清楚它有什么问题。首先，查看 Qt 源代码，我找不到任何假设 5% 保证金的地方。Qt 从 Windows XP 正确读取页边距，您可以完全信任页边距（Qt 4.5.3 with Windows XP）。

上面的代码包含两个问题：要打印 paperrect，必须设置 fullPage 选项。然后 paperRect 至少正确打印在预览上。当然不是在真正的打印机上，因为它在 pageRect 之外。通常，打印 paperRect 是没有意义的，因为如果打印正确，它就会正好位于纸张边框上。

第二个主要问题源于在没有更正原点的情况下打印 pageRect。如果 fullPage 被禁用（默认），则 pageRect 原点位于 paperRect 原点，因此包括边距。但是打印从 QPoint(leftMargin,topMargin) 开始，所以边距被添加了两次。

要解决此问题，需要调用 pageRect.moveTo(0,0)，然后 pageRect 会在它所属的位置很好地打印。

不同的打印机显示不同的结果来自不同的设备边距。只有具有 0 边距的设备才能使用原始代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-09T13:00:43.940

我查看的 Qt 代码假定 5% 的纸张作为它的边距。没有人相信正确的纸张页边距。

# c# - Silverlight 3/Prism - 将枚举值作为命令参数传递

> ID：915776
> 
> 赞同：5
> 
> 时间：2009-05-27T13:41:45.777
> 
> 标签：c#, silverlight, xaml, enums, prism

我正在尝试使用 Prism 和 MVVM 模式来开发应用程序。在我的 UI 中，我定义了上一个和下一个按钮。为了在调用 Web 服务中使用，我定义了一个枚举，它将告诉我需要遍历的方向。因此，在这种情况下，按钮直接映射到枚举值。枚举定义很简单，如下：

```
namespace CodeExpert.Book.Helpers
{
    public enum BookDirection { Previous = -1, NotSet = 0, Next = 1, }
} 
```

我已经在我的 ViewModel 中定义了我的命令和委托，并正确分配了属性。相关代码为：

```
public DelegateCommand PreviousNextCommand { get; set; }

public IndexEntriesViewModel(GlobalVariables globalVariable, IndexEntryOperations currentOperator)
{
    //a bunch of initialization code.
    InitializeCommands();
}

void InitializeCommands()
{
    PreviousNextCommand =
        new DelegateCommand(OnPreviousNextCommandExecute);
}

private void OnPreviousNextCommandExecute(BookDirection parameter)
{

    //Code to process based on BookDirection
} 
```

因此，基于此配置，我想将 BookDirection 枚举值传递给 CommandParameter。但是，我无法为此获得正确的 XAML。这是我尝试过的对我来说最正确的 XAML：

```
<UserControl xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                 mc:Ignorable="d"
                 x:Class="CodeExpert.Book.Views.Index"
                 d:DesignWidth="1024"
                 d:DesignHeight="768"
                 xmlns:helpers="clr-namespace:CodeExpert.Book.Helpers"
                 xmlns:command="clr-namespace:Microsoft.Practices.Composite.Presentation.Commands;assembly=Microsoft.Practices.Composite.Presentation"
                 xmlns:common="clr-namespace:System.Windows;assembly=System.Windows.Controls"
                 xmlns:controls="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls"
                 xmlns:vsm="clr-namespace:System.Windows;assembly=System.Windows"
                 xmlns:input="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Input">

    <Button x:Name="ButtonPrevious"
              HorizontalAlignment="Left"
              Margin="2,1,0,1"
              Width="25"
              Content="<"
              Grid.Column="1"
              Grid.Row="1"
              Height="20"
              command:Click.Command="{Binding Path=CurrentIndexViewModel.PreviousNextCommand}">
        <command:Click.CommandParameter>
            <helpers:BookDirection.Previous />
        </command:Click.CommandParameter>
    </Button>

</UserControl> 
```

我对枚举的 BookDirection 没有智能感知，并且在设计和编译时出现错误，说“BookDirection”类型不包含“Previous”的定义。有没有办法通过那个枚举，或者我只是错过了什么？我现在通过将参数类型设置为`string`而不是 来让它工作`BookDirection`，但是我必须解析文本和代码气味。我已经做了一些谷歌搜索，我得到的最接近的答案是在这里 -[从 XAML 传递一个枚举值作为命令参数](https://stackoverflow.com/questions/359699/passing-an-enum-value-as-command-parameter-from-xaml)不幸的是，Silverlight 不支持 x:static 绑定扩展，所以我不能使用该答案中描述的确切技术。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-02-29T14:52:18.307

只需像简单对象类型一样传递命令参数。然后你可以使用直接转换到你的枚举。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-13T05:36:56.593

首先，我不确定您是否可以直接从 Silverlight 中的 XAML 传递枚举。无论如何，这是 Prism 的一个小问题。看到命令在 CommandParameter 之前被设置，当命令在内部设置时会发生什么 Prism 调用 UpdateEnabledState()，它在你的 DelegateCommand 内部调用 CanExecute(object parameter) 并传递 CommandParameter（记住尚未设置）

这是Prism中**DelegateCommand.cs**的基本代码

```
 bool ICommand.CanExecute(object parameter)
    {
        return CanExecute((T)parameter);
    } 
```

由于此时参数为“null”，因此强制转换抛出异常。这是我解决这个问题的方法。

你的枚举。

```
namespace CodeExpert.Book.Helpers
{
    public enum BookDirection { Previous = -1, NotSet = 0, Next = 1, }
} 
```

这是我的委托声明，注意使用 object.. 而不是 Enum 本身。我还公开了 ViewModel 的属性，这将公开 2 个不同的方向。

```
public DelegateCommand<object> PreviousNextCommand { get; set; }

public BookDirection Previous { get { return BookDirection.Previous; }}
public BookDirection Next { get { return BookDirection.Next; }} 
```

现在在您的 OnPreviousNextCommandExecute 确保您收到一个对象并将其转换回正确的枚举

```
private void OnPreviousNextCommandExecute(object parameter)
{

    BookDirection direction = (BookDirection)parameter;

    //Code to process based on BookDirection
} 
```

并在 XAML 中直接绑定到公开的 BookDirection 属性。

```
<Button Content="Next"  Commands:Click.Command="{Binding PreviousNextCommand}" Commands:Click.CommandParameter="{Binding Next}" />
<Button Content="Previous" Commands:Click.Command="{Binding PreviousNextCommand}" Commands:Click.CommandParameter="{Binding Previous}" /> 
```

我不确定您的绑定情况，因为在我的情况下，我将 DataContext 直接设置为 ViewModel。但这应该对你有用。

对不起我糟糕的英语和口才，希望这能让你走上正轨。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-20T04:11:03.017

绑定枚举确实是一个麻烦的操作，即使在 WPF 中也是如此。但似乎有一个优雅的解决方案，可以在[`Caliburn`](http://caliburn.codeplex.com)框架中使用。

但是，该解决方案在框架代码中不可用，而是在`LOB Samples`. 查找项目中的`BindableEnum`和`BindableEnumCollection<T>`类`Caliburn.Silverlight.ApplicationFramework`。

HTH。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T20:41:51.780

我自己没有尝试过，但你可能会成功使用 ValueConverter 从字符串之类的东西到你的枚举。这就是我在 Silverlight xaml 中四处寻找枚举时得到的印象。

# c++ - 轻量级 C++ 脚本库

> ID：915778
> 
> 赞同：3
> 
> 时间：2009-05-27T13:41:51.877
> 
> 标签：c++, qt, scripting

我目前在我的 C++ 应用程序中使用[QtScript](http://doc.trolltech.com/4.5/qtscript.html)来编写脚本功能，但它在 cpu 上相当“重”。当一个线程在一个循环中评估所有脚本时，cpu 使用率增加到 90%-100%。即使我每 5 个脚本让它休眠 1 毫秒，它的 CPU 使用率也保持在 75% 以上。

是否有任何其他易于实现的脚本框架比 QScript 更轻量级？

**编辑：**

我现在意识到这是正常行为，而不是 QtScript 中的一些占用错误。听听有哪些类型的（轻量级）脚本库可用仍然很有趣。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-27T13:48:50.207

看看[Lua](http://www.lua.org/about.html)，它在游戏中经常使用，所以性能一定不错。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-27T14:56:14.080

好吧，你期待什么？除非脚本必须等待磁盘或用户 I/O，否则 CPU**应该**以 100% 运行。

您的问题是运行时间过长吗？

或者您的应用程序没有响应？

在这种情况下，问题在于您的脚本阻塞了运行所有 UI 交互的线程。一般的解决方案是阻止所有 UI 输入（“取消脚本”按钮 :) 除外），并将实际处理移至单独的线程。

**[编辑]**
稍有不同的问题：CPU 是否处于 100% 而没有要处理的脚本？

如果你正在处理某些东西，100% 的 CPU 是好的和健康的。

CPU 总是很忙，当前线程总是消耗 100% 的内核。“0% CPU 活动”实际上意味着所有周期都花在系统空闲线程中（属于您在任务管理器中看到的“系统空闲进程”）。

举个简单的例子：如果您有一个应用程序线程处于活动状态，并且 CPU 使用率为 40%，并且您的任务管理器更新间隔为 1 秒，那么在应用程序上花费了 400 毫秒的 CPU 时间，在空闲线程上花费了 600 毫秒。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-27T14:45:08.457

Lua 很好，因为它使用堆栈在解释器和 C++ 之间进行通信。这很好，因为它不涉及任何对您可见的引用计数，从而简化了事情。

这里有一个有趣的比较，作为一些 iolanguage 的背景：[iolanguage](http://www.iolanguage.com/about/faq/)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T16:40:38.973

我听说过有关[TinyScheme](http://tinyscheme.sourceforge.net/home.html)的好消息。话虽如此，我们在这里使用 Lua（在游戏开发工作室，针对嵌入式和手持系统）。

不过需要注意的是——特别是 Lua，但我认为这些适用于其中许多语言：

*   自定义的轻量级小对象分配器可以获得很多性能；许多这些语言都是重分配的。使用池化或基于帧的分配器可能值得您花时间，这取决于您可以摆脱什么。
*   根据所使用的 GC 策略（因为这些语言中的大多数都是垃圾收集的），您将希望保持 GC 扫描区域较小——例如总体上较小的 lua 堆大小。花一些时间重新组织数据以使其超出 GC 的域（例如，将其保留在 C++ 端，以某种方式对其进行标记以便 GC 知道避免它等）会有所帮助。
*   同样，增量垃圾收集可能是一个巨大的胜利。我建议尝试一下——在某些情况下（小堆），我发现完全 GC 比增量 GC 更快。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-27T19:19:28.463

我个人会推荐 Lua 在我们的嵌入式平台中广泛使用它。如果你在 Windows 上运行，你也许可以使用 LuaJIT 之类的东西来让你的 Lua 更快

但是，由于没有人提到它，您可能还想看看 Squirrel ( [http://squirrel-lang.org/](http://squirrel-lang.org/) )。我没有任何经验，但我认为它看起来很有希望。

至于您当前的问题，如果没有任何会阻止它的代码，任何代码都将占用 100% 的 CPU。

类似（伪代码）：

for(i=1,10000000000000) n=n+i 结束

将占用 100% 的 CPU 直到它以（几乎）任何语言完成，因为没有什么可以阻止它执行。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-27T19:57:45.157

这实际上取决于几个因素：

*   脚本会在您的应用程序中大量使用吗？
*   脚本会很复杂吗？
*   您是否向脚本引擎公开了很多功能？
*   您是否关心与 Qt 的良好集成？

我也推荐 Lua，但是，你应该记住以下几点：Lua 是用纯 ANSI C 实现的。这使得它具有超级便携性，但是如果你在 C++ 环境中开发，它会导致很多“包装” “课。尤其是当您想公开 Qt 功能（包括所有的`SIGNAL`s、`SLOT`s 和`PROPERTY`s）时，会导致大量重复代码。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-27T21:03:46.397

[Lua](http://www.lua.org)是您[选择的语言](http://www.lua.org/about.html)。Qt有一些[绑定](http://code.google.com/p/lqt/)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-29T08:29:13.833

您还可以使用[蜘蛛猴嵌入](http://www.mozilla.org/js/spidermonkey/)javascript 我认为 javascript 比 lua 更广泛。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-01-21T10:52:40.397

到目前为止，我所知道的 QtScript 没有任何问题（仅从 4.6 开始使用它，所以对它来说还是新的，但到目前为止很喜欢它）。取决于你如何使用它，就像lua或python一样。如果您尽可能多地保留应用程序的核心功能（从 c/c++ 编译）并且只向脚本引擎公开一个最小的 API，那么一般来说，您可以保持快速。

使用 QtScript，以合理的线程安全方式（QT 的槽和信号对象模型）公开对象及其方法相对容易，并且可以轻松地将脚本创建的对象传递给本机函数......但您最终可以与 QT 紧密集成环境（有时可能正是您想要的）。

If you want to arbitrarily expose native c++ objects to other embedded scripting environments checkout [**SWIG**](http://www.swig.org). SWIG is similar to the toLua tool, but works for many embeddable languages like **lua, c#, tcl, java** and **python** to name a few. From experience, toLua made binding objects and methods to scripts a much less painful process, and I haven't heard many bad things about SWIG either.

# encryption - 如何使用 BlackBerry 的初始化向量参数编写 AES/CBC/PKCS5Padding 加密和解密

> ID：915786
> 
> 赞同：2
> 
> 时间：2009-05-27T13:44:03.383
> 
> 标签：encryption, blackberry, aes

如何使用初始化参数加密和解密为 AES/CBC 编写 BlackBerry 程序，并且这种加密和解密应该独立于编程语言 Ex= 如果我使用 BlackBery 加密某些数据，我必须能够使用 Java 程序解密相同的数据。

谢谢迪帕克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T13:49:12.453

您的问题的解密部分在这里得到解答：[使用黑莓使用 AES/CBC/PKCS5Padding 解密数据](https://stackoverflow.com/questions/901251/decrypting-data-with-aes-cbc-pkcs5padding-using-blackberry)

应该很容易找出使用相同模式的加密（使用 Encryptor 而不是 Decryptor 引擎等）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-09T02:47:28.890

你读过这篇知识库文章吗？[http://www.blackberry.com/knowledgecenterpublic/livelink.exe/fetch/2000/348583/800332/800779/How_to_-_Use_Basic_Encryption.html?nodeid=800640&vernum=0](http://www.blackberry.com/knowledgecenterpublic/livelink.exe/fetch/2000/348583/800332/800779/How_to_-_Use_Basic_Encryption.html?nodeid=800640&vernum=0)

您还需要在 AESEncryptorEngine 之上使用 net.rim.device.api.crypto.CBCEncryptorEngine（以及类似的解密）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-14T06:28:01.180

CBCEngine 允许您跨平台最多 16 个字节。所以不要使用CBC。尝试使用默认支持的密码引擎。

如果您使用，我认为欧洲央行会很棒。

谢谢 Sunil Kumar sahoo

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-24T08:08:57.690

实际上，你自己编写AES算法和CBC模式的代码，很简单，大约几百行代码。并且，应该有Java语言的参考实现。

# java - 使用 JNI 从 Java 代码中检索字符串值的内存泄漏

> ID：915790
> 
> 赞同：20
> 
> 时间：2009-05-27T13:44:44.613
> 
> 标签：java, c, string, memory-leaks, java-native-interface

我正在使用 GetStringUTFChars 使用 JNI 从 java 代码中检索字符串的值，并使用 ReleaseStringUTFChars 释放字符串。当代码在 JRE 1.4 上运行时，没有内存泄漏，但如果相同的代码在 JRE 1.5 或更高版本上运行，则内存会增加。这是代码的一部分

```
msg_id=(*env)->GetStringUTFChars(env, msgid,NULL); 
opcdata_set_str(opc_msg_id, OPCDATA_MSGID, msg_id);
(*env)->ReleaseStringUTFChars(env, msgid,msg_id); 
```

我无法理解泄漏的原因。有人可以帮忙吗？

* * *

这是因为如果我注释其余代码但留下这部分，则会发生内存泄漏。这是我正在使用的代码的一部分

```
JNIEXPORT jobjectArray JNICALL Java_msiAPI_msiAPI_msgtoescalate( JNIEnv *env,
                                                                 jobject job,
                                                                 jstring msgid,
                                                                 jlong msgseverity,
                                                                 jstring msgprefixtext,
                                                                 jint flag )
{
  opcdata       opc_msg_id;   /* data struct to store a mesg ID        */

  const  char            *msg_id;
  int           ret, ret2;
  jint val;
  val=67;
  jstring str=NULL;
  jobjectArray array = NULL;
  jclass sclass=NULL;
  /* create an opc_data structure to store message ids of */
  /* messages to escalate                                 */
  if ((ret2=opcdata_create(OPCDTYPE_MESSAGE_ID, &opc_msg_id))!= OPC_ERR_OK)
  {
    fprintf(stderr, "Can't create opc_data structure to store message. opcdata_create()=%d\n", ret2);
    cleanup_all();
  }

  //////////////////////////////////////////////////////////
  msg_id=(*env)->GetStringUTFChars(env,msgid,NULL);
  opcdata_set_str(opc_msg_id, OPCDATA_MSGID, msg_id);
  (*env)->ReleaseStringUTFChars(env, msgid, msg_id);
  ret=opcmsg_ack(connection,opc_msg_id);
  //////////////////////////////////////////////////////////

  if(flag==0 && ret==0)
  {
    sclass = (*env)->FindClass(env, "java/lang/String");
    array = (*env)->NewObjectArray(env, 2, sclass, NULL);
    str=(*env)->NewStringUTF(env,"0");
    (*env)->SetObjectArrayElement(env,array,0,str);
    (*env)->DeleteLocalRef(env, str);
    str=(*env)->NewStringUTF(env,"0");
    (*env)->SetObjectArrayElement(env,array,1,str);
    (*env)->DeleteLocalRef(env, str);
  }

  opcdata_free(&opc_msg_id);

  if(ret!=0)
    return NULL;
  else
    return(array);
} 
```

在上面的一个中，如果我评论 ///// 之间的部分，我看不到任何内存泄漏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-07T01:58:42.017

释放**数组**对象。

(*env)->DeleteLocalRef(env, array);

# nhibernate - llblgen 和 nHibernate 有什么区别？

> ID：915792
> 
> 赞同：3
> 
> 时间：2009-05-27T13:44:52.663
> 
> 标签：nhibernate, orm, llblgenpro

llblgen 和 nHibernate 之间的主要区别是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-03-01T01:05:18.493

LLBLGen 是一个精巧的大小写强化工具，可以生成最终可扩展的代码。客户服务是首屈一指的，并且错误已被修复，因为它们是由业务中最优秀的人才之一发现的。我在晦涩难懂的问题上有 5 个小时的周转时间，只影响我，虫子。

我目前正在使用 nhibernate 咬牙切齿，不得不说让我远离它这么长时间的忧虑并没有放错地方。它是一个拥有庞大用户群的好工具，但本质上，映射文件/映射类/映射属性策略同时又软又脆弱。

这是我的观点，不需要惩罚性的投票，因为我在批评 nhibernate。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T13:53:25.517

LLblgen 是一个商业工具，它使用基于设计器的配置来生成用于数据访问的类。

Nhibernate 是一个开源免费工具，它使用基于 xml 的映射文件将您的对象映射到数据库中的表。

我更喜欢 Nhibernate 而不是 LLblgen。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-15T08:56:50.413

取自 llblgen 主页的概述页面：

**LLBLGen Pro 是 .NET 的排名第一的 O/R 映射器和数据访问层生成器，它使用现有的数据库模式集为您（在 C# 或 VB.NET 中）生成完整的数据访问层和业务外观/支持层. 片刻之间。生成的 .NET 代码是编译器就绪的，并且可以由 .NET C# 或 VB.NET 编译器编译，立即由其他应用程序使用。**

所以是的，它也是一个 ORM 映射器，并且加载更多。

# sql - 有没有办法对 SqlDataReader 进行多线程处理？

> ID：915794
> 
> 赞同：8
> 
> 时间：2009-05-27T13:45:15.737
> 
> 标签：sql, sql-server, performance, multithreading, c#-3.0

我有一个 Sql Query，它返回超过 50 万行来处理......这个过程并不需要很长时间，但我想通过一些多处理来加快它的速度。考虑下面的代码，是否可以轻松地进行多线程处理？

```
using (SqlDataReader reader = command.ExecuteReader())
{
    while (reader.Read())
    {
        // ...process row
    }
} 
```

如果我可以简单地在结果列表的开头和中间获得一个光标，那将是完美的。这样，我可以有两个线程处理记录。但是 SqlDataReader 不允许我这样做......

知道我怎么能做到这一点吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-27T13:49:59.690

设置一个生产者/消费者队列，一个生产者进程尽可能快地从读取器和队列中提取记录，但不进行“处理”。然后一些其他数量的进程（您想要多少取决于您的系统）来出列并处理每个排队的记录。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T16:26:29.547

您不应该在客户端上读取那么多行。

话虽如此，您可以将查询划分为多个查询并并行执行它们。这意味着在单独的线程中启动多个 SqlCommand 并让它们各自搅动结果的一个分区。A+ 问题是如何对结果进行分区，这在很大程度上取决于您的数据和查询：

1.  您可以使用一系列键（例如`ID betweem 1 and 10000`，`ID between 10001 and 20000`等）
2.  您可以使用属性（例如`RecordTypeID IN (1,2)`，`RecordTypeID IN (3,4)`等）
3.  您可以使用合成范围（即`ROW_NUMBER() BETWEEN 1 and 1000`等），但这对于向右拉是非常有问题的
4.  您可以使用哈希（例如`BINARY_CHECKSUM(*)%10 == 0`，`BINARY_CHECKSUM(*)%10==1`等）

您只需要非常小心，分区查询在执行期间不会重叠和**阻塞**（即扫描相同的记录并获取 X 锁），从而相互序列化。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-27T13:59:06.740

它是一个简单的范围查询，例如 WHERE Id 介于 1 和 500000 之间吗？如果是这样，您可以启动 N 个查询，每个查询都返回范围的 1/N。但它有助于了解单线程方法的瓶颈所在。如果您正在从一个磁盘主轴进行连续读取以完成查询，那么您可能应该坚持使用单个线程。如果它在某个范围内跨主轴分区，那么您可以智能地调整查询以最大限度地提高磁盘的吞吐量（即从每个磁盘并行读取单独的查询）。如果您希望所有行都在内存中，那么您可以随意并行化。但是，如果查询更复杂，那么您可能无法在不产生大量开销的情况下轻松对其进行分区。大多数情况下，上述选项不会很好地适用，并且 Joel 提到的生产者/消费者将是唯一并行化的地方。根据您花费多少时间处理每一行，这可能只提供微不足道的收益。

# c# - 将 FieldName 作为参数传递

> ID：915795
> 
> 赞同：6
> 
> 时间：2009-05-27T13:45:16.643
> 
> 标签：c#, reflection, anonymous-function

我不太确定我正在尝试做什么，所以我很难从谷歌中找到任何线索。

我有几个具有相同逻辑的方法，唯一不同的是它们在对象上使用的属性。

```
class Foo
{
   public int A(Bar bar)
   {
      return bar.A * 2;
   }

   public int B(Bar bar)
   {
      return bar.B * 2;
   }

   public int C(Bar bar)
   {
      return bar.C * 2;
   }
}

class Bar
{
   public int A;
   public int B;
   public int C;
} 
```

而不是我想要的三个单独的方法`Foo`，其签名看起来更像

```
public int X(Bar bar, ??? x)
{
   return bar.x * 2;
} 
```

这可能吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-27T13:49:24.637

我第一次看错了这个问题，我的错。

你可以用反射做到这一点：

```
public int Method(Bar bar, string propertyName)
{
   var prop = typeof(Bar).GetProperty(propertyName);
   int value = (int)prop.GetValue(bar,null);
   return value * 2;
} 
```

然后，你这样称呼它：

```
Method(bar,"A"); 
```

刚刚注意到在您的示例中， Bar 中的 3 个变量是公共实例变量。我假设您只是为您的示例执行此操作，但如果您的真实课程中确实是这种情况，请使用 Rex M 的方法。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-27T14:02:26.060

```
internal class Program {
    private static void Main(string[] args) {
        var bar = new Bar {A = 1, B = 2, C = 3};
        Console.WriteLine(new Foo().X(bar, it => it.A));
        Console.WriteLine(new Foo().X(bar, it => it.B));

        // or introduce a "constant" somewhere
        Func<Bar, int> cFieldSelector = it => it.C;
        Console.WriteLine(new Foo().X(bar, cFieldSelector));
    }
}

internal class Foo {
    // Instead of using a field by name, give it a method to select field you want.
    public int X(Bar bar, Func<Bar, int> fieldSelector) {
        return fieldSelector(bar) * 2;
    }

    public int A(Bar bar) {
        return bar.A * 2;
    }

    public int B(Bar bar) {
        return bar.B * 2;
    }

    public int C(Bar bar) {
        return bar.C * 2;
    }
}

internal class Bar {
    public int A;
    public int B;
    public int C;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-27T14:06:36.880

我会考虑使用匿名委托来获取您的价值。

```
public int X(Bar bar, Func<Bar,int> getIt)
{
   return getIt(bar) * 2;
} 
```

然后这样称呼它：

```
var x = X(mybar, x=>x.A); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T13:52:07.877

您可以使用反射来实现这一点。它会对性能产生一些影响

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T13:53:21.290

您可以使用 PropertyInfo 类通过反射检索所需的属性：[https ://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-6099345.html](https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-6099345.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T13:56:56.213

```
public int X(Bar bar, string target)
{
    object value = bar.GetType().GetField(target, BindingFlags.Public | BindingFlags.Instance).GetValue(bar);
    return (int)value * 2;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T13:58:00.500

尝试使用反射。下面是一些简单的代码来实现效果。

```
using System.Reflection;    

public int X(Bar bar, FieldInfo x)
{
    return (int)x.GetValue(bar) * 2;
} 
```

现在，您可以通过首先获取 Bar 上的一个字段的 FieldInfo 来调用 X。

```
Bar b = new Bar();
b.A = 20;
b.B = 30;
b.C = 40;

FieldInfo fieldA = typeof(Bar).GetField("A");
int result = X(b, fieldA); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-27T13:59:02.370

使用字段信息

```
BindingFlags flags = BindingFlags.Instance | BindingFlags.Public;
FieldInfo field = typeof(Bar).GetField("A", flags); 
```

field.SetValue(..) 设置值。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-27T14:04:09.380

您可以使用扩展方法.. 对于您发布的示例.. 但我想您的示例只是一些更复杂代码的简化版本。

```
public static class IntExt
{
    //use Bar.A.Double();
    public int Double(this int value)
    {
        return value * 2;
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-27T14:06:07.520

为什么不使用枚举并将其传递给函数以确定使用哪个？似乎反射有点向西环游世界，向右迈出一步......

```
class Foo
{
   public enum BarChoice { a,b,c };
   public int x(Bar bar, BarChoice bc)
   {
     switch(bc) 
     {
       case a:
         return bar.A * 2;
       case b:
         return bar.B * 2;
       case c:
         return bar.C * 2;
     }
     return int.MinValue;
   }
} 
```

那么你的电话将是

```
 Foo f = new foo();
 Bar b = new Bar();
 f.x(b, Foo.BarChoice.a);
 f.x(b, Foo.BarChoice.b);
 f.x(b, Foo.BarChoice.c); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-08-19T18:00:59.360

您可以使用以下`ref`关键字：

```
class Foo
{
    public void A(ref int fieldRef)
    {
        fieldRef *= 2;
    }
}

class Bar
{
    public int A;
    public int B;
    public int C;
}

class Program
{
    static void Main(string[] args)
    {
        var bar = new Bar { A = 1, B = 2, C = 3 };
        var foo = new Foo();
        foo.A(ref bar.A);
        foo.A(ref bar.B);
        foo.A(ref bar.C);

        Console.WriteLine(bar.A); // 2
        Console.WriteLine(bar.B); // 4
        Console.WriteLine(bar.C); // 6
    }
} 
```

我已经更改了一些不切实际的示例（正如@Jonas Elfström 所说，在这种情况下您可以简单地传递值）。这表明您可以更改字段的值。

# php - 如何构造 HTML 表单元素以便可以轻松地将它们转换为 PHP 对象？

> ID：915799
> 
> 赞同：2
> 
> 时间：2009-05-27T13:45:51.117
> 
> 标签：php, jquery, html, oop, webforms

我正在尝试找出命名我的 HTML 表单字段的最佳方法，以便可以轻松地将它们解析为一组 PHP 对象。

例如，我有以下元素表：（假设它在表单内）

```
<table>
  <tr id='payment0'>
    <td><input type='text' name='paymentType0'></td>
    <td><input type='text' name='paymentAmount0'></td>
    <td><input type='text' name='paymentAccount0'></td>
  </tr>
  <tr id='payment1'>
    <td><input type='text' name='paymentType1'></td>
    <td><input type='text' name='paymentAmount1'></td>
    <td><input type='text' name='paymentAccount1'></td>
  </tr>
</table> 
```

显然，我可以编写一堆代码来搜索 $_POST 数组以找到所有 paymentType/Amount/Account 等值并将它们放入对象中。但是这感觉有点臭，我想知道是否有更好的方法来命名这些表单元素？

附带说明一下，我曾尝试将这些字段命名为控制数组（至少我是这么称呼它们的），因此将 paymentType0 替换为 paymentType[0] 并且 PHP 会将它们视为我可以迭代的数组。这种方法的问题在于，由于方括号，使用 jQuery 引用这些字段变得非常困难。

什么是“两全其美”的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T14:13:09.957

您可以毫无问题地使用数组，但不要调用字段`paymentType[0]`, `paymentAmount[0]`, ...

相反，称它们`payment[0][type]`为 ,`payment[0][amount]`等。

然后将记录方便地分组到关联数组中，这更容易操作：

```
foreach ($_POST["payment"] as $payment) {
   echo "The type was $payment[type] and the amount was $payment[amount]";
} 
```

至于 jQuery：遵循大卫的建议。JavaScript 中的对象实际上只是带有语法糖的关联数组，您可以按如下方式访问它们的成员：

```
myForm["payment[0][amount]"].value = 300 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T13:50:32.187

您可以考虑使用 jQuery 预处理提交的值。您可以在客户端构建它们并使用 JSON 将它们传递到服务器，而不是提交原始表单数据，JSON 可以很容易地转换为 PHP 对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T14:07:21.323

使用带方括号的名称，以便 PHP 的表单处理库将它们转换为数组。

然后，如果您需要使用 JavaScript 引用它们，请使用[方括号表示法](http://www.dev-archive.net/articles/js-dot-notation/)。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-27T14:01:49.447

我同意 n3rd，如果您在传递变量后遇到问题，请预先格式化您的数据。

对这个想法的一点点推断只是意味着将您的数据存储在您在用户输入值时构建的 JSON 对象中，然后在提交时将 JSON 对象发送到下一页，而不用担心每个变量名称是什么。

如果不是这样，还有另一种可能的解决方案，尽管我不确定它是否解决了您的特定问题：

[http://www.configure-all.com/arrayoffields.php](http://www.configure-all.com/arrayoffields.php)

（从谷歌搜索“php 表单名称 jquery 数组”中获取）

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-27T14:12:45.683

您可以随时尝试以下代码：

```
foreach($_POST as $key => $val)
{
    if(isset($$key)) $$key = $val;
} 
```

但是这种方法很糟糕，因为您可以发布 PHP_SELF 等变量，因此您想检查这些变量。

# iphone - NSURL 对象中的多个参数

> ID：915800
> 
> 赞同：0
> 
> 时间：2009-05-27T13:45:53.943
> 
> 标签：iphone, nsstring, nsurl

我想将多个参数从 iphone sdk 传递到与 mySQL 数据库接口的服务器端 php。

我找到了一些关于如何做到这一点的答案，但我很难弄清楚如何包含几个参数。

我现在拥有的是

* * *

```
- (IBAction)sendButtonPressed:(id)sender
{
    NSString *urlstr = [[NSString alloc] initWithFormat:@"http://server.com/file.php?date=%d", theDate];
    NSURL *url = [[NSURL alloc] initWithString:urlstr];

    [urlstr release];
    [url release];
} 
```

* * *

这适用于 1 个参数，但我正在寻找的是类似

```
http://server.com/file.php?date=value&time=value&category=value&tags=value&entry=value 
```

我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T13:50:03.013

该`- initWithFormat`方法采用格式字符串的多个参数。

所以你可以做这样的事情：

```
 NSString *urlstr = [[NSString alloc] initWithFormat:@"http://server.com/file.php?date=%d&second=%d&third=%d", theDate, 2, thirdIVar]; 
```

`- initWithFormat`几乎与`printf()`它的变体相同。

这是一些`printf()`示例[http://stahlforce.com/dev/index.php?tool=csc02](http://stahlforce.com/dev/index.php?tool=csc02)

编辑：变量在哪里`nameField, tagsField, dreamEntry`定义和设置？

除非它们是`NSString`s 并在 中定义，否则`@interface`您不能以这种方式使用它们。

我建议硬编码一些测试值：

```
 NSString *urlstr = [[NSString alloc] initWithFormat:@"http://server.com/file.php?date=%@&time=%@&name=%@&category=%d&tags=%@&entry=%@", nil, nil, @"Name", nil, @"Tags", @"Dream"]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T14:28:42.450

创建 NSURL 不会打开与服务器的通信。它只是一个用于保存 URL 的数据结构。您想阅读[NSURLConnection](http://developer.apple.com/iphone/library/documentation/Cocoa/Conceptual/URLLoadingSystem/Tasks/UsingNSURLConnection.html)。

您以格式传递的所有变量都是数字吗？`%d`是数字的占位符；`%@`是一个对象。如果您期望一个数字，即使出于测试目的，传递 nil 也是非常令人惊讶的。它会“工作”，因为 nil 为 0，但它表明这些不是真正的数字。

# java - XML 或 XUL 是 Java GUI 构建的未来吗？

> ID：915810
> 
> 赞同：9
> 
> 时间：2009-05-27T13:47:02.160
> 
> 标签：java, xml, user-interface, swing, xul

在 Swing 中花费大量时间和代码进行编程之后，我认为这不可能是最先进的 Java GUI 构建。在没有为 Eclipse 找到用户友好的可视化 GUI 图像后，我偶然发现了使用 XML UI 工具包构建的声明式 GUI……我想：一定是这样！我认为这是正确的方法，简单且接近网络编程。

但是在网上和 SO 上环顾四周后，我的印象是这不是很常见！尽管有很多实现和 API，但似乎大多数都已经死了，在过去的 5 年里没有更新。

所以我想知道：我的感觉对吗，Java GUI 中 XML 不是很普遍？如果是这样 - 原因是什么？也许它无法被接受，或者它有一些主要缺点，或者人们在网络上做所有事情而不是使用胖客户端，或者有更好的选择，也许是 javafx？

我只需要知道是否值得花时间在那个领域或更好地寻找替代方法。由于我不阅读开发者杂志，我只是不知道 gui 构建的趋势是什么，以及哪些技术被认为具有未来。但我无法想象人们仍然会花费如此多的时间来编写令人讨厌的摇摆（或 swt）应用程序。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T19:50:22.800

有新的有趣的方法 - 它使用**YAML**。[在http://code.google.com/p/javabuilders/](http://code.google.com/p/javabuilders/)上查看

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T13:56:18.133

Sun 对此的回答似乎是[JavaFX](http://javafx.com)。

它具有用于指定 GUI 的声明性语言，并且还会有构建器应用程序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-27T14:07:18.237

[e4 (Eclipse 4)](http://wiki.eclipse.org/E4)正在进行一些原型工作，这将允许通过编辑 Ecore 模型并通过 CSS 对其进行自定义来构建 GUI。
有关一些详细信息和说明，请参阅[此博客文章](http://www.toedter.com/blog/?p=64)以自行尝试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T14:06:25.087

五到十年前，XML 非常流行。虽然为异构系统之间的数据传输提供某种标准化很好，但它不适合编程。它总是从简单的东西开始，然后让我们声明一切。但是任何真正的系统都需要代码。XML 然后下降。还有一个问题是 XML 对人类来说是一种糟糕的语法，甚至像 Java 这样的语言也更容易阅读。

另一方面，显然需要 GUI 的导轨。Naked Objects 是我见过的最接近合理的尝试。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T14:07:52.900

关于那里的声明性框架，我得出了与您相同的结论。除非得到广泛支持，否则不值得学习新的 GUI 语法。XUL 作为一种界面语言很普遍，但是没有针对它的 java 渲染框架。我会说 HTML+CSS+Javascript 和 Servlet 容器是当今用于 GUI 的最佳 Java 平台，但遗憾的是，我还没有找到一种独立于平台的方式来显示网页（如桌面应用程序）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-02-15T17:59:19.883

If you use Eclipse, you can now use [WindowBuilder](http://www.eclipse.org/windowbuilder/) to help you in creating Swing apps in a user-friendly visual GUI builder. It's now available as a free download, and Google has donated the Swing GUI builder framework to the Eclipse Foundation.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T14:01:30.930

答案肯定不会是 XML。你想解决什么问题？您希望拥有可重用的构建块，以及描述它们的紧凑方式。我没有看到 XML 在那里帮助你。

[编辑] 创建一个等效于 XUL 的 java 代码将是对 XUL 的巨大改进。XML 使得做好关注点分离非常非常困难，而且只有一次。然而，它非常适合蒙古部落的方法。您需要在秋千之上添加一层，它只提供构建块。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-27T14:02:42.300

我对 javaFX 提出了第二个 Thilos 建议。此外，趋势指向 webapps，所以我认为从长远来看，javaFX 和基于 web 的 UI 将赶上 swing+swt GUI。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-27T14:49:53.110

我所有的挥杆动作都是手工完成的，我的应用程序没有一个是讨厌的。如果您不知道如何创建可用且美观的 UI，则没有技术可以帮助您。

# .net - 160 位 SHA1 散列的前 32 位是否可以替代 CRC32 散列？

> ID：915811
> 
> 赞同：6
> 
> 时间：2009-05-27T13:47:36.403
> 
> 标签：.net, hash, cryptography

我正在开发一个 .NET 3.5 项目，我需要一个 32 位哈希值。.NET Cryptography 类中似乎没有任何方法返回 32 位散列（MD5 是 128 位，SHA1 是 160 位等）。我实现了一个 CRC32 类，但我发现已经存在的 SHA1 和 MD5 散列函数要快得多。

使用 SHA1 散列函数并仅断开前 32 位存储为我的散列值会有什么问题（即，增加冲突的机会）吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T14:09:45.923

除非您想要 CRC32 的额外功能（作为线性代码），否则将输出切割为 32 位应该没问题。

削减某些加密哈希函数的输出是否会损害其在抗碰撞方面的安全性是一个开放的研究问题（如果我没记错的话，存在“不自然”的构造示例）。但是 NIST（可能在 NSA 的批准下）使用切割技术从 SHA-256 获取 SHA-224（请参阅[维基百科中有关 SHA 的文章](http://en.wikipedia.org/wiki/SHA_hash_functions#SHA-2_family)）。

编辑：CRC32 允许检测（并且可能纠正）单个位错误，而加密哈希函数应该具有您无法找到具有相同哈希值的两个输入的属性。

您是否知道“生日悖论”（再次参见维基百科）？使用 32 位校验和，当您有大约 2^16 个输入并且您想要散列更多输入时，您预计会发生冲突（即具有相同散列值的两个输入）。（重读您的评论，这对您来说可能不是问题。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T13:55:06.903

假设哈希函数在其 codomain 上平均分配其输入，假设它也将在其任何子集上平均分配似乎是合乎逻辑的。但是，使用“本机”32 位散列函数可能仍然是更好的选择。也许更深入的人可以为我们提供比我的直觉更好的理由:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-04T13:52:14.480

为什么不直接使用 string.GetHashCode()。它旨在计算 32 位哈希值，并在给定真实数据的情况下产生很少的冲突。当然，它不安全，但您的问题不包括作为要求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T13:52:34.287

如果您不打算将 32 位用于加密目的，那么您应该没问题。否则，我不会依赖与整个散列具有相同分布的前 32 位。

为什么你不能只使用可用的更广泛的散列？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T13:53:58.543

CRC32 可能适合您的需求。[这个问题](https://stackoverflow.com/questions/8128/how-do-i-calculate-crc32-of-a-string)已经讨论过了。

在截断散列原语方面，唯一大量使用的应用是用于生成密钥的[SSL/TLS 伪随机函数 (PRF) 。](https://www.rfc-editor.org/rfc/rfc5246#section-5)它使用 HMAC、种子和标签通过多次散列生成所需的字节数，然后截断为所需的字节数。

不过，对于您的具体问题，您可以将哈希的输出读入 Int32，然后如果您偏执，则将它们异或在一起：

```
static void Main()
{
    int xorCrc = GetHashedCrc(new SHA1Cng(), new byte[] {0xDE, 0xAD, 0xBE, 0xEF});
}

private static int GetHashedCrc(HashAlgorithm algorithm, byte[] bytesToHash)
{
    byte[] hash = algorithm.ComputeHash(bytesToHash);
    int totalInt32s = hash.Length/sizeof(int);
    int result = 0;
    for(int i = 0; i < totalInt32s; i++)
    {
        int currentInt = BitConverter.ToInt32(hash, sizeof(int)*i);
        result = result ^ currentInt;
    }

    return result;
} 
```

# sql - 用于解析多行数据的 SQL？

> ID：915814
> 
> 赞同：2
> 
> 时间：2009-05-27T13:48:09.600
> 
> 标签：sql, mysql, excel, ms-access, vba

我有一个不幸的任务，必须定期将数据从 excel 导入数据库。该表如下所示：

```
 IssueID   References  
  1234      DocID1<cr>DocID2<cr>DocID3
  1235      DocID1
  1236      DocID2
  1237      DocID2<cr>DocID3 
```

参考是一个多行文本字段。我要做的是创建一个与 Issue 表具有一对多关系的 Docs 表，而不是拥有这些多行引用。

我定义了以下表格：

问题：IssueKey、IssueID、IssueFields

文档：DocKey、DocID、DocRev、DocOwner 等

DocLink：LinkKey、DocKey、IssueKey

由于这将重复运行，Doc 表将已经存在并定义了 DocID。所以，我想要做的是对 References 列中的每个 DocID 进行查询或 VBA 代码搜索，如果不存在，则添加基于 IssueID 的链接。

很简单，对吧？

杰夫

说明：

1）我有一个名为“Val1”的第三列，以显示还有其他列，但这似乎混淆了这个问题。源表中实际上有很多（很多，最被忽略的）列，但我只关心上面的两个。

2）我不必解析分隔符或任何过于偏执的东西：参考包含一个或多个唯一定义的文档参考号（存储为文本）。因此，LIKE 过滤器将根据具体情况显示 IssueID 列表。

3）这是一个可接受的输出示例：

```
IssueID   References
1234      DocID1
1234      DocID2
1234      DocID3
1235      DocID1
1236      DocID2
1237      DocID2
1237      DocID3 
```

理想的解决方案将采用原始 excel 表（顶部）和这两个表：

```
IssueKey   IssueID
   1        1234
   2        1235
   3        1236
   4        1237

DocKey     DocID
  1        DocID1
  2        DocID2
  3        DocID3 
```

并填充/更新链接表：

```
LinkKey  IssueKey  DocKey
   1        1        1
   2        1        2
   3        1        3
   4        2        1
   5        3        2
   6        3        3 
```

4）这是我期望的解决方案的一个示例（创建上面的＃3）。不幸的是，它使 Access 崩溃，所以我无法判断语法是否正确（编辑以反映上面的字段名称）。

```
SELECT Q1.IssueID, D1.DocID
FROM Docs AS D1, Issues AS Q1
WHERE Q1.IssueID IN 
   ((SELECT Q2.IssueID from Issues AS Q2 where (Q2.References) Like D1.DocID)); 
```

5）暂时放弃访问，我在 MySQL 中有以下工作：

```
SELECT Q1.IssueID, D1.DocID
FROM Docs AS D1, Issues AS Q1
WHERE Q1.IssueID IN 
   ((SELECT Q2.IssueID from Issues AS Q2 where (Q2.References) Like '%DocID1%')); 
```

这正如我所期望的那样工作 - 我得到每个带有对 DocID1 的引用的 IssueID，对表中的每个 Doc 重复。有了上面的数据，它看起来像：

```
IssueID   References
1234      DocID1
1234      DocID2
1234      DocID3
1235      DocID1
1235      DocID2
1235      DocID3 
```

现在我只想用 '%'+D1.DocID+'%' 替换 '%DocID1%' - 将结果限制为实际匹配的文档 ID。出于某种原因，当我这样做时，我得到的记录为零——我认为我有错误地将通配符放在相关字段上的语法。

6) 以下工作在 MySQL 中提供上述#3，但翻译为访问的相同查询使其崩溃：

```
SELECT Q1.IssueID, D1.DocID
FROM Docs AS D1, Issues AS Q1
WHERE Q1.IssueID IN 
   ((SELECT Q2.IssueID from Issues AS Q2 where (Q2.References) Like        
        CONCAT('%',D1.DocID,'%'))); 
```

[在访问它变成 (' *' & D1.DocID & '* ')]

结论：访问很糟糕

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T07:03:09.277

这已被选为答案：

```
Q2.References LIKE ("*" & D1.DocID & "*")); 
```

但是，我认为这并不安全。

考虑名为 'References' 的列的值之一是否包含此数据：

```
DocID1<cr>DocID999<cr>DocID3 
```

`DocID = 9`并且另一个表中存在一个值。

这里的问题是

```
"DocID1<cr>DocID999<cr>DocID3" LIKE "*" & "DocID9" & "*" 
```

将评估为`TRUE`，这可能是不可取的。

为了解决这个问题，我认为搜索/连接条件中的值应该通过使用分隔符包围值来确保安全，例如

```
(CHR(13) & Q2.References & CHR(13)) LIKE ("*" & CHR(13) & D1.DocID & CHR(13) & "*")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T14:10:36.170

由于这是重复运行，我会要求（强烈建议）他们为我提供一个适当的文件，其中 issueID 和 valid 出现在每一行。这更容易处理。您需要确定这些字段的值是什么才能正确导入您的系统。

根据评论：在 SQL Server 中，您可以构建一个函数来根据逗号的 charindex 拆分数据。如果您在 Google 上搜索 fn_split，您会找到一个示例。不确定您将如何在 Access 中执行此操作，但它可能是一个交互过程，您可以在其中查找最后一个逗号并将其后的所有内容移到一个保留表中，然后删除该命令，然后再做一次，直到没有逗号为止. 像这样对暂存表进行导入是最简单的，您可以在其中以您需要的方式操作数据，然后将最终结果放入您的真实表中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T14:41:02.800

我的第一选择是在 C# 或 VB.Net 中组合一个快速应用程序来处理这个问题。

如果那不可行，我将有一个“导入”表，它可以按原样处理所有内容。然后我会使用游标来迭代表中的记录。在光标内，我将跟踪 IssueId 和 Val1 并解析 References 列以创建我的子记录。这部分我会打包成一个存储过程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T14:50:59.037

我建议您研究 SQL Server Integration Services (SSIS)。创建此工具是为了用最少的代码尽快完成这种数据导入/导出。

阅读它。做一些动手实验，看看是否有任何例子接近你想要做的。

[http://en.wikipedia.org/wiki/SQL_Server_Integration_Services](http://en.wikipedia.org/wiki/SQL_Server_Integration_Services) [http://www.microsoft.com/downloads/details.aspx?familyid=b1145e7a-a4e3-4d14-b1e7-d1d823b6a447&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=b1145e7a-a4e3-4d14-b1e7-d1d823b6a447&displaylang=en)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T16:06:50.647

你的意思是（输入，未测试）：

```
Dim rs As DAO.Recordset
Dim rsIn As DAO.Recordset ''Or ADO if you link directly to Excel

Set rs=CurrentDB.OpenRecordset( _
   "SELECT * FROM DocLinks dl INNER JOIN Docs d ON dl.DocKey=d.DocKey")

Do While Not rsIn.EOF

   astrDocs=Split(rsIn!References, vbCrLf)

   For Each strDoc In astrDocs
      rs.FindFirst "DocID='" & strDoc & "'"

      If rs.NoMatch Then 
         strSQL="INSERT INTO DocLinks (DocID, IssueID) " _
           & "VALUES ('" strDoc & "'," & rsIn!IssueID  & ")"
         CurrentDB.Execute strSQL, dbFailOnError
      End If
   Next

   rsIn.MoveNext
Loop 
```

**编辑重新评论**

如果 DocID 的长度是固定的，您可以考虑以下几行：

```
SELECT Sequence.Seq
       , ImportTable.IssueID
       , Mid(Replace([References],"<cr>",""),[seq],6) AS Docs
FROM Sequence, ImportTable
WHERE ([seq]+5) Mod 6=0) 
AND   Mid(Replace([References],"<cr>",""),[seq],6))<>"" 
AND   Mid(Replace([References],"<cr>",""),[seq],6)) 
      Not In (SELECT DocID FROM Docs) 
```

您将需要一个序列表，其中包含从 1 到至少最大参考长度的整数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T16:54:38.213

这可以在 SQL 中轻松完成。我编写了一个 TVF（表值函数），专门用于行分割文本，演示如何：

```
 ALTER function [dbo].[fnSplit3]( 
                @parameter varchar(Max)                -- the string to split
                , @Seperator Varchar(64)        -- the string to use as a seperator
        ) 
        RETURNS @Items TABLE(
                ID INT                                                -- the element number
                , item VARCHAR(8000)                -- the split-out string element
                , OffSet int                                -- the original offest
                --( not entirley accurate if LEN(@Seperator) > 1 because of the Replace() )
        ) 
AS
BEGIN 
/*
"Monster" Split in SQL Server 2005 
 From Jeff Moden, 2008/05/22

BYoung, 2008/06/18: Modified to be a Table-Valued Function
                    And to handle CL/LF or LF-only line breaks

Test: (scripts all procs & views in master)
    Select Lines.Item
     From Master.sys.syscomments C
      CROSS APPLY dbo.fnSplit3(C.text, char(13)+char(10)) Lines
     Order by C.ID, Lines.ID

Test2: (scripts all triggers in your database)
    Select Lines.Item
     From sys.sql_modules M
      Join sys.objects O on O.object_id = M.object_id
      CROSS APPLY dbo.fnSplit3(M.definition, char(13)+char(10)) Lines
     Where O.Type = 'TR' 
     Order by O.create_date, Lines.ID
*/
Declare @Sep char(1)
Set @Sep = char(10)        --our seperator character (convenient, doesnt affect performance)
--NOTE: we make the @Sep character LF so that we will automatically
-- parse out rogue LF-only line breaks.

--===== Add start and end seprators to the Parameter so we can handle
        -- all the elements the same way
        --  Also change the seperator expressions to our seperator
        -- character to keep all offsets = 1
SET @Parameter = @Sep+ Replace(@Parameter,@Seperator,@Sep) +@Sep
-- This reduces run-time about 10%

;WITH cteTally AS
(--==== Create a Tally CTE from 1 to whatever the length
        -- of the parameter is
 SELECT TOP (LEN(@Parameter))
        ROW_NUMBER() OVER (ORDER BY t1.object_id) AS N
  FROM Master.sys.system_Columns t1
   CROSS JOIN Master.sys.system_Columns t2
)
INSERT into @Items
        SELECT ROW_NUMBER() OVER (ORDER BY N) AS Number,
                SUBSTRING(@Parameter, N+1, CHARINDEX(@Sep, @Parameter, N+1)-N-1) AS Value
                , N+1
         FROM cteTally
         WHERE N < LEN(@Parameter)
          AND SUBSTRING(@Parameter, N, 1) = @Sep --Notice how we find the seperator

        Return 
END 
```

为了将它与您当前的表和数据一起使用，请执行以下操作：

```
SELECT Issues.IssueID, Lines.Item as Reference
 From Issues
  Cross Apply dbo.fnSplit3(Issues.Reference, char(13)) Lines
 Order By IssueID, Reference 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-02T13:40:15.767

我在这里提出基于集合的 SQL 解决方案时遇到问题。我以前做过这种事情，我不得不稍微刷新一下我的记忆，但是我遇到了一个问题。我*认为*这是引擎的问题（功能/错误？），但我可能会做一些愚蠢的事情。也许熟悉 Jet/ACE 并且可以阅读 VBA 的人可以查看此答案末尾的代码，并希望将其向前推进......？

基本方法是使用带有`MID()`表达式的整数序列表来解析数据列（我已将其重命名为 MyReferences，因为`REFERENCES`它是一个 SQL 关键字）。

这是一些 MS Access VBA，用于使用 SQL DDL/DML 重新创建测试表/数据。请注意，第一个`SELECT`查询返回子字符串以及星号和结尾分隔符；`CHR(13)`显然，在这种情况下，我们正在寻找两个定界符都是定界字符的行。第二个`SELECT`查询仅添加了所需分隔符的搜索条件，但出现“无效过程调用”错误；当`MID()`使用无效参数值调用表达式时会发生这种情况，例如

```
SELECT MID('A', 0, 0) 
```

我猜发生的事情是优化器没有使用子查询作为“快捷方式”，而是`MID()`在序列表中的搜索条件之前评估表达式。如果是这样，那就有点愚蠢了，我想不出一种强制评估顺序的方法。

那么，是我的还是引擎有问题？

```
Sub main()

  Dim sql As String

  sql = _
      "DROP TABLE ImportTable;"

  On Error Resume Next  ' Table may not exist
  CurrentProject.Connection.Execute sql
  On Error GoTo 0

  sql = _
      "DROP TABLE Sequence;"

  On Error Resume Next  ' Table may not exist
  CurrentProject.Connection.Execute sql
  On Error GoTo 0

  sql = _
      "CREATE TABLE ImportTable ( " & _
      "IssueID INTEGER NOT NULL UNIQUE, MyReferences VARCHAR(90) NOT NULL);"

  CurrentProject.Connection.Execute sql

  sql = _
      "INSERT INTO ImportTable VALUES (1234, 'DocID1' & Chr(13) & 'DocID22' & Chr(13) & 'DocID3');"

  CurrentProject.Connection.Execute sql

  sql = _
      "CREATE TABLE Sequence (seq INTEGER NOT NULL UNIQUE);"

  CurrentProject.Connection.Execute sql

  sql = _
      "INSERT INTO Sequence VALUES (-1);"

  CurrentProject.Connection.Execute sql

 sql = _
        "INSERT INTO [Sequence] (seq) SELECT Units.nbr + Tens.nbr" & _
        " FROM ( SELECT" & _
        " nbr FROM ( SELECT 0 AS nbr FROM [Sequence] UNION" & _
        " ALL SELECT 1 FROM [Sequence] UNION ALL SELECT 2 FROM" & _
        " [Sequence] UNION ALL SELECT 3 FROM [Sequence] UNION" & _
        " ALL SELECT 4 FROM [Sequence] UNION ALL SELECT 5 FROM" & _
        " [Sequence] UNION ALL SELECT 6 FROM [Sequence] UNION" & _
        " ALL SELECT 7 FROM [Sequence] UNION ALL SELECT 8 FROM" & _
        " [Sequence] UNION ALL SELECT 9 FROM [Sequence] ) AS" & _
        " Digits ) AS Units, ( SELECT nbr * 10 AS nbr FROM" & _
        " ( SELECT 0 AS nbr FROM [Sequence] UNION ALL SELECT" & _
        " 1 FROM [Sequence] UNION ALL SELECT 2 FROM [Sequence]" & _
        " UNION ALL SELECT 3 FROM [Sequence] UNION ALL SELECT" & _
        " 4 FROM [Sequence] UNION ALL SELECT 5 FROM [Sequence]" & _
        " UNION ALL SELECT 6 FROM [Sequence] UNION ALL SELECT" & _
        " 7 FROM [Sequence] UNION ALL SELECT 8 FROM [Sequence]" & _
        " UNION ALL SELECT 9 FROM [Sequence] ) AS Digits )" & _
        " AS Tens;"

  CurrentProject.Connection.Execute sql

  sql = _
      "SELECT DT1.IssueID, DT1.parsed_text, DT1.delimiter_1, DT1.delimiter_2 " & _
      "FROM ( " & _
      "SELECT I1.IssueID, MID(I1.MyReferences, S1.seq, S2.seq - S1.seq - LEN(CHR(13))) AS parsed_text, " & _
      " MID(CHR(13) & I1.MyReferences & CHR(13), S1.seq, LEN(CHR(13))) AS delimiter_1, " & _
      " MID(CHR(13) & I1.MyReferences & CHR(13), S2.seq, LEN(CHR(13))) AS delimiter_2 " & _
      "FROM ImportTable AS I1, Sequence AS S1, Sequence AS S2 " & _
      "WHERE S1.seq < S2.seq " & _
      "AND S2.seq - S1.seq - LEN(CHR(13)) > 0 " & _
      "AND S1.seq BETWEEN 1 AND LEN(CHR(13)) + LEN(I1.MyReferences) + LEN(CHR(13)) " & _
      "AND S2.seq BETWEEN 1 AND LEN(CHR(13)) + LEN(I1.MyReferences) + LEN(CHR(13)) " & _
      ") AS DT1;"

  Dim rs As ADODB.Recordset
  Set rs = CurrentProject.Connection.Execute(sql)

  MsgBox rs.GetString

  sql = _
      "SELECT DT1.IssueID, DT1.parsed_text, DT1.delimiter_1, DT1.delimiter_2 " & _
      "FROM ( " & _
      "SELECT I1.IssueID, MID(I1.MyReferences, S1.seq, S2.seq - S1.seq - LEN(CHR(13))) AS parsed_text, " & _
      " MID(CHR(13) & I1.MyReferences & CHR(13), S1.seq, LEN(CHR(13))) AS delimiter_1, " & _
      " MID(CHR(13) & I1.MyReferences & CHR(13), S2.seq, LEN(CHR(13))) AS delimiter_2 " & _
      "FROM ImportTable AS I1, Sequence AS S1, Sequence AS S2 " & _
      "WHERE S1.seq < S2.seq " & _
      "AND S2.seq - S1.seq - LEN(CHR(13)) > 0 " & _
      "AND S1.seq BETWEEN 1 AND LEN(CHR(13)) + LEN(I1.MyReferences) + LEN(CHR(13)) " & _
      "AND S2.seq BETWEEN 1 AND LEN(CHR(13)) + LEN(I1.MyReferences) + LEN(CHR(13)) " & _
      ") AS DT1 " & _
      "WHERE DT1.delimiter_1 = CHR(13) " & _
      "AND DT1.delimiter_2 = CHR(13);"

  Set rs = CurrentProject.Connection.Execute(sql)

  MsgBox rs.GetString

End Sub 
```

FWIW 这是`PROCEDURE`我几年前写的，用于将分隔列表解析为表格。对于最多 255 个字符的值，它似乎工作正常；再多一点，你就会得到一个非常讨厌的 ACE/Jet 引擎错误。再说一次，除了引擎无法应付之外，我看不出有什么问题！无论如何，我的观点是这有效（对于小值），我不知道为什么我不能适应手头的问题：

```
CREATE PROCEDURE ListToTable
(
   delimted_text MEMO,
   delimiter VARCHAR(4) = ','
)
AS
SELECT MID(I1.input_string, S1.seq, MIN(S2.seq) - S1.seq - LEN(delimiter)) AS param
  FROM
      (
       SELECT DISTINCT delimted_text AS input_string
         FROM Sequence AS S3
        WHERE S3.seq BETWEEN 1 AND LEN(delimted_text)
      ) AS I1, Sequence AS S1, Sequence AS S2
 WHERE MID(delimiter & I1.input_string & delimiter, S1.seq, LEN(delimiter)) = delimiter
       AND MID(delimiter & I1.input_string & delimiter, S2.seq, LEN(delimiter)) = delimiter
       AND S1.seq < S2.seq
       AND S1.seq BETWEEN 1 AND LEN(delimiter) + LEN(delimted_text) + LEN(delimiter)
       AND S2.seq BETWEEN 1 AND LEN(delimiter) + LEN(delimted_text) + LEN(delimiter)
 GROUP 
    BY I1.input_string, S1.seq
HAVING LEN(MID(I1.input_string, S1.seq, MAX(S2.seq) - S1.seq - LEN(delimiter))) > 0; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-02T17:49:34.183

我认为在标题中使用“解析”这个词已经把每个人都搞糊涂了。Access 中的错误是对查询（而不是表）执行的相关查询会导致挂起。因此，我创建了一个临时表，将 References 列（带有多行文本）添加到 Issues 表中，这样我就可以访问其他字段。最终查询创建上述链接表，以及 DocID 和 IssueID 以供参考：

```
SELECT Q1.IssueID, Q1.IssueKey, D1.DocKey, D1.DocID
FROM Issues AS Q1, Documents AS D1
WHERE Q1.IssueID in 
  (SELECT  Q2.IssueID FROM Issues AS Q2 WHERE Q2.References LIKE ("*" & D1.DocID & "*")); 
```

内部选择在参考列中提取具有给定文档的问题列表。外部选择对每个文档执行此操作，从而生成聚合列表。

# iis - IIS 网站与虚拟目录 - 为什么选择其中一个？

> ID：915816
> 
> 赞同：2
> 
> 时间：2009-05-27T13:48:38.943
> 
> 标签：iis

虽然我已经使用了这两种方法，但我从来没有真正“了解”到是否选择一个网站作为新应用程序的根实体或现有网站下的虚拟目录的决定或优缺点。我有一个模糊的想法，主要涉及“嗯，它是需要自己配置的主站点的子位置吗？”但我不确定这是否完全准确。我有应用程序池，但从未理解这种差异。

所以，提问。**IIS 中的网站和虚拟目录有什么区别，为什么要选择其中一个？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T13:53:35.003

一个区别是您可以将不同的网站分配给不同的 URL。这允许您使用：

app1.mydomain.com
app2.mydomain.com

代替：

mydomain.com/app1
mydomain.com/app2

大多数人认为这是“更清洁”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T13:52:39.980

一个简单的答案

[http://www.eggheadcafe.com/conversation.aspx?messageid=29944368&threadid=29944365](http://www.eggheadcafe.com/conversation.aspx?messageid=29944368&threadid=29944365)

恢复并举例...

网站 URL = www.company1.com 或 portal.company1.com

虚拟目录 URL = www.yoursite.com/portal1

# php - PHP 等价于 Perl 的 URI::URL

> ID：915825
> 
> 赞同：1
> 
> 时间：2009-05-27T13:51:34.837
> 
> 标签：php, url

我正在重写我近 8 年前用 PHP 编写的基于 Perl 的网络爬虫。我在 perl 中使用了非常方便的 URI::URL 模块来执行以下操作：

```
$sourceUrl = '/blah.html';
$baseHost = 'http://www.example.com';
my $url = URI::URL->new($sourceUrl, $baseHost);
return $url->abs; 
```

返回：' [http](http://www.example.com/blah.html) ://www.example.com/blah.html '

PHP 中的 parse_url 函数非常方便，但还有更强大的功能吗？特别是可以提供上述功能的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T13:58:31.093

也许[Zend_Uri](http://framework.zend.com/manual/en/zend.uri.html)是您正在寻找的？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T14:27:55.980

```
print $baseHost . $sourceURL; 
```

我错过了什么吗？你的方式似乎不必要地过于复杂。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T17:35:49.140

我对 PEAR 档案进行了一些搜索，我初步猜测的[URI::URL](http://search.cpan.org/~gaas/URI-1.37/URI/URL.pm)近似值是[Net_URL2](http://pear.php.net/package/Net_URL2)。也许你想试一试？

# c# - 1个运行空间是否可以有许多管道

> ID：915831
> 
> 赞同：1
> 
> 时间：2009-05-27T13:53:13.443
> 
> 标签：c#, powershell, powershell-1.0

这是从 c# 异步执行脚本，并让线程执行加载脚本以执行并等待输出出来的工作。我可能需要同时执行许多脚本，也许是同时执行。

Windows poweshell 中的运行空间和管道之间可能存在 1:M 关系，如果是，这对它有什么影响。特别是关于内存使用，如果有人有这方面的经验的话。

此外，如果它们是一种让每个运行空间拥有超过 1 个管道的方法，那么这会对主机产生连锁反应。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T14:36:53.293

如果您的意思是单个运行空间中的多个同时管道：不。

事实上，CreatePipeline 方法抛出的一个记录异常是**InvalidRunspaceStateException**，它发生在“运行空间不处于允许创建管道的状态”时，即前一个管道尚未完成时。

# java - SEAM 项目在 JBoss AS 中运行？

> ID：915838
> 
> 赞同：1
> 
> 时间：2009-05-27T13:54:14.470
> 
> 标签：java, jboss, seam

我如何在 JBoss AS 中运行 Seam 应用程序？

我将 JBoss SEAM 作为我项目的依赖项（使用 MAVEN2）并将其部署在 JBoss AS 中——这足以使我的项目正常工作（具有 JBoss Seam 提供的所有功能）或者我是否需要修改 JBoss AS任何方式（例如，在 JBoss AS 的 lib 目录中包含一些额外的接缝库）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T14:01:05.423

您不必修改 JBoss AS 安装，将 SEAM JAR 部署为应用程序 EAR 的一部分应该可以完美运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-07-26T06:53:36.457

```
mvn archetype:generate 
```

选项 20 并按照步骤操作，您应该有一个良好的启动 pom.xml。

# .net - 所有应用程序都可以访问共享 asp.net 服务器上隔离存储中的所有文件吗？

> ID：915839
> 
> 赞同：0
> 
> 时间：2009-05-27T13:54:16.407
> 
> 标签：.net, asp.net, security, iis, isolatedstorage

我正在考虑将 IsolatedStorage 用于我的临时文件。但是，文档似乎暗示存储空间由 Windows 用户帐户决定，对于 ASP.NET 应用程序来说，该帐户是 NETWORK SERVICES。如果有多个网站/应用程序使用 NETWORK SERVICES 作为他们的帐户，这是否意味着它们都将共享相同的 IsolatedStorage 并能够读取彼此的文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T14:28:40.313

我认为如果您`IsolatedStorageFileStream`使用实例构建您的`IsolatedStorageFile`实例，您将拥有更大的灵活性，因为它们可以在例如特定于应用程序的基础上创建：

```
using (IsolatedStorageFile isf = IsolatedStorageFile.GetMachineStoreForApplication())
using (IsolatedStorageFileStream isfs = new IsolatedStorageFileStream("filename", FileMode.Create, isf))
{
    // Code using the file stream here...
} 
```

# forms-authentication - Windows 窗体身份验证访问 maxInvalidPasswordAttempts 尝试离开

> ID：915842
> 
> 赞同：0
> 
> 时间：2009-05-27T13:54:40.773
> 
> 标签：forms-authentication

在我的网络配置文件中，maxInvalidPasswordAttempts 设置为 3。

我有一个更改密码表格，允许用户在帐户锁定之前输入他们的安全答案 3 次。

但是我想知道是否可以提取剩余的尝试次数，以便在用户第三次尝试时显示相关的错误消息。

有任何想法吗？在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T13:58:25.023

您可以将剩余尝试次数保留在 Session 变量中，如此处所做的[那样](http://www.codeproject.com/KB/aspnet/custom_authentication.aspx)

# .net - 应该使用 USING 语句的案例列表

> ID：915849
> 
> 赞同：0
> 
> 时间：2009-05-27T13:57:23.217
> 
> 标签：.net, idisposable, using-statement, unmanagedresources

“File 和 Font 是访问非托管资源（在本例中为文件句柄和设备上下文）的托管类型的示例。还有许多其他类型的非托管资源和封装它们的类库类型。所有此类类型都必须实现 IDisposable 接口。如一条规则，当你使用 IDisposable 对象时，你应该在 using 语句中声明和实例化它。” - MSDN

是否存在应使用 USING 语句的此类情况的列表（访问非托管资源（如 FILE 和 FONT，...）的托管类型？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T13:59:09.640

任何实现的类型`IDisposable`，都应该使用`using`.

**更新**（回应评论）：`using`应该围绕一个`IDisposable`类型的实例，假设在更大的范围内不需要它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T14:12:51.190

正确的做法是**总是`using`在类型实现接口时使用语句`IDisposable`，但要知道规则的异常**。

**已知异常**：

*   主窗体（Windows 窗体应用程序，因为它由`Application`类管理）
*   `SystemPens.*`, `SystemBrushes.*`（这些静态实例在内部缓存）
*   `Icons.*`（这些静态实例在内部缓存）
*   `Registry.*`（这些静态实例在内部缓存）
*   `AutoResetEvent`, `ManualResetEvent`（实际上应该被丢弃，但如果你这样做，请**非常**小心，因为它可能会导致赛车状况）

已知异常列表肯定不完整。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T13:58:36.647

每当您有一个需要确定性清理的资源时，即您希望它有机会在您完成后立即被“销毁”。

更详细地说，IDisposible 接口主要尝试解决.net 语言中缺少“删除”关键字的问题。因为 CLR 是垃圾回收器，所以您永远不知道对象的终结器（析构器）何时运行。在开始释放托管资源之前，GC 可以随意等待。

然而，许多托管资源包装了底层的有限资源——内存并不是唯一必须分配和释放的东西。如前所述，文件句柄是其中之一。数据库处理另一个 - 有无数的例子。为了避免不一致的清理习惯用法，IDisposible 模式用于说“请释放你的有限资源，我已经完成了它们”。因为它内置在框架中，它通过“使用”获得特殊的语言支持，以帮助确保您永远不会忘记调用 Dispose 方法，从而“泄漏”非托管资源。

这并不意味着*所有*IDisposible 实现者都应该包含在 using 中 - 如果您保留引用并且将来需要它们，您当然不应该包装它们，因为您会导致底层资源的过早释放。*仅*当您完成对象时才调用 Dispose ，因此仅当您知道在 using 范围结束后已完成该对象时才使用“using”。

因此，正如我们所料，具有确定性破坏的语言，例如 C++/CLI，不需要“使用”。非堆 C++/CLI 对象在超出范围时会自动调用其 Dispose 方法，从而模仿模式试图捕获的析构函数行为。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T13:58:37.347

不，MSDN 文章刚刚告诉您，在使用`IDisposable`对象时应该考虑使用它。有许多框架类实现`IDisposable`了 ，您肯定也会定义许多自己的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T14:22:41.573

简单的规则是“任何时候你有一个资源应该在使用后立即释放，而不是在未来某个未知的时刻，当垃圾收集器开始释放它时”。

所有有限的资源，基本上是非托管或托管的。文件、网络套接字、数据库连接、注册表句柄，任何不应该无限期地漂浮的东西。

# c# - VB.NET 中是否有 lock 语句？

> ID：915850
> 
> 赞同：79
> 
> 时间：2009-05-27T13:57:33.433
> 
> 标签：c#, vb.net

VB.NET 有相当于 C# 的`lock`语句吗？

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2009-05-27T14:00:44.723

是的，[SyncLock](http://msdn.microsoft.com/en-us/library/3a86s51t.aspx)语句。

例如：

```
// C#
lock (someLock)
{
    list.Add(someItem);
}

// VB
SyncLock someLock
    list.Add(someItem)
End SyncLock 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-05-27T14:00:54.037

它被称为 SyncLock 示例：

```
Sub IncrementWebCount()
    SyncLock objMyLock
        intWebHits += 1
        Console.WriteLine(intWebHits)
    End SyncLock
End Sub 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T14:00:29.217

是的，它叫做 SyncLock

# oracle - Oracle SYS 和 SYSTEM 帐户有什么区别？

> ID：915853
> 
> 赞同：27
> 
> 时间：2009-05-27T13:58:18.473
> 
> 标签：oracle, administration, database-administration

Oracle SYS 和 SYSTEM 内置帐户有什么区别？

编辑：除了3个字母！

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-27T15:01:04.977

SYS 拥有 oracle 数据字典。数据库中的每个对象（表、视图、包、过程等）都有一个所有者。对于数据库字典，以及一大堆特殊的表（性能视图等）都归SYS用户所有。

SYSTEM 用户应该是主 DBA 用户，可以访问所有这些对象。这反映了早期且长期的 Oracle 安全设计理念。您使用一个用户构建应用程序，然后创建具有访问权限（选择、更新、删除）但没有删除权限的第二个用户。这使您可以“超级用户”访问您的架构，而不会意外地破坏它。多年来，系统帐户中添加了可能需要在 SYS 帐户中的东西。但是，如果没有必要，很少有人愿意授予他们 SYS 帐户的访问权限。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-27T14:00:31.650

`SYS`可以`connect AS SYSDBA`，`SYSTEM`不能。

`SYSDBA`需要特权才能执行某些管理任务，例如`CREATE DATABASE`and `DROP DATABASE`，并查询任何表，尽管`GRANT`它们具有 'ed 权限。

事实上，每当您连接为 时`SYSDBA`，您就会成为`SYS`.

# security - 将浏览器插件的使用限制在特定的服务器上？

> ID：915860
> 
> 赞同：0
> 
> 时间：2009-05-27T13:58:37.987
> 
> 标签：security, browser, plugins

对于新的银行应用程序，我们目前正在讨论安装在客户端 PC 上用于访问智能卡读卡器的浏览器插件的详细信息。

出现的一个问题是：有没有办法将此插件的使用限制在指定的域列表中？它应该阻止任何第三方站点仅通过提供一些 <embed/object>-Tag 来使用该插件。

该解决方案应该基本上独立于浏览器。如有必要，它可能包括密码学，但只会在插件代码中导致适度的实现开销。

想法，有人吗？

* * *

我知道存在一个名为[SiteLock](http://www.microsoft.com/Downloads/details.aspx?FamilyID=43cd7e1e-5719-45c0-88d9-ec9ea7fefbcb&displaylang=en)的 MS 解决方案，但这只是 IE。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T14:15:15.067

您可以将授权域列表硬编码到插件本身中。

或者，您可以公开一个 Web 服务，该服务将提供授权域列表。该插件可以在实例化时调用您的 Web 服务以确定它是否可以启动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T12:14:11.350

我们提出了这个想法：（针对一台服务器进行描述）

插件带有公钥 A。插件创建者向服务器的公钥 B 颁发证书。服务器在 HTML 页面中启动插件并提供以下参数：

*   几个关联特定参数
*   证书
*   数字签名

然后插件将启动并首先执行这些检查：

*   使用插件中提供的公钥验证证书
*   使用证书中的公钥验证签名
*   如果验证正常，则继续，否则终止。

# ruby-on-rails - Rails 自动完成插件

> ID：915861
> 
> 赞同：1
> 
> 时间：2009-05-27T13:58:49.813
> 
> 标签：ruby-on-rails, autocomplete, textfield

我正在使用 auto_complete 插件，并通过在我的控制器中编写以下内容来获得一个简单的自动完成文本字段：

```
class PrivateMessagesController < ApplicationController
  auto_complete_for :role, :name 
```

在我看来，这是：

```
<label for="recipient">To:</label>
    <%= text_field_with_auto_complete :role, :name %> 
```

我现在想通过以下方式改进自动完成功能：

*   使用逗号作为标记器，允许在文本字段中插入多个自动完成项
*   投入条件。例如，仅显示符合特定条件的特定角色的名称
*   将每个自动完成项显示在垂直列表中，而不是简单地用空格分隔。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T19:06:44.437

尝试[简单的自动完成 Rails 插件](http://github.com/grosser/simple_auto_complete)，它增加了更多的灵活性，例如

```
autocomplete_for :post, :title do |items|
  items.map{|item| "#{item.title} -- #{item.id}"}.join("\n")
end 
```

并且它不引人注目，因此您可以添加自己的js来修改显示的项目

# java - 调度 Swingworker 线程

> ID：915873
> 
> 赞同：2
> 
> 时间：2009-05-27T14:00:29.857
> 
> 标签：java, swing, concurrency, scheduling, swingworker

我的 Swing 应用程序中有 2 个进程要执行，一个用于填充列表，一个用于对列表中的每个元素进行操作。我刚刚将 2 个进程移动到 Swingworker 线程中，以在执行任务时停止 GUI 锁定，并且因为我需要对多个列表执行这组操作，所以在第一个并发性上并不是一个坏主意地方。然而，当我刚跑

> fillList.execute();
> doStuffToList.execute();

doStuffToList 线程在空列表上运行（duh ...）。如何告诉第二个进程等到第一个进程完成？我想我可以将第二个进程嵌套在第一个进程的末尾，但我不知道，这似乎是一种不好的做法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T14:16:40.260

我想这样的事情会做到吗？

```
boolean listIsFull=false;
class FillListWorker extends SwingWorker<Foo,Bar>
{
    ...
    protected void done()
    {
        synchronized (listYouveBeenFilling)
        {
            listIsFull=true;
            listYouveBeenFilling.notifyAll();
        }
    }
    ...
}

class DoStuffToListListWorker extends SwingWorker<Foo,Bar>
{
    ...
    protected Foo doInBackground()
    {
        synchronized (listYouveBeenFilling)
        {
            while (!listIsFull)
            {
                try
                {
                    listYouveBeenFilling.wait();
                }
                catch (InterruptedException ie)
                {
                    // Don't worry, we'll just wait again
                }
            }
        }
    }
    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T15:10:09.793

> 如何告诉第二个进程等到第一个进程完成？我想我可以将第二个进程嵌套在第一个进程的末尾，但我不知道，这似乎是一种不好的做法。

您是否考虑过使用可调用对象和期货？它们听起来很适合这类事情（让 doStuffToList 在 Future.get() 而不是实际列表上工作，所以它会在调用 get 时准备好），除了整个 swingworker 业务......（将此视为建议而不是答案）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-12T05:09:06.767

我们有这样的东西：

```
private SwingWorkerExecutor swingWorkerExecutor;

//...

protected void runChain(List<SwingWorker<Void>> chainWorkers,
                        final SwingWorkerExecutor.RunAfter<Void> runAfter,
                        final SwingWorkerExecutor.RunOnError runOnError)
{
    final List<SwingWorker<Void>> remainingWorkers =
        chainWorkers.subList(1, chainWorkers.size());
    SwingWorkerExecutor.RunAfter<Void> chainRunAfter;
    if (chainWorkers.size() > 1)
    {
        chainRunAfter = new SwingWorkerExecutor.RunAfter<Void>()
        {
            @Override
            public void run(Void value)
            {
                runChain(remainingWorkers, runAfter, runOnError);
            }
        };
    }
    else
    {
        chainRunAfter = runAfter;
    }

    currentWorker = chainWorkers.get(0);

    swingWorkerExecutor.execute(currentWorker, chainRunAfter, runOnError);
} 
```

这很简单，IMO，因为在我们的例子中 SwingWorkerExecutor 实际上包含了所有难以理解的东西：

```
public class DefaultSwingWorkerExecutor implements SwingWorkerExecutor
{
    @Override
    public <T> void execute(SwingWorker<T, ?> worker, RunAfter<T> after,
                            RunOnError onError)
    {
        worker.addPropertyChangeListener(
            new RunAfterHandler<T>(worker, after, onError));
        worker.execute();
    }

    private static class RunAfterHandler<T> implements PropertyChangeListener
    {
        private final SwingWorker<T, ?> worker;
        private final RunAfter<T> after;
        private final RunAfter<Throwable> onError;

        protected RunAfterHandler(SwingWorker<T, ?> worker, RunAfter<T> after,
                                  RunOnError onError)
        {
            this.worker = worker;
            this.after = after;
            this.onError = onError;
        }

        @Override
        public void propertyChange(PropertyChangeEvent evt)
        {
            if ("state".equals(evt.getPropertyName()) &&
                evt.getNewValue() == SwingWorker.StateValue.DONE)
            {
                if (worker.isCancelled())
                {
                    return;
                }

                try
                {
                    after.run(worker.get());
                }
                catch (InterruptedException e)
                {
                    Thread.currentThread().interrupt();
                }
                catch (ExecutionException e)
                {
                    onError.run(e);
                }
            }
        }
    }
} 
```

有一些缺少的接口应该很直接地编写而不在这里看到它们。

我们真正的部署 SwingWorkerExecutor 使用注入的 ExecutorService 而不是默认的执行（这减少了单个应用程序所需的线程池数量。）但我们引入 SwingWorkerExecutor 的真正原因是它简化和标准化了 SwingWorker 成功和错误的处理条件并且还允许替换单元测试的逻辑（我相信你知道，如果它们是单线程的，那么它们会简单得多。）正如你所看到的，每个 SwingWorker 通常都需要一堆样板文件在 done() 内部，所以我们不这样做，而是将 done() 工作移到回调中。

附带的好处是像在一个链中运行多个 Swing 工作者这样的事情变得非常容易实现。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-27T15:04:15.750

要按顺序执行两个过程，传统上您只需调用一个方法，然后调用另一个方法（！）。

```
fillList();
doStuffToList(); 
```

或者可能是这样的：

```
doStuffToList(fillList()); 
```

如果您一次处理一个，您可能需要两个线程`BlockingQueue`之间有一个。您可能会通过多个 do-stuff 线程走得更远。

就 AWT 事件调度线程 (EDT) 而言，它只是在没有阻塞的情况下分离出一个动作，稍后会收到通知。

# xml - XML 数据结构，如“多选”

> ID：915878
> 
> 赞同：0
> 
> 时间：2009-05-27T14:00:46.597
> 
> 标签：xml, schema, xsd

我想知道如何使用 XML 和 Schema 轻松描述多选组合框？目前我正在使用这个定义：

```
<xs:element name="RefPartner">
    <xs:complexType>
        <xs:attribute name="isSalesRepresentative" type="xs:boolean"/>
        <xs:attribute name="isPolicyResponsible" type="xs:boolean"/>
        <xs:attribute name="isPolicyCorrespondanceResponcible" type="xs:boolean"/>
        <xs:attribute name="isAssetManager" type="xs:boolean"/>
        <xs:attribute name="isContactPerson" type="xs:boolean"/>
        <xs:attribute name="isLegalRepresentative" type="xs:boolean"/>
    </xs:complexType> 
```

但这个解决方案不好。

请写下你的想法，如何让它变得更好。谢谢。

# c# - C# WPF 应用程序因 System.FormatException 崩溃 - 损坏的 .resources 文件

> ID：915881
> 
> 赞同：1
> 
> 时间：2009-05-27T14:01:04.707
> 
> 标签：c#, .net, wpf, resources, formatexception

我从现在的前雇员那里继承了一个 C# .net WPF 应用程序，并且在运行该应用程序时遇到了一些困难。这一切都构建良好，没有一个错误或警告，但在 GUI 出现之前我得到一个错误：

> mscorlib.dll 中出现“System.FormatException”类型的未处理异常
> 
> 附加信息：损坏的 .resources 文件。索引“156”的名称位置在名称部分“0xab02”之外。

关于如何识别它是哪个 .resources 文件和/或如何重新创建它们的任何建议（我已经尝试构建所有这些都没有区别）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T08:21:40.943

好的，事实证明，虽然 Visual Studio 设置为使用 .net 框架的 v3.5，但您需要单独安装框架的 v3.5 - 看来我只安装了 v2。让这成为其他在同样问题上苦苦挣扎的人的一个教训！

# units-of-measurement - 数据库中计量单位的数据类型

> ID：915887
> 
> 赞同：3
> 
> 时间：2009-05-27T14:02:07.777
> 
> 标签：units-of-measurement

对于我的应用程序，我需要保留用户首选的测量单位。
目前可能的单位有：

*   升（我的数据库其余部分中的值存储的单位）
*   公斤（随产品的密度而异）
*   美国液体加仑（3.785411784 升）
*   美国液体夸脱（以上的 1/4）
*   英国液体加仑（4.54609 升）
*   英国液体夸脱（以上的 1/4）

我需要一种将这些单元保存在 mssql 2005（及更高版本）数据库中的方法，这样就不会有歧义，最好是所有应用程序都不会保留枚举，也不必创建额外的表。
使用 ISO 缩写将适用于前两个，但 AFAIK 没有后四个。
使用字符串表示也是自找麻烦..

那么除了最终与项目经理沟通不使用延迟测量单位之外，您还有什么其他建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T14:08:35.440

我知道您*不想*创建新表，但老实说，这是正确的做法™。添加一个带有外键引用的列，然后就这样做——它最终会更好地工作！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T14:11:14.373

我认为您需要重新考虑使用表格来存储这些值。主要原因是您希望从一种计量单位转换为另一种计量单位，并且您需要确定对您的应用程序很重要的有效位数。

如果你有一个表，那么你可以在记录中存储升到 X 的转换值。这将有助于保持所有其他应用程序同步，以减少舍入和比较问题。

# entity-framework - Entity Framework 和 Linq to Entities 和 .Include() 几个表，或者可能

> ID：915897
> 
> 赞同：2
> 
> 时间：2009-05-27T14:04:25.213
> 
> 标签：entity-framework, linq-to-entities, include

我有一个数据库，其中包含一个名为 PropertyValues 的表，其中存储了我需要描述数据库表行的某些属性的每个值。

例如，表 Products 看起来像这样：

> **ID**
> **OrderID** //Products 表与 Order 表相关
> **ProductName**
> **ProductType_ID** //PropertyValues 表的 ID，描述产品类型（食品、香水、化学品）
> **ProductCountry_ID** *//PropertyValues 表的 ID，它链接到产品来自的国家/地区* **ProductStatusID** *//也是 ID包含产品状态的 PropertyValues 表（可用，不可用）*

使用这样的数据库模型，要获得订单及其所有产品的类型、国家和状态，我将不得不编写如下内容：

```
var orders = from o in dbEntities.Order.Include("Products.ProductType")
                                       .Include("Products.ProductCountry")
                                       .Include("Products.ProductStatus")
            select o; 
```

问题是:)
可以自动完成（因此所有相关实体都将包括在内）
还是有更好的方法？

谢谢你 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T15:36:46.480

正如亚历克斯詹姆斯指出的那样，我认为您正在寻找的是“延迟加载”或“急切加载”。

这篇博文解释了“延迟加载”将在 Entity Framework 4.0 版中实现。

[http://blogs.msdn.com/adonet/archive/2009/05/12/sneak-preview-deferred-loading-in-entity-framework-4-0.aspx](http://blogs.msdn.com/adonet/archive/2009/05/12/sneak-preview-deferred-loading-in-entity-framework-4-0.aspx)

它可以自动完成，谷歌“实体框架延迟加载”去设置它。

# .net - 侦听正在使用的串行 Com 端口

> ID：915904
> 
> 赞同：19
> 
> 时间：2009-05-27T14:05:57.007
> 
> 标签：.net, serial-communication

我正在处理一些使用 RS232 与外围设备通信的遗留系统。我对 COM 接口不是很有经验。我有一些可以打开和使用 COM 端口的代码，但它无法打开其他应用程序使用的端口。我需要对数据包进行黑盒处理，以便我们可以使用相同的协议进行更新的通信。

**有没有办法将传入数据包“中间人”到打开的 COM 端口并检测正在发送的数据包？**我正在使用 .NET，但我愿意接受任何类型的解决方案。

（我在那里发现了[这个](http://com0com.sourceforge.net/)，但我认为这对我不起作用。）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-27T14:14:45.833

我用过 com0com——它非常适合设置虚拟 com 端口——这对你一点帮助都没有。

COM 端口接口基本上是“文件读取”。当我尝试连接到已经有另一个实例从中读取的 COM 端口时，我的应用程序会引发异常。我不确定您是否可以尝试将其打开为“只读”而不是读写，但值得一试。

您应该能够编写一个可以将您的数据分叉到日志文件的虚拟 com 端口。Com0com 是开源的，因此您可以将其作为起点。

另一种可能的解决方案是使用[rs232 分离器电缆](http://www.serialportsplitter.com/splitter.html?gr=ersps01&gclid=CMrq1OfX3JoCFSMSagodYDEJ2w)将串行信号分叉到另一个串行端口。

或者另一种可能性是[串行嗅探器程序](http://www.serialsniffer.com/en/index.php) （或[开源嗅探器](http://sourceforge.net/projects/slsnif/)）。

或者尝试来自同一个 com0com 网站的[hub4com 应用程序！](http://sourceforge.net/project/showfiles.php?group_id=129551&package_id=223131)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-01-19T15:49:02.527

> 有没有办法“中间人”

是的，有很多。通过“过滤器驱动程序”的概念在 Windows 中得到强烈支持。这样的驱动程序可以插入到获取 I/O 请求并查看经过的所有内容的驱动程序之前。通常用于更改 I/O 请求，但也非常适合简单地监视请求。中间的男人。

这种驱动程序的典型示例是古老[的 SysInternals 的 PortMon 实用程序](http://technet.microsoft.com/en-us/sysinternals/bb896644.aspx)。向您显示应用程序向/从串行端口发送和接收的所有内容，包括配置和数据。有很多这样的应用程序，只有谷歌“串口过滤驱动程序”（大量源代码示例）和“串口监视器”。

一个脚注，你在 64 位版本的 Windows 上确实会遇到问题。这些应用程序中的绝大多数，包括 PortMon，只能在 32 位版本上运行。64 位版本只允许安装经过认证的驱动程序，出售这些应用程序几乎没有钱来证明费用是合理的。购物时请注意这一点。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-27T15:52:03.047

我一直走在同样的道路上。硬件分离器是最简单的解决方案。

hub4com 设置将涉及“添加新硬件”向导。如果您有很多机器、地理位置分散的机器，或者技术不熟练且缺乏必要权限的用户，安装可能会很尴尬。

如果这是一个遗留应用程序，它是否在 ntvdm 中运行？如果是这样，您可以改为在[DosBox](http://www.dosbox.com/)中运行它，并更改 DosBox 代码以写入文件，以及向/从串行端口发送/接收。DosBox 也是跨平台的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-30T13:39:56.540

您还可以使用[TCPcom](https://sourceforge.net/projects/combytcp/?source=directory)将数据转换为以太网数据包，并使用 Wireshark 对其进行监控 - 并将其广播到其他地方。然后，您使用另一个 TCPcom 实例将其转发到您喜欢的任何 com 端口 - 包括虚拟 com 端口。现在您基本上已经通过以太网劫持了数据。 [https://sourceforge.net/projects/combytcp/?source=directory](https://sourceforge.net/projects/combytcp/?source=directory)

# python - django auth 用户截断电子邮件字段

> ID：915910
> 
> 赞同：9
> 
> 时间：2009-05-27T14:06:33.730
> 
> 标签：python, mysql, django, authentication

我对电子邮件 max_length 为 75 的 django.contrib.auth 用户模型有疑问。

我从 facebook api 收到长度超过 75 个字符的电子邮件地址，我需要（真的很想）将它们存储在用户中，以便来自 facebook connect 和其他用户的连续性。

我可以`Data truncated for column 'email' at row 1`通过手动编辑我们的 mySql 数据库中的字段来解决“”的问题，但是**有没有更好的方法来解决这个问题？**最好是**不涉及**每次我为架构更改重置数据库时手动编辑数据库？

只要我可以将它添加到重置脚本或 initial_data.json 文件中，我就可以编辑数据库。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-27T14:49:41.207

EmailField 75 字符长度在 django 中是硬编码的。你可以这样解决这个问题：

```
from django.db.models.fields import EmailField
def email_field_init(self, *args, **kwargs):
  kwargs['max_length'] = kwargs.get('max_length', 200)
  CharField.__init__(self, *args, **kwargs)
EmailField.__init__ = email_field_init 
```

但这会更改所有 EmailField 字段的长度，因此您也可以尝试：

```
from django.contrib.auth.models import User
from django.utils.translation import ugettext as _
from django.db import models
User.email = models.EmailField(_('e-mail address'), blank=True, max_length=200) 
```

两种方式都最好在 INSTALLED_APPS 中的 django.contrib.auth 之前将此代码放在任何模块的 init 中

从 Django 1.5 开始，您可以使用自己的基于 AbstractUser 模型的自定义模型，因此您可以使用自己的字段和长度。在您的模型中：

```
from django.contrib.auth.models import AbstractUser
from django.db import models

class User(AbstractUser):
    email = models.EmailField(_('e-mail address'), blank=True, max_length=200) 
```

在设置中：

```
AUTH_USER_MODEL = 'your_app.models.User' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-28T19:04:45.250

现在有一张在 Django 中增加 email 字段长度的票：http: [//code.djangoproject.com/ticket/11579](http://code.djangoproject.com/ticket/11579)

# c++ - ipv6 向后兼容 ipv4 吗？

> ID：915914
> 
> 赞同：1
> 
> 时间：2009-05-27T14:07:00.420
> 
> 标签：c++, udp, ipv6, ipv4

我有一个使用 ipv4 编写的小 udp 示例程序。如果我将代码更改为 ipv6，我是否仍然能够与使用具有 ipv4 地址的侦听器的任何人通信？我正在查看移植示例

[http://ou800doc.caldera.com/en/SDK_netapi/sockC.PortIPv4appIPv6.html](http://ou800doc.caldera.com/en/SDK_netapi/sockC.PortIPv4appIPv6.html)

我不确定简单地更改代码是否可以确保它工作，或者我是否必须以决斗堆栈模式编写它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T14:24:39.120

是也不是... IPv6 确实包含完全不同的寻址，因此您必须重新编码您的应用程序以使用替代标头和结构大小。

但是，IPv4 地址范围在 IPv6 中可用，语法是在标准地址前添加两个冒号（例如 ::10.11.12.13）。您还可以[在 IPv6 数据包中嵌入 IPv4 地址](http://www.tcpipguide.com/free/t_IPv6IPv4AddressEmbedding.htm)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-02T19:15:07.897

并非没有网络中[IPv4/IPv6 网关](https://datatracker.ietf.org/doc/html/draft-baker-behave-v4v6-framework)的帮助，即使如此，通信也会受到网络地址转换网关引入的[典型问题的限制。](https://www.rfc-editor.org/rfc/rfc3424)对于面临此类决策的程序员，传统的建议是建议同时支持 IPv4 和 IPv6。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T14:18:13.080

IPv4 和 IPv6 本质上是互不兼容的。
几个基本原因：

*   地址空间完全不同（IPv6 有 128 位地址，IPv4 有 32 位地址）
*   IPv6 的协议头看起来不像 IPv4 的协议头。如果您尝试将 IPv6 数据包解析为 IPv4，那么您会胡说八道。

这些明显的结果是，如果您打开 IPv6 套接字，则无法使用 IPv4 套接字收听它。

# oracle - 在 WAN 上具有许多绑定变量的 oracle 插入非常慢

> ID：915922
> 
> 赞同：3
> 
> 时间：2009-05-27T14:08:45.080
> 
> 标签：oracle, networking, performance, wan, sqlbindparameter

我们遇到了使用 40 个绑定变量作为列值的慢速插入语句的问题。它在 WAN 链接上运行时会运行几秒钟，我们无法确定问题，直到我们使用网络分析器。这个准备好的查询的每次执行都需要在客户端和服务器之间交换超过 120 个数据包才能完成。我们可以做些什么来更有效地执行它？

当我使用来自同一主机的实际参数（没有绑定变量）运行相同的插入时，它会在数十毫秒内完成。参数没有什么特别之处，只有简短的 varchars 和数字。

我们正在使用带有 ODAC 的 Delphi 6，我们尝试了各种版本的 ODAC 和 Oracle 客户端，但均无济于事。在服务器端，我们尝试了 Oracle 10 和 11。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T14:14:56.003

`TNS`不是设计得很好用`WAN`。

如果可能，请重写您的应用程序以使用其他网络层，例如`HTTP`，这样更有效。

例如，您可以使用 来完成[`Oracle HTTP Server`](http://www.oracle.com/technology/products/ias/ohs/index.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-24T14:01:51.870

你看过[外部表](http://www.dba-oracle.com/art_ext_tabs.htm)吗？替代 SQL Loader 需要 Oracle 9i 或更高版本

# perl - 如何从 Perl 中不断更新的文件中读取？

> ID：915926
> 
> 赞同：3
> 
> 时间：2009-05-27T14:09:26.250
> 
> 标签：perl

问候，我想通读一个文件，进入睡眠状态，然后检查是否有新记录写入文件。如果是，我想处理记录，如果不是，就回去睡觉，稍后再检查（在一个永远循环中）。

我以为我可以做这样的事情，但是在它第一次读取文件之后，它似乎永远不会拿起添加到文件中的新记录。

```
open (LOG, "<log_file") or die ("could not open log_file");

for (;  ;)   
{  
  print "Record Number == $.\n";   

  while ($text=<LOG>)     
  {                       
    chomp ($text);
    print "$text\n";
  }
  sleep (60);

}

close (LOG); 
```

最初读取文件后，上面的脚本只是不断打印文件中最后一条记录的记录号。我看到一些关于可用的 TailFile 包的信息，但似乎我没有它，此时很难加载。我希望有一个普通的 perl 解决方案。

提前致谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-27T14:23:09.687

[File::Tail](http://search.cpan.org/perldoc?File::Tail)是你的朋友。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-27T14:26:14.500

那是因为当文件句柄返回 EOF 时，您的 while 循环将终止。您需要在阅读之前清除 EOF 标志。

在 while 循环和睡眠之后使用 seek。

```
seek(LOG, 0, 1); 
```

字面意思是：从当前位置移动零字节。它不会在文件中前进，但会为下一次读取清除 EOF 条件。

您还可以使用 IO::Handle 模块并调用 clearerr();

```
use IO::Handle;
# ...
LOG->clearerr(); 
```

最后，如果您愿意使用捆绑的文件句柄，您可以尝试 CPAN 上的 File::Tail 模块。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T02:54:37.983

Perl FAQ 涵盖了这一点。有关完整条目，请参阅[perldoc -q tail](http://perldoc.perl.org/perlfaq5.html#How-do-I-do-a-%27tail--f%27-in-perl%3f)。如果您愿意安装[CPAN](http://search.cpan.org)模块，您应该考虑[File::Tail](http://search.cpan.org/dist/File-Tail/Tail.pm)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-10-27T10:11:14.443

@jmanning2k，您是否有处理此问题的链接？perl 食谱有以下内容，看起来很弱......

```
为了 （;;） {
     尽管 （） { .... }
     睡觉 $SOMETIME;
     寻找(FH, 0, 1);
 }
```

或 IO::Handle 模块的 clearerr 方法：

```
使用 IO::Seekable；
为了 （;;） {
     尽管 （） { .... }
     睡觉 $SOMETIME;
     FH->clearerr();
 }
```

# html - 将链接放在顶部

> ID：915935
> 
> 赞同：0
> 
> 时间：2009-05-27T14:11:36.543
> 
> 标签：html, ruby-on-rails, hyperlink

当链接指向的 URL 直到页面稍后才确定时，如何将链接放在页面顶部。在此示例中，我想将 Create 和 Edit Scenario 链接移至页面顶部，但正如您所见，Edit Scenario 取决于首先知道 @scenario_id。

```
<%= will_paginate @scens, :next_label => 'Older', :prev_label => 'Newer' %>
<div class="box">

<% for scenario in @scens %>
    <% @created = scenario.created_at %>
    <% @updated = scenario.updated_at %>
    <% @scenario_id = scenario.id %>
    <% if scenario.scenario_image.exists? %> 
        <%= scenario_image_tag(scenario) %>
    <% end %>
  <%= simple_format(scenario.description) %>
<% end %>
</div>

<% if session[:role_kind] == "controller" %>
    <p>
    <%= button_to "Create new scenario", :action => "create" %>
    <% if @scens.size > 0 %>
        <%= button_to "Edit scenario", :action => "edit", :id => @scenario_id %>
    <% end %>
    </p> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T14:29:33.293

您可以在顶部添加链接，但您需要稍后以编程方式访问它，然后将 URL 分配给它。这需要某种参考或查找能力，我在想客户端javascript，但那是因为我不了解Ruby。

或者，您可以稍后在拥有 URL 时创建链接，并使用 CSS 定位将链接放在顶部。页面上所有 DOM 元素的实际位置不必与它们呈现的顺序相匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-03T07:22:27.810

我不明白。为什么要在视图层创建模型？为什么不在控制器中创建模型变量？某事喜欢：

```
class your_controller
  def your_method
    @scenario_id = ...
  end
end 
```

我认为您的问题在于无效的 MVC 使用。你不认为所有的@member @variables 都应该在视图开始渲染之前初始化吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T00:29:26.107

一种方法是使用助手：

在您的 helper.rb 文件中：

```
def stack_example(scens, &block)
  html = 'Scenario Details'
  edit_link = 'Edit Link'
  yield html, edit_link
end 
```

然后在你的部分你可以有类似的东西：

```
<% stack_example(@scens) do |html, edit_link| %>
  <%= edit_link %><br>
  <%= html %>
<% end %> 
```

应输出以下内容：

```
Edit Link
Scenario Details 
```

# silverlight-3.0 - Ria Services - 延迟加载图像（或任何重的二进制数据）

> ID：915936
> 
> 赞同：0
> 
> 时间：2009-05-27T14:11:49.367
> 
> 标签：silverlight-3.0, wcf-ria-services

我有一个 RIA 服务，它从 SQL Server 返回图像数据 (Byte[]) 和图像标题 (String)。

数据部分有时可能只有几 MB，因此可能需要很长时间才能加载。

我想独立于标题（加载速度非常快）加载字节。

有没有办法做到这一点而不必创建第二个图像上下文？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-05T09:24:58.503

每个域服务调用都是异步执行的，因此如果您有两个调用，一个用于数据，另一个用于标题，您应该能够在数据仍在加载时显示标题。

这确实意味着您必须拥有两个独立的实体，ImageTitle 和 ImageName，但是也许您可以以某种方式将它们链接起来，也许是一个容器实体？

# perl - 如何将参数从一个 Perl 脚本传递到另一个？

> ID：915937
> 
> 赞同：2
> 
> 时间：2009-05-27T14:11:55.403
> 
> 标签：perl

我有一个我运行的脚本，在它运行之后它有一些我需要传递给下一个脚本运行的信息。

Unix/DOS 命令如下：

```
perl -x -s param_send.pl
perl -x -s param_receive.pl 
```

param_send.pl 是：

```
# Send param

my $send_var = "This is a variable in param_send.pl...\n";
$ARGV[0] = $send_var;
print "Argument: $ARGV[0]\n"; 
```

param_receive.pl 是：

```
# Receive param

my $receive_var = $ARGV[0];
print "Parameter received: $receive_var"; 
```

但是什么都没有打印。我知道我做错了，但是从教程中我无法弄清楚如何将参数从一个脚本传递到下一个脚本！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-27T14:40:24.160

您可以在命令行上使用管道字符将第一个程序的标准输出连接到第二个程序的标准输入，然后您可以写入（使用`print`）或读取（使用`<>`运算符）。

```
perl param_send.pl | perl param_receive.pl 
```

如果您希望第一个命令的输出作为第二个命令的参数，您可以使用 xargs：

```
perl param_send.pl | xargs perl param_receive.pl 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T14:52:12.683

Perl 中的[%ENV](http://perldoc.perl.org/perlvar.html#$ENV%7Bexpr%7D)散列包含环境变量，例如 PATH、USER 等。对这些变量的任何修改都“仅”反映在当前进程和它可能产生的任何子进程中。父进程（在这个特定实例中恰好是 shell）不反映这些更改，因此当“param_send.pl”脚本结束时，所有更改都将丢失。

例如，如果你要做类似的事情，

```
#!/usr/bin/perl
# param_send.pl
$ENV{'VAL'} = "Value to send to param_recv";

#!/usr/bin/perl
# param_recv.pl
print $ENV{'VAL'}; 
```

这不起作用，因为当 param_send 退出时 VAL 丢失。一种解决方法是从 param_send.pl 调用 param_recv.pl 并将值作为环境变量或参数传递，

```
#!/usr/bin/perl
# param_send.pl
$ENV{'VAL'} = "Value to send to param_recv";
system( $^X, "param_recv.pl");

OR

#!/usr/bin/perl
# param_send.pl
system( $^X, qw(param_recv.pl 'VAL') ); 
```

其他选项包括管道输出，或者您可以查看这个[Perlmonks 节点](http://www.perlmonks.org/?node_id=684685)以获得更深奥的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T14:42:24.500

`@ARGV`在运行时创建并且不会持续存在。因此，您的第二个脚本将无法看到`$ARGV[0]`您在第一个脚本中分配的内容。正如[crashmstr](https://stackoverflow.com/users/1441/crashmstr)指出的那样，您要么需要使用[许多方法](http://www.perlhowto.com/executing_external_commands)之一从第一个脚本执行第二个脚本。例如：

```
my $send_var = "This is a variable in param_send.pl...\n";
`perl param_receive.pl $send_var`; 
```

或使用 %ENV 使用环境变量：

```
my $send_var = "This is a variable in param_send.pl...\n";
$ENV['send_var'] = $send_var; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2010-12-04T09:10:00.290

对于更高级的解决方案，请考虑使用[套接字](http://www.perlfect.com/articles/sockets.shtml)或[IPC](http://perldoc.perl.org/perlipc.html)。

# c# - 小数和小数的区别

> ID：915938
> 
> 赞同：31
> 
> 时间：2009-05-27T14:12:08.727
> 
> 标签：c#, class

如果有人可以向我解释 C# 中 Decimal 和 decimal 之间的区别，那就太好了。

以更一般的方式，小写结构（如 decimal、int、string）与大写类 Decimal、Int32、String 之间有什么区别。

大写类也包装函数（如 Decimal.Divide()）的唯一区别是什么？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-05-27T14:12:51.890

他们是一样的。十进制类型是 System.Decimal 的别名。

所以基本上十进制与十进制是一样的。使用哪一个取决于用户的偏好，但大多数人更喜欢使用 int 和 string，因为它们更容易键入并且在 C++ 程序员中更熟悉。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-11-26T17:07:45.567

由于 C# 是一种 .NET 语言，因此所有类型都必须映射到 .NET Framework 类型。

要回答您的第一个问题，decimal 是 System.Decimal .NET Framework 类型的别名。它们可以互换使用。

要回答您的第二个问题， Decimal 和 decimal 都应该扩展相同的函数，包括来自创建的变量和值类型本身的“结构”。

```
decimal FirstDec = 12;
Decimal SecondDec = 13;
decimal ThirdDec = decimal.Ceiling(FirstDec, SecondDec);
Decimal FourthDec = Decimal.Floor(ThirdDec);
bool isEqual = FirstDec.Equals(SecondDec) && FourthDec.Equals(ThirdDec); 
```

下面的[MSDN Page for Built-In Types](http://msdn.microsoft.com/en-us/library/ya5y69ds%28v=vs.110%29.aspx)将显示`System.ValueType`每个别名映射到哪个。特别是`Decimal`，`decimal`您可以参考这个[MSDN Page for Decimal](http://msdn.microsoft.com/en-us/library/system.decimal.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T14:26:28.370

[内置的 C# 类型](http://msdn.microsoft.com/en-us/library/ya5y69ds.aspx)并不都是 structs*。它们是 System 命名空间中预定义类型的别名。[除了格式化之外](https://stackoverflow.com/questions/457705)，它们在所有方面都是相同的。别名类型是小写的，格式类似于关键字（深蓝色）。系统类型是 PascalCased 并且格式类似于类型（浅蓝色）。

* * *

*`object`并且`string`是类

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T14:19:30.410

十进制、整数、字符串都只是简写符号，让您的事情更容易/更漂亮。该框架并不真正知道“十进制”是什么，但它确实知道 System.Decimal，因此当您编译代码时，十进制就变成了 System.Decimal。尝试查看所有类型都完全限定的代码，然后尝试查看使用别名的代码，我认为大多数程序员会更喜欢更紧凑的别名并认为它更易于阅读。我还认为这可能是对 C/C++ 的一种回归，以使过渡更容易。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-05-19T07:29:03.763

如果 C# 不区分大小写，那么有些人会像在 Cobol 和 VB 中那样以全大写形式编写应用程序。这将使开发人员无法阅读和维护代码。区分大小写是设计人员为帮助使语言更易于使用所做的努力。

# python - Python 绘图库

> ID：915940
> 
> 赞同：47
> 
> 时间：2009-05-27T14:12:30.003
> 
> 标签：python, plot, matplotlib

pylab 有哪些替代方法可以在 Python 中绘图？特别是，我正在寻找不使用[pylab](http://en.wikipedia.org/wiki/Matplotlib)所做的有状态模型的东西。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2013-04-29T01:11:19.183

[Plotly](https://plotly.com/)允许您使用[Python API](https://plotly.com/graphing-libraries/)、[matplotlib](https://plotly.com/python/matplotlib-to-plotly-tutorial/)和[pandas](https://plotly.com/ipython-notebooks/big-data-analytics-with-pandas-and-sqlite/)制作图形。他们的[IPython 画廊](https://plotly.com/ipython-notebooks/)有一些示例科学图表以及生成它们的 Python 脚本。

这是一个示例：

![在此处输入图像描述](https://i.stack.imgur.com/TEO2z.jpg)

## 最近一些令人兴奋的开源产品：

*   [ggplot](https://github.com/yhat/ggpy)基于 R 的 ggplot2，具有美观的默认值和非常简洁的 api。**想成为 matplotlib 杀手**

![ggplot 示例](https://raw.githubusercontent.com/yhat/ggplot/77dc1cf032de1cf00286942a513de92ebea24963/public/img/density_with_fill.png)

*   [bokeh](https://docs.bokeh.org/en/latest/)制作交互式（html 画布）图。**强调交互性+处理大数据**

![散景示例](https://i.stack.imgur.com/MtmEh.png)

*   [vega](https://github.com/vega/vega)将 JSON“绘图描述”转换为**SVG 或基于 Canvas 的交互式绘图**，而[vincent](https://github.com/wrobstory/vincent)是用于生成 JSON 规范的声明性接口。

[![织女星的例子](https://i.stack.imgur.com/CZRcW.png)](https://i.stack.imgur.com/CZRcW.png)
[（来源：[fastly.net](https://github-camo.global.ssl.fastly.net/cf082a202b608048a1e5160f97eaa0597fd38e74/687474703a2f2f74726966616374612e6769746875622e636f6d2f766567612f696d616765732f626172312e706e67)）]

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-05-27T14:26:13.580

[Python wiki](http://wiki.python.org/moin/)上有一个[基于 Python 的绘图工具列表](http://wiki.python.org/moin/NumericAndScientific/Plotting)。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-05-27T14:21:58.953

[您始终可以使用Matplotlib](http://en.wikipedia.org/wiki/Matplotlib)的面向对象框架而不是 pylab 接口。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-27T19:24:45.723

我使用[Gnuplot.py](http://gnuplot-py.sourceforge.net/)取得了巨大的成功。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-07-05T07:23:08.667

我需要 Python 3 的 gnuplot 接口，但什么也没找到。所以我已经将 Gnuplot.py 移植到它上面。[在[repository]](https://github.com/oblalex/gnuplot.py-py3k)​​的“自述文件”中查看更多信息。希望这将有助于将来的其他人。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-05-26T16:22:56.847

还有一个旧程序用于自动读取、过滤、处理、插值和绘制来自不同来源（如 libreOffice 或 csv 文件）和可变大小的 n 维值： [diaGrabber](http://radjkarl.github.io/diaGrabber/)。

您必须使用一些简单的 python 命令来创建案例。在此之后，您可以在交互式[GUI](http://i.stack.imgur.com/AfCMH.png)中操作图形输出。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-09-05T10:40:02.310

您可以使用简单[的 gplot](http://pyla.codeplex.com)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-06-08T05:24:15.487

[MathGL](http://mathgl.sf.net/)是具有大量图形类型的免费 (GPL) 绘图库，并且也具有 Python 接口（也可以使用 numpy 数组）。

# c# - 在c#中自动查看哪些函数可能返回异常的方法

> ID：915941
> 
> 赞同：7
> 
> 时间：2009-05-27T14:12:37.710
> 
> 标签：c#, exception, detection

没有什么比在调试器中看到您的代码在一个异常的方法上崩溃并且您没有尝试/捕获它更令人沮丧的了。

是否有一种简单的方法可以扫描您的源代码并标记所有可能引发异常的函数？

内置视觉辅助是否有一些隐藏的选项可以用特定颜色为这些功能着色？

谢谢

R

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T14:15:00.403

除了最琐碎的代码外，所有代码都可能引发异常（至少内存不足）。您最好防御性地编写代码，至少使用全局 try/catch，而不是尝试微观管理哪些代码段将或不会引发异常。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-27T14:16:54.987

不，没有办法自动执行此操作，也没有一种好方法可以获取方法引发的所有可能异常的列表。这里有几个原因

1.  考虑隐式抛出的异常，例如 StackOverflowException 可以随时从任何方法抛出。您必须假设 CLR 中的任何方法都可以抛出这些类型的异常
2.  反射和/或委托可以隐藏在特定方法中调用的实际代码，因此您无法检查方法的所有可能代码路径。
3.  这将需要检查 IL 与元数据。
4.  在 .Net 中，不需要记录 API 显式抛出的异常

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-27T14:18:22.863

我认为 redgate 为这个“异常猎人”提供了一些工具，他们在试用后收费。

[http://www.red-gate.com/products/Exception_Hunter/index.htm](http://www.red-gate.com/products/Exception_Hunter/index.htm)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T14:27:13.873

正如其他人所说，我不确定您是否会在 C# 中找到一种万无一失的方法，因为它不支持检查异常。

顺便说一句，这让我想起了 Anders Hejlsberg 的一次采访，讨论“[检查异常的麻烦](http://www.artima.com/intv/handcuffs.html)”。我并不是要激怒检查的异常，而是建议您阅读 Ander 的 C# 异常设计背后的基本原理以及处理异常的建议方法：集中式异常处理。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T14:15:36.767

我认为 resharper 会为您提供有关异常的提示。但是由于 C# 不支持检查异常的原因，有办法确定异常。也许像 NDepend 之类的代码分析工具支持这一点。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-27T14:15:58.780

一切都可以抛出异常。查看 MSDN 以获取方法可以抛出的异常列表。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-27T14:17:53.423

所有非空方法都可以以一种或另一种形式抛出异常。如果您担心自己生成的异常，您可以从智能感知中显示它们，就像框架方法通过 XML 文档一样，如下所示：

```
/// <summary>  
/// I seem to have written a method to do a thing.
/// </summary>  
/// <exception cref="System.Exception">An unfortunate failure.</exception>
public void DoSomething()
{
   /* ... */
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-27T14:29:48.330

任何代码都可能导致异常，您的工作是尝试并预测这一点！

有许多第三方工具可以帮助查找一些常见错误，例如 fxcop 和重构等工具可以提出建议。

目前已经完成了一些工作，可以帮助您找到潜在的异常。查看 PEX，它可以帮助为您的函数生成测试：research.microsoft.com/en-us/projects/Pex/（链接在发布时似乎已关闭）

另一个令人兴奋的领域是代码合同（在 .net 4 中/作为规范#提供）。代码契约允许您编写指定必须满足的条件的语句。这些可以在你的函数被调用之前和之后，你也可以声明不变量。条件可能像 value != null 这样简单。然后在编译和运行时分析这些条件，以检查没有代码路径违反它们。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-27T15:10:06.220

正如其他人所说，您应该假设每一行代码都可以引发异常，除非您已经证明它不能。更好的问题是，“你打算怎么做？”

通常，您根本不应该捕获任何异常。

当然，其他一切都是该规则的例外。捕获异常以便记录它是有意义的（如果您的环境不为您这样做，就像 ASP.NET 那样）。捕获异常以将其替换为提供有关上下文的更多详细信息的另一个异常是有意义的：

```
public int GetConfiguredInteger(string name) {
    string s = null;
    try {
        s = GetStringFromConfigFile(name);
    }
    catch (IOException ex) {
        throw new Exception(String.Format(
            "Error in configuration file foo.config when processing {0}", name),
            ex);
    }
    return int.Parse(s);
} 
```

如果您没有告诉调用者，调用者不可能知道 IOException 是由配置文件引起的。还要注意我如何忽略与文件 I/O 无关的所有异常。特别要注意 int.Parse 甚至不在 try/catch 块内。

还有少量其他此类异常，但捕获异常的基本思想是：除非不这样做会更糟，否则不要这样做。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-27T14:19:49.070

[异常查找](http://www.softpedia.com/get/Programming/Other-Programming-Files/ExceptionFinder.shtml)器中有一个反射器添加 ，它将显示方法可能引发的异常。我没有使用它，但在 .Net 用户组会议上看到了它的一个示例。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-27T14:20:21.907

有一个工具可以做到这一点。您可以下载试用版，看看您是否喜欢它。我真的不认为这有必要，但如果你在一家公司工作并且他们会为此付出代价，你可能想要调查一下。就像之前所说的那样，有太多可能的例外被提出。查看[Excpetion Hunter](http://www.red-gate.com/products/Exception_Hunter/index.htm "异常猎人")

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-27T14:22:17.910

我发现打破外部 catch 块并挖掘到异常发生的实际点更令人沮丧。

大多数情况下，如果抛出异常并且我没有预料到它，我发现了一个错误，如果它没有被一些无所事事的异常处理混淆，那么解决它会更容易。

**编辑：** 由于您的示例实际上是一个很好的示例，因此我仍然不相信这样的工具会对您有所帮助。会有很多可能的异常，实际上每一行代码都可能抛出，你很难找到“有趣”的异常。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-27T14:50:08.197

少数人提到的 Exception Hunter 是一个很好的工具来帮助解决这个问题。我不知道它是否与`<exception>`XML-Doc 注释有关联，以便您可以强制记录代码引发的异常。

# mod-rewrite - Apache RewriteRule 标志错误

> ID：915949
> 
> 赞同：2
> 
> 时间：2009-05-27T14:13:56.787
> 
> 标签：mod-rewrite, apache2

我在使用以下代码时遇到问题：

```
Options FollowSymLinks
RewriteEngine on
RewriteRule ^thing/([^/]+)/?$  index.php?t=$1 [B] 
```

我收到“500 内部服务器错误”

错误日志说：

```
RewriteRule: unknown flag 'B' 
```

我检查了我的 Apache 版本：

```
[root@server ~]# httpd -v
Server version: Apache/2.2.3
Server built:   Jan 21 2009 22:00:55 
```

我错过了什么？

（注意：页面加载时没有 [B] 标志）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T14:24:47.670

[B] 是 2.2.7 中的新功能。

# c# - WPF Listview 数据绑定

> ID：915955
> 
> 赞同：1
> 
> 时间：2009-05-27T14:15:30.183
> 
> 标签：c#, wpf, listview, data-binding

我有一个列表视图，其中有一列数据绑定到列表。计数见下文：

```
<ListView.View>
    <GridView>
        <GridViewColumn Header="Contacts" DisplayMemberBinding="{Binding Path=Contacts.Count}"/>
        <GridViewColumn Header="Notes" DisplayMemberBinding="{Binding Path=Notes.Count}"/>
    </GridView>
</ListView.View> 
```

该列表实现 INotifyCollectionChanged。但是当我将一个项目添加到列表中时，listview 列不会被刷新。我在装订中做错了吗？我可以执行以下操作：

```
 void _Contacts_CollectionChanged(object sender, System.Collections.Specialized.NotifyCollectionChangedEventArgs e)
    {
        OnPropertyChanged("Contacts");
    } 
```

这基本上引发了集合的 PropertyChanged 事件。这迫使 wpf 重新绑定，但我宁愿没有大量的事件通过我的代码（尤其是不必要的事件）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T14:21:04.637

问题是，当您为 Contacts 引发属性更改时，您不会为 Count 属性引发事件。

你可以解决这个问题

```
OnPropertyChanged("Count") 
```

在您的列表中，因为您的列表实现了 INotifyPropertyChanged 接口...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T14:38:04.837

或者，您可以改为从 ObservableCollection 派生。它内置了所有更改通知代码，从长远来看可以为您节省一些时间。

# android - 如何控制 Android 视图中的轨迹球行为？

> ID：915960
> 
> 赞同：0
> 
> 时间：2009-05-27T14:16:39.043
> 
> 标签：android, view, custom-controls, trackball

我有一个 FrameLayout 视图，其中包含一个（类似 MapView）控件和一些覆盖它的附加按钮。（布局xml如下）。

我想让用户不仅使用触摸而且还使用轨迹球来平移/滚动主视图。问题是 - 使用轨迹球只是在布局上的所有控件之间切换焦点，我似乎找不到将**onTrackballEvent**包含到 MainView 的方法。

欢迎任何建议，在此先感谢。

```
<?xml version="1.0" encoding="utf-8"?>

<merge xmlns:android="http://schemas.android.com/apk/res/android"   
    android:layout_width="fill_parent" android:layout_height="fill_parent">
<FrameLayout android:id="@+id/pageView" 
    xmlns:panel="http://schemas.android.com/apk/res/com.yappa"
      xmlns:android="http://schemas.android.com/apk/res/android"
  android:layout_width="fill_parent"
  android:layout_height="fill_parent">

    <MainView
        android:id="@+id/mainView" 
        android:layout_width="fill_parent"
        android:layout_height="wrap_content">
    </MainView>

    <ZoomControls android:id="@+id/ZoomControls01"
        android:layout_gravity="bottom|center"
        android:layout_height="wrap_content" android:layout_width="wrap_content">
    </ZoomControls>

    <Panel
          ....
    </Panel>

</FrameLayout>

</merge> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-09T10:46:16.557

诀窍是`dispatchTrackball`在您的自定义视图中覆盖，并获取事件。

我希望这可以帮助别人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-05-20T19:58:22.930

平移只是通过之前提到的 focusable 属性实现的，将 mapview 的 focusable 属性设置为 true ，当您将 mapview 置于焦点时，它确实会使用轨迹球平移地图。

# flash - 无法控制的跳跃 - sIFR 滞后

> ID：915965
> 
> 赞同：0
> 
> 时间：2009-05-27T14:18:10.897
> 
> 标签：flash, sifr, image-replacement

sIFR 替换的文本正常显示，隐藏常规文本没有问题。但是，每次在我正在开发的网站上加载页面时，被替换的文本需要永远（即永远在互联网时间）加载，并在页面上垂直跳转，并在最终固定到位之前有很长的延迟。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-29T14:50:46.590

我想我会改用Cufon。该解决方案根本没有帮助我 - 我经常看到同样的问题，但没有确定的、100% 有效的解决方案。减少加载时间也无助于跳跃，这是我在留言板等上经常看到的另一个 sIFR 问题。

# xml - 在 emacs XML 模式下，如何格式化 XML 模式文件？

> ID：915970
> 
> 赞同：3
> 
> 时间：2009-05-27T14:18:38.650
> 
> 标签：xml, emacs, xsd, elisp, code-formatting

我想自动格式化 XML 模式定义文件。所有正常的漂亮打印内容：结束元素后的换行符，缩进。我已经看过[这个答案](https://stackoverflow.com/questions/12492/pretty-printing-xml-files-on-emacs)和[这个 elisp](http://blog.bookworm.at/2007/03/pretty-print-xml-with-emacs.html)，它为我提供了基础知识。但是，除了那里的内容之外，我还想在尖括号内的属性之间换行。

像这样。前：

```
<s:schema elementFormDefault="qualified" targetNamespace="urn:Cheeso.2009.05.Finance/TransferObject/TransactionDetail/" xmlns:tns="urn:Cheeso.2009.05.Finance/TransferObject/TransactionDetail/"  xmlns:detail="urn:Cheeso.2009.05.Finance/TransferObject/TransactionDetail/"  xmlns:to="urn:Cheeso.2009.05.Finance/TransferObject/"  xmlns:s="http://www.w3.org/2001/XMLSchema" xmlns:address="urn:Cheeso.2009.05.Finance/TransferObject/Address/" xmlns:caller="urn:Cheeso.2009.05.Finance/TransferObject/Caller/" xmlns:gwy="urn:Cheeso.2009.05.Finance/TransferObject/Gateway/" xmlns:tender="urn:Cheeso.2009.05.Finance/TransferObject/Tender/"  >
 ...
</s:schema> 
```

后：

```
<s:schema
    elementFormDefault = "qualified"
    targetNamespace    = "urn:Cheeso.2009.05.Finance/TransferObject/TransactionDetail/"
    xmlns:tns          = "urn:Cheeso.2009.05.Finance/TransferObject/TransactionDetail/"
    xmlns:detail       = "urn:Cheeso.2009.05.Finance/TransferObject/TransactionDetail/"
    xmlns:to           = "urn:Cheeso.2009.05.Finance/TransferObject/"
    xmlns:s            = "http://www.w3.org/2001/XMLSchema"
    xmlns:address      = "urn:Cheeso.2009.05.Finance/TransferObject/Address/"
    xmlns:caller       = "urn:Cheeso.2009.05.Finance/TransferObject/Caller/"
    xmlns:gwy          = "urn:Cheeso.2009.05.Finance/TransferObject/Gateway/"
    xmlns:tender       = "urn:Cheeso.2009.05.Finance/TransferObject/Tender/"  >
 ...
</s:schema> 
```

任何人都可以建议一些可以排列 = 的 elisp 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T15:16:44.447

尝试以下操作：

```
(defun prettyprint-xml ()
  (interactive)
  (goto-char (point-min))
  (while (search-forward "=" (point-max) t)
    (search-forward "\"")
    (search-forward "\"")
    (forward-char)
    (newline-and-indent))
  (align-regexp (point-min) (point-max) "\#")) 
```

它可能不完全符合您的要求（我刚刚对其进行了编码），但看起来它应该适用于您展示的案例。

# svn - SVN 怪异第 2 天：SVN 列表和 SVN 更新报告不同的事情

> ID：915971
> 
> 赞同：1
> 
> 时间：2009-05-27T14:19:22.377
> 
> 标签：svn, svn-update

在我的 svn 工作副本的子目录中，我做

```
svn list 
```

我看到存储库中有 6 个文件（与我在 SVNX 中看到的相同）。好的。但是在我的工作副本中，有两个文件来自我不记得的某个历史点。所以我愿意

```
svn update 
```

它说所有文件都是最新的修订版 122（这是主要修订版）。**更新和列表之间有什么区别？**更重要的是，如何在不重新结帐的情况下取回这些文件？

我知道答案要么表明我是一个完整的新手，要么表明 svn 是一个可怕的组合。就个人而言，我只想回去工作。

**编辑：** `svn cleanup`什么都不做，什么也不`svn status`报告。

**编辑：**这正是我所做的，因为其中一位评论者问道。

```
root@Dans-13:/dans-data/php/nasa-secrets-revealed/trunk/images/testmenu$svn update
At revision 122.
root@Dans-13:/dans-data/php/nasa-secrets-revealed/trunk/images/testmenu$svn list
graph-big0.gif
graph-big1.gif
graph-big2.gif
graph0.gif
graph1.gif
graph2.gif
root@Dans-13:/dans-data/php/nasa-secrets-revealed/trunk/images/testmenu$ls
.svn        graph-big0.gif  graph0.gif 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T15:21:51.517

你可能有一个[稀疏的结帐](http://svnbook.red-bean.com/en/1.5/svn.advanced.sparsedirs.html)。尝试

```
svn update --depth infinity --set-depth infinity 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T14:35:16.713

目录中是否`svn:ignore`设置了属性？

```
svn pg svn:ignore . 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T14:44:40.330

据我对 SVN 的了解，这是完全不可能的，也不应该发生。

最终我最终这样做了：**从 level up 中删除整个目录并运行`svn update`**. 有时，答案是*绕过*问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T15:22:36.947

或者，也许您已经在该工作副本文件夹中完成了 svn switch 或 svn update -r X 。svn:info 的输出可以告诉你。

# spring - 在 Hibernate 3.3.1ga 和 HSQLDB 中使用带有模式名称的 @Table

> ID：915974
> 
> 赞同：6
> 
> 时间：2009-05-27T14:19:44.030
> 
> 标签：spring, hibernate, schema, hsqldb

如何使用 Hibernate 3.3.1ga 和 HSQLDB 在单元测试中完成这项工作：

```
@Entity
@Table(name="CATEGORY", schema="TEST")
public static class Category { ... } 
```

问题是 Hibernate 期望模式存在。第二个问题是 Hibernate`CREATE TABLE TEST.CATEGORY`在我的任何代码运行之前发出（这发生在 Spring 的测试设置深处），所以我无法在 Hibernate 之前获得与数据库的连接并手动创建模式。

但我需要模式，因为我必须在真实代码中访问不同的数据库。我应该怎么办？

休眠 3.3.1ga、HSQLDB、Spring 2.5

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-05T18:34:50.707

您可以编写一个实现[InitializingBean](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/beans/factory/InitializingBean.html)的类：

```
public class SchemaCreator implements InitializingBean {

    private String schema;
    private DataSource dataSource;

    public String getSchema() {
        return schema;
    }

    public void setSchema(String schema) {
        this.schema = schema;
    }

    public DataSource getDataSource() {
        return dataSource;
    }

    public void setDataSource(DataSource dataSource) {
        this.dataSource = dataSource;
    }

    @Override
    public void afterPropertiesSet() throws Exception {
        JdbcTemplate jdbcTemplate = new JdbcTemplate(dataSource);
        jdbcTemplate.execute("CREATE SCHEMA " + schema + " AUTHORIZATION DBA");
    }

} 
```

然后，您必须在此类的 bean 定义文件中定义一个 bean（我正在暗中拍摄您现有的 bean 定义的样子）。

```
<bean id="dataSource" class="...">
    <property name="driverClassName" value="org.hsqldb.jdbcDriver"/>
    <property name="url" value="jdbc:hsqldb:mem:test"/>
    <property name="username" value="sa"/>
    <property name="password" value=""/>
</bean>

<bean id="sessionFactory" depends-on="schemaCreator" class="org.springframework.orm.hibernate3.LocalSessionFactoryBean">
    <property name="dataSource" ref="dataSource"/>
    ...
</bean>

<bean id="schemaCreator" class="SchemaCreator">
    <property name="dataSource" ref="dataSource"/>
    <property name="schema" value="TEST"/>
</bean> 
```

通过使用[`depends-on`](http://static.springframework.org/spring/docs/2.0.8/reference/beans.html#beans-factory-dependson)Hibernate 的 bean 的属性，Spring 将确保`schemaCreator`bean 将首先被初始化，从而使 schema 及时存在。这也应该使您的意图更加清晰。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-17T08:03:35.657

下面是一个示例，说明如何使用 test hslqdb 创建 spring 配置 它会自动从 @Table(schema =...) 检测您的所有模式并为您创建它们。

如果只是为了测试，这应该适合你：

```
import org.reflections.Reflections; //maven artifact: 'org.reflections:reflections:0.9.9-RC1'
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Lazy;
import org.springframework.core.io.ClassPathResource;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.jdbc.datasource.DriverManagerDataSource;
import org.springframework.orm.hibernate4.LocalSessionFactoryBean;

import javax.persistence.Table;
import java.util.HashSet;
import java.util.Properties;
import java.util.Set;

@Configuration
@ComponentScan("com.test.collection")
public class CollectionConfig {

private static final String[] ENTITY_PACKAGES = { "com.test.collection.domain.dao" };
private static final String CONFIGURATION_LOCATION = "/movie-collection-hibernate.cfg.xml";

@Bean( name = "testSessionFactory" )
@Lazy
public LocalSessionFactoryBean getTestSessionFactory() {
    LocalSessionFactoryBean sessionFactory = new LocalSessionFactoryBean();
    sessionFactory.setPackagesToScan( ENTITY_PACKAGES );

    Properties hibernateProperties = getHibernateHsqlTestDbProperties();
    sessionFactory.setHibernateProperties( hibernateProperties );

    createNonStandardSchemas( hibernateProperties );

    return sessionFactory;
}

private void createNonStandardSchemas( Properties properties ) {
    final String DEFAULT_SCHEMA = "";

    Set<String> schemas = new HashSet<>();
    Reflections reflections = new Reflections( ENTITY_PACKAGES );
    Set<Class<?>> annotatedClasses =
            reflections.getTypesAnnotatedWith( Table.class );

    for ( Class<?> clazz : annotatedClasses ) {
        Table table = clazz.getAnnotation( Table.class );
        if ( !DEFAULT_SCHEMA.equals( table.schema() ) ) {
            schemas.add( table.schema() );
        }
    }

    if ( !schemas.isEmpty() ) {
        DriverManagerDataSource driverManager = new DriverManagerDataSource();
        driverManager.setDriverClassName( properties.getProperty( "hibernate.connection.driver_class" ) );
        driverManager.setUrl( properties.getProperty( "hibernate.connection.url" ) );
        driverManager.setUsername( properties.getProperty( "hibernate.connection.username" ) );
        driverManager.setPassword( properties.getProperty( "hibernate.connection.password" ) );

        JdbcTemplate jdbcTemplate = new JdbcTemplate( driverManager );

        for ( String schemaName : schemas ) {
            jdbcTemplate.execute(
                    String.format( "DROP SCHEMA IF EXISTS %s", schemaName)
            );
            jdbcTemplate.execute(
                    String.format( "CREATE SCHEMA %s AUTHORIZATION DBA", schemaName)
            );
        }
    }
}

private Properties getHibernateHsqlTestDbProperties() {
    Properties prop = new Properties();
    prop.setProperty( "hibernate.connection.driver_class", "org.hsqldb.jdbcDriver" );
    prop.setProperty( "hibernate.connection.url", "jdbc:hsqldb:mem:test" );
    prop.setProperty( "hibernate.connection.username", "sa" );
    prop.setProperty( "hibernate.connection.password", "test" );
    prop.setProperty( "hibernate.connection.pool_size", "5" );
    prop.setProperty( "hibernate.dialect", "org.hibernate.dialect.HSQLDialect" );
    prop.setProperty( "hibernate.current_session_context_class", "thread" );
    prop.setProperty( "hibernate.cache.provider_class", "org.hibernate.cache.internal.NoCachingRegionFactory" );
    prop.setProperty( "hibernate.show_sql", "false" );
    prop.setProperty( "hibernate.format_sql", "false" );
    prop.setProperty( "hibernate.use_sql_comments", "false" );
    prop.setProperty( "hibernate.hbm2ddl.auto", "create-drop" );
    return prop;
}

} 
```

这是一个测试样本：

```
@ContextConfiguration( classes = CollectionConfig.class )
@DirtiesContext( classMode = DirtiesContext.ClassMode.AFTER_EACH_TEST_METHOD )
public class DaoMappingTest extends AbstractTestNGSpringContextTests {

@Autowired
private SessionFactory testSessionFactory;

@Test
public void thatMovieIsSaved() {
    Movie killBill = getKillBillMovie0();

    saveToDb( Arrays.asList(killBill) );

    Session querySession = testSessionFactory.openSession();
    List<Movie> movies = querySession.createQuery( "from Movie" ).list();
    querySession.close();

    assertThat( movies ).containsExactly( killBill );
}

@Test
public void that2MoviesIsSaved() {
    Movie killBill = getKillBillMovie0();
    Movie terminator = getTerminatorMovie1();

    saveToDb( Arrays.asList( killBill, terminator ) );

    Session querySession = testSessionFactory.openSession();
    List<Movie> movies = querySession.createQuery( "from Movie" ).list();
    querySession.close();

    assertThat( movies ).containsOnly( killBill, terminator );
}

private void saveToDb( List<?> objects ) {
    Session session = testSessionFactory.openSession();
    session.beginTransaction();

    for( Object obj : objects) {
        session.save( obj );
    }

    session.getTransaction().commit();
    session.close();
}

@AfterSuite
public void tearDown() {
    testSessionFactory.close();
}
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T14:50:33.390

我目前的解决方案如下所示：

```
@Override
protected String[] getConfigLocations() {
    createHSQLDBSchemas ();

    return new String[]{
            "test-spring-config.xml"
    };
}

private static boolean hsqldbSchemasCreated = false;

public static void createHSQLDBSchemas ()
{
    if (hsqldbSchemasCreated)
        return;

    try
    {
        log.info ("createHSQLDBSchemas");

        Class.forName("org.hsqldb.jdbcDriver").newInstance();
        Connection c = DriverManager.getConnection("jdbc:hsqldb:mem:test", "sa", "");
        Statement stmt = c.createStatement ();

        String sql;
        sql = "CREATE SCHEMA xxx AUTHORIZATION DBA";
        log.info (sql);
        stmt.execute (sql);

        stmt.close ();
        c.close ();
    }
    catch (Exception e)
    {
        throw new ShouldNotHappenException (e);
    }

    hsqldbSchemasCreated = true;
} 
```

但这感觉就像一个非常丑陋的黑客。没有更好的解决方案吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-28T19:21:17.317

我遇到了同样的问题，MS SQL Server 想要定义目录和模式，但 HSQLDB 没有。我的解决方案是为设置目录和架构的 MS SQL Server 加载自定义 orm.xml 文件（通过 persistence.xml）。

1.仅为您的实体指定@Table 名称（省略任何目录或架构信息）：

```
@Entity
@Table(name="CATEGORY")
public static class Category { ... } 
```

2.在您的 META-INF/persistence.xml 文件中指定两个持久性单元节点

```
<persistence version="2.0"
    xmlns="http://java.sun.com/xml/ns/persistence" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">

    <!--
     | For production and integration testing we use MS SQL Server, which needs  
     | the catalog and schema set (see orm-mssql.xml).
     |-->
    <persistence-unit name="com.mycompany.prod">
        <mapping-file>META-INF/orm-mssql.xml</mapping-file>
    </persistence-unit>

    <!--
     | For unit testing we use HSQLDB, which does not need the catalog or schema.
     |-->
    <persistence-unit name="com.mycompany.test" />

</persistence> 
```

3.在 orm-mssql.xml 文件中指定默认目录和架构：

```
<entity-mappings version="2.0"
    xmlns="http://java.sun.com/xml/ns/persistence/orm" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xsi:schemaLocation="http://java.sun.com/xml/ns/persistence/orm orm_2_0.xsd">

    <persistence-unit-metadata>

        <!--
         | Set the catalog and schema for MS SQL Server
         |-->
        <persistence-unit-defaults>
            <schema>MYSCHEMA</schema>
            <catalog>MYCATALOG</catalog>
        </persistence-unit-defaults>

    </persistence-unit-metadata>

</entity-mappings> 
```

4.我使用 Spring 来配置 JPA，所以我使用属性占位符作为 persistenceUnitName 的值：

```
<bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="dataSource" ref="dataSource" />
    <property name="jpaVendorAdapter" ref="jpaVendorAdapter" />
    <property name="persistenceUnitName" value="${entityManagerFactory.persistenceUnitName}" />
</bean> 
```

对于单元测试，使用“com.mycompany.test”，对于集成测试/生产部署，使用“com.mycompany.prod”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-04T10:34:56.603

在我看来，您在 Hibernate DDL 创建代码中有一个可重现的错误。你应该[报告一个错误](http://opensource.atlassian.com/projects/hibernate/browse/HHH)——这是一个长期的解决方案，但它是在开源中完成事情的方式。当然，你可能想制作一个补丁，但我从来没有发现 Hibernate 代码库很容易破解。

# emacs - 在 Emacs 中，如何在一系列初始化语句中排列等号？

> ID：915985
> 
> 赞同：28
> 
> 时间：2009-05-27T14:22:23.540
> 
> 标签：emacs, formatting, code-formatting

我在某个地方看到了这个，但现在找不到了。emacs 中是否有内置函数，或者是否有人有 elisp，可以在 cc 模式下将一系列初始化语句中的所有等号对齐？

前：

```
int t=9;
Graphics g = new Graphics();
List<String> list = new List<String>(); 
```

后：

```
int          t    = 9;
Graphics     g    = new Graphics();
List<String> list = new List<String>(); 
```

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-05-27T14:35:12.423

使用`M-x align-regexp`（这里，`M-x align-regexp RET = RET`）。您还可以为变量添加“对齐规则” `align-rules-list`，以便将来`M-x align`执行此操作。有关详细信息，请参阅文档 ( `C-h f align`)。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2011-11-15T00:14:35.713

这是对 harpo 对 ShreevatsaR 回答的评论的回应：

> 唯一的问题是它“制表”了输出，这可能不是你想要的。你知道有什么方法可以防止这种情况吗？

这是我为解决该问题所做的工作：

```
;; Align with spaces only
(defadvice align-regexp (around align-regexp-with-spaces)
  "Never use tabs for alignment."
  (let ((indent-tabs-mode nil))
    ad-do-it))
(ad-activate 'align-regexp) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-27T14:29:58.940

Mx align 应该可以解决问题。

# sql-server - SQL Case 语句语法

> ID：915990
> 
> 赞同：1
> 
> 时间：2009-05-27T14:23:55.050
> 
> 标签：sql-server, case

我正在尝试编写一个 select 语句，它将选择包括电子邮件字段在内的多个字段。此表中有 3 个可用的电子邮件字段，有时可能包含空值。我想看 3 个领域；[电子邮件地址1]，[电子邮件地址2]，[电子邮件地址3]，基本上我想做的是如果[电子邮件地址3]为空，那么我想要[电子邮件地址2]中的值，如果电子邮件地址2为空而不是我想要的值在 [电子邮件地址1]

我似乎无法正确使用语法，也不太确定自己做错了什么。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-27T14:26:12.427

你需要的是[COALESCE(...) 函数](http://msdn.microsoft.com/en-us/library/aa258244.aspx)：

```
SELECT COALESCE(t.Email3, t.Email2, t.Email1) FROM MyTable t 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-27T14:27:39.567

不需要 CASE，您也可以使用[COALESCE](http://msdn.microsoft.com/en-us/library/ms190349.aspx)（“返回其参数中的第一个非空表达式”）：

```
SELECT COALESCE(Email3, Email2, Email1) ... 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T14:46:30.340

查看有关 COALESCE 的其他答案，但如果您真的*想要*一个 CASE 结构，应该这样做：

```
CASE
  WHEN email3 IS NOT NULL THEN email3
  WHEN email2 IS NOT NULL THEN email2
  WHEN email1 IS NOT NULL THEN email1
  ELSE ''
END 
```

我添加了 else 子句以防止从整个事情中返回 Null，但如果这就是您想要在所有三个都是 Null 时发生的事情，您可以使用：

```
CASE
  WHEN email3 IS NOT NULL THEN email3
  WHEN email2 IS NOT NULL THEN email2
  ELSE email1
END 
```

请注意，SQL Server CASE 函数不会丢弃案例——一旦匹配到一个，就可以了。不需要“休息”。

# javascript - Javascript 语法

> ID：915991
> 
> 赞同：2
> 
> 时间：2009-05-27T14:24:13.117
> 
> 标签：javascript

你怎么说`if (A == 0) OR (B == 0)`？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-27T14:27:48.210

只是为了狡猾：

```
if (A === 0 || B === 0) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-27T14:25:14.160

```
if (A == 0 || B == 0) 
```

或者

```
if ((A == 0) || (B == 0)) 
```

查看Wikibooks 上的[控制结构](http://en.wikibooks.org/wiki/JavaScript/Control_Structures)和[运算符](http://en.wikibooks.org/wiki/JavaScript/Operators)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-27T14:25:09.900

```
if (  A == 0  ||  B == 0 ) {
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-27T14:30:30.403

取决于您的意思是排他性还是包容性 OR :)

**包含或：**

```
if(A == 0 || B == 0) 
{ 
} 
```

**异或：**

```
if(A == 0 && B != 0 || A != 0 && B == 0) 
{ 
} 
```

# visual-studio - Visual Studio 2010 团队资源管理器

> ID：915995
> 
> 赞同：21
> 
> 时间：2009-05-27T14:24:43.817
> 
> 标签：visual-studio, visual-studio-2010, tfs

我刚刚安装了 VS2010，我想连接到 TFS，但我没有任何团队资源管理器选项。

我搜索了 Team Explorer，发现这个[链接](http://blog.hinshelwood.com/archive/2009/05/18/connecting-vs2010-to-tfs-2008.aspx)表明 Team Explorer 预装在 VS2010 Team Suit 中。

我下载了VS2010 Pro，没有团队资源管理器，在任何地方都找不到。

有任何想法吗？尖端？

谢谢

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2010-04-08T10:12:49.227

我认为对 MS 命名约定存在误解。

Visual Studio 2010 的所有版本都可以连接到内置的 TFS，不再需要单独安装（以前称为 Team Explorer）。

Ultimate 版本与现在称为 Team Explorer（代号 Eaglestone）的功能是一个用于访问 TFS 的独立富客户端。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-27T14:29:31.780

如果您下载了 VS2010 Pro……您没有下载 Team Explorer 附带的版本。需要重新下载VS2010 Team System。您可以从 MSDN 获取它或从以下位置下载它：

[Visual Studio 2010 Team System Beta 1 下载](http://www.microsoft.com/downloads/details.aspx?FamilyID=85520793-68fc-4361-a8b6-dc2cff49c8d2&displaylang=en)

**更新**

从 Beta 2 开始，Microsoft 稍微重命名了版本。TFS 连接现在包含在“Ultimate”中。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-11-12T06:21:59.073

看起来 Team Explorer 也可以单独下载。VS 2010 Beta 2 版本在这里：[http ://www.microsoft.com/downloads/details.aspx?familyid=CA86215B-A824-44E7-B4C3-982C7ECEA46D&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=CA86215B-A824-44E7-B4C3-982C7ECEA46D&displaylang=en)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-04-29T21:44:33.797

Team Explorer 的 RTM 版本在这里：[Microsoft Visual Studio Team Explorer 2010 - ISO](http://www.microsoft.com/downloads/details.aspx?familyid=FE4F9904-0480-4C9D-A264-02FEDD78AB38&displaylang=en)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-27T14:28:12.623

VS2010 Pro 是与 VS2010 Team Suit 不同的版本，它不包含任何与 TFS 相关的内容。如果您想连接到 TFS，您需要获得 VS2010 Team Suit 版本。

自 VS2005 以来，这一直是常态。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-02-13T10:07:16.570

您可以从以下位置下载 Visual Studio Team Explorer（或命令行工具）：

1.  ~~[团队探索者 2013](http://www.microsoft.com/en-us/download/details.aspx?id=40776)~~
2.  ~~[团队探索者 2012](http://www.microsoft.com/en-us/download/details.aspx?id=30656)~~
3.  [Microsoft Visual Studio Team Explorer 无处不在 2010](https://www.microsoft.com/en-us/download/details.aspx?id=4240 "Microsoft Visual Studio Team Explorer 无处不在 2010")
4.  [团队探索者 2008](http://www.microsoft.com/en-us/download/details.aspx?id=16338 "团队资源管理器 2008 (ISO)")
5.  [团队探险家 2005](http://www.microsoft.com/en-us/download/details.aspx?id=7203 "团队探险家 2005")

# c# - 密码保护 C# 中的 Excel 文件

> ID：915999
> 
> 赞同：8
> 
> 时间：2009-05-27T14:25:14.673
> 
> 标签：c#, excel, passwords, password-protection

有谁知道这个的语法？我一直在到处寻找，我能找到的只有 C++ 代码。我正在尝试使用 System.IO.Packaging 命名空间以编程方式对 excel 文件进行密码保护。

有任何想法吗？

补充笔记：

我没有使用 Excel 互操作，而是使用 System.IO.Packaging 命名空间来加密和密码保护 Excel 文件。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T14:36:56.367

如果你想要一个 Excel 密码，你只需要这样：

```
using Microsoft.Office.Interop.Excel

//create your spreadsheet here...

WorkbookObject.Password = password;
WorkbookObject.SaveAs("spreadsheet.xls") 
```

这需要安装 Excel。

当然，这无关紧要`System.IO.Packaging`，因此您可能需要重申您的问题...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T14:31:57.763

使用 是不可能的`System.IO.Packaging`。您将不得不`Microsoft.Office.Interop.Excel`使用该[`Worksheet.SaveAs`](http://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.worksheet.saveas(VS.80).aspx)方法。这需要在您的目标系统上安装 Excel。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T14:33:16.123

您将不得不在工作表上使用 SaveAs 方法。它有一个设置密码的参数。这是VB中的一个示例，可以转换为C#

[http://www.codeproject.com/KB/office/Excel_Security.aspx](http://www.codeproject.com/KB/office/Excel_Security.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-06-27T19:38:33.563

```
using System.IO;
using Excel=Microsoft.Office.Interop.Excel;

class ExcelUtil
{
    public  string Filename;

    private  Excel.Application oexcel;

    private Excel.Workbook obook;

    private  Excel.Worksheet osheet;
    public void createPwdExcel()
    {
        try
        {
            // File name and path, here i used abc file to be 
            // stored in Bin directory in the sloution directory
            //Filename = (AppDomain.CurrentDomain.BaseDirectory + "abc.xls");
            if (File.Exists(Filename))
            {
                File.Delete(Filename);
            }

            if (!File.Exists(Filename))
            {
                // create new excel application
                Excel.Application oexcel = new Excel.Application();
                oexcel.Application.DisplayAlerts = false;
                obook = oexcel.Application.Workbooks.Add(Type.Missing);
                oexcel.Visible = true;
                Console.WriteLine("Generating Auto Report");
                osheet = (Excel.Worksheet)obook.Sheets.Add(Type.Missing, Type.Missing, Type.Missing, Type.Missing);
                osheet.Name = "Test Sheet";
                osheet.get_Range("A1:G1").Merge();
                osheet.get_Range("A1").Value = @"Implementing Password Security on Excel Workbook Using Studio.Net";

                osheet.get_Range("A1").Interior.ColorIndex = 5;
                osheet.get_Range("A1").Font.Bold = true;
                string password = "abc";
                obook.WritePassword = password;
                obook.SaveAs("Chandra.xlsx");
                // otherwise use the folowing one
                // TODO: Labeled Arguments not supported. Argument: 2 := 'password'
                // end application object and session
                osheet = null;
                obook.Close();
                obook = null;
                oexcel.Quit();
                oexcel = null;
            }

        }
        catch (Exception ex)
        {

        }

    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-28T23:00:42.707

从 NuGet 包下载 Microsoft.Office.Interop.Excel。使用下面的 c# 代码密码保护 Excel 文件

```
using Excel = Microsoft.Office.Interop.Excel; 

Excel.Application xlApp = new Excel.Application();
        Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(srcFile);

            //protect the whole workbook  
            xlWorkbook.Password = "passwordString";
            xlWorkbook.SaveAs(dstFile);
            xlWorkbook.Close();
            xlApp.Quit(); 
```**