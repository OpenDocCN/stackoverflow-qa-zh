# StackOverflow 问答 000681000-000681999

# .net - Resources/App.config 或 Database 是应用程序字符串的最佳位置

> ID：681008
> 
> 赞同：4
> 
> 时间：2009-03-25T10:27:25.527
> 
> 标签：.net, vb.net

全部，

我目前正在查看我正在维护的旧应用程序，它混合使用从数据库中的 App.config 和应用程序配置表中检索应用程序配置设置。

在我正在工作的新软件（旧应用程序的一个端口）中，我有一个静态且很少更改的电子邮件地址列表，检索这些地址的最佳机制是什么。目前我正在使用资源字符串，因此使用它们是一个简单的 My.Resources.，但是将信息存储在 App.Config 或数据库表中的好处/缺点是什么。

在什么时候使用资源没有意义？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T17:13:49.310

这一切都取决于？我的一些经验法则是

**进入配置/资源文件**

1.  每个用户都一样，例如图像目录的路径
2.  数据仅在 UI 级别需要，不会经常更改，例如美国州列表
3.  它可能因服务器而异，例如用于生产与测试的资源 URL

**进入数据库**

1.  它根据用户而变化，或者是用户特定的数据
2.  它可能需要由您的开发团队之外的人维护
3.  它将在 UI 层之外使用
4.  它将定期更新

**不管你做什么**

不要在你的代码中硬编码字符串，我不在乎你有多肯定错误报告通知电子邮件地址不会改变，不要硬编码它！！！！或者 3 年后，原本 2 秒的配置更改将导致 2 周的工作来编译一个过时的遗留垃圾应用程序！或者另一个有趣的是将 xml-schema 硬编码到应用程序中

```
stringname += "Schema data";
stringname += "Schema data";
stringname += "Schema data"; 
```

奇怪的是同一个人，去算一下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T10:41:50.440

我认为很少更改的设置可以安全地转到 app.config。对于团队中的新开发人员来说，这是相当透明的，并且仍然可以在不重新编译的情况下更改设置。

对于经常和定期更改的东西，我会使用数据库、用户配置文件中的设置文件或其他共享位置等。这将使管理配置更改更容易。

另一方面，我不认为资源文件用于存储配置，而是集中（在某些情况下保留翻译等）应用程序中所有硬编码的内容。如果我继承了您的代码，我会感到非常惊讶。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-01T04:33:56.357

I'm for putting the bare minimum in configuration files. Just enough to get connected to your database or whatever else you are using as a data source. This is less information that is exposed in a flat file somewhere. For storing emails I would put that in the DB.

# apache-flex - 在 flex 中监听来自预加载器的事件

> ID：681010
> 
> 赞同：1
> 
> 时间：2009-03-25T10:27:49.770
> 
> 标签：apache-flex, actionscript-3, preloader

我的 flex 应用程序中有一个预加载器：

```
public class Preloader extends DownloadProgressBar 
{

    private var _preloader:PreloaderAnimation;

    public function Preloader()
    {
        super();

        _preloader = new PreloaderAnimation;
        addChild(_preloader);
    }

    public override function set preloader(preloader:Sprite):void 
    {                   
        preloader.addEventListener(ProgressEvent.PROGRESS  , onSWFDownloadProgress );
        preloader.addEventListener(Event.COMPLETE          , onSWFDownloadComplete );
        preloader.addEventListener(FlexEvent.INIT_PROGRESS , onFlexInitProgress    );
        preloader.addEventListener(FlexEvent.INIT_COMPLETE , onFlexInitComplete    );
    }

    .........

    private function onFlexInitComplete( event:FlexEvent ):void 
    {
        dispatchEvent(new Event(Event.COMPLETE));
    }
} 
```

当 Flex Initialize 完成时，预加载器会调度 Event.COMPLETE。但我希望能够在我的 flex 应用程序中收听事件并在它调度时做一些事情。当它调度预加载器时，它会自行移除，这就是它至关重要的原因。关于如何从我的 flex 应用程序中收听的任何想法？

问候阿德勒茨

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T01:37:05.007

Preloader 的 INIT_COMPLETE 事件在 preloader 收到 Application 的 CREATION_COMPLETE 事件后触发。

初始化顺序是这样的：

*   Preloader 开始加载您的应用程序；
*   应用程序下载，开始初始化；
*   应用程序初始化，派发 CREATION_COMPLETE；
*   Preloader接收Application.CREATION_COMPLETE，调度INIT_COMPLETE；
*   您的预加载器类接收预加载器的 INIT_COMPLETE；
*   您的预加载器调度 COMPLETE 事件；
*   Preloader 删除您的预加载器类并调度（私有）PRELOADER_DONE 事件；
*   显示您的应用程序。

在这种情况下，这意味着 Application.CREATION_COMPLETE 等效于 Preloader.INIT_COMPLETE - 如果您想知道预加载器何时调度 INIT_COMPLETE，那么请侦听 CREATION_COMPLETE。

您可以通过查看 Preloader 类的源代码来确认所有这些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T12:46:47.737

我不确定你想要达到什么目的。如果您只想在应用程序初始化或创建完成时做某事，您可以在应用程序上使用 creationComplete 或 intialize 事件。一旦预加载器完成，您是否需要知道原因（假设这与应用程序中的 creationComplete 事件不同，我认为不会）？

更新：

所以你只是希望能够从预加载器中收听 Complete 事件吗？

试试这个：在应用程序上创建一个 initalize 事件处理程序，并尝试将一个事件侦听器附加到预加载器。它看起来像这样（未经测试，因此可能有拼写错误等）

```
public function applicationInitalize_handler ( e:FlexEvent ) : void
{
Application.preloader.addEventListener(Event.COMPLETE,myEventHandler);
} 
```

看看这是否可行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T05:53:54.587

> 我需要知道预加载器何时完成的原因是因为我想直接播放电影，电影中的第一帧看起来像预加载器的图像。

预加载器会一直显示，直到您从预加载器调度 Event.COMPLETE 事件。

如果您想在预加载器完成和正在显示的应用程序之间显示某些内容，那么您需要在调度 Event.COMPLETE 之前在预加载器中执行此操作。如果您不调度 COMPLETE 事件，您的预加载器将永远显示。

（如果您好奇，请查看“displayClassCompleteHandler”函数中的 Flex Preloader 源代码）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T09:02:45.823

当 Flash 应用程序完成初始化时触发 Flex.INIT_COMPLETE。所以它恰好在主应用程序的初始化事件之后调度。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-09-13T15:05:31.577

在您的 Flex 应用程序中，您需要监听 Application.applicationComplete 事件。

如果在您的 Preloader 类中，您有一个看起来像的函数

```
private function onFlexInitComplete( event:FlexEvent ):void 
{
    dispatchEvent(new Event(Event.COMPLETE));
} 
```

您需要确保您的应用程序文件的标题看起来像

```
<s:Application 
    preloader = "MyPreloader"
    applicationComplete="onApplicationComplete();" > 
```

通过此设置，只要您决定从预加载器调度 Event.COMPLETE 事件，就会触发 onApplicationComplete()。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-10-22T01:52:04.557

应用程序的 APPLICATION_COMPLETE 事件似乎是在 Preloader 触发 Event.COMPLETE 事件之后发出的......只是听这个？

# c - 获取 pcap 捕获文件中的数据包数量？

> ID：681011
> 
> 赞同：16
> 
> 时间：2009-03-25T10:28:57.990
> 
> 标签：c, pcap

我需要一个程序，它在使用[pcap 格式](http://www.tcpdump.org/pcap3_man.html)的捕获文件中打印数据包的数量。这个数字在 pcap 标头中似乎不可用（可能是因为它是在捕获开始之前写入的），并且文件中似乎没有带有此信息的“页脚”。

所以，我相信唯一的算法是遍历所有数据包并将它们相加。它在 O(N) 中，并且对于大迹线，相当长。

我在这里发帖看看是否有人有更聪明的想法？

我用“C”标记，因为它是我目前使用的语言，但我相信这是一个与语言无关的问题。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-28T07:37:41.543

pcaputils 的作者 Robert Edmonds 向我提到，在 Wireshark 包中已经有一个程序在做我想做的事情，capinfos。它显示有关 pcap 文件的各种指示，包括它包含的数据包数量。

阅读代码源，它似乎可以通过按顺序遍历整个文件来工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-10-30T00:51:44.037

确定文件中有多少数据包的*唯一方法是读取整个文件。*实际上，文件头中没有数据包计数（因为该格式被设计为一次可写），实际上也没有页脚。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-03-27T23:33:21.140

如果您想要pcap 中的帧数**：**

```
tshark -r test.cap | wc -l 
```

使用 capinfo：

```
capinfos test.cap | grep "Number of packets"| tr -d " " | cut -d ":" -f 2 
```

使用 tcpdump：

```
tcpdump -r test.cap 2>/dev/null| wc -l 
```

所以基本上，使用 libpcap，这里是一个例子：

```
#include <stdio.h>
#include <pcap.h>
#include <stdlib.h>

int main(int argc, char **argv) 
{ 
  unsigned int packet_counter=0;
  struct pcap_pkthdr header; 
  const u_char *packet;

  if (argc < 2) { 
    fprintf(stderr, "Usage: %s <pcap>\n", argv[0]); 
    exit(1); 
  } 

   pcap_t *handle; 
   char errbuf[PCAP_ERRBUF_SIZE];  
   handle = pcap_open_offline(argv[1], errbuf); 

   if (handle == NULL) { 
     fprintf(stderr,"Couldn't open pcap file %s: %s\n", argv[1], errbuf); 
     return(2); 
   } 

   while (packet = pcap_next(handle,&header)) { 

      packet_counter++;

    } 
    pcap_close(handle);

  printf("%d\n", packet_counter);
  return 0;
} 
```

注意：您需要安装 libpcap 头文件（在 Linux 上搜索 libpcap dev/devel 包）

然后用 gcc -o myprogram myprogram.c -lpcap 编译

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T10:41:53.450

我知道的唯一方法是读取文件，逐帧捕获并增加“数据包计数器”。但是，有一个包含存储帧长度的小帧头，因此您可以在文件中查找按那个长度。请注意，它可能不会更快。

但是，如果您有兴趣做的不仅仅是简单地计算捕获的帧数，那么阅读数据并在计算它们的同时构建捕获的帧链以供将来使用可能是有意义的。我的 Common Lisp 的 PCAP 库就是这样做的。它根据需要读取“下一帧”，将原始帧存储在双链表中，以便将来更轻松地进行“下一帧/上一帧”导航，根据需要从磁盘读取更多帧。但是，帧内容的解析由库用户自行决定，并且不会通过简单地将帧八位字节读入数据结构来强制执行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-01-12T19:41:02.703

您可以使用 tshark 和 -qz 打印 .pcap 文件的统计信息

例如，以 5 秒为间隔分析文件：

```
❯ tshark -r file1.pcap -qz io,stat,5,"COUNT(frame) frame"

=============================
| IO Statistics             |
|                           |
| Duration: 17\. 29551 secs  |
| Interval:  5 secs         |
|                           |
| Col 1: COUNT(frame) frame |
|---------------------------|
|          |1      |        |
| Interval | COUNT |        |
|------------------|        |
|  0 <>  5 |    10 |        |
|  5 <> 10 |    10 |        |
| 10 <> 15 |    10 |        |
| 15 <> Dur|     6 |        |
============================= 
```

同一个文件，现在使用一个 30 秒的间隔

```
❯ tshark -r file1.pcap -qz io,stat,30,"COUNT(frame) frame"

==================================
| IO Statistics                  |
|                                |
| Duration: 17.0 secs            |
| Interval: 17.0 secs            |
|                                |
| Col 1: COUNT(frame) frame      |
|--------------------------------|
|              |1      |         |
| Interval     | COUNT |         |
|----------------------|         |
|  0.0 <> 17.0 |    36 |         |
================================== 
```

# odbc - Connect tables with ODBC

> ID：681016
> 
> 赞同：1
> 
> 时间：2009-03-25T10:30:01.060
> 
> 标签：odbc, connect

To connect multiple tables in oracle with ODBC do we need to create different DSN for different tables.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T10:37:20.200

No, you don't. I can't add any more info unless you make your question more specific. Why do you think you might need more than one DSN?

# asp.net - 设计具有多个控件的 Web 控件，所有控件都可编程编辑

> ID：681021
> 
> 赞同：0
> 
> 时间：2009-03-25T10:32:02.523
> 
> 标签：asp.net

我需要设计一个 Web 控件，其中包括一个投票，还有一些图像（图像控件）。

如果我将图像控件添加到 Web 控件，如何编辑这些图像控件？我需要一个带有投票和图像的 Web 控件，但能够通过属性编辑图像的源（例如 WebControl1.Image1.source = "";）。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T10:41:16.773

您可以在 page.controls 集合或 {panelname}.controls 中查找控件，也可以创建一个转发器。

代码示例：

```
 For Each ctrl As Control In PollPanel.Controls
            If TypeOf ctrl Is Image Then
                Dim im As Image = CType(ctrl, Image)
                '...do stuff
            End If
        Next 
```

# javascript - jQuery 中的多条件选择器

> ID：681022
> 
> 赞同：1
> 
> 时间：2009-03-25T10:32:11.117
> 
> 标签：javascript, jquery

我正在尝试选择具有多个条件的元素，例如我目前正在执行以下操作：

```
$('#myspan').find('input:visible').each(myfunc); 
```

虽然我知道你可以做类似的事情，`$('#myspan input:visible')`但它对我不起作用。我需要检查范围内`#myspan`可见*并*已检查的输入。有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T10:35:48.083

尝试：

```
$("#myspan :checked:visible").each(function() {
    // do stuff
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T10:35:09.910

```
$('input:visible', '#myspan').find(':checked').each(function() {
    alert(this.id);
}); 
```

应该做的伎俩。我喜欢分离事物，因为我喜欢认为它有助于 jQuery 更好地解析。

# iis - 被动 FTP 而不是主动 FTP

> ID：681025
> 
> 赞同：3
> 
> 时间：2009-03-25T10:32:26.763
> 
> 标签：iis, iis-7, ftp

我有一个客户端，您不能使用 Active FTP 连接，因为它们受接口应用程序的限制。我遇到的问题是我的 Active 设置很好，但无法理解为什么我的被动 FTP 只会超时。

我已经关注了这篇文章 [http://learn.iis.net/page.aspx/309/configuring-ftp-firewall-settings/](http://learn.iis.net/page.aspx/309/configuring-ftp-firewall-settings/) 仍然没有喜悦。

第一个问题是我应该让客户端使用被动连接吗？它是否像主动连接一样安全，因为我必须允许更多带有被动连接的端口。

第二个问题是为什么 FTP 会超时以允许在防火墙上设置它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T13:46:26.710

对iis7不太熟悉，但我可以在一些问题上为您提供帮助。

被动与主动 ftp 连接。激活时，表示服务器与客户端联系，客户端选择将用于传输数据的端口，然后将其发送回服务器使用。例如，当人们在防火墙后面时使用被动，这意味着客户端不选择端口，而是服务器这样做并且客户端连接到它。

简而言之，如果客户端不允许服务器初始化连接，则使用被动模式。更多信息[在这里](http://slacksite.com/other/ftp.html)。

不管连接是被动的还是主动的，安全性都是一样的。

关于为什么超时有点困难。可能有几种超时设置，一种用于主动连接，一种用于被动连接。可能还有其他一组规则会覆盖您正在使用的规则等等......

# visual-studio - 构建不会将 System.Drawing 复制到输出文件夹

> ID：681037
> 
> 赞同：0
> 
> 时间：2009-03-25T10:36:38.393
> 
> 标签：visual-studio, visual-studio-2008

我有一个部署到引用 System.Drawing 的 SQL 服务器的程序集。别问为什么，就是第三方库。当我调用 CREATE ASSEMBLY 时，这要求 System.Drawing 与库位于同一目录中。我已将 System.Drawing 作为“内容”文件添加到我的项目中，并在输出目录中使用“始终复制”，但它从未被复制。在我求助于使用构建事件之前，如何强制 VS 2008 为我复制此文件，这对于如此简单的任务似乎是不必要的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T11:41:51.340

System.Drawing 肯定是 .NET 框架的一部分，所以不需要部署？您是否在服务器上安装了 .NET 框架？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T11:35:10.483

不知道确切的答案，但我想知道目标目录中程序集的符号链接是否足够？或者第三方可能会被迫使用装配探测路径寻找其他地方？

# iphone - 象征性崩溃

> ID：681042
> 
> 赞同：4
> 
> 时间：2009-03-25T10:38:08.577
> 
> 标签：iphone

我使用以下脚本来表示我从用户那里得到的崩溃报告：

> /Developer/Platforms/iPhoneOS.platform/Developer/Library/Xcode/Plug-ins/iPhoneRemoteDevice.xcodeplugin/Contents/Resources/symbolicatecrash myapp_iPod-Touch.crash myapp.app.dSYM > test.txt

它匹配所有框架调用，但没有匹配我的代码。我怎样才能使它匹配我的代码？请给我一些想法！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T11:50:17.263

正如[Craig Hockenberry 指出](http://furbo.org/2008/08/08/symbolicatifination/)的那样，您为此使用的 dSYM 文件必须与您编译用户正在运行的应用程序版本时生成的完全相同。如果您没有保存该文件，您将无法在您自己的应用程序中解析符号。您不能使用最新版本生成的任何 dSYM 文件来针对较旧提交的应用程序版本运行。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-18T12:50:00.957

**更新** 在大约 2012 年的 XCode 4 中，符号化在 XCode Organizer 中效果很好，*即使*dSYM 在其路径中有空格（我认为）。

ps 将您的 dSYM 置于版本控制之下

**更新** 从 XCode 3.2.5（2010 年 11 月）开始，在管理器窗口中的设备日志中完成的符号化似乎工作得很好。

首先，symbolicatecrash 是垃圾*，但在深入研究并修复它之前，请确保您的 .app 包与您的 .dSYM 位于同一目录中。

应用文件名或标识符中是否有点或破折号？如果是这样，您应该应用[Alan Quatermain 修复程序](http://alanquatermain.net/post/104889775/symbolicatecrash-can-kiss-my-arse)。它旨在用于在 2.x 环境中读取 3.0 崩溃转储，但它也可以正确处理应用程序名称和 ID 中的点和破折号。呃。正则表达式很难。

之后，您将不得不破解 perl。尝试 ./symbolicatecrash -Av mycrash.crash > /dev/null 看看哪里出错了。

对于我的问题，我不得不注释掉 quoteMeta($dsymdir); 和印章（$可执行）；线。然后我有一些模糊的工作。

这是一个运输产品。欢迎来到未来。

从 *SDK 2.2.1 开始，谁知道呢，也许在 3.0 GM 中它很强大。它可能发生。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-22T21:40:32.930

iPhone SDK 2.2.1 附带的 symbolicatecrash 实用程序中也存在一个已知问题，如果这是您当前使用的 SDK。您需要从[http://developer.apple.com/iphone/library/technotes/tn2008/tn2151.html下载新的二进制文件](http://developer.apple.com/iphone/library/technotes/tn2008/tn2151.html)

希望这对您的麻烦有所帮助。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-22T21:44:29.863

有一个新的[Symbolicator](http://boredzo.org/symbolicator/)脚本已经发布，可能会有所帮助

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-03-29T13:45:27.117

(Xcode 4.2) symbolicatecrash 是一个 perl 脚本，它使用 Spotlight 来定位属于崩溃应用程序的 dSYM 文件。如果您使用 -v（详细）选项运行 symbolicatecrash，您将看到类似以下内容： 在 Spotlight 中搜索 UUID 为 ... 的 dsym 运行 mdfind "com_apple_... == ..."

因此，请确保 Spotlight 正常工作，并且使用 mdutil 命令为您的资料所在的卷启用 Spotlight 的索引： mdutil -s -a 如果您的归档应用所在的卷没有被索引，请务必切换索引在。（作为 root/sudo： mdutil -i on /Volumes/...）

# c# - Programatically loop through a DatagridView and check checkboxes

> ID：681046
> 
> 赞同：6
> 
> 时间：2009-03-25T10:39:32.783
> 
> 标签：c#, windows, datagridviewcheckboxcell

I have DataGridView bound by a datatable i have checkboxes to the same.

I want to navigate or loop through the the datagridview and check mark these checkboxes ,Below is the syntax i use .

```
foreach(DataGridViewRow dr in dgvColumns.Rows)
{
    DataGridViewCheckBoxCell checkCell =
        (DataGridViewCheckBoxCell)dr.Cells["CheckBoxes"];
    checkCell.Value=1;
    //Also tried checkCell.Selected=true;
    //Nothing seems to have worked.!
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-07-30T08:46:40.987

以下对我有用，它完美地检查了复选框:)

```
foreach (DataGridViewRow row in dgvDataGridView.Rows)
{
    ((DataGridViewCheckBoxCell)row.Cells[0]).Value = true;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T10:58:23.660

If it is bound to a `DataTable`, can you not work on the model (the table) instead? The `DataGridView` is a view...

Try looping over the rows in the table, setting the values. For example (below) - note that I don't update the `DataGridView` - just the `DataTable`:

```
using System;
using System.Data;
using System.Windows.Forms;

static class Program
{
    [STAThread]
    static void Main()
    {
        DataTable table = new DataTable();
        table.Columns.Add("Name", typeof(string));
        table.Columns.Add("Selected", typeof(bool));
        table.Rows.Add("Fred", false);
        table.Rows.Add("Jo", false);
        table.Rows.Add("Andy", true);

        Button btn = new Button();
        btn.Text = "Select all";
        btn.Dock = DockStyle.Bottom;
        btn.Click += delegate
        {
            foreach (DataRow row in table.Rows)
            {
                row["Selected"] = true;
            }
        };

        DataGridView grid = new DataGridView();
        grid.Dock = DockStyle.Fill;
        grid.DataSource = table;

        Form form = new Form();
        form.Controls.Add(grid);
        form.Controls.Add(btn);
        Application.Run(form);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-26T09:09:56.813

选择其值的行不会传递给底层数据源，因此不会被保存。数据源是数据表。它的datagridview问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T11:34:42.777

类似于以下内容：

```
foreach(DataGridViewRow dgvr in dgvColumns.Rows)
{
    // Get the underlying datarow
    DataRow dr = ((DataRowView)dgvr.DataBoundItem).Row;

    // Update the appropriate column in the data row.
    // Assuming this is your column name in your 
    // underlying data table
    dr["CheckBoxes"] = 1;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-05T17:40:11.663

```
using System.Collections.Generic;
using System.Windows.Forms;

namespace FindTheCheckedBoxes
{
    public partial class Form1 : Form
    {
        List<TestObject> list = new List<TestObject>();

        List<int> positionId = new List<int>();

        public Form1()
        {
            InitializeComponent();
            PopulateDataGrid();

            foreach (DataGridViewRow row in dataGridView1.Rows)
            {
                if ((bool)row.Cells[0].Value == true)
                    positionId.Add((int)row.Cells[1].Value);
            }

            // sets the window title to the columns found ...
            this.Text = string.Join(", ", positionId);
        }
        void PopulateDataGrid()
        {
            list.Add(new TestObject { tick = false, LineNum = 1 });
            list.Add(new TestObject { tick = true, LineNum = 2 });
            list.Add(new TestObject { tick = false, LineNum = 3 });
            list.Add(new TestObject { tick = true, LineNum = 4 });

            dataGridView1.DataSource = list;
        }
    }
    class TestObject
    {
        public bool tick { get; set; }
        public int LineNum { get; set; }
    }
} 
```

This looks like it does what you require. I'm new to all this so sorry if I have answered incorrectly. Just trying to help.

# c# - 从循环中创建唯一字符串列表的最快方法？

> ID：681049
> 
> 赞同：5
> 
> 时间：2009-03-25T10:40:45.107
> 
> 标签：c#, .net, optimization

我有一组字符串（~80 000）我只能通过 hits.Doc(int).Get("fieldName") 方法顺序访问。

```
List<string> idStrings = new List<string>();
int count = hits.Length();
for (int i = 0; i < count; i++)
{
    string idString = hits.Doc(i).Get("id");
    if (!idStrings.Contains(idString))
        idStrings.Add(idString);
} 
```

字符串稍后必须是 int.TryParse()'d。我认为应该有一种更快的方法来做到这一点。有什么建议么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-25T10:46:54.310

首先，使用 a`Hashset<string>`而不是列表， Contains 方法会更快：

```
int count = hits.Length();
Hashset<string> idStrings = new Hashset<string>(); 
```

编辑：如果您使用哈希集，则不必调用“包含”，因为它不能包含重复的项目。只需使用添加，它会自动删除重复值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T10:51:56.140

使用 a`Dictionary`而不是 a `List`。该`Dictionary.ContainsKey`方法比该方法快得多`List.Contains`。

```
Dictionary<string, int> idStrings = new Dictionary<string, int>();
int count = hits.Length();
for (int i = 0; i < count; i++) {
   string idString = hits.Doc(i).Get("id");
   if (!idStrings.ContainsKey(idString)) {
      idStrings.Add(idString, 1);
   }
} 
```

如果您使用框架 3.5，您可以使用 a`HashSet`而不是 a `Dictionary`：

```
HashSet<string> idStrings = new HashSet<string>();
int count = hits.Length();
for (int i = 0; i < count; i++) {
   string idString = hits.Doc(i).Get("id");
   idStrings.Add(idString);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T10:44:22.757

减慢代码速度的语句是`idStrings.Contains(idString)`.

您可以尝试使用比`List`（可能是树或哈希表？）更快的数据结构。

具体来说，您需要一个具有次线性搜索时间的数据结构。哈希表具有恒定的搜索时间，而树通常具有对数搜索时间。

# wpf - 为什么访问我的 Storyboard x:Name 在 Silverlight 中有效，但在 WPF 中无效？

> ID：681054
> 
> 赞同：6
> 
> 时间：2009-03-25T10:42:40.623
> 
> 标签：wpf, storyboard

以下 WPF 代码出现错误：**当前上下文中不存在名称“zipButtonOut”。**

但是，正如我在这里演示的那样，相同的代码在 Silverlight 中有效：[http ://tanguay.info/web/index.php?pg=codeExamples&id=65](http://tanguay.info/web/index.php?pg=codeExamples&id=65)

**我必须对 WPF 代码做什么才能访问 Window.Resources 中的情节提要？**我也在 WPF UserControl 中尝试过，但遇到了同样的错误。

**XAML：**

```
<Window x:Class="TestDataGrid566.Test1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Test1" Height="300" Width="300">
    <Window.Resources>
        <Storyboard x:Name="zipButtonOut" x:Key="zipButtonOut">
            <DoubleAnimation Storyboard.TargetName="buttonContinue"
Storyboard.TargetProperty="Width"
From="0" To="300" Duration="0:0:.2"></DoubleAnimation>
            <DoubleAnimation Storyboard.TargetName="buttonContinue"
Storyboard.TargetProperty="Height"
From="2" To="50" Duration="0:0:.4"></DoubleAnimation>
        </Storyboard>
    </Window.Resources>

    <Grid x:Name="LayoutRoot" Background="White">
        <StackPanel HorizontalAlignment="Center" Margin="20">
            <Button x:Name="buttonBegin" Content="Click here to begin" Background="Green" Click="buttonBegin_Click"/>
            <Button x:Name="buttonContinue" Margin="0 70 0 0" Width="160" Height="2" FontSize="18" Background="Yellow"
Content="Click here to continue" Visibility="Collapsed"></Button>
        </StackPanel>
    </Grid>
</Window> 
```

**代码隐藏：**

```
using System.Windows;

namespace TestDataGrid566
{
    public partial class Test1 : Window
    {
        public Test1()
        {
            InitializeComponent();
        }

        private void buttonBegin_Click(object sender, RoutedEventArgs e)
        {
            buttonBegin.Visibility = Visibility.Collapsed;
            buttonContinue.Visibility = Visibility.Visible;
            //zipButtonOut.Begin(); //GETS ERROR: The name 'zipButtonOut' does not exist in the current context.
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-25T11:21:52.590

我不知道它为什么在 Silverlight 中工作，但在 WPF 控件中，您添加到资源集合中的 x:Name 在后面的代码中不可用。它们可以通过它们的 x:Key 通过 Resources 集合访问，因此您可以删除 x:Name 属性并在代码中被注释掉的行之前添加以下代码行，它会起作用（取消注释当然，有问题的行）：

```
Storyboard zipButtonOut = (Storyboard)Resources["zipButtonOut"]; 
```

请注意，这需要以下 using 语句：

```
using System.Windows.Media.Animation; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-19T07:32:44.763

看起来 VS Silverlight 工具也为 x:Name 资源生成了一个“zipButtonOut”访问器。以后只要看一下obj文件夹中生成的文件（可能是“test1.g.cs”），看看为x:Names生成了什么代码。

# reporting-services - 使用 SSRS 2008 在单独的服务器上安装报表管理器

> ID：681055
> 
> 赞同：3
> 
> 时间：2009-03-25T10:43:21.153
> 
> 标签：reporting-services, ssrs-2008

是否可以在单独的服务器上安装 SSRS 2008 的 IIS 部分。我们有一台数据库服务器和一台网络服务器。是否可以在数据库服务器上安装 SSRS2008 的数据库部分和在 Web 服务器上安装 Web 部件（报表管理器，..）？

这种情况有什么指导方针吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T11:13:36.587

是的，可以在另一台服务器上安装报表管理器。

[参考](http://msdn.microsoft.com/en-us/library/ms159272.aspx)。[在](http://technet.microsoft.com/en-us/library/ms143718(SQL.90).aspx)这里。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-07T19:51:51.083

首先，SSRS 2008 中没有 IIS 部分。SSRS 不再依赖于 IIS，而是将流量直接从 http.sys 传送到 SSRS 服务器，而不是通过 IIS。

您能否将您的目录服务器（数据库）与应用程序服务器（具有 ReportServer Web 服务和 ReportManager 应用程序）分开？是的，您可以但预先警告您需要为每台服务器提供 SQL Server 许可证。

# c# - Retrieve the value of td in repeater

> ID：681057
> 
> 赞同：0
> 
> 时间：2009-03-25T10:46:11.067
> 
> 标签：c#, asp.net, repeater

I have a Repeater that contains a Table. I want to hide the some tablecells of the table in repeater item template Here is the ASPX source code:

```
 <ItemTemplate>
  <table style="width: 100%" align="center">
    <tr>
      <td style="width: 60px;" align="center">
        <img src="upload/companylogo/<%# Eval("companylogo") %>" />
      </td>
      <td align="left">
        <asp:Label runat="server" CssClass="lblcname" ID="Label1" Text='<%# Eval("companyname") %>' /></td>
      <td align="right">
        <asp:Label runat="server" ID="Label2" Text='<%# Eval("city") %>' /></td>
    </tr>
    <tr>
      <td runat="server" id="address" colspan="3">
        <asp:Label runat="server" ID="Label3" Text='<%# Eval("address") %>' />
      </td>
    </tr>
    <tr>
      <td colspan="3" align="right" id="vp" runat="server">
        <a href='nfonews.aspx?id=<%# Eval("mpid") %>'>view Profile</a>
        &raquo; Send Inquiry </td>
    </tr>
    <tr>
      <td colspan="3" style="height: 20px; background-image: url(image/stripe_head_bg.png)"></td>
    </tr>
  </table>
</ItemTemplate> 
```

And my code-behind:

```
SqlDataReader dr = cmd.ExecuteReader();
if (dr.HasRows == true)
{
  dr.Read();
  if (dr["payment"].ToString()  == "Yes")
  {
    Repeater1.DataBind();
    if (Repeater1.Items.Count == 0)
    {
      Repeater1.Visible = false;
    }
    else
    {
      Repeater1.Visible = true;
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T11:19:41.613

在网格的 ItemDataBound 事件中，使用 FindControl 查找单元格。

添加属性；`onitemdatabound="myRepeater_ItemDataBound"`

然后在后面的代码中

```
protected void myRepeater_ItemDataBound(object sender, RepeaterItemEventArgs e)
{
   ListItemType rowType = (ListItemType)e.Item.ItemType;
   if (rowType == ListItemType.Pager || rowType == ListItemType.Header || rowType == ListItemType.Footer)
      return;

   TableCell cell = (TableCell)e.Item.FindControl("address");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T11:35:26.707

最简单的方法是使用 td 的可见属性并根据服务器端表达式为其分配一个值。由于您没有提及您希望显示/隐藏特定列的条件，因此以下代码是可能方式的示例：

```
<table style="width: 100%" align="center">
  <tr>
    <td style="width: 60px;" align="center" runat="server" visible="<%#showCompanyLogo %>">
      <img src="upload/companylogo/<%# Eval("companylogo") %>" />
    </td>
    <td align="left" runat="server" visible="<%#showCompanyName %>">
      <asp:Label runat="server" CssClass="lblcname" ID="Label1" Text='<%# Eval("companyname") %>' /></td>
    <td align="right" runat="server" visible="<%#showCity %>">
      <asp:Label runat="server" ID="Label2" Text='<%# Eval("city") %>' /></td>
  </tr>
...
</table> 
```

`showCompanyLogo, showCompanyName and showCity`是在代码隐藏中声明的布尔变量（具有`Protected`访问级别），并根据您要评估的任何条件进行设置。

请注意，您的表格单元格将需要`runat="server"`用于评估服务器表达式。

或者，您可以使用 Ian 提供的解决方案，但您需要将整个表格转换为 Table Webserver 控件，并标记每个元素`runat="server"`。

# java - 在eclipse中从文件中读取

> ID：681059
> 
> 赞同：18
> 
> 时间：2009-03-25T10:46:16.357
> 
> 标签：java, eclipse, file-io

我正在尝试从文本文件中读取数据以将数据输入到我的 java 程序中。但是，无论我将文件放在哪里，eclipse 都会不断地给我一个 Source not found 错误。

我在项目目录中创建了一个额外的源文件夹，有问题的文件在它和项目的 bin 文件中，但它仍然找不到它。

我什至将它的副本放在我的桌面上，并在它要求我浏览源查找路径时尝试将 Eclipse 指向那里。

无论我做什么，它都找不到文件。

这是我的代码，以防万一：

```
System.out.println(System.getProperty("user.dir"));
    File file = new File("file.txt");

    Scanner scanner = new Scanner(file); 
```

另外，它说用户目录是项目目录，那里也有一个副本。

我不知道该怎么做。

谢谢，亚历克斯

在尝试了下面的建议并再次刷新后，我遇到了许多错误。

```
FileNotFoundException(Throwable).<init>(String) line: 195   
FileNotFoundException(Exception).<init>(String) line: not available 
FileNotFoundException(IOException).<init>(String) line: not available   
FileNotFoundException.<init>(String) line: not available    
URLClassPath$JarLoader.getJarFile(URL) line: not available  
URLClassPath$JarLoader.access$600(URLClassPath$JarLoader, URL) line: not available  
URLClassPath$JarLoader$1.run() line: not available  
AccessController.doPrivileged(PrivilegedExceptionAction<T>) line: not available [native method] 
URLClassPath$JarLoader.ensureOpen() line: not available 
URLClassPath$JarLoader.<init>(URL, URLStreamHandler, HashMap) line: not available   
URLClassPath$3.run() line: not available    
AccessController.doPrivileged(PrivilegedExceptionAction<T>) line: not available [native method] 
URLClassPath.getLoader(URL) line: not available 
URLClassPath.getLoader(int) line: not available 
URLClassPath.access$000(URLClassPath, int) line: not available  
URLClassPath$2.next() line: not available   
URLClassPath$2.hasMoreElements() line: not available    
ClassLoader$2.hasMoreElements() line: not available 
CompoundEnumeration<E>.next() line: not available   
CompoundEnumeration<E>.hasMoreElements() line: not available    
ServiceLoader$LazyIterator.hasNext() line: not available    
ServiceLoader$1.hasNext() line: not available   
LocaleServiceProviderPool$1.run() line: not available   
AccessController.doPrivileged(PrivilegedExceptionAction<T>) line: not available [native method] 
LocaleServiceProviderPool.<init>(Class<LocaleServiceProvider>) line: not available  
LocaleServiceProviderPool.getPool(Class<LocaleServiceProvider>) line: not available 
NumberFormat.getInstance(Locale, int) line: not available   
NumberFormat.getNumberInstance(Locale) line: not available  
Scanner.useLocale(Locale) line: not available   
Scanner.<init>(Readable, Pattern) line: not available   
Scanner.<init>(ReadableByteChannel) line: not available 
Scanner.<init>(File) line: not available 
```

使用的代码：

```
System.out.println(System.getProperty("user.dir"));
    File file = new File(System.getProperty("user.dir") + "/file.txt");

    Scanner scanner = new Scanner(file); 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-25T10:52:47.793

将文件复制到那里后，您是否尝试刷新（右键单击-> 刷新）项目文件夹？这将使您的文件系统与 Eclipse 的内部文件系统同步。

当您运行 Eclipse 项目时，CWD（当前工作目录）是项目的根目录。不是 bin 的目录。不是 src 的目录，而是根目录。

此外，如果您使用的是 Linux，请记住它的文件系统通常区分大小写。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-25T10:51:03.583

您是否尝试过使用绝对路径：

```
File file = new File(System.getProperty("user.dir") + "/file.txt"); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-25T11:05:36.280

您正在执行目录（我认为存储类的位置）中搜索/读取文件“fiel.txt”。

如果你想读取给定目录中的文件，你必须这样说：

```
File file = new File(System.getProperty("user.dir")+"/"+"file.txt"); 
```

您还可以为目录提供相对路径，例如子目录的“./images/photo.gif”。

请注意，分隔符还有一个属性（在我的示例中硬编码为“/”）

关于纪尧姆

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-08T22:56:14.593

我正在使用 Eclipse，但由于“找不到文件异常”而无法读取文件。我为解决这个问题所做的是将文件移动到项目的根目录。希望这可以帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T10:59:52.080

您的代码没有任何问题，当我在 user.dir 目录中有 file.txt 时，以下内容对我来说很好。

```
import java.io.File;
import java.util.Scanner;

public class testme {
    public static void main(String[] args) {
        System.out.println(System.getProperty("user.dir"));
        File file = new File("file.txt");
        try {
            Scanner scanner = new Scanner(file);
        } catch (Exception e) {
        System.out.println(e);
        }
    }
} 
```

不要相信 Eclipse 说的文件在哪里。使用 Windows 资源管理器或等效工具进入实际文件系统并检查。

根据您的编辑，我认为我们还需要查看您的导入语句。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-01-18T05:14:58.593

您只需要获取文件的绝对路径，因为您要查找的文件不存在于 Eclipse 的运行时工作区中，您可以使用 - getProperty() 或 getLocationURI() 方法来获取文件的绝对路径

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-05-14T20:23:19.543

有时，即使文件在正确的目录中，仍然会出现“找不到文件”的异常。您可以做的一件事是将文本文件放在左侧的 eclipse 中，即您的类所在的位置。它会询问您是否要复制，单击是。有时它会有所帮助。

# c# - 如何使用 c# 访问 Excel 工作表中的公式？

> ID：681062
> 
> 赞同：0
> 
> 时间：2009-03-25T10:47:18.787
> 
> 标签：c#, excel

我正在解析一个 2000+ 记录的 excel 文件，并且不需要能够从单元格中获取公式本身，而不仅仅是值。例如，一个单元格“贡献”可能是一个数字，例如*1500*，也可能是几个数字*1500+500-200*，但我不想要总数，我想要实际的公式，这样我就可以得到不同的数字。

我只是在用一个 oledbconnection 进行解析，而这似乎只能让我得到总数。我将如何获得公式？有可能（我可以在 XLS 或 XLSX 中获得它）？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T10:53:45.683

快速谷歌发现以下内容：[http ://codingsense.wordpress.com/2009/03/01/get-all-formula-from-excel-cell/](http://codingsense.wordpress.com/2009/03/01/get-all-formula-from-excel-cell/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T11:25:22.143

使用 OLE 自动化，您可以访问单元格中的公式，如下所示：

```
formula = worksheet.Cells(1, 1).Formula 
```

编辑：

要在 C# 项目中使用 OLE 自动化，请参阅以下[Microsoft 知识库文章](http://support.microsoft.com/kb/302084)：

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T11:01:18.147

xslx 是一个 xml 文件，因此应该很容易阅读。或者，您可以使用第三方组件，例如[Infragistics](http://www.infragistics.com/dotnet/netadvantage/winforms/infragisticsexcel.aspx)中的组件，它允许您以编程方式读取 xsl 文件并访问公式。

# c# - Linq2SQL 中奇怪的选择/删除查询生成

> ID：681065
> 
> 赞同：4
> 
> 时间：2009-03-25T10:50:19.297
> 
> 标签：c#, .net, linq-to-sql, inheritance

出于某种或其他原因，Linq2SQL 在我的一张表上生成以下内容以进行删除：

```
DELETE FROM [dbo].[Tag] WHERE ([TagId] = @p0) AND ([Type] = @p1)
-- @p0: Input UniqueIdentifier (Size = 0; Prec = 0; Scale = 0) 
                               [fb538481-562d-45f2-bb33-3296cd7d0b28]
-- @p1: Input TinyInt (Size = 1; Prec = 0; Scale = 0) [1]
-- @p2: Input TinyInt (Size = 1; Prec = 0; Scale = 0) [0]
-- @p3: Input TinyInt (Size = 1; Prec = 0; Scale = 0) [7]
-- @p4: Input TinyInt (Size = 1; Prec = 0; Scale = 0) [5]
-- @p5: Input TinyInt (Size = 1; Prec = 0; Scale = 0) [8]
-- @p6: Input TinyInt (Size = 1; Prec = 0; Scale = 0) [4]
-- @p7: Input TinyInt (Size = 1; Prec = 0; Scale = 0) [3]
-- @p8: Input TinyInt (Size = 1; Prec = 0; Scale = 0) [9]
-- @p9: Input TinyInt (Size = 1; Prec = 0; Scale = 0) [6]
-- @p10: Input TinyInt (Size = 1; Prec = 0; Scale = 0) [1]
-- @p11: Input TinyInt (Size = 1; Prec = 0; Scale = 0) [2]
-- Context: SqlProvider(Sql2008) Model: AttributedMetaModel 
      Build: 3.5.30729.1 
```

如您所见，前 2 个参数（@p0 和 @p1）是正确的，但随后它会生成一个从 0 到 9 的唯一编号的随机集合。

现在这不会以任何方式影响查询/行为，我只是对这里发生的事情感兴趣。

**更新：**

Tag 是 Linq2SQL 继承的基类。似乎额外的参数是所有继承类型的鉴别器（类型）的整数值。如果我删除继承的类型，额外的参数就会下降。

**更新 2：**

我注意到 SELECT 也会发生这种情况。

```
SELECT 
    (CASE 
        WHEN EXISTS(
            SELECT NULL AS [EMPTY]
            FROM [Tag] AS [t0]
            WHERE ([t0].[TagId] = @p0) AND ([t0].[TagType] = @p1)
            ) THEN 1
        ELSE 0
     END) AS [value]
-- @p0: Input Guid (Size = 0; Prec = 0; Scale = 0) 
                   [60000000-0000-0000-0000-fe0000000025]
-- @p1: Input Byte (Size = 0; Prec = 0; Scale = 0) [25]
-- @p2: Input Byte (Size = 0; Prec = 0; Scale = 0) [0]
-- @p3: Input Byte (Size = 0; Prec = 0; Scale = 0) [10]
-- @p4: Input Byte (Size = 0; Prec = 0; Scale = 0) [28]
-- @p5: Input Byte (Size = 0; Prec = 0; Scale = 0) [13]
-- @p6: Input Byte (Size = 0; Prec = 0; Scale = 0) [27]
-- @p7: Input Byte (Size = 0; Prec = 0; Scale = 0) [1]
-- @p8: Input Byte (Size = 0; Prec = 0; Scale = 0) [2]
-- @p9: Input Byte (Size = 0; Prec = 0; Scale = 0) [3]
-- @p10: Input Byte (Size = 0; Prec = 0; Scale = 0) [4]
-- @p11: Input Byte (Size = 0; Prec = 0; Scale = 0) [5]
-- @p12: Input Byte (Size = 0; Prec = 0; Scale = 0) [6]
-- @p13: Input Byte (Size = 0; Prec = 0; Scale = 0) [7]
-- @p14: Input Byte (Size = 0; Prec = 0; Scale = 0) [8]
-- @p15: Input Byte (Size = 0; Prec = 0; Scale = 0) [9]
-- @p16: Input Byte (Size = 0; Prec = 0; Scale = 0) [11]
-- @p17: Input Byte (Size = 0; Prec = 0; Scale = 0) [12]
-- @p18: Input Byte (Size = 0; Prec = 0; Scale = 0) [14]
-- @p19: Input Byte (Size = 0; Prec = 0; Scale = 0) [15]
-- @p20: Input Byte (Size = 0; Prec = 0; Scale = 0) [16]
-- @p21: Input Byte (Size = 0; Prec = 0; Scale = 0) [17]
-- @p22: Input Byte (Size = 0; Prec = 0; Scale = 0) [18]
-- @p23: Input Byte (Size = 0; Prec = 0; Scale = 0) [19]
-- @p24: Input Byte (Size = 0; Prec = 0; Scale = 0) [20]
-- @p25: Input Byte (Size = 0; Prec = 0; Scale = 0) [21]
-- @p26: Input Byte (Size = 0; Prec = 0; Scale = 0) [22]
-- @p27: Input Byte (Size = 0; Prec = 0; Scale = 0) [23]
-- @p28: Input Byte (Size = 0; Prec = 0; Scale = 0) [24]
-- @p29: Input Byte (Size = 0; Prec = 0; Scale = 0) [26]
-- Context: SqlProvider(SqlCE) Model: AttributedMetaModel 
      Build: 3.5.30729.1 
```

只是要注意。根据 MS 示例，我使用枚举作为鉴别器。

**更新 3**

现在我正在运行一个 SQL 分析器，我看到以下内容，这非常令人担忧:(

```
exec sp_executesql N'SELECT 
    (CASE 
        WHEN EXISTS(
            SELECT NULL AS [EMPTY]
            FROM [Tag] AS [t0]
            WHERE ([t0].[TagId] = @p0) AND ([t0].[TagType] = @p1)
            ) THEN 1
        ELSE 0
     END) AS [value]',
N'@p0 uniqueidentifier,
@p1 tinyint,
@p2 tinyint,
@p3 tinyint,
@p4 tinyint,
@p5 tinyint,
@p6 tinyint,
@p7 tinyint,
@p8 tinyint,
@p9 tinyint,
@p10 tinyint,
@p11 tinyint,
@p12 tinyint,
@p13 tinyint,
@p14 tinyint,
@p15 tinyint,
@p16 tinyint,
@p17 tinyint,
@p18 tinyint,
@p19 tinyint,
@p20 tinyint,
@p21 tinyint,
@p22 tinyint,
@p23 tinyint,
@p24 tinyint,
@p25 tinyint,
@p26 tinyint,
@p27 tinyint,
@p28 tinyint,
@p29 tinyint,
@p30 tinyint,
@p31 tinyint,
@p32 tinyint',
@p0='60000000-0000-0000-0000-FE0000000025',
@p1=25,@p2=0,@p3=23,@p4=29,@p5=31,@p6=16,@p7=14,@p8=1,@p9=2,
@p10=3,@p11=4,@p12=5,@p13=6,@p14=7,@p15=8,@p16=9,@p17=10,@p18=11,
@p19=12,@p20=13,@p21=22,@p22=15,@p23=17,@p24=18,@p25=19,@p26=20,
@p27=21,@p28=27,@p29=24,@p30=26,@p31=30,@p32=28 
```

谢谢

雷比

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T15:11:45.037

这听起来像是 Linq2Sql 中的某个错误。我认为不应该生成额外的参数。

我认为你应该在[Microsoft Connect](http://connect.microsoft.com)上提交一个错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T10:54:45.667

非常有趣 - 看起来它无法决定是否可以使用主键......对象模型是什么样的？没有手工继承或任何东西？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T10:59:33.533

您是否为转换为@p1 的参数传递了一个可枚举的集合而不是一个标量值？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T01:24:28.330

TagId 是否在 DBML 设计器属性中标记为您的主键？要检查，请打开 DBML 文件，单击 Tag 类的 TagId 属性并查看属性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T06:41:52.610

请从项目中删除 dbml 文件，重新启动 Visual Studio 并重建 dbml 文件。有时，Visual Studio 会缓存旧版本的 sql 表或存储过程架构。这可能有助于 linq 正确处理 sql。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T11:41:41.653

有没有想过自己偷窥框架源代码并调试场景？

由于 .NET Framework 的源代码终于可用，这很容易实现 :)

链接：[配置 Visual Studio 以调试 .NET Framework 源代码](http://blogs.msdn.com/sburke/archive/2008/01/16/configuring-visual-studio-to-debug-net-framework-source-code.aspx)

# c - 在 C 中的函数内声明结构

> ID：681068
> 
> 赞同：4
> 
> 时间：2009-03-25T10:52:24.143
> 
> 标签：c, optimization, data-structures

我有一个只有一个函数必须访问的结构。该函数将诸如“k, K, kb, KB, m, M, mb, MB, ...”之类的标记转换为实际单位。这样做的目的是简化配置文件。

所以，假设我们有：

```
static uint32_t real_unit(const char *str)
{
    struct u2type {
      char key[3];
      uint32_t val;
    } const u2types[] = {
       { "k", KB_UNIT },
       { "K", KB_UNIT },
       { "kb", KB_UNIT },
       { "KB", KB_UNIT },
       { "m", MB_UNIT },
       { "M", MB_UNIT },
       { "mb", MB_UNIT },
       { "MB", MB_UNIT },
       { "g", GB_UNIT },
       { "G", GB_UNIT },
       { "gb", GB_UNIT },
       { "GB", GB_UNIT },
       { { 0 }, 0 }
    };

    ... code to look up str ...
} 
```

我见过其他程序，其中 struct u2type 将被声明为静态（同样，在函数内），但我看不出它有什么用处。结构不会改变，每次输入函数时它总是一样的。这就是为什么我把它设为常量。

然而，我看到很多人在一个范围很明显的函数中执行 statc struct foo { ... } const foos[] = { ... }。

这样做有什么好处吗？在进入 SO 之前，我会尝试研究 ASM 输出，并提出诸如此类的优化问题，但我不是装配大师 :)

**编辑：**

是的，我知道这种方法闻起来像脚。有些项目只是有奇怪的要求（通常是由奇怪的人要求的）。然而，这个问题与函数的使用完全不同。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-25T10:58:11.397

使其成为 const 并使其成为 static 做两件不同的事情。

*   如果是 const，则每个函数调用都会获得自己的不可更改的结构实例
*   如果它是静态的，则结构的一个可变实例在所有函数调用中共享

听起来您想要的是一个既是静态又是常量的结构实例，这是一件合理的事情。

性能方面，静态版本应该有一点优势，因为结构实例的构造只会执行一次。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-25T10:59:54.500

如果您将数组声明为静态，它将被放置在可执行文件的数据部分并仅初始化一次（在第一次访问时）甚至不初始化（它可能已经在可执行文件中初始化）。

如果没有静态，数据将在每个函数调用的堆栈上，并在每次调用函数时初始化。

只是有点挑剔，当您说您已经看到`struct u2type`静态代码时，这不是真的。尽管静态存储说明符出现在结构之前，但它确实适用于变量，在本例中为数组。即使

```
static struct foo { ... } foos [] = { ... }; 
```

然后你可以做

```
struct foo foo1={ ... }; 
```

并且`foo1`将是一个自动变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T10:59:14.640

如果你在函数中声明一个静态变量，它只会在第一次进入函数时初始化一次。如果您将其声明为非静态，则每次输入函数时都会对其进行初始化。

在您的情况下，它可能会有所不同。使用*静态*数组将在静态存储中分配并初始化不超过一次。如果没有*静态*，它将在堆栈上分配，并且每次调用该函数时。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T11:06:17.230

局部变量或常量在堆栈上分配。它们的存在仅在函数执行期间持续存在，并且一旦函数返回，它们的值就会丢失。每次调用函数时都会进行分配和赋值。

声明一个局部变量或常量静态意味着它的值将保持从一次调用到下一次调用。这是通过全局分配而不是在堆栈上来实现的。分配和赋值只执行一次，在频繁调用函数中的大数据结构的情况下，这可能会导致性能提升。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T11:32:26.747

哎呀。至少将您的函数名称更改为“case_insensitive_guess_unit”。其中大多数不是“真实”单位，那些（例如“K”是开尔文而不是公斤，“b”通常是位，“B”字节）不是你要返回的单位。

如果规范是 k[b] -> 1000、m[b] -> 1000000 等，那么简单的 if/else 可能更快、更清晰。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T14:02:58.803

...

```
// so, do you want odor-free, or fast ?
switch (str[0]){
case 'g': case 'G':
  return GB_UNIT;
case 'k': case 'K':
  return KB_UNIT;
case 'm': case 'M':
  return MB_UNIT;
} 
```

# extjs - refresh a page in extjs

> ID：681075
> 
> 赞同：3
> 
> 时间：2009-03-25T10:56:09.343
> 
> 标签：extjs

How can i refresh grid data when new data added in exts?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T11:19:07.323

这取决于您如何添加新数据，如果它发生在服务器上并且您想要刷新 Ext JS 视图：

```
grid.getStore().reload() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T12:30:44.843

我也修复它

store.reload();

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-20T15:57:00.997

reload 在 js ext 4 中被贬值。对 js ext 4 使用 load()。

# c# - 多次重用后台工作者

> ID：681076
> 
> 赞同：6
> 
> 时间：2009-03-25T10:57:28.000
> 
> 标签：c#, backgroundworker

我正在使用后台工作人员进行昂贵的操作：

```
backgroundWorker1.DoWork += new DoWorkEventHandler(backgroundWorker1_DoWork);
backgroundWorker1.ProgressChanged += new ProgressChangedEventHandler(backgroundWorker1_ProgressChanged);
backgroundWorker1.RunWorkerCompleted += new RunWorkerCompletedEventHandler(backgroundWorker1_RunWorkerCompleted);
backgroundWorker1.RunWorkerAsync(inputs); 
```

最后我有这个：

```
 void backgroundWorker1_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
{
   Messagebox.Show("Done with expensive operation 1"};
} 
```

我现在有另一个昂贵的手术。我可以重用这个相同的后台工作人员吗？我现在想要新的回调，因为我不希望 ProgressChanged 和 DoWork 回调上的 switch 语句来确定我是在执行操作 1 还是 2。

使用 2 个单独的后台工作类是否更简单

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-25T11:00:31.517

是的，您可以重复使用 a `BackgroundWorker`- 但您只能在任何时候使用一次 - 不能同时使用。但是，如果操作不同，我会使用单独的工作人员。否则，您将不得不取消挂钩事件，挂钩正确的事件等。混乱。

# php - PHP 线程安全吗？

> ID：681081
> 
> 赞同：58
> 
> 时间：2009-03-25T10:58:11.600
> 
> 标签：php, multithreading, thread-safety

*   **PHP（从 5.2 开始）在 Linux/UNIX 上是线程安全的吗？**
*   **是否可以将它与 Apache Worker-MPM 或 Event-MPM 一起使用？**

到目前为止，我收集的事实尚无定论：

*   大多数发行版中包含的默认二进制文件都禁用了 ZTS，所以我知道，我必须重新编译它们。
*   理论上，启用 ZTS 的 Zend Engine（核心 PHP）是线程安全的。
*   据说有些模块可能不是线程安全的，但我没有找到任何模块列表是或不是。
*   [PHP FAQ](http://www.php.net/manual/en/faq.installation.php#faq.installation.apache2)状态与上面几乎相同。

你有什么经验？

这不仅仅是[分段错误](http://en.wikipedia.org/wiki/Segmentation_fault)（Windows 命名法中的“访问冲突”）。[线程安全](http://en.wikipedia.org/wiki/Thread_safe)还有很多。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-25T12:10:12.427

我知道 gettext 和[set_locale](http://php.net/manual/en/function.setlocale.php)不是线程安全的。PHP 不应与线程 MPM 一起使用。

[PHP 还不是线程安全的](http://neosmart.net/blog/2008/dont-believe-the-lies-php-isnt-thread-safe-yet/)。
[运行 PHP 没有线程](https://stackoverflow.com/questions/1646249/php-gettext-problems-like-non-thread-safe/6726570#6726570)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-14T10:08:10.670

请参阅*[在哪里可以获得编译某些可选 PHP 扩展所需的库？](http://php.net/manual/en/faq.obtaining.php#faq.obtaining.optional)*获取线程安全和非线程安全扩展的列表（* 标记的不是线程安全的，其他是）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-25T12:19:42.437

一个更好的问题可能是，“如果使用 MPM，以下 PHP 代码是否会触发访问冲突？” 或者，“您是否遇到过可能归因于使用以下函数的并发问题的奇怪行为？”

否则，就是俄罗斯轮盘赌。如果您使用的是一些打包的应用程序，它现在可能工作得很好，但是从现在开始一个月后，当应用程序的新版本出现时就会中断。

我强烈建议不要将 MPM 与 PHP 一起使用。但是，如果您有一些小代码要运行，您可以发布它，我们可以告诉您是否会遇到陷阱。

# apache-flex - Flex 3 将对象从 Flex 传递到 java 类

> ID：681083
> 
> 赞同：1
> 
> 时间：2009-03-25T10:58:38.713
> 
> 标签：apache-flex, remoting

我想将一个对象从我的 Flex 应用程序传递回我的 Java 应用程序。我正在查看传递给 Serlet 或通过 DAO 作为对象传递。

有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T19:06:54.110

查看[Adob​​e 的 BlazeDS](http://opensource.adobe.com/wiki/display/blazeds/BlazeDS/)。它提供了将对象从 flex 传递到 java 的中间件，反之亦然。它允许您在 flex 中使用 RemoteObject 和 Messaging 抽象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T12:43:04.423

你是如何连接到java的？你在用 AMF 吗？

一般来说，作为对象传递将是总体上最好的解决方案，因为无论如何您都可能会在您的 flex 应用程序中使用该对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T13:43:52.700

看看[RemoteObjects](http://livedocs.adobe.com/flex/3/html/help.html?content=data_access_4.html)。

# hibernate - 休眠回滚

> ID：681084
> 
> 赞同：2
> 
> 时间：2009-03-25T10:58:56.077
> 
> 标签：hibernate, transactions, rollback

如果我执行以下操作

session.getTransaction().rollback();

那么是否可以/可以开始在同一个会话对象上调用保存/更新/删除等？[在Hibernate Session/Transaction API](http://www.hibernate.org/hib_docs/v3/api/)或 Hibernate 参考文档中找不到答案。

还是您建议我关闭该会话对象，打开一个新会话并开始一个新事务？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T11:14:59.330

我说关闭会话并打开一个新会话。Hibernate 并不以容忍滥用其会话而闻名。它可能会稍微损害性能，但它可能会防止出现错误。

尤瓦尔=8-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T11:03:44.897

从数据库的角度来看，我不确定这是否可行/可行，但是编写原子代码对于可读性来说要好得多。您甚至可以重用模板方法的结构来忘记围绕您的事务的布线。

# javascript - 如何在 HTML iFrame 中检测滚动条的存在（使用 Javascript）？

> ID：681087
> 
> 赞同：21
> 
> 时间：2009-03-25T10:59:30.600
> 
> 标签：javascript, html, dom, iframe, scrollbar

如何在 HTML iFrame 中检测滚动条的存在（使用 Javascript）？

**我已经尝试过：**

```
 var vHeight = 0;
        if (document.all) {
          if (document.documentElement) {
            vHeight = document.documentElement.clientHeight;
          } else {
            vHeight = document.body.clientHeight
          }
    } else {
      vHeight = window.innerHeight;
    }

    if (document.body.offsetHeight > vHeight) {
      //when theres a scrollbar
    }else{
      //when theres not a scrollbar
    } 
```

**我也试过：**

```
 this.scrollLeft=1;
    if (this.scrollLeft>0) {
        //when theres a scrollbar
        this.scrollLeft=0;
        }else{
        //when theres not a scrollbar
        return false;
    } 
```

没有成功..

我在*DOM Inspector*上搜索了*javascript 对象*，但没有找到任何东西。

 *是否可以在 javacscript 的 iframe 中检测到滚动条的存在？

* * *

iframe 内容来自同一个域。

到现在都没有成功。。

[替代文字 http://www.upvtp.com.br/file.php/1/help_key.jpg](http://www.upvtp.com.br/file.php/1/help_key.jpg)

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-03-25T14:03:29.283

```
var root= document.compatMode=='BackCompat'? document.body : document.documentElement;
var isVerticalScrollbar= root.scrollHeight>root.clientHeight;
var isHorizontalScrollbar= root.scrollWidth>root.clientWidth; 
```

这会检测是否*需要*滚动条。对于 iframe 的默认设置，这与是否有滚动条相同*，*但如果滚动条被强制打开或关闭（使用父文档中的 'scrolling="yes"/"no"' 属性，或 CSS 'overflow: scroll /hidden' 在 iframe 文档中）那么这可能会有所不同。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-25T11:04:19.853

使用 jQuery，您可以比较文档高度、scrollTop 位置和视口高度，这可能会为您提供所需的答案。

类似于以下内容：

```
$(window).scroll(function(){
  if(isMyStuffScrolling()){
    //There is a scroll bar here!
  }
}); 

function isMyStuffScrolling() {
  var docHeight = $(document).height();
  var scroll    = $(window).height() + $(window).scrollTop();
  return (docHeight == scroll);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-08-19T00:33:28.207

```
$(window).scroll(function(){
  if(isMyStuffScrolling()){
//scrolling
  }else{
//not scrolling
}
}); 

function isMyStuffScrolling() {
  var docHeight = $(document).height();
  var scroll    = $(window).height() ;//+ $(window).scrollTop();
  if(docHeight > scroll) return true;
  else return false;
} 
```

改进了乔恩的温斯坦利代码

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T11:24:31.960

由于 JavaScript 安全限制，如果 iframe 内容来自另一个域，我认为无法做到这一点。

编辑：在这种情况下，给 iframe 一个 name='someframe' 和 id='someframe2' 然后比较 frames['someframe'].document.body.offsetWidth 与 document.getElementById('someframe2') .offsetWidth 应该会给你答案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-01-04T10:27:41.453

我发现这适用于任何元素，至少在 Chrome 上：

```
hasVerticalScrollbar = (element.scrollHeight > element.offsetHeight)
        || 
(element.scrollHeight > element.clientHeight 
```

水平滚动条也可以被检测到，使用`Width`代替`Height`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-26T07:12:26.737

我认为你的第二次尝试是在正确的轨道上。除了代替`this`，您应该尝试滚动/检查`document.body`。

# winforms - Winforms多线程场景问题

> ID：681093
> 
> 赞同：2
> 
> 时间：2009-03-25T11:00:46.493
> 
> 标签：winforms, multithreading

今天早上我从我的一位同事那里看到了一些奇怪的代码。在一个 winforms 应用程序中，整个 Mainform 被提供给一个线程作为参考。他这样做是为了调用表单中的方法。没有与 UI 交互，只是简单的计算方法。我已经确定这不是最佳实践，但我想知道一些事情。如果我从线程内部调用 Mainform 中的方法，这些方法是否仍作为多线程处理？还是它们在 Mainform 内部运行？当我从线程调用 Mainfrom 中的方法时，UI 线程会受到影响吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T11:08:05.307

从不同线程调用的表单中的函数将在调用它们的线程上运行，并且对 GUI 线程没有影响。作为副作用，这意味着如果您调用与 GUI 交互的函数，您将得到一个异常。

如果您希望在 GUI 线程上调用它们，最简单的方法是调用`Control.Invoke(...)`，这会导致您传入的委托在 GUI 线程上执行，从而允许 GUI 交互。

# asp.net - ASP.NET bug iframe 隐藏文本框？

> ID：681096
> 
> 赞同：0
> 
> 时间：2009-03-25T11:02:52.417
> 
> 标签：asp.net, html, xhtml, iframe

那么这是我的问题：我在第一个单元格中有一个带有 iframe 的表格，然后下面的一些行有一些文本框和按钮。但只要 iframe 在页面上，按钮和文本框就不会出现。

我究竟做错了什么？

```
<table>
<tr>
<td>
<Iframe/>
</td>
</tr>
<tr>
<td>
<input type="password">
</td>
</tr>
</table> 
```

下面演示的是相同的代码，它隐藏了文本框

- -桌子 - -

---表到此结束---

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T11:06:25.340

确保您正确关闭 iframe 标记

```
<iframe src="xyz.aspx" id="ifr" name="ifr" ></iframe> 
```

结束标签->“ `</iframe>`”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T11:15:36.147

这不是 ASP.NET 错误！甚至没有 HTML 错误。

James_Smith 是对的，`<iframe>`元素不是自关闭的，需要单独的关闭标签。

# ruby-on-rails - 一个控制器的多个布局

> ID：681101
> 
> 赞同：1
> 
> 时间：2009-03-25T11:04:38.730
> 
> 标签：ruby-on-rails, css, layout

是否有可能做这样的事情：

```
class SimulationController < ApplicationController
  layout "generic", :only => [:login, :invalid]
  layout "menubar", :except => [:login, :invalid] 
```

出于某种原因，我的`login`页面仍然使用菜单栏布局（我可以判断，因为菜单栏会出现在顶部）。如果我注释掉第 3 行，菜单栏就会消失。因此，似乎两种布局都在一个接一个地应用。

但是如果我注释掉那`layout "generic"`一点，我会它只是黑白的，这意味着没有应用 CSS 样式表。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T11:48:02.090

您看起来像是在尝试在不同的运行时条件下应用不同的布局。解决这个问题的最简单方法是使用布局的方法参考。

例如： -

```
class ResourceController < ActionController::Base
  layout :choose_layout

  private
    def choose_layout    
      if [ 'signup', 'login' ].include? action_name
        'login_layout'
      else
        'admin_layout'
      end
    end 
```

查看“布局类型”标题下 ActionController::Layout的 Rails [API 参考](http://api.rubyonrails.org/classes/ActionController/Layout/ClassMethods.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T11:57:11.427

看看这张票，你的问题似乎是类似的：[ [http://dev.rubyonrails.org/ticket/8867]](http://dev.rubyonrails.org/ticket/8867])

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T11:47:09.970

做到这一点的一种方法实际上是在你的行动中。

```
def login
  render :action => "login", :layout => "generic"
end 
```

您还可以将实际的“菜单栏”html 设为部分内容，并在某些条件下关闭渲染。

# domain-driven-design - 领域模型保存

> ID：681103
> 
> 赞同：4
> 
> 时间：2009-03-25T11:05:23.923
> 
> 标签：domain-driven-design, domain-model

最近读完了 Eric Evans Domain Driven Design（内容丰富，非常有趣），但是在完成本书后来到第一个重大项目，并遇到了如何处理域模型保存的问题？

我很欣赏服务/存储库的使用以及它们如何帮助模型，但他们将如何处理模型保存？

我以前的域模型保存将遵循以下方法调用结构；

父类.保存 {

ParentClassDB.保存

ChildObject1.Save

```
 ChildObject1DB.Save 
```

ChildObject2.Save

```
 ChildObject2DB.Save  
  etc etc 
```

}

服务是否控制对子对象调用适当的保存例程？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T11:21:21.593

在 DDD 中，域实体不关心其持久性。理想情况下，你不应该有一个`Save()`方法。

您的存储库将具有这样的`Save`方法，该方法在参数中采用实体实例：

```
public class PersonRepository
{
   //...

   public void Save(Person person)
   {
      this.dataContext.Save(person);
   }

   //...
} 
```

根据您的堆栈，ORM 将处理对象保存，或者您将通过构造一个查询来保存人员，或者您将使用您的实例值等填充存储过程参数。

如果我正确理解了您所做的事情，则可能有必要将您放在域实体中的持久性逻辑移到其他地方，可能在存储库中，或者在存储库使用的 DAL 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T11:19:31.347

你使用聚合根吗？他们有责任拯救他们的实体。

如果有很多修改正在进行，一种方法可能是将逻辑封装在域服务中，并让服务通过聚合根处理保存。

# java - 对象验证

> ID：681110
> 
> 赞同：0
> 
> 时间：2009-03-25T11:07:24.573
> 
> 标签：java

我有一个需要验证的对象。该对象具有不能为空的属性、不能超过给定大小的字符串和我需要检查格式正确性的日期字符串。

您将如何执行此验证。我不想遍历整个对象，我正在寻找更动态的东西

编辑：

该对象将用于 web 服务输入，因此任何 setter 验证都将毫无用处，而且我不知道系统将如何处理任何基于注释的系统的附加依赖项

我正在寻找自定义解决方案（是的，我知道重新发明轮子）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T11:49:55.313

您似乎希望在 Web 服务的服务器端验证对象。如果是这样，我建议的答案可能适用于您的情况。

毫无疑问，您已经看到，有几种方法可以验证对象中的字段。但是您知道需要做什么：检查每个字段以查看其值是否有效。这里没有魔法：您只需检查字段。

如果您希望将验证代码保存在一个地方，您可能会做的一件事是创建一个包含验证逻辑的 xml 模式，从中生成您的类，并使用该模式作为参考来验证您通过网络获取的对象. 这使得维护验证代码和类变得容易：您只需更新模式并重新生成类。（我什至不会将类保留在源代码控制中。只需在编译代码之前生成它。这可以保证您的类始终与您的模式同步。）我确信在 Java 中有用于此的库（JAXB，也许？），但我已经多年没有使用 Java 了。在许多语言中，这是一件*很*常见的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T11:10:24.177

如果没有确切的场景，我可以建议您使用对象的 setter 方法（您*确实*将字段设为私有，对吗？）来验证对值的每次更改。字符串设置器可以调用长度验证代码，日期设置器可以调用格式验证代码等。

希望这可以帮助，

尤瓦尔=8-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T11:14:51.827

检查[休眠验证器](http://www.hibernate.org/412.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T11:23:13.523

看看[Apache Commons Validator](http://commons.apache.org/validator/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T11:48:53.787

Web 服务的基本验证在 WSDL/XSD 级别处理。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T11:23:41.133

建议您在设置对象的属性之前进行验证。例如，如果您有一个从字符串解析的 int 属性，那么您需要在设置它之前检查 null、空字符串、是数字等。否则无论如何你都会遇到类型问题。而且，如果您想将错误值显示给用户，那么您需要保留原始字符串。

如果这是一个 Web 应用程序，那么有很多框架会为您完成这部分工作，然后使用已验证且类型安全的值初始化您的对象。我想到了 Struts 或 Spring-MVC，但我不是 Web 开发人员。他们使用某种 xml 配置来描述您的对象和相关的验证，您也可以对其进行扩展。如果这不是网络事物，那么他们可能会稍微妨碍他们，因为他们想要处理错误并将错误页面直接显示给您的用户。

对于一些更低的尝试[Apache Commons Validator](http://commons.apache.org/validator/)。

# eclipse - 如何向 Eclipse 工具栏添加按钮？

> ID：681113
> 
> 赞同：12
> 
> 时间：2009-03-25T11:08:28.347
> 
> 标签：eclipse

我现在正在使用 Eclipse 的第六个版本，但我一直无法弄清楚如何将按钮添加到工具栏。
例如，默认情况下，我在 Java 透视图中有一个小的“打开类型”按钮，我想在它旁边添加一个“打开类型层次结构”按钮。这两个功能都可以在导航菜单上彼此相邻使用，我也只想将其中一个拖到工具栏上。

对我来说似乎并不遥远？我通过右键单击工具栏尝试了“自定义透视图”，但无济于事。我似乎能够添加我不想要的东西。有任何想法吗？我碰巧在使用`Eclipse 3.4.2 M20081224-0800`，但我从来没有在多个版本中使用过这个。

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T11:53:49.440

“自定义透视图”的诀窍是只反映 'plugin.xml' [**org.eclipse.ui.commands**](http://help.eclipse.org/ganymede/index.jsp?topic=/org.eclipse.platform.doc.isv/guide/workbench_cmd_commands.htm)贡献点。

换句话说，您可以激活/停用这些扩展点，而不是更改它们。

[如此消息](http://dev.eclipse.org/newslists/news.eclipse.newcomer/msg07380.html)中所述（对于另一个按钮）：

> 据我所知，用户无法配置所谓的“基本”工具栏。
> 
> 我认为有两种方法可以添加“全部保存”按钮：
> 
> *   编写一个插件，添加一个包含“全部保存”按钮的新工具栏部分
> *   修补插件“ `org.eclipse.ui.ide`”：在类中`WorkbenchActionBuilder`插入以下行 #374 之后（如果您希望它出现在“保存”和“打印”之间）：

```
fileToolBar.add(saveAllAction); 
```

不过， Eclipse3.5[可能已经改变了这一点。](http://dev.eclipse.org/newslists/news.eclipse.tools.jdt/msg23990.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-02-25T18:26:56.357

在新的 eclipse Helios 工具栏中有一个叫做外部工具按钮的按钮，很容易定制。我用它来通过单击运行 ant build 我想它会很有用尝试一下

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-05T05:20:55.403

必须有一种方法，因为旧的 GWT 插件在工具栏上同时具有“新 Web 应用程序”和“编译”按钮。

最新版本默认关闭。

# php - PHP会话修改的缓存控制标头？

> ID：681115
> 
> 赞同：11
> 
> 时间：2009-03-25T11:09:16.597
> 
> 标签：php, zend-framework, caching

我正在使用`Zend_Controller_Response`对象将图像输出到浏览器。我打算将缓存应用于图像，但是某些原因导致 Cache-Control 标头被覆盖。

我的代码如下：

```
$this->getResponse()
    ->setHeader('Last-Modified', $modifiedTime, true)
    ->setHeader('ETag', md5($modifiedTime), true)
    ->setHeader('Expires', $expires, true)
    ->setHeader('Pragma', '', true)
    ->setHeader('Cache-Control', 'max-age=3600')
    ->setHeader('Content-Type', $mimeType, true)
    ->setHeader('Content-Length', $size, true)
    ->setBody($data); 
```

输出（在 Firebug 中查看）是：

**响应标头**

> 日期
> 
> 格林威治标准时间 2009 年 3 月 25 日星期三 10:34:40
> 
> 服务器
> 
> Apache/2.2.3 (Ubuntu) mod_ssl/2.2.3 OpenSSL/0.9.8c
> 
> 过期
> 
> 格林威治标准时间 2009 年 3 月 26 日星期四 10:34:41
> 
> 缓存控制
> 
> 无存储，无缓存，必须重新验证，检查后 = 0，预检查 = 0，最大年龄 = 3600
> 
> 最后修改
> 
> 1234872514
> 
> 埃塔格
> 
> d3ef646c640b689b​​0101f3e03e08a524
> 
> 内容长度
> 
> 1452
> 
> X-UA 兼容
> 
> IE=仿真IE7
> 
> X-Robots-标签
> 
> 无索引
> 
> 活着
> 
> 超时=15，最大值=100
> 
> 联系
> 
> 活着
> 
> 内容类型
> 
> 图片/JPEG

**请求标头**

> 主持人
> 
> khall.####.###.######.com
> 
> 用户代理
> 
> Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.7) Gecko/2009030422 Ubuntu/8.04 (hardy) Firefox/3.0 .7
> 
> 接受
> 
> 文本/html,应用程序/xhtml+xml,应用程序/xml;q=0.9,*/*;q=0.8
> 
> 接受语言
> 
> en-gb,en;q=0.5
> 
> 接受编码
> 
> gzip，放气
> 
> 接受字符集
> 
> ISO-8859-1,utf-8;q=0.7,*;q=0.7
> 
> 活着
> 
> 300
> 
> 联系
> 
> 活着
> 
> 推荐人
> 
> http://khall.####.###.######.com/
> 
> 曲奇饼
> 
> PHPSESSID=abf5056e1289d3010448107632a1c1bd

如您所见，缓存控件被修改为包括：

> 无存储，无缓存，必须重新验证，检查后 = 0，预检查 = 0

我怀疑是在请求中发送的会话 cookie。有谁知道发送我需要的标头的方法，但仍将会话保留在请求中？我的应用程序通过引导程序运行，并且使用 Zend_Session 处理会话。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-25T13:25:44.103

假设此行为与 PHP 中的会话机制有关，您是对的。有一个配置设置`session.cache_limiter`控制将与响应一起发送的缓存 HTTP 标头。这里的默认设置是`nocache`发送

```
Expires: Thu, 19 Nov 1981 08:52:00 GMT 
Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0 
Pragma: no-cache 
```

除了 -header 之外，您在控制器中覆盖所有这些标头`Cache-Control`（您只在此处附加您的`max-age=3600`设置）。

可能的解决方案是：

1.  将 PHP 配置 ( [`session.cache_limiter`](http://de3.php.net/manual/en/session.configuration.php#ini.session.cache-limiter)) 更改为 eg `none`- 但这可能会给其他 PHP 应用程序带来问题
2.  `session.cache_limiter`使用在每个请求上设置[`session_cache_limiter()`](http://de3.php.net/manual/en/function.session-cache-limiter.php)
3.  用指定的字符串覆盖`Cache-Control`控制器中的完整标头

`session.cache_limiter`和的可能值`session_cache_limiter()`是：

**none** : 不发送标头

**无缓存**：

```
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
Pragma: no-cache 
```

**私人**：

```
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: private, max-age=10800, pre-check=10800 
```

**private_no_expire**：

```
Cache-Control: private, max-age=10800, pre-check=10800 
```

**公开**：

```
Expires: pageload + 3 hours
Cache-Control: public, max-age=10800 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-25T11:32:55.543

来自 Zend_Controller 文档，第[10.9 节。响应对象](http://framework.zend.com/manual/en/zend.controller.response.html)

> setHeader($name, $value, $replace = false) 用于设置单个标题。默认情况下，它不会替换对象中现有的同名标头；但是，将 $replace 设置为 true 将强制它这样做。

您遇到的问题是您的 max-age=3600 被附加到缓存控制标头，而不是替换它。尝试将**$replace**参数设置为**true**。

# javascript - 在 JavaScript 中使用 attachEvent() / addEventListener() 添加的访问事件

> ID：681120
> 
> 赞同：6
> 
> 时间：2009-03-25T11:10:19.763
> 
> 标签：javascript, events

如何访问在 JavaScript 中使用`attachEvent()`/添加的事件？`addEventListener()`

用例：使用 FireBug 的控制台调试事件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T11:54:00.593

没有办法访问它们。

根据您要实现的目标，调试事件的更好方法可能是从事件处理函数中输出您感兴趣的[事件属性...](http://www.quirksmode.org/js/events_properties.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T12:14:51.887

如果您总是使用自定义方法添加和删除处理程序，则可以在同一方法中维护它们的日志。这样做会增加一些开销。

例如，这里有一篇关于 IE 的文章——

```
//Run=window.Run || {Shadow:{},nextid:0};

else if(window.attachEvent){    
    Run.handler= function(who, what, fun){
        if(who.attachEvent){

            who.attachEvent('on'+what, fun);

            var hoo=who.id || who.tagName+(++Run.nextid);
            if(!Run.Shadow[hoo])Run.Shadow[hoo]={};
            if(!Run.Shadow[hoo][what])Run.Shadow[hoo][what]=[];
            Run.Shadow[hoo][what].push(fun);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-06T12:52:20.803

我知道在 jQuery（1.8 版之前）你可以做类似的事情

```
$element.data('events') 
```

并且使用 fireQuery 您实际上可以[像这样在 HTML 选项卡中看到处理程序](http://gyazo.com/b7fdaae0832397940e124eb70784f048.png?1325854217)

也看到[这个](https://stackoverflow.com/questions/2623118/inspect-attached-event-handlers-for-any-dom-element)

# python - list[-1:][0] 和 list[len(list)-1] 有什么区别？

> ID：681123
> 
> 赞同：7
> 
> 时间：2009-03-25T11:11:46.170
> 
> 标签：python, list, slice

以免说你想要 python 列表的最后一个元素：有什么区别

```
myList[-1:][0] 
```

和

```
myList[len(myList)-1] 
```

我认为没有区别，但后来我尝试了这个

```
>>> list = [0]
>>> list[-1:][0]
0
>>> list[-1:][0] += 1
>>> list
[0]
>>> list[len(list)-1] += 1
>>> list
[1] 
```

我有点惊讶……

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-25T11:15:40.187

如果使用切片 [-1:]，则返回的列表是浅拷贝，而不是引用。所以 [-1:][0] 修改了新列表。[len(list)-1] 是对最后一个对象的引用。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-25T11:17:16.657

`list[-1:]`创建一个新列表。`list[len(list)-1]`要获得与必须返回某种视图相同的行为`list`，但正如我所说，它会创建一个新的临时列表。然后您继续编辑临时列表。

无论如何，你知道你可以`list[-1]`用于同样的事情，对吧？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T11:34:54.913

切片创建副本（浅副本）。它通常用作浅拷贝习语。

IE

```
list2 = list1[:] 
```

相当于

```
import copy
list2 = copy.copy(list1) 
```

# version-control - 哪些版本控制程序可以在集成更改之前强制运行和通过测试？

> ID：681129
> 
> 赞同：7
> 
> 时间：2009-03-25T11:14:48.097
> 
> 标签：version-control, testing, tdd, aegis

在我的工作中，我们目前使用[Aegis](http://aegis.sourceforge.net/)版本控制/SCM。我们配置它的方式，我们有一堆测试，它强制以下事情是真实的，然后才能集成更改：

*   必须运行全套测试。
*   所有测试都必须通过。

对于测试驱动开发 (TDD)，这些似乎是明智的要求。但我还没有听说过任何其他版本控制系统都可以做到这一点。（我们目前不打算切换，但我想知道将来如何在不使用 Aegis 的情况下进行切换。）

我会对*任何*可以做到这一点的 VCS（分布式或非分布式）感兴趣，我也对允许这样做的现有 VCS 的任何插件/扩展感兴趣。最好是开源软件。

**ETA：**好的，看起来通常的做法是拥有 VCS + 持续集成软件，并且作为构建的一部分自动运行测试，而不是作为一个单独的步骤。如果我理解正确，那仍然*可以让*您提交未通过测试的代码，只是您会收到有关它的通知-对吗？有什么东西会阻止你整合/提交它吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T17:20:24.037

如果您想强制测试通过，并根据测试结果进行构建而不是签入，那么IMO 最好使用像[CruiseControl](http://cruisecontrol.sourceforge.net/)或[Hudson这样的持续集成系统。](http://hudson-ci.org/)这些工具设置起来很简单，您可以获得内置的结果通知（通过电子邮件、RSS 或浏览器插件）和通过网页报告测试结果的优势。

关于问题的更新，您是对的 - VCS + CI 允许您提交未通过测试的代码；对于大多数 CI 设置，除非所有测试都通过，否则您将无法获得产品的最终构建。如果您真的想阻止任何人甚至提交，除非所有测试都通过，您将不得不按照其他人的建议在 VCS 中使用钩子。但是，这在我看来很难处理 - 要么开发人员每次进行签入时都必须运行所有测试，包括与他们正在进行的签入无关的测试，或者您必须制作一些非常精细的 VCS 挂钩，仅运行与给定签入相关的测试。根据我的经验，依靠开发人员在本地运行相关测试并让 CI 系统发现偶尔出现的错误会更有效。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T11:16:47.673

使用 subversion 和 git，您可以添加预提交挂钩来执行此操作。

听起来您需要查看持续集成（或变体）。

认为 Git 在应用补丁上也有一个钩子。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T11:38:10.927

[Subversion](http://svnbook.red-bean.com/en/1.2/svn.reposadmin.create.html#svn.reposadmin.create.hooks)和[git](http://git-scm.com/docs/githooks)都通过预提交钩子支持这一点。

[Visual Studio Team System 通过签入策略](http://msdn.microsoft.com/en-us/library/ms181458.aspx)本机支持这一点。

我相信 Rational ClearCase 也支持它，尽管我从未见过它被证明过，所以我不能肯定地说。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-26T03:24:49.343

我们使用[git](http://git-scm.com/)和[buildbot](http://buildbot.net/trac)来做类似的事情，虽然不完全相同。我们为每个开发人员提供自己的 Git 存储库，并设置 buildbot 以在任何时间推送到其中一个存储库时进行构建。然后有人充当集成者，他可以检查 buildbot 状态、查看更改并合并他们的更改或告诉他们适当地修复某些东西。

这个工作流程有很多变体，你可以用 Git 做。如果您不想让某人手动集成，您可能会设置 buildbot 以在成功时运行脚本，该脚本会自动将该人的更改合并到主存储库中（尽管它必须处理以下情况自动合并不起作用，它还必须测试合并结果，因为即使是干净合并的代码有时也会引入其他问题）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T11:49:49.573

我相信像 Team City 这样的持续集成软件可以让你进行预提交构建和测试。我不知道有任何直接提供它的 vcs……可能有一些像您使用的那样，但我不熟悉它们。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-11-18T20:24:18.527

您还可以在 Perforce 中使用预提交挂钩。而且，如果您是 .NET 商店，则可以将 Visual Studio 配置为需要“门控”签入。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-26T14:50:51.347

带有自定义工作项的 VSTS，对吧？我认为使用它没有任何问题。内置报告。自动化的选择。为什么不？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-15T09:43:08.377

我在这里所做的是遵循[每个任务模式的分支，](http://www.cmcrossroads.com/bradapp/acme/branching/branch-creation.html)它可以让您测试已经提交给版本控制的代码，但仍然保持主线的原始状态。更多关于这种模式[的信息](http://blog.accurev.com/2007/10/11/stream-per-task-paradigm-with-accurev-software-configuration-management/)。

[您可以在此处](http://codicesoftware.blogspot.com/2008/04/integration-strategies.html)找到有关集成策略的更多信息，也可以在[此处](http://codicesoftware.blogspot.com/2008/08/4-steps-to-make-version-control-shine.html)找到有关版本控制的 Mark Shuttleworth 的评论。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-11-20T04:11:58.387

大多数 CI 实现都有一种机制来拒绝不符合所有标准的签入（最值得注意的是通过所有测试）。他们被称为不同的名字。VCS 应该做他们最擅长的事情。版本源代码。

*   TeamCity -[预测试提交](http://www.jetbrains.com/teamcity/features/delayed_commit.html)
*   TFS -[门控签到](http://blogs.msdn.com/b/patcarna/archive/2009/06/29/an-introduction-to-gated-check-in.aspx)

# java - 为什么只有在运行 JUnit 测试时堆空间才会用完？

> ID：681133
> 
> 赞同：30
> 
> 时间：2009-03-25T11:15:33.883
> 
> 标签：java, eclipse, junit, out-of-memory

在运行 JUnit 测试时，我似乎总是遇到这个错误：

> eclipse outOfMemoryError：堆空间

我用 JConsole 监控了 Eclipse，堆内存峰值约为 150MB。我已将堆内存设置为 1GB。

我在启动 Eclipse 时使用以下参数：

```
-vm "C:\Program Files\Java\jre1.5.0_08\bin\javaw.exe" -vmargs -Xmx1024M
-XX:MaxPermSize=128M -Dcom.sun.management.jmxremote.port=8999
-Dcom.sun.management.jmxremote.ssl=false
-Dcom.sun.management.jmxremote.authenticate=false

```

有谁知道可能导致此问题的原因？它仅在运行 JUnit 测试时发生。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-03-25T11:23:24.957

Junit 测试在与 Eclipse IDE 不同的虚拟机中运行。所以是那个 vm 内存不足，而不是 Eclipse 那个。
您可以在测试的运行配置中更改测试虚拟机的设置。
您转到运行配置，然后在参数下，您可以设置 vm 参数。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2010-09-17T10:29:01.653

继@Thijs Wouters 响应之后，为了在 Eclipse 中解决此问题，我执行了以下操作：

*   在 JUnit 下添加了新的运行配置（运行>运行配置>JUnit>新建）
*   在参数选项卡中，将 VM 参数设置为“-Xms64m -Xmx256m”或更高（如果需要）

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-03-25T13:05:28.987

您的 JUnit 测试中可能存在内存泄漏。一个常见的问题是：Junit 将为其中的*每个测试方法*创建一个 TestCase 类的新实例，并且所有实例变量都将保留，直到 JUnit 终止。这意味着：如果您有一个包含 50 个测试方法的 TestCase 类和一个在 setUp() 方法中使用 1MB 对象图初始化的实例变量，那么该 TestCase 类将需要 50MB 堆空间。

**编辑：**上述问题仅存在于旧版本的 JUnit 中，我认为它已在 JUnit 4 中修复。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-22T22:11:16.307

我刚刚发布了一个 Eclipse 插件，它会自动为您设置 JUnit 启动器的堆大小。您可以从[http://code.google.com/p/junitlaunchfixer/](http://code.google.com/p/junitlaunchfixer/)获得它。它适用于 Eclipse Europa、Ganymede 和 Galileo。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-05-27T07:10:49.777

我找到了我的问题的解决方案 - 它可能对其他人有所帮助；）当我增加堆大小时，我增加了 eclipse 应用程序的堆大小，而不是我的程序（我通过 eclipse 执行）我必须做的是修改在运行我的程序之前执行命令。

# c++ - cpp迭代器问题

> ID：681142
> 
> 赞同：1
> 
> 时间：2009-03-25T11:18:02.800
> 
> 标签：c++, templates

```
template<class T>
    class mStack
    {
    private:
       vector<T> a; 
       vector<T>::iterator top;
    public:
       void push(T);
       T pop();
       mStack();
       void printStack();
}; 
```

上面类的代码没有被编译......为什么？问题是什么？编译器说“预期；高于顶部”。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-25T11:20:26.727

你需要一个类型名：

```
typename vector<T>::iterator top; 
```

这让编译器放心 thar`vector<T>`确实是一种类型。有关此问题和其他模板问题的讨论，请参阅[C++ 常见问题解答](http://www.parashift.com/c++-faq-lite/templates.html)。

# php - 使用 PHP 函数 oci_connect 获取 ORA Oracle 错误代码？

> ID：681144
> 
> 赞同：0
> 
> 时间：2009-03-25T11:18:07.187
> 
> 标签：php, oracle

如果失败，PHP 函数 oci_connect（连接到 Oracle 数据库）只会返回 false，目前我的处理方式如下：

```
$connection = oci_connect($username, $password, $database);
if (!$connection){
    return $result = "Trouble connecting to the Oracle Database";
} 
```

但我真的很想得到实际的 ORA 错误代码，所以我可以提供更多信息。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T11:21:01.797

您是否尝试过检查[oci_error()](http://au2.php.net/manual/en/function.oci-error.php)的结果？

我没有将 Oracle 与 PHP 一起使用（很遗憾），但 MySQL 的一般模式是：

```
if (!mysql_connect(...)) {
  error_log('Error connecting: ' . mysql_error()); // or just die
} 
```

Oracle 模式似乎是合乎逻辑的：

```
if (!oci_connect(...)) {
  error_log('Error connecting: ' . oci_error());
} 
```

# c++ - 如何打印 Qt 对话框或窗口？

> ID：681148
> 
> 赞同：4
> 
> 时间：2009-03-25T11:19:34.170
> 
> 标签：c++, linux, qt, printing

如何让 Qt 打印完整的对话框或窗口？我可以使用外部程序转储窗口内容`xwd`并打印，但我更愿意使用 Qt 来完成。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-25T11:28:34.883

使用[QPixmap::grabWidget](http://doc.trolltech.com/4.5/qpixmap.html#grabWidget)（或[QPixmap::grabWindow](http://doc.trolltech.com/4.5/qpixmap.html#grabWindow)用于外部窗口）。像这样的东西：

```
QPixmap pix = QPixmap::grabWidget(myMainWindowWidget); 
```

不知道您是否真的打算将其打印到打印机上，如果是这样：

```
QPrinter printer(QPrinter::HighResolution);
QPainter painter;
painter.begin(&printer);    
painter.drawPixmap (0, 0, &pix);    
painter.end(); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-25T20:30:10.523

虽然您可以使用[grabWidget](http://doc.trolltech.com/4.5/qpixmap.html#grabWidget)来获取对话框的像素图表示，但实际上您将打印像素图的像素，即对话框被光栅化为屏幕分辨率，然后缩放到打印机分辨率。这可能会或可能不会导致某些伪影。

另一种方法是使用带有绘图设备的[QWidget::render()](http://doc.trolltech.com/4.5/qwidget.html#render)函数。这样，您可以将打印机作为绘图设备传递。对话框现在以打印机的分辨率“绘制”到打印机上。

# ruby - 使用 Webrat 进行测试时如何处理 cookie？

> ID：681183
> 
> 赞同：1
> 
> 时间：2009-03-25T11:30:23.303
> 
> 标签：ruby, testing, sinatra, webrat

我正在使用 Webrat 为基于 Sinatra 的应用程序编写 Cucumber 测试。对于某些测试，我需要实现一个场景，例如

```
Given I am logged in as admin
When I am visiting "/"
Then I should see "Settings" 
```

我定义这样的步骤：

```
Given /^I am logged in as "(.+)"$/ do |user|
    visit "/login"
    fill_in "login", :with => user
    fill_in "password", :with => "123456"
    click_button "Login"
end

When /^I am viewing "(.+)"$/ do |url|
    visit(url)
end

Then /^I should see "(.+)"$/ do |text|
    response_body.should =~ /#{text}/
end 
```

成功时会创建一个 cookie

```
response.set_cookie(cookie_name, coockie_value) 
```

然后在用户尝试通过辅助方法访问管理页面时在视图中进行验证：

```
def logged_in?
    request.cookies[cookie_name] == cookie_value
end 
```

而且看起来 Webrat 不存储 cookie。测试不报告任何错误，但“logged_in?” 在视图中总是错误的，就像 cookie 没有保存一样。

难道我做错了什么？如果这正是 Webrat 的工作方式，那么最好的解决方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-27T17:30:06.380

真正的问题是 Sinatra 在测试环境中处理会话的方式。在 Google 群组中搜索讨论，但真正的解决方案是简单地使用：

```
use Rack::Session::Cookie 
```

而**不是**

```
enable :sessions 
```

使用 Selenium 很好，但它作为 OP 问题的解决方案有点过头了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T16:23:42.650

You could have your "Given /^I am logged in" step hack `logged_in?`:

```
Given /^I am logged in as "(.+)"$/ do |user|
    visit "/login"
    fill_in "login", :with => user
    fill_in "password", :with => "123456"
    click_button "Login"

    ApplicationController.class_eval <<-EOE
      def current_user
        @current_user ||= User.find_by_name(#{EOE})
      end
    end
EOE
end 
```

There are two downsides:

1.  It's *really* hackish to mix view-level and controller-level issues like this.
2.  It'll be difficult to mock up "logout"

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T13:32:24.530

解决方法是使用带有 Selenium 后端的 Webrat。它在单独的 Firefox 窗口中运行所有测试，因此 cookie 或 javascript 不是问题。缺点是需要额外的时间和资源来运行 Firefox 并完成所有真正的点击、渲染等。

# c# - 如何使用来自不同数据上下文的对象处理提交？

> ID：681186
> 
> 赞同：0
> 
> 时间：2009-03-25T11:30:48.807
> 
> 标签：c#, .net, linq-to-sql

我遇到了一个问题，即使用来自两个相同类型的数据上下文的对象，不会提交对象。为了简单起见，请考虑以下 LINQ-to-SQL 设计，其中我们有描述汽车和人员的数据库表。

```
+--------------+         +--------+
| Car          | 1     1 | Person |
+--------------+---------+--------+
| Registration |         | name   |
| ownerId {FK} |         +--------+
+--------------+ 
```

然后我们有两个数据存储库，它们具有相同数据上下文类的实例，具有以下方法：

```
public OwnerRepository {
    private MyDataContext db;

    public Person GetOwnerByName(string ownerName)
    {
        return (from person in db.Persons
               where person.Name == ownerName
               select person).SingleOrDefault();
    }
}

public CarRepository {
    private MyDataContext db;

    public Car GetCarByRegistration(string registration)
    {
        return (from car in db.Cars 
               where car.Registration == registration
               select car).SingleOrDefault();
    }

    public void RegisterOwner(Person owner, string registration)
    {
        var car = GetCarByRegistration(registration);
        car.Owner = owner;
        db.SubmitChanges();
    }
} 
```

假设我们从 OwnerRepository 获取一个 Person 并使用它来将该人注册为汽车的所有者：

```
var owner = ownerRepository.GetOwnerByName("Peter Pan");
carRepository.RegisterOwner(owner, "TOO COOL"); 
```

该方法`RegisterOwner`将引发异常，因为数据上下文无法识别 Person 对象（即使它属于同一类型）。你能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T11:33:43.030

为什么你有两个不同`DataContexts`的开始？这听起来是个坏主意。为什么不给`CarRepository`你传入的构造函数`DataContext`？然后两个存储库可以使用相同的`DataContext`.

使用单一`DataContext`方式提交可以作为一个事务进行，并且您不会遇到奇怪的问题，即上下文中的缓存对数据库中的内容有不同的想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T12:24:47.057

Linq2sql 不支持直接使用跨数据上下文对象 -serialize/deserialize/attach 真的不值得。

您拥有的场景是存储库之间耦合的结果。您正在使用相同的 datacontext 类创建对它的内部依赖，该类在 RegisterOwner 代码中显示，尝试直接使用接收到的实体。

考虑一下如果调用代码更新了 person 实体上的某些东西会发生什么，RegisterOwner 的代码真的应该保存这些更改吗？

存储库级别的这种类型的耦合在相同的有界上下文中可能是可以的。如果这些应该是独立子系统的片段，那么汽车存储库将专注于仅保存它要处理的信息，这是在汽车系统中识别用户的所有者信息的子集。这就是允许您在此过程中切换片段的原因。当然，这在您想要更高程度的分离的更复杂的场景中更有意义。

Notice that on the sample posted you are not really needing to update anything on Person, so you could effectively go with a version that only sets the person id on the car owner info, instead of assigning it the full Person instance.

For the more coupled scenario, you can use Jon's answer - give them the same DataContext instance.

# cocoa - 如何获取响应者链中的对象来处理“insertText：”消息？

> ID：681188
> 
> 赞同：0
> 
> 时间：2009-03-25T11:32:03.203
> 
> 标签：cocoa, events

我有一个`NSView`实现`acceptsFirstResponder`和的子`resignFirstResponder`类`becomeFirstResponder`。它还实现了以下方法：

`-(void)keyDown:(NSEvent *) event {
[self interpretKeyEvents:[NSArray arrayWithObject:event]]; }`

我处理`interpertKeyEvent:`在 appController 类中发送的消息（appController 是`NSWindow`委托，因此是响应者链的一部分）。

这种方法适用于大多数由 生成的消息`interpertKeyEvent:`，例如和`insertNewline:`，但不适用于。`moveUp:``moveDown:``insertText:`

如何获取响应者链中的对象来处理`insertText:`消息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-10-12T23:58:02.457

您必须`NSTextInput`为您的类实现协议，然后将调用 insertText。查看[Aquamacs](http://github.com/davidswelt/aquamacs-emacs/blob/master/src/nsterm.m)中的 nsterm.m 以获取如何实现它的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T15:33:06.293

根据文档，NSResponder 的标准实现：

“NSResponder 实现只是将此消息传递给下一个响应者，或者如果没有下一个响应者则发出哔哔声。”

我想到了两种可能性：要么您的视图不在响应者链中的预期位置，要么您的方法签名与预期的不匹配：

*   (void)insertText:(id)aString

你是如何实现acceptsFirstResponder、resignFirstResponder和becomingFirstResponder的？

您的应用程序是使用 NSWindowControllers 还是基于文档的应用程序？

有关事件处理架构的更多文档：

[http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/EventOverview/EventArchitecture/EventArchitecture.html#//apple_ref/doc/uid/10000060i-CH3-SW2](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/EventOverview/EventArchitecture/EventArchitecture.html#//apple_ref/doc/uid/10000060i-CH3-SW2)

# c++ - 如何从两个向量（实数和虚数）中获取复数向量

> ID：681192
> 
> 赞同：1
> 
> 时间：2009-03-25T11:33:03.047
> 
> 标签：c++, stl, vector, complex-numbers

我有两个浮点向量，我希望它们成为一个复数向量。我被困住了。我不介意使用迭代器，但我相信它会重新发现我不知道的轮子。我的代码是否引导我朝着正确的方向前进？

```
typedef std::vector<float> CVFloat;
CVFloat vA, vB;
//fil vectors
typedef std::complex<CVFloat> myComplexVector;
myComplexVector* vA_Complex = new myComplexVector(vA, vB); 
```

上面的代码正确地通过编译器，但是当我想使用迭代器从 myComplexVector 获取单个数字时，我得到错误“未定义的符号'const_iterator'”（Borland C++）

```
myComplexVector::const_iterator it = vA_Complex->begin(); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T11:37:20.790

在这里，您正在创建一个“复杂”对象，其实部和虚部是浮点数的向量。
也许您真正想做的是创建一个由实部和虚部是浮点数的复杂对象组成的向量？

编辑： myComplexVector*不是*向量，是复杂的。这就是为什么 a `const_iterator`for it 没有被定义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T11:40:51.547

您可以创建一个通用的“zip”函数，将迭代器带到两个向量，一个转换器仿函数和一个输出迭代器：

```
template< typename at_It1, typename at_It2, typename at_Transform, typename at_Out >
void zip( at_It1 from1, const at_It1 to1, 
          at_It2 from2, const at_It2 to2,
          at_Transform  tranformer,
          at_Out& av_Out ) {
    while( from1 != to1 ) {
        av_Out = transformer( *from1, *from2 );
        ++av_Out; ++from1; ++from2;
    }
}

struct DoubleToComplex {
     complex<double> operator()( const double d1, const double d2 ) const {
         return complex<double>( d1, d2 );
     }
};

zip( vA.begin(), vA.end(),
     vB.begin(), vB.end(),
     DoubleToComplex(),
     std::back_inserter( vTarget ) ); 
```

我希望STL中有这样的功能......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T11:44:40.727

为什么不让它更容易呢？

```
vector< complex<float> > result;
for( int i = 0; i < vA.size(); i++ ) {
    result.push_back( complex<float>( vA[i], vB[i] ) );
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T11:39:36.493

这没有任何意义：

```
typedef std::complex<CVFloat> myComplexVector; 
```

你肯定是说

```
typedef std::complex <float> ComplexFloat;
typedef std::vector <ComplexFloat> CFVector; 
```

或类似的东西？

一旦你有了它，你可以简单地迭代浮点向量（假设它们包含匹配值）并使用 push_back() 添加到你的复数向量中：

```
CFVector v;

for ( int i = 0; i < vA.size(); i++ ) {
  v.push_back( ComplexFloat( vA[i], vB[i] ) );
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T11:39:46.120

最简单的方法就是写循环

```
myComplexVector cv;
for(CVFloat::iterator it1=vA.begin(), end1=vA.end(), 
      it2=vB.begin(), end2=vB.end();
    it1!=end1 && it2 != end2; ++it1, ++it2)
  cv.push_back(std::complex(*it1, *it2)); 
```

编辑：...并按照 Neil 的建议正确声明 myComplexVector 类型。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T11:37:22.083

复数只是一对两个实数`a`，`b`表示复数`a+bi`。你到底想用这两个向量做什么？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-25T12:07:49.297

我理解您想将实部向量与虚部向量组合成复数向量的问题。

`std::complex`有一个模板参数，可让您选择复杂部分的数字表示（即，如果您想要基于甚至某些自定义数字类型的复杂值`double`...... `float`）。然后复数类型根据基础类型定义基本复数代数。

在您的代码中，您试图构建一个基于浮点向量的复杂类型（即具有实部和虚部为向量的*单个*复值），这显然是错误的。相反，您需要一个*浮点类型的复数向量*

您必须执行以下操作：

```
// ...
typedef std::vector<std::complex<float> > floatComplexVector;
floatComplexVector vA_Complex; // No need to 'new' !?

for (CVFLoat::const_iterator itA = vA.begin(), itB = vB.begin(); 
     itA != vA.end() && itB != vB.end(); 
     ++itA,++itB)
  vA_Complex.push_back(std::complex<float>(*itA, *itB)); 
```

*评论：*

*   在大多数情况下，没有必要在堆上创建诸如向量之类的容器（即使用`new`） 尽量避免这种情况。

*   不幸的是，C++ 标准库不包含组合迭代器（即“自动”组合两个序列的组合迭代器），这将允许更优雅的解决方案（请参阅[Boost Zip 迭代器](http://www.boost.org/doc/libs/1_38_0/libs/iterator/doc/zip_iterator.html)了解一般想法）。

# c++ - 如何使用 2 个导出相同函数名的 C 库

> ID：681200
> 
> 赞同：4
> 
> 时间：2009-03-25T11:35:45.957
> 
> 标签：c++, c, word-wrap, ambiguity

**以下问题的重复：[C函数冲突](https://stackoverflow.com/questions/678254/c-function-conflict)**

* * *

嗨，在我目前的项目中，我必须使用某种接口库。函数名由这个接口给出，这个函数做什么由开发者选择。据我所知，项目应使用此功能，并且在编译时选择库及其功能。我尝试做的是通过包装另一个并在 mein 函数中调用它来同时使用现有的库和我的库：

其他库：

```
int function1 (int a) {
// do something
} 
```

我的库：

```
int function1 (int a) {
//my code here
    otherlib::function1(a);
} 
```

问题是我无权访问另一个库，另一个库没有任何命名空间。我已经试过了

```
namespace old {
    #include "otherlib.h"
} 
```

然后在我的函数中通过 old::function1 调用旧函数。只要它只是头文件，它就可以工作。该库将其符号导出回全局空间。还有类似的东西

```
namespace new {
    function1 (int a) {
        ::function1(a);
    }
} 
```

没用。最后但并非最不重要的一点是，我尝试了 ifdefs 并[在这里定义了建议](https://stackoverflow.com/questions/189921/how-to-handle-a-class-name-conflict-when-porting-old-code)

但我没有成功。

任何想法如何解决这个问题？提前致谢。

编辑：我既无权访问旧库，也无权访问两个库的项目。

EDIT2：至少旧库是静态库

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T11:42:55.817

C 中的命名空间使用库名称前缀解决，例如：

libfoo --> foo_function1
libbar --> bar_function1

这些前缀是实际的命名空间。所以如果你写 libbar

```
int bar_function1(int a) {
     function1(a);
} 
```

这是解决问题的方法。

C 有命名空间——它们只是称为前缀；）

另一种选择是通过动态加载库来执行各种肮脏的技巧，例如：

```
h1=dlopen("libfoo.so")
foo_function1=dlsym(h1,"function1")

h2=dlopen("libbar.so")
bar_function1=dlsym(h2,"function1") 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-25T11:50:14.673

好像另一个库是 C 而你的代码是 C++。您可能会遇到重载问题（C++ 编译器会破坏符号——在符号名称中添加额外的东西来区分重载等）。

如果库是纯 C，您可以尝试：

```
extern "C" { // disable mangling of symbol names in the block
#include "otherlib.h"
}

namespace new_lib { // new is a reserved word
   int function1( int a ) {
      ::function1(a);
   }
} 
```

我还没有尝试过。还要考虑提供您收到的错误消息。

另一种选择是（如果库是动态的）动态加载库并调用函数。在linux中（我不知道windows）你可以使用dlopen打开库，dlsym获取符号并调用它：

```
// off the top of my head, not tried:
int function1( int a )
{
   int (*f)(int); // define the function pointer
   void * handle = dlopen( "library.so" );
   f = dlsym( handle, "function1" );
   f( a ); // calls function1(a) in the dynamic library
} 
```

在这种情况下，由于您没有链接到库，因此不会出现符号冲突，但话又说回来，它仅对动态库有效，并且对于常规使用来说非常麻烦。

**更新**

如果您的用户不会直接使用“otherlib”（他们不会包含他们的标题）并且他们将只是 C++，那么第一种方法可能是可能的（即使阅读起来很糟糕）：

```
// newlib.h
namespace hideout {
   int f( int a );
}
using namespace hideout; // usually I would not put this on the header

// newlib.cpp
extern "C" { // if otherlib is C, else remove this line
#include "otherlib.h"
}
namespace hideout {
   int f( int a ) { return ::f( a*2 ); }
}

// main.cpp
#include "newlib.h"
int main()
{
   std::cout << f( 5 ) << std::endl;
} 
```

它是如何工作的？用户代码只会看到 function1 的声明（在示例 f() 中），因为它们不包括*otherlib.h*。在您的编译单元中，您会看到两个声明，但您可以通过命名空间的使用来区分。标题中的 using 语句不会打扰您，因为您完全符合您的 cpp。用户*main.cpp*将仅包含您的标头，因此编译器只会看到*hideout::f*，并且由于 using 语句而将在任何地方看到它。链接器将没有问题，因为 C++ 符号被破坏以识别真正的命名空间：

```
// g++ 4.0 in macosx:
00002dbe T __ZN7hideout9function1Ei // namespace hideout, function1 takes int, returns int
00002db0 T _function1 
```

如果用户代码将同时包含您的标头和*otherlib.h*，那么它将必须限定要调用的函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T18:27:46.997

如果您真的很绝望，您可以编写一个使用名称空间或前缀或允许使用 dlsym 技巧的包装库。这个包装库需要动态链接（以避免符号冲突）。然后动态库可以安全地将旧的静态库嵌入其中。只需确保在制作动态包装库时不要从静态库中导出符号。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T18:28:12.300

您无法在链接时解决此问题，因此您需要在运行时通过动态库解决它。一旦生成了库，这些函数的符号本质上就是烘焙它。如果两个库导出相同的符号，则它们不能都静态链接。

# php - Zend：重定向后是否可以发送视图变量？

> ID：681204
> 
> 赞同：1
> 
> 时间：2009-03-25T11:37:39.993
> 
> 标签：php, zend-framework

完成重定向后如何发送其他视图参数（例如 $this->_redirect->gotoSimple();）？

例如，假设我有一个 Edit 操作，它将用户重定向到一个错误操作处理程序，我希望能够将自定义的详细错误消息发送到它的视图。为了更清楚地说明它，流程将是：

1.  在编辑视图（比如[http://localhost/product/edit](http://localhost/product/edit)），用户提交了一些讨厌的东西
2.  在 editAction() 处，失败检查会触发重定向到我的错误视图/操作处理程序（这样我的 URL 就会像[http://localhost/error/index](http://localhost/error/index)一样）
3.  Error/index.phtml 采用“errorMessage”视图变量来显示自定义错误消息，并且 editAction() 需要一种方法将一些值传递给该“errorMessage”视图变量

一个快速的代码片段可能看起来像：

```
public function editAction() {
    //DO THINGS...

    // Upon failure
    if($fail) {
        $this->_redirector->gotoUrl('/error/index');
        //TODO: I need to be able to do something like
        //      $errorView->errorMessage = "Generic error";
    }
} 
```

非常感谢任何解决方案，甚至其他更好的方法来实现这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T11:48:07.707

不要`gotoURL()`用于内部重定向。使用`gotoSimple()`. 我最多需要 4 个参数：

```
gotoSimple($action, 
           $controller = null, 
           $module = null, 
           array $params = array()) 
```

在您的情况下，它将是：

```
$this->_redirector->gotoSimple('index',
                               'error',
                                null,
                                array('errorMessage'=>$errMsg)); 
```

详情请参阅[`Redirector Zend_Controller_Action_Helper`](http://framework.zend.com/manual/en/zend.controller.actionhelpers.html#zend.controller.actionhelpers.redirector)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-25T19:27:10.723

我在任何地方都没有看到一个动作（editAction）访问另一个动作的视图（errorView）。对于错误处理的特殊情况，我的想法是使用异常。您针对不同的不良情况抛出不同的异常，并且在您的错误处理程序操作中，您可以根据异常类型决定向用户显示什么：

```
// file: ProductContorller.php
public function editAction() {
    // some code
    if ($badThing) {
         throw new Exception('describe the bad thing',$errorCode);
    }
    if ($badThing2) {
         throw new Exception('describe the other bad thing',$errorCode2);
    }
}

// file: ErrorController.php
public function errorAction() {
     $error = $this->_getParam('error_handler');
     $exception = $error->exception; // the original Exception object thrown by some code
     $code = $exception->getCode();
     switch ($code ) {
          // decide different things for different errors
     }
} 
```

有关错误处理的更多信息，[Zend 框架快速入门](http://framework.zend.com/docs/quickstart/create-an-error-controller-and-view)是一个很好的教程。

对于其他情况，您可以使用一些消息传递机制在这两个操作之间进行通信。我首先想到的是使用 flashMessenger 动作助手：

```
// file: ProductContorller.php
public function editAction() {
    // some code
    if ($badThing) {
         $this->_helper->flashMessenger->addMessage('error1');
         $this->_redirect('error');
    }
    if ($badThing2) {
         $this->_helper->flashMessenger->addMessage('error2');
         $this->_redirect('error');
    }
}

// file: ErrorController.php
public function errorAction() {
     $errors = $this->_helper->flashmessenger->getMessages();
     if ( in_array('error1',$errors) ) {
       // do something
     } // elseif ( ...
} 
```

尽管请记住 flashMessenger 使用会话，因此会话和最有可能的 cookie 将参与此消息传递过程。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-28T23:30:24.373

执行此操作的标准方法是使用基于会话的存储您希望显示的消息。有一个基于视图的帮助程序[FlashMessenger](http://framework.zend.com/manual/en/zend.controller.actionhelpers.html#zend.controller.actionhelpers.flashmessenger)是很常见的。

> FlashMessenger 帮助器允许您传递用户可能需要在下一个请求中看到的消息。为此，FlashMessenger 使用 Zend_Session_Namespace 来存储消息以供将来或下一个请求检索。如果您计划使用 Zend_Session 或 Zend_Session_Namespace，通常最好在引导文件中使用 Zend_Session::start() 进行初始化。（有关其用法的更多详细信息，请参阅 Zend_Session 文档。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-04T09:50:37.863

通过这个链接..它解释了我们如何在 _redirect 之前设置视图变量

[http://www.rmauger.co.uk/2009/06/creating-simple-extendible-crud-using-zend-framework/](http://www.rmauger.co.uk/2009/06/creating-simple-extendible-crud-using-zend-framework/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-29T16:32:48.927

我将添加它以提供有关 FlashMessenger 类如何工作的更多信息（我在弄清楚它时遇到了一些问题）。

我在某处读到应该在 Bootstrap.php 中使用

```
Zend_Session::start(); 
```

..但是我的代码没有那个就可以工作，所以我怀疑会话已经开始了。

我们在一个控制器对象中，并且正在调用一个动作方法。然后发生了一些事情，比如对数据库的插入或编辑，任何事情。

我们现在设置一个或多个消息。我使用以下语法。

```
$this->_helper->FlashMessenger("Message in a bottle."); 
```

这与使用*完全相同*

```
$this->_helper->FlashMessenger->addMessage("Message in a bottle."); 
```

这会在会话中设置一条消息，您可以通过调用直接检查

```
print_r($this->_helper->FlashMessenger->getMessages());
die(); 
```

现在有一个重定向到一个新的url（基本上是一个新的请求），在处理请求的控制器+动作中，我们将消息添加到视图中，如下所示：

```
$this->view->flashMessages = $this->_helper->FlashMessenger->getMessages(); 
```

我们现在可以选择在哪里输出这些消息。我们可以在“属于”某个控制器的视图中执行此操作，因此可以

```
views/scripts/index/index.phtml 
```

这里的缺点是您必须将输出消息的代码添加到使用它的每个视图脚本中。那不是很[干燥](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)。

在我看来，一个更好的解决方案如下。在定义应用程序基本布局的文件中输出这些消息。这大概就是

```
layouts/scripts/index.phtml 
```

我在那里写了以下代码。

```
<?php if( isset($this->flashMessages) && !empty($this->flashMessages) ){ ?>
    <ul id="messages">            
        <?php foreach( $this->flashMessages as $message ){?>
            <li>
                <?php echo $message;?>
            </li>    
        <?php } ?>
    </ul>
<?php } ?> 
```

# java - 将图像插入 Excel - Java

> ID：681206
> 
> 赞同：0
> 
> 时间：2009-03-25T11:38:59.990
> 
> 标签：java, excel, image

我正在开发一个 java web 应用程序，我必须在 excel 文件上显示图像。我使用 java 文件 iopo 将图像写入 excel 文件。

问题是当用户将此邮件发送给客户端时，图像不会显示

有什么方法可以使用 java 将图像嵌入到 excel 文件中，使用/不使用任何外部 API。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T11:44:18.480

您可以使用 Apache POI： http: [//poi.apache.org](http://poi.apache.org)

特别参见[http://poi.apache.org/spreadsheet/quick-guide.html#Images](http://poi.apache.org/spreadsheet/quick-guide.html#Images)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T11:40:17.257

您必须使用外部库，因为没有适用于 Java 的标准 Excel API。

您应该使用类似于[**JExcelAPI**](http://jexcelapi.sourceforge.net/)的东西。

# iphone - iPhone中是否有任何看起来像LED的字体？

> ID：681214
> 
> 赞同：8
> 
> 时间：2009-03-25T11:41:10.157
> 
> 标签：iphone, objective-c

我正在开发一个简单的 iPhone 应用程序。我需要一种看起来像 LED 的字体。iPhone中是否有任何看起来像LED的字体？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-25T11:52:45.260

您可能想尝试“DBLCDTempBlack”

可以在此处找到可用字体列表：http: [//ajnaware.wordpress.com/2008/10/24/list-of-fonts-available-on-the-iphone/](http://ajnaware.wordpress.com/2008/10/24/list-of-fonts-available-on-the-iphone/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-25T11:57:11.677

是的，有“DB LCD Temp Black”字体。

在代码中，它的名字是“DBLCDTempBlack”。

```
[UIFont fontWithName:@"DBLCDTempBlack" size:yoursize]

```

# c++ - 将文件写入 U 盘会导致意外删除时文件损坏/锁定

> ID：681221
> 
> 赞同：1
> 
> 时间：2009-03-25T11:43:52.787
> 
> 标签：c++, winapi, usb, writefile

我正在编写一个后台应用程序，以将文件循环复制到带有“优化以快速删除”策略集的 USB 记忆棒。但是，如果在此过程中（特别是在下面的 WriteFile() 调用中，它返回 ERROR FILE NOT FOUND）中删除了存储棒，则应用程序挂起，则驱动器将永久无法从任何其他应用程序访问，并且 PC 无法关闭/注销/重新启动等。所有正在运行的 Windows 资源管理器实例也会因此挂起。

我已将问题追溯到移除棒后进行的 CloseHandle() 调用并发生上述错误。几乎就好像 CloseHandle() 无限期地阻塞在某个地方的驱动程序中，因为棒不再存在？无论如何，如果 WriteFile() 返回 ERROR FILE NOT FOUND，我通过简单地跳过 CloseHandle() 调用来解决这个问题。但是，这会导致另一个问题，即文件每隔一段时间就会被不可恢复地损坏，修复它的唯一方法是使用 chkdsk 或重新格式化存储棒。

请注意，这只发生在 XP（SP2 和 3）上，Vista 似乎没有遇到此问题。代码片段如下：

```
HANDLE hFile = CreateFile(szFile, 
                          GENERIC_WRITE, 
                          FILE_SHARE_WRITE | FILE_SHARE_READ | FILE_SHARE_DELETE,
                          NULL,
                          CREATE_ALWAYS,
                          FILE_FLAG_WRITE_THROUGH,
                          NULL);
if (hFile != INVALID_HANDLE_VALUE)
{
    if (!WriteFile(hFile, pBuffer, dwBufferSize, &dwWritten))
    {
        int nLastError = GetLastError();
    }

    // If usb stick is removed during WriteFile(), ERROR_FILE_NOT_FOUND usually      results.
    // If handle is closed at this point then drive is inaccessible.
    // If CloseHandle() is skipped, then file corruption occurs instead
    if (nLastError != ERROR_FILE_NOT_FOUND)
    {
        CloseHandle(hFile);
    }
} 
```

我已经尝试了 CreateFile() 的几乎所有标志组合都无济于事。有没有人以前见过这个或有任何好主意如何避免发生这两个问题中的任何一个。我看到的驱动程序问题是否已在 vista 下静默修复？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T17:48:03.580

> 几乎就好像 CloseHandle() 无限期地阻塞在某个地方的驱动程序中，因为棒不再存在？

听起来很合理。CloseHandle() 最终将发出一个文件系统 IRP，并且您没有使用非阻塞 I/O，因此 IRP 将是同步的，但看起来实际文件系统突然从文件系统驱动程序下方消失了，即IRP 永远不会完成。这意味着你被塞满了——导致发出文件系统 IRP 的用户模式函数调用将永远不会返回。

尝试使用非阻塞 I/O - 至少从不挂起的角度来看，这将帮助您解决这个问题。您仍然会遇到资源丢失等问题，因为 IRP 仍将被传递，并且几乎可以肯定仍然不会恢复，但至少您不会阻止它。

顺便说一句，我会说“为快速删除而优化”旨在减少正在进行的缓存数量，并可能影响写入文件系统的顺序以减少损坏的机会；我非常怀疑它是否打算在写入*期间*文件系统离开的情况下保留文件系统！

你不应该对这会杀死文件系统感到惊讶。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T14:07:11.740

这似乎是驱动程序的问题。

您必须释放驱动程序的所有句柄，让它自行清理，并释放 Windows 来卸载它。如果你不这样做，驱动程序认为它仍然对设备负责，即使它发生了变化。

您无法在用户模式下逃避这个问题。

放弃句柄只是将问题转移到稍后阶段（例如退出程序，以便 Windows 尝试关闭所有放弃的打开句柄。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T11:48:39.123

关于挂起问题：您可以生成一个单独的写入线程，从主线程监督写入过程，如果需要很长时间，则中止写入线程。换句话说：异步实现写入并寻找超时。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T10:02:48.807

可能是文件系统驱动程序而不是硬件驱动程序有问题吗？您可能会发现，如果您使用 NTFS，问题就会消失。

# php - 无类 PHP 应用程序的类图

> ID：681226
> 
> 赞同：2
> 
> 时间：2009-03-25T11:46:00.737
> 
> 标签：php, oop, uml

我有完全程序化的 PHP 应用程序（没有 PHP 类）。就我而言，有没有我可以绘制的正式图表来展示我的 Web 应用程序如何等同于基于 OOP 的应用程序的 UML 类图。

谢谢大家

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T12:26:25.680

[doxygen](http://www.doxygen.org/)可以自动生成呼叫和呼叫者图表 - 如果这适合您的需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T11:48:47.547

你可以制作一些 Hatley-Pirbhai 模型：

[http://en.wikipedia.org/wiki/Hatley-Pirbhai_modeling](http://en.wikipedia.org/wiki/Hatley-Pirbhai_modeling)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T12:35:43.363

这并不是因为实施（甚至设计）是程序性的，商业模式才是。

尽管您可能在代码中找不到对类的显式引用，但它们可能仍然存在，隐藏，分散在全局变量等中，操作一些全局变量的函数，...

因此，为了描述您的应用程序，您*可能*仍然可以使用（概念）类图。

# php - php mysql 字符集：存储国际内容的html

> ID：681228
> 
> 赞同：2
> 
> 时间：2009-03-25T11:46:26.540
> 
> 标签：php, mysql, character-encoding

我对我所读到的关于字符集的内容完全感到困惑。我正在开发一个接口来在 mysql 数据库中存储 html 格式的法语文本。

我所理解的是，正确显示所有法语特殊字符的安全方法是将它们存储为 utf8。所以我创建了一个mysql数据库，为数据库和每个表指定了utf8。我可以通过 phpmyadmin 看到字符的存储方式完全符合预期。但是通过 php 输出这些字符会给我带来不稳定的结果：重音字符被无意义的字符替换。这是为什么 ？

我必须对它们进行 utf8_encode 或 utf8_decode 吗？注意：html 页面字符编码设置为 utf8。

更一般地说，存储这些数据的安全方法是什么？我应该在保存时结合 htmlentities、addslashes 和 utf8_encode，而在输出时结合 stripslashes、html_entity_decode 和 utf8_decode？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-25T11:52:12.313

MySQL 即时执行字符集转换为称为[连接字符集](http://dev.mysql.com/doc/refman/5.1/en/charset-connection.html)的东西。您可以使用 sql 语句指定此字符集

```
SET NAMES utf8 
```

或使用特定的 API 函数，例如[mysql_set_charset()](http://se.php.net/mysql_set_charset)：

```
mysql_set_charset("utf8", $conn); 
```

如果正确完成，则无需使用 utf8_encode() 和 utf8_decode() 等函数。

您还必须确保浏览器使用相同的编码。这通常使用一个简单的标题来完成：

```
header('Content-type: text/html;charset=utf-8'); 
```

（请注意，该字符集在浏览器中称为*utf-8* ，但在 MySQL中称为*utf8 。）*

在大多数情况下，连接字符集和网络字符集是您需要跟踪的唯一内容，因此如果它仍然不起作用，则可能是您做错了其他事情。尝试尝试一下，通常需要一段时间才能完全理解。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T12:39:09.707

我强烈建议阅读 Joel Spolsky 撰写的这篇文章[“**每个软件开发人员绝对、肯定必须了解 Unicode 和字符集（没有借口！）** ”](http://www.joelonsoftware.com/articles/Unicode.html)，以了解您在做什么以及为什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T12:17:00.833

考虑 PHP 生成的前端和 MySQL 后端的独立组件很有用。MySQL 不必担心显示逻辑，PHP 也不应假定后端对数据进行任何类型的预处理。

我的建议是使用 utf8 编码以纯字符存储数据，并使用 MySQL 方法转义任何危险字符。然后 PHP 从数据库中读取 utf8 编码的数据，处理它们（通常使用 htmlentities()），并通过您选择使用的任何模板显示它。

Emil H. 正确建议使用

```
 SET NAMES utf8 
```

这应该是您在建立 MySQL 连接后调用的第一件事。这使得 MySQL 将所有输入和输出视为 utf8。

请注意，如果您必须使用 utf8_encode 或 utf8_decode 函数，则说明您没有正确设置 html 字符编码。要求系统的每个组件都使用 utf8 是最简单的，因为这样您就不必手动编码/解码，这可能会导致以后难以跟踪问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T12:15:04.193

除了 Emil H 所说的之外，您还需要在页面`head`标签中使用它：

```
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" /> 
```

# javascript - HTML 中的 IFrame

> ID：681229
> 
> 赞同：0
> 
> 时间：2009-03-25T11:46:32.093
> 
> 标签：javascript, html

我在 html.loading 不同的 html 页面到 iframes.in 中使用 iframes 在我有图像的 html 页面中。每当我将图像加载到 iframe 中时，我都会闪烁。

我们可以通过使用 iframe 来停止闪烁吗

怎么做 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T11:51:19.697

嗯，我不完全确定你想摆脱什么样的闪烁，但我想这与浏览器加载有关，然后用图像显示你的新页面。

好吧，除了将下一个图像加载到背景上的另一个 iframe 中，然后在当前可见的 iframe 和新加载的 iframe 之间切换之外，我想不出任何好的方法。

更大的问题是，为什么需要使用 iframe？您是否从不属于您的网站加载内容？如果没有，请考虑 ajax 和其他此类技术。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-14T08:21:04.537

您可以做一些事情来帮助解决这个问题。

首先，确保指定图像的宽度和高度。然后浏览器将为图像保留空间，而不是在图像大小已知时调整保留空间的大小。

如果你提供一个例子，如果有必要，我们可以讨论预加载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-26T18:22:02.617

您可以通过将 onLoad 回调事件添加到 . 一旦 onLoad 回调触发，您将能够淡入 iframe 及其内容。这就是延迟加载的工作原理。例子：

`<iframe id="ifrm" src="http://www.example.com" onload="showImage()"></iframe>`

在上面的示例中，Iframe 将呈现您的内容。一旦上述 iframe 完成加载，它将尝试调用一个名为 showImage() 的函数。您所要做的就是在脚本文件中定义 showImage。您现在可以使用此函数查找 iframe DOM 节点并更改样式以将其淡入或显示（显示：块）。例子：

```
<script>
 function showImage() {
  var iframe = document.getElementById('ifrm'); 
  iframe.style.opacity = 1; // using opacity. You can transition this
  iframe.style.display = 'block' // using display. No transition
 }

</script> 
```

如果你想让它淡入，你可以像下面这样在你的 iframe 中添加一些 css。例子：

```
#ifrm {
  opacity: 0; // Before the iframe load, make sure it is not visible
  transition: 0.3s // This will make your iframe fade in on load
} 
```

希望这可以帮助。

# svn - 防止DB密码被意外签入公共SVN

> ID：681231
> 
> 赞同：1
> 
> 时间：2009-03-25T11:47:42.433
> 
> 标签：svn, passwords, password-protection

有谁知道防止某人（我！）不小心将带有公共数据库连接字符串的文件提交到 Google 代码的技术。我需要从本地机器上对数据库运行一些单元测试（以更新数据库模式），但我担心我会忘记我已将连接更改为指向公共数据库，然后将代码签入SVN。

当然，这不太可能发生在第一次，但可能在 5 或 10 次之后发生。

处理这个最简单的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T11:49:21.493

我通常会创建一个名为 myapp.config.default 的默认配置文件，它不包含任何密码，然后将该文件添加到存储库中，而不是我的实际配置文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T12:08:18.407

这是我用于 Web 应用程序的解决方案。首先，我不想忽略 svn 中的 Web.config 文件，因为它包含可以而且将会改变的重要信息。因此，我将连接字符串从 Web.Config 中提取出来，将其放在一个名为 WebCS.config 的文件中，然后使用 SVN .ignore 指令来避免只签入那个文件。

为此，请在 Web.Config 中放置以下“包含”行：

```
 <connectionStrings configSource="WebCS.config"/> 
```

然后，创建 WebCS.config 文件并输入以下内容：

```
<connectionStrings>
<add name="ConnString" 
         connectionString="Data Source=YourServer;Initial Catalog=YourDB;etc..
         providerName="System.Data.SqlClient"/>
</connectionStrings> 
```

这也使得更新网站变得容易：只需上传除 WebCS.config 文件之外的所有文件（我有一个批处理文件可以在“发布”网站后删除该文件）。然后，您可以放心，所有 Web.Config 文件设置都会随身携带，而不会弄乱您的连接字符串，并且您可以放心，您的存储库没有丢失重要文件，并且您不会暴露您的连接字符串.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T11:53:41.467

允许您的配置数据被本地配置文件（主目录中的某个文件）覆盖。在应用程序逻辑中包含用于定位配置文件的位置层次结构。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T12:00:07.083

我在第二个*Emil H*提案中添加了一个：您应该通过**svn:ignore** -property 忽略正确的配置文件

例如，您的配置文件应驻留在：

```
./config/app.conf 
```

那么你应该忽略这个文件进行颠覆：

```
svn propset svn:ignore "app.conf" ./conf 
```

并将 app.conf 复制到 app.conf.example 并将此文件添加到 subversion： cp app.conf app.conf.example svn add app.conf.example

现在 Subversion 将永远不会尝试将您的 app.conf 文件添加到您的存储库（而且您的同事也不会意外提交此文件！）

# java - Maven2 和 Swing 项目：构建和运行 Swing 应用程序

> ID：681235
> 
> 赞同：11
> 
> 时间：2009-03-25T11:48:22.993
> 
> 标签：java, swing, maven-2, build-automation

我试图找到有关如何使用 maven 构建和运行 swing 应用程序的信息，但找不到任何有用的信息（maven 文档一团糟）。

有人可以指点我相关的文件吗？有人在摇摆开发中使用 maven 吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-25T14:20:18.730

我猜你想从一个 Maven 命令运行你的应用程序。您可以像这样使用[exec](http://mojo.codehaus.org/exec-maven-plugin/)插件：

```
<build>
    <plugins>    
        <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>exec-maven-plugin</artifactId>
            <version>1.1-beta-1</version>
            <executions>
                <execution>
                    <goals>
                        <goal>java</goal>
                    </goals>
                </execution>
            </executions>
            <configuration>
                <mainClass>com.package.MainClass</mainClass>
                <arguments>
                    <argument>arg1</argument>
                    <argument>arg2</argument>
                </arguments>
            </configuration>
        </plugin>
    </plugins>
</build> 
```

你可能在你的 pom 中也需要这个。

```
<repositories>
    <repository>
        <id>Maven Snapshots</id>
        <url>http://snapshots.maven.codehaus.org/maven2/</url>
        <snapshots>
            <enabled>true</enabled>
        </snapshots>
        <releases>
            <enabled>false</enabled>
        </releases>
    </repository>
</repositories>
<pluginRepositories>
    <pluginRepository>
        <id>Maven Snapshots</id>
        <url>http://snapshots.maven.codehaus.org/maven2/</url>
        <snapshots>
            <enabled>true</enabled>
        </snapshots>
        <releases>
            <enabled>true</enabled>
        </releases>
    </pluginRepository>
</pluginRepositories> 
```

实际配置可能会有所不同，具体取决于您最终使用的 exec 插件的版本 - 我在某些版本上取得了成功，但在其他版本上没有成功，因此找出正确版本是一种反复试验jar 为您的项目。如果您有多个开发人员，这也是一种痛苦，因为一个开发人员的参数可能对另一个开发人员不正确，因此最好编写一个批处理/shell 脚本来启动应用程序。

只是为了完整起见，这里有一些示例代码可以制作一个可执行的 jar 文件，以配合 romaintaz 答案中的链接。

```
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-jar-plugin</artifactId>
            <configuration>
                <archive>
                    <manifest>
                        <mainClass>com.package.MainClass</mainClass>
                    </manifest>
                </archive>
            </configuration>
        </plugin>
    </plugins>
</build> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T12:10:10.243

你到底想达到什么目的？

Swing 应用程序是一个“普通”Java 应用程序，因此没有关于 Maven 配置的特定需求。

您可以在[这里查看](http://maven.apache.org/shared/maven-archiver/examples/classpath.html)以了解如何使用 Maven 创建可运行的 JAR 文件。您还可以查看[此处](http://maven.apache.org/plugins/maven-shade-plugin/)以创建包含所有依赖项的 JAR 文件。

# c++ - 在 C++ 中，当我需要使用枚举时，如何避免 #include 头文件？

> ID：681243
> 
> 赞同：5
> 
> 时间：2009-03-25T11:50:01.163
> 
> 标签：c++, include, header, dependencies

在我的 C++ 头文件中，我尝试使用前向声明（类 MyClass;）而不是 #include 类头，正如许多 C++ 编码标准（Google C++ 样式指南就是其中之一）中所推荐的那样。

不幸的是，当我引入枚举时，我不能再做前向声明了。像这样：

```
//// myclass1.hpp ////

class MyClass1
{
    enum MyEnum1
    {
        Enum_A, Enum_B, Enum_C
    };
};

//// myclass2.hpp ////

// I want to avoid this
#include "myclass1.hpp"

// I'd prefer to do this (forward declaration)
class MyClass1;

class MyClass2
{
    // This is o.k.: I only need to forward declare MyClass1
    MyClass1* ptr;

    // This forces me to #include, but I don't want to!
    void func( MyClass1::MyEnum1 e );
}; 
```

到目前为止我能想到的最好的解决方案是用成员常量替换枚举：

```
//// myclass1.hpp  ////

MyClass1
{
    static const int Enum_A;
    static const int Enum_B;
    static const int Enum_C;
};

//// myclass1.cpp ////

const int Enum_A = 1;
const int Enum_B = 2;
const int Enum_C = 3; 
```

但是，在这种情况下，解决方案似乎比问题更糟糕。

我目前正在研究*大型 C++ 软件设计*(Lakos) 和*有效地使用遗留代码*(Feathers) 以了解依赖关系破坏技术，但我还没有找到一个好的解决方案。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-25T11:54:16.023

这很难做得很好。也许将`enum`s 移动到一个公共头文件是一个合理的解决方案？

编辑：我知道要求避免包含头文件的问题，但是（AFAIK）无法做到这一点。将枚举移动到单独的头文件至少可以最大限度地减少您需要包含的头文件中的内容。这肯定比问题中建议的疯狂要好！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-25T11:57:04.173

您不能转发声明枚举值 - 您的解决方法是朝着完全疯狂的道路迈出一步。

您是否遇到由#include 标头导致的任何主要编译速度下降？如果没有，只需#include 他们。使用前向声明**不是**“最佳实践”，而是一种技巧。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-25T11:52:44.573

只有在声明指针时才能使用前向声明。如果要声明非指针变量，则*必须*包含相关的头文件。

由于枚举变量不是指针，因此您不能使用前向声明。而且我认为没有替代解决方案。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-25T12:06:37.567

C++0x 的[强类型枚举](http://en.wikipedia.org/wiki/C%2B%2B0x#Strongly_typed_enumerations)可以前向声明。GCC 4.4.0 和 CodeGear C++Builder 2009 支持强类型枚举。

有一些类似枚举的类，如（已提议但从未最终确定和接受的）Boost.Enum 可从[Boost Vault](http://www.boostpro.com/vault/)在[此链接](http://www.boostpro.com/vault/index.php?action=downloadfile&filename=enum_rev4.6.zip&directory=&PHPSESSID=e130fe5713941b1bccdec3f9017d1361)下载。由于 Boost.Enums 是类，它们可以被前向声明。

但是，只是将枚举放在一个单独的文件中（如在[这个答案](https://stackoverflow.com/questions/681243/in-c-how-can-i-avoid-including-a-header-file-when-i-need-to-use-an-enumeratio/681257#681257)中）似乎是最简单、最好的解决方案（除非 C++0x 支持）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-25T12:00:18.083

您可以使用模板参数针对“通用”枚举类型进行编程。很像这样：

```
// enum.h
struct MyClass1 { enum e { cE1, cE2, cELast }; };

// algo.h
// precondition: tEnum contains enumerate type e
template< typename tEnum > typename tEnum::e get_second() { 
    return static_cast<typename tEnum::e>(1); 
}

// myclass1.h

// myclass.h
template< typename tClass1 >
class MyClass2
{
    tClass1 * ptr;
    void func( tClass1::e e );
};
// main.cpp
#include "enum.h"
#include "algo.h"
int main(){ return get_second<Enum>(); } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-25T11:59:50.703

我不认为（我可以被证明是不正确的）您可以转发声明内部类型或枚举。您将需要封闭类的定义才能使用枚举。

虽然大多数样式指南都强制不包括不必要的标题，但在您的情况下，标题*是*必要的。如果您真的想避免包含，您可以考虑的其他选项是在类之外定义枚举并包括定义枚举的标头。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-25T12:11:19.990

枚举的前向声明实际上是由 C++ 标准委员会提出的。请参阅[本文](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2499.pdf)(pdf)。这肯定是一个很好的功能！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-25T13:20:43.397

如果你真的因为包含头文件而遇到编译速度变慢，另一个选择是使用 an`int`而不是`enum`. 这是一种相当不受欢迎的方法，因为它会降低类型安全性。如果您确实采用这种方法，那么我还建议您添加代码以编程方式进行边界检查：

```
// in class1.h
class Class1 {
public:
    enum Blah {
       kFirstBlah, // this is always first
       eOne = kFirstBlah,
       ...
       kLastBlah // this is always last
    };
};

// in checks.h
#include <stdexcept>
namespace check {
template <typename T, typename U>
U bounds(U lower, T value, U upper) {
    U castValue = static_cast<U>(value);
    if (castValue < lower || castValue >= upper) {
        throw std::domain_error("check::bounds");
    }
    return castValue;
}
} // end check namespace

// in class2.h
class Class2 {
public:
    void func(int blah);
};

// in class2.cpp
#include "class2.h"
#include "class1.h"
#include "checks.h"

void Class2::func(int blah) {
    Class1::Blah blah_;
    blah_ = check::bounds(Class1::kFirstBlah, blah, Class1::kLastBlah);
} 
```

这不是最漂亮的解决方案，但它确实通过将静态编译为您提供的一些类型安全性转移到运行时代码中来解决头文件依赖问题。我过去使用过类似的方法，发现`check`以这种方式使用的命名空间可以使生成的代码几乎与`enum`基于代码的代码一样具有可读性，而且几乎不需要付出任何努力。

需要注意的是，无论您是否采用这种方法，您都必须努力编写我推荐的异常安全代码；）

# cocoa - 自定义视图应该如何更新模型对象？

> ID：681247
> 
> 赞同：3
> 
> 时间：2009-03-25T11:50:45.640
> 
> 标签：cocoa, architecture, idioms

这是一个 Cocoa n00b 问题 - 我多年来一直在其他环境中编写 GUI 应用程序，但现在我想了解以下琐碎情况下的“惯用 Cocoa”是什么：

我有一个简单的自定义`NSView`，允许用户在其中绘制简单的形状。它的`drawRect`实现是这样的：

```
- (void)drawRect:(NSRect)rect
{
    // Draw a white background.
    [[NSColor whiteColor] set];
    NSRect bounds = [self bounds];
    [NSBezierPath fillRect:bounds];

    [[NSColor blackColor] set];

    // 'shapes' is a NSMutableArray instance variable
    // whose elements are NSValues, each wrapping an NSRect.
    for (NSValue *value in shapes)
    {
        NSRect someRect;
        [value getValue:&someRect];
        [self drawShapeForRect:someRect];
    }

    // In addition to drawing the shapes in the 'shapes'
    // array, we draw the shape based on the user's
    // current drag interaction.
    [self drawShapeForRect:[self dragRect]];
} 
```

您可以看到这段代码是多么简单：`shapes`数组实例变量充当该`drawRect`方法用来绘制形状的模型。每次用户执行鼠标向下/拖动/鼠标向上序列时都会`NSRect`添加新的 s，我也在这个自定义视图中实现了这一点。`shapes`这是我的问题：

**如果这是一个“真正的”Cocoa 应用程序，我的自定义视图更新其模型的惯用方式是什么？**

换句话说，自定义视图应该如何通知控制器需要将另一个形状添加到形状列表中？现在，视图在其自身中跟踪形状`NSMutableArray`，这作为实现细节很好，但我不想将此数组公开为我的自定义视图的公共 API 的一部分。此外，我希望将错误检查、保存/加载和撤消代码放在像控制器这样的集中位置，而不是让它散落在我的自定义视图中。在我过去使用其他 GUI 编程环境的经验中，模型由我的控制器层中的对象管理，并且视图通常不会直接更新它们 - 相反，视图在发生某些事情时进行通信，通过调度事件或调用它引用的控制器上的方法，或使用一些类似的解耦方法。

我的直觉是，惯用的 Cocoa 代码会`delegate`在我的自定义视图上公开一个属性，然后将`MyDocument`控制器对象（或挂在文档控制器之外的另一个控制器层对象）连接到 xib 文件中的视图，作为其委托。然后视图可以调用一些方法，比如`shapeAdded:(NSRect)shape`委托。但似乎还有许多其他方法可以做到这一点，例如让控制器将模型对象（形状列表）的引用直接传递给自定义视图（感觉不对），或者让视图发送通知控制器会听（感觉笨拙），然后控制器更新模型。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T12:10:12.270

有一个代表是一种[很好](http://en.wiktionary.org/wiki/cromulent)的方式来做到这一点。另一种方法是在视图上公开一个 NSArray 绑定，并将其绑定到数组控制器的`arrangedObjects`绑定，然后将数组控制器的`content`绑定绑定到拥有持有模型对象的真实数组的任何对象。然后，您可以在同一阵列控制器上添加其他视图，例如活动层中的对象列表。

这是一个自定义视图，您需要创建一个 IBPlugin 以在 IB 中公开绑定，或者通过向视图发送[bind:toObject:withKeyPath:options:](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Protocols/NSKeyValueBindingCreation_Protocol/Reference/Reference.html#//apple_ref/occ/instm/NSObject/bind:toObject:withKeyPath:options:)消息以编程方式绑定它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T15:16:54.507

/Developer/Examples/AppKit/Sketch 目录中有一个非常好的示例 xcode 项目，它是您正在做的更高级的版本，但仍然相关。它有在控制器和视图之间使用绑定的很好的例子，这些例子将阐明做事的“正确”方式。此示例不使用 IB 插件，因此您将看到手动调用绑定和实现的观察方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T12:09:20.697

您的代码和 NSTableView 之间有几个相似之处，所以我可能会考虑使用数据源（类似于您的委托）甚至可能是绑定。

# gitignore - .gitignore 文件中的路径有什么不同？

> ID：681262
> 
> 赞同：63
> 
> 时间：2009-03-25T11:59:02.827
> 
> 标签：gitignore

我一直在使用 git，但仍然对*.gitignore*文件路径感到困惑。

*那么， .gitignore*文件中以下两个路径有什么区别呢？

```
时间/*
公共/文件/**/*

```

我可以理解这`tmp/*`将忽略其中的所有文件和文件夹。我对吗？但是第二条线路径是什么意思？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-03-25T12:10:59.103

这取决于你的 shell 的行为。Git 不做任何工作来确定如何扩展这些。通常，`*`匹配任何单个文件或文件夹：

```
/a/*/z
 matches        /a/b/z
 matches        /a/c/z
 doesn't match  /a/b/c/z 
```

`**`匹配任何文件夹字符串：

```
/a/**/z
 matches        /a/b/z
 matches        /a/b/c/z
 matches        /a/b/c/d/e/f/g/h/i/z
 doesn't match  /a/b/c/z/d.pr0n 
```

结合`**`以`*`匹配整个文件夹树中的文件：

```
/a/**/z/*.pr0n
 matches        /a/b/c/z/d.pr0n
 matches        /a/b/z/foo.pr0n
 doesn't match  /a/b/z/bar.txt 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2010-12-31T02:22:00.730

### 更新（2016 年 3 月 8 日）

今天，我找不到一台`**`不能按要求工作的机器。这包括 OSX-10.11.3 (El Capitan) 和 Ubuntu-14.04.1 (Trusty)。可能是 git-ignore 已更新，或者可能是人们期望的最近的**fnmatch**句柄。`**`因此，现在接受的答案在实践中似乎是正确的。

* * *

### 原帖

**git**中`**`没有特殊含义。这是 bash >= 4.0 的一个特性，通过

 **`shopt -s globstar`

但是**git**不使用**bash**。要查看**git**`git add -nv`实际执行的操作，您可以在多个级别的子目录中尝试和文件。

对于 OP，我已经尝试了所有我能想到的`.gitignore`文件组合，没有比这更好的了：

> `public/documents/`

以下内容并不像每个人都认为的那样：

> `public/documents/**/*.obj`

无论我尝试什么，我都无法让它工作，但至少这与[*git* docs](http://git-scm.com/docs/gitignore)是一致的。我怀疑当人们将它添加到 时`.gitignore`，它会意外工作，只是因为他们的`.obj`文件恰好是一个子目录深。他们可能从 bash 脚本中复制了双星号。但也许有些系统`fnmatch(3)`可以像 bash 一样处理双星号。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-03-25T12:07:45.710

如果您使用的是 Bash 4 等 shell，那么 ** 本质上是 * 的递归版本，它将匹配任意数量的子目录。

如果您为示例添加文件扩展名，这将更有意义。要在 tmp 中立即匹配日志文件，您可以键入：

```
/tmp/*.log 
```

要匹配 tmp 的任何子目录中任何位置的日志文件，您可以键入：

```
/tmp/**/*.log 
```

但是使用 git 版本 1.6.0.4 和 bash 版本 3.2.17(1)-release 进行测试，似乎 git 根本不支持 ** glob。gitignore的[最新手册页](http://git-scm.com/docs/gitignore)也没有提到 **，因此这要么是 (1) 非常新，(2) 不受支持，要么 (3) 在某种程度上取决于您的系统对 globbing 的实现。

此外，您的示例中还有一些微妙的地方。这个表达式：

```
tmp/* 
```

...实际上意味着“忽略 tmp 目录中的任何文件*，*源树中的任何位置，但不要忽略 tmp 目录本身”。在正常情况下，您可能只会写：

```
/tmp 
```

...这将忽略单个顶级 tmp 目录。如果您确实需要保留 tmp 目录，同时忽略它们的内容，您应该在每个 tmp 目录中放置一个空的 .gitignore 文件，以确保 git 实际创建该目录。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2013-02-18T07:33:41.417

请注意，*当与子目录*( ) 结合使用时，' `**`'必须已从其默认行为更改，因为[git1.8.2 的发行说明](http://article.gmane.org/gmane.linux.kernel/1443021)现在提到：*`**/bar`*

 *> `.gitignore`和`.gitattributes`文件中的模式可以有`**/`, 作为匹配 0 级或更多级别的子目录的模式。
> 
> 例如，“ `foo/**/bar`”匹配“ `bar`”`foo`本身或“”的子目录中的“ `foo`”。

* * *

请参阅[提交 4c251e5cb5c245ee3bb98c7cedbe944df93e45f4](https://github.com/git/git/commit/4c251e5cb5c245ee3bb98c7cedbe944df93e45f4)：

> “ `foo/**/bar`”匹配“ `foo/x/bar`”、“ `foo/x/y/bar`”……但不匹配“ `foo/bar`”。
> 我们做一个特殊情况，当`foo/**/`检测到（并且“ `foo/`”部分已经匹配）时，尝试将“ `bar`”与字符串的其余部分匹配。
> 
> “匹配一个或多个目录”语义可以使用“ `foo/*/**/bar`”轻松实现。
> 
> 这也使得“`**/foo`匹配”`foo`除了“ `x/foo`”，“ `x/y/foo`”..
> 
> 签字人：Nguyễn Thái Ngọc Duy`<pclouds@gmail.com>`

* * *

[Simon Buchan](https://stackoverflow.com/users/20135/simon-buchan)还[评论说](https://stackoverflow.com/questions/681262/difference-in-the-paths-in-gitignore-file/14931416?noredirect=1#comment30449900_14931416)：

> 当前文档（[`.gitignore`手册页](http://git-scm.com/docs/gitignore)）非常清楚不需要子目录，`x/**`匹配下的所有文件（可能为空）`x`

`.gitignore`手册页确实提到：

> 尾随的 " `/**`" 匹配里面的所有内容。例如，“ `abc/**`”匹配目录“ `abc`”内的所有文件，相对于`.gitignore`文件的位置，具有无限深度。
> 
> 斜杠后跟两个连续的星号，然后斜杠匹配零个或多个目录。例如，“ `a/**/b`”匹配“ `a/b`”、“ `a/x/b`”、“ `a/x/y/b`”等。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-06-02T18:42:35.210

当不支持**时，“/”本质上是通配符的终止字符，所以当你有类似的东西时：

```
public/documents/**/* 
```

它本质上是在斜线之间寻找两个通配符项目，而不是自己拿起斜线。因此，这将与以下内容相同：

```
public/documents/*/* 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-27T14:00:10.263

它对我不起作用，但您可以`.gitignore`在该子目录中创建一个新的：

```
tmp/**/*.log 
```

可以替换为`.gitignore`in `tmp`：

```
*.log 
```

# java - 修改 HttpServletRequest 正文

> ID：681263
> 
> 赞同：13
> 
> 时间：2009-03-25T11:59:38.007
> 
> 标签：java, http, request

我正在处理遗留代码，需要打一个补丁。

问题：一个古老的应用程序发送了错误的 HTTP POST 请求。其中一个参数不是 URL 编码的。我知道这个参数总是排在最后，而且我知道它的名字。我现在正试图在运行在 tomcat 中的服务器端修复它。

此参数无法通过 HttpServletRequest 的标准 getParameter 方法访问，因为它格式错误。方法只是返回 null。但是当我通过 ServletInputStream 手动读取整个请求体时，所有其他参数都消失了。看起来底层类无法解析 ServletInputStream 的内容，因为它已经耗尽。

到目前为止，我已经设法制作了一个从正文读取所有参数并覆盖所有参数访问方法的包装器。但是，如果我之前的链中的任何过滤器将尝试访问任何参数，那么一切都会中断，因为 ServletInputStream 将为空。

我能以某种方式逃避这个问题吗？可能有不同的方法吗？

总而言之，如果我在过滤器中读取原始请求正文，参数将从请求中消失。如果我读取单个参数，ServletInputStream 将变为空，并且无法手动处理。此外，通过 getParameter 方法无法读取格式错误的参数。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-31T08:39:19.123

**我找到的解决方案：**

仅仅重新定义参数访问方法是不够的。必须做几件事。

1.  需要一个过滤器来包装请求。
2.  重写所有参数访问方法需要自定义**HttpRequestWrapper 。**请求正文应在构造函数中解析并存储为字段。
3.  **getInputStream**和**getReader**方法也应该重新定义。它们返回值取决于存储的请求正文。
4.  **需要扩展ServletInputStream**的自定义类，因为这是抽象的。

这 4 个组合将允许您使用**getParameter**而不会干扰**getInputStream**和**getReader**方法。

请注意，手动请求参数解析可能会因多部分请求而变得复杂。但这是另一个话题。

为了澄清，我重新定义了参数访问方法，因为我的请求已损坏，如问题中所述。你可能不需要那个。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-25T12:04:27.417

为什么不安装重写请求的 servlet 过滤器，而不是覆盖方法？

[Jason Hunter 有一篇关于过滤器](http://www.servlets.com/soapbox/filters.html)的非常好的文章。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-07T14:13:07.517

我做了一个更完整的包装器，在 Content-Type 是 application/x-www-form-urlencoded 并且您已经调用了 getParameterXXX 方法之一的情况下，您仍然可以访问内容：

```
import java.io.BufferedReader;
import java.io.ByteArrayInputStream;
import java.io.IOException;  
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.UnsupportedEncodingException;
import java.net.URLDecoder;
import java.security.Principal;
import java.util.Enumeration;
import java.util.HashMap;
import java.util.LinkedList;
import java.util.Locale;
import java.util.Map;
import java.util.StringTokenizer;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletInputStream;
import javax.servlet.http.Cookie;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpSession;

/**
 * This class implements the Wrapper or Decorator pattern.<br/> 
 * Methods default to calling through to the wrapped request object, 
 * except the ones that read the request's content (parameters, stream or reader).
 * <p>
 * This class provides a buffered content reading that allows the methods
 * {@link #getReader()}, {@link #getInputStream()} and any of the getParameterXXX to be     called
 * safely and repeatedly with the same results.
 * <p>
 * This class is intended to wrap relatively small HttpServletRequest instances.
 * 
 * @author pgurov
 */
public class HttpServletRequestWrapper implements HttpServletRequest {

private class ServletInputStreamWrapper extends ServletInputStream {

    private byte[] data;
    private int idx = 0;
    ServletInputStreamWrapper(byte[] data) {
        if(data == null)
            data = new byte[0];
        this.data = data;
    }
    @Override
    public int read() throws IOException {
        if(idx == data.length)
            return -1;
        return data[idx++];
    }

}

private HttpServletRequest req;
private byte[] contentData;
private HashMap<String, String[]> parameters;

public HttpServletRequestWrapper() {
    //a trick for Groovy
    throw new IllegalArgumentException("Please use HttpServletRequestWrapper(HttpServletRequest request) constructor!");
}

private HttpServletRequestWrapper(HttpServletRequest request, byte[] contentData, HashMap<String, String[]> parameters) {
    req = request;
    this.contentData = contentData;
    this.parameters = parameters;
}

public HttpServletRequestWrapper(HttpServletRequest request) {
    if(request == null)
        throw new IllegalArgumentException("The HttpServletRequest is null!");
    req = request;
}

/**
 * Returns the wrapped HttpServletRequest.
 * Using the getParameterXXX(), getInputStream() or getReader() methods may interfere
 * with this class operation.
 * 
 * @return 
 *      The wrapped HttpServletRequest.
 */
public HttpServletRequest getRequest() {
    try {
        parseRequest();
    } catch (IOException e) {
        throw new IllegalStateException("Cannot parse the request!", e);
    }
    return new HttpServletRequestWrapper(req, contentData, parameters);
}

/**
 * This method is safe to use multiple times.
 * Changing the returned array will not interfere with this class operation.
 * 
 * @return 
 *      The cloned content data.
 */
public byte[] getContentData() {
    return contentData.clone();
}

/**
 * This method is safe to use multiple times.
 * Changing the returned map or the array of any of the map's values will not
 * interfere with this class operation.
 * 
 * @return
 *      The clonned parameters map.
 */
public HashMap<String, String[]> getParameters() {
    HashMap<String, String[]> map = new HashMap<String, String[]>(parameters.size() * 2);
    for(String key : parameters.keySet()) {
        map.put(key, parameters.get(key).clone());
    }
    return map;
}

private void parseRequest() throws IOException {
    if(contentData != null)
        return; //already parsed

    byte[] data = new byte[req.getContentLength()];
    int len = 0, totalLen = 0;
    InputStream is = req.getInputStream();
    while(totalLen < data.length) {
        totalLen += (len = is.read(data, totalLen, data.length - totalLen));
        if(len < 1)
            throw new IOException("Cannot read more than " + totalLen + (totalLen == 1 ? " byte!" : " bytes!"));
    }
    contentData = data;
    String enc = req.getCharacterEncoding();
    if(enc == null)
        enc = "UTF-8";
    String s = new String(data, enc), name, value;
    StringTokenizer st = new StringTokenizer(s, "&");
    int i;
    HashMap<String, LinkedList<String>> mapA = new HashMap<String, LinkedList<String>>(data.length * 2);
    LinkedList<String> list;
    boolean decode = req.getContentType() != null && req.getContentType().equals("application/x-www-form-urlencoded");
    while(st.hasMoreTokens()) {
        s = st.nextToken();
        i = s.indexOf("=");
        if(i > 0 && s.length() > i + 1) {
            name = s.substring(0, i);
            value = s.substring(i+1);
            if(decode) {
                try {
                    name = URLDecoder.decode(name, "UTF-8");
                } catch(Exception e) {}
                try {
                    value = URLDecoder.decode(value, "UTF-8");
                } catch(Exception e) {}
            }
            list = mapA.get(name);
            if(list == null) {
                list = new LinkedList<String>();
                mapA.put(name, list);
            }
            list.add(value);
        }
    }
    HashMap<String, String[]> map = new HashMap<String, String[]>(mapA.size() * 2);
    for(String key : mapA.keySet()) {
        list = mapA.get(key);
        map.put(key, list.toArray(new String[list.size()]));
    }
    parameters = map;
}

/**
 * This method is safe to call multiple times.
 * Calling it will not interfere with getParameterXXX() or getReader().
 * Every time a new ServletInputStream is returned that reads data from the begining.
 * 
 * @return
 *      A new ServletInputStream.
 */
public ServletInputStream getInputStream() throws IOException {
    parseRequest();

    return new ServletInputStreamWrapper(contentData);
}

/**
 * This method is safe to call multiple times.
 * Calling it will not interfere with getParameterXXX() or getInputStream().
 * Every time a new BufferedReader is returned that reads data from the begining.
 * 
 * @return
 *      A new BufferedReader with the wrapped request's character encoding (or UTF-8 if null).
 */
public BufferedReader getReader() throws IOException {
    parseRequest();

    String enc = req.getCharacterEncoding();
    if(enc == null)
        enc = "UTF-8";
    return new BufferedReader(new InputStreamReader(new ByteArrayInputStream(contentData), enc));
}

/**
 * This method is safe to execute multiple times.
 * 
 * @see javax.servlet.ServletRequest#getParameter(java.lang.String)
 */
public String getParameter(String name) {
    try {
        parseRequest();
    } catch (IOException e) {
        throw new IllegalStateException("Cannot parse the request!", e);
    }
    String[] values = parameters.get(name);
    if(values == null || values.length == 0)
        return null;
    return values[0];
}

/**
 * This method is safe.
 * 
 * @see {@link #getParameters()}
 * @see javax.servlet.ServletRequest#getParameterMap()
 */
@SuppressWarnings("unchecked")
public Map getParameterMap() {
    try {
        parseRequest();
    } catch (IOException e) {
        throw new IllegalStateException("Cannot parse the request!", e);
    }
    return getParameters();
}

/**
 * This method is safe to execute multiple times.
 * 
 * @see javax.servlet.ServletRequest#getParameterNames()
 */
@SuppressWarnings("unchecked")
public Enumeration getParameterNames() {
    try {
        parseRequest();
    } catch (IOException e) {
        throw new IllegalStateException("Cannot parse the request!", e);
    }
    return new Enumeration<String>() {
        private String[] arr = getParameters().keySet().toArray(new String[0]); 
        private int idx = 0;

        public boolean hasMoreElements() {
            return idx < arr.length;
        }

        public String nextElement() {
            return arr[idx++];
        }

    };
}

/**
 * This method is safe to execute multiple times.
 * Changing the returned array will not interfere with this class operation.
 * 
 * @see javax.servlet.ServletRequest#getParameterValues(java.lang.String)
 */
public String[] getParameterValues(String name) {
    try {
        parseRequest();
    } catch (IOException e) {
        throw new IllegalStateException("Cannot parse the request!", e);
    }
    String[] arr = parameters.get(name);
    if(arr == null)
        return null;
    return arr.clone();
}

/* (non-Javadoc)
 * @see javax.servlet.http.HttpServletRequest#getAuthType()
 */
public String getAuthType() {
    return req.getAuthType();
}

/* (non-Javadoc)
 * @see javax.servlet.http.HttpServletRequest#getContextPath()
 */
public String getContextPath() {
    return req.getContextPath();
}

/* (non-Javadoc)
 * @see javax.servlet.http.HttpServletRequest#getCookies()
 */
public Cookie[] getCookies() {
    return req.getCookies();
}

/* (non-Javadoc)
 * @see javax.servlet.http.HttpServletRequest#getDateHeader(java.lang.String)
 */
public long getDateHeader(String name) {
    return req.getDateHeader(name);
}

/* (non-Javadoc)
 * @see javax.servlet.http.HttpServletRequest#getHeader(java.lang.String)
 */
public String getHeader(String name) {
    return req.getHeader(name);
}

/* (non-Javadoc)
 * @see javax.servlet.http.HttpServletRequest#getHeaderNames()
 */
@SuppressWarnings("unchecked")
public Enumeration getHeaderNames() {
    return req.getHeaderNames();
}

/* (non-Javadoc)
 * @see javax.servlet.http.HttpServletRequest#getHeaders(java.lang.String)
 */
@SuppressWarnings("unchecked")
public Enumeration getHeaders(String name) {
    return req.getHeaders(name);
}

/* (non-Javadoc)
 * @see javax.servlet.http.HttpServletRequest#getIntHeader(java.lang.String)
 */
public int getIntHeader(String name) {
    return req.getIntHeader(name);
}

/* (non-Javadoc)
 * @see javax.servlet.http.HttpServletRequest#getMethod()
 */
public String getMethod() {
    return req.getMethod();
}

/* (non-Javadoc)
 * @see javax.servlet.http.HttpServletRequest#getPathInfo()
 */
public String getPathInfo() {
    return req.getPathInfo();
}

/* (non-Javadoc)
 * @see javax.servlet.http.HttpServletRequest#getPathTranslated()
 */
public String getPathTranslated() {
    return req.getPathTranslated();
}

/* (non-Javadoc)
 * @see javax.servlet.http.HttpServletRequest#getQueryString()
 */
public String getQueryString() {
    return req.getQueryString();
}

/* (non-Javadoc)
 * @see javax.servlet.http.HttpServletRequest#getRemoteUser()
 */
public String getRemoteUser() {
    return req.getRemoteUser();
}

/* (non-Javadoc)
 * @see javax.servlet.http.HttpServletRequest#getRequestURI()
 */
public String getRequestURI() {
    return req.getRequestURI();
}

/* (non-Javadoc)
 * @see javax.servlet.http.HttpServletRequest#getRequestURL()
 */
public StringBuffer getRequestURL() {
    return req.getRequestURL();
}

/* (non-Javadoc)
 * @see javax.servlet.http.HttpServletRequest#getRequestedSessionId()
 */
public String getRequestedSessionId() {
    return req.getRequestedSessionId();
}

/* (non-Javadoc)
 * @see javax.servlet.http.HttpServletRequest#getServletPath()
 */
public String getServletPath() {
    return req.getServletPath();
}

/* (non-Javadoc)
 * @see javax.servlet.http.HttpServletRequest#getSession()
 */
public HttpSession getSession() {
    return req.getSession();
}

/* (non-Javadoc)
 * @see javax.servlet.http.HttpServletRequest#getSession(boolean)
 */
public HttpSession getSession(boolean create) {
    return req.getSession(create);
}

/* (non-Javadoc)
 * @see javax.servlet.http.HttpServletRequest#getUserPrincipal()
 */
public Principal getUserPrincipal() {
    return req.getUserPrincipal();
}

/* (non-Javadoc)
 * @see javax.servlet.http.HttpServletRequest#isRequestedSessionIdFromCookie()
 */
public boolean isRequestedSessionIdFromCookie() {
    return req.isRequestedSessionIdFromCookie();
}

/* (non-Javadoc)
 * @see javax.servlet.http.HttpServletRequest#isRequestedSessionIdFromURL()
 */
public boolean isRequestedSessionIdFromURL() {
    return req.isRequestedSessionIdFromURL();
}

/* (non-Javadoc)
 * @see javax.servlet.http.HttpServletRequest#isRequestedSessionIdFromUrl()
 */
@SuppressWarnings("deprecation")
public boolean isRequestedSessionIdFromUrl() {
    return req.isRequestedSessionIdFromUrl();
}

/* (non-Javadoc)
 * @see javax.servlet.http.HttpServletRequest#isRequestedSessionIdValid()
 */
public boolean isRequestedSessionIdValid() {
    return req.isRequestedSessionIdValid();
}

/* (non-Javadoc)
 * @see javax.servlet.http.HttpServletRequest#isUserInRole(java.lang.String)
 */
public boolean isUserInRole(String role) {
    return req.isUserInRole(role);
}

/* (non-Javadoc)
 * @see javax.servlet.ServletRequest#getAttribute(java.lang.String)
 */
public Object getAttribute(String name) {
    return req.getAttribute(name);
}

/* (non-Javadoc)
 * @see javax.servlet.ServletRequest#getAttributeNames()
 */
@SuppressWarnings("unchecked")
public Enumeration getAttributeNames() {
    return req.getAttributeNames();
}

/* (non-Javadoc)
 * @see javax.servlet.ServletRequest#getCharacterEncoding()
 */
public String getCharacterEncoding() {
    return req.getCharacterEncoding();
}

/* (non-Javadoc)
 * @see javax.servlet.ServletRequest#getContentLength()
 */
public int getContentLength() {
    return req.getContentLength();
}

/* (non-Javadoc)
 * @see javax.servlet.ServletRequest#getContentType()
 */
public String getContentType() {
    return req.getContentType();
}

/* (non-Javadoc)
 * @see javax.servlet.ServletRequest#getLocalAddr()
 */
public String getLocalAddr() {
    return req.getLocalAddr();
}

/* (non-Javadoc)
 * @see javax.servlet.ServletRequest#getLocalName()
 */
public String getLocalName() {
    return req.getLocalName();
}

/* (non-Javadoc)
 * @see javax.servlet.ServletRequest#getLocalPort()
 */
public int getLocalPort() {
    return req.getLocalPort();
}

/* (non-Javadoc)
 * @see javax.servlet.ServletRequest#getLocale()
 */
public Locale getLocale() {
    return req.getLocale();
}

/* (non-Javadoc)
 * @see javax.servlet.ServletRequest#getLocales()
 */
@SuppressWarnings("unchecked")
public Enumeration getLocales() {
    return req.getLocales();
}

/* (non-Javadoc)
 * @see javax.servlet.ServletRequest#getProtocol()
 */
public String getProtocol() {
    return req.getProtocol();
}

/* (non-Javadoc)
 * @see javax.servlet.ServletRequest#getRealPath(java.lang.String)
 */
@SuppressWarnings("deprecation")
public String getRealPath(String path) {
    return req.getRealPath(path);
}

/* (non-Javadoc)
 * @see javax.servlet.ServletRequest#getRemoteAddr()
 */
public String getRemoteAddr() {
    return req.getRemoteAddr();
}

/* (non-Javadoc)
 * @see javax.servlet.ServletRequest#getRemoteHost()
 */
public String getRemoteHost() {
    return req.getRemoteHost();
}

/* (non-Javadoc)
 * @see javax.servlet.ServletRequest#getRemotePort()
 */
public int getRemotePort() {
    return req.getRemotePort();
}

/* (non-Javadoc)
 * @see javax.servlet.ServletRequest#getRequestDispatcher(java.lang.String)
 */
public RequestDispatcher getRequestDispatcher(String path) {
    return req.getRequestDispatcher(path);
}

/* (non-Javadoc)
 * @see javax.servlet.ServletRequest#getScheme()
 */
public String getScheme() {
    return req.getScheme();
}

/* (non-Javadoc)
 * @see javax.servlet.ServletRequest#getServerName()
 */
public String getServerName() {
    return req.getServerName();
}

/* (non-Javadoc)
 * @see javax.servlet.ServletRequest#getServerPort()
 */
public int getServerPort() {
    return req.getServerPort();
}

/* (non-Javadoc)
 * @see javax.servlet.ServletRequest#isSecure()
 */
public boolean isSecure() {
    return req.isSecure();
}

/* (non-Javadoc)
 * @see javax.servlet.ServletRequest#removeAttribute(java.lang.String)
 */
public void removeAttribute(String name) {
    req.removeAttribute(name);
}

/* (non-Javadoc)
 * @see javax.servlet.ServletRequest#setAttribute(java.lang.String, java.lang.Object)
 */
public void setAttribute(String name, Object value) {
    req.setAttribute(name, value);
}

/* (non-Javadoc)
 * @see javax.servlet.ServletRequest#setCharacterEncoding(java.lang.String)
 */
public void setCharacterEncoding(String env)
        throws UnsupportedEncodingException {
    req.setCharacterEncoding(env);
}

} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-09-11T20:53:55.450

我想将此作为评论发布，但我没有足够的代表。您的解决方案是不够的，因为 ServletInputStreamWrapper 将返回负整数。例如，模拟一个输入编码为 UTF-16 的请求，无论是大端还是小端。输入可能以指示字节顺序的字节顺序标记开始，并且在测试我的语句时请构造模拟请求内容以执行此操作。 [http://en.wikipedia.org/wiki/Byte_order_mark#UTF-16](http://en.wikipedia.org/wiki/Byte_order_mark#UTF-16) 这些 BOM 中的任何一个都包含 0xFF 字节。由于 java 没有无符号字节，所以这个 0xFF 作为 -1 返回。要解决这个问题，只需像这样更改读取功能

```
 public int read() throws IOException {
        if (index == data.length) {
            return -1;
        }
        return data[index++] & 0xff;
    } 
```

我有点喜欢您的解决方案，因为它适用于 Spring。起初，我试图通过从 HttpServletRequestWrapper 扩展来消除您编写的一些委托代码。然而，Spring 做了一些有趣的事情：当它遇到 ServletRequestWrapper 类型的请求时，它会解开它，调用 getRequest()。问题是我的 getRequest() 方法（从您的代码中复制）返回一个从 HttpServletRequestWrapper 扩展的新类...冲洗并无限重复。所以很遗憾地说，不使用接口就赢了！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T12:09:10.730

您可以编写自己的 Servlet 过滤器，并希望确保它首先出现在链中。然后将 ServletRequest 对象包装在将在需要时处理重写的东西中。[查看http://java.sun.com/products/servlet/Filters.html](http://java.sun.com/products/servlet/Filters.html)的 Programming Customized Requests and Responses 部分

- - - 更新 - - -

我肯定错过了什么。你说你可以读请求体，自己读参数。难道你不能确保你的过滤器是第一个，包装 ServletRequest 对象，读取，处理和存储参数，将你的请求对象传递到链上并提供你存储的参数而不是原始参数吗？

# 64-bit - Windows 中的 64/32 位标准驱动程序翻译

> ID：681267
> 
> 赞同：1
> 
> 时间：2009-03-25T12:00:22.870
> 
> 标签：64-bit, 32-bit, wow64

这个问题基本上是对这个线程的跟进： [在 32 位程序中使用 64 位驱动程序。视窗](https://stackoverflow.com/questions/602587/using-a-64-bit-driver-in-a-32-bit-program-windows)

正如我了解到的，当我有一个 64 位驱动程序时，它用于一组 64 位 DLL，我不能有一个 32 位进程调用 DLL。我们现在使用一些有趣的 interpocess 通信来解决这个问题。

不清楚的是，当使用像显卡这样的“标准设备”时，自动 64<->32 位转换是如何发生的。Windows 64 位操作系统下的任何 32 位应用程序都应该能够使用打印机驱动程序或通过使用某些 Windows DLL 使用 GDI 绘制一些东西。微软必须将显卡或打印机的硬件驱动程序从 32 位转换为 64 位。我知道 WoW64 可以访问注册表和文件系统，但它是否也可以转换为标准驱动程序？

具体的问题是，如果我们有一个 64 位 WDM 硬件驱动程序，它是否可以被 32 位应用程序轻松使用，而 Windows 进行 64<->32 的转换？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T13:20:32.117

“标准设备”被认为是“标准的”，因为 Windows 自己对它们负责。在 64 位 Windows 的情况下，这意味着同时存在 64 位和 32 位 DLL。32 位 DLL 是特殊的，可以与 64 位内核（包括该内核中的驱动程序）通信。通常，32 位 DLL 不会与 64 位 DLL 对话，因为没有 64 位进程可以加载后者的 DLL。

# tfs - 如何使用 TFS Team Build 保持项目结构

> ID：681269
> 
> 赞同：4
> 
> 时间：2009-03-25T12:03:49.960
> 
> 标签：tfs, tfsbuild

我有一个解决方案结构如下：

解决方案 1 (Solution1.sln)

*   项目一
*   项目 2
*   项目 3

我创建了一个使用 Solution1.sln 的 Team Build 定义。我的问题是编译后的二进制文件存储在一个平面输出文件夹中：BuildName\Release

但我想保持我的项目结构：

构建名称\项目 1\发布

构建名称\项目 2\发布

构建名称\项目 3\发布

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-05T03:24:04.693

请参阅[在 Orcas Team Build 中保留输出目录结构](http://blogs.msdn.com/aaronhallberg/archive/2007/06/07/preserving-output-directory-structures-in-orcas-team-build.aspx)。这是必要的，这是非常令人恼火的，而且它是每个项目的调整，但它可以工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T12:22:20.713

如您所见，Team Build 的默认设置 - 一个文件夹中的二进制文件，每个网站都在自己的文件夹结构中；每个正在构建的配置一个。如果您刚刚开始使用 TFS，我建议您尝试使用默认值。您更熟悉单独的文件夹，但您阅读的有关 Team Build 的几乎所有内容都将使用单个输出文件夹。

除了熟悉之外，还有什么原因需要单独的文件夹吗？

# metrics - 编写规范是否值得花时间计算哪些指标？

> ID：681273
> 
> 赞同：0
> 
> 时间：2009-03-25T12:04:35.497
> 
> 标签：metrics, specifications

如果为新的编程项目编写规范值得这样做并花费时间（和金钱），那么使用哪些指标以及如何进行计算？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T13:28:38.027

如果您尝试使用任何指标来明确预测或控制项目的结果，我认为您会发现自己陷入了一个不舒服的角落。最终，您的项目发起人/所有者会问“多长时间/多少”的问题？您能做的最好的事情是根据您当前对项目的了解进行*预测*——这只是来自经验和猜测。

这里有一个问题：您的估计可能会相差几个数量级。只有当您的团队了解问题域并且他们估计最多不超过 2-4 周时，它们才会变得更加准确。Barry Boehm（和 Steve McConnell）用“不确定锥”原理说明了这种效应：

![替代文字](https://ops.fhwa.dot.gov/publications/seitsguide/images/cone.jpg)

您离实施系统或功能（左侧）越远，您的估计就越不准确（-0.25x - 4x）。随着您越来越接近并更多地了解问题域，估计开始具有更高的准确性（0.8x - 1.0x）。这就是为什么在有很多“噪音”或“复杂性”（即几乎每个项目）的软件项目中，我们希望将具体估计留到最后一个负责任的时刻——不超过 2-4 周。

您还可以绝对肯定地期待一件事： ***规格会随着时间而改变。***您计划如何适应和管理这种变化将衡量您的成功。

因此，可以对您的工作范围做出的最佳判断是组建将从事该项目的团队和“客户”，共同制定大笔触——项目的主要特征。将这些写成团队使用相对权重点估计的用户故事（参见 Mike Cohn 的敏捷估计和规划一书），并设计一个发布计划，为客户提供预期的“草稿”预测——然后他们可以决定是否投资将产生他们正在寻找的回报。

当然，我假设您会提前/经常发布，以便您的客户始终拥有最终产品的一些功能增量——这对于他们对项目的持续评估至关重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T12:11:29.037

一般来说，小型、直接、非关键项目：没有规范。大型、复杂、关键的项目：绝对是规格。

这里可能没有任何简单的指标。您将不得不依靠您的软件工程判断。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T12:22:51.413

一般来说，你应该总是写出规范。你应该被说服*不*要这样做。

*   如果您在一个项目中有多个人，那么您肯定需要规范。
*   如果一个人的项目需要一周以上的时间，您可能需要规范。
*   如果您和您的客户之间曾经出现过混淆或沟通困难，那么必须签署规范。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T13:05:22.340

专注于本质和对您的客户最重要的东西。总体业务目标和愿景。我喜欢“电梯测试”——能够在两分钟内解释你的产品做了什么：

**对于**（目标客户）
**谁**（需求或机会陈述）
**（**产品名称）是一个（产品类别）**与**（主要竞争替代品）不同
**的**（主要优势，令人信服的购买理由）**我们的产品**（主要差异化陈述）

 *****（摘自杰弗里·摩尔的《跨越鸿沟》）*

也许这并不能回答您的问题，但是可以为任何项目编写如此小的“规范”。

# svn - 清理 Subversion 存储库的最佳方法是什么？

> ID：681279
> 
> 赞同：10
> 
> 时间：2009-03-25T12:07:32.620
> 
> 标签：svn, version-control

我有一个不断增长的存储库，其中包含我使用 TortoiseSVN 维护的十几个项目（因为我对此完全陌生，还不知道来龙去脉）。我必须保存存储库的空间有限，所以我想备份它，然后删除一些旧版本。例如，如果一个项目是版本 50，我只想保留 50、49、48。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-25T12:20:19.877

删除旧版本有点破坏版本控制的意义，但是您可以直接转储出要保留的版本，然后将它们放入新的存储库中，然后删除旧的。

```
svnadmin dump /path/to/current/repo -r48:50 > svn.dump
svnadmin create /path/to/new/repo
svnadmin load /path/to/new/repo < svn.dump 
```

或者使用[svndumpfilter](http://svnbook.red-bean.com/en/1.1/ch05s03.html#svn-ch-5-sect-3.1.3)来包含/排除您想要的特定位等。在 svn 常见问题解答中还有一些关于[删除](http://subversion.tigris.org/faq.html#removal)的信息，您可能会觉得有用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-12-03T21:56:52.673

**我可以删除旧版本或存储库以释放存储空间吗？**

最简洁的答案是不。Subversion 和 CVS 的工作方式是它们保留完整的更改历史记录，包括已删除的文件、二进制文件等。每个修订版都依赖于最后一个修订版，因此您不能只是在中间的某个地方删除修订版，或者您损坏您的存储库。如果空间不足，您可以做两件事：1) 删除您的模块，然后仅使用 HEAD 修订版重新创建它，这将清除所有旧修订版（但您将丢失提交历史记录）。2）更好的选择-升级到更高的计划:-)。这对 Git 来说不是问题，因为它的服务器端存储需求要少得多。

**如何从存储库的历史记录中完全删除文件？**

在某些特殊情况下，您可能想要销毁文件或提交的所有证据。（也许有人不小心提交了一份机密文件。）这并不容易，因为 Subversion 被刻意设计为永远不会丢失信息。修订是相互依赖的不可变树。从历史中删除修订会导致多米诺骨牌效应，在所有后续修订中造成混乱，并可能使所有工作副本无效。

然而，该项目计划在某一天实施一个 svnadmin obliterate 命令，该命令将完成永久删除信息的任务。（见问题 516。）

同时，您唯一的办法是 svnadmin 转储您的存储库，然后通过 svndumpfilter（不包括错误路径）将转储文件传送到 svnadmin 加载命令中。有关这方面的详细信息，请参阅 Subversion 手册的第 5 章。

引自：

[http://subversion.apache.org/faq.html#removal](http://subversion.apache.org/faq.html#removal)

[http://codesion.com/benefits/faq.htm#deleterevisions](http://codesion.com/benefits/faq.htm#deleterevisions)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T12:20:03.837

**没有办法以您描述的方式在特定修订版中“剪切”存储库。**您可以做的是`svn export`整个存储库处于所需的修订版，然后将其导入新的存储库，然后从您的日志文件将修订后的提交重播到新的存储库中。这不是微不足道的。

或者，如果您只想从存储库中排除一些杂乱的路径，并且您可以直接访问存储库所在的文件系统，则可以使用`svnadmin`和的组合`svndumpfilter`来选择您想要的路径并修剪所有其他路径。

请注意，您所描述的内容或多或少与 Subversion 的观点背道而驰：它应该保留所有内容。如果您经常遇到此问题，请考虑建立更好的签到实践。或者考虑使用[**Git**](http://git-scm.com/)，它使这种实验几乎免费。

# sql-server - 为什么会一直出现“表已标记为删除”的消息？

> ID：681282
> 
> 赞同：26
> 
> 时间：2009-03-25T12:08:11.403
> 
> 标签：sql-server, database

使用 SQL Server 2008，我正在 Management Studio 设计器中进行一些架构构建。

我在流程的早期创建了一个名为“Animal”的表，但不久之后决定删除。我通过 Management Studio 中的树视图将其删除（右键单击删除）。

现在我在这个过程中很晚了，我想重新创建表“动物”但具有不同的字段。

Animal 的第二轮创建得很好，但是当我尝试将表添加到我的图表时，我收到消息“表 'Animal' 已标记为删除，无法添加到图表或在表设计器中打开” .

这是怎么回事？我怎样才能再次正常使用该表，而不会受到旧表命名冲突的影响？

或者，如果表被标记为删除，我实际上可以以某种方式调用删除吗？然后重新创建另一个同名的表。

这有点烦人。将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-05-13T19:31:02.323

我可以通过关闭 SQL Management Studio 并重新打开它来解决这个问题。我敢打赌，只要切断与服务器的连接并恢复它就可以了。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-08T20:51:16.990

只是从 SQL Management Studio 断开连接不起作用。但是重新启动 SQL Management Studio 有效。还是比重启系统好。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-28T04:51:48.277

什么有效：重新启动。

重新启动整个计算机工作。

简单地重新启动数据库服务器是行不通的，但是重新启动整个机器就可以了。

我不知道为什么！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-06-27T01:55:31.740

我知道这很旧，但我遇到了同样的问题。我在这里找到了解决方案：

[http://weblogs.asp.net/atlaszhu/archive/2010/04/04/sql-server-2008-database-diagram-quot-saving-changes-is-not-permitted-quot.aspx](http://weblogs.asp.net/atlaszhu/archive/2010/04/04/sql-server-2008-database-diagram-quot-saving-changes-is-not-permitted-quot.aspx)

基本上说在“表和数据库设计器”部分中有一个选项，称为“防止保存更改需要重新创建表”-选中此选项后，您将收到您所询问的错误。

当我禁用此选项时，我能够保存我的数据库图。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T12:12:36.150

如果您使用的是架构工具，重新创建架构可能会更简单。根据我的经验，我发现该工具有一些奇怪的怪癖，这些怪癖通过简单地重新创建模式（它的图形视图，而不是整个数据库 :) 来解决）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-26T14:49:49.990

从[MSDN](http://msdn.microsoft.com/en-us/library/ms175517.aspx)中，从 Visual Database Designer 中删除表：

> 1.  在您的数据库图表中，选择要删除的表。
> 2.  右键单击表格并从快捷菜单中选择从图表中删除表格。
> 
> -或者-
> 
> 按 ESC 键。
> 
> 如果由于您在数据库图表中所做的编辑而导致表有未保存的更改，则会有一条消息提示您在删除之前保存表。
> 
> 该表已从图表中删除， **但仍存在于数据库中**。

因此，要删除它，您必须从脚本或对象资源管理器 ( [MSDN](http://msdn.microsoft.com/en-us/library/ms190616.aspx) ) 中执行此操作：

> 从数据库中删除表
> 
> 1.  在对象资源管理器中，选择要删除的表。
> 2.  右键单击表并从快捷菜单中选择删除。
> 3.  一个消息框会提示您确认删除。单击是。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-01-05T10:17:43.027

任何图表上都可能有该表的任何链接，只需打开数据库图表，它就会告诉您该表已被删除。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-10-23T14:01:13.320

Just close SQL Server Management Studio, disable network connection (unplug cable or disable wifi), re-open SQL Management Studio and reconnect the network. It should work fine now.

# c# - 如何使引用类型属性“只读”

> ID：681287
> 
> 赞同：12
> 
> 时间：2009-03-25T12:09:35.563
> 
> 标签：c#, properties, encapsulation, readonly

我有一个`Bar`包含引用类型的私有字段的类`Foo`。我想`Foo`在公共财产中公开，但我不希望财产的消费者能够改变`Foo`......但是它应该可以通过内部改变`Bar`，即我不能制作该领域`readonly`。

所以我想要的是：

```
 private _Foo;

      public Foo 
      { 
         get { return readonly _Foo; } 
      } 
```

...这当然是无效的。我可以只返回一个`Foo`（假设它是`IClonable`）的克隆，但这对消费者来说并不明显。我应该将属性名称更改为`FooCopy`?? 它应该是一种`GetCopyOfFoo`方法吗？您认为最佳做法是什么？谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-25T12:12:36.150

听起来你在 C++ 中追求相当于“const”的东西。这在 C# 中不存在。没有办法表明消费者不能修改对象的属性，但其他东西可以（当然，假设变异成员是公共的）。

您可以按照建议返回 Foo 的克隆，或者可能返回 Foo 的*视图*，就像[ReadOnlyCollection](http://msdn.microsoft.com/en-us/library/ms132474.aspx)对集合所做的那样。当然，如果你可以制作`Foo`一个不可变类型，那会让生活变得更简单......

*请注意，使字段*只读和使对象本身不可变之间存在很大差异。

目前，类型本身可以以两种方式改变事物。它可以这样做：

```
_Foo = new Foo(...); 
```

*或者*

```
_Foo.SomeProperty = newValue; 
```

如果它只需要能够执行第二个，则该字段可能是只读的，但您仍然会遇到人们获取属性能够改变对象的问题。如果它只需要做第一个，并且实际上`Foo`已经是不可变的或者可以变为不可变的，那么您只需提供一个只有“getter”的属性就可以了。

了解更改字段的值（使其引用不同的实例）和更改字段引用的对象的内容之间的区别非常*重要。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T12:18:23.717

不幸的是，目前在 C# 中没有简单的方法来解决这个问题。您可以提取接口中的“只读部分”`Foo`并让您的属性返回它而不是`Foo`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T12:14:03.667

正如您已经推测的那样，制作副本、a`ReadOnlyCollection`或不可变通常是三种最佳途径。`Foo`

当我做的事情比简单地返回基础字段更重要时，我有时会更喜欢方法而不是属性，这取决于涉及的工作量。方法意味着某些事情正在发生，并在消费者使用您的 API 时为他们提出更多的标志。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T12:16:19.637

“克隆”您接收并返回的 Foo 对象是一种称为**防御性复制**的正常做法。除非对用户可见的克隆有一些看不见的副作用，否则绝对没有理由不这样做。它通常是保护类的内部私有数据的唯一方法，尤其是在 C# 或 Java 中，C++ 的想法`const`不可用。（IE，必须这样做才能在这两种语言中正确创建真正不可变的对象。）

澄清一下，可能的副作用是您的用户（合理地）期望返回原始对象，或者 Foo 持有的某些资源不会被正确克隆。（在这种情况下，实现 IClonable 的目的是什么？！）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T12:40:42.383

如果您不想让任何人扰乱您的状态......不要暴露它！正如其他人所说，如果需要查看您的内部状态，请提供它的不可变表示。或者，让客户告诉*你*做某事（谷歌的“告诉不要问”），而不是自己做。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T12:25:11.110

为了澄清 Jon Skeet 的评论，您可以创建一个视图，这是可变 Foo 的不可变包装类。这是一个例子：

```
class Foo{
 public string A{get; set;}
 public string B{get; set;}
 //...
}

class ReadOnlyFoo{
  Foo foo; 
  public string A { get { return foo.A; }}
  public string B { get { return foo.B; }}
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-25T13:01:04.927

您实际上可以在 C# 中重现 C++ const 的行为 - 您只需手动完成。

不管`Foo`是什么，调用者可以修改其状态的唯一方法是调用它的方法或设置属性。

例如，`Foo`是类型`FooClass`：

```
class FooClass
{
    public void MutateMyStateYouBadBoy() { ... }

    public string Message
    {
        get { ... }
        set { ... }
    }
} 
```

因此，在您的情况下，您很高兴他们获得该`Message`属性，但不对其进行设置，并且您绝对对他们调用该方法不满意。

所以定义一个接口来描述他们可以做什么：

```
interface IFooConst
{
    public string Message
    {
        get { ... }
    }
} 
```

我们省略了 mutating 方法，只保留了属性的 getter。

然后将该接口添加到`FooClass`.

现在在你的类中`Foo`，你有一个字段：

```
private FooClass _foo; 
```

还有一个属性获取器：

```
public IFooConst Foo
{
    get { return _foo; }
} 
```

这基本上可以精确地手动复制 C++`const`关键字会自动执行的操作。在伪 C++ 术语中，类型的引用`const Foo &`就像一个自动生成的类型，它只包含那些`Foo`被标记为成员的`const`成员。将其转换为 C# 的一些理论上的未来版本，您将声明`FooClass`如下：

```
class FooClass
{
    public void MutateMyStateYouBadBoy() { ... }

    public string Message
    {
        get const { ... }
        set { ... }
    }
} 
```

实际上，我所做的只是通过用新关键字标记一个安全成员，将信息合并`IFooConst`回。所以在某种程度上，添加一个 const 关键字除了对该模式的正式方法之外不会对语言增加太多。`FooClass``const`

然后，如果你有`const`一个对象的引用`FooClass`：

```
const FooClass f = GetMeAFooClass(); 
```

您将只能调用 const 成员`f`。

请注意，如果`FooClass`定义是公开的，则调用者可以将 an`IFooConst`转换为`FooClass`. 但他们也可以在 C++ 中做到这一点——这被称为“抛弃`const`”，并涉及一个名为`const_cast<T>(const T &)`.

还有一个问题是接口不是很容易在你的产品版本之间发展。如果第三方可以实现您定义的接口（如果他们可以看到，他们可以自由地做），那么您不能在未来的版本中向它添加新方法，而不需要其他人重新编译他们的代码。但这只是一个问题，如果您正在编写一个可扩展的库供其他人构建。也许内置`const`功能可以解决这个问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-02-11T22:39:40.187

我在考虑类似的安全问题。大概是有办法的。很清楚但不短。总体思路很简单。但是我总是找到一些方法，所以从来没有测试过。但是你可以检查一下——也许它对你有用。

这是伪代码，但我希望它背后的想法很清楚

```
public delegate void OnlyRuller(string s1, string s2);
public delegate void RullerCoronation(OnlyRuller d);

class Foo {
  private Foo();
  public Foo(RullerCoronation followMyOrders) {
     followMyOrders(SetMe);
  }

  private SetMe(string whatToSet, string whitWhatValue) {
     //lot of unclear but private code
  }
} 
```

因此，在创建此属性的类中，您可以访问 SetMe 方法，但它仍然是私有的，因此除了创建者 Foo 之外，它看起来是不可变的。

仍然对于任何比少数属性更大的东西，这可能很快就会变得超级混乱——这就是为什么我总是更喜欢其他封装方式。但是，如果不允许客户端更改 Foo 对您来说非常重要，那么这是一种替代方法。

然而，正如我所说，这只是理论。

# javascript - 是否有使用非等分值的 jquery 滑块的插件或示例？

> ID：681303
> 
> 赞同：10
> 
> 时间：2009-03-25T12:14:27.690
> 
> 标签：javascript, jquery, slider

我发现了两个出色的 jquery 插件，用于为 Web 表单生成滑块，它们在不支持 javascript 的浏览器中很好地降级，关闭了样式等。

第一个是 Jquery.UI 版本：[http ://ui.jquery.com/demos/slider/#steps](http://ui.jquery.com/demos/slider/#steps)

第二个是滑块的选择元素：[http ://www.filamentgroup.com/lab/update_jquery_ui_16_slider_from_a_select_element/](http://www.filamentgroup.com/lab/update_jquery_ui_16_slider_from_a_select_element/)

但是，我需要创建一个不只是将滑块分成相等部分的滑块。

例如，假设我有以下数字范围：

800,1000,1100,1200,1300,1400,1500

我希望滑块在 800 和 1000 之间有一个很好的大间隙，然后在 1100-1500 之间有更小的间隙

所以滑块看起来有点像这样：

800----1000--1100--1200--1300--1400--1500

最好我希望它降级为下拉菜单，所以问题是有没有人知道支持此功能的插件或有任何建议以实现此功能的最佳方式，自定义灯丝组插件滚动我自己的等等。

**更新：**一直在使用灯丝组的滑块进行破解，无论如何它都通过 JQuery UI 的滑块实现了句柄。所以看起来修改 JQuery.UI 它的自身是唯一可用的选项。将在代码中挖掘，看看我是否能找到需要更改的必要位。如果在此期间有人有任何想法！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-26T03:04:04.773

您可以通过挂钩到幻灯片事件（有效地覆盖它）来使用 jquery 的滑块来做到这一点......这样的事情：

```
$(function() {
    var values = [0, 10, 50, 60, 70, 80, 90, 91, 92, 93, 94, 95, 100];
    var slider = $("#slider").slider({
        slide: function(event, ui) {
            var includeLeft = event.keyCode != $.ui.keyCode.RIGHT;
            var includeRight = event.keyCode != $.ui.keyCode.LEFT;
            slider.slider('option', 'value', findNearest(includeLeft, includeRight, ui.value));
            return false;
        }
    });
    function findNearest(includeLeft, includeRight, value) {
        var nearest = null;
        var diff = null;
        for (var i = 0; i < values.length; i++) {
            if ((includeLeft && values[i] <= value) || (includeRight && values[i] >= value)) {
                var newDiff = Math.abs(value - values[i]);
                if (diff == null || newDiff < diff) {
                    nearest = values[i];
                    diff = newDiff;
                }
            }
        }
        return nearest;
    }
}); 
```

应该适用于您所描述的...我已经测试了它是否可以使用鼠标拖动并使用左/右/home/end 键（显然，如果您想要垂直，您需要将左/右更改为上/下滑块）。

一些注意事项：

*   显然，值数组是您想要的任何步骤。
*   同样显然，上面的代码假设一个 id 为“slider”的 div 可以工作。
*   如果您的最小值/最大值与滑块的最小值/最大值不同（我建议只使用“min：values [0]，max：values [values.length - 1]”作为您在滑块上的最小/最大选项，那么您应该始终是安全的）。
*   显然这个选项目前不会降级为下拉列表，但它会很容易做到......只需将您的选择呈现为正常的下拉列表（默认状态为无 javascript）然后使用 jquery 隐藏下拉列表，并根据选项创建您的值数组。然后，您可以在更新上面代码中的滑块的同时更新（隐藏）下拉列表，这样当您的表单发布时，将在下拉列表中选择正确的值。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-30T13:14:14.040

在 Es6 中，您可以通过以下方式找到离您最近的号码 ..

```
function findClosest(array, value) {
  return array.sort( (a, b) => Math.abs(value - a) - Math.abs(value - b) )[0];
}

let array = [1, 5, 10, 28, 21];
let v = 4;
let number = findClosest(array, v); // -> 5 
```

# svn - 您对 SVN 分支和标签使用哪些命名约定？

> ID：681309
> 
> 赞同：38
> 
> 时间：2009-03-25T12:15:21.650
> 
> 标签：svn, naming-conventions

我们公司正在为 SVN 分支和标签创建一个命名约定，我对在分支/标签名称上仅使用日期或内部版本号的想法不满意。

我认为我们需要能够更好地定义这条路径代表什么、正在进行的努力等的名称。

你认为/使用什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-25T14:30:14.743

我总是在标签（通常也是分支）前面加上 YYYYMMDD 格式的日期，然后是标签或分支用途的描述。

例如，20090326_Release_v6.5 或 20090326_Post_Production_Update

这当然是在标准的主干/标签/分支层次结构下。

日期前缀确保它们所有的标签或分支都按创建顺序显示，如果您扫描一个大的标签文件夹，这比仅按描述排序更有用。您会看到创建它们的时间和原因（如迷你日志消息）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-26T09:46:25.900

Well, branching is pretty much open, since there's several different kinds of branches, the naming of them can be very different.

It's worth remembering what source control gives you. Tag names are not just "v1.4", it's "/CashCowProject/tags/v1.4". Naming a tag "/CashCowProject/tags/CashCowProject-v1.4" is a little redundant, what else would it be?

Revision control also gives you full access to dates and times that tags were created. Revision control also gives you commit messages which you should be making use of, particularly the first line.

Given all this information, it's not difficult to pull together a simple view giving you all the information you need, coming from consistent and appropriate sources, such as:

```
CashCowProject
    v1.4 - 26 March 2009     :  With Added whizzbang (more)
    v1.3 - 13 February 2009  :  Best graphics!       (more)
    v1.2 - 01 January 2009   :  Upgraded security    (more) 
```

The only thing that the tag name is really useful for here is the version number. If you're trying to put all the information into a tag name, it's a little wordy and I bet it won't look as good.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-25T12:21:34.053

对于功能分支，以正在完成的操作命名。例如，我将 ORM 从 LINQ 移动到 SQL 到 NHibernate，并创建了一个名为“NHibernate”的分支。完成分支并将其合并回主干后，您可以删除分支以保存将来的命名冲突。如果你真的需要尽可能地检索分支，你只需要深入研究历史并恢复它。

如果您有与分支相关的故事/报价/工作编号，我会将其附加到分支的名称中，例如。“NHibernate_429”，因此您可以轻松地将其引用到您的跟踪系统中。但是，我总是首先使用英语，因为当它处于开发阶段时，人们会更实际地使用它。

对于诸如标签之类的事情，很难说出您想要做什么，因为这取决于您要标记的内容。如果您要标记发布，那么我会使用“发布 XXXX”或类似的简单内容。例如，当您回顾特定版本时，您真的不会关心日期或内部版本号是什么。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-25T12:18:18.257

我们所有的开发人员任务都进入错误跟踪系统。此错误跟踪系统具有与每个任务关联的 ID。

所以对于任何任务的分支名称，我们使用：

> `ticketId_TicketSubject`

当一个分支包含多个 ticketId 时，我们只需将它们组合成分支名称：

> `ticketId1_ticketId2_Description`

这样，如果您在工单中并且想知道要构建哪个分支，则可以轻松查找它。同样，如果您想通过您的分支构建找到票证，您也可以轻松找到它。

对于标签，我们通过版本号本身对其进行标记。

至于各个分店的位置。我们有一个像这样的顶级层次结构：

> `/branches`
> 
> `/tags`
> 
> `/trunk`

然后我们所有的产品/项目都在各自的子文件夹中。

> `/trunk/project1/`
> 
> `/branches/project1/TicketId_Description`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T12:24:19.413

我们使用的（主要遵循公认的约定）：

```
projectName
 |
 --trunk
 |
 --tags
 |
 --branches 
```

在主干下，我们有主干。

在标签下，我们标记每个版本（内部版本、测试版本和客户版本）。在那里，我们只使用版本号作为标签名称。

在分支下，我们发布的每个主要版本都有一个分支（在我们的例子中是一次 XP 迭代的结果）。这些被命名为主要版本（“v5.03”、“v6.04”）。此外，我们有内部分支以进行重大更改或特殊版本。命名是自由形式的，名称应该告诉人们分支代表什么。例如“workaround_customerA”、“module_x_reorg”等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-25T12:28:04.677

我们给我们的分支一个“.X”版本，其中标签有一个数字。

例如，分支是 Foo-1.2.3.X，标签是 Foo-1.2.3.1、Foo-1.2.3.2 等。

我们还有一个特殊的标签，Foo-1.2.3.0，它是在从主干创建分支后立即生成的，在任何更改之前。这样我们就可以随时将分支和标签与初始状态进行比较（因为几天后，主干可能会有所不同）。这种做法使合并变得更容易一些，并且使找出分支中更改了哪些代码变得容易得多。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-08-26T17:53:10.733

更好的：

```
<projectname>_<Year>_<minor>_00 
```

喜欢：

XYZ_14_01_00

# python - 来自 Code 的游戏地图

> ID：681310
> 
> 赞同：3
> 
> 时间：2009-03-25T12:16:19.463
> 
> 标签：python

这是一个很长的时间，所以你可能想要喝你一直拖延的那杯茶/咖啡；）

我经营一款名为 World of Arl 的游戏，它是一款类似于 Risk 或 Diplomacy 的回合制策略游戏。每个玩家都有一组城市、军队等等。问题围绕着这些东西的展示展开。目前，该地图是使用背景图像创建的，其上带有团队图标的 CSS 定位以表示城市。你可以在这里看到它的样子：[WoA Map](http://woarl.com/map/turn_32_normal.html)

地图的背景图像位于此处：[地图背景](http://woarl.com/map/images/theMap.jpg)并在[Omnigraffle](http://www.omnigroup.com/applications/omnigraffle/)中创建。它不是为绘制地图而设计的，但我对 Photoshop 无能为力，这对我的目的来说很好用。

问题来了，我想执行诸如寻路之类的有趣的事情，为此我需要以某种方式将地图存储在代码中。我尝试过使用[PIL](http://www.pythonware.com/products/pil/)，我已经考虑将它与[Blender](http://www.blender.org/)结合起来，我尝试过“老派”并从许多旧游戏中创建图块，最后我尝试使用 SVG。我这样说是为了让你清楚地看到，我有这个问题并不是因为缺乏尝试；）

我希望能够将地图布局存储在代码中，并从中创建图像并将其用于诸如寻路之类的事情。我正在使用 Python，但我怀疑大多数答案都是通用的。其他此类东西的城市已经存储并且很容易绘制，我想存储陆地的布局和陆地上的特征。

至于寻路，每种类型的地形都有移动成本，当地图仅作为图像存储时，我无法访问给定区域的地形。除了寻路我希望能够知道与游戏相关的各种事物的地形，例如山区城市会产生石头。

有没有一种好的方法可以做到这一点，我应该在谷歌中使用哪些术语，因为我尝试过的术语都提出了不相关的东西（映射在大多数情况下是完全不同的东西）。

编辑2：军队可以放置在地图上的任何地方，城市也可以放置在任何地方，但在他们会下沉、淹死和可能抱怨的水中（按此顺序）。

在与 MSN 上的某个人聊天后，他让我了解了非常细微的细节，并且对游戏有更好的理解（因为他玩过它）我突然想到瓷砖是要走的路，但不是我的路原本以为。我把位图照原样放了下来，但也有一个瓦片数据层，每个瓦片都有给定的地形类型，因此可以在上面进行寻路等，但同时我仍然使用 Omnigraffle 进行渲染，效果很好。

[我将按照Adam Smith](https://stackoverflow.com/users/66634/adam-smith)的建议为此做一名编辑。我不知道这些图表是否与[Xynth](https://stackoverflow.com/users/62014/xynth)相关，但我还没有机会完全研究它们。

我真的很感谢所有回答我问题的人，谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T12:24:27.197

我会将游戏地图以[图形](http://en.wikipedia.org/wiki/Graph_(mathematics))的形式存储在代码中。

每个节点代表一个国家/城市，每个边代表邻接。一旦你有了这样的地图，我相信你可以在网上找到很多关于人工智能的资源（寻路、策略等）。

如果您希望能够以编程方式构建地图图像，请考虑为每个节点添加 (x, y) 坐标和图像。这样，您可以在给定坐标处显示所有图像以构建地图视图。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T12:55:11.507

这里要实现的关键是您不必只使用**一张**地图。您可以使用两个地图：

*   您已经拥有的在屏幕上绘制的
*   未绘制但用于路径查找、碰撞检测等的隐藏地图。

那么自然的下一个问题是第二张地图来自哪里？很容易，您可以创建自己的工具来加载您的第一张地图并显示它。然后，您的工具将允许您在岛屿周围绘制边界并在您的城市放置标记。这些标记和边界（例如简单的多边形）存储为您的第二张地图，并在您的代码中用于进行路径查找等。

事实上，您可以让您的工具发出创建图形和多边形的 python 代码，这样您就不必自己加载任何数据。

我只是基本上告诉你做一个关卡编辑器。这不是很难做到。您只需要单击一些按钮来定义您要添加的内容。例如，如果您要添加多边形。然后，如果您切换了添加多边形按钮，则每次单击鼠标时都可以将每个鼠标坐标添加到数组中。您可以使用另一个按钮来添加城市，这样每次单击地图时，您都会记录该城市的坐标，并可能在文本框中提供相应的名称。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T12:40:27.970

您将不得不将您的地图翻译成某种抽象表示。xynth 建议的网格（十六进制或正方形）或图形。这是您能够应用诸如寻路算法之类的东西的唯一方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T12:36:36.387

IMO，应该首先渲染地图而不是位图。您应该做的是让每个对象都清楚地知道其尺寸，例如通用区域类和从此类派生的城市、城镇等类。您的对象应该具有有关其位置、地形等的所有信息，并且应该被渲染/绘制等。这样您将准确了解所有东西的位置。

另一种选择是保持位图不变，并将此信息作为数据保存在对象中。通过这样做，对象将没有绘图功能，但它们将具有其位置等的精确信息。这有点复制数据，但如果你想使用位图选项，我想不出任何其他方式.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T12:39:28.223

如果您只想在地图上进行例如 2D 命中测试，那么您自己存储它就可以了。您可以通过以下几种方式存储信息：

*   每个岛一个多边形
*   将每个岛表示为列表矩形的联合（通常由窗口系统使用）
*   创建地图的特殊（可能是灰度）位图，为每个岛屿使用独特的纯色
*   更复杂的东西（也许无论 Omnigiraffe 的内部表示是什么）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-25T12:55:45.203

假设地图是固定的（不是动态创建的），使用位图作为图形表示是“正确的”——你想让它尽可能漂亮。

对于任何与游戏相关的功能，例如寻路或您想要添加的任何花哨的东西，您应该添加足够的数据结构，即使这意味着某些数据是多余的。

例如，将岛屿的边界描述为多边形样条线（手动或从位图自动创建，这取决于您以及您想要花费多少努力以及获得所需功能所需的努力）。

总结一下：创建与您必须解决的问题相匹配的数据结构，位图看起来不错，但避免在其上进行路径调整或其他东西。

# svn - 我在哪里可以找到将整个树（或分支）以图形方式显示为地图的 SVN 应用程序

> ID：681315
> 
> 赞同：2
> 
> 时间：2009-03-25T12:17:37.417
> 
> 标签：svn, user-interface

由于一些关于工作项目中分支的不良做法，我正在寻找一个应用程序，我可以指向一个颠覆服务器并生成一个地图，该地图将以图形方式勾勒出存在的老鼠巢穴。

任何帮助将不胜感激。

干杯利亚姆

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T12:19:42.810

如果您使用的是 Windows，[TortoiseSVN](http://tortoisesvn.tigris.org/)修订图不符合您的要求吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T12:22:08.467

尝试`svn ls -R`命令行版本。不过，图形化程度并不高。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T12:25:07.243

更多跨平台解决方案是使用 svn-graph.pl ( [http://subversion.tigris.org/tools_contrib.html#svn_graph_pl](http://subversion.tigris.org/tools_contrib.html#svn_graph_pl) ) 和 GraphViz ( [http://www.graphviz.org/](http://www.graphviz.org/) )

可能需要一些组装。

# apache - URL 重写 - 不带文件扩展名的重定向

> ID：681322
> 
> 赞同：3
> 
> 时间：2009-03-25T12:19:16.710
> 
> 标签：apache, .htaccess, friendly-url, url-rewriting

我目前在 .htaccess 文件中使用以下规则：

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ $1.php 
```

这很好地确保了它的`/myfile.php`正常工作`myfile`（在 URL 中没有扩展名）。它还可以毫无问题地处理查询字符串，因此`myfile?var=foo`也可以。

问题是这些在 Google Analytics 中注册为两个单独的文件。因此，虽然`myfile.php`可能是我网站上第三受欢迎的页面，有 X 次访问，但`myfile`可能是我网站上第五受欢迎的页面，有 Y 次访问。

如何进行硬重定向，而不是“接受任何一种”类型的规则？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T12:21:05.847

试试这个规则来重定向`.php`文件请求：

```
RewriteCond %{THE_REQUEST} ^GET\ /(([^/?]*/)*[^/?]+)\.php
RewriteRule ^.+\.php$ /%1 [L,R=301] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T15:20:57.803

你能改变你的最后一个 RewriteRule 来做到这一点吗？

```
RewriteRule ^(.*)$ $1.php [L,R=301] 
```

这会将“myfile”重定向到“myfile.php”。

此外，您也可以使用规则在 Google Analytics 内部对此进行调整。尽管这可能不是一个理想的解决方案。

**ETA**：如果您希望 myfile.php 重定向到 myfile，请尝试将此作为您的最后一条规则：

```
RewriteRule ^(.+)\.php$ $1 [L,R=301] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-17T14:12:39.577

你可以在你的页面中放一个

```
<link rel="canonical" href="..." /> 
```

[https://support.google.com/webmasters/answer/139066?hl=en](https://support.google.com/webmasters/answer/139066?hl=en)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-07T04:18:31.723

花了我几个小时......但我相信我终于找到了答案。

```
// The Original
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ $1.php

// Add This
RewriteCond %{THE_REQUEST} ^[A-Z]+\ /([^/]+/)*[^.#?\ ]+\.php([#?][^\ ]*)?\ HTTP/
RewriteRule ^(([^/]+/)*[^.]+)\.php /$1 [R=301,L] 
```

在这里找到：[http ://www.webmasterworld.com/apache/3961636.htm](http://www.webmasterworld.com/apache/3961636.htm)

# networking - OSI 与 TCP/IP 网络的实际意义

> ID：681326
> 
> 赞同：3
> 
> 时间：2009-03-25T12:20:06.303
> 
> 标签：networking, tcp, network-protocols, wireless, osi

我应该设置一个“基于地理位置”的 ipv6 无线网状网络以在 google android 上运行。

我发现似乎是一个支持网格划分的好应用程序： [http ://www.open-mesh.net/wiki/batman-adv](http://www.open-mesh.net/wiki/batman-adv)

> “Batman-advanced 是一种新的无线网络方法，它不再在 IP 基础上运行。与使用 UDP 数据包交换信息并设置路由表的 BATMAN 不同，batman-advanced 仅在 ISO/OSI 第 2 层上运行，并使用和路由（或更好：网桥）以太网帧。它模拟所有参与节点的虚拟网络交换机。因此所有节点似乎都是本地链路，因此所有更高的操作协议都不会受到网络内任何变化的影响。您几乎可以运行任何高于 BATMAN Advanced 的协议，突出的例子有：IPv4、IPv6、DHCP、IPX。”

但是我团队中的其他成员说这是不行的，因为它运行在 OSI 上，而不是 TCP/IP。这是我第一次听说 OSI，我想知道这有多大的问题？可以在其上开发的网状网络应用程序有什么影响？考虑到 android 是比较新的，我们不需要太担心与现有应用程序的兼容性，那有关系吗？

我没有花很多时间与网络打交道，所以请用 noobmans 术语。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T12:26:05.663

他们可能指的是[OSI 模型](http://en.wikipedia.org/wiki/OSI_model)，这是区分网络层的常用方法。我不确定这是一种看待事物的有用方式，但它在地球上的每一门网络课程中都有讲授。

OSI 级别 2 是[数据链路层](http://en.wikipedia.org/wiki/Data_Link_Layer)，它直接在实际物理级别之上运行。基本上，它负责流量控制、错误检测和可能的错误纠正。数据链路层是严格的“单跳”。它只关心点对点数据传输，而不关心多跳传输或路由。

如果他们实际上指的是[OSI 网络协议](http://en.wikipedia.org/wiki/Open_Systems_Interconnection)本身，请尽可能快地运行。OSI 是出了名的难以实施，而且我从未听说过真正的工作安装。有关血腥细节，请参阅 Wikipedia 文章。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-25T12:30:53.780

“您几乎可以在 BATMAN Advanced 之上运行任何协议，突出的例子有：IPv4、IPv6、DHCP、IPX。”

“但我团队中的其他成员说这是不行的，因为它运行在 OSI 上，而不是 TCP/IP。”

你团队中的其他成员对 BATMAN 中的流行语感到困惑。

TCP/IP 的“IP”是 IPv4（或 IPv6）。所以BATMAN直接完整地支持TCP/IP。

不存在任何形式的冲突。只是混乱。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T12:34:43.240

OSI 模型和 OSI 协议是不同的。

OSI 模型是一种分解事物的方法：物理、链路、网络、传输、会话、表示、应用程序。OSI 协议是直接映射到模型中的那些层的协议实现。

模型是一种看待事物的方式。它主要是有道理的，但它在更高的层次上被打破了。例如：表示层的真正作用是什么？

在 90 年代，OSI（在某些圈子中）被认为是未来，但实际上是一些公司的倒台，并浪费了许多其他公司的资源。例如，DECnet Phase V 是 Digital 极其复杂的 OSI 堆栈实现，它满足政府的 OSI 要求，但被 TCP/IP 压路机碾压。

测试是：线路上的字节是多少？在这种情况下，它是基于 IP 的 UDP，而不是 OSI 等价物，即 CLNP。

说了这么多，如果是二层协议，由于是二层协议，可能会出现扩展性问题。对于少量节点来说很好，但如果你想扩大规模，你需要一个更好的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T12:24:44.997

“ISO/OSI 第 2 层”并不意味着 OSI 协议。它指的是网络堆栈的“七层”模型。这意味着数据链路层。

这些层是：物理层、数据链路层、网络层、传输层、会话层、表示层、应用层。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-03-25T12:25:15.887

OSI 是一个模型，而不是 IP 和 TCP 之类的协议。您的团队似乎在说网格不会使用 IP。我怀疑他们是错误的，因为您引用的文本指出 BATMAN 协议能够支持 IP 和 IPv6，如果是这种情况，您需要一个非常充分的理由来使用其他任何东西。

# windows - 正在寻找查看 Windows 消息的程序

> ID：681332
> 
> 赞同：3
> 
> 时间：2009-03-25T12:22:30.867
> 
> 标签：windows, windows-messages

我正在寻找一个程序来查看 Windows 消息

你能帮我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T12:25:35.447

Spy++ 与 Visual Studio 一起提供。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T12:28:19.153

我发现[Winspector](http://www.windows-spy.com/)比 Spy++ 更稳定，尤其是在调试程序同时监视消息时。

# c# - 更改包含具有 ItemContainerStyle 上的控件模板并绑定到 CollectionViewSource 的列表框的选项卡时，应用程序崩溃

> ID：681339
> 
> 赞同：0
> 
> 时间：2009-03-25T12:24:23.733
> 
> 标签：c#, wpf, crash, styles

我的问题是我有三个选项卡控件，每个选项卡控件都有一个列表框，该列表框具有 ListBox 和 ItemContainerStyle 的样式，选项卡内的所有列表框的样式都相同。

其中两个选项卡使用 CollectionViewSource 进行数据绑定。

问题是，一旦我尝试进入选项卡 2，我就会得到一个异常，我似乎无法找到从哪里来（我也厌倦了启用第一次机会异常，但什么也没有）

玩弄它我发现如果我从选项卡二中的 ListBox 中删除 ItemContainerStyle 它不再崩溃。另一种阻止它崩溃的方法是在列表框中没有任何项目。另一种方法是不使用 CollectionViewSource，而是在列表上使用 GetDefaultView() 并绑定到该列表。

这是我用来绑定到列表框的行：

```
 this.FListViewSource = (this.FindResource("FirstCollectionViewSource") as AutoRefreshCollectionViewSource);
        this.FListViewSource.Source = this.FirstList;
        this.FListView = (this.FListViewSource.View as ListCollectionView);

       this.SListViewSource = (this.FindResource("SecondCollectionViewSource") as AutoRefreshCollectionViewSource);
       this.SListViewSource.Source = testing;
        this.SListView = (this.SListViewSource.View as ListCollectionView); 
```

这是选项卡控件的 XAML：

```
 <TabControl Width="Auto" Height="Auto">
                    <TabItem Header="tab 1">
                        <StackPanel Name =first_Panel" >
                            <ListBox  Style="{StaticResource lb_ms}"  ItemContainerStyle="{StaticResource black_lb}" Width="160"  Name="first_lb"  
                                      ItemsSource="{Binding}" DisplayMemberPath="name" MinHeight="400" MaxHeight="500" ButtonBase.Click="lb_Click" Margin="5,0,5,0"/>

                        </StackPanel>
                    </TabItem>
                    <TabItem Header="tab 2">
                        <StackPanel Name ="second_Panel"  DataContext="{Binding Source={StaticResource FirstCollectionViewSource}}" FlowDirection="LeftToRight" Background="#333333">

                            <ListBox  ItemsSource="{Binding}" Style="{StaticResource lb_ms}"  ItemContainerStyle="{StaticResource black_lb}" Width="160"  Name="second_lb"  
                                      DisplayMemberPath="name"  MinHeight="400" MaxHeight="500" ButtonBase.Click="lb_Click" Margin="5,0,5,0"/>        
                      </StackPanel>
                    </TabItem>
                    <TabItem Header="Media">

                    </TabItem>
                    <TabItem Header="Domains">
                        <StackPanel Name ="third_Panel" DataContext="{Binding Source={StaticResource SecondCollectionViewSource}}" FlowDirection="LeftToRight" Background="#333333">

                            <ListBox  Style="{StaticResource lb_ms}"  ItemContainerStyle="{StaticResource black_lb}" Width="160"  Name="third_lb"  
                                      ItemsSource="{Binding}" DisplayMemberPath="name" MinHeight="400" MaxHeight="400" ButtonBase.Click="lb_Click" Margin="5,0,5,0" SelectionMode="Multiple" />

                        </StackPanel>
                    </TabItem>
                </TabControl> 
```

这是包含样式的资源目录：

```
<ResourceDictionary.MergedDictionaries>
    <ResourceDictionary Source="Brushes.xaml" />
</ResourceDictionary.MergedDictionaries>

<Style x:Key="black_lb" TargetType="{x:Type ListBoxItem}">
    <Setter Property="Foreground" Value="#FFFFFF" />
    <Setter Property="FontFamily" Value="Verdana" />
    <Setter Property="FontSize" Value="11" />
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type ListBoxItem}">
                <Canvas Name="can" Width="Auto" Height="25">
                    <Rectangle  Name="filler" Canvas.Top="0" Canvas.Left="0" Width="200" Height="25">
                        <Rectangle.Fill>
                            <SolidColorBrush x:Name="fillb" Color="#333333"/>
                        </Rectangle.Fill>
                    </Rectangle>
                    <Path d:LastTangent="0,0" Stroke="{x:Null}" Fill="#FF6E00" HorizontalAlignment="Right" VerticalAlignment="Top" Width="7" Height="7" Canvas.Left="15" Opacity="0" Canvas.Top="6" x:Name="Path" RenderTransformOrigin="0.5,0.5" Stretch="Fill" Data="M601.11544,190.39485 L590.06202,213.0964 613,213">
                        <Path.RenderTransform>
                            <TransformGroup>
                                <RotateTransform Angle="90"/>
                            </TransformGroup>
                        </Path.RenderTransform>
                    </Path>

                    <StackPanel Panel.ZIndex="1000" Name="ActionsContainer" Visibility="Hidden" Canvas.Right="0" HorizontalAlignment="Right"  Orientation="Horizontal">
                        <Button Name="btn_edit" FontSize="10" Content="Edit" Height="20" Width="Auto"/>
                        <Button Name="btn_delete" FontSize="10" Content="Delete" Height="20" Width="Auto"/>
                    </StackPanel>
                    <ContentPresenter Name="con" Canvas.Top="2" Canvas.Left="10"/>

                            <!--
                    <ContentPresenter Name="con" Content="{TemplateBinding ContentControl.Content}" />
                    <ContentControl Name="DesignerItem"
                                 Canvas.Top="2"
                                Canvas.Left="10"
                                />
                    -->

                </Canvas>

                <ControlTemplate.Resources>
                    <Storyboard x:Key="SelectedStory">

                        <ColorAnimation Storyboard.TargetName="fillb" Storyboard.TargetProperty="(SolidColorBrush.Color)" From="#333333" To="#111111" Duration="0:0:0.1" />

                        <DoubleAnimation Storyboard.TargetName="con" Storyboard.TargetProperty="(Canvas.Left)" From="10" To="30" Duration="0:0:0.1" />
                        <DoubleAnimation Storyboard.TargetName="Path" Storyboard.TargetProperty="(Path.Opacity)" From="0" To="1" Duration="0:0:0.1" />
                        <DoubleAnimation Storyboard.TargetName="Path" Storyboard.TargetProperty="(Canvas.Left)" From="15" To="10" Duration="0:0:0.2" />
                    </Storyboard>

                    <Storyboard x:Key="unSelectedStory">

                        <ColorAnimation  Storyboard.TargetName="fillb" Storyboard.TargetProperty="(SolidColorBrush.Color)" From="#111111" To="#333333" Duration="0:0:0.8" />

                        <DoubleAnimation Storyboard.TargetName="con" Storyboard.TargetProperty="(Canvas.Left)" From="30" To="10" Duration="0:0:0.3" />
                        <DoubleAnimation Storyboard.TargetName="Path" Storyboard.TargetProperty="(Path.Opacity)" From="1" To="0" Duration="0:0:0.1" />
                        <DoubleAnimation Storyboard.TargetName="Path" Storyboard.TargetProperty="(Canvas.Left)" From="10" To="15" Duration="0:0:0.1" />
                    </Storyboard>

                    <Storyboard x:Key="CurrentlySlecetedStory">

                        <ColorAnimation Storyboard.TargetName="fillb" Storyboard.TargetProperty="(SolidColorBrush.Color)" From="#111111" To="#111111" Duration="0:0:0.1" />

                        <DoubleAnimation Storyboard.TargetName="con" Storyboard.TargetProperty="(Canvas.Left)" From="30" To="30" Duration="0:0:0.1" />
                        <DoubleAnimation Storyboard.TargetName="Path" Storyboard.TargetProperty="(Path.Opacity)" From="1" To="1" Duration="0:0:0.1" />
                        <DoubleAnimation Storyboard.TargetName="Path" Storyboard.TargetProperty="(Canvas.Left)" From="10" To="15" Duration="0:0:0.2" />
                    </Storyboard>

                    <SolidColorBrush x:Key="fillb" Color="#333333" />
                </ControlTemplate.Resources>

                <ControlTemplate.Triggers>

                    <MultiTrigger>
                        <MultiTrigger.Conditions>
                            <Condition Property="ListBoxItem.IsMouseOver" Value="True" />
                            <Condition Property="ListBoxItem.IsSelected" Value="True" />
                        </MultiTrigger.Conditions>
                           <MultiTrigger.Setters>
                               <Setter TargetName="ActionsContainer" Property="Visibility" Value="{x:Static Visibility.Visible}"/>
                           </MultiTrigger.Setters>
                    </MultiTrigger>

                    <MultiTrigger>
                        <MultiTrigger.Conditions>
                            <Condition Property="ListBoxItem.IsMouseOver" Value="True" />
                            <Condition Property="ListBoxItem.IsSelected" Value="False" />
                        </MultiTrigger.Conditions>
                        <MultiTrigger.EnterActions>

                            <BeginStoryboard Selector.IsSelected="True"  Storyboard="{StaticResource SelectedStory}">

                            </BeginStoryboard>
                        </MultiTrigger.EnterActions>
                        <MultiTrigger.ExitActions>
                            <BeginStoryboard Storyboard="{StaticResource unSelectedStory}">
                            </BeginStoryboard>
                        </MultiTrigger.ExitActions>
                    </MultiTrigger>

                    <EventTrigger RoutedEvent="ListBoxItem.Selected">
                        <EventTrigger.Actions>
                            <BeginStoryboard  Name="SelectedItemStory" Storyboard="{StaticResource CurrentlySlecetedStory}">

                            </BeginStoryboard>
                        </EventTrigger.Actions>
                    </EventTrigger>

                    <EventTrigger RoutedEvent="ListBoxItem.Unselected">
                        <EventTrigger.Actions>
                           <StopStoryboard BeginStoryboardName="SelectedItemStory" />
                        </EventTrigger.Actions>
                    </EventTrigger>

                </ControlTemplate.Triggers>

            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>

<Style x:Key="lb_ms" TargetType="ListBox">
    <Setter Property="SnapsToDevicePixels" Value="true"/>
    <Setter Property="OverridesDefaultStyle" Value="true"/>
    <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto"/>
    <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
    <Setter Property="ScrollViewer.CanContentScroll" Value="true"/>
    <Setter Property="MinWidth" Value="120"/>
    <Setter Property="MinHeight" Value="95"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="ListBox">
                <Border 
                                          Name="Border" 
                                          Background="#333333"

                                          BorderBrush="{StaticResource SolidBorderBrush}"
                                          BorderThickness="1"
                                          CornerRadius="5">
                    <ScrollViewer 
                                            Margin="0"
                                            Focusable="false">
                        <StackPanel Margin="2" IsItemsHost="True" />
                    </ScrollViewer>
                </Border>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsEnabled" Value="false">
                        <Setter TargetName="Border" Property="Background"
                                                    Value="{StaticResource DisabledBackgroundBrush}" />
                        <Setter TargetName="Border" Property="BorderBrush"
                                                    Value="{StaticResource DisabledBorderBrush}" />
                    </Trigger>
                    <Trigger Property="IsGrouping" Value="true">
                        <Setter Property="ScrollViewer.CanContentScroll" Value="false"/>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-26T15:58:54.913

为了不崩溃，我必须在使用该样式的列表框上添加 SelectionMode="Multiple"，问题是为什么？

# java - 我将如何用 JNA 映射这个 Delphi 函数

> ID：681341
> 
> 赞同：4
> 
> 时间：2009-03-25T12:24:29.460
> 
> 标签：java, delphi, jna

我有以下德尔福功能：

```
function DoX(const InputBuffer: Pointer; const InputBufferSize: longword; OutputBuffer: Pointer; var OutputBufferSize: longword): longbool; 
```

OutputBuffer 和 OutputBufferSize 将在函数中设置为结果的一部分，并返回一个布尔值以指示方法是否成功（InputBuffer 和 OutputBuffer 将是字节数组）。

我已经设法将我需要的一些函数从 dll 映射到 JNA，并且它们工作正常，但是这个给我带来了问题，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T14:47:51.190

大多数 JNA 文档都假定您使用的是 C，而不是 Delphi，因此请从与该函数等效的 C 开始：

```
int DoX(const void* InputBuffer,
        unsigned int InputBufferSize,
        void* OutputBuffer,
        unsigned int* OutputBufferSize); 
```

您还希望获得正确的调用约定。Delphi 的默认值是*register*，这可能不是你想要的。改用*stdcall*；这就是所有其他 DLL 使用的。

Java 没有与您使用的类型等效的无符号类型，因此首先忽略无符号。这`InputBufferSize`使得`int`. 您的函数返回一个布尔结果，因此请使用`boolean`它的返回类型。JNA 支持通过类的后代通过引用传递类型[`ByReference`](https://jna.dev.java.net/javadoc/com/sun/jna/ptr/ByReference.html)，因此请使用[`IntByReference`](https://jna.dev.java.net/javadoc/com/sun/jna/ptr/IntByReference.html)for `OutputBufferSize`。

最后是指针。您说它们是字节数组，所以我很困惑为什么您不在 Delphi 代码中以这种方式声明它们。要么使用`PByte`，要么声明一个新`PByteArray`类型并使用它。（该更改将使实现该功能更加方便。）在 Java 中，尝试将它们声明为字节数组。所以，最终产品：

```
boolean DoX(byte[] InputBuffer,
            int IntputBufferSize,
            byte[] OutputBuffer,
            IntByReference OutputBufferSize); 
```

# asp.net-mvc - How to maintain separate layers in MVC? like Business layer and Security layer

> ID：681353
> 
> 赞同：0
> 
> 时间：2009-03-25T12:26:24.057
> 
> 标签：asp.net-mvc

I am familiar with three layers viz. view model & controller.

Now i want to separate another two layers viz. Security layer & Business logic layer apart from these.

So how do i do this?

Let's say controller is ok but which user have that privilege, is i want to decide in security layer & if it pass this layer it goes to business layer in which complex query will be executed like business rules.

so can any one help me with small code?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T14:29:34.853

The 3 MVC layers are really only applicable from the standpoint of the user interface so the two additional layers that you note are really part of the Model.

In a DDD (Domain Driven Design)-type design, you would have your controllers call out to an application service that would handle checking with the security layer if the action is authorized and then either executing the action against your business layer (i.e. Core Domain Model layer) or returning back an "access denied" type message back to the controller.

Alternatively, instead of using the application service layer, you can just have the controller call directly to the business logic layer which does the security checking internally (calling out to the security layer) but depending on how complex your business logic is, it may be less clear to have it intermixed with your authorization checks to the security layer.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-20T08:58:29.807

MVC Framework is supposed to be a presentation framework.. In a 3 layered architecture, it is the presentation layer.. Now LINQ to SQL is a Data Access Layer, and it should not be at the presentation layer instead it must be at the Business Layer (Service Layer)

This link may help you.. [link text](http://www.adamtibi.net/post/2008/08/23/LINQ-to-SQL-The-Data-Access-Layer-DAL-Shrinker.aspx)

# regex - RegEx数字检查范围？

> ID：681357
> 
> 赞同：12
> 
> 时间：2009-03-25T12:27:31.107
> 
> 标签：regex

我是 StackOverflow 的新手，所以如果有更好的方法来提出以下问题，请告诉我。

我需要创建一个正则表达式来检测数据库中的字段是否为数字，如果是数字，它是否在有效范围内（即 1-50）。我试过`[1-50]`了，除了单个数字前面有 0（即 06）的情况外，它都有效。06 仍应被视为有效数字，因为我稍后可以将其转换为数字。

我真的很感谢你的帮助！我正在尝试了解有关正则表达式的更多信息，并且一直在学习：[www.regular-expressions.info](http://www.regular-expressions.info/)。如果你们有其他网站的建议来了解这些东西，我将不胜感激！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-25T12:31:05.230

试试这个

```
^(0?[1-9])|([1-4][0-9])|(50)$ 
```

这个正则表达式的想法是将问题分解为案例

*   0?[1-9] 处理单个数字的情况，允许可选的前面 0
*   [1-4][0-9] 处理从 10 到 49 的所有数字。这也允许在单个数字上出现前面的 0
*   50 照顾 50

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-25T12:33:45.537

正则表达式适用于字符（在本例中为数字），而不是数字。您需要为模式中的每个数字位数有一个单独的模式，并将它们与 | （OR 运算符）就像其他答案所建议的那样。但是，请考虑使用正则表达式（如`[0-9]+`）检查文本是否为数字，然后转换为整数并检查整数是否在范围内。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T12:35:39.090

您不能轻松地使用正则表达式进行范围检查。您可以通过一些工作开发一种识别数字范围的模式，但它通常非常复杂，并且很难针对稍微不同的范围进行修改。

你最好把它分成两部分。

1.  识别数字模式 ( `^\d+$`)。

2.  在应用程序中检查该数字的范围。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T12:50:59.457

^0?[1-50]{1,2}$

# html - 跨浏览器使用 CSS 样式化链接按钮

> ID：681368
> 
> 赞同：1
> 
> 时间：2009-03-25T12:30:49.443
> 
> 标签：html, css

更新#2：我已经解决了几乎所有的问题，除了一个主要问题。具有相同的结构和 CSS IE7/6 显示每个具有 100% 宽度的容器。我需要这不会发生。除此之外其他一切都很好。任何人都可以启发我吗？

更新：应该看起来像这样

[![替代文字](https://i.stack.imgur.com/HouXG.png)](https://i.stack.imgur.com/HouXG.png)

我有以下 html 页面（详述如下）。它只是从链接中呈现 2 个样式按钮。我的问题是 IE6 和 7 呈现它的方式与 Firefox、Safari、IE8 和 Chrome 不同，它们都正确呈现它。

我已经把头撞到墙上一天了，现在试图让它在 IE6/7 中工作。任何人都可以就我做错了什么提供建议吗？

谢谢

```
<html>
  <head>
    <style>

      .niw-button {
          background:      #1f81c0 url(niw-btn-gradient-normal.png) repeat-x;
          border:          none;
          color:           #fff;
          display:         inline-block;
          font-weight:     bold;
          margin-right:    6px;
          min-width:       95px;
          padding:         2px;
          text-decoration: none;
      }

      .niw-button:hover {
          background: #5e698f url(niw-btn-gradient-hover.png) repeat-x;
      }

      .niw-button > .niw-button-contents {
          border: 1px solid #73b1da;
      }

      .niw-button > .niw-button-contents:hover {
          border: 1px solid #99a1bc;
      }

      .niw-button .niw-button-icon {
          background-position: center;
          background-repeat:   no-repeat;
          float:               right;
          height:              25px;
          width:               27px;
      }

      .niw-button .niw-button-text {
          height:         25px;
          line-height:    1.5em;
          padding-left:   5px;
          padding-right:  27px;
          text-align:     center;
          text-transform: uppercase;
      }

      .right-align {
        float:right;
      }

      .niw-icon-cancel {
          background-image: url(niwater_cancelIcon.png);
      }
    </style>
  </head>
  <body>
    <a class="niw-button right-align" href="#">
      <div class="niw-button-contents">
          <div class="niw-button-icon niw-icon-cancel"></div>
          <div class="niw-button-text">Cancel</div>
      </div>
    </a>
    <a class="niw-button" href="#">
      <div class="niw-button-contents">
          <div class="niw-button-icon niw-icon-cancel"></div>
          <div class="niw-button-text">Cancel</div>
      </div>
    </a>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T12:54:15.097

编辑：现在我理解了你的形象：

只需`<a>`使用 display:block 使您的元素成为块元素，并在其中放置某种跨度来保存图标。或者你可以把整个东西变成一个图像......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T12:39:33.277

IE6/7 不支持`display: inline-block`，IE6 不支持子 ( `parent > child`) 选择器。所以你可能应该看看你的CSS中的那些点......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T12:39:51.560

编辑：我实际上在 IE8 中没有得到正确的渲染，这就是我在下面提到的：

首先，您应该将`<a>`元素放在元素内部，而不是反过来。块级元素不应该真正存在于内联元素中。例如

```
 <div class="niw-button-contents">
      <div class="niw-button-icon niw-icon-cancel"></div>
      <div class="niw-button-text"><a class="niw-button right-align" href="#">Cancel</a></div>
  </div>

  <div class="niw-button-contents">
      <div class="niw-button-icon niw-icon-cancel"></div>
      <div class="niw-button-text"><a class="niw-button" href="#">Cancel</a></div>
  </div> 
```

这为我修复了定位，但随后在样式上有所损失。我还没有修改 CSS 来纠正它，但它应该很简单。其次，你有很多类来处理一个简单的问题。可以说，您应该只需要外部的一个类`div`来识别内部发生的事情，然后您的 CSS 就可以从那里下降。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T12:42:56.653

一般来说，对于按钮/链接问题的资源只有一个提示：

[http://mezzoblue.com/archives/2008/09/17/anchor_butto/](http://mezzoblue.com/archives/2008/09/17/anchor_butto/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T12:42:58.370

我自己其实也很困惑。他们应该怎么看？如果您不让我们知道您打算做什么，则很难解决问题。

# vb.net - 上下文菜单条带宽度

> ID：681371
> 
> 赞同：3
> 
> 时间：2009-03-25T12:31:26.183
> 
> 标签：vb.net, width, dynamic, contextmenustrip

我需要动态更改上下文菜单宽度，默认情况下上下文菜单宽度取决于工具条菜单项的文本长度。

顺便说一句，我真的不想再次重绘控件！！！

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-13T16:45:00.643

您需要将 ContextMenuStrip AutoSize 属性设置为 false。然后，您可以将 Width 属性设置为您想要的任何值。当 AutoSize 设置为 true 时，Width 属性将被忽略并动态计算。

例子：

```
Dim menu As New ContextMenuStrip()
menu.AutoSize = False
menu.Width = 100 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-28T02:46:09.817

无论如何，AutoSize 在猜测“正确”尺寸方面做得非常糟糕。当 TRUE 时，菜单比任何文本需要的要宽得多。

当您手动设置时...您还必须将*HEIGHT*设置为远小于您的预期...如果您希望它显示在正确的大小菜单中。

# javascript - 仅当子模式不匹配时，正则表达式才匹配

> ID：681379
> 
> 赞同：4
> 
> 时间：2009-03-25T12:34:34.380
> 
> 标签：javascript, regex

我正在尝试匹配文件中的 C 样式注释，但前提是注释不以由`@`

例如从

```
/* some comment to match */
/* another comment.
this should match also */
/*@special shouldn't match*/ 
```

这可能只使用正则表达式吗？

我正在尝试使用正则表达式的 JavaScript 实现。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T12:46:40.203

```
/\*\s*(?!@)(?:(?!\*/).)*\*/ 
```

分解为：

```
/\* // "/*"
\s* // 可选空格
(?!@) // 后面没有“@”
(?: // 不捕获...
   (?!\*/)。// ...任何不是“*/”的东西
)* // 但尽可能频繁地匹配它
\*/ // "*/"

```

在“global”和“dotall”模式下使用（例如，点也应该匹配新行）

*通常的警告词：*与使用正则表达式执行的所有解析作业一样，这将在嵌套模式和输入中断时失败。

[emk 指出了一个很好](https://stackoverflow.com/questions/681379/regular-expression-match-only-if-subpattern-doesnt-match/681402#681402)的（否则有效的）输入示例，它将导致此表达式中断。这无济于事，正则表达式不适用于解析。如果您确信这样的事情永远不会在您的输入中发生，那么正则表达式可能仍然适合您。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T12:40:31.933

你可以从这样的事情开始：

```
/\*[^@] 
```

但一般来说，您不会看到将 C 风格的注释与正则表达式匹配，因为有讨厌的极端情况。考虑：

```
"foo\" /* " " */ " 
```

该代码中没有注释（它是两个字符串文字的编译时连接），但是如果没有真正的解析器，您将不会有太多的运气来解析它。（从技术上讲，你*可以*使用正则表达式，因为你只需要一个简单的有限状态机。但这是一个非常恶心的正则表达式。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T04:10:34.483

使用负前瞻

# asp.net - 如何使用 ASP.NET 和 JKS 证书访问第三方组件？

> ID：681385
> 
> 赞同：3
> 
> 时间：2009-03-25T12:35:53.893
> 
> 标签：asp.net, web-services, security, ssl, jks

我需要访问需要 JKS 证书（我有）的第三方应用程序。

我的客户端应用程序是 ASP.NET 的。我该怎么做？

（我本来想提供更多信息，但不幸的是我没有！）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-09T09:42:10.607

首先，将证书导入到 windows 证书存储区。看看[http://tjworld.net/software/codesigning/JKS2PFX.html](http://tjworld.net/software/codesigning/JKS2PFX.html)。如果您需要从 aspnet 帐户使用它，您可能更愿意将其导入到机器商店（而不是您的帐户证书商店）。使用 MMC，证书插件来检查它。

然后在您的应用程序中使用此证书。在大多数情况下，您将通过其“DN=....”属性（您也将在 MMC 中看到）来选择它。

HTH，托马斯

# sql - MySQL：多个分组

> ID：681408
> 
> 赞同：0
> 
> 时间：2009-03-25T12:42:29.493
> 
> 标签：sql, mysql, group-by

**所以我有一个名为items**的示例表，其中包含以下列：

*   **item_id** (int)
*   **person_id** (int)
*   **item_name** (varchar)
*   **item_type** (varchar) - 示例：“新闻”、“事件”、“文档”
*   **item_date**（日期时间）

...以及具有以下列的**人员表：“person_id”、“person_name”。**

我希望**在每个 item_type 的给定时间段内显示前 2 个提交者的列表（+ 提交的项目的 COUNT()）**。这基本上是我希望 MySQL 输出的样子：

```
person_name  | item_type | item_count

Steve Jobs   | document  | 11
Bill Gates   | document  | 6
John Doe     | event     | 4
John Smith   | event     | 2
Bill Jones   | news      | 24
Bill Nye     | news      | 21 
```

如果不对每个 item_type 进行单独的查询，这怎么可能？提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T12:49:05.500

```
SELECT  item_type, person_name, item_count
FROM    (
        SELECT  item_type, person_name, item_count,
                @r := IFNULL(@r, 0) + 1 AS rc,
                CASE WHEN @_item_type IS NULL OR @_item_type <> item_type THEN @r := 0 ELSE 1 END,
                @_item_type := item_type,
        FROM    (
                SELECT  @r := 0,
                        @_item_type := NULL
                ) vars,
                (
                SELECT  item_type, person_name, COUNT(*) AS item_count
                FROM    items
                GROUP BY
                        item_type, person_name
                ORDER BY
                        item_type, person_name, item_count DESC
                ) vo
        ) voi
WHERE   rc < 3 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T13:15:40.727

我认为应该这样做：

```
SELECT person_name,item_type,count(item_id) AS item_count
FROM person
LEFT JOIN items USING person_id
GROUP BY person_id 
```

但是，“item_type”列会很狡猾，每一行代表多个项目，而您只显示其中一个项目的 item_type。您可以使用“GROUP_CONCAT”列出所有这些，这很有趣。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T13:17:51.937

像这样的东西应该工作：

```
SELECT
  p.person_name, i.item_type, COUNT(1) AS item_count
FROM
  person p
  LEFT JOIN item i
    ON p.person_id = i.person_id
GROUP BY
  p.person_id,
  i.item_type
HAVING
  COUNT(1) >= (
    SELECT
      COUNT(1)
    FROM
      item i2
    WHERE
      i2.item_type = i.item_type
    GROUP BY
      i2.person_id
    LIMIT 1,1
  ) 
```

# c# - 带有“this”的构造函数链接

> ID：681410
> 
> 赞同：4
> 
> 时间：2009-03-25T12:42:30.523
> 
> 标签：c#, c#-3.0

为什么 ClassA 中的第一个构造函数会导致编译器错误 'cannot use "this" in member intializer'？

...或者我怎样才能让它工作？

谢谢

```
public sealed class ClassA : IMethodA
{
    private readonly IMethodA _methodA;

    public ClassA():this(this)
    {}

    public ClassA(IMethodA methodA)
    {
        _methodA = methodA;
    }

    public void Run(int i)
    {
        _methodA.MethodA(i);
    }

    public void MethodA(int i)
    {
        Console.WriteLine(i.ToString());
    }
}

public interface IMethodA
{
    void MethodA(int i);
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-25T12:46:50.997

您可以使用该`this(...)`语法在同一级别调用另一个构造函数 - 但是，您不能`this`在此上下文中使用（当前实例）。

这里最简单的选择是复制分配代码 ( `_methodA = methodA`)。

另一种选择可能是空合并：

```
public ClassA():this(null)
{}

public ClassA(IMethodA methodA) 
{ // defaults to "this" if null
    _methodA = methodA ?? this;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T12:47:17.050

这在 C# 规范的第 10.11.1 节中提到

> 实例构造函数初始化程序无法访问正在创建的实例。因此，在构造函数初始化程序的参数表达式中引用 this 是编译时错误，就像参数表达式通过简单名称引用任何实例成员一样，也是编译时错误。

没有办法让它与实例构造函数一起工作，因为无法访问它。您可以做的是将构造函数设为私有，创建一个初始化方法和一个静态构造函数。

```
public sealed class ClassA : IMethodA {    
  private ClassA() { }
  private void Initialize(IMethodA param) { ... }
  public static ClassA Create() {
    var v1 = new ClassA();
    v1.Initialize(v1);
    return v1;
  }
  public static ClassA Create(IMethodA param) {
    var v1 = new ClassA();
    v1.Initialize(param);
    return v1;
  }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T12:47:24.770

您试图在构造对象之前传递它。尽管在这种情况下编译器可以做一些明智的事情，但一般来说这是行不通的。

如果您这样做，您的实际示例将有效：

```
 public ClassA()
  {
    _methodA = this; 
  } 
```

但是你可能想分享更多的逻辑，所以只需使用一个函数。

```
 public ClassA()
  {
    SetStuff(); 
    _methodA = this; 
  }

  public ClassA(IMethodA methodA)
  {
    SetStuff(); 
    _methodA = methodA;
  } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T12:50:56.510

在链接构造函数时不能使用`this`关键字，本质上是因为`this`引用了一个尚未实例化的对象（对象的创建在进入某些（顶级或基础）构造函数块之前不会开始）。此外，您究竟为什么要这样做？`this`当您在任何地方都可以访问关键字时，这似乎毫无意义。

我建议简单地使用独立的构造函数：

```
public sealed class ClassA : IMethodA
{
    private readonly IMethodA _methodA;

    public ClassA()
    {
        _methodA = this;
    }

    public ClassA(IMethodA methodA)
    {
        _methodA = methodA;
    }
} 
```

也许我误解了您要做什么，但希望这会为您解决问题。

# flash - 将字符串传递给循环中的函数

> ID：681416
> 
> 赞同：0
> 
> 时间：2009-03-25T12:43:47.743
> 
> 标签：flash, actionscript, function, actionscript-2, for-loop

我有这个代码在翻转、推出和发布时激活。i 用于翻转和推出的功能有效，但释放功能不起作用。我正在尝试将一些带有 url 的字符串传递给循环内的函数。

```
var url1:String = "http://www.google.com";
var url2:String = "http://www.google.com";
var url3:String = "http://www.google.com";
var url4:String = "http://www.google.com";
var url5:String = "http://www.google.com";
var url6:String = "http://www.google.com";
var url7:String = "http://www.google.com";
var url8:String = "http://www.google.com";
var url9:String = "http://www.google.com";
var url10:String = "http://www.google.com";
var url11:String = "http://www.google.com";
var url12:String = "http://www.google.com";

function SetMouseAction(buttonMC, arrowMC, dynamicTF, linkURL):Void {
    trace(linkURL);
    buttonMC.colorText = dynamicTF;
    buttonMC.onRollOver = function() {
        TweenLite.to(arrowMC,0.5,{_x:"2", _alpha:50, ease:Back.easeOut});
        this.colorText.textColor = 0x7cb0b7;
    };
    buttonMC.onRollOut = function() {
        TweenLite.to(arrowMC,0.5,{_x:37, _alpha:100, ease:Back.easeOut});
        this.colorText.textColor = 0xffffff;
    };
    buttonMC.onRelease = function() {
        if (linkURL) {
            getURL(linkURL);
        }
    };
}

for (var i:Number = 1; i<=12; i++) {
    SetMouseAction(this["link"+i],this["arrow"+i],this["text"+i],url+1);
} 
```

我有一种强烈的感觉，for循环中的**url+1**是错误的，但我不知道该怎么做。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T12:52:06.197

更改`url+1`为 `this["url"+i]`

这将使此代码正常工作。但是，您确实应该考虑使用一个名为 url 的数组，其中包含 12 个元素，而不是创建 12 个单独的变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T13:06:06.927

```
var urls:Array = new Array();
urls.push("http://link1");
...
urls.push("http://link12");

function SetMouseAction(buttonMC, arrowMC, dynamicTF, linkURL):Void {
...
}

for (var i:Number = 1; i<=12; i++) {
    SetMouseAction(this["link"+i],this["arrow"+i],this["text"+i],urls[i]);
} 
```

确保 Array urls 至少有 12 个元素，否则你会得到一个 index out of bounds 错误。

*稍后编辑：*如果您需要从 flashvars 中提取 url，只需使用“，”之类的分隔符并使用所有 url 定义一个字符串，如下所示：`urlVars=url1,url2,url3,...,url12`

然后为了提​​取 url 并将它们推送到数组中，您使用 split 函数：

```
var urls:Array = new Array();
for (var i=0; i<urlVars.split(",").length; i++) urls.push(urlVars.split(",")[i]); 
```

# regex - 正则表达式不返回 2 组

> ID：681417
> 
> 赞同：1
> 
> 时间：2009-03-25T12:45:24.790
> 
> 标签：regex

我的正则表达式有点麻烦，想知道是否有人可以说明该怎么做。

基本上，我有这个正则表达式：

```
\[(link='\d+') (type='\w+')](.*|)\[/link] 
```

例如，当我将字符串传递给它时：

```
[link='8' type='gig']Blur[/link] 正在播放 [link='19' type='venue']海德公园[/link]” 

```

它只返回从开始`[link]`标签到最后一个`[/link]`标签的单个匹配项。

我只是想知道是否有人可以帮助我在我的`(.*|)`部分中放置什么，以便一次只选择一个`[link][/link]`部分。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T12:52:45.710

您需要使用“？”使通配符选择变得不贪婪。操作员。我做到了：

```
/\[(link='\d+')\s+(type='\w+')\](.*?)\[\/link\]/ 
```

*当然，这一切都适用于任何类型的嵌套，在这种情况下，语言不再是常规的并且正则表达式不适合 - 找到一个解析器*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T12:52:36.943

正则表达式信息 a 是一个很棒的网站。[这个页面](http://www.regular-expressions.info/examples.html)给出了一个处理html标签的例子。还有一个[Eclipse 插件](http://regex-util.sourceforge.net/)，可让您开发表达式并实时查看匹配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T12:53:10.857

您需要使正则表达式中间的 .* 不贪心。在您喜欢的正则表达式中查找非贪婪模式的语法和/或标志。

# c# - Reporting Services 2005: ReportExecution2005.asmx returns with 401 Access Denied when called from a RenderingExtension

> ID：681425
> 
> 赞同：0
> 
> 时间：2009-03-25T12:48:21.773
> 
> 标签：c#, sql-server-2005, web-services, iis

I've got a rendering extension for reporting services which uses the ReportExecution2005.asmx service to execute a number of "subreports" and then puts the results in a powerpoint presentation.

A typical usage scenario would be to go to the Report Manager, select my "Powerpoint" report, which is used only as a placeholder for parameters to be passed to the "subreports". I then select my extension from the list of export formats and click Export, which runs the extension and it gives me back my pptx file.

This works fine on both our live and test servers. But I've run into a very weird problem trying to set up another test server.

Any call made by the extension to the webservice returns with "401 Access Denied" (no further substatus information available).

Things I've tried without success: - allow physical access to the folder structure of the ReportServer virtual directory to everyone. And I mean literally everyone - ASPNET, NETWORK SERVICE, Everyone, the account I usually use to log in, which is an admin and owner of the folder - use reporting manager to set up the security on the reporting services side. Again, every conceivable user/group account which could be involved was given every conceivable role. - allow anonymous access to the ReportServer web app. - enabled impersonation on the ReportServer web app. - hardcoded the user credentials to use when calling the webservice (by default it just uses System.Net.CredentialCache.DefaultCredentials)

I also made a little test website which consumes the ReportExecution service in exactly the same way as the RenderingExtension, and from the website, the web server authenticates fine and allows me to call the web service, so obviously the problem doesn't lie with the web service security setup itself.

Starting to pull my hair out. As a last resort, I'm about to reinstal Reporting Services, but in the mean time (or if that doesn't help) - if anyone has encountered something similar, I'd greatly appreciate any input.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T17:02:31.080

在迁移名为 ReportExecution2005 Web 服务的 ASP.NET 项目时，我看到了类似的行为。在我的本地机器上运行时，一切正常。当我将它迁移到我们的开发服务器时，我开始收到 401 错误。在我们的例子中，需要在开发服务器上配置 Kerberos 以将凭据委托给 SSRS 框。

您可能想要验证新服务器是否会将其凭据委托给 SSRS 机器，看看这是否有任何不同。

希望这可以帮助，

账单

# deployment - 我可以更改专有战争文件吗？

> ID：681427
> 
> 赞同：0
> 
> 时间：2009-03-25T12:48:56.170
> 
> 标签：deployment, jar, war

我有一个专有应用程序，它的战争文件可供我们使用。我基本上需要在当前应用程序中添加一个 jsp 页面。我在想我会写独立的jsp，java文件构建一个war并将它添加到专有的war文件中。

或者

我将编写 jsp、java 文件并将其添加到同一个战争中。

我可以进行一场新的战争并让所有权进行互动吗？哪个选项更好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T12:56:45.857

我想你可以解开战争，然后添加你的jsp。之后，重新构建war文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T04:15:25.990

是的。只需解压战争并添加您的自定义内容。您的库位于 WEB-INF/lib 中，您的类位于 WEB-INF/classes 中。您还可以根据需要将 servlet、过滤器和侦听器添加到 web.xml。

# jquery - 带有textareas的jQuery maxlength属性问题

> ID：681434
> 
> 赞同：4
> 
> 时间：2009-03-25T12:51:07.367
> 
> 标签：jquery, attributes, maxlength, rel

使用 jQuery 版本 1.2.3，我尝试在具有属性“maxlength”的 textarea 元素之后添加节点，但它不起作用：

`$("textarea[@maxlength]").after("<b>Aint working</b>");`

这是 HTML 代码：

`<textarea maxlength="500">This is a test.</textarea>`
`<textarea maxlength="250">Yet another line.</textarea>`
`<textarea maxlength="125">Bar or foo, whatever.</textarea>`

奇怪的是，如果我`maxlength`用 eg更改属性，`rel`它就可以正常工作！

看看这个现实生活中的例子： http: [//www.host2000.be/_temp/jquery_tests_counter.html](http://www.host2000.be/_temp/jquery_tests_counter.html)

PS：我知道 jQuery 1.3 不再支持 [@attribute] 表示法，但这与问题无关。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T13:05:54.103

在黑暗中射击：可能是因为 maxlength 不是[textareas 的有效属性](http://www.w3schools.com/tags/tag_textarea.asp)。

编辑：我刚刚用 jQuery 1.3 尝试了你的示例并删除了@，它完美地工作。

编辑#2：使用 jQuery 1.2.6 它也可以在没有@...的情况下工作...你试过删除它们吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T13:15:15.110

使用您的 jQuery 版本，它只需要一点技巧即可。textarea 的隐含值对于不同的浏览器有不同的值。例如，Firefox 的隐含值为 -1。

因此，为了让您的脚本在 Firefox 上运行，您需要执行以下操作：

```
$("textarea[@maxlength!=-1]").after("<b>Aint working</b>"); 
```

[在这里](http://herr-schuessler.de/blog/selecting-input-fields-with-maxlength-via-jquery/)`maxlength`您可以找到有关属性的隐式值的更多信息。

享受！

# .net - 确定 System.DateTime 是否为午夜的最佳方法是什么？

> ID：681435
> 
> 赞同：28
> 
> 时间：2009-03-25T12:51:25.683
> 
> 标签：.net

似乎有几种可能的方法可以确定给定的 System.DateTime 是否代表午夜。各自的优缺点是什么？一个比其他的更易读或性能更好吗？

编辑：我相信可读性比性能更重要，直到分析表明存在问题。这就是我问这两个问题的原因。

示例 1

```
Public Function IsMidnight(ByVal value As Date) As Boolean
    Return value.TimeOfDay = TimeSpan.FromHours(0)
End Function 
```

示例 2

```
Public Function IsMidnight(ByVal value As Date) As Boolean
    Return value.CompareTo(value.[Date]) = 0
End Function 
```

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-03-25T12:54:37.077

我会检查（以 C# 为例）：

```
bool isMidnight = value.TimeOfDay.Ticks == 0; 
```

IMO，这比使用`FromHours`etc 更容易，并且不涉及任何额外的乘法（因为`Ticks` *定义*了`TimeSpan`- 所有其他属性都已计算）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-25T12:56:22.440

这有点微优化，任何一种方法都可以正常工作。

无论如何，我认为这是表现最好的：

```
Public Function IsMidnight(ByVal value As Date) As Boolean
   Return value.TimeOfDay.Ticks = 0
End Function 
```

如果您想要可理解的代码，也许这是最好的：

```
Public Function IsMidnight(ByVal value As Date) As Boolean
   Return value.TimeOfDay = TimeSpan.Zero
End Function 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-25T12:53:47.597

依靠。你想检查午夜到第二个，还是只是它是午夜？

午夜时分

```
Public Function IsMidnightHour(ByVal date as Date) As Boolean
  return date.Hour = 0
End Function 
```

午夜时分

```
Public Function IsMidnightHourAndMinute(ByVal date as Date) As Boolean
  return date.Hour = 0 AndAlso date.Minute = 0
End Function 
```

纯粹为了简单，正好是午夜，您可以使用您的示例。但是，这将包括高达毫秒的检查，这可能不是您想要的。

# internet-explorer-6 - 为什么 Internet Explorer 6 在某些组织中仍然是企业的最爱？

> ID：681440
> 
> 赞同：1
> 
> 时间：2009-03-25T12:53:46.067
> 
> 标签：internet-explorer-6

... 或者

如何说服我的组织放弃 Internet Explorer 6？

在开发 Web 应用程序时必须保持 Internet Explorer 6 的兼容性是一场噩梦——但在我的客户决定放弃它作为官方浏览器之前，我一直坚持下去。我试图说服我们的系统管理员进行更改。我已经看到一长串反对在任何环境中使用 Internet Explorer 6 的论点，并且我试图预测他们的论点会遭到反驳。到目前为止，我在 Internet Explorer 6 中看到的唯一明显优势是：

1.  通过组策略进行集中管理
2.  旧版应用程序兼容性

Internet Explorer 7 或更高版本 (AFAIK) 解决了这两个问题。

Internet Explorer 6 是否有任何 Internet Explorer 7 或更高版本尚未解决的优势？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T13:04:16.760

Internet Explorer 6 已经存在很长时间了，绝大多数网站和 Web 应用程序都可以正常使用它。

为了更改为不同的浏览器（顺便说一句，可能是 Internet Explorer 7），您首先需要进行成本效益分析，以向每个老板证明这一决定的合理性。

一个非常高级的总结：

成本：

*   测试所有 Web 应用程序。
*   检查所有第三方网站是否在新浏览器中实际运行。
*   检查所有其他软件，看看是否存在迁移到新浏览器的任何潜在问题。

好处：

*   多标签？

老实说，我看不到这种情况发生，除非公司正在定期进行桌面更新。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T13:08:57.917

我不会完全称它为任何组织中的“最爱”。在我看来，只是大公司认为将每个人都升级到 IE7（或者实际上是最近发布的 IE8）是一项巨大的努力。许多高管似乎认为这是一个收益与成本的决策，答案很简单，即它对业务无关紧要。如果没有设置系统来自动升级网络上的（可能是大量的）计算机，这在许多情况下甚至可能是事实。许多人（包括我自己）会争辩说，对于任何企业来说，拥有一个相当不错的浏览器（即 IE7 及更高版本、Firefox 或 Safari）都是值得的。IE8刚刚发布，这使得IE6已经过时了*两个*版本肯定会鼓励公司开始升级。这里的问题是，只要 IE6 有很大的市场份额，绝大多数网页设计师都会继续设计与 IE6 兼容的网站，不管它作为浏览器的劣势。最后，如果您真的热衷于让每个人都从 IE6 升级，我应该向您指出[停止生活在过去的](http://www.stoplivinginthepast.com/)网站。也许如果你在你的组织内进行了足够强烈的宣传，你可能只会说服做出升级决定的人，尽管我不想打赌……

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T13:10:11.487

如果 IE 做了它应该做的事情，为什么还要麻烦改变：浏览互联网。新浏览器的所谓好处，对我们来说实际上意味着什么，在运行您描述的公司环境的人的心目中几乎没有价值。

换句话说：无知和/或冷漠

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-25T12:58:51.467

除非他们找到任何强有力的商业案例或优势，否则我认为公司不会同意花时间进行升级。有什么用？Internet Explorer 6 也比新版本快一点，商业用户（他们不关心版本，只要它能工作）可能会抱怨。

如果您是开发人员，那么您有理由安装所有/最新的浏览器。

我认为我的是唯一使用 Internet Explorer 6 的 ;-)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-25T13:07:00.123

从 IE6 转换是一个痛苦的过程，因为他们必须将它应用到公司的每一台计算机上。根据员工的数量，这将成为后勤方面的噩梦。

此外，他们通常会使用默认安装的用于新计算机的操作系统的任何浏览器。

更改默认程序会带来未知风险，而切换的好处必须超过该风险。目前，尝试升级每台计算机的麻烦可能超过了拥有更好浏览器的便利，尤其是当大多数用户不会利用任何新功能时。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-25T13:09:24.437

实际上，我们的 Intranet 上有一堆遗留应用程序，有些是内部编写的，有些是我们花了很多钱购买的，它们在 IE7（或 IE8，或 Firefox，或 Safari，或...）上运行不佳

是的，水星，我在看着你……

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-25T13:09:37.777

IE6 的市场份额正在迅速下降，所以我预计在一年左右的时间里，AJAX UI 库的作者将停止针对 IE6 进行测试（就像现在他们不针对 IE5.5 进行测试一样）。当这种情况发生时，企业将别无选择，只能适应。

# flash - 是否有针对某处为社交网站编写的应用程序的技术限制摘要？

> ID：681442
> 
> 赞同：0
> 
> 时间：2009-03-25T12:53:49.513
> 
> 标签：flash, facebook, social-networking, myspace

我正在开发一个针对 Facebook、MySpace 以及其他可能的小部件，可能是在 Flash 中。有人看过不同站点的技术限制摘要吗？

有人告诉我，FB 不允许嵌入的 swfs 链接到外部站点，并且 MS 不允许 JS。不过，这听起来有点模糊和粗略。我显然可以查看每个站点的 API，或者构建一些测试应用程序，但也许有人编写了一个列表。（谷歌没有帮助。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T08:39:39.533

不幸的是，这些平台中的每一个都经常更改并施加独特的，有时甚至是复杂的限制。

我不知道有任何文档讨论了各个平台的限制，而且无论如何这些文档可能很快就会过时。

了解预期限制的最佳方式可能是了解所涉及的安全问题。例如，MySpace 不允许小部件运行 javascript，因为它会在用户的安全 myspace 会话的上下文中运行。Blogger 允许使用 javascript，因为每个博客都在一个子域上，而 javascript 无法访问根域。Facebook 允许使用经过仔细清理的自定义版本的 javascript，以防止应用程序劫持用户的会话。

了解可以做什么的最快方法可能是在每个站点上试用这些小部件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-26T13:51:46.363

您可以在 Facebook 应用程序中使用 Flash。很多人做

[https://developers.facebook.com/docs/guides/canvas/](https://developers.facebook.com/docs/guides/canvas/)

# c# - Writing c# source code to files

> ID：681446
> 
> 赞同：4
> 
> 时间：2009-03-25T12:54:42.587
> 
> 标签：c#, encoding

I'm having a stupid problem. I'm reading some .cs files from disk. Doing lots of regex and other operations on them with a .net program i've made. Then write them back to disc.

The resulting files get the wrong encoding somehow. What encoding are c# source files? And then there is the first byte-order thing, is that needed? Does it get written when i use File.WriteAllText()?

The program changing the files is a simple .net application, and the code is simply

```
string text = System.IO.File.ReadAllText(fn);
string newText = Regex.Replace(text, regexStr, replaceStr);
System.IO.File.WriteAllText(fn, newText); 
```

The c# files have comments and strings don't seem to be part of the standard codepage.

One of the problematic characters is "ä"

**Solution:**

this seems to work correctly

```
string text = System.IO.File.ReadAllText(fn, Encoding.GetEncoding(1252));
string newText = Regex.Replace(text, regexStr, replaceStr);
System.IO.File.WriteAllText(fn, newText, Encoding.GetEncoding(1252)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-03T14:56:28.960

`System.IO.File.ReadAllText(fn)`尝试猜测输入文件的编码。这可能会大错特错。

Visual Studio 2008 默认以 UTF-8 创建文件。同样，您应该尽可能地尝试使用 UTF-8，方法是指定`Encoding.UTF8Encoding`何时将文件写入磁盘。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T13:04:39.597

By default the files should be encoded with the same code page that is set in the regional settings of the machine. By default this will be 'Unicode (UTF-8 with signature) - Codepage 65001' you can use any code page you wish, for example you could also use 'Western European (windows) - Codepage 1252'.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T13:03:57.960

I've written a few code gens in my time and always used ASCII encoding (plain windows text). What language are you using to do the regex ops on the CS files?

# .net - 自定义类的数据绑定

> ID：681454
> 
> 赞同：0
> 
> 时间：2009-03-25T12:57:17.557
> 
> 标签：.net, interface

我正在尝试创建一个基于 XML 文件的自定义类（使用 xsd.exe）。此类的最终目标是将其绑定到 UI 元素（可能是 gridview 或类似的东西 - 我还没有决定）。为了做到这一点，我需要确保实现任何接口吗？我认为 IEnumerable 将是一个关键，但我不能确定。

有什么想法吗？

编辑：抱歉，目标部署是 ASP.NET 3.5

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T13:12:36.707

由于您在 ASP.Net 中的基本内容是实现 IEnumerable，因此您可以绑定到[POCO](http://en.wikipedia.org/wiki/Plain_Old_CLR_Object)上的任何属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T13:16:11.287

您的对象不需要任何特殊接口。在 ASP.NET 中，您没有两个定向绑定。

你想将你的控件绑定到一个列表实现 IEnumerable。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T13:59:24.037

如果要使用 XSD.exe 生成类，可以使用 /edb 开关，数据绑定代码将自动生成。

免责声明：我只在一个快速测试项目中使用过它，但从未走得更远。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T13:00:08.110

赢表格？WPF？

在 Winform 中，IBindingList 是网格对象列表的重要意义之一。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T13:10:22.173

就像 Quarrelsome 所说，如果这个自定义类是一个集合，那么将需要 IBindingList。对于其他类，INotifyPropertyChange 很有用，因为通过代码对对象所做的任何更改（例如单击按钮时清除字段）都会自动更新 UI。如果您使用 WPF，您可以将 DependencyProperties 添加到您的类并绑定到那些，我很确定这将摆脱对 INotifyPropertyChanged 的​​需要。如果您使用 ASP.NET，则无法使用 INotifyPropertyChange。我想给出一个具体的答案，但除非我知道你将使用的 UI 技术（WPF、WinForms、ASP.NET Web 表单、ASP.NET MVC、Silverlight），否则我只需要介绍基础知识。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T13:15:59.727

`ICustomTypeDescriptor`

# c# - C#：列表添加对象初始化器

> ID：681456
> 
> 赞同：0
> 
> 时间：2009-03-25T12:58:32.297
> 
> 标签：c#, initialization

假设我有这门课：

```
class MyList<T>
{

} 
```

我必须对该课程做些什么，才能使以下事情成为可能：

```
var list = new MyList<int> {1, 2, 3, 4}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T13:01:12.147

有一个 Add 方法并实现 IEnumerable。

```
class MyList<T> : IEnumerable
{
  public void Add(T t)
  {

  }

  public IEnumerator GetEnumerator()
  {
    //...
  }
}

public void T()
{
  MyList<int> a = new MyList<int>{1,2,3};
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T13:02:02.927

在 MyList 上实现 ICollection 将使初始化器语法工作

```
class MyList<T> : ICollection<T>
{
} 
```

虽然最低限度是：

```
public class myList<T> : IEnumerable<T>
{
    public void Add(T val)
    {
    }

    public IEnumerator<T> GetEnumerator()
    {
    }

    System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator()
    {
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T13:18:03.807

```
ICollection<T> is also good. 
```

# c# - 为 C# 属性设置器中的 ArgumentException 分配给“paramName”参数的值？

> ID：681459
> 
> 赞同：11
> 
> 时间：2009-03-25T12:58:55.460
> 
> 标签：c#, exception, naming-conventions

如果将无效值传递给属性设置器并`ArgumentException`抛出（或可能从它派生的类），则应为`paramName`参数分配什么值？

`value`，既然它看起来是实际的论点？

传递属性的名称不是更清楚吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-25T13:01:46.763

ArgumentExceptions 包含无效参数的名称。对于属性设置器，实际参数被命名为值（在源代码和生成的代码中）。使用此名称更一致。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-25T13:39:51.713

在广泛使用 Reflector（试图找到具有可写属性的 CLR 对象）之后，我找到的第一个（FileStream.Position）使用“值”作为参数名称：

```
if (value < 0L)
{
    throw new ArgumentOutOfRangeException("value", 
                 Environment.GetResourceString("NeedNonNegNum"));
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T13:01:26.937

是的，传递属性名称会更清楚。

# java - Using an enum as a mapkey results in a RAW in the database

> ID：681462
> 
> 赞同：3
> 
> 时间：2009-03-25T13:00:05.660
> 
> 标签：java, hibernate, enums, map

I'm trying to use an enum as a mapkey for a map in Hibernate, but Hibernate stores my enum as a RAW:

I have this enum:

```
public enum AccountType implements Serializable {
    CASH,
    CREDIT_CARD,
    GIRO,
    INVOICE,
    OTHER;
} 
```

Which I'm trying to use as a key in a map:

```
@CollectionOfElements
@MapKey(columns =  @Column(name="ACC_TYPE"), 
  targetElement = AccountType.class)
@Column(name="ACCOUNT_NO")
public Map<AccountType, String> getAccounts() {
  return accountMap;
} 
```

What happens here is that Hibernate stores the enum as a raw in the database instead of a varchar:

```
"Column Name"   "Data Type" 
"COMPANY_ID"    "NUMBER(19,0)"
"ACC_TYPE"      "RAW"   
"ACCOUNT_NO"    "VARCHAR2(255 CHAR)" 
```

I want this to be stored as a varchar. I've tried to add @Enumerated(value = EnumType.STRING), but it looks like that doesn't work on the mapkey.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T16:42:55.337

您可以尝试为枚举映射定义 Hibernate UserType。这将允许您指定要在 DDL 中使用的 db 列类型。

见[https://www.hibernate.org/265.html](https://www.hibernate.org/265.html)

HTH 汤姆

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-10-18T15:15:05.117

有 @MapKeyEnumerated JPA 注释，但从 Hibernate 核心 3.6.5 开始，它似乎对更改生成的 DDL 类型没有太大作用。我仍然看到原始的:(

# .net - Expression 是一个值，因此不能作为赋值的目标

> ID：681464
> 
> 赞同：2
> 
> 时间：2009-03-25T13:00:19.793
> 
> 标签：.net, struct

今天我在使用结构时遇到了一个让我措手不及的问题，我希望有人可以为我解释一下。

我有一个这样定义的结构：

```
public struct PaymentDetail
{
    public Decimal Amount{get;set;}
    public string CheckNumber{get;set;}
    public PaymentType PaymentType{get;set;}
} 
```

我有一个包含此信息的课程

```
public class Transaction
{
    public PaymentDetail Payment{get;}
} 
```

我有一个演示模型，我想在其中设置这样的基础属性

```
public class ViewModel
{
    public Decimal Amount
    {
        get{return _Transaction.PaymentDetail.Amount;}
        set
        {
             //This is the offending line of code
             _Transaction.PaymentDetail.Amount = value;
             RaisePropertyChanged("Amount");
        }
    }
} 
```

奇怪的是，如果我将 Payment 属性更改为这样的公共字段，我可以完成这项工作：

```
public class Transaction
{
    public PaymentDetail Payment;
} 
```

显然有一些我不了解导致这种情况的结构。这是一个坏主意吗？有没有更好的办法？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T13:02:47.650

首先 - 没有可变结构（即，您可以在构造后通过设置器等更改值的结构）。这是造成混乱的主要原因。

重点是; 当你调用一个属性（比如`Payment`）时，你会得到一个值的**副本**（在你的本地堆栈区域中）。对于一个类，这是参考的副本（没问题）。对于结构，它是结构本身的副本。对该值的任何更改都将被丢弃，因此编译器已阻止您丢失数据。

当它是一个公共字段时，您正在直接改变原始值，这就是它不介意的原因。但是变异结构确实不是一个好主意。

上课`PaymentDetail`；这是正确的解决方案......

在 .NET 中，结构不是“没有行为的对象”——它们是“值类型”。诸如“货币/价值对”、“时间范围”等内容可能会构成有效的结构 - 但不是`PaymentDetail`.

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2009-03-25T13:08:56.107

这可能是因为您将 Payment 公开为只读，而不是 setter。由于结构是值类型，因此如果结构是只读的，则不允许您在结构上设置属性。

添加一个setter应该可以解决这个问题。

我还会考虑将 PaymentDetail 更改为一个类。我只在结构是非常基本的值时才使用它。像这样具有三个属性的东西，特别是如果一个是字符串，应该是一个类。

# sql - 以编程方式将 sql 文件转换为嵌入式资源

> ID：681465
> 
> 赞同：1
> 
> 时间：2009-03-25T13:01:03.520
> 
> 标签：sql, visual-studio-2008, installation, embedded-resource

有谁知道如何在运行时将 .sql（脚本文件）VS2008 转换为嵌入式资源，以便在海关操作编辑器中用于安装数据库。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-26T03:24:53.133

在 Visual Studio 解决方案资源管理器中，右键单击该文件，然后选择属性...，然后将生成属性设置为 EmbeddedResource。然后，您的安装程序组件应该能够使用程序集的 GetManifestResourceStream 方法读取 Stream。

# c# - 正则表达式量词中的反向引用

> ID：681474
> 
> 赞同：2
> 
> 时间：2009-03-25T13:01:52.303
> 
> 标签：c#, regex

我有一个字符串，其中包含一个长度为以下字段的标题。

例子：

```
fillerfillerCA20 abcdefghijklmnopqrst CA5 zyxwvfillerfiller 
```

我需要找到这两个值：abcdefghijklmnopqrst 和 zyxwv

我打算使用反向引用来获取量词的长度：

```
(?i)ca(?<length>\d+?)\x20.{\k<length>}\x20? 
```

但显然，不支持在量词中使用反向引用。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T13:05:32.170

不是一步到位。正则表达式不能是自引用的。它们首先被构建，然后被使用。一旦构建了正则表达式，就不可能重新构建/扩充。

您可以像已经做的那样匹配长度信息，并在第二步中使用它，同时评估匹配项。

先发制人的评论：我知道一个人可以`"(.)\1"`匹配同一个字符两次。不过，这不是我所说的“自我参照”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T15:20:50.643

更好地构建解析器：查找 的位置`CA`，读取以下数字字符，然后按照数字值的描述读取下一个*x字符。*

# asp.net - asp.net 动态数据限制在哪里？

> ID：681480
> 
> 赞同：3
> 
> 时间：2009-03-25T13:03:52.297
> 
> 标签：asp.net, dynamic-data

asp.net动态数据有哪些限制？
在动态数据中什么是不可能的，所以你必须使用 Web 表单？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T14:49:09.597

不确定您的意思 DD 只是位于顶级标准 ASP.Net 站点上，因此您可以切换出 DD，真正的灵活性是您可以在 ASP.Net 项目中使用您需要的 DD 位（您不需要'不需要搭建站点）您可以使用业务规则和FieldTemplate来加速您的站点的开发。例如，在 DetailsView 中编辑表格时，获取下拉列表以从相关表格中进行选择在 ASp.Net 中总是很痛苦，但混入一点 DD，您就可以免费获得它。:D 在此处查看我的博客[自定义页面第 3 部分 - 添加了动态数据功能以利用 FieldTemplates 的标准 ASP.Net 页面。](http://csharpbits.notaclue.net/2008/07/part-3-standard-aspnet-page-with.html)

# c - 为 Cocoa(touch) 开发创建自己的库的指南

> ID：681485
> 
> 赞同：22
> 
> 时间：2009-03-25T13:04:56.477
> 
> 标签：c, xcode, oop, frameworks

我目前正在使用许多具有自定义方法的相同子类对象。**创建我自己的可用于多个项目的库**会更方便。

目标是让我自己的类以与类等相同的方式可用`UIView`，`CGRect`包括方便的方法`CGRectMake`，包括类和结构。总而言之，我想创建自己的等价物：

*   类如`UIView`
*   像这样的结构`CGRect`
*   方便的功能，如`CGRectMake`
*   将此作为库提供
*   将其作为 XCode 模板提供，因此，将这些自定义对象作为 XCode 中的“新文件”提供

所以基本上我正在寻找有关如何创建类、结构等的说明，以便创建上述所有内容。**做这个的最好方式是什么？**[320 项目](http://joehewitt.com/post/the-three20-project/)似乎是一个很好的起点。但它缺乏（我认为）：

*   立即在新项目中使用该库
*   在“新文件”下提供新类

即使我会创建自己的静态库，**我是否能够在应用商店上发布该应用**，因为手机不支持链接到第 3 方库？

为了您的方便，这些基本上是子问题，涵盖了这个问题的范围：

*   **如何为 Mac / iPhone 开发创建自己的库？**
*   **如何为这个库创建类、结构和内联函数？**
*   **如何基于这个库创建自己的 Xcode 模板？**
*   **我能否使用自己的静态库发布 iPhone 应用程序？**

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2010-01-12T00:26:35.750

FYI Xcode 3.2 有一个名为 Cocoa Touch 静态库的新项目模板。你可能想走那条路。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-25T14:39:22.817

如果您在 Mac 上执行此操作，您将创建一个框架。但是，您提到`UIView`，很明显您正在使用 iPhone。Apple 不允许 iPhone 应用程序在运行时动态链接到其他库，因此您唯一的选择是创建一个静态库。静态库在构建时链接到应用程序可执行文件。

据我所知，Xcode 中没有静态库项目模板。您可能需要做的是从一个不同的 iPhone Xcode 模板开始并添加一个静态库目标。挂在默认的应用程序目标上；您可以使用它来构建一个简单的测试应用程序，以确保该库确实有效。

要在应用程序中实际使用该库，您需要两件事：已编译的库（扩展名为 .a）和所有头文件。在您完成的应用程序中，您将链接到您的静态库，并且您需要`#import`到头文件，以便编译器了解哪些类、函数等对其可用。（一种常见的技术是创建一个头文件来导入所有其他头文件。这样，您只需在源文件中导入一个文件。）

至于创建您自己的自定义模板，这里有一个简单的教程可以帮助您入门： http: [//www.macresearch.org/custom_xcode_templates](http://www.macresearch.org/custom_xcode_templates)您可能可以复制默认模板并自定义它们以满足您的目的。

结构语法如下所示：

```
typedef struct _MyPoint {
    CGFloat x;
    CGFloat y;
} MyPoint; 
```

结构是在头文件中声明的，所以你可以（我相信）Command+双击一个结构的名称来查看它是如何声明的。

创建结构的另一个小技巧是执行以下操作：

```
MyPoint aPoint = (MyPoint){ 1.5f, 0.25f }; 
```

因为编译器知道结构中字段的顺序，所以它可以很容易地将您在花括号中提供的值与适当的字段匹配。当然，有一个类似的函数更方便`MyPointMake`，所以你可以这样写：

```
MyPoint MyPointMake(CGFloat x, CGFloat y) 
    return (MyPoint){ x, y };
} 
```

请注意，这是一个函数，而不是方法，因此它存在于任何`@interface`上下文`@implementation`之外。尽管我认为如果您在`@implementation`上下文中定义它，编译器不会抱怨。

`CGPointMake`被定义为所谓的`inline`函数。你也可以在 Cocoa 头文件中看到它的定义。（内联函数和普通函数的区别在于编译器可以用的副本*替换**对*感觉。）`CGPointMake`*`CGPointMake`*

 ** * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-25T13:16:03.767

[320 项目](http://joehewitt.com/post/the-three20-project/)是 iPhone 类库的一个很好的例子。您基本上将您的项目编译成一个 .a 库，然后在您的客户端项目中静态链接它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-05T10:03:35.663

由于这是一个社区 wiki，我认为链接一些资源和教程会很有帮助：

[http://blog.stormyprods.com/2008/11/using-static-libraries-with-iphone-sdk.html](http://blog.stormyprods.com/2008/11/using-static-libraries-with-iphone-sdk.html)

[http://www.clintharris.net/2009/iphone-app-shared-libraries/](http://www.clintharris.net/2009/iphone-app-shared-libraries/)

享受！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T15:07:12.487

> 320 项目似乎确实是一个很好的起点。但它缺乏（我认为）：
> 
> *   立即在新项目中使用该库
> *   在“新文件”下提供新类

这些是项目和文件模板。如需更多信息，[请咨询 Google](http://www.google.com/search?ie=utf-8&oe=utf-8&num=20&q=xcode+project+template)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T18:49:06.633

如果您计划在应用商店上发布它，您将无法以您想要的方式使用您的库。如上所述，手机不支持链接到第三方库。我认为有一种“黑客”方式可以让它发挥作用，但你会失去分布。

我能想到的最好的办法是将所有相关代码放在一个目录中并以这种方式共享。我知道它不那么优雅，但它的局限性，即。不受我们控制。

# java - Java Web Starter AMI

> ID：681494
> 
> 赞同：5
> 
> 时间：2009-03-25T13:06:09.000
> 
> 标签：java, amazon-ec2, amazon-ami

I'm trying to follow the tutorial on [http://ttlnews.blogspot.com/2009/01/setting-up-amazon-ami-with-java-and.html](http://ttlnews.blogspot.com/2009/01/setting-up-amazon-ami-with-java-and.html) but can't find the [Java Web Starter AMI](http://developer.amazonwebservices.com/connect/entry.jspa?externalID=1993&categoryID=101) (ami-1c54b075) when searcing for AMI in the AWS console. Anyone now why this could be? It seems to be one of the most popular AMIs as well ([see infobox on the right side](http://developer.amazonwebservices.com/connect/kbcategory.jspa?categoryID=171)), so seems strange I cant find it...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-06T07:57:55.283

请参阅此[论坛帖子](http://solutions.amazonwebservices.com/connect/thread.jspa?threadID=29019)。可能 AMI 已更新并且 id 已更改。也许 ami-45e7002c 是较新的版本。

# wpf - 在 Datagrid 上按位置绑定 Xaml 的数组

> ID：681495
> 
> 赞同：2
> 
> 时间：2009-03-25T13:06:15.723
> 
> 标签：wpf, silverlight, xaml, datagrid, binding

我有一个字符串数组列表作为输入。数组维度对于所有列表都是静态的，但在检索到列表之前我无法知道数组大小。我需要在 Silverlight 的数据网格中绑定列表。

我试图在运行时创建列，将每列绑定到特定的数组位置，但找不到方法。

你知道怎么做吗？

我最终可以将我的数组列表“转换”为可以绑定在数据网格中的任何其他内容吗？

这个想法是在 Silverlight 的数据网格中显示一种 2d 矩阵（我认为问题是相似的）。

**列表**

```
 column_1      column_2       column_3   ..   column_m

string[1,1]   string[1,2]    string[1,3] ..  string[1,m]
string[2,1]   string[2,2]    string[2,3] ..  string[2,m]
string[3,1]   string[3,2]    string[3,3] ..  string[3,m]
....
string[n,1]   string[n,2]    string[n,3] ..  string[n,m] 
```

n 是列表长度，m 是列表列的最大数量。

任何想法表示赞赏

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T11:38:36.673

我找到了两个使用丹尼斯答案中的模式的问题的解决方案：

*   第一个是使用反射在运行时为绑定生成一个类，如[本文](http://blog.bodurov.com/How-to-bind-Silverlight-DataGrid-from-IEnumerable-of-IDictionary)所建议的（感谢 Vladimir Bodurov）。我已经测试了这个解决方案，我会尝试在我的项目中使用它。现在唯一的问题是，对于大型集合，性能很差。但我希望有人会在下一个版本中修复它（Silverlight 3 似乎还没有修复这个问题）

*   第二种解决方案将使用一些动态语言来生成数据。我不知道这是否会更快（可能不会）但最终会有所帮助。将来我会尝试使用 Ironpython 或 ruby​​ 来生成将绑定在 datagrid 中的类。

如果有人尝试使用第二种解决方案或任何有关在运行时创建类的性能相关信息，我们将不胜感激。

乔治奥

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T13:28:10.727

不幸的是，这并不容易。

您是否有任何有效的约束，例如允许的最大列数或类似的东西？如果你这样做（假设你有 N 列最大值），你也许可以通过

1.  有一个公开 N 个属性（例如名为 Col1...ColN）的类，该类将数组的内容映射为 X 列的一行
2.  生成该类的列表，每行一个实例
3.  即时生成正确数量的列，将每列绑定到属性 ColX
4.  将您的 DataGrid 绑定到该列表

这有点丑陋，但它会工作。

如果您不必依赖 DataGrid，则可以使用 UniformGrid。UniformGrid 是一个面板，它在规则网格中布局其子项（每个项目具有相同的宽度，每个项目具有相同的高度）。您可以在运行时指示列数，面板将一个接一个地容纳子级，直到列数，然后在另一行继续。您可以将 ItemsControl 绑定到您的数组，指示它应该使用 UniformGrid 作为其布局面板并指示合适的 ItemTemplate 来呈现每个字符串。

第二个选项要容易得多，但您不会拥有 DataGrid 的功能，如排序、移动列、行选择、每行的编辑事件等。

# python - Nullable ForeignKeys 和删除引用的模型实例

> ID：681497
> 
> 赞同：7
> 
> 时间：2009-03-25T13:06:42.337
> 
> 标签：python, django, django-models

我有一个 ForeignKey 在我的模型中可以为空，以模拟模型之间的松散耦合。它看起来有点像：

```
class Message(models.Model):
  sender = models.ForeignKey(User, null=True, blank=True)
  sender_name = models.CharField(max_length=255) 
```

保存时，发件人姓名将写入 sender_name 属性。现在，我希望能够删除发件人引用的 User 实例并将消息留在原处。

开箱即用，一旦我删除 User 实例，此代码总是会导致删除消息。所以我认为信号处理程序是个好主意。

```
def my_signal_handler(sender, instance, **kwargs):
  instance.message_set.clear()
pre_delete.connect(my_signal_handler, sender=User) 
```

可悲的是，这绝不是一个解决方案。不知何故，Django 首先收集它想要删除的内容，然后触发 pre_delete 处理程序。

有任何想法吗？我脑子里的结在哪里？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-25T13:31:54.383

Django 确实模拟了 SQL 的`ON DELETE CASCADE`行为，并且没有开箱即用的记录方法来改变这一点。他们提到这一点的文档在本节末尾附近：[删除对象](http://docs.djangoproject.com/en/dev/topics/db/queries/#deleting-objects)。

没错，Django 收集所有相关的模型实例，然后为每个实例调用预删除处理程序。信号的发送者将是即将被删除的模型类，在这种情况下`Message`，而不是`User`，这使得很难检测到由 User 触发的级联删除和正常删除之间的区别...... User 类排在最后，因为这是最后一次删除 :-)

但是，您可以在调用 User.delete() 函数之前获取 Django 建议删除的对象列表。每个模型实例都有一个名为的半私有方法，该方法`_collect_sub_objects()`使用指向它的外键编译实例列表（它编译此列表而不删除实例）。您可以通过查看`delete()`in来了解如何调用此方法`django.db.base`。

如果这是您自己的对象之一，我建议您重写`delete()`实例上的方法以运行 _collect_sub_objects()，然后在调用超类 delete 之前中断 ForeignKeys。由于您使用的是内置的 Django 对象，您可能会发现该对象太难以子类化（尽管可以将您自己的用户对象替换为 django 的），您可能必须依赖视图逻辑来运行`_collect_sub_objects`并在删除之前破坏 FK .

这是一个快速而肮脏的例子：

```
from django.db.models.query import CollectedObjects
u = User.objects.get(id=1)

instances_to_be_deleted = CollectedObjects()
u._collect_sub_objects(instances_to_be_deleted)

for k in instances_to_be_deleted.ordered_keys():
    inst_dict = instances_to_be_deleted.data[k]
    for i in inst_dict.values():
        i.sender = None  # You will need a more generic way for this
        i.save()

u.delete() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-04-14T12:34:43.780

我自己刚刚发现了 ON DELETE CASCADE 行为，我看到在 Django 1.3 中他们已经使外键行为[可配置](http://docs.djangoproject.com/en/dev/ref/models/fields/#django.db.models.ForeignKey.on_delete)。

# c# - C# to format (indent, align) C# properly

> ID：681500
> 
> 赞同：7
> 
> 时间：2009-03-25T13:07:02.227
> 
> 标签：c#, code-generation, code-formatting

We have a code generator that [munges](http://www.codegeneration.net/tiki-index.php?page=CodeMungerModel) the schema of a given database to automate our inhouse n-tier architecture. The output is various C# partial classes, one per file.

In the code to munge all the strings, we try and keep on top of the indenting and formatting as much as possible, but invariably when you come to open the file in Visual Studio the formatting is awry. A quick ctrl-k, ctrl-d fixes it, but obviously this reformatting is lost the next time the class is generated.

What I'd like to know, is if there's a way I can somehow automatically format the contents of the textfile in the same way Visual Studio does?

Pseudocode

```
Create "code" object, passing text file to constructor
Invoke "format" method
Re-save text file 
```

Any help greatly appreciated.

**EDIT:** I should clarify - I want to be able to invoke the formatting from my C# code that creates the textfile containing my generated C#. The format of the code can be standardised (doesn't have to be per-developer), and I don't want to have to install any 3rd-party apps.

I seem to remember there's a namespace containing loads of classes for creating C# in C#: [http://msdn.microsoft.com/en-us/library/system.codedom(VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.codedom(VS.80).aspx), but I'm not sure if it contains any classes that could help.

**FURTHER EDIT:** My code generator is a winforms app deployed via a click-once install. It's used by many developers in-house. I need a solution that doesn't require each developer to have a tool installed on their machine.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2017-11-07T08:05:12.773

要以编程方式正确缩进代码，您需要 Microsoft.CodeAnalysis.CSharp nuget 包和 .NET 框架 4.6+。示例代码：

```
public string ArrangeUsingRoslyn(string csCode) {
    var tree = CSharpSyntaxTree.ParseText(csCode);
    var root = tree.GetRoot().NormalizeWhitespace();
    var ret = root.ToFullString();
    return ret;
} 
```

单线：

```
csCode = CSharpSyntaxTree.ParseText(csCode).GetRoot().NormalizeWhitespace().ToFullString(); 
```

您也可以使用[NArrange](http://www.narrange.net/)对您的 cs 文件中的方法进行排序、组织使用、创建区域等。请注意，NArrange 不会缩进任何内容。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-25T13:20:46.237

Take a look at [Narrange](http://www.narrange.net/).You'll probably need to automate these things as part of the build.
Not sure if it meets all your requirements though.
*To quote:*

> NArrange is a .NET code beautifier that automatically organizes code members and elements within .NET classes.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T13:41:34.000

You can use CodeDOM and the CSharpCodeProvider. It is all in the namespaces Microsoft.CSharp and System.CodeDom.

Her is an example of a property:

```
StringWriter writer = new StringWriter();
CSharpCodeProvider provider = new CSharpCodeProvider();
CodeMemberProperty property = new CodeMemberProperty();
property.Type = new CodeTypeReference(typeof(int));
property.Name = "MeaningOfLifeUniverseAndEverything";
property.GetStatements.Add(new CodeMethodReturnStatement(new CodePrimitiveExpression(42)));
provider.GenerateCodeFromMember(property, writer, null);
Console.WriteLine(writer.GetStringBuilder().ToString()); 
```

This code will generate:

```
private int MeaningOfLifeUniverseAndEverything {
    get {
        return 42;
    }
} 
```

The CodeDOM is a quite chatty way to generate code. The good thing is that you can generate multiple languages. Perhaps you can find a Erlang.NET CodeProvider?

You might be able to do a few shortcuts by using CodeSnippetExpression.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T13:37:01.983

Here's how to do it from the context of a macro or add-in:

```
var dte = (EnvDTE80.DTE2)System.Runtime.InteropServices.Marshal.GetActiveObject("VisualStudio.DTE.8.0");
dte.ExecuteCommand("File.OpenFile", filename);
dte.ExecuteCommand("Edit.FormatDocument", filename);
dte.ActiveDocument.Close(vsSaveChanges.vsSaveChangesYes); 
```

Warning: As @Greg Hurlman says, the output will vary depending on the user's current options.

**Edit:**

> *unfortunately your method requires me to have an instance of VS running alongside my winforms app. Can you think of a way to create an instance of VS from within my app (if that's even possible)?*

I think it might be possible to do from within your Win.Form app. However, you'll have to have Visual Studio installed on the machine running the code.

Try this:

```
var dte = (EnvDTE80.DTE2)Microsoft.VisualBasic.Interaction.CreateObject("VisualStudio.DTE.8.0", "");
dte.ExecuteCommand("File.OpenFile", filename);
dte.ExecuteCommand("Edit.FormatDocument", filename);
dte.ActiveDocument.Close(vsSaveChanges.vsSaveChangesYes); 
```

Keep in mind that you'll need references to the EnvDTE80.dll assembly.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T13:10:58.397

Only if you're running the code generator as a VS add-on - each developer is going to have different settings.

# c# - EventWaitHandle 是否有任何隐式 MemoryBarrier？

> ID：681505
> 
> 赞同：10
> 
> 时间：2009-03-25T13:09:26.497
> 
> 标签：c#, .net, vb.net, multithreading, volatile

刚接触这个网站，所以如果我没有以可接受的方式发帖，请告诉我。

我经常按照下面的示例编写一些代码（为了清楚起见，省略了 Dispose 之类的东西。）。我的问题是，是否需要如图所示的挥发物？或者 ManualResetEvent.Set 是否像我读过的那样具有隐式内存屏障 Thread.Start 呢？或者明确的 MemoryBarrier 调用会比 volatile 更好吗？还是完全错误？此外，据我所见，某些操作中的“隐式内存屏障行为”没有记录，这很令人沮丧，在某处是否有这些操作的列表？

谢谢，汤姆

：

```
class OneUseBackgroundOp
{

   // background args
   private string _x;
   private object _y;
   private long _z;

   // background results
   private volatile DateTime _a
   private volatile double _b;
   private volatile object _c;

   // thread control
   private Thread _task;
   private ManualResetEvent _completedSignal;
   private volatile bool _completed;

   public bool DoSomething(string x, object y, long z, int initialWaitMs)
   {
      bool doneWithinWait;

      _x = x;
      _y = y;
      _z = z;

      _completedSignal = new ManualResetEvent(false);

      _task = new Thread(new ThreadStart(Task));
      _task.IsBackground = true;
      _task.Start()

      doneWithinWait = _completedSignal.WaitOne(initialWaitMs);

      return doneWithinWait;

   }

   public bool Completed
   {
      get
      {
         return _completed;
      }
   }

   /* public getters for the result fields go here, with an exception
      thrown if _completed is not true; */

   private void Task()
   {
      // args x, y, and z are written once, before the Thread.Start
      //    implicit memory barrier so they may be accessed freely.

      // possibly long-running work goes here

      // with the work completed, assign the result fields _a, _b, _c here

      _completed = true;
      _completedSignal.Set();

   }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T14:37:37.970

volatile 关键字不应混淆为使 _a、_b 和 _c 线程安全。请参阅[此处](https://stackoverflow.com/questions/154551/volatile-vs-interlocked-vs-lock)以获得更好的解释。此外，ManualResetEvent 对 _a、_b 和 _c 的线程安全没有任何影响。您必须单独管理它。

编辑：通过这个编辑，我试图提炼所有关于这个问题的答案和评论中的信息。

基本问题是结果变量（_a、_b 和 _c）在标志变量（_completed）返回 true 时是否“可见”。

暂时，让我们假设没有一个变量被标记为 volatile。在这种情况下，可以在 Task() 中设置标志变量***之后设置结果变量，如下所示：***

```
 private void Task()
   {
      // possibly long-running work goes here
      _completed = true;
      _a = result1;
      _b = result2;
      _c = result3;
      _completedSignal.Set();
   } 
```

这显然不是我们想要的，那么我们该如何处理呢？

如果这些变量被标记为易失性，那么这种重新排序将被阻止。但这就是引发原始问题的原因 -*是否需要 volatile 或者 ManualResetEvent 是否提供了隐式内存屏障，以便不会发生重新排序，在这种情况下， volatile 关键字真的不需要？*

如果我理解正确，wekempf 的立场是 WaitOne() 函数提供了一个隐式内存屏障来解决问题。 ***但这***对我来说似乎还不够。主线程和后台线程**可以**在两个单独的处理器上执行。因此，如果 Set() 也没有提供隐式内存屏障，则 Task() 函数最终可能会在其中一个处理器上像这样执行（即使使用 volatile 变量）：

```
 private void Task()
   {
      // possibly long-running work goes here
      _completedSignal.Set();
      _a = result1;
      _b = result2;
      _c = result3;
      _completed = true;
   } 
```

我搜索了有关内存屏障和 EventWaitHandles 的信息，但一无所获。我看到的唯一参考资料是 wekempf 对 Jeffrey Richter 的书所做的参考资料。我遇到的问题是 EventWaitHandle 旨在同步线程，而不是访问数据。我从未见过任何使用EventWaitHandle（例如ManualResetEvent）来同步数据访问的例子。因此，我很难相信 EventWaitHandle 在内存屏障方面做了任何事情。否则，我希望在互联网上找到***一些***对此的参考。

编辑#2：这是对 wekempf 对我的回应的回应...... ;)

我设法在 amazon.com 上阅读了 Jeffrey Richter 书中的部分。从第 628 页开始（wekempf 也引用了这一点）：

> 最后，我应该指出，每当线程调用互锁方法时，CPU 都会强制缓存一致性。因此，如果您通过互锁方法操作变量，则不必担心所有这些内存模型的东西。此外，所有线程同步锁（**Monitor**、**ReaderWriterLock**、**Mutex**、**Semaphone**、**AutoResetEvent**、**ManualResetEvent**等）在内部调用互锁方法。

因此，正如 wekempf 所指出的，结果变量似乎***不需要***示例中的 volatile 关键字，因为 ManualResetEvent 确保了缓存的一致性。

在结束此编辑之前，我还想补充两点。

首先，我最初的假设是后台线程可能会运行多次。我显然忽略了类的名称（OneUseBackgroundOp）！鉴于它只运行一次，我不清楚为什么 DoSomething() 函数会以这种方式调用 WaitOne() 。如果后台线程在 DoSomething() 返回时可能完成也可能不完成，那么等待 initialWaitMs 毫秒有什么意义？为什么不直接启动后台线程并使用锁来同步对结果变量的访问，***或者***只是将 Task() 函数的内容作为调用 DoSomething() 的线程的一部分执行？有理由不这样做吗？

其次，在我看来，不对结果变量使用某种锁定机制仍然是一种不好的方法。诚然，代码中不需要它，如图所示。但是在某个时候，另一个线程可能会出现并尝试访问数据。在我看来，最好现在就为这种可能性做好准备，而不是以后试图追查神秘的行为异常。

感谢大家对我的支持。通过参与这次讨论，我当然学到了很多东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T18:09:21.643

请注意，这是即兴的，无需仔细研究您的代码。我不*认为*Set 执行内存屏障，但我看不出这与您的代码有什么关系？似乎更重要的是 Wait 执行一个，它确实执行了。因此，除非我在专用于查看您的代码的 10 秒内错过了某些内容，否则我认为您不需要 volatiles。

编辑：评论太严格了。我现在指的是马特的编辑。

马特的评估做得很好，但他遗漏了一个细节。首先，让我们提供一些关于抛出的东西的定义，但这里没有澄清。

易失性读取读取一个值，然后使 CPU 缓存无效。易失性写入会刷新缓存，然后写入值。内存屏障刷新缓存，然后使其无效。

.NET 内存模型确保所有写入都是易失的。默认情况下，不会读取，除非进行了显式 VolatileRead，或者在字段上指定了 volatile 关键字。此外，interlocked 方法强制缓存一致性，所有同步概念（Monitor、ReaderWriterLock、Mutex、Semaphore、AutoResetEvent、ManualResetEvent 等）在内部调用 interlocked 方法，从而确保缓存一致性。

同样，所有这些都来自 Jeffrey Richter 的书“CLR via C#”。

我说，最初，我不*认为*Set 执行了内存屏障。然而，在进一步思考 Richter 先生所说的之后，Set 将执行一个互锁操作，因此也将确保缓存的一致性。

我坚持我最初的断言，即这里不需要 volatile。

编辑 2：看起来你正在建立一个“未来”。我建议您查看[PFX](http://www.microsoft.com/downloads/details.aspx?FamilyId=348F73FD-593D-4B3C-B055-694C50D2B0F3&displaylang=en)，而不是自己滚动。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-18T11:15:31.740

等待函数具有隐式内存屏障。请参阅[http://msdn.microsoft.com/en-us/library/ms686355(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ms686355(v=vs.85).aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T19:49:34.040

首先，我不确定我是否应该“回答我自己的问题”或为此使用评论，但这里是：

我的理解是 volatile 阻止代码/内存优化移动对我的结果变量（和完成的布尔值）的访问，以便读取结果的线程将看到最新数据。

由于编译器或 emmpry 优化/重新排序，您不希望 _completed 布尔值在 Set()*之后对所有线程可见。*同样，您不希望在 Set() 之后看到对结果 _a、_b、_c 的写入。

编辑：关于问题的进一步解释/澄清，关于马特戴维斯提到的项目：

> 最后，我应该指出，每当线程调用互锁方法时，CPU 都会强制缓存一致性。因此，如果您通过互锁方法操作变量，则不必担心所有这些内存模型的东西。此外，所有线程同步锁（Monitor、ReaderWriterLock、Mutex、Semaphone、AutoResetEvent、ManualResetEvent 等）在内部调用互锁方法。
> 
> 因此，正如 wekempf 所指出的，结果变量似乎不需要示例中的 volatile 关键字，因为 ManualResetEvent 确保了缓存的一致性。

所以你们都同意这样的操作负责处理器之间或寄存器等的缓存。

但是它是否会阻止重新排序以保证在完成标志之前分配两个结果**，**并且在设置 ManualResetEvent **之前**将完成标志分配为真？

> 首先，我最初的假设是后台线程可能会运行多次。我显然忽略了类的名称（OneUseBackgroundOp）！鉴于它只运行一次，我不清楚为什么 DoSomething() 函数会以这种方式调用 WaitOne() 。如果后台线程在 DoSomething() 返回时可能完成也可能不完成，那么等待 initialWaitMs 毫秒有什么意义？为什么不直接启动后台线程并使用锁来同步对结果变量的访问，或者只是将 Task() 函数的内容作为调用 DoSomething() 的线程的一部分执行？有理由不这样做吗？

样本的概念是执行一个**可能**长时间运行的任务。如果该任务可以在一个例外的时间内完成，那么调用线程将可以访问结果并继续正常处理。但有时一个任务可能需要相当长的时间，并且在此期间不能阻塞调用线程，并且可以采取合理的步骤来处理它。这可以包括稍后使用 Completed 属性检查操作。

一个具体的例子：DNS 解析通常非常快（亚秒级），即使从 GUI 也值得等待，但有时可能需要很多秒。因此，通过使用像示例这样的实用程序类，可以在 95% 的时间里从调用者的角度轻松获得结果，而在另外 5% 的时间里不会锁定 GUI。可以使用后台工作人员，但这对于绝大多数时间不需要所有管道的操作来说可能是多余的。

> 其次，在我看来，不对结果变量使用某种锁定机制仍然是一种不好的方法。诚然，代码中不需要它，如图所示。

结果（和完成标志）数据是一次写入，多次读取。如果我添加了一个锁来分配结果和标志，我还必须锁定我的结果 getter，而且我从不喜欢看到 getter 锁定只是为了返回一个数据点。从我的阅读来看，这种细粒度的锁定是不合适的。如果一个操作有 5 或 6 个结果，调用者必须不必要地获取和释放锁 5 或 6 次。

> 但是在某个时候，另一个线程可能会出现并尝试访问数据。在我看来，最好现在就为这种可能性做好准备，而不是以后试图追查神秘的行为异常。

因为我有一个 volatile 已完成标志，保证在 volatile 结果**之前**设置，并且对结果的唯一访问是通过 getter，并且如 smaple 中所述，如果调用 getter 并且操作将引发异常尚未完成，我希望 Completed 和结果 getter 可以由调用 DoSomething() 的线程以外的线程调用。无论如何，这就是我的希望。无论如何，我相信这对于挥发物来说是正确的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T14:32:24.457

根据您所展示的内容，我会说，不，`volatiles`该代码中不需要。

它`ManualResetEvent`本身没有隐式内存屏障。然而，主线程正在等待信号的事实意味着它不能修改任何变量。至少，它在等待时不能修改任何变量。所以我想你可以说等待同步对象是一个隐式内存屏障。

但是请注意，如果其他线程存在并且可以访问这些变量，则可以修改它们。

从你的问题来看，你似乎错过了做什么`volatile`。所做`volatile`的只是告诉编译器该变量可能被其他线程异步修改，因此它不应该优化访问该变量的代码。 `volatile`不会以任何方式同步对变量的访问。

# c# - .aspx 页面中的字符串替换是否有最佳实践？

> ID：681515
> 
> 赞同：2
> 
> 时间：2009-03-25T13:11:52.870
> 
> 标签：c#, asp.net, data-binding, templates, replace

我有一个 .aspx 页面设置。我有很多占位符需要更换。名字，姓氏，城市，州等。我如何以有效的方式进行此操作？

丢一堆...

```
<asp:Label runat="server" id="Label_FirstName" Text="" /> 
```

...到处？

或者有没有办法在普通页面区域使用数据绑定语法：

```
<% FirstName %> 
```

提前致谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-25T13:18:47.737

注意

```
<asp:Label runat="server" id="Label_FirstName" Text="" /> 
```

将转义您的字符串（例如，将 < 和 > 替换为 < 和 >），但是

```
<%= FirstName %> 
```

将不会。如果这是您的意图，那很好，但请注意，您可能会为[XSS 攻击](http://en.wikipedia.org/wiki/Cross-site_scripting)打开通道。为了正确地转义你的字符串，你可能想要

```
<%= System.Web.HttpUtility.HtmlEncode(FirstName) %> 
```

反而。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T13:15:23.830

你当然可以使用：

```
<%= FirstName %> 
```

其中 FirstName 是页面的属性。它不一定是类中的属性，您可以从该行访问几乎任何内容。

**更新：**正如 DrJokepu 指出的，如果您显示的数据来自用户输入，那么它会打开一个 XSS 漏洞。正如所指出的，您使用 HtmlEncode 来避免这种情况，在这种情况下，更短的语法将是：

```
<%= Server.HtmlEncode(FirstName) %> 
```

如果你有一个基本页面，你可以定义一个方法并摆脱：

```
<%= HtmlEncode(FirstName) %> 
```

* * *

如果您使用 asp.net 标签，请在适当的地方执行 EnableViewState = false，这样您就可以避免发送/接收不必要的视图状态。

* * *

对于格式化使用 ids/css 类，并在 css 样式表中具有样式。无论内容是否动态，css都可以被浏览器缓存。

* * *

对于信息列表，您可以使用 ListView 或 Repeaters 并仍然控制将通过网络发送的特定 html。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T13:15:36.840

您绝对可以使用 ASP 样式的标签 ( `<%= %>`)，但我认为您的第一种方法更清洁且更易于维护。当您使用 ASP 风格的标签时，您不会进行数据绑定，而是可以访问页面的所有成员（包括字段、属性和其他方法）。

`FirstName`因此，如果是您正在处理的页面上的字段或属性，这两种方法都将起作用。我个人发现基于控制的方法更好，但每个人都有自己的想法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T13:16:23.687

我喜欢使用标签，因为它更容易混淆颜色、字体、粗体等...以显示错误或吸引用户注意某些文本。

我通常在代码隐藏中只有一个设置方法。

```
if(!Page.IsPostBack)
        SetupForm();

SetupForm()
{
    Label_FirstName.Text = firstName;

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T13:15:30.990

如果您想对 HTML 进行更多控制，可以使用一堆标签或替换控件，甚至是文字文本。

您可以在标记中使用代码，例如：

<%=this.FirstName%>

这将导致在您的页面上调用名为 FirstName 的属性，并将其返回值放置在标签之间。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T13:18:23.527

这取决于您将使用它们的上下文。通常使用 asp:label 控件很好，因为您可以从页面上的代码隐藏中访问它们。数据绑定方法通常在数据绑定控件（如 DataGrid 或 Repeater）中使用。

数据绑定方法的真正问题是 IDE 对此没有很好的支持。为了让它工作，你必须在你的页面类上有一个属性，你需要在后面的代码中填充它，但是如果属性名称发生变化，你还必须确保更新你的 aspx 页面。如果您使用标签方法，IDE 将检测标签名称是否发生变化，或者它是否已被完全删除并给您一个编译时错误。

或者，您可以使用 jQuery 填充您的数据，并使用 spans 作为您的占位符。请注意，jQuery 需要一些不同的方式来考虑您的页面，因为它使用 javascript 来填充您的字段。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-25T13:26:54.693

Jeff Atwood 在[Coding Horror](http://www.codinghorror.com/blog/archives/001223.html)中探索了这个主题，发现性能[并不重要](http://www.codinghorror.com/blog/archives/001218.html)......

**注意**：似乎杰夫的帖子必须用一粒盐来处理，毕竟......很抱歉在没有阅读评论的情况下匆忙回答

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-25T14:27:37.043

我的经验法则是：

*   如果我要标记输入控件，我会使用 Label 以便设置 AssociatedControlID 属性。
*   否则，我使用[Literal](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.literal.aspx)或[Localize](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.localize.aspx)控件。我通常不直接设置标签的样式，因此我不需要它们在其他情况下生成的额外标记。

因此，在您的情况下，我可能会使用 Literal 控件。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-03-25T13:16:22.597

试试这个：

```
<%= FirstName %> 
```

# c++ - 编译器无法正确识别 C++ 枚举

> ID：681518
> 
> 赞同：4
> 
> 时间：2009-03-25T13:12:54.617
> 
> 标签：c++, enums, constructor, temporary

谁能解释为什么以下代码无法编译（在 g++ (GCC) 3.2.3 20030502 (Red Hat Linux 3.2.3-49) 上）？

```
struct X {
public:
   enum State { A, B, C };

   X(State s) {}
};

int main()
{
   X(X::A);
} 
```

我得到的信息是：

jjj.cpp：在函数'int main（）'中：
jjj.cpp：10：'XX :: A'不是'struct X'的静态成员
jjj.cpp：10：没有匹配函数调用'X： :X()'
jjj.cpp:1：候选人是：X::X(const X&)
jjj.cpp:5: X::X(X::State)`

这是错误的代码还是编译器错误？

Neil+Konrad 解决了问题。请参阅下面对尼尔答案的评论。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-25T13:16:58.850

您忘记了定义中的变量名称：

```
int main()
{
   X my_x(X::A);
} 
```

您的代码使编译器感到困惑，因为在语法上它无法将其与函数声明（作为参数返回`X`和传递）区分开来。`X::A`如有疑问，C++ 编译器总是会消除歧义，支持声明。

解决方案是在 周围引入多余的括号，`X`因为编译器禁止在类型周围使用括号（与构造调用等相反）：

```
(X(X::A)); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-25T13:17:25.683

```
X(X::A); 
```

被视为函数声明。如果您真的想要此代码，请使用：

```
(X)(X::A); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T17:42:16.153

只是为了弄清楚会发生什么。看这个例子

```
int main() {
    float a = 0;
    {
        int(a); // no-op?
        a = 1;
    }
    cout << a;
} 
```

它会输出什么？好吧，它会输出`0`. 上面的`int(a)`可以用两种不同的方式解析：

*   转换为 int 并丢弃结果
*   声明一个名为 的变量`a`。但忽略标识符周围的括号。

当出现在语句中使用函数样式转换并且看起来也像声明的这种情况时，编译器将始终将其视为声明。当它在语法上不能是一个声明时（编译器将查看整行来确定），它将被视为一个表达式。因此，我们将分配给`a`上面的内部，而外部则`a`为零。

现在，您的情况正是如此。`A`您正在尝试（意外地）声明一个在名为的类中调用的标识符`X`：

```
X (X::A); // parsed as X X::A; 
```

然后编译器继续抱怨未声明的默认构造函数，因为它假设的静态是默认构造的。但是，即使您有 X 的默认构造函数，它当然仍然是错误的，因为既不`A`是 X 的静态成员，也不能在块范围内定义/声明 X 的静态成员。

你可以通过做几件事使它看起来*不像*一个声明。首先，您可以将整个表达式用括号括起来，这使它看起来不再像一个声明。或者只是将类型转换为括号。其他答案中都提到了这两种歧义：

```
(X(X::A)); (X)(X::A) 
```

当您尝试实际声明一个对象时，存在类似但明显的歧义。看这个例子：

```
int main() {
    float a = 0;
    int b(int(a)); // object or function?
} 
```

因为`int(a)`既可以是被调用参数的声明，也可以是`a`浮点变量到 int 的显式转换（强制转换），编译器再次决定这是一个声明。因此，我们碰巧声明了一个名为 的函数`b`，它接受一个整数参数并返回一个整数。基于上述消歧，有几种可能的消歧方法：

```
int b((int(a))); int b((int)a); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T13:17:51.407

您应该将对象声明为

```
X x(X::A); 
```

代码中的错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T13:26:00.093

这两行中的任何一条都对我有用：

```
X obj(X::A);
X obj2 = X(X::A); 
```

正如 Neil Butterworth 指出的那样，`X(X::A)`被视为函数声明。如果你真的想要一个匿名对象，`(X)(X::A)`就会构造一个 X 对象并立即删除它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T14:09:57.943

当然，你可以这样做：

```
int main()
{
    // code
    {
    X temp(X::A);
    }
    // more code
} 
```

这将更具可读性，并且基本上具有相同的效果。

# vmware - 您如何使用完全免费的软件为 VMware ESXi 创建 ovf 文件？

> ID：681519
> 
> 赞同：-1
> 
> 时间：2009-03-25T13:14:14.240
> 
> 标签：vmware, virtualization

好的，假设我想在我的环境中尝试虚拟化。我想使用 ESXi 来做到这一点，因为它是免费的。我可以使用安装盘并设置一个盒子来运行 ESXi 主机。

我不确定 VMware Infrastructure Client 是否可以免费提供一件事。您可以使用它来附加 ovf 文件（打包的 VM）。我遇到的问题是创建一个有效的 ovf 文件。免费转换器没有成功。

有没有人有任何提示或指南？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T21:42:10.943

**VMware Infrastructure Client**是免费的，但有一定的限制。您只需从已安装的 ESXi 主机通过 Web 下载它。

您需要许可证才能启用 vMotion，但对于单个主机来说没有问题。

我们将 ESXi（免费）与 VI Client（免费）一起使用，并获得比*VMware* Server（也是免费）更好的性能。在与其他有工作设置的人交谈之前，我不太确定 VI Client 的事情，如果您是各种企业级 VMware 解决方案的新手，这有点令人困惑，而且绝对不是“显而易见的”。

编辑：这对 ESX3 来说是真的，事情发生了变化，它不再是真的。请参阅 ESX4/5 解决方案的注释。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-07T19:01:58.857

是的，VI Client 在 ESXi 中是免费的，只是没有高级功能。

要创建 OVF，您应该查看 VMware Studio，最近发布了一个新的 Beta。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T13:18:41.543

遗憾的是，不，VMware 客户端不是免费的：

*“此外，使用 VMware vCenter Server 管理 VMware ESXi 主机需要为每台主机配备一个 VMware vCenter Server 代理，仅在购买 VMware Infrastructure 许可证（Foundation、Standard 或 Enterprise）后才可用。”*

从此 VMware 页面：

[http://www.vmware.com/products/esxi/uses.html](http://www.vmware.com/products/esxi/uses.html)

# delphi - delphi中父类和子类之间的转换

> ID：681522
> 
> 赞同：4
> 
> 时间：2009-03-25T13:15:18.993
> 
> 标签：delphi, oop, freepascal

我正在编写一些针对两个版本非常相似的硬件的软件，在我使用 API 初始化硬件之前，我无法知道我将返回哪种类型的硬件。

因为硬件非常相似，我计划有一个父类（TParent），它有一些抽象方法（对于硬件不同的地方），然后是两个子类（TChildA，TChildB），它们以硬件相关的方式实现这些方法。

所以我会首先实例化一个 TParent 的对象，检查它是什么类型，然后将其转换为正确的孩子。

但是，当我这样做并调用在子类中完全实现的抽象方法之一时，我得到一个 EAbstractError。

例如：

```
myHardware:=TParent.Create();

if myHardware.TypeA then
   myHardware:=TChildA(myHardware)
else
   myHardware:=TChildB(myHardware);

myHardware.SomeMehtod(); 
```

我假设我不能将父类转换为子类，并且可能有更好的方法来做到这一点。任何指针？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T13:23:45.247

您需要一个工厂方法来根据您使用的硬件类型返回正确的类...

```
function CreateHardware(isTypeA: Boolean): TParent;
begin
  if IsTypeA then Result := TChildA.Create
  else Result := TChildB.Create;
end;
...

var
  myHardware: TParent;
begin
  myHardware := CreateHardware(True);
  myHardwarde.SomeMethod;
end; 
```

...或者您可以使用[State 模式](http://en.wikipedia.org/wiki/State_pattern)。

这两种方法的共同点是您的 TParent 类不具备确定硬件类型的知识。该知识被转移到工厂方法、工厂方法的调用者、工厂本身或状态类中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-25T15:42:37.017

感谢 Binary Worrier 和 Mghie 在这种情况下为我指明了正确的方向。在最小化硬件初始化不是问题的情况下，Lieven 给出的答案将是更简单的方法。

pImpl 成语[在 SO 的其他地方讨论](https://stackoverflow.com/questions/60570/usage-of-the-pimpl-idiom)

以下是我如何理解伪德尔福代码中的实现（注意我没有为此烦恼公共/私人区别）：

```
class TParent 
  procedure SomeMethod(); abstract;
end;

class TChildA (TParent)
  procedure SomeMethod(); override;
end;

class TChildB (TParent)
  procedure SomeMethod(); override;
end;

class THardware
 HardwareSpecficMethods: TParent;
 procedure SomeMethod;
 constructor Create();

contrsuctor THardware.Create();
begin
 InitializeHardware();
 If Hardware.TypeA then
  HardwareSpecificMethods:=TChildA.Create()
 else
  HardwareSpecificMethods:=TChildB.Create();
end;

procedure THardware.SomeMethod();
begin
  HardwareSpecificMethods.SomeMethod();
end;
end; {class THardware} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T13:32:12.790

你是对的，你不能也不应该从基类转换为派生类。

我假设您不想让 Child 对象重新运行 Parent 构造函数？

如果是这样的话 。. .

删除当前的父/子关系，您将只有一个硬件类。对于特定的 ChildA 和 ChildB 功能，创建一个新的继承模式，这样您就有一个 ISpecificHardwareTasks 接口或基类，以及两个派生类（SpecificA 和 SpecificB）。

当硬件构建它自己时，它知道它正在使用什么类型的硬件，然后它创建一个SpecificA或SpecificB的实例）。此实例是硬件专用的。

硬件公开了包装 ISpecificHardWareTasks 方法的方法（如果有意义，它甚至可以实现该接口）。

如果有必要，特定类可以引用 Hardware 类（尽管我不知道您是否可以访问构造函数中的 this 指针，但我的 Delphi 已经生锈了）

希望这些杂谈有所帮助。

# php - 调用外部 Web 服务的 PHP 脚本的安全 JavaScript

> ID：681530
> 
> 赞同：1
> 
> 时间：2009-03-25T13:16:18.367
> 
> 标签：php, javascript, security, jquery

我有一个需要调用外部 Web 服务的 PHP 页面。此 Web 服务调用从 PHP 页面上的 html 表单中获取一堆敏感数据，例如 SSN，并返回与该人相关的信息。

问题是一旦客户填写了 SSN 字段并且该字段失去焦点，就应该进行 Web 服务调用，因此无法以任何方式重新加载页面。我正在考虑使用 jQuery 来调用 Web 服务，但不幸的是，AJAX 要求您与请求的资源在同一个域中。所以我正在考虑创建一个本地 PHP 页面来调用 Web 服务，然后使用 JQuery 来调用这个新页面。

问题：

1.  如何使用 JQuery 调用本地 PHP 脚本来调用 Web 服务？

2.  因为 JQuery 代码将从 html 表单中获取敏感数据并将其发送到 PHP 脚本，我该如何加密数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T13:20:16.173

1) $.get("myscript.php", function(response) { alert(response) });

2）我不会使用 jQuery 加密，它会很慢而且很容易解密。在服务器上启用 SSL 将是一个更好的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T13:21:48.697

要调用您的 PHP 文件：

```
var url = "http://localhost/data.php";
var params = {
  "SSN" : theSSN
};
$.get(url, params, function (){
  // Do whatever you need here, once the data arrives.
}); 
```

要从 PHP 调用外部网络服务，我建议使用[cURL](http://us2.php.net/manual/en/book.curl.php)。

要加密，我建议使用 HTTPS 协议而不是从 JavaScript 手动加密。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T13:21:10.867

1：Ajax请求示例：

```
$.ajax(
{
       type: "GET",
       url: "http://yourdomain.com/yourpage.php",
       success: function (msg) { //does something }
}); 
```

更多细节[在这里](http://docs.jquery.com/Ajax)

2：php XOR 是一个很不错的加密算法，我自己用于敏感数据的项目。[你可以在这里](http://www.jonasjohn.de/snippets/php/xor-encryption.htm)找到函数。

享受！:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T13:21:52.083

这可能对您没有特别的帮助，但是一些 web 服务支持称为 JSONP 的东西，它为普通的 JSON 请求添加了一个回调名称。

但是，您可能需要制作某种本地代理，因为目前还没有很多 JSONP 服务。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T14:12:13.583

要走的路是在您的域上启用 SSL，并对远程服务的 https 执行 xmlHTTPRequest

# design-patterns - Memento 的正确实现

> ID：681549
> 
> 赞同：4
> 
> 时间：2009-03-25T13:19:24.367
> 
> 标签：design-patterns, memento

在 memento 设计模式中，将 Caretaker 作为 Originator 的聚合是错误的吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T13:34:00.633

不必要。Memento 背后的主要目的是可以以统一、透明的方式处理不同的 Originator（获取 Memento，稍后将其传回以恢复状态）。

聚合关系不一定能阻止这种情况。不同的 Caretaker 实例可能是不同 Originator 的聚合（尽管一个 Caretaker 实例只处理 Originator 的一个实例）并且仍然可以获得透明状态恢复的好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T13:24:34.183

不，如果它适合您的情况，那很好。理解看守人的状态不是纪念品中保存的内容的一部分并不是一个很大的飞跃。

# sql - SELECT INTO 变量，两条语句，添加变量

> ID：681559
> 
> 赞同：2
> 
> 时间：2009-03-25T13:21:44.643
> 
> 标签：sql, oracle, plsql

我有一个名为 c_kilometers 的变量。我有一个光标可以抓取一堆具有这些公里数的记录。我需要在游标中运行两个单独的 SELECT 语句，它们只是根据游标中的值从一个表中抓取一公里，然后运行另一个 SELECT 在另一个表上做同样的事情。

```
SELECT t.kilometers INTO c_kilometers
FROM table_name WHERE WHERE l.code = cursor_t.code_att

SELECT g.kilometers INTO c_kilometers
FROM table_name WHERE l.code = cursor_t.code_aff 
```

我的问题是我可以将 c_kilometers 添加在一起而不创建临时变量来保留这些值吗？我有一段时间没有使用 PL/SQL，而且我不记得曾经这样做过，所以这更像是一个学习问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T13:39:43.820

如果您的两个查询始终只返回一行，您可以执行以下任一操作：

```
/* Variant 1 */

SELECT  t.kilometers + g.kilometers
INTO    c_kilometers
FROM    table_name t, table_name2 g
WHERE   etc1
        AND etc2

/* Variant 2 */

SELECT  t.kilometers
INTO    c_kilometers
FROM    table_name
WHERE   etc;

SELECT  c_kilometers + g.kilometers
INTO    c_kilometers
FROM    table_name2
WHERE   etc; 
```

如果它们与您发布的表格在同一个表格中，您可以使用：

```
SELECT COALESCE(SUM(kilometers), 0)
INTO   c_kilometers
FROM   table_name
WHERE  l.code IN (cursor_t.code_aff, cursor_t.code_att) 
```

似乎将其放入生成游标`table_name`的查询中会更有效。`SELECT`

如果您发布此查询，我可能会帮助您做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T00:26:04.703

像这样加入 SELECT： `SELECT a.kilometers + b.kilometers FROM (SELECT code, kilometers FROM table_name WHERE ...) a JOIN (SELECT code, kilometers FROM table_name WHERE ...) b ON a.code = b.code`

# python - How do you deploy django applications for windows?

> ID：681565
> 
> 赞同：7
> 
> 时间：2009-03-25T13:22:36.840
> 
> 标签：python, django, iis, deployment, isapi-wsgi

I'm working on a web application using [isapi_wsgi](http://code.google.com/p/isapi-wsgi/) and [django-pyodbc](http://code.google.com/p/django-pyodbc/). I'd like to have a way to install all dependencies and push the files out to the webserver. Unfortunately, some of these are easier said than done. In particular, handling dependencies is a pain as some of them won't install correctly even under setuptools (pywin32 is especially difficult).

Most of the tools that I see for automating this kind of stuff ([fabric](http://www.nongnu.org/fab/) and [capistrano](http://www.capify.org/)) are made for use with unix-y systems. I would like to set up a continuous integration system, but that only solves part of the problem. Is there any way to make life easier for a Pythonista who's forced to use Windows/IIS?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-08-09T19:51:46.780

BitNami 提供免费[的 Windows Django 一体化安装程序](http://bitnami.org/stack/djangostack)，其中包括在 Windows 上部署 Django 应用程序的所有依赖项。免责声明：我是该工具的开发人员之一。如果您要使用托管版本，我们还提供免费的 Windows Amazon 系统映像（在该页面的下方查看），但在这种情况下，我强烈建议您使用基于 Linux 的 AMI。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T13:38:03.010

Have you looked into [Paver](http://www.blueskyonmars.com/projects/paver/index.html)? It might not be the perfect solution, but maybe better then your current process.

And it has setuptools (and other useful wrappers) built-in.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-22T02:04:43.867

如今，在基于 Windows 的服务器上部署 Django Web 项目变得不那么麻烦了。这仍然具有挑战性，因为大多数指南都面向 Unix 系统，但在 Windows 服务器上部署并非不可能。微软现在为带有 IIS 的 Django 提供了一些原生支持。

但是，您不仅限于 IIS。您可以使用[Apache + mod_wsgi](https://docs.djangoproject.com/en/3.0/howto/deployment/wsgi/modwsgi/)。这是我自己的测试项目之一，您可以在 Apache[我的 web 项目](https://github.com/Johnnyboycurtis/webproject)上部署它。

*   指南：[在 Windows Server 2019 上使用 Apache 和 mod_wsgi 部署 Django](https://youtu.be/frEjX1DNSpc)

# c# - Polymorphism in WCF

> ID：681568
> 
> 赞同：13
> 
> 时间：2009-03-25T13:22:43.890
> 
> 标签：c#, wcf, polymorphism

I'm looking at building a WCF service that can store/retrieve a range of different types. Is the following example workable and also considered acceptable design:

```
[ServiceContract]
public interface IConnection
{        
   [OperationContract]
    IObject RetrieveObject(Guid ObjectID); 

   [OperationContract]
    Guid StoreObject(IObject NewObject); 

}

[ServiceContract]
[ServiceKnownType(IOne)]
[ServiceKnownType(ITwo)]
public interface IObject
{
    [DataMember]
    Guid ObjectID;

}

[ServiceContract]
public interface IOne:IObject
{
    [DataMember]
    String StringOne;

}

[ServiceContract]
public interface ITwo:IObject
{
    [DataMember]
    String StringTwo;

} 
```

When using the service, I would need to be able to pass the child types into the StoreObject method and get them back as their Child type from the RetrieveObject method.

Are there better options?

Thanks, Rob

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-25T14:22:23.903

您的示例将无法编译，因为接口不能包含字段，即 ObjectID、StringOne 和 StringTwo。您尝试使用 IObject、IOne 和 ITwo 定义的是数据合同，而不是服务合同。因此，您应该使用 DataContract 属性，而不是 ServiceContract 属性和类，而不是接口。

```
[DataContract]
[KnownType(typeof(MyOne))]
[KnownType(typeof(MyTwo))]
public class MyObject
{
    [DataMember]
    Guid ObjectID;
}
[DataContract]
public class MyOne : MyObject
{
    [DataMember]
    String StringOne;
}
[DataContract]
public class MyTwo : MyObject
{
    [DataMember]
    String StringTwo;
} 
```

请注意，这些是类，而不是接口。DataContract 属性已替换 ServiceContract 属性。KnownType 属性已替换 ServiceKnownType 属性。从我所看到的来看，这更规范。

然后，您的服务合同将定义如下：

```
[ServiceContract]
public interface IConnection
{
    [OperationContract]
    [ServiceKnownType(typeof(MyOne))]
    [ServiceKnownType(typeof(MyTwo))]
    MyObject RetrieveObject(Guid ObjectID);

    [OperationContract]
    [ServiceKnownType(typeof(MyOne))]
    [ServiceKnownType(typeof(MyTwo))]
    Guid StoreObject(MyObject NewObject);
} 
```

您可以将 ServiceKnownType 属性放在合同级别（即，在 ServiceContract 属性下），以使其适用于合同的所有操作。

```
[ServiceContract]
[ServiceKnownType(typeof(MyOne))]
[ServiceKnownType(typeof(MyTwo))]
public interface IConnection
{
    [OperationContract]
    MyObject RetrieveObject(Guid ObjectID);

    [OperationContract]
    Guid StoreObject(MyObject NewObject);
} 
```

您**可以**像这样在数据合约中使用接口：

```
interface IEmployee
{
    string FirstName
    { get; set; }
    string LastName
    { get; set; }
}
[DataContact]
class Employee : IEmployee
{...} 
```

但是，导出的元数据中不包含 IEmployee 接口。因此，如果您使用 svcutil 生成代理类，您的客户将不会知道 IEmployee。如果您的服务和客户端驻留在同一个应用程序中，这没什么大不了的（这是在应用程序域之间进行通信的好方法）。但是，如果您的客户端与您的服务是分开的（在绝大多数情况下，它将是），这将成为问题，因为您必须手动复制客户端上的 IEmployee 接口。

# windows - Windows：如何在特定机器上找到每个用户的 LocalAppData 目录？

> ID：681572
> 
> 赞同：1
> 
> 时间：2009-03-25T13:23:29.037
> 
> 标签：windows, lotus-notes

首先，一些背景：

我们的产品需要通过在 NOTES.INI 文件中添加或更新一行来与 Lotus Notes 客户端集成。

如果我们正在处理Notes 的单用户安装（即如果机器上有多个Windows 用户，他们都将使用相同的Notes 配置），我们没有问题。在这种情况下，Notes 安装目录中有一个 NOTES.INI 文件。

但是，在 Notes 的多用户安装下（每个 Windows 用户都有自己的 Notes 配置），每个用户都有自己的 NOTES.INI 文件存储在用户的 LocalAppData 目录中 - 例如 C:\Documents and Settings\Username\Local Settings \应用程序数据\Lotus\Notes。

那么问题来了：如果我们的产品安装在多用户安装 Notes 客户端的机器上，我们需要能够更新该机器上每个用户配置文件中的 NOTES.INI 文件。

我们可以通过在用户登录时运行一个程序来做到这一点，该程序检查该用户的 NOTES.INI 文件是否已经更新，如果没有，则更新它。但是，我们的应用程序的卸载过程需要能够为机器上的所有用户撤销这些修改。

因此问题是：假设我们的代码以本地管理员权限运行，是否有某种方法可以遍历每个用户的配置文件并找到他们的 LocalAppData 目录，以便我们进行必要的更改？

任何建议都非常感谢:-)

编辑 2009-03-25 16:52 GMT：
看起来我有一个可能的方法（感谢 Martin C）：

```
    对于HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList的每个子项：
      如果它是“真实”用户（以某种方式确定）：
        记住子键名——这是用户的 SID
        读取 ProfileImagePath 值
        如果用户的注册表配置单元尚未加载（即没有具有适当 SID的HKEY_USERS的子项）：
          启用SE_BACKUP_NAME和SE_RESTORE_NAME权限使用 RegLoadKey
          从ProfileImagePath\NtUser.dat加载配置单元
        尝试依次使用以下每个注册表项查找用户的 LocalAppData 文件夹：
          HKEY_USERS\<SID>\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell 文件夹
          HKEY_USERS\<SID>\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell 文件夹
          HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell 文件夹
          HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell 文件夹
        如有必要，在结果路径中展开环境变量（大概只是将 %USERPROFILE% 展开为我们之前得到的 ProfileImagePath）
        使用路径查找用户的 NOTES.INI 文件并进行适当的更改
        如果我们必须加载配置单元：
          使用 RegUnLoadKey 卸载蜂巢

```

我可能可以将其编码，但它似乎有点脆弱，并且可能有多种方法可能出错。有人有更“官方”的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T13:44:27.707

您可以枚举的子键

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList 
```

每个子项都包含“ProfileImagePath”，它将指向配置文件的基本路径。根据操作系统版本和语言设置，您可以确定 LocalAppData 的位置（注意，它取决于语言！）。

**编辑：**进一步发展的可能起点可能是

```
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders 
```

不幸的是，这可能因用户而异，并且 HKEY_USERS 仅包含已加载配置文件的用户的密钥。如果您可以以某种方式加载配置文件，您可以尝试（如果用户的注册表尚未加载到 HKEY_USERS，也许可以以某种方式附加用户的注册表？）。

# mysql - To check values in other databases using trigger

> ID：681573
> 
> 赞同：1
> 
> 时间：2009-03-25T13:23:30.393
> 
> 标签：mysql, triggers

Is it possible to check whether a particular value in a column exists in other databases using trigger? These two databases are located inside the same MYSQL instance. Specifically, what I want to do is this:

1.  Before a row is added to a table ( `Document_Index_table`) inside Database A ( `Document_DB`).
2.  A trigger is fired. This trigger carries the one of the column value (`usr_id`) inside the row and pass it to Database B ( `User_Control_DB`).
3.  Based on the values, `User_Control_DB` will check whether the `usr_id` exists in column `usr_id` of the table (`Usr_Information`).
4.  If exists, then return a true to `Document_DB` and the row in 1\. is allowed to add to the `Document_DB`.
5.  If not, then an error is issued. No row is added to `Document_DB`.

How can this be done, if it can be done at all?

**Edit: Both databases are MySQL databases**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T14:40:57.680

所以，我是数据库开发的新手，但你可以这样做：

在您的 document_index_table 上创建一个“之前”插入触发器。触发器执行以下操作：

```
declare numRows integer;
select count(*) from user_control_db.usr_information where usr_id = NEW.usr_id into num_rows;
if (numRows > 0) then
   call NonExistentProc();
end if; 
```

我相信这会实现你想要的。如果在用户控制数据库中没有至少一行具有匹配的 usr id，它将产生类似“PROCEDURE documentdb.NonExistenProc 不存在”的错误并跳过插入。

同样，我是这个数据库的新手，所以可能有一种更优雅的方式，但这适用于我的单个测试用例。

希望有帮助。

# javascript - JavaScript rounded corners with transparent background

> ID：681577
> 
> 赞同：2
> 
> 时间：2009-03-25T13:24:59.610
> 
> 标签：javascript, html, css, jquery-plugins

I'm looking for a JavaScript library that can create round corners on `div` tags with a transparent background, such that the background colour/image of the parent element is visible at the rounded corners. For an example of rounded corners **without** a transparent background, have a look at the left menu on [this page](http://chaletsdesbouleaux.com/). Notice that the background of the parent element is not shown at the corners of the menu items.

I need this to work in IE7+ and FF3+ (ideally the other browsers too), and I'd prefer a JQuery plugin.

Does anyone have any good resources or plugins that would help?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T13:30:15.947

[jQuery 角](http://plugins.jquery.com/project/corners)？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T23:07:14.627

我尝试了 2 个不同的 JQuery 圆角插件。[这个](http://www.malsup.com/jquery/corner/)在 FF 或 IE 中都不起作用，而[这个](http://plugins.jquery.com/project/corners)只在 FF 中起作用。

[但是，我发现了一个在DD_roundies](http://www.dillerdesign.com/experiment/DD_roundies/)中都能完美运行的非 JQuery 库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T14:12:50.603

它有很多限制......但是[透明背景角](http://plugins.jquery.com/project/transparentCorners)插件可能适用于您的场景。

但是，如果可以的话，我建议实际上使用 CSS 进行所有舍入服务器端。这只是 div 中的 div，角落 div 有不同的填充。它消除了 Safari 和 IE 对性能的巨大影响，如果你有很多舍入要做，并且允许你让页面对于不/不能启用 javascript 的用户仍然看起来很时尚。

# c# - Strip prefix and value

> ID：681582
> 
> 赞同：0
> 
> 时间：2009-03-25T13:25:39.360
> 
> 标签：c#

if I have the string "freq1" or "freq12" and so on, how can I strip out freq and also the number by itself?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T13:29:34.903

```
string foo     = "freq12";
string fooPart = foo.Substring(4);   // "12"
int fooNumber  = int.parse(fooPart); // 12 
```

如果“频率”部分不是常数，那么您可以使用正则表达式：

```
using System.Text.RegularExpressions;

string pattern = @"([A-Za-z]+)(\d+)";
string foo = "freq12";

Match match = Regex.Match(foo, pattern);

string fooPart = match.Groups[1].Value;
int fooNumber  = int.Parse(match.Groups[2].Value); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T13:30:39.020

是否总是将文本*频率*添加到字符串中的数字前面？如果是这样，您的解决方案非常简单：

```
var str = "freq12";
var num = int.Parse(str.Substring(4)); 
```

**编辑：**在字符串的第一部分并不总是“freq”的情况下，这是一种更通用的方法。

```
var str = "freq12";
int splitIndex;

for(splitIndex = 0; splitIndex < str.Length; splitIndex++)
{
    if (char.IsNumeric(str[splitIndex]))
        break;
}

if (splitIndex == str.Length)
    throw new InvalidOperationException("The input string does not contain a numeric part.");

var textPart = int.Parse(str.Substring(0, splitIndex));
var numPart = int.Parse(str.Substring(splitIndex)); 
```

在给定的示例中，`textPart`应评估为*freq*和*12*。如果这仍然不是你想要的，请告诉我。`numPart`

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T13:28:53.003

尝试这样的事情：

```
String oldString = "freq1";
String newString = oldString.Replace("freq", String.Empty); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T13:29:26.730

如果您知道“freq”这个词将永远存在，那么您可以执行以下操作：

```
string number = "freq1".Replace("freq",""); 
```

这将导致“1”。

# c# - INSERT 上的 SQL 注入

> ID：681583
> 
> 赞同：34
> 
> 时间：2009-03-25T13:25:42.323
> 
> 标签：c#, sql, sql-injection

我在我们公司的 Intranet 上创建了一个小型调查网页。此网页无法从外部访问。

该表单只是几个单选按钮和一个评论框。

我想保持良好的编码习惯，并想防范 SQL 注入。

SQL 注入可以发生在带有来自文本框的注释的插入语句上吗？如果是这样，我如何使用 .NET 2.0 来防范它？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-03-25T13:29:13.827

注入可能发生在任何运行不正常的 SQL 语句上。

例如，假设您的评论表有两个字段，一个整数 ID 和评论字符串。所以你会`INSERT`如下：

```
 INSERT INTO COMMENTS VALUES(122,'I like this website'); 
```

考虑有人输入以下评论：

```
'); DELETE FROM users; -- 
```

如果您只是将注释字符串放入 SQL 中而不进行任何处理，这可能会将您的单曲`INSERT`转换为以下两个语句，然后是注释：

```
INSERT INTO COMMENTS VALUES(123,''); DELETE FROM users; -- '); 
```

这将从您的`users`表中删除所有内容。有些人愿意花一整天时间寻找正确的表名来使用试错法和各种技巧来清空。 [下面是关于如何执行 SQL 注入攻击的描述。](http://www.securiteam.com/securityreviews/5DP0N1P76E.html)

您需要使用[参数化的 SQL 语句](https://blog.codinghorror.com/give-me-parameterized-sql-or-give-me-death/)来防止这种情况。

这不仅仅是出于安全原因。例如，如果您天真地创建 SQL 语句，请使用以下注释：

```
I'm just loving this website 
```

将导致 SQL 语法错误，因为 SQL 将撇号解释为结束引号。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-03-25T13:29:09.147

使用参数化查询，以便自动为您引用文本。

```
SqlCommand command = connection.CreateCommand();
command.CommandText = "insert into dbo.Table (val1,val2,txt) values (@val1,@val2,@txt)";
command.AddParameterWithValue( "val1", value1 );
command.AddParameterWithValue( "val2", value2 );
command.AddParameterWithValue( "txt", text );

... 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T14:35:28.740

每当您将查询传递回数据库时，都可能发生 SQL 注入。这是一个简单的演示：

[SQL 注入解释](http://www.jumpstarttv.com/sql-injection-explained_580.aspx)

在 .NET 中，关键是按照 Dave Webb 的规定去做。它将通过包含整个字符串作为要提交的一个参数来防止注入尝试，处理所有可能被 SQL Server 解释以更改查询或附加其他命令的字符。

需要指出的是，SQL 注入可以发生在任何应用程序上，而不仅仅是 Web 应用程序。内部攻击通常对组织来说是最昂贵的。人们不能安全地假设攻击不会来自内部。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T14:21:35.327

除了使用准备好的语句和参数而不是将字符串连接到 SQL 中之外，您还应该执行以下操作：

1.  在服务器端验证和格式化用户输入。使用 WebScarab 之类的工具或通过欺骗您的表单可以轻松绕过客户端验证和限制。

2.  为数据库用户帐户配置适当的权限。Web 应用程序应在您的数据库中使用单独的帐户或角色，其权限仅限于运行您的应用程序所需的表、视图和过程。确保用户对系统表没有选择权限

3.  向用户隐藏详细的错误消息，并为您的对象使用不太常见的名称。令我惊讶的是，您多久可以确定服务器类型（oracle、mysql、sqlserver）并在错误消息中找到基本模式信息，然后从名为“user(s)”、“employee(s)”的表中获取信息。如果您没有像 (2) 那样设置您的权限，并且我可以确定您的服务器类型，那么您对 ​​SQL Server 的此类语句持开放态度

    从 information_schema.table 中选择表名

    执行 sp_help foundTableName

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T13:33:33.210

是的，它们可能发生。防止这种情况发生的最简单方法是使用准备好的语句，而不是手动构建 SQL。

所以，而不是这样：

```
String sql = 
 String.Format("INSERT INTO mytable (text_column) VALUES ( '{0}' )",
   myTextBox.Text); // Unsafe! 
```

你会做这样的事情：

```
String sql = "INSERT INTO mytable (text_column) VALUES ( ? )"; // Much safer 
```

然后将文本框的文本作为参数添加到您的 DbCommand 中，这将导致它自动转义并替换“？” 在 SQL 中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-30T11:21:34.203

使用准备好的语句防止 SQL 注入。placehoder(?) 的使用完全消除了sql注入漏洞。示例 **String sql=Select * from user_table where username='+request.getparameter("username")+'; statement.executeQuery(sql);**

上面的语句容易受到sql注入。

为了防止sql注入。按照片段使用

**String sql=Select * from user_table where username=?; statement.setString(1,username);**

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-25T13:32:50.450

是的，它可以。假设客户端发送这个：

```
OR 1 = 1 
```

这对你来说可能是非常痛苦的

```
 SELECT * FROM admin WHERE name = @name AND password = @password 
```

你可以用

*   使用 ADO.NET 中的 Parameter 类
*   使用正则表达式
*   阅读，阅读： http: [//www.codeproject.com/KB/database/SqlInjectionAttacks.aspx](http://www.codeproject.com/KB/database/SqlInjectionAttacks.aspx)

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2009-03-25T13:31:14.120

防止这种形式的 SQL 注入的最简单方法是使用参数和存储过程，而不是构建 sql 语句来运行。（在 C# 中或在 SQL Server 内部）。

但是，我不完全确定您是否应该花时间在这方面，除非这是您的公司政策，因为它在内部发生的机会充其量是最小的，如果确实发生了，我希望您能立即知道是谁它是。

# c# - 如何创建一个类似于数据表但没有开销的简单类？

> ID：681586
> 
> 赞同：-3
> 
> 时间：2009-03-25T13:26:08.907
> 
> 标签：c#, .net, ado.net, datatable

我想创建一个类似于数据表的简单类，但没有开销。

因此，使用 sqldatareader 加载对象，然后返回这个自定义的类似数据表的对象，它可以让我访问如下行和列：

```
myObject[rowID]["columnname"] 
```

您将如何创建这样的对象？

除了访问数据的行和列之外，我不希望该对象有任何内置方法/行为。

### 更新：

我不想要数据，我想要更精简的东西（另外我想学习如何创建这样的对象）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T13:29:55.013

可以使用以下类型签名轻松创建这种类型的结构：

```
List<Dictionary<string, object>> 
```

这将允许您指定的访问，并且应该很容易填充。

您始终可以创建一个继承自 List < Dictionary < string, object >> 的对象，并实现一个采用 SqlDataReader 的构造函数。这个构造函数应该为每一行创建一个 enw 字典，并为每一列插入一个新条目到字典中，使用列名作为键。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T13:41:44.953

I think you're missing something about how .Net works. The extra overhead involved in a DataTable is not significant. Can you point to a specific performance problem in existing code that you believe is caused by a datatable? Perhaps we can help correct that in a more elegant way.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T16:00:52.130

`Dictionary<int,object[]>`会比`List<Dictionary<string, object>>`。您实际上并不需要每一行的字典，因为所有行的列名都是相同的。如果你想让它轻量级，你应该使用列索引而不是名称。

因此，如果您有一列“名称”是第 3 列，要从行 ID 10 获取其值“名称”，代码将是：

```
object val = table[10][2]; 
```

另一种选择是`SortedList<int,object[]>`......取决于您访问数据的方式（仅转发或随机访问）。

您也可以`MultiDictionary<int,object>`使用[PowerCollections](http://www.codeplex.com/PowerCollections)。

从内存使用的角度来看，我认为最好的选择是使用具有一些松弛容量的单维数组。因此，在每行之后，比如 100 行，您将创建一个新数组，将旧内容复制到其中并在最后留下 100 个空行。但是当您删除一行时，您必须保留某种索引，以便在不调整数组大小的情况下将其标记为已删除。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T15:45:42.290

`["whatever"]`也许您要问的具体问题是如何在您自己的表对象中使用方便的索引语法。

如果是这样，我建议您参考索引器上的[这个 MSDN 页面](http://msdn.microsoft.com/en-us/library/6x16t2tx.aspx)。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-25T13:29:41.003

这不是数据集/数据表吗？也许我没有得到这个问题。另外，编程语言是什么？

# networking - 透明代理 telnet 流量？

> ID：681587
> 
> 赞同：1
> 
> 时间：2009-03-25T13:26:45.207
> 
> 标签：networking, firewall, network-protocols, telnet, iptables

我们编写了一个工具来代理 telnet 流量，并分叉入站/出站流以进行记录（这是一个测试遗留系统的测试工具）。然而，我们遇到了障碍。在某些情况下，遗留系统依赖于知道客户端的 IP 地址，但是当我们使用代理时，客户端的地址全部更改为代理的地址。由于我们控制遗留系统用作网关的机器，我想知道是否没有某种方法可以通过 iptables 或其他一些数据包处理技术来欺骗它。所以，换句话说，没有代理我们有：

```
[CLIENT A - 172.16.2.2]------|
[CLIENT B - 172.16.2.3]------|------------[SERVER sees CLIENT A as 172.16.2.2, B as 2.3, so on]
[CLIENT C - 172.16.2.4]------| 
```

使用代理我们得到：

```
[CLIENT A - 172.16.2.2]---|
[CLIENT B - 172.16.2.3]---|---[PROXY 172.16.2.5]--[SERVER sees all clients as 172.16.2.5]
[CLIENT C - 172.16.2.4]---| 
```

我们需要的：

```
[CLIENT A - 172.16.2.2]---|
[CLIENT B - 172.16.2.3]---|---[PROXY 172.16.2.5]--[SERVER sees CLIENT A as 172.16.2.2, so on]
[CLIENT C - 172.16.2.4]---| 
```

有没有办法做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T13:30:34.667

这个问题与编程无关。

但是您可以使用 Linux 内核工具 TPROXY 来做到这一点，我相信它是独立于 Linux 分发的。

TPROXY 让您透明地代理流量，使客户端和服务器看到自己的原始 IP 地址。你也可以做其他的技巧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T13:30:49.283

除了使用代理，您可以将网卡置于混杂模式并使用 tcpdump 或类似的东西来捕获正在发生的事情吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T13:34:28.700

一些 NATing 怎么样：服务器真的需要查看客户端的确切 IP 还是只是唯一的 IP？如果没有，如何做：

```
172.16.88.2                     --- 172.16.2.2
172.16.88.3   ---  PROXY        --- 172.16.2.3   --- SERVER
172.16.88.4       w/ 3 IPs      --- 172.16.2.4 
```

# c# - 在 C# 中使用 C++ CLI 模板类

> ID：681590
> 
> 赞同：9
> 
> 时间：2009-03-25T13:27:03.520
> 
> 标签：c#, .net, c++-cli

我在 C++/CLI 中有以下类和 int 原语的显式模板实例化..

```
template<typename T>
public ref class Number
{
    T _value;
public:
    static property T MinValue
    {
        T get()
        {
            return T::MinValue;
        }
    }

    static property T MaxValue
    {
        T get()
        {
            return T::MaxValue;
        }
    }

    property T Value
    {
        T get()
        {
            return _value;
        }

        void set(T value)
        {
            if( value<MinValue || value > MaxValue)
                throw gcnew System::ArgumentException("Value out of range");

            _value = value;
        }
    }

};

template ref class Number<int>; 
```

在编译它并使用反射器检查生成的程序集时，我能够看到一个调用的类，`Number<int>`但是在尝试在 C# 中实例化同一个类时，编译器抱怨某些`System::Number`类没有使用模板参数。我究竟做错了什么？这完全可以做到吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-25T13:47:32.100

我有一个解决方法，声明一个继承该类的附加`Number<int>`类。此类现在在 C# 中可见并且可以实例化。

```
public ref class MyInt32 : public Number<int>
{
}; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-25T13:58:47.797

反光板有点*躺在这里。*类的名称实际上不是 Number<int>。它实际上是“数字<int>”。注意单引号。这些仅在您使用 ildasm 查看类型名称时可见。

我**相信**这样做是为了使大多数语言中的类型不可绑定，因为他们无法理解 C++ 模板的实际工作原理。这使得它只对合适的 C++ 编译器有效，因为它是唯一真正支持模板（模板！=泛型）的 MS 编译器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T13:48:45.793

如果您的目标是在 C++ CLI 中创建参数化类型，然后在 C# 中使用该类型，我认为您需要创建泛型类型而不是模板类型（有关两种方法存在的原因，请参阅[Stan Lippman 的博客）。](http://blogs.msdn.com/slippman/archive/2004/08/05/209606.aspx)有关如何在 C++ CLI 中创建泛型类型的信息，请参阅[此处。](http://msdn.microsoft.com/en-us/library/8z2kbc1y.aspx)

# oop - 接口和抽象类有什么区别？

> ID：681602
> 
> 赞同：0
> 
> 时间：2009-03-25T13:29:22.847
> 
> 标签：oop, interface, abstract-class

### 复制：

> [何时使用接口而不是抽象类，反之亦然？](https://stackoverflow.com/questions/479142/when-to-use-an-interface-instead-of-an-abstract-class-and-vice-versa)

可能是最著名的软件开发人员工作面试问题之一。

你的答案是什么？

**编辑：**我试图找出你会如何在现实生活中回答这个问题。请尝试像在真实的工作面试中一样制定您的答案（要完整，但不要太长，当然不要发布链接）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-25T13:36:29.257

An interface only describes the actual signature of its methods etc. Any class implementing that interface must then provide an explicit implementation.

An abstract class can contain a partial implementation of its methods etc.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T14:06:20.603

接口提供了必须由类实现的方法的定义。接口的目的是允许您概括特定功能，而不管实现如何。您可能有一个具有/方法的`IDatabase`接口。实现该接口的类可能连接到 MySQL 数据库或 MS Access 数据库。不管它*如何*完成这个任务，目标还是一样的……打开数据库，关闭数据库。`Open``Close`

 *抽象类是包含一些抽象方法的基类。它们不能被实例化，它们将被派生出来。抽象类的目的是允许您定义一些通用功能和子类以在适当的情况下实现更具体的功能。

所以总而言之，当每个类的实现完全不同时，你应该使用接口。当您有一些类似的行为但需要以不同的方式实现部分时，请使用抽象类。

希望有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T13:32:38.610

抽象类可以有成员变量，接口不能（或者，在 C++ 中*不应该*）。

在 Java 中，“接口”是定义良好的句法元素，而在 C++ 中，它只是一种设计模式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T13:36:19.897

As far as job interviews are concerned, I've always heard that the key point is that an interface is a contract; an interface, while not implementing it itself, guarantees functionality.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T13:32:10.920

我会说差异取决于语言，但至少在 C++ 中，抽象类是实现接口的手段。

# java - 如何找到不属于任何套件的单元测试？

> ID：681618
> 
> 赞同：3
> 
> 时间：2009-03-25T13:32:29.903
> 
> 标签：java, unit-testing, junit

使用 JUnit 3，如果您忘记向套件添加测试，它将无法运行。我怎样才能找到不属于我们的顶级套件的所有 JUnit 测试用例，或者它递归包含的任何套件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T17:30:10.047

最简单的方法是使用 ant junit 任务和测试命名约定（例如匹配 *Test.java）。

然后你可以告诉 junit 在你的项目中运行 *Test.java 中的每个测试。下面是从[ant 手册](http://ant.apache.org/)中截取的截断示例。

```
<junit printsummary="yes" haltonfailure="yes">
  <classpath>
    <pathelement location="${build.tests}"/>
    <pathelement path="${java.class.path}"/>
  </classpath>

  <formatter type="plain"/>

  <batchtest fork="yes" todir="${reports.tests}">
    <fileset dir="${src.tests}">
      <include name="**/*Test*.java"/>
      <exclude name="**/AllTests.java"/>
    </fileset>
  </batchtest>
</junit> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T14:15:04.263

使用[UCDetector](http://www.ucdetector.org/)，您应该能够从 Eclipse 中识别未使用的公共类（包括未使用的 TestCases）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T23:08:27.143

我们在项目中所做的是遍历所有类文件并查看扩展的 TestCase（您引用该文件，执行 Class clazz = Class.forName() 然后执行 Test.isAssignableFrom(clazz) 来检查。

它肯定会变得混乱（例如，有时某些东西是不应该运行的基类，并且必须标记它们）。

知道它是否在一个套件中更加困难。我会使用我自己的套件构建器类并要求使用它构建所有套件，并向其添加逻辑以记录构建器引用的所有现有类，然后将它们传递给检查器，检查器知道它们已被计入为了。

问题是所有这些都在 JUnit4 中中断，使其成为即时遗留代码。

最好、最稳定的解决方案（在 JUnit 解决其套件构建问题之前）是拥有一种开发文化，即使用命名转换来命名所有测试（标准以 Test 结尾）并让 Ant 运行它们，或者在开发test 仅通过套件运行它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-01T22:06:53.263

包含您的测试包的代码覆盖率将拾取任何未运行的测试类

# delphi - 在 Delphi 2009 应用程序中隐藏主窗体

> ID：681621
> 
> 赞同：8
> 
> 时间：2009-03-25T13:32:55.193
> 
> 标签：delphi, delphi-2009, vcl

以下代码在 Delphi 7 中运行良好。然而，在 Delphi 2009 中，表单确实保持隐藏状态，但任务栏上的按钮现在出现了。

```
ShowWindow(Handle, SW_HIDE);
SetWindowLong(Handle, GWL_EXSTYLE, GetWindowLong(Handle, GWL_EXSTYLE) or WS_EX_TOOLWINDOW );
ShowWindow(Handle, SW_SHOW); 
```

上面的代码是在 FormCreate 方法中调用的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-28T08:10:46.010

原来我们在任务栏上看到“应用程序”窗口的原因是一个简单的设置，类似于 stukelly 的答案，但不完全是。

要使主窗体出现在任务栏上并隐藏您应用的应用程序菜单：

```
Application.MainFormOnTaskbar := True;
Application.ShowMainForm := False; 
```

表单创建后没有代码或任何需要的代码。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-26T01:26:53.120

在创建表单之前，您需要将[ShowMainForm](http://docs.embarcadero.com/products/rad_studio/radstudio2007/RS2007_helpupdates/HUpdate3/EN/html/delphivclwin32/Forms_TApplication_ShowMainForm.html)和[MainFormOnTaskBar](http://docs.embarcadero.com/products/rad_studio/radstudio2007/RS2007_helpupdates/HUpdate3/EN/html/delphivclwin32/Forms_TApplication_MainFormOnTaskBar.html)属性设置为 False。

在创建表单之前，打开您的项目源并将**MainFormOnTaskBar**和**ShowMainForm**设置为 False。

```
Application.Initialize;
Application.MainFormOnTaskbar := false;
Application.ShowMainForm := false;
Application.CreateForm(TForm1, Form1); 
```

然后在您的主窗体上将以下代码添加到**FormActivate**和**FormShow**事件中。

```
procedure TForm1.FormActivate(Sender: TObject);
begin
 // hide taskbar button
 ShowWindow(Application.Handle, SW_HIDE);
end;
procedure TForm1.FormShow(Sender: TObject);
begin
 // hide taskbar button
 ShowWindow(Application.Handle, SW_HIDE);
end; 
```

我已经使用 Dephi 2007 和 2009 进行了测试。更多信息可[在此处](http://delphi.about.com/od/delphitips2008/qt/hide_taskbutton.htm)获得。

# tfs - TFS 分支/合并符合历史视图

> ID：681630
> 
> 赞同：14
> 
> 时间：2009-03-25T13:34:35.187
> 
> 标签：tfs, merge, branch

我们在最近迁移到从 VSS 的 TFS 系统中有一个带有开发“主干”的设置，开发人员一直在主干的分支中工作，这些分支被合并回。

在签入时，我们一直在努力评论我们的变更集，这是我们在 VSS 时代从未做过的事情。但是，当我在源代码管理资源管理器中右键单击主干文件并选择历史记录时，我只看到标记为“从开发分支合并”的整体变更集（或者开发人员在合并时在那里乱写的任何内容。）历史条目没有甚至似乎包含有关当时合并了*哪个分支的信息，更不用说有关组成它的变更集的任何信息，或者与它们一起出现的注释。*

其他 TFS 用户是如何处理这个问题的？

还有其他方法可以查看我在这里丢失的历史记录吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-25T14:24:45.053

查看合并之前的更改历史一直是 TFS 的一个痛点。以至于微软在下一个版本的 TFS（TFS 2010）中做了很多工作来解决这个问题。在 TFS 2010 中（当它出现时），当您在历史视图中进行合并时，实际上有点曲折，您可以展开并查看已合并事物的历史记录，这会更好。

同时，当我看到我的大型单体合并（或分支）注释时，我倾向于发出一声叹息，然后在源代码管理资源管理器中找到它合并的分支中的文件并在那里查看历史记录。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-25T14:19:53.817

这可能是您正在寻找的：http: [//www.codeplex.com/TFSBranchHistory](http://www.codeplex.com/TFSBranchHistory)

没有亲自使用过，所以不能保证。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-09-23T10:09:48.507

访问 Microsoft Gallery 中的“TFS 分支历史”插件页面：

[http://visualstudiogallery.msdn.microsoft.com/7d4f37b6-f9a4-44c6-b0a0-994956538a44](http://visualstudiogallery.msdn.microsoft.com/7d4f37b6-f9a4-44c6-b0a0-994956538a44)

插件确实将“分支历史”按钮插入到源代码管理资源管理器 (TFS) 的上下文菜单中

按钮图标与标准“历史”一样带有时钟，但带有蓝色箭头：

![分支历史按钮](https://i.stack.imgur.com/fRrly.png)

如果单击“Branched History”，将打开新窗口并将 Path 属性设置为当前 Source Control Explorer 路径：

![在此处输入图像描述](https://i.stack.imgur.com/IiZJP.png)

单击“运行查询”以在“历史记录”选项卡中获取结果：

![在此处输入图像描述](https://i.stack.imgur.com/PNT4M.png)

从上下文菜单中，您可以查询标准变更集详细信息和比较文件（文件夹）对话框。

# ruby-on-rails - 如何将 Rails 提交到我的 gemmed 版本中

> ID：681643
> 
> 赞同：2
> 
> 时间：2009-03-25T13:38:37.300
> 
> 标签：ruby-on-rails, ruby

Rails 2.3 上周发布，我使用 gem install rails 安装了它。一切正常。但是，我注意到了一个错误，所以我搜索了一下，果然 2 天前接受了一个新的提交，它修复了我看到的相同错误。

如何将这些最新更改添加到我在本地运行的 Rails 版本中？

我尝试了 gem update rails --include-dependencies 但它没有更新 rails （我假设因为我已经拥有最新的 gem 2.3.2）。那么，如何才能将最后几个提交放入我的 rails 版本？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T13:54:36.793

我从未使用过 Edge Rails，但我想这就是您需要做的。Edge 是最后一次提交，可能还有其他错误。

如果更改很小，只需编辑代码。完成此操作后，您可能可以在编辑 gem 后冻结它们，但我不确定冻结是否会冻结 rails 代码本身。如果确实如此，那么一切都应该可以正常工作，否则您还需要在生产 gem 上对其进行编辑。

希望这会有所帮助，毫无疑问会有一些 Rails Edge 大神来告诉我们简单的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T23:42:34.523

如果您使用 git 来检查版本，那么您可以使用 git cherry-pick 来获取您想要用于您自己的个人树的特定补丁。google for git cherry-pick 了解更多信息（如果您不熟悉 git，那么值得学习！）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T18:47:35.840

我在这里找到了一些全面的说明：

[http://www.napcsweb.com/blog/2008/04/24/create-a-new-edge-rails-project](http://www.napcsweb.com/blog/2008/04/24/create-a-new-edge-rails-project)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T05:15:54.593

如果您将 rails 冻结到 2.3.2 版本，您可以自己编辑文件并确保您的应用程序将使用该编辑版本的 rails。

# apache-flex - 调用 getter 而不将其分配给任何东西（延迟加载）

> ID：681647
> 
> 赞同：2
> 
> 时间：2009-03-25T13:40:24.550
> 
> 标签：apache-flex, lazy-loading, dto

我有一个可以使用延迟加载模式完全加载或延迟加载的 DTO。它的加载方式取决于 Flex 应用程序的需求。但是，此 DTO 将被发送到 Flex 应用程序 (swf)。通常，例如一个集合，只会在调用时加载。然而，在我的情况下，集合只会在 Flex 中调用，因此我在 .NET 端的实现显然在这种情况下不起作用（除非 Flex 会进行服务器调用......我想避免的事情）。

在集合的 getter 中，从数据库中检索数据。如果我将使用 ASP.NET 页面，它会起作用，但如果 DTO 被发送到 Flex，则不会。

你会如何处理这个问题？我可以在将 DTO 发送到 Flex 之前调用 getter，但这似乎很糟糕...... + 只有在将 getter 分配给某些东西时才能调用 getter（并且永远不会使用将保存集合的局部变量...... ）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T13:50:19.970

您可以引入一种加载依赖项的方法 -`loadDependencies`在通过线路发送（到 Flex）之前，它应该为您的 DTO 对象进行所有延迟加载。您可以将此方法抽象为一个接口，以简化跨不同 DTO 的此类过程。按照您在此方法中描述的方式使用 getter 并没有什么反对的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T13:48:26.060

我可能会为该类引入一个`Finalize`方法，也可能为该类`FinalizeAll`的各种集合引入一个扩展方法。此方法将简单地遍历并引用类的公共属性上的所有 getter，以确保它们被加载。您将在将对象发送到您的 Flex 应用程序之前调用`Finalize`(或`FinalizeAll`)。您甚至可能希望将其设为接口，以便您可以在传输对象之前测试是否需要完成，并根据接口测试调用方法，而不是单独检查每个类。

注意：Finalize 只是浮现在脑海中的第一个名字。可能（可能）有一个更好的名字。

# python - string.find 在 CPython 中是如何实现的？

> ID：681649
> 
> 赞同：10
> 
> 时间：2009-03-25T13:41:42.270
> 
> 标签：python

我想知道字符串上的“查找”方法是否是通过线性搜索实现的，或者 python 是否做了更复杂的事情。Python 文档没有讨论实现细节，所以[http://docs.python.org/library/stdtypes.html](http://docs.python.org/library/stdtypes.html)没有帮助。有人可以指点我相关的源代码吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-25T13:49:00.270

对实施的评论有以下说法：

> 快速搜索/计数实现，基于 boyer-moore 和 horspool 之间的混合，顶部还有一些花里胡哨。
> 
> 有关更多背景信息，请参阅：[http ://effbot.org/zone/stringlib.htm](http://effbot.org/zone/stringlib.htm)

—<a href="https://github.com/python/cpython/blob/master/Objects/stringlib/fastsearch.h#L5" rel="nofollow noreferrer">https://github.com/python/cpython /blob/master/Objects/stringlib/fastsearch.h#L5

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-25T13:49:25.137

您应该能够在 Objects/stringlib/find.h 中找到它，尽管真正的代码在 fastsearch.h 中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T14:40:26.357

看起来使用的算法源自[Boyer-Moore-Horspool 算法](http://en.wikipedia.org/wiki/Boyer%E2%80%93Moore%E2%80%93Horspool_algorithm)

# c# - 您可以从 SqlDataReader 获取列名吗？

> ID：681653
> 
> 赞同：303
> 
> 时间：2009-03-25T13:43:31.487
> 
> 标签：c#, ado.net, sqldatareader

连接到数据库后，我可以得到我的所有返回的列的名称`SqlDataReader`吗？

* * *

## 回答 #1

> 赞同：501
> 
> 时间：2009-03-25T13:50:06.757

```
var reader = cmd.ExecuteReader();

var columns = new List<string>();

for(int i=0;i<reader.FieldCount;i++)
{
   columns.Add(reader.GetName(i));
} 
```

或者

```
var columns = Enumerable.Range(0, reader.FieldCount).Select(reader.GetName).ToList(); 
```

* * *

## 回答 #2

> 赞同：83
> 
> 时间：2009-03-25T13:48:33.547

有一个`GetName`函数`SqlDataReader`接受列索引并返回列的名称。

相反，有一个`GetOrdinal`接受列名并返回列索引的方法。

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2009-03-25T13:49:30.707

您可以从 DataReader 获取列名。

这是重要的部分：

```
 for (int col = 0; col < SqlReader.FieldCount; col++)
  {
    Console.Write(SqlReader.GetName(col).ToString());         // Gets the column name
    Console.Write(SqlReader.GetFieldType(col).ToString());    // Gets the column type
    Console.Write(SqlReader.GetDataTypeName(col).ToString()); // Gets the column database type
  } 
```

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2013-12-12T14:44:46.710

已经提到了。只是一个[LINQ](http://en.wikipedia.org/wiki/Language_Integrated_Query)答案：

```
var columns = reader.GetSchemaTable().Rows
                                     .Cast<DataRow>()
                                     .Select(r => (string)r["ColumnName"])
                                     .ToList();

//Or

var columns = Enumerable.Range(0, reader.FieldCount)
                        .Select(reader.GetName)
                        .ToList(); 
```

第二个更干净，更快。即使您`GetSchemaTable`在第一种方法中缓存，查询也会非常慢。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-08-29T16:59:06.620

如果您只想要列名，您可以执行以下操作：

```
List<string> columns = new List<string>();
using (SqlDataReader reader = cmd.ExecuteReader(CommandBehavior.SchemaOnly))
{
    DataTable dt = reader.GetSchemaTable();
    foreach (DataRow row in dt.Rows)
    {
        columns.Add(row.Field<String>("ColumnName"));
    }
} 
```

但如果你只需要一排，我喜欢我的 AdoHelper 添加。如果您有单行查询并且不想在代码中处理数据表，则此添加非常有用。它返回一个不区分大小写的列名和值字典。

```
public static Dictionary<string, string> ExecuteCaseInsensitiveDictionary(string query, string connectionString, Dictionary<string, string> queryParams = null)
{
    Dictionary<string, string> CaseInsensitiveDictionary = new Dictionary<string, string>(StringComparer.OrdinalIgnoreCase);
    try
    {
        using (SqlConnection conn = new SqlConnection(connectionString))
        {
            conn.Open();
            using (SqlCommand cmd = new SqlCommand())
            {
                cmd.Connection = conn;
                cmd.CommandType = CommandType.Text;
                cmd.CommandText = query;

                // Add the parameters for the SelectCommand.
                if (queryParams != null)
                    foreach (var param in queryParams)
                        cmd.Parameters.AddWithValue(param.Key, param.Value);

                using (SqlDataReader reader = cmd.ExecuteReader())
                {
                    DataTable dt = new DataTable();
                    dt.Load(reader);
                    foreach (DataRow row in dt.Rows)
                    {
                        foreach (DataColumn column in dt.Columns)
                        {
                            CaseInsensitiveDictionary.Add(column.ColumnName, row[column].ToString());
                        }
                    }
                }
            }
            conn.Close();
        }
    }
    catch (Exception ex)
    {
        throw ex;
    }
    return CaseInsensitiveDictionary;
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-10-07T14:58:55.560

使用扩展方法：

```
 public static List<string> ColumnList(this IDataReader dataReader)
    {
        var columns = new List<string>();
        for (int i = 0; i < dataReader.FieldCount; i++)
        {
            columns.Add(dataReader.GetName(i));
        }
        return columns;
    } 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2021-01-05T04:21:47.867

对我来说，我会写一个这样的扩展方法：

```
public static string[] GetFieldNames(this SqlDataReader reader)
{
     return Enumerable.Range(0, reader.FieldCount).Select(x => reader.GetName(x)).ToArray();
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-09-17T06:48:00.257

我使用通过 IDataReader 接口公开的[GetSchemaTable](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.getschematable.aspx)方法。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-25T13:51:11.187

你当然可以。

```
 protected void GetColumNames_DataReader()
{
  System.Data.SqlClient.SqlConnection SqlCon = new System.Data.SqlClient.SqlConnection("server=localhost;database=northwind;trusted_connection=true");
  System.Data.SqlClient.SqlCommand SqlCmd = new System.Data.SqlClient.SqlCommand("SELECT * FROM Products", SqlCon);

  SqlCon.Open();

  System.Data.SqlClient.SqlDataReader SqlReader = SqlCmd.ExecuteReader();
  System.Int32 _columncount = SqlReader.FieldCount;

  System.Web.HttpContext.Current.Response.Write("SqlDataReader Columns");
  System.Web.HttpContext.Current.Response.Write(" ");

  for ( System.Int32 iCol = 0; iCol < _columncount; iCol ++ )
  {
    System.Web.HttpContext.Current.Response.Write("Column " + iCol.ToString() + ": ");
    System.Web.HttpContext.Current.Response.Write(SqlReader.GetName( iCol ).ToString());
    System.Web.HttpContext.Current.Response.Write(" ");
  }

} 
```

这最初来自： http: [//www.dotnetjunkies.ddj.com/Article/B82A22D1-8437-4C7A-B6AA-C6C9BE9DB8A6.dcik](http://www.dotnetjunkies.ddj.com/Article/B82A22D1-8437-4C7A-B6AA-C6C9BE9DB8A6.dcik "如何使用 DataReader 和 DataSet 检索列名")

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-04-12T12:02:16.873

在 SQL 中更容易实现

```
var columnsList = dbContext.Database.SqlQuery<string>("SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = 'SCHEMA_OF_YOUE_TABLE' AND TABLE_NAME = 'YOUR_TABLE_NAME'").ToList(); 
```

# javascript - 我可以创建一个带有图标的书签按钮吗？

> ID：681655
> 
> 赞同：0
> 
> 时间：2009-03-25T13:44:25.507
> 
> 标签：javascript, mozilla

我可以创建一个带有图标的书签按钮吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T13:52:00.293

不是自动的；见[SO #521040](https://stackoverflow.com/questions/521040/how-to-have-favicon-icon-set-when-bookmarklet-dragged-to-toolbar)

用户可以在使用 Stylish 或 Favicon Picker 添加 Firefox 后设置 favicon，但似乎无法在书签中包含一个。这是有道理的，因为代码是从您的浏览器运行的，而不是从任何网络主机运行的，因此代码没有域可以引用图标。

# asp.net - ASP.NET Web 应用程序中的多个 Web.Config 文件

> ID：681664
> 
> 赞同：2
> 
> 时间：2009-03-25T13:48:50.083
> 
> 标签：asp.net, web-config

我有一个 ASP.NET Web 应用程序，我在根文件夹中有多个子目录。在我的根 web.config 中，我将 sessionMode 设置为 "StateServer" 。所以在我的子目录的一页中，我无法进行序列化。如果我将 SessionMode 方法更改为 "InProc" ，它将正常工作。我想保持根目录中的 web.config 文件原样。所以我计划在子目录中有另一个 web.config 文件。谁能告诉我该怎么做？

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T13:55:08.867

虽然您可以在每个子目录中都有一个 Web.config，但并非所有级别都允许所有设置。

SessionMode 是一种只能在应用程序根中进行的设置。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-25T13:51:13.433

您只需在子目录中放置一个新的 web.config 文件，ASP.NET 将覆盖您在该目录中更改的任何设置。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-25T13:51:34.493

如果您使用 [Serializable] 属性标记要放入 Session 的类，它通常可以在 StateServer 设置中使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T13:52:09.297

只需将另一个 web.config 放在子目录中即可。ASP.NET 允许这样做，我的网站上有几个区域，其中 web.config 包含专门针对该“应用程序”的值。

那说：

1）您确定以两种不同的方式维护状态是个好主意吗？弄清楚如何使您的会话状态可序列化或完全摆脱使用会话状态可能会更好。

2）如果您不注意在每个文件中输入的值，那么所有这些 web.config 文件都很难维护。

# php - Drupal CCK：如何输出带有字段的节点预告片？

> ID：681676
> 
> 赞同：1
> 
> 时间：2009-03-25T13:51:02.060
> 
> 标签：php, drupal, drupal-6, cck

在我的一个模块中，我想输出节点预告片。该节点具有 CCK 字段，我希望它们根据您可以在内容类型/字段设置管理区域中选择的可见性设置进行显示。

但是当我这样做时：

```
$html = theme('node', $n); 
```

生成的预告片将不包含 CCK 字段，仅包含标题和正文。

我还需要调用哪些其他主题功能？

节点包含图像和节点引用等字段。我想我可以手动编写 HTML，但在我看来最好使用提供的主题功能......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T15:23:07.797

[http://api.drupal.org/api/function/node_view/6](http://api.drupal.org/api/function/node_view/6)

```
$node = node_load($n);
$html = node_view($node,TRUE); 
```

然后您可以选择要在**Content Type>Display Fields**上显示的字段，然后您可以通过主题文件夹中的[contemplate 模块](http://drupal.org/project/contemplate)或**node-content_type.tpl.php**编辑该预告片的主题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T07:38:47.790

[http://drupal.org/node/362068#comment-1216250](http://drupal.org/node/362068#comment-1216250)您可以使用视图 2 来实现

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-04T00:26:14.463

此外，从代码中使用 node_view 总共允许 4 种节点模板模式。

`node_view($node, $teaser = FALSE, $page = FALSE, $links = TRUE)`

对于疯狂的节点，我有这样的模板......

```
<?php
switch(true){
case($page && $teaser): ?>

  <div class="content">
    <?=$content?>
  </div>

<?php
break;
case($page && !$teaser): ?>

  <div class="content">
    <?=$content?>
  </div>

<?php
break;
case(!$page && $teaser): ?>

  <div class="content">
    <?=$content?>
  </div>

<?php
break;
case(!$page && !$teaser): ?>

  <div class="content">
    <?=$content?>
  </div>

<?php
break;
default: print 'this should never happen.';
}?> 
```

# css - 如何让用 css 调整大小的图像在 IE 中看起来不错？

> ID：681684
> 
> 赞同：8
> 
> 时间：2009-03-25T13:53:48.997
> 
> 标签：css, image, internet-explorer

当图像使用 css 宽度/高度或属性宽度/高度缩放时，IE6 和 IE7 在网页中不能很好地缩放图像。我不确定它默认使用哪种算法，但这并不好。

在这些浏览器中缩放时，缩放的图像会显示锯齿伪影。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-25T13:54:41.787

幸运的是，有一种方法可以通过简单的 css 规则强制 IE7 使用双三次缩放算​​法（看起来很不错）：

```
img { -ms-interpolation-mode: bicubic; } 
```

结果很好，并且可以使用这条规则在整个站点范围内完成。

据我所知，对于 IE6，你不走运。

# linq-to-sql - linq .net with dynamically generated controls

> ID：681685
> 
> 赞同：0
> 
> 时间：2009-03-25T13:54:20.350
> 
> 标签：linq-to-sql

This is a very strange problem and i really dont have a clue whats causing it.

What is supposed to happen is that a call to the BLL then DAL returns some data via a linq SPROC call. The retunred IMultipleResults object is processed and all results stored in a hashtable.

The hashtable is stored in session and then the UI layer uses these results to dynamically generate some gridviews.

Easy you would think.

But if i run the code i dont get any gridviews. If i take out the call to the BLL and DAL the gridviews appear but with nothing in them?

Why is it the page renders correctly when i take out the call to get the data?

Thanks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T14:55:10.190

您可能会得到一个空的结果集，您可以配置网格视图以在未找到结果时显示某些内容。

我建议您进行一些调试并验证代码是否真正得到结果，以及是否以与其他场景相同的方式添加它。

# linux - How can I disable "demand paging" for one of my userspace programs?

> ID：681688
> 
> 赞同：2
> 
> 时间：2009-03-25T13:54:57.853
> 
> 标签：linux, linker, linux-kernel, glibc

For an dedicated test I have to disable "demand paging" for exactly one of my userspace programs

```
http://en.wikipedia.org/wiki/Demand_paging 
```

Any idea how I could do this ? (embedded linux appliance; 2.6 kernel)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T14:28:31.813

如果您有能力修改应用程序，您可以使用`mlock()`/`mlockall()`系统调用来确保您的内存不会被分页：

```
#include <sys/mman.h>

mlockall(MCL_FUTURE); 
```

这将防止当前分配的所有内存以及分配给此进程的任何未来内存被换出。您可以使用`mlock()`系统调用来更好地控制内存的哪些部分被锁定。

# java - Eclipse 命令

> ID：681691
> 
> 赞同：1
> 
> 时间：2009-03-25T13:55:22.970
> 
> 标签：java, eclipse

Ctrl + Shift + R 和 Ctrl + Shift + T 有什么区别？

我们是否有一个包含所有 Eclipse 提示/快捷方式的博客？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T13:59:54.770

Ctrl-Shift-R：查找*资源*，可以包括 XML 文件、Ant 脚本等。

Ctrl-Shift-T：查找*类型*，无论文件名如何。（如果您正在寻找嵌套类型，或者基本上如果您不想看到类型以外的任何内容，这可能会很方便......）

对于 Eclipse 快捷方式，有*很多*[Eclipse 键盘备忘单](http://www.google.com/search?q=eclipse+keyboard+cheat+sheet)。从搜索中，我喜欢[这个 PDF](http://eclipse-tools.sourceforge.net/EclipseEmacsKeybindings_3_1.pdf)，[这个较短的列表](http://www.n0sl33p.org/dev/eclipse_keys.html)，以及[这个有更多解释](http://www.rossenstoyanchev.org/write/prog/eclipse/eclipse3.html)的列表。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T14:03:01.017

*   Ctrl+shift+R 用于开放资源，它搜索项目中所有类型的文件。
*   Ctrl+shift+T 用于 Open Type，它查找 Java 类和接口。

Open Type 对话框的一个重要功能是您可以通过键入 DIS 来搜索 DataInputStream。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T14:01:01.507

*   T ：打开一个类型（Java 工件）
*   R：打开任何文件（任何资源）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T14:05:04.507

*   Ctrl-Shift-T 将查找 Java 类型，包括那些在没有源的 JAR 文件中导入的类型（例如 Java 标准 API）
*   Ctrl-Shift-R 只会查找作为源代码存在的 Java 类型，但也会查找其他类型的源文件，例如 Text 和 XML。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T14:24:41.213

要查看所有键绑定，请查看 Window -> Preferences -> General -> Keys。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T15:09:07.847

此外，Ctrl+Shift+L 将显示当前激活的键盘快捷*键*。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-27T09:04:04.200

明目张胆的广告来了：

如果您喜欢这两个搜索选项，那么您会喜欢[nWire](http://www.nwiresoftware.com/)。它是一个面向 Java 开发人员的 Eclipse 插件，除其他外，它提供了更强大的搜索功能。您可以在键入方法、字段、包时进行搜索……几乎是您在 Java 中拥有的所有内容。

至于更多提示，我在 EclipseZone中写[了以下文章。](http://eclipse.dzone.com/articles/eclipse-34-hidden-treasures)我真的建议将[EclipseZone](http://eclipse.dzone.com/)添加到您的 RSS 提要阅读列表中。那里有很多提示和好东西。

# internet-explorer-8 - What do I need to do to get Internet Explorer 8 to accept a self signed certificate?

> ID：681695
> 
> 赞同：236
> 
> 时间：2009-03-25T13:55:58.443
> 
> 标签：internet-explorer-8, ssl-certificate

We use self signed certificates on our intranet. What do I need to do to get Internet Explorer 8 to accept them without showing an error message to the user? What we did for Internet Explorer 7 apparently isn't working.

EDIT: Internet Explorer 7 wouldn't show any errors if I put the certificate into trusted root certification authorities. Internet Explorer 8 seems to show errors even with the certificate there.

* * *

## 回答 #1

> 赞同：361
> 
> 时间：2009-09-11T16:57:43.177

### 如何通过 20 个烦人的步骤让 IE8 信任自签名证书

1.  浏览到您要信任其证书的站点。
2.  当被告知“此网站的安全证书存在问题。”时，选择“继续访问此网站（不推荐）。”</li>
3.  选择工具➞Internet 选项。
4.  选择安全➞受信任的站点➞站点。
5.  确认 URL 匹配，然后单击“添加”，然后单击“关闭”。
6.  使用“确定”或“取消”关闭“Internet 选项”对话框。
7.  刷新当前页面。
8.  当被告知“此网站的安全证书存在问题。”时，选择“继续访问此网站（不推荐）。”</li>
9.  单击地址栏右侧的“证书错误”，然后选择“查看证书”。
10.  单击“安装证书...”，然后在向导中单击“下一步”。
11.  在下一页上选择“将所有证书放在以下存储中”。
12.  单击“浏览”，选择“受信任的根证书颁发机构”，然后单击“确定”。
13.  返回向导，单击“下一步”，然后单击“完成”。
14.  如果您收到“安全警告”消息框，请单击“是”。
15.  使用“确定”关闭消息框。
16.  选择工具➞Internet 选项。
17.  选择安全➞受信任的站点➞站点。
18.  选择您刚刚添加的 URL，单击“删除”，然后单击“关闭”。
19.  现在关闭所有正在运行的 IE 实例，然后重新启动 IE。
20.  现在应该信任该站点的证书。

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2010-06-02T06:47:30.810

我让它像这样工作

1.  以具有管理权限的用户身份启动 Internet Explorer。
2.  使用计算机名称浏览到服务器计算机（忽略证书警告）
3.  点击屏幕顶部的“证书错误”文本，然后选择“查看证书”</li>
4.  在证书对话框中，单击安装证书 -> 下一步
5.  选择将所有证书放入以下商店 -> 浏览
6.  选中显示实体店复选框
7.  选择受信任的根证书颁发机构 - 本地计算机
8.  点击确定——下一步——完成——确定
9.  重新启动 Internet Explorer

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2012-02-06T11:40:53.907

我已经尝试了很多很多来自不同网站上的不同人的步骤。但是他们都没有提到我应该将证书添加到受信任的人密钥库中。

没错，将它放在受信任的 CA 下对我来说是不够的，我还必须将证书放在受信任的人中。

那是：

1.  运行 MMC
2.  添加证书管理单元选择本地计算机
3.  展开证书（本地计算机）-> 受信任的人-> 证书
4.  右键单击所有任务 -> 导入
5.  完成向导

导出证书：

1.  以管理员身份运行 IE（右键单击，以管理员身份运行）
2.  当提示无效证书时，请继续访问该网站
3.  点击地址附近的证书错误，点击查看证书
4.  转到详细信息选项卡，单击复制到文件
5.  另存为 *.cer 文件。

我在 IE9，Windows 7

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2009-07-17T21:02:15.747

确保您的自签名证书与您的站点 URL 匹配。如果不是，即使在 Internet Explorer 8 中明确信任证书后，您仍将继续收到证书错误（我没有 Internet Explorer 7，但无论 URL 不匹配，Firefox 都会信任该证书）。

如果这是问题所在，在您添加证书后，Internet Explorer 8 中的红色“证书错误”框将显示“地址不匹配”作为错误。此外，“查看证书”有一个**Issued to:**标签，显示证书对哪个 URL 有效。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2011-10-12T10:40:57.580

如果您收到地址不匹配错误，请允许地址不匹配：

1.  工具并选择 Internet 选项
2.  选择高级选项卡
3.  向下滚动并取消选中警告证书地址不匹配

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2010-01-16T18:48:13.007

伙计，今天我花了几个小时来解决这个问题。无论我在 IE 8 中做了什么，问题仍然存在。IE安装的证书出现在客户端PC的受信任的根证书颁发机构中，但是IE仍然抱怨。

这是我发现的解决方案：

**在网络服务器上：**

*   Win+R，MMC，回车。
*   文件，添加-删除管理单元，证书，添加，管理证书：我的用户帐户，完成，确定。
*   导航到“证书 - 当前用户/受信任的根证书颁发机构/证书”。
*   找到您的证书，右键单击，所有任务/导出。
*   “不，不要导出私钥”
*   “DER 编码二进制 X.509 (.CER)”
*   将文件保存在某处。
*   将新创建的 .CER 文件传输到客户端 PC。

**在客户端机器上：**

*   Win+R，MMC，回车。
*   文件，添加-删除管理单元，证书，添加，管理证书：我的用户帐户，完成，确定。
*   导航到“证书 - 当前用户/受信任的根证书颁发机构/证书”。
*   右键单击证书容器，所有任务/导入
*   选择您从服务器计算机传输的 .CER 文件。
*   在下一个屏幕上，选择“将所有证书放在以下存储中”，单击“浏览”，选中“显示物理存储”，然后选择“受信任的根证书颁发机构/本地计算机”。
*   最后按“完成”。
*   在 Internet Explorer 中：工具 - 删除浏览历史记录，
*   在 Internet Explorer 中：工具 - Internet 选项 - “内容”选项卡 - 清除 SSL 状态按钮。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2010-01-13T19:08:06.387

以下是我如何让它在 IE8 中工作：

1.  访问相关网站，例如[https://xxx.yyy.com](https://xxx.yyy.com)，
2.  单击直到您在浏览器状态行中看到证书错误。
3.  查看证书，然后从详细信息选项卡中，选择复制到文件。
4.  保存到桌面为 xxx.cer，例如，
5.  开始，运行，MMC。
6.  文件，添加/删除管理单元，
7.  选择证书，单击添加，我的用户帐户，然后完成，然后确定，
8.  深入了解信任根证书颁发机构、证书、
9.  右键单击证书，选择所有任务，导入，
10.  从桌面选择保存证书
11.  选择将所有证书放在以下存储中，单击浏览，
12.  选中显示物理商店的框，展开受信任的根证书颁发机构，然后在此处选择本地计算机，单击确定，完成导入，
13.  检查列表以确保它显示出来。您可能需要刷新才能看到它。退出MMC，
14.  打开浏览器，选择工具，删除浏览历史
15.  选择除私人过滤数据之外的所有数据，完成，
16.  转到 Internet 选项、内容选项卡、清除 SSL 状态，
17.  关闭浏览器并重新打开并测试。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-25T13:58:05.100

You should install your certificate as a trusted authority on your computer.

There are numerous way to do that, for exampe you could use mmc (start/run/mmc), add the Certificates Snap-In, and from there you can install your self-signed certificate.

There's no way around that because the whole point of certificates is to warn the user if the website he's visiting has not been certified by a trusted authority.

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-09-23T14:39:01.233

安装证书本身是不够的，您需要安装证书颁发机构的**根证书**。假设如果您使用 Win Server 的证书服务，则在该服务器上安装 CS 时创建的根证书就是要安装的。如前所述，它必须安装到“受信任的根证书颁发机构”。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-06-13T12:37:56.090

这可能会帮助我在 IE11 Windows 7 上的人以及我所做的除了安装证书之外是转到 Internet 选项 ==> 高级选项卡 ==> 安全 ==> **“删除检查”来自警告证书地址不匹配** 另外到下面 - 不要忘记关闭所有 IE 实例并重新启动 - 完成后：

1-启动 Internet Explorer 运行。

2-使用计算机名称浏览到服务器计算机（忽略证书警告）

3-单击屏幕顶部的“证书错误”文本，然后选择“查看证书”</p>

4-在“证书”对话框中，单击“安装证书”->“下一步”

5-选择将所有证书放在以下商店中-> 浏览

6-安装到受信任的根证书..

然后重新启动。

希望这对某人有所帮助。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-02-21T17:21:03.903

不幸的是，没有一个解决方案对我有用。我在Windows 7上使用Internet Explorer 8。在寻找解决方案时，我在控制面板中找到了有关登录信息的设置。因此，我在基于证书的信息下添加了一个新条目，其中包含我的服务器地址，并选择了我喜欢的证书。

在 Internet Explorer 8 中清除 SSL 缓存后，我刚刚刷新了站点并将正确的证书发送到服务器。

这不是我想要的解决方案，但它有效。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-06-29T00:56:47.070

您可以使用[GPO](http://en.wikipedia.org/wiki/Group_Policy_Object)在域内使用证书。

但我的问题是 Internet Explorer 8，即使证书在受信任的根证书存储中......它仍然不会说它是受信任的站点。

有了这个和现在需要完成的驱动程序签名......我开始想知道谁拥有我的电脑！

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-01-06T01:49:13.247

正如其他人所提到的，首要任务是将证书添加到受信任的根机构。

有一个自定义 exe ( [selfssl.exe](http://cid-3c8d41bb553e84f5.skydrive.live.com/browse.aspx/SelfSSL?authkey=yeHVTUTVzGE%24) ) 将创建一个证书并允许您指定颁发给：值（URL）。这意味着 Internet Explorer 将使用自定义 Intranet url 验证发布到 url。

确保重新启动 Internet Explorer 以刷新更改。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-12-11T04:26:39.990

看起来不可能不再有证书错误。我在带有 IE 8 的 Windows XP 上。组策略安装了一个自签名证书作为受信任的根证书，用于访问内部站点。当我查看带有证书管理单元的 MMC 时，我可以在那里看到证书。

当我看：

Internet 选项 => 内容 => 证书

它不在那里！

IE 中的这种行为开始于我们的管理员在 2009 年 12 月 10 日安装在我的机器上的最后一批 Patch-Tuesday 更新。在此之前，它很高兴接受证书为有效。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-03-25T14:00:31.210

What were you doing before? For self-signed certificates, I would normally install the certificate locally on the client system.

You may be able to use Group Policy to push a certificate to every system.

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-01-25T04:55:19.693

您需要确保自签名证书`common name`对您正在设置的域使用正确的。如果您要为多个域使用相同的证书，您需要为每个域拥有一个唯一的证书，或者如果您的所有 ssl 站点都是公共域的子域，那么您可以生成带有通配符域的证书，例如`*.domainname.tld`.

如果您没有`common name`在自签名证书中正确设置您的证书，那么 Chrome 和 Firefox 可能会工作，但 IE 可能无法在您每次加载网站时找到证书。在 IE 中，它看起来就像您添加了站点的证书，但实际上在页面加载时它永远不会被发现。

[如何为 Mac 的 Apache 设置 SSL，以便我可以在 IE8 上测试跨域 iFrame](https://stackoverflow.com/questions/14508336/how-to-set-up-ssl-for-apache-for-a-mac-so-i-can-test-cross-domain-iframe-on-ie8/14515474)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2010-01-13T19:28:42.663

我在使用 Web 服务时遇到了同样的问题。 [在这里](http://msdn.microsoft.com/en-us/library/cc949057.aspx)，微软有一个（很长的）演练向您展示如何在客户端上安装东西，基本上说您的自签名证书是可以的。最后，我只花了 30 美元，从 Godaddy.com 购买了完整的证书。

PS 我知道您可以围绕错误消息编写代码，但出于测试原因我们不想这样做。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2013-11-13T18:46:19.323

如何安装 CA 根证书，而不是网站证书：（IE8，Win7）

当您提出证书详细信息时，您正在查看网站证书，而不是 CA 证书。“常规”选项卡会显示“无法验证此**证书...”您需要通过单击“证书路径”选项卡选择 CA，然后选择路径中最顶部的证书。**它应该有一个红色的 X 图标，并且应该说，“这个 CA 根证书不受信任，因为...”单击查看证书按钮，在这个新的常规选项卡上，您应该看到，“这个**CA 根**不受信任.. ." 这是您要导入受信任的根证书颁发机构的证书。

导入 CA 后，无需导入常规网站证书。该证书将与您刚刚导入的 CA 相匹配，并且 IE 会将所有内容视为正常工作。您不需要以管理员身份运行 IE，也不需要先将站点添加到受信任的站点。导入后确实需要重新启动 IE。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-05-22T22:46:43.263

您可以使用 CertMgr 将证书添加为受信任的发布者，或者如果它是自签名的，则添加为根证书

```
CertMgr.exe /add CertificateFileName.cer /s /r localMachine root 
```

在此处查看 Microsoft 的文档：

[https://docs.microsoft.com/en-us/windows-hardware/drivers/install/using-certmgr-to-install-test-certificates-on-a-test-computer](https://docs.microsoft.com/en-us/windows-hardware/drivers/install/using-certmgr-to-install-test-certificates-on-a-test-computer)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2015-07-28T09:10:58.830

我尝试了所有提到的解决方案，但都没有奏效。使用 Internet Explorer 11 (11.0.9600.17914)，无法接受无效证书，因为错误看起来与 404 完全相同。

有帮助的是以下内容： - 将主机添加到受信任的站点（如这里多次提到的） - 禁用 TLS 1.2 并启用 SSL 1.0 和 SSL 2.0

最后一步是只有在你知道自己在做什么的情况下才应该做的事情。我们需要在工作中使用一个非常奇怪的设置，因此我们找不到其他访问系统的方法。通常，不应该像这样降级安全性。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2016-03-02T21:38:01.853

如果您正在进行一些本地测试并且您在主机文件中添加了一些别名，请说

> 127.0.0.1 www.mysite.com

并尝试使用上述任何程序都会失败。原因是您将为 localhost 导入证书。证书 URL 不匹配。

在这种情况下，您必须生成一个自签名证书，然后按上述方式导入它。

如果您使用 Xampp，则可以使用 c:\xampp\apache\makecert.bat 轻松生成正确的证书

# c# - How to display accurate times for testing performance numbers in C#

> ID：681697
> 
> 赞同：4
> 
> 时间：2009-03-25T13:57:40.890
> 
> 标签：c#, .net, performance, datetime

I want to test the speed of an algorithm, what `DateTime` overload will give me the most precise time? (I still need day/month/year/seconds but then I want milliseconds also).

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-25T14:00:44.283

Try using System.Diagnostics.Stopwatch to do this:

[http://msdn.microsoft.com/en-us/library/system.diagnostics.stopwatch.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.stopwatch.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-25T14:03:03.637

其他人已经提到`Stopwatch`，这确实是一个好主意。但是，我有一个不同的方法：我尝试测量算法足够长的时间，以使正常的系统计时器分辨率就足够了。（我通常仍然*使用* `Stopwatch`，因为它是适合工作的类型，但没关系。）例如，在我最近的[IO 测试](http://msmvps.com/blogs/jon_skeet/archive/2009/03/24/buffering-vs-streaming-benchmark-first-results.aspx)中，我只费心报告秒数，因为我的测试需要几分钟（有时半小时）跑。那时，毫秒是不合适的，因为它们会在其他进程中断等噪音中丢失。

当然，并非总是可以运行这么长时间的测试，但在可以的情况下进行测试是件好事。对于较短的测试，我会警惕耗时不到 5 秒的基准测试......来自另一个进程的短暂活动可能会产生不成比例的影响。

另一件要考虑的事情 - 测量 CPU 时间而不是墙上时间：

```
 [DllImport("kernel32.dll")]
   [return: MarshalAs(UnmanagedType.Bool)]
   static extern bool GetProcessTimes(IntPtr hProcess, 
      out FILETIME lpCreationTime, 
      out FILETIME lpExitTime,
      out ulong lpKernelTime,
      out ulong lpUserTime);

   static ulong GetTime(Process process)
   {
       FILETIME lpCreationTime, lpExitTime;
       ulong lpKernelTime, lpUserTime;

       GetProcessTimes(process.Handle, out lpCreationTime,
                       out lpExitTime, out lpKernelTime, out lpUserTime);

       return lpKernelTime + lpUserTime;
   } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T14:04:11.950

怎么用`DateTime.Now.Ticks`？

存储值，运行算法，将存储的值与当前值进行比较，然后运行算法所需的滴答数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T14:04:55.833

当你减去两个`DateTime`结构时，你得到一个`TimeSpan`结构。使用`TimeSpan`您可以获得两次之间的间隔。

```
var before = DateTime.Now;
System.Threading.Thread.Sleep(6500);
var after = DateTime.Now;

var timeTaken = after - before;
var secondsTaken = timeTaken.TotalSeconds;
var milisecondsTaken = timeTaken.TotalMiliseconds; 
```

请注意，您必须使用`TotalXXXX`才能获得所有内容，`XXXX`否则它将更像人类想要的。在这种情况下`timeTaken.Seconds = 5`，但是`timeTaken.TotalSeconds = 65`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T14:18:54.787

下面是使用 System.Diagnostics.Stopwatch 类的代码示例：

```
Stopwatch sw = Stopwatch.StartNew();
// Put the code here that you want to time
sw.Stop();
long elapsedTime = sw.ElapsedMilliseconds; 
```

DateTime.Ticks 仅精确到大约 15 毫秒，因此对于计时短算法来说并不理想。

# c# - Interface naming convention

> ID：681700
> 
> 赞同：61
> 
> 时间：2009-03-25T13:58:42.977
> 
> 标签：c#, interface, naming-conventions

This is a subjective thing of course, but I don't see anything positive in prefixing interface names with an 'I'. To me, `Thing` is practically always more readable than `IThing`.

My question is, why does this convention exist then? Sure, it makes it easier to tell interfaces from other types. But wouldn't that argument extend to retaining the Hungarian notation, which is now widely censured?

What's your argument for that awkward 'I'? Or, more importantly, what could be Microsoft's?

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2009-03-25T14:27:11.897

约定（以及对它们的批评）都有其背后的原因，所以让我们来看看约定背后的一些原因

*   **接口的前缀为 I 以区分接口类型和实现**- 例如，如上所述，需要一种简单的方法来区分`Thing`其接口`IThing`，因此该约定用于此目的。

*   **接口带有前缀 I 以将其与抽象类**区分开来- 当您看到以下代码时会出现歧义：

    `public class Apple: Fruit`

    如果没有约定，我们将不知道是否`Apple`从另一个名为 的类*继承*`Fruit`，或者它是否是一个名为 的接口的*实现*`Fruit`，而`IFruit`这将使这一点变得明显：

    `public class Apple: IFruit`

    适用最小意外原则。

*   **并非所有匈牙利符号的使用都受到谴责**- 匈牙利符号的早期使用表示一个前缀，表示对象的类型，然后是变量名，有时是变量名之前的下划线。这对于某些编程环境（想想 Visual Basic 4 - 6）很有用，但随着真正的面向对象编程越来越流行，指定类型变得不切实际和多余。当涉及到智能感知时，这变得尤为重要。

    今天，匈牙利表示法可以用来区分 UI 元素和实际数据以及类似的相关 UI 元素，例如，`txtObject`对于文本框，`lblObject`对于与该文本框相关联的标签，而文本框的数据只是`Object`.

    我还必须指出，匈牙利符号的最初用途不是指定数据类型（称为 System Hungarian Notation），而是指定变量名称的语义使用（称为 Apps Hungarian Notation）。[在wikipedia entry on Hungarian Notation](http://en.wikipedia.org/wiki/Hungarian_notation)上阅读更多信息。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-03-25T14:01:23.923

The reason I do it is simple: because that's the convention. I'd rather just follow it than have all my code look different, making it harder to read and learn.

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-03-25T14:03:46.990

嗯，一个明显的考虑是（非常常见的）`IFoo`和`Foo`对（抽象时`Foo`），但更一般地说，知道某物是接口还是类通常是基本的。是的，它部分是多余的，但 IMO 不同于`sCustomerName`- 在这里，名称本身 ( `customerName`) 应该足以理解变量。

但是有了`CustomerRepository`——它是一个类，还是抽象接口？

还有：期望；事实是，无论对错，这都是人们所期望的。这**几乎**是足够的理由。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2009-08-26T12:24:27.990

`Thing`比 . 更具可读性的名称`IThing`。我来自认为我们应该针对接口而不是特定实现进行编程的学派。所以一般来说，接口应该优先于实现。我更喜欢为接口而不是实现赋予更易读的名称（即，我的接口命名时不带“I”前缀）。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2013-05-14T18:05:54.077

我敢肯定，您的问题是 Microsoft 团队中许多长期讨论的主题，该团队致力于 .NET Framework 及其标准。

我认为最有说服力的例子来自源本身。下面，我抄录了我强烈推荐的一本书[《框架设计指南》](https://rads.stackoverflow.com/amzn/click/com/0321545613 "设计框架指南")的摘录。

来自 CLR 项目经理 Krzysztof Cwalina：

> 接口使用的唯一前缀是“I”（如 中`ICollection`），但这是出于历史原因。回想起来，我认为使用常规类型名称会更好。例如，在大多数情况下，开发人员并不关心某个东西是接口而不是抽象类。

来自 CLR 和 .NET Framework 程序经理 Brad Abrams：

> 另一方面，接口上的“I”前缀是对 COM（和 Java）对 .NET Framework 影响的清晰认识。COM 使接口以“I”开头的符号普及，甚至制度化。尽管我们讨论了与这种历史模式不同的问题，但我们决定继续使用这种模式，因为我们的许多用户已经熟悉 COM。

来自顾问兼作家 Jeffrey Richter：

> 就个人而言，我喜欢“I”前缀，我希望我们有更多这样的东西。小的单字符前缀对保持代码简洁和描述性大有帮助。[...] 我为我的私有类型字段使用前缀，因为我发现这非常有用。

我的意思是，它在讨论桌上。我看到的一个优点是它有助于避免类和接口之间的名称冲突，因此您的名称可以既具有描述性又紧凑

就个人而言——也许出于习惯——我喜欢这个`I`前缀，因为它简洁地标记了接口，允许我与实现类型进行一对一的命名对应。这在您想要提供`base`实现的情况下会大放异彩：`IThing`是接口，`Thing`是基本（也许是`abstract`）类型。派生类型可以是`SomeThing`. 我喜欢能够使用如此清晰的速记符号。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2009-03-25T14:02:17.290

I think it is better than adding a "Impl" suffix on your concrete class. It is a single letter, and this convention is well established. Of course you are free to use any naming you wish.

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2010-07-07T17:41:34.010

在我看来，这个“我”只是视觉噪音。IDE 应该以不同的方式显示类和接口名称。幸运的是，Java 标准库不使用这种约定。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2009-03-25T14:07:33.347

不对接口使用 I 约定并没有错——只要保持一致并确保它不仅适用于您，而且适用于整个团队（如果有的话）。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-03-25T14:07:58.913

因为你通常有一个 IThing*和*一个 Thing。因此，与其让人们为这种反复出现的情况制定自己的“约定”，不如选择一个统一的、万能的约定。与其他人所说的相呼应，事实上的标准足以使用它。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-03-25T14:13:46.593

这只是一个旨在防止名称冲突的约定。C# 不允许我有一个名为 Client 的类和一个接口，即使文件名分别是 Client 和 IClient。我很乐意使用约定；如果我必须提供不同的约定，我建议使用“Contract”作为后缀，例如 ClientContract。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2014-08-21T02:09:44.467

命名一个界面应该比你是否在名称前面加上“I”有更深层次的意义。

作为一个界面，“Fruit”和“IFruit”对我来说都没有很大的意义。这是因为它看起来更像一个类。类定义事物，而接口应该定义功能。

“I”命名约定确实有助于区分类和接口，从而使开发更容易一些。虽然它不是必需的，但它肯定有助于避免常见的面向对象编码问题。C# 和 Java 一样，只允许从单个基类继承。但是您可以实现任意数量的接口。需要注意的是，如果您从一个类继承并实现一个或多个接口，则必须首先命名基类（即类 Trout：Fish、ISwimmer、IDiver ...）。

我真的很喜欢根据它们提供的功能以及它们是什么类型的接口（即动画或非动画接口）来命名我的接口。

如果您专注于界面提供的功能，您可以快速确定界面的名称。它还可以帮助您快速查看您的界面是否定义了不相关的功能。

定义无生命对象的接口（即不能自己行动的东西）...我喜欢在末尾用 ...able 命名它们 IPrintable（例如 Document、Invoice） IPlayable（例如 Instrument、MediaPlayer） ISavable （如 Document、Image） IEdible（如 Fruit、Beef） IDrivable（如 Car） IFlyable（如 Plane）

定义动画对象的接口（即自行作用的事物）...我喜欢在末尾加上 ...er 来命名它们 ISwimer（例如 Fish、Dog、Duck） IDiver（例如 Fish、Duck） IFlyer (比如Pilot）IDriver（比如NascarDriver）

最后，“I”命名约定有助于区分接口和类。但是除了开头的“我”之外，添加额外的命名逻辑可能是有意义的。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-03-25T15:16:58.343

我知道 Microsoft 指南建议使用“I”来将其描述为一个界面。但如果我没记错的话，这来自 IBM 命名约定，接口的初始“I”和实现的后续 *Impl。

但是，在我看来，Java 命名约定是比 IBM 命名约定更好的选择（不仅在 Java 中，对于 C# 和任何 OO 编程语言也是如此）。接口描述了一个对象如果实现了接口可以做什么，并且描述应该是动词形式。即 Runnable、Serializable、Invoiceable 等。恕我直言，这是对接口表示的内容的完美描述。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-03-25T14:08:05.763

> [在接口名称前加上字母 I 表示该类型是一个接口。](http://msdn.microsoft.com/en-us/library/ms229040.aspx)

该指南没有解释*为什么*应该使用`I`前缀，但现在这是一个既定的约定这一事实应该是足够的理由。

`I`去掉前缀有什么好处？

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-03-25T14:25:09.857

对我来说，它看起来像[匈牙利语](http://ootips.org/hungarian-notation.html)。匈牙利语通常被认为是强类型语言的威胁。

由于 C# 是 Microsoft 的产品，而匈牙利符号是 Microsoft 的发明，我可以看到 C# 可能在哪些地方容易受到其影响。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-03-25T14:27:24.873

我不知道他们为什么选择那个约定，也许部分是想用“我”来赋予课堂精神，就像在“我是可枚举的”中一样。

一个更符合框架其余部分的命名约定是将类型合并到名称中，例如 xxxAttribute 和 xxxException 类，使其成为 xxxInterface。不过这有点冗长，毕竟接口是独立的，而不仅仅是另一组类。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2010-12-16T23:59:26.280

操作系统 GUI 对文件和文件夹使用不同的图标很流行。如果它们都共享相同的图标，但文件夹以“F”为前缀，则使用相同的图标是可以接受的。但是，由于人类的图像识别速度比文字识别速度快，我们选择了图标。

像 IDE 之类的计算机程序完全能够使文件的接口特性变得明显。这将释放以相同名称发生的不同抽象级别的命名空间。例如，在“ICare”中，“I”描述了实现，“Care”描述了接口的功能。

我猜“I”约定之所以如此流行，是因为我们无法想到更好的东西，但它的存在很重要，因为它指出了我们需要了解这类信息。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-03-25T14:55:06.413

我真的不喜欢这个约定。我知道当您有一个具有相同名称的接口和一个实现时，它有助于解决这种情况，但我觉得它很难看。当然，如果这是我工作的惯例，我仍然会遵循它。一致性是约定的重点，一致性是一件非常好的事情。

我喜欢有一个接口以尽可能通用的方式描述接口的作用，例如，`Validator`. 验证特定事物的特定实现将是 a ，并且具有由s`ThingValidator`共享的一些抽象功能的实现将是 a 。我会这样做，即使是唯一的......嗯......我正在验证的东西，并且是通用的。`Validator``AbstractValidator``Thing``Validator`

在只有一个具体类对接口有意义的情况下，我仍然尝试描述有关该特定实现的特定内容，而不是以不同的方式命名接口以防止名称冲突。毕竟，我将更频繁地输入接口的名称而不是实现的名称。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-03-25T14:03:05.260

将接口与类分开。

此外（这更多是个人观察，而不是从高处决定的），接口描述了一个类的作用。“我”很适合这一点（我确信它是语法中的一个结构，现在可以很好地抽出）；描述验证类的接口将是“IValidate”。描述匹配行为的一种是“IMatch”。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-03-25T14:04:18.377

事实是每个人都理解它，编写更好的代码的一部分是使其易于阅读和理解。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2010-12-27T22:31:01.063

您可以将单词“Interface”作为后缀添加到您的自定义接口，例如“SerializerInterface”。对于抽象类“Fruit”，例如“FruitAbstract”或者你可以将其设为“AbstractFruit”，只要始终保持一致即可。这足够可读，或者遵循通常的命名约定。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2015-09-14T18:05:51.903

只是我的 2 美分：

我个人之所以附加“接口”后缀是因为它比“I”前缀更容易阅读，并且因为系统中的文件是“分组”列出的。例如：

不太好：

```
Alien.php
Host.php
IAlien.php
IHost.php
IXenomorph.php
Xenomorph.php 
```

更好的：

```
Alien.php
AlienInterface.php
Host.php
HostInterface.php
Xenomorph.php
XenomorphInterface.php 
```

但这只是个人口味。我认为只要在整个项目中使用一致的命名约定，就没有什么可以反对使用自己的命名约定。

# asp.net-mvc - 响应 MVC 列表视图上的复选框单击的最佳方式是什么？

> ID：681706
> 
> 赞同：1
> 
> 时间：2009-03-25T14:00:03.350
> 
> 标签：asp.net-mvc, model-view-controller

我的 MVC 应用程序中有一个列表视图，它在每个条目旁边显示一个复选框：

```
<% For Each item In Model%>
    <%=Html.CheckBox("Selected", item.select_flag, New With {.onclick = "this.form.submit();"})%>
    <%=Html.Hidden("ID", item.id)%>
    <%=item.name%>
    <br/>
<% Next%> 
```

从 onclick 中可以看出，每次用户单击复选框时，我都会提交表单。在控制器中，我的 post 操作如下所示：

```
<AcceptVerbs(HttpVerbs.Post)> _
Function List(ByVal Selected() As Boolean, ByVal ID() As String) As ActionResult

    For i = 0 To ID.Count - 1
        If Selected(i) Then
            [use ID(i) to update a database row]
        End If
    Next

    Return View(GetTheListOfNamesAndIds())

End Function 
```

因此，在每次单击复选框后，我都会得到一组选定的值和 ID。我以为它们会对应，但我发现这两个数组由于某种原因不同步。每次单击复选框时处理整个列表也有点过头了，所以我想重新审视整个设置。

设置它以便单击复选框将更新特定数据库行的最佳方法是什么？可以在不每次都重新加载列表的情况下完成吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T14:08:58.337

考虑将每个“行”包装在它自己的 AjaxForm 中或使用 jQuery 通过 AJAX 进行更新，然后通过 AJAX get/post 中的路由值（或表单值）传递操作所需的数据。AjaxForm 将希望使用新内容更新一些 DOM 元素，但您可以通过让它更新错误消息（如果成功则没有任何内容）而不是实际行并通过 javascript 进行任何本地更改来解决此问题。使用 jQuery AJAX，您可以有更多选择来处理它，但您可能必须在客户端实现更多代码。

# iphone - 使用 UITextView 作为子视图使 UIScrollView 获取触摸事件

> ID：681708
> 
> 赞同：5
> 
> 时间：2009-03-25T14:00:15.203
> 
> 标签：iphone, objective-c

我有一个 UIScrollView 包含一个 UITextView （不可编辑）。我无法让 UIScrollView 获取触摸事件， UITextView 似乎获取并保留它们。知道如何让 UIScrollView 获取触摸事件吗？

我希望 UITextView 仍然可以垂直滚动（我的 UIScrollView 只能水平滚动）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T14:11:27.190

在您的`UITextView`子类中，执行以下操作：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    [self.nextResponder touchesBegan:touches withEvent:event];
} 
```

如果您也想`UITextView`处理触摸，那么我相信您可以这样做：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    [self.nextResponder touchesBegan:touches withEvent:event];
    [super touchesBegan:touches withEvent:event];
} 
```

但这可能会导致非常奇怪的行为。

# .net - 您如何获得 .NET CF 3.5 中的当前电池电量？

> ID：681717
> 
> 赞同：2
> 
> 时间：2009-03-25T14:02:16.417
> 
> 标签：.net, windows-mobile, compact-framework, device, power-management

在 Windows Mobile 5 和 6 上的 .NET CF 3.5 中如何（或最好的方法）检索设备的当前电池电量？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-25T14:07:49.507

我认为您想使用`Microsoft.WindowsMobile.Status`名称空间（特别是[`SystemState`](http://msdn.microsoft.com/en-us/library/microsoft.windowsmobile.status.systemstate_properties.aspx)类。

```
using Microsoft.WindowsMobile.Status;

...

BatteryLevel batteryLevel = SystemState.PowerBatteryStrength;
BatteryState batteryState = SystemState.PowerBatteryState; 
```

有关完整的代码示例，请参阅[这篇文章](http://www.nullskull.com/q/10249680/how-to-get-battery-percentage-in-windows-mobile-app-using-cnet.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T17:29:16.543

您可能想要 Noldorin 推荐的 State Notification Broker 类。我认为它不会为您提供非常精细的信息。你会得到像低或非常低这样的信息。如果您需要特定百分比，请考虑使用 GetSystemPowerStatusEx。

HOWTO：获取设备电源状态 [GetSystemPowerStatusEx](http://msdn.microsoft.com/en-us/library/aa457088.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-27T13:32:01.950

[要添加到 CJ 的回复中，您可以从http://www.codeproject.com/kb/mobile/Wimopower1.aspx](http://www.codeproject.com/kb/mobile/Wimopower1.aspx)找到如何获取详细电池信息的代码示例。这些信息包括电池的功率水平、温度、是充电还是放电，以及消耗的电流量。

[示例输出 http://j2i.net/resized-image.ashx/__size/800x0/__key/CommunityServer.Blogs.Components.WeblogFiles/home/powerMeter.png](http://j2i.net/resized-image.ashx/__size/800x0/__key/CommunityServer.Blogs.Components.WeblogFiles/home/powerMeter.png)

# asp.net - 将字符串添加到绑定字段

> ID：681719
> 
> 赞同：0
> 
> 时间：2009-03-25T14:02:21.627
> 
> 标签：asp.net

尝试在绑定字段之前添加前缀

```
<label><input type="radio" name="rbGroup" value='r<%#((Type)Container.DataItem).ID %>'/><%# ((Type)Container.DataItem).Action %></label> 
```

但它把 r 放在按钮旁边。我要rID

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T14:05:29.343

value='<%#"r"+((Type)Container.DataItem).ID %>'

# c# - 经典的 asp 像记录集对象，如何在 .net 中设计它？

> ID：681722
> 
> 赞同：2
> 
> 时间：2009-03-25T14:02:43.687
> 
> 标签：c#, asp.net, datatable

在你们的帮助下，我创建了一个与经典 asp 中的记录集类似的对象。

```
public class RecordSet: List<Dictionary<string, object>>
{

} 
```

所以我可以访问如下数据：

```
RecordSet rs = new RecordSet();

rs[rowID]["columnName"]; 
```

我怎样才能获得这样的访问权限，即序数参考：

```
rs[rowId][2]; 
```

**请不要问我为什么我不使用数据表，这部分是为了好玩和学习和测试呵呵**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T14:13:34.267

更像 RecordSet 的东西可能看起来像这样：

```
public class RecordSet {

   private Dictionary<string, int> _nameLookup;
   private List<List<object>> _rows;
   private int _currentRow;

   ...

   public object this[int index] {
      return _rows[_currentRow][index];
   }

   public object this[string name] {
      return this[_nameLookup[name]];
   }

   ...

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T14:09:27.087

您还想查看 IEnumerable 接口，您可以实现该接口以便能够“foreach”循环遍历类的行。

# c++ - 我从空 std 容器的 front() 中得到什么？

> ID：681725
> 
> 赞同：58
> 
> 时间：2009-03-25T14:03:00.067
> 
> 标签：c++, stl

如果`front()`返回一个引用并且容器是空的，我会得到什么，一个未定义的引用？这是否意味着我需要`empty()`在每个之前检查`front()`？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-03-25T14:04:32.323

您会得到未定义的行为 - 您需要在调用 front() 之前使用 empty()（检查容器是否为空）检查容器是否包含某些内容。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-25T14:05:57.517

你得到未定义的行为。

要进行范围检查，请使用 at(0)。如果这失败了，你会得到一个`out_of_range`例外。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-10-19T17:48:51.717

是的，您可以像 Graham 提到的那样使用“at”而不是使用前面。

但是，at(0) 仅适用于某些容器 - 向量、双端队列，而不适用于其他容器 - 列表、队列、堆栈。在这些情况下，您必须依靠“空”检查的安全性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-26T21:21:59.583

在此实例上调用 front() 之前，您始终必须确保您的容器不为空。调用 empty() 作为安全卫士很好。

当然，根据您的程序设计，始终拥有一个非空容器可能是一个不变的语句，允许您在每次调用 front() 时阻止并保存对 empty() 的调用。（或者至少在你的代码的某些部分？）

但如上所述，如果您想避免程序中的未定义行为，请将其设为强不变量。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T15:09:18.440

未定义的行为

# c++ - 2D 矩阵和重载 operator() / 丑陋的语法

> ID：681746
> 
> 赞同：4
> 
> 时间：2009-03-25T14:07:29.867
> 
> 标签：c++, matrix, operator-overloading, syntactic-sugar

我在我的一个项目中使用 2D 矩阵。这类似于[C++ FAQ Lite](http://www.parashift.com/c++-faq-lite/operator-overloading.html#faq-13.10)中的建议。

巧妙的是，您可以像这样使用它：

```
int main()
{
  Matrix m(10,10);
  m(5,8) = 106.15;
  std::cout << m(5,8);
  ...
} 
```

现在，我有一个由顶点组成的图，每个顶点都有一个指向 2D 矩阵的公共指针（只是为了示例的简单），如上所示。现在我确实有一个非常难看的语法来访问它。

```
(*sampleVertex.some2DTable)(0,0) = 0; //bad
sampleVertex.some2DTable->operator()(0,0) = 0; //even worse... 
```

由于我对运算符重载缺乏经验，我可能在这里遗漏了一些语法糖。有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T14:17:32.823

1.  考虑使用引用而不是指针（前提是它不能为空，并且可以在构造函数中初始化）。
2.  考虑为返回二维矩阵引用的顶点创建一个 getter 或矩阵包装类的实例（前提是它不能为空）。

    ```
    sampleVertex.some2DTable()(0,0) = 0;
    sampleVertex.some2DTableWrap(0,0) = 0; 
    ```

但是，对我来说，证明经历所有麻烦似乎不是问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-25T14:27:31.240

如果您有一个指向 Matrix 的指针，例如作为无法引用的函数参数（例如遗留代码），您仍然可以引用它（伪代码）：

```
struct Matrix {
        void operator () (int u, int v) {
        }
};
int main () {
        Matrix *m;
        Matrix &r = *m;
        r (1,1);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T14:17:42.387

你基本上被限制在`(*sampleVertex.some2DTable)(0,0)`. 当然，如果您不需要重新安装，为什么不将实际值存储在矩阵中呢？

或者，将指针设为私有并创建一个访问器（注意：以下示例假设一个 EntryTypes 矩阵）：

```
Matrix& Vertex::GetTableRef() 
{
    return *some2DTable; 
}
// or
Matrix::EntryType& Vertex::GetTableEntry(int row, int col)
{
    return (*some2DTable)(row,col);
}

// way later...
myVertex.GetTableRef()(0,0) = 0;
// or...
myVertex.GetTableEntry(0,0) = 0; 
```

或者，如果您无法更改 Vertex 类，只需定义一个内联函数来为您执行此操作：

```
// in some header file
inline Matrix& GetTableRef(Vertex& v)
{
    return *v.some2DTable;
}

// or you could do this
inline Matrix::EntryType& GetTableEntry(Vertex& v, int row, int col)
{
    return (*v.some2DTable)(row, col);
}

// later...
GetTableRef(myVertex)(0, 0) = 0;
// or
GetTableEntry(myVertex, 0, 0) = 0; 
```

最后，不要忘记您不必*使用*运算符重载。STL 集合实现了一个 at() 成员函数，它被选中，而不是未选中的 operator[]。如果您不介意边界检查的开销，或者您只是想成为非标准的，您可以实现 at() 然后调用`myVertex.some2DTable->at(0,0)`，完全省去一些语法上的麻烦。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T14:32:05.533

没有 C++ 语法糖可以减轻您所描述的痛苦：

```
(*sampleVertex.some2DTable)(0,0) = 0; //bad
sampleVertex.some2DTable->operator()(0,0) = 0; //even worse... 
```

在这种情况下，我要么让图形返回引用而不是指针，要么让矩阵定义一个调用 operator() 的函数：

```
inline matrixType &Matrix::get( int x, int y ){ return operator()(x,y); } 
```

然后，对于顶点示例，语法并不那么难看：

```
sampleVertex.some2DTable->get(0,0) = 0; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T15:35:02.573

我会添加一个函数，它会像 rlbond 推荐的那样返回一个 ref。为了快速修复，或者如果您无法控制它的来源，我会这样做：

```
sampleVertex.some2DTable[0](0,0) = 0; // more readable 
```

这实际上是等价的，因为如果`a`是指向已定义类的指针，则以下内容成立：

```
*a == *(a + 0) == a[0] 
```

请参阅关于 comp.lang.c++ 的关于同一个问题的长时间讨论，并给出很好的答案[。](http://tinyurl.com/cav2n8)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T14:11:00.967

这是不更改代码的最佳方法：

```
//some2DTable is a pointer to a matrix
(*sampleVertex.some2DTable)(0,0) 
```

您也可以改为使 some2DTable 成为对矩阵的引用，而不是指向矩阵的指针。然后你会像在你的第一个代码片段中一样简化语法。

```
//some2DTable is a reference to a matrix instead of a pointer to a matrix
sampleVertex.some2DTable(0,0) 
```

或者您可以保留 some2DTable 指向引用的指针，并简单地将引用变量存储到它并在代码块的上下文中使用它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-25T16:09:24.113

我不知道这是否值得麻烦，但你可以这样做：

```
class MatrixAccessor {
private:
  Matrix2D* m_Matrix;
public:
  MatrixAccessor(Matrix2D* matrix) : m_matrix(matrix) { }
  double& operator()(int i, int j) const { return (*m_Matrix)(i,j); }
  Matrix2D* operator->() const { return m_Matrix; }
  void operator=(Matrix2D* matrix) { m_Matrix = matrix; }
}; 
```

假设原始`operator()`返回一个引用（就像在许多矩阵类中一样）。

然后在顶点类中提供 MatrixAccessor：

```
class Vertex {
  Matrix2D* myMatrix;

public:
  MatrixAccessor matrix;
  Vertex(Matrix2D *theMatrix) : myMatrix(theMatrix), matrix(theMatrix) { }
}; 
```

然后你可以写：

```
Vertex v;
v.matrix(1,0) = 13;
v.matrix->SomeOtherMatrixOperation(); 
```

**编辑**

我添加了`const`关键字（感谢*@phresnel*提出了该主题），以便使解决方案在语义上等同于仅提供公共指针的解决方案`Matrix2D`。

该解决方案的一个优点是，可以通过添加两个非`const`版本的`operator()()`和`operator->()`（即不能在`const`顶点上修改矩阵）并将它们分别更改`const`为返回一个`const double&`和来将常量转移到矩阵对象`const Matrix2D*`。

当使用指向矩阵对象的公共指针时，这是不可能的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-25T16:42:08.827

我会改变你获取“sampleVertex.some2DTable”的方式，所以它会返回一个引用。

要么自己创建参考：

```
Matrix& m = *sampleVertex.some2DTable;
m(1,2) = 3; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-26T12:38:59.760

您可以通过调用成员函数来实现 Matrix::operator (int,int) 并在处理指针时直接使用该成员函数。

```
class Matrix
{
public:
  float ElementAt( int i, int j ) const { /*implement me*/ }
  float operator() ( int i, int j ) const { return ElementAt( i, j ); }
  ...
};

void Foo(const Matix* const p)
{
  float value = p->ElementAt( i, j );
  ...
}

void Bar(const Matrix& m)
{
  float value = m(i,j);
} 
```

# visual-studio - 当事件发生第 n 次且 n > 1 时，如何在 VS2005 中使用“运行到光标”或调试

> ID：681757
> 
> 赞同：0
> 
> 时间：2009-03-25T14:09:33.200
> 
> 标签：visual-studio, debugging

考虑我有一个在 Visual Studio 2005 中开发的窗口应用程序，它有一个按钮。

当第三次（或第 n 次）而不是第一次单击按钮时，我需要使用“运行到光标”/调试。我怎样才能做到这一点。？

考虑这是一个示例代码。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Text;
using System.Windows.Forms;

namespace breakPoint
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            for (int i = 0; i < 10; i++)
            {
                textBox1.Text += "hi ";
                textBox2.Text += "hello ";
                textBox3.Text += "bye ";
            }

        }
    }
} 
```

当我第 n 次单击按钮时，我需要在“textBox1.Text”行插入断点。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-25T14:12:06.657

您不能为此使用 Run to Cursor，但可以使用断点。

1.  在有问题的行上放置一个断点
2.  右击断点红圈
3.  选择命中数
4.  将组合框更改为“命中计数等于时中断”
5.  将数字 1 更改为您的值 N
6.  点击确定

断点现在只会在第 N 次被命中时停止。

**编辑**

回应澄清。然后将断点放在实际的函数声明本身上。每次点击只会执行一次。然后，您可以进入循环并击中您想要的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T14:12:32.693

[1) 在 Breakpoints 窗口中创建一个新断点
2) 单击 Functions 选项卡
3) 设置条件](http://support.microsoft.com/default.aspx/kb/308469)

# c - 如何在 C 中实现紧凑有向无环字图 (CDAWG)？

> ID：681760
> 
> 赞同：4
> 
> 时间：2009-03-25T14:10:13.167
> 
> 标签：c, data-structures, directed-acyclic-graphs

如何在 C 中实现[这种数据结构](http://www.i.kyushu-u.ac.jp/~takeda/papers/PSC01.pdf)？它是一种类似于 DAWG 的结构，但空间效率是 DAWG 的两倍，比仅压缩前缀的 trie 更有效。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T15:40:53.043

从我可以从这篇[论文中看到](http://www.i.kyushu-u.ac.jp/~takeda/papers/PSC01.pdf)

这是一个带有后缀压缩的 trie，以减少比赛的最终状态变化，因为我做过类似的事情，我也考虑过这样做以节省空间。这是我为数据结构想到的解决方案，我很想看看是否还有其他方法：

```
struct cdawg
{
    int issuffix:1;
    int length:31;
    char *s; // suffix if issuffix == 1, else array of valid transition chars
    struct cdawg *trans; // array of next states based on the index of trans char in s, null if suffix
}; 
```

# c# - 如何在 C# 中以编程方式获取 SVN 修订描述和作者？

> ID：681770
> 
> 赞同：12
> 
> 时间：2009-03-25T14:13:42.397
> 
> 标签：c#, svn

如何以编程方式从 C# 中的 SVN 服务器获取修订描述和作者？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-25T15:19:29.837

使用[SharpSvn](http://sharpsvn.net/)：

```
using(SvnClient client = new SvnClient())
{
    Collection<SvnLogEventArgs> list;

    // When not using cached credentials
    // c.Authentication.DefaultCredentials = new NetworkCredential("user", "pass")l

    SvnLogArgs la = new SvnLogArgs { Start = 128, End = 132 };
    client.GetLog(new Uri("http://my/repository"), la, out list);

    foreach(SvnLogEventArgs a in list)
    {
       Console.WriteLine("=== r{0} : {1} ====", a.Revision, a.Author);
       Console.WriteLine(a.LogMessage);
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-25T14:21:04.280

您需要找到要使用的 C# SVN API。快速谷歌搜索发现[SharpSVN](http://sharpsvn.open.collab.net/)。

获取特定修订的消息和作者

```
SvnClient client = new SvnClient();
SvnUriTarget uri = new SvnUriTarget("url", REV_NUM);

string message, author;
client.GetRevisionProperty(uri, "svn:log", out message);
client.GetRevisionProperty(uri, "svn:author", out author); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T14:31:08.033

不久前我做过类似的事情，我们需要通知某些存储库提交。

我最终使用[SubversionNotify](http://www.subversionnotify.com/)来做到这一点。你可以看看那里的代码，看看你可以使用什么。

我确实相信 SubversionNotify 正在从 svnlook 获取输出。Svnlook 有很多参数可以得到你要找的东西。

如果您知道修订号和存储库：

```
svnlook info -r [rev#] /path/to/repo

```

将为您提供用户、时间戳、日志消息长度和日志消息本身：

```
鲍勃
2009-03-25 11:10:49 -0600（2009 年 3 月 25 日，星期三）
19
用东西做事。

```

# java - 等价于 C++ 中 Java 的 IllegalArgumentException

> ID：681772
> 
> 赞同：29
> 
> 时间：2009-03-25T14:14:02.660
> 
> 标签：java, c++, validation, runtimeexception, illegal-input

在 Java 中，如果方法的输入参数无效，我们可以抛出一个`IllegalArgumentException`（类型为`RuntimeException`）。在 C++ 中，没有已检查和未检查异常的概念。标准 C++ 中是否有类似的异常可用于指示运行时异常？或者是否存在标准中没有的通用样式，但每个人都在实践中遵循这种情况？

或者，我应该创建自己的自定义异常并抛出它吗？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-03-25T14:22:54.200

与 Java 不同，C++ 没有“标准框架”，而只有一个小型（可选）标准库。*而且，对于到底要不要使用异常，在*C++ 程序员下也有不同的意见。

因此你会发现不同的人有不同的建议：有些人喜欢使用标准库中的异常类型，有些库（例如 Poco）使用自定义异常层次结构（派生自 std::exception），有些则根本不使用异常（例如 Qt）。

如果您想坚持使用标准库，则存在一种专门的异常类型：`invalid_argument`(extends `logic_error`)。

```
#include <stdexcept>

// ...
throw std::invalid_argument("..."); 
```

供参考：以下是定义（和记录）的标准异常类型的概述`stdexcept`：

```
exception
    logic_error
        domain_error
        invalid_argument
        length_error
        out_of_range
    runtime_error
        range_error
        overflow_error
        underflow_error 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T14:17:44.007

std::domain_error 可能是您正在寻找的，但我怀疑很少有人使用它。大多数人从 std::exception 派生出他们自己的异常类型。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T14:22:19.893

我总是用`std::invalid_argument`非法的论点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T14:19:16.390

如果无效，您的意思是不满足方法预期值，您可以抛出

```
std::logic_error 
or 
std::runtime_error. 
```

如果您的意思是与转换相关的东西，例如一个对象不能转换为另一个对象 - 也不例外，它不会自动抛出。

**事实上它会的。**但仅适用于引用上的 dynamic_cast<>。它会抛出

```
std::bad_cast 
```

我不确定自己扔这个是个好主意。

我更喜欢使用 logic_error 及其派生词，以防有人传递了错误的参数，因为这是一个逻辑错误：程序员传递了错误类型的参数。

但我更喜欢在这种情况下使用断言。因为只有在开发过程中才能接受诸如向函数传递错误值或类型之类的事情，并且在发布时应避免此类检查。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T14:51:00.807

您可以抛出标准异常或自己滚动。您可能希望在抛出的异常中包含其他信息，这将是您自己做的一个很好的理由。

就个人而言，我还没有在我工作过的系统中看到这样的域检查。它当然不是通用的。

# linq-to-sql - 循环遍历 LINQ 字段值

> ID：681774
> 
> 赞同：0
> 
> 时间：2009-03-25T14:14:20.553
> 
> 标签：linq-to-sql

我有一个带有占位符的文本文件，例如：

感谢您的订单 [OrderNo]。您的订单将被运送到：[Name] [Street1] [Street2] 等

占位符是数据库中用方括号括起来的字段名称。

我想从数据库中检索一条记录，例如：

var order = (from o in testContext.OrderTables where o.OrderID == id select o).Single();

然后我希望能够遍历订单对象并获取字段名称，并填写占位符的值。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T14:20:01.367

当然。然而，框架中没有任何内容支持这一点。您必须搜索标签，然后使用反射来访问 Order 对象中的适当属性。

~~另一种更简单的方法（无反射）是将您的订单转储到哈希表中......这里有一些伪代码实际上可能按原样工作：~~

 ~~```
var hashy = 
  (from o in Orders where o.Id = id select 
  new Dictionary<string,object>{ {"Id", o.Id}, 
     {"Name",o.Name}, /*yadda*/}).Single(); 
```~~ 

~~此时，您需要做的就是从您的文本文件中获取字符串并索引到您的哈希中。~~

显然 Linq to Sql 不喜欢查询中的列表初始值设定项。您可能可以将其包装在方法调用中；我不知道。

稍作修改，您将获得此工作版本：

```
var hashy = 
(from o in Orders where o.Id = id select o).ToArray()
.Select(o=> new Dictionary<string,object>{{"Name",o.Name}})
.First() 
```

它不那么优雅，因为您正在通过 ToArray() 触发 Linq 调用，这将拉回所有订单。最后，最好只是提取您的订单，将您需要的信息填充到哈希中，然后处理您的文本文件。如果您的数据库发生更改，您将不得不重新编译；再次，它不像我第一次尝试那样优雅......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-11-18T22:17:17.650

对于任何寻找解决方案的人来说，这对我来说是获取电子邮件列表的工作：

```
Dim doc = From u In db.myTable, d In db.myTable2 _
                      Where u.UserId = d.UserId  _
                      Select u.Email
    If doc.Count > 0 Then
        For Each rec In doc
            strEmailBcc += rec & "; "
        Next
    Else
        MsgBox("No e-mails were found.", MsgBoxStyle.Information, "E-mail Search")
    End IF 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T14:18:46.597

您可能可以使用 .GetType() 来完成，然后使用反射来获取各个属性及其值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T14:19:01.167

您不能直接使用 LINQ 来遍历对象的属性，因为在对象上没有可用的对象属性的枚举。但是，您可以使用反射来获取对象的属性。LINQ 在查看这些以找到适合您的占位符的对象时可能会派上用场。

```
 public Dictionary<string,object>
     ValuesForPlaceHolders( object obj,
                            IEnumerable<string> placeHolders )
 {
     var map = new Dictionary<string,object>();
     if (obj != null)
     {

         var properties = obj.GetType().GetProperties();
         foreach (string placeHolder in placeHolders)
         {
             var property = properties.Where( p => p.Name == placeHolder )
                                      .SingleOrDefault();
             if (property != null)
             {
                 map.Add( placeHolder, property.GetValue( obj, null ) );
             }
         }
     }
     return map;
 } 
```

**编辑**：上面的示例是为了说明如何使用 LINQ。我的偏好实际上是使用辅助方法按名称获取值。请注意，下面的方法假定属性存在，但可以很容易地修改为在属性不存在时返回 null。在我的使用中，我对它的调用是通过单元测试验证的，所以我不需要额外的检查。

```
public static class TypeHelper
{
    public static object GetPropertyValue( object obj, string name )
    {
        return obj == null ? null : obj.GetType()
                                       .GetProperty( name )
                                       .GetValue( obj, null );
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T15:44:54.657

这个怎么样：

```
 void Main()
{
   var text = "Thank you for your order [OrderNo]. Your order will be shipped to: [Name] [Street1] [Street2]";

   var order = new Order() {OrderNo = 1, Name="NameA", Street1 = "Address1A", Street2="Addres2A"};

   var splitted = text.Split(']').ToList();

   var orderType = (new Order()).GetType();

   var newText = text;
   splitted.ForEach(p => 
    { 
       string field = p.Substring(p.IndexOf('[') + 1);
       if (!string.IsNullOrEmpty(field))
       {
           var result = orderType.GetProperty(field).GetValue(order, null);
           //var method = orderType.GetMethod("get_"+field);
           //var result = method.Invoke(o, null);
           newText = newText.Replace("[" + field + "]", result.ToString());
       }
    });
   Console.WriteLine(newText);
}

public class Order
{
    public Order()
    {}

    public int OrderNo {get; set;}
    public string Name {get; set;}
    public string Street1 {get; set;}
    public string Street2 {get; set;}
} 

```

我不确定我是否喜欢它，但它确实有效。:-)

# asp.net - 将 DropDownList 绑定到枚举

> ID：681790
> 
> 赞同：0
> 
> 时间：2009-03-25T14:21:00.130
> 
> 标签：asp.net

如何将常规 asp.net 下拉列表绑定到枚举？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T14:23:08.520

这个页面解释得很好：

[http://geekswithblogs.net/jawad/archive/2005/06/24/EnumDropDown.aspx](http://geekswithblogs.net/jawad/archive/2005/06/24/EnumDropDown.aspx)

# .net - 报表设计器支持 ORM (.NET)

> ID：681793
> 
> 赞同：1
> 
> 时间：2009-03-25T14:21:20.990
> 
> 标签：.net, nhibernate, entity-framework, orm, reporting

假设我有一个使用 ORM（我正在考虑 nHibernate 或 LINQ to Entities）进行数据访问的应用程序。如何为我的用户提供针对我的对象属性进行报告的能力？我认识的所有最终用户报表设计者都直接与数据库对话，但我不喜欢在应用程序对象中已经存在的报表中重复逻辑。

有没有标准的解决方案？

我希望有一个系统使用反射（或其他方法）从我的对象中获取模式，然后让用户构建一个可以针对我提供的 IQueryable 运行的 linq 查询。

必须自己编写所有数据检索逻辑并不吸引人。创建数据集来代表我所有的对象就更不吸引人了。（如果我喜欢数据集，我不会看 ORM 系统）

新的[.NET RIA 服务](http://download.microsoft.com/download/F/B/8/FB8CA635-296B-487F-965C-8148F08B5319/riaservicesoverviewpreview.pdf)是解决方案的良好基础吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T14:32:16.657

你也可以看看[DevExpress 的 XtraReports](http://www.devexpress.com/Help/?document=XtraReports/CustomDocument4256.htm&levelup=true)

XtraReports 可以从任何实现 IList、ITypedList 或 IBindingList 接口的数据源生成报告。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-27T08:54:03.743

许多第 3 方报表设计器允许您从自己的数据源生成报表。例如 DataSet、IList 等

他们似乎都没有让用户使用 Ling 类型查询等设计报告。

（如果有人提出更好的答案，我将删除此答案并将更好的答案设置为预期答案。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T14:27:55.480

您可以使用 SSRS 报告，但不能使用基于服务器的报告。我想他们称他们为本地报道。

在这种模式下，您将数据提供给报表，而不是让报表获取数据，因此从概念上讲，您将编写一个方法来将您的对象转换为数据集，然后将其传递到报表中。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-09T05:41:58.503

快来查看数据动态报告。我们允许您指定最终用户将在设计器中看到的数据集，但您可以从幕后的任意来源加载数据。事实上，我们为对象集合提供了特殊的数据源支持。以下是与您所追求的内容相关的几个截屏视频：

*   [UserDesignerControl.LocateDataSource & Xml Data Provider Additions](http://www.datadynamics.com/Products/DDRPT/ScreencastViewer.aspx?ID=DSXML)：这实际上是以 XML 为中心的演练，但请注意他们如何使用 LocateDataSource 按需提供数据，并且用户可以查看一个简单的数据集，因为开发人员可以完全控制. 由于我们有一个用于绑定到对象集合的 ObjectDataSource，因此您可以轻松地将相同的场景应用于绑定到对象。
*   [最终用户的设计器中的字段选择器](http://www.datadynamics.com/Products/DDRPT/ScreencastViewer.aspx?ID=FSLEC)：这个显示了设计器中的一些字段选择器功能，您的最终用户可以使用这些功能来选择字段。

所有其他截屏视频位于[http://www.datadynamics.com/Products/DDRPT/#screencasts](http://www.datadynamics.com/Products/DDRPT/#screencasts)

这是[博客上的“快速入门文章”（由 ActiveReports 支持团队成员撰写），展示了如何将 Linq 与 ActiveReports 一起使用](http://jon-pilgrim.blogspot.com/2007/07/quickstart-linq-and-activereports-for.html)。

我们的网站上还有[一篇知识库文章，](http://www.datadynamics.com/forums/111035/ShowPost.aspx)它一步一步将 linq 查询绑定到 ActiveReports。

[一位客户还详细写了他如何在他的应用程序中使用 ActiveReports 和来自 Linq 的数据](http://tiredblogger.wordpress.com/2007/07/16/using-linq-as-a-activereports-datasource/)。

```
Scott Willeke
Data Dynamics / GrapeCity 
```

# multithreading - 读写器问题

> ID：681800
> 
> 赞同：0
> 
> 时间：2009-03-25T14:22:57.507
> 
> 标签：multithreading, language-agnostic, producer-consumer

对不起，如果我再次问同样的问题但想验证！

我有两个进程 P1 和 P2。

P1是作家（制片人）。
P2是一个读者（消费者）。

有一些共享内存或 P1 写入的文件，一旦 P1 写入，应该通知 P2 读取。

现在根据我的理解 P1 的伪代码应该是

```
打开共享文件
创建一个命名事件（“Writedone”）来表示 P2 进程的写入
对文件进行一些处理
互斥锁（）
写入文件
互斥锁（）
名为事件的信号。
CloseHandle 存档

```

现在在P2

```
打开共享文件的句柄
打开命名事件的句柄
命名事件上的 WaitForSingleEvent（“Writedone”）
从文件中读取
CloseHandle 存档

```

问题：

1.  阅读器是否需要锁？阅读器只会读取文件而不更改它。所以我想读者不需要锁。想法？在没有锁的情况下会出错吗？
2.  我每次在读写过程中都会打开和关闭文件的句柄。我认为这不是必需的。我可以在构造函数中打开文件句柄并在读写器的析构函数中关闭它。但是当它被用于写作时，我可以从文件中读取吗？

编辑：每次 writer 在 File 末尾写入 10 个字节，并且 reader 应该读取 writer 写入的最新 10 个字节。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T16:29:30.680

答案是：当（且仅当）两个线程可以同时使用相同的共享资源时，锁定是必要的。关于您的具体实施没有足够的信息，但我有几句话：

1.  仅在写入期间锁定是没有意义的。它只会增加一些开销，但在阅读器也被正确锁定之前不会阻止任何并发访问。
2.  如果修改与文件描述符相关的结构的文件操作未以任何方式同步，则锁定将是必要的。当 P2 仍在读取时，P1 可能会开始写入文件。如果读取和写入操作在没有任何底层同步的情况下修改相同的系统结构，您最终将得到损坏的数据。很难说这里是否是这种情况，因为您没有提及您使用了哪个特定功能（库）。文件操作在大多数系统上都是同步的，所以应该不是问题。
3.  从您写的关于“10 字节信息部分”的内容来看，显式锁定似乎没有必要（除非＃2 没有强加它）。P1 产生数据量。当数据准备好被读取时，P1 会通知 P2（通过事件；无论如何，事件传递应该在内部同步）。P2 知道它可以读取数据量，然后需要等待后续通知。可能会在处理前一个通知之前发送后续通知。因此，事件需要以某种方式排队。您还可以使用信号量代替事件通知。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T14:27:03.003

您需要读者获得锁定 - 事件的使用是不可替代的。没有它，作者可以在阅读器代码的任何时候开始编写。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T15:53:40.487

您绝对需要锁定消费者，以防止生产者在阅读器读取之前附加到文件。想象一下这个场景：

```
Producer writes and signals
Consumer receives signal
Consumer opens the file
Producer fires again and writes another 10 bytes
Producer signals
Consumer reads the last 10 bytes
Consumer closes the file 
```

接下来会发生什么取决于您的命名事件是手动重置还是自动重置。如果它是自动重置的，那么消费者将看到第二个信号，然后返回并再次读取相同的内容。如果是手动重置，那么消费者将重置事件并错过生产者写的最后一件事。

请注意，即使使用锁，如果生产者能够足够快地响应，您也有竞争条件。也就是说，生产者可能能够在消费者能够读取第一条记录之前将第二条记录放入文件中。

看起来您在这里拥有的是在文件中实现的 FIFO 队列，并且您依赖于消费者处理数据的能力比生产者创建数据的速度更快。如果你能*保证*这种行为，那么你就可以了。否则，消费者将不得不跟踪它上次读取的位置，以便它知道接下来应该读取的位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T16:03:31.163

1.  如果作者可以随时开始写入，您确实需要锁定阅读器中的互斥锁。确保互斥锁是一个命名的，以便 P2 可以打开它。

2.  如果在两个进程中都使用 FileShare.ReadWrite 打开文件，则可以将其保持打开状态。

在阅读器中，您可能必须先寻找到您点击 EOF 的地方，然后才能再次阅读。

如果您确定写入器始终在追加，并且您可以知道记录的结束位置（例如，因为它们始终是 10 个字节），并且您可以接受一个小的延迟，并且写入器总是写入完整的记录，那么您可以在没有互斥锁的情况下执行此操作和事件。使用 FileShare.ReadWrite 打开文件，然后在阅读器中，继续寻找同一个地方并尝试阅读您的记录，如果不能，则睡一秒钟。如果你设法读了整张唱片，你就得到了一张。找出你的位置并返回寻找那个地方并尝试再次阅读。这就是 tail -f 在 Unix 中的工作方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T23:40:07.730

除了正常的同步功能外，您还可以使用 Windows 上的[文件更改通知](http://msdn.microsoft.com/en-us/library/aa364417(VS.85).aspx)API 来等待文件更改。

# windows - 每个文件实例的自定义图标

> ID：681802
> 
> 赞同：1
> 
> 时间：2009-03-25T14:24:02.730
> 
> 标签：windows, icons

某些 Windows 程序可以为具有相同扩展名的不同文件使用不同的图标。

例子

*   .sln 可以显示不同的图标，具体取决于解决方案的 Visual Studio 版本（实际上，由 .sln 顶行中的版本号确定）
*   Photoshop .psd 文件具有带有图像缩略图的图标
*   如果在 Internet Explorer 中打开或保存，.url 快捷方式文件具有页面的 favicon

我猜它一定是只针对那台电脑定制的。在没有安装 Visual Studio 的机器上，.sln 文件只有默认的“我不知道这个程序”图标。注册表中有什么需要更改的吗？

我怎样才能做到这一点？我希望可以选择将自定义图标与文件关联到我自己的程序。

**[编辑]**我真的可以在托管代码中做到这一点。这是*可能*的（<SDK v1.1>\Samples\Technologies\Interop\Applications\ShellCmd），但它似乎也有潜在危险，并且在实践中是错误的工作工具：http: [//social.msdn.microsoft.com/论坛/en-US/netfxbcl/thread/1428326d-7950-42b4-ad94-8e962124043e/](http://social.msdn.microsoft.com/forums/en-US/netfxbcl/thread/1428326d-7950-42b4-ad94-8e962124043e/)。我真的希望 MS 现在能为这类东西提供一个很好的托管 API。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T14:50:15.070

[在 CodeProject 上](http://www.codeproject.com/KB/shell/shellextguide9.aspx)查看此C++ 代码：本质上，您编写了一个 COM 处理程序并将其注册到您的扩展中。请注意，如果您在图标处理程序或外壳扩展中泄漏资源，您可能会严重破坏资源管理器进程...... C++ 可能是一个挑战，但出于内存消耗的原因，我不建议在 C# 或 Java 中执行此操作（a每个扩展/处理程序的框架代码的单独副本！）。

# c# - WCF 可用作应用程序，但不能用作服务

> ID：681806
> 
> 赞同：5
> 
> 时间：2009-03-25T14:24:52.773
> 
> 标签：c#, .net, wcf, windows-services

我有一个可以作为服务或 Windows 窗体应用程序运行的 WCF 服务器。当我将它作为 Windows 窗体应用程序运行时，我可以通过我的客户端应用程序连接到它。但是，当我使用相同的代码将它作为服务运行时，我无法连接到它。我已经确认该服务正在运行并完成其工作。下面是服务器的配置文件。

```
<system.serviceModel>
  <services>
    <service name="Cns.TrafficCopService.ManagementService">
      <host>
        <baseAddresses>
          <add baseAddress="http://localhost:8000/TrafficCop/ManagementService" />
        </baseAddresses>
      </host>
      <endpoint address="" binding="wsHttpBinding" contract="Cns.TrafficCopService.IManagementService" />
    </service>
  </services>
</system.serviceModel> 
```

及其托管代码，在调用 OnStart 后 100 毫秒调用：

```
if (this.serviceHost != null)
{
    this.serviceHost.Close();
}

this.serviceHost = new ServiceHost(typeof(ManagementService));
this.serviceHost.Open(); 
```

和客户端的配置文件：

```
<system.serviceModel>
  <bindings>
    <wsHttpBinding>
      <binding name="WSHttpBinding_IManagementService" />
    </wsHttpBinding>
  </bindings>
  <client>
    <endpoint
        address="http://localhost:8000/TrafficCop/ManagementService"
        binding="wsHttpBinding"
        bindingConfiguration="WSHttpBinding_IManagementService"
        contract="IManagementService"
        name="WSHttpBinding_IManagementService">
    </endpoint>
  </client>
</system.serviceModel> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T14:43:20.327

您能否发布其余代码以托管该服务？

启动服务的类应该继承自“ServiceBase”并且应该实现“OnStart”和“OnStop”方法。这些方法由服务控制台调用来启动和停止服务进程，因此您的 ServiceHost 应该在这些方法中打开/关闭。只是想知道也许你不这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T14:35:03.873

服务以什么帐户运行？我想知道服务是否无法启动，可能是由于没有打开端口的权限。

尝试以您自己的身份（但作为服务）运行该服务。如果它有效，这是一个权限问题。最有可能的是 HTTP.SYS 权限。

要分配访问权限，您可以在 vista/window 7 上使用[netsh](https://stackoverflow.com/questions/443640/httplistener-start-accessdenied-error-on-vista/445044#445044)，或者在 xp 上使用 httpcfg。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T14:31:40.340

您从哪里获取创建服务主机的代码？我的第一个猜测是，当您将其作为服务运行时，您要么不创建 ServiceHost，要么不保留对它的引用（因此它会被垃圾收集）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T14:52:13.363

如果您在同一台机器上，我建议使用 NetNamedPipeBinding 而不是 WSHttpBinding。它更快。如果您以后需要跨机器使用，您可以随时改回 ws-http。

确保您的服务实际上是通过 TaskManager 运行的。如果没有，请在服务的构造函数中放置一个 Debugger.Break() 语句，然后逐步查找它无法启动的位置。 [这](https://stackoverflow.com/questions/593454/easiest-language-to-create-a-windows-service/593803#593803)是在 C# 中创建 Windows NT 服务的简明步骤（如果需要）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T20:16:41.557

事件日志中没有关于未能注册地址的信息？

您是否尝试调试服务（使用 Visual Studio 附加到进程）？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-26T13:32:48.897

您是否检查过是否在配置文件中为 WinForms 应用程序和服务定义了该配置？

# string - Groovy GDK 等效于 Apache Commons StringUtils.capitalize(str) 或 Perl 的 ucfirst(str)

> ID：681807
> 
> 赞同：8
> 
> 时间：2009-03-25T14:24:59.357
> 
> 标签：string, grails, groovy, gdk

**是/否问题：是否有一个 Groovy GDK 函数可以将字符串的第一个字符大写？**

我正在寻找 Perl 的 ucfirst(..) 或 Apache Commons StringUtils.capitalize(str) 的 Groovy 等效项（后者将输入字符串中所有单词的首字母大写）。

我目前正在使用 .. 手动编码

```
str = str[0].toUpperCase() + str[1 .. str.size() - 1] 
```

..这行得通，但我认为有一种更Groovy的方式来做到这一点。我想 ucfirst(..) 比说 center(..) 更常见的操作是 Groovy GDK 中的标准方法（请参阅[http://groovy.codehaus.org/groovy-jdk/java/lang/字符串.html](http://groovy.codehaus.org/groovy-jdk/java/lang/String.html) )。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-26T00:46:27.197

不，没有任何东西直接内置于语言中。

不过，还有一些更常规的方法可以做您所要求的事情（如果您不想像 Vladimir 建议的那样以 Java 惯用方式使用 StringUtils）。

您可以在范围的后半部分使用负值来简化您的方法：

```
def str = "foo"

assert "Foo" == str[0].toUpperCase() + str[1..-1] 
```

或者你可以使用 import static 让它看起来像一个原生方法：

```
import static org.apache.commons.lang.StringUtils.*

assert "Foo" == capitalize("foo") 
```

您还可以修改 metaClass 以在其上包含所有 StringUtils 方法，因此它看起来像 GDK 方法：

```
import org.apache.commons.lang.StringUtils

String.metaClass.mixin StringUtils

assert "Foo" == "foo".capitalize() 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-25T14:33:09.587

我不知道有任何此类方法，但一种解决方法是直接在 Groovy 代码中使用 Apache Commons 库：

```
import org.apache.commons.lang.StringUtils

def str = StringUtils.capitalize(input) 
```

它使您的 Groovy 代码有点 Java 风格（有些人可能不喜欢它），但它确实可以完成这项工作。

IMO Groovy 的最大优势在于，您可以非常轻松地利用您通常使用的所有 Java 库以及更传统的 Java 代码库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-15T06:49:06.240

要使其在您的应用程序中全局可用，只需在启动时初始化此块

String.metaClass.capitalize = {委托[0].toUpperCase()+委托[1..-1]}

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T16:06:36.377

如果您想更进一步并将每个单词大写，您可以使用以下内容：

```
def words = sentence.split(" ")
def newStr = []
words.each { w ->
    def capW = [w[0].toUpperCase()]
    if (w.length() > 1) {
        capW << w[1..-1].toLowerCase()
    }
    newStr << capW.join()
}
return newStr.join(' ') 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-14T19:18:00.917

那么你可以试试这个：

`"hey this is a string".split(' ').collect{it.capitalize()}.join(' ')`

或者可能是这样的：

`char c = ' ' "hey this is a string".collect{ c = c==' '?it.capitalize():it }.join()`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-07-14T19:48:18.260

从 Groovy 1.8.2（早在 2011 年 9 月发布）开始，它[`capitalize()`](http://docs.groovy-lang.org/latest/html/groovy-jdk/java/lang/CharSequence.html#capitalize())是实现的内置增强功能。`CharSequence``String`

```
def str = "hello world"
str = str.capitalize()
assert "Hello world" == str 
```

# amazon-s3 - 如何保护我的 Amazon S3 照片，但仍可通过 URL 访问它们？

> ID：681809
> 
> 赞同：9
> 
> 时间：2009-03-25T14:25:28.763
> 
> 标签：amazon-s3

我计划在网上提供我的（家庭）照片集。我想使用 S3 并构建一个显示照片的 ASP.NET 站点。我不希望网站拉下 S3 内容并将其返回给浏览器。我希望浏览器能够直接进入 S3 而不会影响我的 ASP.NET 带宽。

如果我将 S3 权限设置为公开，则可以为每张照片构建 URL，但我只希望我的网站的访问者可以访问这些照片，而不是任何拥有该 URL 的人。

任何想法都非常感谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-25T14:45:57.437

您可以为 S3 上的安全资源生成临时 URL。

[请参阅S3 签名和验证 REST 请求](http://docs.aws.amazon.com/AmazonS3/latest/dev/RESTAuthentication.html)的底部

# apache - 您可以在 .htaccess 中轻松拥有多少个 RewriteRules？

> ID：681810
> 
> 赞同：7
> 
> 时间：2009-03-25T14:25:58.577
> 
> 标签：apache, .htaccess, mod-rewrite, limit

简单的问题。我可以在我的 .htaccess 中拥有多少 RewriteRules 是否有限制，或者我可以在其中放置无数个 RewriteRules，而 Apache 不会对我造成任何影响？

服务器是否存在相对限制，因为有很多规则需要迭代？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T15:05:50.227

您必须知道[每个请求都在处理 .htaccess 配置文件](http://httpd.apache.org/docs/2.2/howto/htaccess.html#when)。

因此，如果您有一个包含 1000 条规则的 .htaccess 文件，最坏的情况是每次请求到达此目录时都会测试每 1000 条规则。

因此，您应该尽可能早地使用规则匹配请求的结构。处理更频繁请求的规则应该出现在那些不太频繁的请求之前并确定处理（参见[`L`flag](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewriteflags)）。阅读[规则集处理](http://httpd.apache.org/docs/2.2/rewrite/rewrite_tech.html#InternalRuleset)以了解如何处理规则（另请参见[`RewriteLogLevel`指令](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewriteloglevel)）。

另一个因素是正则表达式：比模棱两可或复杂的正则表达式更好地使用“简单”和高效的正则表达式。您应该研究如何解释和处理正则表达式，以避免代价高昂并充分利用它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T14:32:57.670

如果您的 RewriteRules 包含多个现有文件 (-F) 或现有 url (-U) 标志，因为这些是子请求，您可能会看到性能下降。除此之外，我还没有遇到过几个 RewriteRules 开始对性能产生不利影响的情况，而我当前的实现有很多。

您可以限制遍历所有 RewriteRules 的需要，只需以这样的方式对它们进行排序，以便在流程的后期（如果可能）进行更昂贵的检查，这样更早的条件可能会使您的重写逻辑短路，并且为您节省在此过程中稍后计算更昂贵规则的时间。

# networking - 基于地理位置的无线网状路由算法：有用吗？

> ID：681821
> 
> 赞同：3
> 
> 时间：2009-03-25T14:28:16.557
> 
> 标签：networking, ip-address, network-protocols, wireless, mesh-network

我在一个团队中，我们应该建立一个“基于地理位置的”、ipv6、wifi 网状网络以在 google android 上运行。

这个想法是使用每个节点的地理位置（纬度、经度、高度）来生成 IPv6 地址，然后使用它来选择最近的节点作为路由的首选节点。通过定期的“路由加载”消息进行一些优化。

[http://www.v6pc.jp/apc/en/data/addressing.pdf](http://www.v6pc.jp/apc/en/data/addressing.pdf)

我的理解是：进行基于地理位置的算法的主要“好处”是每个网络跃点将在物理上更接近目的地......我们*假设*沿着到达目的地的最直接路径旅行会给我们带来最优路由路径。

但是，我对这种方法的问题是物理接近+负载并不一定意味着良好的连接强度或快速路由。如果有厚厚的铅墙（？）或大量干扰怎么办？

当然，接近度是确定路线的一个相当无用的指标吗？

主要指标应该主要基于性能/负载，不是吗？诸如信号强度、显示的吞吐量、CPU 使用率、连接到网络的时间等。至少这是我对如何选择路由路径的理解。

为什么这是个好主意？有什么我想念的吗？

我没有花很多时间与网络打交道，所以请用 noobman 的术语。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T15:11:06.687

任何连接的三个主要参数是带宽、延迟和容量。带宽以每秒字节数为单位，以毫秒为单位的延迟和容量以已用带宽的百分比来衡量。这些都是您可以确定的与相邻节点的连接的所有参数（在加入网格之前，使用的容量可能为 0%）

您需要容量，因为您想避免拥塞节点，即使它们具有良好的带宽和延迟。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T22:27:10.913

> 有什么我想念的吗？

是的，据我所知，Android 中还没有 IPv6 支持......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-10-16T15:43:42.083

不是答案，而是更多的假设列表，因为这是我第一次看到有人谈论这个。

我已经考虑了一段时间的地理定位网状网络，作为减少“洪水”问题的一种方法。我还有 2 个想法可以帮助解决有关节点可取性的问题。第二个就有点啰嗦了。。

1.  节点为它们连接的节点保留“声誉”分数。这将要求在发送数据包后，需要将性能响应发送回发送它的节点。1a)。声誉应该由目标节点周围的节点来维护，目标节点应该无法改变周围节点对其声誉的判断。1b)。用于判断信誉的性能报告需要从目标节点将数据包转发到的节点中转回。该报告需要以这样一种方式加密，即它可以被原始节点理解，但不能被目标节点更改。

2.  尝试鼓励维护节点的疯狂想法。为节点处理的每一位数据附加固定值的加密货币支付。节点中继数据的速度越快，它赚的钱就越多。

关于地理定位网状网络的其他想法涉及目录系统。这还不是一个经过深思熟虑的想法，但是：

1.  我们生活在一个有限的宇宙中，事情只能发展得如此之快。很明显，每个节点都需要维护一个系统，以保存网络中所有端节点的目录，以便一个端节点可以处理往返于另一个端节点的流量。在地理定位的网状骨干网中，路由器节点之间不需要该信息，因为它们应该位于固定位置。但是根据物理定律，移动的终端节点需要它。1a) 理解这一点，终端节点需要向它可以连接的路由器节点注册自己。在附近，注册需要以非常精细的粒度进行维护。类似于处理信号塔切换的方式。2a）但是随着与末端节点的距离增加，更新可能会变得不那么频繁，并且更普遍，直到它们变得比北，南，东多一点，西（我不确定向上/向下是否需要注册地面通信）。区域周长可能需要由端节点的速度来确定。也许它连接到新路由器节点的速率可以决定这一点。

最后。如果地理定位的网格路由可以绑定到一个非陆地的起点，那就太好了，也许在可预见的未来，一个用于所有密集目的的遥远空间的点是固定的。这将需要一些方法让节点使用轨道数学不断地从那个点偏移它们的位置。

# asp.net - 如何使用 ASP.NET 创建和填充 ZIP 文件？

> ID：681827
> 
> 赞同：26
> 
> 时间：2009-03-25T14:29:48.113
> 
> 标签：asp.net, zip

需要将一些文件动态打包成 .zip 以创建 SCORM 包，有人知道如何使用代码来完成吗？是否也可以在 .zip 中动态构建文件夹结构？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-26T06:24:54.090

[DotNetZip](https://www.nuget.org/packages/DotNetZip/)很适合这个。

您可以将 zip 直接写入 Response.OutputStream。代码如下所示：

```
 Response.Clear();
    Response.BufferOutput = false; // for large files...
    System.Web.HttpContext c= System.Web.HttpContext.Current;
    String ReadmeText= "Hello!\n\nThis is a README..." + DateTime.Now.ToString("G"); 
    string archiveName= String.Format("archive-{0}.zip", 
                                      DateTime.Now.ToString("yyyy-MMM-dd-HHmmss")); 
    Response.ContentType = "application/zip";
    Response.AddHeader("content-disposition", "filename=" + archiveName);

    using (ZipFile zip = new ZipFile())
    {
        // filesToInclude is an IEnumerable<String>, like String[] or List<String>
        zip.AddFiles(filesToInclude, "files");            

        // Add a file from a string
        zip.AddEntry("Readme.txt", "", ReadmeText);
        zip.Save(Response.OutputStream);
    }
    // Response.End();  // no! See http://stackoverflow.com/questions/1087777
    Response.Close(); 
```

DotNetZip 是免费的。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-03-25T14:52:20.510

您不必再使用外部库了。System.IO.Packaging 具有可用于将内容放入 zip 文件的类。然而，它并不简单。 [这是一个带有示例的博客文章](http://weblogs.asp.net/jongalloway//creating-zip-archives-in-net-without-an-external-library-like-sharpziplib)（它在最后；挖掘它）。

* * *

该链接不稳定，因此这是 Jon 在帖子中提供的示例。

```
using System;
using System.IO;
using System.IO.Packaging;

namespace ZipSample
{
    class Program
    {
        static void Main(string[] args)
        {
            AddFileToZip("Output.zip", @"C:\Windows\Notepad.exe");
            AddFileToZip("Output.zip", @"C:\Windows\System32\Calc.exe");
        }

        private const long BUFFER_SIZE = 4096;

        private static void AddFileToZip(string zipFilename, string fileToAdd)
        {
            using (Package zip = System.IO.Packaging.Package.Open(zipFilename, FileMode.OpenOrCreate))
            {
                string destFilename = ".\\" + Path.GetFileName(fileToAdd);
                Uri uri = PackUriHelper.CreatePartUri(new Uri(destFilename, UriKind.Relative));
                if (zip.PartExists(uri))
                {
                    zip.DeletePart(uri);
                }
                PackagePart part = zip.CreatePart(uri, "",CompressionOption.Normal);
                using (FileStream fileStream = new FileStream(fileToAdd, FileMode.Open, FileAccess.Read))
                {
                    using (Stream dest = part.GetStream())
                    {
                        CopyStream(fileStream, dest);
                    }
                }
            }
        }

        private static void CopyStream(System.IO.FileStream inputStream, System.IO.Stream outputStream)
        {
            long bufferSize = inputStream.Length < BUFFER_SIZE ? inputStream.Length : BUFFER_SIZE;
            byte[] buffer = new byte[bufferSize];
            int bytesRead = 0;
            long bytesWritten = 0;
            while ((bytesRead = inputStream.Read(buffer, 0, buffer.Length)) != 0)
            {
                outputStream.Write(buffer, 0, bytesRead);
                bytesWritten += bytesRead;
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-25T14:32:26.267

你可以看看[SharpZipLib](http://www.icsharpcode.net/OpenSource/SharpZipLib/)。这是一个[示例](http://www.keithrull.com/CommentView,guid,a64d7d37-81a2-42ba-a8ef-daeeb3eb8bd0.aspx)。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2017-05-17T19:07:41.490

如果您使用的是 .NET Framework 4.5 或更高版本，则可以避免使用第三方库并使用本`System.IO.Compression.ZipArchive`机类。

这是一个使用 MemoryStream 和几个字节数组表示两个文件的快速代码示例：

```
byte[] file1 = GetFile1ByteArray();
byte[] file2 = GetFile2ByteArray();

using (MemoryStream ms = new MemoryStream())
{
    using (var archive = new ZipArchive(ms, ZipArchiveMode.Create, true))
    {
        var zipArchiveEntry = archive.CreateEntry("file1.txt", CompressionLevel.Fastest);
        using (var zipStream = zipArchiveEntry.Open()) zipStream.Write(file1, 0, file1.Length);
        zipArchiveEntry = archive.CreateEntry("file2.txt", CompressionLevel.Fastest);
        using (var zipStream = zipArchiveEntry.Open()) zipStream.Write(file2, 0, file2.Length);
    }
    return File(ms.ToArray(), "application/zip", "Archive.zip");
} 
```

您可以在返回`ActionResult`: 的 MVC 控制器中使用它，或者，如果您需要以物理方式创建 zip 存档，您可以将其保存`MemoryStream`到磁盘或将其完全替换为`FileStream`.

有关此主题的更多信息，您还可以[阅读](http://www.ryadel.com/en/create-zip-file-archive-programmatically-actionresult-asp-net-core-mvc-c-sharp/)我博客上的这篇文章。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-02-25T16:51:23.257

DotNetZip 非常易于使用... [在 ASP.Net 中创建 Zip 文件](http://www.codedigest.com/Articles/ASPNET/384_Creating_ZIP_files_on_the_fly_in_ASPNet.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-25T14:34:01.863

为此，我使用了 chilkat 的免费组件：http: [//www.chilkatsoft.com/zip-dotnet.asp](http://www.chilkatsoft.com/zip-dotnet.asp)。几乎完成了我需要的一切，但是我不确定动态构建文件结构。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-04-12T15:21:45.377

能够使用 DotNetZip 做到这一点。您可以从 Visual Studio Nuget 包管理器或直接通过[DotnetZip](https://archive.codeplex.com/?p=dotnetzip)下载它。然后尝试下面的代码，

```
 /// <summary>
    /// Generate zip file and save it into given location
    /// </summary>
    /// <param name="directoryPath"></param>
    public void CreateZipFile(string directoryPath )
    {
        //Select Files from given directory
        List<string> directoryFileNames = Directory.GetFiles(directoryPath).ToList();
        using (ZipFile zip = new ZipFile())
        {
            zip.AddFiles(directoryFileNames, "");
            //Generate zip file folder into loation
            zip.Save("C:\\Logs\\ReportsMyZipFile.zip");
        }
    } 
```

如果要将文件下载到客户端，请使用以下代码。

```
/// <summary>
    /// Generate zip file and download into client
    /// </summary>
    /// <param name="directoryPath"></param>
    /// <param name="respnse"></param>
    public void CreateZipFile(HttpResponse respnse,string directoryPath )
    {
        //Select Files from given directory
        List<string> directoryFileNames = Directory.GetFiles(directoryPath).ToList();
        respnse.Clear();
        respnse.BufferOutput = false;
        respnse.ContentType = "application/zip";
        respnse.AddHeader("content-disposition", "attachment; filename=MyFiles.zip");

        using (ZipFile zip = new ZipFile())
        {
            zip.CompressionLevel = CompressionLevel.None;
            zip.AddFiles(directoryFileNames, "");
            zip.Save(respnse.OutputStream);
        }

        respnse.flush();
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-09-16T13:52:36.343

使用我们的[Rebex ZIP](http://www.rebex.net/zip.net/)组件“即时”创建 ZIP 文件。

以下示例对其进行了完整描述，包括创建子文件夹：

```
// prepare MemoryStream to create ZIP archive within
using (MemoryStream ms = new MemoryStream())
{
    // create new ZIP archive within prepared MemoryStream
    using (ZipArchive zip = new ZipArchive(ms))
    {            
         // add some files to ZIP archive
         zip.Add(@"c:\temp\testfile.txt");
         zip.Add(@"c:\temp\innerfile.txt", @"\subfolder");

         // clear response stream and set the response header and content type
         Response.Clear();
         Response.ContentType = "application/zip";
         Response.AddHeader("content-disposition", "filename=sample.zip");

         // write content of the MemoryStream (created ZIP archive) to the response stream
         ms.WriteTo(Response.OutputStream);
    }
}

// close the current HTTP response and stop executing this page
HttpContext.Current.ApplicationInstance.CompleteRequest(); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-08-20T06:09:23.110

```
#region Create zip file in asp.net c#
        string DocPath1 = null;/*This varialble is Used for Craetting  the File path .*/
        DocPath1 = Server.MapPath("~/MYPDF/") + ddlCode.SelectedValue + "/" + txtYear.Value + "/" + ddlMonth.SelectedValue + "/";
        string[] Filenames1 = Directory.GetFiles(DocPath1);
        using (ZipFile zip = new ZipFile())
        {
            zip.AddFiles(Filenames, "Pdf");//Zip file inside filename
            Response.Clear();
            Response.BufferOutput = false;
            string zipName = String.Format("Zip_{0}.zip", DateTime.Now.ToString("yyyy-MMM-dd-HHmmss"));
            Response.ContentType = "application/zip";
            Response.AddHeader("content-disposition", "attachment; filename=" + zipName);
            zip.Save(Response.OutputStream);
            Response.End();
        }
        #endregion 
```

# sql-server - SQLServer：如何将固定值绑定到列？

> ID：681828
> 
> 赞同：4
> 
> 时间：2009-03-25T14:29:48.237
> 
> 标签：sql-server, bind

假设我定义了一个 char 列类型。我想严格说它的价值，例如（黑色，白色，红色，蓝色）只有......

我怎样才能做到这一点？？

据我所知，这在 Access 中很容易：P

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-25T14:32:53.083

如果只有几个允许的值，那么您可以使用[`CHECK`约束](http://msdn.microsoft.com/en-us/library/ms188258.aspx)：

```
ALTER TABLE dbo.Your_Table
ADD CONSTRAINT CK_YourTable_YourColumn
    CHECK (Your_Column IN ('Black', 'White', 'Red', 'Blue')) 
```

如果有更多值，那么您可以使用查找表和[`FOREIGN KEY`约束](http://msdn.microsoft.com/en-us/library/ms175464.aspx)：

```
CREATE TABLE dbo.Lookup_Colours (Colour VARCHAR(10))
-- then populate Lookup_Colours with all permitted values

ALTER TABLE dbo.Your_Table
ADD CONSTRAINT FK_YourTable_YourColumn
    FOREIGN KEY (Your_Column)
    REFERENCES dbo.Lookup_Colours (Colour) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T14:37:10.670

您应该使用规则（正如所指出的，现在不推荐使用规则，而应使用约束）或包含您允许的颜色的颜色表的外键。

可以像这样创建检查约束：

```
ALTER TABLE MyTable
ADD CONSTRAINT CK_MyTable_ColorType
    CHECK (ColorType IN ('Black', 'White', 'Red', 'Blue')) 
```

如果您想使用表格，那么您应该创建一个带有颜色名称和 ID 的“颜色”表格。在需要引用的表上，您应该将具有外键的列添加到“颜色”表 ID。

要引用“颜色”表，您必须使用连接，例如

```
SELECT *
FROM   MyTable INNER JOIN
         ColorTable ON MyTable.ColorID = ColorTable.ID 
```

更新：使用约束而不是规则，旧数据库仍然可以使用规则（2000 年）。

```
CREATE RULE Color_Rule
AS 
@list IN ('Black', 'White', 'Red', 'Blue') 
```

希望能帮助到你

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T14:33:43.503

一种方法是创建一个单独的表“类型”并将您的值放在那里。曾经具有类型 varchar 的表现在将具有指向另一个表的 FK TypeID。

这将需要一个额外的连接，但可以让您控制哪些字符串可以是类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T14:33:15.437

您需要[列上的规则](http://msdn.microsoft.com/en-us/library/aa258252(SQL.80).aspx)

是的，它就像访问一样容易。

# svn - 递归列出所有 svn:externals？

> ID：681833
> 
> 赞同：102
> 
> 时间：2009-03-25T14:30:45.833
> 
> 标签：svn, tortoisesvn

如何获取目录中所有 svn:externals 的列表（递归）？有什么实用程序吗？

（我使用的是 Windows（和乌龟））

我有一堆 svn:externals 链接到我项目的不同共享部分，当我分支时，通常很容易出错，找到所有外部并更改它们，以便链接到新分支中的路径。

* * *

## 回答 #1

> 赞同：159
> 
> 时间：2009-03-25T16:04:49.587

在工作副本的根目录中执行以下操作：

```
svn propget svn:externals -R 
```

正如下面评论中所讨论的，这并没有在 externals 中列出 externals。

TortoiseSVN 用户注意事项：TortoiseSVN 安装程序中有一个选项可以安装 SVN 命令行客户端。默认情况下不启用此选项。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-25T14:43:29.657

手动更改所有这些外部属性听起来很乏味。您是否查看过 Subversion 1.5 中添加[的外部新功能？](http://svnbook.red-bean.com/en/1.5/svn.advanced.externals.html)

> Subversion 1.5 在缓解这些挫败感方面迈出了一大步。如前所述，在新的外部定义格式中使用的 URL 可以是相对的，Subversion 为指定多种 URL 相对性提供了语法魔法。
> 
> ../
> 
>     相对于设置了 svn:externals 属性的目录的 URL
> 
> ^/
> 
>     相对于 svn:externals 属性被版本化的版本库的根目录
> 
> //
> 
>     相对于设置了 svn:externals 属性的目录的 URL 方案
> 
> /
> 
>     相对于 svn:externals 属性版本化的服务器的根 URL

也许其中之一会有所帮助？我想这取决于您的分支方式以及您的存储库结构是什么样的。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-09-15T14:59:05.523

我对 TortoiseSVN 的解决方法：

从 SVN 上下文菜单中打开“分支/标签...”对话框。下方对话框显示所有外部对象，包括嵌套外部对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-18T09:39:49.320

也许，作为一种解决方法，您可以以这样一种方式构建您的项目，即所有外部都设置在同一个文件夹中，例如在 Trunk 下方的项目文件夹中。（这并不意味着所有外部文件夹都必须处于相同的深度。）然后您可以右键单击您的项目文件夹，然后是 Properties...，然后是选项卡 Subversion，然后是 Properties... 然后双击 svn:externals。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-13T11:52:22.777

我使用了 Wim Coenen 的答案并编写了以下脚本来创建所有修订的列表：

```
getSvnRevs() {
  cd "$1"
  wcver="$(svnversion)"
  [ -n "$wcver" ] || panic "Unable to get version for $wcdir"
  echo "$1: $wcver"
  svn propget svn:externals -R | while read a b c d e; do
    [ -n "$a" ] || continue
    if [ "$b" = "-" ]; then
      wcparent="$a"
      wcdir="$wcparent/$c"
      [ -z "$e" ] || panic "Invalid format #1"
    else
      [ -n "$wcparent" ] || panic "Invalid format #2"
      wcdir="$wcparent/$a"
      [ -z "$c" ] || panic "Invalid format #3"
    fi
    [ -d "$wcdir" ] || panic "Invalid directory: $wcdir"
    wcver="$(svnversion "$wcdir")"
    [ -n "$wcver" ] || panic "Unable to get version for $wcdir"
    echo "$1/$wcdir: $wcver"
  done
} 
```

幸运的是，我没有嵌套的外部，所以我不必对此进行测试，我想它不会起作用。但是如果你需要这个，递归调用这个函数可能就足够了。此外，我从未使用需要转义的文件名进行测试。那时它可能行不通。

免责声明：我知道最初的问题是关于 Windows 的，除非您使用 cygwin 或类似的，否则 shell 脚本将无法在那里工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-16T16:21:49.293

我接受了[Daniel Alder 的回答](https://stackoverflow.com/a/30214007/2016290)，删除了 svnversion 调用，并使其递归（注意：`read a b c d e`如果源或目标中有空格，则不起作用）。这是一个 bash 脚本，因此您要么需要 Cygwin 之类的东西，要么使用[适用于 Linux 的 Windows 子系统](https://msdn.microsoft.com/commandline/wsl/about)。

```
getSvnExternals() {
  svnbase="$1"
  svnpath="$2"
  svn propget svn:externals -R "$svnbase/$svnpath" 2> /dev/null | while read a b c d e; do
    [ -n "$a" ] || continue
    if [ "$b" = "-" ]; then
      wcparent="$a"
      external="$c"
      wcdir=$(echo "$wcparent/$d" | sed s#^./##)
      [ -z "$e" ] || echo "WARNING: Invalid format #1\. line='$a $b $c $d $e'"
    else
      [ -n "$wcparent" ] || echo "WARNING: Invalid format #2\. wcparent=$wcparent"
      external="$a"
      wcdir=$(echo "$wcparent/$b" | sed s#^./##)
      [ -z "$c" ] || echo "WARNING: Invalid format #3\. line='$a $b $c $d $e'"
    fi
    echo "$1/$wcdir: $external"
    ## recurse into external directory
    [ -d "$wcdir" ] && getSvnExternals "$1/$wcdir"
  done
} 
```

# .net - IronPython，Python for .NET 的任何替代品，用于从 python 访问 CLR？

> ID：681853
> 
> 赞同：3
> 
> 时间：2009-03-25T14:33:55.920
> 
> 标签：.net, python, clr, ironpython

是否有任何替代 Python for .NET 或 IronPython 用于访问 .NET CLR？这两个似乎都有缺点，因为 .NET 的 Python 没有得到积极的开发（据我所知），如果你使用 IronPython，你会失去 CPython 中可用的一些功能。那么还有其他选择吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T16:12:25.573

除了 Python for .NET（对我来说效果很好）之外，我知道的唯一其他解决方案是通过 COM 互操作公开 .NET 库，因此您可以通过 pywin32 扩展使用它们。

（我对 .NET com interop 还不太了解，所以希望其他人可以对此提供进一步的解释。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T13:36:59.683

好吧，它是 python 的衍生物，但你总是有[Boo](https://github.com/boo-lang/boo)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T14:36:19.423

你缺少什么功能？有一个名为[IronClad](http://code.google.com/p/ironclad/)的项目正在帮助从 IronPython 开放对 CPython 扩展的访问，它可能会有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T14:37:52.713

据我所知，您不会得到比 IronPython 更积极开发的东西。

IronPython 目前是语言团队（C#、VB.NET、F#、IronPython 和 IronRuby）正在开发的 .NET 5 之一，所以我怀疑是否还有另一个开源 .NET Python 项目离我们如此之远。

# c# - RSACryptoServiceProvider <-> CryptImportKey 等效性

> ID：681859
> 
> 赞同：1
> 
> 时间：2009-03-25T14:35:15.573
> 
> 标签：c#, c++, rsa

如果我有一个从非托管应用程序创建的密钥，并且我想将此密钥导入托管应用程序并生成另一个密钥或对其进行加密。基本上相同的密钥将从托管和非托管代码中来回导入/导出。

因此什么等价于

```
CryptExportKey(hKey, hPublicKey, SIMPLEBLOB, 0, lpData, &nSize); 
```

和

```
CryptImportKey(hProv, lpData, nSize, NULL, 0, &hPublicKey); 
```

在使用 RSACryptoServiceProvider 的托管世界中？

RSACryptoServiceProvider 类中的哪一组方法等价于上述 Crypto API

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-05-26T15:05:31.157

你试过[`RSACryptoServiceProvider.ExportCspBlob`](http://msdn.microsoft.com/de-de/library/system.security.cryptography.rsacryptoserviceprovider.exportcspblob.aspx#MtViewDropDownText)吗[`RSACryptoServiceProvider.ImportCspBlob`](http://msdn.microsoft.com/de-de/library/system.security.cryptography.rsacryptoserviceprovider.importcspblob.aspx)？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-04-21T16:36:59.513

如果你有兴趣，我写了一篇关于**C++**和**C#中的****RSA**的文章。它包含**代码**以及让 RSA 在两种语言中工作、在它们之间交换密钥和消息所需知道的一切：)。我希望它能回答你所有的问题。

 ******你可以在这里找到它：
[Crypt in C++ 和 Decrypt in C# (and C++)](http://riccardotramma.com/2011/02/crypt-in-c-and-decrypt-in-c-and-c/)

# django - 在 Django 中覆盖全局设置的最佳方法

> ID：681863
> 
> 赞同：1
> 
> 时间：2009-03-25T14:36:02.047
> 
> 标签：django

我有一个包含多个应用程序（比如两个）的 Django 项目，并且都需要不同版本的*MEDIA_ROOT*和*MEDIA_URL*。

该文档确实指定了如何修改特定设置，但这是我所做的。

我创建了一个project1/settings.py，

```
# project1/settings.py, 
from django.conf import settings

settings.MEDIA_URL = 'foo'
settings.MEDIA_ROOT = 'bar' 
```

然后我修改了该应用程序的 init 模块以**仅**加载该模块：

```
# project1/__init__.py
import settings 
```

有用！专用设置文件会选择性地覆盖全局设置文件。我喜欢的是项目设置文件位于逻辑位置。

我的问题是 - 这种方法是否有任何警告，实现这一目标的最佳实践方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T16:50:59.070

杰瑞特是对的。最佳情况：如果您在重新启动服务器后运行一个非常简单的测试，这将起作用。几乎任何其他事情都会破坏它。

如果您只是使用 MEDIA_* 作为常量，我建议您使用其他常量。如果您确实将它们用于文件字段的默认上传设置，听起来您的项目将要求您指定路径。这应该不会太难。

您需要克服当前方案未解决的两个问题：

1.  每次发出请求时动态设置变量
2.  避免糟糕的比赛条件

1 最好通过自定义[MiddleWare](http://docs.djangoproject.com/en/dev/topics/http/middleware/?from=olddocs)完成，可能使用 process_request 方法。但是，您要避免的是

```
settings.MEDIA_URL = 'foo' 
```

全局变量滥用。这将带来问题 2。由于 process_request 允许您传递 HttpRequest 对象，我建议将变量信息放在那里：

```
class MyMiddleWare:
    def process_request(self,request):
        media_root = #some logic to parse request.path
        request.media_root = media_root 
```

然后，您的静态链接必须引用 request.media_root。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T15:59:27.663

我对这应该如何工作感到有些困惑。您将如何使用每个应用程序代码中的设置？

```
# project1/view.py
import settings
print settings.MEDIA_URL 
```

或者

```
# project1/view.py
from django.conf import settings
print settings.MEDIA_URL 
```

在第一种情况下，这可能不起作用，因为您要导入的设置是 project1.settings，它本身没有`MEDIA_URL`属性。

在第二种情况下，您最终不会遇到竞争条件吗？最后加载的应用程序将最后覆盖全局`settings`对象中的属性。这在某些情况下可能有效，您只是在本地运行并启动服务器，然后立即转到一个或其他应用程序中的视图，但在像 Apache 这样长时间运行的服务器中，它保持多个子进程引导和运行，重新- 从请求到请求使用它们，您的设置中的值将是不可预测的。请记住，只有在第一次导入时才会处理您的**init中的代码……后续导入不会导致代码重新运行。**

也许我在你的描述中遗漏了一些东西。

如果您有特定于应用程序的设置，则需要拥有自己的特定于应用程序的设置并编码您的逻辑以适当地使用它们。

# matlab - 如何在 MATLAB 中将移动窗口应用于二维矩阵？

> ID：681864
> 
> 赞同：8
> 
> 时间：2009-03-25T14:36:12.857
> 
> 标签：matlab, image-processing, function

我正在从 Matlab 中的图像中提取特征。为此，我必须在 nXn 窗口上应用许多函数（例如查找每个 3X3 窗口的方差等。
在 Matlab 中是否有一种简单有效的方法来执行此操作，而不是循环遍历矩阵并收集窗口每次元素？
对于某些功能，我已经能够找到一个等效的掩码并使用 filter2 应用它们，但对于许多其他功能，我似乎没有这样的奢侈（一个很好的例子：3X3 窗口的中位数）。
我想要的是*类似*arrayfun的东西，但适用于nXn窗口，而不是单个元素。
谢谢，
Sundar

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T16:03:02.447

如果您有图像处理工具箱，那么您可以使用*blkproc*使用自定义函数来处理图像的*nxm块。*这是一个例子

```
function Ip = imageProcessed(II,blockSize)
   % FUNCTION imageProcessed calculates average value of blocks of size nxm
   % blocks 
      if nargin<2,
         % default/example value for block size
         blockSize = [3 4];
      end

      if size(II,3)>1,
          % blkproc requires a grayscale image
          % convert II to gray scale if it is RGB.
          II=rgb2gray(II)
      end

      % Custom average function.
      myAveFun = @(x) ones(size(x))*sum(x(:))/length(x(:));

      % use blkproc to process image
      Ip = blkproc(II,[blockSize(1), blockSize(2)],myAveFun);
end 
```

**笔记：**

从 MATLAB 2009b 的图像处理工具箱开始，*blkproc*已被弃用并被替换为 *blockproc （请参阅*[此处](http://www.mathworks.com/help/images/release-notes.html)的R2099b 部分）。所以最后两行可以改为：

```
 myAveFun = @(blkstrct) ones(size(blkstrct.data))*mean(blkstrct.data(:))
 Ip = blockproc(II,blockSize,myAveFun); 
```

# c# - 如何判断基于套接字的客户端中的连接是否已断开？

> ID：681866
> 
> 赞同：8
> 
> 时间：2009-03-25T14:36:27.597
> 
> 标签：c#, .net, networking, sockets

如果我的客户的连接在另一个上断开`end( kill -9 server)`。客户需要几分钟才能确定有什么问题。`Socket.Connected`即使连接实际上已断开，也返回 true。

一旦另一端断开链接，确定连接不存在的最快方法是什么？

### 客户端代码：

```
try{
      Socket socket= new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
     /*Assume there is a connection on the other end*/
      while (socket.Connected)
      {

          /*Do some processing*/
      }
 }catch (SocketException se){
       Console.WriteLine(ex.Message);
 } catch (Exception ex){
       Console.WriteLine(ex.Message);
 }
 finally
 {
   Console.WriteLine("something bad happen");
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T16:30:04.563

这似乎对我有用......有人看到任何问题吗？

```
public bool IsConnected
{
         get {return !(Socket.Poll(1, SelectMode.SelectRead) 
                                  && m_socket.Available ==0)}
} 
```

* * *

也可以放入扩展方法。

```
public static class SocketExtensions
{
  public static bool IsConnected(this Socket @this)
  {
    return !(@this.Poll(1, SelectMode.SelectRead) && @this.Available == 0);
  }
} 
```

现在您可以轻松地在处理套接字的代码中使用它。

```
var mySocket = new Socket();
while(mySocket.IsConncted())
{
  // Do Stuff
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T14:40:06.030

产生另一个不断 ping 服务器的线程——这确实是你能做的最好的事情，因为套接字不是活动连接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T14:42:21.203

尝试检查该属性，它应该在连接关闭时[`Available`](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.available.aspx)抛出一个。`SocketException`

[来源](http://bytes.com/groups/net-c/234523-detect-client-socket-disconnect)

**编辑**，这里是你将如何使用它：

```
while(socket.Connected)
{
  try
  {
    while (socket.Available == 0)
      System.Threading.Thread.Sleep(100); // Zzzz
  }
  catch (SocketException)
  {
    // connection closed
    // do something
  }

  /* Do some processing */
} 
```

您也可以尝试使用该`Poll`方法。

从[来源](http://bytes.com/groups/net-c/234523-detect-client-socket-disconnect)：

> 或者，您也可以使用带有 SelectRead SelectMode 参数的 Poll() Socket 方法。如果数据可用或连接已被远程主机关闭，此方法将返回一个真值。然后，您需要区分发生了哪些情况（通过读取套接字缓冲区，并查看它是否返回零值）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T14:43:45.333

也许`SendTimeout`和/或`ReadTimeout`的属性`Socket`会有所帮助？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-26T14:19:26.773

我建议您参考[我](https://stackoverflow.com/questions/685951/how-to-check-if-client-socket-disconnected-in-winsock/685986#685986)对这个问题的 C++ 版本的回答...

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-25T14:38:19.653

您是否尝试过设置更短的连接超时？

# algorithm - 如何计算哈希算法中发生冲突的几率？

> ID：681867
> 
> 赞同：20
> 
> 时间：2009-03-25T14:36:42.137
> 
> 标签：algorithm, math, hash

假设我有一个哈希算法，它既好又流畅（出现任何一个哈希值的几率与任何其他值相同）。

现在说我知道选择 2 个哈希并发生冲突的几率是（为了论证）50000:1。

现在说我选择 100 个哈希。考虑到一组 2 的碰撞几率，我如何计算这组 100 个值中的碰撞几率？

对此的一般解决方案是什么，以便我可以提出一些哈希尝试，之后几率低于某个可接受的阈值？例如，我可以说“一批 49999 个哈希值的创建很有可能发生冲突”。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-25T14:43:23.167

这是[生日问题的一般化](http://en.wikipedia.org/wiki/Birthday_problem#Generalizations)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-25T14:44:13.070

这听起来很像我的[生日悖论](http://en.wikipedia.org/wiki/Birthday_paradox)。

您应该能够将一组可能的生日 (365) 替换为可能的哈希值 (50000) 并运行它们在那里出现的相同计算。

如果您为您的值修改文章中提供的 python 脚本：

```
 def bp(n, d):
    v = 1.0
    for i in range(n):

         v = v * (1 - float(i)/d)
    return 1 - v

 print bp(2, 50000) 
```

您最终会得到两个 0.00002 数字的碰撞几率。大约 265 个样本，您有大约 50% 的机会发生碰撞。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-25T14:50:17.423

首先计算没有碰撞的概率：

```
hashes_picked = 100
single_collision_odds = 50000

# safe_combinations is number of ways to pick hashes that don't overlap
safe_combinations = factorial(single_collision_odds) / factorial(single_collision_odds - hashes_picked)

# all_combinations is total number of ways to pick hashes
all_combinations = single_collision_odds ** hashes_picked   

collision_chance = (all_combinations - safe_combinations) / all_combinations 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T14:44:10.917

这称为[生日问题](http://en.wikipedia.org/wiki/Birthday_paradox)。*要解决它，请考虑没有*碰撞的可能性（称为 p [nc]）。

*   p[数控](1) = 1
*   p [nc] (2) = 1 - p [c] (2)
*   p [nc] (3) = p [nc] (2) * p [nc] (2) * p [nc] (2)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-25T15:44:15.670

在 JS 中

```
function calculate(n,k)
{

    var result =1;
    for (var i=0; i<k; i++){
        result=result*n/(n-i)
    }
    result=(1-1/result)*100;
    return result;
} 
```

# vba - 使用VB分割Excel文件

> ID：681868
> 
> 赞同：0
> 
> 时间：2009-03-25T14:36:52.823
> 
> 标签：vba, excel

我有一个 Excel 工作表，可以将数据生成到另一个工作表中。在此之后，我从工作表导出为 csv 格式。无论包含什么信息，我都需要能够将每 250 行的数据拆分为一个新文件。我正在使用 VB 进行编码。

非常感谢任何帮助。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T14:44:12.120

如果您的电子表格是 XLSX Office 2007，您可以查看[Open XML Format SDK](http://cdonner.com/introduction-to-microsofts-open-xml-format-sdk-20-with-a-focus-on-excel-documents.htm)。

# seo - 301 重定向与 DNS 更改：终止 301 重定向并更新子域的 DNS 是否安全？

> ID：681869
> 
> 赞同：4
> 
> 时间：2009-03-25T14:37:05.913
> 
> 标签：seo, dns, http-status-code-301

我有一个在已迁移到新服务器和新域名的子域上运行的站点。为了保留搜索积分，我知道 301 重定向是处理迁移迁移的正确方法。（营销部门谈到我从未听说过的 301 重定向。）

从技术角度来看，我不明白您必须维持重定向多长时间。有人可以解释一下吗？保持重定向无限期运行似乎是服务器上额外且不必要的负载。在搜索引擎停止链接到前一个站点后，您最终会放弃它还是将其更改为 DNS？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T07:05:15.567

301 是“永久移动”，因此理论上，在其书签中有链接的搜索引擎和浏览器应该切换到新的 URL。但我不敢打赌每个人都会这样做。所以，我同意 ceejayoz 的观点，谨慎的做法是让旧 URL 永远有效。

（还请记住，URL 不仅存储在搜索引擎中，您还可以在许多地方找到它们，甚至在纸上也是如此。这就是为什么[URL 永远不会消亡](http://www.w3.org/Provider/Style/URI)的原因。在发布 URL 之前要三思而后行，您将永远无法回忆起它。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T14:44:05.817

如果有人实际使用重定向，则服务器上只有负载（并且微不足道），因此删除它并错过旧链接的一次点击是没有意义的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T15:23:11.510

您可以将子域的 DNS 记录设为引用新域的 CNAME 记录；我认为这样做没有任何害处，只要该站点仍然有效（某些 Web 应用程序依赖于知道它们访问的域名）。但是，导航到子域的人实际上会在浏览器的地址栏中看到子域，而不是新域，因此他们不会知道该站点已切换域。出于这个原因，我不会使用 CNAME 记录来做这样的“重定向”。我会坚持使用 HTTP 301 重定向。

现在，我同意 ceejayoz 的观点，即服务器上的负载可以忽略不计，因此无需删除 301 重定向。但是，如果您确实想知道多久可以删除它 - 例如，如果您想将该子域重新用于不同的站点 - 我会查看您服务器的访问日志以跟踪子域上的点击次数，之后新网站上线。（如果您安装了日志文件分析器，这很容易）如果（周|月|年）过去了，您在该子域上没有收到任何请求，则表明可能不再需要重定向。显然，您在子域上没有收到任何请求的等待时间越长，就越有可能安全地删除重定向。

# debugging - Firebug 1.3.3 - 并不总是允许脚本调试？

> ID：681871
> 
> 赞同：2
> 
> 时间：2009-03-25T14:37:13.743
> 
> 标签：debugging, firefox, firebug, firefox-addon

我已经使用 firebug 有一段时间了，但我最近注意到它并不总是允许你出于某种原因在代码中设置断点。firebug 调试器中的行号全部变为灰色，您无法让程序在其中任何一个上停止。

当我可以让它工作时，你可以打破的线条变成绿色。

这有什么原因吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T14:46:13.347

我也注意到了这一点，我不得不为每个站点显式启用脚本调试。这可以在控制台选项卡上完成，其中有三个复选框（默认关闭），用于启用控制台日志记录、脚本调试和网络监控。或者，您可以单击脚本选项卡上的向下箭头并选择启用。我找不到任何全局设置来默认在所有站点上启用此功能或保存您的设置。我已将 Firefox 设置为在每次关闭时清除我的所有个人信息，因此，如果您保存设置/个人信息，这可能会持续存在（我尚未对此进行测试……只是猜测）。

我很确定这是出于性能原因。Firebug 会极大地降低依赖 JS 的网站（想想 GMail 或 Facebook）的速度。在以前的版本中，您可以为特定站点禁用 Firebug，但现在我猜他们将其更改为默认禁用，因为用户无法弄清楚并且出于这个原因抱怨（并且可能卸载）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-05T16:02:56.393

它看起来像一个错误，在调试器中很糟糕！

# java - java 对象在构造过程中何时变为非空？

> ID：681881
> 
> 赞同：17
> 
> 时间：2009-03-25T14:39:56.590
> 
> 标签：java, constructor, null, order-of-execution

假设您正在创建一个 java 对象，如下所示：

```
SomeClass someObject = null;
someObject = new SomeClass(); 
```

someObject 在什么时候变为非空？是在`SomeClass()`构造函数运行之前还是之后？

为了澄清一点，假设如果另一个线程要`someObject`在构造函数完成一半时检查是否为空`SomeClass()`，它是空的还是非空的？

`someObject`另外，如果像这样创建会有什么区别：

```
SomeClass someObject = new SomeClass(); 
```

`someObject`永远是空的吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-25T14:44:11.870

如果另一个线程要`someObject`在“构造期间”检查变量，我相信它*可能*（由于内存模型中的怪癖）看到一个部分初始化的对象。新的（从 Java 5 开始）内存模型意味着任何*final*字段都应该在对象对其他线程可见之前设置为它们的值（只要对新创建对象的引用不会从任何其他线程的构造函数中逃逸）方式）但除此之外没有太多保证。

基本上，不要在没有适当锁定（或静态初始化器等提供的保证）的情况下共享数据:) 严重的是，内存模型非常棘手，一般来说无锁编程也是如此。尽量避免这种可能性。

从**逻辑**上讲，赋值发生*在*构造函数运行之后 - 因此，如果您*从同一个线程*观察变量，它将在构造函数调用期间为空。但是，正如我所说，内存模型存在一些奇怪之处。

*编辑：出于双重检查锁定的目的，如果*您的字段是`volatile`并且*如果*您使用的是 Java 5 或更高版本，则可以摆脱这种情况。在 Java 5 之前，内存模型还不够强大。你需要得到*完全*正确的模式。有关详细信息，请参阅 Effective Java，第 2 版，第 71 项。

编辑：这是我反对 Aaron 的内联在单个线程中可见的理由。假设我们有：

```
public class FooHolder
{
    public static Foo f = null;

    public static void main(String[] args)
    {
        f = new Foo();
        System.out.println(f.fWasNull);
    }
}

// Make this nested if you like, I don't believe it affects the reasoning
public class Foo
{
    public boolean fWasNull;

    public Foo()
    {
        fWasNull = FooHolder.f == null;
    }
} 
```

我相信这会*一直*报道`true`。从[第 15.26.1 节开始](http://java.sun.com/docs/books/jls/third_edition/html/expressions.html#15.26)：

> 否则，需要三个步骤：
> 
> *   首先，评估左侧操作数以产生变量。如果这个求值突然完成，那么赋值表达式也会因为同样的原因而突然完成；不计算右侧操作数，也不发生赋值。
> *   否则，评估右侧操作数。如果这个求值突然完成，那么赋值表达式也会因为同样的原因而突然完成并且没有赋值发生。
> 
> 否则，将右侧操作数的值转换为左侧变量的类型，进行值集转换（第 5.1.13 节）到适当的标准值集（不是扩展指数值集），并将转换的结果存储到变量中。

然后从[第 17.4.5 节](http://java.sun.com/docs/books/jls/third_edition/html/memory.html#17.4.5)：

两个动作可以通过happens-before关系排序。如果一个动作发生在另一个动作之前，那么第一个动作对第二个动作可见并在第二个动作之前排序。

> 如果我们有两个动作 x 和 y，我们写 hb(x, y) 来表示 x 发生在 y 之前。
> 
> *   如果 x 和 y 是同一线程的操作，并且 x 在程序顺序中位于 y 之前，则为 hb(x, y)。
> *   从对象的构造函数的末尾到该对象的终结器（第 12.6 节）的开头有一条发生前边缘。
> *   如果动作 x 与后续动作 y 同步，那么我们也有 hb(x, y)。
> *   如果 hb(x, y) 和 hb(y, z)，则 hb(x, z)。
> 
> 应该注意的是，两个动作之间存在之前发生的关系并不一定意味着它们必须在实现中以该顺序发生。如果重新排序产生与合法执行一致的结果，则不是非法的。

换句话说，即使在单个线程中发生奇怪的事情也是可以的，*但那一定是不可观察*的。在这种情况下，差异*是*可以观察到的，这就是为什么我认为这是非法的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-25T14:46:02.817

`someObject`在施工期间的某个时间点将变为非`null`。通常，有两种情况：

1.  优化器已内联构造函数
2.  构造函数没有内联。

在第一种情况下，VM 将执行以下代码（伪代码）：

```
someObject = malloc(SomeClass.size);
someObject.field = ...
.... 
```

所以在这种情况下，`someObject`is not`null` *并且*它指向没有 100% 初始化的内存，即并非所有的构造函数代码都已运行！这就是为什么[双重检查锁定](http://en.wikipedia.org/wiki/Double_checked_locking_pattern)不起作用的原因。

在第二种情况下，来自构造函数的代码将运行，引用将被传回（就像在正常的方法调用中一样），并且在所有初始化代码都运行*后*someObject 将被设置为引用的值。

问题是没有办法告诉java不要提前分配`someObject`。例如，您可以尝试：

```
SomeClass tmp = new SomeClass();
someObject = tmp; 
```

但是由于没有使用 tmp，优化器可以忽略它，所以它会产生与上面相同的代码。

所以这种行为是为了让优化器产生更快的代码，但在编写多线程代码时它会咬你一口。在单线程代码中，这通常不是问题，因为在构造函数完成之前不会执行任何代码。

[编辑] 这是一篇很好的文章，它解释了正在发生的事情：[http ://www.ibm.com/developerworks/java/library/j-dcl.html](http://www.ibm.com/developerworks/java/library/j-dcl.html)

PS：Joshua Bloch 的“ [Effective Java, Second Edition](https://rads.stackoverflow.com/amzn/click/com/0321356683) ”一书包含 Java 5 及更高版本的解决方案：

```
private volatile SomeClass field;
public SomeClass getField () {
    SomeClass result = field;
    if (result == null) { // First check, no locking
        synchronized(this) {
            result = field;
            if (result == null) { // second check with locking
                field = result = new SomeClass ();
            }
        }
    }
    return result;
} 
```

看起来很奇怪，但应该适用于每个 Java VM。请注意，每一点都很重要；如果您省略双重分配，您将获得糟糕的性能或部分初始化的对象。要获得完整的解释，请购买这本书。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T14:44:47.920

`someObject`将是一个空指针，直到它从该类型的构造函数中分配一个指针值。由于分配是从右到左的，因此另一个线程可以在构造函数仍在运行时进行**检查**`someObject`。这将在分配指向变量的指针之前，因此`someObject`仍然为空。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T15:01:15.743

在另一个线程中，在构造函数完成执行之前，您的对象仍将显示为 null。这就是为什么如果构造被异常终止，引用将保持为空。

```
Object o = null;
try {
    o = new CtorTest();
} catch (Exception e) {
    assert(o == null); // i will be null
} 
```

在哪里

```
class CtorTest {
    public CtorTest() {
        throw new RuntimeException("Ctor exception.");
    }
} 
```

确保在另一个对象上同步，而不是正在构造的对象。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-25T14:45:32.867

对于您的第一个示例： someObject 在构造函数完成后变为非空。如果您从另一个线程进行检查，则 someObject 在构造函数完成后将变为非空。请注意，您永远不应该从不同的线程访问未同步的对象，因此您的示例不应该在实际代码中以这种方式实现。

对于第二个示例， someObject 永远不会为 null，因为它是在 SomeClass 本身被构造并且 someObject 被创建并使用新创建的对象初始化之后构造的。线程也一样：不要在没有同步的情况下从不同的线程访问这个变量！

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-25T15:01:43.077

这是一些测试代码，它显示**对象在构造函数完成运行之前为空**：

```
public class Test {

  private static SlowlyConstructed slowlyConstructed = null;

  public static void main(String[] args) {
    Thread constructor = new Thread() {
      public void run() {
        Test.slowlyConstructed = new SlowlyConstructed();
      }
    };
    Thread checker = new Thread() {
      public void run() {
        for(int i = 0; i < 10; i++) {
          System.out.println(Test.slowlyConstructed);
          try { Thread.sleep(1000); }
          catch(Exception e) {}
        }
      }
    };

    checker.start();
    constructor.start();
  }

  private static class SlowlyConstructed {
    public String s1 = "s1 is unset";
    public String s2 = "s2 is unset";

    public SlowlyConstructed() {
      System.out.println("Slow constructor has started");
      s1 = "s1 is set";
      try { Thread.sleep(5000); }
      catch (Exception e) {}
      s2 = "s2 is set";
      System.out.println("Slow constructor has finished");
    }

    public String toString() {
      return s1 + ", " + s2;
    }
  }
} 
```

输出：

```
空值
缓慢的构造函数已启动
空值
空值
空值
空值
空值
慢构造器已完成
s1 已设置，s2 已设置
s1 已设置，s2 已设置
s1 已设置，s2 已设置
s1 已设置，s2 已设置

```

# xml - 在浏览器中可选择单个 XML 文档的多个样式表？

> ID：681889
> 
> 赞同：2
> 
> 时间：2009-03-25T14:41:06.137
> 
> 标签：xml, firefox, xslt

我有一个 XML 文件，我希望用户能够使用两个不同的样式表查看该文件。样式表是互斥的，因此一次只能激活其中一个。

我尝试将以下内容添加到我的 XML 文件的顶部：

```
`<?xml-stylesheet type="text/xsl" href="brief.xsl" title="Breif" ?>
<?xml-stylesheet type="text/xsl" href="detailed.xsl" title="Detailed" alternate="yes" ?>` 
```

`我期望发生的事情是`brief.xsl`将其用作默认样式表，并且“详细”将显示为“查看 - >页面样式”菜单中的一个项目，但 Firefox 似乎忽略了第二个样式表（我只得到项目“无样式”和“基本页面样式”，这是每个页面的默认设置）。`

 `Firefox 不支持该`alternate`属性，还是我做错了什么（其他）？其他浏览器支持吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T18:02:23.417

Firefox 3.5 Nightly 支持替代品，但没有内置功能来交换 xml-stylesheets，它只是尝试为结果文档交换样式表。

IE 6.0-8.0 不支持 xml-stylesheet 处理规则中的 alternate="yes"。所以它会处理第一个，而忽略第二个。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-03-25T14:53:06.263

我不具体了解 XML，但我已经看到它可以与 HTML 的备用样式表一起使用。

作为一个例子，看看这个网站：[http ://www.thesitewizard.com/javascripts/change-style-sheets.shtml](http://www.thesitewizard.com/javascripts/change-style-sheets.shtml)

它使用以下代码：

```
 link rel="stylesheet" type="text/css" href="../include/style.css" title="blue" media="screen" /
link rel="alternate stylesheet" type="text/css" href="../include/change-style-sheets/style-alternate.css" title="grey" media="screen" / 
```

我使用的是 firefox 2.0.0.19，“view->page style”显示“no style”、“blue”和“grey”。因此，至少在 HTML 中，firefox 可以处理多个备用样式表。

# c# - 页面退出时执行操作

> ID：681892
> 
> 赞同：1
> 
> 时间：2009-03-25T14:42:18.333
> 
> 标签：c#, asp.net, web-applications, page-lifecycle

我有一个 ASP.NET(2.0 C#) Web 应用程序，我想知道一旦用户移动到另一个页面或离开应用程序时如何执行操作。

当用户进入页面时，是否有类似的方法`page_load`，除了这个用于退出页面？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T14:44:40.807

当用户离开页面时，您需要使用 javascript 来告诉服务器。一旦页面离开服务器，网络服务器就会清洗它的手，而用户可能会保持页面打开一周。

如果您在页面上使用 javascript，当页面卸载以向您的服务器发出通知时，您可以采取一些措施。

虽然，您无法判断他是要离开您的页面进入您的另一个页面、另一个网站还是关闭浏览器。并且不能保证您发出的最后一条通知总是会发送，因此您不能完全依赖它。

您要寻找的场景是什么？可能有更好的方法来完成您正在尝试做的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T15:05:02.757

您可以处理 Javascript 的“onunload”或“onbeforeunload”事件。

有关详细信息和 ASP.Net 特定示例，请参阅文章“[使用 ASP.NET 提示用户在离开页面时保存](http://www.4guysfromrolla.com/articles/101304-1.aspx)”和“[提示用户在离开页面时保存”。](http://www.4guysfromrolla.com/webtech/100604-1.shtml)

MSDN 库中也描述了这些 Javascript 事件...

[卸载事件](http://msdn.microsoft.com/en-us/library/ms536973(VS.85).aspx)

[onbeforeunload 事件](http://msdn.microsoft.com/en-us/library/ms536907(VS.85).aspx)

# asp.net - 如果它发生变化，我想一次又一次地显示一个列，这可能吗？

> ID：681894
> 
> 赞同：0
> 
> 时间：2009-03-25T14:42:24.853
> 
> 标签：asp.net, vb.net, repeater

在中继器中，如果字段发生变化，是否可以只显示一次然后再次显示？

我希望它看起来像什么

```
声音的
 - 事物
 - 事物
 - 事物
视频
 - 事物
 - 事物
图片
 - 事物

```

它们将按类型任一音频视频图片排序，但我也不想重复音频视频图片。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T14:46:20.507

您想要的称为控制/中断报告。在 ASP.Net 中做这件事有点奇怪，但并非不可能。

见这些：

*   [在 VB asp.net 2.0 中对数据表的行进行分组](https://stackoverflow.com/questions/362979/grouping-rows-of-a-datatable-in-vb-asp-net-2-0)
*   [asp:repeater - 部分更改的标题](https://stackoverflow.com/questions/507215/asprepeater-headers-at-section-change)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T14:52:24.923

为什么不拦截后面代码中的 rowdatabound 事件并使用具有最后一个 Section 标题的全局变量，然后在它更改时注入一个元素，例如：

```
 public partial class _Default : System.Web.UI.Page 
{
    private string LastTitle = string.Empty;

    protected void Page_Load(object sender, EventArgs e)
    {

    }
    protected void Repeater1_ItemDataBound(object sender, RepeaterItemEventArgs e)
    {
        var title = (string) DataBinder.Eval(e.Item.DataItem,"TypeField");

        if (title != this.LastTitle )
        {
            e.Item.Controls.AddAt(

                0,
                new Literal()
                    {

                        Text = string.Format("<h2>{0}</h2>", title)
                    });
            this.LastTitle = title;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T14:56:55.850

我过去曾使用这组类在网格视图中进行分组和汇总。使用代码非常简单，只需几行代码即可配置。

[http://www.agrinei.com/gridviewhelper/gridviewhelper_en.htm](http://www.agrinei.com/gridviewhelper/gridviewhelper_en.htm)

# eclipse - Zend studio for eclipse - 它在Mac上的哪里存储它的项目文件？

> ID：681918
> 
> 赞同：0
> 
> 时间：2009-03-25T14:45:23.897
> 
> 标签：eclipse, zend-studio

我指的是 .xml 配置文件，其中包含项目文件的路径等内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T17:22:34.983

您是否查看过“~/Library/Application Support/”？

# wix - 功能标题中的 Wix 属性

> ID：681924
> 
> 赞同：1
> 
> 时间：2009-03-25T14:46:26.123
> 
> 标签：wix

我可以在功能标题和描述、快捷方式名称等中使用属性吗？属性的值是在 LaunchConditions 之前通过自定义操作设置的。我试过类似的东西

```
<Feature Id="Complete" Title="[APPNAME]" Description="[APPNAME] Installation" …&gt; 
```

但我只是得到一个功能标题 [APPNAME]，而不是我通过自定义操作设置的应用程序的名称。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T15:16:02.993

用于在值中引用属性的括号语法是 Windows Installer 本身的一项功能。更具体地说，它是[Formatted](http://msdn.microsoft.com/en-us/library/aa368609(VS.85).aspx)数据类型的一个特性。不幸的是，[Feature](http://msdn.microsoft.com/en-us/library/aa368585(VS.85).aspx)表的 Title 和 Description 字段是 Text 类型，这意味着这些值是按字面意思解释的（如您所见）。

如果您*真的*想要或需要这样做，我认为您必须创建一个自定义操作来修改 Feature 表的内容。使用[DTF（部署工具基础）](http://blog.torresdal.net/2008/09/03/WiXAndDTFIntroduction.aspx)的自定义操作将是解决此问题的一种方法。

# c# - 为什么 StringComparison.InvariantCultureIgnoreCase 不适用于此 Db4o linq 查询？

> ID：681926
> 
> 赞同：4
> 
> 时间：2009-03-25T14:47:03.500
> 
> 标签：c#, .net, linq, db4o

以下查询有效。当我输入带有错误大小写的名称时，我得到了正确的结果。

```
private static IObjectContainer db = Db4oFactory.OpenFile(db4oPath);

    public static IQueryable<Company> GetCompaniesByName(string name) { 
        return (from Company c in db
                where c.Name.ToLowerInvariant().Equals(name.ToLowerInvariant())
                select c).AsQueryable();
    } 
```

以下具有相同参数的查询（基本上相同的单元测试）不返回任何结果。标记唯一的区别是 where 子句。

```
 public static IQueryable<Company> GetCompaniesByName(string name) { 
        return (from Company c in db
                where c.Name.Equals(name, StringComparison.InvariantCultureIgnoreCase)
                select c).AsQueryable();
    } 
```

为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T14:52:40.117

LINQ 表达式解析器几乎可以自由地支持（或不支持）他们选择的任何一组操作。在 LINQ-to-SQL 和 EF 的情况下，如果他们被某些东西弄糊涂了，他们会抛出一个异常（我希望上面的内容属于这个）——但听起来 Db4o 只是在说“不匹配”。

Db40 是否能够记录它执行的查询？也许它正在做一些时髦的事情......但我们只能猜测......

# passwords - 如何使期望脚本提示输入密码？

> ID：681928
> 
> 赞同：25
> 
> 时间：2009-03-25T14:47:35.340
> 
> 标签：passwords, prompt, expect

我有一个通过 ssh 连接到几个路由器的期望脚本。所有这些路由器都有相同的密码（我知道，这是错误的），并且脚本需要知道该密码才能连接到路由器。目前，密码作为命令行参数传递给我的脚本，但这意味着在我的 .bash_history 文件以及正在运行的进程中都有该密码的痕迹。因此，如果可能的话，我希望提示用户输入密码。

你知道是否可以用expect提示用户输入密码？

谢谢你。

*编辑*：如果我连接到服务器而不是路由器，我可能会使用 ssh 密钥而不是密码。但是我使用的路由器只支持密码。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-03-25T20:50:14.750

像这样使用expect的`stty`命令：

```
# grab the password
stty -echo
send_user -- "Password for $user@$host: "
expect_user -re "(.*)\n"
send_user "\n"
stty echo
set pass $expect_out(1,string)

#... later
send -- "$pass\r" 
```

请注意，在打电话`stty -echo` **之前先**打电话很重要`send_user`——我不确定为什么：我认为这是一个时间问题。

期望程序员都应该阅读*这*本书：Don Libes 的 Exploring Expect

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-01-24T19:19:11.573

好的，合并上面的 2 个答案（或下面或现在的任何地方！）：

```
#!/usr/bin/expect
log_user 0
set timeout 10
set userid  "XXXXX"
set pass    "XXXXXX"

### Get two arguments - (1) Host (2) Command to be executed
set host    [lindex $argv 0] 
set command [lindex $argv 1]

# grab the password
stty -echo
send_user -- "Password for $userid@$host: "
expect_user -re "(.*)\n"
send_user "\n"
stty echo
set pass $expect_out(1,string)

spawn /usr/bin/ssh -l $userid $host
match_max [expr 32 * 1024]

expect {
    -re "RSA key fingerprint" {send "yes\r"}
    timeout {puts "Host is known"}
}

expect {
     -re "username: " {send "$userid\r"} 
     -re "(P|p)assword: " {send "$pass\r"}
     -re "Warning:" {send "$pass\r"}
     -re "Connection refused" {puts "Host error -> $expect_out(buffer)";exit}
     -re "Connection closed"  {puts "Host error -> $expect_out(buffer)";exit}
     -re "no address.*" {puts "Host error -> $expect_out(buffer)";exit}

     timeout {puts "Timeout error. Is host down or unreachable?? ssh_expect";exit}
}

expect {
   -re "\[#>]$" {send "term len 0\r"}
   timeout {puts "Error reading prompt -> $expect_out(buffer)";exit}
}

expect {
   -re "\[#>]$" {send "$command\r"}

   timeout {puts "Error reading prompt -> $expect_out(buffer)";exit}
}

expect -re "\[#>]$"
set output $expect_out(buffer)
send "exit\r"
puts "$output\r\n" 
```

请注意，我将 $password 变量更改为 $pass 以与其他答案保持一致。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-11T18:45:43.710

或者，您可以使用 SSH_ASKPASS 环境变量让 ssh 通过 X11 收集密码。

从手册页：

```
> SSH_ASKPASS
>     If ssh needs a passphrase, it will read the passphrase from the
>     current terminal if it was run from a terminal.  If ssh does not
>     have a terminal associated with it but DISPLAY and SSH_ASKPASS
>     are set, it will execute the program specified by SSH_ASKPASS
>     and open an X11 window to read the passphrase.  This is particularly
>     useful when calling ssh from a .xsession or related script.
>     (Note that on some machines it may be necessary to redirect the
>     input from /dev/null to make this work.) 
```

# authentication - 如果设置了“记住我”，如何更新上次登录日期？

> ID：681929
> 
> 赞同：4
> 
> 时间：2009-03-25T14:47:44.903
> 
> 标签：authentication, login, membership

当用户登录到我的站点时，访问日期会被标记在数据库（用户表）中。这由（自定义）成员资格提供程序处理。但是，如果用户选中“还记得我吗？” 登录时的选项，他们（自然）不会在随后的访问中提示登录。由于在这种情况下不使用会员提供者，因此不会在数据库中更新上次登录日期。

使用表单身份验证，我如何确保在每次新访问站点时更新上次登录日期，而不是仅在他们实际登录时更新？有什么我可以参与的活动来实现这一目标吗？

我不能使用会话状态，因为它在我正在开发的网站中被完全禁用（会话模块已被删除）。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T14:55:08.943

我假设您正在使用 cookie（我看不出“记住我”会如何工作）。

当用户登录时，设置两个 cookie，一个是永久的（如果选中了记住我），一个是临时的（仅限此会话）。第二个是你用来授权用户的东西。

因此，在用户需要登录的页面上，查找会话 cookie。如果找到，请照常继续。如果未找到，则查找永久 cookie，如果找到，则查找用户，*设置登录日期*，并设置会话 cookie。（如果没有找到永久cookie，他只是没有登录）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T14:56:00.687

假设您正在谈论 ASP.NET 2.0（鉴于成员资格提供者的评论）。

无论您在何处检查 cookie 以查看用户是否应该自动登录，您都应该调用成员资格提供商的 GetUser 函数，该函数需要一个布尔值来更新用户的活动日期。

根据[MSDN 文档](http://msdn.microsoft.com/en-us/library/system.web.security.membershipprovider.getuser.aspx)：

**MembershipProvider.GetUser 方法**

将唯一用户标识符和一个布尔值作为输入，该值指示是否更新用户的 LastActivityDate 值以显示用户当前在线。GetUser 方法返回一个 MembershipUser 对象，该对象填充了指定用户的数据源中的当前值。如果在数据源中找不到用户名，GetUser 方法将返回 null（在 Visual Basic 中为 Nothing）。

# c# - WPF 和音乐播放器

> ID：681932
> 
> 赞同：1
> 
> 时间：2009-03-25T14:47:54.980
> 
> 标签：c#, .net, wpf, linq

我收到了创建具有特定功能的音乐播放器的请求。

此音乐播放器将以“随机”（第一次请求）从文件夹下载歌曲的方式播放音乐，还有一个请求是每 4 小时更改一次音乐的“流派”，例如：

*   从早上 8 点到 12 点：播放“浪漫”歌曲；
*   从上午 12 点到下午 4 点：播放“拉丁”歌曲；
*   从下午 4 点到晚上 8 点：播放“摇滚”歌曲；
*   从晚上 8 点到午夜：播放“舞蹈”音乐；

我的目的是为每种流派创建不同的歌曲文件夹，并给出各自的标题名称（浪漫、拉丁、摇滚等），当音乐播放器启动时，将按照时间段自动下载歌曲的文件夹。

所以我问你一些关于如何组织这些功能的代码的建议，因为我不知道如何在几个小时内改变流派音乐并将音乐播放器置于随机模式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T15:57:39.993

这是一种方法。

[使用C# ID3 库](http://sourceforge.net/projects/csid3lib/)或任何其他用于 MP3 文件的 ID3 标签阅读器读取播放列表或文件夹中的 MP3 文件的所有 ID3 标签。探测播放列表，读取 ID3 标签，创建一个 repo。设置计时器并从您已阅读的回购中选择一种流派

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T15:59:35.387

你说你正在从一个文件夹中下载歌曲，这让我相信有一个服务器正在将信息传送到媒体播放器。

我会把这个逻辑放到服务器端。只需使用那里的任何常规媒体播放器即可。

然后，在服务器端，生成某种类型的提要，根据服务器上的时间提供要下载的歌曲的 URL（如果客户端提供，则通过偏移量调整）。

然后，您的程序将读取提要并获取要播放的歌曲的 url，然后根据服务器告诉您的内容将播放列表提供给媒体播放器（或下载歌曲并将它们提供给媒体播放器）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T16:00:09.487

在您的应用程序中看起来很有用的一个概念是歌曲源的概念。歌曲源本质上是一个提供歌曲访问权限的可枚举项。这可能首先是一个接口。

这样你就有了一段代码提供歌曲列表的抽象概念。实际播放器将访问**ISongSource**的任何实现以获取下一首要播放的歌曲并播放它。玩的那位，恐怕我帮不了你。如果一切都失败了，您可以从您的歌曲源创建 m3u 文件（mp3 播放列表）并通过 Process.Start 启动例如 Winamp，传递新创建的播放列表。事实上，这听起来像是一个简洁的版本 1。

如果您想对所有内容进行编码，您可能需要一段代码来从 mp3 文件中读取 ID3 标签（如果您正在播放 mp3 文件）。您应该将其视为独立的功能，并且很有可能已经有一些可用的东西。ID3 标记不是很复杂，如果我记得很清楚的话，在 mp3 文件的开头有定义的字节偏移量。

基于此，您应该能够实现考虑 ID3 标签的歌曲源，以便决定哪些歌曲应该是源的一部分。

最后是用户界面。那是一个独立的世界，特别是如果你有一个可剥皮的东西。但是，有了一本不错的 WPF 书籍和一些概念证明，您应该可以完成一些工作。

快乐编码！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T16:13:22.373

它必须是全新的媒体播放器吗？根据您的要求，您可能会考虑包装 Windows Media Player 来执行此操作。这是一个很好的起点：

[(Windows Media Player) Visual Basic .NET 和 C# 的对象模型参考](http://msdn.microsoft.com/en-us/library/bb249260(VS.85).aspx)

我已经使用 Windows Media Player SDK 来做类似的事情。它不是最简单的 API，但它只是一个 DLL，向它发送命令以让 WMP 做事相对容易。以下是各种 SDK 版本的链接（包括您需要的 wmppia.dll）：

[Windows 媒体下载](http://msdn.microsoft.com/en-us/windowsmedia/bb190309.aspx)

# xml - 刷新标准 .net 2.0 网格/XMLsource

> ID：681934
> 
> 赞同：0
> 
> 时间：2009-03-25T14:48:05.200
> 
> 标签：xml, gridview, .net-2.0

我有一个使用 XMLDatasource 的标准 .net 2.0 数据网格。通过在按钮单击事件上将 XML 字符串传递给 XMLdatasource 的“Data”属性来动态设置数据源。

这在第一次工作得很好，但在随后的按钮点击中却没有。

即，即使传入的 xml 更改网格仅显示初始输出。

为了确保网格刷新以显示正确的值，我需要做些什么吗？

当前代码

aspx 网格代码

```
<asp:GridView ID="GridView1" 
          Runat="server" 
          DataSourceID="XmlDataSource5" 
          AutoGenerateColumns="False" AllowPaging="True"
          style="width:100%; height:100%;" 
          AutoGenerateSelectButton="True" 
          EnableViewState="False">
    <SelectedRowStyle BackColor="Red" />
    <Columns>
       <asp:BoundField DataField="TYPE" HeaderText="TYPE" SortExpression="TYPE" />
       <asp:BoundField DataField="DESCRIPTION" HeaderText="DESCRIPTION" SortExpression="DESCRIPTION" />
    </Columns>
</asp:GridView> 
```

vb.net代码

```
Private Sub btnTest_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnTest.Click

    XmlDataSource5.Data = _testLib.GetGridXML(_Num)
    GridView1.DataBind()
End Sub 
```

其中 _testLib.GetGridXML 是一个函数，它根据传入的 _Num 返回 XML 字符串。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T15:01:01.797

您需要在网格上调用 DataBind 以将其重新绑定到数据源中的更新值

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T17:31:17.287

问题在于数据源本身的设置，而不是 Gridview！

为了使其刷新，我需要将 XMLDatasource 中的“EnableCaching”属性设置为“False”（默认设置为“True”）。

即使不调用 Gridview.DataBind 方法，网格现在也能正常刷新。

感谢您的时间和帮助宏！

# internet-explorer - IE双打印问题

> ID：681935
> 
> 赞同：2
> 
> 时间：2009-03-25T14:48:15.043
> 
> 标签：internet-explorer, cross-browser, printing-web-page

好吧……这太奇怪了。

我有一个由我的客户打印的表格，在 Firefox 中它很棒！在铬中它很棒！在 IE 中...它会打印两次问题。从 13 到 26 页。

我想不通 [http://intranet.barberitos.com/compliance_new/index.php?Form_ID=1&store_address=16](http://intranet.barberitos.com/compliance_new/index.php?Form_ID=1&store_address=16)

任何想法都会有所帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T21:07:50.403

确保您的表单没有跨两个 div 拆分。这可能会导致 IE7 出现打印问题。

# multithreading - 关于信号量的问题

> ID：681937
> 
> 赞同：0
> 
> 时间：2009-03-25T14:48:52.483
> 
> 标签：multithreading, operating-system, semaphore

给定以下代码，您能弄清楚是什么原因导致“您输入 7 个字符”出现 3 次，尤其是最后一次？

```
#include <stdio.h>
#include <unistd.h>
#include <stdlib.h>
#include <string.h>
#include <pthread.h>
#include <semaphore.h>
void *thread_function(void *arg);
sem_t bin_sem;
#define WORK_SIZE 1024
char work_area[WORK_SIZE];
int main(){
    int res;
    pthread_t a_thread;
    void *thread_result;
    res = sem_init(&bin_sem,0,0);
    if (res!=0){
        perror("Semaphore initialization failed");
        exit(EXIT_FAILURE);
    }
    res = pthread_create(&a_thread,NULL,thread_function,NULL);
    if (res!=0){
        perror("Thread creation failed");
        exit(EXIT_FAILURE);
    }
    printf("Input some text. Enter ‘end’ to finish");
    while (strncmp("end",work_area,3)!=0){
        if(strncmp(work_area,"FAST",4)==0){
            sem_post(&bin_sem);
            strcpy(work_area,"Wheeee...");
        }else{
            fgets(work_area,WORK_SIZE,stdin);
        }
        sem_post(&bin_sem);
    }
    printf("\nWaiting for thread to finish\n");
    res = pthread_join(a_thread,&thread_result);
    if(res!=0){
        perror("Thread join failed!");
        exit(EXIT_FAILURE);
    }
    printf("Thread joined\n");
    sem_destroy(&bin_sem);
    exit(EXIT_SUCCESS);
}
void *thread_function(void* arg){
    sem_wait(&bin_sem);
    while(strncmp("end",work_area,3)!=0){
        printf("You input %d characters\n",strlen(work_area-1));
        sem_wait(&bin_sem);
    }
    pthread_exit(NULL);
} 
```

测试输入/输出：

```
$ cc -D_REENTRANT thread3a.c -o thread3a -lpthread
$ ./thread3a
Input some text. Enter ‘end’ to finish
Excession
You input 9 characters
FAST
You input 7 characters
You input 7 characters
You input 7 characters
end
Waiting for thread to finish...
Thread joined 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T15:25:00.400

输入“FAST”后：

*   sem_post（while 循环末尾的那个）--> bin-sem = 1
*   测试 work_area == end (FALSE)
*   测试 work_area == FAST (TRUE)
*   sem_post --> bin-sem = 2
*   work_area = 哇...
*   sem_post（while 循环末尾的那个）--> bin-sem = 3
*   测试 work_area == end (FALSE)
*   测试 work_area = FAST (FALSE)
*   等待输入

我认为主线程在调用 fgets(..stdin..) 时具有优先级直到被阻塞，然后线程函数可以运行并使用信号量令牌。

这里有迹可循。

```
> Input some text.
  Main thread :
    work_area = ?;
    bin_sem = 0;

  thread function :
    wait on semaphore;

< Excession
  Main thread :
    work_area = Excession;
    bin_sem = 1;

  thread function :
    work_area == Excession; (!= end)
> You input 9 characters; (1)
    bin_sem = 0;
    wait on semaphore;

  Main thread :
    work_area == Excession; (!= end)
    work_area == Excession; (!= FAST)
< FAST
    bin_sem = 1;
    work_area == FAST; (!= end)
    work_area == FAST;
    bin_sem = 2;
    work_area == Wheeee...;
    bin_sem = 3;
    wait on stdin;

  thread function :
    work_area == Wheeee...; (!= end)
> You input 7 characters; (Why seven?)
    bin_sem = 3-1 = 2;
> You input 7 characters; (Why seven?)
    bin_sem = 2-1 = 1;
> You input 7 characters; (Why seven?)
    bin_sem = 1-1 = 0;
    wait on semaphore; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T15:34:41.217

该行在线程函数中是错误的。

```
printf("You input %d characters\n",strlen(work_area-1)); 
```

应该是`strlen(work_area)`，不是`strlen(work_area-1)`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T15:03:01.950

输出似乎不是来自列出的代码版本：

printf("输入一段文字");

不能产生：

输入一些文字。输入'end'完成

此外，您或多或少地在两个线程之间不规则地控制循环，然后将它们与全局变量绑定。这是一种“goto”类型的构造，只是在自找麻烦……

保罗。

# editor - 你能推荐一个非 HTML WYSIWYG 网络编辑器吗？

> ID：681941
> 
> 赞同：27
> 
> 时间：2009-03-25T14:49:21.110
> 
> 标签：editor, wysiwyg, markdown, bbcode

我正在市场上寻找优秀的所见即所得编辑器。我的用户会像我现在在 Stack Overflow 上一样写东西，但他们不像 SO 用户那样精通技术，所以我需要一个所见即所得的编辑器而不是这个 Markdown 编辑器。

功能方面，我希望编辑器具有与此编辑器的按钮大致相同的功能，即粗体/斜体/链接/引号/列表（编号/项目符号）/标题。更多功能当然很有趣。

我希望编辑器不要保存为 HTML，而是使用其他格式，如 BBCode 或 Markdown。这是因为我想最小化我们的用户将脚本或任何其他讨厌的东西注入我们的数据库的可能性。

那里有很多不同的所见即所得编辑器，例如 FCKeditor、TinyMCE 等，但不幸的是，它们中的大多数都保存在 HTML 中。

不过，TinyMCE 有一个 BBCode 模式，但我读到 TinyMCE[有点臃肿](https://stackoverflow.com/questions/98852/wysiwyg-text-editor-for-webpage/124984#124984)。我偶然发现了一个[Markdown WYSIWYG 项目](http://sourceforge.net/projects/md-wysiwyg/)，它似乎或多或少已经死了。

您还有其他建议吗？

如果编辑器是基于 jQuery 构建的，那将是一个加分项。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T20:17:53.283

您应该查看 MarkItUp ( [http://markitup.jaysalvat.com/home/](http://markitup.jaysalvat.com/home/) )。它基于 jQuery 构建，支持各种标记语法（Markdown、wiki、BBcode 等）。此外，我相信它相当轻量级（至少比 tinyMCE 或 FCKeditor 更轻）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-05-20T15:41:50.310

[所见即所得的 bbcode](http://wysiwygbbcode.codeplex.com/)（免费和开源）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-03-10T19:10:04.223

正如我在[这个答案](https://stackoverflow.com/a/22309117/458193)中所说：

[Pen](http://sofish.github.io/pen/)是一种新的（自 2014 年起生效）输出 Markdown 的所见即所得编辑器。
它并不完美——我在粘贴 HTML 时遇到了问题——但它可以工作。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-18T20:05:40.250

你应该看看以下，

**wysihat**是全新的开始，并由精通设计的公司提供支持 :-)

[http://github.com/37signals/wysihat/tree/master](http://github.com/37signals/wysihat/tree/master)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-25T14:51:19.793

也许这个[轻量级标记语言列表](http://en.wikipedia.org/wiki/List_of_lightweight_markup_languages)可能会帮助您进行搜索。

[克里奥尔引擎支持](http://wiki.wikicreole.org/Engines)
[MediaWIKI Editor](http://www.mediawiki.org/wiki/WYSIWYG_editor)
[Textile](http://textile.thresholdstate.com/)
[Texy！Playground](http://texy.info/en/try)
[txt2tags 在线](http://txt2tags.sourceforge.net/online.php)

其中一些有工具，一些只有在线演示，这完全取决于社区和项目的进展情况。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-01-05T21:42:59.547

或者，以 HTML 格式保存，然后在将数据发送到数据库之前对其进行[净化。](http://htmlpurifier.org)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-21T20:03:53.970

您是否考虑过为此使用基于 Web 的编辑器甚至内容管理系统？有许多具有体面、安全的网页编辑器的 CMS/wiki。我首先想到的是 Drupal、Plone 和 Atlassian Confluence。

# c# - UpdatePanel 重新呈现表单

> ID：681942
> 
> 赞同：0
> 
> 时间：2009-03-25T14:49:21.187
> 
> 标签：c#, asp.net

我有一个看起来像这样的 ascx：

```
<UpdatePanel Parent mode = Conditional>
  <UpdatePanel1 mode = Conditional>
    //A form here with textboxes, etc

    //A repeater here with a linkbutton that causes a postback

  </UpdatePanel1>
</UpdatePanel Parent> 
```

在转发器的 OnItemCommand 中，我获取表单值并设置它们。它工作正常，但会重新呈现表单（即，在闪烁期间表单消失并重新出现）。考虑到我在 UpdatePanel 中有它，为什么会发生这种情况？

**编辑：通过将表单和转发器分成不同的更新面板，我似乎已经解决了一半的问题。但是，现在的问题是，即使服务器端代码运行，当我单击转发器中的链接按钮时，表单也不会更新。**

再次编辑：

我想我知道发生了什么。在确定这个之前我有 1 个问题（希望如此）。表格如下所示：

```
<tr>
  <td>
    <asp:checkbox id="chkSelect" runat="server" />
    <asp:label text="Something"   runat="server" />
    <asp:textbox id="txtSomething" runat="server" />
  </td>
</tr>
<tr>
  <td>
    <asp:checkbox id="chkSelect2" runat="server" />
    <asp:label text="Something2"   runat="server" />
    <asp:textbox id="txtSomething2" runat="server" />
  </td>
</tr> 
```

单击链接按钮时，我只关心仅更新文本框控件。我希望其他一切都保持原样。

有没有办法仅在这些控件上有条件地触发更新？

我知道我可以使用 JS，但宁愿避免它（因为在我知道文本框的值之前有很多服务器端处理）

***@Roselberg-我不感兴趣的控件状态实际上是在客户端设置在一个巨大的JS脚本中，该脚本在负载时运行，我对脚本没有太多控制权***

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T21:22:27.887

如果您只想有条件地更新文本框，那么您需要将它们放在它们自己的 UpdatPanel 中。确保这些 UpdatePanel 由您的链接按钮触发，并且一切正常。

虽然我不太确定你的意思

> 我希望其他一切都保持原样。

复选框和标签只有在您有代码在回发期间更改它们时才会更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T21:30:08.913

ASP.NET AJAX 的体系结构实际上覆盖了 UpdatePanel 中的整个 html。它不会单独更新值。基本上，有以下三种选择：

*   将文本框和复选框放在单独的更新面板中。看起来这不适用于您的场景。
*   确保在回发时传输值，以确保控件保持相同的显示。它们实际上会被覆盖，但如果它们被相同的值覆盖，这应该不会引起注意。
*   使用不同的 AJAX 方法来回调处理程序，而不是为这些使用 ASP.NET AJAX。使用 javascript 调用处理程序，然后单独更新值，而不是像 ASP.NET AJAX 那样替换控件。这很容易使用[jquery get 方法](http://docs.jquery.com/Ajax/jQuery.get)或[客户端回调](http://www.dotnetjunkies.ddj.com/Article/E80EC96F-1C32-4855-85AE-9E30EECF13D7.dcik)。

# c++ - 如何获得 std::map 的 std::set 键

> ID：681943
> 
> 赞同：38
> 
> 时间：2009-03-25T14:50:01.263
> 
> 标签：c++, stl, map, set

今天早上我正在写一个算法，我遇到了一个奇怪的情况。我有两个`std::map`s。我想对每个键的集合执行集合交集（以查找两个映射共有的键）。在未来的某个时候，我想我很可能也想在这里执行集合减法。幸运的是，STL 包含这两种操作的功能。问题是，我似乎无法`std::set`从`std::map`. 有没有办法做到这一点？我正在寻找这样简单的东西，就像在 Java 中一样：

```
std::set<Foo> keys = myMap.getKeySet(); 
```

我的理解是，我不能`std::set_intersection()`直接在映射中的迭代器上使用该函数，因为映射公开`std::pair`对象而不仅仅是键。另外，我认为地图不能保证秩序。我也有兴趣在一对`std::multimap`s 上执行相同的操作，如果这有什么不同的话。

**编辑**：我最初忘了提到，由于我被迫使用的编译器的年龄（MSVC++ 6），大多数在 boost 中可用的漂亮模板技巧都不能使用。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-25T14:57:46.940

您基本上想要的是一份副本，因为 std::map 不会将密钥保存在 std::set 中。std::copy 假定值类型是兼容的，这里不是这种情况。std::map::value_type 是一个 std::pair。您只想复制该对的第一部分，这意味着您需要一个 std::transform。现在，由于您将在集合上使用 insert_iterator，因此顺序无关紧要。std::set 将在插入时排序，即使地图已经排序。

[编辑] 代码可能更容易。我的头顶，没有编译。

```
std::transform(MyMap.begin(), MyMap.end(),
    std::inserter(MySet, MySet.end()),
    boost::bind(&std::pair<Key,Value>::first, _1)); 
```

如果您有 SGI 的 select1st，则不需要 boost::bind。

[编辑] 为 C++14 更新

```
std::transform(MyMap.begin(), MyMap.end(),
    std::inserter(MySet, MySet.end()),
    [](auto pair){ return pair.first; }); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-25T15:03:58.670

地图*确实*保证秩序；这就是为什么它被称为[排序的关联容器](http://www.sgi.com/tech/stl/Map.html)。[您可以将 set_intersection 与自定义比较器函数（此处](http://en.cppreference.com/w/cpp/algorithm/set_intersection)列出的第二个变体）一起使用。

所以，像

```
bool your_less(const your_map::value_type &v1, const your_map::value_type &v2)
{ return v1.first < v2.first; }

set_intersection(m1.begin(), m1.end(), m2.begin(), m2.end(), your_output_it, your_less); 
```

应该做的伎俩。（也可以使用 boost::lambda 和 bind 来避免编写临时函数。）

默认的 operator< over pairs 比较两个组件。由于您只需要对的第一部分（映射键）等价，因此您需要定义自己的比较运算符来提供这种关系（这就是上面的函数所做的）。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-25T15:04:34.147

在实践中，

```
yourmap::const_iterator mi;
set<key_type> k;
for (mi = yourmap.begin(); mi != yourmap.end(); ++mi)
  k.insert(mi->first);
return k; 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-25T15:01:08.723

您可以使用通用的 boost::transform_iterator 返回一个仅返回键（而不是值）的迭代器。请参阅[如何从 std::map 检索所有键（或值）并将它们放入向量中？](https://stackoverflow.com/questions/110157/how-to-retrieve-all-keys-or-values-from-a-stdmap/110228#110228)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-03-05T19:42:29.220

最好的非 SGI、非 boost STL 算法友好的解决方案是像这样扩展 map::iterator：

```
template<typename map_type>
class key_iterator : public map_type::iterator
{
public:
    typedef typename map_type::iterator map_iterator;
    typedef typename map_iterator::value_type::first_type key_type;

    key_iterator(const map_iterator& other) : map_type::iterator(other) {} ;

    key_type& operator *()
    {
        return map_type::iterator::operator*().first;
    }
};

// helpers to create iterators easier:
template<typename map_type>
key_iterator<map_type> key_begin(map_type& m)
{
    return key_iterator<map_type>(m.begin());
}
template<typename map_type>
key_iterator<map_type> key_end(map_type& m)
{
    return key_iterator<map_type>(m.end());
} 
```

然后像这样使用它们：

```
 map<string,int> test;
        test["one"] = 1;
        test["two"] = 2;

        set<string> keys;

//      // method one
//      key_iterator<map<string,int> > kb(test.begin());
//      key_iterator<map<string,int> > ke(test.end());
//      keys.insert(kb, ke);

//      // method two
//      keys.insert(
//           key_iterator<map<string,int> >(test.begin()),
//           key_iterator<map<string,int> >(test.end()));

        // method three (with helpers)
        keys.insert(key_begin(test), key_end(test)); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-25T14:56:59.313

您可以迭代并将每个键添加到集合中。集合和映射都是有序的，无序的变体不是。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-25T20:41:48.483

[我在这里](http://bytes.com/groups/cpp/759728-initialize-std-set-keys-std-map)找到了您问题的好链接

并为您的问题提供一些代码：

```
 #include <iostream>
    #include <map>
    #include <set>
    #include <iterator>

    typedef std::map<std::string, int> MyMap;

    // also known as select1st in SGI STL implementation
    template<typename T_PAIR>
    struct GetKey: public std::unary_function<T_PAIR, typename T_PAIR::first_type>
    {
        const typename T_PAIR::first_type& operator()(const T_PAIR& item) const
        {
            return item.first;
        }
    };

    int main(int argc, char** argv)
    {
        MyMap m1,m2;

        m1["a"] = 1;
        m1["b"] = 2;
        m2["c"] = 3;
        m2["b"] = 3;

        std::set<std::string> s;
        std::transform(m1.begin(), m1.end(), std::inserter(s, s.begin()), GetKey<MyMap::value_type>());
        std::transform(m2.begin(), m2.end(), std::inserter(s, s.begin()), GetKey<MyMap::value_type>());
        std::copy(s.begin(), s.end(), std::ostream_iterator<std::string>(std::cout, " "));
        std::cout << std::endl;
        return 0;
    } 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-12-23T20:51:28.763

您也许可以为仅使用 boost::adapters::map_key 生成键的映射创建迭代器，请参见[boost::adapters::map_key 文档](http://www.boost.org/doc/libs/1_53_0/libs/range/doc/html/range/reference/adaptors/reference/map_keys.html "这里")中的示例。这似乎是在 Boost 1.43 中引入的，并且应该与 C++ 2003 兼容，但我不知道具体的 VC++ 6，它来自 C++ 98 时代。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-06-20T18:52:01.220

从 zvrba 的回答和 dianot 的评论开始：

只要把接收集合变成pairs的vector而不是map，dianot指出的问题就结束了。因此，使用 zvrba 示例：

```
std::vector<std::pair<keytype, valtype>> v;

set_intersection(m1.begin(), m1.end(), m2.begin(), m2.end(),
std::back_inserter(v), []( std::pair<keytype, valtype> const & a,
std::pair<keytype, valtype> const & b){return a.first < b.first;}); 
```

因此，无需构建中间副本或集合，我们就可以有效地获得两个映射的交集。这个结构用 gcc5.3 编译。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-10-29T13:45:28.720

我有同样的问题。我通过使用函数模板解决了它

```
template <class T, class U>
set<T> getSetFromKeys(map<T,U> mapWithKeys){

  set<T> outputSet;

  for (pair<const T, U> keyValuePair : mapWithKeys) {
    outputSet.insert(keyValuePair.first);
  }

  return outputSet; 
} 
```

这样，我就有了一种从应用程序中的映射中提取键的通用方法。

# c# - 抽象工厂模式和属性

> ID：681952
> 
> 赞同：3
> 
> 时间：2009-03-25T14:51:56.343
> 
> 标签：c#, .net, design-patterns

我对设计模式有些陌生，这是我在 stackoverflow 上的第一篇文章，所以希望这个问题有意义。我创建了一个抽象工厂来处理为不同的图表供应商（dundas、flash 等）生成 xml 字符串。下面是我工厂的代码大纲（如果有帮助，我可以包括更多。）我希望我的客户能够设置在所有类型的图表（标题、动画等）中通用的属性。所以客户可以做这样的事情：

```
 GraphCreator fusion = new FusionGraphs();

        //set the props for the graph
        fusion.Caption = "Fusion 2D Line Chart"; 
```

做这个的最好方式是什么？现在，我在抽象创建者中设置属性，以便客户端可以访问它们，但我还必须在我的工厂中复制这些属性，以便我可以在构建 xml 时访问它们。

//这是抽象工厂

```
public interface IXMLFactory
{

    //add interface methods
    IRoot makeRoot();
    IRootAttrib makeRootAttrib();
    INodes makeNodes();
    INodeAttrib makeNodeAttrib();

} 
```

//这是抽象创建者

```
public abstract class GraphCreator
{

    public virtual Graph getGraph(Graph.Types graphType)
    {
        //abstract product
        Graph graph;

        //abstract product creation
        graph = buildGraph(graphType); 

        graph.draw(); 

        return graph;

    }

    public abstract Graph buildGraph(Graph.Types graphType);

} 
```

//这是具体的创建者

```
public class FusionGraphs : GraphCreator
{
    Graph g = null;

    //XML parts for fusion 2D multi series
    IXMLFactory xmlFactory;

    //use xml parts that are needed for the type of fusion graph requested
    public override Graph buildGraph(Graph.Types graphType)
    {
        switch (graphType)
        {
            case Graph.Types.Single2DLine:
                xmlFactory = new Fusion2DSingleXMLFactory();
                g = new Single2DLineGraph(xmlFactory);
                xmlFactory.Caption = base.Caption;                     
                break;
            case Graph.Types.Single2DBar:
                xmlFactory = new Fusion2DSingleXMLFactory();
                g = new Single2DBarGraph(xmlFactory);

                break;
        }

        return g;
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T02:49:43.530

我不确定我是否理解了这个的全部范围，但这似乎你应该能够创建一些表示不同类型图的共享属性的对象，并将该对象公开为抽象的属性创建者，可由具体的创建者访问，甚至可以作为参数传递给各个 xmlFactory 构造函数。调用者可以通过访问暴露它的属性直接在该对象上设置这些属性，具体类可以从该对象中读取它们。然而，这确实意味着调用者要通过一个更高级别的间接来访问这些公共属性。

我不太明白你有什么重复。您在抽象创建者上实现了属性，但您说您还“在工厂中复制这些属性”？你指的是具体的创造者吗？我不明白为什么——你指的是base.Caption，那么为什么你需要在FusionGraphs中复制任何东西，如果它都是从GraphCreator继承的，并且你正在使用它的基类实现呢？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T15:00:24.607

我认为您的问题是如何在调用工厂的类和工厂本身之间共享配置信息。实现一个单独的类来保存配置信息（例如标题），然后向工厂和创建者提供对它的引用。

# python - 如何装饰班级？

> ID：681953
> 
> 赞同：152
> 
> 时间：2009-03-25T14:52:02.570
> 
> 标签：python, decorator, python-2.5

在 Python 2.5 中，有没有办法创建装饰类的装饰器？具体来说，我想使用装饰器将成员添加到类并更改构造函数以获取该成员的值。

寻找类似以下的内容（在 'class Foo:' 上有语法错误：

```
def getId(self): return self.__id

class addID(original_class):
    def __init__(self, id, *args, **kws):
        self.__id = id
        self.getId = getId
        original_class.__init__(self, *args, **kws)

@addID
class Foo:
    def __init__(self, value1):
        self.value1 = value1

if __name__ == '__main__':
    foo1 = Foo(5,1)
    print foo1.value1, foo1.getId()
    foo2 = Foo(15,2)
    print foo2.value1, foo2.getId() 
```

我想我真正追求的是一种在 Python 中执行类似 C# 接口的方法。我想我需要改变我的范式。

* * *

## 回答 #1

> 赞同：220
> 
> 时间：2009-03-25T15:58:22.050

除了类装饰器是否是您问题的正确解决方案的问题之外：

在 Python 2.6 及更高版本中，有带有 @-syntax 的类装饰器，因此您可以编写：

```
@addID
class Foo:
    pass 
```

在旧版本中，您可以采用另一种方式：

```
class Foo:
    pass

Foo = addID(Foo) 
```

但是请注意，这与函数装饰器的工作方式相同，并且装饰器应该返回新的（或修改后的原始）类，这不是您在示例中所做的。addID 装饰器看起来像这样：

```
def addID(original_class):
    orig_init = original_class.__init__
    # Make copy of original __init__, so we can call it without recursion

    def __init__(self, id, *args, **kws):
        self.__id = id
        self.getId = getId
        orig_init(self, *args, **kws) # Call the original __init__

    original_class.__init__ = __init__ # Set the class' __init__ to the new one
    return original_class 
```

然后，您可以如上所述为您的 Python 版本使用适当的语法。

但我同意其他人的观点，如果你想覆盖继承更适合`__init__`。

* * *

## 回答 #2

> 赞同：86
> 
> 时间：2009-03-25T15:14:34.433

我会支持您可能希望考虑子类而不是您概述的方法的概念。但是，不知道您的具体情况，YMMV :-)

你在想的是一个元类。元类中的`__new__`函数被传递给类的完整提议定义，然后它可以在创建类之前对其进行重写。那时，您可以将构造函数替换为新的构造函数。

例子：

```
def substitute_init(self, id, *args, **kwargs):
    pass

class FooMeta(type):

    def __new__(cls, name, bases, attrs):
        attrs['__init__'] = substitute_init
        return super(FooMeta, cls).__new__(cls, name, bases, attrs)

class Foo(object):

    __metaclass__ = FooMeta

    def __init__(self, value1):
        pass 
```

替换构造函数可能有点戏剧性，但该语言确实为这种深度自省和动态修改提供了支持。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2013-09-21T21:47:44.297

没有人解释过您可以动态定义类。因此，您可以拥有一个定义（并返回）子类的装饰器：

```
def addId(cls):

    class AddId(cls):

        def __init__(self, id, *args, **kargs):
            super(AddId, self).__init__(*args, **kargs)
            self.__id = id

        def getId(self):
            return self.__id

    return AddId 
```

可以在 Python 2 中使用（来自 Blckknght 的评论解释了为什么您应该在 2.6+ 中继续这样做），如下所示：

```
class Foo:
    pass

FooId = addId(Foo) 
```

在这样的 Python 3 中（但要小心`super()`在你的类中使用）：

```
@addId
class Foo:
    pass 
```

所以你可以吃你的蛋糕- 继承*和**装饰*！

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-03-25T15:01:38.100

这不是一个好的做法，因此没有机制可以做到这一点。实现你想要的正确方法是继承。

查看[类文档](http://docs.python.org/tutorial/classes.html#inheritance)。

一个小例子：

```
class Employee(object):

    def __init__(self, age, sex, siblings=0):
        self.age = age
        self.sex = sex    
        self.siblings = siblings

    def born_on(self):    
        today = datetime.date.today()

        return today - datetime.timedelta(days=self.age*365)

class Boss(Employee):    
    def __init__(self, age, sex, siblings=0, bonus=0):
        self.bonus = bonus
        Employee.__init__(self, age, sex, siblings) 
```

这样Boss就拥有了一切`Employee`，还有他自己的**`__init__`**方法和自己的成员。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2017-06-15T00:16:03.753

我同意继承更适合所提出的问题。

虽然在装饰课上，我发现这个问题真的很方便，谢谢大家。

这是基于其他答案的另外几个示例，包括继承如何影响 Python 2.7 中的事物（以及[@wraps](https://stackoverflow.com/questions/308999/what-does-functools-wraps-do)，它维护原始函数的文档字符串等）：

```
def dec(klass):
    old_foo = klass.foo
    @wraps(klass.foo)
    def decorated_foo(self, *args ,**kwargs):
        print('@decorator pre %s' % msg)
        old_foo(self, *args, **kwargs)
        print('@decorator post %s' % msg)
    klass.foo = decorated_foo
    return klass

@dec  # No parentheses
class Foo... 
```

通常你想给你的装饰器添加参数：

```
from functools import wraps

def dec(msg='default'):
    def decorator(klass):
        old_foo = klass.foo
        @wraps(klass.foo)
        def decorated_foo(self, *args ,**kwargs):
            print('@decorator pre %s' % msg)
            old_foo(self, *args, **kwargs)
            print('@decorator post %s' % msg)
        klass.foo = decorated_foo
        return klass
    return decorator

@dec('foo decorator')  # You must add parentheses now, even if they're empty
class Foo(object):
    def foo(self, *args, **kwargs):
        print('foo.foo()')

@dec('subfoo decorator')
class SubFoo(Foo):
    def foo(self, *args, **kwargs):
        print('subfoo.foo() pre')
        super(SubFoo, self).foo(*args, **kwargs)
        print('subfoo.foo() post')

@dec('subsubfoo decorator')
class SubSubFoo(SubFoo):
    def foo(self, *args, **kwargs):
        print('subsubfoo.foo() pre')
        super(SubSubFoo, self).foo(*args, **kwargs)
        print('subsubfoo.foo() post')

SubSubFoo().foo() 
```

输出：

```
@decorator pre subsubfoo decorator
subsubfoo.foo() pre
@decorator pre subfoo decorator
subfoo.foo() pre
@decorator pre foo decorator
foo.foo()
@decorator post foo decorator
subfoo.foo() post
@decorator post subfoo decorator
subsubfoo.foo() post
@decorator post subsubfoo decorator 
```

我使用了函数装饰器，因为我发现它们更简洁。这是一个装饰类的类：

```
class Dec(object):

    def __init__(self, msg):
        self.msg = msg

    def __call__(self, klass):
        old_foo = klass.foo
        msg = self.msg
        def decorated_foo(self, *args, **kwargs):
            print('@decorator pre %s' % msg)
            old_foo(self, *args, **kwargs)
            print('@decorator post %s' % msg)
        klass.foo = decorated_foo
        return klass 
```

一个更健壮的版本，可以检查这些括号，如果装饰类上不存在方法，则可以工作：

```
from inspect import isclass

def decorate_if(condition, decorator):
    return decorator if condition else lambda x: x

def dec(msg):
    # Only use if your decorator's first parameter is never a class
    assert not isclass(msg)

    def decorator(klass):
        old_foo = getattr(klass, 'foo', None)

        @decorate_if(old_foo, wraps(klass.foo))
        def decorated_foo(self, *args ,**kwargs):
            print('@decorator pre %s' % msg)
            if callable(old_foo):
                old_foo(self, *args, **kwargs)
            print('@decorator post %s' % msg)

        klass.foo = decorated_foo
        return klass

    return decorator 
```

`assert`检查装饰器在没有括号的情况下未被使用。如果有，那么被装饰的类被传`msg`​​递给装饰器的参数，这会引发一个`AssertionError`.

`@decorate_if`仅适用于`decorator`if的`condition`评估结果`True`。

,测试, 和`getattr`用于使装饰器在被装饰的类上不存在该方法时不会中断。`callable``@decorate_if``foo()`

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-01-28T15:05:42.810

这里实际上有一个非常好的类装饰器实现：

[https://github.com/agiliq/Django-parsley/blob/master/parsley/decorators.py](https://github.com/agiliq/Django-parsley/blob/master/parsley/decorators.py)

我实际上认为这是一个非常有趣的实现。`isinstance`因为它继承了它所装饰的类，所以它在检查等方面的行为与这个类完全一样。

它还有一个额外的好处：`__init__`自定义 django 表单中的语句进行修改或添加的情况并不少见，`self.fields`因此最好在所有相关类`self.fields`都运行*后进行更改。*`__init__`

非常聪明。

但是，在您的类中，您实际上希望装饰来改变构造函数，我认为这对于类装饰器来说不是一个好的用例。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-12-20T10:16:09.477

这是一个示例，它回答了返回类参数的问题。而且，它仍然尊重继承链，即只返回类本身的参数。该功能`get_params`是作为一个简单的示例添加的，但由于检查模块，可以添加其他功能。

```
import inspect 

class Parent:
    @classmethod
    def get_params(my_class):
        return list(inspect.signature(my_class).parameters.keys())

class OtherParent:
    def __init__(self, a, b, c):
        pass

class Child(Parent, OtherParent):
    def __init__(self, x, y, z):
        pass

print(Child.get_params())
>>['x', 'y', 'z'] 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-01-27T16:33:34.950

Django 有`method_decorator`一个装饰器，可以将任何装饰器变成方法装饰器，你可以看到它是如何实现的`django.utils.decorators`：

[https://github.com/django/django/blob/50cf183d219face91822c75fa0a15fe2fe3cb32d/django/utils/decorators.py#L53](https://github.com/django/django/blob/50cf183d219face91822c75fa0a15fe2fe3cb32d/django/utils/decorators.py#L53)

[https://docs.djangoproject.com/en/3.0/topics/class-based-views/intro/#decorating-the-class](https://docs.djangoproject.com/en/3.0/topics/class-based-views/intro/#decorating-the-class)

# wpf - HTML“for”属性的 WPF 标签对应项

> ID：681960
> 
> 赞同：4
> 
> 时间：2009-03-25T14:54:08.930
> 
> 标签：wpf, label, target, for-attribute

WPF 中是否有一些属性可以添加到元素中，所以当我单击它时，目标控件会获得焦点？我找到的最接近的东西是“目标”，但它只适用于访问键并且单击它没有效果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-05-27T03:14:06.257

覆盖标签控件

```
public class LabelEx : Label
{
    public LabelEx() : base() {}

    protected override void OnMouseDown(System.Windows.Input.MouseButtonEventArgs e)
    {
        if (Target != null) Target.Focus();
        base.OnMouseDown(e);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T15:15:34.947

不，但是可以使[附加行为](http://blogs.msdn.com/johngossman/archive/2008/05/07/the-attached-behavior-pattern.aspx)为此工作。

# c# - 我的服务应该返回什么接口？IQueryable、IList、IEnumerable？

> ID：681962
> 
> 赞同：9
> 
> 时间：2009-03-25T14:55:08.443
> 
> 标签：c#, .net

想象一下，我有一个 SearchService 层，它有一种方法可以搜索以某个字符串开头的所有汽车；

```
public static class Searcher{
    public IAnInterface<Car> CarsStartingWith(string startWith){
        //magic
    }
} 
```

我的服务应该使用什么接口？
IQueryable 可以在我的应用程序的其余部分呈现一个漂亮的流畅界面。
IEnumerable 具有与它相关的惰性方面。
IList 是最实用的。

我希望我的所有服务都返回相同的接口以保持一致性，这会使整个事情变得容易得多。
ICollection 也可能是一种选择，但它提供的很少......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T14:57:10.747

我会选择`IEnumerable`它，因为它在框架中具有更中心的位置，为需要它的人提供多功能性，同时也为那些尚未陷入 LINQ 之类的东西的人提供熟悉度。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T15:47:22.997

我的经验法则如下：

如果有机会我可以采用例程的核心算法并以我可以使用收益返回的方式对其进行重构，我将使用 IEnumerable<T>。

例如，如果我当前的实现在内部使用数组或 List<T>，但我知道，至少在理论上，我可能希望并且能够在内部对其进行修改以进行惰性求值，我将返回 IEnumerable<吨>。

我发现返回 IEnumerable<T> 的好处绝对值得使用它的麻烦。

但是，如果算法本质上需要在返回之前对结果进行全面评估（很少见，但确实会发生），我将使用 IList<T>。基本上，如果我已经在计算它，我会返回它。IList<T> 实现了 IEnumerable<T>，因此所有与 LINQ 相关的用例仍然有效，但您失去了惰性求值。如果我已经被迫提前评估，那不是问题。

我很少返回 IQueryable。我唯一会使用这个接口的时候是我直接创建一个可查询的数据访问层，或者类似的东西。在大多数情况下，使用它的开销是不值得的。

但是，如果您的目标是始终使用单个接口（我不一定同意这个目标），我会坚持使用 IEnumerable<T>。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T14:58:54.597

`IQueryable`会对它有相当高的要求——例如，你不能返回一个数组。

通常对我来说，两者之间的选择`IEnumerable`或者`IList`通常最终是在标准情况下更容易实现的那个。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-25T15:05:34.643

简短的回答：这取决于。

更长的答案：返回您的客户端代码需要的最丰富的类型。如果您不需要延迟加载，IList 在大多数情况下都可以使用。您仍然可以使用 Linq 查询 IList 或 IEnumerable。如果需要延迟加载，则使用 IEnumerable 或 IQueryable。

旁注：为所有服务返回相同的接口似乎是一个崇高的目标，但考虑到不同的客户端使用模式，您可能希望返回不同的接口。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-25T15:07:17.617

如果您希望所有服务都返回相同的界面，那么我可能会选择`IEnumerable<>`.

如有必要，您的调用者可以很容易地转换为`IQueryable`或创建一个`List`:

```
IEnumerable<Car> cars = Searcher.CarsStartingWith("L");
var carsList = cars.ToList();
var queryableCars = cars.AsQueryable(); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-25T15:20:13.420

`IEnumerable`除非您有严重的理由不这样做，否则请始终使用。然后，您可以使用`yield return`.

`IQueryable`是完全不同的一壶鱼。不是你随便实现的东西，作为典型内存容器的替代品。

其余的，`IEnumerable`和其他的有一个主要的不同：它是只读的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-14T10:42:47.577

如果您使用 IQueryable 作为返回类型，则您有一个带有泄漏抽象的服务层。

# spring - 寻找一个好的Spring框架作弊秘籍

> ID：681966
> 
> 赞同：22
> 
> 时间：2009-03-25T14:55:33.870
> 
> 标签：spring

是否有全面的 Spring 框架备忘单，涵盖最新版本中的功能？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-25T17:30:34.387

也许这些会帮助你

*   [Spring 注释备忘单](http://dzone.com/refcardz/spring-annotations)
*   [Spring 配置备忘单](http://dzone.com/refcardz/spring-configuration)

# tdd - Visual Studio 2008 加载项中的 TDD

> ID：681970
> 
> 赞同：1
> 
> 时间：2009-03-25T14:56:32.463
> 
> 标签：tdd, visual-studio-addins

我正在尝试使用 Visual Studio 2008 为 Excel 创建一个插件，并且我想使用测试驱动开发 (TDD)。

纯 TDD 将从一个空的解决方案开始。
创建共享插件项目时会自动生成以下方法：

```
public class Connect
{  
  public Connect(){ }  

  public void OnAddInsUpdate(ref System.Array custom){ }  

  public void OnBeginShutdown(ref System.Array custom){ }  

  public void OnConnection(  
        object application  
        , Extensibility.ext_ConnectMode  
        , connectMode  
        , object addInInst  
        , ref System.Array custom)  
  {
     applicationObject = application;
     addInInstance = addInInst;
  }  

  public void OnDisconnection(  
       Extensibility.ext_DisconnectMode disconnectMode  
       , ref System.Array custom){ }  

  public void OnStartupComplete(ref System.Array custom){ }  
} 
```

在实际为插件编写任何代码之前，如何测试这些方法？
该插件将有一个类 WorkSheet.cs

Freddy：我正在考虑在生成的代码中实例化类，针对对象的创建编写一个测试，然后从那里继续。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T15:02:16.600

代码由框架生成，因此不需要测试。我建议将此代码排除在代码覆盖范围之外（如果您使用它）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T15:21:48.503

我认为很难马上告诉你在这些方法中想要做什么，特别是如果你从未使用过它。

我会等待这些测试，直到我开始需要代码进入那里。当我开始在那里挂钩代码时，我会测试它 - 挂钩其他东西的代码是否正确（其他部分的单元测试已经在其中）。

# javascript - 使用嵌套表的 jQuery 动画问题

> ID：681977
> 
> 赞同：0
> 
> 时间：2009-03-25T14:57:36.283
> 
> 标签：javascript, jquery, html, animation

我在嵌套表上使用 jQuery 的动画有问题。我想制作一个有点像树视图的表格，带有一点**+ / -**来展开并获取有关单击行的更多详细信息。

如何修改以下代码以使动画同时在 Internet Explorer 6.0+ 和 Firefox 中工作？

我可以更改标记或 javaScript，只要它有效就没有关系。

如果知道这一点很有用，则此结构是使用 asp.net 中的嵌套中继器生成的。我可以访问 Telerik 的 radAjax 控制套件，但我无法让他们的 radGrid 与嵌套表一起工作。

文件结构：

```
 <tr>
        <th>&nbsp;</th>
        <th>Code</th>
        <th>Title</th>
    </tr>

    <tr>
        <td><span class="TreeCollapseSign">-</span></td>
        <td>WAA-864R</td>
        <td>Code 1 ... some details ... - MODULE 2</td>        
    </tr>

    <tr>
        <td colspan="6">
            <table>     
                <tr>
                    <th>Extra Info 1</th>
                    <th>Extra Info 2</th>
                    <th>Extra Info 3</th>
                </tr>

                <tr>
                    <td>Some info...</td>
                    <td>Some more info...</td>
                    <td>Yet more Info</td>
                </tr>                                
            </table>
        </td>
    </tr>
</table> 
```

Javascript：

```
<script type="text/javascript">
    (function($) {
        $(document).ready(function(){

            $(".TreeCollapseSign").data("visible", true);

            $(".TreeCollapseSign").click(function(){

                if ($(this).data("visible")) {
                    $(this).parent().parent().next().fadeOut().end().end().end().data("visible", false).text("+");                
                } else {
                    $(this).parent().parent().next().fadeIn().end().end().end().data("visible", true).text("-");
                }

            });
        });
    })($)
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T17:21:05.223

您是否能够更改输出代码以使用 UL 而不是表格？

如果可以，那么您可能想看看[jQuery Treeview plugin](http://bassistance.de/jquery-plugins/jquery-plugin-treeview/)。这就是我用于所有树视图的内容。

实际上，使用 UL 而不是树视图的表在语义上更合适，但在您的情况下，这将取决于是否有机会更改代码。

无论如何，万一你不能，我认为你不能淡出TR......我过去也遇到过类似的问题，所以我建议改为淡出内表，然后隐藏TR。

此外，调用 end() 3 次也没有意义。如果您在显示/隐藏内表后再次执行 $(this)，它会更快、更易读：

```
var innerTable = $(this).parent().parent().next().find("table");
if ($(this).data("visible")) {
  innerTable.fadeOut();
  innerTable.parent().hide();
  $(this)
    .data("visible", false)
    .text("+");
} else {
  innerTable.parent().show();
  innerTable.fadeIn();
  $(this)
    .data("visible", true)
    .text("-");
} 
```

# java - 为什么我会收到此 NullPointer 异常？

> ID：681979
> 
> 赞同：1
> 
> 时间：2009-03-25T14:57:52.163
> 
> 标签：java, database, jpa

两个表，一个的主键是另一个（传统数据库）的外键
我使用了双向一对一映射：

```
@Entity
public class First {
    @Id protected int a;

    @OneToOne(mappedBy ="first", cascade = CascadeType.PERSIST)
    @JoinColumn(name = "a")
    protected Second second;
}

@Entity
public class Second {

    @Id protected int a;

    @OneToOne
    @JoinColumn(name = "a", insertable = false)
    First first;
} 
```

问题是运行时：

```
public class Persister {

    public static void main(String[] args) {

        EntityManagerFactory aEntityManagerFactory;
        EntityManager aEntityManager;       
        aEntityManagerFactory =
                       Persistence.createEntityManagerFactory("bibit_notification_jpa");
        aEntityManager = aEntityManagerFactory.createEntityManager();

        Second aSecond = new Second();
        aSecond.a = 1;          

        First aFirst = new First();
        aFirst.a = 1;
        aFirst.second = aSecond;

        aEntityManager.getTransaction().begin();
        aEntityManager.persist(aFirst);
        aEntityManager.getTransaction().commit();

      }} 
```

，它会抛出这个异常：

```
线程“主”javax.persistence.PersistenceException 中的异常：java.lang.NullPointerException
    在 org.hibernate.ejb.Ejb3Configuration.configure(Ejb3Configuration.java:252)
    在 org.hibernate.ejb.HibernatePersistence.createEntityManagerFactory（HibernatePersistence.java:120）
    在 javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:51)
    在 javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:33)
    在 Persister.main(Persister.java:14)
引起：java.lang.NullPointerException
    在 org.hibernate.cfg.OneToOneSecondPass.doSecondPass(OneToOneSecondPass.java:135)
    在 org.hibernate.cfg.Configuration.secondPassCompile(Configuration.java:1130)
    在 org.hibernate.cfg.AnnotationConfiguration.secondPassCompile（AnnotationConfiguration.java:296）
    在 org.hibernate.cfg.Configuration.buildMappings(Configuration.java:1115)
    在 org.hibernate.ejb.Ejb3Configuration.buildMappings(Ejb3Configuration.java:1233)
    在 org.hibernate.ejb.EventListenerConfigurator.configure（EventListenerConfigurator.java:154）
    在 org.hibernate.ejb.Ejb3Configuration.configure(Ejb3Configuration.java:869)
    在 org.hibernate.ejb.Ejb3Configuration.configure(Ejb3Configuration.java:183)
    在 org.hibernate.ejb.Ejb3Configuration.configure(Ejb3Configuration.java:240)
    ... 4 更多

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T16:10:41.413

这篇文章： http: [//forum.hibernate.org/viewtopic.php?t=970823）](http://forum.hibernate.org/viewtopic.php?t=970823))

似乎表明注释 3.2.x 存在某种问题。你用的是什么版本？如果是 3.2.x，请尝试 3.3 或 3.4。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T20:43:14.113

You may want to have a look at the second example in the [JavaDoc](http://java.sun.com/javaee/5/docs/api/javax/persistence/OneToOne.html). If I read this correctly the code should be

```
@Entity
public class First {
    @Id protected int a;

    @OneToOne @PrimaryKeyJoinColumn
    protected Second second;
}

@Entity
public class Second {

    @Id protected int a;

    @OneToOne @PrimaryKeyJoinColumn
    First first;
} 
```

# svn - svn：外部和权限

> ID：681983
> 
> 赞同：1
> 
> 时间：2009-03-25T14:58:47.263
> 
> 标签：svn, permissions, externals

我正在运行一个带有可选组件的 svn 项目——从几个外部存储库中提取，以及一些对这些外部具有不同访问权限的用户。

'svn update' 命令在它无法检索的第一个项目中中止。

svn:externals 是否有更好或标准的方法来允许所有用户成功结帐？

编辑：我对外部项目没有所有权/控制权来授予访问权限，并且公司政策不允许镜像外部项目。因为外部支持可选组件，所以权限较少的用户显然不会维护可选组件。但是，他们仍然需要检查其他外部，并且“svn up”非常依赖于顺序。

我意识到修复权限并拆分为子存储库将使这成为一个非问题，但我仍然有兴趣知道是否有任何中间立场。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T15:05:00.510

如果用户可以访问某个项目，但不能访问该项目的外部，您究竟希望发生什么？如果两者密切相关，那么用户应该可以访问两者。如果这两者没有密切相关，那么为什么将它们作为外部添加呢？

您也许可以为每个用户授予对所有外部对象的只读访问权限，而仅对需要它的人授予写访问权限。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-26T09:34:08.237

如果这是一个足够大的问题，您可以重组您的工作区，以便您拥有一个仅包含对项目部分的外部引用的顶层。然后让不同的人使用不同的顶层来获得他们需要的外部。

需要大量的管理和思考。

就像是：

```
/Projects
 /Project1
  /trunk
 /Project2External
  /tag1
/Workspaces
 /Project1
  /DevA - svn:external Project1/trunk Project2/tag1
  /DevB - svn:external Project1/trunk 
```

但是您必须愿意以这种方式重组项目，并考虑在外部发生全局变化时该怎么办。但是，通过这种方式，您仍然在 project1 的主干上工作，所以没有额外的摆弄。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-31T12:52:42.750

我知道这是一个旧线程，但是我对来自 github 的外部有一个问题，它与 svn 存储库中的用户名和密码不同。我不想失去解决方案，所以为了后代，我走了:)

更新本地 svn checkout：

```
svn switch --username <username> --password <password> http://svn.server/svn/exampleProject --ignore-externals 
```

这不会更新外部！

现在使用不同的用户名和密码更新外部：

```
svn up <path_to_external> --username <external_username> --password <external_password> 
```

# opengl - OpenGL中的光和深度问题

> ID：681986
> 
> 赞同：0
> 
> 时间：2009-03-25T14:58:55.970
> 
> 标签：opengl, 3d, camera, perspectives

```
glClear(GL_COLOR_BUFFER_BIT);
glMatrixMode(GL_MODELVIEW);

ifstream myFile("Coordinates.txt");

if (!myFile.is_open())
{
    cout << "Unable to open file";
    exit(1); // terminate with error
}

// Light values and coordinates
float ambientLight[] = { 0.3f, 0.3f, 0.3f, 1.0f };
float diffuseLight[] = { 0.7f, 0.7f, 0.7f, 1.0f };
float specular[] = { 1.0f, 1.0f, 1.0f, 1.0f};
float lightPos[] = { 0.0f, -150.0f, -150.0f, 1.0f };

glEnable(GL_CULL_FACE);  // Do not calculate inside of jet
glFrontFace(GL_CCW);     // Co unter clock-wise polygons face

// Enable lighting
glEnable(GL_LIGHTING);
// Setup and enable light 0
glLightfv(GL_LIGHT0,GL_AMBIENT, ambientLight);
glLightfv(GL_LIGHT0,GL_DIFFUSE,diffuseLight);
glLightfv(GL_LIGHT0,GL_SPECULAR,specular);
glLightfv(GL_LIGHT0,GL_POSITION,lightPos);
glEnable(GL_LIGHT0);

// Light values and coordinates

float specref[] = { 1.0f, 1.0f, 1.0f, 1.0f };

// Enable color tracking
glEnable(GL_COLOR_MATERIAL);
// Set Material properties to follow glColor values
glColorMaterial(GL_FRONT, GL_AMBIENT_AND_DIFFUSE);
// All materials hereafter have full specular reflectivity
// with a high shine 
glMaterialfv(GL_FRONT_AND_BACK, GL_SPECULAR,specref);
glMateriali(GL_FRONT_AND_BACK,GL_SHININESS,128);

while (! myFile.eof()) 
{
    glPushMatrix();
    myFile>>plot[0];
    myFile>>plot[1];
    myFile>>plot[2];
    myFile>>plot[3];  //this data will not be used

    glColor3f(0.60f/1.5,0.80f/1.5,0.90f/1.5);

    glTranslatef((plot[0]-1.15)*26, (plot[2]-0.51)*45, (plot[1]-1)*30);
    glutSolidSphere(2, 12, 12);
    glLoadIdentity();
    glPopMatrix();

    axes += 0.00005f;

}

glRotatef(axes, 0.0f, 1.0f, 0.0f);      

myFile.close();
glFlush();
glutSwapBuffers(); 
```

这是我第一次玩灯光。

我的问题是，在我放置教程中的所有光效代码后，对象似乎只存在于一个平面中，这是 xy 平面，我认为我的数据在所有 xyz 中都已协调，并且反射似乎有点偏离..

谁能告诉我为什么以及如何解决它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T15:27:21.050

看看[这里：避免 16 个常见的 OpenGL 陷阱](http://www.opengl.org/resources/features/KilgardTechniques/oglpitfall/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T15:27:59.847

你没有提供足够的信息。您的文件中有哪些值？为什么在 plot[3] 未使用时加载它？您的意思是 glutSphere 在 xy 平面上呈现为平面 2d 对象吗？

我建议您在使用内置照明之前熟悉核心的 OpenGL 功能，这个问题可能与照明无关。除了测试和小型项目之外，我也不建议将 GL 的内置照明用于任何其他事情......它不是很灵活并且也有很多限制。

# visual-studio - 如何将多个 Visual Studio 解决方案链接在一起？

> ID：681990
> 
> 赞同：47
> 
> 时间：2009-03-25T14:59:38.743
> 
> 标签：visual-studio, projects-and-solutions

我有 3 个解决方案，解决方案 A 需要从解决方案 B 和 C 构建的 DLL 版本才能编译。无法将其合并到一个解决方案中...

到目前为止，Visual Studio 似乎不支持解决方案引用，如果我尝试这种方式，msbuild 足够聪明，可以知道您正在从另一个等构建一个解决方案。总体目标是尝试使多个解决方案看起来几乎只有一个 - 只是解决方案 A。

我相信这是一个常见的问题，但你如何很好地联系起来呢？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-05T17:23:16.920

这个问题以[不同](https://stackoverflow.com/questions/200954/)但[相关](https://stackoverflow.com/questions/284856/)的形式出现。实际上有一个[MSDN 页面涵盖了这一点](http://msdn.microsoft.com/en-us/library/ee817674.aspx)。

您正在寻找的是类似于**大型系统的分区单一解决方案模型**的多解决方案方法。拥有一个“一切”解决方案来构建一切并维护您的组件间依赖关系。这是您在需要构建解决方案 A 时构建的内容。然后您将拥有仅包含组件 B 或 C 的单独解决方案。本质上，您仍将拥有 3 个解决方案，但您会将解决方案 B 和 C 中的项目添加到解决方案中一种。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-05T17:18:04.840

我最近发现，在 Visual Studio 2008 中，您可以在多个解决方案中包含现有项目。到目前为止，唯一的缺点似乎是，如果您对共享项目进行更改并打开多个使用该共享项目的解决方案，您将被要求“重新加载”其他解决方案。

因此，只需将“添加现有项目”添加到需要该项目的所有解决方案中。我在当前站点上使用 TFS，源代码控制以太似乎没有问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T15:03:26.333

我相信它应该是您正在查看的项目级别。构建解决方案 B 和 C 中包含的项目，然后在解决方案 A 的相关项目中添加对 DLL 的引用。

在 Msbuild 如果你有一个属性组

```
<PropertyGroup>

<SolutionsToBuild>SolutionB</SolutionsToBuild>
<SolutionsToBuild>SolutionC</SolutionsToBuild>
<SolutionsToBuild>SolutionA</SolutionsToBuild>
</PropertyGroup> 
```

然后执行 MSBuild 任务

```
<MSBuild Projects="@(SolutionsToBuild)"/> 
```

希望这可以帮助

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-23T17:38:38.963

您可以尝试自动化合并过程以节省一些时间： [http ://code.google.com/p/merge-solutions/](http://code.google.com/p/merge-solutions/)

尽管我们遇到了稍微不同的问题：大约 15 个解决方案（总共约 150 个项目）使用了一个通用库。问题是，如果我们试图将所有这些合并为一个，以便重构/消除公共库中的冗余代码。1\. 合并 15 个解决方案需要在 VS 2 中进行大量点击和等待。结果解决方案永远不会是最新的 - 没有人因为它的大小而烦恼更新它

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T15:15:40.077

您可以尝试为您在项目的预构建事件（在解决方案 A 中）中依赖的 dll（在解决方案 B 和 C 中）添加命令行构建命令

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T15:17:32.257

如果您不能将项目 B 和 C 放入与项目 A 相同的解决方案中，那么在构建项目 A 时，无法确保 B 和 C 的二进制文件包含最新的源代码。

我见过的最简单的解决方案是在源代码存储库中有一个公共文件夹，如果需要共享，每个项目都会在其中复制其二进制文件。然后，所有其他项目都可以引用该文件夹中的二进制文件，只要您的本地文件夹看起来与存储库相同。

不是一个完美的解决方案，但它很容易使用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-25T16:02:15.800

您可以将 Makefile 项目添加到解决方案 A，这将构建您的解决方案 B 和 C（例如使用 msbuild）并使 A 中的所有项目都依赖于该 Makefile 项目。这样，您将无法将项目引用添加到 B 和 C 中的项目，但您可以使用 dll 引用，它们将始终从最新源构建。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-08-01T11:27:53.313

根据[这个答案](https://stackoverflow.com/questions/2729535/how-to-build-solution-using-batchfile)，我建议您*创建自己的批处理文件*，该文件将为您构建相关的解决方案。

这使用起来非常方便，因为构建过程会将构建进度（类似于 Visual Studio 中的输出窗口）输出到每个构建执行的命令promote。

此外，如果您需要先构建一个解决方案，您可以编写自己的构建顺序，例如：

1.  构建解决方案 B
2.  构建解决方案 C
3.  构建解决方案 A（内部使用“解决方案 B”和“解决方案 C”构建文件）

我已经快速编写[了脚本来阐明上面提到的构建顺序](http://pastebin.com/JCV3wicJ)并支持大多数现代 Visual Studio 版本。

问候。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-03-01T14:25:59.057

我通过将脚本放在预构建事件命令行中解决了这个问题，如果项目 A 构建失败，则抛出 msg alert

```
ECHO "build A project"
set AppMsg ="%SystemRoot%\System32\msg.exe"
set AppMsg
if not "%ProgramFiles(x86)%" == "" (
if exist "%SystemRoot%\Sysnative\*" set AppMsg="%SystemRoot%\Sysnative\msg.exe"
)
set AppMsg
taskkill /f /im "%PROGRAMFILES(X86)%\MSBuild\14.0\Bin\msbuild" "$(SolutionPath)" /t:Project_A_Name /p:Configuration=Debug;TargetFrameworkVersion=v4.5 /p:Platform="Any CPU" /p:BuildProjectReferences=false /p:VSToolsPath="%PROGRAMFILES(X86)%\MSBuild\Microsoft\VisualStudio\v14.0" 2>nul 1>nul
echo ERRORLEVEL %ERRORLEVEL%
if ERRORLEVEL 1 (
ECHO "failed to build test project"
%AppMsg% * "failed to build test project"
)
exit 0 
```

# c# - 为什么我在使用 IIS 时得到 Cryptography_CSP_NoPrivateKey 而在使用 VS 开发服务器时却没有？

> ID：681991
> 
> 赞同：2
> 
> 时间：2009-03-25T15:00:00.367
> 
> 标签：c#, web-services, security, certificate, signing

我正在做一个利用外部网络服务的网络应用程序。这个外部网络服务要求我签署我的每一个请求。所以我使用`WebServicesClientProtocol`类和 .NET 2.0，首先使用外部 Web 服务，然后手动编辑`Reference.cs`文件并将扩展类`System.Web.Services.Protocols.SoapHttpClientProtocol`从`Microsoft.Web.Services2.WebServicesClientProtocol`. 然后在`Page_Load`方法中我有以下代码：

```
try
{
    // Create the ws endpoint
    var uriServiceAddress = new Uri("urn:something-wse:something_NNNN");
    var uribuilderViaRouter = new UriBuilder("http://xx.xxx.xx/SrvXXX_NNNN/Test.asmx");
    var endpointReference = new EndpointReference(uriServiceAddress, uribuilderViaRouter.Uri);

    // Create the ws client
    var client = (WebServicesClientProtocol) new Test.Something();
    client.Destination = endpointReference;

    // Read the certificate from MyStore on LocalMachine
    X509CertificateStore localStore = X509CertificateStore.LocalMachineStore(X509CertificateStore.MyStore);
    X509SecurityToken securityToken = null;
    if (!localStore.OpenRead()) throw new Exception("Unable to open localstore for read");
    X509CertificateCollection certificateCollection = localStore.FindCertificateBySubjectString("email@subject.test");
    if (certificateCollection.Count == 0) throw new Exception("Unable to obtain security token.");
    securityToken = new X509SecurityToken(certificateCollection[0]);
    localStore.Close();

    // Attach the security toekn to the client request
    client.RequestSoapContext.Security.Tokens.Add(securityToken);
    client.RequestSoapContext.Security.Elements.Add(new MessageSignature(securityToken));

    // Set the timeouts
    client.RequestSoapContext.Security.Timestamp.TtlInSeconds = 2 * 60;
    client.Timeout = 60 * 10 * 1000;    // 10 mínútur ættu að duga í flest.

    // Call the test function
    DataSet set = ((Test.Something)client).searchMethod("Parameter 1", "Parameter 2");
    Label1.Text = User.Identity.Name+ " worked! " + set.Tables.Count + " tables!";
}
catch (Exception exc)
{
    Label1.Text = User.Identity.Name + " exception: " + exc.ToString();
} 
```

当我使用 Visual Studio 开发服务器运行它时，这工作正常，但是当我更改为 IIS 时，它停止工作并且我得到了丑陋的`Cryptography_CSP_NoPrivateKey`异常。

**1)**我已经使用 MMC 将证书正确读入 LocalMachine/MyStore，然后我使用 WSE 2.0 SP3 更改了私钥权限，以便每个人都可以完全访问它。你可以从这里看到：

[替代文字 http://www1.ruedenet.is/files/CertError1.png](http://www1.ruedenet.is/files/CertError1.png)

**2）**我还设置了属性，以便在调试应用程序时使用 Visual Studio 开发服务器：

[替代文字 http://www1.ruedenet.is/files/CertError2.png](http://www1.ruedenet.is/files/CertError2.png)

**3）**然后我运行它并得到一个不错的结果：

[替代文字 http://www1.ruedenet.is/files/CertError3.png](http://www1.ruedenet.is/files/CertError3.png)

**4）**但是，当我将属性更改为使用 IIS（并让 VS 创建虚拟目录）时，如下所示：

[替代文字 http://www1.ruedenet.is/files/CertError4.png](http://www1.ruedenet.is/files/CertError4.png)

**5）**我还更改了 IIS 中的身份验证方法，以便我登录（真的没有理由）：

[替代文字 http://www1.ruedenet.is/files/CertError5.png](http://www1.ruedenet.is/files/CertError5.png)

**6）**所以我被要求登录Windows：

[替代文字 http://www1.ruedenet.is/files/CertError6.png](http://www1.ruedenet.is/files/CertError6.png)

**7）**然后我的页面运行并产生错误：

[替代文字 http://www1.ruedenet.is/files/CertError7.png](http://www1.ruedenet.is/files/CertError7.png)

如果你能帮我解决这个问题，我一定会很感激的。我已经花了几个小时在上面，如果我犯了你们可以看到的基本错误，我不想花更多时间。顺便说一句：我正在 Windows Server 2008 上使用 Visual Studio 2008 进行开发，并关闭了 UAC :-)

真的很期待收到你们的来信。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T16:46:13.747

:-)

我已经通过几个步骤解决了这个问题：

**1）**我将用户更改`Default Application Pool`为我的用户名...

[替代文字 http://www1.ruedenet.is/files/ErrorFix1.png](http://www1.ruedenet.is/files/ErrorFix1.png)

......这奏效了。我将应用程序池的用户改回`NETWORK SERVICE`，但它不再工作。这告诉我问题与`NETWORK SERVICE`用户有关。所以我回去寻找这个用户的权限可能是什么问题。

**2)**在浏览和阅读网页时，我在[http://timjacobs.blogspot.com/2008/11/app-v-45-certificate-galore.html](http://timjacobs.blogspot.com/2008/11/app-v-45-certificate-galore.html)找到了 Tim Jacobs 的博文[App-V 4.5 Certificate Galore](http://timjacobs.blogspot.com/2008/11/app-v-45-certificate-galore.html)。好吧，直到最后他谈到了私钥在磁盘上的存储位置，这里面并没有什么新东西。所以我运行了[FindPrivateKey.exe](http://msdn.microsoft.com/en-us/library/aa717039.aspx)工具，...

> C:\MyTools>FindPrivateKey.exe My LocalMachine -t "8c 1a e6 1b 6d f2 f8 18 c8 26 b6 fa cd 60 fd 94 c7 a1 96 58"
> 私钥目录：
> **C:\Users\alfred\AppData\Roaming\Microsoft \Crypto\RSA\S-1-5-21-3612370315-2559787 071-3412320394-1135**
> 私钥文件名：
> b3765d4123902371ea91c5c9a521932e_96ce3a90-5634-44e6-8aa2-acb123b8b3bf

...这告诉我私钥的位置在`C:\Users\alfred\...`目录中，`NETWORK SERVICE`用户可能无权访问此目录！

**3）**因此，我按照 Tim 的建议使用 MMC 从 导出证书和私钥`Local Computer/Personal/Certificates`，然后将其导入`Local Computer/Trusted Root Certificate Authorities/Certificates`. 导出后，[FindPrivateKey.exe](http://msdn.microsoft.com/en-us/library/aa717039.aspx)报告，...

> C:\MyTools>FindPrivateKey.exe 我的 LocalMachine -t "8c 1a e6 1b 7d f1 f8 18 c8 26 b6 fa cd 60 fd 94 c7 a1 96 58"
> FindPrivateKey 失败，原因如下：没有带有密钥 '8c 1a e6 1b 的证书7d f1 f8 18 c8 26 b6 fa cd 60 fd 94 c7 a1 96 58' 在商店中找到。

...这告诉我出口有效。导入并复制粘贴回来后，`Local Computer/Personal/Certificates`我得到...

> C:\MyTools>FindPrivateKey.exe My LocalMachine -t "8c 1a e6 1b 7d f1 f8 18 c8 26 b6 fa cd 60 fd 94 c7 a1 96 58"
> 私钥目录：
> **C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys**
> 私钥文件名：
> b3765d4d5a902371ea91c5c9a521932e_96ce3a90-5634-44e6-8aa2-acbaccb8b3bf

...现在私钥在公共场所，即`C:\ProgramData\...`目录中。然后，我像以前一样使用*X509 证书工具*`NETWORK SERVICE`将用户的私钥权限更改为*完全访问权限。*

 ***现在它起作用了！！！**

**对于你的博文蒂姆，我实在是太感谢你了。谢谢你。**

# javascript - IE中的ExtJS组合框问题

> ID：681995
> 
> 赞同：1
> 
> 时间：2009-03-25T15:01:02.750
> 
> 标签：javascript, internet-explorer, extjs

我有一个 ExtJS 组合框，后面有一个远程数据存储。在所有浏览器中它都可以正常工作，除了在 IE（我测试过的所有版本）中，组合框会扩展一秒钟，显示“正在加载”图标，然后它又消失了。在此之后再次单击它不会使其不再扩展。基本上：它没有被填充。

在服务器端，一切都很好。到达返回 Json 数据的控制器操作（使用 ASP.NET MVC）。Json 格式正确（所有其他浏览器至少会吞下它）。

奇怪的是，当我在 Controller 操作中放置断点时，JsonStore 会在客户端正确填充。这对我来说表明某种时间问题。

另一个奇怪的事情是，每隔一段时间，它就可以正常工作。也许是因为时机恰到好处之类的。

如果我将组合框模式设置为“本地”并在远程数据存储上强制使用 a `.load()`，它在 IE 中也可以正常工作。

此问题存在于为我们使用远程数据存储的所有组合框中。

我有以下 JsonStore：

```
 var companies = new Ext.data.JsonStore({
    url: '/Company/GetCompanies/',
    root: 'companies',
    fields: [
    { name: 'CompanyID'},
    { name: 'CompanyName'}]
  }); 
```

组合框：

```
new Ext.form.ComboBox({
    fieldLabel: 'Company',
    typeAhead: false,
    triggerAction: 'all',
    valueField: 'CompanyID',
    hiddenName: 'CompanyID',
    displayField: 'CompanyName',
    mode: 'remote',
    lazyRender: true,
    store: companies,
    allowBlank: true,
    editable: false,
    listeners: {
        'focus': function(){
          if(companies.data.length > 0)
          {
           debugger; // This is only ever fired after the aforementioned breakpoint method.
          }
        }
    }
}) 
```

控制器返回的 Json：

```
{"companies":[{"CompanyID":1,"CompanyName":"Test"},{"CompanyID":2,"CompanyName":"Test1"
},{"CompanyID":3,"CompanyName":"Test2"}]} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T15:11:46.250

数字，我在发布有关它的问题后几分钟就制定了解决方案。

我切换到 Store 而不是 JsonStore 并指定`method: 'GET'`了代理的属性并且它起作用了。我不知道为什么这确实有效，以及为什么只有 IE 有问题。我的控制器操作同时接受 GET 和 POST，所以不是这样。

商店：

```
var companies = new Ext.data.Store({
      proxy: new Ext.data.HttpProxy({ url: '/Company/GetCompanies/', method: 'GET' }),
      reader: new Ext.data.JsonReader({ root: 'companies' }, [{ name: 'CompanyID', mapping: 'CompanyID' }, { name: 'CompanyName', mapping: 'CompanyName'}])
}); 
```*`*****************